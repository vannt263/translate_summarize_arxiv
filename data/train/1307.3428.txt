{
  "article_text": [
    "kerr frequency comb generation has recently attracted much interest , due to its many potential applications in e.g. spectroscopy , frequency metrology , sensing and arbitrary waveform generation @xcite .",
    "there are currently two main theoretical formalisms that are being used to model and describe frequency comb generation in microresonator devices .",
    "these are the formalisms based on the coupled mode equations @xcite , and the driven and damped nonlinear schrdinger ( nls ) equation @xcite , the latter being also known as the lugiato - lefever equation ( lle ) @xcite .",
    "the driven and damped nls model has been used since the early 90s for describing nonlinear dispersive fiber - ring cavities @xcite , but has only recently been adopted as a model for microresonators .",
    "the lle has been widely hailed for allowing significant , orders of magnitude , speedups to the numerical simulation of kerr frequency combs when compared with simulations using coupled mode equations @xcite , thereby permitting simulations of ultra broadband combs such as octave spanning frequency combs consisting of hundreds or thousands of resonant modes .",
    "however , both formalisms have recently been established to describe the same underlying physical phenomena , and can be converted into each other under suitable approximations , see @xcite .",
    "indeed , both formalisms provide an equivalent description of the nonlinear four - wave - mixing process due to the kerr nonlinearity .",
    "there should therefore be no fundamental reason for one method to be substantially faster , with regards to computation , than the other .",
    "in this letter we will show that this is in fact precisely the case .",
    "it has previously been demonstrated that the coupled mode equations can be seen as a fourier expansion of the driven and damped nonlinear schrdinger equation @xcite .",
    "it is therefore possible to cast the coupled mode equations into a form where fast fourier transforms ( ffts ) can be used to speed up calculations .",
    "this allows for huge speed improvements , which are analogous to the improvements obtained when using ffts instead of matrix computations for calculating the discrete fourier transform , thus potentially shortening computation times by several orders of magnitude .",
    "this observation also opens up the possibility of using coupled mode methods for numerical simulations on a larger scale , which is particularly relevant for the simulation of octave spanning frequency combs , consisting of thousands of resonant modes .",
    "these octave spanning combs are of great interest from an application point of view since they can be self - referenced to provide the absolute frequency of the comb modes",
    ".    we will first give a short overview of how the coupled mode equations are being used in describing kerr frequency comb generation , and the source of the so far widely perceived difficulty for the associated numerical computations .",
    "we will then show how a solution to this problem may be found by reformulating the coupled mode equations in such a way that ffts can be used to calculate the nonlinear contribution .",
    "we will discuss the huge improvement which can be achieved by doing so : as a result , the computation time involved in either the frequency - domain ( i.e. , the coupled mode equations ) or the time domain ( i.e. , the lle ) approach is exactly of the same order .",
    "set aside computation time , we thus conclude this work by outlining which may be the particular remaining benefits and drawbacks of the different formalisms for studying microresonator frequency combs .",
    "the coupled mode equations provide a modal expansion approach for describing optical frequency comb generation in whispering - gallery - mode resonators and microresonator cavities @xcite .",
    "the coupled mode equations describe the slow evolution of each discrete frequency component of the resonant comb spectrum , with each comb mode @xmath0 modeled by an ordinary differential equation , viz . @xmath1 where the first term on the right hand side gives the complete losses @xmath2 at frequency @xmath3 as a sum of both intrinsic and external @xmath4 losses , while the last term gives the contributions to each frequency due to the four - wave - mixing process .",
    "the nonlinear coefficient @xmath5 is for simplicity assumed to be a constant , although this is not a necessary restriction , see @xcite . at the central frequency @xmath6",
    "there is an additional term which provides the external driving @xmath7 , with corresponding cavity detuning @xmath8 .",
    "a single rate equation can be used to model each mode , since it is assumed that the amplitude of each frequency component is evolving slowly on a separate time - scale from the fast time variation corresponding to the temporal profile of the mode .",
    "simulations of kerr frequency comb generation using coupled mode equations have so far been widely perceived in the literature as being computationally demanding due to the large number of contributions from the nonlinear four - wave - mixing term , when many modes are present in the cavity .",
    "for example , an analysis of the computational complexity was presented in @xcite , which showed that the number of contributions to each equation grows quadratically with the number of modes ( @xmath9 ) that are considered in the simulation .",
    "if numerical methods relying on e.g. loops and conditionals or direct matrix calculations are used , then the computation time will scale cubically to highest order .",
    "although the exact algorithms used by different research groups have not been published , it is obvious from the computation times reported in the literature that quite inefficient algorithms have been used so far for calculating the nonlinear contribution to each frequency .",
    "simulation times of several days have been reported @xcite , despite the fact that only a few hundred modes are included in the simulations .",
    "it is obviously impractical to simulate combs containing thousands of resonant modes using such numerical codes , since an eightfold increase in computation time is required for each doubling of the number of modes .",
    "however , the cubic scaling property of the computation time is not inherent to the underlying system of coupled mode equations , but it merely depends on the choice of algorithm which is used in its implementation",
    ". there is , as we have already stated , no fundamental reason for simulations of the coupled mode equations to be significantly slower than those based on the driven and damped nls equation .",
    "the latter is usually solved by using standard tools developed for the simulation of the ordinary nls equation in e.g. optical fibers .",
    "numerical codes are commonly used that are based on the split - step fourier method @xcite . the computationally expensive nonlinear step in simulations using coupled mode equations",
    "can , in a similar manner to the split - step method , be performed in the time - domain using the fast fourier transform .",
    "this allows for a significant reduction in computational complexity , since the fft algorithm is @xmath10 instead of @xmath11 for a direct matrix calculation . to apply the fft , we first rewrite the coupled mode equations in a suitably normalized form , viz .",
    "@xmath12 where we have introduced : @xmath13 , @xmath14 , @xmath15/\\kappa_0 $ ] and @xmath16 , cf .",
    "the delta function in the nonlinear term stems from the energy conservation requirement that only those components that satisfy the relation @xmath17 should contribute to the field of mode @xmath0 . using tensor notation we may rewrite this term as @xmath18 with the dummy index @xmath19 .",
    "the right hand side of this expression can be recognized as being two autocorrelations , which can be calculated using products of the field s discrete fourier transform , viz .",
    "@xmath20 = \\frac{1}{n}\\sum_{j=0}^{n-1}(|\\hat{a}_j|^2\\hat{a}_j)e^{i2\\pi j\\mu / n},\\ ] ] with @xmath21 = \\sum_{\\mu=0}^{n-1}\\tilde{a}_\\mu e^{-i2\\pi",
    "j\\mu / n}$ ] denoting the forward transform .",
    "the computation time for coupled mode simulations can thus be reduced substantially , if fft algorithms are used to calculate these transforms .",
    "however , note that the fourier transform is defined with respect to the mode number @xmath0 and not the actual resonant frequencies @xmath3 of the normalized eq.([eq : ncme ] ) , which implies that the transform will generally correspond to a distorted temporal profile of the field .",
    "it is seen that the transformed four - wave - mixing term takes the same form as the kerr nonlinearity in the nls equation . indeed , this should not be surprising , since the coupled mode equations are fundamentally nothing but a discrete fourier expansion of a driven and damped nls type equation , with some possible additional terms .",
    "the lle model provides a single partial differential equation , which when discretized becomes a coupled system of ordinary differential equations .",
    "the lle is a time - domain description , which models the field using a two time - scale approach , while the coupled mode equations provide a frequency domain description that does not make explicit use of the fast time - scale .",
    "we will briefly mention two methods by which the coupled mode equations can be efficiently simulated .",
    "one may , e.g. , use an ordinary ode solver , such as a typical fourth - order runge - kutta solver , for the temporal evolution and compute the sum of the nonlinear contributions using ffts .",
    "one may also use a split - step fourier method of the same sort used to simulate the lle , but consider the field to be in the frequency domain instead of the time - domain .",
    "the last method is perhaps most interesting since it blurs the difference between the solution of a system of exact coupled odes or a discretized pde .",
    "we have implemented both methods and made comparisons of the simulation times for @xmath22 ( zero padded to @xmath23 ) mode wide frequency combs with identical parameters to those considered by chembo et al . in @xcite , who reported a time for a coupled mode simulation of a few days using a laptop computer .",
    "we found that either of the above methods allowed us to perform the same simulation in less than one minute using a standard desktop computer , see fig .",
    "[ fig : combs ] , which is on par with simulations based on the lle equation , cf .",
    "@xcite .    , @xmath24 , @xmath25 , @xmath26 and @xmath27 in descending order .",
    "total elapsed simulation time 54 seconds for the ensemble of four simulations . ]",
    "each different formalism has its own set of benefits and drawbacks .",
    "coupled mode equations are often convenient to use , since they easily allow for frequency dependent absorption and coupling coefficients to be included .",
    "they can also be used to study cascaded frequency combs that have a non commensurate frequency spectrum , see @xcite .",
    "they are further convenient since they provide a direct frequency domain description of the optical comb .",
    "the drawback is that they do not give any direct time - domain information , so that if the temporal profile is desired it must be synthesized using the frequency components .",
    "it is also more difficult to extend the coupled system of equations in order to include the nonlinear effects of , e.g. , self - steepening @xcite and raman scattering @xcite .",
    "the driven and damped nls equation has , conversely , previously been used to model dispersive fiber - ring cavities and it may be more familiar , since it is closely related to the ordinary nls equation and its extensions for describing supercontinuum generation , which are widely used in nonlinear optics and other fields",
    ". the lle model may also be more conductive to analytical developments , allowing for soliton solutions to be studied more easily , e.g. , by means of perturbation theory @xcite .",
    "in conclusion , we have shown that numerical simulations using coupled mode equations can be as efficient as those based on the driven and damped nonlinear schrdinger formalism .",
    "this is possible if the computationally expensive nonlinearity is computed in the time - domain , in a similar manner to the conventional split - step fourier method .",
    "fft algorithms can then be used , which provides a significant improvement in the computation time , resulting in orders of magnitude time savings over simulations reported by other methods in the literature .",
    "this permits for broadband combs to be readily simulated , and enables the modeling of octave spanning kerr frequency combs consisting of not hundreds but thousands or more modes .",
    "indeed , we have demonstrated that the driven and damped nls and the coupled mode equations are essentially equivalent , as far as the computation time is involved , so that the choice of either formalism should not be based on simulation complexity .",
    "rather , the choice of either approach should only depend on the particular convenience which is provided by the associated formalism for adequately modeling the problem at hand .",
    "this research was funded by fondazione cariplo , grant no .",
    "2011 - 0395 .",
    "99 t. j. kippenberg , r. holzwarth and s. a. diddams , science 332 ( 2011 ) 555 a. b. matsko , a. a. savchenkov , d. strekalov , v. s. ilchenko , and l. maleki , phys .",
    "a 71 ( 2005 ) 033804 y. k. chembo , and n. yu , phys .",
    "a 82 ( 2010 ) 033801 a. b. matsko , a. a. savchenkov , w. liang , v. s. ilchenko , d. seidel , and l. maleki , opt",
    "36 ( 2011 ) 2845 t. hansson , d. modotto , and s. wabnitz , submitted for publication in phys .",
    "a ( 2013 ) s. coen , h. g. randle , t. sylvestre , and m. erkintalo , opt .",
    "38 ( 2013 ) 37 y. k. chembo , and c. r. menyuk , phys .",
    "a 87 ( 2013 ) 053852 m. haelterman , s. trillo , and s. wabnitz , opt . comm . 91",
    "( 1992 ) 401 m. r. e. lamont , y. okawachi , and a. l. gaeta , arxiv:1305.4921 [ physics.optics ] ( 2013 ) g.  p.  agrawal , nonlinear fiber optics 4th ed , academic press , san diego , 2007 t. herr , k. hartinger , j. riemensberger , c. y. wang , e. gavartin , r. holzwarth , m. l. gorodetsky , t. j. kippenberg , nature phot . 6",
    "( 2012 ) 480 t. herr , v. brasch , j. d. jost , c. y. wang , n. m. kondratiev , m. l. gorodetsky , and t. j. kippenberg , arxiv:1211.0733v2 [ physics.optics ] ( 2012 ) s. wabnitz , j. opt .",
    "b 13 ( 1996 ) 2739"
  ],
  "abstract_text": [
    "<S> it is demonstrated that kerr frequency comb generation described by coupled mode equations can be numerically simulated using fast fourier transform methods . </S>",
    "<S> this allows broadband frequency combs spanning a full octave to be efficiently simulated using standard algorithms , resulting in orders of magnitude improvements in the computation time .    </S>",
    "<S> kerr frequency combs , coupled mode equations , numerical simulation , split - step method , fast fourier transform </S>"
  ]
}