{
  "article_text": [
    "computational topology of surfaces has received much attention in the last two decades . among the notable results we may mention the test of homotopy between two cycles on a surface  @xcite , the computation of a shortest cycle homotopic to a given cycle  @xcite , or the computation of optimal homotopy and homology bases  @xcite . in their 1999 paper , dey and guha announced a linear time algorithm for testing whether two curves on a triangulated surface",
    "are freely homotopic .",
    "this appeared as a major breakthrough for one of the most basic problem in computational topology .",
    "dey and guha s approach relies on results by greendlinger  @xcite for the conjugacy problem in one relator groups satisfying some small cancellation condition . in the appendix",
    ", we show several subtle flaws in the paper of dey and guha  @xcite that invalidate their approach and leave little hope for repair .",
    "inspired by the recent work of colin  de  verdire and erickson  @xcite for computing a shortest cycle in a free homotopy class , we propose a different geometric approach and confirm the results of dey and guha for orientable surfaces . as commonly assumed in computational topology , we shall analyse the complexity of our algorithms with the uniform cost ram  model of computation  @xcite .",
    "a notable feature of this model is the ability to manipulate arbitrary integers in constant time per operation and to access an arbitrary memory register in constant time .    in a first part we consider the homotopy test for curves with fixed endpoints drawn in a graph cellularly embedded in a surface  @xmath1 .",
    "this test reduces to decide if a loop is contractible in  @xmath1 , / null - homotopic , since a curve  @xmath2 is homotopic to a curve  @xmath3 with fixed endpoints if and only if the concatenation  @xmath9 is contractible .",
    "the contractibility test was already considered by dey and schipper  @xcite using a partial and implicit construction of the universal cover of  @xmath1 . indeed , a curve is null - homotopic in  @xmath1 if and only if its lift is closed in the universal cover of  @xmath1 . given a closed curve  @xmath2 , dey and schipper detect if @xmath2  is null - homotopic in @xmath10  time , where @xmath11  is the genus of  @xmath1 .",
    "their implicit construction is relatively complex and does not seem to extend to handle the free homotopy test .",
    "our solution to the contractibility test also relies on a partial construction of the universal cover .",
    "we use the more explicit construction of colin  de  verdire and erickson  ( * ? ? ?",
    "3.3  and  4 ) for tightening paths .",
    "it amounts to build a convex region of the universal cover ( with respect to some hyperbolic metric ) large enough to contain a lift of  @xmath2 .",
    "an argument _  la dehn _ shows that this region can be chosen to have size  @xmath12 , leading to our first theorem :    [ th : contractibility - test ] let  @xmath0 be a graph of complexity  @xmath13 cellularly embedded in a surface  @xmath1 , not necessarily orientable .",
    "we can preprocess  @xmath0 in @xmath14  time , so that for any loop  @xmath2 on  @xmath1 represented as a closed walk of @xmath15  edges in  @xmath0 , we can decide whether @xmath2  is contractible or not in @xmath16  time .",
    "we next study the free homotopy test , that is deciding if two cycles @xmath2  and  @xmath3 drawn in a graph  @xmath0 cellularly embedded in  @xmath1 can be continuously deformed one to the other . by theorem",
    "[ th : contractibility - test ] , we may assume that none of @xmath2  and  @xmath3 is contractible .",
    "our strategy is the following .",
    "we first build ( part of ) the cyclic covering of  @xmath1 induced by the cyclic subgroup generated by @xmath2 in the fundamental group of  @xmath1 .",
    "we denote by  @xmath17 this covering . assuming that @xmath1  is orientable",
    ", @xmath17 is  a topological cylinder  is non orientable , its cyclic coverings can be either cylinders or mbius rings .",
    "] , and we call any of its non - contractible simple cycles a _ generator_. since the generators of  @xmath17 are freely homotopic , their projection on  @xmath1 are freely homotopic to  @xmath2 . our next task is to extract from  @xmath17 a _ canonical _",
    "generator  @xmath18 whose definition only depends on the isomorphism class of  @xmath17 . to this end , we lift in  @xmath17 the graph  @xmath0 of  @xmath1 and we endow  @xmath17 with the corresponding cross - metric introduced by colin  de  verdire and erickson  @xcite .",
    "the set of generators that are minimal for this metric form a compact annulus in  @xmath17 .",
    "we eventually define @xmath18  as the `` right '' boundary of this annulus .",
    "we perform the same operations starting with  @xmath3 instead of  @xmath2 to extract a canonical generator  @xmath19 of  @xmath20 . from standard results on covering spaces  (",
    "* v.6 ) , we know that @xmath17  and  @xmath20 are isomorphic covering spaces if @xmath2  and  @xmath3 are freely homotopic .",
    "it follows that @xmath2  and  @xmath3 are freely homotopic if and only if @xmath18  and  @xmath19 have equal projections on  @xmath1 . proving that @xmath18  and  @xmath19 can be constructed in time proportional to @xmath7  and  @xmath8 respectively , we finally obtain :    [ th : free - homotopy - test ] let  @xmath0 be a graph of complexity  @xmath13 cellularly embedded in an orientable surface  @xmath1 .",
    "we can preprocess  @xmath0 in @xmath14  time , so that for any cycles @xmath2  and  @xmath3 on  @xmath1 represented as closed walks with a total number of  @xmath15 edges in  @xmath0 , we can decide if @xmath2  and  @xmath3 are freely homotopic in @xmath16  time .",
    "the _ word problem _ in a group presented by generators and relators is to decide if a product of generators and their inverses , called a _ word _ , is the unit in the group .",
    "the _ conjugacy problem _ is to decide if two words represent conjugate elements in the group .",
    "the length of a word is its number of factors . as an immediate consequence of our two theorems",
    ", we can solve the word problem and the conjugacy problem in surface groups in optimal linear time . more precisely , suppose we are given a presentation by generators and by a single relator of the fundamental group of a compact surface  @xmath1 of genus  @xmath11 without boundary .",
    "after @xmath21  time preprocessing , we can solve the word problem in time proportional to the length of the word .",
    "moreover , if @xmath1  is orientable we can report if two words are conjugate in time proportional to their total length .",
    "the preprocessing reduces to build a cellular embedding of a wedge of loops in  @xmath1 , with one loop for each generator ; the rotation system of this embedding ( see the background section for a definition ) is easily deduced from the relator of the group .",
    "any word can then be interpreted as a walk in this cellular embedding so that we can directly apply the previous theorems .",
    "the word and conjugacy problems have a long standing history starting with dehn s seminal papers  @xcite .",
    "recent developments include linear time solutions to the word problem in much larger classes of groups comprising hyperbolic groups  @xcite .",
    "we emphasize that such developments assume a multi - tape turing machine as a model of computation and , most importantly , that the size of the group presentation is considered as a constant . in our case ,",
    "the group itself is part of the input and , after the preprocessing phase , the decision problems have linear time solutions _ independent of the genus of the surface_.    [ [ organization - of - the - paper . ] ] organization of the paper .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + +    we start recalling some necessary terminology and properties of surfaces , coverings and cellular embeddings of graphs in section  [ sec : background ] .",
    "we solve the contractibility test and prove theorem  [ th : contractibility - test ] in section  [ sec : contractibility - test ] .",
    "the proof of theorem  [ th : free - homotopy - test ] for the free homotopy test is given in section  [ sec : free - homotopy - test ] .",
    "we eventually give some counter - examples to the results of dey and guha  @xcite in the appendix .",
    "we review some basic definitions and properties of surfaces and their covering spaces , as well as combinatorial embeddings of graphs .",
    "we refer the reader to massey  @xcite or stillwell  @xcite for further details on covering spaces .",
    "[ [ surfaces . ] ] surfaces .",
    "+ + + + + + + + +    we only consider surfaces without boundary .",
    "a * _ surface _ * ( or @xmath22/manifold )  @xmath1 is a connected , hausdorff topological space where each point has a neighborhood homeomorphic to the plane .",
    "a compact surface is homeomorphic to a sphere where either :    * @xmath23  open disks are removed and a handle ( / a perforated torus with one boundary component ) is attached to each resulting circle , or * @xmath24  open disks are removed and a mbius band is attached to each resulting circle .",
    "the surface is called * _ orientable _ * in the former case and * _ non - orientable _ * in the latter case . in both cases",
    ", @xmath11  is the * _ genus _ * of the surface",
    ".    a * _ path _ * in a surface  @xmath1 , is a continuous map @xmath25\\to { { \\mathcal s}}$ ] . a * _ loop _ * is a path  @xmath26 whose endpoints @xmath27  and  @xmath28 coincide .",
    "this common endpoint is called the * _ basepoint _ * of the loop .    [ [ homotopy - and - fundamental - group . ] ] homotopy and fundamental group .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    two paths @xmath26 ,  @xmath29 in  @xmath1 are * _ homotopic _ * ( with fixed endpoints ) if there is a continuous map @xmath30\\times [ 0 , 1 ] \\rightarrow { { \\mathcal s}}$ ] such that @xmath31 and @xmath32 for all  @xmath33 , and @xmath34  and  @xmath35 are constant maps .",
    "being homotopic is an equivalence relation .",
    "the set of homotopy classes of loops with given basepoint  @xmath36 forms a group where the operation in the group corresponds to the concatenation of the loops .",
    "this group is called the * _ fundamental group _ * of  @xmath1 and denoted by  @xmath37 . the homotopy class of a loop  @xmath2 is denoted by  @xmath38 $ ] .",
    "the loop  @xmath2 is said * _ contractible _ * , or null - homotopic , if @xmath2  is homotopic to the constant loop , / if @xmath38 $ ] is the identity of  @xmath37 .",
    "the fundamental group of the orientable surface  @xmath1 of genus  @xmath39 admits finite minimal presentations composed of @xmath40  generators and one relator expressed as the product of @xmath41  generators and their inverses .",
    "a  group defined by a set  @xmath42 of generators and a set  @xmath43 of relators is denoted  @xmath44 . in particular",
    ", @xmath37  is isomorphic to the * _ canonical _ * presentation @xmath45 but not all minimal presentations of  @xmath37 are canonical . likewise",
    ", the fundamental group of the non - orientable surface of genus  @xmath11 has a presentation with @xmath11  generators and one relator of length  @xmath40 .    two loops @xmath2",
    ",  @xmath3 in  @xmath1 are * _ freely homotopic _ * if there is a continuous map @xmath46\\times [ 0 , 1 ] \\rightarrow { { \\mathcal s}}$ ] such that @xmath47 , @xmath48 and @xmath49 for all  @xmath50 . the loops @xmath2  and  @xmath3 of respective basepoints @xmath51  and  @xmath52 are freely homotopic if and only if @xmath38 $ ]  and  @xmath53 $ ] are conjugate in  @xmath37 for any path  @xmath54 linking @xmath51  to  @xmath52 .    [ [ covering - spaces . ] ] covering spaces .",
    "+ + + + + + + + + + + + + + + +    a * _ covering space _ * of the surface  @xmath1 is a surface  @xmath55 together with a continuous surjective map  @xmath56 such that every  @xmath57 lies in an open neighborhood  @xmath58 such that @xmath59  is a disjoint union of open sets in  @xmath55 , each of which is mapped homeomorphically onto  @xmath58 by  @xmath60 .",
    "the map  @xmath60 is called a * _ covering map _ * ; it induces a monomorphism @xmath61 , so that @xmath62  can  be considered as a subgroup of  @xmath63 .",
    "if @xmath26  is a path in  @xmath1 and @xmath64 with @xmath65 , then there exists a unique path @xmath66\\to{{\\mathcal s}}'$ ] , called a * _ lift _ * of  @xmath26 , such that @xmath67 and @xmath68 .",
    "a * _ morphism _ * between the covering spaces @xmath69  and  @xmath70 of  @xmath1 is a continuous map @xmath71 such that @xmath72 .",
    "up to isomorphism , each surface  @xmath1 has a unique simply connected covering space , called its * _ universal cover _ * and denoted  @xmath73 . unless @xmath1  is a sphere or a projective plane @xmath73  has the topology of a plane .",
    "more generally , for every subgroup  @xmath74 of  @xmath37 there is a covering space of  @xmath1 , unique up to isomorphism , whose fundamental group is conjugate to  @xmath74 in  @xmath37 .",
    "if  @xmath74  is cyclic and generated by the homotopy class of a non - contractible loop  @xmath2 in @xmath1 , this covering space is called the @xmath2/*_cyclic cover _ * and denoted by  @xmath17 .",
    "the @xmath2/cyclic cover can be constructed as follows : take a lift  @xmath75 of  @xmath2 in the universal cover  @xmath73 and let @xmath76  be  the unique automorphism of  @xmath73 sending  @xmath77 to  @xmath78 ; then @xmath17  is the quotient of the action of  @xmath79 on  @xmath73 . when @xmath1  is orientable , @xmath17  has the topology of a cylinder whose generators project on  @xmath1 to loops that are freely homotopic to  @xmath2 or its inverse .",
    "conversely , every loop freely homotopic to  @xmath2 has a closed lift generating the fundamental group of  @xmath17 . in section  [ sec :",
    "free - homotopy - test ] we shall use the following properties of curves on cylinders .",
    "we assume that the considered curves are in general position : all ( self-)intersections are transverse and have multiplicity two , / exactly two curve pieces cross at an intersection .    [ lem : cylinder-1 ] let  @xmath2  be a loop obtained as the concatenation of @xmath15  simple paths on a cylinder .",
    "then @xmath2  is freely homotopic to the @xmath80/th power of a generator of the cylinder with  @xmath81 .",
    "we view the cylinder as a punctured plane ; so that the @xmath80/th power of a generator has winding number  @xmath80 with respect to the puncture .",
    "the winding number of  @xmath2 is the sum of the angular extend of each of its subpaths divided by  @xmath82 .",
    "but the angular extend of a simple path has absolute value strictly smaller than  @xmath82 .",
    "[ lem : cylinder-2 ] a self - intersecting generator of a cylinder has a contractible closed subpath .",
    "consider a self - intersecting generator  @xmath83 and define a bigon of  @xmath83 as a disk bounded by two subpaths of  @xmath83 . applying local homotopies to  @xmath83",
    "we can remove all of its bigons one by one .",
    "if  @xmath83  is still self - intersecting , it must have a contractible subpath by ( * ? ? ?",
    "* lemma 1.4 ) .",
    "if  @xmath83  is simple , we consider the loop just before we remove the last bigon .",
    "it is easily seen that this loop has a contractible subpath . in both cases",
    "we have found a contractible subpath that corresponds to a contractible subpath of the initial loop if we undo the local homotopies .    for completeness , we also give a self - contained proof .",
    "we again view the cylinder as a punctured plane .",
    "consider the domain of  @xmath83 as the unit circle  @xmath84 .",
    "loop - segment _ is a closed connected part @xmath85\\subset{\\mathbb{r}}/{\\mathbb z}$ ] whose image by @xmath83 is a simple loop , / such that @xmath86 and the restriction of  @xmath83 to  @xmath87 is one - to - one .",
    "let @xmath88,\\ldots,[x_k , y_k]$ ] be a maximal set of pairwise interior disjoint loop - segments . by the general position assumption",
    ", @xmath15  is finite .",
    "we denote by  @xmath89 the restriction of  @xmath83 to  @xmath90 $ ] .",
    "it is easily seen that @xmath91 $ ] has at most @xmath15  connected components ( exactly  @xmath15 if we take into account that each self - intersection has multiplicity two ) whose images are simple paths composing a loop  @xmath2 .",
    "if some loop  @xmath89 is contractible , then we are done . otherwise , being simple , each  @xmath89 has winding number  @xmath92 .",
    "let  @xmath93  denote the winding number of  @xmath2 .",
    "by additivity of the winding number , we have @xmath94 by the preceding lemma we have @xmath95 , implying that @xmath96 for some  @xmath97 $ ] .",
    "it ensues that the complementary part of  @xmath98 in  @xmath83 is a loop with winding number  @xmath99 , hence contractible .",
    "[ [ cellular - embeddings - of - graphs . ] ] cellular embeddings of graphs .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    all the considered graphs may have loop edges and multiple edges .",
    "we denote by @xmath100  and  @xmath101 the set of vertices and edges of a graph  @xmath0 , respectively .",
    "a graph  @xmath0 is * _ cellularly embedded _ * on a surface  @xmath1 if every open face of ( the embedding of )  @xmath0 on  @xmath1 is a disk .",
    "following mohar and thomassen  @xcite , the embedding of  @xmath0 can be encoded by adjoining to the data of  @xmath0 a * _ rotation system_*. the rotation system provides for every vertex in  @xmath100 a cyclic permutation of its incident edges . for a finite graph  @xmath0 ,",
    "storing a cellular embedding takes a space linear in the * _ complexity _ * of  @xmath0 , that is , in its total number of vertices and edges . a * _ facial walk _ * of  @xmath0",
    "is then obtained by the face traversal procedure described in  @xcite .",
    "rotation systems can be implemented efficiently  @xcite so that we can traverse the neighbors of a vertex in time proportional to its degree or obtain a facial walk in time proportional to its length .",
    "any graph  @xmath0 cellularly embedded in  @xmath1 has a * _ dual graph _ * denoted  @xmath102 whose vertices and edges are in one - to - one correspondence with the faces and edges of  @xmath0 respectively ; if two faces of  @xmath0 share an edge  @xmath103 its * _ dual edge _ *  @xmath104 links the corresponding vertices of  @xmath102 .",
    "this dual graph can be cellularly embedded on  @xmath1 so that each face of  @xmath0 contains the matching vertex of  @xmath102 and each edge  @xmath105 dual of  @xmath106 crosses only  @xmath107 , only once .",
    "let  @xmath69 be a covering space of  @xmath1 .",
    "the * _ lifted graph _ * @xmath108 is cellularly embedded in  @xmath55 .",
    "the restriction of  @xmath60 from the star of each vertex  @xmath109 to the star of  @xmath110 is an isomorphism .",
    "note that @xmath55  can  be non compact even though @xmath1  is compact .",
    "in that case , @xmath111  has an infinite number of edges and vertices .",
    "[ [ regular - paths - and - crossing - weights . ] ] regular paths and crossing weights .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    for the free homotopy test in section  [ sec : free - homotopy - test ] , we make use of the cross metric surface model  @xcite . let  @xmath0  be a graph cellularly embedded in  @xmath1 .",
    "a path @xmath26  in  @xmath1 is * _ regular _ * for  @xmath0 if every intersection point of @xmath26  and  @xmath0 is an endpoint of  @xmath26 or a transverse crossing , / has a neighbourhood in which @xmath112  is homeomorphic to two perpendicular line segments intersecting at their midpoint .",
    "the * _ / _ * with respect to  @xmath0 of a regular path  @xmath26 is the number  @xmath113 of its transverse crossings and is always finite . in particular ,",
    "if @xmath26  is a path of the dual graph  @xmath102 then @xmath26  is regular for  @xmath0 and @xmath113  is the number of edges in  @xmath26 .",
    "[ [ homotopy - encoding - in - cellular - graph - embeddings . ] ] homotopy encoding in cellular graph embeddings .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    consider a graph  @xmath0 cellularly embedded in  @xmath1 .",
    "if @xmath114  is a subgraph of  @xmath0 , we will denote by  @xmath115 the surface obtained after cutting  @xmath1 along  @xmath114 .",
    "if @xmath115  is a topological disk , then @xmath114  is called a * _ cut graph_*. a cut graph can be computed in linear time  @xcite .",
    "note that a cut graph defines a cellular embedding in  @xmath1 with a unique face .",
    "let  @xmath116 be a spanning tree of a cut graph  @xmath114 and consider the set of edges @xmath117 .",
    "see figure  [ fig : cut - graph ] .",
    "if @xmath1  is a compact surface of genus  @xmath11 , euler s formula easily implies that @xmath42  contains either @xmath40  or  @xmath11 edges depending on whether @xmath1  is respectively orientable or non - orientable . for each vertex  @xmath118",
    ", we have @xmath119 , where @xmath120  is the facial walk of the unique face of  @xmath114 and @xmath121  denotes its restriction to the edges in  @xmath42 .",
    "indeed , if we contract  @xmath116 to the vertex  @xmath50 in  @xmath1 , the graph  @xmath114 becomes a bouquet of circles whose complementary set in  @xmath1 is a disk bounded by the facial walk  @xmath121 .",
    "the above group presentation then follows from the classical seifert and van kampen theorem  ( * ? ? ?",
    "let  @xmath2 be a closed walk in  @xmath0 with basepoint  @xmath122 .",
    "denote by  @xmath123 the unique simple path in  @xmath116 from  @xmath50  to  @xmath51 .",
    "we can express the homotopy class  @xmath124 $ ] of the closed walk @xmath125 as follows .",
    "let @xmath126 be the sequence of vertices that belong to  @xmath114 , while walking along  @xmath127 .",
    "the subpath of  @xmath127 between @xmath128  and  @xmath129 is homotopic to a subpath  @xmath130 of the facial walk  @xmath120 between occurrences of @xmath128  and  @xmath129 .",
    "denote by  @xmath131 the restriction of  @xmath130 to the edges in  @xmath42 .",
    "we have , in the above presentation of  @xmath132 : @xmath133 = ( w_1|_a)\\cdot(w_2|_a)\\dotsm ( w_k|_a)\\ ] ] we call such a product a * _ term product _ * representation of  @xmath124 $ ] of * _ height _ *  @xmath15 .",
    "if we encode each term  @xmath131 implicitly by two pointers , in  @xmath121 , corresponding to its first and last edge , the above representation can be stored as a list of @xmath15  pairs of pointers .",
    "[ lem : term - product ] let  @xmath0 be a graph of complexity  @xmath13 cellularly embedded on a surface  @xmath1 .",
    "we can preprocess @xmath0  and its embedding in @xmath14  time such that the following holds . for any closed walk  @xmath2 in  @xmath0 with @xmath15  edges",
    ", we can compute in @xmath16  time a term product representation of height at most  @xmath15 of some closed walk freely homotopic to  @xmath2 .    from the preceding discussion",
    ", we just need to decompose the closed walk @xmath134 in at most  @xmath15 terms , spending constant time per term . for this",
    ", we first compute a cut graph  @xmath114 , a spanning tree  @xmath116 and the set  @xmath135 as above .",
    "we also determine the facial walk @xmath136 of the embedding of  @xmath114 .",
    "we consider @xmath120  as  a cyclic sequence of edges , meaning that @xmath137  is the successor of  @xmath138 . to every ( oriented ) edge  @xmath139 along  @xmath120",
    ", we attach a pointer  @xmath140 toward the last previous edge in  @xmath120 that belongs to  @xmath42 and a pointer  @xmath141 toward the first successive edge in  @xmath42 .",
    "thus , @xmath140  and  @xmath141 point to  @xmath139 if @xmath139  is in  @xmath42 . for each @xmath142 , let  @xmath143 be the set of oriented edges of  @xmath0 sharing the head vertex of  @xmath139 and strictly between @xmath139  and  @xmath144 ( taking indices modulo  @xmath145 ) in counterclockwise order around that head . to each oriented edge in  @xmath143 we attach a pointer toward  @xmath140 with an _ exit _ flag , and we attach to its opposite edge a pointer toward  @xmath146 with an _ enter _ flag .",
    "an oriented edge with both endpoints in  @xmath114 will thus receive an exit and an enter flag .",
    "we finally attach the null pointer to the remaining oriented edges .",
    "this whole preprocessing step can clearly be performed in @xmath14  time with the appropriate data structure for storing the embedding of  @xmath0 .",
    "see figure  [ fig : homotopy - encoding].a for an illustration .    given  @xmath2 ,",
    "we search along  @xmath2 for an edge  @xmath107 that is either an entering edge or an edge in  @xmath42 . if there is no such edge , @xmath2  is  either contained in the interior of the facial disk bounded by  @xmath120 or contained in  @xmath116 ; in both cases , @xmath2  is contractible . otherwise , we define  @xmath51 as the tail vertex of  @xmath107 .",
    "the terms of the decomposition of  @xmath127 can now be obtained by listing in order , starting from  @xmath107 , its edges in  @xmath42 ( they define a term with a unique edge ) and its successive pairs of enter / exit edges along  @xmath2 , using their attached pointers , respectively @xmath147  and  @xmath148 , for the encoding ( see figure  [ fig : homotopy - encoding].b ) .",
    "this clearly takes time proportional to the length of  @xmath2 and produces at most @xmath15  terms .",
    "after reduction to a simplified framework , our test for the contractibility of a closed curve  @xmath26 drawn on  @xmath1 relies on the construction of a _ relevant region _",
    "@xmath149 in a specific tiling of the universal cover  @xmath73 of  @xmath1 .",
    "this relevant region , introduced by colin  de  verdire and erickson  @xcite , contains a lift of  @xmath26 and we shall compute that lift as we build  @xmath149 .",
    "we can now decide whether  @xmath26 is contractible by just checking if its lift is a closed curve in  @xmath73 .",
    "we detail our simplified framework and tiling of  @xmath73 , as well as some of its combinatorial properties , in section  [ subsec : simplified - framework ] .",
    "we define the relevant region and its construction in section  [ subsec : algo - contractibility ] .",
    "[ [ graphic - interpretation - of - term - products . ] ] graphic interpretation of term products .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    following lemma  [ lem : term - product ] , we can assume that @xmath0  is in reduced form , with a single vertex  @xmath50 and a single face , and that the input closed walks are given by their term product representations in  @xmath150 .",
    "we denote by  @xmath151 the size of the facial walk  @xmath152 .",
    "hence , @xmath153  if @xmath1  is orientable with genus  @xmath11 and @xmath154  if @xmath1  is a non - orientable surface of genus  @xmath11 .",
    "we  can view the cut surface  @xmath155 as an open regular @xmath151/gon  @xmath156 whose boundary sides are labelled by the edges in  @xmath152 .",
    "obviously , the boundary  @xmath157 of  @xmath156 maps to  @xmath0 after gluing back the sides of  @xmath156 , and its vertices all map to  @xmath50 .",
    "each subpath of  @xmath152 labels one ( or more ) oriented subpath of  @xmath157 which we can associate with the chord between its endpoints .",
    "a term product representation can thus be seen as a sequence of chords inside  @xmath156 , where each chord stands for a term . in order to represent these chords as walks of constant complexity , we introduce an embedded graph  @xmath114 obtained as follows .",
    "consider the radial graph in  @xmath156 linking the center of  @xmath156 to each vertex of  @xmath157 along a straight segment ; this graph has @xmath158  vertices and @xmath151  edges .",
    "after gluing back the boundary of  @xmath156 we obtain a bipartite graph  @xmath114 cellularly embedded on  @xmath1 with two vertices  @xmath159 and @xmath151  edges .",
    "both vertices of  @xmath114 are @xmath151/valent ; each of the @xmath160  faces of  @xmath114 is of length  @xmath161 and is cut in two `` triangles '' by the unique edge of  @xmath0 it contains  see figure  [ fig : radial - graph ] .",
    "we call @xmath114  the * _ radial graph _ * of  @xmath0 . a rotation system of  @xmath114 can be computed from that of  @xmath0 in @xmath162  time .",
    "any chord in  @xmath156 is now homotopic to the @xmath22/walk with the same extremities and passing through  @xmath33 . consequently , if @xmath38 = w_1 \\dotsm w_k$ ] is a term product representation of height  @xmath15 stored as a list of pointers then in @xmath163  time we can obtain a closed walk of length  @xmath164 in  @xmath114 , homotopic to  @xmath2 .    [ [ tiling - of - the - universal - cover . ] ] tiling of the universal cover .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    let  @xmath165 be the universal cover of  @xmath1 .",
    "a loop of  @xmath114 is contractible if and only if its lift in  @xmath73 is a loop and we want to construct a finite part of  @xmath73 large enough to contain that lift . to this end",
    "we rely on a decomposition of  @xmath73 similar to the octagonal decomposition of  @xcite . due to our complexity constraints",
    "we can not afford the cost of computing a tight octagonal decomposition of  @xmath1 .",
    "we nevertheless present a tiling of  @xmath73 with similar properties .",
    "the lifted graph  @xmath166 of  @xmath114 is an infinite regular bipartite graph with @xmath151/valent vertices and @xmath161/valent faces .",
    "a vertex of @xmath167 is said of * _ @xmath50/type _ * or * _ @xmath33/type _ * if it respectively projects to @xmath50  or  @xmath33 .",
    "let  @xmath168 be the dual of  @xmath114 on  @xmath1 chosen so that its vertices lie in the middle of the edges of  @xmath0 .",
    "the lifted graph  @xmath169 is the dual of  @xmath167 ; it is an infinite graph whose faces form a @xmath170/tiling of the universal cover , / four @xmath151/gon faces meet at every vertex of  @xmath169 .",
    "we say that two edges of  @xmath168 are * _ facing _ * each other if they share an endpoint  @xmath51 and are not consecutive in the circular order around  @xmath51 .",
    "the four  edges meeting at any vertex of  @xmath168 form two  pairs of facing edges . facing edges are defined similarly in  @xmath169 .",
    "the * _ line _ * induced by  @xmath171 is the smallest set  @xmath172 containing @xmath105  and the facing edge of any of its edges .",
    "every line is an infinite lift of some cycle of facing edges of  @xmath168 , but contrary to the tight cycles of the octagonal decomposition in  @xcite this cycle may self - intersect . in fact , it can happen that every line projects onto the _ same _ self - intersecting cycle of length  @xmath151 .",
    "( as an example , one may consider the case where the reduced graph  @xmath0 is embedded on the genus two orientable surface with @xmath173 . ) to begin with , we state a dehn - like result about tilings .",
    "it will used in section  [ subsec : algo - contractibility ] to bound the size of the relevant region .",
    "[ lem : dehn - argument ] let  @xmath174 be a regular @xmath175/tiling of the plane ( each face has @xmath151  edges and each vertex has @xmath161  neighbours ) with  @xmath176 .",
    "every finite non - empty union  @xmath43 of faces of  @xmath174 contains at least one face sharing @xmath177  consecutive edges with the boundary of  @xmath43 .",
    "we follow the proof in  @xcite and gather the faces of  @xmath174 in concentric rings at increasing distance to some root face .",
    "let  @xmath178 be a face of  @xmath43 in the outermost ring of  @xmath43 .",
    "at least @xmath179  consecutive edges of  @xmath178 lie on the boundary of  @xmath43 . indeed , @xmath178  shares ( at most ) two edges with other faces of the same ring , and at most one edge with faces of the ring just beneath it .",
    "one more edge of  @xmath178 lies on the boundary of  @xmath43 if @xmath178  shares no edge with the inner ring , or if at least one of the neighbors of  @xmath178 in the outermost ring is not in  @xmath43 . else , we can replace  @xmath178 by any of its two ring neighbors , which do not share edges with the inner ring , to obtain a face with the required property .",
    "let again  @xmath174 be a regular @xmath175/tiling of the plane with  @xmath180 . by the  curve theorem a closed simple path @xmath2 in the vertex - edge graph of @xmath174 bounds a finite union @xmath43 of faces .",
    "a vertex @xmath181 of @xmath2 is called * _ convex _ * , * _ flat _ * , or * _ reflex _ * if it is incident to respectively @xmath182 , @xmath183 , or @xmath22 edges interior to @xmath43 .",
    "a closed simple path @xmath2 has at least @xmath151 convex vertices .",
    "we denote by @xmath184 and @xmath185 the respective number of convex , flat and reflex vertices of @xmath2 .",
    "if @xmath43 is the region bounded by @xmath2 , we also denote by @xmath186 its number of faces and by @xmath187 its number of interior vertices .",
    "we finally set @xmath188 and call @xmath189 the total number of edges of the closed region @xmath43 . by double - counting of the vertex - edge incidences , we get : @xmath190 by double - counting of the face - edge incidences , we get : @xmath191 euler s formula then implies @xmath192 .",
    "multiplying by @xmath151 we obtain : @xmath193 and expending the values of @xmath194 and @xmath189 : @xmath195 since @xmath180 , we conclude that @xmath196",
    ".    we can now state the main properties of lines in  @xmath169 .",
    "[ prop : lines : no - bigon - triangle ] suppose that @xmath1  is orientable with genus  @xmath197 or non - orientable with genus  @xmath198",
    ". then lines of  @xmath169 do not self - intersect nor are cycles and two distinct lines intersect at most once .",
    "moreover , the following properties hold .    * * ( triangle - free property ) * three pairwise distinct lines can not pairwise intersect . * * ( quad - free property ) * four pairwise distinct lines can neither form a quadrilateral , / include a possibly self - intersecting @xmath161/gon .    with the above hypothesis @xmath169  defines a regular @xmath175/tiling of the plane with @xmath199 .",
    "a contradiction of any of the above properties would imply the existence of a region bounded by at most four lines .",
    "its boundary would contain a simple closed curve with at most four convex vertices , which is forbidden by the previous lemma .    [ lem : lines : separating ] every line cuts  @xmath73 in two infinite connected components .",
    "let  @xmath200  be a line induced by an edge  @xmath105 .",
    "we first show that @xmath201 has at most two connected components .",
    "consider a small disk  @xmath202 centered at the midpoint of  @xmath105 , so that @xmath203  has two half - disk components @xmath204  and  @xmath205 .",
    "any point  @xmath51 of  @xmath201 is in the same component as one of @xmath204  or  @xmath205 .",
    "indeed , we can use an approach path from  @xmath51 to a point close to  @xmath200 and then follow a path along  @xmath200 on the same side as  @xmath51 until we meet  @xmath202 , hence falling into @xmath204  or  @xmath205 .",
    "it remains to prove that @xmath201  has at least two components .",
    "consider the two endpoints @xmath52  and  @xmath206 of the edge  @xmath107 dual to  @xmath105 .",
    "let  @xmath26  be any path joining @xmath52  and  @xmath206 in @xmath73 .",
    "we just need to show that @xmath26  and  @xmath200 intersect . by pushing  @xmath26 along",
    "@xmath167 , it is easily seen that @xmath26  is homotopic to a path  @xmath29 in  @xmath167 .",
    "moreover , @xmath26  cuts  @xmath200 if and only if @xmath29  does so . since @xmath107  and",
    "@xmath29 share the same endpoints , their projection @xmath207  and  @xmath208 are homotopic paths of  @xmath114 in  @xmath1 .",
    "it is part of the folklore that homotopy in a cellularly embedded graph can be realized by combinatorial homotopies .",
    "such homotopies are finite sequences of elementary moves obtained by replacing a subpath contained in a facial walk by the complementary subpath in that facial walk .",
    "any combinatorial homotopy between @xmath207  and  @xmath208 lifts to a combinatorial homotopy between @xmath107  and  @xmath29 .",
    "since the lift of an elementary move preserve the parity of the number of intersections with  @xmath200 , we conclude that @xmath29  has an odd number of intersections with  @xmath200 .",
    "it follows that @xmath29 , whence  @xmath26 , must cross  @xmath200 .",
    "[ [ the - relevant - region . ] ] the relevant region .",
    "+ + + + + + + + + + + + + + + + + + + +    let  @xmath26  be a path in  @xmath167 .",
    "following  @xcite we denote by  @xmath209 , and call the * _ relevant region _ * with respect to  @xmath26 , the union of closed faces of  @xmath169 reachable from  @xmath27 by crossing only lines crossed by  @xmath26 , in any order . in other words ,",
    "if for any line  @xmath200 we denote by  @xmath210 the component of  @xmath201 that contains  @xmath27 , then @xmath209  is the `` convex polygon '' of  @xmath73 formed by intersection of the sets  @xmath211 for  all  @xmath200 _ not _ crossed by  @xmath26 .",
    "see figure  [ fig : poincare ] for an illustration .",
    "this region has interesting properties which make it easy and efficient to build :    [ lem : region : connected - inter - with - line ] for any path  @xmath212 and any line  @xmath200 the intersection  @xmath213 is either empty or a segment of  @xmath200 whose relative interior is entirely included in either the interior or the boundary of  @xmath209 .",
    "if @xmath213  is not empty , consider two points  @xmath214 . by definition of the relevant region , there is a path  @xmath54 joining @xmath51  to  @xmath52 ( through  @xmath27 ) whose relative interior is only crossed by lines also crossing  @xmath26 .",
    "any line crossing  @xmath200 between @xmath51  and  @xmath52 separates these two points , hence crosses  @xmath54 , hence crosses  @xmath26 .",
    "it easily follows that the open segment of  @xmath200 between @xmath51  and  @xmath52 is included in  @xmath209 , either along its boundary or in its interior .",
    "[ lem : region : small - number - of - faces ] @xmath209  contains at most @xmath215  faces of  @xmath167 .",
    "we recall that a vertex  @xmath181 of the boundary of  @xmath209 is * _ convex _ * if no line passing through  @xmath181 is crossed by  @xmath26 .",
    "it is  * _ flat _ * if on the contrary one line through  @xmath181 is crossed by  @xmath26 . by lemma",
    "[ lem : lines : separating ] , a line that intersects the interior of  @xmath209 must cross  @xmath26 . by lemma  [ lem :",
    "region : connected - inter - with - line ] , such a line intersect the boundary of  @xmath209 in at most two flat vertices .",
    "it follows that the number of flat vertices is at most  @xmath216 .",
    "if there is no flat vertex then @xmath209  is a single face , @xmath217 and the lemma holds .",
    "else , note that between two consecutive flat vertices there are at most @xmath177  convex vertices , all on the boundary of a single face .",
    "accordingly the boundary of  @xmath209 has at most @xmath218  edges .    on the other hand ,",
    "any union  @xmath43 of @xmath219  faces has at least @xmath220  edges on its boundary .",
    "indeed , thanks to lemma  [ lem : dehn - argument ] we can recursively remove a face with at least @xmath177  boundary edges to decrease the perimeter by at least  @xmath221 , until @xmath43  is empty . applying this last result to  @xmath209",
    "we get @xmath222 , whence : @xmath223 the latter inequality stemming from the hypothesis  @xmath224 .",
    "the next result is crucial for building the relevant region :    [ lem : region : construction ] let  @xmath26 be a path of  @xmath167 and let @xmath107  be an edge with @xmath28  as an endpoint .",
    "suppose @xmath107  crosses a line  @xmath200 not already crossed by  @xmath26 .",
    "then @xmath225  is a segment of the boundary of  @xmath209 along a connected set of faces  @xmath226 .",
    "moreover @xmath227 where @xmath228  is the reflection of  @xmath194 across  @xmath200 .",
    "the intersection point of @xmath107  and  @xmath200 belong to the same ( closed ) face of  @xmath209 as  @xmath28 .",
    "the set @xmath229  is thus non - empty and , by lemma  [ lem : region : connected - inter - with - line ] , connected .",
    "moreover , as @xmath200  does not cross  @xmath26 , the line segment @xmath230  is part of the boundary of  @xmath209 . in particular ,",
    "each edge in  @xmath230 bounds some face of  @xmath209 .",
    "these faces form a strip  @xmath194 where two consecutive faces have an interior edge of  @xmath209 in common .",
    "each face in  @xmath194 has a bounding edge in  @xmath230 that also bounds a symmetric face outside  @xmath209 .",
    "the union of these symmetric faces is the reflection  @xmath228 of  @xmath194 .",
    "furthermore @xmath231 since one can reach any face of  @xmath228 from the symmetrical face of  @xmath194 just by crossing  @xmath200 . to prove the reverse inclusion it is sufficient to show that none of the lines bounding  @xmath228 are crossed by  @xmath26 .",
    "a single face  @xmath178 of  @xmath228 is bounded by  @xmath200 , two _ inner _",
    "lines crossing  @xmath200 at vertices of  @xmath178 , and @xmath179  other _ outer _ lines .",
    "since these two inner lines both cross  @xmath200 , the triangle - free property ensures that the two are disjoint and bound a _",
    "band _ of  @xmath73 that contains  @xmath178 .",
    "no line crosses  @xmath200 in this band , and a line crossing  @xmath200 can not cross an inner line as the three would pairwise intersect  which is again prohibited by the triangle - free property . since the outer lines bounding  @xmath178 have an edge in the band they can not cross  @xmath200 , hence can not cross  @xmath26 .",
    "consider now an inner line  @xmath232 .",
    "it contributes to the boundary of  @xmath228 only when  @xmath178 is an extremal face of  @xmath228 . in that case , the symmetrical face of @xmath178 in @xmath194 is also extremal and @xmath232 is bounding @xmath209 .",
    "so that @xmath232  does not cross  @xmath26 .",
    "we conclude the proof by noting that @xmath200  is the last line to consider on the boundary of  @xmath228 .",
    "[ [ computing - the - relevant - region . ] ] computing the relevant region .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    following lemma  [ lem : region : construction ] we will build the relevant region of the lift  @xmath75 of a loop  @xmath2 incrementally as we lift its edges one at a time .",
    "if @xmath26  is the subpath of the lift  @xmath75 already traversed and @xmath233  is the edge following  @xmath26 in  @xmath75 we extend  @xmath209 to  @xmath234 whenever @xmath233  crosses the boundary of  @xmath209 . from lemma",
    "[ lem : region : small - number - of - faces ] , we know that @xmath209  contains @xmath235  faces . however , a naive representation of  @xmath209 as a subgraph of  @xmath169 with its faces and edges would require @xmath236  space , which we can not afford to obtain a linear time contractibility test . we rather store the interior of  @xmath209 by its dual graph , / by the subgraph of  @xmath167 induced by the vertices dual to the faces of  @xmath209",
    "more precisely , to represent such a finite subgraph  @xmath174 of  @xmath167 we use an abstract data structure with the following operations :    * @xmath237 , which returns and adds to  @xmath238 a new vertex  @xmath181 with no neighbour , where @xmath239  represents the projection  @xmath240 . *",
    "@xmath241 , which yields the projection  @xmath240 for any vertex  @xmath242  that is @xmath243 .",
    "* @xmath244 , which adds a new edge  @xmath245 with endpoints @xmath181  and  @xmath246 , where @xmath181  and  @xmath246 are existing vertices of  @xmath174 of different type and @xmath107  is an edge of  @xmath114 representing  @xmath247 . calling @xmath244 and  @xmath248 is equivalent , and using any of those more than once for the same @xmath181  and  @xmath107 is unsupported . * @xmath249 , which finds the other endpoint of the lift of  @xmath107 in  @xmath174 , if it exists .",
    "more formally , it returns the unique vertex  @xmath250 such that @xmath244 has been called , if it exists , and a special value  @xmath251 otherwise .    given a loop  @xmath2 in  @xmath114",
    ", the following procedure then constructs  @xmath252 :    1 .",
    "create a variable  @xmath181 which will point to the _ current endpoint _ of the partial lift of  @xmath2 . with the operation @xmath253 ,",
    "create a single vertex corresponding to the relevant region with respect to a null path .",
    "[ itm : computing - region : loop - step ] call @xmath107  the next edge to process in  @xmath2 ; if there is none left , exit .",
    "[ itm : computing - region : follow - step ] if @xmath254 , set @xmath255 and return to step  [ itm : computing - region : loop - step ] .",
    "[ itm : computing - region : mirror - step ] if @xmath256 , the partial lift is exiting the current relevant region .",
    "in other words the lift  @xmath233  of  @xmath107 crosses a line  @xmath200 not crossed until now and we are in the situation of lemma  [ lem : region : construction ] . we need to enlarge  @xmath174 by performing a _ mirror operation _ , creating and attaching vertices mirrored across  @xmath200 as suggested by the lemma .",
    "when done , @xmath257 and we can return to step  [ itm : computing - region : follow - step ] .",
    "when we reach the end of  @xmath2 we have computed the relevant region of its lift .",
    "moreover , @xmath2  is contractible if and only if its lift is closed , which reduces to the equality of the current endpoint  @xmath181 with the first created endpoint .",
    "it remains to detail the mirror operation .",
    "[ [ the - mirror - operation . ] ] the mirror operation .",
    "+ + + + + + + + + + + + + + + + + + + + +    let  @xmath258 and  @xmath259 such that @xmath260 .",
    "denote by  @xmath233 the lift of  @xmath107 from  @xmath181 in  @xmath167 and by  @xmath200 the line crossed by  @xmath233 .",
    "let also @xmath26  be the partial lift of  @xmath2 already processed ; in particular @xmath174  is the subgraph of  @xmath167 included in  @xmath209 .",
    "we begin the mirror sub - procedure by creating a vertex  @xmath261 , where @xmath262 , and calling @xmath244 so that @xmath233  is now represented in  @xmath174 .",
    "we say that two edges of  @xmath167 are * _ siblings _ * if their dual edges are facing each other in  @xmath169 .",
    "obviously two siblings cross the same line and have no common endpoint .",
    "the four edges bounding any face of  @xmath167 form two pairs of siblings matching the two pairs of facing edges around the corresponding vertex of  @xmath169 .",
    "let  @xmath263 be one of the two siblings of @xmath233 .",
    "denote by @xmath264  and  @xmath265 the other sibling pair bounding the same face as @xmath233  and  @xmath263 , so that @xmath181  is an endpoint of  @xmath264  see figure  [ fig : mirror ] .    if @xmath263  has an endpoint in  @xmath209 , or equivalently if @xmath266 , then by lemma  [ lem : region : construction ] @xmath233 ,  @xmath264 , @xmath263 and  @xmath265 are all included in  @xmath267 . in that case @xmath263  and  @xmath265",
    "need to be added to  @xmath174 .",
    "if on the contrary @xmath268 then @xmath181  lies in a face of  @xmath169 that is extremal in the chain  @xmath194 of lemma  [ lem : region : construction ] , and the sibling  @xmath263 should not be added to  @xmath174 .",
    "we proceed as follows : by walking from  @xmath240 around one face bounded by  @xmath107 in  @xmath114 we figure out the projections @xmath269 ,  @xmath137 and  @xmath270 of @xmath264 ,  @xmath263 and  @xmath265 respectively .",
    "if @xmath271 then we create @xmath272 , and call @xmath273 and @xmath274 .",
    "we handle similarly the sibling of  @xmath263 which is not  @xmath233 , walking around the other face bounded by  @xmath137 and checking whether @xmath275  is extremal in the chain  @xmath194 , and so on until we reach the end of  @xmath194 .",
    "there remains to do the mirror in the other direction , starting from the still unprocessed face of  @xmath114 bounded by  @xmath107 .",
    "eventually , every vertex dual to a face in the chain  @xmath228 of lemma  [ lem : region : construction ] has been created , and that lemma ensures that we missed no vertex . since each time we add a vertex",
    "we also add all its edges in  @xmath167 linking to existing vertices of  @xmath174 , we now have that @xmath174 is the dual graph of @xmath234 .    [ [ data - structure . ] ] data structure .",
    "+ + + + + + + + + + + + + + +    we present an implementation of the abstract graph structure that only needs _ constant time _ to perform any of its operations .",
    "we use a technique inspired from  ( * ? ? ?",
    "* exercise  2.12  p.  71 ) taking advantage of the ram  model to allocate in @xmath276  time an @xmath151/sized segment of memory without initializing it .",
    "we begin by giving integer indices between @xmath183  and  @xmath151 to edges of  @xmath114 .",
    "the index of @xmath107 will be denoted @xmath277 , and tables will be indexed from  @xmath183 . then :    * @xmath237 creates a vertex structure  @xmath181 with a field   pointing to  @xmath51 , an integer field   with value  @xmath182 , two uninitialized tables  and   of @xmath151  integers , and an uninitialized table   of @xmath151  pointers ; * @xmath241 returns the value of  ; * @xmath244 increments   in  @xmath181 , points  @xmath278 $ ] towards  @xmath246 , sets @xmath279\\leftarrow{\\mathrm{id}}(e)$ ] and @xmath280 \\leftarrow { \\hbox{\\texttt{count}}}$ ] , and affects  @xmath246 similarly ; * @xmath249 returns @xmath281 $ ] if we have @xmath282 \\leq { \\hbox{\\texttt{count}}}$ ] together with @xmath283 = { \\mathrm{id}}(e)$ ] , and returns @xmath251 otherwise .    of course if @xmath244 has been called for some  @xmath246 then @xmath249  will indeed return a pointer to  @xmath246 .",
    "if not , then @xmath280 $ ] will still be uninitialized , and even if by chance @xmath284 \\leq { \\hbox{\\texttt{count}}}$ ] the corresponding cell of will have been filled by another @xmath285  operation and the _ round - trip _ check will fail .",
    "[ [ complexity . ] ] complexity .",
    "+ + + + + + + + + + +    checking and adding a sibling in the mirror subprocedure needs one face traversal in  @xmath114 , one call to  @xmath286 and if needed one call to  @xmath287 and two to  @xmath285 .",
    "the initialisation of the mirror operation reduces to one call to  @xmath287 and another one to  @xmath285 . in the end",
    "all mirrors will have used at most one  @xmath286 , one  @xmath287 and  two  @xmath285 operations for each vertex of @xmath174  that is each face of @xmath252 . moreover ,",
    "step  [ itm : computing - region : follow - step ] in the construction of @xmath252 uses one  @xmath286 operation per edge of  @xmath2 . because every operation takes @xmath276  time , and thanks to lemma  [ lem : region : small - number - of - faces ] our algorithm takes @xmath288  time .",
    "taking into account the precomputation of lemma  [ lem : term - product ] we have proved theorem  [ th : contractibility - test ] when @xmath199 .",
    "this is the case when @xmath1  is an orientable surface of genus at least  @xmath22 or when @xmath1  is non - orientable with genus at least  @xmath289 . in the remaining cases",
    "we can expand the term product representations in @xmath290  time to obtain a word in the computed presentation of  @xmath132 .",
    "the word problem , that is testing if a word represents the unity in a group presentation , is trivial in those cases .",
    "this is clear for the torus or the projective plane since their fundamental group is commutative . when @xmath1  is the klein bottle",
    ", we can assume that the computed presentation is @xmath291 by applying an easy change of generators if necessary .",
    "the relator  @xmath292 allows us to commute @xmath293  and  @xmath294 up to an inverse and to get a canonical form @xmath295 in @xmath290  time .",
    "this in turn solves the word problem in linear time .",
    "we now tackle the free homotopy test .",
    "we restrict to the case where @xmath1  is an orientable surface of genus at least two",
    ". we can thus orient the cellular embedding .",
    "this amounts to give a preferred traversal direction to each facial walk .",
    "in particular , every oriented edge  @xmath107 belongs to exactly one such facial walk , which we designate as the left face of  @xmath107 .",
    "this allows us in turn to associate with  @xmath107 a dual edge oriented from the left face to the right face of  @xmath107 .",
    "this correspondence between the oriented edges of the embedded graph and its dual will be implicit in the sequel .",
    "we want to decide if two cycles @xmath2  and  @xmath3 on  @xmath1 are freely homotopic . after running our contractibility test on @xmath2  and  @xmath3",
    ", we can assume that none of these two cycles is contractible .",
    "from lemma  [ lem : term - product ] and the discussion of the simplified framework in section  [ subsec : simplified - framework ] , we can also assume that @xmath2  and  @xmath3 are given as closed walks in the radial graph  @xmath114 .",
    "let @xmath296  be the @xmath2/cyclic cover of  @xmath1 . recall that @xmath17  can be viewed as the orbit space of the action of  @xmath79 where @xmath76  is the unique automorphism of  @xmath165 sending @xmath77  on  @xmath78 for a given lift @xmath75 of  @xmath2",
    ". we will refer to  @xmath76 as a _ translation _ of  @xmath73 , as it can indeed be realized as a translation of the hyperbolic plane .",
    "notice that @xmath1  being orientable , @xmath76  is orientation preserving .",
    "the projection  @xmath297 sending a point of  @xmath73 to its orbit makes  @xmath298 a covering space of  @xmath17 with @xmath299 .",
    "we denote by @xmath300  and  @xmath301 the respective lifts of @xmath114  and  @xmath168 in  @xmath296 . in the sequel , regularity of paths in @xmath1 ,  @xmath73 or  @xmath17 is considered with respect to @xmath168 ,  @xmath169 and  @xmath301 respectively , and so are the /s of regular paths .",
    "recall that a line in  @xmath73 is an infinite sequence of facing edges in  @xmath169 .",
    "we start by stating some structural properties of lines .",
    "most of these properties appear in  @xcite in one form or another .",
    "however , due to our different notion of lines , we can not rely on the proofs in there .",
    "for instance , a line as in  @xcite projects to a simple curve in the @xmath2/cyclic cover  @xmath17 . in our case , though , a line may project to a self - intersecting curve in @xmath17 .",
    "in fact , as previously noted , it may be the case that all of our lines have the same projection on  @xmath1 .",
    "[ [ tautransversal - lines . ] ] @xmath76/transversal lines .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    let @xmath200  be a line such that @xmath302 and denote by  @xmath303 the open band of  @xmath73 bounded by @xmath200  and  @xmath304 .",
    "the line  @xmath200 is said * _ @xmath305/transversal _ * if @xmath306 is a fundamental domain has a unique representative in @xmath307 .",
    "] for the action of  @xmath308 over  @xmath73 .",
    "equivalently , @xmath200  is @xmath305/transversal if @xmath73  is the disjoint union of all the translates of  @xmath307 . in such a case",
    "we can obtain  @xmath17 by point - wise identification of the boundaries @xmath200  and  @xmath309 of  @xmath310 .",
    "the following proposition gives a characterisation @xmath76/transversal lines whose existence are stated in proposition  [ prop : transversal - existence ] .",
    "[ prop : lines : transversal - condition ] let @xmath200  be a line such that @xmath311 . then",
    ", @xmath200  is @xmath76/transversal if and only if there exists  @xmath312 such that @xmath200  separates @xmath51  from  @xmath313 but @xmath314  and  @xmath304 do not",
    ".    if @xmath307  is a fundamental domain , then @xmath303  and  @xmath315 are disjoint and separated by  @xmath200 .",
    "the direct implication in the equivalence of the lemma is thus trivial . for the reverse implication consider an  @xmath51 as in the proposition .",
    "put @xmath316  and @xmath317 . by assumption , for  all  @xmath80",
    ", @xmath318  separates @xmath319  from  @xmath320 while @xmath321  and  @xmath322 do not .",
    "let @xmath323  and  @xmath324 be the two components of  @xmath325 with @xmath326  and @xmath327 . from the assumption , we also have for  all  @xmath80 that @xmath328 and @xmath329 .",
    "in particular , @xmath324  contains both @xmath319  and  @xmath330 .",
    "since @xmath321 separates these two points it must be that @xmath331 .",
    "likewise , we have @xmath332 . in other words , we have @xmath333 and @xmath334 .",
    "we  finally set @xmath335 .",
    "see figure  [ fig : transversal - character ] .",
    "we claim that the  @xmath336 s are pairwise disjoint . indeed , for  @xmath337 , the inclusions @xmath338 imply @xmath339 since @xmath340  and  @xmath341 are disjoint .",
    "likewise , the inclusions @xmath342 imply @xmath343 .",
    "we thus obtain @xmath344 moreover , the union of the  @xmath336 s cover  @xmath73 . to see this , consider any point  @xmath52 in  @xmath73 contained in the closure of some face  @xmath345 of  @xmath169 .",
    "let  @xmath26  be a path in  @xmath167 between the vertex dual to  @xmath345 and the vertex dual to a face that contains  @xmath346 .",
    "if  @xmath26  does not cross any  @xmath318 , then @xmath26 , hence  @xmath52 , must be contained in  @xmath347 .",
    "otherwise , let @xmath206  be the first intersection point along  @xmath26 with  @xmath348 . by considering the appropriate translate of the subpath of  @xmath26 between @xmath52  and  @xmath206",
    ", we see that some translate of  @xmath52 is contained in  @xmath347 .",
    "we conclude the lemma by noting that @xmath349 , whence @xmath73  is the disjoint union of the translates of  @xmath350 .",
    "[ [ generators - of - the - cyclic - cover . ] ] generators of the cyclic cover .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    a loop of  @xmath17 that is regular ( for  @xmath301 ) and freely homotopic to  @xmath351 is called a * _ generator _ * of  @xmath17 . since @xmath352 , every generator projects on  @xmath1 to a loop that is freely homotopic to  @xmath2 .",
    "conversely , every regular loop freely homotopic to  @xmath2 has a lift in  @xmath17 which is a generator .",
    "a  * _ minimal generator _ * is a generator whose / ( with respect to  @xmath301 ) is minimal among generators ; it projects to a regular loop of / in the free homotopy class of  @xmath2 .",
    "[ lem : generator : lift - is - tau - compatible ] let  @xmath353  be any lift of a generator  @xmath83 of  @xmath17 .",
    "then , @xmath76  sends @xmath354  on  @xmath355 .    by definition of a generator",
    "there exists a homotopy @xmath356 ^ 2    \\rightarrow { { { \\mathcal s}}_{c}}$ ] from  @xmath351 to  @xmath83 .",
    "consider in  @xmath73 the unique lift  @xmath357 of  @xmath358 with  @xmath359 ( see figure  [ fig : lift - translation ] ) .",
    "then @xmath360 and @xmath361  is some lift of  @xmath351 .",
    "since @xmath17  is a cylinder , the automorphism group of  @xmath362 is the cyclic group generated by  @xmath76 .",
    "it follows that @xmath363 for some integer  @xmath80 .",
    "in particular , @xmath364 .",
    "since @xmath365 , it ensues by uniqueness of lifts that @xmath366 .",
    "whence @xmath367 which is exactly @xmath368 .",
    "it follows that a regular path joining two points @xmath51  and  @xmath52 in  @xmath73 is a lift of a generator if and only  if @xmath369 .",
    "consider a minimal generator  @xmath83 and one of its lifts  @xmath370 .",
    "its reciprocal image  @xmath371 is the curve obtained by concatenation of all the translates  @xmath372 , @xmath373 , of  @xmath374 .",
    "remark that , as far as intersections of  @xmath374 with lines is concerned , we can assume that @xmath83 , hence @xmath375 , is simple . indeed ,",
    "if @xmath83  self - intersects it must contain by lemma  [ lem : cylinder-2 ] a subpath forming a contractible loop ; by minimality of  @xmath83 this subpath does not intersect any line and we can cut it off without changing the intersections of  @xmath83 with any line . by induction on the number of self - intersections , we can thus make @xmath83 simple .",
    "the simple curve  @xmath375 actually behaves like a line in  @xmath73 :    [ lem : l - gamma - separating ] @xmath375  is separating in  @xmath73 .",
    "since @xmath83  is already separating on  @xmath17 , this is certainly the case for its reciprocal image  @xmath375 .",
    "[ lem : l_gamma - line - crossing ] a line can intersect  @xmath375 at most once .",
    "suppose that a line  @xmath200 crosses  @xmath375 at least twice .",
    "then , there exists a disk bounded by a subpath of  @xmath200 and a subpath of  @xmath375 that only intersect at their common extremities .",
    "let  @xmath202  be an inclusion - wise minimal such disk .",
    "call  @xmath26  the subpath of  @xmath200 bounding  @xmath202 and call @xmath29  the subpath of  @xmath375 bounding  @xmath202 .",
    "let @xmath51  and  @xmath52 be the common extremities of @xmath26  and  @xmath29 so that @xmath51  occurs before  @xmath52 along  @xmath375 ( oriented from  @xmath51 to  @xmath376 ) .",
    "note that @xmath200  can not cross  @xmath29 as this would otherwise contradict the minimality of  @xmath202 .",
    "since @xmath76  is orientation preserving , @xmath26  and its translates  @xmath377 occur on the same side of  @xmath375 ( see previous lemma ) .",
    "we shall consider all the relative positions of  @xmath52 with respect to @xmath51 ,  @xmath376 and  @xmath378 along  @xmath375 and reach a contradiction in each case .",
    "figure  [ fig : line - l - gamma ] illustrates each of the cases .    1 .   if @xmath379 , or if @xmath378  separates @xmath51  from  @xmath52 on  @xmath375 , then @xmath309  and  @xmath380 cross  @xmath29 and also cross  @xmath26 by minimality of  @xmath202 .",
    "it follows that @xmath200 ,  @xmath309 and  @xmath380 would pairwise intersect , in contradiction with the triangle - free property .",
    "if @xmath52  strictly lies between @xmath376  and  @xmath378 , then @xmath26  and  @xmath381 must intersect .",
    "let  @xmath54  be their intersection point ( there is a unique one since we can not have @xmath382 ) .",
    "we introduce the notation  @xmath383 $ ] for the subpath of a simple path  @xmath384 between two of its points @xmath54  and  @xmath181 .",
    "the concatenation @xmath385\\cdot{\\tau}(p)[u,{\\tau}(x)]\\cdot      q[{\\tau}(x),{\\tau}{\\ensuremath{^{-1}}}(y)]\\cdot      { \\tau}{\\ensuremath{^{-1}}}(p)[{\\tau}{\\ensuremath{^{-1}}}(y),{\\tau}{\\ensuremath{^{-1}}}(u)]\\ ] ] is a simple closed path .",
    "it follows from the triangle - free property that any line intersecting  @xmath386 $ ] must also intersect  @xmath387 $ ] .",
    "consider a point  @xmath181 near  @xmath54 and outside  @xmath388 and consider a regular path  @xmath389 between @xmath390  and  @xmath181 , close to  @xmath386 $ ] but disjoint from  @xmath26 ; we may choose  @xmath389 in such a way that it crosses the same line as the relative interior of  @xmath386 $ ] .",
    "it follows that the / of  @xmath389 is strictly less than the / of the regular path  @xmath391 $ ] , where @xmath392  is a point close to  @xmath51 .",
    "this contradicts the fact that @xmath83  is a minimal generator since @xmath391 $ ]  projects to  @xmath83 and @xmath389  projects to a shorter generator of  @xmath17 .",
    "3 .   if @xmath393 then @xmath83  and  @xmath394 are homotopic and intersect once . since @xmath17  is a cylinder",
    ", this implies that @xmath83  and  @xmath395 touch but do not cross transversely .",
    "this in turn contradicts the regularity of  @xmath83 .",
    "4 .   finally ,",
    "if @xmath52  strictly separates @xmath51  from  @xmath376 then the path obtained by following  @xmath200 between @xmath51  and  @xmath52 and then @xmath375 between @xmath52  and  @xmath376 provides , after infinitesimal perturbation , a lift of a generator with / strictly less than  @xmath83 .",
    "this contradicts the minimality of  @xmath83 .",
    "[ lem : l_gamma - no - triangle ] if a line  @xmath200 intersects  @xmath375 , then @xmath396 .",
    "suppose that @xmath200  intersects both @xmath375  and  @xmath309 .",
    "from lemma  [ lem : l_gamma - line - crossing ] , @xmath200  and  @xmath375 cross exactly once .",
    "in particular , @xmath200  and  @xmath309 can not coincide , hence must cross exactly once . let  @xmath397 and let  @xmath398 . since @xmath76  preserve the orientation , @xmath52  and  @xmath399 must be on the same side of  @xmath375 .",
    "the point  @xmath399 can not lie on the same side of  @xmath200 as  @xmath376 .",
    "indeed , @xmath380  would then enter the triangle  @xmath400 formed by @xmath375 ,  @xmath309 and  @xmath200 . from the preceding lemma  [ lem : l_gamma - line - crossing ] and from the triangle - free property , @xmath380  could not exit that triangle , leading to a contradiction .",
    "but @xmath399  can neither lie on the other side of  @xmath200 as @xmath380  would have to cross both @xmath200  and  @xmath309 , contradicting the triangle - free property .",
    "[ prop : transversal - existence ] let  @xmath83  be a minimal generator whose basepoint is not on any line .",
    "let @xmath374  be a lift of  @xmath83 in  @xmath73 .",
    "any line  @xmath200 crossed by  @xmath374 is @xmath76/transversal .",
    "in particular , there exists a @xmath76-transversal line",
    ".    put  @xmath401 . by lemma  [ lem :",
    "generator : lift - is - tau - compatible ] , @xmath402 . by lemma  [ lem : l_gamma - line - crossing ] ,",
    "any line  @xmath200 crossing  @xmath374 separates @xmath51  from  @xmath376 while @xmath403  and  @xmath309 do not .",
    "together with lemma  [ lem : l_gamma - no - triangle ] , this allows us to apply proposition  [ prop : lines : transversal - condition ] and to conclude that @xmath200  is @xmath76/transversal .",
    "since @xmath374  must be crossed by at least one line , this finally prove the existence of a transversal line .",
    "indeed , if @xmath374  was not crossed by any line it would lie inside a single face of  @xmath169 : its projection  @xmath404 would also stay in a single face of  @xmath168 and be trivially contractible , contradicting the fact that @xmath405  is freely homotopic to  @xmath2 .",
    "[ cor : transversal - unic ] there exists a @xmath76/transversal line that separates the endpoints of  @xmath75 from each other .    by proposition  [ prop : transversal - existence ]",
    ", there exists a @xmath76/transversal line  @xmath200 . since @xmath78  is a translate of  @xmath77 , these two endpoints",
    "are included in two successive fundamental domains determined by  @xmath200 and its translates . since the basepoint  @xmath50 of  @xmath2 is not on the projection of any line , the translate of  @xmath200 that separates the interior of these two fundamental domains also separates @xmath78  from  @xmath77 .",
    "[ [ tauinvariant - line . ] ] @xmath76/invariant line .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    a line  @xmath200 such that @xmath406 is said * _ @xmath76/invariant_*. note that this equality does not hold pointwise , but globally .",
    "[ lem:1-invariant - line ] there is at most one @xmath76/invariant line .",
    "let @xmath200  and  @xmath232 be two @xmath76/invariant lines . since a @xmath76/invariant line can not lie in a single fundamental domain , any @xmath76/transversal line  @xmath407 must intersect @xmath200  and  @xmath232 .",
    "if @xmath200  and  @xmath232 where distinct then they would form a quadrilateral with @xmath407  and  @xmath408 , in contradiction with the quad - free property .",
    "[ lem:3-translates - invariant ] a line that intersects three consecutive translates of a @xmath76/transversal is @xmath76/invariant .",
    "suppose that a line  @xmath200 intersects a @xmath76/transversal line  @xmath407 as well as @xmath408  and  @xmath409 .",
    "if @xmath410 then @xmath200 ,  @xmath309 , @xmath408 and  @xmath409 form a quadrilateral , in contradiction with the quad - free property .",
    "since  @xmath1 is oriented we can speak of the left or right side of a minimal generator .",
    "our aim is to prove that the set of minimal generators of  @xmath17 covers a bounded cylinder allowing us to define its right boundary as a canonical representative of the free homotopy class of  @xmath2 . by definition , a @xmath76/transversal line projects in  @xmath17 to a simple curve .",
    "we call this projection a * _ @xmath2/transversal_*. a @xmath2/transversal  @xmath200 crosses exactly once every minimal generator  @xmath83 . indeed , if @xmath200  and  @xmath83 had two intersections @xmath51  and  @xmath52",
    ", the subpath of  @xmath200 between @xmath51  and  @xmath52 would be homotopic to one of the two paths cut by @xmath51  and  @xmath52 along  @xmath83 ( see lemma  [ lem : cylinder-1 ] ) .",
    "these two homotopic subpaths would lift in  @xmath73 to a closed path , implying that a lift of  @xmath200 cuts @xmath375  twice ; a contradiction with lemma  [ lem : l_gamma - line - crossing ] .",
    "moreover , proposition  [ prop : transversal - existence ] implies that any minimal generator is crossed by @xmath2/transversals only .",
    "the number of @xmath2/transversals in  @xmath17 is thus equal to the length of the minimal generators which is in turn no larger than  @xmath411 .",
    "notice that the orientation of  @xmath1 and of the minimal generators induce a left - to - right orientation of the @xmath2/transversals .",
    "[ lem : uncross - generators ] let @xmath412  and  @xmath413 be two minimal generators .",
    "there exist two disjoint and simple minimal generators @xmath83  and  @xmath414 such that the set of edges of  @xmath301 crossed by  @xmath415 is the same as the set of edges crossed by  @xmath416 .",
    "as remarked above lemma  [ lem : l - gamma - separating ] , we can assume that both @xmath412  and  @xmath413 are simple .",
    "suppose that they intersect .",
    "if necessary , we can modify @xmath412  and  @xmath413 inside the interior of each face and edge so that they cross only inside faces and only transversely . since @xmath412  is separating , it must intersect  @xmath413 in at least two points .",
    "these two points , say @xmath51  and  @xmath52 , cut each generator in two pieces , say @xmath417  and @xmath418 . by lemma",
    "[ lem : cylinder-2 ] we may assume without loss of generality , that @xmath293  is homotopic to  @xmath2 and that @xmath419  is a generator ( see figure  [ fig : separates - generators ] ) .    by minimality of @xmath412  and  @xmath413 , the paths @xmath293  and  @xmath2 must have the same / and similarly for @xmath294  and  @xmath3 .",
    "we can thus replace @xmath412  and  @xmath413 by the minimal generators obtained by slightly perturbing the concatenations @xmath419  and @xmath420 so as to remove the two intersections at @xmath51  and  @xmath52 .",
    "we claim that @xmath419  and @xmath420 have fewer intersections than @xmath412  and  @xmath413 .",
    "indeed , denoting by  @xmath421 the relative interior of a path  @xmath107 , we have @xmath422 while @xmath423 since , by simplicity of @xmath412  and  @xmath413 : @xmath424 .",
    "the new minimal generators @xmath419  and @xmath420 obviously cross the same edges as @xmath412  and  @xmath413 .",
    "they may now self - intersect , but as initially noted , we can remove contractible loops until they become simple .",
    "we conclude the proof with a simple recursion on @xmath425 .",
    "we now consider two disjoint and simple minimal generators @xmath83  and  @xmath414 .",
    "they bound an annulus  @xmath426 in  @xmath17 .",
    "since @xmath83  and  @xmath414 are crossed by @xmath2/transversal curves only , a line  @xmath200 of  @xmath73 whose projection  @xmath427 intersects  @xmath428 is either @xmath76/transversal or @xmath76/invariant . indeed ,",
    "if @xmath200  is not @xmath76/transversal , @xmath427  must stay in the finite subgraph of  @xmath301 interior to  @xmath428 ; it follows that @xmath427  uses some edge twice , which can only happen if @xmath200  is @xmath76/invariant by proposition  [ prop : lines : no - bigon - triangle ] . in this latter case ,",
    "@xmath427  is a simple generator and by lemma  [ lem:1-invariant - line ] , there is only one such curve in @xmath17 .",
    "note that this curve is crossed once by every @xmath2/transversal , hence is composed of @xmath429  edges .",
    "we first bound the complexity of  @xmath426 .",
    "[ lem : short - bound ] let @xmath430 ,  @xmath431 and  @xmath186 be the respective numbers of vertices , edges and faces of  @xmath301 intersected by  @xmath428 .",
    "then @xmath432 , @xmath433  and @xmath434 .",
    "if @xmath426  contains the projection  @xmath427 of a @xmath76/invariant line  @xmath200 , we consider two minimal generators @xmath407  and  @xmath435 running parallel to  @xmath427 and respectively to the left and to the right of  @xmath427 . assuming that @xmath83  is to the left of  @xmath427 , we can bound the complexity of  @xmath301 in  @xmath428 by the complexity of  @xmath427 plus the complexity of  @xmath301 inside the two annuli bounded by @xmath83  and  @xmath407 , and by @xmath435  and  @xmath414 respectively .",
    "we can now assume that @xmath428  is crossed by @xmath2/transversals only .",
    "these @xmath2/transversals form an arrangement of  @xmath429 curves in  @xmath428 where two @xmath2/transversals can cross at most twice by lemma  [ lem:3-translates - invariant ] . together with @xmath83  and  @xmath414",
    ", this arrangement defines a subdivision of  @xmath428 whose number of boundary vertices is  @xmath436 .",
    "we distinguish two cases according to whether @xmath2/transversals pairwise intersect at most once or twice .",
    "[ [ case - where - each - pair - of - ctransversals - intersects - at - most - once . ] ] case where each pair of @xmath2/transversals intersects at most once .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    if the @xmath2/transversals are pairwise disjoint in  @xmath428 , the lemma is trivial : @xmath428  contains no vertex and intersects @xmath429  edges and as many faces .",
    "otherwise , we first establish a correspondence between faces and interior vertices .",
    "consider an interior vertex  @xmath51 of the subdivision ; it is the intersection of two @xmath2/transversals @xmath54  and  @xmath181 ( refer to figure  [ fig : bounded - belt].a ) . call  @xmath437  the triangle formed by @xmath54 ,  @xmath181 and  @xmath83 .",
    "no @xmath2/transversal can join @xmath54  and  @xmath181 inside  @xmath437 .",
    "otherwise @xmath54 ,  @xmath181 and this @xmath2/transversal would form a triangle that would lift into a triangle in  @xmath73 , in contradiction with the triangle - free property .",
    "moreover , a @xmath2/transversal  @xmath246 that crosses the @xmath54/side of  @xmath437 can not be crossed inside  @xmath437 by any  @xmath438 , as @xmath246 ,  @xmath438 , @xmath54 and  @xmath181 would then form a quadrilateral .",
    "if the @xmath54/side of  @xmath437 is indeed crossed , we let @xmath439  be the crossing curve closer to  @xmath51 along the @xmath54/side .",
    "we define @xmath440  similarly for the @xmath181/side of",
    "@xmath437 . the @xmath2/transversal curves @xmath439  and  @xmath440 , if  any , together with @xmath54 ,  @xmath181 and  @xmath83 bound a face of the subdivision of  @xmath428 .",
    "this is the only face incident to  @xmath51 in  @xmath437 .",
    "we call it the _ left face _ of  @xmath51 ; it has one side along  @xmath83 and no side along  @xmath414 .",
    "conversely , we claim that every face  @xmath178 of the subdivision of  @xmath428 with no side along  @xmath414 is the left - face of a unique interior vertex .",
    "the unicity is clear since a left face has a unique side on  @xmath83 .",
    "in fact , by minimality , @xmath83  crosses every face of  @xmath301 at most once ; so that @xmath178  has at most two ( consecutive ) vertices on  @xmath83 .",
    "if @xmath178  has a unique interior vertex on its boundary , then @xmath178  is precisely the triangle  @xmath441 for that vertex . otherwise , consider two interior vertices @xmath51  and  @xmath52 that are consecutive along the boundary of  @xmath178 as on figure  [ fig : bounded - belt].b . by considering the arrangement made by the three @xmath2/transversals defining @xmath51  and  @xmath52",
    ", it is easily seen that @xmath178  is included in exactly one of @xmath437  or  @xmath442 , thus proving the claim .",
    "we define _ right faces _ analogously and remark that a face that is neither a left nor a right face must have one side along  @xmath83 and one side along  @xmath414 .",
    "we can now determine the complexity of the subdivision of  @xmath443 .",
    "denote by @xmath194  and  @xmath189 its respective numbers of vertices and edges . with the notations in the lemma",
    ", we have @xmath444 and @xmath445 . by the preceding remark",
    ", every face has a side on either @xmath83  or  @xmath414 .",
    "it ensues that @xmath446 .",
    "euler s formula then implies @xmath447 , whence @xmath448 .",
    "since interior and boundary vertices have respective degree @xmath161  and  @xmath289 , we get @xmath449 by double - counting of the vertex - edge incidences . combining with the previous inequality",
    "we obtain @xmath450 , and finally conclude that @xmath451 .",
    "[ [ case - where - at - least - two - ctransversals - intersect - twice . ] ] case where at least two @xmath2/transversals intersect twice .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we now suppose that two @xmath2/transversals @xmath54  and  @xmath181 intersect twice in  @xmath428 .",
    "the curves @xmath83 ,  @xmath414 , @xmath54 and  @xmath181 induce a subdivision of  @xmath428 where @xmath54  and  @xmath181 are each cut into three pieces , say @xmath452 ,  @xmath453 and  @xmath454 for  @xmath54 and @xmath275 ,  @xmath455 and  @xmath456 for  @xmath181 and the two generators are each cut into two pieces , say @xmath457 for  @xmath83 and @xmath458 for  @xmath414 ( see figure  [ fig : bounded - belt].c ) . a @xmath2/transversal  @xmath246 crossing  @xmath459 would have to cross @xmath452  or  @xmath275 to enter the face bounded by @xmath460 in the subdivision induced by @xmath83 ,  @xmath54 and  @xmath181 . it is easily seen that",
    "no matter how this face is crossed , it will be cut into subfaces , one of which must have three or four sides bounded by @xmath54 ,  @xmath181 and  @xmath246 .",
    "this contradicts proposition  [ prop : lines : no - bigon - triangle ] .",
    "likewise no @xmath2/transversal can cross  @xmath461 .",
    "hence , any @xmath2/transversal distinct from @xmath54  and  @xmath181 must extend between @xmath462  and  @xmath463 and cut either @xmath453  or  @xmath455 .",
    "it is easily seen that any two such @xmath2/transversals can not cross without creating a triangle or a quadrilateral bounded by @xmath2/transversals , which is again impossible .",
    "it follows that apart from @xmath54  and  @xmath181 all @xmath2/transversals are pairwise disjoint inside  @xmath428 .",
    "we deduce that all faces have one side on @xmath83  or  @xmath414 ( but not both ) , whence @xmath464 .",
    "since any @xmath2/transversal distinct from @xmath54  and  @xmath181 is cut into two pieces we also get @xmath465 and @xmath466 .",
    "we note that the left triangle @xmath467 is not cut by any @xmath2/transversal .",
    "[ [ the - edges . ] ] the / edges",
    ". + + + + + + + + + + + +    an edge of  @xmath301 whose relative interior is crossed by a minimal generator is said * _ /_*.",
    "[ lem : short - connectivity ] if  @xmath428  is crossed by @xmath2/transversal curves only , then every edge of  @xmath301 in  @xmath428 is /.",
    "if  @xmath428  contains no vertex of  @xmath301 then @xmath428  crosses the same edges as @xmath83  and  @xmath414 and the lemma is trivial .",
    "otherwise , we show how to sweep the entire arrangement inside  @xmath428 with a minimal generator from the left boundary  @xmath83 to the right boundary  @xmath414 .",
    "we claim that the subdivision of  @xmath443 induced by @xmath83 ,  @xmath414 and  @xmath301 contains a triangle face  @xmath33 with one side along  @xmath83 ( a left triangle in the above terminology ) .",
    "this is clear in the case where two @xmath2/transversals cross twice as noted at the end of the above proof .",
    "otherwise , we consider two @xmath2/transversals crossing in  @xmath428 ; they obviously form a left triangle with  @xmath83 . adding the other @xmath2/transversals one by one we see that this left triangle is either not cut or that a new left triangle is cut out of it .",
    "we conclude the claim by a simple induction on  @xmath468 .",
    "the left triangle  @xmath33 has one vertex  @xmath51 interior to  @xmath428 and incident to four edges @xmath469 where @xmath470 bound  @xmath33 .",
    "we can now sweep  @xmath51 with  @xmath83 by crossing  @xmath471 instead of  @xmath470 to obtain a new minimal generator .",
    "this new generator bounds with  @xmath414 a new annulus  @xmath472 . note that @xmath473  crosses the same set of edges as  @xmath428 except for  @xmath474 that were crossed by  @xmath83 .",
    "moreover , the number of interior vertices is one less in  @xmath473 than in  @xmath426 .",
    "we conclude the proof of the lemma with a simple recursion on this number .",
    "[ lem : segment - short ] the set of / edges of a @xmath2/transversal  @xmath54 is a finite segment of  @xmath54 .",
    "let @xmath293  and  @xmath294 be two / edges along  @xmath54 .",
    "let @xmath83  and  @xmath414 be minimal generators crossing @xmath293  and  @xmath294 respectively .",
    "by lemma  [ lem : uncross - generators ] , we can assume that @xmath83  and  @xmath414 are disjoint and still cross @xmath293  and  @xmath294 ( a single generator can not cross a @xmath2/transversal twice ) .",
    "if the annulus bounded by @xmath83 and @xmath414 is crossed by @xmath2/transversals only then we can apply lemma  [ lem : short - connectivity ] to conclude that the edges between @xmath293  and  @xmath294 along  @xmath54 are /.",
    "otherwise , we can cut this annulus into two parts as in the proof of lemma  [ lem : short - bound ] and reach the same conclusion .",
    "this latter lemma also implies that there are @xmath475  / edges between @xmath293  and  @xmath294 .",
    "it follows that set of / edges along  @xmath54 is connected and bounded .",
    "consider two minimal generators @xmath412  and  @xmath413 .",
    "we claim that there exists a minimal generator that crosses the rightmost of the / edges crossed by @xmath412  and  @xmath413 along each @xmath2/transversal . indeed , the two disjoint minimal generators @xmath83  and  @xmath414 returned by lemma  [ lem : uncross - generators ] can not invert their order of crossings along @xmath2/transversals .",
    "hence one of them uses all the leftmost / edges , while the other uses all the rightmost / edges . by a simple induction on the number  @xmath429 of @xmath2/transversals ,",
    "this implies in turn that there exists a minimal generator  @xmath18 that crosses the rightmost / edge of each @xmath2/transversal .",
    "we define the * _ canonical generator _ * with respect to  @xmath2 as the cycle in  @xmath300 dual to the sequence of / edges crossed by  @xmath18 .",
    "[ [ the - canonical - belt ] ] the canonical belt + + + + + + + + + + + + + + + + + +    as for  @xmath18 , we can show the existence of a minimal generator  @xmath476 crossing the leftmost / edges .",
    "we define the * _ canonical belt _ *  @xmath477 as the union of the vertices , edges and faces crossed by the annulus bounded by @xmath476  and  @xmath18 . by lemma  [ lem : short - connectivity ] ,",
    "the edges in  @xmath478 are the / edges and the edges of the projection of the @xmath76/invariant line , if any . in particular , any minimal generator",
    "is included in the canonical belt .",
    "any intersection of @xmath2/transversals is interior to the canonical belt .",
    "consider two @xmath2/transversals @xmath54  and  @xmath181 crossing at a vertex  @xmath51 .",
    "let  @xmath83  be a minimal generator ; it bounds , together with @xmath54  and  @xmath181 , a triangle  @xmath33 in  @xmath17 .",
    "let  @xmath407  be the generator obtained from  @xmath83 by substitution of the @xmath83/side of  @xmath33 with the complementary part of the boundary of  @xmath33 , slightly pushed out of  @xmath33 . by the triangle - free property , the projection of a line of  @xmath73 that crosses the @xmath54/side or @xmath181/side of  @xmath33 must exit  @xmath33 through its @xmath83/side .",
    "it follows that @xmath407  has the same / as  @xmath83 .",
    "hence , @xmath407  is minimal and the vertex  @xmath51 , which is interior to the annulus bounded by @xmath83  and  @xmath407 , is also interior to the canonical belt .",
    "we consider the subgraph  @xmath479 of  @xmath169 induced by the lines in  @xmath169 that are neither @xmath76/transversal nor @xmath76/invariant .",
    "the projection  @xmath480 of  @xmath479 in  @xmath17 is denoted by  @xmath481 ; it is the union of the projections of the lines that are neither @xmath76/transversal nor @xmath76/invariant .",
    "the following lemma gives a simple characterisation of the canonical belt .",
    "[ lem : belt - characterisation ] @xmath477  is the unique component of  @xmath482 that contains a generator .",
    "it is easily seen from its definition and from the previous lemma that @xmath477  is a component of  @xmath483 .",
    "let  @xmath414  be any generator contained in  @xmath483 and let @xmath83  be a ( simple ) minimal generator .",
    "since @xmath83  is included in  @xmath477 , we just need to show that @xmath414  and  @xmath83 are contained in the same component of  @xmath483 .",
    "if  @xmath414  is not a simple curve , we first remove its contractible loops to make it simple .",
    "if @xmath414  and  @xmath83 intersect then there is nothing to show . otherwise , @xmath414  and  @xmath83 bound a compact annulus  @xmath428 in  @xmath17 .",
    "as already observed , any line whose projection stays in  @xmath428 must be @xmath76/invariant .",
    "it follows that @xmath428  is entirely contained in a single component of  @xmath482 .",
    "we now explain how to compute the canonical generator associated with the loop  @xmath2 in time proportional to  @xmath7 .",
    "let  @xmath484  be the relevant region of the loop  @xmath485 obtained by six concatenations of  @xmath2 . according to section  [ subsec : algo - contractibility ]",
    ", we can build the adjacency graph  @xmath174 of the faces of  @xmath484 in @xmath12  time .",
    "the edges dual to the edges of  @xmath174 are the edges of  @xmath169 interior to  @xmath484 .",
    "they induce a subgraph of  @xmath169 which we denote by  @xmath486 . as opposed to  @xmath174 , the graph  @xmath486 may have multiple components ( see figure  [ fig : poincare ] ) .",
    "a vertex of  @xmath486 may have degree one or four depending on whether it is a flat boundary vertex or an interior vertex of  @xmath487 . as explained in the mirror sub - procedure of section  [ subsec : algo - contractibility ] ,",
    "if @xmath488  is an edge dual to  @xmath233 then the two siblings of  @xmath233 correspond to the facing edges of  @xmath489 and they can be computed in constant time ( if they belong to  @xmath486 ) .",
    "similarly , we can easily compute in constant time the circular list of ( one or four ) edges sharing a same vertex of  @xmath486 .    [ [ identifying - and - classifying - lines - ingamma . ] ] identifying and classifying lines in  @xmath486 .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    from the preceding discussion we can traverse  @xmath486 to give a distinct tag to each maximal component of facing edges in constant time per edge .",
    "lemma  [ lem : region : connected - inter - with - line ] ensures that each such component is supported by a distinct line .",
    "we denote by  @xmath490 the identifying tag of the line supporting the edge dual to  @xmath233 . with a little abuse of notation",
    "we will identify a line with its tag .",
    "let  @xmath491  be the successive lifts of  @xmath2 in the lift of  @xmath485 and let @xmath492  be the successive lifts of  @xmath493 in the lift of  @xmath485 .",
    "let  @xmath494  be the @xmath495/th edge of  @xmath496 .",
    "since by construction @xmath497 , we have @xmath498 .",
    "this allows us to compute the translate of any line crossing one of @xmath499 in constant time per line .",
    "notice that the interior of  @xmath484 is crossed by a @xmath76/invariant line if and only  if @xmath406 for some line  @xmath200 crossing one ( thus any ) of  @xmath499 .",
    "we can now fill a table  @xmath500 $ ] whose boolean value is true if  @xmath200 intersects  @xmath309 in  @xmath484 and false otherwise .",
    "this clearly takes @xmath12  time . in order to identify the @xmath76/transversals separating @xmath319  from  @xmath320 , we need the following property .    [",
    "lem : relevant - crossing ] two intersecting lines crossing the interior of  @xmath484 intersect in the interior of  @xmath484 .    otherwise there would be a line  @xmath407 separating  @xmath484 from the intersection of the two intersecting lines .",
    "these two lines would form a triangle with  @xmath407 , in contradiction with the triangle - free property .",
    "we first identify and orient the @xmath76/transversals separating @xmath501  from  @xmath502 .",
    "we start by filling a table  @xmath503 $ ] counting the parity of the number of intersections of each line  @xmath200 with  @xmath496 for  @xmath504 .",
    "this can be done in @xmath12  time : we initialize all the entries of the table  @xmath156 to  @xmath182 and , for  each  @xmath504 and each edge  @xmath233 of  @xmath496 , we invert the current parity of  @xmath505 $ ] . by proposition  [ prop :",
    "lines : transversal - condition ] , the @xmath76/transversals separating @xmath501  from  @xmath502 are exactly those  @xmath200 for which @xmath500 $ ]  is false , @xmath506 $ ]  is odd , and @xmath507 $ ]  and  @xmath508 $ ] are even .",
    "we then orient these transversals from left to right as follows .",
    "we traverse in order the oriented edges of the lift  @xmath509 .",
    "as we traverse an oriented edge  @xmath233 of  @xmath509 , we check whether its dual belongs to an identified transversal that was not already oriented . in the affirmative , we use the left - to - right orientation of the dual edge of  @xmath233  given by the correspondence between the oriented cellular embedding and its dual  to orient this transversal .",
    "we can now identify and orient all the @xmath76/transversals separating @xmath319  from  @xmath320 , for  @xmath510 $ ] , by translation of those separating @xmath501  from  @xmath502 .",
    "corollary  [ cor : transversal - unic ] ensures the existence of at least one transversal separating @xmath501  from  @xmath502 ; we choose one and denote it by  @xmath200 in the sequel .",
    "we shall concentrate on the part of  @xmath484 contained in the closure  @xmath511 of the fundamental domain of  @xmath512 comprised between @xmath200  and  @xmath309 .",
    "we put @xmath513 .    [ [ finding - a - lift - of - the - canonical - generator . ] ] finding a lift of the canonical generator .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we want to show that @xmath514  contains either a whole lift of the canonical belt or half of it . in this latter case , @xmath484",
    "is bounded by a @xmath76/invariant line .",
    "[ lem : two - situations ] exactly one of the two following situations occurs    1 .",
    "@xmath484  contains the intersection  @xmath515 .",
    "2 .   there exists a @xmath76/invariant line  @xmath407 , whose projection  @xmath516 cuts the canonical belt into two open parts @xmath517  and  @xmath518 , each one containing a generator and intersecting exactly one edge of each @xmath2/transversal .",
    "the relevant region  @xmath484 contains either ( i ) the intersection @xmath519 or ( ii ) the intersection @xmath520 and exclude the other one .",
    "we first consider the case where there is no @xmath76/invariant line .",
    "let  @xmath489 be an edge of  @xmath521 projecting to an edge  @xmath105 of the canonical belt .",
    "we want to prove that @xmath489  is interior to  @xmath484 .",
    "denote by  @xmath232 the supporting line of  @xmath489 ; this is a @xmath76/transversal by proposition  [ prop : transversal - existence ] .",
    "on the one hand , if @xmath232  does not cut any other transversal then it stays inside  @xmath511 and must separate @xmath522  from either @xmath501  or  @xmath523 . in particular",
    ", @xmath232  intersects the concatenation  @xmath524 , hence  @xmath484 .",
    "if one of the  @xmath496 s intersect  @xmath489 , then @xmath489  is inside  @xmath484 by definition .",
    "otherwise , we consider a minimal generator  @xmath83 crossing  @xmath105 and its reciprocal image  @xmath375 .",
    "let  @xmath525 and let @xmath206  be the endpoint of  @xmath489 between @xmath52  and the point  @xmath526 .",
    "see figure  [ fig : gamma_r - in - pi ] .",
    "the line  @xmath527 crossing  @xmath232 at  @xmath206 does not cut  @xmath375 by proposition  [ prop : transversal - existence ] .",
    "lemma  [ lem:3-translates - invariant ] implies that @xmath527  does not cut @xmath528  nor  @xmath529 .",
    "it ensues that @xmath527  intersects the lift of  @xmath485 between @xmath530  and  @xmath531 .",
    "since @xmath232  and  @xmath527 both cross the interior of  @xmath484 , their intersection  @xmath206 is interior to  @xmath484 by lemma  [ lem : relevant - crossing ] .",
    "it ensues that @xmath489  is also interior to  @xmath484 . on the other hand , if  @xmath232  indeed crosses some other transversal , then by lemma  [ lem : segment - short ]",
    "one of the endpoints of  @xmath489 is the intersection of  @xmath232 with some other @xmath76/transversal  @xmath412 .",
    "lemma  [ lem:3-translates - invariant ] implies that these two transversals can not intersect @xmath532  nor  @xmath533 .",
    "it ensues that @xmath232  and  @xmath412 cross the lift of  @xmath485 ( this is where we need six lifts of  @xmath2 ) and we conclude as above that @xmath489  is interior to  @xmath484 .",
    "we now consider the case where there exists a @xmath76/invariant line  @xmath407 .",
    "as observed in the proof of lemma  [ lem:1-invariant - line ] , any @xmath76/transversal must cross  @xmath407 .",
    "the triangle - free property then forbids these transversals to intersect .",
    "it follows that every @xmath76/transversal contains exactly two short edges separated by a vertex of  @xmath407 .",
    "said differently , the edges of the canonical belt precisely lift to the edges incident to  @xmath407 ( including the edges of  @xmath407 ) . on the one hand ,",
    "if @xmath407  does not cross any of the  @xmath496 s , then the lift of  @xmath485 lies on one side of  @xmath407 , say its left .",
    "the line  @xmath407 may play the role of  @xmath375 and we may argue as above that all short edges to the left of  @xmath407 and contained in  @xmath511 are interior to  @xmath484 .",
    "equivalently , every lift in  @xmath511 of an edge of  @xmath517 is interior to  @xmath484 . on the other hand ,",
    "if @xmath2  crosses  @xmath516 , then @xmath407  crosses the interior of  @xmath484 .",
    "lemma  [ lem : relevant - crossing ] ensures that all its intersections with the @xmath76/transversals in  @xmath511 are interior to  @xmath484 .",
    "we conclude this time that @xmath484  contains @xmath534 .",
    "we now explain how to identify the lift of the canonical belt , or half of it , contained in  @xmath535 .",
    "[ lem : identify - sigma - star ] let  @xmath536  be the subgraph of  @xmath537 projecting to the canonical belt .",
    "we can identify the edges of  @xmath536 in @xmath12  time .    from the preceding lemma , @xmath538",
    "is connected and contains a generator .",
    "recall that @xmath479  is the union of the lines that are neither @xmath76/transversal nor @xmath76/invariant , and that @xmath481  is its projection into  @xmath17 .",
    "lemma  [ lem : belt - characterisation ] ensures that @xmath538  is the only component of  @xmath539 that contains a generator .",
    "equivalently , @xmath540  is the only component of  @xmath541 that contains an edge  @xmath542 together with its translate  @xmath543 .",
    "thanks to lemma  [ lem:3-translates - invariant ] and following the paragraph on line identification and classification , we can correctly detect all the @xmath76/transversal and @xmath76/invariant lines crossing  @xmath535 . by complementarity , we identify the edges of  @xmath479 in  @xmath514 .",
    "we also identify by a simple traversal the subgraph  @xmath544 of  @xmath174 whose dual edges are contained in  @xmath535 .",
    "the graph  @xmath544 is connected ( @xmath535  is a `` convex '' region of the plane ) and each component of  @xmath541 is a union of faces corresponding to a connected component of  @xmath545 , where @xmath546  is the set of primal edges corresponding to  @xmath479 .",
    "we eventually select the component  @xmath547 of  @xmath548 that includes an edge  @xmath233 together with its translate  @xmath549 .",
    "it clearly takes time proportional to  @xmath7 to select the edges of  @xmath547 .",
    "we finally remark from the initial discussion that the dual of the edges in  @xmath547 are the edges of  @xmath536 .",
    "[ prop : canonical - generator ] we can compute the canonical generator in  @xmath12 time .    we first compute  @xmath536 as in lemma  [ lem : identify - sigma - star ] .",
    "we then determine if we are in situation  2__(i ) _ _ of lemma  [ lem : two - situations ] . to this end",
    ", we check that all the edges of  @xmath536 are supported by pairwise distinct @xmath76/transversals .",
    "if this is the case , we further check if the right extremities of the edges of  @xmath536 are linked by edges of a ( necessarily @xmath76/invariant ) line .",
    "this is easily seen in constant time per edge by projecting the edges of  @xmath536 back into  @xmath168 on  @xmath1 .",
    "if we are indeed in situation  2__(i ) _ _ , the canonical generator is composed of the projection on  @xmath17 of the dual of the edges facing the edges of  @xmath536 to their right ( keeping only one of the two edges supported by @xmath200  and  @xmath309 ) . in the other situations 1  and  2__(ii ) _ _ , the edges crossed by the lift of the canonical generator in  @xmath511 are the edges of  @xmath536 that are supported by @xmath76/transversal lines and whose right endpoint is not a crossing with any other @xmath76/transversal or @xmath76/invariant line . in other words , these are the rightmost edges in  @xmath536 of the pieces of @xmath76/transversals crossing  @xmath536 , unless they abut on @xmath200  or  @xmath309 . in either case , we can clearly determine the sequence of edges of the canonical generator in @xmath12  time .",
    "let @xmath2  and  @xmath3 be two non - contractible cycles represented as closed walks in  @xmath114 .",
    "assuming that @xmath1  is orientable with genus at least two , we compute the canonical generators @xmath18  and  @xmath19 corresponding to @xmath2  and  @xmath3 respectively .",
    "this takes @xmath5  time according to proposition  [ prop : canonical - generator ] .",
    "following the discussion in the introduction , @xmath2  and  @xmath3 are freely homotopic if and only if the projections @xmath550  and  @xmath551 in  @xmath1 are equal as cycles of  @xmath114 .",
    "this can be determined , under the obvious constraint that these two projections have the same length , in @xmath5  time using the classical knuth - morris - pratt algorithm  @xcite to check whether @xmath550  is a substring of the concatenation  @xmath552 .",
    "it remains to consider the cases of @xmath1  being a torus . as noted for the contractibility test , its fundamental group is commutative .",
    "being conjugate is thus equivalent to being equal as group elements and the free homotopy test reduces to the contractibility test .",
    "we have thus solved the free homotopy test for closed orientable surfaces . in a forthcoming paper",
    ", we shall show how to solve the contractibility and free homotopy tests in optimal linear time for surfaces with non - empty boundary , orientable or not .",
    "( in the orientable case , we could also resort to the present algorithms by first closing each boundary with a punctured torus . )",
    "we leave the handling of the free homotopy test on closed non - orientable surfaces as an open problem .",
    "there are two easy cases , though . if @xmath1  is a projective plane , its fundamental group is again commutative and the test is trivial .",
    "if @xmath1  is a klein bottle , the test was actually resolved by max dehn ( see its papers translation by stillwell  @xcite ) : following the end of section  [ sec : contractibility - test ] , we can assume that we are given two words in their canonical forms @xmath295  and  @xmath553 .",
    "these two words are conjugate if and only  if @xmath554 and either @xmath181  is even  and @xmath555 , or @xmath181  is odd  and @xmath54  has the same parity as  @xmath556 . for non - orientable surfaces of larger genus we finally note that if @xmath2  and  @xmath3 are two - sided curves in  @xmath1 , which is easily checked in linear time , their cyclic coverings are cylinders and we can apply our algorithm for the orientable case .",
    "the only unsolved case is when @xmath2  and  @xmath3 are one - sided curves and their cyclic coverings are mbius bands .",
    "we can still define their canonical belt as for two - sided curves .",
    "it has a single boundary freely homotopic to the square of a generator .",
    "we can easily checked that the canonical belts are isomorphic in time that is quadratic in their size .",
    "it is not clear how to reduce this comparison to linear time .",
    "ccdvl10    a.  v. aho , j.  e. hopcroft , and j.  d. ullman . .",
    "series in computer science and information processing .",
    "addison - wesley , 1974 .",
    "s.  cabello ,  .",
    "colin de  verdire , and f.  lazarus .",
    "output - sensitive algorithm for the edge - width of an embedded graph . in _ proceedings of the 26th annual acm symposium on computational geometry ( socg ) _ , pages 147155 , 2010 .    .",
    "colin de verdire and j.  erickson .",
    "tightening non - simple paths and cycles on surfaces .",
    ", 39(8):37843813 , 2010 .",
    "t.  cormen , c.  leiserson , r.  rivest , and c.  stein . .",
    "mit press , third edition , 2009 .",
    "b.  domanski and m.  anshel .",
    "the complexity of dehn s algorithm for word problems in groups .",
    ", 6:543549 , 1985 .",
    "t.  k. dey and s.  guha .",
    "transforming curves on surfaces .",
    ", 58(2):297325 , 1999 .",
    "t.  dey and h.  schipper . a new technique to compute polygonal schema for 2-manifolds with application to null - homotopy detection .",
    ", 14:93110 , 1995 .",
    "d.  eppstein .",
    "dynamic generators of topologically embedded graphs . in _ proceedings of the fourteenth annual acm - siam symposium on discrete algorithms ( soda-03 ) _ , pages 599608 .",
    "acm press , jan 2003 .",
    "j.  erickson and k.  whittelsey .",
    "greedy optimal homotopy and homology generators . in _ proceedings of the 16th annual acm - siam symposium on discrete algorithms _ , pages 10381046 , 2005",
    ".    m.  d. greendlinger . on dehn",
    "s algorithm for the conjugacy and word problems with applications .",
    ", 13:641677 , 1960 .",
    "word - hyperbolic groups have real - time word problem . , 10(2):221227 , 2000 .",
    "holt and s.  rees . solving the word problem in real time .",
    ", 63:623639 , 2001 .",
    "j.  hass and p.  scott .",
    "intersections of curves on surfaces . , 51(1 - 2):90120 , 1985 .",
    "s.  lins .",
    "graph - encoded maps . , 32:171181 , 1982 .",
    "w.  s. massey .",
    ", volume 127 of _ graduate texts in mathematics_. springer verlag , 1991 .",
    "b.  mohar and c.  thomassen . .",
    "john hopkins university press , 2001 .",
    "j.  stillwell . .",
    "springer - verlag , 1987 .",
    "j.  stillwell . .",
    "springer - verlag , new york , 1993 .",
    "in a first stage , dey and guha  @xcite obtain a term product representation of @xmath2 and @xmath3 as in the present lemma  [ lem : term - product ] .",
    "suppose @xmath557 , then a term  @xmath558 is denoted  @xmath559 .",
    "this term is equivalent in  @xmath560 to the complementary term  @xmath561 _ going backward _ along  @xmath121 .",
    "this complementary term is denoted  @xmath562 .",
    "the * _ length _ *  @xmath563 of a term  @xmath559 is the length of the sequence  @xmath558 .",
    "the length of a complementary term is defined analogously , so that @xmath564 .",
    "the * _ length _ * of a product of ( possibly complementary ) terms is the sum of the lengths of its terms .",
    "let us rename the above term and complementary term as respectively a * _ forward term _ * and a * _ backward term_*. a term will now designate either a forward or backward term . note that a term being equivalent to its complementary term , we may use a forward or backward term in place of each term . by convention , we will write a term in backward form only if it is strictly shorter than its complementary forward term .",
    "this convention will be implicitly assumed in this section and corresponds to the notion of _ rectified _ term in  @xcite .",
    "* @xmath182/*_reacts _ * if  @xmath566 , the unit element in the group  @xmath560 , * @xmath183/*_reacts _ * if  @xmath567 in  @xmath568 , for a term  @xmath33 such that @xmath569 , and * @xmath22/*_reacts _ * if  @xmath570 in  @xmath568 , for two terms  @xmath571 such that @xmath572 .",
    "the aim of dey and guha is to apply reactions to a given term product in order to reach a canonical form where no two consecutive terms react in that form . for this , they define a function @xmath573 that recursively applies reductions to a product of terms .",
    "this function is in turn called by another function @xmath574 , supposed to produce a canonical form .",
    "_ let  @xmath575  be @xmath289  terms such that @xmath576  does not react .",
    "if  @xmath577 @xmath183/reacts  or @xmath22/reacts with @xmath578  or @xmath579 ( and @xmath580  does not react ) , then @xmath581  does not @xmath183/react . _",
    "the non - existence of such @xmath183/reactions is essential in the proof that the function @xmath574 indeed returns a canonical form  ( * ? ? ?",
    "* prop . 7 ) .",
    "however , this claim is false as demonstrated by the following examples . consider a genus  @xmath22 surface with @xmath582 .",
    "put @xmath583 ,  @xmath584 , and  @xmath585 .",
    "then @xmath586 does not react and @xmath587 @xmath183/reacts , yielding  @xmath588 . but @xmath581",
    "@xmath183/reacts , in contradiction with the claim , since @xmath589 .",
    "likewise , if we now set @xmath590 ,  @xmath591 and  @xmath592 , we have : @xmath593  does not react , @xmath594  @xmath22/reacts , yielding  @xmath595 , and @xmath581  @xmath183/reacts , in contradiction with the claim , since @xmath589 .    define the * _ expanded word _ * of a term product as the word in the elements of  @xmath42 ( and their inverses ) obtained by replacing each term in the product with the corresponding factor of  @xmath121 or  @xmath596 .",
    "again , @xmath121  and  @xmath596 should be considered cyclically .",
    "call a product of terms * _ stable _ * if no two consecutive terms react .",
    "another important claim  ( * ? ? ? * lem .",
    "8) states that      this claim is used to prove that the ( supposed ) canonical form of a product is equivalent to  @xmath183 if and only if it is the empty product  ( * ? ? ?",
    "however this claim is again false as demonstrated by the following example .",
    "consider the same genus  @xmath22 surface as in the previous examples .",
    "then the product @xmath598 is stable and contains the factor  @xmath599 of length  @xmath600 that is also a factor of  @xmath601 .    finally , the canonical form defined by dey and guha is not canonical . by definition of the @xmath574 function in  @xcite , a stable (",
    "rectified ) product  @xmath246 is canonical , / @xmath602 . using the same genus  @xmath22 surface as before ,",
    "consider the products @xmath603 and @xmath604 .",
    "it is easily seen that none of these products react .",
    "it follows that ` canonical`@xmath605 , @xmath606 .",
    "however @xmath607 in  @xmath568",
    ". indeed , since @xmath608 in  @xmath568 , we have @xmath609 this contradicts the fact that an element of  @xmath610 can be expressed as a unique canonical product of terms .",
    "in particular , proposition  7 in  @xcite is wrong .",
    "the method proposed in  @xcite seems bound to fail : the above counterexamples orientable surfaces with @xmath611 .",
    "similar counterexamples for non - orientable surfaces can also be found starting with the product of squares as a ( canonical ) relator . ]",
    "show that there are not enough rules to ensure that stable products are canonical forms , but adding more rules would make more difficult to keep under check chains of reactions which are already out of control .",
    "another issue is that for the end of the comparison algorithm to be usable , appending a term to a stable product should not trigger chains of reaction deep down the stack .",
    "this adds even more constraints on the reaction rules , especially as lemma 13 in  @xcite does not seem to help .",
    "indeed , the function @xmath612 introduced in the lemma is supposed to reinforce the function @xmath613 defined in  @xcite . from its description , @xmath612 transforms a canonical product @xmath246 in @xmath614 by inserting some term product  @xmath615 into  @xmath246 before computing @xmath616 and @xmath617 .",
    "if  @xmath574  were canonical then @xmath618  and  @xmath246 would be equal as products of terms ; it follows that the functions @xmath612 and @xmath613 would have exactly the same effect ."
  ],
  "abstract_text": [
    "<S> let  @xmath0  be a graph cellularly embedded in a surface  @xmath1 . given two closed walks @xmath2  and  @xmath3 in  @xmath0 </S>",
    "<S> , we take advantage of the ram  model to describe linear time algorithms to decide if @xmath2  and  @xmath3 are homotopic in  @xmath1 , either freely or with fixed basepoint . </S>",
    "<S> we  restrict @xmath1 to be orientable for the free homotopy test , but allow non - orientable surfaces when the basepoint is fixed . </S>",
    "<S> after @xmath4  time preprocessing independent of @xmath2  and  @xmath3 , our algorithms answer the homotopy test in @xmath5  time , where @xmath6 ,  @xmath7 and  @xmath8 are the respective numbers of edges of @xmath0 ,  @xmath2 and  @xmath3 . as a byproduct </S>",
    "<S> we obtain linear time algorithms for the word problem and the conjugacy problem in surface groups . </S>",
    "<S> these results were previously announced by dey and guha ( 1999 ) . </S>",
    "<S> their approach was based on small cancellation theory from combinatorial group theory . </S>",
    "<S> however , several flaws in their algorithms make their approach fails , leaving the complexity of the homotopy test problem still open . </S>",
    "<S> we  present a geometric approach , based on previous works by colin  de  verdire and erickson , that provides optimal homotopy tests . </S>"
  ]
}