{
  "article_text": [
    "the atomic force microscope ( afm ) was introduced almost 30 years ago @xcite .",
    "the idea consists in mounting an ultra sharp tip on a beam ( cantilever ) and then scan it over a surface while recording the deflection of the beam . since its invention , the technique has been and still is progressing very fast and with it our understanding of phenomena that occur at the nanoscale and sometimes even at the atomic level .",
    "it naturally evolved from a static to a dynamic technique @xcite .",
    "dynamic afm , in turn , allowed for other techniques to emerge , such as magnetic force microscopy @xcite , electrostatic force microscopy @xcite , kelvin probe microscopy @xcite and many other modes have been introduced since then . yet , despite the enormous evolution the afm has made , it still has the limitation that the tip position becomes unstable at close proximity to the sample .",
    "this instability , commonly referred to as _ jump - to - contact _",
    ", happens when the cantilevers used have spring constants on the order of the n / m comparable to the force gradients that form when the tip is brought close to the sample surface .",
    "when the attractive tip - sample force gradient equals the spring constant of the cantilever the instability occurs . avoiding the jump - to - contact implies a minimum limit either in the cantilever stiffness or in the oscillation amplitude . for a particular interaction , if increasing the cantilever stiffness is not sufficient to overcome the tip instability , then increasing enough its kinetic energy avoids the jump to contact @xcite .",
    "these strategies however pose several problems : the stiffness of the cantilever limits the resolution in force ; large amplitudes of oscillation make it difficult to quantitatively analyze the interaction and the later also decrease the lateral resolution @xcite . the use of very stiff cantilevers , such as tuning forks @xcite solve the instability problem but make it impossible to measure the tip - sample forces . to overcome this conundrum some solutions",
    "have been proposed in the past @xcite and more recently force feedback microscopy ( ffm ) @xcite .",
    "these techniques have in common the use of a feedback loop to maintain tip stability by counteracting the tip sample force with an equal but opposite amount of force .    here",
    "we will consider the case where the counteracting force is controlled by a proportional , integral and differential controller ( pid ) .",
    "the force results from the addition of three components : proportional to the tip position @xmath0 ; proportional to the time integral of the tip position @xmath1 ; and proportional to the time derivative of the tip position @xmath2 .",
    "the pid controller gains are @xmath0 , @xmath1 and @xmath2 respectively .",
    "hereafter , we shall refer to this force as @xmath3 . in this letter",
    ", we work on some of the theoretical aspects of the technique . first we present the model system and study the conditions within which this system is stable .",
    "we then give an estimate of the expected bandwidth .",
    "however , we do not attempt to estimate the maximum permitted proportional gain @xcite .",
    "finally we study how the implementation of this strategy affects the harmonic modes of the oscillator and how the interactions can be calculated from amplitude and phase changes using this type of control .",
    "the cantilever plus tip are considered as a mass - spring system , with spring constant @xmath4 , mass @xmath5 and with some damping @xmath6 . in our approach",
    "we assume the mass is subjected to some tip sample force @xmath7 and to the control force @xmath3 .",
    "the motion of the mass is described by the equation below : @xmath8 where the control force depends on the tip position in the following way : @xmath9 this force is directly determined by the real time action of the controller on the piezo element at the cantilever base . from here on , we concentrate only on the cases were the tip - sample interaction force can be expressed as : @xmath10 @xmath11 is a term that does not depend on the position , @xmath12 is an elastic term proportional to the tip position and @xmath13 is a damping term proportional to the tip speed . in this case",
    "the total stiffness and damping coefficient can be written as @xmath14 and @xmath15 respectively .",
    "the equation of motion of such system can be described using laplace transforms as follows : @xmath16 hence the tip position : @xmath17 this solution is that of an harmonic oscillator when the integral gain @xmath18 .",
    "next , we propose to evaluate this expression when the system is submitted to an impulse to check its stability and then how it responds to harmonic stimuli .",
    "let us take the case were @xmath19 for @xmath20 and @xmath21 for @xmath22 , in which case the laplace transform is simply @xmath23 .",
    "analyzing this response allows us to obtain the conditions within which the system is stable .",
    "the behavior of the system will depend on the roots of the denominator in equation [ eq : lap ] .",
    "it is a third order polynomial so the zeros are better found numerically .",
    "nevertheless , we can approximate the denominator by another polynomial such that the zeros are easy to calculate .",
    "we can separate this in two different regimes , the under - damped regime and the over - damped regime .",
    "the first regime would correspond to the situation where the afm is operated in air or vacuum , whereas the second regime is more likely to occur when the cantilever motion is damped by liquid .      in the under - damped case",
    "the denominator of equation [ eq : lap ] has one real root and the two other roots are complex conjugates .",
    "the complex conjugates cause the system to oscillate whereas the real root is responsible for changing the equilibrium position around which the system oscillates .",
    "@xmath24 this is simply the inverse laplace transform of equation [ eq : lap ] that is the solution to equation 1 .",
    "the system decays to some mean value within a time @xmath25 and oscillates with frequency @xmath26 with an amplitude that decays with a time constant @xmath27 . for simplicity",
    "we will not explicit the values of constants @xmath28 or @xmath29 that do not matter for the purpose of discussing the stability of the system . here",
    "@xmath30 is the real root , @xmath31 is the real part of the complex root , @xmath26 its respective imaginary part and @xmath32 is the natural frequency of the system .",
    "note that the denominator of equation [ eq : lap ] can be rewritten as : @xmath33 where @xmath34 in the under - damped case @xmath35 is very small .",
    "if we replace @xmath35 by zero in the expression of @xmath36 we see that indeed @xmath37 .",
    "neglecting @xmath38 , allows to easily find the three roots .",
    "@xmath39 if either @xmath30 or @xmath31 are negative then @xmath40 diverges .",
    "the conditions in which they are positive give us the stability criteria : @xmath41 the first criterion relates to the _ jump to contact_. in conventional afm it happens when @xmath42 that occurs when the tip - sample force gradient equals the cantilever spring constant . in ffm",
    "this can be avoided trough the use of the proportional gain @xmath0 .",
    "the second criterion imposes a superior limit to the integral gain @xmath1 and thus limits the bandwidth of operation of the ffm .",
    "if criterion 2 is not met , then the system will oscillate with ever increasing amplitude .",
    "criterion 2 is not a useful criterion because for integral gains approaching that limit , the time it takes the oscillator to reach stability approaches infinity . as a matter of fact , ideally we want to maximize both @xmath30 and @xmath31 , corresponding to a restore of the equilibrium position and amplitude of oscillation to zero as fast as possible without instability .",
    "the integral gain @xmath1 that corresponds to this situation is : @xmath43     ( b ) integral gain equal to 1/2 of the ideal integral gain , ( c ) ideal integral gain ( 6667 n / ms ) and ( d ) integral gain 4 times the ideal integral gain .",
    "cantilever parameters are @xmath44 n / m , @xmath4570khz and @xmath46 kg / s.,width=319 ]    the second and third criteria show how the use of a proportional gain increases the maximum integral gain before the system becomes unstable and how the its maximum value depends on the tip - sample interaction i.e. if @xmath47 then the maximum integral approximates zero thus reducing the bandwidth of the system .",
    "1 shows the behavior of the system for four different integral gains .",
    "when the integral gain is zero one recognizes the behavior of a weekly damped oscillator .",
    "when @xmath48 the equilibrium position of the system can be seen as changing in time with a decay length @xmath25 .",
    "the frequency of the oscillation @xmath26 is in all cases very approximated to @xmath49 which is natural of a weakly damped oscillator .",
    "the data shown in fig .",
    "1 is relative to a numerical calculation of the roots .",
    "the approximations used here were also calculated and yielded values that that are precise to more than 1/1000 .      in this case",
    "the roots are all real for moderate pid gains .",
    "note however that despite the system being over - damped , a large enough integral gain can bring the system into oscillation in which case two of the roots will be complex conjugates .",
    "this is however one situation that is to be avoided as there is no advantage in that situation . unlike in the under - damped case ,",
    "if the system exhibits oscillations , these do not occur close to the natural frequency of the oscillator as they are driven by the controller gains rather than by the dynamics of the cantilever .",
    "for moderate gains , we can neglect the term on @xmath50 and it becomes straightforward to calculate the roots .",
    "the response of the system is in this case : @xmath51 where : @xmath52 thus , to avoid oscillations it must be : @xmath53 in which case @xmath54 must always be positive otherwise the system diverges . if @xmath54 is negative then @xmath55 would have to be negative for the system not to diverge .",
    "the condition that @xmath55 is negative is physically not possible .",
    "therefore one first criterion for stability must be : @xmath56 note that this criterion is the same as criterion 1a we found before .",
    "depending on condition [ eq : cond ] the system may or not oscillate and these oscillations may or not decay to zero .",
    "it can be shown ( figure 2 ) that an integral gain @xmath1 slightly above the one corresponding to equality in condition [ eq : cond ] produces negligible oscillation while driving the equilibrium position to zero faster .",
    "a useful criterion is : @xmath57 increasing the integral above this value only increases the oscillations without gain in performance ( see fig .",
    "2 ) , eventually leading to instabilities .",
    "criterion 2b represents the gain that restores the equilibrium position to zero , in about the minimum amount of time with negligible ringing . to visualize the behavior",
    "more intuitively let us take the case where @xmath1 is well below that limit : @xmath58 then equation of motion becomes : @xmath59 thus when the tip is subjected to a step force the position will change exponentially away from its initial position and then come back to the initial position .    , ( b ) integral gain corresponding to equality in condition [ eq : cond ] ( 2500n / ms),(c ) corresponding to crit . 2b and ( d ) 10 times the previous gain .",
    "cantilever parameters are @xmath44n / m , @xmath4570khz and @xmath60kg / s.,width=319 ]    fig .",
    "2 shows the behavior of the system for four different integral gains .",
    "when the integral gain is zero one recognizes the behavior of a strongly damped oscillator .",
    "when @xmath48 below the critical value , the equilibrium position of the system can be seen as decaying with a decay length of @xmath25 . for larger gains the system starts exhibiting oscillations .",
    "here we introduce the quality factor @xmath61 of the system , a commonly used parameter in afm : @xmath62 to simplify the discussion , let us consider the case where both the differential gain and the tip - sample dissipation are small . note that this will lead to lower limits for maximum integral gains . in that case",
    "the criteria for stability are : @xmath63 we can include the effect of the differential gain by replacing the @xmath61 factor by an effective q factor in which the differential gain is added to @xmath6 in equation eq . [ eq : q ] .",
    "the same procedure can be done to include the sample dissipation .",
    "one of the consequences of the result above is that if the tip - sample force gradient ( @xmath64 ) equals or is smaller than the negative of the cantilever stiffness , the jump to contact can still be avoided provided the proportional gain is large enough . for an under - damped oscillator smaller @xmath61 factors are more favorable whereas the contrary is true for an over - damped oscillator . for a given cantilever frequency and stiffness the best situation for the ffm operation",
    "is when the cantilever motion is close to the critical - damped regime . in the under - damped case",
    "the equilibrium position decays to zero with a time constant of @xmath65 , hence @xmath66 .",
    "notice the same is also approximately true in the over - damped case .",
    "the bandwidth of the ffm can be estimated from these limits : @xmath67 the ideal cantilever is one with high resonance frequency and close to critical damped .",
    "an example of one such type of cantilever would be the ones used in high speed afm @xcite .",
    "let us now consider an approach curve experiment .",
    "if a unit step force @xmath68 is applied to the system the maximum change of tip position @xmath69 is : @xmath70 the factor 2 is for a weakly damped system whereas for a damped system this factor is less than one . to have a total tip motion @xmath40 never greater than this value above the system",
    "must be allowed to relax a time @xmath71 before another step of magnitude @xmath72 can be applied . here",
    "@xmath73 is the base of the natural logarithm .",
    "this is : @xmath74 in an approach curve @xmath75 can be put as @xmath76 , ( how much the sample is approached times the spring constant of the interaction ) and @xmath77 can be divided by @xmath78 to give a velocity : @xmath79 this is the maximum speed at which an approach curve can be taken .",
    "taking the time constant @xmath65 and remembering @xmath30 gives : @xmath80 the maximum speed depends on the integral gain and on the tip sample interaction .",
    "the maximum integral gain in turn depends on all the other constants defining the system .",
    "if we replace @xmath1 by its maximum values that assure stability we find : @xmath81    the proportional gain plays a crucial role",
    ". not only it must be such that @xmath82 to remove the instability , but it also limits the speed that becomes zero when the sum above is not some limited value above zero .",
    "experimental set ups that can not provide an instantaneous force proportional to the position of the tip will not be able to overcome the jump to contact .",
    "as an example , take the limiting case were @xmath83n / m , @xmath44n / m and @xmath84n / m . if we use the same limits above and accept a displacement of the tip of @xmath85 we obtain a maximum speed of 105 nm / s .",
    "we have simulated an approach curve experiment in the limit where jump - to - contact usually occurs .",
    "four cases were considered : no pid control ; only integral control ; integral and proportional control .",
    "for the later we have considered an approach curve at the maximum speed estimated above , and at half that speed ( 52nm / s ) .",
    "fig 3 . shows the pid force and the tip position for these cases .",
    "3 shows that the error is smaller than the one estimated here .",
    "this is because most of the time the interaction is smaller than the value used for estimating the maximum speed . for the simulation we have used a force of the type @xmath86 where the coefficients @xmath87 and @xmath88 were chosen so that the maximum value of @xmath89 was 1 n / m hence equal to the cantilever spring constant .",
    "we can analyze the frequency behavior of the system by exciting it with a dirac delta , in which case the laplace transform of the motion of the system is : @xmath90 the amplitude of the response to an harmonic excitation and the respective phase are given by : @xmath91 ^ 2+[(\\gamma_t + g_d ) \\omega-\\frac{g_i}{\\omega}]^2 } } \\label{eq : r}\\ ] ] , @xmath92 \\label{eq : phi3}\\ ] ] the response of the oscillator obviously depends on the pid gains .",
    "however we are interested in the force / response ratio @xmath93 . for that we must compute the sum of the forces @xmath94 exciting the cantilever , which is the excitation plus the pid response to that .",
    "@xmath95 the ratio @xmath96 is : @xmath97 , naturally this ratio does not depend on the pid gains . but note that to measure this ratio it implies to measure the total excitation force and not just the harmonic supplied stimulus . the absolute value of the previous quantity is : @xmath98 , the phase difference between @xmath94 and @xmath99 also does not depend on the pid gains and is given by @xmath100 , from the two previous equations it follows : @xmath101 to proceed , we insert the information known from when there are no tip - sample forces , and we identify the respective amplitude and phase with the the superscript @xmath102 . in that case is : @xmath103 combining the last four equations yields the following final expressions : @xmath104 \\label{eq : km}\\ ] ] @xmath105 \\label{eq : gm}\\ ] ] where @xmath106 is the force / response ratio of the unperturbed oscillator and @xmath107 is the normalized force / response ratio . in a measurement , @xmath108 and @xmath29 can be easily measured . when using ffm one question that may arise is that of the sensitivity : is the sensitivity given by the cantilever properties or by the effective cantilever properties that are changed by the pid ?",
    "the answer is that it depends on how the excitation is taken into account .",
    "notice that the pid contributes to excite the cantilever ( [ eq : fsum ] ) and that contribution contains information about the tip - sample interaction .",
    "if the total excitation is measured , then the sensitivity is intrinsically given by the cantilever properties , whereas if only the harmonic stimulus @xmath109 is measured , then the sensitivity is given by the effective cantilever parameters . if the pid gains are moderate , then the dynamic response of the cantilever is not too much affected , in which case to compute the interaction as a function of @xmath94 or @xmath109 yields the same result .    as a conclusion to this section",
    ", the sensitivity in dynamic mode depends on the spring constant of the cantilever in the same way as in conventional afm , but the spring constants required to avoid the jump to contact in ffm are lower than those required for conventional afm .",
    "in conclusion we show that with the use of a pid feedback loop to control the tip position it is no longer required to use cantilevers with spring constants larger than the tip - surface force gradient to avoid the jump - to - contact as long as a large enough proportional actuation is done to the tip effectively changing the cantilever spring constant to @xmath110 . the fact that @xmath111 never is zero or negative means that the cantilever always has a limited valued equilibrium position , and is a requirement for ffm to work .",
    "the proportional gain is also relevant to increase the maximum integral gain that can be applied to the system without causing instabilities , thus increasing the bandwidth of the technique . the integral gain @xmath1 will work to maintain the equilibrium position of the tip at the same place .",
    "finally , we conclude that the use of the proportional gain effectively increases the cantilever spring constant but this effective augmentation of the cantilever spring constant does not result in loss of sensitivity .",
    "mario s. rodrigues acknowledges financial support from fundao para a cincia e tecnologia sfrh / bpd/69201/2010 .",
    "luca costa acknowledges cost action td 1002 .",
    "p.  d. ashby , l.  chen , and c.  m. lieber .",
    "probing intermolecular forces and potentials with magnetic feedback chemical force microscopy .",
    "_ journal of the american chemical society _ ,",
    "1220 ( 39):0 94679472 , 2000 .",
    "l.  costa , m.  s. rodrigues , e.  newman , c.  zubieta , j.  chevrier , and f.  comin . imaging material properties of biological samples with a force feedback microscope .",
    "0 ( 14):0 ? ? ? , 2013"
  ],
  "abstract_text": [
    "<S> it was shown recently that the force feedback microscope can avoid the jump - to - contact in atomic force microscopy even when the cantilevers used are very soft , thus increasing force resolution . in this letter </S>",
    "<S> , we explore theoretical aspects of the associated real time control of the tip position . </S>",
    "<S> we take into account lever parameters such as the lever characteristics in its environment , spring constant , mass , dissipation coefficient and the operating conditions such as controller gains , and interaction force . </S>",
    "<S> we show how the controller parameters are determined so that the ffm functions at its best and estimate the bandwidth of the system under these conditions .     corresponding author : _ mmrodrigues@fc.ul.pt_ ] </S>"
  ]
}