{
  "article_text": [
    "supervised image segmentation is fundamental in a large number of hyperspectral image applications  @xcite .",
    "image segmentation aims to partition the image domain such that pixels belonging to the same partition element share similar properties , either by raw pixel values or more complex features . due to its ill - posed nature (",
    "_ e.g. _ depending on the goal , multiple similarity criteria for grouping pixels in the same partition element can be used ) , image segmentation is often performed with help of regularization that promote or penalize different behaviors , _",
    "e.g. _ the use of a markov random field  @xcite mrf ) to promote smoothness of the labeling .",
    "as partitions are naturally represented by images of integers , maximum _ a posteriori _ ( map ) segmentations become integer optimization problems .",
    "segsalsa  @xcite sidesteps the discrete nature of the segmentation problems by using a hidden field to drive the segmentation and marginalizing on the hidden field  @xcite combined with a vectorial total variation ( vtv ) prior  @xcite .",
    "the segmentation is inferred by computing the marginal maximum _ a posteriori _ ( mmap ) estimate of the hidden field , which is a convex problem solved by the split augmented lagrangian shrinkage ( salsa ) algorithm  @xcite .    in this paper , we extend the formulation of segsalsa to include a generalization of vtv prior based on structure tensor priors  @xcite , thus deriving a more general algorithm for hyperspectral image segmentation . the structure tensor prior is constructed from a patch - based jacobian .",
    "the regularization via the structure tensor prior is achieved via a schatten norm regularization , akin to  @xcite .",
    "the paper is organized as follows .",
    "section [ sec : background ] describes the segsalsa algorithm , introducing the hidden fields and the marginal map formulation .",
    "section [ sec : prior ] presents the structure tensor regularization and describes the construction of the structure tensor prior from the patch - based jacobian .",
    "section [ sec : optimization ] formulates our optimization problem and presents the segsalsa - str algorithm .",
    "section [ sec : results ] illustrates the validity of the algorithm on synthetic and real hyperspectral data , and section [ sec : conclusion ] concludes the paper .",
    "let @xmath0 denote a @xmath1-pixel hyperspectral image with @xmath2 spectral bands , where @xmath3 denotes the feature vector corresponding to the image pixel @xmath4 , @xmath5 the set that indexes the image pixels , @xmath6 the set of possible @xmath7 labels , and @xmath8 a labelling of the image .",
    "[ [ maximum - a - posteriori - segmentation ] ] maximum _ a posteriori _ segmentation + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the segsalsa formulation adopts a bayesian perspective ; the map segmentation associated with the labeling @xmath9 is obtained as @xmath10 where @xmath11 and @xmath12 denote the posterior probability and the observation model respectively , and @xmath13 the prior on the labeling . under assumption of conditional independence of the observation model , we can expand the observation model @xmath14 the optimization associated map formulation is an integer optimization problem : apart from a small number of exceptions , the use of contextual priors @xmath13 , such as mrf priors makes a combinatorial problem .",
    "[ [ hidden - fields - and - marginal - map ] ] hidden fields and marginal map + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    to mitigate the difficulties associated with the integer optimization problem of the map , we move from the discrete formulation by introducing a hidden field  @xcite and marginalizing on the discrete labels .",
    "we represent the hidden field @xmath15 as a @xmath16 matrix containing a collection of hidden vectors @xmath17 for @xmath18 .",
    "the joint probability of the labeling @xmath19 and the field @xmath15 is @xmath20 , with assumption of conditional independence of @xmath21 .",
    "the joint probability of the features @xmath22 , the labeling @xmath19 and the field @xmath15 is @xmath23 .",
    "we can now marginalize on the discrete labels , @xmath24 and obtain a marginal map ( mmap ) estimate of the hidden field , @xmath25 which is no longer a discrete optimization problem .    [",
    "[ link - between - class - labels - and - hidden - fields ] ] link between class labels and hidden fields + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    as a model for the conditional probabilities @xmath26 for the labels given the field , we adopt @xmath27_k,\\ ] ] for @xmath28 and @xmath29 .",
    "this link between the probabilities of the class labels and the hidden fields imposes two constraints on the hidden field and , consequently , on the optimization : the field must be nonnegative , and each hidden vector @xmath30 for @xmath31 must sum to one .",
    "we can now formulate the optimization as @xmath32",
    "we extend the segsalsa algorithm by replacing the vtv prior by a generalization of vtv based on structure tensor regularization  @xcite .    [",
    "[ patch - based - jacobian ] ] patch - based jacobian + + + + + + + + + + + + + + + + + + + +    following closely the notation in  @xcite , we define the patch - based jacobian of the hidden field as @xmath33_i^t = \\begin{bmatrix }   ( p_1 d_h \\z)_i ^t & \\hdots & ( p_l d_h \\z ) _",
    "i^t   \\\\   ( p_1 d_v \\z ) _ i^t & \\hdots & ( p_l d_v \\z ) _ i^t   \\end{bmatrix},\\ ] ] where @xmath34_i$ ] denotes the components of the patch - based jacobian on the @xmath4th pixel of the hyperspectral image , corresponding to a @xmath35 matrix .",
    "@xmath36 and @xmath37 are the horizontal and vertical difference operators , and @xmath38 is a weighted shift operator corresponding to the patch , with each operator being applied equally to the entire field @xmath39 . assuming the patch to be a @xmath40 rectangular patch , with @xmath41 pixels",
    ", @xmath38 corresponds to the @xmath42th possible shift within the patch ( from the @xmath43 possible shifts ) weighted by a gaussian centered on the center of the patch and with a bandwidth @xmath44 .",
    "[ [ discrete - structure - tensor ] ] discrete structure tensor + + + + + + + + + + + + + + + + + + + + + + + + +    from the patch - based jacobian of the hidden field , the structure tensor @xmath45 is defined as @xmath46_i = [ j \\z]_i^t [ j \\z]_i,\\ ] ] a @xmath47 matrix for the @xmath4th pixel of the hyperspectral image .",
    "the minimization of the eigenvalues of the structure tensor @xmath45 in leads to the penalization of variations of the field among the pixels in patch .",
    "as there is an intrinsic connection between the eigenvalues of the structure tensor @xmath48 and the singular values of the patch - based jacobian @xmath49 , we can minimize the singular values instead .",
    "let @xmath50_i \\|_{s_p}$ ] denote the schatten @xmath51 norm of the patch - based jacobian @xmath52_i \\|_{s_p } = \\| \\sigma([j \\z]_i ) \\|_p,\\ ] ] where @xmath53_i)$ ] represent the singular values of @xmath34_i$ ] .",
    "the discrete structure tensor prior can be constructed through the minimization of the singular values of the patch - based jacobian @xmath54_i \\|_{s_p }   + c^{te}.\\ ] ] it should be noted that for @xmath55 patches ( @xmath56 ) , the minimization of the schatten norm of the structure tensor is equivalent to the minimization of the vtv , leading to the segsalsa formulation in  @xcite .",
    "with the segsalsa general formulation described in section [ sec : background ] and armed with the new generalized total variation prior from the structure tensor described in section [ sec : prior ] we can now describe our algorithm which we name segsalsa - str .",
    "[ [ problem - formulation ] ] problem formulation + + + + + + + + + + + + + + + + + + +    combining the mmap formulation in with the prior described in , we can formulate our mmap problem as follows : @xmath57_i \\|_{s_p}\\\\ & \\textrm{subject to : } \\quad\\quad \\z \\geq 0 \\quad\\quad   \\textbf{1}_k^t \\z = \\textbf{1}_n^t \\nonumber,\\end{aligned}\\ ] ] where @xmath58^t$ ] , and @xmath59 in the feasible set . as the hessian of @xmath60 is semidefinite positive , and",
    "@xmath61_i \\|_{s_p}$ ] is a composition of norms , the optimization is convex .",
    "the solution @xmath62 is computed by the salsa methodology  @xcite .",
    "however , we can not apply the salsa methodology directly to . to do",
    "so we rewrite the problem as a sum of convex functions with linear constraints .",
    "[ [ rewriting - the - optimization - problem ] ] rewriting the optimization problem + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we rewrite the optimization problem as @xmath63 where @xmath64 , for @xmath65 , denote linear operators , and @xmath66 , for @xmath65 denote closed , proper , and convex functions .",
    "we define the linear operators @xmath64 as : @xmath67 where @xmath68 denotes the identity operator and @xmath69 denotes an operator stacking the patch - based jacobians defined in .",
    "we define the closed , proper , and convex functions @xmath70 as : @xmath71 the functions @xmath72 and @xmath73 are indicator functions for the sets @xmath74 and @xmath75 , respectively .",
    "the introduction of a variable splitting @xmath76 for @xmath65 , and with @xmath77 , allows us to reformulate the optimization into a constrained formulation @xmath78 with @xmath79 the corresponding to the stacking of the linear operators @xmath64 , for @xmath65 .",
    "[ [ salsa - methodology ] ] salsa methodology + + + + + + + + + + + + + + + + +    the optimization is solved following the salsa methodology  @xcite , an instance of the alternating direction method of multipliers designed to optimize sum of an arbitrary number of convex terms .",
    "let @xmath80 denote the scaled lagrange multipliers ; solving reduces to the following iterative decoupled problem @xmath81    [ [ solving - the - iterative - decoupled - problem ] ] solving the iterative decoupled problem + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the quadratic problem is solved by computing independent cyclic convolutions on each image of @xmath15 , with time complexity @xmath82 .",
    "the problem can be decoupled for each of the convex functions @xmath70 , amounting to computing the moreau proximity operator ( mpo )  @xcite for each of the functions .    for @xmath83",
    "involved in the respective mpo is respective the mpos , all with @xmath84 complexity are as follows : @xmath85 is the root of a polynomial using a closed form solution ; @xmath86 is the projection onto the positive orthant ; and @xmath87 is the projection onto the probability simplex . for @xmath88 ,",
    "the mpo is the solution of the following problem @xmath89_i \\|_{s_p } + \\frac{\\mu}{2 \\lambda } \\|h_2 \\z^k - \\u_2 - d^k_2 \\|_f^2.\\ ] ] for @xmath90 , which we adopt in this paper , this can be solved by the soft thresholding of the singular values of @xmath91 .    [ cols=\"^,^,^,^,^ \" , ]     [ [ complexity - parallelization - and - stopping - criterion ] ] complexity , parallelization and stopping criterion + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the time complexity of solving the problem is dominated by the computation of @xmath1 single value decompositions of matrices @xmath92 , which amounts to a time complexity of @xmath93  @xcite .",
    "the complexity of segsalsa - str is @xmath94 being highly parallelizable : @xmath95 decoupled fast fourier transforms followed by @xmath1 decoupled svds . as a stopping criterion",
    ", we impose that both the primal and dual residuals are smaller than a given threshold .",
    "it was observed that a fixed number of iterations of the order of @xmath96 provides excellent results .",
    "we validate our algorithm in the segmentation of a subscene of the aviris indian pine scene ( fig . [",
    "fig : results ] ) .",
    "the subscene consists of a @xmath97 pixel subsection with @xmath98 spectral bands and contains @xmath99 different classes .",
    "@xmath100 samples per class are used as training set .",
    "the classes are modeled by a multinomial logistic regression ( mlr ) and the mlr weights are learnt using the lorsal  @xcite . the parameter @xmath101 corresponding to the relative weight of the structure tensor prior is set to @xmath102 , a compromise that allows good classification performance with a lower number of iterations of the algorithm .",
    "we illustrate the joint effect of the size of the patch and of the bandwidth @xmath44 of the gaussian weighting for the construction of the patch - based jacobian , by comparing the segmentation results of a real hyperspectral image ( fig .",
    "[ fig : results ] ) for varying sizes of the patches .",
    "the bandwith @xmath44 is set as the distance in pixels from the border of the patch to the center ( _ e.g. _ @xmath103 for @xmath104 patches ) , with @xmath105 for @xmath106 patches .",
    "as structure tensor regularization is a generalization of the vtv prior , in the case of @xmath55 patches , segsalsa - str corresponds to segsalsa with the vtv prior  @xcite .",
    "the analysis of the segmentation results by segsalsa - str shows the capabilities of the structure tensor prior in obtaining smooth segmentation boundaries .",
    "the hidden fields corresponding to two different classes ( figs .",
    "@xmath2 , @xmath107 ) illustrate the preservation of detail of the segmentation ( fig .",
    "@xmath108 ) .",
    "the effect of increasing the patch size is evident ( bottom row ) as the segmentation performance for higher patch sizes is higher than the segmentation performance for lower patch sizes .",
    "the use of structure tensor priors with a patch size larger than @xmath106 ( figs .",
    "@xmath108 , @xmath109 , @xmath110 , @xmath4 ) , allows an increase of segmentation performance when compared to @xmath106 patches ( fig .",
    "@xmath111 ) .",
    "this shows that extending the segsalsa algorithm by using a generalization of the vtv prior based on structure tensor regularization allows for improved segmentation performance at the cost of a higher computational burden .",
    "in this paper we extended the segsalsa algorithm to use a generalized total variation prior based on structure tensor regularization  segsalsa - str .",
    "this is a more general formulation of the segsalsa algorithm which extends the concept of vtv from the pixel level to the patch level .",
    "the shift from a discrete to a continuous formulation paves the way for a class of relevant approaches in remote sensing through the inclusion of different priors .",
    "the algorithm was validated in simulated and real hyperspectral data ."
  ],
  "abstract_text": [
    "<S> in this paper we present a supervised hyperspectral image segmentation algorithm based on a convex formulation of a marginal maximum _ a posteriori _ segmentation with hidden fields and structure tensor regularization : segmentation via the constraint split augmented lagrangian shrinkage by structure tensor regularization ( segsalsa - str ) . </S>",
    "<S> this formulation avoids the generally discrete nature of segmentation problems and the inherent np - hardness of the integer optimization associated .    </S>",
    "<S> we extend the segmentation via the constraint split augmented lagrangian shrinkage ( segsalsa ) algorithm  @xcite by generalizing the vectorial total variation prior using a structure tensor prior constructed from a patch - based jacobian  @xcite . </S>",
    "<S> the resulting algorithm is convex , time - efficient and highly parallelizable . </S>",
    "<S> this shows the potential of combining hidden fields with convex optimization through the inclusion of different regularizers . </S>",
    "<S> the segsalsa - str algorithm is validated in the segmentation of real hyperspectral images .    </S>",
    "<S> image segmentation , hidden fields , structure tensor regularization , constrained split augmented lagrangian shrinkage algorithm ( salsa ) </S>"
  ]
}