{
  "article_text": [
    "a _ @xmath0 quasi - isometry _ @xmath1 between metric spaces @xmath2 and @xmath3 is a map @xmath4 satisfying @xmath5 with the additional property that there is a number @xmath6 such that @xmath3 is the @xmath6 neighborhood of @xmath7 .",
    "two quasi - isometries @xmath8 are considered to be equivalent if there is a number @xmath9 such that @xmath10 for all @xmath11 .",
    "let @xmath12 , @xmath13 be connected , simply connected non - degenerate unimodular split solvable groups ( see section [ geometry of g ] for definitions ) .",
    "we say a map from @xmath14 to @xmath15 is _ standard _ , if it splits as a product map that respects @xmath16 and @xmath17 ( see definition [ standard map ] ) .",
    "also homomorphisms @xmath16 is called _ diagonalizable _ if its image can be conjugated into the set of diagonal matrices .",
    "the main result of this paper is the following statement .",
    "+ _ theorem [ behaviors of phi ] ( abridged ) _ _ let @xmath14 , @xmath15 be non - degenerate , unimodular , split abelian - by - abelian solvable lie groups , and @xmath18 a @xmath19 quasi - isometry . then @xmath20 is bounded distance from a composition of a left translation and a standard map .",
    "_    consequently , _ corollary [ diagornot ] _ _ if @xmath16 is diagonalizable and @xmath17 is nt , then there is no quasi - isometry between them . _",
    "[ qigroup ] @xmath21 } bilip(v_{[\\alpha ] } ) \\right ) \\rtimes \\mbox{sym}(g)\\ ] ]    here @xmath22 $ ] is an equivalence class of roots and @xmath23 is a finite group , analogous to the weyl group in reductive lie groups , that that reflects the symmetries of @xmath14 .",
    "( see section [ geometry of g ] )    when @xmath16 is diagonalizable , as an application the work by dymarz @xcite on quasi - conformal maps on the boundary of @xmath14 , we have    [ showing polycyclic ] in the case that @xmath16 is diagonalizable , if @xmath24 is a finitely generated group quasi - isometric to a @xmath14 , then @xmath24 is virtually polycyclic .",
    "our starting point is theorem [ exisence of standard maps in small boxes ] , and our first task is to show that the @xmath25 part of the standard maps ( see definition [ standard map ] ) @xmath26 are affine .",
    "this is done in section 3 , where will see that the linear part is a scalar multiple of a finite order element in @xmath27 ( where @xmath28 is the rank of @xmath14 ) .",
    "we also give interpretations of the linear and constant part of @xmath26 in terms of properties of @xmath15 and measure of certain sets in the box where @xmath26 was partially defined . in section 4 ,",
    "we show that the linear part of the @xmath26 s in different boxes have to be the same up to scalar multiple in the case that that the rank of @xmath14 is 2 or higher .",
    "the rank @xmath29 case is the same as the content in @xcite .",
    "the proof for higher rank case basically consists of many rank @xmath29 argument as appeared in @xcite . in the last section",
    ", we put all theses partially defined standard maps together to produce a splitting of the original quasi - isometry .",
    "* acknowledgement * i would like to thank alex eskin and david fisher for their incredible patience and assistance .",
    "i also wish to thank tullia dymarz for helpful conversations and coordinating results of her paper @xcite with this one , and to mikhail ershov for finding me the reference containing the example of a solvable lie group that admits no lattices .",
    "here we recall the settings from @xcite and define new terms that will be used in this paper .",
    "* non - degenerate , split abelian - by - abelian solvable lie groups * let @xmath30 be a ( real ) solvable lie algebra , and @xmath31 be a cartan subalgebra .",
    "then there are finitely many non - zero linear functionals @xmath32 called _ roots _ , such that    @xmath33    where @xmath34 , @xmath35 is the identity map on @xmath30 , and @xmath36 is the adjoint representation .",
    "let @xmath37 denotes for the set of roots .",
    "then @xmath38 acts on @xmath37 in a natural way .",
    "we define @xmath39 to be the subgroup consisting @xmath40 such that    1 .",
    "it leaves the set of roots invariant , i.e. @xmath41 .",
    "2 .   for every @xmath42 , dim@xmath43dim@xmath44 .    in this way",
    ", elements of @xmath39 induces a permutation on the set @xmath37 , and we define @xmath45 to be the image of @xmath39 in the group of permutations of @xmath37 . for a generic @xmath30 ,",
    "its @xmath39 is trivial .",
    "we say @xmath30 is _ split abelian - by - abelian _",
    "if @xmath30 is a semidirect product of @xmath31 and @xmath46 , and both are abelian lie algebras ; _ unimodular _ if the the roots sum up to zero ; and _ non - degenerate _ if the roots span @xmath47 .",
    "in particular , non - degenerate means that each @xmath48 is real - valued , and the number of roots is at least the dimension of @xmath31 .",
    "being unimodular is the same as saying that for every @xmath49 , the trace of @xmath50 is zero .",
    "we extend these definitions to a lie group if its lie algebra has these properties , and write @xmath51 , @xmath23 to mean @xmath39 and @xmath45 where @xmath30 is the lie algebra of @xmath14 .",
    "therefore a connected , simply connected solvable lie group @xmath14 that is non - degenerate , split abelian - by - abelian necessary takes the form @xmath52 such that    1 .   both @xmath53 and @xmath54",
    "are abelian lie groups . 2 .",
    "@xmath55 is injective 3 .",
    "there are finitely many @xmath56 which together span @xmath57 , and a decomposition of @xmath58 4 .",
    "there is a basis @xmath59 of @xmath54 whose intersection with each of @xmath60 constitute a basis of @xmath60 , such that for each @xmath61 , @xmath62 with respect to @xmath59 is a matrix consists of blocks , one for each @xmath60 , of the form @xmath63 , where @xmath64 is an upper triangular with 1 s on the diagonal and whose off - diagonal entries are polynomials of @xmath65 . if in addition , @xmath14 is unimodular , then @xmath62 has determinant 1 for all @xmath61 .",
    "the _ rank _ of a non - degenerate , split abelian - by - abelian group @xmath14 is defined to be the dimension of @xmath53 , and by a result of cornulier @xcite , if two such groups are quasi - isometric , then they have the same rank .    by abuse of notation , we call @xmath37 roots of @xmath14 as well and coordinatize its points as @xmath66 , where @xmath67 , @xmath68",
    ". a left invariant finsler metric that is quasi - isometric to a left invariant riemannian is given by :    @xmath69    where @xmath70 is a polynomial .",
    "the following consequence is immediate .",
    "[ qi embedding ] if @xmath14 is non - degenerate , split abelian - by - abelian , then it can be qi embedded into @xmath71 , where @xmath72 is a non - unimodular solvable lie group determined by @xmath73 , where @xmath74 is a nilpotent matrix ( upper triangular with 1 s on the diagonal ) with polynomial entries , equipped with a left - invariant finsler metric given by @xmath75 where @xmath76 is a polynomial .",
    "when @xmath77 is diagonal , @xmath78 is just the usual hyperbolic space .    to understand the geometry of @xmath78 better , we first note that the metric is bilipchitz to one given by @xmath79 , which is quasi - isometric to one given by @xmath80 for some polynomial @xmath81",
    ". so a function q.i . to the metric on @xmath78 is the following @xmath82 where @xmath83 satisfies @xmath84    since exponential grows faster than any polynomials , the function @xmath85 has the following property : @xmath86 for some constant @xmath87 depends only on the polynomial @xmath88 .    back to the description of @xmath14",
    ", we declare two roots equivalent if they are positive multiples of each other , and write @xmath89 $ ] for the equivalence class containing @xmath90 . moreover , for @xmath91 $ ] , we say @xmath92 less than @xmath93 if @xmath94 .",
    "this makes sense because all roots in a root class are positive multiples of each other .",
    "a left translate of @xmath95}=\\oplus_{\\sigma \\in [ \\xi ] } v_{\\sigma}$ ] will be called a _ horocycle of root class @xmath89$]_.    a left translate of @xmath54 , or a subset of it , is called a _",
    "flat_. for @xmath96 , @xmath97 points in @xmath54 , we compute subsets of @xmath98 and @xmath99 that are within distance 1 of each other according to the embedded metric in lemma [ qi embedding ] , as the @xmath100 and @xmath101 translate of the subset    @xmath102 \\subset \\mathbf{a}\\ ] ]    since the roots sum up to zero in a non - degenerate , unimodular , split abelian - by - abelian group , the set where two flats come together can be empty , i.e .",
    "the two flats have no intersection .",
    "if it is not empty , then the equation above says that it is an unbounded convex subset of @xmath53 bounded by hyperplanes parallel to root kernels .",
    "[ standard map ] let @xmath14 , @xmath15 be non - degenerate , split abelian - by - abelian lie groups .",
    "a map from @xmath14 to @xmath15 or a subset of them , is called _ standard map _ if it takes the form @xmath103 , where @xmath104 sends foliation by root class horocycles of @xmath14 to that of @xmath15 , and @xmath105 sends foliations by root kernels of @xmath14 to that of @xmath15 .",
    "we will often refer to @xmath1 as the @xmath25 part of a standard map .",
    "note that when @xmath14 has at least @xmath106 many root kernels , the condition on @xmath1 means that @xmath1 is affine , and when @xmath14 is rank 1 , the condition on @xmath1 is empty .        * neighborhoods of a set * we write @xmath107 for the ball centered at @xmath100 of radius @xmath108 , and @xmath109 for the @xmath110 neighborhood of the set @xmath111 .",
    "we also write @xmath112 for the hausdorff distance between two sets @xmath111 and @xmath113 . if @xmath114 is a bounded compact set , and @xmath115 , we write @xmath116 for the bounded compact set that is scaled from @xmath117 with respect to the barycenter of @xmath117 .",
    "given a set @xmath2 , a point @xmath118 , the _ @xmath119 linear neighborhood of @xmath2 with respect to @xmath120 _ is the set @xmath121 .",
    "equivalently it is the set @xmath122 . by @xmath119 linear neighborhood of a set @xmath2 , we mean the @xmath119 linear neighborhood of @xmath2 with respect to some @xmath123 .",
    "if a quasi - geodesic @xmath124 is within @xmath119 linear ( or just @xmath125-linear ) neighborhood of a geodesic segment @xmath126 , where @xmath127 and @xmath128 , then we say that @xmath124 _ admits a geodesic approximation _",
    "by @xmath126 .",
    "let @xmath129 stands for a non - degenerate , unimodular , split abelian - by - abelian group .",
    "fix a point @xmath130 .",
    "we define the following :    * for a root class @xmath22 $ ] , we write @xmath131}=\\sum_{\\xi \\in [ \\alpha ] } \\xi$ ] be the sum of all roots in the equivalence class .",
    "let @xmath132 be the set of all @xmath131}$ ] s for @xmath22 $ ] ranging over all root classes of @xmath14 , and @xmath133 for the group of linear maps that leaves @xmath132 invariant . as @xmath132 is finite",
    ", @xmath133 is a subgroup of @xmath27 . * for @xmath42 a root",
    ", we write @xmath134 for the positive multiple of @xmath131}$ ] of unit norm with respect to the usual euclidean inner product on @xmath53 and @xmath135 } \\in \\mathbf{a}$ ] for the dual of @xmath136 . *",
    "given @xmath137 , we define @xmath138 we say a vector @xmath137 is _ regular _ if @xmath139 for all roots @xmath140 , and a linear functional @xmath141 is regular if its dual @xmath142 is regular . * let @xmath141 , we define @xmath143 , @xmath144 , @xmath145 , as @xmath146 , @xmath147 , @xmath148 respectively , where @xmath149 is the dual of @xmath150 . * by _ the walls based at p _ , we mean the set @xmath151 . *",
    "the root kernels partition the unit sphere in @xmath53 into into convex subsets called _",
    "chambers_. for vectors @xmath152 in the interior of the same chamber @xmath153 , @xmath154 , and we define @xmath155 for this common subspace of @xmath54 and @xmath156 for its complement in @xmath54 according to the root space decomposition , so that @xmath157 . * by a _ geodesic segment through p _ , we mean a set @xmath158 , where @xmath159 is a directed line segment in @xmath53 . by direction of a directed line segment in euclidean space , we mean a unit vector with respect to the usual euclidean metric , and by direction of @xmath158 we mean the direction of @xmath159 . * for @xmath160 , by _ @xmath161-hyperplane through p _",
    ", we mean a set @xmath162 , where @xmath163 is an @xmath161-dimensional linear subspace or an intersection between an @xmath161-dimensional linear subspace with a convex set .",
    "* let @xmath164 be the projection onto the @xmath53 factor as @xmath165 .",
    "* for each root @xmath48 , define @xmath166 as @xmath167 .",
    "we refer to negatively curved spaces @xmath168 or @xmath169 } \\rtimes \\langle \\vec{v}_{\\alpha } \\rangle$ ] as weight ( or root ) hyperbolic spaces . * for a regular vector @xmath137 , we define @xmath170 as @xmath171 , where @xmath172 is the standard inner product on @xmath53 . in the rank 1 space @xmath173 , the height function",
    "is given as @xmath174 * for a regular liner functional @xmath141 with unit norm , we define @xmath175 as @xmath176_{w^{-}_{\\ell } } , \\ell(\\mathbf{t } ) \\vec{v}_{\\ell})$ ] .",
    "* box associated to a compact convex set * fix a net @xmath177 of @xmath14 . for @xmath42 ,",
    "let @xmath178 be maximal product of intervals of size @xmath108 , @xmath179^{\\mbox{dim}(v_{\\alpha})}$ ] .",
    "let @xmath180 be a convex compact set with non - empty interior whose barycenter is the identity of @xmath53 .",
    "we define the _ box associated to @xmath117 _ , @xmath181 , as the set @xmath182 .",
    "we write    * @xmath183 $ ] ( or @xmath184 $ ] ) for the set of geodesics in @xmath181 whose @xmath185 images begin and end at points of @xmath186 such that the ratio between its length and the diameter of @xmath117 lies in the interval @xmath187 $ ] .",
    "this is a set of @xmath177 approximations of such geodesic segments , so is finite . * for @xmath188 ,",
    "write @xmath189 $ ] ( or @xmath190 $ ] ) for the set of @xmath161 dimensional hyperplanes in @xmath181 such that the ratio between its diameter and the diameter of @xmath117 lies in the interval @xmath191 $ ] .",
    "this is a set of @xmath177 approximations of such bounded subsets in @xmath161-hyperplanes , so again is finite .",
    "* @xmath192 ( or @xmath193 ) for the set of points in @xmath181 .",
    "that is @xmath194 , so a finite set too .",
    "* let @xmath195 be an element of @xmath196 .",
    "we write @xmath197 , @xmath198 for subset of @xmath199 , @xmath200 contained or containing @xmath195 , and @xmath201 for the subset of @xmath192 contained in @xmath195 .",
    "the following lemma shows that @xmath14 is amenable .",
    "[ boxes are folner ] let @xmath180 be compact convex with non - empty interior . then , @xmath202 , @xmath203 is a flner sequence .",
    "the volume ratio between @xmath204 and @xmath202 is @xmath205 .",
    "see lemma [ forste - boxes are folner ] in @xcite    [ general folner ] the same calculation as above shows that for any set @xmath206 of the form @xmath207 , where @xmath208 , @xmath180 , the ratio of volumes of @xmath209 and that of @xmath206 is @xmath210 .",
    "we recall the following from @xcite .",
    "[ exisence of standard maps in small boxes ] let @xmath14 , @xmath15 be non - degenerate , unimodular , split abelian - by - abelian lie groups , and @xmath211 be a @xmath0 quasi - isometry .",
    "given @xmath212 , there exist numbers @xmath213 , @xmath214 , @xmath215 depending on @xmath216 , @xmath125 , @xmath217 and @xmath19 with the following properties :    if @xmath180 is a product of intervals of equal size at least @xmath218 , then a tiling of @xmath181 by isometric copies of @xmath219 @xmath220    contains a subset @xmath221 of @xmath222 with relative measure at least @xmath223 such that    1 .   for every @xmath224",
    ", there is a subset @xmath225 of relative measure at least @xmath226 .",
    "the restriction @xmath227 is within @xmath228 hausdorff neighborhood of a standard map @xmath229 .    here",
    ", @xmath230 , @xmath231 and @xmath232 all approach zero as @xmath217 , @xmath216 go to zero .    in this section ,",
    "we focus on a particular standard map @xmath233 supported on the subset @xmath234 of a good box @xmath235 , @xmath236 .",
    "we will first show that the @xmath26 is affine for all ranks .",
    "then we will interpret its the constant and linear parts : the linear part has to come from a finite set related to the geometry of @xmath15 , and the constant part depends on measure of certain subsets in @xmath235 .",
    "we will drop the subscript @xmath161 from now on .      in this subsection",
    "we define a list of objects that will be used for the remaining of this section .    * root class half planes * a set of the form @xmath237 $ ] ( resp.@xmath238 $ ] ) , where @xmath239 , @xmath240 , is called a @xmath22 $ ] negative ( resp .",
    "positive ) half plane .",
    "we write @xmath241}$ ] ( resp .",
    "@xmath242}$ ] ) for the set of @xmath22 $ ] negative ( resp .",
    "positive ) half planes . when we refer to a @xmath22 $ ] half plane in a bounded set , we mean @xmath243)$ ] , for some @xmath239 , @xmath244 .",
    "we will also say that the length of this @xmath22 $ ] half plane is @xmath245 .",
    "( _ remember here that the domain of roots are is @xmath246 , not the entire group @xmath14 _ )    * upper root boundary * we define the _ upper boundary of root class @xmath22 $ ] _ , @xmath247}$ ] , as the quotient of @xmath242}$ ] under the equivalence relation of bounded hausdorff distance .",
    "if two positive @xmath22 $ ] half - planes @xmath248 , @xmath249 where @xmath250 , are bounded hausdorff distance apart , then @xmath100 , @xmath101 can only differ by @xmath169}$ ] coordinates .",
    "this means each equivalence class can be identified with @xmath169}$ ] , and the collection of all equivalence classes , @xmath247}$ ] , can be identified with @xmath251 \\not= [ \\alpha ] } v_{[\\beta]}$ ] .",
    "* lower root boundary * we say two @xmath22 $ ] negative half planes @xmath252 , @xmath253 are equivalent if there is a sequence @xmath254}$ ] such that @xmath255 , @xmath256 and any two successive @xmath257 s intersect at an unbounded convex set .",
    "this is an equivalence relation because if @xmath252 is equivalent to @xmath253 , and @xmath253 is equivalent to @xmath258 , then concatenation of the sequences used to connect the two pairs is a sequence that connects @xmath252 and @xmath258 .",
    "we define the _ lower boundary of @xmath22 $ ] _ @xmath259}$ ] as the quotient of @xmath241}$ ] under this equivalence relation .",
    "we see that if @xmath252 , @xmath260}$ ] based at @xmath250 have non - empty intersection , then @xmath100 and @xmath101 can not differ by @xmath169}$ ] coordinate . on the other hand ,",
    "if @xmath100 and @xmath101 differ only in some @xmath261}$ ] coordinate , where @xmath262 \\not= [ \\alpha]$ ] , then @xmath263 , so @xmath252 is equivalent to @xmath253 in this case .",
    "this way , we see that the equivalence class containing @xmath252 , @xmath239 are all those @xmath264}$ ] , where @xmath265 differ from @xmath100 by some elements of @xmath251 \\not=[\\alpha ] } v_{[\\beta]}$ ] , and consequently , @xmath259}$ ] an be identified with @xmath169}$ ] .    * measures on lower root boundaries * if @xmath130 , we write @xmath266}(p ) \\subset \\partial^{-}_{[\\alpha]}$ ] ( resp .",
    "@xmath267}(p ) \\subset \\partial^{+}_{[\\alpha]}$ ] ) for the set of equivalence classes , each containing a minimal negative ( resp .",
    "positive ) @xmath22 $ ] half planes through a point that is at most distance @xmath268 away from @xmath100 , where @xmath268 is the scale of discretization . since @xmath169}$ ] is the direct sums of @xmath269 , where @xmath270 $ ] , we will write @xmath271 , where @xmath272 $ ] , for the @xmath273 coordinate of @xmath266}(p)$ ] . for @xmath274 , we write @xmath275}(a)= \\bigcup_{p \\in a } \\pi^{*}_{[\\alpha]}(p)$ ] , where @xmath276 .",
    "since @xmath259}$ ] is a homogeneous space ( the subgroup @xmath169 } \\subset \\mathbf{h}$ ] acts faithfully and transitively on it ) , it admits a haar measure .",
    "we normalize this measure @xmath277 by requiring that for each @xmath272 $ ] , @xmath278    * upper and lower boundaries of a linear functional * we call the intersection of half planes corresponding to two perpendicular linear functionals , a quarter plane .",
    "we now define an equivalence relation on @xmath279 ( resp .",
    "@xmath280 ) as follows .",
    "two positive ( resp .",
    "negative ) @xmath150 half planes @xmath252 , @xmath253 are equivalent if there is a sequence of @xmath281 such that @xmath255 , @xmath282 and the intersection between any two successive @xmath257 s does not contain a quarter plane .",
    "this is an equivalence relation because if @xmath252 is equivalent to @xmath253 , and @xmath253 is equivalent to @xmath258 , then the concatenation of the sequences used to connect the two pairs is a sequence that establishes equivalence between @xmath252 and @xmath258 .",
    "we see that if the positive ( resp .",
    "negative ) @xmath150 half planes @xmath283 based at @xmath250 are equivalent , then @xmath284 differ by an element of @xmath285 .",
    "@xmath286 )    we define the _ upper boundary of @xmath150 _",
    ", @xmath287 , ( resp . _",
    "lower boundary of @xmath150 _ , @xmath288 ) as the quotient of @xmath279 ( resp .",
    "@xmath280 ) under this equivalence relation . in light of the forgoing discussion",
    ", we see that @xmath287 ( resp .",
    "@xmath288 ) can be identified with @xmath286 .",
    "@xmath285 )    * measure on upper and lower boundaries of a linear functional * let @xmath150 be a generic linear functional .",
    "since @xmath287 can be identified with @xmath286 which itself is a direct sum of @xmath95}$ ] where @xmath289 , and each of @xmath95}$ ] can be identified with @xmath290}$ ] , we can identify @xmath287 with @xmath291 : \\ell(\\vec{v}_{\\xi } ) > 0 } \\partial_{[\\xi]}$ ] , and equip it with the product measures on the constituent root boundaries .",
    "the same procedure can be applied to @xmath288 to turn into a measure space .    if @xmath130 , we write @xmath292 ( resp .",
    "@xmath293 ) for the set of equivalence classes , each containing a smallest negative ( resp .",
    "positive ) @xmath150 half planes through a point that is at most distance @xmath268 away from @xmath100 , where @xmath268 is the scale of discretization . for @xmath274 , and @xmath294 , @xmath295 is the union of @xmath296 , where @xmath100 ranges over all points of @xmath111 .",
    "* branching constant * the branching constant @xmath297}$ ] of root class @xmath22 $ ] is the number such that @xmath298 } l}$ ] represents the number of @xmath22 $ ] half planes of length @xmath299 leaving a point .",
    "it equals @xmath131}/ \\alpha_{0}$ ] .",
    "the branching constant @xmath300 , of a generic linear functional @xmath150 , is a number such that @xmath301 represents the number of @xmath150 half planes of length @xmath299 leaving a point .",
    "its value is given by @xmath302    if @xmath303 is a linear functional whose norm is not 1 ,",
    "we will write @xmath304 for @xmath305 .    * distances on lower root boundaries * given @xmath306 } \\sim v_{[\\alpha]}$ ] , let @xmath307 be the minimal @xmath308 such that there exists negative @xmath22 $ ] half planes in the equivalence class of @xmath100 and @xmath101 that are distance 1 ( or @xmath268 if the scale of discretization is not @xmath29 ) at sets whose @xmath185 projection is @xmath309}^{-1}(t)$ ] .    fix a positive number @xmath110 , we define a _",
    "_ @xmath310}$ ] between @xmath284 as @xmath311}(p , q ) = e^{c t_{p , q}}\\ ] ]    different choice of @xmath110 leads to quasi - symmetric equivalent metric . in this way",
    ", the space @xmath312 } , d_{[\\alpha]})$ ] becomes those whose quasi - conformal maps are studied in @xcite .",
    "* shadows , slabs * using the same root class as before , we define any subset @xmath313 of a left translate of @xmath251 \\not= [ \\alpha]}v_{[\\beta ] } \\rtimes ker(\\alpha_{0})$ ] a _",
    "@xmath22 $ ] block_. note that for any element @xmath272 $ ] , @xmath314 is well - defined . for @xmath315 , we define the _ @xmath268-shadow of @xmath313 _ , @xmath316 , as the union of smallest negative @xmath22 $ ] half planes containing a point in @xmath317 . for @xmath318 , we define a _ slab of @xmath313 _ , denoted by @xmath319 as the intersection between @xmath320 with @xmath321)$ ] .",
    "that is , it s the subset of @xmath320 that whose @xmath136 values lies in between @xmath322 and @xmath323 .    * generalized slabs * for @xmath324}$ ] , @xmath325}$ ] , @xmath326 , @xmath327 , we call a set @xmath328 } , ( \\mathbf{x}_{[\\beta]})_{[\\beta ] \\not= [ \\alpha ] } , \\mathbf{t } \\right ) :   \\mathbf{t } \\in [ h_{2 } , h_{1}]k , \\mbox {    } \\mathbf{x}_{[\\alpha ] } \\in e_{- } , \\mbox {    } ( \\mathbf{x}_{[\\beta]})_{[\\beta ] \\not= [ \\alpha ] } \\in e^{+ } \\}\\ ] ]    a _",
    "generalized @xmath22 $ ] slab_. this generalizes the definition of slabs defined in the previous paragraph .    *",
    "coarsening * we define a process _ coarsening _ as follows . for @xmath329 , @xmath325}$ ] , _ the coarsening of @xmath330 by @xmath331 _ , @xmath332 is defined as the subset of @xmath247}$ ] consisting of those equivalence classes that contains a positive @xmath22 $ ] half plane that has a non - empty intersection with a positive @xmath22 $ ] half plane whose equivalence class belongs to @xmath330 at a set whose @xmath185 projection belongs to @xmath333 $ ] .",
    "similarly , for @xmath324}$ ] a subset of the lower boundary , the coarsening of @xmath334 by @xmath331 , @xmath335 , is defined to be those equivalence classes of negative @xmath22 $ ] half planes that contains an element which intersects non - empty with a negative @xmath22 $ ] half plane whose equivalence class belongs to @xmath334 at a set whose @xmath185 projection is a subset of @xmath336)$ ] .    observe that as long as @xmath337 , @xmath338 , we have @xmath339    [ lemma 3 - 5 ] the number of @xmath22 $ ] planes in @xmath340 is comparable to @xmath341}(h_{1}-h_{2})}\\ ] ] that is , it is compatible to the area of the cross - section times @xmath298}(h_{1}-h_{2})}$ ] .    counting",
    "the number of @xmath22 $ ] half planes really means you count the number of geodesics in @xmath169 } \\rtimes \\mathbb{r}(\\vec{v}_{[\\alpha]})$ ] . in this way",
    ", we see that the first term of the product is the size of a cross section in this projection image , and the product is the no . of geodesics in the range .",
    "recall our setting from theorem [ exisence of standard maps in small boxes ] .",
    "@xmath342    is a quasi - isometry such that on a subset @xmath343 of relative measure at least @xmath226 , the restriction @xmath344 , is within @xmath345 of a standard map @xmath346 .",
    "if @xmath347 , then it is clear that the image of a slab is a slab , and image of a generalized slab is also a generalized slab .",
    "however as @xmath348 is generally not @xmath349 , it is not clear that for a @xmath22 $ ] block @xmath313 , and @xmath350 , there is an obvious relation between @xmath351 and @xmath352 , which is defined as @xmath353}(h ) ) , g(\\pi^{+}_{[\\alpha]}(h ) ) , f(\\pi_{a}(h ) \\times [ h_{2},h_{1}]))$ ] , other than @xmath354    we will show that by restricting to certain subset of @xmath355 whose coarsened version lies almost entirely in @xmath348 , a reversal inclusion can be obtained .    to this end ,",
    "fix a @xmath22 $ ] block @xmath313 in @xmath349 , and let @xmath356 . as @xmath1 preserves foliations by root kernels ,",
    "the @xmath1 image of @xmath357 is the kernel of @xmath358 for some root class @xmath89 $ ] .",
    "we identify @xmath359 with @xmath360 by taking the @xmath136 value of a coset , and do so similarly for @xmath361 .",
    "then @xmath1 induces a map @xmath362 by sending @xmath363 to the @xmath364 value of @xmath365 . when the rank of @xmath14 is 1 , this is just @xmath1 .",
    "now , fix heights @xmath366 , and define @xmath367}(h ) ) , \\mathcal{c}_{q(h_{2 } ) } g(\\pi^{+}_{[\\alpha]}(h ) ) , f(\\pi_{a}(h ) \\times [ h_{2},h_{1}]))\\ ] ]    in the rest of this section , we write @xmath113 for the box @xmath368}a_{[\\sigma ] } \\right ) \\omega$ ] where @xmath369 } \\subset v_{[\\sigma]}$ ] , @xmath370 .",
    "we refer to the parameters @xmath371 in theorem [ exisence of standard maps in small boxes ] as ` initial data ' , and show now that most slabs inherit the property that ` intersection with @xmath348 possess relative large measure ' for the remaining subsections , whenever @xmath372 appears , it means the ratio of the two quantities is more than @xmath373 .",
    "[ lemma 4.1 ] given @xmath374 , there exist constants @xmath375 , @xmath376 depending on our initial data and a subset @xmath377}(b)$ ] of relative large measure such that whenever @xmath313 is a @xmath22 $ ] block which is at least @xmath378 away from @xmath379 and @xmath266}(h ) \\cap e _ { * * } \\not=\\emptyset$ ] , then @xmath380 implies @xmath381    let @xmath382 be a constant to be chosen later .",
    "let @xmath383}(b)$ ] be the subset such that for @xmath384 , there exists a @xmath22 $ ] block @xmath385 such that @xmath386}(h_{x})$ ] and equation ( [ slab in domain ] ) fails .",
    "then we have a cover of @xmath387 by intervals @xmath388 . by vitali covering",
    "there is a subset of @xmath389 s such that @xmath390 , and whose elements are strongly disjoint i.e. for @xmath391 , @xmath392 , which means that the corresponding @xmath22 $ ] block @xmath393 s are also disjoint . by construction @xmath394 .",
    "summing over @xmath395 yields @xmath396}(h_{k})|\\ ] ]    as @xmath397}(h_{k } ) |= | \\pi^{+}_{[\\alpha]}(b ) |=\\prod_{[\\sigma ] \\not=[\\alpha ] } |   a_{[\\sigma ] }   |$ ] , and @xmath398}(b ) | |",
    "\\pi^{+}_{[\\alpha]}(b ) |$ ] , we obtain @xmath399}(b ) \\right|\\ ] ] now choose @xmath382 appropriately .    note that as @xmath400 is only partially defined , the definition of @xmath352 sort of ` fills up ' @xmath401 .",
    "therefore it is not clear that most of @xmath352 lie close to the @xmath402 .",
    "we now introduce some notations needed to describe a subset of @xmath352 which can be controlled more easily .",
    "given a set @xmath403 and @xmath404 } \\subset \\pi^{+}_{[\\xi]}(b)$ ] , we write @xmath404 } \\cap d$ ] for the intersection between @xmath404}$ ] and @xmath405}(d)$ ] .",
    "we then define    @xmath406}(h ) ) ) , \\mathcal{c}_{q(h_{2})}(g(\\pi^{+}_{[\\alpha]}(h ) \\cap d ) ) , f(\\pi_{a}(h ) \\times [ h_{2 } , h_{1 } ] ) ) \\ ] ]    this next lemma says that for certain ` slimmed down ' version of @xmath352 , @xmath407 , most of them lies in @xmath402 .",
    "[ lemma 4.2 ] given @xmath408 , there exist constants @xmath409 depending on our initial data and a subset @xmath410}(b)$ ] of relative large measure with the following properties .",
    "let @xmath411 be a @xmath22 $ ] block in @xmath113 such that    1 .",
    "the distance between @xmath411 and @xmath379 is at least @xmath412 .",
    "2 .   the intersection @xmath266}(h_{0 } ) \\cap e_{*}$ ] is not empty .",
    "suppose @xmath313 is a @xmath22 $ ] block in @xmath413}(h_{0 } ) , \\pi^{+}_{[\\alpha]}(h_{0 } ) , \\pi_{a}(h_{0 } ) , \\ell_{[\\alpha]}(h_{0 } ) , \\ell_{[\\alpha]}(h_{0 } ) + \\beta '' diam(\\mathbf{b}(\\omega)))$ ] such that @xmath266}(h)$ ] has non - empty intersection with @xmath414 .",
    "then , @xmath415 where @xmath416 , and @xmath417 approaches aero as our initial data approach zero s .",
    "the set @xmath414 will be constructed from @xmath418 that appeared in lemma [ lemma 4.1 ] .",
    "we first show that @xmath419 .",
    "recall that @xmath411 is more than @xmath420 away from the boundary of @xmath113 .",
    "this means that @xmath195 is also more than @xmath420 away from @xmath379 . by definition @xmath421}(h ) ) ) , \\mathcal{c}_{q(h_{2 } ) } g(\\pi^{+}_{[\\alpha]}(h ) \\cap s ) , f(\\pi_{a}(h ) \\times [ h_{2}(h ) , h_{1}(h ) ] ) ) \\ ] ]    by assumption , @xmath422 , so @xmath423 .",
    "take @xmath424 .",
    "then @xmath425 is no further than @xmath426 away from a point @xmath101 in the generalized @xmath22 $ ] slab @xmath353}(h ) ) , g(\\pi^{+}_{[\\alpha]}(h ) \\cap s ) , f(\\pi_{a}(h)\\times [ h_{2}(h ) , h_{1}(h ) ] ) ) $ ] .",
    "this means that there is @xmath427 such that @xmath267}(q)=\\pi^{+}_{[\\alpha]}(\\hat{\\phi}(p))$ ] , so @xmath428 .    by definition , @xmath429 lies on a @xmath89 $ ] half plane that is @xmath345 away from the image of a @xmath22 $ ] half - plane containing @xmath100 .",
    "this means @xmath430 , and therefore @xmath431 . since @xmath432",
    ", it follows that @xmath433 .",
    "let @xmath434 be a constant to be chosen later .",
    "let @xmath435}(b ) - e_{1}$ ] be such that for @xmath436 there is a @xmath22 $ ] block @xmath385 such that @xmath386}(h_{x})$ ] and equation ( [ slab in range ] ) fails .",
    "thus we have a cover of @xmath437 by intervals @xmath388 .",
    "by vitali covering , we can find a subset of @xmath389 s such that the the inequality opposite to above holds for each @xmath393 ( instead of @xmath313 ) and @xmath438 , and that @xmath389 s are strongly disjoint from this point on because the @xmath247}(s)$ ] is not a full set : it s the intersection of this with something else , so we need to do something else first . ] .",
    "( that is , for @xmath391 , @xmath439 s are disjoint as well .",
    "we now claim that @xmath440    suppose not , then there is a @xmath441 such that @xmath442 .",
    "the latter means that @xmath266}(\\phi(p ) ) \\in \\mathcal{c}_{q(h_{1}(h ) ) } g(\\pi^{-}_{[\\alpha]}(h_{k}))$ ] , so there is a @xmath443 such that @xmath444}(\\phi(p ) ) , \\pi^{-}_{[\\xi]}(\\hat{\\phi}(p ' ) ) } \\leq q(h_{1}(h_{k } ) ) + o(\\hat{\\eta } diam(\\mathbf{b}(\\omega)))\\ ] ]    however the fact that @xmath445 and @xmath446 means that for @xmath447}(p ) , \\pi^{-}_{[\\alpha]}(p ' ) }    > \\alpha_{0}(h_{k})+ o(1)\\ ] ]    which in turns means that @xmath448}(\\phi(p ) ) , \\pi^{-}_{[\\xi]}(\\hat{\\phi}(p ' ) ) }    > q(\\alpha_{0}(h_{k } ) ) + o(\\hat{\\eta } diam(\\mathbf{b}(\\omega ) ) ) > q(h_{1}(h_{k } ) ) + o(\\hat{\\eta } diam(\\mathbf{b}(\\omega)))\\ ] ] contradicting ( [ close ] ) .",
    "so equation ( [ disjoint ] ) holds .",
    "+ next we show that @xmath449    since @xmath450 has relative small measure in @xmath113 , this means that the measure of left hand side over all @xmath395 s from the strongly disjoint family remains small , making the measure of @xmath451 a lower bound for @xmath452 .",
    "suppose ( [ measure of tilde ] ) is not true .",
    "then there is a @xmath453 , such that @xmath454 and @xmath455 .",
    "however , by equation ( [ disjoint ] ) , the last two conditions means that @xmath456 , which contradicts assumption that @xmath457 .    by choice , @xmath458 s satisfy the inequality opposite to equation ( [ slab in range ] ) , so latexmath:[$|\\tilde{sl}_{2}^{1}(h_{k } ) \\cap \\phi(u_{*}^{c } ) | \\geq c_{4 }    @xmath458 s are disjoint , summing over @xmath395 yields @xmath460}(h_{k})|\\end{aligned}\\ ] ]    the second line comes from lemma [ lemma 4.1 ] and the fact that the volume ratio between @xmath461 neighborhood of @xmath355 and @xmath355 is @xmath462 in the second line , as noted in remark [ general folner ] .    since @xmath267}(h_{k } ) = \\pi^{+}_{[\\alpha]}(b)$ ] , and @xmath463}(b)|    @xmath464}(b)|\\ ] ]    [ cross area preservation ] let @xmath313 be a @xmath22 $ ] block in @xmath349 satisfying the hypothesis of lemma [ lemma 4.1 ] and [ lemma 4.2 ] , and @xmath195 as in lemma [ lemma 4.2 ] .",
    "let @xmath465 be such that @xmath466 .",
    "then    @xmath467}(h)| | \\pi^{+}_{[\\alpha]}(h ) |\\ ] ]    and @xmath468}(h)| | \\pi^{+}_{[\\alpha]}(h ) |\\ ] ]    where @xmath469 and @xmath470 depend only on @xmath471 , @xmath87 .    note that from the structure of @xmath472 and the fact that @xmath20 is a quasi - isometry , it follows that for @xmath473 we have @xmath474    this means that @xmath101 is essentially monotone , so there exists @xmath475 such that @xmath476 , and @xmath477 .",
    "we now apply lemma [ lemma 4.1 ] and [ lemma 4.2 ] to the resulting @xmath355 and @xmath478 .    by equation ( [ slab in range ] ) in lemma",
    "[ lemma 4.2 ] , we know that @xmath479 .",
    "the structure of a standard map means that the ratio of measures of @xmath480 to that of @xmath481 lies in @xmath482 $ ] .",
    "these facts together shows that @xmath483    similarly , @xmath484    the claims now follow from the following volume formula .",
    "@xmath485}(h)| |\\pi^{+}_{[\\alpha]}(h ) | |\\pi_{a}(h)||h_{2}-h_{1}|\\ ] ] @xmath486}(h))| |\\mathcal{c}_{q(h_{2 } ) } g(\\pi^{+}_{[\\alpha]}(h))|      continuing with the same notations from the previous subsection , we show in this subsection , that @xmath487 } ) \\rightarrow \\mathbf{a}/ ker(\\ell_{[\\xi]})$ ] is affine and compute its constant term . to compute the the constant term of this affine map , we make use of corollary [ cross area preservation ] , and the property that the standard map @xmath400 roughly preserves the number of root class half planes .",
    "[ lemma 4 - 6 ] let @xmath313 be a @xmath22 $ ] block in @xmath113 .",
    "let @xmath488 , @xmath489 denote the set of ( maximal ) @xmath22 $ ] , @xmath89 $ ] half planes in @xmath355 and @xmath478 respectively .",
    "then @xmath490    the claim is base on the fact that there is a bijection between @xmath481 and @xmath491 .",
    "explicitly , let @xmath492 be the set of @xmath22 $ ] half planes in @xmath355 that are more than @xmath493 away from @xmath379 , and spend at least @xmath494 fraction of their measure in @xmath348 .",
    "then @xmath492 has a relative large measure in @xmath488 .    for each @xmath495",
    "there is a @xmath89 $ ] half plane @xmath496 such that @xmath497 is within @xmath498 of @xmath499 .",
    "we define @xmath500 .",
    "note @xmath501 is at most @xmath502 to one since two @xmath22 $ ] planes with the same @xmath400 image must be within @xmath498 of each other whenever they are in @xmath348 .",
    "inverse of @xmath501 is defined similarly .",
    "[ lemma 4 - 7 ] for all @xmath503 $ ] , where @xmath504 , and @xmath505 .",
    "@xmath506}}{\\mathbf{b}_{[\\xi ] } } ( z_{1}-z_{2 } ) + o(\\hat{\\eta } diam(b))\\ ] ] where @xmath89=f_{*}[\\alpha]$ ]    it is sufficient to check this for a @xmath22 $ ] block @xmath313 , and @xmath475 satisfying the hypothesis of lemma [ lemma 4.1 ] and [ lemma 4.2 ] .",
    "let @xmath488 , @xmath489 denote the set of @xmath22 $ ] , @xmath89 $ ] half planes in @xmath355 and @xmath478 respectively .",
    "the number of @xmath22 $ ] half planes in @xmath355 is @xmath507}(h)| \\mbox {    } |\\pi^{+}_{[\\alpha]}(h)| \\mbox {     }   e^{\\mathbf{b}_{[\\alpha]}(h_{1}-h_{2})}\\ ] ]    while the number of @xmath89 $ ] half planes is @xmath508}(h))| \\mbox {     }   |\\mathcal{c}_{q(h_{2 } ) } g(\\pi^{+}_{[\\alpha]}(h ) \\cap",
    "s)| \\mbox {     } e^{\\mathbf{b}_{[\\xi]}(q(h_{1})-q(h_{2}))}\\ ] ]    by lemma [ lemma 4 - 6 ] , @xmath508}(h))| \\mbox {     }   |\\mathcal{c}_{q(h_{2 } ) } g(\\pi^{+}_{[\\alpha]}(h ) \\cap",
    "s)| \\mbox {      } e^{\\mathbf{b}_{[\\xi]}(q(h_{1})-q(h_{2 } ) ) } = |\\pi^{-}_{[\\alpha]}(h)| \\mbox {     } |\\pi^{+}_{[\\alpha]}(h)|e^{\\mathbf{b}_{[\\alpha]}(h_{1}-h_{2 } ) }   \\mbox {     } e^ { \\hat{\\eta } diam(b ) } \\ ] ]    after simplifying , @xmath509}}{\\mathbf{b}_{[\\xi]}}(h_{1}-h_{2 } ) + \\frac{1}{\\mathbf{b}_{[\\xi ] } } \\log \\frac{|\\pi^{-}_{[\\alpha]}(h)| |\\pi^{+}_{[\\alpha]}(h)|}{|\\mathcal{c}_{q(h_{1 } ) } g(\\pi^{-}_{[\\alpha]}(h))|    the claim now follows because by corollary [ cross area preservation ] , @xmath510}(h)|   \\mbox {      } |\\pi^{+}_{[\\alpha]}(h)|}{|\\mathcal{c}_{q(h_{1 } ) } g(\\pi^{-}_{[\\alpha]}(h))| \\mbox {      }   |\\mathcal{c}_{q(h_{2 } ) } g(\\pi^{+}_{[\\alpha]}(h ) \\cap s)| } = o(1)\\ ] ]    [ leaving rg invariant ] the @xmath25 part of a standard map is affine .",
    "its natural action sends @xmath132 to @xmath511 , hence can only take on one of finitely many possibilities .",
    "when @xmath14 has exact @xmath512 many root kernels , every point of @xmath53 and @xmath25 is uniquely determined by the intersection of @xmath512 many translates of root kernels , so lemma [ lemma 4 - 7 ] shows that @xmath1 is affine and takes foliations by root kernels of @xmath14 to that of @xmath15 .",
    "let @xmath111 denote for the linear part of @xmath1 , and @xmath513 be the permutation that @xmath1 induces on the root classes .",
    "the existence of a standard map @xmath493 away from a quasi - isometry means that for @xmath514 ranges over a large subset of @xmath515 , @xmath89 $ ] a root class , then @xmath516}(\\vec{u})>0 $ ] if and only if @xmath517)}(a(\\vec{u}))>0 $ ] , and @xmath516}(\\vec{u})=0 $ ] if and only if @xmath517)}(a(\\vec{u}))=0 $ ] .",
    "so @xmath517 ) } \\circ a = c_{[\\xi]}\\mathit{l}_{[\\xi]}$ ] for some @xmath518}>0 $ ] .",
    "since @xmath1 is affine , the push - forward of @xmath141 , @xmath519 , is an element of @xmath520 .",
    "take @xmath150 a regular linear functional of unit norm , and @xmath313 an @xmath22 $ ] block .",
    "then , inside of @xmath355 , the number of maximal sets of the form @xmath521 $ ] , @xmath239 , @xmath522 is    @xmath507}(h)| \\mbox {    }   |\\pi^{+}_{[\\alpha]}(h)|   e^{l \\sum_{[\\xi ] : \\xi(\\vec{v}_{\\ell } ) > 0 } \\mathit{l}_{[\\xi]}(\\vec{v}_{\\ell } ) } \\ ] ]    while the number of @xmath523 half planes in @xmath478 is @xmath508}(h))| \\mbox {     }   |\\mathcal{c}_{q(h_{2 } ) } g(\\pi^{+}_{[\\alpha]}(h ) \\cap",
    "s)| e^{l   \\sum_{[\\xi ] : \\xi(\\vec{v}_{\\ell } ) > 0 } \\mathit{l}_{\\sigma ( [ \\xi ] ) } ( a\\vec{v}_{\\ell } ) } \\ ] ]    simplifying using lemma [ lemma 4 - 6 ] and corollary [ cross area preservation ] yields @xmath524:\\xi(\\vec{v}_{\\ell})>0 } \\mathit{l}_{\\sigma ( [ \\xi ] ) } ( a\\vec{v}_{\\ell } ) = \\sum_{[\\xi]:\\xi(\\vec{v}_{\\ell})>0 } \\mathit{l}_{[\\xi]}(\\vec{v}_{\\ell } ) +   \\hat{\\eta } diam(b)\\ ] ]    since the map from @xmath525 to disjoint union of root classes defined by sending @xmath526 to @xmath527 : \\xi(\\vec{v } ) > 0 \\ } \\sqcup \\{[\\beta ] : \\beta(\\vec{v } ) < 0 \\}$ ] is constant on chambers , and each chamber contains a basis of @xmath53 , we conclude that up to an error of @xmath345 ,    @xmath524 : \\xi(\\vec{v}_{\\ell } ) > 0 } \\mathit{l}_{[\\xi ] } = \\sum_{[\\xi ] : \\xi(\\vec{v}_{\\ell } ) > 0 } \\mathit{l}_{\\sigma([\\xi ] ) } \\circ a= \\sum_{[\\xi ] : \\xi(\\vec{v}_{\\ell } ) > 0 } c_{[\\xi ] } \\mathit{l}_{[\\xi]}\\ ] ]    in other words , we have two equations : @xmath528 : \\alpha(\\vec{v } ) > 0 } ( 1-c_{[\\alpha ] } ) l_{[\\alpha ] } & = & 0 \\\\ \\sum_{[\\beta ] : \\beta(\\vec{v } ) < 0 } ( 1-c_{[\\beta ] } ) l_{[\\beta ] } & = & 0 \\end{aligned}\\ ] ]    therefore @xmath529 } ) \\mathit{l}_{[\\alpha ] } , [ \\alpha ] \\mbox{an equivalence class of roots } \\}$ ] is a finite set of linear functionals whose sum is zero and such that for any codimension 1 hyperplane , the sum of those elements in @xmath530 lying entirely on a half plane is zero .",
    "therefore @xmath530 consist of zero linear functionals , so @xmath531}=1 $ ] for all root equivalence classes @xmath22 $ ] . but",
    "this means @xmath532 ) } \\circ a=\\mathit{l}_{[\\alpha]}$ ] .",
    "so @xmath111 is a linear map that sends @xmath132 to @xmath511 .",
    "[ branching constant the same ] lemma [ leaving rg invariant ] implies that the linear part of @xmath1 , when viewed just as a linear map on @xmath533 , where @xmath28 is the rank of @xmath14 ( which is also the rank of @xmath15 ) is a scalar multiple of an element @xmath534 , where @xmath535 has finite order .",
    "( this is because @xmath1 sends foliations by root kernels of @xmath14 to that of @xmath15 , and elements of @xmath132 ( resp .",
    "@xmath511 ) are orthogonal to root kernels .",
    "the next proposition gives an interpretation to the constant part of @xmath1 .",
    "[ map on heights ] let @xmath536 be as in lemma [ lemma 4.1 ] .",
    "let @xmath537 be a generalized @xmath22 $ ] slab in @xmath113 .",
    "suppose @xmath538 with @xmath539 , and @xmath540 .",
    "then there exists a set @xmath541 as in lemma [ lemma 4.2 ] such that for all @xmath542 $ ] , @xmath543}}{\\mathbf{b}_{f_{*}[\\alpha]}}z - \\frac{1}{\\mathbf{b}_{f_{*}[\\alpha ] } } \\log \\frac{|\\mathcal{c}_{q(z_{bot } ) } g(\\pi^{+}_{[\\alpha]}(h ) \\cap s)| } { |\\pi^{+}_{[\\alpha]}(h)| } + o(\\hat{\\eta } diam(b))\\ ] ]    in all application of proposition [ map on heights ] , we change @xmath101 by @xmath493 in order to have equation ( [ eqn4.5 ] ) hold with no error term .    we know from lemma [ lemma 4 - 7 ] that @xmath544}}{\\mathbf{b}_{f_{*}[\\alpha]}}(z ) + \\left ( q(z_{bot } ) - \\frac{\\mathbf{b}_{[\\alpha]}}{\\mathbf{b}_{f_{*}[\\alpha]}}(z_{bot } ) \\right ) + o(\\hat{\\eta } diam(b))\\ ] ] we now find an alternative expression for the term in the bracket .",
    "let @xmath545 be a @xmath22 $ ] block such that @xmath546 . then , according to equation ( [ measure on boundary ] )    @xmath547}(h)| e^{-\\mathbf{b}_{[\\alpha ] } z_{top } } } { |\\mathcal{c}_{q(h_{1 } ) } g(\\pi^{-}_{[\\alpha]}(h))| e^{-\\mathbf{b}_{f_{*}[\\alpha ] } q(z_{top } ) } } = o(\\hat{\\eta } diam(b))\\ ] ]    simplifying gives    @xmath547}(h)|}{|\\mathcal{c}_{q(h_{1 } ) } g(\\pi^{-}_{[\\alpha]}(h ) ) | } = \\mathbf{b}_{[\\alpha ] } z_{top } -   \\mathbf{b}_{f_{*}[\\alpha ] } q(z_{top } ) +   o(\\hat{\\eta } diam(b))\\ ] ]    together with corollary [ cross area preservation ] and lemma [ lemma 4 - 7 ] produces @xmath548 } } \\log \\frac{|\\mathcal{c}_{q(h_{2})}g(\\pi^{+}_{[\\alpha]}(h ) \\cap s)|}{|\\pi^{+}_{[\\alpha]}(h)| } & = & \\frac{1}{\\mathbf{b}_{f_{*}[\\alpha ] } } \\log \\frac{|\\pi^{-}_{[\\alpha]}(h)|}{|\\mathcal{c}_{q(h_{1 } ) } g(\\pi^{-}_{[\\alpha]}(h ) ) | } \\\\",
    "& = & \\frac{\\mathbf{b}_{[\\alpha]}}{\\mathbf{b}_{f_{*}[\\alpha ] } } z_{top } - q(z_{top } ) + o(\\hat{\\eta } diam(b ) ) \\end{aligned}\\ ] ]    [ general section 3 ] now that we know the @xmath25 part of a standard map is affine , we can repeat this entire section for half planes defined for a regular linear functional @xmath549 using the analogous definitions of upper and lower @xmath150 boundaries given in section [ shadow+slab ] .",
    "again , we refer to theorem [ exisence of standard maps in small boxes ] . by lemma [ leaving rg invariant ] , the linear part of @xmath26 s that appeared in the conclusion of theorem [ exisence of standard maps in small boxes ] sends @xmath132 of @xmath14 , to @xmath511 of @xmath15 . a priori , the linear parts of the @xmath26 s do not have to be the same .",
    "for a generic @xmath14 and @xmath15 , the group of permutations between @xmath132 and @xmath511 coming from linear maps would be trivial in which case the linear par of @xmath26 s are identity .    in this section ,",
    "we show that when rank of @xmath14 is 2 or higher , the linear parts of the @xmath26 s have to be the same . when @xmath14 is rank 1 , there are exactly two root classes and the argument follows exactly the same proof as in @xcite , with the modification of replacing @xmath550 and @xmath551 horocycles by left translates of horocycles corresponding to those two root classes .",
    "we aim to prove the following by the end of this section .    [ aligning horocycle ]",
    "let @xmath552 be non - degenerate , unimodular , split abelian - by - abelian lie groups .",
    "let @xmath18 be a @xmath0 quasi - isometry .",
    "given @xmath553 , there exist numbers @xmath213 such that if @xmath554 is a product of intervals of equal size at least @xmath213 , then there is a subset @xmath555 of relative measure at least @xmath226 such that for any root class horocycle @xmath556 } \\subset g'$ ] , @xmath557 } \\cap \\phi(u ) ) , p ' v_{[\\beta ] } \\cap u)= o(\\hat{\\eta } diam(\\sigma ) ) , \\mbox{for some root horocycle }   p ' \\mbox {   } v_{[\\beta ] } \\subset g\\ ] ] here @xmath558 , and @xmath559 as @xmath216 , @xmath125 , @xmath217 approach zero",
    ".    choose @xmath560 .",
    "by lemma [ forste - boxes are folner ] and remark [ forste - general folner ] in @xcite , @xmath14 is amenable and boxes have small boundary compared to its volume , therefore the same is true of its image under @xmath561 , which means that we can take a sufficiently large box @xmath562 and apply theorem [ exisence of standard maps in small boxes ] to @xmath563 to obtain a tiling of @xmath562 by images of smaller boxes @xmath564 .",
    "@xmath565    where @xmath566 , such that there is a subset @xmath567 of relative measure at least @xmath568 , where @xmath569 as @xmath570 , with the following properties .    for each @xmath224",
    ", there is a subset @xmath571 of relative measure at least @xmath226 , such that @xmath572 is @xmath573 away from a standard map @xmath233 , where @xmath26 is a affine map respecting root kernels , and whose linear part preserves the set @xmath132 .    since each @xmath234 has a relative large measure , @xmath574 relative large measure at least @xmath575 in @xmath563 .",
    "we write @xmath576 where @xmath577 is compact convex , and are all",
    "isomorphic to each other .    for a subset @xmath578",
    ", we write @xmath579 for those @xmath580 such that @xmath581 .",
    "theorem [ aligning horocycle ] finishes the alignment step because of the following consequences .",
    "[ linear part the same ] in the conclusion of theorem [ exisence of standard maps in small boxes ] , the linear part of @xmath26 s , @xmath224 are all the same .",
    "let @xmath582 .",
    "lemma [ aligning horocycle ] implies that for boxes that are within @xmath583 of a left translate of @xmath54 , the @xmath26 s are the same .",
    "suppose for some @xmath584 with @xmath585 , the linear part of of standard maps supported in neighborhoods of @xmath550 and @xmath551 corresponds to distinct permutations @xmath586 , @xmath587 from @xmath132 to @xmath511 .",
    "so there must be a root class @xmath22 $ ] such that @xmath262=\\sigma_{a_{y}}([\\alpha])$ ] is different from @xmath89= \\sigma_{a_{x}}([\\alpha])$ ] .",
    "let @xmath588 be a codimension 1 hyperplane such that @xmath589}$ ] and @xmath590}$ ] lie on either side of it .    without loss of generality",
    ", we can take @xmath591}$ ] , @xmath592}$ ] such that their intersections with @xmath562 have equal measure .",
    "let @xmath593}$ ] be a horocycle such that @xmath593 } \\cap \\mathbf{b}$ ] is @xmath594 hausdorff distance away from @xmath595 } \\cap \\phi^{-1}(\\mathbf{b}))$ ] , and @xmath596}$ ] be the corresponding horocycle for @xmath592}$ ] .",
    "since the distance between @xmath597 and @xmath598 is at least @xmath599 , we also have @xmath600 .",
    "let @xmath488 be the set of geodesic segments in direction @xmath601 ( the unique direction perpendicular to @xmath588 ) with one end point in @xmath593 } \\cap \\mathbf{b}$ ] and another in @xmath596 } \\cap \\mathbf{b}$ ] .",
    "then , elements of @xmath488 have length at most @xmath602 .",
    "an element of @xmath603 on the other hand , is a path with one end point in @xmath591 } \\cap \\phi^{-1}(\\mathbf{b})$ ] and another in @xmath592 } \\cap \\phi^{-1}(\\mathbf{b})$ ] .",
    "since the distance between @xmath597 and @xmath604 is bigger than @xmath599 , we can assume without loss of generality that @xmath605 , for some @xmath606 such that @xmath607 .",
    "as the measure of @xmath591 } \\cap \\mathbf{b}$ ] and @xmath592 } \\cap \\mathbf{b}$ ] are equal , this forces lengths of a large proportion of elements in @xmath603 to be at least @xmath608 , which is a contradiction because the length of an element of @xmath603 is @xmath602 .",
    "[ strengthening part 2 ] given @xmath553 , there exist numbers @xmath213 , @xmath232 such that if @xmath180 is a product of intervals of equal size at least @xmath213 , then there is a subset @xmath609 of relative measure at least @xmath610 , and a standard map @xmath346 where @xmath1 is affine defined on it such that @xmath611    here @xmath612 and @xmath232 approach zero as @xmath613 .    by theorem [ exisence of standard maps in small boxes ] and corollary [ linear part the same ] , there is a tiling of @xmath181 : @xmath220    where each @xmath614 is isometric to @xmath615 with the properties that there is a subset @xmath567 , with relative measure at least @xmath568 such that for @xmath224 , there is a subset @xmath616 , with relative measure at least @xmath226 , and a standard map @xmath233 supported on it such that @xmath617    furthermore , the linear parts of @xmath26 s are all the same .",
    "denote this common linear map by @xmath535 .",
    "we now basically proceed according to the same steps as in the proof to theorem [ exisence of standard maps in small boxes ] in @xcite .",
    "let @xmath618 .",
    "since each @xmath234 has relative measure at least @xmath226 in @xmath619 , therefore the measure of @xmath620 is at least @xmath621 times that of @xmath622 , where @xmath623 as @xmath217 approaches zero .",
    "let @xmath624 .",
    "by chebyshev inequality , the size of @xmath625 is at least @xmath626 that of @xmath627 where @xmath628 as @xmath217 approaches zero .",
    "+ we now show that if @xmath629 , then @xmath630 is close to a geodesic segment .",
    "first we claim that @xmath631 is close to a straight line segment in @xmath25 . by construction , if @xmath632 for some @xmath224 , then @xmath633 is within @xmath232-linear neighborhood of the line segment in direction @xmath634 , and makes an angle at least @xmath635 with root kernels .",
    "since @xmath636 spend all but @xmath637 proportion of its length in @xmath620 , we conclude that @xmath638 is within @xmath639-linear neighborhood of a line segment @xmath640 in direction @xmath641 , and makes an angle at most @xmath635 with root kernels .",
    "let @xmath642 sends each point on @xmath630 to a point on @xmath640 that is closest to its @xmath185 image .",
    "we now show that if for some @xmath643 , the line segment connecting @xmath644 to @xmath645 is orthogonal to @xmath640 , then @xmath646 , where @xmath647 .",
    "suppose not , then we have two points with above property except that the distance between them is bigger than @xmath648",
    ". then either @xmath649 for some @xmath224 , or @xmath650 for distinct @xmath651 .",
    "the first case implies that @xmath652 so this case can not happen .",
    "so @xmath284 must belong to distinct @xmath235 s . in this case , the lower bound on the distance between @xmath653 and @xmath654 and the knowledge that @xmath638 is within @xmath639-linear neighborhood of @xmath640 means that there must be two points @xmath655 for some @xmath656 such that the oriented line segment connecting @xmath657 and @xmath658 makes an angle of at least @xmath659 with @xmath640 , but this is a contradiction to the lemma [ linear part the same ] which says that the linear parts of @xmath26 s are the same .",
    "since @xmath636 spend all but @xmath637 proportion of its length in @xmath620 , by lemma [ forste - how to show weakly monotone ] in @xcite , we conclude that @xmath630 is ( @xmath660 ) weakly monotone , and by proposition [ forste - close to being straight ] of @xcite , @xmath630 is within @xmath661-linear neighborhood of a geodesic segment in direction @xmath641 .",
    "so now the @xmath20 image of each element of @xmath625 is close to a geodesic segment and we can apply lemma [ forste - bare minimum for flats to flats ] in @xcite to obtain a subset @xmath662 of relative large measure such that if @xmath663 , @xmath664 is within @xmath665 hausdorff neighborhood of another flat .",
    "we now apply the same argument as in the proof of theorem [ exisence of standard maps in small boxes ] using quadrilaterals to obtain a standard @xmath666 on @xmath620 , where linear part of @xmath667 is @xmath535 .",
    "we continue with the setting from equation ( [ tileb ] ) and discretize @xmath562 in this section so that it reflects the structures of the standard maps @xmath669 , for @xmath224 .",
    "* the @xmath195 graph * take @xmath670 , a @xmath671 net in @xmath15 ( the range space ) and connect @xmath672 by an edge if their @xmath185 images are within @xmath671 of each other and @xmath673 .",
    "we metrize this graph by letting lengths of edges be the distance between the corresponding points in @xmath15 , so all edges have length @xmath674 .",
    "we refer to the discretization restricted to @xmath562 as the @xmath195 graph .",
    "recall that that each box @xmath564 tiling the set @xmath563 is isometric to @xmath349 , the box associated to some convex compact set @xmath370 .",
    "let @xmath675,@xmath676 , be numbers such that @xmath677 .",
    "fix @xmath678 such that @xmath679 .    *",
    "the set @xmath680 * let @xmath150 be a regular linear functional of @xmath53 with unit norm . for @xmath130 , we write @xmath680 for the left coset @xmath681 . a left coset of @xmath682 is also the pre - image of a point under the projection map @xmath683 .",
    "we say @xmath680 is _ favourable _ if    1 .",
    "@xmath684 where @xmath685 is the relative proportion of @xmath450 in @xmath563 .",
    "for any point @xmath101 that is such that @xmath686 @xmath687    we say @xmath680 is _ very favourable _ if in addition , for every @xmath224 such that @xmath688 , the intersection between @xmath689 and @xmath690 is non - empty , where @xmath690 is the union of @xmath418 in those @xmath564 s , @xmath691 from lemma [ lemma 4.1 ] and remark [ general section 3 ] . here",
    "@xmath231 is an upper bound for @xmath692 in @xmath564 .",
    "since @xmath348 has relative large measure in @xmath563 , it follows that if we fix a chamber @xmath153 , there is a left translate of @xmath155 , @xmath693 , and a function @xmath694 with the following properties :    1 .",
    "the measure of @xmath695 is at least @xmath568 times that of @xmath693 .",
    "2 .   there is a subset @xmath696 of relative measure at least @xmath568 such that for every @xmath697 , and @xmath698 , @xmath680 is very favourable .",
    "where @xmath694 approaches zero as our initial data of @xmath216 , @xmath125 and @xmath217 approach zero .",
    "+ fix such a left coset of @xmath155 and for every @xmath697 , write @xmath699 for @xmath700 and @xmath701 for the subset of @xmath702 whose @xmath150 value is @xmath703 .    *",
    "the sets @xmath704 , good and bad @xmath150 boxes * for each @xmath705 , let @xmath706 consisting of indices such that @xmath707    a box @xmath564 in the domain is called a _",
    "good @xmath150 box _ if @xmath708 , and bad otherwise .",
    "* shadows of @xmath701 and @xmath709 * fix a @xmath697 .",
    "let @xmath710 and @xmath711 .",
    "since @xmath712 is very favourable , lemma [ lemma 4.1 ] says that with those chosen @xmath322 and @xmath323 , for each @xmath708 , @xmath713 for each @xmath714 between @xmath322 and @xmath323 , if we write @xmath715 for the relative proportion of @xmath716 in @xmath717 , the above condition means that    @xmath718 which means that @xmath719 for some @xmath720 $ ] .",
    "the shadow of @xmath701 , denoted by @xmath721 , is now defined as the union of @xmath722 and @xmath723 .",
    "let @xmath724 .",
    "for each @xmath708 , we define @xmath725 as @xmath726 .",
    "the shadow of @xmath709 , denoted by @xmath727 is now defined as the union of @xmath725 s , where @xmath161 ranges over @xmath704 .    * shadow vertices",
    "* we now define a set of _",
    "@xmath150 shadow vertices _ in the discretization of @xmath562 .",
    "by shifting the discretization , we can assume that @xmath727 contains a @xmath671 net of @xmath195-vertices .",
    "every @xmath195-vertex in @xmath728 is a shadow vertex .",
    "furthermore , a @xmath150 shadow vertex is _ good _ if it lies in @xmath402 , belonging to @xmath150 plane containing a point of @xmath402 , and is at least @xmath729 from @xmath730 .",
    "if a shadow vertex is not good , then it is bad .",
    "we enlarge the set of bad shadow vertices by declaring any @xmath195-vertex in the @xmath671 neighborhood of @xmath731 a bad shadow vertex , even if it was a good shadow vertex by our previous definition .",
    "the bad shadow vertices in @xmath732 are not necessarily close to @xmath728 , even if they come from good boxes .",
    "while these bad shadow vertices are not well controlled , they make up a small proportion of all shadow vertices and so do not interfere with the geometric argument in the next section .",
    "see lemma [ bad shadow are small ] below .    for either good or bad boxes ,",
    "the number of @xmath150 shadow vertices coming from @xmath564 is proportional to the size of the set @xmath733 .",
    "the proportionality constant depends only on @xmath471 , @xmath87 , @xmath14 and @xmath15 .",
    "[ bad shadow are small ] for each @xmath697 , there is a constant @xmath734 depending on our initial data @xmath371 such that the proportion of bad shadow vertices is at most @xmath734 which approach zero as our initial data go to zero s .",
    "bad shadow vertices are defined in two stages .",
    "first we have the set @xmath735 of vertices in @xmath727 that are either within @xmath736 of @xmath730 or outside of @xmath737 neighborhood of a point in @xmath402 whose @xmath150 value is @xmath738 smaller than @xmath739 . that this set has small measure in @xmath727 follows from two facts .",
    "first , the subset that are close to @xmath730 has relative small measure by lemma [ boxes are folner ] .",
    "second , if the proportion of @xmath735 in @xmath727 is @xmath231 , then the set of points in @xmath740 contained in a @xmath150 half plane through a point of @xmath735 has measure at most @xmath231 relative to @xmath741 .",
    "however by lemma [ lemma 4.2 ] , the proportion of @xmath740 in @xmath741 is at most @xmath417 .",
    "therefore @xmath742 .",
    "in the second stage , we enlarge the set of bad vertices in @xmath728 by adding the set @xmath743 . that this set has small measure follows from our choice of @xmath738 .",
    "* the @xmath668-graph * we now modify the @xmath195-graph near @xmath744 so that it reflects divergence property dictated by standard maps .    for @xmath745 , @xmath746 and @xmath308 ,",
    "we write @xmath747 for the set @xmath748 , and @xmath749)$ ] for the @xmath750 } \\gamma_{x , y}(t)$ ] , which is a @xmath150 half plane of length @xmath245 .",
    "let @xmath751 be the union of @xmath752)$ ] s that have non - empty intersection with @xmath725 .",
    "we begin by replacing @xmath751 as a subset of the @xmath195 graph by disjoint union of @xmath753 s , then define the @xmath668 graph by declaring a new set of vertices and a new incidence relation on @xmath751 .    for each @xmath754 ,",
    "call the @xmath195 vertices of @xmath755 _ pre - vertices_. recall that for each linear functional @xmath140 , we can evaluate @xmath756 where @xmath130 to be the @xmath140 value of @xmath757 . in the range , we tile left cosets of @xmath758 in @xmath759 by rectangles @xmath760 s of diameter @xmath761 ; in the domain , we tile left cosets of @xmath286 in @xmath762 by rectangles @xmath763 s of diameter @xmath764 .",
    "we identify two vertices @xmath284 if    1 .",
    "@xmath284 are in the same @xmath760 .",
    "2 .   @xmath765 and @xmath766 are in the same @xmath763 which has the property that @xmath767 + where @xmath690 is the union of @xmath418 coming from each @xmath564 , @xmath224 as in lemma [ lemma 4.1 ] .",
    "we also remove any edges in @xmath751 that ends at a bad shadow vertex .",
    "a @xmath668 vertex is called _ regular _ unless it arise from the procedure above , in which case it is called _",
    "irregular_. + in our original @xmath195 graph , every point has the same valence provided the vertex is not close to the boundary . however , upon the changes made for the @xmath668 graph , the homogeneous-ness of valence is not so clear .",
    "this next lemma says that we only change the valence by bounded amount , so that @xmath668 graph is essentially homogeneous away from boundary .",
    "[ uniform valence ] there exist constants @xmath768 , @xmath769 depending only on @xmath471 , @xmath87 such that for any two @xmath668 vertices @xmath770 , the ratio of numbers of @xmath523 half planes through them is bounded between @xmath768 and @xmath769 .",
    "let @xmath771 be an irregular vertex , and let @xmath772 . in the following calculations , we use @xmath773 to mean that up to a multiplicative error of @xmath774 .",
    "first , the number of @xmath523 half planes of length @xmath775 containing @xmath771 and @xmath776 is @xmath777 .",
    "as @xmath771 is an irregular vertex , there exists a @xmath150 block @xmath778 in @xmath564 such that @xmath779 and @xmath780 contains a point of @xmath418 . the number of @xmath781 half planes containing @xmath771 and @xmath725 ( whose @xmath781 and @xmath782 value is @xmath738 ) is @xmath783    * the @xmath313 graph * we now define the @xmath313 graph as a subgraph of the @xmath668 graph .",
    "a good @xmath150 vertex is an irregular @xmath668 vertex @xmath784 such that @xmath785 is within @xmath674 of @xmath786 and the @xmath285 coordinate of @xmath787 is within @xmath674 of the @xmath285 coordinate of @xmath701 .",
    "a bad @xmath150 vertex is a bad @xmath150 shadow vertices , which is always a regular @xmath668 vertices .",
    "a vertex of the @xmath313 graph is either good or bad .",
    "good ( resp .",
    "bad ) @xmath313 vertices is the union over @xmath697 , all the good ( resp .",
    "bad ) @xmath150 vertices .",
    "if a vertex comes from the @xmath20 image of @xmath695 , then it is called a @xmath153 vertex .",
    "an edge of the @xmath313 graph is concatenation of edges in the @xmath668 graph that connects two @xmath313 vertices , or connect a good @xmath313 vertex with @xmath730 .",
    "an @xmath788 edge is one that connects two good @xmath313 vertices or one good @xmath313 vertex with @xmath730 .",
    "the idea behind the proof of theorem [ aligning horocycle ] is the following observation . in @xmath789 ( as in lemma [ qi embedding ] )",
    "suppose two travelers leave a common starting point via segments of diverging vertical geodesics .",
    "if they are to meet up again without having to travel for long , then they can only do so in some neighborhood of the starting point .",
    "* the projection @xmath790 and the function @xmath791 * let @xmath792 be the projection defined by @xmath793_{w^{-}_{\\ell } } , \\ell(\\mathbf{t}))$ ] .",
    "let @xmath313 be a @xmath150 block , and write @xmath794 for the gromov product of @xmath795 and @xmath796 with respect to @xmath797 in the negatively curved space @xmath798 .",
    "recall that for three points @xmath799 in a metric space , the gromov product is defined as @xmath800    in a @xmath216 hyperbolic space @xmath2 , the geodesic joining @xmath551 to @xmath801 , @xmath802 , satisfies @xmath803    for the remaining of this subsection , @xmath313 denotes for a @xmath150 block .",
    "also , until the end of section 4 , @xmath461 is a positive number less than 1 such that @xmath804 , and @xmath805 .",
    "the length of any path considered in this section is less than @xmath806 .    in the next lemma , we list some properties of @xmath807 , where @xmath773 is used to denote two quantities whose ratio depends only on @xmath19 , @xmath150 and the space @xmath14 .",
    "[ lemma 5.15 ]    1 .",
    "suppose @xmath808 , @xmath809 , and @xmath810",
    ". then @xmath811 2 .",
    "suppose @xmath812 , @xmath813 , and each of the pairs @xmath814 , @xmath815 can be connected by a geodesics having at least @xmath125 proportion of the component in direction @xmath142 .",
    "+ if @xmath816 , then @xmath811 3 .   if @xmath817 , then @xmath818 .",
    "[ lemma 5.16 ] suppose @xmath819 can be connected by a path @xmath499 of length less than @xmath820 such that    1 .",
    "@xmath821 2 .",
    "the @xmath150 values of @xmath499 decreases for at least @xmath822 units at both ends , and the @xmath150 values of points on the the remaining subsegment are no more than @xmath823 .",
    "then , @xmath824 .",
    "let @xmath825 and @xmath826 be the closest points to @xmath100 and @xmath101 whose @xmath150 value first dips below @xmath827 . since the length of @xmath499 is less than @xmath820 , so is the length of @xmath828 , which connects @xmath795 and @xmath796 , as well as the subsegment of @xmath828 between @xmath829 and @xmath830 .",
    "this means that if @xmath831 , then any path connecting @xmath829 to @xmath830 whose @xmath150 value stays @xmath822 units below @xmath832 would have length at least @xmath820 , contradicting the assumption about the length of @xmath499 .",
    "[ lemma 5.17 ] let @xmath833 be good @xmath150 vertices , and @xmath126 be an @xmath788 edge connecting them .",
    "let @xmath834 be points that are within the same good box as @xmath835 and @xmath425 respectively .",
    "then the following holds :    1 .   except near the end points ,",
    "@xmath126 never pass through any irregular @xmath150 vertices .",
    "we have @xmath836    starting from @xmath835 , let @xmath837 be the first place where @xmath126 hits @xmath727 . as @xmath126 is a @xmath788 edge , it does nt hit a bad @xmath150 shadow vertex , then there exists a good @xmath150 shadow vertex @xmath838 such that @xmath839 and @xmath840 .",
    "note that @xmath841 and @xmath842 are both @xmath843 away from @xmath844 .",
    "let @xmath845 be the next point after @xmath841 when @xmath846 intersects @xmath847 .",
    "we know there must be such a point because the length of @xmath126 is less than @xmath806 , so whenever it moves transverse to @xmath701 , it must do so in @xmath848 $ ] .    since @xmath126 does not hit a bad shadow vertex , @xmath849 at @xmath850 ,",
    "so @xmath851 is a good shadow vertex .",
    "therefore continuing @xmath126 after @xmath851 hits a vertex in @xmath852 , which is a good @xmath150 vertex , and must be @xmath425 .    by lemma [ lemma 5.15 ]",
    "@xmath853    [ lemma 5.18 ] suppose @xmath833 are good @xmath150 vertices and @xmath854 is a @xmath788 edge connecting them . if for some @xmath855 , we have @xmath856 in the same good box as @xmath835 and @xmath425 satisfying @xmath857    then , there is a a @xmath150 block @xmath858 such that @xmath284 are within @xmath674 of @xmath859 .",
    "let @xmath860 be points on @xmath854 close to where it enters respective good boxes . by lemma [ lemma 5.17 ] , @xmath861 .",
    "since @xmath862 , by remark [ branching constant the same ] , we conclude that the @xmath150 values of @xmath863 and @xmath864 are the same , both are @xmath865 lower than that of @xmath701 . since @xmath866 , @xmath867 and @xmath868 are the same point , which is the same as saying that @xmath863 and @xmath864 are within @xmath674 of a @xmath150 block @xmath858 as claimed .",
    "[ illegal circuit ] let @xmath28 be @xmath869 or @xmath870 .",
    "suppose for @xmath871 , @xmath872 are @xmath668 vertices whose @xmath20 pre - images support standard maps .",
    "let @xmath873 be subsegments of @xmath788 edges in @xmath313 graph , where the indices are counted mod @xmath28 .",
    "let @xmath874 , where @xmath875 is the standard map supported in a neighborhood of @xmath876 .",
    "suppose there is an index @xmath395 such that @xmath877 , and for all @xmath878 , @xmath879 .",
    "then @xmath880 and @xmath881 can not have only @xmath882 in common .",
    "we can assume @xmath883 .",
    "let @xmath858 be the @xmath150 block passing through @xmath884 .",
    "by lemma [ lemma 5.18 ] , we can consider @xmath858 in place of @xmath701 .",
    "namely , we can replace the appearance of @xmath701 in the definition of @xmath150 vertices by @xmath858 .",
    "let @xmath885 and @xmath886 be the first and last time that @xmath873 leaves @xmath727 .    by lemma [ lemma 5.17 ] , for all @xmath887 , @xmath888 , and @xmath889 .",
    "this is a contradiction to lemma [ lemma 5.15 ]      let @xmath890 be a rank 1 space with roots @xmath48 , @xmath891 s , where @xmath892 , and @xmath893 is matrix consisting of blocks of the form @xmath894 , @xmath895 where @xmath896 , @xmath897 are unipotent matrices with polynomial entries . for the following two lemmas , let @xmath898 $ ] denote for the subset @xmath899 $ ] , where @xmath900 , and @xmath901 , and @xmath902 , @xmath903 .",
    "we call the set @xmath904    the _ top and bottom of b[t ] _ , denoted by @xmath905 $ ] .",
    "[ rank1generalbox ] the total number of geodesics in @xmath898 $ ] is @xmath906 , and the number of geodesics in @xmath898 $ ] through each vertex is @xmath907 .    to specify a geodesic in @xmath898",
    "$ ] , we need to specify its coordinates in @xmath48 , @xmath908 root spaces , and for every choice of @xmath48 and @xmath908 coordinate , there is a unique geodesic segment in @xmath898 $ ] going from the top to the bottom .",
    "the number of different coordinates in @xmath48 root spaces is @xmath909 , and those in @xmath910 root spaces is @xmath911 , so the number of geodesics is @xmath912    we know that in @xmath898 $ ] @xmath913    the number of vertices on each geodesic is @xmath914 , and the number of vertices is @xmath915 , and we now see the number of geodesics through each point is indeed as claimed .    [ counting lemma ] hypothesis as in lemma [ rank1generalbox ] .",
    "now further assume that @xmath890 is unimodular , and let the common values of @xmath916 and @xmath917 be @xmath918 .",
    "let @xmath919 $ ] be a subset of vertices .",
    "if @xmath488 is a family of geodesics in @xmath898 $ ] with size @xmath920 , where @xmath921 , then there is a vertex @xmath922 , and two geodesics through @xmath771 in in the same direction that stay together for shorter than @xmath923 units .",
    "suppose the claim is not true .",
    "then for each @xmath2 vertex @xmath771 , every pairs of geodesics through @xmath771 stay together at least @xmath923 units . if @xmath771 is within @xmath923 neighborhood of top and bottom of @xmath898 $ ] , the number of geodesics through @xmath771 with properties is @xmath924 , where @xmath331 is the height function on @xmath925 . on the other hand , if @xmath771 is outside of @xmath923 neighborhood of top and bottom of @xmath898 $ ] , the number of geodesics through @xmath771 with this property is @xmath926    the number of @xmath2 vertices outside of @xmath923 neighborhood of the top and bottom of @xmath898 $ ] is at most @xmath927 , and the number of @xmath2 vertices within @xmath923 neighborhood of top and bottom of @xmath898 $ ] is at most @xmath928 .",
    "so the number of geodesics satisfying this scenario is at most    @xmath929 } \\frac{e^{(2t - h(v))m}}{e^{m\\rho_{2 } } } + \\frac{e^{2mt}}{e^{2m\\rho_{2 } } } 2(t-\\rho_{2 } ) \\prod_{i , j } |\\omega_{i}||u_{j}| \\leq \\frac{e^{2tm}}{e^{m\\rho_{2 } } } ( 2 t ) \\prod_{i , j } |\\omega_{i}| |u_{j}|\\ ] ]    since the size of @xmath488 is larger than this number , it is not possible that every pairs of geodesics in @xmath488 satisfy the scenario described above .",
    "so there must be a @xmath2 vertex @xmath771 , and two geodesics in @xmath488 that stay together for less than @xmath923 units after passing through @xmath771 .    in the remaining of this subsection ,",
    "given a regular vector @xmath514 , we write @xmath930 , @xmath931 , for the subset of @xmath932 that can be reached by two geodesics of length @xmath124 in direction @xmath514 in the rank 1 space @xmath933 containing @xmath100 , and @xmath934 for the subset of the left @xmath935 coset that can be reached from @xmath100 by a geodesic in direction @xmath514 ( or in direction @xmath936 as viewed from @xmath100 ) of length @xmath124 .    for the next two propositions , we make the following assumptions .    1 .",
    "let @xmath771 be a @xmath153 vertex such that @xmath937 locally supports a standard map @xmath938 .",
    "since @xmath939 is affine and permutes root classes of @xmath14 to root classes of @xmath15 , its linear part induces a permutation from the chambers of @xmath14 to chambers of @xmath15 and we write @xmath940 for this permutation .",
    "2 .   suppose for @xmath941 a regular linear functional , and @xmath942 , the vectors @xmath142 and @xmath943 lie in a common chamber @xmath153 of @xmath14 .",
    "[ horocycle extension i ] if @xmath124 is a number such that at least @xmath513 fraction of geodesics leaving @xmath771 in direction @xmath514 are unobstructed by @xmath701 vertices for length at least @xmath944 , where @xmath945 .",
    "suppose @xmath946 for some @xmath947 , then at least @xmath948 fraction of the @xmath668 vertices in @xmath949 are @xmath701 vertices .",
    "let @xmath950 denote the set of geodesics leaving @xmath771 in direction @xmath514 that are unobstructed by @xmath150 vertices of length at least @xmath951 .",
    "let @xmath952 be the subset of @xmath953 passing through an element of @xmath950",
    ". by assumption , we have @xmath954    let @xmath955 be the union of geodesics leaving @xmath952 in direction @xmath936 .",
    "( as viewed from @xmath952 ) .",
    "applying lemma [ counting lemma ] to @xmath955 , where @xmath2 means @xmath150 vertices , we see that either there is a @xmath150 vertex whose @xmath956 value is at most @xmath923 from that of @xmath771 , or that there is a @xmath150 vertex @xmath957 whose @xmath958 value differ from that of @xmath771 by more than @xmath923 , and two geodesics in @xmath959 through @xmath960 that stay together for less than @xmath923 units after passing through @xmath960 .",
    "suppose the latter happens .",
    "let @xmath961 be two upper end points of those two geodesics , and @xmath960 be the first time that @xmath962 diverge from @xmath963 .",
    "see figure  [ fig : horoext1 ] below .",
    "let @xmath801 be the first time that @xmath964 diverge from @xmath965 .",
    "applying lemma [ illegal circuit ] to the loop @xmath966 creates a contradiction .",
    "so there is a @xmath150 vertex whose @xmath956 value is at most @xmath923 from that of @xmath771 .",
    "that is , there is a @xmath150 vertex in the @xmath923 neighborhood of @xmath949 .",
    "let @xmath967 be those vertices that can be reached by two elements of @xmath955 .",
    "since every vertex in @xmath949 can be reached by at most @xmath968 geodesics in @xmath953 , it follows that the relative measure of @xmath969 in @xmath949 is at least @xmath948 .",
    "now suppose @xmath970 , and let @xmath961 be such that @xmath971 are element of @xmath955 that are not obstructed by @xmath150 vertices .",
    "applying lemma [ illegal circuit ] to the loop @xmath972 , and noting that @xmath973 , @xmath974 , it follows that @xmath975 ( otherwise @xmath976 would be the smallest , a contradiction ) , which means that @xmath957 is a @xmath150 vertex .",
    "[ zero - one law ] ( hypothesis as in proposition [ horocycle extension i ] ) let @xmath488 be the union of geodesics in direction @xmath514 leaving a point of @xmath949",
    ". then at least @xmath948 fraction of @xmath488 are unobstructed by @xmath701 vertices for length @xmath951 .",
    "let @xmath977 , @xmath967 and @xmath955 be as in proposition [ horocycle extension i ] .",
    "note that the measure of @xmath969 is at least @xmath948 that of @xmath949 .",
    "let @xmath978 be the set of geodesics leaving @xmath969 in direction @xmath514 .",
    "let @xmath979 be the set of geodesics coming from extending elements of @xmath978 by extending @xmath980 units on the @xmath949 .",
    "let @xmath858 be the @xmath150 block whose @xmath150 value is @xmath980 less than @xmath739 .",
    "we call the resulting vertices @xmath981 vertices if we replace occurrence of @xmath701 in the definition of @xmath150 vertices by @xmath858",
    ".    if all elements of @xmath979 are unobstructed by images of @xmath982 vertices , then almost all elements of @xmath488 are unobstructed by @xmath150 vertices , where ` almost ' here means with relative proportion at least @xmath948 .",
    "let @xmath983 be the set of @xmath982 vertices that are within @xmath980 of @xmath969 .",
    "we have that @xmath984 .",
    "applying lemma [ counting lemma ] allows us to conclude that either there is a @xmath150 vertex whose @xmath958 value is within @xmath923 to @xmath985 , or that there is a @xmath150 vertex @xmath101 whose @xmath958 value differ from that of @xmath986 by more than @xmath923 units , and two elements of @xmath979 that stay together for less than @xmath923 units after passing through @xmath101 .",
    "suppose the latter scenario happens .",
    "then there are @xmath987 and a @xmath982 vertex @xmath101 such that @xmath988 , @xmath989 .",
    "let @xmath990 be the first point where @xmath988 and @xmath991 come together .",
    "then by assumption , the @xmath992 .",
    "let @xmath993 be the first point where geodesics in direction @xmath514 leaving @xmath960 and @xmath771 first meet , and let @xmath994 be similarly defined for @xmath995 and @xmath771 .",
    "let @xmath996 now denotes for the distance to the closest @xmath982 vertex .",
    "then in the loop @xmath997 , ( see figure  [ fig : horoext2 ] ) the @xmath108 value of all points but @xmath990 are at least @xmath980 , while @xmath998 , which is a contradiction by lemma [ illegal circuit ] .",
    "therefore if elements of @xmath979 is to contain a @xmath999 vertex , this vertex is within @xmath923 neighborhood of @xmath986 , which is just saying that no elements of @xmath979 are obstructed by @xmath999 vertices , therefore at least @xmath948 proportion of elements in @xmath488 are unobstructed by @xmath150 vertices by construction .",
    "[ horocycle extenion ii ] let @xmath771 be a @xmath153 vertex and @xmath1000 be a standard map supported in a neighborhood of @xmath937 .",
    "let @xmath1001 .",
    "then at least @xmath948 proportion of vertices in @xmath1002 are @xmath153 vertices , where @xmath1003 is the proportion of geodesics leaving @xmath937 that admits a geodesic approximation of length @xmath1004 .",
    "let @xmath1005 be the difference in @xmath1006 values between @xmath1007 and @xmath771 .",
    "fir a @xmath1008 . for every @xmath697 , and @xmath1009 , we let @xmath1010 denotes the proportion of geodesics leaving @xmath957 that are unobstructed by @xmath701 vertices for length at least @xmath951 .",
    "let @xmath1011    in view of proposition [ horocycle extension i ] and [ zero - one law ] , if @xmath1012 , then @xmath1013 .    then , either for all @xmath1014 , we have @xmath1015 ; or that there is a maximal number @xmath1016 such that @xmath1017 , but @xmath1018 .",
    "we are done if the latter does not happen .",
    "we now proceed to show that this is indeed the case .    in the second scenario , we know that @xmath1019 , and at least @xmath948 proportion of vertices in @xmath1020 and @xmath1021 are @xmath701 vertices .",
    "that is , they are @xmath20 images of @xmath1022 .",
    "* claim : * if @xmath1023 for @xmath1024 , then @xmath1025 .",
    "suppose not .",
    "then we will have subsets , one in @xmath1026 and one in @xmath1027 that are within @xmath1028 hausdorff distance from each other .",
    "this can only happen if the subsets are within @xmath1028 of @xmath1029 .",
    "but this would mean that most of @xmath1030 come from @xmath20 images of @xmath1031 , contradicting the assumption that @xmath1032 is the minimal height @xmath363 where most of the @xmath1033 are obstructed by @xmath1034 vertices .",
    "+ in this way , the image of the map @xmath1035 $ ] defined by sending @xmath1036 is a @xmath1028 discrete set .",
    "let @xmath1037 be the minimal image value whose pre - images has positive measure .",
    "this means that most elements of @xmath1038 and @xmath1039 are @xmath20 images of @xmath1040 , thus the subset of @xmath1041 consisting of elements @xmath1042 such that @xmath1043 is empty .",
    "since for all @xmath1044 , the pre - images of @xmath363 in @xmath1041 has zero measure , this means not only does the pre - images of @xmath1037 has positive measure , it has full measure .",
    "now pick another direction @xmath1045 in the same chamber as @xmath514 , but not in the @xmath1046 neighborhood of the @xmath514 orbit under the finite group of affine maps permuting @xmath1047 to @xmath511 , and repeat the same argument as above to obtain a number @xmath1048 such that most of @xmath1049 come from @xmath20 images of @xmath693 .",
    "pick @xmath1050 and @xmath1051 so that each locally supports a standard map .",
    "take two geodesics leaving @xmath1052 in direction @xmath514 ( as viewed from @xmath771 ) that stay together for @xmath1053 units ( where @xmath1054 ) after they leave @xmath1052 , followed by a short segment @xmath1055 away from @xmath771 , before joining the geodesics connecting @xmath771 to @xmath551 .",
    "let s say they stay together for @xmath1056 units before coming to a stop at @xmath551 .",
    "see figure  [ fig : block1 ]    as most of @xmath1057 and @xmath1058 come from @xmath1059 , for a full measure of @xmath1060 , lemma [ illegal circuit ] requires us to have @xmath1061 , as well as @xmath1062 .",
    "this means that @xmath1063 , where @xmath1064 and @xmath1065 are linear part of standard maps @xmath1066 and @xmath1067 .",
    "that is , @xmath1068 $ ] , and @xmath1069 lies in the @xmath1070 neighborhood of the orbit of @xmath1071 under the finite group of linear maps that permutes @xmath132 to @xmath511 . but this contradicts our choice of @xmath1045 and @xmath1053 .",
    "_ of theorem [ aligning horocycle ] _ as any root class horocycle is the intersection of finitely many left translates of @xmath155 , where @xmath153 is a chamber , it suffices to show that the analogue claim holds for left translates of @xmath1072 of @xmath15 in place of left translates of @xmath169'}$ ] of @xmath15 .",
    "we start with @xmath1073 sufficiently large so that we can apply theorem [ exisence of standard maps in small boxes ] to @xmath1074 and obtaining a tiling as in equation ( [ tileb ] ) .",
    "let @xmath1075 .",
    "since @xmath348 has large measure relative to @xmath1074 , for a fixed chamber @xmath153 , we can find a large subset @xmath1076 with the property that for every point @xmath698 , there is a subset @xmath696 of relative proportion at least @xmath1077 such that @xmath680 is very favourable for every @xmath705 . by constructing the corresponding @xmath668 and",
    "@xmath313 graph , application of theorem [ horocycle extenion ii ] to a point @xmath1078 shows that the @xmath561 image of @xmath1079 is @xmath1080 away from a left translate of @xmath155 , where @xmath1081 is the image of @xmath153 under the linear part of the standard map supported in a neighborhood of @xmath937 .",
    "in the previous section , we aligned the linear part of standard maps appeared in theorem [ exisence of standard maps in small boxes ] by showing that they are all the same . in this last section ,",
    "we remove the condition that standard maps are only defined for a subset of relative large measure and align the translational part of the standard maps by adopting the procedure used to achieve this in @xcite .",
    "we have by now seen that given a box , there is a subset of large measure supporting a standard map . in this subsection , by controlling the sizes of increasingly larger and larger boxes , we get rid of the subset of large relative measure and extend the result to all pairs of points @xmath819 on the same flat .",
    "the precise statement is the following :    [ weak height preservation ] let @xmath552 be non - degenerate , unimodular , split abelian - by - abelian lie groups and @xmath1082 be a @xmath0 quasi - isometry between them .",
    "given @xmath1083 , then there exists @xmath1084 , @xmath1085 depending on @xmath216 , @xmath125 , @xmath217 and qi constants of @xmath20 such that whenever @xmath1086 belong to the same left coset of @xmath54 , @xmath1087    where @xmath1088 , @xmath1089 as the input parameters approach zeros .",
    "the setup to the proof of theorem [ weak height preservation ] follows the same sequence of steps as the analogue result in section 6.1 of @xcite .",
    "fix @xmath1090 .",
    "let @xmath180 be a product of intervals of size @xmath213 with barycenter located at the origin of @xmath53 . by corollary",
    "[ strengthening part 2 ] , there is a subset @xmath1091 of relative large measure which is the support of a standard map @xmath1092 where @xmath1 is affine .",
    "let @xmath1093 satisfies @xmath1094 , and set @xmath1095 .",
    "let @xmath1096 be a left translate of @xmath54 , and we can assume @xmath1096 contains the identity element .",
    "let @xmath1097 , and @xmath1098 .",
    "the following is a rehash of corollary [ strengthening part 2 ] .",
    "[ implication of refinement ] there is a standard map @xmath103 where @xmath1 is affine with linear part @xmath535 , defined on @xmath1099 , with @xmath1100 , such that @xmath1101 .",
    "furthermore , if @xmath1102 , there is a subset @xmath1103 of relative large measure such that the @xmath20 image of every element @xmath1104 is within @xmath232-linear neighborhood of a geodesic segment in direction that of @xmath1105 , whose direction makes an angle of at most @xmath635 with root kernels .    * the tiling . *",
    "choose @xmath1106 . for each @xmath1107 ,",
    "set @xmath1108 .",
    "we tile @xmath1096 by @xmath1109 , where each tile is denoted by @xmath1110 , @xmath1111 .",
    "for @xmath130 , we write @xmath1112 $ ] for the tile in the @xmath714-th tiling containing the point in @xmath1096 that lies on the same flat as @xmath550",
    ".    * warning . * despite the fact that @xmath1113 , the number @xmath1114 s needed to cover a rectangle @xmath1115 $ ] is very large , on the order of @xmath1116 .",
    "* the sets @xmath1117 * for each tile @xmath1114 in the @xmath714-th tiling of @xmath1096 , corollary [ implication of refinement ] produces a subset @xmath1118 of relative large measure .",
    "we set @xmath1119    in view of corollary [ implication of refinement ] , for any @xmath1120 , @xmath1121 \\cap u_{j } } \\left| \\pi_{a}(\\phi(x))-\\pi_{a}(\\phi(y ) )   \\right| \\leq \\hat{\\eta } diam(\\mathbf{b}(\\omega_{j}))\\ ] ]    recall that @xmath1122 is the set of roots in @xmath15 , and we write @xmath28 for the rank of @xmath14 ( which is also the rank of @xmath15 ) .",
    "we also have the following generalization :    [ two small in a big ] for any @xmath1120 , and @xmath1123 \\cap u_{j}$ ] , @xmath1124    wlog , we can assume that there is a horocycle @xmath1125}$ ] , @xmath22 $ ] an equivalence class of roots , that intersect both @xmath1126 \\cap u_{j}$ ] and @xmath1127 \\cap u_{j}$ ] .",
    "( if not , then we can find a sequence of points @xmath1128 where @xmath1129 such that for each pair of consecutive points , there is a horocycle intersecting @xmath1130 \\cap u_{j}$ ] and @xmath1131 \\cap u_{j}$ ] ) .",
    "let @xmath1132 } \\cap \\mathbf{r}[x ] \\cap u_{j}$ ] , @xmath1133 } \\cap \\mathbf{r}[y ] \\cap u_{j}$ ] be points of intersection .",
    "therefore by equation ( [ in the same box ] ) , @xmath1134    since @xmath1135 , for @xmath1136 we can find geodesic segments @xmath1137 , @xmath1138 leaving @xmath1139 respectively such that @xmath1140 is a @xmath1141-quadrilateral . additionally , because @xmath1142}$ ] , we can assume for @xmath1136 , @xmath1143 , the subsegment @xmath1144 containing @xmath1145 and satisfies @xmath1146 admit geodesic approximation to its @xmath20 image .",
    "that is , @xmath1147 is within @xmath1148 hausdorff neighborhood of another geodesic segment .",
    "let @xmath1149 be a geodesic approximation to @xmath1147 .",
    "then angle between the direction of @xmath1149 and that of @xmath1150 is at most @xmath1151 .",
    "therefore by modifying each @xmath1149 by an amount at most @xmath1152 , we can assume @xmath1149 all have parallel directions . since @xmath1153 ,",
    "the four geodesic segment @xmath1149 do constitute a quadrilateral @xmath612 and lemma [ forste - structure of a quadrilateral ] of @xcite applied to @xmath612 yields @xmath1154    where @xmath526 is parallel to edge directions of @xmath612 .",
    "therefore @xmath1155    since @xmath1156 .",
    "the claim now follows by constructing quadrilaterals whose image is approximated by quadrilaterals whose edge direction ranges over at least @xmath28 many linearly independent directions .",
    "[ one big one small ] suppose @xmath1157 \\cap u_{j}$ ] , @xmath1158 \\cap u_{j+1}$ ]",
    ". then , @xmath1159    note that the projection of both @xmath1160 \\cap u_{j}$ ] and @xmath1160 \\cap u_{j+1}$ ] to @xmath1161 $ ] have relative measure up at least @xmath1162 .",
    "therefore we can find @xmath1163 \\cap u_{j}$ ] , @xmath1164 \\cap u_{j+1}$ ] , and @xmath1165 . now by lemma [ two small in a big ] , @xmath1166    and by equation ( [ in the same box ] ) @xmath1167    the claim now follows by triangle inequality .",
    "_ to theorem [ weak height preservation ] _ we have @xmath1168 \\subset r_{1}[x ] \\subset r_{2}[x ] \\cdots\\ ] ]    and    @xmath1169 \\subset r_{1}[y ] \\subset r_{2}[x ] \\cdots\\ ] ]    there exists @xmath1170 with diam@xmath1171 is comparable to @xmath1172 ( after possibly shifting the @xmath1170 s grid by a bit ) such that @xmath1173=r_{n}[y]$ ] . now for @xmath1174 , pick @xmath1175 \\cap u_{j}$ ] , @xmath1176 \\cap u_{j}$ ] .",
    "we may assume that @xmath1177 .",
    "by lemma [ one big one small ] : @xmath1178    where last inequality comes from @xmath1179",
    ". now since @xmath1180 $ ] @xmath1181 , and similarly @xmath1182 .",
    "the claim now follows by noting that we chose @xmath1183 $ ] and @xmath1184",
    "theorem [ weak height preservation ] is the first statement we have that places no additional constraints on the points other than their natural relation in @xmath14 . in this subsection",
    "we show that as a first consequence , the image of a flat is within @xmath1185 of another flat , which eventually culminating in the proof of theorem [ behaviors of phi ] in the next subsection .",
    "let @xmath562 be a box such that @xmath1191 $ ] . by corollary",
    "[ strengthening part 2 ] , there is a subset @xmath1192 of relative measure at least @xmath1193 that supports a standard map which is @xmath1194 away from @xmath1195 .",
    "write @xmath1196 for the linear part of the @xmath25 part of the standard map . without loss of generality",
    "we can assume that @xmath1197 , and @xmath1198 .",
    "let @xmath1199 , and @xmath1200 . then by theorem [ weak height preservation ] @xmath1201                  to which the result follows",
    "alternatively , this can be obtained from theorem [ weak height preservation ] applied to the inverse map @xmath561 and @xmath653 , @xmath654 , for then equation ( [ weak height eq ] ) becomes @xmath1217    a subset @xmath299 of @xmath1218 is called a grid if it is the image of an injective homomorphism @xmath1219 .",
    "a line in @xmath299 refers to a subset of the form : @xmath1220 for some @xmath1221 , and each coordinate of @xmath1222 is either @xmath1223 or @xmath1141 .",
    "a grid is said to be good if none of its lines are parallel to root kernels .",
    "write @xmath1231 .",
    "let @xmath1232 , and @xmath1233 be two subsequences such that their @xmath185 images are two parallel lines , and let @xmath1234 , @xmath1235 be two geodesics within @xmath1185 of @xmath1232 and @xmath1236 respectively .",
    "we note to every @xmath1237 , there is a @xmath1238 such that @xmath1239 is closest to @xmath1240 amongst @xmath1241 , and furthermore , there is a line in @xmath299 containing @xmath1240 and @xmath1239 , and by assumption , this means that there is a geodesic @xmath1242 ( whose direction is the same for all @xmath714 ) within @xmath1185 of @xmath1237 and @xmath1238 .",
    "now if @xmath1234 and @xmath1235 are not in the same flat , then for any root @xmath140 , @xmath1243 and @xmath1244 fork out with respect to the orientation we previously fixed on @xmath1234 and @xmath1235 .",
    "when @xmath1237 , @xmath1238 are far away from the fork point , this causes a contradiction because the existence of @xmath640 mean that @xmath1245 and @xmath1246 can be connected by a vertical geodesic in @xmath269 , but they lie far away from the forking point of two geodesics .",
    "therefore if @xmath1247 is a subsequence for which their @xmath185 image is a affine 2-subspace , then @xmath1247 lie within @xmath1185 of an affine 2-subspace in a flat .",
    "now suppose whenever @xmath1247 is a subset whose @xmath185 image is an affine @xmath1248-subspace , @xmath1247 is within @xmath1185 of a flat .",
    "let @xmath1232 , @xmath1249 be two subsets such that @xmath1250 , @xmath1241 are two parallel @xmath1248-hyperplane , and @xmath1251 , @xmath1252 be two affine @xmath1248 subspace within @xmath1185 of @xmath1232 and @xmath1249 respectively .",
    "then we know for every @xmath1237 , there is a @xmath1238 such that there is a line in @xmath299 containing @xmath1240 and @xmath1239 , so by assumption , @xmath1237 , @xmath1238 are within @xmath1185 of a ( straight ) geodesic @xmath1242 .",
    "furthermore we can assume wlog that the direction of @xmath1242 are the same for all @xmath714 .",
    "therefore if @xmath1251 and @xmath1252 lie on two different flats , then for some root @xmath140 , @xmath1253 and @xmath1254 are two vertical geodesic that fork apart . therefore for @xmath1237 , @xmath1238 such that @xmath1245 , @xmath1246 lying very far from the fork point where @xmath1253 and @xmath1254 diverge from each other , this is a contradiction to the existence of @xmath1242 within @xmath1185 of @xmath1237 and @xmath1238 , for the latter would imply that @xmath1245 and @xmath1246 are within @xmath1185 of a vertical geodesic in @xmath269 .    _ to proposition [ ftf ] _ fix a flat @xmath1255 .",
    "the composition @xmath1256 is homotopic to the identity map when we consider @xmath488 as @xmath53 , so @xmath1257 preserves homologies . by equation ( [ weak affine eq ] ) , it takes balls to neighborhood of balls , so it preserves homologies relative to the complement of a ball , therefore @xmath1258 is onto .",
    "let @xmath299 be a good grid in @xmath25 under a group isomorphism @xmath501 .",
    "we can further make sure that for each basis @xmath1259 , @xmath1260 , where @xmath1211 is as in corollary [ the same pia ] .",
    "the same corollary also implies that for every point @xmath1261 , the subset @xmath1262 of @xmath15 is contained in a ball of radius at most @xmath1211 .",
    "therefore for distinct points @xmath1263 , @xmath1264 .",
    "let @xmath1265 be a subset such that @xmath1266 for some @xmath1261 .",
    "we choose @xmath1267 s so that if @xmath1268 , @xmath1266 , @xmath1269 for @xmath1270 . now let @xmath1247 be a subsequence whose @xmath185 images is a line in @xmath299 , and @xmath1271 be their @xmath20-preimages in @xmath488 .",
    "then by equation ( [ weak affine eq ] ) , @xmath1272 , for all @xmath714 , for some constant @xmath1273 depending on @xmath299 .",
    "this means that that @xmath1274 for all @xmath714 .",
    "apply ( i ) of lemma [ forste - lemma a1 - 2 ] to @xmath1247 shows that the sequence is within @xmath1275 of a ( bi - infinite ) geodesic .",
    "the claim now follows by applying lemma [ preleude to ftf ] to @xmath1276 .",
    "the primarily reason for introducing root boundaries @xmath1277}$ ] for each root class @xmath22 $ ] and the ( psudo ) distance function is that a quasi - isometry of @xmath14 induces quasi - similarities among @xmath1278 } , d_{[\\alpha]})$ ] s .          1",
    ".   @xmath501 sends foliations by root kernels of @xmath14 to the foliations by root kernels of @xmath15 .",
    "the number of root classes of @xmath14 and @xmath15 are the same .",
    "3 .   @xmath501 sends foliations by root class horocycles of @xmath14 to foliations by root class horocycles of @xmath15 .",
    "@xmath501 is within @xmath1185 of a product map @xmath103 , where @xmath1285 is affine whose linear part is some scalar multiple of a finite order element of @xmath27 ; while @xmath1286 , each @xmath1287 is a bilipschitz map from @xmath169}$ ] to @xmath1288}$ ] , where @xmath1289 is the bijection from root classes of @xmath14 to root classes of @xmath15 as induced by the linear part of @xmath1 .",
    "5 .   for each root class @xmath89 $ ] , if we list the roots @xmath1290 , then @xmath1 induces a map on the roots such that @xmath1291 , where @xmath1292 $ ] . furthermore , with respect to this order of roots , @xmath1293 } : v_{[\\xi ] } \\rightarrow v_{f_{*}[\\xi]}$ ] has the form + @xmath1294 + such that for each @xmath161 , any @xmath1295 for @xmath1296 , the map @xmath1297 is a @xmath1298 quasi - similarity , where @xmath1299 is the constant part of @xmath1 , and @xmath110 is a constant depending on @xmath501 .",
    "@xmath501 induces an quasi - similarity between root boundaries of @xmath14 to root boundaries of @xmath15 .    since",
    "two flats are within a finite hausdorff distance of each other if and only if they are the same flat , our assumption means that a flat @xmath1300 within @xmath1185 hausdorff neighborhood of @xmath1301 for @xmath488 a flat , is unique .",
    "the boundary of the set where two flats come together viewed as a subset of @xmath53 is a finite union of hyperplanes parallel root kernels .",
    "if for two flats @xmath488 , @xmath492 , @xmath1305 is a union of hyperplanes parallel to at least two roots kernels , then there are flats @xmath1306 such that @xmath1307 .",
    "fix a flat @xmath488 .",
    "since every hyperplane in @xmath488 parallel to a root kernel is the boundary of @xmath1310 for some other flat @xmath492 , it follows that if @xmath1311 are two hyperplanes parallel to a common root kernel , then there exists hyperplanes @xmath1312 parallel to a common root kernel such that @xmath1313 for @xmath1314 . in other words",
    ", @xmath1315 sends hyperplanes parallel to the kernel of a root , to hyperplanes parallel to the kernel of some other root .",
    "as @xmath501 is coarsely onto , it follows that the number of root kernels of @xmath14 and @xmath15 are the same .",
    "since @xmath14 is unimodular , the sum of all its roots is zero .",
    "but with only @xmath512 many root kernels , this means that there is a basis @xmath1316 of @xmath57 such that every root of @xmath14 is of the form @xmath1317 where @xmath1318 . by abuse of notation",
    ", we will write @xmath1319 to be the direct sum of root spaces where the root is positive multiples of @xmath48 , even though @xmath48 itself might not be a root , and similarly , @xmath1320 denote for direct sum of root spaces where the root is negative multiples of @xmath48 .",
    "let @xmath1321 be the analogous linear functionals for @xmath15 .",
    "in this way , @xmath1322 , and similarly @xmath1323 .",
    "first we show that left translates of @xmath54 are taken to @xmath1185 hausdorff neighborhood of left translates of @xmath1324 .",
    "take @xmath1325 , @xmath1326 .",
    "we construct a quadrilateral @xmath88 ( see definition [ forste - quadrilateral ] in @xcite ) with @xmath284 as two of its vertices using left translates of @xmath1327 . since flats are taken to @xmath1185 neighborhoods of flats , @xmath1328 is within @xmath1185 neighborhood of a quadrilateral @xmath1329 whose edges are left translates of @xmath1330 for some @xmath1331 , and therefore @xmath1332 , @xmath1333 are within @xmath1185 neighborhood of a left translate of @xmath1334 , @xmath1335 .    more generally , for any two points @xmath1336 , we can find a sequence of points @xmath1337 , such that @xmath1338 , @xmath1339 , and for all @xmath161 , @xmath872 , @xmath1340 differ only in a @xmath1341 , @xmath1342 coordinate .",
    "the previous argument then implies @xmath1343 and @xmath1344 are within @xmath1185 of a left translate of @xmath1324 , because the same is true of @xmath1345 and @xmath1346 for all @xmath161 .",
    "next we show that the restriction of @xmath501 to different flats agree .",
    "if @xmath1347 are points such that for each @xmath48 , these two points differ in only one of @xmath1319 , @xmath1320 coordinate ( but not both ) , then the intersection of flats based on them , @xmath1348 , @xmath1349 , intersect at an unbounded set whose boundary is a union of hyperplane parallel to kernels of @xmath48 s that appear in the coordinate difference between @xmath100 and @xmath101 .",
    "furthermore , we can find a third point @xmath1350 that differ in one of @xmath1319 , @xmath1320 coordinate with each of @xmath100 and @xmath101 so that @xmath1351 , and @xmath1352 . in this way",
    ", we see that @xmath1353 is the same as @xmath1354 .",
    "more generally , for any two points @xmath1336 , we can find a finite number of points @xmath1337 such that @xmath1338 , @xmath1355 , such that for all @xmath161 , @xmath872 differ from @xmath1340 in one of @xmath1356 , @xmath1357 coordinate ( but not both ) .",
    "the previous argument then implies @xmath1358 is the same as @xmath1358 ( as @xmath1359 is the same as @xmath1360 ) .",
    "denote the common value of the restriction of @xmath501 to any flat as @xmath1 .",
    "then we know that @xmath1 induces a bijection between @xmath1316 and @xmath1361 which are numbered such that for all @xmath161 , @xmath501 sends left translates of kernel of @xmath48 to left translates of kernel of @xmath910 . as left translate of @xmath1362 ( resp .",
    "@xmath1363 ) can be identified with a rank 1 space @xmath1364 ( resp .",
    "@xmath1365 ) , @xmath501 induces a quasi - isometry from @xmath1366 to @xmath1367 that sends left translates of @xmath54 to @xmath1185 neighborhood of left translates of @xmath1367 . by proposition 5.8 of @xcite , we conclude that the @xmath1-induced map from @xmath1368 to @xmath1369 is bounded distance from an affine map .",
    "* case ii - @xmath14 has at least rank(g)+1 many root kernels .",
    "* in this case , the restriction to a flat , @xmath1370 preserves at least @xmath1371 many parallel families of hyperplanes , thus forcing @xmath1370 to be affine ( when @xmath488 and @xmath1300 are viewed as @xmath53 and @xmath25 respectively . ) that respects root kernels .",
    "so by identifying @xmath488 and @xmath1300 with @xmath533 , @xmath1370 can be written as @xmath1372 , where @xmath1373 is a linear map preserving root kernels . this implies ( i ) , that images of ( straight ) geodesics are within @xmath1185 hausdorff neighborhood of straight geodesics . at this stage ,",
    "both the affine map @xmath1374 and the translation @xmath1375 depend on the flat @xmath488 .",
    "fix a root equivalence class @xmath89 $ ] .",
    "let @xmath1376 be a direction such that @xmath1377 for all roots @xmath1378 .",
    "then for any two points @xmath1379 in the same left coset of @xmath95}$ ] , there is a quadrilateral @xmath88 with @xmath1214 as two of its vertices , and whose edges are all in direction @xmath526 .",
    "wlog we can assume @xmath1380 , so @xmath1214 are in the same left coset of @xmath1381 .",
    "since @xmath501 takes geodesics to @xmath1185 neighborhood of geodesics , it follows that @xmath1328 is within @xmath1185 of another ( 0 ) quadrilateral .",
    "write @xmath1382 , @xmath1383 for the flats based at @xmath550 and @xmath551 respectively .",
    "then @xmath1328 close to a quadrilateral means that @xmath1384 , and the dot product between @xmath526 and @xmath1385 , as well as @xmath1386 are the same .",
    "more over , writing @xmath1387 , by lemma [ forste - quadrilateral word in rank 1 ] in @xcite , @xmath1343 , @xmath1344 are within @xmath1185 of a left coset of @xmath935 .",
    "we can find at least @xmath28 @xmath1388 s , such that @xmath1389}$ ] and none of them lies in a root kernel . repeat the same argument as before yields that @xmath1390 , @xmath1391 .",
    "that is , the restriction of @xmath501 to the flats based at @xmath1214 are within @xmath1185 of each other .",
    "wlog , we can assume that we have so many @xmath1388 s , such that @xmath1392}$ ] for some root equivalence class @xmath262 $ ] , which shows that @xmath1343 , @xmath1344 are within @xmath1185 of a left translate of @xmath261}$ ] for some root class @xmath262 $ ] .",
    "since any two points on the same left translate of @xmath1393 ( or @xmath54 ) can be connected by finitely many points , for which successive pairs of points lie on a left translate of @xmath169}$ ] for some root class @xmath22 $ ] , it follows that @xmath501 sends a left translate of @xmath54 to within @xmath1185 neighborhood of another left translate of @xmath54 .",
    "since the @xmath501 restricted to flats based at two points that lie on a common horocycle agree , we also have now that the restriction of @xmath501 to any two flats agree .",
    "that is , the restriction of @xmath501 to any flat does not depend on the base point of the flat .",
    "+ so now we know that regardless of the number of root kernels , @xmath501 splits into @xmath103 , where @xmath1285 affine and respects root kernels , while @xmath1394 takes root class horocycles to root class horocycles .",
    "furthermore , the permutation on root classes induced by @xmath1 and @xmath1395 agree .",
    "since we know now the @xmath501 restricted to any flat is the map @xmath1396 .",
    "this means that ( straight ) geodesics are taken to straight geodesics , and we can compare the rate of divergence between two geodesics in the same direction but at based at different points of @xmath54 .    specifically , take @xmath140 a root , and let @xmath284 be two points on a common @xmath140 horocycle . pick some @xmath1397 , and let @xmath1398 , @xmath1399 be two geodesic rays in direction @xmath526 leaving @xmath1214 respectively .",
    "then @xmath1400 , @xmath1401 are within @xmath1185 of @xmath1402 and @xmath1403 respectively , where @xmath1404 are within @xmath1185 of a left translate of @xmath261}$ ] .",
    "the rate of divergence between @xmath1405 and @xmath1406 is @xmath1407 ; the divergence rate between @xmath1408 and @xmath1409 is @xmath1410 for some @xmath1411 $ ] .",
    "since the two rates are qi to each other , there must be some @xmath1412 $ ] such that @xmath1413 .",
    "but @xmath526 is arbitrary , so @xmath1414 , @xmath1415 are in the same left translate of @xmath1416 : \\xi < \\tilde{\\beta } } v_{\\xi}$ ] .",
    "this means that @xmath1 induces a bijection @xmath1417 between roots of @xmath14 and @xmath15 . so that for each root @xmath1378 , @xmath501 sends left translates of @xmath1418 : \\xi \\leq \\alpha } v_{\\xi}$ ] , to @xmath1185 hausdorff neighborhoods of left translates of direct sum of root spaces where the roots are in the same root class as @xmath1419 but less than @xmath1419 .    for @xmath1420 , write @xmath1421 for the @xmath1422 , and for each @xmath1423 , write @xmath1424 for the @xmath1425 component of @xmath1426 and @xmath1427 , so that @xmath1428 , @xmath1429 . pick a @xmath61 , then the distance between @xmath1430 and @xmath1431 with respect to path metric in @xmath1432 is @xmath1433 .",
    "the @xmath501 images of @xmath1430 , @xmath1431 is @xmath110 away from @xmath1434 and @xmath1435 , so we have the following inequality :      since @xmath1437 , dividing by @xmath1438 on both sides and let @xmath1439 , and noting that for any polynomial @xmath88 , @xmath1440 is bounded above by a number independent of @xmath1441 , so we end up with        to summarize , @xmath501 is @xmath1185 from a map of the form @xmath1446 , where @xmath1447 , @xmath1448 is a finite order element in @xmath27 that preserves foliations by root kernels , while @xmath1394 sends root horocycles to root horocycles and furthermore respects the graded foliations in each root horocycle .",
    "let @xmath513 be the permutation on root classes induced by @xmath1085 .",
    "then as @xmath501 sends negative @xmath22 $ ] half planes to bounded neighborhood of negative @xmath1449)$ ] half planes , @xmath501 induces a map from @xmath259}$ ] to @xmath1450)}$ ] for every root class @xmath22 $ ] of @xmath14 .",
    "furthermore , the map @xmath1451 is bounded distance from an affine with linear term as @xmath918 and constant term as @xmath1452 , we now show the induced map on lower root boundaries is a quasi - similarity .",
    "@xmath1454)}(g(p),g(q ) ) = e^{\\hat{q}(t_{p , q})}\\ ] ] therefore @xmath1455}(p , q ) \\right ) & \\leq & d_{\\sigma([\\alpha])}(g(p ) , g(q ) ) \\leq   e^{c } \\left(e^{\\sigma(\\alpha)_{0}(\\mathbf{t}_{0 } ) } d_{[\\alpha]}(p , q ) \\right)\\end{aligned}\\ ] ]    [ behaviors of phi ] let @xmath14 , @xmath15 be a non - degenerate , unimodular , split abelian - by - abelian solvable lie group , and @xmath18 a @xmath0 quasi - isometry .",
    "then @xmath20 is bounded distance from a composition of a left translation followed by a map of the form @xmath1456 , where @xmath1 is affine whose linear part is a positive of a finite order element @xmath1457 ( n is the rank of @xmath14 ) that preserves foliations by root kernels , while @xmath1458 , @xmath1287 is a bilip map from @xmath1459}$ ] to @xmath1459}$ ] with bilip constants depending only on @xmath1460 .",
    "[ diagornot ] let @xmath1461 be a a non - degenerate , unimodular , split abelian - by - abelian group such that @xmath1462 is diagonalizable , while @xmath1463 is another non - degenerate , unimodular , split abelian - by - abelian group such that @xmath1464 is not diagonalizable",
    ". then @xmath14 and @xmath15 are not quasi - isometric .",
    "if there were , then theorem [ behaviors of phi ] implies that geodesics are taken to geodesics and the induced height function on the geodesics are affine , which means that we can compare rates of divergence between two geodesics in the same direction . in @xmath15",
    ", we would detect exponential polynomial growth while in @xmath14 , only exponential growth can be detected , and those two growth types are not q.i .",
    "to each other .",
    "when the homomorphism appeared in the semidirect expression of a non - degenerate , unimodular , abelian - by - abelian solvable lie group is diagonalizable , uniform subgroups of quasi - similarities of its root boundaries are analyzed in @xcite , and in this case we are able to say something about an arbitrary finitely generated group in its quasi - isometric class .",
    "[ showing polycyclic ] let @xmath1465 be a non - degenerate , unimodular , split abelian - by - abelian solvable lie group where @xmath501 is diagonalizable .",
    "if @xmath24 is a finitely generated group quasi - isometric to @xmath14 , then @xmath24 is virtually polycyclic .",
    "let @xmath1466 be a @xmath0 quasi - isometry . for each @xmath1467",
    ", write @xmath1468 for the left translation of @xmath126 , and @xmath1469",
    ". then @xmath1470 constitute an uniform subgroup of @xmath1471 , all with the same q.i .",
    "constants ( they are all @xmath0 quasi - isometries ) .    by theorem",
    "[ behaviors of phi ] , each @xmath1472 induces a permutation on root classes .",
    "therefore the map from @xmath1473 into the permutations on root classes of @xmath14 is a well - defined homomorphism , whose kernel , @xmath1474 is finite index in @xmath1473 .",
    "since @xmath1473 is a uniform subgroup of @xmath1471 , by proposition [ qi preserving flats ] @xmath1474 is a uniform subgroup of @xmath1475 } qsim(\\partial^{-}_{[\\alpha]})$ ] .",
    "applying theorem 2 in @xcite to the image of @xmath1474 in each @xmath1476})$ ] factor , we can conjugate @xmath1474 into @xmath1475 } asim(\\partial^{-}_{[\\alpha]})$ ] , the group of almost similarities .",
    "denote the image of @xmath1474 in @xmath1475 } asim(\\partial^{-}_{[\\alpha]})$ ] by @xmath1477 .",
    "note that @xmath1477 and @xmath1474 are isomorphic .    for each @xmath1478 ,",
    "write @xmath1479 , \\gamma}$ ] for the almost similarity on @xmath1480 } , d_{[\\xi]})$ ] and @xmath1481 , \\gamma}$ ] the corresponding similarity constant , as induced by the image of @xmath1472 in @xmath1477 .",
    "we know that for each @xmath1472 , there is a @xmath1483 such that @xmath1472 induces @xmath1484 quasi - similarity @xmath1485,\\gamma}$ ] on @xmath1486 } , d_{[\\xi]})$ ] .",
    "theorem 2 of @xcite says that we can find @xmath1487 } \\in bilip(\\partial_{[\\xi ] } , d_{[\\xi]})$ ] with bilip constant @xmath1488 such that for every root class @xmath89 $ ] and every @xmath1478 ,                ( because the left hand side lies in an interval those end points are constants independent of @xmath126 , so if the left hand side was not 1 , then the product for sufficiently high powers of @xmath126 escape the interval )    on the other hand , for a generic linear functional @xmath150 , we know that @xmath1494 } \\mathit{l}_{[\\xi]}(\\vec{v}_{\\ell } ) = \\sum_{[\\xi ] } \\xi_{0}(\\vec{v}_{\\ell } ) \\frac{\\mathit{l}_{[\\xi]}}{\\xi_{0 } } = \\sum_{[\\xi ] } \\xi_{0}(\\mathbf{t}_{0,\\gamma } ) \\frac{\\xi_{0}(\\vec{v}_{\\ell})}{\\xi_{0}(\\mathbf{t}_{0,\\gamma } ) } \\frac{\\mathit{l}_{[\\xi]}}{\\xi_{0}}\\ ] ]      by letting @xmath150 ranging over a subset of positive measure , equation ( [ product in other direction ] ) and ( [ canonical product ] ) means that the @xmath1481 , \\gamma}$ ] must be of the form @xmath1496 for some @xmath1482 is 2 or higher , @xmath1481,\\gamma}$ ] equals to @xmath1497 ; but in rank 1 all that we can say is that it is of the form @xmath1496 where @xmath1498 might not be the same as @xmath1499 .",
    "this means that for each @xmath1478 , @xmath1500,\\gamma } \\}_{[\\xi]}$ ] determines an element @xmath1501 of the form @xmath1502})_{[\\xi ] } , \\mathbf{t } ) = \\left ( ( g_{[\\xi],\\gamma}(\\mathbf{x}_{[\\xi ] } ) ) _ { [ \\xi ] } , \\mathbf{t } + \\mathbf{s}_{\\gamma } \\right)\\ ] ]        since @xmath24 is quasi - isometric to @xmath14 , the quasi - action of @xmath1474 on @xmath14 is proper , which means @xmath1477 and @xmath1505 quasi acts properly on @xmath291 } ( \\partial^{-}_{[\\xi ] } , d_{[\\xi]})$ ] .",
    "now by theorem 18 of @xcite , @xmath24 is virtually polycyclic .      where @xmath1510 is the distance between the identity and @xmath1511 in @xmath14 . in the case of a connected , simply connected solvable lie group @xmath14",
    ", osin showed in @xcite that the set of exponentially distorted elements forms a normal subgroup @xmath1512 .",
    "[ splitting implied ] let @xmath14 be a connected , simply connected solvable lie group such that @xmath1513 where @xmath1512 is abelian . then the above sequence splits and @xmath14 is a semidirect product of @xmath1512 and @xmath1514 .    let @xmath1515 be a cartan subalgebra of @xmath30 , the lie algebra of @xmath14",
    ". then @xmath1516 , the lie algebra of @xmath1512 , is generated by root spaces in the decomposition of @xmath30 with respect to @xmath1515 . since",
    "this is abelian , it means that @xmath30 is a semidirect product of @xmath1515 and @xmath1516 . since @xmath1517 is abelian , @xmath1515 is abelian .",
    "[ showing lattice in almost me ] let @xmath1465 be a non - degenerate , unimodular , split abelian - by - abelian solvable lie group where @xmath501 is diagonalizable .",
    "if @xmath24 is a finitely generated group quasi - isometric to @xmath14 , then @xmath24 is virtually a lattice in a unimodular semidirect product of @xmath54 and @xmath53 .    by corollary",
    "[ showing polycyclic ] , @xmath24 contains a finite index subgroup that is polycyclic . by a theorem of mostow ( theorem 4.28 in @xcite ) which says that a polycyclic group contains a finite index subgroup that embeds as a lattice in a connected , simply connected lie group , we have @xmath1518 , a connected , simply connected solvable lie group to which @xmath24 is virtually a lattice of . the crux of the proof consists of showing that @xmath1518 satisfies the short exact sequence in lemma [ splitting implied ] , and the argument is practically that of section 4.3 in @xcite with minor modifications .",
    "we reproduce the skeleton of the proof below , and refer the readers to the relevant sections in @xcite for details .",
    "+ we are now going to construct a continuous homomorphism @xmath1519 that is onto , whose finitely generated kernel not only is quasi - isometric to @xmath54 but also coincides with the exponential radical of @xmath1518 . as any finitely generated in the same quasi - isometric class as @xmath533 must be virtually @xmath533 , by lemma [ splitting implied ] , @xmath1518 is virtually a semidirect product of @xmath53 and @xmath54 .",
    "if this semidirect product were not unimodular , then @xmath1518 would be non - amenable , which is a contradiction because amenability is preserved under quasi - isometry .",
    "+ the @xmath1520 is going to be the composition of the following three homomorphisms :    1 .   @xmath1521 } qsim(\\partial^{-}_{[\\alpha]})$ ] 2 .",
    "conjugation of a uniform subgroup of @xmath1475 } qsim(\\partial^{-}_{[\\alpha]})$ ] into @xmath1522 , where @xmath1522 is the set of all maps of the form @xmath1523})_{[\\xi ] } , \\mathbf{t } ) = \\left ( ( g_{[\\xi],\\gamma}(\\mathbf{x}_{[\\xi ] } ) ) _ { [ \\xi ] } , \\mathbf{t } + \\mathbf{s}_{\\gamma } \\right ) $ ] .",
    "@xmath1524 } aisom(\\partial^{-}_{[\\alpha ] } ) \\rightarrow \\mathbf{a}=\\mathbb{r}^{n}$ ]    * homomorphism a. * we can assume without loss of generality , that @xmath24 itself is a lattice in @xmath1518 .",
    "we start with the following construction which can be found in section 3.2 of @xcite .",
    "choose some open subset @xmath1525 with compact closure , such that @xmath1518 is the union of left translates of @xmath950 by @xmath24 . also fix a function @xmath1526 such that @xmath1527 for every @xmath1528 . then by defining @xmath1529 as @xmath1530 for every @xmath1531 , we obtain a homomorphism from @xmath1518 into @xmath1532 . since @xmath24 is quasi - isometric to @xmath14 , conjugating by the quasi - isometry between @xmath24 and @xmath14",
    ", we obtain a homomorphism from @xmath1518 into @xmath1471 , where the images have uniform quasi - isometric constants . by ( v ) of proposition [ qi preserving flats ] , we can realize @xmath1471 as a subgroup of @xmath1475 } qsim(\\partial^{-}_{[\\alpha]})$ ] . by passing to a finite index subgroup of @xmath1518 if necessary",
    ", we now have the homomorphism @xmath111 from @xmath1518 to @xmath1475 } qsim(\\partial^{-}_{[\\alpha]})$ ] , whose image is a uniform subgroup of quasi - similarities .",
    "continuity of homomorphism @xmath111 follows from proposition 26 of @xcite where continuity in each factor was obtained .",
    "* homomorphism b. * theorem 2 of @xcite says that we can conjugate the image of homomorphism a. into @xmath1475 } asim(\\partial^{-}_{[\\alpha]})$ ] . that elements of @xmath1475 } asim(\\partial^{-}_{[\\alpha]})$ ] can be realized as elements of @xmath1522 follows from the * claim * in the proof of corollary [ showing polycyclic ] .",
    "homomorphism b. is continuous because conjugation is continuous .    * homomorphism c. * the definition of @xmath1522 means that we have a well - defined homomorphism into @xmath1533 , which is our homomorphism c. now if @xmath782 is a sequence in @xmath1522 approaching to identity , then the map each one of them induces on the @xmath53 factor also has to approach that of what the identity does .",
    "since the identity map produces no change in the @xmath53 factor , it follows that the image of @xmath782 s under homomorphism c. approaches @xmath1534 .",
    "since @xmath24 is quasi - isometric to @xmath14 , the quasi - action by the quasi - isometry between @xmath24 and @xmath14 gives a quasi - action on @xmath14 ] of @xmath24 , and therefore @xmath1518 , on @xmath14 is cobounded , it follows that @xmath1520 must be onto because it is continuous .",
    "+ we now claim that @xmath1536 . to this end , we need the following from @xcite .",
    "( _ lemma 2.1 in @xcite _ ) suppose @xmath14 , @xmath313 are locally compact groups generated by some symmetric compact neighborhoods of the identities , @xmath1537 , @xmath1538are canonical norms on @xmath14 and @xmath313 , and @xmath1539 , @xmath1540 are the induced metrics .",
    "assume @xmath1541 is a continuous surjective homomorphism , then there is a constant @xmath1542 such that @xmath1543          conulier showed in @xcite that for a connected , simply connected solvable lie group @xmath2 , the _ asymptotic dimension _ , defined as the dimension of @xmath1550 is a quasi - isometric invariant .",
    "this means that @xmath1551      by construction , @xmath1518 quasi - acts properly on @xmath14 as a uniform group of quasi - isometries , which means @xmath1553 quasi - acts properly on @xmath54 as a uniform group of quasi - similarities , so @xmath1553 is finitely generated by proposition 20 in @xcite .",
    "fix a @xmath130 .",
    "then @xmath1555 is a quasi - isometry from @xmath1518 to @xmath14 . here",
    "@xmath1556 refers to the homomorphisms mentioned above .",
    "the restriction of this map to @xmath1557 produces a quasi - isometric embedding of @xmath1554 into @xmath54 .",
    "however since the cohomological dimension is a quasi - isometry invariant @xcite , the dimension of @xmath1554 must equal that of @xmath54 .",
    "now by theorem 7.6 of @xcite , this embedding must be coarsely onto , which means @xmath1554 is quasi - isometric to @xmath54 , so @xmath1554 must be virtually @xmath54 since the latter is abelian .",
    "let @xmath14 be a rank 1 group with weights @xmath1558 .",
    "it has no lattice has two distinct eigenvalues , one of them repeated twice , then they have to be @xmath1559 .",
    "see @xcite .",
    "but the diagonal matrix with those eigenvalues as entries is not conjugate to the action of @xmath360 on @xmath1560 i.e. the diagonal matrix with entries @xmath1561 .",
    "] so theorem [ showing lattice ] says that it can not be quasi - isometric to any finitely generated groups ."
  ],
  "abstract_text": [
    "<S> in this paper , we continue with the results in @xcite and compute the group of quasi - isometries for a subclass of split solvable unimodular lie groups . </S>",
    "<S> consequently , we show that any finitely generated group quasi - isometric to a member of the subclass has to be polycyclic , and is virtually a lattice in an abelian - by - abelian solvable lie group . </S>",
    "<S> we also give an example of a unimodular solvable lie group that is not quasi - isometric to any finitely generated group , as well deduce some quasi - isometric rigidity results . </S>"
  ]
}