{
  "article_text": [
    "our primary motivation is the _ @xmath1-colouring problem _ ( which has become popular under the name _ constraint satisfaction problem  csp _ ) : for a fixed digraph  @xmath1 ( a _ template _ ) decide whether an input digraph  @xmath2 admits a homomorphism to  @xmath1 .",
    "the computational complexity of @xmath1-colouring depends on the template  @xmath1 . for some templates",
    "the problem is known to be np - complete , for others it is tractable ( a polynomial - time algorithm exists ) . assuming that @xmath4 , infinitely many complexity classes lie strictly between p and np  @xcite , but it has been conjectured that @xmath1-colouring belongs to no such intermediate class for any template  @xmath1  @xcite .",
    "this conjecture has indeed been proved for symmetric templates  @xmath1  @xcite .    in this paper",
    "the focus is on tractable cases .",
    "several conditions are known to imply the existence of a polynomial - time algorithm for @xmath1-colouring ( definitions follow in the next two paragraphs ) : it is the case if @xmath1  has a near - unanimity function ( nuf ) , if @xmath1  has bounded - treewidth duality , if @xmath1  has tree duality , if @xmath1  has finite duality ( see  @xcite ) .",
    "some of the conditions are depicted in the diagram ( fig .",
    "[ fig : diag ] ) .",
    "a _ near - unanimity function _ is a homomorphism  @xmath5 from  @xmath6 to  @xmath1 with @xmath7 such that for all @xmath8 we have @xmath9 .",
    "the power @xmath6 is the @xmath10-fold product @xmath11 in the category of digraphs and homomorphisms , see  @xcite .",
    "a digraph is a tree ( has treewidth  @xmath10 ) if its underlying undirected graph is a tree ( has treewidth  @xmath10 , respectively ) .",
    "a set @xmath12 of digraphs is a _",
    "complete set of obstructions _ for  @xmath1 if for an arbitrary digraph  @xmath2 there exists a homomorphism from  @xmath2 to  @xmath1 if and only if no @xmath13 admits a homomorphism to  @xmath2 .",
    "a template has _ bounded - treewidth duality _ if it has a complete set of obstructions with treewidth bounded by a constant ; it has _ tree duality _ if it has a complete set of obstructions consisting of trees ; and it has _ finite duality _ if it has a finite complete set of obstructions .",
    "there is a fairly straightforward way to generate templates with finite duality . for an arbitrary tree",
    "@xmath14 there exists a digraph  @xmath15 such that @xmath16 is a complete set of obstructions for  @xmath15 .",
    "the digraph  @xmath15 is unique up to homomorphic equivalence and @xmath17 are _ homomorphically equivalent _ if there exists a homomorphism from  @xmath1 to  @xmath17 as well as a homomorphism from  @xmath17 to  @xmath1 .",
    "clearly , if @xmath1 and  @xmath17 are homomorphically equivalent , then @xmath1-colouring and @xmath17-colouring are equivalent problems , because @xmath1 and @xmath17 admit homomorphisms from exactly the same digraphs . ]",
    "; it is called the _ dual _ of  @xmath14 .",
    "several explicit constructions are known ( see  @xcite ) .",
    "if @xmath12 is a finite set of oriented trees , then the product @xmath18 is a template with finite duality and @xmath12  is a complete set of obstructions for  @xmath19 .",
    "this construction yields all digraphs with finite duality  @xcite , thus also proving that finite duality implies tree duality .",
    "encouraged by the full description of finite dualities , we aim to provide a construction for some more digraphs with tree duality . to this end",
    "we use the arc - graph construction and consider the class  @xmath20 of digraphs generated from finite duals by taking iterated arc graphs and finite cartesian products .",
    "we show that all templates in this class have tree duality .",
    "we provide an explicit construction of the resulting tree obstructions , which allows us to show that all the digraphs in  @xmath21 have in fact _ bounded - height tree duality _ , that is , they have a complete set of obstructions consisting of trees of bounded algebraic height ( these are tree obstructions that allow a homomorphism to a fixed directed path ) . in this context",
    "we also prove that the problem of existence of a complete set of obstructions consisting of trees with bounded algebraic height is decidable .",
    "the arc - graph construction is a special case of a more general phenomenon : it is a right adjoint in the category of digraphs and homomorphisms .",
    "we show in the more general setting of the category of relational structures that right adjoints ( characterised by pultr  @xcite for all locally presentable categories ) preserve tractability of templates and moreover they preserve tree duality and existence of a near - unanimity function . in this case , nevertheless , it remains open to provide a nice general description of complete sets of obstructions .",
    "we use some notions and properties of graphs and homomorphisms which the reader can look up in  @xcite , as well as some category - theory notions , for which , e.g.  @xcite may be consulted .",
    "let @xmath22 be a digraph .",
    "the _ arc graph _ of  @xmath2 is the digraph @xmath23 , where @xmath24 notice that @xmath25 is an endofunctor in the category of digraphs and homomorphisms .",
    "this implies in particular that if @xmath26 , then @xmath27 .",
    "( the notation @xmath26 means that there exists a homomorphism from  @xmath2 to  @xmath1 . )",
    "if @xmath2 is a digraph and @xmath28  is an equivalence relation on its vertex set  @xmath29 , the _ quotient _  @xmath30 is the digraph  @xmath31 , where @xmath32  is the set of all equivalence classes of  @xmath28 on  @xmath29 , and for @xmath33 we have @xmath34 if and only if there exist @xmath35 and @xmath36 such that @xmath37 .",
    "suppose still that @xmath22 is a digraph .",
    "let @xmath38 and let @xmath39 .",
    "define the relation  @xmath40 such that @xmath41 if and only if @xmath42 .",
    "let @xmath28 be the minimal equivalence relation on  @xmath43 containing  @xmath40 .",
    "set @xmath44 . in the following ,",
    "we use the notation @xmath45 , @xmath46 and @xmath40 and @xmath28 for the sets and relations appearing in the definition of  @xmath47 ; the precise meaning will be clear from the context .",
    "now @xmath47 is also an endofunctor in the category of digraphs . strictly speaking ,",
    "it is not an inverse of @xmath25 ; its name is chosen because of the following property .",
    "[ prop : delta ] for any digraphs @xmath2 and @xmath1 , @xmath48    let @xmath49 be a homomorphism . then there exist two homomorphisms @xmath50 such that @xmath51 for all @xmath52 .",
    "define the mapping @xmath53 by @xmath54 and @xmath55 . if @xmath56 , then @xmath57 , whence @xmath58 and thus @xmath59 .",
    "therefore @xmath60  is constant on the equivalence classes of  @xmath28 , and it induces a homomorphism from @xmath61 to  @xmath1 .",
    "conversely , let @xmath62 be a homomorphism .",
    "we define @xmath63 by @xmath64 . if @xmath65 , then @xmath66 , whence @xmath67 .",
    "therefore @xmath5  is a homomorphism .    thus @xmath25 and @xmath47 are galois adjoints and @xmath68 be partially ordered sets .",
    "mappings @xmath69 and @xmath70 are _ galois adjoints _ if @xmath71 for all elements @xmath35 and @xmath36 . ] with respect to the ordering by existence of homomorphisms .",
    "they are in fact adjoint functors in the category of digraphs and homomorphisms .",
    "we return to this topic in section  [ sec : functors ] . for the moment we aim to prove that @xmath25 preserves tree duality .",
    "more precisely , from the family  @xmath72 of tree obstructions of  @xmath1 , we will derive the family @xmath73 of tree obstructions of  @xmath3 .",
    "the _ algebraic height _ of an oriented tree  @xmath14 is the minimum number of arcs of a directed path to which @xmath14  maps homomorphically .",
    "the algebraic height of every finite oriented tree is well - defined and finite , since every such tree admits a homomorphism to some finite directed path .",
    "thus a tree  @xmath14 is _ of height at most one _ if its vertex set can be split into two parts @xmath74 in such a way that for every arc  @xmath75 of  @xmath14 we have @xmath76 and @xmath77 .",
    "note that if the tree  @xmath14 has no arcs , then it has only one vertex and thus one of the sets @xmath78 , @xmath79 is empty and the other one is a singleton .",
    "let @xmath14 be a tree .",
    "for every vertex  @xmath80 of  @xmath14 , let @xmath81 be a tree of height at most one .",
    "for each arc  @xmath82 of  @xmath14 incident with  @xmath80 , let there be a fixed vertex @xmath83 in  @xmath81 such that if @xmath80  is the initial vertex of  @xmath82 , then @xmath84 , and if @xmath80  is the terminal vertex of  @xmath82 , then @xmath85",
    ".  is neither a source nor a sink of  @xmath14 , then both @xmath86 and @xmath87 are non - empty , and so in this case @xmath81  is not a single vertex .",
    "if @xmath80 is a source or a sink of  @xmath14 , then @xmath81 may be an arbitrary tree of height at most one . ]",
    "a tree  @xmath88 is now constructed by taking all the trees  @xmath81 for all vertices  @xmath80 of  @xmath14 , and by identifying the vertex @xmath83 with @xmath89 whenever @xmath90 is an arc of  @xmath14 .",
    "any such tree  @xmath88 constructed from  @xmath14 by the above procedure is called a _ sproink _ of  @xmath14 .",
    "the set of all sproinks of a tree  @xmath14 is denoted by @xmath91 .",
    "the following lemma asserts that sproinks of obstructions for a template  @xmath1 are indeed obstructions for its arc graph  @xmath3 .",
    "[ lem : sproink ] let @xmath14 be a tree and @xmath1 a digraph such that @xmath92 .",
    "if @xmath93 , then @xmath94 .    we prove that @xmath95 .",
    "consequently @xmath96 because @xmath92 , and therefore @xmath97 by proposition  [ prop : delta ] .",
    "thus let @xmath93 .",
    "for a vertex  @xmath80 of  @xmath14 , consider the tree  @xmath81 , which is a subgraph of  @xmath88 .",
    "since @xmath81  has height at most one , its vertices are partitioned into the sets @xmath86 and  @xmath87 .",
    "the set  @xmath98 , which appears in the definition of  @xmath99 , contains  @xmath100 as a subset . if @xmath75 is an arc of  @xmath81 , then @xmath101 .",
    "thus whenever @xmath102 and @xmath103 , then @xmath104 .",
    "hence for any vertex  @xmath80 of  @xmath14 there exists a unique vertex  @xmath105 of  @xmath99 that is equal to @xmath106 for all @xmath107 and to @xmath108 for all @xmath103 .    in this way",
    ", we have defined a mapping @xmath109 .",
    "now assume that @xmath110 is an arbitrary arc of @xmath14 . then the vertex @xmath83 , which belongs to  @xmath87 , has been identified with @xmath111 , which belongs to  @xmath112 .",
    "let this identified vertex be  @xmath113 ; it is a vertex of  @xmath88 . by definition ,",
    "@xmath114 because @xmath115 , and @xmath116 because @xmath117 .",
    "of course @xmath118 .",
    "therefore @xmath119 is a homomorphism , as we have promised to prove .    for a set  @xmath12 of trees ,",
    "let @xmath120 .",
    "[ thm : spr - thm ] let @xmath12 be a set of trees which is a complete set of obstructions for a template  @xmath1 . then @xmath121 is a complete set of obstructions for  @xmath3 .",
    "lemma  [ lem : sproink ] implies that @xmath121 is a set of obstructions for  @xmath3 .",
    "it remains to prove that it is complete , that is whenever @xmath122 , then there exists some @xmath123 such that @xmath124 .",
    "so let @xmath122 .",
    "thus by proposition  [ prop : delta ] we have @xmath125 .",
    "hence there exists a tree @xmath126 such that @xmath127 , because @xmath12  is a complete set of obstructions for  @xmath1 .",
    "consequently it suffices to prove that if @xmath128 then there exists @xmath93 such that @xmath124 .",
    "thus assume that @xmath129 is a homomorphism .",
    "for every @xmath130 , the image  @xmath105 is a @xmath28-equivalence class ; put @xmath131    then @xmath132 , and by the definition of  @xmath28 as the least equivalence containing  @xmath40 , there exists a tree  @xmath81 of height at most one and a homomorphism @xmath133 such that @xmath134 and @xmath135 . for every arc  @xmath136 of  @xmath14 ,",
    "we have @xmath137",
    "so there exists @xmath138 such that @xmath139 and @xmath140 .    we then select @xmath141 and @xmath142 such that @xmath143 , and identify them .",
    "proceeding with all such identifications , we construct a tree @xmath144 such that @xmath145 is a well - defined homomorphism .",
    "[ cor : arc ] if a digraph @xmath1 has tree duality , then its arc graph  @xmath3 also has tree duality .",
    "consider @xmath146 , the directed path with four arcs , and its dual  @xmath147 , the transitive tournament on four vertices . here",
    "@xmath148  has six vertices , but its core has a unique core  @xmath149 ( up to isomorphism ) , which is moreover the only core homomorphically equivalent to it .",
    "in fact , the core  @xmath149 of  @xmath1 is a _ retract _ of  @xmath1 , which means that there exists a homomorphism @xmath150 whose restriction on  @xmath149 is the identity mapping ( such a homomorphism is called a _ retraction _ ) . ] is the directed path @xmath151 with two arcs .",
    "it is well known that a directed graph @xmath2 admits a homomorphism to @xmath151 if and only if it does not admit a homomorphism from a `` thunderbolt '' , that is , an oriented path with two forward arcs at the beginning and at the end , and with an odd - length alternating path between them ( see fig .  [",
    "fig : thunder ] ) .",
    "thus the family of all thunderbolts is a complete set of tree obstructions for @xmath151 .",
    "our construction @xmath91 gives all obstructions obtained by stacking five trees @xmath152 , @xmath153 , @xmath154 , @xmath155 ,  @xmath156 of height at most one , with one top vertex of  @xmath157 identified with one bottom vertex of  @xmath158 for @xmath159 .",
    "the example of thunderbolts shows that in fact @xmath152 can be restricted to a single ( top ) vertex , and @xmath156  can be restricted to a single ( bottom ) vertex .",
    "the same holds for leaves of general trees .",
    "also , @xmath153 , @xmath154 , @xmath155 can be restricted to _",
    "paths _ of height one , and it is also true in general that it is sufficient to consider sproinks obtained by replacing vertices by _ paths _ of height at most one . in fact the name `` sproink '' is inspired by picturing such a path springing out of every non - leaf of  @xmath14 .",
    "the results of this section show that we can construct an interesting class of templates with tree duality by repeatedly applying the arc - graph construction to digraphs with finite duality .",
    "moreover , if templates @xmath160 , @xmath161 ,   ,  @xmath162 all have tree duality , then also their product @xmath163 has tree duality as the union of the respective complete sets of obstructions of the factors is a complete set of obstructions for the product .",
    "the resulting class of templates is subject to examination in the next section .",
    "following @xcite , every tree @xmath14 admits a dual @xmath15 such that for every digraph  @xmath2 , we have @xmath164 if and only if @xmath165 . a digraph  @xmath1 has finite duality if and only if it is homomorphically equivalent to a finite product of duals of trees .    in this section",
    ", we consider the class @xmath21 , the smallest class of digraphs that contains all duals of trees and is closed under taking arc graphs , finite products and homomorphically equivalent digraphs .",
    "it follows from corollary  [ cor : arc ] that all elements of  @xmath21 have tree duality .",
    "moreover we know how to construct a complete set of obstructions for each of these templates , using iterated @xmath166 constructions and unions .",
    "the question then arises as to how significant the class  @xmath21 is within the class of digraphs with tree duality .",
    "it turns out that the digraphs in  @xmath21 have properties that are not shared by all digraphs with tree duality .",
    "a digraph  @xmath1 has _ bounded - height tree duality _ provided there exists a constant  @xmath167 such that @xmath1  admits a complete set of obstructions consisting of trees of algebraic height at most  @xmath167 .",
    "[ prop : dpc ]    * every core in @xmath21 admits a near - unanimity function . * every member of @xmath21 has bounded - height tree duality .",
    "( i ) : by corollary  4.5 of  @xcite , every structure with finite duality admits a near - unanimity function .",
    "therefore it suffices to show that the class of structures admitting a near - unanimity function is closed under taking cores , finite products and the arc - graph construction .",
    "let @xmath149 be the core of  @xmath1 , @xmath168 a retraction and @xmath169 a near - unanimity function .",
    "since @xmath149  is an induced subgraph of  @xmath1 , the restriction @xmath170 is a near - unanimity function on  @xmath149 .",
    "suppose @xmath171 are near - unanimity functions . for @xmath172",
    ", we define @xmath10-ary near - unanimity functions @xmath173 by @xmath174 . for @xmath175",
    "we then define a near - unanimity function @xmath176 coordinate - wise , by putting @xmath177    now suppose that @xmath178 is a near - unanimity function .",
    "then @xmath179 is naturally isomorphic to  @xmath180 , and we define @xmath181 by @xmath182 the fact that @xmath5 is a homomorphism implies that @xmath183  is well defined , and @xmath183  is a homomorphism by the definition of adjacency in  @xmath3 . also , @xmath183 clearly satisfies the near - unanimity identities , so it is a near - unanimity function on  @xmath3 .",
    "( ii ) : the class of digraphs with bounded - height tree duality is obviously preserved by taking cores and finite products . by theorem  [ thm : spr - thm ] , if @xmath1  has a complete set of obstructions consisting of trees of algebraic height at most  @xmath10 , then @xmath3  has a complete set of obstructions consisting of trees of algebraic height at most  @xmath184 , so the class of digraphs with bounded - height tree duality is also preserved by the arc - graph construction .",
    "we know a core digraph with tree duality but no near - unanimity function and no bounded - height tree duality .",
    "( the example is complicated and out of the scope of this paper , therefore we omit it . )",
    "thus the class  @xmath21 does not capture all core digraphs with tree duality .",
    "the problem of generating all structures with tree duality by means of suitable functors applied to structures with finite duality remains nevertheless interesting .",
    "membership in @xmath21 is not known to be decidable . in the remainder of this section , we show that bounded - height tree duality is decidable .    given a digraph @xmath1 , the _",
    "@xmath185-th crushed cylinder _",
    "@xmath186 is the quotient @xmath187 , where @xmath188  is the path with arcs @xmath189 , and @xmath190 is the equivalence defined by @xmath191    [ thm:123 ] for a core digraph @xmath1 with tree duality , the following are equivalent :    * @xmath1 has bounded - height tree duality , * for some @xmath185 we have @xmath192 .",
    "* there exists a directed ( upward ) path from the first projection to the second in @xmath193 .    *",
    "( 1 ) @xmath194 ( 2 ) : * the two subgraphs obtained from @xmath186 by removing the two ends both admit homomorphisms to @xmath1 . therefore ,",
    "if a tree obstruction of @xmath1 admits a homomorphism to @xmath186 , its image must intersect the two ends hence its algebraic length must be at least @xmath185 .    *",
    "@xmath195(1 ) @xmath194 @xmath195(2 ) : * let @xmath14 be a critical obstruction of  @xmath1 of algebraic length  @xmath196 .",
    "let @xmath197 , @xmath198 be the subgraphs of  @xmath14 obtained by removing the vertices of height @xmath199 and  @xmath196 respectively",
    ". then there exists homomorphisms @xmath200 and @xmath201 .",
    "let @xmath202 be the height function of  @xmath14 .",
    "we define a map @xmath203 by @xmath204 let @xmath136 be an arc of @xmath14 . then @xmath205 .",
    "if @xmath206 , we clearly have @xmath207 .",
    "if @xmath208 , then @xmath209 is an in - neighbour of @xmath210 , and if @xmath211 , @xmath212 is an out - neighbour of  @xmath105 because @xmath213 therefore @xmath5 is a homomorphism .    * ( 2 ) @xmath214 ( 3 ) : * this equivalence follows easily from the definition .    the problem whether an input digraph has bounded - height tree duality is decidable .",
    "it is decidable whether a digraph has tree duality  @xcite ( see theorem  [ thm : u ] below ) . for a digraph with tree duality ,",
    "bounded height of the obstructions ( the condition ( 1 ) of theorem  [ thm:123 ] ) is equivalent to the condition  ( 3 ) , which involves directed reachability in a finite graph .",
    "hence bounded - height tree duality is decidable .",
    "the correspondence of proposition [ prop : delta ] can be extended to a wide class of functors presented in this section . to illustrate this extension , we first redefine @xmath25 in terms of patterns .",
    "let @xmath215 be the digraph with vertices @xmath216 and arc @xmath217 , and @xmath218 the digraph with vertices @xmath219 and arcs @xmath220 .",
    "furthermore let @xmath221 be the homomorphisms mapping the arc @xmath217 to @xmath217 and @xmath222 respectively .",
    "for an arbitrary digraph @xmath2 , its arc graph  @xmath223 can be described as follows : the vertices of @xmath223 are the arcs of @xmath2 , that is , the homomorphisms @xmath224 .",
    "the arcs of @xmath223 are the couples of consecutive arcs in @xmath2 , that is , the couples @xmath225 such that there exists a homomorphism @xmath226 satisfying @xmath227 and @xmath228 .",
    "thus the functor @xmath25 is generated by the pattern @xmath229 in a way that generalises quite naturally .",
    "the rest of this section deals with relational structures .",
    "a _ vocabulary _ is a finite set @xmath230 of relation symbols , each with an arity  @xmath231 assigned to it .",
    "a @xmath232-structure is a relational structure @xmath233 where @xmath234 is a non - empty set called the _ universe _ of  @xmath235 , and @xmath236  is an @xmath231-ary relation on  @xmath234 for each  @xmath237 .",
    "homomorphisms of relational structures are relation - preserving mappings between universes ; a homomorphism is defined only between structures with the same vocabulary .",
    "cores , trees , quotient structures , etc .  can also be defined in the context of relational structures , consult  @xcite for the details ( see also  @xcite ) .",
    "the notions of the constraint satisfaction problem , template , and tree duality also carry over naturally from the setting of digraphs .",
    "let @xmath232 and @xmath238 be two vocabularies .",
    "let @xmath215 be a @xmath232-structure , and for every relation @xmath239 of @xmath238 of arity @xmath240 , let @xmath241 be a @xmath232-structure with @xmath242 fixed homomorphisms @xmath243 for @xmath244 .",
    "then the family @xmath245 defines a functor @xmath246 from the category  @xmath247 of @xmath232-structures to the category  @xmath248 of @xmath238-structures as follows .",
    "* for a @xmath232-structure @xmath235 , let @xmath249 be a @xmath238-structure whose universe is the set of all homomorphisms @xmath250 . * for every relation @xmath239 of @xmath238 of arity @xmath251 ,",
    "let @xmath252 be the set of @xmath242-tuples @xmath253 such that there exists a homomorphism @xmath254 such that for @xmath244 we have @xmath255 .",
    "it was shown by pultr  @xcite that functors  @xmath246 defined by means of patterns are right adjoints into a category of relational structures characterised by axioms of a specific type .",
    "we exhibit their corresponding left adjoints  @xmath256 in the case when both the domain and the range of  @xmath246 is the category of all relational structures with a given vocabulary .    for every @xmath238-structure @xmath257",
    ", we define a @xmath232-structure @xmath258 , where    * @xmath235 is a disjoint union of @xmath232-structures ; for every element @xmath113 of the universe of @xmath257 , @xmath235 contains a copy @xmath259 of @xmath215 , and for every @xmath260 and @xmath261 , @xmath235 contains a copy @xmath262 of @xmath241 . *",
    "@xmath28 is the least equivalence which identifies every element @xmath80 of @xmath263 with its image @xmath264 in @xmath262 , for every @xmath260 , every @xmath261 and every @xmath265 .",
    "[ prop : psi ] for any @xmath238-structure @xmath257 and @xmath232-structure @xmath235 , @xmath266    let @xmath267 be a homomorphism , and put @xmath268 .",
    "then for every @xmath269 , the mapping  @xmath270 corresponds to a well - defined homomorphism to  @xmath235 from a copy  @xmath271 of  @xmath215 .",
    "also , for every @xmath260 and @xmath272 , we have @xmath273 , so there exists a homomorphism @xmath274 such that @xmath275 for @xmath244 ; the mapping @xmath276 corresponds to a well - defined homomorphism from a copy @xmath277 of  @xmath241 to  @xmath235 .",
    "therefore @xmath278 corresponds to a well - defined homomorphism @xmath279 , such that if @xmath280 , then @xmath281 .",
    "therefore @xmath282  induces a homomorphism from the quotient structure @xmath283 to  @xmath235 .",
    "conversely , if @xmath284 is a homomorphism , we define a homomorphism @xmath285 by @xmath286 , where @xmath270  corresponds to the restriction of  @xmath287 to the quotient of  @xmath271 in  @xmath283 . indeed , if @xmath260 and @xmath272 , then the restriction of  @xmath287 to the quotient of @xmath288 in @xmath283 corresponds to a homomorphism @xmath289 such that @xmath290 for @xmath244 , whence @xmath291 .    if a @xmath232-structure @xmath235 has polynomial csp , then the @xmath238-structure @xmath292 also has polynomial csp .",
    "in fact , corollary  [ cor : arc ] generalises as follows .",
    "[ thm : psi ] if a @xmath232-structure @xmath235 has tree duality , then the @xmath238-structure @xmath292 also has tree duality .",
    "we prove theorem  [ thm : psi ] using feder and vardi s characterisation of structures with tree duality . for a @xmath232-structure @xmath235 ,",
    "let @xmath293 be the @xmath232-structure defined as follows .",
    "the universe of @xmath293 is the set of all nonempty subsets of @xmath235 , and for @xmath294 of arity @xmath242 , @xmath295 is the set of all @xmath242-tuples @xmath296 such that for all @xmath297 and @xmath298 there exist @xmath299 such that @xmath300 .",
    "[ thm : u ] a structure @xmath235 has tree duality if and only if there exists a homomorphism from @xmath293 to @xmath235 .",
    "suppose @xmath235 has tree duality .",
    "then there is a homomorphism @xmath301 .",
    "let @xmath302 be the universe of  @xmath303 and let @xmath304 . for @xmath305",
    ", define @xmath306 , and @xmath307 .",
    "we claim that @xmath308 is a homomorphism . indeed , for @xmath294 and @xmath309 , the @xmath242-tuples @xmath310 for all @xmath311 prove that @xmath312 , whence @xmath313 .",
    "thus we define a map @xmath314 by @xmath315 .",
    "we show that it is a homomorphism . for @xmath260 and @xmath316 ,",
    "every @xmath317 , @xmath318 is contained in an @xmath242-tuple @xmath319 with @xmath320 for @xmath321 and @xmath322 , whence there exists a homomorphism @xmath323 such that @xmath324 for @xmath325 .",
    "for @xmath326 , let @xmath327 be the set of all images @xmath328 ( with @xmath329 fixed ) , and @xmath330 .",
    "then @xmath331 is a homomorphism , and for @xmath332 we have @xmath327 = @xmath333 ( because they are images of @xmath113 under restrictions of the same homomorphisms ) , whence @xmath334 .",
    "thus @xmath335 for @xmath325 .",
    "consequently @xmath336 .",
    "this shows that @xmath337 is a homomorphism .    unlike the case of the arc - graph construction , we are unable to provide an explicit description of the tree obstructions of  @xmath292 in terms of those of  @xmath235 for a general right adjoint  @xmath246 . however , in isolated cases we can do it , as the following example shows .",
    "the endofunctor  @xmath246 on the category of digraphs is defined via the pattern @xmath338 , where @xmath339 is the one - arc path @xmath340 , @xmath341 is the directed path @xmath342 , the homomorphism @xmath343 , and finally @xmath344 .",
    "let @xmath14 be a tree of algebraic height  @xmath287 and consider the unique homomorphism  @xmath345 from  @xmath14 to the directed path  @xmath346 .",
    "the arcs of  @xmath14 are of two kinds : _ blue arcs _ @xmath347 and _ red arcs _",
    "we define two equivalence relations on the vertices of  @xmath14 : @xmath349 if the ( not necessarily directed ) path from  @xmath113 to  @xmath350 in  @xmath14 has only blue arcs , and @xmath351 if the path from  @xmath113 to  @xmath350 in  @xmath14 has only red arcs .",
    "then @xmath14  has two @xmath246-sproinks , namely @xmath352 and @xmath353 with loops removed .    for a collection  @xmath0 of trees ,",
    "let @xmath354 be the set of all @xmath246-sproinks of the trees contained in  @xmath0 .",
    "we claim that if @xmath0  is a complete set of obstructions for a template  @xmath1 , then @xmath354 is a complete set of obstructions for  @xmath355 . to prove it",
    ", we follow the idea of the proofs of lemma  [ lem : sproink ] and theorem  [ thm : spr - thm ] .",
    "first we prove that @xmath356 .",
    "this is not difficult : every blue arc of  @xmath14 was contracted to a vertex of  @xmath352 and this vertex was blown up to an arc in @xmath356 .",
    "thus we can map blue arcs to the corresponding blown - up arcs .",
    "red arcs of  @xmath14 are also arcs of  @xmath352 , and hence we can map each red arc to the arc @xmath222 of the corresponding copy of  @xmath218 in @xmath357 . clearly such a mapping is a homomorphism .",
    "analogously we show that @xmath358 .",
    "finally we want to prove that if @xmath359 , then either @xmath360 or @xmath361 .",
    "suppose that @xmath362 . then some arcs of  @xmath14 are mapped by  @xmath5 to arcs corresponding to vertices of  @xmath2 ( arcs of copies of  @xmath215 ) , and others are mapped to arcs corresponding to arcs of  @xmath2 ( arcs @xmath222 of copies of",
    "@xmath218 ) . let us call the former v - arcs and the latter a - arcs .",
    "it follows from the definition of  @xmath256 that either all blue arcs of  @xmath14 are v - arcs and all red arcs of  @xmath14 are a - arcs , or all blue arcs of  @xmath14 are a - arcs and all red arcs of  @xmath14 are v - arcs . in the former case @xmath360 , while in the latter case @xmath361 .",
    "it is notable that in the above example each tree obstruction for  @xmath1 generates finitely many obstructions for  @xmath363 .",
    "this is no accident .",
    "[ thm : fidu ] let @xmath246 be a functor generated by a pattern @xmath245 , where for every @xmath260 and @xmath364 , the image @xmath365 is vertex - disjoint from @xmath366 . if a @xmath232-structure @xmath235 has finite duality , then the @xmath238-structure @xmath292 also has finite duality .",
    "the proof uses the characterisation of structures with finite duality of  @xcite .",
    "the _ square _ of a @xmath232-structure  @xmath257 is the structure  @xmath367 .",
    "it contains the _ diagonal _ @xmath368 .",
    "an element  @xmath369 of  @xmath257 is _ dominated _ by an element  @xmath370 of  @xmath257 if for every @xmath294 , for every  @xmath237 and every @xmath371 with @xmath372 , we have @xmath373 with @xmath374 and @xmath375 for @xmath376 .",
    "a structure  @xmath257 _ dismantles to _ its induced substructure  @xmath149 if there exists a sequence @xmath377 of distinct elements of  @xmath257 such that @xmath378 and for each @xmath379 the element @xmath380 is dominated in the structure induced by @xmath381 .",
    "the sequence @xmath377 is then called a _ dismantling sequence _ of  @xmath257 on  @xmath149 .",
    "a structure has finite duality if and only if it has a retract whose square dismantles to its diagonal .",
    "let @xmath235 be a @xmath232-structure with finite duality .",
    "without loss of generality , we assume that @xmath235 is a core , so that @xmath235 has no proper retracts ; thus the square of @xmath235 dismantles to its diagonal .",
    "let @xmath382 be a dismantling sequence of @xmath383 on @xmath384 .",
    "then @xmath385 ; we want to prove that it dismantles to @xmath386 .    for @xmath387 ,",
    "define @xmath388 to be the substructure of @xmath383 induced by the set @xmath389 , and let @xmath390 .",
    "we will show that @xmath391 can be dismantled to @xmath392 , @xmath393 .",
    "let @xmath394 be an element dominating @xmath395 in @xmath388 .",
    "let @xmath396 , and assume that @xmath397",
    ". then there exists ( at least one ) @xmath398 such that @xmath399 .",
    "we define @xmath400 by @xmath401 and @xmath402 if @xmath403 .",
    "since @xmath370 dominates @xmath369 , @xmath183 is a homomorphism , and obviously @xmath404 .",
    "we claim that @xmath183 dominates @xmath5 . indeed , for @xmath260 and @xmath405 such that @xmath406 , there exists a homomorphism @xmath407 such that @xmath408 .",
    "define @xmath409 by @xmath410 and @xmath411 for @xmath412 .",
    "since @xmath370 dominates @xmath413 , the mapping  @xmath414 is a homomorphism . by hypothesis , for @xmath415 ,",
    "the image @xmath416 is disjoint from @xmath366 , whence @xmath417 , while @xmath418 .",
    "therefore @xmath419 contains all the @xmath420-tuples needed to establish the domination of  @xmath5 by  @xmath183 .",
    "let @xmath421 be an enumeration of the elements of @xmath215 .",
    "we dismantle @xmath391 to @xmath392 by successively removing the functions @xmath5 such that @xmath422 for @xmath423 . proceeding in this way for @xmath393",
    ", we get a dismantling of @xmath424 to @xmath425 .",
    "therefore @xmath292 has finite duality .",
    "perhaps the lack of knowledge of a general construction is natural since there is no restriction on the pattern @xmath245 . on the other hand ,",
    "there are many possible transformations @xmath426 on a family @xmath72 of tree obstructions , in the style of @xmath73 .",
    "any such transformation gives rise to a complete set of obstructions to homomorphisms into a structure @xmath427 ; however in general there is no way of guaranteeing that such structure @xmath17 is finite , even when @xmath72 is a complete set of obstructions for a finite structure @xmath1 .",
    "in this paper we tried to shed more light on the structure of tractable templates with tree duality .",
    "let us turn our attention one more time to fig .",
    "[ fig : diag ] .",
    "the grey areas in the diagram are areas that need a closer look in future research .",
    "currently we do not know any digraph with a near - unanimity function and with bounded - height tree duality that could not be generated using right adjoints and products , starting from digraphs with finite duality ; it is not clear whether any such `` reasonable '' class of structures with tree duality can be generated from structures with finite duality with a `` reasonable '' set of adjoint functors .",
    "equally interesting is the decidability of membership in other classes depicted in fig .",
    "[ fig : diag ] .",
    "tree duality is known to be decidable  @xcite , but not known to be in pspace .",
    "our decision procedure for bounded - height duality is in pspace for graphs with tree duality ; this suggests that checking tree duality may be harder than checking bounded height of the obstructions .",
    "the properties of near - unanimity functions proved in the proof of proposition  [ prop : dpc ] ( i ) in the context of digraphs and the arc - graph construction , also hold in the context of general structures and right adjoints .",
    "the proofs carry over naturally .",
    "d.  cohen and p.  jeavons .",
    "the complexity of constraint languages . in f.  rossi , p.  van beek , and t.  walsh , editors , _ handbook of constraint programming _ , volume  2 of _ foundations of artificial intelligence _ , chapter  8 .",
    "elsevier , 2006 .",
    "b.  larose , c.  loten , and c.  tardif .",
    "a characterisation of first - order constraint satisfaction problems . in _ proceedings of the 21st ieee symposium on logic in computer science ( lics06 ) _ , pages 201210 .",
    "ieee computer society , 2006 .",
    "a.  pultr .",
    "the right adjoints into the categories of relational systems . in _ reports of the midwest category seminar , iv _ , volume 137 of _ lecture notes in mathematics _ , pages 100113 , berlin , 1970 . springer ."
  ],
  "abstract_text": [
    "<S> a family  @xmath0 of digraphs is a _ </S>",
    "<S> complete set of obstructions _ for a digraph  @xmath1 if for an arbitrary digraph  @xmath2 the existence of a homomorphism from  @xmath2 to  @xmath1 is equivalent to the non - existence of a homomorphism from any member of  @xmath0 to  @xmath2 . </S>",
    "<S> a digraph  @xmath1 is said to have _ tree duality _ if there exists a complete set of obstructions  @xmath0 consisting of orientations of trees . </S>",
    "<S> we show that if @xmath1  has tree duality , then its arc graph  @xmath3 also has tree duality , and we derive a family of tree obstructions for  @xmath3 from the obstructions for  @xmath1 .    </S>",
    "<S> furthermore we generalise our result to right adjoint functors on categories of relational structures . </S>",
    "<S> we show that these functors always preserve tree duality , as well as polynomial csps and the existence of near - unanimity functions .    </S>",
    "<S> * keywords : * constraint satisfaction , tree duality , adjoint functor    * 2000 mathematics subject classification : * 16b50 , 68r10 , 18a40 , 05c15 </S>"
  ]
}