{
  "article_text": [
    "we shall assume that an observable quantity @xmath0 is a function of the state of a continuous - time , low - dimensional dynamical system , whose time evolution is confined on a strange attractor ( that is , we explicitly discard transient behavior ) . both the explicit form of the equations governing the dynamical system and the function which links its state to the signal @xmath1 may be unknown .",
    "we also assume that an instrument samples @xmath1 at regular intervals of length @xmath2 , yelding an ordered set of @xmath3 data @xmath4 if , for any cause , the instrument is unable to record the value of @xmath0 for a number of times , there will be some invalid entries in the time series @xmath5 , for some values of the index @xmath6 .    from the time series",
    "@xmath5 we reconstruct the underlying dynamics with the technique of delay coordinates .",
    "that is , we shall invoke takens theorem @xcite and claim that the @xmath7-dimensional vectors @xmath8 lie on a curve in @xmath9 which is diffeomorph to the curve followed in its ( unknown ) phase space by the state of the dynamical system which orginated the signal @xmath1 . here",
    "@xmath10 is a positive integer , and @xmath6 now runs only up to @xmath11 .",
    "severals pitfalls have to be taken into account in order to choose the most appropriate values for @xmath7 and @xmath10 .",
    "strong constraints also come from the length of the time series , compared to the characteristic time scales of the dynamical system , and from the amount of instrumental noise which affects the data .",
    "we shall not review these issues here , but address the reader to references @xcite .",
    "we note that gaps ( that is , invalid entries ) in the time series @xmath12 do not prevent a successful reconstruction of a set @xmath13 of state vectors , unless the total width of the gaps is comparable with @xmath3 .",
    "we simply mark as `` missing '' any reconstructed vector @xmath14 whose components are not all valid entries .",
    "if the valid vectors of @xmath15 sample well enough the underlying strange attractor embedded in @xmath9 , one may hope to find , by means of a suitable interpolation technique , a vector field @xmath16 , such that within an open set @xmath17 of @xmath9 containing all the vectors @xmath14 , the observed dynamics can be approximated by @xmath18 this very idea is at the base of several forecasting schemes , where one takes the last observed vector @xmath19 as the initial condition for equation ( [ eq : rec_dyn_sys ] ) , and integrates it forward in time ( see e.g. , @xcite ) .",
    "the gap - filling problem was framed in terms of forecasts by serre _ et .",
    "their method , which amounts to a special form of the shooting algorithm for boundary value problems , is limited by the predictability properties of the dynamics , and can not fill gaps of arbitrary width .",
    "the rest of this note is organized as follows : in section [ sec : a - variational - approach ] we cast the problem as a variational one , where a functional measures how well a candidate filling trajectory agrees with the vector field defining the observed dynamics . then an algorithm is proposed for finding a filling trajectory . in section [ sec : an - example ] we give an example of what can be obtained with this method . finally , we discuss the algorithm and offer some speculations on future works in sec .",
    "[ sec : discussion ] .",
    "the source of all difficulties of gap - filling comes from the following constraint : the interpolating curve , which shall be as close as possible to a solution of ( [ eq : rec_dyn_sys ] ) , must start at the last valid vector before the gap and reach the first valid vector after the gap in a time @xmath20 which is prescribed .    to properly satisfy this constraint",
    ", we propose to frame the problem of filling gaps as a variational one .",
    "we are looking for a differentiable vector function @xmath21\\rightarrow u$ ] which minimizes the continuous functional @xmath22 with @xmath23 defining @xmath24 , we have @xmath25 if the curve @xmath26 coincided with the missing curve @xmath27 for @xmath28 $ ] , and @xmath29 where a perfect reconstruction of the vector field governing the dynamics of the system , then the functional would reach its absolute minimum @xmath30 .",
    "the imperfect nature of @xmath29 suggests that any curve which makes @xmath31 small enough can be considered , on the basis of the available information , a surrogate of the true ( missing ) curve . in section [ sec : an - example ] we shall offer a simple criterion to quantify how small is `` small enough '' . for the moment we only care to remark",
    "that , even for a perfect reconstruction of the vector field , a curve @xmath32 making @xmath31 abitrarily small , but not zero , need not to approximate @xmath27 , in fact , the two curves may be quite different ; however , such a curve @xmath32 is consistent with the dynamics prescribed by ( [ eq : rec_dyn_sys ] ) .",
    "most methods for minimizing functionals focus on approaching as quickly as possible the local minimum closest to an initial guess . because we may confidently assume that @xmath31 has many relative minima far away from zero",
    ", we expect that these algorithms will fall on one of these uninteresting minima for most choices of the initial guess .",
    "thus , our problem really reduces to that of finding a suitable initial guess .",
    "the complexity of the problem is greatly limited if we require that the set @xmath33 , whose @xmath34 elements sample the initial guess , has to be a subset of the set @xmath15 of reconstructed vectors .",
    "the index @xmath35 does not necessarily follow the temporal order defined in @xmath15 by the index @xmath6 ( cfr .",
    "( [ eq : index_i ] ) ) , but we require that @xmath36 and @xmath37",
    ". we shall denote with @xmath38 the successor of the vector @xmath39 with respect to the temporal order in @xmath15 , and with @xmath40 its predecessor .",
    "we propose that a good choice for the set @xmath41 is one which makes as small as possible the following discretized form of the functional @xmath31 : @xmath42 of course , we shall restrict our choice of vectors to be included in @xmath41 only to valid vectors of @xmath15 having valid predecessor and successor .",
    "@xmath43 could be zero if and only if @xmath41 cointained all the missing vectors in the correct order : @xmath44 .",
    "the value of @xmath43 increases every time that the order according to the @xmath45-index is different from the natural temporal order , that is , every time that @xmath46 or @xmath47 .",
    "if this happens we say that there is a _ jump _ in @xmath41 between , respectively , the position @xmath45 and @xmath48 , or @xmath45 and @xmath49 .",
    "although a set @xmath41 which performs many very small jumps may conceivably attain a very low value of @xmath43 , there is an exceedingly small probability to find it within a finite dataset .",
    "an intuitive demonstration of this statement comes from the histogram in figure [ cap : distance - histo ] , which shows the distribution of distancies between each reconstructed vector and its closest neighbor for the dataset discussed in section [ sec : an - example ] : as expected the frequency of closest neighbors quickly drops to zero for short distancies .",
    "then our strategy will be that of looking for a set @xmath41 which performs as few jumps as possible .",
    "let us call _ orbit _ any sequence of valid vectors which does not jump .",
    "the first vector of an orbit shall have a valid predecessor , and the last a valid successor .",
    "thus we define the _ predecessor of the orbit _ as the predecessor of its first vector and likewise the _ successor of the orbit _ as the successor of its last vector .",
    "we say that an orbit is _ consecutive _ to a point if its successor or its predecessor is the closest neighbor of the point .",
    "two orbits are _ consecutive _ if the successor of one orbit is the closest neighbor of the first vector of the other orbit , or if the predecessor of one orbit is the closest neighbor of the last vector of the other orbit .",
    "let us call _ branch _ a set made of consecutive orbits .",
    "below we describe a simple algorithm to construct a set @xmath41 by joining together one or more consecutive orbits .    1 .",
    "we follow forward in time the orbit consecutive to @xmath50 for @xmath51 steps , or until it has a valid successor .",
    "we store away the set of points made of @xmath50 followed by the points of this orbit as the @xmath52__-jump _ _ _ forward branch_. 2 .",
    "[ enu : forward]for each point @xmath39 of each @xmath53__-jumps _ _ forward branch ( where @xmath54 , @xmath55 is an arbitrary stride , @xmath56 is the number of points in the forward branch , and @xmath57 , ) , we follow forward in time the orbit consecutive to @xmath39 for @xmath58 steps , or until it has a valid successor .",
    "we store away all the points up to @xmath39 of the current forward branch followed by the points of the consecutive orbit as one of the @xmath59__-jumps _ _ forward branches . 3 .",
    "we repeat step [ enu : forward ] for a fixed number @xmath60 of times .",
    "4 .   we follow backward in time the orbit consecutive to @xmath61 for @xmath51 steps , or until it has a valid predecessor .",
    "we store away the points of the consecutive orbit followed by @xmath61 as the @xmath52__-jump backward branch__. 5 .",
    "[ enu : backward]for each point @xmath62 of each @xmath53__-jumps _ _ backward branch ( where @xmath63 , @xmath55 is an arbitrary stride , @xmath64 is the number of points in the backward branch , and @xmath65 ) , we follow backward in time the orbit consecutive to @xmath62 for @xmath45 steps , or until it has a valid predecessor .",
    "we store away all the points of this orbit followed by all the points from @xmath62 to the end of the current backward branch as one of the @xmath59__-jumps _ _ backward branches .",
    "we repeat step [ enu : backward ] a fixed number @xmath66 of times .",
    "7 .   for all possible pairs made by one forward branch and one backward branch",
    "we examine _ synchronous _ pairs of points , that is a point @xmath67 in the forward branch , and a point @xmath68 in the backward branch such that @xmath69 , where @xmath64 is the number of points in the backward branch .",
    "if they coincide , or one is the closest neighbour of the other , then we define @xmath70 .",
    "the presence of jumps in @xmath41 makes it unsuitable as a filling set for the gap .",
    "furthermore , the discretized form ( [ eq : functional_j0 ] ) of the functional ( [ eq : functional_j ] ) is meaningful only if its arguments @xmath71 are a subset of the set of reconstructed vectors @xmath15 .",
    "then we need a different discretization of ( [ eq : functional_j ] ) which allows as argument any point of @xmath17 .",
    "the simplest among many possibilities relies on finite differences , leading to the following expression @xmath72^{2}\\label{eq : func_j1}\\ ] ] where the vectors @xmath73 may or may not belong to @xmath15 , and @xmath35 . here @xmath74 is the vector field @xmath29 evaluated at the midpoint between @xmath75 and @xmath73 .",
    "@xmath76 is a function of @xmath77 real variables ( @xmath78 and @xmath79 shall be kept fixed ) , which can be minimized with standard techniques , using @xmath41 as the initial guess .",
    "in this section we show how the algorithm described above performs on a time series generated by a chaotic attractor .",
    "we numerically integrate the lorenz equations @xcite with the usual parameters ( @xmath80 , @xmath81 , @xmath82 ) .",
    "we sample the @xmath83variable of the equations with an interval @xmath84 , collecting @xmath85 consecutive data points which are our time series .",
    "one thousand consecutive data points are then marked as `` not - valid '' , thus inserting in the time series a gap with a width of 1/5th of the series length , corresponding to a time @xmath86 . for this choice of parameters",
    "the lorenz attractor has a positive lyapunov exponent @xmath87 @xcite , setting the lyapunov time scale at @xmath88 .",
    "we also find that the autocorrelation function of the time series drops to negligible values in about 3 time units .",
    "we conclude that @xmath20 is well beyond any realistic predictability time for this time series .    in the present example we selected the embedding delay @xmath89 simply by visual inspection of the reconstructed trajectory , and we choose an embedding dimension @xmath90 .",
    "however , we checked that results are just as satisfactory up to ( at least ) embedding delay @xmath91 , and embedding dimension @xmath92 .",
    "we apply the algorithm with @xmath93 and @xmath94 .",
    "the strides are @xmath95 for the 2-jumps forward orbits and @xmath96 for the 3-jumps forward orbits .",
    "this leads to 11001 forward orbits to be compared with 1 backward orbit , looking for synchronous pairs points which are neighbour of each other .",
    "we find two such pair of points , and the corresponding two initial guesses @xmath97 and @xmath98 are such that @xmath99 and @xmath100 .",
    "the approximating vector field @xmath29 is extremely simple , and its choice is dictated solely by ease of implementation .",
    "a comparison between different interpolating techniques is off the scope of this paper , and the interested reader may find further information in @xcite . if @xmath101 and @xmath102 are the vectors of @xmath15 , respectively , closest and second closest to @xmath73 , then we define @xmath103 using the definition ( [ eq : my - interpol ] ) in ( [ eq : func_j1 ] ) , we obtain @xmath104 and @xmath105 . in order to smooth - out the jumps in the filling sets , the function @xmath76 is further decreased by iterating five times a steepest - descent line minimization ( see , e.g. , @xcite ) using @xmath97 and @xmath98 as initial guesses .",
    "this procedure yelds two sets of @xmath34 points , @xmath106 and @xmath107 such that @xmath108 , and @xmath109 .",
    "the corresponding time series are shown in figure [ cap : fillings ] .",
    "the difference between the smoothed sets @xmath106 and @xmath107 plotted in figure [ cap : fillings ] and the sets with jumps @xmath97 and @xmath98 would be barely noticeable on the scale of the plot .",
    "the effect of the smoothing may be appreciated by looking at figure [ cap : smoothing ] which shows the region across the jump between two consecutive orbits of @xmath97 .",
    "the non - smoothed filling set ( dashed line ) abruptly jumps from one orbit to the other , but the smoothed trajectory ( thick solid line ) singled out by the points of @xmath106 gently moves between them .",
    "no attempt has been made to approach as closely as possible the local minimum of @xmath76 .",
    "in fact , we verified that for orbits in @xmath15 having the same length as the interpolating sets @xmath106 and @xmath107 , @xmath76 ranges ( roughly ) between 1 and 9 .",
    "this is a measure of the accuracy with wich the field @xmath29 approximates the true dynamics of the observed system , and there is no point in looking for an interpolating set having a value of @xmath76 below this range .",
    "in this note we have described an algorithm which fills an arbitrarily wide gap in a time series , provided that the dynamic reconstruction method of takens is applicable .",
    "the goal is to provide a filling signal which is consistent with the observed dynamics , in the sense that , in the reconstructed phase space , the vector tangent to the filling curve should be close to the vector field modeling the observed dynamics .",
    "this request is cast as a variational problem , defined by the functional ( [ eq : functional_j ] ) .",
    "the acceptable degree of closeness is determined by the level of accuracy of the reconstruction , which we quantify by computing the discretized form ( [ eq : func_j1 ] ) of the functional for orbits having the same length of the gap .",
    "obviously , if the time series has more than one gap , our method can be applied to all the gaps , indipendently from each other .    a second novel idea , that greatly simplyfies the problem , is that of building a rough solution by stitching together pieces of the observed dataset .",
    "the actual solution , which will not be an exact copy of anything present in the observed dataset , is obtained by refining this first draft .",
    "we have illustrated a basic algorithm that embodies this idea , although no attempt has been made at making it computationally optimal .",
    "in particular , with the algorithm in its present form , many of the forward and backward branches will be partial copies of each other , because nothing forbids two distinct branches to jump on the same orbit .",
    "this leaves some room for improvement , because the effectiveness of the method relies on a substantial amount of the set @xmath15 of reconstructed vectors to be explored by a relatively limited number of branches . in a forthcoming , enhanced version of the algorithm some kind of tagging mechanism",
    "shall be incorporated in order to produce non - overlapping hierarchies of forward and backward branches .",
    "we observe that this algorithm does not give a guarantee of success : it is perfectly possible that no point of the forward branches is the closest neighbor of ( or coincides with ) a synchronous point of the backward branches . in this case",
    "the obvious attempt is to deepen the hierarchy of the branches , as much as it is computationally feasible . or",
    ", one may relax the request that branches may jump only between closest neighbors , and accept jumps between second or third neighbors as well . as a last resort",
    ", one may stitch any pair of forward and backward branches at their closest synchronous points , hoping that the resulting jump could later be smoothed satisfactorily by minimizing the function ( [ eq : func_j1 ] ) .",
    "however , when facing a failure of the algorithm , we believe that first should be questioned the goodness and appropriateness of the dynamic reconstruction",
    ". the presence of too many gaps , the shortness of the time series , or measurement inaccuracies may make the gap - filling problem an insoluble one .",
    "we speculate that the ability of filling gaps with relative ease is a a way to test the goodness of a dynamic reconstruction .",
    "the ease with which a gap may be filled , as a function of his width , is a problem deserving further work . for the moment we simply recall that if a set of initial conditions of non - zero measure is evolved in time according to ( [ eq : rec_dyn_sys ] ) , eventually we expect it to spread everywhere on the attractor ( here the measure is the physical measure @xmath110 of the attractor cfr .",
    "@xcite ) . more rigorously , if @xmath111 is the flow associated to ( [ eq : rec_dyn_sys ] ) , and if it is a mixing transformation , then , for any pair of sets @xmath112 , @xmath113 of non - zero measure , @xmath114 .",
    "the dispersion of a set of initial conditions is further discussed in @xcite , where , for example , it is shown that the essential diameter of a set of initial conditions can not decrease in time , after an initial transient of finite length .",
    "this leads to the idea that wide gaps should be easier to fill than not - so - wide ones , because forward and backward branches have explored larger portions of the attractor , and so there is a greater chance to find synchronous points where they can be joined together . as a first step toward the verification of this hypotesis , we computed the average minimum distance between synchronous points of the 1-jump forward and backward branch as the gap moves along the dataset , for several gap widths .",
    "we used the dataset discussed in sec .",
    "[ sec : an - example ] and a ten times longer extension of it .",
    "the results , plotted in figure [ cap : gap - vs - dist ] , show that the average separation of the branches initially increases as the gap widens , but then it reaches a well - defined maximum and , from there on , decreases as the gap width is further increased .",
    "we close by mentioning that the dynamic reconstruction technique has been successfully applied even to stationary stochastic time series , to generate surrogate data with the same statistics of the observed ones @xcite .",
    "this fact , and the hypothesis that ergodicity ( or the stronger requirement of being mixing ) , rather than determinism , is the crucial property that allows for filling gaps , suggest that some modified version of our method should be able to fill gaps in a large class of stochastic time series .",
    "this work has been supported by _ fondo convezione strana _ of the department of mathematics of the university of lecce .",
    "we are grateful to prof .",
    "carlo sempi for valuable comments .",
    "90 f. takens , in _ dynamical systems and turbulence _ , r. ma , d. rand , and l. s. young ( eds . ) , warwick 1980 , _ lecture notes in math .",
    "_ ( springer , berlin , 1981 ) , vol .",
    "t. sauer , j. a. yorke , and m. casdagli , j. stat .",
    "phys . , * 65 * , 579 , ( 1991 )",
    ". m. casdagli , s. eubank , j. d. farmer , and j. gibson , physica d , * 51 * , 52 , ( 1991 ) .",
    "a. provenzale , l.a .",
    "smith , r. vio , and g. murante , physica d , * 58 * , 31 , ( 1992 ) .",
    "j. theiler , phys .",
    "a , * 34 * , 2427 , ( 1986 ) . j. froyland and k. h. alfsen , phys .",
    "rev . a , * 29 * , 2928 , ( 1984 ) .",
    "m. casdagli , physica d , * 35 * , 335 , ( 1989 ) .",
    "j. d. farmer and j. j. sidorowich , phys .",
    "* 59 * , 845 , ( 1987 ) .",
    "t. serre , m. auvergne , and m. j. goupil , astron .",
    "astrophys . , * 259 * , 404 , ( 1992 )",
    ". e. n. lorenz , j. atmos .",
    ", * 20 * , 130 , ( 1963 ) . w. h. press , s. a. teukolsky , w. t. vetterling , and b. p. flannery , _ numerical recipes in c : the art of scientific computing _ , cambridge university press , cambridge , ( 1992 ) .",
    "eckmann and d. ruelle , * 57 * , 617 , ( 1985 ) .",
    "t. erber , b. schweizer , and a. sklar , commun .",
    "* 29 * , 311 , ( 1973 ) .",
    "f. paparella , a. provenzale , l. a. smith , c. taricco , r. vio , phys .",
    "a , * 235 * , 233 , ( 1997 ) .",
    "* figure [ cap : distance - histo ] * distibution of the distances between each reconstructed vector and its closest neighbor for the dataset discussed in sec .",
    "[ sec : an - example ] .",
    "* figure [ cap : fillings ] * panel a ) shows portion of the time series discussed in sec . [ sec : an - example ] .",
    "the blackened line was removed and the resulting gap was filled by applying the algorithm described in section [ sec : a - variational - approach ] .",
    "the blackened lines in panels b ) and c ) are two different fillings .",
    "* figure [ cap : smoothing ] * plot of the first two components of the reconstructed vectors of : @xmath106 ( thick solid line with crosses ) ; @xmath97 ( thick dashed line with asterisks ) ; one orbit of @xmath97 and its successors ( thin line with open circles ) ; the orbit consecutive to it and its predecessors ( thin line with open squares ) . to illustrate the smoothing effect of minimizing functional ( [ eq : func_j1 ] ) , we only plot a very small portion of these sets in the vicinity of the jump between the consecutive orbits .",
    "* figure [ cap : gap - vs - dist ] * average minimum distance of sinchronous points in the 1-jump forward and backward branch as a function of gap width .",
    "the dashed line refers to the dataset discussed in sec .",
    "[ sec : an - example ] , the solid line refers to a ten times longer extension of that dataset .",
    "the vertical line marks the lyapunov time @xmath115 .      .",
    "the blackened line was removed and the resulting gap was filled by applying the algorithm described in section [ sec : a - variational - approach ] .",
    "the blackened lines in panels b ) and c ) are two different fillings .",
    "[ cap : fillings ] ]     ( thick solid line with crosses ) ; @xmath97 ( thick dashed line with asterisks ) ; one orbit of @xmath97 and its successors ( thin line with open circles ) ; the orbit consecutive to it and its predecessors ( thin line with open squares ) . to illustrate the smoothing effect of minimizing functional ( [ eq : func_j1 ] )",
    ", we only plot a very small portion of these sets in the vicinity of the jump between the consecutive orbits .",
    "[ cap : smoothing ] ]"
  ],
  "abstract_text": [
    "<S> we propose a method for filling arbitrarily wide gaps in deterministic time series . </S>",
    "<S> crucial to the method is the ability to apply takens theorem in order to reconstruct the dynamics underlying the time series . </S>",
    "<S> we introduce a functional to evaluate how compatible is a filling sequence of data with the reconstructed dynamics . an algorithm for minimizing the functional with a reasonable computational effort </S>",
    "<S> is then discussed .    </S>",
    "<S> * one problem faced by many practitioners in the applied sciences is the presence of gaps ( i.e. sequences of missing data ) in observed time series , which makes hard or impossible any analysis . </S>",
    "<S> the problem is routinely solved by interpolation if the gap width is very short , but it becomes a formidable one if the gap width is larger than some time scale characterizing the predictability of the time series . *    * if the physical system under study is described by a small set of coupled ordinary differential equations , then a theorem by takens @xcite suggests that from a single time series is possible to build - up a mathematical model whose dynamics is diffeomorph to that of the system under examination . in this paper </S>",
    "<S> we leverage the dynamic reconstruction theorem of takens for filling an arbitrarily wide gap in a time series . </S>",
    "<S> *    * it is important to stress that the goal of the method is not that of recovering a good approximation to the lost data . </S>",
    "<S> sensitive dependence on initial conditions , and imperfections of the reconstructed dynamics , make this goal a practical impossibility , except for some special cases , such as small gap width , or periodic dynamics . </S>",
    "<S> we rather aim at giving one or more surrogate data which can be considered _ </S>",
    "<S> compatible _ with the observed dynamics , in a sense which will be made rigorous in the following . * </S>"
  ]
}