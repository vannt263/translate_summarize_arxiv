{
  "article_text": [
    "let @xmath3 be a family of graphs .",
    "then we say that a graph is _",
    "@xmath3-free _ if it contains no member of @xmath3 as a ( not necessarily induced ) subgraph .",
    "we define the _ turn number _ @xmath16 to be the maximum number of edges possible in a @xmath3-free graph on @xmath14 vertices .",
    "when @xmath17 consists of a single forbidden graph we denote the turn number by @xmath18 . a classical theorem of turn @xcite gives an exact result for @xmath19 , where @xmath20 is the complete graph on @xmath21 vertices : the unique largest @xmath20-free graph on @xmath14 vertices is the complete @xmath22-partite graph with part sizes as equal as possible . in general , erds , stone and simonovits",
    "@xcite showed that @xmath23 , where @xmath24 .",
    "here we write @xmath25 for functions @xmath26 if @xmath27 .",
    "this determines the turn number asymptotically when @xmath28 consists only of non - bipartite graphs .",
    "furthermore , erds and simonovits  @xcite proved that the error term is zero if the family @xmath3 contains an edge - critical @xmath29-chromatic graph ( i.e. one from which one edge can be removed to decrease the chromatic number ) . for more general families @xmath3 the error term is necessary , and the complete balanced @xmath21-partite graph is not extremal . in that case , it turns out that the error term is controlled by turn numbers for bipartite graphs  @xcite . the major open problem in the area , then , is to determine the behavior of @xmath16 for families @xmath3 including bipartite graphs .      the problem of determining @xmath16 when @xmath3 contains bipartite graphs seems in general to be very hard : in almost all cases we do not know the order of magnitude of @xmath16 . in a seminal paper  @xcite , erds and",
    "simonovits made a number of broad conjectures on turn numbers for bipartite graphs .",
    "in particular ( see conjecture 2 in  @xcite ) they made the following conjecture :    [ firstconj ] for every finite nonempty family @xmath3 of graphs , there exist @xmath30 such that @xmath31    erds and simonovits  @xcite stated that @xmath32 should furthermore be rational , in agreement with all the cases where @xmath32 is known to exist .",
    "when @xmath32 exists , we refer to @xmath32 as the _ exponent _ of @xmath3 .",
    "the lack of good constructive lower bounds for @xmath16 is a major impediment to determining exponents of families of bipartite graphs .",
    "it appears unlikely that the order of magnitude of @xmath18 , let alone the existence of the exponent of @xmath33 , will ever be determined for every bipartite graph @xmath33 . even for specific graphs such as the complete bipartite graph @xmath34 , the cycle of length eight @xmath35 , and the three - dimensional cube graph @xmath36 , the order of magnitude of @xmath18 is not known .      in this paper",
    ", we study a conjecture of erds and simonovits  @xcite concerning turn numbers for families @xmath3 containing bipartite graphs and odd cycles .",
    "let @xmath37 be the family of all odd cycles of length at most @xmath0 , and let @xmath38 denote the maximum size of a bipartite @xmath14-vertex @xmath3-free graph .",
    "the general theme is that extremal @xmath3-free graphs should be near - bipartite if @xmath3 contains a long enough odd cycle as well as bipartite graphs .",
    "precisely , erds and simonovits made the following conjecture ( conjecture 3 in  @xcite ) :    [ esc ] given any finite family @xmath3 of graphs , there exists @xmath0 such that as @xmath5 , @xmath39    this is certainly true from the erds - stone - simonovits theorem  @xcite when @xmath3 consists only of non - bipartite graphs , moreover it is shown that the extremal @xmath40-free graphs are exactly bipartite if @xmath14 is large enough  @xcite .",
    "conjecture  [ esc ] is proved in  @xcite for @xmath41 when @xmath42 , and again the extremal graphs are shown in  @xcite to be bipartite graphs : the bipartite incidence graphs of rank two geometries called generalized polygons  @xcite .",
    "the case @xmath6 with @xmath43 was settled earlier by erds and simonovits  @xcite .    in the present paper , we give a general approach which proves the conjecture for all families of bipartite graphs which are known to be _ smooth _ ( in a sense which is defined below ) using a sparse version of szemerdi s regularity lemma .",
    "it is convenient for the next definition to denote by @xmath44 the maximum number of edges in an @xmath15 by @xmath14 bipartite @xmath3-free graph . in what follows ,",
    "all asymptotic notation is with respect to @xmath14 .",
    "let @xmath45 be reals with @xmath46 .",
    "a family @xmath3 of bipartite graphs is @xmath47-smooth if for some @xmath48 and every @xmath49 , @xmath50    it is a consequence of the kvri - ss - turn theorem  @xcite that @xmath51 for every family @xmath3 of bipartite graphs .",
    "we say @xmath3 is _ smooth _ if @xmath3 is @xmath47-smooth for some @xmath52 , and @xmath47-smooth with _ relative density _",
    "@xmath53 when we wish to refer to the limit density .",
    "if @xmath3 is smooth and consists of a single graph @xmath33 , then we use the terminology _",
    "@xmath33 is smooth_. conjecture [ firstconj ] perhaps suggests that every finite family of graphs is smooth ",
    "smoothness should be seen as a bipartite version of conjecture [ firstconj ] together with some control on the error term implicit in the limit . in this paper , we study smooth families of graphs and use smoothness as a broad framework under which conjecture [ esc ] might be proved .",
    "single bipartite graphs which are known to be smooth include @xmath7 for @xmath54 and @xmath8 , however , even the cycle @xmath55 of length six is not known to be smooth .",
    "a family @xmath56 of graphs is _ near - bipartite _ if every @xmath14-vertex graph @xmath57 has a bipartite subgraph @xmath58 with @xmath59 as @xmath5 . to prove conjecture [ esc ] for a family @xmath3",
    ", it is enough to show every extremal @xmath40-free family of graphs is near - bipartite for some odd @xmath0 , for then @xmath60 .",
    "our main theorem proves this strengthening of the erds - simonovits conjecture for smooth families of bipartite graphs :    [ thm : extcycle ] let @xmath3 be an @xmath47-smooth family with @xmath61 .",
    "there exists @xmath62 such that if @xmath63 is odd , then every extremal @xmath40-free family of graphs is near - bipartite .",
    "the theorem settles conjecture  [ esc ] in a strong sense for smooth families , namely that the omission of any single odd cycle is enough to force extremal @xmath3-free families of graphs to be nearly bipartite , whereas the condition of conjecture  [ esc ] is to avoid all short odd cycles .",
    "the closer the value of @xmath64 to @xmath32 , however , the larger the lower bound on @xmath0 , the length of the shortest odd cycle we can find .",
    "the proof of theorem [ thm : extcycle ] is a novel application of a recent sparse version of szemerdi s regularity lemma due to scott  @xcite .",
    "we note that ( despite the use of regularity ) the value of @xmath62 we obtain is not large  for all the smooth families we know , it is less than @xmath65 .",
    "we also ask whether the extremal @xmath14-vertex @xmath40-free graphs in theorem [ thm : extcycle ] are exactly bipartite when @xmath14 is large enough .",
    "so far this is not known , even for @xmath66 with @xmath67 , which is @xmath68-smooth . here",
    "we give some evidence that extremal @xmath40-free graphs are indeed bipartite , by proving the following andrsfai - erds - ss type theorem , which verifies this provided the minimum degree of an extremal graph is not too small .",
    "[ thm : aes ] let @xmath3 be an @xmath47-smooth family with @xmath69",
    ". then there exists @xmath62 such that for all odd @xmath70 and @xmath14 sufficiently large the following is true . if @xmath71 is an @xmath14-vertex @xmath40-free graph with minimum degree at least @xmath72 then @xmath71 is bipartite .",
    "theorem [ thm : extcycle ] reduces the erds - simonovits conjecture to showing that a family of bipartite graphs is smooth .",
    "we shall now see that certain complete bipartite graphs are smooth .",
    "fredi  @xcite showed that if @xmath73 , and @xmath74 , then @xmath75 if @xmath76 or @xmath77 , this upper bound is matched up to a difference of @xmath78 by constructions of brown  @xcite and fredi  @xcite , so in these cases , @xmath79 is @xmath80-smooth .",
    "it follows from theorem [ thm : extcycle ] that the erds - simonovits conjecture holds for the complete bipartite graphs @xmath7 and @xmath8 , and we obtain the following result :    [ thm : kst ] let @xmath9 be an odd integer . if @xmath76 and @xmath54 , or @xmath81 , then @xmath82 and any extremal @xmath3-free @xmath83-free graph is near - bipartite .",
    "this theorem is a direct consequence of theorem [ thm : extcycle ] and the smoothness of @xmath79 for @xmath76 and @xmath81 , except that the assumption @xmath9 is weaker than the assumption on @xmath0 in theorem [ thm : extcycle ] . for @xmath84 , the order of magnitude of @xmath85",
    "is known to be @xmath86 according to a construction of alon , rnyai and szab  @xcite , superseding an earlier construction of kollr , rnyai and szab  @xcite .",
    "however , the asymptotic behavior of @xmath87 is not known for any @xmath88 and @xmath89 , and the order of magnitude of @xmath85 is not known in general . in the event that @xmath79 is @xmath90-smooth for",
    "any given @xmath91 and @xmath92 , theorem [ thm : kst ] would extend to prove the erds - simonovits conjecture for @xmath79 with the condition @xmath93 .",
    "a natural question is whether it is also possible that theorems [ thm : extcycle ] and [ thm : kst ] could hold for shorter odd cycles , in particular for triangles  the case @xmath11 in both theorems . in the case",
    "@xmath94 , it is an old conjecture of erds  @xcite that any extremal @xmath14-vertex graph of girth five has @xmath95 edges  in particular the bipartite incidence graph of a projective plane with @xmath14 points has that many edges .",
    "however , we are able to show that for all odd @xmath96 , the extremal function @xmath97 is not asymptotic to @xmath98 .",
    "[ thm : k23 ] for each @xmath99 , @xmath100    in particular the ratio is @xmath101 for @xmath102 . in light of this",
    ", we make the opposite conjecture to erds :    @xmath103    in  @xcite , it is shown that conjecture  [ esc ] does not extend to @xmath11 when @xmath104 and does not extend to @xmath105 when @xmath106 . determining the smallest value of @xmath107 for which the conjecture could hold is an interesting open problem",
    "in this section we describe a version of szemerdi s regularity lemma which can be usefully applied to extremal @xmath3-free graphs .      given an @xmath14-vertex graph @xmath71 and disjoint vertex subsets @xmath108 and @xmath109 , the _ density _ of the pair @xmath110 is @xmath111 .",
    "we say that @xmath110 is _ @xmath112-regular _ if we have @xmath113 for every pair @xmath114 and @xmath115 with @xmath116 and @xmath117 .",
    "we say a partition @xmath118 is _",
    "@xmath112-regular _ if @xmath119 , @xmath120 , and all but at most @xmath121 of the pairs @xmath122 with @xmath123 $ ] are @xmath112-regular .",
    "the celebrated szemerdi regularity lemma  @xcite states that for every @xmath124 there exists @xmath125 such that every graph @xmath71 possesses an @xmath112-regular partition whose number of parts is between @xmath126 and @xmath125 . a key definition in the proof is the _ energy function _ of a partition @xmath127 of @xmath128 , which is @xmath129    the proof consists of showing that either @xmath127 is an @xmath112-regular partition of @xmath71 , or there is a refinement of @xmath127 with at most @xmath130 parts whose energy is increased by at least @xmath131 over that of @xmath127 . since the energy of any partition is bounded by @xmath132 , the result follows .",
    "unfortunately , szemerdi s regularity lemma in the above framework is useless for our purposes : @xmath79-free graphs have @xmath133 edges , and hence the densities of all pairs in the partition will be very close to zero .      for sparse graphs , kohayakawa  @xcite and independently rdl ( unpublished ) defined the notion of relative density and @xmath134-regular partitions where @xmath135 $ ] .",
    "here , @xmath71 is a graph and @xmath108 and @xmath109 are disjoint non - empty subsets of vertices of @xmath71 .",
    "given @xmath136 , the _ relative density _ of the pair @xmath110 is @xmath137 .",
    "the pair @xmath110 is _",
    "@xmath134-regular _ if @xmath138 for every pair @xmath114 and @xmath115 with @xmath116 and @xmath139 .",
    "a partition @xmath118 is called _ @xmath134-regular _ if @xmath119 , @xmath120 , and all but at most @xmath121 of the pairs @xmath122 with @xmath140 $ ] are @xmath134-regular .",
    "kohayakawa  @xcite and rdl proved that for any function @xmath141 , @xmath124 and @xmath142 there exist @xmath125 and @xmath143 such that if @xmath71 is an @xmath14-vertex graph for which the relative density @xmath144 is at most @xmath142 whenever @xmath108 and @xmath109 are disjoint vertex sets of size at least @xmath145 , then @xmath71 has an @xmath134-regular partition whose number of parts is between @xmath126 and @xmath125 . for this proof",
    ", the energy function @xmath146 is defined , and is observed to be bounded by @xmath142 whenever @xmath127 contains no small parts ; the remainder of the proof is virtually identical to the original proof of szemerdi .",
    "unfortunately , @xmath79-free graphs with @xmath147 edges and @xmath148 need not satisfy the condition given by kohayakawa and rdl . for complete bipartite graphs",
    "this is not a major issue : one can use instead the following bound on the energy function of a partition , from which the desired regularity lemma follows .",
    "[ lem : energybound ] let @xmath149 .",
    "let @xmath71 be a @xmath79-free graph and @xmath127 a partition of @xmath128 with no parts of size smaller than @xmath150 .",
    "then we have @xmath151 .",
    "let @xmath71 be an @xmath14-vertex @xmath79-free graph , and @xmath127 a partition of @xmath128 with no parts containing fewer than @xmath150 vertices .",
    "given part @xmath152 we have @xmath153 using that @xmath71 is @xmath79-free in the second step and jensen s inequality at the third step .",
    "observe that since @xmath154 , if @xmath155 then @xmath156 .",
    "ignoring terms with @xmath157 , we have @xmath158 and thus @xmath159    finally , since @xmath160 for all @xmath161 and @xmath162 for all @xmath163 , we have @xmath164 as required .",
    "however , scott  @xcite has recently shown that ( perhaps surprisingly ) we need assume no conditions at all on @xmath71 to obtain a sparse - regular partition , and it is convenient to simply use this result to prove our main theorems . to the best of our knowledge ,",
    "this is the first application of scott s regularity lemma .",
    "[ lem : sparsereg ] * ( sparse regularity lemma ) * given @xmath124 and @xmath165 , there exists @xmath166 such that if @xmath71 is any graph with at most @xmath167 edges , then @xmath71 has an @xmath134-regular partition whose number of parts is between @xmath126 and @xmath168 .",
    "briefly , scott s proof rests on his observation that the kohayakawa - rdl proof fails for general graphs because it is possible for @xmath169 to be large due to a small number of dense pairs in @xmath127 , and thus no good enough bound on @xmath170 for that proof to work can hold .",
    "scott s solution is to define a new energy function , replacing @xmath171 with @xmath172 for some large constant @xmath173 .",
    "this has the effect of ` discounting ' very dense pairs , so that the new energy function can be proven to be bounded ( by @xmath174 ) : of course , it also means that refining these very dense pairs in a non-@xmath134-regular partition no longer contributes to increasing the energy function , but , crucially , there are few such dense pairs and thus an energy increase of @xmath175 is still guaranteed . to facilitate use of lemma  [ lem : sparsereg ] , we give one last definition .",
    "given @xmath176 $ ] , the _",
    "@xmath177-cluster graph _ associated to an @xmath134-regular partition @xmath178 of @xmath71 is the graph with vertex set @xmath179 and edges @xmath180 whenever @xmath122 is an @xmath134-regular pair with @xmath181 .",
    "we shall also require some basic useful facts about regular pairs .",
    "these are proved directly from the definition of regularity and density , and are standard facts in the usual dense version of the regularity lemma ( see  @xcite ) .",
    "[ prop : basic ] let @xmath182 and @xmath183 be @xmath134-regular pairs of relative density at least @xmath184",
    ". then    [ cols= \" < , < \" , ]",
    "in this section , we show how to use the presence of many triangles in an @xmath177-cluster graph of an @xmath3-free graph @xmath71 to find odd cycles in @xmath71 . in the traditional setting of the regularity lemma , namely for dense graphs , extremal theorems in the cluster graph",
    "are employed to find large structures in the original graph . in particular ,",
    "a single clique @xmath20 in the cluster graph is sufficient to provide a relatively large complete @xmath21-partite subgraph of the original graph , which gives a derivation of the erds - stone theorem from turn s theorem via the regularity lemma .",
    "however , in the case of sparse graphs , the appearance of a particular graph @xmath58 in the @xmath177-cluster graph is insufficient to imply a copy of @xmath58 in the original graph .",
    "for example , a construction of alon  @xcite shows that we can not hope to find even one triangle in a triple of sparse - regular pairs by making use only of the sparse - regularity .",
    "similarly , our example of a dense @xmath102-free triangle - free graph in theorem [ thm : k23 ] is actually a triple of sparse - regular pairs , so the cluster graph is actually a triangle , whereas the original graph has no triangles as well as no @xmath102 .",
    "more generally ( see krivelevich and sudakov  @xcite ) , one can take any pseudorandom @xmath83-free graph with @xmath0 odd and replace each vertex @xmath185 with a set @xmath186 of @xmath187 new vertices and each edge @xmath188 with the complete bipartite graph consisting of all edges between @xmath189 and @xmath186 .",
    "this still gives a pseudorandom @xmath83-free graph , which in particular has a complete cluster graph , whilst the original graph has no @xmath83 .",
    "the issue of what further conditions one should place in order to avoid these ` bad examples ' is an important question . recently",
    "conlon , fox and zhao  @xcite made substantial progress in a quite general setting , but our problem is not covered by their work .",
    "our strategy to find odd cycles is then the following .",
    "we will see that , under the assumption of smoothness , @xmath3-free graphs which are close to extremal ( in the sense of having the right order of magnitude number of edges ) have reasonably strong expansion properties .",
    "this will allow us to find a vertex @xmath185 such that the set @xmath190 of vertices at distance @xmath191 from @xmath185 has linear size , and in the event that the cluster graph contains many triangles we can further ensure that this set has substantial intersection with both sides of a dense regular pair . by regularity",
    "there is then an edge @xmath192 in the set , and thus a cycle of length @xmath193 in the graph ( here we ignore the possibility that the two paths from the ends of @xmath192 to @xmath185 might intersect , but this is not difficult to resolve ) .",
    "the smoothness of a family @xmath3 of bipartite graphs with exponent @xmath32 implies expansion in any @xmath3-free graph with large minimum degree .",
    "precisely , we have the following lemma .    [",
    "lem : expand ] let @xmath3 be an @xmath47-smooth family of bipartite graphs with @xmath69",
    ". then there exists @xmath194 such that for any @xmath195 , @xmath196 and any @xmath3-free bipartite graph @xmath197 on at most @xmath198 vertices , if every vertex in @xmath199 has degree at least @xmath200 , then    1 .",
    "[ lem : expand : a ] if @xmath201 , then @xmath202 .",
    "[ lem : expand : b ] if @xmath203 , then @xmath204 .",
    "if @xmath201 , then since @xmath3 is smooth , there exists @xmath142 ( which we may insist is larger than @xmath132 ) such that @xmath205 . if @xmath203 , then @xmath206 and @xmath207 , @xmath208 we conclude @xmath209 . therefore ( [ part2bound ] ) gives : @xmath210 this immediately gives @xmath211 . by substituting @xmath203 , and recalling @xmath212",
    ", we also obtain @xmath213 which shows @xmath214 , as required in part 2 of the lemma .",
    "one might reasonably think that in order to embed odd cycles , it will be enough to find one triangle @xmath215 in the cluster graph .",
    "one would select a typical vertex @xmath185 in @xmath216 , which has at least @xmath217 neighbors in @xmath218 , and similarly in @xmath219 : then lemma  [ lem : expand ] ( applied on @xmath220 ) guarantees a larger second neighborhood of @xmath185 in @xmath219 , and similarly in @xmath218 : after @xmath0 steps we have subsets of @xmath221 in @xmath218 and @xmath219 of linear size which we control by regularity . unfortunately , the expansion of @xmath3-free graphs is not quite strong enough for this argument to work : the minimum degree depends upon the number of clusters , and is thus potentially much smaller than @xmath222 .",
    "the result is that we can only guarantee that @xmath221 covers a fraction of a cluster which is @xmath223 , and @xmath134-regularity tells us nothing about such small sets .",
    "therefore we use an alternative approach , demanding not one but a positive density of triangles through @xmath216 in the cluster graph .",
    "these triangles can be used for an expansion argument in a large fraction of the graph , independent of the number of parts .",
    "we have then the following embedding lemma .",
    "[ lem : embed ] let @xmath224 , @xmath225 , and let @xmath3 be an @xmath47-smooth family of bipartite graphs .",
    "let @xmath226 be @xmath227 let @xmath228 for @xmath229 .",
    "then there exist @xmath230 and @xmath231 such that the following holds . if @xmath232 , @xmath233 , and @xmath71 is an @xmath3-free graph with an @xmath177-cluster graph @xmath234 with @xmath235 clusters in which one cluster @xmath216 is in at least @xmath236 triangles , then @xmath71 contains @xmath83 for each odd @xmath237 satisfying @xmath238    our first task is to find a structure in @xmath234 suitable for our expansion method .",
    "this will consist of clusters @xmath216 , @xmath218 , @xmath219 , sets of clusters @xmath2 and @xmath239 , and clusters @xmath240 and @xmath241 , which are adjacent as follows .",
    "the clusters @xmath240 form a path ( in that order ) ; @xmath242 is adjacent to @xmath216 , @xmath243 to all clusters @xmath2 , and all clusters @xmath2 to @xmath218 .",
    "we require similar adjacencies involving @xmath244 .",
    "finally @xmath218 and @xmath219 are adjacent",
    ". our embedding will proceed as follows .",
    "we will choose a typical vertex @xmath185 in @xmath216 , which then has a substantial first neighborhood in both @xmath242 and @xmath245 .",
    "we apply lemma  [ lem : expand ] between @xmath246 and @xmath247 for each @xmath248 to find eventually that the @xmath249th neighborhood of @xmath185 in @xmath243 has size very close to linear : in particular , large enough that at the next application of lemma  [ lem : expand ] part 1 to bound the size of the @xmath250st neighborhood of @xmath185 in @xmath2 we will find that the second term in the minimum is smaller .",
    "it is important that this neighborhood s size should not depend upon @xmath251 , and therefore at this step the minimum degree input to lemma  [ lem : expand ] must be independent of @xmath251 : to achieve this we will need that @xmath2 contains a large fraction ( independent of @xmath251 ) of the entire cluster graph . in a final application of lemma  [ lem :",
    "expand ] we will find a @xmath252nd neighborhood of @xmath185 in @xmath218 , and this will cover a fraction of @xmath218 independent of @xmath251 , and thus much bigger than @xmath112 . by the same procedure we find a large @xmath252nd neighborhood of @xmath185 in @xmath219 : by @xmath134-regularity of @xmath220 the bipartite graph between the two @xmath252nd neighborhoods contains many edges , and in particular paths of all ( not too long ) lengths . by construction",
    "a path of length @xmath253 vertices in this graph extends to a cycle ( through @xmath185 ) on @xmath254 vertices , as required .",
    "this approach is illustrated in the figure below .",
    "for the proof , we choose constants as follows .",
    "let @xmath142 be the constant returned by lemma  [ lem : expand ] .",
    "we will choose @xmath255 to be a small enough positive function of @xmath256 and @xmath32 in all the calculations that follow .",
    "then we choose @xmath257 to be large enough relative to these constants , @xmath258 and their reciprocals .",
    "let @xmath259 be the subgraph of @xmath234 consisting of edges of @xmath234 which form triangles together with @xmath216 : by definition @xmath259 has at least @xmath236 edges , and so average degree at least @xmath260 .",
    "it follows that @xmath259 has a subgraph @xmath58 whose minimum degree is at least @xmath261 , which we fix .",
    "we will now choose sequentially the clusters required for the structure described above , under the assumption that every cluster has degree at least @xmath262 in @xmath259 to unused clusters .",
    "let @xmath218 and @xmath219 be any two adjacent clusters in @xmath58 .",
    "let @xmath263 consist of @xmath264 neighbors of @xmath218 in @xmath58 .",
    "each of these clusters has at least @xmath264 neighbors not equal to @xmath218 or @xmath219 or to clusters in @xmath263 , and consequently there is a cluster @xmath243 adjacent to a set of @xmath265 clusters @xmath2 of @xmath263 .",
    "we now construct the path @xmath266 greedily choosing any so far unused neighbor of each @xmath246 in turn .",
    "we now repeat the same process ( avoiding previously used clusters ) to construct @xmath239 and @xmath267 .",
    "note that at the end we have used only @xmath268 clusters ( where the inequality follows from @xmath235 and choice of @xmath255 ) , so the assumption of degree at least @xmath262 to unused clusters is valid .",
    "we now delete vertices from these clusters as follows ( in a slight abuse of notation , we will continue to use the same letters for the clusters after deletion ) .",
    "let @xmath269    from each cluster in @xmath2 we remove all vertices whose degree into @xmath218 is smaller than @xmath270 .",
    "then from @xmath243 we remove all vertices whose degree into @xmath271 is smaller than @xmath200 , and then for each @xmath272 in succession we remove from @xmath246 all vertices whose degree into @xmath247 is smaller than @xmath273 . since we have @xmath274 , by @xmath134-regularity of the various pairs ( including , by proposition  [ prop : basic ] , the pair @xmath275 ) we do not delete more than @xmath276 vertices ( and in particular , since @xmath277 , not more than half of the vertices ) from any cluster .",
    "we perform the same process on the clusters @xmath278 .",
    "we choose a vertex @xmath279 whose neighborhood in both @xmath242 and @xmath245 has size at least @xmath280 : again this is possible by @xmath134-regularity of @xmath281 and @xmath282 , and since @xmath277 .",
    "let @xmath283 be the neighbors of @xmath185 in @xmath242 , and for each @xmath284 let @xmath285 be the neighbors of @xmath286 in @xmath246 .",
    "let @xmath287 be the set of neighbors of @xmath288 in @xmath271 , and finally @xmath289 be the set of neighbors of @xmath287 in @xmath218 .    for @xmath290 and @xmath207 , define @xmath291 .",
    "note that @xmath292 is well defined since @xmath293 is divisible by @xmath294 as a polynomial in @xmath64 .",
    "also , by definition , @xmath295 and @xmath296 for all @xmath290 .",
    "let @xmath297 , where @xmath142 is the constant in lemma  [ lem : expand ] .",
    "we claim that for each @xmath298 we have @xmath299 proceed by induction on @xmath248 .",
    "the statement is true for @xmath300 by choice of @xmath185 .",
    "if the claim holds for some @xmath301 , then we apply lemma  [ lem : expand ] to the bipartite graph spanned by edges between @xmath302 and @xmath303 . by construction",
    ", every vertex of @xmath199 has degree at least @xmath304 . by lemma  [ lem :",
    "expand ] part 1 , if @xmath305 then @xmath306 provided @xmath307 . by the above lower bound on @xmath308 ,",
    "the first expression in the minimum is at least @xmath309 as required . by lemma  [ lem :",
    "expand ] part 2 , if @xmath310 then @xmath311 , as required .",
    "this verifies the claim .",
    "we now apply lemma  [ lem : expand ] to the bipartite graph spanned by edges between @xmath312 and @xmath313 to find bounds on the size of @xmath287 .",
    "note that the degree of all vertices of @xmath288 into @xmath314 is at least @xmath315 , by construction .",
    "we have that for @xmath316 , @xmath317 . also for @xmath318",
    ", the definition of @xmath249 ensures @xmath319 let @xmath196 .",
    "then lemma  [ lem : expand ] shows @xmath320 .",
    "indeed , we have that the minimum in part  [ lem : expand : a ] of this lemma takes the value @xmath321 , since @xmath322 and @xmath257 is large enough . by choosing @xmath255 small enough and since @xmath323",
    ", we have that @xmath324 .",
    "thus we are guaranteed to have @xmath325 .",
    "since every vertex of @xmath326 has at least @xmath327 neighbors in @xmath218 , a final application of lemma  [ lem : expand ] part  [ lem : expand : b ] to the bipartite graph spanned by edges between @xmath326 and @xmath328 with @xmath297 yields @xmath329 where the last inequality follows by choosing @xmath255 small enough .",
    "we define similarly sets @xmath330 and obtain that @xmath331 contains at least @xmath276 vertices of @xmath219 .",
    "by @xmath134-regularity the bipartite graph @xmath332 $ ] has average degree at least @xmath333 and so has a subgraph with minimum degree at least @xmath334 .",
    "this subgraph contains paths of every odd length up to @xmath334 .",
    "since by our construction a path of length @xmath253 between @xmath218 and @xmath219 extends to an odd cycle in @xmath71 through @xmath185 of length @xmath254 , this completes the proof .",
    "* note that , by definition , we have that @xmath335 for all values of @xmath336 .",
    "therefore this embedding lemma can not be used to find odd cycles of length shorter than seven .",
    "the purpose of this section is to show that when @xmath337 for some @xmath338 , if @xmath79 is @xmath339-smooth for some @xmath92 , then we can improve on the expansion and embedding of the previous subsection , and embed cycles of length at least five .",
    "first we prove the necessary expansion .",
    "[ lem : kstexpand ] let @xmath71 be an @xmath14-vertex @xmath79-free graph .",
    "let @xmath185 be a vertex of @xmath71 , @xmath340 , and @xmath109 a subset of @xmath128 disjoint from @xmath341 .",
    "suppose that @xmath342 and @xmath343 for each @xmath344 .",
    "then @xmath345    each vertex in @xmath108 contains at least @xmath346 subsets of @xmath347 of size @xmath348 in its neighborhood .",
    "however , if there were @xmath251 vertices of @xmath108 all of whose neighborhoods contained one particular @xmath349-set in @xmath347 , then together with @xmath185 we would find @xmath79 in @xmath71 , which is forbidden .",
    "it follows that we have @xmath350 and hence @xmath351 which implies @xmath352 this proves lemma [ lem : kstexpand ] .",
    "our embedding statement is then the following .",
    "[ lem : kstembed ]",
    "let @xmath224 , and suppose that for some @xmath338 the graph @xmath79 is @xmath339-smooth for some @xmath92 .",
    "let @xmath353 for @xmath229 .",
    "then there exist @xmath354 and @xmath355 such that the following holds . if @xmath232 , @xmath233 , and @xmath71 is a @xmath79-free graph with an @xmath177-cluster graph @xmath234 with @xmath356 clusters in which one cluster @xmath216 is in at least @xmath357 triangles , then @xmath71 contains @xmath83 for each odd @xmath237 satisfying @xmath358    we follow the notation and proof of lemma  [ lem : embed ] , to produce two adjacent clusters @xmath359 and two families of sets @xmath2 and @xmath239 disjoint from them and from each other such that the following holds .",
    "every vertex of every set in @xmath2 ( @xmath239 ) has at least @xmath360 neighbors in @xmath218 ( @xmath219 respectively ) , each family @xmath2 and @xmath239 contains @xmath361 sets , and every set in @xmath362 was obtained from a partition cluster , which is adjacent to @xmath216 in the cluster graph , by removing fewer than @xmath363 vertices . in particular , every set in @xmath362 forms together with @xmath216 a @xmath364-regular pair of relative density at least @xmath365 .",
    "now we slightly modify the proof . choose a vertex @xmath366 which has at least @xmath367 neighbors in each of @xmath271 and @xmath368 .",
    "this vertex exists by @xmath364-regularity of the pairs @xmath369 , @xmath370 , and since @xmath371 each contain @xmath361 sets and @xmath372 .",
    "we let @xmath283 be the neighborhood of @xmath185 in @xmath271 , and @xmath373 the neighborhood of @xmath283 in @xmath218 . by lemma",
    "[ lem : kstexpand ] we have @xmath374 where the last inequality comes from choosing @xmath255 small enough and @xmath257 large enough .",
    "similarly we define @xmath375 and @xmath376 and obtain that @xmath377 . now since @xmath218 and @xmath219 form an edge of the cluster graph , the graph @xmath378 $ ] has average degree at least @xmath379 .",
    "then it has a subgraph with minimum degree at least @xmath380 and therefore contains paths of every odd length up to @xmath381 .",
    "since by our construction a path of length @xmath253 between @xmath373 and @xmath382 extends to an odd cycle in @xmath71 through @xmath185 of length @xmath383 , this completes the proof .",
    "suppose that @xmath71 is an @xmath3-free graph , and @xmath234 an @xmath177-cluster graph for @xmath71 .",
    "the aim of this section is to show that under the assumption of smoothness , the density of @xmath71 ( relative to the extremal @xmath3-free graphs ) transfers to an ( absolute ) density of @xmath234 : this allows us to use classical extremal results to prove our main theorems .",
    "[ lem : degtransfer ] let @xmath3 be an @xmath47-smooth family with relative density @xmath53 for some @xmath384 and @xmath385",
    ". for each @xmath386 there exist @xmath387 such that for each @xmath388 , @xmath389 and @xmath168 there is @xmath257 with the following property .",
    "suppose @xmath390 , @xmath71 is an @xmath3-free graph on @xmath14 vertices , @xmath391 and @xmath234 is an @xmath177-cluster graph with @xmath392 vertices as obtained from lemma  [ lem : sparsereg ] .    1 .   [ degtrans1 ] if @xmath393 , then @xmath394 .",
    "[ degtrans2 ] if a cluster @xmath395 meets at least @xmath396 edges of @xmath71 , then either @xmath397 is in at least @xmath398 irregular pairs , or @xmath399 .",
    "we choose @xmath400 , @xmath255 to be sufficiently small function of @xmath401 and we will require @xmath257 to be sufficiently large for all the calculations that follow .    let @xmath390 , @xmath402 and @xmath388 , and let @xmath71 be an @xmath14-vertex @xmath3-free graph with @xmath403 edges .",
    "let @xmath234 be an @xmath177-cluster graph for @xmath71 with @xmath404 , as obtained from a partition @xmath127 given by lemma [ lem : sparsereg ] , with clusters @xmath405 of size @xmath15 , exceptional cluster @xmath406 , and @xmath407",
    ". for @xmath408 $ ] , let @xmath409 and @xmath246 respectively denote the set of irregular pairs including @xmath397 and the set of regular pairs of density at least @xmath184 including @xmath397 . thus @xmath410 is the degree of @xmath397 in @xmath234 .",
    "let @xmath411 . applying the smoothness of @xmath3 to the bipartite subgraph @xmath58 of @xmath71 consisting of edges in pairs @xmath412",
    ", we obtain @xmath413 since @xmath414 , provided @xmath14 is large enough , this is at most @xmath415 .",
    "therefore the total number of edges of @xmath71 meeting @xmath397 is at most @xmath416 here we used that @xmath417 , @xmath418 , @xmath14 is large enough , @xmath255 is sufficiently small , @xmath391 and @xmath419 .",
    "summing over all clusters , we obtain @xmath420 where the final part of the inequality is jensen s inequality , using @xmath421 . on the other hand , @xmath422 . putting these together and",
    "simplifying we have @xmath423 , and thus @xmath424 since @xmath127 is a regular partition and @xmath425 , the @xmath426 sum to at most @xmath427 , and since the @xmath410 sum to @xmath428 , part  [ degtrans1 ] follows .    for part  [ degtrans2 ] , we have that the number of edges meeting @xmath397 is at least @xmath429 .",
    "this , together with  , implies that @xmath430 .",
    "thus @xmath431 , and so either @xmath432 or ( since @xmath425 ) @xmath433 , as desired .",
    "the extremal result which we transfer to the @xmath3-free setting is essentially the stability theorem of simonovits  @xcite for triangles .",
    "however we require a slight strengthening : we forbid the existence of a vertex contained in many triangles , rather than any triangle at all .",
    "[ lem : tristab ] given @xmath434 , let @xmath71 be an @xmath14-vertex graph with @xmath435 .",
    "then either there is a vertex of @xmath71 contained in at least @xmath436 triangles , or we can delete at most @xmath437 edges of @xmath71 to make it bipartite .",
    "let @xmath438 be a vertex of maximum degree in @xmath71 , @xmath108 be its neighborhood and let @xmath439 . by definition of @xmath438 ,",
    "every vertex in @xmath109 is incident with at most @xmath440 edges",
    ". therefore the number of edges in @xmath71 satisfies @xmath441 thus either @xmath442 , in which case we are done , or we have @xmath443 .",
    "if @xmath444 , then @xmath445 $ ] is the desired large bipartite subgraph of @xmath71 .",
    "so suppose this is not the case .",
    "let @xmath185 be a vertex of @xmath108 with maximum degree in @xmath109 , and @xmath446 its neighborhood in @xmath109 .",
    "either @xmath447 , in which case we are done , or we have @xmath448 from this , using that @xmath449 , we obtain @xmath450 therefore @xmath451 . since we have @xmath452 , we have @xmath453 on the other hand , since no vertex of @xmath108 has more than @xmath454 neighbors in @xmath109 , we have @xmath455 together with @xmath456 and @xmath457 , this implies that @xmath458 simplifying , we get @xmath459 . finally , this implies @xmath460 which contradicts   and completes the proof",
    ".    we will in fact prove slightly more than the statement of theorem  [ thm : extcycle ] : we will show that any family of @xmath461-free graphs in which the number of edges is asymptotically extremal , is near - bipartite ( rather than just proving it for the extremal graphs themselves ) .",
    "let @xmath3 be an @xmath47-smooth family and let @xmath391 . by definition , we have that the maximum possible number of edges in a @xmath3-free bipartite graph on @xmath14 vertices is at most @xmath462 .",
    "let @xmath386 be an arbitrarily small but fixed constant and let @xmath463 and @xmath464 be sufficiently small for lemma  [ lem : degtransfer ] .",
    "let @xmath465 be sufficiently small for lemma  [ lem : embed ] with @xmath466 note that as @xmath386 tends to zero , by definition @xmath467 also tends to zero .",
    "let @xmath168 be the constant returned by lemma  [ lem : sparsereg ] , and @xmath257 be large enough for lemmas  [ lem : embed ] and  [ lem : degtransfer ] .",
    "let @xmath390 , and @xmath71 be an @xmath14-vertex @xmath3-free graph with @xmath468 where the equality comes from the definition of @xmath469 .    by lemma  [ lem : sparsereg ]",
    "there is a sparse - regular partition of @xmath71 with a @xmath251-vertex @xmath177-cluster graph @xmath234 , where @xmath470 . by lemma  [ lem : degtransfer ]",
    "( with @xmath471 ) we have @xmath472 .",
    "if @xmath234 has a vertex in @xmath236 triangles , then by lemma  [ lem : embed ] @xmath71 contains @xmath83 for each @xmath473 with @xmath249 specified in the statement of lemma  [ lem : embed ] , and we are done . if not , then by lemma  [ lem : tristab ] @xmath234 has a subgraph @xmath474 with at most @xmath475 edges such that @xmath476 is bipartite .",
    "let @xmath477 be the spanning subgraph of @xmath71 consisting of edges belonging to pairs in @xmath478 , pairs with density less than @xmath184 , irregular pairs and edges inside partition classes .",
    "note that the @xmath134-regular partition of @xmath71 which gives the @xmath177-cluster graph @xmath234 is also an @xmath134-regular partition of @xmath477 , and it gives the graph @xmath474 as an @xmath177-cluster graph for @xmath477 .",
    "since @xmath479 , it follows by lemma  [ lem : degtransfer ] , with @xmath480 , that we have @xmath481 . since @xmath482 as @xmath483 , this shows that @xmath484 and since the graph with edges @xmath485 is bipartite , this proves that @xmath71 is near - bipartite .",
    "the proof of theorem  [ thm : kst ] is identical except that lemma  [ lem : kstembed ] replaces lemma  [ lem : embed ] .",
    "we have shown that the extremal graphs for forbidding @xmath3 and @xmath83 , for any smooth @xmath3 , are near - bipartite . in this section",
    "we prove theorem [ thm : aes ] , which says indeed that extremal graphs are actually bipartite provided they have large enough minimum degree and sufficiently many vertices .",
    "write @xmath486 for @xmath487 as @xmath5 .",
    "fix constants @xmath488 so that all inequalities required below are satisfied ( for the purposes of this sketch we will not specify the constants ) . let @xmath489 be the constant defined in lemma [ lem : embed ] .",
    "let @xmath490 and suppose @xmath491 is odd .",
    "we assume @xmath14 to be sufficiently large given the preceding constants , and set @xmath391 .",
    "let @xmath71 be an @xmath14-vertex @xmath3-free graph with minimum degree at least @xmath492 .",
    "let @xmath234 be the associated @xmath251-vertex @xmath177-cluster graph generated by lemma  [ lem : sparsereg ] . by lemma  [ lem : degtransfer ] , all but at most @xmath493 clusters of @xmath234 have degree at least @xmath494 .",
    "also , one can show that there are at most @xmath493 clusters that are ` bad ' , in that they contain more than @xmath495 vertices that are incident to more than @xmath496 edges in pairs that are irregular or have relative density less than @xmath184 .",
    "thus we may restrict to a subgraph @xmath474 of @xmath234 with at least @xmath497 clusters , all of which are good , such that the minimum degree in @xmath474 is at least @xmath498 .",
    "now lemma 9 in  @xcite , which is a ` supersaturated version ' of the andrsfai - erds - ss theorem , guarantees that either there is a vertex of @xmath474 contained in @xmath236 triangles , or there is a partition @xmath499 of @xmath500 such that for each vertex of @xmath474 , all but @xmath501 of its incident edges cross @xmath499 . in the former case",
    "the proof is similar to that of theorem [ thm : extcycle ] , so we may suppose we are in the latter case . also note that @xmath502 .",
    "let @xmath110 be a maximal cut of @xmath71 obtained from the partition @xmath503 by successively moving vertices with a majority of neighbors in their own partition class to the other partition class . using regularity and the fact that all clusters in @xmath474 are good",
    ", one can check that at most a @xmath504-fraction of any cluster in @xmath500 will be moved in this process . by maximality , each vertex of @xmath71 is incident to at least @xmath505 edges crossing @xmath110 .",
    "since @xmath71 is not bipartite , suppose without loss of generality that @xmath188 is an edge in @xmath108 .",
    "let @xmath283 and @xmath375 be disjoint , equal - sized sets of neighbors of respectively @xmath438 and @xmath185 in @xmath109 .",
    "let @xmath373 and @xmath376 be disjoint , equal - sized sets of neighbors of respectively @xmath283 and @xmath375 in @xmath506 , and so on . using lemma  [ lem : expand ] and similar computation as in the proof of lemma [ lem : embed ] , it is not hard to check that it is possible to choose these sets in such a way that after @xmath507 steps we have sets @xmath508 and @xmath509 which are both of size @xmath510 and are disjoint .",
    "let @xmath2 , @xmath239 respectively be the set of clusters @xmath142 that contain at least @xmath511 vertices of @xmath508 , @xmath509 .",
    "note that @xmath512 , and similarly @xmath513 .",
    "fix any @xmath514 .",
    "since each vertex of @xmath474 has at most @xmath501 neighbors in its own part , for any @xmath515 there are at least @xmath516 clusters that are common neighbors of @xmath142 and @xmath517 .",
    "since @xmath513 , a simple double counting argument shows that in particular there is a cluster @xmath518 of @xmath474 which is adjacent both to @xmath142 and to a set @xmath519 of at least @xmath520 clusters of @xmath239 .",
    "let @xmath446 be obtained from @xmath521 by deleting all vertices with degree less than @xmath522 in @xmath518 .",
    "then @xmath523 .",
    "applying lemma  [ lem : expand ] part 2 between @xmath446 and @xmath518 , we reach a set @xmath524 in @xmath518 disjoint from all previous @xmath285 and @xmath525 , and of size exceeding @xmath526 . by @xmath134-regularity of the pair @xmath527",
    ", there is a path between @xmath528 and @xmath524 of length @xmath529 . by construction , this can be extended to a @xmath0-cycle in @xmath71 .",
    "the value of @xmath62 in this theorem is similar in size to that in theorem  [ thm : extcycle ] . in the case of the complete bipartite graphs @xmath7 and @xmath8 ( with more care in the argument ) we can have @xmath530 .",
    "finally , if we impose the further condition @xmath531 , then we can reduce the minimum degree to @xmath532 ( in this case theorem  [ thm : extcycle ] shows that the cluster graph of @xmath71 is almost bipartite ) .",
    "this reduces the problem of showing that extremal @xmath14-vertex @xmath533-free graphs are bipartite to that of showing that they do not have vertices of degree much smaller than the average . unfortunately , even for @xmath534",
    "this is not known for most values of @xmath14 .",
    "fredi  @xcite showed that @xmath576 in this section , we describe a construction of a tripartite graph @xmath577 with no triangle or @xmath102 having @xmath578 vertices and @xmath579 for any prime @xmath580 mod @xmath581 .",
    "this construction is denser than any possible bipartite construction by a multiplicative factor of @xmath582 , as for @xmath14 even , @xmath583 , and so theorem [ thm : k23 ] is proved for @xmath584 .",
    "note that the exact value @xmath585 is known only for finitely many @xmath14 .",
    "we also remark that the purpose of choosing @xmath580 mod @xmath581 is to make @xmath586 a non - residue mod @xmath587 .",
    "this follows from the law of quadratic reciprocity , which states that if @xmath588 and @xmath587 are odd primes , and we define @xmath589 to equal @xmath588 if @xmath590 mod @xmath539 or @xmath591 if @xmath592 mod @xmath539 , then @xmath587 is a quadratic residue mod @xmath588 if and only if @xmath589 is a quadratic residue mod @xmath587 . applying this with @xmath593",
    "we see that @xmath586 is a quadratic residue mod @xmath587 if and only if @xmath587 is a quadratic residue mod @xmath581 , i.e. @xmath594 mod @xmath581 .",
    "* construction of @xmath577 .",
    "* let @xmath577 have parts @xmath595 , @xmath596 and @xmath597 which are copies of @xmath598 .",
    "join @xmath599 to @xmath600 ( where @xmath601 ) if @xmath602 for some @xmath603 .",
    "clearly @xmath577 has @xmath604 vertices and @xmath605 edges .",
    "* claim 1 .",
    "* _ @xmath577 is triangle - free .",
    "_    _ proof of claim 1 .",
    "_ suppose for a contradiction that we have a triangle in @xmath577 , with vertices @xmath606 , @xmath607 and @xmath608 .",
    "then @xmath602 , @xmath609 , @xmath610 for some @xmath611 .",
    "it follows that @xmath612 and @xmath613 , so @xmath614 this implies that @xmath615 is a quadratic residue . but this contradicts our assumption that @xmath580 mod @xmath581 , so @xmath577 is triangle - free .",
    "* claim 2 . *",
    "_ @xmath577 is @xmath102-free . _    _ proof of claim 2 .",
    "_ first we claim that each bipartite graph @xmath616 is @xmath617-free . if not , then we have distinct vertices @xmath618 and @xmath619 such that @xmath620 then @xmath621 and @xmath622 , so @xmath623 now we either have @xmath624 , which gives @xmath625 and @xmath626 , or @xmath627 , which gives @xmath628 and @xmath629 .",
    "either way we contradict the fact that we chose distinct vertices above , so @xmath616 is a @xmath617-free graph .",
    "it follows that any pair of vertices in a given @xmath630 has at most one common neighbor in each @xmath631 with @xmath632 .",
    "thus in any potential @xmath633 the part of @xmath102 of size @xmath634 must have vertices in different parts of @xmath577 .",
    "suppose , without loss of generality , that we have a vertex in @xmath635 and a vertex in @xmath595 that have @xmath581 common neighbors in @xmath596 .",
    "then we obtain distinct @xmath636 and distinct @xmath637 such that @xmath638 and @xmath639 . as above",
    ", this implies @xmath640 .",
    "on taking square roots , each of the three terms in the identity have two possible signs .",
    "we can assume without loss of generality that the first two terms get the same sign , i.e. @xmath624 .",
    "this gives @xmath625 and @xmath626 , which contradicts distinctness .",
    "therefore @xmath577 is @xmath102-free .",
    "here we generalize the construction in the previous subsection .",
    "for any @xmath642 and certain primes @xmath587 we construct @xmath643-partite graphs @xmath644 with no triangle or @xmath641 having @xmath645 vertices and @xmath646 since fredi  @xcite showed that @xmath647 this construction is denser than any bipartite construction by an asymptotic multiplicative factor of @xmath648 , as required for theorem [ thm : k23 ] .    * construction of @xmath644 . * fix a prime @xmath587 and ` multipliers ' @xmath649 for @xmath650 satisfying certain conditions to be described below .",
    "let @xmath644 have parts @xmath595 , @xmath651 , @xmath652 which are copies of @xmath598 .",
    "for @xmath653 , join @xmath599 to @xmath654 if @xmath655 for some @xmath656 .",
    "clearly @xmath644 has @xmath657 vertices and @xmath658 edges",
    ". we will derive conditions on the @xmath659 which ensure that @xmath644 has no triangle or @xmath641 , and then show that the conditions can be satisfied .",
    "we adopt the convention that @xmath660 when @xmath661 .",
    "* claim 1 . *",
    "_ @xmath644 is triangle - free if for all distinct @xmath662 , @xmath663 is a quadratic non - residue in @xmath664 . _    _ proof of claim 1 .",
    "_ suppose @xmath644 has a triangle with vertices @xmath599 , @xmath654 , @xmath665 , @xmath611 with @xmath666 , @xmath667 , @xmath668 .",
    "then @xmath669 and @xmath670 , so @xmath671 and hence @xmath672 thus we can make @xmath644 triangle - free if we arrange that @xmath673 is a non - residue for all distinct @xmath662 .",
    "( note that @xmath674 does not depend on the order of @xmath662 . )",
    "this proves claim 1 .",
    "* claim 2 . *",
    "_ @xmath644 is @xmath675-free if @xmath676 for all distinct @xmath662 .",
    "_    _ proof of claim 2 .",
    "_ each pair @xmath677 induces a @xmath617-free bipartite graph , so any pair of vertices in a given @xmath630 has at most one common neighbor in each @xmath631 with @xmath632 .",
    "thus in any potential @xmath641 the part of size @xmath634 must use two different parts , say we have @xmath678 and @xmath679 with @xmath680 common neighbors .",
    "there are @xmath251 parts besides @xmath630 and @xmath631 , so one of them , say @xmath681 , contains at least @xmath581 common neighbors of @xmath682 and @xmath683 .",
    "then we obtain distinct @xmath636 and distinct @xmath637 such that @xmath684 and @xmath685 since @xmath686 this gives @xmath640 . on taking square roots",
    ", we can assume without loss of generality that the first two terms get the same sign , i.e. @xmath624 , so @xmath687 .",
    "we also have @xmath688 , so if @xmath676 we get @xmath625 and @xmath626 , which contradicts distinctness .",
    "thus we can make @xmath644 be @xmath641-free if we arrange that @xmath676 for all distinct @xmath662 .",
    "this proves claim 2 .",
    "it remains to show that we can choose multipliers @xmath659 satisfying the conditions in claims 1 and 2 . intuitively , this should be easy for fixed @xmath251 and large @xmath587 by choosing random multipliers : then we will be unlikely to have @xmath689 , and given @xmath659 , @xmath690 , the choice of @xmath691 will be equally likely to make @xmath674 a residue or a non - residue . in fact , it is even possible to choose multipliers greedily to satisfy the conditions , which we shall do . to simplify our task we choose @xmath692 ,",
    "arbitrarily relabel the multipliers as @xmath693 , where @xmath694 , and choose them so that each @xmath695 is a residue , we do not have @xmath696 or @xmath697 with @xmath698 , and @xmath699 is a non - residue for all distinct @xmath662 : since the product of a residue and a non - residue is a non - residue , this will suffice",
    ".    we can easily choose residues @xmath700 and @xmath701 with @xmath702 and @xmath703 .",
    "suppose inductively that we have chosen @xmath704 satisfying these conditions for some @xmath705 .",
    "we use weil s inequality in the following form ( see , e.g. , ( * ? ? ? * chapter 5 ) ) :    [ weil ] suppose @xmath706 is the quadratic character , i.e. @xmath707 is @xmath132 if @xmath682 is a residue , @xmath708 if @xmath682 is a non - residue , or @xmath709 if @xmath710 .",
    "suppose also that @xmath711 $ ] is a polynomial of degree @xmath712 that is not the square of another polynomial",
    ". then @xmath713 .",
    "let @xmath714 and @xmath715 . note that if @xmath716 is a non - residue for all @xmath717 then @xmath718 .",
    "on the other hand , if @xmath716 is a residue for any @xmath717 then @xmath719 . there are at most @xmath720 values of @xmath682 such that @xmath716 is zero for some @xmath721 and each of these gives a value of @xmath722 between @xmath709 and @xmath723 .",
    "let @xmath108 be the set of @xmath682 such that @xmath716 is a non - residue for all @xmath724 .",
    "then we have @xmath725 we can also expand the product in the definition of @xmath726 to get @xmath727 applying weil s inequality to the functions @xmath728 we have @xmath729 we deduce that @xmath730 .",
    "since @xmath731 we have @xmath732 , so we can choose @xmath733 for some @xmath734 such that @xmath735 is not equal to @xmath695 or @xmath736 for any @xmath737 .",
    "therefore we can choose the multipliers @xmath693 satisfying the conditions in claims 1 and 2 .",
    "let @xmath535 be the book with @xmath251 pages : that is , @xmath251 copies of @xmath536 sharing a common edge ( and no other vertices ) . in this section ,",
    "we give an example of an application of theorem [ thm : extcycle ] which determines the asymptotic behavior of the turn numbers @xmath537 for @xmath538 .",
    "for the proof , we require one result on counting @xmath539-cycles in graphs , which will be used to show @xmath540 is a smooth family .    [",
    "lem : supersat2 ] let @xmath71 be a bipartite graph with parts @xmath199 and @xmath541 of sizes @xmath15 and @xmath14 and @xmath192 edges , and suppose that @xmath542 . then the number of @xmath539-cycles in @xmath71 is at least @xmath543    let @xmath544 . note that @xmath545 , where @xmath546 is the number of common neighbors of @xmath438 and @xmath185 .",
    "the number of @xmath539-cycles in @xmath71 is exactly @xmath547 . by jensen s inequality ,",
    "this is at least @xmath548 applying jensen s inequality a second time , we have @xmath549 since @xmath542 , we deduce @xmath550 . for these values of @xmath551 ,",
    "@xmath552 is non - decreasing , and therefore the number of @xmath539-cycles in @xmath71 is at least @xmath553    now we show that @xmath540 is smooth .",
    "[ thm : booksmooth ] for each @xmath554 , the family @xmath540 is @xmath555-smooth .",
    "consequently , for @xmath538 , @xmath556    the asymptotic formula will follow from theorem [ thm : extcycle ] and the known lower bound on the number of edges in a @xmath536-free bipartite graph , namely @xmath557 next we require an upper bound on @xmath558 .",
    "we shall show @xmath559 let @xmath71 be a @xmath540-free bipartite graph with parts @xmath108 and @xmath109 of sizes @xmath15 and @xmath14 , where @xmath560 .",
    "suppose for a contradiction , that @xmath71 has at least @xmath561 edges .",
    "we may delete edges of @xmath71 to obtain a subgraph @xmath58 of @xmath71 with exactly @xmath562 edges .",
    "clearly , @xmath58 is also @xmath540-free .",
    "let @xmath563 be any edge of @xmath58 , and consider the subgraph @xmath564 of @xmath58 induced by @xmath565 .",
    "if this subgraph has a vertex of degree @xmath566 , then @xmath58 contains @xmath7 ; if it has a matching of @xmath251 edges , then @xmath58 contains @xmath535 .",
    "it follows that since @xmath58 is @xmath540-free , then @xmath564 has at most @xmath567 edges , as a maximum matching has at most @xmath568 vertices each incident to at most @xmath569 edges .",
    "now the number of @xmath539-cycles in @xmath58 is precisely @xmath570 , which is thus at most @xmath571 . since @xmath572 we may apply lemma  [ lem : supersat2 ] to conclude that the number of @xmath539-cycles in @xmath58 is at least @xmath573 which is a contradiction .",
    "this shows that @xmath540 is @xmath555-smooth .",
    "hence we can use theorem [ thm : extcycle ] ( in the form it was proved in section 5 ) with @xmath574 and @xmath575 to complete the proof .",
    "we remark that one could use the methods of the above proof to give new asymptotics for turn numbers of various other families of bipartite graphs plus an odd cycle .",
    "@xmath738 in this paper we give a different and new approach to the erds - simonovits conjecture , employing scott s sparse version of szemerdi s regularity lemma .",
    "this approach could potentially be used to give broader structural understanding of extremal @xmath3-free graphs when @xmath3 consists of bipartite graphs together with graphs of chromatic number @xmath21 . in the present paper",
    ", we deal with @xmath739 . more generally , let @xmath740 denote the family of all graphs of chromatic number @xmath21 with at most @xmath0 vertices , and @xmath741 denote the family of all graphs of chromatic number @xmath21 . generalizing the erds - simonovits conjecture",
    ", we pose the following problem :      this would suggest that the extremal density of an @xmath3-free graph without any small @xmath21-chromatic subgraphs is asymptotic to the extremal density of an @xmath3-free @xmath743-partite graph . a key obstacle is to find an appropriate embedding lemma analogous to lemma [ lem : embed ] .",
    "@xmath738 exact results are rare for bipartite turn problems . even for @xmath617",
    ", while the exact result for @xmath744 is relatively straightforward , fredi s exact result for @xmath745 is an intricate argument .",
    "no exact result is known for @xmath585 ( except for finitely many @xmath14 ) .",
    "any construction achieving the natural upper bound would provide a positive answer to the famous biplane problem , which asks if there are infinitely many @xmath14 such that there is a family @xmath746 of subsets of an @xmath14-element set satisfying @xmath747 for @xmath698 .",
    "suppose that there is a bipartite graph with parts @xmath108 and @xmath109 of size @xmath14 such that every pair of vertices in @xmath108 has exactly @xmath634 neighbors in @xmath109 .",
    "then the set of all neighborhoods of vertices in @xmath108 is a biplane on @xmath109 .",
    "@xmath738 unsurprisingly , it is not in general easy to show that any particular family @xmath3 is smooth . besides @xmath7 and @xmath8 , we show that the family @xmath540 is smooth for all @xmath748 ( where @xmath535 is the book of @xmath539-cycles with @xmath251 pages ) .",
    "we can not at present prove , however , that @xmath535 itself is smooth .",
    "we intend to investigate smooth families in future work .",
    "j.  komls and m.  simonovits , szemerdi s regularity lemma and its applications in graph theory , combinatorics , paul erds is eighty , vol .",
    "2 ( keszthely , 1993 ) , bolyai soc . math .",
    ", vol .  2 , jnos bolyai math .",
    "budapest , 1996 , pp .",
    "295352 .",
    "m. simonovits , how to solve a turn type extremal graph problem ?",
    "( linear decomposition ) .",
    "contemporary trends in discrete mathematics ( tirn castle , 1997 ) , 283305 , dimacs ser . _ discrete math .",
    "_ , 49 , amer",
    "soc . , providence , ri , 1999 ."
  ],
  "abstract_text": [
    "<S> for an odd integer @xmath0 , let @xmath1 denote the family of all odd cycles of length at most @xmath0 and let @xmath2 denote the family of all odd cycles . </S>",
    "<S> erds and simonovits  @xcite conjectured that for every family @xmath3 of bipartite graphs , there exists @xmath0 such that @xmath4 as @xmath5 . </S>",
    "<S> this conjecture was proved by erds and simonovits when @xmath6 , and for certain families of even cycles in  @xcite . in this paper </S>",
    "<S> , we give a general approach to the conjecture using scott s sparse regularity lemma . </S>",
    "<S> our approach proves the conjecture for complete bipartite graphs @xmath7 and @xmath8 : we obtain more strongly that for any odd @xmath9 , @xmath10 and we show further that the extremal graphs can be made bipartite by deleting very few edges . </S>",
    "<S> in contrast , this formula does not extend to triangles  </S>",
    "<S> the case @xmath11  and we give an algebraic construction for odd @xmath12 of @xmath7-free @xmath13-free graphs with substantially more edges than an extremal @xmath7-free bipartite graph on @xmath14 vertices . our general approach to the erds - simonovits conjecture is effective based on some reasonable assumptions on the maximum number of edges in an @xmath15 by @xmath14 bipartite @xmath3-free graph . </S>"
  ]
}