{
  "article_text": [
    "the optical quality of the beam is a critical issue for intense lasers : a good optical quality is necessary to optimize stimulated amplification in optical amplifiers , to prevent optical surfaces from deteriorating due to hot spots , and to optimize the flux density at focus . for these reasons the optical quality of the beams of intense lasers",
    "must be monitored . to this end",
    ", wavefront analysis has to cope with the presence of high spatial frequencies in the beam profile due to speckle patterns .",
    "commonly used wavefront sensors , whether shack - hartmann  @xcite ( sh ) or shearing interferometers  @xcite , rely on the assumption of a continuous phase structure . in order to measure high spatial frequencies ,",
    "the sampling of the wavefront has to be fine .",
    "this requires additional optical components and many measurement points , which are manageable assuming large focal plane sensors .",
    "moreover , these concepts require the reconstruction of the wavefront from wavefront gradient measurements .",
    "the reconstruction process is only valid if the wavefront is continuous and can be measured on a domain that is a connected set in the topological sense .    to bypass the above limitations , far field wavefront sensing techniques such as phase diversity are an appealing alternative .",
    "phase diversity , i.e.,the recovery of the field from a set of intensity distributions in planes transverse to propagation , is a well - established method .",
    "the vast majority of the work on this technique has concentrated on the estimation of the phase for applications related to imaging , assuming that the modulus is known , as is often reasonable in astronomy at least  see in particular  @xcite for seminal contributions ,  @xcite for a review on phase diversity , and  @xcite for an application of phase diversityto reach the diffraction limit with strehl ratios as high as 98.7% .    yet , with intense lasers , the wave profile may present strong spatial variations  @xcite . for this reason , in this application of phase diversityone needs to estimate the complex amplitude",
    ". early work on phase and modulus estimation was performed for the characterization of the hubble space telescope ( hst ) .",
    "roddier  @xcite obtained non - binary pupil modulus images using an empirical procedure combining several gerchberg - saxton ( gs ) type algorithms  @xcite , while fienup  @xcite used a metric minimization approach  @xcite to estimate the binary pupil shape , parametrized through the shift of the camera obscuration .",
    "the gs algorithm belongs to a larger class of methods based on successive mathematical projections , studied in  @xcite .",
    "although there is a connection between projection - based algorithms and the minimization of a least - square functional of the unknown wavefront  @xcite , the use of an explicit metric to be optimized is often preferable to projection - based algorithms for several reasons .",
    "firstly , it allows the introduction of more unknowns ( differential tip - tilts between images , a possibly extended object , etc ) ; secondly , it allows the incorporation of prior knowledge about the statistics of the noise and/or of the sought wavefront ; thirdly , projection based algorithms are often prone to stagnation .",
    "the first work on estimating a wave complex amplitude from phase diversity data with an explicit metric along with experimental results was published by jefferies  @xcite , in view of incoherent image reconstruction in a strong perturbation regime .",
    "the authors encountered difficulties in the metric minimization , which may in part be due to the parametrization of the complex amplitude with its polar form rather than its rectangular one .",
    "experimental results in a strong perturbation regime have also been obtained by almoro _",
    "et al . _",
    "@xcite using a wave propagation - based algorithm .",
    "this algorithm , which can be interpreted as successive mathematical projections  @xcite , required many measurements recorded at axially - displaced detector planes .",
    "the said technique was adapted for smooth test object wavefronts using a phase diffuser and , for single plane detection , with a spatial light modulator@xcite .",
    "more recently , thurman and fienup  @xcite studied , through numerical simulations , the influence of under - sampling in the reconstruction of a complex amplitude from phase diversity data with an explicit metric optimization , in view of estimating the pupil modulus and aberrations of a segmented telescope , but this metric was not derived from the data likelihood .",
    "this paper aims at presenting a likelihood - based complex amplitude retrieval method relying on phase diversity and requiring few images , together with an experimental validation . as in  @xcite",
    ", the complex amplitude is described by its rectangular form rather than the polar one to make the optimization more efficient .",
    "the method , named camelotfor _ complex amplitude measurement by a likelihood optimization tool _ , is described in section  [ sec - method ] . in section  [ sec - manip ]",
    "we validate it experimentally and assess its performance on a laboratory set - up designed to shape the complex amplitude of a laser beam and record images of the focal spot at several longitudinal positions .",
    "in particular , a cross - validation with conventional phase diversityis presented . finally , experimental results are confronted to carefully designed simulations taking into account many error sources in section  [ sec : perf_analysis ] . in particular , the impact of photon , detector and quantization noises on the estimation precision is studied .",
    "the schematic diagram for phase diversitymeasurement is presented on fig .",
    "[ mod_dir ] .",
    "an imaging sensor is used to record the intensity distributions . as with any wavefront sensor ,",
    "the laser beam is focused by optics in order to match the size of the beam with that of the sensor . with phase diversity , the sensor area",
    "is installed at the image focal plane of a lens .",
    "note that it is advisable to install a clear aperture at the front focal plane of the optics in order to ensure a correct sampling of the intensity distributions .",
    "the focal length of the optics and the diameter of the aperture are chosen in order to satisfy the shannon criterion with respect to the pixel spacing .    in order to retrieve the complex amplitude of an electromagnetic field",
    ", the relationship between the unknowns and the measurements must be described mathematically .",
    "this description is called the image formation model , or direct model .",
    "let @xmath0 denote the complex amplitude in plane @xmath1 .",
    "@xmath0 is decomposed onto a finite orthonormal spatial basis with basis vectors @xmath2}$ ] : @xmath3 the coefficients of this decomposition are stacked into a single column vector , denoted by @xmath4_{j=[1,n_k]}\\in { \\mathbb{c}}^{n_k}$ ] . in the following , a pixel basis is used without loss of generality .",
    "the field complex amplitude in the plane of the above - mentioned clear aperture , @xmath5 , is supposed to be the unknown .",
    "@xmath5 is called hereafter the estimation plane .",
    "we assume that the phase diversityis performed by measuring intensity distributions in @xmath6 planes , perpendicular to the propagation axis .",
    "@xmath1 ( @xmath7 ) refer to these planes .",
    "the transverse intensity distributions of the field are measured by translating the image sensor along the optical axis around the focal plane .",
    "the measured signal in plane @xmath1 is a two dimensional discrete distribution concatenated formally into a single vector of size @xmath8 denoted by @xmath9 . as the detection of the images",
    "is affected by several noise sources , denoting @xmath10 the noise vector , the direct model reads : @xmath11 where @xmath12 and @xmath13 represents a component - wise product .",
    "the component - wise product of two complex column vectors of size @xmath14 denoted @xmath15^t_{j=[1,n]}$ ] and @xmath16^t_{j=[1,n]}$ ] is defined as the term by term product of their coordinates : @xmath17^t_{j=[1,n]},\\ ] ] in eq .",
    "( [ eq : i_k ] ) , the spatial integration of the intensity distribution by the image sensor is not taken into account . in practice",
    ", this assumption will remain justified as long as the spatial sampling rate exceeds the shannon criterion .",
    "each @xmath18 can be expressed as a linear transformation ( a transfer ) of @xmath19 and therefore be described by the product of the propagation matrix @xmath20 by @xmath19 .",
    "unfortunately , the transverse registration of the different measurements is experimentally difficult to obtain with accuracy . in order to take these misalignments into account ,",
    "differential shifts between planes are introduced in the direct model via the dot product of @xmath19 by a differential shift phasor @xmath21 :    @xmath22.\\ ] ]    the @xmath23-th differential shift phasor is decomposed on the zernike tip and tilt polynomials @xmath24 and @xmath25 expressed in the pixel basis  @xcite , @xmath26 and @xmath27 being their respective coefficients : @xmath28    the misalignment vector @xmath29 is defined as : @xmath30 . without loss of generality , the first measurement plane ( k=1 ) is chosen as the reference plane , so that @xmath31 .",
    "finally the image formation model is : @xmath32|^2 } + n_k.\\ ] ]    the propagation from the estimation plane down to the reference plane is simulated numerically using a discrete fourier transform ( dft ) , @xmath33 being the far field of @xmath34 : @xmath35}\\ ] ]    the propagation between the reference plane ( @xmath36 ) and plane @xmath37 is simulated by a fresnel propagation performed in fourier space : @xmath38}\\odot\\exp{(i\\pi\\lambda d_{1k } \\nu^2)}]}.\\ ] ] where @xmath39 is the distance between plane @xmath40 and plane @xmath23 , @xmath41 is the norm of the spatial frequency vector in discrete fourier space , and idft the inverse of the dft operator .      in order to retrieve an estimation of @xmath19 from the set of measurements , @xmath42 ,",
    "the basic idea is to invert the image formation model , i.e.,the direct model . for doing so",
    ", we adopt the following maximum a posteriori ( map ) framework  @xcite : the estimated field @xmath43 and misalignment coefficients @xmath44 are the ones that maximize the conditional probability of the field and misalignment coefficients given the measurements , that is the posterior likelihood @xmath45 . according to bayes rule : @xmath46 where @xmath47 , respectively @xmath48 , embody our prior knowledge on @xmath19 , respectively @xmath29 .",
    "the map estimate of the complex field corresponds to the minimum of the negative logarithm of the posterior likelihood : @xmath49 which , under the assumption of gaussian noise , takes the following form : @xmath50 } |^2})^t c_k^{-1 } ( { \\text{\\boldmath$i_k$}\\xspace }      -{| { m_k[\\psi_0{\\odot}{\\text{\\boldmath$s_k$}\\xspace } ] } |^2 } ) -\\ln p(\\psi_0 ) - \\ln p(a ) , \\ ] ] where @xmath51 is the covariance matrix of the noise on the pixels recorded in plane @xmath23 ( diagonal if the noise is white ) and @xmath52 and @xmath53 are regularization terms that embody our prior knowledge on their arguments .    in the experiment and in the simulations",
    "presented hereafter , we have not witnessed the need for a regularization , so in the following we shall take @xmath54constant , and the map metric of eq .",
    "( [ eq : j ] ) reduces to a maximum - likelihood ( ml ) metric .",
    "this metric is similar to but different from the intensity criterion suggested by fienup in  @xcite .",
    "indeed , in our likelihood - based approach , @xmath55 enables us to take into account not only bad pixels ( either saturated or dead ) but also noise statistics .      in eq .",
    "( [ eq : argmin ] )  @xmath56 is a non - linear real - valued function of @xmath57 and @xmath58 . in order to perform its minimization a method based on a quasi - newton algorithm , called variable",
    "metric with limited memory and bounds method ( vmlm - b )  @xcite is used .",
    "the vmlm - b method requires the analytical expression of the gradient of the criterion .",
    "the complex gradient of @xmath56 with respect to @xmath59  @xcite , denoted @xmath60 , is defined in eq .",
    "( [ nabla_je_1 ] ) as the complex vector having the partial derivative of @xmath56 with respect to @xmath61 ( respectively @xmath62 ) as its real ( respectively imaginary ) part .",
    "@xmath63}_{2}){\\odot } ( \\underbrace{{\\text{\\boldmath$i_k$}\\xspace}-|m_k [ \\psi{\\odot}{\\text{\\boldmath$s_k$}\\xspace}]|^2)}_{1}\\right]\\right).\\ ] ]    four factors can be identified in eq .",
    "( [ nabla_je_1 ] ) , which allows a physical interpretation of this somewhat complex expression :    1 .",
    "the computation of the difference between measurements and the direct model ; 2 .   weighing this difference by the result of the direct model ; 3 .   whitening the noise to take into account noise statistics ; 4 .   a reverse propagation that enables the projection of the gradient into the space of the unknowns and takes into account differential tip / tilts .",
    "the minimization of @xmath56 must also be performed with respect to misalignment coefficients .",
    "the following analytical expression has been obtained and implemented : @xmath64){\\odot } ( { \\text{\\boldmath$i_k$}\\xspace}-|m_k [ \\psi{\\odot}{\\text{\\boldmath$s_k$}\\xspace}]|^2)\\right]}^*}.\\ ] ]",
    "the objective of the experiment is to validate camelotexperimentally on a perturbed laser beam .",
    "the experiment is performed using a low power continuous fibered laser whose complex amplitude is modulated to create spatial perturbations .",
    "the experimental setup is illustrated on fig .",
    "[ fig_expe_setup ] .",
    "the spatial modulation of the laser beam ( phase and modulus ) is controlled by a field control module and conjugated with the clear aperture plane .",
    "the beam going through the clear aperture crosses a beam splitter and is focused on the camelotcamera of fig .",
    "[ mod_dir ] .",
    "the camera is used to record three near focal plane intensity distributions , which are given as inputs to camelot .",
    "the field estimated by the latter will be denoted @xmath65 in the following .",
    "the beam reflected on the beam - splitter is used to record the intensity distribution @xmath66 with an image sensor conjugated with the aperture plane .",
    "camelot s estimation of the complex field is cross - validated in the two following ways : regarding field modulus , @xmath67 is compared with @xmath68 , called measured modulus of the field hereafter , which is computed as the square - root of image @xmath66 : @xmath69 .    regarding phase , camelot s estimate",
    "is compared to the result of a straightforward adaptation of a classical phase diversityalgorithm  @xcite that will be referred to as conventional phase diversity .",
    "phase diversity is now a well established technique : it has been used successfully for a number of applications  @xcite , including very demanding ones such as extreme adaptive optics  @xcite , and its performance has been well characterized as a function of numerous factors , such as system miscalibration , image noise and artefacts , and algorithmic limitations  @xcite . in classical phase diversity ,",
    "only the pupil phase is sought for , while the pupil transmittance is supposed to be known perfectly .",
    "this is probably the main limitation of this method , regardless of how the transmittance is known , whether by design or by measurement . in the case of a transmittance measurement ,",
    "a dedicated imaging subsystem must be used , hence increasing the complexity of the setup .",
    "misalignment issues ( scaling , rotation of the pupil ) have to be addressed due to the potential mismatch between the true pupil ( which gives rise to the recorded image ) and the pupil that is assumed in the image formation model . in this paper , for conventional phase diversity , the pupil transmittance is set to the measured modulus @xmath68 and the data used are two of the three near focal plane intensity distributions : the focal plane image and the first defocused image .      in this section , we present the modulation method used to control the field and how the result of the modulation is measured in the aperture plane .",
    "the modulation of the complex amplitude is obtained using the field control method suggested by bagnoud  @xcite : a phase modulator is followed by a focal plane filtering element .",
    "the phase modulation is performed with a phase only slm ( hamamatsu lcos slm x10 - 468 - 01 ) with 800x600 @xmath70 pixels .",
    "the laser source is a @xmath71 continuous laser diode at @xmath72 injected into a @xmath73 core single - mode fiber . at the exit of the fiber ,",
    "the beam is collimated , linearly polarized and then reflected on the slm .",
    "the clear aperture diameter is @xmath74 on the surface of the slm .",
    "it is conjugated with a unit magnification onto the clear aperture plane .",
    "the spatial modulation and filtering are designed to control 15@xmath7515 resolution elements in the clear aperture i.e.,15 cycles per aperture .",
    "the effective result of the control in the clear aperture plane is called the true field .",
    "its modulus is denoted @xmath76 .",
    "the spatial modulation and filtering have been modeled by means of an end - to - end simulation .",
    "the result of the simulation is denoted by @xmath77 .",
    "its modulus , denoted @xmath78 , is presented on the left of fig .",
    "[ fig_control ] .",
    "it shows smooth variations as can be typically observed on an intense pulsed laser  @xcite .",
    "it has been truncated in the upper right corner to simulate a strong vignetting effect .",
    "the phase of the field is presented on fig .",
    "[ fig_phase ] .",
    "it is dominated by a zernike vertical coma ( @xmath79 ) of @xmath80 peak - to - valley ( pv ) , typical of a strong misalignment of a parabola for instance .    *",
    "1@c ) , center : measured modulus ( @xmath68 ) , right : @xmath81.,title=\"fig : \" ]        the modulus of the true field is measured with the aperture plane imaging camera ( see fig.[fig_expe_setup ] ) .",
    "the image is recorded with a high spatial resolution ( 528 pixels in a diameter ) and with a high snr per pixel ( 60 in average ) .",
    "the result of the measurement,@xmath68 , is presented at the center of fig .",
    "[ fig_control ] .    in order to quantify the proximity of the simulated modulus @xmath78 with the measured one @xmath68 ,",
    "the following distance metric is defined : @xmath82    to enable their comparison , @xmath78 and @xmath68 have been normalized in flux ( @xmath83 ) .    the spatial distribution of the modulus of the difference between @xmath78 and @xmath68 is presented on the right of fig .",
    "[ fig_control ] .",
    "it has been multiplied by a factor 2.5 to present a dynamic comparable to @xmath68 .",
    "the corresponding distance @xmath84 is found to be @xmath85 , whereas in the case of a photon noise limited measurement simulations show that one should rather obtain @xmath86 .",
    "a preliminary fourier - based analysis of the difference between @xmath78 and @xmath68 enables to identify a clear cut separation between spatial frequencies below the cut - off frequency of the spatial modulation ( 15 cycles per aperture ) and higher spatial frequencies . due to the spatial filtering by the control module ,",
    "the low spatial frequencies part of the difference between @xmath78 and @xmath68 can be attributed mostly to model errors between the simple simulation performed to compute @xmath78 and the effective experimental setup of the control module .",
    "for instance in the simulation , the spatial filter is assumed to be centered on the optical axis , the slm illumination is assumed to be perfectly homogeneous , and lenses and optical conjugations are supposed to be perfect .",
    "this part of @xmath84 is evaluated to @xmath87 , that is more than @xmath88 of the total .",
    "the high frequencies part of @xmath84 comes from optical defects on relay optics and noise influence on @xmath68 measurement .",
    "it is evaluated to @xmath89 .",
    "this gives insight on the measurement precision of @xmath68 , which should thus be of the order of @xmath89 .",
    "the intensity distributions in the different planes are recorded by translating the sensor along the optical axis around the focal plane .",
    "the amount of defocus must be large enough to provide significantly different intensity distributions so as to facilitate the estimation process . however , small translation distances are preferred for the sake of experimental easiness . for conventional phase diversitya defocus of @xmath90 pv",
    "is often chosen as it maximizes the difference between the focal plane intensity distribution and the defocused image .",
    "therefore , the amplitude of defocus between the position of each plane is fixed to @xmath90 pv .",
    "considering such a defocus , it appears that no less than three different measurement planes are required with camelot .",
    "the first image is located in the focal plane , the second one is at a distance corresponding to @xmath90 of defocus pv , the third one at a distance of 2@xmath90 pv from the focal plane .",
    "the relation between the pv optical path difference @xmath91 in the aperture plane and the corresponding translation distance between two successive planes @xmath92 is : @xmath93 for the experiment , the focusing optics focal length is @xmath94 and the aperture diameter is @xmath74 .",
    "consequently the translation distances are @xmath95 between the successive recording planes .",
    "the intensity distributions are recorded with a hamamatsu cmos camera ( orca @xmath96 ) .",
    "its characteristics are the following : a pixel size and spacing @xmath97 , a readout noise standard deviation @xmath98rms , a full well capacity of @xmath99 , and a @xmath100 bit digitizer .    as explained in section [ sec - statement ]",
    ", the sampling must fulfill the shannon criterion . the focusing optics focal length and the aperture diameter combined with the pixel size lead to a theoretical shannon oversampling factor @xmath101 for @xmath72 .",
    "the total number of photo - electrons must be large enough to prevent the estimation from being noise limited .",
    "simulations of the system that will be detailed in section  [ sec : perf_analysis ] demonstrate that @xmath102 total photo - electrons are sufficient . due to the limited full well capacity of the sensor , @xmath103 short exposures images are added to reach this number . for each image ,",
    "background influence has been removed by a subtraction of an offset computed from the average of pixels located on the side of the images ( hence not illuminated ) .",
    "the noise covariance matrix @xmath104 is approximated by a diagonal matrix whose diagonal terms , @xmath105_{jj}$ ] , correspond to the sum of the variances of the photon noise , read out noise and quantization noise : @xmath106_{jj } = [ \\sigma^2_{ph , k}]_j + p(\\sigma^2_{ron } + q^2/12)\\ ] ] where @xmath107 is the quantization step . in practice ,",
    "the readout noise variance map @xmath108 is calibrated beforehand and the photon noise variance @xmath109 is approximated from the image by : @xmath110_j=\\max([{\\text{\\boldmath$i$}\\xspace}_k]_j,0)$ ] on pixel @xmath111  @xcite .",
    "the three recorded near - focal intensity distributions are presented at the top of fig .",
    "the full size of one image is @xmath112 pixels . for the figure , a region of interest of @xmath113 pixels , centered on the optical axis ,",
    "is selected . from left to right the focal plane image , the first defocused image and the second one are displayed .",
    "the colorscale is logarithmic .",
    "the three focal plane images are now used in the camelotestimation .",
    "the minimization process is initiated with a homogeneous modulus field , a phase set to zero and differential tip / tilts also set to zero .",
    "the number of estimated points in the estimation plane is @xmath114 .",
    "the current implementation of the algorithm is written in the idl language .",
    "a relevant measurement of the success of our inversion method is the quality of the match between the data @xmath9 and the model that can be computed from the estimated field through eq  ( [ eq : mod_direct ] ) .",
    "this latter map is presented on the middle row of fig .",
    "the moduli of the differences between the measurements and the direct model , that is to say estimation residuals , are displayed on the bottom row of the same figure .",
    "these residuals are below @xmath115 of the maximum of the measurements on the three planes .",
    "the estimated shifts are @xmath116 and @xmath117 pixel for x and y directions for @xmath118 and @xmath119 respectively .    ) ; center : first defocused images ( @xmath120 ) ; right : second defocused image ( @xmath121 ) .",
    "top : experimental images ; middle : direct model result for @xmath122 ; bottom : residuals , i.e. , @xmath123 .",
    "logarithmic scale , @xmath113 pixels roi centered on the optical axis . ]    the modulus of camelot s estimated field , @xmath67 , is presented on the left of fig .  [ fig_amp ] .",
    "it has been normalized in flux to enable the comparison with the measured modulus @xmath68 , shown in the center of the figure . for the comparison ,",
    "@xmath68 has been sub - sampled and resized to @xmath124 pixels .",
    "the modulus of the difference between @xmath67 and @xmath68 is represented on the right .",
    "the main spatial structures of @xmath68 are well estimated by the method .",
    "the estimation residuals are below @xmath125 of the maximum of the measured modulus , even in the zones where the flux is low ( top right corner ) .",
    "the distance between the two moduli is @xmath126 only .",
    "this must be compared to the error between @xmath68 and @xmath78 reported in section  [ sec : control ] which was found to be @xmath127 .",
    "camelotthus delivers a modulus estimation that is several times closer to @xmath68 than @xmath78 is .    ,",
    "@xmath68 and @xmath128 . ]",
    "we now compare the phase estimated by camelotto the result of the conventional phase diversitymethod described in section  [ sec - principle ] .",
    "the comparison is presented on fig .",
    "[ fig_phase_c ] .",
    "the phase of @xmath129 , @xmath130 , is presented on the left of the figure , the phase of the conventional phase diversity,@xmath131 , is in the center of the figure , the modulus of their difference is presented on the right . for comparison of these phase maps , their differential piston has been set to 0 . in the zones where the modulus is greater than @xmath132 of the maximum modulus of @xmath133 ,",
    "the maximum of the phase residuals is below @xmath134 .",
    "additionally concerning conventional phase diversity , setting @xmath67 as the pupil transmittance instead of @xmath68 enables a better fit to the data with a 5% smaller criterion at convergence of the minimization , which is yet another indicator of the quality of the modulus @xmath67 estimated by camelot .",
    "camelotand conventional phase diversity algorithms have about the same complexity .",
    "the former converges after less than 300 iterations and requires less than @xmath135 of computation , while the latter takes slightly more iterations and time .",
    "the main difference between the two methods lies in the modeling of the defocus between the measurement planes : in camelotit is performed by a fresnel propagation , hence requiring two additional dfts for each defocused plane .",
    "however , camelotappears here as fast as conventional phase diversity to achieve comparable results .",
    "the convergence time demonstrated here makes camelotsuitable for the measurement and control of slowly varying aberrations such as those induced by thermal expansion of mechanical mounts for instance .",
    "the use of an appropriate regularization metric should contribute to speed up the computation .",
    "recent work on real time conventional phase diversity demonstrated that few tens of hertz are achievable with a dedicated ( but commercial off - the - shelf ) computing architecture  @xcite . according to the author of the latter reference",
    ", several hundreds of hertz could even be achieved in a very near future , making phase diversity compatible with the requirements of the measurement and control of atmospheric turbulence effects .",
    "we believe that these conclusions can be generalized to camelotconsidering the similar convergence demonstrated here compared to conventional phase diversity and the the possibilities brought by graphical processing units to speed up fresnel propagation computations  @xcite .    , @xmath131 and @xmath136 . ]",
    "we now analyze the way these results compare with simulations .",
    "we simulate focal plane images from @xmath129 while taking into account the main disturbances that affect image formation : misalignments , photon and detector noises , limited full well capacity , quantization and miscalibration .    for the numerical simulation of the out - of - focus images ,",
    "a random tip / tilt phase is added to the field before propagation to the imaging plane in order to simulate the effect of misalignment .",
    "the standard deviation of the latter corresponds to half a pixel in the focal plane .",
    "then two cases are considered .",
    "the first case , hereafter called perfect detector , assumes a detector with noise but an infinite well capacity and no quantization .",
    "each image is first normalized by its mean number of photo - electrons @xmath137 , then for each pixel a poisson occurrence is computed , and a gaussian white noise occurrence with variance @xmath138 is then added to take into account the detector readout noise .",
    "the second case corresponds to a more realistic detector :    for a given value of the desired number of photo - electrons @xmath137 , the corresponding image is computed as the addition of as many `` short - exposures '' as needed in order to take into account the finite well capacity , and each of these short exposures is corrupted with photon noise , read - out noise and a 12  bit quantization noise .",
    "the same number of photo - electrons is attributed to each image : @xmath139 where @xmath140 designates the total number of photo - electrons .",
    "the simulated long exposure focal plane image is presented on the left of fig .",
    "[ fig_psf_dyn ] .",
    "this image is obtained for @xmath141 photo - electrons by adding @xmath142 short exposures .",
    "it can be visually compared with the experimental focal plane image recorded in comparable conditions ( right ) : the similarity between the two images illustrates the relevance of the image simulation .    , @xmath142 short exposures ) ,",
    "right : experiment . ]",
    "the modulus estimation error @xmath143 is plotted on fig .  [ fig_varepsilon_a ] as a function of @xmath140 for the two detector cases .",
    "ten uncorrelated occurrences are averaged to compute @xmath144 .",
    "the result of the comparison of @xmath67 with @xmath68 obtained from the experiment is also reported on the figure ( abscissa @xmath145 photo - electrons ) .     as a function of average photo - electrons per pixel @xmath140 .",
    "black diamonds ( @xmath146 ) : perfect detector , green triangles ( @xmath147 ) : finite well capacity and quantization , red asterisk ( @xmath148 ) : experiment result , dotted line : @xmath149 , dashed line : @xmath150 . ]    for the perfect detector case and @xmath140 small compared to @xmath151 , @xmath144 follows a @xmath149 power law . for greater values",
    ", the power law turns to @xmath150 .",
    "this can be explained by the relative weights of the readout and the photon noise .",
    "for @xmath152 , the average flux on illuminated pixels , that can be approximated by @xmath153 where @xmath154 is the average number of illuminated pixels per image plane ( @xmath155 ) , is smaller than the total readout noise contribution for one image plane , that is @xmath156 .",
    "thus , readout noise dominates . for @xmath157 ,",
    "the photon noise contribution becomes predominant and the noise propagation of @xmath144 follows a @xmath150 power law .",
    "it is confirmed here , as stated in section  [ practical_implementation ] , that @xmath144 for the experiment is not limited by photon noise .",
    "the analysis of @xmath144 for the case with finite well capacity and quantization shows that it follows the perfect detector case up to about @xmath158 photo - electrons , then starts to follow a @xmath150 power law .",
    "@xmath158 corresponds to the flux necessary to saturate the well capacity of the sensor . above this limit",
    ", images are added to emulate the summation of `` short - exposures '' images .",
    "hence , the noise level in the measurements starts to depend on the number of summed images , that is to say on @xmath140 , with a @xmath150 power law .",
    "the error level obtained from the comparison between the modulus measurement and camelotestimation ( @xmath159 ) is comparable to the error level between camelotestimation and the true modulus in the case of the more realistic detector ( @xmath160 ) : they differ approximately by a factor two .",
    "a significant part of this difference comes from the fact that the measured modulus @xmath68 too is imperfect i.e.,is only an estimate of the true modulus @xmath76 , due to experimental artefacts , notably differential optical defects that affect image formation on the aperture plane imaging setup and noise influence .",
    "this claim is also supported by the fact that the phase estimated by conventional phase diversityfits the measurements better when the pupil transmittance is set to the modulus estimated by camelot , @xmath67 , instead of the measured modulus @xmath68 . the fourier - based analysis mentioned at the end of section  [ sec : control ] delivers an estimate of the measurement precision of @xmath68 that is evaluated to @xmath89 .    as a final remark",
    ", one can note that fig .",
    "[ fig_varepsilon_a ] can also be useful to evaluate not only the estimation error on the field modulus but the total error on the complex field itself .",
    "indeed , we have calculated that this total error is on average simply twice the error on the modulus , or @xmath161 .",
    "this can be particularly useful for designing a complex field measurement system based on camelot .",
    "in this paper , we have demonstrated the applicability of phase diversityto the measurement of the phase and the amplitude of the field in view of laser beam control .",
    "the resolution of the inverse problem at hand has been tackled through a map / ml approach .",
    "an experimental setup has been designed and implemented to test the ability of the method to measure strongly perturbed fields representative of misaligned power lasers .",
    "the estimated field has been confronted to measured modulus using pupil plane imaging and to phases estimated with classical two - plane phase diversity(using the measured aperture plane modulus ) .",
    "it has been shown that the estimation accuracy is consistent with carefully designed numerical simulations of the experiment , which take into account several error sources such as noises and the influence of quantization .",
    "noise propagation on the field estimation has been studied to underline the capabilities and limitations of the method in terms of photometry .",
    "several improvements to the method are currently considered .",
    "they include the estimation of a flux and of an offset per image , adding a regularization metric in the criterion to be optimized for the reconstruction of the complex field on a finer grid and speeding up the computations .",
    "the work presented in this paper focuses on the case of a monochromatic beam .",
    "the application of camelotto the control of intense lasers with a wider spectrum , as it is the case for femtosecond lasers , must be investigated .",
    "another limitation of the method lies in the computation time . for intense lasers ,",
    "the correction frequency is small ( typically a fraction of hertz ) .",
    "camelotcould therefore be used assuming a reasonable increase of computation speed . for real - time compensation of atmospheric turbulence in a an adaptive optics loop ,",
    "a significant effort is requested to manage control frequencies above several hundred of hertz .",
    "application of the method to imaging systems with complicated pupil transmittance is also of interest ."
  ],
  "abstract_text": [
    "<S> the control of the optical quality of a laser beam requires a complex amplitude measurement able to deal with strong modulus variations and potentially highly perturbed wavefronts . </S>",
    "<S> the method proposed here consists in an extension of phase diversity to complex amplitude measurements that is effective for highly perturbed beams . named camelotfor complex amplitude measurement by a likelihood optimization tool </S>",
    "<S> , it relies on the acquisition and processing of few images of the beam section taken along the optical path . </S>",
    "<S> the complex amplitude of the beam is retrieved from the images by the minimization of a maximum a posteriori error metric between the images and a model of the beam propagation . </S>",
    "<S> the analytical formalism of the method and its experimental validation are presented . </S>",
    "<S> the modulus of the beam is compared to a measurement of the beam profile , the phase of the beam is compared to a conventional phase diversity estimate . </S>",
    "<S> the precision of the experimental measurements is investigated by numerical simulations .    </S>",
    "<S> 99    r.  b. shack and b.  c. plack , `` production and use of a lenticular hartmann screen ( abstract ) , '' j.  opt .  </S>",
    "<S> .  am . * </S>",
    "<S> 61 * , 656 ( 1971 ) .    </S>",
    "<S> j.  primot , `` three - wave lateral shearing interferometer , '' appl . opt . * 32 * , 62426249 ( 1993 ) .    </S>",
    "<S> d.  l. misell , `` an examination of an iterative method for the solution of the phase problem in optics and electron optics : i. test calculations , '' j.  phys .  </S>",
    "<S> d : appl .  </S>",
    "<S> phys . * 6 * , 22002216 ( 1973 ) .    </S>",
    "<S> r.  a. gonsalves , `` phase retrieval and diversity in adaptive optics , '' opt .  </S>",
    "<S> eng . </S>",
    "<S> * 21 * , 829832 ( 1982 ) </S>",
    "<S> .    l.  m. mugnier , a.  blanc , and j.  idier , `` phase diversity : a technique for wave - front sensing and for diffraction - limited imaging , '' in `` advances in imaging and electron physics , '' , vol . </S>",
    "<S> 141 , p.  hawkes , ed . </S>",
    "<S> ( elsevier , 2006 ) , chap .  1 , pp . </S>",
    "<S> 176 .    </S>",
    "<S> j .- f . </S>",
    "<S> sauvage , t.  fusco , g.  rousset , and c.  petit , `` calibration and pre - compensation of non - common path aberrations for extreme adaptive optics , '' j.  opt .  </S>",
    "<S> soc .  </S>",
    "<S> am .  </S>",
    "<S> a * 24 * , 23342346 ( 2007 ) .    </S>",
    "<S> s.  fourmaux , s.  payeur , a.  alexandrov , c.  serbanescu , f.  martin , t.  ozaki , a.  kudryashov , and j.  c. kieffer , `` laser beam wavefront correction for ultra high intensities with the 200 tw laser system at the advanced laser light source , '' opt . </S>",
    "<S> express * 16 * , 1198711994 ( 2008 ) .    c.  roddier and f.  roddier , </S>",
    "<S> `` combined approach to the hubble space telescope wave - front distortion analysis , '' appl .  opt . * 32 * , 29923008 ( 1993 ) .    </S>",
    "<S> r.  w. gerchberg , `` super - resolution through error energy reduction , '' opt . </S>",
    "<S> acta * 21 * , 709720 ( 1974 ) .    </S>",
    "<S> j.  r. fienup , j.  c. marron , t.  j. schulz , and j.  h. seldin , `` hubble space telescope characterized by using phase - retrieval algorithms , '' appl . opt . * 32 * , 17471767 ( 1993 ) .    </S>",
    "<S> j.  r. fienup , `` phase - retrieval algorithms for a complicated optical system , '' appl </S>",
    "<S> .  opt . * 32 * , 17371746 ( 1993 ) .    </S>",
    "<S> h.  stark , ed . , _ image recovery : theory and application _ </S>",
    "<S> ( academic press , 1987 ) .    </S>",
    "<S> j.  r. fienup , `` phase retrieval algorithms : a comparison , '' appl </S>",
    "<S> .  opt . * 21 * , 27582769 ( 1982 ) .    s.  m. jefferies , m.  lloyd - hart , e.  k. hege , and j.  georges , `` sensing wave - front amplitude and phase with phase diversity , '' appl .  </S>",
    "<S> opt . * 41 * , 20952102 ( 2002 ) .    </S>",
    "<S> p.  almoro , g.  pedrini , and w.  osten , `` complete wavefront reconstruction using sequential intensity measurements of a volume speckle field , '' appl </S>",
    "<S> . opt . * 45 * , 85968605 ( 2006 ) .    </S>",
    "<S> m.  agour , p.  almoro , and c.  falldorf , `` investigation of smooth wave fronts using slm - based phase retrieval and a phase diffuser , '' journal of the european optical society - rapid publications * 7 * ( 2012 ) .    </S>",
    "<S> s.  t. thurman and j.  r. fienup , `` complex pupil retrieval with undersampled data , '' j.  opt .  </S>",
    "<S> soc .  </S>",
    "<S> am .  </S>",
    "<S> a * 26 * , 26402647 ( 2009 ) .    </S>",
    "<S> r.  j. noll , `` zernike polynomials and atmospheric turbulence , '' j.  opt . </S>",
    "<S> .  am . * </S>",
    "<S> 66 * , 207211 ( 1976 ) .    </S>",
    "<S> j.  idier , ed . , _ </S>",
    "<S> bayesian approach to inverse problems _ , digital signal and image processing series ( iste  / john wiley , london , 2008 ) .    </S>",
    "<S> e.  thibaut , `` optimization issues in blind deconvolution algorithms , '' in `` astronomical data analysis ii , '' , vol . </S>",
    "<S> 4847 , j .- </S>",
    "<S> l . </S>",
    "<S> starck and f.  d. murtagh , eds . </S>",
    "<S> ( proc .  </S>",
    "<S> soc .  photo - opt .  </S>",
    "<S> instrum .  </S>",
    "<S> eng . , 2002 ) , vol . 4847 , pp . </S>",
    "<S> .    k.  b. petersen and m.  s. pedersen , `` the matrix cookbook , '' ( 2008 ) . </S>",
    "<S> version 20081110 .    </S>",
    "<S> k.  kreutz - delgado , `` the complex gradient operator and the cr - calculus , '' arxiv e - prints ( 2009 ) .    </S>",
    "<S> b.  paul , j .- f . </S>",
    "<S> sauvage , and l.  m. mugnier , `` coronagraphic phase diversity : performance study and laboratory demonstration , '' astron . </S>",
    "<S> astrophys . </S>",
    "<S> * 552 * ( 2013 ) .    </S>",
    "<S> a.  blanc , l.  m. mugnier , and j.  idier , `` marginal estimation of aberrations and image restoration by use of phase diversity , '' j.  opt . </S>",
    "<S> soc .  </S>",
    "<S> am .  </S>",
    "<S> a * 20 * , 10351045 ( 2003 ) .    </S>",
    "<S> v.  bagnoud and j.  d. zuegel , `` independent phase and amplitude control of a laser beam by use of a single - phase - only spatial light modulator , '' opt . lett . </S>",
    "<S> * 29 * , 295297 ( 2004 ) .    </S>",
    "<S> l.  m. mugnier , t.  fusco , and j .- </S>",
    "<S> m . </S>",
    "<S> conan , `` mistral : a myopic edge - preserving image restoration method , with application to astronomical adaptive - optics - corrected long - exposure images . '' </S>",
    "<S> j.  opt .  </S>",
    "<S> soc .  </S>",
    "<S> am .  </S>",
    "<S> a * 21 * , 18411854 ( 2004 ) .    </S>",
    "<S> j.  j. dolne , p.  menicucci , d.  miccolis , k.  widen , h.  seiden , f.  vachss , and h.  schall , `` advanced image processing and wavefront sensing with real - time phase diversity , '' appl </S>",
    "<S> . opt . * 48 * , a30a34 ( 2009 ) .    </S>",
    "<S> t.  nishitsuji , t.  shimobaba , t.  sakurai , n.  takada , n.  masuda , and t.  ito , `` fast calculation of fresnel diffraction calculation using amd gpu and opencl , '' in `` digital holography and three - dimensional imaging , '' ( optical society of america , 2011 ) , p. dwc20 . </S>"
  ]
}