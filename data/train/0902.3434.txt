{
  "article_text": [
    "using quantum phenomena to perform new modes of computation is a daunting challenge  @xcite .",
    "significant achievements in the theory of quantum computation include the development of error correction , fault - tolerance  @xcite , and scalability of quantum circuits  @xcite .",
    "however , in order to build large scale quantum processors , many individual quantum systems must be manipulated with extraordinary precision and accuracy .",
    "a prerequisite for this level of quantum control is precise characterization of the underlying dynamics and its response to control fields , so - called hamiltonian engineering  ( @xcite and references therein ) .",
    "this is especially crucial for manufactured devices such as solid state quantum bits ( qubits ) , e.g. quantum dots ( fig .",
    "[ fig : siqubits ] ) or superconducting quantum interference devices ( squids ) .",
    "any manufacturing process will introduce variations so it is important to empirically identify the control relationship for each component . in a large - scale quantum computer , it is desirable to be able to achieve this using _ in situ _ resources , i.e. , initialization , control actuators and measurement capabilities already present for performing computation .",
    "the canonical method for assessing quantum dynamics is quantum process tomography ( qpt )  @xcite .",
    "this involves initialization of a quantum system in a ( complete ) set of states , allowing it to evolve under the dynamics under consideration , and then performing an informationally complete measurement on the output state for each input . from this set of input - output data , the superoperator , or completely positive ( cp ) map , governing the quantum evolution of the system",
    "can be reconstructed .",
    "this may then be repeated for different evolution times to obtain an estimate of the lindblad operators ( generators of the dynamics )  @xcite . for control purposes",
    ", qpt would be performed for a variety of actuator settings to build up a map of the control space .",
    "a potential disadvantage of qpt is the need for _ ab initio _ initialization and measurement outside of the computational basis , a capability which may not exist in the absence of characterization in the first place .",
    "it is usually argued that initialization and measurement in an arbitrary basis can be achieved by unitary rotation of a fixed basis , however this pre - supposes that the system response to control fields has already been characterized , a vicious circle .",
    "previous work has addressed this issue for the case of a single qubit subject to multiple control hamiltonians , decoherence , and imperfect subspace confinement  @xcite . here , we extend the basic idea of hamiltonian characterization to two coupled qubits with an unknown generic internal hamiltonian and control hamiltonian response .",
    "this paper is organized as follows . in section  [ sec:2 ]",
    "we discuss the basic principles of hamiltonian tomography for a two - qubit system with a fixed but unknown hamiltonian , assuming only the ability to measure the system at specific times in a fixed measurement basis , but no control or _ a priori _ knowledge of the system .",
    "we also deliberately exclude the ability to perform local operators on either qubit , or the ability to initialize the system in states other than the measurement basis states .",
    "our approach differs in this regard from related work on two - qubit hamiltonian identification using concurrence spectroscopy  @xcite or optimal experiment design  @xcite .",
    "these approaches may be preferable for certain types of systems but have some limitations as they presume the single qubit dynamics can be fully characterized independently of the inter - qubit coupling , which is required to prepare the two - qubit system in superposition states by applying local rotations . using concurrence also limits us to reconstructing the non - local part of the two - qubit hamiltonian . thus",
    ", this approach may be well - suited for some systems e.g. , with weak - coupling and non - local interaction hamiltonians , but may be problematic for other systems .",
    "the approach in this paper should be seen as complementary to these works .    in section  [ sec:3 ] we discuss how to extract the relevant system parameters from the noisy measurement data , accurately and robustly .",
    "the difficulty of this task is greatly magnified compared to the single qubit case due to the number of parameters to be determined , as well as the increased signal complexity . a nave approach using straightforward least - squares error minimization failed completely when applied to noisy data from simulated experiments .",
    "the power spectrum of the signal ( which was sufficient for the single qubit case ) is still useful , but no longer an optimal frequency estimator in the presence of multiple frequencies , and obtaining accurate estimates of the amplitudes of different frequency components is very difficult . for these reasons bayesian analysis",
    "is employed to determine the signal parameters , which is shown to result in significant improvements in the accuracy and robustness of the procedure .    in section  [ sec:4 ]",
    "we show how to reconstruct the total hamiltonian , or more precisely , its matrix representation with respect to the fixed measurement basis , from the estimated parameters .",
    "unlike the single qubit case , calculating the @xmath0 matrix elements of the two - qubit hamiltonian from the @xmath1 parameters estimated from the @xmath0 measured signals is non - trivial , and requires several optimization steps , from identifying the most likely level structure from the set of transitions frequencies , to determining the magnitudes and phases of the hamiltonian matrix elements that provide the best fit with the estimated parameters .",
    "the analysis also shows that the fixed hamiltonian can be determined only up to a global phase and sign , as well as three phases , which define @xmath2 transformations of the measurement basis states .",
    "if there are no other measurements or control available then these @xmath2 transformations of the basis states have no observable effect .",
    "modulo these unobservable parameters , we demonstrate that we can reconstruct the overall hamiltonian with very good accuracy from noisy data .",
    "in section  [ sec:5 ] we consider the more general case of control hamiltonian tomography .",
    "in particular , we are interested in characterizing hamiltonians @xmath3 that depend on a number of external parameters @xmath4 that can be varied experimentally , such as voltages applied to certain gate electrodes that allow us to vary confinement potentials , tunneling rates etc . by varying these parameters over time we can engineer complicated effective hamiltonians and efficiently achieve a wide range of control tasks from quantum state preparation to gate implementation  @xcite using powerful optimal control techniques  @xcite .",
    "however , effective control requires knowledge of the dependence of the hamiltonian on these parameters @xmath5 .",
    "when applying different hamiltonians , the previously unobservable phase factors now have practical effects and are critical for full control hamiltonian tomography .",
    "we show how to determine these phases , relative to a reference hamiltonian , using a simple two - step experiment , and how to use this information to achieve full control - hamiltonian tomography .",
    "finally , in section  [ sec:6 ] we discuss applications of the results , as well as future improvements and generalizations to our method .",
    "throughout this paper we assume that we are given a two - qubit system with an unknown hamiltonian , and a measurement apparatus that enables us to perform a fixed projective measurement on each qubit , including the ability to perform effectively simultaneous measurements on both qubits  .",
    "we denote the measurement basis states of the resulting four - outcome measurement by @xmath6 , @xmath7 , @xmath8 and @xmath9 .",
    "we then perform the following simple experiment :    1 .",
    "initialize the system in one of the four measurement basis states @xmath10 by performing simultaneous measurements on both qubits .",
    "2 .   let the system evolve for some time @xmath11 .",
    "3 .   perform simultaneous measurements on both qubits , projecting the system back into one of the four measurement basis states .    by repeating this experiment many times for a fixed evolution time @xmath11",
    ", we can estimate the probabilities @xmath12 , where @xmath13 is the time - evolved state and @xmath14 . by further repeating the experiment for different times @xmath15 for @xmath16",
    "we can stroboscopically capture the evolution of the probabilities @xmath17 for @xmath18 , yielding @xmath0 noisy signals as shown in fig .",
    "[ fig : datasignals ]   which is poissonian . in the large @xmath19 limit , and for @xmath20",
    ", this tends to gaussian noise . ] .",
    "what information about the hamiltonian can we extract from this data , and what is the most effective way to extract this information ?",
    "assume the evolution of the system is governed by a fixed hamiltonian according to the schrdinger equation @xmath21 expanding the hamiltonian @xmath22 with respect to its orthonormal eigenbasis @xmath23 , @xmath24 where @xmath25 are the ( real ) eigenvalues , and setting @xmath26 we obtain @xmath27 further defining @xmath28 , @xmath29 and @xmath30 we obtain @xmath31 where the phase terms satisfy @xmath32 and    @xmath33    if the system is initialized in one of the measurement basis states @xmath14 , its time - evolved state @xmath13 under the action of @xmath22 is given by @xmath34 and since @xmath35 , its projection onto the measurement basis state @xmath36 at time @xmath11 is @xmath37 hence , the probability @xmath12 of the outcome @xmath36 for a projective measurement of @xmath13 is @xmath38     \\left[\\sum_{\\mu=1}^4 s_{k\\ell;\\mu } e^ { i(\\lambda_\\mu t-\\delta_{k\\ell;\\mu})}\\right]\\\\    = \\sum_{\\mu=1}^4 s_{k\\ell;\\mu}^2 + 2\\sum_{\\nu>\\mu }       s_{k\\ell;\\mu } s_{k\\ell;\\nu } \\cos(\\omega_{\\mu\\nu}t - \\delta_{k\\ell;\\mu\\nu}),\\end{gathered}\\ ] ] where @xmath39 , and using @xmath40 , @xmath41 where the coefficients are    [ eq : coeff ] @xmath42    eq .  ( [ eq : coeff ] ) shows that the observed dynamics are completely determined by the transition frequencies @xmath43 , the phase differences @xmath44 and the ( real ) coefficients @xmath45 , @xmath46 and @xmath47 , from which we can reconstruct the hamiltonian @xmath48 defined by @xmath49 where @xmath50 , which is related to the actual hamiltonian @xmath51 by @xmath52 where @xmath53 .",
    "the last term is simply a global energy shift which has no observable consequences in general .",
    "the diagonal operator @xmath54 represents the @xmath2 degree of freedom for redefining each measurement basis state . with only a single constant hamiltonian , and preparation and measurement in a single fixed basis only",
    ", we can not completely determine the hamiltonian .",
    "the first task is to analyze the measurement traces eq .",
    "( [ eq : probs ] ) and extract signal parameters eq .  ( [ eq : coeff ] ) and the frequencies @xmath43 . for convenience",
    "we label the transition frequencies of the system @xmath55 for @xmath56 , assuming @xmath57 , and define the vectors @xmath58 , @xmath59 and @xmath60 for @xmath61 .",
    "the first step towards identifying the hamiltonian @xmath48 is to extract the six transition frequencies @xmath62 and @xmath63 linear coefficients @xmath64 , @xmath65 , and @xmath47 for each of the 16 signals .",
    "although there are @xmath66 parameters , the problem would be relatively simple if @xmath17 was known with infinite precision for a set of sample times @xmath15 . in practice ,",
    "the accuracy of @xmath67 is limited by noise , in our case projection noise due to the finite number of repetitions @xmath19 , which renders the problem one of parameter estimation for a harmonic signal with multiple frequencies and phases .",
    "problems of this type are common in engineering from acoustics to image processing , and many techniques have been developed , but our parameter estimation problem is non - trivial due to the large number of parameters involved .    according to eq .",
    "( [ eq : coeff ] ) the traces @xmath17 should be linear combinations of the @xmath63 basis functions @xmath68 , @xmath69 for @xmath56 , and @xmath70 , i.e. , @xmath71 and our objective is to find parameters @xmath55 , @xmath72 , @xmath73 and @xmath47 that maximize the likelihood of the measured data . setting @xmath74 , where @xmath75 denotes the _ approximate _ value of @xmath67 derived from the measurement data , one way to proceed is to try to fit the parameters to minimize the squared @xmath76-norm of the error @xmath77 where @xmath78 with @xmath79 and @xmath80 as usual . however , for problems with a large number of noisy data points and a large number of parameters , as in our case , finding a solution close to the ( unknown ) global minimum of the error using brute - force optimization over all system parameters at once is difficult at best .",
    "we tested this strategy and in most cases achieved only poor results .    instead of minimizing the global error",
    ", we can alternatively try to maximize the related likelihood function @xmath81.\\ ] ] note that we have implicitly assumed here that the signals @xmath17 are independent and subject to gaussian white noise with variance @xmath82 , assumptions that are not strictly valid in our case .",
    "hermitian symmetry of the hamiltonian requires @xmath83 and @xmath84 but we will enforce this symmetry later by averaging the estimated coefficients    [ eq : ab_symmetrization ] @xmath85    the gaussian noise model is not strictly valid either ; if the measurements are projection - noise limited then a poissonian error model would be more accurate , but we shall see that this is nonetheless a good approximation .",
    "the main advantage of the latter formulation is that we can eliminate the explicit dependence on the linear coefficients @xmath64 , @xmath86 , @xmath47 and the noise variances @xmath87 by integration over suitable priors to obtain an explicit expression for the probability of a particular model given the observed data @xmath88 that depends only on the six transition frequencies @xmath62 , rather than the @xmath89 parameters in the full model .",
    "following standard bayesian analysis  @xcite we obtain @xmath90^{(13-n)/2},\\ ] ] where the averages are defined by    @xmath91    the components @xmath92 are essentially the orthogonal projections of the data onto a set of orthonormal basis vectors @xmath93 @xmath94 the orthonormal basis vectors are derived from the ( non - orthogonal ) basis functions @xmath95 defined above , evaluated at the respective sample times @xmath15 , via @xmath96 where @xmath97 is a @xmath98 matrix whose columns @xmath99 are the normalized eigenvectors  @xmath100  of the @xmath101 matrix @xmath102 with @xmath103 the objective is to find @xmath62 that maximizes @xmath104 , or equivalently , the log - likelihood function @xmath105.\\ ] ]     with estimated error - bars of system 1 . when both @xmath106 and @xmath19 are large ( top ) the error - bars are nearly invisible , and the estimated and actual values are almost indistinguishable .",
    "when @xmath106 and @xmath19 are both small ( bottom ) , the error - bars are significantly larger , mainly due to increased noise variances @xmath82 ; yet the actual and estimated values for the coefficients are still almost indistinguishable .",
    "this suggests that the estimated coefficients are in fact much more accurate than the uncertainty estimates suggest . ]",
    "note that @xmath106 and @xmath107 are constants , while @xmath108 indirectly depends on @xmath62 via the basis functions @xmath95 .",
    "it can be shown that the corresponding optimal coefficients are    [ eq : optcoeffs ] @xmath109    where @xmath110 is shorthand notation for the expectation values @xmath111 of the linear coefficients of the basis functions , given the optimal frequencies @xmath62 and the data @xmath88 .",
    "furthermore  @xcite , @xmath112 we can similarly derive expressions for second moments @xmath113 where @xmath82 is the noise variance of the @xmath114th signal , which can be approximated by its estimated expectation @xmath115.\\ ] ] note that for @xmath116 eq .",
    "( [ eq:2ndmoments ] ) is simply the variance of the parameter @xmath117 , which gives an estimate of the uncertainty @xmath118 of the coefficient @xmath117 @xmath119 fig .",
    "[ fig : coeffuncert ] shows that for a sufficiently large number of data points @xmath106 and experiment repetitions per data point , @xmath19 , these uncertainties can be made very small indeed . for @xmath106 and/or @xmath19 small ,",
    "the uncertainties are much larger , but simulations for our specific problem suggest that the estimated values are generally still very close to the actual values even for small @xmath106 and/or @xmath19 , much closer than the uncertainty estimates would suggest .",
    "although the log - likelihood function  ( [ eq : logp ] ) depends explicitly only on the six frequencies @xmath120 rather than the full @xmath1 model parameters , finding its ( global ) maximum is not trivial as the log - likelihood is sharply peaked with many local extrema , and thus computationally efficient gradient - based optimization algorithms are likely to get trapped in local extrema if the starting point @xmath121 is chosen randomly .",
    "an alternative is to use global search algorithms such as pattern search or genetic algorithms but these are computationally expensive and the results for our problem proved inaccurate . to circumvent this problem",
    "we adopt a combination strategy .     of system 1 .",
    "although the power spectrum is noisy , the log - plot of @xmath122 of the measured signals shown in fig .",
    "[ fig : datasignals ] shows six well - defined peaks for @xmath123 in addition to the peak at @xmath124 .",
    "the inset shows the filtered power spectrum @xmath125 , from which the six peaks @xmath55 can easily be identified using standard peak detection . ]",
    "we can first estimate the resonant frequencies by looking for peaks in the power spectra @xmath126 using spectral filtering combined with a basic peak finding routine , we locate ( up to ) six peaks @xmath55 in the combined power spectrum @xmath127 as illustrated in fig .",
    "[ fig : powerspec ] , which are then used as input @xmath128 to an optimization routine based on the bfgs quasi - newton method with cubic line search  @xcite to find the maximum of the log - likelihood  ( [ eq : logp ] ) .",
    "although the discrete fourier transform is _ not _ an optimal frequency estimator for a signal with multiple frequencies , it proved generally effective in providing good starting values for the log - likelihood optimization routine , provided that the total sampling time ( signal length ) @xmath129 was sufficiently long to resolve the resonant peaks .",
    "has only five peaks @xmath123 in addition to the peak at @xmath124 .",
    "this could mean that the system has only five distinct transition frequencies , or that the measured signals are not sufficient to resolve two ( closely spaced ) transition frequencies . ]     for system 12 with five - peak power spectrum shown in fig .",
    "[ fig : powerspec2 ] shows symmetry about @xmath130 as @xmath131 with twin peaks for @xmath132 indicating that the most probable model on this subspace of the parameter space is a six - frequency model . ]    .log - likelihood for different five and six frequency models and actual transition frequencies for system 12 with five - peak power spectrum shown in fig .",
    "[ fig : powerspec2 ] . [ cols=\"<,^,^,^,^,^,^,^\",options=\"header \" , ]     the linear coefficients @xmath72 , @xmath73 and @xmath47 are then estimated from the maximization of eq .",
    "( [ eq : logp ] ) and from  eq.([eq : optcoeffs ] ) . taking the median of the relative errors @xmath133 where @xmath134 range from @xmath135 to @xmath136 and @xmath56 , as a general measure of the quality of the fit , table  [ table : err_a_b_c ] shows that the average errors in the coefficients @xmath72 , @xmath73 and to a lesser extent @xmath47 , are generally at least one order of magnitude larger than the error in the frequency estimates . overall",
    "the quality is still good , however , with the ( average ) errors ranging from a fraction of a percent to less than @xmath137% for @xmath138 , and much less for @xmath47 , depending on the number of data points @xmath106 and the accuracy of the data points determined by the number of experiment repetitions per data point , @xmath19 .",
    "[ fig : histo ] shows the distribution of the errors for both the least and greatest number of experiments .",
    "apart from a few outliers , the distribution follows a roughly exponential form with most estimates being within a fraction of a percent of the true values , even for the least number of experimental samples .",
    "b ) @xmath139 .",
    "inset graphs magnify the region around the origin showing the general distribution of errors which is roughly exponential .",
    "the numbers 66 , 12 , 78 , 73 and 77 in a ) refer to outliers systems . ]",
    "table  [ table : err_omg_mean ] shows that increasing @xmath19 and thus the accuracy of the data points does not improve the accuracy of the initial frequency estimates obtained from the power spectrum at all , while doubling @xmath106 tends to reduce the error by more than half .",
    "this is what we expect as once @xmath19 is large enough to permit discrimination of the resonant peaks from the noise floor , little is gained by increasing @xmath19 .",
    "doubling @xmath19 does reduce the error for the optimized frequencies obtained from our bayesian analysis , although if the accuracy of frequency estimates alone is considered , doubling the number of data points in preferable to doubling @xmath19 . increasing the accuracy ( by doubling @xmath19 ) is more effective in reducing the errors in the coefficients @xmath140 , @xmath141 , @xmath142 , but the contour plots in fig .",
    "[ fig : error_contour_plots ] show that the errors decrease faster with @xmath106 , i.e. , increasing the number of data points is generally still preferable .",
    "mean ( relative ) errors for the frequencies @xmath143 and coefficients @xmath140 , @xmath141 , @xmath142 .",
    "the frequencies show the smallest errors ( down to @xmath144 ) , whilst the @xmath140 coefficients show errors up to a few percent ( @xmath145 ) for the shortest signal lengths and greatest projection noise . ]",
    "once the frequencies @xmath62 and amplitudes @xmath64 , @xmath86 and @xmath47 have been extracted from the measured data using parameter estimation , reconstructing the hamiltonian ( up to equivalence ) requires at least two further steps : identification of the resonant frequencies with transitions @xmath146 between eigenstates @xmath147 and @xmath148 of the system , and computation of the parameters @xmath149 and @xmath44 in eq .",
    "( [ eq : tildeh ] ) from the coefficients @xmath64 , @xmath86 and @xmath47 . for a four - level system",
    "we have three primary transitions @xmath150 between adjacent energy levels and three other transitions @xmath151 , which must satisfy    [ eq : freqrel ] @xmath152    we identify the possible level structure ( up to inversion ) by examining the relationships between the frequencies . in the generic case ,",
    "i.e. , when there are six distinct transition frequencies , @xmath153 , it follows immediately from eqs  ( [ eq : freqrel ] ) that @xmath154 , and the primary transitions are @xmath155 .",
    "closer inspection shows that there are @xmath156 possible arrangements of the six transition frequencies as shown in fig .",
    "[ fig : levels ] , and the exact transition frequencies @xmath62 must satisfy @xmath157 for one of the following matrices    @xmath158    given the estimated frequencies @xmath159 the most likely case is that for which @xmath160 assumes its minimum , which should be close to @xmath161 , and significantly smaller than the errors for the other cases .",
    "a larger minimum error indicates and none of the possibilities is likely , suggesting that the system may not be a hamiltonian four - level system .",
    "similarly , if we have two cases for which the error the close to the minimum , this would be an indication that further data is required to resolve the ambiguity .",
    "once the observed frequencies @xmath55 have been matched with actual transitions @xmath146 , we can associate the corresponding coefficients @xmath162 , @xmath163 for @xmath56 with their respective transitions , i.e. , we have @xmath164 and @xmath165 , and determine the phase differences @xmath166 where @xmath167 is the four - quadrant arc tangent of @xmath168 .",
    "if the estimated parameters are good , then the resulting @xmath44 should satisfy @xmath169 ( mod @xmath170 ) , @xmath171 ( mod @xmath170 ) , and    [ eq : delta_constraints ] @xmath172    due to the enforced symmetrization  ( [ eq : ab_symmetrization ] ) of the coefficients @xmath64 and @xmath86 , the phase terms should satisfy @xmath173 .",
    "minor violations of  ( [ eq : delta_constraints ] ) are to be expected , and can be mitigated , and the accuracy of the final reconstructed hamiltonian improved by minimizing the constraint violations @xmath174 , where @xmath175 with @xmath176 and @xmath177 for @xmath178 in a further refinement step , starting with the values for @xmath44 obtained from ( [ eq : delta ] ) .",
    "this refinement tries to minimize the discrepancy between the estimated signal parameters and those expected from an underlying hamiltonian model .",
    "it must be stressed , however , that larger violations of the constraints are indicative of significant errors , which may even be exacerbated by such a refinement .",
    "in fact , fig .",
    "[ fig : errorcorrel ] shows that there is a strong correlation between the maximum constraint violation prior to refinement @xmath179 and the relative error of the final estimated hamiltonian .     of the estimated hamiltonian with @xmath180",
    "as defined in  ( [ eq : deltah ] ) vs the maximum constraint violation  ( [ eq : maxconstraintvio ] ) on a log - log scale for our 100 systems and 20 data sets per system ( total of 2000 data points ) shows a strong correlation , suggesting that the maximum constraint violation ( prior to refinement ) is a good predictor of the accuracy of the estimated hamiltonian . ]",
    "once the optimal values for @xmath44 have been found , we calculate the products @xmath181 labelling the rhs of the previous equation @xmath182 and defining the column vector @xmath183 and the @xmath184 matrix @xmath185 @xmath186 we can express eqs  ( [ eq : mkell ] ) and ( [ eq : coeff]c ) as follows @xmath187 for @xmath178 . to reconstruct the hamiltonian  ( [ eq : tildeh ] ) , we must determine the coefficients @xmath149 by solving  ( [ eq : ms ] ) .",
    "each @xmath185 is a real symmetric matrix whose off - diagonal elements @xmath182 , @xmath188 , are determined by eq .",
    "( [ eq : mkell ] ) .",
    "the diagonal elements @xmath189 are unknown .",
    "however , we know that @xmath185 should be a projector onto the 1d space spanned by @xmath183 , and the second equation in ( [ eq : ms ] ) determines the norm of @xmath183 as well as the vector of diagonal elements @xmath190 .",
    "thus , to determine the diagonal elements of @xmath185 and the corresponding eigenvector @xmath183 , we note that a rank-@xmath135 projector @xmath191 with matrix entries @xmath192 must satisfy the condition @xmath193 thus , given the off - diagonal elements of @xmath185 , we choose the diagonal elements of @xmath185 such as to minimize the norm of the error @xmath194 , and take @xmath183 to be the eigenvector corresponding to the eigenvalue of @xmath185 closest to @xmath135 , normalized to ensure @xmath195 .",
    "it is important to carefully choose the parameters for the optimization here to ensure we find the diagonal elements corresponding to the global minimum .",
    "ideally , the residual error @xmath196 should be @xmath197 or less .",
    "we implemented and tested the algorithm for our 100 hamiltonians .",
    "we were able to correctly identify the level structures for all but one case : system 73 , which has two nearly identical transition frequencies with @xmath198 and @xmath199 , for @xmath200 data points sampled at @xmath201 , @xmath202 , and @xmath203 experiment repetitions per data point .",
    "even for this system , we were able to correctly identify the level structure by doubling the number of data points @xmath106 , with the exception of @xmath204 where at least @xmath205 data points were needed .",
    "of course , in practice more data points would be required for such a system to be confident that the identification is correct , as explained earlier .",
    "@xmath206 & 125 & & & 250 & & & 500 & & & 1000 & & + & @xmath207 & @xmath208 & @xmath209 & @xmath207 & @xmath208 & @xmath209 & @xmath207 & @xmath208 & @xmath209 & @xmath207 & @xmath208 & @xmath209 + 16,385 & 0.40 & 11 & 1 & 0.27 & 5 & 0 & 0.18 & 2 & 0 & 0.13 & 4 & 0 + 8,193 & 0.57 & 22 & 0 & 0.41 & 8 & 0 & 0.31 & 8 & 1 & 0.19 & 4 & 0 + 4,097 & 0.87 & 41 & 5 & 0.66 & 25 & 2 & 0.41 & 15 & 1 & 0.28 & 7 & 1 + 2,049 & 1.12 & 60 & 7 & 0.91 & 45 & 6 & 0.58 & 19 & 4 & 0.44 & 12 & 2 + 1,025 & 1.81 & 81 & 13 & 1.32 & 64 & 8 & 0.84 & 34 & 5 & 0.63 & 31 & 4 +    to gauge the overall accuracy of the estimated hamiltonians we would like to compute the norm of the error @xmath210 , or the relative error @xmath211 , where we choose the operator norm here .",
    "however , calculating the norm of the error is complicated by the fact that we can only reconstruct the hamiltonian up to the diagonal matrix @xmath54 and energy inversion symmetry",
    ". thus we must compensate for the phases that are `` unobservable '' in our model by setting @xmath212 with @xmath213 , where @xmath214 and @xmath215 is the complex phase of the @xmath216 matrix element of @xmath217 , etc .",
    "table  [ table : err_h ] shows the results of the percentage relative errors @xmath211 for our 100 test systems , for different values of @xmath106 and @xmath19 .",
    "medians of the relative errors range from @xmath218% for @xmath219 and @xmath220 to @xmath221% for @xmath222 and @xmath201 .",
    "we have seen that our procedure can characterize a single hamiltonian up to a ( physically irrelevant ) global energy shift , and three relative phases @xmath223 for @xmath224 , due to the freedom to redefine each of the measurement basis vectors by a @xmath2 phase minus an overall phase . if we can only measure the system in a fixed basis and prepare it in the measurement basis states , and the evolution is determined by a single fixed hamiltonian",
    ", then we have determined all observable parameters . however , for the system to be controllable , we require at least two ( noncommuting ) hamiltonians , or more generally we must have the ability to modify the hamiltonian by changing control parameters @xmath225 , e.g. , by applying external fields or varying applied gate voltages , etc . in this case",
    "we can still choose the phases @xmath226 for one `` reference '' hamiltonian @xmath227 as we wish , e.g. , @xmath228 but the phases @xmath229 for all other hamiltonians @xmath5 are now observable and thus relevant , and complete control hamiltonian reconstruction therefore requires that we identify them .    to achieve this , note that if can initialize the system in the superposition state @xmath230 and measure the time - evolved state @xmath231 with @xmath232 $ ] , @xmath233 $ ] then @xmath234 d_{\\vec{f}}\\ket{\\phi}|^2    = |\\bra{\\ell}\\tilde{u}_\\vec{f}(t ) d_{\\vec{f}}\\ket{\\phi}|^2\\ ] ] shows that the phases @xmath235 that determine @xmath236 are now observable as @xmath237 no longer commutes with the initial state @xmath238 . as @xmath239 is fully determined by previous steps , if the initial state @xmath238 is known , then the only unknown parameters in eq .",
    "( [ eq : psuper ] ) are @xmath240 for @xmath224 . given a set of measured values @xmath241 for @xmath242",
    ", we can determine the unknown parameters @xmath240 by minimizing the least - squares error @xmath243 where @xmath244 and @xmath245 for @xmath246 .",
    "an explicit expression for @xmath247 derived in appendix  [ app : b ] shows that we can in principle determine all the phases if the initial state satisfies @xmath248 for all @xmath249  .",
    "moreover , it is advantageous to choose a balanced initial state , @xmath250 for all @xmath249 , if possible , to maximize signal to noise ratios .     under reference",
    "hamiltonian ( system 5 ) and error @xmath251 from ideal balanced initial state .",
    "we selected the second minimum ( which is the global minimum for @xmath252 ) at @xmath253 as initial evolution time @xmath254 for the @xmath255 estimation step . ]",
    "estimation as a function of signal lengths @xmath106 and projection noise level @xmath19 of the measured traces @xmath242 . in all cases the most accurate estimates for @xmath48 from the previous step , i.e. @xmath219 & @xmath220 , were used . ]    to prepare such an initial state , we can use the reference hamiltonian @xmath256 . unless the reference hamiltonian is such that one or more of the measurement basis states are completely decoupled from state @xmath257 , it is almost certain that the time - evolved state @xmath258 with @xmath259 will satisfy @xmath260 for all @xmath249 for at least some @xmath261 .",
    "thus , having characterized the hamiltonians @xmath3 for different control settings @xmath225 up to the phases @xmath235 , all we need to do is to select a suitable reference hamiltonian @xmath227 , and find a time @xmath254 such that the time - evolved state @xmath262 satisfies @xmath263 .",
    "this is generally not difficult .",
    "for instance , we randomly choose the hamiltonian for test system @xmath264 as our reference hamiltonian .",
    "[ fig : phi_t ] shows that there are several times @xmath265 $ ] at which the populations @xmath266 of all levels ( in the measurement basis ) are approximately equal .",
    "we pick one of these times @xmath267 , set @xmath268 , and obtain the measurement traces @xmath242 as follows :    1 .",
    "initialize system in measurement basis state @xmath257 .",
    "2 .   let it evolve under hamiltonian @xmath256 for time @xmath254 .",
    "3 .   change control settings to @xmath225 and let system evolve for @xmath11 time units under hamiltonian @xmath269 .",
    "4 .   perform measurement @xmath270 outcome @xmath246 .",
    "as before we repeat this experiment @xmath19 times for a fixed @xmath11 to estimate @xmath242 ( number of times the outcome was @xmath271 divided by @xmath19 ) , and then repeat for different times @xmath272 to obtain estimates for @xmath242 .",
    "@xmath206 & 125 & & & 250 & & & 500 & & & 1000 & & + & @xmath207 & @xmath208 & @xmath209 & @xmath207 & @xmath208 & @xmath209 & @xmath207 & @xmath208 & @xmath209 & @xmath207 & @xmath208 & @xmath209 + 16,385 & 0.89 & 40 & 2 & 0.70 & 27 & 1 & 0.56 & 14 & 1 & 0.45 & 6 & 1 + & 2.12 & 78 & 12 & 1.54 & 75 & 9 & 1.00 & 50 & 6 & 0.76 & 35 & 1 + 8,193 & 1.09 & 54 & 5 & 0.84 & 35 & 0 & 0.69 & 28 & 1 & 0.53 & 17 & 1 + & 2.60 & 89 & 24 & 2.21 & 86 & 14 & 1.66 & 77 & 10 & 1.08 & 52 & 5 + 4,097 & 1.48 & 68 & 7 & 1.12 & 58 & 5 & 0.91 & 43 & 5 & 0.61 & 26 & 2 + & 3.47 & 96 & 41 & 3.13 & 94 & 27 & 2.20 & 87 & 13 & 1.45 & 65 & 7 + 2,049 & 2.24 & 88 & 15 & 1.45 & 74 & 7 & 1.12 & 55 & 7 & 0.78 & 37 & 4 + & 6.06 & 98 & 67 & 3.91 & 93 & 37 & 2.85 & 89 & 25 & 2.25 & 78 & 16 + 1,025 & 3.14 & 95 & 29 & 2.44 & 90 & 18 & 1.60 & 80 & 8 & 1.22 & 59 & 6 + & 8.36 & 98 & 76 & 5.92 & 96 & 59 & 4.50 & 95 & 48 & 3.00 & 88 & 32 +    we tested the phase estimation procedure for the estimated hamiltonians obtained in the previous step .",
    "for each of the @xmath273 systems we first generated ( simulated ) measurement signals for @xmath242 of varying length @xmath274 and levels of projection noise @xmath19 .",
    "the number of points ranged from @xmath275 to @xmath276 data points , sampled at @xmath277 fixed as before ; the measurement repetitions @xmath19 from @xmath276 to @xmath278 . in the reconstruction of the phases ,",
    "we only assume we know the estimated @xmath256 , hence the estimated @xmath279 , and the estimated @xmath280 , determined in section  [ sec:4 ] .",
    "while the most accurate estimates for the frequency and linear coefficient estimation step ( step 1 ) were obtained for the longest signals ( @xmath281 ) , we find that the accuracy of the phase estimation step peaks at around @xmath282 , and that longer signals are in fact highly detrimental ( fig .",
    "[ fig : phaseestimcontour ] ) .",
    "this may seem very surprising at first but can be at least partly explained by the fact that even small inaccuracies in the initial estimates , especially for the frequencies , will accumulate over time and increase the discrepancy between the projected evolution of the system based on our hamiltonian estimates and the true evolution .    based on these results we settled for signals of length @xmath283 with @xmath284 measurement repetitions per data point for the final phase estimation step .",
    "for each of the @xmath285 estimated hamiltonians @xmath48 obtained in the first step  corresponding to the @xmath273 different test systems , as well as four levels of projection noise @xmath286 and five signal length @xmath274 for @xmath287 with @xmath277 fixed , each  we estimated the phases @xmath223 , and used the results to reconstruct the total hamiltonian @xmath288 .",
    "table  [ table : err_h2 ] shows the results in terms of the median of relative errors . for comparison",
    "we include the table the results obtained had signals of length @xmath289 been used instead .",
    "comparison of the numbers clearly shows that longer signals are detrimental for the phase estimation step .",
    "in addition to substantially decreased accuracy , longer signals also slowed down the numerical optimization , making it more difficult for the routine to find the global minimum . in view of the complicated dependence of @xmath242 ( see appendix [ app : b ] ) on the parameters @xmath223 , @xmath224 , we initially explored population - based ( global ) optimization strategies , especially evolutionary algorithms , but found that it was substantially slower and far _ less _ effective in finding the global minimum of the error eq .",
    "( [ eq : err_delta ] ) than a gradient - based ( bfgs - type ) local optimization algorithm .",
    "in fact , for short signals the local optimization routine generally succeeded in finding the global minimum in a single run , starting with a random guess for @xmath290 , although the optimization was repeated with several different initial guesses to increase the probability that we had indeed found the ( globally ) best value for @xmath291 .",
    "we have presented a method for characterizing the hamiltonian and its dependence on external control parameters , which is a pre - requisite for hamiltonian engineering and coherent control of the system s evolution , for a generic two - qubit system , assuming only the ability of preparation and measurement in a fixed basis .",
    "analysis of simulated measurement data shows that the task of estimating the parameters from the complex , noisy measurement signals with multiple frequencies , and reconstructing the hamiltonian is very challenging , and requires a carefully designed multi - step approach , combining spectral analysis , bayesian analysis and several carefully designed optimization steps to reconstruct the energy level structure and matrix representation of the hamiltonian . in the absence of any control ,",
    "the hamiltonian can only be reconstructed up to three phases , due to the freedom to redefine the measurement basis by @xmath2 phase rotations .",
    "this symmetry can be broken if the system can be prepared initially in a suitable superposition state , and we exploit this fact to achive full control hamiltonian tomography in a simple two step procedure .",
    "the bayesian analysis assumes a gaussian noise profile which , though not strictly accurate , works well , especially in the large @xmath19 limit .",
    "any significant deviations from gaussian noise ( e.g. poissonian statistics for small @xmath19 for @xmath292 ) will tend to make the log - likelihood estimates worse , and thus our estimates of the confidence that the model fits the data are conservative  @xcite .",
    "more accurate error estimates could be obtained using bayesian analysis with a poissonian noise model , though our results show that even a gaussian noise model results in a huge improvement of two orders of magnitude or more in the accuracy of the frequency estimates , compared to estimates obtained from simple spectral analysis .",
    "this turned out to be crucial for successful hamiltonian reconstruction .",
    "the frequency estimates obtained from the power spectrum combined with a simple least - squares error minimization to find the optimal spectral amplitudes proved to be too inaccurate for hamiltonian reconstruction , leading to inconsistent equation systems and significant errors , and any attempt to obtain estimates of the parameters by direct minimization of the least - squares error of the measurement signals and the expected signals resulted in reconstructed hamiltonians that were little better than random for our test systems .",
    "though we have implicitly assumed a hamiltonian model , i.e. , that incoherent effects will be negligible on the time scales of interest , any significant deviation from the assumed model , e.g. , significant decoherence or coupling to additional states outside the two - qubit subspace would result in low likelihoods of the chosen ( four - level ) hamiltonian model .",
    "such effects can easily be incorporated into the analysis by changing the basis functions , e.g. , using damped exponentials instead of sinusoids or including additional states , which we will consider in further work .",
    "furthermore , any prior information about the structure of the hamiltonian can be incorporated to make the bayesian analysis more efficient .",
    "thus , the method lends itself to adaptive protocols , as we can adaptively sample the system until certain targets for the likelihood or error estimates are met , ensuring that we perform enough measurements to get accurate estimates but no more than necessary .",
    "this is especially important as the number of measurements required will vary depending on the system .",
    "for instance , for a system with well spaced transition frequencies , a sharply peaked likelihood function with a clearly identifiable global maximum can be obtained with much less data than for a system with two almost degenerate transition frequencies .",
    "for control hamiltonian tomography , the small but non - zero inaccuracies in the initial estimation step lead to an optimum sampling time for the second step due to divergence of the model from the true system behavior at longer times . in principle",
    ", it should be possible to use this divergence to improve the initial estimates of the hamiltonians , and exploring such refinements could be an interesting avenue for future research .",
    "errors in the second step decreased with increased signal to noise ratio ( increasing @xmath19 ) , as the estimate of the phase parameters does not depend on the signal length , unlike frequency resolution",
    ". it would also be interesting to investigate the accumulation of errors in this multi - step estimation , especially how uncertainties in prior steps affect the accuracy of the bayesian estimation in subsequent stages .",
    "finally , in this paper we have dealt with the generic case .",
    "when the hamiltonian has exact degeneracies then the measurement signals will contain fewer than six frequencies . in this case , the level structure reconstruction becomes harder as the number of special sub - cases increases and we may not be able to uniquely identify the hamiltonian .",
    "although the set of hamiltonians with exact degeneracies is of measure zero , further study of these special cases may be of interest as one may want to specifically engineer hamiltonians with such level structures .",
    "we thank s. j. devitt and j. h. cole for discussions .",
    "sgs acknowledges funding from epsrc advanced research program grant rg44815 , epsrc qip interdisciplinary research collaboration ( irc ) and hitachi .",
    "dklo is supported by the scottish universities physics alliance ( supa ) and the quantum information scotland network ( quisco ) .",
    "this work is supported by the national research foundation & ministry of education , singapore .",
    "99    what is quantum computation ? , a. k. ekert , p. hayden , h. inamori , d. k. l. oi int . j. mod .",
    "a * 16 * , 3335 ( 2001 )",
    ".    frank gaitan ( editor ) , quantum error correction and fault tolerant quantum computing , ( crc press , 2008 ) .",
    "samuel l. braunstein and hoi - kwong lo ( editors ) , scalable quantum computers : paving the way to realization ( wiley , 2001 ) .    s. g. schirmer , hamiltonian engineering for quantum systems , in proceedings of 3rd ifac workshop on lagrangian and hamiltonian methods in nonlinear control ( nagoya , japan 2006 )",
    ".    s. g. schirmer , g. kandasamy , s. j. devitt , control paradigms for quantum engineering . in ieee proceedings of isccsp 2008 , malta , 12 - 14",
    "march 2008 , p966 .",
    "prescription for experimental determination of the dynamics of a quantum black box , i. l. chuang and m. a. nielsen , j. mod . opt .",
    "* 44 * , 2455 - 2467 ( 1997 ) .",
    "complete characterization of a quantum process : the two - bit quantum gate , j. f. poyatos , j. i. cirac and p. zoller , phys .",
    "* 78 * , 390 ( 1997 ) .",
    "r. kosut , i. a. walmsley and h. rabitz , optimal experiment design for quantum state and process tomography and hamiltonian parameter estimation , quant - ph/0411093 .    on the generators of quantum dynamical semigroups , g. lindblad , commun .",
    "* 48 * , 119 ( 1976 ) .",
    "experimental hamiltonian identification for controlled two - level systems , s. g. schirmer , a. kolli , d. k. l. oi , phys .",
    "a * 69 * , 050306(r ) ( 2004 ) .",
    "experimental hamiltonian identification for qubits subject to multiple independent control mechanisms , s. g. schirmer , a. kolli , d. k. l. oi , j. h. cole , in : proc .",
    "qcmc , glasgow 25 - 29 july 2004 ( aip 2004 ) .    identifying an experimental two - state hamiltonian to arbitrary accuracy , j. h. cole , s. g. schirmer , a. d. greentree , c. j. wellard , d. k. l. oi , l. c. l. hollenberg phys .",
    "a * 71 * , 062312 ( 2005 ) .    identifying a two - state hamiltonian in the presence of decoherence , j. h. cole , a. d. greentree , d. k. l. oi , s. g. schirmer , c. j. wellard , l. c. l. hollenberg phys .",
    "a * 73 * , 062333 ( 2006 ) .",
    "subspace confinement : how good is your qubit ? , s. j. devitt , s. g. schirmer , d. k. l. oi , j. h. cole , l. c.l .",
    "hollenberg , new j. phys .",
    "* 9 * , 384 ( 2007 ) .",
    "physics - based mathematical models for quantum devices via experimental system identification , s. g. schirmer , d. k. l. oi and s. j. devitt , in proceedings of physics - based mathematical models of low - dimensional semiconductor nanostructures , j. phys . : conferences series * 107 * 012011 ( 2008 )    precision characterisation of two - qubit hamiltonians via entanglement mapping , j. h. cole , s. j. devitt , l. c. l. hollenberg , j. phys .",
    "a : math . gen . * 39 * , 14649 ( 2006 ) .    scheme for direct measurement of a general two - qubit hamiltonian , s. j. devitt , j. h. cole , l. c.l .",
    "hollenberg , phys .",
    "a. * 73 * , 052317 ( 2006 ) .",
    "optimal quantum multi - parameter estimation as applied to dipole- and exchange - coupled qubits , k. c. young , m. sarovar , r. kosut , k. b. whaley , arxiv:0812.4635    nmr techniques for quantum control and computation , l. m. k. vandersypen and i. l. chuang , rev .",
    "76 * , 1037 ( 2004 )    implementation of quantum gates via optimal control , s. g. schirmer , j.  mod .",
    "2009 , 19 .    optimal control of coupled spin dynamics : design of nmr pulse sequences by gradient ascent algorithms , n. khaneja , et al .",
    "172 * , 296 ( 2005 )    bayesian spectrum analysis and parameter estimation , g. larry bretthorst , bayesian spectrum analysis and parameter estimation ( springer , berlin , 1998 )    the convergence of a class of double - rank minimization algorithms , broyden , c.g .",
    ", journal inst .",
    "* 6 * , 76 - 90 , ( 1970 ) .    a new approach to variable metric algorithms , fletcher , r. , computer journal * 13 * , 317 - 322 , ( 1970 ) .    a family of variable metric updates derived by variational means , goldfarb , d. , math .",
    "of computing * 24 * , 23 - 26 , ( 1970 ) .",
    "conditioning of quasi - newton methods for function minimization , d. f. shanno , math . of computation * 24 * , 647 - 656 ( 1970 )",
    "if the system is initialized in the generic superposition state @xmath230 and measured after evolving for @xmath11 time units under the hamiltonian @xmath293 , then the general expression for the probability @xmath247 of measurement outcome @xmath271 is    @xmath294 \\nonumber\\\\   % non - zero frequency components , equal n and m   & + \\sum_{\\mu>\\nu}\\bigg [ \\sum_{m=1}^4 2|\\alpha_m|^2 s_{\\ell m;\\mu}s_{m\\ell;\\nu }     \\cos(\\omega_{\\mu\\nu}t-\\delta_{\\ell m;\\mu}-\\delta_{m\\ell;\\nu})\\nonumber\\\\   & \\qquad+ % non - zero frequency components , unequal n and m     \\sum_{m\\ne n } 2|\\alpha_m||\\alpha_n|s_{\\ell m;\\mu}s_{n\\ell;\\nu }     \\cos(\\omega_{\\mu\\nu}t-(\\delta_{1m}^b-\\delta_{1n}^b)-(\\phi_m-\\phi_n)-          \\delta_{\\ell m;\\mu}-\\delta_{n\\ell;\\nu})\\bigg].\\end{aligned}\\ ] ]"
  ],
  "abstract_text": [
    "<S> we present an empirical strategy to determine the hamiltonian dynamics of a two - qubit system using only initialization and measurement in a single fixed basis . </S>",
    "<S> signal parameters are estimated from measurement data using bayesian methods from which the underlying hamiltonian is reconstructed , up to three unobservable phase factors . </S>",
    "<S> we extend the method to achieve full control hamiltonian tomography for controllable systems via a multi - step approach . the technique is demonstrated and evaluated by analyzing data from simulated experiments including projection noise . </S>"
  ]
}