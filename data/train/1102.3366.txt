{
  "article_text": [
    "quantum key distribution @xcite aims at preventing an eavesdropper ( eve ) to acquire any information on a key distributed to two parties ( alice and bob ) who wish to use it to securely encrypt their communication through a public channel . in the ideal case ,",
    "the secrecy of the key relies on two powerful theorems that are at the heart of quantum mechanics : the no - cloning theorem , which prevents an eavesdropper to clone an unknown quantum state , and bell s theorem @xcite , which guarantees that no local information actually exists which an eavesdropper could acquire . in actual implementations of the protocols ,",
    "the imperfections of the components used to generate the key can be exploited by eve to extract some information about it @xcite .    here , we elaborate on the multiple - photon absorption attack on ekert protocol @xcite proposed by adenier _",
    "et al _ @xcite , and show that the attack can also be successful against other entanglement - based quantum key distribution ( qkd ) protocols , in particular the bbm92 protocol @xcite .",
    "we will detail the performances of the attack against both ekert and bbm92 protocols , as well as the possible countermeasures available to alice and bob .",
    "entanglement - based quantum cryptography .",
    "alice and bob randomly switch their measurement settings . in ekert protocol ,",
    "three settings are used on each sides . @xmath0 for alice , and @xmath1 for bob .",
    "detections associated with identical measurement settings ( @xmath2 ) are used to produce a correlated key , while those associated to non - identical measurement settings ( @xmath3 ) are used to check the violation of bell inequality ( and the security of the key ) . in the bbm92 protocol ,",
    "alice and bob use two diagonal bases only : @xmath4 for alice , and @xmath5 for bob as well .",
    "the detections associated with identical measurement settings ( @xmath2 ) are used to produce the key , while its security is guaranteed by a low enough qber.,width=264 ]    in both ekert and bbm92 protocols , alice and bob are randomly performing measurements on a small set of bases ( see fig .",
    "[ fig : protocol ] ) . the idea it to generate a shared key by exploiting the perfect correlation of entangled states @xcite whenever the measurements are performed in the same basis . in the bbm92 protocol @xcite the secrecy of the key",
    "is guaranteed by a low enough quantum bit error rate ( qber ) . in the ekert protocol , it is guaranteed in addition by a sufficiently large violation of bell inequalities @xcite measured for non - identical measurements , which allows in principle for device - independent quantum key distribution ( diqkd ) @xcite .",
    "we consider an entanglement - based qkd in which the source is operated midway between alice and bob ( see fig .",
    "[ fig : protocol ] ) .",
    "this type of configuration allows for higher losses in optical fibers @xcite , or for truly large distances in free space with a source located onboard an orbiting satellite @xcite .",
    "the source should therefore be considered to be in a location untrusted by alice and bob , and we will in fact assume throughout this paper that eve is in full control of it .",
    "eve s multiple - photon absorption attack @xcite consists of replacing the source of entangled photons altogether by a controlled source of separable states ( see fig .",
    "[ fig : attack ] ) .",
    "eve s purpose is to let alice and bob convince themselves that the secrecy of the key that they extract with this source is guaranteed by the laws of quantum mechanics , while in fact eve has a full knowledge of the local states sent to them both , and a fairly good knowledge of the key that they generate with this source . as we will see ,",
    "it does not matter which of the ekert or bbm92 protocols is implemented by alice and bob .",
    "the attack works in all cases by mimicking the statistics of an entangled state well enough to pass the security checks normally undertaken by alice and bob : it exhibits a high violation of bell inequalities and a low qber .",
    "the attack works as follows ; eve sends pulses containing photons that can each be represented by a local polarization state @xmath6 , and she sets their frequency such that the only way to get a click in a detector is when all the photons from a pulse are absorbed in one same detector , through a multiple - photon absorption @xcite . to simplify the discussion and highlight the principle of the attack",
    ", we assume that eve can control precisely the number of photons in each pulse , their polarization and their frequency .",
    "eve sends @xmath7-photon pulses to alice , the photons having a frequency @xmath8 such that only an @xmath7-photon absorption is possible in alice s detectors , and she sends @xmath9-photon pulses to bob , the photons having a frequency @xmath10 such that only an @xmath9-photon absorption is possible in bob s detectors . as we will see , this simple attack is sufficient to get a high enough violation of bell inequalities and a low enough qber as soon as @xmath11 or @xmath12 .",
    "principle of the multiple - photon absorption attack .",
    "eve sends @xmath7-photon pulses to alice , the photons having a frequency @xmath8 and a polarization @xmath6 ; and @xmath9-photon pulses to bob , the photons having a frequency @xmath10 and a polarization @xmath13 .",
    "eve chooses the frequency @xmath8 such that only an @xmath7-photon absorption is possible in alice s detectors , and @xmath10 such that only an @xmath9-photon absorption is possible in bob s detectors . in the figure",
    ", eve sends 2-photon pulses to alice , at a frequency such that a click can occur in @xmath14 and @xmath15 only through a two - photon absorption , and she sends 3-photon pulses to bob , at a frequency such that a click can occur in @xmath16 and @xmath17 only through a three - photon absorption . , width=340 ]      \\a ) absorption of photons in the detectors : a ) single - photon absorption .",
    "b ) two - photon absorption , title=\"fig:\",width=111 ] b ) absorption of photons in the detectors : a ) single - photon absorption .",
    "b ) two - photon absorption , title=\"fig:\",width=132 ]    in this first attempt , eve is trying to approach as best as she can the predictions of quantum mechanics for a singlet state , but using only a mixture of separable states , in a single - photon absorption scenario .",
    "she is therefore sending pulses such that @xmath18 , at a frequency @xmath19 where the dominant absorption is a standard single - photon absorption ( see fig .  [",
    "fig : absorption]-a ) .",
    "she will not succeed in getting a violation of bell inequalities or a low qber , but this result will serve as a basis to obtain a significantly better result in the case of multiple - photon absorption .",
    "eve prepares a set of pairs of pulses for alice and bob .",
    "each pulse contains exactly one photon that is linearly polarized in a direction @xmath20 chosen by eve .",
    "it can thus be described in its own hilbert subspace @xmath21 by a two - level state of the form @xmath22 where @xmath23 and @xmath24 are the eigenvectors of @xmath25 with eigenvalues @xmath26 and @xmath27 respectively .",
    "the pair of pulses can then be described in the tensor product hilbert space @xmath28 as @xmath29 .",
    "alice and bob , who are performing local measurements respectively in @xmath30 and @xmath31 , want to measure the statistical correlation of the pairs they receive from eve when they perform some rotations @xmath32 and @xmath33 on their respective pulses , followed by a measurement of the observable @xmath25 .",
    "since eve wants them to obtain an as good ( anti)correlation as possible with separable states , she sends orthogonal states to alice and bob , that is , such that @xmath34 and @xmath35 , and the initial state sent to alice and bob can be written : @xmath36 for a pair initially represented by this state ( [ lambdainit ] ) , the state after local rotations on each sides becomes @xmath37 which can be expanded as @xmath38    keeping the condition of orthogonality between alice and bob from pair to pair , eve is randomizing the parameter @xmath39 associated to each pair .",
    "the state of the set of pairs prepared by eve can therefore be described by a mixture .",
    "we can characterize the probability of obtaining a state between @xmath6 and @xmath40 by a probability density distribution @xmath41 on a single probability space @xmath42 .",
    "the mixture @xmath43 describing the set of pairs after rotation is therefore @xmath44 with @xmath45    note that we chose to denote the polarization of the pulses prepared by eve as @xmath39 , a symbol that is traditionally reserved to hidden - variables , but this variable is in fact hidden only from alice and bob , and it is not a hypothetical supplementary parameters to quantum theory . by describing the state with mixtures ,",
    "we adopt here the point of view of alice and bob .",
    "however , the parameter @xmath39 describing the state of each pulse is freely chosen by eve .",
    "thus it can in principle even be deterministic , as a function of time .",
    "eve needs only to make sure that there is on average no preferred direction for the @xmath39 so that the source is rotationally invariant for alice and bob , both at the single - count and coincidence - count level .    after performing their respective rotation on the received pulses , alice and",
    "bob perform a joint measurement @xmath46 on each pair .",
    "the expectation value of this measurement is : @xmath47 with @xmath48 , so that @xmath49 and where @xmath50 is the trace , defined as the sum of the diagonal matrix elements in any orthonormal basis , which in our case is @xmath51 , where @xmath52 is an operator in @xmath53 .    by linearity of the trace , we can write @xmath54 with @xmath55 where @xmath56 and @xmath57 are 0 or 1 .",
    "the @xmath58 are the joint probabilities , and we can now express them explicitly , using eq .",
    "( [ mixture ] ) , as @xmath59 which , since @xmath60 forms an orthonormal basis in @xmath53 , simplifies as @xmath61    note that , owing to the separability of @xmath62 as expressed by eq .",
    "( [ lambdaab ] ) , we can factorize the integrand in the above joint probability into a product , that is , @xmath63    denoting the probability to get a photon in a channel @xmath64 for a local state @xmath6 and a measurement direction @xmath65 as @xmath66 which is explicitly @xmath67 we can rewrite eq .",
    "( [ factorpkl ] ) as @xmath68 which can be simply interpreted as the integral on all possible @xmath39 of the product of the probability to detect a photon in channel @xmath56 on alice s side for a local state @xmath6 by the probability to get a photon in channel @xmath57 on bob s side for a local state @xmath13 .",
    "assuming @xmath41 is a uniform distribution on the interval @xmath69 , we can then express these integrals explicitly as @xmath70 which leads to @xmath71 and finally , we get @xmath72    this result differs essentially from the prediction for the singlet state by its visibility of 1/2 instead of 1 . with this correlation function ,",
    "the maximum of the chsh function @xcite , defined as @xmath73 is @xmath74 , which is clearly below 2 and therefore insufficient as an attack on ekert protocol .",
    "similarly , this attack fails against the bbm92 protocol .",
    "the qber can be estimated @xcite from the visibility @xmath75 as @xmath76 . with @xmath77 ,",
    "the qber measured by alice and bob is as high as @xmath78 in this single - photon attack , which alice and bob would not fail to reject .",
    "in the two - photon absorption attack , eve similarly sends pairs of pulses described by a mixture of separable states ( [ mixture ] ) to alice and bob , but this time each pulse contains two photons instead of one .",
    "the photons inside a pulse share the same state : @xmath6 for the two photons inside the pulse sent to alice ; and @xmath13 for the two photons inside the pulse sent to bob .",
    "we assume that the photons inside a pulse are independent : each photon follows the rules of quantum mechanics as prescribed by its quantum state independently of what the other photons inside the pulse are doing .",
    "now , the crucial difference is that these photons are chosen by eve with a frequency @xmath79 lower than in the single - photon absorption case discussed above , so that the energy of a single photon is insufficient to trigger a click .",
    "eve chooses the frequency of the photons such that the only way to get a click is through a two - photon absorption ( see fig .",
    "[ fig : absorption]-b ) .",
    "we assume for simplicity that whenever two photons hit the same detector simultaneously , the probability that they trigger a click in the detector is 1 .",
    "as we will see , this feature alone is ( surprisingly ) enough to lead to a clear violation of bell inequalities and a low qber .",
    "so , a click occurs in a specific output channel of a polarizing beam - splitter ( pbs ) only when the two photons inside the same pulse choose to exit through that same channel .",
    "if they choose different channels , no two - photon absorption can occur because there is only one photon in each channel . on each side ,",
    "the three possibilities are :    * both photons go to channel 0 @xmath80 click in channel 0 through a two - photon absorption , * both photons go to channel 1 @xmath80 click in channel 1 through a two - photon absorption , * one photon goes to channel 0 , the other goes to channel 1 @xmath80 no click in either channel .",
    "note that this third possibility brings us in the realm of the detection loophole @xcite .",
    "it is the essential reason for the appearance of the violation of bell inequalities that alice and bob are going to obtain .",
    "it should however be stressed that the non detections come from the frequency threshold in the photoelectric effect alone ; a feature that is relevant in all detectors based on this effect , regardless of their quantum efficiency .",
    "eve is therefore working in a fully quantum mechanical framework , without assuming anything about the detectors other than the existence of two - photon absorption processes at certain frequencies , and without assuming the existence of any hidden - variables .",
    "we want to calculate the probabilities @xmath81 that alice and bob get a coincidence click respectively in channels @xmath56 and @xmath57 in a two - photon absorption attack .",
    "note that whenever it is necessary to avoid possible ambiguities , we will label hereafter the equations with an upper script @xmath82 or @xmath83 indicating the order of the multiple - photon attack .",
    "for instance the joint probability @xmath81 is for a two - photon absorption attack , while @xmath84 is the same probability for a mixed attack in which alice is subjected to a two - photon attack while bob is subjected to a three - photon attack .",
    "assuming independence between the photons , for a local state @xmath6 and a measurement angle @xmath65 on either side , the probability that both photons from one pulse end up in the same channel @xmath64 is simply the square of the probability @xmath85 to see one such photon exit the pbs through this channel @xmath64 , that is : @xmath86    so , similarly to what we had in the single photon case in eq.([jointprobexp ] ) , the probability @xmath81 to get a click in channel @xmath56 for alice and in channel @xmath57 for bob in a two - photon absorption process is therefore the integral over all possible state of the product of the probability @xmath87 for alice to get a click in channel @xmath56 by the probability @xmath88 for bob to get a click in channel @xmath57 : @xmath89    for a rotationally invariant source , @xmath39 is uniformly distributed on the interval @xmath69 , which leads to : @xmath90 and we obtain : @xmath91    note that these four probabilities no longer add up to 1 , because of the cases involving a non detection on either side or both , which are discarded by alice and bob .",
    "so , as is standard in optical epr experiment and in entanglement - based qkd with photons , the correlation function has to be normalized by the sum @xmath92 : @xmath93    we obtain explicitly @xmath94 which lead to a violation of bell inequalities for @xmath4 and @xmath95 of @xmath96 which is clearly above 2 .    here",
    "the visibility is @xmath97 , so that a bbm92 protocol would give a qber of @xmath98 , which is already well below the security bound of @xmath99 against coherent attacks @xcite .",
    "a similar demonstration in the case of a three - photon absorption , with eve sending three photons per pulse , leads to @xmath100 which exhibits a violation of bell inequalities as high as @xmath101 , and a qber of @xmath102 . quite generally ,",
    "a multi - photon absorption process can lead to a violation of bell inequalities as large as desired within the algebraic limit of 4 , the only limit being the order of the multiple - photon absorptions that eve can drive into alice s and bob s detectors .",
    "note that if eve sends pulses meant to drive on one side a two - photon absorption and on the other a three - photon absorption ( a feature that eve could achieve by alternatively sending photons of different frequency to alice and bob ) , the relevant probabilities for the coincidences are of the form @xmath103 which leads to a correlation @xmath104 and a violation of bell inequalities for @xmath4 and @xmath95 of exactly @xmath105 which is the maximum violation predicted by quantum mechanics for entangled states .    in case of a bbm92 protocol ,",
    "the qber measured by alice and bob is @xmath106 .",
    "this is below the critical qber of @xmath107 for a device - independent quantum key distribution ( diqkd ) in which not only the source but also the measurement devices used by alice and bob are untrusted @xcite .",
    "the reason for this behavior is essentially that the detection probability of the pulses is below the @xmath108 required to close the detection loophole @xcite .",
    "this shows the absolute necessity of a loophole - free violation of bell inequalities in a diqkd scenario @xcite .",
    "the performances of the various multiple - photon absorption attacks are summarized in table  [ table1 ] , and the corresponding correlation functions measured by alice and bob are displayed in fig .",
    "[ fig : correlations ] .      in order to interpret and explain this seemingly unlikely violation of bell inequalities with a mixture of separable states , it is convenient to look locally ( e.g. on alice s side ) at the probability that a pulse @xmath39 impinging on a polarizing beam - splitter gets detected in either output channel .    in the multiple - photon absorption attack , the only way to get a click with a pulse containing @xmath7 photon is through an @xmath7-photon absorption , so that the probability to get a click in an output channel @xmath64 is equal to the probability that all the photons from a pulse exit through this same channel . assuming the independence of the photons ,",
    "this probability is simply the power @xmath7 of the probability @xmath85 of eq .",
    "( [ psinglelocal ] ) that a single photon polarized along @xmath39 goes to channel @xmath64 .",
    "the probability to get a click in either output channel for an incoming @xmath7-photon pulse is therefore : @xmath109    in the single - photon attack presented in the first section ( @xmath110 ) , each pulse polarized along @xmath39 contains one photon only , and the probabilities to get a click in either channel are adding up to one , that is , @xmath111 , which denotes that a photon impinging on a pbs is necessarily detected in one of the output channels in the ideal case .",
    "all the single - photon pulses are therefore treated on equal footing , independently of the state @xmath39 and of the measurement setting @xmath65 , and this is why this attack fails to lead to an observed violation of bell inequalities .",
    "by contrast , in the case of a two - photon absorption attack , the probability that a pulse containing @xmath7 photons polarized along @xmath39 gets detected in either channel becomes @xmath112 it exhibits a clear dependence on the state of the pulse @xmath39 and the local measurement setting @xmath65 .",
    "it means that the interaction of each pulse @xmath39 with the measurement apparatus as a whole ( constituted by the polarizing beam - splitter and the detectors ) depends on the very setting @xmath65 of this apparatus : the detection process in the multiple - photon absorption attack is _ state - adaptive _",
    "this behavior is illustrated in fig .",
    "[ figpclic ] . in the two - photon and three - photon absorption attacks ,",
    "the response of the measurement apparatus to incoming pulses is radically different when the measurement setting is @xmath113 than when it is @xmath114 .",
    "this behavior is hidden from alice and bob by the randomness of @xmath39 from one pair to the other , but the consequence is that different parts of the probability space are in effect weighted as a function of the local context @xmath65 .",
    "it leads to a bi - local dependence on the contexts @xmath115 when calculating the probabilities associated with the coincidences , and this feature is known to open the possibility of a violation of bell inequalities with local states @xcite .",
    "\\a )   in either output channel : a ) for @xmath113 , b ) for @xmath116 . in the single - photon case ,",
    "the probability to detect a pulse is identically equal to @xmath117 , which denotes a passive response of the measurement apparatus : all single - photon pulses are treated on equal ground . by contrast , in the two - photon and three - photon absorption attacks the process is adaptive in the sense that the probability that a pulse @xmath39 gets detected in either channel depends strongly on the measurement context @xmath65 encountered.,title=\"fig:\",width=340 ] + b )   in either output channel : a ) for @xmath113 , b ) for @xmath116 . in the single - photon case ,",
    "the probability to detect a pulse is identically equal to @xmath117 , which denotes a passive response of the measurement apparatus : all single - photon pulses are treated on equal ground . by contrast , in the two - photon and three - photon absorption attacks the process is adaptive in the sense that the probability that a pulse @xmath39 gets detected in either channel depends strongly on the measurement context @xmath65 encountered.,title=\"fig:\",width=340 ] +      in a multiple - photon absorption attack , eve has a full knowledge of the local states that she sends to alice and bob .",
    "each pair is characterized by state of the form eq.([lambdainit ] ) , where the polarization @xmath39 characterizing each pair is chosen by eve .",
    "this perfect knowledge of the local state sent to alice and bob does not however mean that eve has a perfect knowledge of the key that they will generate with these pairs , because of the inherent probabilistic nature of quantum predictions whenever one performs a measurement in another basis than the one in which a state was prepared .",
    "the key is generated in those cases in which alice and bob are performing identical measurement , that is @xmath118 .",
    "knowing @xmath119 for each pulse , eve knows the probabilities for 0 and 1 to be realized on each side , and she simply bets for the one that has the higher probability .",
    "consider the cases for which @xmath120 .",
    "we then have @xmath121 , so that @xmath122 for alice and @xmath123 for bob .",
    "eve therefore bets that the bit measured by alice is 0 and that the bit measured by bob is 1 .    assuming independence between the photons , the probability that all the photons from an @xmath124photon pulse on alice s side end up in channel @xmath125 , and thus generate a click opposite to eve s guess , is @xmath126 .",
    "just the same , the probability that all the photons from an @xmath127photon pulse on bob s side end up in channel @xmath128 , and thus generate a click opposite to eve s guess , is @xmath129 .",
    "the probability that eve guesses incorrectly a bit shared by alice and bob when @xmath120 is therefore @xmath130    similarly , in the cases for which @xmath131 , the probability that eve guesses incorrectly is @xmath132    the same reasoning can be extended to higher values of @xmath133 , leading either to a dependence on @xmath134 or @xmath135 , so that on average , for a uniform distribution of @xmath39 on the circle , the probability that eve guesses incorrectly a bit shared by alice and bob is @xmath136    note that the pulses for which eve has the least information are those where @xmath137 , that is @xmath138 .",
    "it is also for these pulses that alice and bob are the most likely to not end up with the same bit , thus increasing the measured qber .",
    "unfortunately for alice and bob , as soon as @xmath11 or @xmath12 , it is also for these pulses that the probability of detection is the smallest for a fixed @xmath7 and @xmath9 , as given by eq .",
    "( [ pclic ] ) .",
    "since this probability decreases for higher - order multiple - photon absorption , it also means that , rather counter - intuitively , the probability @xmath139 that eve makes a mistake guessing a bit shared by alice and bob decreases with higher violation of bell inequality and with lower qber ( see table [ table1 ] ) .",
    "alice and bob should therefore be wary not to trust a strong violation of bell inequality and/or a low qber as such , because it might give them the wrong impression that the strength of this violation and/or the small number of errors in the key make it safe when it is in fact the opposite .",
    ".performances of multiple - photon absorption attacks .",
    "@xmath140 is the minimum channel efficiency required to rule out each attack ; @xmath141 is the violation of the chsh inequality measured by alice and bob ; @xmath75 is the visibility ; qber is the quantum bit error rate ; and @xmath139 is the corresponding probability for eve to incorrectly guess a bit shared by alice and bob . [",
    "cols=\"^,^,^,^,^,^\",options=\"header \" , ]     [ table1 ]    correlations measured by alice and bob depending on the order of eve s multiple - photon absorption attack .",
    "an important property of this attack is that the correlations measured by alice and bob are rotationally invariant : they only depend on the difference between their measurement angles @xmath142 and @xmath143 , and not on their absolute values .",
    "it means that the attack is basis independent , and that it works independently of which entanglement - based qkd protocol is chosen by alice and bob.,width=302 ]",
    "detecting eve s attack by monitoring closely the single counts and the coincidence counts is not a trivial task .",
    "as we have seen , a violation of bell inequalities or a low qber is not a trustworthy criterion unless the detection efficiency is higher than the values given in table [ table1 ] .",
    "if alice and bob were taking into account the non - detected pulses to compute the correlation , for instance by assigning a random bit value to non - detected pulses @xcite , they would not get any violation of bell inequality with this attack . however , the typical detection efficiencies obtained in actual implementation of qkd protocols with photons are far below the bounds given in table [ table1 ] .",
    "eve s attack is therefore relevant because discarding the pairs for which no detection is recorded on either side and normalizing by the sum of coincidences is the standard way of dealing with non - detections .",
    "alice and bob would therefore not be able to distinguish a genuine source of entangled photons from this attack by simply observing a violation of bell inequalities .",
    "monitoring the single counts is also unlikely to betray eve s attack , because all the channels are treated on equal footing by the attack , and the source is rotationally invariant .",
    "the channel efficiencies are therefore balanced : the marginals are random for each measurement , as would be expected from a singlet state .    in the ideal case , the multiple - photon absorption attack does not produce any double - counts either that could be spotted by alice and bob , because a click occurs only when all the photons from a pulse exit through the same channel . in case of a two - photon absorption attack for instance , the only way to get a double - count would be with a pulse containing no less than 4 photons , which is impossible once we assume that eve controls the number of photons in each pulse .",
    "even if , more realistically , eve had not a tight control on the number @xmath7 of photons inside a pulse , for instance if she was using a weak coherent source for which the distribution of the number of photons is poissonian @xmath144 , a double - count would only be possible for pulses containing 4 photons or more , which would have a much smaller probability to occur than the probability to get a pulse with 2 photons , for small enough values of @xmath145 .",
    "looking at the individual rates of coincidences is also unlikely to betray eve s attack .",
    "the predicted rates of coincidences and the correlations functions are all rotationally invariant : they depend only on the angle difference @xmath146 , as is the case for a genuine singlet state .",
    "the attack is basis independent .",
    "the correlation function differs slightly from the @xmath147 expected for a singlet state in a lossy channel , but this difference is small and in actuality it would be difficult to distinguish the correlations obtained with a multiple - photon absorption attack from the correlation predicted for a genuine entangled state with a reduced visibility , especially if only a few points of the correlation are actually measured , as is the case in an entanglement - based qkd protocol .",
    "an unwanted feature that could betray eve s presence is that the sum of coincidences depends on the measurement settings @xmath142 and @xmath143 .",
    "the stronger the violation of bell inequalities , the stronger the visibility of the sum of coincidences .",
    "for instance , its visibility is about 0.06 in the two - photon absorption case ( @xmath148 ) , and it is 0.10 in the mixed case with two - photon absorption on one side and three - photon on the other side ( @xmath149 ) .",
    "however , eve can remove this unwanted effect entirely by driving different detection patterns for alice and bob , in a similar way to what was done by larsson @xcite and gisin @xcite in their hidden - variable models .",
    "the simplest method would be to alternatively drive a single photon absorption on one side , and a multiple - photon absorption on the other side .",
    "the sampling is then always fair on the side driven to a single photon absorption , and the total number of coincidences becomes independent of the measurement angles .",
    "it is nevertheless in alice s and bob s interest to closely monitor the sum of coincidence for any such angle dependence , because if it does not guarantee in principle against this attack , it makes eve s task more difficult by forcing her to use higher order multiple - photon absorptions to achieve the same violation of bell inequalities or the same qber .",
    "the assumption of fair sampling @xcite that is considered to be reasonable for experiments constraining the possible models of nature @xcite is made invalid by the multiple - photon absorption attack : the sample of detected pulses does not represent fairly the pulses that are emitted .",
    "the fair sampling assumption becomes equivalent in this case to the assumption that under the conditions of use in an actual entanglement - based qkd , the detectors are actually sensitive to the single - photons received by alice and bob .",
    "as reasonable as this assumption might be in the ideal case , alice and bob would still need to be very careful to ensure that the imperfections in the various measuring devices are not compromising its validity in actual implementations of qkd protocols .    using frequency filters so that only a known range of restricted frequencies can reach the detectors",
    "is an obvious way to limit the possibility of multiple - photon absorption in the ideal case .",
    "however , in actual implementations of qkd protocols , alice and bob still need to guarantee that the dominant way to get a click in their necessarily imperfect detector is through a single - photon absorption , even at those frequencies allowed by the filters .",
    "the energy diagram displayed on figure [ fig : absorption ] is that of an ideal two - level system , so that the frequency at which a two - photon absorption occurs is exactly half that of a single - photon absorption . in a real detector",
    "however , where the energy levels are bound to be more complicated , photons with a frequency just slightly lower than @xmath19 could trigger a two - photon absorption if there exist other stable energy levels above @xmath150 .",
    "this issue becomes far more critical considering the existing faked - state attacks that have already been successfully implemented against qkd protocols @xcite , by forcing the detectors to exit the single - photon sensitive geiger mode @xcite .",
    "it is conceivable that this type of blinding attack could be tailored to allow only a multiple - photon absorption in the detectors used by alice and bob , at those precise frequencies that are permitted to go through .",
    "such a combination of blinding detector attack together with our source designed for a multiple - photon absorption attack could then constitute a robust attack even against ekert protocol , something that the blinding attack alone could not do @xcite .      an active method for alice and bob to detect eve s attack , or to make sure that reducing the dark counts is not made at the cost of increasingly biasing the detection of signal pulses , would be to implement a fair sampling test @xcite adapted to quantum key distribution with entangled states @xcite .",
    "this fair sampling test does not introduce any loss and can be performed locally and unilaterally on either side during the production of the key . in a nutshell ,",
    "it consists of analyzing the output channels of the measuring devices ( here , the polarizing beam - splitters ) instead of simply feeding detectors with them .",
    "the standard design of an entanglement - based qkd is kept intact , with two polarizing beam - splitters on each side ( alice and bob ) projecting the incoming pulses on random bases @xmath142 and @xmath143 , as depicted on fig .",
    "[ fig : protocol ] .",
    "the novelty is to replace each detector by a polarimeter : a polarizing beam - splitter followed by a detector at each output .",
    "consider alice s side ( see fig .",
    "[ fig : fstest10 ] ) .",
    "we label the polarimeter in channel @xmath128 as @xmath151 , the orientation of its polarizing beam - splitter as @xmath152 , and the detectors in the transmitted and reflected output as @xmath153 and @xmath154 respectively .",
    "a click in either of these two detectors is treated as a click in channel 0 .",
    "similarly , the polarimeter in channel @xmath125 is labeled @xmath155 , the orientation of its polarizing beam - splitter @xmath156 , and the detectors in the transmitted and reflected output are @xmath157 and @xmath158 respectively . a click in either of these two detectors is treated as a click in channel 1 .",
    "bob would proceed similarly with two polarimeters labeled @xmath159 and @xmath160 .",
    "fair sampling test on alice s side .",
    "the detector in channel @xmath128 is replaced by a polarimeter @xmath161 with two detectors @xmath153 and @xmath154 .",
    "the detector in channel @xmath125 is replaced by a polarimeter @xmath155 with two detectors @xmath157 and @xmath158 .",
    "ekert protocol is thus unaltered by the fair sampling test : polarimeter @xmath151 is equivalent to the detector in channel @xmath128 in fig .",
    "[ fig : protocol ] , and polarimeter @xmath155 is equivalent to the detector in channel @xmath125 .",
    "bob would proceed similarly to test the fairness of the sampling on his side.,width=302 ]    let us denote @xmath162 the probability that a photon initially polarized along @xmath39 ends up in the @xmath163 channel of polarimeter @xmath14 , that is , channel @xmath153 .",
    "it is equal to the probability @xmath164 that this photon exits in the @xmath128 channel , multiplied by the probability that this same photon , impinging on polarimeter @xmath128 with an output polarization @xmath142 , exits through the output channel @xmath163 : @xmath165 similarly , we have @xmath166    in the general case of a @xmath7-photon absorption , for a pulse containing exactly @xmath7 photons all polarized along @xmath39 , the probability that a multiple - photon absorption occurs in either channel of the polarimeter is equal to the probability to that all photons exit in the same output channel @xmath153 plus the probability to that all photons exit in the same output channel @xmath154 , that is , @xmath167 . as usual",
    ", we have assumed that the photons are independent .    to get the probability of a click in either channel of a polarimeter for our uniformly distributed source of polarized pulses , we just need to average over all possible @xmath39 : @xmath168 and @xmath169    naturally , in the case of a single - photon absorption , for pulses containing exactly one photon",
    ", we get a probability of detection in each polarimeter that is identically equal to @xmath170 : @xmath171 this illustrates the fact that in this single - photon absorption case the sampling is fair .",
    "this is also the result that one would expect from a genuine source of entangled photons : a photon impinging on a polarizing beam - splitter will be detected with probability 1 in either of the two output channels .",
    "however , as soon as we consider a two - photon absorption case , we obtain @xmath172 and similarly in the three - photon absorption case , we get @xmath173 where @xmath174 is either @xmath152 or @xmath156 .    the average probability to get a click in a polarimeter ( 0 or 1 ) becomes clearly dependent on the measurement setting @xmath142 and the polarimeter setting @xmath175 , which betrays the state - adaptivity of the attack , and the resulting unfair sampling ( see fig.[fig : fstestresult ] ) .    .",
    "in the single - photon case , the probability of click in a polarimeter is independent of the measurement settings : the sampling is fair .",
    "as soon however as eve uses two - photon absorption in order to drive a violation of bell inequalities in alice s and bob s detectors , they can spot the resulting unfairness of the sampling , due to the state - adaptivity of the attack , when @xmath176 is varied ( which is done automatically if @xmath174 is fixed , and if @xmath142 is varied randomly from pair to pair as is already the case in an entanglement - based qkd protocol).,title=\"fig:\",width=340 ] +    alice can perform this test locally , and unilaterally , in order to spot the unfairness of the sampling due to the state - adaptivity of eve s attack .",
    "she only needs to compare the sum of single counts in the @xmath163 and @xmath177 output channel of a polarimeter when @xmath176 is varied .",
    "she can do so by keeping the settings of her polarimeters fixed , for instance at @xmath178 , while @xmath142 is randomly switched from pair to pair , as is already the case in both ekert and bbm92 protocol .",
    "naturally , bob can perform the test unilaterally and locally as well .",
    "note that the setup used for the fair sampling test would also make the other attacks against qkd protocols more complicated ( if not impossible ) to implement .",
    "the faked - state attack @xcite consists of eve impersonating bob , intercepting the signal that is intended for him and using the exact same procedure that bob would have implemented . in order to hide her presence ,",
    "eve s strategy consists of sending to bob a signal that will deterministically give him the exact same measurement result as measured by eve , but only in those cases in which eve and bob turned out to be performing their measurements in the same basis . in the remaining cases , when their bases are diagonal to each others , eve s signal must not trigger any detection in any of bob s detectors .",
    "to implement this idea , bob s detectors are blinded to single - photon detection by eve .",
    "after each detection , eve sends a signal that produces a click in one of bob s detectors only when it is fully reflected or fully transmitted by its polarizing beamsplitter .",
    "so , whenever the bases chosen at random by eve and bob are diagonal with respect to each other , the signal sent by eve is split in half at bob s polarizing beamsplitter and is insufficient to produce a click in either detector .    this attack would however be immediately visible with our fair sampling test , because it would lead to double - clicks in the polarimeters .",
    "locally , in the cases where eve performs her measurement in the same basis @xmath142 as bob , everything would be fine when @xmath179 , because the signal sent by eve would entirely go to one detector only ( @xmath180 if eve sent a 0 , and @xmath181 if she sent a 1 ) .",
    "but things would go wrong when @xmath182 because then the signal sent by eve would be split evenly inside the corresponding polarimeter ( @xmath161 if she sent a 0 , or @xmath183 if she sent a 1 ) , so that no click would occur at all .",
    "if eve tries to remedy this situation by increasing the signal , it would only result in both detectors in a polarimeter clicking at the same time ( and then it would incidentally also lead to double - clicks when @xmath179 ) .",
    "so , the faked - state attack would fail in a fair sampling test setup because it would either lead to double - clicks or to no click at all when @xmath182 .    in the time - shift attack @xcite , when @xmath182 a photon exiting the pbs in a given channel @xmath64 , would be dispatched randomly and with equal probability to either detector @xmath184 or detector @xmath185 .",
    "it would thus become difficult , if not impossible , for eve to adjust the time - shift associated to a specific polarimeter @xmath64 .",
    "she would not have to deal with just one time - dependent detection pattern in each output channel @xmath64 , but with two random ones , depending on whether a photon ends up in @xmath184 or in @xmath185 .",
    "note that this is reminiscent of the idea of randomly switching the bit assignments of the two detectors used in a standard protocol to eliminate the possibility of exploiting the detection efficiency mismatch @xcite .",
    "contrary to all existing attacks on qkd protocols , the multiple - photon absorption attack does not require eve to be physically located between alice and bob and to intercept anything that was intended for either of them , as in a typical intercept - and - resend attack @xcite .",
    "the only requirement is that eve has managed at some point in the past to replace the source of entangled state by her own mixture of separable states .",
    "she just needs to know the state @xmath39 of each pulse and that is something that eve could have set deterministically in the source .",
    "once this is done , the security of the qkd protocol is compromised by anyone who happens to know the polarization of the pulses as a function of time @xmath186 .    by mimicking the statistics of an entangled state well enough to pass the security checks normally undertaken by alice and bob",
    ", the attack can in principle work against any entanglement - based quantum key distribution protocol .",
    "the attack works in particular for both ekert and bmm92 protocols , independently of which protocol is chosen by alice and bob .",
    "while there already exist explicit attacks on the bbm92 protocol @xcite , to our knowledge the multiple - photon absorption attack is in fact the only explicit attack against ekert protocol with light sources .",
    "as long as a device - independent quantum key distribution @xcite is beyond technological reach @xcite , it is therefore fundamental for alice and bob to either prevent altogether the possibility of multiple - photon absorptions in their detectors , or to include a fair sampling test in the protocol to be able to detect such an attack .",
    "the fair sampling test can be performed unilaterally on either side without introducing any loss , and it should also make the task more complicated if not impossible for other existing attacks on qkd protocols .      9 n. gisin , g. ribordy , w. tittel and h. zbinden _ rev .",
    "phys . _ * 74 * 145 ( 2002 ) . j. s. bell , _ physics _ * 1 * 195 ( 1964 ) .",
    "v. scarani , et al _ rev .",
    "phys . _ * 81 * 1301 ( 2009 ) .",
    "ekert , _ phys .",
    "lett . _ * 67 * 661 ( 1991 ) .",
    "g. adenier , i. basieva , a. khrennikov and n. watanabe , arxiv:1011.4740 c.h .",
    "bennett , g. brassard and n.d .",
    "mermin , _ phys .",
    "lett . _ * 68 * 557 ( 1992 ) .",
    "a. einstein , b. podolsky and n. rosen , _ phys .",
    "_ * 47 * 777 ( 1935 )",
    ". j. f. clauser , m. a. horne , a. shimony and r. a. holt _ phys .",
    "* 23 * 880 ( 1969 ) .",
    "t. scheidl _",
    "et al _ , _ new j. phys . _ * 11 * 085002 ( 2009 ) . c. branciard , n. gisin , b. kraus and v. scarani , _ phys .",
    "a. _ * 72 * 032301 ( 2005 ) .",
    "p.m. pearle , _ phys .",
    "d _ * 2 * 1418 ( 1970 ) .",
    " larsson , _ phys .",
    "a _ * 57 * 3304 ( 1998 ) .",
    "n. gisin and b. gisin , _ phys .",
    "a _ * 260 * 323 ( 1999 ) .",
    "g. adenier , _ am .",
    "j. phys . _",
    "* 76 * 147 ( 2008 )",
    ". g. adenier , _ aip conf .",
    "proc . _ * 1101 * 8 ( 2009 ) .",
    "a. aspect , j. dalibard and g. roger _ phys .",
    "lett . _ * 49 * 91 ( 1982 ) .",
    "g. weihs , t. jennewein , c. simon , h. weinfurter and a. zeilinger , _ phys . rev",
    ". lett . _ * 81 * 5039 ( 1998 ) .",
    "a. khrennikov , _ contextual approach to quantum formalism , _",
    "springer , berlin ( 2009 ) .",
    "a. acn , n. brunner , n. gisin , s. massar , s. pironio , and v. scarani , _ phys .",
    "lett . _ * 98 * 230501 ( 2007 ) .",
    "s. pironio , a. acn , n. brunner , n. gisin , s. massar and v. scarani , _ new j. phys .",
    "_ * 11 * 045021 ( 2009 ) .",
    "x. ma , c .- h.f .",
    "fung , h .- k .",
    "lo , _ phys .",
    "a _ * 76 * 012307 ( 2007 ) . c. erven , c. couteau , r. laflamme , and g. weihs , _ opt .",
    "express _ * 16 * 16840 ( 2008 ) .",
    "m. aspelmeyer , t. jennewein , m. pfennigbauer , w.r .",
    "leeb , a. zeilinger , _",
    "ieee j. sel .",
    "top . quantum electronics _ * 9 * 1541 ( 2003 ) .",
    "j. perdigues armengol _ et al _ , _ acta astronautica _ * 63 * 165 ( 2008 ) .",
    "r. braunstein , _ phys .",
    "rev . _ * 125 * 475 ( 1961 ) .",
    "a. garg and n.d .",
    "mermin , _ phys .",
    "d _ * 35 * 3881 ( 1987 ) .",
    "m. ohya and i. volovich , _ mathematical foundations of quantum information and computation _ , springer , berlin - heidelberg - new york ( 2011 ) .",
    "l. accardi , _ phys .",
    "rep . _ * 71 * 169 ( 1981 ) .",
    "g. adenier and a. khrennikov , _ j. phys .",
    "b _ * 40 * 131 ( 2007 ) . v. makarov and j. skaar , _ quant .",
    "* 8 * 0622 ( 2008 ) .",
    "l. lydersen , c. wiechers , c. wittmann , d. elser , j. skaar and v. makarov , _ optics express _ * 18 * 27938 ( 2010 ) . i. gerhardt _",
    "et al _ , arxiv:1011.0105 g. adenier , _",
    "laser res .",
    "_ * 29 * 409 ( 2008 ) .",
    "g. adenier , n. watanabe and a. yu .",
    "khrennikov , arxiv:1004.1242 h .- k . lo and y. zhao , in _ encyclopedia of complexity and systems science _ , vol .",
    "* 8 * p7265 , springer new york ( 2009 ) .",
    "fung , k. tamaki , b. qi , h .- k .",
    "lo and x. ma , _ quant .",
    "* 0131 ( 2009 ) . y. zhao , c .- h .",
    "f. fung , b. qi , c. chen , h .- k .",
    "lo , _ phys . rev .",
    "a _ * 78 * 042333 ( 2008 ) ."
  ],
  "abstract_text": [
    "<S> in elaborating on the multiple - photon absorption attack on ekert protocol proposed in arxiv:1011.4740 , we show that it can be used in other entanglement - based protocols , in particular the bbm92 protocol . in this attack , the eavesdropper ( eve ) </S>",
    "<S> is assumed to be in control of the source , and she sends pulses correlated in polarization ( but not entangled ) containing several photons at frequencies for which only multiple - photon absorptions are possible in alice s and bob s detectors . </S>",
    "<S> whenever the photons stemming from one pulse are dispatched in such a way that the number of photons is insufficient to trigger a multiple - photon absorption in either channel , the pulse remains undetected . </S>",
    "<S> we show that this simple feature is enough to reproduce the type of statistics on the detected pulses that are considered as indicating a secure quantum key distribution , even though the source is actually a mixture of separable states . </S>",
    "<S> the violation of bell inequalities measured by alice and bob increases with the order of the multiple - photon absorption that eve can drive into their detectors , while the measured quantum bit error rate decreases as a function of the same variable . </S>",
    "<S> we show that the attack can be successful even in the simplest case of a two - photon absorption or three - photon absorption attack , and we discuss possible countermeasures , in particular the use of a fair sampling test . </S>"
  ]
}