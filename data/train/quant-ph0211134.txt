{
  "article_text": [
    "the generation of non - classical states of light has been central to the confirmation and elucidation of the quantum theory of radiation . today , such work takes on an added importance as part of the advancing field of deliberate quantum state engineering , motivated in part by applications in quantum communication and computation .",
    "for instance , deterministically generated single - mode single - photon states could greatly advance the efficiency and security of quantum cryptography.@xcite they are also a crucial resource for implementing a quantum computing scheme using linear optics , single - photon states , and photodetection @xcite .",
    "these immediate potential applications have spurred the development of devices which can produce single photons on demand , such as solid state devices which use the coulomb interaction between strongly confined electrons to produce single exciton states which then decay optically @xcite , or devices in which the fluorescence from single , isolated and optically - pumped molecules is collected @xcite . the stream of pulses produced from each of these devices has been shown to contain either zero or one , but rarely more than one , photon per pulse , thus differing radically from a classical coherent - state pulse which would contain a poisson distribution of photon number . furthermore , while these recent devices all produce fluorescence from a single optical emitter on - demand , none outputs this fluorescence into a practical single mode of the optical field .",
    "it has been shown recently that the effects of cavity quantum electrodynamics ( cqed ) can in principle be used to overcome this limitation and produce single - mode single photons on demand @xcite .",
    "in such a scheme , a single three - level atom is induced to fluoresce with high probability into a single resonant mode of a high - finesse optical cavity .",
    "experimental evidence for such cavity - induced raman transitions has been obtained @xcite , and a variant of this scheme has very recently been used to generate a sequence of single photons @xcite . by creating a highly controlled , single - quantum - level interaction of atoms and light , cqed can be used quite generally to produce non - classical states of the electromagnetic field in a single cavity mode .    in this paper , we analyze a particular desired function of a cqed device that goes beyond the production of single- photon states , namely , the deterministic production of a fock state of the electromagnetic field containing an exact number of photons ( @xmath0 ) .",
    "such non - classical states are of interest for fundamental tests and applications of the theories of quantum optics ( such as quantum state tomography , as performed recently on the single - photon state @xcite ) , as a resource for heisenberg - limited quantum measurements made possible by the production of two orthogonal @xmath0-photon states @xcite , and quite generally as a starting point for the controlled engineering of more complex quantum states . starting with a precisely counted number of @xmath0 atoms trapped in the confines of a high - finesse optical cavity , we consider a scheme in which a classical pump field is ramped up to induce deterministic raman emission into a single cavity mode by each of the trapped atoms , resulting in an optical field of exactly @xmath0 photons that are emitted from the cavity in a single pulse . the atom - cavity system is constrained to remain within a subspace of optically dark @xmath0-atom states , resulting in a high fidelity of production .",
    "the present scheme provides a generalization of that proposed for the production of single photons from single atoms @xcite and indicates a systematic route to generation of other non - classical states .",
    "several other theoretical and experimental works have discussed the use of high - finesse cavities for the quantum engineering of mesoscopic non - classical optical states .",
    "the possibility of producing both fock states and arbitrary coherent superpositions of these inside a cavity by exploiting adiabatic transfer of atomic ground - state zeeman coherences in single atoms was already explored in ref .",
    "@xcite . a scheme for producing an arbitrary quantum optical state using a single two - level atom in a high - finesse cavity",
    "has also been presented by law and eberly , based on the arbitrary real - time control of a classical pump field and the coupling to a cavity field @xcite .",
    "experimental evidence for fock states of a microwave cavity field has recently been obtained as a dynamical equilibrium for a stream of rydberg atoms passing through a micromaser @xcite .",
    "another approach toward the construction of a fock state was proposed in ref .",
    "@xcite in which a rydberg atom with a stark - tunable level splitting is used to transfer photons one - by - one from a classically - populated cavity field to another initially empty cavity field .",
    "initial experimental steps towards this goal have been recently demonstrated @xcite .",
    "in contrast to the schemes of refs.@xcite which require delicate temporal control of the atom - cavity coupling , our present scheme yields the desired @xmath0-photon state for quite arbitrary temporal profiles of the classical pump field . this",
    "is achieved through a rapid adiabatic passage which transfers the initial `` non - classical '' state of @xmath0 atoms to the non - classical state of @xmath0 photons within a short period of time .",
    "thus , the quantum nature of the photon field is already guaranteed by the initial state of the atoms trapped in an initially empty cavity .",
    "the initial conditions can be achieved by lowering a cloud of cold atoms into the cavity , and pulse control is then entirely contained in the time dependence of the ramping field .",
    "this avoids the need to make use of atomic motion in controlling the coupling to the cavity field , as was required in ref .",
    "@xcite , and is one of the key elements allowing _ deterministic _ production of @xmath0-photon states to be achieved . the number of atoms in the cavity can be determined by detection of excited state atoms at the single - atom level , as a result of the cavity - mediated shifts of atomic levels .",
    "such single - atom detection has already been demonstrated @xcite , and can be readily extended to larger numbers of atoms .",
    "consequently , the present scheme opens the way to deterministic generation of more complicated quantum states of light by first producing non - classical states of trapped atoms ( such as spin - squeezed states produced through interatomic interactions @xcite or by measurement @xcite ) , and then transferring that state onto the optical field using cqed .",
    "the remainder of the paper is constructed as follows . a brief review of the deterministic single - photon generation schemes of refs .",
    "@xcite is given in section  [ sec : single ] , which establishes some common concepts with the present work .",
    "a discussion of the @xmath0-atom / cavity system in a single - mode external field follows in section  [ sec : nphoton ] .",
    "we demonstrate here the existence of a family of optically - dark coupled @xmath0-atom / cavity states and show generally how adiabatic ramping of an external field can be used to generate @xmath0-photon emission from the cavity .",
    "detailed analysis of the energy spectrum of the closed @xmath0-atom / cavity system as a function of the ramp time provides estimates of the populations in the bright states and also leads to analytic estimates of the energy gap required for limiting adiabatic state transfers . in section  [ sec : open ] we then present analysis of the cavity decay responsible for the @xmath0-photon emission , treating in detail the effects of spontaneous emission and non - adiabaticity on the output states .",
    "we obtain analytic estimates of error rates deriving from these contributions that scale linearly in the total number of atoms , resulting in a constant relative error in the output @xmath0-photon states and guaranteeing production of an @xmath0-photon state with high fidelity . in section  [ sec : quantumtraj ] we present numerical simulations of the open system using the quantum jump approach .",
    "these numerical calculations are used to explore the sensitivity of the scheme to critical experimental parameters , as well as to explore the limits of our analytical estimates of the error bounds . finally , in section",
    "[ sec : conclusions ] we summarize and indicate directions for further work and for experimental implementation .",
    "our @xmath0-photon generation scheme uses the same internal atomic structure used in the single - photon proposals of refs .",
    "@xcite , namely atoms having three internal levels , labeled @xmath2 , @xmath3 and @xmath4 , arranged in a @xmath5 configuration such that states @xmath2 and @xmath4 are non - radiating atomic states while @xmath3 is an excited state connected to states @xmath2 and @xmath4 by allowed transitions ( figure [ fig : three_level_atom ] ) .",
    "levels @xmath2 and @xmath3 are typically hyperfine levels of the electronic ground state .",
    "we assume that the allowed transitions to state @xmath3 can be addressed selectively .",
    "this can be achieved , _",
    "e.g. _ , as a result of polarization selection rules , or merely due to a large energy difference between states @xmath2 and @xmath4 .",
    "the three - level atoms are located in a high - finesse optical cavity which supports a resonant mode having vacuum rabi frequency @xmath6 ( _ i.e. _ , the rabi frequency due to the presence of a single photon in the cavity mode ) that couples states @xmath3 and @xmath4 .",
    "the cavity mode has frequency @xmath7 which can in general be detuned from the atom resonance @xmath8 by @xmath9 ( see figure [ fig : three_level_atom ] ) .    in the schemes of refs .",
    "@xcite and @xcite , single - photon generation is accomplished by exposing a single atom in internal state @xmath2 to a classical laser field of frequency @xmath10 and rabi frequency @xmath11 , which is controlled dynamically . the laser frequency , @xmath10 , is chosen to be resonant with the cavity - mediated raman transition between states @xmath2 and @xmath4 , _",
    "i.e. _ ,  @xmath12 or @xmath13 .",
    "this laser connects the states @xmath2 and @xmath4 through a cavity - mediated raman transition and induces the fluorescence of a cavity photon by the atom .",
    "the photon exits the cavity into a single cavity - output mode , and thereby generates the desired single - photon state .",
    "@xcite and @xcite showed that under suitable conditions on the external pulse field , the single photon can be emitted deterministically .    to understand the operation of such a deterministic device , it is helpful to first consider the atom / cavity system as a closed quantum system , _ i.e. _ , we ignore the decay of cavity photons to cavity - output modes that actually produces the desired fock state outside the cavity , as well as the possible spontaneous decay from the excited state @xmath3 to modes other than the cavity mode .",
    "spontaneous emission lowers the fidelity of deterministic photon generation , and clearly needs to be avoided or at least minimized .",
    "we write the basis states of the single atom / cavity system as @xmath14 , @xmath15 and @xmath16 , where the first index refers to the atomic state and the second index gives the number of photons in the cavity , _ i.e. _ , the cavity field is implicitly assumed to be quantized .",
    "the interaction hamiltonian of this closed system is given by @xmath17 \\label{eq : hint}\\ ] ] where @xmath18 is the time - dependent coupling to the external ( classical ) laser pump field , @xmath19 .",
    "unless essential for the analysis , we shall omit the explicit time dependence of @xmath20 to streamline the notation . as discussed by kuhn",
    "_ et al . _",
    "@xcite , the dynamics of this system are governed by the presence of a null - valued eigenstate @xmath21 , which is a `` dark state '' containing no population in the excited atomic state @xmath3 , and which is therefore immune to spontaneous decay .",
    "this dark state exists for all values of @xmath11 and is given by @xmath22 it is the presence of this dark state that allows the high - fidelity generation of a single photon in response to a suitable choice of @xmath11 .",
    "the single - atom / cavity system starts initially in the state @xmath23 , which is the dark state for the initial condition @xmath24 . during a sufficiently slow ramp of @xmath11 ( _ i.e. _ , a broad pulse of the classical pump laser )",
    ", the atom - cavity system can adiabatically follow the dark state , eq .",
    "( [ eq : dark_single ] ) . for sufficiently large values of @xmath11 ( @xmath25 ) , @xmath26 , _",
    "i.e. _ , a single cavity photon is produced with a high degree of certainty .",
    "this cavity photon then rapidly decays from the cavity , resulting in a deterministic single - photon source that acts within a time interval specified by the period of the external pump .",
    "law and kimble @xcite and kuhn _",
    "_ et al.__@xcite have presented numerical calculations to assess deviations from this ideal behaviour caused by spontaneous emission , and have explored the extent to which the photon emission probability can be controlled by modifying the trigger pulse .",
    "recent experiments by kuhn , hennrich , and rempe have produced single photons by this method @xcite .",
    "for the generation of arbitrary fock states of the electromagnetic field , _ i.e. _ , with arbitrary large photon number @xmath0 , we now consider @xmath0 such three - level atoms confined within the optical cavity .",
    "we assume that the atoms are indistinguishable in all respects .",
    "this provides an important experimental simplification relative to other cqed schemes in which the atoms are required to be individually addressable  @xcite .",
    "each atom interacts individually with the laser field and the cavity mode , just as for the single atom case .",
    "we make the simplifying assumption that the atoms do not interact directly with one another .",
    "however , they do experience a second order interaction via the cavity mode .",
    "the cavity coupling @xmath6 and the classical pump rabi frequency @xmath20 are taken to be identical for each of the @xmath0 atoms , consistent with their indistinguishability @xcite .",
    "thus the @xmath0-atom / cavity interaction hamiltonian is given , for the closed system , by @xmath27 where @xmath28 describes the atom / field coupling , eq .",
    "( [ eq : hint ] ) , for the @xmath29 atom . from now on",
    ", we shall use this in the operator form @xmath30 where the operators @xmath31 and @xmath32 are the annihilation and creation operators for the quantized cavity mode .",
    "since this hamiltonian is symmetric under the exchange of any two atoms , a symmetric initial state remains symmetric as it evolves .",
    "we may thus reduce our effective hilbert state to consider only the states that are completely symmetric with respect to atomic interchange .",
    "we may thus use a number representation of the atomic state , namely @xmath33 , where @xmath34 gives the number of atoms in state @xmath35 ( @xmath36 ) , and @xmath37 the number of photons in the cavity .",
    "we allow arbitrary values for @xmath38 , @xmath39 , @xmath40 and @xmath37 , and employ the bose creation and annihilation operators @xmath41 and @xmath42 for the atomic states @xmath43 .",
    "we can then rewrite the interaction hamiltonian for the closed system as @xmath44    this many - body @xmath0-atom / cavity hamiltonian conserves the total number of atoms , represented by the operator @xmath45 , as well as the difference between the number of atoms in state @xmath4 and the number of cavity photons , represented by the operator @xmath46 . when cavity decay is added to this description ,",
    "the operator @xmath47 gains the significance of referring to the number of photons that have escaped the cavity . since the operators @xmath48 and @xmath47 commute , we define subspaces @xmath49 composed of the eigenstates with simultaneous eigenvalues @xmath50 and @xmath51 of the operators @xmath48 and @xmath47 , respectively .",
    "this is summarized schematically in figure [ fig : n_atoms ] .",
    "we find that each manifold @xmath49 contains a null - valued eigenstate @xmath52 , given explicitly by @xmath53 where @xmath54 is a normalization constant .",
    "this state is the analog of the null - valued dark eigenstate for the single - atom / cavity system  @xcite .",
    "it contains no population in the @xmath3 internal state and is thus an @xmath0-atom dark state immune to spontaneous decay from any atom .",
    "( [ eq : dark ] ) represents a continuous family of dark states that are transformed into each other by the time dependence of @xmath11 . for nearly all values @xmath55",
    ", we can show that the null - valued eigenspace of @xmath56 is non - degenerate , _",
    "i.e. _ , each of these dark eigenstates possesses a unique energy .",
    "we will discuss exceptions later ( section  [ sec : deltadelta ] ) .",
    "one can also show that acting on eq .",
    "( [ eq : dark ] ) with the cavity annihilation operator @xmath31 , produces the corresponding dark state having one less photon , _",
    "i.e. _ , any such dark eigenstate @xmath52 decays to @xmath57 by cavity emission .",
    "thus cavity decay does not take the system out of the family of dark states .",
    "conversely , the only way to directly couple dark states in different manifolds , is either to spontaneously lose a photon or to add a particle .",
    "this representation suggests that adiabatic evolution might be used for @xmath0-photon generation in an analogous manner to that proposed for single - photon generation in refs .",
    "we illustrate this here with the manifold corresponding to @xmath58 .",
    "initially the pump laser is off , @xmath59 , and the corresponding initial state has @xmath0 atoms in the @xmath2 state and no photons in the cavity , @xmath60 .",
    "one can then imagine slowly ramping the value of the pump laser until the pump laser coupling is much larger than the atom coupling to the cavity , @xmath25 . at this final time , @xmath61",
    ", one finds that approximately all @xmath0 atoms are in the state @xmath4 and there are @xmath0 photons in the cavity , @xmath62 .",
    "this procedure will generate @xmath0 photons in a closed cavity .",
    "we will show that this procedure can be coupled to cavity decay to produce an @xmath0-photon state . in practice ,",
    "realization of this ideal sequence requires that two key issues be adequately addressed .",
    "first , the need for adiabatic evolution through the family of dark states via couplings to the excited atomic level @xmath3 places constraints on how we vary the strength of the pump pulse , @xmath20 , based on the energy spectrum of the @xmath0-atom / cavity system .",
    "second , spontaneous emission of photons from the cavity will provide perturbations to the adiabatic evolution that may be non - negligible .",
    "we examine these issues in detail in section iv . before this",
    ", we first analyze the energy spectrum of the closed @xmath0-atom / cavity system in the remainder of this section .",
    "this will allow us to establish the critical parameters limiting the adiabatic evolution , that are required in order to estimate the errors due to non - adiabaticity and spontaneous emission within the open system approach employed in section  [ sec : open ] . while the dark state of each @xmath49 manifold has a succinct description , eq .",
    "( [ eq : dark ] ) , the general eigenstates for the @xmath0-atom / cavity system are quite complicated . however , in the limit of both large and small @xmath11 , the eigenstates are found to have familiar forms that render them susceptible to analytic investigation .",
    "we examine first the strong pump ( large @xmath20 ) limit . here",
    "the eigenstates can be interpreted in terms of the familiar angular momentum states . in the limit where @xmath20 is large relative to the other parameters ( @xmath6 , @xmath63 )",
    ", we can neglect the terms in eq .",
    "( [ eq : h0 ] ) that are proportional to the cavity coupling parameter @xmath6 .",
    "we then make a transformation from the atomic modes @xmath64 and @xmath65 to generalized angular momentum operators , @xmath66 , using the schwinger representation.@xcite this gives @xmath67 and @xmath68 , where @xmath69 denotes the total angular momentum , @xmath70 . in this limit",
    "we find that the system hamiltonian becomes @xmath71 where @xmath72 , @xmath73 , @xmath74 , and @xmath75 .",
    "the corresponding energy levels are now identical to those of the generalized angular momentum @xmath66 . therefore the eigenstates are simply given by @xmath76 where @xmath77 is the eigenvalue of total angular momentum , @xmath78 is the angular momentum projection along the axis @xmath79 , @xmath40 is the number of atoms in atomic state @xmath4 , and @xmath37 is the number of cavity photons as before .",
    "the cavity coupling term , @xmath80 , can now be considered to act perturbatively on eq .",
    "( [ eq : rlarge ] ) , to mix states differing by @xmath81 , and to change the value of the cavity photon number by unity . relating these states in the large @xmath20 limit to our invariants @xmath48 and @xmath47",
    ", we find that the @xmath49 manifold is composed of states @xmath82 , where @xmath83,@xmath84 , and @xmath85 ( see figure [ fig : ang_mom ] ) .",
    "our dark state at large @xmath20 is @xmath86 . in the number representation",
    "this is simply @xmath87 ( eq.([eq : dark ] ) ) .",
    "we note that the loss of a photon only reduces the photon number @xmath37 , and conserves @xmath88 and @xmath40 .",
    "the eigenstates in the large @xmath20 limit are shown schematically in figure  ( [ fig : ang_mom ] ) .",
    "we now consider the weak pump ( small @xmath20 ) limit . here",
    "we find that the eigenstates may also be interpreted in terms of a known set of states , but these are now the less well known eigenstates of the tavis - cummings hamiltonian @xcite .",
    "we proceed in this limit by starting from the the system hamiltonian , eq .",
    "( [ eq : h0 ] ) , at @xmath89 .",
    "this is simply @xmath90 we again make a transformation to a schwinger representation , but this time we choose the transformation to be made between modes @xmath91 and @xmath65 . the generalized angular momentum operators that are created from these two modes will be denoted here by @xmath92 , _",
    "i.e. _ @xmath93 , @xmath94 and @xmath95 , where @xmath96 denotes the corresponding total angular momentum , @xmath97 .",
    "( [ eq : h_r0 ] ) then becomes @xmath98 which is recognized to be the off - resonant tavis - cummings hamiltonian @xcite .",
    "note that this hamiltonian conserves the generalized angular momentum @xmath96 .",
    "it also conserves sum of the number of photons , @xmath37 , and the angular momentum in the z direction , @xmath99 .",
    "in the small @xmath20 limit we can then investigate the effect of finite @xmath20 using a perturbative analysis .",
    "this perturbative analysis has two consequences for the energetics .",
    "first , the perturbation due to @xmath20 , which is of the form @xmath100 , will only couple states whose total @xmath92 value differs by 1/2 .",
    "second , as a result of this , the resulting change in energy of the eigenstates of eq .",
    "( [ eq : h0 ] ) is only second order in @xmath20 .",
    "the eigenstates of the tavis - cummings hamiltonian are not trivial , but we note that in the limit of large @xmath63 they are approximately eigenstates of @xmath101 with a number of photons in the cavity given by @xmath102 where @xmath103 is the total angular momentum and @xmath104 is an eigenvalue of @xmath47 .",
    "the states of the tavis - cummings model are described in detail in @xcite and qualitatively in appendix a. figure [ fig : tc_levels ] provides a schematic of these states in the small @xmath20 limit .",
    "one useful advantage of these schwinger angular momentum representations of the atomic states for our analysis is that in both of these limits of large and small @xmath20 , _ i.e. _ , whether for a fixed @xmath103 or for fixed @xmath77 , the corresponding eigenvalues @xmath99 and @xmath105 provide a measure of the population in the excited state .",
    "this population is given by @xmath106 .",
    "this property will be used in section [ sec : deltadelta ] to make estimates of the population in the scattering state _",
    "i.e. _ , in the atomic state @xmath3 , that is susceptible to spontaneous emission , and hence of the errors due to spontaneous decay .",
    "the above description of the @xmath0-atom / cavity system as a closed quantum system is clearly incomplete , since a proper assessment of the operation of an @xmath0-photon generator requires the consideration of this cqed device as an open quantum system .",
    "we must take into account the two channels by which the @xmath0-atom - cavity system interacts with its environment .",
    "these are : i ) the possibility of spontaneous decay from atoms in the excited state @xmath3 to optical modes outside the cavity , determined by the spontaneous decay rate @xmath107 , and ii ) the coupling of cavity photons to electromagnetic modes outside the optical cavity , characterized by the cavity decay rate @xmath108 @xcite .",
    "the latter provides the required coupling to transfer an @xmath0-photon state from the cavity mode to an external mode .",
    "cavity decay thus plays two different roles here .",
    "first , in allowing emission of the @xmath0-photon state , and , second , affecting the dynamics inside the cavity as discussed below .",
    "we describe the @xmath0-atom - cavity system as an open system within a quantum wavefunction formulation @xcite . to characterize its action as an n- photon generator",
    ", we evaluate the cavity flux @xmath109 .    in this section ,",
    "we use the quantum wave function formulation in a perturbative regime to derive analytic estimates for the error rates of its action as an @xmath0-photon generator . in section",
    "[ sec : quantumtraj ] we then make numerical simulations of the full open quantum system that allow us to ascertain the extent of validity of these perturbative error estimates .    in this open quantum system analysis , we will show that the structure of the closed quantum system , namely the identification of manifolds of states @xmath49 , each of which contains a dark state that is immune to spontaneous emission and that connects adiabatically to the initial state , still plays a critical role .",
    "when @xmath11 is varied in the open quantum system , the @xmath0- atom / cavity system evolves primarily within the family of accessible dark states @xmath52 ( @xmath110 ) from which no spontaneous emission occurs , just as in the closed quantum system .",
    "the system can fail to produce the desired @xmath0-photon output state _ only if photons are actually lost to spontaneous emission_. thus a crucial part of assessing the failure rate of the @xmath0-photon generator is to quantify the extent of `` non - darkness , '' _",
    "i.e. _ , the probability that the system will evolve towards a bright state from which spontaneous emission may indeed occur .",
    "non - darkness can arise from two factors : non - adiabatic evolution when the rate of change of @xmath11 is too fast , and the conditional dynamics resulting from cavity decay which can couple the dark state @xmath52 to a non - dark state .    in the quantum trajectory approach , @xcite the dynamics of the @xmath0-atom - cavity system",
    "are characterized by deterministic non - unitary evolution , interspersed with random jumps determined by photon losses from the cavity and by spontaneous emission ( scattering ) from the excited state .",
    "the non - unitary evolution is given by the conditional hamiltonian @xmath111 the imaginary terms @xmath112 and @xmath113 describe the back - action on the quantum system from that accumulates between instances of cavity decay and spontaneous emission jumps , respectively .",
    "the corresponding quantum jump operators are given by @xmath114 and @xmath115 . for a full discussion of the quantum jump approach see ref .",
    "@xcite .    for the numerical calculations presented in section [ qts ] we use the full conditional hamiltonian ,",
    "as required in the quantum trajectory formulation.@xcite in order to obtain analytic error estimates here , we proceed first by assuming that the adiabatic errors are small .",
    "therefore , at all times the state of the system is now regarded as deviating only slightly from the dark state . in this situation",
    "we may neglect the spontaneous emission term , @xmath116 , treating it implicitly as a higher order perturbation than the cavity decay term .",
    "the cavity decay term @xmath108 is treated in first order perturbation theory . before describing the details of this analysis , we note again that the cavity decay , characterized by the jump operator @xmath114 , connects dark states in the manifold @xmath49 to dark states in a lower manifold @xmath117 , i.e.,@xmath118 ( see section  [ sec : nphoton ] above . )",
    "thus neither of the quantum jump operators @xmath114 or @xmath119 will lead to errors ( i.e.  to non - darkness ) in the operation of our cqed device , as long as the system is maintained within the dark states @xmath120 . consequently , in order to quantify the failure rate of the @xmath0-photon generator under these conditions , one need only consider the evolution of the system under the conditional hamiltonian @xmath121 .",
    "we will now make a detailed analysis of the errors , starting with an estimate of the extent of non- darkness introduced by cavity decay , then estimating the adiabatic error in following the dark state as @xmath11 is varied , and finally estimating the spontaneous emission flux rate due to population in the @xmath3 internal state that is introduced by a combination of cavity decay and non - adiabaticity .",
    "we first analyze the errors due to cavity dynamics . for this purpose",
    ", we treat the @xmath122 term in eq .",
    "( [ hcond ] ) as a perturbation to the closed - system hamiltonian , eq .",
    "( [ eq : h0 ] ) .",
    "in particular , under the realistic scenario when cavity decay is weaker than the cavity coupling ( @xmath123 ) , we find that the cavity decay term causes the dark states @xmath52 of the closed - system hamiltonian to be modified to the states @xmath124 of the conditional hamiltonian , according to @xmath125 here we have modified our notation to define the states @xmath126 as the instantaneous eigenvalues of the closed - system hamiltonian @xmath121 with corresponding energies @xmath127 . using this expression , we find the degree of `` non - darkness '' due to cavity decay , @xmath128 , to be equal to @xmath129    from this expression we can generate an upper bound on the degree of non - darkness , @xmath130 .",
    "we first note that @xmath131 where @xmath132 is the variance in the cavity photon number in the dark state @xmath133 .",
    "our upper bound is then obtained by replacing the bohr frequencies @xmath134 in eq .",
    "( [ eq : ecavity ] ) with the minimal bohr frequency , and replacing the time - varying variance @xmath132 with its maximum .",
    "this results in @xmath135 the maximum variance of @xmath136 is bounded by @xmath137 ( see appendix b ) while the minimal bohr frequency depends on @xmath63 , and will be discussed detail in section [ sec : deltadelta ] .",
    "our expression for the bound on the extent of non - darkness due to cavity decay thus becomes @xmath138      we now examine errors that arise due to non - adiabatic evolution resulting from a non - zero derivative , @xmath139 . using the standard treatment @xcite",
    "we estimate the population leakage from the adiabatic state at a time t , @xmath140 here @xmath141 .",
    "we then apply the standard upper bound for adiabatic error @xcite , given by the square of the maximum angular velocity of the state , divided by the square of the minimal bohr frequency , @xmath142    one can bound the maximum angular velocity , @xmath143 , to be smaller than @xmath144 ( see appendix c ) .",
    "this results in the following upper bound :    @xmath145    eqs .",
    "( [ admax ] ) and ( [ cmax ] ) provide an upper bound for the `` non - darkness '' in the limit that our perturbative approach is appropriate . when the minimal energy separation , @xmath146 is independent of @xmath0 , both equations suggest that the `` non - darkness '' scales at worst linearly with @xmath0 , in the worst case .",
    "furthermore , we note that the maximum `` non - darkness '' decreases with increasing @xmath104 .",
    "we now proceed to estimate the effect of spontaneous emission , or equivalently , the rate of spontaneous emitted flux .",
    "the spontaneous emission flux rate is equal to the product of the population in the spontaneously emitting state and twice the decay rate of that state , _",
    "i.e. _ , @xmath147",
    ". unfortunately , we are unable to analytically calculate the average population in the excited atomic state @xmath148 .",
    "the simplest way to estimate an upper bound on the spontaneous flux rate is then to use the maximum possible value of @xmath149 , and the maximum probability of the system being in a non - dark state , @xmath150 .",
    "we can thus obtain an upper bound on the spontaneous emission flux rate as @xmath151 .    naturally , by detuning from resonance",
    ", we expect to minimize the population that will leak to population in the excited state as is the case in both off - resonant rayleigh and raman scattering . hence , we expect the spontaneous emission flux rate to change as a function of the detuning @xmath63 .",
    "the value of @xmath63 affects the spontaneous error rate in two ways .",
    "first , it controls the value of the minimal bohr frequency , and can thereby either reduce or enhance the first order population leakage from the dark state .",
    "second , we know by analogy with the three level system ( section  [ sec : single ] and refs .",
    "@xcite ) that the `` non - darkness '' should contain less excited state character as the absolute magnitude of @xmath63 increases .",
    "our scheme works independent of the sign of @xmath63 .",
    "however , for concreteness , @xmath63 is assumed to be negative ( red detuning ) throughout the rest of the paper .    referring to the discussion in section iii , for small values of @xmath63 , _",
    "i.e._,@xmath152 , there exist states with energy only @xmath153 away from the dark state . in both the small and large @xmath20 limits , these states are the @xmath154 states ( section  [ sec : nphoton ] ) .",
    "hence , for @xmath155 , the minimal bohr frequency is equal to @xmath63 .",
    "furthermore , the eigenstates are effectively eigenstates of @xmath156 or @xmath157 and therefore have average value @xmath158 .",
    "therefore , whatever states the dark state falls into due to either adiabatic error or cavity decay , these states will have large population in the excited atomic state @xmath159 .",
    "so in the small @xmath160 limit our upper bound described above is reasonable .",
    "consequently , we use the `` non - darkness '' factors calculated in eqs .",
    "( [ cmax ] ) and ( [ admax ] ) times @xmath161 .",
    "hence , we find that the error rate for small values of detuning @xmath160 is always less than @xmath162    in contrast , for large values of @xmath160 , the states are effectively eigenstates of @xmath163 or @xmath101 ( section  [ sec : nphoton ] ) . for these states ,",
    "the smallest valued eigenstate is the @xmath164 or @xmath165 state , and the corresponding perturbative energy scales in second order as @xmath166 .",
    "however , this smallest energy eigenstate has a population in the excited state that scales at worse as @xmath167 .",
    "we believe that it is a reasonable assumption to multiply this smallest eigenstate estimate of the excited state population by our calculated `` non - darkness '' factor @xmath168 , in order to arrive at a better estimate of the excited atomic state population .",
    "this procedure yields the followng expression for large values of @xmath63 , namely an error rate that is independent of @xmath63 : @xmath169    careful analysis shows that in the large @xmath160 limit , the state of energy @xmath170 is not always the closest state to the dark state . indeed states can be identified for particular settings of @xmath63 and @xmath20 which are degenerate with the null - valued dark state .",
    "however , these states are shown to be characterized by higher @xmath103 or @xmath77 , and therefore in the perturbative limit they do not couple directly with the dark state .",
    "numerical simulations suggest that the situation is similar for states which cross the null state in the non - perturbative limit .      .",
    "[ sec : small ]    having obtained error estimates due to cavity decay , non - adiabaticity , and spontaneous emission , we now consider the dependence on the cavity photon number @xmath37 . in the limit that one very slowly ramps up @xmath20 ,",
    "the average number of photons in the cavity is always much smaller than 1 .",
    "we assume that our dark state is simply @xmath171 .",
    "for this state @xmath172 , where @xmath173 ( eq .  ( [ eq : dark ] ) ) . in the limit of small @xmath174",
    ", the variance of photons in the cavity equals the number of photons in the cavity .",
    "since the ramp is very slow , we expect that the error rate will be due to the cavity dynamics and , therefore , proportional to the variance , eq .",
    "( [ cavar ] ) .",
    "the rate of photon output is proportional to the number of photons in the cavity .",
    "hence , in the case of a small number of photons @xmath37 in the cavity , we expect at worse for the error to scale proportional to the number of photons output .",
    "this implies a total error that scales at worse proportional to the number of atoms @xmath0 , when @xmath175 .",
    "one might ask how can we increase @xmath20 to be of equal magnitude with @xmath6 , and still maintain a small number of photons in the cavity .",
    "the reason is that as @xmath20 increases , there is an increasing chance of a photon being emitted .",
    "if one varies @xmath20 slowly enough , the chance of that occurring before @xmath20 becomes too large is quite high . at this point , we then change manifolds @xmath49 .",
    "examining the equation for the dark state ( eq .",
    "( [ eq : dark ] ) ) and looking at only the first two terms , one sees that changing manifolds is equivalent to reducing the effective value of @xmath20 .",
    "compared to the @xmath58 manifold , the effective @xmath176 of the @xmath104 manifold is equal to @xmath177 .",
    "as @xmath0 increases , for small values of @xmath104 one then needs smaller and smaller values of @xmath20 for the approximation to hold .",
    "for example , when @xmath58 , @xmath178 .",
    "however , as the value of @xmath104 increases , @xmath20 can eventually reach a value comparable to the product @xmath179 and still imply a small number of photons in the cavity .",
    "to summarize , in the limit of a small number of photons @xmath37 in the cavity and @xmath180 , we expect the ratio of spontaneous emission flux to cavity flux to be either a constant , or a decreasing function with @xmath0 . explicitly , we expect spontaneous flux to be smaller than @xmath181 ( see eq .",
    "( [ eq : gg ] ) and eq .",
    "( [ cavar ] ) ) .",
    "the ratio of the spontaneous flux , @xmath182 , to the cavity flux , @xmath183 , is then @xmath184 which is larger than the fractional spontaneous loss , the spontaneous flux divided by the expected number of photons out , @xmath0 .",
    "therefore , for current state of the art optical cavity technology for which @xmath185 and @xmath186 @xcite , we expect that only 1 of every 200 photons will be lost to spontaneous emission .",
    "[ sec : quantumtraj ] the quantum trajectory or quantum jump approach allows one to calculate the properties of open quantum systems by averaging over individual quantum trajectories .  @xcite the basic elements of this approach were described briefly in section [ sec : open ] .",
    "technical details of the algorithm are given in ref .",
    "the calculations described below average over 5000 trajectories per simulation .",
    "the simulations were run until the cavity flux and spontaneous emission flux were less than @xmath187 .",
    "this results in 2000 - 5000 steps of length @xmath188 , depending on the specific parameters of the system .",
    "the basic quantity we calculate is the cavity flux , 2@xmath189 , which describes the number of photons emitted from the cavity . for these simulations ,",
    "we have chosen as our figure of merit the fractional spontaneous loss .",
    "the fractional spontaneous loss is defined as the number of photons lost to spontaneous emission , @xmath190 , divided by the expected number of photons out , @xmath0 .",
    "we calculate @xmath190 as the product of @xmath191 and the integral of @xmath148 . due to the statistical error resulting from the finite number of trajectories",
    ", we have estimated a numerical uncertainty of @xmath192 in @xmath193 .      using a simple driving field which increases linearly with time , and realistic cavity parameters based on the cavity of kimble @xcite , ( @xmath194 ) , we find that the deterministic production of @xmath0-photons within a single pulse with small loss is indeed possible .",
    "figure [ fig : nflux ] shows the output pulse as a function of time for @xmath195 .",
    "we see the expected linear increase in the area of the output pulse , _",
    "i.e _ , the cavity flux 2@xmath196 , with @xmath0 .",
    "we then calculated the loss of photons into the spontaneous emitted modes , shown in figure [ fig : nerr ] .",
    "when the simulation was run in the limit of a small number of photons in the cavity and with @xmath197 , we expected that the total photon loss will grow at worst linearly , as explained above in section [ sec : small ] .",
    "therefore , the fractional spontaneous loss should either be constant or decrease with increasing @xmath0 . this expectation is confirmed by simulations , see figure [ fig : nerr ] and figure [ fig : nexp ] .",
    "furthermore , the error is smaller than our expected bound of @xmath198 fractional spontaneous loss , see section [ sec : small ] .",
    "although , we have made calculations with only a small number of @xmath0 values here , it appears that our analytic estimates coupled with this numeric evidence for @xmath1 suggest that the deterministic production of large @xmath0 fock states when @xmath199 is indeed possible .",
    "the numerical results summarized in figure 6 show that for @xmath200 we have minimal fractional spontaneous losses of approximately 0.3actually decrease with increasing @xmath0 . since our analytical results suggest an upper bound of 0.5expect to be able to produce a fock state containing on the order of 100 photons before the total integrated loss due to spontaneous flux equals a single photon .      in the previous subsection",
    ", we used current experimental cavity parameters @xcite and , for simplicity , a linear driving pulse .",
    "we now show how one can minimize the spontaneous loss by tuning various cavity parameters and modifying the driving field .      for linear ramping with a small rate of change",
    ", one finds that the fractional error actually decreases with increasing @xmath0 ( figure [ fig : nerr ] ) .",
    "this is in line with our analytical bounds which suggested that at worse the fractional error should be constant for small occupation of photons in the cavity ( section [ sec : small ] ) .",
    "figure [ fig : rerr ] shows that as the ramp speed increases beyond the adiabatic regime , the errors increase rapidly .",
    "one can further reduce the error by using a more sophisticated time - dependent driving field .",
    "for example , the application of a gaussian pulse , @xmath201 , reduces the fractional spontaneous loss by a factor of 2 , relative to the fractional spontaneous loss resulting from a linear ramp , as illustrated in figure [ fig : nexp ] .",
    "one expects that appropriate pulse shaping could further lead to an order of magnitude increase in the fidelity .",
    "however , the minimal fractional spontaneous loss obtained by pulse shaping is limited by errors due to cavity dynamics . in figure",
    "[ fig : nerr ] , one sees that this limit is approached by ramp speeds of @xmath202 .",
    "the ability to detune from resonance is one of the basic tools of atomic physics .",
    "therefore , it is important to determine how the fidelity of our operation scales with the detuning , @xmath63 . in section [ sec : deltadelta ] ,",
    "our analytical predictions suggest that as @xmath160 is increased from @xmath203 , the initially large fractional spontaneous loss should decrease , eventually reaching a constant non - zero value for @xmath204 . for larger",
    "@xmath160 , our numerical calculations confirm this prediction for @xmath205 atoms , figure [ fig : nerr ] .    in figure",
    "[ fig : nerr ] , one sees that for detunings , @xmath160 , smaller than the cavity coupling constant , @xmath6 , the error decreases as the detuning increases .",
    "one then sees a relatively flat region , followed by an increase in error as @xmath160 increases .",
    "this rise is outside of the predictive ability of our analytical model and represents a breakdown in the first order perturbative methods when the energy separation between the dark state and nearest neighbor state becomes smaller than the ramping speed .",
    "the main conclusion from our numerical simulations is that a wide region of detunings are nevertheless possible . in terms of efficiency , ( number of photons",
    "out per time / fractional spontaneous loss ) , our data suggest that a detuning of @xmath206 would be optimal .      for large values of @xmath160 , one can reduce the error by increasing the value of @xmath6 . as predicted analytically in section [ sec : deltadelta ] , the total error will reduce as @xmath6 increases .",
    "furthermore , if one varies @xmath6 and @xmath207 proportionally , one can numerically observe the @xmath208 dependence of fractional loss predicted by eq .",
    "( [ eq : gg ] ) .",
    "this is shown in figure [ fig : gerr ] .",
    "we have presented a scheme for the deterministic production of @xmath0-photon fock states from coupling of @xmath0 three - level atoms in a high - finesse optical cavity to an external field .",
    "the method relies on adiabatic passage through a continuous family of dark states that is controlled by the ramping up of the external field .",
    "we have shown that this procedure can reliably output pulses of @xmath0-photons from the cavity .",
    "we have made a detailed analysis of the errors involved in the @xmath0-photon state production .",
    "these result when there is a breakdown of adiabaticity and from spontaneous emission .",
    "this error analysis yields analytical bounds on the errors which are well reproduced by the results of numerical simulations for up to @xmath0=5 photons .",
    "our estimates for physically realistic cavity and atom / field parameters indicate that this scheme may be used reliably to generate states with up to @xmath0=100 photons .",
    "one way in which such a deterministic fock state generator may be constructed in the near future is using a combination of an ultra - cold atomic source and a high - finesse optical resonator ( with parameters such as those used for the calculations in section [ sec : quantumtraj ] ) such as those used in the works of kimble and colleagues @xcite .",
    "modern techniques of laser and evaporative cooling in magnetic traps can readily produce cold and tightly confined atomic gases which can be transported in vacuum from a production region to the confines of an optical resonator .",
    "using ultra - cold alkali atoms , the states @xmath2 and @xmath4 can be chosen to be two ground state hyperfine levels which are both magnetically trapped , such as the @xmath209 and @xmath210 hyperfine states of @xmath211rb .",
    "these may be connected by a @xmath212 raman transition using excited levels on the @xmath213 or @xmath214 transitions  while the strength of this transition is suppressed at large detunings @xmath160 from the atomic resonance , our work shows that only moderate detunings ( several @xmath6 ) are necessary for high - fidelity operation .",
    "the initial @xmath0-atom state may be generated by following a weak microwave excitation with atom - number - sensitive selection , or , alternately , by real - time observation of the atomic number in a given hyperfine level .",
    "this would set proper initial conditions for @xmath0-photon generation .",
    "several additional comments are in order . throughout this work",
    ", we have assumed that the atoms are identically coupled to the cavity and pump fields .",
    "similarly , we assume that these atoms are indistinguishable in their spontaneous emission to optical modes outside the cavity .",
    "it would be desirable for the n - photon generator to operate similarly if these restrictions are eased .",
    "toward this end , it is still possible to define a family of dark states for atoms which are not identically coupled to the cavity and pump fields . as such ,",
    "our analytical approach to estimating the photon losses to spontaneous emission could be similarly extended to such cases .",
    "we believe this would provide similar performance to the idealized case we have provided herein , i.e. the deterministic production of fock states containing as many as @xmath215 photons should be possible .",
    "however , one would expect that while different spatial arrangements of @xmath0 atoms in a cavity would all produce @xmath0-photon fock states , the specific optical mode occupied by those @xmath0-photons would differ .",
    "applications requiring many orthogonal , simultaneous pulses of @xmath0-photons ( such as heisenberg - limited interferometry ) would be constrained by these differences .",
    "we envisage a number of applications for deterministically - produced @xmath0-photon states .",
    "as alluded to in the above discussion , two orthogonal @xmath0-photon states can be combined using linear beam - splitters to create an interferometer which is sensitive to differential phase shifts between the two arms of the interferometer which are on the order of @xmath216 ( the heisenberg limit ) , rather than the typical @xmath217 sensitivity ( the standard quantum limit ) obtained with classical light pulses @xcite .",
    "two orthogonal @xmath0-photon states can also be used to create a highly entangled state using only measurement and linear optics @xcite .",
    "such highly entangled photon states can be used to perform precision measurements @xcite . the cqed device described in this work",
    "could thus be used for demonstrations of this interferometric method .",
    "while the low photon numbers deterministically available from this cqed device ( given current state - of - the - art cavity parameters ) would not yield the precision available from the use of much more intense classical light sources , there may be applications requiring high precision at low light levels which are enabled by this fock - state generator , e.g. coherent control @xcite .",
    "other applications in the field of quantum information , communciation , cryptography , and computation are also possible , and we intend to investigate such potential applications in future work . finally , a deterministic n - photon source would find both basic and applied use for the absolute calibration of optical detectors , particularly those designed to be sensitive to multiple photons ( as opposed to conventional avalanche photodiode devices ) .",
    "similarly , the @xmath0-photon generator can be used as the light source for novel multiphoton spectroscopy , e.g. rempi @xcite , although the optical frequency range which can be produced by a given atom - based system would be quite limited .",
    "the authors effort was sponsored by the defense advanced research projects agency ( darpa ) and air force laboratory , air force materiel command , usaf , under agreement number f30602 - 01 - 2 - 0524 , the office of naval research under grant no .",
    "fdn 00014 - 01 - 1 - 0826 , and the nsf .",
    "dmsk acknowledges support by the sloan foundation .",
    "kbw thanks the miller institute for basic research in science for a miller research professorship for 2002 - 2003 .",
    "the work of krb was also supported by the fannie and john hertz foundation .",
    "we would like to thank neil shenvi for useful discussions .",
    "after this work was completed we learned that similar @xmath0-atom dark states have been proposed in ref .  .",
    "in this appendix , we present a qualitative picture of the eigenstates of our system in the small @xmath20 limit , i.e. , a description of the eigenstates of the non - resonant tavis - cummings hamiltonian , eq .",
    "( [ eq : h_r0 ] ) .",
    "first , note that the creation / annihilation operators associated with the cavity were not present in eq .",
    "( [ eq : h_r0 ] ) , the tavis- cummings hamiltonian would become again simply a hamiltonian describing angular momentum ( @xmath92 ) about some axis ( @xmath218 ) .",
    "in fact , for large enough @xmath63 , one sees that is indeed the case , and we do merely have eigenstates of angular momentum about the @xmath219 axis . in order to get a qualitative picture of the tavis - cummings eigenstates for general values of the cavity coupling @xmath6 and finite values of @xmath37 , it is useful to treat the cavity creation / annihilation operators as operators that act to enhance the `` effective magnetic field '' in the `` @xmath220 '' direction .",
    "for example , when one has a large number of photons , @xmath37 , in the cavity a standard approximation is to replace the cavity photon creation / annihilation operators with @xmath221 . applying this transformation to eq .",
    "( [ eq : h_tavis ] ) , one finds that the hamiltonian becomes simply @xmath222 , _",
    "i.e. _ , the cavity coupling has been transformed into an effective magnetic field in the @xmath220 direction .",
    "the eigenstates of eq .",
    "( [ eq : h_tavis ] ) are constructed as follows .",
    "first , one starts with atomic states that are the eigenstates of @xmath101 , namely , @xmath223 .",
    "we know that the hamiltonian conserves @xmath47 , the difference in the number of atoms in state @xmath224 and the number of photons , @xmath37 , in the cavity . in this representation ,",
    "the conserved quantity is @xmath225 .",
    "we can then append a photon state that reflects this conservation symmetry to the atomic states of modes @xmath3 and @xmath4 identified via @xmath101 .",
    "this results in the atom - photon states @xmath226 .",
    "the only missing component is now an atomic state of mode @xmath2 .",
    "we then append the appropriate number state of the atomic mode @xmath227 such that @xmath0 is conserved , according to @xmath228 .",
    "this then specifies the remaining index @xmath38 .",
    "we have thereby arrived at a set of states @xmath229 , that may now be latex npb.used as a basis for expansion of the exact eigenstates of eq .",
    "( [ eq : h_tavis ] ) . since the hamiltonian eq .",
    "( [ eq : h_tavis ] ) conserves @xmath230 , and @xmath231 , the exact eigenstates can be formally written as @xmath232 . naturally , determining the coefficients @xmath233 is not trivial @xcite . for our purposes here , it is not necessary to find explicit solutions for the coefficients .",
    "we require only the main features of the energy spectrum , which are available from the identification of the above basis and are described below .",
    "it is important to note that in order for the photon number @xmath37 to be positive , we must have @xmath234 . for fixed @xmath103 and @xmath104 values ,",
    "this can lead to a truncation of the possible accessible states .",
    "one finds that for positive @xmath104 , the angular momentum projection , @xmath235 , can have only @xmath236 values , whereas for negative @xmath104 , @xmath235 can take all @xmath237 values .",
    "this implies that for @xmath238 , the eigenstate degeneracy for given values of @xmath103 , @xmath0 , and @xmath104 , equals the degeneracy one would expect for a total angular momentum value of @xmath103 ( _ i.e. _ , @xmath239 ) .",
    "in contrast , for values @xmath240 , the eigenstate degeneracy equals the degeneracy expected for a total angular momentum value of @xmath241 , _ i.e. _ , @xmath236 .",
    "note that in our scheme we always assume that there are initially no photons in the cavity , i.e. , @xmath242 .    in summary",
    ", we see that one think of the states @xmath243 as being effectively `` angular momentum '' states possessing a total angular momentum @xmath96 equal to @xmath241 and angular momentum projection of @xmath235 about the `` magnetic axis '' .",
    "although this analogy is not perfect because of the spread of actual eigenstates over this basis , it does contain the following important feature .",
    "this is , that for @xmath63 larger than @xmath244 , where @xmath245 is the maximum number of photons in the cavity , the eigenstates are eigenstates of @xmath101 , with eigenvalue @xmath246 .",
    "so the large @xmath63 limit is simplified .",
    "in contrast , for small and medium size values of @xmath63 , the eigenstates are superpositions over a wide range of @xmath99 states .",
    "in this appendix , we derive an upper bound on the variance of cavity photon number for the dark state . in order to reach this bound",
    ", we need to first outline other properties of the dark state .",
    "we begin with a few definitions .",
    "the dark state in the @xmath247 manifold is given by ,    @xmath248    where @xmath249 and @xmath250 is the normalization constant .",
    "let @xmath251 be the state given by @xmath252 .",
    "thus ,    @xmath253    where @xmath254 is the normalization constant .",
    "we further define the state @xmath255 given by the normalized state @xmath256 .",
    "therefore ,    @xmath257    where @xmath258 is the normalization constant .",
    "we now present some properties relating these normalization constants to each other and their derivatives .",
    "so let @xmath259 be the average number of photons in the cavity for the darkstate in the @xmath104 manifold .",
    "in other words ,    @xmath260    @xmath261 _ proof : _ by definition , @xmath250 is the normalization constant of the dark state @xmath262 .",
    "hence , @xmath263 dividing both sides by @xmath264 gives us ,    @xmath265\\end{aligned}\\ ] ]    @xmath266    _ proof : _",
    "@xmath267 is the normalizaton constant for the state @xmath268 .",
    "hence by definition , @xmath269    dividing both sides by @xmath264 , we get the result ,    @xmath270    from eq .",
    "( [ avgl ] ) , we prove the required result .",
    "if the system is in the dark state @xmath262 , then @xmath271    _ proof : _ it is trivial to see that property 3 is true when @xmath272 .",
    "let @xmath273 .",
    "consider the state @xmath251 given by eq .",
    "[ phik ] . since @xmath273",
    "we can extend the summation to @xmath274 .",
    "thus ,    @xmath275 } \\\\ & = & \\frac{1}{y_k z_k } \\sum_{l=0}^{n - k }      \\left ( l-{\\langle l \\rangle}_k \\right )          \\frac{(-x)^{l-1}}{\\sqrt{(n - k - l)!(l+k)!l ! } }              { |(n - k - l)\\;\\;0\\;\\;(l+k)\\;\\;l\\rangle } \\\\ & { } & \\qquad \\qquad \\qquad   \\mbox{[using property 1 ] } \\\\\\end{aligned}\\ ] ]    @xmath254 is the normalization constant of @xmath251 .",
    "thus , @xmath276    it easy to see that this is merely @xmath277 .    *",
    "property 4 * @xmath278 _ proof : _ @xmath279 using property 2 we get the required result .",
    "@xmath280 _ proof : _ we need to show that @xmath281 which is equivalent to showing that @xmath282 since @xmath283 is positive for all @xmath77 .    @xmath284    we note that @xmath285 thus , @xmath286 in order to evaluate the sum in eq .",
    "( [ eq:5.1 ] ) , we choose two integers between 0 and @xmath287 , @xmath31 and @xmath288 .",
    "we then evaluate the sum of the two terms corresponding to @xmath289 , @xmath290 , and @xmath291 , @xmath292 .",
    "we see that @xmath293    since @xmath294 , we simply need to determine whether @xmath295 . if @xmath296 , @xmath297 is positive and @xmath298 is positive , so the product is therfore also positive .",
    "if @xmath299 , @xmath297 is negative and @xmath300 is also negative , so therefore the product is still positive .",
    "hence , for all @xmath31 and @xmath288 @xmath301 which implies that @xmath302 by eq .",
    "( [ eq:5.1 ] ) and eq .",
    "( [ eq:5.2 ] ) , we have @xmath282 and thus @xmath303 + if the system is in the dark state @xmath262 , @xmath304    _ proof : _",
    "@xmath305}\\\\ & \\leq & { \\langle l \\rangle}_k\\\\   & { } & \\qquad \\mbox{[using property 5]}\\\\ & \\leq & n - k.\\end{aligned}\\ ] ]",
    "we determine here an upper bound on the angular velocity of the dark state , @xmath306 .",
    "we first note that using the chain rule the @xmath307 is equivalent to determining the maximum value of @xmath308 where @xmath254 is the normalization constant defined in equation [ eq : yk ] ) . for convenience",
    ", we will define @xmath309 and @xmath310 ( throughout this appendix , we will use @xmath311 to represent the derivative of @xmath103 with respect to @xmath312 , and @xmath313 to represent the derivative f with respect to @xmath314 ) .",
    "the second step is to determine the maximum value of @xmath317 . using the notation from appendix b",
    ", we first note that @xmath318 , since @xmath319 is normalized . from eq .",
    "( [ eq : yk ] ) , this implies that @xmath320 hence , we can write the following expression for @xmath317 , @xmath321 since @xmath317 must be positive and both @xmath322 and @xmath323 are positive , we can write the following inequality @xmath324    note that @xmath317 is an even function of @xmath312 , so the value of @xmath317 at @xmath272 must be a local minimum or maximum .",
    "when one takes the derivative of @xmath254 with respect to @xmath312 , one finds only a single zero at the origin .",
    "the identity , @xmath325 , implies that @xmath317 must go to zero as @xmath312 increases in order to maintain a finite variance .",
    "therefore , the maximum value of @xmath254 occurs at the origin . explicitly calculating the limit at the origin",
    "yields @xmath326 consequently , we have an expression for the maximum angular velocity @xmath327                                                        ,  ,  ,  , phys .",
    "lett . * 75 * , 3788 ( 1995 ) .",
    "we note that when identical values of g are not possible for all @xmath0 atoms one can still reliably produce n - photon states using a pump laser which does not distinguish between the atoms . the analysis would be similar and rely on the dark states discussed in ref .",
    "@xcite                                     and coupling strength , @xmath20 .",
    "the atom is also coupled to a cavity mode of frequency @xmath7 and coupling strength @xmath6 .",
    "both the cavity and the driving fields are detuned from the atomic transition resonance by a common frequency @xmath63 .",
    "the atom / cavity states are denoted here as @xmath328 where @xmath329 are the three atomic levels and @xmath37 is the number of cavity photons . ]    . the @xmath49 manifold is composed of the eigenstates with simultaneous eigenvalues @xmath50 and @xmath51 where @xmath330 is the number of atoms in atomic state @xmath331 and @xmath37 is the number of photons in the cavity . the transition strength between levels is proportional to either the driving field , @xmath20 , or the cavity coupling , @xmath6 .",
    "the energy of the states in the absence of all couplings is given by -@xmath332 .",
    "for red detuning , @xmath333 , the states with a higher occupation of the exited atomic state , @xmath39 , will have a greater energy .",
    "the dark state is the superposition of states with @xmath334 described in eq .",
    "( [ eq : dark ] ) . a transition from the manifold _ e_(5,3 ) to _",
    "e_(5,2 ) occurs when a photon is emitted from the cavity .",
    "this transition preserves the dark state ( see text ) . ]     and @xmath335 and assuming red detuning , @xmath336 .",
    "this representation is appropriate when the external driving field , @xmath20 , is much larger than the cavity coupling , @xmath6 .",
    "the eigenstates to first order are eigenstates of angular momentum about an axis defined by the effective magnetic fields @xmath337 and @xmath338 .",
    "the cavity coupling , @xmath6 , acts as a perturbation , mixing states differing by a total schwinger angular momentum of 1 . ]     and @xmath224 and assuming red detuning , @xmath339 .",
    "this representation is appropriate when the cavity coupling , @xmath6 , is much larger than the external driving field , @xmath20 .",
    "the eigenstates of the tavis - cummings hamiltonian are complicated ( see text and ref .",
    "@xcite ) but preserve total schwinger angular momentum @xmath103 obtained from modes @xmath3 and @xmath224 .",
    "the coupling to the external field , @xmath20 , acts as a perturbation , mixing states differing by a total schwinger angular momentum of 1 . ]    , for @xmath205 atoms plotted versus dimensionless time , @xmath340 .",
    "these simulations were done using a linear ramp @xmath341 where @xmath342 .",
    "the other cavity parameters were @xmath343 , and @xmath344 .",
    "the integrated cavity flux , @xmath190 , increases linearly with @xmath0 as expected . ]     as a function of @xmath63 .",
    "a linear ramp was used with @xmath345 and @xmath346 .",
    "as expected one sees that in the large @xmath63 limit that the fractional spontaneous loss scales less than n ( see text ) .",
    "our analytical bounds in the large @xmath160 limit suggest that the fractional spontaneous loss should be less than @xmath347 ( dotted line ) .",
    "the discrepancy at large @xmath160 represents parameters for which our perturbative approach is invalid . for the small @xmath160 limit the increasing fractional spontaneous loss is consistent with leakage to states that have a higher occupation of the excited state . ]    , and detuning @xmath63 ( @xmath348 and @xmath346 ) .",
    "as expected , larger ramp rates lead to an increased loss when the system can no longer adiabatically follow the dark state . note how the dependence on @xmath63 varies with @xmath349 . in the adiabatic limit , small @xmath349 ,",
    "large @xmath63 yields the lowest fractional spontaneous loss .",
    "however , when one ramps the system quickly , _",
    "i.e. _ , at large @xmath349 , the dependence on @xmath63 dependence is reversed and small @xmath63 yields the lowest loss . ]     and @xmath346 ) . for the linear ramp ( circles ) , @xmath350 .",
    "for the gaussian ramp ( diamonds ) , @xmath351 , @xmath352 . the gaussian width , @xmath353 ,",
    "was chosen such that the process of emitting a single photon would occur in the same time as the linear ramp .",
    "one expects that a more sophisticated pulse could result in an order of magnitude reduction of the fractional spontaneous loss.,title=\"fig : \" ] n    , and detuning , @xmath63 ( @xmath354 ) .",
    "the values of @xmath63 in the legend are in units of @xmath355 .",
    "one sees that at all values of @xmath63 there is a significant decrease in fractional spontaneous loss for increasing @xmath6 . in the large @xmath160 limit",
    ", one finds that the decrease in spontaneous loss with @xmath6 has a @xmath208 dependence , as predicted by our pertubative analysis ( see section [ sec : small ] ) . ]"
  ],
  "abstract_text": [
    "<S> we present a scheme for the deterministic generation of @xmath0-photon fock states from @xmath0 three - level atoms in a high - finesse optical cavity . </S>",
    "<S> the method applies an external laser pulse that generates an @xmath0-photon output state while adiabatically keeping the atom - cavity system within a subspace of optically dark states . </S>",
    "<S> we present analytical estimates of the error due to amplitude leakage from these dark states for general @xmath0 , and compare it with explicit results of numerical simulations for @xmath1 . </S>",
    "<S> the method is shown to provide a robust source of @xmath0-photon states under a variety of experimental conditions and is suitable for experimental implementation using a cloud of cold atoms magnetically trapped in a cavity . </S>",
    "<S> the resulting @xmath0-photon states have potential applications in fundamental studies of non - classical states and in quantum information processing . </S>"
  ]
}