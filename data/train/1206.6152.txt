{
  "article_text": [
    "gravitational interaction is one of the most important physical processes in the dynamics and the formation of astrophysical objects such as star clusters , galaxies , and the large scale structure of the universe .",
    "stars and dark matter in these self - gravitating systems are essentially collisionless , except for a few cases such as globular clusters and stars around supermassive blackholes .",
    "the dynamics of the collisionless systems is described by the collisionless boltzmann equation or the vlasov equation .",
    "conventionally , gravitational @xmath1-body simulations are used to follow the evolution of collisionless systems . in such simulations , particles represent sampled points of the distribution function in the phase space .",
    "the particles  point masses  interact gravitationally with other particles , through which their orbits are determined .",
    "they are actually super - particles of stars or dark matter particles .",
    "the gravitational potential field reproduced in a @xmath1-body simulation is therefore intrinsically grainy rather than what it should be in the real physical system .",
    "it is well known that two - body encounters can alter the distribution function in the way which violate the collisionless feature of the systems , and undesired artificial two - body relaxation is often seen in @xmath1-body simulations .",
    "there is another inherent problem in @xmath1-body simulations .",
    "gravitational softening needs to be introduced to avoid artificial large - angle scattering of particles caused by close encounters .",
    "physical quantities such as mass density and velocity field are subject to intrinsic random noise owing to the finite number of particles , especially in low - density regions .    to overcome these shortcomings of the @xmath1-body simulations , several alternative approaches have been explored .",
    "for example , the self - consistent field ( scf ) method @xcite integrates orbits of particles under the gravitational field calculated by expanding the density and the gravitational potential into a set of basis functions . in the scf method ,",
    "the particles do not directly interact with one another but move on the smooth gravitational potential calculated from the overall distribution of the particles . despite of these attractive features ,",
    "the major disadvantage of the scf method is its inflexibility that the basis set must be chosen so that the lowest order terms reproduce the global structure of the systems under investigation @xcite . in other words ,",
    "the scf method can be applied only to the secular evolution of the collisionless systems .",
    "the ultimate approach for numerical simulations of the collisionless self - gravitating systems would be direct integration of the collisionless boltzmann equation , or vlasov equation , combined with the poisson equation . the advantage of the vlasov ",
    "poisson simulations was already shown by @xcite and @xcite , who studied one - dimensional violent relaxation problems using the water - bag method @xcite .",
    "@xcite , for the first time , successfully solved the vlasov ",
    "poisson equations for one - dimensional and spherically symmetric systems using the finite volume method .",
    "other grid - based approaches include the seminal splitting method of @xcite , more generally the semi - lagrangean methods @xcite , a finite element method @xcite , a finite volume method @xcite , the spectral method @xcite , and a more recent multi - moment method @xcite .",
    "a comparison study of some of these methods is presented in @xcite .",
    "so far , such direct integration of the vlasov equation has been applied only to problems in one or two spatial dimensions .",
    "solving the vlasov equation in six - dimensional phase space requires an extremely large memory and computational time .",
    "however , the rapid development of massively parallel supercomputers has made it possible to simulate collisionless self - gravitating systems in the full six - dimensional phase space by numerically integrating the vlasov ",
    "poisson equations with a scientifically meaningful resolution .    in this paper",
    ", we present the results from a suite of large simulations of collisionless self - gravitating systems . to this end",
    ", we develop a fully parallelized vlasov  poisson solver .",
    "we perform an array of test calculations to examine the accuracy of our simulation code .",
    "we compare the obtained results with analytic solutions as well as linear theory predictions .",
    "we discuss the advantage and disadvantage of the vlasov ",
    "poisson approach over the conventional @xmath1-body method .",
    "the rest of the paper is organized as follows .",
    "section 2 is devoted to describe the detailed implementation of our numerical code to directly integrate the vlasov ",
    "poisson equations . in section 3",
    ", we present the results of several test runs and their comparison with those obtained with the @xmath1-body method .",
    "the cpu timing and the parallelization efficiency are presented in section 4 . finally ,",
    "in section 5 , we summarize our results .",
    "for a collisionless self - gravitating system , the distribution function of matter @xmath2 obeys the vlasov ",
    "poisson equations @xmath3 where @xmath4 and @xmath5 are the spatial and velocity coordinates , and @xmath6 is the gravitational potential satisfying the poisson equation @xmath7 we normalize the distribution function so that its integration over entire velocity space yields the mass density .    in order to numerically compute equations ( [ eq : vlasov ] ) and ( [ eq : poisson ] ) simultaneously using the finite volume method , we configure @xmath8 uniformly spaced cartesian grids ( the spatial grids ) in a simulation volume defined in @xmath9 , @xmath10 , and @xmath11 .",
    "we also configure @xmath12 uniform cartesian grids ( the velocity grids ) in the velocity space with @xmath13 , @xmath14 , and @xmath15 at each spatial grid .",
    "thus , the grid spacings are given by @xmath16 and @xmath17 for the spatial and velocity grids , respectively .",
    "we adopt the time splitting scheme proposed by @xcite .",
    "the vlasov equation is split into one - dimensional advection equations for each dimension of the phase space .",
    "practically , we solve the following six one - dimensional advection equations sequentially ; three for the advection in the position space @xmath18 @xmath19 @xmath20 and the remaining three equations in the velocity space @xmath21 @xmath22 @xmath23    a number of schemes are available to solve the advection equations on regular grids , such as the semi - lagrange scheme @xcite and the spectral method @xcite",
    ". an important property of the vlasov equation is the conservation of the phase space density of matter , which leads to the conservation of mass in the system .",
    "therefore , it is quite natural to adopt a manifestly conservative scheme",
    ". also the positivity of the phase space density has to be ensured . in this paper , we adopt the positive flux conservation ( pfc ) scheme proposed by @xcite for the time evolution of the advection equation . the pfc scheme , by construction , ensures the conservation of the mass , the preservation of the positivity , and the maximum principle .",
    "here , we describe the pfc scheme briefly .",
    "let us consider discretizing the following one - dimensional advection equation @xmath24 let @xmath25 be the averaged value of the distribution function at a spatial region with the central value of @xmath26 and the interval of @xmath27 such that @xmath28 suppose the values of the distribution function @xmath29 at a time of @xmath30 are known for a finite set of grid points .",
    "the conservation of the phase space density leads to @xmath31 where @xmath32 and @xmath33 is the value of the @xmath34-coordinate of the characteristic curve at a time of @xmath35 originating from the phase space coordinate @xmath36 . by denoting @xmath37 and @xmath38 equation ( [ eq : conserve ] )",
    "can be rewritten as @xmath39 we compute @xmath40 and @xmath41 by interpolating the values of the distribution function at the grid points .",
    "specifically , we adopt the third order approximation of @xmath42 with a slope corrector to suppress artificial numerical oscillations @xcite . as for the boundary condition in solving the one - dimensional advection equations ,",
    "the outflow boundary condition is implemented in the velocity space .",
    "thus , when the matter is accelerated beyond the predefined velocity limit @xmath43 , it is regarded as vanished . in the position space ,",
    "both of the periodic and outflow boundary conditions are available depending on problems .",
    "using the pfc scheme for the numerical integration of one - dimensional advection equations , we advance of the distribution function from @xmath44 to @xmath45 by sequentially updating each one - dimensional advection equation as @xmath46 where @xmath47 denotes the numerical advection operator along @xmath48-direction for a timestep of @xmath49 . here , we solve the poisson equation after operating the advection equations in the position space .",
    "this time integration scheme is equivalent to the second order leapfrog scheme .",
    "the gravitational potential @xmath6 is computed under the periodic boundary conditions or the isolated boundary conditions . for a given distribution function @xmath50 , the mass density @xmath51 at a spatial grid point @xmath4",
    "is obtained simply by integrating the distribution function over the velocity space , @xmath52 we adopt the convolution method with the fourier transform @xcite to numerically solve the poisson equation .    for the periodic boundary conditions , we first compute the discrete fourier",
    "transform ( dft ) of the density @xmath53 using the fast fourier transform ( fft ) , where @xmath54 is a wave - number vector .",
    "then , the fourier - transformed gravitational potential is given by @xmath55 where @xmath56 is the dft of the green function of the discretized poisson equation .",
    "for @xmath57 , it is given by @xmath58 finally , the inverse fft of @xmath59 yields the gravitational potential @xmath60 in the real space .",
    "as for the isolated boundary condition , we adopt the doubling up method @xcite , in which the number of the spatial grid points is doubled for all coordinate axes , and the mass densities in the extended grid points are set to zero . the green function is constructed as follows .",
    "first , it is defined at @xmath61 grid points in real space as @xmath62 for @xmath63 , @xmath64 , @xmath65 . by duplicating and mirroring it in the extended grid points ,",
    "we obtain the green function periodic in the @xmath66 grid points .",
    "after computing the fourier transform of the green function @xmath56 , the gravitational potential in the real space @xmath60 is obtained in the same manner as in the periodic boundary condition .    in order to calculate the gravitational force at each spatial grid point ,",
    "we adopt the 2-point finite - difference scheme , in which the gradient of the gravitational potential is calculated as @xmath67 where @xmath68 is the gravitational potential at a spatial grid point with indices of @xmath69 .",
    "the computational cost for the time integration of the vlasov equation and the required amount of memory to store the distribution function in the phase space roughly scale proportional to @xmath70 .",
    "hence efficient parallelization is indispensable for the numerical integration of the vlasov  poisson equations .    to parallelize our vlasov ",
    "poisson solver , we decompose the computational domain in the phase space as follows . the position space is divided along each spatial axes into subdomains , while the velocity space at a given spatial position is not decomposed . in this way we can achieve an equal balance in memory on distributed memory computers .",
    "we use the message passing interface ( mpi ) for the inter - node parallelization ; each mpi process operates on a decomposed phase space .",
    "we also use the openmp implementation to utilize the multi - thread parallelization on multi cpu - cores in individual nodes . to solve the advection equations along the spatial coordinate ( @xmath34- , @xmath71- and @xmath72-coordinate ) on each mpi process",
    ", the values of the distribution function at the adjacent spatial grid points are exchanged between the computational nodes . in solving the poisson equation , we do not parallelize the fft because the required computational cost of the fft is nearly negligible compared with other portions of the calculations and also because the size of fft ( @xmath73 ) is not large enough for sufficient speed - up of the calculations .      in solving the one - dimensional advection equation ( [ eq:1d_adv ] ) using the pfc method described in section 2 ,",
    "the timestep width @xmath49 is not restricted by the courant  friedrichs  levy ( cfl ) condition . however , when integrating the multi - dimensional vlasov ",
    "poisson equations , we need to constrain the timestep under the following considerations ; ( i ) the accuracy of the characteristic lines is better for the smaller @xmath49 .",
    "( ii ) to integrate the vlasov equation on a distributed memory system with phase space domain decomposition , the exchange of the distribution function at the boundaries of subdomains is unavoidable .",
    "if we set too large a timestep width , the trajectories of the characteristic lines get more distant from the boundaries and then the number of grid points whose data should be sent to the adjacent subdomains becomes also larger , resulting in the increase of data exchange among the mpi processes .",
    "we constrain the timestep for integrating the vlasov equation as @xmath74 where @xmath75 and @xmath76 is the timestep constraints for the advection equations in position space ( [ eq : adv_xpos])([eq : adv_zpos ] ) given by @xmath77 and for the ones in velocity space ( [ eq : adv_xvel])([eq : adv_zvel ] ) given by @xmath78 where @xmath79 , @xmath80 and @xmath81 are the @xmath34 , @xmath71 and @xmath72-components of the gravitational acceleration , @xmath82 , at the @xmath83-th grid point , and the minimization is taken over all the spatial grids .",
    "in this section , we present a series of vlasov  poisson simulations of self - gravitating systems using our newly developed parallel code .      as a test of the pfc scheme to solve a 1-dimensional advection equation",
    ", we perform simulations of 1-dimensional freely streaming matter .",
    "this is the most trivial test , but it is indeed important to check the positivity and non - oscillatory behaviour of the distribution function .",
    "we solve the following vlasov equation without the gravitational acceleration term , @xmath84 here , we consider a 2-dimensional phase space defined as @xmath85 where we impose the periodic boundary condition for the @xmath34-coordinate .",
    "the initial condition is given by @xmath86 it is expected that for each velocity @xmath87 the distribution function is translated with time at a speed of @xmath87 and its shape with respect to @xmath34 is preserved .",
    "the numbers of grids along @xmath34- and @xmath87-coordinates are both set to be 128 .",
    "figure  [ fig:1d_adv ] shows the phase space density at @xmath88 , @xmath89 and @xmath90 , where the system s unit @xmath91 is defined as @xmath92 .",
    "the black lines show the contour for @xmath93 and 1.0 .",
    "we clearly see that the sharp edge of the phase space density is well reproduced .",
    "we confirmed that there is no numerical oscillations around the sharp edge and also that the distribution function is always positive in the phase space .",
    "profiles of the distribution function with respect to @xmath34 along @xmath94 at @xmath88 , @xmath89 , @xmath90 and @xmath95 are shown in [ fig:1d_adv_profile ] .",
    "since we impose the periodic boundary condition in the @xmath34-direction , it is expected that the profile of the distribution function remains the same at @xmath88 , @xmath89 , @xmath90 and @xmath95 along @xmath94 .",
    "although the sharp edges around @xmath96 are slightly smeared due to the phase error caused by numerical diffusion , the profiles at @xmath97 and @xmath95 are almost the same .",
    "numerical diffusion smears the distribution function only initially , but does not cause secular errors .    figure  [ fig:1d_adv_diag ] shows the relative errors of the kinetic energy @xmath98 given by @xmath99 and the total mass @xmath100 @xmath101 during the calculation , manifesting that both of the kinetic energy and the mass are conserved within the accuracy of @xmath102 . note that the pfc scheme for the 1-dimensional advection equation ensures the conservation of the mass , the zeroth - order velocity moment of the distribution function , but not the first- and second - order moment , and that the conservation of the latters mainly depends on the numerical resolution of the velocity space .                      in this test ,",
    "we simulate a one - dimensional infinite self - gravitating system following the vlasov equation @xmath103 coupled with the poisson equation @xmath104 under the periodic boundary conditions in @xmath34-direction .",
    "we consider a maxwellian system with a periodic density fluctuation .",
    "the initial distribution function is set to be @xmath105 where @xmath106 is the mean mass density , @xmath107 is the velocity dispersion and @xmath108 is the amplitude of the density fluctuation . in this system , when the wave number of the density fluctuation @xmath109 is smaller than the critical jeans wave number @xmath110 given by @xmath111 the density fluctuation grows through the jeans instability . on the other hand ,",
    "when @xmath112 , the density fluctuation damps through the collisionless damping , or the landau damping .",
    "the computational domain of the two - dimensional phase space is set to be @xmath113 where @xmath114 is defined as @xmath115 and @xmath91 is the dynamical time defined by @xmath116 the number of grid points is 128 in both @xmath117 and @xmath118direction unless otherwise stated .",
    "since we impose the periodic boundary conditions , the wave number must be set to @xmath119 , where @xmath120 and @xmath121 is a positive integer , and the velocity dispersion @xmath107 is determined such that the ratio @xmath122 is adjusted to have a specific value . in",
    "what follows , the wave number is fixed to @xmath123 ( @xmath124 ) .",
    "we show the results for @xmath125 , 0.5 , 1.1 and 2.0 .",
    "the amplitude of the initial density perturbation @xmath108 is set to @xmath126 for @xmath127 and @xmath128 for @xmath129 .",
    "figure  [ fig:1d_grav ] shows the phase space density for the case with @xmath130 at @xmath131 , @xmath132 and @xmath133 . in this case , as expected , the density fluctuation grows monotonically , and collapsed objects are formed through the gravitational instability .",
    "contrastingly , the density fluctuation is damped through the landau damping in the run with @xmath134 , as can be seen in figure  [ fig:1d_grav_2 ] .",
    "figure  [ fig:1d_grav_delta ] shows the time evolution of the amplitude of the density fluctuation @xmath135 for @xmath125 , 0.5 , 1.1 and 2.0 , where the amplitude is expressed in terms of the fourier amplitude @xmath136 which is given by @xmath137 the time evolution of @xmath138 is plotted in figure  [ fig:1d_grav_delta ] .",
    "we also check the convergence of the solution by doubling the resolution in the velocity space .",
    "the results from the runs with @xmath139 and @xmath140 are also compared in figure  [ fig:1d_grav_delta ] .",
    "the linear growth ( or damping ) rate @xmath141 can be computed using the dispersion relation @xmath142 where @xmath143 is the plasma dispersion function @xmath144 and @xmath145 is given by @xmath146 a more detailed description on the growth rate and the dispersion relation can be found in binney & tremaine ( 2008 ) . for a given value of @xmath122 , the growth and damping rates can be computed by solving equation  ( [ eq : dispersion ] ) .",
    "the bold line in each panel in figure  [ fig:1d_grav_delta ] indicates the theoretical linear growth or damping rate @xmath141 .",
    "our numerical results are in good agreement with the linear theory prediction in the early phase .",
    "also there is no significant difference between the results with @xmath147 and @xmath148 , indicating excellent convergence .",
    "it is interesting that the growth of the perturbation saturates at @xmath149 in the run with @xmath150 . for @xmath151 ,",
    "the timescale of the damping is shorter than the dynamical timescale .",
    "a significant fraction of the mass are trapped in the trough of the gravitational potential , with the distribution function being peaked around @xmath152 .",
    "since such a distribution function with a small velocity dispersion can not damp the density fluctuation efficiently via the landau damping , density fluctuations begin oscillating after the early linear damping phase .",
    "similarly , fluctuation damping saturates at @xmath153 for @xmath134 .",
    "figure  [ fig:1d_grav_2 ] shows that the phase space density in the run with @xmath134 departs from the initial gaussian distribution .",
    "the distribution function is more concentrated around @xmath152 at later times .",
    "these features are also pointed out by @xcite .",
    "the top panel of figure  [ fig:1d_grav_diag ] shows the time evolution of kinetic energy @xmath98 given by equation  ( [ eq : kinetic_energy ] ) and the gravitational potential energy @xmath154 computed as @xmath155 as well as the total energy @xmath156 .",
    "the middle and bottom panels indicate the relative errors in the total energy @xmath157 and the total mass @xmath100 given by equation  ( [ eq : total_mass ] ) .",
    "the total energy and the mass are conserved within the relative errors of @xmath158 and @xmath159 , respectively .",
    "it is well known that mesh - based hydrodynamical codes generally do not assure the galilean invariance because approximate riemann solvers employed in many of such codes are not manifestly galilean invariant @xcite .",
    "this is in good contrast with particle - based @xmath1-body simulations which are exactly galilean invariant as long as a symmetric time integration scheme is used . in the light of this , it is interesting and important to examine the galilean invariance of our mesh - based scheme for self - gravitating systems .",
    "we test our code by adding a constant translational velocity @xmath160 to the initial conditions of the test 2 problem .",
    "we compare the results with the original one ( with @xmath161 ) presented in the previous section .    specifically , we set the initial distribution function as @xmath162 where the velocity dispersion is set such that @xmath130 and @xmath134 ( see equation [ [ eq : jeans_wavenumber ] ] ) .",
    "we assign @xmath163 and @xmath164 .",
    "the numbers of the grid points are set to @xmath165 and @xmath140 .",
    "figure  [ fig:1d_grav_trans ] shows the comparison of the time evolution of the density fluctuation of a @xmath124 mode with @xmath166 and @xmath164 to the original result with @xmath161 presented in test 2 . clearly , the results are independent of the translational velocity and hence our code is galilean invariant to this accuracy .          we study the gravitational instability and the landau damping in a 3-dimensional self - gravitating system .",
    "we solve the vlasov equation coupled with the 3-dimensional poisson equation in six - dimensional phase space under the periodic boundary conditions for spatial coordinates .",
    "the run is configured as follows . at each spatial grid ,",
    "the initial distribution function is given by @xmath167 where @xmath168 is the initial density fluctuation at a spatial position @xmath4 .",
    "the density fluctuations are generated by assigning uniform random values between @xmath169 and @xmath170 so that the resulting density field has a white noise power spectrum .",
    "we assign the velocity dispersion which is determined from a predefined jeans wavenumber @xmath110 .",
    "the phase space volume with @xmath171 and @xmath172 is discretized with @xmath173 and @xmath174 , where @xmath114 is again defined by @xmath175 and @xmath176 . in what follows ,",
    "@xmath177 is set to 0.1 , and we present the results for @xmath178 and @xmath179 .",
    "note that the velocity dispersions @xmath107 in the runs with @xmath180 and @xmath181 correspond to @xmath182 and @xmath183 , respectively . to characterize the three - dimensional density fluctuations and their evolution , we compute the power spectrum @xmath184 , where @xmath185 is the discrete fourier transform of @xmath186 given by @xmath187    figure  [ fig:3d_damping_pk ] shows the power spectra of the density field at @xmath88",
    ", @xmath188 , @xmath189 , @xmath190 , and @xmath191 computed in the runs with @xmath180 ( left panel ) and @xmath181 ( right panel ) , where the vertical line in each panel indicates the jeans wavenumber .",
    "as expected , the fluctuation modes with @xmath192 grow through the gravitational instability , whereas the modes with @xmath193 damp due to the landau damping .",
    "these features can be directly observed in the time evolution of the density fields in @xmath4-space shown in figure  [ fig:3d_damping_map ] , in which we set @xmath181 .",
    "we can see that density fluctuations with smaller wavelength which is dominant at the early epoch ( @xmath194 ) gradually vanish and only those with longer wavelength grow with time through the gravitational instability .",
    "note that the jeans length in this run ( @xmath181 ) is @xmath195 , and it can be seen , by visual inspection , that there are no density fluctuations with wavelength much smaller than the jeans length @xmath195 at @xmath196 .",
    "we have also performed a convergence test for the three - dimensional case in order to examine the effect of the resolution in the velocity space .",
    "we run the same simulation but with @xmath197 and @xmath181 . in figure",
    "[ fig:3d_damping_resolution ] , the resulting power spectra are compared with those obtained in the run with @xmath198 for the same jeans wave number .",
    "overall an excellent agreement is found except that the damping of modes of large wave numbers @xmath199 is somewhat suppressed at late times in the run with coarser velocity resolution .",
    "note that the vertical axis in logarithmic scale ; the amplitudes of the small - scale modes damp over three orders of magnitude by @xmath200 .",
    "figure  [ fig : pk_ratio ] shows the time evolution of the ratio between the power spectra with respect to the initial power spectrum @xmath88 , @xmath201 , for various @xmath122 .",
    "we plot both the results with @xmath202 and 32 for comparison . in the linear regime",
    ", the ratios should be proportional to @xmath203 , where @xmath141 is the growth or damping rate calculated from the linear theory ( see the previous section ) .",
    "we show the growth / damping of @xmath203 for the adopted value of @xmath122 as solid lines .",
    "figure  [ fig:3d_damping_resolution ] clearly shows that there is no significant difference between the results with different velocity resolutions except for a very small deviation at late times for a strongly damping mode of @xmath204 .",
    "it can be seen that the results with @xmath205 , 0.81 , and 1.18 agree with the linear theory well . for @xmath206 , however , the obtained damping rate is lower than the theoretical prediction especially at @xmath207 .",
    "this feature is also consistent with what we found in test 2 .",
    "it is likely owing to the same mechanism of the suppression of landau damping for a fluctuating mode with large @xmath122 as discussed in section 3.2 .",
    "we perform a vlasov  poisson simulation of the king sphere .",
    "the distribution function of the king sphere is a stable solution of the vlasov ",
    "poisson equations and has a finite extension in the spatial coordinate unlike other analytic stable solutions such as the plummer sphere and the osipkov  meritt model .",
    "the test is suitable for checking the accuracy of the time integration of the vlasov equation .",
    "let us denote the relative potential @xmath208 and relative energy @xmath209 by @xmath210 and @xmath211 respectively , where @xmath212 is the gravitational potential with the boundary condition @xmath213 as @xmath214 .",
    "then the distribution function of the king sphere is given by @xmath215 where @xmath216 and @xmath107 are the constants which determine the total mass @xmath217 and the overall shape of the king sphere .",
    "the shape of the king sphere is characterized by the king parameter @xmath218 , which we set @xmath219 in the followings . for @xmath219 , the tidal radius @xmath220 ,",
    "the outer boundary of the king sphere is @xmath221 , where @xmath222 and @xmath223 is the central mass density .",
    "we consider the phase space volume with @xmath224 and @xmath225 where @xmath226 and @xmath227 , and discretize it into grids with @xmath173 and @xmath228 . in setting up the initial condition , after the phase space density in each phase space grid is calculated using the velocity and the relative potential at the grid center , we re - normalize the total mass of the king sphere so that the initial virial ratio @xmath229 is unity , where @xmath230 and @xmath231 is the total kinetic and gravitational potential energy of the system .",
    "figure  [ fig : king_sphere ] shows the mass distribution of the simulated king sphere as a function of radius @xmath232 .",
    "note that , in this figure , mass within a shell with @xmath233 is proportional to the area enclosed between the the profiles @xmath234 in @xmath235 and the horizontal dotted lines ( @xmath236 ) .",
    "it can be seen that the mass distribution does not change significantly over one dynamical timescale , irrespective of the numerical resolution of the velocity space . in figure",
    "[ fig : king_sphere ] , we can see the slight mass transfer from the inner part ( @xmath237 ) to the outer ( @xmath238 ) regions of the king sphere . since the grid spacing of the spatial grid is @xmath239 and the region with @xmath240",
    "is resolved with only @xmath24110 grid points , the mass transfer can be ascribed to the numerical diffusion of the pfc scheme seen in figure  [ fig:1d_adv_profile ] .",
    "figure  [ fig : king_sphere_diag ] shows the time evolution of the kinetic , gravitational potential and total energy of the king sphere simulated with @xmath242 .",
    "over one dynamical timescale , the total energy is kept constant with a relative error of @xmath243 1% .",
    "the kinetic and gravitational potential energies are also kept constant with good numerical accuracy of 1% as long as @xmath131 .",
    "the total mass is also conserved with a relative error of @xmath244 .              as a final test",
    ", we perform a simulation of merging of two king spheres using our vlasov  poisson solver .",
    "we also run the same simulation using a conventional @xmath1-body method and compare the results .",
    "the initial conditions are set up as follows .",
    "two king spheres with the same physical parameters as in test-5 are initially located at @xmath245 and @xmath246 .",
    "the spheres are then given bulk velocities of @xmath247 and @xmath248 along @xmath34-axis , respectively .",
    "the phase space volume we consider has an dimension of @xmath249 and @xmath250 , which is discretized onto grids with @xmath173 and @xmath251 or @xmath252 .",
    "note that the extension of the velocity space is larger than in the previous test , because some portion of the matter can have large velocities during the merging of the two spheres .    for comparison",
    ", we perform an @xmath1-body simulation of the same system .",
    "the initial conditions are set up in the same manner except that each king sphere is represented by @xmath253 particles . in this @xmath1-body simulation",
    ", we adopt the particle - mesh ( pm ) method as a poisson solver , in which the triangular - shaped cloud ( tsc ) mass assignment scheme is used in computing mass density field from the particle distribution .",
    "the gravitational force is calculated using the 4-point finite difference scheme .",
    "the number of grid points to compute the gravitational potential is set to 64 for each of @xmath34- , @xmath71- and @xmath72-dimension , which gives effectively the same spatial resolution as that of the vlasov ",
    "poisson solver .",
    "figure  [ fig : king_merging_map ] depicts the time evolution of mass density map at @xmath254 plane in the run with @xmath255 .",
    "the cores of the two king sphere first encounter at @xmath256 and then go through each other in a collisionless manner .",
    "the density distribution is smooth at all the time .",
    "we compare the mass density distribution at @xmath257 between the vlasov ",
    "poisson simulation and the @xmath1-body simulation in figure  [ fig : king_merging_map ] and figure  [ fig : king_merging_nbody_map ] .",
    "both the simulations produce fairly consistent results , although the density distribution in the @xmath1-body simulations appears slightly asymmetric between the two spheres .    for a more quantitative comparison between the vlasov  poisson and @xmath1-body simulations , the time evolution of the kinetic , the gravitational potential , and the total energies in both the simulations are shown in the top panel of figure  [ fig : king_merging_diag ] .",
    "one can see clearly the consistent behaviors of the kinetic and gravitational potential energies in the vlasov  poisson and @xmath1-body simulations .",
    "the slight differences between the two runs are primarily due to the different discretization of the system",
    ". relative errors of the total mass and energy conservation in the runs with @xmath251 and @xmath228 are shown in figure  [ fig : king_merging_diag ] .",
    "the total mass is well conserved with a sufficiently small relative error of @xmath258 in both resolutions in the velocity space ( bottom panel ) .",
    "we find a slight decrease in the total mass at @xmath259 in the run with the lower velocity resolution .",
    "this is because the extent of the matter distribution in the velocity space exceeds the predefined velocity ranges during the merging of the cores of the two king spheres . in the run with the higher velocity resolution , while it is also the case that the extent of the matter distribution in the velocity space is not fully enclosed , the deviation from the total mass conservation is kept relatively small because the better velocity resolution enables better reconstruction of the distribution function at the high velocity tails .",
    "total energy conservation is assured better in the run with the higher velocity resolution . even with the higher resolution , however , the relative error in the total energy is @xmath260 at @xmath261 , while it is @xmath243 1.5% at @xmath262 .",
    "again , this can be understood by the fact that the extent of the matter distribution in the velocity space is beyond the predefined velocity ranges during @xmath263 .",
    "such velocity overflow gives a stronger impact to the total energy budget rather than the total mass conservation because matter with a large velocity has naturally a large kinetic energy .",
    "it would be desirable to develop a scheme which adaptively rescales the velocity space with proper reconstruction or re - mapping of the velocity distribution function .",
    "we have seen in figure  [ fig : king_merging_map ] and figure  [ fig : king_merging_nbody_map ] that the density distributions are quite similar between the vlasov run and the @xmath1-body run .",
    "it is interesting to compare the matter distribution in the velocity space between the two simulations .",
    "the left panel of figure  [ fig : vel_space_map ] shows the phase space density in the velocity space at a single spatial grid point near the mass center of the two king spheres . for this plot",
    ", we use the output at @xmath264 , when the two peaks of the phase space density match the bulk velocities of the two king spheres .",
    "the velocity distribution of the particles in the same spatial volume of the @xmath1-body simulation are depicted in the right panel of figure  [ fig : vel_space_map ] .",
    "although there are two broad clumps at roughly the same locations as those in the vlasov ",
    "poisson run , one can clearly see severe contaminations by the shot noise .",
    "the velocity struture is not well sampled even in the @xmath265 run .    in order to quantify the shot noise level in the velocity distribution of the @xmath1-body simulation , we compute the power spectra of the velocity distribution function @xmath266 where @xmath267 is a discrete fourier transform of the distribution function in the velocity space and @xmath268 is a wave number vector corresponding to a certain velocity vector .",
    "the velocity power spectra thus calculated at the same spatial position as in figure  [ fig : vel_space_map ] are shown in figure  [ fig : vel_power_spec ] .",
    "the two power spectra are in good agreement with each other at large velocity scales , @xmath269 . at small velocity scales ( @xmath270 ) , however , the @xmath1-body simulation exhibits a flat spectrum , showing good contrast with the nearly power - law spectrum in the vlasov  poisson simulation . the velocity power for the @xmath1-body run is significantly contaminated by the shot noise . on the assumption that the velocity power of the vlasov ",
    "poisson simulation is accurate to @xmath271 , we argue that the same result would be obtained if we could employ nearly a five orders - of - magnitude larger number of particles in the @xmath1-body simulation .",
    "all of the simulations presented in the present paper were performed with a large scale massively parallel supercomputer , t2k - tsukuba system installed at center for computational sciences , university of tsukuba .",
    "each computational node of the t2k - tsukuba system consists of four sockets of 2.3ghz quad - core amd opteron and 32gbyte of ddr2 sdram memory .",
    "all the nodes are connected through quad - rail of ddr infiniband interconnection network .    the required memory @xmath217 is approximately computed as @xmath272 where @xmath273 and @xmath274 are the numbers of grids in the spatial and velocity spaces , respectively .",
    "our vlasov code uses single - precision floating point numbers for storing the value of the distribution function .",
    "since each node of the t2k - tsukuba system can store data up to 24 gbytes on its memory , for the runs with @xmath275 and @xmath276 , we typically use 1664 nodes .",
    "table  [ tab : breakdown ] shows a breakdown of the wall clock time consumed by several parts in our code over a single timestep integration .",
    "all of the runs ( a , b and c ) are performed with 64 mpi processes and each mpi process is also parallelized in a multi - thread manner using the openmp implementation .",
    "for example , run a adopts 16 nodes ( equivalently 256 cpu cores ) , and each mpi process invokes 4 threads . although the explored parameter space is limited , we confirm that our code performs well on up to 1024 cpu cores ( 64 nodes ) .",
    "comparing run a and run b , we see a good weak scaling in which the wall clock time @xmath277 almost precisely scales with the simulation size ( @xmath278 ) with the same number of nodes . on the other hand ,",
    "run c , using four times more nodes , is only three times faster than run b for the same number of grids .",
    "this is because the pfc scheme needs global maximum values of the phase space density over the entire 1-dimensional computational regions to ensure the maximum principle , and thus solving the advection equations in the position space requires data transfer among the nodes associated with the adjacent computational regions through the inter - node network . as a result ,",
    "as we see in the difference between @xmath279 and @xmath280 of table  [ tab : breakdown ] , the advection operations in the position space take longer than in the velocity space .",
    "the necessary data transfer hampers the strong scaling in solving the advection equation in the position space .",
    "ccccccccc i d & @xmath281 & @xmath282 & @xmath283 & @xmath284 [ sec ] & @xmath280 [ sec ] & @xmath285 [ sec ] & @xmath286 [ sec ] & @xmath277 [ sec ] + a & @xmath287 & @xmath288 & 16 & 9.1 & 6.4 & 1.6 & 1.95 & 72.1 + b & @xmath287 & @xmath287 & 16 & 60.1 & 56.3 & 4.7 & 11.1 & 550.2 + c & @xmath287 & @xmath287 & 64 & 21.2 & 14.4 & 5.1 & 10.5 & 181.4 +",
    "in this paper , we have developed a fully parallelized vlasov ",
    "poisson solver in six - dimensional phase space for collisionless self - gravitating systems .",
    "the vlasov solver is based on the recently proposed positive flux conservation scheme , whereas the poisson solver utilizes the conventional convolution method based on the discrete fourier transform .",
    "we have conducted large simulations of collisionless self - gravitating systems on the phase space discretized onto @xmath0 grids .",
    "we have performed a suite of test calculations to examine the accuracy and performance of our simulation code .",
    "the results of the test suite are summarized as follows . in test 1",
    ", we examine the overall accuracy of the pfc scheme to solve a 1-dimensional advection equation which is adopted in all the simulations presented in this paper . the mass and the energy conservations",
    "are confirmed to an accuracy of @xmath102 for the one - dimensional advection problem .",
    "the initial distribution function is well - preserved , without significant smearing due to numerical diffusion . in 1d and 3d tests for the time evolution of the density perturbation through gravatational interactions ( test 2 and 4 , respectively )",
    ", the growth and damping rates of the density perturbations are consistent with the linear theory prediction at early phases .",
    "the galilean invariance is also explicitly shown ( test 3 ) . in test 5 , a stable spherical solution of the vlasov ",
    "poisson equations , the king sphere , is also reproduced in full six - dimensional phase space .",
    "the results manifest that our time - integration scheme is accurate .",
    "finally , our code works efficiently on massively parallel computers .",
    "it runs well on up to 1024 cpu cores and scales well with the problem size and with the number of processors .",
    "we summarize the advantages of the simulations of collisionless self - gravitating systems based on the vlasov ",
    "poisson equations over the conventional @xmath1-body simultaions as follows .",
    "since the matter distribution in the velocity space is explicitly represented in the form of a continuum distribution function , physical processes that are sensitive to the velocity perturbations such as landau damping can be treated accurately as seen in test-2 and 4 .",
    "the collisionless feature is assured in the vlasov  poisson simulations , while artificial two - body relaxation could compromise the results of @xmath1-body simulations .",
    "the resolution in the velocity space in the vlasov ",
    "poisson simulations is shown to be significantly better than that of @xmath1-body simulations in which the particle distribution in the velocity space is intrinsically rather noisy .",
    "currently the spatial resolution of the vlasov ",
    "poisson simulations is not as impressive as those of the state - of - the - art @xmath1-body simulations .",
    "however , the performance of our grid - based vlasov solver scales well with the number of processors .",
    "thus we expect the simulation size can be steadily increased as the available computing power increases in the near future .",
    "we foresee direct integration of the collisionless boltzmann equation will be a promising method in the era of exa - flops computing .",
    "further improvements of the vlasov ",
    "poisson solver we have developed includes an adaptive mesh approach to improve the spatial and velocity resolutions without significantly increasing the required amount of the memory , and an adoption of more sophisticated schemes to solve one - dimensional advection equations to reduce numerical errors caused by the coarse - grained discretization of the phase space .",
    "we thank kojiro suzuki for discussions and comments . this work is supported in part by grant - in - aid for challenging exploratory research ( 21654026 ) from jsps .",
    "ny is grateful for financial support from grant - in - aid for young scientists ( s ) ( 20674003 ) and by the first program subaru measurements of images and redshifts ( sumire ) by the council for science and technology policy .",
    "mu is grateful to jsps grant - in - aid for scientific research ( s ) ( 20224002 ) .",
    "numerical simulations for this work have been carried out under the `` interdisciplinary computational science program '' in center for computational sciences , university of tsukuba ."
  ],
  "abstract_text": [
    "<S> we present a scheme for numerical simulations of collisionless self - gravitating systems which directly integrates the vlasov  poisson equations in six - dimensional phase space . by the results from a suite of large - scale numerical simulations , </S>",
    "<S> we demonstrate that the present scheme can simulate collisionless self - gravitating systems properly . </S>",
    "<S> the integration scheme is based on the positive flux conservation method recently developed in plasma physics . </S>",
    "<S> we test the accuracy of our code by performing several test calculations including the stability of king spheres , the gravitational instability and the landau damping . </S>",
    "<S> we show that the mass and the energy are accurately conserved for all the test cases we study . </S>",
    "<S> the results are in good agreement with linear theory predictions and/or analytic solutions . </S>",
    "<S> the distribution function keeps the property of positivity and remains non - oscillatory . </S>",
    "<S> the largest simulations are run on @xmath0 grids . </S>",
    "<S> the computation speed scales well with the number of processors , and thus our code performs efficiently on massively parallel supercomputers . </S>"
  ]
}