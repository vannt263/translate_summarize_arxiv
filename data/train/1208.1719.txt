{
  "article_text": [
    "the development of efficient monte carlo ( mc ) methods constitutes a key problem in statistical mechanics .",
    "typically , numerical simulations are performed by one - flip algorithms that generate a grand - canonical ensemble , in which intensive quantities are held fixed @xcite . however , in some cases , a different ensemble would be more appropriate . for example , strong first - order phase transitions become extremely hard to simulate by one - flip grand - canonical schemes : the presence of different phases separated by large free - energy barriers makes the system to be trapped into metastable states at the phase coexistence , even for small system sizes .",
    "although different grand - canonical procedures have been proposed @xcite , the microcanonical ensemble is also an appropriate way to circumvent these problems . in this case , the simulation is carried out for fixed energies and intensive thermodynamic quantities are treated as external variables , hence avoiding large entropic barriers .",
    "different microcanonical schemes have been proposed in the last years .",
    "entropic sampling @xcite , broad histogram method @xcite and the wang - landau ( wl ) method @xcite are some examples of procedures in which the density of states ( dos ) is estimated numerically .",
    "other microcanonical approaches , not requiring the knowledge of the dos , have also been developed . in such cases ,",
    "the temperature and other intensive quantities are obtained from auxiliary relations .",
    "for example , creutz @xcite has generated a microcanonical ensemble by assuming a canonical distribution of the energies carried by a `` demon '' , where the total energy is not strictly conserved , but it fluctuates above a constant lower bound .",
    "more recently , martin - mayor @xcite proposed a method where the temperature is obtained from an ensemble of fixed energy ( including the kinetic energy )",
    ". the temperature is calculated from the fluctuations of the spin part .    to analyze the discontinuous transitions in the blume - emery - griffiths ( beg ) @xcite and asymmetric ising models @xcite ,",
    "it has been employed a `` trick '' @xcite , where intensive quantities are calculated through expressions originally derived in the grand - canonical ensemble .",
    "although the equivalence is granted in the thermodynamic limit , gibbs ensembles may be inequivalent for finite systems , including short range interactions at the phase coexistence @xcite .",
    "therefore , in order to the protocol can be extended to more general situations , one should test under what conditions the finite size effects hinder the equivalence between methods . in other words , it should be verified that intensive quantity as a matter of fact correspond to the genuine microcanonical temperature ( obtained from the derivation of entropy with respect to the energy ) .",
    "the first goal of this paper is then to answer the above query .",
    "for so , different aspects of the method will be exemplified by means of distinct lattice systems yielding first and second - order phase transitions .",
    "we first address the ising model , for which the dos are known exactly @xcite .",
    "then we consider as next examples the blume - capel ( bc ) and the potts models .",
    "although they do not present exact dos , we are going to compare with the very efficient wl sampling as a benchmark .",
    "the bc model is an interesting case , since its dos has been obtained by performing a random walk in the space of two parameters ( in similarity to several lattice models presenting distinct particle interactions ) @xcite .",
    "we intend to verify if the calculation of the temperature will be changed by different restrictions in the random walk ( as performed in ref .",
    "@xcite ) .",
    "the potts models is also a very interesting test . unlike the previous cases , its discontinuous transitions ( yielding for @xmath2 ) presents a genuine microcanonical feature , the existence of a loop @xcite .",
    "thus , it is important to verify if our approach not only reproduces this remarkable signature but also is equivalent to the @xmath0 .",
    "in addition , we are also exploiting the interesting @xmath3 case , that although yielding a continuous transitions , it possesses distinct behaviors including logarithmic scaling corrections @xcite and a double peak probability distribution @xcite .",
    "as it will be shown further , the methods becomes equivalent in all above models for relatively small system sizes @xmath1 .",
    "the equivalence includes not only the temperatures but also all extrapolated thermodynamic limit points . however ,",
    "for extreme small @xmath1 s , the results do not agree and thus the intensive quantity can not be recognized as the thermodynamic temperature .",
    "we will present a detailed analysis showing how the methods converge when @xmath1 increases .",
    "a second contribution here is to exploit the advantages .",
    "besides its low computational cost , it does not require criterion for achieving convergence of results .",
    "other immediate advantage is that intensive quantities are evaluated directly from standard numerical simulations and become more precise as the system size increases .",
    "in addition , the method is very easily extended for other lattice models .",
    "this paper is organized as follows : in sec .",
    "ii we review the methods for calculating the temperature . in sec .",
    "iii we show the numerical results for the models and in sec .",
    "iv we present our conclusions .",
    "for a given system size @xmath1 and energy per site @xmath4 ( where @xmath5 and @xmath6 is the dimension ) , the inverse of microcanonical temperature @xmath7 is obtained through the expression @xmath8 where @xmath9 is the entropy per site and @xmath10 .",
    "the quantity @xmath11 denotes the dos for given @xmath12 and @xmath1 . for the ising model , the @xmath11",
    "is known exactly @xcite . for the other models , we shall estimate @xmath11 using the wl sampling @xcite .",
    "the wl sampling is a powerful technique to calculate @xmath11 by carrying out a random walk in energy space with an acceptance probability proportional to @xmath13 , i.e. , @xmath14,\\ ] ] where @xmath15 and @xmath16 are the energies of the current and a possible new configuration , respectively . for each new",
    "accepted configuration an energy histogram @xmath17 is accumulated .    during the random walk , whenever a move to a configuration with energy @xmath12 is accepted ,",
    "@xmath11 is updated by multiplying it by a `` modification factor '' @xmath18 that accelerates the diffusion of the random walk , and an unit is added to the histogram @xmath17 .",
    "the initial choice of @xmath19 is @xmath20 .",
    "@xmath11 is multiplied by @xmath19 until the accumulated histogram @xmath17 becomes flat .",
    "we then reduce @xmath19 by setting @xmath21 , and resetting @xmath22 for all energy values .",
    "the simulation converges to the true value of @xmath11 when @xmath19 approximates to the unit .",
    "in particular , in this work we use the improved wang - landau sampling proposed by cunha - netto _ et al .",
    "_ @xcite . their approach use adaptive energy windows to eliminate border effects that affect the density of states mainly of q - states potts model , which is our case here . in our simulations the criterion of flatness was taken as each value of the histogram reaching at least @xmath23% of the mean value @xmath24 for the bc model and @xmath25% for the potts model .",
    "the histograms are generally checked after each @xmath26 mc steps .",
    "here we performed @xmath27 different runs for the same @xmath1 with different initial seeds in order to reduce statistical fluctuations .",
    "for the bc model , the dos is obtained by performing a random walk for two parameters @xmath12 and @xmath28 ( @xmath29 ) .",
    "an immediate advantage of the wl is that a single run gives the dos for the whole range of energy , which provides the calculation of canonical averages for any temperature .",
    "now , following ref .",
    "@xcite we proceed to obtain the temperature @xmath30 with respect to the microcanonical ensemble .",
    "the method consists in writing down the probabilities of different microscopic configurations in the grand - canonical ensemble and further resorting the equivalence of ensembles .",
    "the probability distribution @xmath31 of a microscopic configuration @xmath32 in the grand - canonical ensemble is given by @xmath33 , with hamiltonian @xmath34 reading @xmath35 for the ising model and @xmath36 for the bc model and @xmath37 for the potts model .",
    "parameters @xmath38 and @xmath39 are the energy between two nearest - neighbor spins and the crystalline field , respectively .",
    "the spin variable @xmath40 takes the values @xmath41 or @xmath42 for the ising model , @xmath43 or @xmath42 for the blume - capel and @xmath44 , for the potts model . in all cases ,",
    "the summations are restricted over nearest neighbor sites .    by considering the transition @xmath45 for ising and bc models and denoting @xmath46 by a microscopic configuration which differs from @xmath40 only by the value of the spin at the site @xmath47 ,",
    "that is , @xmath48 , the ratio between @xmath31 and @xmath49 in the grand - canonical ensemble is given by @xmath50\\ } , \\label{14}\\ ] ] where @xmath51 whose summation is performed over @xmath52 nearest neighbor sites .",
    "if the average of an arbitrary state function in the grand - canonical ensemble is given by @xmath53 , from eq .",
    "( [ 14 ] ) we have that @xmath54   \\}\\rangle_{gc}. \\label{e16}\\ ] ] by taking eq .",
    "( [ e16 ] ) for @xmath55 given by @xmath56 , we have that @xmath57 where @xmath58 denotes one of all possible values of @xmath59 . in the microcanonical ensemble ,",
    "the energy per site @xmath4 is held fixed . assuming the equivalence between the grand - canonical and microcanonical ensembles , we get the following expression @xmath60 which allows us to obtain the temperature @xmath30 with respect to the microcanonical ensemble .",
    "a similar procedure can be performed for the potts model . by choosing two particular states",
    "@xmath61 and @xmath62 ( ranging from @xmath63 to @xmath64 ) with respective transition @xmath65 and the state function @xmath66 we have , by appealing to the equivalence of ensembles , that @xmath67 where @xmath59 is given by @xmath68 . since the above formulae does not specify the dynamics , they are valid for different classes of microcanonical algorithms .",
    "numerical simulations have been performed in a square lattice with @xmath69 sites .",
    "the microcanonical dynamics is composed of two parts . in the first part , a given site of the lattice",
    "is randomly chosen and its spin is changed to one of its all possible values . in the second part , two sites of the lattice ,",
    "also randomly chosen , have theirs spins interchanged .",
    "the above dynamics are accepted only if the total energy remains unchanged .",
    "it is worth mentioning that the actual mc algorithm is quite different from those studied in refs .",
    "@xcite , where both energy and magnetization are strictly conserved . here",
    "the particle moves are accepted only when the total energy does not change .",
    "the number of species ( spins ) is not necessarily conserved .    by applying the logarithm on both sides of eq .",
    "( [ eqmc1 ] ) , we get the following expression ( written in units of @xmath38 and @xmath70 ) @xmath71 where the right - hand of eq . ( [ eqmc1 ] )",
    "was written as @xmath72 .",
    "the possible values of the quantity @xmath73 are given by @xmath74 , where @xmath75 takes the values @xmath76 , for the ising model and @xmath77 , for the bc model .",
    "thus , from the above , by calculating @xmath78 numerically for all possible values of @xmath59 , the temperature is extracted from the inverse of the slope of eq .",
    "( [ eqmic3 ] ) .",
    "a similar procedure is done for the potts model , where we have @xmath79 where @xmath75 assumes the values @xmath80 for all values of @xmath81 .    in the first analysis , we study the validity of eqs .",
    "( [ eqmic3 ] ) and ( [ eqmic4 ] ) for different @xmath1 , as showed in fig .",
    "[ fig1a]@xmath82 and @xmath83 for the ising model .",
    "continuous lines and symbols denote standard and present results , respectively and temperatures calculated for @xmath84 are exact in both cases .",
    "comparison between intensive quantities show that they are slightly different for the smallest @xmath1 s ( @xmath84 and @xmath85 ) .",
    "inspection of part @xmath83 reveals us that in these cases , the quantity @xmath78 is not linear in @xmath75 , and hence eq .",
    "( [ eqmic3 ] ) does not hold .",
    "the non validity of eq .",
    "( [ eqmic3 ] ) for extreme small @xmath1 is exemplified by evaluating the numerator and denominator of eq .",
    "( [ eqmc1 ] ) for @xmath86 and @xmath84 .",
    "since the number of configurations is small , both quantities are zero for @xmath87 , whereas for @xmath88 ( @xmath89 ) the numerator ( denominator ) is null . by increasing @xmath1 the number of configurations becomes large in such a way that the linear dependence between @xmath78 and @xmath75 is achieved . only in this regime",
    "we can evaluate @xmath30 from eq .",
    "( [ eqmic3 ] ) . in practice , estimates become equivalent for rather small system sizes . for example , for the ising model the difference between estimates is in the third decimal level for @xmath90 .     versus @xmath1 for different @xmath91 s for the ising model .",
    "symbols and continuous lines denote the estimates obtained from the present approach and the exact dos , respectively . in @xmath83",
    "we have a mono - log plot of the quantity @xmath72 versus @xmath75 for different @xmath1 and @xmath92 .",
    "curves have been shifted in order to avoid overlapping and continuous lines have been used for better visualization of slopes . ]",
    "similar conclusions are verified for the other models , as exemplified in fig .",
    "[ fig1b]@xmath82 and @xmath83 for the @xmath93 potts model . as in the ising model ,",
    "( [ eqmic4 ] ) is not hold for small @xmath1 s ( exemplified in part ( @xmath94 ) for @xmath86 ) , which becomes equivalent to @xmath95 for larger ( but still rather small ) @xmath1 s .     versus @xmath1 for different @xmath91 s for the @xmath93 potts model .",
    "symbols and continuous lines denote the estimates obtained from the present approach and the exact dos , respectively .",
    "in @xmath83 we have a mono - log plot of the quantity @xmath72 versus @xmath75 for different @xmath1 and @xmath86 .",
    "curves have been shifted in order to avoid overlapping and continuous lines have been used for better visualization of slopes . ]",
    "it is worth remarking that due to the small number of configurations and the discretization of energy , both procedures are not precise in the limit of extreme low energies .",
    "once established the regime of convergence of methods , we extend the previous analysis for the whole range of energy . in fig .",
    "[ fig1 ] @xmath96 , we plot the @xmath78 as function of @xmath75 for several values of @xmath12 and @xmath97 .",
    "note that all curves are linear and cross at @xmath98 , which gives @xmath99 for all energies and temperatures , in consistency with results by beale @xcite , where the dos was enumerated for @xmath99 . in fig .",
    "[ fig1]@xmath82 we plot @xmath7 versus the total energy @xmath12 for different @xmath1 . in order to avoid data overlapping we choose to plot @xmath12 instead of @xmath4 .",
    "the results for the ising model show an excellent agreement between estimates of @xmath7 for all system sizes ( part @xmath83 ) .     versus total energy @xmath12 for the ising model and different system sizes @xmath1 .",
    "symbols and continuous lines ( for @xmath82 and @xmath83 ) denote the estimates obtained from the present approach and the exact dos , respectively .",
    "inset shows the convergence of methods already achieved for @xmath90 . in @xmath83",
    "we have the @xmath7 versus @xmath1 for some values of @xmath4 . in @xmath96",
    "we have a mono - log plot of the quantity @xmath72 versus @xmath75 for @xmath97 and different values of @xmath12 .",
    "slopes of straight lines give @xmath7 . in this case ,",
    "continuous lines have been used for better visualization of slopes . ]    in addition , we have also compared ( not shown ) both schemes at the ferromagnetic - paramagnetic second - order phase transition .",
    "the pseudo - critical temperature @xmath100 may be estimated by the peak in the specific heat @xmath101 ( obtained from the energy numerical differentiation ) .",
    "the deviation between @xmath100 and its asymptotic value @xmath102 ( obtained here ) agrees very well with exact estimates by beale @xcite .",
    "further , we extend the previous analysis to the blume - capel model . in similarity with the wl model @xcite , numerical simulations were performed for fixed @xmath103 and @xmath29 . in practice , @xmath28 fixed implies that the number of spins @xmath63 is conserved .",
    "the one - flip part is restricted to only spins @xmath104 . in fig .",
    "[ fig2]@xmath82 we plot @xmath7 versus @xmath12 for different @xmath28 , whereas in the graph @xmath83 , we analyze the dependence of @xmath7 on @xmath28 for @xmath12 fixed .",
    "the dependence on @xmath1 is also showed in fig .",
    "[ fig2]@xmath96 .",
    "note again a very good agreement between both approaches , even for small system sizes , supporting once more the equivalence between eqs .",
    "( [ twl ] ) and ( [ eqmc1 ] ) .     and",
    "@xmath83 we plot the inverse of temperature @xmath7 as a function of @xmath12 ( @xmath28 ) for the bc model with @xmath28 ( @xmath12 ) fixed and @xmath90 .",
    "symbols and continuous lines denote estimates obtained from the present approach and from wang - landau method , respectively . in @xmath96",
    "we show the dependence of @xmath7 on @xmath1 for different values of @xmath91 and @xmath105 . in @xmath106",
    "we plot @xmath78 versus @xmath75 for @xmath12 for @xmath105 and @xmath97 .",
    "slopes of straight lines give @xmath7 .",
    "in this case , continuous lines have been used for better visualization of slopes . ]",
    "now we take the potts model in kind . as in the ising and bc models",
    ", it also presents ferromagnetic - paramagnetic phase transitions , exactly located at @xmath107 . for @xmath108 ,",
    "it is second - order which becomes first - order for @xmath2 .",
    "the case @xmath3 presents remarkable features , including logarithmic scaling corrections @xcite and a double peak probability distribution @xcite , hence an interesting case to be considered . in figs .",
    "[ fig3]@xmath82 and @xmath83 we evaluated @xmath7 for different energies and system sizes ( relative small @xmath1 s but sufficient large to imply the validity of eq .",
    "( [ eqmic4 ] ) ) . as in the previous examples",
    ", we have also found an excellent agreement between estimates obtained from microcanonical procedures . in the inset of fig .",
    "[ fig3]@xmath82 we plot the pseudo - critical temperature @xmath100 , obtained from the peak in the specific heat @xmath101 . for @xmath3 , the deviation of @xmath100 from its asymptotic value @xmath109 decays as @xmath110 @xcite , where we found ( by using this scaling law ) the estimate @xmath111 , in excellent agreement with the exact value @xmath112 .",
    ", we plot the inverse of temperature @xmath7 versus @xmath12 for several @xmath1 in the @xmath3 potts model .",
    "symbols and continuous lines denote estimates obtained from present approach and wl , respectively . in @xmath83",
    "we plot the dependence of @xmath7 on @xmath1 for different values of @xmath91 .",
    "in @xmath96 we plot the @xmath78 versus @xmath75 for different energies and @xmath97 .",
    "slopes of straight lines give @xmath7 . in this case ,",
    "continuous lines have been considered for better visualization of slopes . in the inset we plot",
    "the inverse of the temperature @xmath100 in which specific heat presents a maximum versus @xmath110 .",
    "the straight line has linear coefficient @xmath111 . ]    in the last analysis , we evaluated the microcanonical temperature for the @xmath93 and @xmath113 states potts model .",
    "these are also very interesting cases because , in contrast to all previous ones , they possesses discontinuous transitions characterized by a s - like structure , a `` loop '' @xcite , hence ideal examples for illustrating the correctness of the present approach .",
    "loops for finite systems in the microcanonical ensemble are due to interfacial effects , in which the surface tension behaves as @xmath114 @xcite . in contrast , systems simulated in the grand - canonical ensemble do not present loops . in fig .",
    "[ fig4 ] we show the validity of eq .",
    "( [ eqmc2 ] ) by plotting @xmath7 versus @xmath91 for @xmath93 ( part @xmath82 ) and @xmath113 ( part @xmath83 ) for @xmath115 . as in all previous cases",
    ", we also have a good agreement between the temperatures , for both values of @xmath81 .",
    "however , in contrast with our results , estimates obtained from the wl method presents large fluctuations , even using the adaptive windows improvement , taking the flatness criterion of 90@xmath116 for the convergence of @xmath17 and evaluating the mean dos over 10 different seeds . on the other hand ,",
    "our estimates become more precise as @xmath1 increases . for smaller system sizes they are less accurate ( already taking the @xmath1 for which methods are equivalent ) , despite the accordance with estimates from the wl method .",
    "this can be understood in the following : since the number of configurations for fixed @xmath12 is very large and the right side of eq .",
    "( [ eqmc2 ] ) is evaluated from only two possible spins , averages become less precise for small @xmath1 . by increasing @xmath1 , the number of sites with above chosen spins are larger and therefore , the averages becomes more precise .",
    "this is an interesting point , since on the contrary to the wl , under the present approach @xmath7 becomes more precise by increasing @xmath1 .",
    "in the inset of each figure , we plot the dependence of the minimum @xmath117 on @xmath118 , where the straight line have linear coefficients @xmath119 and @xmath120 , which agrees very well with the exact value @xmath121 and @xmath122 .     versus @xmath91 for the @xmath93 potts model for @xmath123 ( top ) and @xmath115 ( bottom ) .",
    "symbols and continuous lines correspond to the estimates obtained from the present approach and wl , respectively . in the inset",
    ", we plot the dependence of the minimum @xmath117 versus @xmath118 , respectively .",
    "the straight line has linear coefficient @xmath119 . ]",
    "in this paper we have clarified the fundamental issue of a method proposed at ref .",
    "@xcite which uses a grand - canonical relationship for calculating microcanonical quantities .",
    "the study was carried out from the direct comparison with the standard definition of microcanonical temperature .",
    "a detailed analysis for three different lattice models yielding first and second - order phase transitions sizes was undertaken .",
    "our results show that although methods are not equivalent for extreme small system sizes , they converge for relative small @xmath1 s ( in practice , our definition becomes equivalent to @xmath95 for @xmath90 ) .",
    "not only the estimates for finite systems were found to be equivalent , but also the thermodynamic limit transition points .",
    "the further contribution exploited its advantages . besides the generality and easy implementation",
    ", thermodynamic quantities are precisely evaluated from rather short simulations .",
    "other advantages of the method concerns its low computational cost and not requiring a criterion for achieving convergence of results . once the equivalence has been verified in distinct situations , we believe that the present approach may offer a rather cheap method for simulating more complex systems , such as lattice models with continuous variables @xcite , spin - glasses and polymer systems @xcite",
    ". this will be the subject of ongoing work .",
    "we acknowledge m. g. e. da luz and mauricio girardi for critical readings of this manuscript and researcher grant from cnpq ."
  ],
  "abstract_text": [
    "<S> the development of reliable methods for estimating microcanonical averages constitutes an important issue in statistical mechanics . </S>",
    "<S> one possibility consists of calculating a given microcanonical quantity by means of typical relations in the grand - canonical ensemble . but given that distinct ensembles are equivalent only at the thermodynamic limit , a natural question is if finite size effects would prevent such procedure . in this work </S>",
    "<S> we investigate thoroughly this query in different systems yielding first and second order phase transitions . </S>",
    "<S> our study is carried out from the direct comparison with the thermodynamic relation @xmath0 , where the entropy is obtained from the density of states . </S>",
    "<S> a systematic analysis for finite sizes is undertaken . </S>",
    "<S> we find that , although results become inequivalent for extreme low system sizes , the equivalence holds true for rather small @xmath1 s . </S>",
    "<S> therefore direct , simple ( when compared with other well established approaches ) and very precise microcanonical quantities can be obtained from the proposed method .    </S>",
    "<S> pacs numbers : 05.10.ln , 05.20.gg , 05.50.+q </S>"
  ]
}