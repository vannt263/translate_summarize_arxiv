{
  "article_text": [
    "the first problem to be solved with the techniques of numerical astrophysics was the structure and evolution of stars  an `` implicit '' problem that involves a static or slowly - evolving structure ( @xcite ; @xcite ) .",
    "its solution consists of determining the state variables of the fluid ( density , temperature , pressure , flux of radiation , composition ) at each radius in the stellar interior , and is obtained by relaxing a large set of coupled nonlinear difference equations ( derived from the differential equations of stellar structure ) along with boundary conditions at the stellar center and surface .",
    "radial stellar structure is only a one - dimensional problem and , while once considered difficult and cpu - intensive , now is solved easily on personal computers ( pcs ) .",
    "since then , many other fields of numerical astrophysics have been developed : `` explicit '' hydrodynamic simulations of explosive and jet phenomena ( @xcite ) ; n - body and smooth particle hydrodynamics ( sph ) of discrete or semi - discrete systems of particles ( @xcite ; @xcite ) ; monte carlo simulations of radiation flow ( @xcite ; @xcite ) ; _ etc_.",
    "all have matured to the point where the solution of three - dimensional , time - dependent problems is not uncommon .",
    "ironically , however , only modest progress has been made in extending the original implicit problems into several dimensions : rapidly rotating stars , evolving and interacting binaries , detailed accretion disk structure and evolution , etc .",
    "there are several important reasons for this .",
    "firstly , the geometry of these systems is unknown until the problem is solved .",
    "for example , the shape of the outer surface of a rotating star or ( possibly thick and advective ) accretion disk will be part of the solution , and the shape of a rapidly rotating stellar core may have a different oblateness ( or even prolateness ) from that of the outer envelope .",
    "no numerical method capable of operating in nearly - arbitrary geometries has been applied extensively in astrophysics . instead ,",
    "one either has assumed spherical symmetry and treated only slowly - rotating , perturbation problems ( @xcite ) , or has assumed that the isosurfaces of the state variables are coincident ( which implies rotation on cylinders via von zeipel s theorem ) and again solved an essentially one - dimensional , or limited two - dimensional problem ( @xcite ; @xcite ) .",
    "recently , some progress for two- and three - dimensional stellar models has been made using a multi - domain approach and treating the stellar surface as a discontinuity ( @xcite ) .",
    "secondly , even if a general geometrical method applicable to large numbers of two - dimensional and three - dimensional problems could be developed , the current stellar structure methods for solving the immense system of simultaneous nonlinear equations would take a prohibitively long amount of cpu time and memory .",
    "for example , a relatively modest problem with @xmath0 grid points and ten state variables at each point would generate a banded matrix @xmath1 in size , taking up at least @xmath2 bytes ( 0.9 pb ) for the non - zero elements .",
    "direct inversion techniques , similar to the henyey method commonly used in stellar structure ( which take the bandedness into account ) , would take about a thousand years to invert this matrix once on a large parallel supercomputer like the cray t3d , with perhaps @xmath3 or more such inversions necessary for a complete stellar evolution model of the matrix times its length l and the time to invert is proportional to @xmath4 . ] .",
    "fortunately , there exist techniques for solving both of these problems that are well developed and have been in use in the engineering field for many years ( although it is still rare to see both used at the same time ) . the finite element method ( fem ) , introduced more than four decades ago and the preferred method of treating multidimensional structural engineering problems since the late 1960s ( @xcite ) , approximates objects as distorted lattices of small structural members called elements . for solving large systems of coupled equations generated by such grid problems ,",
    "the multigrid method was introduced in the 1970s ( @xcite ) and is now beginning to be used in astrophysics as well ( @xcite ; @xcite ) .",
    "this approach dispenses with the large matrix , cleverly reaching a solution after a few sweeps of the mesh .",
    "together , these techniques promise to make multidimensional astrophysical structural problems possible , and bring the time to solve them within an order of magnitude or so of that for explicit problems .",
    "when coupled with the continued expected increase in speed of computers over the next few decades ( which has averaged about a factor of 2 every 2 years for the past 20 years ) , it is not inconceivable that three - dimensional _ structure _ problems will soon be solved routinely on future models of pcs and that four - dimensional problems will become commonplace on supercomputers .",
    "this first paper deals with the development of the general geometrical method for solving multi - dimensional structure and evolution problems . at this stage",
    "the speed and efficiency of execution of the method will not be a concern ; the focus will be only on producing a robust and widely - applicable set of useful techniques .",
    "our goal will be to determine the essential features of most astrophysical systems of equations and the geometrical demands they place on the numerical method .",
    "these properties will then be encoded at the outset , ensuring some measure of generality .",
    "the second section describes the set of equations that can be addressed with nonlinear astrophysical finite element analysis and develops a method for solution on fixed ( non - moving ) grids . in section 3",
    ", this then is generalized to include situations where the positions of the grid points are part of the solution and the grid can change with time . finally , tests and examples are given , using the author s code , including rotating polytropic star models .",
    "this section describes the techniques used in the author s computer code , entitled genral , for solving general astrophysical problems .",
    "it utilizes the techniques of finite element analysis ( fea )  in use in the field of engineering for some time  but generalizes them to nonlinear equations in four dimensions , instead of linear equations in two or three dimensions . for this initial development",
    ", it is assumed that the coordinates of the grid points ( or `` nodes '' ) at which the variables are evaluated do not change while the solution is being computed .",
    "appendix a shows that the differential equations of continuum astrophysics in curved spacetime can be cast into the generic form @xmath5 where @xmath6^v = w^v$ ] is a generalized solution vector holding all of the @xmath7 unknown state variables ; @xmath8 is a generalized residual for each of the @xmath9 equations ( which will be forced to zero through numerical relaxation techniques ) ; @xmath10 and @xmath11 are , respectively , the generalized stress tensor and force vector for these equations ; and @xmath12 is the determinant of the metric tensor @xmath13 ( [ +++]-signature ) . ) and latin `` integer '' letters indicating three - space indices only ( @xmath14 ) .",
    "the comma denotes ordinary differentiation with respect to the coordinates , while a semicolon will denote covariant differentiation .",
    "repeated indices indicate summation over the entire range of those indices ( the einstein summation convention ) , so that @xmath15 a raised index indicates contravariant properties of the tensor and a lowered index indicates covariant properties .",
    "note that @xmath16 is written as a contravariant vector with a raised index , like the coordinates @xmath17 ; this is partly for convenience ( to facilitate the summation convention ) and partly to draw attention to the variables as generalized coordinates of the system . ] in a similar manner , the boundary conditions on these equations can be cast as @xmath18 _ { , \\mu }   { { \\cal{s}}^{\\mu}}_{\\beta } \\nonumber \\\\ & & \\ , + \\ , [ \\ , h_{r}({\\bm{s \\cdot \\nabla w}},~{\\bm{w}},~{\\bm{x } } ) \\",
    ", \\sqrt{-g } \\ , ] _ { , \\mu }   { { n}^{\\mu } } \\nonumber \\\\ & & \\ , - \\ , f_{r}({\\bm{\\nabla w}},~{\\bm{w}},~{\\bm{x } } ) \\ , \\sqrt{-g }   \\nonumber \\\\",
    "\\label { general_bc } & = & 0 \\end{aligned}\\ ] ] for each of the @xmath19 boundary conditions . in general , @xmath20 since , depending on the highest order derivative in @xmath21 , there may be 0 , 1 , or 2 associated boundary conditions . the last term in ( [ general_bc ] ) is adequate for handling dirichlet , neumann , and mixed boundary conditions , such as the radiative condition at a stellar or accretion disk surface .",
    "the first two terms are necessary for including constraints on field equations .",
    "is the projection tensor along the boundary @xmath22 and orthogonal to the boundary normal @xmath23 @xmath24 where @xmath25 , @xmath26 , and @xmath27 , `` @xmath28 '' is the outer ( dyadic ) product , and `` @xmath29 '' is the inner ( scalar ) product .",
    "causes the divergence in equation ( [ general_bc ] ) to be performed on the boundary only and the derivative normal to the boundary to be only first order in @xmath30 .",
    "an alternative form for ( [ general_bc ] ) is @xmath31 _ { , \\mu }   { { \\cal{s}}^{\\mu}}_{\\beta } \\\\ & & \\ , + \\ , [ \\ , { h'}^{\\mu}_{r}({\\bm{s \\cdot \\nabla w}},~{\\bm{w}},~{\\bm{x } } ) \\ , \\sqrt{-g } \\ , ] _ { , \\mu }   \\\\ & & \\ , - \\ , { f'}_{r}({\\bm{\\nabla w}},~{\\bm{w}},~{\\bm{x } } ) \\",
    ", \\sqrt{-g }   \\\\ & = & 0 \\end{aligned}\\ ] ] which also has no second derivatives in @xmath30 .",
    "it is important to note that equation ( [ general_eq ] ) includes not only structural and steady problems , but also evolving ones as well . for these cases ,",
    "in addition to having three spatial coordinates , the computational grid can extend into the fourth ( time ) dimension , possibly from the initial time step or hypersurface to the final one .",
    "while certainly increasing the computational and memory load on the computer , this approach will have distinct advantages over conventional approaches to initial - value problems .",
    "the boundary conditions are not necessarily completely described by equation ( [ general_bc ] ) . while it is well known that , _",
    "physically _ , the boundary of a boundary is zero ( @xmath32 ) , computationally one often introduces sub - boundaries by truncating the mesh or imposing symmetries on the problem .",
    "these conditions produce right - angle kinks in the boundary , where @xmath23 suddenly rotates by @xmath33 and the boundary conditions abruptly change .",
    "such boundary corners occur , _",
    "e.g. _ , where the @xmath34 initial hypersurface intersects the world line of a stellar surface or ( in the case of axisymmetry or plane symmetry ) where the stellar surface intersects the symmetry axis or plane .",
    "for example , when solving maxwell s evolutionary equations on the four - dimensional domain @xmath35 under such conditions , they will be bounded on the @xmath34 portion of @xmath22 by the initial value ( solenoidal and coulomb ) constraints ; these will be bounded further at an external stellar 2-surface @xmath36 ; and these may be bounded still further by the rotation axis or equatorial plane at edges @xmath37 . therefore",
    ", additional equations , similar to ( [ general_bc ] ) , with successive projection of the first two terms into the sub - boundaries of lower dimension , may be needed until one reaches the zero - dimensional @xmath38 ( endpoints of line segments ) where the conditions become simply @xmath39 in the examples in this paper all boundary conditions are of the simple form ( [ simple_bc ] ) , but in general astrophysical situations the form ( [ general_bc ] ) will be needed .",
    "formally , in the finite element method ( fem ) the computational domain @xmath35 is subdivided not into nodes , but into sub - domains ( @xmath40 ) called `` elements ''  similar to `` zones '' or `` cells '' in the finite difference method ( fdm ) .",
    "( nodes come later , and then only to facilitate the element process . )",
    "the elements are constructed in such a way that each function @xmath16 is continuous over the entire domain , but its derivatives are only piecewise continuous ; _",
    "i.e. _ , @xmath16 is continuously differentiable only within each element .",
    "the @xmath17 are treated in the same manner ; they also are continuous across element boundaries with no spatial `` gaps '' between elements .",
    "although a variety of generic element shapes can be used , the most common are triangular and quadrangular .",
    "of course , these assume higher - order shapes in three and four dimensions ( _ i.e. _ , equilateral triangles , tetrahedra , simplices [ hyper - tetrahedra ] ; squares , cubes , and hypercubes ) , but they still shall be referred to here as the triangular and quadrangular classes . in genral ,",
    "elements of the quadrangular type are used exclusively because of their convenience .",
    "the computational domain is filled with a topologically rectangular set of @xmath41 of these building blocks , where @xmath42 is the dimensionality of the problem , and @xmath43 is the number of elements along each mesh dimension @xmath44 . each element that borders the domain has one surface lying on the boundary that itself is an element of dimension @xmath45 .",
    "the total number of such boundary elements enclosing this rectangular mesh is a sum over the rectangular faces @xmath46        in the past , when developing a finite difference numerical simulation code , for example , it has been customary ( and considered necessary ) to write the differential equations in the same coordinate system described by the computational mesh .",
    "that is , if the mesh is spherical - polar , then the equations are written in spherical - polar coordinates , and so on .",
    "however , in the numerical method developed in this paper , this degeneracy is neither necessary nor desirable , as the _ mesh _ coordinate system is unknown until the problem is solved .    to allow for an arbitrary , unknown mesh , the differential equations will be written in a `` basic '' or `` real - space '' ( @xmath17 ) system which does not change as the calculation proceeds .",
    "the derivatives still will be computed in the mesh ( @xmath49 ) system , but , in order to use them in the differential equations , will then be transformed to the basic system @xmath53^v}_{\\alpha } \\ ; \\equiv \\ ; { w^v } _ { , \\alpha } \\ ; = \\ ;   { { \\cal{l}}^{\\alpha ' } } _ { \\alpha } { w^v } _ { , \\alpha ' } \\ ] ] using the isoparametric / lorentz transformation .",
    "the choice of coordinate system for the mesh is determined by how one lays out the elements in real space .",
    "that is , @xmath54 gives the metric coefficients in mesh space .",
    "however , one still needs to choose a system in which to write the differential equations ; but , since the computer will be doing all the curvilinear work for us , one can select a very simple basic system , keeping the coordinates as cartesian ( or as minkowskian ) as possible .",
    "for example , in axisymmetric problems , cylindrical coordinates will be used , not spherical - polar . for three - dimensional problems ,",
    "cartesian coordinates will be used , no matter how spherical the star or flattened the accretion disk .",
    "any curvilinear properties of the metric _ orthogonal _ to the computational domain will be embodied in the volume element @xmath55 , and curvilinear behavior _ within _ the domain will be handled by the isoparametric transformation .      as with all continuum numerical methods , the solution is expressed as a finite set of discrete values . in the fdm these are values of the solution at specified points ( nodes ) in space ; in spectral methods these are coefficients of basis or interpolation functions . in the fem , these discrete values are _ both _ nodal values _ and _ basis function coefficients .",
    "that is , _ the fem has properties of both finite difference and spectral methods_.    the finite element nodes are distributed within each element in such a way that the @xmath16 can be interpolated across the element in each dimension with at least linear accuracy or better . for quadrangular elements , the simplest approach is to fill each element box with a ( possibly hyper- ) cubic mesh of @xmath56 nodes per dimension @xmath44 , where @xmath57 is the order of interpolation in that dimension , and nodes are shared by adjacent elements at all the interfaces ( corners , edges , faces , and hyperfaces ) . for a problem of total number of dimensions @xmath58 ,",
    "the total number of nodes describing each _ element _ is , then , @xmath59 that is , for four - dimensional elements , @xmath60 for first - order ( linear ) interpolation , @xmath61 for second - order ( quadratic ) interpolation , and @xmath62 for third - order ( cubic ) interpolation  just within each element .",
    "the total number of nodes in the entire mesh is @xmath63 ( no sum on @xmath44 ) .",
    "the number of nodes _ on each element s boundary _ is the total minus those in the interior @xmath64 and for the entire mesh @xmath65    no matter what the value of @xmath57 , in these simple cases the basis functions in mesh space for a node @xmath66 within a given element @xmath67 are products of lagrange interpolation polynomials @xmath68 in each dimension @xmath44 @xmath69 where @xmath70 is the mesh coordinate value at node @xmath66 in element @xmath67 , @xmath71 is the contribution from that element to the basis or `` shape '' function for node @xmath66 , as measured in the mesh ( primed ) system .",
    "the range of the nodal indices in the entire mesh is @xmath72 , but the product in equation ( [ lagrange_shapes ] ) only runs over the nodes within element . the total basis function for node @xmath66 is , then , a sum over the element contributions @xmath73 ( which actually involves only those elements containing that node ) .",
    "note that each shape function attains unit value at its own node and zero at all other nodes in its associated elements ( and in the mesh as well ) @xmath74    often the body - centered nodes , and sometimes even face - centered nodes , are removed from the standard lagrangian elements elements to form the so - called `` serendipitous '' elements ( @xcite ) . in that case , if node @xmath75 is removed , then the basis functions are given by the normal lagrange shape function with the lagrange shape function for that missing node subtracted off @xmath76 with @xmath77 .",
    "most of the properties of lagrangian elements can be illustrated in one dimension .",
    "figure [ shapes_fig ] shows a simple 1-dimensional , 5-node mesh and its discretization in linear and quadratic elements .",
    "note that interior shape functions have continuous derivatives at their respective nodes , while shape functions on element boundaries have discontinuous derivatives .",
    "( the latter also involve more nodes as they are composed of shape function pieces from adjacent elements . ) the fem , therefore , can be considered to be a multi - domain spectral method with each of the thousands to millions of elements being a separate domain .    because the shape functions are continuous throughout @xmath35 , the solution @xmath78 and the coordinates @xmath79 are truly continuous functions of position in the mesh : @xmath80 like spectral methods but unlike the fdm where interpolation is only an _ ad hoc _ addition to the scheme . also , because a unique inverse relation @xmath81 exists , the variables have an implicit function of position in real space @xmath82      we now have a numerical procedure for computing the derivatives of the @xmath16 with respect to @xmath17 .",
    "first , the coordinate transformation matrix is formed @xmath83 and then inverted to obtain @xmath84 .",
    "then the derivatives of the variables are computed in mesh space @xmath85 and , finally , transformed to real space by the chain rule @xmath86    although not usually used in practice in the actual computer code , it is sometimes useful for analytic purposes to express the shape functions in real space coordinates and use them to interpolate the @xmath16 and compute their derivatives @xmath87 the real - space @xmath88 also have the normalized property at their respective nodes @xmath89 by comparing ( [ w_fns_real_space ] ) and ( [ w_ders_real_space ] ) with with ( [ w_fns_mesh_space ] ) and ( [ w_ders_mesh_space ] ) , one concludes that the real - space basis functions and their derivatives are @xmath90    with expressions for the @xmath16 and @xmath91 ( either in mesh or real space ) we now can calculate the residuals @xmath8 ( equation [ general_eq ] ) at _ any _ point in the domain @xmath35 and @xmath21 ( equation [ simple_bc ] ) at _ any _ point on the boundary @xmath22 , not just at the nodes .",
    "the next step in the development of the astrophysical fem is to construct a set of @xmath92 equations for the @xmath92 shape function coefficients ( @xmath93 ) that fully describe @xmath94 .",
    "this is accomplished by integrating the physical differential equations ( [ general_eq ] ) and/or boundary conditions ( [ simple_bc ] ) over a function @xmath95 which peaks near ( but not necessarily at ) node @xmath66 and falls to zero far from that node .",
    "this produces @xmath96 discrete nodal equations @xmath97 relaxation schemes in the code then attempt to force the nonlinear @xmath98 to zero . in principle , each @xmath98 is a function of _ all _ of the @xmath99 .",
    "however , in practice , because @xmath100 is peaked near node @xmath66 , @xmath98 involves only nodes local to @xmath66  in fact , only nodes in those elements containing node @xmath66 .",
    "the @xmath98 , therefore , are more similar to difference equations than to spectral equations and , when linearized , produce a banded rather than filled matrix .",
    "because @xmath8 can contain second derivatives , the integral in equation ( [ strong_form ] ) can not be performed uniquely for every node using only the interpolation within a single element .",
    "the standard solution to this problem , and the key step in the finite element process , is to integrate the weighted residual by parts to arrive at the so - called `` weak '' form @xmath101 where , in the mesh system , the volume scalar is @xmath102 the surface 1-form normal to the domain boundary is @xmath103 and @xmath104 is the flat - space levi - civita permutation tensor .",
    "_ in the weak form , all terms involve only first - order derivatives of the variables @xmath16 with respect to the nodal coordinates . _",
    "second order derivatives are generated by the @xmath105 term which , after integration , differences the flux @xmath106 on each side of each node in a manner similar to a finite volume scheme .",
    "note that , in order to generate the nodal equations in the interior of the domain , weights @xmath95 that vanish on the boundary always will be used .",
    "therefore , the first term in equation ( [ weak_form ] )  the boundary term  will always be zero .",
    "the weighted residual method can be derived in a number of ways . in early papers on finite element analysis ,",
    "only linear problems were addressed and the nodal equations were generated using a variational approach that maximizes the norm of the solution ( @xcite ) .",
    "this led to the form ( [ strong_form ] ) with the shape function itself as the weight @xmath107 this choice for @xmath100 is called the galerkin method and is especially useful for second - order equations . for example , for the simple poisson equation in one dimension ( @xmath108 ) , with quadratic elements and uniform node spacing @xmath109 , equation ( [ weak_form ] ) generates the following nodal equation at the _ central _ node @xmath66 of each element @xmath110 \\ ; = \\ ; 0\\ ] ] which is similar to the finite difference form @xmath111 .",
    "( somewhat more complex 4th order difference equations are generated for nodes on element boundaries . ) in general the galerkin weighted residual method generates derivatives similar to those expected in finite difference schemes ( although in general geometry ) , but scalars and source terms are weighted averages of nodes surrounding @xmath66 rather than evaluated exclusively at @xmath66 .",
    "an important property of the shape functions hints at a more fundamental interpretation of the weighted residual method that is not discussed usually in the engineering literature . as the element volume @xmath40 approaches zero , the shape functions become good approximations to the dirac delta function @xmath112 ( no sum on @xmath66 ) where @xmath113 is a scaling constant of order unity , but generally different for each node @xmath66 .",
    "therefore , with the galerkin method , the weights @xmath100 in equation ( [ strong_form ] ) are generalized approximations to @xmath114 which , when integrated over a _ differential equation _ , generate or `` pick out '' the corresponding _ difference equation _ near node @xmath66 .",
    "as the number of finite elements approaches infinity , the @xmath98 more closely approximate the complete set of @xmath8 defined at all points in @xmath35 .",
    "therefore , while originally derived for linear equations , the weighted residual method is valid for nonlinear problems as well .",
    "the lack of a single , universally - applicable weighting function @xmath95 is the main impediment against developing a truly general simulation code .",
    "one must always know the order of differential equation being integrated .",
    "for example , while the galerkin scheme works well for second - order equations , it has the same pitfalls for first - order equations and fluid flow as centered - differencing schemes have in the fdm : leapfrogging , in which important terms in the equations do not depend on variables at the node at which the integral ( [ weak_form ] ) is evaluated ( ( @xmath115 ) , and two - point oscillations near shocks .",
    "such problems can be addressed by using weighting functions other than the @xmath116 .",
    "these are called petrov - galerkin schemes ( @xcite ) . for odd - order equations , functions that shift the peak of the weight away from node @xmath66 reduce or eliminate many of these problems .",
    "this is the case for weights that are shape functions of twice the element interpolation order @xmath117 and for those that are distorted by the shape function derivative @xmath118 in the first case @xmath119 signifies a position in the mesh centered between nodes .",
    "the functions @xmath120 peak in between nodes and have almost the same effect as using a staggered grid does in the fdm .",
    "both @xmath120 and @xmath121 generate non - leapfrogging differences ( ( @xmath122 ) and are still generally second - order accurate ( or higher ) as the scalar source terms are evaluated at the same place as the derivatives",
    ".    an upwinding scheme can be generated by setting @xmath123 and integrating only the advective terms with this weight .",
    "however , this scheme has low order accuracy and is rather diffusive ( @xcite ) .",
    "better methods for handling shocks are the van leer scheme ( @xcite ) , in which one enforces monotonicity in the gradient of the flux of a conserved quantity , and higher order godonov schemes ( @xcite ; @xcite ) in which one applies the shock jump conditions within the element itself .",
    "upwinding schemes in the fem are a sub - field in themselves and are largely beyond the scope of this paper .",
    "not all of the nodal equations generated by ( [ weak_form ] ) are useful .",
    "for example , for each _ second _ order differential equation ( one where a given @xmath124 is a function of the gradient of at least one @xmath16 ) exactly @xmath125 of the nodal equations ( those integrated over shape functions peaking at boundary nodes on @xmath22 ) are meaningless or incomplete .",
    "this is due to the absence of elements _ beyond _ the boundary needed to complete the integrals . for _",
    "first_-order equations ( ones where @xmath124 is , at most , a function of @xmath78 and @xmath79 only ) those on only one portion of the boundary must be discarded ( _ e.g. _ , on one side or surface ) .",
    "these ignored nodal equations must be replaced by exactly the same number of boundary or initial conditions .",
    "these are generated in a weighted residual manner similar to that in equation ( [ strong_form ] ) except that the integral and weighting functions now are evaluated on the boundary @xmath126 where @xmath127 is the magnitude of the surface element @xmath128 and the nodes @xmath129 lie on @xmath22 .",
    "the number of equations , therefore , will remain equal to the number of unknowns , as is necessary for a well - posed problem .        in the fem the integrals in equations ( [ weak_form ] ) and ( [ boundary_strong_form ] ) often are performed numerically using gaussian integration ( @xcite ) , with all sampled points @xmath130 interior to element boundaries . in practice , the integrals are calculated piecewise , element by element , with each element s contribution to the various integrals summed accordingly . to accomplish this , one defines a _ local _ mesh coordinate system , referenced to the element center and parallel to the global @xmath49 system @xmath131 where @xmath132 is the position in mesh space of element @xmath67 s center , @xmath133 is the element width in direction @xmath49 , and double primes refer to the local element system .",
    "the lagrangian shape functions within each element take on a very simple form in this local system . for linear interpolation in one dimension ( with nodes lying at @xmath134 and @xmath135 ) @xmath136 for quadratic interpolation",
    "( with element nodes lying at @xmath137 ) @xmath138 and so on for higher order interpolation .",
    "( equations [ [ linear_shape ] ] and [ [ quadratic_shape ] ] are the functions depicted in figure [ shapes_fig ] . )",
    "higher dimensional element shape functions are products of these in a manner similar to equations ( [ lagrange_shapes ] ) for lagrangian elements and ( [ serendip_shapes ] ) for serendipitous elements .",
    "equation ( [ weak_form ] ) then becomes , dropping the first term , as discussed earlier , and summing over elements and gaussian integration points , @xmath139 \\delta \\omega_{e}\\ ] ] where @xmath140 is the element volume in the real - space coordinate system , @xmath141 is the element number in the mesh , @xmath142 is the number of the gaussian integration point within element @xmath67 , and @xmath143 is the gaussian weight at that point .",
    "similarly , equation ( [ boundary_strong_form ] ) becomes @xmath144 where @xmath145 is the boundary element number , @xmath146 is the surface 1-form on the @xmath44 boundaries , and @xmath147 is one of @xmath148 , @xmath149 , _ etc .",
    "_ , depending on the boundary .",
    "because the residual weights @xmath150 $ ] , their derivatives , and the gaussian weights @xmath143 are the same for all elements , they can be precomputed and stored prior to beginning the relaxation of the solution .",
    "the only quantities necessary to compute during the relaxation are the @xmath106 and @xmath11 at each @xmath151 interior integration point and the @xmath152 at each @xmath153 boundary integration point .",
    "historically , the number of integration points @xmath154 used in each element is a function of the expected nonlinearity of the product @xmath155 with respect to position @xmath79 . in engineering",
    ", this is usually of low order ( linear or quadratic ) , but in astrophysics this product can vary with exponential order or higher . nevertheless , in practice",
    ", even with highly nonlinear functions , the author has had quite satisfactory results using the same number of integration points as nodes in each dimension ( i.e. , @xmath156 ) .",
    "fewer than this ( `` underintegration '' ) reduces the order of accuracy or even can produce a singular matrix .",
    "more than this ( `` overintegration '' ) does little to improve accuracy ( of order unity improvements only ) at great computational expense .      for solving the @xmath92 nodal equations and boundary conditions , the author currently uses a standard multivariate newton - raphson technique , sometimes called the `` henyey '' method in astrophysics ( @xcite ; @xcite ) .",
    "the @xmath98 are linearized by expanding in a taylor series about the solution @xmath99 , resulting in a matrix inversion problem @xmath157 } \\ ,",
    "\\delta { w^v_{\\jnode}}^{[n ] } \\ ; = \\ ; - \\im_{q \\inode}^{[n]}\\ ] ] ( no sum on the iteration number @xmath158 $ ] ) to solve for the corrections @xmath159}$ ] which need to be applied to the current guess to obtain a new [ @xmath160st ] approximation to the solution @xmath161 } \\ ; \\approx \\ ; { w^v_{\\jnode}}^{[n ] } \\ , + \\ , \\delta   { w^v_{\\jnode}}^{[n]}\\ ] ] in the engineering fem @xmath162 is called the `` tangent stiffness '' matrix .",
    "it has a length @xmath92 on a side and bandwidth @xmath163 . at present genral uses _ direct _ methods ( gaussian elimination with lower - upper decomposition ) to solve equation ( [ newton_raphson1 ] ) , repeatedly applying the corrections until the norm over all @xmath164 and @xmath165 @xmath166 } /   { w^v_{\\jnode}}^{[n+1 ] } \\|\\ ] ] falls below a certain tolerance .",
    "the tangent stiffness matrix need not be extremely accurate .",
    "indeed , when @xmath167 , the matrix need not be recomputed at all , with little impact on the rate of convergence and no impact on the accuracy of the solution . furthermore , the elements of the stiffness matrix in equation ( [ newton_raphson1 ] ) can be calculated using numerical differentiation , rather than writing out explicitly the partial derivatives of each equation with respect to each variable .",
    "this eliminates the need to know the geometry of the mesh beforehand  a feature important for multidimensional astrophysical structures .",
    "numerical differentiation of @xmath162 is not necessarily more expensive than algebraic differentiation , especially if the the baseline residual integrals @xmath168}$ ] are calculated only once for each matrix , and those partial derivatives known to be identically zero are not computed .",
    "it is quite common for an astrophysical state variable  _",
    "e.g. _ , the density @xmath169  to vary by many orders of magnitude over @xmath35 .",
    "therefore , in order to maintain the same relative accuracy over the domain , it may be necessary to solve for a much more slowly varying function , _",
    "e.g. _ , @xmath170 .",
    "in addition , for variables that can be positive or negative ( like velocity ) one may need a more complex function and its inverse @xmath171 where @xmath172 and @xmath173 is a fixed scaling value for @xmath164 .",
    "these `` scaled logarithmic variables '' are linear for @xmath174 and logarithmic for @xmath175 and can be negative or positive .",
    "unfortunately , there is some loss of convenience and intuition in re - writing the equations in terms of these new , modified variables , especially if there are many of this nature .",
    "therefore , the following procedure has been devised in order that the differential equations still can be coded in their basic form ( _ i.e. _ , using @xmath169 and @xmath164 ) while maintaining the accuracy of solving for @xmath176 and @xmath177 :    1 .",
    "each variable is flagged as being linear , logarithmic , or scaled logarithmic , and then stored as @xmath178 2 .",
    "partial derivatives of the integrals in equation ( [ newton_raphson1 ] ) are calculated with respect to @xmath179 . however ,",
    "when computing the functions @xmath106 , @xmath11 , and @xmath152 , the stored variables and their gradients are re - exponentiated to their unmodified forms with @xmath180 and @xmath181    with this scheme one can choose a variable to be logarithmic or not at runtime , or even switch its character during execution , without modifying the code .",
    "lower - upper decomposition techniques work well only when the matrix elements on the diagonal are decidedly non - zero .",
    "that is , one must identify which equation @xmath98 is `` for '' which variable @xmath99 .",
    "the term _ pivoting _ refers to the exchange of rows and/or columns in the matrix to ensure that all elements on the diagonal are indeed large  _",
    "i.e. _ , that the trace of the stiffness matrix is a maximum .",
    "_ local _ , or partial , pivoting ensures that , at a given node , the correct physical equation is paired with the correct variable . for example , in mhd computations , when the electrical conductivity is infinite , the current @xmath182is determined by maxwell s equations , not ohm s law . or , in a hydrostatic star the momentum equation determines the pressure structure , while velocity is determined by energy or particle conservation . in the standard partial pivoting algorithm one",
    "searches a matrix column for the largest element and switches the row of that element with the one presently on that column s diagonal ( @xcite ) .",
    "when applied at a single node , this algorithm is very successful in automatically pairing equations and variables .",
    "that is , the solution will be able to evolve from a dynamic state to a hydrostatic one without re - casting the equations or writing a new simulation code .    _",
    "global _ pivoting ensures that an equation @xmath98 ( integrated near node @xmath66 ) is applied at the correct node @xmath165 .",
    "this is a more difficult task than local pivoting and is not easily automated in our case .",
    "the correct identification is _ not _ always @xmath183 , especially for first - order equations , for which the answer is determined by where the boundary conditions are applied .",
    "fortunately , the global pivot of the matrix is a property that usually does not evolve with the simulation ; it need be determined only once .",
    "therefore , an elaborate pre - pivoting scheme has been devised for genral , in which , based only on the equation order and location of boundary conditions , shape function coefficients are identified with nodal equations , useless nodal equations are discarded , and boundary conditions are inserted .",
    "local pivoting can still shift emphasis for a given variable from one differential equation to another , but the overall global identification of integrals ( [ weak_form ] ) with nodes remains fixed .",
    "in most multi - dimensional astrophysics problems , the grid chosen initially will not be a good match for the final structure , due to a poor fit to the object boundary or poor resolution in areas of rapid gradients .",
    "therefore , the coordinates and/or quantity of nodes should be changed as the solution converges in order to get a better fit ( `` adaption '' ) .",
    "in addition , one needs to allow for the mesh at one time step to be different from that at the previous time step ( grid motion ) .",
    "adaptive gridding , as used here , means modifying the mesh spacing in order to achieve greater accuracy or stability _ without changing the total number of nodes or the topology of the mesh_. one - dimensional stellar structure models use a form of adaptive gridding as they utilize a mass coordinate rather than radius , allowing the radius of each mass zone , including the outer stellar radius , to expand or contract depending on the current state of the star .",
    "our general multidimensional adaptive gridding scheme takes the same form as equation ( [ general_eq ] ) except that it is written in mesh space @xmath184 where @xmath185 is the adaptive gridding tensor .",
    "currently the author is using a diagonal form @xmath186\\ ] ] which ties the mesh spacing to the local gradient of the state variables .",
    "note the sum over @xmath187 variables ; @xmath188 is a vector of 1 s and 0 s that , at run time , selects those state variables to which the grid should be adapted , @xmath189 is a unit vector in spacetime along the local mesh direction @xmath49 @xmath190^{\\alpha } = \\frac{{{\\cal{l}}^{\\alpha}}_{\\alpha ' } } { |g_{\\mu \\nu}{{\\cal{l}}^{\\mu}}_{\\alpha ' } \\ , { { \\cal{l}}^{\\nu}}_{\\alpha ' } |^{1/2 } } \\ ] ] ( no sum on @xmath44 ) , @xmath191 is the average change in @xmath16 along the mesh direction @xmath49 ( determined from the current solution for @xmath16 ) , @xmath192 is a measure of the local linear mesh spacing along an element edge @xmath193 ( again , no sum on @xmath44 ) , and @xmath194 is a constant that regulates the strength of the gradient term . equations ( [ adapt1 ] ) provide four constraints on the nodal coordinate values , allowing the mesh spacing along @xmath49 to decrease in regions of high gradients in the variables , but to be uniform otherwise .",
    "note that the adaptive gridding equations are not the coordinate conditions needed to complete the description of the metric ( see appendix a ) .",
    "they simply move nodal positions around in an already - determined metric .",
    "@xmath195 is a very small constant ( @xmath196 ) , such that in the absence of adaptive gridding ( _ i.e. _ , all @xmath197 ) and with the proper boundary conditions , the mesh will assume an appropriate curvilinear character with uniform spacing @xmath192 in each @xmath49 .      adapting the grid to local conditions changes the spatial and time coordinates of the nodes .",
    "for an observer traveling along @xmath198 this produces what appears to be motion of the grid through space .",
    "now , computational fluid dynamics on stationary , uniformly - spaced meshes is a fairly complex field in itself . on",
    "arbitrarily - spaced and moving grids the resulting mixed lagrangian - eulerian hydrodynamic equations might seem intractable .",
    "however , with the fem the exact opposite is true . _",
    "if the elements have an extent in time as well as in space , then the inverse isoparametric transformation will automatically take into account the complicated effects of differencing the fluid equations with respect to a moving grid .",
    "_ it is unnecessary , and indeed incorrect , to attempt to include the grid velocity in the differential equations .    as an example , consider the non - relativistic total advective derivative in flat spacetime @xmath199 where @xmath200 is the three - velocity of fluid flow .",
    "now , let @xmath201 be a grid three - velocity such that @xmath202 remains parallel to @xmath203 , although @xmath204 can make an angle ( @xmath205 ( no sum on @xmath206 or @xmath207 ) . substituting equation ( [ isoparm_inv ] ) into ( [ advect_der ] ) one obtains @xmath208 the first term in equation ( [ moving_advect_der ] ) is the apparent time derivative ( along @xmath198 ) at a given node in the grid frame while the second is simply the moving advective derivative @xmath209 .",
    "thus the isoparametric transform reproduces the lagrangian - eulerian equations of leblanc & wilson under the same conditions .",
    "the purpose of adaptive mesh refinement ( amr ) is similar to that of adaptive gridding : to increase resolution in a local region of the mesh .",
    "however , in the case of amr the numbers of elements and nodes usually increase as the calculation proceeds .",
    "when the element mesh extends into the time dimension , amr makes it possible to treat efficiently the propagation of particularly important wave phenomena . rather than subdivide the entire domain finely",
    ", one does so only for the region of spacetime near the null geodesics along which the phenomenon propagates .",
    "the courant condition ( appendix b ) prescribes one form of amr , as it places an upper limit on the temporal mesh spacing and , therefore , a lower limit on the number of elements necessary to solve a problem .",
    "if the courant condition is not satisfied in a local region , the number of elements in @xmath198 will have to be increased .    in the fem amr",
    "can be achieved by subdividing some of the elements , usually by a power of two in a given dimension , and then rebuilding the interpolation grid of nodes within the newly - gridded subdomain .",
    "there are two matters of concern in this case : 1 ) the subdivision must be done by elements , not nodes , regardless of the final order of the interpolation grid used within each element , and 2 ) larger elements bounding the more finely subdivided region must have their internal interpolation scheme , and hence their nodal shape functions , modified by the addition of new boundary nodes .",
    "that is , these modified elements must be serendipitous elements .",
    "this ensures that the functions @xmath210 and @xmath211 are continuous across element boundaries and that there are no spatial gaps or `` hanging nodes '' .",
    "this second requirement can significantly increase the complexity of the mesh and the number of element types for which quantities need to be pre - computed and stored .",
    "recently , however , the astrophysical community has been embracing an alternative , multi-_level _ approach to amr ( @xcite ; @xcite ) .",
    "a region of space is refined not by subdividing the grid cells themselves , but by applying separate , and successively more refined , grids at the same location and with some nodes in common between each level .",
    "this hierarchical approach eliminates the hanging node problem without resorting to defining many new serendipitous element types : each grid level is subdivided with standard linear or quadratic elements .",
    "this technique also fits naturally into a multigrid iterative scheme for solving the coupled nodal equations .",
    "below are presented some tests of the code genral on problems with known solutions . at the present time the code uses the multi - dimensional henyey technique to solve the difference equations it generates . as discussed earlier , this approach has severe computer time and memory limitations",
    ". therefore , all the examples involve a much smaller number of elements than the millions that one would use in a typical astrophysical simulation .",
    "( generally , the full code running on a desktop workstation is limited to 4096 elements or 6561 nodes total [ @xmath212 , @xmath213 , or @xmath214 linear elements or @xmath215 , @xmath216 , or @xmath217 quadratic elements ] ) .",
    "nevertheless , the tests serve to demonstrate the unique features of the fem , including its ability to solve nonlinear astrophysics - like problems in multidimensional , arbitrary curvilinear coordinate systems and to achieve high accuracy in the solution by employing higher order interpolation , adaptive gridding , and logarithmic variables .",
    "the first tests of the method involve no differential equations . instead , the integrands in equations ( [ gaussian_integ ] ) and ( [ boundary_integ ] ) are set to unity so that only domain volume and surface area are computed .",
    "the results are then compared with known solutions for various shapes ( rectangular hyper - solids , hyper - spheres , and ellipsoids ) , different element interpolation schemes ( linear [ @xmath218 and quadratic [ @xmath219 ) , different numbers of elements @xmath220 in each dimension ( 1,2,4,8,16 ) , and different numbers of integration points @xmath154 ( @xmath221 and @xmath222 ) .",
    "this procedure is more than simply a verification that the numerical integrations work .",
    "it also exercises the coordinate transformations and the ability to form proper volume and surface elements in fairly arbitrary curvilinear situations .",
    "table 1 summarizes the results , normalizing to grids with nine nodes in each dimension . in this case",
    "( but , unfortunately , _ not _ for the differential equation tests below ) both choices for @xmath154 produce the same results : for linear elements the error @xmath223 varies as @xmath224 , while quadratic elements produce fourth - order errors ( @xmath225 ) .",
    "results for surface area integration are similar , although the actual fractional error is about a factor of two smaller .",
    "results for other ellipsoidal objects are also similar .",
    "ccc & & + & & +   +   +   +   +   @xmath58   & linear & quadratic + & & +   2   & @xmath226 & @xmath227 +   3   & @xmath228 & @xmath229 +   4   & @xmath230 & @xmath231 +    cccc & & & + & & & +   +   +   +   +   @xmath232 & @xmath58 & linear & quadratic + & & & +   1 & 1 & & +   1 & 2 & @xmath233 & @xmath234 +   1 & 3 & @xmath235 & @xmath236 +   1 & 4 & @xmath237 & @xmath238 + & & & +   2 & 1 & @xmath239 & +   2 & 2 & @xmath240 & +   2 & 3 & @xmath241 & +   2 & 4 & @xmath242 & + & & & +   3 & 1 & @xmath243 & @xmath234 +   3 & 2 & @xmath244 & @xmath245 +   3 & 3 & @xmath246 & @xmath236 +   3 & 4 & @xmath247 & @xmath248 + & & & +   4 & 1 & @xmath249 & @xmath250 +   4 & 2 & @xmath251 & @xmath252 +   4 & 3 & @xmath253 & @xmath254 +   4 & 4 & @xmath255 & @xmath256 +      the second set of tests involves solving a differential equation in up to four dimensions , but on a regular cartesian ( not minkowskian ) grid of dimension @xmath58 .",
    "the equation used is poisson s equation @xmath257 with a known solution @xmath258 where @xmath259 is the radial distance from the origin and @xmath260 .",
    "the components of the generalized equation ( [ general_eq ] ) are then @xmath261 with dirichlet conditions on the entire boundary @xmath262^n\\ ] ] where @xmath263 is the expression for @xmath264 evaluated on the boundary",
    ". this test exercises the code s ability to solve equations ( [ gaussian_integ ] ) and ( [ boundary_integ ] ) , but does not test the coordinate transformations .",
    "results of the fixed grid tests are given in table 2 , which shows how the accuracy of the solution in different dimensions , determined by the normalized `` l2 '' error norm @xmath265^{1/2 } } { \\left [ \\int_{\\omega } w_0 ^ 2 \\ , d \\omega \\right ] ^{1/2}}\\ ] ] varies with number of nodes and elements used .",
    "two differences from the volume and surface area integration tests are worth noting .",
    "firstly , the solution errors for quadratic elements are third - order accurate ( @xmath266 ) , not fourth - order .",
    "secondly , underintegration ( @xmath267 ) does not work .",
    "_ @xmath154 always must be equal to or greater than @xmath222 _ ( _ i.e. _ , @xmath268 for linear elements and @xmath269 for quadratic elements ) in order to generate the proper second - order differences in the laplacian .",
    "underintegration , at best , reduces the accuracy of the solution by one order .",
    "at worst , it destroys nearest neighbor differencing , producing leap - frogged differences , and can lead to no solution at all .",
    "`` iso - integration '' ( @xmath270 ) is probably sufficient for any equation of the form ( [ general_eq ] ) , but it should be checked in each circumstance to be certain .",
    "the third set of tests exercises nearly all the features of the code in order to obtain a solution to a rather pathological poisson problem  a fermi - dirac - like function @xmath271 with a cold temperature of 1/f = 0.02 .",
    "such sudden exponential drops in the solution are common at stellar core - halo boundaries or stellar surfaces and are difficult to resolve accurately without a large number of nodes or a variable change ( to optical depth , for example ) . for this demonstration",
    "the conservative form for the stress and force terms ( in up to four cartesian dimensions ) has been chosen @xmath272 } \\\\",
    "\\label { adaptive_force } f & = & 0\\end{aligned}\\ ] ] ( no sum on @xmath206 ) where @xmath273 are constants and @xmath274 ( for example , in one dimension , @xmath275 ; in two dimensions , @xmath276 ; and so on . ) and , as one is still interested at this stage in testing the fem machinery and not the astrophysical viability of the code , once again simple dirichlet boundary conditions are employed , so equation ( [ simple_bc ] ) becomes @xmath277 \\",
    ", + \\ , 1 } \\ ] ] rather than , for example , a multipole expansion of the interior solution .",
    "the above conservative form ( [ adaptive_stress ] - [ adaptive_force ] ) was chosen in favor of other forms ( such as [ simple_stress ] - [ simple_force ] ) because its solutions are particularly accurate for a small number of nodes and suitable for demonstrating adaptive gridding and the use of logarithmic variables .",
    "figure [ 1dpoisson_fig ] shows the solution of this poisson problem in one dimension as one applies successively more features of the code .",
    "the top panels of figures [ 1dpoisson_fig ] show standard fixed , equally - space grids of 8 and 16 linear elements respectively .",
    "some improvement in accuracy can be obtained by doubling the resolution , but this incurs additional storage and computational expense . turning on the adaptive gridding equations ( [ adapt1 ] ) , however ( middle panels ) ,",
    "significantly improves accuracy for the same number of elements .",
    "this also demonstrates one aspect of the ispoarametric transformation : variable node spacing .",
    "a closer examination of this more accurate solution , however ( figure [ 1dpoisson_fig ] , bottom left ) , shows very large relative errors in the log when @xmath278 .",
    "nevertheless , these can be overcome easily , without re - writing and re - coding the equations , as the bottom right panel of figure [ 1dpoisson_fig ] shows .",
    "when @xmath279 is identified as a logarithmic variable , rather than linear , the solution remains accurate over eleven orders of magnitude .",
    "( note the different node spacing in the bottom panels , with the grid adapting to @xmath279 on the left and @xmath280 [ @xmath281 on the right . )",
    "figure [ 2dpoisson_fig ] shows a similar development for a two - dimensional poisson problem where the fermi - dirac surface has an elliptical ratio of 2:1 ( @xmath282 ) .",
    "the first three panels demonstrate the errors possible in locating the surface if the proper coordinate geometry is not used .",
    "additional improvement in accuracy can be obtained by using adaptive gridding ( middle right panel ) .",
    "however , this solution for @xmath283 suffers the same oscillatory errors seen in the one - dimensional case ( bottom left ) , which again can be eliminated by identifying @xmath279 as logarithmic ( bottom right ) .",
    "it is important to note that , in all of the solutions displayed in figures [ 1dpoisson_fig ] and [ 2dpoisson_fig ] , _ no explicit curvilinear coordinate system is used_. the coordinates of the grid points ( whether fixed or part of an adaptive gridding solution ) are stored only as @xmath284 and @xmath285 , not as @xmath286 and @xmath287 , for example , and yet are still fully arbitrary ( subject to the jacobi condition ) .",
    "the poisson equation is written only in terms of @xmath288 and @xmath289 as well .",
    "of course , the derivatives are still calculated using the coordinate grids shown , but then they are immediately transformed to @xmath290-space using the transformations ( [ isoparm_general ] ) and ( [ isoparm_general_inv ] ) .",
    "thus , with these new techniques the grid can be moved around to obtain a more accurate solution while the physical equations remain coded in the same very simple form .",
    "the fermi - dirac poisson tests were used to determine a good value for the adaptive gridding constant in equation ( [ adapt2 ] ) .",
    "several dozen models like those in figures [ 1dpoisson_fig ] and 3 were computed for different values this parameter .",
    "it was found that the accuracy improved by factors of @xmath291 as @xmath292 was increased from @xmath293 to @xmath294 , but beyond this point the accuracy did not improve much .",
    "in fact , for values much greater than @xmath294 , the models became unstable , often not converging .",
    "therefore , @xmath295 was chosen as a semi - universal value in the adaptive gridding equation .",
    "it has proven to be useful both in the fermi - dirac tests in figures [ 1dpoisson_fig ] and [ 2dpoisson_fig ] and in the stellar structure models below .",
    "one important point about adaptive gridding should be mentioned .",
    "as currently implemented , the technique is rather volatile and unstable .",
    "unless great care is taken , iterations with adaptive grids often diverge , violating the jacobi condition in the process . in the case",
    "solution to a steady state problem is sought , sometimes less cpu time cost will be incurred by subdividing the mesh more finely or using quadratic elements , rather than using adaptive gridding techniques . on the other hand ,",
    "when many thousands of successive models are to be computed , as is the case for evolutionary problems , each newly - converged model will be a good initial approximation to the next evolutionary state , yielding convergence for each time step in only a few iterations . in this case , the amount of time spent converging the first adaptively - gridded model will be a small cost compared to the cpu time adaptive gridding saves over the course of the evolution by using a smaller number of elements and nodes to obtain the same high level of accuracy .      the fourth series of tests adds the ability to solve a _ coupled _ set of both first- and second - order partial differential equations .",
    "it also demonstrates the use of @xmath55 to solve a problem in which the _ basic _ coordinate system ( not just the grid ) is curvilinear , due to the assumption of symmetry conditions involving a coordinate direction orthogonal to the computational domain .      in one dimension",
    "the equations for polytropic stellar structure are hydrostatic equilibrium ( euler s equation with zero velocity ) , poisson s equation for gravity , and the polytropic equation of state @xmath296 pressure @xmath297 and density @xmath169 are unity at the stellar center and zero at its surface , and @xmath264 is the spherical radius coordinate .",
    "the polytropic index @xmath232 is a measure of the hardness of the equation of state ; the factor @xmath298 in the hydrostatic equilibrium ( hse ) equation is a normalization constant for the gravitational potential @xmath279 .    in semi - analytic treatments ,",
    "the hydrostatic equilibrium equation is multiplied by @xmath299 , differentiated with respect to the radius @xmath264 , and combined with poisson s equation to give a single second - order equation . following this procedure here ,",
    "however , tests only our ability to solve that simple equation and not much else . a slightly stronger test of the method would be to leave the system as a set of coupled equations and identify @xmath300 with boundary conditions at @xmath301 of @xmath302 and @xmath303 .",
    "note the need for a non - unit volume element of @xmath304 in order to form the proper divergence .",
    "a basic curvilinear coordinate system must be used because of the spherical symmetry assumed in directions orthogonal to @xmath305 .",
    "unfortunately , the above approach is still unsatisfactory , because it cleverly casts hse as a second - order equation , avoiding the first - order equation problems discussed earlier .",
    "also , as shown below , it does not lend itself to generalization to two or more dimensions . to address these issues ,",
    "the following alternate identification of the stress and force terms for the pressure equation has been chosen @xmath306 which casts hse as a first - order equation ( with only the boundary condition @xmath302 at @xmath307 ) .",
    "boundary conditions on the potential @xmath279 are @xmath308 at the stellar center and @xmath309 at the stellar surface .",
    "in addition , the condition @xmath310 is applied at the surface on the adaptive gridding equation to determine the stellar radius .",
    "figure [ 1dsph_poly_fig ] shows an @xmath311 polytrope in one dimension , which has the analytic solution @xmath312 the left panel uses only the galerkin method , while the right two panels show the solution using the petrov - galerkin scheme in equation ( [ petrov_galerkin2 ] ) to integrate the hse equation .",
    "the need to treat first - order equations differently from second - order ones is clearly evident .",
    "the leapfrogging first - order differences produced by the galerkin method not only display point - to - point oscillations , they also miss an implicit boundary condition ( @xmath313 at @xmath301 , implied by @xmath308 and equation [ oned_poly_p_f ] ) .",
    "the petrov - galerkin scheme improves the accuracy considerably , and with adaptive gridding remains roughly second order accurate for linear elements and third order for quadratic .    at the present time",
    "no robust , automated method for determining the order of the differential equation has been developed .",
    "the code must be told explicitly not only the order of each equation but also the location(s ) of the boundary conditions . while this is the greatest obstacle to producing a truly general continuum simulation code to solve all types of equations , it is a relatively modest amount of effort compared with writing a new code for each problem .",
    "one possible solution is to form a single second - order equation by taking the divergence of the hse equation , similar to the standard semi - analytic approach .",
    "however , while it works fine in one dimension , this approach is unstable to two - dimensional perturbations when both the dirichlet and neumann boundary conditions are applied on the same ( @xmath301 ) surface , leaving the stellar surface free .",
    "setting @xmath321 at the surface does not help either ; in this case the mesh must become adaptive , and this constraint must be used as a boundary condition on the adaptive gridding equations , not on hse . moving",
    "the neumann condition to the stellar surface is a better approach , but difficult to apply for more complex problems ( _ e.g. _ , rotating polytropes ) .        as implemented in the author s code , the speed of the integral outer boundary condition technique was significantly slower than the exterior multipole expansion , increasing the time to form the stiffness matrix ( although not affecting the time to invert it ) by factors of several . while the author made no attempt to optimize the implementation , even after such efforts it nevertheless should remain somewhat expensive , as it requires ( for each non - zero stiffness matrix element and each right - hand - side vector element ) the complete integration of the potential ( equation [ integral_bc ] ) at 4 - 6 surface points , each integration being the equivalent of of a multipole moment computation .",
    "however , while the multipole expansion began to break down for modest rotation speeds , the integral technique converged with no problem for all rotation speeds up to breakup , making the extra computational effort worthwhile and necessary .",
    "in addition , as the integrals are done only for surface points , this hybrid technique ( differential equation with integral boundary conditions ) still will be much cheaper than computing the global potential by performing such an integral for every point in the _",
    "domain_.    figure [ 2dsph_poly9_fig ] shows two dimensional @xmath311 non - rotating polytropes for the two element classes each with @xmath353 nodes  the analog of the middle and right panels of figure [ 1dsph_poly_fig ]  using the multipole boundary condition .",
    "note especially the variable grid spacing near the stellar surface and the difference in smoothness between linear and quadratic interpolation .",
    "figure [ 2dsph_poly33_fig ] shows the same models for the @xmath350 node cases .",
    "note especially the departure from sphericity in the pressure contours in the models employing linear elements that is absent in the quadratic element cases ; the @xmath353 quadratic model is more accurate than the @xmath350 linear model .",
    "however , errors in the two cases scale only as @xmath354 which is one full order less accurate than expected",
    ". this may be due to the _ reflective _ boundary conditions along the axis and equator , which are only first and second order accurate , respectively , in the linear and quadratic cases .",
    "the nature of this boundary condition can not be improved at this time , but will be once iterative / multigrid methods for solving the coupled equations are implemented .",
    "this will allow boundary `` ghost '' elements to be handled easily , allowing application of boundary conditions as accurate as the mesh interior .    the maclaurin spheroid sequence ( a series of @xmath355 , uniform density polytropes ) provides a full two - dimensional test of the method .",
    "( note that the method takes no advantage of the uniform rotation , uniform density , or polytropicity , so the ability of the code to solve the maclaurin problem is a good indication of how it will do on general multidimensional stellar structure and other more complex problems . )",
    "the appearance of maclaurin spheroids is similar to that of the @xmath311 polytropes in figure [ 2dsph_poly9_fig ] and 6 , but the logarithm of the pressure varies little with radius except near the surface , where the radial grid spacing decreases dramatically due to the sudden pressure drop . for this reason it is sufficient to use a larger pressure boundary value ( @xmath356 rather than @xmath357 ) in order to determine the locus of the maclaurin spheroid surface .",
    "figure [ 2drot_poly33_fig ] shows the analogy of figure [ 2dsph_poly33_fig ] for a maclaurin spheroid with @xmath358  very near the theoretical limit of @xmath359 ( @xcite ) . the integral boundary condition ( [ integral_bc ] )",
    "is used to compute the surface potential .",
    "the complete maclaurin series from @xmath360 to @xmath361 was computed in four different ways , using @xmath353 and @xmath362 nodes for the two classes of elements ( linear and quadratic ) .",
    "values of @xmath363 , the rotational flattening ratio of the semi - minor and semi - major axes @xmath364 , and total angular momentum @xmath365 have been computed from these models and are compared in figure [ 2drot_poly17_plots ] with analytic curves from @xcite and @xcite .",
    "the fractional errors for the four series are shown in figure [ 2drot_poly17_errs ] .",
    "the models are quite accurate for such a small number of elements , with errors in the @xmath366 to @xmath357 range in the @xmath362 quadratic case .",
    "they show the expected result that third order interpolation is significantly more accurate than second order , but the decrease in the errors with increasing numbers of elements is not as steep as expected .",
    "most of this behavior is probably due to the less accurate reflective boundary conditions mentioned earlier .",
    "this paper has developed a general method for solving multidimensional structural , and dynamical , problems of astrophysics .",
    "virtually all situations involving continuous media are potentially addressable  in normal flat cartesian space or in curved spacetime .",
    "problems in this area include , but are not limited to , the full structure and secular evolution of viscous , rotating ( and even magnetized ) stars and accretion disks in two and three dimensions , interacting binaries , asymmetric stellar envelopes and winds , non - radial pulsating stars , nonlinear development of secular and thermal accretion disk instabilities , and stationary or evolving spacetimes .",
    "while this method is most useful for structures that evolve on timescales long compared to a dynamical time , there is no formal restriction on how short the evolution time must be .",
    "therefore , the approach to dynamical instabilities from a stable configuration , and even initial dynamical development , also can be studied , although the author still recommends the use of an explicit code for full dynamical evolution .",
    "the equations of continuum astrophysics have been condensed into a general compact covariant form , and that form encoded into the author s fem program genral .",
    "a user can solve a particular astrophysics problem by supplying a single subroutine that takes as input one given coordinate position , plus the value of the variables and their gradients there , and returns as output the _ differential _ equations ( _ i.e. _ , the generalized `` stress tensor '' , `` body force vector '' , and possible boundary conditions appropriate for that problem ) .",
    "the program then generates the nodal or `` difference '' equations on a user - specified general curvilinear grid using the finite element weighted residual integrals , and solves the large set of coupled equations to produce the solution to the equations .",
    "while described by discrete nodal values , as in finite difference methods , the finite element solution is continuous , as in spectral methods , due to the finite element interpolation functions .",
    "either second order ( linear interpolation ) or third order ( quadratic interpolation ) accurate solutions are possible in the code .",
    "in addition , the positions of the nodes themselves can be part of the solution ( a `` rubber '' mesh ) , allowing grids to be fit to unknown boundary shapes and regions of high gradients to be more finely resolved with the same number of mesh points .",
    "while the method is cast in a full covariant form , it is anticipated that the initial applications will be mainly in the area of non - relativistic stars or accretion disks in static gravitational fields .",
    "the covariant form , however , is important even for non - relativistic problems .",
    "when the mesh extends into the time domain , even only for one or two elements , the coordinate transformations that are a natural component of the finite element method _ automatically _ generate any arbitrary lagrangian - eulerian ( ale ) advective derivatives needed to take possible grid motion into account",
    ".    the method has been demonstrated on astrophysically interesting problems ( spherical or rotating polytropic stars ) in one and two dimensions , with full adaptive gridding , and on simpler problems in three and four dimensions .",
    "a great deal has been written on the numerical solution of astrophysical potential problems like equation ( [ poissons_eq ] ) .",
    "the technique used here has elements of past approaches plus some new features and is well - suited to the fem . like many past authors ( @xcite ; @xcite )",
    ", the approach here casts the problem as a differential equation with boundary conditions specified on the exterior of the domain . however , rather than being a simple @xmath367 or low - order multipole potential at a large radius in the vacuum region , the author s preferred boundary condition is an integral solution of the differential equation , specified at the stellar surface .",
    "this integral is physically equivalent ( on that surface ) to the `` full integral '' technique that computes the potential _ throughout the computational domain _ using a green s function integral rather than solving the differential equation itself ( @xcite ; @xcite ; @xcite ) .",
    "however , the author s method of evaluating this integral is somewhat different as it requires no expansion in terms of legendre polynomials , relying instead on a single , slowly - varying , numerically - tabulated function @xmath368 to handle the axisymmetry of the potential field . when calculated in this manner ,",
    "using the integration techniques already available in the fem , the numerical integral is a solution of the discrete finite element equations themselves to within the truncation error .",
    "the boundary condition and interior differential equation , therefore , match well , leading to good convergence of the models .",
    "this technique will work in any situation where the full integral technique can be used : extension of the newtonian case into three dimensions will be trivial , and it will be straightforward for the general relativistic case as well . in three dimensions",
    "there is no axisymmetry , so @xmath368 will not be needed , and @xmath369 will take the simple pythagorean form . for axisymmetric relativistic stars ,",
    "the four metric potentials are given by three green s function integrals plus a first order equation ( @xcite ) .",
    "therefore , the three elliptic equations can be solved in the same manner as poisson s equation is solved here ( although probably using different tabulated @xmath342 functions ) , preserving the differential equations in the stellar interior but using the integral solution on the surface .",
    "the fourth equation would be handled with the petrov - galerkin scheme demonstrated in section 4 .",
    "the advantage of this approach compared to the full integral technique is speed ( the number of volume integrals is proportional to the domain surface area , not the volume ) .",
    "the advantage over the multi - domain technique is convenience ( one does not have to deal with the vacuum region and the matching of stellar and vacuum solutions ) .",
    "while the code and method are mature enough to begin solving two - dimensional structural problems routinely , there are several unresolved issues , mentioned in the text , that must be addressed more completely before the full potential of the astrophysical finite element method can be realized .",
    "first and foremost are the execution speed and memory issues .",
    "while the reader may consider the generation of the transformations and finite element integrals rather time - consuming , by far the greatest use of computer resources is the technique currently used to solve the coupled equations  the henyey technique . for large meshes in three or more dimensions",
    ", it becomes prohibitively expensive , requiring thousands to many millions of _ years _ of cpu time ( @xmath370^{3d-2}$ ] ) and equally absurd amounts of memory ( @xmath370^{2d-1}$ ] ) to invert once .",
    "however , multigrid methods ( @xcite ) need only about twice the grid size in storage ( @xmath370^d$ ] ) and only require a few sweeps of the mesh to converge ( @xmath370^d \\log [ \\aleph \\wp]^d$ ] ) . the author and p. godon",
    "have been experimenting with modern parallel multigrid algorithms in finite _ difference _ codes with considerable success .",
    "the cpu - time and memory scalings , and linear speedup on parallel supercomputers , all have been realized .",
    "efforts are currently underway to make genral a parallel , multigrid fem code .",
    "implementation of iterative schemes like multigrid for solving the equations will make straightforward the application of accurate reflective and periodic boundary conditions . while possible with the henyey technique , this process is much more difficult as it involves columns of matrix elements far from the diagonal and special techniques for inversion . with iterative methods , as with explicit codes , one can enclose the computational domain in a layer of `` ghost '' elements whose properties are determined at each iteration by the interior solution . the ghost element approach will have the same order of accuracy as the interpolation scheme , unlike the current approach for the reflective boundary condition , which uses essentially a backward difference .",
    "another possibly important issue is time evolution .",
    "all examples in this paper , even the four - dimensional ones , are time - independent and use a cartesian metric .",
    "the inclusion of time dependence may be as simple as employing a minkowski metric and time derivatives of the variables , and the letting the finite element machinery solve the problem .",
    "often , however , the addition of a new feature generates new numerical problems which require modification of that machinery .",
    "until more experience is obtained with time dependent problems , it is not clear whether the techniques discussed here are complete or whether they will need additional major development to handle evolutionary situations .",
    "finally , many issues remain in the use of the finite element method for _ dynamical _ evolution problems .",
    "these are currently important topics in the engineering field , but , because explicit finite difference codes do well for astrophysical problems in this area , development of these issues here will have lower priority .",
    "they include adaptive mesh refinement ( for dynamical collapse situations ) , implementation of the general boundary conditions in equation ( [ general_bc ] ) ( for magnetohydrodynamics and solving maxwell s or einstein s equations ) , and proper upwinding schemes with behavior comparable to the higher order godonov schemes ( for problems that develop shocks ) .      in numerical relativity",
    "it is customary to perform a `` 3 + 1 split '' of the metric such that @xmath371 where @xmath372 is the 3-metric that raises or lowers indices on the shift 3-vector @xmath373 , and @xmath343 is the `` lapse function '' , all of which are functions of position in spacetime ( @xcite ; @xcite ) .",
    "the 3-metric is specified on the initial hypersurface by solving the field constraints ( initial value data ) , the lapse and shift are computed from four coordinate ( or `` gauge '' ) conditions , and the einstein field equations are used to evolve @xmath372 to the next hypersurface .",
    "the goal is to choose a gauge in which the hypersurfaces do not intersect a singularity before a significant amount of evolution occurs in some part of the mesh .",
    "the current method for singularity avoidance is to eliminate pathological parts of spacetime from the mesh ( `` excise the black hole '' ) ( @xcite ) .",
    "while such an approach is also possible with the fem ( @xcite , advancing time in a step - by - step fashion , the full covariant nature of the method and the lifting of the degeneracy between basic and mesh coordinate systems , allow additional approaches to be taken .",
    "in particular , it becomes possible to extend the mesh fully in the time dimension , from initial to final hypersurface , choosing a relatively simple gauge for @xmath343 and @xmath374 .",
    "then , adaptive gridding in all four dimensions can be used to keep the grid boundaries away from singularities and to further adjust the separation in time between spacelike hypersurfaces .",
    "because of the ispoarametric transformation , the foliation no longer has to be along surfaces of constant time @xmath375 .",
    "the separation between adjacent surfaces can be non - uniform , the time coordinate can vary considerably over the hypersurfaces , and the final hypersurface even can end at different times . in effect , the adaptive gridding completes , in mesh coordinates , the job of slicing and singularity - avoiding that a poor gauge choice may fail to do .",
    "one advantage of this approach is that some or all of the field constraints can be applied on the final , instead of initial , hypersurface , turning an explicit hyperbolic problem into an implicit boundary value problem ( like stellar structure ) and possibly stabilizing the growth of errors .",
    "however , while such techniques probably can succeed in keeping physical singularities at bay , it is doubtful that they can avoid coordinate singularities in general situations .",
    "( these arise in the most benign of curved surfaces  on the surface of the earth , for example . )",
    "apart from knowing the geometry before hand and choosing the proper basic coordinate system , there are only a few ways to avoid these problems entirely .",
    "one is to embed the spacetime in a higher dimensional , flat minkowskian space . in principle , as many dimensions as independent spacetime metric coefficients ( ten ) would be needed for the embedding , although it may be possible with fewer .",
    "from the ten hyperspace coordinates , and how they vary in the four - dimensional mesh , one then could derive the local metric of the spacetime and use it in the physical equations .",
    "these ten equations for the metric in terms of the hyper - coordinates , plus the six einstein equations and the four adaptive gridding equations , would be sufficient to determine the twenty independent @xmath376 and hyper - coordinates at each node in the finite element mesh . while a fairly immense job for present - day computers , this prescription has the advantage of being singularity - free in general situations .",
    "another method of avoiding coordinate singularities using the fem is to dispense with global coordinates entirely , using only line segment lengths and deficit angles to describe the geometry and the regge calculus to describe the physics ( @xcite ; @xcite ) . at present , this approach has been developed only for simplex - type elements and not hypercubes , so it is not a straightforward application of the code discussed herein .",
    "however , it may be useful to recast the regge calculus for other element types .",
    "finally , all methods that involve a full four - dimen - sional finite element spacetime are probably well beyond the capabilities of present computer technology , even with the use of parallel multigrid techniques . nevertheless , they appear to have such attractive features and elegance that it is important to begin to develop them .",
    "the author is grateful to j. fanselow for support during the early development of this work , to l. caroff and m. bicay at nasa for allowing a small portion of a theoretical astrophysics grant to be used for this purpose , and to the jpl director s research and development fund for support to complete this work .",
    "discussions with numerous people were very helpful , including g. lyzenga and a. raefsky on the finite element method , m. norman on adaptive gridding , p. godon on spectral methods and multigrid methods , and w. cannon , s. finn , m. holst , k. thorne , and j. york on the use of these techniques for general relativity .",
    "this research was carried out at the jet propulsion laboratory , california institute of technology , under contract to the national aeronautics and space administration .",
    "this appendix shows that virtually all the equations of astrophysics of continuous media can be cast into the flux - conservative , finite element form ( equation [ general_eq ] ) and their boundary conditions into equation ( [ general_bc ] ) .",
    "that is , while possibly second order in spatial and time derivatives , they can be written as the four - divergence of a generalized stress tensor plus a generalized body force vector , each of which are functions of no more than the first spacetime derivative ( four - gradient ) of the variables .",
    "of course , it is always possible to define additional variables ( _ e.g. _ , the 24 connection coefficients ) and turn the field equations and conservation laws into first - order equations involving only the @xmath11 term in equation ( [ general_eq ] ) .",
    "the challenge , however , is to use only the original metric and field components as variables ( avoiding additional computational expense ) , and still maintain the flux - conservative form .",
    "below is one solution to this problem .",
    "the discussion here is concerned only with differential equations .",
    "local physics , such as the equations of state , opacity , emissivity , viscosity , _ etc .",
    "_ , is not treated in detail . while having position and time dependence , these processes can be described with simple algebraic equations that do not affect the numerical method used .",
    "the differential equations are the deceptively simple set of the einstein equations for the gravitational field @xmath377 ( where @xmath378 and @xmath379 are the symmetric einstein curvature and stress - energy - momentum [ sem ] tensors ) , and maxwell s equations for the electromagnetic field @xmath380 where @xmath381 is the covariant gradient operator , the antisymmetric maxwell tensor @xmath382 is the dual of the antisymmetric faraday tensor @xmath383 , and @xmath182 is the four - current . with the symmetry ,",
    "equations ( [ einstein_eqs ] ) are 10 in number , and ( [ maxwell1])-([maxwell2 ] ) constitute 8 , for a total of 18 . however , because of identities satisfied by the einstein and faraday tensors , there are actually only 12 _ independent _ equations ( 6 metric and 6 electromagnetic ) but 16 unknowns at each point in space : the 10 independent components of the metric @xmath13 and the 6 independent components ( the electric and magnetic fields @xmath384 and @xmath385 ) of the antisymmetric faraday tensor .",
    "the remaining 4 metric unknowns are determined by the choice of a coordinate system or gauge .    the standard method for generating",
    "a set of 12 evolutionary equations is to project ( [ einstein_eqs])-([maxwell2 ] ) into the hypersurface normal to a time - like vector ( or world line ) @xmath23 with the projection tensor ( equation [ projection_tensor ] ) .",
    "for example , if @xmath386 , then only the spatial part @xmath387 will be non - zero , with @xmath388 .",
    "in general , however , @xmath23 can be any time - like vector , so the equations will be left in general form .",
    "if the twelve _ spacelike _ components of equations ( [ einstein_eqs])-([maxwell2 ] ) are satisfied throughout the four - dimensional spacetime domain @xmath35 ( with one factor of @xmath389 for each tensor order ) @xmath390 then all that is necessary to satisfy the _ timelike _",
    "components @xmath391 throughout all spacetime is to satisfy the latter equations on _ one _ hypersurface only .",
    "equations ( [ field_eq1])-([field_eq3 ] ) , therefore , are the 12 independent differential equations to be solved for the six metric and six electromagnetic field components , while equations ( [ constr1])-([constr3 ] ) are the _ constraints _ that need to be satisfied in order for a solution to exist at all .",
    "( for reference , equation ( [ field_eq2 ] ) is ampere s law , ( [ field_eq3 ] ) faraday s law , ( [ constr1 ] ) contains the hamiltonian and momentum constraints [ by further contraction with @xmath23 or @xmath389 , respectively ] , ( [ constr2 ] ) is coulomb s law , and ( [ constr3 ] ) is the solenoidal condition on the magnetic field . )    equations ( [ field_eq1 ] ) , with ( [ constr1 ] ) as initial conditions , constitute the cauchy problem of general relativity . equations ( [ field_eq3 ] ) and ( [ constr3 ] ) are the covariant form of the evans - hawley `` constrained transport '' method for enforcing the solenoidal constraint in _ non - relativistic _ magnetohydrodynamics ( @xcite )",
    ". equations ( [ field_eq2 ] ) and ( [ constr2 ] ) represent constrained transport in the presence of sources .",
    "when ( [ field_eq1])-([field_eq3 ] ) are solved as cauchy problems , equations ( [ constr1])-([constr3 ] ) are applied on the _ initial _ hypersurface . however , as our approach here is to relax the system for a _",
    "four_-dimensional spacetime , instead of evolving a three - dimensional surface forward in time , they can be applied on _ any _ spacelike hypersurface .",
    "in addition to the field equations , there are conservation laws that follow from identities satisfied by the fields .",
    "the einstein curvature tensor is constructed in such a way that @xmath392 , so the conservation of energy and momentum @xmath393 must also hold from equation ( [ einstein_eqs ] ) . similarly , as @xmath383 satisfies @xmath394 , then the four - current must also be conserved @xmath395 the field equations then are `` closed '' by expressing the sem tensor and four - current in terms of the state variables , and solving the conservation laws of energy and momentum for those variables . for most conceivable astrophysical situations",
    " including those with multi - fluid dynamics , electromagnetic fields and currents , radiation , viscosity , and nuclear reactions  expressions for @xmath396 and @xmath182 involve terms with , at most , first - order derivatives of the state variables with respect to space or time .",
    "this is true even in situations near black hole horizons where particle interaction and fluid flow time scales are comparable , and equations like ohm s law , for example , are no longer valid .",
    "a final group of differential equations comes from forming the zeroth , first , and second moments of the boltzmann - vlasov equation for each particle species _ _ ( photons , nuclei , _ etc . _ ) .",
    "these determine each species individual number density , velocity ( including the peculiar drift velocity @xmath397 ) , and internal energy per particle .",
    "the kinetic equations give rise to familiar processes like nuclear burning , radiative transport , viscosity , and electrical conductivity .",
    "nevertheless , they all have the same `` conservative '' form , with the divergence of a term that involves ( at most ) first - order spatial derivatives of the state variables .",
    "for example , the zeroth moment of these kinetic equations yields @xmath398 = c^{(j)}\\ ] ] where @xmath399 s the particle number density and @xmath400 is the net particle creation rate due to nuclear reactions . for many astrophysical situations",
    ", particle conservation will be the only one of these equations needed , the drift velocity and particle energies being determined by the diffusion or other approximations .",
    "in addition to the einstein field equations ( [ comp_einstein ] ) four more coordinate conditions , and their possible boundary conditions , are needed to completely specify the metric .",
    "as these are rather arbitrary , these are left unspecified for now .",
    "( of course , if they are to be differential equations , they also must be in the form ( [ general_eq ] ) . )",
    "not all @xmath412 specified by equation ( [ isoparm_general ] ) are valid transformations in all situations . sometimes they must satisfy certain conditions , which are discussed below .",
    "two of these are conditions on the new ( element mesh ) metric formed by the transformation and the third is a condition on the element spacing itself .",
    "however , only the first condition always needs to be satisfied for a stable mesh .",
    "the other two are necessary only under certain circumstances .",
    "the most important of these conditions is that the jacobian determinant of the transformation be non - zero @xmath413 however , since @xmath414 , and since @xmath415 , this also means that the determinant of the new metric must be negative @xmath416 the jacobi condition ( [ jacobi_metric_cond ] ) ensures that the unit vectors in the element ( primed ) system , while not necessarily orthogonal , nevertheless form an independent coordinate system that has an arrow of time .",
    "it is absolutely necessary that this condition be satisfied in order that the mesh be well behaved .",
    "a second possible condition is that the element coordinate system have a locally lorentz character everywhere  _",
    "i.e. _ , that @xmath198 be the mesh time coordinate .",
    "this ensures that , if the spatial portion of the element mesh moves with time , the mesh velocity always will be less than the speed of light .",
    "this is important , however , only if the mesh is used as a frame of reference for measuring physical quantities .",
    "there are various ways of ensuring the lorentz nature of the transformation @xmath412 .",
    "the safest and simplest way is to ensure that each unit vector in the new space satisfies the proper timelike or spacelike constraint . with the constraints that @xmath198 denotes the time dimension and that @xmath417 , these local lorentz conditions become @xmath418 inequality ( [ local_lorentz_spacelike ] ) is equivalent to demanding that each of the element sides in the @xmath419 direction be spacelike",
    ".    a less stringent , but still sufficient , condition on @xmath420 could be derived by choosing a specific timelike vector , such as @xmath421 ( which still requires @xmath422 ) , and then constructing from the corresponding projection tensor a set of three independent vectors orthogonal to @xmath423 @xmath424 the condition that these vectors be spacelike ( @xmath425 ) leads to a modified form for inequality ( [ local_lorentz_spacelike ] ) @xmath426 in this less restrictive case , the @xmath427 unit vectors can be a bit timelike , but no more so than that given by the above inequality .      in standard nonrelativistic computational fluid dynamics , in order that the ( explicit ) forward integration in time be stable , the distance traversed in a single time step by sound waves or by the fluid itself ( whichever is faster ) must be substantially less than the mesh spacing .",
    "the ratio of these distances , called the courant number @xmath428 , is chosen to be @xmath429 or so depending on the stability of the numerical integration scheme .",
    "this nonrelativistic courant condition ( which can be written as @xmath430 for one - dimensional flow ) easily generalizes in the four - dimensional general relativistic case to @xmath431 where the vector @xmath432 ( @xmath433 ) .",
    "it further generalizes in the case of a general curvilinear element mesh to @xmath434 in each element , with @xmath435 ( @xmath436 , @xmath437 , @xmath438 , @xmath439 ) ; @xmath440 is the width of the element in each mesh dimension ; and @xmath441 is a three - velocity magnitude equal to the maximum disturbance speed within the element . because stable implicit techniques are used in time as well as space , a courant number very close to unity probably can be tolerated .",
    "therefore , in the case of relativistic flow , where @xmath442 , the courant condition reduces to the requirement that the geodesics connecting opposing corners in each element must be spacelike ( @xmath443 ) .    generally , the courant condition ( [ courant ] ) is much too restrictive and is routinely violated in slowly evolving or steady - state problems , where time steps are very long or even infinite . in implicit codes",
    "the condition needs to be satisfied only if one wishes to follow every short timescale transient phenomenon or wave .",
    "clement , m. j. 1978 , , 222 , 967 .",
    "clement , m. j. 1994 , , 420 , 797 .",
    "colella , p. 1990 , _ j. comput .",
    "_ , 87 , 171 .",
    "colella , p. & woodward , p. r. 1984 , _ j. comput .",
    "phys . _ , 54 , 174 .",
    "cook , g. b. _ al .",
    "_ 1998 , _ phys .",
    "_ , 80 , 2512 .",
    "dubinski , d. r. & hernquist , l. 1997 , _ new astronomy _ , 2 , 277 .",
    "eriguchi , y. & mller , e. 1985 , , 146 , 260 .",
    "eriguchi , y. & mller , e. 1991 , , 248 , 435 .",
    "evans , c. r. & hawley , j. f. 1988 , , 332 , 659 .",
    "holst , m. 1998 , in preparation .",
    "komatsu , h. , eriguchi , y. , & hachisu , i. 1989 , _",
    "_ , _ mon . not",
    "_ , 237 , 355 .",
    "leahy , d. a. 1997 , in _ the 12th ` kingston meeting ' : computational astrophysics _ , ed .",
    "d. a. clarke & m. j. west ( san francisco : astron .",
    "pacific ) , p. 109 .",
    "truelove , j. k. , klein , r. i. , mckee , c. f. , holliman , j. h. , howell , l. h. , grenough , j. a. , & woods , d. t. 1998 , , 495 , 821 .",
    "van leer , b. 1979 , _ j. comput",
    "_ , 89 , 125 .",
    "york , j. w. 1979 , in _ sources of gravitational radiation _",
    "l. l. smarr ( cambridge : cambridge univ .",
    "press ) , p. 83 .",
    "zienkiewicz , o. c. 1977 , _ the finite element method _ ( london : mcgraw - hill ) ."
  ],
  "abstract_text": [
    "<S> a new field of numerical astrophysics is introduced which addresses the solution of large , multidimensional structural or slowly - evolving problems ( rotating stars , interacting binaries , thick advective accretion disks , four dimensional spacetimes , _ etc . _ ) , _ as well as _ rapidly - evolving systems . </S>",
    "<S> the technique employed is the finite element method ( fem ) , which has been used to solve engineering structural problems for more than three decades . </S>",
    "<S> the approach developed herein has the following key features :    1 .   </S>",
    "<S> the computational mesh can extend into the time dimension , as well as space  generally only a few cells deep for most ( flat - space ) astrophysical problems , but throughout spacetime for solving einstein s field equations . </S>",
    "<S> 2 .   </S>",
    "<S> when time is treated as a mesh dimension , virtually all equations describing the astrophysics of continuous media , including the field equations , can be written in a compact form similar to that routinely solved by most engineering finite element codes ( albeit for nonlinear equations in a four - dimensional spacetime instead of linear ones in two or three space dimensions ) : the divergence of a generalized stress tensor equals a generalized body force vector , both of which are functions only of position , the state variables and their gradients . </S>",
    "<S> 3 .   </S>",
    "<S> the transformations that occur naturally in the four - dimensional fem possess both coordinate and boost features , such that 1 .   </S>",
    "<S> although the computational mesh may have a complex , non - analytic , curvilinear structure , and may be adapted to the geometry of the problem , the physical equations still can be written in a simple coordinate system that is independent of the mesh structure . </S>",
    "<S> 2 .   if the mesh has a complex flow velocity with respect to coordinate space , the transformations will form the proper advective derivatives , automatically converting the equations to arbitrary lagrangian - eulerian . </S>",
    "<S> 4 .   only relatively simple _ differential _ equations need to be encoded . </S>",
    "<S> the complex _ difference _ equations on the arbitrary curvilinear grid are generated automatically by the fem integrals . </S>",
    "<S> a different integration method must be used for equations of odd and even order .    </S>",
    "<S> this first paper concentrates on developing a robust and widely - applicable set of techniques using the nonlinear fem and presents some examples . </S>",
    "<S> the second paper in this series will deal with making the method fast and efficient , so that large , astrophysically - interesting computational meshes can be employed .    </S>",
    "<S> # 1 # 1 </S>"
  ]
}