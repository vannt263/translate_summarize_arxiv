{
  "article_text": [
    "mhd modeling is key to understanding solar eruptive events and their effect on the heliospheric enviroment .",
    "solar flares are known to be driven by magnetic reconnection ( e.g. @xcite ) and coronal mass ejections ( cmes ) are generally tied to magnetic instability of one kind or another ( e.g. @xcite ) .",
    "understanding and predicting such events requires numeric modeling of the plasma in the solar corona as it evolves under the line - tied boundary conditions imposed by the solar photosphere .",
    "current mhd modeling software is not able to reproduce the conditions of the solar corona under controlled conditions , because numerical effects in the simulation dominate over their counterparts in the real corona for many physical situations .",
    "this is evident in the difficulty of maintaining strong current sheets or other stressed flux systems , such as filaments , for long periods of time ; and in the difficulty of reproducing the rapidly varying heating rate in coronal loops and bright points .",
    "conventional magnetohydrodynamic models typically use eulerian ( fixed ) grids , introducing nonphysical dissipative effects such as viscosity and resistivity .",
    "these dissipative effects dominate the behavior of quiescent structures with current sheets and may even destabilize simulated cme - bearing systems @xcite , making modeling of solar evolution difficult at best .",
    "further , numerical diffusion of both momentum ( numerical viscosity ) and magnetic field ( numerical resistivity ) are dependent on grid speed , so that eulerian grid size is typically chosen to oversample the physical structure .",
    "the extra resolution is used to minimize the unwanted diffusion and preserve the plasma system for as much simulated time as possible .",
    "oversampling by a factor of 10 in each dimension yields a factor of @xmath1 slowdown in the overall simulation , requiring huge facilities to simulate even simple systems in 3-d .",
    "adaptive - mesh refinement improves performance significantly ( e.g. @xcite ) but still requires oversampling .",
    "lagrangian grids eliminate numerical resistivity but add additional problems .",
    "for example , as the grid distorts with the plasma motion , the fidelity of discrete differential operators degrades .",
    "fully lagrangian treatments of the corona shear rapidly because fluid motion is decoupled in the cross - field direction .",
    "to maximize the advantages of both the eulerian and lagrangian approaches to mhd modeling , we have developed a prototype fluxon modeling code , _ flux _ ( the `` field line universal relaxer '' ) , that is a hybrid between the two . in the low-@xmath0 regime , all forces are negligible when compared to the lorenz force components ; flux is essentially a force - free field solver that can support an independent plasma density parameter at each location in the simulation .",
    "flux demonstrates the fluxon method , and work is ongoing to add plasma pressure and related physical phenomena to the simulation framework . in the following sections , we briefly describe the basis of the fluxon numerical approach (  [ sec : fluxon - theory ] ) ,",
    "describe our code and its performance (  [ sec : flux - implementation ] ) , and discuss the direction of future work both on code development and on applications (  [ sec : future - work ] ) .",
    "the basis of the fluxon approach to numerical modeling is the analogy between field lines and an associated vector field : a field line map completely describes the associated magnetic field , and vice versa .",
    "this analogy has normally been used to visualize the magnetic field : the field vector value is calculated everywhere on a grid of values , and then interpolated to `` shoot '' field lines through the grid for visualization .",
    "but the analogy works in the reverse direction too : every physical property of the magnetic field may be described in terms of the behavior of individual magnetic field lines . in highly conductive plasmas , the field line description takes on more utility and meaning than in resistive physical systems , because field line topology is preserved under ideal mhd .",
    "flux is currently a relaxation solver for force - free magnetic systems : the magnetic field is represented as a skeleton of piecewise linear curves , _ fluxons _ , each of which represents a finite quantum of magnetic flux contained in a thin volume around a central curve .",
    "fluxons differ from conventional field lines in that a field line represents an infinitesimal amount of magnetic flux , while a fluxon represents a discrete , finite amount of magnetic flux ; the word is also used , with approximately the same meaning , in the context of quantized magnetic systems such as josephson junctions and quantum computers ( e.g. @xcite ) .",
    "the magnetic field is considered to be nearly parallel to the fluxon everywhere in its neighborhood , so that each fluxon may be considered to represent a non - twisted flux tube and ( as with conventional field lines ) magnetic field strength may be calculated by determining the areal density of fluxons that pass through a plane perpendicular to the field direction .",
    "other quantities such as field gradients may be calculated from the local geometry of the fluxons .",
    "each fluxon in a simulation arena is composed of an ordered collection of _ flux elements _ , or _ fluxels _ ( figure [ cap : fluxon ] ) .",
    "a fluxel represents a small amount of field - aligned length @xmath2 , and the differential mhd equations are discretized using @xmath3 ( where @xmath4 is the quantum of magnetic flux ) and @xmath5 ( when calculating curvature and similar quanties ) .",
    "each fluxel takes the same part in a fluxon simulation that a pixel ( or voxel or grid element ) takes in a conventional eulerian simulation . in the current implementation , fluxels are line segments and their associated fluxons are thus piecewise - linear .",
    "one may imagine spline or other curvilinear interpolation , but the geometric calculations are greatly simplified by a piecewise linear representation .",
    "computationally , fluxons are represented with dynamically allocated data structures : each fluxon is a linked list of fluxels , each of which contains position information for one of the two endpoints of the fluxel , and some ancillary data used to calculate local geometry and forces . in a relaxation calculation , the fluxel positions are relaxed to find a force - free equilbrium . at each relaxation step , all included forces are calculated at each fluxel node , and the node takes a step in the direction of the vector sum of the forces acting on it .",
    "the motions and force laws are constructed in such a way that fluxels never cross one another , unless forced to by the physics of the model .",
    "this ensures that magnetic topology is conserved : the discrete nature of the fluxon skeleton eliminates numerical reconnection . including just the lorenz forces in the relaxation yields approximations to non - linear force free field solutions with prescribed topology .",
    "a single fluxon can not by itself represent a field - aligned current ; but multiple fluxons can represent currents through twist ( figure [ cap : currents ] ) .",
    "the differential quantity @xmath6 may be estimated directly from the discrete geometry of nearby field lines .    in the remainder of this section",
    ", we describe the theory and implementation used to find the lorenz force throughout the simulation and hence to relax toward a force - free solution .",
    "calculating force free fields requires formulating the lorenz magnetic force in terms of the geometry of the fluxon grid , which represents the magnetic field as a collection of small magnetic flux tubes .",
    "we here derive the familiar force law @xmath7 from the energetics of a small , discrete flux tube , to demonstrate that the familiar forces acting on infinitesimal field lines can be represented using only the geometry of finite flux tubes .",
    "consider the magnetic energy @xmath8 of a finite , curved flux tube that carries a magnetic flux @xmath9 and whose shape and cross section @xmath10 are parametrized by path length @xmath11 along the tube , as in figure [ cap : lorenz - cartoon ] .",
    "( note that the cross - section may be an arbitrary shape , not only round as depicted here ) .",
    "if the magnetic field is constant across the cross - section of the tube , then the magnetic energy @xmath8 is given by@xmath12 where one factor of @xmath10 is cancelled from the denominator by carrying out the cross - sectional part of the volume integral .",
    "taking the differential along the length of the flux tube lets us characterize the energy per unit length:@xmath13 differentiating with respect to displacement @xmath14 of a point on the flux tube yields the differential of the @xmath15component of the lorenz force . @xmath16 where the first term is due to the variation of the path length from the displacement and the second term is due to the gradient of @xmath17 .",
    "noting that the path length variation is just the dot product of the displacement with @xmath2 times the negative curvature @xmath18 allows us to interchange the differentials , at the expense of a sign change .",
    "@xmath19    breaking the total derivative @xmath20 into partial derivative terms gives:@xmath21 which reproduces the familiar curvature and pressure force terms . separating out @xmath9 into @xmath22 and converting to vector notation gives@xmath23 where we have taken advantage of the relation @xmath24 to commute the scalar @xmath17 through the @xmath25 operator .",
    "equation [ eq : lorenz ] is just the familiar lorenz force relation , multiplied by the cross section of the flux tube .",
    "the left - hand term is the `` curvature force '' and the right - hand term is `` pressure force '' .",
    "equation [ eq : lorenz ] may be more cleanly expressed by collecting terms:@xmath26 finally , for force - free calculations it is useful to divide out the magnitude @xmath17 of the magnetic field , yielding the field - normalized lorenz force :    @xmath27    setting the left - hand side of either equation [ eq : lorenz - clean ] or equation [ eq : normalized - lorenz ] to zero describes a force - free magnetic field , but equation [ eq : normalized - lorenz ] is especially useful because the curvature force is represented entirely in terms of the local curvature of the flux tube without reference to the field strength @xmath17 , and the magnetic pressure force is also reducible to simple form .",
    "we refer to the left hand term as @xmath28 , the field - normalized curvature force per unit length ; and to the right hand term as @xmath29 , the field - normalized pressure force per unit length .",
    "the differential quantities in  [ sub : a - geometric - approach ] must be discretized for use with fluxons : each fluxon is a set of piecewise linear curves .",
    "each fluxel has a finite length @xmath30 rather than a differential length @xmath2 , with vertices at each end .",
    "what is desired is not the force per unit length along each fluxon , but the force acting on each vertex .",
    "the curvature and pressure force are discretized slightly differently because the curvature of a fluxon is defined only at the vertices , while the pressure is only defined near the center of each line segment .",
    "the normalized curvature force is simple to calculate , because of a fortunate cancellation : the amount of curvature from fluxel center to fluxel center is inversely related to the lengths of the fluxels , canceling the length factor in the integral .",
    "the b - normalized curvature force at each vertex @xmath31 is thus proportional to the offset angle at the vertex between two fluxels , as can be seen by integrating @xmath32 along the line segments between @xmath31 and its neighbors @xmath33 and @xmath34 : @xmath35@xmath36 where @xmath30 is the total line segment length and @xmath37 is the total amount of bend at vertex @xmath31 .",
    "the other half of the lorenz force , the field - normalized pressure force , requires characterizing the geometry of each fluxon s neighborhood to determine the magnetic pressure gradient . while the complete magnetic pressure @xmath38 is of interest in full mhd simulations , we note that displacement of a field line ( and hence fluxon ) along the direction of the field makes no physical change in the absence of plasma forces , and",
    "hence we use only the perpendicular pressure gradient @xmath39 to find the force - free equilibrium .",
    "the flux associated with each fluxon @xmath40 is considered to occupy the locus that is closer to @xmath40 than to any other .",
    "this locus is the _ voronoi neighborhood _ or _ voronoi cell _ of the fluxon , and a collection of fluxons , considered as curvilinear manifolds in three dimensions , forms a _ voronoi foam _ of such cells .",
    "there is a large body of literature on computerized _ voronoi analysis , _ the process of calculating and characterizing such neighborhoods near various families of manifolds in two , three , and more dimensions ; interested readers are referred to @xcite for a good introduction to the subject .",
    "the geometry of the voronoi cell of the fluxon completely describes the variation in the field strength b of the flux tube represented by the fluxon : the cross - sectional area of the cell gives @xmath17 , and the asymmetry determines @xmath39 , near the fluxon .",
    "the voronoi neighborhood of a one - dimensional piecewise linear manifold ( such as a fluxon ) embedded in three dimensions is described by a family of spliced fourth - order bivariate polynomials ( see , e.g. , @xcite and references therein ) ; solving such curves is computationally expensive .",
    "we instead approximate the voronoi neighborhood of each fluxel along the fluxon with a prism extruded along the length of the fluxel , and determine the two - dimensional voronoi neighborhood in the cross section of the prism .",
    "when projected into the cross - sectional plane of a central fluxel , the nearby fluxels appear as points , and the construction is straightforward ( as illustrated in figure [ cap : voronoi - construction ] ) .",
    "a line segment is constructed from the central fluxel to each nearby fluxel , and the perpendicular bisector of each such segment is found .",
    "the smallest convex polygon that can be constructed from the bisectors and that also includes the central fluxel is the two - dimensional voronoi cell of the central fluxel .",
    "the fluxels whose bisectors contribute to the shape of the voronoi cell are the _ neighbors _ of the central fluxel , and a list of them is retained .",
    "after an initial seeding step , the voronoi calculation at each relaxation step involves only the neighbors and next - nearest - neighbors from the previous step , speeding the calculation . in any sufficiently large field of points",
    ", the average number of edges in each voronoi cell ( and hence neighbors of the central fluxel ) converges to 6 , so the voronoi calculation for each cell runs in constant average time and for the entire simulation it runs in @xmath41 time .",
    "the projection function we use to project each fluxel into the cross - sectional plane is not cartesian : we find the point on the candidate fluxel that is closest to the central fluxel , project that point into two dimensions , and then multiply the radial distance by the fourth power of the secant of the out - of - plane angle to the candidate , artificially raising the distance to fluxels that are out of the cross - sectional plane .",
    "this is a smooth way of selecting the fluxels of most interest  those near the perpendicular plane of the central fluxel .",
    "fluxels that are far out of the plane are projected at a farther distance , so that they are usually not close enough to become neighbors during the cell construction .",
    "fluxels are not permitted to interact with the previous and next fluxel on the same fluxon , because the distance to those fluxels is ill - defined ( 0/0 discontinuity ) .",
    "the out - of - plane radial scaling function does not affect relaxation results strongly , provided that it is symmetric and grows fast enough : once a nearby projected fluxel is removed far enough from the origin , it is no longer considered a neighbor and does not affect the local force calculation .",
    "the fluxels of interest are those near the perpendicular plane of the central fluxel , and there the scaling function is near unity .",
    "once the voronoi geometry is known , the magnetic field still remains to be calculated .",
    "we are free to choose any non - pathological distribution of flux within the voronoi cell , as the cells are by definition smaller than the physical resolution of the model . for analytic convenience ,",
    "we treat the magnetic field in the voronoi cell as being in _ sectorwise angular equipartition _ : the cells are described as a collection of triangular segments , each of which has uniform magnetic field and each of which has a total amount of flux that is proportional to the angle subtended by the segment .",
    "this prevents currents from forming at the boundaries between parallel fluxons ( by construction , the field strength is equal on opposite sides of such a boundary ) , allows current sheets to form between nonparallel fluxons , and yields simple formulas for the average field and the perpendicular field gradient .",
    "this assumption yields a simple formula for the field - normalized magnetic pressure force @xmath42:@xmath43 where @xmath44is the direction to the @xmath15 neighbor , @xmath45 is the angle subtended by the corresponding edge of the voronoi cell , @xmath46 is the distance of closest approach of the corresponding perpendicular bisector , and @xmath30 is the length of the line segment from @xmath31 to @xmath34 .",
    "the formula works even in the case of open voronoi cells ( which are not closed polygons ) , because although the field is considered to be identically zero in the open directions , it is nonzero in the closed directions .",
    "this prevents the magnetic pressure force from being identically zero on the outermost field lines of the simulation ( which usually have open voronoi cells ) .      at each relaxation step , flux calculates the field - normalized curvature force at each node , and the pressure force at the center of each fluxel .",
    "the pressure forces for the leading and trailing fluxels for each node are averaged together , to produce an average pressure force at the node .",
    "the average pressure force , in turn , is added to the curvature force at the node to find a normalized total force . at each relaxation step ,",
    "all nodes are moved in the direction of the corresponding normalized total force , until a relaxation condition is met .",
    "this type of relaxation is similar to the magnetofrictional method ( @xcite ) except that the field line location , rather than local field direction , is being relaxed .",
    "all relaxation codes become proportionally less stable as equilibrium is approached , because the component forces are much larger than their resultant , making the local linearization matrix stiff . _ _ _ _ to overcome this problem and prevent oscillation around the equilibrium , flux scales each node s relaxation step by the square of the stiffness coefficient @xmath47 , where @xmath48 runs over all component forces in the relaxation ( in this case the pressure and curvature forces ) .",
    "further , although the forces are field - normalized , smaller steps must be taken where the fluxons are close together .",
    "hence , the step law used for flux with field - normalized forces is:@xmath49 where @xmath50 is node number , @xmath48 runs over all forces included in the relaxation , @xmath51 is a small eulerian step coefficient in fictitious `` relaxation time '' , the central fraction is the stiffness coefficient , and @xmath52 is the closest - approach distance of the closest neighbor to the following or trailing fluxel of each node .",
    "relaxation continues until the stiffness coefficient falls everywhere below some threshold , or until a maximum number of steps have been taken .    to consider additional forces in the simulation , it is only necessary to calculate the new force at each node at each relaxation step , and add it to the other forces in the relaxation .",
    "the end of each fluxon may be _ line - tied _",
    "( end node forced to a particular location ; this is the norm on the photosphere ) , _ open _ ( end forced at each relaxation step to the surface of a very large sphere ) , or _ plasmoid _ ( ends of the fluxon are forced to the same location ) . with no further consideration for boundary conditions ,",
    "the fluxon formalism yields free - space boundary conditions , effectively extrapolating the field to infinity _ in vacuo_.    impenetrable plane - like boundaries with prescribed field normal to the boundary ( such as the solar photosphere ) are modeled by the method of images : during each voronoi calculation , each fluxel interacts not only with its physical neighbors but with an image of itself reflected through the plane of the boundary .",
    "the reflection is culled in the voronoi calculation process , just like any other fluxel , so that elements far from the boundary do not interact with it directly . the image fluxel forces edge fluxels to have a voronoi cell boundary coincident with the boundary plane , confining the modeled flux .",
    "the field normal to the boundary may be prescribed by tying fluxon end - points to the boundary itself : the pattern is a constant of relaxation , and determines the field in the vicinity of the boundary .",
    "if no fluxons are tied to the boundary , then the field normal to the boundary is identically zero .",
    "formally , there is no magnetic method of images for most curviplanar boundaries .",
    "flux supports a spherical or cylindrical boundary using a _ polyplanar _ ( or `` disco ball '' ) approach , in which each fluxel has an image that is reflected through the tangent plane directly under the fluxel s center .",
    "this method works because the only fluxels that interact directly with their reflections are close enough to the surface that the boundary approximates a plane .      because fluxon models explicitly conserve topology , the initial topology map must be specified in advance of the relaxation , in the form of a collection of fluxons that have the correct topology and endpoints , but not necessarily the correct shape ; this makes fluxons useful for tracking systems with specified initial topology , such as flare models ( e.g. @xcite ) or semi - empirical results from tracking of photospheric magnetic features ( e.g. @xcite ) . an example initial condition and resulting field solution",
    "are shown in figure [ cap : carpet ] : an initial collection of fluxons is constructed to represent the connection map and desired topology of the solution , and then relaxed to find the actual magnetic field configuration in the system . to solve quasi - static time dependent problems ,",
    "one may deform a relaxed solution in a nonphysical way to match updated boundary conditions at the next time step , and then relax to find the new solution .",
    "fluxon models are less directly suited to solving problems where the initial topology is not known but the full vector field is known at the boundary . in such cases , one must begin with a guessed initial topology , and then use the mismatch between the computed and measured field angle at the boundary as an error function to find the correct topology by trial and error .",
    "alternatively , one may use vector magnetograms to validate topological inferences , for example those derived from magnetic tracking and/or coronal imaging .      since the shape of the field lines , and",
    "not the full position of the nodes , determines the lorenz force , we are free to impose a nonphysical force along the field to arrange the nodes for optimal sampling . to ensure optimal distribution , flux nodes along the same fluxon repel one another with an inverse - square law force , and also are attracted to curvature .",
    "this results in a compromise between uniform distribution and clustering near places where curvature is high .",
    "every few hundred relaxation steps , the grid is checked for denseness .",
    "additional nodes are placed wherever the fluxels are longer than the inter - fluxon spacing , and wherever the turn angle at each node is too great .",
    "currently , there is no way to add more fluxons to a model in mid - relaxation , though that type of grid refinement is planned for future work .",
    "fluxon models lock in topology , preventing any reconnection that is not inserted explicitly into the model .",
    "because fluxons are represented digitially as linked lists of fluxel locations , it is simple to relink two fluxon lists to achieve discrete reconnection in the model . flux supports this capability and offers a programmer interface to relink neighboring fluxons when particular local conditions are met .",
    "planned future work includes studies of current - triggered reconnection in which , once a threshold current density is achieved , reconnection proceeds very rapidly .",
    "this behavior is represented by the stick / slip reconnection model of @xcite and is a possible mechanism for nanoflare heating of the coronal ( e.g. @xcite ) .",
    "flux is written in portable c , with a user interface in perl / pdl @xcite .",
    "initial conditions may be specified either as an initial topology map ( non - equilibrium fluxon geometry ) or as a collection of potential sources together with boundary tie - points ( in which case the code shoots fluxons through the specified potential field from each tie - point ) .",
    "output is in the form of node coordinate arrays that contain the fluxon geometry and any ancillary data ( such as plasma density ) indexed by node i d number .",
    "the simulation arena is represented as a perl object that is manipulated using method call syntax .",
    "individual nodes are allocated and freed dynamically .",
    "the code can also render fluxon geometry in 3-d using the opengl graphics library .",
    "subroutines implementing several forces ( both field - normalized and non - normalized ) are available in the code , and the user can choose between them at run time .",
    "a programmer interface exists for adding more forces into the balance .",
    "initial fluxon configuration and boundary conditions may be specified using the pdl interface .      while developing flux we noticed an interesting phenomenon in the code s scaling properties .",
    "the number of nodes required to represent a loop of magnetic flux is dependent on the total amount of curvature in the loop , plus the number of inflection points in the loop . but magnetic fields that are line - tied at the sun s photosphere are approximately self - similar against scaling transformations , so that large loops require about the same number of nodes as small loops to represent .",
    "the result is that in typical use , flux s memory usage depends almost linearly on the total amount of line - tied flux that is represented , rather than on the total simulation volume .",
    "the simulation complexity scales more like a conventional 2-d model than like a 3-d model .",
    "we tested this hypothesis with collections of randomly connected `` magnetic carpet '' fields .",
    "one such randomly generated magnetic carpet was shown in figure [ cap : carpet ] , in which 40 randomly located flux concentrations have been connected into 20 separate magnetic domains with varying amounts of current .",
    "we generated and relaxed 20 carpet models spanning two orders of magnitude in complexity , from 3 flux concentrations to 300 flux concentrations , refining each so that the final vertex angle was limited to 0.25 radian ( about @xmath53 ) during relaxation by 200 steps of @xmath54 .",
    "we found that the required number of nodes indeed scales as the amount of flux at the boundary over the full range that we tested : more than two orders of magnitude in carpet complexity .",
    "we demonstrate here that flux can reproduce a simple potential field calculation and the behavior of the @xcite ( linear force - free ) and @xcite ( nonlinear force - free ) flux tubes .",
    "[ [ potential - solution ] ] potential solution + + + + + + + + + + + + + + + + + +    because flux is a full nonlinear force - free field solver , the potential solution has no special properties for testing the code , aside from convenience and ease of representation .",
    "we used nine fluxons to connect a square grid of tie points with spacing 0.05 , centered at location ( 0,0,0 ) , to a similar grid at ( 1,0,0 ) , with a photosphere located in the xy plane .",
    "free - space boundary conditions apply elsewhere than the photosphere , allowing the solution to expand into the positive - z half - space .",
    "each fluxon s initial configuration was a single upward jump followed by five horizontal steps and a downward jump ( 8 nodes per fluxon , including endpoints ) .",
    "the fluxons were relaxed for 1,000 timesteps with @xmath51 set to 0.2 , with nodes added periodically to limit the inter - fluxel angle to 0.1 radian ( about @xmath55 ) .",
    "the relaxation required about 40 cpu - seconds on a 1.4 ghz athlon workstation , ending with just under 700 nodes total and an average stiffness coefficient of @xmath56 , indicating good relaxation .",
    "the resulting potential field approximation is rendered in figure [ cap : field - line - test ] .",
    "the tied line locations approximate the surface penetration of a finite dipole with poles at ( 0,0,-0.1 ) and ( 1,0,-0.1 ) , so we compared the final relaxed shape of each fluxon to the shape of an analytically calculated field line with the same footpoints .",
    "the match is quite good , especially considering the coarseness of the model : @xmath57 between the analytic and fluxon solution is under 8% at every fluxon node , and under 2% everywhere except within 0.05 of the footpoints .",
    "[ [ linear - force - free - lundquist - flux - tube ] ] linear force - free ( lundquist ) flux tube + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    to demonstrate that flux is capable of matching analytic force - free solutions that are not potential , we demonstrate convergence to the @xcite solution in linear geometry .",
    "the lundquist solution is a cylindrical twisted flux tube along the @xmath58 axis , with the form @xmath59 we seeded the solution by shooting fluxons through the analytic lundquist solution with @xmath60 , between the @xmath61 and @xmath62 planes , for @xmath63 values from @xmath64 to 10 ( near the third node of @xmath65 ) . at each @xmath66 step in radius",
    ", we computed the number of field lines penetrating the @xmath61 plane at that diameter and truncated to the nearest integer , saving the floating - point residual to add at the next @xmath66 .",
    "the integer number of field lines were launched equidistant in @xmath67 around the flux tube , with a phase shift of 2.0 radians at each @xmath66 .",
    "this field line placement has the correct field topology by construction , but is far from correct : chance groupings of field lines in the essentially randomly oriented cylindrical shells dominate variations in field strength .",
    "the resulting paths were inserted into a fluxon model that was relaxed for 300 steps with @xmath51 set to 0.2 , with nodes added periodically to limit the inter - fluxel angle to 0.2 radian . because @xmath68 diverges , the lundquist flux tube can not be reproduced with free - field boundary conditions and a finite amount of flux ; hence , we applied a low - beta cylindrical boundary at @xmath69 during the relaxation : among the neighbor candidates for each fluxel at each time step was an `` image fluxel '' created by reflecting each of the fluxel s two vertices through the plane tangent to the cylinder radially outward from the corresponding vertex .",
    "this prevented flux tube expansion through the free space around the cylinder , while not directly affecting any flux element in the interior of the modeled tube .",
    "the relaxation involved 200 fluxons anchored in 50 concentric rings , consumed about 1000 cpu - seconds , and ended with just over 7,000 nodes and an average stiffness coefficient of @xmath70 .",
    "the resulting approximation of the lundquist flux tube is rendered in figure [ cap : lundquist ] . in cylindrical coordinates ,",
    "the lundquist solution is dependent only on @xmath63 , the distance from the @xmath58 axis ; hence , to determine the quality of the solution , we produced scatterplots of the calculated field components at each fluxel center in the relaxed solution .",
    "only fluxels in the central third of the solution ( @xmath71 were considered , to reduce edge effects at the top and bottom of the fluxon system .",
    "the scatterplots are shown in figure [ cap : lundquist - plots ] , demonstrating that the solution has converged to the lundquist solution .",
    "the rms @xmath72 is 5.4% throughout the volume .",
    "two features of the plots in figure [ cap : lundquist - plots ] require some explanation .",
    "first , there is considerable scatter in the plots compared to the potential solution .",
    "the scatter is attributable to two separate effects .",
    "first , because of the small number of fluxons in each radial sheath , there is some distortion of the field as the fluxons bend one around the other .",
    "secondly , we are representing the field within each fluxon using sectorwise angular equipartition  essentially assuming that the currents are concentrated along the boundaries of triangular prisms around each fluxon  but the lundquist solution requires a volume current . increasing the number of fluxons , or using an interpolation technique that averages the field over more than one fluxel , reduces the scatter significantly both by reducing the bending effect and by better approximating a volume current .",
    "secondly , the @xmath58 component of the field strength jumps across zero near the nodes of @xmath73 rather than passing smoothly through it .",
    "this is due to the discrete nature of the fluxons and the construction of our initial seed solution : no fluxons were launched from the rings where @xmath74 , because by construction each ring only contained sufficient fluxons to approximate the total magnetic flux penetrating the ring .",
    "hence our solution develops a small current sheet near each node of @xmath75 .",
    "while better attention to the seed field would reduce this artifact , we have retained it here to point out the care that is required in selecting the initial seed field and fluxon locations .",
    "the gaps in the statistical population between @xmath76 and @xmath77 are due in part to this effect and in part to the periodicity in @xmath63 of the original seed population of fluxels ; this fossil periodicity is more readily apparent in the radial component scatterplot at far left .",
    "while we have plotted field values only at fluxel centers , the field can be calculated anywhere within the simulation volume by interpolating between the field values at nearby fluxels .",
    "[ [ nonlinear - force - free - gold - hoyle - flux - tube ] ] nonlinear force - free ( gold - hoyle ) flux tube + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the gold - hoyle flux tube has the interesting property that @xmath78 is constant across field lines .",
    "the gold - hoyle solution has the form@xmath79 which , like the lundquist solution , carries an infinite amount of flux ( the enclosed flux diverges logarithmically in @xmath63 ) .",
    "we tested a gold - hoyle - like solution by launching a square , 11x11 array of fluxons from each of two flux concentrations in free space , separated by a distance of 30 on the @xmath58 axis .",
    "the flux concentrations were parallel to the @xmath80 plane , and had an inter - fluxon spacing of just 0.1 .",
    "the total twist was 2.0 turns along the length of the flux concentration .",
    "because the twist is locked in by the fixed topology , this nonphysical initial condition should relax to become a gold - hoyle flux tube with the correct amount of twist for its final radius .",
    "we allowed it to expand to a radius of 7.5 using zero - normal - field cylindrical boundary conditions .",
    "figure [ cap : gold - hoyle - plots ] shows the seed field configuration and the relaxed flux tube .",
    "we fit compared the fluxon field results to the family of analytic solution by plotting field component values at each fluxel center in the middle third of the simulation volume , and fit the value of @xmath81 by eye to about 0.65 .",
    "the results are shown in figure [ cap : gold - hoyle - plots ] .",
    "as with the lundquist solution , we have plotted the magnetic field value only at fluxel centers .",
    "figure [ cap : gold - hoyle - plots ] shows a good match between the fluxon result and the analytic solution , with no large current sheets as were demonstrated in the lundquist flux tube . as above , the periodicity of the fluxon placement is due to the regularity of the initial seed field , but the field strength and direction are close to the analytic value everywhere .",
    "the fossil periodicity is much more evident in this solution than in the lundquist solution , because the regularity of the initial condition ensures less relative movement of the fluxons in finding their equilibrium positions .",
    "the slope of @xmath82 vs. @xmath63 is slightly steeper in the fluxon curve than in the analytic solution .",
    "we attribute this effect to the vertical expansion of the outermost fluxons outside the intended cylindrical volume , which reduces the amount of twist per unit length in the outer portion of the volume .",
    "the effect may be reduced by expanding the source pattern , as in the seed condition for the lundquist solution , above , or by imposing impenetrable boundary planes above and below the tube .",
    "we have introduced _ fluxon modeling _ and a prototype code , flux , that is being released as free software ; and have demonstrated that flux can reproduce simple potential , linear , and nonlinear force free field solutions .",
    "flux is currently useful as a magnetofrictional force - free field solver , but it is also intended as a prototype of a much more complete mhd model .",
    "flux is very promising in two important respects : first , it exactly preserves field topology , potentially yielding a better approximation of ideal mhd than is possible with a conventional eulerian approach to mhd ; and second , it demonstrates good scaling properties that suggest it will perform very well when applied to more complex systems .",
    "we are releasing flux as free software that is available as source code for any purpose at all .",
    "it may be obtained from the authors , via the web at ` http://www.boulder.swri.edu/~deforest/flux ` , via solarsoft @xcite as part of the `` pdl '' package , or via the community coordinated modeling center @xcite .",
    "future work on flux will take two directions : addition and testing of plasma and other forces to study non - force - free equilbria ; and addition of dynamic forces to study quasi - stationary mhd systems and , ultimately , full inertial mhd evolution ."
  ],
  "abstract_text": [
    "<S> we have developed a new , quasi - lagrangian approach for numerical modeling of magnetohydrodynamics in low to moderate @xmath0 plasmas such as the solar corona . </S>",
    "<S> we introduce the concept of a `` fluxon '' , a discretized field line . </S>",
    "<S> fluxon models represent the magnetic field as a skeleton of such discrete field lines , and interpolate field values from the geometry of the skeleton where needed , reversing the usual direction of the field line transform . </S>",
    "<S> the fluxon skeleton forms the grid for a collection of 1-d eulerian models of plasma along individual flux tubes . </S>",
    "<S> fluxon models have no numerical resistivity , because they preserve topology explicitly . </S>",
    "<S> our prototype code , _ flux _ , is currently able to find 3-d nonlinear force - free field solutions with a specified field topology , and work is ongoing to validate and extend the code to full magnetohydrodynamics . </S>",
    "<S> flux has significant scaling advantages over conventional models : for `` magnetic carpet '' models , with photospheric line - tied boundary conditions , flux simulations scale in complexity like a conventional 2-d grid although the full 3-d field is represented . </S>",
    "<S> the code is free software and is available online . in this current paper </S>",
    "<S> we introduce fluxons and our prototype code , and describe the course of future work with the code . </S>",
    "<S> +   + </S>"
  ]
}