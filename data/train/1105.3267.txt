{
  "article_text": [
    "model predictive control ( mpc ) , sometimes also termed receding horizon control ( rhc ) , deals with the problem of approximately solving an infinite horizon optimal control problem which is , in general , computationally intractable . to this end , a solution of the optimal control problem on a truncated , and thus finite , horizon is computed .",
    "then , the first part of the resulting control is implemented at the plant and the finite horizon is shifted forward in time which renders this method to be iteratively applicable , see , e.g. , @xcite .    during the last decade ,",
    "theory of mpc has grown rather mature for both linear and nonlinear systems as shown in @xcite and @xcite .",
    "additionally , it is used in a variety of industrial applications , cf .",
    "@xcite due to its capability to directly incorporate input and state constraints .",
    "however , since the original problem is replaced by an iteratively solved sequence of control problems  which are posed on a finite horizon  stability of the resulting closed loop may be lost . in order to ensure stabilty ,",
    "several modifications of the finite horizon control problems such as stabilizing terminal constraints or a local lyapunov function as an additional terminal weight have been proposed , cf .",
    "@xcite and @xcite .    here , we consider mpc without additional terminal contstraints or costs , which is especially attractive from a computational point of view .",
    "stability for these schemes can be shown via a relaxed lyapunov inequality , see @xcite for a set valued framework and @xcite for a trajectory based approach . still , stable behavior of the mpc controlled closed loop can be observed in many examples even if these theoretical results require a longer prediction horizon in order to guarantee stability .",
    "the aim of this paper consists of closing this gap between theory and experimental experience .",
    "in particular , we develop an algorithm which enables us to ensure stability for a significantly shorter prediction horizon and , as a consequence , reduces the computational effort in each mpc iteration significantly . the key observation in order to extend the line of arguments in the stability proofs proposed in @xcite is that the relaxed lyapunov inequality holds true for the mpc closed loop for smaller horizons if not only the first element but several controls of the open loop are implemented , cf .",
    "@xcite . however , this may be harmful in terms of robustness , cf . @xcite .",
    "utilizing the internal structure of consecutive mpc problems in the critical cases along the closed loop trajectory , we present conditions which allow us to close the loop more often and maintain stability .",
    "indeed , our results are also applicable in order to deduce performance estimates of the mpc closed loop .",
    "the paper is organized as follows : in section [ section : problem formulation ] , the mpc problem under consideration is stated . in the ensuing section , we extend suboptimality results from @xcite and @xcite in order to give a basic mpc algorithm which checks these performance bounds . in section [ section : improving results ] , we develop the proposed algorithm further in order to increase the rate at which state measurements are used for feedback and state our main stability theorem . in the final section [ section : conclusion ]",
    "we draw some conclusions . instead of a separated example , we use a numerical experiment throughout the paper which shows the differences and improvements of the presented result in comparison to known results .",
    "we consider nonlinear discrete time control systems @xmath0 with @xmath1 and @xmath2 for @xmath3 where @xmath4 denotes the natural numbers including zero .",
    "the state space @xmath5 and the control value space @xmath6 are arbitrary metric spaces . as a consequence , the following results are applicable to discrete time dynamics induced by a sampled  finite or infinite dimensional  system , see , e.g. , @xcite or @xcite .",
    "constraints may be incorporated by choosing the sets @xmath7 and @xmath8 appropriately .",
    "furthermore , we denote the space of control sequences @xmath9 by @xmath10 .",
    "+ our goal consists of finding a static state feedback @xmath11 which stabilizes a given control system of type at its unique equilibrium @xmath12 . in order to evaluate the quality of the obtained control sequence , we define the infinite horizon cost functional @xmath13 with continuous stage cost @xmath14 with @xmath15 and @xmath16 for @xmath17 . here",
    ", @xmath18 denotes the nonnegative real numbers .",
    "the optimal value function is given by @xmath19 and , for the sake of convenience , it is assumed that the infimum with respect to @xmath20 is attained .",
    "based on the optimal value function @xmath21 , an optimal feedback law on the infinite horizon can be defined as @xmath22 using bellman s principle of optimality . however , since the computation of the desired control law requires , in general , the solution of a hamilton  jacobi",
    " bellman equation , which is very hard to solve , we use a model predictive control ( mpc ) approach instead .",
    "the fundamental idea of mpc consists of three steps which are repeated at every discrete time instant :    * firstly , an optimal control @xmath23 for the problem on a finite horizon @xmath24 , i.e. , @xmath25 is computed given the most recent known state @xmath26 of the system .",
    "here , @xmath27 corresponds to the open loop trajectory of the prediction with control @xmath28 and initial state @xmath26 . *",
    "secondly , the first element @xmath29 of the obtained sequence of open loop control values is implemented at the plant .",
    "* thirdly , the entire optimal control problem considered in the first step is shifted forward in time by one discrete time instant which allows for an iterative application of this procedure .",
    "the corresponding closed loop costs are given by @xmath30 where @xmath31 denotes the closed loop solution .",
    "we use @xmath32 to abbreviate the minimizing open loop control sequence and @xmath33 for the corresponding optimal value function .",
    "furthermore , we say that a continuous function @xmath34 is of class @xmath35 if it satisfies @xmath36 , is strictly increasing and unbounded , and a continuous function @xmath37 is of class @xmath38 if it is strictly decreasing in its second argument with @xmath39 for each @xmath40 and satisfies @xmath41 for each @xmath42 .",
    "note that , different to the infinite horizon problem , the first step of the mpc problem consists of minimizing the truncated cost functional over a finite horizon . while commonly endpoint constraints or a lyapunov function type endpoint weight are used to ensure stability of the closed loop ,",
    "see , e.g. , @xcite , @xcite , @xcite and @xcite , we consider the plain mpc version without these modifications . according to @xcite , stable behavior of the closed loop trajectory",
    "can be guaranteed using relaxed dynamic programming .",
    "[ setup : proposition : aposteriori ] ( i ) consider the feedback law @xmath43 and the closed loop trajectory @xmath31 with initial value @xmath44 . if @xmath45 holds for some @xmath46 $ ] and all @xmath3 , then @xmath47 holds .",
    "+ ( ii ) if , in addition , there exist @xmath48 such that @xmath49 and @xmath50 hold for all @xmath51 , @xmath3 , then there exists @xmath52 which only depends on @xmath53 and @xmath54 such that the inequality @xmath55 holds for all @xmath3 , i.e. , @xmath31 behaves like a trajectory of an asymptotically stable system .",
    "the key assumption in proposition [ setup : proposition : aposteriori ] is the relaxed lyapunov  inequality in which @xmath54 can be interpreted as a lower bound for the rate of convergence . from the literature , it is well  known that this condition is satisfied for sufficiently long horizons @xmath56 , cf .",
    "@xcite , @xcite or @xcite , and that a suitable @xmath56 may be computed via methods described in @xcite . to investigate whether this condition is restrictive , we consider the following example .",
    "[ setup : example ] consider the synchronous generator model @xmath57 with parameters @xmath58 , @xmath59 , @xmath60 , @xmath61 , @xmath62 , and @xmath63 from @xcite and the initial value @xmath64 .",
    "for example [ setup : example ] our aim is to steer the system to its equilibrium @xmath65 . to this end",
    ", we use mpc to generate results for sampling time @xmath66 and running cost @xmath67 with piecewise constant control @xmath68 for @xmath69 and @xmath70 where @xmath71 denotes the solution operator of the differential equation with initial value @xmath72 and control @xmath73 . for this setting",
    ", we obtain stability of the closed loop via inequality for @xmath74 , cf .",
    "figure [ figure : comparison ] .",
    "however , figure [ figure : comparison ] shows stable behavior of the closed loop for the smaller prediction horizon @xmath75 without significant deviations  despite the fact that the relaxed lyapunov  inequality from proposition [ setup : proposition : aposteriori ] is violated at three instances .",
    "( solid ) and @xmath75 ( dashed ) where @xmath76 marks a violation of the suboptimality bound @xmath77,width=321 ]    our numerical experiment shows that , even if stability and the desired performance estimate can not be guaranteed via proposition [ setup : proposition : aposteriori ] , stable and satisfactory behavior of the closed loop may still be observed .",
    "hence , since the computational effort grows rapidly with respect to the prediction horizon , our goal consists of developing an algorithm which allows for significantly reducing the prediction horizon . to this end",
    ", we adapt the thereotical condition given in .",
    "moreover , the proposed algorithms check  at runtime  whether these conditions are satisfied or not .    note that , since we do not impose additional stabilizing terminal constraints , feasibility of the nmpc scheme is an issue that can not be neglected . in particular , without these stabilizing constraints the closed loop trajectory might run into a dead end . to exclude such a scenario , we assume the following viability condition to hold",
    ".    for each @xmath78 there exists a control @xmath79 such that @xmath80 holds .",
    "in section [ section : problem formulation ] we observed a mismatch between the relaxed lyapunov inequality and the results from example [ setup : example ] which indicates that the closed loop exhibits a stable and  in terms of performance ",
    "satisfactory behavior for significantly smaller prediction horizons @xmath56 .",
    "in @xcite it has been shown that the suboptimality estimate @xmath54 is increasing ( up to a certain point ) if more than one element of the computed sequence of control values is applied .",
    "hence , we vary the number of open loop control values to be implemented during runtime at each mpc iteration , i.e. , the system may stay in open loop for more than one sampling period , in order to deal with this issue .",
    "doing so , however , may lead to severe problems , e.g. , in terms of robustness , cf .",
    "hence , the central aim of this work is the development of an algorithm which checks  at runtime  whether it is necessary to remain in open loop in order to guarantee the desired stability behavior of the closed loop by suboptimality arguments , or if the loop can be closed without loosing these characteristics .    to this end",
    ", we introduce the list @xmath81 , which we assume to be in ascending order , in order to indicate time instances at which the control sequence is updated .",
    "moreover , we denote the closed loop solution at time instant @xmath82 by @xmath83 and define @xmath84 , i.e. , the time between two mpc updates . hence , @xmath85 holds .",
    "this enables us  in view of bellman s principle of optimality  to define the closed loop control @xmath86 in @xcite , a suboptimality degree @xmath87 relative to the horizon length @xmath56 and the number of controls to be implemented @xmath88 has been introduced in order to measure the tradeoff between the infinite horizon cost induced by the mpc feedback law @xmath89 , i.e. @xmath90 and the infinite horizon optimal value function @xmath21 . in particular",
    ", it has been shown that given a controllability condition , i.e. , for each @xmath26 there exists a control @xmath91 such that @xmath92 holds with @xmath93 , @xmath94 , then there exists a prediction horizon @xmath95 and @xmath96 such that @xmath97 for an arbitrarily specified @xmath98 .",
    "[ theoretical background : example ] suppose to hold with @xmath99 and @xmath100 and fix @xmath101",
    ". then the pair @xmath102 implies @xmath103 , cf .",
    "figure [ theoretical background : figure : control horizon ] , i.e. , the closed ",
    "loop satisfies the performance bound @xmath104 .",
    "however , @xmath105 is the smallest prediction horizon which yields @xmath106 for @xmath107 , i.e. , classical mpc , cf .",
    "figure [ theoretical background : figure : prediction horizon ] .",
    "-values with respect to the number of controls to be implemented @xmath108 for prediction horizon @xmath109 .",
    "the dashed line indicates the reference value @xmath101.,width=170 ]    examples [ theoretical background : example ] shows that choosing a larger value for @xmath110 may significantly reduce the required prediction horizon length and , consequently , the numerical effort which grows rapidly with respect to the horizon @xmath56 . since the shape of the curve in figure [ theoretical background :",
    "figure : control horizon ] is not a coincidence , i.e. , @xmath111 holds for @xmath112 , cf .",
    "@xcite , we may easily determine the smallest prediction horizon @xmath95 such that @xmath113 ensures the desired performance specification .",
    "-values with respect to the prediction horizon @xmath114 for @xmath115 , i.e. , classical mpc .",
    "the dashed line indicates the reference value @xmath101.,width=170 ]    however , note that these results exhibit a set  valued nature .",
    "hence , the validity of the controllability condition and the use of a prediction horizon length corresponding to the mentioned formula lead to an estimate which may be conservative  at least in parts of the state space .",
    "this motivates the development of algorithms which use the above calculated horizon length but close the control loop more often . here",
    ", we make use of an extension of the @xmath110-step suboptimality estimate derived in @xcite which is similar to @xcite but can be applied in a trajectory based setting .",
    "[ theoretical background : prop : trajectory a posteriori estimate ] consider @xmath116 $ ] to be fixed .",
    "if there exists a function @xmath117 satisfying @xmath118 with @xmath119 for all @xmath3 , then @xmath120 holds for all @xmath3 .    * proof : * reordering , we obtain @xmath121 summing over @xmath3 yields @xmath122 and hence taking @xmath123 to infinity implies the assertion .",
    "[ remark1 ] note that the assumptions of proposition [ theoretical background : prop : trajectory a posteriori estimate ] indeed imply the estimate @xmath124 for all @xmath3 which can be proven analogously .",
    "note that @xmath125 is built up during runtime of the algorithm and not known in advance .",
    "hence , @xmath125 is always ordered . a corresponding implementation which aims at guaranteeing",
    "a fixed lower bound of the degree of suboptimality @xmath104 takes the following form :    given state @xmath126 , list @xmath127 , @xmath95 , and @xmath98    * set @xmath128 , compute @xmath129 and @xmath130 .",
    "do * * set @xmath131 , compute @xmath132 * * compute maximal @xmath54 to satisfy * * if @xmath133 : set @xmath134 and goto 2 * * if @xmath135 : print warning `` solution may diverge '' , set @xmath136 and goto 2 + while @xmath137 * for @xmath138 do * * implement @xmath139 * set @xmath140 , @xmath141 , goto 1    here , we adopted the programming notation _ back _ which allows for fast access to the last element of a list .",
    "if is not satisfied for @xmath142 , a warning will be printed out because the performance bound @xmath104 can not be guaranteed . in order to cope with this issue , there exist remedies , e.g. , one may increase the prediction horizon and repeat step 1 .",
    "for sufficiently large @xmath56 , this ensures the local validity of .",
    "unfortunately , the proof of proposition [ theoretical background : prop : trajectory a posteriori estimate ] can not be applied in this context due to the prolongation of the horizon .",
    "yet , it can be replaced by estimates from @xcite or @xcite for varying prediction horizons to obtain a result similar to .",
    "alternatively , one may continue with the algorithm .",
    "if there does not occur another warning , the algorithm guarantees the desired performance for @xmath143 instead of @xmath26 , i.e. , from that point on , cf .",
    "remark [ remark1 ] .",
    "in order to obtain a robust procedure , however , it is preferable that the control loop is closed as often as possible , i.e. , @xmath136 for all @xmath3 . in the following section ,",
    "we give results and corresponding algorithms which  given certain conditions  allow us to reduce @xmath88 .",
    "in many applications a stable behavior of the closed loop is observed for @xmath136 even if it can not be guaranteed using the suboptimality estimate , cf .",
    "example [ setup : example ] . here",
    ", we present a methodology to close the control loop more often while maintaining stability .",
    "in particular , if @xmath144 is required in order to ensure @xmath133 in and , as a consequence , in step ( 1 ) of the proposed algorithm , we present conditions which allow us to update the control for some @xmath145 to @xmath146 insert the new updating time instant @xmath147 into the list @xmath125 , and still be able to guarantee the desired stability behavior of the closed loop . summarizing ,",
    "our aim consists of guaranteeing that the degree of suboptimality @xmath104 is maintained , i.e. , is still satisfied , for the mpc law updated at a time instant @xmath148 according to .",
    "[ improving results : thm : m2one a posteriori estimate : ] let @xmath149 be given and inequality hold for @xmath150 , @xmath151 , and @xmath152 . if the inequality @xmath153 holds for some @xmath145 , then the control sequence @xmath154 can be replaced by and suboptimality degree @xmath104 is locally maintained .    *",
    "proof : * in order to show the assertion , we need to show for the modified control sequence .",
    "reformulating by shifting the running costs associated with the unchanged control to the left hand side of we obtain @xmath155 which is equivalent to @xmath156 i.e. , the relaxed lyapunov inequality for the updated control @xmath157 .",
    "[ improving results : example2 ] consider the illustrative example [ setup : example ] with horizon @xmath75 and @xmath77 .",
    "for this setting , we obtain @xmath133 with @xmath136 for all updating instances @xmath158 except for those three points indicated by @xmath76 in figure [ figure : comparison ] where we have @xmath159 once and @xmath160 twice . yet , for each of these points , inequality holds with @xmath161 .",
    "* @xmath159 : we apply theorem [ improving results : thm : m2one a posteriori estimate : ] in order to update the control @xmath162 according to . thus , since the mpc law was updated at each sampling instant , we have obtained stability of the classical mpc closed loop . * @xmath160 : we utilize theorem [ improving results : thm : m2one a posteriori estimate : ] in an iterative manner : since holds for @xmath161 , we proceed as in the case @xmath159 , update the control @xmath163 , and compute @xmath164 .",
    "then , we compute @xmath165 and check whether or not holds for with @xmath166 .",
    "note that here , @xmath154 in is already an updated control sequence .",
    "since holds true , we obtain stability of the closed loop for the updated mpc control sequence .",
    "moreover , we applied @xmath167 , @xmath168 and @xmath169 instead of @xmath170 , @xmath171 , i.e. , we have again used classical mpc .    note",
    "that this iterative procedure can be extended in a similar manner for all @xmath172 .    integrating the results from theorem [ improving results : thm : m2one a posteriori estimate : ] into the algorithm displayed after proposition [ theoretical background : prop : trajectory a posteriori estimate ] can be done by changing step ( 2 ) .    * for @xmath138 do * * implement @xmath139 * * compute @xmath173 and @xmath174 * * if @xmath175 and condition holds : * * * construct @xmath176 according to * * * update @xmath177    note that @xmath178 in is known in advance from @xmath179 due to the principle of optimality . hence , only @xmath180 and @xmath181 need to be computed .",
    "unfortunately , this result has to be checked for all @xmath182 using the comparison basis @xmath179 . as a consequence",
    ", we always have to keep the updating instant @xmath82 in mind , cf .",
    "example [ improving results : example2 ] .",
    "the following result allows us to weaken this restriction :    [ improving results : thm : m2one a posteriori estimate2 ] let @xmath149 be given and inequality hold for @xmath150 , @xmath151 , and @xmath152 .",
    "if the inequality @xmath183 holds for some @xmath145 , then the control sequence @xmath154 can be replaced by and suboptimality degree @xmath54 is locally maintained .",
    "* proof : * adding to leads to @xmath184 updating the control sequence according to , we obtain which completes the proof .",
    "we also like to point out that conditions and allow for a less fast decrease of energy along the closed loop , i.e. , the case @xmath185 is not excluded in general .",
    "as outlined in example [ improving results : example2 ] , theorem [ improving results : thm : m2one a posteriori estimate : ] ( and analogously theorem [ improving results : thm : m2one a posteriori estimate2 ] ) may be applied iteratively . yet ,",
    "in contrast to , @xmath179 is not required in .",
    "hence , if an appropriate update can be found for time instant @xmath186 , the loop can be closed and , as a consequence , theorem [ improving results : thm : m2one a posteriori estimate2 ] can be applied to the new initial value @xmath187 with respect to the reduced number of control to be implemented @xmath188 . to this end , the following modification of step ( 2c ) can be used :    * if @xmath175 and condition holds : * * construct @xmath176 according to * * update @xmath177 * * update the values @xmath189 and + @xmath190 , @xmath191    combining the results from proposition [ theoretical background : prop : trajectory a posteriori estimate ] and theorems [ improving results : thm : m2one a posteriori estimate : ] , [ improving results : thm : m2one a posteriori estimate2 ] , we obtain our main stability result :    let @xmath192 , @xmath151 be given and apply one of the three proposed algorithms .",
    "assume that ( 1c ) is satisfied for some @xmath193 for each iterate .",
    "then the closed loop trajectory satisfies the performance estimate from proposition [ theoretical background : prop : trajectory a posteriori estimate ] .",
    "if , in addition , the conditions of proposition [ setup : proposition : aposteriori](ii ) hold , then @xmath31 behaves like a trajectory of an asymptotically stable system .",
    "* proof : * the algorithms construct the set @xmath125 . since ( 1c ) is satisfied for some @xmath194 the assumptions of proposition [ theoretical background : prop : trajectory a posteriori estimate ] , i.e. , inequality for @xmath83 , are satisfied which implies . to conclude asymptotically stable behavior of the closed loop ,",
    "standard direct lyapunov techniques can be applied .    [ improving results : example3 ] again",
    "consider example [ setup : example ] with @xmath75 and @xmath77 .",
    "since is more conservative than , the closed loop control and accordingly the closed loop solution @xmath31 will not coincide in general .",
    "this also holds true in our example : while the case @xmath159 can be resolved similarly using the algorithm based on , no update of the control @xmath195 is performed for the two cases @xmath160 . here",
    ", this does not cause any change in the list @xmath125 .",
    "however , in general , @xmath125 is likely to be different for the presented algorithms .    since the proposed algorithms guarantee stability for the significantly smaller horizon @xmath75 , the computing time for example [ setup : example ] is reduced by almost @xmath196  despite the additional computational effort for step ( 2 ) .",
    "based on a detailed analysis of a relaxed lyapunov inequality , we have deduced conditions in order to close the gap between theoretical stability results and stable behavior of the mpc closed loop . using this additional insight , we developed two mpc algorithms which check these conditions at runtime .",
    "although the additional computational effort is not negligible , the proposed algorithms may allow us to shorten the prediction horizon used in the optimization .",
    "this reduces , in general , the complexity of the problem significantly which may imply a reduction of the overall computational costs .",
    "allgwer , f. and zheng , a. ( 2000 ) . _ nonlinear model predictive control _ , volume  26 of _ progress in systems and control theory_. birkhuser verlag , basel .",
    "papers from the workshop held in ascona , june 26 , 1998 .",
    "altmller , n. , grne , l. , and worthmann , k. ( 2010 ) . receding horizon optimal control for the wave equation . in _ proceedings of the 49th ieee conference on decision and control _ ,",
    "atlanta , georgia .",
    "keerthi , s. and gilbert , e. ( 1988 ) .",
    "optimal infinite - horizon feedback laws for a general class of constrained discrete - time systems : stability and moving - horizon approximations .",
    "_ j. optim .",
    "theory appl .",
    "_ , 57(2 ) , 265293 .",
    "magni , l. and scattolini , r. ( 2007 ) . robustness and robust design of mpc for nonlinear discrete - time systems . in r.",
    "findeisen , f.  allgwer , and l.t .",
    "biegler ( eds . ) , _ assessment and future directions of nonlinear model predictive control _ ,",
    "volume 358 of _ lecture notes in control and inform .",
    "_ , 239254 .",
    "springer , berlin ."
  ],
  "abstract_text": [
    "<S> in order to guarantee stability , known results for mpc without additional terminal costs or endpoint constraints often require rather large prediction horizons . still , stable behavior of closed loop solutions can often be observed even for shorter horizons . </S>",
    "<S> here , we make use of the recent observation that stability can be guaranteed for smaller prediction horizons via lyapunov arguments if more than only the first control is implemented . since such a procedure may be harmful in terms of robustness , we derive conditions which allow to increase the rate at which state measurements are used for feedback while maintaining stability and desired performance specifications . </S>",
    "<S> our main contribution consists in developing two algorithms based on the deduced conditions and a corresponding stability theorem which ensures asymptotic stability for the mpc closed loop for significantly shorter prediction horizons .    model predictive control , stability , suboptimality estimate , algorithms , sampled data system </S>"
  ]
}