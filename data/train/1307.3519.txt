{
  "article_text": [
    "genome - wide association studies have identified hundreds of dna variants associated to complex traits including disease in human alone @xcite . to understand how these variants affect disease risk , genotype and organismal phenotype data are integrated with intermediate molecular phenotypes to reconstruct disease networks @xcite .",
    "a first step in this procedure is to identify dna variants that underpin variations in expression levels ( eqtls ) of transcripts @xcite , proteins @xcite or metabolites @xcite . as modern technologies routinely produce genotype and expression data for a million or more single - nucleotide polymorphisms ( snps ) and ten - thousands of molecular abundance traits in a single experiment , often repeated across multiple cell or tissue types ,",
    "the number of statistical tests to be performed when testing each snp for association to each trait is huge .",
    "furthermore , multiple testing correction requires all tests to be repeated several times on permuted data to generate an empirical null distribution . despite being trivially parallelisable ,",
    "the computational burden of testing snp - trait associations one - by - one quickly becomes prohibitive .",
    "recently a new approach ( `` matrix - eqtl '' ) was developed which uses the fact that the test statistics for the additive linear regression and anova models can be expressed as multiplications between rescaled genotype and expression data matrices , thereby realising a dramatic speed - up compared to traditional qtl - mapping algorithms @xcite .",
    "a limitation of these models is their assumption that the expression data is always normally distributed within each genotype group .",
    "for this reason , qtl and eqtl studies have frequently used non - parametric methods which are more robust against variations in the underlying genetic model and trait distribution @xcite . in particular , the non - parametric kruskal - wallis one - way analysis of variance @xcite does not assume normal distributions and reports small @xmath0-values if the median of at least one genotype group is significantly different from the others @xcite .",
    "here we report a matrix - based algorithm ( `` krux '' ) , implemented in matlab , python and r , to simultaneously calculate the kruskal - wallis test statistics for several millions of snp - trait pairs at once that is more than ten thousand times faster than calculating them one - by - one on a human test dataset with more than 500,000 snps and 20,000 expression traits .",
    "additional benefits of krux include the explicit handling of missing values in both genotype and expression data and the support of genetic markers with any number of alleles , including variable allele numbers within a single dataset .",
    "krux takes as input genotype values of @xmath1 genetic markers and expression levels of @xmath2 transcripts , proteins or metabolites in @xmath3 individuals , organised in an @xmath4 genotype matrix @xmath5 and @xmath6 expression data matrix @xmath7 .",
    "genetic markers take values @xmath8 , where @xmath9 is the maximum number of alleles ( @xmath10 for biallelic markers ) , while molecular traits take continuous values .",
    "we use built - in functions of matlab , python and r to convert the expression data matrix @xmath7 to a matrix @xmath11 of data ranks , ranked independently over each row ( i.e. molecular trait ) .",
    "krux assumes that the input expression data has been adjusted for covariates if it is necessary to do so @xcite and all data quality control has been performed .",
    "the genotype matrix @xmath5 is first converted to sparse logical index matrices @xmath12 of the same size , where @xmath13 if @xmath14 and @xmath15 otherwise ( @xmath16 ) .",
    "next observe that the @xmath17 vector @xmath18 with entries @xmath19 and @xmath20 matrices @xmath21 with entries @xmath22 are respectively the number of individuals and the sum of ranks for the @xmath23th trait in the @xmath24th genotype group of the @xmath25th marker .",
    "we can then calculate an @xmath20 matrix @xmath26 with entries @xmath27 using efficient vectorised operations . if none of the rows in @xmath7 contain ties , then each entry @xmath28 equals the kruskal - wallis test statistic for testing trait @xmath23 against marker @xmath25 @xcite . for markers with less than the maximum of @xmath9 genotype values",
    ", @xmath29 division will result in nan columns in the intermediate matrices with entries @xmath30 for the empty genotype groups . by replacing all nan s by zeros before making the sum in eq .",
    "( [ eq:2 ] ) , the corresponding entries in @xmath26 will be the correct statistics for a test with fewer than @xmath9 degrees of freedom .",
    "thus we need @xmath31 matrix multiplications and the associated element - wise operations to calculate the test statistic values for all marker - trait combinations .",
    "krux takes as input a @xmath0-value threshold @xmath32 , calculates the corresponding test statistic thresholds for @xmath33 degrees of freedom ( @xmath34 ) , and identifies the entries in @xmath35 which exceed the appropriate threshold value . for these entries",
    "only a @xmath0-value is calculated using the @xmath36 distribution .",
    "empirical false - discovery rate ( fdr ) values are computed by repeating the @xmath0-value calculation ( with the same @xmath32 ) multiple times on data where the columns of the expression data ranks are randomly permuted .",
    "the fdr value for any value @xmath37 is defined as the ratio of the average number of associations with @xmath38 in the randomised data to the number of associations with @xmath38 in the real data .",
    "when data values are missing for some marker or trait , all test statistics for that marker or trait need to be adjusted for a smaller number of observations . for the expression data , missing values",
    "are easily handled since the ranking algorithms will give nan s the highest rank . by setting the entries corresponding to missing values in @xmath7 to zero in @xmath11 , eq .",
    "( [ eq:4 ] ) still produces the correct sums of ranks , while the matrix multiplication @xmath39 where @xmath40 is the @xmath6 matrix with @xmath41 whenever @xmath42 and @xmath43 otherwise , produces the corrected number of individuals in the @xmath24th group of the @xmath25th marker for the @xmath23th trait . replacing the constant @xmath3 in eq .",
    "( [ eq:2 ] ) by a @xmath20 matrix @xmath44 where @xmath45 is the number of non - missing samples for trait @xmath23 and performing element - wise division and substraction operations then gives the correct test statistic for all pairs .",
    "handling missing genotype data is less easy because the expression ranks that need to be adjusted are specific to each marker - trait combination ( e.g if a marker has a missing value where a trait has rank @xmath46 , then all samples with ranks @xmath47 need to be lowered by @xmath43 ) .",
    "krux uses the fact that missing genotype values are generally due to sample quality and therefore patterns of missing values are often repeated among markers . for each unique missing value pattern , a new genotype matrix for all markers with that pattern and a new expression data matrix with the corresponding samples removed are constructed to calculate the test statistics for all affected marker gene combinations .",
    "missing genotype data increases the computational cost of the algorithm considerably and it is recommended to limit the number of missing values by only considering markers with a sufficiently high call rate .      in the presence of tied observations , the statistic in eq .",
    "needs to be divided by a factor @xmath48 , where the summation is over all groups of ties and @xmath49 for each group of ties , with @xmath50 the number of tied data in the group @xcite .",
    "the factor @xmath51 is automatically computed for each trait during the ranking step and the matrix @xmath35 is therefore easily corrected using element - wise matrix operations ( matlab version only ) .",
    "whereas ties are usually rare in standard gene expression datasets , the ability to handle tied data expands the scope of krux to count - based , discretised or qualitative data types .      since krux needs to create intermediate matrices of size @xmath52 , where @xmath2 is the number of traits and @xmath1 the number of markers , which do not usually fit into memory for large datasets , krux supports the use of data ` slices ' to divide the complete data into manageable chunks .",
    "in typical applications , the number of markers is one or two orders of magnitude larger than the number of traits .",
    "therefore the default behaviour of krux is to keep the expression data as a single matrix and simultaneously test all traits against subsets of markers",
    ". the user can provide either a slice size and krux will process marker blocks of this size serially , or a slice size and initial marker and krux will process a single slice starting from that marker .",
    "the latter option allows trivial parallelisation across multiple processors .",
    "to test krux we provide example analysis scripts and a small anonymised dataset of 2,000 randomly selected genes and markers from 100 randomly selected yeast segregants @xcite . here",
    "we describe an application of krux on a human dataset of 19,610 genes and 530,222 snp markers measured in 102 whole blood samples from the stockholm atherosclerosis gene expression ( stage ) study @xcite .",
    "all snps in the dataset had minor allele frequency greater than @xmath53 , no missing values and probability to be in hardy - weinberg equilibrium greater than @xmath54 .",
    "we first confirmed that krux produces the same results as testing marker - trait combinations one - by - one using the built - in kruskal - wallis functions to verify the correctness of our implementations . to test the performance of krux we divided the genotype data into slices of variable size and extrapolated the total run time from running a single genotype data slice against all expression traits and multiplying by the number of slices needed to cover the entire set of 530,222 snps .",
    "the total run time rapidly decreases until a genotype slice contains about 1,000 snps and stays almost constant thereafter . on a laptop with 8 gb ram",
    ", the limit is reached at around 3,000 snps per slice after which run time sharply increases again due to memory limitations ( fig .",
    "[ fig : cpu ] ) .",
    "we therefore recommend a genotype slice size of around 2,000 markers , resulting for this dataset in around 250 separate jobs , which will take around 2,500 seconds ( 42 minutes ) when run serially on a single processor . by comparison , the total extrapolated run time when computing all 19,610 @xmath55 530,222 associations one - by - one using the built - in kruskal - wallis function on the same hardware as in fig .",
    "[ fig : cpu ] are respectively @xmath56 ( 256 gb , 2.20 ghz server ) and @xmath57 ( 8 gb , 2.70 ghz laptop ) seconds such that krux is respectively 17,000 and 11,000 times faster on this particular dataset . on the same dataset and hardware , the comparatively simpler matrix operations for the parametric tests in matrix - eqtl took respectively 5 minutes ( linear model ) and 7.4 minutes ( anova model ) .",
    "next we compared the output of krux and matrix - eqtl s parametric anova and linear model ( henceforth called `` anova '' and `` linear '' ) methods .",
    "the kruskal - wallis test is more conservative than the anova and linear methods , i.e. it has a higher nominal @xmath0-value for almost all marker - trait combinations ( fig .",
    "[ fig : pval ] ) . since",
    "random data will be subjected to the same biases , nominal @xmath0-values can not be directly compared to assess significance .",
    "we therefore performed empirical fdr correction for multiple testing using three randomised datasets ( cf .",
    "implementation ) .",
    "surprisingly , after fdr correction only a limited number of associations remained for anova even at an fdr threshold of @xmath58 , whereas the number of associations detected by krux and the linear method was comparable ( fig .",
    "[ fig : fdr](a ) ) .",
    "detailed analysis showed that this is due to pairing of snps with rare homozygous minor alleles ( one or two samples ) to genes with outlier expression levels , resulting in extremely low @xmath0-values for the anova method in real as well as randomised data ( see also below ) . to reduce the incidence of chance associations between singleton genotype groups and outlying expression values in the anova method we repeated the empirical fdr correction , this time keeping only marker - trait combinations within 1mbp of each other ( `` cis - eqtls '' ) . at an fdr threshold of @xmath59",
    "the number of significant _ cis_-eqtl - gene pairs is indeed comparable between the three methods , with a large proportion of pairs detected by all three of them ( fig .",
    "[ fig : fdr](b ) ) .",
    "-values calculated by krux vs. parametric anova * ( a ) * and linear models * ( b ) * , showing all _ cis_-acting eqtl - gene pairs with @xmath60 detected by both methods ( blue dots ) and by only one of the methods ( red crosses ) .",
    "the black line indicates the line with slope @xmath61 . ]",
    "we classified eqtl - gene pairs as `` skewed group sizes '' ( smallest genotype group less than 5 elements ) , non - skewed `` non - linear '' [ median of heterozygous and homozygous samples significantly different ( wilcoxon rank sum @xmath62 ) ] and non - skewed `` other '' ( all others ) . _ cis_-associations identified exclusively by the kruskal - wallis test are more often non - linear and the overall distribution of eqtl - types is more similar to associations identified by all three methods , compared to the anova and linear methods ( fig .  [ fig : groups ] and fig .",
    "[ fig : box](a - b ) ) . of the 701 associations",
    "exclusively identified using the parametric anova method , 657 ( @xmath63 ) had skewed group sizes , including 426 ( @xmath64 ) with a singleton genotype group ( the aforementioned ` outliers ' , cf .",
    "[ fig : box](c ) ) .",
    "the associations exclusively identified by the linear method also contained a much higher proportion of snps with skewed group sizes than the corresponding krux associations ( @xmath65 vs. @xmath66 ) and , as expected , a reduced number of non - linear associations ( fig .",
    "[ fig : groups ] and fig .",
    "[ fig : box](d ) ) .",
    "we have developed krux , a software tool that uses matrix multiplications to simultaneously calculate the kruskal - wallis test statistics for millions of marker - trait combinations in a single operation , thereby realising a dramatic speed - up compared to calculating the test statistics one - by - one .",
    "the availability of a fast method to identify eqtl associations using a non - parametric test allowed us to assess in more detail how differences in model assumptions compared to parametric methods lead to differences in identified eqtls .",
    "our results on a typical human dataset indicate that the the parametric anova method is highly sensitive to the presence of outlying gene expression values and snps with singleton genotype groups .",
    "we caution against its use without prior filtering of such outliers .",
    "linear models reported the highest number of eqtl associations after empirical fdr correction .",
    "these are understandably biased towards additive linear associations and were also sensitive to the presence of skewed genotype group sizes , albeit to a much lesser extent than the parametric anova method .",
    "the kruskal - wallis test on the other hand is robust against data outliers and heterogeneous genotype group sizes and detects a higher proportion of non - linear associations , but it is more conservative for calling additive linear associations than linear models , even after fdr correction .",
    "13ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ] ",
    "+ 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty @noop * * ,   ( ) @noop * * ,   ( ) @noop * * , ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( )"
  ],
  "abstract_text": [
    "<S> the kruskal - wallis test is a popular non - parametric statistical test for identifying expression quantitative trait loci ( eqtls ) from genome - wide data due to its robustness against variations in the underlying genetic model and expression trait distribution , but testing billions of marker - trait combinations one - by - one can become computationally prohibitive . </S>",
    "<S> we developed krux , an algorithm implemented in matlab , python and r that uses matrix multiplications to simultaneously calculate the kruskal - wallis test statistic for several millions of marker - trait combinations at once . </S>",
    "<S> krux is more than ten thousand times faster than computing associations one - by - one on a typical human dataset . </S>",
    "<S> we used krux and a dataset of more than 500k snps and 20k expression traits measured in 102 human blood samples to compare eqtls detected by the kruskal - wallis test to eqtls detected by the parametric anova and linear model methods . </S>",
    "<S> we found that the kruskal - wallis test is more robust against data outliers and heterogeneous genotype group sizes and detects a higher proportion of non - linear associations , but is more conservative for calling additive linear associations . in summary , krux enables the use of robust non - parametric methods for massive eqtl mapping without the need for a high - performance computing infrastructure and is freely available from http://krux.googlecode.com . </S>"
  ]
}