{
  "article_text": [
    "the main motivation for the present paper is the study of functional traits in evolutionary biology and quantitative genetics .",
    "evolutionary biology investigates the change of physical traits ( phenotypes ) across generations .",
    "some traits are univariate or multivariate , but others are functional , like growth curves or thermal performance curves ( kirkpatrick and heckman , 1989 ; heckman , 2003 ; kingsolver et al . , 2002 ;",
    "meyer and kirkpatrick , 2005 ; ragland and carter , 2004 ) . understanding the modes of variability of these curves is important in order to understand the biological processes behind the trait , and in particular the genetic aspects of it .",
    "consider for example the flour - beetle growth curves shown in figure fig : curves(a ) ( see irwin and carter , 2013 , for details about these data ) .",
    "they are mass measurements of larvae from hatching to pupation .",
    "the dataset consists of 122 half - siblings sired by 29 fathers and different mothers .",
    "a distinct characteristic of these curves is an inflection point around day 15 ; this is the time when larvae stop eating and begin searching for a place to pupate .",
    "this process is triggered by hormonal mechanisms whose timing varies from individual to individual ; determining what proportion of the time variability can be attributed to genetic factors and what proportion can be attributed to environmental factors is important for understanding the evolution of development and growth .",
    "similarly , in the study of thermal performance curves ( which are functions of temperature , not time ) , the optimal temperature varies from individual to individual and characterizing the sources of this variability is important for understanding thermal adaptations ( huey and kingsolver , 1989 ; izem and kingsolver , 2005 ) .",
    "we can see , then , that functional samples usually present two types of variability : what we can denominate horizontal  or phasevariability ( e.g.  variability in the location of the mass peaks in figure [ fig : curves](a ) ) and vertical  or amplitude  variability ( e.g.  variability in the mass magnitude at the peak in figure [ fig : curves](a ) ) .",
    "it is important to point out that for a given data set there is often some ambiguity about what constitutes amplitude variability and what constitutes phase variability ( this will be discussed in more depth in section sec : background ) .",
    "the problem of decomposing functional variability into amplitude and phase variability has been addressed by many authors ( kneip and engel , 1995 ; ramsay and li , 1998 ; wang and gasser , 1999 ; kneip et al . , 2000 ; gervini and gasser , 2004 , 2005 ; kneip and ramsay , 2008 ; tang and mller , 2008 ; telesca and inoue , 2008 ; bigot and gadat , 2010 ; claeskens et al . , 2010 ) .",
    "all of these papers , however , have focused on independent and identically distributed samples of curves , but for the type of applications we have in mind the curves are not independent .",
    "for example , the growth curves in figure [ fig : curves](a ) are correlated for individuals with the same father .",
    "this type of design is common in evolutionary biology and quantitative genetics for the following reason .",
    "the variability observed in physical traits has two sources : genetic and environmental . because environmental factors generally are not passed from one generation to the next , the evolution of phenotypes is driven largely by genetic variability ( but see skinner et al . , 2010 and manikkam et al . , 2012 for a discussion of epigenetic effects ) .",
    "examining samples of genetically related individuals , like siblings or half - siblings , makes the genetic and environmental sources of variability mathematically identifiable and therefore estimable , allowing biologists to predict the evolution of traits in response to selection ( gomulkiewicz and beder , 1996 ; kingsolver at al . , 2002 ) .",
    "therefore , it is important to possess statistical tools for the study of amplitude and phase variability of non - independent functional data .",
    "some existing functional - data methods handle non - independent or non - identically distributed curves , such as mixed - effects anova models ( guo , 2002 ; morris and carroll , 2006 ; di et al . , 2009 ; chen and wang , 2011 ) , but they do not specifically address phase variability . to date , the problem of amplitude / phase variability of functional traits has been addressed mostly in an ad - hoc way , by first aligning the curves with respect to some trait , and then studying amplitude variability of the aligned curves .",
    "( this process of aligning curves is variously known as time warping  or curve registration  in the functional data literature . ) but evolutionary biologists frequently must make decisions about how to align or register individual curves from a population of individuals .",
    "for example , when studying growth curves in a population of animals that undergo metamorphosis from one life history state to another ( usually from a non - reproductive larval form to a reproductive adult form ) , it is not necessarily clear how to align the individual curves . the default choice for most biologists is to align the curves at the date of birth or hatching , but an equally valid choice might be the date of metamorphosis or the peak body mass prior to metamorphosis .",
    "for example , ragland and carter ( 2004 ) chose to align the growth curves of larval salamanders by date of metamorphosis and then reset the growth period to a fractional scale .",
    "although this approach was effective , it was unsophisticated and ad hoc ; more rigorous methods would be beneficial .    in this paper",
    "we propose a functional anova approach that explicitly models time variability . for simplicity",
    ", we consider only the one - way random factor model , but the ideas can be easily extended to more complex anova models .",
    "we follow a likelihood - based approach that uses the raw data directly , without pre - smoothing .",
    "therefore the method can be applied to irregularly sampled trajectories , with possibly different starting points and endpoints .",
    "the fact that pre - smoothing is not necessary makes the method applicable to longitudinal data , where a smooth latent process is assumed but the observed data themselves are not smooth ( rice , 2004 ; mller , 2008 ) .",
    "the paper is organized as follows : a brief background on random processes is given in section [ sec : background ] ; the warped anova model is presented in section [ sec : model ] ; the asymptotic distribution of the main parameter estimators is derived in section [ sec : inference ] ; the small sample behavior of the estimators is studied by simulation in section sec : simulations ; finally , the beetle growth data is analyzed in detail in section [ sec : example ] .",
    "before we present the warped anova model , it is useful to review some basic properties of stochastic processes",
    ". let @xmath0 be a random function defined on a finite interval @xmath1 .",
    "suppose @xmath2 is square - integrable with probability one , and has finite variance .",
    "let @xmath3 and @xmath4 .",
    "then @xmath2 admits the decomposition @xmath5which is known as karhunen ",
    "love decomposition ( ash and gardner , 1975 ) , where the @xmath6s are uncorrelated random variables with @xmath7 and @xmath8 ( without loss of generality we can assume @xmath9 ) .",
    "the @xmath10s form an orthonormal system in @xmath11 and are eigenfunctions of the covariance function @xmath12 with eigenvalues @xmath13 ; that is , @xmath14 , which implies @xmath15if the covariance function @xmath12 is continuous then ( [ eq : kl_decomp ] ) and ( [ eq : spectral_decomp ] ) converge pointwise ; otherwise the convergence is only in the sense of the @xmath11 norm ( gohberg _ et al .",
    "_ , 2003 ) . in either case ,",
    "@xmath16 , so the sequence of eigenvalues converges to zero .",
    "the karhunen ",
    "love decomposition is the functional equivalent of the multivariate principal - component decomposition .",
    "although from a mathematical point of view decomposition ( [ eq : kl_decomp ] ) always holds , from a statistical point of view it is not always the most parsimonious model .",
    "it is often the case that the sample curves present a few distinct peaks and valleys that systematically repeat themselves across curves , albeit at somewhat different locations .",
    "it may take a lot of terms in ( [ eq : kl_decomp ] ) to explain this kind of variability , but kneip and ramsay ( 2008 , proposition 1 ) show that if the process @xmath2 has at most @xmath17 peaks and valleys and its derivative @xmath18 has at most @xmath17 zeros , then @xmath2 admits the decomposition @xmath19for some @xmath20 , where the @xmath21s are non - random basis functions , the @xmath22s are random coefficients , and @xmath23 is a monotone increasing stochastic process such that @xmath24 ( or alternatively @xmath25 , where @xmath26 is the inverse function of @xmath27 . ) we can re - express ( [ eq : kneip_exp ] ) as @xmath28which is just the karhunen ",
    "love decomposition of the warped process @xmath29 .",
    "the process @xmath30 is called the warping process , and it explains the horizontal  variability in the location of the peaks and valleys of @xmath31 .",
    "it is important to point out that the karhunen ",
    "love decomposition ( eq : kl_decomp ) is essentially unique ( up to the usual indeterminacy of eigenfunctions for multiple eigenvalues ) , and so is ( eq : warped_kl_decomp ) for a given warping process @xmath30 ; but the warping process @xmath30 itself is not unique . for a given @xmath2 , different warping processes @xmath26 can be chosen that will give rise to different decompositions ( [ eq : warped_kl_decomp ] ) .",
    "in general , it is not possible to uniquely define what constitutes amplitude  variability and what constitutes phase  variability for a given process @xmath2 .",
    "the approach usually followed in the literature is to specify a warping family @xmath32 where @xmath26 is constrained to live , and then define as phase variability whatever is accounted for by the family @xmath32 and as amplitude variability whatever is accounted for by the residual decomposition ( eq : warped_kl_decomp ) .",
    "this may sound vague , but in fact it is possible to give simple conditions for model ( [ eq : warped_kl_decomp ] ) to be identifiable given a family @xmath32 ; see the discussion in web appendix e. some authors choose very rigid warping families @xmath32 , like linear warping functions ( sangalli _ et al . _ , 2010 ) , while others use extremely flexible nonparametric families ( telesca and inoue , 2008 ; ramsay and li , 1998 ) .",
    "we will follow an intermediate approach , using the semiparametric family of interpolating monotone hermite splines ( fritsch and carlson , 1980 ) , although the proposed method can be implemented with any other warping family .",
    "monotone interpolating hermite splines are defined as follows ( more details are given in web appendix c ) . for a subject @xmath33 , let @xmath34 be a vector of landmarks  in @xmath35 $ ] , with @xmath36 ; the @xmath37s can be , for example , the locations of the peaks and valleys of the observed curve .",
    "let @xmath38 be a knot vector , usually taken as the mean of the @xmath39s . for given values @xmath40",
    ", there exists a unique piecewise cubic function @xmath41 such that @xmath42 , @xmath43 , @xmath44 for all @xmath45 , @xmath46 , @xmath47 , and @xmath48 for all @xmath45 .",
    "this function @xmath41 aligns the individual features @xmath39 with the average features @xmath49 in a smooth way , so it is useful for landmark registration  ( bookstein , 1997 ) . for @xmath41 to be strictly monotone increasing the derivatives @xmath50s must satisfy certain conditions , given in fritsch and carlson ( 1980 ) .",
    "but for curve - alignment purposes only the @xmath39s are specified ; in that case fritsch and carlson ( 1980 ) provide an algorithm that produces a vector of derivatives @xmath51 that satisfy the sufficient conditions for @xmath41 to be monotone increasing . since the algorithm is deterministic , @xmath51 is a function of @xmath39 and @xmath49 , therefore @xmath41 is entirely parameterized by @xmath39 and @xmath49 . in this paper , instead of specifying @xmath39 for each curve and taking @xmath52",
    ", we will specify @xmath49 and treat the @xmath39s as unobserved random effects .",
    "our family of warping functions @xmath53 , then , is an @xmath54-dimensional space ( @xmath54 will usually be small ) . in general",
    ", it is not problematic to specify a reasonable @xmath49 for a given data set ; for example , for the curves in figure [ fig : curves](a ) a single knot at @xmath55 will provide reasonable warping flexibility , and the rest of the variation will be considered amplitude variability . for other warping families , such as monotone b - splines ( telesca and inoue , 2008 ) or smooth monotone transformations ( ramsay and li , 1998 ) ,",
    "the number and placement of the knots are harder to specify because they are not directly associated with curve features .",
    "let us go back now to the original problem of a one - factor design , where the sample of @xmath56 individuals can be separated into @xmath57 groups , with group @xmath33 containing @xmath58 individuals . for subject @xmath45 in group @xmath33",
    "we observe certain variable ( e.g.  mass ) at time points @xmath59 , obtaining observations @xmath60 .",
    "the number of observations @xmath61 as well as the time points may change from individual to individual .",
    "we assume @xmath62where @xmath63 are underlying smooth curves , no directly observable , and @xmath64 are i.i.d.@xmath65 random errors independent of the underlying @xmath66s .",
    "observational model ( eq : raw_data_model ) , which treats the smooth curves @xmath63 as latent variables , is the usual way to bridge functional data analysis and longitudinal data analysis ( mller , 2008 ) . as discussed in section sec : background , we can write @xmath67 for a warped process @xmath68 and a warping function @xmath69 . these will inherit the dependence structure of the @xmath70s , so we can assume @xmath71with @xmath72 and @xmath73 zero - mean random factors independent of each other and among themselves .",
    "for the main factor @xmath74 and the residual term @xmath75 we assume expansions analogous to ( [ eq : warped_kl_decomp ] ) : @xmath76@xmath77where @xmath78 and @xmath79 are orthonormal functions in @xmath11 , the @xmath80s are uncorrelated with @xmath81 and @xmath82 , and the @xmath83s are uncorrelated with @xmath84 and @xmath85 . without loss of generality",
    "we assume @xmath86 and @xmath87 .",
    "from ( [ eq : z_model ] ) , ( [ eq : kl_alpha ] ) and ( [ eq : kl_beta ] ) it follows that the total variance of @xmath68 , defined as @xmath88 with @xmath89 the usual @xmath90-norm , can be decomposed as @xmath91 , where @xmath92 is the main - factor variance and @xmath93 is the residual - factor variance . the ratio @xmath94is then the proportion of amplitude variability explained by the main factor . in section [ sec : inference ] we will derive asymptotic confidence intervals for @xmath95 .    the mean function @xmath96 and the karhunen ",
    "love components @xmath97 and @xmath79 are functional parameters that must be estimated from the data , using for instance semiparametric spline models .",
    "let @xmath98 be a spline basis in @xmath11 ( for simplicity we will use the same spline basis for all functional parameters , but this is not strictly necessary ) ; then we assume @xmath99 , @xmath100 , and @xmath101 , for parameters @xmath102 , @xmath103 and @xmath104 in @xmath105 .",
    "let @xmath106\\in \\mathbb{r}^{s\\times p}$ ] , @xmath107\\in \\mathbb{r}^{s\\times q}$ ] and @xmath108 @xmath109 .",
    "the orthogonality conditions on the @xmath10s and the @xmath110s translate into the conditions @xmath111 and @xmath112 for @xmath113 and @xmath114 .",
    "regarding the @xmath80s and @xmath83s in ( [ eq : kl_alpha ] ) and ( [ eq : kl_beta ] ) , we assume that @xmath115 follows a multivariate @xmath116 distribution with @xmath117 and that @xmath118 follows a multivariate @xmath119 distribution with @xmath120 . to summarize , the warped process ( eq : z_model ) is parameterized by @xmath102 , @xmath113 , @xmath114 , @xmath121 and @xmath122 .    for the warping functions @xmath69 we can not simply assume an additive model like ( [ eq : z_model ] ) with gaussian factors , because there are no monotone gaussian processes",
    "therefore , a more indirect approach is needed .",
    "we will assume the @xmath123s belong to the family of interpolating hermite cubic splines @xmath53 for a specified knot vector @xmath49 .",
    "we have seen in section [ sec : background ] that a @xmath124 is parameterized by a vector @xmath125 that can be treated as a random effect . however , due to the restriction @xmath126 we can not assume @xmath125 is normal .",
    "so we follow the approach of brumback and lindstrom ( 2004 ) and use the jupp ( 1978 ) transform @xmath127 , defined as @xmath128 for @xmath129 , which is an invertible transformation that maps vectors @xmath125 with increasing coordinates into unconstrained vectors @xmath130 . for the unconstrained vector @xmath131 we can assume a multivariate normal distribution and an additive anova model : @xmath132with @xmath133 and @xmath134 independent of each other and among themselves",
    ". we will also assume the @xmath131s are independent of the amplitude factors @xmath135 and @xmath136 , although a model with correlations between amplitude and warping factors can be set up ( see below ) .",
    "we take @xmath137 ; the covariance matrices @xmath138 and @xmath139 will be estimated from the data .",
    "in analogy with ( [ eq : h_z ] ) we define @xmath140which is the proportion of the warping variability explained by the main factor .",
    "putting together the models for @xmath68 , @xmath69 and the observational model ( [ eq : raw_data_model ] ) , we can derive the likelihood function for the observed data vectors @xmath141 . given a realization of the random effect @xmath142 ,",
    "which is determined by realizations of @xmath143 and @xmath144 , the corresponding warped time grids are @xmath145 , @xmath146 , and the corresponding warped b - spline matrices @xmath147 are given by @xmath148_{kl}=b_{l}\\{t_{ijk}^{\\ast } ( \\mathbf{\\theta } _ { ij})\\}$ ] .",
    "then @xmath149and the @xmath150s are conditionally independent given @xmath151 . if @xmath152 , we have @xmath153with @xmath154 , and the log - likelihood function is @xmath155 .",
    "the maximum likelihood estimators are @xmath156 .",
    "we compute them via the em algorithm .",
    "the implementation of the em algorithm presents certain complications arising from the orthogonality restrictions on @xmath113 and @xmath114 , which are discussed in detail in web appendix a.    in the rest of the paper we will use the estimators as presented above , but to conclude the section we discuss a few possible generalizations .",
    "first , it is possible to use other families of warping functions , such as b - splines with monotone increasing coefficients ( brumback and lindstrom , 2004 ; telesca and inoue , 2008 ) or smooth monotone transformations ( ramsay and li , 1998 ) .",
    "the problem is that the spline coefficients for these families can not be directly related to features of the sample curves in the way interpolating hermite spline coefficients can ; therefore , one may have to use a relatively large number of knots placed at somewhat arbitrary locations ( equally spaced , for example ) .",
    "this may result in a warping family that is too flexible and lead to overwarping ( i.e. , produce warping functions with flat parts that are close to singular ) . to prevent this ,",
    "the warping variability must somehow be penalized .",
    "this can be done by adding a penalty term to the log - likelihood function and minimize @xmath157 , where @xmath158 is a penalty parameter chosen by the user .",
    "second , it is possible to incorporate correlations between the warping process @xmath69 and the amplitude process @xmath68 .",
    "this can be done by assuming that @xmath159 and @xmath160 have joint normal distributions , for instance .",
    "the only change in ( [ eq : f_y ] ) would be that @xmath161 is replaced by the joint density @xmath162 and @xmath163 by @xmath164 .",
    "from the computational point of view this does not have a big impact , because the em algorithm can be easily modified to accommodate this ( a matlab implementation is available as supplementary material ) .",
    "but from a statistical point of view the results may be harder to interpret , and the extra @xmath165 covariance parameters that need to be estimated may affect the precision of the rest of the estimators if the sample size is not very large .    finally , we note that the assumption of normality of the random effects is mostly a working assumption to derive estimators .",
    "it is usually the case that properties like consistency and asymptotic normality of maximum likelihood estimators hold for broader families of distributions than the one they were derived for .",
    "but such a thorough asymptotic analysis is beyond the scope of this paper . instead , in section [ sec : simulations ] we will study by simulation the robustness of the estimators to at least some mild departures from normality . on the other hand ,",
    "if robustness to outliers is desired , this may be attained by substituting the normal distributions by multivariate @xmath166 distributions , as in gervini ( 2009 ) ; the normal em algorithm is easy to adapt for multivariate @xmath166 distributions .",
    "it is usually of interest in applications to determine if the main - factor variance is significantly different from zero or not . to this end , we derive in this section the asymptotic distributions of the maximum likelihood estimators and the variance ratios ( [ eq : h_z ] ) and ( [ eq : h_w ] ) , which can then be used to construct asymptotic confidence intervals and tests for @xmath95 and @xmath167 . for simplicity",
    ", we assume that _ ( i ) _ the true functional parameters @xmath96 , @xmath78 and @xmath79 belong to the spline space used for estimation , which is fixed , and _",
    "( ii ) _ the @xmath168s are identically distributed , so @xmath169 for all @xmath33 and the time grid @xmath170 is the same for all individuals . the asymptotic distribution of the estimators will be derived for @xmath171 and @xmath172 fixed , or in practical terms , for large  @xmath57 and small  @xmath172 ; this is the usual situation in random - effect one - way anova models .    under these conditions",
    "the standard maximum likelihood asymptotic theory applies : if @xmath173 , then @xmath174 , where @xmath175 $ ] is the fisher information matrix for the parameter @xmath176 .",
    "straightforward differentiation of ( [ eq : f_y ] ) , which is carried out in detail in web appendix b , gives @xmath177and @xmath178let @xmath179 and @xmath180 .",
    "since @xmath181 and @xmath182 , we obtain the following expressions :    @xmath183    @xmath184    and @xmath185the estimator @xmath186 is obtained replacing expectations by averages over @xmath187 .    the asymptotic distribution of ( [ eq : h_z ] )",
    "is derived via the delta method : since @xmath95 is a differentiable function of @xmath176 , @xmath188 with @xmath189and @xmath190the asymptotic variance of @xmath191 is then given by @xmath192    the asymptotic distribution of ( [ eq : h_w ] ) is derived in a similar way . if @xmath193 , then @xmath194 with @xmath195 $ ] , and @xmath196 with @xmath197 , where @xmath198and @xmath199then @xmath200as shown in web appendix b , differentiation of ( [ eq : f_y ] ) gives @xmath201and @xmath202where @xmath203 and @xmath204 denote the @xmath205th columns of @xmath206 and @xmath207 , respectively .",
    "then , if we define @xmath208 and @xmath209 , after some algebra we obtain : @xmath210@xmath211and @xmath212for @xmath129 and @xmath213 . as before , @xmath214 is obtained replacing expectations by averages .",
    "since the random - effect estimators @xmath215 , @xmath216 , @xmath217 and @xmath218 are by - products of the em algorithm , no extra computational costs are incurred in computing @xmath186 and @xmath214 .",
    "finally , we note that since @xmath191 and @xmath219 live in the interval @xmath220 $ ] , a transformation like @xmath221 usually provides a better normal approximation when @xmath191 or @xmath219 are close to the boundaries .",
    "the asymptotic variance of @xmath222 is given by @xmath223 .",
    "the simplest procedure to derive a confidence interval for @xmath224 in that case is to construct a standard confidence interval for @xmath222 and then back - transform the endpoints .",
    "in this section we study the finite - sample behavior of the new estimators by simulation . the main goals are to determine if the new method _ ( i ) _ represents a substantial improvement over common functional anova in presence of time variability , _ ( ii ) _ is at least comparable to the naive approach of pre - warping the data using an existing warping method , _ ( iii ) _ is robust to mild departures from the normality assumptions , and _",
    "( iv ) _ does not overfit , i.e.  is not worse than common functional anova in absence of time variability .    to this end",
    "we generated data from ten different models , all balanced , with @xmath225 groups and @xmath226 observations per group .",
    "the raw data ( eq : raw_data_model ) was sampled on an equally - spaced time grid of @xmath227 points in @xmath220 $ ] , and the noise variance was @xmath228 in all cases .",
    "the mean function was @xmath229 in all cases , where @xmath230 denotes the @xmath231 density function .",
    "the models considered were the following :    1 .   one - component models ( [ eq : kl_alpha ] ) and ( [ eq : kl_beta ] ) with no warping and @xmath232 . the variances were @xmath233 and @xmath234 , so @xmath235 .",
    "2 .   one - component models ( [ eq : kl_alpha ] ) and ( [ eq : kl_beta ] ) with no warping but with different components for @xmath236 and @xmath75 : @xmath237 as in model 1 , but @xmath238 . the variances @xmath239 and @xmath240 were as in model 1 .",
    "same @xmath236 and @xmath75 as in model 1 , but with a hermite - spline warping process @xmath26 with knot @xmath241 and variances @xmath242 and @xmath243 , so @xmath244 .",
    "same @xmath236 and @xmath75 as in model 2 , with warping @xmath26 as in model 3 .",
    "same @xmath236 and @xmath75 as in model 1 , but with a warping process @xmath26 with knots @xmath245 and covariance matrices @xmath246 and @xmath247 , so @xmath244 as before . 6 .",
    "same @xmath236 and @xmath75 as in model 2 , with warping @xmath26 as in model 5 . 7 .   same as model 4 , but the random factors @xmath248 and @xmath249 in ( eq : kl_alpha ) and ( [ eq : kl_beta ] ) have student s @xmath166 distributions with 4 degrees of freedom and scale parameters @xmath250 and @xmath251 ( so the variance ratio is still @xmath235 ) .",
    "same as model 4 , but the random factors @xmath248 and @xmath249 in ( eq : kl_alpha ) and ( [ eq : kl_beta ] ) have contaminated normal distributions @xmath252 and @xmath253 respectively , with @xmath254 and @xmath255 ( the variance ratio is still @xmath235 ) .",
    "9 .   two - component models ( [ eq : kl_alpha ] ) and ( [ eq : kl_beta ] ) , with @xmath232 , @xmath256 ( so that each pc is associated with amplitude variation at each peak ) , variances @xmath257 , @xmath258 , @xmath234 , @xmath259 ( so @xmath235 as in previous models ) , and a one - knot warping process as in model 3 . 10 .",
    "same @xmath236 and @xmath75 as in model 9 , with two - knot warping as in model 5 .    for each sample we computed the common ( un - warped ) anova estimator ,",
    "the warped anova estimator proposed in this paper , and a naive two - step warped anova estimator .",
    "the latter is computed as follows : first the curves are aligned by least - squares registration ( i.e.  minimizing @xmath260 over @xmath261s in @xmath262 ) and then the common anova estimators are computed on the warped data .",
    "we used cubic b - splines with 10 equispaced knots as basis functions for the functional parameters .",
    "as warping families we used interpolating hermite splines with @xmath241 for models 14 and 79 , and @xmath263 for models 56 and 10 . as error measures we used the bias , the standard deviation and",
    "the root mean squared error , defined as follows : if @xmath264 and @xmath265 is the estimator , then @xmath266^{1/2}$ ] , @xmath267^{1/2}$ ] and @xmath268 .",
    "some care must be taken with the principal components , because their sign is undefined : to determine the right  sign , we multiplied @xmath269 and @xmath270 by @xmath271 and @xmath272 , respectively .",
    "the estimation errors based on 200 monte carlo replications for each model are shown in table [ tab : simulations ] .",
    "the effect of warping is more clearly seen in the estimators of the principal components @xmath273 and @xmath274 . the common anova estimators , as expected , have the largest biases ; lacking a specific mechanism to handle time variability , common anova estimators @xmath275 and @xmath276 attempt to fit amplitude and phase variability at the same time and get severely distorted compared to the true @xmath273 and @xmath277 .",
    "the two warped estimators , on the other hand , can handle phase variability well .",
    "the maximum - likelihood estimator proposed in this paper always has smaller bias than the naive two - step approach ; this is to be expected , since the warping step of the two - step estimator minimizes variation about the mean @xmath278 without taking into account amplitude variability or the dependence structure in the data , whereas the maximum likelihood estimator explicitly models @xmath273 and",
    "@xmath277 . the down side of the new estimators is that , as always , the bias reduction provided by the more complex model is accompanied by a higher variance . however , looking at the total root mean squared errors , we see that the new estimators outperform the naive two - step estimators in almost all cases .",
    "this is also true for the non - normal models 7 and 8 , so the warped maximum likelihood estimators are robust to mild departures from normality .",
    "in this section we study mass growth curves of flour beetles from birth to pupation , from irwin and carter ( 2013 ) .",
    "a total of 122 insects are considered .",
    "this is a subset of a larger dataset that includes both siblings and half - siblings , but in order to apply the one - way anova model , which assumes independence between groups , we consider only the half - siblings .",
    "( the full data set can be modeled as a nested two - way anova , with the mother factor nested within the father factor . )",
    "the insects were sired by 29 different fathers , which will constitute the grouping variable .",
    "the number of insects per father varies between 2 and 5 , with a median of 4 .",
    "part of the raw data is shown in figure [ fig : curves](a ) ; for better visualization we only plotted half of the sample curves .",
    "the mass measures were taken about every 3 days early in the growth curve , and up to once per day late in the growth curve . however , only 18 of the 122 larvae were measured for mass for the first time on the day they hatched ; 76 were measured for mass for the first time on the second day , 22 on the third day , 5 on the fourth day , and one was not measured for mass until the seventh day .",
    "therefore , the starting points of the curves are unequal .",
    "the endpoints are also irregular , because larvae reached pupation at different points between days 16 and 25 . however , while the unequal starting points are due to missing data , the unequal endpoints are due to a well - defined biological landmark which is reached at different times .",
    "therefore we rescaled the time grids so that all trajectories end at the median pupation day 19 , but we did not align the starting points at day 1",
    ". we also took logarithms to stabilize the error variance .",
    "the rescaled log - data is shown in figure [ fig : curves](b ) .",
    "these curves have a noticeable inflection point around day 15 .",
    "this is because in response to hormonal changes occurring prior to pupation , larvae stop eating and start wandering in search of a place to pupate , and so lose body mass .",
    "therefore we fitted warped anova models with a single warping knot at @xmath55 .",
    "as spline basis we used cubic b - splines with 7 equispaced knots ; this gives a total of 9 basis functions , providing enough flexibility without excessive irregularity .",
    "we considered several anova models with equal number of components for the main factor and the residual term , ranging from 0 ( mean - only model ) to 3 components .",
    "the resulting parameter estimators were :    * for @xmath279 ( mean - only model ) : @xmath280 , @xmath281 , @xmath282 . * for @xmath283 : @xmath284 , @xmath285 , @xmath286 , @xmath287 , @xmath288 .",
    "* for @xmath289 : @xmath284 , @xmath290 , @xmath291 , @xmath292 , @xmath293 . * for @xmath294 : @xmath295 , @xmath285 , @xmath296 , @xmath297 , @xmath298 .",
    "overall , it seems that a single principal component is sufficient to explain amplitude variability , so we chose the model with @xmath283 .",
    "the fitted curves @xmath299 are shown in figure [ fig : fits](a ) and we see that they provide a good approximation to the data in figure [ fig : curves](b ) . the estimated warping functions @xmath300 are shown in figure fig : fits(b ) ; the time variability around day 15 , which is substantial , is captured well by these curves . the amplitude principal components @xmath301 and @xmath302 are shown in figure [ fig : fits](c ) ; to facilitate interpretation of the components we plotted @xmath303 together with @xmath304 in figure [ fig : fits](d ) .",
    "we see that @xmath301 and @xmath302 , which are very similar , explain variation in overall mass : individuals with positive pc scores tend to have trajectories above the mean and individuals with negative pc scores tend to have trajectories below the mean .",
    "the similarity between @xmath301 and @xmath302 has a biological explanation : the main factor of the anova model represents the genetic contribution of the father , while the residual term represents the genetic contribution of the mother together with environmental factors ( see e.g.  heckman , 2003 , sec .  3 ) . for a population in hardy - weinberg equilibrium ,",
    "the genetic contribution of both parents is identical , so the @xmath305s and the @xmath306s will be similar if the environmental factors are not very strong .",
    "supporting this result is the fact that irwin and carter ( 2013 ) showed that most of the phenotypic variance was explained by genetic effects in most parts of the growth curve .",
    "the amplitude principal components reveal a very interesting biological result that was not apparent in the original analysis of the raw data in irwin and carter ( 2013 ) : very little variation in amplitude exists at the inflection point at day 15 ( figure [ fig : fits](c ) and [ fig : fits](d ) ) .",
    "this indicates that the beetles have a target peak mass that is reached prior to entry into the wandering phase , which suggests that the target peak mass must be reached before pupation can begin , and that selection for that peak mass ( or a related physiological trait ) may occur .",
    "interestingly the warping functions shown in figure [ fig : fits](b ) , as well as the original analysis in irwin and carter ( 2013 ) demonstrate there is substantial variation at the age at which peak mass is reached . in combination",
    "these two results provide a basis for future experiments investigating physiological mechanisms , genetic underpinnings and evolutionary implications of size and age of peak mass .",
    "the variance ratios for the amplitude and warping components are @xmath307 and @xmath308 , with respective asymptotic standard deviations @xmath309 and @xmath310 .",
    "the bootstrap distributions of @xmath191 and @xmath219 are shown in web appendix d ; the bootstrap standard deviations are @xmath311 and @xmath312 respectively , not far from the asymptotic values , but the normal approximation is more accurate for the transformations @xmath313 and @xmath314 .",
    "the 90% asymptotic confidence intervals obtained by the back - transformation method are @xmath315 for @xmath95 and @xmath316 for @xmath167 .",
    "clearly the father effect is strong on the amplitude component , but weak on the warping component .",
    "this can be cross - checked by applying the classical anova @xmath317-test on the estimated random effects @xmath318s : it yields a @xmath319-value of @xmath320 for the hypothesis of no father effect ( the reasonableness of the normality assumption on the random factors is also discussed in web appendix d. ) the reason the father effect is weak on the warping component is that we removed a lot of time variability by aligning the endpoints at the median pupation day .",
    "in fact , the anova @xmath317-test on the original endpoints yields a @xmath319-value of @xmath321 , indicating that there is a significant father  effect on the date of pupation ; this is also supported by irwin and carter ( 2013 ) demonstrating a highly significant heritability ( genetic variance ratio ) for date of pupation in the full sample .",
    "but once the endpoints are aligned , the time variability that remains , although still substantial , does not have a strong father effect .",
    "if we assume @xmath322 , which is not unreasonable given figure fig : fits(c ) , then ( [ eq : z_model ] ) comes down to @xmath323 and the classical anova @xmath317-test can be applied to @xmath324 .",
    "this gives a very significant @xmath317-value @xmath325 with @xmath319-value @xmath326 , confirming that the father effect is very strong on the amplitude variability of the growth curves .",
    "as indicated at the end of section [ sec : model ] , a more general model with correlations between amplitude and warping components can be set up .",
    "we fitted a one - component model with correlations for these data and obtained estimators @xmath269 and @xmath270 very similar to the ones obtained above , and correlations @xmath327 and @xmath328 , which do not seem very significant .",
    "the statistical significance of these correlations could be studied , for instance , by bootstrap confidence intervals , but for brevity s sake we will not do it here .    finally , it is important to note that for the unaligned raw data , variation in the length of the larval period and the onset of the wandering phase resulted in crossing of family curves late in the larval period ( irwin and carter , 2013 ) .",
    "after application of the warping method , the warped curves are aligned by peak body mass at the onset of the wandering phase , resulting in family curves late in the larval period that maintain relative positions similar to early in the larval period .",
    "this realignment undoubtedly will facilitate estimation of genetic components of variance , a proposition that we can test in the future .",
    "web appendices referenced in sections 36 and matlab programs implementing the new estimators are available with this paper at the biometrics website on wiley online library .",
    "this research was supported by national science foundation grant dms-1006281 to daniel gervini , nsf grant ef-0328594 to patrick a.  carter and a grant from the national institute for mathematical and biological synthesis to patrick a.  carter .",
    "ash , r.b . , and gardner , m.f . ( 1975 ) .",
    "_ topics in stochastic processes_. academic press .",
    "claeskens , g. , silverman , b. w. , and slaets , l. ( 2010 ) . a multiresolution approach to time warping achieved by a bayesian prior  posterior transfer fitting strategy .",
    "_ journal of the royal statistical society series b _ * 72 * 673694 .",
    "manikkam , m. , guerrero - bosagna , c. , tracey , r. , haque , m. , and skinner , m. ( 2012 ) .",
    "transgenerational actions of environmental compounds on reproductive disease and identification of epigenetic biomarkers of ancestral exposures .",
    "_ plos one 7_."
  ],
  "abstract_text": [
    "<S> this article presents an analysis of variance model for functional data that explicitly incorporates phase variability through a time - warping component , allowing for a unified approach to estimation and inference in presence of amplitude and time variability . </S>",
    "<S> the focus is on single - random - factor models but the approach can be easily generalized to more complex anova models . </S>",
    "<S> the behavior of the estimators is studied by simulation , and an application to the analysis of growth curves of flour beetles is presented . </S>",
    "<S> although the model assumes a smooth latent process behind the observed trajectories , smootheness of the observed data is not required ; the method can be applied to the sparsely observed data that is often encountered in longitudinal studies .    </S>",
    "<S> _ key words : _ karhunen  love decomposition ; longitudinal data ; phase variability ; quantitative genetics ; random - effect models . </S>"
  ]
}