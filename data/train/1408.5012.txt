{
  "article_text": [
    "currently , the only absolutely secure way through which two parties ( alice and bob ) can , at least theoretically , secretly share a random sequence of bits ( key ) is given by quantum cryptography , whose security is guaranteed by the validity of the laws of quantum mechanics @xcite .",
    "this secret key is the most important ingredient in the implementation of classical cryptography protocols , such as the one - time pad , which are provably secure if the key is only known to alice and bob .",
    "the original qkd protocols are based on single photons ( `` discrete '' states ) , requiring photon - counting techniques to their implementation @xcite . however , single photon detectors are not as efficient and fast ( short response time ) as standard telecommunication pin photodiodes used to detect bright light ( many photons ) @xcite . in quantum mechanics these bright quantum states",
    "are described by the quadratures of a mode of the quantized electromagnetic field and are also known as cv states due to the continuum spectrum of the quadratures . in order to explore the efficient and fast measurement schemes for such states ( homodyne or heterodyne detection ) , qkd protocols based on several types of cv states and strategies",
    "were proposed @xcite .",
    "they are all called cvqkd protocols @xcite and are considered theoretically secure @xcite .",
    "the quantum resources of the first cvqkd protocols @xcite , whose security was equivalent to discrete qkd protocols , were either single - mode squeezed states , sent from alice to bob , or two - mode entangle squeezed states shared between them . in these early schemes",
    "the secret key was encoded either in binary alphabets composed of two different coherent states ( discrete modulation ) @xcite or in coherent states with real and imaginary quadratures chosen from gaussian distributions ( continuous modulation ) @xcite .",
    "an important development of cvqkd appeared in @xcite , where it was shown that coherent states are equally secure to generate a secret key between alice and bob if one uses a gaussian continuous modulation and if the transmission losses from alice to bob does not exceed @xmath0 .",
    "subsequently , in @xcite it was shown that if bob accepts only certain measurement outcomes ( postselection ) to generate the key , or if alice and bob employ reverse reconciliation techniques @xcite , they can surpass the @xmath0 loss threshold . also , by employing at the same time reverse reconciliation and postselection one gets the greatest secure key rates @xcite .",
    "a reconciliation technique is an error correction scheme implemented at the end of the protocol by alice and bob , in which they execute a set of tasks in order to agree on common sequence of bits .",
    "this process is called direct if alice , who sends the quantum states , communicates classically with bob , who then processes his data using a predetermined algorithm to agree with alice s random sequence of bits .",
    "reverse reconciliation is the opposite scenario , where bob communicates with alice , who now manipulates her data in order to share a common key with bob .",
    "so far , there is no cvqkd protocol that is secure for any value of loss that uses only direct reconciliation and no postselection .        in this article",
    "we show a different way to do cvqkd that is secure for losses up to 100@xmath2 without resorting to either reverse reconciliation or postselection .",
    "since this protocol works deterministically ( no postselection ) and uses a discrete modulation for the key , it achieves fairly high key rates over long distances , even assuming the usual conservative reconciliation efficiencies for binary channels .",
    "apart from its possible practical significance , this protocol also adds to our fundamental understanding of cvqkd since it is based on the active use of cv teleportation ( cvt ) protocols @xcite , opening up alternative ways to understand the security of cvqkd as well as different routes for future unconditional security proofs .",
    "following @xcite , the main idea behind this teleportation - based cvqkd is the active use of the finite resources ( finite squeezing ) inherently associated to the cvt , combined with the knowledge of the pool of coherent states with alice to be teleported to bob @xcite .",
    "it is by properly making use of these two pieces of information that we can build a protocol furnishing high key rates even with @xmath1 loss , turning the finiteness of squeezing into an advantage .",
    "indeed , the cvt protocol is not simply employed as an alternative to the direct sending of the states with alice to bob , as required by the aforementioned standard cvqkd protocols , where the greater the entanglement of the channel the more a flawless teleportation is achieved with subsequent higher key rates . in the present protocol",
    ", however , less entanglement means more efficiency , since we will show that for a lossy transmission the amount of entanglement ( squeezing ) maximizing the key rate is finite and dependent on the level of loss and on the coherent states chosen for encoding the key .",
    "let start describing the protocol ( see fig .",
    "[ fig_esquema ] ) .",
    "first we note that the main ingredient of the present cvqkd scheme is the modified cvt protocol presented in @xcite , where the knowledge of the set of input states to be teleported by alice allows bob to get an output state at the end of the process nearly identical to the input state , even for low squeezing . to achieve that alice has to modify the beam splitter ( bs ) transmittance @xmath3 and bob has to modify the displacement @xmath4 on his mode from those given by the original cvt protocol @xcite , according to the pool of input states with alice . here",
    "@xmath5 ( @xmath6 ) is the annihilation ( creation ) operator of mode @xmath7 with quadratures @xmath8 and @xmath9 and commutation relation @xmath10=i/2 $ ] .",
    "alice divides her pool of coherent states into two sets , @xmath11 and @xmath12 , which we respectively call real and imaginary basis ( @xmath13 ) .",
    "alice and bob agree beforehand on the following binary encoding @xcite in order to associate from each coherent state a bit value to the key : @xmath14 and @xmath15 . at each run of the protocol",
    ", alice randomly chooses between the real and imaginary basis and then randomly picks one of the two states belonging to the chosen basis .",
    "let us generically call this state by @xmath16 , which is teleported to bob by means of a two - mode squeezed state @xmath17 , with squeezing parameter @xmath18 @xcite .",
    "@xmath17 is prepared by alice , who keeps one of its mode and send the other to bob . in order to finish her part in the teleportation",
    ", alice combines her share of the entangled resource with @xmath16 in a bs with transmittance @xmath3 . after measuring the position and momentum quadratures of the modes outgoing the bs , alice informs bob of her measurement results ( @xmath19 and @xmath20 ) .",
    "bob then randomly chooses between two possible types of displacements @xmath21 to implement on his mode ( @xmath22 ) , which we call real and imaginary displacements .",
    "these different types of displacements are given by different pairs of gains @xmath23 and are optimized in the following sense .",
    "the real ( imaginary ) displacement is such that bob s state , @xmath24 , has the greatest fidelity possible with alice s input if she chose the real ( imaginary ) basis and the least fidelity if her choice was the imaginary ( real ) basis . moreover , this is done such that the optimal @xmath23 do not depend on the sign of the coherent state but only on its being a real or imaginary state ( see appendix ) .",
    "the fidelity @xmath25 $ ] measures the similarity of two quantum states and in our case can be written as @xmath26 , where @xmath27 for orthogonal states and @xmath28 for identical ones . in fig .",
    "[ figfid ] we show the optimal values for these quantities ( see appendix ) .",
    "( color online ) optimized parameters giving the greatest ( least ) fidelity for a teleported real ( imaginary ) coherent state .",
    "the optimal settings for the greatest ( least ) fidelity for an imaginary ( real ) input are obtained from the ones above by interchanging @xmath29 with @xmath30 and changing @xmath31 to @xmath32 .",
    "the squeezing remains unchanged .",
    "the dashed curves give the standard settings for the original cvt @xcite.,width=302 ]    the next step of the protocol consists in bob once again displacing his state .",
    "he applies @xmath33 to his mode if he previously implemented the real displacement or @xmath34 otherwise .",
    "the goal of this last displacement is to transform the states @xmath35 or @xmath36 to vacuum states or to move farther from the vacuum the states @xmath37 or @xmath38 .",
    "these states nearly describes @xmath24 if alice chose the real ( imaginary ) basis and bob the real ( imaginary ) displacement in a given run of the protocol .",
    "after the last displacement bob measures the intensity of his mode and associates the bit @xmath39 if he sees no light ( vacuum state ) or the bit @xmath40 if he sees any light ( see fig .",
    "[ figprob ] ) .",
    "note that the previous step can be modified to any strategy aimed to discriminate between two coherent states , such as the measurement of the quadratures of @xmath24 using homodyne detection .",
    "( color online ) probabilities for bob detecting the vacuum state at the end of a run of the protocol if alice and bob uses the optimal settings given in fig .",
    "[ figfid ] .",
    "whenever bob assumes incorrectly the basis employed by alice , he can not discern between the two possible inputs ( star / blue curves ) .",
    ", width=302 ]    alice and bob repeat steps ( 1 ) to ( 7 ) until they have enough data to check for an eavesdropper and still get a secure key long enough for their purposes . after alice finishing all teleportations and after bob making all measurements",
    ", they use an authenticated classical channel to disclose the following information .",
    "alice reveals to bob the basis used at each run of the protocol but not the state .",
    "bob reveals to alice the instances where he used the optimal values of @xmath29 and @xmath30 matching the basis chosen by alice .",
    "they discard the data where no matches occurred and use a sample of the remaining data to determine the parameters of the quantum channel ( loss and noise ) and to check for security .",
    "then they error correct the non disclosed data ( reconciliation stage ) and generate a secret key via privacy amplification techniques .",
    "let us move to the security analysis , where we deal with individual ( incoherent ) attacks only . the intercept - resend attack , with an eavesdropper eve blocking bob s share of the entangled state ( mode 3 in fig .",
    "[ fig_esquema ] ) and sending him a fake mode , is not a serious threat .",
    "this is true because eve can not know alice s input with certainty _ before _ sending bob the fake mode . indeed",
    ", eve can only hope to know alice s input by knowing which basis she used and this only happens _",
    "after _ bob measures his mode .",
    "the most serious incoherent attack to the present and all cvqkd schemes is the bs attack , in which eve inserts a bs of transmittance @xmath41 in the optical line connecting alice and bob and operates on the signal reaching her in the same way as bob does .",
    "note that the bs attack is equivalent to a lossy transmission where @xmath42 of the signal is lost to the environment or eve . for direct reconciliation @xcite ,",
    "the secure key rate generated between alice and bob in the bs attack is @xmath43 where @xmath44 and @xmath45 are the mutual information between alice and bob and alice and eve , respectively .",
    "@xmath46 is the reconciliation efficiency and depends on the reconciliation software employed . for binary encodings that we use here",
    "it has a conservative value of @xmath47 @xcite . since the present protocol and the bs attack are symmetric with respect the real and imaginary states , in the following security analysis we consider only the case where alice used the real basis and bob the real displacement .",
    "a direct calculation gives ( see appendix ) @xmath48/2 ,   \\end{aligned}\\ ] ] where @xmath49 or @xmath50 , @xmath51 if @xmath52 , and @xmath53 is the unconditional ( no postselection ) probability of @xmath54 to assign the bit @xmath55 to the key if alice teleported the corresponding state that encodes the bit @xmath55 . in the present case",
    "@xmath56 means the probability of @xmath54 to detect the vacuum state at the end of a run of the protocol if alice teleports @xmath35 while @xmath57 is the probability of @xmath54 to detect any light if she teleports @xmath37 .",
    "note that @xmath53 depends on @xmath41 and that @xmath58 .",
    "( color online ) all plots : solid lines mean @xmath59 and dashed lines @xmath60 .",
    "main plot : for large values of @xmath61 we have from top to bottom increasing ( decreasing ) loss ( @xmath41 ) .",
    "inset : from the greatest to the lowest peak we have @xmath62 .",
    "note that for low loss @xmath63 for high values of @xmath61 only . for losses superior to @xmath0 , @xmath63 only for small @xmath61 .",
    ", width=302 ]    in fig .",
    "[ figkey ] we plot @xmath64 for several values of loss employing the parameters shown in fig . [ figfid ] .",
    "the inset shows that it is possible to choose a value of @xmath65 such that for @xmath66 and @xmath1 loss we get @xmath67 .",
    "this value should be contrasted with those without excess noise in @xcite , where by setting a perfect direct reconciliation ( @xmath68 ) and postselection one gets @xmath69 at @xmath70 loss , and with the ones in @xcite , where above @xmath71 loss it is not possible to extract a secret key via direct reconciliation . in other words , we improve the key rate at about one order of magnitude even assuming the worst case scenario . to get such enormous gain in the key rate",
    "we need a squeezing of about @xmath72 db .    fortunately the present scheme still works well for very low squeezing ( see fig .",
    "[ figloss ] ) . using for @xmath29 and @xmath30 their optimal",
    "previously obtained expressions when the matching condition occurs , @xmath64 becomes a function of only @xmath18 , @xmath31 , and @xmath41 .",
    "assuming the worst case scenario of @xmath1 loss and @xmath66 , we obtain the curves in fig .",
    "[ figloss ] fixing @xmath18 and maximizing @xmath64 as a function of @xmath31 ( see appendix ) .",
    "it is clear that for squeezing below @xmath73 db it is still possible to get a secure key and in tab .",
    "[ tab1 ] we show the maximum key rates attainable in fig . [ figloss ] for the different values of squeezing .     optimal key rates with @xmath1 loss as a function of @xmath61 . ,",
    "width=302 ]    .[tab1 ] maximal key rate @xmath74 for a fixed squeezing and the corresponding optimal parameters ( middle columns ) .",
    "here @xmath66 , @xmath75 ( @xmath1 loss ) , and we assume real inputs . [",
    "cols=\"^,^,^,^,^,^\",options=\"header \" , ]",
    "in summary , we proposed an efficient cvqkd scheme with a binary encoding for the key ( discrete modulation ) based on the cvt of coherent states , where the cvt protocol is not just a substitute to the direct sending of coherent states from alice to bob for the usual cvqkd protocols .",
    "rather , the resources needed to implement the cvt protocol play a direct role in the generation of the secret key since alice s bs transmittance , the squeezing of the entangled channel , and bob s displacement are all tuned in order to generate a secret key",
    ".    we showed that the present teleportation - based cvqkd protocol is secure against individual attacks and in particular that it works with direct reconciliation and no postselection for any value of loss in the optical channel connecting alice and bob .",
    "moreover , we showed that it is possible to achieve fairly high key rates with mild squeezing ( @xmath76 db ) even at the @xmath1 loss regime .",
    "this fact combined with the high repetition rates of cv technology may lead to efficient long distance qkd protocols .",
    "indeed , once a mildly squeezed two - mode entangled state channel is established between alice and bob , directly or via entanglement swapping techniques , they can generate a secret key using the present cvqkd scheme .",
    "finally , the present cvqkd protocol naturally leads to many interesting open questions .",
    "first , how robust is the present scheme to added excess noise at the transmission line ?",
    "second , can reverse reconciliation and/or postselection increase the key rates of this scheme and decrease even more the level of squeezing to generate a secure key ?",
    "third , how can one extend the individual security proof here for collective and coherent attacks ?",
    "fsl and gr thank cnpq ( brazilian national council for scientific and technological development ) for funding and gr thanks cnpq / fapesp ( state of so paulo research foundation ) for financial support through the national institute of science and technology for quantum information .",
    "here we show a schematic view of a single run of the protocol in a step by step description ( see fig .",
    "[ fig_esquema ] ) . in the next sections",
    "we will develop all the mathematical machinery needed to understand the protocol .",
    "a step by step description of a successful run of the protocol , generating a common random bit between alice and bob , is as follows : ( 1 ) alice randomly chooses between the real or imaginary coherent state `` basis '' and then randomly prepares @xmath77 or @xmath78 , respectively , to teleport to bob .",
    "the picture describes the case where alice chooses @xmath37 ( mode @xmath40 given by the solid / blue line ) .",
    "( 2 ) alice generates a two - mode squeezed entangled state ( modes @xmath73 and @xmath79 ) , whose squeezing parameter @xmath18 is chosen according to the value of @xmath65 , and sends mode @xmath79 to bob . (",
    "3 ) alice adjusts the beam splitter ( bs ) transmittance according to her choosing the real or imaginary basis and then sends mode @xmath40 to interact with her share of the two - mode squeezed state ( mode @xmath73 ) .",
    "( 4 ) she measures the position and momentum quadratures of the modes @xmath80 and @xmath81 , respectively , that emerge after the bs and classically informs bob of those results ( @xmath19 and @xmath20 ) . ( 5 ) bob randomly chooses @xmath82 from two possible pairs of values and implements a displacement operation on his mode given by @xmath21 , where @xmath22 .",
    "@xmath29 and @xmath30 are such that the fidelity of bob s output state with alice s input is greatest if she chooses a real ( imaginary ) state and he assumes a real ( imaginary ) state and , at the same time , least if she chooses an imaginary ( real ) state and he assumes a real ( imaginary ) state . the optimal pair ( @xmath29 , @xmath30 ) depends on the input being a real or imaginary coherent state but not on its sign .",
    "( 6 ) bob implements another displacement on his mode , @xmath33 or @xmath34 , depending on the choice he made for the pair @xmath82 .",
    "the picture shows the case in which bob assumes alice chooses the real basis ( solid lines ) .",
    "had he assumed the wrong basis , which alice and bob will discover classically communicating after finishing the whole protocol , they would discard this run of the protocol .",
    "( 7 ) bob measures the intensity of his mode and assigns the bit value @xmath39 if he sees no light ( vacuum mode ) and the bit @xmath40 otherwise .",
    "alice and bob repeat steps ( 1 ) to ( 7 ) until they have enough data to check for an eavesdropper and still get a secure key .",
    "after alice finishes all teleportations and bob makes all measurements , they communicate using an authenticated classical channel to disclose the following information . alice tells bob the basis ( real or imaginary ) employed at each run of the protocol .",
    "bob tells alice the cases where he has employed the optimal values of @xmath29 and @xmath30 matching the basis chosen by alice .",
    "they discard the data where no matches occurred and use a part of the matched cases to determine the parameters of the quantum channel ( loss and noise ) and to check for security .",
    "the remaining data is error corrected ( reconciliation stage ) and used to generate a secret key via privacy amplification techniques .      a key ingredient to the present scheme is the cv teleportation protocol @xcite adapted to the case where alice and bob has a complete knowledge of the pool of possible states to be teleported @xcite .",
    "with such a knowledge , alice and bob can greatly improve the fidelity between the teleported state with bob and alice s input by changing certain parameters of the original proposal .",
    "our goal in this section is to review in a self contained way this modified cv teleportation protocol , following closely the presentation given in @xcite .",
    "let @xmath8 and @xmath9 be the position and momentum quadratures of mode @xmath7 , respectively , where @xmath5 and @xmath6 are the annihilation and creation operators with commutation relation @xmath83=1 $ ] .",
    "any input state with alice can be expressed in the position basis as @xmath84 where the integral covers the entire real line and @xmath85 .",
    "the entangled two - mode squeezed state shared between alice and bob can also be expressed in the position basis , @xmath86 with @xmath87 and @xmath88 . here",
    "the first two modes / kets are with alice and the third one with bob .",
    "using eqs .",
    "( [ input ] ) and ( [ canal ] ) the initial state describing all modes before the teleportation is as follows , @xmath89    the teleportation begins sending mode 1 ( input state ) and mode 2 ( alice s share of the entangled state ) into a bs with transmittance @xmath3 ( see fig .",
    "[ fig_esquema ] ) . if @xmath90 is the operator representing the action of the bs in the position basis we have @xcite @xmath91      in the next step alice measures the momentum and position quadratures of modes @xmath81 and @xmath80 , respectively . since alice will project mode @xmath81 onto the momentum basis , it is convenient to rewrite eq .",
    "( [ initial2 ] ) using the fourier transformation relating the position and momentum basis , @xmath95 this leads to @xmath96 let us assume alice obtains for the momentum of mode @xmath81 and for the position of mode @xmath80 the values @xmath20 and @xmath19 .",
    "thus , the state after the measurement is @xmath97 where @xmath98 is the identity operator acting on mode @xmath79 and @xmath99 is the probability of measuring momentum @xmath20 and position @xmath19 , with @xmath100 denoting the total trace .",
    "specifying to the position basis and using that @xmath101 and @xmath102 we have @xmath103 where bob s state is @xmath104 here @xmath105 and @xmath106 where eq .",
    "( [ psilinha ] ) was obtained using ( [ initial2b ] ) .    via",
    "a classical channel alice sends to bob her measurement results , allowing bob to displace his mode quadratures as follows , @xmath107 and @xmath108 .",
    "mathematically this corresponds to the application of the displacement operator @xmath109\\hat{p}+2iim[\\lambda]\\hat{x}}$ ] , with @xmath110 and @xmath111 denoting the complex conjugation . since @xmath112 and @xmath113 commute with their commutator glauber s formula applies , giving @xmath114im[\\lambda]}e^{-2ire[\\lambda]\\hat{p}}e^{2iim[\\lambda]\\hat{x}}$ ] and finally @xmath115        in order to estimate after a single run of the protocol the closeness of bob s state , @xmath119 , with the original one at alice s , @xmath120 , we use the fidelity @xmath121 in general @xmath122 depends on the input state @xmath16 , the measurement outcomes of alice ( @xmath19 and @xmath20 ) , the squeezing @xmath18 of the entangled two - mode squeezed state , @xmath31 , @xmath29 , and @xmath30 .",
    "also , f achieves its highest value ( @xmath28 ) if we have a flawless teleportation ( @xmath123 ) and its minimal one ( @xmath27 ) if the output is orthogonal to the input .",
    "we will be dealing with input states giving by coherent states , @xmath124 , with @xmath65 and @xmath125 reals , and to entangled two - mode squeezed states shared between alice and bob @xmath126 , where @xmath127 are fock number states with alice ( bob ) and @xmath18 is the squeezing parameter .",
    "when @xmath128 we have @xmath129 , the vacuum state , and for @xmath130 the unphysical maximally entangled einstein - podolsky - rosen ( epr ) state .",
    "the present cvqkd protocol is based on a binary encoding for the key such that @xmath135 , with @xmath65 a real number .",
    "these states are to be teleported from alice to bob randomly .",
    "let us explicitly analyze the case where alice chooses the real basis , namely , she teleports either @xmath35 or @xmath37 to bob .",
    "the calculations for the imaginary basis are similar and only the final results for this case will be given .        where @xmath137\\cos ( 2 \\theta ) \\tanh r + 4 g_u \\tilde{x}_u^2     \\sin\\theta + 4 g_v \\tilde{p}_v^2 \\cos \\theta \\right\\}\\tanh r\\\\     & & + \\tilde{x}_u^2 \\left[-g_u^2+\\frac{2}{\\cosh ^2r-     \\cos ( 2 \\theta )",
    "\\sinh ^2r}-2\\right]+\\tilde{p}_v^2 \\left[-g_v^2+\\frac{2}{\\cosh^2r+\\cos ( 2 \\theta ) \\sinh^2r } -2\\right ] , \\\\",
    "f_2(g_u , r,\\theta ) & = & g_u -\\{g_u   \\cos ( 2 \\theta ) \\tanh",
    "r+2   [ 1+g_u \\cos \\theta]\\sin \\theta\\}\\tanh r + 2      \\left(\\frac{1 } { \\cos ( 2 \\theta ) \\sinh",
    "^2r-\\cosh ^2r}+1\\right)\\cos \\theta , \\\\",
    "f_3(r,\\theta)&= & -\\frac{\\{\\cosh r-",
    "[ \\tanh r \\cos ( 2 \\theta ) + \\sin ( 2 \\theta ) ] \\sinh r\\}^2}{\\cosh ^2r- \\cos ( 2 \\theta ) \\sinh ^2r}. \\end{aligned}\\ ] ]      moreover , since @xmath30 only appears in the exponent and we want the maximum of @xmath122 , we maximize the exponent as a function of @xmath30 . differentiating the exponent with respect to @xmath30 and equating to zero we get @xmath140    inserting @xmath29 and @xmath30 back into @xmath122 we finally obtain @xmath141\\}^2}{\\cosh^2r-\\cos(2 \\theta ) \\sinh^2r } } \\hspace{-.1 cm } , \\label{fidre}\\end{aligned}\\ ] ] where we use the superscript `` re '' to remind us that this is the optimal @xmath122 for real inputs . also , it is important to note that the optimal expression for @xmath122 , as well as for @xmath29 and @xmath30 , do not depend on the measurement outcomes @xmath19 and @xmath20 obtained by alice .",
    "this is one of the reasons making the present cvqkd scheme yield high key rates without postselecting a subset of all possible measurement outcomes of alice .    for an imaginary input ,",
    "namely , either @xmath38 or @xmath36 , the roles of @xmath29 and @xmath30 are reversed . in order to have a solution for @xmath122 independent of the sign of the imaginary coherent state we fix @xmath30 .",
    "then , we maximize the exponent of @xmath122 as a function of @xmath29 .",
    "the final result is that we obtain the same expressions for @xmath29 and @xmath30 as given before for the real case and the following expression for the fidelity : @xmath142\\}^2}{\\cosh^2r+ \\cos(2 \\theta ) \\sinh^2r}}\\hspace{-.1cm}. \\label{fidim}\\end{aligned}\\ ] ]      the final calculations needed to determine the optimal @xmath18 and @xmath31 are as follows .",
    "we want @xmath18 and @xmath31 such that if alice chooses the real basis and bob assumes alice chose the real basis , @xmath144 is maximal and @xmath145 is minimal .",
    "this is achieved maximizing the following function : @xmath146.\\ ] ]    it is not possible to get simple closed analytical expressions for the optimal @xmath18 and @xmath31 and the whole maximization process is carried out numerically once the value of @xmath65 is specified .",
    "this is what was done to get the optimal data shown in fig .",
    "2 of the main text .",
    "the optimal parameters if alice chooses the imaginary basis and bob assumes alice chose the imaginary basis is obtained imposing that @xmath144 be minimal and @xmath145 be maximal .",
    "this is obtained maximizing the following function : @xmath147=\\pi^{\\text{re}}(r,\\pi/2-\\theta).\\ ] ] it is clear by the last equality that the optimal @xmath31 for the imaginary input is obtained from the optimal one for the real input by subtracting it from @xmath148 .",
    "the relations between the optimal settings for the real and imaginary inputs are as follows : @xmath149      the state with bob after finishing the teleportation protocol is given by eq .",
    "( [ bobfinal ] ) , where he has already implemented either the real or imaginary displacement on his mode . by real and imaginary displacements",
    "we mean that bob applied the displacement @xmath21 , with @xmath22 , using either the real ( @xmath150 and @xmath151 ) or imaginary ( @xmath152 and @xmath153 ) optimal parameters .    in the next step of the teleportation - based cvqkd protocol",
    ", he implements another displacement , which depends on whether he chose the real or imaginary displacement . for a previously real displaced mode he now applies the displacement @xmath33 and for a previously imaginary displaced mode he applies @xmath34 .",
    "the goal of these last displacements is to transform states nearly described by @xmath35 or @xmath36 to vacuum states and to push further away from the vacuum the states @xmath37 or @xmath38 .",
    "note that bob s state will be very close to one of those four states only if the `` matching condition '' occurred , i.e. , if alice teleported a real ( imaginary ) state and bob used the optimal settings presuming a real ( imaginary ) input by alice .    mathematically , the state after the last displacement is @xmath154 where @xmath155 or @xmath156 .",
    "the probability to detect the vacuum state is @xmath157 where we used that @xmath158 and @xmath159 . in eq .",
    "( [ q0 ] ) @xmath160 is the complex conjugate of ( [ in ] ) , with the subscript @xmath161 as a reminder to which coherent state the kernel @xmath162 refers to , and @xmath163 is given by eq .",
    "( [ bobfinal ] ) .",
    "figure 3 in the main text is a plot of @xmath164 for all possible combinations of input state by alice and displacement by bob when a matching condition occurs ( the first four curves from top to bottom ) .",
    "the fifth and sixth curves are @xmath164 averaged over all possible measurement outcomes @xmath19 and @xmath20 for alice , weighted by alice s probability to get @xmath19 and @xmath20 ( cf .",
    "( [ prob ] ) ) , @xmath165 this averaging is needed whenever the matching condition does not occur since @xmath164 depends on @xmath19 and @xmath20 in this case .",
    "[ fig3main ] for a reproduction of fig . 3 of the main text but this time with a different caption , where we employ the notation just developed to describe each one of the plotted curves .     the first curve is @xmath164 computed with the following parameters , @xmath166 .",
    "the second curve is @xmath164 for @xmath167 .",
    "the third curve is @xmath164 for @xmath168 .",
    "the fourth curve is @xmath164 for @xmath169 .",
    "the fifth curve is the averaged @xmath164 for @xmath170 .",
    "the sixth curve is the averaged @xmath164 for @xmath171 .",
    ", width=302 ]    we have also tested the robustness of the optimal settings by randomly and independently changing the optimal parameters about their correct values . as can be seen in fig .",
    "[ fignoise ] , the optimal settings are very robust , supporting fluctuations of @xmath172 about the optimal values for small and large @xmath65 . for small @xmath65 fluctuations of @xmath173",
    "is still tolerable .",
    "for each value of @xmath65 we have implemented @xmath174 realizations of random fluctuations about the input state , about the optimal values @xmath175 , and about @xmath176 .",
    "we worked with alice s sending a real state and bob assuming a real state .",
    "similar results are obtained for the imaginary matching condition .",
    "the red / square curves connects the maximal and minimal values for @xmath177 due to the random fluctuations assuming alice sent a negative real state .",
    "the gray dots between the red / square curves represent the value of @xmath177 at each realization .",
    "the black / circle curves has the same meaning of the red / square curves but assuming alice sent a positive real state .",
    ", width=302 ]      we want to study how the teleportation - based cvqkd protocol responds to a lossy channel , or equivalently , to the bs attack .",
    "this will allow us to determine the level of loss in which a secure key can be extracted via direct reconciliation and no postselection .",
    "we want to investigate the security of the present scheme to the bs attack . in the bs attack an eavesdropper ( eve )",
    "inserts a bs of transmittance @xmath41 , @xmath178 , during the transmission to bob of his share of the entangled two - mode squeezed state ( mode 3 in fig .",
    "[ fig_esquema ] ) .",
    "bob will receive a signal with intensity @xmath41 and eve the rest . with her share of the signal , @xmath42 , eve proceeds as bob in order to extract information of the key .",
    "the bs is inserted before bob receives his mode and therefore before he applies the displacements @xmath21 and @xmath179 , with @xmath155 or @xmath180 .",
    "bob s state before the insertion of the bs is @xmath181 as given in eq .",
    "( [ initial3 ] ) .",
    "hence , the joint state of bob and eve before the bs is @xmath182 with @xmath183 given by eq .",
    "( [ in ] ) with @xmath184 .",
    "but since @xmath185 we have after the bs ,      the last equality was obtained making the following change of variables , @xmath187 and @xmath188 .",
    "bob s state after the bs is given by the partial trace of the state @xmath189 with respect to eve s mode , @xmath190 . in the position basis",
    "we have @xmath191 where @xmath192 note that eve s state is @xmath193 , which is simply obtained from eq .",
    "( [ rhoboblosskernel ] ) by changing @xmath194 .    using the state @xmath195 ( @xmath196 )",
    "bob ( eve ) proceeds as explained before to finish all the steps of a single run of the teleportation - based cvqkd protocol .",
    "bob displaces his mode by @xmath197 , which depends on whether he assumed alice teleported a real or imaginary state , finishing the teleportation stage of the protocol .",
    "his state at this stage is @xmath198 .",
    "then he implements the last displacement @xmath179 , which depends on his first displacement as explained before , and measures the intensity of his mode .",
    "hence , bob s probability to detect the vacuum state ( no - light ) is @xmath199 \\nonumber \\\\ & = & \\langle -\\lambda -\\gamma| \\rho'_b|-\\lambda -\\gamma\\rangle , \\end{aligned}\\ ] ] where have made explicit that @xmath164 depends on the measurement outcomes of alice when @xmath200 , i.e. , when we have a lossy channel . in the position representation",
    "we have @xmath201 as before , we define the unconditional ( no postselection ) probability as @xmath202 and in fig .",
    "[ figbs ] we show its value for several values of loss .",
    "probability @xmath177 to detect the vacuum state for several values of loss ( @xmath42 ) , which increases ( @xmath41 decreases ) from top to bottom .",
    "the other parameters used to compute @xmath177 , namely , @xmath203 , and @xmath176 , were the optimal ones when the matching condition occurs .",
    "the remaining parameter , alice s input , was set to @xmath204 ( solid lines ) and @xmath65 ( dashed lines ) .",
    ", width=302 ]      for direct reconciliation the secure key rate between alice and bob is @xmath205 where @xmath46 is the reconciliation efficiency , @xmath44 the mutual information between alice and bob , and @xmath45 the mutual information between alice and eve . in what follows",
    "we will prepare the ground for defining and computing those mutual informations for our problem . also ,",
    "since the present teleportation - based cvqkd protocol is symmetric to both matching conditions , we will work with the one where alice teleported a real state and bob implemented the real displacement .",
    "let @xmath206 and @xmath54 be two binary discrete variables , whose possible values for @xmath206 are @xmath207 and for @xmath54",
    "are @xmath208 .",
    "if we associate variable @xmath206 to alice and adopt the convention @xmath209 we have @xmath210 where @xmath211 is the probability distribution associated to @xmath206 .",
    "this means that alice randomly chooses between the negative or positive coherent states at each run of the protocol .",
    "if we associate variable @xmath54 to bob we can define the conditional probability of bob assigning the value @xmath212 to his variable if alice assigned the value @xmath213 as @xmath214 . for the present protocol , and according to the encoding that alice and bob mutually agreed on for the key , the four conditional probabilities are @xmath215 where @xmath216 , the probability to detect the vacuum state , is given by eq .",
    "( [ q0 ] ) .",
    "if we define @xmath217 where @xmath218 is the probability to detect light , we have @xmath219 note that we have explicitly written the dependence of @xmath220 , @xmath221 , on alice s teleported state to remind us that we should compute it using the appropriate sign for @xmath65 .",
    "we can understand the previous conditional probabilities as follows . if alice teleports the state @xmath35 ( bit @xmath39 ) and bob displaces his mode by @xmath65 , for a faithful teleportation he will likely detect the vacuum state after that final displacement and assign correctly the bit @xmath39 .",
    "the chance for that happening is quantified by @xmath222 .",
    "he will obviously make a mistake , assigning erroneously the bit @xmath40 , if he does not detect the vacuum state .",
    "for that reason we have @xmath223 . in the same fashion ,",
    "if alice teleports the state @xmath37 ( bit @xmath40 ) and bob displaces his mode by @xmath65 , for a faithful teleportation he will very likely not detect the vacuum state and will correctly assign the bit @xmath40 .",
    "this event occurs with probability @xmath224 , which implies @xmath225 .",
    "he makes a mistake if he gets the vacuum state and therefore @xmath226 .",
    "since the conditional probability is related to the joint probability distribution @xmath227 by the rule @xmath228 we have @xmath229/2 , \\\\",
    "p_{xy}(0,1 ) & = & [ 1-q_1^b(\\alpha)]/2 , \\\\",
    "p_{xy}(1,1 ) & = & q_1^b(\\alpha)/2.\\label{pab4}\\end{aligned}\\ ] ] if we now use that @xmath230 we have @xmath231/2 , \\\\",
    "p_{y}(1 ) & = & [ 1+q_1^b(\\alpha)-q_0^b(-\\alpha)]/2 . \\label{pb2}\\end{aligned}\\ ] ]    the mutual information between alice and bob is defined as @xmath232\\ ] ] and a direct computation using eqs .",
    "( [ pa ] ) and ( [ pab1])-([pb2 ] ) gives @xmath233/2 .",
    "\\nonumber \\\\ \\label{iab}\\end{aligned}\\ ] ] here we have dropped the @xmath234 dependence since @xmath216 is always computed with @xmath204 and @xmath218 with @xmath65 .",
    "note that @xmath44 also depends on @xmath235 , and @xmath41 .    in order to obtain @xmath45",
    "we simply replace @xmath41 for @xmath42 in the expression for @xmath44 since @xmath236 if @xmath194 . using eq .",
    "( [ iab ] ) and the equivalent one for @xmath45 we can compute the secret key rate @xmath74 ( eq .",
    "( [ k ] ) ) .",
    "figure 4 in the main text was obtained this way , where we employed for each curve a different value for @xmath41 and for all of them the optimal values of @xmath237 , and @xmath29 assuming the real matching condition as given in fig . 2 of the main text .",
    "figure 5 of the main text , on the other hand , was obtained computing @xmath64 for several values of @xmath18 fixing @xmath238 ( @xmath1 loss ) and using eqs .",
    "( [ gur ] ) and ( [ gvr ] ) for @xmath29 and @xmath30 .",
    "@xmath31 was determined in such a way that it maximized @xmath64 for @xmath66 . as always , we assumed the real matching condition to fix the remaining parameters needed to evaluate @xmath64 , namely , alice s input was either @xmath239 or @xmath240 and bob s final displacement was @xmath33 .      to get a feeling of how the optimal parameters change as a function of @xmath65 , we show in fig .",
    "[ figr0p3 ] their values assuming @xmath241 and optimizing the key rate for several values of loss ( bs attack ) .",
    "note that the same features occurs for other values of @xmath18 .",
    "the upper panels show the key rate with @xmath60 optimized for a fixed value of squeezing ( @xmath242 or @xmath243 ) .",
    "the lower panels give the values of @xmath31 ( in radians ) , related to alice s bs transmittance ( @xmath3 ) , leading to the optimal key rate . the optimal @xmath29 and @xmath30",
    "are given by using these values of @xmath31 and @xmath242 to evaluate eqs .",
    "( [ gur ] ) and ( [ gvr ] ) .",
    "we assume the real matching condition . left upper panel : @xmath41 decreases from top to bottom .",
    "right upper panel : for solid lines @xmath41 decreases from top to bottom while for dashed lines we have the opposite behavior . left lower panel : @xmath41 increases from top to bottom .",
    "right lower panel : for solid and dashed lines @xmath41 decreases from top to bottom.,width=302 ]    we can see from fig .",
    "[ figr0p3 ] that for low loss ( high @xmath41 ) there exist two ranges for the values of @xmath65 where a secure key can be extracted .",
    "the greatest key rates occurs for @xmath244 but one can also get secure key for @xmath245 . for high losses",
    "( small @xmath41 ) , on the other hand , only when @xmath246 a secure key can be extracted .",
    "also , for losses up to @xmath0 ( @xmath41 from @xmath247 to @xmath248 ) the greater the loss the lower the key rate .",
    "interestingly , the behavior for losses greater than @xmath0 is the opposite .",
    "once you cross the border of @xmath0 loss , more loss means a better key rate .",
    "when the exact value of @xmath0 loss is used , no key rate can be achieved since bob s and eve s state are the same and , hence , they share the same level of information with alice .    assuming squeezing is a cheap resource",
    ", we can let @xmath18 , together with @xmath31 , be a free parameter in the maximization of the key rate . in this scenario , we get the results in fig .",
    "[ figopt ] for the optimal key rate .",
    "the optimal parameters leading to such key rates are given in fig .",
    "[ figpar ] .",
    "it is interesting to note that whenever we have loss ( @xmath249 ) the optimal squeezing is not the greatest value possible and that with more than @xmath0 loss , the greater the loss the better the key rates .",
    "also , in most of the cases the optimal squeezing is not greater than @xmath250 .     here",
    "both @xmath18 and @xmath31 are adjusted to get the optimal key rates with @xmath60 . for the curves with circles",
    ", @xmath41 decreases from top to bottom .",
    "the @xmath251 curve is over the x - axis since in this case the key rate is always zero . for the lines without circles",
    ", @xmath41 increases from top to bottom .",
    "we assume the real matching condition .",
    ", width=302 ]     optimal parameters leading to the key rates in fig .",
    "[ figopt ] . in the maximization process",
    "we have restricted @xmath18 from @xmath39 to @xmath79 while @xmath31 could assume any value .",
    "the optimal @xmath29 and @xmath30 are obtained using these values of @xmath31 and @xmath18 to evaluate eqs .",
    "( [ gur ] ) and ( [ gvr ] ) .",
    "right panels and for high values of @xmath65 : @xmath41 decreases from @xmath252 to @xmath253 from top to bottom .",
    ", width=302 ]      c. h. bennett and g. brassard , _ proceedings of the ieee international conference on computers , systems and signal processing , bangalore , india , 1984 _ , p. 175 ; a. k. ekert , phys . rev",
    ". lett . * 67 * , 661 ( 1991 ) ; c. h. bennett , phys . rev . lett . * 68 * , 3121 ( 1992 ) ; c. h. bennett , g. brassard , and n. d. mermin , phys . rev . lett . * 68 * , 557 ( 1992 ) .",
    "extensive reviews of the discrete variable protocols in @xcite and their descendants can be found in : n. gisin , g. ribordy , w. tittle , and h. zbinden , rev .",
    "phys . * 74 * , 145 ( 2002 ) ; v. scarani , h. bechmann - pasquinucci , n. j. cerf , m. duek , n. ltkenhaus , and m. peev , rev . mod . phys . * 81 * , 1301 ( 2009 ) ;            f. grosshans , g. van assche , j. wenger , r. brouri , n. j. cerf , and ph .",
    "grangier , nature ( london ) * 421 * , 238 ( 2003 ) ; m. legr , h. zbinden , n. gisin , quantum inf . comput . * 6 * , 326 ( 2006 ) ; j. lodewyck , t. debuisschert , r. tualle - brouri , and ph .",
    "grangier , phys .",
    "a * 72 * , 050303(r ) ( 2005 ) ; j. lodewyck , m. bloch , r. garca - patrn , s. fossier , e. karpov , e. diamanti , t. debuisschert , n. j. cerf , r. tualle - brouri , s. w. mclaughlin , and ph .",
    "grangier , phys .",
    "a * 76 * , 042305 ( 2007 ) ; p. jouguet , s. kunz - jacques , a. leverrier , ph .",
    "grangier , and e. diamanti , nature photonics * 7 * , 378 ( 2013 ) .",
    "t. hirano , h. yamanaka , m. ashikaga , t. konishi , and r. namiki , phys .",
    "a * 68 * , 042331 ( 2003 ) ; r. namiki and t. hirano , phys .",
    "a * 67 * , 022308 ( 2003 ) ; r. namiki and t. hirano , phys .",
    "lett . * 92 * , 117901 ( 2004 ) ; r. namiki and t. hirano , phys .",
    "a * 74 * , 032302 ( 2006 ) .",
    "weedbrook , a. m. lance , w. p. bowen , th .",
    "symul , t. c. ralph , and p. k. lam , phys .",
    "lett . * 93 * , 170504 ( 2004 ) ; a. m. lance , th .",
    "symul , v. sharma , ch .",
    "weedbrook , t. c. ralph , and p. k. lam , phys .",
    "lett . * 95 * , 180503 ( 2005 ) .",
    "s. pirandola , c. ottaviani , g. spedalieri .",
    "weedbrook , s. l. braunstein , s. lloyd , t. gehring , ch .",
    "s. jacobsen , and u. l. andersen , arxiv:1312.4104v2 [ quant - ph ] ; z. li , y .- c .",
    "zhang , f. xu , x. peng , and h. guo , phys .",
    "rew . a * 89 * , 052301 ( 2014 ) .",
    "see @xcite and in particular the following references for reviews on cvqkd protocols : s. l. braunstein and p. van loock , rev .",
    "phys . * 77 * , 513 ( 2005 ) ; ch .",
    "weedbrook , s. pirandola , raul garca - patrn , n. j. cerf , t. c. ralph , j. h. shapiro , s. lloyd , rev .",
    "phys . * 84 * , 621 ( 2012 ) .",
    "d. gottesman and j. preskill , phys .",
    "a * 63 * , 022309 ( 2001 ) ; f. grosshans and n. j. cerf , phys .",
    "lett . * 92 * , 047905 ( 2004 ) ; s. iblisdir , g. van assche , and n. j. cerf , phys . rev . lett . * 93 * , 170502 ( 2004 ) ; f. grosshans , phys",
    "lett . * 94 * , 020504 ( 2005 ) ; m. navascus and a. acn , phys .",
    "lett . * 94 * , 020505 ( 2005 ) ; m. navascus , f. grosshans , and a. acn , phys .",
    "* 97 * , 190502 ( 2006 ) ; r. garca - patrn and n. j. cerf , phys . rev . lett . * 97 * , 190503 ( 2006 ) ; r. renner and j. i. cirac , phys . rev . lett . *",
    "102 * , 110504 ( 2009 ) ; y .- b .",
    "zhao , m. heid , j. rigas , and n. ltkenhaus , phys .",
    "a * 79 * , 012307 ( 2009 ) ; ch .",
    "weedbrook , s. pirandola , s. lloyd , and t. c. ralph , phys .",
    "lett . * 105 * , 110501 ( 2010 ) ; a. leverrier , r. garca - patrn , r. renner , and n. j. cerf , phys . rev . lett . * 110 * , 030502 ( 2013 ) ; p. jouguet , s. kunz - jacques , and e. diamanti , phys . rev .",
    "a * 87 * , 062313 ( 2013 ) ; j .- z .",
    "huang , s. kunz - jacques , p. jouguet , ch .",
    "weedbrook , z .- q .",
    "yin , sh . wang , w. chen , g .- c .",
    "guo , and z .- f .",
    "han , phys .",
    "rev . a * 89 * , 032304 ( 2014 ) .",
    "l. vaidman , phys .",
    "a * 49 * , 1473 ( 1994 ) ; s. l. braunstein and h. j. kimble , phys .",
    "lett . * 80 * , 869 ( 1998 ) ; a. furusawa , j. l. srensen , s. l. braunstein , c. a. fuchs , h. j. kimble , and e. s. polzik , science * 282 * , 706 ( 1998 ) ."
  ],
  "abstract_text": [
    "<S> we show a continuous variable ( cv ) quantum key distribution ( qkd ) scheme based on the cv quantum teleportation of coherent states that yields a raw secret key made up of discrete variables for both alice and bob . </S>",
    "<S> this protocol preserves the efficient detection schemes of current cv technology ( no single - photon detection techniques ) and , at the same time , has efficient error correction and privacy amplification schemes due to its binary discrete key . in particular , it is secure for any value of the transmission efficiency of the optical line used by alice to share entangled two - mode squeezed states with bob ( no 3 db or @xmath0 loss limitation characteristic of beam splitting attacks ) . </S>",
    "<S> the present cvqkd protocol works deterministically ( no postselection needed ) with efficient direct reconciliation techniques ( no reverse reconciliation ) in order to generate a secure key , even at the surprisingly @xmath1 loss case . </S>"
  ]
}