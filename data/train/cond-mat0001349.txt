{
  "article_text": [
    "recently , the role of the canonical boltzmann - gibbs ensemble as the only useful ensemble for quantum statistics has been reevaluated .",
    "the need for reevaluation has arisen both from experimental and theoretical considerations .",
    "although the canonical ensemble works surprisingly well also for systems consisting of only a few particles , relativistic ion collisions have provided an arena where the corrections from the finite size of the system to the canonical results have become important @xcite . a quantitative understanding of these collisions is necessary since they are central in the search for new phases of strongly interacting matter , such as quark - gluon plasma .",
    "in addition , methods for a quantitative measurement of the properties of small quantum systems could be useful in industrial applications in the future , such as in the design of ever smaller electronic components . similarly , the functioning of certain biological systems seems to involve also the quantum behaviour of the system  consider , for instance , the recognition of molecules by olfactory receptors @xcite .",
    "the second motivation for non - canonical ensembles comes from the peculiar behaviour associated with systems with fractal - like structure .",
    "tsallis statistics @xcite was developed for the statistical analysis of these cases and we have considered other generalized statistics of that kind in a previous work @xcite . for `` ordinary '' systems , however , we found out that the so called gaussian ensemble is the simplest generalization of the canonical ensemble which could be used for the approximation of any precanonical system  these are systems for which the occupation of high - energy states decreases faster than exponentially . for a more complete description of precanonical and gaussian ensembles ,",
    "see @xcite and @xcite , respectively . of the non - canonical ensembles , we concentrate here only on the gaussian ensemble with the understanding that the results presented",
    "can be easily modified to apply for any precanonical ensemble .    in this work , we develop and prove the existence of a lattice approximation for a system of a fixed number of non - relativistic particles which may be fermions , bosons or a combination of both",
    ". the potential of this system can be very general , the only requirement being a fast enough increase at infinity .",
    "we do not consider the possibility of a creation or annihilation of particles  this would require the use of a quantum field theory instead of ordinary quantum mechanics and we would have to give up mathematical rigour in the transition .",
    "formulations of the microcanonical ensemble using quantum field theory and its perturbative expansion have already been proposed by chaichian and senda @xcite and our approach owes a lot to their work .",
    "we begin by defining notations and by stating assumptions we need to make on the potential in section [ sec : notations ] .",
    "we then state a theorem which defines and proves the convergence of the lattice approximation of traces at a complex temperature and we derive a set of lattice observables which can be used for the measurement of energy moments .",
    "the following section [ sec : canalg ] presents a monte carlo algorithm for the generation of the canonical lattice distribution and we also try to develop an intuitive understanding of it .",
    "section [ sec : gauss ] contains similar derivations for the gaussian ensemble , especially it contains an essentially canonical algorithm which can be used for the computation of the density of states .",
    "we conclude with an example where we test the algorithms in practice and comment on their strengths and draw - backs . we have also gathered a comparison of our methods to the ones presented in the literature along with suggestions for improvements in section [ sec : prologue ] .",
    "a good review of the state of the art of using monte carlo simulations for path - integrals of quantum fluids has been given by ceperley @xcite .",
    "consider a system of @xmath0 particles living in a @xmath1-dimensional space . in classical physics , this system is described by trajectories of these particles and the positions of the particles form the relevant degrees of freedom , an @xmath2-dimensional space with @xmath3 .",
    "we shall here choose the convention that the positions of particles are denoted by boldface letters with a subscript identifying the label of the particle while the classical configuration of the system is denoted by regular italics .",
    "for example , the @xmath2-dimensional configuration @xmath4 could be written in terms of the @xmath0 position vectors as @xmath5 .",
    "the lattice regularization of the quantum effects on this system is defined on a space containing @xmath6 copies of the classical configuration space .",
    "the `` lattice configurations '' are thus @xmath7-dimensional vectors and we shall put the number of the copy in parenthesis after the configuration symbol . in other words , the position of the particle @xmath8 in the copy @xmath9 in the lattice configuration @xmath4 is denoted by @xmath10 . the quantum results are recovered in the continuum limit , by which we mean here simply taking @xmath6 to infinity in the lattice regularized formulae given below .",
    "the following discussion applies to massive , non - relativistic particles which are bounded by a suitably strong potential and thus can be described by equilibrium ensembles . to simplify matters",
    ", we also assume that all masses have been scaled away by the transformation @xmath11 and we use the natural units where the planck and boltzmann constants are equal to one .    in summary , we assume that the hamiltonian of the system is given by @xmath12 and the precise conditions for the interaction potential are    1 .   [",
    "it : vcon ] @xmath13 is continuous and bounded from below . 2 .",
    "[ it : potcon ] @xmath14 for all @xmath15 .",
    "[ it : vperm ] @xmath13 is invariant under permutations of indistinguishable particles .    with the first condition , the hamiltonian can be defined in the sense of distributions ( theorem x.32 in @xcite ) and the continuity also ensures that the continuum limit will be simple  if the original potential is not continuous , it can be replaced by a suitable continuous approximation .",
    "the second condition requires a sufficiently fast growth of the potential at infinity and it gives the precise meaning for what we meant by a sufficiently binding potential earlier .",
    "the third requirement is more of a consistency condition than a restriction .",
    "the classical partition function of this system is defined by @xmath16 and clearly ( [ it : potcon ] ) is equivalent to the assumption that the classical partition function converges for all positive temperatures .",
    "it is also clear that if @xmath13 is positive , which could be achieved by adding a constant to the potential , then @xmath17 decreases monotonically .    for the sake of simplicity",
    ", we shall now assume that there is only one kind of indistinguishable particles in the system .",
    "the generalization of the results to systems with many types of particles should be obvious .    for each element @xmath18 in the permutation group @xmath19 we can define a linear operator which performs the corresponding particle permutation by @xmath20 .",
    "these operators form a unitary representation of the permutation group , i.e.  all operators are orthogonal , @xmath21 .",
    "the determinant of an operator will also be equal to the parity of the corresponding permutation , denoted here by @xmath22 . with these notations ,",
    "the projection operator @xmath23 on the physical hilbert space can be defined by @xmath24 where @xmath25 and the upper sign is used for bosons and the lower for fermions .",
    "the trace of any trace - class operator @xmath26 over the physical subspace can also be obtained from @xmath27 note also that condition ( [ it : vperm ] ) is equivalent to requiring that @xmath28 for all permutations @xmath18 .",
    "we shall now state a theorem which can be used for getting lattice observables for energy moments and which proves the convergence of the continuum limit of the lattice approximation .",
    "we prove the theorem for the canonical case with a temperature that can have an imaginary part  this complex temperature trace is needed for the computation of the energy moments in precanonical ensembles as we shall see later .",
    "the proof of the theorem is given in [ sec : latproof ] .",
    "[ th : latconv ] define @xmath29 on the half - plane @xmath30 .",
    "then for all @xmath31 and @xmath32 , @xmath33 all of these functions are analytic on the right half - plane and the convergence is uniform on compact subsets of the half - plane . in addition , for any fixed @xmath9 and @xmath34 , these functions are uniformly bounded on the closed strip @xmath35 of the half - plane .",
    "the proof contains the following explicit representation for the traces on the right hand side @xmath36 where the `` lattice kernel function '' is defined by @xmath37\\ ] ] and the `` lattice kinetic energy '' @xmath38 and the `` lattice potential energy '' @xmath39 are @xmath40 this result is well - known and widely used , it was presented already in the classic work by feynman and hibbs @xcite .",
    "however , to our knowledge it has not been rigorously proven before that the lattice approximation of the complex temperature trace does not spoil any part of the result .",
    "note that theorem [ th : latconv ] is not a simple consequence of the trotter product formulae @xcite as these imply only strong convergence for our generators : we have to do more work for proving the convergence of the traces .",
    "the sum in ( [ e : trppm ] ) contains @xmath41 terms and thus its computation would be impossible for even fairly small values of @xmath0 .",
    "however , the result of the integral in fact only depends on the conjugate class of the permutation and thus the @xmath42 increase of the number of terms to compute can be reduced to an exponential @xmath43 increase . to be precise ,",
    "it is shown in [ sec : perms ] , that @xmath44 where @xmath45 is a representative of the conjugate class defined by the parameters @xmath46 as explained in [ sec : perms ] and @xmath47 counts the number of elements in the conjugate class , as given by equation [ e : defcnu ] .",
    "the sum goes over those decreasing sequences of @xmath0 non - negative integers whose sum equals @xmath0 ; in the above equation , @xmath48 is the kronecker symbol which ensures that the last condition holds .",
    "if all the terms in the sum are relevant , then only about @xmath49 can be handled by the above formula ( for @xmath50 there are @xmath51 terms in the sum ) .",
    "however , typically only a fraction of the terms are relevant and the sum can be used also for a larger number of particles . for real temperatures , the estimation of which terms will be relevant",
    "can be done fairly easily by using lemma [ th : ikbound ] given in [ sec : latproof ] . according to the lemma , for all @xmath15 , @xmath52,\\ ] ] where the right hand side is much easier to evaluate than the left hand side .",
    "this also gives one more proof of the well - known result that only the identity permutation is relevant for dilute gases , for which the typical classical distance between the particles is larger than the thermal wavelength @xmath53 .",
    "we shall next derive a set of lattice operators whose expectation values will converge in the continuum limit to the canonical expectation values of powers of the hamiltonian . by the results of section [ sec : deflat ] ,",
    "@xmath54 where we have moved the differentiation inside the integral  it is part of the proof in [ sec : latproof ] that this is allowed .",
    "by using the leibniz rule and a bit of algebra we can compute the derivatives , @xmath55 where @xmath56 j \\end{array}\\biggr ) } } v_l^{k - j }   \\sum_{i=0}^j    { { \\biggl (   \\begin{array}{@{\\,}c@{\\ , } } j \\\\[-2 pt ] i \\end{array}\\biggr ) } }   \\frac{(\\case12 l n-1+j)!}{(\\case12 l n-1+i ) ! }    ( -p_l)^i z^{-j - i } .\\ ] ] we call @xmath57 the lattice operator for the @xmath9:th energy moment .",
    "the complicated form might be a bit surprising  the lattice action , after all , is simple and it can be guessed from the expected continuum limit .",
    "we might thus expect to find a lattice hamiltonian equally easily , the guess `` @xmath58''=@xmath59 which goes to `` @xmath60 $ ] '' in the continuum limit , being most natural .",
    "in fact , the natural guess is not too far away , since by ( [ e : defqk ] ) @xmath61 measures the expectation value of the hamiltonian normalized by the inverse temperature @xmath62 .",
    "the important difference is that the other energy moments are _ not _ measured by @xmath63 .",
    "instead , each power needs a separate `` renormalization '' term , note that the extra factors all contain @xmath64 which diverges in the continuum limit .",
    "we have given ( [ e : defqk ] ) in a form from where it is apparent that it is the `` kinetic energy '' part of the hamiltonian , given by @xmath38 , which gets renormalized .",
    "this is very natural , since the path integration which gives the continuum results goes over continuous but non - differentiable paths and thus the derivatives should diverge in the continuum limit .",
    "in addition to ( [ e : defq1 ] ) we have @xmath65 which can be used for concluding that both the expectation value and variance of the lattice operator @xmath38 diverge as @xmath66 in the continuum limit .",
    "we saw in section [ sec : latmom ] that the term @xmath38 diverges proportionally to the lattice size @xmath6 in the continuum limit .",
    "on the other hand , @xmath39 has a finite continuum limit .",
    "consider generating the lattice kernel distribution @xmath67 by a straightforward metropolis algorithm @xcite , i.e.  make random , local , changes to the lattice configuration and keep the changes with the probability @xmath68 .",
    "since @xmath38 diverges , for large @xmath6 most changes will be rejected because of the large jump they cause in @xmath38 and the hit - rate of the metropolis algorithm is not very good .",
    "but , on the other hand , @xmath38 is a simple quadratic function which does not depend on the system , i.e.  on the potential or on the nature of the particles .",
    "we shall now present an algorithm which takes advantage of these simplifications and which behaves better for large @xmath6 .",
    "the aim is to generate the canonical lattice distribution for @xmath4 , @xmath69,\\ ] ] where @xmath18 is any permutation and @xmath15 .",
    "let us first separate the lattice copy containing the jump induced by the permutation and define @xmath70 . in the remaining @xmath71 integrals we make the following change of variables from @xmath4 to @xmath72 , @xmath73 where @xmath74 .",
    "the jacobian of this change of variables is one . as earlier , for @xmath75 and @xmath76 we define also @xmath77 and @xmath78 .",
    "the inverse relation is then @xmath79 which shows that @xmath80 a choice of other than a straight path @xmath81 does not lead to as simple a formula , since then there would be a cross term linking @xmath82 and @xmath72 which is absent for a path with constant increments of @xmath83 .    for reasons that will become apparent in the next section",
    ", we shall use a separate notation @xmath84 for the `` kinetic temperature '' .",
    "thus with the assumption that at this point @xmath85 , we can express the lattice integral as @xmath86\\label{e : genclass}\\\\   \\times \\int\\!\\!\\frac{\\rmd^{n(l-1 ) } v}{(2 \\pi)^{(l-1 ) n/2 } }     \\,\\rme^{-\\frac{1}{2 } v^2 } l^{\\frac{n}{2 } }    \\exp\\!\\bigg[-\\frac{1}{2 } \\sum_{i=1}^n   \\bigg|\\sum_{k=1}^{l-1 }    \\bi{v}_i(k)\\bigg|^2 \\bigg ]   \\label{e : genqf}\\\\   \\times \\exp\\!\\bigg\\{-\\frac{\\beta}{l }    \\sum_{k=1}^{l-1 } [ v(x(k))-v(y)]\\bigg\\},\\label{e : genrest } \\end{aligned}\\ ] ] where we have scaled the temperature away from the lattice fluctuations , i.e.  made the change of variables @xmath87 .",
    "this means that in the last line we have used the definition @xmath88 the algorithm consists of generating each of the distributions ( [ e : genclass]@xmath83 ) separately :    1 .",
    "compute the classical integral ( [ e : genclass ] ) .",
    "this is needed for the normalization of the next metropolis step and , by ( [ e : classbound ] ) , it can be used also for determining if a computation of the full term is necessary .",
    "use e.g.  a metropolis algorithm to generate the classical distribution in ( [ e : genclass ] ) for @xmath82 .",
    "[ it : genrw ] generate the distribution for @xmath89 by applying a metropolis check with normal distributed trials for each coordinate of @xmath89 .",
    "this can be done independently of the generation of @xmath82 and , in fact , each classical coordinate can also be generated separately .",
    "this problem is equivalent to the generation of a self - recurring one - dimensional random walk of @xmath6 steps , the cumulative sums of @xmath89 corresponding to the positions of the walker .",
    "note that the constants in ( [ e : genqf ] ) have already been chosen so that the result is a probability distribution .",
    "4 .   apply a metropolis check implied by ( [ e : genrest ] ) for the generated values of @xmath82 and @xmath89 .    in practice , it is best to store the values of @xmath90 and to use a separate routine for the generation of the trials for quantum fluctuations of each particle .",
    "the idea behind the algorithm is to generate a path of possible quantum fluctuations for a classically distributed particle and to test for the acceptance of the whole fluctuation path simultaneously .",
    "since @xmath38 does not enter this acceptance test at all , this avoids the large rejectance rate from which a local change made in just one copy suffers .",
    "but as the proposed change is not local , the evaluation of the last metropolis check is made more difficult and time - consuming  this should be more than compensated by the improved acceptance rate .",
    "let us also briefly comment on the generation of the classical distribution when @xmath18 is not the identity permutation .",
    "then @xmath18 has at least one cycle of length @xmath91 and assume , for simplicity , that it is composed of the first particle labels . by the same change of variables as before , i.e.  by defining @xmath92 ,",
    "we get then @xmath93 this is independent of @xmath94 , i.e.  of one of the particle positions . on the other hand",
    ", it also implies that the distance between any two particles is of the order of @xmath95 .",
    "it is thus possible to think of each @xmath96-cycle as describing a cluster of @xmath96 particles which move together in the external potential .",
    "similarly , especially for higher temperatures , it is best to generate the combinations @xmath97 from the gaussian distribution and use the potential only for @xmath94 and , of course , for the metropolis check .",
    "the gaussian ensemble has been introduced in @xcite , where its connections to the canonical and the microcanonical ensemble were also illustrated .",
    "the ensemble is defined by the unnormalized density operator @xmath98.\\ ] ] it was proven there that for any observable @xmath26 which satisfies the condition @xmath99 for all @xmath15 , we have the following integral representation @xmath100 where @xmath62 is a positive constant .    for numerical computations ,",
    "the proper choice of @xmath62 is very important .",
    "suppose we wish to examine the behaviour of the system near the energy scale @xmath101 using the energy resolution @xmath102 . at @xmath103 ,",
    "it was shown in @xcite that the best choice for @xmath62 is the unique positive solution to the equation @xmath104 in practice , it is usually easier to begin with the temperature @xmath105 and then solve @xmath101 from equation ( [ e : defe0 ] ) .",
    "the natural energy resolution parameter is then @xmath106 and as the energy parameter , it will be easiest to use the scaled difference @xmath107 .",
    "similarly , the moments are most naturally computed as @xmath108 we shall derive the gaussian lattice expressions for this set of moments  all others can , of course , be computed from these .    with the present assumptions , @xmath109 satisfies the condition for the use of the integral representation ( [ e : inta ] ) .",
    "therefore , for any real @xmath110 and @xmath15 the following holds , @xmath111 applying proposition [ th : anint ] then shows that both sides can be analytically continued to entire functions and that for all @xmath31 , @xmath112 the derivative on the right hand side can be computed from the generating function of the hermite polynomials @xmath113 , @xmath114^{k-2 j}\\end{aligned}\\ ] ]    parameterizing the integral as @xmath115 and using the scaled variables @xmath116 and @xmath117 we have the result @xmath118 where @xmath119 let us next define the function @xmath120 using which we have for even @xmath9 , @xmath121 and for odd @xmath9 , @xmath122 this shows that if we know the function @xmath123 in some suitably dense set of points , we can approximate @xmath124 for any @xmath9 , @xmath116 and @xmath117 by multiplying the known values by the weight function and then performing a discrete fourier - transform .",
    "thus @xmath125 contains all information even about the arbitrarily high energy end of the spectrum and it should not come as a surprise that its computation is not easy in general .",
    "fortunately , it has a lattice approximation and there is a relatively straightforward monte carlo algorithm for the evaluation of the lattice integral .    by theorem [ th : latconv ]",
    ", the lattice approximations @xmath126 converge to @xmath125 as @xmath127 and they are all uniformly bounded in @xmath128 . if we define @xmath129 by replacing @xmath123 by @xmath130 in ( [ e : defeven ] ) and ( [ e : defodd ] ) , we can thus rely on the dominated convergence theorem and conclude that @xmath131 where @xmath132 and @xmath106 . since the gaussian partition function measures directly the density of states , it is of a special interest and , by the above results , it has the lattice approximation @xmath133      let us now go through the lattice algorithm for the evaluation of @xmath130 when @xmath128 and @xmath15 are given .",
    "the definition ( [ e : defgl ] ) translates into the lattice integral @xmath134 \\nonumber\\\\   \\times \\exp\\!\\bigg[\\rmi\\alpha\\bigg ( \\beta{\\overline{h}}-\\beta v_l +    \\frac{1}{\\beta ' } p_l - \\case12 ln     \\frac{\\arctan \\alpha}{\\alpha}\\bigg)\\bigg],\\label{e : glat}\\end{aligned}\\ ] ] where @xmath84 is a short - hand for the combination @xmath135 and @xmath136 and @xmath137 as before .",
    "in addition , since the kernel of @xmath138 is obtained by analytic continuation , the arcus tangent in the above should be chosen from the primary branch , i.e.  @xmath139 .",
    "now we can also finally explain why we wanted to include the term @xmath140 into the lattice integration .",
    "suppose , for simplicity , that of the possible classes of permutations one dominates over the others  this is natural if the quantum behaviour of the system comes from the formation of correlated particle clusters of fixed size for the temperature in question ( we saw in section [ sec : canalg ] that when a permutation is decomposed into cycles , each cycle can naturally be identified as such a correlated cluster of particles ) .",
    "then for this permutation and for small @xmath128 , the last term in parentheses in ( [ e : glat ] ) has an almost zero expectation value under the distribution in front of it  this follows from a comparison with the definition of @xmath141 in ( [ e : defq1 ] ) .",
    "since the @xmath128-integration is concentrated near zero , choosing @xmath140 as the energy origin thus gives the smallest oscillations for the integrand in ( [ e : glat ] ) .",
    "this also shows , that for a fixed lattice size @xmath6 , it is best to use the value evaluated from the same lattice for @xmath142 , a continuum extrapolation is not necessary or desirable .    the first term in the lattice integral in ( [ e : glat ] ) gives simply a canonical distribution which can be generated by the algorithm explained in section [ sec : canalg ] .",
    "the evaluation of the remaining exponential is then a simple computation of trigonometric functions .",
    "computation of @xmath123 for all @xmath128 would then enable the solution of the full microcanonical spectrum of the hamiltonian .",
    "as the energy is increased , the dependence of the position of the spectral lines depends on ever finer structure of the potential . since , eventually , a computer can not hold the values of the potential at the accuracy needed , there must be a catch somewhere . in our case , this is most easily seen in the prefactor @xmath143 which must the cancelled by the result from the lattice integral ",
    "otherwise @xmath123 would diverge in the continuum limit .",
    "this means that as @xmath128 is increased , the oscillations of the lattice observable increase rapidly and the maximum value of @xmath128 that can be computed this way is limited by the number of monte carlo sweeps feasibly performed and by the resulting inaccuracy of the result from the lattice integration .",
    "we now want to check how well the algorithm works in practice .",
    "we shall consider particles living in a three - dimensional world and bound by a harmonic potential .",
    "after we have checked that the algorithm works for this analytically solvable case , we shall add a coulomb interaction between the particles .",
    "in other words , we shall consider the potential @xmath144 where @xmath0 gives the number of particles , @xmath145 is the binding frequency and @xmath146 denotes the charge of one particle .",
    "the scaling properties of the potential part of the action are now simple , @xmath147 where @xmath148 by first scaling the temperature @xmath62 away from the kinetic term , and by subsequent differentiation we can thus derive a second set of observables for the computation of the energy moments .",
    "the energy expectation value can now be measured either by using @xmath141 in ( [ e : defq1 ] ) or by using the observable @xmath149 which has been rescaled back to the original lattice variables .",
    "similarly , the second moment is given by ( [ e : defq2 ] ) or by @xmath150 and the other observables @xmath151 could be computed equally easily .",
    "note that , again , simply taking the second power of the observable giving the energy expectation value does not yield the correct result .    the advantage of using both of these two kinds of observables comes from their very different dependence on the lattice kinetic energy . for large @xmath6",
    "the second set of observables is better , since it does not contain any cancellation of two large numbers as is necessary for the first set of observables . for all values of @xmath6",
    ", both methods should nevertheless yield mutually consistent results and we , in fact , used this for fine - tuning and checking of the monte carlo algorithm .",
    "@*10l @xmath62 & @xmath146 & obs . &",
    "@xmath152 & @xmath153 & @xmath154 & @xmath155 & @xmath156 & @xmath157 + 1.0 & 0 & @xmath158 & 6.483(3 ) & 5.59(2 ) & 11.7(2 ) & 131(2 ) & 778(25 ) & 7100(290 ) + & & @xmath159 & 6.481(4 ) & 5.49(3 ) & 11.4(3 ) & 123(5 ) & 790(100 ) & 8800(2500 ) + & & c.l . & 6.4919 & 5.524 & 11.95 & 127.6 & 804.4 & 7664 + & 2 & @xmath158 & 8.735(3 ) & 5.03(2 ) & 10.8(2 ) & 110(2 ) & 647(23 ) & 6150(430 ) + & & @xmath159 & 8.665(4 ) & 4.69(3 ) & 9.8(3 ) & 98(7 ) & 730(170 ) & 9400(4000 ) + 0.1 & 0 & @xmath158 & 6.000(3 ) & 5.99(2 ) & 11.8(2 ) & 147(2 ) & 832(27 ) & 8930(440 ) + & & @xmath159 & 6.000(2 ) & 5.970(12 ) & 11.87(15 ) & 143(2 ) & 886(40 ) & 9340(790 ) + & & c.l . & 6.0050 & 5.995 & 12.00 & 143.8 & 863.4 & 8629 + & 5 & @xmath158 & 6.583(3 ) & 5.82(2 ) & 11.6(2 ) & 139(2 ) & 852(26 ) & 8690(370 ) + & & @xmath159 & 6.585(2 ) & 5.79(2 ) & 11.8(2 ) & 138(3 ) & 907(65 ) & 10300(1500 ) +    we have presented the results of the monte carlo computation of the energy moments of a system of two distinguishable three - dimensional particles at two different temperatures in table [ t : canmom ] .",
    "the results were computed performing @xmath160 sweeps on an alphastation 1000 computer which took a few hours of computer time .",
    "the error estimates for the moments were computed using the bootstrap - method and the number of sweeps was enough for obtaining a clean signal for all of the measured six moments .    in both cases",
    ", we used a lattice with @xmath161 steps and it is clear that the results are very close to the continuum limit . in fact , the main difference to the classical @xmath162 results comes already at the addition of one classical copy for the quantum fluctuations , i.e.already at @xmath163 . as expected",
    ", the convergence to the continuum limit is also faster for smaller values of @xmath62 .",
    "we have included the @xmath164 case as a warning about the possible systematical errors induced by the monte carlo algorithm .",
    "it is clear that the two lattice observables at @xmath164 do not yield as mutually consistent results as at @xmath165 .",
    "this is most clearly seen from the energy expectation value of the charged case when the two results are not consistent within their statistical errors when @xmath164 , but they _ are _ consistent for @xmath165 even though we have increased the charge for the second case .",
    "the source of these systematical errors is in the _ a priori_distribution which is used for getting samples for the metropolis check .",
    "if the _ a priori _   distribution does not concentrate to the correct region of the configuration space , the resulting probability distribution in this region will be coarser than suggested by the number of sweeps used and the results , likewise , less accurate .",
    "for instance , the differences in the non - charged case are caused by the use of quantum fluctuations as the _ a priori _   distribution although we are already in the low - temperature region @xmath166 where the lowest energy state dominates .",
    "this could be remedied by using also sweeps with the usual monte carlo sampling where the binding potential @xmath167 serves as the _ a priori_distribution .",
    "the discrepancy in the low - temperature charged case is more problematic , since it is caused also by the singularity of the coulomb distribution .",
    "the cure in the second case would be replacing the coulomb distribution with some smooth approximation of it , but the effect of this change would then have to be analyzed separately .",
    "of course , it is always possible simply to increase the number of sweeps until the final probability distribution is smooth enough , but this might not always be feasible .",
    "we also measured the gaussian partition function , i.e.  the density of states , for this system .",
    "the measurements were performed by computing @xmath168 for @xmath169 at intervals of @xmath170 on a four - step lattice using @xmath165 .",
    "samples were then taken from the measured values with the assumption of normally distributed errors and a discrete fourier - transformation with the correct weight was performed to each of these samples .",
    "we have given the stable results of this analysis in figure [ f : gauss ] for two different values for the energy resolution , @xmath171 and @xmath172 .",
    "it is interesting that we were able to get accurate results also for the second case , for which the effect of the gaussian weight is almost negligible .",
    "otherwise , the results behave exactly as expected .",
    "the most accurate results are obtained near @xmath173 , which corresponds to @xmath174 in the first case and to @xmath175 in the second case .",
    "the accuracy detoriates as the energy difference increases , faster in the case of smaller energy resolution .",
    "the addition of the coulomb term also seems to affect the density of states only at the low energy spectrum .",
    "the non - charged results were also compared to their continuum counterparts which were computed using the known partition function @xmath176 if we remember that we used only an @xmath177 lattice , the results presented in figure [ f : gauss ] are surprisingly accurate .",
    "when we later checked the difference between the classical @xmath162 results and the full quantum results at @xmath165 for the values of @xmath128 we used , the differences were almost negligible . this seems to imply that , at least for the harmonic potential , the classical density of states does give a highly accurate measurement of the high energy density of states of the quantum system .",
    "in contrast , we were not able to measure the discrete structure of the energy spectrum by measuring @xmath130 since this would have needed impractically high values for @xmath128 .",
    "we also checked that for detecting the discrete spectrum , the use of large values of @xmath6 is essential .",
    "thus the present method is suitable only for measurement of quantities which do not depend directly on the discrete energy spectrum , but only on the density of states .",
    "a number of references came to our attention after the monte carlo simulations were finished and in this section we shall suggest some improvements motivated by them .",
    "we first present a better algorithm for the generation of the self - recurrent random walk inspired by the work done mostly by doll and freeman , see e.g.  @xcite .",
    "the second subsection contains a discussion and references to other possible improvements .",
    "suppose we make , instead of ( [ e : deful ] ) , a change of variables defined by a discrete fourier sine - transform , @xmath178    \\sin\\!\\left(\\pi\\case{k}{l } j\\right )   \\mbox { , for all } 1\\le k \\le l-1.\\ ] ] the following `` orthogonality '' relations , which can be found from @xcite or computed directly by expressing sines as exponentials , are valid for the discrete sine - transform , @xmath179 where we have assumed that both @xmath9 and @xmath180 belong to @xmath181 .",
    "using these formulae it is easy to prove that the linear transformation which defines the change of variables is always invertible with an inverse @xmath182 and that with the choice @xmath74 the kinetic term becomes simply @xmath183 since equation ( [ e : genqf ] ) integrates to unity , we can then also deduce the jacobian of this change of variables and conclude that ( [ e : genqf ] ) can be replaced by @xmath184,\\ ] ] where @xmath185    therefore , we can replace the monte carlo step suggested in item ( [ it : genrw ] ) in section [ sec : canalg ] by a generation of the path @xmath90 via the coefficients @xmath186 in equation ( [ e : deffxj ] ) . since all @xmath186 have a normal distribution , their generation is fast and straightforward .",
    "note also that the discrete fourier transformation need not slow down the algorithm , since all necessary trigonometric functions can be computed before entering the monte carlo loop .",
    "using fourier - transformation of the path to express quantum statistical path - integrals was suggested already by feynman @xcite .",
    "later , doll and freeman @xcite used a form with a cut - off for the number of fourier modes in a monte carlo simulation of energies of quantum mechanical systems and they found a performance better than in a conventional metropolis monte carlo .",
    "however , the convergence of energy expectation values was found to be non - monotonic for this `` primitive fourier method '' and a relatively high number of fourier modes , @xmath187 , was necessary before the continuum value was approached @xcite .    in our simulations",
    ", we did not see any non - monotonicity of the convergence of the lattice energy expectation values and , in addition , we found that a relatively coarse lattice was sufficient for the computation of nearly continuum results . emboldened by these results we now suggest that using the version of the fourier transformation given in the previous section should solve the problems related to the approach to the continuum limit that are manifest in the primitive fourier method .    in other words , if the `` matsubara frequencies '' used in the primitive fourier method are replaced by those derived in the previous section , i.e.  if we replace @xmath188 then the fourier - method should converge for smaller values of @xmath189 . similarly , the integrals needed in the previous energy estimators should probably be replaced by their discretized lattice versions .",
    "this idea is not new @xcite , but it has not been widely used , either .",
    "since we did not use as complicated a system as in the references , it would now be necessary and interesting to repeat the test of the convergence and the comparison of computing times for the different methods that were done in @xcite and @xcite , respectively . for this comparison",
    ", we would like to point out that the differentiation which we used for producing the second set of observables , @xmath151 in section [ sec : coulomb ] , would for a generic potential lead to what is essentially the virial estimator defined in @xcite .",
    "note , however , that our method also yields similar estimators for all other energy moments , not just for the first one .",
    "in addition , both of our lattice observables always give the same result on the same lattice , whereas the previous ones agree only in the continuum limit .",
    "we can now also explain why the fourier method is better than the conventional lattice monte carlo : using the fourier coefficients as the _ a priori _  distribution gets rid of the kinetic term which we suggested was the culprit for the slow convergence of the conventional monte carlo algorithm for large @xmath6 .",
    "we can also explain why typically no estimators are given for energy moments beyond the first one : since each power of the kinetic term requires a separate renormalization , guessing the correct lattice observables from continuum expressions is difficult and the effect of using wrong constants can easily be drastic .",
    "in addition , observables for the higher moments can not be reduced to `` coordinate - space observables '' ( i.e.  observables living in only one time - slice ) as is the case for the virial estimator of the energy for distinguishable particles .    since the changes we suggest here make the fourier lattice integrals _ equivalent _ to the discrete time - step integrals",
    ", the methods used for improving the performance of the earlier methods should apply equally easily here .",
    "one could e.g.  employ classical cluster algorithms @xcite or use smeared or effective potentials @xcite .",
    "one interesting application which we did not discuss here at all is in the computation of real - time correlation functions , for this see e.g.  @xcite .",
    "although the algorithm for the computation of gaussian traces is not practical for resolving the discreteness of the energy spectrum , the lattice formulae derived are valid for arbitrarily fine energy precision . by following the steps which where used in @xcite , we could derive a lattice formulation with a complicated oscillating kernel which could be used for solving also the low - energy discrete spectrum .",
    "how far in energy and for how complicated systems this kernel can be used in practise needs testing .",
    "we have presented a lattice monte carlo algorithm for the computation of energy moments in the canonical boltzmann - gibbs ensemble for a system of non - relativistic quantum mechanical particles .",
    "in fact , none of our results would have changed if we were to add a bounded classical observable @xmath190 to the trace .",
    "thus the present method can be used also for the evaluation of microcanonical corrections to the canonical expectation values of such observables as is explained in @xcite .",
    "the overall performance of the algorithm , especially for high temperatures , was very good .",
    "in addition to the algorithm , we presented rigorous limits which can be used for a quantitative estimation of when and how the indistinguishability of particles will begin to affect the results .",
    "we also proposed a lattice formulation which can be used for the evaluation of gaussian expectation values and the gaussian partition function of these systems .",
    "the algorithm we gave for the computation of the lattice integrals was shown to yield correct information about the density of states even for quite coarse lattices .",
    "if knowledge about the discrete energy spectrum is required , then using analytical methods or a modification of the algorithm seems to be necessary .",
    "the present method has the advantage that other non - canonical ensembles in addition to the gaussian one , as well as many different energy resolutions , can be analyzed from the same lattice data .    in both cases",
    ", we saw that the classical ensembles work surprisingly well and we noted how the intuitive understanding of the classical case can help in the computation of the full quantum results .",
    "the main use of the gaussian lattice methods would likely to be in the detection of phase transitions .",
    "although it is necessary to increase the number of particles to infinity before a clean signal for a phase transition appears , such effects should be visible for a finite number of particles as well .",
    "i am indebted for the motivation and advice provided by m.  chaichian .",
    "i also wish to thank a.  kupiainen and c.  montonen for their comments on the manuscript .",
    "the following result is a straightforward consequence of textbook results , but since it is central to all the results presented in the text , we give a brief derivation for it .",
    "the main content of the theorem is that an analytically parameterized integral is an analytic function of the parameter if the integrand is uniformly dominated by an integrable function in every compact subset of the parameter space and that in this case it is also always possible to take differentiation of the parameter inside the integral .",
    "[ th : anint ] let @xmath191 be an open subset of the complex plane and let @xmath192 be a measure space which is @xmath193-finite with respect to a positive measure @xmath194 . consider a function @xmath195 , which is measurable in the product space and which defines an analytic function @xmath196 for almost every ( w.r.t .",
    "@xmath194 ) @xmath4 . if for every compact subset @xmath197 of @xmath191 there is a function @xmath198 such that @xmath199 for almost every @xmath4 and for every @xmath200 , then the function @xmath201 is well - defined and analytic in @xmath191 . then",
    "also for all @xmath202 and positive integers @xmath9 , @xmath203 .",
    "@xmath204 is clearly well - defined for all @xmath202 . by the dominated convergence theorem it is also continuous and",
    "then an application of the morera s theorem shows that it is analytic . using cauchy",
    "s integral formula for the derivatives of @xmath204 , followed by an application of fubini s theorem then leads to the given expression for the derivatives . for more details",
    "see @xcite .",
    "when using the proposition here , the @xmath193-finiteness is obvious since we use it only for the counting measure on the positive integers and for lebesque measures on euclidean spaces .",
    "the measurability of @xmath205 in the product space is also trivial since the functions we are dealing with will be continuous .",
    "we prove here how theorem [ th : latconv ] follows from the assumptions ( [ it : vcon ] ) and ( [ it : potcon ] ) given in section [ sec : notations ] .",
    "the proof consist of four parts : we first show that the @xmath75 trace is an analytic function which works as a generating function for the other powers .",
    "we then derive an integral representation for the lattice traces and use this to prove their analyticity .",
    "next we show that the lattice traces are uniformly bounded on compact subsets with a bound given in terms of the classical partition function .",
    "since the traces converge for positive values of the parameter , theorem [ th : latconv ] follows from an application of the vitali convergence theorem @xcite and properties of analytic functions .",
    "however , let us begin by defining the following two functions of a lattice configuration @xmath206 , @xmath207 in the proof and in practical computations the following bound for their exponentials will become useful .",
    "[ th : ikbound ] for any permutation @xmath208 and for all @xmath209 and @xmath15 , @xmath210   \\nonumber\\\\   \\lo\\le \\int\\!\\ !",
    "\\frac{\\rmd^n y}{(2\\pi\\beta)^{n/2}}\\ ,     \\exp\\!\\bigg[{-\\frac{1}{2\\beta }     |sy - y|^2-\\beta v(y)}\\bigg ] \\le",
    "{ z_{\\rm cl}}(\\beta).\\end{aligned}\\ ] ]    by the relation between arithmetic and geometric means , we always have @xmath211 \\le   \\case1l \\sum_{k=1}^l    \\exp[-\\beta v(x(k))]$ ] . applying this and the rules of gaussian integrals",
    "then yields @xmath212 \\\\",
    "\\lo\\le   \\frac{1}{l } \\int\\!\\rmd^n y \\ , \\rme^{-\\beta   v(y ) } \\biggl ( { 1\\over 2 \\pi \\beta } \\biggr)^{{n\\over 2 } }   \\exp\\!\\bigg[-\\frac{1}{2\\beta } |sy - y|^2\\bigg ] \\\\",
    "+ \\frac{1}{l }   \\sum_{k=1}^{l-1 } \\int\\!\\rmd^n y \\,\\rmd^n x\\ , \\rme^{-\\beta v(y ) }   \\biggl ( { l\\over 2 \\pi \\beta k } \\biggr)^{{n\\over 2 } }   \\exp\\!\\bigg[-\\frac{l}{2\\beta k } |sx - y|^2\\bigg ] \\\\",
    "\\times \\biggl({l\\over 2 \\pi \\beta ( l - k ) } \\biggr)^{{n\\over 2 } }   \\exp\\!\\bigg[-\\frac{l}{2\\beta ( l - k ) } |y - x|^2\\bigg].\\end{aligned}\\ ] ] but @xmath18 is an orthogonal transformation and thus @xmath213 . substituting this into the previous formula and computing the resulting gaussian integral over @xmath4 will then show that , in fact , all the terms in the sum are equal and the result is precisely the middle term in equation ( [ e : lemeq ] ) .",
    "this proves the first inequality .",
    "the second inequality is obvious from the definition of @xmath214 , equation ( [ e : defzcl ] ) .",
    "let us begin the proof of the theorem by defining for all @xmath32 @xmath215 it has been proven in @xcite that for the potentials we are interested in the operator @xmath216 is trace - class on the right half - plane . since @xmath23 is bounded , the trace converges and can be given in terms of the eigenvectors @xmath217 and the corresponding eigenvalues @xmath218 of the hamiltonian as the ( numerable ) sum @xmath219 suppose next that @xmath220 .",
    "since then @xmath221 and @xmath222 , we can apply proposition [ th : anint ] and conclude that @xmath123 is analytic on the right half - plane and that @xmath223    the operator defining the lattice trace , @xmath224 , is for all @xmath30 a hilbert - schmidt operator with a kernel @xmath225 therefore , @xmath226 is also hilbert - schmidt and it has a kernel @xmath227 thus for any @xmath228 the function @xmath229 is well - defined and it has an integral representation @xmath230.\\ ] ] we shall use equation ( [ e : deffl ] ) to define also @xmath231 .",
    "suppose next that @xmath232 .",
    "then the integrand in ( [ e : deffl ] ) is bounded by @xmath233 which is integrable by assumption .",
    "thus the conditions for proposition [ th : anint ] are satisfied and each @xmath234 is an analytic function on the right half plane and all of its derivatives can be computed by a differentiation inside the integral .",
    "we shall now first finish proving the theorem for the @xmath75 case , from which the @xmath235 case follows quite easily .",
    "the uniform boundedness on compact subsets will follow from the bound @xmath236 and @xmath237 with @xmath238 .",
    "note that for even @xmath6 we have the simple bound @xmath239 .    by lemma iv.1 of @xcite , for any bounded operator @xmath26 and hilbert - schmidt operator @xmath138 , @xmath240 . since @xmath241 and @xmath242 , we thus have @xmath243 choosing @xmath244 in the left hand side of equation ( [ e : deffl ] ) yields an integral representation for the trace in the above equation . by lemma",
    "[ th : ikbound ] , then @xmath245 and we have finished proving the bound [ e : flbound ] .    we next need the result that for all @xmath15 , @xmath246 the proof of this result can be done essentially identically to the proof of theorem iii.4 in @xcite which contains the above result for the case @xmath247 .",
    "we do not reproduce the proof here .",
    "we have now shown that the sequence @xmath248 consists of functions analytic on the right half - plane , which converge on the real axis and which are uniformly bounded on every compact subset of the half - plane . by the vitali convergence theorem ,",
    "the sequence then converges on the whole half - plane , the convergence is uniform on compact subsets and the limit function is analytic . since the limit function is equal to @xmath123 on the real axis , and @xmath123 is analytic , it follows that the limit function is given by @xmath123 on the whole half - plane .",
    "also , since the convergence is uniform on compact subsets , then all derivatives converge as expected , @xmath249 . by equation ( [ e : hampow ] ) we have now completed the proof of the first half of theorem [ th : latconv ] .",
    "suppose then that @xmath34 and @xmath250 satisfies @xmath251 . by the cauchy estimates for derivatives , then for all @xmath252 , @xmath253 and it",
    "is thus enough to prove the uniform boundedness of @xmath234 .",
    "however , since @xmath214 is now a continuous function , this is an obvious consequence of the inequality ( [ e : flbound ] ) . especially , if @xmath13 is positive then @xmath214 is decreasing and we have for all even @xmath6 , @xmath252 and @xmath254 , @xmath255",
    "let @xmath256 be a permutation and make a change of variables from @xmath4 to @xmath82 to the lattice integral ( [ e : trppm ] ) as defined by @xmath257 for all @xmath258 .",
    "the jacobian of this transformation is one and , by assumption , @xmath259 .",
    "the transformation @xmath256 is orthogonal , and thus @xmath260 for all @xmath9 with the exception of @xmath261 for which we have @xmath262",
    ". therefore , the lattice kernel satisfies @xmath263 .",
    "since @xmath256 was arbitrary , we can now conclude that the result of the lattice integral depends only on the conjugate class of the permutation .",
    "we shall thus need a way of parameterizing the conjugate classes and of choosing an easy representative element from each class . the solution is well - known and we present the results as they are given in @xcite .",
    "every permutation can be decomposed into independent cyclic permutations , cycles , and its conjugate class is determined by the number @xmath264 of cycles of length @xmath265 .",
    "conversely , a collection of numbers @xmath264 , @xmath266 , defines a conjugate class provided it satisfies the consistency condition @xmath267 . for each class",
    ", we can then choose a representative element as the permutation which performs the cyclic permutations for consecutive elements and puts the longest cycles first , e.g.  if @xmath268 and @xmath269 , @xmath270 , @xmath271 , the representative permutation would be @xmath272 .",
    "the number of distinct permutations in each class can be computed from @xmath264 by the formula @xmath273",
    "l\\nu_l \\end{array}\\biggr ) } }   \\frac{(l\\nu_l)!}{l^{\\nu_l } \\nu_l ! } \\bigg].\\ ] ] each cycle with an even number of elements has an odd parity and a cycle with an odd number of elements has an even parity .",
    "thus the parity of the permutations in the class is given by the formula @xmath274    for our purposes , there exists a better alternative parameterization . from @xmath264",
    "define the new parameters @xmath275 , @xmath266 , via @xmath276 the inverse relation is clearly given by @xmath277 for @xmath266 , where it is understood that @xmath278 whenever @xmath279 .",
    "the consistency condition for @xmath275 is now simply @xmath280 and thus the generation of the conjugate classes reduces to the generation of the partitions of @xmath0 into @xmath0 ordered non - negative integers .",
    "after this is done , we can compute @xmath264 and choose the representative permutation , denoted from now on by @xmath45 , as was explained in the previous paragraphs .",
    "in addition , the number of permutations in a class is given by @xmath281}\\ ] ] and , by ( [ e : classparity ] ) , the parity of the class is given by @xmath282 ."
  ],
  "abstract_text": [
    "<S> we derive a lattice approximation for a class of equilibrium quantum statistics describing the behaviour of any combination and number of bosonic and fermionic particles with any sufficiently binding potential . </S>",
    "<S> we then develop an intuitive monte carlo algorithm which can be used for the computation of expectation values in canonical and gaussian ensembles and give lattice observables which will converge to the energy moments in the continuum limit . </S>",
    "<S> the focus of the discussion is two - fold : in the rigorous treatment of the continuum limit and in the physical meaning of the lattice approximation . in particular , it is shown how the concepts and intuition of classical physics can be applied in this sort of computation of quantum effects . </S>",
    "<S> we illustrate the use of the monte carlo methods by computing canonical energy moments and the gaussian density of states for charged particles in a quadratic potential . </S>"
  ]
}