{
  "article_text": [
    "it is well - known that the magnetic field plays a key role in almost all solar activities , such as solar flares , filament eruptions , coronal mass ejections , etc .",
    "many structures of the solar corona are shaped by the magnetic field , due to its pervasive nature .",
    "therefore , a thorough knowledge about the coronal magnetic field topology will help us to understand the physical processes of various solar activities .",
    "however , so far the routine measurement of solar magnetic field is mainly based on the zeeman effect and hanle effect , which can measure stronger emissions and sharper lines on the photosphere but failed to measure the coronal magnetic field for its faint line intensities and broad line widths .",
    "although some techniques using infrared and radio observations have been proposed to solve this problem , ( lin et al . , 2004 ; gary and hurford , 1994 ) , they have not reached full fruition yet and have many limitations .",
    "normally , one has to obtain the solar coronal magnetic fields from modeling by extrapolation using underlying photospherical observations .    at present",
    ", the non - linear force - free field ( nlfff ) model has been thought to be a good approximation to the actual physical state of the coronal magnetic fields .",
    "available nlfff extrapolation methods can be classified into five types : ( 1 ) upward integration method : nakagawa , 1974 ; wu et al . , 1990 ; song et al .",
    ", 2006 ; ( 2 ) grad - rubin method : grad and rubin , 1958 ; sakurai , 1981 ; amari et al .",
    ", 1999 , 2006 ; wheatland , 2006 ; ( 3 ) mhd relaxation method : chodura and schlueter , 1981 ; yang et al . , 1986 ; mikic and mcclymont , 1994 ; roumeliotis , 1996 ; valori et al . , 2005 , 2007 ; jiang et al . , 2011 , jiang and feng , 2012",
    "( 4 ) optimization approach : wheatland et al . , 2000 ; wiegelmann , 2004 , 2007 ; inhester and wiegelmann , 2006 ; wiegelmann and neukirch , 2006 ( 5 ) boundary integral equation method : yan and sakurai , 1997 , 2000 ; yan and li , 2006 ; he and wang , 2008 ; he et al . , 2011 .",
    "as a stand alone method , the boundary integral equation ( bie ) method is one that allows us to evaluate the nlfff field at arbitrary points within the domain from the boundary data , without the requirement to solve the field in the entire domain .",
    "moreover , because the bie model takes into account the asymptotic condition consistently , it allows us to only use bottom boundary data as the boundary condition .",
    "this satisfies the current observational condition and avoids assuming arbitrarily - prescribed lateral and top boundary data .",
    "the bie method for nlfff was first proposed by yan and sakurai ( 1997 , 2000 ) , and many applications of bie to solar events have been implemented ( e.g. , yan and sakurai , 1997 ; yan et al . , 2001 ; liu et al . , 2002 ;",
    "yan , 2003 ) . later a new direct boundary integral equation ( dbie ) method was proposed as an improvement to the bie method .",
    "an optimization technique has been applied to approximate the non - linear force - free field at any position numerically . compared with bie ,",
    "the complicated volume integration in equations ( 17 ) and ( 19 ) in the paper of yan and li ( 2006 ) were avoided .",
    "a series of test cases and practical applications ( yan and li , 2006 ; liu et al .",
    ", 2011 , 2012 ; he and wang 2008 ; he et al . , 2011 )",
    "have been carried out to demonstrate the reliability and feasibility of dbie .",
    "recently , with the launch of solar dynamic observatory ( sdo ) , the helioseismic and magnetic imager ( hmi ; schou et al . , 2012 ) can provide the vector magnetogram which can be used as the high quality boundary data for coronal magnetic field reconstructions . the atmospheric imaging assembly ( aia ; lemen et al . ,",
    "2011 ) can provide high resolution coronal structure images for the evaluation of any modeling techniques .",
    "therefore , it is necessary to apply the dbie method to real data by using high resolution boundary data as validation .",
    "the previous bie method was thought to be slow when carried out on entire 3d domain ( schrijver et al . , 2006 ; wiegelmann , 2008 ) as the parallel algorithm",
    "was not implemented though the bie technique itself should be suitable for parallel computation . in order to solve this problem",
    ", we implemented a graphics processing unit ( gpu ) technique into our program to accelerate the computing processes .",
    "the results show that this method is effective and suitable .",
    "the noaa 11158 was the first active region that produced x - class event in the current 24th solar cycle .",
    "an x2.2 flare event occurred on 2011 february 15 at 01:44 ut .",
    "many studies have been carried out on this event , such as work on the evolution of the magnetic field ( sun et al . , 2012 ) ,",
    "research focusing on solar features ( schrijver et al . ,",
    "2011 ) , extrapolations on the hmi , vector magnetogram ( wiegelmann et al . , 2012 ) , evolution of relative magnetic helicity and current helicity ( jing et al . , 2012 ) ,",
    "non - potentiality of active region ( song et al . , 2013 ) , and the work on the rotating sunspots of this region ( vemareddy et al . , 2012 ) .",
    "although most of these studies have the aid of extrapolation methods , none of them have demonstrated the 3-d view of the reconstructed coronal magnetic fields for this active region .",
    "the twin stereo / a(head ) and b(ehind ) spacecraft ( kaiser et al . , 2008 ) observe the sun from multi - views , which provides us with a good opportunity for a comprehensive comparison so that the physical process in the corona can be understood correctly .",
    "it should be mentioned that su and van ballegooijen ( 2012 ) compared a nlfff model with bright euv features on the two sides of a solar polar crown prominence that erupted on december 6 , 2010 observed by stereo b and aia , since the channel was on the backside of the sun in stereo a observations .",
    "derosa et al .",
    "( 2009 ) compared other nlfff models with observations including stereo a / b data for ar 10953 on april 30 , 2007 but no comparison with stereo images was shown .",
    "sandman and aschwanden ( 2011 ) proposed a forward - fitting method with the stereoscopically reconstructed stereo loops as known conditions .    in this work , we apply dbie method to active region noaa 11158 on february 14 with the hmi vector magnetogram taken at 20:12 ut as boundary condition in order to understand the three - dimensional magnetic configuration before the x2.2 flare event .",
    "we will present our reconstructed topology configuration of magnetic fields in the whole research region and electric current distribution in the central region .",
    "we then compare them with observations from both front view ( sdo / aia ) and side views ( stereo a / b ) .",
    "this paper is arranged as follows .",
    "section 2 briefly introduces the dbie method and gpu technique .",
    "section 3 shows the observations and section 4 presents the reconstructed results . finally in section 5",
    "we draw our conclusions .",
    "as an improvement of the bie method , dbie method also need to satisfy the force - free field and divergence - free conditions ( yan and li , 2006 ) :    @xmath0    with the boundary condition at @xmath1 magnetogram region ( outside this magentogeam region a vanishing field is assumed ) : @xmath2    at infinity , an asymptotic constraint should be employed to ensure a finite energy content in the semispace above the sun ,    @xmath3    where @xmath4 is the radial distance .",
    "a reference function @xmath5 is introduced in this method @xmath6 where @xmath7 is a pseudo - force - free factor depending on the location of point @xmath8 only .",
    "@xmath9}^{(1/2)}$ ] is a distance between a variable point ( @xmath10 ) and a fixed point @xmath11 , @xmath12}^{(1/2)}$ ] .    combining with the force - free , divergence - free , boundary , and asymptotic conditions , we obtain a direct boundary integral formulation ( yan and li , 2006 ) @xmath13\\textit{b}_{p0}(x , y,0)}{2\\pi[(x - x_i)^2+(y - y_i)^2+z_i^2]^{3/2}}dxdy\\ ] ] where @xmath14^{1/2}$ ] , p = x , y , or z. @xmath15 is the magnetic field on the photospheric surface , and @xmath16 in place of @xmath7 in equation  ( [ y ] )",
    ", it is in principle governed implicitly by the following expression :    @xmath17dxdydz}{\\int_\\omega y(x , y , z ; x_i , y_i , z_i , \\lambda_{pi})b_pdxdydz}\\ ] ]    here @xmath7 ( denotes those @xmath18 s for short ) has the same dimension as the force - free factor @xmath19 .",
    "it is called pseudo - force - free factor . from equation  ( [ dbie ] )",
    ", we can obtain the magnetic field @xmath20 if @xmath7 is known . a previous study on the property of @xmath7 distribution by substituting the low & lou ( 1990 ) solution into the rigorous expression similar to equation  ( [ lamd ] )",
    "was done for the bie method ( li et al .",
    "it was found that the @xmath7 values that satisfy the condition at some given point are not unique .",
    "however , this non - uniqueness of the @xmath7 solutions does not influence the computation of the field at that location , as demonstrated by numerical results . obviously , it is not practical to determine @xmath7 from such an implicit expression  ( [ lamd ] ) .",
    "yan and li ( 2006 ) suggested to make use of the downhill simplex method ( nelder and mead , 1965 ) to find the suitable @xmath7 from a nonlinear programming problem . in this way",
    "the @xmath7 is not obtained from equation  ( [ lamd ] ) exactly but instead we look for a numerical solution of the magnetic field .",
    "this is calculated from the given boundary condition ( 3 ) together with the assumed asymptotic condition ( 4 ) and satisfies the original force - free ( 1 ) and divergence - free ( 2 ) conditions approximately . here",
    "the two stopping criteria of the procedure for the approximation of conditions ( 1 ) and ( 2 ) are as follows .",
    "@xmath21    @xmath22    and @xmath23 @xmath24    we set the constraints like this : @xmath25 where @xmath26 and @xmath27 are sufficiently small thresholds . basically , @xmath28 is the sine of the angle between @xmath20 and @xmath29 , which is used to evaluate the force - freeness .",
    "similarly , @xmath30 stands for the divergence of @xmath20 .",
    "since we just gave a simple description about the approximation of @xmath7 in the previous work ( yan and li 2006 ) , and this may make some misunderstandings about our method .",
    "here we will state it in detail . as stated above , in the numerical procedure ( yan and li , 2006 )",
    ", we only need to control the force - freeness and divergence - free of the magnetic field through equation  ( [ fi ] )  and  ( [ gi ] ) approaching a minimum .",
    "the dbie numerical procedure is possible if the function @xmath31 can be calculated analytically . in order to evaluate the right hand side of ( [ fi ] ) and ( [ gi ] ) , we need to know the space derivative of @xmath20 from ( [ dbie ] ) and hence of @xmath7 .",
    "this derivative is approximated by a first order finite difference .",
    "we evaluate @xmath7 in the @xmath32-neighbourhood of the point @xmath33 , where @xmath32 is a very small positive fraction ( typically one thousandth of the pixel size ) . at an arbitrary point in this small neighborhood",
    "it can be expressed as equation  ( [ lamdar ] ) , @xmath34 which satisfies the lagrange mean value theorem and @xmath35 .",
    "since @xmath36 and @xmath37 , the zeroth - order approximation is adopted . in our difference domain , we obtain @xmath38 . here",
    "@xmath39 is a value of @xmath40 in the center of the small domain .",
    "then , any value of the function @xmath41 in the infinitesimal neighborhood is known .",
    "the field @xmath20 and the current @xmath42 can then be evaluated over the point @xmath8 .",
    "this is a practical and rigorous numerical procedure .",
    "however , rudenko and myshyakov ( 2009 ) wrote that they `` think that this method for solving the extrapolation problem is incorrect '' because they found that yan and li ( 2006 ) `` unreasonably drop these space derivatives '' of @xmath43 functions and `` the resulting magnetic field will not be free - force '' .",
    "obviously , the comments in rudenko and myshyakov ( 2009 ) are incorrect as they have confused the dbie representation of the force - free field solution and the numerical approximation of the force - free field .",
    "it should be pointed out that the derivation of the dbie is mathematically valid and rigorous .",
    "the problem is to find out how to obtain a numerical solution with the help of dbie .",
    "as explained above , the strategy is not to solve equations  ( [ dbie ] ) and  ( [ lamd ] ) exactly but to find a numerical solution that satisfies the constraints ( [ figi ] ) and the boundary and asymptotic conditions ( 3 - 4 ) .",
    "alterenatively the original force - free and divergence - free equations ( 1 - 2 ) together with boundary and asymptotic conditions ( 3 - 4 ) is solved approximately",
    ". therefore if one can construct numerically , the magnetic field distributions pointwise at any position that satisfies the constraints ( [ figi ] ) with the boundary and asymptotic conditions ( 3 - 4 ) , one has already obtained a set of numerical solutions that are force - free and divergence - free with the given boundary conditions approximately .    in the present work",
    ", our calculated results will further demonstrate the feasibility and validity of dbie .    at the same time",
    ", the current density can be obtained pointwise : @xmath44    as one of the advantages of dbie , it is a pointwise method , which can calculate the magnetic field and current density in any point above the photospherical boundary from the procedure .",
    "however , it should be noted that a vector magnetogram with all three field components is more than a force - free field needs to be uniquely determined .",
    "the present dbie employs the vector field in the reconstruction .",
    "therefore the boundary data should satisfy compatibility relations in order to be consistent with a force - free corona . the inconsistency and",
    "errors contained in the vector magnetogram data will cause errors in the reconstructed field .",
    "the ignorance of the boundary field @xmath45 outside of the magnetogram area would also have influence to the reconstructed field . in practice",
    ", the truncation of the magnetogram data should be chosen to approach zero as @xmath45 vanishes outside of the magnetogram area . nevertheless , the net flux of @xmath45 in equation ( 3 ) over the boundary magnetogram area does not need to be zero as shown in the derivation of the bie ( yan and sakurai 2000 ) or dbie ( yan and li 2006 ) .      with more and more advanced telescopes launched into space ,",
    "higher quality images have become available .",
    "on one hand , high resolution images provide more clarity to the detail of the sun and this will help us to study the nature of the sun in more detail . on the other hand ,",
    "the vector magnetogram used as the boundary condition of nlfff methods is getting larger which will vastly increase the amount of computation for each method . for the bie method ,",
    "it is necessary to solve the computing speed problem and apply it to real data by using high resolution boundary data .",
    "the bie or dbie method are in principle suitable for high - performance parallel computing .",
    "however , in the previous work , the implementation of bie with parallel computing on high performance computers was not carried out .",
    "therefore bie would be slow when extrapolating nlfff from boundary data with computing grids compatible with current observations .",
    "dbie is expected to make an improvement ( schrijver et al .",
    ", 2006 ; wiegelmann , 2008 ) .",
    "hence we will adopt a suitable parallel computing technique for dbie .    in recent years",
    ", the graphic processing technique has become prevalent in general purpose calculation .",
    "we utilized graphics processing units ( gpus ) in our program .",
    "the results turn out to be effective and suitable .",
    "we can replace a cpu cluster consisting of tens of cpus with just one gpu board fixed on a personal computer .",
    "this convenience has profound meaning on the promotion of the application for the dbie method .",
    "a gpu is composed of high - performance multi - core processors capable of very high computation and data throughput ( zhang et al . , 2009 ) .",
    "the gpu s powerful parallel computing ability to process the integration operation can be applied to the dbie method .",
    "parallel computation of the dbie - nlfff extrapolation algorithm is performed through gpu with shared memory accessing optimization under linux system and a compute unified device architecture ( cuda ) compiler .",
    "the calculation is operated through an intel cpu @ 3.40 ghz and nvidia geforce gtx 480 graphics device with nvidia cuda 4.2 on a personal computer .",
    "the platform employed in this work is a 4 core cpu and one gpu machine .",
    "the main part of the program is the integral operation in equation  ( [ dbie ] ) .",
    "the iteration part is executed mostly in the cpu cores and the data is transferred between cpu and gpu . in order to reduce the latency and improve the occupancy of the procedure ,",
    "we need to reduce the data exchange in the global memory between cpu and gpu , and allocate reasonably the numbers of the @xmath46 and @xmath47 .",
    "the number is not fixed and there are some allocation rules which may improve the speed . generally speaking ,",
    "there are some tricks to allocate .",
    "the thread number is a multiple of 32 , which can improve the memory coalescing of the procedure . for different sizes of data ,",
    "the number is different , the larger the better , since it can improve the occupancy .",
    "we can adjust the thread between 128 and 256 , and then change the block number gradually .",
    "meanwhile , we should make sure the block number is larger than the multi - processor , which can guarantee no multi - processor is empty . in our work ,",
    "the numbers of @xmath48 and @xmath49 are 128 and 80 , respectively , which provide good allocation in our procedure .",
    "in addition , we utilize the shared memory for optimizing our program to improve the computational speed .",
    "this can reduce volume of the output data transmission from gpu to cpu .    according to equation  ( [ dbie ] ) , in the numerical procedure the magnetic field of an arbitrary point @xmath8 in the semispace above the boundary",
    "can be expressed as follows ( yan and sakurai , 2000 ) . @xmath50   \\textit{\\textbf{b}}_{j}^{e}\\ ] ] where the boundary has been subdivided into @xmath51 9-nodes elements with boundary data known over each node , @xmath52 is the shape function , @xmath53 denotes the jacobian , and @xmath54 indicates known nodal field values as provided by the boundary condition similar to @xmath55 in equation  ( [ dbie ] ) .    for clarity , we simplify this equation as equation  ( [ dbie - dis2 ] ) , where @xmath56 equals to @xmath57 namely the number of grid nodes of the boundary condition .",
    "we allocate our gpu assignment like figure  ( [ gpu ] ) , the number of @xmath58 is expressed by @xmath59 , the boundary grids are marked as @xmath60 .",
    "the boundary data are put into each @xmath58 , and @xmath61 are put into @xmath62 .",
    "thus , our data parallelization is realized .",
    "then we get the summation of the data in each @xmath58 , then add the summation results in each @xmath63 .",
    "@xmath64     indicates the number of gpu thread .",
    "the lines present the parts of assignment that are put into corresponding gpu threads.,width=460 ]    a series of numerical tests indicate that the gpu - accelerated dbie program is almost 1000 times faster than the original dbie , which is including the hardware update , difference of the compiler , instruction optimization and gpu s effect .",
    "the total computation cost can be expressed as @xmath65 ( yan and li , 2006 ) , which has to be multiplied with the number of iterations to minimize @xmath31 and @xmath66 in equation ( 12 ) , where @xmath57 is the boundary nodes and @xmath67 expresses as the cubic grids . as figure  [ gpu ] shows us that point @xmath8 in the semispace above the boundary needs to do the integral operation to the @xmath57 boundary grids",
    "@xmath55 ( in equation  ( [ dbie ] ) ) .",
    "we only apply the gpu acceleration into making this @xmath68 part parallelized .",
    "however , the internal grids ( or @xmath69 part ) parallelization , namely the number of points @xmath70 are not involved yet .",
    "so further acceleration could combine cuda with other parallel computing techniques such as message passing interface ( mpi ) to realize muti - gpu parallelization .",
    "before we apply the present dbie method to analyze the practical problems we first compare it with a semi - analytical solution for nlfff . as no iteration",
    "was performed to determine the set of factors by the bie method in the comparison against the analytical force - free - field models of low and lou ( 1990 ) .",
    "it was expected that completion of the iteration by dbie will greatly reduce the computation time and should be feasible ( schrijver et al . , 2006 ) .",
    "here we just adopt the case in schrijver et al .",
    "( 2006 ) , i.e. , only bottom boundary data are used because this type of the boundary condition is close to the case of the sun . the boundary size and",
    "the five evaluation metrics @xmath71 , @xmath72 , @xmath73 , @xmath74 and @xmath75 are the same as in schrijver et al .",
    "the results and the comparison with other methods are shown in table  [ tb ] .",
    "it can be seen that after iteration by the present dbie method , the metrics have been significantly improved as compared with the boundary integral method without an iteration and similar results have been obtained as compared with other methods .    .",
    "evaluation of metrics for the present dbie and other methods . [ cols=\"<,^,^,^,^,^\",options=\"header \" , ]",
    "the noaa 11158 was the first active region that produced an x - class event in the current 24th solar cycle .",
    "there were many c - class and m - class flares in this active region during its passage over the solar disk in february 2011 .",
    "the largest , the x2.2 flare event occurred on february 15 at 01:44 ut .",
    "several studies have been carried out on noaa 11158 ( schrijver et al . , 2011 ; sun et al . , 2012 ; wiegelmann et al . ,",
    "the proposed gpu - accelerated dbie is applied to reconstruct the coronal magnetic field from the vector magnetogram taken on 2011 february 14 at 20:12 ut from sdo / hmi .",
    "this is combined with observations from the sdo / aia and the two stereo / extreme ultraviolet imager ( euvi ) instruments ( howard et al . , 2008 ; w@xmath76lser et al . , 2004 ) to present a stereoscopic investigation of the coronal magnetic fields in order to understand the x2.2 flare event .",
    "we average the boundary data from 360 @xmath77 ( @xmath78 ) to 720 @xmath79 ( about @xmath80 ) , which has @xmath81 grid points to be used as the boundary condition . in order to make a comparison with previous work",
    ", we also pay attention to the central @xmath82-pixel area covering the main features of the active region , with the vertical grid spacing matching the horizontal spacing .    here",
    ", we used the hmi vector magnetogram as the boundary data with three components of the magnetic field shown in figure  [ magmap](b ) , and the two main pairs of bi - polarity are marked as p1 , n1 and p2 , n2 there",
    ". the cutout data used for the force - free field modeling has been mapped to a local cartesian coordinate .    considering the precision of our method largely depends on the boundary condition , solar magnetic field measurement suffers from several uncertainties ( mcclymont et al . , 1997 ) .",
    "wang et al . ( 2001 ) proposed a method to remove the @xmath83 ambiguity and make the boundary data reduction for the bie method . here",
    "we apply this data reduction method to the boundary data in the present study .    after reconstructing the coronal magnetic field using",
    "the gpu accelerated dbie method , we compare the modeling results with the euv images of aia and stereo / euvi from three points of view in order to quantify to what extent they correctly reproduce the coronal magnetic field configuration .",
    "to co - align the cutout vector magnetogram with aia images we carried out a correlation analysis between @xmath84 , from the original vector magnetogram , and @xmath85 from the full disk los magnetogram .",
    "then the location of the rectangle research region ( shown as the white squares in figure  [ fulldisk ] ) is determined in the full disk sdo / hmi magnetogram .",
    "according to the sdo data analysis guide , we align hmi data with aia data and obtain the cutout aia image ( shown as figure  [ magmap](a ) ) and the location of our research region . in order to determine the location of the research region in stereo images ,",
    "the coordinate conversions between stonyhurst heliographic and heliocentric - cartesian are adopted ( thompson , 2006 ) .",
    "thus the reconstructed results viewed from three different points of view are shown aligned with the euv background with accurate locations .",
    "before we compare our reconstruction results with observed euv loops , we need to determine the same features in aia image and the two stereo / euvi images . for a coronal loop in the stereo a image shown as the light blue line in the bottom of figure  [ euvi3](c ) , we apply a gaussian - fitting to the cross section of the loop and find the brightest point along this cross section . then we select a number of cross sections along this loop and connected these points together .",
    "thus , we get the @xmath86 of the loop . through the coordinate conversions ( thompson , 2006 ) ,",
    "some selected points along the @xmath86 line are projected to the image of stereo b in figure  [ euvi3](a ) and these projections seen as short black bars ( whose length seen in the aia image is nearly the same as the length of the research region ) . by using the same method as stereo a image",
    ", we get the @xmath86 line of the loop in the image of stereo b and we obtain the points of intersection .",
    "we convert these points of intersection in stereo b image and points in stereo a image to aia image in figure  [ euvi3](b ) .",
    "thus , the points of intersection from stereo a and b lines are obtained and are marked as many cross - shaped points in the aia image .",
    "we can thus obtain the stereoscopically reconstructed coronal loops .",
    "we apply this method mainly in some higher altitude structures which could be seen from both stereo a / b euvi instruments .",
    "therefore , the comparisons below will take into account these obvious higher altitude structures .",
    "we present some selected euv bright loop structures in 171  , and divide the euv features into groups marked from g1 to g14 ( see figure  [ magmap](a ) ) .",
    "g1 , g2 , and g3 are three groups corresponding to the euv loops on the top of the research region and connect the magnetic polarities p1 and n1 .",
    "when we determine the euv vertical structures rooted at the edge of the solar disk and stretching out of the disk from the side views by the 3-d stereoscopic technique we find they are out of the interested region .",
    "so loops g1 could not be seen from the views at the solar limb and they are in lower altitudes .",
    "g4 is the kernel region where stretched loops along the polarity inversion line ( pil ) are observed and the flare event occurred .",
    "so we present not only the reconstructed magnetic field lines but also the electric current lines .",
    "g5 and g6 present some lower small loops which can be distinguished just from the view on the solar disk .",
    "g7 , g8 , and g9 are large loops connecting n2 with p2 .",
    "g10 and g11 are also the large loops connecting n2 but with p1 .",
    "these bundles of loops could be seen from three different points of view .",
    "g12 , g13 , and g14 are the open loops extending to the outside of the interested region and rooted from n2 and p1 respectively .",
    "the extrapolation code is based on the gpu - accelerated dbie method .",
    "alignments between the extrapolated field lines and euv images in 171 @xmath87 from the sdo / aia , and twin stereo / euvi instruments are presented ( figure  [ mainmap ] ) .",
    "the dbie method is performed to reconstruct the 3d magnetic field structures of the region noaa 11158 in the corona .",
    "the red lines in figure  [ mainmap](e ) show the calculated closed magnetic field lines .",
    "blue lines present the calculated open magnetic field lines which extend to the outside of our computational domain .",
    "figure  [ mainmap](d ) and ( f ) show us the counterparts reconstructed field structures from stereo b and a , respectively .",
    "figure  [ g123 ] presents the decomposed comparison between euv loop groups g1 , g2 , g3 and our reconstructed magnetic field lines .",
    "the l represents the group of reconstructed magnetic field lines , g represents the group of euv loops .",
    "the first row of figure  [ g123 ] presents the euv patterns in 171  .",
    "g1 consists of a series of small lower loop structures , which are not seen from stereo b and show really good agreement with our reconstruction results l1 from the view on the solar disk .",
    "this bundle of loops connects p1 to the relatively weaker negative magnetic polarities between p1 and n1 .",
    "g2 is the same as g1 .",
    "it can also be seen from stereo a. it is worth mentioning that the left footpoints of calculated lines in l2 show a helical structure and this agrees well with the euv background g2 around the negative polarity n1 . according to the method stated in section  [ obs ] ,",
    "the euv loops of g3 are lower than the vertical structures stretching out of the solar disk . compared with calculated magnetic field lines in l3",
    ", it seems to be consistent with this , namely has a lower altitude seen from stereo a and could not been seen from stereo b. it is the largest loop bundle connecting p1 with n1 .",
    "g4 is a group of euv loops in the region around pil and between magnetic polarities p2 and n1 ( see figure  [ g4 ] ) .",
    "there is a strong magnetic shear and should contain a large amount of magnetic free energy around the pil , which is the most important region for understanding the physical processes of solar eruptions ( see the blue box in first row images of figure  [ g4 ] ) .",
    "this region has relatively complex structures seen from aia , and there are also vertical structures stretching out of the edge of the solar disk ( seen in the boxes in the stereo side view images ) .",
    "we determine the correspondence of the features in all three images . around the pil ,",
    "there are some observed euv loops connecting p2 with n1 .",
    "our extrapolation has obtained a series of small and low calculated magnetic field lines along the pil and connecting the regions on both sides , which are agreeable with the euv loop structures in general and the filament structure marked in figure 1 in sun et al .",
    "( 2012 ) , as shown in the last two rows in figure  [ g4 ] .",
    "however , we did not obtain higher - lying calculated magnetic field lines over the filament channel connecting footpoints with opposite magnetic polarities p2 and n1 . nevertheless , the current lines connecting p2 with n1 are found and plotted in white marked as l4 - 1 , which can be calculated from equation  ( [ j ] ) .",
    "the location of the same corresponding euv loops in three view aspects are also marked in g4 - 1 shown as green lines . in the stereo a image , the upper half descending part of this loop structure is blocked by the saturated patch in the 171   detector , but the other visible part is in good agreement with the central electric current lines in l4 - 1 . the highest structure above the one in g4 - 1 is shown as blue line in g4 - 2 representing large scale loops connecting p1 to n2 along the pil in the center region of g4 loops .",
    "l4 - 2 shows bundles of magnetic field lines in the kernel region .",
    "one bundle of field lines is located higher than the electric current lines and they show very good agreement with the coronal loop denoted as the blue line in g4 - 2 in both front and side views .",
    "other bundles of lower - lying and short twisting field lines in l4 - 2 is connecting p2 and n1 along the pil and co - spatial with the s - shaped filament channel , where some euv strands in the dark filament channel were also shown in sun et al .",
    "the highly - twisted short lower - lying field lines in l4 - 2 are in a pivot location to all other surrounding coronal structures l1 , l2 , l3 , l5 , l6 , and the one - side footpoints of l7 , l8 , ... , l12 , and l14 , etc .",
    "therefore they must have played a key role for the occurrence of the x2.2 flare event . in the stereo a image , it can be seen that those lower - lying field lines in l4 - 2 form a twisted arcade structure along the pil where the filament is located .",
    "it should be noted that while the strand in the left part of the s - shaped filament channel may be lower - lying and related to the filament , the right part euv bright features along the pil , marked as a filament in figures 1 and 2 in sun et al .",
    "( 2012 ) , may not be necessarily all lower - lying , as it agrees almost identical to the coronal loop in g4 - 2 that is clearly stereoscopically resolved as a high - lying coronal bright feature seen in stereo a / b euv images .",
    "at least one can not simply attribute all those euv bright features along the pil in the filament channel to manifestation of a filament although the filament could be located there .",
    "theoretically the field- and current lines should be identical for a force - free field but in practical situation there may exist discrepancy . for the current lines in l4 - 1",
    "the averaged misalygnment angle between the fields and the current lines is @xmath88 .",
    "this may be due to the inconsistency with force - freeness and errors contained in the boundary data in the pil region .",
    "it should be pointed out that by the dbie method the angle between the current * j * and the field * b * is mostly less than @xmath89 with an average value of @xmath90 but there do exist some points where the angles are large , whereas the relative flux error factor @xmath66 always has a maximum value of about 0.5% when comparing with the exact solution ( e.g. , fig.5 in yan and li 2006 ) . in the present case for @xmath91 internal grid points , the averaged values are respectively @xmath92 ( or the averaged angle between * b * and * j * is less than 4.5@xmath93 ) and @xmath94 .",
    "physcially the coronal euv loops are controlled by the observed photospheric vector magnetogram data which are not necessarily force - free . therefore there is no guarantee that the observed coronal euv loops are always consistent with a force - free field solution , especially for the solar flare or coronal mass ejection events .",
    "nevertheless the comparison between the calculated field lines and the observed coronal loops would reveal the quality of the extrapolation .",
    "g5 and g6 are relatively low - lying euv bright loops ( see figure [ g56 ] ) . from the views of stereo",
    "a , g5 shows some highlight structures from which we can not distinguish the details .",
    "the corresponding calculated magnetic field lines in l5 are lower and can not be seen from stereo b , which connect negative polarity n2 with the positive polarity between n1 and n2 .",
    "it is important to note that there were a series of drastic solar activities before our selected extrapolated time in this region of g5 .",
    "there was a large cme on february 14 at 18:00 ut , with the associated flare m2.2 at 17:20 ut from this site .",
    "g6 corresponds to a series of lower loops .",
    "the calculated magnetic field lines l6 are also lower - lying and are qualitatively in good agreement with observations from the aia view of g6 . from side views , they mix with the background and no obvious features could be seen .",
    "g7 , g8 , and g9 consist of a series of coronal loops with different length scale ( see figure  [ g789 ] ) .",
    "these loops all originate from polarity n2 and their endings are around the polarity p2 .",
    "the calculated l7 , l8 and l9 lines are all in good spatial agreement with the euv g7 , g8 and g9 loops from the aia view on the solar disk .",
    "the calculated field lines , l7 - 1 and l7 - 2 are lower and shorter , which can be seen just in stereo a not stereo b. the calculated lines are in good agreement with the euv loops from the aia image .",
    "l8 connects n2 to p2 and has good spatial co - alignment with g8 in the aia image .",
    "however , their side projections still mix with the background and can not be distinguished .",
    "l8 also shows poor spatial co - alignment with the high altitude stereo a / b euv loops .",
    "g9 is one of the largest loop bundles at the bottom of this region . as the loops grow , their altitude increases",
    "this could be seen from the side view in the last row of figure  [ g789 ] .",
    "l9 is in good agreement with g9 from the front view but show poor spatial co - alignment with the high altitude stereo a / b euv loops .",
    "we expect to find the coronal loops with not only the euv patterns in aia images but also in stereo images .",
    "figure  [ g1011 ] shows a series of loops connecting n2 to p1 .",
    "their corresponding structures are shown , from different angles , in the first row of figure  [ g1011 ] .",
    "the correspondence of these euv loops at different points of view are confirmed by our method stated in section  [ obs ] and shown in the last row of figure  [ g1011 ] in different colored lines .",
    "however , we just confirm the correspondence of half loops and the other half can not be determined .",
    "nevertheless , this comparison validates our reconstructed results .",
    "we could see that the calculated magnetic field lines l10 agree well with the euv loops of the left parts of g10 .",
    "it overlaps with some parts of g7 and g8 , but its ending is different .",
    "g11 also connects the spots n2 with p1 and has the same situation with g10 .",
    "it overlaps with some parts of g9 .",
    "it can be seen that the configurations of the calculated lines l10 and l11 are coincident with the coronal loops g10 and g11 in both front view from aia and stereo a / b side views . although the calculated field lines and observed euv coronal loops agree with each other globally , they do not follow the same trajectories . in order to make a quantitative comparison for the three stereoscopically reconstructed loops",
    ", we calculated the angles between the tangent vectors along reconstructed loops and the calculated fields there , and obtain the averaged misalignment angles of 16.6@xmath93 , 17.8@xmath93 , and 18.3@xmath93 for three reconstructed loops in the middle panel at last row in figure  [ g1011 ] from bottom up .",
    "these values demonstrate the deviation from the force - freeness along these loops , which are quite good with a factor of about two smaller than those given by other nlfff models yielding overall misalignment angles of @xmath95 ( derosa et al .",
    "2009 ) and at the same order as a forward - fitting model using stereoscopically reconstructed loops as constraints ( sandman and aschwanden 2011 ) .",
    "g12 , g13 , and g14 consist of a series of large coronal loops which are open to the outside of the computing region ( see figure  [ g121314 ] ) .",
    "it should be noted that they are not necessarily open loops but may be connected to other places in the solar surface .",
    "l12 represents the bundles of magnetic field lines rooted in n2 , the brightening of g12 at the ending has good agreement with l12 either in the view to the central region of the sun or stereo a / b side views .",
    "l13 are also magnetic field lines rooted in n2 .",
    "there are two bundles of field lines that extend beyond the region .",
    "these two bundles of lines in l13 are consistent with the euv background g13 from all points of view .",
    "the next group is l14 which displays a radial pattern rooted from p1 .",
    "these structures spread to the outside of the computing area and are in good agreement with upper part of g14 in the central column in figure  [ g121314 ] .",
    "some open coronal loops in lower part of g14 in the central column are actually connected to lower magnetic pore region outside ar 11158 as shown in figure  [ fulldisk](b ) , which are not included in the present magnetogram area employed as boudnary condition .",
    "therefore the corresponding lower part field lines of l14 at first follow the loop tendency but at higher altitude they bend back to deviate from the real coronal loops , which should be due to the ignorance of the boundary field outside of the magnetogram area .",
    "the reconstructed topology configurations of the magnetic fields in noaa 11158 is stereoscopically presented for the first time with comparison to observation from three points of view .",
    "this allows us to understand this active region more comprehensively .",
    "the calculated magnetic field lines replicate the observed euv loop patterns well from different views .",
    "these results demonstrate clearly that the dbie method is effective when it is applied to the actual photospheric magnetogram .",
    "the gpu acceleration makes dbie tractable even if applied to large - scale domains . from the reconstructed coronal field structures",
    ", we can estimate the altitude of euv loop patterns which we found to be below 86 mm , or  40% of the length of the magnetogram area .",
    "they also match the actual euv features as estimated from stereoscopic observations . in this region",
    "the dbie can achieve very high numerical accuracy . in the present case for @xmath91 internal grid points , the averaged angle between * b * and *",
    "j * is less than 4.5@xmath93 and the averaged relative flux error @xmath96 .    in the central sunspot cluster ,",
    "the current density is very strong along the filament in the pil , and the current density distribution on a vertical cross section was plotted ( sun et al . , 2012 ) .",
    "our results agree very well with the situation that there are strong currents across the pil and we found enlongate lower - lying twisting field lines co - spatial with the s - shaped filament along the pil .",
    "however , we argue that one can not simply attribute all the euv bright features along the pil to manifestation of a filament although the filament could be located there . furthermore , we have obtained the electric current lines three - dimensionally at higher altitude across the pil in this region from three points of view . according to their agreements with the bright euv loop structures there ,",
    "we think that the features dominated by the strong currents should really exist above the pil . generally speaking",
    ", the region with strong currents should contain a large amount of accumulated free energy and will eventually release quickly in this region .",
    "it is most possible that the extrapolated magnetic field lines resembling the s - shaped filament channel and the electric current lines agreeable with the bright euv loops twistingly overlying the filament may be associated with the occurrence of the x2.2 flare .",
    "it should be noted that while the line - of - sight ( from the earth direction ) co - alignments between calculated field lines and observed coronal loops agree with each other , the views from other sides may show that they do not actually agree three - dimensionally and belong to other groups .",
    "this indicates that co - alignment with line - of - sight images from the earth direction alone may not provide the accurate coronal configuration and the real three - dimensional information is vital in understanding the coronal magnetic field structures and their associations with solar activities .",
    "for the three stereoscopically reconstructed coronal loops , we quantitatively obtain the averaged misalignment angles of 16.6@xmath93 , 17.8@xmath93 , and 18.3@xmath93 respectively , which are quite good with a factor of about two smaller than those given by other nlfff models yielding overall misalignment angles of @xmath95 ( derosa et al .",
    "2009 ) , and at the same order as a forward - fitting model with reconstructed coronal loops as given conditions ( sandman and aschwanden 2011 ) .    as a method different from others while they demonstrate similar computational capability , dbie has the advantage that it just needs photospheric data as the boundary condition and allows to evaluate the nlfff field at every arbitrary point within the domain from the boundary data instead of having to solve the entire domain .",
    "the dbie can be accelerated by parallel algorithm such as gpu techniques , which makes the dbie method be applied into larger boundary condition .",
    "the present study validates that the dbie method is rigorous and practical .",
    "in addition further acceleration could combine cuda with mpi to realize muti - gpu parallelization , which will improve the computational efficiency of dbie method largely .",
    "as the first images of chinese spectral radioheliograph ( csrh , yan et al . , 2009 ) have been obtained , the comparison between our extrapolation and the tomography observation from csrh will be carried out in the near future .",
    "the authors would like to thank the referee for the helpful and valuable comments on this paper .",
    "yingna su is acknowledged for improving the english of the manuscript and helpful comments .",
    "l. a. selzer is acknowledged for improving the english of the manuscript as well .",
    "we thank the sdo and stereo team for providing the magnetic field data and euv images used in this investigation .",
    "we also wish to thank dr .",
    "thompson for his efficient support in the routine for correcting the stereo data error .",
    "this work is supported by nsfc grants no .",
    "11221063 , 11273030 , and 11211120147 , most grant no .",
    "2011cb811401 , and the national major scientific equipment r&d project zdyz2009 - 3 .",
    "part of experiments were implemented on the scgrid and gpu cluser of supercomputing center , computer network information center of chinese academy of sciences .",
    "gary , g.a .",
    ": 1989 , _ astrophys .",
    "j. suppl . _",
    "* 69 * , 323 .",
    "gary , d.e . , hurford , g.j . : 1994 , _ astrophys .",
    "j._**420 * * , 903 .",
    "grad , h. , rubin , h. : 1958 , _ in 2nd int .",
    "uses of atom .",
    "* 31 * ( geneva : un ) , 190 . he , h. , wang , h. : 2008 , _ j. geophys .",
    "* 113*. he , h. , wang , h. , yan , y. : 2011 , _",
    "j. geophys .",
    "res . _ * 116 * , 01101 .",
    "howard , r.a . ,",
    "moses , j.d . ,",
    "vourlidas , a , newmark , j.s . ,",
    "socker , d.g . ,",
    "plunkett , s.p . , _",
    "et al . _ : 2008 , _ space sci . rev._**136",
    "inhester , b. , wiegelmann , t. : 2006 , _ solar phys._**235 * * , 201 .",
    "jiang , c.w . , feng , x.s . , fan , y.l . , xiang , c.q . : 2011 , _ astrophys . j._**727 * * , 101 .",
    "jiang , c.w .",
    ", feng , x.s .",
    ": 2012 , _ astrophys . j._**749 * * , 135 .",
    "jiang , j. , park , s.h . , lee , j. , wiegelmann . t. , xu , y. , deng .",
    "n , wang . h. : 2012 , _ astrophys .",
    "j._**752 * * , l9 .",
    "lemen , j.r . ,",
    "title , a.m. , akin , d.j . , _ et al . _ : 2012 , _ solar phys._**275 * * , 17    li , z. , yan , y. , song , g. : 2004 , _ mon . not .",
    "astron . soc._**347 * * , 1255 .",
    "lin , h. , kuhn , j.r . ,",
    "coulter , r. : 2004 , _ astrophys .",
    "j._**9 * * , 611 .",
    "liu , s. , zhang , h.q . , su , j.t . , song , m.t . : 2011 , _ solar phys._**269 * * , 41 .",
    "liu , s. , zhang , h.q .",
    ", su , j.t .",
    ": 2012 , _ astrophys .",
    "space sci . _ * 337 * , 665 .",
    "liu , y. , zhao , x.p . ,",
    "hoeksema , j.t . ,",
    "scherrer , p.h . ,",
    "wang , j. , yan , y. : 2002 , _ solar phys._**206 * * , 333 .",
    "low , b.c . ,",
    "lou , y.q . : 1990 , _ astrophys . j._**352 * * , 343 .",
    "mcclymont , a.n . ,",
    "jiao , l. , mikic , z. : 1997 , _ solar phys._**174 * * , 191 .",
    "mikic , z. , mcclymont , a.n . : 1994 , _ in asp conf .",
    "68 , solar active region evolution : comparing models with observations , ed .",
    "balasubramaniam and g.w .",
    "simon ( san francisco , ca : asp ) _ * 225 * nakagawa , y. : 1974 , _ astrophys . j._.",
    "* 190 * , 437 .",
    "nelder , j.a .",
    ", mead , r. : 1965 , _ comput .",
    "j. _ * 7 * , 308 .",
    "roumeliotis , g. : 1996 , _ astrophys . j._. * 473 * , 1095 .",
    "rudenko , g.v .",
    "myshyakov , i.i . : 2009 , _ solar phys._**257 * * , 287 sakurai , t. : 1981 , _ solar phys._**69 * * , 343 .",
    "sandman , a.w . ,",
    "aschwanden , m.j . : 2011 , _ solar phys._**270 * * , 503 .",
    "schou , j. , scherrer , p.h . , bush , r.i . , _ et al .",
    "_ : 2012 , _ solar phys._**275 * * , 229 schrijver , c.j . ,",
    "aulanier , g. , title , a.m. , pariat , e. , delanne , c. : 2011 , _ astrophys . j._**738 * * , 167 .",
    "schrijver , c.j . ,",
    "derosa , m.l . ,",
    "metcalf , t.r . ,",
    "liu , y. , mctiernan , j. , rgnier , s. , _ et al . _",
    ": 2006 , _ solar phys._**235 * * , 161 . song , m.t . , fang , c. , tang , y.h .",
    ", wu , s.t . , zhang , y.a . : 2006 , _ astrophys .",
    "j._**649 * * , 1084 .",
    "song , q. , zhang , j. , yang , s.h . ,",
    "liu , y. : 2013 , _ res .",
    "astrophys . _ * 13 * , 226 .",
    "su , y. , van ballegooijen , a. : 2012 , _ astrophys . j._**757 * * , 168 .",
    "sun , x. , hoeksema , j.t . ,",
    "liu , y. , wiegelmann , t. , hayashi , k. , chen , q. , thalmann , j. : 2012 , _ astrophys . j._**748 * * , 77 .",
    "thompson , w.t . : 2006 , _ astron . astrophys._**449 * * , 791 .",
    "valori , g. , kliem , b. , fuhrmann , m. : 2007 ,",
    "_ solar phys._**245 * * , 263 .",
    "valori , g. , kliem , b. , keppens , r. : 2005 , _ astron .",
    "_ , * 433 * , 335 .",
    "vemareddy , p. , ambastha , a. , maurya , r.a . : 2012 , _ astrophys .",
    "j._**761 * * , 60 .",
    "wang , h. , yan , y. , sakuari , t. : 2001 , _ solar phys._**201 * * , 323 .",
    "wheatland , m. s. : 2006 , _ solar phys._**238 * * , 29 .",
    "wheatland , m.s . ,",
    "sturrock , p.a . ,",
    "roumeliotis , g. : 2000 , _ astrophys . j._**540 * * , 1150 .",
    "wiegelmann , t. : 2004 , _ solar phys._**219 * * , 87 .",
    "wiegelmann , t. : 2007 , _ solar phys._**240 * * , 227 .",
    "wiegelmann , t. : 2008 , _ j. geophys .",
    "res._**113 * * , 3 .",
    "wiegelmann , t. , neukirch , t. : 2006 , _ astron . astrophys._**457 * * , 1053 .",
    "wiegelmann , t. , thalmann , j.k . , inhester , b. , tadesse , t. , sun , x. , hoeksema , j.t . : 2012 , _ solar phys._**281 * * , 37 .",
    "w@xmath76lser , j.p . , lemen , j.r .",
    ", tarbell , t.d . ,",
    "wolfson , c.j . ,",
    "cannon , j.c . , carpenter , b.a . , _",
    "et al . _ : 2004 , _ proc .",
    "spie _ * 5171 * , 111 .",
    "wu , s.t . ,",
    "sun , m.t . ,",
    "chang , h.m .",
    ", hagyard , m.j . ,",
    "gary , g.a . : 1990 , _ astrophys . j._**362 * * , 698 .",
    "yan , y. : 2003 , _ space sci .",
    "rev._**107 * * , 119 .",
    "yan , y. , li , z. : 2006 , _ astrophys .",
    "j._**638 * * , 1162 .",
    "yan , y. , liu , y. , akioka , m. , wei , f. : 2001 , _ solar phys._**201 * * , 337 .",
    "yan , y. , sakurai , t. : 1997 , _",
    "solar phys._**174 * * , 65 .",
    "yan , y. , sakurai , t. : 2000 , _ solar phys._**195 * * , 89 .",
    "yan y. , zhang j. , wang w. , liu f. , chen z. , ji g. , 2009 , _ earth moon planet _ , * 104 * , 97"
  ],
  "abstract_text": [
    "<S> a 3-d coronal magnetic field is reconstructed for the noaa active region 11158 on february 14 , 2011 . </S>",
    "<S> a gpu - accelerated direct boundary integral equation ( dbie ) method is implemented . </S>",
    "<S> this is approximately 1000 times faster than the original dbie used on solar non - linear force - free field modeling . using the sdo / hmi vector magnetogram as the bottom boundary condition , </S>",
    "<S> the reconstructed magnetic field lines are compared with the projected euv loop structures as observed by sdo / aia at front view and the stereo a / b spacecraft at side views for the first time . </S>",
    "<S> they show very good agreement three - dimensionally so that the topology configurations of the magnetic fields can be analyzed , thus its role in the flare process of the active region can be better understood . </S>",
    "<S> a quantitative comparison with some stereoscopically reconstructed coronal loops shows that the present averaged misalignment angles are at the same order as the state - of - the - art results obtained with reconstructed coronal loops as prescribed conditions . </S>",
    "<S> it is found that the observed coronal loop structures can be grouped into a number of closed and open field structures with some central bright coronal loop features around the polarity inversion line . </S>",
    "<S> the reconstructed highly - shearing magnetic field lines agree very well with the low - lying sigmoidal filament along the polarity inversion line . </S>",
    "<S> they are in a pivot position to all other surrounding coronal structures , and a group of electric current lines co - aligned with the central bright euv loops overlying the filament channel is also obtained . </S>",
    "<S> this central lower - lying magnetic field loop system must have played a key role in powering the flare . it should be noted that while a strand - like coronal feature along the polarity inversion line may be related to the filament , one can not simply attribute all the coronal bright features along the polarity inversion line to manifestation of the filament without any stereoscopical information . the numerical procedure and the comparison against a benchmark test case are also presented to validate that the dbie method is rigorous and effective . </S>"
  ]
}