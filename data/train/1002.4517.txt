{
  "article_text": [
    "monte carlo simulations , and in particular markov chain based methods , have matured over the last decades into a highly versatile and powerful toolbox for studies of systems in statistical and condensed - matter physics @xcite , ranging from classical spin models @xcite over soft - matter problems @xcite to quantum systems @xcite .",
    "their competitiveness with other approaches such as , e.g. , field - theoretic expansions for the study of critical phenomena @xcite , is largely based on the development and refinement of a number of advanced simulation techniques such as cluster algorithms @xcite and generalized - ensemble methods @xcite .",
    "equally important to the generation of simulation data , however , is their correct and optimal analysis . in this field , a number of important advances over the techniques used in the early days have been achieved as well .",
    "these include , e.g. , the finite - size scaling ( fss ) approach @xcite , turning the limitation of simulational methods to finite system sizes into a systematic tool for accessing the thermodynamic limit , reweighting techniques @xcite , lifting the limitation of numerical techniques to the study of single points in parameter space to allow for continuous functions of estimates to be studied , as well as advanced statistical tools such as the jackknife and other resampling schemes of data analysis @xcite .    of these techniques , the statistical data analysis appears to have received the least attention .",
    "hence , while fss analyses , even including correction terms , are quite standard in computer simulation studies @xcite , a proper analysis and reduction of statistical errors and bias appears to be much less common . here",
    ", resampling methods turn out to be very valuable .",
    "although such techniques offer a number of benefits over more traditional approaches of error estimation , their adoption by practitioners in the field of computer simulations has not yet been as universal as desirable .",
    "it is our understanding that this is , in part , due to a certain lack in broadly accessible presentations of the basic ideas which are , in fact , very simple and easy to implement in computer codes , as is demonstrated below .",
    "more specifically , data generated by a monte carlo ( mc ) simulation are subject to two types of correlation phenomena , namely ( a ) _ autocorrelations _ or temporal correlations for the case of markov chain mc ( mcmc ) simulations , which are directly related to the markovian nature of the underlying stochastic process and lead to an effective reduction of the number of independently sampled events and ( b ) _ cross correlations _ between different estimates extracted from the same set of original time series coming about by the origin of estimates in the same statistical data pool .",
    "the former can be most conveniently taken into account by a determination of the relevant autocorrelation times and a blocking or binning transformation resulting in an effectively uncorrelated auxiliary time series @xcite .",
    "such analyses are by now standard at least in seriously conducted simulational studies . on the contrary",
    ", the effects of cross correlations have been mostly neglected to date ( see , however , refs .",
    "@xcite ) , but are only systematically being discussed following our recent suggestion @xcite . in this article , we show how such cross correlations lead to systematically wrong estimates of statistical errors of averaged or otherwise combined quantities when a nave analysis is employed , and how a statistically correct analysis can be easily achieved within the framework of the jackknife method .",
    "furthermore , one can even take benefit from the presence of such correlation effects for significantly reducing the variance of estimates without substantial additional effort .",
    "we demonstrate the practical relevance of these considerations for a finite - size scaling study of the ising model in two and three dimensions .    the rest of this article is organized as follows . in sec .",
    "ii we give a general recipe for a failsafe way of monte carlo data analysis , taking into account the effects of autocorrelations and cross correlations mentioned above . after discussing the complications for the more conventional analysis schemes ( but not the jackknife method ) introduced by histogram reweighting and generalized - ensemble simulation techniques in sec .",
    "iii , we outline the role of cross correlations in the process of averaging over a set of mc estimates in sec .",
    "iv and discuss the choice of an optimal averaging procedure . in sec .",
    "v , these ideas are applied to a simulational study of the critical points of the two- and three - dimensional ising models .",
    "finally , sec .",
    "vi contains our conclusions .",
    "compared to the task of estimating the uncertainty in the result of a lab experiment by simply repeating it several times , there are a number of complications in correctly determining  and possibly even reducing  statistical fluctuations in parameter estimates extracted from mcmc simulations .",
    "firstly , due to the memory of the markovian process , subsequent measurements in the time series are correlated , such that the fluctuations generically appear smaller than they are .",
    "this issue can be resolved by a _ blocking _ of the original time - series data .",
    "secondly , one often needs to know the precision of parameter estimates which are complicated ( and sometimes non - parametric ) functions of the measured observables .",
    "such problems are readily solved using resampling techniques such as the _",
    "jackknife_.      consider a general monte carlo simulation with the possible values @xmath0 of a given observable @xmath1 appearing according to a probability distribution @xmath2 .",
    "this form , of course , implies that the system is in thermal equilibrium , i.e. , that the underlying stochastic process is stationary .",
    "the probability density @xmath2 could be identical to the boltzmann distribution of equilibrium thermodynamics as for the importance - sampling technique @xcite , but different situations are conceivable as well , see the discussion in sec .",
    "[ sec : histo ] below .",
    "if we assume ergodicity of the chain , the average @xmath3 for a time series @xmath4 of @xmath5 measurements is an unbiased estimator of the mean @xmath6 in contrast to @xmath7 , the estimator @xmath8 is a random number , which only coincides with @xmath7 in the limit @xmath9 . under these circumstances ,",
    "simulational results are only meaningful if in addition to the average @xmath8 we can also present an estimate of its variance @xmath10 .",
    "note that , although the distribution @xmath2 of individual measurements might be arbitrary , by virtue of the central limit theorem the distribution of the averages @xmath8 must become gaussian for @xmath9 .",
    "hence , the variance @xmath10 is the ( only ) relevant parameter describing the fluctuations of @xmath8 .",
    "if subsequent measurements @xmath11 , @xmath12 , @xmath13 are uncorrelated , we have @xmath14 which can be estimated without bias from @xcite @xmath15 i.e. , @xmath16 .",
    "this is what we do when estimating the statistical fluctuations from a series of independent lab experiments .",
    "markov chain simulations entail the presence of temporal correlations , however , such that the connected autocorrelation function , @xmath17 is non - zero in general ( see , e.g. , ref .",
    "stationarity of the chain implies that @xmath18 .",
    "then , the variance of @xmath8 becomes @xmath19.\\ ] ] monte carlo correlations decline exponentially , i.e. , @xmath20 to leading order , defining the _ exponential autocorrelation time _ @xmath21 . due to this exponential decay , for @xmath22 the deviations of the factors @xmath23 of eq .",
    "( [ eq : sigma_autocorr ] ) from unity can be neglected @xcite , and defining the _ integrated autocorrelation time _ as @xmath24 one has @xmath25 in view of the @xmath26 reduction of variance of the average @xmath8 relative to a single measurement in eq .",
    "( [ eq : sigma_noautocorr ] ) , eq .",
    "( [ eq : tau_reduction ] ) states that the _ effective _ number of independent measurements in the presence of autocorrelations is reduced by a factor of @xmath27 .",
    "the autocorrelation times @xmath28 and @xmath29 are not identical , but one can show that the latter is a lower bound of the former , @xmath30 @xcite .     (",
    "a ) . in the jackknifing analysis , the blocks consist of the whole series _ apart _ from the entries of a single block ( b ) .",
    "[ fig : block ] , width=283 ]    as long as the autocorrelation time is finite , the distribution of averages still becomes gaussian asymptotically , such that for @xmath31 the variance remains the relevant quantity describing fluctuations . to practically determine @xmath10 from eq .",
    "( [ eq : sigma_autocorr ] ) , an estimate for the autocorrelation function is required .",
    "this can be found from the definition ( [ eq : autocorrelation_function ] ) by replacing expectation values with time averages .",
    "it turns out , however , than upon summing over the contributions of the autocorrelation function for different time lags @xmath32 in eq .",
    "( [ eq : sigma_autocorr ] ) divergent fluctuations are incurred , enforcing the introduction of a cut - off time @xcite .",
    "several approximation schemes have been developed using such estimators , but they turn out to have severe drawbacks in being computationally expensive , hard to automatize and in that estimating their statistical accuracy is tedious ( see ref .",
    "@xcite ) .    a more efficient and very intuitive technique for dealing with autocorrelations results from a blocking transformation in the spirit of the renormalization group @xcite ( in fact",
    ", this idea was already formulated by wilson @xcite ) .",
    "much like block spins are defined there , one combines @xmath33 adjacent entries of the time series , @xmath34 and defines block averages @xmath35 cf .",
    "[ fig : block](a ) .",
    "this procedure results in a shorter effective time series @xmath36 with @xmath37 entries .",
    "( we assume for simplicity that @xmath5 is an integer multiple of @xmath37 . ) obviously , the average @xmath8 and its variance @xmath10 are invariant under this transformation . under the exponential decay ( [ eq : exponential_autocorr ] ) of autocorrelations of the original series it is clear ( and can be shown explicitly @xcite ) , however , that",
    "subsequent block averages @xmath38 , @xmath39 are less correlated than the original measurements @xmath40 and @xmath41 .",
    "furthermore , the remaining correlations must shrink as the block length @xmath42 is increased , such that asymptotically for @xmath43 ( while still ensuring @xmath44 ) an uncorrelated time series is produced .",
    "consequently , the nave estimator ( [ eq : variance_of_mean_notautocorr ] ) can be legally used in this limit to determine the variance @xmath10 of the average . for the finite time",
    "series encountered in practice , a block length @xmath45 and @xmath46 must be used .",
    "this is illustrated in figure [ fig : bins ] showing the estimate ( [ eq : variance_of_mean_notautocorr ] ) for a blocked time series with autocorrelation time @xmath47 as a function of the block length @xmath42 .",
    "it approaches the true variance @xmath10 from below , eventually reaching a plateau value where any remaining pre - asymptotic deviations become negligible compared to statistical fluctuations . if the available time series is long enough ( as compared to @xmath48 )",
    ", it is often sufficient to simply lump the data into as few as some hundred blocks and restrict the subsequent data analysis to those blocks . as a rule of thumb , in practical applications it turns out that a time series of length @xmath49 is required for a reliable determination of statistical errors as well as autocorrelation times . from eqs .",
    "( [ eq : variance_of_mean_notautocorr ] ) and ( [ eq : tau_int ] ) it follows that the integrated autocorrelation time can be estimated from @xmath50 within this scheme , where @xmath42 needs to be chosen in the plateau regime of fig .",
    "[ fig : bins ] .     of the variance of the average according to eq .",
    "( [ eq : variance_of_mean_notautocorr ] ) for a re - blocked time series as a function of the block length @xmath42 .",
    "[ fig : bins ] ]      apart from providing an estimate of @xmath10 for simple quantities , the blocking procedure has the advantage of resulting in an effectively uncorrelated auxiliary time series which can then be fed into further statistical machinery , much of which is restricted to the case of independent variables .",
    "resampling schemes such as the jackknife @xcite provide error and bias estimates also for non - linear functions of observables without entailing truncation error or requiring assumptions about the underlying probability distributions .    while @xmath10 can be directly computed from the blocked time series of @xmath1 via the estimator ( [ eq : variance_of_mean_notautocorr ] )",
    ", this approach fails for non - linear functions @xmath51 of expectation values @xmath52 , @xmath53 , @xmath13 such as , e.g. , susceptibilities or cumulants .",
    "a standard approach for such cases is the use of error propagation formulas based on taylor expansions",
    "@xcite , @xmath54    = { \\ensuremath{\\frac{\\partial f}{\\partial \\l a\\r}}}\\sigma^2(a)+{\\ensuremath{\\frac{\\partial f}{\\partial \\l b\\r}}}\\sigma^2(b)+\\cdots.\\ ] ] apart from the truncation error resulting from the restriction to first order in the expansion , this entails a number of further problems : if the averages @xmath55 , @xmath56 etc .",
    "are correlated due to their origin in the same simulation , cross - correlation terms need to be included as well .",
    "even worse , for the case of non - parametric parameter estimates , such as determining the maximum of some quantity by reweighting ( see below ) or extracting a critical exponent with a fitting procedure , error propagation can not be easily used at all .",
    "such problems are avoided by methods based on repeated sampling from the original data pool , using the properties of these meta samples to estimate , reduce bias etc .",
    "these are modern techniques of mathematical statistics whose application only became feasible with the general availability of computers @xcite .",
    "most straightforwardly applicable is the jackknife procedure , where the meta samples consist of all of the original time series apart from one data block , cf .",
    "[ fig : block](b ) .",
    "assume that a set of simulations resulted in a collection of time series @xmath57 , @xmath58 , @xmath59 , @xmath13 for different observables , system sizes , temperatures etc .",
    "applying the blocking procedure described above , it is straightforward to divide the series in effectively uncorrelated blocks .",
    "it is often convenient to use the same number of blocks @xmath37 for all series ( e.g. , 100 ) which can easily be arranged for by the blocking transformation as long as @xmath60 is larger than some minimum value ( e.g. , @xmath61 ) for each simulation and observable .",
    "if then @xmath62 denotes the @xmath63 block over all series according to eq .",
    "( [ eq : block_definition ] ) , where for a constant number of blocks the block lengths @xmath64 might vary between the different series under consideration , one defines the corresponding _ jackknife block _ as the complement @xmath65 cf .",
    "[ fig : block ] .",
    "considering now an estimator @xmath66 for some parameter @xmath67 depending on ( some or all of ) the different series , we define the corresponding estimates restricted to jackknife block @xmath68 , @xmath69.\\ ] ] the variation between these estimates taken from the same original data can be used to infer the sample variance .",
    "if one denotes the average of the jackknife block estimators ( [ eq : jackknife_blocks ] ) as @xmath70 an estimate for the sample variance of the estimator @xmath71 is given by @xcite @xmath72 ^ 2.\\ ] ] this is very similar to the simple estimate ( [ eq : variance_of_mean_notautocorr ] ) for the variance of the average , but it comes with a different prefactor which serves a twofold purpose : it reweights the result from the effective jackknife series of length @xmath73 to the original length @xmath37 and takes care of the fact that all of the jackknife block estimates @xmath74 are strongly correlated due to them being based on ( almost ) the same data . the general eq .",
    "( [ eq : jackknife_variance ] ) forms a conservative and at most weakly biased estimate of the true variance @xcite , which lacks the truncation error of schemes based on eq .",
    "( [ eq : error_propagation ] ) and is applicable to non - parametric parameter estimates .    in a slight generalization of eq .  ( [ eq : jackknife_variance ] ) it is possible to also estimate covariances . for a number of estimators @xmath75 , @xmath76 , @xmath59 , @xmath13",
    ", a robust jackknife estimator of the covariance matrix is given by @xmath77    \\left[\\hat{\\theta}_{j(s)}-\\hat{\\theta}_{j(\\cdot)}\\right].\\ ] ] in a similar way the bias of estimators can be reduced , i.e. , deviations between the mean of an observable and the expectation value of some estimator that disappear with increasing sample length .",
    "for a detailed discussion we refer the reader to refs .",
    "@xcite .",
    "a general procedure for the analysis of simulation data based on blocking and jackknife techniques hence has the following form :    1 .",
    "decide on the number @xmath37 of jackknife blocks to be used . for most purposes , of the order of @xmath78 blocks",
    "are sufficient .",
    "2 .   for each original time series recorded in a collection of simulations , examine the block averages ( [ eq : block_averages ] ) as a function of the block length @xmath79 . if the result for @xmath37 blocks is in the plateau regime of fig .",
    "[ fig : bins ] everything is fine ; otherwise , one needs to record a longer time series ( and possibly take measurements less frequently to keep the amount of data manageable ) .",
    "3 .   for each parameter to be estimated , compute the @xmath37 jackknife block estimates ( [ eq : jackknife_blocks ] ) as well as the average ( [ eq : jackknife_average ] ) and",
    "combine them to calculate the variance ( [ eq : jackknife_variance ] ) . for a number of different parameter estimates",
    "@xmath80 , the jackknife block estimates can also be used to calculate the covariance ( [ eq : jackknife_covariance ] ) .",
    "an increasing number of successful monte carlo techniques rely on reweighting and the use of histograms @xcite .",
    "this includes the ( multi-)histogram method of refs .",
    "@xcite as well as the plethora of generalized ensemble techniques ranging from multicanonical simulations @xcite to wang - landau sampling @xcite .",
    "such methods are based on the fact that samples taken from a known probability distribution can always be translated into samples from another distribution over the same state space .",
    "assume , for simplicity , that states are labeled @xmath81 as appropriate for a spin system .",
    "if a sequence @xmath82 , @xmath83 , @xmath59 , @xmath13 was sampled from a stationary simulation with probability density @xmath84 , an estimator for the expectation value of the observable @xmath1 relative to the _ equilibrium _ distribution is given by @xmath85 for a finite simulation this works as long as the sampled and the equilibrium distributions have sufficient _ overlap _ , such that the sampled configurations can be representative of the equilibrium average at hand . for simple sampling",
    "one has @xmath86 and hence must weight the resulting time series with the boltzmann factor @xmath87 where @xmath88 denotes the energy of the configuration @xmath81 and @xmath89 is the partition function at inverse temperature @xmath90 . for importance sampling , on the other hand , @xmath91 , such that averages of time series are direct estimates of thermal expectation values . if samples from an importance sampling simulation with @xmath92 should be used to estimate parameters of @xmath93 , eq .",
    "( [ eq : general_estimate ] ) yields the familiar ( temperature ) reweighting relation @xmath94 where @xmath95 .",
    "completely analogous equations can be written down , of course , for reweighting in parameters other than temperature .",
    "similarly , canonical averages at inverse temperature @xmath96 are recovered from multicanonical simulations via using eq .",
    "( [ eq : general_estimate ] ) with @xmath97 and @xmath98 .",
    "reliable error estimation ( as well as bias reduction , covariance estimates etc . ) for reweighted quantities is rather tedious with traditional statistical techniques such as error propagation @xcite .",
    "resampling methods , on the other hand , allow for a very straightforward and reliable way of tackling such problems .",
    "for the jackknife approach , for instance , one computes jackknife block estimates of the type ( [ eq : general_estimate ] ) by simply restricting the set of time series to the @xmath99 jackknife block @xmath68 . with the jackknife average ( [ eq : jackknife_average ] ) , e.g. ,",
    "the variance estimate ( [ eq : jackknife_variance ] ) with @xmath100 can be straightforwardly computed .",
    "similar considerations apply to covariance estimates or bias reduced estimators @xcite .",
    "extremal values of thermal averages can be determined to high precision from the continuous family of estimates ( [ eq : temperature_reweighting ] ) , where error estimates again follow straightforwardly from the jackknife prescription .",
    "temporal correlations resulting from the markovian nature of the sampling process have been discussed in sec .",
    "[ sec : autocorr ] above , and we assume that they have been effectively eliminated by an appropriate binning procedure . extracting a number of different parameter estimates @xmath80 , @xmath76 , @xmath59 , @xmath13 from the same number of original simulations it is clear , however , that also significant _ cross correlations _ between estimates @xmath80 and @xmath101 can occur .",
    "these have profound consequences for estimating statistical error and reducing it by making the best use of the available data @xcite .",
    "if a given parameter estimate @xmath71 depends on several observables of the underlying time series that exhibit cross correlations , this fact is _ automatically _ taken into account correctly by the jackknife error estimate ( [ eq : jackknife_variance ] ) .",
    "this is in contrast to error analysis schemes based on error propagation formulae of the type ( [ eq : error_propagation ] ) , where any cross correlations must be taken into account explicitly .",
    "insofar the outlined approach of data analysis is failsafe .",
    "we want to go beyond that , however , in trying to _ optimize _ statistical precision of estimates from the available data . if we attempt to estimate a parameter @xmath67 , we ought to construct an estimator @xmath102 which is a function of the underlying time series with the property that @xmath103 ( at least for @xmath104 ) .",
    "obviously , there usually will be a large number of such functions @xmath105 and it is not possible , in general , to find the estimator @xmath71 of minimal variance .",
    "we therefore concentrate on the tractable case where @xmath71 is a linear combination of other estimators @xmath80 , @xmath106 , @xmath107 there are different possibilities to ensure the condition",
    "@xmath108 :    1 .",
    "all estimators have the same expectation , @xmath109 , and @xmath110 .",
    "one estimator is singled out , say @xmath111 , @xmath112 , and the rest has vanishing expectation , @xmath113 , @xmath114 arbitrary , @xmath115 .",
    "3 .   more complicated situations .    the first type describes the case that we have several different estimators for the same quantity and want to take an average of minimum variance @xcite .",
    "the second case is tailored for situations where existing symmetries allow to _ construct _ estimators with vanishing expectation whose cross correlations might reduce variance @xcite .    to optimize the analysis , the parameters @xmath114 in ( [ eq : linear_combination ] )",
    "should be chosen such as to minimize the variance @xmath116 \\equiv \\sum_{i , j = 1}^k     \\alpha_i\\alpha_j\\gamma_{ij}(\\hat{\\theta})\\ ] ] for case one above , we introduce a lagrange multiplier to enforce the constraint @xmath117 , and the optimal choice of @xmath114 is readily obtained as @xmath118_{ij } }    { \\sum_{i , j=1}^k [ \\gamma(\\hat{\\theta})^{-1}]_{ij}},\\ ] ] leading to a minimum variance of @xmath119_{ij}}.\\ ] ] very similarly , case two leads to the choice @xmath120_{ij}\\gamma(\\hat{\\theta})_{j1},\\ ] ] where @xmath121 denotes the submatrix of @xmath122_{ij}$ ] with @xmath123 .",
    "since the formalism for both cases is practically identical , in the following we will concentrate on case one .",
    "let us take the time to compare the _ optimal _ choice of weights expressed in eqs .",
    "( [ eq : covariance_weighted ] ) and ( [ eq : covariance_weighted_other ] ) with that used in more traditional approaches . ignoring the presence of cross correlations , several parameter estimates",
    "are often combined using an error weighting scheme only , i.e. , by choosing weights @xmath124 while the more general expression ( [ eq : covariance_weighted ] ) reduces to the weights ( [ eq : error_weighted ] ) in the absence of correlations , the choice ( [ eq : error_weighted ] ) is _ not optimal _ as soon as cross correlations are present .",
    "still , the resulting average @xmath71 remains a valid estimator of the parameter @xmath67 .",
    "in contrast , the usually used variance estimate derived from the expression @xmath125 is _ no longer even correct _ when cross correlations come into play .",
    "as will be seen below from the discussion of ising model simulations in sec .",
    "[ sec : application ] , @xmath126 generically leads to underestimation of the true variance , but occasionally over - estimates are possible as well .",
    "the practical implementation of the described scheme of weighting and error analysis is straightforward with the toolset outlined in the previous sections .",
    "the covariance matrix of the estimates @xmath80 is readily computed via the jackknife expression ( [ eq : jackknife_covariance ] ) .",
    "this allows to estimate the optimal weights from inserting @xmath127 in eq .",
    "( [ eq : covariance_weighted ] ) ( or the analogue ( [ eq : covariance_weighted_other ] ) for case two ) and the variance of the resulting optimal estimator is determined from the expression ( [ eq : minimum_variance ] ) . in total , the necessary analysis can be summarized as follows :    1 .",
    "perform a binning analysis to see whether for a given number of blocks @xmath37 the block averages ( [ eq : block_averages ] ) for all time series at hand are effectively uncorrelated .",
    "2 .   for each parameter estimate @xmath80 compute the @xmath37 jackknife block estimates ( [ eq : jackknife_blocks ] ) as well as their average and estimate their covariance matrix from eq .",
    "( [ eq : jackknife_covariance ] ) .",
    "3 .   for those estimates",
    "@xmath80 to be combined into an average @xmath71 , an estimate of the optimal weighting parameters @xmath114 is given by eq .",
    "( [ eq : covariance_weighted ] ) with the estimate @xmath127 calculated in the previous step .",
    "likewise , the variance of the resulting average is estimated from eq .",
    "( [ eq : minimum_variance ] ) .    in some cases , it is necessary to already have variance estimates of intermediate data available for properly determining the jackknife block estimates @xmath128 .",
    "this typically occurs when @xmath80 is a parameter resulting from an ( ideally error weighted ) fit to a number of data points , such as for the case of a critical exponent , see the discussion below in sec .",
    "[ sec : application ] . in these cases",
    "it is straightforward to iterate the jackknifing procedure to second order by considering each jackknife block as the initial time series of another jackknife analysis @xcite .    in view of the sometimes counter - intuitive results of computing weighted averages taking cross correlations into account",
    "( see the results in sec .",
    "[ sec : application ] below ) , it is instructive to examine the simple case of just two different estimates @xmath129 and @xmath130 in somewhat more detail .",
    "this is done in appendix [ sec : app ] .",
    ") resp . ( [ eq : logmagnderiv_scaling ] ) to the maxima data @xmath131 of the following quantities computed for the case of the 2d ising model : @xmath132 , @xmath133 , @xmath134 , @xmath135 and @xmath136 ( from top to bottom ) . for performing the fits , the correction terms in brackets of eqs .",
    "( [ eq : cumulant_scaling ] ) and ( [ eq : logmagnderiv_scaling ] ) were neglected .",
    "the actual fits have been performed on the size range @xmath137 .",
    "the slopes of the lines are identical to the inverse of the corresponding estimates of the correlation length exponent @xmath138 listed in table  [ tab:2d_nu ] . ]",
    "although the outlined scheme of monte carlo data analysis is completely general , it is useful to see how it works out for a specific example . in particular",
    ", one would like to know if the typical cross correlations are sufficiently strong to have significant impact on the results . to answer this question",
    ", we performed a finite - size scaling ( fss ) analysis of the ordering transition of the ferromagnetic ising model in two and three dimensions .",
    "we studied the critical behavior of the nearest - neighbor , zero - field , ferromagnetic ising model with hamiltonian @xmath139 on square and simple cubic lattices of edge length @xmath140 , using periodic boundary conditions .",
    "close to criticality , an importance - sampling monte carlo simulation with local update rule suffers from critical slowing down , @xmath141 , with a dynamical critical exponent @xmath142 . to alleviate this problem",
    ", we used the single - cluster update algorithm @xcite resulting in a dramatic speed - up of the relaxation process . for two and three dimensions we performed simulations at a fixed temperature close to the asymptotic critical temperature for a number of different system sizes to enable a systematic fss study .",
    "the raw data consisted of time series with @xmath143 approximately independent samples of the configurational energy and magnetization for each system size under consideration . using the jackknifing analysis described above",
    ", these original time series were then analyzed using @xmath37 effectively uncorrelated bins , where @xmath144 was chosen unless stated otherwise .",
    "crrt4t4t2@% t2t2rt4t4t4t4t4 & + & & & & & & & & & & & & & + @xmath145 & 32 & 192 & 1.0085 & 0.0183 & 0.85 & 0.47 & 0.52 & 4 & 1.0000 & 0.9743 & 0.9385 & 0.9197 & 0.8971 + @xmath146 & 32 & 192 & 1.0128 & 0.0194 & 1.28 & 0.66 & 0.47 & 4 & 0.9743 & 1.0000 & 0.9910 & 0.8167 & 0.8687 + @xmath147 & 32 & 192 & 1.0175 & 0.0201 & 1.75 & 0.87 & 0.40 & 4 & 0.9385 & 0.9910 & 1.0000 & 0.7431 & 0.8198 + @xmath148 & 32 & 192 & 1.0098 & 0.0281 & 0.98 & 0.35 & 0.57 & 4 & 0.9197 & 0.8167 & 0.7431 & 1.0000 & 0.8596 + @xmath149 & 32 & 192 & 1.0149 & 0.0511 & 1.49 & 0.29 & 0.70 & 4 & 0.8971 & 0.8687 & 0.8198 & 0.8596 & 1.0000 + & & 1.0127 & 0.0141 & 1.27 & 0.90 & & 1.0000 & 1.0000 & 1.0000 & 1.0000 & 1.0000 + & & & 0.0269 & 1.27 & 0.47 & & & & & & + & & 1.0123 & 0.0102 & 1.23 & 1.21 & & 0.3145 & 0.2714 & 0.2483&0.1322 & 0.0336 + & & & 0.0208 & 1.23 & 0.59 & & & & & & + & & 0.9935 & 0.0078 & -0.65 & -0.84 & & 5.0067 & -2.4259 & -0.2807 & -1.1958 & -0.1043 +      there is now a broad consensus that finite - size effects are ( in most cases ) not merely a drawback of approaches depending on finite system sizes , but can be turned into a powerful tool for extracting the asymptotic behavior @xcite .",
    "a number of different practical implementations of this idea in terms of specific fss schemes have been derived and successfully applied to the analysis of critical phenomena , see , e.g. , refs .  @xcite .",
    "although our considerations regarding the data analysis apply rather generally to all these techniques , for illustrative purposes we concentrate here on the rather popular method outlined in ref .",
    "it is focused on the analysis of the locations and values of extrema of standard thermodynamic quantities such as the specific heat , magnetic susceptibility , cumulants etc . according to the theory of finite - size scaling @xcite ,",
    "the locations of such pseudo - critical points are shifted away from the true critical coupling @xmath150 according to @xmath151 where @xmath152 denotes an observable with a pseudo - critical maximum such as the specific heat ( for @xmath153 ) . the generic value for the _ shift exponent _",
    "@xmath154 predicted by fss theory is @xmath155 , where @xmath138 is the correlation length exponent ( for exceptions see , e.g. , ref .",
    "a drawback of using eq .",
    "( [ eq : shift_exponent ] ) directly is that non - linear fits in the three parameters @xmath150 , @xmath156 and @xmath154 resp .",
    "@xmath138 are required even for the simplest case of ignoring the correction - to - scaling terms in brackets . to alleviate this problem ,",
    "it has been suggested to consider quantities such as the magnetization cumulants @xcite @xmath157 for which the maxima of the temperature derivatives have a critical scaling form @xmath158 and hence allow to determine @xmath138 without prior knowledge of the transition coupling @xmath150 . if , again , the correction terms in brackets are ignored , this form even represents a _ linear _ fit ( in logarithmic representation ) resulting in very stable results . while initially only the fourth - order cumulant @xmath159 was considered , the authors of ref .",
    "@xcite suggested to use a variety of different cumulants @xmath160 with @xmath76 , @xmath59 , @xmath161 , @xmath13 to improve the accuracy of the @xmath138 estimate .",
    "a number of further quantities with the same scaling behavior can be constructed , for instance logarithmic temperature derivatives of the magnetization , @xmath162 which for @xmath76 , @xmath59 , @xmath13 yields another series of @xmath138 estimates .    once @xmath138 has been determined from fits of the functional forms ( [ eq : cumulant_scaling ] ) and ( [ eq : logmagnderiv_scaling ] ) to the data",
    ", one might return to the shift relation ( [ eq : shift_exponent ] ) and ( assuming @xmath163 ) determine the transition coupling @xmath150 from linear fits with a fixed value of @xmath138 .",
    "finally , the remaining standard critical exponents can be estimated from the well - known fss forms of the specific heat @xmath164 , the magnetization @xmath165 and the magnetic susceptibility @xmath166 , @xmath167 where @xmath168 denotes the ( modulus of the ) magnetization at its inflection point .",
    "the directly estimated exponents are therefore @xmath138 and the fss exponents @xmath169 ,",
    "@xmath170 and @xmath171 , which can be combined to yield @xmath172 , @xmath96 , @xmath173 and @xmath138 . the remaining exponents @xmath174 and @xmath175 are not directly determined here ; instead we assume that their values are deduced from the exponents @xmath172 , @xmath96 , @xmath173 and @xmath138 via standard scaling relations .",
    "llt6t6t4@% t2t4t4t4t4t4t4t4t4 & & + & & & & & & & & & & & & & + & 0.440709 & 0.000101 & 0.0051 & 0.35 & 1.0000 & 0.7881 & 0.3965 & 0.3645 & 0.3569 & 0.3502 & 0.2599 & 0.1394 + & 0.440798 & 0.000073 & 0.0251 & 0.09 & 0.7881 & 1.0000 & 0.7116 & 0.6417 & 0.6043 & 0.7166 & 0.5345 & 0.6236 + & 0.440711 & 0.000408 & 0.0055 & 0.56 & 0.3965 & 0.7116 & 1.0000 & 0.9740 & 0.9365 & 0.9122 & 0.8613 & 0.6477 + & 0.440799 & 0.000504 & 0.0254 & 0.42 & 0.3645 & 0.6417 & 0.9740 & 1.0000 & 0.9899 & 0.8119 & 0.8111 & 0.5264 + & 0.440918 & 0.000567 & 0.0525 & 0.29 & 0.3569 & 0.6043 & 0.9365 & 0.9899 & 1.0000 & 0.7415 & 0.7608 & 0.4554 + & 0.440576 & 0.000338 & -0.0251 & 0.70 & 0.3502 & 0.7166 & 0.9122 & 0.8119 & 0.7415 & 1.0000 & 0.8854 & 0.8413 + & 0.440308 & 0.000708 & -0.0860 & 0.94 & 0.2599 & 0.5345 & 0.8613 & 0.8111 & 0.7608 & 0.8854 & 1.0000 & 0.6265 + & 0.440699 & 0.000045 & 0.0028 & 0.67 & 0.1394 & 0.6236 & 0.6477 & 0.5264 & 0.4554 & 0.8413 & 0.6265 & 1.0000 + @xmath176 & @xmath177 & 0.440690 & 0.000151 & 0.0007 & & 1.0000 & 1.0000 & 1.0000 & 1.0000 & 1.0000 & 1.0000 & 1.0000 & 1.0000 + & @xmath178 & & 0.000322 & 0.0007 & & & & & & & & & + @xmath179 & @xmath177 & 0.440725 & 0.000036 & 0.0086 & & 0.1364 & 0.2530 & 0.0073 & 0.0049 & 0.0039 & 0.0105 & 0.0024 & 0.5815 + & @xmath178 & & 0.000059 & 0.0086 & & & & & & & & & + @xmath180 & @xmath178 & 0.440687 & 0.000018 & 0.0001 & & 0.2601 & -0.3347 & 0.2086 & -0.0566 & -0.0186 & -0.2997 & 0.0276 & 1.2133 +    for determining the ( location and value of the ) maxima occurring in eqs .",
    "( [ eq : shift_exponent ] ) , ( [ eq : cumulant_scaling ] ) , ( [ eq : logmagnderiv_scaling ] ) and ( [ eq : other_exponents ] ) , we used the reweighting technique outlined in sec .",
    "[ sec : histo ] starting from the data of a single simulation per system size performed at or close to the asymptotic transition point .",
    "the derivatives with respect to @xmath96 in eqs .",
    "( [ eq : cumulant_scaling ] ) and ( [ eq : logmagnderiv_scaling ] ) are easily shown to be equivalent to combinations of moments of energy and magnetization at a single , fixed temperature @xcite . for the fourth - order cumulant @xmath181 , for instance",
    ", one has @xmath182-\\l m^2\\r[\\l",
    "m^4\\r\\l e\\r-\\l m^4      e\\r]}{3\\l m^2\\r^3}.\\ ] ] therefore no numerical differentiation is required when making use of the relations ( [ eq : cumulant_scaling ] ) and ( [ eq : logmagnderiv_scaling ] ) . in some situations it might be impractical to store the whole time series of original measurements of internal energy and magnetization , in which case the exact reweighting relation ( [ eq : temperature_reweighting ] ) might be replaced by a taylor expansion with respect to @xmath96 around the simulation coupling @xmath183 , where then cumulants of @xmath184 and @xmath165 appear as the expansion coefficients . in most cases , however , it is much simpler and more versatile in terms of the data analysis to work with the original time series . in view of the typically available storage resources today",
    ", this approach should be comfortably feasible in most situations .",
    "considering the set of critical exponents @xmath172 , @xmath96 , @xmath173 , @xmath138 ( as well as @xmath175 and @xmath174 ) , it is useful to recall that they are subject to a number of exact scaling relations , namely the rushbrooke identity @xmath185 , fisher s scaling law @xmath186 , the relation @xmath187 , as well as ( in most cases ) the hyperscaling relation @xmath188 , where @xmath189 is the spatial dimension @xcite . as a consequence of these four equations ,",
    "only two of the six original exponents are independent .",
    "while the scaling relations have been occasionally used to check a set of independently estimated exponents for consistency , we would like to point out that the existence of these exact relations should rather be used for _ improving the precision _ of exponent estimates . in particular ,",
    "in the language of the renormalization group , it is natural to express the conventional scaling exponents in terms of the _ scaling dimensions _ @xmath190 and @xmath191 of the operators coupling to temperature and magnetic field @xcite , respectively , which are the only relevant operators for the ising model @xcite .",
    "for the four exponents considered here , this means that @xmath192      { \\displaystyle}\\frac{\\gamma}{\\nu } & = & d-2x_h , &      { \\displaystyle}\\frac{1}{\\nu } & = & d - x_t ,    \\end{array}\\ ] ] such that @xmath191 can be independently estimated from @xmath193 and @xmath194 , whereas @xmath190 might be determined from @xmath195 as well as @xmath196 .",
    "for the two - dimensional ( 2d ) ising model , single - cluster update simulations were performed for square lattices of size @xmath197 , @xmath198 , @xmath199 , @xmath200 , @xmath201 , @xmath202 , @xmath203 and @xmath204 .",
    "all simulations were done directly at the asymptotic critical coupling @xmath205 .",
    "for the range of system sizes under consideration , it turned out that simulations at this single temperature were sufficient for reliably studying the pseudo - critical points defined by the maxima of the various quantities under consideration by reweighting , i.e. , the overlap of histograms between the simulation and analysis temperatures turned out to be sufficiently large .",
    "we first extracted a number of estimates of the correlation length exponent @xmath138 from investigating the maxima of logarithmic derivatives of magnetization moments for @xmath206 , @xmath59 and @xmath161 as well as the maxima of the derivatives of the second - order and fourth - order cumulants @xmath207 and @xmath159 using the reweighting scheme outlined above .",
    "the locations and values of the maxima themselves were determined by a golden section search algorithm @xcite .",
    "the resulting maxima as a function of system size are shown in fig .",
    "[ fig : nu_fits ] together with fits of the forms ( [ eq : cumulant_scaling ] ) and ( [ eq : logmagnderiv_scaling ] ) to the data . here",
    ", we used fits _ without _ the correction terms in the brackets of eqs .",
    "( [ eq : cumulant_scaling ] ) and ( [ eq : logmagnderiv_scaling ] ) on the fit range @xmath208 , which works very well as is apparent from the presentation in fig .",
    "[ fig : nu_fits ] and the corresponding values of the quality - of - fit parameter @xmath209 @xcite listed in the eighth column of table [ tab:2d_nu ] .",
    "the fourth and fifth column contain the resulting estimates of the exponent @xmath138 together with the statistical errors estimated from a weighted least - squares fitting procedure @xcite .",
    "a glance at table [ tab:2d_nu ] reveals that all single estimates are statistically consistent with the exact result @xmath210 , but they exhibit a rather large variation in statistical accuracy with the biggest statistical error being almost three times larger than the smallest .",
    "we use the jackknife estimator ( [ eq : jackknife_covariance ] ) and a second - order jackknifing procedure to estimate the statistical correlations of the individual estimates of @xmath138 .",
    "the data on the right hand side of table [ tab:2d_nu ] showing the correlation coefficients @xmath211 for the different estimates reveal that correlations between all pairs of estimates are large with @xmath212 . with all estimates being derived from similar expressions containing magnetic moments ,",
    "this result probably does not come as a surprise .",
    "clt4t4t6t6 & & & & & + @xmath213 & @xmath177 & 0.8101 & 0.0428 & 0.439491 & 0.000337 + & @xmath178 & & 0.0973 & & 0.000715 + @xmath214 & @xmath177 & 0.8949 & 0.0228 & 0.440295 & 0.000099 + & @xmath178 & & 0.0435 & & 0.000169 + @xmath215 & @xmath178 & 0.9980 & 0.0148 & 0.440658 & 0.000072 + exact & & 1.0000 & & 0.440687 & +    under these circumstances , one might wonder whether it is worthwhile to attempt a linear combination of the form ( [ eq : linear_combination ] ) of the various @xmath138 estimates rather than quoting the single most precise estimate as final result , which in the present case is given by the value @xmath216 resulting from the fss of @xmath217 .",
    "for the purpose of combining estimates , we consider the traditional approaches of taking a _ plain average _ @xmath218 with @xmath219 as well as",
    "the _ error - weighted average _",
    "@xmath220 of eq .",
    "( [ eq : error_weighted ] ) and compare them to the truly optimal _ covariance - weighted average _",
    "@xmath221 defined by the weights of eq .",
    "( [ eq : covariance_weighted ] ) . ignoring the presence of correlations ( as was the case in most previous studies ) , one would estimate the error associated to the plain average as @xmath222 and , likewise , the variance of the error - weighted average is given by @xmath223 as defined in eq .",
    "( [ eq : uncorrelated_variance ] ) .",
    "the _ true _ variances of @xmath218 and @xmath220 in the presence of correlations , on the other hand , can also be easily derived formally , and will contain the elements of the covariance matrix @xmath224 of the individual estimates @xmath225 . from the practical perspective , the jackknifing analysis outlined here _ automatically _ takes those correlations into account .",
    "we refer to these correctly defined variances with the notation @xmath226 .",
    "the plain , error - weighted and covariance - weighted averages for @xmath138 with the corresponding variance estimates are listed in the lower part of columns four and five of table [ tab:2d_nu ] . as with the individual estimates ,",
    "each of the three averages is statistically compatible with the exact result @xmath210 .",
    "while the nave error estimates @xmath177 seem to indicate that performing the plain or error - weighted average reduces statistical fluctuations compared to the single estimates , taking correlations into account with the jackknifing scheme resulting in @xmath226 reveals that variances are grossly underestimated by @xmath227 and , in fact , compared to both the plain ( @xmath228 ) and error - weighted ( @xmath229 ) averages the single estimate of @xmath138 stemming from @xmath217 has smaller statistical fluctuations ( @xmath230 ) . performing those averages",
    "therefore _ decreases precision _ instead of improving it ! the truly optimal average of eq .",
    "( [ eq : covariance_weighted ] ) , on the other hand , results in the estimate @xmath231 , whose fluctuation is about 23 times smaller than those of the error - weighted average and the single most precise estimate .",
    "the reduced variance of this last estimate seems to be corroborated by the smallest deviation also from the exact result @xmath210 .",
    "a glance at the data collected in table [ tab:2d_nu ] reveals that , somewhat astonishingly , the optimal average is smaller than _ all _ of the individual estimates of @xmath138 ( see also the graphical representation of this fact in fig .  1 of ref .",
    "this situation which , of course , can never occur for the error - weighted average where all weights @xmath232 , is connected to the fact that the more general weights of eq .",
    "( [ eq : covariance_weighted ] ) are unbounded and , in particular , can become negative .",
    "this fact reflects in the computed weights for the different averaging schemes collected in the lower right hand part of table [ tab:2d_nu ] .",
    "clearly , the weights for the error - weighted and covariance - weighted averages are dramatically different and , in particular , some of the latter turn out to be negative .",
    "it is intuitively clear that such negative weights are necessary to cancel the effects of strong mutual correlations .",
    "the asymmetry in the weights leading to the possibility of the average lying outside of the range of the individual estimates results from the asymmetry of the individual variances in connection with the cross correlations .",
    "this effect can be explicitly understood for the case of only two estimates , cf .",
    "the discussion in appendix [ sec : app ] .",
    "one might wonder whether the suggested weighting scheme requiring to estimate the full covariance matrix is statistically robust .",
    "it is clear , for instance , that the jackknife estimator ( [ eq : jackknife_covariance ] ) for the covariance will become more precise as more jackknife blocks are used  at the expense of an increased computational effort . to check for such effects we repeated our analysis while using @xmath233 instead of @xmath144 jackknife blocks .",
    "most of the estimates for the correlation coefficients are almost unchanged by this new analysis with the largest deviation being of the order of 3% .",
    "the same holds true for the resulting weights in the optimal average , where only the weight of the estimate resulting from @xmath234 changes substantially from @xmath235 to @xmath236 .",
    "the final optimal estimate @xmath237 is fully compatible statistically with the analysis using @xmath238 jackknife blocks . using ( as a consistency check ) completely independent simulations for producing the individual estimates of @xmath138 , on the other hand ,",
    "indeed results in a unit matrix of correlation coefficients within statistical errors and , consequently , the error - weighted and covariance - weighted averages coincide in this limit .",
    "finally , we also find that the numerical inversion of the covariance matrix required for computing the weights in eq .",
    "( [ eq : covariance_weighted ] ) is in general stable and unproblematic .",
    "it is clear , however , that in the presence of very strong correlations the resulting weights of individual estimates will depend sensitively on the entries of the covariance matrix , since in the limit of _ perfect _ correlations all choices of weights become degenerate , see also the discussion of the case of only two estimates in appendix [ sec : app ] .",
    "we now turn to the determination of the transition coupling @xmath150 from the shift relation ( [ eq : shift_exponent ] ) .",
    "we considered the locations of the extrema of the specific heat @xmath164 , the slope @xmath239 of the ( modulus of the ) magnetization , the logarithmic derivatives @xmath240 for @xmath76 , @xmath59 and @xmath161 , the cumulant derivatives @xmath241 and @xmath242 as well as the magnetic susceptibility @xmath166 . in order to",
    "most clearly demonstrate the effects of the present correlations , we first performed fits of the form ( [ eq : shift_exponent ] ) using the exact correlation length exponent @xmath210 .",
    "the corresponding fit results are collected in table [ tab:2d_betac ] . for the fits we ignored the correction terms indicated in the brackets of eq .",
    "( [ eq : shift_exponent ] ) , leaving out the smallest system sizes instead .",
    "this approach appears justified in view of the good fit qualities reflected in the @xmath209 values of table [ tab:2d_betac ] . as for the fits for determining @xmath138 , all single estimates of @xmath150 are consistent with the true asymptotic values of @xmath243 within error bars .",
    "the corresponding standard deviations , however , vary dramatically , decreasing by a factor of @xmath244 from the estimate resulting from @xmath242 to that of the susceptibility @xmath166 .",
    "the results of the correlation analysis are presented on the right - hand side of table [ tab:2d_betac ] : while the logarithmic magnetization derivatives and cumulants again show very strong correlations , the results of the remaining quantities are somewhat more independent , showing , in particular , a rather clear separation of the energetic from the magnetic sector . for the averages of single estimates",
    "the present correlations again lead to a significant underestimation of the true variance for the plain and error - weighted cases and , in fact , both of them are _ less _ precise than the best single estimate stemming from the scaling of the susceptibility @xmath166 , cf .  the data in the lower part of table [ tab:2d_betac ] .",
    "the truly optimal average of eq .",
    "( [ eq : covariance_weighted ] ) results in @xmath245 , where the statistical error is about threefold reduced compared to the error - weighting scheme .",
    "very similar results are found when using the value @xmath231 found from the analysis summarized in table [ tab:2d_nu ] , where we arrive at a final covariance - weighted average of @xmath246 $ ] . here",
    ", the second error estimate in square brackets refers to the sensitivity of the result for @xmath150 to the uncertainty in @xmath138 indicated above , which turns out to be symmetric with respect to upwards and downwards deviations of @xmath138 here .    as an alternative to the two - step process of first determining @xmath138 from the relations ( [ eq : cumulant_scaling ] ) and ( [ eq : logmagnderiv_scaling ] ) and only afterwards estimating @xmath150 from eq .",
    "( [ eq : shift_exponent ] ) , one might consider direct fits of the form ( [ eq : shift_exponent ] ) to the maxima data of the 8 observables listed above determining @xmath138 and @xmath150 in one go . here",
    ", again , fits on the range @xmath247 neglecting any corrections to the leading scaling behavior are found to be sufficient .",
    "the results for the plain , error - weighted and covariance - weighted averages for both parameters , @xmath138 and @xmath150 , are collected in table [ tab : three_parameter ] .",
    "consistent with the previous results , it is seen that neglecting correlations in error estimation leads to a sizable underestimation of errors and , on the other hand , using the optimal weighting scheme of eq .",
    "( [ eq : covariance_weighted ] ) statistical errors are significantly reduced , an effect which is also nicely illustrated by the very good fit of the resulting parameter estimates with the exact values .",
    "clt4t4t4t4 & & & & & + @xmath213 & @xmath177 & 0.1219 & 0.0027 & 1.0085 & 0.0117 + & @xmath178 & & 0.0021 & & 0.0213 + @xmath214 & @xmath177 & 0.1261 & 0.0016 & 1.0048 & 0.0082 + & @xmath178 & & 0.0013 & & 0.0136 + @xmath215 & @xmath178 & 0.1250 & 0.0010 & 1.0030 & 0.0096 + exact & & 0.1250 & & 1.0000 & +    crrt4t4t2@% t2t2rt4t4t4t4t4 & + & & & & & & & & & & & & & + @xmath145 & 8 & 128 & 0.6358 & 0.0127 & 0.91 & 0.45 & 0.61 & 5 & 1.0000 & 0.9809 & 0.9490 & 0.4401 & 0.4507 + @xmath146 & 8 & 128 & 0.6340 & 0.0086 & 0.63 & 0.46 & 0.71 & 5 & 0.9809 & 1.0000 & 0.9910 & 0.4357 & 0.4630 + @xmath147 & 8 & 128 & 0.6326 & 0.0062 & 0.39 & 0.40 & 0.77 & 5 & 0.9490 & 0.9910 & 1.0000 & 0.4363 & 0.4639 + @xmath148 & 32 & 128 & 0.6313 & 0.0020 & 0.20 & 0.62 & 0.54 & 3 & 0.4401 & 0.4357 & 0.4363 & 1.0000 & 0.9267 + @xmath149 & 32 & 128 & 0.6330 & 0.0024 & 0.46 & 1.20 & 0.77 & 3 & 0.4507 & 0.4630 & 0.4639 & 0.9267 & 1.0000 + & & 0.6334 & 0.0038 & 0.52 & 0.85 & & 1.0000 & 1.0000 & 1.0000 & 1.0000 & 1.0000 + & & & 0.0067 & 0.52 & 0.49 & & & & & & + & & 0.6322 & 0.0015 & 0.33 & 1.35 & & 0.0106 & 0.0254 & 0.0503 & 0.5315 & 0.3823 + & & & 0.0024 & 0.33 & 0.84 & & & & & & + & & 0.6300 & 0.0017 & -0.01 & -0.05 & & 0.2485 & -1.5805 & 1.6625 & 0.7948 & -0.1253 +    finally , we turn to the determination of the remaining critical exponents . as outlined above",
    ", we do this by combining different estimates using covariance analysis to improve the results for the scaling dimensions , thus ensuring that the scaling relations are fulfilled exactly . from a glance at eq .",
    "( [ eq : scaling_dimensions ] ) one reads off that the magnetic scaling dimension @xmath191 can be determined from @xmath248 and @xmath249 .",
    "we therefore determine @xmath170 from the fss of the ( modulus of the ) magnetization at its inflection point and estimate @xmath171 from the fss of the susceptibility maxima , resulting in @xmath250 and @xmath251 , respectively .",
    "as the correlation analysis reveals , the two resulting estimates of @xmath191 are _ anti-_correlated to a considerable degree with correlation coefficient @xmath252 . as a consequence , conventional error analysis neglecting correlations _",
    "over-_estimates statistical fluctuations .",
    "still , choosing optimal weights according to eq .",
    "( [ eq : covariance_weighted ] ) is able to reduce variance , resulting in a combined estimate @xmath253 right on top of the exact result @xmath254 , cf .  the data collected in table [ tab : scaling_dimension ] .",
    "the energetic scaling dimension @xmath190 , on the other hand , might be computed from @xmath195 as well as @xmath196 .",
    "we therefore use the five individual estimates of @xmath138 listed in table [ tab:2d_nu ] as well as the fss of the maximum of the specific heat to estimate @xmath190 .",
    "the latter fits are somewhat problematic due to the logarithmic singularity of the specific heat corresponding to @xmath255 , and it turns out that a fit of the form @xmath256 including a scaling correction is necessary to describe the data . combining all individual estimates in an optimal way , we arrive at @xmath257 , well in agreement with the exact result @xmath258 , cf .  the right hand side of table [ tab : scaling_dimension ] .",
    "cluster - update simulations of the ferromagnetic ising model in three dimensions ( 3d ) were performed for simple - cubic lattices of edge lengths @xmath259 , @xmath260 , @xmath261 , @xmath198 , @xmath199 , @xmath200 , @xmath201 , @xmath202 and @xmath203 .",
    "all simulations were performed at the coupling @xmath262 reported in a high - precision study as estimate for the transition point @xcite , since it turned out that the maxima of the various quantities under consideration were all within the reweighting range of this chosen simulation point for the system sizes and lengths of time series at hand .    for determining the correlation - length exponent @xmath138",
    "we again considered the scaling of the logarithmic magnetization derivatives @xmath263 for @xmath76 , @xmath59 and @xmath161 and the derivatices of the cumulants @xmath207 and @xmath159 .",
    "we find scaling corrections to be somewhat more pronounced than for the two - dimensional model for the system sizes studied here .",
    "for the logarithmic magnetization derivatives we therefore performed fits of the form ( [ eq : logmagnderiv_scaling ] ) including the correction term on the full range @xmath264 , where the resulting values of the effective correction exponent @xmath265 were @xmath266 ( @xmath76 ) , @xmath267 ( @xmath268 ) and @xmath269 ( @xmath270 ) , respectively .",
    "for the cumulants @xmath207 and @xmath159 , on the other hand , corrections were too small to be fitted reliably with our data , such that they were effectively taken into account by dropping the small lattice sizes instead , while using fits of the form ( [ eq : cumulant_scaling ] ) with @xmath271 fixed .",
    "the corresponding fit data are collected in table [ tab:3d_nu ] .",
    "the estimated standard deviations of the individual estimates are again found to be very heterogeneous , but the correlations between the different estimates are somewhat smaller than in two dimensions , in particular between the magnetization derivatives and the cumulants , cf .",
    "table [ tab:3d_nu ] . comparing to the case of fits without corrections",
    ", it is seen that this latter effect is partially due to the use of two different fit forms for the two types of quantities .",
    "( the fits for @xmath207 and @xmath159 also include a reduced range of lattice sizes which could lead to a decorrelation , but this effect is found to be much less important than the difference in the fit forms . )",
    "considering the averages of individual estimates , as a result of these smaller correlations the underestimation of statistical errors in the nave approach as well as the reduction of variance through the optimized estimator ( [ eq : covariance_weighted ] ) is somewhat less dramatic than for the two - dimensional model , but the qualitative behavior appears to be very much the same . as our final estimate we quote @xmath272 , very well in agreement with the reference value @xmath273 taken from a survey of recent literature estimates compiled in ref .",
    "@xcite .    in a second step we determined the transition coupling from fits of the functional form ( [ eq : shift_exponent ] ) to the maxima of the quantities listed in table [ tab:2d_betac ] . as for",
    "the @xmath138 fits , however , the inclusion of an effective correction term as indicated in eq .",
    "( [ eq : shift_exponent ] ) turned out to be necessary for a faithful description of the scaling data .",
    "the plain , error - weighted and covariance - weighted averages of the corresponding estimates are listed in the first two data columns of table [ tab : various_exponents_3d ] together with their standard deviations , the results being consistent with the reference value .",
    "we also tried non - linear three - parameter fits of the form ( [ eq : shift_exponent ] ) to the data , determining @xmath138 and @xmath150 simultaneously . for this case , the precision of the data is not high enough to reliably include corrections to scaling .",
    "still , the improved results are well consistent with the reference values of refs .",
    "@xcite , cf .",
    "the middle columns of table [ tab : various_exponents_3d ] .",
    "clt8t8t4t4t7t7t4t4t4t4 & & & & + & & & & & & & & & & & + @xmath213 & @xmath177 & 0.22165681 & 0.00000108 & 0.6020 & 0.0105 & 0.2216530 & 0.0000025 & 0.51364 & 0.00401 & 1.4137 & 0.0138 + & @xmath178 & & 0.00000170 & & 0.0150 & & 0.0000032 & & 0.00435 & & 0.0184 + @xmath214 & @xmath177 & 0.22165741 & 0.00000059 & 0.6247 & 0.0062 & 0.2216550 & 0.0000008 & 0.51489 & 0.00381 & 1.4180 & 0.0038 + & @xmath178 & & 0.00000114 & & 0.0077 & & 0.0000016 & & 0.00413 & & 0.0061 + @xmath215 & @xmath178 & 0.22165703 & 0.00000085 & 0.6381 & 0.0044 & 0.2216552 & 0.0000011 & 0.51516 & 0.00412 & 1.4121 & 0.0043 + reference & & 0.22165459 & 0.00000006 & 0.6301 & 0.0004 & 0.22165459 & 0.00000006 & 0.51817 & 0.00058 & 1.4130 & 0.0010 +    finally , we also considered the scaling dimensions @xmath191 and @xmath190 .",
    "for the magnetic scaling dimension , we find that the determinations from @xmath193 and @xmath274 are only very weakly correlated , such that the error - weighted and covariance - weighted averages are very similar , see the right hand side of table [ tab : various_exponents_3d ] .",
    "larger correlations are present again between the different estimates of the energetic scaling dimension @xmath190 from the various estimates of @xmath138 via @xmath275 and the scaling of the specific heat via @xmath276 , leading to a considerable improvement in precision of the optimal average over the plain and error - weighting schemes .",
    "the results for both scaling dimensions are well compatible with the values @xmath277 and @xmath278 extracted from the reference values of ref .  @xcite .",
    "time series data from markov chain monte carlo simulations are usually analyzed in a variety of ways to extract estimates for the parameters of interest such as , e.g. , critical exponents , transition temperatures , latent heats etc .",
    "as long as at least some of these estimates are based on the same simulation data , a certain degree of cross correlations between estimators is unavoidable .",
    "we have shown for the case of a finite - size scaling analysis of the ferromagnetic nearest - neighbor ising model on square and cubic lattices that more often than not , such correlations are very strong , with correlation coefficients well above 0.8 . while such correlations , although their existence is rather obvious , have been traditionally mostly neglected even in high - precision numerical simulation studies , it was shown here that their presence is of importance at different steps of the process of data analysis , and neglecting them leads to systematically wrong estimates of statistical fluctuations as well as non - optimal combination of single estimates into final averages .    as far as the general statistical analysis of simulation data is concerned , it has been discussed that traditional prescriptions such as error propagation have their shortcomings , in particular as soon as non - parametric steps such as the determination of a maximum via reweighting or fitting procedures come into play .",
    "these problems are circumvented by resorting to the class of non - parametric resampling schemes , of which we have discussed the jackknife technique as a conceptually and practically very simple representative . using this technique ,",
    "we have outlined a very general framework of data analysis for mcmc simulations consisting of ( a ) a transformation of the original set of time series into an auxiliary set of `` binned '' series , where successive samples are approximately uncorrelated in time and ( b ) a general jackknifing framework , where the required steps of computing a parameter estimate  possibly including reweighting or fitting procedures etc .",
    " are performed on the full underlying time series apart from a small window cut out from the data stream allowing for a reliable and robust estimate of variances and covariances as well as bias effects without any non - stochastic approximations .",
    "while this technique of data analysis is not new , we feel that it still has not found the widespread use it deserves and hope that the gentle and detailed introduction given above will contribute to a broader adoption of this approach .",
    "a particular example of where the presence of cross correlations comes into play occurs when taking averages of different estimates for a parameter from the same data base .",
    "neglecting correlations there leads to ( a ) systematically wrong , most often too small , estimates of statistical errors of the resulting averages and ( b ) a sub - optimal weighting of individual values in the average leading to larger - than - necessary variances .",
    "correct variances can be estimated straightforwardly from the jackknifing approach , while optimal weighting involves knowledge of the covariance matrix which is a natural byproduct of the jackknife technique as well .",
    "we have discussed these concepts in some detail for the case of a finite - size scaling analysis of the critical points of the 2d and 3d ising models .",
    "it is seen there that the plain and error - weighted averages most oftenly used in fact can have larger fluctuations than the most precise single estimates entering them , but this flaw is not being detected by the conventional analysis due to the generic underestimation of variances .",
    "on the contrary , by using the truly optimal weighting of individual estimates an often substantial reduction of statistical fluctuations as compared to the error - weighting scheme can be achieved .",
    "for some of the considered examples , a threefold reduction in standard deviation , corresponding to saving an about tenfold increase in computer time necessary to achieve the same result with the conventional analysis , can be achieved with essentially no computational overhead . in view of these results , heuristic rules such as ,",
    "e.g. , taking an error - weighted average using the smallest single standard deviation as an error estimate are clearly found to be inadequate .",
    "we therefore see only two statistically acceptable ways of dealing with the existence of several estimates for the same quantity : ( a ) select the single most precise estimate and discard the rest or ( b ) combine all estimates in a statistically optimal way taking cross correlations into account .",
    "needless to say , the latter approach is generally preferable in that it leads to more precise results at very low costs .",
    "we suggest to use the existence of scaling relations between the critical exponents for the case of a continuous phase transition to improve the precision of estimates by considering the scaling dimensions as the parameters of primary interest . performing the corresponding analysis taking cross correlations into account , results in a set of critical exponents with reduced statistical fluctuations that fulfill the scaling relations exactly .",
    "an application of this type of approach initially suggested in ref .",
    "@xcite for using mean - value relations such as callen identities or schwinger - dyson equations instead of scaling relations has been discussed in ref .",
    "@xcite .",
    "while the examples discussed were specific , it should be clear that the method itself is rather generic , and should apply to all data sets generated from mcmc simulations . in particular , it is easy to envisage applications in the theory of critical phenomena , reaching from classical statistical mechanics @xcite over soft matter physics @xcite to quantum phase transitions @xcite , or for studying first - order phase transitions @xcite .",
    "the range of applications is not restricted to mcmc simulations , however , but applies with little or no modifications to other random sampling problems , such as , e.g.stochastic ground - state computations @xcite or the sampling of polymer configurations with chain - growth methods @xcite .",
    "m.w .  acknowledges support by the dfg through the emmy noether programme under contract no .",
    "we4425/1 - 1 as well as computer time provided by nic jlich under grant no .",
    "( [ eq : app_optimal_variance ] ) as a function of the correlation coefficient @xmath279 .",
    "[ fig : two_variable ] ]    consider a general average of two random variables @xmath280 and @xmath281 @xcite , @xmath282 where @xmath283 . according to eq .",
    "( [ eq : variance_of_average ] ) , the variance of @xmath284 is @xmath285 where @xmath286 and @xmath287 are the variances of @xmath280 and @xmath281 , respectively , and @xmath279 denotes the correlation coefficient of @xmath280 and @xmath281 , @xmath288 .",
    "( [ eq : app_variance ] ) is a quadratic form in @xmath289 , which has a minimum as long as @xmath290 which is almost always fulfilled since @xmath291 : @xmath292 equality holds only for @xmath293 and @xmath294 , in which case _ any _ choice of @xmath289 yields the same variance @xmath295 . in all other cases ,",
    "the optimal weights are @xmath296 and the resulting variance of the average is @xmath297 a number of observations are immediate    * for the uncorrelated case @xmath298 , one arrives back at the error - weighted average of eqs .",
    "( [ eq : error_weighted ] ) and ( [ eq : uncorrelated_variance ] ) . * in the correlated case , and for fixed variances @xmath286 and @xmath287 , the variance @xmath299 smoothly depends on the correlation coefficient @xmath279 .",
    "it has maxima at @xmath300 and @xmath301 , only one of which is in the range @xmath302 .",
    "notably , the relevant maximum is always at non - negative values of @xmath279 . * for @xmath303 , the variance _ vanishes identically _",
    ", apart from the singular case @xmath304 and @xmath294 .    the generic form of @xmath299 as a function of @xmath279 is depicted in fig .",
    "[ fig : two_variable ] . in the presence of moderate correlations , therefore , _ anti - correlations _ are preferable over correlations in terms of reducing the variance of the average .",
    "note that the result ( [ eq : app_optimal_variance ] ) is different from that of eq .",
    "( 8) in ref .",
    "@xcite , since the definition of correlation coefficient used there is different from that in our situation of taking an average .",
    "instead of measuring the correlation between @xmath280 and @xmath281 , their definition refers to the correlation of @xmath280 and @xmath305 .",
    "the weights @xmath289 and @xmath309 of eq .",
    "( [ eq : app_kappa ] ) are not restricted to be between zero and one .",
    "it is easy to see that for @xmath310 or @xmath311 , the average @xmath284 is in fact outside of the bracket @xmath308 $ ] .",
    "this seemingly paradoxical effect is easily understood from the optimal weights derived here . from eq .",
    "( [ eq : app_kappa ] ) one reads off that the weights @xmath289 and @xmath309 leave the range @xmath312 as soon as @xmath313 resp .",
    "@xmath314 , depending on whether @xmath306 or @xmath315 , that is , only for strong positive correlations to the right of the maximum in fig .",
    "[ fig : two_variable ] .",
    "thus , if the smaller of @xmath280 and @xmath281 has the smaller variance ( and both are strongly correlated ) , the average is below both values .",
    "if the larger value has the smaller variance , the optimal average is above both values .",
    "the asymmetry comes here from the difference in variance .",
    "to understand this intuitively , assume for instance that @xmath316 and @xmath306 with strong positive correlations @xmath317 .",
    "it is most likely , then , that @xmath280 and @xmath281 deviate in the _ same _ direction from the true mean @xmath318 . since @xmath306 ,",
    "the deviation of @xmath280 should be generically smaller than that of @xmath281 .",
    "for @xmath316 , however , this is only possible if @xmath319 .",
    "this is illustrated in fig .",
    "[ fig : fluctuation ] ."
  ],
  "abstract_text": [
    "<S> besides the well - known effect of autocorrelations in time series of monte carlo simulation data resulting from the underlying markov process , using the same data pool for computing various estimates entails additional cross correlations . </S>",
    "<S> this effect , if not properly taken into account , leads to systematically wrong error estimates for combined quantities . using a straightforward recipe of data analysis employing the jackknife or similar resampling techniques , </S>",
    "<S> such problems can be avoided . </S>",
    "<S> in addition , a covariance analysis allows for the formulation of optimal estimators with often significantly reduced variance as compared to more conventional averages . </S>"
  ]
}