{
  "article_text": [
    "the einstein equations of general relativity have a hamiltonian formulation that arises as a consequence of the hilbert action principle in a 3 + 1 slicing @xcite .",
    "the present article deals with numerical methods that respect the hamiltonian structure in the discretization .    in various areas of scientific computing , such as the dynamics of particle accelerators , molecular dynamics , celestial mechanics , quantum dynamics and electrodynamics , _ symplectic integrators _ for hamiltonian systems have been essential for attaining favorable propagation properties ( see , e.g. , @xcite and references ) .",
    "there have also been a few papers on symplectic integrators for free evolution in general relativity @xcite .",
    "very recently , in @xcite the difficulties in devising constraint - preserving symplectic integrators have been addressed but not resolved .    in this paper",
    "we present symplectic integrators for free and constrained evolution in numerical relativity and illustrate and compare their numerical properties in numerical experiments with effectively 1 + 1-dimensional versions of einstein s equations .",
    "in section 2 we describe the general framework of the hamiltonian formulation and its spatial discretization . for the free",
    ", adm - like evolution we propose the _ strmer ",
    "verlet method _ in section 3 .",
    "this standard symplectic integrator ( see @xcite ) here is an implicit method , but it is explicit in the computationally expensive terms containing the discretized ricci scalar .",
    "moreover , the implicitness is point - wise in space and is readily resolved by simple fixed - point iteration .",
    "however , in this free evolution scheme the hamiltonian and momentum constraints are not considered and may drift off .    in section 4",
    "we give a formulation of the ( spatially discretized ) einstein equations that enforces the momentum constraints in a holonomically constrained hamiltonian system .",
    "this formulation interprets the shift vector as additional momentum variables and at the same time fixes it by gauge conditions . in the spatially continuous problem",
    ", a result in @xcite implies that with the enforced momentum constraints , the hamiltonian constraint function satisfies a conservation law .",
    "even if this property does not extend to the space discretization , it is an extra bonus for this momentum - constrained formulation .",
    "the problem of constraint growth in numerical relativity has also been tackled , using various techniques , in other free and constrained evolution schemes ( see e.g. @xcite ) .",
    "stable evolutions of the black hole binary problem are possible since 2005 @xcite . in the approach presented here",
    "we avoid the growth of the momentum constraints and additionally respect the hamiltonian structure of the equations .",
    "although no symplectic integrators are known for general constraints in hamiltonian systems , such integrators do exist for holonomically constrained systems .",
    "the most basic of these methods is the _ rattle method _ , a constrained version of the strmer  verlet method . in section 5",
    "we discuss its application to the holonomically constrained formulation of section 4 .",
    "section 6 presents the 1 + 1-dimensional examples with which we have done our numerical experiments : a perturbed minkowski problem and schwarzschild space - time .",
    "we describe the spatial discretization , the dirac gauge condition , and the boundary treatment that we used in our numerical experiments .",
    "section 7 compares a non - symplectic runge - kutta method and the symplectic strmer  verlet method on a perturbed minkowski problem , showing very different dynamical behavior in the harmonic energies corresponding to different modes . these energies are almost - conserved quantities in the time - continuous problem and in the symplectic method , but completely fail to be preserved in the non - symplectic method .",
    "section 8 compares the free and the constrained symplectic schemes on a different perturbed minkowski problem , illustrating that the unstable free evolution can be stabilized by enforcing the momentum constraints .",
    "section 9 compares free and constrained symplectic integrators on the schwarzschild space - time .",
    "it turns out that in the constrained scheme , boundary instabilities do not propagate into the interior of the domain , as opposed to the free scheme .",
    "our numerical experiments thus illustrate remarkable properties of symplectic vs.  non - symplectic and constrained vs.  free integrators that apparently have not been addressed in the literature before .",
    "for classical general relativity a variety of hamiltonian formulations is known ( see @xcite for a summary of the most popular ones ) .",
    "our work is based on the famous _ super - hamiltonian _",
    "@xcite ( see also @xcite ) .",
    "it was discovered as a preliminary to the quantization of gravity and relies on a 3 + 1 splitting of space - time .",
    "the geometry is described by the 3-metric of the spatial slices and their extrinsic curvature .    in the super - hamiltonian ,",
    "the position variables are provided by the 3-metric @xmath0 and the corresponding canonical momenta are denoted @xmath1 .",
    "they are related to the extrinsic curvature @xmath2 by @xmath3 . here",
    "@xmath4 is the determinant of the metric @xmath0 .",
    "the super - hamiltonian takes the form @xmath5 with freely specifiable functions @xmath6 and @xmath7 .",
    "the _ densitized lapse _",
    "@xmath6 is related to the lapse function @xmath8 by @xmath9 , and the vector with components @xmath7 is the _ shift vector_. the functions @xmath10 and @xmath11 are given by @xmath12 where @xmath13 is the ricci scalar of the metric @xmath0 , and is a tensor density of weight @xmath14 . ]",
    "@xmath15    solutions to the canonical hamiltonian equations of motion @xmath16 are solutions of einstein s equations if they satisfy the _",
    "scalar constraint _",
    "( or hamiltonian constraint ) and the _ vector constraints _ ( or momentum constraints ) @xmath17 if these constraints are satisfied for the initial data , then they remain satisfied in the course of the evolution . however , these functions do not satisfy a conservation law for general initial data . in this sense , @xmath10 and @xmath11 are _ weak invariants _ but not strong invariants . in section [",
    "sect : constrained ] we will consider a formulation where the momentum constraints @xmath11 are enforced ( treating @xmath7 as dynamical variables ) and the hamilton constraint function @xmath10 becomes a strong invariant .    the system is the adm system presented in @xcite .",
    "it is weakly hyperbolic , but not strongly hyperbolic , and hence it has an ill - posed initial value problem . for practical applications one will therefore prefer to adopt another hamiltonian formulation of general relativity , like e.g. a generalized harmonic system @xcite .",
    "however , we focus on the description of applications of symplectic integrators . adopting other formulations will not change our concept , but the details will be more complicated .    for a reasonable comparison of the properties of the different time integration methods in the free evolution schemes we will consider an example where the unstable modes of the ill - posed system are not excited in the course of the simulation ( see section [ sect : exp1 ] ) .",
    "concerning the constrained evolution scheme ( see sections [ sect : rattle ] ) we consider the modified system , where the equations as well as the vector constraints are explicitly imposed .",
    "unfortunately nothing is known yet about the well - posedness of the initial value problem of this constrained system .      to apply numerical methods",
    "one will always approximate the continuous functions @xmath0 , @xmath1 , @xmath7 and @xmath6 through objects with finitely many degrees of freedom , and introduce discrete derivative operators that act on these finite dimensional spaces . with those ingredients a discrete hamiltonian",
    "is derived by replacing the continuous functions and derivative operators in with the discrete ones .",
    "a concrete example of such a finite - difference discretization is given in section  [ sec : discretisation11 ] .",
    "with some care in defining the discrete canonical momenta , also finite element or spectral discretizations yield finite - dimensional canonical hamiltonian equations of motion .",
    "we collect the discrete degrees of freedom corresponding to the functions @xmath0 , @xmath1 , @xmath6 , @xmath7 in vectors @xmath18 , @xmath19 , @xmath20 , @xmath21 , respectively . the ordering in these vectors",
    "is chosen such that components corresponding to the same spatial grid point are ordered consecutively .",
    "since the super - hamiltonian consists of terms that are either quadratic in the momenta @xmath1 or linear in both @xmath1 and @xmath7 or independent of the momenta , any reasonable discretization of the super - hamiltonian @xmath22 will assume the form ( we ignore the dependence on the discrete densitized lapse @xmath20 in the notation ) @xmath23 where @xmath24 and @xmath25 are matrices of the appropriate dimensions .",
    "the matrix @xmath24 is a square and symmetric matrix . in a finite - difference discretization ,",
    "this matrix is block - diagonal with six - dimensional blocks corresponding to the six components of @xmath1 at a grid point , since the term in the super - hamiltonian that is quadratic in the momenta does not contain spatial derivatives .",
    "we then have @xmath26 blockdiag@xmath27 , where @xmath28 contains the six components of the 3-metric at the grid point @xmath29 .",
    "the discrete hamiltonian is thus quadratic in the momenta , but the functional dependence on the position variables is more complicated . the computationally expensive term with the discretized ricci scalar is subsumed in the potential @xmath30 .",
    "the canonical equations of motion for this discrete hamiltonian then read @xmath31   \\dot { { \\mathbf p}}&= &    -\\frac12 { { \\mathbf p}}^t { { \\boldsymbol \\nabla}}_{{\\mathbf q}}{{\\mathbf s}}({{\\mathbf q}}){{\\mathbf p}}-{{\\boldsymbol \\nabla}}_{{\\mathbf q}}u({{\\mathbf q } } )   -{{\\boldsymbol \\beta}}^t{{\\boldsymbol \\nabla}}_{{\\mathbf q}}{{\\mathbf d}}({{\\mathbf q}}){{\\mathbf p}}\\ , .",
    "\\end{array}\\ ] ] without further ado , the discretized momentum constraints @xmath32 , which read @xmath33 are _ not _ preserved under the evolution of the discretized system ( [ eq : discrete_evolution_equations ] ) , nor are the discretized hamilton constraints @xmath34 preserved",
    ". there may be an exponential or even super - exponential drift away from these constraints along solutions of the discrete system ( [ eq : discrete_evolution_equations ] ) .",
    "a standard symplectic integrator for hamiltonian systems is the strmer ",
    "verlet scheme , which is particularly prominent in the area of molecular dynamics and enjoys a number of remarkable properties ; see , e.g. , @xcite . when applied to ( [ eq : discrete_evolution_equations ] ) , a step from old values @xmath35 at time @xmath36 to values @xmath37 at time @xmath38 reads as follows : @xmath39 there is only one evaluation per step of the potential @xmath40 that contains the computationally expensive gradient of the discretized ricci scalar . the substeps ( [ sv - p1 ] ) and ( [ sv - q ] ) are implicit in @xmath41 and @xmath42 , respectively .",
    "they are solved by fixed - point iteration , which is local at every grid point .",
    "the choice @xmath43 for the shift vector further simplifies the formulas .",
    "the last substep ( [ sv - p2 ] ) is explicit .",
    "we will present numerical experiments with this method in sections [ sect : exp1][sect : exp3 ] .",
    "the strmer  verlet integrator is a second - order method .",
    "we remark that higher - order symplectic methods are obtained by suitable compositions of steps with different step sizes ; see , e.g. , ( * ? ? ?",
    "* section v.3 ) .",
    "since the constraints are not taken care of in the free evolution ( [ eq : discrete_evolution_equations ] ) , there may be an uncontrollable drift in the discretized momentum and hamiltonian constraints . while there exist symplectic integrators for holonomically constrained hamiltonian systems , see (",
    "* section vii.1 ) and ( * ? ? ?",
    "* chapter 7 ) , there exist no general symplectic integrators for systems where the constraints depend on both position and momentum variables , as is the case with the momentum and hamilton constraints in general relativity .",
    "we therefore look for a reformulation of the equations of motion for general relativity that enforces the momentum constraints via holonomic constraints and , as an extra benefit , turns the hamilton constraint function from a weak invariant into a strong invariant ( i.e. , satisfying a conservation law ) .",
    "while this reformulation can equally be done on the continuous level , we here present it for the discrete equations of motion ( [ eq : discrete_evolution_equations ] ) to which we will apply a symplectic integrator in the next section .",
    "we now consider @xmath21 as a dynamical variable and deal with it in two seemingly contradictory ways :    1 .",
    "we fix @xmath21 by a _ gauge condition _",
    "@xmath44 time differentiation of @xmath45 and using for @xmath46 gives @xmath47 which shows that indeed @xmath21 is determined by the gauge condition , when @xmath48 is invertible .",
    "+ a candidate for the choice of the gauge function @xmath49 is a discretization of the _ dirac gauge _ , @xmath50 . with this choice , @xmath48 is a discretized second - order elliptic differential operator .",
    "we consider @xmath21 as _ new momentum variables _ canonically conjugate to position variables @xmath51 that are not present in the hamiltonian ( [ h - disc ] ) , viz . , @xmath52 which still is quadratic in the momenta @xmath53 .    in the free evolution ,",
    "the equations of motion for this extended hamiltonian are ( [ eq : discrete_evolution_equations ] ) together with @xmath54 and @xmath55 .    in order to enforce the discrete momentum constraints",
    "@xmath56 , we therefore impose the _ holonomic constraints _ ( depending only on the position variables @xmath57 ) @xmath58 the corresponding _ hidden constraints _ obtained by time differentiation of these constraints and using the unchanged expressions for @xmath59 ( see ( [ eq : discrete_evolution_equations ] ) ) and @xmath60 then yields @xmath61 this way , the discrete momentum constraints appear as hidden constraints of a holonomically constrained hamiltonian system .",
    "moreover , @xmath21 is completely determined by the first equation in ( [ hidden ] ) .",
    "the full set of equations of motion with lagrange multipliers @xmath62 corresponding to the holonomic constraints is now @xmath63 \\dot{{\\mathbf p}}&= & -\\frac12 { { \\mathbf p}}^t { { \\boldsymbol \\nabla}}_{{\\mathbf q}}{{\\mathbf s}}({{\\mathbf q}}){{\\mathbf p}}-{{\\boldsymbol \\nabla}}_{{\\mathbf q}}u({{\\mathbf q } } )   -{{\\boldsymbol \\beta}}^t{{\\boldsymbol \\nabla}}_{{\\mathbf q}}{{\\mathbf d}}({{\\mathbf q}}){{\\mathbf p}}\\ , - { { \\boldsymbol \\nabla}}_{{\\mathbf q}}{{\\mathbf g}}({{\\mathbf q } } ) { { \\boldsymbol \\lambda}}\\end{array}\\ ] ] together with the constraints ( [ holo ] ) and ( [ hidden ] ) and formally also the equations @xmath64 with lagrange multipliers @xmath65 corresponding to the constraints @xmath66 .",
    "it is to this formulation that we will apply a suitable numerical integrator in the next section .",
    "this formulation , which can be similarly given also for the spatially continuous problem , does not enforce the hamilton constraint .",
    "however , in the continuous case , a result by anderson & york @xcite shows that satisfying the momentum constraints @xmath32 implies that the hamilton constraint function satisfies a conservation law @xmath67 where @xmath68 is the covariant derivative operator in the direction of the shift vector @xmath69 .",
    "the rattle method ( @xcite , ( * ? ? ? * section vii.1 ) , ( * ? ? ? * chapter 7 ) ) is an extension of the strmer  verlet method to holonomically constrained systems .",
    "it is symplectic and time - reversible , of second order accuracy , and enforces both the holonomic and the derived hidden constraints in the numerical solution . when applied to ( [ holo])([trivial - eom ] ) , a step of the rattle method consists of the following equations , which form a nonlinear system for @xmath42 and @xmath70 .    1",
    ".   first half - step for the momentum variables : @xmath71 2 .",
    "full step for the position variables : @xmath72 3 .",
    "position constraints : @xmath73 4 .",
    "second half - step for the momentum variables : @xmath74 5 .",
    "momentum constraints : @xmath75 \\label{p - constr } { { \\mathbf d}}({{\\mathbf q}}^{n+1}){{\\mathbf p}}^{n+1}&=&{{\\mathbf 0}}\\,.\\end{aligned}\\ ] ]    equations ( [ p - half])([gamma - constr ] ) determine @xmath42 , and ( [ p - half-2])([p - constr ] ) determine @xmath70 .",
    "the equations can be solved by an iterative procedure that requires only the solution of linear systems with the matrices @xmath76 and @xmath77 and their transposes .",
    "* iterative solution of ( [ p - half])([gamma - constr ] ) : * we start with @xmath78 as initial iterate for @xmath42 , @xmath79 for @xmath41 , @xmath80 for @xmath81 , and @xmath82 for @xmath83 . with these values",
    "we first update the iterates @xmath42 and @xmath41 through and respectively , inserting the initial iterates at the right - hand sides of these equations .",
    "then , for given iterates of @xmath42 , @xmath41 and @xmath81 , equations ( [ gamma - constr ] ) , ( [ gamma - new ] ) and ( [ p - half ] ) yield an equation for @xmath83 : @xmath84 the matrix on the left - hand side is @xmath85-close to @xmath86 and therefore invertible under condition ( [ gauge ] ) .    equation can be interpreted as the requirement to choose @xmath83 such that the momentum constraints are satisfied for the next iterate , @xmath87 .",
    "instead of using to obtain @xmath87 from the current iterates we may also assume that it is approximately @xmath88 with a small correction @xmath89 to the lagrange multipliers .",
    "this leads to the following equation , @xmath90 we solve this approximately for the increment @xmath89 , and replace the current iterate @xmath91 .",
    "inserting ( [ q - new ] ) into ( [ q - constr ] ) gives an equation for @xmath81 . with the current iterates in the argument of @xmath49",
    ", we solve for the increment @xmath92 in a step of a simplified newton iteration : @xmath93 and replace @xmath94 .",
    "we then update the iterates of @xmath41 and @xmath42 using and ( [ q - new ] ) respectively with the current iterates on the right - hand side .",
    "we thus have the following schematic iteration cycle : @xmath95 * solution of ( [ p - half-2])([p - constr ] ) : * inserting ( [ p - half-2 ] ) into ( [ p - constr ] ) yields a linear system for @xmath96 with the matrix @xmath97 . after solving this system",
    "we compute @xmath70 from ( [ p - half-2 ] ) , and then @xmath98 is obtained from solving the linear system ( [ beta - constr ] ) with the matrix @xmath77 .",
    "we remark that equations ( [ beta - half ] ) and ( [ beta - half-2 ] ) are ignored , since they only determine approximations to the lagrange multipliers @xmath99 that are without further interest .",
    "* symplecticity . *",
    "the rattle method is symplectic with respect to the canonical symplectic two - form @xmath100 for the _ extended _ phase space of @xmath101 restricted to the constraint manifold ; see ( * ? ? ?",
    "* section vii.1 ) , ( * ? ? ?",
    "* chapter 7 ) .",
    "because of @xmath102 , the extended symplectic two - form here actually reduces to the original canonical symplectic two - form @xmath103 .",
    "after the general discussion in the previous sections we now describe in detail the problems considered in our numerical experiments .",
    "we derive a simplified hamiltonian in section [ sec : simple_hamiltonian ] , and in section [ sec : discretisation11 ] we describe the spatial discretization procedure that leads to a discrete hamiltonian . in section [ sec:11gauge ]",
    "we introduce the gauge conditions that we use and discuss some problems that are related to that topic .",
    "we describe a straightforward boundary treatment in section [ sec : boundary_conditions ] , before we turn to the particular test problems in section [ sec : free_test_scenarios ] .      for a first test",
    "we restrict to simple problems .",
    "we therefore consider only those solutions of einstein s equations that satisfy the following requirements : @xmath104 where either @xmath105 or @xmath106 .",
    "the latter case corresponds to spherically symmetric space - times , and the class of solutions with @xmath105 includes a perturbed minkowski geometry .",
    "both cases will be considered later on .",
    "it is easy to show that one obtains solutions in either of these classes if is satisfied at the initial hypersurface @xmath107 , if moreover at @xmath107 @xmath108 ( where @xmath109 or @xmath110 in the two cases , respectively ) and if the gauge is chosen such that everywhere @xmath111 to summarize , if is satisfied at every time slice and if , are satisfied at @xmath107 then , are satisfied for all times , as long as einstein s equations hold .    because of the last equations in , it is natural to define @xmath112 it turns out that with these definitions @xmath113 is indeed the canonical momentum corresponding to @xmath114 .    in the spherically symmetric case",
    "we now consider the equatorial hypersurface , i.e. , @xmath115 and @xmath116 . using the new variables it can be shown that the following simplified hamiltonian provides the correct evolution equations for the functions @xmath117 , @xmath118 , @xmath114 and @xmath119 : @xmath120,\\end{aligned}\\ ] ] where @xmath121 in the spherically symmetric case and @xmath122 if @xmath105 .",
    "this hamiltonian has a similar structure to the super - hamiltonian , its discretization will therefore also be of the form .",
    "based on we now derive a discrete hamiltonian .",
    "we introduce two uniform and @xmath123 . ] spatial grids @xmath124 and @xmath125 , , otherwise @xmath126 .",
    "] staggered such that @xmath127 .",
    "we approximate the functions @xmath128 , @xmath117 , @xmath118 , @xmath114 , @xmath119 by piecewise constant functions @xmath129 , such that @xmath130 and then replace the continuous functions in @xmath131 by the piecewise constant ones ( @xmath132 ) .",
    "for the shift function @xmath133 the staggered grid @xmath125 is the basis of this discretization , i.e. , @xmath134 discretizing @xmath133 on the staggered grid leads to better results in the constrained evolution .",
    "spatial derivatives are approximated by those piecewise constant functions whose functional values are obtained through centered finite differencing , i.e. , @xmath135 for @xmath136 .",
    "an analogous formula is used also for the derivatives of @xmath133 on the grid @xmath137 .",
    "these functions again replace the continuous functions @xmath138 and @xmath139 , respectively , in the continuous hamiltonian @xmath131 .    to get the discretization of the integrand in one additionally needs to take a logarithm and to perform additions as well as multiplications .",
    "these are pointwise operations where the continuous functions can be replaced by the piecewise constant ones easily .",
    "hence , the integrand of the discrete hamiltonian @xmath140 is again a piecewise constant function .    comparing the discrete hamiltonian for the 1 + 1 dimensional setting with its general form we identify the potential @xmath30 with the discretization of the second line in .",
    "the matrix @xmath141 is derived from the kinetic term @xmath142 and the matrix @xmath143 comes from the shift term @xmath144    as we discussed in section [ sec : discretization_general ] , the matrix @xmath141 is blockdiagonal with each block corresponding to a single grid point , because does not contain spatial derivatives . here ,",
    "in the 1 + 1-dimensional setting , the blocks are two dimensional corresponding to the functions @xmath118 and @xmath113 respectively , and the elements of the blocks can be obtained through @xmath145    concerning the matrix @xmath143 , the integrand in does contain derivatives . since we use a staggered grid for the discretization of @xmath133 ,",
    "here @xmath143 becomes an @xmath146 matrix of the form @xmath147 where each star represents a row - vector @xmath148      for the constrained evolution scheme discussed in section [ sect : constrained ] we additionally need to choose a gauge constraint @xmath45 . in what follows",
    "we derive this function from the dirac gauge @xcite , a condition that in the continuous problem fixes the spatial coordinate system .",
    "this gauge condition is formulated in terms of a flat background metric , see @xcite for details .    in the 1 + 1 dimensional context",
    "the dirac gauge condition becomes @xmath149 where @xmath121 in the spherically symmetric case and @xmath122 for the @xmath105 class of problems .",
    "the dependence on @xmath150 for spherically symmetric systems comes from the flat background metric , which is the minkowski metric in spherical coordinates there .    from the continuous gauge condition we derive a discrete one as follows .",
    "first we observe that we obtain equation when we require that the variation of the following integral with respect to @xmath151 vanishes @xmath152    this integral is again discretized by the procedure described in section [ sec : discretisation11 ] , that is , the functions @xmath117 , @xmath114 and @xmath150 are approximated by piecewise constant functions corresponding to the grid @xmath153 and @xmath151 becomes a piecewise constant function based on the staggered grid @xmath125 .",
    "we thus obtain a discrete function @xmath154 of the grid variables @xmath18 , @xmath155 and @xmath62 . following the procedure in the continuous case",
    "we take the derivative of @xmath154 with respect to @xmath62 as the discrete gauge constraints .",
    "this defines functions @xmath156 , but as discussed in section [ sect : constrained ] we additionally need that the matrix @xmath48 is invertible .",
    "it is not a priori clear that this condition is satisfied .",
    "therefore we made several spot checks by calculating the singular values of @xmath48 .",
    "it turns out that in the simulations where the computational domain possesses boundaries , in particular for spherical symmetry , we indeed find that the ratio of the largest to the smallest singular value was at most @xmath157 and the ratio of the smallest to the second smallest was always below @xmath158 . but with periodic boundary conditions it turns out that one singular value is more than ten orders of magnitude smaller than the others , and hence @xmath48 must be regarded as singular .",
    "* constraints for periodic boundary conditions .",
    "* the origin of the non - trivial kernel of @xmath48 can be found already in the continuous 1 + 1 dimensional formulation . there",
    "the expression @xmath159 translates to @xmath160 \\right).\\end{aligned}\\ ] ] it can be easily checked that with periodic boundary conditions the equations @xmath161 hold for any function @xmath162 .",
    "that means the constant functions are in the kernel of the transpose operator @xmath163 , and functions of the form @xmath164 ( @xmath165 ) are in the kernel of @xmath166 . if the dirac gauge is satisfied then @xmath167 .",
    ", so that the constant functions are also in the kernel of @xmath166 .",
    "this argument can also be extended to other gauge conditions and probably to higher dimensions .",
    "we do not want to elaborate on this here , we only mention that for periodic boundary conditions @xmath166 will have a non - trivial kernel for any pointwise gauge condition of the form @xmath168 .",
    "now , the singularity of @xmath48 means that we can not solve equations and for @xmath169 and @xmath170 in the rattle scheme .",
    "we therefore solve another system which enforces the discrete momentum constraints only up to a multiple of the spatially constant vector @xmath171 .",
    "it turns out that for @xmath45 this vector is indeed in the kernels of @xmath48 and @xmath172 , and that the system @xmath173 has a unique solution for any right - hand side @xmath174 .",
    "we then solve systems of this form instead of and , and take the obtained @xmath169 and @xmath170 as the right correction to the lagrangian multipliers and the shift variables respectively .    however , with that procedure we do not have control of the mean value of the momentum constraints .",
    "we see this immediately when we notice that @xmath175 is independent of @xmath62 ( since @xmath176 is in the kernel of @xmath48 ) .",
    "hence , the mean value of the momentum constraints can not be brought to zero by this procedure , and instead of satisfying , we can only fulfill @xmath177 where @xmath178 is the projector to the subspace orthogonal to @xmath176 .",
    "the full discrete momentum constraints @xmath179 could be enforced by adding an extra gauge condition as a discretization of an integral condition @xmath180 by @xmath181 where the function @xmath182 and the vector @xmath174 are chosen such that @xmath183 it turns out that this condition corresponds to @xmath184 in the continuous case .",
    "we have , however , not included such an extension by an integral gauge condition in our numerical experiments .",
    "we now describe the implementation of boundary conditions .",
    "as we focus on the investigation of the time evolution , we tried to keep this aspect simple .",
    "for the tests in the @xmath105 class of solutions we impose periodic boundary conditions and there is actually no boundary .",
    "but in the spherically symmetric case it is not possible to impose periodic boundary conditions .    for our spatial discretization",
    ", the time derivatives of the variables at the grid point @xmath185 only depend on the variables at the neighboring grid points @xmath186 , @xmath187 , @xmath188 , @xmath189 , @xmath190 and @xmath191 , @xmath192 , @xmath193 , @xmath194 .",
    "therefore we extend the spatial grids beyond the computational domain , that is , we introduce ghost zones to the left and to the right of the boundary ( see figure [ fig : spatial_grid ] ) .",
    "the function values at the grid points in these ghost zones are then treated as non - dynamical variables . in general",
    "these function values are fixed through the choice of boundary conditions , and here we simply set them to values that we read off from a reference solution .",
    "the discrete hamiltonian still has the form , we only change the interpretation of the variables .",
    "therefore the equations of motion for the variables in the computational domain have the same form as in the case of periodic boundary conditions and the variables in the ghost zones do not possess evolution equations .",
    "( 0,0 )    # 1#2#3#4#5 @font    ( 5159,915)(706,-3035 ) ( 2026,-2986)(0,0)[lb ] ( 3826,-2986)(0,0)[lb ] ( 1441,-2221)(0,0)[lb ] ( 4681,-2356)(0,0)[lb ] ( 4681,-2221)(0,0)[lb ] ( 2161,-2356)(0,0)[lb ] ( 721,-2356)(0,0)[lb ]    in the general form of the hamiltonian we then have to distinguish between dynamical variables in the computational domain and non - dynamical variables in the ghost zones .",
    "in particular we must subdivide the matrix @xmath143 such that the non - dynamical character of the ghost variables can be considered .",
    "then , @xmath143 takes the form ( cf .",
    "equation ) @xmath195 where @xmath196 corresponds to grid points in the computational domain and the remaining matrices to grid points in the ghost zones .",
    "for @xmath141 the consideration of ghost variables leads to an analogous result , but @xmath141 is block diagonal and hence the only non vanishing `` ghost matrices '' are @xmath197 and @xmath198 .",
    "these matrices only depend on variables in the ghost zones .",
    "hence , they have no influence on the equations of motion and are therefore irrelevant .",
    "we collect the ghost matrices in three matrices @xmath199    if we denote the variables in the ghost zones as @xmath200 , @xmath201 and @xmath202 , respectively , then the hamiltonian can be written as @xmath203 from this hamiltonian one obtains the equations of motion for @xmath18 and @xmath19 , as well as the one - step map in the strmer  verlet scheme as described in sections [ sec : discretization_general ] and [ sect : sv ] , respectively .",
    "we note that with the chosen space discretization , @xmath204 .",
    "moreover , it turns out that @xmath205 does not depend on @xmath201 , and so the discrete momentum constraints become @xmath206 and thus do not depend on the variables in the ghost zones .",
    "this structure is due to the discretization of the shift @xmath133 at the staggered grid @xmath137 .",
    "if the shift is discretized at @xmath207 then @xmath143 does not have the bidiagonal structure , but there are more non - vanishing elements , and the momentum constraints depend on @xmath208 and @xmath209 as well .",
    "the grid functions in the ghost zones are specified as @xmath210 for each grid function @xmath162 , each grid point in the ghost zone @xmath211 and all times @xmath212 , with given reference functions @xmath213 in the exterior .",
    "this does not apply to the lagrange multipliers @xmath62 , which are defined only on the staggered grid in the interior domain .",
    "in our example of the schwarzschild space - time given below , the analytically known stationary solution is chosen as initial data and exterior data , leaving only a numerical dynamics that reflects the stability properties of the various numerical schemes .      in the following sections we investigate the properties of the strmer  verlet and the rattle method in two different situations .",
    "the first one , a perturbed minkowski space - time , is an example for the case @xmath105 , and the second one , the schwarzschild space - time , is a spherically symmetric solution .",
    "[ [ perturbed - minkowski . ] ] perturbed minkowski .",
    "+ + + + + + + + + + + + + + + + + + + +    the minkowski metric describes a flat space - time , the analytical solution is ( with @xmath214 , @xmath215 , @xmath216 ) @xmath217 it is easy to check that for @xmath218const . slicing",
    "this solution really is in the class with @xmath105 and thus the numerical schemes we described are applicable .    here",
    "we perturb the minkowski initial data .",
    "we denote the perturbations @xmath219 and @xmath220 , and get that at a slice @xmath221 the independent components of the 3-metric are @xmath222 the canonical momenta become @xmath223 and without perturbations the slicing density is identical one and the shift vector vanishes : @xmath224    the spatial grid is chosen as the uniform grid @xmath225 and we apply periodic boundary conditions .    [ [ schwarzschild - space - time - in - isotropic - coordinates . ] ] schwarzschild space - time in isotropic coordinates .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the schwarzschild space - time in isotropic coordinates is described by the metric ( with @xmath226 , @xmath227 , @xmath228 ) @xmath229 where @xmath230 . for @xmath218const .",
    "slicing we thus obtain @xmath231 the extrinsic curvature and the canonical momenta vanish as well as the shift , @xmath232 and the densitized lapse is @xmath233    the spatial grid is chosen as @xmath234 to treat the boundaries we continue the uniform spatial grids beyond the boundaries , introducing @xmath235 grid points in ghost zones to the left and the right .    the schwarzschild solution in isotropic",
    "coordinates satisfies dirac gauge .",
    "this permits us to obtain initial data easily and to compare the numerical results with the exact stationary schwarzschild solution . applying a numerical method with these initial data",
    "yields a purely numerical dynamics that reflects the stability properties of the various numerical schemes .",
    "[ [ symplectic-strmerverlet-vs.non-symplectic-icn-scheme . ] ] symplectic strmer  verlet vs.  non - symplectic icn scheme .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we compare the results of the strmer  verlet scheme ( see section [ sect : sv ] ) with that of a free non - symplectic scheme , the iterated crank nicholson method ( icn ) . for a system of ordinary differential equations @xmath236 , icn reads @xmath237 in both schemes the densitized lapse as well as the shift are chosen not to change with time , @xmath238 and @xmath239 .",
    "we apply the schemes to the perturbed minkowski example of section [ sec : free_test_scenarios ] , where the perturbation is chosen such that the functions denoted @xmath219 are gaussian functions with width @xmath240 , center @xmath241 and height @xmath242 .",
    "the functions denoted @xmath220 are chosen to vanish .",
    "that is , we perturb @xmath117 , @xmath119 , @xmath6 and @xmath133 , but we keep @xmath114 and @xmath118 from the unperturbed minkowski problem .",
    "the case where all functions are perturbed by random noise , is discussed in the next section .",
    "[ [ simulation - data . ] ] simulation data .",
    "+ + + + + + + + + + + + + + + +    the reason to choose @xmath243 here is the hyperbolicity of the considered system .",
    "it turns out that the equations of motion that correspond to are weakly hyperbolic , but not strongly hyperbolic in the sense of @xcite .",
    "however , if we have @xmath244 and @xmath245 at some time @xmath246 then the continuous as well as the discrete evolution equations lead to @xmath247 and @xmath248 .",
    "we can hence omit these functions in the analysis of hyperbolicity .",
    "the obtained system for @xmath117 and @xmath113 is then strongly hyperbolic .    in the simulations we use grids with @xmath249 or @xmath250",
    "grid points .",
    "the size of the time step is the same as the spatial grid spacing , i.e. , @xmath251 .",
    "the computational costs are comparable for both time - stepping methods .",
    "[ [ simulation - results . ] ] simulation results .",
    "+ + + + + + + + + + + + + + + + + + +    it turns out that for both integrators the simulations are stable at least until @xmath252 .",
    "we do not see any growing modes , and we expect that the simulations remain stable for a much longer time .",
    "the discrete momentum constraint vanishes identically , because @xmath118 as well as @xmath253 vanish .",
    "the discrete hamilton constraint does not vanish exactly , but it stays almost constant at about @xmath254 for both schemes .    to see how the perturbations evolve , we calculate the _ harmonic energies _ corresponding to @xmath117 .",
    "let @xmath255 be the vector composed of the grid values of @xmath117 , and let @xmath256 denote the @xmath257th component of its discrete fourier transform .",
    "let further @xmath258 be the @xmath257th component of the fourier transform of @xmath259 .",
    "then , the harmonic energy in the @xmath257th mode is @xmath260 .",
    "as we see in figure [ fig : exp1:harmonic_energies_icn_sv ] , the @xmath261 are approximately preserved by the strmer  verlet scheme over long times , whereas with the icn scheme they incorrectly decay exponentially until they reach the level of round - off error .",
    "the exponential decay is much faster for high frequencies .    [",
    "cols=\"^,^ \" , ]     [ [ discussion - of - results.-2 ] ] discussion of results .",
    "+ + + + + + + + + + + + + + + + + + + + + +    we have seen that in the free evolution again high frequency errors occur , whereas they are absent in the constrained evolution scheme .",
    "our simple choice of boundary conditions of section [ sec : boundary_conditions ] leads to boundary instabilities , and so the main source of errors are the boundaries . in the free evolution",
    "the errors at the boundaries quickly propagate into the interior of the computational domain and amplify . in the constrained scheme ,",
    "the propagation into the interior is suppressed .",
    "we are grateful to sascha husa and bernd brgmann for their helpful advice .",
    "this work was supported by dfg grant sfb / transregio 7 `` gravitational wave astronomy '' .",
    "j.  frauendiener . . ,",
    "41 no 38:382005 , 2008 .",
    "r.  gambini and j.  pullin .",
    "consistent discrete space - time . in a.",
    "ashtekar , editor , _ 100 years of relativity  space - time structure : einstein and beyond_. world scientific , 2005 ."
  ],
  "abstract_text": [
    "<S> we consider symplectic time integrators in numerical general relativity and discuss both free and constrained evolution schemes . for free evolution of adm - like equations we propose the use of the strmer  verlet method , a standard symplectic integrator which here is explicit in the computationally expensive curvature terms . </S>",
    "<S> for the constrained evolution we give a formulation of the evolution equations that enforces the momentum constraints in a holonomically constrained hamiltonian system and turns the hamilton constraint function from a weak to a strong invariant of the system . </S>",
    "<S> this formulation permits the use of the constraint - preserving symplectic rattle integrator , a constrained version of the strmer  verlet method .    </S>",
    "<S> the behavior of the methods is illustrated on two effectively 1 + 1-dimensional versions of einstein s equations , that allow to investigate a perturbed minkowski problem and the schwarzschild space - time . </S>",
    "<S> we compare symplectic and non - symplectic integrators for free evolution , showing very different numerical behavior for nearly - conserved quantities in the perturbed minkowski problem . </S>",
    "<S> further we compare free and constrained evolution , demonstrating in our examples that enforcing the momentum constraints can turn an unstable free evolution into a stable constrained evolution . </S>",
    "<S> this is demonstrated in the stabilization of a perturbed minkowski problem with dirac gauge , and in the suppression of the propagation of boundary instabilities into the interior of the domain in schwarzschild space - time .    </S>",
    "<S> pacs numbers : 04.25.d- , 04.20.fy </S>"
  ]
}