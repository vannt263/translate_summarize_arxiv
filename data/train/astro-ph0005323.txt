{
  "article_text": [
    "understanding the evolution of structure in the universe and its relation to initial conditions is a fundamental issue in cosmology .",
    "galaxy formation involves physical processes such as star formation , supernovae feedback , and dust extinction which we still are far from understanding in full . on the other hand ,",
    "the clustering of the collisionless dark - matter ( dm ) component is well understood .",
    "dm particles cluster into halos , which subsequently accrete more mass either by gradual infall or by merging with other halos",
    ". an accurate description of the distribution of dm halo mass ( the mass function ) and its temporal evolution are crucial for our understanding of the evolution of the luminous galaxies that reside in these halos .    a popular approximation to the mass function is provided by the press - schechter formalism ( press & schechter 1974 , hereafter ps ) .",
    "the initial density fluctuation field , smoothed on some comoving scale @xmath10 , is assumed to evolve according to linear theory until it reaches a critical value , @xmath11 , at which time it is assumed to have collapsed and virialized .",
    "the critical value is determined by a linear extrapolation to the collapse time as set by the spherical collapse model .",
    "many of the simplifying assumptions behind the ps formalism do not seem to be physically motivated , yet it turns out to predict with reasonable accuracy the mass function as seen in simulations ; the neglected effects tend to cancel each other ( monaco 1998 ) .",
    "while being very useful for qualitative and semi - quantitative analyses , the accuracy of the ps approximation may not be enough when quantitative details are concerned .",
    "for example , it has been found based on simulations that for halo masses below @xmath12 ( depending on the specific cosmological model ) the ps approximation overestimates the mass function by as much as a factor of @xmath8 ( gross 1998 ; lee & shandarin 1999 ; somerville 2000 ) . at the high - mass end , @xmath13",
    ", the ps formalism underestimates the abundance of dm halos , especially at high redshift ( , governato 1999 , somerville 2000 ) .",
    "improved approximations have been proposed in order to correct these inaccuracies , , a modification of ps by sheth and tormen ( 1999 , hereafter st ) , practically replacing the spherical collapse model with an ellipsoidal collapse model ( sheth , mo , & tormen 2000 ) .",
    "lee & shandarin ( 1998 , hereafter ls ) also use a non - spherical approach , based on the zeldovich approximation ( zeldovich 1970 ) , to improve the ps approximation .",
    "the need for a more accurate description of the mass function is further highlighted by the development of a useful approach for studying galaxy formation and evolution based on semi - analytical models ( kauffmann 1999 ; somerville & primack 1999 ; baugh 1999 ) .",
    "semi - analytical models try to circumvent the complications associated with baryonic processes by simplified prescriptions and artificially embedding galaxies within dm halos , which allows them to subsequently predict observable statistical quantities such as the galaxy luminosity function or the tully - fisher relation .",
    "some of the important processes governing the evolution of galaxies in semi - analytical models are directly related to the dm clustering properties ; for example , the mass function and merger histories of the halo populations are key ingredients in semi - analytical models ( kauffmann 1999 ; somerville & kolatt 1999 ) .",
    "these need to be followed with a better accuracy than provided by the ps approximation .",
    "furthermore , the ps formalism does not address substructure within halos .",
    "when two halos merge , the ps approximation immediately labels them as one virialized halo . however , high - resolution simulations ( e.g. , klypin 1999a , ghigna et al .",
    "1998 ) show that substructure does maintain its identity after merging into larger halos .",
    "this means that galactic halos are expected to survive tidal stripping for some time , with possible important consequences for collisions and starbursts ( kolatt 1999 , 2000 ) .",
    "an alternative to modeling the complicated physics needed to predict galaxy luminosities in individual halos is to calculate statistical properties such as the distribution function of the circular velocity of halos  the velocity function . by using observed luminosity - velocity relations , one",
    "can then relate the predicted velocity function to observational luminosity functions ( gonzales 2000 ; bullock 2000b ) and address halo number counts directly .",
    "in addition , because modeling luminosities of the high - redshift galaxies is even more uncertain than modeling the local population , the redshift evolution of the halo velocity function provides a much - needed , and more direct handle on the galaxy population than the corresponding mass function .    in order to obtain the velocity function we use a high - resolution simulation which has the force resolution and mass resolution necessary to determine the maximum circular velocities of halos , and is capable of resolving substructure within halos ( kravtsov , klypin & khokhlov 1997 ) .",
    "the simulation is complemented by a halo finding algorithm which also classifies halos into nesting levels of halos within halos ( bullock 2000a ; bullock 1999 ; see  [ sec : method ] ) .",
    "our halo finder / classifier ( hfc ) fits each halo by an nfw density profile ( navarro , frenk & white 1996 ) and automatically assigns a circular velocity profile to each halo . for the purpose of comparing to observations ,",
    "some of the halos are assumed to be galactic halos based on a simple prescription following basic observational constraints .    in  [",
    "sec : method ] we present our method for extracting the mass (  [ sec : massf ] ) and velocity (  [ sec : velf ] ) functions for the different populations of halos ( , subhalos that reside in massive hosts , halos of galaxies in groups , etc . ) , while correcting for incompleteness in the halo - finding algorithm by an iterative procedure . in ",
    "[ sec : gal_id ] we present a simple scheme for identifying `` galactic '' halos . in ",
    "[ sec : results ] we compare results for distinct halos to the ps , st , and ls predictions , and extend our investigation to the mass and velocity functions of substructure as well .",
    "the results for halos and subhalos at @xmath5 are discussed in  [ sec : z0 ] , and their redshift evolution is presented in  [ sec : evolution ] .",
    "results for galactic halos in different environments are outlined in  [ sec : gal_res ] .",
    "we discuss our results and compare them to other studies in  [ sec : conc ] .",
    "advances in numerical simulations of the collisionless dm component allow a dynamical range large enough for studying substructure within halos in a volume that approaches a fair cosmological sample of the galaxy distribution ( klypin 1999a ) . using an adaptive refinement tree code ( kravtsov , klypin & khokhlov 1997 ) , we have simulated the currently popular @xmath0cdm model within a comoving periodic box of 60@xmath14 , with a force resolution of @xmath15 in the dense regions .",
    "the cosmological model is spatially flat , with matter and cosmological constant contributions of @xmath16 and @xmath17 at @xmath5 .",
    "the hubble constant is @xmath18 ( @xmath19 ) , and the fluctuation amplitude today is normalized by @xmath20 .",
    "the @xmath21 simulated particles imply a mass resolution of @xmath22 .    within this simulation",
    "it is possible to resolve halos inside halos to four levels down the hierarchy .",
    "this is done via a halo finder / classifier , based on the bound density maxima method ( klypin & holtzman 1997 ) , which has been specifically developed for the purpose of analyzing substructure . a detailed description of the can be found in bullock ( 1999 ) and in the appendix of bullock ( 2000a ) .",
    "below are some of its basic ingredients that are relevant to the mass and velocity distribution functions .    a key feature of the is that it models the radial density profile of each halo with a universal functional form .",
    "we use here the nfw profile : ( r)=   , [ eq : nfw ] where the two free parameters are an inner density @xmath23 and a characteristic scale length @xmath24 .",
    "it is also convenient to define the virial radius of a halo by = ( 3 ) ^1/3  , [ eq : rvir ] where @xmath25 is the virial mass , and virialization is defined by the mean density inside @xmath26 being @xmath27 times the mean density @xmath28 .",
    "the value of the virial overdensity @xmath27 comes from the top - hat collapse model ; it is about 200 for an einstein - desitter cosmology , and @xmath29 at @xmath2=0 for the @xmath0cdm model simulated here .",
    "the corresponding virial velocity is defined by @xmath30 .",
    "the profile fits were performed in the range @xmath31 .",
    "the fitting procedure automatically provides errors for the parameters @xmath23 and @xmath24 , which we then translate to errors in the other useful halo parameters such as @xmath25 and @xmath32 .",
    "the modeling of each halo by a smooth spherically - symmetric profile helps the identification of halos within halos . halos at the top of the hierarchy ( not within other halos )",
    "are termed `` distinct '' , while all other halos are termed `` subhalos '' .",
    "we only try to fit halos with modeled mass equivalent to at least 50 particles .",
    "as will be seen below (  [ sec : massf ] ) , the finds halos with @xmath33 at almost 100% efficiency , while at lower masses the constructed halo catalogs gradually become incomplete . at @xmath2=0 , a total of @xmath348000 dm halos",
    "are identified , 90% of which are distinct .",
    "their numbers drop by approximately an order of magnitude for each level down the hierarchy .    in the following two subsections",
    "we present our method for reconstructing the mass and velocity functions of any subset of the halos identified by the hfc .",
    "an iterative procedure corrects for the incompleteness at small masses (  [ sec : massf ] ) .",
    "the velocity function is recovered in  [ sec : velf ] based on the derived mass function and the nfw profile fit .",
    "a simple count in bins of the halo population is prone to two main sources of systematic error .",
    "one is due to the incomplete efficiency of the at masses below @xmath35 , which causes an undercount in the low - mass bins .",
    "the other is malmquist bias due the low - mass cutoff imposed at 50 particles and the gradient in the mass function . in order to obtain an unbiased mass function",
    ", we pursue an iterative procedure as described in the following eight steps :    [ 1 ] the mass @xmath36 is the modeled virial halo mass @xmath25 .",
    "we first impose a mass cutoff corresponding to 50 particles , , @xmath37 , and then count the halos in bins of constant @xmath38 width . the logarithmic bin size , which is about 0.4 but slightly varying from case to case , is determined such that we have about 15 bins in the available mass range .",
    "we denote these raw counts by @xmath39 .",
    "they are shown in for the case of distinct halos at @xmath5 .",
    "[ 2 ] we evaluate the errors in each bin , @xmath40 , as the sum in quadrature of the poisson error due to the finite number of halos in the bin and the error in the assignment of halos to bins because of the uncertainty in the halo mass as determined by the hfc . in order to evaluate the latter , we produce 20 synthetic halo catalogs in which we perturb each mass of the simulated sample by an amount drawn at random from a gaussian distribution of width equal to the corresponding error .",
    "we count the halos in bins for each perturbed catalog , and take the error corresponding to each bin to be the standard deviation over the 20 perturbed catalogs .",
    "the total errors , @xmath40 , are shown as error bars in .    [ 3 ] we compute the completeness function of the hfc .",
    "it is assumed to depend only on the number of particles in the halo , namely @xmath36 , and not on redshift , or on whether the halo is a distinct halo or a subhalo .",
    "this assumption ( which is validated a posteriori ) allows us to evaluate the completeness only once , , for distinct halos at @xmath2=0 , and use it as is for all others cases .",
    "we find that in an extended range below @xmath41 , the mass function resembles a power law , while it drops sharply only near the low - mass end where incompleteness effects are manifested .",
    "we therefore assume that the underlying mass function is a power law all the way down to @xmath42 and determine this power law by a fit that uses the bins and errors determined above but excludes the first two bins near the minimum mass cutoff .",
    "the completeness in the j - th bin , @xmath43 , is defined by the ratio of the raw count @xmath39 in that bin and the count corresponding to the power - law fit .",
    "the completeness function estimated this way is shown in the inset of .    [ 4 ] the binned data corrected for incompleteness , @xmath44 , are fitted by a ( temporary ) schechter function , according to which the number density of halos in the mass range @xmath45 is given by n = ( m)m = _ * ^ e^-  , m / m _ *  , [ eq : schechter_m ] or n = ( m)(m ) = _ * ^ e^- ( m )  , [ eq : schechter ] where @xmath46 and @xmath47 .",
    "the fit parameters are @xmath48 , @xmath49 , and @xmath50 , and the minimum-@xmath51 fit procedure also provides the error in each one .",
    "this completes the preliminary stage of the analysis .",
    "next , we correct the schechter function for biases via an iterative procedure .",
    "[ 5 ] given an assumed `` true '' mass function in the @xmath52-th iteration @xmath53 ( derived as above for the first iteration ) , we produce 20 mock catalogs of halo masses drawn at random from this schechter distribution .",
    "we perturb the masses by a random deviant that is drawn from a gaussian distribution of errors appropriate for that mass range , which we have derived before the iterations from the actual error distribution within the corresponding mass bin .",
    "we then bin each perturbed mock dataset and fit it by a schechter function .",
    "a  biased \" schechter function @xmath54 is obtained by averaging the schechter parameters over the 20 noisy mock catalogs ( and the errors in the schechter parameters are determined by the corresponding standard deviations over the mock catalogs ) .",
    "thus , the malmquist biases lead from a  true \" @xmath53 to an  observed \" @xmath54 .    [ 6 ] to check how close we are to the desired solution , we pursue a comparison of the current model and data in the  observational \" plane . for this",
    ", we multiply the biased schechter counts by the completeness factors @xmath43 , and obtain biased and incomplete model counts in bins , @xmath55 .",
    "the measure used to evaluate convergence to the raw data is the weighted sum of residuals : @xmath56 .",
    "once we succeed in bringing @xmath57 to about unity , @xmath53 can be considered to be a good estimate of the unbiased mass function .",
    "[ 7 ] if @xmath57 is smaller than in the previous iteration , then we correct our previous guess for the bias by : _",
    "n+1 = ( _ n/ ) _",
    "n  , and go back to step [ 5 ] for the next iteration .    [ 8 ] when @xmath57 stops decreasing , we stop the iterations and adopt the current @xmath53 as our unbiased mass function .",
    "if @xmath57 is of order unity , this concludes our procedure .",
    "we comment that the completeness function as estimated in step [ 3 ] is in very good agreement with the completeness function as estimated independently by bullock ( 1999 ) , based on a comparison of our halo population with the halos found by a straightforward halo - finding technique that does not model the halo profiles .",
    "this agreement provides strong evidence that the estimate of the completeness function is correct .",
    "the use of the schechter function for the mass function is motivated by the following two arguments .",
    "first , luminosity functions are known to be well - fit by the schechter function , so if the mass - luminosity relation is roughly a power law , then the mass function is expected to be of a similar general form , with a power - law regime and a sharp drop at the large - mass end .",
    "second , a similar function is predicted by the ps approximation when the standard deviation of the density field @xmath58 is assumed to be roughly a power law .",
    "we will see that our data is capable of determining only the two parameters of the power - law part , while @xmath50 is only weakly constrained , and we do nt even try to fine - tune the fit with any additional parameters .    [",
    "t ! ]    shows the final , unbiased schechter function ( solid curve ) .",
    "also shown are the corresponding biased and incomplete counts , @xmath55 ( open pentagons ) . the good agreement between these counts and the raw counts",
    "@xmath39 is an indication for the success of our procedure in obtaining an unbiased result .",
    "the final value of @xmath57 in this case is 1.25 , which is indeed on the order of unity .",
    "the ps approximation overestimates the simulated mass function by a factor of @xmath342 for @xmath59 , then seems to cross over and underestimates the mass function for @xmath60 .",
    "the st approximation agrees with the simulated mass function to within 10% for @xmath59 , and seems to underestimate the simulated mass function for @xmath60 .",
    "the simulated mass function at @xmath61 carries a large error due to the small number of halos in this mass range , and therefore the apparent discrepancy of the approximations in this range is of low statistical significance .",
    "[ ht ]    compares the mass function for distinct halos and subhalos at @xmath62 ( which is the same as @xmath5 for all practical purposes ) .",
    "the raw data are also shown , with the apparent completeness turn - off at the two lowest mass bins .",
    "the ps and st approximations should be compared to the distinct halos mass function .",
    "the success of the approximations is very similar to the @xmath2=0 case .",
    "the exponential turnoff set by @xmath63 is not constrained very well .",
    "in fact , the error in @xmath63 is typically larger than @xmath63 itself .",
    "this is clearly demonstrated in the subhalo mass function of , where the last bin actually shows an apparent increase rather than a drop . the biased model counts are not shown in this figure ; their consistency with the raw counts is similar to what we had in , with a similar value of @xmath57 .",
    "the also provides for each halo an nfw maximum circular velocity , @xmath64 , and one could straightforwardly compute a raw velocity function",
    ". however , it would be impossible to correct this velocity function for biases following a similar procedure to the one applied to the mass function , because the incompleteness of the depends on mass , and there is no one to one correspondence between velocity and mass .",
    "we therefore adopt a different approach , where the biases are corrected at the mass - function level , and the velocity function is derived from the corrected mass function .    the conditional distribution of @xmath64 given @xmath36 is not approximated by a simple function and it strongly depends of redshift , so we choose to go from mass to velocity via the nfw  concentration \" parameter @xmath65 .",
    "we draw halo masses at random from the corrected schechter mass distribution , and assign to each of them a value of @xmath66 drawn from the conditional lognormal distribution p(c|m)=1  , [ eq : pcm ] where @xmath67 is the conditional standard deviation of @xmath68 at a given @xmath36 .",
    "the values of @xmath67 and @xmath69 are adopted from bullock ( 2000a ) ; they are different at different redshifts as well as for distinct halos and subhalos . the lognormal distribution assumed in",
    "will be justified a posteriori . given",
    "@xmath36 and @xmath66 , the nfw profile is uniquely determined , and in particular = 0.465(m ) ^-1/2   .",
    "[ eq : vmc ] we then count the halos in bins of constant @xmath70 width , and fit a power law .",
    "one main uncertainty in comparing the raw halo velocity function to that of galaxies is the response of the halos to the dissipative contraction of gas inside them .",
    "the typical effect is of an increase in halo maximum circular velocity , both due to the direct gravitational force exerted by the disk and the contraction of the halo in response to the additional inwards pull by the formed disk .",
    "we estimate the change in the relation between @xmath36 and @xmath64 using the fitting formula of mo , mao , & white ( 1997 , hereafter mmw ) , under the assumptions that is valid , all halos have a spin parameter @xmath71 , the specific angular momentum of the disk is equal to that of the dark matter , and the halo mass fraction which ends up in the disk is @xmath72 .",
    "the counts of the corrected @xmath64 values are also well fit by a power law .",
    "[ t ! ]    shows the velocity functions for distinct halos and for subhalos at @xmath2=0 .",
    "shown are the incomplete , raw counts as well as the corrected counts as derived from the unbiased schechter mass function .",
    "the associated power - law fits are shown both before and after the correction for baryonic infall .",
    "note how well this procedure corrects for the incompleteness at the low @xmath64 end .",
    "this result is still based on the same completeness function derived in the previous section as a function of mass , and it thus confirms its validity as well as the validity of .",
    "the velocity functions are clearly well fit by power laws across the whole available velocity range .",
    "we note , however , that a more realistic , semi - analytic treatment of disk masses @xmath73 may modify the power - law shape at the low and high velocity ends ( gonzalez 2000 ) .",
    "also shown in is a simplistic , ps - based theoretical prediction for the velocity function , not corrected for baryonic infall .",
    "it refers to distinct halos , assuming that the mass function is given by the ps prediction , and that the mass and velocity are related via the same concentration parameter for all halos , determined by the average @xmath74 .",
    "this approximation fails to reproduce the velocity function of the halos in our simulation by a factor of @xmath8 in amplitude and by a wrong slope .      in order to directly compare our simulation results with data based on observed galaxy rotation curves",
    ", we should identify a fraction of our halos as  galactic \" halos .",
    "we adopt the simplified assumption that every halo with mass @xmath75 hosts a galaxy .",
    "the mass cutoff is placed to exclude groups and clusters from the galaxy count .",
    "shows the two - point correlation function of these  galactic \" halos ; it is indeed in good agreement with the correlation function measured for galaxies in the apm survey ( baugh & efstathiou 1993 ) for @xmath76 .",
    "[ t ! ]    further division into  galaxies \" in groups and clusters versus isolated , field  galaxies \" may yield interesting theoretical predictions that can be directly confronted with observations .",
    "we identify isolated galaxies with the distinct  galactic \" halos that do not host subhalos , and grouped galaxies with the  galactic \" halos that do contain subhalos or that are subhalos themselves .",
    "observationally , the grouped galaxies are 40 to 60% of the total galaxy population ( , ramella , pisani & geller 1997 ; zabludoff & mulchaey 1998 ) .",
    "if we define a halo as a subhalo only if its center lies within the @xmath26 of a larger halo ( as done originally by kolatt 2000 ) , then the above classification scheme yields only @xmath77 in grouped  galaxies \" at @xmath5 .",
    "when we relax the proximity requirement of subhalos and hosts to @xmath78 , we obtain in the simulations a more reasonable fraction of @xmath79 in grouped  galaxies \" .",
    "indeed , the observer classification tends to include loose groups whose dm halos may not overlap .",
    "for the two populations of `` galaxies '' we assign velocities according to the mass  concentration relation of distinct halos .",
    "this may introduce a small error in the case of grouped  galaxies \" , which include some subhalos .",
    "shows the difference between the mass functions of distinct halos and subhalos at the present epoch.=0.03 rather that @xmath2=0 in order to compare neighboring redshift outputs ( see ) and to avoid redundancy with . ]",
    "apart from the difference in normalization , the two populations seem to follow a similar power - law distribution , with a slope of @xmath80 for the distinct halos and @xmath81 for the subhalos .",
    "as mentioned above , the turnoff scale @xmath50 is not well constrained , with a large formal error that is mainly due to the large poisson errors in the high - mass bins .",
    "the relative errors in the fit parameters grow only slightly with increasing @xmath2 .",
    "for example , the relative error in the slope increases by @xmath3420% between @xmath2=0 and @xmath2=3 .",
    "we fit the velocity function with a power law : n= ( ) = _ * ^  , [ eq : vfitbeta ] or n= ( ) ( ) = _ * ^ ( )  , [ eq : vfit ] with @xmath82 and @xmath83 . we do not attempt to fit a schechter function because there is not even a hint for a break at large velocities ; the weak signature of an exponential break seen in the mass function is completely erased in the velocity function by the scatter in the concentration parameter ( ) .",
    "figure  [ fig : massf_dis_sub_vel ] shows that the main qualitative results of the mass function carry over to the velocity function , namely , an order - of - magnitude difference in the normalization but very similar slopes for distinct halos ( @xmath84 ) and subhalos ( @xmath85 ) .",
    "this is despite the fact that the corresponding distributions of concentration parameter [ @xmath86 are different . the fits are quite robust , with the relative errors in the slope and the normalization ( defined at @xmath87 ) limited to a few percent , at all redshifts in the range 0 - 3 .",
    "the effect of applying the simple mmw baryonic infall prescription with @xmath88 is a logarithmic shift of the halo population to larger velocities ( as indicated by the arrows ) .",
    "the corresponding increase in normalization is a factor of @xmath89 , both for distinct halos and subhalos .",
    "the change in slope , to @xmath90 for distinct halos and @xmath91 for subhalos , is statistically insignificant .",
    "this was not expected _ a priori _ because the baryonic - infall correction depends on halo concentration @xmath66 ( halos of higher @xmath66 are assumed to accrete more baryonic mass ) and it is therefore expected to vary as a function of mass and velocity . furthermore , the correction is virtually the same for distinct halos and subhalos , despite the fact that the relation between mass and concentration is somewhat different for these two populations ( bullock 2000a ) . a more sophisticated treatment of infall , which would take into account effects such as",
    "the lower fraction of baryons involved in forming the disk inside low-@xmath92 halos , may yield a change in shape ( e.g. , a slight turn - off at low velocities , see gonzalez 2000 ) .      [",
    "t ! ]    the mass functions for distinct halos at three different redshifts in the range 0 to 4 are shown in . shown for comparison",
    "are the predictions of the ps and st models . at @xmath2=0",
    ", we recover the already known result ( , gross 1997 , somerville 2000 ) that at low masses the ps approximation overestimates the mass function by a factor of @xmath342 , while at high masses it is an underestimate . the st approximation fares better in general , and especially at low masses ; it is accurate to @xmath93 up to @xmath94 at @xmath5 , and @xmath95 at @xmath96 .",
    "the crossover mass , where ps agrees with the simulated mass function , shifts from @xmath97 at @xmath2=0 to @xmath98 at @xmath2=4 . by comparison , the typical collapsing mass @xmath99 , defined by @xmath100=1.69 $ ] ( where @xmath101 $ ] is the linear density fluctuation on a scale corresponding to mass @xmath36 ) , is equal to @xmath102 at @xmath2=0 and to @xmath103 at @xmath2=4 .",
    "the redshift evolution of the mass functions for both distinct halos and subhalos are displayed in .",
    "we show the evolution of the schechter fit parameters @xmath48 and @xmath104 at @xmath105 .",
    "we present the normalization by the latter rather than by @xmath49 because the large scatter in @xmath63 induces a non - negligible scatter in @xmath49 ( @xmath63 is determined by the value of @xmath106 at @xmath63 ) , and because at this relatively low mass we have good statistics throughout the studied redshift range .",
    "the values of @xmath63 and @xmath49 are given in table 1 .",
    "the top panels of figure  [ fig : massf_redshift ] show the evolution in the slope @xmath48 of the mass function of distinct halos and subhalos .",
    "a marked difference is seen between the two kinds of halos .",
    "while the distinct - halo mass function steepens with redshift from @xmath107 at @xmath2=0 to @xmath108 at @xmath109 , the subhalo slope has a broad minimum of @xmath110 at @xmath111 and it then rises to @xmath48=@xmath112 at @xmath2=5 .",
    "a useful functional fit that traces this evolution is provided by the quadratic polynomial ( z)=a+b+c^2  , ( 1+z )  .",
    "[ eq : poly ] these fits are shown in the figure , and the corresponding parameters @xmath113 , @xmath114 , and @xmath66 are listed in each panel .    the evolution of the normalization of @xmath106 at @xmath115 is shown in the bottom panels of . despite the big difference in amplitude , the trends with redshift are similar for distinct halos and subhalos , both remaining roughly constant between @xmath5 and @xmath116 , and then gradually declining , by roughly an order of magnitude at @xmath2=5 . indeed ,",
    "the functional fits to the two kinds of halos show a difference of @xmath116 in the offset @xmath113 and only 15% in the curvature @xmath66 .",
    "the error in the normalization at @xmath115 is much smaller than the error in @xmath49 .",
    "the error is the sum in quadrature of the random error associated with the count in the bin containing @xmath117 and the systematic error estimated by the change in the value of the fitted function across the bin .    for distinct halos we show in comparison the evolution of the ps model predictions , fitted at each redshift by a schechter mass function in the range @xmath118 .",
    "the ps approximation overestimates the normalization at @xmath119 for @xmath120 by a factor of @xmath121 , while at @xmath2=5 it is an underestimate by a factor of @xmath122 .",
    "the slope @xmath48 is well approximated up to @xmath123 , but is underestimated at higher @xmath2 by as much as unity .",
    "the st and ls approximations fare better than ps .",
    "they are quite similar , predicting accurately the slope up to @xmath124 . at @xmath125",
    "both approximations predict a slope steeper by @xmath3420% than what we find in the simulations .",
    "the st and ls models also improve on ps by predicting the normalization ( at @xmath119 ) more accurately , to within 25% in the range @xmath126 .",
    "the discrepancies in the predicted slope ( at high @xmath2 ) and normalization ( at low @xmath2 ) are small relative to the ps model , but are , nevertheless , statistically significant .",
    "[ t ! ]    we are also able to investigate the properties of a conditional mass function , at @xmath127 given a halo of mass @xmath128 at @xmath129 ( , lacey & cole 1993 ) . ] defined as the probability density @xmath130 of finding a subhalo of mass @xmath131 inside a host halo of mass @xmath132 .",
    "the conditional mass function was derived along the lines of the prescription described in  [ sec : massf ] .",
    "the conditional mass functions were fit to a schechter function at each @xmath2 output , and the fit parameters are given in table 2 .",
    "we have divided the host masses into three mass ranges bordered by @xmath133 and @xmath41 , and compared the conditional mass functions in these three ranges .",
    "the slopes of these functions are found to fluctuate in the range @xmath134 , with no obvious correlation with the host mass .",
    "there is also no evidence for redshift evolution of the slopes ( table 2 , second column ) , but note the large poisson errors .",
    "shows the conditional probability density @xmath130 at @xmath135 , for the three ranges of @xmath132 , as a function of redshift .",
    "the normalization here is by the number of host halos ( rather than by volume ) , so that an integration over all subhalo masses per given host - halo mass yields a probability of unity .",
    "the linear fits to the data exhibit very little evolution , in concordance with the results for the whole subhalo population .",
    "we see no evidence for @xmath132 dependence in the evolution of the subhalo mass function",
    ". this could be useful for constructing synthetic subhalo populations for semi - analytical simulations . since host mass correlates strongly with the subhalo environment density ( e.g. , top - hat smoothed at 1.5@xmath14 , bullock 2000a ) , also reflects the environment dependence of the subhalo mass function .",
    "[ t ! ]    shows the evolution of the parameters characterizing the velocity functions for distinct halos and subhalos .",
    "here , as for the mass function , the normalization is characterized by the value of the velocity function at a fixed velocity , of @xmath136 , rather than by @xmath137 .",
    "the fit parameters @xmath138 and @xmath137 of are listed in table  3 .",
    "we also provide fits to the evolution by the same quadratic polynomial as for the mass functions , .",
    "the errors are estimated as for the mass function ; they are larger for subhalos because there are fewer of them .",
    "the evolution of the slopes of the velocity functions is qualitatively similar to that of the mass function .",
    "this is not surprising since the @xmath139 relation at all redshifts is close to a power law , @xmath140 , implying @xmath141 . for distinct halos , @xmath142 at low @xmath2",
    "and it approaches @xmath143 at high @xmath2 as typical concentration values fall . for subhalos ,",
    "@xmath144 at @xmath5 and it again approaches @xmath143 at high @xmath2 ( bullock et al .",
    "2000a ) .",
    "on the other hand , the normalizations of the velocity functions remain roughly constant with redshift , unlike the decrease shown by the mass functions between @xmath145 and @xmath146 .",
    "this interesting behavior is a combination of two effects .",
    "first , ignoring the redshift dependence of @xmath27 , the typical halo density increases with redshift roughly as @xmath147 , implying that halos of a given velocity correspond to objects of smaller masses at high @xmath2 : @xmath148 . the increasing halo density with redshift",
    "is counteracted somewhat by the tendency of high-@xmath2 halos to be less concentrated ( bullock 2000a ) .",
    "the net result is a very weak evolution in the comoving number density of halos of a given , high velocity .",
    "since the slope of the velocity function becomes steeper at high @xmath2 , the fact that the normalization at a fixed @xmath149 is roughly independent of redshift implies that low velocity ( @xmath150 ) halos , and the galaxies that reside within them , are predicted to be more abundant at high redshift .",
    "[ b ! ]      in this subsection we aim at a prediction that can be directly tested observationally . as described in , we crudely assume that each halo of mass smaller than @xmath151 has a luminous galaxy in it ; this includes both distinct halos and subhalos .",
    "we then divide the galaxy population into two classes , of _ isolated _ galaxies and _ grouped _ galaxies , containing at @xmath5 about @xmath152 and @xmath153 of the galaxy population respectively .",
    "compares the velocity functions of these two classes , at @xmath5 and at @xmath154 .",
    "the two functions display significantly different slopes , with @xmath85 and @xmath155 for isolated and grouped galaxies at @xmath5 , and with @xmath156 and @xmath157 at @xmath154 .",
    "the ratio between the two slopes at these two redshifts is virtually the same , @xmath1580.7 . at @xmath2=3 (",
    "not shown ) , the difference between the slopes of the velocity functions is even larger : @xmath159 and @xmath160 respectively , a ratio @xmath1580.45 .",
    "it is worth mentioning that the fraction of grouped halos ( according to the @xmath161 criterion of ) decreases from 40% at @xmath5 and @xmath162 to 30% at @xmath163 .",
    "in general , the velocity functions are well fit by power laws .",
    "the exception is the velocity function of grouped galaxies at @xmath2=1.35 , which drops more steeply at @xmath164 .",
    "this is an artifact of our imposed strict upper bound on galactic - halo masses at @xmath151 , which translates into a smoother drop in velocity due to the scatter in the mass - velocity relation (  [ sec : velf ] ) .",
    "the corresponding drop at @xmath5 is pushed to higher velocities . in the real universe",
    "we may expect galactic halos more massive than @xmath151 , and therefore the drop may be unphysical and should be ignored in the power - law fit .",
    "the predicted difference between the slopes of the velocity functions of isolated and grouped galactic halos reflects the  biasing \" tendency for large halos to be more clustered ; high - mass , high - velocity halos are more likely to have companions and to exist in groups than their low - mass , low - velocity counterparts .",
    "this relation carries over to luminous galaxies , if we assume that every halo that obeys our simple mass criterion hosts a galaxy .",
    "the predicted slope difference between groups and the field should be observable , both at low and high redshifts .",
    "we have studied the distributions of mass and maximum circular velocity of dm halos in a cosmological simulation of the @xmath0cdm model .",
    "the mass function is useful for semi - analytic modeling of galaxy formation , while the velocity function can be confronted with observations once a relation between halo velocity and disk rotation velocity is assumed .",
    "the high resolution allows us to address distinct halos as well as subhalos , at a range of redshifts , and to distinguish between field and grouped galactic halos .",
    "we find that the schechter function , and in particular its power - law behavior over a wide range below the characteristic mass @xmath50 , is a good fit to the different halo distributions of mass and velocity , over the whole range studied in this simulation , and at all times monitored .",
    "this is once the incompleteness of the halo finder at small halos and the associated errors are properly accounted for .",
    "each of these distribution functions is therefore characterized by a slope and an amplitude .",
    "the characteristic large scale where the function bends is not constrained properly because we do not sample enough large halos . at the low end ,",
    "we do not attempt to recover the velocity function below @xmath165 , and therefore can not address possible deviations from a power - law at low velocities ( klypin 1999b ; moore 1999 ) . at @xmath5 , for distinct halos , we find mass and velocity function slopes of @xmath166 and @xmath167 in and respectively .",
    "we measure the time evolution of the mass and velocity functions via the redshift dependence of the slope and amplitude parameters .",
    "the @xmath2 dependences are described for convenience by simple functional fits out to @xmath109 [ figures  [ fig : massf_redshift ] and [ fig : velf_redshift ] ] , to be used in semi - analytic models of galaxy formation .",
    "the slope of the velocity function for distinct halos steepens with redshift like @xmath168 , where @xmath169 .",
    "a particular prediction that should be tested observationally is that the amplitude of the velocity function at fixed @xmath170 hardly varies with redshift , for all types of halos .",
    "this implies that the number density of halos with @xmath171 and below is actually predicted to _ increase _ slightly with increasing redshift , as opposed to the naive expectation based on the way the mass function evolves .",
    "this prediction for the weak evolution of the velocity function can also be tested indirectly .",
    "for example , by combining this result with the observed evolution of the luminosity function of spiral galaxies , one can deduce the way the tully - fisher relation might evolve with redshift ( cf .",
    "gonzalez et al .",
    "2000 ; bullock 2000b ) . to make this connection between the luminosity function and the velocity function using the tully - fisher relation",
    ", it will also be necessary to take into account the effects of baryonic infall .",
    "but this is important , since an inconsistency between this prediction and direct observations of tully - fisher evolution may question the validity of the @xmath0cdm model .    most earlier cosmological simulations , and analytic approximations such as press - schechter , overlook substructure within halos , which is bound to play an important role in galaxy formation .",
    "our simulations and halo finder enable a study of the hierarchical halo population within a cosmological volume .",
    "we find that the subhalo distributions can also be fitted by power laws , though the errors are larger because there is an order of magnitude fewer subhalos than distinct halos . at redshifts of order 2 and beyond",
    ", we find that the subhalo population evolves differently from the distinct halo population .",
    "while the slope of the distinct - halo functions becomes steeper with increasing redshift , the slope of the subhalo becomes flatter at higher redshifts . on the other hand ,",
    "the amplitudes of the subhalo and distinct - halo functions decrease with increasing redshift in a similar way .",
    "several other simulations were used to study the evolution of substructure within individual clusters of galaxies ( , ghigna 1998 , van den bosch 1999 , sensui 2000 , okamoto & habe 1999 ) .",
    "the results of okamoto & habe ( 1999 ) , in particular , are quite similar to what we find .",
    "they see very little evolution of the subhalo mass function in the range @xmath172 , with a power - law slope @xmath173 . this similarity is despite the fact that they concentrate on a constrained realization of a 3-@xmath174 density peak within an @xmath175 scdm model and their mass range is quite different .    for the purpose of semi - analytic modeling of galaxy formation",
    ", we also considered the substructure as a function of host - halo mass .",
    "we find that except for the natural  normalization \" trend ( that more massive halos harbor a larger number of subhalos , see the study of the multiplicity function in kolatt 2000 ) , there is only little evolution in the subhalo mass function for any given host - halo masses .",
    "these conditional mass functions can serve to improve the semi - analytical recipes for placing galaxies in simulated dm halos .",
    "our derived velocity function for distinct halos agrees with the preliminary independent analysis of the same simulation by gottlber ( 1998 ) .",
    "we improve on the preliminary analysis by correcting for small - mass incompleteness , placing meaningful error bars on the fit parameters , following the velocity function with higher time resolution and for a longer history ( up to @xmath2=5 ) , and , in particular , extending our investigation to subhalos , and studying environmental dependence .",
    "the derived velocity function for halos identified as galactic halos , which is similar to that of distinct halos , is also in good agreement with klypin ( 1999b ) , who identified galaxies in the same simulation , as well as in a simulation of higher resolution , complete down to @xmath176 .",
    "they used a different halo finder and assigned circular velocities in a different way .",
    "they report a velocity - function slope which corresponds to @xmath177 and @xmath178 , in good agreement with our values for distinct halos .",
    "this agreement is encouraging evidence for the robustness of our results .",
    "one of our most interesting predictions to be tested observationally is that galactic halos in groups should have a significantly flatter velocity function than more isolated galactic halos .",
    "the implication is that galactic halos at the high velocity end should show a stronger tendency to reside in denser environments .",
    "a detailed comparison to observations must incorporate the relation between the halo velocity and that of the luminous galaxy , which we crudely assumed here to be identical .",
    "white , tully & davis ( 1988 ) and mo & lahav ( 1993 ) already found hints for a correlation between galaxy velocity and local galaxy density , which seem to be qualitatively consistent with our predicted trend .",
    "however , a proper quantitative comparison is yet to be done , treating effects of incompleteness as a function of velocity , and considering in particular the _ slope _ of the velocity function as a function of the environment .",
    "this comparison should be done with larger , more complete datasets , both at low and high redshifts .",
    "high resolution n - body simulations accompanied by simple schemes for galaxy identification can thus provide a powerful tool for investigating galaxy formation , especially those aspects of the problem that are not yet properly addressed by semi - analytic modeling or by full hydro simulations .",
    "future simulations of larger volumes , which will include more massive halos of cluster size , will permit better constraints on @xmath50 .",
    "better statistics will also mean a more accurate evaluation of the subhalo mass and velocity functions , especially the conditional mass function , which could give us a better handle on the relation between host halos and their internal substructure .    as a by product , our results can serve to evaluate analytic approximations of the mass function in the clustering process . at low redshift , we confirm earlier findings that the press - schechter approximation overestimates the true mass function by a factor of two at low masses , and underestimates it at high masses .",
    "this is in good agreement with gross ( 1998 ) and gross ( 1997 ) , and in qualitative agreement with somerville ( 2000 ) and lee & shandarin ( 1999 ) .",
    "this agreement between the simulations , using a variety of halo - finding algorithms , provides an additional confirmation for the robustness of our in finding distinct halos .",
    "the latter differ somewhat in the value of the mass where the ps approximation coincides with the true mass function , probably due to the different cosmologies they investigated ( @xmath179 scdm and @xmath180cdm ) . we find that the approximations of ps as well as st and ls overestimate the normalization of the mass function at @xmath181 and underestimate the slope at @xmath182 , but the discrepancies between the simulation and the st and ls predictions are much smaller than the deviations of the ps formalism .",
    "all three approximations predict a higher rate of evolution for the mass function than seen in the simulations .",
    "the simulations were performed at nrl and ncsa . this work was supported by grants from the israel science foundation at hu , the us - israel binational science foundation at hu and ucsc , and nasa and nsf at ucsc and nmsu .",
    "jsb was supported by nasa lst grant nag5 - 3525 and nsf grant ast-9802568 at osu .",
    "jrp gratefully acknowledges a forchheimer visiting professorship at hu .",
    "support to avk was provided by nasa through hubble fellowship grant hf-01121.01 - 99a from the space telescope science institute , which is operated by the association of universities for research in astronomy , inc .",
    ", under nasa contract nas5 - 26555 .",
    "gottlber , s. , klypin , a. a. , & kravtsov , a. v. 1999 , in _",
    "`` observational cosmology : the development of galaxy systems '' _ , ed .",
    "g. giuricin , m. mezzetti , & p. salucci ( asp conf .",
    "series ) , 418 ( astro - ph/9810445 )"
  ],
  "abstract_text": [
    "<S> we study the distribution functions of mass and circular velocity for dark matter halos in n - body simulations of the @xmath0cdm cosmology , addressing redshift and environmental dependence . </S>",
    "<S> the dynamical range enables us to resolve subhalos and distinguish them from  distinct \" halos . </S>",
    "<S> the mass function is compared to analytic models , and is used to derive the more observationally relevant circular velocity function . </S>",
    "<S> the distribution functions in the velocity range 100500@xmath1 are well fit by a power - law with two parameters , slope and amplitude . </S>",
    "<S> we present the parameter dependence on redshift and provide useful fitting formulae . </S>",
    "<S> the amplitudes of the mass functions decrease with @xmath2 , but , contrary to naive expectation , the comoving density of halos of a fixed velocity @xmath3 actually increases out to @xmath4 . </S>",
    "<S> this is because high-@xmath2 halos are denser , so a fixed velocity corresponds to a smaller mass . </S>",
    "<S> the slope of the velocity function at @xmath5 is as steep as @xmath6 , and the mass and velocity functions of distinct halos steepen with increasing @xmath2 , while the functions of subhalos do not steepen with @xmath2 , and become even flatter at @xmath7 . </S>",
    "<S> a simple observable prediction is that the slope of the velocity function of isolated galaxies is steeper than that of galaxies in groups by as much as unity , reflecting the density biasing of high - velocity halos . </S>",
    "<S> we confirm that the press - schechter approximation typically overestimates the halo mass function by a factor of @xmath8 , while modified approximations provide improved predictions .    </S>",
    "<S> # 1([eq:#1 ] ) # 1equation  ( [ eq:#1 ] ) # 1eq .  </S>",
    "<S> [ [ eq:#1 ] ] # 1[sec:#1 ] # 1figure  [ fig:#1 ] # 1fig .  </S>",
    "<S> [ fig:#1 ] # 1figure  [ fig:#1 ]     +    # 1#1 # 1#1    # 1#1@xmath9    # 10= -.025em0 - 0 .05em0 - 0 -.025em.0433em0 0 </S>"
  ]
}