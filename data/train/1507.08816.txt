{
  "article_text": [
    "unparametrized curves arise naturally in shape analysis and its many applications , including medical imaging @xcite , object tracking @xcite , computer animation @xcite , computer aided design @xcite , speech recognition @xcite , analysis of bird migration patterns and hurricane paths @xcite , biology @xcite , and many other fields @xcite . in many instances ,",
    "the rationale for identifying curves differing only by a reparametrization is that the curves represent the boundaries of physical shapes .",
    "shapes can be analyzed mathematically by endowing the space of shapes with a riemannian metric .",
    "riemannian shape analysis has developed into an active field of research by now .",
    "to do statistics on shape space , robust and efficient implementations of the boundary and initial value problems for geodesics are needed .",
    "unfortunately , the arguably simplest metric on shape space is degenerate : it is well - known that the riemannian distance induced by the @xmath0-metric vanishes on spaces of parametrized and unparametrized curves @xcite . the discovery of this degeneracy led to an investigation of sobolev metrics of higher order @xcite .    for the important class of first order metrics numerics",
    "are well developed by now , but a restriction on the parameters of the metric must be imposed @xcite .",
    "the situation is drastically different for second order metrics , despite the fact that they enjoy better completeness properties @xcite . on the positive side ,",
    "the geodesic boundary value problem under second order finsler metrics on the space of @xmath1 curves was implemented numerically in @xcite . moreover , on the space of parametrized curves , there are numerics for the boundary and initial value problems for geodesics under second order sobolev metrics @xcite . on spaces of unparametrized curves numerics for second order sobolev metrics",
    "are , however , still lacking .",
    "this is an important challenge and the topic of this paper .",
    "we present a numerical implementation of the initial and boundary value problem for geodesics of planar , unparametrized curves under second order sobolev metrics .",
    "our implementation is based on a discretization of the riemannian energy functional using b - splines . the boundary value problem for geodesics",
    "is solved by a gradient descent on the set of discretized paths and the initial value problem by discrete geodesic calculus @xcite .",
    "our approach is general in that it involves no restriction on the parameters of the metric and allows to factor out rigid transformations .",
    "we tested our implementation on a dataset of shapes representing various groups of similar physical objects @xcite .",
    "we were able to reconstruct the groups using agglomerative clustering based on the matrix of pairwise geodesic distances between the shapes .",
    "we also studied within - group shape variations by performing nonlinear principal component analysis using the karcher means of the groups as base points .",
    "we visualized the results by solving the geodesic equation forward and backward in time along the principal directions .",
    "our algorithms performed well on the shapes in the database .",
    "some care was needed to avoid singularities in the spline representations of the contours extracted from the binary images and of the paths initializing the gradient descent of the energy functional .    in future work",
    ", our framework could be applied to other spaces of mappings like manifold - valued curves , embedded surfaces , or more general spaces of immersions ( see @xcite for details and @xcite for a general overview ) .",
    "a rigorous convergence analysis of the proposed discretization remains to be done .",
    "we extend the exposition of @xcite to unparametrized curves .",
    "the space of smooth , regular , parametrized curves is defined as @xmath2 where @xmath3 stands for _ immersion_. @xmath4 is an open subset of the frchet space @xmath5 and as such itself a frchet manifold .",
    "the tangent space @xmath6 at any curve @xmath7 is the vector space @xmath5 .",
    "geometrically , tangent vectors at @xmath7 are @xmath8-valued vector fields along @xmath7 .",
    "we denote the euclidean inner product on @xmath9 by @xmath10 .",
    "moreover , for any fixed curve @xmath7 , we denote differentiation and integration with respect to arc length by @xmath11 and @xmath12 , respectively .",
    "[ def : sobolev_metric ] second order sobolev metrics on @xmath13 are riemannian metrics of the form @xmath14 where @xmath15 , @xmath16 are constants and @xmath17 tangent vectors .    in the definition of sobolev metrics , there is freedom in the choice of the relative weighting of the @xmath0- , @xmath18- and @xmath19-parts .",
    "this choice influences the geometry of the space of curves and should , in each application , be informed by the data at hand .",
    "the reparametrization group is the diffeomorphism group of the circle , @xmath20 which is an infinite - dimensional regular frchet lie group @xcite .",
    "reparametrizations act on curves by composition from the right , @xmath21 .",
    "the shape space of unparametrized curves is the orbit space @xmath22 of this group action . , where @xmath23 is the subset of free immersions , i.e. , those upon which @xmath24 acts freely .",
    "this is an open and dense subset of @xmath4 . while important for theoretical reasons , this restriction has no influence on the practical applications of sobolev metrics . ]",
    "[ thm : shape_space ] the space @xmath25 is a frchet manifold and the base space of the principal fibre bundle @xmath26 with structure group @xmath24 .",
    "a sobolev metric @xmath27 on @xmath4 induces a metric on @xmath25 , such that the projection @xmath28 is a riemannian submersion .",
    "[ thm : shape_space ] hinges on the invariance of sobolev metrics with respect to reparametrizations .",
    "sobolev metrics are also invariant with respect to translations and rotations , but in general not to scalings .",
    "the lack of scale invariance can be addressed by introducing weights depending on the length @xmath29 of the curve @xmath7 as follows : @xmath30    deformations of curves are smooth paths @xmath31\\to\\on{imm}(s^1,\\mathbb r^d)$ ] .",
    "their velocity is @xmath32 , the subscript @xmath33 denoting differentiation .",
    "the length of a path @xmath7 is @xmath34 the distance between two shapes @xmath35 and @xmath36 in @xmath25 with respect to the metric induced by @xmath27 is the infimum over all paths between @xmath37 and the orbit @xmath38 , i.e. , @xmath39 geodesics on @xmath4 are critical points of the energy functional @xmath40 the spaces @xmath25 and @xmath4 are related by a riemannian submersion and geodesics on @xmath25 can be lifted to horizontal geodesics on @xmath4 .",
    "conversely , the projection of a length - minimizing path between @xmath37 and @xmath41 is a geodesic on @xmath25 .    the space @xmath25 equipped with a sobolev metric possesses some nice completeness properties , which are summarized in the following theorem .",
    "let @xmath15 and @xmath16 .",
    "then , given two curves @xmath42 in the same connected component of @xmath4 , there exists a minimizing geodesic connecting them .",
    "furthermore , there exists a minimizing geodesic connecting the shapes @xmath35 and @xmath36 in @xmath25 .",
    "closely related to the sobolev metrics described here is the family of elastic metrics @xcite , which in the planar case is given by @xmath43 here @xmath44 are constants and @xmath45 denote the unit tangent and normal vectors to @xmath7 .",
    "two special cases deserve to be highlighted : for @xmath46 , @xmath47 @xcite and @xmath48 @xcite there exist nonlinear transforms , the square root velocity transform and the basic mapping , that greatly simplify the numerical computation of geodesics .",
    "both of these metrics have been applied to a variety of problems in shape analysis .",
    "we note that the elastic metric with @xmath48 corresponds to a first order sobolev metric as in def .",
    "[ def : sobolev_metric ] with @xmath49 and @xmath50 .",
    "as it has no @xmath0-part , it is a riemannian metric only on the space of curves modulo translations .",
    "we discretize curves using b - splines ; @xmath51 , where @xmath52 are the b - splines of degree @xmath53 , defined on a uniform periodic knot sequence , with all knots of multiplicity one .",
    "observe that @xmath54)$ ] .",
    "a path of curves can then be represented using tensor product b - splines , i.e. , @xmath55 here @xmath56 are the b - splines defined on the interval @xmath57 $ ] , with uniform knots and full multiplicity at the end points , @xmath58)$ ] .",
    "this implies that the boundary curves are given by @xmath59 and @xmath60 .    under the identification of @xmath61 with",
    "@xmath62 $ ] , diffeomorphisms @xmath63 can be written as @xmath64 , where @xmath65 is a periodic function .",
    "we choose to discretize @xmath66 , where @xmath67 are b - splines of degree @xmath68 , defined on a uniform periodic knot sequence , similarly to @xmath52 .",
    "the identity can be written in a b - spline basis using the _ greville abscissas _ @xmath69 , i.e. , @xmath70 . due to the positivity of b - splines ,",
    "the condition @xmath71 ensuring that @xmath72 is a diffeomorphism takes the form @xmath73 to speed up convergence , we introduce an additional variable @xmath74 representing constant shifts of the reparametrization .",
    "the resulting redundancy is eliminated by the constraint @xmath75 to compute the energy of paths , we use gaussian quadrature on each interval between subsequent knots .",
    "evaluating paths ( and their derivatives ) at the quadrature points is a simple multiplication of the spline collocation matrix with the vector of control points .      from now on we work with plane curves ( @xmath76 ) .",
    "the boundary value problem for geodesics consists of minimizing the discretized energy over all paths @xmath77 \\times [ 0,2\\pi ] \\to \\mathbb{r}^2 $ ] , mappings @xmath78 , shifts of the reparametrization @xmath74 , and rotations @xmath79 around the origin by an angle @xmath80 , subject to the constraints , , and @xmath81 where @xmath82 \\to \\mathbb{r}^2 $ ] are given boundary curves .",
    "this is a finite dimensional constrained optimization problem , which we solve using matlab s interior point method ` fmincon ` .",
    "we achieved major performance improvements by fine - tuning the implementations of the gradient and hessian of the energy functional .    in the initial value problem for geodesics ,",
    "the initial value and initial velocity of the sought geodesic are given .",
    "as described in sect .",
    "[ sec : background ] , geodesics on @xmath25 can be lifted to horizontal geodesics on @xmath4 .",
    "thus , solving the geodesic initial value problem for unparametrized curves reduces to solving the problem for parametrized curves with horizontal initial velocities . to solve the latter problem",
    ", we use the time - discrete variational geodesic calculus of @xcite as described in @xcite .",
    "the karcher mean @xmath83 of a set @xmath84 of curves is defined as the minimizer of @xmath85 it can be computed by iteratively solving initial and boundary value problems for geodesics .",
    "we refer to @xcite for more details .",
    "we tested our implementation on a dataset of shapes collected by the computer vision group at brown university @xcite .",
    "the dataset consists of black and white images of physical objects .",
    "it is natural to represent the objects by their boundaries using unparametrized curves .",
    "in addition to factoring out reparametrizations , we also factor out translations and rotations because we are not interested in the position of the curves in space .",
    "some of the resulting curves are depicted in fig .",
    "[ fig : shapes ] .",
    "we used splines of degree @xmath86 with @xmath87 and @xmath88 controls in space and of degree @xmath89 with @xmath90 controls in time .    to solve the boundary value for geodesics as described in sect .",
    "[ sec : boundary ] , one has to construct an initial homotopy between the given boundary curves .",
    "if the curves differ only by a small deformation , this is unproblematic because the linear path connecting the curves can be used . for larger deformations ,",
    "however , the linear path often has self - intersections , changing the winding number , which can lead to convergence problems during the energy minimization .",
    "our solution was to construct homotopies by deforming the initial curve to a circle and the circle to the target curve using linear paths .",
    "this worked well for all examples presented in this article .",
    "it also led to the same optima in all cases where the linear path was free of self - intersections .",
    "in future work , we plan to investigate further ways of creating good and natural initial paths .",
    "is increased by a factor 10 in the second , a factor 100 in the third , and a factor 1000 in the fourth column .",
    "the corresponding geodesic distances are @xmath91 , @xmath92 , @xmath93 and @xmath94 .",
    "note that since we also optimize over translations and rotations of the target curve , the position in space varies.,title=\"fig : \" ]   is increased by a factor 10 in the second , a factor 100 in the third , and a factor 1000 in the fourth column .",
    "the corresponding geodesic distances are @xmath91 , @xmath92 , @xmath93 and @xmath94 .",
    "note that since we also optimize over translations and rotations of the target curve , the position in space varies.,title=\"fig : \" ]   is increased by a factor 10 in the second , a factor 100 in the third , and a factor 1000 in the fourth column .",
    "the corresponding geodesic distances are @xmath91 , @xmath92 , @xmath93 and @xmath94 .",
    "note that since we also optimize over translations and rotations of the target curve , the position in space varies.,title=\"fig : \" ]   is increased by a factor 10 in the second , a factor 100 in the third , and a factor 1000 in the fourth column .",
    "the corresponding geodesic distances are @xmath91 , @xmath92 , @xmath93 and @xmath94 .",
    "note that since we also optimize over translations and rotations of the target curve , the position in space varies.,title=\"fig : \" ]    the choice of parameters @xmath95 , @xmath96 , and @xmath97 of the riemannian metric can have a large influence on the resulting optimal deformations , as can be seen in fig .",
    "[ fig : geodesicsconstants ] . in this article , we used the following ad - hoc strategy for choosing the constants : we computed the average @xmath0- , @xmath18- and @xmath19-contributions @xmath98 , @xmath99 , @xmath100 to the energy of linear paths between each pair of curves in the dataset .",
    "then we normalized @xmath95 to @xmath101 and chose @xmath96 and @xmath97 such that @xmath102 this resulted in the parameter values @xmath103 and @xmath104 .",
    "it remains open how to best choose the constants depending on the data under consideration .",
    "riemannian metrics on spaces of unparametrized curves are often called elastic metrics , as they allow both for bending and stretching of the curve . in the elastic case ,",
    "solving the boundary value problem for geodesics involves optimizing over the @xmath105-orbit of the initial or final shape .",
    "this is a computationally expensive and difficult task since the diffeomorphism group is infinite - dimensional .",
    "an alternative and simpler approach is to parametrize the curves by unit - speed and to calculate geodesics in the space of parametrized curves .",
    "this could be called a non - elastic approach .",
    "( of course , one might wish to also factor out rigid transformations and constant shifts of the parametrization , but this is much simpler because these groups are finite dimensional . )",
    "our experiments suggest that using the more involved elastic approach pays off .",
    "the two approaches yield different results , and in particular in cases involving large amounts of stretching the geodesics found using the first approach appear more natural . however , in cases involving mainly bending of the curves the results are very similar ( see fig .  [",
    "fig : geodesics ] ) .",
    "we investigated if pairwise geodesic distances can be used to cluster shapes into meaningful groups .",
    "to this aim , we calculated all pairwise distances between the 33 shapes presented in fig .",
    "[ fig : shapes ] . solving the corresponding 528 boundary value problems took about two hours on a 3ghz processor with four cores .",
    "the resulting distance matrix is visualized in fig .",
    "[ fig : mds ] using multi - dimensional scaling ; the plot suggests that objects of the same group lie close together .",
    "indeed , agglomerative clustering with 4 clusters reproduces exactly the subgroups of the database .    ,",
    "visualized using multi - dimensional scaling in two and three dimensions .",
    "the labels are : fish @xmath106 , sting rays @xmath107 , bunnies @xmath108 , tools @xmath109.,title=\"fig : \" ] , visualized using multi - dimensional scaling in two and three dimensions .",
    "the labels are : fish @xmath106 , sting rays @xmath107 , bunnies @xmath108 , tools @xmath109.,title=\"fig : \" ]    finally , we studied within - group variations using non - linear principal component analysis .",
    "to this aim , we first computed the karcher mean of each group .",
    "the corresponding optimization problem was solved using a conjugate gradient method , as implemented in the manopt library @xcite , on the finite - dimensional spline approximation of the riemannian manifold of curves .",
    "the mean shapes for the groups of fish and humans can be seen in fig .",
    "[ fig : karchermean ] .",
    "next , we represented each shape in the group by the initial velocity from the mean @xmath83 using the inverse of the riemannian exponential map .",
    "we then performed a principal component analysis with respect to the inner product @xmath110 on the set of initial velocities . in the group of human figures ,",
    "the first three eigenvalues capture 67% , 22% , and 6% of within - group variation . in the group of fish ,",
    "the first three eigenvalues capture only 40% , 25% , and 16% of within - group variation .",
    "geodesics from the mean in the directions of the first two principal directions can be seen in fig .",
    "[ fig : karchermean ] . in the group of humans the first principal direction encodes bending of the arms and legs ,",
    "whereas the second direction reflects stretching in the extremities .    ; the bold curve is the mean.,title=\"fig : \" ] ; the bold curve is the mean.,title=\"fig : \" ] ; the bold curve is the mean.,title=\"fig : \" ] + ; the bold curve is the mean.,title=\"fig : \" ] ; the bold curve is the mean.,title=\"fig : \" ] ; the bold curve is the mean.,title=\"fig : \" ]",
    "in this article we developed a numerical framework for solving the initial and boundary value problem for geodesics of planar , unparametrized curves under second order sobolev metrics .",
    "we tested our implementation on a dataset of shapes representing various groups of similar physical objects and obtained good experimental results . in future work",
    ", we plan to apply our algorithms to datasets of real - world medical data , prove rigorous convergence results for the discretization , and extend the framework to other spaces of mappings like manifold - valued curves and embedded surfaces .",
    "we want to thank peter w. michor and jens gravesen for helpful discussions and valuable comments .",
    "all authors have been supported by the programme `` infinite - dimensional riemannian geometry with applications to image matching and shape analysis '' held at the erwin schrdinger institute .",
    "m. bauer was supported by the european research council ( erc ) , within the project 306445 ( isoperimetric inequalities and integral geometry ) and by the fwf - project p24625 ( geometry of shape spaces ) .",
    "j.  su , s.  kurtek , e.  klassen , and a.  srivastava . statistical analysis of trajectories on riemannian manifolds : bird migration , hurricane tracking and video surveillance .",
    "_ , 80 ( 1):0 530552 , 03 2014 .",
    "j.  su , a.  srivastava , f.  de  souza , and s.  sarkar .",
    "rate - invariant analysis of trajectories on riemannian manifolds with application in visual speech recognition . in _",
    "computer vision and pattern recognition ( cvpr ) , 2014 ieee conference on _ , pages 620627 , june 2014 .",
    "g.  sundaramoorthi , a.  mennucci , s.  soatto , and a.  yezzi .",
    "a new geometric metric in the space of curves , and applications to tracking deforming objects by prediction and filtering .",
    "_ siam j. imaging sci .",
    "_ , 40 ( 1):0 109145 , 2011 ."
  ],
  "abstract_text": [
    "<S> second order sobolev metrics on the space of regular unparametrized planar curves have several desirable completeness properties not present in lower order metrics , but numerics are still largely missing . in this paper , we present algorithms to numerically solve the initial and boundary value problems for geodesics . the combination of these algorithms allows to compute karcher means in a riemannian gradient - based optimization scheme . </S>",
    "<S> our framework has the advantage that the constants determining the weights of the zero , first , and second order terms of the metric can be chosen freely . </S>",
    "<S> moreover , due to its generality , it could be applied to more general spaces of mapping . </S>",
    "<S> we demonstrate the effectiveness of our approach by analyzing a collection of shapes representing physical objects . </S>"
  ]
}