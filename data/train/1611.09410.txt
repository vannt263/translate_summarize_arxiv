{
  "article_text": [
    "unexpected diversity of unicellular eucaryots ( nanoplankton ) or hydrothermal sediments has been revealed in 2001 by sequencing ribosomal dna ( 18s ) , using blast for comparison with databases , and establishing molecular phylogenies of these unexplored worlds , @xcite . at the same time ,",
    "unexpected diversity of oceanic picoplankton has been revealed using 18s and phylogenies too @xcite . since then , exploration of microbial diversity , be it in protists , bacteria or archaea by molecular based tools has exploded , and has become a standard for biodiversity assessments .",
    "soon after , hebert and coll . launched the barcoding of life for animals @xcite , which has been quickly extended to other kingdoms ( see e.g. @xcite ) , and to protists @xcite .",
    "the advance of sequencing technologies , especially ngs , producing first hundreds of thousands of reads with pyrosequencing , then millions with ilumina , have paved the way for metagenomics , and metabarcoding for biodiversity or biomonitoring studies ( see e.g. , among many others , @xcite ) . +   + metabarcoding is expected to yield inventories of species diversity similar to those provided by morphological based methods , if molecular and morphological taxonomies agree .",
    "one way for a rigorous verification is by isolating and culturing , and comparing with results of metabarcoding .",
    "@xcite cites a well known case of a bacteria in the mediterranean sea ( _ leeuwenhoekiella blandensis _ ) , which has been isolated and cultivated but never found in repeated molecular inventories on the same spot .",
    "a still more controlled way to estimate the quality of the information given by metabarcoding is to build artificial samples in the laboratory , and run the metabarcoding protocol on these laboratory - assembled communities ( see @xcite for nematodes , @xcite for diatoms ) , or in silico experiments ( see e.g. @xcite ) .",
    "+   + a second way to estimate this quality , on which we will focus here , is by comparing morphological based inventories with molecular based inventories on same natural communities .",
    "such an approach has been used for alveolates in a freshwater lake @xcite , tintinnids ( ciliates , microzooplankton ) @xcite , arthropods and birds @xcite , seegrass communities @xcite , freshwater diatoms @xcite , the latter insisting on the need to derive tools for assigning a taxon name to a sequence ( what will be referred to in the sequel as taxonomic assignment ) , and estuarine plankton @xcite , where completing the reference database was found to settle most of inconsistencies between both approaches in zooplankton .",
    "such an approach permits to study a still open question : how reliable is metabarcoding for inventorying or unveiling rare species",
    "? how to estimate the so called _ rare biosphere _",
    "@xcite ? but see @xcite .",
    "+   + we develop here a data analysis framework without any heuristics , doing exact computations using high performance computing techniques , in order to produce as accurate as possible molecular based inventories , quantify the comparison between morphological based and molecular based inventories , facilitate the localization of major sources of errors , and propose some priorities to fix them .",
    "+   + discrepancies in comparing a morphological based and a molecular based inventory on the same sample can have three origins : @xmath0 inappropriate morphological based inventory @xmath1 inappropriate molecular based inventory @xmath2 both inventories are correct but do not give the same information ( differences in species delineation between molecular phylogenies and morphological based identification , for example ) .",
    "the latter is crucial , and deserves further research . as an example",
    ", accurate comparison between molecular and morphological taxa delineation in angiosperms has been shaped over many decades through collaboration between many teams ( see @xcite in 2009 , after apg in 1998 and apgii in 2003 ) .",
    "such a comparison remains crucial , as a benchmark for ongoing characterization of currently unseen biodiversity in eukaryotic communities .",
    "here , we develop a tool , named ` diagno - syst ` , for having an as accurate as possible molecular based inventory , relying on high performance computing for handling massive data , without any heuristics to speed up calculation process .",
    "we focus on best possible quality for molecular based inventories , assuming that morphological based inventories are correctly evaluated ( i.e. we will not discuss here morphological based taxonomy of diatoms ) .",
    "+   + one of the requirements for metabarcoding is selecting markers which are , as much as possible , universal , resolutive , and technologically easy to work with .",
    "most of this work is inherited from barcoding . a synthesis paper on marker choice for eukaryotes from cbol protist working group is @xcite . in the remaining of this paper ,",
    "we assume that a marker has been selected . knowing that , several sources of errors have been recognized in metabarcoding data analysis ( see @xcite and references therein ) .",
    "there exists several studies or reviews ( see e.g. @xcite ) which focus on well known pitfalls and caveats of molecular approaches , but very few on the pitfalls and caveats when using heuristics instead of exact computations because of the size of data sets .",
    "we focus here on isolating bioinformatics challenges from biological challenges , by running exact calculation for sequence comparisons , without any heuristics .",
    "+   + a molecular based inventory is built on sequence comparisons between a set of queries and a reference database , often on amplicons . such a comparison can be made exactly by needleman - wunsch algorithm @xcite for global alignment or smith - waterman algorithm @xcite for local alignment .",
    "these algorithms are well understood and exact @xcite .",
    "they work well on small size data sets as those produced by sanger technologies .",
    "however , they are quadratic in time as scaling with the number of queries @xmath3 the number of references .",
    "blast @xcite is a well established tool for exploring quickly a huge database of references .",
    "we have the opposite in metabarcoding communities of a given group of organisms : the reference database is often of reasonable size ( a few thousands specimen ) , whereas the number of queries to match becomes huge ( about @xmath4 or even @xmath5 ) .",
    "moreover , it is known that blast can produce bad results @xcite .",
    "therefore , as in @xcite , we developed specific assignation tools based on local alignment ( here , smith - waterman score ) . as being exact",
    "is paid by a heavier computation load , we have exploited the fact that this algorithm belongs to the category of massively parallel problem : the @xmath4 or @xmath5 local alignments of each query with all specimen in the reference database are all independent , and can be run in parallel on different cores of a computer .",
    "hence , we have opted for a massively parallel implementation of exact local alignment , which answers exactly to the raised question of sequence comparison between a reference database and a set of queries .",
    "we have worked on inventories of diatom communities , as diatom species can be identified both optically ( by looking at the frustule ) , and molecularly ( many reference sequences for diatom barcodes are available ) .",
    "this enables to test the quality of the dictionary between both approaches .",
    "+   + the starting point for data analysis is a set of several sets : each sample is given as a set of sequences ( the reads ) , and we have a set of samples .",
    "we have one reference database , r - syst::diatoms @xcite , which will be used for all environmental samples .",
    "the reference database is given as a set of @xmath6 specimens .",
    "for each specimen , we have a sequence identifier ( a code ) , a sequence ( of the same marker with the same primers ) , and a hierarchical list of names , naming order , family , genus and species .",
    "we have a set of 10 environmental samples from lman lake , and a second set of 20 environmental samples from swedish rivers . for each environmental sample",
    ", we have an optic inventory , made by a trained diatomist , and a set of reads , which are produced after amplification of a given marker with given primers .",
    "an optical inventory has been produced for each environmental sample by counting about 400 diatom valves in a microscope and identifying them via standard diatom literature using cen ( european standardization committee ) methods @xcite .",
    "two datasets were analyzed : one from lman lake , and one from sweden .",
    "the lman lake dataset contains one site sampled at ten different dates ( about one month between two sampling campaigns ) .",
    "the swedish dataset contains data of 13 streams and one lake distributed over the whole country , six of the streams sampled in two subsequent years .",
    "the streams covered different ecological regions and stream types , including lowland agricultural streams common also in central europe , small boreal streams and mountain streams with no forest cover in the catchment . in this way",
    ", we could test if the reference data base of diatoms developed to match lman lake communities can be used also for other regions of the world .",
    "we expected more problems when using it for swedish data .",
    "the taxonomic names selected in this study are those selected in thonon reference database , ` r - syst::diatoms ` , which has been built first at thonon ( thonon culture collection , tcc , see ` www.inra.fr/carrtel-collection ` ) , and complemented by careful curation of freshwater diatom sequences in ncbi @xcite .",
    "the privileged taxonomic level is the species level .",
    "names in the reference database are as much as possible accepted authored names . however , in several circumstances , a discrepancy between molecular based species delineation by phylogenies and morphological based species delineation have been acknowledged .",
    "in such a case , a compromise has been made ( e.g. _ fragilaria group _ ) in order to have the best agreement between morphological based and molecular based taxonomic identification of specimen in the reference database .",
    "it is not the purpose of this paper to discuss diatom systematics , and the current state of the art , even if acknowledged as perfectible , is taken for granted and accepted .",
    "any accepted evolution or change in diatom s systematics can be taken into account in a further step just by changing the accepted names .",
    "taxa in this study should be considered as operational taxonomic units as close as possible to species level and accepted species names , knowing that some discrepancies still exist in the current state of the art . for sake of simplicity",
    ", they will be referred to as _ species _ in the sequel of this paper .",
    "[ [ marker - choice ] ] marker choice : + + + + + + + + + + + + + +    before the bloom of barcoding , molecular taxonomy of plankton has been studied using 18s as a marker . over the subsequent years",
    ", several hypervariable regions of 18s have been progressively selected in scientific community to study plankton , and more generally protists , i.e. unicellular eukaryots ( see @xcite ) .",
    "a second criteria for a marker choice is the availability of a well curated database .",
    "pr@xmath7 ( see @xcite and ` http://ssu-rrna.org/ ` ) has been designed specifically for marine plankton . @xcite",
    "have compared rbcl , 18s and co1 for freshwater diatoms , the three of them being acknowledged as potential barcodes for diatoms , making a balance between resolution and richness of existing database .",
    "they have shown that rbcl was more resolutive than 18s , and that public information was available for both of them .",
    "hence , a choice has been made to work with rbcl , and to complete the existing database .",
    "subsequently , an inner marker has been selected , of 312 bp long to comply with technological requirements of ngs sequencing facilities , which could not provide @xmath8 long reads as sanger technology could . for amplifying this region ,",
    "the primer pair ` diat_rbcl_708f ` @xcite and ` r3 ` @xcite was used directly for samples from lman lake , and was modified for the swedish samples as follow : forward primer combine an equimolar mix of ` diat_rbcl_708f_1 ` ( aggtgaagtaaaaggttcwtacttaaa ) , ` diat_rbcl_708f_2 ` ( aggtgaagttaaaggttcwtayttaaa ) and ` diat_rbcl_708f_3 ` ( aggtgaaactaaaggttcwtacttaaa ) ; reverse primer combine an equimolar mix of ` r3_1 ` ( ccttctaatttaccwacwactg ) and ` r3_2 ` ( ccttctaatttaccwacaacag ) .",
    "the resolution of the selected short barcode has been checked , and the drop from full rbcl fragment , even if noticeable , was found to be non significant .",
    "for each set of samples ( lman lake and swedish rivers ) , the work has been processed along a sequence of three steps    * have an optical based inventory * build a molecular based inventory * identify and classify mismatches between both .",
    "methods for each of these steps are given in what follows , with a focus on molecular based inventories and classification of mismatches .",
    "+   + let us note that an output of a proton sequencer for an environmental sample typically counts about @xmath4 reads , of @xmath9 long each . here , instead of using heuristics to speed up the analysis , we have kept on the choice to use exact algorithm , which scale linearly with the number of reads .",
    "we have designed as well automatic procedures to handle a large number of environmental samples , i.e. data flows between different steps in calculation .",
    "therefore , we have used a high performance computing center for intensive computing ( idris , see ` http://www.idris.fr/eng/ ` ) , and irods as a file manager for managing data flows .      the algorithms used for taxonomic annotation of queries knowing a reference database ( supervised clustering ) are given here .",
    "the motivations for such a choice , i.e. the notion of informative read and sliding barcoding gap , which distinguish these algorithms from , say , those encapsulated in mothur , are presented in the discussion section ( section [ subsec : inventories ] ) .",
    "[ [ notations ] ] notations : + + + + + + + + + +    let us give some notations .",
    "the set of references is denoted @xmath10 .",
    "each reference is a 312bp long sequence , with little variations in length , with an identifier , and a taxonomic annotation ( species , genus , family ) .",
    "there is a set of queries per environmental sample @xmath11 , denoted @xmath12 .",
    "each query is a 312bp long sequence , with some variatons in length , with an identifier .",
    "the number of references is denoted @xmath13 , and the number of queries in sample @xmath11 is denoted @xmath14 .",
    "we have for this study @xmath15 .",
    "the barcode gap is denoted @xmath16 , and maximum barcode gap @xmath17 .",
    "[ [ distance - between - sequences ] ] distance between sequences : + + + + + + + + + + + + + + + + + + + + + + + + + + +    we have implemented in c the smith - waterman algorithm @xcite producing a score of local alignment between two sequences .",
    "let @xmath18 be a pair query @xmath3 reference .",
    "let @xmath19 be the smith - waterman score between the query and the reference .",
    "then @xmath19 is the highest sore of global alignment between a substring @xmath20 and a substring @xmath21 over all pairs @xmath22 ( see @xcite ) .",
    "selected costs are @xmath23 for a match , and @xmath24 for a gap ( for one base ) or a substitution .",
    "this can easily be extended to more diverse evolution models .",
    "the score has been translated into a distance as follows : let @xmath25 be the length of the query , @xmath26 be the length of the reference .",
    "then @xmath27 the program computing @xmath28 from @xmath29 and @xmath30 as inputs is called ` disseq ` .",
    "[ [ step-1 ] ] step 1 : + + + + + + +    step 1 is to compute @xmath28 for any pair @xmath31 .",
    "this has been done by a double loop .",
    "this is the intensive part of the computation .",
    "it has been run both on babel and turing .",
    "babel is a bluegene p ( ibm ) located at idris in saclay .",
    "it offers massive parallelization , fully adapted to the computation of large matrices of pairwise distances .",
    "its characteristics are : 40,960 cores powerpc 450 , 20 to of memory , 139 tflop / s peak power , and 800 to of memory on disks .",
    "turing is a bluegene q ( ibm ) located at idris too .",
    "its architecture is made of 6 racks , of 1024 nodes each , and 16 cores per node , hence 98 304 cores .",
    "we have used turing with up to @xmath32 cores ( one rack ) .",
    "its peak power is 1,258 pflop / s .",
    "their main advantage ( apart from massive parallelization ) is a low energy consumption : 300 kw , at a cost of lower frequency in cores , but larger number of cores .",
    "such an architecture is particularly suitable for massive embarassingly parallel jobs .",
    "the loop for computing all pairwise distances has been run with message passing interface ( mpi ) programming , by a dedicated program called ` mpi - disseq ` , written in c and mpi for this purpose .",
    "the program has been tested first on avakas ( msocentre de calcul intensif aquitain , 264 computing nodes , 12 cotes each ) and then ported to babel and turing .",
    "the program scales perfectly .",
    "[ [ step-2 ] ] step 2 : + + + + + + +    a barcoding gap @xmath16 being selected , step 2 is to derive the neighborhood of any query @xmath33 as the set @xmath34 of all sequences in @xmath10 such that @xmath35 @xmath36    [ [ step-3 ] ] step 3 : + + + + + + +    this step is assigning a name , or not , to a query , knowing its neighborhood in @xmath10 .",
    "a query @xmath29 is called _ informative _ if all the references @xmath37 belong to the same taxon .",
    "a query can be informative for the genus , but not for the species .",
    "hence , a small program has been written ( in python ) which implements the following procedure : +   +    * input : * @xmath38 * input * @xmath39 get @xmath40 ` tax_annot ` @xmath41 ` unknown ` @xmath42 list of taxa in @xmath40 @xmath43 number of taxa in @xmath44 ` tax_annot ` @xmath41 the unique taxon in @xmath44 ` tax_annot ` @xmath41 ` ambiguous ` ` tax_annot `    then , procedure ` tax_annot = informative(q,\\alpha ) ` has three possible outcomes :    * ` unknown ` if the query is too far from the reference database * ` ambiguous ` if there are several references in the neighborhood of @xmath29 , but of different taxa * ` a taxon ` if all the references in the neighborhood of @xmath29 belong to the same taxon    [ [ step-4 ] ] step 4 : + + + + + + +    programme ` informative ` is run as a loop over all reads @xmath45 .",
    "for @xmath46 queries , it takes less than 30 seconds in python on an standerd laptop with linux ubuntu .",
    "if there are @xmath6 queries , this gives a vector of strings @xmath47 of length @xmath6 .",
    "step 4 simply is to produce a table which counts the number @xmath48 of occurrences of item @xmath11 ( where @xmath11 can be ` unknown ` , ` ambiguous ` or any taxon for which at least a read is informative ) .",
    "this step is called ` diagno_syst(tax_annot ) ` .",
    "[ [ step-5 ] ] step 5 : + + + + + + +    step 4 is run for any barconding gap @xmath49 .",
    "steps 3 , 4 and 5 have been associated into a single program called ` diagno_syst_loop ` , and reads +   +    * input : * @xmath50 * input * @xmath17 @xmath51 $ ] @xmath52 \\leftarrow \\texttt{informative}(q,\\alpha)$ ] @xmath53 @xmath54 $ ]    [ [ notes ] ] notes : + + + + + +    first , we have not looked at an optimization of calculation time here , but have focused on exact calculation .",
    "for example , @xcite have proposed cudasw++ , an optimization of sw algorithm for or cuda - enabled gpus .",
    "see for example @xcite for recent background .",
    "second , we have filtered the set @xmath50 by keeping queries with a length @xmath55 , as we wish a high homology between the query and some references .",
    "about one half of the queries only have been kept with this filter for each environmental sample .",
    "third , in the discussion section , we will compare the inventories produced this way with inventories produced with mothur @xcite .      detecting and quantifying eventual problems",
    "was done by directly comparing the abundance of taxa in the molecular inventory and the optical inventory .",
    "abundances were divided into low abundance and high abundance .",
    "low abundance in the optical inventories was defined as @xmath56 relative abundance of a taxon , high abundance was @xmath57 . in the molecular inventories ,",
    "low abundance was defined as a low number of amplicon reads @xmath58 , high abundance then was defined as @xmath59 reads .",
    "comparison was then done between the abundance of a taxon in the optical inventory and the abundance of reads for each barcoding gap .",
    "hence , each taxon encountered in at least one of the inventories has been allocated a category per inventory    * @xmath60 : absent * @xmath61 : low abundance * @xmath62 : high abundance .    for example , a taxon absent in optics and present in low abundance in molecular inventories will be tagged @xmath63 . in an ideal case",
    ", both the list of species and their abundance would match exactly between both methods ( only @xmath64 or @xmath65 . in practice , this is not the case .",
    "+   + the mismatches have been studied , and allocated to the following possible causes ( first code for optics , second for molecular ) :    * @xmath66 : * * the optical inventory could be made down to genus only ; hence , the taxon was not identified to species and could therefore not be addressed to one of the species sequences of the molecular database : code @xmath67 * * the species has been detected with large gap @xmath68 , hence is likely a match on another nearby species : code @xmath11 * * there exists a discrepancy between dna based classification and morphological based classification : code @xmath69 * * the species is rare , has been detected in molecular inventory , but not in optical : code @xmath70 * @xmath71 : all codes @xmath72 can explain such a discrepancy as well ( as in @xmath63 ) when the reads assigned to a given taxon are abundant too .",
    "this is however not the case for code @xmath70 ( rare species ) where the reads can not be abundant .",
    "hence , code @xmath67 can not be found in such a situation .",
    "* @xmath73 or @xmath74 : it is highly likely that there has been an amplification problem : code @xmath75 * @xmath76 * * as a symmetry to @xmath66 , there exists a discrepancy between dna based classification and morphological based classification : code @xmath69 * * the barcode of corresponding species , as as well as of nearby species , is absent from reference database : code @xmath77 * * the optics has probably lead to count dead frustules : code @xmath78 * @xmath79 : * * as in the case @xmath76 , situations described by code @xmath69 or @xmath77 are possible * * code @xmath78 , however , is unlikely ,    the key for possible misclassification causes is given in table [ tab : codes ] .",
    "+   + the classification of mismatches par sample according to these codes has been done with expertise of diatomists who have done the optical inventories .",
    "there are three results per set of sample ( lman lake and swedish rivers ) :    * the optical inventories * the molecular based inventories * the likely causes for mismatch between both    optical inventories are given in file ` lman_optics.txt ` for lman lake and ` sweden_optics.txt ` for swedish rivers .",
    "an example of molecular based inventory with the number of informative reads per gap ( see methods ) is given in file ` l6.txt ` .",
    "mismatch classification are given in tables [ tab : leman ] for lman lake and table [ tab : swedish ] for swedish rivers .",
    "[ [ similarity - based - data - retrieval ] ] similarity based data retrieval : + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the pipeline presented here for supervised clustering can be summarized as a two steps process for each query : @xmath0 a search for neighbors in the reference database , @xmath1 a post - processing of this set . the search can be processed either by blast , or here by exact local alignment scores .",
    "we have selected the latter because it is easily parallelizable .",
    "the key point is on post - processing .",
    "the question of allocating a query to a reference , knowing a reference database and a distance , has been thoroughly studied in many areas under the name of similarity search , or similarity based data retrieval ( see e.g. @xcite ) .",
    "the model behind taxonomic assignment is the model behind barcoding : there exists a barcoding gap @xmath16 such that if two sequences @xmath80 are at a distance @xmath81 , they belong to the same taxon , whereas if they are at a distance @xmath82 , they belong to different taxa .",
    "we discuss here how to assign a name knowing a gap ( notion of informative read ) , and how to extend the procedure to a set of barcoding gaps ( notion of sliding barcoding gap ) .",
    "[ [ notion - of - informative - read ] ] notion of informative read : + + + + + + + + + + + + + + + + + + + + + + + + + + +    the notion of informative read is at the basis of our assignment pipeline , and is developed here . for a given barcoding gap @xmath16 ,",
    "the neighborhood of a query is retrieved as the set of references at distance @xmath83 .",
    "if all belong to same taxon in reference database , this taxon is assigned to the query . if not",
    ", the annotation is called ambiguous .",
    "if the neighborhood is the empty set , the annotation is unknown .",
    "let us illustrate this on the example given in figure 1 .",
    "let us have two different taxa shown here with blue dots , called here taxon 1 and taxon 2 .",
    "each taxon is a clique , as they have been derived by a mixture of morphological and molecular based basis .",
    "let us have two queries , one green one , and one red one .",
    "there are edges between each query and all references at distance less that the barcoding gap @xmath16 whatever their taxon .",
    "both edges from green query are towards nodes in taxon 1 .",
    "hence the read is informative and the label taxon 1 can be assigned to it . on the contrary ,",
    "one edge from red query is towards taxon 1 and one is towards taxon 2 .",
    "then , red query is not informative , and assignment is ambiguous .    [ [ sliding - barcoding - gap ] ] sliding barcoding gap : + + + + + + + + + + + + + + + + + + + + + +    the barcoding gap is a value such that two reads separated by a distance larger than the gap are expected to belong to different taxa , and to the same taxon if their distance is smaller than the gap .",
    "the gap depends on the taxonomic level .",
    "it is commonly accepted that an homology of @xmath84 or more is relevant for assignation at species level . as the marker used here",
    "is 312 bp long , this leads to a gap of 9 bp ( either mismatch or unitary indel ) .",
    "however , it is commonly accepted as well that the barcoding gap may depend on the clade , and is not uniform .",
    "hence , we have implemented the procedure deciding whether a read is informative , or not , and the taxonomic assignment if it is informative for a range of barcoding gaps between @xmath85 ( the more stringent choice ) to @xmath86 , as it is not expected to have distances larger than 20 bp ( less than @xmath87 of homology ) within the same species .",
    "this procedure has been run for all reads .",
    "this means that we have produced an array with @xmath88 rows if the sample is made of @xmath88 reads , and 21 columns , one column for each barcoding gap between 0 and 20 . at row @xmath11 and column @xmath16 , we have either a taxon if read @xmath11 is informative for gap @xmath16 , or the character _",
    "ambiguous _ or _",
    "unknown_. then , for each gap @xmath16 with @xmath89 , and for each taxon @xmath90 in the reference database , we have computed the number @xmath91 of reads which are informative with taxon @xmath90 at barcoding gap @xmath16 . interestingly , for a given taxon @xmath90 , the curve plotting the number @xmath91 of informative reads in the sample hitting a given taxon as a function of the barcoding gap @xmath16 is often , but not always , unimodal .",
    "this means that this number can increase or decrease when the gap decreases .",
    "it is likely that it increases for small values because the neighborhood ( the set of specimen at distance equal to or less than the gap ) increases and specimens in it belong to the same taxon , and decreases for larger values because for some reads the neighborhood becomes taxonomically heterogeneous when the distance increases .",
    "this phenomenon is driven by the shape of the reference database , and is under study with tools from multivariate analysis or machine learning .",
    "an example of such a phenomenon for one read is given in figure 2 .",
    "it can be shown that if a read is informative for a given species at a given gap , it can not be informative for another species at a different gap .",
    "the advantage of such an assignment procedure is that it permits assignment without a selection of a unique barcoding gap : it is an adaptive procedure , without a model for barcoding gap ( either constant or clade dependent ) .",
    "[ [ interpretation - of - the - results ] ] interpretation of the results : + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the fraction of perfect matches between morphological based and molecular based inventories is of 14 % for lman lake , and 7 % for swedish rivers .",
    "this could appear as desperately low .",
    "the main causes for mismatches are    * for lman lake : case @xmath70 ( rare species not recognized in optics ) for 41 % , then @xmath77 ( absence of barcode in r - syst ) for 17 % , @xmath11 ( likely match on a nearby species ) for 14 % , and @xmath69 ( mismatch between molecular based and morphological based taxonomy ) for 11 % . * for swedish rivers : @xmath69 ( mismatch between molecular based and morphological based taxonomy ) for 26 % , @xmath77 ( absence of barcode in r - syst ) for 24 % , then @xmath70 ( rare species not recognized in optics ) for 13 % , @xmath11 ( likely match on a nearby species ) for 9 % and @xmath67 ( optical inventory at genus level only ) for 8 %    all others causes can be considered as negligible ( less than 5 % ) .",
    "it appears that the main sources of mismatches are not due to the lack of resolution of molecular marker or accuracy of the pipeline , but to taxonomical and technical difficulties , which can be arranged in three categories :    * a still ongoing mismatch for some groups or clades between morphological based and molecular based taxonomy ( case @xmath69 ) * a difficulty in optics to accurately detect rare species ( case @xmath70 ) * the incompleteness of the reference data base ( cases @xmath77 and @xmath11 ) , preventing an accurate molecular based inventory .",
    "hence , the conditions for a molecular based inventory in metabarcoding to be accurate are that @xmath0 there is an agreement between morphological based and molecular based systematics and @xmath1 the reference molecular database encompasses the whole diversity of the sampled communities .",
    "if those conditions are fulfilled , there is a slight advantage for molecular based inventories which could be more accurate for detecting rare species .",
    "[ [ incompleteness - of - the - reference - database ] ] incompleteness of the reference database : + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    regarding the swedish dataset , about 50% of all taxa found in the optical inventory were not present in the reference database , so were impossible to find by the ngs method .",
    "checking the different streams , we found that many of the diatom species dominating the streams of the boreal region are not present in database and that taxa from acid streams are especially missing .",
    "examples of swedens most frequent taxa missing from the reference database are _ brachysira neoexilis _ lange - bertalot , _ eunotia incisa",
    "_ w. smith & w. gregory and _ eunotia implicata _ nrpel , lange - bertalot & alles .",
    "additionally , taxa from high mountain regions are missing as well .",
    "best represented are typical agricultural streams from the non - boreal region of sweden , ecologically most similar to central europe . on the contrary ,",
    "17% only of taxa found optically in lman lake are absent in the reference database .",
    "they are therefore impossible to detect in the molecular inventories .",
    "it is the case for taxa such as species of the _ encyonopsis _ genus or _",
    "calonei bacillum _ ,",
    "_ navicula radiosafallax _ ,",
    "_ n. utermoehlii _ , _",
    "nitzschia lacuum_. there are also several species of the _ achnanthidium _ genus ( _ a .",
    "catenatum _ , _ a. eutrophilum _ ) which were not detected in the molecular inventory but were observed in microscopy for the same reason .",
    "this is in line with recent works of @xcite which ranked completeness / incompleteness of reference database as first among causes for mismatch between optical and molecular based inventories .",
    "[ [ discrepancy - between - molecular - based - and - morphological - based - taxonomy ] ] discrepancy between molecular based and morphological based taxonomy : + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    such a discrepancy is a major limit for building an agreement between classical optical inventories and metabarcoding .",
    "a most prominent example for this category of problems is the genus _ fragilaria _",
    ", recorded as a problem in all but four of the 20 samples of the swedish dataset . even if a number of recent publications are trying to unravel the taxonomy of this genus , its identification and separation between species are far from clear .",
    "identification literature gives often no clear limits between species , some features are only visible in electronic microscopy , and most of all , different references are often giving different characters for the different species ( see e.g. the case of _",
    "strup , which is very common in fennoscandia , but not so much in central europe , where it often is identified as _ f. rumpens _ ( ktzing ) lange - bertalot instead ) .",
    "this leads to problems when trying to separate these species in optical inventories , and also especially when giving a name to a species in a reference database leading in turn to problems when comparing optical and molecular inventories to each other . in some circumstances , we can today",
    "not even say which of the given names in an inventory are correct , but have to go back and harmonize the way of identifying species .",
    "there is as well a need to make close studies of molecular and optical characters of taxa which were until now considered as a species , and study the accuracy of separations to closely related species .",
    "if none can be found , it may lead to pool species in order to enable clear identifications .",
    "other taxon complexes suffer of similar problems , represented in the swedish dataset by for example _ achnanthidium minutissimum _ and related species , _ nitzschia palea _ and related species , _ navicula cryptocephala _ and _ n. cryptotenella _ and related species , _ eolimnia minima _ and related species , certain _ gomphonema _ species , the genera _ staurosira _ , _ ulna _ , _ encyonema _ _ cymbella _ , _ mayamaea _ , _ amphora _ , and _",
    "planothidium_.      mismatches between optical based and molecular based inventories can come from biases in one of the inventory ( or both ... ) , as well as disagreements between morphology based and molecular based systematics .",
    "hence , we have tried to minimize the possible biases due to the computing phase in building a molecular based inventory .",
    "therefore , we have favored exact calculations , i.e. calculation of all local alignments between queries and references .",
    "we have compared our inventories with the ones issued on same datasets with standard tools , here mothur @xcite .    [ [ comparison - with - mothur - methods ] ] comparison with mothur : methods + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    mothur requires that the reference database is aligned , whereas diagno - syst does not . for each query , mothur searches the read in reference database closer to the query ( the best hit ) , makes a local alignment between both , and provides some information on the quality of the alignment .",
    "when the quality of the alignment is considered as sufficient ( some threshold have to be defined for that ) , next step is to accept the alignment as good , look at the identity of the aligned reference , look at its name , and transfer it to the query , considered as an element of the inventory .",
    "different tools can be selected as options , as kmers , suffix tree or blast for searching closest reference , and global or local alignment for the quality of the alignment .",
    "we have selected a search with kmers , and local alignment with gotoh .",
    "we have been stringent with the quality of the alignment ( 300 aligned bp or more among 312 bp ) . beyond the necessity to have an aligned reference database , and use of heuristics by mothur ,",
    "the main difference between mothur and diagno - syst is a taxonomic annotation from the best hit by mothur , and by an informative read by diagno - syst .",
    "diagno - syst is more stringent , in the sense that , for a given gap , it requires that all neighbors in reference database at distance less than the gap belong to the same taxon .",
    "then the name is transferred .",
    "it is therefore expected that mothur has more false positive , and diagno - syst more false negative .    [",
    "[ comparison - with - mothur - an - example ] ] comparison with mothur : an example + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    a comparison between both inventories has been made for each sample of swedish rivers and lman lake , and results for one sample ( ur_775 , swedish rivers ) are presented here as an example .",
    "the comparison is given in file ` ur_757_compare.txt ` .",
    "the sample is oligotrophic and neutral , and from the pristine mountains .",
    "45 species have been recognized by optics , 69 with diagno - syst , and 134 with mothur .",
    "10 false positive have been produced by diagno - syst , and 34 by mothur .",
    "it has been more difficult to quantify the amount of false - negatives , as into the category `` taxonomical / barcoding problems '' : they might have been hit but as a closely related taxon .",
    "another possibility is that there is a mismatch between optical and molecular based species delineation , like for _ cocconeis placentula_. hence , we have counted the taxa that diagno - syst and mothur found and were absent from optical inventory , and assessed which were probably ( e.g. earlier found ) or likely ( i.e. oligotrophic , clean - water taxa ) in the sample .",
    "this represents 13 species ( out of 24 false positive ) for diagno - syst , and 25 ( out of 89 ) for mothur .",
    "this shows that diagno - syst inventories are closer to optical based inventories than mothur inventories .",
    "this is probably due to the fact that , in order to be quick , mothur runs one local alignment only , and diagno - syst , in order to be more exact , runs them all ( in this early version ) .",
    "mothur assignment relies on the alignment with the best hit only , whereas diagno - syst relies on the alignment with all reference reads in a given neighborhood , and hence is more stringent .",
    "[ [ comparison - with - mothur - at - genus - level ] ] comparison with mothur at genus level : + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    this can be checked by a comparison between both approaches at the genus level , where taxonpic discrepancies between different approaches are less developed .",
    "the result is given in table ` ur_757_compare_genera.txt ` .",
    "looking at it indicates in nice global correlation ( better seen on a log - log scale ) , but a few important discrepancies .",
    "a major one is for genus _ cymbella _ , and all the other ones are in a long tail of rare genera , found by mothur and not by diagno - syst _ placoneis , craticula , acanthoceras , fallacia , ... _ .",
    "this comparison between mothur and diagno - syst has to be studied further and in more details .",
    "we have designed and run a new pipeline , called ` diagno - syst ` for molecular based inventories in metabarcoding . we have produced a pipeline which enables an industrialization of production of such inventories .",
    "it relies on computing exact distances , without heuristics , between each read of an environmental sample and each sequence of a reference database .",
    "such distances are then used to build molecular based inventories on environmental samples .",
    "we have compared the results of inventories of freshwater benthic diatom communities with optical based inventories on two contrasted sets of environmental samples : 10 samples from lman lake , and 20 samples from swedish rivers .",
    "all samples have been inventoried optically , and with metabarcoding , with a same protocol , and using a reference database specifically designed for freshwater diatoms ( r - syst::diatoms , see @xcite ) .",
    "we have compared the outputs of our pipeline with the standard existing one for metabarcoding inventories in microbial communities : mothur .",
    "we have found that our pipeline is more stringent : both recovered species which had been recognized optically , but they differed in the number and types of false positive : more positive , and sometimes taxonomically more distant from what could be expected , with mothur .",
    "the higher quality and accuracy of diagno - syst inventories is paid by a longer computation time , which is reasonable with parallelization ( which has been implemented ) .",
    "+   + we have studied a main question : is it possible to quantify the fraction of match / mismatch between both ways of performing an inventory on a same sample , split according to potential causes ?",
    "we have been interested in answering to two further questions : first , a focus on rare species , by definition difficult to detect , but a key component of biodiversity , and , second , having two contrasted datasets handled with the same protocol permits to have an idea of the dependence of the result on regional idiosyncrasies .",
    "+   + in both datasets , the largest causes of mismatches between molecular and optical dataset were @xmath69 - discrepancy between dna - data and classical taxonomy , @xmath70 - rare species , @xmath77 - no barcode in r - syst and @xmath11 - species detected for gaps @xmath92 .",
    "however , we found that the plausible main causes of discrepancies are different for datasets : in lman lake , most mismatches were caused by taxa that were found by metabarcoding but not in microscope .",
    "this category was interpreted as rare species , which simply had been overlooked in the microscope , as only 400 valves are too be counted .",
    "as our knowledge of diatoms benthic communities in lman lake is fairly good , it is possible to state in most of cases that those species actually have been found earlier in the frequent and long - term monitoring of this lake .",
    "so we can assert with high confidence that the ngs method is correct here , and that the ngs method is better in finding rare taxa . on the other hand , in the swedish dataset",
    "most mismatches were caused by @xmath0 a discrepancy between dna - based and classical taxonomy and @xmath1 by optical taxa missing in the reference database .",
    "furthermore , a comparison between mothur and diagno - syst showed that the long tail of rare species or genera provided by mothur is not fully trustable : it is probably over - estimated .",
    "most of these discrepancies are due to an underrepresentation of boreal taxa in the reference database .",
    "+   + as a consequence , much effort still has to be put into @xmath0 implementation of exact calculations ( sequence comparisons ) for comparing queries with a reference database in order to minimize an overestimation of the long tail of diversity , @xmath1 diatom taxonomy , to unravel dna based and optical based species delineation , and @xmath2 completing reference databased with more species from underrepresented regions .",
    "[ [ acknowledgements ] ] acknowledgements : + + + + + + + + + + + + + + + + +    it is a pleasure to acknowledge a definite input of yechan laizet ( biogeco ) for an earlier version of pipeline ` diagno_syst ` , several discussions on metabarcoding of protists with d. debroas , the earlier work of and discussions with lenag kermarrec as phd student on metabarcoding in carrtel with tight collaborations with biogeco .",
    "this work has been supported by onema project `` developpement doutils de bio - indication phytobenthos et macroinvertbrs benthiques pour les cours deau de mayotte '' given to ab , project e - biothon given to af , dari project `` biodiversiton '' i2015037360 in 2015 and 2016 for access to national computing center idris , given to af , and a one year cdd given by ceba ( centre dtude de la biodiversit amazonienne ) anr project to af , which supported an earlier version of diagno - syst .",
    "the swedish contribution to this study was jointly funded by the swedish agency for marine and water management , swam , and the environmental monitoring and assessment ( fortlpande miljanalys ( foma ) och miljvervakning ) research program at the swedish university of agricultural sciences .",
    ".coding of the possible reasons for discrepancy between optical based and molecular based inventories[tab : codes ] [ cols=\"<,<\",options=\"header \" , ]",
    "\\(a ) at ( 0,0 ) ; ( b ) at ( 0.5,1.3 ) ; c ( c ) at ( 1.7 , 0.5 ) ; ( d ) at ( 1.5 , 2.3 ) ; ( e ) at ( 3.0 , 1.6 ) ; ( t1 ) at ( 1.5 , 3.5 ) ; ( a ) circle ( 0.1 ) ; ( b ) circle ( 0.1 ) ; ( c ) circle ( 0.1 ) ; ( d ) circle ( 0.1 ) ; ( e ) circle ( 0.1 ) ; ( a )  ( b ) ; ( a )  ( c ) ; ( b )  ( c ) ; ( b )  ( d ) ; ( b )  ( e ) ; ( c )  ( d ) ; ( c )  ( e ) ; ( d )  ( e ) ; ( t1 ) node taxon 1 ; ( a2 ) at ( 5.0,0 ) ; ( b2 ) at ( 5.5 , 1.3 ) ; ( c2 ) at ( 6.4 , 0.7 ) ; ( d2 ) at ( 5.2 , 2.3 ) ; ( t2 ) at ( 5.5 , 3.5 ) ; ( a2 ) circle ( 0.1 ) ; ( b2 ) circle ( 0.1 ) ; ( c2 ) circle ( 0.1 ) ; ( d2 ) circle ( 0.1 ) ; ( a2 )  ( b2 ) ; ( b2 )  ( c2 ) ; ( b2 )  ( d2 ) ; ( a2 )  ( c2 ) ; ( a2 )  ( d2 ) ; ( c2 )  ( d2 ) ; ( t2 ) node taxon 2 ; ( q1 ) at ( 2.7 , 2.8 ) ; ( q1 ) circle ( 0.1 ) ; ( q1 )  ( d ) ; ( q1 ) ",
    "( e ) ; ( q2 ) at ( 4.2 , 1.7 ) ; ( q2 ) circle ( 0.1 ) ; ( q2 )  ( e ) ; ( q2 )  ( b2 ) ;      blue dots are references .",
    "green and red dots represent two queries .",
    "references have been categorized by a mixture of molecular and morphological based assignment .",
    "hence they are depicted as ( nearly ) cliques .",
    "there is an edge between a query and a reference when the distance between them is less than @xmath16 .",
    "green query is an informative read , because both edges lead to the same taxon , whereas red query is ambiguous , as both edges lead to two different taxa .",
    "see text for details .",
    "\\(q ) at ( 0,0 ) ; ( a1 ) at ( 2.5,3.3 ) ; ( a2 ) at ( 2.1 , 1.5 ) ; ( a3 ) at ( 1.5 , 2.3 ) ; ( a4 ) at ( 3.0 , 2.6 ) ; ( a5 ) at ( 1.5 , 3.5 ) ; ( b1 ) at ( 3.5 , 4.2 ) ; ( b2 ) at ( 4.2 , 4.6 ) ; ( b3 ) at ( 5.2 , 4.4 ) ; ( q ) circle ( 0.1 ) ; ( a1 ) circle ( 0.1 ) ; ( a2 ) circle ( 0.1 ) ; ( a3 ) circle ( 0.1 ) ; ( a4 ) circle ( 0.1 ) ; ( a5 ) circle ( 0.1 ) ; ( b1 ) circle ( 0.1 ) ; ( b2 ) circle ( 0.1 ) ; ( b3 ) circle ( 0.1 ) ; ( 2.0,0 ) arc ( 0:90:2.0 ) ; ( 0.8 , 1.1 ) node @xmath93 ; ( 0.8 , 0.7 ) node ( unknown ) ; ( 4.5,0 ) arc ( 0:90:4.5 ) ; ( 0.8 , 3.0 ) node @xmath94 ; ( 1.9 , 4.8 ) node @xmath95 ( ambiguous ) ;      the red dot is a read .",
    "the blue dots and green dots are two species in the reference database , respectively",
    ". black quarter of circle represent areas at distance equal to the radius of the circle .",
    "for small distances , the query has no it @xmath96 .",
    "the status is _",
    "unknown_. for some region , the read can have between 1 and 5 hits of references belonging all to species blue @xmath97.the status is informative for species blue . beyond a given radius",
    ", the read has more than 5 hits @xmath98 , but on references belonging to either blue or green species .",
    "the status is _ ambiguous_.              c.  bachy , j.  r. dolan , p.  lpez - garcia , p.  deschamps , and d.  moreira .",
    "accuracy of protist diversity assessments : morphology compared with cloning and direct pyrosequencing of 18s rrna genes and its regions using the conspicuous tintinnid ciliates as a case study .",
    ", 7:244255 , 2013 .",
    "d.  a. cowart , m.  pinheiro , o.  mouchel , m.  maguer , j.  grall , j.  min , and s.  arnaud - haond .",
    "metabarcoding is powerful yet still blind : a comparative analysis of morphological and molecular surveys of seagrass communities . ,",
    "doi:10.1371/journal.pone.0117562:126 , 2015 .",
    "k.  a. dafforn , d.  j. baird , a.  a. chariton , m.  y. sun , m.  v. brown , s.  l. simpson , b.  p. kelaher , and e.  l. johnston .",
    "faster , higher and stronger ? the pros and cons of molecular faunal data for assessing ecosystem condition . , 51:140 , 2014 .",
    "l.  guillou , d.  bachar , s.  audic , d.  bass , c.  berney , l.  bittner , c.  boutte , g.  burgaud , c.  de  vargas , j.  decelle , j.  del campo , j.  r. dolan , m.  dunthorn , b.  edvardsen , m.  holzmann , w.  h. c.  f. kooistra , e.  lara , n.  le  bescot , r.  logares , r.  mah , f. abnd  massana , m.  montresor , r.  morard , f.  not , j.  pawlowski , i.  probert , a .-",
    "sauvadet , r.  siano , t.  stoeck , d.  vaulot , p.  zimmermann , and r.  christen . .",
    ", 41(database issue):d597d604 , 2013 .",
    "m.  hajibabaei , s.  shokralla , x.  zhou , g.  a.  c. singer , and d.  j. baird .",
    "environmental barcoding : a next generation sequencing approach for biomnitoring applications using river benthos . , 6(4):e17497 , 2011 .",
    "y.  ji , l.  ashton , s.  m. pedley , d.  p. edwards , y.  tang , a.  nakamura , r.  kitching , p.  m. dolman , p.  woodcock , f.  a. edwards , t.  h. larsen , w.  x. hsu , s.  benedick , k.  c. hamer , d.  s. wilcove , c.  bruce , x.  wang , t.  levi , m.  lott , b.  c. emerson , and d.  w. yu .",
    "reliable , verifiable and efficient monitoring of biodiversity via metabarcoding .",
    ", 16:12451257 , 2013 .",
    "s.  joly , t.  j. davies , a.  archambault , a.  bruneau , a.  derry , s.  w. kembel , peres - neto p. , j.  vamosi , and t.  a. wheeler .",
    "ecology in the age of dna barcoding : the resource , the promise and the challenges ahead .",
    ", 14:221232 , 2014 .",
    "l.  kermarrec , a.  franc , f.  rimet , p.  chaumeil , j .- f .",
    "humbert , and a.  bouchez .",
    "next - generation sequencing to inventory taxonomic diversity in eukaryotic communities : a test for freshwater diatoms .",
    ", 13:607619 , 2013 .",
    "k. lindeque , h.  e. parry , r.  a. harmer , p.  j. somerfield , and a.  atkinson .",
    "next generation sequencing reveals the hidden diversity of zooplankton assemblages .",
    ", 8(11)(e81327.):doi:10.1371/journal.pone.0081327 , 2013 .",
    "r.  medinger , v.  nolte , r.  v. pandey , s.  jost , b.  ottenwalder , schlotterer c , and j.  boenigk .",
    "diversity in a hidden world : potential and limitation of next - generation sequencing for surveys of molecular diversity of eukaryotic microorganisms .",
    ", 19(suppl . 1):3240 , 2010 .",
    "d.  porazinska , r.  m. giblin - davis , l.  faller , w.  farmerie , n.  kanzaki , k.  morris , t.  o. powers , a.  e. tucker , w.  sung , and w.  k. thomas . evaluating high - throughput sequencing as a method for metagenomic analysis of nematode diversity .",
    ", 9:14391450 , 2009 .",
    "f.  rimet , p.  chaumeil , f.  keck , l.  kermarrec , v.  vasselon , m.  kahlert , a.  franc , and a.  bouchez . : an open - access and curated barcode database for diatoms and freshwater monitoring . , pages 121 , doi:10.1093/database / baw016 , 2016 .",
    "d. schloss , s.  l. westcott , t.  ryabin , j.  r. hall , m.  hartmann , and e.  b. et al .",
    "( 2009 ) hollister .",
    "introducing mothur : open - source , platform - independent , community - supported software for describing and comparing microbial communities .",
    ", 75:75377541 , 2009 .",
    "m.  l. sogin , h.  g. morrison , j.  a. huber , d.  m. welch , s.  m. huse , p.  r. neal , j.  m. arrieta , and g.  j. herndl .",
    "microbial diversity in the deep sea and the underexplored `` rare biosphere '' .",
    ", 103(32):1211512120 , 2006 ."
  ],
  "abstract_text": [
    "<S> metabarcoding on amplicons is rapidly expanding as a method to produce molecular based inventories of microbial communities . here </S>",
    "<S> , we work on freshwater diatoms , which are microalgae possibly inventoried both on a morphological and a molecular basis . </S>",
    "<S> we have developed an algorithm , in a program called ` diagno - syst ` , based a the notion of informative read , which carries out supervised clustering of reads by mapping them exactly one by one on all reads of a well curated and taxonomically annotated reference database . </S>",
    "<S> this program has been run on a hpc ( and htc ) infrastructure to address computation load . </S>",
    "<S> we compare optical and molecular based inventories on 10 samples from lman lake , and 30 from swedish rivers . </S>",
    "<S> we track all possibilities of mismatches between both approaches , and compare the results with standard pipelines ( with heuristics ) like mothur . </S>",
    "<S> we find that the comparison with optics is more accurate when using exact calculations , at the price of a heavier computation load . </S>",
    "<S> it is crucial when studying the long tail of biodiversity , which may be overestimated by pipelines or algorithms using heuristics instead ( more false positive ) . </S>",
    "<S> this work supports the analysis that these methods will benefit from progress in , first , building an agreement between molecular based and morphological based systematics and , second , having as complete as possible publicly available reference databases . </S>"
  ]
}