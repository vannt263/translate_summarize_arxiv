{
  "article_text": [
    "the process of parametric down conversion , in which pump photons with frequency @xmath0 are sent through a nonlinear crystal and converted into pairs of signal and idler photons with frequencies @xmath1 and @xmath2 , is a well - known and widely used phenomenon in quantum optics .",
    "since the conversion efficiency is rather small , in the optical parametric oscillator ( opo ) the process is enhanced by placing the crystal inside an optical cavity . due to its importance as a source of squeezed light",
    "when operated below threshold , the opo has been subject of much investigation , in particular for the case of a time independent continuous - wave pump field @xcite .",
    "the case of a periodically modulated pump field has been studied in @xcite . in the standard treatment of the opo",
    ", the calculations are performed in frequency space , the pump is taken as a time independent monochromatic beam , and it is often assumed that the cavity allows only one or two modes with well - defined frequencies , depending on whether degenerate or nondegenerate operation is considered .",
    "the field leaking out of the cavity is then determined from input - output formalism .",
    "an opo may also be pumped with a pulsed light field .",
    "this case is often discussed as if the opo generates a single mode pulse of squeezed light , but this is not quite the case .",
    "the output consists of a number of independent modes squeezed by different amounts as discussed for single pass down conversion in refs.@xcite . in the present paper",
    "we use a completely different approach to characterize the output from a pulsed opo .",
    "the treatment is a generalization of the discussion of the continuous - wave opo in ref .",
    "@xcite , and in contrast to refs .",
    "@xcite all calculations are performed in the time domain .",
    "the time domain treatment has several advantages .",
    "firstly , it is not necessary to assume the existence of a single mode or a couple of independent modes in the cavity since all effects of cavity resonances appear naturally in the analysis from the specification of the length of the cavity via the cavity round trip time .",
    "furthermore , since we do not assume orthogonal cavity modes , our treatment is valid for all values of the transmission of the opo output coupling mirror and not just for small transmissions .",
    "in particular , we may increase the mirror transmission to unity in our formulas and obtain the results for single pass down conversion .",
    "secondly , we do not assume any particular temporal shape of the pump field , and the analysis is thus suitable to investigate the transition between the few mode situation for short pulses and the highly multimode regime for continuous - wave fields .",
    "in the limit of a time independent pump field our results reduce to those of ref.@xcite , provided we invoke extra approximations which guarantee the existence of only a single cavity mode .",
    "thirdly , the time domain analysis is convenient if the light emitted from the opo is detected continuously in time and the back action of the measurements on the system has to be taken into account , see @xcite .",
    "although the opo output can be both squeezed and entangled , it belongs to the family of so - called gaussian states , and for a number of applications in quantum communication and computing , non - gaussian states are necessary .",
    "the opo output can be transformed into non - gaussian states by measurements as shown schematically in fig.[setup ] : a small fraction of the light is extracted , possibly frequency filtered , and detected by an avalanche photo diode ( apd ) . as , e.g. , a squeezed vacuum state is a superposition of even photon number states , a photo detection in the apd heralds the generation of a state with only odd photon number contributions such as single photon states and odd schrdinger kitten states in the remaining beam as verified experimentally in @xcite .",
    "@xcite provides a theoretical determination of the mode of the output state with the largest single photon fidelity for the case of a continuous - wave nondegenerate opo .",
    "we note that in the experimental verification by homodyne detection , one may use a constant amplitude local oscillator , measure the homodyne detector signal as a function of time , and then at a later stage multiply the recorded data with the mode function , selected according to the instant of the photo detection by the apd @xcite .        for several applications of the heralded non - gaussian field states it is , however , necessary to mode match the state in real time .",
    "this is the case if one wants to interfere different pulses and if one wants to store the field state in an atomic medium and , e.g. , perform quantum gates by optical non - linearities in the medium @xcite .",
    "whether making use of electromagnetically induced transparency @xcite , a raman transfer @xcite , or faraday polarization rotation @xcite , storage of light pulses in atomic media involves a strong pump pulse that defines the temporal mode of the quantized field to be mapped onto the atomic collective degree of freedom @xcite .",
    "this implies that storage of a field state heralded by an apd detection event requires a storage control field , which has to be produced at the appropriate time .",
    "since the mode function occupied by the non - gaussian state may extend to times both before and after the trigger event @xcite , it may thus be necessary to switch on the control field _ before _ the trigger event or , more realistically , to delay the arrival of the signal to the storage medium . for demonstration experiments",
    ", it would be attractive to apply the storage protocol irrespective of the apd output and subsequently post select the instances where apd detection actually occurred in a suitable time window around the instant for which the stored mode is optimal . in this paper",
    "we do not model the storage process itself , but we identify the mode functions that maximize the non - gaussian features of the pulses to be stored , conditioned on realistic detection events . in particular , we wish to identify mode functions that are optimal independent of the precise detection time within a predefined time interval , which can not be chosen arbitrarily small if one wants a satisfactory apd detection probability .",
    "we shall for concreteness take the optimal mode to be the one with the most negative value of the wigner function at the origin .",
    "the paper is structured as follows . in sec .",
    "ii we develop a theoretical description of the opo and derive the two - time correlation functions of the opo output field . in sec .",
    "iii we show that a treatment similar to the one applied to the opo can be used to express the output field from the filter in fig .",
    "[ setup ] in terms of the input field . in sec .",
    "iv we determine the mode of the conditioned state with the most negative value of the wigner function at the origin , we compute the probability to obtain a trigger detection event within a specified time interval , and we compare the performance of continuous - wave and pulsed operation of the opo for preparation of pulses that can be stored with predefined control pulses in an atomic medium .",
    "section v concludes the paper .",
    "a theoretical model of the opo is based on the setup illustrated in fig .",
    "we have chosen a four - sided ring cavity for mathematical convenience , but this is not essential to the analysis .",
    "the field annihilation operators of the input and the output fields are denoted @xmath3 and @xmath4 , respectively , while @xmath5 , @xmath6 , represents the field at different positions inside the cavity as shown , and @xmath7 is the annihilation operator of a field in the vacuum state .",
    "the beam splitter @xmath8 couples the input and output fields to the intra cavity field , and the fictitious beam splitter @xmath9 models losses in the system .",
    "we model the entire loss as if it takes place between the crystal in the upper part of the figure and the output coupling mirror , which represents a worst case situation .",
    "the crystal is pumped by a classical pump field @xmath10 , which is assumed to pass unhindered through the cavity mirrors .",
    "the parametric process in a non - linear crystal is described in @xcite , and leads , in the time domain , to the following mapping of the field incident on the crystal to the field leaving the crystal @xmath11 in @xmath12 , which is taken to be real , is proportional to the second order susceptibility of the crystal and to the length of the crystal .",
    "we have assumed that the bandwidth of the down conversion is infinite and neglected depletion of the pump field and differences in the phase matching conditions for down conversion to different frequencies .",
    "this is likely to be a good approximation in the experiment described in ref.@xcite , since the crystal inside the opo is only few millimeters long , and thousands of cavity modes are populated .",
    "also , modes far from the center of the spectrum are irrelevant because they are filtered out by other components in experiments ( see the next section ) .    .",
    "the beam splitter @xmath8 couples the intra cavity field to the input ( vacuum ) field @xmath3 and the output field @xmath4 , and the beam splitter @xmath9 is included to model intra cavity losses . ]    in order to express @xmath4 in terms of @xmath3 and @xmath7 , we use the beam splitter relations @xmath13 and express @xmath14 in terms of @xmath15 @xmath16 @xmath17 ( @xmath18 ) is the field transmission ( reflection ) coefficient of @xmath19 , and @xmath20 is the round trip time in the cavity . in",
    ", we have assumed that each cavity mirror induces a phase shift of @xmath21 , and we have defined the following quantities @xmath22 where @xmath23 is the traveling time from @xmath8 to the crystal . furthermore , for convenience , we have redefined @xmath7 according to @xmath24 , where @xmath25 is the traveling time from @xmath9 to @xmath8 . isolating @xmath4 from eqs .  , , and and assuming @xmath26 for all @xmath27 , we find @xmath28 the requirement @xmath26 , which is satisfied for @xmath29 , where @xmath30 is an integer and @xmath31 is a constant , means that the successive squeezing operations add up in phase , i.e. , it is the same quadrature that is squeezed at times @xmath27 , @xmath32 , @xmath33 , @xmath34 .    for the special case of a time independent continuous - wave pump field @xmath35 , below threshold @xmath36 , a fourier transform of leads to the following expression for the output field in frequency domain : @xmath37 where @xmath38 is half the frequency of the pump field , @xmath39 and @xmath40 assuming that the input field @xmath3 is in the vacuum state",
    ", the frequency correlation function @xmath41 shows that resonances occur for @xmath42 , @xmath43 , as expected .",
    "in particular , the degenerate frequency @xmath44 is only a resonance frequency if @xmath30 is even . to compare eq .",
    "to the results given in ref .",
    "@xcite for a cavity with a single resonance frequency at @xmath44 , we assume @xmath30 to be even and @xmath45 in eq .  .",
    "in order to have well separated cavity modes we must also assume @xmath46 and @xmath47 , but to maintain a finite width of the modes as in ref .",
    "@xcite we keep @xmath48 and @xmath49 fixed .",
    "since @xmath50 and @xmath51 in this limit , the mean number of round trips in the cavity is large , and @xmath52 must be correspondingly small , i.e. , @xmath52 must be proportional to @xmath20 .",
    "for @xmath53 we obtain eq .",
    "46 of ref.@xcite .",
    "returning to the general case , we compute the two - time correlation functions of the output field for @xmath3 in the vacuum state from eq .  :",
    "@xmath54 and @xmath55 these two expressions and @xmath56 are sufficient to characterize the output state completely , because it is gaussian .",
    "the correlations of an arbitrary single mode with mode function @xmath57 and annihilation operator @xmath58 are easily calculated from eqs .   and .",
    "we shall only be concerned with the degenerate case below , and we thus choose @xmath59 with @xmath60 real .",
    "the constant phase factor is included to obtain a real value of @xmath61 , which corresponds to the case , where the axes of the squeezing ellipse in phase space lie along the quadrature axes . in the following we take @xmath57 to be real and omit the factor @xmath62 in eq .  .",
    "the variances of @xmath63 and @xmath64 are @xmath65 and @xmath66 , respectively , and the most efficiently squeezed mode is thus obtained by choosing @xmath57 as the eigenfunction with the smallest eigenvalue @xmath67 of an integral equation with either the integration kernel @xmath68 or @xmath69 , and @xmath67 is the corresponding variance .",
    "since the output field at time @xmath27 is only correlated to the output field at times @xmath70 , @xmath43 , the mode function of the most efficiently squeezed mode is in general a spike function that is only nonzero at times @xmath70 , @xmath71 , for some @xmath27 , but if the variations of the pump field take place on a time scale @xmath20 or more slowly , displaced spike functions , and therefore also a smooth mode function with the same envelope , will be only slightly less squeezed .    in the limit of a time independent pump field ,",
    "eqs .   and",
    "reduce to @xmath72 and @xmath73    until now we have described the fields in terms of time dependent heisenberg picture operators , but it is also useful to consider the opo model from a schrdinger picture point of view .",
    "in particular , the latter approach is suitable for a numerical treatment of the pulsed opo . to this end",
    "we divide the light beams into small segments of ( infinitesimal ) duration @xmath74 and treat each segment as a single mode , i.e. , we define @xmath75 and replace the continuous field annihilation operator @xmath76 ( @xmath77 , @xmath4 , @xmath78 , or @xmath14 ) by the discrete annihilation operators @xmath79 localized at time @xmath17 . in practice , we will have to deal with a finite @xmath74 , and neglecting the field variation within each @xmath74 interval is equivalent to a cutoff in frequency , justified by the experimentally relevant frequency regime .",
    "a thorough discussion of continuous and discrete operator descriptions of light beams in both time and frequency space may be found in ref .",
    "since the output field and the cavity field are gaussian for a vacuum input field , the state of all the small light beam segments is efficiently represented by a wigner function . in general , the wigner function of an @xmath80-mode gaussian state with zero mean values is on the form @xmath81 where @xmath82 is a column vector of quadrature variables , and @xmath83 is the covariance matrix of the @xmath80 modes .",
    "@xmath84 , where @xmath85 , @xmath86 , @xmath87 , and @xmath88 is the field annihilation operator of mode @xmath89 . before the pump pulse reaches the crystal , all modes are in the vacuum state , and @xmath83 is the identity matrix .",
    "we include all the @xmath90 cavity modes and a sufficiently large number of @xmath3 and @xmath7 modes in .",
    "as time passes by modes are squeezed , when they hit the crystal , input and cavity modes are transformed into cavity and output modes , when they hit @xmath8 , and vacuum and cavity modes are transformed into cavity and lost modes , when they hit @xmath9 . for each of these transformations @xmath91",
    "is transformed according to @xmath92 , where @xmath93 is a matrix , which is easily determined from eqs .  , , and .",
    "the corresponding transformation of @xmath83 is @xmath94 . at the end of the calculation",
    "all rows and columns of @xmath83 that represent lost modes are erased , and the result is a matrix , which contains the same information as eqs .   and .",
    "we have used this method to compute the results for the pulsed opo in sec .",
    "the opo produces pairwise quantum correlated fields in a large number of cavity field modes , and in experiments it is necessary to apply a frequency filter before the trigger detector , see fig.[setup ] , to ensure that the photon is derived from a well defined sideband , and that the signal field predominantly occupies a single mode .",
    "we now turn to a description of such a filter modeled by a cavity with two beam splitters @xmath8 and @xmath9 and two perfectly reflecting mirrors as depicted in fig .",
    "[ filter ] .",
    "copying the notation from sec .",
    "ii , @xmath3 is the input field , @xmath4 is the output field , @xmath7 is a field in the vacuum state , @xmath5 is the field at different positions inside the cavity ( see the figure ) , @xmath17 ( @xmath18 ) is the field transmission ( reflection ) coefficient of @xmath19 , and @xmath95 is the round trip time in the filter cavity . the fields are related according to the equations @xmath96 from which we derive @xmath97 transforming the output field to frequency space @xmath98 we find @xmath99 and it is apparent that the frequencies transmitted most efficiently through the filter are those which satisfy the condition @xmath100 , @xmath43 .",
    "the free spectral range of the filter is thus @xmath101 , and for a given @xmath95 the bandwidth is determined by @xmath102 and @xmath103 .",
    "is partially transmitted into the cavity through the beam splitter @xmath8 .",
    "the reflected component of the input field is lost as is the part of the intra cavity field that leaves the cavity through @xmath8 . the part of the intra cavity field that leaves the cavity through @xmath9 contributes to the output field @xmath4 .",
    "@xmath7 is a field in the vacuum state . ]    in order to select just one of the frequency modes emerging from the opo , the bandwidth of the filter should be much smaller than the free spectral range of the opo , but larger than the bandwidth of the opo .",
    "also , the free spectral range of the filter should be large compared to the bandwidth of the parametric down conversion .",
    "experimentally it can be difficult to build cavities that satisfy the last condition , and one may use instead a sequence of different filter cavities @xcite . since we assumed an infinite bandwidth of the down conversion in sec .",
    "ii , we must , for consistency , use an infinitely small filter cavity in the theoretical treatment .",
    "we thus assume @xmath104 , @xmath46 , and @xmath105 for fixed @xmath106 and @xmath107 , where @xmath108 , @xmath43 , is a resonance frequency of the filter cavity , and expand eq .",
    "to lowest order : @xmath109 in this limit the filter transmission function is a lorentzian @xmath110 we consider a single mode @xmath57 of the output field , and define @xmath111 and @xmath112 according to @xmath113 since the vacuum state does not contribute to normally ordered expectation values , we shall not need @xmath112 in the following , but from eq .",
    "@xmath114 i.e. , the action of the filter is effectively to transform the mode function @xmath57 into the ( not properly normalized ) mode function @xmath111 .",
    "note that if the time dependent part of the phase of @xmath57 is chosen as @xmath115 , the time dependent part of the phase of @xmath111 is also given as @xmath115 .",
    "when we choose the resonance frequency of the filter to equal half the carrier frequency of the opo pump beam , we may thus continue to use real mode functions and omit the factor @xmath116 in eq .  .",
    "for a given bandwidth @xmath117 of the filter , @xmath118 is maximal for @xmath119 , and we thus assume @xmath120 in the rest of the paper .",
    "with the necessary tools at hand we can now proceed to an analysis of the preparation of non - gaussian light states that can be stored in atomic samples .",
    "gaussian states have wigner functions that are positive for all arguments , and as a measure of non - gaussian character we shall refer to negative values of the wigner function occurring at the origin of phase space , e.g. , for odd number states and odd schrdinger cat states . in ref .  @xcite we derived an expression for the value of the wigner function at the origin of the state of an arbitrary real mode of the multimode state generated when conditioning on a photo detection event @xmath121 @xmath122 are the elements of the gaussian covariance matrix of the mode in which the apd detection takes place ( quadrature variables 1 and 2 ) and the chosen mode of the output state ( quadrature variables 3 and 4 ) before conditioning . @xmath83 is computed from the definition given just below eq .   by use of the mode functions of the two modes , the transformation of the trigger mode function due to the filter , eq .",
    "( with @xmath4 replaced by the relevant linear combination of @xmath4 and the annihilation operator of the vacuum field entering into the system at the beam splitter in fig .  [ setup ] ) , and the two - time correlation functions given in eqs .   and .",
    "we take the trigger mode function to be constant in a time interval of duration @xmath123 positioned at time @xmath17 and zero otherwise , where @xmath123 is much shorter than all other time scales in the system . in appendix",
    "a we discuss the applied detector model and the choice of trigger mode function in more detail .",
    "as explained in the introduction the mode that will be stored is determined by the shape and timing of the strong storage pulse , and it is advantageous if one can initiate the generation of the storage pulse before it is known whether a trigger detection event will actually take place at the right time relative to the pulse stored .",
    "the protocol is thus probabilistic .",
    "we consider an attempted storage as successful if a trigger detection event takes place within a predefined time interval of duration @xmath124 , whose position on the time axis is determined relative to the pump pulse , if the opo is pulsed , and relative to the storage pulse , if the pump field is time independent . in practice",
    ", @xmath124 is at least as large as the temporal resolution of the apd detection system , which is of order 1 ns @xcite . since the shape of the storage pulse is independent of the actual trigger detection time , the quantity we optimize is the mean value of the wigner function at the origin @xmath125 where the sum is over the @xmath126 trigger modes inside the acceptance interval @xmath124 , @xmath127 is the probability to obtain a detection event in trigger mode @xmath89 , which for infinitesimal @xmath128 is equal to the expectation value of the number of photons in the @xmath89th trigger mode , and @xmath129 is the value of the wigner function at the origin of the chosen mode of the generated state conditioned on a detection in trigger mode @xmath89 given in eq .. the total trigger probability @xmath130 is small , and hence we neglect the possibility to have two or more detection events within the time interval @xmath124 .",
    ".parameters used in the numerical minimization of @xmath131 .",
    "@xmath132 includes both propagation efficiency in the trigger channel and the efficiency of the apd , while @xmath133 is the propagation efficiency of the signal channel .",
    "the values are chosen in accordance with the numbers given in refs.@xcite [ cols=\"<,^,^\",options=\"header \" , ]     under realistic experimental conditions there will be significant losses , and these are included in the calculations presented below .",
    "the chosen experimental parameters are given in table [ values ] , and for the case of a pulsed opo we assume that the pump field has a gaussian envelope and write @xmath134 as @xmath135 optimizing for different values of @xmath136 , @xmath137 , and @xmath124 ( or @xmath52 and @xmath124 for the case of a time independent pump field ) by optimizing the shape of the mode function of the mode that is to be stored , we obtain the values of @xmath131 shown in fig .",
    "[ tnp]a , and the corresponding success probabilities are given in fig.[tnp]b .",
    "examples of optimized mode functions are plotted in figs .",
    "[ mode ] and [ formel ] .",
    "we note that the absolute temporal position of the interval @xmath124 has been chosen to maximize the success probability .",
    "also , the values of @xmath52 for the opo driven with a time independent pump field have been chosen in order to obtain a total flux of photons in the degenerate mode of the output field from the opo , which is of order @xmath138 as in ref .",
    "this corresponds to a success probability of @xmath139 for @xmath140 .",
    "the values of @xmath137 have been adjusted to obtain comparable success probabilities in the calculations for pulsed pump fields .",
    "c +   and b ) success probability as a function of @xmath124 .",
    "solid lines : time independent continuous - wave ( cw ) pump field with @xmath141 , @xmath142 , @xmath143 , and @xmath144 ; dashed lines : pulsed pump field with @xmath145 and @xmath146 , @xmath147 , @xmath148 , and @xmath149 ; dotted lines : pulsed pump field with @xmath150 and @xmath151 , @xmath148 , and @xmath149 ; dash - dotted line : pulsed pump field with @xmath152 and @xmath153 ; dash - dotted line labeled sp : single pass ( sp ) operation for a pulsed pump field with @xmath150 and @xmath154 . within each series a smaller @xmath137 or @xmath52 corresponds to a more negative value of @xmath131 and a smaller success probability.,title=\"fig : \" ] +   +   and b ) success probability as a function of @xmath124 .",
    "solid lines : time independent continuous - wave ( cw ) pump field with @xmath141 , @xmath142 , @xmath143 , and @xmath144 ; dashed lines : pulsed pump field with @xmath145 and @xmath146 , @xmath147 , @xmath148 , and @xmath149 ; dotted lines : pulsed pump field with @xmath150 and @xmath151 , @xmath148 , and @xmath149 ; dash - dotted line : pulsed pump field with @xmath152 and @xmath153 ; dash - dotted line labeled sp : single pass ( sp ) operation for a pulsed pump field with @xmath150 and @xmath154 .",
    "within each series a smaller @xmath137 or @xmath52 corresponds to a more negative value of @xmath131 and a smaller success probability.,title=\"fig : \" ]    considering the trends in fig  [ tnp]b , we find that the success probability increases when @xmath52 increases and when @xmath137 increases for fixed @xmath136 as expected .",
    "the success probability is also an increasing function of @xmath124 , because more terms are included in the sum in eq .",
    ", when @xmath124 increases .",
    "for a time independent pump field the increase is linear , because all the @xmath127 s are equal , while the success probability levels off to a constant value for a pulsed pump field when @xmath124 increases beyond the temporal width of the intensity distribution of the generated output field , which is roughly of order the width of the intensity distribution of the pump pulse plus the mean lifetime of a photon in the opo cavity ( @xmath155 ) plus the mean lifetime of a photon in the filter cavity ( @xmath156 ) .",
    "the constant value is thus reached faster for short pulses .",
    "it is apparent from the figure that a decrease in @xmath136 must be accompanied by an increase in @xmath137 in order to keep the success probability unchanged .",
    "both of these changes increase the required peak value of @xmath52 , i.e. , a larger field strength or a larger conversion efficiency in the crystal is needed .",
    "to explain the trends in fig .",
    "[ tnp]a we note that @xmath131 of a state with density matrix @xmath157 is @xmath158 , and thus an optimization of @xmath131 is equivalent to a maximization of the odd photon number components . an ideal single mode",
    "squeezed vacuum state is a superposition of even photon number states , and if a photon is annihilated from the state , these are converted into odd photon number states .",
    "the present experiment deviates from this ideal situation in two respects .",
    "firstly , the generated state is a multimode state , since all the generated photon pairs do not belong to the same mode .",
    "the result is that the overlap between the optimal mode and the modes of the generated photon pairs is only partial , and this introduces even photon number components into the state of the optimal mode .",
    "the mechanism is particularly severe if photon pairs are generated in the outer regions of the optimal mode such that the overlap between the optimal mode and the mode of the photon pair is significantly smaller than unity , but also significantly larger than zero .",
    "this suggests that a short pump pulse , where the down conversion process is only turned on in a short period , will lead to a more negative value of @xmath131 , and this is also what is observed in fig .",
    "the effect is particularly pronounced for very large @xmath124 . in this limit @xmath131",
    "approaches a constant value for pulsed pump fields , because @xmath127 is small for trigger modes far from the center of the intensity distribution of the generated state and these modes do thus not contribute significantly to the sums in eqs .   and .",
    "for a time independent pump field , on the other hand , @xmath131 approaches the value of the unconditional state , because the success probability approaches unity for very large @xmath124 , and all storage attempts are accepted as successful .",
    "the second deviation from ideal behavior is that losses degrade the odd photon number states into both odd and even photon number states , and since a photon number state with a large number of photons is more fragile than a single - photon state , it is to be expected that a large intensity of down converted photons will lead to a less negative value of @xmath131 .",
    "short pulses must be intense in order to keep the success probability close to @xmath159 , and this explains why we do not obtain more negative values of @xmath131 than those presented in fig .",
    "[ tnp]a if the pulse duration is decreased below @xmath160 but rather observe less negative values for very short pulses .    in fig .",
    "[ tnp ] we have included an example of single pass down conversion for @xmath161 , i.e. , we have increased @xmath162 to unity without changing the rest of the parameters in table [ values ] .",
    "when the opo cavity is absent , the temporal width of the light pulse is only broadened in the filter cavity , and this broadening is small since the mean lifetime of a photon in this cavity is only @xmath163 .",
    "it is thus possible to determine from the precise apd photo detection time whether the photon pair that gives rise to the apd detection was generated in the beginning , in the middle , or in the end of the pulse . for small @xmath124",
    "this leads to a negative value of @xmath131 because we know rather precisely where the second photon in the pair is , if it has not been lost . on the other hand , if we do not discriminate between early and late trigger detection events a single optimal compromise will only have a small overlap with the actual modes , which are well localized in time .",
    "the resulting rapid increase towards positive values in @xmath131 with increasing @xmath124 can be avoided by increasing the mean lifetime of a photon in the filter cavity , corresponding to a smaller frequency width of the filter , and thus the intensity of the light transmitted through the filter will decrease , which leads to an even smaller success probability than in fig .",
    "the success probability can be increased by increasing @xmath137 , but this will also result in a less negative value of @xmath131 , and from these arguments it is preferable to apply pulsed fields and the opo cavity in the setup to get the most efficient generation of non - gaussian states for storage .",
    "the values of @xmath131 presented in fig .",
    "[ tnp]a are significantly above the theoretical minimum of @xmath164 , and we note that the results are all obtained for physical parameters , which are already achieved in experiments .",
    "more negative values of @xmath131 can be reached if it is possible to reduce the losses .",
    "if , for instance , we increase the signal channel transmission from @xmath165 to unity , @xmath131 is decreased to @xmath166 for @xmath161 , @xmath154 , and large @xmath124 , while the success probability is unchanged , and if we further assume zero loss in the cavity and reduce @xmath167 to @xmath168 , we find @xmath169 .",
    "an increase in the trigger channel transmission or in the apd detector efficiency will increase the success probability , and this increase can be transformed into a more negative value of @xmath131 by decreasing @xmath52 , @xmath137 , @xmath124 , or @xmath167 .",
    "lr a ) & +   + b ) & +   for a pulsed pump field with @xmath170 and @xmath154 .",
    "@xmath171 is chosen to coincide with the time where @xmath52 is maximal .",
    "a ) @xmath172 ( the inset is an enlarged view ) , b ) @xmath173 , and c ) @xmath140.,title=\"fig : \" ] &   for a pulsed pump field with @xmath170 and @xmath154 .",
    "@xmath171 is chosen to coincide with the time where @xmath52 is maximal .",
    "a ) @xmath172 ( the inset is an enlarged view ) , b ) @xmath173 , and c ) @xmath140.,title=\"fig : \" ]    considering the optimized mode functions for a pulsed pump field in fig .  [ mode ] , it is apparent that a fast variation in the mode function is present for small values of @xmath124 , but this variation is smoothed out for larger @xmath124 .",
    "the inset in fig .",
    "[ mode]a shows that the period of the fast variation is @xmath20 , i.e. , the round trip time in the opo cavity .",
    "a photon generated in one of the time localized modes in the opo cavity can only leave the cavity at times separated by an integer number of @xmath20 s , and thus , in the output field from the opo , the two photons in a pair are separated by an integer number of @xmath20 s . the fast variation in the optimal mode function",
    "can thus be explained from the fact that the mean lifetime of a photon in the filter cavity is smaller than @xmath20 , since this means that the observed photon in a pair is typically delayed less than @xmath20 in the filter cavity , and the detection time provides partial information on the time of generation of the photon pair .",
    "the information is erased as @xmath124 approaches @xmath20 , and this leads to the steep rise in @xmath131 towards less negative values observed for all curves to the very left in fig .",
    "[ tnp]a .",
    "if the duration of the pump pulse is short compared to @xmath20 , the optimal mode function differs qualitatively from those presented in fig .",
    "[ mode ] . in this case",
    "the optimal mode function is a series of spikes separated by @xmath20 , and the width of the spikes is determined by the width of the pump pulse provided the width of the pump pulse is also short compared to @xmath124 . in the opposite limit of a time independent pump field ,",
    "the optimal mode function for short @xmath124 is qualitatively a function , which has a maximum close to the time of the trigger detection and decays exponentially when moving to the right or left from this maximum . superimposed on this is a fast variation with period @xmath20 .",
    "the mode function is not completely symmetric around the time of the trigger detection due to the filtering . for larger values of @xmath124",
    "the fast variation disappears , and the maximum becomes more rounded .",
    "( solid line ) for @xmath150 , @xmath154 , and @xmath174 .",
    "the dotted line is the function in eq .  , while the approximation ( dashed line ) is almost indistinguishable from the optimum mode ( solid line ) in the figure .",
    "@xmath175 for the dotted line , @xmath176 for the dashed line , and @xmath177 for the solid line .",
    "]    in fig .  [ formel ]",
    "we show the temporal shape of the pump field and the optimal mode function for @xmath174 in the same graph , and it is apparent that the generated output field is both broadened and delayed due to the nonzero lifetime of a photon in the opo cavity as expected . since @xmath131 and @xmath178",
    "are both independent of @xmath124 for large @xmath124 , and since we have to choose the same mode function independent of the precise time for the apd detection , the optimal mode function is determined solely from the generated output field when @xmath124 is large , and it seems reasonable that the optimal mode function just follows the square root of the intensity distribution of the generated state . without applying the above theory , a crude guess for the optimal mode function is @xmath179 and this function , which is also shown in the figure , is actually quite close to optimal . with the above theory at hand ,",
    "however , it is easy to calculate the actual intensity distribution from eq . , and this leads to the mode function @xmath180 which is even closer to the optimal mode function . due to its simplicity , eq",
    ".   can be useful in a storage experiment , where @xmath124 must be sufficiently large to obtain a satisfactory success probability .",
    "we note , however , that neither eq .   nor eq .",
    "is able to reproduce the optimal mode function in fig .",
    "[ mode]a for @xmath172 .",
    "in conclusion , we have presented a multimode description in time domain of the optical parametric oscillator , which is valid for both pulsed and continuous - wave pump fields , and we have used the theory to analyze non - gaussian states that can be stored in atomic samples .",
    "so far light storage has been demonstrated with gaussian states only , and the storage and retrieval of a non - gaussian state is a hall mark in the demonstration of atom - light quantum interfaces .",
    "our analysis suggests that , with similar success probabilities , pulsed pump fields lead to more negative values of the wigner function of the stored state than time independent continuous - wave pump fields .",
    "an essential ingredient in the experiment is the temporal spreading induced by the opo and filter cavities , because it separates the two photons in a generated photon pair temporally by an unknown amount and ensure that it is impossible to infer the precise position of the second photon in a pair from the time at which a detection took place in the apd . without this spreading",
    "we do not obtain large negative values of @xmath131 for large @xmath124 .",
    "after having thus characterized the system and identified the optimum strategy for given setup and pulse parameters , one may now move a step further and try to design filters and pump pulses in order to generate optimal mode functions which have high non - gaussian state content and which are particularly easy to handle in the storage part of an experiment .    in the present treatment we have chosen to use the negative value attained by the wigner function as a measure of the non - classical character of the state generated , but we note that only minor changes are required in order to optimize other features as for example the single - photon or schrdinger kitten state fidelity .",
    "the authors acknowledge discussions with jonas s.neergaard-nielsen , anders s.  srensen , and eugene s.  polzik .",
    "various detector models are discussed in the literature . considering first detection in a single mode ,",
    "a detector may for instance be a photon number resolving detector or an on / off detector .",
    "the photon number resolving detector registers the number of photons in the detected mode , and the detected mode is projected onto the detected photon number state , while the on / off detector only distinguishes between the outcomes vacuum and not vacuum , and , depending on the measurement result , the detected mode is projected onto one of these subspaces .",
    "if a continuous beam of light is observed , a third detector model is often assumed , where a detection event at time @xmath27 corresponds to an annihilation of a photon in a mode of infinitesimal temporal width positioned at time @xmath27 .",
    "is derived under the assumption that a detection event is equivalent to application of the annihilation operator of the observed mode to the state of the system , but since the flux of trigger photons is small in the experiment considered in sec .",
    "iv and the possibility to have two or more photons in a trigger mode can be neglected , all three detector models lead to practically identical results .",
    "a real detector consists of a medium , which absorbs photons , and typically several different microscopic transitions in the medium are allowed .",
    "the detector is then able to detect photons in more than a single mode . in an apd",
    "a photon absorption is accompanied by an excitation of an electron from a bound state to a free or a solid state conduction band state , the signal is amplified , and the resulting photo current is measured .",
    "the information concerning the precise microscopic transition is lost in the amplification process , and , when we condition on the macroscopic detection event , we must average over all modes that could have led to the observed detection ( see @xcite ) .",
    "since the filter in front of the detector selects a narrow band of frequencies , we assume that the detector is equally sensitive to all frequencies transmitted by the filter , i.e. , the detector bandwidth is assumed to be infinitely broad compared to the filter bandwidth , and all modes are observed by the detector . in this case",
    "we should sum over a complete set of modes on the interval @xmath124 in eq .  .",
    "the obtained values of @xmath131 and @xmath178 are independent of the choice of basis which may be seen from the following argument .",
    "assume that the mode functions @xmath181 and the mode functions @xmath182 both constitute a complete basis on the time interval @xmath124 .",
    "@xmath181 and @xmath182 are related by a unitary transformation @xmath183 , which implies that the corresponding mode annihilation operators @xmath184 and @xmath185 are related by @xmath186 . if a photon is annihilated in the mode @xmath187 , the density matrix is transformed according to @xmath188 , where tr denotes the trace . to perform the averaging we multiply by the probability @xmath189 to annihilate a photon in the mode @xmath187 , and sum over all @xmath89 .",
    "after normalization this leads to @xmath190 since @xmath191 , the transformed density matrix is independent of the choice of basis , and the wigner function is then also independent of the choice of basis .",
    "it is thus not necessary to use the modes , in which the detections actually take place , and for mathematical convenience , we have chosen to sum over time localized modes in eq .  .",
    "99 m. j. collett and c. w. gardiner , phys .",
    "a * 30 * , 1386 ( 1984 ) .",
    "p. d. drummond and m. d. reid , phys .",
    "a * 41 * , 3930 ( 1990 ) .",
    "y. j. lu and z. y. ou , phys .",
    "a * 62 * , 033804 ( 2000 ) .",
    "h. h. adamyan and g. yu .",
    "kryuchkyan , phys .",
    "a * 74 * , 023810 ( 2006 ) .",
    "r. s. bennink and r. w. boyd , phys .",
    "a * 66 * , 053815 ( 2002 ) .",
    "w. wasilewski , a. i. lvovsky , k. banaszek , and c. radzewicz , phys .",
    "063819 ( 2006 ) . v. petersen , l. b. madsen , and k. mlmer , phys .",
    "a * 72 * , 053812 ( 2005 ) .",
    "a. ourjoumtsev , r. tualle - brouri , j. laurat , and p. grangier , science * 312 * , 83 ( 2006 ) .",
    "j. s. neergaard - nielsen , b. m. nielsen , c. hettich , k. mlmer , and e. s. polzik , phys .",
    "* 97 * , 083604 ( 2006 ) .",
    "k. wakui , h. takahashi , a. furusawa , and m. sasaki , opt .",
    "express * 15 * , 3568 ( 2007 ) .",
    "a. e. b. nielsen and k. mlmer , phys",
    "a * 75 * , 023806 ( 2007 ) .",
    "a. andr , m. bajcsy , a. s. zibrov , and m. d. lukin , phys .",
    "lett . * 94 * , 063902 ( 2005 ) .",
    "s. e. harris , phys . today * 50 * , no . 7 , 36 ( 1997 ) .",
    "a. e. kozhekin , k. mlmer , and e. polzik , phys .",
    "a * 62 * , 033809 ( 2000 ) .",
    "b. julsgaard , j. sherson , j. i. cirac , j. fiurek , and e. s. polzik , nature * 432 * , 482 ( 2004 ) .",
    "j. sherson , a. s. srensen , j. fiurek , k. mlmer , and e. s. polzik , phys .",
    "a * 74 * , 011802(r ) ( 2006 ) .",
    "i. novikova , a. v. gorshkov , d. f. phillips , a. s. srensen , m. d. lukin , and r. l. walsworth , phys .",
    "lett . * 98 * , 243602 ( 2007 ) .",
    "k. j. blow , r. loudon , s. j. d. phoenix , and t. j. shepherd , phys .",
    "a * 42 * , 4102 ( 1990 ) .",
    "j. s. neergaard - nielsen , b. m. nielsen , h. takahashi , a. i. vistnes , and e. s. polzik , opt .",
    "express * 15 * , 7940 ( 2007 ) .",
    "p. p. rohde and t. c. ralph , j. mod",
    ". opt . * 53 * , 1589 ( 2006 ) ."
  ],
  "abstract_text": [
    "<S> we present a multimode treatment of the optical parametric oscillator , which is valid for both pulsed and continuous - wave pump fields . </S>",
    "<S> the two - time correlation functions of the output field are derived , and we apply the theory to analyze a scheme for heralded production of non - classical field states that may be subsequently stored in an atomic quantum memory . </S>"
  ]
}