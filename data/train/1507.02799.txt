{
  "article_text": [
    "a graph ( possibly with parallel edges ) is _ @xmath8-edge - connected _ if there are @xmath8 pairwise edge - disjoint paths between every pair of its nodes .",
    "we study the following fundamental problem : given a connected undirected graph @xmath0 and a set of additional edges ( called  links \" ) @xmath1 on @xmath2 disjoint to @xmath9 , find a minimum size edge set @xmath3 so that @xmath10 is @xmath5-edge - connected .",
    "the @xmath5-edge - connected components of the given graph @xmath11 form a tree .",
    "it follows that by contracting these components , one may assume that @xmath11 is a tree .",
    "hence , our problem is :    tap is sometimes posed as the problem of covering a laminar family .",
    "namely , given a laminar family @xmath9 on a groundset @xmath2 , and an edge set @xmath1 on @xmath2 , find a minimum size @xmath3 such that for every @xmath12 , there is an edge in @xmath13 with one endpoint in @xmath14 and the other in @xmath15 .",
    "tap is also equivalent to the problem of augmenting the edge - connectivity from @xmath8 to @xmath16 for any odd @xmath8 ; this is since the family of minimum cuts of a @xmath8-connected graph with @xmath8 odd is laminar .",
    "the first @xmath5-approximation for tap was given by @xcite , where it was also shown to be apx - hard .",
    "achieving ratio below @xmath5 was posed by @xcite as one of the main open problems in connectivity augmentation .",
    "@xcite presented a @xmath17-approximation scheme for tap , but his analysis over 30 pages is long and complex . in the conference version @xcite was sketched a @xmath6-approximation algorithm for the problem . since a full proof was very complex and long ( 40 pages ) , the journal version was cut into two parts . in the first part @xcite was only proved ratio @xmath7 .",
    "an attempt to simplify the second part produced an error in @xcite .",
    "here we give a correct , different , and self contained proof of the ratio @xmath6 , that is also substantially simpler and shorter than the previous proofs .",
    "[ t : main ] tap admits a @xmath6-approximation algorithm .      in the more general weighted tap problem , the links in @xmath1 have weights and the goal is to find a minimum weight augmenting edge set @xmath13 such that @xmath18 is @xmath5-edge connected .",
    "there are several @xmath5-approximation algorithms for this problem .",
    "the first algorithm , by @xcite was simplified later by @xcite .",
    "these algorithms compute a minimum weight arborescence in a related directed graph .",
    "the primal - dual algorithm of @xcite is another combinatorial @xmath5-approximation algorithm for the problem .",
    "the iterative rounding algorithm of @xcite is an lp - based @xmath5-approximation algorithms .",
    "the approximation ratio of @xmath5 for all these algorithms is tight even for tap .",
    "breaking the ratio of @xmath5 for weighted tap is a major open problem in approximation theory . in @xcite",
    "is given an algorithm that computes a @xmath19-approximate solution for constant diameter trees .",
    "tap is apx - hard even if the set @xmath1 of links forms a cycle on the leaves of @xmath20 @xcite .",
    "a natural cut - lp for tap has integrality gap at least @xmath21 @xcite .",
    "@xcite gave ratio @xmath22 for the special case of tap when every link connects two leaves , and obtained ratio @xmath21 for this version w.r.t .",
    "a leaf edge - cover lp .",
    "@xcite showed that a slightly modified lp has integrality gap @xmath23 for tap .",
    "studying various lp - relaxations for tap is motivated by the hope that these may lead to breaking the ratio of @xmath5 for weighted tap .      in the next section  [ s : preliminaries ]",
    "we define some special types of trees and show some properties of these trees .",
    "these are needed to state our lower bound given in section  [ s : lb ] . in section  [ s : credit - algo ]",
    "we explain how we use our lower bound and describe the algorithm , relying on a certain lemma ; this lemma is proved in sections [ s : b ] and [ s : char ] .",
    "let @xmath24 be a tree",
    ". for @xmath25 let @xmath26 denote the edge in @xmath20 and @xmath27 the link in @xmath1 between @xmath28 and @xmath29 .",
    "let @xmath30 denote the path between @xmath28 and @xmath29 in @xmath20 .",
    "a link @xmath27 _ covers _ all the edges along the path @xmath31 .",
    "we designate a node @xmath32 of @xmath20 as the _ root _ , and refer to the pair @xmath33 as a _ rooted tree _",
    "( we do not mention the root when it is clear from the context ) .",
    "the choice of @xmath32 defines a partial order on @xmath2 : @xmath28 is a _ descendant _ of @xmath29 and @xmath29 is an _ ancestor _ of @xmath28 if @xmath29 belongs to @xmath34 ; if , in addition , @xmath35 , then @xmath28 is a _ child _ of @xmath29 , and @xmath29 is the _ parent _ of @xmath28 .",
    "the _ leaves _ of @xmath20 are the nodes in @xmath36 that have no descendants .",
    "we denote the leaf set of @xmath20 by @xmath37 , or simply by @xmath38 , when the context is clear .",
    "the _ rooted subtree _ of @xmath20 induced by @xmath29 and its descendants is denoted by @xmath39 ( @xmath29 is the root of @xmath39 ) . a subtree @xmath40 of @xmath20 is called a _ rooted subtree _ of @xmath20 if @xmath41 for some @xmath42 .    [ ( shadow ) ] [ d : shadow ] a link @xmath43 is a _ shadow _ of a link @xmath27 if @xmath44 .",
    "an inclusion minimal cover @xmath13 of @xmath20 is _ shadows - minimal _ if for every link @xmath45 replacing @xmath27 by any proper shadow of @xmath27 results in a set of links that does not cover @xmath20 .    every tap instance can be rendered closed under shadows by adding all shadows of existing links .",
    "we refer to the addition of all shadows as _",
    "shadow completion_. shadow completion does not affect the optimal solution size , since every shadow can be replaced by some link covering all edges covered by the shadow .",
    "thus we may assume the following .",
    "[ ass : sh - completion ] the set of links @xmath1 is closed under shadows , that is , if @xmath46 and @xmath44 then @xmath47 .",
    "the _ up - link _ @xmath48 of a node @xmath49 is the link @xmath50 such that @xmath28 is as close as possible to the root ; such @xmath28 is called the _ up - node _ of @xmath49 . under assumption",
    "[ ass : sh - completion ] , @xmath28 is unique and is an ancestor of @xmath49 . for a rooted subtree @xmath40 of @xmath20 and a node @xmath51 , we say that @xmath40 is _ @xmath49-closed _ if the up - node of @xmath49 belongs to @xmath40 ( namely , if no link incident to @xmath49 has its other endnode outside @xmath40 ) , and @xmath40 is _",
    "_ otherwise .",
    "[ ( twin link , stem ) ] [ d : twin ] a link between leaves @xmath52 of @xmath20 is a _ twin link _ if its contraction results in a new leaf ; @xmath52 are called _ twins _ and their least common ancestor @xmath53 is called a _ stem _ ( see fig .  [",
    "f : twin - lock](a ) ) .",
    "[ ( locked leaf , locking link , locking tree ) ] [ d : lock ] a leaf @xmath49 of @xmath20 is _ locked _ by a link @xmath54 , and @xmath54 is a _ locking link _ of @xmath49 if there exists a rooted proper subtree @xmath39 of @xmath20 such that @xmath55 , @xmath56 is a twin link , and @xmath39 is @xmath49-closed ; such minimal @xmath39 is called the _ locking tree _ of @xmath49 ( see fig .  [",
    "f : twin - lock](b ) ) .    note that if @xmath56 is a twin link and @xmath49 is locked by @xmath54 , then @xmath57 may be locked by @xmath58 ( see fig .",
    "[ f : twin - lock](c ) ) . in this case",
    "the locking tree of one of @xmath52 contains the other , and whenever we will use the notation as above , we will assume w.l.o.g .",
    "that the locking tree of @xmath49 contains the locking tree of @xmath57 ( see trees @xmath39 and @xmath59 in fig .",
    "[ f : twin - lock](c ) ) .    for @xmath60 and a link set @xmath13 ,",
    "let @xmath61 denote the set of links in @xmath13 that have one endpoint in @xmath62 and the other in @xmath63 ; for @xmath64 let @xmath65 be the degree of @xmath66 w.r.t .",
    "@xmath13 . for the rest of the paper we fix @xmath13 to be some optimal shadows - minimal cover of @xmath20 with maximal number of twin links .",
    "in the rest of this section we establish some properties of @xmath13 that we use later .",
    "a link @xmath67 _ overlaps _ a link @xmath68 if the paths @xmath69 have an edge in common and if one of @xmath70 belongs to @xmath71 , see fig .",
    "[ f : twin - lock](d ) .",
    "[ c : overlap ] no link in @xmath13 overlaps the other .",
    "suppose to the contrary that @xmath72 overlaps @xmath73 .",
    "if both @xmath49 and @xmath66 belong to @xmath71 then @xmath74 is a cover of @xmath20 of size smaller than @xmath75 .",
    "suppose that exactly one of @xmath70 belongs to @xmath71 , say @xmath76 and @xmath77 , see fig .",
    "[ f : twin - lock](d ) .",
    "let @xmath78 be a node in @xmath79 distinct from @xmath66 ( e.g. , @xmath78 may be the first node of @xmath71 when we traverse @xmath80 from @xmath49 to @xmath66 ) .",
    "then @xmath81 is a proper shadow of @xmath68 and @xmath81 covers the edges of @xmath80 that are not covered by @xmath67 . replacing @xmath68 by its proper shadow @xmath81 results in a cover of @xmath20 , contradicting shadows - minimality of @xmath13 .",
    "[ c : shm ] @xmath82 for every leaf @xmath83 of @xmath20 .    if @xmath84 are two links incident to the same leaf @xmath49 of @xmath20 , then one of them overlaps the other , contradicting claim  [ c : overlap ] .",
    "[ c : twins ] let @xmath52 be twins with stem @xmath53 , let @xmath85 be the subtree of @xmath20 rooted at @xmath53 , and let @xmath86 be the set of links in @xmath13 with at least one endnode in @xmath87 .",
    "then either @xmath88 for some @xmath89 , or @xmath90 for some @xmath91 .",
    "suppose that @xmath92 .",
    "every link that covers the parent edge of @xmath53 belongs to @xmath86 , thus @xmath93 .",
    "consider any link @xmath94 with @xmath95 .",
    "then @xmath56 overlaps @xmath96 , unless @xmath97 .",
    "there can not be another link @xmath98 , since then one of @xmath99 overlaps the other .",
    "consequently , @xmath13 contains a unique link @xmath100 , as claimed .",
    "suppose now that @xmath101 .",
    "let @xmath68 and @xmath67 be the ( unique , by claim  [ c : shm ] ) link incident to @xmath49 and @xmath57 , respectively .",
    "one of @xmath102 is not in @xmath87 , say @xmath103 ; otherwise @xmath104 is a cover of @xmath20 of size smaller than @xmath75 .",
    "we can not have @xmath105 since then @xmath106 is a shadows - minimal cover of @xmath20 of size @xmath75 with more twin links than @xmath13 , contradicting our choice of @xmath13",
    ". there can not be another link in @xmath86 since then it will be overlapped by one of @xmath84 .",
    "[ c : lock - ok ] consider a locked leaf @xmath49 and its locking tree @xmath39 as in definition  [ d : lock ] , and suppose that @xmath73 for some @xmath107 .",
    "then @xmath66 is a proper ancestor of the least common ancestor @xmath28 of @xmath108 and @xmath109 .",
    "furthermore , there is a link @xmath110 such that @xmath111 and @xmath112 is not a locked leaf .",
    "let @xmath67 and @xmath113 be the ( unique , by claim  [ c : shm ] ) links in @xmath13 incident to @xmath57 and to @xmath114 , respectively .",
    "we start by refuting the case that one of @xmath102 belongs to @xmath115 . by claim  [ c : twins ] , @xmath91 . if one of @xmath102 belongs to @xmath116 ( see fig .",
    "[ f : lock - ok](a ) ) , then one of @xmath84 overlaps the other , contradicting claim  [ c : overlap ] .",
    "suppose that @xmath66 belongs to @xmath117 , see fig .",
    "[ f : lock - ok](b ) ; refuting the case @xmath118 is similar .",
    "note that any link with exactly one endnode in @xmath119 overlaps @xmath68 .",
    "thus @xmath113 has both endnodes in @xmath119 .",
    "the link @xmath120 that covers the edge between @xmath66 and its child also has both endnodes in @xmath119 .",
    "thus we must have @xmath121 , by the optimality of @xmath13 ; otherwise @xmath122 is a cover of @xmath20 of size @xmath123 ( @xmath124 is a shadow of an existing link @xmath54 ) .",
    "but then @xmath125 ( see fig .",
    "[ f : lock - ok](c ) ) is a cover of @xmath20 of size @xmath75 with more twin links than @xmath13 ( @xmath126 is a shadow of an existing link @xmath54 ) .",
    "furthermore , @xmath86 can be modified to be shadows - minimal and/or smaller by replacing every link @xmath127 with @xmath128 and @xmath129 ( if any ) by the link @xmath130 and removing redundant links .",
    "this contradicts our choice of @xmath13 .    since @xmath131 , and",
    "since @xmath39 is @xmath49-closed , @xmath66 is a proper ancestor of @xmath28 .",
    "we must have that @xmath132 , as otherwise one of @xmath84 overlaps the other ; see fig .",
    "[ f : lock - ok](d ) .",
    "consider a link @xmath133 that covers the edge between @xmath66 and its parent , where @xmath134 and @xmath135 .",
    "note that @xmath136 , by claim  [ c : shm ] .",
    "we must have @xmath137 , as otherwise , @xmath138 overlaps @xmath68 or @xmath54 .",
    "any rooted subtree that is @xmath112-closed contains @xmath139 , and thus has at least @xmath140 leaves if @xmath112 is a leaf .",
    "hence @xmath112 can not be a locked leaf .",
    "let @xmath14 denote the set of stems of @xmath20 and let @xmath141 .",
    "[ l : lb ] let @xmath142 be the set of twin and locking links , @xmath143 a maximum matching in @xmath144 , and @xmath145 the set of leaves unmatched by @xmath143 .",
    "let @xmath146 and let @xmath147 .",
    "let @xmath148 be the set of links in @xmath13 not incident to a locked leaf .",
    "then : @xmath149    define a weight function @xmath150 on @xmath151 by : @xmath152 we prove the following two inequalities , that imply inequality ( [ e : lb ] ) : @xmath153    we prove ( [ e : f1 ] ) .",
    "assign @xmath21 tokens to every @xmath154 , so there are @xmath155 tokens .",
    "we will show that these tokens can be reassigned such that : every link in @xmath156 keeps its @xmath21 tokens , every link in @xmath157 gets @xmath5 tokens , every link in @xmath158 keeps @xmath159 token from its @xmath21 initial tokens , and every @xmath160 gets @xmath161 token for each link in @xmath148 incident to @xmath66 .",
    "such an assignment is achieved as follows . for every @xmath154 ,",
    "move @xmath161 token from the @xmath21 tokens of @xmath120 to each _ non - leaf _ endnode of @xmath120 , if any .",
    "note that every link in @xmath162 keeps its @xmath21 tokens , since no token is moved to leaves .",
    "in particular , every link @xmath163 keeps its @xmath21 tokens .",
    "we will assign to each @xmath163 additional @xmath161 token moved earlier to some non - leaf node by some other link , as follows .    *",
    "suppose that @xmath120 is a twin link with stem @xmath53 . by claim  [ c : twins ]",
    ", there is a unique link in @xmath13 incident to @xmath53 , hence @xmath53 has @xmath161 token from this link .",
    "this @xmath161 token is moved to @xmath120 to a total of @xmath5 tokens .",
    "note that after this @xmath53 has @xmath164 tokens . *",
    "suppose that @xmath120 is a locking link of a leaf @xmath49 . by claim [ c : shm ]",
    "there is a unique link @xmath73 incident to @xmath49 , and @xmath160 , by claim  [ c : lock - ok ] ; hence @xmath66 has @xmath161 token from this link .",
    "this @xmath161 token is moved to @xmath120 to a total of @xmath5 tokens .",
    "note that after this @xmath66 has no tokens from the link @xmath68 ( but @xmath66 still has @xmath161 token from some other link @xmath165 , by claim  [ c : lock - ok ] ) .",
    "we prove ( [ e : f2 ] ) .",
    "consider the graph @xmath166 and the graph @xmath167 obtained from @xmath11 by removing the endnodes of the links in @xmath168 . since @xmath143 is a maximum matching in @xmath11 and since @xmath169 , @xmath170 is a maximum matching in @xmath167 . on the other hand , by the definition of @xmath168 , no link in @xmath171 has a common endnode with a link in @xmath168 , and thus @xmath171 is a matching in @xmath167 .",
    "this implies @xmath172 , and since @xmath169 we get : @xmath173 by claim  [ c : shm ] , @xmath162 is a matching , hence by the definition of @xmath150 we have : @xmath174 combining with @xmath175 and observing that @xmath176 we get @xmath177 as claimed in ( [ e : f2 ] ) .    we prove the following statement that implies theorem  [ t : main ] .",
    "[ t : main+ ] there exists a polynomial time algorithm that given an instance of tap computes a solution @xmath178 of size at most the right hand side of ( [ e : lb ] ) .",
    "thus @xmath179 .",
    "we now explain how we use the lower bound ( [ e : lb ] ) .",
    "we view the lower bound as a credit which we can spend for adding links to a partial solution @xmath178 .",
    "initially , the algorithm assigns units of credit to nodes of @xmath20 and links in @xmath143 according to the four parts of the lower bound .",
    "we call these credit units _ coupons _ and _ tickets _ , where each ticket worth half coupon .",
    "the initial credit distribution is as follows :    * @xmath21 coupons to every link @xmath180 and @xmath159 coupon to every unmatched leaf @xmath181 .",
    "* @xmath159 ticket to every link @xmath182 and @xmath183 tickets to every node @xmath160 .",
    "the main difference between coupons and tickets is as follows .",
    "the location of coupons is known to us right after the matching @xmath143 is computed .",
    "the location of tickets depends on @xmath13 , which is not known to us , hence to `` claim '' a ticket , we will need to prove its existence .",
    "to _ contract _ a subtree @xmath40 of @xmath20 is to combine all nodes in @xmath40 into a single node @xmath29 .",
    "the edges and links with both endpoints in @xmath40 are deleted .",
    "the edges and links with one endpoint in @xmath40 now have @xmath29 as their new endpoint . among any set of parallel links ,",
    "if any , only one link is kept .",
    "we refer to the nodes created by contraction as _ compound nodes _ ; compound nodes always own @xmath159 coupon . for technical reasons ,",
    "@xmath32 is also considered as a compound node .",
    "non - compound nodes of @xmath184 are referred to as _",
    "original nodes_. if we add a link @xmath27 to a partial solution @xmath178 , then the nodes along the path @xmath31 belong to the same 2-edge - connected component of the augmented graph @xmath185 . hence , we may contract some or all the edges of @xmath31 . for a set of links @xmath186 ,",
    "let @xmath184 denote the tree obtained by contracting every 2-edge - connected component of @xmath187 into a single node .",
    "we refer to the contraction of every @xmath5-edge - connected component of @xmath187 into a single node simply as the contraction of the links in @xmath178 .",
    "let @xmath40 be a subtree of @xmath184 .",
    "for a set @xmath63 of links we use the notation @xmath188 or @xmath189 to denote the set of the links in @xmath63 with both ends in @xmath40 .",
    "if @xmath63 is a set of nodes , then a similar notation is used to denote the set of the nodes in @xmath63 that belong to @xmath40 .",
    "we use the following notation for the credit distributed in @xmath40 :    * @xmath190 denotes the total number of coupons owned by @xmath40 : @xmath159 coupon for every unmatched leaf and every compound node of @xmath40 , and @xmath21 coupons for every link in @xmath191 .",
    "* @xmath192 denotes the number of tickets in @xmath40 . * @xmath193 .",
    "the algorithm maintains the following invariant .",
    "[ ( credit invariant ) ] [ inv : coupons ]     * every unmatched leaf and every ( unmatched ) compound node of @xmath184 ( including @xmath32 ) owns @xmath159 coupon , and every link in @xmath143 owns @xmath21 coupons . *",
    "every link in @xmath168 has a ticket , every original node @xmath160 of @xmath184 has @xmath183 tickets , and compound nodes have no tickets .",
    "the algorithm starts with a partial solution @xmath194 and with @xmath195 being the right - hand side of ( [ e : lb ] ) plus @xmath159 .",
    "it iteratively finds a subtree @xmath40 of @xmath184 and a cover @xmath196 of @xmath40 , and _",
    "contracts @xmath40 with @xmath196 _ , which means the following : add @xmath196 to @xmath178 , contract @xmath40 , and assign @xmath159 coupon ( and @xmath164 tickets ) to the new compound node . to use the notation @xmath184 properly , we will assume that @xmath196 is an _ exact cover _ of @xmath40 , namely , that the set of edges of @xmath184 that is covered by @xmath196 equals the set of edges of @xmath40 ( this is possible due to shadow completion ) .",
    "let us say that a contraction of @xmath40 with @xmath196 is _ legal _ if @xmath197 .",
    "this means that the set @xmath196 of links added to @xmath178 and the @xmath159 coupon assigned to the new compound node are paid by the total credit in @xmath40 .",
    "the credit of @xmath40 is not reused in any other way , since the only credit the new compound node has is the @xmath159 coupon assigned to it , and it has no tickets .",
    "we do only legal contractions , which implies that at any step of the algorithm @xmath198 thus at the last iteration , when @xmath184 becomes a single compound node , @xmath199 is at most the right - hand side of ( [ e : lb ] ) .",
    "we now describe two legal contractions of @xmath40 with @xmath196 that rely on coupons only .    [",
    "( greedy contractions ) ] the following two types of contractions of @xmath40 with @xmath196 are called _ greedy contractions _ :    * _ greedy locking tree contraction _ : here @xmath40 is a locking tree of @xmath49 ( as in definition  [ d : lock ] ) , @xmath108 are all unmatched by @xmath143 , and @xmath200 ; furthermore , if @xmath57 is also a locked leaf then @xmath40 contains the locking tree of @xmath57 ( see fig .  [",
    "f : twin - lock](c ) where the locking tree @xmath39 of @xmath49 contains the locking tree @xmath201 of @xmath57 ) . note that @xmath196 indeed covers @xmath40 and that @xmath202 , hence this contraction is legal .",
    "* _ greedy link contraction _ : here @xmath203 for some @xmath46 where @xmath204 are unmatched leaves of @xmath184 , and @xmath205 .",
    "note that @xmath206 , hence this contraction is legal .",
    "the first step of our algorithm is exhausting all greedy locking tree contractions .",
    "we now describe a more complicated type of legal contraction used in @xcite ( but our definitions are slightly different ) . for a node set @xmath207 , we let @xmath208",
    ". a rooted subtree @xmath40 of @xmath20 is _ @xmath145-closed _ if there is no link in @xmath1 from @xmath209 to @xmath210 .",
    "@xmath40 is _ leaf - closed _ if it is @xmath37-closed .",
    "a leaf - closed @xmath40 is _ minimally leaf - closed _ if any proper rooted subtree of @xmath40 is not leaf - closed .",
    "[ ( @xmath143-compatible tree , semi - closed tree ) ] [ d : semi - closed ] let @xmath143 be a matching on the leaves of @xmath184 .",
    "a subtree @xmath40 of @xmath184 is _",
    "@xmath143-compatible _ if for any @xmath211 either both @xmath212 belong to @xmath40 , or none of @xmath212 belongs to @xmath40 .",
    "a rooted subtree @xmath40 of @xmath184 is _ semi - closed _",
    "@xmath143 ) if it is @xmath143-compatible and closed w.r.t .",
    "its unmatched leaves .",
    "@xmath40 is _ minimally semi - closed _",
    "if @xmath40 is semi - closed but any proper subtree of @xmath40 is not semi - closed .    for a semi - closed tree @xmath40",
    "let us use the following notation :    * @xmath213 is the set of links in @xmath143 with both endnodes in @xmath40 .",
    "* @xmath214 is the set of unmatched leaves of @xmath40 .",
    "[ l : up ] if @xmath40 is minimally semi - closed then @xmath215 is an exact cover of @xmath40 .",
    "let @xmath216 be obtained from @xmath40 by contracting @xmath217 .",
    "note that @xmath218 . otherwise , if @xmath216 has a leaf @xmath49 that is not a leaf of @xmath40 , then the subtree of @xmath40 that was contracted into @xmath49 is a semi - closed tree ( with no unmatched leaves ) , contradicting the minimality of @xmath40 .",
    "note also that @xmath216 is minimally leaf - closed , since @xmath40 is minimally semi - closed .",
    "@xcite proved that if @xmath216 is a minimally leaf - closed tree then @xmath219 is an exact cover of @xmath216 .",
    "thus @xmath220 is an exact cover of @xmath216 ( if @xmath40 has no unmatched leaves then @xmath216 is a single node ) . as a link in @xmath217",
    "can cover only edges in @xmath40 , the statement follows .",
    "thus a minimally semi - closed tree admits a cover of size @xmath221 .",
    "this motivates the following definition .",
    "[ ( deficient tree ) ] a semi - closed tree @xmath40 is _ deficient _ if + @xmath222 .",
    "recall that for a cover @xmath196 of a subtree @xmath40 of @xmath184 , _ contracting @xmath40 with @xmath196 _ means that we add @xmath196 to @xmath178 , contract @xmath40 , and assign @xmath159 coupon to the new compound node .",
    "the main actions taken by our algorithm can be summarized as follows .",
    "[ ( partial solution invariant ) ] [ inv : i ] the partial solution @xmath178 is obtained by initially exhausting greedy locking tree contractions , and then sequentially applying a greedy link contraction , or contracting a semi - closed tree with an exact cover .    in the next sections we prove the following key lemma .",
    "[ l : b ] suppose that the credit invariant and the partial solution invariant hold for @xmath20 , @xmath143 , and @xmath178 ( in particular , greedy locking tree contractions were initially exhausted ) , that @xmath143 has no twin links and no locking links , and that @xmath184 has no greedy link contraction .",
    "then there exists a polynomial time algorithm that finds a non - deficient semi - closed tree @xmath40 of @xmath184 and an exact cover @xmath223 of @xmath40 of size @xmath224 .",
    "algorithm tree - cover ( algorithm  [ alg : f ] ) initiates @xmath225 as a partial cover .",
    "it computes a maximum matching @xmath143 in @xmath144 and distributes coupons as described in credit invariant  [ inv : coupons](i ) .",
    "then it exhausts greedy locking tree contractions . in the main loop ,",
    "the algorithm iteratively exhausts greedy link contractions , then finds @xmath226 as in lemma  [ l : b ] , and contracts @xmath40 with @xmath196 .",
    "the stopping condition is when @xmath178 covers @xmath20 , namely , when @xmath184 is a single node .",
    "* initialize : * @xmath225 + @xmath227 maximum matching in @xmath144 .",
    "+ assign @xmath159 coupon to every unmatched leaf and to @xmath32 , and @xmath21 coupons to every link in @xmath143 .",
    "+ exhaust greedy locking tree contractions .",
    "+    it is easy to see that all the steps in the algorithm can be implemented in polynomial time and that during the algorithm the credit invariant and the partial solution invariant hold for @xmath20 , @xmath143 , and @xmath178 .",
    "the credit scheme used implies that the algorithm computes a solution @xmath178 of size at most @xmath6 times the right - hand size of  ( [ e : lb ] ) .",
    "hence it only remains to prove lemma  [ l : b ] , which is done in the rest of the paper .",
    "we note that our paper uses the main idea of a correct and relatively simple proof of the @xmath7 ratio in @xcite .",
    "in fact , a slight modification of this algorithm gives ratio @xmath23 , see @xcite .",
    "however , the proof of the @xmath6 ratio is much more involved , and we mention the relation of our current paper to the previous incomplete / incorrect proofs of the @xmath6 ratio @xcite and @xcite , which are co - authored by the authors of the current paper . one major difference is the definition of a locked leaf . without going into details , the @xcite definition of locked leaf leads to several additional complex structures and definitions , and to an exhaustive case analysis of many deficient minimally semi - closed trees with @xmath228 , @xmath140 , and @xmath229 leaves . in this paper",
    "we essentially have just one deficient tree  with @xmath228 leaves ; two additional @xmath140-leaf trees are reduced to the @xmath228-leaf case .",
    "while we do not see an explicit mistake in the @xcite proof line , our attempt to write a full version resulted in a very complex paper with more than 40 pages .",
    "on the other hand , the locked leaf definition in @xcite is erroneous , as it leads to an improper claiming of tickets , as was brought to our attention recently by @xcite .",
    "this also leads to an additional error of not using the term @xmath230 in the lower bound , while it is essential for the proof of the @xmath6 ratio .",
    "additional simplifications in our current paper are : a simpler proof of the lower bound , a much easier case analysis than in the @xcite full draft , removal of various greedy steps and preprocessing reductions , and more .",
    "to prove lemma  [ l : b ] we will give a characterization of deficient trees , by establishing that @xmath40 is deficient iff the graph formed by @xmath40 and the links in @xmath13 that have an endnode in @xmath40 has a certain `` bad '' structure .",
    "but even having such a characterization does not achieve the goal of lemma  [ l : b ] .",
    "one reason is that this characterization depends on @xmath13 , so we are not able to recognize in polynomial time whether a given @xmath40 is indeed deficient .",
    "we thus classify a tree @xmath40 as `` dangerous '' if @xmath40 and the links in @xmath1 incident to nodes of @xmath40 contain such a `` bad '' structure ; thus a non - dangerous tree can not be deficient .",
    "let @xmath40 be a semi - closed tree with root @xmath29 .",
    "in addition to the notation @xmath231 established in the previous section , let us use the following notation :    * @xmath232 is the set of _ non - leaf _ compound nodes of @xmath40 ( this includes @xmath32 , if @xmath233 ) .",
    "* @xmath234 is the set of leaves of @xmath40 .",
    "* @xmath235 is the set of stems of @xmath40 .",
    "we consider the following family of semi - closed trees , that can be recognized in polynomial time , and ( as we will show ) includes the deficient trees .",
    "[ ( dangerous tree ) ] [ d : dangerous ] a semi - closed tree @xmath40 is called _ dangerous _ if @xmath236 , @xmath237 , and one of the following holds :    * @xmath238 , @xmath239 , and @xmath40 is as in fig .",
    "[ f : def](a ) with the links depicted present  in  @xmath1 .",
    "namely , if @xmath49 is the unmatched leaf of @xmath40 , then there exists an ordering @xmath212 of the matched leaves of @xmath40 such that @xmath240 , the contraction of @xmath58 does not create a new leaf , and @xmath40 is @xmath57-open .",
    "if such an ordering @xmath212 is not unique ( namely , if also @xmath241 , the contraction of @xmath56 does not create a new leaf , and @xmath40 is @xmath114-open  see fig .",
    "[ f : def](b ) ) , then we will assume that the up - node of @xmath57 is an ancestor of the up - node of @xmath114 .",
    "* @xmath242 , @xmath243 , say @xmath244 , exactly one of the twins of @xmath53 is matched by @xmath143 , and the tree @xmath245 obtained from @xmath40 by contracting the twin link of @xmath53 is a @xmath228-leaf dangerous tree , see fig .",
    "[ f : def](c , d , e ) .    in section  [",
    "s : char ] we will prove the following key statement .    [",
    "l : char ] under the assumptions of lemma  [ l : b ] , any deficient tree is dangerous .",
    "note that a dangerous tree @xmath40 may _ not _ be deficient .",
    "e.g. , if @xmath40 is a @xmath228-leaf dangerous tree as in fig .",
    "[ f : def](a ) , then we may have that @xmath246 ; in this case , @xmath40 is dangerous ( if the links in in fig .",
    "[ f : def](a ) present in @xmath1 ) but @xmath40 is not deficient ( since @xmath40 has a ticket at @xmath29 , and thus @xmath247 , while @xmath248 ) .",
    "the property of @xmath228-leaf dangerous trees that we will use is that the links @xmath58 and @xmath249 with @xmath250 _ exist in @xmath1 _ , but we do not care whether they belong to @xmath13 or not .",
    "note that the property of a tree being dangerous depends only on the structure of the tree and existence / absence of certain links in @xmath1 and @xmath143 , and thus can be tested in polynomial time .",
    "if we find a minimally semi - closed tree that is not dangerous then we are fine .",
    "however , it might happen that all minimally semi - closed trees are dangerous ( and they even may be all deficient ) . using the structure of dangerous trees that guarantees existence of certain links that go `` outside '' @xmath40 , we will show in the next section how to find a non - minimal semi - closed tree @xmath40 that still admits a relatively small cover of size @xmath221 , but is not dangerous .",
    "we use lemma  [ l : char ] to prove lemma  [ l : b ] , by showing that if all minimally semi - closed trees are dangerous , then we can find a non - minimal non - deficient semi - closed tree @xmath40 and its exact cover @xmath196 such that @xmath224 .",
    "let @xmath251 denote the family of minimally semi - closed subtrees of @xmath184 . clearly , the trees in @xmath251 are pairwise node disjoint , and can be found in polynomial time , since every @xmath252 is a rooted subtrees of @xmath184 , and since we can check polynomial time whether a subtree of @xmath184 is semi - closed .",
    "we also can check in polynomial time whether a member of @xmath251 is dangerous .",
    "if there is @xmath253 that is not dangerous , then @xmath40 is not deficient , so @xmath40 and @xmath254 satisfy the requirement of lemma  [ l : b ] .",
    "thus we will assume that all the trees in @xmath251 are dangerous .",
    "we will show that then algorithm  [ alg : tf ] finds a non - deficient semi - closed tree @xmath40 and its exact cover @xmath196 such that @xmath224 .    in algorithm  [ alg : tf ]",
    "we define a new tree @xmath255 obtained from @xmath184 by contracting the twin link in every @xmath140-leaf tree @xmath252 ; this transforms every such @xmath256 into a @xmath228-leaf dangerous tree @xmath257",
    ". then we _ temporarily consider _ a matching @xmath258 on the leaves of @xmath255 obtained from @xmath143 by replacing the link @xmath54 by the link @xmath58 in each @xmath228-leaf dangerous tree .",
    "we emphasize that @xmath258 is considered only for the purpose of finding the pair @xmath226 , but we _ do not replace @xmath143 by @xmath258_. note that the property of a tree being semi - closed or dangerous depends on the matching . in",
    "what follows , `` dangerous '' always means w.r.t . the matching @xmath143 ; for `` semi - closed '' the default matching is @xmath143 , and we will specify each time when a tree is semi - closed w.r.t . the matching @xmath258 .",
    "let @xmath259 be the link set obtained by picking for every @xmath140-leaf tree @xmath252 the twin - link of the stem of @xmath256 ( see fig .",
    "[ f : d](a ) ) .",
    "+ let @xmath260 be obtained from @xmath184 by contracting every link in @xmath259 , and let @xmath261 be the set of subtrees of @xmath255 that correspond to @xmath251 ( see fig .",
    "[ f : d](b ) ) .",
    "@xmath262 comment : no link in @xmath143 is contracted , and @xmath143 is a matching on the leaves of @xmath255 .",
    "every @xmath263 is a @xmath228-leaf dangerous tree , by the definition of a @xmath140-leaf dangerous tree .",
    "+ let @xmath258 be obtained from @xmath143 by `` switching '' the link @xmath264 by the link @xmath265 in every @xmath263 ( see fig .",
    "[ f : d](c ) ) , where @xmath108 are as in definition  [ d : dangerous](i ) . @xmath262",
    "comment : @xmath258 is also a matching on the leaves of @xmath255 .",
    "+ let @xmath245 be a minimally semi - closed tree in @xmath255 w.r.t .",
    "@xmath258 ( see the trees @xmath266 and @xmath267 in fig .",
    "[ f : d](c ) ) . + let @xmath268 , where @xmath269 is the set of @xmath258-unmatched leaves of @xmath245 .",
    "+ let @xmath270 be the set of twin links in @xmath259 contained in the leaves of @xmath245 , and let @xmath40 be obtained from @xmath245 by `` uncontracting '' the links in @xmath270 ( see fig .",
    "[ f : d](d ) ) .",
    "+    we prove that the pair @xmath226 computed by the algorithm satisfies the following :    * @xmath40 is semi - closed and not dangerous ( thus @xmath271 ) . * @xmath196 is an exact cover of @xmath40 of size @xmath224 .",
    "consider the tree @xmath245 and its cover @xmath272 computed at lines 4 and 5 of the algorithm .",
    "[ c : larger - tree ] suppose that @xmath245 contains a @xmath228-leaf dangerous tree @xmath273 with leaves @xmath108 as in definition  [ d : dangerous ] .",
    "if @xmath245 is @xmath57-closed , then @xmath245 is not dangerous .",
    "note that no @xmath140-leaf dangerous tree has a @xmath228-leaf dangerous tree as a rooted subtree .",
    "this is since a @xmath140-leaf dangerous tree has a stem , while a @xmath228-leaf dangerous tree has no stems .",
    "thus if @xmath245 has at least @xmath140 leaves then @xmath245 is not dangerous . if @xmath245 has @xmath228 leaves , then the leaf set of @xmath245 and @xmath273 coincide .",
    "thus the only possibility for @xmath245 to be dangerous is if we are in the case of fig .",
    "[ f : def](b ) .",
    "however , in definition  [ d : dangerous](i ) we assume that the up node of @xmath57 is an ancestor of the up - node of @xmath114 , which implies that @xmath40 is both @xmath57-closed and @xmath114-closed .",
    "thus @xmath245 is not dangerous .",
    "[ c : disjoint ] for any @xmath263 , either @xmath245 properly contains @xmath257 or @xmath274 are node disjoint .",
    "furthermore , if @xmath245 contains some @xmath275 then @xmath245 is not dangerous .",
    "as @xmath274 are rooted subtree of @xmath255 , they are either node disjoint or one of them contains the other .",
    "assume that @xmath274 are not node disjoint .",
    "then they share a leaf .",
    "suppose that the dangerous tree @xmath257 and its leaves @xmath108 are as in definition  [ d : dangerous](i ) .",
    "note that we must have @xmath276 , since @xmath277 or @xmath278 implies @xmath279 ( since @xmath280 and since @xmath245 is semi - closed w.r.t .",
    "@xmath258 ) , hence the least common ancestor of @xmath281 , and all its descendants also belong to @xmath245 . since @xmath245 is @xmath57-closed and @xmath257 is @xmath57-open , @xmath245 properly contains @xmath257 .",
    "the second statement follows from claim  [ c : larger - tree ] and the fact that every @xmath263 is a @xmath228-leaf dangerous tree .",
    "let @xmath282 be defined by @xmath283 if @xmath284 and @xmath285 otherwise , where @xmath286 is as in line  3 in algorithm  [ alg : tf ] .",
    "since the trees in @xmath261 are pairwise node disjoint , @xmath287 is a bijection .",
    "now we prove the following .",
    "[ c : f ] for any @xmath180 , either each of @xmath288 has both endnodes in @xmath245 , or none of @xmath288 has an endnode in @xmath245 ; thus @xmath245 is @xmath143-compatible .",
    "let @xmath180 .",
    "if @xmath285 then the statement holds , so assume that @xmath289 is as in line  3 in algorithm  [ alg : tf ] , and @xmath263 is the corresponding @xmath228-leaf tree with leaves @xmath108 .",
    "by claim  [ c : disjoint ] , either @xmath245 properly contains @xmath257 , or @xmath274 are node disjoint . in the former case ,",
    "each of @xmath288 has both endnodes in @xmath245 , while in the later case none of @xmath288 has an endnode in @xmath245 .",
    "in particular , any @xmath180 either has both endnodes in @xmath245 or has no endnode in @xmath245 ; hence @xmath245 is @xmath143-compatible .",
    "[ c : size ] @xmath245 is semi - closed ( w.r.t . to @xmath143 ) , @xmath272 is an exact cover of @xmath245 , and @xmath290 .    by claim",
    "[ c : f ] , @xmath245 is @xmath143-compatible . hence to show that @xmath291 is semi - closed we need to show that @xmath245 is @xmath49-closed for any its leaf @xmath49 unmatched by @xmath143 .",
    "if @xmath49 is unmatched by @xmath258 , then this is so since @xmath291 is semi - closed w.r.t .",
    "@xmath258 . otherwise , @xmath49 is a leaf in a @xmath228-leaf dangerous tree @xmath257 as in definition  [ d : dangerous](i ) , and @xmath245 contains @xmath257 , by claim  [ c : disjoint ] .",
    "as @xmath257 is @xmath49-closed , so is @xmath245 .",
    "applying lemma  [ l : up ] on @xmath245 and @xmath258 , we get that @xmath272 is an exact cover of @xmath245 .",
    "the equality @xmath290 follows from claim  [ c : f ] .",
    "now let us consider the pair @xmath226 returned by the algorithm . recall that @xmath245 is obtained from @xmath40 by contracting the links in @xmath270 , where @xmath270 is the set of links in @xmath259 with both endnodes in @xmath40 .",
    "@xmath40 is semi - closed and not dangerous .",
    "since @xmath245 is semi - closed , so is @xmath40 .",
    "this implies that @xmath40 contains some @xmath292 , hence @xmath245 contains @xmath273 . by claim  [ c : disjoint ] , @xmath245 is not dangerous .",
    "this implies that @xmath40 is not dangerous .",
    "@xmath196 is an exact cover of @xmath40 of size @xmath224 .    by lemma  [ l :",
    "up ] , @xmath272 is an exact cover of @xmath245 , and @xmath245 is obtained from @xmath40 by contracting @xmath270 . thus @xmath293 is an exact cover of @xmath40 . to see that @xmath224 , note that by claim  [ c : size ] @xmath294 , and that @xmath295 , since the contraction of every link in @xmath270 does not change @xmath296 but reduces @xmath297 by @xmath159 .",
    "thus @xmath298 as claimed .",
    "the proof of lemma  [ l : b ] is now complete .",
    "it remains only to prove lemma  [ l : char ] .",
    "the proof of lemma  [ l : char ] is long and non - trivial , so we will give its intuitive overview .",
    "let @xmath40 be a semi - closed tree with root @xmath29 .",
    "in addition to the notation @xmath299 established in previous sections , let @xmath300 denote the set of ( original ) nodes in @xmath62 that belong to @xmath40 , and let @xmath301 note that by claim  [ c : twins ] @xmath302 and that @xmath303 for every @xmath304 .",
    "let us focus on the main case @xmath237 .",
    "then @xmath40 can not have a ticket , since the unique link in @xmath217 already carries a surplus of @xmath161 credit unit , and any ticket gives another @xmath161 extra credit .",
    "furthermore , we will show that for any @xmath308 , @xmath309 implies @xmath310 , hence in the case @xmath237 we do not need to worry about links incident to locked leaves ( since just one ticket makes @xmath40 non - deficient ) .",
    "we will show that deficient trees with @xmath237 are `` small ''  have at most @xmath140 leaves . to establish this , we look at the links that cover the set @xmath311 of the unmatched leaves of @xmath40 .",
    "no such link connects two leaves in @xmath311 , as we assume that all greedy link contractions are exhausted .",
    "thus there are at least @xmath297 such links .",
    "each of these links has both endnodes in @xmath40 , since @xmath40 is @xmath311-closed .",
    "in addition , there is a link that covers the edge between the root @xmath29 of @xmath40 and the parent of @xmath29 .",
    "this link has no endnode in @xmath311 , since @xmath40 is @xmath311-closed .",
    "we thus have a set of @xmath312 links that have an endnode in @xmath313 . to avoid a ticket",
    ", such links can not have an endnode in @xmath314 .",
    "it follows therefore that each of these @xmath312 links is incident to a node in @xmath315 , where @xmath54 is the unique link in @xmath217 .",
    "however , @xmath316 for every node @xmath317 ( by claims [ c : shm ] and [ c : twins ] ) , so we get that @xmath318 , and thus @xmath319 .    note that every stem has a leaf matched by @xmath143 , hence @xmath320",
    ". we will show that if @xmath321 then @xmath322 , which gives us a ticket .",
    "consequently , we get that @xmath323 .",
    "this implies @xmath324 , and since @xmath325 , we get that @xmath326 , and if @xmath242 then @xmath243 .",
    "we will show that contracting the twin link of the stem of a @xmath140-leaf deficient tree results in a @xmath228-leaf deficient tree , and we pin down how @xmath228-leaf deficient trees with @xmath237 look like .",
    "finally , we will exclude the case @xmath327 by showing that in this case @xmath40 must have a compound node .",
    "the rest of this section is organized as follows . in the next section  [ ss : tickets ]",
    "we will explain how we claim tickets .",
    "then in section  [ ss : m - inv ] we will derive some properties of @xmath40 , and show that either @xmath329 , or @xmath237 , @xmath330 , and @xmath331 , see lemma  [ l:3-lvs ] . in section  [ ss : char ] we finish the proof of lemma  [ l : char ] .",
    "we first show that if @xmath237 then @xmath332 and thus @xmath326 , see claim  [ c : s ] .",
    "then we prove that if @xmath333 then @xmath40 is dangerous . finally , we refute the cases @xmath327 and @xmath328 .      in order to prove lemma  [ l : char ] we will exclude some trees @xmath40 by claiming that @xmath40 has tickets .",
    "note that we do not need to specify the node or the link on which the ticket is claimed .",
    "all we care about is that @xmath40 has a ticket , for _ any _ possible choice of @xmath13 . to claim a ticket in a rooted subtree @xmath40 of @xmath184",
    ", we prove that for _ any _ choice of @xmath13 , one of the following must hold :    * _ @xmath168-ticket _ : there is a link @xmath211 with @xmath334 such that each of @xmath212 is an endnode of a twin link in @xmath13 ( see fig .",
    "[ f : nx](a ) ) ; note that indeed @xmath335",
    "( @xmath168 is defined in lemma  [ l : lb ] ) , since @xmath82 for every original leaf @xmath49 ( claim  [ c : shm ] ) . * _ @xmath62-ticket _ : there is an _ original node _ @xmath336 and a link @xmath337 , where @xmath338 is a ( possibly compound ) node of @xmath184 , such that the original endnode @xmath49 of @xmath120 contained in @xmath338 ( possibly @xmath339 ) is not a locked leaf ( see fig .  [",
    "f : nx](b ) ) .",
    "[ c : x - link ] let @xmath178 be an arbitrary link set and let @xmath340 .",
    "let @xmath341 where @xmath338 is a node of @xmath184 .",
    "if the original endnode @xmath49 of @xmath120 contained in @xmath338 ( possibly @xmath339 ) is a locked leaf then @xmath342 and @xmath66 has a ticket for some link @xmath165 with @xmath135 .    by claim  [ c : lock - ok ] , @xmath66 is an ancestor of @xmath49 in @xmath20 , and there is a link @xmath110 such that @xmath112 is not a locked leaf .",
    "this implies that @xmath66 is an ancestor of @xmath338 in @xmath184 .",
    "furthermore , @xmath66 has a ticket for the link @xmath165 , since @xmath112 is not a locked leaf .",
    "part  ( i ) of corollary  [ c : a - tick ] implies that if we need to show existence of only one @xmath62-ticket in @xmath40 , then it is sufficient to prove that there is @xmath308 with @xmath309 .",
    "part  ( ii ) of corollary  [ c : a - tick ] justifies claiming a ticket for _ every _ link @xmath110 with @xmath308 and @xmath250 . in the case",
    "@xmath343 we will use part  ( i ) only , since in this case existence of just one @xmath62-ticket in @xmath40 makes @xmath40 non - deficient . in the case",
    "@xmath328 we need to show existence of two @xmath62-tickets in @xmath40 , but then we will use the partial solution invariant ( see claim  [ c : x - ticket ] ) and part  ( ii ) of the corollary to show directly that no ticket is claimed for a link incident to a locked leaf .",
    "we note that the reason we excluded twin links and locking links from @xmath143 , and needed @xmath168-tickets , was to avoid four specific `` _ problematic trees _ '' depicted in fig .",
    "[ f : bad - trees ] of being deficient ; assume that these trees have no non - leaf compound node .",
    "* if @xmath143 could include a twin link , @xmath344 could be as in fig .",
    "[ f : bad - trees](a ) ( here @xmath28 may or may not be a stem ) .",
    "but , as we will show later , since @xmath143 has no twin link , then the partial solution invariant implies that such @xmath40 must contain a compound node , and thus can not exist , see claim  [ c : new - leaf ] . *",
    "if @xmath143 could include locking links , @xmath344 could be as in fig .",
    "[ f : bad - trees](b ) , where @xmath53 is a stem .",
    "but since @xmath143 has no locking link , such @xmath40 can not exist either .",
    "* without the @xmath168-tickets , @xmath344 could be as in fig .",
    "[ f : bad - trees](c , d ) , where @xmath345 are stems .",
    "such @xmath40 is not dangerous , since it has @xmath5 stems .",
    "note that this @xmath40 has an @xmath168-ticket .",
    "thus @xmath346 , while @xmath347 ; consequently , such @xmath40 is not deficient .",
    "note that @xmath143 is a matching on the leaves of @xmath20 , and under the partial solution invariant , @xmath143 remains a matching on the leaves of @xmath184 and every leaf of @xmath184 matched by @xmath143 is an _ original leaf _ ; this is so since we contract only @xmath143-compatible trees . in particular , @xmath348 for every @xmath349 , by claim  [ c : shm ] ( note that @xmath350 is the set of leaves of @xmath184 matched by @xmath143 ) .",
    "recall that a @xmath140-leaf dangerous tree is `` reduced '' to a @xmath228-leaf dangerous tree by contracting one twin link ( see fig .",
    "[ f : def ] ) .",
    "however , this contraction is not @xmath143-compatible . in order to use such a reduction , in this section",
    "we will temporarily replace the partial solution invariant by the following weaker invariant , where matched nodes of @xmath184 are leaves of @xmath184 , but some of them may be compound nodes .",
    "[ l:3-lvs ] suppose that the credit invariant and the matching invariant hold for @xmath20 , @xmath143 , and @xmath178 , and that @xmath184 has no link greedy contraction .",
    "then @xmath236 ( so @xmath351 ) and either @xmath329 , or @xmath237 , @xmath330 , and @xmath331 .",
    "furthermore , if @xmath238 and @xmath237 , then one of the following holds :    * @xmath344 are as in fig .  [",
    "f : bad - trees](b ) ( so @xmath40 is a problematic tree with @xmath228 leaves ) , namely : @xmath40 has a unique stem @xmath53 with leaf descendants @xmath52 , and another leaf @xmath114 , such that @xmath352 and @xmath353 for some @xmath354 . * @xmath40 is dangerous .",
    "we emphasize again that in this section we use only the assumptions of lemma  [ l:3-lvs ] , and the partial solution invariant is _ not _ assumed .",
    "( under the partial solution invariant , @xmath212 are original leaves , and case ( i ) is easily refuted by absence of locking links in @xmath143 , as we already did when discussing the problematic tree in fig .",
    "[ f : bad - trees](b ) . )",
    "note that @xmath357 .",
    "hence @xmath358 from this we immediately get that either @xmath328 and @xmath355 , or @xmath237 and @xmath356 .",
    "from the assumption that @xmath184 has no link greedy contraction we get that every stem has a leaf descendant that is matched by @xmath143 ( the link between two unmatched leaf descendants of a stem gives a link greedy contraction ) ; this implies @xmath359 . thus if @xmath328 then @xmath239 , and if @xmath237 then @xmath330 .",
    "* there is no link between nodes in @xmath311 , since @xmath184 has no link greedy contraction .",
    "* there is no link from @xmath311 to @xmath365 , since @xmath40 is @xmath311-closed . *",
    "no link in @xmath13 is incident to a node in @xmath366 , by the definition of @xmath367 and claim  [ c : twins ] .",
    "thus @xmath374 on the other hand , @xmath348 for any node @xmath375 ; if @xmath376 then this is so by the definition of @xmath367 , and if @xmath349 is a leaf matched by @xmath143 then this is so by the matching invariant .",
    "consequently , @xmath377 this implies @xmath378 as claimed .              consider a general deficient @xmath228-leaf tree as in fig .",
    "[ f : def3](a ) .",
    "since by claim  [ c : cm ] @xmath383 , the nodes that are not in @xmath314 are @xmath108 , and possibly @xmath150  if @xmath150 is a stem .",
    "thus for any link @xmath384 with @xmath385 , either @xmath386 is a stem , or @xmath387 ; otherwise , @xmath388 has an @xmath62-ticket .",
    "now let @xmath384 be a link that covers the edge between @xmath29 and its parent , where @xmath385 .",
    "note that @xmath389 , since @xmath40 is @xmath49-closed . thus either @xmath386 is a stem , or @xmath390 .",
    "let us consider these two cases .",
    "suppose that there is a link @xmath391 such that @xmath250 , so @xmath386 is a stem , see fig .",
    "[ f : def3](b ) . by claim  [ c : twins ] ,",
    "@xmath92 and @xmath392 .",
    "now consider the ( unique , by the matching invariant ) link @xmath393 incident to @xmath114 . we can not have @xmath394 since @xmath395 and we already have links @xmath396 in @xmath86 .",
    "thus @xmath397 and we arrive at the problematic tree depicted in fig .  [",
    "f : def3](b ) .",
    "suppose that @xmath86 has no link @xmath398 such that @xmath250 , so @xmath390 .",
    "let @xmath399 be a link that covers @xmath49 . to avoid an @xmath62-ticket at @xmath66 , we must have that either @xmath400 is a stem or @xmath401 .",
    "the former case is not possible , by claim  [ c : twins ] .",
    "thus @xmath402 , by the matching invariant .",
    "consequently , either @xmath403 ( see fig .  [",
    "f : def3](c ) ) , or @xmath404 ( see fig .  [",
    "f : def3](d ) ) . if @xmath405 , then the former case @xmath403 ( see fig .",
    "[ f : def3](c ) ) is not possible ; this is since there must be a link in @xmath13 covering the edge between @xmath150 and its parent , but if @xmath92 then by claim  [ c : shm ] this link can not be incident to one of @xmath52 , and hence it gives a ticket .",
    "thus @xmath404 , and we arrive at the case in fig .",
    "[ f : def3](d ) , which is the @xmath228-leaf dangerous tree in fig .",
    "[ f : def](a ) . if @xmath406 ( see fig .  [",
    "f : def3](e ) and fig .",
    "[ f : def](b ) ) , then there is no difference in the roles of @xmath212 , and we can have either @xmath403 or @xmath404 , obtaining in both cases a @xmath228-leaf dangerous tree .",
    "recall that the partial solution invariant implies that @xmath143 is a matching on the _ original leaves _ of @xmath184 , namely , that any node of @xmath184 matched by @xmath143 is an _",
    "original _ leaf of @xmath20 .",
    "this and the fact that @xmath143 has no locking link , implies that the case in lemma  [ l:3-lvs](i ) ( see fig .  [",
    "f : bad - trees](b ) ) can not occur , as otherwise the leaf @xmath49 is locked by the link @xmath211 .",
    "thus lemma  [ l : char ] for @xmath228-leaf trees follows from lemma  [ l:3-lvs ] .      by claim  [ c : cm](ii ) @xmath408 . if @xmath409 , say @xmath410 , then the link in @xmath143 connects a twin of @xmath53 to a twin of @xmath411 .",
    "this link has an @xmath168-ticket , by the definition of @xmath367 and @xmath168 .",
    "thus @xmath332 .",
    "by claim  [ c : m=1 ] @xmath331 , and the statement follows .      by claim  [ c : s",
    "] @xmath407 ; namely , @xmath40 has a unique stem , say @xmath53 , such that its twin link , say @xmath412 , is in @xmath13 .",
    "since @xmath184 has no greedy link contraction , @xmath237 , and since @xmath143 has no twin link , exactly one of the twins of @xmath53 is matched by @xmath143 .",
    "consider the tree @xmath413 and its @xmath228-leaf subtree @xmath245 obtained from @xmath184 and @xmath40 , respectively , by contracting @xmath412 .",
    "the contraction of @xmath412 creates a new leaf @xmath414 that is now matched by @xmath143 , and @xmath414 is a leaf of @xmath245 .",
    "this contraction is paid by the coupon of the unmatched twin of @xmath53 , and @xmath414 does not need a coupon since it is matched by @xmath143 ; hence the credit invariant holds for @xmath255 , without overspending the credit . by claims  [ c : shm ] and [ c : twins ] , @xmath415 ,",
    "thus the matching invariant holds for @xmath255 and @xmath143 .",
    "since @xmath184 has no link greedy contraction , @xmath255 has no link greedy contraction .",
    "consequently , the conditions of lemma  [ l:3-lvs ] hold for @xmath255 , @xmath143 , and @xmath416 .",
    "hence @xmath245 must be a @xmath228-leaf tree as in lemma  [ l:3-lvs ] , as if @xmath245 has a ticket , then so does @xmath40 .",
    "now note that @xmath245 can not be a problematic tree as in fig .",
    "[ f : bad - trees](b ) , since then we will have @xmath409 , a case refuted in claim  [ c : s ] by existence of an @xmath168-ticket .",
    "thus @xmath245 is a @xmath228-leaf dangerous tree , as claimed .",
    "note that if @xmath237 and @xmath327 then contracting the link in @xmath217 creates a new leaf .",
    "the following claim refutes this case by showing that in this case @xmath40 must contain a compound node , contradicting claim  [ c : cm ] .      by the partial solution invariant @xmath212",
    "are original leaves .",
    "note that in the original tree @xmath20 the contraction of @xmath54 does not create a new leaf , since @xmath143 has no twin link .",
    "this implies that in @xmath20 , there is a subtree @xmath417 of @xmath20 ( see fig .",
    "[ f : new - leaf ] ) hanging out of a node @xmath150 on the path between @xmath57 and @xmath114 in @xmath20 .",
    "this subtree @xmath417 is not present in @xmath184 , hence it was contracted into a compound node during the construction of our partial solution @xmath178 .",
    "thus @xmath184 contains a compound node @xmath112 that contains @xmath417 , and since @xmath112 contains a node @xmath150 that belongs to the path between @xmath57 and @xmath114 in @xmath20 , the compound node of @xmath184 that contains @xmath150 belongs to the path between @xmath57 and @xmath114 in @xmath184 , and it is distinct from @xmath212 since both @xmath212 are original leaves .    to finish the proof of lemma  [ l : char ] it remains to refute the case @xmath328 . in this case , the following claim together with corollary  [ c : a - tick](ii ) will enable us to claim @xmath62-tickets without worrying about links incident to locked leaves .",
    "[ c : x - ticket ] suppose that @xmath328 , and let @xmath341 with @xmath418 and @xmath308 .",
    "then the original endnode @xmath49 of @xmath120 contained in @xmath338 ( possibly @xmath339 ) is not a locked leaf , and thus @xmath120 contributes a ticket at @xmath66 .",
    "case 1 : no link in @xmath143 had an endnode in @xmath59 ( see fig .  [",
    "f : x - ticket](b ) ) . by the partial solution invariant , we initially exhausted locking tree greedy contractions .",
    "this guarantees that @xmath139 lies in the same compound node @xmath338 of @xmath40 , contradicting that @xmath308 .",
    "case 2 : there was a link in @xmath143 with exactly one endnode in @xmath59 ( see fig .  [",
    "f : x - ticket](c ) ) .",
    "this link is not incident to a node of @xmath40 , hence this link was contracted . in particular , all nodes on the path between the endnodes of this link , including @xmath66 , lie in the same compound node of @xmath40 .",
    "this contradicts that @xmath308 .",
    "case 3 : no link in @xmath143 had exactly one endnode in @xmath59 but there was a link in @xmath143 with both endnodes in @xmath59 ( see fig .",
    "[ f : x - ticket](d ) ) .",
    "this link must be @xmath58 , since initially @xmath143 had no twin link and no locking link . since @xmath328",
    ", the link @xmath58 does not appear in @xmath40 , hence it was contracted and both @xmath281 lie in the same compound node of @xmath40 , which is @xmath338 .",
    "consider the first contraction when some node in @xmath139 entered a compound node . by the partial solution invariant ,",
    "this was either a greedy link contraction or a contraction of a semi - closed tree . if it was a greedy link contraction , then it was between some node in @xmath139 and some node not in @xmath139 , since there is no greedy link contraction within @xmath139 .",
    "but then also @xmath66 enters a compound node , contradicting that @xmath336 .",
    "if a contraction of a semi - closed tree occurred , then its root is a proper descendant of @xmath66 ( since @xmath66 remains an original node ) , its leaf set is @xmath419 , and it is @xmath57-closed .",
    "this implies that @xmath58 locks @xmath57 , contradicting that @xmath143 has no locking links .",
    "let @xmath360 be as in claim  [ c : count ] .",
    "every link in @xmath421 contributes a ticket to @xmath40 ; for links in @xmath422 this is so by corollary  [ c : a - tick](ii ) , and for links in @xmath423 this is so by claim  [ c : x - ticket ] . by claim  [ c : cm ] @xmath239 ,",
    "thus by claim  [ c : count ] @xmath424 ."
  ],
  "abstract_text": [
    "<S> the tree augmentation problem ( tap ) is : given a connected graph @xmath0 and an edge set @xmath1 on @xmath2 find a minimum size subset of edges @xmath3 such that @xmath4 is @xmath5-edge - connected . in the conference version @xcite was sketched a @xmath6-approximation algorithm for the problem . </S>",
    "<S> since a full proof was very complex and long , the journal version was cut into two parts . in the first part @xcite </S>",
    "<S> was only proved ratio @xmath7 . </S>",
    "<S> an attempt to simplify the second part produced an error in @xcite . here </S>",
    "<S> we give a correct , different , and self contained proof of the ratio @xmath6 , that is also substantially simpler and shorter than the previous proofs </S>",
    "<S> .    [ section ] [ theorem ] lemma [ theorem ] corollary [ theorem ] claim [ theorem ] definition [ theorem ] invariant [ theorem ] assumption </S>"
  ]
}