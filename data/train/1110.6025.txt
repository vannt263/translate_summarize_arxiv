{
  "article_text": [
    "in the design of beam transfer lines , one often encounters the problem of finding a combination of quadrupole lenses and field free spaces ( drifts ) that will produce particular transfer matrices in both the horizontal and the vertical planes . nowadays this problem is typically approached with the help of computer routines which minimize the deviations from the desired matrices as function of the quadrupole strengths , lengths and distances between them .",
    "although very sophisticated software became available for these purposes during the past decades , there is an important theoretical question which has not been answered yet and whose answer could affect the strategy and efficiency of numerical computations . searching for a numerical solution , one has to remember that it is not proven yet that an arbitrary four by four uncoupled beam transfer matrix can be represented by using a finite number of drifts and quadrupoles ( representation problem ) and the answer to this question is not known not only for more or less realistic quadrupole field models but also for the both most commonly used approximations of quadrupole focusing , namely thick and thin quadrupole lenses .    in this paper",
    "we make a step forward in resolving the representation problem and prove that an arbitrary four by four uncoupled beam transfer matrix actually can be obtained as a product of a finite number of thin - lenses and drifts . even though our proof uses more thin lenses than probably needed , we believe that the solution provided is not only of theoretical interest , but could also find some practical applications because it uses explicit analytical formulas connecting thin - lens parameters with the elements of the input beam transfer matrix .",
    "though the thin - lens kick is the simplest model of the quadrupole focusing , its role in accelerator physics can hardly be overestimated .",
    "the thin - lens quadrupole approximation reveals the analogy between light optics and charged particle optics and , if one takes into account difficulties of analytical manipulations with the next by complexity thick - lens quadrupole model  @xcite , is an indispensable tool for understanding principles and limitations of the already available optics modules and for development of the new optics solutions ( see , as good examples , papers  @xcite ) .",
    "the paper by itself is organized as follows . in sec .",
    "ii we introduce all needed notations and give the lower bound on the number of drifts and lenses which are required for a solution of the representation problem by providing an example of a matrix which can not be obtained using five thin lenses and five independently variable drift spaces .",
    "this result is somewhat unexpected and up to some extent contradicts a rather widespread opinion that the typical problem can be solved by taking a number of parameters equal to the number of constraints available .",
    "we see that although the four by four uncoupled beam transfer matrix has only 6 degrees of freedom , there are matrices which can not be represented not only by three thin lenses and three drifts ( six parameters ) , but also by five thin lenses and five drifts ( ten parameters ) .",
    "this example , the example provided by the matrix ( [ i2_gb_ex2 ] ) , other of our attempts ( though omitted in this paper ) to find thin - lens decompositions for particular beam transfer matrices and the properties of the explicit solution given below in this paper , lead us to the conjecture that in order to represent an arbitrary four by four uncoupled beam transfer matrix one needs at least six thin lenses if the distances between them can be varied ( independently or not ) or at least seven thin lenses if this variation is not allowed .    in sec .",
    "iii we prove that an arbitrary four by four uncoupled beam transfer matrix can be obtained as a product of a finite number of thin - lenses and drifts by giving an explicit solution of the thin - lens representation problem which uses equally spaced thin lenses .",
    "the core idea of our approach is the representation of the matrix of the thin - lens multiplet as a product of elementary @xmath0 matrices ( the definition and the properties of the matrix @xmath0 can be found in appendix a ) with subsequent reduction of the initial 2d problem to two independent 1d problems .",
    "we use in this section the equally spaced thin - lens system because it allows one to make such a reduction with a minimum of technical details .",
    "the solution obtained utilizes 13 lenses if the spacing between them is fixed beforehand and 12 lenses if this distance can be used as an additional parameter .",
    "thus , it uses six more lenses than the minimal number stated in our conjecture , but the setting of these six lenses depends only on the distance between lenses and therefore does not depend ( at least directly ) on the particular input beam transfer matrix .    in sec .",
    "iv we consider the case of arbitrarily spaced thin lenses .",
    "first , we show that the solution of the representation problem presented in the previous section is still valid after some minor modifications .",
    "next we study in greater detail the ways to transform the matrix of the drift - lens system to the product of the elementary @xmath0 matrices ( see formulas ( [ b2])-([b6_2 ] ) and ( [ ff_1])-([ff_6 ] ) below ) . the representation of the matrix of the thin - lens multiplet as a product of elementary @xmath0 matrices ( together with the multiplication formula ( [ e1_r3 ] ) ) is a useful new tool for the analytical study of the properties of thin - lens systems .",
    "it also gives some clarification of the question why the role of the variable drift spaces and the role of the variable lens strengths are different when they are used as fitting parameters .",
    "this paper is mostly a theoretical paper and its main purpose is to turn the common believe that an arbitrary four by four uncoupled beam transfer matrix can be obtained as a product of a finite number of thin lenses and drifts into proven scientific fact .",
    "still , both , the developed new technique for the analytical study of the properties of thin - lens multiplets and the explicit thin - lens solution presented in this paper , are of independent interest . to illustrate that , in appendix b we apply our @xmath0 matrix approach to the study of four - lens beam magnification telescopes and find new , previously unknown analytical solutions for this important optics module . in appendix c",
    ", we apply the explicit solution developed in this paper to the design of a beam line which allows an independent scan of horizontal and vertical phase advances while preserving the entrance and exit matching conditions for the twiss parameters .    besides that thin - lens blocks with decoupled transverse actions introduced in this paper are another point of general interest .",
    "although the idea of decoupled tuning knobs by itself is not new in the field of accelerator physics ( see , for example ,  @xcite ) , our approach is new and is not based on an iterative usage of small steps in the lens strengths obtained at each iteration by linearization .",
    "let @xmath1 be an arbitrary four by four uncoupled beam transfer matrix and let the two by two symplectic matrices @xmath2 and @xmath3 be its horizontal and vertical focusing blocks , respectively .",
    "let us denote by @xmath4 the transfer matrix of the one - dimensional thin lens of strength @xmath5 and by @xmath6 the transfer matrix of the one - dimensional drift space of length @xmath7 :    @xmath8    the problem of representation of the matrix @xmath1 by a thin - lens system can then be written as    @xmath9    where ( here and later on ) one has to take the upper sign in the combinations @xmath10 and @xmath11 together with the index @xmath12 and the lower sign together with the index @xmath13 .",
    "note that the drift - lens system presented on the left - hand side of eq .",
    "( [ i2 ] ) consists of equal numbers of drifts and lenses and the first element which the beam sees during its passage is a thin - lens .",
    "alternatively , one can consider equation    @xmath14    where the first element is a drift space , or one can use the drift - lens system with a nonequal number of drifts and lenses which starts and ends with a drift ( or a lens ) , but for the moment this is not important .",
    "there are many unanswered questions related to eq .",
    "( [ i2 ] ) , the most interesting for us in this paper is the following : given a matrix @xmath1 , does there exist a number @xmath15 such that these equations have a solution ?",
    "if the answer to this question is positive , could the number @xmath15 be chosen independently from the input matrix @xmath1 and , if it is also possible , what is the minimal @xmath15 required ?    from a mathematical point of view , eq .",
    "( [ i2 ] ) is a system of eight polynomial equations in @xmath16 unknowns and for any polynomial system considered over an algebraically closed field of complex numbers there is an algorithmic way to answer the question if this system has infinitely many solutions or has a finite number of solutions , or has no solutions at all .",
    "this can be done by transforming the original system to a special form called a gr@xmath17bner basis and , very loosely speaking , is an analogue of the gaussian elimination process in linear algebra  @xcite .",
    "the gr@xmath17bner basis can be computed in finitely many steps and , moreover , nowadays its calculation can be done with the help of symbolic manipulation programs like mathematica and maple .",
    "unfortunately , we are interested in the real solutions of eq .",
    "( [ i2 ] ) constrained additionally by the requirements for the drift lengths to be nonnegative and therefore we can not use all benefits provided by the gr@xmath17bner basis theory . nevertheless , the use of the gr@xmath17bner basis approach , although it did not help us to solve the problem in general , it was very useful in providing examples of particular matrices which can not be obtained using a certain number of thin lenses and drift spaces .",
    "for example , using the gr@xmath17bner basis technique , it is possible to prove that the matrix @xmath1 with    @xmath18    can not be represented by five thin lenses and five variable drift spaces starting either from a lens like in eq .",
    "( [ i2 ] ) or from a drift like in eq .",
    "( [ i2_sfd ] ) .",
    "this example , the example provided by the matrix ( [ i2_gb_ex2 ] ) , many other of our attempts to study the representation problem for particular beam transfer matrices , and the properties of the explicit solution given below in this paper lead us to the conjecture that in order to be able to represent an arbitrary four by four uncoupled beam transfer matrix one needs at least six thin lenses if the distances between them can be varied ( independently or not ) or at least seven thin lenses with nonzero drift spaces between them if this variation is not allowed .    to finish this section ,",
    "let us note that in the above discussions we made no use of the fact that we are interested not in the general system of polynomial equations , but only in the polynomial system produced by a product of matrices with simple inversion properties :    @xmath19    choosing some @xmath20 and using ( [ i2_invp ] ) , one can rewrite the system ( [ i2 ] ) in the equivalent form :    @xmath21 @xmath22    this trick can be used for the elimination of a part of the unknowns from the original system by solving eq .",
    "( [ i2_do ] ) with respect to the variables @xmath23 or one may even think to construct an iterative solution method which could be considered as matrix version of the method of successive elimination of unknowns  @xcite .",
    "this method was developed especially to deal with the thin - lens multiplets and was used in  @xcite in an attempt to characterize all uncoupled beam transfer matrices which can be obtained by using three thin lenses and three drift spaces .",
    "unfortunately , however this approach did not give us any additional noticeable simplifications in the solution of the general representation problem .",
    "in this section we will give an explicit solution of the thin - lens representation problem which uses equally spaced thin - lenses . instead of eq .",
    "( [ i2 ] ) or eq .",
    "( [ i2_sfd ] ) , we will consider the system    @xmath24    where as an elementary building block we take a thin lens sandwiched between two drift spaces    @xmath25    if the block length @xmath26 , then one can represent the block transfer matrix in the form    @xmath27    where    @xmath28    and    @xmath29    note that the properties of the matrix @xmath0 ( and other elementary matrices used in this paper ) can be found in appendix a.    let us assume that in the system ( [ a1_0 ] ) all @xmath30 and all @xmath31 are equal to each other , i.e. , that    @xmath32    and let @xmath26 .",
    "the principle simplification that occurs in this case is that after the substitution of the representation ( [ a2 ] ) into eq .",
    "( [ a1_0 ] ) the matrices @xmath33 and @xmath34 cancel each other and we obtain    @xmath35    where    @xmath36    equations ( [ es1 ] ) give the dimensionless form of eq .",
    "( [ a1_0 ] ) and , additionally , one sees that while the original system ( [ a1_0 ] ) is formed by the product of @xmath37 interleaved thin - lens and drift matrices ( with neighboring drifts lumped together ) , the system ( [ es1 ] ) includes only @xmath38 matrices depending on unknowns ( there are @xmath38 unknowns : @xmath15 lens strengths plus two variables characterizing the block length and the position of the lens inside the block ) and @xmath15 of them are @xmath0 matrices .    nevertheless , the system ( [ es1 ] ) is still too complicated to find easily its solutions ( or even to prove their existence ) for an arbitrary matrix @xmath1 and with the number of lenses @xmath15 equal to six or seven as required by our conjecture .",
    "instead we will provide an explicit solution which utilizes 13 lenses if the parameters @xmath39 and @xmath40 are fixed and are independent from the input matrix @xmath1 , and 12 lenses if @xmath39 and @xmath40 can be varied .",
    "the main idea of our solution is the reduction of the 2d problem ( [ es1 ] ) to two independent or , more exactly , almost independent 1d problems by constructing thin - lens blocks which can act in the horizontal and the vertical planes similar to a single @xmath0 matrix , but whose actions for both planes can be chosen independently . at first we will consider a solution of the 1d problem in terms of @xmath0 matrices . as the next step",
    "we will introduce a four - lens block with decoupled transverse actions and then will give an explicit solution of the complete 2d problem . besides that we will discuss the recipe for constructing lens blocks with decoupled transverse actions with more than four lenses .    before giving the technical details",
    "let us consider one more example obtained with the help of the gr@xmath17bner basis technique .",
    "let us assume that @xmath39 and @xmath40 are fixed and let the matrix @xmath1 be such that the matrix @xmath41 in ( [ es1 ] ) is equal to the symplectic unit matrix :    @xmath42    then this matrix @xmath1 can not be represented by less than seven thin lenses and with seven lenses there are many solutions which geometrically can be viewed as six distinct parallel straight lines in the seven - dimensional space of lens strengths .      according to our plan",
    "we will prove in this subsection that every real symplectic @xmath43 matrix @xmath44 can be represented as a product of at most four @xmath0 matrices .",
    "first , we will consider the case of three @xmath0 matrices and will find that three @xmath0 matrices are insufficient for the representation of an arbitrary @xmath43 symplectic matrix .",
    "next we will switch to the case of four @xmath0 matrices and will show that with four @xmath0 matrices a solution can always be found , but it is always nonunique .",
    "let us start with the case of three @xmath0 matrices , i.e. , from the equation    @xmath45    this matrix equation is , in fact , the system of the four equations for the four matrix elements    @xmath46    and , as it is well known , due to symplecticity of the matrices on both sides of ( [ s1d1 ] ) these four equations should be equivalent to some system consisting of three equations only .",
    "in order to obtain such a system let us first substitute @xmath47 into the first equation of the system ( [ s1d4_01 ] ) and then plug @xmath48 in the equations three and four .",
    "because in the resulting system    @xmath49    the fourth equation is equal to the first equation multiplied by @xmath50 minus the third equation multiplied by @xmath51 , it can be omitted .",
    "thus we obtain that the system of the four third order polynomial equations ( [ s1d4_01 ] ) is equivalent to the system    @xmath52    which is linear in the unknowns @xmath53 , @xmath54 , and @xmath55 .",
    "moreover , this system already has a triangular form and its solvability depends only on the solvability of the third equation with respect to the variable @xmath55 .",
    "elementary analysis shows that there are three possibilities for the solutions of the system ( [ s1d4 ] ) . if @xmath56 , then there exists a unique solution    @xmath57    if @xmath58 and @xmath59 ( i.e if @xmath60 )",
    ", then there exists a one - parameter family of solutions :    @xmath61    finally , if @xmath58 and @xmath62 , then there is no solution at all .",
    "very loosely speaking , the condition @xmath58 defines the two - dimensional surface of singularities in the three - dimensional space of @xmath43 real symplectic matrices .",
    "this surface , in the next turn , contains the one - dimensional curve selected by the additional relation @xmath59 . if the matrix @xmath1 ( represented as a point in our three - dimensional space )",
    "lies outside of the surface of singularities , then a solution for such a matrix exists and is unique .",
    "if the point representing the matrix @xmath1 belongs to the surface of singularities , then we either have many solutions or none depending on whether this point lies on the above defined one - dimensional curve or not .",
    "let us now turn our attention to the equation    @xmath63    which includes four @xmath0 matrices .",
    "the equivalent to this equation system is given below :",
    "@xmath64    and the easiest way to obtain it is to substitute into the system ( [ s1d4 ] ) the elements of the matrix @xmath65 instead of the @xmath66 .",
    "the system ( [ s1d6 ] ) is not linear anymore , but still has a triangular form and its solvability depends again only on the solvability of the third equation with respect to the variables @xmath55 and @xmath67 . because the matrix @xmath1 is nondegenerated its elements @xmath68 and @xmath50 can not be equal to zero simultaneously and therefore the expression @xmath69 considered as a function of @xmath67 can not be equal to zero in more than one point .",
    "it means that the last equation in ( [ s1d6 ] ) always has solutions and a good way to understand their complete structure is to consider this equation as the equation of a curve on the plane @xmath70 . if @xmath71 this curve is a hyperbola with two separate branches , if @xmath72 it is a degenerate hyperbola consisting of two intersecting lines @xmath73 and @xmath74 , and , finally , if @xmath58 we have a single straight line @xmath75 .",
    "so we see that with the help of the four @xmath0 matrices a solution of our problem can always be found and is always nonunique .",
    "let us denote by @xmath76 the following combination of four @xmath0 matrices :    @xmath77    which in the original variables ( [ a1_0 ] ) includes four thin - lenses ( four - lens block ) .",
    "if one chooses @xmath78 and if one takes    @xmath79    then the block matrix can be written as    @xmath80    where @xmath81 is a diagonal scaling matrix ,    @xmath82    and    @xmath83    @xmath84    since for any given value of @xmath85 and @xmath86 eqs .",
    "( [ es6_1 ] ) and ( [ es6_2 ] ) can be solved with respect to the variables @xmath87 and @xmath88 ,    @xmath89    @xmath90    the formula ( [ es5 ] ) gives the result which we were looking for .",
    "both matrices @xmath91 and @xmath92 are similar to a single @xmath0 matrix ( with an inessential minus sign ) and both parameters @xmath85 and @xmath86 can be chosen independently , and then the setting of the first and the last lenses in the block is determined according to the formulas ( [ es7 ] ) and ( [ es8 ] ) .",
    "since with four @xmath0 matrices we always can solve the 1d problem , let us first consider a combination of four blocks of the type ( [ es5 ] ) .",
    "using ( [ e9 ] ) , one can show that the total matrix of this 16 lens system can be written as follows :    @xmath93    @xmath94    where    @xmath95    and    @xmath96    @xmath97    plugging this representation into eq .",
    "( [ es1 ] ) we obtain    @xmath98    @xmath99",
    "let us choose arbitrary nonnegative @xmath39 and @xmath40 with @xmath100 and select for each four - lens block its own @xmath78 .",
    "this , in accordance with formula ( [ es4 ] ) , gives us the setting of the eight lenses in our system and this completely determines the matrix on the right - hand side of eq .",
    "( [ am1_001 ] ) . as the last step",
    "we take @xmath101 and @xmath102 as some solutions of two independent 1d problems of the type ( [ s1d5 ] ) and define the strengths of the remaining eight lenses using the formulas ( [ am3_0 ] ) , ( [ am4_0 ] ) , ( [ es7 ] ) , and ( [ es8 ] ) .",
    "one sees that using four blocks with decoupled transverse actions the complete 2d problem can always be reduced to two easily solvable independent 1d problems . but do we really need four blocks for making such a reduction ?",
    "the answer is no and the reason for this is as follows .",
    "we know that for most of the @xmath43 symplectic matrices the 1d problem can be solved with three @xmath0 matrices , which means that for most of the @xmath103 uncoupled beam transfer matrices the 2d problem can also be solved with three blocks .",
    "the problem is what to do with the rest ?",
    "happily it turns out that by appropriate choice of the parameters @xmath39 and @xmath40 one can always move the input matrix @xmath1 away from the region of unsolvability and , if the variation of @xmath39 and @xmath40 is not allowed , this can be done by using only one additional thin lens .",
    "thus , we arrive at the solution announced in the introduction , namely 13 lenses if the spacing between them is fixed and 12 lenses if this distance can be used as an additional parameter",
    ". below we will consider in detail the case of 12 lenses ( three blocks ) with variable spacing and the check that the use of an additional lens for the fixed spacing also works we leave as an exercise for the interested reader .",
    "in analogy with ( [ am1_0 ] ) the combination of three blocks can be written as    @xmath104    @xmath105    where    @xmath106    and    @xmath107",
    "@xmath108    @xmath109    plugging again this representation into system ( [ es1 ] ) we obtain the equation    @xmath110    @xmath111    we know that the sufficient condition for this equation to be solvable with respect to the unknowns @xmath112 is that the horizontal and vertical parts of the matrix on the right - hand side both have nonvanishing @xmath113 elements .",
    "the direct calculation gives us    @xmath114    where @xmath115 are the elements of the input matrix @xmath1 .",
    "looking for a solution one can proceed further in the same manner as in the four block case with only one difference . at the first step one",
    "has to take not arbitrary nonnegative @xmath39 and @xmath40 , but such @xmath39 and @xmath40 that both @xmath116 and @xmath117 are nonzero , which due to symplecticity of the matrices @xmath2 and @xmath3 is always possible .      in this subsection",
    "we give the recipe for the construction of lens blocks with decoupled transverse actions .",
    "as we will see , this recipe works not only for the four - lens combination considered above , but is also applicable to blocks with a larger number of lenses .",
    "let us consider @xmath118lens block with @xmath119 :    @xmath120    and let us assume that the product of the @xmath121 inner matrices in our block takes the form    @xmath122    then , as one can show by direct multiplication , both matrices @xmath91 and @xmath92 become similar to a single p matrix ( with an inessential minus sign possibly presented ) , namely    @xmath123    @xmath124    where    @xmath125    if for arbitrary given values of @xmath85 and @xmath86 eq . ( [ db_3 ] ) can be solved with respect to the variables @xmath87 and @xmath126 , then it will be exactly what we need , and the necessary and sufficient condition for such solvability is    @xmath127    so , in order to construct the @xmath128-lens block with the decoupled transverse actions , one has to solve two equations making the @xmath129 elements of the @xmath12 and @xmath13 parts of the product of the @xmath121 inner matrices equal to zero and one has to satisfy one additional inequality constraint ( [ db_4 ] ) .",
    "the solution for the four - lens block was already given above and is unique up to a sign change ( @xmath78 ) .",
    "let us now consider the more complicated ( but still analytically solvable ) case of five lenses .",
    "in this situation all possible solutions which bring the product of the three inner @xmath0 matrices    @xmath130    to the form ( [ db_1 ] ) can be expressed as a function of parameters @xmath7 and @xmath131 as follows :    @xmath132    @xmath133    @xmath78 , and @xmath134 and @xmath131 are such that    @xmath135   \\cup   \\nonumber\\end{aligned}\\ ] ]    @xmath136   \\cup \\left[1.5,\\ , \\sqrt{3}\\right )   \\cup \\left(\\sqrt{3},\\ , + \\infty\\right ) .",
    "\\label{db_5}\\end{aligned}\\ ] ]    to complete the block construction we have to select from all these solutions a subset on which the functions    @xmath137    satisfy the inequality ( [ db_4 ] ) .",
    "as one can check , this can be achieved simply by removing from the set ( [ db_5 ] ) the endpoints of the given set intervals , i.e. , by removing the points @xmath138 and @xmath139 .",
    "so we see that there are many solutions which allow us to construct from five lenses the block with decoupled transverse actions and for selecting one of them some additional optimization criteria could be involved .",
    "note that in the blocks constructed according to our recipe the setting of the internal lenses does not depend on the setting of the first and the last lenses and depends only on the geometrical block parameters ( distances between the lenses ) , which will be seen more clearly in the following section where we will consider the case of arbitrarily spaced thin lenses .",
    "note also that the horizontal and the vertical matrices between the first and the last lenses in the block , when calculated using not the @xmath0 matrix notation , but the original variables in which eq .",
    "( [ a1_0 ] ) is written    @xmath140    @xmath141    @xmath142    @xmath143    both have @xmath144 elements equal to zero ( i.e. the phase advances between the first and the last lenses in the block are always multiples of @xmath145 ) , but this alone without the inequality ( [ db_4 ] ) satisfied does not give us the block with the decoupled transverse actions .",
    "when the distances between the lenses are not equal to each other , we immediately lose the advantage of the cancellation of @xmath146 matrices between the @xmath0 matrices after substitution of the representation ( [ a2 ] ) into eq .",
    "( [ a1_0 ] ) . nevertheless , as we will show below , this case can also be treated with the tools developed in the previous section .",
    "let us denote by @xmath147 the distance between the lenses with the indices @xmath148 and @xmath149 ( @xmath150 ) .",
    "we start from the observation that for @xmath151 the following identity holds :    @xmath152    @xmath153    which can be shown by direct multiplication and which requires that all @xmath154 and @xmath155 are positive .",
    "note that in this identity @xmath156 and @xmath157 are the lower and upper triangular matrices with unit diagonal elements ( see appendix a for more details ) .",
    "let us now substitute the representation ( [ a2 ] ) into eq .",
    "( [ a1_0 ] ) and then plug in the corresponding places the right - hand side of the identity ( [ b1 ] ) . after that the property ( [ e11 ] ) allows us to eliminate from the result all @xmath156 and @xmath157 matrices while shifting their arguments to the arguments of the neighboring @xmath0 matrices , and leaving us with a product consisting of alternating @xmath0 and @xmath158 matrices .",
    "although the @xmath158 matrices can not be eliminated completely , they can be moved either on the left or on the right - hand side of all @xmath0 matrices with the help of the property ( [ e9 ] ) . as the last step we transfer all matrices from the left and right sides of the obtained solid block of the @xmath0 matrices to the right - hand side of our equation ,",
    "hide them in the matrix @xmath159 and end up with the equation    @xmath160    which already has the desired form .",
    "the detailed structure of the arguments @xmath161 and of the matrix @xmath159 depends on the particular ways how the individual @xmath158 matrices were moved ( to the left or to the right sides ) and is given below for the case when during transformations all @xmath158 matrices were moved to the left - hand side of the @xmath0 matrix block . nevertheless , the expressions given below are general in the sense that they contain an arbitrary positive parameter @xmath162 , and with the proper choice of this parameter one can account for all possible ways of movement of the individual @xmath158 matrices :    @xmath163    @xmath164    @xmath165    @xmath162 is an arbitrary positive parameter and , because we do not have lenses with indices @xmath166 and @xmath167 , we use the conventions that    @xmath168    @xmath169    note that , if the parameter @xmath162 is taken to be a positive number or a dimensionless function of the thin - lens multiplet parameters ( drift lengths and lens strengths ) , then eq . ( [ b2 ] ) and the variables ( [ b4 ] ) are also dimensionless",
    ". one of the possible choices is to take @xmath162 for even @xmath15 as solution of the equation @xmath170 and for odd @xmath15 as solution of the equation @xmath171 .",
    "if the condition ( [ es0 ] ) holds , then the solution of these equations for both cases ( even and odd @xmath15 ) is @xmath172 and the representation ( [ b2 ] ) turns into the representation ( [ es1 ] ) as one can expect .    now in order to continue we need a lens block with the decoupled transverse actions and , as it is not difficult to check , the recipe given in the previous section is applicable without any changes . for the construction of the @xmath128-lens block we still need to bring the product of the @xmath121 inner matrices to the form ( [ db_1 ] ) while also satisfying the inequality constraint ( [ db_4 ] ) . for the four - lens case",
    "@xmath173    the two equations making the @xmath129 elements of the @xmath12 and @xmath13 parts of the product of the two inner matrices equal to zero are    @xmath174    and have a solution    @xmath175    @xmath176    which again is unique up to a sign change ( @xmath78 ) .",
    "the values @xmath177 for this solution are    @xmath178    both of them are positive and clearly satisfy the inequality ( [ db_4 ] ) . with this choice for @xmath179 and @xmath131",
    "the total block matrix takes the form    @xmath180    where    @xmath181    equation ( [ db6 ] ) is the analogy of the formulas ( [ es7 ] ) and ( [ es8 ] ) and for any given values @xmath85 and @xmath86 allow one to determine the corresponding lens strengths @xmath87 and @xmath88 .",
    "thus , all results of the previous section concerning the reduction of the 2d problem to two 1d problems become applicable with some minor changes connected with the difference in the matrices @xmath182 and @xmath183 defined by the relations ( [ es2 ] ) and ( [ b3 ] ) , respectively .",
    "note that if , when placed in the beam line , the actual decoupling block starts from the lens with the index @xmath184 , one has simply to add @xmath185 to the indices @xmath186 and @xmath187 in all above formulas .",
    "equation ( [ a1_0 ] ) contains @xmath16 parameters which specify the drift lengths ( @xmath188 ) while only @xmath189 parameters , namely @xmath190 have a clear physical meaning and are independent .",
    "let us have a closer look at formulas ( [ b2])-([b6_2 ] ) and count how many superfluous parameters are still left in them and then show ways to remove them .",
    "the superfluous parameters @xmath191 and @xmath192 are clearly present , either directly as the arguments of @xmath146 matrices or through the lengths of the first and the last building blocks @xmath193 and @xmath194 . and actually that is all .",
    "the presence of the other superfluous parameters through the values @xmath195 is completely imaginary . to show this",
    "let us note that these values can enter the main formulas ( [ b2])-([b4 ] ) only through the values @xmath162 and @xmath196 and through the combinations @xmath197 .",
    "so if we choose @xmath162 to be independent from @xmath195 , then these parameters can enter in none of the combinations @xmath198 due to the recursion relation    @xmath199    which follows from the recursion relation ( [ b5 ] ) , and likewise they can not enter the value @xmath196 because one can write that @xmath200 .",
    "thus , there are only two superfluous parameters , @xmath191 and @xmath192 , present in our formulas , either directly or through the values @xmath193 and @xmath194 .",
    "do we need to remove them ?",
    "in general not , because it is clear that none of the physically meaningful answers will depend on them and , in this sense , their absence in the final results ( like in formulas ( [ db2 ] ) and ( [ db3 ] ) ) could work as some indirect indicator of the correctness of the calculations .",
    "but from another point of view , it seems better not to have any superfluous parameters from which one can expect nothing except some possible additional complications .    the simplest way to remove the parameters @xmath191 and @xmath192 from the formulas ( [ b2])-([b4 ] ) is to make them functions of the physically meaningful parameters .",
    "for example , one can take @xmath201 and @xmath202 .",
    "however , the way which we prefer is the modification of the formulas ( [ b2])-([b4 ] ) in such a way that the superfluous parameters will disappear automatically . in doing so",
    "let us first present the final result and then make some remarks on how it can be obtained :    @xmath203    @xmath204    @xmath205    @xmath206    @xmath207    @xmath208    and @xmath209 is the @xmath43 symplectic unit matrix .    in order to obtain formulas ( [ ff_1])-([ff_6 ] ) from formulas ( [ b2])-([b6_2 ] )",
    "let us first introduce the parameters @xmath210 and then assume that @xmath162 is chosen in such a way that @xmath211 does not depend on any superfluous parameter ( for example , one simply can take @xmath212 ) .",
    "after this one sees that the parameters @xmath193 and @xmath194 enter the left - hand side of eq .",
    "( [ b2 ] ) only through the matrices @xmath213 and @xmath214 . because of the property ( [ e11 ] ) these matrices can be decomposed into the following products :    @xmath215    @xmath216    as the last step , one has to substitute these decompositions back into eq .",
    "( [ b2 ] ) , transfer @xmath157 and @xmath156 to the right - hand side and , after some straightforward manipulations , arrive at the final result described in the above formulas ( [ ff_1])-([ff_6 ] ) .",
    "note that the whole story about the presence of the superfluous parameters is the result of our desire to have the expressions for the problem description ( expressions ( [ b2])-([b6_2 ] ) ) which reduces to the highly symmetric expressions ( [ es1 ] ) and ( [ es2 ] ) in the limit of equal distances between thin lenses . if one does not require that , then , as we will outline below , it is possible to arrive at the representation ( [ ff_1])-([ff_6 ] ) without using the identity ( [ a2 ] ) .",
    "according to ( [ e5 ] ) and ( [ e6 ] ) the matrix of the building block can be written as    @xmath217    substituting this representation in the original eq .",
    "( [ a1_0 ] ) and using that due to ( [ e4_2 ] )    @xmath218    we obtain    @xmath219    @xmath220    where we have already introduced an arbitrary positive parameter @xmath211 .",
    "now , assuming that all distances between lenses are positive and using ( [ e4_8 ] ) , we can replace for each @xmath221 the matrix @xmath222 by the matrix @xmath223 with simultaneous adding to the arguments of the two neighboring p matrices the value @xmath224 .",
    "after these manipulations we arrive at the expression    @xmath225    @xmath226    @xmath227    @xmath228    and the last step , which is still necessary in order to obtain formulas ( [ ff_1])-([ff_6 ] ) , is to move all @xmath158 matrices to the left in the left - hand side of eq .",
    "( [ rsp_4 ] ) using the identity ( [ e9 ] ) with a subsequent transfer of the matrix @xmath229 from the left to the right - hand side of the obtained equality .",
    "the authors are thankful to winfried decking , nina golubeva and helmut mais for support and their interest in this work .",
    "the careful reading of the manuscript by helmut mais and his useful advices are gratefully acknowledged .",
    "the elementary symplectic @xmath0 matrix which is defined as follows ,    @xmath230    and which we use extensively throughout this paper was found empirically by the usual trial and error method during attempts to reduce the problem of analytical study of thin - lens multiplets to some `` more manageable '' form . as we will see below",
    ", this matrix possesses many interesting properties not only by itself , but also in combination with the other elementary matrices .",
    "although not widely known in the scientific community , it was no surprise , as we found later , that it was successfully used in some special area of abstract algebra @xcite .    in order to give an expression for the product of @xmath15 elementary @xmath0 matrices ,",
    "let us first define a sequence of polynomials @xmath231 in the variables @xmath232 recursively by the following equations :    @xmath233    @xmath234    @xmath235    with these notations we assert that    @xmath236    @xmath237    which is clear for @xmath238 and in the general case can be proven by induction . because such induction can be made in two different ways , either by adding one more @xmath0 matrix from the left or from the right side , it is easy to see that the polynomials @xmath231 can also be defined by ( [ e1_r1 ] ) and by the recursion relation    @xmath239    @xmath240    comparison of ( [ e1_r2 ] ) and ( [ e1_r4 ] ) implies that    @xmath241    according to ( [ e1_r3 ] ) we can write down the matrix of the product of any number of elementary @xmath0 matrices without making any matrix multiplications . in this connection let us note that the problem of deriving some recursion relations which allow one to obtain the transfer matrix of an arbitrary multiplet without actual matrix multiplications was also addressed in @xcite .",
    "it is clear that the matrix @xmath242 coincides with the @xmath43 symplectic unit matrix @xmath209 , i.e. , that    @xmath243    and the following relations between the @xmath0 matrices can be easily verified by direct multiplication :    @xmath244    @xmath245    @xmath246    @xmath247    @xmath248    where @xmath249 is the @xmath43 identity matrix .",
    "let us now introduce three more elementary matrices .",
    "the diagonal ( scaling ) matrix    @xmath250    and the lower and upper triangular matrices with unit diagonal elements    @xmath251    note that although the matrices @xmath156 and @xmath157 formally coincide with the matrices of the thin lens and the drift space , respectively , we have introduced them in order to distinguish the situations where matrix of lens or drift has physical meaning and where the usage of low or upper triangular matrix is simply the reflection of the mathematical technique used .",
    "we have the following relations between the matrices @xmath0 , @xmath158 , @xmath156 and @xmath157 :    @xmath252    @xmath253    @xmath254    @xmath255    @xmath256    @xmath257    @xmath258    although these relations are elementary , they are basic for all results of this paper .",
    "a telescope is a beam transport system which has diagonal transfer matrices in both transverse planes ,    @xmath259    where the numbers @xmath260 and @xmath261 are called magnifications ( or de - magnifications , if convenient ; negativity of horizontal / vertical magnification means that the horizontal / vertical image is inverted with respect to the original ) .",
    "it is an optics module which is important for many accelerator designs and its study has received considerable attention in the past ( see , for example , papers  @xcite ) .",
    "the minimum number of thin lenses required for a telescope to exist is believed to be four ( though , to our knowledge , still no rigorous proof is available ) and the corresponding four - lens telescope system of matrix equations in our notations can be written as follows :    @xmath262    @xmath263    there are two explicit analytical solutions known for the system ( [ flt_01_01 ] ) . the first solution is obtained when the astronomical telescope , consisting of two focusing lenses separated by the distance equal to the sum of their focal lengths , is generalized to the usage of magnetic doublets instead of optical lenses .",
    "this solution has the property that    @xmath264    i.e. it always provides telescopes with equal negative magnifications in both transverse planes ( see , for example  @xcite ) .",
    "the second known analytical solution in the four - lens case is the solution for an inversor  @xcite , which is the name of the telescope with the horizontal and vertical magnifications being inverse of one another :    @xmath265    besides these two explicit solutions , all other studies of the four - lens telescopes ( as well as telescopes constructed from larger number of lenses ) are either purely numerical or semianalytical as in  @xcite , where in the first step the part of variables is eliminated from the system ( [ flt_01_01 ] ) analytically and , in the second step , the remaining equations are solved numerically . since these remaining equations are not linear in the variables , they can not be solved easily even numerically and , therefore , any new explicit solution of the system ( [ flt_01_01 ] ) is of interest . in this appendix",
    "we provide new analytical solutions using tools and techniques developed in this paper .",
    "let us first transform the system ( [ flt_01_01 ] ) to the @xmath0 matrix representation ( [ ff_1])-([ff_6 ] ) .",
    "if we take @xmath211 in ( [ ff_6 ] ) as follows ,    @xmath266    then , after some straightforward manipulations , we obtain the equations    @xmath267    where    @xmath268    @xmath269    and the @xmath0 matrix arguments @xmath270 are given by the formulas ( [ ff_3])-([ff_5 ] ) .",
    "the equivalent to the eight equations ( [ flt_07 ] ) system of the six independent equations was already obtained in the course of this paper . to get it ,",
    "one simply has to substitute @xmath270 instead of @xmath271 and elements of the matrix @xmath272 instead of @xmath273 into the system ( [ s1d6 ] ) .",
    "the resulting system can be further simplified taking into account the special form of the matrix @xmath272 .",
    "if @xmath274 , then eq . ( [ flt_07 ] ) is equivalent to the system    @xmath275    and if @xmath276 ( @xmath277 and @xmath278 can be zero or nonzero only simultaneously ) , then the equivalent system takes on the form    @xmath279    it is intuitively clear that the two known analytical solutions for the four - lens telescopes are somehow connected with the symmetry relations ( [ flt_01_014 ] ) and ( [ flt_01_015 ] ) , but it is not obvious , when looking directly at the telescope matrix ( [ flt_01 ] ) , how to find other symmetry conditions , which could allow us to find new explicit solutions .",
    "one of the advantages of the @xmath0 matrix representation of eq .",
    "( [ flt_01_01 ] ) is that the form of the matrix @xmath272 in ( [ flt_07 ] ) gives us a useful hint that as such a symmetry condition one may try the condition    @xmath280    this condition , in the next turn , can be considered as a combination of the following three cases :    @xmath281    @xmath282    @xmath283    the condition ( [ flt_05_01 ] ) is satisfied if and only if at least one from the conditions ( [ flt_05_03])-([flt_05_04 ] ) is true .",
    "as we will see below , all three cases ( [ flt_05_03])-([flt_05_04 ] ) are actually analytically solvable and , moreover , include as their parts both previously known solutions .",
    "but , before giving the details , let us make one more useful preparatory step .",
    "as it is well known , the telescope matrix ( [ flt_01 ] ) is invariant under a scale transformation .",
    "it means that if the set    @xmath284    is the solution of the system ( [ flt_01_01 ] ) , then so is the set    @xmath285    where @xmath286 is an arbitrary positive number . that allows us in all further considerations to set the length of the middle drift @xmath287 equal to one chosen unit of length    @xmath288      if the condition ( [ flt_05_03 ] ) is satisfied , then @xmath289 and the equivalent to the equations ( [ flt_07 ] ) system is the system ( [ flt_10 ] ) .",
    "the necessary and sufficient conditions for this system to have solutions are that    @xmath290    if these conditions",
    "are satisfied , then the solution is unique ( with the precision up to the scale transformation ( [ flt_10_02 ] ) ) and is given by the following formulas :    @xmath291    @xmath292    @xmath293    @xmath294    where we have used the notations    @xmath295    as a partial case this solution includes a new inversor with zero entrance and exit drifts :    @xmath296    @xmath297    @xmath298      now we turn our attention to the condition ( [ flt_05_02 ] ) and will consider telescopes with equal magnification in both transverse planes :    @xmath299    according to the result of the previous subsection , none of such telescopes can exist if @xmath300 and therefore the system under study is the system ( [ flt_08 ] ) . by elementary analysis",
    "one can show that the necessary and sufficient conditions for the telescope with equal magnifications to exist are that    @xmath301    if these conditions are satisfied , then all possible solutions can be expressed as follows :    @xmath302    @xmath303    @xmath304    @xmath305    where the free parameters are @xmath306 , @xmath307 and @xmath308 satisfying the inequality    @xmath309    let us divide the central interval @xmath310 into two parts of the lengths @xmath311 and @xmath312 respectively and prescribe these subintervals to the first and to the second doublet cells correspondingly .",
    "comparing now the obtained above doublet settings with the settings provided by the generalization of the astronomical telescope , one can find that they coincide .",
    "but though this solution is already known , we still made a useful step .",
    "we proved that it is the only solution for the four - lens telescope with equal magnifications possible .",
    "the remaining case to analyze is the case ( [ flt_05_04 ] ) , which we will study under the additional assumptions that the length of the entrance drift @xmath313 is nonzero and that the horizontal and vertical magnifications are not equal to each other , because these situations were already considered in the previous subsections , i.e. , we will study telescopes with nonequal magnifications and with the special ratio of the entrance and exit drifts given by the relation ( [ flt_05_04 ] ) .",
    "the system for analysis is the system ( [ flt_08 ] ) , and the necessary and sufficient conditions for such a telescope to exist are that @xmath314 . if these conditions are satisfied , then all possible solutions can be expressed as follows :    @xmath315    @xmath316    @xmath317    @xmath318    @xmath319    @xmath320    @xmath321    where the @xmath322 are given by the formulas ( [ flt_11 ] ) and the free parameters are @xmath78 and @xmath313 satisfying the inequality    @xmath323    the solution ( [ flt_21])-([flt_27 ] ) has two continuous branches which are defined by the value of the parameter @xmath324 . in the limit @xmath325 the branch corresponding to    @xmath326    survives and converges to the solution ( [ flt_12])-([flt_15 ] ) , and",
    "the other branch diverges with @xmath87 and @xmath88 going to infinity .",
    "the solution ( [ flt_21])-([flt_27 ] ) also includes inversors described by the following formulas :    @xmath327    @xmath328    @xmath329    @xmath330    @xmath331    note that these inversors include the previously known solution for the inversor  @xcite as a partial case . to see that one has first to set @xmath332 and @xmath333 , where    @xmath334    in the solution ( [ flt_23_002])-([flt_23_4 ] ) , and then scale the result with @xmath286 according to the formulas ( [ flt_10_02 ] )",
    "in this appendix we will apply the explicit solution developed in this paper to the design of a beam line which allows an independent scan of the horizontal and the vertical phase advances while preserving the entrance and exit matching conditions for the twiss parameters . even though the purely numerical approach to this problem could result in a smaller number of lenses than we will use , it is not an easy task . besides the requirements to cover the specified range of phase advances and to preserve the entrance and exit matching condition",
    ", there are a number of additional constraints which one has to satisfy .",
    "they could include , for example , limitations on the lens strengths and limitations on the changes in the behavior of the betatron functions inside the beam line during the phase scan .",
    "for each lens , the outcome of the numerical optimization is a two - dimensional array of the lens settings corresponding to the chosen grid in the space of phase advances .",
    "every change in the design specifications ( which often happens during the design stage ) results in the necessity to repeat all optimization procedures with no warranty that the new output will be close to the previous one even for relatively small changes in the input requirements .",
    "the advantage of our approach is that most of the design problems can be addressed without resorting to unguided numerical calculations and that the lens settings required for obtaining the needed horizontal and vertical phase advances can be calculated according to explicit analytical formulas .",
    "note that our interest in this problem is motivated by the desire to have in the future the possibility for minimization of emittance growth due to coherent synchrotron radiation ( csr ) at the european xfel facility  @xcite by optimizing the phase advance between two bunch compressors chicanes .",
    "let us consider a fodo cell of the length @xmath156 which begins with a drift space of the length @xmath335 and let us assume that the first lens is horizontally focusing with the absolute value of its strength equal to the value              and allow the strengths of the remaining lenses to be variable parameters , then we will obtain the sequence of three four - lens blocks with decoupled transverse actions . we know that with the help of three blocks we can represent most of the @xmath103 uncoupled transfer matrices and let us see what range of phase advances our beam line can cover while preserving the periodic matching conditions ( [ fodo_1_1 ] ) for the twiss parameters . to keep this matching and , in the same time , to have predefined fractional parts of phase advances @xmath340 and @xmath341 , the overall transfer matrix of our beam line must have the form              following now the procedure described in sec .",
    "iii of this paper , one finds that for all @xmath348 the matrix ( [ equ_04 ] ) can be represented by three blocks with decoupled transverse actions and that for all @xmath349 the solution for the lens strengths is unique . as concerning points where either @xmath340 or @xmath341 is equal to @xmath350 , there are many solutions , but it is possible to choose one of them such that on the whole set @xmath348 the lens strengths will be continuous functions of the phase advances . the final formulas for the lens settings can be summarized as follows :                            what is in particular interesting in this solution is the fact that , though with changing phase advances the setting of six lenses varies , only four independent tuning knobs are required ( @xmath361 and @xmath362 ) .    if @xmath363 and/or @xmath364 approach the value @xmath365 , then the strengths of some lenses in our solution go to infinity , but if we restrict the region of our interest , for example , to the region @xmath366 , then the lens strengths remain bounded and satisfy the inequality      which , in particular , means that in this phase advance region none of the lenses change its polarity in comparison with their original fodo settings .",
    "if , in addition , the scan of only @xmath363 is required with @xmath368 , then the inequality ( [ fodo_31 ] ) is further relaxed to the inequality                        concerning the changes in the behavior of the betatron functions inside the beam line during the phase scan , then , for example , for all @xmath376 the betatron functions @xmath377 in each position @xmath378 along the beam line satisfy the inequalities          are the minimum and the maximum of the periodic fodo solution . in more details",
    "the behavior of the betatron functions along the beam line can be seen in figs .",
    "[ fig1]-[fig6 ] , where they are drawn for the several values of @xmath381 taken on the borders of the considered area and for the fodo cell length chosen to be one meter .",
    "the presented beam line for the scan of the phase advances is simple , rather elegant and , in the same time , can cover quite a range of phase advances with not very large changes in the lens strengths as compared to their original fodo settings .",
    "it can also be adopted to the needs of the european xfel , where the linac between the two bunch compressors has exactly six fodo cells and two additional quadrupole groups ( matching sections ) are available at both linac ends .",
    "note that it is not necessary to keep the periodic matching conditions ( [ fodo_1_1 ] ) .",
    "any two sets of twiss parameters can be fixed at the beam line ends , but one has to remember that the choice of them will affect the position of singularities of the solution obtained with the help of the three blocks with decoupled transverse actions . to avoid singularities completely and/or to have additional knob for the control of the betatron functions inside the beam line , one can switch to the solution which utilizes four blocks or to the solution with three blocks plus one additional lens . as described in sec .",
    "iv of this paper , the equal spacing of lenses can also be abandoned , if required ."
  ],
  "abstract_text": [
    "<S> in the design of beam transport lines , one often meets the problem of constructing a quadrupole lens system that will produce desired transfer matrices in both the horizontal and vertical planes . nowadays this problem is typically approached with the help of computer routines , but searching for the numerical solution one has to remember that it is not proven yet that an arbitrary four by four uncoupled beam transfer matrix can be represented by using a finite number of drifts and quadrupoles ( representation problem ) and the answer to this question is not known not only for more or less realistic quadrupole field models but also for the both most commonly used approximations of quadrupole focusing , namely thick and thin quadrupole lenses . in this paper we make a step forward in resolving the representation problem and , by giving an explicit solution , we prove that an arbitrary four by four uncoupled beam transfer matrix actually can be obtained as a product of a finite number of thin - lenses and drifts . </S>"
  ]
}