{
  "article_text": [
    "let @xmath0 be a finitely generated group with finite generating set @xmath1 . put @xmath2 and let @xmath3 be the canonical projection from the free monoid on @xmath4 to @xmath0 .",
    "the ( uniform ) submonoid membership problem for @xmath0 takes as input words @xmath5 and asks whether @xmath6 belongs to the submonoid generated by @xmath7 .",
    "note that this problem generalizes the subgroup membership problem ( or generalized word problem ) for @xmath0 .",
    "the ( uniform ) rational subset membership problem for @xmath0 takes as input a word @xmath8 and a finite automaton @xmath9 over @xmath10 and asks whether @xmath11 .",
    "recall that a finite automaton @xmath9 over @xmath4 is a tuple @xmath12 where @xmath13 , @xmath14 is the initial state and @xmath15 is the set of final states .",
    "the language @xmath16 recognized by @xmath9 is the set of all finite words from @xmath10 that label a path from the initial state @xmath17 to some state from @xmath18 .",
    "a set of the form @xmath19 is called a rational subset of @xmath0 .    study of rational subsets of groups began with the pioneering work of benois on free groups  @xcite and eilenberg and schtzenberger on abelian groups  @xcite .",
    "rational subsets of groups were further studied in  @xcite , where it was shown that a subgroup is a rational subset if and only if it is finitely generated , from which one obtains an easy proof of howson s theorem ( in essence the same as stallings proof  @xcite ) .",
    "recently , there has been renewed interest in the subject of rational subsets of groups  @xcite , especially in connection to solving equations over groups  @xcite and the isomorphism problem for toral relatively hyperbolic groups  @xcite . on the other hand , work of stephen  @xcite and ivanov , margolis and meakin  @xcite on the word problem for certain inverse monoids has spurred some interest in the submonoid membership problem .",
    "in particular , the word problem for one - relator inverse monoids motivated the paper  @xcite , where membership in positively generated submonoids of certain groups given by monoid presentations is considered .",
    "recently , the authors have shown that the submonoid membership problem is undecidable in free metabelian groups of rank @xmath20  @xcite .",
    "trivially , decidability of the rational subset membership problem implies decidability of the submonoid membership problem . in previous work",
    "@xcite , the authors showed that these two problems are recursively equivalent for graph groups ( also known as right - angled artin groups or free partially commutative groups ) and gave the precise class of graph groups for which these problems are decidable .",
    "the authors were also able to prove that these problems are recursively equivalent for certain amalgamated free products ( including free products ) and hnn extensions with finite edge groups .",
    "this led the authors to conjecture that the rational subset membership and submonoid membership problems are recursively equivalent for groups with two or more ends .",
    "the main result of this paper is to establish our conjecture .",
    "recall that if @xmath21 is a locally finite graph , then the space of ends of @xmath21 is the projective limit @xmath22 where @xmath18 runs over all finite subgraphs of @xmath21 and @xmath23 is the set of connected components of @xmath24 . if @xmath0 is a group with finite generating set @xmath1 ,",
    "then the number of ends @xmath25 of @xmath0 is the cardinality of the space of ends of its cayley graph @xmath21 with respect to @xmath1 ; it is well known that this number depends only on @xmath0 and not @xmath1 .",
    "moreover , it is a result of hopf that @xmath25 is either @xmath26 or is infinite .",
    "clearly @xmath27 if and only if @xmath0 is finite .",
    "it is well known that @xmath28 if and only if @xmath0 is virtually cyclic .",
    "stallings famous ends theorem  @xcite says that @xmath29 if and only if @xmath0 splits non - trivially as an amalgamated free product or an hnn extension over a finite subgroup , or , equivalently , @xmath0 has an edge - transitively action without inversions on a simplicial tree with no global fixed points and finite edge stabilizers .",
    "our main theorem is then the following result .",
    "[ newmain ] let @xmath0 be a finitely generated group with two or more ends .",
    "then the submonoid membership and rational subset membership problems for @xmath0 are recursively equivalent . moreover , there is a fixed rational subset of @xmath0 with undecidable membership problem if and only if there is a fixed finitely generated submonoid of @xmath0 with undecidable membership problem .",
    "we remark that the proof of the last statement in theorem  [ newmain ] is an existence argument : we do not give an algorithm that constructs a finitely generated submonoid with undecidable membership problem from a rational subset with undecidable membership problem .",
    "the case that @xmath0 in theorem  [ newmain ] has two ends is clear since a two - ended group is virtually cyclic and hence has a decidable rational subset membership problem . so the interesting case is a group with infinitely many ends .    the paper is organized as follows .",
    "section  [ sec acting on trees ] proves some results about groups acting on trees that will allow us to reduce theorem  [ newmain ] to a special case .",
    "this special case is then handled in section  [ sec main lemma ] .",
    "the goal of this section is to reduce our considerations to a particular type of hnn extension .",
    "the notion of a ( simplicial ) tree is understood in the sense of serre  @xcite .",
    "an edge @xmath30 with initial vertex @xmath31 and terminal vertex @xmath32 is written as @xmath33 .",
    "then , there is an inverse edge @xmath34 , which never equals @xmath30 .",
    "the pair @xmath35 is called a _ geometric edge _ , as it corresponds to an edge of the geometric realization of the tree .",
    "often we do not distinguish between an edge and the corresponding geometric edge .",
    "let @xmath36 be a tree .",
    "if @xmath37 are vertices of a tree @xmath36 , then @xmath38 $ ] denotes the geodesic ( or reduced ) path from @xmath31 to @xmath32 in @xmath36 .",
    "note that a path in @xmath36 is geodesic if and only if it does not contain any backtracking , i.e , an edge followed by its inverse edge .",
    "an automorphism @xmath39 of @xmath36 is _ without inversions _ if , for each edge @xmath30 of @xmath36 , @xmath40 .",
    "let @xmath0 be a group acting on @xmath36 ( by automorphisms of @xmath36 ) .",
    "then @xmath0 acts _ without inversions on @xmath36 _ if every @xmath41 is without inversions . throughout this paper",
    ", we tacitly assume that all actions of groups on trees are without inversions .",
    "we say that @xmath0 acts _ edge - transitively _ on @xmath36 if @xmath0 acts transitively on the set of geometric edges .",
    "the stabilizer in @xmath0 of a vertex or edge @xmath42 of @xmath36 will be denoted @xmath43 . of course ,",
    "@xmath44 for any edge @xmath30 .",
    "a vertex @xmath31 is called a _ global fixed point _ if @xmath45 .",
    "the following lemma is well known , but we include a proof for completeness .",
    "[ uniquemaximalfinite ] let @xmath0 be a finitely generated group acting edge - transitively on a tree @xmath36 without global fixed points and with finite edge stabilizers ( thus @xmath0 has more than one end ) .",
    "then the kernel of the action of @xmath0 on @xmath36 is the unique maximal finite normal subgroup of @xmath0 .",
    "let @xmath46 be an edge stabilizer ; it is finite by assumption .",
    "the kernel @xmath24 of the action of @xmath0 on @xmath36 is clearly contained in @xmath46 and hence is a finite normal subgroup .",
    "let us show that every finite normal subgroup @xmath47 of @xmath0 is contained in @xmath24 . since @xmath47 is finite , it fixes some vertex @xmath31 of @xmath36  @xcite .",
    "since @xmath0 has no global fixed point , we can find an element @xmath48 such that @xmath49 .",
    "let @xmath50 $ ] be the geodesic from @xmath31 to @xmath51 in @xmath36 .",
    "then since @xmath52 fixes @xmath31 and @xmath51 , it fixes @xmath50 $ ] ( since @xmath36 is a tree ) and hence it fixes some edge of this geodesic .",
    "since @xmath0 acts edge - transitively on @xmath36 and @xmath47 is normal , it follows that @xmath47 fixes every edge of @xmath36 and hence @xmath53 .",
    "this completes the proof .",
    "the chief result in this section is a reduction to the case of an hnn extension of a very special sort .",
    "recall that if @xmath54 is a group and @xmath55 is a _ partial automorphism _ of @xmath54 , i.e. , an isomorphism between subgroups @xmath56 and @xmath57 of @xmath54 , then the corresponding hnn extension is the group @xmath58 given by the presentation @xmath59 .",
    "we first need some results concerning groups acting on trees , which may be of interest in their own right .",
    "we recall a result of tits ( cf .",
    "@xcite ) that an automorphism @xmath39 of a tree @xmath36 ( without inversions ) either fixes a vertex , in which case it is called _ elliptic _ , or it leaves invariant a unique line @xmath60 , called its _ axis _ , on which it acts via translation by some positive integer length .",
    "elements of the latter sort are called _",
    "hyperbolic_. of course , hyperbolic elements have infinite order .",
    "our next lemma is a geometric version of a result proved combinatorially ( and separately ) for amalgamated free products and hnn extensions with finite edge groups  @xcite .",
    "[ constructsequence ] let @xmath0 be a finitely generated group acting edge - transitively on a tree @xmath36 without global fixed points and with finite edge stabilizers ( thus @xmath0 has more than one end ) .",
    "let @xmath33 be an edge of @xmath36 and suppose that @xmath46 is finite proper subgroup of both @xmath61 and @xmath62 .",
    "then there is an element @xmath63 such that @xmath64 where @xmath24 is the largest finite normal subgroup of @xmath0 .",
    "since the pointwise stabilizer of a geodesic is the intersection of the stabilizers of all its edges ( and hence has size bounded by @xmath65 ) , it follows that there is a non - empty finite geodesic path @xmath66 whose pointwise stabilizer @xmath54 has smallest cardinality amongst all geodesics in @xmath36 . without loss of generality",
    ", we may assume that @xmath66 starts with either @xmath30 or @xmath67 ( else translate it to do so ) .",
    "moreover , if @xmath66 starts with @xmath67 we can replace @xmath30 by @xmath67 and hence we may assume that @xmath66 starts with @xmath30 .",
    "let @xmath68 with @xmath63 and @xmath69 be the last edge traversed by @xmath66 .",
    "we claim that we can choose @xmath66 so that @xmath70 .",
    "if this is not the case , i.e. , the last vertex of @xmath66 is @xmath71 , then we can choose @xmath72 and consider the path @xmath73 .",
    "we then have the situation in figure  [ fig : wrongway ] .",
    "( 47,10 ) ( v)(0,5)@xmath31 ( w)(10,5)@xmath32 ( sw)(30,5)@xmath74 ( sv)(40,5)@xmath71 ( gsw)(47,0)@xmath75 ( v , w)@xmath30 ( sv , sw)@xmath76 ( sv , gsw)@xmath77 ( w,-30,10,sw,150,10)@xmath78 $ ]    any element of @xmath0 that fixes @xmath79 must then fix @xmath66 and hence the pointwise stabilizer of @xmath79 coincides with @xmath54 by minimality . thus replacing @xmath80 by @xmath81 , we are in the desired situation .",
    "in particular , it follows that we may take @xmath80 to be a hyperbolic element with @xmath82 $ ] a fundamental domain for the action of @xmath80 on its axis @xmath83 , as the edges @xmath84 are coherent in the sense of  @xcite . since every element that stabilizes @xmath30 and @xmath76 stabilizes @xmath66 , we have @xmath85 .",
    "we will show that @xmath86 , where @xmath24 is the largest finite normal subgroup of @xmath0 .",
    "recall from lemma  [ uniquemaximalfinite ] that @xmath24 is the kernel of the action of @xmath0 on @xmath36 .",
    "hence , @xmath87 .",
    "it remains to show that @xmath88 , i.e. , that @xmath54 stabilizes every edge of @xmath36 .",
    "first we show that @xmath54 is the pointwise stabilizer of @xmath83 .",
    "clearly , the pointwise stabilizer of @xmath83 is contained in @xmath54 , since @xmath66 is contained in @xmath83 .",
    "if the pointwise stabilizer of @xmath83 is not equal to @xmath54 , then some edge @xmath89 of @xmath83 is not stabilized by some element of @xmath54 . by extending @xmath66 to a reduced path in the line @xmath83 containing @xmath89",
    ", we obtain a reduced path with a smaller pointwise stabilizer than @xmath66 , a contradiction .",
    "next , observe that @xmath54 is closed under conjugation by all powers of @xmath80 since @xmath83 is @xmath90-invariant and @xmath54 is the pointwise stabilizer of @xmath83 .",
    "suppose now that @xmath91 is an edge of @xmath92 with @xmath48 .",
    "let @xmath93 be the geodesic path from @xmath91 to @xmath83 .",
    "clearly , @xmath54 stabilizes @xmath91 if and only if it stabilizes @xmath94 for some @xmath95 since @xmath96 .",
    "moreover , the geodesic path from @xmath94 to @xmath83 is @xmath97 .",
    "thus without loss of generality , we may assume that @xmath93 ends at a vertex @xmath98 of @xmath99 $ ] with @xmath100 .",
    "then @xmath101r{^{-1}}(ge)^{\\varepsilon}$ ] is a reduced path ( see figure  [ fig : path - p ] ) containing @xmath66 as an initial segment , for an appropriate choice of @xmath102 , and hence has pointwise stabilizer contained in @xmath54 . but by choice of @xmath66 , the pointwise stabilizer of @xmath101r{^{-1}}(ge)^{\\varepsilon}$ ] can not be properly contained in @xmath54 .",
    "thus @xmath54 stabilizes @xmath91 , i.e , @xmath54 stabilizes every edge of @xmath36 and hence @xmath86 .",
    "this completes the proof .",
    "( 62,24)(0,-8 ) ( c)(0,-5 ) ( v)(10,-5)@xmath31 ( w)(18,-5)@xmath32 ( c , v ) ( v , w)@xmath30 ( sv)(30,-5)@xmath71 ( sw)(38,-5)@xmath74 ( sv , sw)@xmath76 ( w , sv ) ( u)(50,-5)@xmath98 ( sw , u ) ( d)(62,-5 ) ( u , d)@xmath83 ( a)(50,13 ) ( b)(50,5 ) ( b , a)@xmath103 ( u,130,5,b,-50,5)@xmath104 ( 10,-3)@xmath105    our next proposition uses the element @xmath80 constructed above to create subgroups of a special form .",
    "[ treeactionresult ] let @xmath0 be a group acting on a tree @xmath36 .",
    "let @xmath106 be an edge of @xmath36 and put @xmath107 .",
    "suppose that :    a.   @xmath108\\geq 3 $ ] ; b.   @xmath109\\geq 2 $ ] ; c.   there is an element @xmath63 with @xmath110 .",
    "then @xmath0 contains a subgroup isomorphic to an amalgamated free product of the form @xmath111 . moreover , if @xmath46 is finite , then @xmath0 contains a subgroup isomorphic to @xmath112 , where @xmath113 is the identity map on @xmath47 .",
    "we begin by observing that @xmath47 consists of those element of @xmath0 that stabilize all translates of @xmath30 . our third hypothesis ( c )",
    "then says that there is a translate @xmath76 so that the subgroup of elements fixing both @xmath30 and @xmath76 is exactly @xmath47 .",
    "our initial goal is to show that we may assume that the geodesic @xmath82 $ ] from @xmath31 to @xmath71 contains both @xmath30 and @xmath76 .",
    "first suppose the geodesic contains exactly one of these edges .",
    "replacing @xmath30 by @xmath76 and @xmath80 by @xmath114 if necessary , we may assume without loss of generality that it contains @xmath30 .",
    "since @xmath115 by ( b ) , we can choose @xmath116 .",
    "then we have the situation in figure  [ fig : point1 ] .",
    "( 47,10 ) ( v)(0,5)@xmath31 ( w)(10,5)@xmath32 ( sv)(30,5)@xmath71 ( sw)(40,5)@xmath74 ( gsv)(47,0)@xmath117 ( v , w)@xmath30 ( sv , sw)@xmath76 ( gsv , sw)@xmath77 ( w,-30,10,sv,150,10)@xmath118 $ ]    any element of @xmath0 that fixes @xmath30 and @xmath77 must then fix @xmath30 and @xmath76 and so @xmath119 .",
    "moreover , @xmath30 and @xmath77 belong to @xmath120 $ ] . thus replacing @xmath80 by @xmath81 , we are in the desired situation .",
    "next suppose that neither @xmath30 nor @xmath76 belong to @xmath82 $ ] .",
    "choose @xmath116 .",
    "then we have the picture in figure  [ fig : point2 ] .",
    "( 47,10 ) ( w)(0,5)@xmath32 ( v)(10,5)@xmath31 ( sv)(30,5)@xmath71 ( sw)(40,5)@xmath74 ( gsv)(47,0)@xmath117 ( v , w)@xmath30 ( sv , sw)@xmath76 ( gsv , sw)@xmath77 ( v,-30,10,sv,150,10)@xmath82 $ ]    again any element of @xmath0 which fixes @xmath30 and @xmath77 must fix also @xmath76 and hence belong to @xmath47 . thus @xmath119 .",
    "moreover , @xmath77 is an edge of @xmath120 $ ] and so replacing @xmath80 by @xmath81 leads us to the previous case where exactly one of the edges is on the geodesic .",
    "thus we may now assume that @xmath30 and @xmath76 belong to @xmath82 $ ] .",
    "choose @xmath121 .",
    "then we have the situation in figure  [ fig : axisx ] . the edges @xmath30 and @xmath122 are coherent in the sense of  @xcite .",
    "( 47,16)(0,-3 ) ( v)(0,5)@xmath31 ( w)(10,5)@xmath32 ( sw)(30,5)@xmath74 ( sv)(40,5)@xmath71 ( sv)(43,5)@xmath123 ( gw)(7,0)@xmath124 ( sgw)(47,0)@xmath125 ( sgw)(50.8,0)@xmath126 ( v , w)@xmath30 ( sv , sw)@xmath76 ( v , gw)@xmath91 ( sv , sgw)@xmath127 ( w,-30,10,sw,150,10)@xmath78 $ ] ( a)(35,13 ) ( b)(35,-3 ) ( a , b)@xmath128 ( a , b)@xmath129    thus @xmath130 is a hyperbolic element with axis @xmath131 $ ] and @xmath82 $ ] is a fundamental domain for the action of @xmath42 on @xmath132 ( cf .",
    "let @xmath128 be the connected component of @xmath133 containing @xmath71 and let @xmath129 be the connected component of @xmath133 containing @xmath74 .",
    "since @xmath108\\geq 3 $ ] by ( a ) and @xmath132 contains only one other ( geometric ) edge incident on @xmath31 besides @xmath30 , we can find @xmath134 so that @xmath135",
    ". then @xmath136 is a hyperbolic element with axis @xmath137 .",
    "the axes @xmath138 and @xmath132 intersect at the vertex @xmath139 , but do not coincide since @xmath140 .",
    "thus @xmath141 is either a point , a segment or an infinite ray .",
    "notice that @xmath142 and @xmath143 each contain exactly one of the two ends of @xmath132 . interchanging @xmath30 with @xmath76 and @xmath80 with @xmath114 in the statement of the proposition if necessary",
    ", we may assume that @xmath141 does not contain the end of @xmath132 determined by @xmath143 .",
    "then , since @xmath42 acts on @xmath132 by translations in the direction @xmath31 to @xmath71 , by choosing @xmath144 large enough , we can guarantee that @xmath145 is contained in @xmath128 and does not contain the vertex @xmath71 .",
    "putting @xmath146 yields a hyperbolic element @xmath147 with axis @xmath148 such that @xmath149 is contained in @xmath128 and does not contain @xmath71 .",
    "the picture is either as in figure  [ fig : lastpic ] or  [ fig : lastpic2 ] .",
    "( 54.5,20)(0,-5 ) ( v)(0,5)@xmath31 ( w)(8,5)@xmath32 ( sw)(28,5)@xmath74 ( sv)(36,5)@xmath150 ( v , w)@xmath30 ( sv , sw)@xmath76 ( w,-30,10,sw,140,10)@xmath78 $ ] ( a)(32,15 ) ( b)(32,-5 ) ( a , b)@xmath128 ( a , b)@xmath129 ( 37.5,4,40,.07,42,.07,44,.07 ) ( 37.5 , -4 , 40 , -.07 , 42 , -.07 , 44 , -.07 ) ( 44,.07)(48,.07 ) ( 44,-.07)(48,-.07 ) ( 48,.07 , 50,.07,52,.07 , 54.5,4 ) ( 48 , -.07 , 50 , -.07 , 52 , -.07 , 54.5 , -4 ) ( 40,1.7)@xmath132(40,-2.5)@xmath151    ( 52,20)(0,-5 ) ( v)(0,5)@xmath31 ( w)(8,5)@xmath32 ( sw)(28,5)@xmath74 ( sv)(36,5)@xmath150 ( v , w)@xmath30 ( sv , sw)@xmath76 ( w,-30,10,sw,140,10)@xmath78 $ ] ( a)(32,15 ) ( b)(32,-5 ) ( a , b)@xmath128 ( a , b)@xmath129 ( 37.5,4,40,.07,42,.07,44,.07 ) ( 37.5 , -4 , 40 , -.07 , 42 , -.07 , 44 , -.07 ) ( 44,.07)(52,.07 ) ( 44,-.07)(52,-.07 ) ( 40,1.7)@xmath132(40,-2.5)@xmath151    let @xmath152 and @xmath153 . since @xmath98 is hyperbolic and elements of @xmath47 are elliptic , it follows that @xmath154",
    ". consequently , @xmath155 via the conjugation action of @xmath98 on @xmath47 . also ,",
    "if @xmath47 is finite , then we can find a power @xmath144 so that @xmath156 acts trivially on @xmath47 by conjugation .",
    "then @xmath156 is a hyperbolic element with the same axis as @xmath98 , but a larger translation length . replacing @xmath98 by @xmath156",
    ", we may then assume that @xmath98 commutes elementwise with @xmath47 and so @xmath157 .",
    "also note that @xmath158 .",
    "indeed , if @xmath159 , we can write @xmath160 with @xmath161 . then since @xmath162 , we have @xmath163 if and only if @xmath164 , if and only if @xmath165 since @xmath98 is hyperbolic .",
    "we claim that @xmath166 and @xmath167 generate a subgroup isomorphic to @xmath168 .",
    "to prove this , we use the so - called ping pong lemma  @xcite .",
    "the ping pong lemma has the following setup : a group @xmath0 acting on a set @xmath24 , subgroups @xmath166 and @xmath167 of @xmath0 with @xmath169\\geq 3 , [ h_2:n]\\geq 2 $ ] , where @xmath170 , and non - empty subsets @xmath171 with @xmath172 such that :    * @xmath173 for all @xmath174 ; * @xmath175 for all @xmath176 .",
    "the conclusion of the lemma is that the subgroup of @xmath0 generated by @xmath166 and @xmath167 is isomorphic to the amalgamated free product @xmath177 .",
    "we apply the ping pong lemma to our subgroups @xmath178 .",
    "we take @xmath24 to be @xmath36 , whereas @xmath128 and @xmath129 have already been defined above .",
    "one should think of the edge @xmath76 as the net of the ping pong table @xmath24 .",
    "note that in our case @xmath169=\\infty$ ] , whereas @xmath179\\geq [ g_v : g_e]\\geq 3 $ ] .",
    "let @xmath180 with @xmath161 .",
    "then @xmath181 fixes @xmath82 $ ] because it fixes @xmath30 and @xmath76 .",
    "let @xmath79 be the geodesic from @xmath71 to @xmath182 ; it is non - empty by choice of @xmath98 . as any non - trivial element @xmath183 of @xmath184 acts as a translation on the axis @xmath151",
    ", it follows that the geodesic @xmath185=[u^msv , sv]$ ] must pass through a vertex of @xmath186 as per figure  [ fig : geodesic ] .",
    "( 28,20)(24,-5 ) ( sw)(24,5)@xmath74 ( sv)(36,5)@xmath71 ( hsv)(46,5)@xmath187 ( sgw)(50.2,5)@xmath188 ( a)(31,15 ) ( b)(31,-6 ) ( a , b)@xmath128 ( a , b)@xmath129 ( sv , sw)@xmath76 ( c)(33,-5 ) ( d)(52,-5 ) ( c , d)@xmath151 ( e)(36,-5 ) ( f)(46,-5 ) ( sv,-50,5,e,130,5)@xmath79 ( hsv,-50,5,f,130,5)@xmath189    since @xmath186 is contained in @xmath128 , it follows that @xmath66 is contained in @xmath128 .",
    "let @xmath190 .",
    "we claim that @xmath191\\cup [ ksv , sv ] = [ kv_0,ksv]\\cup p$ ] is the geodesic from @xmath192 to @xmath71 , which implies that this path ( and hence @xmath192 ) is contained in @xmath128 since @xmath66 is contained in @xmath128 . to show that @xmath191\\cup [ ksv , sv]$ ] is a geodesic , note that @xmath191 $ ] ends with the edge @xmath193 .",
    "hence , it suffices to show that @xmath66 does not begin with the edge @xmath194 .",
    "the geodesic @xmath195 $ ] begins with the path @xmath189 , see figure  [ fig : geodesic ] .",
    "since @xmath196 does not contain @xmath76 , @xmath189 does not contain @xmath197 .",
    "we have thus shown @xmath198 .",
    "on the other hand , if @xmath199 , then @xmath200 stabilizes @xmath31 but not @xmath76 ( since if it stabilizes @xmath31 and @xmath76 , then it must also stabilize @xmath30 and so belong to @xmath47 by assumption on @xmath80 ) . since @xmath201 and @xmath202 , there is a last vertex @xmath203 on the geodesic @xmath82 $ ] fixed by @xmath200 and @xmath204 .",
    "let @xmath205 .",
    "then by definition of @xmath128 , it follows that @xmath206=[v_1,sv]\\cup [ sv , v_0]$ ] and hence @xmath207=k[v_1,v_0]=k[v_1,sv]\\cup k[sv , v_0]$ ] .",
    "notice that @xmath208=[ksv , v_0]$ ] can not contain any edge of @xmath82 $ ] by choice of @xmath203 .",
    "therefore , @xmath209\\cup k[sv , v_0]\\cup [ v_0,sv]=[kv_1,sv]$ ] ( see figure  [ fig:2nd - inclusion ] ) and hence @xmath210 $ ] contains the edge @xmath76 .",
    "it follows that @xmath211 and so @xmath212 .",
    "the ping pong lemma now yields that @xmath213 , completing the proof .",
    "( 52,28)(0,-5 ) ( v)(0,-3)@xmath31 ( sv)(36,-3)@xmath71 ( v0)(18,-3)@xmath203 ( ksv)(18,15)@xmath187 ( v1)(42,3)@xmath214 ( kv1)(24,21)@xmath215 ( v,-30,10,v0,140,10 ) ( v0,-30,10,sv,140,10 ) ( v0,60,10,ksv,240,10 ) ( sv,15,5,v1,195,5 ) ( ksv,15,5,kv1,195,5 ) ( a)(32,22 ) ( b)(32,-5 ) ( a , b)@xmath128 ( a , b)@xmath129    the proposition admits the following corollary .",
    "[ reducetospecial ] let @xmath0 be a finitely generated group splitting non - trivially over a finite subgroup @xmath56 .",
    "suppose that @xmath54 is an infinite vertex group of the corresponding splitting .",
    "then @xmath0 has a subgroup isomorphic to the hnn extension @xmath216 where @xmath24 is the largest finite normal subgroup of @xmath0 and @xmath217 is the identity mapping .",
    "let @xmath36 be the bass - serre tree associated to the splitting of @xmath0 over @xmath56 .",
    "it follows that there is an edge @xmath106 of @xmath36 so that @xmath218 and @xmath219 .",
    "moreover , since the splitting is non - trivial and also @xmath0 can not be an ascending hnn extension of @xmath54 as @xmath54 is infinite and @xmath56 is finite , we must have @xmath220 .",
    "the action of @xmath0 on @xmath36 is edge - transitively and has no global fixed point .",
    "lemma  [ constructsequence ] provides @xmath221 with @xmath222 observing that @xmath223 , proposition  [ treeactionresult ] then allows us to conclude that @xmath0 contains a subgroup isomorphic to @xmath224 , which is easily seen to be isomorphic to the desired hnn extension .",
    "the following technical result , which is the heart of this paper , will be proved in the next section .",
    "[ techlemma ] let @xmath225 be an hnn extension with @xmath24 a finite proper normal subgroup of @xmath54 . then the rational subset membership problem for @xmath54 can be reduced to the submonoid membership problem for @xmath0 .",
    "moreover , if @xmath54 has a fixed rational subset with undecidable membership problem , then @xmath0 has a fixed finitely generated submonoid with undecidable membership problem .",
    "let us now prove theorem  [ newmain ] assuming lemma  [ techlemma ] .",
    "for the first statement of theorem  [ newmain ] , the non - trivial direction is to show that the rational subset membership problem for @xmath0 reduces to the submonoid membership problem for @xmath0 . by stallings ends",
    "theorem  @xcite the group @xmath0 splits non - trivially over a finite subgroup @xmath56 . by the results of  @xcite",
    ", the rational subset membership problem for @xmath0 reduces to the rational subset membership problem for the vertex group(s ) of the splitting .",
    "hence , it suffices to show that if @xmath54 is a vertex group of the splitting , then @xmath54 has decidable rational subset membership problem .",
    "if @xmath54 is finite , there is nothing to prove , so we may assume that @xmath54 is infinite .",
    "then by corollary  [ reducetospecial ] , @xmath0 contains a subgroup isomorphic to @xmath216 .",
    "clearly , also @xmath216 has a decidable submonoid membership problem .",
    "the result now follows from lemma  [ techlemma ] .",
    "the non - trivial direction of the second statement is to show that if @xmath0 has a fixed rational subset with undecidable membership problem , then it has a fixed finitely generated submonoid with undecidable membership problem . in  @xcite the membership problem for a fixed rational subset of @xmath0 is reduced to the membership problem of a finite number of fixed rational subsets of the vertex groups ( in the splitting over @xmath56 ) .",
    "hence one of the vertex groups @xmath54 has a fixed rational subset with undecidable membership problem ; necessarily @xmath54 is infinite .",
    "corollary  [ reducetospecial ] then applies to allow us to deduce that @xmath0 has a fixed subgroup of the form @xmath216 where @xmath24 is a finite proper normal subgroup of @xmath54 and @xmath54 has a fixed rational subset with undecidable membership problem .",
    "thus by lemma  [ techlemma ] , we conclude @xmath0 has a fixed finitely generated submonoid with undecidable membership problem .",
    "this completes the proof .",
    "let us fix an hnn - extension @xmath226 , where @xmath24 is a proper finite normal subgroup of the finitely generated group @xmath54 .",
    "we assume furthermore that @xmath54 is infinite .",
    "the group @xmath54 acts on @xmath24 by conjugation and since @xmath24 is finite , the kernel @xmath47 of this action has finite index in @xmath54 ( and hence is finitely generated ) . in particular",
    ", @xmath47 is infinite and so @xmath227 is a proper subgroup of @xmath47 .",
    "since decidability of rational subset membership is a virtual property  @xcite , to show that @xmath54 has decidable rational subset membership , it suffices to prove that @xmath47 has decidable rational subset membership .",
    "let @xmath228 .",
    "then @xmath229 centralizes @xmath24 and so in particular , @xmath230 is contained in the center of @xmath229 .",
    "let us fix a finite group generating set @xmath1 for @xmath47 and denote by @xmath231 the canonical projection .",
    "without loss of generality assume that @xmath232 .",
    "suppose that @xmath233 is a finite automaton , for a state @xmath234 , let @xmath235 be the set of all elements from @xmath236 represented by a word labeling a loop at state @xmath79 .",
    "note that these elements form a submonoid of @xmath236 and therefore ( since @xmath236 is finite ) a subgroup of @xmath236 .",
    "let @xmath237 be the set @xmath238 .",
    "the proof of the following lemma is quite similar to the proof of lemma  11 and theorem  7 in @xcite .",
    "[ lemma main ] from a given finite automaton @xmath9 over @xmath4 and an element @xmath239 ( given as a word over @xmath4 ) we can construct effectively a finite subset @xmath240 and an element @xmath241 such that @xmath242 if and only if @xmath243 .",
    "let @xmath233 .",
    "without loss of generality assume that @xmath244 and @xmath245 for all @xmath234 . by introducing @xmath246-transitions",
    ", we may also assume that the set of final states @xmath18 consists of a single state @xmath247 .",
    "we will construct a finite subset @xmath240 and an element @xmath241 such that @xmath242 if and only if @xmath243 .",
    "fix an element @xmath248 ( hence also @xmath249 ) . without loss of generality",
    "we may assume that @xmath250 .",
    "for every @xmath251 , define @xmath252 \\in k$ ] by @xmath253 = t^q k t^{-q}.\\ ] ] note that @xmath252 x = x [ q]$ ] for all @xmath254 since @xmath229 centralizes @xmath24 . let @xmath255 c [ p]^{-1 } \\mid ( q , c , p ) \\in \\delta \\ } \\quad\\text { and } \\quad g = [ q_0 ] h [ q_f]^{-1 } .\\ ] ] where we abuse notation by treating @xmath4 as if it were a subset of @xmath47 .",
    "observe that in , we have @xmath256 , since we introduced @xmath246-transitions . also @xmath257 .",
    "note that @xmath258 is contained in @xmath259 .",
    "indeed , if @xmath260 , then we can write @xmath261 where there are transitions @xmath262 then , since @xmath42 commutes with @xmath252 $ ] , we have @xmath263x[q]{^{-1}}= [ q]a_1[q_1]{^{-1}}[q_1]a_2[q_2]{^{-1}}\\cdots [ q_{m-1}]a_m[q]{^{-1}}\\in \\delta^*.\\ ] ] it follows that @xmath264 .",
    "we claim that @xmath242 if and only if @xmath243 .",
    "let @xmath265 .",
    "let us define a _",
    "@xmath24-cycle _ to be word in @xmath266 of the form @xmath267 h_1 [ q_2]^{-1 }   [ q_2 ] h_{2 } [ q_3]^{-1 } \\cdots [ q_{\\ell-1 } ] h_{\\ell-1 } [ q_\\ell]^{-1 } [ q_\\ell ] h_\\ell [ q_1]^{-1}\\ ] ] such that @xmath268 , @xmath269 , @xmath270 , and @xmath271 represents an element from the subgroup @xmath24 .",
    "since all elements from @xmath24 commute with all @xmath252 $ ] ( @xmath234 ) , an @xmath24-cycle equals an element from @xmath24 in @xmath0 ( actually an element of @xmath227 ) .    a word in @xmath266 of the form @xmath267 h_1 [ p_1]^{-1 } \\cdots[q_m ] h_m [ p_m]^{-1},\\ ] ] where @xmath272 and @xmath273 , is called _ @xmath24-cycle - free _ if it does not contain an @xmath24-cycle as a factor .",
    "_ claim 1._[newclaim1 ] suppose that @xmath274 with @xmath275 ( @xmath276 ) and @xmath277 ( @xmath278 ) .",
    "then the element @xmath279{^{-1}}[q_1][p_2]{^{-1}}[q_2]\\cdots [ p_m]{^{-1}}[q_m]\\ ] ] has a reduced expression in the hnn extension @xmath0 starting with @xmath280 and ending with @xmath281 .",
    "_ proof of claim 1 .",
    "_ we have @xmath282^{-1 } [ q_i ]   & = & \\prod_{i=1}^{m } t^{p_i } k{^{-1}}t^{-p_i } t^{q_i } k   t^{-q_{i } }   \\nonumber \\\\ & = & \\prod_{i=1}^{m } t^{p_i } k{^{-1}}t^{q_i - p_i } k   t^{-q_{i } }   \\nonumber \\\\ & = & t^{p_1 } \\biggl(\\prod_{i=1}^{m-1 } k{^{-1}}t^{q_i - p_i } k   t^{p_{i+1}-q_{i } } \\biggr ) k{^{-1}}t^{q_m - p_{m } } k t^{-q_m } .\\end{aligned}\\ ] ] the latter word is a reduced word for @xmath39 of the required form .",
    "this establishes claim 1 .",
    "let @xmath283 be the set of elements of the form .",
    "it follows immediately from the claim that any element @xmath284 of the form @xmath285 with @xmath286 , @xmath287 , and @xmath288 has a reduced expression for the hnn extension @xmath0 containing @xmath280 and @xmath281 and hence does not belong to @xmath47 .",
    "such elements @xmath284 will be called _",
    "good_. i.e. , @xmath284 is good if it can be written as an alternating word in elements of @xmath283 and @xmath289 with at least one factor from @xmath283 .",
    "_ claim 2 .",
    "_ assume that in the hnn - extension @xmath0 @xmath290 h [ r]^{-1 } = [ q_1 ] h_1 [ p_1]^{-1 } \\cdots[q_m ] h_m [ p_m]^{-1}\\ ] ] where @xmath291 , @xmath292 .",
    "if @xmath293 h_i [ p_i]^{-1}$ ] is @xmath24-cycle - free , then either @xmath294 , @xmath295 , and @xmath296 , or all of the following hold :    * @xmath297 and @xmath298 for all @xmath278 , * @xmath299 and @xmath300 , and * @xmath301 in @xmath47 .",
    "_ proof of claim 2 .",
    "_ we prove claim 2 by induction over @xmath302 . if @xmath294 , then becomes @xmath303{^{-1}}[r].\\ ] ] since @xmath304 , claim 1 immediately yields @xmath295 , and hence @xmath296 , as required .",
    "now assume that @xmath305 .",
    "_ @xmath306 and there is @xmath307 such that @xmath308",
    ". then implies @xmath309 h [ r]^{-1 } = \\biggl ( \\prod_{i=1}^{\\ell-1 } [ q_i ] h_i [ p_i]^{-1 } \\biggr ) [ q_\\ell ] ( h_\\ell h_{\\ell+1})[p_{\\ell+1}]^{-1 } \\biggl ( \\prod_{i=\\ell+2}^m [ q_i ] h_i [ p_i]^{-1}\\biggr)\\ ] ] in @xmath0 .",
    "since @xmath293 h_i",
    "[ p_i]^{-1}$ ] from is @xmath24-cycle - free , also the right hand side of this equality is @xmath24-cycle - free .",
    "hence , we can apply the induction hypothesis and obtain :    * @xmath298 for all @xmath310 and all @xmath311 , * @xmath299 and @xmath300 , and * @xmath301 in @xmath47 .    since @xmath308 we obtain @xmath298 for all @xmath278 .",
    "_ case 2 . _",
    "@xmath312 for all @xmath278 .",
    "we have to show that @xmath313 , @xmath299 , @xmath300 , and @xmath314 in @xmath47 .",
    "choose a set @xmath36 of coset representatives for @xmath315 with @xmath316 and write @xmath317 with @xmath318 and @xmath319 , for @xmath276 .",
    "from this definition we get @xmath320 where @xmath321 ( since @xmath47 centralizes @xmath24 ) .",
    "moreover , we also have @xmath322 h_i [ p_i]^{-1 } = x \\prod_{i=1}^m [ q_i ] h'_i [ p_i]^{-1}\\ ] ] since @xmath227 is central in @xmath229 .",
    "thus , again using that @xmath42 is central in @xmath229 , we have @xmath323{^{-1}}\\left(\\prod_{i=1}^m[q_i]h_i'[p_i]{^{-1}}\\right)[r].\\ ] ] since the right hand side of is @xmath24-cycle - free , if @xmath324 ( i.e. , @xmath325 ) , then @xmath326 , for all @xmath276 ( else @xmath327h_i[p_i]{^{-1}}$ ] is an @xmath24-cycle ) .",
    "also we are assuming @xmath328 .",
    "if @xmath329 , then @xmath330 . therefore , if both @xmath331 and @xmath332 , then the right hand side of represents a good element of @xmath0 and so can not belong to @xmath47 , as was observed just before the statement of claim 2 .",
    "this contradicts @xmath333 . similarly ,",
    "suppose @xmath334 and @xmath335",
    ". then @xmath336{^{-1}}\\left(\\prod_{i=2}^m[q_i]h_i'[p_i]{^{-1}}\\right)[r]\\ ] ] which is again good , a contradiction .",
    "the case @xmath331 and @xmath337 , is handled analogously .",
    "if @xmath338 and @xmath339 , then @xmath336{^{-1}}\\left(\\prod_{i=2}^{m-1}[q_i]h_i'[p_i]{^{-1}}\\right)[q_m]h_m'\\ ] ] and so is again good , a contradiction . the only remaining case is when @xmath340 , @xmath341 and @xmath313 .",
    "then @xmath342h[r]{^{-1}}=[n]h_1[r]{^{-1}}$ ] in @xmath0 and so @xmath314 in @xmath47 , as required .",
    "this proves claim 2 .",
    "an immediate consequence of claim 2 is :    _ claim 3 . _",
    "assume that in the hnn - extension @xmath0 @xmath343 h [ q_f]^{-1 } = [ q_1 ] a_1 [ p_1]^{-1 } \\cdots[q_m ] a_m [ p_m]^{-1},\\ ] ] where @xmath344 ( i.e. , @xmath327 a_i [ p_i]^{-1 } \\in \\delta$ ] ) for @xmath276 .",
    "if @xmath293 a_i [ p_i]^{-1}$ ] is @xmath24-cycle - free , then @xmath345 .",
    "the case @xmath297 follows immediately from claim  2 . in case @xmath294 , claim  2 implies @xmath346 and @xmath296 . but @xmath347 implies @xmath348 and hence @xmath345 .",
    "now we are ready to prove that @xmath242 if and only if @xmath349 h [ q_f]^{-1 } \\in \\delta^*$ ] .",
    "first assume that @xmath242 .",
    "let @xmath350 in @xmath47 , where @xmath351 and @xmath352 .",
    "hence , there are states @xmath353 with @xmath354 for @xmath276 , and @xmath355 .",
    "it was observed earlier that @xmath264 . moreover , since @xmath42 commutes with @xmath356 $ ] , we obtain in @xmath0 : @xmath357 h [ q_f]^{-1 } = x[q_0]a_1a_2 \\cdots a_m[q_f]^{-1 } = x\\prod_{i=1}^m [ q_{i-1 } ] a_i [ q_i]^{-1}\\in \\delta^*.\\ ] ] next assume that @xmath358 h [ q_f]^{-1 } \\in \\delta^*$ ] .",
    "thus , @xmath343 h [ q_f]^{-1 } =   [ q_1 ] a_1 [ p_1]^{-1 } \\cdots [ q_m ] a_m [ p_m]^{-1}\\ ] ] in @xmath0 , where @xmath272 , @xmath359 , and @xmath360 for @xmath276 .",
    "every @xmath24-cycle that occurs in @xmath293 a_i [ p_i]^{-1}$ ] can be reduced in @xmath0 to an element from some subgroup of the form @xmath235 . moreover , since @xmath24 is central in @xmath229 , we can move each of these elements to the beginning and then to the left - hand side @xmath356 h [ q_f]^{-1}$ ] by taking inverses . performing this reduction",
    "until no further @xmath24-cycles remain , we obtain in @xmath0 an equality @xmath361 x^{-1 } h [ q_f]^{-1 } =   [ n_1 ] b_1 [ r_1]^{-1 } [ n_2 ] b_2 [ r_2]^{-1 }               \\cdots [ n_\\ell ] b_\\ell [ r_\\ell]^{-1}\\ ] ] where @xmath362 and @xmath352 .",
    "since the right - hand side of is @xmath24-cycle free , claim  3 implies @xmath363 , i.e. , @xmath242 .",
    "let us consider again a finite automaton @xmath233 over the alphabet @xmath4 .",
    "a subset @xmath364 is called _ admissible _ if @xmath365 and @xmath366 . for every admissible subset @xmath364",
    "we define the automaton @xmath367 as follows : @xmath368 where the transition relation @xmath369 is given by @xmath370 the automaton @xmath367 works as follows .",
    "the construction is such that there is a run in @xmath367 of a word @xmath32 from @xmath371 to @xmath372 if and only if there is a run from @xmath17 to @xmath66 in @xmath9 that visits precisely the states in @xmath373 . in particular , @xmath374 consists of all words @xmath375 that label an accepting path in @xmath9 using exactly the vertices from @xmath376 .    [ lemma visit everything ] for every finite automaton @xmath377 and @xmath239 , we have : @xmath378 .    since @xmath379 for all admissible subsets , to prove the lemma it suffices to observe that if @xmath380 with @xmath381 , then the set @xmath376 of states visited by a successful run of @xmath32 is admissible and @xmath382 .",
    "we are now ready to prove lemma  [ techlemma ] .",
    "assume that @xmath225 , where @xmath24 is a proper finite normal subgroup of @xmath54 , has a decidable submonoid membership problem .",
    "we shall exhibit an algorithm for the rational subset membership problem for @xmath54 .",
    "if @xmath54 is finite , there is nothing to prove .",
    "so assume that @xmath54 is infinite .",
    "let @xmath47 be the centralizer of @xmath24 in @xmath54 and let @xmath228 .",
    "then @xmath47 has finite index in @xmath54 and so it suffices to show that @xmath47 has a decidable rational subset membership problem by  @xcite . for this",
    ", let @xmath233 be a finite automaton and let @xmath239 .",
    "we show how to decide @xmath383 . by lemma",
    "[ lemma visit everything ] it suffices to decide whether @xmath384 for some admissible subset @xmath385 .",
    "let us abbreviate the automaton @xmath367 by @xmath386 .",
    "recall that the set of states of @xmath386 is @xmath387 .",
    "now we apply lemma  [ lemma main ] and construct an element @xmath241 and a finite subset @xmath240 such that @xmath388 hence it suffices to prove @xmath389 .    it is immediate that @xmath390 .",
    "so it remains to establish that @xmath391 .",
    "to do this , it suffices to show that @xmath392 for every @xmath393 ( then we can conclude by induction over the length of the word from @xmath394 ) .",
    "let us take @xmath395 for some state @xmath372 of @xmath386 and consider a word @xmath396 with @xmath397 .",
    "hence , there exist states @xmath398 of @xmath386 such that :    * @xmath399 , * @xmath400 is a transition of @xmath386 for @xmath401 , and * @xmath402 , @xmath403 .    note that we have @xmath404 .",
    "hence , there exists an @xmath405 such that @xmath406 ( recall that @xmath407 was such that @xmath408 ) .",
    "since @xmath409 is central in @xmath47 , we have @xmath410 in @xmath47 . then there is a loop at state @xmath411 labeled with @xmath412 and @xmath413 by definition of @xmath414 . in particular",
    ", @xmath415 reads a loop in @xmath9 at @xmath66 visiting only states contained in @xmath416 .",
    "now , starting from the initial state @xmath417 we can read the word @xmath418 on the automaton @xmath386 . the state reached after reading @xmath419 , for @xmath420 , is of the form @xmath421 , where @xmath422 .",
    "hence , @xmath423 .",
    "this shows that @xmath424 .",
    "this completes the proof that @xmath47 has decidable rational subset membership problem .",
    "therefore , @xmath0 has decidable rational subset membership problem .",
    "on the other hand , if @xmath54 has a fixed rational subset with undecidable membership problem , then it follows from the construction in  @xcite that @xmath47 has a fixed rational subset @xmath19 with undecidable membership problem .",
    "it follows from lemma  [ lemma visit everything ] that @xmath374 has an undecidable membership problem for some @xmath376 .",
    "consequently , lemma  [ lemma main ] provides a fixed finitely generated submonoid of @xmath0 with undecidable membership problem .",
    "this completes the proof of lemma  [ techlemma ] , thereby establishing theorem  [ newmain ] .",
    "we have shown that , for every group with at least two ends , the rational subset membership problem and the submonoid membership problem are recursively equivalent . moreover , in a previous paper we proved that these two problems are recursively equivalent for graph groups as well  @xcite .",
    "it is easy to see that there exists a group @xmath0 with infinitely many ends for which submonoid membership is undecidable but the generalized word problem ( i.e. , membership in finitely generated subgroups ) is decidable .",
    "take any group @xmath54 for which the generalized word problem is decidable but submonoid membership is decidable ( e.g. , the free metabelian group of rank @xmath20  @xcite or the graph group defined by a path with @xmath425 nodes  @xcite ) .",
    "then the same is true for @xmath426 , which has infinitely many ends .",
    "the obvious remaining open question is whether there exists a ( necessarily one - ended ) finitely generated group for which rational subset membership is undecidable but submonoid membership is decidable .",
    "we conjecture that such a group exists .",
    "we also conjecture that decidability of submonoid membership is _ not _ preserved by free products , because otherwise rational subset membership and submonoid membership would be equivalent for all finitely generated groups .",
    "r.  h. gilman .",
    "formal languages and infinite groups . in _ geometric and computational perspectives on infinite groups ( minneapolis , mn and new brunswick , nj , 1994 ) _ , volume  25 of _ dimacs ser . discrete math .",
    "_ , pages 2751 .",
    "soc . , providence , ri , 1996 .",
    "s.  w. margolis , j.  meakin , and z.  unik .",
    "distortion functions and the membership problem for submonoids of groups and monoids . in _ geometric methods in group theory _ ,",
    "volume 372 of _ contemp .",
    "_ , pages 109129 .",
    "soc . , providence , ri , 2005 .",
    "v.  romankov . on the occurence problem for rational subsets of a group . in v.",
    "romankov , editor , _ international conference on combinatorial and computational methods in mathematics _ , pages 7681 , 1999 ."
  ],
  "abstract_text": [
    "<S> in this paper we show that the membership problems for finitely generated submonoids and for rational subsets are recursively equivalent for groups with two or more ends . </S>"
  ]
}