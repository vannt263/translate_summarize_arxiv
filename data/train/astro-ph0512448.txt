{
  "article_text": [
    "in the standard model of accretion disks , turbulent viscosity plays an important role in bringing material inward and transporting angular momentum outward ( see * ? ? ? * ) . at the same time",
    ", viscous dissipation converts gravitational potential energy to thermal energy and heats up the disk , which then radiates away this energy as thermal emission . in most applications of accretion disks around central objects , as in ,",
    "e.g. , x - ray binaries , the self - gravity of the flow is negligible compared to that of the central object .",
    "however , there are disk - like systems , such as active galactic nuclei as well as protostellar and protoplanetary disks , where the effects of self - gravity change not only the properties of angular momentum transport @xcite , but also the energy balance equation @xcite , which affect the global structure of the disk .    besides the angular momentum transport problem , self - gravitating disks are also very important in studying star and planet formation .",
    "indeed , gravitational instabilities in protoplanetary disks have been proposed as viable planet formation mechanisms . although there has been a large amount of work done on gravitational instabilities in these system ( see , for example , * ? ? ?",
    "* ; * ? ? ?",
    "* and references therein ) , it still remains an open question whether the fragmentation by gravitational instabilities can produce bound planetary objects , or if reservoirs of small solid cores are needed for the accretion mechanism to lead to rapid planet formation .    in the first paper in this series ( chan , psaltis , & zel 2005 ) , we presented a pseudo - spectral method for solving the equations that describe the evolution of two dimensional , viscous hydrodynamic flows .",
    "there , we addressed issues related to the implementation of boundary conditions , spectral filtering , and time - stepping in spectral methods , and verified our algorithm using a suite of hydrodynamic test problems . in this second paper of the series",
    ", we present our implementation of a poisson solver that allows us to take into account the effects of self - gravity of the flow .",
    "spectral methods are particularly suitable for incorporating the effects of self - gravity .",
    "because poisson s equation is linear , we can pre - compute the numerical solution for the gravitational potential for each individual mode of the density , thus reducing substantially the computational cost of the method .",
    "in fact , fourier methods have been used extensively in analytical studies of gravitational potentials in systems with periodic boundary conditions @xcite . on the other hand , in numerical studies of self - gravitating disks ,",
    "the strengths of spectral methods have only been partially incorporated .",
    "hybrid hydrodynamic algorithms with self - gravity have been developed in such a way that modified spectral methods are used only for solving poissson s equation for the gravitational field , whereas the hydrodynamic parts are still treated with finite difference schemes .",
    "for example , @xcite describe a spherical harmonic decomposition method and a second - order scheme in the radial direction to solve poisson s equation , whereas @xcite use a modified fourier method to find the gravitational potential of an isolated distribution of sources .",
    "both algorithms employ explicit second - order finite difference methods to advance the hydrodynamic equations .",
    "@xcite describe an implementation of an algorithm that uses fourier decomposition in the azimuthal direction of cylindrical coordinate to solve poisson s equation together with a von neumann & richtmeyer av scheme for the hydrodynamics .",
    "some other examples can be found in grandclement et al .",
    "( 2001 ) , broderick & rathore ( 2004 ) , and dimmelmeier et al .",
    "the main advantage of using hybrid methods is that one can employ currently available hydrodynamic algorithms based on finite difference schemes .",
    "however , a hybrid method does not exploit the high order of the spectral algorithm , because the hydrodynamic difference schemes typically have a much lower order compared to that of the poisson solver .",
    "contrary to these efforts , our algorithm uses a spectral decomposition method for solving both the hydrodynamic and poisson s equation , providing a consistent treatment of the whole problem . to our knowledge",
    ", this is the first time that spectral methods have been used in studying astrophysical disks with self gravity .    by construction",
    ", there is an ambiguity in the definition of the gravitational field in two - dimensional problems .",
    "we can assume either that the density profile is independent of the third coordinate ( i.e. , an infinite cylinder ) or that it is a delta ( or any other predetermined ) function along the third coordinate ( i.e. , an infinitesimally thin disk ) ; the resulting gravitational field on the two - dimensional domain of solution will be different in the two cases .",
    "for example , the gravitational potential of a `` point source '' on the two - dimensional domain of solution will be proportional to @xmath4 in the first case and to @xmath5 in the second , where @xmath6 is the distance from the source . in order to consider both geometries , here we describe two different approaches to computing the gravitational field of a two - dimensional hydrodynamic flow with pseudo - spectral methods .",
    "when the flow has the geometry of an infinite cylinder , we use a standard two - dimensional pseudo - spectral poisson solver , which has been proven to be numerically stable and accurate . when the flow has the geometry of an infinitesimally thin disk , we perform a direct integration of the green s function for the gravitational potential , following the work of cohl & tohline ( 1999 ) .    in the following section , we present our assumptions and equations . in  [",
    "sec : numerical_methods ] , we discuss the details of our numerical methods , include both the standard poisson solver and the green s function integrator .",
    "next , we present a series of tests in  [ sec : tests ] , to verify our algorithm .",
    "finally , we apply our method to a numerical study of toomre s stability criterion of self - gravitating disks in  5 .",
    "we consider two - dimensional , viscous , compressible flows . in this second paper",
    ", we include self - gravity and continue to neglect the magnetic fields of the flows .",
    "the hydrodynamic equations , therefore , contain the continuity equation @xmath7 the navier - stokes equation @xmath8 and the energy equation @xmath9 we denote by @xmath10 the height - integrated density , by @xmath11 the fluid velocity , and by @xmath12 the thermal energy . in the navier - stokes equation , @xmath13 is the height - integrated pressure , @xmath14 is the viscosity tensor , and @xmath15 is the gravitational acceleration .",
    "we use @xmath16 to denote the viscous dissipation rate , @xmath17 to denote the heat flux vector , and @xmath18 to denote the radiation flux on the @xmath6-@xmath19 plane .",
    "the last term in the heat equation , @xmath20 , takes into account the radiation losses in the vertical direction .",
    "the analytical forms of the various physical quantities in equations  ( [ eq : continuity])([eq : energy ] ) are given in @xcite , except for the gravitational acceleration @xmath15 , for which we need to introduce a new equation .",
    "in newtonian gravity , the gravitational field @xmath21 is conservative , so we can define the gravitational potential @xmath22 by @xmath23 the gravitational potential associated with the ( three - dimensional ) mass density , @xmath24 , is given by the volume integral @xmath25 over all space , where @xmath26 is the gravitational constant . rewriting equation  ( [ eq : integrator_3d_total ] ) in differential form , we obtain poisson s equation @xmath27 with @xmath22 satisfying the boundary condition @xmath28 at all times . when simulating astrophysical flows , the computational domain @xmath29 is usually finite .",
    "based on its linearity , we can decompose the poisson equation into two parts @xmath30 and @xmath31 where @xmath32 denotes the mass density within the computational domain , which in our case is the flow density , and @xmath33 refers to external sources such as a central object and/or a companion star .",
    "the gravitational field is then given by @xmath34    in the astrophysical context of interest here , @xmath35 is usually generated by a set of spherical objects .",
    "hence the external gravitational potential is given by @xmath36 where @xmath37 and @xmath38 are the mass and positions of the corresponding objects .",
    "regarding the self - gravity of the flow , solving equation  ( [ eq : possion_int ] ) within @xmath29 is equivalent to computing the integral @xmath39 once @xmath35 and @xmath40 are obtained , we can then use equation  ( [ eq : total_g ] ) to obtain the total gravitational field and subsequently use it in both the navier - stokes equation and in integrating the trajectories @xmath38 for the external objects .",
    "although for our test problems we assume that the central object does not move and solve the hydrodynamic equations in a fixed reference frame , it is trivial to generalize our algorithm to co - moving coordinates .",
    "there are two different approaches to reducing the above three - dimensional formalism to two dimensions , depending on the physical problem under study .",
    "the first one assumes that the density is independent of the vertical coordinate @xmath41 , i.e. , @xmath42 . in this case , we define @xmath43 and we are left with a two - dimensional problem .",
    "we obtain the gravitational potential by solving the two - dimensional poisson s equation @xmath44 ( this approach is used in zeus-2d , see * ? ? ?",
    "* for details . )",
    "the second approach assumes that the vertical structure of the density is described by some function @xmath45 that is independent of @xmath46 and @xmath19 , i.e. , @xmath47 .",
    "we are interested in the gravitational potential on the @xmath48 plane , so that we solve for @xmath49 .",
    "this is a `` pseudo - two - dimensional '' problem , where the potential is not described by a two - dimensional poisson equation . in order to compute the potential properly , the easiest method , in this case ,",
    "is to integrate directly the equation @xmath50 where @xmath51 denotes the two - dimensional computational domain and @xmath52 is the `` modified green s function '' for our problem .",
    "in this section , we describe the numerical methods we use to solve the two classes of self - gravity problems . as in the first paper @xcite",
    ", we use pseudo - spectral methods , in which we expand all functions in series by choosing the truncated functions to agree with the approximated functions exactly at the grid points .",
    "we use the modified chebyshev collocation method along the radial direction and the fourier collocation method along the azimuthal direction .",
    "let @xmath53 and @xmath54 be the number of collocation points in the radial and azimuthal direction , respectively . for every function @xmath55 , we use the subscript @xmath56 to indicate the fourier coefficients @xmath57 and the subscript @xmath58 to indicate the chebyshev - fourier coefficients @xmath59 where @xmath60 $ ] denotes the standardized coordinate ( see * ? ? ?",
    "* for notation ) .",
    "we implement a standard two - dimensional pseudo - spectral poisson solver , which we describe briefly in  [ sec : poisson_solver ] ( a good introduction is available in * ? ? ?",
    "* ) . for the direct integrator ,",
    "we describe in  [ sec : direct_integrator ] how to generalize the compact cylindrical green s function expansion @xcite with pseudo - spectral methods .",
    "both methods use pre - computed matrices to speed up the algorithms .",
    "the run - time computational cost for both methods are of order @xmath61 .",
    "we describe here a two - dimensional , pseudo - spectral poisson solver .",
    "we use the fact that the basis polynomials in the @xmath19 direction , @xmath62 , are also eigenfunctions of the operator @xmath63 in order to split the poisson s equation to @xmath64 for @xmath65 , where we have set @xmath66 . note that , in discrete fourier transforms , @xmath67 and @xmath68 are real but the other coefficients are complex , so there are , in total , @xmath54 independent equations .",
    "we use @xmath69 to denote the differential operator for each @xmath56 . in the case of the @xmath70direction ,",
    "the chebyshev polynomials are not eigenfunctions of @xmath69 . nevertheless ,",
    "because @xmath69 is time independent and linear , we can write @xmath69 in matrix representation and pre - compute its inverse @xmath71 with an @xmath72 solver for each @xmath56 .",
    "let @xmath73 be the standardized coordinate of chebyshev polynomials and @xmath74 be the mapped ( physical ) coordinate ( see * ? ? ?",
    "* for more details ) .",
    "it is well known that the spectral chebyshev derivative in the standardized coordinate can be written in matrix representation as @xmath75 which is a @xmath76 matrix ( discussion of computing this matrix accurately can be found in * ? ? ? * ) .",
    "the derivative in the mapped coordinate can be obtained by the chain rule @xmath77 so that the derivative matrix in the mapped coordinate is given by the product @xmath78 with this we are able to write @xmath79 the matrix @xmath80 is , of course , singular because a unique solution to @xmath81 does not exist until the boundary conditions are given .",
    "an important case is the vanishing boundary condition @xmath82 .",
    "let @xmath83 be the @xmath84 sub - matrix of @xmath80 generated by removing the first and last rows and columns .",
    "imposing the vanishing boundary condition to @xmath85 is then equivalent to finding the inverse of the @xmath83 and filling back the first and last rows and columns with zeros , i.e. , @xmath86 we can then calculate @xmath87 where the superscript @xmath88 indicates that the solutions satisfy the homogeneous boundary conditions for all @xmath56 . taking the inverse fourier transform along the @xmath19-direction , we then obtain the solution @xmath89 which satisfies the vanishing boundary conditions .    in order to apply more generic boundary conditions , we first look for solutions @xmath90 that satisfy the homogeneous differential equation @xmath91 with the proper boundary conditions .",
    "then it is clear that the sum @xmath92 satisfies @xmath93 with the same boundary conditions .",
    "the solutions to equation  ( [ eq : possion_homogenous ] ) are @xmath94 where @xmath95 and @xmath96 are complex constants , which are fixed by the boundary conditions . in general",
    ", these boundary conditions depend on azimuth , i.e. , @xmath97 we first take the fourier transform of @xmath98 and @xmath99 , we solve for @xmath95 and @xmath96 using @xmath100 we add these terms to @xmath101 , and finally take the inverse fourier transform .",
    "we summarize the two - dimensional pseudo - spectral poisson solver using the following steps :    1 .",
    "we take the fourier transform of each physical quantity @xmath102 along the @xmath19-direction and obtain @xmath103 by a fast fourier transform , which is of order @xmath104 .",
    "we then compute the matrix product  ( [ eq : matrix_product ] ) for each @xmath56 , which is of order @xmath105 .",
    "we compute @xmath106 by a fast fourier transform , which is of order @xmath107 .",
    "we then solve for @xmath95 and @xmath96 using equations  ( [ eq : boundary_in ] ) and ( [ eq : boundary_out ] ) , which is of order @xmath108 .",
    "we impose the boundary conditions using equation  ( [ eq : boundary ] ) , for each @xmath56 , and obtain @xmath109 , which is of order @xmath110 .",
    "finally , we take the inverse transform of @xmath111 to obtain the potential @xmath112 , which is of order @xmath113 .    therefore , the overall computational cost is @xmath61 .      as described in ",
    "[ sec : equations_assumptions ] , we assume in this case that the vertical structure of the density is time - independent and has cylindrical symmetry",
    ". hence we can write @xmath114 where we normalize @xmath45 along the @xmath41 direction to unity , i.e. , @xmath115 so that @xmath10 has the physical meaning of a height - integrated density .",
    "we present here a new numerical method to compute the integral  ( [ eq : integrator_2d ] ) efficiently and accurately .",
    "our method is motivated by @xcite , who showed that the three - dimensional green s function in cylindrical coordinates can be expanded in the compact form @xmath116 where @xmath117/2rr'$ ] and @xmath118 are the half - integer degree legendre functions .",
    "note that the @xmath19 and @xmath119 dependence appears only in the exponential @xmath120 .",
    "this can be done because the green s function itself can be written as a function of @xmath121 so that @xmath122 is simply the fourier transform of @xmath123 with respect to @xmath124 .",
    "this property is still true for the modified green s function because @xmath125 is @xmath19-independent : @xmath126 expanding it in fourier series , i.e. , @xmath127 and substituting it into equation  ( [ eq : integrator_2d ] ) , we obtain @xmath128 note that the integration over @xmath119 , @xmath129 is the fourier transform of @xmath130 in the azimuthal direction .",
    "therefore , we can rewrite equation  ( [ eq : integrator_2d_fourier ] ) as @xmath131 taking the fourier transform of the whole equation again with respect to @xmath19 , we obtain a one - dimensional integral for each value of @xmath56 @xmath132    we now expand @xmath133 in chebyshev polynomials , i.e. , @xmath134 recalling that @xmath135 is the standardized coordinate , we let @xmath136 be some coordinate mapping .",
    "equation  ( [ eq : integrator_fourier_transformed ] ) can then be rewritten as @xmath137 because the orthogonality condition of chebyshev polynomials has a weight function @xmath138 , i.e. , @xmath139 where @xmath140 and @xmath141 for @xmath142 , it is not difficult to see that , by defining @xmath143    \\pi\\sqrt{1-\\bar r'^2}\\;\\frac{dg^2}{d\\bar r'},\\ ] ] we can write @xmath144 where @xmath145 is the @xmath58-th chebyshev coefficient of @xmath146 with respect to @xmath135 .    up to this point , although the function @xmath130 has been written in chebyshev - fourier series , we have assumed that the series is infinite and hence the formalism is exact . in order to perform it numerically , we have to discretize equation  ( [ eq : integrator_exact ] ) .    for the azimuthal direction , which is periodic , we simply replace the continuous fourier transform by a discrete fourier transform and use the proper normalization , which does not change equation  ( [ eq : integrator_exact ] ) but only limits the index @xmath56 to the range @xmath147 to @xmath148 .",
    "for the @xmath6-direction , we truncate the infinite sum at a finite number of terms , @xmath149 . therefore , equation  ( [ eq : integrator_exact ] ) becomes @xmath150 where @xmath151 denotes the collocation points in the @xmath6-direction .",
    "once we obtain @xmath152 for @xmath153 , the calculation of the gravitational potential is trivial .",
    "however , note that @xmath118 is related to the complete elliptic integral , which is singular when @xmath154 . in general , this difficulty arises because of the singularity of @xmath155 . in order to avoid the singularity",
    ", we use the `` chebyshev - roots grid '' : @xmath156,\\ \\ \\ 0 \\le j < n\\ ] ] so that @xmath157 is finite for all @xmath56 and @xmath158 . in figure",
    "[ fig : iknm ] , we plot @xmath146 for the first six values of @xmath56 for @xmath159 , @xmath160 , and @xmath161 , which is the case of a very thin disk .",
    "the chebyshev coefficients @xmath162 are now well defined as @xmath163.\\ ] ] note that @xmath162 can not be computed by a standard discrete cosine transform .",
    "it is related to the discrete fourier transform with different parity properties .",
    "this non - standard cosine transform is known as type - ii discrete cosine transform  ( see , e.g. * ? ? ?",
    "the computational order is still @xmath164 .",
    "the only potential inconsistency about this method is that there are only @xmath149 collocation points , instead of @xmath53 . nevertheless ,",
    "because the chebyshev coefficients converge exponentially for smooth functions , @xmath165 is assumed to be very small .",
    "the artificial vanishing of @xmath166 is , therefore , negligible in the final solution .    in our implementation ,",
    "we pre - compute the operator @xmath167 to speed up the algorithm .",
    "the steps to setup the gravity integrator can then be summarized by the following :    1 .",
    "we first take the discrete fourier transform of @xmath168 along the @xmath19-direction and obtain @xmath169 , which is of order @xmath104 .",
    "we then calculate the matrix product @xmath170 for each @xmath56 , which is of order @xmath105 .",
    "3 .   finally",
    ", we take the inverse fourier transform of @xmath109 and obtain the restricted potential @xmath171 , which is of order @xmath104 .",
    "the overall computational cost is @xmath172 .",
    "we evolve the hydrodynamic equations following @xcite , i.e. , using a low - storage , third - order explicit runge - kutta method .",
    "the only difference is that , at the beginning of every time step , we update the gravitational potential .",
    "in @xcite , we verified the hydrodynamic part of our algorithm . in this second paper",
    ", we will first carry out a few time - independent tests for both the poisson solver and the direct gravity integrator .",
    "we use for each test an analytic density - potential pair and show that the numerical solutions agree with the analytic expressions .",
    "we also perform some time - dependent tests , which demonstrate that the gravity solver couples to the hydrodynamic equation correctly .",
    "the simplest way to test the poisson solver is to compare some numerical potential @xmath173 obtained by the poisson solver to its analytical expression @xmath174 .",
    "the tests in this subsection are done in the computational domain @xmath175\\times[-\\pi,\\pi)$ ] .",
    "we consider a very simple potential @xmath176\\sin\\phi,\\ ] ] where @xmath177 is some arbitrary parameter .",
    "we chose this potential because its laplacian takes the form @xmath178 which is independent of @xmath177 .",
    "hence , the parameter @xmath177 forces our solution to satisfy different boundary conditions .",
    "we choose three different boundary conditions to test the poisson solver .",
    "the first one is @xmath179 which corresponds to @xmath180 . for the second one ,",
    "we choose the vanishing boundary condition @xmath181 which corresponds to @xmath182 .",
    "finally , we also choose @xmath183 which corresponds to @xmath184 .",
    "in figure  [ fig : poisson ] , we show the contour of @xmath185 , @xmath173 , and the difference , @xmath186 , for each choice of @xmath177 .",
    "the contour lines for @xmath173 show clearly how the boundary conditions change the solution .",
    "the numerical results agree very well with the analytical solution and the difference is only of order @xmath187 , which is the machine accuracy .",
    "to test the gravity integrator , we consider an infinitesimally thin disk , with an exponentially decaying surface density , i.e. , @xmath188 the corresponding potential on the @xmath189 plane is given by @xmath190\\ ] ] where @xmath191 @xcite .",
    "the functions @xmath192 and @xmath193 are the modified bessel functions of the first and second kinds , respectively .",
    "the modified green s function for this problem is simply @xmath194    in order to test our gravity integrator for non - axisymmetric problems , we place three disks in the computational domain with each disk centered at some @xmath195 .",
    "let @xmath196 be the distance between @xmath195 and @xmath197 .",
    "normalizing the total mass for each disk to unity , we have @xmath198 the corresponding potential is @xmath199\\;,\\ ] ] where @xmath200 .",
    "because the potential is singular , we put the center of each disk off grid .",
    "specifically , we choose the coordinates @xmath201 , @xmath202 , and @xmath203 .",
    "we also change the total mass of each disk , in order to avoid cancellation of errors by symmetry , by multiplying them by different constants so that @xmath204 we repeated this test for different choices of @xmath177 , namely , @xmath205 , @xmath206 , and @xmath207 . in figure",
    "[ fig : exponential_disks ] , we show the grayscale plots for @xmath208 , @xmath173 , and the fractional error @xmath209 , for each value of @xmath177 .",
    "the contour lines in the error plots show that , at the smooth density region , the error is of order @xmath210 .",
    "the maximum errors appear around the density peak , where the analytic potential is singular .",
    "besides being able to handle a @xmath211-function in the @xmath212direction , our gravity integrator is able to solve problems with other time - independent and @xmath19-independent vertical structures .",
    "for example , we consider the gaussian sphere given by @xmath213\\ ; ,    \\label{eq:3d_gaussian}\\ ] ] which is normalized so that the total mass is @xmath54 . here",
    "@xmath177 is a parameter that controls the spread of the mass in each sphere . as @xmath214 ,",
    "the gaussian sphere approaches a point source .",
    "if we have a collection of such spheres with the same @xmath177 , the vertical structure can be factored out of the equations .",
    "using gauss law , we find that the potential on the @xmath48 plane is given by @xmath215 where @xmath216 is the error function @xmath217 for a collection of gaussian spheres centered on the @xmath189 plane with the same @xmath177 , we can factor out the @xmath41-dependence , i.e. @xmath218 where we have used the same notation as in the previous subsection to indicate that the center of each sphere is located at @xmath195 .",
    "the normalized vertical structure is given by @xmath219 the surface density for each gaussian sphere is , therefore , @xmath220 where @xmath221 is defined in equation  ( [ eq : define_r ] ) .",
    "the modified green s function for our problem is @xmath222 where @xmath223 denotes the modified bessel function of the second kind and we have set @xmath224 for simplicity .",
    "we use the modified green s function described in equation  ( [ eq : green_3d_gaussian ] ) to obtain the corresponding @xmath225 .",
    "then we follow the algorithm described in  [ sec : direct_integrator ] to perform the calculation for the gravitational field for three gaussian spheres located at @xmath226 , @xmath227 , and @xmath228 with a total mass of @xmath229 , @xmath230 , and @xmath231 , respectively , i.e. , @xmath232 in figure  [ fig : gaussian_spheres ] , we show the numerical solutions for @xmath206 , @xmath207 , and @xmath233 . the maximum numerical error is less than @xmath234 .      in order to perform a dynamic test of our spectral self - gravity solver ,",
    "we follow the free - fall of a self - gravitating dust ring",
    ". the initial condition of this problem is the same as in  4.1 of @xcite , i.e. , @xmath235,\\ ] ] and the initial velocity is zero .",
    "the only difference is that , this time , we explicitly calculate the self - gravity of the flow instead of using the gravitational field provided by a central object .",
    "we set the gravitational constant to @xmath224 and let the ring free fall .",
    "we neglect pressure and viscosity and set the resolution to @xmath236 in order to resolve the sharp peak in the density profile that appears at late times .    in order to test our implementation of the spectral method and in the absence of an analytic solution to the problem we wrote a very simple n - body algorithm .",
    "we placed 100,000 particles in the computational domain based on the initial density of the ring .",
    "then we computed the gravitational interactions between each particle pair directly and integrated their trajectories .    in figure",
    "[ fig : free_fall ] , we plot the density profiles of the numerical solution of the free falling dust ring at @xmath237 using the spectral algorithm and the n - body method .",
    "different lines represent the solution from our pseudo - spectral algorithm at different times and the open circles represent the solution from the particle method .",
    "the two solutions agree very well .",
    "we adopt this test from @xcite , who simulated two spheres orbiting around each other with smooth particle hydrodynamics . because our algorithm is two - dimensional , we assume that all variable are independent of @xmath41 and modify the problem to two infinite cylinders orbiting around each other .    because the region outside the cylinders has very low density , small fluctuations of the solution in this low - density region result in a large error in the pressure force . in order to resolve the numerical instability that arises from this effect , we evolve the whole set of hydrodynamic equations including the energy equation and introduce a small background term in both the continuity equation and the energy equation .",
    "this background needs to be small compared to the physical properties of the cylinders so that it does not affect the orbital motion significantly , while at the same time it needs to be large enough so it can screen out the errors at the low density region in our algorithm .",
    "then , a strong spectral filter is applied to the velocity field to reduce numerical instabilities .",
    "the spectral filters for density and energy , on the other hand , are relatively weak in order to conserve mass and total energy .",
    "we consider a gaussian density distribution for each cylinder @xmath238 in order to find the initial condition for the energy equation , we first need to solve for the gravitational potential using the neumann boundary condition @xmath239 at the origin .",
    "the second boundary condition is not important here because it only shifts the potential by a constant , which does not affect the gravitational field . setting the arbitrary constant for the second boundary condition to zero , we obtain @xmath240,\\ ] ] where @xmath241 is the exponential integral function defined by @xmath242 the corresponding gravitational field of this potential is @xmath243",
    "therefore , we require the pressure to be @xmath244\\ ] ] in order to balance self - gravity .",
    "note that we again set the integration constant to zero in the pressure .",
    "the modified green s function for this problem is @xmath245\\;.\\ ] ]    in our simulation we have two gaussian cylinders centered at @xmath195 .",
    "therefore , we set @xmath246 and @xmath247,\\ ] ] where @xmath221 is defined in equation  ( [ eq : define_r ] ) . because the pressure is singular when",
    "@xmath248 , we choose the initial position of the cylinders @xmath195 off grid . in particular , we also choose the background density such that the area between the cylinders contains only @xmath249 of the total mass in the whole system .",
    "because the area of our domain is @xmath250 , we set @xmath251    + \\frac{0.02}{3.2\\pi}\\ ] ] and @xmath252 the initial energy is then chosen using the equation @xmath253 that is based on an ideal gas law .",
    "setting @xmath224 , the angular velocity of the cylinder needed to balance the gravitational force is equal to unity .",
    "hence , we set the initial velocities to @xmath254    we use @xmath207 and evolve the simulation to a dimensionless time @xmath255 , which is equal to about 16 complete orbital rotations . in figure",
    "[ fig : orbiting_cylinders ] , we show the gray - scale plots of the density as well as the velocity field for different times in the simulation . in figure",
    "[ fig : orbiting_separation ] , we plot the angular momentum as a function of time .",
    "our algorithm is able to conserve angular momentum to better than 2% for up to about 16 complete orbiting motion , which corresponds to @xmath256 timesteps .",
    "the 2% dissipation of angular momentum is mostly due to the strong spectral filtering , which is equivalent to artificial viscosity , and the deformation of the two cylinders during the simulation .",
    "pseudo - spectral methods effectively evolve in time the hydrodynamic equations for each mode independently . for this reason ,",
    "they are ideal tools for confirming the results of linear mode analysis and for extending them to the non - linear regime . as a case study",
    ", we address here numerically the stability of self - gravitating infinitesimally - thin disks .",
    "we consider self - gravitating gas disks with a polytropic equation of state @xmath257 where @xmath3 is the polytropic constant and @xmath0 is the polytropic index .",
    "the disks are locally stable to all non - axisymmetric perturbations @xcite . for axisymmetric perturbations , linear - mode analysis of the hydrodynamic equations results in the dispersion relation @xcite @xmath258 where we use @xmath259 to denote the sound speed of the gas , @xmath260 to denote the epicyclic frequency in the disk , and @xmath261 and @xmath262 to denote the mode frequency and wavenumber , respectively .",
    "the disk is locally stable if @xmath263 . the condition for all modes to be stable is given by toomre s stability criterion @xcite , @xmath264 although criterion  ( [ eq : toomre ] ) is only a local condition , it is also sufficient for global stability of axisymmetric modes with @xmath265 . at the critical value @xmath266 , the disk can be globally unstable to non - axisymmetric modes . as @xmath267 increases , the disk becomes globally stable to all non - axisymmetric modes .",
    "however , for very large values of @xmath267 , pressure dominates the self - gravity effects and the disk becomes globally unstable to non - axisymmetric perturbations again .",
    "our goal in this section is to study numerically the stability of self - gravitating disks in situations where the unstable wavelengths are larger than the characteristic length scales in the disks .",
    "we simulate the time evolution of disks that obey plummer s density model  ( see * ? ? ?",
    "* ) @xmath268 where @xmath269 stands for the initial disk mass and @xmath177 is a parameter that controls the central concentration of the disk density . the corresponding gravitational potential ( at the @xmath48 plane )",
    "is given by @xmath270 we set the initial radial velocities to zero , i.e. , @xmath271 , and choose the azimuthal velocities , @xmath272 , so as to balance the pressure and self - gravity of the flow , i.e. , @xmath273 although plummer s model assumes that the density is a @xmath211-function along the @xmath41-direction , its corresponding scale height @xmath274 is given by @xmath275 we choose @xmath276 grid points and perform the simulations in the domain @xmath277\\times[-\\pi,\\pi)$ ] with @xmath182 .",
    "we set the total disk mass to @xmath278 .",
    "figure  [ fig : toomre ] a parameter study of the dependence of the stability of the disk on the polytropic index @xmath0 and the constant @xmath3 .",
    "we plot the minimum value of the toomre parameter @xmath279 anywhere in the disk against @xmath3 .",
    "the three different lines correspond to different values of the polytropic index @xmath0 . according to linear analysis , when",
    "@xmath280 , there is some region in the disk where the disk becomes unstable .",
    "we present the results of our simulation on the same plot , with filled circles denoting the solutions that become unstable and with open circles the solutions that remained stable during the course of the simulations .    for small values of the polytropic index ( @xmath281 ) or for small values of the polytropic constant ( @xmath282 ) ,",
    "our numerical simulations agree with the predictions of the linear mode analysis .",
    "the small disagreements near the @xmath283 separatrix come from two facts : that , ( i ) we have a finite domain of integration on which we have to impose boundary conditions , and ( ii ) we can not calculate the evolution of the instabilities and the perturbations in the gravitational field from matter outside the boundaries . regarding point ( i ) , we have used the absorbing boundary condition discussed in the first paper in the series ( see * ? ? ?",
    "* ) , which reduce the reflection significantly .",
    "however , a very small but finite amount of the energy of the wave is still trapped in the domain , which causes the instability . as a result , when the gravitational potential deviates from plummer s model because of the finite size of the domain , the disk close to the outer boundaries becomes unstable .",
    "a striking difference , however , appears when the polytropic index and the polytropic constant become larger : our numerical solutions are always stable , contrary to the predictions of the linear mode analysis .",
    "the reason for this disagreement between the linear mode analysis and our numerical simulations becomes evident in figure  [ fig : q2_kmax ] , where we plot toomre s parameter @xmath284 as function of radius @xmath6 for different values of the polytropic constant @xmath3 .",
    "when @xmath285 , there is no initial value of the azimuthal velocity @xmath272 that satisfies the steady - state equation for radial force balance ; we shade this region using dark gray . for @xmath286 ,",
    "the disk is unstable according to toomre s criterion ; we shade this region using light gray . finally , when @xmath287 the disk is linearly stable ; we leave this region white .",
    "we also plot in figure  [ fig : q2_kmax ] contours that correspond to the minimum unstable wavelength , in the unstable region , computed by @xmath288    figure  [ fig : q2_kmax ] shows that when @xmath2 and for large values of the polytropic constant @xmath3 , the minimum unstable wavelength is larger than the extent of the region in which the disk is unstable . for example , for @xmath289 and for @xmath290 $ ] , the unstable region only extends to @xmath291 $ ] .",
    "however , in that same region , the minimum unstable wavelength is @xmath292 , in the appropriate units . because the unstable wavelengths are larger than the characteristic length scale in the system ( which can be defined here as the extent of the region in which @xmath293 )",
    ", the approximations involved in the linear mode analysis are not justified .",
    "indeed , the numerical simulations show that the unstable modes can not grow and the disk is stable .",
    "problems that involve self - gravity are usually time - consuming tasks in computational physics . in standard finite difference methods , poisson s equation is solved as the steady state of a diffusion equation ( using relaxation and over - relaxation methods ) and has to be recalculated together with the hydrodynamic equations at every timestep . although hybrid algorithms have been developed which use high - order methods to solve poisson s equation , finite difference schemes are still used for evolving the hydrodynamic equations . the resulting inconsistency in the order of differencing the hydrodynamic equations and poisson s equations either significantly reduces the accuracy of the poisson solver , or requires the extra complication of interpolating the gravitational filed at each grid point .",
    "more importantly , existing two - dimensional hybrid algorithms can only address a limited number of self - gravitating problems because the solutions to the two - dimensional and three - dimensional poisson s equation are fundamentally different ( see  [ sec : introduction ] and  [ sec : equations_assumptions ] ) .    in this paper , we presented two different approaches to using pseudo - spectral methods to solve self - gravity problems .",
    "for the first approach , we described the implementation of a standard pseudo - spectral poisson solver that solves the two - dimensional poisson s equations to machine accuracy . instead of solving a diffusion equation , spectral methods allowed us to invert the poisson operator in spectral space , making the algorithm fast and accurate .",
    "for the second approach , we investigated a fast gravity integrator for disks - like flows with known , time - independent vertical structures .",
    "this algorithm allowed us to study the evolution of flows with finite , but not only infinitesimal , thickness .",
    "this improvement allows two - dimensional algorithms to solve a whole new class of problems .",
    "we demonstrated here the ability of our algorithm to compute properly and efficiently the gravitational potential of flattened flows using different test problems .",
    "even for the high resolution that corresponds to @xmath294 collocation points , our poisson solvers and integrator use less than 10% of the total computational time .",
    "we also explored how to extend toomre s stability criterion to self - gravitating disks for which the characteristic properties of the flows change over a length scale that is shorter than the minimum unstable wavelength . based on our simulations",
    ", we find that for plummer s density model , if the disk is hot and has a polytropic index @xmath2 , all oscillatory modes in the disk are stable , contrary to the predictions of the analytic calculation ."
  ],
  "abstract_text": [
    "<S> spectral methods are well suited for solving hydrodynamic problems in which the self - gravity of the flow needs to be considered . because poisson s equation is linear , the numerical solution for the gravitational potential for each individual mode of the density can be pre - computed , thus reducing substantially the computational cost of the method . in this second paper , we describe two different approaches to computing the gravitational field of a two - dimensional flow with pseudo - spectral methods . for situations in which the density profile is independent of the third coordinate ( i.e. , an infinite cylinder ) , </S>",
    "<S> we use a standard poisson solver in spectral space . on the other hand , for situations in which the density profile is a delta function along the third coordinate ( i.e. , an infinitesimally thin disk ) , or any other function known a priori , we perform a direct integration of poisson s equation using a green s functions approach . we devise a number of test problems to verify the implementations of these two methods . finally , we use our method to study the stability of polytropic , self - gravitating disks . </S>",
    "<S> we find that , when the polytropic index @xmath0 is @xmath1 , toomre s criterion correctly describes the stability of the disk . </S>",
    "<S> however , when @xmath2 and for large values of the polytropic constant @xmath3 , the numerical solutions are always stable , even when the linear criterion predicts the contrary . </S>",
    "<S> we show that , in the latter case , the minimum wavelength of the unstable modes is larger than the extent of the unstable region and hence the local linear analysis is inapplicable . </S>"
  ]
}