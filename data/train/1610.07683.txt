{
  "article_text": [
    "combined hypothesis testing arises naturally in many modern statistical applications .",
    "see chapter 9 of @xcite for further discussions .",
    "the most notable example is the so - called gene set enrichment analysis .",
    "see , e.g. , @xcite , @xcite , @xcite , @xcite , @xcite , @xcite , @xcite , and @xcite among many others .",
    "it is motivated by the observation that many complex diseases are manifested through modest regulation in a set of related genes rather than a strong effect on a single gene .",
    "while statistical testing of the regulatory effect on a particular gene may be inconclusive , the collective effect on a set of genes can oftentimes be clearly identified through combined hypothesis testing .",
    "the results produced by gene set enrichment analysis could therefore be more reliable and biologically meaningful when compared with those based on a single gene .",
    "given its importance in statistical genomics , gene set enrichment analysis has attracted much attention in recent years and numerous approaches have been proposed .",
    "see @xcite and @xcite for a couple of recent surveys on existing techniques .",
    "most statistical methods for gene set enrichment analysis proceed in two steps .",
    "one first computes for each gene a local statistic , i.e. , for testing if a gene is differentially expressed between multiple biological conditions . for concreteness ,",
    "denote by @xmath0 the index set of a particular collection of related genes , and @xmath1 the @xmath2-score associated with the @xmath3th gene so that @xmath4 where @xmath5 . in the second step , we consider testing a combined null hypothesis that there is no effect on the gene set , that is @xmath6 against an overall effect : @xmath7 see , e.g. , @xcite .",
    "a rich source of information often neglected in these analyses is the fact that a gene set is typically taken from a certain biological pathway , be it a metabolic pathway or a signaling pathway , describing a series of biochemical and molecular steps towards a specific biological function .",
    "many of the known pathways are now readily accessible through several well - curated databases such as gene ontology @xcite , kegg @xcite , or pathguide @xcite .",
    "a pathway can be conveniently represented by a graph @xmath8 where each node @xmath9 corresponds to a gene , and an edge @xmath10 between a pair of nodes indicates direct interactions between them .",
    "it is , however , largely unknown to what extent such pathway information could be utilized in gene set enrichment analysis .",
    "the main goal of this article is to address this issue , and develop a principled and effective way to take advantage of such structural information for gene set enrichment analysis in particular and combined hypothesis testing in general .",
    "more specifically , we introduce a hierarchy among all possible effects based on their level of smoothness with respect to the underlying pathway , and argue that the difficulty in testing against a particular effect @xmath11 depends critically on its smoothness in that `` smoother '' effects are `` easier '' to detect .",
    "we note , that unlike functions defined over a continuous domain , smoothness is an innocuous concept here because any @xmath12 can be associated with a finite smoothness index .",
    "this framework allows us to exploit the fact that , in many applications , it is plausible that a putative effect is sufficiently `` smooth '' .",
    "but at the first glance , such an observation may have little practical implication because even if the effect is indeed smooth , one rarely knows how smooth it might be .",
    "we show here that despite the absence of such knowledge regarding @xmath13 s smoothness , it is still possible to develop an agnostic test that automatically _ adapts _ to it .",
    "in particular , we develop an easily implementable adaptive testing procedure whose power increases automatically with the smoothness of the unknown @xmath13 .    to demonstrate the merits of the proposed paradigm and test , we study its asymptotic properties from two different and complementary aspects : an average - case analysis based on erds - rnyi model ; and a general analysis that applies to any specific type of graphs .",
    "the former analysis shows that among all graphs of @xmath14 nodes , with the exception of a vanishing proportion of graphs under erds - rnyi model , the proposed test is minimax optimal for any level of smoothness in that one can not do better over all effects at the same level of smoothness even if we know in advance how smooth they are .",
    "in addition , we derive a generally applicable performance bound for our test and illustrate through several fundamental types of graph its utility and optimality .",
    "although we focus our discussion primarily in the context of gene set enrichment analysis , it is worth noting that the methodology and theory we developed here may also be useful in many other applications .",
    "for example , one may be interested in performing combined hypothesis testing over locations within a particular region of the brain , as a means to identifying areas that can be associated with certain activities .",
    "see , e.g. , @xcite .",
    "in these situations , it is plausible that an overall effect is smooth with respect to the brain surface manifold .",
    "this can be translated into smoothness with respect to nearest neighbor graphs underlying these locations .",
    "the techniques developed here can then be employed in these applications .",
    "the rest of the paper is organized as follows .",
    "we first introduce the general framework of our treatment and the proposed test in section [ sec : meth ] . in section [ sec : ave ] we investigate the properties of the proposed tests under the erds - rnyi model to gain insights into their operating characteristics as well as the effect of smoothness on the detectability of a particular effect .",
    "section [ sec : spe ] provides general performance bounds for our tests , and their applications to several common types of graphs .",
    "numerical experiments are presented in section [ sec : sim ] to further demonstrate the merits of the proposed methodology .",
    "all proofs are relegated to section [ sec : proof ] .",
    "a natural approach to testing @xmath15 against @xmath16 given by equations ( [ eq : null ] ) and ( [ eq : altall ] ) respectively is a @xmath17-test based on the statistic @xmath18 where @xmath19 .",
    "it is clear that under @xmath15 , @xmath20 follows a @xmath21 distribution , so that a @xmath22-level test rejects @xmath15 if and only if @xmath20 exceeds the @xmath23 quantile , denoted by @xmath24 , of @xmath21 distribution . here",
    "@xmath25 denotes the cardinality of a set . on the other hand , under the alternative hypothesis , @xmath26 so that @xmath20 follows a non - central @xmath27 distribution .",
    "denote by @xmath28 the @xmath22-level @xmath17-test .",
    "hereafter , we shall omit the subscript @xmath22 and write @xmath29 for brevity , when no confusion occurs .",
    "it is clear that the type ii error of @xmath29 is given by @xmath30 it is not hard to see that @xmath31 goes to zero as soon as @xmath32 , where @xmath33 means @xmath34 as @xmath35 . in other words",
    ", @xmath29 can consistently detect all effects @xmath13 such that @xmath36 furthermore , it is well known that the @xmath17-test is minimax optimal in testing @xmath15 against @xmath16 in that the detection boundary given by ( [ eq : bdchi2 ] ) can not be improved .",
    "more precisely , there exists a constant @xmath37 such that for any @xmath22-level ( @xmath38 ) test @xmath39 based on @xmath40 , @xmath41 see , e.g. , @xcite for further discussions .    despite the minimax optimality of @xmath17-test ,",
    "there is also ample empirical evidence that other tests , such as @xmath2-test , may work better in some situations .",
    "this is because the optimality of @xmath17-test is in the minimax sense , and therefore based on the worst - case performance .",
    "although the minimax optimality suggests that no test could do better than @xmath29 over all effects @xmath42 , it does not necessarily preclude improvements over subsets of @xmath43 .",
    "for example , if @xmath44 , where @xmath45 is the vector of ones , then @xmath2-test is a more powerful test than @xmath17-test and it can detect any @xmath13 of this form as long as @xmath46 .",
    "in fact , @xmath2-test is the most powerful test in this situation by neyman - pearson lemma .",
    "unfortunately , such an improvement over @xmath17-test comes at a hefty price ",
    "@xmath2-test is powerless in testing against any effect @xmath13 such that @xmath47 in that @xmath48 where @xmath49 denotes the @xmath22-level @xmath2-test .",
    "this naturally brings about the question of whether or not the strengths of @xmath2-test and @xmath17-test could be combined .",
    "we show that this indeed is possible , and develop a test that is just as powerful as the @xmath17-test in the absence of any information regarding a putative effect , but could be as powerful as the @xmath2-test when the effect is indeed a constant .",
    "more generally , the test could be substantially more powerful than the @xmath17-test depending on the smoothness of the unknown effect with respect to the graph @xmath8 .",
    "this is of particular interest here because in many applications of gene set enrichment analysis , it is plausible that the effect @xmath13 is of certain level of smoothness with respect to the graph @xmath50 .",
    "our framework here is largely inspired by the pioneering work of @xcite on nonparametric testing .",
    "see also @xcite .",
    "recall that the laplacian matrix of @xmath50 is given by @xmath51 where @xmath52 and @xmath53 are its degree matrix and adjacency matrix respectively . to fix ideas ,",
    "we shall focus on unweighted and undirected graphs , although our treatment can also be applied to more general , e.g. , weighted or directed , graphs . for an unweighted and undirected graph @xmath50 , the adjacency matrix @xmath53 is a symmetric matrix",
    "whose @xmath54 entry is one if @xmath55 and zero otherwise , and the degree matrix @xmath52 is a diagonal matrix whose @xmath3th diagonal entry is the degree of node @xmath3 .",
    "it is clear that @xmath56 so that it measures the smoothness of @xmath13 with respect to @xmath50 .",
    "the smoothness of @xmath13 with respect to graph @xmath50 allows us to create a hierarchy in @xmath43 .",
    "more specifically , for an arbitrary @xmath57 , denote by @xmath58 the collection of all effects whose smooth index as defined by ( [ eq : smoothind ] ) is at most @xmath59 , that is , @xmath60 for brevity , we shall omit the subscript @xmath50 in what follows when no confusion occurs . obviously , the smaller @xmath59 is , the smaller @xmath61 is , as illustrated in figure [ fig : theta ] .",
    "thus , it is natural to expect it to be easier to detect effects from @xmath61 for smaller @xmath59s .",
    "in particular , since @xmath17-test is optimal for testing against an arbitrary effect @xmath62 , we might expect to be able to improve it over @xmath61 for any finite @xmath59 .",
    "it turns out , however , not to be the case .",
    "( -4.8,-3.6 ) rectangle ( 4.8,3.6 ) ; ( -4.8,-3.6 )  ( -4.8,3.6)(4.8,3.6)(4.8,-3.6)cycle ; ( 0,0 ) ellipse ( 3 and 1.5 ) ; ( 0,0 ) ellipse ( 4 and 2 ) ; ( 4.3,0 ) ellipse ( 0.04 and 0.04 ) ; ( 4.5,0 ) ellipse ( 0.04 and 0.04 ) ; ( 4.7,0 ) ellipse ( 0.04 and 0.04 ) ; ( 2.3,0 ) ellipse ( 0.04 and 0.04 ) ; ( 2.5,0 ) ellipse ( 0.04 and 0.04 ) ; ( 2.7,0 ) ellipse ( 0.04 and 0.04 ) ; ( 0,0 ) ellipse ( 0.05 and 0.05 ) ;    ( -0.7,-0.4)node[right]@xmath63 ; ( 0.3,1.5)node[right]@xmath64 ; ( 2.1,2.1)node[right]@xmath65 ; ( 3,-3)node[right]@xmath66 ; ( -4,3)node[right]@xmath67 ;    [ th : s2optimal ] let @xmath68 where @xmath69 is the laplacian of a graph @xmath8 . then for any @xmath70 there exists a constant @xmath37 such that for any @xmath22-level ( @xmath38 ) test @xmath39 , @xmath71    hereafter , we write @xmath72 if @xmath73 . theorem [ th : s2optimal ] , together with the fact that @xmath17-test is consistent for any @xmath12 such that @xmath32 , suggests that one can not improve over @xmath17-test for sufficiently large , albeit finite , @xmath59s .",
    "however , it indeed is possible to do so for smaller @xmath59s .",
    "the biggest gain , not surprisingly , occurs when @xmath74 .",
    "let @xmath75 be the number of connected components in @xmath50 , and @xmath76 , @xmath77 , the components so that @xmath78 .",
    "in this setting , @xmath69 has exactly @xmath75 zero eigenvalues corresponding to eigenvectors @xmath79 where @xmath80 is the characteristic function that takes value 1 if the the condition holds and zero otherwise .",
    "thus , @xmath81 is a @xmath75 dimensional linear subspace of @xmath43 . to test against the effect @xmath82",
    "then amounts to testing against @xmath83 . by neyman - pearson lemma ,",
    "the likelihood ratio test is the most power for such a purpose .",
    "more specifically , it is not hard to derive the likelihood ratio test statistic @xmath84.\\ ] ] under @xmath15 , it is not hard to see that @xmath85 , so that a @xmath22 level test would reject @xmath15 if and only if @xmath86 . as before , we denote this test by @xmath87 , or @xmath88 for short .",
    "we note that when @xmath50 is connected , that is @xmath89 , @xmath88 is equivalent to the @xmath2-test @xmath49 . on the other hand , under @xmath16 with the overall effect @xmath90 , we get @xmath91 .",
    "thus , @xmath92 is consistent for testing against @xmath90 if @xmath93 .",
    "it turns out this is not only the best we can do for @xmath94 , but also for @xmath61 with a sufficiently small @xmath59 , in general .",
    "[ th : s1s2optimal ] let @xmath8 be the union of @xmath75 connected and non - overlapped subgraphs , and @xmath95 be the smallest nonzero eigenvalue of its laplacian @xmath69 . then",
    ", for any @xmath96 , @xmath88 is consistent for testing against any @xmath97 such that @xmath93 in that @xmath98 .",
    "recall that @xmath99 and there is no consistent test against @xmath90 obeying @xmath100 .",
    "thus theorem [ th : s1s2optimal ] shows the optimality of @xmath88 for testing against @xmath101 . comparing the required strength of @xmath13 characterized by theorems [ th : s2optimal ] and [ th : s1s2optimal ] , we can see the tremendous advantage of knowing that an effect @xmath13 is sufficiently smooth with respect to @xmath50 , e.g. , @xmath102 .",
    "however , it is also clear from the above discussion that different tests may be needed to fully exploit the smoothness of @xmath13 .",
    "although it is plausible that an overall effect is smooth with respect to @xmath50 , such knowledge is rarely known beforehand .",
    "naturally , one may ask if there is an agnostic approach that does not require such knowledge yet can still automatically exploit the potential smoothness of a putative effect , a task akin to adaption in nonparametric testing ( see , e.g. , * ? ? ? * ) . to this end",
    ", we consider a class of test statistics designed to account for different levels of smoothess : @xmath103\\over \\left\\{\\tr[(i+\\lambda l(g))^{-2}]\\right\\}^{1/2}},\\ ] ] where @xmath104 is a regularization parameter .",
    "the test statistic @xmath105 is a normalized version of the quadratic form : @xmath106 which can be viewed as the @xmath17 statistic regularized by the graph laplacian @xmath69 . in particular ,",
    "when @xmath107 , @xmath108 is a normalized version of the @xmath17 statistic and therefore is the most powerful for detecting effects that are not necessarily smooth with respect to @xmath50 . on the other hand ,",
    "when @xmath109 , @xmath110 is a normalized version of the likelihood ratio statistic defined in ( [ eq : s1s2 ] ) which is most powerful for testing against a sufficiently smooth effect @xmath13 . in general , it is expected that different tuning parameters are suitable for testing against effects of different levels of smoothness .",
    "not knowing the exact smoothness of @xmath13 , we seek the maximum over the whole class of test statistics , leading to the following test statistic : @xmath111 in general , the distribution of @xmath112 under @xmath15 may not be computed analytically .",
    "however , it can be readily evaluated by monte carlo simulation , or through permutation test in the context of gene set enrichment analysis .",
    "denote by @xmath113 the @xmath114 quantile of the null distribution of @xmath112 , and we proceed to reject @xmath15 if and only if @xmath115 . as usual , we shall hereafter denote this test by @xmath116 , or @xmath117 for short , when no confusion occurs .",
    "to appreciate the merits and understand the operating characteristics of the proposed test statistic @xmath112 , it is illuminating to begin with the case when @xmath50 is a random graph , more specifically , an erds - rnyi graph . under the erds - rnyi model @xmath118 , first introduced in 1959 @xcite , a random graph of @xmath14 nodes",
    "is constructed by connecting each pair of nodes randomly : each edge is included in the graph with probability @xmath119 independently .",
    "assuming that the underlying graph @xmath50 follows an erds - rnyi model , we can work out an explicit form for the asymptotic distribution of @xmath112 .",
    "denote by @xmath120 the average of the coordinates of @xmath13 , and @xmath121 the centered version of @xmath13 .",
    "[ pr : ernull ] let @xmath122 be a sequence of erds - rnyi graphs with @xmath14 nodes and a fixed probability of edge inclusion @xmath123 , and @xmath112 be defined by ( [ eq : deftlam ] ) and ( [ eq : deftmax ] ) .",
    "assume that @xmath26 such that @xmath124 then @xmath125 where @xmath126 and @xmath127 are two independent normal random variables .",
    "in particular , if @xmath128 , then @xmath129 where @xmath130 and @xmath131 are two independent standard normal random variables .    equation ( [ eq : knh0 ] ) allows us to compute more explicitly the critical value of a test based on @xmath112 at a prescribed significance level , at least in an asymptotic sense .",
    "together with ( [ eq : knha ] ) , this allows us to more precisely characterize the ( asymptotic ) power of @xmath117 .",
    "in particular , the power of the @xmath132-level test , as a function of @xmath133 and @xmath134 , is shown in the rightmost panel of figure [ fig : power - kn ] .",
    "it is also instructive to compare the power of the test with that of the @xmath17-test and @xmath2-test .",
    "as mentioned before , the @xmath17-test is known to be minimax optimal for testing against all possible effect @xmath135 whereas @xmath2-test is the most powerful for testing against a constant effect of the form @xmath136 .",
    "the power of @xmath17 and @xmath2 tests at @xmath132 level , again as functions of @xmath133 and @xmath134 , is also given in figure [ fig : power - kn ] for comparison .",
    "-test , @xmath17-test and @xmath112 based test @xmath137 , as functions of @xmath133 and @xmath134 , for complete graphs.,scaledwidth=110.0% ]    for further comparison , we plot in figure [ fig : power - comp - kn ] the ratio of the power of @xmath117 over that of the @xmath17 and @xmath2 tests , again as functions of @xmath133 and @xmath134 .",
    "the minimum ratios are @xmath138 and @xmath139 respectively indicating that @xmath117 is at least @xmath138 as powerful as the @xmath2-test , and @xmath139 as powerful as the @xmath17-test . on the other hand",
    ", the maximum of both ratios can be arbitrarily large suggesting @xmath117 can be arbitrarily more powerful than both the @xmath17 and @xmath2 tests .",
    "therefore , in absence of further information about the putative effect @xmath13 , @xmath117 could be more preferable to either @xmath17 or @xmath2 test .",
    "0.48   with respect to the @xmath2-test ( left panel ) and @xmath17-test ( right panel ) . in the pink region of each panel , @xmath117 outperforms the alternative test.,title=\"fig : \" ]    0.48   with respect to the @xmath2-test ( left panel ) and @xmath17-test ( right panel ) . in the pink region of each panel , @xmath117 outperforms the alternative test.,title=\"fig : \" ]    in fact , not only superior to @xmath17 and @xmath2 tests , @xmath117 can also be shown , in a certain sense , to be optimal . more specifically ,",
    "[ th : er ] let @xmath122 be a sequence of erds - rnyi graphs with @xmath14 nodes and a fixed probability of edge inclusion @xmath123",
    ". for any @xmath57 , @xmath117 is consistent in testing against @xmath140 such that @xmath141 in that the type ii error @xmath142 . on the other hand",
    ", there exists a constant @xmath37 such that for any @xmath57 , and any @xmath22-level ( @xmath38 ) test @xmath39 based on data @xmath143 , @xmath144    theorem [ th : er ] shows that , if @xmath59 is known in advance , then there is no consistent test for effect @xmath97 such that @xmath145 ; and conversely , if @xmath146 , then @xmath117 is consistent . putting it differently",
    ", the test @xmath117 attains the optimal _ detection boundary _",
    "@xmath147 for any effects for a given level ( @xmath59 ) of smoothness although it does not assume such knowledge .",
    "it is instructive to consider the case when @xmath148 and @xmath149 .",
    "theorem [ th : er ] shows that the boundary for @xmath13 to be consistently testable can be given by the diagram in figure [ fig : er ] .",
    "( -3,-1 ) rectangle ( 10,6 ) ; ( -3,0 )  ( 4,0 )  ( 6,3 )  ( 10,3 )  ( 10,5 )  ( -3,5 ) cycle ; ( -3,0 )  ( 10,0 ) ; ( 0,-1.5 )  ( 0,5.5 ) ;    ( -3,0 )  ( 4,0 ) ; ( 4,0 )  ( 6,3 ) ; ( 6,3 )  ( 10,3 ) ;    ( 6,3 )  ( 6,0 ) ; ( 0,3 ) ",
    "( 6,3 ) ;    ( -0.5,-0.4)node[right]@xmath150 ; ( 3.5,-0.4)node[right]@xmath151 ; ( 5.5,-0.4)node[right]@xmath152 ; ( -1,3)node[right]@xmath153 ;    ( 10.2,0)node[right]@xmath154 ; ( 0,5.7)node[right]@xmath155 ;    ( 2,4)node[right]@xmath117 is consistent ; ( 5.2,1)node[right]no consistent test ;    one can think of erds - rnyi model as a way to assign probability over all graphs with @xmath14 nodes .",
    "theorem [ th : er ] shows that the set of graphs for which the test @xmath117 can achieve the optimal detection boundary @xmath147 has probability tending to one under this measure . in other words , @xmath117 is minimax optimal for almost all graphs .",
    "the detection boundary @xmath147 also characterizes the extent to which @xmath117 indeed can provide improved performance depending the potential smoothness of an effect without assuming such knowledge is available to us .",
    "conceptually , our treatment of erds - rnyi model is akin to an average - case analysis . on the other hand",
    ", it may also be of interest to investigate the performance of @xmath112 for specific graphs , which we shall do in the next section .",
    "to complement our treatment to random graphs , we now investigate the performance of @xmath112 for a specific graph @xmath8 , again with the focus on the case when @xmath156 is large . precise characterization of the operating characteristics of @xmath112 becomes elusive for general graphs because closed form expressions of its asymptotic distributions such as those presented in theorem [ th : er ] are no longer available . nonetheless , we shall derive in this section generally applicable performance bounds for @xmath117 .    more specifically , consider the following equation in variable @xmath157 : @xmath158^{-2}.\\ ] ] it is clear that as @xmath159 increases from zero to infinity , so does the left hand side of ( [ eq : master ] ) ; while the right hand side decreases from @xmath160 to zero , so that the equation has a unique solution between @xmath150 and @xmath161 , hereafter denoted by @xmath162 .",
    "the following theorem shows that @xmath117 is consistent in testing against any @xmath163 such that @xmath164 .",
    "[ th : power ] let @xmath165 be the smallest nonzero eigenvalue of the laplacian matrix @xmath69 of @xmath166 .",
    "assume that @xmath167 .",
    "then @xmath142 for any @xmath12 such that @xmath168\\right\\}^{1/2}}\\gg \\log\\log |v|.\\ ] ] in particular , if @xmath163 , then @xmath142 whenever @xmath169 where @xmath162 is the solution to ( [ eq : master ] ) .",
    "several observations follow immediately from theorem [ th : power ] .",
    "recall that @xmath170 so that @xmath117 is consistent for testing against any @xmath12 such that @xmath171 in the light of ( [ eq : bdgeneral ] ) . on the other hand , by fixing @xmath172 on the right hand side of ( [ eq : altercond ] ) we get @xmath142 for any @xmath173 such that @xmath174 where @xmath75 is the number of non - overlap connected components in @xmath50 .",
    "in fact , using the same argument as that for theorem [ th : s1s2optimal ] , we can show that @xmath117 is also consistent in testing against any @xmath175 such that ( [ eq : bdsmall ] ) holds .",
    "the performance bounds ( [ eq : bdlarge ] ) and ( [ eq : bdsmall ] ) are nearly optimal in that they differ from the optimal bounds given by theorems [ th : s2optimal ] and [ th : s1s2optimal ] only by an iterated logarithmic factor in @xmath156 . such an iterated logarithmic factor also exists for general @xmath59s , as a result of the presence of the @xmath176 term on the right hand side of ( [ eq : master ] ) or ( [ eq : altercond ] ) . in the light of the average - case analysis presented in the previous section ,",
    "we know that such an extra iterated logarithmic factor is unnecessary for almost all graphs under erds - rnyi model .",
    "however , as we shall we see below that for certain type of graphs , this extra factor is indeed necessary , and hence unavoidable here because of the generality of our results .",
    "we now consider several fundamental types of graphs to demonstrate that these general performance bounds are indeed ( nearly ) optimal .",
    "[ [ star - graph . ] ] star graph .",
    "+ + + + + + + + + + +    our first example is the so - called star graph where one node is connected with all the remaining nodes , as show in figure [ fig : star ] .",
    "the laplacian matrix of a star graph with @xmath14 vertices , denoted by @xmath177 , can also be given explicitly .",
    "( -3,-3 ) rectangle ( 3,3 ) ;    ( 1.5*sqrt(3),-1.5 )  ( -1.5*sqrt(3),1.5 ) ;    ( 1.5*sqrt(3),1.5 )  ( -1.5*sqrt(3),-1.5 ) ;    ( 0,-3 )  ( 0,3 ) ;    ( 0,0 ) ellipse ( 0.1 and 0.1 ) ; ( 0,3 ) ellipse ( 0.1 and 0.1 ) ; ( 0,3 ) ellipse ( 0.1 and 0.1 ) ; ( 0,3 ) ellipse ( 0.1 and 0.1 ) ; ( 0,3 ) ellipse ( 0.1 and 0.1 ) ; ( 0,3 ) ellipse ( 0.1 and 0.1 ) ; ( 0,3 ) ellipse ( 0.1 and 0.1 ) ;    ( 0.3,0)node[right]@xmath178 ; ( -0.3,3.5)node[right]@xmath179 ; ( -3.4,1.6)node[right]@xmath180 ; ( -3.4,-1.6)node[right]@xmath181 ; ( -0.3,-3.5)node[right]@xmath182 ; ( 2.75,-1.6)node[right]@xmath183 ; ( 2.75,1.6)node[right]@xmath184 ;    @xmath185.\\ ] ]    it is well known that in this case , the eigenvalues of the laplacian are @xmath186 it is not hard to derive from ( [ eq : altercond ] ) that @xmath117 is consistent for testing against any @xmath187 such that @xmath188 this bound turns out to be optimal up to the iterated logarithmic factor .",
    "[ th : star ] for a star graph @xmath177 , @xmath142 for any @xmath187 such that @xmath189 conversely , there exists a constant @xmath37 such that for any @xmath57 , and any @xmath22-level ( @xmath38 ) test @xmath39 based on data @xmath143 , @xmath190    [ [ cycle - graphs . ] ] cycle graphs .",
    "+ + + + + + + + + + + + +    we now consider another example to show that at least for some types of graphs , the extra iterated logarithmic factor can not be removed . in the so - called cycle graphs ,",
    "the nodes form a ring and each node is connected with its two neighbors , as shown in figure [ fig : cycle ] . a cycle graph with @xmath14 vertices",
    "is commonly denoted by @xmath191 .",
    "its laplacian @xmath192 can be given explicitly .",
    "( -3,-3 ) rectangle ( 3,3 ) ; ( 1.5*sqrt(3),-1.5 )  ( 1.5*sqrt(3),1.5 ) ; ( -1.5*sqrt(3),-1.5 )  ( -1.5*sqrt(3),1.5 ) ; ( 1.5*sqrt(3),-1.5 )  ( 0,-3 ) ; ( -1.5*sqrt(3),-1.5 )  ( 0,-3 ) ; ( -1.5*sqrt(3),1.5 )  ( 0,3 ) ; ( 1.5*sqrt(3),1.5 )  ( 0,3 ) ; ( 0,3 ) ellipse ( 0.1 and 0.1 ) ; ( 0,3 ) ellipse ( 0.1 and 0.1 ) ; ( 0,3 ) ellipse ( 0.1 and 0.1 ) ; ( 0,3 ) ellipse ( 0.1 and 0.1 ) ; ( 0,3 ) ellipse ( 0.1 and 0.1 ) ; ( 0,3 ) ellipse ( 0.1 and 0.1 ) ;    ( -0.3,3.5)node[right]@xmath178 ; ( -3.4,1.6)node[right]@xmath179 ; ( -3.4,-1.6)node[right]@xmath180 ; ( -0.3,-3.5)node[right]@xmath181 ; ( 2.75,-1.6)node[right]@xmath182 ; ( 2.75,1.6)node[right]@xmath183 ;    @xmath193\\ ] ]    it is well known that the eigenvalues of @xmath192 is given by @xmath194 see , e.g , @xcite .",
    "thus , @xmath195=\\sum_{k=1}^{n}\\left[1+{2x\\over \\eta^2}\\sin^2\\left({\\pi k\\over n}\\right)\\right]^{-2}\\asymp \\sum_{k=1}^{n}\\left[1+{x\\over",
    "\\eta^2}\\left({k\\over n}\\right)^2\\right]^{-2}.\\ ] ] hereafter @xmath196 means @xmath197 is bounded away from @xmath150 and @xmath198 .",
    "let @xmath199 .",
    "if @xmath200 , then @xmath201^{-2}\\asymp k_\\ast(x),\\ ] ] which immediately implies that @xmath202 provided that @xmath203 by theorem [ th : power ] , we get    for any @xmath57 and @xmath204 , @xmath117 is consistent in that @xmath142 if @xmath205    it turns out that this performance bound is , in a certain sense , optimal .",
    "[ th : cycle ] there exists a constant @xmath37 such that for any @xmath206 , and any @xmath22-level ( @xmath38 ) test @xmath39 , @xmath207    in other words , even if we know the smoothness index of @xmath13 is between @xmath208 and @xmath209 for some @xmath210 , the best detection boundary can still be characterized by @xmath211 . as before , it is instructive to consider the case when @xmath148 and @xmath212 .",
    "the detection boundary in the @xmath213 plane for this case is shown in figure [ fig : cyclebd ] .",
    "( -3,-1 ) rectangle ( 10,6 ) ; ( -3,0 )  ( -2,0 )  ( 9,3 ) ",
    "( 10,5 )  ( -3,5 ) cycle ; ( -3,0 )  ( 10,0 ) ; ( 6,-1.5 )  ( 6,5.5 ) ;    ( -3,0 )  ( -2,0 ) ; ( -2,0 )  ( 9,3 ) ; ( 9,3 ) ",
    "( 10,3 ) ;    ( 9,3 ) ",
    "( 9,0 ) ; ( 6,3 ) ",
    "( 9,3 ) ;    ( -2.4,-0.4)node[right]@xmath214 ; ( 8.8,-0.4)node[right]@xmath215 ; ( 5,3)node[right]@xmath153 ;    ( 10.2,0)node[right]@xmath154 ; ( 6,5.7)node[right]@xmath155 ;    ( 2,4)node[right]@xmath117 is consistent ; ( 5.2,1)node[right]no consistent test ;    [ [ lattice - graphs . ] ] lattice graphs .",
    "+ + + + + + + + + + + + + + +    our last example is the lattice graph . consider a @xmath216-dimensional square lattice with size @xmath217 where at each lattice point , namely a point with integer coordinates @xmath218 where @xmath219 ( @xmath220 ) , a node is placed .",
    "each node @xmath218 is connected to its immediate neighbors @xmath221 , @xmath222 , @xmath223 if they are on the lattice .    note that the lattice graph , denoted by @xmath224 can be viewed the cartesian product @xmath225 where @xmath226 is a path graph with @xmath227 nodes .",
    "using the general result by @xcite for cartesian product , we can write the eigenvalues of the laplacian @xmath228 as @xmath229 where @xmath230 is the @xmath231th eigenvalue of @xmath232 .",
    "it is well known that @xmath233 see , e.g , @xcite .",
    "therefore , @xmath234 following a similar argument as before , we can derive from theorem [ th : power ] that    [ co : lattice ] for any @xmath57 and @xmath235 , @xmath117 is consistent in that @xmath142 if @xmath236 where @xmath237 .    by the same argument as that for theorem [ th : cycle ] , it can also be shown that the detection rate given by ( [ eq : lattice ] ) is indeed optimal and can not be further improved .",
    "we omit the details here for brevity .",
    "we now present some numerical experiments to illustrate the merits of the proposed methodology and verify the theoretical findings reported earlier . in computing @xmath112 , we optimize over @xmath238 using the function ` nlm ` in ` r ` , which is based on newton method .",
    "we first conduct a set of simulation studies to verify the detection boundaries established by our theoretical analysis . to fix ideas",
    ", we set the the critical value to be the upper 5% quantile of null distribution based on 1000 monte carlo simulations , which ensures that corresponding test is the 5%-level test , up to monte - carlo error .    to demonstrate the adaptivity of the proposed test",
    ", we consider different combinations of values for the strength @xmath239 and smoothness @xmath59 . for a graph @xmath50 , we simulated the effect @xmath13 at a given @xmath240 and @xmath239 as follows .",
    "let @xmath241 be the eigenvector of laplacian matrix @xmath69 corresponding to eigenvalues @xmath242 .",
    "we generated @xmath13 of the following form : @xmath243 where @xmath244s",
    "are rademacher variables , i.e. , @xmath245 , and @xmath246 where @xmath247 and @xmath248 are chosen such that @xmath249 for given values of @xmath155 and @xmath154 .    to assess the power of our method , we first consider erds - rnyi graphs with @xmath250 nodes and probability @xmath251 and @xmath252 .",
    "for each value of @xmath119 , @xmath155 and @xmath154 , we simulated 500 graphs , and for each graph , we simulated @xmath13 such that @xmath148 and @xmath253 as described above .",
    "the observations were then generated and the frequency that the null hypothesis is rejected over these 500 graphs is given in figure [ fig : randomsim ] .",
    "each plot in figure [ fig : randomsim ] was produced by repeating this experiment for combinations of 50 equally - spaced @xmath155 between 0 and 2 , and @xmath154 between -0.2 and 0.8 .",
    "it is clear from figure [ fig : randomsim ] that there is indeed a detection boundary which characterizes when an overall effect can be consistently tested , as predicted by our theoretical analysis .",
    "furthermore , the empirical detection boundary agrees well with our theoretical results .",
    "we also conducted similar experiments for the star graph and cycle graph , each with @xmath254 or @xmath255 nodes .",
    "the result , as shown in figures [ fig : starsim ] and [ fig : cyclesim ] , again agrees well with our theoretical findings .              to further demonstrate the merits of our method",
    ", we now compare the performance of @xmath112 based test with those based on several other commonly used statistics for gene set enrichment analysis : the maxmean statistic proposed by @xcite ; the mean of absolute values ; and the @xmath17 statistic or the mean squares of the scores .",
    "to mimic realistic pathways , we simulated signals on three kegg pathways : ` hsa00051 ` with @xmath256 genes , ` hsa00140 ` with @xmath257 genes , and ` hsa00230 ` with @xmath258 genes .",
    "the three pathways were chosen to better illustrate the potential effect of the number of genes , and therefore compliment our asymptotic results .",
    "in addition , they are also among the pathways of interest in the npc data example we shall present later .",
    "detailed pathway information is accessible at ` http://www.genome.jp ` . for each pathway , as before , we simulated signal @xmath13 such that @xmath148 and @xmath259 where @xmath14 is the number of genes on the pathway and @xmath260 is the corresponding laplacian .",
    "we calibrate the null distribution for each test statistic through 1000 monte carlo simulations . for each combination of @xmath213",
    ", we repeated the experiment in the same fashion for 500 times as before .",
    "the power of the test based on each test statistic is given in figures [ fg : hsa00051 ] , [ fg : hsa00140 ] and [ fg : hsa00230 ] for each of the three pathways respectively .",
    "it is clear from these results that the @xmath112 enjoys superior performance than the alternatives under all three settings .",
    "our final example is taken from a genome - wide expression study of nasopharyngeal carcinoma ( npc ) ( sengupta et al .",
    "the goal of this study is to evaluate the association between host genes in npc and a key gene in the infecting epstein - barr virus ( ebv ) .",
    "the data , available from ` allez ` package in ` r ` , has a total of @xmath261 annotated probe sets . following @xcite and @xcite ,",
    "a log - transformed spearman correlation between viral gene ebna1 and each human gene was used to evaluate the potential relationship between the viral gene and host genes .",
    "six different gene set enrichment analysis methods were applied to this dataset : in addition to the four test statistics we considered before , gene set enrichment analysis ( gsea ) proposed by @xcite was also applied to these scores , as well as the absolute value of these scores .",
    "we extracted pathway information for homo sapiens ( org code : hsa ) in kegg , leading to a collection of 301 pathways .",
    "we ignored genes on a particular pathway if they are not in our annotated probe sets . for each method ,",
    "permutation test was applied to determine the @xmath119-value . to adjust for multiple comparison , we applied benjamini - hochberg procedure to control the false discovery rate at 0.1% .",
    "the pathways that are identified by each method are given in table  [ tb : signf ] .",
    ".pathways identified by each method with false discovery rate controlled at 1% . [ cols=\"^,<\",options=\"header \" , ]",
    "the main idea of the proof is to identify a set of carefully chosen @xmath13s from @xmath58 such that @xmath262 , and show that we can not distinguish them collectively from @xmath263 . to this end , denote by @xmath264 a vector of independent rademacher random variables such that @xmath265 .",
    "it is clear that @xmath266=\\tr(l).\\ ] ] hereafter we write @xmath260 for @xmath69 for short when no confusion occurs . by hanson - wright inequality @xcite ,",
    "there exists a constant @xmath267 such that @xmath268\\right\\}\\le 2\\exp\\left(-c\\min\\left\\{{t^2[\\tr(l)]^2\\over \\|l\\|_{\\rm f}^2 } , { t[\\tr(l)]\\over \\|l\\|}\\right\\}\\right).\\ ] ] in what follows , we shall use @xmath269 to denote a generic positive constant that may take different values at each appearance . note that @xmath260 is a positive semidefinite matrix .",
    "therefore , @xmath270",
    "^ 2,\\qquad { \\rm and}\\qquad \\|l\\|\\le \\tr(l).\\ ] ] for any @xmath271 , we get @xmath272 because scaling does not change the rates of detection , we can assume without loss of generality that @xmath273",
    ". then @xmath274 denote by @xmath275 the collection of all @xmath264 such that @xmath276 then @xmath2772^{|v|}.\\ ] ]    let @xmath278 be the probability measure of @xmath143 such that @xmath279 .",
    "write @xmath280 for some @xmath281 to be specified later",
    ". then for any test @xmath282 , the sum of the probabilities of its two types of errors obeys @xmath283 recall that @xmath284 where @xmath285 and @xmath286 are the density functions corresponding to @xmath287 and @xmath288 respectively .",
    "it is not hard to see that @xmath289^{-2 } \\ee\\exp(\\zeta^2|v|^{-1/2}\\bu_1^\\top\\bu_2),\\end{aligned}\\ ] ] where the expectation is taken over two independent radmacher random vectors @xmath290 and @xmath291 .",
    "note that @xmath292,\\ ] ] where @xmath293 . by central limit theorem , @xmath294\\to \\exp(\\zeta^4/2).\\ ] ] therefore , when @xmath156 is large enough , for any test @xmath282 , @xmath295^{-2}\\sqrt{\\exp(\\zeta^4/2)-1}\\\\ & \\ge&1-{\\zeta^2\\over 2}\\left[1-\\exp(-c\\eta^2/\\eta_{\\max}^2)\\right]^{-2},\\end{aligned}\\ ] ] where in the second inequality we used the fact that @xmath296 for any @xmath297 .",
    "the desired claim then follows from the fact that @xmath298 .",
    "denote by @xmath299 the projection matrix from @xmath43 to the eigenspace of @xmath69 corresponding to eigenvalue zero .",
    "it is not hard to see that , if @xmath300 , then @xmath301 observe that @xmath302 so that @xmath303 therefore , @xmath304 which is of the same order as @xmath239 if @xmath305 .",
    "the proof is then completed .",
    "we first note that an erds - rnyi graph @xmath122 is connected with probability tending to one suggesting that its laplacian @xmath306 has exactly one zero eigenvalue .",
    "recall that @xmath307 where @xmath308 and @xmath309 are @xmath122 s degree and adjacency matrices respectively . applying random matrix theory",
    ", @xcite showed that the eigenvalues of @xmath309 are @xmath310 with the exception of the largest one . on the other hand , by chernoff s bound , @xmath311 .",
    "thus , all nonzero eigenvalues of @xmath306 are @xmath312 . in other words",
    ", we can write @xmath313 where @xmath314 and @xmath315 is a symmetric matrix such that @xmath316 and @xmath317 .",
    "observe that @xmath318^{-1}\\bx\\\\ & = & \\bx^\\top ( i+\\alpha j)^{-1}\\bx \\cdot [ 1+o\\left((np)^{-1}\\|\\delta\\|\\right)].\\end{aligned}\\ ] ] similarly , we can show that @xmath319=\\tr[(i+\\alpha j)^{-1}]\\cdot [ 1+o\\left((np)^{-1}\\|\\delta\\|\\right)],\\ ] ] and @xmath320\\right\\}^{1/2}=\\left\\{\\tr[(i+\\alpha j)^{-2}]\\right\\}^{1/2}\\cdot [ 1+o\\left((np)^{-1}\\|\\delta\\|\\right)].\\ ] ] therefore @xmath321\\over \\left\\{\\tr[(i+\\alpha j)^{-2}]\\right\\}^{1/2}}\\cdot[1+o\\left((np)^{-1}\\|\\delta\\|\\right)],\\ ] ] which implies that @xmath322\\over \\left\\{\\tr[(i+\\alpha j)^{-2}]\\right\\}^{1/2}}\\right\\}\\cdot[1+o_p((np)^{-1/2})].\\ ] ]    on the other hand , @xmath323\\over \\left\\{\\tr[(i+\\alpha j)^{-2}]\\right\\}^{1/2}}\\\\ & = & \\left({n-1\\over ( 1+np\\alpha)^2}+1\\right)^{-1/2}\\left\\{{1\\over 1+np\\alpha}\\cdot \\left[\\|\\bx_c\\|^2-(n-1)\\right]+(n\\bar{x}^2 - 1)\\right\\}.\\end{aligned}\\ ] ] thus , @xmath324\\over \\left\\{\\tr[(i+\\alpha j)^{-2}]\\right\\}^{1/2}}\\right\\}=\\max_{\\theta\\in [ n^{-1/2},1 ] } \\left\\{\\sqrt{1-\\theta^2}\\cdot w_1+\\theta\\cdot w_2\\right\\},\\ ] ] where @xmath325,\\qquad { \\rm and}\\qquad w_2=n\\bar{x}^2 - 1.\\ ] ] write @xmath326 it is clear that @xmath327 by first order condition , we get @xmath328 } h(\\theta)=\\left\\{\\begin{array}{ll}(w_1 ^ 2+w_2 ^ 2)^{1/2 } & { \\rm if\\ } w_1 , w_2>0\\\\\\max\\left\\{w_1,w_2\\right\\ } & { \\rm otherwise}\\end{array}\\right.\\ ] ] it is not hard to see that @xmath329 this , together with ( [ eq : equiv ] ) , implies ( [ eq : knha ] ) .    by theorem [ pr : ernull ] , @xmath137 is consistent for testing against any effect @xmath13 such that @xmath330 in addition , as shown in the proof of theorem [ pr : ernull ] , @xmath331 such that @xmath332 and @xmath317",
    ". thus , @xmath333 which implies that @xmath334 if @xmath335 . together with the fact that @xmath336 this immediately implies that when @xmath335 , @xmath337 if @xmath338 ; and on the other hand , when @xmath339 , @xmath337 if @xmath340 .",
    "this completes the proof of the first statement .",
    "we now show that this indeed is the best one can do .",
    "note that @xmath341 the lower bound for the case when @xmath342 then follows immediately from theorem [ th : s2optimal ] .",
    "similarly , the lower bound for the case when @xmath343 follows from theorem [ th : s1s2optimal ] since the minimum nonzero eigenvalue of @xmath306 is of the form @xmath312 .",
    "it remains to treat the case when @xmath344 .    to this end , let @xmath345 be an ( arbitrary ) orthogonal basis of the linear subspace @xmath346 write @xmath347 . for",
    "any @xmath348 , denote by @xmath349 the probability measure of @xmath19 such that @xmath350 , where @xmath351 for some @xmath352 to be specified later .",
    "it is not hard to see that , with this choice , @xmath353 indicating @xmath140 with probability tending to one .",
    "as before , denote by @xmath275 the collection of @xmath354 such that the corresponding @xmath13 as defined by ( [ eq : defmu ] ) belongs to @xmath355 .",
    "then @xmath356 .",
    "write @xmath357 following the same calculation as before , it suffices to show that @xmath358 can be made arbitrarily close to @xmath151 .",
    "recall that @xmath359,\\ ] ] where the expectation is taken over two independent random vectors @xmath290 and @xmath291 uniformly sampled from @xmath275 . following a similar argument as that of theorem [ th : s2optimal ]",
    ", we can derive that @xmath360\\to \\exp(\\zeta^4/2).\\ ] ] by taking @xmath361 small enough , we can ensure that any test is powerless in testing against @xmath13 of the form ( [ eq : defmu ] ) with @xmath362 . the proof is then completed by noting that @xmath363 for any @xmath364 .    for brevity",
    ", we omit the dependence of the laplacian matrix @xmath260 on @xmath50 and write @xmath365 throughout the proof .",
    "we first prove the first statement . to this end , let @xmath366 where @xmath367 of course , the maximizer may not be unique , in which case , @xmath368 is chosen arbitrarily among the maximizers . by hanson - wright inequality @xcite , @xmath369 this immediately implies that @xmath370 it is therefore clear that @xmath371 with probability tending to one , by assumption ( [ eq : altercond ] ) .",
    "it now suffices to show that under @xmath15 , @xmath372    with slight abuse of notation , let @xmath373 be the distinct eigenvalues of @xmath260 and @xmath374 be the multiplicity of @xmath375 . write @xmath376 where @xmath377 then , under @xmath15 , @xmath112 follows the same distribution as @xmath378 where @xmath379 , @xmath380 , are independent random variables .",
    "note that for any @xmath381 , @xmath382 } \\{\\|\\bw_\\alpha\\|^{-1}\\sum_{k=0}^n w_{\\alpha , k } y_k\\},\\sup_{\\alpha\\in ( \\alpha_{\\min},\\alpha_{\\max } ) } \\{\\|\\bw_\\alpha\\|^{-1}\\sum_{k=0}^n w_{\\alpha , k } y_k\\},\\\\ & & \\hskip 50pt \\sup_{\\alpha>\\alpha_{\\max } } \\{\\|\\bw_\\alpha\\|^{-1}\\sum_{k=0}^n w_{\\alpha , k } y_k\\}\\biggr\\}\\end{aligned}\\ ] ] we now treat the three terms on the righthand side separately with appropriately chosen @xmath383 and @xmath384 .",
    "we first consider the case when @xmath22 is small in that @xmath385^{1/2}\\log ( n+1)}.\\ ] ] observe that , if @xmath386 , then @xmath387 for @xmath388 .",
    "thus , @xmath389 we then get @xmath390}\\left\\{\\|\\bw_\\alpha\\|^{-1}\\sum_{k=0}^n w_{\\alpha , k } y_k\\right\\}&\\le & \\|\\bw_{\\alpha_{\\min}}\\|^{-1}\\left(\\left|\\sum_{k=0}^n \\sqrt{n_k}y_k\\right|+\\sup_{\\alpha\\in [ 0,\\alpha_{\\min}]}\\left|\\sum_{k=0}^n ( w_{\\alpha , k}-\\sqrt{n_k } ) y_k\\right|\\right)\\\\ & \\le & \\left(\\sqrt{4\\over n}\\left|\\sum_{k=0}^n \\sqrt{n_k}y_k\\right|+\\|\\bw_{\\alpha_{\\min}}\\|^{-1}\\sup_{\\alpha\\in [ 0,\\alpha_{\\min}]}\\left|\\sum_{k=0}^n ( w_{\\alpha , k}-\\sqrt{n_k } ) y_k\\right|\\right)\\\\ & \\le & o_p(1)+\\|\\bw_{\\alpha_{\\min}}\\|^{-1}\\sup_{\\alpha\\in [ 0,\\alpha_{\\min}]}\\left|\\sum_{k=0}^n ( w_{\\alpha , k}-\\sqrt{n_k } ) y_k\\right|.\\end{aligned}\\ ] ] where the last inequality follows from markov inequality and the fact that @xmath391    now note that for any @xmath392 $ ] , @xmath387 so that @xmath393 by cauchy - schwartz inequality ,",
    "@xmath394^{1/2}\\max_{1\\le k\\le n}|y_k|.\\ ] ] by the choice of @xmath383 , together with the fact that @xmath395 we get @xmath396}\\left\\{\\|\\bw_\\alpha\\|^{-1}\\sum_{k=0}^n w_{\\alpha , k } y_k\\right\\}=o_p(1).\\ ] ]              note that , for any @xmath410 , @xmath411 which implies that @xmath412 moreover , for any @xmath410 , @xmath413 this suggests that @xmath414 on the other hand , by hanson - wright inequality @xcite , there exists a constant @xmath267 such that for any @xmath415 , @xmath416 we can apply a generic chaining argument to bound the supreme over @xmath417 : @xmath418 for some constant @xmath419 .",
    "see , e.g. , theorem 2.2.23 of @xcite .",
    "now an application of union bounds over @xmath227 yields , @xmath420 where the last equality follows from the assumption on @xmath421 and the fact that @xmath422 .",
    "this then implies the consistency of @xmath117 over all @xmath13 that satisfies ( [ eq : altercond ] ) .",
    "now , to prove ( [ eq : bdgeneral ] ) , it suffices to show that it implies ( [ eq : altercond ] ) .",
    "let @xmath26 for some @xmath13 obeying ( [ eq : bdgeneral ] ) .",
    "note that @xmath423 where @xmath424 .",
    "we can write @xmath425 where @xmath426\\}^{1/2}},\\\\ t_\\alpha^{(2)}&=&{2\\bmu^\\top(i+\\alpha l)^{-1}\\beps\\over \\{\\tr[(i+\\alpha l)^{-2}]\\}^{1/2}},\\\\ t_\\alpha^{(3)}&=&{\\beps^\\top ( i+\\alpha l)^{-1}\\beps-\\tr[(i+\\alpha l)^{-1}]\\over \\{\\tr[(i+\\alpha l)^{-2}]\\}^{1/2}}.\\end{aligned}\\ ] ] observe that @xmath427 therefore , @xmath428\\}^{1/2}}\\ge { \\bmu^\\top\\bmu -\\alpha \\eta^2\\over \\{\\tr[(i+\\alpha l)^{-2}]\\}^{1/2}}.\\ ] ] taking @xmath429 yields @xmath430\\}^{1/2}}.\\ ] ] recall that ( [ eq : bdgeneral ] ) means @xmath431 and ( [ eq : master ] ) implies that @xmath432\\le { \\log\\log n\\over 4}\\tr[(i+\\alpha l)^{-2}].\\ ] ] we have @xmath433 as a result .    on the other hand , @xmath434}\\right).\\ ] ] note that @xmath435}\\le { 4\\bmu^\\top \\bmu\\over \\tr[(i+\\alpha l)^{-2}]}.\\ ] ] therefore , @xmath436\\right\\}^{1/2}}\\right)=o_p\\left(\\sqrt{t_\\alpha^{(1)}}\\right)=o_p(t_\\alpha^{(1)}).\\ ] ] together with the fact that @xmath437 , we get @xmath438 with probability tending to one .",
    "this , together with the fact that @xmath439 under @xmath15 , implies the consistency of @xmath117 .    we now show that @xmath117 is consistent in testing against any @xmath187 such that @xmath440 .",
    "it is clear that the leading eigenvector of @xmath441 is @xmath442 and the eigenvector corresponds to @xmath443 is @xmath444 .",
    "denote by @xmath445 and @xmath446 .",
    "let @xmath447 where @xmath448 is the projection matrix from @xmath43 to the eigenspace corresponding to eigenvalue one , i.e. , the linear subspace of @xmath449 perpendicular to the linear space spanned by @xmath450 and @xmath451 .",
    "it is not hard to see that @xmath452 thus , @xmath453^{1/2}}.\\ ] ] write @xmath454 it is clear that , under @xmath15 , @xmath455 and @xmath456 , so that @xmath457 it now suffices to show that if @xmath26 for any @xmath187 such that @xmath440 , then @xmath458 .          we now show that @xmath471 indeed is the optimal detection boundary .",
    "the optimality when @xmath472 or @xmath473 follows from theorems [ th : s1s2optimal ] and [ th : s2optimal ] respectively . the case when @xmath474 can be treated in an identical fashion as theorem [ th : er ] .",
    "the only exception is now we take @xmath475 to be an orthonormal basis of the eigenspace corresponding to eigenvalue one , and in defining @xmath13 as in equation ( [ eq : defmu ] ) , we sum from @xmath476 .",
    "denote by @xmath477 the eigenvectors corresponding to the eigenvalues @xmath478 of @xmath192 sorted in decreasing order .",
    "write @xmath479 and @xmath480 where @xmath481 for some @xmath482 to be determined later",
    ". denote by @xmath483 where @xmath484 .",
    "recall that @xmath485 it is well known that there exists a constant @xmath37 such that @xmath486 thus , @xmath487 taking @xmath488 ensures that @xmath489 on the other hand , @xmath490    now write @xmath491 where @xmath492 and @xmath493 it is not hard to see that @xmath494 by central limit theorem , @xmath495 thus , @xmath496.\\ ] ] therefore , by taking @xmath361 small enough , we can ensure that any test is powerless in testing @xmath15 against @xmath497 which completes the proof .",
    "m.  ashburner , c.a .",
    "ball , j.a .",
    "blake , d.  botstein , h.  butler , j.m .",
    "cherry , a.p .",
    "davis , k.  dolinski , s.s .",
    "dwight , j.t .",
    "eppig , et  al .",
    "gene ontology : tool for the unification of biology .",
    "_ nature genetics _ , 25:0 2529 , 2000 .",
    "mootha , c.m .",
    "lindgren , k.  eriksson , a.  subramanian , s.  sihag , j.  lehar , p.  puigserver , e.  carlsson , m.  ridderstrle , e.  laurila , et  al .",
    "pgc-1@xmath22-responsive genes involved in oxidative phosphorylation are coordinately downregulated in human diabetes . _",
    "nature genetics _ , 34:0 267273 , 2003 .",
    "newton , f.a .",
    "quintana , j.a .",
    "den  boon , s.  sengupta , and p.  ahlquist .",
    "random - set methods identify distinct aspects of the enrichment signal in gene - set analysis .",
    "_ the annals of applied statistics _ ,",
    "1:0 85106 , 2007 .",
    "a.  subramanian , p.  tamayo , v.k .",
    "mootha , s.  mukherjee , b.l .",
    "ebert , m.a .",
    "gillette , a.  paulovich , s.l .",
    "pomeroy , t.r .",
    "golub , e.s .",
    "lander , et  al .",
    "gene set enrichment analysis : a knowledge - based approach for interpreting genome - wide expression profiles .",
    "_ proceedings of the national academy of sciences usa _ , 102:0 1554515550 , 2005 .",
    "l.  tian , s.a .",
    "greenberg , s.w .",
    "kong , j.  altschuler , i.s .",
    "kohane , and p.j . park .",
    "discovering statistically significant pathways in expression profiling studies . _",
    "proceedings of the national academy of sciences usa _ , 102:0 1354413549 , 2005 ."
  ],
  "abstract_text": [
    "<S> motivated by gene set enrichment analysis , we investigate the problem of combined hypothesis testing on a graph . we introduce a general framework to effectively use the structural information of the underlying graph when testing multivariate means . </S>",
    "<S> a new testing procedure is proposed within this framework . </S>",
    "<S> we show that the test is optimal in that it can consistently detect departure from the collective null at a rate that no other test could improve , for almost all graphs . </S>",
    "<S> we also provide general performance bounds for the proposed test under any specific graph , and illustrate their utility through several common types of graphs . </S>",
    "<S> numerical experiments are presented to further demonstrate the merits of our approach . </S>"
  ]
}