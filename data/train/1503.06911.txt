{
  "article_text": [
    "the aggregation of a large population of responsive loads can provide various ancillary services to the grid , such as power capping , load following , frequency regulation  @xcite .",
    "nondisruptive demand response programs often result in complex and fast aggregated load dynamics , which may lead to sever impact on the distribution and transition systems .",
    "accurate aggregated load modeling is therefore of fundamental importance for systematic analysis and design of various demand response strategies . in this paper",
    "we will develop a control - theoretic framework to model the aggregated dynamics for a large population of responsive electric loads .",
    "the existing literature mostly focuses on developing the aggregated model for a specific type of load .",
    "for example , the authors in  @xcite studied the aggregation of a homogeneous group of thermostatically controlled loads ( tcls ) using a probabilistic approach , where each of the individual tcl was modeled by a simple first order linear stochastic differential equation ( sde ) .",
    "then their aggregated dynamics are characterized by a set of coupled fokker - planck equations which describe the hybrid - state density evolution of the load group .",
    "in particular , a set of boundary conditions were derived .",
    "the author in  @xcite derived an exact stationary solution to the fokker - planck equations , where the coefficients were determined numerically by applying the boundary condition .",
    "this solution was further utilized to perform the set point control of tcls in demand response . following this work",
    ", the authors in @xcite obtained a scalar transport equation for a one dimensional deterministic tcl model , where the partial differential equations ( pdes ) and boundary conditions were obtained based on physical principles .",
    "a markov chain model was proposed in  @xcite to describe the evolution of the probability distribution in the discretized temperature state space , which can be viewed as a discretized pde model .",
    "similar works on deriving the pde models were also reported in  @xcite , and @xcite , where diffusion terms are artificially added to the advection pdes to account for the parameter heterogeneity .",
    "the aforementioned works only consider a one dimensional tcl model , and the continuous dynamics are modeled by simple linear systems .",
    "for many applications , multidimensional models are often needed to accurately capture the load dynamics .",
    "for example , the coupling between mass temperature and the air temperature of tcls was investigated in order to capture the transient response of the aggregated dynamics more accurately  @xcite . for systems driven by multidimensional brownian motions , specifying the boundary conditions of the corresponding pde model",
    "can be very challenging , since the state space may be partitioned by multiple switching surfaces , and the density evolution around these switching boundaries can be rather involved .",
    "actually most of the existing works can not be extended to the multidimensional sde case directly  @xcite .",
    "in addition , the general nonlinear dynamics are needed in capturing more complicated dynamics of the loads , which are barely considered in the existing literature of aggregated modeling .    apart from the complexities in individual dynamics , the population uncertainties of the entire group further complicate the modeling of the aggregated dynamics .",
    "existing aggregated models do not fully consider the heterogeneities appearing in the loads parameters and the control settings .",
    "many methods in the literature directly assume homogeneous loads @xcite .",
    "however , it is well known that the homogeneous aggregated models intrinsically do not have the natural damping effect as shown by the heterogeneous group of loads  @xcite . some works accounted for the damping effect through artificially adding diffusion term to the pde models  @xcite , or simply relied on the diffusing effect caused by discretization errors when solving the pde numerically .",
    "nevertheless , such approximations can not capture the actual aggregated dynamics accurately .    observing that most of the responsive loads can be accurately represented by hybrid dynamical systems , this paper develops a unified stochastic hybrid system ( shs ) model for the loads aggregation with heterogeneous parameters .",
    "the individual load model includes general nonlinear sdes governing the continuous states evolution , and both random and deterministic jumps governing the discrete mode transitions . under the shs modeling framework ,",
    "we systematically derive the aggregated dynamics by exploring the abstract theory of the shs process  @xcite .",
    "specifically , we derive the pde model that captures the time evolution of the hybrid - state density function ( later referred to as the forward equation ) , in a way that is directly based on its dual relationship with the so - called dynkin s formula associated with the extended generator of the corresponding shs process . roughly speaking",
    ", the extended generator of a stochastic process describes the evolution of the expectation of the process , whose domain is obtained under some relaxed conditions . for a special class of shs , called the piecewise - deterministic markov processes ( pdmp )  @xcite , its extended generator can be characterized exactly based on the local martingale representation theorem for the general jump process .",
    "the pdmp is governed by deterministic continuous evolutions between both deterministic and random jumps .",
    "in contrast , the switching diffusion process ( sdp )  @xcite allows stochastic continuous evolutions between only random jumps . a sufficient characterization of its generator was reported in  @xcite and  @xcite .",
    "the general shs ( gshs )  @xcite model can be viewed as a direct generalization of  @xcite to the case of stochastic continuous evolution .",
    "its extended generator was also characterized sufficiently .",
    "more detailed comparison between different shss can be found in  @xcite and  ( * ? ? ?",
    "* chapter 3 ) .    for the loads aggregation application ,",
    "only the discrete mode is reset in the shs model .",
    "thus we can derive the extended generator of the proposed shs model by taking a special deterministic reset map in the gshs model .",
    "this results in a _",
    "local _ boundary condition for the extended generator .",
    "we proceed by determining the set on which the dynkin s formula holds through characterizing the martingales with respect to the filtration induced by the shs process .",
    "we then derive the pde model by computing the adjoint operator from the dynkin s formula , and obtain a local formulation of the boundary conditions for the pde model .",
    "similar works which derived the forward equation for certain types of shs processes also include  @xcite and  @xcite .",
    "the former does not consider the brownian motion and the deterministic jump .",
    "the latter work is focused on a measure - valued formulation of the forward equation based on the levy s identity  @xcite .",
    "the obtained boundary conditions for the forward equation are measure - valued and nonlocal , and therefore less convenient in application . in comparison , our method considers the piecewise continuous functions , and employs the characterization of the martingales with respect to the natural filtration of the shs process .",
    "although this martingale characterization is equivalent to the levy s identity in evaluating the expected increments caused by the jumps , it determines more conditions which specifies the membership of the domain of the extended generator due to its special form of evolution equations .",
    "in particular , the presence of the boundary condition of the extended generator ( later referred to as the adjoint boundary condition ) eliminates the need of proving the existence of the mean jump intensity as required by  @xcite . as a result ,",
    "our method provides a much simpler way of obtaining the boundary conditions for the forward equation .",
    "in fact , the adjoint boundary condition is also necessary for using the method in  @xcite to derive the same results of  @xcite .",
    "this paper contributes to both the development of the shs theory and the generalization of the aggregated load modeling methods . in investigating the shs process",
    ", we make an explicit connection between its extended generator and the pde governing the corresponding aggregated dynamics .",
    "consequently , we develop a new way of deriving the forward equation in a rather general setting , with a special emphasis on establishing the boundary conditions due to the deterministic switchings .",
    "our method leverages the characterization of both the extended generator and the martingales of the shs process , and further exploits its @xmath0 formal adjoint .",
    "to the best of our knowledge , this method has not been fully investigated for the considered shs process . in application to the aggregated modeling , the proposed shs based modeling framework enables dealing with different types of loads and addressing various heterogeneities under a unified framework .",
    "the pde modeling of the aggregated dynamics generalizes many existing works @xcite . for example , the model obtained in  @xcite can be considered as our special case when there is no random jump",
    ". it also greatly simplifies the aggregated modeling process for the responsive loads .",
    "furthermore , it provides the ground - truth model for evaluating and developing simplified models , and can be used to predict the aggregated power response under a variety of demand management strategies .",
    "the rest of the paper is organized as follows .",
    "section  ii motivates this paper through a realistic demand response simulation . a unified hybrid system model for the individual responsive load",
    "is proposed in section  iii , illustrated by three examples .",
    "section  iv investigates the population uncertainties and proposes an shs model for the load population accordingly .",
    "section  v is devoted to the derivation of the pdes for modeling the aggregated load dynamics , and section  vi discuss the applications of the main theorems through several examples .",
    "section  vii concludes the paper .",
    "* notation * : as usual , @xmath1 denotes the underlying probability space of a stochastic process , and @xmath2 represents a sample path .",
    "@xmath3 denotes the expectation operation with respective to an appropriate probability measure . for @xmath4",
    ", @xmath5 is the class of the @xmath6th continuously differentiable functions , and @xmath7 is the class of functions possessing bounded and continuous partial derivatives of order up to @xmath6 . for a matrix @xmath8 , @xmath9 , @xmath10 , and @xmath11 are the trace , the transpose , and the @xmath12th row of @xmath8 respectively . for a set @xmath13 ,",
    "@xmath14 , @xmath15 , and @xmath16 represent the interior , the closure , and the indicator function of @xmath13 respectively .",
    "the @xmath17 and @xmath18 are the gradient and the hessian matrix of @xmath19 , respectively .",
    "the divergence of vector field @xmath20 is denoted by @xmath21 ; similarly , the divergence of a matrix - valued function @xmath8 is denoted by @xmath22 , which is a vector - valued function whose @xmath12th element is @xmath23 .",
    "we use @xmath24 to denote the @xmath6th partial derivative of @xmath25 with respect to the @xmath12th coordinate , while also use @xmath26 to denote @xmath27 sometimes .",
    "the operation of responsive loads typically involves multiple discrete modes . without the interferences of external control actions ,",
    "the transitions among the different modes are governed by simple local control rules . however",
    ", a large number of these loads may exhibit rather complex aggregated dynamics under a variety of demand management strategies .",
    "[ fig : exa ] shows the aggregated response of 2000 hvacs ( heating , ventilation , and air conditioning ) under the so - called thermostat setback program @xcite .",
    "the simulation is performed using gridlab - d , which is a high - performance distribution system simulation and analysis tool developed by doe @xcite . in gridlab - d",
    ", hvac systems are simulated using the two dimensional etp ( equivalent circuit parameter ) model @xcite , which has been validated extensively against realistic residential houses in the united states . for this particular simulation ,",
    "the original temperature setpoints of the hvacs are uniformly distributed in@xmath28 $ ] . during the setback event starting at time @xmath29 hour ,",
    "all the setpoints are instructed to increase by @xmath30 , which reduces the steady state power by about @xmath31 .",
    "however , after the setback control is released at time @xmath32 , a large rebound is observed which may potentially damage the grid .",
    "similar rebound dynamics also occur for other demand response strategies .",
    "in fact , the setpoint change of the setback program can be thought of as being triggered by the real time price change for price following loads , or a sudden frequency drop during contingency for frequency responsive loads .",
    "therefore , a quantitative and systematic understanding of the complex aggregated dynamics is of crucial importance to the analysis and design of most demand response strategies .",
    "gridlab - d simulation of thermostat setback program of 2000 hvacs ]",
    "to develop a unified aggregated load modeling framework , we first need to obtain a general abstraction to capture the dynamic behaviors of individual responsive loads .",
    "responsive loads typically have multiple discrete operation modes .",
    "transitions among these modes are governed by certain switching logic rules that depend on the evolution of the local continuous state variables ( such as temperature or state of charge ( soc ) ) as well as the external control signals .",
    "the switching logic rules are designed to meet energy consumption constraints , such as keeping temperature within a certain range or meeting the charging deadline , and to provide desired response or service to the grid such as spinning reserve or frequency regulation . to capture the interactions between the discrete and the continuous states ,",
    "we propose the following hybrid system as a unified model for both tcls and deferrable loads : @xmath33 where @xmath34 is the continuous state , @xmath35 represents the discrete mode , and @xmath36 is the _ external _ discrete control input to the system which only affects the discrete mode transitions .",
    "we assume that @xmath37 is finite subset of @xmath38 . for each @xmath39",
    ", @xmath40 is a vector field that determines the continuous state evolution in mode @xmath41 .",
    "the output function @xmath42 usually represents the power consumption of the load .",
    "the control parameter @xmath43 directly influences the transitions of the discrete mode , and therefore we distinguish it from the load parameter @xmath44 .",
    "let @xmath45 denote the continuous domain under mode @xmath41 given the current discrete control @xmath46 and the parameter @xmath47 .",
    "we assume that its boundary @xmath48 can be determined by a measurable function parameterized by @xmath46 and @xmath47 , that is , @xmath49",
    ". then the discrete mode transitions are triggered by the continuous state approaching the outflow switching surface @xmath50 from the interior of @xmath51 , @xmath52 , where @xmath50 is defined by @xmath53 and @xmath54 is the outer unit normal vector at @xmath55 . for our purpose , we assume that the continuous state remains the same , while for each mode @xmath41 there are at most one prejump mode , denoted by @xmath56 , and one post jump mode , denoted by @xmath57 . thus we will also call @xmath50 the inflow switching surface to the mode @xmath57 . for clarity ,",
    "we denote by @xmath58 the overall outflow switching surface for the hybrid system , and by @xmath59 the inflow switching surface .",
    "therefore we model the evolution of the discrete mode by a mode transition function @xmath60 , under which @xmath61 when @xmath62 and @xmath63 , otherwise @xmath64 .",
    "most responsive loads can be accurately represented by the above hybrid system model .",
    "we give three examples in the following .",
    "[ ex : shvac]hvacs *    the equivalent thermal parameter ( etp ) model  @xcite for the residential hvacs can be viewed as a special case of ( [ eq : hs_ode ] ) , which is @xmath65 where the continuous state vector @xmath66^{t}$ ] represents the air and mass temperatures , and @xmath67 represents the on / off power state of the system , respectively .",
    "the vector field in each mode @xmath41 depends on the load parameters @xmath13 and @xmath68 .",
    "given a temperature setpoint @xmath69 and a deadband size @xmath70 ( which constitutes the control parameters @xmath47 ) , the continuous domain is determined by @xmath71 and the corresponding switching surfaces are given by @xmath72 for the on mode , and @xmath73 for the off mode ( see fig .  [",
    "fig : hvacss ] ) .",
    "the system will switch between `` on '' and `` off '' upon reaching @xmath74 .",
    "thus the mode transition function can be written as , @xmath75    for the thermostat setback program used in the motivating example , the external input @xmath76 will be the commanded setpoint change .",
    "this control signal changes the positions of the switching surfaces and thus affects the mode transition function @xmath77 .",
    "other tcls under different demand response strategies can also be modeled similarly using the proposed hybrid system framework .    * [ ex : pevs]plug - in electric vehicles ( pev ) charging *    the timing dynamics of deferrable loads can also be accurately represented by the hybrid system model ( [ eq : hs_ode ] ) . for example , the timing dynamics of a pev charging job can be described as a hybrid system with three discrete modes @xmath78 , representing that the load is _ waiting _ to be processed , being actively _ charging _ , and has been _ completed _ , respectively .",
    "the continuous state space is two - dimensional with @xmath79 representing the remaining time to finish the load if it is running , and @xmath80 representing the maximum time the load can be further deferred .",
    "the vector field in each mode is given by @xmath81^{t},$ ] @xmath82^{t}$ ] .",
    "here , we assume that a negative value of @xmath79 indicates that the job has been completed before .",
    "the continuous domains are given by @xmath83 @xmath84 and @xmath85 transition from waiting to charging will be forced to take place when a pev approaches @xmath86 from @xmath87 in order to meet the specified deadline ( see fig .",
    "[ fig : chargingtraj ] ) .",
    "a pev finishes charging when it approaches @xmath88 from @xmath89 .",
    "the external control @xmath76 may directly trigger mode transitions at an earlier stage .",
    "for example , a frequency responsive pev may stop charging if the frequency deviation ( which is the external input ) exceeds certain threshold .",
    "the load parameter @xmath90 for a pev charging load may represent load - specific quantities such as battery size and charging power , while the control parameter @xmath47 may represent plug - in times and desired charging deadlines that are specified by the users and may affect the mode transition rules of a charging load .",
    "other deferrable loads under different local response rules can be modeled similarly .    *",
    "[ ex : priceresponse]price responsive loads *    the proposed hybrid system model can also be used to model price responsive loads . for example , consider the same hvac system where the local control rules are still in the form of ( [ eq : localcontrol ] ) , but the setpoint responds to the external price signal @xmath76 according to the following saturated linear rule , @xmath91 where @xmath92 is the setpoint change with respective to the initial setting , and @xmath93 is the deviation of the real time energy price @xmath94 from the base price @xmath95 .",
    "the control parameter @xmath47 includes the ratio @xmath96 and the linear response region parameter @xmath97 .",
    "[ fig : prcurves ] shows such a typical price response curve for the hvacs . once @xmath76 is revealed to the power market at each period",
    ", individual loads can determine their switching surfaces based on ( [ eq : satlinear ] ) .",
    "the hybrid system model ( [ eq : hs_ode ] ) represents a novel and unified viewpoint of responsive loads .",
    "its significance is mainly two - fold .",
    "firstly , it intrinsically accounts for end - use constraints through state - dependent mode switchings .",
    "this is very important for the analysis and design of nondisruptive demand response strategies .",
    "secondly , it can be used to represent a variety of responsive loads under different demand management strategies in a unified manner .",
    "this can help us identify and address fundamental challenges that are common across different responsive loads and different demand management strategies . as a result",
    ", we can focus on developing aggregated modeling and control for the generic hybrid system model ( [ eq : hs_ode ] ) instead of dealing with specific loads separately .",
    "consider a large number @xmath98 of responsive loads , each of which is modeled as a hybrid system of the form ( [ eq : hs_ode ] ) but may have different parameters @xmath99 and @xmath100 , @xmath101 .",
    "the population dynamics are described by @xmath102 where @xmath103 represents the aggregated power output .",
    "the load group is called homogeneous if all the load and control parameters @xmath104 are the same , otherwise it is called heterogeneous .    due to issues like privacy , limited communication resources , computational complexities , and infrastructure costs , it is often difficult to keep track of the hybrid state trajectory @xmath105 for all the individual loads .",
    "the aggregated modeling problem aims to address this issue by deriving the time - course evolution of the hybrid - state density function @xmath106 , and estimating the aggregated output @xmath103 based on the density function .",
    "it is worth mentioning that each individual load is a deterministic hybrid system , however , it is natural to take a probabilistic ( or distribution ) viewpoint for the overall population because many information regarding individual loads are uncertain to the aggregator . in the rest of this section",
    ", we will first address the modeling of the population uncertainties , and then propose a stochastic hybrid system model for the aggregated load population .",
    "the continuous dynamics of responsive loads may depend on many factors that can not be accurately modeled .",
    "one way to account for these unmodeled dynamics is to add a noise process to the nominal model , by which we will have @xmath107 where @xmath108 is the standard @xmath109 dimensional wiener process .",
    "we define the diffusion matrix @xmath110 that will be used later .",
    "in contrast to a homogeneous load group , a heterogeneous load group with well - diversified load parameters will result in a natural damping and a more stable aggregated response @xcite . from the aggregator s perspective , the real model parameters @xmath100 and @xmath99 in ( [ eq : popdyn ] ) are not known precisely , but their distribution may be acquired or estimated . in this paper , we assume a joint p.d.f . @xmath111 for the model parameters @xmath47 and @xmath90 .      another uncertainty in aggregated modeling is the spontaneous mode changes caused by users interferences .",
    "for example , a user may decide to turn on / off the hvacs anytime without abiding the local control rule . in the pev charging example",
    ", the user may start charging the pevs before the deadline and drive it away without being fully charged .",
    "such uncertainty does not show up in the individual deterministic load model , but can be quite significant when considering a large load population .",
    "it can be characterized by the random jump , which is determined by a transition rate function @xmath112 . in particular , @xmath113 is the probability of a random jump happening in infinitesimal time interval @xmath114 $ ] . without loss of generality ,",
    "we assume that @xmath115 is piecewise continuous in @xmath116 , @xmath52 .      in this subsection",
    ", we develop a general shs model to capture the population dynamics ( [ eq : popdyn ] ) considering the uncertainties described in the last subsection .",
    "let @xmath117 .",
    "we assume in ( [ eq : sde ] ) that all the initial conditions @xmath118 are i.i.d . and @xmath119 are independent wiener processes which are also independent of @xmath120",
    ". then the dynamics of each load are independent stochastic processes .",
    "when @xmath98 is sufficiently large , the population dynamics can be approximated by the following shs process , @xmath121 where @xmath122 , @xmath123 , and without loss of generality we assume that @xmath111 and @xmath124 are independent .",
    "the last equation is evaluated at those modes under which the loads are consuming energy , and @xmath125 represents the joint p.d.f .",
    "of @xmath126 at time @xmath127 .",
    "the transition function @xmath77 is now defined for all @xmath128 due to the consideration of the random jump . the stopping times @xmath129 , @xmath130 are the jump instants of the shs process that will be defined soon in the below .",
    "note that @xmath90 and @xmath47 are treated as augmented continuous states with no dynamics , i.e. @xmath131 and @xmath132 .",
    "thus , the parameter heterogeneity can be addressed equivalently by specifying the initial distribution of the augmented states as @xmath111 .",
    "a sample path of ( [ eq : hs_sde ] ) can be viewed as the trajectory of a randomly selected load in the population .    due to the modeling of population uncertainties using brownian motion and random jumps , the jump instances become random variables denoted by @xmath129 , @xmath130 .",
    "let @xmath133 , @xmath134 , be the continuous domain of the shs under mode @xmath135 .",
    "let @xmath136 be an arbitrary initial point , @xmath137 be a trajectory of the shs process starting from @xmath138 in mode @xmath135 , where @xmath139 is the underlying probability space corresponding to the sde under mode @xmath135 .",
    "denote by @xmath140 the continuous state component in @xmath141 at time @xmath127 , which corresponds to the solution of the @xmath135th sde .",
    "then the stopping time @xmath142 which triggers a deterministic jump in mode @xmath135 can be defined as @xmath143    now consider both deterministic and random jumps .",
    "let @xmath144 be the first time a jump occurs since its entering into mode @xmath135 , i.e. @xmath145 where @xmath146 is the survival function of @xmath144 such that @xmath147 , and @xmath148 is the wiener probability of the process corresponding to the sde in ( [ eq : hs_ode ] ) under mode @xmath135 .",
    "the survival function can be defined by @xmath149 and @xmath150 is the transition rate function , and @xmath151 is a uniformly distributed random variable on @xmath152 $ ] .",
    "thus the mode transition of the shs process occurs at the following stopping times @xmath153 where @xmath154 for @xmath155 , and @xmath156 is the index of the active mode during @xmath157 .",
    "it can be seen that the longer the process has been staying in a mode , the more likely the mode will change .",
    "now the mode transition function @xmath158 can be simply understood as @xmath159 when @xmath160 , and @xmath129 is a function of @xmath161 and @xmath47 .",
    "sample paths of a typical shs process are illustrated in fig .",
    "[ fig : example ] , where the boundary curves of the shaded area represent the outflow switching surfaces , and the dashed curves represent the inflow switching surfaces .",
    "we see that a random jump happens in mode 1 before the load reaches the outflow switching surface , and in the other two modes , the load switches its mode upon reaching the outflow switching surfaces .",
    "sample trajectories of a typical shs process ]",
    "the shs model developed in the previous section can be used to simulate the population dynamic behaviors under different demand response scenarios .",
    "such dynamic behaviors are completely determined by the evolution of the hybrid - state density function of the shs .",
    "this section is dedicated to the pde characterization of the aggregated dynamics .",
    "our method of deriving the ( hybrid - state density evolution ) pde model is based on its dual relationship with the so - called dynkin s formula associated with the extended generator of the shs process .",
    "we will first characterize the extended generator and its domain for the proposed shs process .",
    "the dynkin s formula is then established by characterizing the martingales with respect to the filtrations generated by the shs process .",
    "based on the dynkin s formula , the pde model is obtained by computing the formal adjoint of the extended generator . especially , its boundary conditions are uniquely determined by the boundary condition of the extended generator .    in order to address the parameter heterogeneity more efficiently ,",
    "we propose a weighted pde model based on the results in the following subsection .      as shown in ( [ eq : hs_sde ] ) ,",
    "theoretically there is no difference in dealing with the shs model with or without parameter heterogeneity .",
    "however , the increase in dimensionality will cause major computational issues .",
    "some of the existing methods rely on the noise process to account for the parameter heterogeneity @xcite .",
    "nonetheless , in general this is not an accurate characterization , since the randomly distributed load parameters @xmath90 may not generate a normally distributed state velocity ( i.e. the vector field @xmath25 ) . from the microscopic point of view",
    ", the time - varyingly perturbed velocity by the diffusion approximation can not generate the same load trajectories as that by the heterogeneous group with fixed load parameters",
    ". therefore their collective behaviors can be quite different .    instead of adding diffusion to the pde model , we approximate the parameter heterogeneity using several homogeneous groups whose",
    "parameters are obtained from clustering over the samples drawn from the distribution @xmath111 .",
    "denote @xmath106 the p.d.f .",
    "of the heterogeneous population dynamics  ( [ eq : hs_sde ] ) .",
    "then the conditional p.d.f .",
    "@xmath162 represents the p.d.f . of the homogeneous group with parameters @xmath163 , that is , the shs model  ( [ eq : hs_sde ] ) with fixed load parameter @xmath47 and @xmath90 , both of which under the same intial p.d.f .",
    "@xmath164 . intuitively , the hybrid - state p.d.f . of the heterogeneous group can be estimated by sufficiently many homogeneous groups .",
    "formally , we have    [ prop : cluster]let @xmath163 , @xmath165 be the samples drawn from the distribution @xmath166 , and assume that the set @xmath167 and @xmath168 are compact . if @xmath169 is continuously dependent on @xmath170 , then @xmath171 and @xmath172 , @xmath173    since @xmath124 and @xmath111 are independent , and the initial p.d.f .",
    "@xmath124 are taken as the same for both the heterogeneous and the homogeneous groups , we have @xmath171 and @xmath172 , @xmath174    let @xmath175 be the joint cumulative distribution function of @xmath47 and @xmath90 , and thus @xmath176 .",
    "let @xmath177 be the corresponding empirical distribution function with independent and identically distributed @xmath178 , @xmath179 . then by the glivenko - cantelli theorem , as @xmath180 , @xmath181 almost surely ( a.s . ) .",
    "since @xmath169 is continuously dependent on @xmath170 , it is bounded on the compact sets @xmath182 .",
    "then it follows by the dominated convergence theorem that , as @xmath180 , @xmath183 a.s . which is exactly ( [ eq : sampling ] ) .",
    "the continuous dependence of the p.d.f . on the initial data may be most appropriately investigated from the corresponding pde derived later .",
    "however , it is out of the scope of this paper to go into that direction to determine the specific conditions posed on the coefficients of the pde to guarantee its well - posedness  @xcite . instead , for the practical problem considered in this paper , we shall assume this property carried over from the shs modeling , and focus ourselves on the derivation of the pde and its boundary conditions .",
    "later on , we will demonstrate the effectiveness of our method through simulation on the realistic example .",
    "we can approximate the empirical distribution function @xmath184 by @xmath185 with fewer samples @xmath186 @xmath187 , @xmath188 and @xmath189 , such that fixing @xmath190 , the samples @xmath191 and the index sets @xmath192 minimize the the sum of the within - cluster distances @xmath193 , where @xmath194 are the original samples .",
    "hence , @xmath192 contains the indices of @xmath195 which are closest to @xmath191 , and @xmath196 @xmath197 is the weight of the @xmath6th cluster . in this paper",
    ", we adopt the @xmath198means clustering algorithm which efficiently calculates a suboptimal solution to the minimization of @xmath199 .",
    "furthermore , by assuming the continuous dependence on the parameters , the approximation error can be bounded by @xmath200 where @xmath201 is a constant depending on the sets @xmath167 and @xmath168 , and the specific sde .    in view of the above discussion , the results in the sequel will be derived for each cluster . for clarity",
    ", we will drop the dependence on the load parameters , and thus focus on the following form of shs , @xmath202 where @xmath129 are the jump instances related to the transition rate function @xmath115 and the outflow switching surface @xmath74 and we assume that the entire load group share the same external control signal @xmath76 .",
    "our results are obtained in a very general setting assumed in the following subsection .",
    "the following regularity conditions are needed for the later discussions .    for a function @xmath203 defined on the hybrid state space @xmath204",
    ", we will denote @xmath205 the restriction of @xmath206 to @xmath51 in the sequel .",
    "[ ass : regularity ]    for the sde in ( [ eq : sde3 ] ) , we assume that @xmath52 , @xmath207 , @xmath208 .",
    "in addition , the initial state @xmath209 satisfies @xmath210 and is independent of the brownian motion .",
    "[ rem : remark1]assumption [ ass : regularity ] implies that @xmath52 , the initial value problem of ( [ eq : sde3 ] ) has a unique continuous solution ( i.e. ito diffusion ) , and the solution satisfies @xmath211 , @xmath212 ( * ? ? ?",
    "* theorem 5.2.1 ) .",
    "the smoothness assumption on @xmath25 and @xmath213 is for the later derivation of the pde model .",
    "[ ass : nozeno ]    there is no zeno executions for the corresponding hybrid system of ( [ eq : sde3 ] ) .",
    "[ rem : nt]let @xmath214 be the number of jumps happened until time @xmath127 .",
    "then the assumption [ ass : nozeno ] implies @xmath215 , @xmath216 .",
    "we assume that the shs process is defined on the hybrid state space @xmath217 , where @xmath45 , @xmath52 .",
    "denote by @xmath48 the boundary of the continuous domain @xmath51 , and then the boundary of @xmath204 is defined as @xmath218 .",
    "we will use @xmath219 , and @xmath220 to denote the closures of @xmath51 and @xmath204 , respectively .",
    "regarding the structure of @xmath204 , we assume ,    [ ass : mbd ]    @xmath52 , @xmath221 is a connected and oriented @xmath222 manifold with corners .",
    "the outflow switching surface for the shs process is defined by @xmath223 , @xmath52 , and thus @xmath224 .",
    "it is also possible that the outflow switching surface @xmath50 may not contain all of @xmath48 , i.e. not the entire boundary can be reached from some interior point of @xmath51 .",
    "for example , in the deterministic case where @xmath225 , @xmath50 is the forward reachable boundary  ( [ eq : gq ] ) .",
    "therefore we assume that ,    [ ass : inside ]    the outflow switching surface @xmath50 is an open subset of @xmath48 .",
    "assumption [ ass : mbd ] and [ ass : inside ] imply that @xmath50 is also oriented .",
    "since the shs process is defined on @xmath204 , we assume that the post jump position @xmath226 , @xmath227 . recall that @xmath228 is the outflow switching surface , and therefore ,",
    "in particular , @xmath229 .",
    "define @xmath230 .",
    "clearly , the inflow switching surface @xmath231 is an open subset of @xmath232 .",
    "we assume that @xmath232 form a partition of @xmath233 , that is , @xmath234 such that the components @xmath235 satisfy @xmath236 , @xmath52 , @xmath237 , and @xmath238 is the index set of the components of @xmath51 .",
    "note @xmath233 can be endowed with the borel @xmath239algebra @xmath240 generated by its metric topology .",
    "for example , the distance between the hybrid states can be defined by @xmath241 if @xmath242 and @xmath243 if @xmath244 , where @xmath245 , @xmath246 .",
    "then we can have @xmath247 , where @xmath248 is the @xmath239algebra on @xmath221 .",
    "the need for extended generator stems from the difficulty in obtaining a sufficient set of the domain of the strong generator .",
    "let @xmath249 , @xmath250 be a markov process defined on @xmath204 .",
    "the strong generator is defined as follows .",
    "( strong generator ) let @xmath251 denote the set of bounded borel measurable functions @xmath252@xmath253 with the property that @xmath254 the limit @xmath255 exists in the supremum norm @xmath256@xmath257 , where @xmath258 is the expectation of @xmath259 with respective to the wiener probability measure @xmath260 .",
    "then we call @xmath261 the strong generator of the process @xmath249 .    from the abstract theory of the markov process  @xcite , we know    [ lem : stronggen]each @xmath262",
    "is associated with a martingale defined as , @xmath263 and further it satisfies the dynkin s formula , @xmath264.\\label{eq : dynkin}\\ ] ]    the strong generator @xmath261 completely determines the probability measure of the process .",
    "the dynkin s formula  ( [ eq : dynkin ] ) will play a major role in deriving the pde satisfied by the hybrid state p.d.f .",
    "@xmath265 , @xmath266 , @xmath250 , where note the relation that @xmath267 , @xmath268 is the initial distribution of @xmath269 with @xmath270 , and similarly @xmath271 .",
    "specifically , the dynkin s formula defines the time evolution of the expectation of the test function @xmath203 . by computing the adjoint operator of @xmath261 from the inner product between @xmath272 and @xmath273 on the right hand side of  ( [ eq : dynkin ] )",
    ", the evolution of the density may be obtained .",
    "it is worth emphasizing that a precise characterization of @xmath251 is critical in evaluating the adjoint operator . especially in our case",
    ", the boundary condition of @xmath203 on @xmath274 directly determines the boundary conditions of the pde .",
    "however , rather than pursuing @xmath251 , it is often easier to determine precisely the set of functions for which  ( [ eq : dynkin ] ) holds . to this end , we need the notion of extended generator ( c.f .",
    "* definition 14.15 ) ) .",
    "[ def : exgen](extended generator ) let @xmath275 denote the set of borel measurable functions @xmath276 with the following property : there exists a measurable function @xmath277 , such that the function @xmath278 is integrable @xmath260 a.s . for each @xmath279 and the process @xmath280 is a local martingale .",
    "then we write @xmath281 and call @xmath282 the extended generator of the process @xmath249 .    since a martingale is also a local martingale",
    ", we see that @xmath283 , and @xmath284 for @xmath262 .",
    "now we will find the conditions under which the dynkin s formula holds for the proposed shs process .",
    "this can be done through the characterization of its extended generator . for a fixed discrete input @xmath46 ,",
    "the proposed shs model in  ( [ eq : sde3 ] ) constitutes one special class of the gshs processes with deterministic reset map .    before proceeding ,",
    "we define the following notations following  @xcite . for a measurable function @xmath285",
    ", we say @xmath286 if @xmath287 , where @xmath288 is a stochastic process that can be identified by a random measure and thus forms a stieljes integral in the expression .",
    "typically , we will denote @xmath288 as the counting process defined by @xmath289 which counts the number of jumps of the gshs process @xmath249 .",
    "then we say @xmath290 if there is a sequence of stopping times @xmath291 with @xmath292 a.s .",
    "such that @xmath293 for @xmath294 for @xmath276 , let @xmath295 be defined as @xmath296    we notice that in definition [ def : exgen ] the extended generator is defined for functions on @xmath204 .",
    "therefore slightly relaxed from  ( * ? ? ?",
    "* theorem 4.11 ) where the functions are defined on @xmath233 , we define the following set to regulate the behavior of the test functions near the boundary .",
    "let @xmath297 be the set of measurable real - valued functions on @xmath204 .",
    "then for a gshs process",
    "@xmath249 , we define @xmath298 which requires that the limit of the test function along the trajectory of the gshs process when approaching the outflow switching boundary exists almost surely . for a function",
    "originally defined only on @xmath204 , its value at some point belongs to @xmath74 will be understood in the same way as the above for the rest of this paper .",
    "we use this set to characterize the domain of the extended generator of the gshs processes in the following lemma .",
    "[ lem : bm](gshs extended generator  ( * ? ? ?",
    "* theorem 4.11 ) ) the extended generator @xmath282 of a gshs process @xmath249 satisfies @xmath299    @xmath300    with @xmath275 including at least those measurable functions @xmath301 such that :    \\1 .",
    "@xmath302 is @xmath303-measurable and @xmath304 .",
    "( boundary condition ) @xmath305 .",
    "\\3 . @xmath306 .    where @xmath307 $ ] is a transition measure on the post jump positions given the prejump position .",
    "an exact characterization of the extended generator has been proved for the pdmp  ( * ? ? ?",
    "* theorem ( 26.14 ) ) .",
    "it hinges on the local martingale representation theorem for the general jump process .",
    "however , since such a theorem is unavailable for the gshs process , only the sufficiency of these conditions can be claimed .",
    "next , we characterize a subset of @xmath275 on which @xmath308 is actually a true martingale with respect to the natural filtration @xmath309 generated by the gshs process .",
    "[ lem : l1mart]let @xmath282 be the extended generator of a gshs process @xmath249 and @xmath310 . if @xmath52 , @xmath311 and is bounded , then @xmath308 is an @xmath309-martingale .",
    "following the same steps in ( * ? ? ?",
    "* proof of theorem 2 ) , we can represent @xmath308 as @xmath312\\times x}b\\psi dq,\\label{eq : ctfmar}\\ ] ] where @xmath313 , @xmath314 is the stochastic process defined in ( * ? ? ?",
    "* proposition 26.7 ) . we will show that both terms on the right hand side of ( [ eq : ctfmar ] ) are martingales with respect to the natural filtration @xmath309 generated by the gshs process @xmath249 .    since @xmath52 , @xmath311 and by assumption",
    "[ ass : nozeno ] @xmath315 , we have @xmath316 is bounded , and @xmath317 for some constant @xmath201 .",
    "note that in the following positive constants will all be denoted by @xmath318 .",
    "then it follows that @xmath319 , @xmath320 & \\leq ce\\left[\\int_{0}^{t}(1+\\left\\vert x\\right\\vert ) ^{2}dt\\right]<\\infty,\\label{eq : wmartingale}\\end{aligned}\\ ] ] where the last inequality is by remark  [ rem : remark1 ] .",
    "clearly , @xmath321 is @xmath309-adapted .",
    "together with the fact that @xmath249 is cdlg  @xcite , it can be concluded that @xmath322 as a function of @xmath323 is @xmath324 measurable  ( * ? ? ?",
    "* proposition 1.1.13 ) , where @xmath303 is the borel @xmath239algebra on @xmath325 . combining the above results , it can be concluded that @xmath326 is an @xmath309-martingale by the standard results of stochastic integration , see for example  ( * ? ? ?",
    "* corollary 3.2.6 ) .    for the second term ,",
    "the proof is similar to  ( * ? ? ?",
    "* theorem ( a4.4 ) ) and  ( * ? ? ?",
    "* lemma 3.1 ) for the general jump process case .",
    "however , since the natural filtration of the gshs is more complicated than that of the general jump process due to the ito diffusion between jumps , it is necessary to verify the result carefully . to this end",
    ", we express the wiener probability of the gshs explicitly as follows @xmath327 where @xmath328 is the concatenation of the trajectories of the ito diffusions @xmath329 killed at time @xmath330 with @xmath331 , @xmath332 .",
    "the measure @xmath333 is the wiener probability corresponding to the @xmath6th ito diffusion starting at @xmath334 .",
    "the measure of the post jump position and the jump time of the @xmath6th jump conditioned on the previous ito diffusion @xmath335 is defined by @xmath314 , @xmath336 in addition , we denote @xmath337 , @xmath338 , where @xmath339 is the underlying probability space of the @xmath6th ito diffusion , while @xmath340 contains the trajectories of the initial ito diffusion starting from @xmath209 .",
    "following  ( * ? ? ?",
    "* lemma 3.1 ) , we can decompose @xmath313 into the sum of single jump processes conditioned on their immediate precedent ito diffusions , that is , @xmath341 . then by direct calculation using ( [ eq : gshsprob ] ) in a similar way to  ( * ? ? ? * theorem ( a4.4 ) ) , it can be shown that each @xmath342 is an @xmath309-martingales .",
    "since @xmath343 is bounded , it can be proved similarly that @xmath344\\times x}b\\psi dq^{k-1}$ ] is also an @xmath309-martingales .",
    "it follows that @xmath345 is a uniformly integrable @xmath309-martingale for each @xmath4 , and so is @xmath346\\times x}b\\psi dq$ ] .",
    "now the result in  ( * ? ? ?",
    "* proposition 1.7 ) implies that in order to show @xmath344\\times x}b\\psi dq$ ] is a @xmath309-martingale , it suffices to prove that @xmath347 for all @xmath250 . through a similar calculation to  (",
    "* theorem ( a4.5 ) ) , this condition can be shown to be equivalent to @xmath348 for all @xmath250 , where @xmath288 is a counting process defined earlier in ( [ eq : countingp ] ) .",
    "the latter condition can be further evaluated as @xmath319 , @xmath349 which is finite since @xmath203 is bounded and @xmath215 by remark [ rem : nt ] .",
    "thus it completes the proof .    based on lemmas  [ lem : bm ] and  [ lem : l1mart ] , we are now in the position to establish the dynkin s formula for the proposed shs process in  ( [ eq : sde3 ] ) .",
    "note that the post jump position of the proposed shs process is specified by the mode transition function @xmath77 deterministically , that is , there is a one - to - one correspondence between the prejump position and post jump position .",
    "this will give us a local boundary condition for the extended generator .",
    "[ prop : lf]under the assumptions  [ ass : regularity ] and [ ass : nozeno ] , the extended generator @xmath282 of the shs process defined in  ( [ eq : sde3 ] ) satisfies @xmath350 , @xmath351 with @xmath275 including at least those bounded measurable functions @xmath203 such that @xmath352 @xmath353 , and @xmath203 satisfies the boundary condition @xmath354 .",
    "if @xmath355 then @xmath308 is a martingale and the dynkin s formula ( [ eq : dynkin ] ) holds .",
    "the formula in ( [ eq : generator ] ) is obtained by taking the transition measure @xmath356 in lemma [ lem : bm ] as a dirac measure ( unit mass ) , @xmath357 , @xmath358    similar , the nonlocal boundary condition in lemma [ lem : bm ] reduces to @xmath359 @xmath360 by using ( [ eq : transition ] ) .",
    "a sufficient subset of the domain @xmath361 is specified by combining all the conditions in both lemmas  [ lem : bm ] and  [ lem : l1mart ] .",
    "first , note that if @xmath203 is bounded measurable , then clearly @xmath301 .",
    "the boundedness of @xmath203 also guarantees that @xmath362 as can be seen from the proof of lemma  [ lem : l1mart ] . by further requiring @xmath352 @xmath353 ,",
    "all the conditions for @xmath203 in lemma  [ lem : bm ] are satisfied , and it follows from lemma  [ lem : l1mart ] that @xmath308 is a martingale . the dynkin s formula is obtained by taking the expectation of @xmath308 in ( [ eq : martingale ] ) and notice that it is zero .",
    "the following divergence theorem simplifies our main proofs of obtaining the forward equation .",
    "it does not require that the vector field @xmath363 is compactly supported on @xmath8 .",
    "although the original theorem given in  @xcite is stated for the manifold with boundary , the same result holds for manifold with corners and can be proved in a similar way .",
    "[ lem : divergence](divergence theorem ) let @xmath364 be an oriented @xmath222 manifold with corners and @xmath8 is closed , and @xmath365 be the unit outward pointing normal to @xmath8 . if @xmath366 is continuous on @xmath8 and @xmath367 in @xmath368 , and @xmath369 then @xmath370 where @xmath371 is the surface measure on @xmath372 and @xmath373 is the volume measure .    in view of lemma [ lem :",
    "divergence ] and the partition of the state space @xmath204 , we assume that the p.d.f .",
    "@xmath106 of the shs process is piecewise continuous on @xmath51 and piecewise @xmath222 in the interior of @xmath51 , @xmath52 .",
    "denote @xmath374 in @xmath235 , @xmath52 , @xmath375 .",
    "then it satisfies a pde given in the following theorem .",
    "[ thm : mainpde]consider the shs process represented by ( [ eq : sde3 ] ) , which models the aggregated dynamics of the responsive loads with heterogeneous parameters . under the assumptions  [ ass : regularity]-[ass : inside ] , the hybrid state probability density @xmath106 satisfies the following partial differential equations in @xmath235 , @xmath52 , @xmath375 , @xmath376=0,\\label{eq : fkpde}\\ ] ] where @xmath377= & \\frac{\\partial p(q , x , t)}{\\partial t}+\\mbox{\\emph{\\ensuremath{\\nabla}}}\\cdot\\gamma(q , x , t)\\\\   & + \\lambda(q , x)p(q , x , t)-\\lambda(q^{-},x)p(q^{-},x , t),\\end{aligned}\\ ] ] and @xmath378 is known as the probability flux given as @xmath379    for the derivation below , we assume that the expectations always exist , and that the sufficient conditions which enable the interchange of the orders of limit and integral ( such as the dominated convergence theorem ) are satisfied .",
    "these conditions are additional constraints on the test function @xmath203 , but they do not change the boundary conditions that are satisfied by @xmath203",
    ". therefore our results will not be changed by these conditions . by proposition  [ prop : lf ]",
    ", @xmath350 , the dynkin s formula ( [ eq : dynkin ] ) holds .",
    "evaluate the expectation using @xmath106 , and take the time derivative of both sides of ( [ eq : dynkin ] ) , which yields @xmath380,\\label{eq : dt}\\ ] ]    it follows from grouping the terms in ( [ eq : dt ] ) that @xmath381dv=0,\\label{eq : prediv}\\end{gathered}\\ ] ]    by the chain rule of differentiation , the second term in ( [ eq : prediv ] ) can be written as @xmath382 and the third term can be written as @xmath383 where we dropped the dependence of the variables where no confusion arises .",
    "supposing that all the vector fields under the divergence operation in ( [ eq : advection ] ) and ( [ eq : diffusionterm ] ) satisfy the absolutely integrable condition ( [ eq : intcon ] ) , we can use lemma [ lem : divergence ] in ( [ eq : prediv ] ) to shift the differential operator from @xmath203 to @xmath273 . since @xmath273 is piecewise @xmath222 in the interior of each @xmath51 , the divergence theorem shall be applied on each component of @xmath204 .",
    "it then follows after grouping the terms that @xmath384\\psi dv-\\int_{\\partial x_{q}^{i}}\\left(\\gamma\\psi+\\frac{1}{2}p\\sigma\\emph{\\ensuremath{\\nabla}}\\psi\\right)\\cdot\\nu ds=0\\label{eq : component}\\ ] ] where @xmath385 $ ] and @xmath378 is defined in  ( [ eq : fkpde ] ) , and @xmath386 is the outer unit normal vector on @xmath387 .",
    "now let @xmath203 be compactly supported in one of the component region @xmath235 .",
    "then all the surface integrals in ( [ eq : component ] ) vanishes , and we are left with @xmath388\\psi dv=0.\\ ] ]    since @xmath203 is arbitrary , we must have @xmath385=0 $ ] .",
    "thus it completes the proof .",
    "the obtained pdes are coupled on their defined regions due to the source terms caused by the random jumps . noting that without the random jump , i.e. @xmath389 , equation ( [ eq : fkpde ] ) reduces to the well - known fokker - planck equations .",
    "they are also coupled on the boundaries where deterministic jumps take place .",
    "these appear as the boundary conditions given in the following theorem .",
    "[ thm : mainbc]considering the shs process represented by  ( [ eq : sde3 ] ) , the corresponding pde model given in ( [ eq : fkpde ] ) satisfies the following boundary conditions , @xmath352 @xmath390 @xmath391 @xmath392\\cdot\\nu(q , x)=0,\\label{eq : conservation}\\ ] ] where @xmath393 and @xmath394 denote the probability flux and density from the side of @xmath231 which has the same outer normal direction as that of @xmath74 , respectively , while @xmath395 and @xmath396 are from the other side , and @xmath54 is the outer unit normal vector on @xmath50 .",
    "note that the surface integrals in  ( [ eq : component ] ) are evaluated on the outflow switching surface @xmath74 once and on the inflow switching surface @xmath231 twice from both sides .",
    "then by applying the adjoint boundary condition @xmath397 in proposition  [ prop : lf ] , the probability flux term @xmath398 from these three different components can be regrouped , while the gradient term @xmath399 evaluated from both sides of @xmath231 can be grouped together since @xmath400 , @xmath52 , and the last group is @xmath399 evaluated on @xmath74 . further noting the relations between the outer normal directions of @xmath50 as in @xmath74 and in @xmath231 from both sides",
    ", we can have from  ( [ eq : component ] ) that @xmath401\\psi(q , x)dv-\\underset{{\\scriptstyle q}}{\\sum}\\left(\\int_{\\mathcal{g}_{q}}f\\psi(q^{+},x)ds\\right.\\\\ \\left.\\int_{\\mathcal{g}_{q}}h\\emph{\\ensuremath{\\nabla}}\\psi(q^{+},x)ds+\\int_{\\mathcal{g}_{q}}g\\emph{\\ensuremath{\\nabla}}\\psi(q , x)ds\\right)=0,\\label{eq : afterdiv}\\end{gathered}\\ ] ] where @xmath402 , @xmath403 , @xmath404 denote the left hand sides of  ( [ eq : conservation ] ) , ( [ eq : continuity ] ) and  ( [ eq : absorbing ] ) , respectively .    from theorem  [ thm : mainpde ]",
    "we know that the volume integral in  ( [ eq : afterdiv ] ) is 0 .",
    "since @xmath405 , @xmath406 , and @xmath407 can take arbitrary values on @xmath50 , @xmath402 , @xmath404 , and @xmath403 must vanish on @xmath50 .",
    "thus we obtain the boundary conditions in  ( [ eq : absorbing])-([eq : conservation ] ) .",
    "[ rmk : mnfcners]a closer look at the boundary conditions in  ( [ eq : absorbing])-([eq : conservation ] ) will give us insight into the patterns of those conditions .",
    "physically , @xmath408 represents the projection of the multidimensional brownian motion along the normal direction of the outflow switching surface . particularly , if @xmath409 , we see from  ( [ eq : absorbing ] ) that the p.d.f . at any point of the outflow",
    "switching surfaces must be @xmath410 , and similarly  ( [ eq : continuity ] ) then means that the p.d.f . is continuous across the inflow switching surfaces .",
    "condition  ( [ eq : conservation ] ) means that the sum of the probability fluxes along the normal direction of the inflow switching surface is zero .",
    "therefore , following the convention of  @xcite , we will call  ( [ eq : absorbing ] ) the absorbing condition ,  ( [ eq : continuity ] ) the continuity condition , and  ( [ eq : conservation ] ) the probability conservation condition .",
    "the proposed shs based approach provides a unified framework to obtain aggregated load models .",
    "it offers an accelerated aggregated modeling procedure : once the individual load dynamics are specified , the pde model that captures the aggregated dynamics can be obtained immediately from theorem  [ thm : mainpde ] and  [ thm : mainbc ] , without going through the whole derivation on a case - by - case basis .",
    "we will demonstrate the advantages and effectiveness of our method through the following examples .",
    "consider the same hvacs model in example  [ ex : shvac ] , but with homogeneous load parameters and setpoints .",
    "note that for the convenience of comparison , we do not consider the random jump in this example .",
    "the hybrid state space @xmath204 , outflow switching surface @xmath74 , and inflow switching surface @xmath231 are illustrated in fig .",
    "[ fig : hvacss ] . denote @xmath411 as the components of @xmath204 , where @xmath412 represents the overlapped continuous domain @xmath413 and @xmath414 represents the other component of @xmath51 .",
    "then let @xmath415 be the corresponding p.d.f .",
    "defined on @xmath416 . by theorem  [ thm :",
    "mainpde ] , we have @xmath417 on regions @xmath416 , @xmath418 and @xmath419 , where @xmath420 is the vector field of the individual hvac model .",
    "the boundary conditions follow from  ( [ eq : absorbing])-([eq : conservation ] ) .",
    "we have the outer unit normal vector @xmath421^{t}$ ] on the outflow switching surface @xmath422 .",
    "similarly , for the on mode @xmath423^{t}$ ] on @xmath424 . therefore  ( [ eq : absorbing ] ) yields @xmath425 @xmath418 , @xmath55 .",
    "condition  ( [ eq : continuity ] ) reduces to @xmath426 on the inflow switching surface @xmath231 .",
    "note that according to the convention used in theorem  [ thm : mainbc ] , the probability flux @xmath427 is defined in @xmath428 , while @xmath429 is the outflow probability flux from @xmath430 , @xmath431 .",
    "furthermore , using the boundary conditions obtained above and the continuity of the vector field @xmath432 , we have from  ( [ eq : conservation ] ) that on @xmath231 , @xmath433    the results in  @xcite is a special case of the results obtained here if the one dimensional etp model is used in the above .",
    "another boundary condition listed in  @xcite , which is the decaying condition at infinity , can be obtained directly from the existence of the integrals  ( [ eq : dt ] ) .",
    "other works on aggregated modeling of tcls  @xcite can also be obtained from theorems  [ thm : mainpde ] and  [ thm : mainbc ] similarly .",
    "it is worth mentioning that the example [ ex : pevs ] of pev charging is actually a pdmp  @xcite .",
    "we see that only @xmath89 is divided into two components @xmath434 and @xmath435 , with each of which we associate the p.d.f . @xmath436 and @xmath437 , respectively .",
    "consider the random jumps , and suppose that the transition rate function @xmath115 is known .",
    "then we can have from  ( [ eq : fkpde ] ) that : @xmath438 @xmath439 @xmath440 @xmath441    since @xmath442 is a zero matrix , there are only probability conservation conditions . on the outflow switching surface @xmath422 , we have @xmath443^{t}$ ] .",
    "denote @xmath444 and @xmath445 the switching surfaces corresponding to the two components of @xmath89 , for both of which we have @xmath423^{t}.$ ] then it follows from ( [ eq : conservation ] ) that @xmath446      in this example , we consider the price response of a heterogeneous group of hvacs , each described by a second order deterministic etp model ( [ eq : hvacsetp ] ) .",
    "the heterogeneities appear in the etp parameters such as the heat flux @xmath447 , the thermal mass of the air @xmath448 , the thermal mass of the inner solid mass @xmath449 , the conductance of between the air and inner solid mass @xmath450 , as well as the setpoint .",
    "we do not consider the noise process in this example .",
    "the price response of this heterogeneous group of hvacs can be simulated by calculating the weighted sum of the solutions to several pde models .",
    "the coefficients of each pdes are evaluated at the cluster centers of the sampled parameters .",
    "for example , the p.d.f . evolution of the @xmath6th cluster can be modeled by @xmath451 in component @xmath416 , @xmath418 , @xmath419 , where the hybrid state space and component @xmath416 are the same as those defined in subsection [ sub : pdehvac ] .",
    "@xmath452 is the vector field at the @xmath6th center , @xmath453 .",
    "the boundary conditions are obtained from theorem [ thm : mainbc ] as @xmath454 for @xmath455 if @xmath456 , and @xmath457 if @xmath458 .",
    "once the @xmath459 are obtained for each cluster , the aggregated power response can be calculated as @xmath460 where @xmath98 is the total number of the hvacs , @xmath461 is the power consumption of one hvac , and @xmath462 is the weight of the @xmath6th cluster .    without loss of generality , we assume that the price changes at @xmath463 hour and @xmath464 hour , which cause the setpoints changes of all hvacs by @xmath30 and @xmath465 , respectively . for the monte carlo simulation , the load parameters are generated randomly using gridlab - d @xcite , and then the etp model is derived using these parameters .",
    "the initial setpoints for the 2000 hvacs are generated uniformly between @xmath28 $ ] , and the initial temperatures for air and internal solid mass are generated uniformly within the temperature deadband . for the pde simulation , the @xmath6-means clustering method is performed over the system matrices ( which are generated by the load parameter and note that @xmath25 is linear in @xmath116 and @xmath41 ) to obtain 10 clusters .",
    "the initial distribution @xmath466 is given arbitrarily since the aggregated power output converges to the steady state sufficiently closely before the setpoint changes .",
    "then the pdes in ( [ eq : pdecluster ] ) are solved for each cluster using the donor - cell finite volume scheme along with the dimensional splitting method for multidimensional problem @xcite .",
    "we compare in fig .",
    "[ fig : mcvsweightedpde ] the aggregated response of monte carlo simulation of 2000 hvacs and that of the weighted pdes of 10 clusters",
    ". clearly , the weighted pde model captures the major oscillation cycles after the price / setpoint changes very accurately .",
    "comparison of aggregated response between monte carlo simulation and weighted pde using 10 clusters . ]",
    "this paper developed a unified stochastic hybrid system models for the aggregation of large population of responsive loads .",
    "general nonlinear stochastic differential equations were used to describe the continuous state evolutions between discrete mode transitions , and the transition mechanism was modeled by both deterministic and random jumps .",
    "a general description of the continuous state domain was formulated .",
    "the extended generator of the proposed stochastic hybrid system process was characterized and a class of martingales on this process was also specified .",
    "based on these results , the aggregated dynamics was captured by a system of coupled pdes , which describes the time evolution of the probability density function of the hybrid states .",
    "the complete set of boundary conditions was obtained for the pde model .",
    "these results generalized many existing results and can be directly applied to more general modeling scenarios .",
    "several examples were provided to illustrate the effectiveness of the proposed modeling framework .",
    "gridlab - d residential module user s guild .",
    "[ online ] .",
    "available : http://sourceforge.net / apps / mediawiki / gridlab - d / index.php?title=    residential_module_user%27s_guide[http://sourceforge.net / apps / mediawiki / gridlab - d / index.php?title=    residential_module_user%27s_guide ]    s.  bashash and h.  fathy , `` modeling and control insights into demand - side energy management through setpoint control of thermostatic loads , '' in _ american control conference ( acc ) , 2011 _ , june 2011 , pp . 45464553 .",
    "m.  l. bujorianu and j.  lygeros , `` toward a general theory of stochastic hybrid systems , '' in _ lecture notes in control and information science _",
    ", h.  blom and j.  lygeros , eds.1em plus 0.5em minus 0.4emspringer berlin heidelberg , 2006 , vol .",
    "330 .    d.  s. callaway , `` tapping the energy storage potential in electric loads to deliver load following and regulation with application to wind energy , '' _ energy conversion and management _ , vol .",
    "50 , no .  5 , pp .",
    "1389 1400 , may 2009",
    ".      b.  k. driver , `` surfaces , surface integrals and integration by parts , '' mar .",
    "2002 , lecture notes on partial differential equations .",
    "[ online ] .",
    "available : http://www.math.ucsd.edu/~bdriver/231-02-03/lecture_notes/pde8.pdf    r.  j. elliott , `` stochastic integrals for martingales of a jump process with partially accessible jump times , '' _ zeitschrift fr wahrscheinlichkeitstheorie und verwandte gebiete _ , vol .",
    "36 , no .  3 , pp .",
    "213226 , 1976 .",
    "a.  ghaffari , s.  moura , and m.  krsti , `` analytic modeling and integral control of heterogeneous thermostatically controlled load populations , '' in _ proceedings of asme 2014 dynamic systems and control conference , dscc 2014 , san antonio , usa _ , oct .",
    "2014 .",
    "k.  kalsi , f.  chassin , and d.  chassin , `` aggregated modeling of thermostatic loads in demand response : a systems and control perspective , '' in _",
    "50th ieee conference on decision and control and european control conference ( cdc - ecc ) _ , dec 2011 , pp .",
    "1520 .",
    "s.  koch , j.  l. mathieu , and d.  s. callaway , `` modeling and control of aggregated heterogeneous thermostatically controlled loads for ancillary services , '' in _",
    "17th power systems computation conference _ ,",
    "stockholm , sweden , august 2011 .",
    "s.  li , w.  zhang , j.  lian , and k.  kalsi , `` on market - based coordination of thermostatically controlled loads with user preference , '' in _",
    "ieee 53rd annual conference on decision and control ( cdc ) _ , dec .",
    "2014 , pp . 24742480 .",
    "r.  malham and c .- y .",
    "chong , `` electric load model synthesis by diffusion approximation of a high - order hybrid - state stochastic system , '' _ ieee transactions on automatic control _ , vol .  30 , no .  9 , pp . 854860 , sep 1985",
    ".    s.  moura , j.  bendtsen , and v.  ruiz , `` parameter identification of aggregated thermostatically controlled loads for smart grids using pde techniques , '' _ international journal of control _ , vol .",
    "87 , no .  7 , pp . 13731386 , 2014 .",
    "s.  moura , v.  ruiz , and j.  bendtsen , `` modeling heterogeneous populations of thermostatically controlled loads using diffusion - advection pdes , '' in _ 2013 asme dynamic systems and control conference ; stanford , ca _ , 2013 .",
    "w.  zhang , j.  lian , c .- y .",
    "chang , and k.  kalsi , `` aggregated modeling and control of air conditioning loads for demand response , '' _ ieee transactions on power systems _ , vol .",
    "28 , no .  4 , pp .",
    "46554664 , nov 2013 ."
  ],
  "abstract_text": [
    "<S> nondisruptive demand response programs often result in complex and fast aggregated load dynamics , which may lead to severe impact on the distribution and transition systems . </S>",
    "<S> accurate modeling of aggregated load dynamics is of fundamental importance for systematic analysis and design of various demand response strategies . </S>",
    "<S> existing methods mostly focus on simple first - order linear thermostatically controlled loads ( tcls ) . </S>",
    "<S> this paper develops a novel stochastic hybrid system ( shs ) framework to model individual responsive loads . </S>",
    "<S> the proposed shs has general nonlinear diffusion dynamics in each discrete mode and has both random and deterministic state - dependent mode transitions . </S>",
    "<S> we make an explicit connection between the extended generator of the corresponding shs process and the partial differential equations governing the evolution of the hybrid - state probability density function . </S>",
    "<S> consequently , a general coupled fokker - planck equation characterizing the aggregated load dynamics is derived . especially , the boundary conditions due to the deterministic switchings are uniquely determined via the accurate characterization of the extended generator . </S>",
    "<S> the proposed modeling approach includes many existing methods as special cases and provides a unified representation of a variety of responsive loads . </S>",
    "<S> realistic demand response examples are also provided to illustrate the effectiveness of the proposed shs framework . </S>"
  ]
}