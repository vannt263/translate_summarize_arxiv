{
  "article_text": [
    "equilibrium , zero - temperature and finite - temperature green s functions ( gf ) techniques based on many - body perturbation theory are widely used in electronic - structure and total - energy calculations .",
    "they are central for the calculation of the thermodynamical properties of many - body systems , as well as for the calculation of linear responses of systems under small time - dependent ( or not ) perturbations @xcite .",
    "conventional equilibrium many - body gf approaches , at zero temperature , concentrate on the time - ordered gf and determine its dynamical equation ( in the form of an equation of motion , or its integral form known as the dyson equation ) using a self - energy which includes all the many - body interaction effects .",
    "the matsubara formalism using time - ordered gf with imaginary time arguments ( or imaginary matsubara frequency in the dual fourier representation ) has been developed to deal with the finite temperature condition .",
    "interestingly , not much has been done at finite - temperature for the time - ordered gf in real time or real frequency representation .",
    "however , when one wants to study systems driven out of equilibrium by an external `` force '' , as for example in the context of electron or heat current flow , or for any system driven by an external electromagnetic field ( whether time - dependent or not ) , one needs to extend the equations for the dynamics of the quantum many - body interacting system to the non - equilibrium conditions .    for this , the non - equilibrium green s function ( negf )",
    "technique@xcite has been widely used to calculate non - linear charge and heat transport properties of solids , mesoscopic and nanoscopic systems .",
    "also known as the closed time - path formalism @xcite , the negf formalism relies on an `` artificial '' time parameter that runs on a mathematically convenient time - loop contour ( plus eventually an imaginary time for taking into account the initial correlation and statistical boundary conditions ) .",
    "it is a formal procedure that only has a direct physical meaning when one projects back the time parameters of the time - loop contour onto real times .",
    "it was introduced because it allows one to obtain self - consistent dyson - like equations for the keldysh green s function using schwinger s functional derivative technique . transforming the dyson equation to real time by varying the keldysh time parameter over the time - loop contour results in a set of self - consistent equations for the different non - equilibrium green s functions ( advanced / retarded or lesser / greater ) .",
    "the negf technique is general and can treat non - equilibrium as well as equilibrium conditions , at zero and finite temperatures , within a single framework .    in this paper",
    "we focus on the dynamical equation of the time - ordered gf with real time argument , and we show that the time - ordered gf obeys a conventional dyson equation only in a limiting case : at equilibrium and zero temperature . in any other cases , i.e.  equilibrium at finite temperature or non - equilibrium , the time - ordered gf obeys instead a _ modified _",
    "dyson equation containing correction terms .",
    "these correction terms were introduced in an _ ad hoc _ way in the seminal work of hedin and lundqvist @xcite .",
    "we derive the modified dyson equation for the time - ordered gf in a natural way from the keldysh time - loop contour approach .",
    "we also show that for the equilibrium case at finite temperature , such correction terms can be obtained by a proper treatment of the imaginary time matsubara finite - temperature green s functions .",
    "the paper is organized as follows : in section [ sec : negf - eom ] , we derive the modified dyson equation for the time - ordered gf from the time - loop contour formalism .",
    "we then concentrate on the equilibrium condition .",
    "section [ sec : gfatt_handl ] shows explicitly the relation between hedin and lundqvist s seminal work on real - time gfs at finite temperature and our result . in section [ sec : matsubaragf ] , we show that our result can also be obtained in by using matsubara temperature gfs and a proper treatment of the analytical continuation rules .",
    "we conclude and discuss the importance of our result in section [ sec : ccl ] .",
    "[ app : analyticalcontinuation ] and [ app : gfsedefinitions ] contain important and useful relations for the gfs and self - energies on the time - loop contour . in [ app : hubbardmodel ] we provide a concrete example of our general results for a specific system : the single site hubbard model at finite temperature .",
    "the green s function on the keldysh contour @xmath0 is defined as @xmath1 where @xmath2 stands for a composite index for space @xmath3 and time @xmath4 on the time - loop contour @xmath0 .",
    "the time - loop contour @xmath0 consists of a chronological time evolution ( @xmath5 ) branch followed by an anti - chronological time evolution ( @xmath6 ) branch @xcite , as shown in figure [ fig : ck ] .",
    "the time ordering @xmath7 of the product of fermion creation ( @xmath8 ) and annihilation ( @xmath9 ) quantum fields is performed on the time - loop contour @xmath0 .",
    "( 1.5,0.1 ) ( 1.15,0.12)(0.1,0.12)[r ] ( 0.25,0.18)(1,0)0.9 ( 0.01,0.18 ) ( 1.15,0.20 ) ( 1.15,0.06)(-1,0)0.9 ( 0.01,0.06 ) ( 1.25,0.07 ) ( 0.2,0.01)(1,0)1.2 ( 0.4,0)@xmath10 ( 0.4,-0.1 ) ( 0.8,0)@xmath10 ( 0.8,-0.1 ) ( 1.2,0)@xmath10 ( 1.2,-0.1 ) ( 0.38,0.165)@xmath11 ( 0.38,0.22)@xmath12 ( 0.78,0.045)@xmath11 ( 0.78,0.10)@xmath13 ( 1.42,0 )    the green s function obeys the equation of motion on the contour @xmath0 @xcite : @xmath14g(1,1^\\prime ) =   \\delta(1 - 1^\\prime ) + \\int { \\rm d}3 \\sigma(1,3)g(3,1^\\prime),\\ ] ] and the adjoint equation reads @xmath15g(1,1^\\prime ) = \\delta(1 - 1^\\prime ) + \\int { \\rm d}2 g(1,2 ) \\sigma(2,1^\\prime),\\ ] ] where @xmath16 is the non - interacting hamiltonian .",
    "hence , in a integral form , @xmath17 follows a dyson - like equation @xmath18 where @xmath19 is the green s function  for the non - interacting system , i.e. @xmath20g(1,2 ) =   \\delta(1 - 2)$ ] , and the time integrations run on @xmath0 .",
    "( [ eq : dysongck ] ) is valid provided that , in the remote past , the system is unperturbed and non - interacting and that the adiabatic assumption for switching on the interaction is fulfilled , as usually assumed within the keldysh formalism @xcite .",
    "furthermore the non - interacting green s function  @xmath19 satisfies the kubo - martin - schwinger boundary conditions ( for example see eq .",
    "( 3.16 ) in @xcite ) .    upon the position of the time arguments @xmath21 on @xmath0 , one obtains four different projections onto the real ( normal ) time arguments @xmath22 , i.e. the four `` keldysh components '' of @xmath17 : @xmath23 with @xmath24 on the @xmath25 branch of @xmath0 .",
    "so @xmath26 is the conventional time - ordered gf ( though in the non - equilibrium  conditions ) , and @xmath27 and @xmath28 are automatically ordered knowing that any time on the branch @xmath29 is later than any time on the branch @xmath30 on @xmath0 .",
    "note that the equation of motion for @xmath31 does not contain the source term @xmath32 since the time @xmath12 and @xmath33 are on different branches , and in the non - interacting case , one has @xmath20g^\\lessgtr(1,2 ) = 0 $ ] , and @xmath34g^\\lessgtr(1,2 ) = 0 $ ] .    using the relationships between the different gfs given in appendix [ app : gfsedefinitions ]",
    ", one can calculate the integral equations for the different green s functions @xcite , and one finds that the retarded and advanced @xmath35 green s functions obey a dyson - like equation : @xmath36 ( likewise for @xmath37 ) where the time integrations are on the real times @xmath38 .",
    "the lesser and greater @xmath39 gfs obey the following quantum kinetic equation : @xmath40 given in a compact notation .",
    "eq.([eq : dysonglessgtr ] ) is valid within the conventional assumption of the keldysh time - loop contour formalism where the interactions are switched on adiabatically .",
    "the most general solution for the lesser / greater green s function  can be found in appendix a of ref .",
    "@xcite .      following the rules of decomposition of the time - loop contour @xmath0 onto real - time given in appendix [ app : analyticalcontinuation ] , one can expand the equation for the time - ordered gf @xmath41 as follows ( using compact notation ) @xmath42 hence we get @xmath43 after further manipulation , using [ app : analyticalcontinuation ] and [ app : gfsedefinitions ] , we can show that the second line in eq .",
    "( [ eq : app_g++bis ] ) becomes @xmath44 .",
    "hence the full equation for the time - ordered gf is @xmath45    from the equation of motion of gf on the keldysh contour , we find @xmath46 g^>(2,3 ) \\ , \\ ] ] and by using the ( adjoint ) equation of motion of the non - interacting gf @xmath47 , i.e. @xmath48 g^>(1,2)=0 $ ] , we can integrate eq .",
    "( [ eq : extra ] ) by part and find that @xmath49(1,3 ) \\equiv \\int { \\rm d}x_2 \\ { \\rm i } [ g^<(1,x_2 t ) g^>(x_2 t , 3)]_{t=+\\infty } - { \\rm i } [ g^<(1,x_2 t ) g^>(x_2 t , 3)]_{t=-\\infty } \\ , \\ ] ] which represents a boundary condition term for the time variable ( after all we are solving a first order differential equation in time ) .",
    "hence eq .",
    "( [ eq : app_g++bis ] ) is transformed into @xmath50_{t=+\\infty } - { \\rm i } [ g^<(1,x_2 t ) g^>(x_2 t , 3)]_{t=-\\infty } , \\end{split}\\ ] ] or equivalently ( in compact notation ) @xmath51    eq .",
    "( [ eq : app_gt_last_bis ] ) , equivalently eq .  ( [ eq : app_g++bis ] ) , is the most general result for the time - ordered green s function and is valid for the non - equilibrium case at finite and zero temperature .",
    "it also clearly shows that the time - ordered green s function @xmath52 does not follow a dyson - like equation .",
    "however this is not a closed equation , in contradistinction with the dyson equations for the advanced and retarded components , since it also involves greater and lesser components for the gf and the self - energy . in the general non - equilibrium conditions ,",
    "one rather works with the closed equations obtained for the retarded and advanced gf which are related to spectroscopic properties , and with the quantum kinetic equations obtained for the lesser and greater gf . though at equilibrium , the lesser and greater components of gf or a self - energy are related to the respective spectral functions and the equilibrium distribution .",
    "hence we recover closed equations for the time - ordered gf .",
    "we also establish in section  [ sec : matsubaragf ] the formal links with the approach of hedin and lundqvist and with the matsubara temperature gf formalism .",
    "it would be interesting to find some conditions under which the the boundary condition term in eq .",
    "( [ eq : app_gt_last_ter ] ) vanishes . at equilibrium , because of the principle of adiabatic switching ( on / off ) of the interactions in the remote past / future , the initial state returns ( up to a phase factor ) to itself in the far future .",
    "therefore it would be tempting to consider that the the two terms defining the boundary condition are the same at @xmath53 and that the boundary condition term vanishes .",
    "however this is not that case , as shown in section  [ sec : matsubaragf ] .    at non - equilibrium ,",
    "the problem is different and the solution may depend on the size of the system . for an infinite system ( a large system in the thermodynamic limit ) , in some cases , we would like to use the so - called memory - loss theorem @xcite : the long time limit of the lesser ( or greater ) components of the gf or of the self - energy vanish .",
    "hence in that case , the boundary condition term may vanish ( though this needs to be proven ) .",
    "this corresponds to cases when the system `` thermalise with the environment '' . for finite size systems at non - equilibrium ,",
    "no `` thermalisation '' is possible and the boundary condition term play an important role in the solution of dynamical equation of the time - ordered gf .    before turning onto the equilibrium condition ,",
    "let us make two further general remarks .",
    "one could note that from the definition @xmath54 ( see appendix [ app : gfsedefinitions ] ) or equivalently @xmath55 , one could have gueseds that @xmath56 does not obey a dyson equation since @xmath57 does , but not @xmath58 @xcite .",
    "futhermore we have also checked that we can also recover , as expected , our result eq .",
    "( [ eq : app_gt_last_ter ] ) by using the kadanoff - baym formalism which is somewhat different but equivalent to the keldysh time - loop approach @xcite .",
    "we now turn onto the special case of equilibrium for which the green s functions techniques based on many - body perturbation theory were orginally derived .    at equilibriumn , as in the steady state , all quantities @xmath59 ( gfs and self - energies ) depend only on the time difference @xmath60 .",
    "one can then fourier transform the quantity @xmath60 and work in the real - frequency representation @xmath61 .",
    "the main result of the paper , eq .",
    "( [ eq : app_gt_last_bis ] ) , is recast as : @xmath62 in compact notation ( i.e. omitting the explicit integrals over space ) .",
    "it should be noticed that the last term @xmath63 in eq .",
    "( [ eq : app_gt_last_bis ] ) satisfies the detailed balance equation at equilibrium @xcite : @xmath64 .",
    "( [ eq : app_gt_last_bis ] ) can also be recast as @xmath65^{-1 } - \\sigma^t(\\omega ) \\right ] g^t(\\omega ) + \\sigma^<(\\omega ) g^>(\\omega ) = 1 \\ , \\ ] ] ignoring the boundary conditions term .",
    "furthermore , at equilibrium , the lesser and greater components of either a gf or a self - energy ( @xmath66 ) can be expressed in terms of the corresponding advanced and retarded quantity and a distribution function @xcite , i.e. @xmath67 and spectral function @xmath68 .    at equilibrium and for a system of fermions , @xmath69 is given by the fermi - dirac distribution function @xmath70^{-1}$ ] and @xmath71 ( with @xmath72 ) .",
    "( [ eq : nedistrib ] ) follows from the kubo - martin - schwinger relationship between the lesser and greater component at equilibrium : @xmath73 .",
    "hence we can easily see that @xmath74    therefore in the limit of zero temperature , there is no contribution from @xmath63 since @xmath75 ( this property holds for any product @xmath76 , and hence for the boundary condition term @xmath77 ) , and the time - ordered gf @xmath56 obeys a conventional dyson - like equation @xmath78 $ ] .",
    "it is only in the case of equilibrium at zero temperature that @xmath56 follows a dyson equation otherwise at finite temperature @xmath56 obeys a modified dyson equation , eq .",
    "( [ eq : app_gt_w_hedinform ] ) , including the extra term @xmath63 and the boundary condition term @xmath77 .    in the following section , we are going to show how hedin and lundqvist noticed the necessity to introduce correction terms in the real - time green s function at finite temperature @xcite .",
    "they found it necessary to introduce extra terms in the dyson equation of the real - time green s function at finite temperature to recover the expected behaviour of the independent particle case .",
    "the terms introduced _",
    "ad hoc _ by hedin and lundqvist correspond exactly to the @xmath63 term that we have obtained in a natural way from the use of the time - loop contour .",
    "in this section , we retrace the analysis made by hedin and lundqvist ( section 17 of ref .",
    "@xcite ) on the temperature green s functions .",
    "the definition for the real - time gf at finite temperature follows from the zero temperature case by using an ensemble average for the time - ordered product of fermion operators instead of a ground state expectation value , i.e. @xmath79 , \\ ] ] where the statistical operator ( density matrix ) @xmath80 and the partition function @xmath81 $ ] are given for the grand canonical ensemble .",
    "after fourier transform , we can write the time - ordered gf using a spectral representation just as in the zero temperature case @xcite : @xmath82 , \\ ] ] where we omit the spatial variables .    from eq .",
    "( [ eq : gt_t_w ] ) , we can obtain the real and imaginary parts of @xmath83 : @xmath84 and @xmath85 a(\\omega ) \\ .\\ ] ]    hedin and lundqvist noticed that by considering the conventional dyson equation for the time - ordered gf : @xmath86 g(\\omega ) = 1 $ ] , one derives the following spectral function @xmath87 ^ 2+\\pi^2 b(\\omega)^2 [ 2 f^{\\rm eq}-1]^2 } , \\ ] ] with the spectral representation for the self - energy @xmath88 b(\\omega)$ ] .",
    "however eq .  ( [ eq : wrongaw ] ) does not have the proper limit in @xmath89 for the independent particle case where @xmath90 and @xmath91 .    to palliate this discrepancy , hedin and lundqvist introduced _ ad hoc _ a correction term in the conventional dyson equation that @xmath92 and @xmath93 must obey .",
    "their modified dyson equation reads @xmath94 g(\\omega ) + ( 2\\pi)^2 f^{\\rm eq } ( 1-f^{\\rm eq } ) a(\\omega ) b(\\omega ) = 1 .\\ ] ] from this modified dyson equation , one can calculate the imaginary part of @xmath83 and obtain the spectral function @xmath95 @xmath96 ^ 2+\\pi^2 b(\\omega)^2 } , \\ ] ] as for the zero temperature limit , it has the proper limit @xmath97 for the limit @xmath90 and @xmath91 .",
    "hedin and lundqvist conclude `` _ that the rather messy definition of @xmath93 in eq .",
    "( [ eq : gtdyson_fromhedin ] ) shows that it is better if , at finite temperature , we can work with concepts other that the straight - forward generalisation in eq .",
    "( [ eq : gt_t ] ) of the zero temperature green s function .",
    "one possibility is to use the matsubara technique with temperature green s functions , or the close related martin and schwinger technique ... _ '' @xcite .",
    "it is interesting to note that the `` messy '' definition eq .",
    "( [ eq : gtdyson_fromhedin ] ) is actually the correct result for the time - ordered gf @xmath56 at finite temperature .",
    "( [ eq : gtdyson_fromhedin ] ) is strictly equivalent to eq .",
    "( [ eq : app_gt_w_hedinform ] ) when one notices that in the definition of @xmath63 in eq .",
    "( [ eq : sigmalessggtr ] ) one deals with the same spectral functions , i.e. @xmath98 and @xmath99 .",
    "so by using the keldysh time - loop contour , we have found in a natural way , almost straightforward , the proper modified dyson equation for @xmath56 at equilibrium and this , without the need of introducing correction terms with no proper justification , other than the need to recover the correct behaviour for @xmath100 in the non - interacting case .    to conclude this section",
    ", one could rephrase our result by saying that the time - ordered gf @xmath56 at equilibrium and finite temperature obeys a dyson equation @xmath101 only if one defines the corresponding self - energy @xmath102 as @xmath103 .",
    "in the next section , we show that the proper modified dyson equation for @xmath56 can be obtained from the knowledge of the spectral function @xmath104 , with @xmath105 being a gf or a self - energy .",
    "we also discuss the connection of our result with the matsubara temperature green s functions .",
    "we extract the spectral function @xmath106 using the dyson equations for @xmath35 : @xmath107    using the definitions of the spectral functions @xmath106 and @xmath108 and the fact that @xmath109 as in eq .",
    "( [ eq : regt_t_w ] ) ( with similar relations for the self - energy @xmath93 ) , we find @xmath110    the time - ordered gf @xmath111 can then be obtained from its spectral representation eq .",
    "( [ eq : gt_t_w ] ) using the expression of the spectral function @xmath100 given by eq .",
    "( [ eq : a_w ] ) . the first term in the rhs of eq .",
    "( [ eq : a_w ] ) generates the non - interacting time - ordered gf @xmath112 , while the two other terms regrouped in @xmath113 give a real part @xmath114 and an imaginary part @xmath115 d(\\omega)$ ] . the proper result for the modified dyson equation of @xmath111",
    "can be obtained after lengthy algebraic derivations .",
    "instead we now show another just as valid shorter route to end up with the correct result .",
    "we consider the different contributions of a conventional dyson @xmath116 . from the spectral representation ,",
    "we have already generated the term in @xmath117 from @xmath118 , so we are left with the @xmath119 .",
    "we first concentrate on the product @xmath120 : @xmath121 where we have introduced , in the last equality , the definition of the product @xmath63 given in eq .",
    "( [ eq : sigmalessggtr ] ) .",
    "we can see that the correction term in @xmath63 appears already at this level .",
    "hence one can see that @xmath122    to finish our derivation , we first consider the imaginary part of @xmath123 . by using the definition for @xmath117 from eqs .",
    "( [ eq : regt_t_w ] ) and ( [ eq : imgt_t_w ] ) @xmath124 , we obtain : @xmath125 \\\\ & = \\im m ( g^t)\\ \\re e ( 1 + \\sigma^t",
    "g^t - \\sigma^ < g^ > )   + \\re e(g^t)\\ \\im m ( 1 + \\sigma^t g^t - \\sigma^ <",
    "g^ > ) \\\\ & = ( 2f^{\\rm eq } - 1 ) \\pi a^g \\left ( 1 + \\re e \\sigma \\re e g - \\pi^2 a^\\sigma a^g \\right ) + \\re e(g ) ( 2f^{\\rm eq } - 1 ) \\pi   \\left ( \\re e \\sigma .",
    "a^g + a^\\sigma   \\re e g    \\right ) \\\\ & =( 2f^{\\rm eq } - 1 )   \\pi a^g \\\\",
    "& = \\im m g^t \\ . \\end{split}\\ ] ] for the real part of @xmath123 , we find that @xmath126 \\\\ & = \\re e ( g^t)\\ \\re e ( 1 + \\sigma^t g^t - \\sigma^ < g^ > )    - \\im m ( g^t)\\ \\im m ( 1 + \\sigma^t g^t - \\sigma^",
    "< g^ > ) \\\\ & = \\re e ( g ) \\left ( 1 + \\re e \\sigma \\re e g - \\pi^2 a^\\sigma a^g \\right ) - ( 2f^{\\rm eq } - 1 ) \\pi   a^g ( 2f^{\\rm eq } - 1 ) \\pi \\left ( \\re e \\sigma .",
    "a^g + a^\\sigma   \\re e g    \\right ) \\\\ &",
    "= \\re e ( g ) \\left ( 1 + \\re e \\sigma \\re e g - \\pi^2 a^\\sigma a^g \\right )   - \\pi^2 a^g \\left ( \\re e \\sigma .",
    "a^g + a^\\sigma   \\re e g    \\right ) \\\\ & - 4 f^{\\rm eq } ( f^{\\rm eq } - 1 ) \\pi   a^g \\pi \\left ( \\re e \\sigma .",
    "a^g + a^\\sigma   \\re e g    \\right ) \\ . \\end{split}\\ ] ] we can use the properties of the hilbert transform @xcite , i.e. @xmath127\\ ] = -f$ ] and the bedrosian indentity @xmath128=f\\mathcal{h}[g]=g\\mathcal{h}[f]$ ] , to show that : @xmath129 \\\\ & = \\mathcal{h}[\\pi a^g \\left ( 1 + \\re e \\sigma \\re e g - \\pi^2 a^\\sigma a^g \\right ) ] + \\mathcal{h}[\\pi \\re e(g ) \\left ( \\re e \\sigma .",
    "a^g + a^\\sigma   \\re e g    \\right ) ] \\\\ & = \\mathcal{h}[\\pi a^g ] \\left ( 1 + \\re e \\sigma \\re e g - \\pi^2 a^\\sigma a^g \\right ) + \\mathcal{h}[\\pi \\re e(g ) ] \\left ( \\re e \\sigma .",
    "a^g + a^\\sigma   \\re e g    \\right ) ] \\\\ & = \\re",
    "e(g ) \\left ( 1 + \\re e \\sigma \\re e g - \\pi^2 a^\\sigma a^g \\right ) -",
    "\\pi^2 a^g \\left ( \\re e \\sigma .",
    "a^g + a^\\sigma   \\re e g    \\right ) ] \\ , \\end{split}\\ ] ] since @xmath130 $ ] , and @xmath131 = \\pi^2 \\mathcal{h}[\\mathcal{h}[a^g]\\ ] $ ] .",
    "hence eq .",
    "( [ eq : regtsetgt ] ) becomes @xmath132   + 4 f^{\\rm eq } ( f^{\\rm eq } - 1 ) \\pi   a^g \\pi \\left ( \\re e \\sigma .",
    "a^g + a^\\sigma   \\re e g    \\right ) \\ , \\end{split}\\ ] ] when considering that , by definition at equilibrium , we have : @xmath133 and @xmath134 , we can see that , as expect , the last term in eq .",
    "( [ eq : re_gt ] ) is just equal to @xmath135 .",
    "hence we recover once more the modified dyson equation for the time - ordered gf : @xmath136 in a indirect way from the spectral functions .",
    "we now briefly comment on the imaginary - time temperature green s functions .",
    "the definition of the temperature gf is , in form , similar to a time - ordered green s function : @xmath137 , \\ ] ] where one uses imaginary times @xmath138 instead of real time @xmath139 , and the @xmath140 orders the operators according to their value of @xmath141 , with the smallest at the right @xcite .",
    "the temperature green s function @xmath142 follows a conventional dyson - like equation : @xmath143 where the time integrations run over @xmath144 from 0 to @xmath145 ( and @xmath146 is the temperature green s function for the non - interacting system ) .    at equilibrium ,",
    "the quantities depend only on the `` time '' difference @xmath147 and @xmath148 is periodic over the range @xmath149 ( or periodic ( antiperiodic ) over the range @xmath150 $ ] for boson ( fermion ) ) .",
    "therefore @xmath151 can be expanded in a fourier series with coefficients @xmath152 given in terms of the matsubara frequencies @xmath153 being integer even ( odd ) numbers of @xmath154 for boson ( fermion ) .",
    "each fourier component obeys also a dyson equation : @xmath155 ( in compact notation ) .",
    "there is a well defined mathematical connection between the temperature gf @xmath156 and the real - time gf , this is obtained from the analytical continuation from the complex frequency @xmath157 on the real frequency @xmath158 ( and changing , when needed , the sum over the matsubara frequencies onto integrals @xmath159 ) .",
    "however , even if @xmath151 is an imaginary - time - ordered gf , it does not transform into the real - time - ordered gf .",
    "the analytical continuation @xmath160 transforms the temperature gf into the retarded real - time gf ( in energy representation)@xcite : @xmath161 .",
    "similarly we have @xmath162 for @xmath163 .",
    "this is also consistent with the fact the @xmath35 obeys a dyson equation , as much as @xmath151 does too .    in order to get the time - ordered gf @xmath111 for the temperature gf @xmath156 , one has to adopt the following procedure @xcite : from @xmath156 and the analytical continuation ,",
    "one obtains @xmath164 and @xmath165 from which one extracts the spectral function @xmath100 which is then used to built the time - ordered gf @xmath111 from the spectral representation eq .",
    "( [ eq : gt_t_w ] ) . following this procedure ,",
    "we have shown above that one can obtain the modified dyson equation for @xmath111 .",
    "as another example , we provide in [ app : hubbardmodel ] similar calculations for a specific system , i.e. a finite size system at finite temperature , described by the hubbard hamiltonian .",
    "we have derived the dynamical equation for the time - ordered gf @xmath166 in the most general case of non - equilibrium and finite temperature . in the equilibrium case",
    ", we have shown that the corresponding time - ordered gf @xmath111 obeys a dyson equation only in the limit of zero temperature . at finite temperature ,",
    "the dyson equation for @xmath111 needs to be modified by a correction term .",
    "we have shown that the correction term correspond exactly to the corrections introduced _",
    "ad hoc _ by hedin and lundqvist in their treatment of the real - time gf at finite temperature .",
    "we have also shown that these corrections can be obtained from the matsubara temperature gf following the appropriate protocol for the analytical continuation from the imaginary frequency onto the real frequency and the spectral representation of the time - ordered gf .",
    "table [ table : recap ] summarizes the different gfs formalism and the corresponding dynamical equations for the different gfs .",
    "our work leads to two important conclusions .",
    "first , the keldysh time - loop contour formalism to the gfs , though developed to deal with non - equilibrium conditions , is also extremely appropriate to the study of the equilibrium properties of the system .",
    "it leads , in a more natural and straightforward way , to the correct dynamical equations of the gfs .",
    "second , any formalisms based on the resolution of the dyson equation for the time - ordered gf , as those used for example in electronic structure and excitations calculations , are valid only at equilibrium and in the zero temperature limit .",
    "these formalisms include gf calculations ranging from the @xmath167 approximation @xcite to more recent work on self - consistent gf equations involving four - point propagators @xcite .",
    "beyond the zero temperature , correction terms in the dyson equation for @xmath111 must be taken into account , or one needs to work with the matsubara formalism for @xmath168 .",
    "such temperature effects were also found for the @xmath169-matrix approximation in a real - time formalism in ref .",
    "@xcite .",
    "c|p|p|p & non - equilibrium all @xmath169 & @xmath170 at equilibrium & @xmath171 at equilibrium +   + @xmath172 & dyson eqn on @xmath173 @xmath174 & & + @xmath175 in @xmath176 or @xmath177 & dyson eqn : @xmath178 & dyson eqn : @xmath178 & dyson eqn : @xmath179 @xmath180 + @xmath39 in @xmath176 or @xmath177 & qke : @xmath181 @xmath182 & qke : @xmath183 @xmath184 & qke : @xmath185 @xmath186 + @xmath56 in @xmath176 or @xmath177 & modified dyson eqn : @xmath187 + boundary condition & modified dyson eqn : @xmath187 @xmath188 & dyson eqn : @xmath189 + @xmath151 in @xmath190 or @xmath191 & & dyson eqn : @xmath192 & +    we thank martin stankovksi for pointing us to the early work of hedin and lundqvist on real - time gf at finite - temperature ; falk tandetzky , sangeeta sharma and pina romaniello for careful reading of the paper and valuable comments ; arno schindlmayr for useful comments on the matsubara formalism ; and rex godby for discussions .",
    "for the following products @xmath193 on the time - loop contour @xmath0 , @xmath194 we have the following rules for the different components @xmath195 on the real - time axis : @xmath196 @xmath197",
    "the relations between the different components of the green s functions and self - energies on the keldysh time - loop contour are given as usual , with @xmath198 or @xmath199 .",
    "@xmath200    the usual lesser and greater projections are defined respectively as @xmath201 and @xmath202 , and the usual time - ordered ( anti - time - ordered ) as @xmath203 ( @xmath204 ) .",
    "in this section , we consider in finite system , with interaction , for which analytical expressions are derivable for the different gfs and we check the validity of eq .",
    "( [ eq : app_gt_w ] ) for such a system at equilibrium .",
    "we work with the single - site hubbard hamiltonian given by : @xmath205 where @xmath206 is the occupation number operator of the spin @xmath207 . in the absence of magnetic field ,",
    "the system is spin degenerate when @xmath208 .",
    "we consider this case in the following .",
    "the system has 4 different states upon the level occupation @xmath209 and @xmath210 , @xmath211 and @xmath212 , @xmath213 and @xmath212 with respective energy @xmath214 .",
    "one can calculate the advanced and retarded gfs at equilibrium ( and finite temperature , for the finite size system `` connected '' to a thermal bath at temperature @xmath169 ) following the usual prescription @xcite .",
    "within the lehmann representation , we find    @xmath215    with the partition function @xmath216 , @xmath72 and @xmath217 .",
    "we define the thermal occupancy @xmath218 as follows @xmath219    in the non - interacting case ( @xmath220 ) , one recovers the usual gf expressions for a single electronic level , @xmath221 and @xmath222 the fermi distribution ( with the chemical potential @xmath223 taken as the reference of energy for all the expression given in this appendix ) .",
    "( [ eq : grahubbard ] ) can be rewritten as @xmath224 with the usual relationships between the imaginary and real of @xmath225 based on the properties of the hilbert transform @xmath226=\\mathcal{pv } \\frac{1}{(\\omega - e)}$ ] ( with @xmath227 standing for the cauchy principal value ) .",
    "we now define the self - energy @xmath228 corresponding to @xmath225 as follows : @xmath229 one can separate the real and imaginary parts of both sides of the equality , using @xmath230 : @xmath231 \\\\ = \\frac{\\omega-\\varepsilon_0 -\\re e \\sigma \\mp { \\rm i}\\im m \\sigma } { ( \\omega-\\varepsilon_0 -\\re e \\sigma)^2+(\\im m \\sigma)^2 } \\ . \\end{split } \\label{eq : reim_se}\\ ] ]    in the lhs of eq .",
    "( [ eq : reim_se ] ) , the real and imaginary parts are related to each other via an hilbert transform as explained above .",
    "hence this must held as well for the rhs of eq .",
    "( [ eq : reim_se ] ) . indeed , from eq .",
    "( [ eq : reim_se ] ) , we have @xmath232 \\times \\mathcal{n}(\\omega ) \\ , \\end{split } \\label{eq : re_se}\\ ] ] and @xmath233   \\times \\mathcal{n}(\\omega )",
    "\\ , \\end{split } \\label{eq : im_se}\\ ] ] with @xmath234 . combining eqs.([eq : re_se ] ) and",
    "( [ eq : im_se ] ) , we find that @xmath235 ^ 2 + \\left [ ( 1-f)\\delta(\\omega-\\varepsilon_0 ) + f \\delta(\\omega-\\varepsilon_0-u ) \\right]^2 \\right ) \\mathcal{n}^2 \\ , \\end{split } \\label{eq : numerator_se}\\ ] ] hence another definition for @xmath236 .    by using three properties of the hilbert",
    "transform @xcite , @xmath237\\ ] = -g(u)$ ] , and the bedrosian identity for the hilbert transform of product functions @xmath238=g(u ) \\mathcal{h}[h(u ) ] = h(u ) \\mathcal{h}[g(u)]$ ] , one can show that from eqs.([eq : re_se ] ) and ( [ eq : im_se ] ) , we have : @xmath239 & =   - \\mathcal{h}[\\re e   \\sigma ] =   \\left((1-f ) \\mathcal{h}[\\mathcal{pv}\\frac{1}{\\omega-\\varepsilon_0 } ] + f\\mathcal{h } [ \\mathcal{pv}\\frac{1}{\\omega-\\varepsilon_0-u}]\\right ) \\mathcal{n } \\\\ & = - \\im m \\sigma \\ , \\end{split } \\label{eq : ht_imre_se}\\ ] ] hence @xmath240 $ ] as expected , see for example eq .",
    "( [ eq : regt_t_w ] ) .",
    "the first equality comes from the fact that @xmath241=0 $ ] when @xmath242 .",
    "now that we have established the usual relationships between the imaginary and real parts of both the advanced and retarded gfs and self - energies ( @xmath105 ) for our finite size model , i.e. @xmath243 and @xmath244 ( with @xmath245 ) , and @xmath246 $ ] , we can go further along and define as usual the lesser and greater components ( at equilibrium ) : @xmath247 , and @xmath248 , as well as the time - ordered components : @xmath249 and @xmath250 .",
    "we recall that for our finite size system at equilibrium , the distribution @xmath218 is given by eq .",
    "( [ eq : distrib_f ] ) .",
    "we can now check the validity of eq .",
    "( [ eq : app_gt_w ] ) for our model system . for",
    "that we follow the prescriptions given in section [ sec : matsubaragf ] .",
    "we first evaluate the imaginary part of @xmath251 :    @xmath252 = \\\\ & \\im m g^t   \\left ( 1 + \\re e \\sigma^t \\re e g^t - \\im m \\sigma^t \\im m g^t - \\sigma^ < g^ >",
    "\\right ) + \\re e g^t   \\left(\\im m \\sigma^t \\re e g^t + \\re e \\sigma^t \\im m g^t \\right ) \\ ,",
    "\\end{split } \\label{eq : im_gt_1}\\ ] ]    since @xmath63 is real . using the different definitions , we find @xmath252 = \\\\ & \\im m g^t   \\left ( 1 + \\re e \\sigma \\re e g - \\pi^2 ( 2f-1)^2 a^\\sigma a^g - ( 2\\pi)^2 f(1-f ) a^\\sigma a^g \\right ) \\\\ & + \\re e g^t   \\left(\\pi ( 2f-1 ) a^\\sigma \\re e g + \\re e \\sigma \\pi ( 2f-1 ) a^g \\right ) \\ .",
    "\\label{eq : im_gt_2}\\ ] ] using the definition @xmath253 , we end up with @xmath252 = \\\\ & \\pi ( 2f-1 ) \\left [   a^g \\left ( 1 + \\re e \\sigma \\re e g - \\pi^2 a^\\sigma a^g \\right ) + \\re e g   \\left ( a^\\sigma \\re e g + \\re e \\sigma a^g \\right )   \\right ] , \\end{split } \\label{eq : im_gt_3}\\ ] ] where the term in brakets is just the definition of the spectral function @xmath106 given by eq .",
    "( [ eq : a_w ] ) .",
    "hence we find that @xmath252 = \\pi ( 2f-1 ) a^g = \\im m g^t \\ , \\end{split } \\label{eq : im_gt_4}\\ ] ] as expected .",
    "one can proceed along the same lines to establish the relation for the real parts , using the different properties of the hilbert transform mentioned above .",
    "therefore , as expected , eq .  ( [ eq : app_gt_w ] ) is valid for the finite size system , at equilibrium , described by hamiltonian eq .",
    "( [ eq : hhubbard ] ) .",
    "10 url # 1#1urlprefix[2][]#2 pines d 1961 _ the many - body problem _",
    "( new york : w.a ."
  ],
  "abstract_text": [
    "<S> we study the dynamical equation of the time - ordered green s function at finite temperature . </S>",
    "<S> we show that the time - ordered green s function obeys a conventional dyson equation only at equilibrium and in the limit of zero - temperature . in all other cases , i.e. finite - temperature at equilibrium or non - equilibrium , </S>",
    "<S> the time - ordered green s function obeys instead a modified dyson equation . </S>",
    "<S> the derivation of this result is obtained from the general formalism of the non - equilibrium green s functions on the keldysh time - loop contour . at equilibrium , </S>",
    "<S> our result is fully consistent with the matsubara temperature green s function formalism and also justifies rigorously the correction terms introduced in an _ ad hoc _ way with hedin and lundqvist . </S>",
    "<S> our results show that one should use the appropriate dynamical equation for the time - ordered green s function when working beyond the equilibrium zero - temperature limit . </S>"
  ]
}