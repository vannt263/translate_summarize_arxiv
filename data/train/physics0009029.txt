{
  "article_text": [
    "in the numerical study of wave phenomena it is often necessary to use a reference frame that is moving with respect to the medium in which the waves propagate . this could be the case , for example , when studying the waves generated by a moving source , where it may prove convenient to use a reference frame attached to this source . in some cases , one may even need to use a frame that moves faster than the waves themselves , as in the case of a supersonic flow . in general relativity , especially in black - hole problems , one may have to use a grid that shifts rapidly , even faster than light .",
    "all these problems arise in more than one spatial dimension , where computational efficiency may make stringent demands on the algorithm .",
    "it is a common experience to find that standard algorithms seem to go unstable in realistic problems . in this paper , by studying the simple wave equation , we show that the consistent application of two fundamental physical principles  causality and time - reversal - invariance  produces remarkably stable , efficient and accurate integration methods .",
    "these principles can easily be applied to more complex physical systems , where we would expect similar benefits .",
    "our principal motivation for studying these techniques is the development of suitable algorithms for the numerical simulation of moving , interacting black holes .",
    "relativists have long acknowledged the importance of using shifting grids in some problems , but to our knowledge there has been no systematic study of the effects of such shifts on the stability of numerical algorithms . in the next two paragraphs",
    "we develop this motivation .",
    "readers not concerned with numerical relativity may skip these without loss of continuity .",
    "let us consider the requirements that black - hole problems will make of our algorithms . within the context of the @xmath0 formalism of general relativity ( @xcite , @xcite )",
    ", it would seem to be desirable to develop methods on a quasi - rectangular 3-dimensional grid , so that no special coordinate features would prevent one from studying quite general problems .",
    "if we imagine a picture in which a black hole moves `` through '' such a grid , much the way a star would if it were interacting with another , then some requirements become clear :    1 .",
    "grid points will move from outside to inside the horizon , but the grid as a whole should not be sucked in",
    ". this may require an inner boundary to the grid , say on a marginally trapped surface , and this boundary will have to move at faster than the speed of light .",
    "grid points may cross this boundary and be forgotten , at least temporarily , but others will emerge on the other side of the boundary .",
    "grid points that so emerge will then move from inside to outside the horizon as the hole passes over them ; this will require grids that shift faster than light .",
    "this is inescapable unless one ties the grid to the hole as it moves .",
    "3 .   if two black holes begin in orbit around one another , then it may be desirable to adopt a grid that rotates with respect to infinity , in which the holes move relatively slowly at first .",
    "in such a grid one would expect that one could take long time - steps without losing accuracy , since not much happens initially .",
    "one therefore would like to be free of the courant condition on time - steps , _",
    "i.e. _ one wants to use implicit methods .",
    "4 .   integrating the equations of general relativity on a grid with reasonable resolution",
    "will tax the capacity of the best available computers for some time to come .",
    "full implicit schemes are very time - consuming in more than one spatial dimension , because they require the inversion of huge sparse matrices .",
    "alternating - direction - implicit ( adi ) schemes reduce this burden enormously by turning the integration into a succession of one - dimensional implicit integrations , so an adi scheme that can cope with grid shifts is very desirable .    in this paper we show that it should be possible to develop stable methods that satisfy the last three requirements above : adi schemes that are absolutely stable and computationally efficient even on grids that shift at many times the speed of light . as a bonus ,",
    "our adi methods preserve the second - order accuracy of the full implicit equations .",
    "the first requirement , that of dealing with an inner boundary that moves faster than light , is closely related to these techniques and will be addressed elsewhere .    having these requirements in mind",
    ", we have studied the effects that the use of a moving reference frame has on the finite difference approximation to the simple wave equation , centering our attention particularly in the stability properties .",
    "the wave equation is the simplest system , so the instabilities we find in the standard adi methods should certainly also be present when they are applied to more realistic physical systems .",
    "of course , the wave equation is much simpler than other systems , so it is possible that methods that stabilize its integration will not extend to other systems .",
    "however , the principles that we find here are of such a fundamental physical nature that it seems certain that they should be applied wherever possible",
    ". other kinds of instabilities may of course arise in complex systems , especially those directly due to nonlinearity , but we feel that moving - grid instabilities are likely to be cured by the methods we describe here",
    ".    we shall conclude this introductory section by summarizing the approach and results of the following sections . in the second section",
    "we develop the mathematical framework of shifting grids .",
    "then in section  [ sec : iii ] we study the one - dimensional wave equation .",
    "we find simple implicit finite difference schemes that are locally stable for any speed up to that of the waves , even when the grid is accelerating as well as moving . when formulated on a grid that is moving , and even accelerating , it is not immediately obvious how one defines stability : solutions of the differential equation do not have simple harmonic time - dependence in this frame .",
    "we find that a satisfactory criterion for local stability of these simple schemes is that no solutions of the difference equations should grow faster anywhere on the grid than local solutions of the differential equation .",
    "however , as soon as the reference frame moves faster than the wave speed , these schemes become highly unstable .",
    "we trace the origin of this instability to the fact that the computational molecules no longer represent in an adequate way the causal relationships between the grid points .",
    "we find that by modifying the molecules so that they link a given point on one time - slice with one on the next one that is within the first point s cone of characteristics ( its forward `` light cone '' ) , one can restore stability .",
    "we discuss one algorithm for doing this in appendix  b.    we call this _ causal reconnection . _",
    "it is important to note that this has a minimal impact on the integration scheme : for implicit schemes , the matrix that must be solved for the solution at a given time - step is constructed only from the relations between grid - points at that time - step , while causal reconnection affects only the relations between points on different time - steps .",
    "thus , it can be incorporated into the part of the algorithm that constructs the `` inhomogeneous terms '' that generate the right - hand - side of the implicit matrix equation . for the 1-dimensional wave equation",
    ", the extra work involved in seeking out causally related grid points can be significant , but it becomes a smaller proportion of the overhead in more than one dimension , and for complicated systems of equations , such as one has in general relativity , the overhead will be a negligible fraction of the total work per time - step .",
    "we have tested causal reconnection and found it to be stable even on grids moving at many times the speed of the waves .",
    "it is also insensitive to the acceleration of the grid .",
    "we then move our attention in section  [ sec : iv ] to _ operator - splitting adi methods _",
    "@xcite , which are computationally efficient ways of implementing implicit schemes in more than one dimension .",
    "we find it helpful to derive adi schemes from a more systematic point of view than one usually finds in expositions of this technique .",
    "the goal is to add extra terms to a set of difference equations that _ (",
    "i ) _ do not change its accuracy , but _",
    "( ii ) _ replace the large sparse non - tridiagonal matrix which has to be solved in implicit schemes with a matrix that is a simple product of tridiagonal matrices of the 1-d implicit form for each dimension , which are easy to solve .",
    "the extra terms are related to the `` left - over '' terms that appear as the difference between the true operator and its factored replacement acting on the data values on the final time - step .",
    "these final - time - step terms must be eliminated .",
    "they are in effect _ replaced _ by similar terms from earlier time - steps , which replacement makes no difference when @xmath1 , but which removes them from the matrix inversion and allows them to be included as part of the inhomogeneous terms in the matrix solution .",
    "then the new equations will be a valid approximation to the differential equation but can be solved by a succession of ( rapid ) 1-d tridiagonal matrix solutions .    when subjected to the same stability analysis as we devised for causal reconnection ,",
    "the standard adi methods show instabilities even when the reference frame moves very slowly .",
    "the instability is most marked in lees second method , in which the extra terms added in are of second order and therefore do not degrade the accuracy of the full implicit scheme .",
    "the instability is also present , albeit more weakly , in lees first scheme , which is only first - order accurate .",
    "we trace these instabilities to the fact that the extra terms added in either of the standard methods break the time - reversal invariance exhibited by the original differential equation and by the full implicit difference equations . _",
    "demanding that the extra terms be time - symmetric uniquely determines an adi scheme _ that is essentially a hybrid of lees first and second methods .",
    "this time - symmetric adi method turns out to be fully stable for all grid shifts up to the wave speed .",
    "although not built in as a requirement , the new method also turns out to be second - order accurate .",
    "the method can then be extended to grid speeds larger than the wave speed by a direct generalization of the causal reconnection approach developed for the one - dimensional case .",
    "we demonstrate this by performing an integration on a rotating grid whose edge moves faster than the wave speed .    in appendix",
    "a , we derive the wave equation in the accelerating coordinate system using the efficient tensorial techniques of relativity . in appendix b ,",
    "we discuss one method of implementing causal reconnection .",
    "the wave equation is a good testing ground for any new algorithms for hyperbolic systems .",
    "the equations governing many wave systems can be reduced to the standard wave equation , and its cone of characteristics has the causal structure of space - time .",
    "we shall use it to test methods for integrating hyperbolic systems on moving grids .",
    "we consider the wave equation in an arbitrary number of spatial dimensions @xmath2 ,    @xmath3    written in a standard inertial coordinate system denoted by ( @xmath4 ) .",
    "we are interested in finding a finite difference approximation to this equation using a grid of points that moves with an arbitrary non - uniform speed .",
    "moreover , we will assume that the speed of each grid point can change with time . in order to represent this situation",
    ", we need to introduce a second coordinate system @xmath5 that will be comoving with the grid .",
    "we introduce these coordinates in the continuous case by a transformation of the form @xmath6    we have not changed the time coordinate , so we assume that the identification of surfaces of constant time does not change .",
    "this is thus not the usual lorentz transformation of special relativity , so there is no reason for the form of the wave equation to remain invariant .",
    "this will have the implication that , in finite differences , the time interval between @xmath7 slices will be constant , independent of position . for problems in general relativity , this is somewhat of a restriction , but we do not feel it is a serious one . if the causal relations are properly taken into account , then a spatial dependence in the lapse function ought not to change our physical conclusions .    in appendix",
    "a we show that the wave equation takes the following form in the new coordinates @xmath5 :    @xmath8    the following quantities derived from the coordinate transformation appear in the last equation :    @xmath9{0mm}{8 mm } \\ , , \\label{eq:3metric } \\\\",
    "g^{\\,i\\,j } & : = & \\sum_{l=1}^{n } \\ , \\frac{\\partial x^i}{\\partial \\xi^l }   \\ , \\frac{\\partial x^j } { \\partial \\xi^l } \\ , ,   \\label{eq:3metricinv } \\\\",
    "g & : = & \\det \\left(g_{ij}\\right ) \\rule[0mm]{0mm}{6 mm } \\",
    ", , \\label{eq:3metricdet } \\\\ \\gamma^i & : = & -\\frac{1}{\\sqrt{g}}\\left\\{\\frac{\\partial}{\\partial t } \\left(\\sqrt{g}\\beta^i\\right)+\\frac{\\partial}{\\partial x^j}\\left [ \\sqrt{g}\\left(g^{ij}-\\beta^i\\beta^j\\right)\\right]\\right\\ } \\rule[0mm]{0mm}{9 mm } \\ , .",
    "\\label{eq : gamma }   \\end{aligned}\\ ] ]    each of these quantities has a physical interpretation , which we now explain .",
    "readers familiar with these ideas may skip to the next section .    the _ shift vector _",
    "@xmath10 gives the relationship between the two coordinate systems on nearby surfaces of constant time .",
    "let the line of constant @xmath11 have coordinates @xmath12 at the lower hypersurface and @xmath13  at the upper hypersurface . from the definition of the shift vector in equation  [ eq : shift1 ] ,",
    "it is clear that    @xmath14    as we illustrate in figure  [ fig : shift ] , if one starts at any given point at time @xmath15 , then by time @xmath16",
    "the @xmath17 coordinates will have shifted by an amount equal to the shift vector times @xmath18 relative to the @xmath11 ( inertial ) coordinates .",
    "the shift vector @xmath10 will in general be a function of both @xmath12 and t.    ( 400,200 ) ( 70,30)(60,30)2(1,0)200 ( 70,30)(200,0)2(2,1)60 ( 70,140)(60,30)2(1,0)200 ( 70,140)(200,0)2(2,1)60 ( 170,0)(0,1)30 ( 170,45)(0,1)95 ( 170,155)(0,1)60 ( 170,45)(0,1)47.5 ( 170,155)(0,1)30 ( 147.5,0)(1,2)15 ( 170,45)(1,2)47.5 ( 225,155)(1,2)30 ( 170,45)(1,2)24 ( 225,155)(1,2)15 ( 220,155)(-1,0)45 ( 340,43)@xmath15 ( 340,153)@xmath16 ( 145,43)@xmath19 ( 145,153)@xmath20 ( 240,153)@xmath21 ( 187,159)@xmath22 ( 50,210)@xmath23 ( 265,210)@xmath24    we now introduce the _ spatial metric tensor _ @xmath25 , which we have defined in equation  [ eq:3metric ] .",
    "its name comes from the fact that the distance @xmath26 between two points whose coordinates differ by @xmath27 in the original coordinates and by @xmath28 in the shifting coordinates is given by the pythagorean theorem :    @xmath29    that this gives equation  [ eq:3metric ] for @xmath30 is readily seen by substituting the following transformation from @xmath27 to @xmath28 into the first version of the pythagorean theorem : @xmath31 the next tensor that appears in the general form of the wave equation is the _ inverse metric tensor _ given by equation  [ eq:3metricinv ] .",
    "this is the matrix inverse of the metric tensor , @xmath32 as can easily be seen by substituting equations  [ eq:3metric ] and [ eq:3metricinv ] into the above .",
    "the final quantity we need is @xmath33 , a measure of the acceleration of the shifting coordinates with respect to the old ones , given by equation  [ eq : gamma ] .",
    "we will leave the full derivation of @xmath33 to appendix a , but to illustrate our interpretation of it as an acceleration term , we shall explicitly evaluate it in the case where the new coordinates are obtained from the inertial ones by a simple shift independent of position .",
    "then the shift vector @xmath10 is only a function of time , and the spatial metric @xmath25 is just the unit matrix :    @xmath34    it is not difficult to see that in this case the coefficients @xmath33 reduce to : @xmath35 since the shift vector gives the speed of the @xmath17 coordinates , the last expression implies that the @xmath33 coefficients are essentially the acceleration .    notice that if there is no acceleration , the only essential difference from the normal wave equation is the _ transport _ term @xmath36 , which arises as well in hydrodynamical problems .",
    "we will see that the local stability properties of the algorithms we study are determined mainly by @xmath10 , not @xmath33 , which is one reason we expect our analysis to have much wider applicability than just to problems involving the wave equation",
    ".    having derived the form of the wave equation in our new coordinates , we now establish a grid for formulating difference equations in these coordinates . by assumption , we take the time - interval @xmath37 between successive surfaces of constant time to be uniform ( independent of position ) and constant ( the same for any pair of surfaces ) .",
    "we take each grid point to have a fixed spatial coordinate position @xmath38 , and for convenience we take the spacing between grid points @xmath39 to be uniform in each coordinate direction .",
    "as seen in the inertial frame , the grid deforms itself as in figure  [ fig : gridoriginal ] .",
    "the corresponding picture in the @xmath38-coordinate frame looks much more regular ( figure  [ fig : gridnew ] ) .",
    "( 400,140 ) ( 140,20)(1,0)200 ( 125,80)(1,0)245 ( 110,140)(1,0)290 ( 140,20)(-1,4)30 ( 140,20)(-15,60)2(-1,4)7.5 ( 140,20)(-15,60)3 ( 190,20)(0,1)120 ( 190,20)(0,60)2(0,1)30 ( 190,20)(0,60)3 ( 240,20)(1,4)30 ( 240,20)(15,60)2(1,4)7.5 ( 240,20)(15,60)3 ( 290,20)(1,3)40 ( 290,20)(20,60)2(1,3)10 ( 290,20)(20,60)3 ( 340,20)(1,2)60 ( 340,20)(30,60)2(1,2)15 ( 340,20)(30,60)3 ( 20,50)(1,0)60 ( 20,50)(0,1)60 ( 7,110)@xmath15 ( 80,35)@xmath40    ( 400,160 ) ( 140,20)(50,0)5(0,1)120 ( 140,20)(0,60)3(1,0)200 ( 140,20)(50,0)5(0,1)30 ( 140,80)(50,0)5(0,1)30 ( 140,20)(50,0)5 ( 140,800)(50,0)5 ( 140,140)(50,0)5 ( 20,50)(1,0)60 ( 20,50)(0,1)60 ( 7,110)@xmath15 ( 80,35)@xmath38 ( 353,106)@xmath41 ( 307,150)@xmath42",
    "the one - dimensional wave equation allows us to study shifting grids in a relatively simple fashion .",
    "the added complication of extra dimensions will be treated in the next section .    in one spatial dimension ,",
    "the metric , shift , and acceleration coefficients reduce to scalar functions : @xmath43    because the metric scales the _ squares _ of the coordinate distances ( equation  [ eq : pythag ] ) , it is convenient to define the linear _ scale function _ @xmath44 by @xmath45 so that the spatial proper distance is given by @xmath46 using this expression , equation  [ eq : wave2 ] becomes :    @xmath47    for the finite difference approximation to this equation we employ the usual notation : @xmath48 we define the first and second centered spatial differences as : @xmath49 it is important to note that with the last definitions @xmath50 .",
    "we can also define analogous differences for the time direction .",
    "we now write the finite difference approximation to the differential operators that appear in equation  [ eq : wave1d ] using the computational molecule shown in figure  [ fig : compmol ] .",
    "we have : @xmath51 where @xmath52 is the truncation error whose principal part is : @xmath53 similarly , for the mixed derivative in space and time we find : @xmath54 with : @xmath55 \\ , + \\ , \\ldots \\ , .\\ ] ]    ( 400,140 ) ( 180,40)(80,0)3(0,1)100 ( 180,40)(0,50)3(1,0)160 ( 180,40)(80,0)3 ( 180,90)(80,0)3 ( 180,140)(80,0)3 ( 20,60)(1,0)60 ( 20,60)(0,1)60 ( 7,120)@xmath15 ( 80,45)@xmath56 ( 292,150)@xmath42 ( 153,111)@xmath41 ( 169,10)@xmath57 ( 257,10)@xmath58 ( 329,10)@xmath59 ( 360,38)@xmath60 ( 368,88)@xmath61 ( 360,138)@xmath62    for the second derivative in the @xmath56 direction we use an _ implicit _ approximation of the following form : @xmath63 + \\left ( 1 - \\theta_1 \\right ) \\ , \\left [   \\frac{\\delta^2_x \\ , \\phi^j_i}{\\left ( \\delta x \\right)^2 } \\right ] +   e_{xx } \\ , , \\ ] ] where @xmath64 is an arbitrary parameter that gives the weight of the implicit terms .",
    "if the approximation is explicit , while if all the weight is given to the initial and final time - steps of the molecule in the figure .",
    "note that the last equation is symmetric in time .",
    "the error for this @xmath56 derivative is : @xmath65    finally , for the first derivative in @xmath56 we take : @xmath66 \\,+\\ ,   \\left ( 1 - \\theta_2 \\right ) \\ , \\left [ \\frac{\\delta_x \\ , \\phi^j_i}{2 \\ ,   \\delta x } \\right ]   \\,+\\ , e_x \\ , , \\ ] ] where we have used again an implicit approximation with a different parameter @xmath67 .",
    "the truncation error @xmath68 is : @xmath69 \\,+\\ , \\ldots \\ , .\\ ] ]    we can now write down a second order finite difference approximation to equation  [ eq : wave1d ] : @xmath70 + \\left ( 1 - \\theta_1 \\right ) \\",
    ",   \\left [ \\delta^2_x \\ , \\phi^j_i \\right ] \\right\\ } \\ , & & \\nonumber \\\\ { } + \\frac{\\rho \\beta}{2 } \\ , \\left [ \\delta_x \\ , \\phi^{j+1}_i \\,-\\ ,   \\delta_x \\ , \\phi^{j-1}_i \\right ] \\,-\\ , \\left [ \\phi^{j+1}_i - 2 \\phi^j_i   + \\phi^{j-1}_i \\right ] \\,&&\\nonumber \\\\ { } -\\frac{\\rho \\ , \\left ( c \\ , \\delta t \\right)}{2 } \\:\\ :   \\gamma \\ , \\left\\ {   \\frac{\\theta_2}{2 } \\left [ \\delta_x \\ , \\phi^{j+1}_i \\,+\\ , \\delta_x \\ ,   \\phi^{j-1}_i \\right ] \\,+\\ , \\left ( 1 - \\theta_2 \\right ) \\",
    ", \\left [ \\delta_x \\ , \\phi^j_i \\right ] \\right\\ } \\,&=&\\ , 0 \\ , , \\label{eq : finite1d } \\end{aligned}\\ ] ] where @xmath71 is the ` courant parameter ' @xcite given by :    @xmath72    the coefficients \\{@xmath73 , @xmath74 , @xmath75 } appearing in equation  [ eq : finite1d ] should be evaluated at the point @xmath76 that corresponds to the center of the molecule .",
    "to arrive at the final form of the difference equation we multiplied it through by .",
    "this means that the overall truncation error is now    @xmath77 \\,+\\ ,   { \\cal o } \\left [ \\left ( \\delta t \\right)^4 \\right ] \\ , .\\ ] ]    equation  [ eq : finite1d ] is well studied in the particular case when and @xcite .",
    "it is important to note that , because we use centered differences in the transport term , the above finite difference approximation will be implicit whenever the shift vector is different from zero , even when @xmath78 . therefore the use of implicit approximations for the spatial derivatives does not add any extra numerical difficulty",
    ".    we shall need to know how much numerical work is involved in using the implicit scheme .",
    "suppose there are @xmath79 spatial grid points .",
    "then equation  [ eq : finite1d ] is to be solved for the @xmath79 values @xmath80 at the final time - step .",
    "the equation for index @xmath58 relates three such values , at points @xmath81 .",
    "the system of equations therefore has the matrix form    @xmath82    where @xmath83 is a tridiagonal @xmath84 matrix , and the inhomogeneous term @xmath85 is constructed from field values at the first two time - steps . solving a tridiagonal matrix involves operations .",
    "since we also need operations for the solution of an explicit scheme , we see that the use of an implicit method in one dimension will increase the number of operations per time - step by at most a multiplier , independent of the number of grid points . against this , the implicit scheme for certain choices of @xmath64 and @xmath67 can , on a fixed grid , take much larger time - steps , limited only by accuracy considerations . in the next section",
    ", we shall show that this property of the implicit scheme in one dimension can , with suitable modifications , be extended to grids that shift essentially arbitrarily fast .",
    "it is well known @xcite that the implicit approximation to the wave equation can be made unconditionally stable in the case when and by using an implicit parameter .",
    "we are interested in studying under what conditions this property is preserved in the case of a shifting grid .",
    "the shifting grid introduces a major difficulty : the coefficients in the equation generally depend on both position and time .",
    "this complicates the definition of stability .",
    "this difficulty means that an analytic stability analysis must be _ local _ : we will actually only consider the stability of the difference equation obtained from equation  [ eq : finite1d ] by , at each point @xmath86 , taking the coefficients to be constant , with the values corresponding to that point .",
    "we feel that this is not a very restrictive assumption , since in practice instabilities usually appear as local phenomena @xcite , with the fastest growing modes having wavelengths comparable to the grid spacing . moreover , if the coefficients in the difference equation are not practically constant over a few grid points , then we are probably not approximating the original differential equation adequately anyway .",
    "we will start then by considering the nature of the solutions of the _ differential _ equation in a very small region around the point @xmath87 . as usual , we look for a solution of the form : @xmath88 substituting this in equation  [ eq : wave1d ] gives the following `` dispersion relation '' for @xmath89 : @xmath90^{1/2 } \\ , .",
    "\\label{eq : dispersion1d}\\ ] ] the general solution for a wavenumber @xmath91 is @xmath92.\\ ] ]    clearly , if @xmath93 , then one of the independent solutions will grow with time , but the other one will decay because of what we shall call the _ analytic boundedness condition _ : @xmath94 this does not mean that the system is physically unstable , but only that in an accelerating coordinate system the wave equation does not have purely sinusoidal solutions .",
    "one can understand this intuitively in the following way : consider a sinusoidal solution in a static coordinate system . from the point of view of an accelerating observer",
    ", the frequency of this solution will be changing with time ( he will be seeing more and more crests per unit time ) .",
    "this change in frequency will have important local effects .",
    "as a crest approaches our accelerated observer , he will see the wave function rising faster than an observer moving at the same speed , but not accelerating , would .",
    "hence the appearance of locally growing modes in our analysis .",
    "similarly , after a crest is reached , the accelerated observer will see the value of the wave function falling faster than a uniformly moving observer would .",
    "it is not difficult to see that the difference between the growth rate in the first case and the decay rate in the other , as seen by our two observers , will be the same .",
    "this is the origin of the analytic boundedness condition given above .",
    "the presence of the growing modes is crucial for our local stability analysis . since the solutions of",
    "the differential equation can grow with time , we can not ask the solutions of the finite difference approximation not to do so . what we are entitled to ask is for the numerical solutions not to grow faster than the corresponding normal modes of the differential equation .",
    "our stability criterion is , therefore : _ a difference equation is locally stable if every solution for a given wavenumber @xmath91 is bounded in time by a solution of the differential equation for the same @xmath91 .",
    "_    bearing this in mind , we now proceed to an analogous analysis of the solutions of the finite difference scheme .",
    "we look for a local stability condition around the point @xmath95 by making the substitution : @xmath96 substituting the last expression in the finite difference approximation ( equation  [ eq : finite1d ] ) we find a quadratic equation in @xmath97 of the form : @xmath98 with coefficients given by : @xmath99{0mm}{5 mm } \\right ] \\,-\\ , 1 \\right\\ } \\nonumber \\\\   & & { } + \\ , i \\rho \\ :   \\sin \\left ( k \\ , \\delta x \\right ) \\ , \\left [ \\beta   \\,-\\ , \\frac{\\theta_2}{2 } \\left ( c \\ , \\delta t \\right ) \\gamma \\right ] \\ ,   , \\\\   \\nonumber \\\\   b \\,&=&\\ , \\left\\ { 2 \\left ( 1 - \\theta_1 \\right ) \\ , \\rho^2 \\left (   \\frac{1}{s^2 } - \\beta^2 \\right ) \\left [ \\cos \\left ( k \\ , \\delta x   \\right ) \\,-\\ , 1 \\rule[0mm]{0mm}{5 mm } \\right ] \\,+\\ , 2 \\right\\ }   \\nonumber \\\\   & & { } -\\ ,",
    "i \\rho \\left ( 1 - \\theta_2 \\right )   ( c \\ , \\delta t )   \\gamma \\ : \\sin \\left ( k \\ , \\delta x \\right ) \\rule[0mm]{0mm}{6 mm } \\ , , \\\\",
    "\\nonumber \\\\   c \\,&=&\\ , \\left\\ { \\theta_1 \\ , \\rho^2 \\left ( \\frac{1}{s^2 } - \\beta^2   \\right ) \\left [ \\cos \\left ( k \\ , \\delta x \\right ) \\,-\\ , 1 \\rule[0mm]{0mm}{5 mm } \\right ] \\,-\\ ,   1 \\right\\ } \\nonumber \\\\ & & { } -\\ , i\\rho \\ : \\sin \\left ( k \\ , \\delta x \\right ) \\ , \\left [ \\beta   \\,+\\ , \\frac{\\theta_2}{2 } \\left ( c \\ , \\delta t \\right ) \\gamma \\right ] \\ ,   .   \\end{aligned}\\ ] ] the two roots of this equation are : @xmath100 and the general solution of the difference equation is @xmath101.\\ ] ]    it is not difficult to see that the coefficients @xmath102 and @xmath103 have the property : @xmath104 which implies : @xmath105    this contrasts with the differential case , equation  [ eq : bounded ] , where the product of the magnitudes of the two fundamental solutions was 1 . since the ratio @xmath106 depends on the value of @xmath91 in equation  [ eq : aandc ] , there will always exist wavenumbers for which the product @xmath107 exceeds 1 .",
    "this would seem to be undesirable from the point of view of stability , but we can eliminate it as a potential problem by setting from now on @xmath108 this means that we will use an implicit approximation only for the second spatial derivatives , and not for the first spatial derivatives . since from now on we will have only one @xmath109 parameter , we will change notation now and define .",
    "the solutions of the difference equation now satisfy : @xmath110 next we introduce the _ amplification measure _ @xmath111 : @xmath112 and analogously for the solutions of the differential equation .",
    "the amplification measure bounds the growth in the magnitude of any normal mode in one time - step .",
    "our local stability condition is then equivalent to @xmath113 where @xmath114 and @xmath115 are the amplification measures for the finite difference approximation and the differential equation respectively .",
    "when all the parameters are free to take any value , equation  [ eq : stabilityid ] is very complicated , and it is then difficult to find its consequences analytically . we shall therefore study this equation numerically , in order to find regions of the parameter space in which the finite difference scheme is stable .    first let us consider the case of a static grid , @xmath116 .",
    "this case has , of course , been studied analytically @xcite , and it is known that if @xmath117 the generalized courant stability condition is : @xmath118 while if @xmath119 the scheme is absolutely stable . in figure  [ fig : stability : simple ] we show graphs of both the numerical amplification measure ( solid line ) and the one corresponding to the differential equation ( dotted line ) .",
    "we have only plotted the functions for because this turns out to be the worst case .",
    "the first graph shows how for the scheme is stable for values of the courant parameter @xmath120 smaller than one .",
    "however , when this parameter takes values slightly larger than one , the numerical amplification measure begins to grow very fast . in the second case",
    "we see that for the scheme is locally stable for all values of the courant parameter , in agreement with the known stability condition given above .",
    "the next group of graphs ( figure  [ fig : stability : velocity ] ) shows the effect of a uniform shift . in both graphs",
    "we have assumed that there is no acceleration , and we have taken in order to avoid any instability of the type seen in figure  [ fig : stability : simple ] .",
    "the first of these shows that the scheme remains locally stable for all values of the courant parameter , even when the grid shift speed @xmath121 is very close to 1 .",
    "however , in the second graph we see that , as soon as @xmath122 becomes larger than 1 , the scheme turns unstable for _ all _ values of @xmath71 . in this last case",
    "there is no stable choice of time - step .",
    "this is a very important property : _ the finite difference scheme becomes unconditionally unstable whenever the shift is faster than the speed of the waves .",
    "_    finally , in figures [ fig : stability : accel1 ] and [ fig : stability : accel2 ] we consider the effects of an accelerating grid for the particular case when : , , and . in figure",
    "[ fig : stability : accel1 ] we show the behavior of the amplification measure for the finite - difference equation and the differential equation for two different normal modes ( two values of @xmath91 ) . as we expect , the amplification measure corresponding to the differential equation , @xmath123 is no longer @xmath124 . for the first graph we have and for the second @xmath125 . for the smaller wave number ( larger wavelength )",
    "the amplification measures for the differential and finite - difference cases are relatively close to each other . as the wavenumber increases",
    ", the finite - difference amplification measure falls further below that of the differential equation , so that the finite - difference scheme remains stable ( although less accurate ) .",
    "figure  [ fig : stability : accel2 ] shows a surface plot of in the region : @xmath126 we clearly see how in the whole region .",
    "since corresponds to the smallest wavelength that can be represented on the grid , we find that the finite - difference scheme will be stable for all modes .",
    "we have searched through other values of @xmath75 , and we have found that , although the details of the graphs change , the qualitative behavior is preserved . _ the acceleration parameter @xmath75 thus seems to have no important effect on the stability of the scheme . _    in summary , our stability analysis shows that the finite difference scheme given by equation  [ eq : finite1d ] will be locally stable for all values of the courant parameter @xmath71 if the following conditions are satisfied :    @xmath127    the limit on @xmath74 is inconvenient in many problems , where it is desirable to have grids shifting faster than the wave speed .",
    "we turn now to a method for removing this restriction .",
    "the causal structure of a grid shifting faster than the wave speed is particularly clearly illustrated in the original @xmath128 coordinates . in figure",
    "[ fig : reconnection]_a _ we see how , for a very large shift , the individual grid points move faster than the waves , that is , they move outside the light - cone .",
    "since the differential equation propagates data along this cone , it seems plausible that the instability found in the previous section arises in the fact that the difference scheme attempts to determine the solution at points on the final time - step using data that are outside the past light - cone of these points .",
    "this suggests that we should not build the computational molecules from grid points with fixed index labels , but instead use those points that have the closest _ causal _ relationship ( figure  [ fig : reconnection]_b _ ) .",
    "we shall now proceed to show analytically how such a reconnection can stabilize the scheme .    in order to build this causal molecule",
    "let us consider then an individual grid point at the last time level .",
    "we look for that grid point in the previous time level that is closest to it in the causal sense .",
    "having found this point , we repeat the procedure to find the closest causally connected point in the first time level . in appendix b we give a simple algorithm for finding these points in an integration of the wave equation .",
    "the algorithm adapts easily to other linear hyperbolic systems .",
    "we shall return in a later paper to its generalization to nonlinear equations , and in particular to the case of shocks in hydrodynamics .",
    "first we consider the general constraints on the time - step that causal reconnection imposes , and then address the issue of how much extra computational effort causal reconnection may involve .",
    "since we permit the grid to move with an arbitrary non - uniform speed , there is no reason that these causally connected points should be in a straight line in either the original inertial reference frame @xmath129 or in the moving reference frame @xmath130 . in the moving coordinate system @xmath87 the relationship among these three points may generically look something like that shown in figure  [ fig : moving ] .",
    "( 400,160 ) ( 140,20)(0,60)3(1,0)200 ( 170,20 ) ( 250,80 ) ( 290,140 ) ( 170,20)(4,3)80 ( 250,80)(2,3)40 ( 170,9)(0,1)5 ( 250,9)(0,11)7(0,1)5 ( 290,9)(0,11)12(0,1)5 ( 360,17)@xmath131 ( 360,77)@xmath132 ( 360,137)@xmath133 ( 157,0)@xmath134 ( 245,0)@xmath135 ( 277,0)@xmath136 ( 20,50)(1,0)60 ( 20,50)(0,1)60 ( 7,110)@xmath15 ( 80,35)@xmath56    accordingly , we introduce a new local coordinate system @xmath137 adapted to the three given points .",
    "in order to do this , it is convenient to introduce the interpolating second order polynomial that can be obtained from these three points : @xmath138 where @xmath132 is the time at the central point of the molecule , @xmath135 the position of that point , and : @xmath139    we define the new local coordinate system adapted to the causal molecule by : @xmath140    it can easily be seen that this new coordinate system @xmath137 moves with respect to the old one @xmath87 with a speed @xmath141 at time @xmath142 , and with a constant acceleration @xmath102 . since in general the value of the coefficients @xmath102 and @xmath141 will change from molecule to molecule , the above change of variables must be repeated for each molecule .",
    "we assume that this can be done in a smooth manner ; this may not be possible in a nonlinear system , if the characteristics depend on the solution .",
    "in the primed coordinate system , the differential equation has exactly the same form as before ( see equation  [ eq : wave1d ] ) , except for the following substitutions : @xmath143 in the same way , the finite difference approximation will have the same form as before ( equation  [ eq : finite1d ] ) , except for the substitutions : @xmath144 where the term with @xmath145 has disappeared because in this case the coefficients should be evaluated at the center of the molecule where .",
    "since the original finite difference approximation could be made stable as long as equation  [ eq : stability1d : causal ] was satisfied ( and @xmath146 ) , the analogous condition for a finite - difference scheme adapted to the new local coordinates takes the form : @xmath147    we will say that the three given points form a _ proper causal molecule _ when the last condition is satisfied . in order to find when this happens , we will start by defining the _ effective numerical light - cone _ of the point @xmath135 as the region between the lines : @xmath148 this numerical light - cone will coincide with the exact light - cone when : @xmath149    we will also define the axis of the numerical light - cone as the line : @xmath150 we will now show that if @xmath151 and @xmath152 are inside the numerical light - cone of @xmath135 then the three points will form a proper causal molecule . from the definition of the numerical light - cone we see",
    "that if @xmath136 and @xmath152 are inside it then @xmath153 with @xmath154 \\ , .\\ ] ]    the coefficients @xmath102 and @xmath141 will then be given by @xmath155 which in turn means @xmath156 \\ , , \\hspace{20mm}\\left ( \\gamma - \\frac{a}{c^2 } \\right ) \\,\\in\\ , \\left [ -\\frac{2}{s \\ , \\left ( c \\delta t \\right)}\\,,\\,\\frac{2}{s \\ , \\left ( c \\delta t \\right ) } \\ , \\right ] \\ , .\\ ] ]    from this it is easy to see that condition  [ proper_causal_molecule ] is indeed satisfied , that is , the three points do form a proper causal molecule . moreover ,",
    "the absolute value of the acceleration in the new local coordinates will be bounded , and even though this does nt affect the stability of the finite difference scheme , it does improve its accuracy .    in order to be able to form proper causal molecules everywhere , we must guarantee that two logically distinct conditions hold .",
    "if we call the central point at @xmath132 as the `` parent '' and the points at @xmath157 the `` children '' , then every parent must have two children and every child must have a parent :    1 .",
    "_ every parent must have two children .",
    "_ there must always be at least one grid point in the upper and lower time levels inside the numerical light - cone of any given point in the middle time level .",
    "this can be guaranteed if we ask for the distance between grid points to be smaller than the spread of the smallest light - cone , that is , @xmath158 which implies @xmath159 ( without loss of generality , we assume in this section that @xmath160 and hence @xmath71 are positive . ) 2 .   _ every child must have a parent .",
    "_ all the grid points in the upper and lower time levels must be inside the numerical light - cone of at least one point in the middle time level .",
    "this requires that the distance between the axes of the numerical light - cones of two consecutive grid points must be smaller than the spread of the minimum light - cone .",
    "+ let us therefore consider two consecutive grid points @xmath161 and .",
    "the distance between the axis of their light - cones at the next time level is given by : @xmath162{0mm}{5 mm } \\right| \\ , .\\ ] ] using the definition of @xmath163 we find that : @xmath164{0mm}{5 mm } \\right ] \\,+\\ , \\frac{1}{2 }   \\left ( c \\ , \\delta t \\right)^2 \\ , \\left [ \\gamma \\left ( x_2 \\right ) \\,-\\ ,   \\gamma \\left ( x_1 \\right )   \\rule[0mm]{0mm}{5 mm } \\right ] \\ , \\right| \\ , .\\ ] ] + in the same way we find that the distance between the axis of the light - cones at the previous time level is : @xmath165{0mm}{5 mm } \\right ] \\,+\\ , \\frac{1}{2 }   \\left ( c \\ , \\delta t \\right)^2 \\",
    ", \\left [ \\gamma \\left ( x_2 \\right ) \\,-\\ ,   \\gamma \\left ( x_1 \\right ) \\rule[0mm]{0mm}{5 mm } \\right ] \\ , \\right| \\ , .\\ ] ] + the maximum of these two is : @xmath166{0mm}{5 mm } \\right| \\,+\\ , \\frac{1}{2 } \\left ( c \\ , \\delta t \\right)^2 \\ , \\left [ \\gamma \\left ( x_2 \\right ) \\,-\\ ,   \\gamma \\left ( x_1 \\right ) \\rule[0mm]{0mm}{5 mm } \\right ] \\ , \\right| \\ , .\\ ] ] + let us assume now that both @xmath74 and @xmath75 are continuous functions",
    ". then we can expand them in a taylor series around the point : @xmath167 + we then find that , to second order in @xmath168 : @xmath169 \\ , \\right| \\ , , \\ ] ] where the derivatives are evaluated at the point @xmath170 .",
    "+ the condition that the maximum value of this distance should be smaller than the spread of the minimum light - cone is now : @xmath171 using now the expression for @xmath172 , we can rewrite this as : @xmath173 \\ , \\right| \\ , .",
    "\\label{reconnection2_1d}\\ ] ] this is the `` no orphans '' condition , that every child point should have a parent . since we want this to be true for all grid points , it must hold for all @xmath56 .",
    "we call equations  [ reconnection1_1d ] and [ reconnection2_1d ] the _ causal reconnection conditions : _ when they are satisfied , one is guaranteed that causal molecules can be formed everywhere .",
    "it is clear that if the derivatives of @xmath74 and @xmath75 are too large , it will be impossible to satisfy the second of the causal reconnection conditions , equation  [ reconnection2_1d ] ( no orphans ) .",
    "this can be avoided if we require that @xmath74 and @xmath75 change very little from one grid point to another : @xmath174    as we mentioned before , if this is not the case our finite difference approximation is unlikely to be good anyway , and a more refined grid spacing should be used .",
    "another interesting feature of condition  [ reconnection2_1d ] is the fact that , whenever @xmath75 is not uniform , there will always be a value of @xmath71 large enough for the condition to be violated .",
    "these sets an _ upper bound _ on the time - step , which can be understood if we examine the effects of a non - uniform acceleration on two adjacent numerical light - cones . if the acceleration increases with @xmath56 , the numerical light - cones will eventually converge and pass through each other at a large enough time , even if they were diverging initially .",
    "similarly , if the acceleration decreases with @xmath56 , the numerical light - cones will eventually diverge , even if they intersect each other for a while .",
    "clearly these situations do not arise in the exact ( differential ) case because they would break the causal structure of the solutions .",
    "we must therefore conclude that the numerical light - cones will not approximate the real light - cones properly when we have a time - step large enough for these effects to occur .",
    "however , if @xmath75 is such that [ bound ] holds , then the upper limit on @xmath160 will be very large indeed , much larger than the courant limit , and so large that the accuracy of the integration must be breaking down anyway .",
    "moreover , for any given time - step condition  [ reconnection2_1d ] can always be satisfied for a small enough grid spacing @xmath168 .",
    "notice that causal reconnection does not change the fundamental structure of the difference equation , since it does not affect the relations between points at the final time - step .",
    "therefore , even with causal reconnection , the equation will have the form @xmath175 where @xmath176 is a different function , which reflects the fact that causal reconnection identifies different points at time - steps @xmath61 and @xmath60 to use to generate the points at the final time - step .",
    "therefore , any algorithms that are used without causal reconnection for the solution of this tridiagonal system of equations can be used equally well with causal reconnection .",
    "there will , of course , be an overhead associated with the search for causally related grid points . in a one - dimensional problem with @xmath79 grid points , this will require only @xmath177 operations , since once the causal molecule of one grid point has been constructed , the causal molecule of its neighbor will , by continuity , usually differ by at most one spatial shift at any time level . in more than one dimension , the search should still scale linearly with the number of grid points , since again by continuity the causal molecule of any point can usually be guessed from that of any of its neighbors .",
    "we have found that for the one - dimensional wave equation , the implementation of causal reconnection given in appendix  b can multiply the computation time by something like a factor of two .",
    "but for a more realistic problem , such as general relativity , where there are many dependent variables per grid point , the overhead of searching for the causal structure will be no different than for the simple wave equation , so it will represent a small percentage of the overall computing time .",
    "as an example of the methods that we have developed in the last sections , we will consider a grid that is oscillating in the original coordinates @xmath128 .",
    "the scale and shift functions are given by : @xmath178 from which we deduce @xmath179    this grid turns out to give a very good illustration of all the properties we have mentioned so far . in the calculations we have taken .    in figure",
    "[ fig : example : noncausal ] we show two calculations using the finite difference approximation given by equation  [ eq : finite1d ] . in these examples we have not taken into consideration the causal structure .",
    "the figures show the evolution of a gaussian wave packet that was originally at rest at the center of the grid . in both cases",
    "we have taken @xmath180 , and we show the situation after 35 time - steps ( 3.5 periods of oscillation of the grid ) .    in the first graph @xmath181 : the maximum shift equals the speed of the waves , but for all the rest of the time the shift is less than 1 . at the end of the calculation",
    "there is no evidence of any instabilities .",
    "in fact , we have integrated this for a very large number of time - steps with the same result : no instabilities appear .",
    "for the second graph we have taken@xmath182 : the maximum shift is now slightly larger than the speed of the waves , although even here the grid spends most of its time at speeds less than 1 . by the end of the calculation",
    "an instability has started to form .",
    "it exhibits the characteristic feature of finite - difference instabilities , that the shortest wavelengths are the most unstable .    in figure",
    "[ fig : example : causal ] we compare the direct , non - causal , approach and the causal approach for a larger shift amplitude .",
    "we use the same initial gaussian wave packet as before and take @xmath183 , @xmath180 . here",
    "the instability appears very fast in the direct approach ( after only 25 time - steps ) . with causal reconnection ,",
    "however , the calculation remains stable .",
    "we have carried out the same calculation for many more time - steps , and also for larger values of @xmath102 ( up to ) , and the results are the same : no instabilities develop in the causal approach .",
    "therefore causal reconnection of the computational molecules seems to cure all the local instabilities on grids that move faster than the waves .",
    "we will see that in more than one dimension it will also guarantee local stability for rapid shifts , but only after we cure a further instability that arises in operator - splitting methods for small velocities .",
    "we shall begin our discussion of stable integration schemes in more than one dimension by introducing adi schemes in a way that makes our time - symmetric adi method emerge naturally , and which makes it clear how to generalize it to other hyperbolic systems in a straightforward manner .",
    "adi is basically a device for implementing an implicit integration scheme in many dimensions without the enormous computational overheads that the direct implicit scheme would involve .",
    "we begin our discussion , therefore , with an examination of the direct implicit scheme and its computational demands .",
    "we shall concentrate on two dimensions , but the generalization to more is straightforward .",
    "the general wave equation ( equation  [ eq : wave2 ] ) in two dimensions is @xmath184 \\ , \\frac{\\partial^2 \\phi}{\\partial x^2 } + 2 \\left ( g^{x\\,y } - \\beta^x \\beta^y \\right ) \\ , \\frac{\\partial^2 \\phi}{\\partial x \\ , \\partial y } + \\left [ g^{y\\,y } - \\left ( \\beta^y \\right)^2 \\right ] \\ , \\frac{\\partial^2 \\phi}{\\partial y^2 } & & \\nonumber \\\\   { } + \\frac{2 \\beta^x}{c } \\ , \\frac{\\partial^2 \\phi}{\\partial x \\ , \\partial t } + \\frac{2 \\beta^y}{c } \\ , \\frac{\\partial^2 \\phi}{\\partial y \\ , \\partial t } - \\gamma^x \\ , \\frac{\\partial \\phi}{\\partial x } - \\gamma^y \\ , \\frac{\\partial \\phi}{\\partial y } - \\frac{1}{c^2 } \\ , \\frac{\\partial^2 \\phi}{\\partial t^2 } & = & 0 \\ , .",
    "\\label{eq : wave2d }   \\end{aligned}\\ ] ]    in the finite difference approximations to this equation , we will use the notation @xmath185 that is , we will suppress the spatial indices and write them only when the possibility of confusion arises .",
    "the finite difference approximations to all the differential operators that appear in equation  [ eq : wave2d ] have the same form as in the one dimensional case , except for a new term that did not exist before : @xmath186 where the spatial differences are defined in the same way as before , and the truncation error is : @xmath187 \\ , + \\",
    ", \\ldots\\ , .\\ ] ]    as we learned to do in the one - dimensional case , we will use only explicit approximations for the first spatial derivatives .",
    "we can then write our second - order implicit finite difference approximation to equation  [ eq : wave2d ] in the form : @xmath188 \\left [ \\frac{\\theta}{2 } \\",
    ", \\left ( \\delta^2_x \\ , \\phi^{j+1 } + \\delta^2_x \\ , \\phi^{j-1 } \\right ) + \\left ( 1 - \\theta \\right ) \\ , \\left ( \\delta^2_x \\ , \\phi^j \\right ) \\right ] \\ , & & \\nonumber \\\\   { } + \\rho^2 \\left [ g^{y\\,y } - \\left ( \\beta^y \\right)^2 \\right ] \\left [ \\frac{\\theta}{2 } \\ , \\left ( \\delta^2_y \\ , \\phi^{j+1 } + \\delta^2_y \\ , \\phi^{j-1 } \\right ) + \\left ( 1 - \\theta \\right ) \\ , \\left ( \\delta^2_y \\ , \\phi^j \\right ) \\right ]   \\ , & & \\nonumber \\\\ { } + \\frac{\\rho^2}{2 } \\left ( g^{x\\,y } - \\beta^x \\beta^y \\right ) \\left ( \\delta_x \\delta_y \\ , \\phi^j \\right ) \\,+\\ , \\frac{\\rho \\beta^x}{2 } \\ , \\left ( \\delta_x \\ , \\phi^{j+1 } - \\delta_x \\ , \\phi^{j-1 } \\right ) \\ , & & \\nonumber \\\\    { } + \\frac{\\rho \\beta^y}{2 } \\ , \\left ( \\delta_y \\ , \\phi^{j+1 } - \\delta_y \\ , \\phi^{j-1 } \\right ) \\,-   \\frac{\\rho \\ , \\left ( c \\ , \\delta t \\right)}{2 } \\ : \\gamma^x \\ , \\left ( \\delta_x \\ , \\phi^j \\right ) & & \\nonumber \\\\   { } -\\ , \\frac{\\rho \\ , \\left ( c \\ , \\delta t \\right)}{2 } \\ : \\gamma^y \\ , \\left ( \\delta_y \\ , \\phi^j \\right ) \\,-\\ , \\left ( \\phi^{j+1 } - 2 \\phi^j + \\phi^{j-1 } \\right ) & = & 0 \\ , .",
    "\\label{eq : finite2d } \\end{aligned}\\ ] ]    in this equation we have assumed for convenience that the spatial increment is the same in both directions , and we have defined the courant parameter in the same way as before . as in the one dimensional case , to arrive at the last expression we have multiplied through by .",
    "the truncation error is therefore of order : @xmath189 \\,+\\ , { \\cal o } \\left [ \\left ( \\delta t \\right)^4 \\right ] \\ , .",
    "\\label{eq : finite2derr}\\ ] ]    equation  [ eq : finite2d ] is the most direct finite difference approximation to the original differential equation in @xmath190 dimensions .",
    "we call it the `` fully implicit '' scheme . as in the one - dimensional case",
    ", it takes the form of a matrix equation @xmath191 however , as is well - known , the numerical solution of this equation is considerably more time - consuming than in the one dimensional case , and the computational demands increase very rapidly with the number of dimensions .",
    "this is due to the fact that , if we have @xmath79 grid points in each of @xmath2 spatial directions , the matrix @xmath192 will have @xmath193 rows and columns .",
    "most importantly , this matrix will _ not _ be tridiagonal : it may be possible to arrange that the nearest neighbors in , say , the @xmath56-direction of any point should occupy adjacent columns , but those in other directions will be far away in another part of the matrix .",
    "the matrix will still be sparse , but the number of operations involved in solving it may be very large indeed , in the worst case involving of order @xmath194 operations at each time - step .",
    "even if a well - designed relaxation method is used , the number of operations will in general increase faster than @xmath195 .",
    "adi schemes offer a systematic way around this problem , usually affording considerable savings in computational effort with , as we will show , no sacrifice in accuracy .",
    "however , while the fully implicit scheme may be expected to be as stable against grid shifts in @xmath2 dimensions as in one , this is not true of adi schemes , and we shall have to be careful to design a stable one .",
    "alternating direction implicit ( adi ) methods @xcite reduce the numerical work involved in an @xmath2-dimensional problem by modifying the finite - difference scheme in such a way as to replace the original large sparse matrix @xmath192 by one that can be factored into a product of tridiagonal matrices related to @xmath83 for each spatial direction .",
    "if we assume that we have the same number @xmath79 of grid points in all directions , we will have to invert a series of @xmath196 tridiagonal matrices of size @xmath197 for each spatial dimension .",
    "this means that we will need only operations to solve the system .",
    "we see then that the number of operations for the adi scheme will scale with the number of grid points in the same way as it does for an explicit method .",
    "the reason that one can contemplate replacing the original operator @xmath192 with a different one is that the fully implicit finite - difference equation is only an approximation to the differential equation , so if we modify it by adding extra high - order terms that are of the same order as those neglected in the original approximation , the accuracy of the scheme will not be affected .",
    "if we can then choose these extra terms to change the operator acting on the function at the last time level @xmath198 into a factorizable one , we will have speeded up the solution by a huge amount .",
    "for our two - dimensional wave equation , the operator acting on @xmath198 is ( see equation  [ eq : finite2d ] ) : @xmath199 \\ ,   \\delta^2_x +   \\left [ g^{y\\,y } - \\left ( \\beta^y \\right)^2 \\right ] \\ , \\delta^2_y \\",
    ", \\right\\ } \\ , .",
    "\\label{operator}\\end{aligned}\\ ] ] we want to add high - order terms to this expression to transform it into a product of one - dimensional operators of the form of the similar term we had in the one - dimensional case ( equation  [ eq : finite1d ] with ): @xmath200 \\ , \\delta^2_x \\ , \\right\\ } \\nonumber \\\\   & & \\quad{}\\times \\left\\ { \\ , 1 \\,-\\ , \\frac{\\rho \\",
    ", \\beta^y}{2 } \\ , \\delta_y \\,-\\ , \\rho^2 \\ ,   \\frac{\\theta}{2 } \\ ,",
    "\\left [ g^{y\\,y } - \\left ( \\beta^y \\right)^2 \\right ] \\ , \\delta^2_y \\ ,",
    "\\right\\ } \\ , .",
    "\\label{eq : factorizable}\\end{aligned}\\ ] ]    let us define @xmath201 to be the difference between these operators : @xmath202 then we can rearrange the fully implicit equation ( equation  [ eqn : ndmatrix ] ) to read @xmath203 now , this is not directly any help , since although we have the factorizable operator @xmath204 on the left - hand - side , we have unknown terms in @xmath198 on the right .",
    "however , let us consider the following related equation : @xmath205 this equation _ is _ in a form that can be solved easily , since the unknown @xmath198 appears only with the operator @xmath206 .",
    "moreover , since in the limit @xmath207 we have @xmath208 , in that limit equation  [ eqn : related ] approaches equation  [ eqn : rearranged ] , which is the original fully implicit equation .",
    "this fully implicit approximation is itself only a valid approximation to the original differential equation in the same limit , so it follows that equation  [ eqn : related ] also approximates the differential equation in that limit .",
    "( it need not be as good an approximation , of course : the error terms of the original equation  [ eqn : rearranged ] may be smaller than those introduced by the change to equation  [ eqn : related ] .",
    "we will address this point below . )",
    "there is nothing unique about changing @xmath209 to @xmath210 to make the equation factorizable .",
    "one could change @xmath210 to any combination of terms that limits to @xmath209 as @xmath211 .",
    "the different adi methods make different choices of these terms .",
    "we shall see that the standard choices produce equations that are very unstable when the grid shifts , but that by imposing the simple physical requirement of time - reversibility one gets a uniquely defined adi scheme that is stable and just as accurate as the original fully implicit method",
    ".    it will be helpful to write out explicitly what the operator @xmath212 defined in equation  [ eqn : sdef ] is : @xmath213 \\",
    ", \\delta_y^2 \\right\\ } \\,+\\ ,   \\left [ g^{x\\,x } - \\left ( \\beta^x \\right)^2 \\right ] \\ , \\delta_x^2   \\left ( \\beta^y \\delta_y \\right ) \\right ] \\right .",
    "\\nonumber \\\\   & & \\qquad{}+\\,\\left.\\frac{\\rho^4 \\theta^2}{4 } \\ , \\left [ g^{x\\,x } - \\left ( \\beta^x \\right)^2 \\right ] \\ ,",
    "\\delta_x^2   \\left\\ { \\left [ g^{y\\,y } - \\left ( \\beta^y \\right)^2 \\right ] \\ , \\delta_y^2 \\right\\ } \\ , \\right ] \\ , .",
    "\\label{eq : defs}\\end{aligned}\\ ] ]    it is important to note here that the expression for the operator @xmath201 includes terms in which the difference operators in the @xmath56 direction act on the functions @xmath214 and @xmath215 , because these functions in general depend on both @xmath56 and @xmath216 .",
    "had we defined @xmath204 as @xmath217 we would have had a different expression for @xmath201 , because , whenever the coefficients in the finite difference approximation change with position , the operators @xmath83 and @xmath218 do not commute .",
    "we first cast the two original , and still standard , adi methods for the wave equation , lees first and second methods , into the notation we have used above .",
    "they serve to illustrate how our approach to adi methods works on a familiar method , and we will subsequently analyze the stability of these schemes . then we will introduce the scheme that will turn out to be stable for shifting grids , the time - symmetric scheme .    [ [ lees - first - method . ] ] lees first method .",
    "+ + + + + + + + + + + + + + + + + + +    the most straightforward approach is that introduced by lees in 1962 ( @xcite , @xcite ) for the case of the ordinary wave equation on a fixed grid .",
    "it is convenient to describe it in terms of the extra terms that one adds to the left - hand - side of equation  [ eq : finite2d ] to produce a factorizable equation : @xmath219 this effectively produces the equation @xmath220 this is a simple change from equation  [ eqn : related ] .",
    "it is clear that as @xmath1 the extra term ( [ term : leesfirst ] ) will vanish , and we will recover the original differential equation .",
    "however , we will see below that the extra terms do not vanish as fast as the errors in equation  [ eq : finite2d ] , which are given in equation  [ eq : finite2derr ] . lees",
    "first method is only first - order accurate on a shifting grid .",
    "it is known that lees first method is absolutely stable on a static grid .",
    "however , it will turn out to be subject to weak but significant instabilities when used on shifting grids .",
    "[ [ lees - second - method . ] ] lees second method .",
    "+ + + + + + + + + + + + + + + + + + + +    another way to modify the equation is to add instead a second - time - difference term .",
    "this is known as lees second method : @xmath221    here again we recover the original differential equation in the limit @xmath1 .",
    "the result is in fact a linear combination of equations  ( [ eqn : related ] ) and  ( [ eqn : leesfirst ] ) .",
    "we will see below that this method does not sacrifice accuracy : the introduced terms are of the same order as the original truncation error on shifting grids .",
    "moreover , it is absolutely stable on a static grid .",
    "however , our stability analysis will reveal that this method shows strong instabilities when used on shifting grids .",
    "[ [ the - time - symmetric - adi - method . ] ] the time - symmetric adi method .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    a more general approach would be to separate the operator @xmath201 into different pieces and use a first time difference with some of them , and a second time difference with the rest .",
    "we will call this a mixed adi method .",
    "one can try many different mixed methods , but there is one that is natural from the point of view of the original differential equation .",
    "this is the one we call the time - symmetric adi method .",
    "the original differential equation , equation  [ eq : wave2d ] , has , in common with all fundamental physics differential equations , the property of time - reversal invariance . in this case",
    ", the equation is invariant if we make the replacements @xmath222 the fully implicit difference equation , equation  [ eq : finite2d ] , also has this property , since the approximations used for the time - derivatives are centered differences : they do not bias the direction of time . in our case , time - reversal",
    "is implemented by the exchange of the time - step indices @xmath62 and @xmath60 . however , replacing the fully implicit operator @xmath223 with @xmath204 breaks this invariance , because this change modifies the way that @xmath198 enters the equation without automatically modifying the @xmath224 terms in a symmetrical way .",
    "if we look at the definition of the operator @xmath201 in equation  [ eq : defs ] , we see that it is not itself invariant : it contains terms both linear and quadratic in @xmath10 . therefore , since lees first and second schemes both add terms in which @xmath201 operates on an expression with a definite time - symmetry , neither scheme is time - reversal invariant .",
    "what we need to do is to separate @xmath201 into parts @xmath225 and @xmath226 that are even and odd with respect to @xmath10 and then to allow them to act , respectively , on even and odd extra terms .",
    "that is , we add to equation  [ eq : finite2d ] the term @xmath227 where the even and odd parts of the operator @xmath201 are defined by @xmath228 \\ ,   \\delta_x^2 \\left\\ { \\left [ g^{y\\,y } - \\left ( \\beta^y \\right)^2 \\right ] \\delta_y^2 \\right\\ } \\ , , \\\\",
    "\\hat{\\cal s}_o & : = & -   \\frac{\\rho^3 \\theta}{4 } \\ , \\left [ \\beta^x \\ , \\delta_x \\left\\ { \\left [ g^{y\\,y } - \\left ( \\beta^y \\right)^2 \\right ] \\delta_y^2 \\right\\ } \\,+\\ , \\left [ g^{x\\,x } - \\left ( \\beta^x \\right)^2 \\right ] \\ , \\delta_x^2 \\left ( \\beta^y \\delta_y \\right ) \\right ]   \\ , .",
    "\\label{eq : defseo}\\end{aligned}\\ ] ]    this effectively ensures that we apply the same modification to the @xmath224 terms as to the @xmath198 terms in producing a factorizable equation that limits to the fully implicit equation as the time - step goes to zero .",
    "we will see that , by so preserving the time - symmetry of the original equation , we have also produced a method that is just as accurate as the fully implicit method and , perhaps more importantly , is unconditionally locally stable on grids shifting at any speed up to the wave speed .",
    "whichever adi method we choose to use , we will always produce an equation of the form : @xmath229 where @xmath230 and @xmath231 are spatial finite difference operators whose specific form will depend on the method chosen .",
    "looking at the definition of @xmath204 in equation  [ eq : factorizable ] , we see that the last equation can be decomposed into a system of two coupled equations in the following way : @xmath232 \\ , \\delta^2_y \\ , \\right\\ } \\ , \\phi^{j+1 } \\ , & : = & \\left . \\phi^ * \\right.^{j+1 }   , \\\\ \\left\\ { \\ , 1 \\,-\\ , \\frac{\\rho \\ , \\beta^x}{2 } \\ , \\delta_x \\,-\\ , \\rho^2 \\ ,",
    "\\frac{\\theta}{2 } \\ , \\left [ g^{x\\,x } - \\left ( \\beta^x \\right)^2 \\right ] \\ , \\delta^2_x \\ ,",
    "\\right\\ } \\ , \\left . \\phi^",
    "* \\right.^{j+1 } & = & \\hat{\\cal a } \\ , \\phi^j \\,+\\ , \\hat{\\cal b } \\ ,",
    "\\phi^{j-1 } , \\end{aligned}\\ ] ] where the first equation defines the so - called _ intermediate value _",
    "@xmath233 .",
    "these two equations give the simplest adi split of the finite difference approximation . in order to solve the system ,",
    "one first solves the second equation for using values of @xmath234 in the previous time levels .",
    "this operation involves solving a tridiagonal system of equations for each fixed value of the @xmath216-index .",
    "one then solves for @xmath198 using the first equation , again solving only tridiagonal equations . in the general case of an @xmath2 dimensional problem",
    ", this procedure will take us to a system of @xmath235 equations and @xmath236 intermediate values .",
    "each equation employs an operator acting only in one of the spatial directions .",
    "it is important to realize that the splitting of equation  [ adi : unsplit ] given above is by no means unique .",
    "one may find many different splittings of the same equation , and some may prove to be more computationally efficient than the one we have given above",
    ". however , the differences will only be in the algebra ( and in roundoff errors ) : different splittings are only different ways of writing the _ same _ adi scheme .",
    "the different methods of forming @xmath230 and @xmath237 will differ in general in their accuracy and stability . to find the accuracy of the different adi schemes on shifting grids , we start by considering lees first method . in this case",
    "we must add to the left hand side of equation  [ eq : finite2d ] the following term : @xmath238 \\nonumber \\\\   & & { } - \\frac{\\rho^3 \\theta}{4 } \\",
    ", \\left\\ { \\beta^x   \\ , \\delta_x \\left [ \\left ( g^{y\\,y } - \\left ( \\beta^y \\right)^2 \\right ) \\delta_y^2 \\ , \\left ( \\phi^{j+1 } - \\phi^{j-1 } \\right ) \\right ] \\right .",
    "\\nonumber \\\\ & & { } + \\left .",
    "\\left ( g^{x\\,x } - \\left ( \\beta^x \\right)^2 \\right ) \\ , \\delta_x^2 \\left [ \\beta^y \\ , \\delta_y \\left ( \\phi^{j+1 } - \\phi^{j-1 } \\right ) \\right ] \\right\\ } \\nonumber \\\\   & & { } - \\frac{\\rho^4 \\theta^2}{4 } \\ , \\left ( g^{x\\,x } - \\left ( \\beta^x \\right)^2 \\right ) \\delta_x^2 \\left [ \\left ( g^{y\\,y } - \\left ( \\beta^y \\right)^2 \\right ) \\delta_y^2   \\left ( \\phi^{j+1 } - \\phi^{j-1 } \\right ) \\right ] \\ , .\\end{aligned}\\ ] ]    the order of this term is found by replacing differences with derivatives : @xmath239 \\nonumber \\\\   & & { } -\\ , \\theta c^3 \\left ( \\delta t \\right)^4 \\ , \\left\\ { \\ , \\beta^x \\ , \\frac{\\partial}{\\partial x } \\left [ \\left ( g^{y\\,y } - \\left ( \\beta^y \\right)^2 \\right ) \\ , \\frac{\\partial^3 \\phi}{\\partial y^2 \\partial t } \\right ] \\right .",
    "\\nonumber \\\\   & & \\left . { } + \\ , \\left ( g^{x\\,x } - \\left ( \\beta^x \\right)^2 \\right ) \\frac{\\partial^2}{\\partial x^2 } \\left [ \\beta^y \\ , \\frac{\\partial^2 \\phi}{\\partial y \\partial t } \\right ] \\ , \\right\\ } \\nonumber \\\\   & & { } -\\ , \\frac{\\theta^2}{2 } c^4 \\left ( \\delta t \\right)^5 \\ , \\left ( g^{x\\,x } - \\left ( \\beta^x \\right)^2 \\right ) \\frac{\\partial^2}{\\partial x^2 } \\left [ \\left ( g^{y\\,y } - \\left ( \\beta^y \\right)^2 \\right ) \\ , \\frac{\\partial^3 \\phi}{\\partial y^2 \\partial t } \\right ] \\nonumber \\\\   & = & { \\cal o } \\left ( \\left ( \\delta t \\right)^3 \\right ) \\,+\\ , { \\cal o } \\left ( \\left ( \\delta t \\right)^4 \\right ) \\,+\\ , { \\cal o } \\left ( \\left ( \\delta t \\right)^5 \\right ) \\ ,",
    ". \\end{aligned}\\ ] ]    from this we can see that the principal part of the truncation error introduced by the new terms is of order @xmath240 , which is in fact one order less than the original accuracy of equation  [ eq : finite2d ] .",
    "using lees first adi decomposition reduces the accuracy of the original scheme .",
    "this is only true , however , when we consider a moving grid . from the last expression it is clear that for a fixed grid , the truncation error introduced by this method will only be of order @xmath241 , as is well known .    when we do the same analysis for the case of the adi scheme based on _",
    "lees second method _ ,",
    "we find that the principal part of the truncation error introduced by the new terms is of order @xmath242 for a shifting grid . the accuracy of the original equation is therefore preserved . in principle",
    ", one would therefore prefer lees second method .",
    "however , we will see below that the second method is far more unstable than the first when the grid shifts , so its higher accuracy is of limited usefulness .    for the _ time - symmetric adi scheme _",
    ", the principal part of the truncation error introduced by the extra terms is again of order @xmath243 .",
    "this method is thus as accurate as the fully implicit one .",
    "we will see that it is also stable .",
    "we turn now to the all - important question of the stability of the adi schemes that we have described in the last section . in the same way as in the one dimensional case",
    ", we will start by studying the nature of the solutions of the differential equation ( equation  [ eq : wave2d ] ) , and we will again consider the solutions in a very small region around the point @xmath244 , assuming that the coefficients remain constant in this region .    moreover , for simplicity we will assume that we can take the functions @xmath214 and @xmath215 out of the difference operators in the expression for @xmath201 ( equation  [ eq : defseo ] ) .",
    "again , if these functions change rapidly from one grid point to the next , the accuracy of the finite - difference scheme on this grid is probably poor anyway .",
    "following the same procedure as in the one - dimensional case , we will look for solutions of the differential equation equation  [ eq : wave2d ] that take the form : @xmath245 where @xmath246 is the 2-dimensional wave vector .",
    "we denote its components by @xmath247 , and define the associated covector ( one - form ) components @xmath248 by @xmath249 substituting into equation  [ eq : wave2d ] and solving for @xmath89 , we find the dispersion relation : @xmath250^{1/2 } \\ , .",
    "\\label{eq : dispersion2d}\\ ] ] this is a simple generalization of equation  [ eq : dispersion1d ] .",
    "again we have the analytic boundedness condition @xmath251 therefore , if one of the solutions is growing , the other is dying at the same rate .",
    "we will now proceed to the local stability analysis of the different numerical approximations .",
    "we look for numerical solutions to the finite difference approximations of the following form : @xmath252 where we have used our simplifying assumption that @xmath253 . by substituting this equation into any of the finite difference approximations ,",
    "we shall always obtain a quadratic equation for @xmath254 of the form : @xmath255 the coefficients in this equation will depend on the particular approximation used .",
    "we call the two solutions of this equation @xmath256 .    as in the one - dimensional case , we define the numerical amplification measure : @xmath257 and we take our local stability condition to be : @xmath258    one general consideration applies to all difference schemes .",
    "it is not difficult to see that the analytic boundedness condition equation  [ eq : normal ] will also hold in the finite difference case when the following condition on the coefficients in equation  [ eq : quadratic ] is satisfied : @xmath259    [ [ lees - first - scheme . ] ] lees first scheme .",
    "+ + + + + + + + + + + + + + + + + + +    lees showed that his methods are stable for all time - steps if @xmath260 , for a static grid . in the shifting case ,",
    "the coefficients of the quadratic equation for lees first method are : @xmath261 \\ : \\left [ \\cos \\left ( k_x \\delta x \\right ) - 1 \\right ] \\right\\ } \\nonumber \\\\   & & { } \\times \\left\\ { 1 \\,-\\ , i \\rho \\beta^y \\ : \\sin \\left ( k_y \\delta x \\right ) \\,-\\ , \\rho^2 \\theta \\ , \\left [ g^{yy } - \\left ( \\beta^y \\right)^2 \\right ] \\ : \\left [ \\cos \\left ( k_y \\delta x \\right ) - 1 \\right ] \\right\\ } \\ , , \\\\ \\nonumber \\\\",
    "b & = & -\\left ( 2 \\rho^2 \\left ( 1 - \\theta \\right ) \\left\\ { \\left [ g^{xx } - \\left ( \\beta^x \\right)^2 \\right ] \\left [ \\cos \\left ( k_x \\delta x \\right ) - 1 \\right ]    + \\left [ g^{yy } - \\left ( \\beta^y\\right)^2 \\right ] \\left [ \\cos \\left ( k_y \\delta x   \\right ) - 1 \\right ] \\right\\}\\right . \\nonumber \\\\   & & \\quad { } \\,-\\ , 2\\rho^2 \\left ( g^{xy } - \\beta^x \\beta^y \\right ) \\ : \\sin   \\left ( k_x \\delta x \\right ) \\ : \\sin \\left ( k_y \\delta x \\right )   \\nonumber \\\\   & & \\quad{}\\,-\\ , \\left .",
    "i \\rho^2 \\delta x \\ , \\left[\\gamma^x \\",
    ": \\sin   \\left ( k_x \\delta x \\right ) \\ , + \\ , \\gamma^y",
    ": \\sin \\left ( k_y \\delta x\\right ) \\right ] \\,+\\ , 2 \\right ) \\ , ,",
    "\\nonumber \\\\   c & = & - \\left ( \\left\\ { 1\\,-\\ , i \\rho \\beta^x \\ : \\sin \\left ( k_x \\delta x \\right ) \\ , -\\ , \\rho^2 \\theta \\ , \\left[g^{xx } - \\left ( \\beta^x \\right)^2 \\right ] \\ :   \\left [ \\cos \\left ( k_x \\delta x \\right ) -1 \\right ] \\right\\ } \\right .",
    "\\nonumber \\\\   & & \\qquad{}\\times\\left\\ { 1 \\,-\\ , i \\rho\\beta^y \\ : \\sin \\left ( k_y \\delta x \\right ) \\ , -\\ , \\rho^2 \\theta \\ , \\left [ g^{yy } -\\left ( \\beta^y \\right)^2 \\right ] \\ :   \\left [ \\cos \\left ( k_y \\delta x \\right ) - 1\\right ] \\right\\ } \\nonumber \\\\   & & \\quad{}+ 2 \\rho^2 \\theta \\ , \\left\\ { \\left [ g^{xx } \\,-\\ , \\left ( \\beta^x \\right)^2 \\right ] \\left [ \\cos \\left ( k_x \\delta x \\right ) \\,-\\ , 1 \\right ] + \\left [ g^{yy } \\,-\\ , \\left(\\beta^y \\right)^2 \\right ] \\left [ \\cos \\left ( k_y \\delta x \\right ) \\,-\\ , 1 \\right]\\right\\ } \\nonumber \\\\   & & \\quad { } \\,-\\ , \\left .",
    "\\rule[0mm]{0mm}{4 mm } \\ , 2 \\right ) \\ , .",
    "\\end{aligned}\\ ] ] it is clear that these coefficients do not satisfy the boundedness condition equation  [ complex ] .    we shall test the stability condition given by equation  [ eq : stability2d ] on lees first method by numerically calculating the amplification measure from the roots of equation  [ eq : quadratic ] . for simplicity , we consider the case where : @xmath262 we do not believe this restricts the generality of our conclusions : from our analysis of the one - dimensional case , the restriction on @xmath33 should not cause a problem , and the particular values of the metric tensor are unlikely to have a determining effect on stability .",
    "the results of our local stability analysis appear in figure  [ fig : stability : lees1 ] , where we show the following region of the shift vector space : @xmath263 since @xmath264 corresponds to a grid shifting with a speed @xmath265 , the region considered in the graphs will include grids that shift faster than the waves .",
    "we have considered uniformly spaced values of the shift vector inside this region . for a given point in the shift vector space",
    ", we find the maximum value of the quantity : @xmath266 using different values of the wave vector @xmath246 : @xmath267 and , for each wave vector , @xmath268 different values of the courant parameter @xmath71 in the interval @xmath269 .",
    "having found @xmath270 we plot its value on a logarithmic scale . in the graphs , values of smaller than or equal to @xmath271 ( )",
    "are represented by clear regions , and values larger than @xmath190 ( ) by the darkest regions .",
    "it is not difficult to see that the clear regions will correspond to values of the shift vector for which the finite difference scheme is locally stable ( at least for ) , and dark regions to values of the shift that give rise to instabilities .",
    "the darker the region , the more violent the instabilities . finally , the solid arc in the graphs marks the end of the light - cone .",
    "it is important to note that the presence of a dark region does not mean that for the given value of @xmath272 the scheme will be unstable for all , but only that we must expect instabilities for at least some values of the @xmath71 in that interval .    in the upper graph in figure  [ fig : stability : lees1 ] , we show the case where .",
    "the finite difference scheme is unstable for at least some value of @xmath71 at all values of the shift vector .",
    "this instability becomes much stronger whenever one of the components of the shift vector is greater than the speed of the waves .",
    "we recall that even in the one - dimensional case , the implicit scheme for @xmath273 is only conditionally stable , so the behavior here is no surprise .",
    "this figure also shows how the introduction of an operator splitting has broken the rotational symmetry of our problem : it is no longer the light - cone which is the important feature , but the rectangular region in which the light - cone is inscribed .",
    "the lower graph corresponds to the case , which is unconditionally stable in the one - dimensional case . in two dimensions ,",
    "the scheme is still locally stable for values of the shift vector along the direction of the coordinate axis , just as the 1-d scheme was .",
    "however , instabilities appear for speeds in other directions .",
    "these instabilities are weak compared to those for speeds faster than the wave speed , but their presence will nevertheless be significant , as we will show in the examples of numerical integrations that we give below .",
    "we have looked at larger values of the parameter @xmath109 , but the situation does nt improve beyond @xmath274 . lees first scheme is therefore not very useful for grid speeds that are not aligned with the coordinate axis .    [ [ lees - second - scheme . ] ] lees second scheme .",
    "+ + + + + + + + + + + + + + + + + + + +    we next turn to lees second method , for which the coefficients of the quadratic equation are :    @xmath275 \\ : \\left [ \\cos \\left ( k_x \\delta x \\right ) - 1 \\right ] \\right\\ } \\nonumber \\\\   & & { } \\times\\left\\ { 1 \\,-\\ , i \\rho \\beta^y \\ : \\sin \\left ( k_y \\delta x \\right ) \\,-\\ , \\rho^2 \\theta \\ , \\left [ g^{yy } - \\left ( \\beta^y \\right)^2 \\right ] \\ : \\left [ \\cos \\left ( k_y \\delta x \\right ) - 1 \\right ] \\right\\ } , \\\\   \\nonumber \\\\   b & = & -\\ , \\left ( 2\\rho^2 \\left ( 1 - \\theta \\right ) \\left\\ { \\left [ g^{xx } - \\left ( \\beta^x \\right)^2 \\right ] \\left [ \\cos \\left ( k_x \\delta x \\right ) - 1 \\right ] + \\ ,   \\left [ g^{yy } - \\left ( \\beta^y \\right)^2 \\right ] \\left [ \\cos \\left ( k_y \\delta x \\right ) - 1 \\right ] \\right\\ } \\right .",
    "\\nonumber \\\\   & & \\quad{}\\,-\\ , 2 \\rho^2 \\ , g^{xy } \\ : \\sin \\left ( k_x \\delta x \\right ) \\ : \\sin \\left ( k_y \\delta x \\right ) -\\ , i \\rho^2 \\delta x \\ , \\left [ \\gamma^x \\ : \\sin \\left ( k_x \\delta x \\right ) \\,+\\ , \\gamma^y \\ : \\sin \\left ( k_y \\delta x \\right ) \\right ] \\nonumber \\\\   & & \\quad{}+\\ , 2 i \\rho^3 \\theta \\ , \\left\\ { \\beta^x \\ , \\left [ g^{yy } - \\left ( \\beta^y \\right)^2 \\right ] \\ : \\sin \\left ( k_x \\delta x \\right ) \\ : \\left [ \\cos \\left ( k_y \\delta x \\right ) - 1 \\right ] \\right .",
    "\\nonumber \\\\   & & \\quad \\qquad\\left . { } + \\ , \\beta^y \\ , \\left [ g^{xx } - \\left ( \\beta^x \\right)^2 \\right ] \\ :   \\sin \\left ( k_y \\delta x \\right ) \\ : \\left [ \\cos   \\left ( k_x \\delta x \\right ) - 1 \\right ] \\right\\ } \\nonumber \\\\ & & \\quad{}+\\ , 2 \\rho^4 \\theta^2\\left [ g^{xx } - \\left ( \\beta^x \\right)^2 \\right ] \\left [ g^{yy } - \\left ( \\beta^y\\right)^2 \\right ] \\left [ \\cos \\left ( k_x \\delta x \\right ) - 1 \\right ] \\left [ \\cos \\left ( k_{y } \\delta x \\right ) - 1 \\right]\\nonumber \\\\   & & \\quad{}\\left .",
    "\\,+\\ , 2 \\rule[0mm]{0mm}{4 mm } \\ , \\right ) , \\\\",
    "\\nonumber \\\\",
    "c & = & -\\ , \\left ( \\rho^2 \\theta \\left\\ { \\left [ g^{xx } - \\left ( \\beta^x \\right)^2 \\right ] \\left [ \\cos \\left ( k_x \\delta x \\right ) - 1 \\right ] \\,+\\ , \\left [ g^{yy } - \\left ( \\beta^y \\right)^2 \\right ] \\left [ \\cos \\left ( k_y \\delta x \\right ) - 1 \\right ] \\right\\ } \\right .",
    "\\nonumber \\\\   & & \\quad{}-\\ , i \\rho \\left [ \\beta^x \\ : \\sin \\left ( k_x \\delta x \\right ) + \\beta^y \\ : \\sin \\left ( k_y \\delta x \\right ) \\right ] \\,+\\ , \\rho^2 \\beta^x \\beta^y \\ :   \\sin \\left ( k_x \\delta x \\right ) \\ : \\sin \\left ( k_y \\delta x \\right ) \\nonumber \\\\   & & \\quad{}-\\ , i \\rho^3 \\theta\\left\\ { \\beta^x \\ , \\left [ g^{yy } - \\left ( \\beta^y \\right)^2 \\right ] \\ : \\sin\\left ( k_x \\delta x \\right ) \\ : \\left [ \\cos \\left ( k_y \\delta x \\right ) - 1 \\right ] \\right .",
    "\\nonumber \\\\   & & \\quad \\qquad{}\\left .",
    "+ \\ , \\beta^y \\ ,",
    "\\left [ g^{xx } - \\left ( \\beta^x\\right)^2 \\right ] \\ :   \\sin \\left ( k_y \\delta x \\right ) \\ : \\left [ \\cos \\left ( k_x \\delta x\\right ) - 1 \\right ] \\right\\ } \\nonumber \\\\   & & \\quad { } -\\ , \\rho^4",
    "\\theta^2 \\left [ g^{xx } - \\left ( \\beta^x \\right)^2 \\right ] \\left [ g^{yy } - \\left ( \\beta^y \\right)^2 \\right ] \\left [ \\cos \\left ( k_x \\delta x \\right ) - 1 \\right ] \\left [ \\cos \\left ( k_y \\delta x \\right ) - 1 \\right]\\nonumber \\\\   & & \\quad { } \\left .   \\,-\\ , 1 \\ , \\rule[0mm]{0mm}{4 mm } \\right ) .\\end{aligned}\\ ] ]    again , these do not satisfy the boundedness condition equation  [ complex ] . in figure",
    "[ fig : stability : lees2 ] we again portray the cases for and .",
    "the situation is even worse than before : the instabilities in lees second scheme grow faster than for the first scheme , and even for @xmath276 there is only a very small region of stability just around the origin .",
    "clearly , this scheme will not be practical for any moving grid .",
    "[ [ the - time - symmetric - scheme . ] ] the time - symmetric scheme .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + +    we have found that both standard adi methods become unstable when the reference frame is moving .",
    "neither satisfies the symmetry condition equation  [ complex ] .",
    "now we look in the same way at the time - symmetric scheme . the fact that this scheme does indeed satisfy equation  [ complex ]",
    "can readily be seen from the form that the coefficients of the quadratic equation take in this case :    @xmath275 \\ : \\left [ \\cos \\left ( k_x \\delta x \\right ) - 1 \\right ] \\right\\ } \\nonumber \\\\   & & \\quad{}\\times\\left\\ { 1 \\,-\\ , i \\rho \\beta^y \\ : \\sin \\left ( k_y \\delta x \\right ) \\,-\\ , \\rho^2 \\theta \\ , \\left [ g^{yy } - \\left ( \\beta^y \\right)^2 \\right ] \\ : \\left([\\cos \\left ( k_y \\delta x \\right ) - 1 \\right ] \\right\\ } \\ , , \\\\   \\nonumber \\\\ \\nonumber \\\\",
    "b & = & - \\ , \\left(2 \\rho^2 \\left ( 1 - \\theta \\right ) \\left\\ { \\left [ g^{xx } -   \\left ( \\beta^x \\right)^2 \\right ] \\left [ \\cos \\left ( k_x \\delta x \\right ) - 1 \\right ] + \\left[g^{yy } - \\left ( \\beta^y \\right)^2 \\right ] \\left [ \\cos \\left ( k_y \\delta x \\right ) - 1 \\right ] \\right\\}\\right .",
    "\\nonumber \\\\   & & \\quad { } \\,-\\ , 2 \\rho^2 \\ , g^{xy } \\ : \\sin   \\left ( k_x \\delta x \\right ) \\ : \\sin \\left ( k_y \\delta x \\right ) -\\ , i \\rho^2   \\delta x \\ , \\left [ \\gamma^x \\ : \\sin \\left ( k_x \\delta x \\right ) \\,+\\ , \\gamma^y \\ : \\sin \\left ( k_y \\delta x \\right ) \\right ] \\nonumber \\\\   & & \\quad { } + \\ , 2 \\rho^4\\theta^2 \\left [ g^{xx } - \\left ( \\beta^x \\right)^2 \\right ]   \\left [ g^{yy } - \\left ( \\beta^y \\right)^2 \\right ] \\left [ \\cos\\left ( k_x \\delta x \\right ) - 1 \\right ] \\left [ \\cos \\left ( k_y \\delta x \\right ) - 1\\right]\\nonumber \\\\   & & \\quad\\left . { } \\,+\\ , 2 \\rule[0mm]{0mm}{4 mm } \\ , \\right ) \\ , , \\\\",
    "\\nonumber \\\\   c & = & \\left\\ { 1\\,+\\ , i \\rho \\beta^x \\ : \\sin \\left ( k_x \\delta x \\right ) \\,-\\",
    ", \\rho^2 \\theta \\ ,   \\left [ g^{xx } - \\left ( \\beta^x \\right)^2 \\right ] \\ : \\left [ \\cos \\left ( k_x \\delta x \\right ) - 1 \\right ] \\right\\ } \\nonumber \\\\   & & \\quad { } \\times \\left\\ { 1 \\,+\\ , i \\rho \\beta^y \\ : \\sin \\left ( k_y \\delta x \\right ) \\,-\\ , \\rho^2 \\theta \\ , \\left [ g^{yy } - \\left ( \\beta^y \\right)^2 \\right ] \\ : \\left [ \\cos \\left ( k_y \\delta x \\right ) - 1 \\right ] \\right\\ } \\ , .",
    "\\end{aligned}\\ ] ]    figure  [ fig : stability : timesymm ] shows the local stability analysis for this scheme , where again we show what happens for and .",
    "for the first case , the situation is no better than before : the scheme is unstable for practically every value of the shift vector .",
    "however , when we set @xmath277 , the value that gave absolute stability in the one - dimensional case , the scheme becomes locally stable _ for every value of the shift vector inside the rectangular region that inscribes the light - cone_. we find that this stability is maintained for larger values of @xmath109 .",
    "what we see here is effectively a ` light - cone stability condition ' , except for the fact that instead of a cone we now have a rectangle , as a consequence of the fact that the adi splitting breaks the rotational symmetry of the problem . in the general case",
    ", this local stability condition can be expressed in the following way : @xmath278 where @xmath279 may refer to any spatial direction .",
    "the time - symmetric scheme has also the important property that in the stable region the numerical solutions will always be non - dissipative ( at least in the non - accelerating case ) , that is : @xmath280    this can be easily proved from the fact that this scheme satisfies condition  [ complex ] : if the scheme has a dissipative solution with , then condition  [ complex ] together with the analytic boundedness condition ( equation  [ eq : normal ] ) implies that it must also have an unstable solution with .    with the time - symmetric scheme we have then found what we are looking for : an absolutely locally stable , second - order accurate adi decomposition for the finite difference approximation to the wave equation in a reference frame moving at any speed up to the wave speed in any direction .",
    "this scheme can be easily generalized to any number of spatial dimensions , as can be seen from its definition in the last section .",
    "the restriction to frames moving slower than the wave speed is expected , of course . to remove it ,",
    "we now define causal reconnection for the 2-dimensional case , using the time - symmetric adi scheme as our starting point .      in the last section we found that the time - symmetric adi scheme had stability properties superior to both the schemes of less first and lees second types .",
    "however , even for the time - symmetric scheme , instabilities appear as soon as one of the components of the grid speed becomes larger than the speed of the waves . in the one dimensional case",
    ", we saw that this instability could be avoided if we used a computational molecule based on the causal structure of the wave equation , and not in the motion of the individual grid points .",
    "we now want to generalize this approach to the two dimensional case .",
    "we will again look for a computational molecule that guarantees that the light - cone is properly represented in the immediate vicinity of the central point . for the moment we will assume that we have already found the points that form such a molecule .",
    "we then introduce the local coordinate system @xmath281 adapted to the causal molecule as a direct generalization of the one dimensional case : @xmath282 where @xmath283 are the coordinates of the central point of the molecule , and where @xmath284{0mm}{8 mm } \\",
    "b^i & : = & \\left ( \\frac{x^i_{t_0 + \\delta t } - x^i_{t_0 - \\delta t}}{2 \\ , \\delta t } \\right ) \\ , .   \\end{aligned}\\ ] ]    in the new coordinate system , the wave equation has the same form as before , except for the substitutions : @xmath285 since in the finite difference approximation the coefficients should be evaluated at the center of the molecule , the above expressions will reduce to : @xmath286    we know that the original finite difference approximation was locally stable as long as equation  [ eq : stability2d : causal ] was satisfied .",
    "this implies that the approach based on the reconnected molecule will be stable if @xmath287    as in the one - dimensional case , we will say that the given three points form a proper causal molecule if the last condition is satisfied .    we will now define a generalization to two dimensions of the concept of effective numerical light - cone",
    "we do this by defining first the axis of this numerical light - cone as the line : @xmath288 the numerical light - cone will then be defined by taking at each time the region covered by a rectangle that is centered at the axis and has sides : @xmath289    with this definition , the numerical `` light - cone '' is really a prism and not a cone .",
    "it is not difficult to prove now that if the points @xmath290 and @xmath291 are inside the numerical light - cone of @xmath292 , then we will have : @xmath293{0mm}{7 mm } \\right ] \\",
    ", , \\\\ \\left ( \\gamma^i - \\frac{a^i}{c^2 } \\right ) & \\in & \\left [ -\\frac{2 \\left ( g^{i\\,i } \\right)^{1/2 } } { \\left ( c \\delta t \\right)}\\,,\\ , \\frac{2 \\left ( g^{i\\,i } \\right)^{1/2}}{\\left ( c \\delta t \\right ) } \\ , \\right ] \\ , .\\end{aligned}\\ ] ] this means that the three points do form a proper causal molecule , and also that the acceleration in the new local coordinates will be bounded .    as in the one - dimensional case , we can guarantee that proper causal molecules can be formed everywhere if we ask for two conditions :    1 .",
    "_ every parent has at least two children .",
    "_ there must always be at least one grid point in the upper and lower time levels inside the numerical light - cones of all points in the middle time level .",
    "it is easy to see that this will require : @xmath294 2 .   _",
    "every child has a parent .",
    "_ all the grid points in the upper and lower time levels must be inside the numerical light - cone of at least one point in the middle time level .",
    "we guarantee this by asking that the light - cones of the points in the middle time level should cover completely the upper and lower time levels , in other words that the union of the intersections of these light - cones with both the upper and lower levels should be the entire grid . + let us consider a square of nearest neighbours in the middle time level .",
    "we want their numerical light - cones to cover the whole quadrilateral area defined by the points where the axis of those light - cones intersect the adjacent time levels . a sufficient condition for this to happen is to ask for the sides of this quadrilateral to be smaller than the spread of the smallest light - cone divided by @xmath295 ( this factor arises from the fact that the diagonals of a square are @xmath295 times larger than its sides ) .",
    "+ following now the same procedure as before , we can show that this condition takes the form : @xmath296{0mm}{5 mm } \\right]^2 \\right .",
    "\\nonumber \\\\ & & \\left .",
    "+ \\ , \\left [ \\max \\left ( d_{21 } , d_{22 } \\right ) \\rule[0mm]{0mm}{5 mm } \\right]^2   \\right\\}^{1/2 } \\hspace{20 mm } \\forall i \\ , .",
    "\\label{reconnection2_2d } \\end{aligned}\\ ] ] where the quantities @xmath297 are defined as : @xmath298 and the maximum should be taken over all values of @xmath38 .",
    "as in the one - dimensional case , the last condition is valid only to second order in @xmath168 .",
    "conditions [ reconnection1_2d ] and [ reconnection2_2d ] are the _ causal reconnection conditions _ in the two dimensional case . they will guarantee that proper causal molecules can always be formed .      to test the finite difference methods that we have developed",
    ", we will consider two different situations : a grid moving with a uniform speed , and a grid rotating with constant angular velocity .",
    "we will first study the case of the grid moving with uniform speed , in order to show the advantages of the time - symmetric scheme .",
    "if the grid is moving with velocity , it is not difficult to see that : @xmath299    using these values for the coefficients , we have studied the numerical solution to the wave equation for a number of examples , comparing the three different adi methods developed earlier .",
    "the first set of graphs ( figure  [ fig : example : lees1 ] ) show the result of one such calculation for a scheme of lees first type . in the graphs",
    "we show the grid region , and we calculate the evolution of a gaussian wave packet originally at rest at the point @xmath300 . for simplicity",
    ", we have imposed reflecting boundaries .",
    "we have taken a time - step such that @xmath301 , which means that we are well beyond the courant limit .",
    "dimensional problem , the courant limit for the stability of an explicit scheme is . ]",
    "the evolution is followed using a grid with a speed given by : @xmath302 where we have taken .",
    "we see how an instability is beginning to grow even though the grid is moving slower than the wave speed .",
    "this is precisely in accordance with the results of our local stability analysis .",
    "this instability grows slowly , as expected .",
    "nevertheless , it is clear that its presence is unacceptable in a calculation of any duration .",
    "if we use a method of lee s second type , the instability takes longer to develop , but once it appears it grows very fast , much faster that with lees first method .",
    "the fact that the instabilities in general take longer to appear with lees second method can be traced to the particular wave modes that are involved .",
    "as we can see in the graphs , the instabilities in lees first method are associated with relatively long wavelengths ( several grid points ) , and since these modes are already present in the initial data , they start growing right away . in lees second method , however , the instabilities turn out to be associated with very short wavelengths ( one or two grid points ) , which do not contribute significantly to the initial data .",
    "these means that , even though the instabilities are more violent with this method , it will take a long time for the unstable modes to grow to the scale of the real solution .    in the next set of graphs ( figure  [ fig : example : timesymm ] ) we have applied the time - symmetric scheme to the same problem .",
    "the instability has completely disappeared .",
    "this is again in agreement with our previous conclusions , and shows the superiority of this method .",
    "we have performed similar calculations for many different values of the grid speed and we have found the essentially similar results . the time - symmetric scheme remains stable as long as the grid moves slower than the waves , while the other schemes present instabilities for quite small grid velocities .      in order to show the advantage of causal reconnection of the computational molecules when the grid moves very fast , we will consider now an example with a grid rotating with the constant angular velocity @xmath303 .",
    "it is not difficult to show that : @xmath304    to test for local stability when using causal reconnection , we take @xmath305 in units in which @xmath306 and the grid extends over the range .",
    "this means that the centers of the edges of the grid will be moving faster than the wave speed , with a linear velocity of @xmath307 , while the corners will be going even faster .",
    "the next graphs show the results of a time - symmetric calculation , first using a `` direct '' calculation ( fixed computational molecule ) and second using causal reconnection .",
    "again we use a time - step such that @xmath301 . in figure",
    "[ fig : rotating : direct ] , we show the evolution of a gaussian wave packet originally at rest at the center of the grid , using the direct approach .",
    "we see how after @xmath308 time - steps an instability has appeared close to the boundaries .",
    "only five time - steps later , this instability has grown so large that the original wave is no longer visible ( the scale is automatically adjusted to display the largest value of the function ) .",
    "figure  [ fig : rotating : causal ] shows the same calculation using causal reconnection .",
    "the instability is not present .",
    "in fact , we have done the same calculation with much larger values of the angular velocity ( up to , where the edge is travelling at 15 times the wave speed ) , and the scheme remains locally stable .",
    "these examples demonstrate dramatically that time - symmetric adi can be married with causal reconnection , and that together the two techniques provide a robust difference approximation to the wave equation on a moving grid .",
    "these methods are stable , offer all the computational advantages of adi schemes , and remain second order accurate in @xmath168 and @xmath160 .",
    "a comment on how to enforce causal reconnection at the boundaries seems in order here . in all our examples",
    "we have taken the practical approach of setting the value of the wave function to zero whenever a complete causal molecule can not be formed .",
    "this can happen not only at the boundaries , but also at inner points close to the boundaries for large enough grid speeds .",
    "the philosophy behind this approach is simple : if the causal molecule is incomplete , then we would need information from outside the grid to evolve the wave function at that place .",
    "if we impose the condition that no information can come from the outside , then we must take the value of the wave function as zero at that point .",
    "this requirement can be relaxed somewhat be using an outgoing wave boundary condition whenever we can still find a causally related point in the previous time level , but not before that . at places where one ca nt even find a causally related point in the previous time level",
    ", the only legitimate thing one can do is to set the value of the wave function to zero .",
    "the wave equation we have studied here is a prototype for more complex equations of mathematical physics , such as the einstein field equations .",
    "in fact , many hyperbolic systems in mathematical physics can be formulated in terms of the wave operator .",
    "one would expect the instabilities we have found here to be _ generic : _ any numerical approximation to a hyperbolic system on a shifting grid should exhibit them .",
    "only experience will show us just how well our cures for these generic instabilities transfer to more interesting equations .",
    "however , the instabilities we have described here are cured by the application of two clear physical principles , causality and time - reflection invariance .",
    "it seems clear that it would be asking for trouble _ not _ to incorporate these principles into the design of algorithms for the numerical integration of any fundamental physical equations .",
    "we have , of course , studied in detail only one second - order differential equation in one and two dimensions .",
    "the restriction to two dimensions is not important .",
    "the physical principles involved do not depend on the number of dimensions , and the savings obtained by using an adi scheme instead of a fully - implicit formulation increase rapidly with the number of dimensions .",
    "in many physical systems , it is advantageous to formulate the equations of the theory as first - order differential equations .",
    "this is true in hydrodynamics and in many studies of general relativity .",
    "the general principles of causality and time - reflection invariance extend in a simple way to such systems .",
    "time - symmetric adi should prove relatively straightforward to apply to more complicated systems of equations , provided the original differential equations embody time symmetry .",
    "causality may be less straightforward in nonlinear equations , where the structure of the characteristic cone will depend on the solution , and so the exact causal relationships between time - levels can not be decided independently of solving the equations .",
    "however , causal reconnection is implemented via an inequality : one requires that grid points should be _ within _ the characteristic cones of their relatives at the previous time - step . in most cases",
    ", one would hope that the inequality can be assured simply by extrapolation from the behavior of the characteristic cones on the known time - steps .",
    "an important area for the application of the techniques we have developed here would be numerical fluid dynamics , where the study of wave phenomena in supersonic flows is a natural place to expect causality problems , and where the interest in three - dimensional problems makes adi essential in many cases .    in some restricted situations",
    ", it may be straightforward to apply these techniques ; for example , a neutron star moving supersonically through a grid in general relativity will , if treated in the standard way , use acausal computational molecules . using causal reconnection",
    ", adapted to the characteristics of the fluid problem , should prevent instabilities of the type we have found here .",
    "but the application of our techniques to more general problems in fluid dynamics will not be automatic .",
    "causal reconnection will have to be generalized to deal with hydrodynamic shocks . at a shock ,",
    "the regular causal structure of the fluid breaks down .",
    "this does not mean that causal reconnection can not be implemented there .",
    "on the contrary , the fact that a causal algorithm is constantly mapping the structure of the characteristics means that it can be programmed automatically to locate and to identify shocks .",
    "the idea of correctly representing the causal structure of the original differential equation is not new , existing methods for handling shocks and related transport problems , such as upwind differencing @xcite and godunov methods @xcite , are already based on the local structure of the characteristics of the fluid .",
    "these ideas have also been introduced in the numerical study of steady supersonic flows , where the direction of flow behaves like a time coordinate and the equations become hyperbolic .",
    "integration methods have been developed that use retarded differences in the upstream direction to maintain stability @xcite , @xcite .",
    "all these methods differ from causal reconnection in the fact that they keep using only the nearest neighbours to build the computational molecules .",
    "we have recently become aware , however , of a paper by e. seidel and wai - mo suen that introduces an idea they call `` causal differencing '' , that is very similar to our causal reconnection @xcite",
    ".    fluid dynamics also presents special challenges to time - symmetric adi .",
    "the usual equations of inviscid gas dynamics are time - symmetric , but the presence of viscosity or shocks introduces a fundamental irreversibility into the problem .",
    "we hope to treat the fluid dynamic problem in a future paper .",
    "we are confident , however , that the present techniques will generalize easily to problems in numerical general relativity , such as that of the motion of black holes through fixed grids .",
    "causal reconnection should allow the equations to remain stable and causal .",
    "moreover , the computational advantages offered by adi schemes , of permitting stable large time - steps ( provided the physical situation allows such steps to remain accurate ) while avoiding time - consuming sparse - matrix solutions , can be obtained without sacrificing accuracy or stability .",
    "it is hard now to imagine any situation in numerical integrations of the vacuum field equations of general relativity where one would use implicit methods without employing time - symmetric adi .",
    "in this appendix we will sketch the derivation of equation  [ eq : wave2 ] by making use of elegant tensorial techniques .",
    "there are many alternative approaches , of course , and a reader unfamiliar with tensors can obtain the same result in a straightforward , but rather long , way simply by making the following general change of variables in the original wave equation from the physical ( inertial ) coordinates @xmath309 to the computational coordinates @xmath310 : @xmath311 with the associated change of derivatives @xmath312    the functions that we have identified as the shift vector @xmath10 , the spatial metric @xmath25 and the @xmath33 coefficients in equations  ( [ eq : shift1 ] ) , ( [ eq:3metric ] ) and  ( [ eq : gamma ] ) come out as part of the algebra .",
    "a reader who wants an introduction to the use of tensors in mathematical physics is invited to consult reference @xcite .",
    "we will start from the expression of the wave equation in a general coordinate system : @xmath313 where the semicolon stands for covariant derivative . using the explicit expression for the covariant derivatives",
    ", the last equation takes the form : @xmath314 where the coefficients @xmath315 are defined in terms of the christoffel symbols as : @xmath316    our first task is , then , to find the inverse metric @xmath317 .",
    "the metric in the new coordinates is given by    @xmath318    with @xmath319 the minkowski metric tensor : @xmath320    we now note that for a line of constant @xmath11 we have @xmath321 which implies @xmath322 using now the definition of the shift vector ( equation  [ eq : shift1 ] ) and writing @xmath323 we find : @xmath324 this is an important relation , and we will use it to rewrite the metric coefficients given by equation  [ metric : def ] .    for the mixed components in space and time of @xmath325 we find : @xmath326 and finally : @xmath327    in a similar way we can find the coefficient @xmath328 : @xmath329 and from this we obtain : @xmath330    we will adopt the convention that the indices of the shift vector can be raised and lowered by using only the spatial metric : @xmath331 where @xmath332 are the coefficients of the inverse of the spatial metric matrix @xmath25 .    the coefficients of @xmath333 can now be written as : @xmath334 using the last expression it is not difficult to see that the coefficients of the inverse metric @xmath335 will be given by : @xmath336 having found @xmath317 , we will now look for an expression for the coefficients @xmath33 .",
    "since the original coordinates @xmath337 define an inertial reference frame , the christoffel symbols can be expressed in terms of their transformation to the general coordinates : @xmath338 from the last expression it is easy to see that : @xmath339 which in turn means : @xmath340 on the other hand , from the general expression for the christoffel symbols : @xmath341 \\ , , \\ ] ] it is not difficult to show that : @xmath342\\right\\}.\\ ] ]    using the previous results , we can finally rewrite equation  [ eq : wave1 ] in the following way : @xmath343 this is the final form of the wave equation in the coordinate system adapted to the motion of the grid .",
    "in this appendix , we discuss one algorithm that determines the positions of the points that form the causal computational molecules . we will consider the case of an arbitrary number of spatial dimensions @xmath2 .",
    "the particular cases of one and two dimensions can then be found in a straightforward way .",
    "there are many different ways of finding the closest causally connected grid points .",
    "for example , if it is possible to find the transformation of coordinates that takes us back to the original inertial reference frame @xmath344 then we could use the fact that in that reference frame the causal structure is particularly simple : we would simply select those points in the different time levels that have the closest values of @xmath345 .",
    "this method , however , will only be useful in a few special cases .",
    "indeed , in the general case it may prove almost impossible to find the functional relation ( [ inv.func ] ) .    with this in mind ,",
    "we have developed a method that can be applied in the general case .",
    "let us then assume that we are given a point in the last time level with position @xmath291 . our aim is to find points @xmath292 and @xmath290 in the two previous time levels in such a way as to guarantee that a proper causal molecule will be formed .",
    "we have already seen that this will happen if both @xmath290 and @xmath346 are inside the numerical light - cone of @xmath292 .",
    "our algorithm to find the proper causal molecules linking the grids at time - steps @xmath133 , @xmath132 , and @xmath131 assumes that the causal reconnection condition holds .",
    "( if it does nt , then remedial action , changing @xmath160 or @xmath39 , is required . )",
    "our procedure is the following .    1 .",
    "choose some point @xmath291 .",
    "the center of its causal molecule will be that grid point @xmath347 for which the following function reaches a minimum : @xmath348 - x^i_{t_0 + \\delta t } \\ , \\right\\}^2 \\ , .\\ ] ] this minimum can easily be found by standard multi - dimensional search techniques .",
    "once the minimum is found , we have our best approximation to the exact inverse coordinate transformation : the point @xmath38 is approximately at the same spatial location as @xmath349 in the original inertial frame",
    "once we have found the appropriate @xmath347 , we look in the third time level @xmath350 for the completion of the causal molecule , the point @xmath351 that minimizes the function : @xmath352 - z^i \\ , \\right\\}^2 \\ , .\\",
    "] ] this is much easier than the previous step because we already have the point @xmath347 , so we do nt have to calculate again the functions @xmath74 and @xmath75 .",
    "in fact , minimizing @xmath353 is equivalent to finding the point @xmath354 in the third time level that is closest to the axis of the light cone of @xmath347 in the original inertial frame .",
    "we do not have to go through the grid again to find this point .",
    "so far we have constructed only one molecule .",
    "one needs to repeat the above steps for all points at time - step @xmath133 , but of course the best guess for a causal molecule for any grid point is simply to translate the molecule found for its neighbor .",
    "this will occasionally fail , but only by one grid point .",
    "so the minimization steps will require a computing effort that is only proportional to the number of grid points .",
    "it is not difficult to prove that , whenever the causal reconnection conditions hold , this algorithm does indeed produce a proper causal molecule . for reasons indicated above",
    ", the computational effort is proportional to the number of grid points . in complex problems , such as general relativity ,",
    "this is likely to be a very small overhead .",
    "we want to thank g.d .",
    "allen for many useful discussions and comments .",
    "one of the authors ( m. alcubierre ) also thanks the ` universidad nacional autnoma de mxico ' for financial support ."
  ],
  "abstract_text": [
    "<S> moving grids are of interest in the numerical solution of hydrodynamical problems and in numerical relativity . </S>",
    "<S> we show that conventional integration methods for the simple wave equation in one and more than one dimension exhibit a number of instabilities on moving grids . </S>",
    "<S> we introduce two techniques , which we call _ causal reconnection _ and _ time - symmetric adi _ , which together allow integration of the wave equation with absolute local stability in any number of dimensions on grids that may move very much faster than the wave speed and that can even accelerate . </S>",
    "<S> these methods allow very long time - steps , are fully second - order accurate , and offer the computational efficiency of operator - splitting .    </S>",
    "<S> we develop causal reconnection first in the one - dimensional case : we find that a conventional implicit integration scheme that is unconditionally stable as long as the speed of the grid is smaller than that of the waves nevertheless turns unstable whenever the grid speed increases beyond this value . we introduce a notion of _ local stability _ for difference equations with variable coefficients . </S>",
    "<S> we show that , by `` reconnecting '' the computational molecule at each time - step in such a way as to ensure that its members at different time - steps are within one another s causal domains , one eliminates the instability , even if the grid accelerates . </S>",
    "<S> this permits very long time - steps on rapidly moving grids . </S>",
    "<S> the method extends in a straightforward and efficient way to more than one dimension .    </S>",
    "<S> however , in more than one dimension , it is very desirable to use operator - splitting techniques to reduce the computational demands of implicit methods , and we find that standard schemes for integrating the wave equation  lees first and second alternating direction implicit ( adi ) methods  go unstable for quite small grid velocities . lees first method , which is only first - order accurate on a shifting grid , has mild but nevertheless significant instabilities . </S>",
    "<S> lees second method , which is second - order accurate , is very unstable .    by adopting a systematic approach to the design of adi schemes , we develop a new adi method that cures the instability for all velocities in any direction up to the wave speed . </S>",
    "<S> this scheme is uniquely defined by a simple physical principle : the adi difference equations should be invariant under time - inversion . </S>",
    "<S> ( the wave equation itself and the full implicit difference equations satisfy this criterion , but neither of lees methods do . ) </S>",
    "<S> this new time - symmetric adi scheme is , as a bonus , second - order accurate . </S>",
    "<S> it is thus far more efficient than a full implicit scheme , just as stable , and just as accurate .    by implementing causal reconnection of the computational molecules , </S>",
    "<S> we extend the time - symmetric adi scheme to arrive at a scheme that is second order accurate , computationally efficient and unconditionally locally stable for all grid speeds and long time - steps . </S>",
    "<S> we have tested the method by integrating the wave equation on a rotating grid , where it remains stable even when the grid speed at the edge is 15 times the wave speed . </S>",
    "<S> because our methods are based on simple physical principles , they should generalize in a straightforward way to many other hyperbolic systems . </S>",
    "<S> we discuss briefly their application to general relativity and their potential generalization to fluid dynamics . </S>"
  ]
}