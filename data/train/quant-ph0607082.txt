{
  "article_text": [
    "quantum key distribution ( qkd ) is an art to distribute a secret key between parties ( alice and bob ) with arbitrary small leakage of its information to an unauthorized party ( eve ) .",
    "so far , several qkd protocols have been proposed and experimentally demonstrated @xcite . in real life qkd , loss and noises in the quantum channel limit the achievable distance . in order to cover longer distances , a decoy state idea for bb84 @xcite with weak coherent pulses",
    "was proposed , which achieves a key generation rate of order @xmath0 @xcite in the single photon transmission rate @xmath1 , whereas it is in the order of @xmath2 without decoy states @xcite .",
    "another proposal to achieve longer distances was made in 1992 by bennett @xcite ( b92 ) .",
    "the protocol uses two weak coherent states together with a strong reference pulse ( srp ) , and is expected to be robust against channel losses .",
    "in contrast to the decoy schemes where the robustness is achieved by using an increased number of states , the b92 protocol uses just two states , and hence its robustness should come from an entirely different mechanism .",
    "unconditional security was proved @xcite for a variant of the b92 protocol using two polarization states of a single photon , which we call s - b92 , but it does not share the robustness expected for the original b92 .",
    "the security proof of the original b92 protocol is thus important from the practical viewpoint as well as the fundamental one .    in this paper",
    ", we prove the unconditional security of the original b92 protocol , and reveal the mechanism with which its robustness against loss arises .",
    "the crucial finding is that the b92 protocol can be regarded as many s - b92 protocols executed in parallel , which has two benefits .",
    "firstly , it allows us to use the analysis of s - b92 in proving the security of the b92 protocol .",
    "secondly , a striking difference from s - b92 tells us why the b92 protocol is robust against loss and performs similarly to an ideal single - photon implementation of the bb84 protocol .    in two - state protocols ,",
    "it is known that by exploiting an unambiguous state discrimination ( usd ) measurement , eve can obtain a benefit from qubit loss events @xcite .",
    "thus , a secure key is impossible over longer distances in s - b92 @xcite , where qubit loss events are directly connected to physical channel loss .",
    "on the other hand , the qubits in the b92 protocol turn out to be defined including a vacuum component in the signal mode , and they are almost always received by bob even after traveling over longer distances .",
    "in other words , the qubit loss events are negligible since it is _ not _ directly connected to the physical channel loss .",
    "this paper is organized as follows . in sec .",
    "ii , we explain how the b92 protocol works , and in sec .",
    "iii , we prove its security",
    ". our security proof is based on the conversion to an entanglement distillation protocol , and our proof uses technique from the security proof of s - b92 .",
    "thus , in sec .",
    "iii a , we briefly review the security proof of s - b92 @xcite , then in sec .",
    "iii b , iii c , and iii d , we intuitively present the security proof of the b92 protocol , putting some emphasis on the difference between s - b92 and the b92 protocol .",
    "we leave the technical details of the proof to the appendices . finally , we show some examples of the resulting key generation rate in sec .",
    "iv , and we summarize this paper in sec . v.",
    "the essence of the experimental setup of the b92 protocol can be expressed by a mach - zehnder interferometer in fig .",
    "[ setup](a ) .",
    "alice generates a strong coherent pulse and splits it into a weak signal pulse @xmath3 and an srp @xmath4 ( @xmath5 ) .",
    "after alice applies a phase modulation to prepare @xmath6 according to her random bit @xmath7 , she sends out these two systems .",
    "bob uses a beam splitter bs1 with reflectivity @xmath8 , which splits the srp into weak and strong pulses .",
    "the weak pulse ( w ) and the signal pulse interfere at bs2 , whose action is represented by @xmath9 , where @xmath10 and @xmath11 are annihilation operators for the spatial mode to the detector @xmath12 and the w / s mode , respectively .    for bob s part , we assume two types of detectors . one type can tell if the photon number @xmath13 is in an interval @xmath14 , \\label{d1}\\end{aligned}\\ ] ] and the other type can discriminate among vacuum , single - photon , and multi - photon events .",
    "we note that one of us @xcite proved the security of a modified b92 with threshold detectors , but there bob must lock his own local oscillator to the srp mode via a feed - forward control , which may not be easy to implement . in fig .",
    "[ setup](a ) , bob infers alice s bit value to be @xmath15 @xmath16 when @xmath17 @xmath18 records a single photon and @xmath19 @xmath20 records no photon .",
    "let @xmath21 be the rate of these conclusive events .",
    "here and henceforth , `` rate '' is always normalized by the total number of signals . among the conclusive events ,",
    "only the cases where the outcome of @xmath22 is in @xmath23 will be kept and used to generate the final key after classical error correction ( ec ) and privacy amplification ( pa ) @xcite .",
    "let @xmath24 be the rate of these events , where @xmath25 \\label{lambdaprime}\\end{aligned}\\ ] ] corresponds to the range of the total number of photons recorded by the three detectors . using random test bits ,",
    "alice and bob monitor the error rates @xmath26 and @xmath27 of the cases where alice s bit and bob s bit are different .",
    "bob also monitors the rate @xmath28 of events where both @xmath17 and @xmath19 record no photon and @xmath22 reports an outcome in @xmath23 .",
    "note that in the normal operation with @xmath29 and @xmath23 being wide enough , we should have @xmath30 , @xmath31 , and @xmath32 , but these three rates must still be monitored to watch out for eve s possible attacks as we will see later .",
    "in this section , we prove the security of the b92 protocol . throughout this paper ,",
    "we assume that all imperfections are controlled by eve .",
    "note that @xmath22 with quantum efficiency @xmath33 and @xmath17 ( @xmath19 ) with @xmath34 are equivalent to the setup with unit - efficiency detectors when absorbers with the transmission rate of @xmath34 and @xmath35 are respectively put in s and srp modes , and the reflectivity of bs1 is changed to @xmath36 .",
    "as for dark counts , we assume eve can induce dark counts as she pleases . thus , in what follows we assume that all detectors have unit efficiency and no dark counts .",
    "since the b92 protocol and s - b92 share many similarities , in the security proof of the b92 protocol we employ the idea from security proof of s - b92 . in the next subsection , we briefly review s - b92 security proof .",
    "it is based on the conversion of the protocol to an entanglement distillation protocol .",
    "after the review , we present the security proof of the b92 protocol .      in s - b92 , alice sends out @xmath37 ( @xmath38 and @xmath39 ) depending on randomly chosen bit value @xmath7 , where @xmath40 and @xmath41 represent a basis ( x - basis ) of the qubit states ( the single - photon polarization states ) . for later convenience ,",
    "we define the z - basis as @xmath42 , and @xmath43 .",
    "when bob receives a qubit state , he broadcasts this fact and continues to perform a measurement described by positive - operator - valued measure ( povm ) @xcite @xmath44 where @xmath45 , @xmath46 , and @xmath47 is the state orthogonal to @xmath48 .",
    "we call measurement outcomes with @xmath49 or @xmath50 conclusive .",
    "bob tells over a public channel if he has obtained the conclusive event or not .    in order to prove the security of s - b92 , in @xcite s - b92",
    "was converted to an entanglement distillation protocol ( edp ) .",
    "a key point in the conversion is that bob s measurement can be decomposed by a filtering operation @xcite , whose successful operation is represented by a kraus operator @xcite @xmath51\\end{aligned}\\ ] ] followed by z - basis measurement .",
    "this can be seen by noting that @xmath52 , and the successful filtering operation corresponds to the conclusive event in s - b92 . on the other hand , we assume that alice prepares two qubits in a state @xmath53 , sends only qubit b to bob , and then performs z - basis measurement on qubit a. in the normal operation without eve , the successful filtering operation orthogonalizes @xmath54 and @xmath55 so that they share a maximally entangled state , and the bit value shared by alice and bob via z - basis measurements is secure .    in the presence of loss , noise , or eve s intervention , alice and bob do not share a maximally entangled state , but if they succeed in estimating the bit and the phase error rate on the qubit pairs from which they create the key , then they can distill an almost perfect maximally entangled state by running an edp .",
    "here , the bit ( phase ) error stands for an event where alice and bob have different measurement outcomes in z - basis ( x - basis ) .",
    "moreover , if we use the argument by shor and preskill @xcite , the edp protocol followed by z - basis measurements can be made equivalent to s - b92 with ec and pa .",
    "since the bit error rate @xmath56 can be reliably estimated from test bits , we are only left with the estimation of the upper bound on the phase error rate @xmath57 from the observed variables .",
    "thanks to the filter , we can actually relate this bound with other observables . when the photon reaches bob at rate @xmath58 and gives a conclusive outcome at rate @xmath59 , it was shown in @xcite that @xmath60 where @xmath61 , @xmath62 , and the matrix @xmath63 is the inverse of @xmath64 the quantity @xmath65 is the rate at which bob receives the photon and alice s qubit a is in state @xmath66 . although @xmath65 is not measured in the protocol , we have a bound @xmath67 . using this ,",
    "the bound on @xmath57 can be obtained by solving eq .",
    "( [ sfinal ] ) .",
    "the key rate resulting from the above formula is nonzero only for short distances @xcite . for a high loss region with small rate @xmath58 ,",
    "eve may perform the usd measurement on the incoming two states .",
    "whenever it fails , she blocks the photon as if it were lost due to the channel loss .",
    "if the usd is successful , she can send the correct state to bob and hence she learns the bit value without inducing any error .",
    "it follows that _ any _ two state protocol is fragile against qubit loss events .",
    "note that the qubit loss events is not always connected directly to the physical channel losses , which is the case for the b92 protocol as we will see .      in this subsection and the subsequent ones ,",
    "we prove the security of the b92 protocol .",
    "especially , this subsection is devoted to a conversion of the b92 protocol into an entanglement distillation protocol , which is the most crucial point in our proof .",
    "our strategy for the proof is to apply a similar argument to the original b92 with srp , i.e. , we consider the distillation of the maximally entangled state . for the distillation , we first have to convert alice s and bob s part in such a way that each of them has a qubit .",
    "then , we consider the phase error estimation by modifying eq .",
    "alice s part can easily be converted by letting her first prepare @xmath68 and measure the qubit a on the z basis .",
    "on the other hand , the conversion of bob s part is not straightforward since the definition of his qubit space is by no means trivial .",
    "for the conversion , we first introduce additional fictitious measurements which do not disturb bob s conclusive data at all .",
    "thus , the security of the final key does not change even if we assume that bob has conducted these additional measurements . as we will see , these measurements consist of a total photon number measurement ( p ) and a qubit projection ( q ) . furthermore , as we did in sec .",
    "[ s - b92 ] for the s - b92 protocol , we decompose bob s original measurement into a filtering operation ( f ) followed by a projection measurement ( m ) ( see fig .  [ setup](b ) ) . here",
    ", the qubit space is defined by combining the vacuum state and the single - photon state of the s - mode with the appropriate fock states of the srp mode depending on the outcome of measurement p. our qubit space is thus defined depending on the total photon number .",
    "this total photon number determines the nonorthogonality in bob s measurement .",
    "now , let us present the conversion of bob s part in detail .",
    "first , define @xmath69 as the state with @xmath70 photons and @xmath71 photons in mode s and srp , respectively .",
    "since bob uses only linear optics and photon detectors , it does not disturb the statistics of bob s measurement outcomes to assume that bob s measurement is preceded by the measurement of the total photon number @xmath13 in modes s and srp .",
    "we denote this measurement as `` p '' , whose povm is @xmath72 .",
    "suppose that @xmath73 is obtained in this measurement , and recall that bob s conclusive events occur only when d@xmath74 and d@xmath75 receive one photon in total .",
    "then , it follows that without any disturbance of the statistics of the _ conclusive _ events , p can be followed by projection measurement `` q '' with povm @xmath76 . here",
    ", q decides if the state is in the qubit subspace @xmath77 spanned by @xmath78 and @xmath79 .    under the condition that the total number of photons was @xmath13 , let us calculate the povm element @xmath80 for obtaining conclusive bit @xmath81 . at bs1",
    ", conversion @xmath82 occurs with probability @xmath83 , and @xmath84 with @xmath85 .",
    "since outcome @xmath81 corresponds to the projection to state @xmath86 , we have @xmath87 with @xmath88 , @xmath89 , and @xmath90 . at this point",
    ", we notice that the measurement on each qubit space is the same as the measurement in s - b92 with @xmath91 , and hence we can define the filter accordingly .",
    "the successful filtering operation converts @xmath92 into orthogonal states , and it is described by @xmath93\\ , .",
    "\\label{filter}\\end{aligned}\\ ] ] physically , the conversion is realized by bs1 and @xmath94-photon detection by d@xmath95 , resulting in @xmath96 .",
    "thus , we conclude that bob s measurement can be decomposed into the sequence of p , q , and the filtering operation ( f ) followed by a projection measurement on a qubit .    note that in the b92 protocol we distill a key from the successfully filtered events ( or the conclusive events ) with total photon number @xmath97 .",
    "thus , by following the argument by shor and preskill , we conclude that once we have the estimation of an upper - bound on the phase error rate with total photon number @xmath97 , i.e. , @xmath98 , we complete the security proof .",
    "s - b92 and our b92 are similar in the sense that bob applies a filter that orthogonalizes two nonorthogonal qubit states .",
    "however , the two schemes differ in the structure of the qubit spaces and the effect of optical loss ( represented by channel transmission @xmath1 ) on them . in the s - b92 protocol",
    ", the loss of the photon means that bob fails to receive a qubit . on the other hand ,",
    "when the photon reaches bob , the nonorthogonality of the two received states is the same as that of the two states released from alice .",
    "hence the initial states of alice and the measurement by bob are described by the same parameter @xmath99 .",
    "the loss of the qubit is fatal to the key rate , since eve is able to let bob receive a qubit preferentially in the cases where she has succeeded in discriminating the states in the usd measurement . in the b92 protocol , by contrast , bob almost always receives a qubit @xmath77 : he only fails when @xmath13 is outside of @xmath100 or when q fails the qubit projection , both of which are negligible if @xmath100 is chosen to be wide enough and @xmath101 .",
    "this prevents eve from forcing alice and bob to accept the events favorable to her .",
    "the effect of the optical loss in the b92 protocol shows up in an entirely different place . to see this ,",
    "let us rewrite alice s initial coherent states as @xmath102 with @xmath103 where @xmath104 and @xmath105 are a pair of orthonormal states obtained by normalizing @xmath106 .",
    "since @xmath100 is centered around @xmath107 and @xmath108 is chosen such that @xmath109 , we have @xmath110 whereas @xmath111 for @xmath112 .",
    "hence in the b92 protocol , the optical loss decreases the distinguishability of the two signal states sent out from alice .",
    "eve can exploit this difference to obtain partial information on the bit value , but this time she has no further freedom to manipulate alice and bob , since the qubit must be almost always received by bob .",
    "we may thus expect that the key gain is still positive after the privacy amplification even for lossy quantum channels , which will be confirmed in the subsequent sections .",
    "another complication in the b92 protocol is that it looks as if we run slightly different s - b92 protocols with parallel qubit channels , for each of which bob has a filter with a nonorthogonality specified by @xmath13 . since this variation might be exploited by eve , it is desirable to choose @xmath100 to be narrow .",
    "as we have seen , on the other hand , @xmath100 must be much wider than photon number fractuation ( @xmath113 ) in the srp . due to this trade - off",
    ", it is expected that the key rate also depends on the intensity @xmath114 of srp .",
    "since the formal derivation of the upper bound of the phase error rate is a bit complicated , in the main text we intuitively present the derivation and we leave the formal derivation to appendices . from the relation to s - b92 we have seen above , it follows that eq .",
    "( [ sfinal ] ) holds for each photon number @xmath13 , namely , @xmath115 here , we have used a straightforward translation of the parameters in s - b92 into those in the b92 protocol as @xmath116 and @xmath117    note that @xmath118 is concave and @xmath119 is monotone increasing for each element of @xmath120 . taking the summation over the range @xmath121 , where @xmath122\\ , , \\label{lambda}\\end{aligned}\\ ] ] and noting that @xmath123 , we have @xmath124 with @xmath125 and @xmath126 , where the maximum is taken for each element .    since we have used eq .",
    "( [ sfinal ] ) from s - b92 argument @xcite , eq .",
    "( [ semifinal ] ) holds true in the asymptotic limit in which the block size for _ each _ photon number @xmath13 is large . as we show in appendix b , with a more detailed analysis using azuma s inequality @xcite",
    ", we can show that it holds true if the _ total _",
    "block size is large .",
    "finally , we must convert eq .",
    "( [ semifinal ] ) into one involving only the accessible quantities .",
    "as we show in appendix b , eqs .",
    "( b10)-(b13 ) , @xmath127 is upper - bounded by @xmath128 . a lower bound is given by @xmath129 with @xmath130 .",
    "since the vacuum events are dominant in the high loss region , @xmath131 is almost unity , implying that the qubit loss events are negligible .",
    "this makes our b92 robust against channel losses .",
    "using these bounds , we can rewrite eq .",
    "( [ semifinal ] ) into @xmath132 where we have decomposed @xmath133 such",
    "that @xmath134 includes only the nonnegative entries of @xmath135 .",
    "an upper bound of the phase error @xmath136 is determined by inserting the experimental data into eq .",
    "( [ finalex ] ) and searching for the maximum value of @xmath137 satisfying eq .",
    "( [ finalex ] ) , since @xmath138 by definition .",
    "the key generation rate is given by @xcite @xmath139\\big)\\ , , \\nonumber\\\\\\end{aligned}\\ ] ] where @xmath140 .",
    "to illustrate the resulting key rates , we consider a quantum channel that maps @xmath141 into @xmath142 . here",
    "@xmath143 is a single photon state and @xmath144 .",
    "the first part models loss with transmission rate @xmath1 , and the second part models dark counts since a single photon state causes a random click on bob s detectors @xmath145 and @xmath146 . in order to express the experimental parameters , we define @xmath147 as the distance between alice and bob , @xmath148 as a loss coefficient , and @xmath149 as bob s detection efficiency .",
    "we take the experimental parameters from gobby et al @xcite , which are @xmath150 , @xmath151 ( db / km ) , and @xmath152 neglecting alignment errors . with these parameters",
    ", we have @xmath153 where @xmath154 .    ]",
    "we have calculated the key rate @xmath155 and the achievable distance @xmath156 ( km ) for several choices of parameters @xmath157 , where @xmath158 , and @xmath159 . in fig .",
    "[ key ] , we fix @xmath160 and @xmath161 , and vary @xmath114 as ( a ) @xmath162 resulting in @xmath163 , ( b ) @xmath164 @xmath165 , and ( c ) @xmath166 @xmath167 .",
    "this confirms our earlier speculation that increasing @xmath114 will restrict eve s options and leads to a better key rate .",
    "the slope of curve ( c ) shows that the key rate is proportional to the channel transmission @xmath1 until the distance approaches @xmath156 .",
    "increasing @xmath114 further beyond ( c ) merely results in saturation at @xmath168 , and this is the maximum distance among the combinations of the parameter set that we have tried . we can also trade the intensity of srp for a poor resolution @xmath169 .",
    "for example , with @xmath170 we can still achieve @xmath171 even with a relative resolution @xmath172 .    to see how accurate our phase estimation is ,",
    "we plot @xmath155 ( dashed line ) based on the actual phase error rate induced by the quantum channel .",
    "the curve is almost identical for ( a ) , ( b ) and ( c ) , implying that the key rate dependence on @xmath114 is due to the difference in the estimation ability .",
    "this is a typical feature of the b92 protocol in which the phase error rate can not be estimated directly as opposed to the bb84 protocol .",
    "we must also note that the derivation of eq .",
    "( [ finalex ] ) from eq .",
    "( [ sfinal ] ) is not tight and the estimation might be improved by a more sophisticated analysis .    for comparison , we have also shown the key rate for the bb84 protocol based on the gllp formula @xcite ( dotted line , @xmath173 ) , and the rate with infinite number of decoy states",
    "@xcite ( dotted line , @xmath174 ) , assuming the ideal error correction efficiency . considering that the analysis of the statistical fluctuations in the decoy schemes tends to be very complicated @xcite , achieving a comparably long distance with just two states could be an advantage of the b92 protocol in practical implementations .",
    "in summary , we studied the security of the original b92 with strong reference pulse assuming the two types of detectors . we can identify qubit spaces composed of the states with the signal pulse including zero and one photon .",
    "it follows that even if the transmission channel is physically very lossy , bob still finds a qubit state with high probability , which is the essential difference from the single - photon b92 .",
    "we showed the key rate scales as @xmath175 when the srp is strong enough .",
    "it is interesting to remove the assumptions on the detectors , which we leave for future studies .",
    "part of this work was performed when k.t worked for qit group , universit@xmath176 t erlangen - n@xmath177rnberg in germany , the perimeter institute , and the university of toronto in canada .",
    "this work was in part supported by jsps grant - in - aid for scientific research(c ) 20540389 .",
    "we thank d. gottesman , h - k .",
    "lo , and g. weihs for valuable discussions and supports .",
    "n.l acknowledges the support by the german research council ( dfg ) through an emmy - noether group , the european project secoqc and nserc ( discovery grant , quantumworks ) .",
    "in the following appendices , we explain the formal derivation of the phase error estimation , eq .",
    "( [ finalex ] ) .",
    "as we have mentioned in the main text , we need to obtain the relationship among @xmath178 , @xmath179 , @xmath180 , @xmath181 , and @xmath182 . for the derivation of the relationship",
    ", we have two problems to be addressed .",
    "first , note that these ratios can not be directly measured in the experiment .",
    "for instance , in the actual experiment we have direct access to @xmath183 , not @xmath179 .",
    "thus , @xmath179 has to be estimated via actually available experimental data .",
    "this is also the case for other ratios , such as @xmath178 , @xmath181 , and @xmath182 , and the estimation will be discussed in appendix c.    in addition to this problem , we have another difficulty in deriving the relationship .",
    "the difficulty lies in the fact that not all the observables can be simultaneously measured .",
    "for example , @xmath181 and @xmath178 do not commute because alice has to conduct x - basis measurement for @xmath181 while she performs z - basis measurement for @xmath178 . in order to overcome this problem",
    ", we randomly label each pair as a test pair ( with a small probability @xmath184 ) or a code pair ( with probability @xmath185 ) @xcite .",
    "we try to distill a key from the code pairs , and hence what we need to estimate is the phase error rate @xmath180 in the code pairs . by using the bell measurement @xcite , @xmath178 and @xmath180 in the code pairs can be measured simultaneously , in principle . on the other hand , for the test pairs ,",
    "we assume that alice performs x - basis measurement on her qubits to measure @xmath181 . in this way",
    ", all the observables can be measured simultaneously , and we can clearly define joint probabilities .",
    "this is where azuma s inequality , which connects conditional probabilities with the actual ratios , comes into our game .    in order to claim that the above fictitious senario is possible in principle",
    ", the actual protocol must be slightly modified .",
    "the labeling of test pairs and code pairs should be publicly done in the actual protocol .",
    "the key is distilled only from the code pairs , while alice discards her bit values for the test pairs , such that she could have performed x - basis measurement on her fictitious qubits .",
    "the only parameters we actually need to monitor for the test pairs is the number of events where zero or one photon are recorded by @xmath145 and @xmath146 in total , with the outcome of @xmath186 being in the valid range @xmath187 .",
    "this quantity is used in eq .",
    "( c5 ) below .",
    "now let us describe our argument for the phase error estimation precisely .",
    "imagine a sequence of measurements on a pair of systems , a and ( s , srp ) , which alice and bob share ( see also fig .  [ diagram ] ) . at the beginning",
    ", alice randomly decides whether a pair is a test pairs ( with probability @xmath184 ) or a code pairs ( with probability @xmath185 ) , and for the code pair , the sequence of measurements starts with `` p '' with outcome @xmath13 , followed by projection `` q '' .",
    "if p fails to detect photon number inside @xmath188 or q does not succeed in projecting the state to the qubit state @xmath77 , we call such outcome as `` n '' .",
    "if the state was found in the qubit state with p detecting photon number inside @xmath188 ( we call this outcome `` s '' ) , we subject the state to the filtering operation f. if f succeeds ( `` fil '' ) , we apply the bell measurement @xcite ( `` b '' ) to see whether there is a bit error ( `` bit '' ) and/or a phase error ( `` ph '' ) .",
    "if f fails ( `` fail '' ) , we simply discard it .",
    "on the other hand , for the test pairs alice performs @xmath189-basis measurement on @xmath190 , and bob conducts the aforementioned `` p '' measurement and the projection `` q '' . as a result , we have four possible outcomes , @xmath191 , @xmath192 , @xmath193 , and @xmath194 .    ]",
    "consider @xmath195 such pairs of systems , and imagine that we repeat this set of measurements from the @xmath196 pair in order .",
    "let @xmath197 be the path that was actually taken by the @xmath198 pair . for @xmath199",
    ", define @xmath200 as the number of the pairs whose path include @xmath201 among the first @xmath147 pairs .",
    "furthermore , we define @xmath202 as @xmath203 , and specifically we write @xmath204 . with these parameters , we define @xmath205    our task is to derive a bound on @xmath180 as a function of other @xmath206 s that can be estimated from the data available in the actual protocol . to do so , we invoke the fact that we can assign a joint probability @xmath207 for every attack by eve , since all @xmath208 can be measured at the same time",
    ". then , we can apply a known classical theorem to @xmath209 . from @xmath209 , define conditional probability @xmath210 for @xmath211 to include @xmath201 conditioned on @xmath212 , and especially we define @xmath213 and @xmath214 .",
    "furthermore , we introduce @xmath215 as follows @xmath216 where @xmath217 .",
    "then , azuma s inequality @xcite states that , since @xmath218 is martingale @xcite and satisfies the bounded difference condition @xcite , it follows that for any @xmath219 and @xmath220 , @xmath221 holds @xcite for @xmath222 .    then , for the code pairs , by setting @xmath223 in eq .",
    "( [ azumafirst ] ) as @xmath224 , we have @xmath225 where @xmath226 , and similarly for the test pairs we have @xmath227 where @xmath228 .",
    "these inequalities guarantee that in the limit of large @xmath195 with @xmath184 being fixed , the normalized version of the sum of the probabilities @xmath229 differs from the actual ratio only with exponentially small probability .",
    "the next step is to find the relationship among the probabilities @xmath230 so that we have the relationship among the number of the actual events .",
    "let @xmath231 be the density operator of the @xmath232 pair conditioned on the previous outcomes @xmath212 .",
    "then @xmath230 can be expressed as @xmath233 , where povm element @xmath234 is defined as follows .",
    "@xmath235 here , @xmath236 , @xmath237 , and see eqs .",
    "( [ bit value ] ) and ( [ filter ] ) for the definitions of @xmath238 and @xmath239 , respectively .",
    "having @xmath231 and @xmath240 , now we can write down @xmath241 by using the corresponding povm element @xmath240 .",
    "we have little clue about the identity of @xmath231 , but we may find a relation @xmath242 which holds for any state @xmath231 . if we find such a convex function @xmath243 , it follows that @xmath244 , and we obtain a relation among @xmath245 through azuma s inequality .",
    "note that in the limit of @xmath246 , the above relation is simply @xmath247 .",
    "thus , the derivation of the relation among the conditional probabilities is the key point in deriving the inequality for the phase error estimation , which we present in appendix b.",
    "in this appendix , we derive the relation among the conditional probabilities @xmath233 . in",
    "what follows , we assume @xmath248 ( @xmath108 is the reflectivity of the beam splitter bs1 ) and @xmath249 . we note that in the actual experiment , these assumptions are well - justified , and even if these assumptions do not hold , we can construct the relationship by applying slight modifications .",
    "thus , these assumptions are not essential for the proof .",
    "since the relationship we derive in this appendix holds for any density matrix , we use the abbreviation @xmath250 , where @xmath251 is any density operator .",
    "let us introduce @xmath252 and @xmath253 @xmath254 as @xmath255 and @xmath256 , respectively . here ,",
    "@xmath257 ( the summation and multiplication are taken in modulo 2 ) .",
    "if we regard the subspace spanned by @xmath258 ( @xmath259 ) as a qubit , then the two bases , @xmath258 and @xmath260 , correspond to two directions in the bloch sphere with relative angle @xmath261 satisfying @xmath262 , and @xmath263 in @xmath264 $ ] . then , for any qubit state in the bloch sphere , we have @xmath265 where @xmath266 and @xmath267 .",
    "similarly we have @xmath268 where @xmath269 and @xmath270 .",
    "in addition , @xmath271 can be expressed as @xmath272\\\\ n_{{\\rm ph},\\nu}&=&g_{\\nu}\\left(\\alpha_{\\nu}^{2}n_{10,\\nu}+\\beta_{\\nu}^{2}n_{01,\\nu}\\right)\\label{nph}\\\\ n_{{\\rm bit } , \\nu}&=&\\frac{g_{\\nu}}{2}(m_{11,\\nu}+m_{01,\\nu})\\label{nbit}\\,.\\end{aligned}\\ ] ]    note that eqs .",
    "( [ ns])-([nph ] ) can be represented as @xmath273 where @xmath274    by solving eqs .",
    "( [ nbit ] ) , ( [ bloch ] ) , and ( [ matrixeq ] ) , we have an inequality @xmath275 here , @xmath61 and @xmath276 is given by @xmath277    we can overestimate @xmath278 by maximizing each entry of @xmath279 over @xmath280 $ ] to obtain @xmath281 as @xmath282 here , we have used the assumption that we choose @xmath188 such that @xmath283 , i.e. , @xmath284 , for any @xmath285 , leading to @xmath286 , @xmath287 , @xmath288 , @xmath289 , @xmath290 , @xmath291 , @xmath292 , and @xmath293 .",
    "furthermore , the condition @xmath249 gives us @xmath294 , and with the help of this inequality , we can slightly modify eq .",
    "( b9 ) as @xmath295 note that if @xmath284 and @xmath249 do not hold , it just changes the sign of the derivative functions .",
    "thus , even in that case , we can construct a matrix similar to eq .",
    "( [ cmatrix ] ) by applying appropriate modifications , such as the interchange of @xmath296 and @xmath297 .",
    "another remark is on our assumption @xmath298 and @xmath299 .",
    "note that when @xmath300 , this condition is approximately equivalent to @xmath301 , which is natural for standard experiments where bob almost never detects the photon number that is greater than the mean photon number emitted by alice due to the channel loss and non - unit quantum efficiency of the detectors .",
    "thus , in most of normal experiments , the assumptions hold .",
    "finally , we take summation over @xmath285 , and with the help of the concavity of the function @xmath302 , we have @xmath303 where @xmath304",
    "in this appendix , we first express eq .",
    "( [ eqeq2 ] ) in terms of the actual number of ratio , and then we give the estimation of the parameters appearing in the resulting inequality to obtain eq .",
    "( [ finalex ] ) .",
    "first , we apply azuma s inequality to @xmath305 . in the limit of large @xmath195",
    ", @xmath305 is transformed into the actual ratio of the corresponding events @xmath306 , and we have @xmath307 whereas for finite @xmath195 , we can bound the probability of violating ( a slightly relaxed version of ) eq .",
    "( [ eq2 ] ) using eq .",
    "( [ finite1 ] ) and eq .",
    "( [ finite2 ] ) .",
    "the next step is to give the estimation of the variables appearing in eq .",
    "( [ eq2 ] ) from the actually observed quantities in the experiment . by considering an inclusion relation on @xmath188 , @xmath308 can obviously be bounded as @xmath309 where we have used @xmath310 ( see eq .",
    "( [ lambda ] ) ) .",
    "similarly , @xmath311 is bounded as @xmath312 where we have defined @xmath313 as the number of the bit errors divided by @xmath314 and @xmath27 as that of the bit errors divided by @xmath314 with the condition @xmath97 .",
    "next , note that @xmath315 is the ratio of events of the successful qubit projection with the total photon number inside @xmath188 .",
    "this ratio is lower - bounded by the ratio of event @xmath28 where @xmath22 detects photons inside @xmath23 and the vacuum is detected by @xmath17 and @xmath19 in total , plus the ratio of event @xmath316 where @xmath22 detects photons inside @xmath23 and a single - photon is detected by @xmath17 and @xmath19 in total .",
    "thus , we have @xmath317    finally , @xmath318 is obviously upper - bounded by @xmath319 that is the ratio for alice to obtain @xmath320 in the test pairs . on the other hand , @xmath318 is lower - bounded from the worst case scenario where alice s x - basis measurement results in 1 for all the pairs that have resulted in bob s `` n '' . the ratio of this event is represented by @xmath321 , where @xmath322 is the test - pair - version of @xmath315 . by the same token as eq .",
    "( [ tildeeta ] ) , @xmath321 is no larger than @xmath323 where @xmath324 is the test - pair - version of @xmath131 , and @xmath325 and @xmath326 are the test - pair - version of @xmath28 and @xmath316 , respectively .",
    "hence , we have @xmath327 moreover , by applying the substitutions @xmath328 and @xmath329 to eq .",
    "( [ azumathird ] ) , we have @xmath330 for any @xmath220 and @xmath219 ( see eq .",
    "( [ alpha ] ) for the definition of @xmath331 ) .",
    "thus , we can bound @xmath318 by using the experimentally available data as @xmath332 which is violated with probability less than @xmath333 .    in summary , we have @xmath334 , where @xmath335 and @xmath336 , and the final expression is described as @xmath337 where we have decomposed @xmath133 such that @xmath134 includes only the nonnegative entries of @xmath135 .",
    "we remark that eq .",
    "( [ finalappendix ] ) uses two parameters @xmath338 and @xmath131 , whereas eq .",
    "( [ finalex ] ) uses only @xmath131",
    ". since @xmath338 and @xmath131 are the same parameter in different random samples , they must be very close to each other for large @xmath195 .",
    "hence it is also possible to measure only @xmath131 in the code pairs and estimate @xmath338 from that .",
    "but in practice , there is no additional overhead in determining @xmath338 , and thus it is always better to use eq .",
    "( [ finalappendix ] ) involving fewer numbers of estimations .",
    "hwang , phys .",
    "* 91 * , 057901 ( 2003 ) .",
    "lo , x. ma , k. chen , phys .",
    "* 94 * , 230504 ( 2005 ) .",
    "wang , phys .",
    "* 94 * , 230503 ( 2005 ) .",
    "x. ma , b. qi , y. zhao , and h .- k .",
    "lo , phys .",
    "a. * 72 * , 012326 ( 2005 ) .                          in k. tamaki , n. ltkenhaus , m. koashi , and j. batuwantudawe , arxiv : quant - ph/0607082v1 , instead of using the test pairs , we let alice perform the x - basis measurement on the pairs that have resulted in the failure filtering operation . that approach has led to a bound that is slightly different from eq .",
    "( [ finalex ] ) .      a sequence of random variables @xmath340",
    "is called a martingale iff the expectation of @xmath341 conditional on a realisation of the sequence of random variables @xmath342 is equal to @xmath343 , i.e. , @xmath344=x^{(s)}$ ] .",
    "note that @xmath344 $ ] can be regarded as a function of @xmath342 .",
    "one can show that @xmath345 is martingale as follows .",
    "first note that @xmath346 where @xmath347 is a random raviable satisfying @xmath348 iff we have the event @xmath349 , and @xmath350 otherwise",
    ". then , we have @xmath351\\nonumber\\\\ & = & e[\\xi_{\\omega , \\lambda}^{(s+1)}|x_{\\omega , \\lambda}^{(s ) } , x_{\\omega , \\lambda}^{(s-1)},\\cdots , x_{\\omega , \\lambda}^{(0)}]\\nonumber\\\\ & -&e[\\varsigma_{\\omega , \\lambda}^{(s+1)}|x_{\\omega , \\lambda}^{(s ) } , x_{\\omega , \\lambda}^{(s-1)},\\cdots , x_{\\omega , \\lambda}^{(0)}]\\nonumber\\\\ & + & e[x_{\\omega , \\lambda}^{(s)}|x_{\\omega , \\lambda}^{(s ) } , x_{\\omega , \\lambda}^{(s-1)},\\cdots , x_{\\omega , \\lambda}^{(0)}]\\nonumber\\\\ & = & \\varsigma_{\\omega , \\lambda}^{(s+1)}-\\varsigma_{\\omega , \\lambda}^{(s+1)}+x_{\\omega , \\lambda}^{(s)}\\nonumber\\\\ & = & x_{\\omega , \\lambda}^{(s)}\\nonumber\\,.\\end{aligned}\\ ] ]    a sequence of random variables @xmath342 is said to satisfy the bounded difference condition ( bdc ) if @xmath352 holds for any @xmath353 and positive @xmath354 . in our case , it is obvious that @xmath355 ."
  ],
  "abstract_text": [
    "<S> we prove the unconditional security of the original bennett 1992 protocol with strong reference pulse . we show that we may place a projection onto suitably defined qubit spaces before the receiver , which makes the analysis as simple as qubit - based protocols . </S>",
    "<S> unlike the single - photon - based qubits , the qubits identified in this scheme are almost surely detected by the receiver even after a lossy channel . </S>",
    "<S> this leads to the key generation rate that is proportional to the channel transmission rate for proper choices of experimental parameters .    ] </S>"
  ]
}