{
  "article_text": [
    "quantum metrology is positioned at the forefront of modern quantum sciences , spearheading the development of future quantum technologies . by utilizing the power of quantum mechanics to gain advantages over previously known techniques in practical tasks such as parameter estimation  @xcite ,",
    "state discrimination  @xcite , or hypothesis testing  @xcite , quantum - enhanced measurement procedures have already led to breakthrough discoveries  @xcite . moreover , nonclassical effects can be harnessed to enhance the precision of determining quantities of interest , including magnetic fields  @xcite , forces  @xcite , phases  @xcite , or frequencies  @xcite . for many different applications , the quantum advantage manifests as a quadratic scaling gap in terms of the relevant resources  @xcite , e.g. , the number of sensing systems , with respect to the best classical approaches .",
    "however , to achieve this so - called heisenberg scaling , different tasks require different resource states as well as different ( potentially non - local ) measurements , which have to be separately determined for any specific case , rendering the design of a universally applicable sensing device difficult",
    ". moreover , this still leaves open the important ( and often ignored ) question of how the desired states and measurements can be implemented efficiently .",
    "here we report on the design of a flexible device that allows one to obtain a quantum scaling advantage for a large class of different metrological problems by using only a specific entangled state and single - qubit operations .",
    "we show that a 2d cluster state  @xcite  a particular entangled state associated with a rectangular lattice that can be prepared by commuting , nearest - neighbour interactions among qubits on the lattice  allows achieving heisenberg scaling for an important group of paradigmatic metrology problems .",
    "this includes the sensing of local observables such as magnetic fields  @xcite , as well as the estimation of phases  @xcite , frequencies  @xcite , and certain interaction strengths  @xcite .",
    "crucially , we show that this can be done both in the local ( frequentist ) approach with arbitrarily many repetitions , where the quantum fisher information ( qfi ) is the relevant figure of merit , and in the ( single - shot ) bayesian approach for arbitrary cost functions and priors ( see , e.g. , ref .",
    "@xcite ) , including flat  @xcite and gaussian priors with varying width  @xcite .",
    "the optimal probe state for these different problems vary strongly , ranging from greenberger - horne - zeilinger ( ghz ) states in the case of local phase estimation , to certain superpositions of states with different hamming weights ( e.g. , with sine - shaped profiles for the coefficients  @xcite ) for bayesian phase estimation ( for flat priors ) .",
    "moreover , also the corresponding optimal measurements are vastly different , including simple local measurements for ghz states , but also complicated , entangled measurements on all qubits  @xcite , e.g. , discrete fourier basis measurements for bayesian estimation with flat priors  @xcite",
    ". in particular , some states and measurements may be significantly more difficult to realize than others .",
    "the 2d cluster state allows one to deal with all of these problems . on the one hand ,",
    "the fact that it is a universal resource for measurement - based quantum computation ( mbqc )  @xcite trivially enables arbitrary state preparation and measurements on a subset of the qubits in the cluster , provided the latter is large enough . on the other hand",
    ", mbqc provides a simple , unifying framework in which state preparation and measurements can be assigned an unambiguous resource cost in terms of the overall number of qubits in the cluster . to guarantee a quantum scaling advantage for",
    "metrological applications , the probe preparation and measurements must be efficiently executable .",
    "that is , any metrological scaling advantage is lost if the size of the cluster required for a given estimation strategy with an @xmath0-qubit probe grows as @xmath1 or stronger , in which case it becomes favourable to use all qubits in the cluster as individual , classical probes instead .",
    "we show that the preparation of optimal probe states and corresponding suitable measurements for local as well as bayesian phase and frequency estimation can indeed be carried out efficiently using 2d cluster states . for the local scenario ,",
    "we explicitly construct the preparation and measurement strategy achieving optimality .",
    "for the bayesian scenario , we present a construction that can generate all optimal probe states with a linear overhead in @xmath0 .",
    "we then introduce a compression procedure that can be implemented on a 2d cluster with @xmath2 qubits , which enables one to efficiently perform measurements even when the circuit descriptions of the corresponding unitaries are of exponential size in the number of qubits of the compressed space .",
    "these constructions allow achieving heisenberg scaling for phase and frequency estimation scenarios ( as well as for some setups beyond these paradigms ) using the 2d cluster in a flexible manner . to further illustrate these general results , we discuss a particular choice of probe states and measurements that can be efficiently implemented in our framework , for which heisenberg scaling can be achieved for gaussian priors of varying widths .",
    "this paper is structured as follows . in section  [ sec:2d cluster states as universal resources for phase and frequency estimation ] we first discuss the basic structure of parameter estimation problems and the general form of all optimal probe states .",
    "we then argue that 2d cluster states provide flexible resources to achieve heisenberg scaling in phase and frequency estimation problems by using an efficient compression to the subspace of the optimal probes . in section  [ sec : quantum advantage bayesian estimation main text ] we then show how heisenberg scaling can be achieved in bayesian phase ( and frequency ) estimation , before demonstrating in section  [ sec : efficient state preparation ] how the necessary probe states can be prepared in a measurement - based architecture consisting of @xmath3 qubits .",
    "finally , we introduce the explicit construction of the efficient compression algorithm required for the measurements in section  [ sec : efficient unary - to - binary compression ] . at last",
    ", we discuss our findings and their implications in section  [ sec : conclusion ] , including generalization to the estimation of quantities other than phases and frequencies .",
    "in typical parameter estimation procedures , one wishes to determine an unknown parameter @xmath4 that is not directly measurable . to this end , a probe state described by a density operator @xmath5",
    "is prepared , which undergoes a dynamical evolution governed by @xmath4 , encoding the parameter in the resulting state @xmath6 .",
    "the evolution can in principle be an arbitrary quantum channel but we are here mainly interested in pure states @xmath7 and unitary channels , where @xmath8 for a unitary @xmath9 generated by the hamiltonian . ]",
    "for example , in phase ( and frequency ) estimation , one considers a local hamiltonian for @xmath0 qubits , i.e. , @xmath11 and @xmath12 acts nontrivially only on the @xmath13th qubit .",
    "typically , one has @xmath14 where @xmath15 is the usual pauli operator , but other local hamiltonians can be brought to this form by local unitaries .",
    "after the encoding , a measurement of the probe state @xmath6 is performed , which can be represented by a positive - operator valued measure ( povm ) , i.e. , a set @xmath16 of positive ( semi - definite ) operators @xmath17 satisfying @xmath18 , where @xmath19 is the identity operator . for an introduction to povm measurements",
    "see , e.g. ,  @xcite or  @xcite .    from the measurement outcomes ,",
    "labelled @xmath20 , an estimate of the parameter in question can be obtained .",
    "the precise nature of the estimator depends on the type of estimation scenario , distinguishing , for example , between local and bayesian estimation .",
    "all these scenarios have in common that the precision of the estimation [ as quantified by some figure of merit , e.g. , the mean - square error ( mse ) ] improves with the number @xmath0 of probe systems . for classical strategies based on product states ,",
    "this increase is at most linear in @xmath0 , which is referred to as the standard quantum limit ( or shot noise scaling ) .",
    "however , using approaches based on the optimal quantum mechanical probes the improvement in this figure of merit can be quadratic in @xmath0 , i.e. , achieving ( optimal ) heisenberg scaling . for reviews of parameter estimation techniques and quantum metrology we direct the reader to , e.g. , refs .",
    "@xcite or the .    in local phase ( and frequency ) estimation one typically considers many repetitions of the same measurement that provide an estimate , whose variance one is interested in minimizing using the available resources . in this scenario ,",
    "the optimal @xmath0-qubit probe state is a ghz state @xmath21    and the accompanying optimal measurements are local @xmath22 measurements .",
    "this can be determined via the qfi , the relevant figure of merit for local estimation , as we explain in more detail in appendix  [ sec : local estimation ] . in bayesian parameter estimation ( see , e.g. , refs .",
    "@xcite or appendix  [ sec : bayesian estimation ] ) , the situation is somewhat different . here",
    "one quantifies the initial knowledge ( or belief ) about the parameter by a prior probability distribution that is updated after each single measurement . in this case",
    ", the figure of merit is the average variance of the updated distribution . in the bayesian estimation scenario ,",
    "the optimal probes and measurements depend on the shape of the prior and the cost function used .",
    "for instance , for phase estimation with flat priors ( i.e. , no prior knowledge ) , the optimal probe state achieving heisenberg scaling is given by @xmath23 where @xmath24 are eigenstates of @xmath25 corresponding to its @xmath26 different eigenvalues , and the coefficients @xmath27 have a sinusoidal profile ( see , e.g. , ref .",
    "@xcite ) , i.e. , @xmath28 although different from the optimal measurement , we find that for the state in eq .",
    "( [ eq : probe_state 2 ] ) a projective measurement in the basis obtained via the quantum fourier transform ( qft ) of the basis @xmath29 allows for heisenberg scaling for bayesian phase and frequency estimation with gaussian priors of varying widths , as we discuss in section  [ sec : quantum advantage bayesian estimation main text ] , as well as in appendices  [ sec : quantum advantage in bayesian estimation ] and  [ sec : bayesian frequency estimation in mbqc ] .    the crucial observation required to extend",
    "the applicability of this approach to arbitrary priors ( and cost functions ) lies in noticing that in @xmath0-qubit phase ( and frequency ) estimation scenarios of any kind , @xmath25 only has @xmath26 different eigenvalues for each of which a representative eigenstate needs to be selected .",
    "moreover , within the subspaces corresponding to fixed eigenvalues one may choose those eigenstates that can be prepared most efficiently . instead of the typical dicke states that are symmetric with respect to the exchange of the qubits , we therefore employ eigenstates",
    "corresponding to a unary encoding of @xmath30 , i.e. , @xmath31 all optimal probe states can hence be chosen to be of the form of eq .",
    "( [ eq : probe_state 2 ] ) with @xmath32 for some choice of the coefficients @xmath27 .",
    "most importantly , all of these probe states have support in an @xmath33-dimensional subspace of the @xmath34-dimensional overall hilbert space .",
    "therefore , the problem of optimal state preparation and measurements for @xmath0 qubits can be translated to that of @xmath35 qubits , provided that one can efficiently and coherently convert the unary encoding @xmath36 to a binary encoding in @xmath37 qubits . in section  [ sec : efficient unary - to - binary compression ] we present a quantum circuit of size @xmath2 ( and its mbqc representation ) achieving exactly such a unary - to - binary compression . on the logarithmically small space of these @xmath37 qubits",
    "the probe state preparation and measurement can then be carried out even with exponential overhead in @xmath37 while maintaining heisenberg scaling .",
    "the premise for taking advantage of the quadratic scaling gap in resources ( here , the number of qubits ) between the quantum strategy described in the previous section and the best classical strategy is that the required probe states and measurements can be implemented efficiently . here",
    ", we will take efficiency to mean that the overhead in the number of qubits used for the execution of the quantum strategy , including preparation and measurement , must grow less strongly than @xmath1 . to illustrate this requirement ,",
    "consider a situation where an array of qubits is provided and one is given the task of using the array most efficiently for the estimation of a parameter .",
    "this situation occurs , e.g. , when an array of spins used for quantum computation or quantum simulation is subject to stray magnetic fields with a fixed direction but unknown strength .",
    "if any arbitrary quantum state of these spin qubits can be prepared at no additional cost , then one can initialize a ghz state for local phase estimation , or the corresponding optimal state for another estimation problem such as , e.g. , bayesian phase estimation . as we have seen in the previous section ,",
    "states and measurements that offer advantages for different metrological problems are in general quite distinct , and the conversion from one to the other may involve arbitrarily long sequences of entangling operations . the preparation and measurement hence comes at a cost that we wish to quantify .",
    "an approach that allows for preparing arbitrary quantum states and performing any measurements on them , while naturally including a resource count for these tasks is mbqc . in this paradigm , introduced in ref .",
    "@xcite , an array of qubits is initialized in a particular ( entangled ) quantum state , typically a so - called cluster state  @xcite .",
    "a cluster state is a type of graph state , i.e. , it can be represented by a graph ( a set of vertices @xmath38 and edges @xmath39 connecting the vertices ) .",
    "each vertex represents a qubit initialized in the state @xmath40 , and controlled phase gates @xmath41 , given by @xmath42 are applied to each pair of qubits connected by an edge . for simplicity , we will here only consider 2d cluster states where the underlying graph is a regular , rectangular lattice , but in principle , also other graph states  @xcite could be considered for our purposes . by applying only single - qubit gates and carrying out local measurements on a        subset of all qubits in a 2d cluster , arbitrary unitary operations can be implemented on the remaining qubits  @xcite . performing a unitary transformation in the circuit model of quantum computation",
    "hence translates to a sequence of measurement angles for single - qubit measurements in the cluster . for a more detailed introduction to mbqc see refs .",
    "@xcite , or appendix  [ sec : measurement - based quantum computation ] .    in other words ,",
    "a number of the initial qubits can be sacrificed to obtain a probe state of fewer qubits , which is more suitable for a given metrological task at hand .",
    "note that using the unmodified cluster state as a probe state itself does not provide a scaling advantage with respect to classical strategies , i.e. , its qfi is @xmath3 .",
    "similarly , additional qubits can be used to implement arbitrary measurements by performing appropriate unitaries followed by computational basis measurements . here",
    ", one needs to ensure that only the part of the cluster used to prepare the probe state is subjected to the transformation encoding the parameter .",
    "this can be achieved , e.g. , by appropriately timed pauli-@xmath22 operations on the qubits used for the measurement at the middle and at the end of the interaction period .",
    "crucially , the overall number of qubits required for the preparation and measurement of this @xmath0-qubit probe state must grow less than quadratically with @xmath0 to maintain a potential metrological scaling advantage .",
    "this is possible , for instance , for local phase estimation , where the optimal measurement strategy can be carried out with @xmath43 qubits in a 1d cluster state as shown in fig .",
    "[ fig : local phase estimation in mbqc ] . as we will show next",
    ", such efficient constructions also exist for bayesian phase ( and frequency ) estimation problems . in section  [ sec : efficient state preparation ] , we demonstrate that all probe states ( including the optimal ones ) of the form of eq .",
    "( [ eq : probe_state 2 ] ) can be efficiently prepared from a 2d cluster state using only local operations . in section  [ sec : efficient unary - to - binary compression ] we then present the unary - to - binary compression requiring @xmath2 qubits of the cluster to reduce the problem of implementing optimal measurements to the subspace of @xmath35 qubits . on this subspace ,",
    "projective measurements in any basis can be carried out efficiently , provided that the unitary transformation relating it to a computational - basis measurement requires no more than @xmath44 ( nearest neighbour ) gates .",
    "this is the case , for instance , for the qft measurement , which performs optimally for flat priors  @xcite and achieves heisenberg scaling for gaussian priors of varying widths as we will show next .",
    "we now briefly discuss the bayesian phase estimation scenario , more details on which can be found in appendix  [ sec : bayesian estimation ] , and show that the combination of sine states and qft measurements can achieve heisenberg scaling .",
    "in bayesian parameter estimation , the initial knowledge about the parameter is encoded in a prior probability distribution @xmath45 , for instance , a gaussian given by @xmath46 when a measurement with povm elements @xmath16 is performed , the conditional probability of obtaining the outcome labelled @xmath20 is @xmath47 , whereas the unconditional probability to obtain this outcome is @xmath48 given the measurement outcome @xmath20 , an estimate @xmath49 is assigned to it , and the corresponding mse is @xmath50\\,=\\,\\int\\!d\\theta\\,p(\\theta|m)\\,\\bigl(\\theta-\\hat{\\theta}(m)\\bigr)^{2},\\end{aligned}\\ ] ] where the posterior @xmath51 is computed via bayes law .",
    "a useful figure of merit in this scenario is the average variance of the posterior , i.e. , @xmath52 . using the notation  @xcite @xmath53",
    "one then obtains the simple expression @xmath54 we then insert the probe states of eq .",
    "( [ eq : probe_state 2 ] ) with the sinusoidal profile of eq .",
    "( [ eq : berry wiseman state ] ) , and use the qft measurement represented by the basis @xmath55 , where @xmath56 to evaluate the average variance of the posterior for up to @xmath57 qubits , as illustrated in fig .",
    "[ fig : berry - wiseman main text ] .",
    "more details can     +    be found in appendix  [ sec : quantum advantage in bayesian estimation ] .",
    "the numerical results indicate that for narrow priors ( e.g. for @xmath58 ) the example quantum strategy exhibits heisenberg scaling .",
    "the bad performance of this measurement strategy for wider priors may be attributed to the use of the mse , as we elaborate on in appendix  [ sec : limitations of the mse approach ] .",
    "in this section we present a method that allows for the efficient preparation of the probe state of eq .",
    "( [ eq : probe_state 2 ] ) , which immediately generalizes to any state in the subspace of optimal probes spanned by @xmath59 .",
    "this method relies on the simple observation that in the bit - string @xmath60 representing the state @xmath61 i.e. , where @xmath62 and @xmath63 , the @xmath30 entries @xmath64 are always to the left of the entries @xmath65 . in other words , the @xmath66-th qubit can only be in the state @xmath67 , if the @xmath68 qubits before are also each in the state @xmath67 .",
    "focussing on the sine state of eq .",
    "( [ eq : berry wiseman state ] ) as an example , note that the probability amplitudes are all real and positive . initializing all qubits in the state @xmath69",
    ", the circuit preparing the sine state must hence be a cascade of @xmath0 ( controlled ) single - qubit @xmath70-rotations @xmath71 , whose angles @xmath72 determine the weights @xmath27 , see fig .",
    "[ fig : circuit for bw ] .",
    "this becomes apparent",
    "when inspecting the single - qubit pauli-@xmath70 rotations @xmath73          -\\sin\\bigl(\\tfrac{\\phi}{2}\\bigr )    &   \\cos\\bigl(\\tfrac{\\phi}{2}\\bigr )      \\end{pmatrix}\\,.\\end{aligned}\\ ] ] the action of the circuit in fig .",
    "[ fig : circuit for bw ] then transforms the @xmath66-th qubit to the state @xmath74 if the @xmath75-th qubit is in the state @xmath67 .",
    "all together , these @xmath0 rotations are parametrized by angles @xmath76 , such that both the sine and the cosine in the above expression are non - negative .",
    "it is straightforward to verify that the output of the circuit is the state of eq .",
    "( [ eq : probe_state 2 ] ) with amplitudes @xmath77 inverting eq .",
    "( [ eq : bw weights vs angles ] ) we may express the angles @xmath78 as @xmath79    * circuit preparing the sine state*. after an initial single - qubit @xmath70-rotation on the first qubit , a sequence of controlled @xmath70-rotations , where the black dots ( @xmath80 ) indicate the control qubits , creates a state of the form of eq .",
    "( [ eq : probe_state 2]).,scaledwidth=40.0% ]    which allows reconstructing the rotation angles for any real , non - negative choice of @xmath81 .    having found the circuit shown in fig .",
    "[ fig : circuit for bw ] , the only difficulty is to arrange the required measurements such that the overall preparation procedure can be embedded efficiently in a rectangular 2d structure , which is shown in appendix  [ sec : probe state preparation in mbqc ] .",
    "we hence arrive at the mbqc measurement pattern depicted in fig .",
    "[ fig : mbqc_pattern for bw state ] , which generates the sine state of eq .",
    "( [ eq : probe_state 2 ] ) with weights as in eq .",
    "( [ eq : berry wiseman state ] ) .",
    "it requires a square 2d cluster of ( at most ) @xmath82 qubits to prepare an @xmath0-qubit probe state .",
    "crucially , the number of qubits in the cluster increases only linearly with the size of the probe . moreover , any other probe state in the subspace spanned by the vectors @xmath59 can be prepared with the same efficiency in a similar way by replacing the pauli-@xmath70 rotations by other single - qubit unitaries .    * mbqc pattern for sine state*. in ( a ) the measurement pattern for the preparation of the sine state of eq .",
    "( [ eq : probe_state 2 ] ) is shown ( in part ) . the measurement angles",
    "@xmath83 @xmath84 determine the angle @xmath85 of the first rotation @xmath86 in fig .",
    "[ fig : circuit for bw ] , while the angles @xmath87 and @xmath88 are chosen to realize @xmath89 and @xmath90 , respectively , which combine with the @xmath41 gate of the cluster to realize the first controlled operation in fig .",
    "[ fig : circuit for bw ] . the initial hadamard gates to switch the qubits initialized in @xmath40 to @xmath69",
    "are also included in this measurement pattern .",
    "( b ) shows the pattern as part of an initial 2d cluster .",
    "assuming that each qubit in the cluster is initially connected to its nearest neighbours , the qubits indicated by isolated gray disks have to be disconnected from the remaining cluster by @xmath15-measurements .",
    "the qubits indicated by ( blue ) diamonds represent the probe state qubits , which are subsequently exposed to the transformation @xmath91.,scaledwidth=36.0% ]    next , we will show in section  [ sec : efficient unary - to - binary compression ] how a large class of useful measurements of the encoded probe states ( including the qft measurement ) can be carried out efficiently .",
    "finally , we turn to the implementation of the measurements required to achieve heisenberg scaling . in principle , the optimal measurement for a given prior and cost function may be an arbitrarily complicated measurement in an entangled basis of @xmath0-qubit states , for example , a projective measurement in the qft basis ( see , e.g. , ref .",
    "* chapter  5 ) or  @xcite ) .    ( a )",
    "+ ( b )    fortunately , closer inspection reveals that we do not require arbitrary measurements on @xmath0 but only on @xmath35 qubits , where the logarithm is understood to be to base @xmath92 .",
    "this is the case because all encoded information about the phase is stored within the @xmath93-dimensional subspace spanned by the vectors @xmath59 .",
    "all optimal measurements can hence be restricted to this subspace . to exploit this observation",
    ", we will now present an efficient algorithm that coherently compresses the information encoded in the probe state on the @xmath34-dimensional hilbert space of @xmath0 qubits to the exponentially smaller space of @xmath35 qubits .",
    "the principle of operation of this @xmath0-step compression algorithm , shown in fig .",
    "[ fig : unary to binary compression ]  ( a ) , is to switch from the unary encoding of the number @xmath30 in the state @xmath94 to a binary encoding of the same number via a unitary transformation and extend the result to superpositions of different states @xmath36 by linearity .",
    "the unary - to - binary conversion is achieved by successive binary addition of each bit in the string @xmath95 to the bit string of an auxiliary register of length @xmath37 initially representing the number @xmath96 .",
    "the corresponding qubits are initialized in the state @xmath97 in the @xmath66-th step of the procedure , the bit @xmath98 is added to the binary representation @xmath99 of the number @xmath100 , where @xmath101 for @xmath102 and @xmath103 for @xmath104 .",
    "the binary addition of @xmath98 to the least significant digit @xmath105 of @xmath106 is performed by a half adder circuit , see fig .",
    "[ fig : unary to binary compression ]  ( a ) .",
    "it , in turn consists of a cnot gate for the modulo-@xmath92 addition , producing the original value @xmath98 and the new binary digit @xmath107 , where @xmath108 denotes addition modulo @xmath92 .",
    "the cnot is preceded by a toffoli gate whose target is an additional auxiliary qubit which stores the carry bit ( see , e.g. , ref .",
    "@xcite for quantum arithmetic operations ) . this carry bit",
    "is then added to the next binary digit @xmath109 by another half adder .",
    "the procedure carries on until reaching the final binary digit @xmath110 , where the half adder can be replaced by a simple cnot gate , since the register size was chosen such that the final carry bit is always @xmath96 .",
    "subsequently , the qubits corresponding to the carry bits and @xmath98 have to be disentangled from the qubits carrying the binary encoding . for the carry bits ,",
    "this is achieved by another cascade of toffoli gates [ see fig .  [",
    "fig : unary to binary compression ]  ( a ) ] , since the carry bit can only have the value @xmath111 , if both of the previously added bits have the value @xmath111 as well . to coherently erase @xmath98 , note that the binary string @xmath112 encodes the number @xmath66 only if @xmath113 .",
    "we can hence flip the corresponding qubit conditioned on the binary encoding of @xmath66 using a generalized toffoli gate . using",
    "the already existing ancillas ( which have previoulsy been returned to the state @xmath69 ) , this multi - controlled cnot gate can be realized in a standard construction using @xmath114 nearest - neighbour ( nn ) swap gates , preceding and following an array of @xmath115 toffolis on three adjacent qubits along with a single cnot  @xcite .",
    "conditioning on states @xmath69 rather than @xmath67 requires at most @xmath116 additional single - qubit @xmath22 gates .",
    "having disentangled all other qubits from the @xmath37 qubits storing the binary encoding , we perform another @xmath37 nn swaps in anticipation of inputting the next unary digit @xmath117 .    taking into account that each toffoli or nn swap gate can be realized with a constant overhead in nn cnot and single - qubit gates",
    ", we find that the circuit for @xmath118 requires at most @xmath119 nn cnot and single - qubit gates .",
    "the entire unary - to - binary compression algorithm consists of @xmath0 such elements , resulting in a circuit size of @xmath120 on an input of length @xmath121 , which can hence be realized with at most @xmath2 qubits in mbqc , see fig .",
    "[ fig : unary to binary compression ]  ( b ) .    on the logarithmically sized ( in @xmath0 ) output , any measurement can then be performed efficiently as long as the corresponding unitary on @xmath35 qubits requires no more than @xmath122 nn gates . while this does not cover all possible unitaries ( e.g. , the construction discussed in ref .",
    "@xcite requires @xmath123 two - qubit and single - qubit gates ) , some particularly useful unitaries may be much less costly .",
    "for instance , an implementation of the qft on a @xmath37-qubit linear nearest - neighbour architecture presented in ref .",
    "@xcite has circuit size @xmath124 and depth @xmath119 , meaning an overhead of only @xmath125 qubits ( depth times input length ) in a measurement - based setting .",
    "in summary , we have shown that 2d architectures for mbqc provide flexible resources for quantum - enhanced metrology tasks .",
    "that is , an initial array of qubits prepared in a 2d cluster state and local operations are used to achieve heisenberg scaling for phase and frequency estimation in both the local ( frequentist ) and the bayesian approach to parameter estimation . in the bayesian scenario ,",
    "the preparation procedure presented can be applied to execute strategies with optimal states for arbitrary priors and cost functions .",
    "the efficient compression algorithm further allows to perform measurements with up to exponential circuit sizes .",
    "this includes the qft measurement that is optimal for flat priors , provides heisenberg scaling for gaussian priors of varying widths , and is expected to perform similarly well also for other priors under certain regularity conditions .    in principle , our results can be generalized also to scenarios beyond phase and frequency estimation . for all local hamiltonians that are not proportional to @xmath15",
    ", appropriate local corrections can be applied on the sensing qubits before and after the encoding such that the overall transformation commutes with the controlled phase gates used to create the cluster .",
    "for instance , when @xmath126 , hadamard gates before and after @xmath91 produce an encoding transformation that commutes with @xmath41 and can hence be applied after the entire cluster for sensing and measurements has been prepared . moreover , when the corresponding states and measurements giving heisenberg scaling are known , a similar method can also be employed for nonlocal interaction hamiltonians , provided that they are proportional to a product of pauli operators , or linear combinations of products of only one type of pauli operators .",
    "for example , for parameter estimation with ising - type couplings of the form @xmath127 , ghz states and local measurements achieve heisenberg scaling  @xcite , which can hence be efficiently implemented in our scheme .",
    "nonetheless , many interesting questions regarding the applicability to general dynamics and scaling beyond the heisenberg limit  @xcite remain in this context .",
    "our results are of practical significance since they suggest that a single platform , 2d cluster states , can be flexible enough for a plethora of precision - enhanced parameter estimation tasks . at the same time",
    ", this connection between computational and metrological resources provides interesting insights . the advantage in metrology is provided by the entanglement of the cluster state ,",
    "i.e. , the @xmath41 gates applied to neighbouring pairs of qubits , which ensures the improved performance with respect to an array of unentangled , individual qubits . at the same time",
    ", it is known that metrological advantages can , but need not arise solely from entanglement  @xcite .",
    "for example , nonclassicality in terms of squeezing can lead to heisenberg scaling in precision  @xcite without any entanglement when the average energy is considered as the resource .",
    "this work hence also contributes to the discussion of the required physical resources for parameter estimation  @xcite , and the relationship between computational power and metrology  @xcite .",
    "finally , open questions remain regarding the role of noise  @xcite , especially in connection with adaptive approaches to computation and error - correction involving metrology  @xcite .",
    "we leave such extensions for future work , along with the explicit determination of optimal  @xcite and  pretty good \" states  @xcite for specific metrological tasks in our framework .",
    "we are grateful to jan koodyski and markus tiersch for valuable discussions and comments .",
    "this work was supported by the austrian science fund ( fwf ) through grants no .",
    "sfb foqus f4012 and no .",
    "p28000-n27 , as well as dk alm : w1259 , the templeton world charity foundation grant no .",
    "twcf0078/ab46 , the swiss national science foundation grant no .",
    "p300p2_167749 , the spanish mineco through grant no .",
    "fis2013 - 40627-p , the generalitat de catalunya cirit contract 2014-sgr966 and by thermiq ( grant agreement 618074 ) .    99    m.  g.  a.  paris,_quantum estimation for quantum technology_,http://dx.doi.org/10.1142/s0219749909004839[int .",
    "j.  quantum  inf .",
    "* 7 * , 125 ( 2009 ) ] .",
    "v.  giovanetti , s.  lloyd , and l.  maccone,_advances in quantum metrology_,http://dx.doi.org/10.1038/nphoton.2011.35[nat .",
    "photon .  * 5 * , 222 ( 2011 ) ] .",
    "g.  tth and i.  apellaniz,_quantum metrology from a quantum information science perspective_,http://dx.doi.org/10.1088/1751 - 8113/47/42/424006[j .",
    "phys .  a:]http://dx.doi.org/10.1088/1751 - 8113/47/42/424006[math .",
    "theor .  * 47 * , 424006 ( 2014 ) ] .",
    "r.  demkowicz - dobrzaski , m.  jarzyna , and j.  koodyski,_quantum limits in optical interferometry_,http://dx.doi.org/10.1016/bs.po.2015.02.003[prog .",
    "optics  * 60 * , 345 ( 2015 ) ] .",
    "k.  m.  r.  audenaert , j.  calsamiglia , ll .",
    "masanes , r.  muoz - tapia , a.  ac@xmath128n , e.  bagan , and f.  verstraete,_discriminating states : the quantum chernoff bound_,http://dx.doi.org/10.1103/physrevlett.98.160501[phys .",
    "98 * , 160501 ( 2007 ) ] . k.  m.  r.  audenaert , m.  nussbaum , a.  szkoa , and f.  verstraete,_asymptotic error rates in quantum hypothesis testing_,http://dx.doi.org/10.1007/s00220 - 008 - 0417 - 5[commun .  math .  phys .  *",
    "279 * , 251 ( 2008 ) ] .",
    "m.  tsang , r.  nair , and x .- m .",
    "lu,_quantum theory of superresolution for two incoherent optical point sources_,http://dx.doi.org/10.1103/physrevx.6.031033[phys .",
    "x  * 6 * , 031033 ( 2016 ) ] .",
    "b.  p.  abbott  _ et al_.  ( ligo scientific collaboration and virgo collaboration),_observation of gravitational waves from a binary black hole merger_,http://dx.doi.org/10.1103/physrevlett.116.061102[phys .",
    "rev.]http://dx.doi.org/10.1103/physrevlett.116.061102[lett .  *",
    "116 * , 061102 ( 2016 ) ] .",
    "b.  p.  abbott  _ et al_.  ( ligo scientific collaboration and virgo collaboration),_gw151226 : observation of gravitational waves from a 22-solar - mass binary black hole coalescence_,http://dx.doi.org/10.1103/physrevlett.116.241103[phys .  rev .  lett .  * 116 * , 241103 ( 2016 ) ] .",
    "w.  wasilewski , k.  jensen , h.  krauter , j.  j.  renema , m.  v.  balabas , and e.  s.  polzik,_quantum noise limited and entanglement - assisted magnetometry_,http://dx.doi.org/10.1103/physrevlett.104.133601[phys .",
    "rev.]http://dx.doi.org/10.1103/physrevlett.104.133601[lett .",
    "* 104 * , 133601 ( 2010 ) ] . c.  d.  aiello , m.  hirose , and p.  cappellaro,_composite - pulse magnetometry with a solid - state quantum sensor_,http://dx.doi.org/10.1038/ncomms2375[nat .",
    "commun .  * 4 * , 1419 ( 2013 ) ] .",
    "s.  mancini and p.  tombesi,_high - sensitivity force measurement using entangled probes_,http://dx.doi.org/10.1209/epl / i2003 - 00237 - 5[europhys .",
    "lett .  * 61 * , 8 ] http://dx.doi.org/10.1209/epl/i2003-00237-5[(2003 ) ] .",
    "r.  fermani , s.  mancini , and p.  tombesi,_quantum limited force measurement in a cavityless optomechanical system_,http://dx.doi.org/10.1103/physreva.70.045801[phys .",
    "rev .  a  * 70 * , 045801 ( 2004 ) ] .",
    "m.  w.  mitchell , j.  s.  lundeen , and a.  m.  steinberg,_super - resolving phase measurements with a multiphoton entangled state_,http://dx.doi.org/10.1038/nature02493[nature  * 429 * , 161 ( 2004 ) ] .",
    "pan , z .- b .",
    "chen , c .- y .",
    "lu , h.  weinfurter , a.  zeilinger , and m.  ukowski,_multi - photon entanglement and interferometry_,http://dx.doi.org/10.1103/revmodphys.84.777[rev .",
    "phys .  * 84 * , 777 ( 2012 ) ] .",
    "d.  j.  wineland , j.  j.  bollinger , w.  m.  itano , f.  l.  moore , and d.  j.  heinzen,_spin squeezing and reduced quantum noise in spectroscopy_,http://dx.doi.org/10.1103/physreva.46.r6797[phys .",
    "rev .  a  * 46 * , r6797 ( 1992 ) ] .",
    "j.  j.  bollinger , w.  m.  itano , d.  j.  wineland , and j.  j.  heinzen,_optimal frequency measurements with maximally correlated states_,http://dx.doi.org/10.1103/physreva.54.r4649[phys .",
    "rev .  a  * 54 * , r4649 ] http://dx.doi.org/10.1103/physreva.54.r4649[(1996 ) ] .",
    "m.  chwalla , k.  kim , t.  monz , p.  schindler , m.  riebe , c.  f.  roos , and r.  blatt,_precision spectroscopy with two correlated atoms_,http://dx.doi.org/10.1007/s00340 - 007 - 2867 - 4[appl .",
    "phys .  b  * 89 * , 483 - 488 ( 2007 ) ] .",
    "v.  giovanetti , s.  lloyd , and l.  maccone,_quantum - enhanced measurements : beating the standard quantum limit_,http://dx.doi.org/10.1126/science.1104149[science  * 306 * , 1330 ( 2004 ) ] .",
    "d.  w.  berry and h.  m.  wiseman,_optimal states and almost optimal adaptive measurements for quantum interferometry_,http://dx.doi.org/10.1103/physrevlett.85.5098[phys .",
    "85 * , 5098 ( 2000 ) ] .",
    "e.  bagan , m.  baig , and r.  muoz - tapia,_quantum reverse engineering and reference - frame alignment without nonlocal correlations_,http://dx.doi.org/10.1103/physreva.70.030301[phys .",
    "rev .  a  * 70 * , 030301 ( 2004 ) ] . g.  chiribella , g.  m.  dariano , p.  perinotti , and m.  f.  sacchi,_efficient use of quantum resources for the transmission of a reference frame_,http://dx.doi.org/10.1103/physrevlett.93.180503[phys .  rev .",
    "93 * , ] http://dx.doi.org/10.1103/physrevlett.93.180503[180503 ( 2004 ) ] . m.  van  den  nest , a.  miyake , w.  dr , and h.  j.  briegel,_universal resources for measurement - based quantum computation_,http://dx.doi.org/10.1103/physrevlett.97.150504[phys .  rev .",
    "lett .  * 97 * , 150504 ( 2006 ) ] . h.  wunderlich , c.  wunderlich , k.  singer , and f.  schmidt - kaler,_two - dimensional cluster - state preparation with linear ion traps_,http://dx.doi.org/10.1103/physreva.79.052324[phys .  rev .  a  * 79 * , 052324 ] http://dx.doi.org/10.1103/physreva.79.052324[(2009 ) ] .",
    "m.  skotiniotis , p.  sekatski , and w.  dr,_quantum metrology for the ising hamiltonian with transverse magnetic field_,http://dx.doi.org/10.1088/1367 - 2630/17/7/073032[new  j.  phys.]http://dx.doi.org/10.1088/1367 - 2630/17/7/073032[*17 * , 073032 ( 2015 ) ] .",
    "m.  jarzyna and r.  demkowicz - dobrzaski,_true precision limits in quantum metrology_,http://dx.doi.org/10.1088/1367 - 2630/17/1/013010[new  j.  phys .",
    "* 17 * , ] http://dx.doi.org/10.1088/1367-2630/17/1/013010[013010 ( 2015 ) ] .",
    "k.  macieszczak , m.  fraas , and r.  demkowicz - dobrzaski,_bayesian quantum frequency estimation in presence of collective dephasing_,http://dx.doi.org/10.1088/1367 - 2630/16/11/113002[new  j.  phys .",
    "* 16 * , 113002 ] http://dx.doi.org/10.1088/1367-2630/16/11/113002[(2014 ) ] .",
    "r.  demkowicz - dobrzaski,_beyond quantum fisher information : optimal phase estimation with arbitrary a priori knowledge_,http://dx.doi.org/10.1103/physreva.83.061802[phys .",
    "rev .  a  * 83 * , 061802(r ) ( 2011 ) ] .",
    "g.  chiribella , g.  m.  dariano , p.  perinotti , and m.  f.  sacchi,_covariant quantum measurements which maximize the likelihood_,http://dx.doi.org/10.1103/physreva.70.062105[phys .",
    "rev .  a  * 70 * , 062105 ( 2004 ) ] . g.  chiribella , g.  m.  dariano , and m.  f.  sacchi,_optimal estimation of group transformations using entanglement_,http://dx.doi.org/10.1103/physreva.72.042338[phys .",
    "rev .  a  * 72 * , 042338 ( 2005 ) ] .",
    "m.  a.  nielsen and i.  l.  chuang,_quantum computation and quantum information _",
    "( cambridge university press , cambridge , u.k . , 2000 ) .",
    "m.  g.  a.  paris,_the modern tools of quantum mechanics ( a tutorial on quantum states , measurements , and operations)_,http://dx.doi.org/10.1140/epjst / e2012 - 01535 - 1[eur .",
    "j.  s.  t.  * 203 * , 61 ( 2012 ) ] .",
    "s.  d.  personick,_application of quantum estimation theory to analog communication over quantum channels_,http://dx.doi.org/10.1109/tit.1971.1054643[ieee  t.  inform .",
    "theory  * 17 * , 240 ( 1971 ) ] .",
    "r.  raussendorf and h.  j.  briegel,_a one - way quantum computer_,http://dx.doi.org/10.1103/physrevlett.86.5188[phys .",
    "86 * , 5188 ( 2001 ) ] .",
    "h.  j.  briegel and r.  raussendorf,_persistent entanglement in arrays of interacting particles_,http://dx.doi.org/10.1103/physrevlett.86.910[phys .",
    "lett.]http://dx.doi.org/10.1103/physrevlett.86.910[*86 * , 910 ( 2001 ) ] .",
    "m.  hein , w.  dr , j.  eisert , r.  raussendorf , m.  van  den  nest , and h.  j.  briegel,_entanglement in graph states and its applications_,in _ quantum computers , algorithms and chaos _ , http://dx.doi.org/10.3254/978-1-61499-018-5-115[proc .",
    "school phys .  ",
    "en- ] http://dx.doi.org/10.3254/978-1-61499-018-5-115[rico fermi \" * 162 * , 115 ( 2006 ) ] .",
    "d.  e.  browne and h.  j.  briegel,_one - way quantum computation - a tutorial introduction_,e - print http://arxiv.org / abs / quant - ph/0603226[arxiv : quant- ] http://arxiv.org/abs/quant-ph/0603226[ph/0603226 ] ( 2006 ) .",
    "h.  j.  briegel , d.  e.  browne , w.  dr , r.  raussendorf , and m.  van  den  nest,_measurement - based quantum computation_,http://dx.doi.org/10.1038/nphys1157[nat .",
    "phys .  * 5 * , 19 ( 2009 ) ] .",
    "l.  viola , e.  knill , and s.  lloyd,_dynamical decoupling of open quantum systems_,http://dx.doi.org/10.1103/physrevlett.82.2417[phys .",
    "lett .  * 82 * , 2417 - 2421 ( 1999 ) ] .",
    "r.  cleve and j.  watrous,_fast parallel circuits for the quantum fourier transform_,in foundations of computer science , http://dx.doi.org/10.1109/sfcs.2000.892140[proc .",
    "41st  ieee  symp .",
    "sc.,]http://dx.doi.org/10.1109/sfcs.2000.892140[526536 ( 2000 ) ] .",
    "y.  takahashi , n.  kunihiro , and k.  ohta,_the quantum fourier transform on a linear nearest neighbor architecture_,http://www.rintonpress.com / journals / qiconline.html#v7n4[quant .",
    "* 7 * , 383 ( 2007 ) ] .",
    "v.  vedral , a.  barenco , a.  ekert,_quantum networks for elementary arithmetic operations_,http://dx.doi.org/10.1103/physreva.54.147[phys .",
    "rev .  a  * 54 * , 147 ] http://dx.doi.org/10.1103/physreva.54.147[(1996 ) ] .",
    "s.  a.  cuccaro , t.  g.  draper , s.  a.  kutin , and d.  p.  moulton,_a new quantum ripple - carry addition circuit_,e - print https://arxiv.org/abs/quant-ph/0410184[arxiv:quant-ph/0410184 ] ( 2004 ) .",
    "e.  pius,_parallel quantum computing : from theory to practice_,http://hdl.handle.net/1842/15857[ph.d .",
    "thesis , university of edinburgh , 2015 ] .",
    "s.  boixo , s.  t.  flammia , c.  m.  caves , and j.  m.  geremia,_generalized limits for single - parameter quantum estimation_,http://dx.doi.org/10.1103/physrevlett.98.090401[phys .",
    "lett .  * 98 * , 090401 ( 2007 ) ] .",
    "s.  m.  roy and s.  l.  braunstein,_exponentially enhanced quantum metrology_,http://dx.doi.org/10.1103/physrevlett.100.220501[phys .",
    "* 100 * , ] http://dx.doi.org/10.1103/physrevlett.100.220501[220501 ( 2008 ) ] .",
    "m.  napolitano , m.  koschorreck , b.  dubost , n.  behbood , r.  j.  sewell , and m.  w.  mitchell,_interaction - based quantum metrology showing scaling beyond the heisenberg limit_,http://dx.doi.org/10.1038/nature09778[nature  ( london )  * 471 * , ] http://dx.doi.org/10.1038/nature09778[486 ( 2011 ) ] [ http://arxiv.org/abs/1012.5787[arxiv:1012.5787 ] ] .",
    "a.  luis,_quantum - limited metrology with nonlinear detection schemes_,http://dx.doi.org/10.1117/6.0000007[spie  rev .  * 1 * , 018006 ( 2010 ) ] . .",
    "rivas and a.  luis,_precision quantum metrology and nonclassicality in linear and nonlinear detection schemes_,http://dx.doi.org/10.1103/physrevlett.105.010403[phys .",
    "lett .  * 105 * , 010403 ( 2010 ) ] .",
    "s.  boixo , a.  datta , m.  j.  davis , s.  t.  flammia , a.  shaji , and c.  m.  caves,_quantum metrology : dynamics versus entanglement_,http://dx.doi.org/10.1103/physrevlett.101.040403[phys .",
    "* 101 * , 040403 ( 2008 ) ] .",
    "j.  sahota and n.  quesada,_quantum correlations in optical metrology : heisenberg - limited phase estimation without mode entanglement_,http://dx.doi.org/10.1103/physreva.91.013808[phys .",
    "rev .  a  * 91 * , 013808 ] http://dx.doi.org/10.1103/physreva.91.013808[(2015 ) ] .",
    "p.  kok , j.  dunningham , and j.  f.  ralph,_quantum estimation of coupled parameters and the role of entanglement_,e - print http://arxiv.org/abs/1505.06321[arxiv:1505.06321 ] [ quant - ph ] ( 2015 ) .",
    "r.  gaiba and m.  g.  a.  paris,_squeezed vacuum as a universal quantum probe_,http://dx.doi.org/10.1016/j.physleta.2009.01.026[phys .",
    "lett .  a  * 373 * , 934 ( 2009 ) ] .",
    "n.  friis , m.  skotiniotis , i.  fuentes , and w.  dr,_heisenberg scaling in gaussian quantum metrology_,http://dx.doi.org/10.1103/physreva.92.022106[phys .",
    "rev.]http://dx.doi.org/10.1103/physreva.92.022106[a  * 92 * , 022106 ( 2015 ) ]  [ http://arxiv.org/abs/1502.07654[arxiv:1502.07654 ] ] .",
    "j.  sahota , n.  quesada , and d.  f.  v.  james,_physical resources for quantum - enhanced phase estimation_,http://dx.doi.org/10.1103/physreva.94.033817[phys.]http://dx.doi.org/10.1103/physreva.94.033817[rev .",
    "a  * 94 * , 033817 ( 2016 ) ] .",
    "r.  demkowicz - dobrzaski and m.  markiewicz,_quantum computation speedup limits from quantum metrological precision bounds_,https://doi.org/10.1103/physreva.91.062322[phys .  rev .",
    "a  * 91 * , 062322 ( 2015 ) ] .",
    "b.  m.  escher , r.  l.  de  matos  filho , l.  davidovich,_general framework for estimating the ultimate precision limit in noisy quantum - enhanced metrology_,http://dx.doi.org/10.1038/nphys1958[nat .",
    "* 7 * , 406 ] http://dx.doi.org/10.1038/nphys1958[(2011 ) ] .",
    "r.  demkowicz - dobrzaski , j.  koodyski , and m.  gu,_the elusive heisenberg limit in quantum - enhanced metrology_,http://dx.doi.org/10.1038/ncomms2067[nat .",
    "commun .  * 3 * , 1063 ( 2012 ) ] . s.  i.  knysh , e.  h.  chen , and g.  a.  durkin,_true limits to precision via unique quantum probe_,e - print http://arxiv.org/abs/1402.0495[arxiv:1402.0495 ] [ quant - ph ] ( 2014 ) .",
    "w.  dr , m.  skotiniotis , f.  frwis , and b.  kraus,_improved quantum metrology using quantum error - correction_,http://dx.doi.org/10.1103/physrevlett.112.080801[phys .",
    "lett .  * 112 * , 080801 ( 2014 ) ] .",
    "p.  sekatski , m.  skotiniotis , and w.  dr,_dynamical decoupling leads to improved scaling in noisy quantum metrology_,http://dx.doi.org/10.1088/1367 - 2630/18/7/073034[new  j.  phys .  *",
    "18 * , 073034 ( 2016 ) ] .",
    "p.  sekatski , m.  skotiniotis , j.  koodyski , and w.  dr,_quantum metrology with full and fast quantum control_,e - print http://arxiv.org/abs/1603.08944[arxiv:1603.08944 ] [ quant - ph ] ( 2016 ) .",
    "j.  combes , c.  ferrie , c.  cesare , m.  tiersch , g.  j.  milburn , h.  j.  briegel , and c.  m.  caves,_in - situ characterization of quantum devices with error correction_,e - print http://arxiv.org/abs/1405.5656[arxiv:1405.5656 ] [ quant - ph ] ( 2014 ) .",
    "d.  orsucci , m.  tiersch , and h.  j.  briegel,_estimation of coherent error sources from stabilizer measurements_,http://dx.doi.org/10.1103/physreva.93.042303[phys .",
    "rev .  a  * 93 * , 042303 ( 2016 ) ] .",
    "s.  pirandola and c.  lupo,_ultimate precision of adaptive quantum metrology_,e - print http://arxiv.org/abs/1609.02160[arxiv:1609.02160 ] [ quant - ph ] ( 2016 ) .",
    "b.  c.  sanders , g.  j.  milburn , and z.  zhang,_optimal quantum measurements for phase - shift estimation in optical interferometry_,http://dx.doi.org/10.1080/09500349708230739[j .",
    "44 * , 1309 ( 1997 ) ] .",
    "f.  frwis , m.  skotiniotis , b.  kraus , and w.  dr,_optimal quantum states for frequency estimation_,http://dx.doi.org/10.1088/1367 - 2630/16/8/083010[new  j.  phys.]http://dx.doi.org/10.1088/1367 - 2630/16/8/083010[*16 * , 083010 ( 2014 ) ] .",
    "m.  skotiniotis , f.  frwis , w.  dr , and b.  kraus,_algebraic metrology : pretty good states and bounds_,http://dx.doi.org/10.1103/physreva.92.022323[phys.]http://dx.doi.org/10.1103/physreva.92.022323[rev .",
    "a  * 92 * , 022323 ( 2015 ) ] .",
    "* table of contents * +            we consider a typical parameter estimation scenario , where @xmath4 , the quantity of interest , is encoded in a density operator @xmath6 by a dynamical ( unitary ) transformation @xmath129 , i.e. , @xmath130 we then perform a measurement with povm elements @xmath16 which yields an outcome @xmath20 .",
    "the ( conditional ) probability of obtaining the measurement outcome @xmath20 ( given that the parameter has the value @xmath4 ) is then @xmath131 to each measurement outcome @xmath20 , an estimator @xmath49 assigns a corresponding estimate for the value of @xmath4 .",
    "the estimator is called _ unbiased _ if it assigns the true value on average , that is , if the expected value of the estimator satisfies @xmath132 this requirement ensures the _ accuracy _ of the measurement procedure , but not its _ precision _ , which is determined by the variance @xmath133 $ ] of the estimator .",
    "we use the mean - square error ( mse ) given by @xmath134    & = \\,\\sum\\limits_{m}p(m|{\\ensuremath{\\hspace*{0.5pt}}}\\theta{\\ensuremath{\\hspace*{0.5pt}}})\\,\\bigl(\\hat{\\theta}(m)-\\theta\\bigr)^{2}\\ , ,      \\label{eq : mse variance local estimation}\\end{aligned}\\ ] ] and @xmath135}$ ] is the associated standard deviation .",
    "unfortunately , it is often the case that a given estimator offers high precision only within a small range of the parameter @xmath4 , but not globally , as we shall discuss for a simple example in appendix  [ sec : local metrology using ghz states ] .",
    "such estimators are hence useful _ locally _ ,",
    "i.e. , for estimating small fluctuations of the parameter around some known value . in such local estimation scenarios ,",
    "accuracy is guaranteed even when unbiasedness as specified in eq .",
    "( [ eq : unbiasdness condition ] ) is required to hold only in the vicinity of this value .    to increase the precision , the procedure consisting of preparation , encoding , and measurement",
    "may be repeated a number of times , say @xmath136 , providing estimates @xmath137 @xmath138 , from which the mean value @xmath139 and the associated mse @xmath140     & = \\,\\frac{1}{\\nu}\\sum\\limits_{i=1}^{\\nu}\\bigl(\\theta^{(i)}-\\bar{\\theta}_{\\nu}\\bigr)^{2}\\end{aligned}\\ ] ] can be calculated . as @xmath136 increases ,",
    "the mean and variance computed from the measurement data converge to the expected value @xmath141 of the estimates and the expected value of the corresponding variance , @xmath133 $ ] , respectively .",
    "trusting that the results of the individual runs are independent and identically distributed ( i.i.d . ) , the variance of the distribution of mean values with @xmath136 samples decreases linearly with @xmath136 . the overall expected precision associated to the result @xmath142 is hence quantified by the standard error of the mean , given by @xmath143/\\nu}$ ] . in other words , the precision increases with the number of runs , but the options for choosing a probe state , measurement , and estimator still leave room for improvement .",
    "it is here that measurement strategies using genuine quantum features such as entanglement and nonclassicality can provide advantages with respect to classical strategies . to determine the potential gain and to allow comparisons with the best classical protocol it is useful to eliminate the choice of estimator , and consider the important cramr - rao bound , before discussing an example estimation scenario in appendix  [ sec : local metrology using ghz states ] .      for any unbiased estimator the variance @xmath133 $ ]",
    "can be shown ( see , e.g. , refs .",
    "@xcite or appendix  [ sec : cramer rao bound proof ] ) to satisfy the _ cramr - rao _ ( cr ) inequality @xmath134    & \\geq\\,\\frac{1}{i\\bigl(\\rho(\\theta)\\bigr)}\\ , ,      \\label{eq : cramer rao bound}\\end{aligned}\\ ] ] where @xmath144 is the _ fisher information _ ( fi ) given by @xmath145      & = \\,\\sum\\limits_{m}\\frac{\\bigl({\\textnormal{tr}}[e_{m}{\\ensuremath{\\hspace*{0.5pt}}}\\dot{\\rho}(\\theta)]\\bigr)^{2}}{{\\textnormal{tr}}\\bigl(e_{m}{\\ensuremath{\\hspace*{0.5pt}}}\\rho(\\theta)\\bigr)}\\ , .",
    "\\label{eq : fisher information}\\end{aligned}\\ ] ] here it is noteworthy that , on the one hand , the fi does not depend on the choice of the estimator ( as long as it is unbiased ) , and one can hence determine a lower bound for the variance based solely on the initial state and the chosen measurement .",
    "on the other hand , the fi typically depends on the value of the true value of the parameter and an unbiased estimator for which the cr inequality globally becomes an equality may not exist for all values .",
    "however , estimators can be found for which the bound is tight locally , and globally in the asymptotic limit of @xmath146 , see , e.g. , ref .",
    "@xcite .",
    "one may then further ask , what the optimal measurement strategy is for a given probe state and parameter encoding .",
    "the maximization of the fi over all possible povms then yields ( see , e.g. ,  @xcite ) the _ quantum fisher information _ ( qfi ) @xmath147 , given by @xmath148 where the operator @xmath149 $ ] , called the _ symmetric logarithmic derivative _ ( sld ) is implicitly given by the relation @xmath150 and where the dot indicates the partial derivative with respect to @xmath4 , i.e. , @xmath151 .",
    "the corresponding quantum _ cramr - rao _ bound is hence simply @xmath133\\geq1/\\mathcal{i}\\bigl(\\rho(\\theta)\\bigr)$ ] .",
    "the optimal measurement for which the fi and the qfi coincide is a projective measurement in the eigenbasis of the sld @xmath152  @xcite .    for unitary encodings that we consider here ,",
    "( [ eq : unitary encoding appendix ] ) , the qfi is independent of the value of the parameter , @xmath153 . to see this , simply note that in such a case @xmath154 and @xmath155}}\\,.\\end{aligned}\\ ] ] therefore the derivative appearing in the qfi in eq .",
    "( [ eq : quantum fisher information ] ) is just @xmath156 . using eq .",
    "( [ eq : sld ] ) one then finds that the slds are related in the same way , i.e. , @xmath157 . cyclically permuting the unitary operators in the trace",
    "then gives the result , @xmath158 .",
    "if we additionally restrict to pure probe states @xmath159 as before , the qfi takes the simple form ( see , e.g. , ref .",
    "@xcite ) @xmath160 where @xmath161 is the encoded state and the dot indicates a partial derivative with respect to @xmath4 . since @xmath162",
    ", a simple computation then reveals that the qfi for such scenarios is proportional to the variance of the hamiltonian generating the dynamics , i.e. , @xmath163 and the sld coincides with @xmath164 .",
    "the qfi is hence maximal for pure states that maximize the variance of @xmath25 , see , e.g. , refs .  @xcite .",
    "let us now consider an estimation scenario where a probe state of @xmath0 qubits is subject to a local transformation , i.e. , where the hamiltonian is of the form @xmath165 and @xmath12 acts nontrivially only on the @xmath13th qubit .",
    "for simplicity , we assume that each qubit undergoes the same local transformation , @xmath166 , and that the local hamiltonian has eigenvalues , and can hence be absorbed into @xmath4 . ]",
    "@xmath167 with the corresponding eigenstates denoted by @xmath69 and @xmath67 .",
    "we may further align our reference frame such that @xmath168 , where @xmath169 is the spin-@xmath170 angular momentum operator for direction @xmath171 and @xmath172 denote the usual pauli operators .",
    "a comment on estimation scenarios for other hamiltonians can be found in section  [ sec : conclusion ] of the main text , but here we are restricting our discussion to phase estimation scenarios where @xmath173 , such that @xmath174 acts only on the @xmath30th qubit .",
    "for ease of notation , we will drop the superscript @xmath175 in the following when referring to single - qubit operations and there is no risk of confusion .",
    "if the probe state is classical , i.e. , a product state of the form @xmath176 , then the qfi becomes maximal when the local single - qubit probe states are all chosen to be @xmath177 , maximizing the variance of @xmath178 . from eq .",
    "( [ eq : pure state unitary encoding fisher h ] ) it then follows immediately that the largest possible value of the qfi for a classical probe of @xmath0 qubits is @xmath179 the corresponding sld is easily found to be @xmath180 , i.e. , the optimal measurement is realized by single - qubit projective measurements in the basis @xmath181 , where @xmath182 are the eigenstates of @xmath183 .",
    "it hence becomes obvious that classical measurement strategies can ( at most ) decrease the variance linearly with the number of qubits .",
    "this scaling behaviour is referred to as the _ standard quantum limit_. as we shall discuss next , a different scaling behaviour can be achieved for quantum probes .      in this section",
    "we present a proof of the cramr - rao bound of eq .",
    "( [ eq : cramer rao bound ] ) following refs .  @xcite . for an unbiased estimator @xmath49 , we can write the unbiasedness condition of eq .",
    "( [ eq : unbiasdness condition ] ) as @xmath184 where we have used that the conditional probability is normalized , i.e. , @xmath185 . differentiating the condition of eq .",
    "( [ eq : unbiasdness condition appendix ] ) with respect to the parameter we have @xmath186 which we can rewrite as @xmath187 then , we define the quantities @xmath188 and @xmath189 and use the cauchy - schwarz inequality @xmath190 to arrive at @xmath191 the first factor on the left - hand side of eq .",
    "( [ eq : cramer rao proof ] ) is just the variance @xmath134    & = \\,\\sum\\limits_{m}p(m|{\\ensuremath{\\hspace*{0.5pt}}}\\theta{\\ensuremath{\\hspace*{0.5pt}}})\\,\\bigl(\\hat{\\theta}(m)-\\theta\\bigr)^{2}\\ , .",
    "\\label{eq : local variance appendix}\\end{aligned}\\ ] ] dividing by the second factor , which we identify with the fisher information @xmath192 we finally obtain the _ cramr - rao _",
    "inequality @xmath134    & \\geq\\,\\frac{1}{i\\bigl(\\rho(\\theta)\\bigr)}\\ , .",
    "\\label{eq : cramer rao bound appendix}\\end{aligned}\\ ] ]      let us now revisit the local phase estimation scenario for an entangled state , for instance , the @xmath0-qubit ghz state , given by @xmath193 a quick calculation of the qfi of eq .",
    "( [ eq : pure state unitary encoding fisher ] ) for this state provides the result @xmath194 .",
    "the precision may hence quadratically increase with the number of qubits .",
    "this optimal scaling behaviour is usually called the _",
    "heisenberg limit_. to see how one can practically achieve heisenberg scaling , let us consider a simple parity measurement , that is , a projective measurement with outcomes @xmath195 ( even ) and @xmath196 ( odd ) , and associated povm elements @xmath197 where @xmath198 projects into the subspace where @xmath30 qubits are in the state @xmath199 and @xmath200 qubits are in the state @xmath40 . denoting the single - qubit projectors as @xmath201 , we can write @xmath202 where the sum is over all @xmath203 permutations @xmath204 . one then straightforwardly finds @xmath205 which in turn yields the conditional probabilities    @xmath206      p(-|{\\ensuremath{\\hspace*{0.5pt}}}\\theta{\\ensuremath{\\hspace*{0.5pt } } } ) & = \\,{\\textnormal{tr}}\\bigl(e_{\\mathrm{odd}}{\\ensuremath{\\hspace*{0.5pt}}}\\rho(\\theta)\\bigr)\\,=\\,\\sin^{2}\\!\\bigl(\\tfrac{n\\theta}{2}\\bigr)\\,.\\end{aligned}\\ ] ]      we then only need to find a suitable estimator .",
    "we can construct such an estimator from the expected value of the associated observable @xmath208 , which has the spectral decomposition @xmath209 , such that @xmath210 . crucially , note that the required measurements are just local @xmath22-measurements , the results of which are multiplied to obtain the overall measurement result in each run , i.e. , @xmath211 . for @xmath212 $ ]",
    "we then assign the estimator @xmath213 computing the mean and variance for this estimator one finds ,      the estimator is only unbiased for @xmath215 , but in this case the variance admits heisenberg scaling and takes the value @xmath216 .",
    "however , one can do better than this by averaging over the outcomes before assigning an estimate , rather than averaging the individual estimates . practically speaking",
    ", one can view this as estimating @xmath217 followed by a simple reparametrization using @xmath218 .",
    "this estimator is unbiased by definition , since @xmath219 and one finds the variance @xmath220     & = \\,\\sum\\limits_{m}p(m|{\\ensuremath{\\hspace*{0.5pt}}}m(\\theta){\\ensuremath{\\hspace*{0.5pt}}})\\bigl(m-{\\ensuremath{\\left\\langle\\right.\\hspace*{-1pt } m \\hspace*{-1pt}\\left.\\right\\rangle}}\\bigr)^{2}\\,=\\,\\sin^{2}\\!({\\ensuremath{\\hspace*{-0.5pt}}}n\\theta)\\,.\\end{aligned}\\ ] ] propagating the error through the reparameterization then yields @xmath221     & = \\,v[m(\\theta)]\\,\\bigl(\\frac{\\partial \\theta}{\\partial m}\\bigr)^{2}\\,=\\,\\frac{1}{n^{2}}\\,.\\end{aligned}\\ ] ] one can hence get a quadratic scaling advantage for local phase estimation using an @xmath0-qubit ghz state and local measurements . by extension via error propagation , heisenberg scaling is also maintained for frequency estimation by reparameterizing @xmath222 for any fixed interrogation time @xmath223 . as shown in fig .",
    "[ fig : local phase estimation in mbqc ] in the main text , the preparation of an @xmath0-qubit ghz state can be realized using a @xmath224-qubit 1d cluster state , which hence constitutes a resource for local phase and frequency estimation at the heisenberg limit .      in appendix",
    "[ sec : the bayesian estimation scenario ] , we first review the basic structure of bayesian parameter estimation problems .",
    "we then discuss an inequality that serves as a bayesian analogue of the cramr - rao bound in appendix  [ sec : bayesian cramer rao bound ] and present a simple proof in appendix  [ sec : bayesian cramer rao bound proof ] , before highlighting an interesting connecting between bayesian estimation and noisy local estimation in appendix  [ sec : connection of gaussian bayesian to noisy local ] .",
    "finally , we investigate the limitations of the mse cost function for bayesian estimation in appendix  [ sec : limitations of the mse approach ] .",
    "much like in the local estimation scenario discussed in appendix  [ sec : local estimation ] , the bayesian scenario considers the estimation of a parameter @xmath4 that has been encoded onto a quantum state @xmath6 by performing a measurement given by some povm @xmath16 . as",
    "before , the conditional probability to obtain the outcome @xmath20 given that the parameter has the value @xmath4 is @xmath225 however , where the local estimation scenario requires only that the parameter be close to values for which an unbiased estimator is available , the bayesian estimation scenario captures all previously held belief about @xmath4 in a probability distribution referred to as the _ prior _ @xmath45 .",
    "performing a single measurement , the probability to obtain the outcome @xmath20 is then simply @xmath226 where we have defined the quantity @xmath227 following the notation of ref .",
    "@xcite ) . given some outcome @xmath20 ,",
    "we then want to provide an estimate @xmath49 for the value of the parameter .",
    "to this end , note that bayes law lets us determine @xmath228 , the probability that the parameter had the value @xmath4 given the outcome @xmath20 , as @xmath229 as an estimate we then simply average the possible values of @xmath4 weighted with the corresponding probabilities @xmath228 , i.e. , @xmath230 where we have inserted from eqs .  ( [ eq : bayes law ] ) and  ( [ eq : prob for m unconditional ] ) , and defined the new quantity  @xcite @xmath231 thus , the estimate for @xmath4 given that the outcome @xmath20 was observed , depends on the prior @xmath45 and the encoding of the parameter in the state @xmath6 via the quantities @xmath232 and @xmath233 from eqs .",
    "( [ eq : gamma ] ) and  ( [ eq : eta ] ) , respectively , and on the chosen povm @xmath16 .",
    "note that the estimator used for the bayesian estimation scenario need not be unbiased in the sense of eq .",
    "( [ eq : unbiasdness condition ] ) . instead , on average",
    ", we now expect the estimator to assign the same mean value as the prior , i.e. , @xmath234    as a figure of merit for the precision of the estimate , we then wish to quantify how close @xmath49 is to @xmath4 according to our updated belief .",
    "we are hence interested in the variance @xmath235 of the _ posterior _ @xmath228 given the outcome @xmath20 . using the mse approach as in eq .",
    "( [ eq : mse variance local estimation ] ) , but now with the posterior instead of the conditional probability @xmath236 , we write @xmath237\\,=\\,\\int\\!d\\theta\\,p(\\theta|m)\\,\\bigl(\\theta-\\hat{\\theta}(m)\\bigr)^{2 }      \\label{eq : final variance given m}\\\\[1 mm ]      & = \\,\\frac{1}{p(m)}\\bigl[{\\textnormal{tr}}\\bigl(e_{m}\\!\\int\\!d\\theta\\,p(\\theta)\\,\\rho(\\theta)\\,\\theta^{2}\\bigr)\\,-\\,\\frac{\\bigl({\\textnormal{tr}}(e_{m}{\\ensuremath{\\hspace*{0.5pt}}}\\eta)\\bigr)^{2}}{{\\textnormal{tr}}(e_{m}{\\ensuremath{\\hspace*{0.5pt}}}\\gamma)}\\bigr]\\ , ,      \\nonumber\\end{aligned}\\ ] ] where we have used  ( [ eq : bayes law ] ) and  ( [ eq : estimator ] ) . in general , the width of the posterior may decrease or increase with respect to the width of the prior , depending on the measurement outcome . it is therefore more useful to average over different outcomes and define @xmath238    as a simple example , consider a gaussian prior of width @xmath239 centered at @xmath240 , that is , @xmath241 with @xmath242 and @xmath243=\\int\\!d\\theta\\,p(\\theta)\\,(\\theta-\\theta_{o})^{2}=\\sigma^{2}$ ] . the first term on the right - hand side of eq .",
    "( [ eq : average final variance ] ) then evaluates to @xmath244 while the remaining term @xmath245 determines the average decrease in width of the posterior with respect to the prior .      the average variance of the posterior can be bounded from below using the _ van  trees inquality _ ( see , e.g. , ref .",
    "@xcite or appendix  [ sec : bayesian cramer rao bound proof ] ) @xmath246 which can be viewed as a type of cramr - rao bound for bayesian estimation , where @xmath247 is the classical fisher information of the prior and @xmath248      & = \\,\\int\\!d\\theta\\,p(\\theta)\\,\\sum\\limits_{m}p(m|{\\ensuremath{\\hspace*{0.5pt}}}\\theta{\\ensuremath{\\hspace*{0.5pt}}})\\,\\bigl(\\frac{\\partial}{\\partial\\theta}\\log p(m|{\\ensuremath{\\hspace*{0.5pt}}}\\theta{\\ensuremath{\\hspace*{0.5pt}}})\\bigr)^{2}\\ , .",
    "\\nonumber\\end{aligned}\\ ] ] is the averaged ( over the unknown parameter  @xmath4 ) fi associated to the state @xmath6 and the povm @xmath16 as specified in eq .",
    "( [ eq : fisher information ] ) .",
    "since the qfi @xmath147 arises as a maximization of the fi @xmath144 over all povms , we have @xmath249 . if , as before for the local case , we consider the parameter to be encoded by a unitary transformation of the form of eq .",
    "( [ eq : unitary encoding appendix ] ) , the qfi is independent of @xmath4 , as we have shown in appendix  [ sec : cramer rao bound ] .",
    "this allows us to bound the average fi by the qfi , i.e. , @xmath250 and consequently we can modify the van  trees inequality to @xmath251 in contrast to the ( quantum ) cramr - rao inequality  ( [ eq : cramer rao bound ] ) , the bounds in  ( [ eq : bayesian cramer rao ] ) and  ( [ eq : bayesian cramer rao with qfi ] ) are generally not tight , so they do not allow us to conclude that a measurement strategy exists such that @xmath252 grows quadratically with @xmath0 . and while it can indeed be shown  @xcite that heisenberg scaling is asymptotically achievable for arbitrary priors in the bayesian regime we require an explicit description of the involved states and measurements to determine whether these can be efficiently implemented .",
    "nonetheless , a simple consequence of the van trees inequality pertains to the classical scaling behaviour .",
    "recall from eq .",
    "( [ eq : pure state unitary encoding fisher product state ] ) that the maximal value of the qfi for product states is proportional to @xmath0 .",
    "this implies that @xmath253 decreases at most linearly with @xmath0 for classical strategies , i.e. , @xmath254 , where @xmath255 is a constant independent of @xmath0 .",
    "for instance , for the gaussian prior of eq .",
    "( [ eq : gaussian prior ] ) , which we want to focus on in the following , we have @xmath256 .    at this point ,",
    "two comments on the choice of gaussian priors are in order .",
    "first , note that there exists an interesting connection between bayesian estimation with gaussian priors and local estimation subject to parallel , gaussian noise  @xcite .",
    "as is outlined in appendix  [ sec : connection of gaussian bayesian to noisy local ] , this connection provides an alternative way of computing the variance @xmath253 via the ( quantum ) fisher information of the probe state after a noisy channel . here , we do not explicitly consider the problem of noisy metrology in more detail , but we refer the interested reader to refs .",
    "@xcite .",
    "the second comment concerns the fact that the probability distribution of eq .",
    "( [ eq : gaussian prior ] ) has support on the entire real line , whereas for phase estimation , @xmath4 only takes values in an interval of length @xmath257 . in addition , the use of the mse means that differences between estimates and parameter values larger than @xmath258 are disproportionately penalized .",
    "intuitively it is clear that this becomes an issue when the width of the gaussian prior becomes comparable with ( half of ) the length of the interval for @xmath4 . in appendix",
    "[ sec : limitations of the mse approach ] this problem is discussed in more detail .    for sufficiently narrow priors",
    "the mse is hence still a useful cost function for the variance and ( non - wrapped ) gaussians can be employed instead of the more complicated wrapped gaussians to simplify calculations .",
    "moreover , the use of the mse ( rather than some circular statistics equivalent or covariant cost function , cf . ref .",
    "@xcite ) as a measure for the precision of the estimate allows us to remain within the framework of ref .  @xcite .",
    "it also permits us to apply the bayesian cramr - rao bound of ineq .",
    "( [ eq : bayesian cramer rao with qfi ] ) , which provides a straightforward comparison with classical strategies , as we shall discuss in appendix  [ sec : bound for multiqubit measurements ] .",
    "finally , note that these considerations arise for the phase estimation problem discussed in this section , but are no cause for concern in the frequency estimation paradigm , which is presented in appendix  [ sec : bayesian frequency estimation in mbqc ] .",
    "we now want to present an explicit proof that the average variance @xmath259 of the posterior @xmath228 can be bounded from below by the _ van trees inequality _",
    "@xcite , which is the bayesian equivalent of the cramr - rao bound , given by @xmath260 where @xmath255 is the classical fisher information of the prior , given by @xmath261 and @xmath262 is the fisher information associated to the state @xmath6 and the povm @xmath16 , averaged over the ( unknown ) parameter @xmath4 .",
    "that is , it is given by @xmath263      & = \\,\\int\\!d\\theta\\,p(\\theta)\\,\\sum\\limits_{m}p(m|{\\ensuremath{\\hspace*{0.5pt}}}\\theta{\\ensuremath{\\hspace*{0.5pt}}})\\,\\bigl(\\frac{\\partial}{\\partial\\theta}\\log p(m|{\\ensuremath{\\hspace*{0.5pt}}}\\theta{\\ensuremath{\\hspace*{0.5pt}}})\\bigr)^{2}\\ , .",
    "\\nonumber\\end{aligned}\\ ] ] in the frequency estimation scenario , the parameter @xmath4 is typically allowed to take on any value in @xmath264 , but the prior is assumed to have compact support , such that @xmath265 . in the phase estimation scenario , on the other hand ,",
    "the parameter can take values in the interval @xmath266 $ ] for some @xmath267 and w.l.o.g .",
    "one may pick @xmath268 . in this case",
    ", one may assume that the probability densities are either wrapped , e.g. , the prior satisfies @xmath269 and @xmath4 is to be understood as @xmath270 .",
    "alternatively , one can also treat @xmath4 to be any real number , and require that the prior be sufficiently narrow . in the latter scenario ,",
    "one can still use the mse approach for the variance , but care needs to be taken with the initial width of the prior , as discussed in appendix  [ sec : limitations of the mse approach ] . with this in mind",
    ", we now discuss a proof of eq .",
    "( [ eq : bayesian cramer rao appendix ] ) .",
    "first , note that @xmath271_{a}^{b}\\,=\\,0\\ , ,      \\label{eq : bayesian cramer rao proof 1}\\end{aligned}\\ ] ] due to the assumptions above for @xmath272 or @xmath273 , respectively .",
    "similarly , integration by parts immediately lets us evaluate the integral @xmath274 where we have eliminated the boundary term using the previous assumptions . using bayes law",
    "[ see eq .",
    "( [ eq : bayes law ] ) ] and the preliminary results of eqs .",
    "( [ eq : bayesian cramer rao proof 1 ] ) and  ( [ eq : bayesian cramer rao proof 2 ] ) , we can then calculate @xmath275      & = \\,p(m)\\int\\!d\\theta\\,p(\\theta|m)\\,=\\,p(m)\\ , ,      \\label{eq : bayesian cramer rao proof 3}\\end{aligned}\\ ] ] since @xmath228 is normalized .",
    "when we sum over the possible measurement outcomes , we must hence just get @xmath276 on the other hand , we can rewrite parts of the integrand as @xmath277 and use the cauchy - schwarz inequality from eq .",
    "( [ eq : cauchy schwarz ineq ] ) with @xmath278 and @xmath279\\end{aligned}\\ ] ] to arrive at the inequality @xmath280      & \\ \\ \\times\\,\\sum\\limits_{n}\\int\\!d\\theta{^{\\prime}}\\,p(\\theta{^{\\prime}})\\,p(n|{\\ensuremath{\\hspace*{0.5pt}}}\\theta{^{\\prime}}{\\ensuremath{\\hspace*{0.5pt}}})\\,\\bigl(\\frac{\\partial}{\\partial\\theta{^{\\prime}}}\\log\\bigl[p(\\theta{^{\\prime}})\\,p(n|{\\ensuremath{\\hspace*{0.5pt}}}\\theta{^{\\prime}}{\\ensuremath{\\hspace*{0.5pt}}})\\bigr]\\bigr)^{2}\\ , .      \\nonumber\\end{aligned}\\ ] ] the first factor on the right - hand side of eq .",
    "( [ eq : bayesian cramer rao proof 5 ] ) is just @xmath253 from eq .",
    "( [ eq : average final variance ] ) .",
    "the second factor can be split into three terms by squaring @xmath281     & = \\ ,      \\frac{\\partial}{\\partial\\theta}\\log p(\\theta)\\,+\\,\\frac{\\partial}{\\partial\\theta}\\log p(m|{\\ensuremath{\\hspace*{0.5pt}}}\\theta{\\ensuremath{\\hspace*{0.5pt}}})\\,.\\end{aligned}\\ ] ] summing over the normalized conditional probability @xmath282 , the first term gives the classical fisher information for the prior , i.e. , @xmath283 while the term containing the square of @xmath284 gives @xmath285 as defined in eq .",
    "( [ eq : fisher posterior appendix ] ) .",
    "the remaining cross term is of the form @xmath286      & = \\,\\sum\\limits_{m}\\int\\!d\\theta\\,\\bigl(\\frac{\\partial}{\\partial\\theta}\\,p(\\theta)\\bigr)\\,\\bigl(\\frac{\\partial}{\\partial\\theta}\\,p(m|{\\ensuremath{\\hspace*{0.5pt}}}\\theta{\\ensuremath{\\hspace*{0.5pt}}})\\bigr )      \\nonumber\\\\[1 mm ]      & = \\,\\int\\!d\\theta\\,\\bigl(\\frac{\\partial}{\\partial\\theta}\\,p(\\theta)\\bigr)\\,\\bigl(\\frac{\\partial}{\\partial\\theta}\\,\\sum\\limits_{m}p(m|{\\ensuremath{\\hspace*{0.5pt}}}\\theta{\\ensuremath{\\hspace*{0.5pt}}})\\bigr)\\,=\\,0\\,,\\end{aligned}\\ ] ] which vanishes since the sum over @xmath236 is independent of @xmath4 , i.e. , @xmath287 dividing both sides of the inequality in  ( [ eq : bayesian cramer rao proof 5 ] ) by the sum of the nonzero terms of the second factor , we arrive at the bayesian cramr - rao bound @xmath288    [ [ sec : connection of gaussian bayesian to noisy local ] ] relating noisy local estimation with bayesian estimation for gaussian priors ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^    in this appendix we discuss an interesting connection between noisy local estimation and bayesian estimation for gaussian priors .",
    "we hence consider a local estimation scenario as in section  [ sec : the local parameter estimation scenario ] , where  parallel \" noise is present on top of the unitary encoding of eq .",
    "( [ eq : unitary encoding appendix ] ) .",
    "that is , the noise is generated by the same hamiltonian as the encoding of the parameter but distributed according to some probability distribution @xmath289 .",
    "the state encoding the parameter is then given by @xmath290 where the noise can be understood as part of preparing the initial state @xmath291 starting from some pure state @xmath159 .",
    "we further assume that the noise has a gaussian profile centered around zero , that is , the noise distribution is @xmath292 where @xmath293 is the mean of the gaussian prior @xmath45 of eq .",
    "( [ eq : gaussian prior ] ) .",
    "we can now see how the encoded state of this noisy local scenario corresponds to the quantity @xmath232 from eq .",
    "( [ eq : gamma ] ) in the bayesian scenario , i.e. , @xmath294      & = \\,\\int\\!d\\theta{^{\\prime}}\\,p(\\theta{^{\\prime}}+\\theta_{o})\\,u_{\\theta{^{\\prime}}+\\theta_{o}}{\\ensuremath{\\hspace*{0.5pt}}}{\\ensuremath{\\left|\\right.\\!{\\psi}\\!\\left.\\right\\rangle}}\\!{\\ensuremath{\\left\\langle\\right.\\!{\\psi}\\!\\left.\\right|}}{\\ensuremath{\\hspace*{0.5pt}}}u_{\\theta{^{\\prime}}+\\theta_{o}}^{\\dagger}\\,=\\,\\tilde{\\rho}(\\theta_{o})\\ , ,      \\label{eq : gamma appendix}\\end{aligned}\\ ] ] where we have substituted @xmath295 . to establish a similar connection for @xmath233 from eq .",
    "( [ eq : eta ] ) , we make use of the fact that the prior ( and the noise distribution in the local scenario ) are gaussian , such that @xmath296 with this , we find @xmath297      & = \\,\\theta_{o}{\\ensuremath{\\hspace*{0.5pt}}}\\gamma\\,+\\,i\\sigma^{2}\\!\\!\\int\\!\\!d\\theta{\\ensuremath{\\hspace*{0.5pt}}}p(\\theta){\\ensuremath{\\hspace*{0.5pt}}}{\\ensuremath{\\left[\\right.\\ !",
    "\\rho(\\theta ) \\ , , h \\!\\left.\\right]}}\\,=\\,\\theta_{o}{\\ensuremath{\\hspace*{0.5pt}}}\\gamma\\,+\\,\\sigma^{2}\\dot{\\tilde{\\rho}}(\\theta_{o})\\ , ,      \\label{eq : eta appendix}\\end{aligned}\\ ] ] where the dot indicates a partial derivative w.r.t .",
    "@xmath4 . reinserting the expressions for @xmath232 and @xmath233 into eq .",
    "( [ eq : average final variance ] ) , the last term gives @xmath298\\bigr)^{2}}{{\\textnormal{tr}}\\bigl(e_{m}{\\ensuremath{\\hspace*{0.5pt}}}\\tilde{\\rho}(\\theta_{o})\\bigr ) }      \\,+\\,\\theta_{o}^{2}\\ , .",
    "\\label{eq : average final variance second term gaussian prior}\\end{aligned}\\ ] ] the first term on the right - hand side of eq .",
    "( [ eq : average final variance second term gaussian prior ] ) can easily be recognized as the fisher information @xmath299 from eq .",
    "( [ eq : fisher information ] ) for the povm @xmath16 in the local scenario with parallel gaussian noise . combining this result with eqs .",
    "( [ eq : average final variance ] ) and  ( [ eq : gaussian theta squared exp value ] ) , we find @xmath300 since the variance of the initial gaussian prior is just @xmath243=\\sigma^{2}$ ] , one arrives at the conclusion that the average decrease in variance in the bayesian scenario with gaussian prior , @xmath301-\\overline{v}_{\\!\\mathrm{post}}$ ] for any given povm is proportional to the fisher information at @xmath240 for the same povm in the local scenario with parallel gaussian noise , @xmath302 . in particular , for the optimal povm one obtains the qfi , which is independent of the value of the parameter for the unitary encoding with parallel noise , and hence @xmath303 this result immediately informs us about an important property of the bayesian scenario .",
    "since @xmath304 is the qfi in a scenario with parallel noise that can be viewed as dephasing , one can not expect heisenberg scaling of @xmath304 , i.e. , that @xmath304 increases quadratically with @xmath0 , see refs .",
    "@xcite . instead",
    ", it is clear that @xmath305 since @xmath306 . on the other hand ,",
    "one expects that @xmath304 approaches the bound @xmath307 from below as @xmath0 increases . as suggested in ref .",
    "@xcite , it is reasonable to assume that @xmath308 for some positive constant @xmath309 and some power @xmath310 , such that @xmath311 .",
    "therefore , a scaling advantage of a quantum strategy with respect to a classical strategy is obtained if one finds an ( efficiently preparable ) state and povm such that @xmath312 .      here",
    ", we aim to discuss the limitations of applicability of the mean square error ( mse ) cost function for bayesian phase estimation , i.e. , for a scenario where the parameter @xmath4 is encoded by a unitary @xmath162 , with @xmath313 for each qubit .",
    "since the difference between the two eigenvalues of @xmath25 is @xmath111 , it is immediately apparent that values of @xmath4 that differ by @xmath257 can not be distinguished in such a scenario .",
    "this periodicity is not accurately reflected in the use of the mse , since estimates that differ by integer multiples of @xmath257 are unduly penalized . in a local estimation scenario where small fluctuations around a fixed value of the parameter are being estimated ,",
    "this is not an issue .",
    "similarly , this is of no concern for bayesian estimation when the prior is sufficiently localized , but can become an issue for larger values of @xmath314 [ where we focus on gausian priors as in eq .",
    "( [ eq : gaussian prior ] ) ] .",
    "we are therefore interested in quantifying for which values of @xmath314 the approach using the mse cost function becomes problematic .",
    "we will take a pragmatic point of view and consider the mse approach as useful , if this post - processing of the measurement data provides an increase in knowledge in the sense of an average decrease of the width of the posterior @xmath228 .",
    "we therefore ask , what the minimal mse of the posterior can be in principle , given a fixed gaussian prior of width @xmath314 . when obtaining a measurement outcome @xmath20 , the corresponding estimate may in principle",
    "only be understood modulo @xmath257 .",
    "in other words , if no prior knowledge is available , and one were to trust the estimate of the parameter unconditionally , the posterior would be a  comb \" of dirac delta functions @xmath315 for all values @xmath66 such that @xmath316 lies within the allowed range of parameters . for an unrestricted range , @xmath317 , we hence have infinitely many side - peaks at distances @xmath318 for @xmath319 .",
    "if we take into account the prior information , some of these peaks are suppressed by its shape , e.g. , as @xmath320 for a gaussian prior .",
    "the optimally reachable posterior is then given by @xmath321 where the normalization is given by @xmath322 .",
    "the mse of this distribution is @xmath323 as illustrated in fig .",
    "[ fig : mse limitations ] , the mse of this optimal posterior strongly increases from around @xmath324 , and from around @xmath325 the width stays virtually constant as compared to the mse of the prior . of course",
    "this does not mean that the measurement process does not provide information about the parameter . clearly , knowing the value of @xmath4 exactly modulo @xmath257 is more useful than a uniform prior",
    ". however , the mse simply fails to capture this distinction .",
    "we hence have to keep this limited applicability of the approach using ( non - wrapped , gaussian ) priors and the mse cost function in mind . specifically , we restrict our analysis to gaussian priors of widths smaller or equal than @xmath111",
    ".    * limitations of the mse approach*. the minimally achievable mse @xmath326 of the posterior , normalized by the variance @xmath327 of the prior , is plotted against @xmath314 . for small @xmath4 ,",
    "the width of the optimal posterior is close to zero and the mse appropriately captures the increase in knowledge about @xmath4 .",
    "however , when the width of the prior reaches a threshold value close to @xmath328 , the minimal mse of the posterior drastically increases and quickly saturates at the initial width of the prior . in this regime",
    "the mse does not reflect the increase in knowledge about @xmath4 in a meaningful way.,scaledwidth=44.0% ]      after introducing the quantities of interest for bayesian parameter estimation in the previous appendix , we now want to illustrate these techniques for classical bayesian estimation .",
    "this provides the opportunity to establish a direct comparison with the results obtained for a strategy exploiting quantum features that we will present in appendix  [ sec : quantum advantage in bayesian estimation ] .",
    "we consider a strategy to be classical , if no quantum correlations are used for the state preparation or measurement , which corresponds to the choice of product states for @xmath0 qubits along with single - qubit measurements .",
    "the bayesian approach allows updating the estimation strategy based on the outcomes of previous measurements .",
    "consequently , a parallel strategy of @xmath0 individual probes that are prepared and measured in the same way may not be optimal even among the classical measurement schemes . at the same time",
    ", the explicit evaluation of a sequential measurement strategy with intermediate updates is computationally extremely demanding . to give a fair representation of the performance of classical strategies we",
    "hence consider a bound for the sequential measurement scheme in appendix  [ sec : bound for multiqubit measurements ] , and compute the average variance explicitly for the optimal parallel strategy in appendix  [ sec : optimal parallel strategy ] . in preparation for these scenarios ,",
    "we begin with the single - qubit bayesian estimation problem in appendix  [ sec : single - qubit measurements ]      for the scenario that we consider here , i.e. , gaussian priors as in eq .",
    "( [ eq : gaussian prior ] ) and unitary parameter encodings as in eq .",
    "( [ eq : unitary encoding appendix ] ) , the optimal single - qubit measurement strategy for bayesian estimation is similar to that of the local scenario .",
    "that is , the probe state is chosen to be @xmath40 , i.e. , a uniform superposition of the eigenstates of @xmath25 .",
    "the optimal accompanying measurement is a projective measurement with povm elements @xmath329 which corresponds to a measurement in a direction on the equatorial plane of the bloch sphere that is orthogonal to the direction obtained by rotating @xmath182 by the expected value @xmath293 of the prior .",
    "this can be seen by noting that probe states and measurement directions can be restricted to the equatorial plane , followed by an optimization over the angle defining their relative orientation . for this combination of state and measurement , the conditional probabilities to obtain the outcomes  @xmath330 \" or",
    " @xmath331 \" are @xmath332 such that @xmath333 .",
    "we further compute      the corresponding estimates are then easily found by inserting into eq .",
    "( [ eq : estimator ] ) , yielding @xmath335 together with eqs .",
    "( [ eq : average final variance ] ) and  ( [ eq : gaussian theta squared exp value ] ) we then find the average variance of the posterior @xmath336 since @xmath337 for finite , nonzero @xmath314 , the variance decreases on average , @xmath338 , but it becomes apparent that the decrease in width quantified by @xmath339 has a maximum for @xmath340 .",
    "this signifies that the mse approach using gaussian priors is not useful for priors of large width when considering phase estimation ( see appendix  [ sec : limitations of the mse approach ] for a discussion of this issue ) .",
    "it is also interesting to note that the posterior distributions conditional on the outcomes @xmath341 are given by @xmath342 unlike the prior , the posterior distributions illustrated in fig .  [ fig : posterior single qubit ] are no longer gaussian , and they are not symmetric around their mean values @xmath343 .",
    "* posterior distributions for single - qubit probe*. the posterior distributions for the outcome @xmath344 for the optimal single - qubit measurement are shown when starting from a gaussian prior of width @xmath314 ( shown for @xmath345 in steps of @xmath346 ) . the prior is centered at @xmath240 , while the mean value of the posterior @xmath347 is just the estimator @xmath348 from eq .",
    "( [ eq : estimator single qubit ] ) , indicated by the vertical dashed lines.,scaledwidth=47.0% ]      we are now interested in making statements about the optimal strategy for bayesian estimation using a sequence of @xmath0 consecutive single - qubit probes .",
    "unfortunately , the posterior even after one measurement is no longer gaussian ( or symmetric ) .",
    "therefore , determining the optimal single - qubit measurements and updating the prior becomes problematic for large numbers of measurements .",
    "this may not be an issue in an actual measurement , where each qubit gives a single outcome based on which the next measurement is chosen .",
    "however , we are interested in the variance of the posterior averaged over all possible sequential measurement outcomes , the set of which grows exponentially . having @xmath34 potentially different posterior distributions makes such an approach computationally infeasible",
    ".    we shall therefore refrain from obtaining the exact expression for the optimal expected variance @xmath253 after @xmath0 sequential single - qubit measurements with updated directions .",
    "instead , we construct a bound based on the bayesian cramr - rao inequality  ( [ eq : bayesian cramer rao with qfi ] ) .",
    "we note that the updating procedure can be entirely thought of as part of the choice of measurement direction , while the probe state @xmath40 remains the same throughout .",
    "further recall that the qfi entails an optimization over all possible measurements including correlated measurements that can depend on previous outcomes .",
    "a lower bound for @xmath253 in the classical case is hence obtained from the qfi for the state @xmath349 , which we have previously determined in eq .",
    "( [ eq : pure state unitary encoding fisher product state ] ) to be given by @xmath350 . inserting into ineq .",
    "( [ eq : bayesian cramer rao with qfi ] ) we arrive at the bound @xmath351 where we have used that @xmath256 any classical strategy , may it consist of parallel or sequential measurements , must give an expected variance larger than this bound . indeed , the bound in ineq .",
    "( [ eq : bayesian cramer rao bound for gaussian prior and classical strategy ] ) is not tight and might significantly overestimate the performance of classical strategies , since the optimization in the qfi also includes entangled measurements .",
    "we therefore complement this bound by an investigation into the optimal parallel strategy in section  [ sec : optimal parallel strategy ] .",
    "having obtained the previous lower bound for @xmath253 for the optimal classical strategy , one may wonder , how close a practical classical strategy may come to this bound . to address this question , we now consider the optimal classical , parallel strategy for gaussian priors .",
    "that is , we compute @xmath253 in the case where @xmath0 qubits are identically prepared and measured ( i.e. , without intermediate updates ) with the optimal single - qubit strategy based on the prior information ( see section  [ sec : single - qubit measurements ] ) .",
    "the probe state is hence @xmath349 and for each qubit we perform the povm with elements @xmath352 as in eq .",
    "( [ eq : single qubit measurement povm ] ) .",
    "since the state is invariant under the exchange of qubits , it is irrelevant , which of the @xmath0 qubits give results  @xmath330 \" , and which give results  @xmath331 \" , we note that there are only @xmath26 qualitatively different measurement outcomes .",
    "we label these outcomes by @xmath353 , which we take to be the number of outcomes  @xmath331 \" .",
    "in other words , for the given state this measurement is equivalent to the povm with element @xmath354 from eq .",
    "( [ eq : single qubit n minus outcome povm ] ) .",
    "the conditional probability to obtain the outcome @xmath20 , given that the parameter takes the value @xmath4 is then @xmath355 we then insert for @xmath356 from eq .",
    "( [ eq : classical single - qubit cond prob ] ) and find @xmath357      & \\ \\",
    "= \\,\\frac{1}{2^{n}}\\binom{n}{m}\\sum\\limits_{k=0}^{n - m}\\sum\\limits_{k{^{\\prime}}=0}^{m }      \\binom{n - m}{k}\\binom{m}{k{^{\\prime}}}(-1)^{k{^{\\prime}}}\\,i_{k+k{^{\\prime}}}\\ , ,      \\label{eq : class parallel tr gamma em}\\end{aligned}\\ ] ] where the quantity @xmath358 is given by @xmath359 and powers of the sine function arise from the binomial expansion of @xmath360 followed by a substitution @xmath361 .",
    "now it is easy to see that the integral @xmath362 vanishes for odd @xmath30 . to solve the integral in eq .",
    "( [ eq : inegral in ] ) for even @xmath30 , we use the trigonometric identity ( which holds only for even @xmath30 ) @xmath363\\theta\\bigr ) ,      \\label{eq : superweird trig identity}\\end{aligned}\\ ] ] as well as the integral formula @xmath364 combining eqs .",
    "( [ eq : class parallel tr gamma em ] ) to  ( [ eq : gaussian integral formula cos ] ) we obtain @xmath365      & \\hspace*{-1mm}\\times\\!\\left\\{{\\ensuremath{\\hspace*{-0.5pt}}}\\frac{(k{\\ensuremath{\\hspace*{-0.5pt}}}+{\\ensuremath{\\hspace*{-0.5pt}}}k{^{\\prime}})!}{[(\\tfrac{k+k{^{\\prime}}}{2})!]^{2 } }      + 2\\!\\!\\!\\!\\!\\sum\\limits_{l=0}^{\\tfrac{k+k{^{\\prime}}-2}{2}}\\!\\!\\!\\frac{(-1)^{\\tfrac{k+k{^{\\prime}}-2l}{2}}e^{-\\tfrac{(k+k{^{\\prime}}-2l)^{2}\\sigma^{2}}{2}}(k{\\ensuremath{\\hspace*{-0.5pt}}}+{\\ensuremath{\\hspace*{-0.5pt}}}k{^{\\prime}})!}{l!(k+k{^{\\prime}}-l)!}{\\ensuremath{\\hspace*{-0.5pt}}}\\right\\}\\end{aligned}\\ ] ] for the gaussian prior we then need to further compute @xmath366 where @xmath367      & = \\,\\frac{1}{2^{n}}\\binom{n}{m}\\sum\\limits_{k=0}^{n - m}\\sum\\limits_{k{^{\\prime}}=0}^{m }      \\binom{n - m}{k}\\binom{m}{k{^{\\prime}}}(-1)^{k{^{\\prime}}}\\,j_{k+k{^{\\prime}}}\\ , .",
    "\\label{eq : class parallel tr small gamma em}\\end{aligned}\\ ] ] here we have a different integral , @xmath368 , which is of the form @xmath369 since @xmath370 we can easily integrate by parts and write @xmath371 when @xmath372 is even , the integral vanishes .",
    "when @xmath372 is odd , on the other hand , then @xmath373 is even and we can use the trigonometric identity from eq .",
    "( [ eq : superweird trig identity ] ) along with the formula @xmath374\\theta\\bigr )     & = \\,\\frac{1}{2}\\cos\\bigl([n-2 - 2l]\\theta\\bigr)\\\\[1 mm ]      & \\ + \\frac{1}{2}\\cos\\bigl([n-2l]\\theta\\bigr).\\end{aligned}\\ ] ] this , together with the gaussian integral of eq .",
    "( [ eq : gaussian integral formula cos ] ) allows us to rewrite @xmath375 as @xmath376}{2^{n}}\\left\\{e^{-\\tfrac{\\sigma^{2}}{2}}\\binom{n-1}{\\tfrac{n-1}{2}}\\right.\\\\[1 mm ]      & \\hspace*{-1mm}+\\!\\sum\\limits_{l=0}^{\\tfrac{n-3}{2}}(-1)^{\\tfrac{n-2l-1}{2}}\\!\\binom{{\\ensuremath{\\hspace*{-0.5pt}}}n-1}{l{\\ensuremath{\\hspace*{-0.5pt}}}}\\ !",
    "\\!\\left.\\bigl(e^{-\\tfrac{(n-2l-2)^{2}\\sigma^{2}}{2}}+e^{-\\tfrac{(n-2l)^{2}\\sigma^{2}}{2}}\\bigr)\\!\\right\\}.\\nonumber\\end{aligned}\\ ] ] with this , the average variance of the posterior of eq .",
    "( [ eq : average final variance gaussian prior simplified ] ) can be computed , which we have done for up to @xmath377 qubits .",
    "the results , depicted in fig .  [ fig : variance classical parallel ] , show that @xmath253 decreases at most as @xmath378 , as expected . moreover , the data suggests that the parallel classical strategy is close the bound of ineq .",
    "( [ eq : bayesian cramer rao bound for gaussian prior and classical strategy ] ) when the width of the prior is much smaller than @xmath328 . for instance , when @xmath379 , the relative deviation of the data for @xmath253 from the bound @xmath380 as quantified by @xmath381 is @xmath382 for @xmath383 and @xmath384 for @xmath385 . for @xmath386 the corresponding deviations are already at @xmath387 and @xmath388 for @xmath383 and @xmath385 , respectively , and for larger values of @xmath314 the deviation of @xmath252 from a function increasing linearly with @xmath0",
    "is already clearly visible in fig .",
    "[ fig : variance classical parallel ] .",
    "* optimal parallel classical strategy*. the expected variance of the posterior @xmath253 and its inverse @xmath252 are shown for the optimal , classical , parallel strategy when starting from a gaussian prior of width @xmath314 ( shown for @xmath345 in steps of @xmath346 ) as functions of the qubit numbers @xmath0 in ( a ) and ( b ) , respectively . as indicated by the different curves for @xmath252 , the variance decreases as @xmath378 for small widths , but decreases less strongly for larger values of @xmath314 .",
    "note that the decrease in performance may be attributed to the choice of the mse cost function and the gaussian priors .",
    ", title=\"fig:\",scaledwidth=47.0% ] + ( a ) + * optimal parallel classical strategy*. the expected variance of the posterior @xmath253 and its inverse @xmath252 are shown for the optimal , classical , parallel strategy when starting from a gaussian prior of width @xmath314 ( shown for @xmath345 in steps of @xmath346 ) as functions of the qubit numbers @xmath0 in ( a ) and ( b ) , respectively . as indicated by the different curves for @xmath252 , the variance decreases as @xmath378 for small widths , but decreases less strongly for larger values of @xmath314 . note that the decrease in performance may be attributed to the choice of the mse cost function and the gaussian priors .",
    ", title=\"fig:\",scaledwidth=47.0% ] + ( b )      with respect to the local estimation scenario , bayesian estimation is made considerably more complicated by the in principle arbitrary shape of the prior .",
    "consequently , results on optimality are scarcely available apart from very special cases such as phase estimation for flat priors  @xcite , for which an optimal ( albeit with respect to a different cost function for the variance ) pair of probe state and measurement have been determined . here",
    ", we will discuss a slightly modified version of the scheme of ref .",
    "@xcite as an example and show that it can lead to a scaling advantage also for other choices of priors ( and cost functions ) .",
    "the probe state in question is a superposition of @xmath0-qubit computational basis states , where one representative @xmath389 is selected for each hamming weight , i.e. , from each subspace with a fixed number of qubits in the state @xmath67 .",
    "that is , @xmath36 is a unary encoding of the integer @xmath30 . for flat priors [ and using the holevo phase variance  @xcite instead of the mse of eq .",
    "( [ eq : final variance given m ] ) ] , the optimal probe state @xmath390 is of the form @xmath391 where the coefficients are chosen with a sinusoidal profile ( see , e.g. , ref .",
    "@xcite ) , i.e. , @xmath392 for the sake of illustration , we will study the performance of this particular state that we will refer to as the _ sine state _ for the mse and gaussian priors of finite width . nonetheless , it is crucial to note that the optimal probe state for phase estimation with any prior ( and variance ) must be of the form of eq .",
    "( [ eq : probe_state 2 appendix ] ) for some choice of coefficients .",
    "this is due to the fact that @xmath390 already contains one representative eigenvector of @xmath91 ( and @xmath25 ) for each of its different eigenvalues . adding any other components outside of the span of @xmath59",
    "would hence not provide any more information about the phase @xmath4 .",
    "after the unitary dynamics @xmath91 , the probe state is thus of the form @xmath393 also note that the probe state we have chosen is not symmetric with respect to the exchange of the different qubits .",
    "however , relinquishing this symmetry requirement allows us to operate in an @xmath33-dimensional subspace of the total hilbert space of dimension @xmath34 , which will prove to be crucial for the efficient implementation of the estimation scheme in mbqc .    as a measurement strategy for our example",
    ", we will consider a quantum fourier transform ( qft ) in the subspace spanned by the vectors @xmath36 , followed by computational basis measurements .",
    "this measurement can be represented by a povm with elements @xmath394 for @xmath395 and @xmath396 , where @xmath397 practically , we can ignore the povm element @xmath398 , as the corresponding outcome never occurs for the chosen probe state ( in the absence of noise ) . with this , we are now in a position to compute @xmath253 from eq .",
    "( [ eq : average final variance ] ) where we again assume a gaussian prior as in eq .",
    "( [ eq : gaussian prior ] ) . we hence need to calculate @xmath399 to rewrite this quantity , it is useful to first determine @xmath400 where @xmath401 , for which we obtain @xmath402 with this , we quickly find @xmath403 @xmath404 inserting eqs .",
    "( [ eq : tr ek gamma general ] ) and  ( [ eq : tr ek eta general ] ) back into  ( [ eq : average final variance gaussian prior ] ) and making use of @xmath405 , and the normalization of @xmath6 and @xmath45 , as well as the identity @xmath406 , one arrives at @xmath407 where @xmath408 is given by @xmath409 finally inserting eqs .",
    "( [ eq : trace ek rho theta bw ] ) and  ( [ eq : small gamma k quantum strategy ] ) into the formula for @xmath253 in eq .",
    "( [ eq : average final variance gaussian prior simplified ] ) , the average variance of the posterior for the sine state and the qft measurement can be evaluated numerically .",
    "the results for up to @xmath377 qubits and for the prior centered at @xmath410 are shown in fig .",
    "[ fig : berry - wiseman ] .      the plots in fig .",
    "[ fig : berry - wiseman ] indicate that for narrow priors ( e.g. for @xmath58 ) the example quantum strategy exhibits a quadratic scaling gap with respect to all classical measurements schemes , meaning that the variance in the quantum strategy decreases more strongly with @xmath0 than classically possible . as discussed in ref .",
    "@xcite , this    is possible for all priors under certain regularity assumptions , but the explicit form of the optimal states and measurements is generally not known .",
    "indeed , we can not conclude that the strategy that we discuss here is optimal , but ( at least ) for narrow gaussian priors ( @xmath411 ) we find that it directly outperforms even the ( overly optimistic ) bound on classical strategies from ineq .",
    "( [ eq : bayesian cramer rao bound for gaussian prior and classical strategy ] ) already for @xmath412 qubits . for broader priors , we can not report a scaling advantage for this example , but this is to be expected using the mse .",
    "however , recall that the measurement strategy we discuss here is known to be optimal in the case of flat priors for an appropriately chosen cost function  @xcite , and our results are hence complimentary in the sense that we provide numerical evidence for optimal scaling in a regime of narrow priors . additional plots for direct comparison with the classical bounds can be found in appendix  [ sec : additional data for bayesian phase estimation ] .          in this appendix",
    "we investigate on bayesian frequency estimation , i.e. , the case where the parameter to be estimated is the angular frequency , @xmath413 , rather than the phase @xmath4 , i.e. , such that @xmath222 .",
    "the key difference of frequency estimation compared to phase estimation is that in the former we have the freedom to optimize over the interrogation time @xmath223 .",
    "we shall do this for some of the states and measurement previously considered for phase estimation . specifically , for the optimal classical parallel measurement strategy and for the quantum strategy using the sine states and qft measurements from eqs .",
    "( [ eq : berry wiseman state appendix ] ) and  ( [ eq : dft ] ) , respectively .",
    "more precisely , the dynamical evolution of each qubit is described by the unitary transformation @xmath414 , and our prior information about @xmath413 is given by the normal distribution @xmath415 where we have assumed without loss of generality that     and its inverse @xmath252 , optimized over the interrogation time , are shown for the optimal , classical , parallel strategy [ with probe state @xmath349 and povm with elements @xmath354 as in eq .",
    "( [ eq : single qubit n minus outcome povm ] ) ] when starting from a gaussian prior ( in frequency space ) of width @xmath416 in units of @xmath417 .",
    "the horizontal axis shows the qubit number @xmath0 .",
    "[ fig : frequency classical parallel],title=\"fig:\",scaledwidth=44.0% ] +   and its inverse @xmath252 , optimized over the interrogation time , are shown for the optimal , classical , parallel strategy [ with probe state @xmath349 and povm with elements @xmath354 as in eq .",
    "( [ eq : single qubit n minus outcome povm ] ) ] when starting from a gaussian prior ( in frequency space ) of width @xmath416 in units of @xmath417 .",
    "the horizontal axis shows the qubit number @xmath0 .",
    "[ fig : frequency classical parallel],title=\"fig:\",scaledwidth=44.0% ]    the mean frequency is centered at @xmath418 . with the initial state as in eq .",
    "( [ eq : probe_state 2 appendix ] ) the matrix elements of the operators @xmath232 and @xmath233 of eqs .",
    "( [ eq : gamma ] ) and  ( [ eq : eta ] ) , respectively , read @xmath419 where we have defined the dimensionless parameter @xmath420 . the final average variance is again given by eq .  .",
    "however , due to the dependence of the fisher information on @xmath421 , we need to optimize the average final variance over all @xmath421 . the results for the optimal , classical parallel strategy ( see appendix  [ sec : optimal parallel strategy ] ) and for the quantum strategy using the sine states and qft measurements ( see appendix  [ sec : quantum advantage in bayesian estimation ] ) are plotted in figs .",
    "[ fig : frequency classical parallel ] and  [ fig : frequency bw dft ] , respectively , and a comparison is shown in fig .",
    "[ fig : frequency comparison ] .     of the posterior and its inverse @xmath252 ,",
    "both optimized over the interrogation time  @xmath223 , are plotted against the qubit number @xmath0 for the quantum measurement strategy using the sine states from eq .",
    "( [ eq : berry wiseman state appendix ] ) with qft measurements for @xmath422 and for values of @xmath416 from @xmath346 ( blue ) to @xmath111 ( green ) in steps @xmath346 , in units of @xmath417 .",
    "[ fig : frequency bw dft],title=\"fig:\",scaledwidth=44.0% ] +   of the posterior and its inverse @xmath252 , both optimized over the interrogation time  @xmath223 , are plotted against the qubit number @xmath0 for the quantum measurement strategy using the sine states from eq .",
    "( [ eq : berry wiseman state appendix ] ) with qft measurements for @xmath422 and for values of @xmath416 from @xmath346 ( blue ) to @xmath111 ( green ) in steps @xmath346 , in units of @xmath417 .",
    "[ fig : frequency bw dft],title=\"fig:\",scaledwidth=44.0% ]     of the posterior and its inverse @xmath423 , both optimized over the interrogation time  @xmath223 and plotted against the qubit number @xmath0 , are compared for the optimal classical parallel strategy ( red , dashed ) and the quantum strategy using the sine states and qft measurements ( blue , solid ) . for",
    "the plotted range one can clearly see that the quantum strategy provides a scaling advantage with respect to the best parallel classical measurements , that is , the solid blue curve for @xmath423 increases quadratically with @xmath0 , while the the dashed , red curve only increases linearly with @xmath0 .",
    "[ fig : frequency comparison],title=\"fig:\",scaledwidth=44.0% ]   of the posterior and its inverse @xmath423 , both optimized over the interrogation time  @xmath223 and plotted against the qubit number @xmath0 , are compared for the optimal classical parallel strategy ( red , dashed ) and the quantum strategy using the sine states and qft measurements ( blue , solid ) . for",
    "the plotted range one can clearly see that the quantum strategy provides a scaling advantage with respect to the best parallel classical measurements , that is , the solid blue curve for @xmath423 increases quadratically with @xmath0 , while the the dashed , red curve only increases linearly with @xmath0 .",
    "[ fig : frequency comparison],title=\"fig:\",scaledwidth=44.0% ]        in this appendix , we will briefly review the basic concepts of mbqc , but we direct the interested reader to more detailed reviews in refs .  @xcite . in this computational paradigm ,",
    "established in refs .",
    "@xcite , a specific entangled state ( e.g. , a cluster state ) is prepared in an array of qubits . using the entanglement present in the system along with local measurements on a subset of the qubits , ( arbitrary ) unitary transformation",
    "may be implemented on the remaining qubits ( if the cluster is large enough ) . here",
    ", we will focus on mbqc based on 1d and 2d cluster states , i.e. , graph states  @xcite based on regular , linear or rectangular lattices .",
    "each vertex of the graph corresponds to a qubit initialized in the state @xmath40 , while edges connecting the vertices indicate that con-    * two - dimensional cluster states*. in ( a ) the circuit representation of a two - dimensional ( 2d ) cluster state with @xmath424 qubits is shown .",
    "each horizontal line represents a qubit , initialized in @xmath425 ( @xmath426 ) , and time goes from left to right .",
    "the vertical lines ( @xmath427@xmath427 ) represent controlled phase gates @xmath428 applied to the respective qubit pairs @xmath429 .",
    "[ fig : square cluster ] shows the graph structure of the 2d cluster of ( a ) , with vertices @xmath38 on a square lattice connected by edges @xmath430 .",
    ", scaledwidth=38.0% ]      the essence of the working principle of a measurement - based computation is captured by single - qubit gate teleportation  @xcite .",
    "that is , by measuring one of the qubits of an entangled pair in a suitable local basis and applying local correction operators dependent on the outcome on the other qubit , a desired quantum gate can be effectively implemented on the remaining qubit , as illustrated in fig .",
    "[ fig : single_qubit gate_teleportation ] . concatenating this procedure for a chain of qubits in a 1d cluster state",
    ", arbitrary single - qubit gates may be performed in such a way that only local corrections on the final qubit are required .    * single - qubit gate teleportation*. ( a ) after the entangling @xmath41 operation on a pair of qubits prepared in the states @xmath159 and @xmath40 , respectively",
    ", the first qubit is measured in the basis @xmath432 , where @xmath433 specifies an angle in the @xmath434@xmath435 plane . here ,",
    "the rounded boxes correspond to applications of single - qubit gates , where @xmath436 is the hadamard gate , and the symbol   indicates a measurement in the computational basis @xmath437 with outcome @xmath438 .",
    "the remaining qubit is then left in the state @xmath439 . up to the outcome - dependent local correction @xmath440 ( and an irrelevant global phase )",
    "the output qubit hence carries the result of the computation , @xmath441 .",
    "( b ) in a graphical notation ( see , e.g. , ref .",
    "@xcite ) for the circuit in ( a ) , measured qubits are represented by circles inscribed with the corresponding measurement angle @xmath433 , while output qubits are indicated by diamonds  ( ) . the connecting lines between qubits indicate the initial application of @xmath41 gates , and the symbols for input qubits , which may be prepared in arbitrary states are coloured in red , whereas all other qubits are assumed to have been initialized in the state @xmath40 . ,",
    "scaledwidth=42.0% ]    * cnot gate in mbqc*. the four - qubit circuit in ( a ) , and the corresponding measurement pattern in ( b ) illustrate how the measurement of two of the qubits in a 2d cluster , followed by local pauli corrections on the two remaining qubits dependent on the measurement outcomes @xmath442 ( @xmath443 ) can realize an effective cnot gate in an mbqc architecture .",
    "the notation is as in fig .",
    "[ fig : single_qubit gate_teleportation ] .",
    "note that of the two input qubits marked red in ( b ) one is measured , but the other is also an output qubit.,scaledwidth=35.0% ]    although the measurement - based implementation of the cnot gate [ @xmath444 in the notation of eq .",
    "( [ eq : controlled phase gate appendix ] ) ] is not possible in a 1d cluster , it can be achieved in two dimensions  @xcite , as is demonstrated by a simple example in fig .",
    "[ fig : cnot in mbqc ] .",
    "since the combination of arbitrary single - qubit gates with the cnot gate is computationally universal , one may hence prepare an arbitrary quantum state ( e.g. , for performing parameter estimation ) from a 2d cluster .      in this last appendix , we present details on the conversion of the circuit for generating probe states ( shown in fig .",
    "[ fig : circuit for bw ] of the main text ) to an mbqc measurement pattern . to do this ,",
    "let us first see how a @xmath70-rotation can be performed in mbqc , and consider the concatenation of three steps of single - qubit gate teleportation ( see fig .",
    "[ fig : single_qubit gate_teleportation ] ) as shown in fig .",
    "[ fig : y - rotation in mbqc ] .",
    "that is , we prepare a one - dimensional four - qubit cluster state , where the first qubit is initialized in an arbitrary state @xmath159 .",
    "the first three qubits are then measured with angles @xmath445 , @xmath446 , and @xmath447 , respectively , leaving the fourth qubit in the state ( up to a global phase ) @xmath448 noting that a @xmath70-rotation about an arbitrary angle @xmath449 can be written as @xmath450 , selecting measurement angles @xmath451 , @xmath452 , and @xmath453 in fig .",
    "[ fig : y - rotation in mbqc ] realizes @xmath454 up to appropriate local corrections on the last qubit .",
    "* pauli-@xmath70 rotation in mbqc*. ( a ) the circuit representation of the mbqc realization of a pauli-@xmath70 rotation is shown .",
    "measuring the first three qubits in bases in the @xmath434-@xmath435 plane rotated with respect to the @xmath22-basis by @xmath451 , @xmath453 , and @xmath452 , respectively , and applying the local pauli corrections @xmath455 dependent on the measurement outcomes @xmath456 @xmath84 leaves the fourth qubit in the desired state .",
    "( b ) graphical representation of the circuit in ( a ) following the notation of fig .  [",
    "fig : single_qubit gate_teleportation ] .",
    ", scaledwidth=45.0% ]    the @xmath70-rotation to switch the initial state of the qubit from @xmath40 to @xmath69 , as required in fig .",
    "[ fig : circuit for bw ] of the main text . for the remaining controlled rotations , we make use of the simple identity @xmath457 , which allows us to utilize the @xmath41-gates naturally appearing in the cluster state to perform the operation @xmath458 , as shown in the circuit in fig .  [",
    "fig : controlled_rotation mbqc ]  ( a ) .",
    "the spurious application of the operator @xmath15 before the rotation can be disregarded , since all qubits in the circuit in fig .",
    "[ fig : circuit for bw ] are assumed to be in the state @xmath69 in the beginning .",
    "this initialization step can be included as for @xmath86 before .    since we already know from the circuit in fig .",
    "[ fig : y - rotation in mbqc ] how to implement rotations @xmath454 for arbitrary angles , all that is left to do to translate the preparation circuit in fig .",
    "[ fig : circuit for bw ] to mbqc is to commute the local @xmath22-corrections past the @xmath41-gate appearing on the left - hand side of fig .",
    "[ fig : controlled_rotation mbqc ]  ( a ) , as shown in fig .",
    "[ fig : controlled_rotation mbqc ]  ( b ) , such that all local corrections can be applied in the final step of the state preparation .",
    "we hence arrive at the mbqc measurement pattern generating the sine state @xmath390 , which is shown in fig .",
    "[ fig : mbqc_pattern for bw state ] of the main text .",
    "* circuit identities*. the circuit in ( a ) implements the controlled @xmath459 rotation by incorporation of a controlled phase gate @xmath41 . in ( b ) a circuit identity for commuting single - qubit @xmath22-operations past the controlled phase gates ( featuring , e.g. , in cluster states )",
    "the symbol @xmath460 indicates equality up to a possible global phase.,scaledwidth=45.0% ]      h.  cram@xmath461r,_mathematical methods of statistics_(princeton university press , princeton , nj , 1946 ) .",
    "b.  r.  frieden,_science from fisher information : a unification_(cambridge university press , cambridge , u.k . , 2004 ) .",
    "h.  l.  van  trees,_detection , estimation , and modulation theory , part i _",
    "( wiley , new york , 1968 ) .",
    "s.  m.  kay,_fundamentals of statistical signal processing : estimation theory _ ,  ed .",
    "a.  v.  oppenheim ( prentice hall , 1993 ) . s.  l.  braunstein and c.  m.  caves,_statistical distance and the geometry of quantum states_,http://dx.doi.org/10.1103/physrevlett.72.3439[phys .",
    "lett.]http://dx.doi.org/10.1103/physrevlett.72.3439[*72 * , 3439 ( 1994 ) ] .",
    "j.  liu , x .- x .",
    "jing , w.  zhong , and x .-",
    "g .  wang,_quantum fisher information for density matrices with arbitrary ranks_,http://dx.doi.org/10.1088/0253 - 6102/61/1/08[commun .",
    "phys .  * 61 * , 45 ( 2014 ) ] .",
    "r.  d.  gill and b.  y.  levit , http://dx.doi.org/10.2307/3318681[bernoulli * 1 * , 59 - 79 ( 1995 ) ] .",
    "a.  s.  holevo,_covariant measurements and imprimitivity systems_,http://dx.doi.org/10.1007/bfb0071720[lect .  notes  math .  * 1055 * , 153 ( 1984 ) ] .",
    "r.  raussendorf , d.  e.  browne , and h.  j.  briegel,_measurement - based quantum computation with cluster states_,http://dx.doi.org/10.1103/physreva.68.022312[phys .",
    "rev .  a  * 68 * , 022312 ( 2003 ) ] .",
    "d.  gottesman and i.  l.  chuang,_quantum teleportation is a universal computational primitive_,http://dx.doi.org/10.1038/46503[nature  * 402 * , 390 ] http://dx.doi.org/10.1038/46503[(1999 ) ] ."
  ],
  "abstract_text": [
    "<S> quantum metrology offers a quadratic advantage over classical approaches to parameter estimation problems by utilizing entanglement and nonclassicality . </S>",
    "<S> however , the hurdle of actually implementing the necessary quantum probe states and measurements , which vary drastically for different metrological scenarios , is usually not taken into account . </S>",
    "<S> we show that tasks in metrology , the 2d cluster state can serve as a flexible resource that allows one to efficiently prepare any required state for sensing , and perform appropriate ( entangled ) measurements using only single qubit operations . </S>",
    "<S> crucially , the overhead in the number of qubits is less than quadratic , thus preserving the quantum scaling advantage . </S>",
    "<S> this is ensured by using a compression to a logarithmically sized space that contains all relevant information for sensing . </S>",
    "<S> we specifically demonstrate how our method can be used to obtain optimal scaling for phase and frequency estimation in local estimation problems , as well as for the bayesian equivalents with gaussian priors of varying widths . </S>"
  ]
}