{
  "article_text": [
    "relaying is a low - complexity and cost - effective means to extend network coverage and provide spatial diversity , which has attracted a great deal of research attention from both academia and industry @xcite . thus far",
    ", most practical relaying systems are assumed to operate in the half - duplex mode where the relay does not transmit and receive signals simultaneously . yet",
    ", such half - duplex mechanism incurs a 50% spectral efficiency loss . to reduce this loss in spectral efficiency ,",
    "two - way relaying was proposed in @xcite , where the two communicating nodes perform bidirectional simultaneous data transmission .",
    "multipair two - way relaying is a sophisticated generalization of single pair two - way relaying , where multiple pairs of users simultaneously establish a communication link with the aid of a single shared relay @xcite , hence substantially boosting the system spectral efficiency .",
    "the major challenge is to properly handle the inter - pair interference from co - existing communication pairs . thus far",
    ", a number of advanced techniques have been introduced to mitigate inter - pair interference , such as dirty - paper coding @xcite and interference alignment @xcite .",
    "unfortunately , the practical implementation of these techniques is in general very complex . on the other hand ,",
    "the massive multiple - input multiple - output ( mimo ) paradigm has demonstrated superior interference suppression capabilities , with very simple and low - complexity linear processing @xcite .",
    "therefore , deploying large - scale antenna arrays in two - way relaying systems appears to be an extremely promising solution for inter - pair interference mitigation .",
    "some initial works have studied the fundamental performance of such systems @xcite .",
    "in particular , for the amplify - and - forward ( af ) protocol , @xcite investigated the achievable rates and power scaling laws of maximum ratio ( mr ) and zero - forcing ( zf ) processing schemes .",
    "moreover , @xcite derived a closed - form approximation of the ergodic rate of the mr scheme , and addressed the optimal user pair selection problem . however , one major limitation of the above works is that perfect channel state information ( csi ) is assumed .",
    "since obtaining perfect csi is very challenging in the context of massive mimo systems , it is important to look into the realistic scenario with imperfect csi .",
    "an early attempt was made in @xcite , where the authors studied the sum rate performance of training - based af systems utilizing the zf scheme .",
    "although the derived results are useful for understanding the impact of imperfect csi on the system performance , a number of important questions remain to be addressed .",
    "for instance , the fundamental tradeoff between the transmit powers of pilot , user , and the relay , and the performance analysis of alternative relay processing schemes , e.g. , the decode - and - forward ( df ) protocol , remain largely overlooked . motivated by this , in the current work",
    ", we consider a multipair two - way relaying system taking into account the channel estimation error , and present an in - depth analysis of the achievable spectral efficiency and power scaling law of mr processing for both the af and df protocols .",
    "specifically , the main contributions of this paper are summarized as follows :    * we investigate a multipair two - way relaying system that employs mr processing with imperfect csi , and then derive an exact spectral efficiency expression in closed - form for the af protocol and a large - scale approximation of the spectral efficiency for the df protocol when @xmath7 , where @xmath0 is the number of relay antennas . based on our analysis and results , a comprehensive performance comparison of the two protocols",
    "is conducted .",
    "* we characterize the power scaling laws for both the af and df protocols , which generalize the results presented in @xcite .",
    "it turns out that there exists a fundamental trade - off between the transmit powers of each user , pilot symbol and the relay ; in other words , the same spectral efficiency can be achieved with different combination of power scaling parameters , which permits great flexibility in the design of practical systems .",
    "in addition , our theoretical findings suggest that it is worthwhile to spend more power on the pilot sequence to improve the csi accuracy instead of just increasing the users and relay power . *",
    "finally , to improve the sum spectral efficiency , we study the power allocation problem for both the af and df protocols subject to a sum power constraint . near optimum solutions are obtained by solving a sequence of geometric programming ( gp ) problems .",
    "our numerical results suggest that the proposed power allocation strategies improve the sum spectral efficiency by 34.8% and 89.2% when @xmath8 , for the af and df protocols , respectively , indicating that the spectral efficiency enhancement is more prominent for the df protocol .",
    "in addition , for the special case where all users have the same transmit power , it turns out that the users should decrease their transmit power when the number of user pairs becomes large . on the other hand",
    ", the users should increase their transmit power when the number of relay antennas increases or when the channel estimation accuracy improves .",
    "the remainder of the paper is organized as follows : section [ section:2 ] introduces the multipair two - way half - duplex relaying system model under consideration .",
    "section [ section:3 ] presents an exact spectral efficiency in closed - form for the af protocol , and two large - scale approximations of the spectral efficiency for both protocols , with imperfect csi , while section [ section:4 ] studies the power scaling laws of different system configurations .",
    "the power allocation problem is discussed in section [ section:5 ] .",
    "finally , section [ section:6 ] provides some concluding remarks .",
    "_ notation _ : we use bold upper case letters to denote matrices , bold lower case letters to denote vectors and lower case letters to denote scalars .",
    "moreover , @xmath9 , @xmath10 , @xmath11 , and @xmath12 represent the conjugate transpose operator , the conjugate operator , the transpose operator , and the matrix inverse , respectively .",
    "also , @xmath13 is the euclidian norm , @xmath14 denotes the frobenius norm , @xmath15 is the absolute value , and @xmath16_{mn}}$ ] gives the @xmath17-th entry of @xmath18 .",
    "in addition , @xmath19 denotes a circularly symmetric complex gaussian random vector @xmath20 with zero mean and variance matrix @xmath21 , while @xmath22 is the identity matrix of size @xmath23 .",
    "finally , the statistical expectation operator is represented by @xmath24 , the variance operator is @xmath25 , the trace is denoted by @xmath26 , and the notation @xmath27 means almost sure convergence .",
    "consider a multipair two - way relaying system as illustrated in fig .",
    "[ fig : system_model ] , where @xmath28 pairs of single - antenna users , denoted as @xmath29 and @xmath30 , @xmath31 , intend to exchange information with each other , under the assistance of a shared relay @xmath32 equipped with @xmath0 antennas .",
    "we assume that the direct links between @xmath29 and @xmath30 do not exist due to large obstacles or severe shadowing@xcite .",
    "also , the relay operates in the half - duplex mode , i.e. , it can not transmit and receive simultaneously .",
    "it is assumed that the system works under the time division duplex protocol and channel reciprocity holds .",
    "as such , the uplink and downlink channels between @xmath29 and @xmath32 can be denoted as @xmath33 and @xmath34 , respectively .",
    "similarly , the channels between @xmath30 and @xmath32 are denoted as @xmath35 and @xmath36 , @xmath31 , respectively , which account for both small - scale fading and large - scale fading .",
    "more precisely , @xmath37 and @xmath38 . this model is known as uncorrelated rayleigh fading , and @xmath39 and @xmath40 model the large - scale path - loss effect , which are assumed to be constant over many coherence intervals and known a priori . for notational convenience",
    ", the channel vectors can be collected together in a matrix form as @xmath41\\in { \\mathbb c}^{m \\times n}$ ] and @xmath42\\in { \\mathbb c}^{m \\times n}$ ] .",
    "for the considered multipair two - way relaying system , the entire information transmission process consists of two separate phases . in the first phase ,",
    "the @xmath28 user pairs @xmath29 and @xmath30 simultaneously transmit their respective signals to @xmath32 .",
    "thus , the received signal at @xmath32 is given by @xmath43 where @xmath44 and @xmath45 are gaussian signals with zero mean and unit power transmitted by the _ i_-th user pair , @xmath46 and @xmath47 are the average transmit power of @xmath29 and @xmath30 , respectively , and @xmath48 is a vector of additive white gaussian noise ( awgn ) at @xmath32 , whose elements are identically and independently distributed ( i.i.d . )",
    "note that to keep the notation clean and without loss of generality , we take the noise variance to be @xmath50 here , and also in the subsequent sections . with this convention , @xmath46 and",
    "@xmath47 can be interpreted as the normalized transmit signal - to - noise ( snr ) .    in the second phase , the relay broadcasts a transformed version of the received signal to all users .",
    "depending on the adopted relaying protocol , two separate scenarios are studied .      with the af protocol ,",
    "the relay first implements a type of linear processing on the received signal , and then forwards it to all users .",
    "thus , the transmit signal from @xmath32 can be written as @xmath51 where @xmath52 is the linear processing matrix to be specified shortly , and @xmath53 is a normalization coefficient , which is chosen to satisfy the long - term total transmit power constraint at the relay , namely , @xmath54 , so that @xmath55 is the average transmit power of the relay .    therefore , the received signals at @xmath56 ( where @xmath57 ) is given by @xmath58 where @xmath59 represents the awgn at @xmath56",
    ". please note , to simplify notation , we introduce @xmath60 which is defined as @xmath61 due to the channel reciprocity .      with the df protocol , the relay first decodes the @xmath62 symbols , and then re - encodes and forwards the signals to all users . to reduce the complexity ,",
    "single user linear detection is considered at the relay .",
    "as such , the transformed signal after linear processing can be expressed as @xmath63 where @xmath64 is the linear receiver matrix , which will be specified shortly .    after decoding the @xmath62 symbols @xmath20 from @xmath65 ,",
    "the remaining task is broadcasting , but before this , a linear precoding matrix @xmath66 is applied to the re - generated symbols .",
    "as such , the transmit signal of @xmath32 is given by @xmath67 where @xmath68^t$ ] with @xmath69^t$ ] and @xmath70^t$ ] , and @xmath71 is the normalization coefficient , which is determined by the average power constraint at the relay , i.e. , @xmath72 . hence , the signals received at @xmath56 can be expressed as @xmath73      in practice , the channels @xmath74 and @xmath75 are not known and need to be estimated at the relay in every coherence interval .",
    "the typical way of doing this is to utilize pilots @xcite . to this end , during each coherence interval of length @xmath76 ( in symbols ) , @xmath77 symbols are used for channel training . in this case ,",
    "@xmath29 and @xmath30 transmit simultaneously their mutually orthogonal pilot sequences to @xmath32 , for @xmath31 .",
    "thus , the received pilot matrix at the relay is given by @xmath78 where @xmath79 is the transmit power of each pilot symbol , @xmath80 is awgn matrix including i.i.d .",
    "@xmath81 elements , while the _ i_-th columns of @xmath82 and @xmath83 are the pilot sequences transmitted from @xmath29 and @xmath30 , respectively . since all pilot sequences are assumed to be mutually orthogonal , @xmath84 is required , and we have that @xmath85 , @xmath86 , and @xmath87 .    as in @xcite , we assume that @xmath32 uses the minimum mean - square - error ( mmse ) estimator to estimate @xmath74 and @xmath75 . as such ,",
    "the estimated channels of @xmath74 and @xmath75 are given by @xmath88 respectively , where @xmath89 with @xmath90_{ii } = \\beta_{ar , i}$ ] ( @xmath91 is an @xmath92 diagonal matrix ) , @xmath93 with @xmath94_{ii } = \\beta_{rb , i}$ ] ( @xmath95 is an @xmath92 diagonal matrix ) , @xmath96 , and @xmath97 . since @xmath85 and @xmath86 , the elements of @xmath98 and @xmath99 are i.i.d .",
    "@xmath81 random variables .",
    "let @xmath100 and @xmath101 be the estimation error matrices of @xmath74 and @xmath75 , respectively .",
    "then , @xmath74 and @xmath75 can be decomposed as @xmath102 respectively . due to the orthogonality property of mmse estimators and",
    "the fact that @xmath103 , @xmath100 , @xmath104 , and @xmath101 are complex gaussian distributed , these matrices are independent of each other . by rewriting in vector form ,",
    "we have @xmath105 where @xmath106 , @xmath107 , @xmath108 , and @xmath109 are the _ i_-th columns of @xmath103 , @xmath100 , @xmath104 , and @xmath101 , respectively , which are mutually independent . then , from , the elements of @xmath106 , @xmath107 are gaussian random variables with zero mean , variance @xmath110 and @xmath111 , respectively , where @xmath112 and @xmath113 . similarly , the elements of @xmath108 , and @xmath109 are complex gaussian random variables with zero mean , variance @xmath114 and @xmath115 , respectively , where @xmath116 and @xmath117 .",
    "the relay @xmath32 treats the channel estimates as the true channels and utilizes them to perform linear processing .",
    "for both the af and df protocols , the mr linear processing method is used .      with mr ,",
    "the processing matrix @xmath52 is given by @xcite @xmath118 where @xmath119 $ ] , @xmath120 $ ] .",
    "recall that @xmath53 satisfies the long - term total transmit power constraint at the relay , and after some simple algebraic manipulations , we have @xmath121      with mr , the processing matrix @xmath64 and @xmath66 are given by @xmath122^h,\\\\    { \\bf j } & =   \\left [ { \\bf { \\hat g}}_{rb } , { \\bf { \\hat g}}_{ar } \\right]^*,\\end{aligned}\\ ] ] respectively , while @xmath71 is given by @xmath123",
    "in this section , we investigate the spectral efficiency ( in bit / s / hz ) of the two - way half - duplex relaying system . in particular , for the af protocol , an exact spectral efficiency expression in closed - form is derived for arbitrary @xmath0 .",
    "furthermore , two large - scale approximations of the spectral efficiency for both protocols are deduced when @xmath7 .      without loss of generality , we focus on the characterization of the achievable spectral efficiency of user @xmath29 . with the af protocol ,",
    "when @xmath29 receives the superimposed signal from @xmath32 , it first makes an attempt to subtract its own transmitted message according to its available csi ( known as self - interference cancellation ) . in the current work ,",
    "we consider the realistic case where the users do not have access to instantaneous csi , hence @xmath29 uses only statistical csi to cancel the self - interference .",
    "therefore , after cancelling partial self - interference , i.e. , @xmath124 , the received signal at @xmath29 can be re - expressed as @xmath125    note that , @xmath29 tries to utilize the statistical information @xmath126 to cancel partial interference .",
    "focusing on this , we have @xmath127 which indicates that no effective self - interference cancellation can be achieved by @xmath29 if only statistical csi is available . in sharp contrast , if @xmath29 knows perfect or estimated csi , it is capable of completely canceling the self - interference @xcite , or @xmath128 @xcite , respectively . nevertheless , the overhead associated with csi acquisition at users may overweigh the performance gains brought by effective self - interference cancellation , particularly in massive mimo systems .    using a standard approach as in @xcite ,",
    "an ergodic achievable spectral efficiency of @xmath29 is @xmath129 where @xmath130    thus , the ergodic sum spectral efficiency of the multipair two - way af relaying system is given by @xmath131 where @xmath132 is the spectral efficiency of @xmath30 , which can be derived in a similar fashion .    in the following ,",
    "we present an exact analysis of the spectral efficiency based on .",
    "[ theor:0 ] with the af protocol , the ergodic spectral efficiency @xmath133 for an arbitrary number of relay antennas is given by with @xmath134    see appendix [ app : theor:0 ] .",
    "theorem [ theor:0 ] presents an exact spectral efficiency in closed - form , which is applicable to arbitrary system configurations .",
    "however , the expression is too complicated to provide useful insights .",
    "using the fact that the relay is equipped with a massive antenna array , we now obtain a simple and accurate approximation for the spectral efficiency .",
    "[ theor:1 ] with the af protocol , as the number of relay antennas grows to infinity , then we have @xmath135 , where @xmath136 is given by @xmath137 where @xmath138    when @xmath0 is infinitely large , the lower order terms in , , , , and are trivial . thus , by removing them and keeping only the highest order terms , we complete the proof .",
    "theorem [ theor:1 ] presents a large - scale approximation of the _ i_-th user s spectral efficiency . despite being obtained under the massive array assumption ,",
    "the approximation turns out to be very accurate even for finite number of relay antennas .",
    "in addition , it is easy to observe the impact of various factors on the spectral efficiency .",
    "for instance , @xmath139 represents the influence of the estimation error , @xmath140 denotes the residual self - interference , @xmath141 stands for the inter - user interference caused by other user pairs , and @xmath142 is composed of the snr at the relay and the end @xmath29 .    from theorem [ theor:1 ] , we observe that @xmath136 is an increasing function with respect to @xmath0 , while a decreasing function with respect to @xmath139 , @xmath143 , @xmath141 , and @xmath142 .",
    "also , focusing on the term @xmath141 , it can be seen that the individual user spectral efficiency @xmath136 decreases with the number of user pairs @xmath28 ; this is anticipated since a higher number of users increases the amount of inter - user interference .",
    "now , we focus on studying the impact of the transmit power of _",
    "i_-th user pair @xmath46 and @xmath47 , the transmit power of the relay @xmath55 , and the transmit power of each pilot symbol @xmath79 on the system performance .",
    "as can be seen , when @xmath144 and @xmath145 , the spectral efficiency is limited by @xmath55 and @xmath79 ; in contrast , it is limited by @xmath46 , @xmath47 , and @xmath79 when @xmath146 . moreover ,",
    "when @xmath144 , @xmath145 , and @xmath146 , @xmath147 , which indicates that the noise at the relay and @xmath29 can be neglected when the transmit powers of each user and the relay are large enough .      with the df protocol , in the first phase",
    ", a linear processing matrix @xmath148 is applied to the received signals prior to signal detection , hence , the post - processing signals at the relay are given by @xmath149,\\end{aligned}\\ ] ] where the top @xmath28 elements of @xmath65 stand for the signals from @xmath29 ( @xmath31 ) , while the bottom @xmath28 elements of @xmath65 represent the signals from @xmath30 ( @xmath31 ) . without loss of generality , we focus only on the _",
    "i_-th pair of users , i.e. , @xmath29 and @xmath30 .",
    "this is a superposition of the _ i_-th and _",
    "( n+i)_-th elements of @xmath150 , and can be expressed as @xmath151 since the relay has estimated csi , it treats the channel estimates as the true channels to decode the signals . to this end , using a standard bound based on the worst - case uncorrelated additive noise @xcite yields the ergodic spectral efficiency of the _ i_-th user pair in the first phase @xmath152 where the inner and outer expectations are taken over the estimation errors and channel estimates , respectively , and @xmath153    in addition , the ergodic spectral efficiency of the @xmath154 ( @xmath57 ) link can be obtained as @xmath155 in the second phase , the relay broadcasts to all users using the mr principle ; hence the received signal at @xmath56 is given by @xmath156    similar to the af protocol , partial self - interference cancellation according to the statistical knowledge of the channel gains can be performed at @xmath29 and @xmath30 after receiving the superimposed signal from @xmath32 .",
    "thus the post - processing signals at @xmath29 and @xmath30 can be re - expressed as , @xmath157    therefore , the ergodic spectral efficiency of the @xmath158 link is expressed as @xmath159 where @xmath160 now , according to @xcite , the ergodic spectral efficiency of the _ i_-th user pair can be expressed as @xmath161 where @xmath162    thus , the ergodic sum spectral efficiency of the multipair two - way df relaying system is given by @xmath163    when @xmath32 employs a very large antenna array , i.e. , @xmath7 , the large - scale approximation of the spectral efficiency of the _ i_-th user pair is presented in the following theorem .",
    "[ theor:1:df ] with the df protocol , as the number of relay antennas grows to infinity",
    ", then we have @xmath164 , where @xmath165 is given by @xmath166 with @xmath167 where @xmath168 and @xmath169 and @xmath170 are obtained by replacing the transmit powers @xmath46 , @xmath47 , and the subscripts `` ar '' , `` rb '' with the transmit powers @xmath47 , @xmath46 , and the subscripts `` rb '' , `` ar '' in @xmath171 and @xmath172 , respectively .    see appendix [ app : theor:1:df].theorem [ theor:1:df ] provides a large - scale approximation of the _ i_-th user pair s spectral efficiency .",
    "more specifically , @xmath173 , @xmath171 , and @xmath169 are computed by utilizing the law of large numbers , while @xmath172 and @xmath170 are the exact expressions for @xmath174 and @xmath175 . from this approximation , we can see that @xmath165 is an increasing function with respect to @xmath46 , @xmath47 , and @xmath55 .",
    "however , when @xmath144 , @xmath145 , and/or @xmath146 , @xmath165 converges to a non - zero limit , due to strong inter - user interference .",
    "moreover , we observe that @xmath165 increases with the number of relay antennas @xmath0 , indicating the strong advantage of employing massive antenna arrays at the relay , while decreases with the number of user pairs @xmath28 , which is expected since larger number of users increases the amount of inter - user interference . finally , when @xmath176 the bottleneck of spectral efficiency occurs in the second phase , while the opposite holds when @xmath177 and @xmath178 , where we have @xmath179    it is of interest to compare the achievable sum rates of af and df protocols in the low @xmath46 and @xmath47 regime for massive mimo systems which have the potential to save an order of magnitude in transmit power .",
    "then , we have the following corollary .",
    "[ coro : af : vs : df ] in the low snr regime , i.e. , @xmath180 and @xmath181 , we have @xmath182 .",
    "when @xmath177 and @xmath178 , we have @xmath183 to this end , it can be shown that @xmath184 which completes the proof .",
    "corollary [ coro : af : vs : df ] indicates that the af protocol outperforms the df protocol in the low snr regime .",
    "we now present numerical results to validate the above analytical results .",
    "for all illustrative examples , the following set of parameters are used in simulation .",
    "the length of the coherence interval is @xmath185 ( symbols ) , chosen by the lte standard .",
    "the length of the pilot sequences is @xmath186 which is the minimum requirement . for simplicity",
    ", we set the large - scale fading coefficient @xmath187 , and assume that each user has the same transmit power , i.e. , @xmath188 .",
    "we assume that @xmath189 , and that the total transmit power of the @xmath28 user pairs is equal to the transmit power of the relay , i.e. , @xmath190 .",
    "[ fig : rate_snr ] shows the sum spectral efficiency versus the transmit power of each user @xmath191 for different number of relay antennas . note that the `` approximations '' curves are obtained by using and , and the `` numerical results '' curves are generated by monte - carlo simulation according to and by averaging over @xmath192 independent channel realizations , for the af and df protocols , respectively .",
    "as can be readily observed , the large - scale approximations are very accurate , especially for large antenna arrays .",
    "moreover , we can see that increasing the number of relay antennas significantly yields higher spectral efficiency , as expected .     for @xmath193 , @xmath189 and @xmath190 .",
    "]      we now compare the sum spectral efficiency of the af and df protocols for different system configurations , i.e. , different transmit powers @xmath191 , @xmath55 , and @xmath79 , and different number of relay antennas @xmath0 and user pairs @xmath28 .     for @xmath194 db and @xmath195 db . ]",
    "[ fig : rate_pu ] shows the sum spectral efficiency versus the transmit power of each user @xmath191 for different @xmath0 and @xmath28 with @xmath194 db and @xmath195 db .",
    "we can observe that for small @xmath191 , the af protocol outperforms the df protocol , which is consistent with the result in corollary [ coro : af : vs : df ] .",
    "the reason is that when @xmath191 is small , the spectral efficiency of the df protocol is limited by the performance in the first phase . on the other hand ,",
    "when @xmath191 is large , the noise amplification phenomenon of the af protocol will significantly affect the spectral efficiency of the relay to the destination link ; this makes df outperform the af protocol by eliminating the noise and preventing interference accumulation at the end users .     for @xmath196 db and @xmath195 db . ]",
    "[ fig : rate_pr ] provides the sum spectral efficiency versus the transmit power of the relay @xmath55 for different @xmath0 and @xmath28 with @xmath196 db and @xmath195 db .",
    "as we can observe , the df protocol is superior to the af protocol in the low @xmath55 regime but becomes inferior in the high @xmath55 regime .",
    "this is due to the fact that low @xmath55 makes the af protocol suffer severe noise amplification effect and thus leads to spectral efficiency reduction .",
    "in addition , focusing on the particular operating point @xmath197 db , we see that the df protocol achieves higher sum spectral efficiency when @xmath198 and @xmath199 , while the af protocol becomes better when @xmath8 and @xmath199 or @xmath200 and @xmath199 .",
    "the reason is that the residual interference due to inaccurate channel estimation is a key performance limiting factor for the af protocol ; in other words , the larger the @xmath28 , the stronger the interference . as such , less user pairs are preferable for the af protocol",
    ". however , it turns out that increasing the number of relay antennas is an effective way to mitigate such a detrimental effect .     for @xmath201 db and @xmath197 db . ]",
    "[ fig : rate_pp ] presents the sum spectral efficiency versus the transmit power of each pilot symbol @xmath79 for different @xmath0 and @xmath28 with @xmath201 db and @xmath197 db .",
    "similarly , we observe that for fixed @xmath193 and @xmath0 , the df protocol outperforms the af protocol in the low @xmath79 regime while the converse holds in the high @xmath79 regime . in addition , focusing on the curves associated with @xmath8 and @xmath202 , we see that the spectral efficiency of the df protocol is higher than that of the af protocol , indicating that a large @xmath28 is preferred for the df protocol .",
    "[ fig.label1 ] illustrates the impact of number of user pairs @xmath28 on the sum spectral efficiency when @xmath203 db and @xmath201 db . as expected , for each system configuration , there exists an optimal number of user pairs @xmath28 maximizing the spectral efficiency of both the af and df protocols . with fixed @xmath55 , as shown in fig .",
    "[ fig : fixedpr ] , the df protocol achieves higher spectral efficiency than the af protocol when @xmath28 is large .",
    "however , this is not the case if @xmath55 scales linearly with @xmath28 , as shown in fig .",
    "[ fig : variablepr ] , where the af protocol always outperforms the df protocol .",
    "in addition , the performance gap widens when the number of antennas @xmath0 increases .",
    "in this section , we pursue a detailed investigation of the power scaling laws of both the af and df protocols ; that is , how the powers can be reduced with @xmath0 while retaining non - zero spectral efficiency .",
    "since we are interested in the general user s power scaling law rather than a particular user s behavior , we assume that all the users have the same transmit power , i.e. , @xmath188 .",
    "then , we characterize the interplay between the relay s transmit power @xmath55 , the user s transmit power @xmath191 , and the transmit power of each pilot symbol @xmath79 , as the number of relay antennas @xmath0 grows to infinity . more precisely ,",
    "we consider three different scenarios :    * scenario a : fixed @xmath191 and @xmath55 , while @xmath204 with @xmath205 , and @xmath206 being a constant .",
    "such a scenario represents the potential of power saving in the training phase . *",
    "scenario b : fixed @xmath79 , while @xmath207 , @xmath208 , with @xmath209 and @xmath210 , and @xmath211 , @xmath212 are constants .",
    "hence , the channel estimation accuracy remains unchanged in scenario b , and the objective is to study the potential power savings in the data transmission phase , as well as , the interplay between the user and relay transmit powers . *",
    "scenario c : this is the most general case where @xmath207 , @xmath208 , and @xmath204 , with @xmath209 , @xmath210 , and @xmath205 , @xmath211 , @xmath212 , and @xmath206 are constants .",
    "the af protocol gives the following result .",
    "[ theor:2 ] with the af protocol , for fixed @xmath191 , @xmath55 and @xmath206 , when @xmath204 with @xmath205 , as @xmath7 , we have @xmath213 where @xmath214    see appendix [ app : theor:2 ] .    theorem [ theor:2 ] implies that the large - scale approximation of the spectral efficiency @xmath215 depends on the choice of @xmath6 .",
    "when @xmath216 , @xmath215 reduces to zero due to the poor channel estimation accuracy caused by over - reducing the pilot transmit power . in contrast , when @xmath217 , @xmath218 grows without bound , which indicates that the transmit power of each pilot symbol can be scaled down further .",
    "finally , when @xmath219 , @xmath218 converges to a non - zero limit , which suggests that with large antenna arrays , the transmit power of each pilot symbol can be scaled down at most by @xmath220 to maintain a given quality - of - service ( qos ) .",
    "a corresponding scaling law for scenario b is obtained as follows .",
    "[ theor:3 ] with the af protocol , for fixed @xmath79 , @xmath211 , and @xmath212 , when @xmath207 , @xmath208 , with @xmath209 , @xmath210 , as @xmath7 , we have @xmath221    substituting @xmath207 and @xmath208 into , it is easy to show that @xmath222 , @xmath223 , and @xmath224 , as @xmath7 .",
    "hence , keeping the most significant term @xmath142 , omitting the non - significant terms , namely , @xmath139 , @xmath143 , and @xmath141 , and utilizing the fact that @xmath225 yields the desired result .",
    "theorem [ theor:3 ] reveals that in scenario b , the estimation error , the residual self - interference , and the inter - user interference vanish completely , and only the compound noise remains , as @xmath7 .",
    "the reason is that the compound noise becomes significant as @xmath7 , compared to the estimation error , residual self - interference , and inter - user interference .",
    "moreover , it is observed that the compound noise consists of two parts , namely part i and part ii as shown in , which represent the noise at the relay and the noise at the user @xmath29 , respectively .",
    "this observation can be interpreted as , when both the transmit powers of each user and the relay are scaled down inversely proportional to @xmath0 , the effect of noise becomes increasingly significant .",
    "in addition , we can also see that when the channel estimation accuracy is fixed , the large - scale approximation of the spectral efficiency @xmath215 depends on the value of @xmath4 and @xmath5 .",
    "when we cut down the transmit powers of the relay and/or of each user too much , namely , 1 ) @xmath226 , and @xmath210 , 2 ) @xmath209 , and @xmath227 , 3 ) @xmath226 , and @xmath227 , @xmath215 converges to zero . on the other hand ,",
    "when we cut down both the transmit powers of the relay and of each user moderately , namely , @xmath228 and @xmath229 , @xmath215 grows unboundedly . only if @xmath230 and/or @xmath231 , @xmath218 converges to a finite limit as detailed in the following corollaries .",
    "[ coro:3 ] with the af protocol , for fixed @xmath79 , @xmath211 , and @xmath212 , when @xmath232 , namely , @xmath233 , @xmath234 , as @xmath7 , the spectral efficiency has the limit @xmath235    from corollary [ coro:3 ] , we observe that when both the transmit powers of the relay and of each user are scaled down with the same speed , i.e. , @xmath220 , @xmath215 converges to a non - zero limit .",
    "moreover , this non - zero limit increases with @xmath211 and @xmath212 as expected . now consider the special case of all the links having the same large - scale fading , e.g. , @xmath236 , for @xmath237 , then the sum spectral efficiency of the system reduces to @xmath238 where @xmath239 .",
    "therefore , the sum spectral efficiency in is equal to the one of @xmath28 parallel single - input single - output channels with transmit power @xmath240 , without interference and small - scale fading .",
    "note that we only need @xmath241 power ( the transmit power of each user is @xmath242 , the transmit power of each pilot sequence is @xmath243 , and the transmit power of the relay is @xmath244 ) in multipair two - way af relaying systems when using very large number of relay antennas .",
    "this represents a remarkable power reduction , thereby showcasing the huge benefits from the perspective of radiated energy efficiency by deploying large antenna arrays .",
    "[ coro:4 ] with the af protocol , for fixed @xmath79 , @xmath211 and @xmath212 , when @xmath245 and @xmath246 , namely , @xmath233 , @xmath208 , as @xmath7 , the spectral efficiency has the limit @xmath247    corollary [ coro:4 ] presents an interesting phenomenon , that if the transmit power of each user is overly cut down compared to the reduction of the relay transmit power , @xmath215 converges to a non - zero limit that is determined by the noise at the relay .",
    "this observation is intuitive , since when both @xmath29 and @xmath30 transmit with extremely low power , the effect of noise at the relay becomes the performance limiting factor .",
    "similarly , when @xmath248 , we have the following corollary .    [ coro:5 ] with the af protocol , for fixed @xmath79 , @xmath211 , and @xmath212 , when @xmath249 and @xmath250 , namely , @xmath207 , @xmath234 , as @xmath7 , the spectral efficiency has the limit @xmath251    similar to the analysis in corollary [ coro:4 ] , if the down - scaling of the relay transmit power in the second phase is faster than that of the user transmit power in the first phase , the limit of @xmath215 will only depend on the noise at the users .",
    "next , we consider the most general case .",
    "[ theor:4 ] with the af protocol , for fixed @xmath211 , @xmath212 , and @xmath206 , when @xmath207 , @xmath208 , and @xmath204 , with @xmath209 , @xmath210 , and @xmath205 , as @xmath7 , we have @xmath252    the desired result can be obtained by following the similar lines as in the proof of theorem [ theor:2 ] .",
    "theorem [ theor:4 ] reveals the coupled relationship between the training power and user ( or relay ) transmit power .",
    "when @xmath253 and/or @xmath254 , @xmath215 converges to zero , due to either poor estimation accuracy or low user / relay transmit power . on the other hand , when @xmath255 and @xmath256 , @xmath215 grows without bound . only if @xmath257 and/or @xmath258 , @xmath215 converges to a non - zero limit . in the following ,",
    "we take a closer look at these particular cases of interest .",
    "[ coro:6 ] with the af protocol , for fixed @xmath211 , @xmath212 , and @xmath206 , when @xmath259 and @xmath257 , namely , @xmath207 , @xmath208 , and @xmath204 , with @xmath205 , as @xmath7 , the spectral efficiency has the limit @xmath260    corollary [ coro:6 ] suggests that no matter how @xmath4 , @xmath5 , and @xmath6 change , as long as the overall power reduction rate at the user / relay and pilot symbol remains the same , i.e. , @xmath257 , the same asymptotic spectral efficiency can be attained . in other words , it is possible to balance between the pilot symbol power to the user / relay transmit power .",
    "[ coro:7 ] with the af protocol , for fixed @xmath211 , @xmath212 , and @xmath206 , when @xmath261 and @xmath257 , namely , @xmath207 , @xmath208 , and @xmath204 , with @xmath205 , as @xmath7 , the spectral efficiency has the limit @xmath262    when @xmath261 and @xmath257 , @xmath263 , hence , the first term in the denominator of ( [ eqn : ccc ] ) becomes the dominant item , yielding the desired result .    from corollary [ coro:7 ] , we observe the same trade - off between @xmath4 and @xmath6 as in corollary [ coro:6 ] , when @xmath261 .",
    "however , the spectral efficiency is only related to the noise at the relay . in addition , we also see that the limit of @xmath215 is independent of the number of users ; thus , we conclude that the sum spectral efficiency of the system is an increasing function with respect to @xmath28 .",
    "specifically , it is a linear function of @xmath28 when assuming all the users have the same large - scale fading , e.g. , setting @xmath236 . so",
    "in this case , a large number of users will boost the sum spectral efficiency .",
    "[ coro:8 ] with the af protocol , for fixed @xmath211 , @xmath212 , and @xmath206 , when @xmath264 and @xmath265 , namely , @xmath207 , @xmath208 , and @xmath204 , with @xmath205 , as @xmath7 , the spectral efficiency has the limit @xmath266    from corollary [ coro:8 ] , we see that when we cut down the transmit power of the relay more compared with the transmit power of each user , i.e. , @xmath267 , to obtain a constant limit spectral efficiency , the trade - off between the transmit powers of the relay and of each pilot symbol should be satisfied , namely , @xmath265 .",
    "this informative trade - off provides valuable insights , since we can adjust the transmit powers of the relay and of each pilot symbol flexibly based on different demands , to meet the same limit .",
    "in addition , corollary [ coro:8 ] also shows that @xmath215 is an increasing function with respect to @xmath206 and @xmath212 , while an decreasing function of @xmath28 . in other words , when the number of user pairs @xmath28 increases ,",
    "the relay and/or each pilot symbol should increase their power in order to maintain the same performance .",
    "this is due to the fact that large transmit power of the relay and/or more accurate channel estimation can compensate the individual rate loss caused by stronger inter - user interference .",
    "similarly , we present the following power scaling law for scenario a with the df protocol .",
    "[ theor:2:df ] with the df protocol , for fixed @xmath191 , @xmath55 and @xmath206 , when @xmath204 with @xmath205 , as @xmath7 , we have @xmath268 where @xmath269 with @xmath270 and @xmath271 and @xmath272 are obtained by replacing the subscripts `` ar '' , `` rb '' in @xmath273 and @xmath274 with the subscripts `` rb '' , `` ar '' , respectively .",
    "similar to the af protocol , the large - scale approximation of the spectral efficiency @xmath275 in scenario a also depends on the choice of @xmath6 .",
    "when we cut down @xmath79 too much , i.e. , @xmath216 , @xmath275 converges to zero . on the other hand , when @xmath276 , @xmath275 grows unboundedly .",
    "finally , when @xmath219 , @xmath215 converges to a non - zero limit .",
    "next , we turn our attention to scenario b and present the following result .",
    "[ theor:3:df ] with the df protocol , for fixed @xmath79 , @xmath211 , and @xmath212 , when @xmath207 , @xmath208 , with @xmath209 , @xmath210 , as @xmath7 , we have @xmath277 where @xmath278 with @xmath279 and @xmath271 and @xmath272 are obtained by replacing the subscripts `` ar '' , `` rb '' in @xmath273 and @xmath274 with the subscripts `` rb '' , `` ar '' , respectively .",
    "similar to the af case , theorem [ theor:3:df ] indicates that when both the transmit power of each user @xmath191 and the transmit power of the relay @xmath55 are scaled down inversely proportional to @xmath0 ( @xmath7 ) , the effect of estimation error , residual self - interference , and inter - user interference vanishes , and the only remaining impairment comes from the noise at users and the relay .",
    "moreover , when each user s transmit power is sufficiently large , i.e. , @xmath280 , the large - scale approximation of @xmath275 is determined only by @xmath274 and @xmath272 , suggesting that the bottleneck of spectral efficiency appears in the second phase .",
    "in contrast , when the relay s transmit power becomes large , i.e. , @xmath281 , the large - scale approximation of @xmath275 is determined only by @xmath282 , @xmath273 , @xmath271 , indicating that the bottleneck of spectral efficiency occurs in the first phase .",
    "also , as in the af case , when we cut down the transmit powers of the relay and/or of each user too much , namely , 1 ) @xmath226 , and @xmath210 , 2 ) @xmath209 , and @xmath227 , 3 ) @xmath226 , and @xmath227 , @xmath275 converges to zero . on the contrary ,",
    "when we cut down both the transmit powers of the relay and of each user moderately , i.e. , @xmath228 and @xmath229 , @xmath275 grows unboundedly .",
    "so the most important task is how to select the parameters @xmath4 and @xmath5 to make @xmath275 converge to a non - zero finite limit .",
    "we discuss this in the following corollaries .",
    "[ coro:3:df ] with the df protocol , for fixed @xmath79 , @xmath211 , and @xmath212 , when @xmath232 , namely , @xmath233 , @xmath234 , as @xmath7 , the spectral efficiency of the _ i_-th user pair has the limit @xmath283 where @xmath284 with @xmath285 and @xmath271 and @xmath272 are obtained by replacing the subscripts `` ar '' , `` rb '' in @xmath273 and @xmath274 with the subscripts `` rb '' , `` ar '' , respectively .",
    "corollary [ coro:3:df ] reveals that when both the transmit powers of the relay and of each user are scaled down with the same speed , i.e. , @xmath220 , @xmath275 converges to a non - zero limit .",
    "moreover , this non - zero limit is an increasing function with respect to @xmath211 and @xmath212 , while a decreasing function with respect to the number of user pairs @xmath28 .",
    "[ coro:4:df ] with the df protocol , for fixed @xmath79 , @xmath211 , and @xmath212 , when @xmath245 and @xmath246 , namely , @xmath233 , @xmath208 , as @xmath7 , the spectral efficiency of the _ i_-th user pair has the limit @xmath286    when @xmath245 and @xmath246 , we can easily show that @xmath287 and @xmath288 , thus the large - scale approximation of the spectral efficiency @xmath275 becomes @xmath289    utilizing the fact @xmath290 for @xmath291 , we arrive at the desired result .",
    "corollary [ coro:4:df ] suggests that when we cut down the transmit power of each user too much , i.e. , @xmath292 , the large - scale approximation of the spectral efficiency is determined by the performance in the first phase , i.e. , @xmath282 , which depends only on @xmath211 , and is independent of @xmath212 .",
    "this result is expected since when the transmit power of each user is much less than the transmit power of the relay , the bottleneck of spectral efficiency occurs in the first phase . on the other hand , when the transmit power of the relay is cut down more compared with that of each user , i.e. , @xmath293",
    ", the bottleneck of spectral efficiency appears in the second phase , thus @xmath275 is determined by @xmath274 and @xmath272 as shown in the following corollary .",
    "[ coro:5:df ] with the df protocol , for fixed @xmath79 , @xmath211 , and @xmath212 , when @xmath249 and @xmath250 , namely , @xmath207 , @xmath234 , as @xmath7 , the spectral efficiency of the _ i_-th user pair has the limit @xmath294      finally , a corresponding power scaling law for scenario c is obtained as follows .",
    "[ theor:4:df ] with the df protocol , for fixed @xmath211 , @xmath212 , and @xmath206 , when @xmath207 , @xmath208 , and @xmath204 , with @xmath209 , @xmath210 , and @xmath205 , as @xmath7 , we have @xmath295 where @xmath296 with @xmath297 and @xmath271 and @xmath272 are obtained by replacing the subscripts `` ar '' , `` rb '' in @xmath273 and @xmath274 with the subscripts `` rb '' , `` ar '' , respectively .",
    "as expected , the large - scale approximation of the spectral efficiency @xmath275 depends on the relationship between @xmath4 , @xmath5 , and @xmath6 .",
    "moreover , the term @xmath298 determines the spectral efficiency in the first phase , while @xmath299 determines the spectral efficiency in the second phase , as elaborated in the following corollaries .",
    "[ coro:6:df ] with the df protocol , for fixed @xmath211 , @xmath212 , and @xmath206 , when @xmath259 and @xmath257 , namely , @xmath207 , @xmath208 , and @xmath204 , with @xmath205 , as @xmath7 , the spectral efficiency of the _ i_-th user pair has the limit @xmath283 where @xmath300 with @xmath301 and @xmath271 and @xmath272 are obtained by replacing the subscripts `` ar '' , `` rb '' in @xmath273 and @xmath274 with the subscripts `` rb '' , `` ar '' , respectively .",
    "similar to the af protocol , corollary [ coro:6:df ] also presents an informative trade - off between the transmit powers of each pilot symbol and of each user / the relay . in other words , if we cut down the transmit power of each pilot symbol too much , which causes poor channel estimation accuracy , the transmit power of each user / the relay should be increased to compensate this imperfection and maintain the same asymptotic spectral efficiency .",
    "[ coro:7:df ] with the df protocol , for fixed @xmath211 , @xmath212 , and @xmath206 , when @xmath261 and @xmath257 , namely , @xmath207 , @xmath208 , and @xmath204 , with @xmath205 , as @xmath7 , the spectral efficiency of the _ i_-th user pair has the limit @xmath302    from corollary [ coro:7:df ] , we can see that the limit of @xmath275 is an increasing function with respect to @xmath211 and @xmath206 , indicating that we can boost the spectral efficiency by increasing the transmit power of each user and of each pilot symbol .",
    "in addition , similar to the af protocol , the limit of @xmath275 is also independent of @xmath28 , indicating that the sum spectral efficiency of the system is an increasing function with respect to @xmath28 .",
    "[ coro:8:df ] with the df protocol , for fixed @xmath211 , @xmath212 , and @xmath206 , when @xmath264 and @xmath265 , namely , @xmath207 , @xmath208 , and @xmath204 , with @xmath205 , as @xmath7 , the spectral efficiency of the _ i_-th user pair has the limit @xmath303    corollary [ coro:8:df ] provides the trade - off between the transmit powers of the relay and of each pilot symbol , which is the same as for the af protocol .      in this subsection ,",
    "we provide numerical simulation results to verify the power scaling laws presented in the previous subsections , and investigate the potential for power saving when employing large number of antennas at the relay .",
    "note that the curves labelled as `` approximations '' are obtained according to theorems [ theor:1 ] and [ theor:1:df ] for the af and df protocols , respectively .     for @xmath193 , @xmath196 db , @xmath304 db , and @xmath305 with @xmath306 db . ]      fig .",
    "[ fig : scenario_a ] verifies the analytical results for scenario a. the curves labelled as `` scenario a : af '' , and `` scenario a : df '' , are plotted according to theorems [ theor:2 ] and [ theor:2:df ] for the af and df protocols , respectively .",
    "it can be readily observed that in the asymptotic large @xmath0 regime , the asymptotic curves converge to the exact curves , demonstrating the accuracy of the asymptotic analysis .",
    "in addition , when @xmath216 , i.e. , @xmath307 , the spectral efficiency of both the af and df schemes gradually approaches zero .",
    "in contrast , when @xmath308 , i.e. , @xmath309 , the spectral efficiency of both schemes grows unbounded . finally , when @xmath219 , the spectral efficiency converges to a non - zero limit for both schemes .",
    "[ fig.lable ] investigates how the scaling of the transmit power of each user @xmath207 and the transmit power of the relay @xmath208 affects the achievable spectral efficiency .",
    "in particular , three different cases are studied according to the values of @xmath4 and @xmath5 , as presented in table i. note that the curves labelled as `` scenario b : af '' and `` scenario b : df '' , are generated by using theorems [ theor:3 ] and [ theor:3:df ] , while the curves labelled as `` scenario b - case x : af '' and `` scenario b- case x : df '' with @xmath310 are plotted according to corollaries [ coro:3][coro:5 ] and corollaries [ coro:3:df][coro:5:df ] , for the af and df protocols , respectively .    [",
    "table : scenario : b ]    .power scaling cases in scenario b [ cols=\"^,^\",options=\"header \" , ]     in agreement with corollaries [ coro:3][coro:5 ] and corollaries [ coro:3:df][coro:5:df ] , the sum spectral efficiency of both the af and df schemes saturates in the asymptotical large @xmath0 regime for all the three cases . as readily observed , among the three cases , the sum spectral efficiency of case i , i.e. , @xmath232 , is the lowest , due to simultaneously cutting the transmit powers of each user and of the relay .",
    "moreover , fig .",
    "[ fig : scenario_b_case3_er ] suggests that increasing the relay power improves the sum spectral efficiency .",
    "in addition , with sufficiently large number of relay antennas , i.e. , @xmath311 , the df protocol outperforms the af protocol when @xmath312 db , while becomes inferior when @xmath313 db , which is in line with the results presented in fig .",
    "[ fig : rate_pr ] .    fig . [ fig.lable1 ] illustrates the other two extreme scenarios where the transmit power down - scaling is either too aggressive or too moderate .",
    "for the former scenario , three different cases are studied , i.e. , @xmath314 , @xmath315 , and @xmath316 .",
    "as expected , when the number of relay antennas increases , the sum spectral efficiency gradually reduces to zero",
    ". however , the speed of reduction varies significantly depending on the scaling parameters .",
    "the larger the scaling parameters , the faster the decay rate .",
    "on the other hand , fig .",
    "[ fig : scenario_b_unbounded ] shows that when we cut down the transmit powers of each user and of the relay moderately , the sum spectral efficiency of both the af and df schemes grows unboundedly .",
    "[ fig.label3 ] demonstrates the fundamental tradeoff between the user / relay power and the pilot symbol power . for illustration purposes ,",
    "two extreme scenarios where the transmit power down - scaling is either too aggressive or too moderate are considered . for the former scenario , two sets of curves",
    "are drawn according to @xmath317 , @xmath318 , @xmath319 and @xmath320 , @xmath321 , @xmath219 , which satisfy @xmath322 and @xmath323 .",
    "when the number of relay antennas grows large , the sum spectral efficiency of all system configurations smoothly converges to zero , as predicted .",
    "moreover , the gaps between the two sets of curves reduce with @xmath0 and eventually vanish .",
    "this indicates that as long as @xmath324 and @xmath325 are the same , the asymptotic sum spectral efficiency remains unchanged .",
    "now , let us focus on the two curves associated with the af protocol with @xmath326 .",
    "interestingly , we see that the curve associated with @xmath327 yields better sum spectral efficiency in the finite antenna regime , despite the fact that the user or relay power is over - reduced compared to the @xmath328 case , which suggests that it is of crucial importance to improve the channel estimation accuracy .",
    "the same behavior appears for the df protocol as shown in fig .",
    "[ fig : scenario_c_converge0_new ] , and the unbounded spectral efficiency scenario as shown in fig .",
    "[ fig : scenario_c_unbounded_new ] .",
    "power control is an effective means to enhance the sum spectral efficiency of the system . in this section ,",
    "we formulate a power allocation problem maximizing the sum spectral efficiency of both the af and df protocols subject to a total power constraint , i.e. , @xmath329 . for notational simplicity , we define @xmath330 , @xmath331^t$ ] , and @xmath332^t$ ] .      for mathematical tractability , instead of using the exact sum spectral efficiency expression in theorem [ theor:0 ] , we work with the large - scale approximation from theorem [ theor:1 ] which has shown be tight for even moderate @xmath0 .",
    "thus , the power allocation optimization problem is formulated as @xmath333 where @xmath334 is the large - scale approximation for the spectral efficiency of @xmath30 , which can be derived in a similar fashion .    since @xmath335 is an increasing function ,",
    "can be equivalently reformulated as @xmath336 : @xmath337 where @xmath338^t$ ] , @xmath339^t$ ] @xmath340 , @xmath341 , @xmath342 , @xmath343 , @xmath344 , and @xmath345 , @xmath346 , @xmath347 , @xmath348 , @xmath349 are obtained by replacing the subscripts `` ar '' , `` rb '' with `` rb '' , `` ar '' in @xmath350 , @xmath351 , @xmath352 , @xmath353 , @xmath354 , respectively .",
    "the above problem @xmath336 is identified as a complementary geometric programming problem , which is nonconvex @xcite .",
    "also , @xmath355 and @xmath356 are considered as the signal - to - interference - plus - noise ratio ( sinr ) of @xmath136 and @xmath334 , respectively .",
    "in addition , we have replaced the equality `` @xmath357 '' with `` @xmath358 '' in the first two constraints of problem @xmath336 ; however , this does not change or relax the original problem , since the objective function is decreasing with respect to @xmath355 and @xmath356 .",
    "therefore , we can guarantee that these two constraints must be active at any optimal solution of @xmath336 .",
    "it can be observed that all the inequality constraints can be transformed into posynomial functions , hence , if the objective function is also a posynomial function , the problem @xmath336 becomes a standard gp problem , and can be solved very efficiently with standard optimization tools such as cvx @xcite or ggplab @xcite .",
    "however , the objective function is not a posynomial function .",
    "fortunately , capitalizing on the technique proposed in ( * ? ? ?",
    "* lemma 1 ) , we can find a close local optimum of the original problem @xmath336 by solving a sequence of gps .",
    "the key idea is to use a monomial function @xmath359 to approximate @xmath360 near an arbitrary point @xmath361 , where @xmath57 , @xmath362 and @xmath363 . at each iteration ,",
    "the gp is obtained by replacing the posynomial objective function with its best local monomial approximation near the solution obtained at the previous iteration .",
    "now , we outline the successive approximation algorithm to solve the original problem @xmath336 in the following .",
    "initialization_. define a tolerance @xmath364 and parameter @xmath365 .",
    "set @xmath366 , the initial values of @xmath367 and @xmath368 are chosen according to the sinr in theorem [ theor:1 ] when letting @xmath369 , and @xmath370 .",
    "\\2 ) _ iteration @xmath23_. compute @xmath371 and @xmath372 . then , solve the following gp problem @xmath373 : @xmath374    denote the optimal solutions by @xmath375 and @xmath376 , @xmath377 .",
    "\\3 ) _ stopping criterion_. if @xmath378 and/or @xmath379 , stop ; otherwise , go to step 4 ) .",
    "\\4 ) _ update initial values_. set @xmath380 and @xmath381 , and @xmath382 . go to step 2 ) .",
    "please note , we have neglected @xmath383 and @xmath384 in the objective function of @xmath373 , since they are constants and do not affect the problem solution .",
    "also , some trust region constraints , i.e. , the first two constraints , are added , which limit how much the variables are allowed to differ from the current guess @xmath367 and @xmath368 .",
    "the convergence of the above algorithm to a karush - kuhn - tucker solution of the original nonconvex problem @xmath385 is guaranteed , and the detailed proof can be found in @xcite .",
    "the parameter @xmath386 controls the desired accuracy .",
    "more precisely , when @xmath365 is close to 1 it provides good accuracy for the monomial approximation but with slower convergence speed , and vice versa if @xmath365 is large . as discussed in @xcite , @xmath387 offers a good tradeoff between the accuracy and convergence speed .",
    "to gain further insights , we now consider the special case when all the users transmit with the same power , i.e. , @xmath188 , then , the optimization problem reduces to @xmath388    [ theor : opt : af : original ] @xmath389 is a convex optimization problem .",
    "see appendix [ app : theor : opt : af : original ] .    since the optimization problem @xmath389 is convex , the optimal solutions @xmath390 $ ] and @xmath391 $ ] maximizing the sum spectral efficiency can be solved efficiently by adopting some standard techniques , such as the bisection method with respect to @xmath392 .",
    "however , it is difficult to directly obtain closed - form expressions of @xmath393 and @xmath394 , since the objective function relies on the statistical characteristics of all the channel vectors . in order to simplify the analysis and provide some further insights",
    ", we assume that all the users have the same large - scale fading , e.g. , @xmath236 , thereby resulting in @xmath395 , @xmath396 , @xmath397 , and then the optimization problem @xmath389 reduces to @xmath398    the optimal solution of the optimization problem @xmath399 can be analytically characterized in the following theorem .",
    "[ theor : opt : af ] with the af protocol , the optimization problem @xmath399 is solved by @xmath400    see appendix [ app : theor : opt : af ] .",
    "theorem [ theor : opt : af ] suggests that for a given power budget @xmath401 , half of the total power should be allocated to the relay regardless of the number of users , and the remaining half should be equally allocated to the @xmath62 users .",
    "such a symmetric power allocation strategy is rather intuitive due to the symmetric system setup .",
    "in addition , it can be directly inferred that the optimal power @xmath402 decreases monotonically by increasing the number of user pairs @xmath28 , which serves as a useful guideline for practical system design .      for the df protocol , focusing on the large - scale approximation in theorem [ theor:1:df ] , the power allocation optimization problem is formulated as @xmath403    then",
    ", following similar procedures as the af protocol , can be equivalently reformulated as @xmath404 : @xmath405 where @xmath406^t$ ] , @xmath407^t$ ] , @xmath408^t$ ] , @xmath409 , @xmath410 , @xmath411 , + @xmath412 , @xmath413 , and @xmath414 , @xmath415 , @xmath416 are obtained by replacing the subscripts `` ar '' , `` rb '' with `` rb '' , `` ar '' in @xmath417 , @xmath418 , @xmath419 , respectively .    since the objective function @xmath420 can be approximated by a monomial function @xmath421 , where @xmath422 and @xmath423 , the main challenge to convert @xmath404 into a gp problem is to transform the first two inequality constraints into the form of posynomials .",
    "according to @xcite , the geometric mean is no larger than the arithmetic mean for any set of positive numbers ; thus we have @xmath424 where @xmath425 , @xmath426 , and @xmath427 , @xmath428 are the initialization values .    as a result , the first inequality constraint in @xmath404 can be approximated by @xcite @xmath429    now , we focus on the approximation of the second inequality constraint .",
    "following the idea proposed in ( * ? ? ?",
    "* lemma 1 ) , we use a monomial function @xmath430 to approximate @xmath431 near an arbitrary point @xmath432 . to make the approximation accurate , we need to ensure that @xmath433 as such , the parameters @xmath434 , @xmath435 , and @xmath436 can be computed as @xmath437 to this end , the second inequality constraint in @xmath404 can be approximated by @xmath438 where @xmath439 , @xmath440 , + @xmath441 , and @xmath442 , @xmath443 are the initialization values .",
    "we now outline the successive approximation algorithm to solve the original problem @xmath404 as follows .",
    "initialization_. define a tolerance @xmath364 and parameter @xmath365 .",
    "set @xmath366 , the initial values of @xmath444 , @xmath445 and @xmath446 are chosen according to the sinr in theorem [ theor:1:df ] .",
    "also , we set @xmath447 ,    \\2 ) _ iteration @xmath23_. compute @xmath422 , @xmath425 , @xmath426 , @xmath439 , @xmath440 , @xmath441 . then , solve the following gp problem @xmath448 : @xmath449    denote the optimal solutions by @xmath450 , @xmath451 , @xmath452 , @xmath453 , @xmath454 , @xmath377 .",
    "\\3 ) _ stopping criterion_. if @xmath455 and/or @xmath456 and/or @xmath457 and/or @xmath458 and/or @xmath459 , stop ; otherwise , go to step 4 ) .",
    "\\4 ) _ update initial values_. set @xmath460 , @xmath461 , @xmath462 , @xmath463 , @xmath464 , and @xmath382 . go to step 2 ) .",
    "similar to algorithms for the af protocol , we have removed @xmath465 in the objective function , since they do not affect the optimization problem .",
    "also , five extra inequalities as trust region constraints are included .",
    "algorithm [ algor : df ] focuses on the case where each user transmits with a different power , and yields a close local optimum of the original problem @xmath404 by solving a sequence of gps .",
    "now , we turn our attention to the scenario where all the users transmit with the same power , i.e. , @xmath188 ; hence , the problem reduces to the following special case : @xmath466    [ theor : opt : df : original ] @xmath467 is a convex optimization problem",
    ".    see appendix [ app : theor : opt : df : original ] .",
    "similar to the af protocol , the optimal solutions @xmath468 $ ] and @xmath469 $ ] maximizing the sum spectral efficiency can be solved efficiently by adopting some standard techniques , such as the bisection method with respect to @xmath392 , due to the convexity of the optimization problem @xmath467 .",
    "[ fig : power_allocation_rate_m ] illustrates the impact of the optimal power allocation scheme on the sum spectral efficiency when all users large - scale fading are different .",
    "the different large - scale fading parameters are arbitrarily generated by @xmath470 and @xmath471 , where @xmath472 is a log - normal random variable with standard deviation @xmath473 db , @xmath474 and @xmath475 are the locations of @xmath476 and @xmath477 from the relay , @xmath478 is the path loss exponent , and @xmath479 denotes the guard interval which specifies the nearest distance between the users and the relay .",
    "the relay is located at the center of a cell with a radius of @xmath480 meters and @xmath481 meters .",
    "we choose @xmath482 db , @xmath195 db , @xmath193 , @xmath483 $ ] , and @xmath484 $ ] .",
    "the optimal power allocation curves are generated by algorithm [ algor : af ] and algorithm [ algor : df ] . as a benchmark scheme for comparison",
    ", we also plot the sum spectral efficiency with uniform power allocation , i.e. , the relay transmit power equals to the sum user transmit power .",
    "please note that such a uniform power allocation scheme is optimal for the af protocol when all the users have the same large - scale fading parameters , as shown in theorem [ theor : opt : af ] .",
    "as can be observed , the optimal power allocation policy provides 34.8% and 89.2% spectral efficiency enhancement when @xmath8 , for the af and df protocols , respectively .",
    "this suggests that the improvement of the df protocol is more prominent .     for @xmath482",
    "db , @xmath195 db and @xmath193 . ]",
    "[ fig : power_allocation ] examines the impact of key system parameters such as @xmath0 , @xmath28 , and @xmath79 on the optimal power allocation scheme when every user has the same transmit power , i.e , @xmath188 . as expected , for a given power budget @xmath482 db ,",
    "the optimal user transmit power is a decreasing function with respect to the number of user pairs @xmath28 for both the af and df protocols , as shown in fig .",
    "[ fig : af_df ] .",
    "then , we focus on the df protocol and depict the outcomes in fig . [ fig : df ] . as can be seen , with fixed number of user pairs @xmath193 , the optimal user transmit power for the df protocol @xmath485 with @xmath200 is larger than that with @xmath486 , suggesting that we should increase the transmit power of each user when the number of relay antennas is large .",
    "in addition , when the pilot training power increases , i.e. , from @xmath487 db to @xmath203 db , the optimal user transmit power @xmath485 also increases , indicating that when the channel estimation accuracy is improved , we need to use a higher transmit power for each user .",
    "we have investigated the sum spectral efficiency of a multipair two - way half - duplex relaying system employing the mr scheme taking into account of realistic csi assumption .",
    "in particular , an exact expression was derived for the sum spectral efficiency of the af protocol and closed - form large - scale approximations of the spectral efficiency for both af and df protocols were obtained when the number of relay antennas is large . based on these expressions , a detailed comparison between the af and df protocols was conducted , and it was shown that the spectral efficiency of the af protocol is more sensitive in scenarios with low transmit power of the relay and pilot symbol , small number of relay antennas , and large number of user pairs .",
    "moreover , power scaling laws of the system were characterized , which showed that the transmit powers of user , relay , and pilot symbol can be scaled down inversely proportional to the number of relay antennas .",
    "in addition , it was revealed that there exists a fundamental tradeoff between the user / relay transmit power and pilot symbol power , which provides great flexibility for the design of practical systems .",
    "finally , the transmit powers of each user and the relay were optimized to enhance the sum spectral efficiency .",
    "the end - to - end sinr given in consists of five terms : 1 ) desired signal power @xmath488 ; 2 ) estimation error @xmath489 ; 3 ) residual self - interference @xmath490 ; 4 ) inter - user interference @xmath491 ; 5 ) compound noise @xmath492 .",
    "since @xmath502 , @xmath503 , @xmath106 , and @xmath108 are independent of each other , we can take expectation over the four vectors separately .",
    "utilizing the fact that @xmath504 , @xmath505 , and @xmath506 we have @xmath507      the first term in becomes @xmath510 where @xmath511 and @xmath512 .",
    "conditioned on @xmath108 , @xmath513 is a gaussian random variable with zero mean and variance @xmath110 which does not depend on @xmath108 whereas conditioned on @xmath106 , @xmath514 is a gaussian random variable with zero mean and variance @xmath114 which does not depend on @xmath106 .",
    "therefore , we have @xmath515 , @xmath516 , and @xmath517 .",
    "then , by using the fact that @xmath518 , @xmath519 , and @xmath520 , can be calculated as @xmath521                                                        here we only present the detailed derivation for @xmath173 and @xmath172 , since @xmath171 and @xmath169 can be obtained in a relatively straightforward way , while @xmath170 can be derived in the same fashion as @xmath172",
    ".    first , we focus on , which consists of five terms : 1 ) desired signal power of @xmath30 @xmath558 ; 2 ) desired signal power of @xmath29 @xmath559 ; 3 ) estimation error @xmath560 ; 4 ) inter - user interference @xmath561 ; 5 ) compound noise @xmath562 . for each of these five terms , we will subsequently derive a deterministic equivalent expression .",
    "for a given @xmath191 , the objective function of the optimization problem @xmath592 is an increasing function with respect to @xmath79 , while for a given @xmath79 , this function is an increasing function with respect to @xmath191 ; hence , the objective function is maximized when @xmath593 @xcite .      taking the second derivative with respect to @xmath191 yields @xmath599",
    "thus , @xmath136 is a strictly concave function with respect to @xmath191 .",
    "since nonnegative weighted sums preserve convexity @xcite , the objective function @xmath600 is also a strictly concave function with respect to @xmath191 .",
    "recall that the constraints of the optimization problem @xmath592 are all affine functions , and hence @xmath592 is a convex optimization problem .      substituting @xmath395 , @xmath396 , @xmath397 into the objective function in @xmath601 , after some simple algebraic manipulations",
    ", @xmath601 reduces to @xmath602 where @xmath603 with @xmath604 , @xmath605 , and @xmath606 .                now , focusing on @xmath613 and substituting @xmath593 into @xmath613 , it is easy to show that @xmath173 , @xmath171 , and @xmath169 can be reformulated as @xmath620 , while @xmath172 , and @xmath170 can be reformulated as @xmath621 , hence , @xmath173 , @xmath171 , @xmath169 , @xmath172 , and @xmath170 are all concave functions with respect to @xmath191 .    due to the convexity preservation property of pointwise maximum and nonnegative weighted sums operations @xcite , @xmath622 is also a concave function with respect to @xmath191 .",
    "therefore , @xmath623 is a concave function , which completes the proof .",
    "h. q. ngo , h. a. suraweera , m. matthaiou , and e. g. larsson , `` multipair full - duplex relaying with massive arrays and linear processing , '' _ ieee j. sel .",
    "areas commun .",
    "9 , pp . 17211737 , oct . 2014 .",
    "r. zhang , y - c .",
    "liang , c. c. chai , and s. cui `` optimal beamforming for two - way multi - antenna relay channel with analogue network coding , '' _ ieee j. sel .",
    "areas commun .",
    "5 , pp . 699712 , jun . 2009 .",
    "g. amarasuriya , c. tellambura , and m. ardakani , `` two - way amplify - and - forward multiple - input multiple - output relay networks with antenna selection , '' _ ieee j. sel .",
    "areas commun .",
    "8 , pp . 15131529 , sep . 2012 .",
    "r. s. ganesan , h. al - shatri , a. kuehne , t. weber , and a. klein , `` pair - aware interference alignment in multi - user two - way relay networks , '' _ ieee trans .",
    "wireless commun . _ , vol .",
    "12 , no . 8 , pp . 36623671 , aug .",
    "2013 .",
    "f. rusek , d. persson , b. k. lau , e. g. larsson , t. l. marzetta , o. edfors , and f. tufvesson , `` scaling up mimo : opportunities and challenges with very large arrays , '' _ ieee signal process . mag .",
    "1 , pp . 4060 , jan .",
    "2013 .          c. wang",
    ", t. c .- k .",
    "liu , and x. dong , `` impact of channel estimation error on the performance of amplify - and - forward two - way relaying , '' _ ieee trans",
    "3 , pp . 11971207 , mar .",
    "2012 .",
    "j. gao , s. a. vorobyov , h. jiang , j. zhang , and m. haardt , `` sum - rate maximization with minimum power consumption for mimo df two - way relaying ",
    "part i : relay optimization , '' _ ieee trans . signal process .",
    "35633577 , july 2013 .",
    "j. gao , j. zhang , s. a. vorobyov , h. jiang , and m. haardt , `` power allocation / beamforming for df mimo two - way relaying : relay and network optimization , '' in _ proc .",
    "_ _ ieee globecom _ , dec .",
    "2012 , pp .",
    "56575662 .",
    "p. c. weeraddana , m. codreanu , m. latva - aho , and a. ephremides , `` resource allocation for cross - layer utility maximization in wireless networks , '' _ ieee trans .",
    "60 , no . 6 , pp . 27902809 ,",
    "july 2011 ."
  ],
  "abstract_text": [
    "<S> we consider a two - way half - duplex relaying system where multiple pairs of single antenna users exchange information assisted by a multi - antenna relay . taking into account the practical constraint of imperfect channel estimation , we study the achievable sum spectral efficiency of the amplify - and - forward ( af ) and decode - and - forward ( df ) protocols , assuming that the relay employs simple maximum ratio processing . </S>",
    "<S> we derive an exact closed - form expression for the sum spectral efficiency of the af protocol and a large - scale approximation for the sum spectral efficiency of the df protocol when the number of relay antennas , @xmath0 , becomes sufficiently large . </S>",
    "<S> in addition , we study how the transmit power scales with @xmath0 to maintain a desired quality - of - service . </S>",
    "<S> in particular , our results show that by using a large number of relay antennas , the transmit powers of the user , relay , and pilot symbol can be scaled down proportionally to @xmath1 , @xmath2 , and @xmath3 for certain @xmath4 , @xmath5 , and @xmath6 , respectively . </S>",
    "<S> this elegant power scaling law reveals a fundamental tradeoff between the transmit powers of the user / relay and pilot symbol . </S>",
    "<S> finally , capitalizing on the new expressions for the sum spectral efficiency , novel power allocation schemes are designed to further improve the sum spectral efficiency .    </S>",
    "<S> amplify - and - forward , decode - and - forward , geometric programming , massive mimo , power scaling law , two - way relaying . </S>"
  ]
}