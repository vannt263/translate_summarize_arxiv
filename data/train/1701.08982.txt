{
  "article_text": [
    "an important problem in evolutionary biology is to reconstruct the evolutionary history of a set of species .",
    "this commonly involves constructing some form of phylogenetic network , that is , a graph ( often a tree ) labeled by a set @xmath0 of species , for which some data ( e.g. molecular sequences ) has been collected . over the past four decades",
    "several ways have been introduced to construct phylogenetic trees ( see e.g. @xcite ) and , more recently , methods have been developed to construct more general phylogenetic networks ( see e.g. @xcite ) .",
    "one particular approach for constructing phylogenetic networks involves building them up from smaller networks .",
    "this approach is particularly useful when it is only feasible to compute networks from the biological data on small datasets ( e.g. when using likelihood approaches ) .",
    "the problem of building trees from smaller trees has been studied for some time ( where it is commonly known as the supertree problem ; cf .",
    "e.g. ( * ? ? ?",
    "* chapter 6 ) ) but the related problem for networks has been only considered more recently ( see e.g. @xcite focussing on directed phylogenetic networks and  @xcite focussing on pedigrees ) .",
    "even so , this problem can be extremely challenging .    in this paper",
    ", we shall present a unified approach to constructing phylogenetic networks from smaller networks .",
    "we shall consider _ unrooted _ phylogenetic networks ( cf .",
    "essentially , these are connected graphs with leaf - set labelled by a set @xmath0 ; they are called _ binary _ if the degree of every vertex is 1 or 3 . for such networks , we focus on the problem of reconstructing a phylogenetic network from its _ @xmath0-deck _ , roughly speaking , this is the collection of networks that is obtained by deleting one leaf and supressing the resulting degree-2 vertex .",
    "we call a network that can be reconstructed from its @xmath0-deck _ leaf - reconstructible_. see sections  [ sec : preliminaries ] and  [ sec : xdeck ] for formal definitions .",
    "intriguingly , the problem of reconstructing a graph from its vertex deleted subgraphs has been studied for over 75 years ( it was introduced in 1941 by kelly and ulam @xcite ) , where it is known as the _ reconstruction conjecture_. in particular , this conjecture states that every finite simple undirected graph on three of more vertices can be constructed from its collection of vertex deleted subgraphs . this conjecture remains open , but has been shown to hold for several large and important classes of graphs @xcite .",
    "even so , as we shall see , although determining leaf - reconstructibilty of a phylogenetic network is closely related to the reconstruction conjecture , there are several key differences which mean that they need to be treated as quite distinct problems .",
    "we now summarize the contents of the rest of the paper . in the next section",
    ", we present some preliminaries concerning phylogenetic networks . in section  [ sec : xdeck ] , we then formally define leaf - reconstructibility and explain why this concept is distinct from the notion of endvertex reconstructibilty a well - studied concept in graph reconstruction theory ( see @xcite ) .",
    "in addition , we show that certain key features of a binary phylogenetic network ( such as its level and reticulation number ) can be reconstructed from its @xmath0-deck .    in section  [ sec : decomp ]",
    ", we then show that a large class of phylogenetic networks , which we call _ decomposable networks _ are leaf - reconstructible",
    ". these are networks containing at least one cut - edge not incident to a leaf . to show this we first show that any phylogenetic tree with at least 5 leaves is leaf - reconstructible .",
    "we also note that phylogenetic trees with 4 leaves are not leaf - reconstructible .",
    "our result concerning decomposable networks is analogous to a result by yongzhi @xcite who showed that the graph reconstruction conjecture can be restricted to considering 2-connected graphs .",
    "the fact that decomposable networks are reconstructible implies that we can restrict our attention to leaf - reconstructibility of _ simple _ networks , that is , non - decomposable networks",
    ". an important feature of a phylogenetic network @xmath2 is its _ level _ , which measures how far away the network is from being a phylogenetic tree ( in particular , trees are level-0 networks ) . by considering certain subconfigurations in simple networks , in section  [ sec : simple ] ,",
    "we prove that , for fixed @xmath1 , almost all level-@xmath1 networks are leaf - reconstructible .    in section  [ sec : number ]",
    ", we then turn to the problem of computing the smallest number of elements in the @xmath0-deck of a leaf - reconstructible network that are required to reconstruct it , which we call its leaf - reconstruction number .",
    "this is analogous to the so - called reconstruction number of a graph ( cf .",
    "@xcite for a survey on these numbers ) .",
    "in particular , we show that the leaf - reconstruction number of any phylogenetic tree on 5 or more leaves is 2 , unless it is a star - tree in which case this number is 3 .",
    "we also show that this implies that the leaf - reconstruction number of any decomposable phylogenetic network with at least 5 leaves is 2 .    in section  [ sec : low ]",
    ", we turn our attention to low - level networks , showing that all binary level-4 networks with at least five leaves have leaf - reconstruction number at most  2 .",
    "the proof uses several lemmas that could be useful in studying the leaf - reconstructibility of higher - level networks .    in practice",
    ", most methods for constructing phylogenetic networks from smaller networks to date have focussed on using networks with small numbers of leaves ( in the rooted case , often 3-leaved networks ) . in section",
    "[ sec : quarnets ] , by using a recursive argument and our previous results , we show that any level-3 network can be reconstructed from its set of _ quarnets_. essentially , these are 4-leaved networks which are obtained from @xmath2 by selecting 4 leaves in the network , removing all other leaves and suppressing degree-2 vertices , multi - edges and biconnected components with two incident cut - edges . our result on quartnets is analogous to results presented in @xcite for level-2 rooted phylogenetic networks .",
    "several variants of the reconstruction conjecture have been considered in the literature ( see @xcite ) .",
    "we can also consider variants for phylogenetic networks .",
    "in section  [ sec : idge ] , we consider the problem of reconstructing a phylogenetic network from its collection of edge - deleted subgraphs , showing that in this setting we can sharpen the leaf - reconstructibility bounds that we previously obtained .",
    "we then conclude in the last section by discussing the problem of reconstructing directed phylogenetic networks , as well as various open problems .",
    "in this section , we present some preliminaries concerning phylogenetic networks ( cf .",
    "@xcite )    let  @xmath0 be a finite set with  @xmath3 .",
    "a _ phylogenetic tree _ on  @xmath0 is a tree with no degree-2 vertices in which the leaves ( degree-1 vertices ) are bijectively labelled by the elements of  @xmath0 .",
    "a _ biconnected component _ of a graph is a maximal 2-connected subgraph and it is called a _ blob _ if it contains at least two edges .",
    "phylogenetic network _ on  @xmath0 is a connected graph  @xmath2 such that contracting each blob ( one by one ) into a single vertex gives a phylogenetic tree on  @xmath0 .",
    "a bipartition @xmath4 of  @xmath0 , with  @xmath5 is a _",
    "split _ of a phylogenetic network  @xmath2 if  @xmath2 contains a cut - edge  @xmath6 such that the elements of  @xmath7 and  @xmath8 are the leaf - labels of the two connected components of  @xmath9 .",
    "if this is the case , we also say that the split @xmath4 is _ induced _ by  @xmath6 . from the definition of a phylogenetic network",
    "it follows that each of its cut - edges induces a split and no two cut - edges induce the same split .",
    "moreover , the phylogenetic tree obtained by contracting each blob of  @xmath2 into a single vertex is the unique phylogenetic tree that has precisely the same splits as  @xmath2 .",
    "this phylogenetic tree is denoted  @xmath10 , see figure  [ fig : prelim ] for an example .",
    "a cut - edge is called _ trivial _ if at least one of its endpoints is a leaf .",
    "a phylogenetic network with at least one nontrivial cut - edge is called _",
    "decomposable_. we call a phylogenetic network _",
    "simple _ if it has precisely one blob .",
    "a _ pseudo - network _ on  @xmath0 is a multigraph with no degree-2 vertices in which the leaves ( degree-1 vertices ) are bijectively labelled by the elements of  @xmath0 .",
    "hence , each phylogenetic tree is a phylogenetic network and each phylogenetic network is a pseudo - network .",
    "we let  @xmath11 denote , respectively , the set of leaves , vertices and edges of a pseudo - network  @xmath2 . in addition , the phylogenetic tree  @xmath10 is defined as the phylogenetic tree obtained by contracting each blob of  @xmath2 into a single vertex and suppressing any resulting degree-2 vertices .",
    "two pseudo - networks  @xmath12 are _ equivalent _ , denoted  @xmath13 if there exists a graph isomorphism between  @xmath2 and  @xmath14 that is the identity on  @xmath0 .    a pseudo - network is called _ binary _ if every non - leaf vertex has degree  3 .",
    "note that our definition of a binary phylogenetic network is slightly different from the one presented in @xcite , and has the advantage that for fixed @xmath0 , there are only finitely many phylogenetic networks with fixed level and leaf - set @xmath0 ( essentially because the number of phylogenetic trees with leaf set @xmath0 is finite cf .",
    "note also that a binary phylogenetic network is simple precisely when it is not decomposable and not a star tree .",
    "however , this is not the case for nonbinary networks .",
    "in this section we introduce the concept of leaf - reconstructibility .",
    "we begin by defining the @xmath0-deck for a phylogenetic network on @xmath0 .    given a phylogenetic network  @xmath2 and a vertex  @xmath15 , the pseudo - network  @xmath16 is the result of deleting vertex  @xmath17 from  @xmath2 , together with its incident edges , and suppressing resulting degree-2 vertices . see figure  [ fig : prelim ] for an example . given a phylogenetic network  @xmath2 on  @xmath0 and  @xmath18 , the @xmath19-_deck _ of  @xmath2 is the multiset @xmath20 .",
    "( -.5,1 ) circle node[left ] @xmath21 ; ( 1,-.5 ) circle node[below ] @xmath22 ; ( 1,2.5 ) circle node[above ] @xmath23 ; ( 4,-.5 ) circle node[below ] @xmath24 ; ( 5.5,2.5 ) circle node[above right ] @xmath6 ; ( 0,1 ) circle ; ( 1,0 ) circle ; ( 1,2 ) circle ; ( 2,1 ) circle ; ( 3,1 ) circle ; ( 4,0 ) circle ; ( 5,1 ) circle ; ( 4,2 ) circle ; ( 5,2 ) circle ; ( 1,0 ) ",
    "( 0,1 ) ; ( 1,0 ) ",
    "( 2,1 ) ; ( 0,1 ) ",
    "( 1,2 ) ; ( 1,2 ) ",
    "( 2,1 ) ; ( 2,1 ) ",
    "( 3,1 ) ; ( 3,1 ) ",
    "( 4,2 ) ; ( 3,1 ) ",
    "( 4,0 ) ; ( 4,0 ) ",
    "( 5,1 ) ; ( 4,2 ) ",
    "( 5,1 ) ; ( 4,2 ) ",
    "( 5,2 ) ; ( 5,1 ) ",
    "( 5,2 ) ; ( 0,1 ) ",
    "( -.5,1 ) ; ( 1,0 ) ",
    "( 1,-.5 ) ; ( 1,2 )  ( 1,2.5 ) ; ( 4,0 ) ",
    "( 4,-.5 ) ; ( 5,2 )  ( 5.5,2.5 ) ; ( 2.5,-1.5 ) node @xmath2 ;    ( 1,1 ) circle node[left ] @xmath21 ; ( 2,0 ) circle node[below ] @xmath22 ; ( 2,2 ) circle node[above ] @xmath23 ; ( 4,0 ) circle node[below ] @xmath24 ; ( 4,2 ) circle node[above right ] @xmath6 ; ( 2,1 ) circle ; ( 3,1 ) circle ; ( 1,1 ) ",
    "( 2,1 ) ; ( 2,1 ) ",
    "( 2,2 ) ; ( 2,1 )  ( 2,0 ) ; ( 2,1 )  ( 3,1 ) ; ( 3,1 )  ( 4,0 ) ; ( 3,1 )  ( 4,2 ) ; ( 2.5,-1.5 ) node @xmath10 ;    ( -.5,1 ) circle node[left ] @xmath21 ; ( 1,-.5 ) circle node[below ] @xmath22 ; ( 4,-.5 ) circle node[below ] @xmath24 ; ( 5.5,2.5 ) circle node[above right ] @xmath6 ; ( 0,1 ) circle ; ( 1,0 ) circle ; ( 2,1 ) circle ; ( 3,1 ) circle ; ( 4,0 ) circle ; ( 5,1 ) circle ; ( 4,2 ) circle ; ( 5,2 ) circle ; ( 1,0 )  ( 0,1 ) ; ( 1,0 )  ( 2,1 ) ; ( 0,1 ) ",
    "( 2,1 ) ; ( 2,1 ) ",
    "( 3,1 ) ; ( 3,1 ) ",
    "( 4,2 ) ; ( 3,1 ) ",
    "( 4,0 ) ; ( 4,0 ) ",
    "( 5,1 ) ; ( 4,2 ) ",
    "( 5,1 ) ; ( 4,2 ) ",
    "( 5,2 ) ; ( 5,1 ) ",
    "( 5,2 ) ; ( 0,1 )  ( -.5,1 ) ; ( 1,0 ) ",
    "( 1,-.5 ) ; ( 4,0 ) ",
    "( 4,-.5 ) ; ( 5,2 ) ",
    "( 5.5,2.5 ) ; ( 2.5,-1.5 ) node @xmath25 ;    ( -.5,1 ) circle node[left ] @xmath21 ; ( 1,-.5 ) circle node[below ] @xmath22 ; ( 1,2.5 ) circle node[above ] @xmath23 ; ( 4,-.5 ) circle node[below ] @xmath24 ; ( 0,1 ) circle ; ( 1,0 ) circle ; ( 1,2 ) circle ; ( 2,1 ) circle ; ( 3,1 ) circle ; ( 4,0 ) circle ; ( 5,1 ) circle ; ( 4,2 ) circle ; ( 1,0 ) ",
    "( 0,1 ) ; ( 1,0 ) ",
    "( 2,1 ) ; ( 0,1 ) ",
    "( 1,2 ) ; ( 1,2 ) ",
    "( 2,1 ) ; ( 2,1 ) ",
    "( 3,1 ) ; ( 3,1 ) ",
    "( 4,2 ) ; ( 3,1 )  ( 4,0 ) ; ( 4,0 )  ( 5,1 ) ; ( 0,1 )  ( -.5,1 ) ; ( 1,0 ) ",
    "( 1,-.5 ) ; ( 1,2 ) ",
    "( 1,2.5 ) ; ( 4,0 ) ",
    "( 4,-.5 ) ; ( 4,2 ) to[out=-20,in=110 ] ( 5,1 ) ; ( 4,2 ) to[out=-70,in=160 ] ( 5,1 ) ; ( 2.5,-1.5 ) node @xmath26 ;    a _ @xmath19-reconstruction _ of a network  @xmath2 on  @xmath0 is a network  @xmath14 on  @xmath0 with  @xmath27 and  @xmath28 for all  @xmath29 .",
    "we call a phylogenetic network  @xmath2 @xmath19-_reconstructible _ if every @xmath19-reconstruction of  @xmath2 is equivalent to  @xmath2 .",
    "the @xmath19-_reconstruction number _ of a network  @xmath2 on  @xmath0 is the smallest  @xmath1 for which there is a subset @xmath30 with  @xmath31 such that  @xmath2 is  @xmath32-reconstructible .",
    "we are usually interested in the case that @xmath33 . for the case that  @xmath34",
    ", we will also refer to @xmath0-reconstruction , @xmath0-reconstructible and @xmath0-reconstruction number as _ leaf - reconstruction _",
    ", _ leaf - reconstructible _ and _ leaf - reconstruction number _ , respectively . it could also be interesting to take @xmath35 , but we shall not consider this possibility in this paper .    if  @xmath2 is a binary network on  @xmath0 and  @xmath36 then  @xmath2 can be obtained from  @xmath37 by _ attaching _",
    "@xmath38 to some edge  @xmath6 , i.e. , to subdivide  @xmath6 by a new vertex  @xmath17 and adding a vertex labelled  @xmath38 and an edge between  @xmath17 and  @xmath38 .",
    "for example , the network  @xmath2 in figure  [ fig : prelim ] is @xmath39-reconstructible since it can be uniquely reconstructed from  @xmath26 by attaching leaf  @xmath6 to one of the multi - edges .",
    "hence , this network has leaf - reconstruction number  1 .",
    "the networks in figure  [ fig : notleafreconstructible ] are not leaf - reconstructible since both networks have the same  @xmath0-deck .",
    "( -.5,1.5 ) circle node[left ] @xmath23 ; ( -.5,-.5 ) circle node[left ] @xmath21 ; ( 2.5,1.5 ) circle node[right ] @xmath22 ; ( 2.5,-.5 ) circle node[right ] @xmath24 ; ( 0,0 ) circle ; ( 1,0 ) circle ; ( 0,1 ) circle ; ( 1,1 ) circle ; ( 2,1 ) circle ; ( 2,0 ) circle ; ( 0,0 )  ( 0,1 ) ; ( 0,0 )  ( 1,0 ) ; ( 0,1 )  ( 1,1 ) ; ( 1,0 )  ( 1,1 ) ; ( 1,1 )  ( 2,1 ) ; ( 1,1 )  ( 1,0 ) ; ( 1,0 )  ( 2,0 ) ; ( 2,1 )  ( 2,0 ) ; ( 0,0 )  ( -.5,-.5 ) ; ( 0,1 )  ( -.5,1.5 ) ; ( 2,0 )  ( 2.5,-.5 ) ; ( 2,1 )  ( 2.5,1.5 ) ;    ( -.5,1.5 ) circle node[left ] @xmath23 ; ( -.5,-.5 ) circle node[left ] @xmath21 ; ( 2.5,1.5 ) circle node[right ] @xmath24 ; ( 2.5,-.5 ) circle node[right ] @xmath22 ; ( 0,0 ) circle ; ( 1,0 ) circle ; ( 0,1 ) circle ; ( 1,1 ) circle ; ( 2,1 ) circle ; ( 2,0 ) circle ; ( 0,0 )  ( 0,1 ) ; ( 0,0 )  ( 1,0 ) ; ( 0,1 )  ( 1,1 ) ; ( 1,0 )  ( 1,1 ) ; ( 1,1 )  ( 2,1 ) ; ( 1,1 )  ( 1,0 ) ; ( 1,0 )  ( 2,0 ) ; ( 2,1 )  ( 2,0 ) ; ( 0,0 )  ( -.5,-.5 ) ; ( 0,1 )  ( -.5,1.5 ) ; ( 2,0 ) ",
    "( 2.5,-.5 ) ; ( 2,1 ) ",
    "( 2.5,1.5 ) ;    at first sight it might appear that leaf - reconstructibility of a phylogenetic network could be equivalent to endvertex - reconstructibility ( where one tries to reconstruct a graph from the deck obtained by deleting only its endvertices , i.e. leaves , cf .",
    "@xcite ) . however , these are distinct concepts . for example , the phylogenetic networks in figure  [ fig : notendvertexreconstructible ] are leaf - reconstructible .",
    "however , considered as graphs ( with no labels ) , they are not endvertex - reconstructible , as they both have the same endvertex deck @xcite .",
    "conversely , the networks in figure  [ fig : notleafreconstructible ] are endvertex - reconstructible but not leaf - reconstructible .",
    "( -.5,-.5 ) circle node[left ] @xmath38 ; ( 4.5,-.5 ) circle node[right ] @xmath40 ; ( 4.5,.5 ) circle node[right ] @xmath41 ; ( 0,0 ) circle ; ( 2,0 ) circle ; ( 4,0 ) circle ; ( 2,.5 ) circle ; ( 2,1 ) circle ; ( 1.67,1.5 ) circle ; ( 2.33,1.5 ) circle ; ( 1.33,2 ) circle ; ( 2.66,2 ) circle ; ( 2,3 ) circle ; ( 0,0 )  ( 4,0 ) ; ( 0,0 )  ( 2,.5 ) ; ( 2,0 )  ( 2,1 ) ; ( 4,0 )  ( 2.33,1.5 ) ; ( 4,0 )  ( 2,3 ) ; ( 0,0 )  ( 2,3 ) ; ( 2,1 )  ( 2.67,2 ) ; ( 2,1 )  ( 1.33,2 ) ; ( 2,3 )  ( 1.67,1.5 ) ; ( -.5,-.5 )  ( 0,0 ) ; ( 4,0 )  ( 4.5,0.5 ) ; ( 4,0 )  ( 4.5,-0.5 ) ;    ( -.5,-.5 ) circle node[left ] @xmath40 ; ( 4.5,-.5 ) circle node[right ] @xmath38 ; ( -.5,.5 ) circle node[left ] @xmath41 ; ( 0,0 ) circle ; ( 2,0 ) circle ; ( 4,0 ) circle ; ( 2,.5 ) circle ; ( 2,1 ) circle ; ( 1.67,1.5 ) circle ; ( 2.33,1.5 ) circle ; ( 1.33,2 ) circle ; ( 2.66,2 ) circle ; ( 2,3 ) circle ; ( 0,0 )  ( 4,0 ) ; ( 0,0 )  ( 2,.5 ) ; ( 2,0 )  ( 2,1 ) ; ( 4,0 )  ( 2.33,1.5 ) ; ( 4,0 ) ",
    "( 2,3 ) ; ( 0,0 ) ",
    "( 2,3 ) ; ( 2,1 ) ",
    "( 2.67,2 ) ; ( 2,1 ) ",
    "( 1.33,2 ) ; ( 2,3 ) ",
    "( 1.67,1.5 ) ; ( -.5,-.5 )  ( 0,0 ) ; ( 0,0 ) ",
    "( -.5,0.5 ) ; ( 4,0 )  ( 4.5,-0.5 ) ;    we call a class  @xmath42 of phylogenetic networks _ leaf - reconstructible _ if each  @xmath43 is leaf - reconstructible",
    ". a function  @xmath44 defined on  @xmath42 is _ leaf - reconstructible _ if for each  @xmath43 and for any leaf - reconstrution  @xmath45 of  @xmath2 we have  @xmath46 .",
    "class  @xmath42 is _ weakly leaf - reconstructible _ if , for each network  @xmath43 , all leaf - reconstructions of  @xmath2 that are in  @xmath42 are equivalent to  @xmath2 .",
    "class  @xmath42 is _ leaf - recognizable _ if , for each network  @xmath43 , every leaf - reconstruction of  @xmath2 is also in  @xmath42 .",
    "a class  @xmath42 of phylogenetic networks is leaf - reconstructible if and only if it is leaf - recognizable and weakly leaf - reconstructible .",
    "we conclude this section by showing that certain features of a binary phylogenetic network on @xmath0 can be reconstructed from its @xmath0-deck .",
    "the _ reticulation number _ of a pseudo - network  @xmath2 is defined as @xmath47 .",
    "the _ level _ of  @xmath2 is the maximum reticulation number of a biconnected component of  @xmath2 .",
    "a phylogenetic network is called a _ level-@xmath1 _ network , with  @xmath48 , if its level is at most  @xmath1 .",
    "the number of edges , the number of vertices , the reticulation number and the level of a binary phylogenetic network  @xmath2 are leaf - reconstructible .",
    "let  @xmath2 be any phylogenetic network and  @xmath49 .",
    "if  @xmath50 , then @xmath51 and @xmath52 . moreover , the level and reticulation number of  @xmath37 are  0 , the same as the reticulation number and level of  @xmath2 .",
    "if  @xmath53 , then @xmath54 and @xmath55 .",
    "moreover , the level and reticulation number of  @xmath37 are the same as the reticulation number and , respectively , level of  @xmath2 .    in both cases ,",
    "the proposition follows directly .",
    "the following is a direct consequence .",
    "[ cor : recog ] for each  @xmath48 , the class of binary level-@xmath1 phylogenetic networks is leaf - recognizable .",
    "in this section we will consider decomposable networks , that is , networks with at least one nontrivial cut - edge ( that is , a cut - edge which does not contain a leaf ) .",
    "we start with a few simple observations .",
    "note that , for  @xmath56 , there exists a unique phylogenetic tree on  @xmath0 which is therefore @xmath0-reconstructible . for  @xmath57 ,",
    "no binary phylogenetic tree on  @xmath0 is @xmath0-reconstructible , but all phylogenetic trees  @xmath58 on  @xmath0 are @xmath59-reconstructible .",
    "[ thm : trees ] any phylogenetic tree with at least five leaves is leaf - reconstructible .",
    "the class of phylogenetic trees is leaf - recognizable by corollary  [ cor : recog ] . to show weak - reconstructibility ,",
    "suppose that there exist phylogenetic trees  @xmath60 on  @xmath0 such that  @xmath58 and  @xmath61 have the same @xmath0-deck .",
    "then there is at least one nontrivial split @xmath4 that is a split of , without loss of generality ,  @xmath58 but not of  @xmath61 .",
    "since  @xmath62 , at least one of  @xmath7 and  @xmath8 contains at least three elements .",
    "the other side contains at least two elements since the split is nontrivial .",
    "assume @xmath63 and  @xmath64 .",
    "then  @xmath65 has split @xmath66 and @xmath67 has split @xmath68 .",
    "hence , @xmath69 and @xmath70 have the same splits , respectively .",
    "this implies that  @xmath61 has a split that can be obtained from @xmath66 by inserting  @xmath71 .",
    "since it does not have split  @xmath4 , it must have split @xmath72 .",
    "similarly ,  @xmath61 must have the split @xmath73 .",
    "this leads to a contradiction because these splits are incompatible ( see  e.g.  @xcite ) .",
    "it is known that any tree is reconstructible @xcite . a proof of this result is given in @xcite , which uses a generalization of kelly s lemma @xcite .",
    "kelly s lemma is key to proving several results in graph reconstructibility .",
    "we were unable to derive an analogous result for leaf - reconstructibility  it would be interesting to know if some such result exists .",
    "note also that trees are known to be endvertex - reconstructible @xcite .    to extend theorem  [ thm : trees ] to decomposable networks",
    ", we will use the following observation .",
    "[ obs : treedeck ] for any phylogenetic network  @xmath2 on  @xmath0 and any leaf  @xmath36 we have @xmath74    [ cor : tn ] the function mapping a phylogenetic network  @xmath2 with at least five leaves to  @xmath10 is leaf - reconstructible .    by observation  [ obs : treedeck ] and theorem  [ thm : trees ] .",
    "[ thm : cutedge ] any decomposable phylogenetic network with at least five leaves is leaf - reconstructible .",
    "let  @xmath42 be the class of phylogenetic networks with at least five leaves and at least one nontrivial cut - edge .",
    "this class is leaf - recognizable since a phylogenetic network on  @xmath0 belongs to this class if and only if every element of its @xmath0-deck has four leaves and at most two elements of its @xmath0-deck have no nontrivial cut - edges .",
    "it remains to show weak leaf - reconstructibility .",
    "suppose  @xmath62 and let  @xmath2 be a phylogenetic network on  @xmath0 with some nontrivial cut - edge  @xmath6 .",
    "let  @xmath4 be the split induced by  @xmath6 . by corollary  [ cor : tn ]",
    ", @xmath10 is @xmath0-reconstructible .",
    "hence , any reconstruction  @xmath14 of  @xmath2 contains a unique edge  @xmath75 representing split  @xmath4 . since  @xmath6 is nontrivial , there",
    "exist leaves  @xmath76 and  @xmath64 .",
    "pseudo - network  @xmath77 contains a unique edge  @xmath44 inducing split @xmath78 . since @xmath79 ,",
    "the connected component of @xmath80 containing  @xmath8 is equivalent to the connected component of @xmath81 containing  @xmath8 . call this connected component  @xmath82 and let  @xmath83 be the endpoint of  @xmath44 that it contains .",
    "similarly , pseudo - network  @xmath84 contains a unique edge  @xmath85 inducing split @xmath86 and the connected component of  @xmath87 containing  @xmath7 is equivalent to the connected component of  @xmath81 containing  @xmath7 . call this connected component  @xmath88 and let  @xmath17 be the endoint of  @xmath85 that it contains . then",
    ",  @xmath14 can be obtained from  @xmath88 and  @xmath82 by adding an edge between  @xmath83 and  @xmath17 .",
    "therefore ,  @xmath89 .",
    "when considering leaf - reconstructability of binary networks we can , by theorem  [ thm : cutedge ] , restrict to simple networks , which are binary networks containing precisely one blob .",
    "therefore , in this section we focus on leaf - reconstructibility of simple binary networks .",
    "the class of such networks is clearly leaf - recognizable since a phylogenetic network on  @xmath0 is contained in this class if and only if each element of its  @xmath0-deck is binary and has precisely one blob .",
    "we say that @xmath90 is a _",
    "3-chain _ of a phylogenetic network  @xmath2 on  @xmath0 if  @xmath91 and  @xmath2 contains a path  @xmath92 such that  @xmath93 and  @xmath40 are respectively a neighbour of  @xmath94 and  @xmath95 .    [ lem:3chain ] any simple binary level-@xmath1 phylogenetic network containing a 3-chain is leaf - reconstructible if it has at least  4 leaves and at least  5 leaves if  @xmath96 .",
    "the class  @xmath42 of such networks is leaf - recognizable since a simple binary level-@xmath1 phylogenetic network on  @xmath0 , with  @xmath97 and  @xmath62 if  @xmath96 , is contained in  @xmath42 if and only if at most three elements of its @xmath0-deck do not contain a 3-chain .    to show weak leaf - reconstructibility ,",
    "let  @xmath43 be a phylogenetic network on  @xmath0 and let  @xmath90 be a 3-chain in  @xmath2 .",
    "since  @xmath97 , there exists at least one other leaf  @xmath98 .",
    "consider  @xmath99 and  @xmath25 .",
    "first observe that  @xmath25 contains a 3-chain  @xmath90 . in  @xmath99",
    ", there is a unique edge  @xmath6 between the neighbours of  @xmath38 and  @xmath40 .",
    "moreover , in  @xmath99 there is no 3-chain @xmath100 by the assumption that  @xmath62 if  @xmath96 .",
    "let  @xmath101 be a @xmath102-reconstruction of  @xmath2 .",
    "then  @xmath14 contains a 3-chain @xmath90 since @xmath25 contains a 3-chain  @xmath90 and  @xmath99 does not contain a 3-chain @xmath100 . hence , @xmath14 can be reconstructed from  @xmath99 by attaching  @xmath41 to edge  @xmath6 .",
    "therefore ,  @xmath89 .",
    "[ cor : levk ] any simple binary level-@xmath1 phylogenetic network with at least @xmath103 leaves and  @xmath104 is leaf - reconstructible .",
    "leaf - recognizability is clear .",
    "let  @xmath2 be a simple binary level-@xmath1 phylogenetic network on  @xmath0 with  @xmath105 and  @xmath106 .",
    "deleting all leaves from  @xmath2 and suppressing all degree-2 vertices gives a 3-regular multigraph  @xmath107 . since  @xmath2 is simple level-@xmath1 , @xmath108 and hence @xmath109 . combining this with the fact that , since  @xmath107 is 3-regular , @xmath110 gives that @xmath111 .",
    "suppose that  @xmath2 contains no 3-chain .",
    "then it could have at most two leaves per edge of  @xmath107 , implying that @xmath112 .",
    "hence , @xmath2 contains a 3-chain and is therefore @xmath0-reconstructible by lemma  [ lem:3chain ] .",
    "[ cor : manyleaves ] any binary phylogenetic network  @xmath113 on  @xmath0 with  @xmath114 is leaf - reconstructible .    if  @xmath2 contains a nontrivial cut - edge , then apply theorem  [ thm : cutedge ] .",
    "if it is simple level-@xmath115 , then apply lemma  [ lem:3chain ] .",
    "if it is simple level-@xmath1 with  @xmath104 then @xmath116 and hence @xmath106 and therefore we can apply corollary  [ cor : levk ] .",
    "we say that _ almost all _ phylogenetic networks from a certain class  @xmath42 are leaf - reconstructible , if the probability that a network drawn uniformly at random out of all networks in  @xmath42 with  @xmath117 leaves is leaf - reconstructible goes to  1 when  @xmath117 goes to infinity .",
    "[ cor : almostall ] for any fixed  @xmath1 , almost all binary level-@xmath1 phylogenetic networks are leaf - reconstructible .",
    "all networks with at least five leaves and some nontrivial cut - edge are leaf - reconstructible by theorem  [ thm : cutedge ] . for a simple binary level-@xmath1 phylogenetic network  @xmath113 on  @xmath0 , with  @xmath118",
    "we have ( similar to in the proof of corollary  [ cor : levk ] ) @xmath119 hence , when @xmath120 then @xmath121 .",
    "when @xmath122 then  @xmath2 is @xmath0-reconstructible by lemma  [ lem:3chain ] and corollary  [ cor : levk ] .",
    "the corollary follows .",
    "in this section , we shall show that the reconstruction number of a decomposable phylogenetic network with at least five leaves is at most two .",
    "[ obs : levnum ] let  @xmath123 . to recognize that a phylogenetic network  @xmath2 is level-@xmath1 it suffices to check that any element of its  @xmath0-deck is level-@xmath1 .",
    "we start by determining the reconstruction number of binary trees .",
    "the _ median _ of three leaves  @xmath124 in a phylogenetic tree  @xmath58 is the unique vertex that lies on each of the paths between all pairs of leaves in  @xmath125 .",
    "[ lem : recnumbintrees ] any binary phylogenetic tree  @xmath58 with at least five leaves has leaf - reconstruction number  2 .",
    "the class of phylogenetic trees on  @xmath0 is @xmath126-recognizable for any  @xmath36 by observation  [ obs : levnum ] .",
    "no phylogenetic tree on  @xmath0 with @xmath62 is  @xmath126-reconstructible for any  @xmath36 since attaching  @xmath38 to different edges in  @xmath127 gives different non - equivalent trees .",
    "hence , the leaf - reconstruction number of such trees is at least  2 .",
    "it remains to show that it is exactly  2 .",
    "consider a binary phylogenetic tree  @xmath58 on  @xmath0 with  @xmath62 .",
    "take any two leaves  @xmath128 such that the distance between them is at least  4 .",
    "such leaves exist since  @xmath62 .",
    "we will show that  @xmath58 can be uniquely reconstructed from  @xmath127 and  @xmath129 .",
    "first observe that any leaf - reconstruction of  @xmath58 is binary since  @xmath127 and  @xmath129 are binary and  @xmath38 and  @xmath41 do not have a common neighbour .",
    "let  @xmath95 be the neighbour of  @xmath38 in  @xmath58 and  @xmath94 the other two neighbours of  @xmath95 .",
    "then  @xmath127 has an edge  @xmath130 .",
    "first assume that neither  @xmath83 nor  @xmath17 is a leaf .",
    "then there exist leaves  @xmath131 such that the path between  @xmath23 and  @xmath21 ( in  @xmath58 ) contains  @xmath83 but not  @xmath95 and there exist leaves  @xmath132 such the path between  @xmath22 and  @xmath24 ( in  @xmath58 ) contains  @xmath17 but not  @xmath95",
    ". then  @xmath83 is the median of  @xmath133 and  @xmath17 is the median of  @xmath134 in  @xmath58 .",
    "call in  @xmath127 and  @xmath129 the median of  @xmath133 also  @xmath83 and the median of @xmath134 also  @xmath17 . then",
    ", in  @xmath129 , the neighbour of  @xmath38 is adjacent to  @xmath83 and  @xmath17 .",
    "hence , we can reconstruct  @xmath58 from  @xmath127 by attaching  @xmath38 to the edge  @xmath130 .",
    "now assume that  @xmath83 is a leaf . then there again exist leaves  @xmath132 such that  @xmath17 is on the path between  @xmath22 and  @xmath24 ( in  @xmath135 ) . in this case ,",
    "@xmath17 is the median of  @xmath136 in  @xmath58 .",
    "call the median of  @xmath136 in  @xmath127 and  @xmath129 also  @xmath17 . then , since the neighbour of  @xmath38 in  @xmath129 is adjacent to  @xmath83 and  @xmath17 , we can again uniquely reconstruct  @xmath58 from  @xmath127 by attaching  @xmath38 to the edge  @xmath130 .",
    "we now consider nonbinary trees .",
    "[ thm : recnumtrees ] any phylogenetic tree with at least five leaves has leaf - reconstruction number  2 unless it is a star , in which case it has leaf - reconstruction number  3 .    as in the proof of lemma  [ lem : recnumbintrees ]",
    ", it is clear that , for any  @xmath36 , the class of phylogenetic trees on  @xmath0 is  @xmath126-recognizable and no phylogenetic tree on  @xmath0 is @xmath126-reconstructible if  @xmath62 .",
    "consider a phylogenetic tree  @xmath58 on  @xmath0 with  @xmath62 .",
    "first consider the case that  @xmath58 is a star .",
    "then , for any  @xmath128 , there exists a phylogenetic tree  @xmath137 on  @xmath0 such that  @xmath138 and  @xmath139 .",
    "hence , the @xmath0-reconstruction number of  @xmath58 is at least  3 . to see that it is exactly  3 ,",
    "note that any phylogenetic tree that is not a star has at most two elements in its @xmath0-deck that are stars .",
    "hence , since there exists a unique phylogenetic star tree on  @xmath0 , the reconstruction number of  @xmath58 is  3 .",
    "now consider the case that  @xmath58 contains exactly one nontrivial cut - edge  @xmath130 .",
    "take one leaf  @xmath38 adjacent to  @xmath83 and one leaf  @xmath41 adjacent to  @xmath17 .",
    "first suppose that  @xmath83 has degree  3 .",
    "then  @xmath17 has degree at least  4 .",
    "hence ,  @xmath127 is a star tree and  @xmath129 has exactly one nontrivial cut - edge  @xmath140 .",
    "suppose  @xmath38 is adjacent to  @xmath141",
    ". then  @xmath141 is adjacent to exactly one other leaf  @xmath40 .",
    "hence , we can uniquely reconstruct  @xmath58 from  @xmath127 by attaching  @xmath38 to the edge incident to  @xmath40 .",
    "now suppose that both  @xmath83 and  @xmath17 have degree at least  3 .",
    "then  @xmath127 and  @xmath129 both have exactly one nontrivial cut - edge .",
    "let  @xmath40 be any leaf adjacent to the neighbour of  @xmath38 in  @xmath129 .",
    "then we can uniquely reconstruct  @xmath58 from  @xmath127 by adding  @xmath38 with an edge to the neighbour of  @xmath40 .",
    "finally , assume that  @xmath58 has at least two nontrivial cut - edges .",
    "then there exist two leaves  @xmath128 such that the distance between them is at least  4 .",
    "let  @xmath95 be the neighbour of  @xmath38 in  @xmath58 and  @xmath142 two other neighbours of  @xmath95 .",
    "if  @xmath95 has degree  3 , then we can proceed as in the proof of lemma  [ lem : recnumbintrees ] .",
    "now assume  @xmath95 has degree at least  4 .",
    "then it has a neighbour  @xmath143 .",
    "then there exist leaves  @xmath144 reachable by paths from  @xmath94 and  @xmath40 respectively that do not contain  @xmath95 .",
    "therefore , the median of  @xmath145 and  @xmath22 in  @xmath58 is  @xmath95 .",
    "hence , we can uniquely reconstruct  @xmath58 from  @xmath127 by adding  @xmath38 with an edge to the median of  @xmath145 and  @xmath22 .",
    "[ cor : cutedge ] any decomposable phylogenetic network with at least five leaves has leaf - reconstruction number at most  2 .    let  @xmath2 be a phylogenetic network that has at least five leaves and at least one nontrivial cut - edge and let  @xmath38 and  @xmath41 be maximum distance apart in  @xmath10 .",
    "then any @xmath146-reconstruction has a nontrivial cut - edge .",
    "moreover , since the distance between  @xmath38 and  @xmath41 in  @xmath10 is at least  3 , @xmath10 is @xmath146-reconstructable by the proof of theorem  [ thm : recnumtrees ] .",
    "moreover , by the proof of theorem  [ thm : cutedge ] , it now follows that  @xmath2 is @xmath146-reconstructable .",
    "in this section we show that all binary networks with at least five leaves and level at most  4 are leaf - reconstructible and , moreover , have leaf - reconstruction number at most  2 .",
    "the proofs are based on the following notions .",
    "a binary level-@xmath1 _ generator _ , for  @xmath104 , is a 2-connected 3-regular multigraph  @xmath147 with  @xmath116 .",
    "the _ underlying generator _ of a binary simple level-@xmath1 network  @xmath2 is the generator obtained from  @xmath2 by deleting all leaves and suppressing resulting degree-2 vertices . for an edge  @xmath6 of  @xmath107",
    ", we say that a leaf  @xmath38 _ is on edge _",
    "@xmath6 in  @xmath2 if the neighbour of  @xmath38 is on a path that is suppressed into edge  @xmath6 .",
    "if  @xmath38 is on edge  @xmath6 then we also say that  @xmath6 _ contains _",
    "@xmath38 and we refer to  @xmath6 as the _",
    "@xmath38-edge_.    see figure  [ fig : generators ] for all binary level-@xmath1 generators , for @xmath148 .",
    "( -1,0 ) node level-2 ; ( 1,0 ) circle ; ( 2,0 ) circle ; ( 1,0 )  ( 2,0 ) ; ( 1,0 ) to[out=55,in=125 ] ( 2,0 ) ; ( 1,0 ) to[out=-55,in=-125 ] ( 2,0 ) ;    ( -1,-1.5 ) node level-3 ; ( 1,-2 ) circle ; ( 2,-2 ) circle ; ( 1,-2 ) to[out=45,in=135 ] ( 2,-2 ) ; ( 1,-2 ) to[out=-45,in=-135 ] ( 2,-2 ) ; ( 1,-1 ) circle ; ( 2,-1 ) circle ; ( 1,-1 ) to[out=45,in=135 ] ( 2,-1 ) ; ( 1,-1 ) to[out=-45,in=-135 ] ( 2,-1 ) ; ( 1,-2 )  ( 1,-1 ) ; ( 2,-2 )  ( 2,-1 ) ;    ( 5,-1.5 ) circle ; ( 5,-.6 ) circle ; ( 4.3,-2 ) circle ; ( 5.7,-2 ) circle ; ( 5,-1.5 )  ( 5,-.6 ) ; ( 5,-1.5 )  ( 4.3,-2 ) ; ( 5,-1.5 )  ( 5.7,-2 ) ; ( 5,-.6 )  ( 4.3,-2 ) ; ( 5,-.6 )  ( 5.7,-2 ) ; ( 4.3,-2 )  ( 5.7,-2 ) ;    ( -1,-4.5 ) node level-4 ;    ( 1,-5 ) circle ; ( 2,-5 ) circle ; ( 1,-5 ) to[out=45,in=135 ] ( 2,-5 ) ; ( 1,-5 ) to[out=-45,in=-135 ] ( 2,-5 ) ; ( 1,-4 ) circle ; ( 2,-4 ) circle ; ( 1,-4 )  ( 1,-5 ) ; ( 2,-4 )  ( 2,-5 ) ; ( 1,-4 )  ( 2,-4 ) ; ( 1,-3 ) circle ; ( 2,-3 ) circle ; ( 1,-3 ) to[out=45,in=135 ] ( 2,-3 ) ; ( 1,-3 ) to[out=-45,in=-135 ] ( 2,-3 ) ; ( 1,-4 )  ( 1,-3 ) ; ( 2,-4 )  ( 2,-3 ) ; ( 1.5,-5.7 ) node @xmath149 ;    ( 8,-5 ) circle ; ( 9,-5 ) circle ; ( 8,-5 ) to[out=45,in=135 ] ( 9,-5 ) ; ( 8,-5 ) to[out=-45,in=-135 ] ( 9,-5 ) ; ( 9,-3.5 ) circle ; ( 9,-4.5 ) circle ; ( 8,-4 )  ( 8,-5 ) ; ( 9,-4.5 )  ( 9,-5 ) ; ( 9,-3.5 ) to[out=-45,in=45 ] ( 9,-4.5 ) ; ( 9,-3.5 ) to[out=-135,in=135 ] ( 9,-4.5 ) ; ( 8,-3 ) circle ; ( 9,-3 ) circle ; ( 8,-3 ) to[out=45,in=135 ] ( 9,-3 ) ; ( 8,-3 ) to[out=-45,in=-135 ] ( 9,-3 ) ; ( 8,-4 )  ( 8,-3 ) ; ( 9,-3.5 )  ( 9,-3 ) ; ( 8.5,-5.7 ) node @xmath150 ;    ( .5,-8.5 ) circle ; ( 2.5,-8.5 ) circle ; ( .5,-8.5 ) to[out=35,in=145 ] ( 2.5,-8.5 ) ; ( .5,-8.5 ) to[out=-35,in=-145 ] ( 2.5,-8.5 ) ; ( .5,-6.5 ) circle ; ( 2.5,-6.5 ) circle ; ( .5,-6.5 )  ( 1.5,-6 ) ; ( .5,-6.5 )  ( 1.5,-7 ) ; ( 1.5,-6 )  ( 1.5,-7 ) ; ( 2.5,-6.5 )  ( 1.5,-7 ) ; ( 2.5,-6.5 )  ( 1.5,-6 ) ; ( 1.5,-6 ) circle ; ( 1.5,-7 ) circle ; ( .5,-8.5 )  ( .5,-6.5 ) ; ( 2.5,-8.5 )  ( 2.5,-6.5 ) ; ( 1.5,-9.2 ) node @xmath151 ;    ( 0,0 ) circle ; ( 2,0 ) circle ; ( 1,1 ) circle ; ( 0,3 ) circle ; ( 2,3 ) circle ; ( 1,2 ) circle ; ( 0,0 )  ( 2,0 ) ; ( 0,0 )  ( 1,1 ) ; ( 2,0 )  ( 1,1 ) ; ( 0,3 )  ( 2,3 ) ; ( 0,3 )  ( 1,2 ) ; ( 2,3 )  ( 1,2 ) ; ( 0,0 )  ( 0,3 ) ; ( 2,0 )  ( 2,3 ) ; ( 1,1 )  ( 1,2 ) ; ( 1,-0.5 ) node @xmath152 ;    ( 1,0.3 ) circle ; ( 0,1 ) circle ; ( 2,1 ) circle ; ( 0,2 ) circle ; ( 2,2 ) circle ; ( 1,2.7 ) circle ; ( 1,0.3 ) ",
    "( 0,1 ) ; ( 1,0.3 ) ",
    "( 2,1 ) ; ( 1,0.3 )  ( 1,2.7 ) ; ( 0,1 ) ",
    "( 2,2 ) ; ( 0,1 ) ",
    "( 0,2 ) ; ( 2,1 )  ( 0,2 ) ; ( 2,1 ) ",
    "( 2,2 ) ; ( 0,2 ) ",
    "( 1,2.7 ) ; ( 2,2 )  ( 1,2.7 ) ; ( 1,-0.5 ) node @xmath153 ;    we say that two cycles are _ similar _ if they have the same number of vertices and the same number of vertices that are neighbours of leaves , and hence also the same number of generator vertices ( i.e. vertices that are not neighbours of leaves ) .",
    "the following three lemmas show several special cases of simple level-@xmath1 networks that are leaf - reconstructible .",
    "we will use these lemmas to show that all simple level-4 networks are leaf - reconstructible , if they have at least five leaves .",
    "[ lem:4cycle ] let  @xmath2 be a binary simple level-@xmath1 network on  @xmath0 , with  @xmath104 and  @xmath62 . if  @xmath2 contains a cycle  @xmath154 containing the neighbours of leaves  @xmath133 and  @xmath24 and either    * there is no cycle  @xmath155 in  @xmath2 that is similar to  @xmath154 and contains the neighbours of  @xmath145 and  @xmath22 ; or * @xmath22 and  @xmath24 are on the same edge of the underlying generator and there is no cycle  @xmath155 in  @xmath2 that is similar to  @xmath154 and contains the neighbours of  @xmath133 and  @xmath24 in a different order ,    then  @xmath2 is @xmath156-reconstructible , for any  @xmath157 .",
    "\\(i ) note that  @xmath26 has a cycle  @xmath158 containing the neighbours of  @xmath133 and  @xmath24 and no other cycle that is similar to  @xmath158 and contains the neighbours of  @xmath133 and  @xmath24 .",
    "assume without loss of generality that these neighbours are visited in this order .",
    "suppose that the neighbour of  @xmath24 is the @xmath159-th vertex on the path from the neighbour of  @xmath22 to the neighbour of  @xmath23 on  @xmath158 .",
    "now consider  @xmath160 , which contains a cycle  @xmath161 containing the neighbours of  @xmath145 and  @xmath22 and no other cycle similar to  @xmath161 that contains the neighbours of  @xmath23 ,  @xmath21 and  @xmath22 .",
    "let  @xmath162 be the path from the neighbour of  @xmath22 to the neighbour of  @xmath23 on  @xmath161 , not via the neighbour of  @xmath21 .",
    "if the neighbour of  @xmath6 is among the first  @xmath159 vertices of  @xmath162 then we let  @xmath44 be the @xmath159-th edge on  @xmath162 . otherwise , we let  @xmath44 be the @xmath163-th edge on  @xmath162 .",
    "then the unique way to insert  @xmath24 into  @xmath160 is by attaching it to edge  @xmath44 .",
    "\\(ii ) assume without loss of generality that the distance between  @xmath22 and  @xmath24 is  3 .",
    "note that  @xmath26 has a cycle  @xmath158 containing the neighbours of  @xmath133 and  @xmath24 and no cycle that is similar to  @xmath158 and contains the neighbours of  @xmath133 and  @xmath24 in a different order .",
    "assume again that  @xmath158 visits  @xmath133 and  @xmath24 in this order .",
    "now consider  @xmath160 and choose any cycle  @xmath161 containing the neighbours of  @xmath145 and  @xmath22 .",
    "let  @xmath44 be the first edge on the path from the neighbour of  @xmath22 to the neighbour of  @xmath23 along  @xmath161 , not via the neighbour of  @xmath21 .",
    "then the unique way to insert  @xmath24 into  @xmath160 is by attaching it to edge  @xmath44 .",
    "[ lem : bubble ] let  @xmath2 be a binary simple level-@xmath1 network on  @xmath0 , with  @xmath104 and  @xmath62 . if the underlying generator of  @xmath2 has a pair of multi - edges  @xmath164 then , unless one of  @xmath164 contains two leaves and the other one no leaves in  @xmath2 , then  @xmath2 has leaf - reconstruction number at most  2 .",
    "first suppose that there is exactly one leaf  @xmath38 that is on one of the multi - edges . then  @xmath37 has multi - edges .",
    "since multi - edges are not allowed in phylogenetic networks , the unique way to insert  @xmath38 into  @xmath37 is by attaching it to one of the multi - edges .",
    "now suppose that there is exactly one leaf  @xmath38 on  @xmath165 and exactly one leaf  @xmath23 on  @xmath166 .",
    "let  @xmath41 be any other leaf .",
    "then  @xmath99 contains a unique 4-cycle containing the neighbours of  @xmath38 and  @xmath23 , and these neighbours are not adjacent . since  @xmath37 contains a unique 3-cycle  @xmath154 containing the neighbour of  @xmath23 , the only way to insert  @xmath38 into  @xmath37",
    "is by attaching it to the unique edge on  @xmath154 that is not incident to the neighbour of  @xmath23 .",
    "now suppose that there are exactly two leaves  @xmath145 on  @xmath165 and exactly one leaf  @xmath38 on  @xmath166 .",
    "let  @xmath167 .",
    "then , @xmath99 contains a unique 5-cycle containing the neighbours of  @xmath145 and  @xmath38 and the neighbour of  @xmath38 is not adjacent to the neighbours of  @xmath23 and  @xmath21 . since  @xmath37 contains a unique 4-cycle  @xmath154 containing the neighbours of  @xmath23 and  @xmath21 , the unique way to insert  @xmath38 into  @xmath37",
    "is by attaching it to the unique edge on  @xmath154 that is not incident to the neighbours of  @xmath23 and  @xmath21 .",
    "now suppose that there are exactly two leaves  @xmath145 on  @xmath165 and exactly two leaves  @xmath168 on  @xmath166 .",
    "this case is handled by lemma  [ lem:4cycle ]  ( i ) .",
    "the only remaining possibility is that there is a 3-chain , which is handled by the proof of lemma  [ lem:3chain ] .",
    "[ lem:3incident ] let  @xmath2 be a binary simple level-@xmath1 network on  @xmath0 , with  @xmath104 and  @xmath62 .",
    "if the underlying generator of  @xmath2 has three pairwise incident edges and  @xmath2 has at least three leaves on these edges , then  @xmath2 has leaf - reconstruction number at most  2 .",
    "first suppose that all three edges are incident to some vertex  @xmath17 and the other three endpoints are all distinct .",
    "if each edge contains at least one leaf , let  @xmath133 be the leaves closest to  @xmath17 on each of the edges .",
    "then  @xmath2 is  @xmath169-reconstructible for any  @xmath170 , since we can reconstruct  @xmath2 from  @xmath25 by attaching  @xmath23 to the edge that is incident to the vertex  @xmath171 that is incident to the  @xmath21-edge and to the @xmath22-edge , making  @xmath23 the leaf closest to  @xmath171 on that edge .",
    "similarly , if one edge contains at least two leaves  @xmath145 and another edge at least one leaf  @xmath22 , then  @xmath2 is again  @xmath169-reconstructible for any  @xmath170 .",
    "a similar argument can be used to handle the case that the three edges form a triangle .",
    "finally , suppose that at least two of the three edges are multi - edges .",
    "then , by lemma  [ lem : bubble ] , exactly two of the three edges form multi - edges , one of them containing two leaves , the other one no leaves , and the third edge of the three pairwise incident edges contains at least one leaf",
    ". then again it can be seen that  @xmath2 has leaf - reconstruction number at most  2 by using a similar argument as above .",
    "[ thm : lev4 ] any binary level-4 phylogenetic network with at least five leaves has leaf - reconstruction number at most  2 .",
    "let  @xmath2 be such a network . by corollary  [ cor : cutedge ]",
    ", we may assume that  @xmath2 has no nontrivial cut - edges , i.e.  @xmath2 is simple .    if  @xmath2 is a simple level-1 network , pick any two  @xmath93 that are distance at least  4 apart .",
    "the fact that  @xmath2 is simple is @xmath146-recognizable .",
    "moreover , using the fact that  @xmath2 has at least five leaves , it can easily be shown that  @xmath2 can be uniquely reconstructed from  @xmath37 and  @xmath99 .",
    "now suppose that  @xmath2 is a simple level-@xmath1 network , with  @xmath104 .",
    "if  @xmath2 has a 3-chain  @xmath90 and  @xmath172 , then any @xmath102-reconstruction of  @xmath2 is simple .",
    "moreover , by the proof of lemma  [ lem:3chain ] it can be concluded that  @xmath2 is @xmath102-reconstructible .",
    "hence , we may assume that  @xmath2 contains no 3-chains .",
    "if  @xmath173 , then , considering the unique level-2 generator in figure  [ fig : generators ] , we are done by lemma  [ lem : bubble ] .",
    "if  @xmath174 , then there are two possible underlying generators , see figure  [ fig : generators ] .",
    "first suppose the underlying generator  @xmath107 is not  @xmath175 and thus has two pairs of multi - edges .",
    "then , by lemma  [ lem : bubble ] , we may assume that each pair of multi - edges has one edge containing exactly two leaves .",
    "hence , we are done by lemma  [ lem:4cycle ]  ( i ) .",
    "now suppose that  @xmath176 .",
    "since  @xmath62 , it is straightforward to check that at least one 3-cycle  @xmath154 of  @xmath107 contains at least three leaves in  @xmath2 . by lemma  [ lem:4cycle ] , it contains exactly  3 leaves .",
    "there are two cases ( by lemma  [ lem:3chain ] ) .",
    "either each edge of  @xmath154 contains exactly one leaf , or one edge contains two leaves and one edge one leaf . in either case",
    ", it is easy to check that wherever the other two leaves are , we can apply lemma  [ lem:4cycle ] to see that  @xmath2 has reconstruction number at most  2 .",
    "finally , suppose  @xmath177 .",
    "then there are five possibilities for the underlying generator  @xmath107 , see figure  [ fig : generators ] . if  @xmath178 then , by lemma  [ lem : bubble ] , each pair of multi - edges has one edge containing exactly two leaves and one edge containing no leaves .",
    "if  @xmath179 or  @xmath150 , then we are done by lemma  [ lem:4cycle ]  ( i ) .",
    "if  @xmath180 , then it is straightforward to check that , since  @xmath62 , there must exist some cycle that satisfies the condition of lemma  [ lem:4cycle ]  ( ii ) .",
    "now suppose that  @xmath181 .",
    "observe that  @xmath152 consists of two disjoint 3-cycles and three other edges , which we will call the _",
    "middle edges_. for every vertex of  @xmath152 , at most two edges incident to this vertex contain leaves by lemma  [ lem:3incident ] . since  @xmath62 , it is straightforward to check that there is at least one vertex  @xmath17 of  @xmath152 with exactly two leaves  @xmath145 on the edges incident to  @xmath17 .",
    "first assume that  @xmath23 is on a middle edge and  @xmath21 is on a triangle edge .",
    "then there is a unique hamiltonian cycle  @xmath154 of  @xmath107 containing the  @xmath23-edge and the  @xmath21-edge .",
    "first suppose that there is at least one leaf  @xmath182 on an edge of  @xmath154 .",
    "assume that  @xmath22 is the first such leaf on the path along  @xmath154 between the neighbour of  @xmath21 and the neighbour of  @xmath23 not containing  @xmath17 .",
    "let  @xmath159 be the distance from the neighbour of  @xmath21 to the neighbour of  @xmath22 on this path .",
    "let  @xmath170 .",
    "then @xmath2 is @xmath183-reconstructible , since the unique way to insert  @xmath22 into  @xmath184 is by attaching it to the @xmath159-th edge of the path along  @xmath154 from the neighbour of  @xmath21 to the neighbour of  @xmath23 not containing  @xmath17 .",
    "now suppose that none of the leaves in  @xmath185 are on edges of  @xmath154 . by lemma  [ lem:3incident ]",
    "there are no leaves on the third edge incident to  @xmath17 .",
    "hence , since  @xmath62 , there at least three leaves on the two edges of  @xmath107 that are not on  @xmath154 and not incident to  @xmath17 .",
    "it is now straightforward to check that  @xmath2 has reconstruction number  2 by lemma  [ lem:4cycle ]  ( i ) .",
    "now assume that  @xmath23 and  @xmath21 are both on the same triangle - edge .",
    "then , if the previous case is not applicable for any vertex  @xmath171 of  @xmath152 , the only remaining possibility is that the other triangle also has an edge containg two leaves and we can apply lemma  [ lem:4cycle ] .",
    "now assume that  @xmath23 and  @xmath21 are on different triangle edges ( of the same triangle ) .",
    "then , if the previous cases are not applicable , all other leaves must be on the other triangle and we can use lemma  [ lem:3incident ] .    finally , assume that  @xmath23 and  @xmath21 are both on the same middle edge .",
    "then , if the previous cases are not applicable , the only remaining possibility is that some other middle edge also contains two leaves and we can apply lemma  [ lem:4cycle ] .",
    "now consider the last level-4 generator  @xmath186 .",
    "as before , it is straightforward to check that there is at least one vertex  @xmath17 of  @xmath153 with exactly two leaves  @xmath145 on the edges incident to  @xmath17 .",
    "first suppose that  @xmath23 and  @xmath21 are on different edges incident to  @xmath17 .",
    "observe that there are precisely two hamiltonian cycles  @xmath154 and  @xmath187 of  @xmath153 containing the @xmath23-edge and the @xmath21-edge . since each leaf is on an edge of at least one of  @xmath154 and  @xmath187 ,",
    "at least one edge of  @xmath154 and  @xmath187 contains a third leaf  @xmath188 .",
    "suppose that  @xmath22 is on an edge of  @xmath154 .",
    "first suppose that all leaves are on edges of  @xmath154 .",
    "then we can use a similar argument as for the hamiltonian cycle in  @xmath152 to show that  @xmath2 is @xmath183-reconstructible , for some  @xmath189 . if at least one leaf  @xmath190 is on an edge that is not also on  @xmath187 , then we choose the hamiltonian cycle containing the  @xmath6-edge , and choose  @xmath191 .",
    "otherwise , all leaves are also on edges of  @xmath187 .",
    "observet that there are precisely four edges that are on both  @xmath154 and  @xmath187 , which are two pairs of incident edges .",
    "since  @xmath62 , it then follows by lemma  [ lem:3incident ] that  @xmath2 has leaf - reconstruction number  2 .",
    "now suppose that at least one leaf  @xmath190 is not on an edge of  @xmath154 .",
    "then  @xmath2 is @xmath183-reconstructible , with  @xmath192 , again using a similar argument as for the hamiltonian cycle in  @xmath152 , choosing the hamiltonian cycle of  @xmath107 not containing the  @xmath6-edge .",
    "finally , suppose that  @xmath23 and  @xmath21 are on the same edge incident to  @xmath17 .",
    "then , if the previous case is not applicable for any vertex  @xmath171 of  @xmath153 , the only remaining possibility is that there is some other edge of  @xmath153 containing two leaves and we can apply lemma  [ lem:4cycle ]  ( ii ) .",
    "we have focussed so far on reconstructing networks from their @xmath0-deck .",
    "we could try to use a recursive argument in order to reconstruct networks from smaller subnetworks , with less than @xmath193 leaves .",
    "however , this approach does not work in general since there are networks for which no elements of its @xmath0-deck are phylogenetic networks , see figure  [ fig : phylodeck ] .",
    "nevertheless , it is possible to apply a recursive approach if we use the following variant of the @xmath0-deck of a network .    given a phylogenetic network  @xmath2 on  @xmath0 and a leaf  @xmath36 , the phylogenetic network  @xmath194 is the result of deleting leaf  @xmath38 from  @xmath2 , together with its incident edge , and applying the following three operations until none is applicable :    * suppress a degree-2 vertex ; * replace a pair of multi - edges by a single edge ; * collapse a blob with precisely two incident cut - edges into a single vertex .    given a phylogenetic network  @xmath2 on  @xmath0 and  @xmath195 , the _",
    "@xmath196-_deck _ of  @xmath2 is the set @xmath197 .",
    "see again figure  [ fig : phylodeck ] for an example . note that this form of leaf - deletion was introduced for directed level-1 phylogenetic networks in @xcite  see also @xcite for more details for general phylogenetic networks .",
    "( -.5,-.5 ) circle node[left ] @xmath21 ; ( -.5,1.5 ) circle node[left ] @xmath23 ; ( 2.5,2 ) circle node[above ] @xmath6 ; ( 5.5,1.5 ) circle node[right ] @xmath22 ; ( 5.5,-.5 ) circle node[right ] @xmath24 ; ( 0,0 ) circle ; ( 0,1 ) circle ; ( 1,0.5 ) circle ; ( 2,0.5 ) circle ; ( 3,0.5 ) circle ; ( 2.5,1.5 ) circle ; ( 4,0.5 ) circle ; ( 5,0 ) circle ; ( 5,1 ) circle ; ( -0.5,-0.5 )  ( 0,0 ) ; ( 0,1 )  ( 0,0 ) ; ( 1,0.5 )  ( 0,0 ) ; ( -0.5,1.5 )  ( 0,1 ) ; ( 1,0.5 )  ( 2,0.5 ) ; ( 2,0.5 )  ( 3,0.5 ) ; ( 2,0.5 )  ( 2.5,1.5 ) ; ( 2.5,1.5 )  ( 2.5,2 ) ; ( 3,0.5 )  ( 4,0.5 ) ; ( 4,0.5 )  ( 5,0 ) ; ( 4,0.5 )  ( 5,1 ) ; ( 5,0 )  ( 5,1 ) ; ( 5,0 )  ( 5.5,-0.5 ) ; ( 5,1 )  ( 5.5,1.5 ) ; ( 2.5,1.5 )  ( 3,0.5 ) ; ( 0,1 )  ( 1,0.5 ) ; ( 2.5,-1 ) node @xmath2 ;    ( -.5,-.5 ) circle node[left ] @xmath21 ; ( -.5,1.5 ) circle node[left ] @xmath6 ;",
    "( 3.5,1.5 ) circle node[right ] @xmath22 ; ( 3.5,-.5 ) circle node[right ] @xmath24 ; ( 0,0 ) circle ; ( 0,1 ) circle ; ( 1,0.5 ) circle ; ( 2,0.5 ) circle ; ( 3,0 ) circle ; ( 3,1 ) circle ; ( -0.5,-0.5 )  ( 0,0 ) ; ( 0,1 )  ( 0,0 ) ; ( 1,0.5 )  ( 0,0 ) ; ( -0.5,1.5 )  ( 0,1 ) ; ( 1,0.5 )  ( 2,0.5 ) ; ( 2,0.5 )  ( 3,0 ) ; ( 2,0.5 )  ( 3,1 ) ; ( 3,0 )  ( 3,1 ) ; ( 3,0 )  ( 3.5,-0.5 ) ; ( 3,1 )  ( 3.5,1.5 ) ; ( 0,1 )  ( 1,0.5 ) ; ( 1.5,-1 ) node @xmath198 ;    ( -.5,-.5 ) circle node[left ] @xmath21 ; ( -.5,1.5 ) circle node[left ] @xmath23 ; ( 3.5,1.5 ) circle node[right ] @xmath6 ; ( 3.5,-.5 ) circle node[right ] @xmath22 ; ( 0,0 ) circle ; ( 0,1 ) circle ; ( 1,0.5 ) circle ; ( 2,0.5 ) circle ; ( 3,0 ) circle ; ( 3,1 ) circle ; ( -0.5,-0.5 )  ( 0,0 ) ; ( 0,1 ) ",
    "( 0,0 ) ; ( 1,0.5 ) ",
    "( 0,0 ) ; ( -0.5,1.5 )  ( 0,1 ) ; ( 1,0.5 ) ",
    "( 2,0.5 ) ; ( 2,0.5 ) ",
    "( 3,0 ) ; ( 2,0.5 ) ",
    "( 3,1 ) ; ( 3,0 )  ( 3,1 ) ; ( 3,0 )  ( 3.5,-0.5 ) ; ( 3,1 ) ",
    "( 3.5,1.5 ) ; ( 0,1 ) ",
    "( 1,0.5 ) ; ( 1.5,-1 ) node @xmath199 ;    all elements of a phylogenetic @xmath0-deck are phylogenetic networks by the following observation , which is easily verified .",
    "let  @xmath2 be a phylogenetic network  @xmath2 on  @xmath0 , with  @xmath200 , and  @xmath36 .",
    "then  @xmath201 is a phylogenetic network on  @xmath202 .",
    "this opens the door to reconstructing networks from smaller subnetworks .",
    "quarnet _ is a phylogenetic network with precisely four leaves .",
    "the set of quarnets  @xmath203 of a phylogenetic network  @xmath2 on  @xmath0 is defined recursively by @xmath204 if  @xmath57 and @xmath205    here , the union operation keeps one phylogenetic network from each group of equivalent phylogenetic networks .",
    "we say that two sets  @xmath206 of phylogenetic networks are _ equivalent _ , denoted @xmath207 , if there exists a bijection  @xmath208 with  @xmath209 for all  @xmath43 .",
    "we say that a network  @xmath2 is _ reconstructible from its quarnets _ if every phylogenetic network  @xmath14 with @xmath210 is equivalent to  @xmath2 .",
    "moreover , a class  @xmath42 of phylogenetic networks is _ quarnet - reconstructible _ if each  @xmath43 is reconstructible from its quarnets .",
    "similarly ,  @xmath2 is _ reconstructible from its phylogenetic  @xmath0-deck _ if every phylogenetic network  @xmath14 , whose phylogenetic  @xmath0-deck is equivalent to the phylogenetic  @xmath0-deck of  @xmath2 , is equivalent to  @xmath2 .",
    "moreover , a class  @xmath42 of phylogenetic networks is _ phylogenetically reconstructible _ if each  @xmath43 is reconstructible from its phylogenetic  @xmath0-deck .",
    "if two phylogenetic networks on  @xmath0 have equivalent @xmath0-decks , then they have equivalent phylogenetic @xmath0-decks ( but not conversely , see figure  [ fig : phyloxdeck ] ) .",
    "consequently , if a phylogenetic network on  @xmath0 is reconstructible from its phylogenetic @xmath0-deck , then it is @xmath0-reconstructible .",
    "the following proposition , which shows that the converse is also true in some cases , will permit us to apply results from previous sections .",
    "( 0.5,0.5 ) circle node[left ] @xmath21 ; ( 2.5,0.5 ) circle node[right ] @xmath24 ; ( 1,1 ) circle ; ( 2,1 ) circle ; ( 1,2 ) circle ; ( 2,2 ) circle ; ( 0.5,2.5 ) circle node[left ] @xmath23 ; ( 2.5,2.5 ) circle node[right ] @xmath22 ; ( 0.5,0.5 )  ( 1,1 ) ; ( 0.5,2.5 )  ( 1,2 ) ; ( 1,1 )  ( 2,1 ) ; ( 1,2 )  ( 2,2 ) ; ( 1,1 )  ( 1,2 ) ; ( 2,1 )  ( 2,2 ) ; ( 2,1 )  ( 2.5,0.5 ) ; ( 2,2 )  ( 2.5,2.5 ) ; ( 1.5,0 ) node @xmath2 ;    ( 0.5,0.5 ) circle node[left ] @xmath24 ; ( 4.5,0.5 ) circle node[right ] @xmath21 ; ( 1,1 ) circle ; ( 2,1.5 ) circle ; ( 1,2 ) circle ; ( 3,1.5 ) circle ; ( 4,1 ) circle ; ( 4,2 ) circle ; ( 0.5,2.5 ) circle node[left ] @xmath23 ; ( 4.5,2.5 ) circle node[right ] @xmath22 ; ( 0.5,0.5 )  ( 1,1 ) ; ( 0.5,2.5 )  ( 1,2 ) ; ( 1,1 )  ( 1,2 ) ; ( 1,1 )  ( 2,1.5 ) ; ( 1,2 )  ( 2,1.5 ) ; ( 2,1.5 )  ( 3,1.5 ) ; ( 3,1.5 )  ( 4,1 ) ; ( 3,1.5 )  ( 4,2 ) ; ( 4,1 )  ( 4,2 ) ; ( 4,1 )  ( 4.5,0.5 ) ; ( 4,2 )  ( 4.5,2.5 ) ; ( 2.5,0 ) node @xmath45 ;    [ prop : phylodeck ] let  @xmath2 be a phylogenetic network on  @xmath0 with  @xmath97 .",
    "if  @xmath2 is @xmath211-reconstructible for some  @xmath212 with  @xmath213 and  @xmath214 for all  @xmath215 , then  @xmath2 is reconstructible from its phylogenetic  @xmath0-deck .",
    "suppose that there exists a network  @xmath45 that is not equivalent to  @xmath2 but has an equivalent phylogenetic  @xmath0-deck .",
    "since  @xmath2 is @xmath211-reconstructible , there exists a  @xmath215 such that @xmath216 . since @xmath217",
    ", it follows that @xmath218 and hence that the neighbour of  @xmath41 in  @xmath45 is in a triangle .",
    "moreover , since  @xmath99 has the same reticulation number as  @xmath2 ,  @xmath219 also has the same reticulation number as  @xmath2 . since , in  @xmath45 , the neighbour of  @xmath41 is in a triangle ,  @xmath45 has a higher reticulation number than  @xmath219 and  @xmath2 .",
    "take any  @xmath220 .",
    "then , since @xmath221 , @xmath222 has the same reticulation number as  @xmath2 and @xmath219 and hence a lower reticulation number than  @xmath45 .",
    "it follows that the neighbour of  @xmath40 in  @xmath45 is also in a triangle .",
    "we distingish two cases .",
    "first assume that the neighbours of  @xmath41 and  @xmath40 are both in the same triangle in  @xmath45 .",
    "consider any two leaves  @xmath223 .",
    "then , the neighbours of  @xmath41 and  @xmath40 are together in the same triangle in  @xmath224 and in  @xmath225 . on the other hand ,",
    "neither of the neighbours of  @xmath41 and  @xmath40 is in a triangle in  @xmath2 , since @xmath226 and @xmath214 .",
    "this is only possible when  @xmath2 is a simple level-1 network on @xmath227 .",
    "this contradicts the assumption that  @xmath2 is @xmath211-reconstructible , with  @xmath212 , and hence  @xmath0-reconstructible .",
    "now assume that the neighbours of  @xmath41 and  @xmath40 are in different triangles in  @xmath45 .",
    "then , the neighbour of  @xmath40 is also in a triangle in  @xmath228 . on the other hand ,",
    "the neighbour of  @xmath40 is not in a triangle in  @xmath2 , since @xmath226 .",
    "hence , in  @xmath2 , the neighbours of  @xmath41 and  @xmath40 are part of a 4-cycle .",
    "consider again two leaves  @xmath229 . in @xmath230 and in  @xmath231 ,",
    "the neighbours of  @xmath41 and  @xmath40 are in a triangle or 4-cycle .",
    "this is only possible when , in  @xmath45 , the neighbours of ( without loss of generality )  @xmath38 and  @xmath41 are in one triangle while the neighbours of  @xmath232 and  @xmath40 are in a different triangle , and the two triangles are adjacent .",
    "this implies that there are no other leaves , i.e. @xmath227 , and again  @xmath2 is a simple level-1 network on  @xmath0 .",
    "this again leads to a contradiction since  @xmath2 is @xmath0-reconstructible .",
    "in particular , we have the following .    [ cor : xdecknetworks ] let  @xmath2 be a phylogenetic network on  @xmath0 with  @xmath97 .",
    "if the @xmath0-deck of  @xmath2 consists of only phylogenetic networks , then  @xmath2 is reconstructible from its phylogenetic @xmath0-deck if and only if  @xmath2 is @xmath0-reconstructible .",
    "note that corollary  [ cor : xdecknetworks ] does not hold when  @xmath233 , see figure  [ fig : phyloxdeck2 ] .",
    "( 0,0.9 ) circle node[above ] @xmath23 ; ( -0.71,-0.71 ) circle node[left ] @xmath21 ; ( 0,0 ) circle ; ( 0.71,-0.71 ) circle node[right ] @xmath22 ; ( 0,0 )  ( 0,0.9 ) ; ( 0,0 )  ( 0.71,-0.71 ) ; ( 0,0 )  ( -0.71,-0.71 ) ;    ( 0.5,0.5 ) circle node[left ] @xmath21 ; ( 1,1 ) circle ; ( 2,1.5 ) circle ; ( 1,2 ) circle ; ( 2.71,1.5 ) circle node[right ] @xmath22 ; ( 0.5,2.5 ) circle node[left ] @xmath23 ; ( 0.5,0.5 ) ",
    "( 1,1 ) ; ( 0.5,2.5 ) ",
    "( 1,2 ) ; ( 1,1 ) ",
    "( 1,2 ) ; ( 1,1 ) ",
    "( 2,1.5 ) ; ( 1,2 ) ",
    "( 2,1.5 ) ; ( 2,1.5 )  ( 2.71,1.5 ) ;    [ thm : recursion ]",
    "let  @xmath42 be a class of phylogenetic networks such that each element of  @xmath42 has at least five leaves and , for each element  @xmath2 of  @xmath42 with at least six leaves , the phylogenetic  @xmath0-deck of  @xmath2 is equivalent to a subset of  @xmath42 .",
    "then  @xmath42 is phylogenetically - reconstructible if and only if it is quarnet - reconstructible .",
    "if  @xmath42 is quarnet - reconstructible then it is phylogenetically - reconstructible since if two phylogenetic networks  @xmath234 have equivalent phylogenetic @xmath0-decks then it follows directly that  @xmath210 .",
    "now suppose that  @xmath42 is phylogenetically - reconstructible .",
    "we prove by induction on  @xmath159 that each  @xmath43 with at most  @xmath159 leaves is quarnet - reconstructible .",
    "if  @xmath235 then the phylogenetic @xmath0-deck of  @xmath2 is equal to  @xmath203 and therefore  @xmath2 is quarnet - reconstructible .",
    "now suppose  @xmath236 .",
    "since  @xmath2 is reconstructible from its  @xmath0-deck and each element of its @xmath0-deck is , by induction , quarnet - reconstructible , @xmath2 is quarnet - reconstructible .",
    "first observe that each phylogenetic tree on  @xmath0 with  @xmath62 is reconstructible from its phylogenetic @xmath0-deck by theorem  [ thm : trees ] and proposition  [ prop : phylodeck ] .",
    "hence , the class of phylogenetic trees with at least five leaves is phylogenetically reconstructible .",
    "however , a similar argument can not be used to show that even the class of level-1 networks is phylogenetically reconstructible .",
    "therefore , it is interesting to study which classes of networks are phylogenetically reconstructible .",
    "[ thm : lev3phylo ] the class of level-3 phylogenetic networks with at least five leaves is phylogenetically reconstructible .    to prove this theorem , we will first show that an analogue of theorem  [ thm : cutedge ] holds .",
    "[ thm : cutedgephylo ] the class of decomposable phylogenetic networks with at least five leaves is phylogenetically reconstructible .    the proof is very similar to that of theorem  [ thm : cutedge ] . as in that proof ,",
    "first note that a phylogenetic network has at least one nontrivial cut - edge if and only if at most two elements of its phylogenetic @xmath0-deck do not .",
    "let  @xmath2 be some phylogenetic network on  @xmath0 with at least one nontrivial cut - edge and  @xmath62 . since @xmath237 , for all  @xmath36 , we can reconstruct  @xmath10 from the phylogenetic @xmath0-deck of  @xmath2 .",
    "we can then use exactly the same argument as in the last part of the proof of theorem  [ thm : cutedge ] to show that  @xmath2 is reconstructible from its phylogenetic @xmath0-deck ( see figure  [ fig : phylodeck ] for an illustration ) .",
    "we now prove theorem  [ thm : lev3phylo ] .    by theorem  [ thm : cutedgephylo ] , it suffices to consider simple level-@xmath1 networks with  @xmath238 . for simple level-1 networks ,",
    "the phylogenetic @xmath0-deck is precisely equal to the @xmath0-deck and we are done by proposition  [ prop : phylodeck ] .",
    "now consider a simple level-2 network  @xmath2 and its underlying generator  @xmath107 .",
    "if the phylogenetic @xmath0-deck of  @xmath2 is not equal to its @xmath0-deck then one of the three edges of  @xmath107 contains exactly one leaf  @xmath38 , another edge of  @xmath107 contains no leaves , and the third edge of  @xmath107 contains all other leaves  @xmath202",
    ". then  @xmath2 is @xmath239-reconstructible for any @xmath240 with distance between them at least  4 .",
    "since @xmath241 and @xmath242 we are done by proposition  [ prop : phylodeck ] .",
    "therefore , we may assume that  @xmath2 is a simple level-3 network .",
    "suppose the phylogenetic @xmath0-deck of  @xmath2 is not equal to its @xmath0-deck .",
    "then the underlying generator  @xmath107 of  @xmath2 is not equal to  @xmath175 ( since  @xmath175 does not have any multi - edges ) .",
    "hence ,  @xmath107 is the other level-3 generator , see figure  [ fig : generators ] .",
    "moreover , at least one pair of multi - edges contains precisely one leaf , say leaf  @xmath38 .",
    "the other pair of multi - edges contains at least one leaf  @xmath41 .",
    "if there is at least one leaf  @xmath40 on an edge that is not in a pair of multi - edges , then it is straightforward to check that , wherever you put leaves  @xmath243 , there is a cycle containing the neighbours of leaves  @xmath244 satisfying the conditions of lemma  [ lem:4cycle](i ) and a fifth leaf  @xmath6 such that @xmath245 and @xmath246 , and we are done by proposition  [ prop : phylodeck ] .",
    "the only remaining case is that all leaves in  @xmath202 are on the pair of multi - edges not containing  @xmath38 .",
    "then there is again a cycle containing the neighbours of leaves  @xmath244 satisfying the conditions of lemma  [ lem:4cycle](i ) and a fifth leaf  @xmath6 such that @xmath245 .",
    "however , if  @xmath247 then the only choice for  @xmath6 is  @xmath248 and hence @xmath249 . nevertheless , we can use a similar argument as in the proof of lemma  [ lem:4cycle](i ) since @xmath250 does contain a unique cycle containing the neighbours of  @xmath133 and  @xmath24 .",
    "[ cor : lev3quarnets ] any level-3 phylogenetic network is reconstructible from its quarnets .",
    "in this section we shall consider the problem of reconstructing a phylogenetic network from its edge - deleted networks .",
    "we first formalize this concept ( cf .",
    "* section 2 ) for a review of edge - reconstruction in graphs ) .    given a phylogenetic network  @xmath2 and an edge  @xmath251 ,",
    "the pseudo - network  @xmath26 is the result of deleting edge  @xmath6 from  @xmath2 and suppressing resulting degree-2 vertices .",
    "the _ edge - deck _ of  @xmath2 is the multiset @xmath252 .",
    "an _ edge - reconstruction _ of a network  @xmath2 on  @xmath0 is a network  @xmath14 on  @xmath0 with  @xmath253 and  @xmath254 for all  @xmath251 .",
    "note that by @xmath253 we do not mean that the edges of  @xmath2 are the same pairs of vertices as the edges of  @xmath14 , but that there exists a bijection @xmath255 which we assume to be the identity .",
    "we call a phylogenetic network  @xmath2 _ edge - reconstructible _ if every edge - reconstruction of  @xmath2 is equivalent to  @xmath2 .",
    "[ lem : leafedge ] let  @xmath2 be a phylogenetic network on  @xmath0 .",
    "if  @xmath2 is leaf - reconstructible then it is edge - reconstructible .",
    "this follows directly from the observation that @xmath256 if and only if @xmath257 for each edge  @xmath6 that has an endpoint  @xmath36 in both  @xmath2 and  @xmath14 .    however , there exist edge - reconstructible networks that are not leaf - reconstructible , see the examples in figure  [ fig : notreconstructible ] .",
    "( 0.5,0.5 ) circle node[left ] @xmath21 ; ( 2.5,0.5 ) circle node[right ] @xmath24 ; ( 1,1 ) circle ; ( 2,1 ) circle ; ( 0.5,1.5 ) circle node[left ] @xmath23 ; ( 2.5,1.5 ) circle node[right ] @xmath22 ; ( 0.5,0.5 )  ( 1,1 ) ; ( 0.5,1.5 )  ( 1,1 ) ; ( 1,1 ) ",
    "( 2,1 ) ; ( 2,1 ) ",
    "( 2.5,0.5 ) ; ( 2,1 ) ",
    "( 2.5,1.5 ) ;    ( 0.5,0.5 ) circle node[left ] @xmath24 ; ( 2.5,0.5 ) circle node[right ] @xmath21 ; ( 1,1 ) circle ; ( 2,1 ) circle ; ( 0.5,1.5 ) circle node[left ] @xmath23 ; ( 2.5,1.5 ) circle node[right ] @xmath22 ; ( 0.5,0.5 )  ( 1,1 ) ; ( 0.5,1.5 ) ",
    "( 1,1 ) ; ( 1,1 )  ( 2,1 ) ; ( 2,1 ) ",
    "( 2.5,0.5 ) ; ( 2,1 ) ",
    "( 2.5,1.5 ) ;    ( 0.5,0.5 ) circle node[left ] @xmath21 ; ( 2.5,0.5 ) circle node[right ] @xmath24 ; ( 1,1 ) circle ; ( 2,1 ) circle ; ( 1,2 ) circle ; ( 2,2 ) circle ; ( 0.5,2.5 ) circle node[left ] @xmath23 ; ( 2.5,2.5 ) circle node[right ] @xmath22 ; ( 0.5,0.5 )  ( 1,1 ) ; ( 0.5,2.5 )  ( 1,2 ) ; ( 1,1 )  ( 2,1 ) ; ( 1,2 )  ( 2,2 ) ; ( 1,1 )  ( 1,2 ) ; ( 2,1 )  ( 2,2 ) ; ( 2,1 ) ",
    "( 2.5,0.5 ) ; ( 2,2 )  ( 2.5,2.5 ) ;    ( 0.5,0.5 ) circle node[left ] @xmath24 ; ( 2.5,0.5 ) circle node[right ] @xmath21 ; ( 1,1 ) circle ; ( 2,1 ) circle ; ( 1,2 ) circle ; ( 2,2 ) circle ; ( 0.5,2.5 ) circle node[left ] @xmath23 ; ( 2.5,2.5 ) circle node[right ] @xmath22 ; ( 0.5,0.5 )  ( 1,1 ) ; ( 0.5,2.5 )  ( 1,2 ) ; ( 1,1 )  ( 2,1 ) ; ( 1,2 )  ( 2,2 ) ; ( 1,1 )  ( 1,2 ) ; ( 2,1 )  ( 2,2 ) ; ( 2,1 )  ( 2.5,0.5 ) ; ( 2,2 )  ( 2.5,2.5 ) ;    ( 0,0 ) circle node[below ] @xmath21 ; ( 0.5,0.5 ) circle ; ( 1.5,0.5 ) circle ; ( 2.5,0.5 ) circle ; ( 1.5,0 ) circle node[below ] @xmath22 ; ( 3,0 ) circle node[below ] @xmath24 ; ( 0,0 )  ( .5,.5 ) ; ( 1.5,0 ) ",
    "( 1.5,.5 ) ; ( 3,0 ) ",
    "( 2.5,.5 ) ; ( 1.5,0.5 ) ",
    "( .5,.5 ) ; ( 1.5,0.5 ) ",
    "( 2.5,.5 ) ; ( 1,1 ) circle ; ( 2,1 ) circle ; ( 1,1 ) ",
    "( 2,1 ) ; ( 0.5,0.5 ) ",
    "( 1,1 ) ; ( 2.5,0.5 ) ",
    "( 2,1 ) ; ( 1.5,1.5 ) circle ; ( 1.5,2 ) circle node[above ] @xmath23 ; ( 1,1 )  ( 1.5,1.5 ) ; ( 2,1 ) ",
    "( 1.5,1.5 ) ; ( 1.5,1.5 ) ",
    "( 1.5,2 ) ;    ( 0,0 ) circle node[below ] @xmath21 ; ( 0.5,0.5 ) circle ; ( 1.5,0.5 ) circle ; ( 2.5,0.5 ) circle ; ( 1.5,0 ) circle node[below ] @xmath24 ; ( 3,0 ) circle node[below ] @xmath22 ; ( 0,0 ) ",
    "( .5,.5 ) ; ( 1.5,0 ) ",
    "( 1.5,.5 ) ; ( 3,0 ) ",
    "( 2.5,.5 ) ; ( 1.5,0.5 )  ( .5,.5 ) ; ( 1.5,0.5 ) ",
    "( 2.5,.5 ) ; ( 1,1 ) circle ; ( 2,1 ) circle ; ( 1,1 ) ",
    "( 2,1 ) ; ( 0.5,0.5 ) ",
    "( 1,1 ) ; ( 2.5,0.5 ) ",
    "( 2,1 ) ; ( 1.5,1.5 ) circle ; ( 1.5,2 ) circle node[above ] @xmath23 ; ( 1,1 ) ",
    "( 1.5,1.5 ) ; ( 2,1 ) ",
    "( 1.5,1.5 ) ; ( 1.5,1.5 ) ",
    "( 1.5,2 ) ;    ( 0,0 ) circle node[below ] @xmath23 ; ( 0.5,0.5 ) circle ; ( 1.5,0.5 ) circle ; ( 2.5,0.5 ) circle ; ( 1.5,0 ) circle node[below ] @xmath21 ; ( 3,0 ) circle node[below ] @xmath22 ; ( 0,0 ) ",
    "( .5,.5 ) ; ( 1.5,0 ) ",
    "( 1.5,.5 ) ; ( 3,0 ) ",
    "( 2.5,.5 ) ; ( 1.5,0.5 )  ( .5,.5 ) ; ( 1.5,0.5 ) ",
    "( 2.5,.5 ) ; ( 0.5,1 ) circle ; ( 1.5,1 ) circle ; ( 2.5,1 ) circle ; ( 0.5,1 ) ",
    "( 2.5,1 ) ; ( 0.5,0.5 ) ",
    "( 0.5,1 ) ; ( 2.5,0.5 ) ",
    "( 2.5,1 ) ; ( 1.5,1.5 ) circle ; ( 0.5,1 ) ",
    "( 1.5,1.5 ) ; ( 2.5,1 ) ",
    "( 1.5,1.5 ) ; ( 1.5,1.5 )  ( 1.5,1 ) ;    ( 0,0 ) circle node[below ] @xmath23 ; ( 0.5,0.5 ) circle ; ( 1.5,0.5 ) circle ; ( 2.5,0.5 ) circle ; ( 1.5,0 ) circle node[below ] @xmath22 ; ( 3,0 ) circle node[below ] @xmath21 ; ( 0,0 )  ( .5,.5 ) ; ( 1.5,0 )  ( 1.5,.5 ) ; ( 3,0 )  ( 2.5,.5 ) ; ( 1.5,0.5 )  ( .5,.5 ) ; ( 1.5,0.5 )  ( 2.5,.5 ) ; ( 0.5,1 ) circle ; ( 1.5,1 ) circle ; ( 2.5,1 ) circle ; ( 0.5,1 )  ( 2.5,1 ) ; ( 0.5,0.5 ) ",
    "( 0.5,1 ) ; ( 2.5,0.5 ) ",
    "( 2.5,1 ) ; ( 1.5,1.5 ) circle ; ( 0.5,1 )  ( 1.5,1.5 ) ; ( 2.5,1 )  ( 1.5,1.5 ) ; ( 1.5,1.5 ) ",
    "( 1.5,1 ) ;    when considering edge - reconstructability of binary networks we can , by theorem  [ thm : cutedge ] and lemma  [ lem : leafedge ] , again restrict to simple networks .",
    "we say that @xmath258 is a _",
    "2-chain _ of a phylogenetic network  @xmath2 on  @xmath0 if  @xmath128 and the distance between  @xmath38 and  @xmath41 in  @xmath2 is  3 .    [ prop:2chain ]",
    "any simple binary phylogenetic network on  @xmath0 containing a 2-chain is edge - reconstructible .",
    "the fact that  @xmath2 is simple can be recognized by considering three elements of its edge - deck  @xmath259 such that each of  @xmath260 is incident to a leaf . since",
    "each of  @xmath259 consists of a simple network and an isolated vertex , any edge - reconstruction of  @xmath2 is simple .",
    "suppose that  @xmath2 has a 2-chain @xmath258 .",
    "let  @xmath83 and  @xmath17 be the neighbours of  @xmath38 and  @xmath41 in  @xmath2 respectively and  @xmath261 .",
    "let  @xmath141 and  @xmath171 be the neighbours of  @xmath38 and  @xmath41 in  @xmath26 respectively .",
    "first suppose that @xmath258 is not a 2-chain in @xmath262 .",
    "there exists at least one edge  @xmath44 that is not incident to  @xmath83 or  @xmath17 . since @xmath258 is a 2-chain in @xmath263 , we can uniquely reconstruct  @xmath2 from  @xmath262 by subdividing the edges @xmath264 and @xmath265 and creating a new edge between the subdividing vertices .",
    "now suppose that @xmath258 is also a 2-chain in @xmath262 .",
    "we say that a network has an @xmath266-_ladder _ of _ length _",
    "@xmath1 if there exist disjoint paths  @xmath267 and @xmath268 such that  @xmath269 and  @xmath270 are adjacent for  @xmath271 .",
    "let  @xmath272 be the maximum length of an @xmath266-ladder in  @xmath2 .",
    "take any such ladder and observe that there exists at least one edge  @xmath85 that is not incident to any vertex of the ladder .",
    "then the maximum length of an @xmath266-ladder is  @xmath232 in  @xmath273 and is  @xmath274 in  @xmath26 .",
    "hence , we can again uniquely reconstruct  @xmath2 from  @xmath262 by subdividing the edges @xmath264 and @xmath265 and creating a new edge between the subdividing vertices .",
    "the following corollary can be proved in a similar way to corollaries  [ cor : levk ] and  [ cor : manyleaves ] .",
    "[ cor : edgelevk ]    * any simple binary level-@xmath1 phylogenetic network on  @xmath0 with  @xmath105 and  @xmath275 is edge - reconstructible .",
    "* any binary phylogenetic network  @xmath113 on  @xmath0 with  @xmath276 is edge - reconstructible .",
    "in this paper we have introduced the concept of leaf - reconstructible phylogenetic networks .",
    "we have shown that several large classes of phylogenetic networks are leaf - reconstructible , and used our results to show that level-3 networks are defined by their quarnets .",
    "we conjecture that all unrooted phylogenetic networks with 5 or more leaves are leaf - reconstructible .",
    "we expect that this could be a difficult conjecture to settle , as with other variants of the graph reconstruction conjecture .    in another direction , it could be of interest to also consider leaf - reconstructibility of nonbinary networks . in theorem",
    "[ thm : trees ] , we showed that nonbinary phylogenetic trees are leaf - reconstructible , and in theorem  [ thm : cutedge ] that even all decomposable nonbinary phylogenetic networks are leaf - reconstructible , but what about non - decomposable nonbinary networks ? the following related question could also be worth considering : if every nonbinary phylogenetic network with at least five leaves is leaf - reconstructible , then is every graph reconstructible ?    in section  [ sec : idge ] , we considered edge - reconstructibility , a variant of the leaf - reconstructibility problem .",
    "another variant that should be considered is leaf - reconstructibility for directed phylogenetic networks .",
    "this is an important class of networks , in which the networks are directed acyclic graphs , with a single root and leaves labeled by the set  @xmath0 . in @xcite",
    "certain examples of directed phylogenetic networks are presented which indicate that such networks may not be leaf - reconstructible , but it remains an open problem whether or not this is the case ( note that not all digraphs are reconstructible  @xcite ) .    in the longer term",
    ", it would be interesting to consider leaf - reconstructibility of networks that arise in biological settings .",
    "indeed , even if not every network is leaf - reconstructible , it may be that counter - examples are somewhat unlikely to occur as evolutionary histories ( e.g. if they are highly symmetric ) .",
    "one way to approach this could be to consider random networks .",
    "as we have seen in corollary  [ cor : almostall ] , for any fixed  @xmath1 , almost all level-@xmath1 phylogenetic networks are leaf - reconstructible",
    ". it would be interesting to know whether or not almost all phylogenetic networks on a fixed leaf - set are leaf - reconstructible . in this context",
    ", it is worth noting that almost every graph has reconstructing number three @xcite .",
    "we have shown that decomposable and binary level-4 networks with at least five leaves have reconstruction number at most  2 .",
    "so , do almost all ( binary ) phylogenetic networks have reconstruction number at most  2 ?    finally",
    ", it would be interesting to consider leaf - reconstructibilty of networks that are generated according to some model of molecular evolution ( see e.g.  @xcite for a review of such models )",
    ". this would be somewhat analogous to recent ground - breaking work on reconstructibility of pedigrees in a stochastic setting @xcite , and could focus on models such as those presented in , for example , @xcite .",
    "part of this work was conducted while vincent moulton was visiting the tu delft on visitors grant 040.11.529 funded by the netherlands organization for scientific research ( nwo ) .",
    "leo van iersel was partially supported by nwo , including vidi grant 639.072.602 , and partially by the 4tu applied mathematics institute .",
    "e.  bapteste , l.j.j .",
    "van iersel , a.  janke , s.  kelchner , s.m .",
    "kelk , j.o .",
    "mcinerney , d.a .",
    "morrison , l.  nakhleh , m.  steel , l.  stougie , and j.  whitfield , networks : expanding evolutionary thinking , _ trends in genetics _ , * 29 * ( 8) : 439441 , 2013 ."
  ],
  "abstract_text": [
    "<S> an important problem in evolutionary biology is to reconstruct the evolutionary history of a set @xmath0 of species . </S>",
    "<S> this history is often represented as a phylogenetic network , that is , a connected graph with leaves labelled by elements in @xmath0 ( for example , an evolutionary tree ) , which is usually also binary , i.e. all vertices have degree 1 or 3 . a common approach used in phylogenetics to build a phylogenetic network on @xmath0 involves constructing it from networks on subsets of @xmath0 . </S>",
    "<S> here we consider the question of which ( unrooted ) phylogenetic networks are _ leaf - reconstructible _ , </S>",
    "<S> i.e. which networks can be uniquely reconstructed from the set of networks obtained from it by deleting a single leaf ( its _ @xmath0-deck _ ) . </S>",
    "<S> this problem is closely related to the ( in)famous reconstruction conjecture in graph theory but , as we shall show , presents distinct challenges . </S>",
    "<S> we show that some large classes of phylogenetic networks are reconstructible from their @xmath0-deck . </S>",
    "<S> this includes phylogenetic trees , binary networks containing at least one non - trivial cut - edge , and binary level-4 networks ( the level of a network measures how far it is from being a tree ) . </S>",
    "<S> we also show that for fixed @xmath1 , almost all binary level-@xmath1 phylogenetic networks are leaf - reconstructible . as an application of our results , </S>",
    "<S> we show that a level-3 network @xmath2 can be reconstructed from its quarnets , that is , 4-leaved networks that are induced by @xmath2 in a certain recursive fashion . </S>",
    "<S> our results lead to several interesting open problems which we discuss , including the conjecture that all phylogenetic networks with at least five leaves are leaf - reconstructible . </S>"
  ]
}