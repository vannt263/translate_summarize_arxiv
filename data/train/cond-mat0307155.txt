{
  "article_text": [
    "the gross - pitaevskii equation ( gpe ) has proven to be an extremely useful description of macroscopic bose - einstein condensates ( becs ) at or near zero temperature @xcite .",
    "it is the first and sometimes only tool to be used in the description of many experiments in the field of non - linear atom optics and bose - einstein condensation .",
    "the validity of the gpe for many wide - ranging experimental situations now appears beyond doubt .",
    "however , it has been proposed that the gpe can also be used to represent the non - equilibrium dynamics of bose gases at finite temperature @xcite .",
    "the underlying argument is that for modes of the gas with an average occupation much larger than one , the classical dynamics is far more important than the quantum dynamics .",
    "this is analogous to the semi - classical approximation utilised in laser physics for the electromagnetic field .",
    "a major advantage of using the gpe in such situations is that it is non - perturbative , and so can be applied in the region of the critical point as long as the condition on occupation numbers is observed . in ref .",
    "@xcite a finite temperature gross - pitaevskii equation is derived from the quantum many - body hamiltonian for the bose gas with this approximation in mind .",
    "an alternative route to similar equations of motion is possible via the use of the wigner representation @xcite",
    ". this approach may be more familiar to those from the quantum optics community .",
    "some of the first numerical calculations utilising the gpe for finite temperature simulations were performed by damle _",
    "et al_.  @xcite and marshall _ et al_.  @xcite .",
    "more recently there have been several calculations using the so - called `` classical field '' approximation . in particular",
    "we mention those of the warsaw group @xcite , the ens group @xcite , and the current authors @xcite .",
    "these calculations are all related by the fact that they include no damping terms in the gpe , and thus rely on _ ergodicity _ for the system to thermalize .",
    "classical field methods involving both damping and stochastic terms have been considered by gardiner _ et al_.@xcite , stoof and bijlsma @xcite , and duine and stoof @xcite .",
    "while the qualitative results from previous work have been promising , there has been some difficulty in performing quantitative calculations using such methods , and in particular in determining the temperature of the system at equilibrium .",
    "we partially addressed this issue in previous work using a variety of methods to determine the temperature of our simulations @xcite .",
    "the most reliable of these involved fitting time - averaged quasiparticle occupations and energies to the classical limit of the bose - einstein distribution function . however , this method relies on the existence of a basis which approximately diagonalizes the hamiltonian ( quasiparticles ) for which energies and wave functions can be calculated in advance .",
    "this method is therefore only applicable in the realm of perturbation theory , and fails for even moderate temperatures in systems with large nonlinearities .",
    "hence it is desirable to find a more widely applicable scheme for unambiguously determining the temperature of numerical simulations .    in a succinct yet insightful paper",
    ", rugh @xcite expressed the temperature of a classical hamiltonian system in terms of a phase space expectation value of a suitable function of the canonical position and momentum coordinates [ eq .",
    "( [ eqn : rugh_t ] ) of this paper . ] using the ergodic theorem , this expectation value over phase space can be interpreted as a dynamical average for a system in equilibrium , and immediately lends itself to application in numerical calculations .",
    "rugh developed this procedure further in @xcite , and generalised it to include systems with other conserved quantities in addition to the energy @xcite .",
    "this generalization turns out to be crucial for the application of the method to the interacting bose gas .",
    "rugh s formula for the temperature has been applied to several systems to date , for example in the field of molecular dynamics .",
    "this has led to the notion of a configurational temperature for gases , which only depends on the spatial co - ordinates of the particles , in addition to the usual kinetic temperature which only depends on the momenta @xcite .    in this paper",
    "we apply the microcanonical formalism of rugh to the bec hamiltonian to determine the temperature of numerical simulations of thermal bose gases .",
    "the method is non - perturbative and does not rely on the existence of well - defined bogoliubov quasiparticles .",
    "the paper is organised as follows . in sec .",
    "[ sec : formula ] we briefly summarise the expression for the temperature and other derivatives of the microcanonical entropy , and describe their application to the bec hamiltonian .",
    "section [ sec : numerical ] presents our numerical results for our projected gpe ( pgpe ) system , while sec .  [ sec : other ] relates our calculations to other dynamical calculations of classical @xmath0 field theory , as well as to calculations of the shift of the transition temperature for a homogeneous bose gas .",
    "we conclude in sec .",
    "[ sec : conc ] .",
    "we consider a classical system with @xmath1 independent modes .",
    "the hamiltonian can be written as @xmath2 , where @xmath3 is a vector of length @xmath4 consisting of the canonical position and momentum co - ordinates . in these coordinates",
    "we define the gradient operator @xmath5 in terms of its components @xmath6 .    in the notation of rugh @xcite",
    ", the hamiltonian @xmath7 may have a number of independent first integrals , labelled by @xmath8 that are invariant under the dynamics of @xmath7 .",
    "we could define @xmath9 , and include the conserved energy with the other constants of motion in this notation , but for clarity we consider it separately .",
    "a particular macro - state of such a system can be specified by the values of the conserved quantities , labelled as @xmath10 .",
    "the expression for the temperature of such a system in the microcanonical ensemble is given by @xmath11 where all other constants of motion are held fixed , and where the entropy is given by @xmath12 \\ ; \\prod_i \\delta[{i_i -   f_i(\\mathbf{\\gamma})}].\\ ] ]    in this case , the temperature of the system can be written as @xmath13 where the angle brackets correspond to an ensemble average , and the components of the vector operator @xmath14 are @xmath15 where @xmath16 can be chosen to be any scalar value , including zero .",
    "the vector field @xmath17 can also be chosen freely within the constraints @xmath18 geometrically this means that the vector field @xmath17 has a non - zero component transverse to the @xmath19 energy surface , and is parallel to the surfaces @xmath20 .",
    "the expectation value in eq .",
    "( [ eqn : temp_eqn ] ) is over all possible states in the microcanonical ensemble ; however if the ergodic theorem is applicable then it can equally well be interpreted as a time - average . for further details on the origin of this expression",
    "we refer the reader to rugh s original papers @xcite , as well as derivations found in giardin and levi @xcite , jepps _",
    "et al_.@xcite and rickayzen and powles @xcite .",
    "the full quantum many - body hamiltonian for the bose gas in dimensionless form is @xmath21 , \\label{eqn : qh}\\end{aligned}\\ ] ] where @xmath22 , @xmath23 is the number of particles in the system , @xmath24 , @xmath25 is the unit of length , @xmath26 is the unit of energy , @xmath27 is the mass of the particles and @xmath28 is the dimensionless external potential if any is present .",
    "the dimensionless quantum bose field operator @xmath29 is here normalized to one , @xmath30 , and @xmath31 is the nonlinear constant defined as @xmath32 where @xmath33 is the _ s_-wave scattering length . in this expression we have assumed a high momentum cutoff and made use of the replacement of the true interatomic potential with the two body t - matrix , @xmath34 , where @xmath35 .    in ref .  @xcite the field operator is split into a classical part and a quantum part , with the boundary determined by the requirement that the average occupation number @xmath36 of modes below the cutoff satisfies @xmath37",
    ". equations of motion were derived for the classical part , before taking the mean value .",
    "this resulted in the finite temperature gross - pitaevskii equation ( ftgpe ) , which describes the evolution of a classical field coupled to an effective bath described by a quantum boltzmann - like equation .",
    "this equation proves to be somewhat difficult to solve numerically , and in refs .",
    "@xcite we reported results focussing on a simplification we termed the projected gross - pitaevskii equation ( pgpe ) .",
    "this equation describes the evolution of a classical field only , with a cutoff at a given momenta or energy .",
    "it is identical to the usual gpe except that it evolves a wave function which is restricted to a finite - sized basis satisfying the classical condition @xmath37 .",
    "the pgpe for a homogeneous system is written explicitly for the homogenous gas in eq .",
    "( [ eqn : pgpe ] ) of this paper .    in this paper",
    "we wish to determine the temperature of the restricted system described by the evolution of the pgpe .",
    "thus the hamiltonian we consider is the classical version of eq .",
    "( [ eqn : qh ] ) obtained by replacing the field operator @xmath38 with the classical field @xmath39 , subject to the important restriction that @xmath39 is constructed from a finite number of low - energy modes .",
    "we can therefore write it in the form @xmath40 where @xmath41 labels the classical modes in the coherent region below the cutoff , as defined in @xcite .",
    "we must now make a choice of the canonically conjugate co - ordinates of our hamiltonian . as we are defining our classical field in a basis",
    ", it seems natural to convert to a basis representation . if we choose our basis to be that which diagonalises the ideal gas hamiltonian [ the first two terms of eq .",
    "( [ eqn : qh ] ) ] we find @xmath42 where the matrix element is @xmath43 the equation of motion for the @xmath44 is given by the pgpe .",
    "this problem can be mapped exactly to the one considered by rugh by defining real , canonically - conjugate coordinates @xmath45 and @xmath46 @xmath47 with the corresponding inverse transformation @xmath48 with these definitions , the evolution of the @xmath49 coefficients given by the pgpe maps exactly to the evolution of the coordinates @xmath45 and @xmath46 given by hamilton s equations .",
    "the pgpe is therefore in one - to - one correspondance with a classical microcanonical system and its equilibrium propreties can be studied using the wide variety of techniques which have been developed in classical statistical mechanics .",
    "we have performed numerical calculations for the homogeneous pgpe , and so we use a plane wave basis where @xmath50 = @xmath51 , @xmath52 and @xmath53 .",
    "however , the method we describe is general and can be applied directly to inhomogeneous systems for becs in magnetic and optical dipole traps .",
    "the implementation of a projection operator in the gpe is an essential feature of any classical simulation .",
    "while we have explicitly defined a projection operator in terms of a basis set , other authors have implicitly chosen a momentum cutoff by the use of a finite - size grid in their gpe simulations @xcite .",
    "the method of temperature determination described in this paper can also be applied to these calculations , but with a different choice of postion and momentum co - ordinates .    on a finite grid , the hamiltonian ( [ eqn : qh ] )",
    "can be discretised in real space and the classical equivalent can be written as @xmath54 , \\label{eqn : hgrid}\\end{aligned}\\ ] ] where @xmath55 labels the grid point , @xmath56 are the grid spacings for each axis , and we have defined @xmath57 . in this case the appropriate position and momentum variables are @xmath58    however , we believe that it is important to define the projector using a basis that is relatively well - defined in energy _ at the cutoff _ ( we stress that this does not mean that the basis has to be well - defined in energy _ below _ the cutoff ) .",
    "it has previously been shown @xcite that the single particle energy levels of a partially condensed system are essentially those of the trapping potential for energies @xmath59 , where @xmath60 is the condensate energy eigenvalue . thus the above cutoff projector can be written @xmath61 where the @xmath62 are the basis states appropriate to the potential , and the notation @xmath63 describes a summation over all modes above the energy cutoff @xmath64 . as this basis is complete , the below cutoff projector",
    "is simply @xmath65 which gives the result written explicitly in eq .",
    "( [ eqn : projector ] ) .",
    "we also require the classical condition @xmath66 to hold at the cutoff and so for @xmath67 this should also be satisfied .    for a trapped bose gas ,",
    "the implicit momentum projector based on the finite - grid method is not at all well - defined in energy at the cutoff , and we believe that this may lead to difficulties .",
    "however , this is yet to be invesigated numerically ; for further discussion of this issue we refer the reader to @xcite .      in order to satisfy the conditions ( [ eqn : x_conditions ] ) we can choose a vector field of the form @xmath68 where the @xmath69 coefficients @xmath70 are determined by the @xmath69 simultaneous equations in eq .",
    "( [ eqn : x_conditions ] ) . due to the freedom in the choice of the vector operator",
    "@xmath14 we can set any component of the length @xmath4 vector @xmath17 to zero .",
    "this turns out to be useful as the components corresponding to the momentum and position variables can be different orders of magnitude .",
    "two particular choices we make use of later are @xmath71 with @xmath72 and @xmath73 with @xmath74 these lead to two different calculations for the temperature that only agree in general if the system is in thermal equilibrium .",
    "this provides a useful check that the simulations have in fact thermalized .    in rugh s first two papers @xcite the only first integral considered was the energy , and he chose @xmath75 which yielded the ( dimensionless ) formula @xmath76 for the bec hamiltonian we consider , however , there are other first integrals that must be taken into account .",
    "most importantly , the evolution conserves the normalization of the wave function , but other first integrals that may occur are both the angular and linear momentum .",
    "the effect of including these additional first integrals in the definition of the vector field @xmath17 is to account for the energy that is associated with a conserved quantity and hence is unavailable for thermalization .",
    "this ensures that only the appropriate free energy is used to calculate the temperature .",
    "we conjecture that the same result can be achieved by first transforming to a co - ordinate system where the total angular and linear momenta , etc , are all zero and therefore do not contribute to the energy of the system .",
    "in fact , rugh demonstrated this explicitly in @xcite for a system of particles with a conserved centre - of - mass motion .",
    "an exception to this , however , is the conservation of normalization @xmath77 .",
    "this must be considered explicitly because there is no co - ordinate system in which it can be made to vanish .",
    "the constraint on @xmath23 means that the ground state of the system will , in general , have a finite energy .",
    "for example , a non - interacting gas in a harmonic trap of frequency @xmath78 must have at least the zero - point energy @xmath79 for each spatial degree of freedom .",
    "for a non - ideal , homogeneous gas the restriction that at least one of the @xmath49 must be non - zero means that there will always be a finite interaction energy associated with the ground state energy @xmath80 .",
    "these energy contributions are not accessible for thermalization , however , and including the normalization constraint allows them to be removed .",
    "we note , however , that the effect of this constraint is in general more complicated than a simple subtraction of the ground state energy ( which could be achieved by hand ) and depends on the definition of the operator @xmath14 used to calculate the temperature , as shown below .",
    "to deal with the normalization constraint , we need to choose a vector field @xmath17 which satisfies eqs .",
    "( [ eqn : x_conditions ] ) with @xmath81 .",
    "the result is @xmath82 where the parameter @xmath83 looks similar to a chemical potential . for a system on a real space grid with @xmath84 and a hamiltonian given by eq .",
    "( [ eqn : hgrid ] ) we find that @xmath85 , where @xmath86 is the usual gross - pitaevskii form of the chemical potential , obtained from the hamiltonian of eq .",
    "( [ eqn : hgrid ] ) by doubling the interaction term .",
    "however , in general the expression of eq .",
    "( [ eqn : x_with_n ] ) does not have a simple interpretation .",
    "substituting eq .",
    "( [ eqn : xvec ] ) into eq .",
    "( [ eqn : temp_eqn ] ) we find that our full expression for the temperature is    @xmath87 } { [ { |{\\mathbf{\\mathcal{d}}}h|^2 - \\lambda_n ( { \\mathbf{\\mathcal{d}}}h \\cdot { \\mathbf{\\mathcal{d}}}n)}]^2 } \\right\\rangle .",
    "\\label{eqn : t}\\end{aligned}\\ ] ]    the second term in this expression is of order @xmath88 , and so in many situations it can reasonably be neglected .",
    "however we have calculated the full expression for all results presented in this paper .",
    "the method described in this paper can also be used to calculate first derivatives of the microcanonical entropy with respect to any of the first integrals of the hamiltonian @xcite .",
    "in particular , we find to calculate the quantity @xmath89the constraints on our vector field should be @xmath90 for the bec hamiltonian , we have @xmath91 and implementing the required constraints , we find an appropriate vector field is that given by eq .",
    "( [ eqn : xvec],[eqn : x_with_n ] ) but with the roles of @xmath7 and @xmath23 reversed .",
    "in addition , higher order derivatives of the entropy can also be determined , making available quantities such as the specific heat @xmath92 of the system @xcite .",
    "this quantity could in principle be calculated from the expression @xmath93 where the vector @xmath94 is determined by eq .",
    "( [ eqn : xvec],[eqn : x_with_n ] ) .",
    "however , for the bec hamiltonian the expressions for such quantities are unreasonably complicated , and we do not consider them in this paper . instead , higher derivatives will simply be obtained numerically once the temperature is determined .",
    "in this section we apply the new formula eq .",
    "( [ eqn : t ] ) to data from simulations of the pgpe described in @xcite , as well as to many new simulations with a wider range of energies and nonlinear parameters @xmath31 . for a full description",
    "we refer the reader to ref .",
    "briefly , the calculations evolve the projected gross - pitaevskii equation @xcite for the homogeneous gas in three dimensions @xmath95 the nonlinear constant is @xmath96 , where @xmath23 is the total number of particles in the volume , and @xmath25 is the period of the system .",
    "our dimensionless parameters are @xmath97 , wave vector @xmath98 , energy @xmath99 , and time @xmath100 , with @xmath101 .",
    "the projection operator @xmath102 excludes all components of the nonlinear term in the gpe outside the coherent region , and is defined by [ c.f .",
    "( [ eqn : projectorq],[eqn : projectorp ] ) ] @xmath103 where @xmath62 is an orthonormal basis appropriate to the problem . for the homogeneous system with periodic boundary conditions",
    "the relevant basis is the plane wave states , and so this procedure is simply the application of a forward fourier transform , removal of components with @xmath104 , followed by the inverse transformation . the quantity @xmath105 defines the momentum cutoff for the coherent region , and for all data presented in this paper we use @xmath106 .",
    "we begin with randomised initial fields @xmath107 with a given energy on a 3d grid with 32 points in each dimension , and evolve these until the field has reached equilibrium .",
    "we calculate all thermodynamic quantities from sampling two hundred field configurations in equilibrium .",
    "the choice of momentum cutoff @xmath108 is motivated simply by computational convenience .",
    "it also allows for comparison of the rugh method of temperature measurement with data from earlier calculations .    for a given initial energy ,",
    "the resulting equilibrium temperature depends on the number of modes below the cutoff .",
    "this can be easily understood from the equipartition theorem  if more modes are present , less energy will be contained in each one and therefore the final temperature will be lower . also , the dimensionless critical temperature for a system with a fixed normalisation depends on the cutoff , as can be seen in the text beneath eq .",
    "( [ eqn28 ] ) .",
    "work is currently in progress to develop a description of the modes above the cutoff and their coupling to the pgpe .",
    "the aim of this work is a complete computational method which will be insensitive to the exact position of the cutoff .",
    "exploring and developing techniques for the non - perturbative classical field is an important part of this programme , and we focus on this aspect of the problem in this paper .    despite this , there are some equilibrium calculations which can be carried out immediately using an approximate treatment of the modes above the cutoff .",
    "we present results for one such calculation ( the shift in @xmath109 with interaction strength ) in this paper .",
    "these results have only a weak dependence on the cutoff",
    ".      the classical field can only describe modes that satisfy the high occupation condition .",
    "but even at the critical temperature and above , the lowest energy states will have the largest occupations  and for a wide range of parameters , many of these can satisfy @xmath110 .",
    "these are the modes that are responsible for critical behaviour , such as the shift in @xmath109 and the increase in specific heat .",
    "the remaining modes ( that are not simulated ) behave essentially as an ideal gas .    as a physical example , consider our simulations for @xmath111 . choosing @xmath112 m , and rb-87",
    ", this corresponds to approximately @xmath113 atoms below the cutoff satisfying @xmath114 at @xmath109 of about 370 nk",
    ". there are about @xmath115 atoms in total , with a total number density of @xmath116 @xmath117 .",
    "thus in this situation nearly 30% of the atoms are simulated by the pgpe .      as described in sec .",
    "[ blergh ] there are many choices of the operator @xmath14 that may be used in eq .",
    "( [ eqn : t ] ) .",
    "the resulting calculations only give the same temperature if the system is in equilibrium , so this provides an important confirmation that the system has thermalized . in this paper",
    "we consider two cases @xmath118 and @xmath119 , and we refer to the temperatures calculated from these operators as @xmath120 and @xmath121 respectively . allowing @xmath122 or @xmath123 derivatives only in the separate definitions of the operator @xmath14 simplifies the calculation of eq .",
    "( [ eqn : t ] ) due to the elimination of mixed derivatives .     and @xmath121 calculated from eq .",
    "( [ eqn : t ] ) with temperatures @xmath124 determined from the same data plotted in fig .  9 of ref .",
    "grey triangles : @xmath125 , black dots : @xmath126 .",
    "( a ) @xmath31 = 500 , ( b ) @xmath31 = 2000 , ( c ) @xmath31 = 10000 . ]",
    "we begin by comparing @xmath120 and @xmath121 with previous results from ref .  @xcite . in this earlier work",
    "we obtained temperatures using three different methods , two based on bogoliubov quasiparticles and perturbation theory and a third non - perturbative calculation .",
    "this third method did not have a firm theoretical basis ; however , we showed that the results were consistent with the two other calculations in their regime of validity , and gave reasonable results more generally .",
    "figure  [ fig : compare ] shows the relative differences between the new simulation temperatures @xmath120 and @xmath121 calculated from eq .",
    "( [ eqn : t ] ) and the temperatures @xmath124 determined from the earlier method three . the simulation data used",
    "is the same as that plotted in fig .",
    "9 of ref .",
    "@xcite .",
    "we can see from fig .",
    "[ fig : compare ] that only a small number of points differ by more than one percent from the previously determined values , and even these would be hard to detect on a plot of the absolute temperatures .",
    "these results therefore validate our earlier non - perturbative method for temperature determination in a homogeneous system ( described in sec .",
    "vi.d of ref .",
    "figure  [ fig : compare ] also shows that in general the values of @xmath120 and @xmath121 agree with each other within their error bars .",
    "the error is determined from the standard deviation of the expectation value of eq .",
    "( [ eqn : t ] ) divided by the square root of the number of samples ( in this case two hundred ) .",
    "this estimate assumes gaussian statistics , which seems reasonable when the distribution of values is plotted as a histogram ; however , it may underestimate the actual error somewhat .",
    "the agreement between these distinct determinations of temperature confirms their validity and provides important further evidence that the pgpe evolves randomised initial states to a thermodynamic equilibrium consistent with the microcanonical ensemble .",
    "figure [ fig : tshift](a ) plots the equilibrium temperatures and condensate fractions for several series of simulations with different nonlinearities @xmath31 , as well as for the ideal gas .",
    "these can be interpreted to be simulations at a fixed density with a varying scattering length .",
    "it is immediately obvious that qualitatively the transition temperature increases with increasing nonlinearity , and this was noted in @xcite .",
    "much more data has been collected for this paper , and we now have a much more reliable measure of temperature .",
    "thus we can now look at the shift of the critical temperature with the nonlinear parameter @xmath31 for our pgpe system .    , crosses @xmath127 , solid dots @xmath128 , open circles @xmath129 , plusses @xmath130 , stars @xmath131 , open triangles @xmath111 .",
    "( b ) plot of the transition temperature versus interaction strength .",
    "the transition temperature is determined by the method of binder cumulants as described in the text . ]",
    "we can calculate the transition temperature for a non - interacting gas with equipartion occupation numbers and a momentum cutoff @xmath132 in the continuum limit via @xmath133 we find that the dimensionless critical temperature for a homogeneous pgpe system with a momentum cutoff of @xmath134 is @xmath135 , where the dimensionless temperature is defined by @xmath136 .    identifying the critical point in a finite - sized system with interactions , however , is somewhat more difficult . here",
    "we make use of the method of binder cumulants @xcite , which have been used in other finite - size calculations for the bose gas @xcite .",
    "we note that the theory behind binder cumulants is derived entirely from canonical statistical mechanics . however , the calculations of caiani",
    "_ et al_.   @xcite suggest that it is valid as a numerical tool in the microcanonical ensemble , and we shall follow their lead . the binder cumulant can be written as @xmath137 where @xmath138 is the population of the zero momentum condensate mode in our simulations",
    ". this quantity changes smoothly from one for the condensed system ( ordered phase ) to two for the uncondensed system ( disordered phase ) , with the width of the transition region decreasing with increasing lattice size .",
    "however , in lattice field theory the chemical potential at which curves of @xmath41 vs @xmath139 intersect for different lattice sizes is universal for a given universality class , which is three - dimensional xy for our system .",
    "it has been calculated by campostrini _",
    "et al_.  @xcite that this critical value is @xmath140 , where the first number in parentheses is due to statistical errors and the second is due to systematic errors .",
    "we therefore determine the critical temperature from our simulations by finding the energy at which the binder cumulant takes the value @xmath141 in equilibrium .",
    "due to our limited statistics from 200 field samples , the results are somewhat noisy , but we are able to identify @xmath142 for the simulations to an accuracy of approximately one percent .",
    "we note that for the case of @xmath143 , the predicted shift in critical temperature is more than 60% .",
    "however , this corresponds to the shift in _ dimensionless _ temperature of the low - energy states , not the shift in the critical temperature of the complete system which will be smaller .",
    "this will be discussed in more detail in sec .",
    "[ sec : tcshift ] .",
    "although the specific heat can theoretically be determined by a similar procedure to that used for the temperature , the actual formulae are rather complicated and difficult to calculate .",
    "instead in this section we use numerical methods to calculate curves for the specific heat .",
    "the calculation of numerical derivatives is difficult for data with statistical errors .",
    "here we have used a smoothing spline fitting technique to the raw numerical data for energy and temperature , and calculated the derivative from this fit .",
    "examples of the spline fits to the numerical data are plotted in fig .",
    "[ fig : evt ] .     so that the curves are distinct in the linear region .",
    "solid line @xmath144 , solid dots @xmath128 , plusses @xmath130 , open triangles @xmath111 .",
    "the grey lines are the smoothing spline fits to the numerical data . ]    , dashed line @xmath128 , dotted line @xmath130 , solid grey line @xmath111 .",
    "( b ) the maximum value of the specific heat plotted versus the dimensionless interaction strength @xmath31 . for both ( a ) and ( b )",
    ", the specific heat is plotted relative to the corresponding value at @xmath145 , and so the quantities are dimensionless . ]    the specific heat curves calculated from the data in fig .  [ fig : evt ] are shown in fig .",
    "[ fig : spheat](a ) .",
    "the units of the vertical axis are scaled by the specific heat of the ideal bose gas for the same system at @xmath145 .",
    "we can see that there is a strong peak near the critical temperature that increases with increasing @xmath31 .",
    "scaling theory for critical points in the thermodynamic limit suggests that the specific heat will be discontinuous at the phase transition . in our case",
    "the peak is not exactly at @xmath109 , as perhaps would be expected .",
    "we presume that this is due to to a combination of finite size effects and numerical errors in the fitting procedure , which we estimate to be a few percent .",
    "similar behaviour has also been noted in @xcite .",
    "figure  [ fig : spheat](b ) shows the maximum value of the specific heat plotted versus @xmath31 .",
    "the results presented in this paper for the homogeneous bose gas have many similarities to classical @xmath0 lattice field theory , which is often studied in relation to second order phase transitions . in such studies the field is discretised on a lattice with the spatial derivatives of the hamiltonian being approximated by finite difference methods .",
    "monte carlo simulations are then performed to study the thermodynamics .",
    "however , there have also been `` molecular dynamic '' simulations of such field theories , and in particular we note the work of caiani _",
    "et al_. , who have considered the phase transition via dynamical simulation of the @xmath0 model in both two @xcite and three dimensions @xcite .",
    "their equations of motion are distinct from those of this paper by virtue of being second order in time .",
    "their paradigm hamiltonian in @xmath146-dimensions is @xmath147 = \\int d^d\\mathbf{x } \\frac{1}{2 } \\pi^2(\\mathbf{x } ) + \\frac{j}{2}[\\nabla \\phi(\\mathbf{x})]^2 + \\frac{1}{2 } \\phi^2(\\mathbf{x } ) + \\frac{\\lambda}{4 } \\phi^4(\\mathbf{x}),\\ ] ] with the canonical position variables @xmath148 and conjugate momenta @xmath149 , where @xmath150 is a vector quantity with up to four dimensions .",
    "we note that as this hamiltonian is of the form @xmath151 , both the temperature and specific heat of these simulations can be calculated from expectation values of the kinetic energy .",
    "this is not possible for the hamiltonian we consider in this paper where the interaction term mixes powers of the position and momentum co - ordinates .    also , in ref .",
    "@xcite the parameters used were @xmath152 , and for ref .",
    "@xcite the values @xmath153 and @xmath154 are specifically mentioned .",
    "thus these calculations appear to be in quite a different regime to the results presented here . despite these differences ,",
    "however , it seems that much of their numerical data is qualitatively similar to ours .",
    "the results presented in this work can also be connected to the issue of the shift in the transition temperature for the homogeneous bose gas , which has been the subject of a number of recent papers . in the weak interaction limit",
    "the shift @xmath155 has the form @xmath156 where @xmath157 is the transition temperature for the ideal gas , @xmath158 is the density , @xmath33 is the @xmath159-wave scattering length and @xmath160 is a dimensionless constant .",
    "the value of @xmath160 can not be determined by perturbation theory as this breaks down at second - order phase transitions due to infrared divergences .",
    "there have been several calculations of the value of @xmath160 , differing by up to an order of magnitude and even in sign ( see the summary in @xcite ) .",
    "the dimensionless constant @xmath160 has recently been determined via monte carlo calculations by arnold and moore @xcite and kashurnikov _",
    "et al_. @xcite to be @xmath161 and @xmath162 respectively .",
    "these calculations were carried out via classical @xmath0 field theory , which can be systematically matched to the problem of the homogenous interacting bose gas .",
    "the monte carlo calculations proceeded by sampling the classical action @xmath163 , \\label{eqn : action}\\ ] ] on a lattice at a fixed temperature @xmath139 , where @xmath164 .",
    "the value of @xmath165 was adjusted until the critical point was reached , and thus the shift in critical density @xmath166 from the ideal gas value @xmath167 could be measured . the shift in critical temperature at a fixed density",
    "can then be determined from @xmath168 which is easily derived from the formula for the critical temperature of the ideal gas . while this procedure seems straightforward , in practice it is necessary to give careful consideration to finite - size effects in the calculation ",
    "see ref .",
    "@xcite for a detailed discussion of these matters .",
    "the results of simulations similar to those presented here can also be used to calculate a value for @xmath160 , as we are also sampling the thermodynamic functions of classical @xmath0 field theory .",
    "the monte carlo calculations fix the temperature and adjust the value of @xmath165 in eq .",
    "( [ eqn : action ] ) which then determines the normalisation of the field . in our calculations , we adjust the energy of the initial state to find the critical point and determine the temperature using the method described above .",
    "our simulations have a fixed normalisation , but the dimensionless temperature @xmath169 , so for a given value of @xmath31 we can interpret our results as being at a fixed temperature and a varying density .",
    "the main difference between the methods is the manner in which field configurations are sampled .",
    "the monte carlo methods can use the most efficient update possible , as long as the samples are canonical at a given temperature .",
    "our calculations solve for the evolution of a microcanonical field , and use the theorem of ergodicity to generate an ensemble .",
    "we have one minor advantage in that our momentum cutoff is spherically symmetric , whereas the monte carlo calculations simulate the first brillouin zone of the lattice .",
    "however , the molecular dynamics method suffers from critical slowing down  as the energy of the highest modes is @xmath170 , we require time steps of order @xmath171 where @xmath132 is the momentum cutoff .",
    "thus our simulations are disproportionally less efficient for larger grids compared to the monte carlo calculations , and will not be able to generate results as accurately for a given computation time @xcite .",
    "nonetheless , we can use our simulations to confirm qualitatively the results of the monte carlo analysis , providing an independent demonstration of the validity and potential usefulness of our temperature determination .    .",
    "the dashed line is a linear fit to the first two data points and this has a slope of @xmath172 . ]    as a simplified illustration , we follow through the logical procedure that would be required to calculate a value for @xmath160 . to consider the shift in the critical point",
    ", we can consider the shift in the critical density given a fixed critical temperature @xmath124 . in our numerical simulations we keep @xmath173 fixed and measure a shifted critical temperature @xmath174 here @xmath175 is the number of particles below the cutoff . if we fix the critical temperature at @xmath124 as well as the system size @xmath25 ( and hence @xmath176 ) , we can interpret the increase in the dimensionless quantity @xmath142 as a decrease in the value of @xmath175 and hence a decrease in the critical density . the most important point",
    "to note is that as long as we have @xmath177 , where @xmath178 labels the division between quasi - particle and particle like excitations at the transition temperature , then particles above the cutoff will not be significantly affected by the change in the interaction strength .",
    "we therefore calculate @xmath179 for the ideal gas , where @xmath180 is the total number of particles . this will be a constant as long as @xmath181 .",
    "we can then calculate @xmath182 and hence the shift in the critical density from the simulation data , and by using the relation of eq .",
    "( [ eqn : tcshift ] ) , we obtain the shift in the critical temperature .",
    "this can then be plotted against @xmath183 and the slope at the origin determines the coefficient @xmath160 .",
    "this plot is given in fig .",
    "[ fig : shift ] , where we have set @xmath184 .",
    "we note that the method does not depend on the value chosen for @xmath185 as long as it is large enough that @xmath37 is well satisfied .    by fitting a straight line to the first two points as illustrated in fig .",
    "[ fig : shift ] , we get an estimate for the coefficient @xmath186 where the error specified is due to the uncertainty in the value of @xmath109 for the data point",
    ". this agrees with the value determined in refs .",
    "@xcite  a result that should be treated with caution .",
    "the correct value of @xmath160 will only be reached in the limit of large volume and small lattice spacing , and we believe we have not reached this regime . for comparison with the results of arnold and moore , for our first data point we have @xmath187 and @xmath188 , where @xmath189 and @xmath190 .",
    "our other data points have values for these quantities that are much larger than this .",
    "arnold and moore suggest that @xmath191 and @xmath192 are necessary to get an accurate result for @xmath160 without a finite - size scaling analysis @xcite .",
    "we could potentially improve our results by performing such a finite - sized scaling analysis , but there is little reason to do so given the greater accuracy obtained in refs .",
    "the purpose of this calculation is to demonstrate a useful application of our temperature determination with the pgpe in a non - perturbative regime . in this regard",
    "the qualitative agreement with earlier more involved and specialized calculations provides a pleasing confirmation of the general validity of the method .",
    "we have shown that the projected gross - pitaevskii equation can be exactly mapped to hamilton s equations of motion for canonically conjugate position and momentum variables . using this mapping",
    "we have described how to utilise the microcanonical thermodynamic method of rugh @xcite to measure the temperature of pgpe simulations in the non - perturbative regime .",
    "this method agrees with previous calculations described in ref .",
    "@xcite , but has a rigorous theoretical justification and wider applicability . using this approach , we have quantitatively measured the shift in the critical temperature for condensation with the nonlinear constant @xmath31 .",
    "we have also observed that the specific heat reaches a maximum near the transition point as expected from the theory of continuous phase transitions , and that the peak value increases with the nonlinearity .",
    "finally , we have made a connection between these calculations and monte carlo simulations that have determined the shift in the critical temperature with scattering length of the homogeneous bose gas in the continuum limit .",
    "this is further evidence that the projected gpe should be valid for dynamical calculations through the critical region as long as the condition on the occupation numbers is satisfied .",
    "the authors are grateful to peter arnold and guy moore for their insightful comments on the relation of this work to that of refs .",
    "we also thank crispin gardiner for his useful comments .",
    "mjd would like to thank tim vaughan , karen kheruntsyan , joel corney , and peter drummond for several useful discussions at various stages of this work .",
    "mjd acknowledges the financial support of the university of queensland and the australian research council centre of excellence grant ce0348178 .",
    "sm would like to thank the royal society of london for financial support ."
  ],
  "abstract_text": [
    "<S> we show that the projected gross - pitaevskii equation ( pgpe ) can be mapped exactly onto hamilton s equations of motion for classical position and momentum variables . making use of this mapping , we adapt techniques developed in statistical mechanics to calculate the temperature and chemical potential of a classical bose field in the microcanonical ensemble . </S>",
    "<S> we apply the method to simulations of the pgpe , which can be used to represent the highly occupied modes of bose condensed gases at finite temperature . </S>",
    "<S> the method is rigorous , valid beyond the realms of perturbation theory , and agrees with an earlier method of temperature measurement for the same system . using this method </S>",
    "<S> we show that the critical temperature for condensation in a homogeneous bose gas on a lattice with a uv cutoff increases with the interaction strength . </S>",
    "<S> we discuss how to determine the temperature shift for the bose gas in the continuum limit using this type of calculation , and obtain a result in agreement with more sophisticated monte carlo simulations . </S>",
    "<S> we also consider the behaviour of the specific heat . </S>"
  ]
}