{
  "article_text": [
    "the standard lattice boltzmann approach leads to an ideal gas equation of state .",
    "several different approaches to simulate non - ideal fluids with lattice boltzmann have been introduced in the past .",
    "the main application has been to simulate phase separation , although other application like an increase in the speed of sound have also been considered .",
    "there are two different philosophies to introduce the non - ideal terms .",
    "the first is guided by an atomistic picture and local interactions are introduced through a forcing term @xcite .",
    "the second starts from the navier - stokes equation for a non - ideal gas and tries to match the hydrodynamic limit of the lattice boltzmann equation with this macroscopic equation @xcite .",
    "whatever the underlying philosophy , each approach leads to some non - ideal equation of state . knowing the equation of state is sufficient to predict the phase - behavior from equilibrium thermodynamic arguments .",
    "the equilibrium densities are determined through the maxwell construction @xcite .",
    "many approaches fail this test and the resulting phase - diagrams deviate from the theoretical one .    for many simple applications where phase - separation is only required to form a nearly immiscible system , these thermodynamic details may be of limited importance . for simulations of phase - separation , however , such details can be crucial . in this paper",
    "we will examine why lattice boltzmann approaches using a force to introduce the non - ideal equation of state fail to obtain the correct thermodynamic behavior .",
    "we explicitly identify the terms that lead to the non - thermodynamic behavior of these methods .",
    "the paper is organized as follows : we first identify the hydrodynamic equations that we intend to simulate .",
    "we then discuss the equilibrium behavior of these equations .",
    "we then introduce a general lattice boltzmann method which introduces non - ideal terms through either forcing or pressure terms",
    ". the hydrodynamic limit of this approach is presented .",
    "this allows us to identify how we can incorporate the non - ideal pressure contributions by either incorporating a bulk force or by altering the pressure moment of the equilibrium distribution .    these two different methods for non - ideal systems are equivalent to the old y. chen method @xcite , or the more recent extension by he _",
    "@xcite when we use the bulk force and the holdych correction to the swift model @xcite when we directly alter the pressure moment . however , we are not able to consistently introduce surface tension effects at this point since those appear as higher order derivatives that are not derivable by a second order expansion @xcite .    these higher order derivatives , however , are necessary to achieve thermodynamic consistency . we introduce a near equilibrium analysis of sufficient order to consistently derive these higher order gradient terms .",
    "this analysis uncovers correction terms for pressure and forcing methods . despite the fact that we only perform a 5th order analysis we are able to identify the correction terms exactly when the fluid is not advected with respect to the lattice . with this knowledge",
    "we are then able to formulate a forcing method that achieves thermodynamic consistency .",
    "as a simple example for a non - ideal fluid we will examine a single component fluid that can undergo a liquid - gas phase - transition . for simplicity an isothermal system is considered .",
    "such a system has an underlying free energy of the form @xmath0\\ ; dx \\label{genfree}\\ ] ] where @xmath1 is the density , @xmath2 is the bulk free energy and @xmath3 is a gradient expansion of the interfacial free energy .",
    "the lowest order term for the free energy is @xmath4 and usually only this term is considered .",
    "the equations of motion for a non - ideal gas are given by the continuity equation @xmath5 @xmath6 is the velocity of the fluid , and the navier - stokes equation of a non - ideal gas @xmath7 here @xmath8 is the chemical potential of the non - ideal gas and @xmath9 is the newtonian stress tensor .    let us consider how this system will approach equilibrium .",
    "the equilibrium will be time independent and the flow will be uniform , _ i.e. _ @xmath10const .",
    "so the equation ( [ ns ] ) reduces to @xmath11 so that the chemical potential will be constant in equilibrium .",
    "condition ( [ muconst ] ) only guarantees that the chemical potential is constant in both phases .",
    "bulk thermodynamics , however , requires that the pressure is also constant in equilibrium .",
    "this is guaranteed through the thermodynamic relation @xmath12 where @xmath13 is the pressure tensor .",
    "this pressure tensor is defined through the properties that it is equal to the bulk pressure in the absence of density gradients @xmath14{\\ensuremath{\\mathbf{1}}}$ ] and through condition ( [ pcond ] ) in the interfacial areas @xcite . with this relation",
    "a uniform chemical potential is equivalent to a divergence - free pressure tensor .    as an aside it is interesting to note that this statement is more general than bulk thermodynamics .",
    "it can even be applied to finite systems with curved interfaces .",
    "an example is an equilibrium drop that will have a constant chemical potential , but the pressure inside the drop will differ from the pressure outside by the laplace pressure @xmath15 , where @xmath16 is the surface tension . despite this difference in the pressures inside and outside the drop the divergence of the pressure tensor",
    "vanishes everywhere .",
    "for such a system with a curved interface the equilibrium liquid and gas densities will differ slightly from the bulk thermodynamic values @xcite",
    ".    the connection between bulk thermodynamics and the equilibrium condition @xmath17 can be established by considering a flat interface between the liquid and gas phases .",
    "assume that this interface is orthogonal to the x - axis .",
    "in this case @xmath18 is just the derivative of a scalar function .",
    "therefore it follows from @xmath19 that in the bulk phase @xmath20 .",
    "therefore the solution of the differential equation @xmath21 for a flat interface implies the standard bulk thermodynamic equilibrium conditions @xmath22 and @xmath20 .",
    "let us consider the condition @xmath23 in some more detail . for concreteness sake",
    "let us assume that @xmath24 .",
    "we then obtain @xmath25 and @xmath26{\\ensuremath{\\mathbf{1}}}+\\kappa\\nabla\\rho\\nabla\\rho$ ] .",
    "then the differential equation for a single flat interface becomes @xmath27 subject to the boundary conditions that @xmath28 because ( [ diff ] ) is equivalent to both @xmath29 and @xmath19 the limiting values for the density will be the equilibrium densities @xmath30 and @xmath31 .",
    "this conclusion , however , is independent of the form of the interfacial energy term @xmath3 and as long as the new differential equation has a solution that fulfills the boundary condition ( [ bc ] ) the limiting densities @xmath30 and @xmath31 will be the same .",
    "the important corollary of this argument is that while there are many possible forms of the chemical potential and corresponding pressure tensor that lead to the correct bulk phase behavior , arbitrary derivative terms ( that might arise because of unintentional higher order corrections to the numerical method ) will in general not be derivable from an interfacial energy term @xmath32 .",
    "in such a situation the differential equation ( [ muconst ] ) can lead to bulk densities that do not correspond to the equilibrium densities .",
    "these situations are the main concern of this paper .",
    "the lattice boltzmann method can be viewed as a discretization of the boltzmann equation . and",
    "in the same way that the boltzmann equation describes a gas that at long wavelength obeys the hydrodynamic equations , the same is true for the lattice boltzmann method . in the lattice boltzmann method",
    "both the space and velocity space is discretized and the basic variables are the densities @xmath33 associated with the velocity @xmath34 .",
    "the hydrodynamic variables are then the local density @xmath35 and the momentum @xmath36 most lattice boltzmann methods do not conserve energy and instead enforce a constant temperature .",
    "one caveat is that @xmath37 is not necessarily the local velocity , as we will see below .",
    "the evolution equation for a non - ideal fluid can be written as @xmath38 here @xmath39 is the equilibrium distribution for the ideal gas .",
    "the @xmath40 represent non - ideal contributions to the pressure tensor @xcite , and @xmath41 are contributions of an external force .",
    "the force can also be used to mimic interactions in a mean - field manner .    in lattice",
    "boltzmann the navier - stokes equations are not discretized directly ; instead the moments of the equilibrium distribution as well as @xmath40 and @xmath41 are chosen such that the momentum moment of a second order expansion of the lattice boltzmann equation will give the desired navier - stokes equation ( [ ns ] ) .",
    "a dilemma occurs when the pressure tensor itself contains second order derivative terms since these terms are formally higher than second order in the navier - stokes equations .",
    "these terms are not consistently derived in standard lattice boltzmann expansion techniques .",
    "so the question arises : how can these terms be consistently incorporated into a lattice boltzmann method ?",
    "one may consider simply expanding the lattice boltzmann equation to higher order , but this will lead to burnett level equations , which is not the desired result .",
    "the reason that these higher order density derivatives appear in the navier stokes equation is because the density derivatives are not small near an interface and these terms are responsible for the surface tension .",
    "it is difficult and rather cumbersome to extend the expansion of the lattice boltzmann equation to higher orders in a general way .",
    "so instead we will consider an equilibrium ( or at least stationary state ) interface instead and develop a higher order analysis for this situation .",
    "doing so uncovers the additional terms that lead to a lack of thermodynamic consistency for forcing methods . incorporating these terms allows for thermodynamic consistency as will be discussed below .",
    "there are two expansion methods that are regularly used to derive the hydrodynamic limit of the lattice boltzmann equations : they are referred to as the taylor expansion and the chapman - enskog methods . up to second order the methods give identical results , but there is debate about the equivalence of the two methods for higher order results . in this paper",
    "we will utilize the first method .    to establish a starting point for a higher order expansion we will first present the standard second order expansion .",
    "we will then show how to choose the moments of @xmath39 , @xmath40 , and @xmath41 to simulate a van der waals gas .",
    "to obtain the hydrodynamic equations that govern the evolution of the slow dynamics of the conserved quantities we use a taylor expansion of ( [ lbeqn ] ) to second order . as usual we will only conserve mass , defined through the density ( [ density ] ) and momentum defined through ( [ udef ] ) .    for this iso - thermal model , which does not include a conserved energy moment",
    ", we require the knowledge of the first three velocity moments of the equilibrium distribution function .",
    "these are given by @xmath42 galilean invariance would require the third order tensor @xmath43 to vanish . in most standard lattice boltzmann methods",
    "this term does not vanish , however , because these models contain too small a velocity set .",
    "for these models @xmath44 which precludes the presence of the third power of @xmath37 in the @xmath45 moment .",
    "it also fixes the temperature to be @xmath46 .",
    "therefore most models have a @xmath43 term given by the third order tensor @xmath47 .",
    "the effects of the galilean invariance violation caused by this term become noticeable only at large velocities @xmath48 @xcite .",
    "the non - ideal contributions from the @xmath40 need to conserve mass and momentum and the moments are given by @xmath49 the forcing term @xmath41 needs to conserve mass , therefore @xmath50 it also needs to change the momentum by an amount @xmath51 , therefore we choose @xmath52 the second moment of the forcing term is usually taken to be zero , but we leave a general term @xmath53 which we will use later to contain a correction term .",
    "@xmath54 at this point it is worth while to note that the distinction between the @xmath55 and the @xmath53 terms is somewhat artificial .",
    "both terms enter the lattice boltzmann equation in the same way , so that instead of @xmath53 we can insert the term @xmath56 and vice versa .",
    "we distinguish between these terms to connect our analysis to established methods .",
    "pressure methods @xcite only use @xmath55 and forcing methods @xcite only @xmath57 and @xmath53 .",
    "now we need to derive the hydrodynamic limit of the lattice boltzmann equation ( [ lbeqn ] ) to link this method to the hydrodynamic equations ( [ cont ] ) , ( [ ns ] ) which we want to simulate .      while the taylor expansion method is in principle well known we will present it here again because the higher order analysis presented later in this paper uses the results and techniques of this approach .",
    "the main premise of the taylor expansion approach is that the distribution function can be expressed by a taylor expansion @xmath58 where we have defined the derivative operator @xmath59 . for this expansion to be useful",
    "we must make the assumption that derivatives are small .",
    "one could phrase the same argument in terms of @xmath60 , but it will be convenient to set @xmath61 in ( [ lbeqn ] ) . to order our terms",
    "we will therefore use the derivatives as a small parameter @xmath62 so that @xmath63 .",
    "we obtain for ( [ lbeqn ] ) to second order @xmath64 where we have introduced @xmath65 .",
    "this relates non - local @xmath66 to local @xmath66 and their derivatives .",
    "however , the @xmath66 remain unknown and we only know the @xmath67 in terms of the macroscopic quantities",
    ". we can use ( [ expand ] ) to express the @xmath66 in terms of the equilibrium distribution and higher order derivatives : @xmath68 using this approximation we can now express the lattice boltzmann equation purely as a differential equation in terms of the equilibrium distribution and the collision term : @xmath69 taking the zeroth order velocity moment @xmath70([expand_equil ] ) we obtain ( borrowing the euler level terms , _",
    "i.e. _ the terms of @xmath71 , of the momentum equation ( [ nseqn ] ) ) the continuity equation : @xmath72 this leads us to identify the mean fluid velocity as @xmath73 we then obtain the continuity equation @xmath74 taking the first order velocity moment @xmath75([expand_equil ] ) we obtain the navier - stokes level equation : @xmath76 where the newtonian stress tensor @xmath16 is given by @xmath77 and unphysical terms have been collected in the remainder tensor @xmath78 + o(\\partial^2 ) .",
    "\\label{eqnr}\\ ] ] the kinematic viscosity is given by @xmath79 .",
    "note that while we wrote @xmath80 in equations ( [ sigma ] ) and ( [ eqnr ] ) it can not be distinguished from @xmath37 here because the forcing term is @xmath71 and therefore @xmath81 .",
    "we also note that most of the unphysical terms in ( [ eqnr ] ) violate galilean invariance @xcite .",
    "if we set both @xmath55 and @xmath57 to zero we obtain the navier - stokes equation for an ideal gas . to obtain",
    "the navier stokes equation for a non - ideal gas previous research has identified two different strategies .",
    "one option is to use the forcing term to introduce the non - ideal contribution to the equation of state@xcite .",
    "the form presented here was first presented in the elegant work of he _",
    "_ @xcite . in this case , which we will refer to as the forcing method , we define @xmath82 where @xmath83 is the non - ideal part of the pressure tensor .",
    "the second approach is based on the idea of including the non - ideal pressure in the second moment of the equilibrium distribution@xcite . to do this",
    "we define @xmath84 where the @xmath85 terms have been introduced by holdych _",
    "_ @xcite and later by inamuro _",
    "_ @xcite . to do this we have to use the near - equilibrium approximation of @xmath86 , as discussed by kalarakis @xcite .",
    "up to second order in the derivatives both of these approaches lead to the same hydrodynamic equations @xmath87    for the van der waals pressure for a critical density of 1 and",
    "a temperature @xmath46 the pressure tensor is given by @xmath88 using this pressure for the two methods we observe phase - separation below the critical temperature as shown in figure [ fig1 ] .",
    "there are , however , a number of peculiarities .",
    "let us first discuss the results for the pressure method .",
    "there is no unique solution .",
    "three different profiles for the pressure method are shown in figure [ fig1](a ) .",
    "all of them are stable solutions which are stable against small perturbations .",
    "also the density profiles are sharp , switching from the liquid to the gas density in only one lattice spacing .",
    "these profiles correspond to a constant pressure profile ( fig . [ fig1](b ) ) , which is exact to machine accuracy .",
    "the chemical potential profiles , however , are vastly different as shown in figure [ fig1](c ) .",
    "only the middle profile corresponds to a constant chemical potential , and therefore to the thermodynamic equilibrium . in figure",
    "[ fig1](d ) we show the phase - diagrams . only in the white area in this diagram can liquid and gas phases have equal pressures .",
    "we show the results of simulations which are initialized with a near constant pressure in the gas and liquid phase .",
    "the @xmath89 triangles correspond to simulations initialized with the lowest possible constant pressure and the @xmath90 triangles correspond to simulations initialized with the highest possible constant pressure .",
    "all these simulations are stable to small perturbations .",
    "it appears that all states with equal pressures , including but not limited to the true equilibrium state , are stable solutions .",
    "the forcing method leads to a unique profile which has an interface extending over several lattice spacings .",
    "the bulk pressures of the liquid and gas phases agree , but there are variations of the pressure ( [ vdw ] ) around the interface in figure [ fig1](b ) .",
    "the bulk values of the chemical potential , however , are not equal .",
    "it is therefore not surprising that the phase - diagram differs from the true equilibrium profile as shown in figure [ fig1](d ) .    to understand these results",
    "let us recall that expression for the pressure ( [ vdw ] ) does not contain any gradient terms .",
    "this corresponds to @xmath91 in the expression for the free energy ( [ genfree ] ) .",
    "this means that we have not input any interfacial free energy contributions and we therefore expect a sharp interface . but without interfacial contributions the differential equation @xmath19 is no longer a differential equation .",
    "instead this only requires that the pressure for both phases is the same , @xmath20 .",
    "any such pressures will fulfill @xmath19 , as shown in figure [ fig1]b . in this figure numerical solutions at the maximum and minimum of the coexistence liquid and gas pressures as well as",
    "the true equilibrium pressure are shown . only for the true equilibrium densities",
    "will @xmath22 be true as can be seen in figure [ fig1]c .",
    "so clearly @xmath92 is no longer generally valid .",
    "there is no guarantee that a system without interfacial energy obeying the dynamic equations ( [ cont ] ) and ( [ ns ] ) will move towards true equilibrium .",
    "this explains why the pressure method , which leads to the expected sharp interface , can fail to recover the equilibrium densities .",
    "this , however , is not enough to understand the stability of the interfaces to small perturbations . to change the liquid and gas densities",
    "it is in general necessary to move the interface .",
    "because the method leads to a sharp interface , moving this interface will lead to states that have one lattice point with a density between the gas and liquid densities .",
    "if the gas density is slightly increased , the pressure will also increase , favoring a return to the original density .",
    "likewise if at one point the liquid density is reduced this will lead to a lower pressure inducing the return to the original density commensurate with the surrounding pressure .",
    "so the stability of these non - equilibrium structures occurs because moving an interface requires different discretizations of the interface .",
    "and these discretizations lead to position dependent pressures which counteract the movement of the interface .",
    "the results shown in figure [ fig1 ] are at a mean velocity of zero .",
    "the situation changes when a mean velocity is added to the system . in these cases",
    "we do not find advected stationary solutions , but instead large oscillations are observed for sharp interfaces .",
    "this violation of galilean invariance is removed by increasing the width of the interface , as shown in @xcite .    in the case of the forcing method",
    "the situation is more complicated .",
    "the forcing method leads to a unique extended interface as shown in figure [ fig1]a . since we do not obtain a sharp interface",
    "the pressure @xmath13 of equation ( [ vdw ] ) is not constant , as seen in figure [ fig1]b .",
    "therefore higher order gradient terms must be present in the pressure for this lattice boltzmann method .",
    "these gradient terms arise because of higher order terms in the lattice boltzmann method that were not picked up by our second order expansion .",
    "the bulk values of the pressure in figure [ fig1]b are the same for the liquid and gas phases as is to be expected from the condition of mechanical equilibrium . the same , however , is not true for the chemical potential in figure [ fig1]c . because the bulk values of the chemical potential are not the same the densities",
    "also do not correspond to their equilibrium values .",
    "for the pressure method there are two potential remedies for us to recover the equilibrium bulk densities for the liquid and gas phases .",
    "the most obvious one , in light of the present discussion , is to explicitly include the correct gradient terms in the pressure and we will follow that route below . a second potential remedy lies in including fluctuation terms in the navier - stokes equations .",
    "incorporating equilibrium fluctuations allows the interfaces to move and to select the correct equilibrium bulk densities for the pressure method .",
    "this approach , however , is outside the scope of the current paper .",
    "while derivatives in the pressure tensor are not consistent with the second order expansion , it appears reasonable to include the full derivative terms in the pressure tensor .",
    "this is indeed what was done in the original pressure method @xcite and since the numerical simulations do not indicate the presence of any spurious interfacial terms it is not surprising that this approach is successful for the pressure algorithm .",
    "the usefulness of including the full gradient terms in the pressure tensor is less obvious for the forcing method where there are clearly already significant , spurious interfacial terms present that lead to an extended interface .",
    "so we will now replace ( [ vdw ] ) with @xmath93{\\ensuremath{\\mathbf{1}}}+\\kappa\\nabla\\rho\\nabla\\rho . \\label{vdw_int}\\ ] ] for a numerical implementation the gradient and laplace operator have to be replaced by discrete versions .",
    "this is problematic because it will in general break the relation @xmath92 , and thereby also the exact thermodynamic consistency . for interfaces that are wide enough though",
    ", this relation will still hold to good approximation .",
    "we have not yet been able to identify a discrete derivative operator and an expression for the pressure that preserves @xmath94 .",
    "such an expression could guarantee that a constant pressure is exactly equivalent to a constant chemical potential , and therefore it would exactly recover equilibrium thermodynamics .    for the simulations presented in this paper we require the one dimensional discrete gradient and laplace operator .",
    "we use the discretization @xmath95 for @xmath96 the expression ( [ vdw_int ] ) leads to ( [ vdw ] ) .",
    "but for finite @xmath97 we now expect to find an extended interface for the pressure method .",
    "we also expect that a constant pressure will now reduce the difference in the chemical potential for the two phases .",
    "the results are shown in figure [ fig2 ] .",
    "for a sufficiently large interfacial energy contribution of @xmath98 there is now a unique solution for the pressure method .",
    "this solution also agrees very well with the analytical phase - diagram .",
    "we find that the pressure is constant up to machine accuracy and the chemical potential is very nearly constant .",
    "in particular the deviation in the bulk value of the chemical potential in the gas and liquid phase are less than @xmath99 .    .",
    "a unique solution is only found for large enough values of @xmath97 . for a detailed discussion of this effect see the main text . ]    in the continuous situation the non - definiteness of the stationary state is limited strictly to @xmath96 . for a discrete approach @xmath100 is not generally valid , and therefore it is not _ apriory _",
    "clear that an arbitrarily small interfacial term in the pressure will guarantee a convergence to the equilibrium solution . as we have seen",
    "before it is not even guaranteed that it will converge to a unique solution .",
    "we therefore performed a set of simulations for different values of @xmath97 from 0 to 0.1 with initial conditions that correspond to the extreme values of the equal pressure as well as the equilibrium solution .",
    "the simulation results are shown in figure [ fig3 ] .",
    "we see that non - uniqueness survives for finite @xmath97 .",
    "the range of possible pressures is rapidly reduced until a near - unique solution is found at @xmath97 larger than about @xmath101 .",
    "the origin of this non - uniqueness even in the presence of an interfacial energy lies in the discretization of the interface . moving the interface over the lattice",
    "requires a re - discretization of the interface .",
    "each of these discretizations will have a different interfacial free energy @xmath102 . to visualize this",
    "imagine a sharp interface of fig [ fig1]a .",
    "this interface has only two points with non - vanishing gradient and laplace operators .",
    "if this interface moves there will have to be at least one point with intermediate value of @xmath1 and now there are at least three points with non - vanishing gradient and laplace terms . therefore moving",
    "the interface will change the total free energy .",
    "mass - conservation generally implies that changing the liquid and gas densities requires changing the relative gas and liquid volumina . therefore changing the densities",
    "requires that the interfaces move .",
    "but if moving the interface requires passing a local maximum in the free energy , this implies that the system is at least in a metastable state . and",
    "a lattice boltzmann method without fluctuations can not escape such a metastable state .",
    "so to move an interface that is well aligned with the lattice one has to overcome a free energy barrier with respect to the less favorable discretization of the interface and the simulation can get stuck in a non - equilibrium configuration .",
    "the forcing method is also noticeably improved through the inclusion of the gradient terms .",
    "the difference in the bulk chemical potential is about halved from @xmath103 to @xmath104 .",
    "this is still about 50 times larger than the difference for the pressure method .",
    "this difference in the chemical potential translates to a deviation of the liquid and gas densities from their equilibrium values .",
    "this can be clearly seen in figure [ fig2]d . in order to understand the origin of the large deviations of the forcing method from the thermodynamic equilibrium we need to uncover the spurious gradient terms in the effective pressure .",
    "to do this we need to improve our expansion method to consistently derive those derivative terms .",
    "to identify the higher order terms of the equilibrium structure we perform a 5th order expansion around an equilibrium profile which is stationary , but possibly advected with a constant velocity @xmath105 .",
    "as before we make the assumption that derivatives are small ( @xmath106 ) . from equation ( [ nseqn ]",
    ") we already know that @xmath107 .",
    "to avoid obtaining too many terms we will limit our analysis here to small velocities , so we also postulate @xmath108 .",
    "note that since we will only neglect terms of order @xmath109 we will not loose any of the terms present in the lower order expansion , with the single exception of the @xmath110 term in equation ( [ sigma ] ) .    performing a taylor expansion to 5th order in the derivatives of ( [ lbeqn ] ) and expressing the @xmath66 in terms of @xmath111",
    "we obtain @xmath112 which is the extension of ( [ expand_equil ] ) to two more orders . here",
    "the derivative operator is @xmath113    for a stationary profile , advected with velocity @xmath105 , we have the operator identity @xmath114 this simplifies the derivative operator @xmath115 we now need to take the zeroth and first order moments of this expression to obtain the expressions for the continuity and navier stokes level equations in the stationary advected limit .",
    "the expectation is that the continuity equation takes the form @xmath116 and the navier - stokes level equation will become @xmath117 this then allows us to identify the effective mean fluid velocity @xmath118 to fifth order and the effective pressure tensor @xmath13 also to fifth order .",
    "it is highly desirable , although far from obvious , that these quantities be independent of the relaxation time @xmath119 .",
    "otherwise the equilibrium properties would be coupled to the transport coefficients .",
    "this task is cumbersome since it involves up to fifth order velocity moments of the equilibrium distribution function .",
    "we will restrict ourselves here to the analysis of a projection of the most common models ( d2q7,d2q9,d3q15,d3q19,and d3q27 ) to one dimension .",
    "this projection is the d1q3 model , a one dimensional model with three velocities .",
    "it is important to note that this analysis is entirely sufficient to determine the phase - behavior of all the above models .",
    "the only issue not addressed by this analysis is the isotropy of the models .",
    "one caveat is that this analysis will only be able to make statements of the equilibrium behavior of the method , not about the approach to equilibrium .",
    "the d1q3 model is a one dimensional lattice boltzmann model with three velocities : @xmath120 . in this model",
    "there are only three distinct velocity moments at each lattice point , corresponding to the three densities @xmath66 .",
    "the moments of the equilibrium density are @xmath121 because @xmath122 _ etc .",
    "_ , all higher order velocity moments are given by these first three moments .",
    "the three moments of the forcing term are given by @xmath123 the higher order moments are similarly given by these first three moments .",
    "the algebra involved in calculating the higher moments is quite extensive , so i will only outline the method here without giving the lengthy intermediate results .",
    "summing @xmath124 gives an expression for the continuity involving all moments of @xmath67 and @xmath41 .",
    "similarly we obtain such an expression containing all moments by summing @xmath125 to obtain the momentum equation .",
    "we can then use the momentum equation to express @xmath55 in terms of the other moments and higher order derivatives of @xmath55 .",
    "then we insert this expression repeatedly into itself ( similarly to what we did for equation ( [ fzero_eqn ] ) ) to express @xmath55 completely in terms of the other moments and their derivatives .",
    "this expression for @xmath55 is then used to eliminate any @xmath55 dependence in the continuity equation .",
    "we then use the resulting continuity equation to express @xmath126 in terms of the other moments and higher order derivatives of @xmath126 .",
    "this expression for @xmath126 is then inserted for all but the lowest order derivatives of @xmath126 of the continuity equation .",
    "the resulting continuity equation has the form @xmath127=0(\\epsilon^5 ) \\label{cont3}\\ ] ] which only contains one term of @xmath126 and no terms with @xmath55 .",
    "we use this version of the continuity equation to express @xmath126 in terms of @xmath105 , @xmath1 and @xmath57 and replace all occurrences of @xmath126 in the momentum equation .",
    "we then remove all but the lowest order occurrences of @xmath55 in the momentum equation and obtain @xmath128 \\right.\\nonumber\\\\ & \\left.+\\frac{1}{4\\rho } ff+\\frac{1}{12}\\nabla f -\\tau(\\frac{ff}{\\rho}+\\psi )   \\right]=o(\\epsilon^5 ) .",
    "\\label{finalns}\\end{aligned}\\ ] ] now we apply these results to our pressure and forcing methods .      for the pressure method we use the moments defined in equation ( [ pressure1 ] ) and",
    "obtain for the continuity equation @xmath129=0(\\epsilon^5).\\ ] ] comparing this to ( [ contstat ] ) we see that the mean fluid velocity is @xmath130 the gradient term is a new correction for the measurement of the velocity for the pressure method . for the momentum equation",
    "we obtain @xmath131 there are no additional pressure terms for the pressure method , which is consistent with the fact that we found a constant input pressure for simulations with the pressure method in figures [ fig1](b ) and [ fig2](b ) .    to test the correction for the velocity predicted in ( [ ucorrection ] ) we have to consider a situation in which @xmath105 is not zero .",
    "we set up a profile that is initiated with a velocity of @xmath132 . in figure",
    "[ ugraph](a ) we plot both the standard velocity @xmath126 from ( [ udef ] ) and our new approximation of the true fluid velocity @xmath118 from ( [ ucorrection ] ) .",
    "first we note that the gas phase is advected faster than the liquid phase , which is a problem of galilean invariance @xcite .",
    "the gas is advected faster than the liquid and a constant evaporation on the leading edge of the droplet and a condensation at the trailing interface of the liquid leads to a mean interface velocity that is less than the imposed mean fluid velocity of @xmath133 .",
    "this evaporation and condensation leads to an additional velocity @xmath134 of the interface .",
    "for such an interface velocity we have an additional contribution to the change of the density , the rate of evaporation given by @xmath135.\\ ] ] so to compare the original definition of @xmath118 from equation ( [ uhatdef ] ) with the corrected definition of equation ( [ ucorrection ] ) we plot @xmath136 $ ] for the two definitions of @xmath118 and @xmath137 in figure [ ugraph](b ) .",
    "we see that the corrected version of the velocity allows a very good fit with the theoretical expression .",
    "the best fit for @xmath134 is -0.0002 which corresponds to a 2% correction for the observed domain velocity .    while the galilean invariance violations are small , in this case it is still worth while to correct the galilean invariance violations of the lattice boltzmann method .",
    "to do that we need an expansion that does not make the assumption @xmath138 .",
    "this investigation of higher order galilean invariance violations will be reported elsewhere .      for the forcing method ( [ forcing1 ] )",
    "we obtain the continuity equation @xmath139 this implies that the mean fluid velocity is given by @xmath140 in agreement with the lower order expression ( [ uhatdef ] ) .",
    "there are no further corrections to the velocity for the forcing method to this level of approximation .    to evaluate the higher order terms for the pressure in equation ( [ finalns ] ) we need to insert the specific form of the force .",
    "we have @xmath141 with this expression for @xmath57 the momentum equation becomes @xmath142 where we have again expressed some of the higher order contributions in terms of the force .",
    "we conclude that the effective pressure is given by @xmath143 this explains why the input pressure is not constant for the current forcing method .",
    "to verify this analytical result we can plot both the input pressure @xmath13 and the predicted effective pressure @xmath144 for a phase separated stationary profile obtained from the forcing version of the lattice boltzmann simulation .",
    "the result is shown in figure [ pgraph ] .    ) and the effective pressure @xmath144 of equation ( [ peff ] ) for the forcing method for two values of @xmath97 .",
    "we see that the effective pressure @xmath144 is constant to machine accuracy in both cases .",
    "this agreement is better than expected since expansion predicted this pressure only up to fifth order .",
    "the critical temperature for this simulation is @xmath145 at @xmath146 so that true equilibrium pressure is 0.09 . ]",
    "somewhat surprisingly , the pressure @xmath144 is not simply a fifth order approximation to the true pressure . instead , for @xmath147 , this gives a pressure that is constant to machine accuracy ! to be exact what is constant is the discretization @xmath148 this is , presumably , due to the fact that the higher order moments are just repeats of the lower order moments and this allows the higher order moments to consist of higher order derivatives of the lower order moments .",
    "unfortunately this exact solution no longer holds if @xmath149 , because the higher order moments contain higher powers of @xmath105 .",
    "the fact that we know an _",
    "exact _ pressure that we minimize may prove to be very useful for diffusive systems , though , for which we have @xmath147 .",
    "this may also open the door for an important application of mimetic calculus .",
    "if we were able to find some discrete gradient operators @xmath150 for which @xmath151 holds , we would be able to devise a method that _ always _ recovers the correct equilibrium behavior .      , @xmath146 and @xmath98 . ]    now that we have identified the effective pressure @xmath144 that is constant in the steady state we can identify a method that will have a constant input pressure @xmath13 .",
    "investigating equations ( [ cont3 ] ) and ( [ finalns ] ) we can identify a choice of @xmath53 that will allow us to cancel the additional pressure terms due to the force .",
    "we can amend the original forcing method ( [ forcing1 ] ) with @xmath152 we then obtain the continuity equation @xmath153 and the momentum equation @xmath154 the choice of @xmath53 is not unique regarding the exact choice of the correction terms . we could replace @xmath155 with @xmath156 and still remain correct up to @xmath109",
    ". however , the above choice again leads to a pressure that is constant up to machine accuracy for @xmath147 , just as we did with the pressure method .",
    "a comparison of the pressure method and the corrected forcing method is shown in figure [ ncomp ] .",
    "the new forcing method is nearly indistinguishable from the pressure method .",
    "one small difference between the two methods is that an alternating pattern in the pressure does not lead to a force , and therefore does not decay . in the simulation shown in figure [ ncomp ]",
    "those pressure oscillations have an amplitude of about @xmath157 .",
    "however , in some simulations these oscillations can become large . also for large velocities",
    "these oscillations can become unstable and make this method less stable than the pressure method at larger velocities .    because the pressure and chemical potential depend only on the profile @xmath158 the new forcing method gives the same constant pressure and near constant chemical potential as the pressure method shown in figure [ fig2 ] .",
    "this forcing method is therefore thermodynamically consistent .",
    "it also recovers the analytical phase diagram , as shown in figure [ figguo ] .",
    "we also examined the behavior of the forcing method in the limit where @xmath159 .",
    "this limit may appear tricky because the correction terms need to cancel the numerical derivatives we uncovered in the expansion .",
    "this should uncover any higher order terms that we missed in our expansion .",
    "we find , however , that the method described here will even recover the sharp interfaces we observed for the pressure method .",
    "the non - uniqueness of the solutions which we found for the pressure method is also observed for the pressure method .",
    "the recovery of a unique solution for larger values of @xmath97 occurs at the same pace as for the pressure method .",
    "this is shown in figure [ figcomp ] .",
    "this surprising result is due to the fact that the pressure @xmath13 is exactly constant for both methods .    ) .",
    "we observe that the agreement with the phase - diagram is improved using the correction terms from @xcite .",
    "for the new forcing method the results would be indeterminate just at the results of the pressure method in figure [ fig1 ] .",
    "however , including gradient terms of ( [ vdw_int ] ) with @xmath98 we recover thermodynamic consistency . ]",
    "in this paper we have shown that forcing terms lead to non - negligible higher order terms for systems with large density gradients .",
    "we introduced a new equilibrium analysis method , that allowed us to identify correction terms up to 5th order .",
    "this equilibrium analysis allowed us to identified those correction terms .",
    "this analysis analysis gave the exact pressure for systems that are not advected with respect to the lattice .",
    "correction terms similar to , but different from , the correction terms we identified have been proposed by guo _",
    ". _ @xcite .",
    "their analysis leads them to conclude that for a body force we should choose ( in the notation of this paper ) @xmath160 comparing this to ( [ forcing2 ] ) we find that this term is different in that we predict a factor of @xmath161 instead of @xmath162 as well as an additional double derivative term of @xmath1 . the correction term ( [ eqnguo ] ) was derived using a multi - scale analysis to second order .",
    "we did not understand how these terms could be consistently derived with a second order expansion . in a taylor expansion",
    "the term @xmath163 appears only as a third order term .",
    "it is likely that a second order expansion would not pick up the @xmath164 term .",
    "if this expansion can pick up the @xmath165 term in @xmath53 consistently , however , there can not be a difference in the pre - factor of this term when it is derived by a taylor expansion method .",
    "it is therefore important to compare the correction term predicted in @xcite to our correction term @xmath53 of ( [ forcing2 ] ) .",
    "we implemented the correction term ( [ eqnguo ] ) .",
    "we then performed simulations with pressure ( [ vdw ] ) which does not include interfacial terms .",
    "we would therefore expect a sharp interface .",
    "we do , however , observe that this method leads to an extended interface , indicating that there are additional gradient terms in the pressure not accounted for by the navier - stokes equation derived by guo _",
    "* equation ( 18b ) ) .",
    "we also measured the phase - diagram for the original forcing method , the corrections proposed by guo and the new forcing method .",
    "the results are shown in figure [ figguo ] .",
    "we see that the correction introduced by guo _",
    "_ improves the result for the forcing method somewhat .",
    "however , there is still no good agreement with the theoretical phase diagram .",
    "this is , however , achieved by the correction derived in this paper when we include additional gradient terms in the pressure tensor ( [ vdw_int ] ) .",
    "this suggests that the prefactor derived in the current work is correct .    there is a longstanding discussion about the suitability of pressure methods for the simulation of non - ideal fluids @xcite .",
    "the criticism relies on the general argument that there should be a close correspondence between the lattice boltzmann equation and kinetic theory . at this level",
    "it is a somewhat philosophical argument . and",
    "this philosophical argument is weakened by the occurrence of lattice correction terms that have no analogy in kinetic theory .",
    "a more useful test should be the ability of the forcing and pressure methods to recover correct solutions in a robust and stable manner .",
    "as far as the recovery of equilibrium solutions is concerned , we find that there is no fundamental difference in the suitability of including non - linear pressure terms into a lattice boltzmann method through a forcing term or a pressure term .    as a next step in this analysis",
    "we need to compare the performance of the different methods under galilean transformations .",
    "to uncover any term that have not been previously discussed @xcite requires us to drop the assumption of small velocities in our 5th order expansion .",
    "those results will be published elsewhere .    to truly distinguish between the two approaches , however , the analysis of dynamic solutions is required .",
    "there are very few tests in the literature of non - stationary solution for liquid - gas lattice boltzmann simulations .",
    "but such tests will be required to compare the differences between pressure and forcing approaches .",
    "examples of such simulations include advected fluids undergoing phase - separations . for density small compared to the equilibrium",
    "densities analytical solutions exist for @xmath166 .    in closing",
    "we want to point out that the corrections for the forcing method for phase - separated systems do also apply for external forces .",
    "the same additional pressure terms that we identified in ( [ peff ] ) also occur when a truly external force acts on the system .",
    "this is particularly important to keep in mind when simulating liquid - gas systems in the presence of gravity .",
    "gunstensen , d.h .",
    "rothman , s. zaleski , and g. zanetti , _ phys .",
    "a _ * 43 * , 4320 ( 1991 ) .",
    "x. shan , h. chen , _ phys .",
    "e _ * 49 * , 2941 ( 1994 ) m.r .",
    "swift , e. orlandini , w.r .",
    "osborn , and j.m .",
    "yeomans , _ phys .",
    "e _ * 54 * 5041 ( 1996 ) .",
    "y. chen , s. teng , t. shukawa , and h. ohashi , _ int .",
    "phys . _ * 9 * , 1383 ( 1998 ) .",
    "most textbooks on thermodynamics , _",
    "e.g. _ h.b .",
    "callen , thermodynamics and an introduction to thermostatistics , wiley ( 1985 ) .",
    "shan , and g.d .",
    "doolen , _ phys .",
    "e _ * 57 * , r13 ( 1998 ) .",
    "x. he and g.d .",
    "doolen , _ j. stat .",
    "phys . _ * 107 * , 309 ( 2002 ) .",
    "holdych , d. rovas , j.g .",
    "georgiadis , r.o .",
    "buckius , _ int . j. of mod .",
    "c _ * 9 * , 1393 ( 1998 ) .",
    "luo , _ phys",
    "* 81 * , 1618 ( 1998 ) .",
    "wagner , theory and application of the boltzmann method , d. phil .",
    "thesis , oxford university ( 1997 ) .",
    "a.j . wagner and j.m .",
    "yeomans , _ int .",
    "c. _ * 9 * , 1373 ( 1998 ) .",
    "wagner and q. li , _ physica a _ * 362 * , 105 ( 2005 ) .",
    "t. inamuro , n. konishi , f. ogino , _ comp .",
    "comm . _ * 129 * , 32 ( 2000 ) .",
    "kalarakis , v.n .",
    "burganos , a.c .",
    "payatakes , _ phys",
    "e _ * 65 * , 056702 ( 2002 ) .",
    "z. guo , c. zheng , and b. shi , _ phys .",
    "e _ * 65 * , 046308 ( 2002 ) ."
  ],
  "abstract_text": [
    "<S> lattice boltzmann simulations have been very successful in simulating liquid - gas and other multi - phase fluid systems . </S>",
    "<S> however , the underlying second order analysis of the equation of motion has long been known to be insufficient to consistently derive the fourth order terms that are necessary to represent an extended interface . </S>",
    "<S> these same terms are also responsible for thermodynamic consistency , i.e. to obtain a true equilibrium solution with both a constant chemical potential and a constant pressure . in this article </S>",
    "<S> we present an equilibrium analysis of non - ideal lattice boltzmann methods of sufficient order to identify those higher order terms that lead to a lack of thermodynamic consistency . </S>",
    "<S> we then introduce a thermodynamically consistent forcing method . </S>"
  ]
}