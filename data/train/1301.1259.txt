{
  "article_text": [
    "the subject of exchangeability is prevalent in probability theory ( see e.g. @xcite , chapters @xmath0@xmath1 in @xcite , or @xcite , @xcite and @xcite for recent overviews and results ) and the goal of this paper is to study another notion of exchangeability that is motivated by spin glass models and , in particular , by the work of mzard and parisi on diluted models , @xcite .",
    "we begin by considering an array @xmath2 of random variables @xmath3 indexed by @xmath4 for some integer @xmath5 , whose distribution is invariant under certain rearrangements of the indices .",
    "we will think of @xmath6 as the set of leaves of a rooted tree ( see fig .",
    "[ fig1 ] ) with the vertex set @xmath7 where @xmath8 , @xmath9 is the root of the tree and each vertex @xmath10 for @xmath11 has children @xmath12 for all @xmath13 .",
    "each vertex @xmath14 is connected to the root @xmath9 by the path @xmath15 we will denote the set of vertices in this path by @xmath16 we will consider rearrangements of @xmath6 that preserve the structure of the tree @xmath17 , in the sense that they preserve the parent - child relationship .",
    "more specifically , we define by @xmath18 the number of common vertices in the paths from the root @xmath9 to the vertices @xmath14 and @xmath19 , and consider the following group of maps on @xmath6 , @xmath20 any such map can be extended to the entire tree @xmath17 in a natural way : let @xmath21 and @xmath22 because of the condition @xmath23 in ( [ seth ] ) , this definition does not depend on the coordinates @xmath24 , so the extension is well - defined .",
    "it is clear that the extension preserves the parent - child relationship . for each @xmath25",
    ", it follows that @xmath26 for some bijection @xmath27 . in other words , the condition @xmath23 means that we can visualize the map @xmath28 as a recursive procedure , in which children @xmath29 of the vertex @xmath30 are rearranged among themselves for each @xmath14 .",
    "note that @xmath31 is simply the group of all permutations of @xmath32 .",
    "index set @xmath6 as the leaves of the infinitary tree @xmath17.,scaledwidth=84.0% ]    we will say that an array of random variables @xmath2 taking values in a standard borel space @xmath33 ( i.e. borel - isomorphic to a borel subset of a polish space ) is _ hierarchically exchangeable _ , or _",
    "@xmath34-exchangeable _ , if @xmath35 for all @xmath36 . throughout the paper",
    ", we will view any array of random variables as a random element in the product space , so the equality in distribution is always in the sense of equality of the finite dimensional distributions .",
    "because of this , one can replace the condition in ( [ seth ] ) that @xmath28 is a bijection by the condition that @xmath28 is simply an injection , since any injection viewed on finitely many elements can be , obviously , extended to a bijection preserving the property @xmath23 .",
    "the case of @xmath37 corresponds to the classical notion of an exchangeable sequence , and in the general case of @xmath5 we will prove the following analogue of de finetti s classical theorem .",
    "one natural example of an @xmath34-exchangeable array is given by ( recall the notation in ( [ pathtoleaf ] ) ) @xmath38 where @xmath39^{r+1 } \\to a$ ] is a measurable function , and @xmath40 for @xmath41 are i.i.d .",
    "random variables with the uniform distribution on @xmath42 $ ] .",
    "the reason this array is hierarchically exchangeable is because , by the definition of @xmath28 , the random variables @xmath43 for @xmath44 are also i.i.d . and uniform on @xmath42 $ ] , @xmath45 and @xmath46 we will show the following .    [ th1 ] any hierarchically exchangeable array @xmath2 can be generated in distribution as in ( [ sigmadf ] ) for some measurable function @xmath47 .",
    "this result is not very difficult to prove , and one can give several different arguments .",
    "we will describe an approach that will be a natural first step toward the general case of processes indexed by several trees or , more specifically , by product sets of the form @xmath48 for any integers @xmath49 .",
    "recalling the definition ( [ seth ] ) , let us denote @xmath50 and for any @xmath51 and any @xmath52 , let us denote @xmath53 we will say that an array of random variables @xmath54 indexed by @xmath55 and taking values in a standard borel space @xmath33 is _ hierarchically exchangeable _ , or _",
    "@xmath34-exchangeable _ , if @xmath56 for all @xmath57 .",
    "let us denote @xmath58 and , for @xmath59 , denote @xmath60 then , again , the natural class of @xmath34-exchangeable arrays is those of the form @xmath61 for some measurable function @xmath62^{(r_1 + 1 ) + \\ldots + ( r_\\ell+1)}\\to a$ ] and a family of i.i.d .",
    "random variables @xmath63 indexed by @xmath64 with the uniform distribution on @xmath42 $ ] .",
    "[ th2 ] any hierarchically exchangeable array @xmath65 can be generated in distribution as in ( [ sigmadfmany ] ) for some measurable function @xmath47 .",
    "this general result was motivated by the following special case , when the array @xmath66 is indexed by @xmath4 and @xmath67 .",
    "the condition ( [ hexchdfmany ] ) now becomes @xmath68 for all @xmath36 and all bijections @xmath69 , and theorem [ th2 ] implies that any such array can be generated in distribution as @xmath70 where @xmath39^{2(r+1 ) } \\to{\\mathbb{r}}$ ] is a measurable function and all @xmath40 and @xmath71 for @xmath41 and @xmath72 are i.i.d .",
    "random variables with the uniform distribution on @xmath42 $ ] . this can be viewed as a hierarchical version of the classical _ aldous - hoover representation _",
    "( @xcite , @xcite , @xcite , @xcite ) , which corresponds to the case @xmath37 .",
    "one application of this representation can be found in @xcite , where it is explained how ( [ sigmaah ] ) is related to the predictions about the structure of the gibbs measure in diluted spin glass models that originate in the work of mzard and parisi @xcite .",
    "the main result in @xcite proves precisely the hierarchical exchangeability ( [ hexchah ] ) for the random variables @xmath73 that represent the magnetization of the @xmath74 spin inside the pure state @xmath14 , and the tree structure as above stems from the ultrametric organization of the pure states in the parisi ansatz , which was recently proved in @xcite . finally ,",
    "although this is not directly related to the results presented in this paper , an interested reader can find a study of another notion of exchangeability on ( infinite infinitary ) trees in section iii.13 in @xcite .",
    "* acknowledgement .",
    "* we would like to thank the referees for their careful review and a number of suggestions to improve the quality of the paper .",
    "it is well known that any standard borel space is borel - isomorphic to a borel subset of @xmath42 $ ] ( see e.g. section @xmath75 in @xcite ) , which means that it is enough to prove theorems [ th1 ] and [ th2 ] with random variables @xmath3 taking values in @xmath42 $ ] , which we will assume from now on .",
    "all the arrays that we will deal with will take values in the product space of countably many copies of @xmath42 $ ] , which is a compact space .",
    "for simplicity of notation , we will continue to denote all such spaces by @xmath33 .",
    "we will denote by @xmath76 the space of probability measures on @xmath33 equipped with the topology of weak convergence , which is also a compact space .",
    "if a sequence @xmath77 of @xmath33-valued random variables is such that the empirical distributions @xmath78 converge almost surely to some @xmath79-valued random variable , then we will call this limit the _ empirical measure _ of @xmath77 and denote it by @xmath80 .",
    "our key tool will be the following strong version of de finetti s theorem ( see proposition 1.4 , corollary 1.5 and corollary 1.6 from  @xcite ) .",
    "[ thm : defhs ] suppose @xmath77 is an exchangeable sequence of @xmath33-valued random variables",
    ". then the empirical measure @xmath80 exists almost surely and has the following properties :    * @xmath80 is almost surely a function of @xmath77 ; * given @xmath80 , the random variables @xmath81 are i.i.d . with the distribution @xmath80 ; * if @xmath82 is any other random variable on the same probability space such that @xmath83 then the sequence @xmath77 is conditionally independent from @xmath82 given @xmath80 .",
    "* proof of theorem [ th1 ] .",
    "* the proof will be by induction on @xmath5 . for each @xmath84 , by theorem  [ thm : defhs ] ,",
    "the empirical measures @xmath85 exist almost surely , because hierarchical exchangeability ( [ hexchdf ] ) implies that @xmath86 is exchangeable in the index @xmath87 for each fixed @xmath14 . moreover , hierarchical exchangeability together with theorem  [ thm : defhs ] imply the following :    1 .",
    "given @xmath3 for a fixed @xmath88 , the random variables @xmath89 , @xmath90 , are i.i.d .",
    "with the distribution @xmath3 .",
    "2 .   the random variables @xmath91 are conditionally independent given @xmath92 .",
    "this holds because for a chosen @xmath14 , the joint distribution of all the random variables is invariant if one permutes the sequence @xmath93 while leaving all @xmath94 fixed , and so ( iii ) of theorem 3 gives that the former are conditionally independent from the latter over @xmath3 .",
    "3 .   the empirical measures @xmath92 are hierarchically exchangeable , @xmath95    by the induction hypothesis , property ( c ) yields a representation @xmath96 by the properties ( a ) and ( b ) and the fact that @xmath33 is a borel space",
    ", there exists a measurable function @xmath97\\to a$ ] such that , conditionally on @xmath92 , @xmath98 where @xmath99 for @xmath100 are i.i.d .",
    "random variables uniform on @xmath42 $ ] , independent from everything else . in other words",
    ", we simply realize independent random variables @xmath89 from the distribution @xmath3 as functions of independent uniform random variables @xmath99 .",
    "( see , for instance , lemma 7.8 in  @xcite for a rather stronger result guaranteeing that this can be done . )",
    "combining ( [ indhyp ] ) and ( [ nolind ] ) implies @xmath101 with @xmath102 , which finishes the proof .",
    "theorem  [ th2 ] will be proved by induction on @xmath103 . of course , the case @xmath104 is already proved in the previous section . however , in order to close the induction , it will actually be convenient to focus on a more general result , describing @xmath34-exchangeable couplings between processes and @xmath105-fields , defined as follows .",
    "we will call an array of random variables @xmath106 taking values in some compact spaces _",
    "an @xmath105-field _ if all @xmath107 are independent and the distribution of @xmath107 depends only on the  distance of @xmath14 from the root \" , namely , all @xmath107 have the same distribution for @xmath108 for any given @xmath109 .",
    "we will consider a pair of processes @xmath110 where @xmath111 is an @xmath105-field , not necessarily independent of @xmath112 .",
    "we will assume that they are jointly hierarchically exchangeable in the sense that @xmath113 for all bijections @xmath114 in ( [ hmany ] ) extended in a natural way to the entire set @xmath115 , i.e. each coordinate @xmath116 is extended from @xmath117 to @xmath118 as in ( [ setha ] ) .",
    "for convenience of notation , given an array @xmath119 indexed by @xmath120 and a subset @xmath121 , we will denote @xmath122 .",
    "for example , @xmath123 .",
    "the following proposition is a generalization of theorem [ th2 ] .",
    "[ prop ] if ( [ hexchufield ] ) holds then there exists a measurable function @xmath124 such that , conditionally on the @xmath105-field @xmath106 , @xmath125 where @xmath126 are i.i.d .",
    "random variables uniform on @xmath42 $ ] , independent of @xmath127 .",
    "formally , this equality of distribution conditionally on @xmath106 means the following equality of distribution for larger families of random variables : @xmath128 we will generally avoid writing this out in full for the sake of lighter notation .    of course , ( [ propeq ] ) implies theorem [ th2 ] by considering an @xmath105-field @xmath111 independent of the process @xmath112 .",
    "proposition [ prop ] will be proved by induction on @xmath103 and , in the induction step , we will need to describe a conditional distribution of one array given another",
    ". we will be able to replace this second array with an @xmath105-field , and the independence built into the definition of @xmath105-fields will be well - suited for the induction argument .",
    "the induction argument does not work so well when the @xmath105-field in proposition [ prop ] is replaced by a general @xmath34-exchangeable array @xmath129 .",
    "however , such a generalization , described in theorem [ th4 ] below , will follow once we have proposition [ prop ] .    to describe the induction",
    ", it will be convenient to write members of @xmath130 in the form @xmath131 , where @xmath132 and @xmath133 , and also abbreviate @xmath134 we therefore write the pair of processes ( [ upair ] ) as @xmath135 to close the induction we will make three separate appeals to simpler cases of proposition  [ prop ] , and we subdivide the proof into stages accordingly .      for the first stage , it will also be convenient to introduce the notation , for each @xmath136 , @xmath137 which is an element of another compact space , say @xmath138 , where @xmath139 take values in @xmath140 for @xmath141 if we denote the subarray @xmath142 of our @xmath105-field consisting of the coordinates that do not appear in ( [ tildex ] ) , then in these terms our goal is to describe the joint distribution of @xmath143 and @xmath144 .",
    "first of all , notice that hierarchical exchangeability in ( [ hexchufield ] ) implies that the process @xmath143 is @xmath34-exchangeable .",
    "hence , similarly to the proof of theorem [ th1 ] , for each @xmath145 , the empirical measure @xmath146 exists almost surely and , by theorem  [ thm : defhs ] , we get :          another important observation is that , by the definition of @xmath105-field , for any @xmath148 , the random variables @xmath152 in ( [ tildex ] ) are i.i.d . for @xmath13 with some fixed distribution on @xmath153 and , therefore , the marginal of the empirical measure @xmath147 in ( [ tildeemp ] ) on @xmath153 is this fixed nonrandom measure . together with the property ( a ) this implies :      let us now consider an infinite subset @xmath155 such that @xmath156 is also infinite .",
    "even though our goal is to describe the joint distribution of @xmath157 and @xmath144 , because of the hierarchical exchangeability it is , obviously , sufficient to describe the joint distribution of @xmath158 this will be done in several steps , and we begin with the following lemma .",
    "we will suppose , without loss of generality , that @xmath159 .",
    "we will write @xmath160 for the conditional distribution of @xmath161 given @xmath162 .        * proof . *",
    "first of all , by property ( a ) , the empirical measure ( [ tildeemp ] ) satisfies @xmath167 which means that @xmath147 is almost surely a function of @xmath168 .",
    "therefore , @xmath169 using the properties ( b ) and ( c ) , this conditional distribution is equal to @xmath170 the same computation obviously also works without @xmath144 , and therefore @xmath171 this proves ( b ) .",
    "next , using the properties ( a ) and ( b ) , we can rewrite ( [ abcinter ] ) as ( recall that @xmath159 ) @xmath172 which proves that @xmath173 using ( [ tildeempi ] ) and property ( a ) , for any fixed @xmath148 , @xmath174 combining the last two equations proves ( a ) .",
    "the last claim follows from ( [ abcproof ] ) and property ( d ) above .",
    "now that we have utilized the exchangeability with respect to the permutations of the index @xmath87 , we will change the focus and make the dependence of all random variables on the index @xmath176 explicit . for each @xmath177 , let us denote @xmath178 and let us also denote @xmath179 with this notation , we can rewrite ( [ abc ] ) as @xmath180 we can also rewrite claims ( b ) and ( c ) in lemma [ lemabc ] as follows :      we will now make our first appeal to the inductive hypothesis of proposition  [ prop ] to describe the joint distribution of @xmath181 and @xmath144 .",
    "notice that @xmath184 in ( [ switch2 ] ) and some of the coordinates @xmath185 in @xmath144 in ( [ uminus ] ) are indexed by @xmath186 and @xmath177 , so we will combine them and introduce a new array @xmath187 such that @xmath188 slightly abusing notation , this definition can be written as @xmath189 and it is obvious that @xmath190 is again an @xmath105-field .",
    "let us also observe right away that , by property ( b@xmath191 ) , @xmath192 the following gives a description of the joint distribution of @xmath181 and @xmath144 .    conditionally on the @xmath105-field @xmath193 , @xmath194 for some measurable function @xmath195 of its coordinates , where @xmath63 are i.i.d .",
    "uniform random variables on @xmath42 $ ] indexed by @xmath175 .",
    "* this is a consequence of the fact that @xmath190 is an @xmath105-field , and the pair @xmath190 and @xmath196 is , clearly , a hierarchically exchangeable coupling satisfying ( [ hexchufield ] ) with @xmath197 replaced by @xmath198 . by the induction hypothesis , the claim follows .",
    "let us denote the array of random variables @xmath199 on the right hand side of ( [ induction1 ] ) by @xmath200 let us denote by @xmath201 the full map on the right hand side of the equation ( [ induction1 ] ) , which can be then written as @xmath202 since all our random variables take values in standard borel ( or even compact ) spaces , we can consider the regular conditional probability @xmath203 it is a standard fact in this case that if @xmath204 is the law of @xmath205 then , for @xmath204-almost all @xmath206 , @xmath207 now , using this conditional probability , let us couple the arrays @xmath182 in ( [ switch ] ) and @xmath208 conditionally independently given @xmath209 , @xmath210 this is a standard construction in probability , as well as in ergodic theory , where it is called a ` relatively independent joining ' : see , for instance , the third example in section 6.1 of glasner  @xcite .",
    "the triple @xmath211 is still hierarchically exchangeable , since this is true separately of both conditional distributions on the right hand side of ( [ join ] ) ( for a much more detailed explanation see lemma 2.3 in @xcite ) .",
    "having done this , we may henceforth regard all of these processes as defined on the same background probability space .",
    "* proof of lemma [ lemind2 ] .",
    "* by ( [ condprob2 ] ) , @xmath214 with probability one , so @xmath215 is almost surely a function of @xmath208 and @xmath190",
    ". therefore , @xmath216 by the construction ( [ join ] ) , @xmath182 and @xmath208 are conditionally independently given @xmath209 , so this conditional distribution is equal to @xmath217 , and ( [ abcswitchu ] ) finishes the proof .",
    "thus , we have replaced the conditioning on @xmath218 on the left hand side of ( [ abcswitch ] ) with conditioning on @xmath213 , and now we will do a similar substitution in each factor on the right hand side of ( [ abcswitch ] ) .",
    "recall the notation @xmath219 and @xmath220 in ( [ switch3 ] ) and , for each @xmath177 , let us denote @xmath221 notice that one factor on the right hand side of ( [ abcswitch ] ) is @xmath222 and we will now show the following .",
    "* proof . *",
    "first of all , the equation ( [ abcswitch ] ) implies that @xmath224 which can be seen by considering the probabilities of cylindrical sets that depend only on @xmath225 . using ( [ xitovu ] ) , we get @xmath226 we saw in the proof of lemma [ lemind2 ] that @xmath214 with probability one and , therefore , @xmath227 using this and the fact that , by ( [ uuplus ] ) , @xmath219 is also a function of @xmath228 , we obtain the following inclusion of @xmath47-algebras , @xmath229 the equality of conditional distributions in ( [ extreme ] ) given the two extreme @xmath47-algebras implies the equality to the conditional distribution given the middle @xmath47-algebra , and this finishes the proof .",
    "the preceding two lemmas allow us to rewrite ( [ abcswitch ] ) as @xmath230 in other words , conditionally on @xmath213 , the random variables @xmath231 are independent for all @xmath148 and @xmath232 , and for a fixed @xmath14 , have the same distribution , @xmath233 by the property ( c@xmath191@xmath191 ) above , @xmath234 is independent of @xmath235 , so our main concern now is to describe the conditional distribution of @xmath236 given @xmath237 @xmath238 and @xmath228 .",
    "lastly , we will use the induction hypothesis in proposition [ prop ] to describe the joint distribution of the processes @xmath240 and @xmath228 for a fixed @xmath177 , so these are indexed by @xmath241 .",
    "the process @xmath236 consists of the random variables @xmath242 indexed by @xmath243 we will view the triple @xmath244 as a new @xmath105-field that consists of the random variables @xmath245 indexed by @xmath186 . here",
    ", we relabeled the random variables by collecting all the coordinates of @xmath228 and @xmath238 that depend on a fixed @xmath246 by the property ( c@xmath191@xmath191 ) above , the array @xmath247 is again an @xmath105-field , and it is clear that it forms a hierarchically exchangeable coupling with the array @xmath236 .",
    "the induction hypothesis in proposition [ prop ] , now used with @xmath248 , implies the following .",
    "[ lemzeta ] there exists a measurable function @xmath124 such that , conditionally on @xmath249 , @xmath250 where @xmath251 is an array of i.i.d .",
    "random variables uniform on @xmath42 $ ] indexed by @xmath186 , independent of everything else .",
    "this allows us to finish the proof of proposition [ prop ] .",
    "first of all , let us notice that we can write @xmath252 combining lemma [ lemzeta ] with ( [ abcswitchvu ] ) , we proved that , conditionally on the arrays @xmath253 and @xmath190 , we can generate the random variables @xmath254 for @xmath255 in distribution by @xmath256 where , for each @xmath177 and @xmath232 , we used the random variables @xmath257 in place of an independent copy of @xmath258 in ( [ zetaw ] ) .",
    "first of all , @xmath259 if we recall the definition of the process @xmath190 in ( [ uuplus ] ) , we see that for @xmath148 , @xmath260 consists of two parts , @xmath261 and @xmath262 , and the first one can be combined with @xmath263 to give @xmath264 then , ( [ tauend ] ) can be rewritten as ( slightly abusing notation ) @xmath265 finally , note that we consider the random variables @xmath254 with the index @xmath232 , while all the random variables @xmath266 in ( [ switch2 ] ) were defined in terms of the random variables @xmath267 with the index @xmath268 , so now they are not viewed as a part of our @xmath105-field @xmath269 .",
    "therefore , by redefining the function @xmath124 , we can absorb the randomness of @xmath262 into @xmath270 to get @xmath271 this completes the induction step in proposition [ prop ] , and finishes the proof of theorem [ th2 ] .",
    "one can also now formulate a conditional version of theorem [ th2 ] as follows .",
    "examples of @xmath34-exchangeable pairs of processes can be constructed in the form @xmath272 for two measurable functions @xmath273 and independent @xmath105-fields @xmath183 and @xmath199 of uniform random variables on @xmath42 $ ] .",
    "* this follows by first applying theorem  [ th2 ] to represent @xmath277 then forming the coupling of the processes @xmath278 and @xmath183 conditionally independently over @xmath161 , and then applying proposition  [ prop ] to represent the joint distribution of @xmath182 .",
    "aldous , d. : more uses of exchangeability : representations of complex random structures .",
    "probability and mathematical genetics , 35 - 63 , london math .",
    "lecture note ser .",
    ", 378 , cambridge univ .",
    "press , cambridge ( 2010 )"
  ],
  "abstract_text": [
    "<S> we consider random arrays indexed by the leaves of an infinitary rooted tree of finite depth , with the distribution invariant under the rearrangements that preserve the tree structure . </S>",
    "<S> we call such arrays hierarchically exchangeable and prove that they satisfy an analogue of de finetti s theorem . </S>",
    "<S> we also prove a more general result for arrays indexed by several trees , which includes a hierarchical version of the aldous - hoover representation .    </S>",
    "<S> key words : exchangeability , spin glasses . + mathematics subject classification ( 2010 ) : 60g09 , 60k35 </S>"
  ]
}