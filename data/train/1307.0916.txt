{
  "article_text": [
    "in the field of astrophysics and planetary science , fluid dynamical processes play important roles on virtually all length and mass scales from galaxies to planets .",
    "the smoothed particle hydrodynamics ( sph ) method ( lucy 1977 ; gingold & monaghan 1977 ) is one of the most popular simulation methods to solve the motion of a fluid in astrophysical problems ( for reviews , see monaghan 1992 ; rosswog 2009 ; springel 2010 ) . in the sph method ,",
    "fluid elements are represented by hypothetical particles ( so - called sph particles ) .",
    "thus , the dynamical equations are written in the lagrangian form of hydrodynamical equations .",
    "compared to the grid - base methods , the sph method is suitable to problems in which inhomogeneities such as large empty regions and small dense core develop .",
    "furthermore , it is easy to incorporate various physical effects to the sph scheme , such as self - gravity , radiative cooling and chemical reactions . because of these advantages , various astrophysical problems , such as star formation",
    ", planetesimal collisions and galaxy formation , have been studied using the sph method .",
    "recently , however , it has been pointed out that the standard sph method has difficulties in dealing with hydrodynamical instabilities , such as kelvin - helmholtz instability ( khi ) or rayleigh - taylor instability ( rti ) ( e.g. , okamoto et al .",
    "2003 ; agertz et al . 2007 ;",
    "valcke et al .",
    "2010 ; mcnally et al .",
    "agertz et al .",
    "( 2007 ) has concluded that this difficulty is due to the requirement of the standard sph that the density must be continuous and differentiable .",
    "this requirement is not satisfied at contact discontinuities . as a result , at contact discontinuities , the pressure of the low - density side is overestimated and that of the high - density side is underestimated .",
    "thus , pressure is also overestimated at the low - density side of the contact discontinuity and  unphysical \" repulsive force appears .",
    "this unphysical repulsive force causes a surface tension effect which suppresses the growth of hydrodynamical instabilities .    to resolve this issue ,",
    "modifications of the standard sph method have been proposed .",
    "price ( 2008 ) introduced the artificial thermal conductivity term in the sph equation to smooth the thermal energy at the contact discontinuity ( price 2008 ; valdarnini 2012 ) .",
    "cha et al .",
    "( 2010 ) and murante et al .",
    "( 2011 ) showed that the godunov sph , originally developed by inutsuka ( 2002 ) , can describe hydrodynamical instabilities .",
    "however , the godunov scheme is difficult to extend to non - ideal eos , though methods exist ( e.g. , colella & glaz 1985 ) .",
    "read et al .",
    "( 2010 ) showed that khi takes place with the equation of motion of ritchie & thomas ( 2001 ) and with a kernel function which has larger number of neighbours .",
    "he & springel ( 2010 ) replaces the density estimate in the standard sph by a new density estimate with voronoi tessellation .",
    "abel ( 2011 ) used the relative pressure instead of the absolute value of the pressure in the equation of motion .",
    "however , this approach does not satisfy the conservation of momentum .",
    "garca - senz et al .",
    "( 2012 ) present a new formulation which is based on a tensor approach .",
    "saitoh & makino ( 2013 ) have proposed a new formulation of sph .",
    "they pointed out that the problematic requirement of the differentiability of the density arises from the formula used to estimate the volume element associated with a particle in the standard sph .",
    "the volume element used in the standard sph is @xmath0 , where @xmath1 , @xmath2 and @xmath3 are the volume element , the mass and the density of a particle @xmath4 , respectively .",
    "thus , by using an estimate of the volume element which is independent of the mass and density , we can avoid the necessity for the differentiability of the density .",
    "in particular , saitoh & makino ( 2013 ) used @xmath5 as the volume element , where @xmath6 is the internal energy and @xmath7 is the energy spatial density . as a result",
    ", their formulation does not require the differentiability of the density . in the case of the equation of state ( eos ) of ideal gas ,",
    "the pressure is proportional to the energy spatial density .",
    "thus , the requirement of the differentiability of the energy spatial density corresponds to the requirement of the differentiability of the pressure .",
    "their formulation does not introduce any physically non - existent term and does not break any conservation property .",
    "they showed that their new sph can handle hydrodynamical instabilities well .",
    "however , their new formulation can be applied only to ideal gas . in many astrophysical problems ,",
    "the eos is non - ideal . in this paper",
    ", we present an extension of their new sph to non - ideal eos .",
    "as is shown in saitoh & makino ( 2013 ) , we can choose an arbitrary basis for the volume element . thus , using a different choice of the estimate of the volume element , we can extend the new sph to non - ideal eos , without losing any advantages of saitoh & makino ( 2013 ) s formulation .",
    "this paper is organized as follows . in  2 , we present a brief overview of the formulation of saitoh & makino ( 2013 ) . then in  3 , our new formulation is described . in  4 ,",
    "the results of various test calculations with our new sph are shown .",
    "finally in  5 , we summarize this paper .",
    "let us consider the following set of equations that describes the motion of fluid : @xmath8 here , @xmath9 , @xmath10 , @xmath11 , @xmath12 and @xmath13 are density , velocity , pressure , specific internal energy and time , respectively .",
    "the pressure @xmath11 is given by eos , @xmath14 .    in the sph method ,",
    "a fluid is expressed by a number of sph particles .",
    "physical quantities at a point are approximated by the summation of the contributions of these particles .",
    "first , we approximate a function @xmath15 by the convolution with a kernel function @xmath16 : @xmath17 where @xmath18 is the position vector , @xmath19 is the kernel function and @xmath20 is the smoothing length",
    ". the kernel function must be differentiable for @xmath21 and have following two properties : @xmath22 we can use an arbitrary kernel function , as long as the above conditions are satisfied . throughout this paper",
    ", we use the cubic spline function proposed by monaghan & lattanzio ( 1985 ) .",
    "@xmath23 \\displaystyle \\frac{1}{4}\\left ( 2 - s \\right)^3 & \\left(1 \\leqq   s < 2\\right ) , \\\\[2ex ] 0 & \\left(2 \\leqq s\\right ) , \\\\",
    "\\end{array } \\right.\\end{aligned}\\ ] ] where @xmath24 , @xmath25 is number of dimensions and @xmath26 is the normalization constant that takes the value of @xmath27 in one- , two- and three - dimensional cases , respectively . note that the use of this cubic spline kernel for the derivative sometimes causes clustering of the sph particles . in order to avoid this clustering of the sph particles",
    ", we adopt a gradient of the kernel which has a triangular shape , as thomas & couchman ( 1992 ) did : @xmath28 \\displaystyle \\frac{3}{4}\\left ( 2 - s \\right)^2 & \\left(1 \\leqq   s < 2\\right ) , \\\\[2ex ] 0 & \\left(2 \\leqq s \\right ) . \\\\ \\end{array } \\right.\\end{aligned}\\ ] ] the essential solution is to adopt the kernels which do not show the pairing instability ( read et al . 2010 ; dehnen & aly 2012 ) .    in order to evaluate the value of the physical quantities at positions of particles , we need to discretize eq .",
    "( @xmath29 ) . by approximating the integral by summation over particles ,",
    "we obtain the following equation : @xmath30 where the subscript @xmath31 denotes particle index and @xmath32 is the value of @xmath15 of particle @xmath31 . in the formulation of saitoh & makino ( 2013 ) ,",
    "the volume element @xmath33 is replaced by @xmath34 , where @xmath35 is the internal energy and @xmath36 is the energy spatial density of the @xmath31-th particle .",
    "thus , @xmath37 can be written as follows : @xmath38 where @xmath39 . by substituting @xmath40 into @xmath41",
    ", we obtain @xmath42 from eq .",
    "( @xmath43 ) , the derivative of @xmath37 is given by @xmath44 now we first derive the equation of energy and then the equation of motion .    in order to derive the equation of energy , we need an expression of @xmath45 .",
    "we use the following relation : @xmath46 note that in the case of the ideal gas , the pressure is proportional to @xmath40 .",
    "thus , around the contact discontinuity , @xmath40 is differentiable . by applying eq .",
    "( @xmath47 ) to eq .",
    "( @xmath48 ) , we obtain @xmath49 where @xmath50 . here , the density @xmath3 is @xmath51 by applying eq .",
    "( @xmath52 ) and eq .",
    "( @xmath53 ) to eq .",
    "( @xmath54 ) , we can write the equation of energy as @xmath55 now we define the change in the internal energy of the @xmath4-th particle due to the interaction with the @xmath31-th particle as @xmath56 . from eq .",
    "( @xmath57 ) , we obtain @xmath58    from the equation of energy , we derive the equation of motion .",
    "the change of the internal energy is the same as that of the kinetic energy with an opposite sign ; @xmath59 where @xmath60 and @xmath61 are the kinetic energy of the @xmath4-th and @xmath31-th particle , respectively .",
    "here we consider the change of @xmath60 due to the interaction with the @xmath31-th particle only . from eq .",
    "( @xmath62 ) , the left hand side of eq .",
    "( @xmath63 ) can be written as @xmath64 here , @xmath65 is @xmath66 thus , the change of the kinetic energy can be written as @xmath67 since the total momentum of two particles is conserved , we have @xmath68 thus , the first term of the right hand side of eq .",
    "( @xmath69 ) is zero . by substituting eqs .",
    "( @xmath70 ) and ( @xmath69 ) into eq .",
    "( @xmath63 ) , we obtain @xmath71 by using eq .",
    "( @xmath72 ) , we can eliminate @xmath73 in eq .",
    "( @xmath74 ) and we finally obtain @xmath75 note that for the case of a variable kernel size , @xmath76 must take symmetrical form in the smoothing length to satisfy the conservation of energy and momentum",
    ". this condition is achieved by replacing @xmath76 with @xmath77 / 2 $ ] or @xmath78 $ ] . throughout this paper ,",
    "we adopt the former form .",
    "hopkins ( 2013 ) and saitoh & makino ( 2013 ) have derived the equation of motion from a lagrangian .",
    "the advantage of this derivation is that it includes the variation of @xmath20 naturally .",
    "this term , so - called the  @xmath79 \" term , is important in simulations in which extremely strong shocks present ( see section 3.5 in saitoh & makino , 2013 ) .",
    "in the previous section , we summarized the formulation of saitoh & makino ( 2013 ) .",
    "as stated above , the formulation of saitoh & makino ( 2013 ) has one assumption that the pressure is proportional to the energy spatial density . in this section ,",
    "we extend their new sph to an arbitrary eos . in order to construct a new sph formulation ,",
    "we introduce the following quantity : @xmath80 in our formulation , we use the following new volume element : @xmath81 by substituting eq . @xmath82 into eq .",
    "@xmath83 , we obtain the following two equations : @xmath84 by substituting @xmath11 into @xmath41 in eq .",
    "( @xmath85 ) , we obtain the smoothed pressure @xmath11 , @xmath86    we first derive the equation of energy , and then we derive the equation of motion , following the derivation of saitoh & makino ( 2013 ) .      in order to derive the equation of energy , we need the expression of @xmath45 in our new sph . here",
    ", we use following relation : @xmath87 which can be obtained by replacing @xmath40 in eq . @xmath88 by @xmath11 .",
    "thus , the expression of @xmath45 is @xmath89 in our new sph , the density @xmath3 can be expressed as @xmath90 by applying eqs .",
    "( @xmath91 ) and ( @xmath92 ) to eq .",
    "( @xmath54 ) , the equation of energy can be written as @xmath93 hence the equation corresponding to eq .",
    "@xmath94 is @xmath95      from the equation of energy , we derive the equation of motion . by using eq .",
    "( @xmath96 ) instead of eq .",
    "( @xmath62 ) , we obtain the analogue of eq .",
    "( @xmath74 ) : @xmath97 thus the equation of motion becomes @xmath98      in the previous section , we derived the equation of energy and the equation of motion .",
    "these equations determine the evolution of fluid .",
    "however , in order to actually perform the numerical integration , we need to determine new values of pressure , by solving implicit equation , eq .",
    "( @xmath100 ) , for a given position @xmath101 and specific internal energy @xmath102 .",
    "we solve eq .",
    "( @xmath100 ) by iteration . here",
    "we summarize the actual procedure . +",
    "* step1 * : we calculate the density using eq .",
    "( @xmath92 ) . + * step2 * : from the eos , density and internal energy , we obtain the non - smoothed pressure @xmath103 . + * step3 * : we update @xmath104 from the equation @xmath105 . + * step4 * : we calculate @xmath11 by using eq .",
    "( @xmath100 ) . if necessary , we go back to step1 .",
    "+ unless otherwise noted , only one cycle of the above iteration is applied .",
    "we calculate the initial guess of @xmath104 by integrating the time derivative of @xmath99 .",
    "it is given by @xmath106 from the continuity equation , eq .",
    "( @xmath107 ) , and @xmath108 , we obtain @xmath109 by substituting eqs .",
    "( @xmath110 ) and ( @xmath111 ) into eq .",
    "( @xmath112 ) , we obtain @xmath113 where @xmath114    when eq .",
    "( @xmath100 ) is satisfied , we should have @xmath115 .",
    "if we express this as equation for specific internal energy @xmath102 , we have @xmath116 , where @xmath117 comes from the eos .",
    "therefore , the quantity @xmath118 gives the accuracy at which eq .",
    "( @xmath100 ) is satisfied , where @xmath119 is the total number of the sph particles and @xmath120      the smoothing length is the effective length of the kernel function . in general , individual and time - varying smoothing length",
    "are used . in this paper , we use the following equation to determine @xmath121 : @xmath122 unless otherwise specified , we set the parameter @xmath123 .      as stated above",
    ", we derived the equation of motion and equation of energy of our new sph from the fundamental equations of fluid .",
    "however , as springel & hernquist ( 2002 ) did , the equations for the sph method can be also derived from the lagrangian . recently",
    ", hopkins ( 2013 ) derived the equation of motion for saitoh & makino ( 2013 ) s new sph from the lagrangian . in this section",
    ", we derive the equation of motion for our new sph from the lagrangian and show the corresponding expression of @xmath79 term for our new sph .    here",
    "we consider the euler - lagrange equation : @xmath124 where @xmath125 , @xmath126 and @xmath127 are lagrangian , lagrange multipliers and appropriate constraints , respectively .",
    "according to hopkins ( 2013 ) , we use the following constraint equation : @xmath128 where @xmath129 is the kernel - support radius .",
    "this constraint equation gives a condition that there are an approximately constant number of particle in the kernel for three dimensions , if the mass of each sph particle is equal .",
    "the lagrangian can be written as follows : @xmath130 where @xmath131 . by substituting eqs .",
    "( [ eq : phi ] ) and ( [ eq : l ] ) into eq .",
    "( [ eq : el ] ) , we obtain @xmath132 equations .",
    "let us consider the second half of the above @xmath132 equations . by substituting @xmath121 into @xmath133 , the right - hand side of the euler - lagrange equation becomes @xmath134 , \\nonumber \\\\",
    "& = & \\lambda_i \\frac{4 \\pi h^3 h_i^2}{\\delta v_i } \\left(1 - \\frac{h_i}{3 \\delta v_i } \\frac{\\partial \\delta v_i}{\\partial h_i}\\right ) \\label{eq : rhs}.\\end{aligned}\\ ] ] the left - hand side becomes @xmath135 note that here we used the following relation from the first law of thermodynamics : @xmath136 from eqs .",
    "( [ eq : rhs ] ) and ( [ eq : lhs ] ) , we obtain the lagrangian multipliers as follows : @xmath137    by substituting the positions of sph particles into @xmath133 in eqs .",
    "( [ eq : el ] ) and ( [ eq : lambda ] ) , we obtain equation of motion : @xmath138    here we recall that in our new sph , the volume element @xmath1 is estimated as @xmath139 .",
    "thus we obtain following equations : @xmath140",
    "\\label{eq : nabla_dv},\\end{aligned}\\ ] ] where @xmath141 is kronecker s delta . by substituting eq .",
    "( [ eq : pp_ph ] ) into eq .",
    "( [ eq : lambda ] ) , we obtain @xmath126 : @xmath142 by substituting eqs .",
    "( [ eq : nabla_dv ] ) and ( [ eq : pf_lambda ] ) into eq .",
    "( @xmath143 ) , we obtain the equation of motion as follows : @xmath144 , \\label{eq : eom_h}\\end{aligned}\\ ] ] where @xmath145    in order to calculate the time evolution of the specific internal energy explicitly , we need the equation of energy . we derive the equation of energy with @xmath79 term as follows . from the first law of thermodynamics ,",
    "we obtain @xmath146 here , @xmath147 \\label{eq : deltav_dt1}.\\end{aligned}\\ ] ] from eq .",
    "( [ eq : phi ] ) , we obtain following equation : @xmath148 by substituting eq .",
    "( [ eq : dh_dt ] ) into eq .",
    "( [ eq : deltav_dt1 ] ) , @xmath149 \\label{eq : deltav_dt } , \\nonumber \\\\ & = & - \\frac{y_i}{p_i^2 } \\sum_j y_j \\boldsymbol{v}_{ij } \\cdot \\nabla w(\\boldsymbol{x}_{ij } ; h_i ) - \\frac{h_i}{3 p_i } \\frac{\\partial p_i}{\\partial h_i } \\frac{d \\delta v_i}{dt}.\\end{aligned}\\ ] ] from the above equation we obtain @xmath150 by substituting eq .",
    "( [ eq : deltav_dt2 ] ) into eq .",
    "( [ eq : du_dt ] ) , we obtain the equation of energy as follows : @xmath151 with the equation of energy , we can obtain the analogue to eq . @xmath152 as follows : @xmath153    note that here we discuss only the three - dimensional case .",
    "however , by using appropriate constraint , we can easily derive the expression of @xmath154 in one- or two - dimensional case as follows : @xmath155      we need to introduce artificial viscosity to handle shocks .",
    "there are several different forms of artificial viscosity ( e.g. , lattanzio & monaghan 1985 ; monaghan 1997 ) . in this paper",
    "we adopt the following form of the artificial viscosity proposed by monaghan ( 1997 ) .",
    "it is expressed as @xmath156 where @xmath157 0 & \\quad { \\rm otherwise } , \\end{array } \\right.\\\\ \\rho_{ij } & = & \\frac{1}{2}(\\rho_i + \\rho_j ) \\label{eq : rho_ij}.\\end{aligned}\\ ] ] note that the use of eq .",
    "( @xmath92 ) for the calculation of the artificial viscosity sometimes leads to unstable behaviour under strong shocks .",
    "it seems to be safer to use the smoothed density , @xmath158    in order to suppress the shear viscosity , we apply the balsara switch ( balsara 1995 ) .",
    "it is given by @xmath159 where @xmath160 is a small value introduced to prevent numerical overflow .",
    "in this paper we set @xmath161 . here",
    ", the rotation of velocity is given by @xmath162    consequently , the viscosity terms for the equation of motion and the equation of energy are given by @xmath163,\\\\ \\left ( \\frac{du_i}{dt } \\right)_{\\rm av } & = & \\frac{m_i}{2}\\sum_j m_j \\frac{1}{2}(f_i + f_j ) \\pi_{ij } \\boldsymbol{v}_{ij } \\cdot \\frac{1}{2 } \\left [ \\nabla w(\\boldsymbol{x}_{ij } ; h_i ) + \\nabla w(\\boldsymbol{x}_{ij } ; h_j ) \\right],\\end{aligned}\\ ] ] respectively .",
    "one might imagine that the use of the smoothed density in the artificial viscosity would be inconsistent with the formulation of our new sph .",
    "the artificial viscosity is , however , a mimic of the molecular dissipation , which is not included in the original set of equations for hydrodynamics .",
    "thus , the choice of the form of the artificial viscosity is independent from the formulation of the sph .",
    "the timesteps for integration are limited by the courant condition for numerical stability .",
    "the timesteps of the @xmath4-th particle @xmath164 is given by @xmath165 we use shared timestep and adopt @xmath166 as a time step of each step . throughout this paper , we adopt @xmath167 .",
    "in this section , we report the results of several 1d and 2d tests for non - ideal eos with the standard sph and our new sph . for both methods , we use the equations with @xmath79 term . note that our new sph method reduces to saitoh & makino ( 2013 ) s sph method , in the case of the ideal gas eos .",
    "we have confirmed that our new sph can reproduce the results of saitoh & makino ( 2013 ) well when we adopted the eos of the ideal gas .",
    "here , we only show the results for non - ideal eos .",
    "the shock tube test is one of the most common test problems .",
    "it is designed to test the ability of numerical method to capture the shock .",
    "we place the initial discontinuity at the origin of the coordinates .",
    "we place equal - mass particles .",
    "the particle separation varies according to the density distribution . in this section ,",
    "we introduce the result of 1d shock tube test for non - ideal gas , the tammann eos ( ivings et al .",
    "1998 ) , for which the exact solutions exist .",
    "this test was first performed by wu & shen ( 2008 ) .",
    "the tammann eos is suitable for liquid at high pressure .",
    "the initial conditions of this test are as follows : @xmath168 the tammann eos is given by @xmath169 where we set @xmath170 and @xmath171 .",
    "the parameter @xmath172 for the smoothing length was set to @xmath173 .",
    "( 70 mm , 50mm)figure1a.eps    ( 70 mm , 50mm)figure1b.eps     +    ( 70 mm , 50mm)figure1c.eps    ( 70 mm ,",
    "50mm)figure1d.eps    ( 70 mm , 50mm)figure2a.eps    ( 70 mm , 50mm)figure2b.eps     +    ( 70 mm , 50mm)figure2c.eps    ( 70 mm , 50mm)figure2d.eps    ( 70 mm , 50mm)figure3.eps    figure [ fig : pf_water ] shows the results of our new sph at time @xmath174 and figure [ fig : std_water ] shows those of the standard sph . at the contact discontinuity , @xmath175 , the standard sph produces a large pressure blip , whereas our new sph eliminates this blip .",
    "our new sph can handle the contact discontinuity much better , even for non - ideal gas .",
    "our new method produced somewhat larger overshooting at the front of the rarefaction wave . in this strong shock test , the pressure is initially strongly discontinuous , while the density is continuous . as a consequence , with our new sph , strong overshooting around",
    "the contact discontinuity appears in the first several time steps and remains there until the end of simulation .",
    "figure [ fig : water_energy_error ] shows the relative error of the specific internal energy for each particle as defined in eq .",
    "( [ eq : err2 ] ) . at the contact discontinuity , @xmath176",
    ", large errors can be seen .",
    "however , for any particle , the absolute value of the error is less than 0.01% .",
    "this test clearly shows the ability of a scheme to handle the contact discontinuity .",
    "the similar test has been performed by saitoh & makino ( 2013 ) with the ideal gas eos . in order to check the ability of our new sph to the non - ideal eos",
    ", we use the tillotson eos ( see below ) , instead of the ideal gas eos .",
    "we set a high - density region in a low - density ambient , at a pressure equilibrium .",
    "we use a 2d computational domain , @xmath177 and @xmath178 . in both directions ,",
    "the mirror boundary condition is imposed .",
    "the density is @xmath179 to express the above density distribution , we place equal - mass particles in a uniform grid .",
    "the number of particles in the dense square is 4225 and that in the ambient is 3007 , respectively .",
    "the end time is @xmath180 .",
    "since the system is in the hydrostatic equilibrium , particles should not move .",
    "the tillotson eos ( tillotson 1962 ; melosh 1989 ) is one of the most widely used eos for giant impact simulations ( e.g. , benz et al .",
    "1986 ; canup & asphaug 2001 ; genda et al .",
    "the tillotson eos contains 10 parameters , which we should choose to describe given material .",
    "the tillotson eos takes three different functional forms depending on the density @xmath9 and the specific internal energy @xmath12 .",
    "( a)condensed ( @xmath181 ) or cold state ( @xmath182 ) + in this region , the tillotson eos is given by the following form : @xmath183 where @xmath184 and @xmath185 .",
    "( b)expanded hot state ( @xmath186 and @xmath187 ) + in this region , the tillotson eos is given by the following form : @xmath188 \\exp\\left\\{- \\beta \\left ( \\frac{1}{\\eta } - 1\\right)^2 \\right\\}.\\end{aligned}\\ ] ]    ( c)intermediate region ( @xmath189 and @xmath186 ) + in this region , a smooth transition between above two states occurs .",
    "thus , as benz et al .",
    "( 1986 ) did , we interpolated the pressure by using @xmath190 and @xmath191 ; @xmath192 here , @xmath193 and @xmath194 are material parameters . in this paper , we use the values for granite : @xmath195 .",
    "we set the density unit @xmath196 , unit specific energy @xmath197 and unit pressure @xmath198 .",
    "( 30 mm , 30mm)figure4a.eps    ( 30 mm , 30mm)figure4b.eps    ( 30 mm , 30mm)figure4c.eps    ( 30 mm , 30mm)figure4d.eps    ( 30 mm , 30mm)figure4e.eps     +    ( 30 mm , 30mm)figure4f.eps    ( 30 mm , 30mm)figure4g.eps    ( 30 mm , 30mm)figure4h.eps    ( 30 mm , 30mm)figure4i.eps    ( 30 mm , 30mm)figure4j.eps     + ( 152.4 mm , 10.16mm)figure4k.eps    figure [ fig : sq ] shows the results of this tests for the standard sph and our new sph . the difference between two scheme is clear . with the standard sph , although the pressures of each particle are initially equal , the high - density domain becomes a circle at @xmath180 .",
    "the reason why such an unphysical transform occurs is explained saitoh & makino ( 2013 ) .    in contrast , with our new sph , the high - density domain keeps its original shape , except some local rearrangement near the boundary of two fluids .",
    "our new sph removes the unphysical surface tension completely , even for non - ideal gas .",
    "khi is one of the most fundamental test problems for the ability of numerical methods to handle hydrodynamical instability .",
    "initially , two layers in pressure equilibrium has the different density and move to opposite direction to each other .",
    "we perform the khi test for the tillotson eos .",
    "we use a 2d computational domain , @xmath199 and @xmath200 .",
    "the periodic boundary conditions are imposed in the @xmath201-direction and the mirror boundary condition is imposed in the @xmath202-direction .",
    "we set the density as follows : @xmath203 where @xmath204 and @xmath205 are the density of the low - density region and that of the high - density region , respectively .",
    "the shear velocity is set up in the @xmath201-direction .",
    "we set @xmath206 for the high density region and @xmath207 for the low density region , respectively . as a seed of the instability , small perturbation",
    "is added to the particles around the initial contact discontinuity : @xmath208 here , @xmath209 and @xmath210 are the amplitude and wavelength of the initial perturbation , respectively .",
    "we set @xmath211 and @xmath212 .",
    "thus , six vortex rolls are expected to be developed in the computational domain .",
    "the growth time scale of the khi is @xmath213 for our test case , @xmath214 . in each region",
    ", we place the equal - mass particles uniformly in a lattice . the particle separation in the low - density region",
    "is set to @xmath215 .",
    "the equilibrium pressure is set to @xmath216 .",
    "( 66 mm , 33mm)figure5a.eps    ( 66 mm , 33mm)figure5b.eps     +    ( 66 mm , 33mm)figure5c.eps    ( 66 mm , 33mm)figure5d.eps     + ( 152.4 mm , 10.16mm)figure5e.eps    ( 70 mm , 70mm)figure6a.eps    ( 70 mm , 70mm)figure6b.eps    ( 70 mm , 70mm)figure7.eps    ( 70 mm , 50mm)figure8.eps    figure @xmath217 shows the density distributions at times @xmath218 and @xmath219 .",
    "the upper row is the results of our new sph , and the lower row is those of the standard sph .",
    "there is an obvious difference between the two results and our new sph gives far better results compared to that of the standard sph . with the standard sph",
    ", perturbations grow until @xmath220 .",
    "however , the unphysical surface tension inhibits the growth of the vortex rolls .",
    "the dense fluid is stretched . as a consequence , the standard sph produces `` blobs '' of dense fluid ( see figure 7 in price 2008 ; figure 7 in saitoh & makino 2013 ) .",
    "the mixing between the two layers is completely suppressed .",
    "on the other hand , our new sph shows very good result . at @xmath221 , six vortex rolls are clearly visible .    figure @xmath222 shows the pressure distribution along @xmath202-axis at @xmath218 . the left panel shows the result of the standard sph while the right panel shows that of our new sph . with the standard sph",
    ", there is a large pressure jump at the contact interface , @xmath223 . with our new sph ,",
    "on the other hand , the pressure jump is much smaller .",
    "our new sph eliminated the unphysical surface tension , even for non - ideal gas .",
    "thus , the growth of the khi is not suppressed .",
    "figure @xmath224 shows the distribution of the error of specific internal energy for each particle as defined in eq .",
    "( @xmath225 ) .",
    "one iteration of the pressure summation loop is done . at the contact interface @xmath223",
    ", particles have larger errors . however , even the largest value , the error is about 1% .",
    "figure @xmath226 shows that the averaged of error of the specific internal energy , as defined in eq .",
    "( [ eq : err ] ) , decreases as the number of iterations of the pressure summation loop of our new sph increases . for all cases ,",
    "the averaged error of the specific internal energy is less than 0.1% , and the error becomes smaller by a factor of two after each iteration .",
    "in real fluid , mixing takes place due to the physical dissipation , namely , the random motion of molecules .",
    "thus , if we had an infinite number of particle , the mixing would not take place at all and we could resolve infinitely small vortices , as far as we do not include any physical diffusion term . for the test of khi , however , our new sph produces somewhat noisy contact interface between two fluids .",
    "therefore , one might think that other schemes , such as the ac term , are better than our new sph .",
    "however , the noisy interface appears because we have finite number of particles and is at least partly due to the khi itself at high - wavenumber , which is physically there .",
    "thus , we argue that the noisy interface is not problematic .",
    "it is worth noting that , in the case of the jump in the chemical composition , the standard ac term is insufficient and it is necessary to introduce artificial chemical diffusion term .",
    "our scheme can handle any kind of discontinuity without any diffusion term .",
    "of course , to express the fluid mixing in the sub - resolution scale appropriately , we should introduce the turbulent diffusion term ( wadsley et al .",
    "2008 ) .",
    "the sph method is a powerful numerical tool for astrophysical and planetlogical problems .",
    "however , due to the requirement of the differentiability of density , the standard sph has a problem in describing multi - phase flows and mixing . in this paper",
    ", we describe an alternative formulation of sph in which the pressure is used as the basis of the smoothing instead of the density . in our formulation",
    ", we do not assume the differentiability of the density , but assume that of the pressure .",
    "as a result , our new formulation shows great improvement in the treatment of contact discontinuity and hydrodynamical instabilities .",
    "our new sph can handle problems in which mixing takes place .",
    "our new sph is natural extension of that of saitoh & makino ( 2013 ) . with our new sph , the shock tube , the hydrostatic equilibrium test and the khi test show good results for non - ideal gas .",
    "it is easy and straightforward to modify existing sph to our new method .",
    "in addition , our new sph does not introduce any additional dissipation term and does not break conservation properties .",
    "the increase of the calculation cost is small .      one important application of our new sph is the giant impact simulations , where the instabilities and mixing at the boundaries of different materials might play important roles in .",
    "we are currently working to apply our new sph to the giant impact simulations .",
    "the results will be reported in the forthcoming paper .",
    "of course , our new sph can be applied to a variety other astrophysical and planetlogical problems .",
    "the authors thank the anonymous referees for giving us helpful comments on the manuscript .",
    "this work is supported by a grant for the global coe program ,  from the earth to  earths\" , mext , japan .",
    "it was also supported in part by a grant - in - aid for scientific research ( 21244020 ) and strategic programs for innovative research of the ministry of education , culture , sports , science and technology ( spire ) ."
  ],
  "abstract_text": [
    "<S> the smoothed particle hydrodynamics ( sph ) method is a useful numerical tool for the study of a variety of astrophysical and planetlogical problems . however , it turned out that the standard sph algorithm has problems in dealing with hydrodynamical instabilities . </S>",
    "<S> this problem is due to the assumption that the local density distribution is differentiable . in order to solve this problem , a new sph formulation , which does not require the differentiability of the density , </S>",
    "<S> have been proposed . </S>",
    "<S> this new sph method improved the treatment of hydrodynamical instabilities . </S>",
    "<S> this method , however , is applicable only to the equation of state ( eos ) of the ideal gas . in this paper </S>",
    "<S> , we describe how to extend the new sph method to non - ideal eos . </S>",
    "<S> we present the results of various standard numerical tests for non - ideal eos . </S>",
    "<S> our new method works well for non - ideal eos . </S>",
    "<S> we conclude that our new sph can handle hydrodynamical instabilities for an arbitrary eos and that it is an attractive alternative to the standard sph . </S>"
  ]
}