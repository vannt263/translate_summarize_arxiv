{
  "article_text": [
    "the floor layout problem ( flp ) , also known as the ( unequal areas ) facility layout problem , is central to the design of objects such as factory floors and very - large - scale integration ( vlsi ) computer - chips .",
    "the designer is given a fixed rectangular floor and @xmath0 rectangular boxes to place onto the floor .",
    "each box must sit completely on the floor , and they can not overlap .",
    "each box has a fixed area , but the widths and heights can be varied to change the shape , subject to constraints on the area and aspect ratio of the components .",
    "the objective is to minimize the weighted sum of the manhattan norm distances between each pair of boxes .",
    "the flp can be naturally described as a disjunctive programming problem , which are often reformulated as mixed - integer programming ( mip ) problem such as to take advantage of state - of - the - art mip solvers . however , the flp and its various mip formulations have proven extremely difficult to solve to optimality . in this work , we take a systematic approach to generating mip formulations for the flp that unifies existing mip formulations from the literature and leads to new formulations and valid inequalities .",
    "we also computationally compare the range of formulations , and show that the new approaches can be used to solve previously unsolved instances .",
    "the main contributions of this work include :    1 .",
    "* case study on systematic construction of effective mip formulations : * the number , heterogeneity , and complexity of existing mip formulations for the flp and the fact that it remains computationally challenging make it an excellent candidate for such a study . through the use of the _ embedding formulation _ approaches of @xcite and @xcite and through a systematic treatment of alternative disjunctive descriptions of the flp",
    ", we are able to recover and unify all existing , seemingly ad - hoc , mip formulations . in addition",
    ", we are able to derive new formulations that can provide a significant computational advantage and solve previously unsolved instances .",
    "while the study concentrates on specific characteristics of the flp , it exemplifies generic formulation techniques and practices that should be useful for a wide range of problems . 2 .   * valid inequalities for alternative formulations of the flp : * using the embedding approach , we are able to construct a variety of new valid inequalities for flp .",
    "one key of the embedding formulation approach of this work is the flexible use of @xmath1 variables to model disjunctive constraints or unions of polyhedra .",
    "however , such flexibility can cloud the `` interprebility '' of the @xmath1 variables , which is often needed to construct valid inequalities to strengthen formulations . in this work ,",
    "we show how ideas from @xcite can be used to translate valid inequalities between formulations of the flp that allows us to state a broad class of valid inequalities in a generic form .",
    "* comprehensive computational study of flp : * while the flp has been extensively studied , most existing works compare only a small subset of formulations and valid inequalities when making comparison . in this work",
    "we collect several instances from the literature to construct a publicly available library and present a comprehensive computational study of existing and new formulations on this library .",
    "furthermore , our systematic approach allows us to compare a host of formulations and a wide range of common valid inequalities when making our comparison . in particular , while no single formulation seems to be dominant , we may offer a small collection of techniques which prove particularly effective for the flp .",
    "furthermore , we also study various theoretical and practical aspects of these approaches that help explain their success .",
    "the remainder of this work is organized as follows . in section",
    "[ sec : lit ] we present a literature review of the existing solution techniques for the flp . in section  [ sec : def ] we formally define the flp and show how it can be cast as a disjunctive programming problem . in section  [ sec : formulations ] we review the formulation techniques we use to transform the flp into a mip , and in section  [ sec : twobox ] we use the techniques to construct formulations that are based on the interaction of two boxes at a time .",
    "then in section  [ sec : inequalities ] we develop valid inequalities that can be used to strengthen formulations and show how they can be translated from one formulation to the other . in section  [ sec : inequalities ] we also restrict attention to the interaction of two boxes at a time , so in section  [ sec : multibox ] we develop formulations and inequalities that are based on the interaction of larger collections of boxes .",
    "finally , in section  [ sec : computations ] we present results of our computational experiments , and in section  [ sec : conclusions ] we present a brief summary of this work . complementary material and",
    "omitted proofs are included in the appendix .",
    "the floor layout problem can be viewed as a specific version of a general layout problem that consists of orthogonally packing rectangular pieces onto a rectangular floor ; @xcite offer a taxonomy of variations of the flp and its relatives .",
    "originally studied primarily in the context of factory design , the emergence of the field of very - large scale integration ( vlsi ) computer - chip design saw renewed interest in layout problems such as the flp .    broadly , algorithmic approaches to these layout problems",
    "can be grouped into two classes : exact and heuristic .",
    "exact algorithms were predominant in the earlier literature , although the boom of applications in computer - chip design require solving large scale instances beyond the reach of existing exact approaches . as a result , a bevy of work has appeared over the past three decades , proposing heuristic approaches to produce good solutions for large - scale instances .",
    "much of the work applies existing metaheuristic frameworks to the flp , for example @xcite and @xcite .",
    "contrastingly , many of the novel heuristics for the flp take advantage of ideas and machinery from mathematical programming : e.g. @xcite , and @xcite , albeit in a way that can not prove optimality .",
    "we note in particular the surveys of @xcite and @xcite , which collect pointers to much of the heuristic literature .    in keeping with the mip approach taken in this paper , we will survey the existing exact methods for the flp in detail .",
    "early work can be traced back to @xcite , who studies a discretized version of the flp .",
    "@xcite introduced a natural mip model for the flp , along with a collection of valid inequalities and techniques to help reduce solution time .",
    "@xcite introduces novel formulations for a single pair of boxes , as well as useful computational techniques such as symmetry breaking constraints and branching priorities .",
    "@xcite presents a new mip formulation for the flp with fewer binary variables , alongside a number of additional formulations and approaches inspired by nonlinear and mixed - integer nonlinear optimization .",
    "@xcite presents another formulation inspired by a technique from @xcite that reduces redundancy in the solution set . as detailed in the following section , the inclusion of certain non - linear area constraints in the flp result on its formulations being second - order - cone mip ( soc - mip ) problems",
    "given that early formulations were developed before the availability of efficient soc - mip solvers , careful attention has been paid on constructing and proving desirable properties for specific linear approximations for the nonlinear area constraints in @xcite and @xcite .",
    "the flp has a natural one - dimensional analogue in the single - row floor ( facility ) layout problem , which asks for an optimal layout of @xmath0 boxes of fixed length in a straight line .",
    "this problem is already np - hard , and strong formulations and cutting planes have been developed for the problem by @xcite and @xcite .",
    "an intriguing line of research has investigated the flp from the dual perspective , attempting to construct tight lower bounds .",
    "this is of particular interest for the flp , where relaxations typically give poor bounds , even with strengthening valid inequalities .",
    "@xcite presents a lower bounding technique for the single - row flp .",
    "another line of work investigates using semidefinite programming formulations to construct bounds for the flp by @xcite and the single - row flp by @xcite .",
    "@xcite leverage the semidefinite approach to produce optimal solutions for the single - row flp using a cutting - plane approach , and to produce high - quality solutions for larger instances in @xcite .",
    "@xcite present a combinatorial dual bounding scheme for the flp and compare it against existing techniques .",
    "consider a rectangular floor @xmath2 \\times [ 0,l^y]$ ] for @xmath3 .",
    "there is a collection of @xmath0 boxes @xmath4 to place on the floor , each with a target area @xmath5 and maximum allowed aspect ratio @xmath6 .",
    "denote the set of all pairs with @xmath7 where @xmath8{\\mbox{\\normalfont\\tiny\\sffamily def}}}{=}}}\\{1,\\ldots , n\\}$ ] . with each pair of boxes @xmath9",
    ", there is an associated nonnegative unit communication cost @xmath10 .",
    "the floor layout problem then is to optimally lay out each box completely on the floor , such that the area and aspect ratio constraints are satisfied , and such that no two boxes overlap .",
    "natural decision variables for each box @xmath11 are the position of its center @xmath12 and the lengths in each direction @xmath13 . the objective function used is based on the so - called `` manhattan '' norm : @xmath14    most of the constraints described are simple to describe with linear or conic inequalities .",
    "for instance , @xmath11 lies completely on the floor iff @xmath15 the area constraints take the form @xmath16 which is second - order - cone - representable @xcite .",
    "the aspect ratio constraints take the form @xmath17 this can be represented with two linear constraints per box , but it can also be enforced on the flp merely through bounds on the widths of the boxes .    along with the area constraints , imposing the following bounds on the box widths is sufficient to impose the aspect ratio constraints :    [ eqn : bounds ] @xmath18{\\mbox{\\normalfont\\tiny\\sffamily def}}}{=}}}\\min\\left\\ { \\sqrt{\\alpha\\beta } , l^s \\right\\ } \\quad & \\forall s \\in \\{x , y\\ } , i \\in \\llbracket n \\rrbracket \\label{eqn : upperbound } \\\\",
    "\\ell^s_i & \\geq lb^s_i { \\mathrel{\\overset{\\makebox[0pt]{\\mbox{\\normalfont\\tiny\\sffamily def}}}{=}}}\\frac{\\beta}{ub^s_i } \\quad & \\forall s \\in \\{x , y\\ } , i \\in \\llbracket n \\rrbracket\\label{eqn : lowerbound}\\end{aligned}\\ ] ]    we note that , since @xmath19 , we have that @xmath20 for each @xmath21 and @xmath22 .",
    "the last remaining constraint for the flp requires that the boxes can not overlap on the floor .",
    "one natural way to formulate this is by requiring each pair @xmath11 and @xmath23 to be separated in either the @xmath24 direction or the @xmath25 direction ( or both ) .",
    "[ defn : precede ] we say that @xmath11 _ precedes _",
    "@xmath23 in direction @xmath26 ( denoted by @xmath27 ) if @xmath28    therefore , we can enforce the constraint that @xmath11 and @xmath23 do not overlap with the disjunctive constraint @xmath29{\\mbox{\\normalfont\\tiny\\sffamily def}}}{=}}}\\bigvee_{k=1}^4 d^k_{i , j}$ ] , where @xmath30 we omit the subscript and use @xmath31 when the meaning is clear from context and we refer to each @xmath32 as a _ branch _ of the disjunction .",
    "( left ) , @xmath33 ( center ) , and both @xmath34 and @xmath33 ( right).,title=\"fig : \" ]   ( left ) , @xmath33 ( center ) , and both @xmath34 and @xmath33 ( right).,title=\"fig : \" ]   ( left ) , @xmath33 ( center ) , and both @xmath34 and @xmath33 ( right).,title=\"fig : \" ]    then the set of all feasible layouts is given by the disjunctive set @xmath35{\\mbox{\\normalfont\\tiny\\sffamily def}}}{=}}}\\left\\ { ( c,\\ell ) \\in { \\mathbb{r}}^{2n+2n } : \\eqref{eqn : sitb},\\eqref{eqn : bounds},\\eqref{eqn : area } , \\bigwedge_{(i , j ) \\in { \\mathscr{p } } } d^4_{i , j } \\right\\},\\ ] ] and a ( nonlinear ) disjunctive programming formulation of the flp is given by @xmath36 .",
    "the main objective of this work is to transform this disjunctive programming problem into a mixed - integer formulation that can be solved by off - the - shelf optimization software . to achieve this , we first focus our attention to a single pair of boxes @xmath11 and @xmath23 for @xmath9 , in which case we are interested in constructing a mip formulation of @xmath37{\\mbox{\\normalfont\\tiny\\sffamily def}}}{=}}}\\left\\ { ( c_i , c_j,\\ell_i,\\ell_j ) \\in { \\mathbb{r}}^8 : \\eqref{eqn : sitb},\\;\\eqref{eqn : bounds},\\;\\eqref{eqn : area},\\ ; d^4 \\right\\}$ ] if we omit the nonlinear area constraints we obtain the set @xmath38{\\mbox{\\normalfont\\tiny\\sffamily def}}}{=}}}\\left\\ { ( c_i , c_j,\\ell_i,\\ell_j ) \\in { \\mathbb{r}}^8 : \\eqref{eqn : sitb},\\;\\eqref{eqn : bounds},\\ ; d^4 \\right\\}$ ] , which can be written as the union of ( bounded ) polyhedra @xmath39 , where @xmath40 .",
    "we can then use various techniques to construct a linear mip formulation of @xmath41 , which can be combined with the area constraints to obtain a second - order - cone mip ( soc - mip ) formulation of @xmath42 .",
    "finally , we can combine these formulations for all pairs @xmath9 and an appropriate linearization of the objective function to obtain a soc - mip of the complete problem .",
    "much of our analysis will focus on constructing such mip formulations of @xmath41 , which we denote the _ pairwise flp_. however , in section [ sec : objective ] and section [ ss : multibox - cuts ] we consider the strengthening of the final formulation by explicitly considering the objective function and larger collections of boxes , respectively , when formulating the disjunctive constraint .",
    "mip formulations for unions of polyhedra such as @xmath41 can be divided into _ extended formulations _ that uses both continuous and @xmath1 auxiliary variables ( * ? ? ?",
    "* section 5 ) and _ non - extended ( projected ) formulations _ that only use the @xmath1 auxiliary variables that are strictly necessary to build a valid formulation ( * ? ? ?",
    "* section 6 ) .",
    "note that , in general , it is not possible to construct a mip formulation for unions of polyhedra in the original space , so some ( @xmath1 ) variables are needed for representability .",
    "standard extended formulations by @xcite and @xcite have the desirable property that their linear programming ( lp ) relaxations have extreme points that naturally satisfy the integrality requirements on the @xmath1 auxiliary variables ; we call such formulations _ integral _ or _ ideal_. in contrast , non - extended formulations often fail to be ideal , but can be much smaller .",
    "for instance , the following proposition shows a non - extended formulation of @xmath41 obtained through the classical _ big-@xmath43 _ approach .",
    "[ observation : bigm ] the following is a formulation for @xmath41 :    [ eqn : unary - bigm ] @xmath44    formulation only uses four @xmath1 auxiliary variables ( and no continuous auxiliary variables ) and is about four times smaller than the standard ideal extended formulation for @xmath41 ( see appendix  [ extendedformulationsec ] ) . while formulation is not guaranteed to be ideal , its smaller size can still result in a computational advantage over the ideal extended formulation .",
    "in addition , using various techniques it is sometimes possible to strengthen non - extended formulations considerably .",
    "for this reason , we concentrate on constructing non - extended formulations for the flp by using three techniques : ( 1 ) the flexible use of @xmath1 auxiliary variables provided by the _ embedding formulations _",
    "approach , ( 2 ) alternative definitions of the disjunctive constraints @xmath45 , and ( 3 ) the consideration of various common linear inequalities when building the disjunctions .",
    "we now provide some simple examples of applying these techniques to build mip formulations for disjunctive sets .",
    "we begin our description of the embedding formulation approach of @xcite by re - interpreting as a formulation for the _ embedding _ of @xmath41 in a higher dimensional space .",
    "indeed , @xmath46 is feasible for if and only if it belongs to the embedding of @xmath47 into @xmath48 given by @xmath49 where @xmath50 is the @xmath51-th unit vector ( @xmath52 for @xmath53 and @xmath54 ) .",
    "we say that representation _ embeds _",
    "@xmath41 , which lives in the space of the @xmath55 variables , into the space of the @xmath46 variables .",
    "it achieves this by pairing each of the four polyhedra @xmath56 with a unique binary vector @xmath50 , and so _ encoding _ the disjunctive constraint .",
    "any valid formulation for implies a valid formulation for @xmath41 , since @xmath41 is the orthogonal projection of @xmath57 onto the @xmath55 variables .",
    "however , representation also makes explicit the role of the @xmath58 variables : @xmath59 implies that @xmath60 . in other words , the possible values @xmath61 of @xmath58 _ encode _ the selection among the polytopes @xmath56 .",
    "the key for the flexibility of the embedding approach is noting that this encoding can use any family of pairwise distinct @xmath1 vectors in place of the unit vectors @xmath50 .",
    "the following definition formalizes this approach in our context , where we explicitly separate the disjunctive constraint @xmath62 from the common constraints @xmath63 , which must be satisfied by all branches of the disjunction .",
    "[ embeddingdef ] let @xmath64 , @xmath65 for each @xmath66 , @xmath67{\\mbox{\\normalfont\\tiny\\sffamily def}}}{=}}}{\\left\\{x\\in { \\mathbb r}^d\\,:\\ , a^0 x\\leq b^0\\right\\}}$ ] be a polyhedron , @xmath68 $ ] be a disjunction on @xmath69 , @xmath70{\\mbox{\\normalfont\\tiny\\sffamily def}}}{=}}}{\\left\\{x\\in q\\,:\\,a^k x \\leq b^k \\right\\}}$ ] for @xmath71 be",
    "the family of polyhedra obtained by combining @xmath63 and @xmath62 , and @xmath72 be an encoding composed of _ pairwise distinct _ @xmath1-vectors .",
    "if the recession cones @xmath73 for all @xmath74 , then a non - extended ( linear ) mip formulation for @xmath75 , or , equivalently for @xmath76 , is any ( linear ) mip formulation for the embedding @xmath77{\\mbox{\\normalfont\\tiny\\sffamily def}}}{=}}}\\bigcup_{k=1}^k p^k \\times \\{h^k\\}$]that uses only @xmath78 variables .",
    "standard formulation approaches are recovered when choosing the unit vectors @xmath79{\\mbox{\\normalfont\\tiny\\sffamily def}}}{=}}}\\{{{\\bf e}}^k\\}_{k=1}^k \\subseteq \\{0,1\\}^k$ ] , which we denote the _ unary encoding _ , as it uses one bit per branch of the disjunction .",
    "for example , we have that is a formulation for @xmath80 with @xmath81 .",
    "however , the real flexibility comes from the possibility of non - unary encodings , as the specific assignment of codes to branches of the disjunctions does not change the structure of the formulation .",
    "for instance , to obtain a valid formulation for @xmath82 with @xmath83 we simply need to interchange @xmath84 and @xmath85 in .",
    "in contrast , for other types of encodings the specific assignment can be significant in terms of the complexity of the resulting embedding object and formulations ( e.g. see section  [ sec : binaryform ] and @xcite ) .",
    "deriving ideal non - extended formulations for embeddings with any encoding can be done using a geometric construction introduced in @xcite .",
    "however , such construction can be hard to analyze , and many choices of encodings may naturally have very large ideal formulations ( i.e. many inequalities ) .",
    "fortunately , non - extended formulations can also be constructed using ad - hoc approaches or through simple constructions such as the generalization of the big-@xmath43 approach to arbitrary encodings introduced in @xcite . in the coming sections",
    "we will see how this generic approach can be used to construct a range of formulations for our disjunctive set .",
    "in particular , varying the ingredients @xmath63 , @xmath62 , and @xmath86 lead to different embedding objects @xmath87 , which in turn will necessitate different formulations . for examples beyond the flp where varying the encoding choice @xmath86 results in different formulations we refer the reader to @xcite and @xcite . in the following subsections , we provide such examples for varying inputs @xmath62 and @xmath63 .",
    "the new formulation for the flp proposed in section [ sec : refined - disjunction ] hinges on a logical refinement of the disjunction @xmath31 that removes many redundant solutions from the resulting formulation .",
    "to illustrate this idea , we provide a simple example , which is independent of the flp . consider the disjunctive constraint @xmath88{\\mbox{\\normalfont\\tiny\\sffamily def}}}{=}}}{\\left[x_1+x_2\\leq 1\\right ] }",
    "\\vee { \\left [   x_2\\leq x_1\\right]}$ ] and common linear constraints @xmath89{\\mbox{\\normalfont\\tiny\\sffamily def}}}{=}}}{\\left\\{x\\in { \\mathbb r}^2\\,:\\ , 0\\leq x_i \\leq 1 \\quad \\forall i\\in \\llbracket 2 \\rrbracket \\right\\}}$ ] , for which @xmath90{\\mbox{\\normalfont\\tiny\\sffamily def}}}{=}}}\\{x \\in q_1 : d_1^a\\}$ ] is depicted in figure  [ fig1 ] . because the two alternatives of @xmath91 intersect , we can define an alternative disjunction @xmath92{\\mbox{\\normalfont\\tiny\\sffamily def}}}{=}}}{\\left [ x_1+x_2\\leq 1 , x_1\\leq x_2\\right ] } \\vee { \\left [ x_1+x_2\\leq 1 , x_2\\leq x_1\\right]}\\vee { \\left[x_1+x_2\\geq 1 , x_2\\leq x_1\\right]},\\ ] ] for which @xmath93 . using @xmath94 instead of @xmath95 could lead to larger formulations , since more branches on the disjunction will require longer codes to satisfy the distinctness property .",
    "however , it also reduces redundancy or symmetry , phenomena which are known to reduce the effectiveness of mixed - integer solvers .",
    "in particular , we note that the point @xmath96 satisfies both branches of @xmath91 , but only one branch of @xmath97 . using the embedding approach for some encoding @xmath86 ,",
    "this gives to two feasible points in @xmath98 which correspond to @xmath96 and differ only in their assigned code .",
    "one advantage of the embedding framework as described in definition  [ embeddingdef ] is that it allows us to exploit the fact that the flp has many constraints beyond the disjunctive constraint @xmath31 . in particular ,",
    "we can pick which constraints we include in the ground set @xmath63 to combine with the disjunctive constraint @xmath62 and build a formulation , and which constraints are added after the formulation process . such choice can significantly change the strength of the final formulation .    to illustrate this effect",
    "consider the following simple example , which is independent of the flp .",
    "take the disjunctive constraint @xmath99{\\mbox{\\normalfont\\tiny\\sffamily def}}}{=}}}{\\left [ x_1+x_2\\leq 1\\right ] } \\vee { \\left [    1+x_2\\leq x_1\\right]}$ ] and the set of linear inequalities    [ alllinearineq ] @xmath100    suppose we want to construct a mip formulation for @xmath101{\\mbox{\\normalfont\\tiny\\sffamily def}}}{=}}}{\\left\\{x\\in { \\mathbb r}^2\\,:\\,\\eqref{alllinearineq } , d_2\\right\\}}$ ] depicted by the dark shaded region in figure  [ fig3 ] . if we let @xmath102{\\mbox{\\normalfont\\tiny\\sffamily def}}}{=}}}{\\left\\{x\\in { \\mathbb r}^2\\,:\\ , \\eqref{linearineq1 } \\right\\}}$ ] we have that both @xmath103 and @xmath104 are bounded and hence satisfy the conditions of definition  [ embeddingdef ]",
    ". then , we can at first ignore linear inequality and construct a formulation for @xmath105 ( depicted by the and light shaded region in figure  [ fig3 ] ) and then impose on the resulting formulation . for instance , an ideal formulation of @xmath106 is given by    [ partialform ] @xmath107    a formulation of @xmath108 is then given by and . however , a second option is to include all inequalities into @xmath109{\\mbox{\\normalfont\\tiny\\sffamily def}}}{=}}}{\\left\\{x\\in { \\mathbb r}^2\\,:\\ , \\eqref{linearineq1 } \\text{--}\\eqref{linearineq}\\right\\}}$ ] and directly construct a formulation of @xmath110 .",
    "for instance , an ideal formulation of @xmath111 is given by with strengthened to @xmath112 we can check that @xmath113 is feasible for the lp relaxation of and , but it does not satisfy . hence , the formulation obtained by considering all common linear inequalities is stronger that the one obtained by first ignoring .",
    "a similar strengthening effect can occur when auxiliary variables and linear inequalities used to model other aspects of a mathematical programming problem are included in the common constraints .",
    "this is the case with the flp and the nonlinear objective function , which may be linearized with auxiliary variables and constraints .    for a simple motivating example ,",
    "let @xmath114{\\mbox{\\normalfont\\tiny\\sffamily def}}}{=}}}{\\left[x_1\\leq 1\\right ] } \\vee { \\left [ x_1 \\geq 3\\right]}$ ] , @xmath115{\\mbox{\\normalfont\\tiny\\sffamily def}}}{=}}}{\\left\\{x_1\\in { \\mathbb r}\\,:\\ , 0\\leq x_1\\leq 4\\right\\}}$ ] and @xmath116{\\mbox{\\normalfont\\tiny\\sffamily def}}}{=}}}{\\left\\{x_1\\in q_3^a\\,:\\ , d_3\\right\\}}$ ] , and suppose we want to solve @xmath117 .",
    "an ideal formulation for @xmath118 is given by @xmath119 which together with a standard lp modeling trick to linearize the absolute value in the objective leads to the mip formulation of the complete problem given by @xmath120 alternatively , we could instead include the linearization trick in the common constraints to obtain @xmath121{\\mbox{\\normalfont\\tiny\\sffamily def}}}{=}}}{\\left\\{{\\left(x_1,y_1\\right)}\\in { \\mathbb r}^2\\,:\\ , 0\\leq x_1\\leq 4,\\quad x -2 \\leq y_1,\\quad -x_1 + 2 \\leq y_1 \\right\\}}$ ] and @xmath122{\\mbox{\\normalfont\\tiny\\sffamily def}}}{=}}}{\\left\\{{\\left(x_1,y_1\\right)}\\in q_3^b\\,:\\ , d_3\\right\\}}$ ] , depicted in figure  [ fig4 ] . an integral formulation for @xmath123 is given by plus @xmath124 which leads to the mip formulation of the complete problem given by @xmath125 we can check that the optimal value of the lp relaxation of is equal to one . in contrast",
    ", we can also check that the optimal value of the lp relaxation of is zero .",
    "that is , we have constructed a stronger mip formulation for minimizing a nonlinear objective over a union of polyhedra by directly including the linearization of the objective in our construction procedure .    given that incorporating additional structure in the ground set can allow us to construct stronger formulations , it seems at first that the optimal approach will be to simply add all constraints .",
    "however , this can quickly lead to embedding objects @xmath87 that are very complex or difficult to study ; if @xmath63 is restricted to some minimal `` interesting '' substructure , we will see that we are better equipped to study and construct strong formulations .",
    "we start by analyzing a simple , yet nontrivial , substructure for which we are able to construct a strong ( i.e. ideal ) formulation .",
    "take @xmath126{\\mbox{\\normalfont\\tiny\\sffamily def}}}{=}}}\\left\\{(c_i ,",
    "c_j,\\ell_i,\\ell_j ) \\in { \\mathbb{r}}^8 : \\eqref{eqn : sitb},\\;\\eqref{eqn : lowerbound } \\right\\}$ ] ; that is , the set that imposes that the boxes lie completely on the floor and lower bounds on the box widths . using this set of common constraints , disjunction @xmath31 and the unary encoding we can construct the following small ideal formulation . throughout , we will use the notation @xmath127 as enumeration over the two orderings @xmath128 and @xmath129 .",
    "[ thm : unary ] the following is a formulation for @xmath130 :    [ eqn : unary - formulation ] @xmath131    if @xmath132 for both @xmath21 , then this formulation is ideal .    see appendix [ app : unary - proof ] .",
    "we dub the _",
    "unary formulation_. however , we do not use the same naming convention for the binary variables as in formulation .",
    "instead we rename @xmath84 , @xmath85 , @xmath133 and @xmath134 to @xmath135 , @xmath136 , @xmath137 and @xmath138 .",
    "the reason for this is that the @xmath1 variables from have the nice interpretation that @xmath139 .",
    "this interpretation forms the basis for the flp2 formulation in @xcite and @xcite .",
    "in fact , the unary formulation is very similar to flp2 , but with the addition of the tightened stay - on - the - floor constraints .",
    "in the sequel we use similar naming conventions for the @xmath1 variables when they have helpful interpretations .",
    "the unary encoding uses codes of four bits to differentiate between four choices . if we instead use a binary encoding , we only need two bits ( i.e. codes of length two ) to impose this same decision .",
    "in contrast to unary encodings , the specific assignment of codes to branches for binary encodings can result in significantly different formulations @xcite .",
    "however , because of symmetry , for binary encodings of length two we may restrict our attention to two possible choices .",
    "the first encoding corresponds to the unique ( up to symmetry ) gray code @xcite with two bits given by @xmath140{\\mbox{\\normalfont\\tiny\\sffamily def}}}{=}}}\\left\\ { ( 0,0 ) , ( 1,0 ) , ( 0,1 ) , ( 1,1 ) \\right\\}$ ] , and the second corresponds to the codes @xmath141{\\mbox{\\normalfont\\tiny\\sffamily def}}}{=}}}\\left\\ { ( 0,0 ) , ( 1,1 ) , ( 1,0 ) , ( 0,1 ) \\right\\}$ ] .",
    "both choice of codes and their corresponding encodings can be used to reinterpret existing formulations from the literature .",
    "the following proposition shows that the big-@xmath43 approach of @xcite can be used to construct a simple formulation for the gray encoding , which can be seen as the basis of formulation flp - sp introduced in @xcite .",
    "[ graybigm ] a valid formulation for @xmath142 is :    [ eqn : gray - binary - formulation ] @xmath143    see appendix  [ app : gray - bigm ] .",
    "formulation flp - sp is obtained from by adding the `` sequence - pair '' inequalities for the @xmath0-box formulation introduced in @xcite , which , while strictly breaking validity , can reduce redundancy in the feasible region set without removing any valid layouts . for completeness , we present the sequence pair inequalities in appendix [ app : sequence - pair ] .",
    "we will see in section [ sec : computations ] that the flp - sp is the most competitive formulation from the literature on our computational benchmarks .",
    "if instead we attempt to construct a formulation for @xmath144 , we can easily reconstruct the bldp1 formulation from @xcite , which we present in appendix [ app : bldp1 ] .      while the disjunction @xmath45 is sufficient to enforce that @xmath11 and @xmath23 do not overlap",
    ", its simplicity has a downside when used in a mip framework .",
    "the disjunction is not sufficiently refined in the sense that there exist many feasible layouts that satisfy multiple branches at once .",
    "for example , in figure [ fig:8-configurations ] , we see that @xmath11 precedes @xmath23 in both the @xmath24 and @xmath25 directions .",
    "therefore , in any embedding constructed using @xmath45 , there exist two points that project down to the same layout ( that is , they differ only in their assigned codes ) . in practice , this redundancy can hamper the progress of branch - and - bound solvers , which must explicitly enumerate these solutions ( and all nodes preceding them in the tree ) to prove optimality .",
    "precedes @xmath23 , @xmath145 , and @xmath146 in direction @xmath25 .",
    "it also precedes @xmath23 in direction @xmath24 , does not precede @xmath145 in direction @xmath24 , and both precedes and does not precede @xmath146 in direction @xmath24 .",
    "+ ( right ) the eight branches of the disjunction @xmath147 , illustrated via the relative position of @xmath23 to @xmath11.,title=\"fig : \" ]   precedes @xmath23 , @xmath145 , and @xmath146 in direction @xmath25 .",
    "it also precedes @xmath23 in direction @xmath24 , does not precede @xmath145 in direction @xmath24 , and both precedes and does not precede @xmath146 in direction @xmath24 .",
    "+ ( right ) the eight branches of the disjunction @xmath147 , illustrated via the relative position of @xmath23 to @xmath11.,title=\"fig : \" ]    to help remove this redundancy from the feasible set , we present a refined disjunction that is logically equivalent to @xmath31 . in definition",
    "[ defn : precede ] , we presented a linear inequality that enforces that @xmath11 precedes @xmath23 . for our refined disjunction , we will need a description of the opposite .",
    "we say that @xmath11 _ does not precede _",
    "@xmath23 ( denoted by @xmath148 ) if @xmath149 .",
    "referring back to figure [ fig:8-configurations ] , we see that @xmath11 precedes @xmath145 in direction @xmath25 , but does not precede @xmath145 in direction @xmath24 ( and vice versa ) .",
    "note in particular that , if @xmath150 ( as with @xmath11 and @xmath146 in figure [ fig:8-configurations ] ) , we have that both @xmath27 and @xmath148 simultaneously .    with the two definitions , we can construct a refinement of @xmath45 given by @xmath151{\\mbox{\\normalfont\\tiny\\sffamily def}}}{=}}}\\bigvee_{k=1}^8 br^k_{i , j}$ ] where @xmath152 we have taken a refinement of @xmath31 by splitting the regions satisfying two branches at once into the new branches @xmath153 , and @xmath154 , and shrinking the other branches to exclude these new regions .",
    "see figure [ fig:8-configurations ] for an illustration .    with 8 branches in the disjunction",
    "we need codes of length at least @xmath155 .",
    "however , in lieu of chasing the formulation with the smallest number of @xmath1 variables ( i.e. a binary formulation ) , we instead take the encoding @xmath156{\\mbox{\\normalfont\\tiny\\sffamily def}}}{=}}}\\left\\ { { { \\bf e}}^1 , { { \\bf e}}^1+{{\\bf e}}^2 , { { \\bf e}}^2 , { { \\bf e}}^2+{{\\bf e}}^3 , { { \\bf e}}^3 , { { \\bf e}}^3+{{\\bf e}}^4 , { { \\bf e}}^4 , { { \\bf e}}^4+{{\\bf",
    "e}}^1 \\right\\ } \\subseteq \\{0,1\\}^4 $ ] .",
    "intuitively , we have taken the codes from the unary encoding for the regions @xmath157 , and @xmath158 , and taken the codes for the new branches as the sum of the codes assigned to the two branches in @xmath31 the region satisfies .",
    "for example , we get @xmath159 by taking the intersection of @xmath160 ( code @xmath161 ) and @xmath162 ( code @xmath163 ) , so we take the corresponding code as @xmath164 .",
    "we see in the following proposition that by `` shadowing '' the unary embedding in this way , we are able to construct a formulation for @xmath165 that is very similar to the ideal formulation for @xmath166 .",
    "[ prop : refined ] the following is a valid formulation for @xmath165 :    [ eqn : refined - unary - formulation ] @xmath167    see appendix [ app : refined ] .",
    "we dub formulation the _ refined unary formulation _ , and conjecture that it is the strongest possible for @xmath165 .",
    "formulation is ideal .",
    "finally , we note that our choice of codes induce the following nice interpretation for the @xmath1 variables :    [ eqn : z - variable - implication ] @xmath168    this is a refinement of the interpretation for unary formulation as the variables for the unary formulation do not satisfy .",
    "in section [ sec : formulations ] we have seen how the embedding approach can be used to construct valid formulations for substructures of the pairwise flp . in particular , we chose a subset of variables and constraints ( @xmath169 ) for which the analysis is tractable . however , in section [ sec : common - constraints ] we have seen that incorporating more of the common constraint structure in the ground set @xmath63 can allow us to construct much stronger formulations . therefore , in this section we explore embeddings of more complex substructures @xmath63 . however , since the facial structure of the embedding objects grows considerably more complex , we only focus on constructing valid inequalities for these new embeddings .    in the remaining sections , we will express all inequalities for the refined unary encoding .",
    "fortunately , as described in @xcite , it is sometimes possible to translate valid inequalities between different encodings .",
    "we now present a self contained description of such translations for the flp and refer the reader to @xcite for a more general treatment .",
    "[ prop : map - from - refined ] let @xmath170{\\mbox{\\normalfont\\tiny\\sffamily def}}}{=}}}\\{(c_i , c_j,\\ell_i,\\ell_j ) \\in { \\mathbb{r}}^{8 } : \\eqref{eqn : sitb } , \\eqref{eqn : area } , \\eqref{eqn : bounds}\\}$ ] and consider an inequality @xmath171 with @xmath172 that is valid for @xmath173 .",
    "then    * @xmath174 is valid for @xmath175 , and * @xmath176 is valid for @xmath177 ,    where @xmath178 is the affine mapping that identifies @xmath179 with @xmath180 and @xmath181{\\mbox{\\normalfont\\tiny\\sffamily def}}}{=}}}\\begin{pmatrix } -1 & -1 \\\\ 1 & -1 \\\\ 1 & 1 \\\\ -1 & 1 \\end{pmatrix }",
    "w + \\begin{pmatrix } 1 \\\\ 0 \\\\ -1 \\\\ 0 \\end{pmatrix}.\\ ] ] is the affine mapping that identifies @xmath182 with @xmath183 .    we prove the second , as the first follows in the same way . consider a feasible layout @xmath184 and take the corresponding feasible codes @xmath185{\\mbox{\\normalfont\\tiny\\sffamily def}}}{=}}}\\left\\{w \\in gb^4 : ( \\hat{c},\\hat{\\ell},w ) \\in { \\operatorname{em}}(q^{flp},d^4,gb^4 ) \\right\\}$ ] .",
    "choose some @xmath186 .",
    "then there exists some code @xmath187 such that @xmath188 and @xmath189 .",
    "therefore , we have that , since @xmath172 , @xmath190 therefore , the given inequality holds for @xmath177 .    [ prop : map - to - refined ] if inequality @xmath191 is valid for @xmath175 , then @xmath171 is valid for @xmath173 if either @xmath192 or @xmath193 .",
    "consider a feasible layout @xmath184 and take the corresponding feasible codes @xmath194{\\mbox{\\normalfont\\tiny\\sffamily def}}}{=}}}\\left\\{u \\in u^4 : ( \\hat{c},\\hat{\\ell},u ) \\in { \\operatorname{em}}(q^{flp},d^4,u^4 ) \\right\\}$ ] and @xmath195{\\mbox{\\normalfont\\tiny\\sffamily def}}}{=}}}\\left\\{z \\in c^8 : ( \\hat{c},\\hat{\\ell},z ) \\in { \\operatorname{em}}(q^{flp},d^8,c^8 ) \\right\\}$ ] . from the construction of the codes @xmath196 discussed in section [ sec : refined - disjunction ] , for each @xmath197 , there exist some @xmath198 such that @xmath199 and @xmath200 ( if @xmath201 , then @xmath202 ) .",
    "for example , if @xmath203 , we see that @xmath204 and @xmath205 . therefore , if @xmath206 , we have that @xmath207 if @xmath208 , then the same inequality holds with @xmath209 in place of @xmath210 .",
    "therefore , any inequality valid for @xmath211 is valid for @xmath212 .      in the previous section we chose the base set @xmath169 such that only lower bounds on the widths were included in the formulation",
    "this was to make the formulation analysis tractable , but enforcing the aspect - ratio constraints via naturally includes upper bounds as well .",
    "therefore , we can consider the set @xmath213 induced by @xmath214{\\mbox{\\normalfont\\tiny\\sffamily def}}}{=}}}\\{(c,\\ell ) \\in q^{lb } : \\eqref{eqn : upperbound}\\}$ ] .",
    "[ prop : ub - cuts ] for any assignments @xmath215 and @xmath216 , then @xmath217 is a valid inequality for @xmath213 . if @xmath218 , @xmath219 is valid for both @xmath211 and @xmath212 .",
    "see appendix [ app : ub - cuts ] .",
    "the objective is nonlinear but is straightforward to linearize in the usual fashion with auxiliary variables @xmath220 and the constraints @xmath221 even though this type of linearization is a very common mip formulation technique , it is often not incorporated into polyhedral studies explicitly . to do this for the pairwise flp , consider the augmented base set @xmath222 .",
    "the resulting encoding @xmath223 leads to a collection of inequalities that serve to lower bound the auxiliary objective variables @xmath224 .",
    "[ prop : obj - cuts ] choose @xmath21 and some assignment @xmath216",
    ". then the following are valid inequalities for @xmath223 : @xmath225    see appendix [ app : obj - cuts ] .",
    "note that we are now adding both constraints and variables to our ground set @xmath226 .",
    "these inequalities are especially significant , since they explicitly incorporate the objective function , and the mip relaxation lower bounds for the flp are quite poor ( see section [ sec : lowerbounds ] ) .",
    "thus far we have only considered representations for @xmath41 , the relationships between a single pair of boxes . in this section",
    "we address how to use the results derived for the pairwise formulations to construct strong formulations for the original @xmath0-box floor layout problem .",
    "since all the constraints for the flp involve at most two boxes , it suffices to consider each pair of boxes separately , construct a pairwise formulation , and identify all repeated variables across these pairwise formulations as follows .",
    "[ prop : pairwise - to - nbox ] consider pairwise formulations @xmath227 for each pair of boxes @xmath9 over the variables @xmath228 .",
    "if @xmath229{\\mbox{\\normalfont\\tiny\\sffamily def}}}{=}}}\\sum_{(i , j ) \\in { \\mathscr{p } } } m_{i , j}$ ] , then @xmath230 is a formulation for @xmath231 .    in particular , if we take the refined unary formulation for each pair of boxes , we construct the following formulation for the @xmath0-box flp .    [ prop : pairwise - to - nboxc ] take @xmath232 .",
    "then @xmath233{\\mbox{\\normalfont\\tiny\\sffamily def}}}{=}}}\\left\\ { ( c,\\ell , v ) \\in { \\mathbb{r}}^{8n } \\times \\{0,1\\}^{2n(n-1 ) } : ( c_i , c_j,\\ell_i,\\ell_j , v^{i , j } ) \\in f^{ru}_{i , j } \\ : \\forall ( i , j ) \\in { \\mathscr{p}}\\right\\}\\ ] ] is a valid formulation for @xmath231 .    while this approach is sufficient to construct a valid formulation , constructing disjunctive and mip formulation for multiple pairs of boxes can lead to stronger formulations",
    "however , such formulations can be significantly larger and/or more complicated .",
    "for this reason we instead concentrate on identifying valid inequalities for such multi - pair or multi - box formulations to strengthen the single - pair formulation from propositions  [ prop : pairwise - to - nbox ] and corollary  [ prop : pairwise - to - nboxc ] .      when working with more than two boxes at once , the notion of spatial transitivity appears ; that is , for any @xmath234 we have @xmath235 .",
    "we can use this property to generalize many of the pairwise valid inequalities introduced thus far to the multi - box setting , in a similar way to section 3 of @xcite .    consider a pair of boxes @xmath9 and take an arbitrary path @xmath236 , where @xmath237 and @xmath238 .",
    "we define an affine function of the form @xmath239{\\mbox{\\normalfont\\tiny\\sffamily def}}}{=}}}1 + \\sum_{\\xi=1}^{m+1 } \\left(z^s_{t^{\\xi-1},t^\\xi } - 1\\right)$ ] .",
    "our function enjoys the following property : @xmath240 this will function as an ( underestimator for the ) indicator function for when we have a particular chain of boxes @xmath241 along direction @xmath26 .",
    "we can use this to extend the logic of the pairwise inequalities we have developed . for a simple example , if @xmath242 , then we know that @xmath11 and @xmath23 are separated in direction @xmath26 by at least the smallest width @xmath146 can take along that direction , and so @xmath243 .",
    "this tightening can be exploited in the inequalities derived previously , leading a host of new valid inequalities for the multi - box flp .",
    "[ prop : multibox - cuts ] consider the pair @xmath244 and an arbitrary path @xmath245 , where @xmath246 and @xmath247 and @xmath248 .",
    "choose assignments @xmath215 and @xmath216 and define @xmath249{\\mbox{\\normalfont\\tiny\\sffamily def}}}{=}}}\\sum_{\\xi=1}^m lb^s_{t^\\xi}$ ] .",
    "then the following are valid inequalities for @xmath250 : @xmath251    first , we note that inequalities ( [ eqn : multi1]-[eqn : multi7 ] ) are variations on ( [ eqn : obj1]-[eqn : obj4],[eqn : ru - tight - sitb],[eqn : ru - tight - sitb],[eqn : ru - nonoverlap ] ) , respectively , with an additional @xmath252 term appearing .    we can use to see that @xmath253 implies @xmath254 for all @xmath255 to take a telescoping sum and derive @xmath256 in the case where @xmath253 for all @xmath255 . combining this with property , we derive that @xmath257 is valid for any feasible solution for @xmath250 .",
    "this can be used to directly derive ( [ eqn : multi5]-[eqn : multi7 ] ) .",
    "for example , can be derived by summing the valid inequalities @xmath258 after noting that @xmath259 implies that @xmath260 .    for ( [ eqn : multi1]-[eqn : multi4 ] )",
    ", we first observe that , due to property , the case analysis in appendix  [ app : obj - cuts ] will only differ in the case where @xmath253 for all @xmath255 .",
    "however , under the assumption that @xmath261 for all @xmath262 , this also implies that @xmath263 .",
    "therefore , we may use the tightened inequality ( * * ) in lieu of ( * ) in the case analyses , yielding the result .",
    "proposition [ prop : multibox - cuts ] provides an exponential number of valid inequalities for the @xmath0-box flp . for small paths ( e.g. @xmath264 )",
    ", these inequalities can be added to the formulation directly ; this is the approach we take in the computational trials .",
    "we compare four formulations and four levels of cuts in the computational trials .",
    "the unary formulation , denoted ` u ` , is based on the pairwise unary formulation ; this is a strengthened version of the flp2 formulation from @xcite .",
    "the ` bldp1 ` formulation from @xcite is also tested ; see appendix  [ app : bldp1 ] .",
    "the third formulation is the sequence - pair formulation ( ` sp ` ) from @xcite , derived by adding global constraints to a formulation derived from ; see appendix  [ app : sequence - pair ] .",
    "finally , we compare with our new refined unary formulation , which we denote ` ru ` .",
    "we note that we observe a slight computational advantage for using the simple stay - on - the - floor constraints rather than the tightened versions and , since we may aggregate them and add a single copy , rather than one for each pair @xmath9 ; we instead add these tightened constraints as valid inequalities .",
    "we will compare each of these formulations with one of four levels of valid inequalities added to the formulation ( that is , they are not separated dynamically ) .",
    "the first will be no valid inequalities .",
    "the second will use the v2 and b2 families of inequalities appearing in @xcite ; the formulation name will be appended with ` + ` if these inequalities are added .",
    "we present these inequalities in appendix [ app : literature - cuts ] for completeness .",
    "the ` vi ` tag will be used for formulations with the new inequalities derived in this work added . in particular , we use ( [ eqn : obj1]-[eqn : obj4 ] ) , , and ( [ eqn : multi5]-[eqn : multi7 ] ) for paths @xmath265 . for",
    "the ` ru ` formulation , we also add and .",
    "adding all of these to the formulation proved impractical in the branch - and - bound setting , so we instead add an @xmath266 subset of these inequalities with ` vi ` .",
    "finally , we consider adding ( an @xmath266 subset of ) the `` multi - box objective cuts '' ( [ eqn : multi1]-[eqn : multi4 ] ) for paths @xmath241 of length 3 , and denote this by appending a ` 3 ` .",
    "there is a standard symmetry - breaking approach presented in @xcite that we will use in all the computational examples to follow ( except for the relaxation gap discussion in section [ sec : lowerbounds ] , where we will discuss the effect of the symmetry - breaking explicitly ) .",
    "we present the symmetry - breaking scheme in appendix [ app : symmetry - breaking ] for completeness .    for our benchmarks ,",
    "we use the ` hp ` , ` apte ` , and ` xerox ` benchmarks from the mcnc benchmark collection @xcite .",
    "additionally , we will use the ` armour62 - 1 ` and ` armour62 - 2 ` instances from @xcite , the ` bazaraa75 - 1 ` and ` bazaraa75 - 2 ` instances from @xcite , the ` camp91 ` instance from @xcite , the ` bozer91 ` instance from @xcite , and the ` bozer97 - 1 ` and ` bozer97 - 2 ` instances from @xcite instances .",
    "to the best of our knowledge , none of these instances have been solved to optimality before in the literature .    to construct the formulations and interface with the solver",
    ", we use the jump algebraic modeling language from @xcite ; jump is written in the julia programming language ( see @xcite ) .",
    "we performed the experiments on an intel i7 - 3770 3.40ghz linux workstation with 32 gb of ram .",
    "all trials use cplex v12.6 with a maximum runtime of 4 hours .",
    "we also performed trials with gurobi v6.0 , but the performance was not competitive .",
    "we force cplex to use the linearization of the second - order cone constraints ( ` cpx_param_miqcpstrat ` set to 2 ) , as solving the nonlinear problem at the nodes was far slower .",
    "all trials are performed with maximum aspect ratio @xmath267 .",
    "the code used for these computational studies , as well as the benchmark instances in mps format are available at https://github.com/joehuchette/floor-layout .",
    "first , we compare the lower bound produced by solving the continuous relaxation of the formulations , with and without valid inequalities added .",
    "we present the relative gap percentage @xmath268 , where @xmath269 is the given relaxation lower bound and @xmath270 is the cost of the best known feasible solution .",
    "note in particular that a relative gap percentage of @xmath271 implies that the relaxation bound of @xmath272 , which is the worst possible for the flp .",
    "we observe that the formulations naturally fall into two groups with respect to the quality of their relaxation bound , and we summarize the results below ( we include a table in appendix [ app : relaxation - gap - table ] for completeness ) .",
    "first , we observe that the `` two - bit '' formulations ( binary gray , bldp1 , flp - sp ) have a relaxation gap of @xmath271 , even with _ all inequalities _ discussed in the previous subsection added to the formulation ( ` + vi3 ` ) . with the symmetry - breaking constraints added to the formulation ,",
    "the relaxation lower bound is no longer zero , and so the relaxation gap improves slightly ( mean 89.3% , with standard deviation @xmath273 ) .",
    "the `` four - bit '' formulations ( unary and refined unary ) also produce a trivial relaxation gap of @xmath271 , but adding the valid inequalities helps improve the lower bound considerably ( mean @xmath274 with standard deviation @xmath275 ) . in particular , we can isolate the b2 inequalities from @xcite and as the crucial additions to the improvement in the gap .",
    "we also compare the relative gap attained at the root node ( with respect to the best known feasible solution ) after cplex is able to apply advanced techniques such as general purpose cuts and preprocessing .",
    "this improves the gap by roughly 1%-5% for most trials",
    ". however , there is still an appreciable difference in gap between the `` four bit '' formulations ` u ` and ` ru ` and the `` two bit '' formulations ` sp ` and ` bldp1 ` .",
    "a complete table is available in appendix  [ app : relaxation - gap - table ] .",
    "the rationale for introducing the refined unary formulation was that many feasible layouts will have multiple corresponding points in the encoding constructed using @xmath31 .",
    "the refined partition removes many of these redundant solutions , which helps in the branch - and - bound setting , much in the same way symmetry breaking removes equivalent feasible solutions that would otherwise have to be explicitly enumerated in the optimization procedure .",
    "qualitatively , we observe this change of behavior in figure [ fig : branching ] , where we compare the progress of the ` sp+ ` and ` ru ` formulations as a function of node count on the ` xerox ` benchmark .",
    "that is , we compare both the upper and lower bound for both formulations ; when they are equal , the solver has proven optimality .",
    "we see that the ` ru ` formulation requires fewer nodes to prove optimality , as expected . more broadly",
    ", this illustration shows the typical trajectory when solving an instance of the flp : finding a good ( often near - optimal ) feasible solution early in the procedure , and then steadily improving the lower bound which is far from optimal , until the gap is finally closed and optimality is proven .          while the ` ru ` formulation offers advantages when looking at the progress with respect to the node count , the advantage is not so clear - cut when looking at solution time .",
    "table [ table : solve - time ] shows the solution time for each of our benchmarks and formulation and inequality combination .",
    "first , we see that the ` u ` and ` bldp1 ` formulations are never competitive on the benchmark set . some variant of the sequence pair or refined unary formulations is the best performer on all instances , with ` sp ` winning six and ` ru ` winning three . however , four of the wins for the ` sp ` used the inequalities derived in this work .",
    "in particular we note the ` bozer97 - 2 ` instance , which the sequence pair along with the new inequalities is able to solve the instance in the time limit , whereas none of the other approaches were able to close the gap beyond 3% .",
    "that is , the instance is previously unsolved , and would have remained unsolved without the use of the techniques from this work .    [ 1](#1% )    the results in table [ table : solve - time ] suggests that none of the approaches herein will be a clear winner on all instances , but that some combination of them can be used to tackle difficult problems . in particular , we recommend trying both the sequence pair and refined unary formulations , along with some subsets of the inequalities derived in this work to solve the flp instance most efficiently .",
    "in this work , we presented a case study on systematically building strong formulations for disjunctive sets ; namely , for the floor layout problem .",
    "we used the embedding approach of @xcite and @xcite to generate mip formulations of the flp and have observed how , by varying our inputs to the procedure , we are able to reconstruct all existing mip formulations for the problem , produce new formulations , and discover valid inequalities .",
    "we also showed how valid inequalities generated for one formulation can often be translated to seemingly unrelated formulations .",
    "finally , we presented computational results showing how the developed techniques can been used to solve previously unsolved benchmark instances .",
    "the following corollary gives an extended formulation for @xmath41 using a standard approach by balas , jeroslow and lowe .",
    "[ balascoro ] the following is an ideal extended formulation for @xmath41 :    [ eqn : balasform ] @xmath276    this follows from proposition 4.2 in @xcite .",
    "first , we note that is just formulation with a tightened form of constraints . for validity , first we want to show that the stay - on - the - floor constraints can be tightened to by the following case analysis .",
    "consider @xmath277 , @xmath278 , and @xmath279 ; the other constraints follow analogously .",
    "* reduces to the linear constraints in defining @xmath169 . *",
    "the first inequality is unchanged . for the second",
    ", we note that @xmath280 means that @xmath281 * same argument as the case before , but with the branch @xmath282 and the first inequality in . *",
    "not feasible by .    to show the formulation is ideal , we want to show that every extreme point of its relaxation has integral value for @xmath210 .",
    "consider the following system , which can be thought of as the projection of the relaxation of onto just the @xmath25 variables ( the argument for @xmath24 variables is identical ) . under the assumption that @xmath283 , the following is full - dimensional :    [ eqn : one - dimensional - unary ] @xmath284    take some arbitrary feasible @xmath285 where @xmath286 is fractional .",
    "we wish to show that this is not an extreme point .",
    "the argument for fractional @xmath287 follows in the same way . we will consider a partition of all possible cases in the following way :    1",
    ".   is active 1 .",
    "is active 2 .",
    "is not active 2 .",
    "is not active 1 .   and are both active 1 .",
    "is active 2 .",
    "is not active 2 .   at most one of and",
    "are active 1 .",
    "is not active 2 .",
    "is active    note in particular that , since @xmath288 , constraint immediately implies that @xmath289 and that ( [ eqn:50]-[eqn:51 ] ) can not be active . in each of these cases",
    ", we will argue that the solution is not extreme , either because there are not the requisite six constraints active , or because the selection leads to a contradiction .",
    "also , note that and both being active implies @xmath290 under the assumptions on lower bounds ( @xmath291 ) and on @xmath292 fractional ; similarly for and together for @xmath293 .",
    "therefore , these pairs can not be active together when these conditions are met .",
    "we will use this observation in the following .",
    "[ [ section ] ]    first consider the case that and are active . clearly and can not be active",
    ". then we must have and active as well : take their sum , which must hold with equality as it is equivalent to when @xmath294 .",
    "however , this also implies that at most three of these four active constraints are linearly independent .",
    "we can not have or active under our assumptions on the lower bounds ( take their sum with or , respectively ) .",
    "the only remaining possibility is if , , and are all active .",
    "however , then summing and and reducing leads to @xmath295 a contradiction .",
    "therefore , the point is not extreme .",
    "[ [ section-1 ] ]    now assume that is not active and is .",
    "this implies that at most one of and can be active , as their sum is equal to ( when @xmath294 ) as mentioned in the previous case . from our note above , at most one of and can be active at once .",
    "given this , the only possibility that the point is extreme is if one of or , one of or , and , , and are all active . if and are both active in this setting , their sum implies @xmath296 a contradiction .",
    "if and are simultaneously active in this setting , then the sum @xmath297 yields @xmath298 a contradiction .",
    "therefore , is not active . if and are both active in this setting , then we get a similar result for @xmath299",
    "this implies that we can have at most one of ( [ eqn:42]-[eqn:45 ] ) active , leaving us with too few active constraints for the point to be extreme .",
    "[ [ section-2 ] ]    now consider the case that @xmath300 ; clearly can not be active .",
    "if , , and all are active , they imply @xmath301 which means that and can not both be active by the assumption on lower bounds .",
    "if both and are active together , this implies that is active ; therefore , is not active .",
    "moreover , the discussed active constraints have rank five at this point . by the notes above , and being active imply that and can not be active .",
    "the ( six ) active constraints are linearly dependent , and so the point is not extreme .",
    "the same argument holds if both and are active .",
    "if and both are active , then necessarily is inactive ; summing and yields @xmath302 which says that can not be active from . presume then that is active , leaving us with , , , , , and active .",
    "taking the resulting description for the extreme point represented by this system of active constraints yields @xmath303 , a contradiction .",
    "the same argument holds if and are both active .",
    "[ [ section-3 ] ]    now assume that is not active and that and are active .",
    "then at most one of and can be active , else we imply that @xmath304 which contradicts not being active .",
    "the same holds for and .",
    "also , we can not have both and active , since along with and active they imply @xmath305 therefore , at most five constraints are active , and we are not extreme .",
    "[ [ section-4 ] ]    now @xmath306 and w.l.o.g .",
    "is not active .",
    "our statement at the beginning implies that at most two of ( [ eqn:42]-[eqn:45 ] ) are active .",
    "if is not active , this leaves at most five active constraints , and so the point is not extreme .",
    "[ [ section-5 ] ]    now assume that is not active but is . by the argument in 2.b.i , there are at most six constraints ( , , , , and two of ( [ eqn:42]-[eqn:45 ] ) ) that could be active .",
    "in particular , , , and must be active at an extreme point , so presume they are .",
    "assume for the first case that both and are active .",
    "computing @xmath297 and reducing using the other active constraints yields @xmath307 a contradiction . alternatively , summing , , and yields @xmath308 also a contradiction .",
    "similarly for , , and , as for , , and .",
    "this exhausts all possible combinations of active constraints , and so the point is not extreme .    [",
    "[ piecing - together - direction - wise - formulations ] ] piecing together direction - wise formulations + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    now that we have established that the formulation , when restricted to a single direction , is ideal , it remains to show that the cartesian product of formulations for both directions , along with the restriction @xmath309 , is also ideal . to see this , consider a potential fractional extreme point @xmath285 for the relaxation of the original formulation .",
    "then at least 12 active constraints at such an extreme point , one of which will be .",
    "of the 11 remaining that must exist , there will be one direction for which there are at least six active constraints .",
    "consider three cases .    1 .",
    "the direction with six active constraints has a fractional component in @xmath210 .",
    "then this implies an extreme point for the auxiliary system with fractional component , a contradiction .",
    "2 .   the direction with fractional component ( w.l.o.g .",
    "@xmath25 ) has five active constraints . then those five active constraints , along with , induce a fractional extreme point for the auxiliary system for @xmath25 , a contradiction .",
    "3 .   the direction with fractional component ( w.l.o.g .",
    "@xmath25 ) has fewer than five active constraints .",
    "this implies that there are at least seven linearly independent active constraints for the auxiliary system for @xmath24 , a contradiction ( since its dimensionality is only six ) .",
    "therefore , any fractional extreme point induces a fractional extreme point on , which we have shown is impossible , and so we are done .",
    "while validity of most formulations in this work can be checked directly , the following generic big-@xmath43 formulations approach was instrumental for their construction .",
    "we refer the reader to @xcite for a more detailed exposition of the approach , but include a proof of its validity for completeness .",
    "[ thm : bigm ] take @xmath63 as a compact convex set , @xmath68 $ ] , and @xmath310 distinct vectors @xmath311 .",
    "take any mip formulation @xmath312 for the set @xmath313 , and some affine functions @xmath314 such that @xmath315 where @xmath316{\\mbox{\\normalfont\\tiny\\sffamily def}}}{=}}}\\{x \\in q : a^sx \\leq b^s\\}$ ] .",
    "then    @xmath317    is a valid formulation for @xmath87 ( and , hence , for @xmath75 ) .",
    "it is clear from the definition of @xmath62 that for any @xmath318 , there is some branch @xmath51 such that @xmath319 , and so @xmath320 is feasible for the mip formulation by the construction of the @xmath321 . to show that any feasible solution for the mip formulation lies in @xmath75 ,",
    "consider some feasible @xmath322 for the mip formulation .",
    "then @xmath323 and @xmath324 implies that @xmath325 for some @xmath51 .",
    "then @xmath326 implying that @xmath24 satisfies the corresponding branch @xmath51 of the disjunction @xmath62 .",
    "apply theorem [ thm : bigm ] with @xmath45 , @xmath327 , and @xmath328      the general proof technique is as follows .",
    "first , we will construct the components needed to apply theorem [ thm : bigm ] : namely , a ground set describing shared constraints across all feasible layouts , a disjunction we are interested in modeling , a valid formulation for the codes , and some big-@xmath43 functions that encapsulate the logic between the codes and the branches of the disjunction .",
    "this will leave us with a valid formulation for our set @xmath165 .",
    "we will then do ad - hoc tightening of some of the resulting constraints , giving the system described in .",
    "first , we choose the ground set @xmath169 and the disjunction @xmath147 .",
    "we see that @xmath329{\\mbox{\\normalfont\\tiny\\sffamily def}}}{=}}}\\left\\{(z^y_{i , j},z^x_{i , j},z^y_{j , i},z^x_{j , i } ) \\in \\{0,1\\}^4 : z^x_{i , j}+z^x_{j , i}+z^y_{i , j}+z^y_{j , i } \\geq 1 , \\ : z^x_{i , j}+z^x_{j , i } \\leq 1 , \\ : z^y_{i , j}+z^y_{j , i } \\leq 1\\right\\}\\ ] ] is a valid formulation for @xmath196 .",
    "choose big-@xmath43 functions @xmath330 based on the disjunction @xmath147 in the following way .",
    "take @xmath331 as the @xmath332-th clause defining @xmath333 in section [ sec : refined - disjunction ] ( recall that @xmath334 ) .",
    "for example , @xmath335 . then take @xmath336    note that , when @xmath331 is a statement of the form `` @xmath337 precedes @xmath338 in direction @xmath26 '' , we get the same big-@xmath43 functions as appeared in the unary formulation for the same logic",
    ".    now apply theorem [ thm : bigm ] and recover the valid formulation @xmath339 , where    @xmath340    note that , since the branches of the disjunction share constraints ( and corresponding big-@xmath43 functions @xmath330 ) , many of the resulting constraints will be equivalent and duplicates can be removed .",
    "we now wish to tighten some of these constraints by lifting them in an ad - hoc manner . by the same argument as in the proof for theorem [ thm : unary ] , we may tighten to .    to tighten the new constraints",
    ", we can do a case analysis .",
    "consider @xmath341 , @xmath342 , and @xmath343 ; the others follow analogously .",
    "* reduces to the linear constraint @xmath344 , which follows from @xmath345 .",
    "* we have that in this case @xmath346 and adding @xmath347 to this gives the desired inequality @xmath348 * in this case , we have that @xmath349 we can add @xmath347 to this to get @xmath350 the desired inequality . *",
    "not feasible by .",
    "when using the alternative codes @xmath351 , we may construct a formulation that is quite similar to the one presented in , but with slightly different big-@xmath43 terms :    @xmath352    this formulation , with the addition of the area constraints , forms the basis for the bldp1 formulation from @xcite .",
    "the sequence - pair formulation flp - sp from @xcite may be constructed from with the addition of global constraints on the 0/1 variables , based on observations made by @xcite . in particular , consider an @xmath0 box instance of the flp and the corresponding formulation derived from proposition [ prop : pairwise - to - nbox ] where each pairwise formulation @xmath227 is given by the gray binary formulation .",
    "then the addition of the following constraints yields the flp - sp formulation :    @xmath353    where notationally @xmath354{\\mbox{\\normalfont\\tiny\\sffamily def}}}{=}}}\\begin{cases }          w^{p , q}_k & p < q \\\\          1-w^{p , q}_k & \\text{o.w . }",
    "\\end{cases } \\quad \\forall k \\in \\{1,2\\ } , p , q \\in \\llbracket n \\rrbracket : p \\neq q.\\ ] ]",
    "we prove by enumerating the possible values for the components of @xmath355 having support over the constraint , noting in particular that @xmath356 is always infeasible .",
    "recall also that @xmath357      * sum the constraints @xmath358 and @xmath359 to get the constraint @xmath360 . * using and rearranging gives @xmath361 adding the constraint @xmath362 gives the desired result @xmath363      * want @xmath364 .",
    "since @xmath365 , we must have that either @xmath366 or @xmath367 ; w.l.o.g .",
    "choose the second .",
    "then rearranging from gives @xmath368 * want that @xmath369 , which follows immediately from the upper bounds on @xmath370 .",
    "we prove by enumerating the possible values for the components of @xmath355 having support over the constraint , noting in particular that @xmath356 is always infeasible .",
    "* want to show that @xmath371 but since @xmath372 necessarily ( sum ) it suffices to show that @xmath373 , which follows immediately from summing constraints @xmath374 with @xmath375 to get that @xmath376 . applying this",
    "also for @xmath377 and summing the resulting inequalities gives the result .",
    "* want to show that @xmath378 we have from that @xmath379 ; adding the appropriate constraint in to this gives the result . *",
    "same argument as the previous case .",
    "* want to show that @xmath380 which follows immediately from and the fact that @xmath381 for any feasible solution . * want to show that @xmath382 rearranging gives @xmath383 now summing the relation from with one of gives @xmath384 summing these two derived inequalities with @xmath385 gives the desired result . *",
    "want to show that @xmath386 take the sum of one of and the inequality from to derive @xmath387 furthermore , using our big-@xmath43 value , we have @xmath388 summing the two derived inequalities along with the lower bounds on @xmath370 gives the result .",
    "* want to show that @xmath389 , which is immediate from . *",
    "want to show that @xmath390 from an argument above , @xmath391 for this particular setting , and so we are done by summing this with @xmath392 implied by and using the lower bounds on @xmath370 .      * want to show that @xmath393 which just follows from the fact that @xmath372 and @xmath381 . *",
    "want to show that @xmath394 which follows immediately from the inequality ( valid for this particular setting for @xmath355 ) @xmath387 derived previously . *",
    "same argument as the previous case .",
    "we now present the b2 and v2 inequalities from @xcite in the notation used in the present work .",
    "the b2 inequalities for the unary formulation are of the form @xmath395 the v2 inequalities for the unary formulation are @xmath396 which is equivalent with a potentially tightened coefficient @xmath397 . using proposition [ prop : map - to - refined ] and proposition [ prop : map - from - refined ] , these inequalities may be applied to all the formulations discussed in this work .",
    "the symmetry - breaking described in @xcite works by restricting the possible relative layout between a single pair of components in a modification of the so - called _",
    "position @xmath398 method _ from @xcite .",
    "the scheme chooses a single pair @xmath399 ; in this work , we follow @xcite and choose @xmath400 .",
    "we then may add the following constraints to the refined unary formulation :    @xmath401    using proposition [ prop : map - from - refined ] , these inequalities may be applied to all the formulations discussed in this work .",
    ".relative gap of the relaxation lower bound , with respect to the best known feasible solution .",
    "group # 1 includes ` u ` , ` bldp1 ` , ` bldp1 + ` , ` sp ` , ` sp+ ` , ` sp+vi ` , ` sp+vi3 ` , and ` ru ` .",
    "group # includes ` u+ ` , ` ru+vi ` , and ` ru+vi3 ` .",
    "symmetry breaking from @xcite is added to group # 1 for comparison ( # w/ sb ) ; it does not affect the values for group # 2 . [ cols=\">,^,^,^\",options=\"header \" , ]"
  ],
  "abstract_text": [
    "<S> this material is based upon work supported by the national science foundation graduate research fellowship under grant no . </S>",
    "<S> 1122374 and grant cmmi-1351619 . </S>"
  ]
}