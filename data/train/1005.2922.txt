{
  "article_text": [
    "recent advances  @xcite in numerical simulations of black holes in general relativity have led to many interesting results .",
    "most of these simulations have been carried out with finite - difference methods .",
    "however , the vacuum einstein equations have mathematically smooth solutions ( unless pathological coordinates are chosen ) .",
    "accordingly , one expects that spectral methods should be optimal in terms of efficiency and accuracy .",
    "einstein s equations are a hyperbolic system involving second derivatives in space and time .",
    "however , the numerical solution of hyperbolic systems using spectral methods is normally performed with a fully first - order formulation , even when the equations are naturally higher order . reducing the order of the equations",
    "is usually achieved by introducing new variables defined as first - order time or space derivatives .",
    "the basic impetus for this first - order reduction is that there exists a well - established body of mathematical literature for first - order hyperbolic systems  @xcite , which includes methods for analyzing the well - posedness of the equations and the proper way to impose stable boundary conditions in terms of characteristic variables .",
    "the obvious disadvantage of the first - order reduction is the introduction of additional variables , whose definitions ( at least for spatial derivatives ) become constraints the solution must satisfy and thus new possible sources of instability in the system .",
    "furthermore , each new variable must be evolved , increasing the number of equations and the computational cost of the simulations . in some cases",
    ", this can be a substantial increase .",
    "successful simulations of einstein s equations using spectral methods have thus far been implemented only as first - order reductions of the second - order system  @xcite . in the case of the generalized harmonic form of the equations , the reduction to first order in space proceeds by introducing 30 additional variables , more than doubling the number of equations and constraints in the system  @xcite .",
    "these simulations typically require significant computational time , upwards of a hundred cpu - weeks for high resolution runs  @xcite .",
    "a first order in time , second order in space system has the potential to reduce the constraint - violating instabilities and the computational expense of the simulations .",
    "however , the mathematical knowledge underlying the proper formulation for such systems is much less developed .",
    "recently , gundlach and martn - garca have proposed and analyzed definitions of symmetric hyperbolicity for a general class of second order in space systems  @xcite .",
    "they have also shown how one may define characteristic modes in the second - order system and thereby formulate stable boundary conditions at the continuum level .",
    "there still remains the problem of how to impose the boundary conditions in the discrete system ( using spectral methods ) .",
    "even for the simplest representative hyperbolic system , the second order in space wave equation , naive attempts to impose boundary conditions in the same way as in a first - order formulation generally fail .",
    "the difficulty is not due solely to the presence of second derivatives .",
    "for example , methods exist for treating the second order spatial derivatives in the navier - stokes equations directly using spectral methods  @xcite . however",
    ", these techniques do not apply to the wave equation , as the characteristic structure is fundamentally different . in this work",
    ", we present a new method for imposing boundary conditions in the second - order wave equation that is robust , stable , and convergent .",
    "since the generalized harmonic form of einstein s equations appears as ten nonlinear coupled wave equations , this work provides a foundation for solving einstein s equations directly in second - order form using spectral methods .",
    "this application will appear in a subsequent paper  @xcite .",
    "it is likely that the work presented here will also allow other formulations of einstein s equations , such as the bssn ( baumgarte - shapiro - shibata - nakamura ) formulation , to be treated by spectral methods without reduction to first - order form .    in section  [ fosh1d ]",
    "we review a typical spectral method for evolving the fully first - order form of the one - dimensional wave equation .",
    "we review how boundary conditions can be imposed using penalty methods  @xcite and how stability of the system can be analyzed with energy methods  @xcite . in section  [ mainresult ]",
    "we present the new penalty method for the one - dimensional second order in space wave equation and prove stability of the system using energy arguments . in section  [ 3dswf ]",
    "we generalize the method to three dimensions , and in section  [ 3dswc ] we apply the method to the case of a scalar wave on a curved background .",
    "we begin with the one - dimensional wave equation = ^ , [ 1dwave ] where @xmath0 . here ,",
    "dots denote differentiation with respect to @xmath1 , while primes denote differentiation with respect to @xmath2 .",
    "we will first review a typical first - order pseudo - spectral method for evolving this equation before discussing the second - order formulation .",
    "the wave equation in eq .",
    "reduces to first order by introducing the variables @xmath3 and @xmath4 where    & - , [ pidef1 ] + & ^. [ 1dvarphi ]    the negative sign in the first equation is purely a matter of convention .",
    "the first - order system is thus    & = - , [ 1deq1 ] + & = -^ , [ 1deq2 ] + & = -^. [ 1deq3 ]    equation   is just the definition of @xmath3 , while the definition of @xmath5 in eq .",
    "amounts to the addition of a constraint @xmath6 to the system , where ^- .",
    "the characteristic variables @xmath7 and speeds @xmath8 for this system ( see e.g.  ref .",
    "@xcite ) are    u_= & , & & = 0 , + u_= & n^x , & & = 1 .",
    "[ upmdef1d ]    here , @xmath9 is the unit outgoing normal vector to the boundary , which in one dimension is just @xmath10 . with",
    "this definition , @xmath11 is incoming ( @xmath12 ) at each boundary .    for a symmetric hyperbolic system on a domain @xmath13 with boundary @xmath14",
    ", there exists a ( not necessarily unique ) conserved , positive definite energy e= _ dv , which is conserved in the sense that = _ if^i .",
    "[ fluxdef ] accordingly , the time derivative of the energy is given by the flux through the boundary , e = _ f^n da , where @xmath15 .",
    "note that for general quasi - linear systems , the energy is only strictly conserved when coefficients in the equations are approximated as constant and lower - order terms are neglected .",
    "for the one - dimensional wave equation in eqs .",
    "- , the energy density is = ( ^2 + ^2 ) .",
    "[ 1denergy ] using eqs .  ,  ,  , and  , we get f^x = -= ( u_-^2 - u_+^2 ) . if we consider our domain to be the interval @xmath16 $ ] , then e =",
    "_ x=1 ( u_-^2 - u_+^2 ) .",
    "[ 1dflux ] for well - posedness and stability , one requires that the growth of the energy be controlled by specifying boundary conditions for the positive terms in @xmath17 .",
    "therefore , a boundary condition must be supplied on the incoming mode @xmath11 .",
    "for example , with a homogeneous condition specifying @xmath18 ( or more generally @xmath19 for @xmath20 ) , it follows that @xmath21 . together with the positive definiteness of the energy",
    ", this ensures that the system is stable .",
    "if instead the incoming mode is a prescribed function @xmath22 , then we still have stability in the sense of controlling the energy with a bound that involves @xmath23 .    the definition of energy given by eq .",
    "is not unique , but was motivated in part by a desire to obtain a sharp energy bound .",
    "for example , we could have defined the energy density with a term @xmath24 as = ( a^2 ^ 2 + ^2 + ^2 ) . in this case",
    ", we would obtain the additional term in @xmath17 -_a^2dv _",
    "( a^2 ^ 2 + ^2 ) dv , where the inequality follows from the relation @xmath25 for any ( real ) @xmath26 .",
    "we would thus arrive at the weaker estimate e _",
    "x=1 ( u_-^2 - u_+^2 ) + ae .",
    "[ psi2flux ] with a condition on the incoming mode @xmath11 to control the boundary term on the right - hand side , the system is still well - posed in this case  @xcite , but we are unable to prove stability in the sense that @xmath21 .    in the semi - discrete problem ,",
    "one considers the discretization in space but not time . an effective way to impose boundary conditions in the semi - discrete system is to add appropriate penalty terms to the equations on the boundaries .",
    "such a penalty method thus imposes conditions `` weakly''that is , approximately , without completely replacing the equation of motion on the boundary  @xcite .",
    "heuristically , the rationale for this is that it is not necessary to enforce exact boundary conditions on approximate solutions .",
    "all that is required is for the discrete solution to converge to the continuum solution with the correct boundary conditions as the resolution is increased .",
    "we find that these methods generally yield superior accuracy and convergence while also providing a simple way to impose arbitrary boundary conditions .",
    "the penalties are added to the equations on the boundary in the form @xmath27 , so that if the boundary condition @xmath28 is satisfied then the penalties vanish . the appropriate penalty ( up to an overall coefficient ) for each equation",
    "can be found by projecting the boundary conditions in terms of characteristic variables to fundamental variables  @xcite .",
    "in other words , we first transform to characteristic variables in the first - order system of eqs .  - on the boundary and",
    "add penalties :    u_&= -(u_+ + u_- ) , + u_+ & = -n^xu_+^ , + u_- & = + n^xu_-^+ c(u_-^ - u_- ) ,    where @xmath29 is an undetermined constant .",
    "only the equation for @xmath30 has a penalty term , since there is no boundary condition on @xmath31 or @xmath32 .",
    "we then transform back to fundamental variables to obtain the first - order equations with penalties :    _ i = & -_i , [ fosh1 ] + _ i = & -_i^+ ( _ i0+_in)(u_-^ - u_- ) , [ fosh2 ] + _ i = & -_i^- n^x ( _ i0+_in)(u_-^ - u_- ) .",
    "[ fosh3 ]    here we have explicitly denoted grid values with a subscript @xmath33 . for a pseudo - spectral method , one chooses the nodes of a gaussian quadrature rule as collocation points .",
    "the @xmath34 grid points @xmath35 run from @xmath36 to @xmath37 .",
    "differentiation is implemented by matrix multiplication , as in @xmath38 , where @xmath39 is the first - order differentiation matrix .",
    "the kronecker delta terms @xmath40 indicate that the penalties are applied only on the boundaries at @xmath41 .",
    "the penalty coefficients should satisfy @xmath42 as @xmath43 , in order to ensure that the continuum equations and boundary conditions are recovered in this limit  @xcite .",
    "suitable values for the penalty factor @xmath29 in eqs .  - can be determined from a semi - discrete energy analysis , which we will now show . for ease in obtaining analytical results ,",
    "we choose _ gauss - legendre - lobatto _ collocation points ( see appendix  [ appgllnotes ] for details ) .",
    "the basis functions for this choice are the legendre polynomials @xmath44 on @xmath16 $ ] .",
    "we begin by writing the semi - discrete energy corresponding to eq .  :",
    "e = , [ foshsde ] where @xmath45 represents a discrete inner product , as in , _ i=0^n _ i _ i^2 . here",
    "@xmath46 are the grid values of the function @xmath3 , and @xmath47 are the quadrature weights ( see appendix  [ appgllnotes ] ) . taking the time derivative of the semi - discrete energy in eq .  , we obtain    e = & -_i _",
    "i |_i=0^n + , ( _ i0+_in)u_- + & - , ( _ i0+_in)n^xu_- , [ fosheeq1 ]    where we have used summation by parts ( the discrete analogue of integration by parts ) in the first term and introduced the notation @xmath48 in the penalty terms . the first term in eq .",
    "is similar to the continuum result : -_i _ i    in the last two terms in eq .   yields e _ = _",
    "i=0,n u_- u_- , where we have written @xmath49 for the quadrature weight @xmath50 at @xmath51 . noting that u_-u_- = ( u_-^^2 - u_-^2 - u_-^2 ) , we put things together to find e = _ i=0,n .",
    "[ foshedot ] the condition on the penalty factor @xmath29 for stability depends on the boundary condition we impose on @xmath52 . requiring @xmath21 , we find :    u_-^ & = 0 c , + u_-^ & = u_+ c ,    where @xmath53 .",
    "the strictest condition is obtained by insisting that the energy be bounded by the continuum energy in eq .   for arbitrary @xmath52",
    ": e e _ c=. [ ccond ]    the situation is slightly different when considering the semi - discrete energy for a multi - domain problem .",
    "for example , suppose we consider the interval @xmath54 $ ] with an inner boundary at @xmath55 .",
    "the energy calculation up to eq .   is identical on each subdomain .",
    "the key difference is that now the incoming mode at the interface boundary is supplied by the adjacent subdomain .",
    "if we denote the intervals @xmath56 $ ] and @xmath57 $ ] with subscripts @xmath58 and @xmath59 , respectively , then at @xmath55 :    u_1-^ & = u_2 + , + u_2-^ & = u_1 + .",
    "the terms in @xmath17 at @xmath55 are then :    & ( 1-c)u_1-^2 - ( 1-c)u_1+^2 - c u_1-^2 + + & ( 1-c)u_2-^2 - ( 1-c)u_2+^2 - c u_2-^2 .",
    "this quadratic form is negative semi - definite if and only if @xmath60 . on a multi - domain problem ,",
    "the value of @xmath29 at an internal boundary required for stability is therefore fixed , regardless of the boundary condition imposed at the external boundaries .",
    "this analysis assumes that the penalties at the interface boundary enforce conditions only on the incoming modes .",
    "it is also possible to penalize arbitrary combinations of the variables at interfaces and thereby to obtain different stability conditions ( see e.g.  ref .",
    "@xcite ) , but we do not consider this refinement here .    on an arbitrary domain ,",
    "the definition of the discrete inner product is modified .",
    "for instance , if we consider a one - dimensional domain @xmath13 with a coordinate mapping @xmath61 \\rightarrow \\omega$ ] , then the jacobian of the mapping is inherited from the continuum inner product : f , g _",
    "i f_i g_i ^_i .",
    "[ 1dmodip ] since the penalty terms in eq .",
    "contain kronecker deltas that pick out specific terms from the sums , the values for @xmath29 we obtain would need to be modified by a jacobian factor : @xmath62 . for simplicity",
    ", we will assume that the domain is the fundamental interval @xmath16 $ ] unless otherwise stated , so that no jacobians are needed .",
    "although we performed the semi - discrete energy analysis on legendre grid points , this is not a limitation .",
    "one could implement the system on gauss - chebyshev - lobatto points using , for example , the chebyshev - legendre method  @xcite . with this method ,",
    "the equations are implemented on a chebyshev grid by interpolating the ( legendre - grid ) penalty functions to the chebyshev points .",
    "in particular , a penalty that is applied only on the boundary of a legendre grid as in eqs .  - would in general be non - zero everywhere on a chebyshev grid . in practice ,",
    "the system works well even without modification on a chebyshev grid by simply using eqs .  - as derived for a legendre grid and letting the index @xmath33 represent the chebyshev grid points .",
    "chebyshev stability of penalty methods is proved in ref .",
    "@xcite for simple cases , and proofs of chebyshev stability for more general hyperbolic problems are reviewed in ref .",
    "@xcite .",
    "it is also worth noting that stability conditions derived from strict energy arguments can generally be relaxed to a degree .",
    "the penalty factor @xmath29 , which was found to be @xmath63 for legendre methods , can be optimized by trial and error to maximize efficiency and obtain the least restrictive _ courant - friedrichs - lewy _",
    "( cfl ) condition while maintaining stability .",
    "this is discussed , for example , in ref .",
    "@xcite .",
    "stability of the _ fully _ discrete problem can be explored by examining eigenvalues .",
    "the entire system is written in a form suitable for passing to an explicit time - stepping algorithm , as in @xmath64 , where the vector @xmath65 represents the grid values of all the fields .",
    "the eigenvalues of the matrix @xmath66 can then be plotted in the complex plane and compared with the stability region of the time - stepper . in general ,",
    "positive real parts of the eigenvalues imply instability , while the spectral radius ( maximum amplitude of eigenvalues ) is inversely proportional to the maximum allowed time - step  @xcite ( the exact relation depends on the time - stepping algorithm being used ) .    a typical eigenspectrum for the system in eqs .  - on two subdomains",
    "is shown in fig .",
    "[ fg : evalues ] .",
    "curiously , the large amplitude conjugate pair of eigenvalues on chebyshev points is absent on the legendre grid .",
    "this implies that there is a less restrictive cfl condition for the system on legendre grid points , and this is indeed the case for this particular system .",
    "as is discussed elsewhere , it is unlikely that this difference carries over to more general systems  @xcite .",
    "for instance , we find no significant difference in time - stepping conditions on chebyshev or legendre grids for the _ three - dimensional _ wave equation ( in flat or curved space ) .",
    "it is also worth noting that eigenvalue stability is insufficient to prove that the system is actually stable and convergent , but it is suggestive  @xcite .    [ cols=\"^,^ \" , ]      the first order in time , second order in space formulation of the one - dimensional wave equation in eq .",
    "is    = & - , + = & -^.    the characteristic variables are the same as those of the first - order reduction with the replacement @xmath67 :    u_= & , & & = 0 , + u_= & n^x^ , & & = 1 ,    the energy and flux are the same as well : = ( ^2 + ^^2 ) e = _ x=1 ( u_-^2 - u_+^2 ) .",
    "[ 1decont ] the difficulty arises in the semi - discrete second - order system when trying to find appropriate penalties by projecting from characteristic variables , as was done in the first - order case .",
    "the boundary condition @xmath68 is now a _",
    "differential _ as opposed to an _ algebraic _ condition : - n^x ^= u_-^. one therefore obtains a condition on @xmath69 at the boundary , but not on @xmath70 itself ( there is no boundary condition on @xmath31 ) .",
    "the system one arrives at by naively following the same procedure as in the first - order case is    _ i = & -_i , [ fotsos1 ] + _ i = & -_i^ + c(_i0+_in)u_- .",
    "[ fotsos2 ]    we might try applying a penalty to eq .   also :    _ i = & -_i + c_1 ( _ i0+_in)u_- , [ fotsos3 ] + _ i = & -_i^ + c_2(_i0+_in)u_- .",
    "[ fotsos4 ]    these equations are generally unstable , particularly when evolved on multiple subdomains with at least one interface boundary .",
    "the error in @xmath70 tends to grow exponentially , ruining the evolutions within a few hundred crossing times .",
    "the penalty factors @xmath71 can be fine - tuned by trial and error to obtain approximately stable evolutions in some cases , but not robustly so .",
    "figure  [ fg : evalues ] shows a typical eigenspectrum for the system in eqs .  - on two subdomains .",
    "the eigenvalues with positive real parts clearly indicate instability .      we will now derive a way to impose penalty boundary conditions in the second - order system that yields a robust , stable result .",
    "for the semi - discrete problem , we once again choose gauss - legendre - lobatto collocation points .",
    "we begin by writing the second - order equations in the form    _ i = & -_i + p , [ undeteq1 ] + _ i = & -_i^ + q , [ undeteq2 ]    where @xmath72 and @xmath73 represent as yet undetermined penalties . the semi - discrete energy is e = . [ 1denergy ] taking the time derivative , we find e = - _",
    "i^_i |_0^n + _",
    "i^ p_i |_0^n + , q - ^,p , [ eeq1 ] where we have used summation by parts in the first two terms .",
    "the first term is like the continuum result : - _ i^_i |_0^n = _ i=0,n ( u_-^2 - u_+^2 ) .",
    "[ contpart ] since the projection of boundary conditions from characteristic to fundamental variables is unambiguous in the variable @xmath3 , we will write the penalty @xmath73 as in eq .  : q = ( _ i0+_in ) u_- , where @xmath74 is an undetermined constant and @xmath49 is the quadrature weight at @xmath51 .",
    "the factor @xmath75 is explicitly written in anticipation of its cancellation when evaluating the third term in eq .  : , q = a _ 0 u_-^0 + a _",
    "n u_-^n . if we also choose the penalty @xmath72 in eq .   to have a similar value on the boundary p",
    "= a u_- , [ pbdry ] then the second and third terms in eq .",
    "combine to form the expression _",
    "p_i    @xmath72 on the boundary with a factor of @xmath75 , because the second term in eq",
    ".   arises out of summation by parts as opposed to being picked out from the discrete sum by a kronecker delta .",
    "the stumbling block in this energy analysis is the last term in eq .",
    ", whose appearance is inevitable because of the derivatives in the definition of energy in eq .  .",
    "such a term did not arise in the first - order energy estimate , precisely because the first - order energy in eq .",
    "did not contain any derivatives .",
    "fortunately , it turns out we can eliminate the inner product @xmath76 by allowing the penalty @xmath72 to be non - zero throughout the domain and by constructing it to be orthogonal to @xmath77 .    the scalar field @xmath70 in the semi - discrete solution is an interpolating @xmath78-order polynomial  @xcite .",
    "therefore , @xmath77 is an @xmath79 order polynomial , and the product @xmath80 is at most a polynomial of order @xmath81 .",
    "it follows that the quadrature integral is exact : ^,p = _",
    "-1 ^ 1 ^(x)p(x)dx .",
    "this inner product will automatically vanish if the penalty @xmath72 is a linear combination of the legendre polynomials @xmath82 and @xmath83 , which are orthogonal to any polynomial of degree @xmath79 or less .",
    "we are therefore provided with two degrees of freedom for constructing the function @xmath72 , which is sufficient to satisfy the boundary values defined in eq .  .",
    "we make use of the following polynomials , constructed to take the values @xmath84 at @xmath51 :    f(x ) = & ( -1)^n , [ fdef ] + g(x ) = & .",
    "[ gdef ]    if we now define the penalty @xmath72 to be p = p_0f(x ) + p_ng(x ) , [ pdef ] where @xmath85 and @xmath86 represent the endpoint values of eq .",
    ", then the penalty function @xmath72 will have the correct boundary values while also satisfying ^ , p = 0 .",
    "putting things together , we now obtain e = _",
    "i=0,n , [ 1dedota ] which is just like eq .   for the first - order system with @xmath87 .",
    "the conclusions reached previously for @xmath29 therefore carry over : a multi - domain problem with arbitrary outer boundary conditions is stable only if @xmath88 .",
    "the second - order system with penalties is thus    _ i = & -_i - , [ fotsosg1 ] + _ i = & -_i^ + .",
    "[ fotsosg2 ]    of course , one needs to be concerned not only with _ stability _ , but also _",
    "consistency_that is , the system should reproduce the continuum equations in the limit as @xmath89 .",
    "the penalty @xmath72 on the @xmath90 equation in eq .",
    "is applied throughout the domain and not only on the boundaries .",
    "moreover , it does not scale as @xmath91 , so consistency might seem dubious .",
    "however , the penalty on @xmath92 in eq .",
    "does scale as @xmath91 and is applied only on the boundaries .",
    "therefore , the condition @xmath93 on the boundary as @xmath89 is enforced .",
    "this also implies @xmath94 in turn , so consistency follows .",
    "although the second - order energy argument was performed on legendre points , the equations can be implemented on any grid , just as in the first - order system discussed in section  [ fosh1d ] .",
    "eigenvalues of the fully discrete system imply stability here as well , as shown in fig .",
    "[ fg : evalues2 ] for a representative two - domain problem .",
    "the spectral radius is somewhat larger than in the first - order spectrum in fig .",
    "[ fg : evalues ] . however , we find that differences in cfl conditions essentially disappear for more general systems , including the three - dimensional wave equation in flat or curved space .",
    "$ ] , with an inner boundary at @xmath55 , outer boundary conditions @xmath95 , and @xmath96 grid points per subdomain . results for legendre- and chebyshev - lobatto grids are shown for comparison . ]",
    "let us now consider the three - dimensional second order in space wave equation    = & - , + = & -_i^i .",
    "the characteristic modes and speeds of this system are    u_= & , & & = 0 , [ upsidef ] + u_= & n^i_i , & & = 1 , [ upmdef ] + u^0_i = & _ i- n_i n^j_j , & & = 0 , [ u0def ]    where @xmath97 is the outward - directed unit normal to the boundary .",
    "these are the same as the characteristic variables of the first - order system obtained by defining @xmath98 .",
    "usually , one thinks of characteristic variables as being defined only for first - order systems , but they can be generalized to second - order systems .",
    "one way to do this is to define the second - order modes as those combinations @xmath7 of variables @xmath99 that satisfy u = -n^i _ i u +  , [ fotsoscharvar ] where the dots represent derivatives transverse to @xmath97 plus lower order terms  @xcite . as a consequence of this definition , the transverse derivatives @xmath100 are automatically zero - speed modes ( in fact",
    ", they can be given arbitrary speeds ) .",
    "moreover , the characteristic variables in eq .",
    "are unique only up to addition of these zero - speed modes .",
    "for example , we could redefine @xmath101 as @xmath102 for arbitrary ( fixed ) @xmath103 . as discussed in ref .",
    "@xcite , this ambiguity is removed for a symmetric hyperbolic system by requiring the existence of a conserved energy that is quadratic in the modes . here , that amounts to taking the definitions in eqs .  - as they are .",
    "the conserved energy density is = ( ^2 + ^i_i ) .",
    "[ 3dswfenergy ] note that this energy is indeed quadratic in terms of the characteristic modes : = ( u_+^2 + u_-^2 ) + u^0iu^0_i . in analogy with the one - dimensional case in eq .  , the flux is e = _",
    "( u_-^2 - u_+^2)d^2x , where @xmath104 represents the boundary of the domain .",
    "now consider the semi - discrete problem in three - dimensions .",
    "we encounter a few issues in generalizing from the one - dimensional case .",
    "for one , if the boundary of the domain contains edges or corners , the normal vectors there ( and hence characteristic modes ) are not well - defined . for reasons that will become clear below",
    ", we resolve this ambiguity by defining the normal vectors as follows .",
    "we will use upper case @xmath105 and lower case @xmath106 to denote the unnormalized and unit normal vectors , respectively . for simplicity ,",
    "suppose the domain @xmath13 is a cube with @xmath107 $ ] . on boundary faces ( codimension @xmath58 ) ,",
    "one coordinate is fixed ( e.g.  the @xmath108 face ) .",
    "we define face normals on a boundary with a fixed @xmath109 coordinate as = _ j _ k *",
    "n * , where @xmath110 and @xmath111 are the quadrature weights ( see appendix  [ appgllnotes ] ) corresponding to the two free dimensions , and @xmath106 is the usual ( cartesian ) unit normal vector in the @xmath112 direction . on edges and corners ,",
    "the normal vector is defined to be the sum of the normals to the adjacent boundary faces .",
    "for example , the normal vector at the corner @xmath113 is defined to be = _ y _ z * x * + _ x _ z * y * + _ x _ y * z*. [ normal ] the second - order system with penalty functions @xmath114 is    = & -+ p , [ 3deq1 ] + = & -_i^i+ q , [ 3deq2 ]    where for conciseness we have suppressed indices representing grid values ( e.g.  @xmath115 ) . consider the semi - discrete energy e = .",
    "[ 3dsde ] the computation of @xmath17 proceeds analogously to the one - dimensional case , except for complications due to the corners and edges . to see this ,",
    "consider the following term that arises in taking the time derivative of eq .  :",
    "^i , _ i _ i , j , k _",
    "i_j_k ^l _ l .",
    "[ 3dedotpart ] we use summation by parts in this expression and obtain three boundary terms  one for each @xmath116 .",
    "for example , from @xmath117 we get ^z,_z= _ i , j _ i_j_z=-1^+1 - ^z_z , .",
    "each point on an edge receives a contribution from two such boundary terms , while points on corners get a contribution from all three . on the cube at the corner point @xmath118 , for example ,",
    "the value obtained is ( _ x_y_z+ _ x_z_y+ _ y_z_x ) .",
    "[ cornerterm ] we would like to be able to write this in terms of characteristic modes as n^i_i= ( u_+^2 - u_-^2 ) , and this is precisely the reason for the definition of normal vectors on edges and corners given above .",
    "thus , eq .   can be written ^i , _",
    "i = _ |*n*| ( u_+^2 - u_-^2 ) - ^i_i , , [ 3dcontpart ] where the sum is over all boundary points , including edges and corners .",
    "the magnitude of the normal vector @xmath119 encodes the appropriate quadrature weight factors for boundaries of any codimension .    in a similar way , the terms in @xmath17 due to the penalty @xmath72 in eq .",
    "can be written ^i , _ i p = _",
    "|*n*| n^i_i p - ^i_i , p .",
    "the penalty @xmath73 in eq .   is applied only on the boundary , where it takes the value q| _",
    "= u_- . on a boundary face with fixed @xmath112-coordinate ,",
    "this reduces to q = u_- , just as in the one - dimensional system . assuming the boundary values of @xmath72",
    "satisfy p|_= -u_- , [ 3dpbdry ] the penalty contributions to @xmath17 combine to give e _ = _",
    "| * n * | u_- u_- - ^i_i , p . with everything included",
    ", the energy flux is e = _ |*n*| ( u_-^^2 - u_+^2 - u_-^2 ) - ^i _ i , p . [ 3dedot ] we would like to eliminate the last term with an appropriate choice of bulk penalty function @xmath72 , as was done in the one - dimensional case .",
    "the most obvious generalization of the one - dimensional approach would be to construct @xmath72 out of polynomials @xmath120 satisfying @xmath121 . unfortunately , this can not be done .",
    "there are in general only about @xmath122 such functions @xmath120not enough to satisfy @xmath123 boundary conditions ( a proof is provided in appendix  [ appdofproof ] ) .",
    "alternatively , one could seek a solution by allowing the penalty @xmath72 to depend explicitly on the scalar field @xmath70 .",
    "one way of doing this is to split the offending inner product term of eq .   into contributions from the boundary and the interior of the domain : , p = , p | _ + , p | _ , [ innerprodsplit ] where @xmath124 .",
    "considering the values of @xmath72 on the boundary to be specified by eq .  , the first term on the right - hand side of eq .",
    "we can then define @xmath72 on the interior of the domain to be p _ - , [ normp ] provided @xmath125 . with this definition , the discrete sum over the interior cancels the sum over the boundary in eq .",
    ", and the inner product @xmath126 vanishes .",
    "if @xmath127 , we can not use eq .  ,",
    "but in this case there would be no need since then @xmath128 .",
    "one way this recipe could fail is if @xmath129 vanishes on the interior of the domain but not on the boundary , although we believe this to be very unlikely in an actual numerical simulation .",
    "we find that while this method yields stability , it suffers from lack of convergence as resolution is increased .",
    "however , as we have not experimented extensively with approaches like this , further investigation may be worthwhile .    abandoning any explicit dependence on @xmath70 in the penalties ,",
    "we seek instead to construct @xmath72 so as to _ minimize _ the inner product @xmath130 of eq .  .",
    "it turns out this can be done by using a penalty constructed out of the same functions @xmath131 defined in eqs .  - for the one - dimensional problem . here",
    "we will give a summary of the result ; a derivation is provided in appendix  [ appbulkpenalty ] .",
    "we define one - dimensional functions @xmath131 along each dimension and write their grid values as @xmath132 , @xmath133 , @xmath134 ( and similarly for @xmath135 ) . assuming the values of the penalty function @xmath72 on the domain boundary @xmath104 are given , the grid values on the interior of the domain are    p_ijk = & p_0jkf_i + p_njk g_i + p_i0kf_j +  [ bulkp ] + & - p_00kf_i f_j - p_n0k g_i f_j -  + & + p_000f_i f_j f_k + p_n00 g_i f_j f_k +     the bulk penalty picks up a contribution from each boundary face , edge , and corner .",
    "the assumption of a cubic domain is not a limitation , as it is straightforward to generalize this procedure to other domains . with this choice of penalty ,",
    "@xmath17 is again given by eq .",
    ", and the last term in eq .",
    "vanishes in the limit @xmath136 ( see the discussion at the end of appendix  [ appbulkpenalty ] ) .    therefore , while not strictly stable , the system is _ asymptotically _ stable .",
    "collecting results , we conclude that the second - order system is    = & -- u_- , [ 3deq3 ] + = & -_i^i+ u_- , [ 3deq4 ]    where the penalties represent boundary values , the penalty on the first equation is applied throughout the interior of the domain via eq .  , and",
    "the normal vector @xmath105 is defined as in eq .  .      the three - dimensional wave equation in eqs .  - with bulk penalty given by eq",
    "is found to be robust , stable , and convergent in all of our tests .",
    "we have run simulations on multiple spherical shell , cylindrical shell , and cubic subdomains . as an example , fig .",
    "[ fg : flatconv ] shows the @xmath137 error ( maximum nodal error ) of a sinusoidal plane wave propagating through a domain consisting of @xmath138 cubic subdomains .    in this example ,",
    "only the boundary - face part of the bulk penalty in eq .   is used , and normal vectors are defined as in eq .  .",
    "empirically , we find that the bulk penalties associated with edges and corners are not needed in this example .",
    "the incoming mode at an interface boundary is supplied by the adjacent subdomain , while at outer boundaries it is computed from the analytical solution .",
    "time - stepping is performed using an explicit fourth - order runge - kutta method .",
    "the results of an equivalent first - order evolution are plotted for comparison .",
    "error of a plane wave @xmath139 evolved using the second - order system ( solid green ) .",
    "results of equivalent first - order evolutions are plotted for comparison ( dashed blue ) .",
    "the domain consists of @xmath138 identical cubic subdomains covering the region @xmath140 $ ] , and the successive resolutions have @xmath141 , and @xmath142 legendre - lobatto grid points per subdomain along each dimension . in this test , @xmath143 and @xmath144 .",
    "the @xmath137 error is a moving average over an interval @xmath145 , which includes @xmath146 data points . ]",
    "a few empirical observations are worth noting . in practice , we find that the bulk penalty terms arising from edges and corners in eq .   are not actually necessary for obtaining stable , convergent evolutions . in all the tests we have performed for scalar waves in flat space , the terms due to the faces of the boundary are sufficient",
    "however , the additional terms in eq .   may need to be included for complicated domain decompositions or in curved space applications .",
    "for more general systems of quasi - linear wave equations ( such as einstein s equations in generalized harmonic form  @xcite ) , we find that it is sometimes necessary to include a boundary term enforcing continuity of the field @xmath70 in the penalty .",
    "that is , one makes the replacement @xmath147 in the penalties . in the tests that we have performed ,",
    "this is not required for a simple wave equation in flat ( or curved ) space .",
    "an alternative to defining unique normal vectors on corners and edges is to use a so - called multi - penalty method . with a multi - penalty method , boundary conditions ( and hence penalties ) on edges and corners",
    "are defined to be the sum of those from the adjacent boundary faces .",
    "while this has the advantage of avoiding some of the issues with corners and edges , it makes obtaining analytical results such as eq .   more difficult .",
    "although we have not yet fully tested this alternative in curved space applications , we find that the multi - penalty method performs equally well for scalar waves in flat space .",
    "in this section we consider the application of the new penalty method to the evolution of a scalar wave on a fixed , curved background spacetime : _",
    "^= 0 , [ curvedwaveeq ] where @xmath148 is the four - dimensional covariant derivative . in rewriting this equation as a first - order system",
    ", we use the standard @xmath149 splitting of the metric : ds^2 = -^2 dt^2 + _ ij(dx^i + ^i dt)(dx^j+^j dt),[3p1metric ] where @xmath150 is the lapse function , @xmath151 is the shift , and @xmath152 is the three - dimensional metric intrinsic to the constant time spatial hypersurfaces .",
    "it is assumed that @xmath153 and that the three - metric @xmath152 is positive definite .    the wave equation in eq .",
    "can be rewritten in a standard way  @xcite as the first - order system    = & -+ ^i_i , [ foshcurvedeq1 ] + = & -^ij_i_j + ^i_i+ k + j^i _ i , [ foshcurvedeq2 ] + _ i = & - _ i - _ i + _ k_i^k + ^k_k _ i. [ foshcurvedeq3 ]    equation   is just the definition of the variable @xmath3 . as usual ,",
    "the spatial derivative variable is defined as _ i _ i .",
    "the quantities @xmath154 and @xmath155 in eq .   are purely functions of the background spacetime :    k & - , + j^i & - _ j ( ^1/2^ij ) ,    where @xmath156 in deriving eq .  , the equivalence of interchanging indices in _",
    "i_j = _ j _ i has been assumed .",
    "this reduction to first order has therefore introduced two constraints to the system : @xmath157 , where    _ i & _ i - _ i , [ con1 ] + _ ij & _ i_j - _ j_i.[con2 ]    the second - order in space equations are    = & -+ ^i_i , [ curvedeq1 ] + = & -^ij_i_j+ ^i_i+ k + j^i _ i. [ curvedeq2 ]    this system avoids the introduction of the constraints in eqs .  - as well as the third set of evolution equations in eq .  .",
    "the characteristic variables and speeds of the second - order system are the same as those of the equivalent first - order reduction with @xmath158 :    u_= & , & _ 0 & = -n^k_k [ upsidefswc ] + u_= & n^i_i , & _ & = - n^k_k , [ upmdefswc ] + u^0_i = & _ i- n_i n^j_j , & _ 0 & = -n^k_k,[u0defswc ]    where @xmath97 is the outward - directed unit normal vector to the boundary of the three - dimensional spatial domain .",
    "these are the same as the characteristic modes of the scalar wave in flat space in eqs .  - , with modified characteristic speeds .",
    "as discussed in section  [ 3dswf ] above , the `` zero - speed '' modes @xmath100 can be considered to have arbitrary speeds in the second - order system  @xcite .",
    "the speeds @xmath159 given above are chosen to be the same as those of the corresponding first - order system . additionally , these are the coefficients that appear in the boundary flux of the energy , and in this sense they are the preferred choice .",
    "the energy density for this system is the same as for the flat space scalar wave in eq . :",
    "= ( ^2 + ^i_i ) .",
    "[ curvedeps ] the energy flux is found by computing the time derivative of the energy e = _",
    "^1/2 d^3x , where @xmath13 is the spatial domain under consideration and @xmath160 is the volume element .",
    "in addition to a boundary flux , differentiating the energy gives rise to volume terms that depend on various derivatives of the background ( @xmath161 , or @xmath162 ) .",
    "however , these volume terms can all be bounded by multiples of the energy itself ( or neglected entirely in the constant - coefficient approximation ) , which is all that is required for proving well - posedness .",
    "one therefore obtains e - _ f^n ^1/2 d^2x + ke , [ edotswc ] for some constant @xmath163 .",
    "the flux integrand is f^n = _ - u_-^2 + _",
    "+ u_+^2 + 2 _ 0 u^0ju^0_j , [ fluxswc ] and the element of area in eq .",
    "is @xmath164 , where @xmath165 and @xmath166 is the intrinsic metric on the boundary surface .",
    "the continuum problem is therefore well - posed with boundary conditions that control incoming modes ( those with @xmath12 ) . for a timelike boundary , a boundary condition is needed on @xmath11 and possibly on @xmath100 , depending on the sign of @xmath159 .",
    "for a spacelike boundary , either all modes are incoming , or all modes are outgoing and no boundary conditions are required ( e.g.  on an excision boundary inside the horizon of a black hole ) .    we could also have included a term @xmath167 in the energy density , replacing eq .   by = ( a^2 ^2 + ^2 + ^i_i ) .",
    "[ curvedepspsi2 ] this would give an additional term in @xmath17 : _",
    "a^2 ^1/2 d^3x = _ a^2 ( ^i_i-)^1/2 d^3x.[swcpsi2epart ] integrating by parts in the first term on the right - hand side yields _",
    "n_i^i ^2 ^1/2 d^2x - _ ^2 _ i ( ^i ^1/2 ) d^3x . [ psi2bdryflux ] the latter term in this expression can be bounded by a multiple of the energy , while the first term contributes to the boundary flux .",
    "it may seem , then , that including the term @xmath167 in the energy density would require the flux @xmath168 of eq .   to be modified .",
    "however , the entire right - hand side of eq .",
    "can in fact be bounded in the volume . making use of the relation @xmath169",
    ", we find    _ a^2 ( ^i_i- & ) ^1/2 d^3x + & a ( _ + || _ ) e. [ psi2inequality ]    the addition of a term @xmath24 to the energy density therefore requires the constant @xmath170 in eq .   to be modified , but not the flux @xmath168 .",
    "consequently , our conclusions about well - posedness and boundary conditions remain unchanged .",
    "it is interesting to note , however , that the same does not hold for the first - order system of eqs .",
    "- , because the first - order energy corresponding to eq .",
    "controls @xmath171 , but not @xmath172 ( and therefore the inequality in eq .   does not follow ) .",
    "the penalties in the semi - discrete equations need to be slightly modified from those of the flat space scalar wave system in eqs .  - . to see how , consider the semi - discrete equations corresponding to eqs .  - with penalty functions @xmath173 :    _ i = & -_i +  + p , [ sdcurvedeq1 ] + _ i = & -^jk_j_k_i +  + q. [ sdcurvedeq2 ]    as usual , is it to be understood that the fields represent grid values ( e.g.  @xmath115 ) , and differentiation is implemented , for example , by matrix multiplication . for simplicity , we will assume that the physical domain under consideration has been mapped to the cube @xmath13 with @xmath107 $ ] .",
    "we will also assume for now that the boundary is timelike , with @xmath11 the only incoming mode .",
    "as in the flat space scalar wave system , the penalties will thus be proportional to @xmath174 .",
    "the semi - discrete energy is e = , [ sdenergy ] where the discrete inner product is now defined by , for example    , & _ ijk _",
    "i_j_k ^2 ^1/2 + & _",
    "^2 ^ 1/2 d^3x .",
    "because of the presence of @xmath175 in the volume element , the quadrature integrals we encounter will in general no longer be exactly equal to the continuum integrals .",
    "the time derivative of the semi - discrete energy in eq .",
    "separates as usual into a continuum - like part plus a contribution from the penalties : e = e _ + e _ , where the penalty contribution is e _",
    "= , q + ^i,_i p .",
    "[ edotpenalties ] assuming the penalty @xmath73 is defined as in eq .   except for an overall factor @xmath176 , we have , q= _",
    "|*n*| q_0u_-^1/2 , [ qedotswc ] where @xmath119 is the magnitude ( now with respect to @xmath152 ) of the normal vector defined as in eq .  . the second term in eq",
    "gives ^i,_i p = _",
    "|*n*| n^i _ i p ^1/2 - _ j^j , p , [ pedotswc ] where @xmath97 is the unit normal vector to the boundary , and @xmath177 is the three - dimensional covariant derivative associated with @xmath152 . with the penalty function @xmath72 constructed in the volume according to eq .  , the last term in eq .",
    "asymptotically vanishes as in the flat - space case , and we will therefore neglect it . assuming that @xmath72 has the same value as in eq .",
    "apart from an overall factor @xmath85 , it follows that ^i,_i p = - _",
    "|*n*| n^i _",
    "i p_0u_- ^1/2 .",
    "if we choose @xmath178 , then eq .   for the penalty contribution to @xmath17",
    "becomes e _",
    "= _ |*n*| p_0 u_- u_- ^1/2 . setting @xmath179",
    ", we obtain the semi - discrete energy estimate e - _ |*n*| f^n ^1/2 + ke , [ sdedotswc ] for some constant @xmath180 .",
    "the flux integrand is f^n = _ - ( u_-^^2 - u_-^2 ) + _ + u_+^2 + 2 _ 0 u^0iu^0_i , [ fluxswcsd ] which resembles the continuum result of eq .   with the addition of the negative term proportional to the mismatch of characteristic modes @xmath181 .",
    "the sum over the boundary can be rewritten as _",
    "^1/2 ( ) = _ |*n*| _ ^1/2 ( ) , where @xmath182 is the magnitude ( with respect to a euclidean metric ) of the normal one - form corresponding to @xmath105 , and @xmath183 represents any integrand . in this form ,",
    "the similarity to the surface integral _",
    "( ) ^1/2 d^2x in the continuum result of eq .",
    "is evident .",
    "we have assumed that @xmath11 is the only incoming mode , and in this case eq .",
    "shows that the semi - discrete system is asymptotically well - posed .",
    "if @xmath184 , then the boundary flux in eq .   implies that a boundary condition is required to control @xmath100 as well .",
    "although we have been unable to see how to do this with penalties , we have found empirically that it is unnecessary to impose any boundary conditions on this mode ; it is sufficient to enforce the condition on the incoming mode @xmath11 .    for a spacelike boundary with all characteristic modes outgoing , no boundary conditions and",
    "hence no penalties are required . in that case , the boundary term in eq .",
    "is strictly non - positive . on the other hand ,",
    "if the boundary is spacelike with all characteristic modes incoming , a boundary condition can be enforced on @xmath11 _ and _",
    "@xmath32 by setting    p| _ & = ( |_+|u_+ - |_-|u_- ) , [ p2 ] + q| _ & = ( |_+|u_+ + |_-|u_- ) .",
    "[ q2 ]    in this case , the flux integrand in eq .   would be    f^n = & _ - ( u_-^^2 - u_-^2 ) + _ + ( u_+^^2 - u_+^2 ) + & + 2 _ 0 u^0iu^0_i .",
    "[ fluxswcsd2 ]    in summary , the second - order system with penalties is    = & -+  - u_- , [ swceq1 ] + = & -^ij_i_j+  + u_- , [ swceq2 ]    where as usual the penalties represent boundary values , the penalty on the first equation is applied throughout the interior of the domain via eq .  , and the normal vector @xmath105 is defined as in eq .  .",
    "furthermore , it is to be understood that the penalties with @xmath185 are applied only when @xmath11 is an incoming mode , and in the event that @xmath32 is also incoming , the penalties are modified according to eqs .  - .",
    "in order to compute the error with respect to an analytical solution , we consider the inhomogeneous wave equation _ ^= , [ swceqsource ] where the source @xmath186 is computed by substituting an analytical solution for @xmath70 into the left - hand side . with a source term , eq .   remains unchanged , while eq .",
    "is modified by adding a term @xmath187 : =  + .",
    "[ swceq2source ] as an example of a test problem , we use the following background metric ( the schwarzschild solution in kerr - schild coordinates ) :    ds^2 = & -(1+)dt^2 + ( 1+)dr^2 + & + drdt",
    "+ r^2 d^2 ,    and consider an analytical solution of the form _",
    "= ( t ) e^-(r - r_0)^2/^2 y_lm . [ soln ]",
    "we evolve the second - order equations eqs .  - with source term on a domain consisting of three concentric spherical shell subdomains .",
    "the innermost boundary is placed just inside the horizon ( located at @xmath188 ) , so that no boundary condition is required there ( all characteristic modes are outgoing ) . at interfaces between two subdomains ,",
    "the value of the incoming mode @xmath189 is supplied by the adjacent subdomain , while on the outermost boundary , @xmath189 is computed from the analytical solution in eq .  .",
    "time - stepping is performed using an explicit runge - kutta method .    for a spherical shell subdomain",
    ", we employ a spectral basis composed of legendre polynomials in the radial direction scaled to the appropriate radial extent and spherical harmonics for the angular directions .",
    "the numerical approximant for particular truncations @xmath190 and @xmath191 is therefore given by : = _ i=0^n_r _ l=0^l _ m",
    "=- l^+l a_ilm p_i(r ) y_lm ( , ) , [ sphshellbasis ] where @xmath192 represents the appropriately scaled legendre polynomial , and @xmath193 are the spectral coefficients .",
    "figure  [ fg : swcconv ] shows the @xmath137 error in @xmath70 for this test problem as a function of time for several resolutions . for comparison ,",
    "the results from an equivalent first - order evolution are plotted as well .",
    "error of a scalar wave given by eq .   on a schwarzschild background in kerr - schild coordinates evolved using the second - order system ( solid green ) .",
    "the results of equivalent first - order evolutions are plotted for comparison ( dashed blue ) .",
    "the domain consists of three concentric spherical shells with radial boundaries at @xmath194 ( in units of @xmath195 ) .",
    "the radial and angular resolutions @xmath196 of the runs are @xmath197 , @xmath198 , @xmath199 , and @xmath200 . in this test",
    ", the following values for the analytical solution were used : @xmath201 and @xmath202 .",
    "the @xmath137 error is a moving average over an interval @xmath203 , which includes @xmath146 data points . ]",
    "the homogeneous second - order system of eqs .",
    "- is also stable and convergent in tests that we have run with arbitrary initial data on a variety of backgrounds .",
    "for example , we have run simulations on a schwarzschild background in kerr - schild , painlev - gullstrand  @xcite , and fully harmonic coordinates , and on a kerr background ( with a spin up to @xmath204 ) in kerr - schild coordinates . in those cases for which we do not have an analytical solution to supply a condition on @xmath11 at the outer boundary , we find good results by using a sommerfeld condition , assuming a solution of the form ~. this translates into a condition on the incoming mode at the outer boundary : u_-^ ~.    for the first - order system , as discussed below eq .  , one can use chebyshev polynomials instead of legendre for the radial basis in eq .  , and the results are comparable ( the same holds for einstein s equations as well ) . in the second - order evolutions , while it is acceptable to use a chebyshev basis for flat space applications , we find that the error is significantly larger ( almost two orders of magnitude ) in the curved background case .",
    "note , however , that we are not addressing the chebyshev - legendre method discussed below eq .   here ,",
    "but rather the use of a chebyshev basis without modifying the index values of the penalty functions .",
    "presumably , the chebyshev - legendre method would perform equally well , but we have not explored this modification .",
    "we have not found a significant difference in efficiency between the first- and second - order forms of the equations for the simple systems considered in this paper .",
    "even with equal time steps , the rates of the first- and second - order codes ( using explicit time - stepping ) are comparable ( within about 10% of each other ) , despite the absence of the third set of evolution equations ( the @xmath205 equations ) in the second - order system .",
    "one reason for this is that second derivatives are computationally more expensive than first derivatives on arbitrary domains , because of the coordinate transformations involved .",
    "symbolically , the transformation of a first derivative to new ( barred ) coordinates involves a multiplication by the jacobian @xmath206 of the transformation : |= j , whereas the transformation of a second derivative requires the hessian @xmath207 and the first derivative as well : |^2 = jj ^2 + h .",
    "it is evident that the second - order evolutions generally have smaller errors than their first - order counterparts at given resolutions by as much as two orders of magnitude , as can be seen in figs .",
    "[ fg : flatconv]-[fg : swcconv ] . to a degree ,",
    "then , this makes the second - order evolutions somewhat more efficient in the sense that for a given accuracy goal , a smaller resolution is required in the second - order system .",
    "however , our focus has not been on comparing or analyzing code efficiencies , but rather on establishing the viability of a second order in space spectral method .",
    "we believe the second - order system has the potential to show substantial increases in efficiency for more complicated systems than those considered here .",
    "all of the energy arguments in this paper have assumed a grid structure that can be mapped to a cube . while it is straightforward to apply these methods to spherical or cylindrical shells , it is assumed that any dimension with boundaries ( e.g.  the radial dimension on a spherical shell ) has a collocation grid that contains its endpoints ( gauss - lobatto grid ) . for a domain containing the origin , such as the unit disk , it is typical to use a radial grid of gauss - radau points , so that the endpoint at the origin is omitted ( see e.g.  ref .",
    "we have not considered the generalization to such domains .",
    "we have shown how to evolve a multi - domain second order in space wave equation stably using spectral methods .",
    "for more general systems , energy arguments like those given in this paper can not be carried out .",
    "nevertheless , in the most important case we consider , namely einstein s equations in generalized harmonic form , these methods work well .",
    "the reason is that the _ principal part _ of the equations is directly analogous to the scalar wave equation on a curved background  @xcite .",
    "we will report on these extensions in a subsequent paper  @xcite .",
    "we would like to thank carsten gundlach , jan hesthaven , and manuel tiglio for valuable comments .",
    "most of the numerical tests were performed within the framework of the spectral einstein code ( spec ) developed at cornell and caltech primarily by l.k . ,",
    "harald pfeiffer , and mark scheel  @xcite .",
    "this work is supported in part by grants from the sherman fairchild foundation to caltech and cornell , and from the brinson foundation to caltech ; by nsf grants phy-0601459 , phy-0652995 , and dms-0553302 at caltech ; by nsf grants phy-0652952 , dms-0553677 , phy-0652929 , and nasa grant nnx09af96 g at cornell .",
    "here we provide some of the properties of gauss - legendre - lobatto quadrature  @xcite . the basis functions on @xmath16",
    "$ ] are the legendre polynomials @xmath44 .",
    "this is a convenient choice for obtaining analytical results because the legendre polynomials are orthogonal under a weighting function of unity : _",
    "-1 ^ 1 ( x ) p_n(x)p_m(x)dx = _ nm , with @xmath208 .",
    "the @xmath209-point quadrature rule , _ -1 ^ 1 u(x)dx",
    "iu(x_i ) , is exact if @xmath210 is a polynomial of degree @xmath211 or less . the @xmath212 nodes @xmath35 are    x_0 = & -1 , + x_n = & + 1 , + x_i = & p_n^(x ) + & 0 < i < n ,    and the weights @xmath47 are given by _",
    "note that there is no known explicit formula for the roots of @xmath213they must be found numerically .",
    "a function @xmath214 is approximated by an @xmath78-order interpolating polynomial @xmath215 , which can be expressed as _",
    "n(x ) = _ i=0^n ( x_i ) c_i(x ) , where @xmath216 are cardinal functions satisfying @xmath217 .",
    "they can be written as c_i(x ) = .",
    "differentiation can be computed via matrix multiplication from ^_n(x_i ) = _ j=0^n d^(1)_ij ( x_j ) , where @xmath218 is the first - order differentiation matrix . the second - derivative matrix is defined similarly and satisfies @xmath219 an efficient algorithm for computing pseudo - spectral differentiation matrices is given in ref .",
    "@xcite .",
    "if @xmath131 are two @xmath78-order polynomials , summation by parts follows naturally because the product @xmath220 is a polynomial of order @xmath211 or less : f , g^= _ i=0^n _ if_ig^_i = f_ig_i |_i=0^n - f^ , g .",
    "summation by parts generalizes to higher dimensional inner products in a straightforward way .",
    "for example , if @xmath23 and @xmath135 are @xmath59-d polynomials in @xmath2 and @xmath65 :    _ xf , g = & _ i , j=0^n _ i _ j ( _ xf)_ij g_ij + = & _ j=0^n _ j ( fg)|_i=0^n - f , _ x g .",
    "in this section we will show that in two or more dimensions the inner product ^i_i , p that arises in the energy arguments discussed in this paper can not be made to vanish in general with a penalty function @xmath72 that satisfies the boundary conditions .",
    "we will argue by counting degrees of freedom . for simplicity",
    ", consider the two - dimensional case and let the domain be a square with @xmath212 grid points along each dimension .    instead of using a basis of legendre polynomials ,",
    "consider a ( non - orthogonal ) basis of functions @xmath221 . a scalar field is thus approximated on the grid as a two - dimensional interpolating polynomial of the form = _ 0 i , j n a_ij x^i y^j . [ psiexpan ] there are @xmath222 basis functions and hence the same number of degrees of freedom in the function @xmath70 .",
    "the penalty function @xmath72 must satisfy @xmath223 boundary conditions on the square .",
    "now consider operating on the expansion of @xmath70 in eq .   with the laplacian @xmath224 .",
    "the effect of this operation on a term @xmath225 is essentially x^i y^j x^i-2y^j + x^i y^j-2 .",
    "[ xyterm ] since we are only interested in counting the degrees of freedom that remain in @xmath226 , we only need to retain one of the terms in eq .",
    ": x^i y^j x^i-2y^j .",
    "[ xyterm2 ] by doing this , we will at worst undercount the degrees of freedom in @xmath226 .",
    "this leaves terms of the form @xmath227 for @xmath228 and @xmath229 , which implies that there are at least @xmath230 degrees of freedom remaining in the laplacian .",
    "there are thus at most @xmath231 degrees of freedom for constructing a penalty function that is orthogonal to @xmath226 ( for arbitrary @xmath70 ) , which is not enough to satisfy the @xmath223 boundary conditions .",
    "the same argument can be applied in any number of dimensions . in particular ,",
    "in the three - dimensional case we find that there are at most @xmath232 degrees of freedom for constructing the penalty function  not enough to satisfy the @xmath123 boundary conditions , which proves the assertion made below eq .  .",
    "in this section the form of the three - dimensional bulk penalty given by eq .   will be derived .",
    "the goal is to minimize the inner product ^i_i , p , with the values of the penalty function @xmath72 on the boundary given .",
    "first , we will revisit the one - dimensional problem on the interval @xmath16 $ ] from a new point of view .",
    "in section  [ mainresult ] it was shown that the one - dimensional inner product @xmath76 vanishes when @xmath72 is constructed from the functions @xmath131 defined in eqs .  - .",
    "recall that the functions @xmath23 and @xmath135 were constructed from @xmath233 and @xmath234 to be orthogonal to @xmath235 .",
    "let us start over and consider the one - dimensional penalty function @xmath72 to be unspecified , except on the boundaries .",
    "suppose also that there is no boundary condition at @xmath37 , so the penalty function satisfies @xmath236 .",
    "the boundary condition at @xmath36 fixes the value @xmath85 , and we can view the values @xmath237 for @xmath238 as free parameters for minimizing the inner product : ^ , p = _ 0 ^_0 p_0 + _ i=1^n-1 _ i ^_i p_i .",
    "[ pvanish1 ] this will vanish if and only if ^_0 = _ i=1^n-1 ( ) ^_i , [ pvanish2 ] where it is safe to assume @xmath239 ( if @xmath240 , then @xmath241 as there would be no need for a penalty function ) . since @xmath242 is an _",
    "@xmath243-order polynomial , this equation defines the ideal interpolation weights @xmath244 for approximating a function at @xmath245  @xmath246  @xmath247 based on its values over a stencil of points @xmath35 for @xmath238 : ^_0 = _",
    "i=1^n-1 c_0(x_i ) ^_i . assuming the grid points are gauss - legendre - lobatto points",
    ", we can therefore make the identification c_0(x_i ) = - = - f_i , [ c0def ] where @xmath248 are the grid values for @xmath249 of the function @xmath23 defined in eq .  , and we have used the fact that eq .   holds when the penalty @xmath72 is defined by eq .",
    ".    the case with a boundary condition at @xmath108 and not at @xmath250 ( so @xmath251 ) is similar , and we conclude that the interpolation weights @xmath252 for approximating a function at @xmath37 based on its values at points @xmath35 for @xmath249 are given by c_n(x_i ) = - g_i , [ cndef ] where @xmath253 are the grid values for @xmath249 of the function @xmath135 defined in eq .  .",
    "now let us consider the two - dimensional problem on the square @xmath16\\times[-1,1]$ ] . in the following we will use the index @xmath33 exclusively for summing over @xmath2 values and @xmath254 for @xmath65 .",
    "our goal is to construct the values of @xmath72 on the interior of the domain so as to minimize the inner product , p = _ ij_i_j _",
    "ij p_ij , [ ip ] where @xmath255 represents the laplacian operator @xmath256 , and we consider the values of @xmath72 on the boundary to be given .",
    "consider a point on the edge at @xmath257 , for example .",
    "the term in the inner product due to this point is _ 0 _ j _ 0j p_0j . [ edgept ] now define @xmath72 on the interior along the @xmath258 row to be p_ij = p_0j f_i , just as in the one - dimensional case . using the identification of @xmath23 as interpolation weights from eq .  , the contribution to the inner product from the interior of this row is      which approximately cancels the term from the point on the edge in eq .  . in eq .",
    "we have written @xmath259 for the interpolation weights @xmath244 defined in eq .  .",
    "next , consider a point at a corner , say @xmath260 .",
    "the term in the inner product due to this point is _ n _ 0 _ n0 p_n0 .",
    "[ cornerpt ] define @xmath72 on the interior of the domain to be p_ij = - p_n0 g_i f_j .",
    "the contribution of @xmath261 to the inner product on the interior of the square is now      which approximately cancels the contribution from the point on the corner in eq .  .",
    "following this procedure , we construct @xmath72 on the interior by adding a contribution from each boundary segment : @xmath262 edges and @xmath262 corners on this @xmath59-d domain . explicitly , this gives      this generalizes to three or more dimensions in a straightforward way .",
    "each term in @xmath261 has a number of products of @xmath23 or @xmath135 equal to the codimension of the boundary segment it depends on .",
    "the only caveat is that the sign of the terms added to @xmath72 should be @xmath263 , where @xmath264 is the codimension of the boundary piece producing the term .",
    "this is evident in the @xmath59-d example above where the terms in eq .   due to the corners are negative .",
    "the sign difference arises simply because of the negative sign in the relation between the interpolation weights @xmath265 and the functions @xmath131 in eqs .  - .",
    "with the penalty function @xmath72 constructed according to the above procedure , the inner product of @xmath72 with _ any _ analytic function @xmath266 ( hence @xmath129 ) satisfies h , p 0 , n .",
    "[ hinprod ] in particular , we have shown that the last term in eq .   asymptotically vanishes , as claimed below eq .  .",
    "moreover , while we have not bounded the error for a given resolution , the inner product in eq .   will be as small as possible in the sense that it vanishes for the polynomial approximations to @xmath266 up to order @xmath267 ."
  ],
  "abstract_text": [
    "<S> current spectral simulations of einstein s equations require writing the equations in first - order form , potentially introducing instabilities and inefficiencies . </S>",
    "<S> we present a new penalty method for pseudo - spectral evolutions of second order in space wave equations . </S>",
    "<S> the penalties are constructed as functions of legendre polynomials and are added to the equations of motion everywhere , not only on the boundaries . using energy methods , we prove semi - discrete stability of the new method for the scalar wave equation in flat space and show how it can be applied to the scalar wave on a curved background . </S>",
    "<S> numerical results demonstrating stability and convergence for multi - domain second - order scalar wave evolutions are also presented . </S>",
    "<S> this work provides a foundation for treating einstein s equations directly in second - order form by spectral methods . </S>"
  ]
}