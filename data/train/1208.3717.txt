{
  "article_text": [
    "the large number of possible nuclear configurations puts the curse of dimensionality@xcite on studies of the chemical reactivity of large molecular systems like metalloenzymes or transition metal complexes in homogeneous catalysis . to find",
    "exactly those configurations which correspond to the reaction path searched for is very difficult .",
    "although there exist several methods to sample the configuration space of the nuclear positions efficiently and in an unbiased way ( see , e.g. , refs .  )",
    ", a full _ ab initio _ treatment of the molecular system renders also these approaches very time demanding or even unfeasible .",
    "an ab initio treatment is , however , mandatory for the study of chemical reactivity involving the forming and breaking of chemical bonds .",
    "the overwhelming amount of data generated by computational methods calls for new approaches to access it . in conventional methods , a change of nuclear coordinates @xmath0 of a reactive or functional molecular system changes the potential energy@xcite @xmath1 i.e.",
    ", the electronic energy defined in the born  oppenheimer ( bo ) approximation .",
    "once this energy has been calculated by a computer program , the results are collected and can be evaluated . however , if the results were accessible immediately after applying the configurational change , the perception of the results of the calculations would be much more efficient since a real interaction between the scientist and the system under study could be established .    in this perspective article",
    "we discuss a point of view on such a challenge that we may summarize under the term real - time quantum chemistry .",
    "`` real - time '' in this context means that the results of quantum chemical calculations are basically instantaneously available , i.e. , on a time scale that a specific human sense would interpret as instantaneous .",
    "quantum chemical information available in real time then offers a very efficient way to interactively study the reactivity of molecular systems .",
    "the structure of this work is as follows .",
    "we start with a definition of real - time quantum chemistry and discuss its principles .",
    "then , we review and evaluate existing techniques to accelerate quantum chemical calculations with respect to their potential usage in real - time quantum chemistry .",
    "finally , we discuss the feasibility of a direct approach to haptic quantum chemistry@xcite which implements the ideas of real - time quantum chemistry . in order to illustrate what can already be done with currently available quantum chemistry software we present some exploratory calculations .",
    "a theoretical study of chemical reactivity requires the exploration of the potential energy surface .",
    "hence , first the wave function of the molecular system has to be calculated , from which then the energy and the gradients can be obtained . other properties like molecular orbital representations , the electron density , polarizabilities or partial charges could also be considered , but are secondary targets compared to energies and gradients .",
    "we thus define    since finding the optimized wave function and calculating the energy and the gradient is essential to all reactivity studies , we define their instantaneous calculation as the core objective of real - time quantum chemistry . obtaining additional properties in real time",
    "could then be considered an extension of ( core ) real - time quantum chemistry .",
    "it is clear that the fast calculation of the core quantities is central also to _ ab initio _ molecular dynamics ( aimd)@xcite .",
    "accordingly , the challenges which one faces in the context of real - time quantum chemistry can also be found in the area of aimd , where the fast calculation of the nuclear gradients ( called ionic forces ) is of paramount importance .",
    "therefore , many techniques developed in aimd to speed up the calculation of gradients are also important in a real - time quantum chemistry framework .",
    "although the forces are required as quickly as possible , aimd simulation results are interpreted _",
    "after _ the simulation has been carried out . in real - time quantum chemistry , however , we want to seamlessly merge the calculation and the perception of the calculated information .",
    "the seamless integration of complex quantum chemical information allows the interactive exploration of chemical reactivity .",
    "an approach which utilizes a force - feedback device as an input and an output device to transmit the quantum mechanical information to the operator is haptic quantum chemistry ( hqc ) introduced by us in 2009@xcite .",
    "a force - feedback device as in hqc is also utilized in the interactive molecular dynamics framework@xcite , which implements a classical treatment of the forces in molecular systems .",
    "another example is the recently presented semi - empirical interactive implementation for optimizing molecular structures of hydrocarbons during editing the structures@xcite .    as it has been noted in ref .   a real - time _",
    "visual _ experience requires at least ten frames per second ( i.e.  @xmath2 to update the system s state ) , if a frame represents a step in the shift of nuclear positions during structure optimization or reaction . in haptic quantum chemistry",
    ", however , a smooth tactile experience requires an update rate of 1000 frames per second .",
    "accordingly , the central question for real - time quantum chemical approaches is the following : is it  in principle ",
    "possible to perform sufficiently accurate _",
    "ab initio _ quantum chemical calculations in such a short time , i.e. , in the millisecond range for a reasonably sized molecular model of a reactive system ?    the issue of accelerating quantum chemical calculations has been treated thoroughly before ",
    "mostly in the area of linear and sub - linear scaling techniques@xcite .",
    "however , it is important to note that there is a fundamental difference between the problem formulated in the question above and the problem of achieving linear scaling . in real - time quantum chemistry , we do _ not _ ask for methods which allow us to treat larger and larger systems but rather how fast we can perform a calculation for a particular system of constant size and target accuracy .",
    "this implies that one also has to focus on the prefactors and onsets of quantum chemical methods and not only on their overall scaling behavior . in other words ,",
    "the actual execution time for a given system is the prime target .",
    "the reason why we focus on reactive systems with a ( large but ) constant number of atoms is that we concentrate on rather local chemical events , which are ubiquitous in chemistry .",
    "for example , they can be mediated by transition - metal centers as in enzymatic reactions or in homogeneous catalysis .",
    "reactions at transition metals are usually restricted to a limited spatial region containing the metal center(s ) , its ( their ) ligand environment , the incoming reactant , co - factors , other reactants that may lead to side reactions and some proper model of the close environment in such a way that models on the order of @xmath3 atoms are sufficient for a meaningful description@xcite .",
    "almost all acceleration techniques for electronic structure calculations developed so far aim at a linear scaling behavior especially for very large molecules ( @xmath4 atoms ) .",
    "a multitude of methods has been developed as discussed in many excellent reviews@xcite . here",
    ", we need to evaluate the existing methods from a different point of view .",
    "the overall goal is to decide , whether there is a certain lower limit of computation time for mid - sized molecular systems ( @xmath5 atoms ) , and to identify approaches that are likely to be important for a real - time calculation of gradients and energies .    in view of the fact that single - determinant models like hartree  fock theory and , most importantly , density functional theory ( dft ) are likely to be the best candidates for quantitative real - time reactivity exploration , we first need to consider the solution of the roothaan",
    " hall equations .",
    "the two most important steps in a self - consistent solution of the roothaan  hall equations are the construction of the fock matrix and the subsequent calculation of the density matrix",
    ". of course the size of the basis set chosen is also very important , since it determines the size of the system .",
    "we skip the derivation of the one - particle mean - field hartree  fock theory@xcite and of kohn  sham ( ks ) density functional theory@xcite which lead both to an effective one - particle operator equation .",
    "for the sake of simplicity , the following equations are given for spin - restricted calculations .",
    "the generalization to the spin - unrestricted case is straightforward .",
    "the fock operator @xmath6 for hartree  fock and kohn  sham models can be written as@xcite @xmath7 + \\lambda\\,\\hat{v}^\\textnormal{xc}(\\boldsymbol{r}_1 ) \\,\\",
    ", , \\end{aligned}\\ ] ] where @xmath8 and @xmath9 are two parameters that define the electronic structure model . for a hartree ",
    "fock calculation , one chooses @xmath10 and @xmath11 , whereas for a pure kohn  sham calculation @xmath12 and @xmath13 with a non - vanishing @xmath14 hold . with @xmath13 and @xmath15 $ ] hybrid approaches are described .",
    "the introduction of a finite basis set @xmath16 , @xmath17 is the most convenient way to solve the spatial integro - differential self - consistent - field ( scf ) equations that result when @xmath6 is operating on an orbital @xmath18 .",
    "this yields the well - known roothaan ",
    "hall equations , @xmath19 where @xmath20 is the matrix of the expansion coefficients defined in eq .",
    "( [ eq : finitebasis ] ) , @xmath21 is the overlap matrix and @xmath22 is the matrix of the orbital energies @xmath23 of the orbitals @xmath18 .",
    "the elements of the fock matrix @xmath24 in the chosen basis @xmath25 are given by @xmath26 here , @xmath27 is the matrix representation of the one - electron operator , @xmath28 is the two - electron coulomb matrix operator , @xmath29 is the two - electron exchange matrix operator and @xmath30 is the two - electron exchange  correlation matrix operator . for the calculation of the matrices @xmath28 and @xmath29 the two - electron repulsion integrals are contracted with the elements of the density matrix @xmath31 which is for real orbitals in closed - shell systems defined as @xmath32 and thus the reason for the self - consistent iterative solution of the roothaan  hall equation .",
    "the elements of the matrix @xmath30 are derived from the exchange ",
    "correlation density functional @xmath33 which can be a functional of the electron density @xmath34 in the local density approximation , of the density and the gradient of the density @xmath35 in the generalized gradient approximation ( gga ) , or of the density , the gradient of the density , and the kinetic energy density @xmath36 in meta - gga functionals .",
    "since the matrix elements can not be evaluated analytically the integration is usually performed on a mesh of grid points constructed from merged atomic grids @xmath37 where @xmath38 is the number of points @xmath39 in the grid of atom @xmath40 and @xmath41 are the corresponding weights .",
    "@xmath42 is the function that splits the molecular grid into atomic sub - grids .",
    "the electron density @xmath34 at a grid - point @xmath43 is given by @xmath44    eq .",
    "( [ eq : roothaan ] ) has to be solved iteratively , since @xmath24 depends on the elements of @xmath20 . after reaching self consistency",
    "the total energy of the system is calculated from the converged density matrix elements and the fock matrix elements , @xmath45 +   \\sum\\limits_{\\mu\\nu } p_{\\nu\\mu } v^\\textnormal{xc}_{\\mu\\nu } + v^\\textnormal{nn } \\,\\ , , \\end{aligned}\\ ] ] where @xmath46 represents the coulombic pair interaction of all atomic nuclei . from this equation",
    "also the gradient @xmath47 with respect to the nuclear coordinates @xmath0 can be derived . within a finite basis of , e.g. , cartesian gaussian functions one obtains after a few rearrangements the expression@xcite @xmath48 \\nonumber \\\\   & + \\sum\\limits_{\\mu\\nu } p_{\\mu\\nu } \\left ( \\nabla_i v^\\textnormal{xc}_{\\mu\\nu } \\right )    - \\sum\\limits_{\\mu\\nu } q_{\\mu\\nu } \\left ( \\nabla_i s_{\\mu\\nu } \\right ) + \\nabla_i v^\\textnormal{nn}\\end{aligned}\\ ] ] it includes the pulay forces@xcite that are due to the origin dependence of atom - centered basis functions . in case of plane - wave basis functions",
    "these forces vanish and the expression can be simplified . for a more compact notation an energy weighted density matrix @xmath49 , @xmath50 has been introduced .",
    "the derivatives of the exchange  correlation matrix elements @xmath51 depend on the specific nature of the exchange  correlation potential @xmath14 .",
    "general formulations of the energy gradient can be found in refs .   for the local ( spin ) density approximation and in ref .",
    "for gradient - corrected functionals .",
    "very important for any acceleration technique is the choice of the basis set in which the kohn  sham or hartree  fock orbitals are expanded .",
    "the larger the basis set the more accurate the calculations are , but also the more time they consume .",
    "reducing their size is , therefore , a very seductive means to reduce computation time . in addition",
    "certain basis sets speed - up certain parts of the fock matrix calculation but may have disadvantages in other parts .",
    "the two most widely employed explicit basis sets are linear combinations of gauss - type atomic orbitals and plane waves .",
    "plane waves are especially suited for the calculation of periodic and homogeneous systems whereas the gauss - type orbitals are usually employed in molecular systems .",
    "density matrices in gaussian basis sets are therefore mostly sparse , i.e.  band diagonal and thus promote linear - scaling techniques .",
    "plane - wave basis sets are completely delocalized in the direct space but are very localized in reciprocal space , which is why they are usually applied in solid state physics . in molecular systems , however , a huge number of plane waves would be needed to obtain the same accuracy as with localized gauss - type orbitals . on the other hand ,",
    "some of the integrals can be calculated very fast by fast fourier transforms ( fft ) within a plane - wave basis set .",
    "also the calculation of the forces on the nuclei is computationally less expensive since the basis functions are not position dependent . to increase the accuracy and limit the number of basis functions in molecular systems , hybrid codes combine gaussians and plane waves",
    "these developments allow for the calculation of molecules with up to a million atoms@xcite .",
    "pseudopotentials@xcite can be employed for both types of basis sets in order to reduce the number basis functions .",
    "how many electrons are treated implicitly by the pseudopotential can , of course , be varied and determines the accuracy achieved . in plane - wave calculations pseudopotentials",
    "are crucial to avoid the description of the nodal structure of orbitals so that the number of plane - waves can be limited to a reasonably small value .",
    "pseudopotentials are also employed for heavy elements to account for relativistic effects@xcite .    a less common alternative to the classes of basis sets described above",
    "are the so - called wavelets@xcite , which aim at combining the best of both worlds .",
    "they are localized in both direct and reciprocal space and the integrals can be calculated with very fast methods similar to fast fourier transforms .",
    "it is obvious , that for real - time quantum chemistry the number of basis functions needs to be as small as possible . since high accuracy",
    "does not need to be the main goal , comparatively small basis sets can be employed . for the same reason pseudopotentials",
    "are beneficial .",
    "since plane waves and basis sets of plane waves mixed with gaussians have successfully been applied in aimd calculations , they are also useful for real - time quantum chemistry .      the calculation of the fock matrix can be divided into two different parts . the calculation of the elements of the one - electron and two - electron matrix operators .",
    "the calculation of the exchange  correlation matrix elements occurring in ks - dft calculations will be discussed separately . in almost all _ ab initio _ electronic structure calculations the fock matrix construction is the most time consuming part , because of the evaluation of all integrals .",
    "therefore , many sophisticated algorithms have been devised to speed up their evaluation .",
    "the calculation of the one - electron hamiltonian matrix requires the evaluation of @xmath52 matrix elements , where @xmath53 denotes the number of basis functions .",
    "the matrix elements consist of two terms , the kinetic energy term and the electron  nuclei interaction part .",
    "if localized basis functions are employed , the number of integrals for the kinetic term will increase only linearly with system size@xcite .",
    "for the coulomb interaction between the electrons and the nuclei , multipole expansions can be applied to reduce the number of integrals and achieve linear scaling@xcite .",
    "although the evaluation of these matrix elements has a quadratic scaling , their contribution to the overall execution time is for mid - sized molecular systems very small and hence no problem for real - time quantum chemistry .",
    "however , to even speed up this part , program parallelization can be employed efficiently as the integrals can be evaluated independently from one another .",
    "the two - electron repulsion integrals ( eri ) in the calculation of the coulomb- and the exchange matrix elements are in principle four - index quantities and thus their evaluation formally requires @xmath54 operations .",
    "the first and most effective way to reduce their computation time is to discard all elements whose contribution is below a certain threshold .",
    "the most widely employed technique for such an integral screening is based on schwarz - inequality integral estimates.@xcite another approach to screen for negligible matrix elements are the multipole - based integral estimates.@xcite they consider in addition the @xmath55 decay behavior between two charge distributions . in non - direct scf calculations the integrals",
    "are pre - calculated and integral screening can only be done at the level of the integrals . in direct scf methods also",
    "the density matrix elements with which the integrals are contracted can be taken into account for screening .",
    "therefore , also large integrals can be neglected , if they have only a small weight assigned by the density matrix elements .",
    "the calculation of the surviving integrals can then be accelerated .",
    "the first general approach is to fit the densities occurring in the coulomb and exchange integrals with auxiliary basis sets , thus reducing the four index eris to two index quantities .",
    "this approach to fit the densities accelerates the evaluation of the coulomb matrix elements by an order of magnitude . to obtain the auxiliary basis sets",
    "two different methods are employed .",
    "one is to determine them by a fitting procedure@xcite , which is performed before the actual electronic structure calculation for each atom type and basis set and results in additional libraries of auxiliary basis sets .",
    "this density - fitting approach is also known as the resolution of the identity ( ri)@xcite .",
    "another method is to employ a cholesky decomposition ( cd ) algorithm to determine the auxiliary basis set for each calculation separately .",
    "@xcite cd methods are computationally more demanding , but generate an auxiliary basis set , which is `` the best '' for a given basis and they do not depend on pre - fitted parameters . therefore , the error introduced by the technique is controllable and no extra auxiliary basis - set libraries are needed .",
    "the calculation of coulomb matrix elements can also be made more efficient by employing hierarchical multipole methods like the fast multipole method@xcite or the quantum chemical tree code@xcite . here , the problem of calculating the coulomb interaction between many electrons is approximated by a truncated multipole expansion .",
    "a combination of a multipole expansion method and auxiliary basis sets can be applied to reduce the computation time even further@xcite .    for the exchange matrix elements special methods",
    "exist to obtain a linear - scaling behavior .",
    "the ri technique , which is very efficient for the coulomb matrix elements , can also be applied for the exchange matrix elements not with the same efficiency though@xcite .",
    "in addition several methods ave been developed specifically for the exchange matrix elements .",
    "examples are the @xmath56-exchange method@xcite ( where @xmath57 denotes the number of basis functions and is identical to our @xmath53 ) , the local k algorithm@xcite , the link method@xcite or the auxiliary density matrix methods for hartree  fock - type exchange@xcite .    in ks - dft calculations the fock matrix @xmath24 contains additional matrix elements from the exchange  correlation functional .",
    "the matrix elements are evaluated by numerical integration of the functional derivative on a grid .",
    "the computational cost depends , of course , on the size of the grid .",
    "the overall molecular grid is constructed from atomic grids , which are merged to obtain the molecular grid .",
    "a very common choice is the becke atomic partitioning scheme@xcite .",
    "since the calculation for each atomic grid can be done independently the overall scaling behavior can be made linear.@xcite the exchange  correlation matrix elements are usually considered as requiring a negligible amount of computation time compared with the coulomb and exchange matrix elements . however , after accelerating the two latter by , e.g. , ri methods their evaluation becomes the most time consuming part in the fock matrix construction .",
    "considering the potential of the above - mentioned techniques to accelerate the fock matrix construction , certainly the fast calculation of eris is of prime importance .",
    "based on the current state of the art a rigorous screening of the integrals and density - fitting techniques are the methods of choice . since the integrals can be evaluated independently they are prone for a parallelized evaluation , which will be discussed later .",
    "the exchange  correlation matrix elements require efficient numerical techniques for an accelerated calculation .",
    "straightforwardly , the coarseness of the grids employed can be increased to decrease the computational effort within pre - defined accuracy bounds .      in conventional scf - type electronic structure calculations",
    "the density matrix is calculated by a full diagonalization of the fock matrix .",
    "this approach has the advantage that the complete eigenspace can be obtained , i.e. , including all virtual orbitals .",
    "a disadvantage is , however , that the scaling with respect to system size is cubic ( and can be easily prohibitive in plane - wave calculations ) . due to the small pre - factor of the diagonalization procedure for gauss - type orbitals it mainly poses a problem for systems with several thousands of atoms .",
    "almost all methods discussed here have been developed for problems where the construction of the fock matrix is very fast and therefore the construction of the density matrix becomes the bottleneck of the calculations .",
    "an excellent review over methods , which avoid the diagonalization in semi - empirical calculations can be found in ref .  .",
    "an assessment of density - matrix methods for self - consistent - field calculations by comparing purification and minimization methods has recently been published by rudberg _",
    "et al_.@xcite    the diagonalization of the fock matrix does not directly yield the density matrix but the coefficient matrix @xmath20 which is then contracted to obtain the density matrix @xmath31 .",
    "although the density matrix is a local quantity due to the nearsightedness of the electrons@xcite , the coefficient matrix is not .",
    "therefore , a great reduction of computation time would be achieved calculating the density matrix directly from of the fock matrix .",
    "the so - called energy minimization techniques exploit the fact that the correct density matrix minimizes the expression @xmath58 $ ] .",
    "this minimization , however , has to be done under the constraints that the density matrix fulfills the idempotency condition and the trace condition , which requires that the trace of the density matrix yields the number of electrons .",
    "by contrast , the diagonalization procedures explicitly fulfill the idempotency condition .",
    "li , nunes , and vanderbilt proposed the functional @xmath59 \\,\\ , , \\end{aligned}\\ ] ] as a method to compute the density matrix by implicitly fulfilling the idempotency condition@xcite . here , @xmath60 denotes the chemical potential and @xmath61 the identity matrix .",
    "although this functional requires the density matrix to be set up in an orthogonal basis , there is no major problem to obtain a formulation for non - orthogonal basis sets , for which the energy functional is modified to include also the overlap matrix.@xcite independently , daw proposed a similar approach in 1993@xcite that applied additionally steepest - decent iterations to minimize the functional .",
    "alternatively , a conjugate - gradient approach can be chosen , which is then called the conjugate - gradient density - matrix search method@xcite .",
    "then , the fock and the density matrix are transformed into an orthonormal basis .",
    "another advantage of this approach is that the chemical potential does not need to be known in advance .",
    "other techniques employ for example curvy steps@xcite or include second derivatives@xcite to obtain faster convergence .",
    "all these methods employ a purification of the matrix proposed by mcweeny@xcite in order to fulfill the idempotency condition of the density matrix .",
    "the so - called sign matrix methods@xcite follow a different way to achieve this by expressing the density matrix in terms of the sign matrix function , which can be computed by iterative schemes .",
    "also possible is the introduction of a penalty functional for violating the idempotency condition.@xcite however , the penalty functional is difficult to employ since it can not be minimized by standard methods .",
    "linear scaling of these methods is obtained by weakening the idempotency condition through restricting the minimization to localized density matrices with density matrix elements corresponding to a distance larger than a certain threshold forced to be zero .",
    "other methods , which are not that common in _ ab initio _ electronic structure calculations , shall just be mentioned here for the sake of completeness .",
    "examples are the fermi operator expansion@xcite and the fermi operator projection@xcite method .",
    "another possibility to minimize the energy without explicitly imposing the orthonormality condition , as it is done by full diagonalization , is to minimize with respect to orbitals only with an implicit orthonormalization constraint .",
    "the orbital minimization@xcite or the optimal basis density matrix minimization@xcite methods are typical examples .",
    "however , they are mainly applied in large tight - binding or semi - empirical calculations.@xcite a linear - scaling behavior can be achieved in these methods by carrying out the minimization with respect to localized orbitals@xcite ( for example , by searching only over functions which non - zero values inside a specified region ) .",
    "this approach would not introduce any approximation if the localized orbitals could be obtained by a unitary transformation of the occupied eigenstates of the roothaan  hall equation .",
    "assuming that the build - up of the fock matrix and the subsequent calculation of the density matrix are fast enough for real - time quantum chemistry , the scf procedure poses severe obstacles .",
    "the sheer number of scf iterations strongly depends on the atomic configuration and is hardly predictable .",
    "therefore , it can not be guaranteed that the wave function and the gradients are available in time . from this point of view , for real - time quantum chemistry it would be desirable to have a method which completely avoids any iterative methods . however , in all true _ ab initio _ electronic structure calculation an iterative procedure is unavoidable , since the fock matrix depends on the density matrix elements .",
    "consequently , to be able to obtain a real - time calculation , one has to focus on reducing the number of iterations to a minimum . performing the structural manipulations in small steps",
    "is therefore the key for a working real - time quantum chemistry implementation .",
    "the steps discussed in the previous sections ( fock - matrix assembly and density - matrix calculation ) are both part of a single step in the self - consistent - field procedure .",
    "the convergence of scf iterations strongly depends on the first guess for the molecular orbitals and on the nuclear configuration . in a reactivity study , however , it may happen that configurations of the atoms occur , for which the scf procedure converges only slowly or not at all .",
    "it is thus of utmost importance to have methods at hand , which yield stable and fast converging scf iterations .    direct inversion in the iterative subspace (",
    "diis)@xcite is a widely employed technique to accelerate and stabilize scf iterations .",
    "error vectors from previous iterations are calculated and minimized in a least - squares sense .",
    "accordingly , previous iterations are utilized to extrapolate the fock matrix in the next iteration .",
    "quite closely related to the diis method are techniques called fock matrix dynamics@xcite or electron density extrapolation @xcite which are common in the field of bo molecular dynamics . instead of accelerating the scf algorithm itself the whole single - point scf calculation is accelerated by extrapolating the information from previous time steps of the simulation .",
    "it is assumed that in between two steps the nuclear coordinates change only little so that the molecular orbitals , fock matrix elements , or the density do not differe much from one step to the next and hence are a good starting point for the electronic structure optimization for the new nuclear configuration .",
    "although scf acceleration schemes have a long history , significant improvements can still be made as highlighted by the augmented roothaan ",
    "hall method@xcite .",
    "the pseudo - diagonalization technique@xcite is based on the observation that only for the first and the last scf iteration a full diagonalization is necessary . in between it",
    "is sufficient to eliminate all fock matrix elements connecting the occupied and virtual molecular orbitals by unitary transformations . as a consequence ,",
    "the diagonalization of the fock matrix blocks corresponding to the virtual  virtual and the occupied  occupied molecular orbitals can be avoided , which greatly reduces the time of each scf iteration .    in cases of a too narrow gap between the highest occupied and the lowest unoccupied molecular orbital , slow convergence or",
    "even divergent scf iterations can occur .",
    "in such cases level shifting@xcite can be applied to enlarge the gap and therefore avoid a mixing . with this procedure",
    "the problem of divergence , slow convergence , or oscillating behavior can be cured in many cases .    in all techniques discussed above the construction of the density matrix and the optimization of the molecular orbitals in the scf iterations were independent processes . however , for methods based on minimization of an energy functional for constructing the density matrix , methods have been developed that combine the density matrix optimization and the self - consistent - field iterations in one single optimization loop.@xcite the idea was developed for the coupled electron - nuclei problem ( car  parrinello molecular dynamics@xcite ) and is therefore often called the `` molecular dynamics '' method , but it can also be applied in situations were the nuclei are kept fixed .",
    "the difference to conventional matrix diagonalization procedures to solve for the eigenstates is that the variational principle is applied in a dynamic fashion and all eigenstates are determined simultaneously .",
    "the dynamic variables are here the coefficients of the basis functions with a fictitious electon mass . to exploit this methodology for a real - time quantum chemistry implementation",
    "one could require that the manipulations are done in a continuous fashion , i.e. , along a trajectory with sufficiently small configuration - change steps .",
    "as outlined in the beginning of this section the calculation of the energy gradient with respect to the position of the nuclear coordinates involves contributions from each term in the electronic energy . an efficient force evaluation for large molecular systems in the framework of pure dft",
    "has recently been proposed by reine _",
    "et al_.@xcite by combining screening with a fast multipole method . in addition",
    "the calculation of the coulomb contributions were accelerated by employing a density - fitting scheme@xcite with auxiliary basis sets .",
    "there are also efficient gradient implementations available that do not not employ density fitting@xcite .      to divide a molecular system under study into smaller subsystems",
    "is a key to the molecular - model approach discussed in the first two sections of this work and offers the possibility to reduce the computational effort further . as through a magnifying glass , the reactive part / region of a molecular assembly can be embedded in a spectator background and this magnifying lens can even be moved around in the whole system@xcite .",
    "so - called combined quantum mechanics / molecular mechanics ( qm / mm)@xcite approaches are widely employed to enable calculations of large enzymatic systems . in qm / mm the reactive part",
    "is treated quantum mechanically and the surrounding environment is modeled by classical force fields . by contrast , qm / qm methods apply the laws of quantum mechanics to all subsystem but may treat them with different methodologies@xcite .    depending on how the subsystems are embedded into each other a different level of acceleration can be achieved .",
    "completely independent subsystem methods  also called divide - and - conquer ( d&c ) approaches  facilitate a massively parallelized calculation . in the original formulation of the d&c approach the independently calculated density matrices of the subsystems were merged to yield the full density matrix@xcite .",
    "although the computation of the density matrices is done independently , the surrounding of a fragment is accounted for by buffer regions around the fragment .",
    "this approach does not only accelerate the calculation of the density matrix but also the calculation of the fock matrices in the scf calculations , which is the reason why this methodology is treated in this separate section and not together with other density matrix construction schemes .",
    "one difficulty for real - time quantum chemistry is , however , that the calculation of the d&c force for the full system is not well defined .",
    "but there are cures available@xcite .",
    "the partitioning can also be carried out for other quantities than the density - matrix .",
    "for instance , in the fragment molecular orbital theory the fragmentation is done at the level of the molecular orbitals.@xcite for a recent and comprehensive review on fragmentation methods we refer to ref .",
    "subsystem techniques allow for an in principle exact embedding of the subsystems thus retaining only the approximations introduced by choosing different electronic - structure methods for the subsystems . in the framework of density functional theory such methods have been proposed and are widely employed , for instance , to account for solvent effects@xcite .",
    "to assess the potential acceleration gained by any subsystem approach , one has to consider two aspects : ( i ) how small can the subsystems be chosen and ( ii ) how are they connected to each other , if at all .",
    "this affects not only the computation but also the accuracy .",
    "but since we are interested in local phenomena , the fragmentation is often already implied by the structure of the molecular system itself . clearly , the smaller the subsystems can be chosen and the less one has to account for embedding effects , the better for real - time quantum chemistry",
    ".    from the real - time quantum chemistry point of view",
    ", divide - and - conquer and density embedding approaches are appealing , since they allow the greatest reduction in computation time if the whole system needs to be treated quantum mechanically .",
    "if , however , large parts of the molecular system are not directly involved in a reaction , but rather serve as a dielectric environment , then qm / mm methods are most suitable .",
    "essentially all of the most popular quantum chemistry codes can be run in parallel .",
    "however , these software approaches usually have a rather high overhead making them not the best candidates for real - time quantum chemistry applications . but electronic structure calculations have not only been accelerated by developing increasingly efficient algorithms but also by employing latest and even specialized hardware .    although graphical processing units ( gpus ) were originally designed for the fast rendering of three dimensional graphics , they can be employed for the acceleration of quantum chemical calculations . in the past years the development and application of special algorithms for quantum chemical calculations that exploit the computing power of gpus has gained considerable attention.@xcite this trend is due to a significant effort undertaken to program quantum chemical algorithms specifically designed for gpus but also due to new graphic cards produced with a focus on scientific calculations .",
    "for example , the widely used gamess us package@xcite or the terachem program@xcite are able to efficiently exploit the advantages of gpus for electronic structure calculations . compared to calculations performed only on the central processing unit ( cpu ) of a computer they are able to achieve considerable speed - ups in the order of one magnitude.@xcite also in the field of semi - empirical calculations gpus",
    "have attracted some attention.@xcite    massive parallelization is also possible on processor architectures other than gpus . for kohn  sham dft calculation , for instance , the application of processors from clearspeed technology ltd .  has been reported to accelerate electronic structure and gradient calculations .",
    "@xcite besides these developments for specific processor types , there are also some more general considerations about how to exploit the advantages of emerging new processor types available in the literature.@xcite a comprehensive overview of special processors and their potential for electronic structure calculation can be found in ref .  .",
    "in the field of classical molecular dynamics simulations the so - called anton processor developed by shaw _",
    "et al_.@xcite is a successful attempt to build such a special purpose processor . also for electronic structure calculations special processors have been designed ; namely eric , the eri calculation specific chip - multiprocessor@xcite or the molecular orbital calculation specific embedded high performance computing ( ehpc ) system@xcite .",
    "almost all special processor types mentioned here accelerate the electronic structure calculations by parallelization of the eri calculation .",
    "this is the reason for the success of gpus but also of high performance clusters like , for instance , the ibm blue gene series@xcite .",
    "the calculations of eris is in almost all quantum chemical calculation the bottleneck because of their sheer number .",
    "specialized hardware which allows for a massive parallelization can directly accelerate the calculations and not only improves the scaling behavior .",
    "thus , exploiting these techniques is certainly imperative for real - time quantum chemistry .",
    "after having elaborated on the available and future quantum chemical methods for real - time quantum chemistry implementations , we shall now discuss their benefits for haptic quantum chemistry@xcite and subsequently discuss their capabilities in an out - of - the - box application presented in the next section .    the concept and implementation of haptic quantum chemistry as presented in refs .   is to employ a force - feedback device as depicted in fig .",
    "[ fig : hapticdevice ] as an input and an output tool allowing for an intuitive manipulation of molecular structures while feeling the gradients on the manipulated atoms as forces .",
    "such approaches are referred to as haptic enabled interactive molecular visualizations systems in the literature.@xcite there are a few such methods already available , but they only employ classical force fields to calculate the forces rendered by the device.@xcite thus , they prohibit the study of chemical reactions , which would require the ability tp form and break chemical bonds .    in our current set - up , the haptic device is a pen - like pointer which allows the user to manipulate objects in a virtual reality framework and , at the same time , to physically experience a force feedback ( cf .",
    "[ fig : hapticdevice ] ) .",
    "hence , one is able to feel the curvature of the potential energy surface of the manipulated nuclear coordinates in the whole system .",
    "the visual presentation of the structure , the gradients on the atoms not manipulated with the device , the orbitals , the electron density and other properties allow one to perceive complex information in a very intuitive way compared with the sole visual presentation .",
    "hence , the haptic quantum chemical approach immerses the scientist more into the scientific problem .",
    "even deeper immersion can of course be achieved by employing 3d displays or 3d glasses and other techniques from the field of virtual reality .    ]    since the human haptic sense is much more sensitive than the visual sense , haptic devices usually have an update rate of about @xmath62 .",
    "by contrast , to create the illusion of a smooth movement for the visual sense only @xmath63 are necessary . to circumvent this problem , in haptic quantum chemistry@xcite",
    "so far the forces are not calculated directly but are obtained from interpolating single - point gradients @xmath64 .",
    "the force @xmath65 acting on an atom @xmath40 is calculated from the interpolated gradient @xmath66 by @xmath67 where the gradient of the energy is given by @xmath68 here , @xmath69 denotes the three cartesian derivatives with respect the nuclear coordinate of atom @xmath40 .",
    "the computationally inexpensive interpolation facilitates the very fast calculation of the forces necessary for the high update rate of the haptic device .",
    "the main drawback is , however , that a coarse - grained gradient field of the molecular system needs to be calculated in advance ( though it can be refined during haptic exploration as more data points can be calculated in the background ) .",
    "the pre - calculation of single - point gradients becomes , however , more and more demanding if parts of the molecular structure are allowed to relax .",
    "the molecular structure at one specific position in the configuration space of the mobile part is no longer unique and depends on the trajectory leading to it . as a consequence , one has to design algorithms that keep track of the history of the actual haptic exploration run .",
    "however , employing a real - time quantum chemistry framework would allow us to circumvent this problem as the quantum chemical data is always immediately available so that no history ( trajectory ) needs to be stored .",
    "we may call this approach direct haptic quantum chemistry ( d - hqc ) .    at first glance",
    ", the high update rate ( more than 1 khz ) of the haptic device requires an update rate of a millisecond if the gradients from the electronic structure calculation were directly rendered by the device .",
    "but as it has been shown in the field of interactive fluid dynamics simulations , the servo loop of the haptic device and the simulation loop can be separated and can operate with different update rates.@xcite both loops are connected by a shared memory from where the servo loop constantly reads the current force written by the simulation loop as soon as the new force is available . to reduce the occurring artifacts the stepwise force update is smoothed by a force filter . with this technique the update rate of the molecular system can be lowered below @xmath70 . accordingly , d - hqc would require that within a few hundred millisecond a new gradient on the manipulated atoms has to be available and the other atom positions have to be relaxed ( fig .",
    "[ fig : progstruct ] ) .    ]",
    "this almost instantaneous relaxation of the whole structure is , however , not always wanted . by contrast",
    ", it might be even desired to be able to alter the molecular structure faster than the system relaxes in order to simulate non - adiabatic changes .",
    "therefore , the relaxation does not need to be instantaneous as long as the force change due to the relaxation can be rendered smoothly . for almost adiabatic changes",
    "the structure alterations have to be slowed down or done in small steps so that the structure of the whole system can relax .",
    "altering the structure only in very small increments also speeds up the electronic structure optimizations , since the molecular orbitals change only very little .",
    "the program could force the user to perform only small changes ( slow movements ) by applying re - stalling forces on the haptic device .",
    "d - hqc can be described as probing the potential energy surface in the configuration subspace spanned by the manipulated atoms of the molecular system . for a more formal description of the force calculation in d - hqc the set of nuclei @xmath40",
    "is partitioned into nuclei controlled by the haptic device @xmath71 and the remaining nuclei @xmath72 .",
    "the force on a nucleus @xmath71 is then calculated as the negative spatial derivative of the total energy , which is minimized with respect to the basis set @xmath73 and the nuclear coordinates of the remaining nuclei @xmath74 .",
    "@xmath75\\end{aligned}\\ ] ] with the total energy functional @xmath76 is given by @xmath77 = \\left\\langle \\psi_0(\\left\\ {   \\boldsymbol{r}_{i^\\prime } ,   \\boldsymbol{r}_{i^{\\prime\\prime } } \\right\\ } ) \\left|   \\hat{h}_\\textnormal{el}^\\textnormal{eff } \\right| \\psi_0(\\left\\ { \\boldsymbol{r}_{i^\\prime } ,   \\boldsymbol{r}_{i^{\\prime\\prime } } \\right\\ } ) \\right\\rangle \\,\\ , .\\end{aligned}\\ ] ]",
    "many of the above - mentioned developments of linear and sub - linear scaling methods are available in standard program packages , though the ultimate package for real time quantum chemistry has not been developed yet ",
    "mostly for the reason that each package has been designed to serve a certain purpose .",
    "for example , huge molecular models have already been studied with the cp2k @xcite program that employs mixed gaussian and plane wave basis sets in aimd simulations . here , we choose the very efficient dft modules of the turbomole package@xcite combined with our d - hqc setup to demonstrate that such studies are in reach for molecular models of relevant size .",
    "the calculations exploit density fitting , effective core potentials and small basis sets .",
    "it is clear that the resulting accuracy then does not necessarily live up to the current standard .",
    "however , this is also not decisive as a reaction pathway recorded during a d - hqc exploration can always be relaxed on a more accurate potential energy surface .",
    "[ fig : bromethen ]    as depicted in fig .",
    "[ fig : bromethen ] in this exemplary study a bromine molecule was pushed onto an ethene molecule to probe its reactivity . in this setup",
    "the position of the bromine atom closest to the ethene was dragged towards the ethene molecule so that the relaxation at each step had the bromine to ethene distance as a constraint . in this way a trajectory in the subspace spanned by the position of the bromine atom was generated .",
    "the distance was incrementally decreased by 0.5 bohr .",
    "the resulting distances in ngstroms are given in fig .",
    "[ fig : bromethen ] , which shows three exemplary points from the trajectory .",
    "in addition , the average time per structure relaxation step , i.e. , the time for updating the system s structure , as well as the overall time needed to converge the structure ( second line ) are depicted .    following the results of the discussion about basis sets we chose for the bromine atoms the stuttgart ecp-28-mwp pseudo potential@xcite and the def2-sv(p ) basis set , for the carbon atom the def2-sv(p ) basis set@xcite and for the hydrogen atoms the sto-3 g hondo basis set@xcite in order to obtain a very fast calculation of single - point energies and gradients .",
    "the calculations were performed employing the bp86 exchange  correlation density functional@xcite on a coarse numerical grid .",
    "in addition , also the resolution - of - identity technique ( ri)@xcite was applied to accelerate the calculations .",
    "the execution times in fig .",
    "[ fig : bromethen ] show that the time needed to update the system is almost constant during the trajectory , but the structure optimization time increases when the reactants get closer , which indicates that it needs more steps to converge . as it was outlined before",
    ", the update rate is the important quantity for a real - time experience .",
    "the execution times per update step can be shortened by sampling the trajectory in smaller steps , which means that the scf procedure can converge faster since the wave function does not change too much from step to step .",
    "the computations here were performed by running the individual turbomole modules sequentially .",
    "note that there is still room for improving the efficiency in terms of passing the information from one calculation to the next and avoid read / write accesses to the hard disk as these processes have not yet been optimized for a d - hqc implementation in standard programs like turbomole .",
    "another example with a more pronounced effect of structural relaxation of the remaining atom positions is expected to demonstrate how this influences the systems update rate : a s@xmath782 type reaction . in this example",
    "a fluoride ion approaches a chloromethane molecule and replaces the chlorine atom .",
    "the trajectory was recorded by moving the fluoride anion in steps of 0.1 bohr towards the c atom . at each step",
    "the structure of the remaining atoms was optimized .",
    "the intermediate electronic structure optimizations were carried out again with small basis sets ( def2-svp @xcite for the c , f , and cl atoms and sto-3 g hondo @xcite for the h atoms ) in combination with effective core potentials ( ecp-10-mwb@xcite for cl and ecp-2-sdf for f ) and bp86/ri on a coarse numerical grid . to reduce the number of scf cycles in each geometry optimization cycle the molecular orbitals from the preceding point of the trajectory were taken .    2 reaction of fluoride ( green ) and chloromethane .",
    "the chlorine atom is printed in blue .",
    "the distance from the attacking fluorine anion to the central carbon atom is written below the fluorine atoms . above the atoms the average time per single point in the optimization ( in ms ) and the overall time until structure convergence ( in s )",
    "is given . ]",
    "[ fig : sn2 ]    in figure [ fig : sn2 ] three intermediate points of the trajectory are shown .",
    "the average time per electronic structure calculation in the structure optimization is almost constant and on the order of several hundred milliseconds .",
    "the overall time for the structure optimizer to reach convergence is , however , not constant and increases significantly when the attacking fluoride approaches its position in the transition state .",
    "the detailed timings show again that not the electronic structure optimization but the increased number of cycles in the structure optimization give rise to the increased overall time .",
    "as already discussed in the previous section this is not a severe issue as only the system updates have to be fast , which is this case in this example .",
    "the user would have to slow down the movement of the fluoride when approaching the c atom in order to obtain a reasonable minimum energy path . for a non - adiabatic simulation",
    "the movement can be faster although the remaining atoms of the system are not able to relax in time .",
    "the possibility and necessity of obtaining the result of quantum chemical calculations in real time is beneficial in many respects for studying the reactivity of chemical systems and may change the way how quantum chemistry is done in the future .",
    "not only the ever increasing amount of information provided by calculations but also the inherent complexity of chemical problems calls for new approaches like ( direct ) haptic quantum chemistry that require a real - time quantum chemistry framework .",
    "the overview of currently available techniques to accelerate calculations provided here clearly showed that real - time quantum chemistry is in reach and will be possible for relevant system sizes in the near future .",
    "the evaluation of existing algorithms and technology for real - time quantum chemistry also demonstrated , however , that a paradigm change is needed .",
    "almost all techniques presented here were not specifically designed to allow quantum chemical calculations of energies and gradients in real time .",
    "the aim of their development was the overall scaling behavior to allow the treatment of ever larger molecules or molecular systems . for real - time quantum chemistry",
    "the focus needs to be on reducing the actual execution time for a fixed system size to around @xmath2 .",
    "although most of the currently available program packages in quantum chemistry have not been developed to allow the ultra - fast calculation of molecular systems consisting of @xmath79 atoms , the greatest potential for achieving considerable speed - up towards real time lies most probably in the activation of specialized hardware . already in reach",
    "are calculations on gpus which show a promising potential , but also completely new specialized hardware is desirable for real - time quantum chemistry .    the overwhelming amount and the complexity of the data generated by current quantum chemical calculations already limits their fast and intuitive evaluation .",
    "haptic quantum chemistry offers a new approach to tackle this problem .",
    "the instantaneous availability of the wave functions and the gradients offered by real - time quantum chemistry allows an even more convenient way of studying chemical reactivity , as we have discussed for the direct haptic quantum chemistry variant .",
    "the exploitation of the human haptic sense to present scientific data more intuitively is only a first step",
    ". a deeper immersion by employing techniques already developed in the field of virtual reality would be the ultimate goal of any development in this direction .",
    "we gratefully acknowledge financial support through th grant eth-08 11 - 2 .",
    "rubensson ,  e.  h. ; rudberg ,  e. ; salek ,  p. in _ linear - scaling techniques in computational chemistry and physics _ ; zalesny ,  r. ; papadopoulos ,  m.  g. ; mezey ,  p.  g. ; leszczynski ,  j. , eds . ; springer netherlands , * 2011 * , vol .  13 , pp 263300 .",
    "aquilante ,  f. ; boman ,  l. ; bostrm ,  j. ; koch ,  h. ; lindh ,  r. ; mers ,  a.  s. ; pedersen ,  t.  b. in _ linear - scaling techniques in computational chemistry and physics _ ; zalesny ,  r. ; papadopoulos ,  m.  g. ; mezey ,  p.  g. ; leszczynski ,  j. , eds . ; springer netherlands , * 2011 * , vol .  13 , pp 301343 .",
    "schmidt ,  m.  w. ; baldridge ,  k.  k. ; boatz ,  j.  a. ; elbert ,  s.  t. ; gordon ,  m.  s. ; jensen ,  j.  h. ; koseki ,  s. ; matsunaga ,  n. ; nguyen ,  k.  a. ; su ,  s. ; windus ,  t.  l. ; dupuis ,  m. ; montgomery ,  j.  a. _ j. comput .",
    "chem . _ * 1993 * , _ 14 _ , 13471363 .",
    "nakamura ,  k. ; honda ,  h. ; inoue ,  k. ; sato ,  h. ; uehara ,  m. ; komatsu ,  h. ; umeda ,  h. ; inadomi ,  y. ; araki ,  k. ; sasaki ,  t. et  al .",
    "proceedings of the workshop on unique chips and systems ( ucas ) , * 2005 * ; pp 8794 .",
    "bidmon ,  k. ; reina ,  g. ; bos ,  f. ; pleiss ,  j. ; ertl ,  t. eurohaptics conference , 2007 and symposium on haptic interfaces for virtual environment and teleoperator systems .",
    "world haptics 2007 .",
    "second joint , * 2007 * ; pp 537 542 ."
  ],
  "abstract_text": [
    "<S> significant progress in the development of efficient and fast algorithms for quantum chemical calculations has been made in the past two decades . </S>",
    "<S> the main focus has always been the desire to be able to treat ever larger molecules or molecular assemblies  especially linear and sub - linear scaling techniques are devoted to the accomplishment of this goal . </S>",
    "<S> however , as many chemical reactions are rather local , they usually involve only a limited number of atoms so that models of about two hundred ( or even less ) atoms embedded in a suitable environment are sufficient to study their mechanisms . </S>",
    "<S> thus , the system size does not need to be enlarged , but remains constant for reactions of this type that can be described by less than two hundred atoms . </S>",
    "<S> the question then arises how fast one can obtain the quantum chemical results . </S>",
    "<S> this question is not directly answered by linear - scaling techniques . </S>",
    "<S> in fact , ideas such as haptic quantum chemistry or interactive quantum chemistry require an immediate provision of quantum chemical information which demands the calculation of data in `` real time '' . in this perspective , we aim at a definition of real - time quantum chemistry , explore its realm and eventually discuss applications in the field of haptic quantum chemistry . </S>",
    "<S> for the latter we elaborate whether a direct approach is possible by virtue of real - time quantum chemistry .    _ </S>",
    "<S> submitted for publication as a perspective article in int .  </S>",
    "<S> j.  quantum chem . _ </S>"
  ]
}