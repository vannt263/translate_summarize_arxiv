{
  "article_text": [
    "the coronal magnetic field can be constrained in a number of ways , such as by extrapolation of photospheric magnetograms or vector - magnetograph data , by radio observations of gyroresonance layers above sunspots , of by coronal seismology of oscillating loops . before the advent of the stereo mission",
    ", attempts were made to model observed coronal loops with stretched potential field solutions ( gary and alexander , 1999 ) , to fit a linear force - free model with solar - rotation stereoscopy ( wiegelmann and neukirch , 2002 ; feng 2007a ) , by tomographic reconstruction with magnetohydrostatic constraints ( wiegelmann and inhester , 2003 ; ruan 2008 ) , by magnetic modeling applied to spectropolarimetric loop detections ( wiegelmann 2005 ) , or by magnetic field supported stereoscopic loop triangulation ( wiegelmann and inhester , 2006 ; conlon and gallagher , 2010 ) . recently ,",
    "stereoscopic triangulation of coronal loops with the stereo mission became available , which constrains the 3d geometry of coronal magnetic field lines ( aschwanden 2008 ; aschwanden , 2009 ) .",
    "the plethora of coronal high - resolution data allows us now to compare different magnetic models and to test whether they are self - consistent . a critical assessment of nonlinear force - free field ( nlfff ) codes revealed the disturbing fact that different nlfff codes yield incompatible results among themselves , and exhibit significant misalignments with stereoscopically triangulated loops ( derosa 2009 ; sandman 2009 ; aschwanden and sandman , 2010 ; sandman and aschwanden , 2010 ; aschwanden 2012a , b ) .",
    "the discrepancy was attributed to uncertainties in the boundary conditions as well as to the non - forcefreeness of the photosphere and lower chromosphere .",
    "earlier tests with the virial theorem already indicated that the magnetic fields in the lower chromosphere at altitudes of @xmath6 km are not force - free ( metcalf 1996 ) .",
    "constraints by coronal tracers thus have become an important criterion to bootstrap a self - consistent magnetic field solution .",
    "the misalignment between theoretical extrapolation models and stereoscopically triangulated loops could be minimized by using potential field models with forward - fitted unipolar magnetic charges ( aschwanden and sandman , 2010 ) or dipoles ( sandman and aschwanden , 2011 ) .    in this paper",
    "we go a step further by deriving a simple analytical approximation of nonlinear force - free field solutions that is suitable for fast forward - fitting to stereoscopically triangulated loops or to some other coronal observations .",
    "while accurate solutions of force - free magnetic fields have been known for special mathematical functions ( low and lou , 1990 ) that have been used to reconstruct the local twist of coronal loops ( malanushenko 2009 , 2011 ) , they are not suitable for forward - fitting to entire active regions . in contrast , our theoretical framework entails the representation of a potential or non - potential field by a superposition of a finite number of elementary field components that are associated with buried unipolar magnetic charges at arbitrary locations , each one being divergence - free and force - free to a good approximation , as we test numerically .",
    "while this paper contains the analytical framework of the magnetic field model , the numerical forward - fitting code with applications to observations will be presented in a paper ii ( aschwanden and malanushenko , 2012 ) , and applications to stereoscopically observed active regions in aschwanden ( 2012a , b ) .",
    "the simplest representation of a magnetic potential field that fulfills maxwell s divergence - free condition ( @xmath7 ) is a unipolar magnetic charge @xmath8 that is buried below the solar surface , which predicts a magnetic field @xmath9 that points away from the buried unipolar charge and whose field strength falls off with the square of the distance @xmath10 , @xmath11 where @xmath12 is the magnetic field strength at the solar surface above a buried magnetic charge , @xmath13 is the subphotospheric position of the buried charge , @xmath14 is the depth of the magnetic charge , @xmath15 and @xmath16 $ ] is the vector between an arbitrary location @xmath17 in the solar corona ( were we desire to calculate the magnetic field ) and the location @xmath13 of the buried charge .",
    "we choose a cartesian coordinate system @xmath18 with the origin in the sun center and are using units of solar radii , with the direction of @xmath19 chosen along the line - of - sight from earth to sun center . for a location near disk center ( @xmath20 ) ,",
    "the magnetic charge depth is @xmath21 .",
    "thus , the distance @xmath10 from the magnetic charge is @xmath22 the absolute value of the magnetic field @xmath23 is simply a function of the radial distance @xmath10 ( with @xmath12 and @xmath14 being constants for a given magnetic charge ) , @xmath24    in order to obtain the cartesian coordinates @xmath25 of the magnetic field vector @xmath9 , we can rewrite equation ( 1 ) as , @xmath26    .",
    "the radial field of each unipolar ( positive and negative ) charge is also shown for comparison ( dotted lines).,scaledwidth=80.0% ]    we progress now from a single magnetic charge to an arbitrary number @xmath27 of magnetic charges and represent the general magnetic field with a superposition of @xmath27 buried magnetic charges , so that the potential field can be represented by the superposition of @xmath27 fields @xmath28 from each magnetic charge @xmath29 , @xmath30    as an example we show the representation of a dipole with two magnetic unipolar charges ( @xmath31 ) of opposite polarity ( @xmath32 ) in figure 1 .",
    "each of the unipolar charges has a radial magnetic field ( dotted lines ) , but the superposition of the two vectors of both unipolar charges in every point of space , @xmath33 , reproduces the familiar dipole field . for the case shown in figure 1 we used the parameterization of two subphotospheric unipolar magnetic charges at positions @xmath34 and @xmath35 , which produces dipole - like field lines ( solid curves ) , while they converge to the classical solution of a dipole field in the limit of @xmath36 and @xmath37 , as it can be shown analytically ( jackson , 1972 ; p.184 ) .",
    "a common geometrical concept is to characterize coronal loops with cylindrical fluxtubes . for thin fluxtubes ,",
    "the curvature of coronal loops and the related forces can be neglected , so that a cylindrical geometry can be applied . because the footpoints of coronal loops are anchored in the photosphere , where a random velocity field creates vortical motion on the coronal fluxtubes , they are generally twisted .",
    "we consider now such twisted fluxtubes in a cylindrical geometry and derive a relation between the helical twist and the force - free parameter @xmath5 .",
    "the analytical solution of a uniformly twisted flux tube is described in several textbooks ( gold and hoyle , 1960 ; priest , 1982 ; sturrock , 1994 ; boyd and sanderson , 2003 ; aschwanden , 2004 ) , but we summarize the derivation here to provide physical insights for the generalized derivation of nonlinear force - free magnetic field solutions derived in section 2.3 in a self - consistent notation .     of the cylinder axis ,",
    "the number of twisting turns along this length , @xmath38 , or by the misalignment angle @xmath39 at the flux tube radius @xmath40 between the potential field line @xmath41 ( aligned with the cylindrical axis ) and the non - potential field line @xmath42 ( aligned with the twisted loop ) .",
    "the non - potential field line @xmath42 can be decomposed into a longitudinal field component @xmath43 and an azimuthal field component @xmath44.,scaledwidth=70.0% ]    we consider a straight cylinder where a uniform twist is applied , so that an initially straight field line @xmath45 , aligned with a field line coordinate @xmath46 , is rotated by a number @xmath38 of full turns over the cylinder length @xmath47 , yielding an azimuthal field component @xmath44 at radius @xmath40 , @xmath48 with the constant @xmath49 defined in terms of the number of full twisting turns @xmath38 over a ( loop ) length @xmath47 .",
    "the cylindrical geometry of a twisted flux tube is visualized in figure 2 .",
    "the longitudinal component of the untwisted magnetic field corresponds to a potential field vector @xmath41 , while the twisted non - potential field line @xmath42 has a helical geometry with an angle @xmath39 at a radius @xmath40 , which can be described by the longitudinal component @xmath43 and the azimuthal component @xmath44 .",
    "the fluxtube can be considered as a sequence of cylinders with radii @xmath40 , each one twisted by the same twist angle @xmath50 . for uniform twisting , the magnetic components @xmath44 and @xmath43 depend only on the radius @xmath40 , but not on the length coordinate @xmath46 or azimuth angle @xmath51 .",
    "thus , the functional dependence in cylindrical coordinates @xmath52 is @xmath53 =                    \\left [ 0   , b_{\\varphi}(\\rho ) , b_s(\\rho ) \\right ]   \\ .\\ ] ] consequently , the general expression of @xmath54 in cylindrical coordinates , @xmath55 \\ , \\ ] ] is simplified with @xmath56 and the sole dependencies of @xmath57 and @xmath58 on the radius @xmath40 ( equation ( 7 ) ) , yielding a force - free current density @xmath59 of , @xmath60                  = { c \\over 4\\pi } ( { \\nabla } \\times { \\bf b } )                  = { c \\over 4\\pi } \\left [ 0 , - { \\partial b_s \\over \\partial \\rho } ,                  { 1 \\over \\rho } \\left ( { \\partial \\over \\partial \\rho }          ( \\rho b_{\\varphi})\\right ) \\right ] \\ .\\ ] ] requiring that the lorentz force is zero for a force - free solution , @xmath61 , we obtain a single non - zero component in the radial @xmath40-direction , since @xmath62 and @xmath56 for the two other components , @xmath63 \\ , \\ ] ] yielding a single differential equation for @xmath43 and @xmath44 , @xmath64 by substituting @xmath65 from equation ( 7 ) into equation ( 12 ) , this simplifies to , @xmath66 = 0 \\ .\\ ] ] a solution is found by making the expression inside the derivative to a constant ( @xmath67 ) , which yields @xmath44 and @xmath43 , @xmath68 =          \\left [ 0 , { b_0 \\ b \\rho \\over 1 + b^2 \\rho^2 } , { b_0 \\over 1 + b^2 \\rho^2 }       \\right ] \\ .\\ ] ] [ this equation corrects also a misprint in equation ( 5.5.8 ) of aschwanden ( 2004 ; p.216 ) , where a superflous zero component has to be eliminated ] . with the definition of the force - free @xmath5-parameter , @xmath69 we can now verify",
    "that the @xmath5-parameter for a uniformly twisted fluxtube depends only on the radius @xmath40 , @xmath70 with the constant @xmath49 defined in terms of the number of full twisting turns @xmath38 over a ( loop ) length @xmath47 ( see equation ( 7 ) ) , @xmath71    -plane ( top ) and from the top view in the @xmath72-plane ( bottom ) .",
    "the top panels show the longitudinal magnetic field component @xmath58 and the bottom panels show the azimuthal magnetic field component @xmath73.,scaledwidth=80.0% ]    the geometry of a twisted flux tube is visualized in figure 3 ( top middle ) , where the parallel field lines are aligned with the coordinate axis @xmath46 in the vertical direction , the cross - sectional radius @xmath40 is defined in the direction perpendicular to @xmath46 , and the twist angle @xmath51 is indicated in the horizontal projection ( figure 3 , bottom middle ) . according to equations ( 8) and ( 14 ) , the variations of the longitudinal @xmath58 and of the azimuthal component @xmath57 with radius @xmath40 are , @xmath74 @xmath75 these radial dependencies are shown in figure 4 for different numbers of twist ( @xmath76 ) . in the limit of vanishing twist ( @xmath77 ) , we have an untwisted flux tube ( figure 3 left ) with a constant longitudinal field @xmath78 and a vanishing azimuthal component @xmath79 .",
    "the dependence of the azimuthal field component @xmath57 and the longitudinal field component @xmath58 as a function of the radius @xmath80 from the twist axis ( figure 4 ) shows that the longitudinal component falls off monotonically with radius @xmath40 , while the azimuthal component increases first for small distances @xmath81 , but falls off at larger distances .",
    "thus , the twisting causes a smaller cross - section of a fluxtube compared with the potential field situation , as widely known ( klimchuk 2000 ) .     from the twist axis field",
    "is shown for three different amounts of twist ( @xmath82 full turns per loop length @xmath47).,scaledwidth=80.0% ]      we are now synthesizing the concept of point - like buried magnetic charges that we used to parameterize a potential field ( section 2.1 ) with the uniformly twisted flux tube concept that represents an exact solution of a nonlinear force - free field ( section 2.2 ) .",
    "the geometric difference between the two concepts is the spherical symmetry of a point charge versus the parallel field configuration of an untwisted flux tube .",
    "however , we can synthesize the two geometries by considering the parallel field as a far - field approximation of a radial field . in an euclidean parallel field ,",
    "the equi - potential surface is a plane perpendicular to the parallel field vector , while a radial field has spherical equi - potential surface .",
    "we can make the transformation of a parallel field in cylindrical coordinates @xmath83 into a radial field with spherical coordinates @xmath84 by mapping ( see figure 3 ) , @xmath85 this transformation from cylindrical to spherical coordinates preserves the orthogonality of the longitudinal field component @xmath86 to the equi - potential surface ( @xmath87const @xmath88const ) and conserves the magnetic flux @xmath89 along a bundle of field lines with area @xmath90 , @xmath91 if the longitudinal component @xmath92 ( equation ( 1 ) ) decreases quadratically with distance from the magnetic charge .",
    "thus , applying the transformation into spherical coordinates ( equation ( 20 ) ) and the magnetic flux conservation ( equation ( 21 ) ) to the straight flux tube solution ( equations ( 18 ) and ( 19 ) ) , we can already guess the approximate nonlinear force - free solution in spherical coordinates , @xmath93 @xmath94    more rigorously , we can derive a nonlinear force - free field solution by writing the divergence - free condition @xmath95 and the force - free condition @xmath96 ( equation ( 15 ) ) of a magnetic field vector ( @xmath97 in spherical coordinates @xmath84 ( with the origin at the location of the magnetic charge and the spherical symmetry axis aligned with the vertical direction to the local solar surface ) , @xmath98 @xmath99_r =      { 1 \\over r \\sin{\\theta } }      \\left[{\\partial \\over \\partial \\theta }      ( b_\\varphi \\sin{\\theta } ) -      { \\partial b_\\varphi \\over \\partial \\varphi } \\right ]      = \\alpha b_r \\ , \\ ] ] @xmath99_\\theta =      { 1 \\over r }      \\left[{1 \\over \\sin{\\theta } } { \\partial b_r \\over \\partial \\varphi }      -{\\partial \\over \\partial r } ( r b_\\varphi ) \\right ]      = \\alpha b_\\theta \\ , \\ ] ] @xmath99_\\varphi =      { 1 \\over r }      \\left[{\\partial \\over \\partial r } ( r b_\\theta )       -{\\partial b_r \\over \\partial \\theta } \\right ]      = \\alpha b_\\varphi \\ .\\ ] ] for a simple approximative nonlinear force - free solution we require axi - symmetry with no azimuthal dependence ( @xmath100 ) and neglect components that contribute only to second order ( @xmath101 ^ 2 \\approx 0)$ ] , in analogy to the uniformly twisted flux tubes on cylindrical surfaces ( figure 2 ) .",
    "this requirement simplifies equations ( 24)(27 ) to , @xmath102 @xmath103 @xmath104 @xmath105 eliminating @xmath5 from equations ( 29 ) and ( 31 ) and using the analog _ ansatz _ as for cylindrical fluxtubes ( equation ( 7 ) ) , @xmath106 we obtain a similar differential equation as in equation ( 13 ) , @xmath107 = 0 \\ .\\ ] ] a solution of this differential equation is obtained by setting the expression inside the bracket to the constant @xmath108 , which fulfills the divergence - free condition ( equation ( 28 ) ) , and we obtain a solution for @xmath109 and @xmath110 ( using equation ( 32 ) ) , for @xmath5 ( using equation ( 29 ) ) , @xmath111 @xmath112 @xmath113 @xmath114 this solution fulfills both the force - free condition ( equations ( 29)(31 ) ) and the divergence - free condition ( equation ( 28 ) ) to second - order accuracy ( @xmath115 ^ 2 $ ] ) .",
    "we see that this solution is identical with the simplified derivation of equations ( 22 ) and ( 23 ) . at locations near the twist axis ( @xmath116 ) ,",
    "the general solution ( equations ( 34)(37 ) ) converges to the cylindrical flux tube geometry solution ( equations ( 18 ) and ( 19 ) ) .",
    "furthermore , in the limit of vanishing twist ( @xmath117 ) we retrieve the potential - field solution ( equation ( 4 ) ) , since the force - free parameter becomes @xmath118 , the azimuthal field component becomes @xmath119 , and the radial component reproduces the potential - field solution @xmath120 .",
    "buried at a subphotospheric position @xmath121 is shown .",
    "the central twist axis ( dashed line ) intersects an equi - potential surface at position @xmath122 and the longitudinal field vector @xmath109 at position @xmath18 has a radial distance @xmath40 from the twist axis and an azimuth angle @xmath51 .",
    "the azimuthal magnetic field component @xmath44 at location @xmath18 is orthogonal to the radial vector @xmath80 and the longitudinal field component @xmath109 , as well as to the direction of the twist axis @xmath123.,scaledwidth=60.0% ]      in the derivation in the last section we derived the solution in terms of spherical coordinates @xmath84 in a coordinate system where the rotational symmetry axis is aligned with the vertical to the solar surface intersecting a magnetic charge @xmath8 . since we are going to model a number of magnetic charges at arbitrary positions on the solar disk , we have to transform an individual coordinate system @xmath124 associated with magnetic charge @xmath8 into a cartesian coordinate system @xmath18 that is given by the observers line - of - sight ( in @xmath19-direction ) and the observer s image coordinate system @xmath125 in the plane - of - sky .",
    "the variables of the cartesian coordinate transformation are shown in figure 5 .",
    "the radial magnetic field vector @xmath126 ( which is pointing radially away from a magnetic charge @xmath8 located in the solar interior at @xmath13 is simply given by the difference of the cartesian coordinates from an arbitrary location @xmath18 , @xmath127      = \\left [ \\cos_{r , x } , \\cos_{r , y } , \\cos_{r , z } \\right ] \\ , \\ ] ] where @xmath109 is the absolute value of the radial magnetic field component @xmath128 ( equation ( 34 ) ) , @xmath10 is the spatial length of the radial vector @xmath129 ( equation ( 3 ) ) , defining the directional cosines @xmath130 ( for the 3d coordinates @xmath131 ) of the radial magnetic field vector @xmath126 .",
    "the azimuthal component @xmath132 ( with the absolute value @xmath133 defined in equation ( 35 ) ) of the twisted magnetic field is orthogonal to the direction of the twist axis @xmath123 ( aligned with the local vertical ) , @xmath134 \\ , \\ ] ] and the radial magnetic field component @xmath126 ( figure 5 ) , and thus can be computed from the vector product of the two vectors @xmath126 and @xmath123 , @xmath135\\ , \\ ] ] which defines the directional cosines @xmath136 of the azimuthal component in the cartesian coordinate system .",
    "the vector product allows us also to extract the inclination angle @xmath137 between the radial magnetic field component @xmath126 and the local vertical direction @xmath123 , @xmath138    finally , the total non - potential magnetic field vector @xmath139 is then the vector sum of the radial @xmath126 and the azimuthal magnetic field component @xmath140 , @xmath141 with the directional cosines ( @xmath130 , @xmath136 , @xmath142 ) defined by equations ( 38 ) and ( 40 ) .",
    "this is a convenient parameterization that allows us directly to calculate the magnetic field vector of the non - potential field @xmath143 associated with a magnetic charge @xmath8 that is characterized with five parameters : @xmath144 , where we define the force - free @xmath5-parameter from the twist parameter @xmath145 ( equation ( 7 ) ) at the location of the twist axis ( @xmath146 ) , @xmath147 according to equation ( 37 )",
    ".      the total non - potential magnetic field from all @xmath29 magnetic charges can be approximately obtained from the vector sum of all components @xmath8 ( in an analog way as we applied in equation ( 6 ) for the potential field ) , @xmath148 where the vector components @xmath149 of the non - potential field of a magnetic charge @xmath8 are defined in equation ( 42 ) , which can be parameterized with @xmath150 free parameters @xmath144 for a non - potential field , or with @xmath151 free parameters for a potential field ( with @xmath152 ) .",
    "of course , the sum of force - free magnetic field vectors is generally not force - free , but we will prove in the following ( equations ( 46 ) and ( 47 ) ) that the sum of nlfff solutions of the form of equations ( 34)(37 ) ) , which are force - free to second - order accuracy in @xmath5 ( or , more strictly , in @xmath153 $ ] ) , have the property that their sum is also force - free to second - order in @xmath5 .",
    "let us first consider the condition of divergence - freeness . since the divergence operator is linear , the superposition of a number of divergence - free fields is divergence - free also , @xmath154 while the divergence - free condition is exactly fulfilled for a potential field solution ( equation ( 4 ) ) , our quasi - forcefree approximation ( equations ( 34)(37 ) ) matches this requirement to second order in @xmath5 , as the insertion of the solutions ( equations ( 34)(37 ) ) into the divergence expression ( equation ( 24 ) ) shows .",
    "for a quantitative measure of this level of accuracy we can also check numerical tests of the figure of merit ( section 3.3 ) .    now , let us consider the condition of force - freeness .",
    "a force - free field has to satisfy maxwell s equation ( equation ( 15 ) ) .",
    "since we parameterized both the potential field and the non - potential field with a linear sum of @xmath27 magnetic charges , the requirement would be , @xmath155 generally , these three equations of the vector @xmath156 can not be fulfilled with a scalar function @xmath157 for a sum of force - free field components , unless the magnetic field volume consists of spatially separated force - free subvolumes .",
    "however , we can show the validity of the force - freeness equation ( equation ( 46 ) ) to second - order accuracy in @xmath5 .",
    "note , that the nonlinear force - free parameter @xmath5 is proportional to @xmath49 ( equations ( 37 ) and ( 43 ) ) , which is defined in equation ( 17 ) , and thus we set second - order accuracy in @xmath49 equal to second - order accuracy in @xmath5 .",
    "the argument goes as follows .",
    "if we use spherical coordinates , the nlfff solution of the radial component is of zeroth order , @xmath158 ( equation ( 34 ) ) , the azimuthal component is of first order , @xmath159 ( equation ( 35 ) ) , and the neglected third component magnetic field component is of second - order , @xmath160 ( as it can be shown by inserting @xmath109 and @xmath110 into equation ( 26 ) .",
    "the curl of the magnetic field ( equations ( 25)(27 ) ) is then of first order for the radial component , @xmath161_r \\propto \\alpha b_r \\propto o(\\alpha^1)$ ] ( equation ( 25 ) ) , to second order for the azimuthal component , @xmath161_\\varphi \\propto ( \\alpha b_\\varphi ) \\propto o(\\alpha^2)$ ] ( equation ( 27 ) ) , and the remaining third component is of third - order , @xmath161_\\theta   \\propto ( \\alpha b_\\theta ) \\propto o(\\alpha^3)$ ] ( equation ( 26 ) )",
    ".    therefore , if we neglect second - order and higher - order terms , the divergence - free condition ( equation ( 46 ) ) , which generally has three equations for the three curl components , @xmath162_r$ ] , @xmath163_\\varphi$ ] , @xmath164_\\theta$ ] , reduces to one single equation for the radial component , @xmath162_r$ ] , which can be fulfilled with a scalar function @xmath157 , @xmath165_r \\over b_r }       = { [ \\nabla \\times \\sum_{j=1}^{n_{\\rm m } } { \\bf b}_j]_r        \\over \\sum_{j=1}^{n_{\\rm m } } { \\bf b}_{j , r } }       = { [ \\sum_{j=1}^{n_{\\rm m } } \\nabla \\times { \\bf b}_j]_r        \\over \\sum_{j=1}^{n_{\\rm m } } { \\bf b}_{j , r } }       = { \\sum_{j=1}^{n_{\\rm m } } \\alpha_j b_j \\over         \\sum_{j=1}^{n_{\\rm m } } b_j } \\ .\\ ] ] thus , we expect that the force - freeness is fulfilled to second - order accuracy @xmath166 ( or strictly speaking @xmath167 )",
    ". we will demonstrate the near force - freeness of simulated examples in the next section .",
    "we are now going to simulate examples of the analytical nonlinear force - free solutions in order to visualize the magnetic topology and to quantify the accuracy of the divergence - free and force - free conditions .",
    "plane ( left ) and into the vertical @xmath168 plane ( right ) .",
    "thre three cases include : ( a ) a single positive magnetic charge ( first row ) , ( b ) a dipole produced by two magnetic charges with opposite polarity ( second row ) , and ( c ) a quadrupole configuration ( third row ) .",
    "see parameters in table 1",
    ". only field lines with magnetic fields above a 50% threshold of the maximum field strength are shown.,scaledwidth=100.0% ]     plane ( left ) and into the vertical @xmath168 plane ( right ) .",
    "the parameters of the three cases ( d ) , ( e ) , and ( f ) are identical to thoes of ( a ) , ( b ) , and ( c ) , except for the addition of electric currents.,scaledwidth=100.0% ]     plane ( left ) and into the vertical @xmath168 plane ( right ) . the three cases ( g ) , ( h ) , and ( i ) have each @xmath169 magnetic charges , with randomly chosen field strengths , locations , and electric currents.,scaledwidth=100.0% ]      the simplest case is a single magnetic charge @xmath170 , which we illustrate as case a in figure 6 ( top row ) .",
    "we choose the following parameters : a magnetic field strength of @xmath171 g ( gauss ) at the solar surface directly above the buried charge , the location @xmath172 for the buried charge , and a number of zero twist @xmath173 for the potential field case .",
    "we show the simulated line - of - sight magnetogram @xmath174 in figure 1 ( top left ) , which mimics an isolated sunspot",
    ". the pixel size of the magnetogram and the stepping size in the extrapolation along a field line is @xmath175 solar radii ( 2800 km @xmath176 , corresponding to the pixel size of soho / mdi magnetograms ) .",
    "we extrapolate the field lines for every pixel that has a footpoint magnetic field strength above a threshold of 50% ( @xmath177 g ) .",
    "the field lines point in radial direction away from the center of the buried magnetic charge , as it is expected for the potential field of an isolated sunspot ( and defined in equation ( 1 ) ) .",
    "the next basic example is a magnetic dipole , which can be represented in our model by a superposition of a pair of two magnetic charges with opposite polarity , as sketched in figure 1 .",
    "the case b shown in figure 6 is simulated with equal , but oppositely signed magnetic field strengths ( @xmath171 g , @xmath178 g ) at mirrored positions ( @xmath179 ) , otherwise we used the same parameters as in case a ( @xmath180 ) .",
    "the magnetic field lines mimic the familiar structure of a dipole , which is parameterized here with 8 free parameters ( in the potential case ) .",
    "a quadrupolar configuration is simulated in case c ( figure 6 , bottom ) , with translational symmetry ( @xmath181 ) , equal depths ( @xmath182 ) , and alternating field strengths ( @xmath183 g ) .",
    "the quadrupolar configuration shows essentially two bipoles , each one with field lines that mostly connect within the same dipole domain , but a few intermediate field lines actually connect from one to the other domain .    in figure 7",
    "we show the same three configurations as for the potential field model ( a , b , c of figure 6 ) , but add electric currents caused by twisting , corresponding to @xmath184 turns for the single charge ( case d ) or first dipole ( case e ) , and @xmath185 for the second dipole ( case f ) , defined for a loop length of @xmath186 solar radii .",
    "these amounts of twist correspond to force - free @xmath5-parameters of @xmath187 and @xmath188 solar radius@xmath189 ( @xmath190 and @xmath191 cm@xmath189 ) .",
    "comparing the potential ( figure 6 ) and non - potential cases ( figure 7 ) shows clearly the differences that result from the presence of electric currents .",
    "the force - free field lines of a sunspot become distorted into spiral shapes ( case d ) , the straight dipole becomes distorted into a sigmoid shape ( case e ) , and the quadrupolar configuration becomes also more distorted with sigmoid - like structures ( case f ) .    in figure 8 we show a few more complicated cases ( g , h , and i ) , consisting of @xmath169 magnetic charges , with random values chosen in the magnetic field range @xmath193 g @xmath194 g , in positions @xmath195 solar radii , @xmath196 solar radii , @xmath197 solar radii , and random twist in the range @xmath198 per @xmath186 solar radii .",
    "the field lines displayed in figure 8 demonstrate that a rich variety of sigmoid - shaped dipoles and inter - connecting multi - pole configurations can be generated with our quasi - force - free solutions , which mimic realistic active regions observed in the solar corona .",
    "( left panels ) , the electric current density @xmath199 , and the force - free @xmath5-parameter ( right panels).,scaledwidth=100.0% ]      in figure 9 we show examples of various maps that can be generated to visualize a 3d vector field solution , for the case f of a quadrupolar configuration with currents .",
    "we show the following quantities in the image plane @xmath200 , which corresponds to an image plane near the solar surface : the three magnetic field vector component maps @xmath201 , @xmath202 , @xmath174 ( figure 9 , left panels , the vertical electric current map @xmath199 ( figure 9 , top right panel ) , the nonlinear @xmath5-parameter @xmath203 ( figure 9 , middle right panel ) , and the los magnetogram @xmath174 together with extrapolated field lines ( figure 9 , bottom right panel ) .",
    "the @xmath204 map shows most clearly the locations of the four buried magnetic charges that form two dipolar or a quadrupolar configuration . the magnetic polarization is also reflected in the @xmath205 and @xmath5-map .",
    "the @xmath204 and the @xmath5-map show also the location of the neutral line , where numerical effects due to the limited spatial resolution become visible .",
    ".figures of merit for nine simulations of nonlinear force - free field solutions , detailing the size of the 3d datacube , the number of magnetic charges ( @xmath27 ) , potential or non - potential model ( p and np ) , the number of computed field lines @xmath206 , the divergence - freeness @xmath207 , the force - freeness @xmath208 , and the computation times @xmath209 . [ cols= \" < , > , > , > , > , > , > \" , ]      the degree of convergence towards a divergence - free magnetic field model solution can be quantified by a measure that compares the average divergence @xmath210 , which should be close to zero , with the gradient @xmath211 of the magnetic field over a reference length scale @xmath212 , for instance a pixel of the computational grid",
    ". the average deviation can then be defined by ( see also wheatland ( 2000 ) or schrijver ( 2006 ) ) , @xmath213 similarly , the force - freeness can be quantified by the ratio of the lorentz force , @xmath214 to the normalization constant @xmath215 , @xmath216 where @xmath217 .",
    "we calculated these figure of merit quantities for the nine cases simulated in figures 6 - 9 .",
    "the values are listed in each of the panels in figures 6 - 8 and listed in table i. the potential - field cases ( a , b , and c ) are found to have a figure of merit in the range of @xmath218 for the divergence - freeness , and @xmath219 for the force - freeness .",
    "the non - potential field cases ( d , e , f , g , h , and i ) have values in similar ranges of @xmath220 for the divergence - freeness , and @xmath221 for the force - freeness .",
    "we find no tendency that this figure of merit depends on the number of magnetic charges or some other model parameters .",
    "the fact that our quasi - force free analytical solutions perform equally well as standard nlfff codes described in schrijver _",
    "( 2006 ) tells us that the inaccuracy of the analytical approximation is commensurable or even smaller than the numerical uncertainty of other nlfff codes .",
    "however , since our analytical solution provides an explicit formulation of nonlinear force - free fields , it can be computed much faster than the standard nlfff codes , and still provides approximate solutions with acceptable accuracy ( to second order ) .",
    "the computation time of the analytical solutions for the cases shown in figures 6 - 8 amounts to about 1 s ( on a recent mac computer : mac os x , @xmath222 ghz quad - core intel xeon , memory 32 gb 800 mhz ddr2 fb - dimm ) , while standard iterative nlfff codes need several hours to converge to a single nlfff solution .",
    "the coronal magnetic field has generally been computed by extrapolation from lower boundary data in form of photospheric magnetograms @xmath223 or vector - magnetograph data @xmath224 , using a numerical extrapolation algorithm that fulfills the conditions of force - freeness ( @xmath210 ) and divergence - freeness @xmath225 , where @xmath157 is a scalar function in space @xmath226 .",
    "these extrapolation algorithms are very computing - intensive , because a good solution requires many iterations on a large computational 3d - grid that has sufficient spatial resolution to resolve the relevant magnetic field gradients .",
    "the accuracy of these numerical solutions depends very much on the noise in boundary vector magnetic field data as well as on deviations of photospheric fields from a force - free state .",
    "recent stereoscopic triangulation of coronal loops has demonstrated a considerable mismatch between the extrapolated fields and the actual coronal loops , which can not easily be reconciled with extrapolation algorithms , since they have only a very limited degree of freedom within the noise of the boundary data . moreover , since each nlfff solution is very time - consuming to compute , these algorithms are not suitable for forward - fitting .",
    "the forward - fitting of magnetic field solutions to observed data requires a faster algorithm to compute many nlfff solutions for variable boundary data or for coronal constraints as given by stereoscopic 3d reconstructions .",
    "the fastest computational way would be an explicit analytical solution for the coronal field vectors @xmath227 as a function of some suitable parameterization of the boundary data or coronal constraints .",
    "there exist some analytical solutions of nonlinear force - free fields , such as a class of solutions in terms of legendre polynomials ( low and lou , 1990 ) , which is characterized by some spatial symmetry and has been used to test numerical extrapolation algorithms ( derosa 2009 ; malanushenko 2009 ) .",
    "however , to our knowledge , the class of analytical nlfff solutions of low and lou ( 1990 ) has never been applied to forward - fitting of observed data , such as line - of - sight magnetograms , vector magnetograph 3d data , or to stereoscopically triangulated loops . moreover , the special class of nlfff solutions derived in low and lou ( 1990 ) correspond to harmonics of legendre polynomials , which have a high degree of symmetry that does not match realistic observations of active regions , and thus is not suitable for forward - fitting to real data .",
    "what we need to model observed solar magnetic data with high accuracy is : ( 1 ) an explicit formulation of an analytical nlfff solution ; ( 2 ) a parameterization of the nlfff solution with a sufficient large number of free parameters that can be forward - fitted to data and converges close to observations ; and ( 3 ) a fast computation algorithm that can perform many interations without computing - intensive techniques .",
    "hence , such a project consists of developing a suitable analytical formulation first , and then to implement the analytical solutions into a forward - fitting code . in this paper",
    "we have undertaken the first step .",
    "we started with a potential - field parameterization in terms of @xmath27 buried magnetic charges , which is defined by @xmath151 free parameters that can easily be extracted from an observed line - of - sight magnetogram @xmath174 with arbitrary accuracy , as demonstrated in two recent studies ( aschwanden and sandman , 2010 ; aschwanden 2012a ) .",
    "the key concept of this potential - field representation is that an arbitrary complex 3d magnetic field can be decomposed into a finite number of elementary magnetic field components , where each one simply consists of a quadratically decreasing radial field of a buried magnetic charge .",
    "divergence - freeness is conserved due to the linearity in the superposition of elementary field components . in a next step",
    "we extended the elementary potential - field component to a nonpotential - field component by adding a uniform twist that can be parameterized by the force - free @xmath5-parameter .",
    "such an elementary nonpotential field component requires five free parameters , consisting of the four potential - field parameters plus the force - free @xmath5-parameter .",
    "we derived an explicit analytical formulation of the radial @xmath228 and azimuthal field vector @xmath229 that represents an approximative solution of the divergence - free and force - free condition to second order ( @xmath230 ) .",
    "this solution is very accurate for weakly non - potential fields and converges to the potential field solution for @xmath231 . in analogy to the potential - field representation , we represent a general non - potential field solution with a superposition of elementary non - potential field components and prove that the divergence - freeness and force - freeness is conserved to second - order accuracy in our nlfff approximation .",
    "we calculated some examples of potential and non - potential fields that mimic an isolated sunspot , a dipolar and a quadrupolar configuration , as well as more complex multi - polar configurations .",
    "the examples show that the magnetic field of arbitrary complex active regions can be represented with our parameterization .",
    "increasing the force - free @xmath5-parameter distorts circular field lines into helical and sigmoid - shaped geometries .",
    "our parameterization allows one to compute either field lines ( starting from arbitrary locations ) , 3d datacubes of magnetic field vectors , of maps of the force - free @xmath5-parameter and electric current @xmath205 ( figure 9 ) .",
    "we tested the figures of merit for divergence - freeness and force - freeness , which amount to @xmath232 and @xmath233 .",
    "the examples demonstrate also the computing speed of this algorithm , which amounts to the order of @xmath234 s for a computation grid that encompasses a typical active region with the spatial resolution of mdi .",
    "thus , we envision that a full - fletched forward - fitting code can converge within a few seconds to a few minutes , depending on the number of iterations and number of magnetic field components .    where do we go from here ?",
    "the next step is the development of a forward - fitting code that uses the magnetic field parameterization described here ( see paper ii ) .",
    "we envision the applications to at least three different sets of constraints , requiring three different versions of forward - fitting codes : ( i ) line - of - sight magnetograms @xmath174 and 3d coordinates @xmath235 $ ] of stereoscopically triangulated loops ; ( ii ) line - of - sight magnetograms @xmath174 and 2d coordinates @xmath236 $ ] of traced loops ; and ( ii ) vector - magnetograph data @xmath237 , @xmath202 , @xmath238 $ ] .",
    "the first application requires stereo data , while the second one can be obtained from any euv imager ( aia / sdo , trace , eit/ soho )",
    ". the third application can be conducted with the new hmi / sdo data and is equivalent to other nlfff extrapolation codes without coronal constraints , while the first two use coronal tracers and alleviate the force - free assumption of photospheric data .",
    "we envision that these three applications will reveal insights into a number of crucial questions in a novel way .",
    "there is a large number of physical problems and issues that can be addressed with the anticipated forward - fitting code , such as : ( i ) the force - freeness of the photosphere ; ( ii ) the accuracy of nlfff solutions ; ( iii ) the spatial distribution of electric currents in active regions ; ( iv ) the temporal evolution of currents before and during flares ; ( v ) the spatial distribution of current dissipation and coronal heating ; ( vi ) helicity injection ; ( vii ) the 3d geometry of coronal loops which is needed for hydrodynamic modeling ; ( viii ) scaling laws of the volumetric heating function with other physical parameters ; ( ix ) tests of the magnetic field strength inferred from coronal seismology , there exists hardly a phenomenon in the solar corona that can be modeled without the knowledge of the coronal magnetic field .",
    "a simple geometry of a force - free field structure is the gold - hoyle flux rope ( gold and hoyle , 1960 ) , which consists of a curved axis with helical field lines curved around the axis ( figure 10 ) .",
    "while the stretched version of a flux rope with a straight twist axis has the exact force - free solution of a uniformly twisted flux tube ( section 2.2 ) , the curved version of the gold - hoyle flux rope is subject to curvature forces due to the gradient of the magnetic field across the flux rope diameter and has a modified force - free solution .",
    "( potential field line ) , stable sigmoid ( @xmath239 ; solid line ) , and unstable sigmoids ( @xmath240 ; dashed lines ) , according to our parameterization of point charges with twisted vertical axes .",
    "note that the limit of large twist numbers does not turn into a gold - hoyle flux rope ( figure 10 ) with our parameterization.,scaledwidth=80.0% ]    in order to explore the limitations of our force - free field parameterization we attempt here to model such a gold - hoyle flux rope .",
    "we use the coordinates @xmath241 and @xmath242 ) with @xmath243 and @xmath244 solar radii ( marked with diamonds in figure 11 ) and extrapolate field lines @xmath245 with our method , starting from the apex position @xmath246 with @xmath247 , for a set of six cases with various force - free parameters @xmath248 , where the @xmath5 s associated with the twist axis of each buried charge are defined by @xmath249 , with the loop length @xmath250 and the number of twist turns @xmath251 ( indicated with @xmath252 in figure 11 ) .",
    "the case @xmath253 corresponds to the potential field case , yielding a coplanar elliptical loop shape .",
    "the case @xmath239 represents a slightly twisted field line that has a sigmoid shape and is a quasi - force - free solution .",
    "the cases with @xmath240 are strongly twisted field lines and may be less force - free , since the neglected @xmath254 terms could be significant .    obviously we can not reproduce the exact shape of the gold - hoyle flux rope as shown in figure 10 ( with about seven twist turns ) with our choice of parameterization .",
    "the reason lies in the geometric constraints of the twist axis , which is semi - circular in the case of the gold - hoyle model , but consists of vertical twist axes in our parameterization .",
    "so , this counter - example clearly demonstrates the limitations of our parameterization .",
    "nevertheless , although the cartoon with the gold - hoyle geometry is very popular , especially for interplanetary flux ropes and cmes , it is not clear whether such gold - hoyle type geometries are found in loops in the lower corona , and whether the gold - hoyle geometry corresponds to an exact force - free solution .",
    "it is conceivable that the sun exerts rotational stress mostly in the photosphere ( rotating sunspots ) , which propagates in vertical direction along the field lines , but does not necessarily lead to a uniformly twisted circular flux tube as shown in figure 10 , because the magnetic field drops rapidly with @xmath255 with height ( for magnetic charges with small sub - photospheric depths ) , and thus the magnetic stress is not uniformly distributed along a semi - circular potential field line as envisioned in the gold - hoyle scenario .",
    "however , for a case with a near - constant magnetic field strength @xmath245 along a potential field line , we would expect a uniform twist as outlined in the gold - hoyle case .    on the other side ,",
    "strongly twisted flux tubes with a twist larger than about 1.25 full turns are unstable due to the kink instability and may erupt , which is another reason why multiply twisted flux tubes are unlikely to be found in active regions .",
    "even gold and hoyle ( 1960 ) found a critical twist number of @xmath256 @xmath257 above which no equilibrium exists , which is also confirmed by recent mhd simulations ( trk and kliem , 2003 ) .",
    "thus , the gold and hoyle flux rope case may not be relevant for modeling magnetic fields in stable active regions .",
    "nevertheless , more general parameterizations could be anticipated in future work , such as twist axes that follow potential field lines , rather than vertical axes , as used in our parameterization to minimize the number of free parameters .",
    "we thank anny malanushenko for helpful discussions .",
    "part of the work was supported by nasa contract nng 04ea00c of the sdo / aia instrument and the nasa stereo mission under nrl contract n00173 - 02-c-2035 .",
    "# 1    [ aschwanden , m.j . : 2004 , _ physics of the solar corona . an introduction _ , praxis publishing co. , chichester uk , and springer , berlin , 216 . ]",
    "[ aschwanden , m.j . ,",
    "wlser , j.p .",
    ", nitta , n. , lemen , j. : 2008 , , 827 . ]",
    "[ aschwanden , m.j . : 2009 , , 31 . ]",
    "[ aschwanden , m.j . ,",
    "sandman , a.w . : 2010 , , 723 . ]",
    "[ aschwanden , m.j . ,",
    "wlser , j.p . , nitta , n.v . ,",
    "lemen , j.r . , derosa , m. , malanushenko , a. : 2012a , , submitted . ]",
    "[ aschwanden , m.j . ,",
    "wlser , j.p . ,",
    "nitta , n.v . , lemen , j.r . : 2012b , , in press . ]",
    "[ aschwanden , m.j . , malanushenko , a. : 2012 , , submitted , ( paper ii ) . ]",
    "[ boyd , t.j.m . , sanderson , j.j . : 2003 , _ the physics of plasmas _ , cambridge university press , cambridge , 102 . ]",
    "[ conlon , p.a .",
    ", gallagher , p.t . : 2010 , , 59 . ]",
    "[ derosa , m.l . ,",
    "schrijver , c.j . ,",
    "barnes , g. , leka , k.d . , lites , b.w . , aschwanden , m.j . , : 2009 , , 1780 . ]",
    "[ feng , l. , inhester , b. , solanki , s. , wiegelmann , t. , podlipnik , b. , howard , r.a .",
    ", wlser , j.p . : 2007 , , l205 . ]",
    "[ gary , a. , alexander , d. : 1999 , , 123 . ]",
    "[ gold , t. , hoyle , f. : 1960 , 120 , 89 . ]",
    "[ jackson , j.d . : 1962 , _ classical electrodynamics _ , john wiley and sons , inc .",
    ", new york , 184 . ] [ klimchuk , j.a . ,",
    "antiochos , s.k . , norton , d. : 2000 , 542 , 504 . ]",
    "[ low , b.c . , lou , y.q . : 1990 , , 343 . ] [ malanushenko , a. , longcope , d.w . ,",
    "mckenzie , d.e . : 2009 , , 1044 . ]",
    "[ malanushenko , a. , yusuf , m.h . ,",
    "longcope , d.w . : 2011 , , 97 . ]",
    "[ metcalf , t.r . ,",
    "jiao , l. , uitenbroek , h. , mcclymont , a.n . ,",
    "canfield , r.c . : 1995 , , 474 . ] [ priest , e.r . : 1982 , _ solar magnetohyrdodynamics _ , geophysics and astrophysics monographs volume 21 , d. reidel publishing company , dordrecht , 125 . ]",
    "[ ruan , p. , wiegelmann , t. , inhester , b. , neukirch , t. , solanki , s.k . , feng , l. : 2008 , , 827 . ]",
    "[ sandman , a. , aschwanden , m.j . ,",
    "derosa , m. , wlser , j.p . ,",
    "alexander , d. : 2009 , , 1 . ]",
    "[ sandman , a.w . ,",
    "aschwanden , m.j . : 2011 , , 503 . ]",
    "[ schrijver , c.j . ,",
    "derosa , m.l . ,",
    "metcalf , t.r . ,",
    "liu , y. , mctiernan , j. , regnier , s. , valori , g. , wheatland , m.s . , wiegelmann , t. : 2006 , , 161 . ]",
    "[ sturrock , p.a . : 1994 , _ plasma physics .  an introduction to the theory of astrophysical , geophysical and laboratory plasmas _ , cambridge university press , cambridge , 216 . ]",
    "[ trk , t. , kliem , b. : 2003 , , 1043 . ]",
    "[ wheatland , m.s . ,",
    "sturrock , p.a . ,",
    "roumeliotis , g. , 2000 , , 1150 . ]",
    "[ wiegelmann , t. , neukirch , t. : 2002 , , 233 . ]",
    "[ wiegelmann , t. , inhester , b. : 2003 , , 287 . ] [ wiegelmann , t. , lagg , a. , solanki , s.k . , inhester , b. , woch , j. : 2005 , , 701 . ] [ wiegelmann , t. , inhester , b. : 2006 , , 25 . ]"
  ],
  "abstract_text": [
    "<S> we derive an analytical approximation of nonlinear force - free magnetic field solutions ( nlfff ) that can efficiently be used for fast forward - fitting to solar magnetic data , constrained either by observed line - of - sight magnetograms and stereoscopically triangulated coronal loops , or by 3d vector - magnetograph data . </S>",
    "<S> the derived nlfff solutions provide the magnetic field components @xmath0 , @xmath1 , @xmath2 , the force - free parameter @xmath3 , the electric current density @xmath4 , and are accurate to second - order ( of the nonlinear force - free @xmath5-parameter ) . the explicit expressions of a force - free field can easily be applied to modeling or forward - fitting of many coronal phenomena . </S>"
  ]
}