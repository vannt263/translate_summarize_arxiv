{
  "article_text": [
    "particle - in - cell simulations have brought tremendous new insights into collisionless astrophysical plasmas , for example regarding instabilities , kinetic turbulence , or particle acceleration in shocks and in magnetic reconnection .",
    "however , there remain a number of questions concerning the degree to which pic models are able to completely mirror real plasmas . in this manuscript , and in more detail in ref .",
    ", we address the incidence of coarse - graining , i.e. , of the fact that each computer particle in the pic plasma actually represents many real plasma particles .",
    "the need for coarse - graining becomes evident when looking at the number of plasma particles per debye sphere , given by the plasma parameter @xmath5 . in",
    "a real plasma @xmath5 ranges from @xmath1 to @xmath2 ( e.g. , @xmath7 in solar coronal loops ; @xmath8 in the magnetotail , magnetopause , or in typical crab flares ; @xmath9 in agn jets ) , while in computer experiments , where we have to simulate thousands to millions of debye spheres , @xmath5 reaches hardly a few tens . the corresponding number of particles per computer particles  that we will denote as _ superparticles _",
    " then reaches @xmath10 to @xmath11 .",
    "a pic code solves maxwell equations with current and charge densities computed from the superparticles , and the equations of motion with the lorentz force for each superparticle .",
    "the fields are stored on a grid , while the superparticles evolve continuously in position and velocity space .",
    "information between the superparticles inside the cells and the fields stored at grid nodes is communicated via interpolation , and this interpolation is equivalent to considering the superparticles as clouds of charge with a finite extent@xcite .",
    "this in turn implies a vanishing two - point force between superparticles at short distances , and thus reduces drastically the influence of collisions .",
    "it helps the pic plasma to remain collisionless even if its plasma parameter is quite low@xcite .",
    "discretization also brings numerical stability issues , that have been explored in depth in refs .  .",
    "we assume that we model a real plasma composed of @xmath12 real particles by using in the code @xmath13 superparticles .",
    "the number of real particles represented by each superparticle is thus @xmath4 .",
    "we also denote by @xmath14 the initial number of superparticles per grid cell in a simulation , and by @xmath15 the physical size of a cell .",
    "the set of equations solved by the pic code is not invariant under coarse - graining because there are physical quantities that depend on @xmath4 .",
    "such quantities will be termed _ coarse - graining dependent quantities_. by contrast , physical parameters that do not depend on @xmath4 will be refereed to as _",
    "fluid quantities_. all the fluid physics is thus accurately described by the pic plasma , while some care is to be taken for the coarse - graining dependent physics .",
    "fluid quantities are invariant under the change of variables @xmath16 , which amounts to pass from the real plasma of particles of mass @xmath17 , charge @xmath18 , number density @xmath19 , to the plasma of superparticles .",
    "examples include the plasma pulsation @xmath20 , the thermal velocity @xmath21 , the debye length @xmath22 , and more generally any quantity derived from fluid theory ( fluid theories include mhd , two - fluid models , vlasov - maxwell system ) .    the prototype of coarse - graining dependent quantities is the plasma parameter @xmath23 .",
    "since @xmath5 is proportional to the number of electrons per debye sphere , and since the debye length is @xmath4-independent , the plasma parameter of the pic plasma reads @xmath24 with @xmath25 the real plasma parameter .",
    "another way of seeing this is to recall that the plasma parameter @xmath5 is the ratio of the particles kinetic energy to their electrostatic potential energy of interaction and , as such , varies as @xmath6 because kinetic energy is proportional to the superparticles mass @xmath26 while charge interaction energy involves their charge @xmath27 .",
    "other coarse - graining dependent quantities can be built from @xmath5 : the thermalization time or the slowing down time of fast particles , both due to collisions and correlations , scale as @xmath28 , or the level of electrostatic fluctuations @xmath29 .",
    "other coarse - graining dependent parameters can be found .",
    "any number of particles per fluid volume will have the same dependency as eq .",
    "[ equ : lambda_pic ] , for example @xmath30 .    in the following ,",
    "we explore situations where coarse - graining effects have visible and important consequences .",
    "* left * : electron temperatures for the cold ( 1 ) and hot ( 2 ) plasmas , from four simulations with different numbers of superparticle per cell @xmath31 ( that include all species ) . *",
    "right * : half - thermalization times for ions and electrons , against number of superparticles per cell . ]    in a pic plasma , the behavior of plasma quantities depending on @xmath5 can be guessed by replacing @xmath5 by @xmath32 .",
    "this is the case for the thermalization time of a plasma by grazing coulomb collisions@xcite or by electric field fluctuations@xcite , which is on the order of @xmath33 ( with @xmath34 the plasma period ) .",
    "this has two important consequences : ( i ) we expect @xmath35 to depend on resolution and coarse - graining , roughly as @xmath36 , and ( ii ) since @xmath37 is several orders of magnitude smaller than the real plasma parameter @xmath5 , we expect the thermalization due to grazing collisions and fluctuations to be vastly more efficient in pic codes than in reality .",
    "we present here simulations with initially two thermal ion - electron plasmas ( mass ratio @xmath38 ) with two different initial temperatures .",
    "the four species interact via collisions and correlations ( no sign of plasma kinetic instabilities were found ) and tend to reach the same final temperature @xmath39 .",
    "results are shown in fig .",
    "[ fig : thermalization ] , for four simulations with different numbers of superparticles per cell .",
    "to evaluate the thermalization times we use the exponential variation of the temperature curves@xcite .",
    "we clearly see a slower thermalization as @xmath31 increases , with a scaling @xmath40 roughly correct for both electrons and ions .",
    "we also emphasize the difference with a real plasma , where @xmath41 reaches @xmath42 or more , while it is on the order of @xmath43 in pic simulations .",
    "each point is the measure of the fluctuation level @xmath44 from a pic simulation . here",
    "@xmath45 is the debye length normalized by the cell size . ]",
    "we now study the level of electric field fluctuations in a pic thermal plasma , and show that in addition to the substitution @xmath46 , effects due to finite superparticle size must be taken into account . in a real plasma in thermal equilibrium , it is given by@xcite @xmath47 where the symbol @xmath48 denotes an average over space , @xmath49 is the electric field , and @xmath19 and @xmath50 the plasma number density and temperature .",
    "we perform simulations of thermal plasmas at rest and measure the level of energy in the electric field .",
    "we use thermal velocities from 0.04@xmath51 to 0.10@xmath51 , @xmath31 from 2 to 500 , and different spatial resolutions .",
    "the results are summarized in fig .",
    "[ fig : fluctuations ] , left panel : @xmath44 is not found proportional to @xmath52 .    to explain this , we compute the electric field produced by particles in a thermal plasma@xcite .",
    "the expression for the electric field is a generalization of the debye electric field for moving particles , and is integrated in @xmath53-space from 0 to a maximal wavenumber @xmath54 given by the superparticle size @xmath15 .",
    "we then obtain @xmath55 in very good agreement with the simulations ( fig .",
    "[ fig : fluctuations ] , right panel ) .",
    "we note that for a very high resolution , @xmath56 , the field energy decreases as @xmath57 , which is non - trivial and different from what is expected in a real plasma where it decreases as @xmath58 .",
    "* left * : growth of individual fourier modes for @xmath59 . *",
    "right * : relative difference between the growth rate measured on the total energy and the analytical prediction for various simulations .",
    "the timestep is @xmath60 and the grid size is @xmath61 ( with @xmath62 the electron plasma period ) . ]",
    "this section illustrates the incidence of the high level of noise in the linear phase of instabilities .",
    "we perform several simulations of cold and unmagnetized counter - streaming beams of pair plasmas , with parameters such that the dominant unstable mode is the filamentation instability .",
    "we measure the growth rate during the linear phase with two methods : by a direct measure on the total energy curve , e.g. , @xmath63 , giving an effective growth rate that we denote by @xmath64 , and by following the time evolution of the fourier modes of the magnetic field .",
    "figure  [ fig : twostream_fourier_modes ] ( left ) is an example of the temporal evolution of the modes of @xmath59 .",
    "the sum of all modes grows at the same effective growth rate as the total energy in @xmath59 , @xmath65 .",
    "however , the fastest growing modes grow with @xmath66 , which is close to the analytical cold - fluid result @xmath67 .",
    "we see from fig .",
    "[ fig : twostream_fourier_modes ] ( left ) that the large difference between the effective growth rate @xmath64 and the growth rate of the fastest modes @xmath68 is due to a significant contribution of all the modes during the whole linear phase .",
    "the fastest mode thus never dominates the total energy in the linear phase .",
    "these results hold for all the test simulations that we conducted@xcite : the growth rates of the fastest fourier modes remain at a constant value , while the effective growth rates measured on the total energy present various levels of discrepancies with theory , between 14% and 67% .",
    "figure  [ fig : twostream_fourier_modes ] ( right ) shows that there is a systematic decrease in this discrepancy when the superparticle number per cell @xmath31 is increased ( all other parameters being kept constant ) . since the fluctuation level in the pic plasma decreases with increasing @xmath31",
    ", this indicates that the high fluctuation level excites all the modes and prevents the fastest ones from dominating the energy .",
    "pic simulations employ a high level of coarse - graining : each superparticle represents up to @xmath3 real plasma particles .",
    "this would not be an issue for simulating collisionless and correlation - less plasmas because the vlasov - maxwell system is invariant under coarse - graining .",
    "however , the physics of collisions and correlations is coarse - graining dependent , and is strongly enhanced by the smallness of the pic plasma parameter @xmath69 . as a result , noise and fluctuation levels are larger than in the real plasma by a factor @xmath3 , and collision- and fluctuation - induced thermalization is faster by a factor @xmath3 .",
    "for example , in real collisionless shocks , the mean free path for collisions @xmath70 is far larger than the shock thickness @xmath71 and the thermalization processes are collisionless kinetic instabilities .",
    "since the mean free path @xmath72 in a pic plasma is smaller by a factor of @xmath73 than in the real plasma , one has to check that @xmath74 still holds .",
    "more generally , to truly describe a collisionless and correlation - less plasma with a pic algorithm , one has to be careful that the unphysically enhanced collisional physics remains slower than the collisionless physics .",
    "this can be achieved with large enough numbers of superparticles per cell , or / and by the use of smoother particle shapes that reduce fluctuation levels .",
    "we also showed that the behavior of pic plasma quantities can be guessed by the substitution @xmath75 , but that this recipe is not exact and that the finite size of the superparticles is to be taken into account to obtain the precise dependency ."
  ],
  "abstract_text": [
    "<S> the pic model relies on two building blocks . </S>",
    "<S> the first stems from the capability of computers to handle only up to @xmath0 particles , while real plasmas contain from @xmath1 to @xmath2 particles per debye sphere : a coarse - graining step must be used , whereby of the order of @xmath3 real particles are represented by a single computer superparticle . </S>",
    "<S> the second is field storage on a grid with its subsequent finite superparticle size . </S>",
    "<S> we introduce the notion of coarse - graining dependent quantities , i.e. physical quantities depending on the number @xmath4 . </S>",
    "<S> they all derive from the plasma parameter @xmath5 , which we show to be proportional to @xmath6 .    </S>",
    "<S> we explore three examples : the rapid collision- and fluctuation - induced thermalization of plasmas with different temperatures , that scale with the number of superparticles per grid cell and are a factor @xmath3 faster than in real plasmas ; the high level of electrostatic fluctuations in a thermal plasma , with corrections due to the finite superparticle sizes ; and the blurring of the linear spectrum of the filamentation instability , where the fastest growing modes do not dominate the total energy because of a high level of fluctuations .    </S>",
    "<S> we stress that the enhanced collisions and correlations of pic plasmas must be kept negligible toward kinetic physics . </S>"
  ]
}