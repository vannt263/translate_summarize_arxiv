{
  "article_text": [
    "quantum many body systems are very hard to study due to the exponential growth of their hilbert space with the number of constituents .",
    "one possible cure to this issue for one dimensional systems is to describe their ground states as matrix product states ( mps ) @xcite .",
    "this family of states is known to be well suited to study gaped 1d phases  @xcite where for generic systems almost exact results can be obtained with matrices whose size does not depend on the size of the system .",
    "even more , for several gapped 1d systems the exact ground state can be expressed in terms of translationally invariant mps with very small bond dimension  @xcite .",
    "gapless 1d phases are harder to simulate with mps since the size of the matrices necessary to obtain good approximations of their ground states increases polynomially with the size of the system .",
    "this is particularly unfortunate since the universal low energy information encoded in the gapless phase becomes apparent only for large systems .",
    "luckily such universal information is also encoded in the way a state approaches the thermodynamic limit and one can extract it by using the celebrated finite size scaling ( fss ) technique  @xcite",
    ". this technique amounts to study larger and larger systems in a gapless phase ( that due to the finite size of the system becomes gapped ) and extract universal properties through the dependence of the observables on the system size .    in the context of mps",
    ", one can use an alternative approach to study gapless phases .",
    "it is called finite entanglement scaling ( fes ) @xcite and amounts to study the scaling of the expectation value of observables in the ground state of infinite chains described by mps with fixed bond dimension and thus finite entanglement .",
    "both the existence of fss and fes close to a conformal fixed point are a direct consequence of conformal invariance @xcite .",
    "if @xmath1 is the chain length and @xmath2 the mps bond dimension , then fss corresponds to taking @xmath3 first and then taking @xmath4 , whereas fes consists in taking @xmath4 first and then @xmath5 .",
    "an important question to ask is whether fss and fes provide the same universal information . since the proposal of fes for simulations with mps @xcite it has been shown that indeed quantities such as critical exponents related to local observables or the central charge of the model can be extracted with the help of this technique @xcite , in a similar way as it is normally done with fss techniques . here",
    "we will show , however , that some care is required in order to differentiate between the effects of fes and those of fss .",
    "specifically , we consider critical systems with periodic boundary conditions ( pbc ) , and describe their translationally invariant ground states using translationally invariant mps . in order to perform fss",
    "one should obtain for each system size @xmath1 a sequence of increasingly accurate mps approximations with growing bond dimension @xmath2 , which for large enough @xmath2 converges to the exact ground state .",
    "importantly , we find that for an intermediate range of values of @xmath2 , for which local observables are already reproduced with high accuracy and show scaling behavior , the mps approximation is almost completely orthogonal to the exact ground state ( resulting e.g. in failure to reproduce correlation functions at distance @xmath6 , as previously illustrated in the inset of fig . 11 and 12 of ref .",
    "@xcite ) . in other words , reasonably converged values of ( and/or scaling behavior for ) local observables including the ground state energy , are not sufficient criteria to establish that some mps is a good approximation to the ground state of a critical pbc system . instead ,",
    "in order to properly apply fss , for each system size @xmath1 one should consider mps with a bond dimension @xmath2 larger than some threshold value @xmath7 , where @xmath7 depends both on @xmath1 and on the spin model .",
    "our results have important consequences for the design of algorithms that simulate pbc chains with mps .",
    "simulating pbc systems with mps is computationally much more expensive  @xcite than simulating the same system with open boundary conditions ( obc ) .",
    "nonetheless , when studying critical ground states , systems with pbc are known to approach the thermodynamic limit much faster than systems with obc , and therefore they offer a much better framework for fss . for this reason , substantial effort @xcite has been made to try to lower the computational cost of mps simulations with pbc .",
    "two types of approaches have been pursued .",
    "one consists in building a mps for a finite system with pbc by using the translationally invariant mps tensor that has been optimized in an infinite chain with obc  @xcite .",
    "this approach is equivalent to a crude approximation of the mps transfer matrix : the @xmath8 matrix is approximated only by its dominant eigenvector . the second approach  @xcite accounts for pbc by retaining more than one eigenvector in the approximation of the transfer matrix .",
    "we show in this work that the first approach fails to provide an accurate ground state approximation for critical pbc systems . a detailed comparison of these algorithms can be found in appendix  [ sec : other_algorithms ] .",
    "we will build our arguments by studying two paradigmatic critical spin chains : the quantum ising model ( is ) and the quantum heisenberg ( hb ) model , for chains with pbc and linear size @xmath1 .",
    "the ground states are encoded in mps of a given bond dimension @xmath2 .",
    "even if the hamiltonian is critical , both the finite size of the chain and the finite bond dimension of the mps induce a gap    @xmath9    @xmath10    where @xmath11 is the smallest critical exponent of the theory @xcite and @xmath12 is the exponent for the scaling of the effective correlation length of mps simulations with finite bond dimension  @xcite . depending on which of the two gaps dominates , the system is in one of the two regimes    @xmath13    @xmath14    the presence of two regimes in the pbc chain can be intuitively understood in the following way : in the fes regime defined by equation ( [ eq : fer ] ) the small dimension of the mps matrices implies that the system is not aware of its geometry .",
    "thus the boundaries do not play any role . in the fss regime , defined by equation ( [ eq : fsr ] ) on the other hand ,",
    "the size of the matrices is big enough to notice the presence of the boundaries and thus different choices of boundary conditions lead to different mps .    for simulations where",
    "@xmath15    we find for all values of @xmath1 and @xmath2 that are accessible numerically the presence of an abrupt transition between the fss and fes regimes ( for a related work see also ref .",
    "one way to observe this transition is by looking at the difference between the exact ground state energy in the thermodynamic limit and the energy of mps approximations with different @xmath1 and @xmath2 . for fixed @xmath2",
    "these plots show a steep transition between the fss regime where the difference scales like @xmath16 to the fes regime where the difference does not depend on @xmath1 .",
    "another way is to look at the overlap between mps with different @xmath2 for fixed chain length @xmath1 : starting off with a mps with some big @xmath17 , we look at its overlap with mps with decreasing @xmath2 .",
    "we then observe how the initially smoothly decreasing overlap abruptly drops towards lower values at some @xmath18 , unambiguously showing the transition to the fes regime .",
    "now the overlap is a global variable and as such indeed aware of the boundary conditions .",
    "the main finding of this paper is that states in the fes regime , while possessing the same local universal properties  @xcite like those in the fss regime , turn out to have vanishing overlap with them .",
    "we also present a possible technique to determine if a given bond dimension is sufficient to enter the fss regime , so that we can give the computationally most favorable recipe to access global universal properties that depend on the boundaries ( for a discussion of these properties see e.g. @xcite ) .",
    "the paper is organized as follows .",
    "we start by introducing the is and hb models as well as the technique used to simulate them in section [ sec : overview ] . in section",
    "[ sec : two_regimes ] we present numerical evidence for the presence of the fss and fes regimes in mps simulations of pbc chains by looking at the ground state energy . in section",
    "[ sec : transition ] we discuss how to identify the sharp transition between the two regimes by looking at the overlap .",
    "then , in section  [ sec : correction_to_scaling ] , we give a more detailed view on the transition between the two scaling regimes .",
    "section [ sec : minimal_d_faithful_simulations ] gives a recipe for obtaining the minimal bond dimension needed to observe global universal properties of critical systems . in section [ sec : is_tl ] we perform a numerical study of the transition and for the is model we can provide evidence for its persistence in the thermodynamic limit . for the hb model we are not able to do the same due to the coarser precision of our simulations for this model . in section [ sec : scaling_function ] we provide a numerical analysis of the scaling function for the energy difference that reveals a two - parameter scaling analogous to the one found in the context of critical 2d classical systems by nishino in ref .",
    "we conclude with a discussion of the implications of our results and with a brief outline of future developments .",
    "all technical details are contained in the appendices .",
    "there we first provide an alternative way to derive the analytical result for the scaling exponent @xmath12 in @xmath19 , which we find more intuitive than the one given in  @xcite .",
    "then we show how our algorithm can be used in order to extract @xmath12 from the numerical results for the ground state energy . for the is model ,",
    "we are able to provide a numerical confirmation for the persistence of the transition between the fss and the fes regime in the thermodynamical limit .",
    "we will use throughout this work the algorithm presented in  @xcite .",
    "that algorithm exploits the translational invariance of the models we study by using an ansatz based on translationally invariant mps .",
    "this means that the mps tensors at each site of the chain are identical thus reducing the cost of the simulation by a factor @xmath1 .",
    "the energy is minimized by means of a conjugate gradient method in the subspace spanned by real and symmetric mps with bond dimension @xmath2 .",
    "the computational cost scales like @xmath20 . @xmath21 and @xmath22 are parameters whose magnitude depends on the entanglement of the ground state of the model under consideration . for more details on the method",
    "we refer the reader to that work .",
    "the two paradigmatic models we have considered are the critical quantum ising model described by the hamiltonian    @xmath23    and the heisenberg model described by the hamiltonian    @xmath24    where the 1d lattice is considered to be periodic .",
    "both hamiltonians are critical which means that their gap between the ground state and the first excited state closes as an inverse power of @xmath1 as described in eq .",
    "[ eq : fsg ] .    as a matter of fact",
    "the analysis in this work was triggered by a comprehensive study of the precision of the algorithm presented in @xcite .",
    "we originally wanted to assess the usability of that method and to this end we simulated a plethora of different configurations @xmath25 for the is and the hb models .",
    "a selection of these simulation results is shown in figure  [ fig : ishb_nall_dall ] where we plot the relative energy precision of simulations with different @xmath2 for many different chain lengths @xmath1 .",
    "the shape of curves with constant @xmath2 is very surprising since it shows a fundamental deviation from what we would have expected .",
    "our expectation was that for short chains the precision will be generally better than for long chains and that as @xmath1 gets bigger and bigger , the precision will eventually saturate from below to the value obtained with the corresponding @xmath2 when simulating the chain in the thermodynamic limit .",
    "obviously the small @xmath1 and the big @xmath1 regimes are in accordance with our expectation . however at some point between these limits we see the emergence of a _ hump _ which indicates that something interesting is happening in that region . as a matter of fact we can show that if we interpret the position of the _ hump _ as an indicator for the effective correlation length @xmath26 of mps with finite @xmath2 , we can reproduce the theoretically predicted result for the scaling of @xmath26  @xcite with very good accuracy ( see appendix  [ sec : eff_corr_len ] ) .",
    "the results presented in this work provide the general framework to understand the emergence of the _ hump _ and to explain what is happening when moving from the left to the right side of fig .",
    "[ fig : ishb_nall_dall ] .      as already mentioned in the introduction a mps simulation close to the critical point",
    "is an example of a two scale problem .",
    "this is not something unexpected as it has been already pointed out in the context of 2d classical systems studied with the corner transfer matrix by nishino and coworkers  @xcite and in the context of quantum phase transitions in 1d quantum chains with open boundaries by one of the authors ( section iiig of ref .",
    "@xcite ) . in the scenario we are considering ,",
    "the two scales appearing are i ) the correlation length induced by the finite size of the system @xmath1 of eq .",
    "[ eq : fsg ] and ii ) the correlation length induced by the size of the matrices @xmath2 of eq . [ eq : feg ] . depending on the relation among the two stated in eqs .",
    "[ eq : fsr ] and [ eq : fer ] , the system will be in one of the two different regimes , respectively the fss regime or the fes regime .",
    "the approach to the thermodynamic limit of the ground state energy , as function of the relevant parameter @xmath1 or @xmath2 , is very different in the two regimes so that we can use it as a footprint for them . in the fss regime",
    "indeed it obeys the celebrated result by cardy and affleck  @xcite from conformal field theory ( cft ) ,    @xmath27    where @xmath28 is the thermodynamic limit , @xmath29 is the fermi velocity and @xmath30 is the central charge of the considered model . in the thermodynamic limit",
    ", several authors have reported that @xcite    @xmath31    where @xmath32 and @xmath12 is the same exponent of eq .",
    "[ eq : feg ] and @xmath33 is a positive non - universal constant . we show below that the same scaling holds also for mps simulations of finite chains if @xmath1 is big enough .",
    "this happens exactly in the fes regime defined by ( [ eq : fer ] ) .",
    "a ) , and @xmath2 in the range @xmath34 .",
    "each line represents simulations performed at fixed @xmath2 and different @xmath1 .",
    "the plots show the absolute value of the difference @xmath35 .",
    "the fss is represented by a diagonal black line following the scaling from eq .",
    "[ eq : cft_escaling_pbc ] .",
    "all data sets initially follow this line .",
    "the fes regime corresponds to the various horizontal lines , where @xmath36 saturates for different @xmath2 to different values @xmath37 that do not depend on @xmath1 . in the inset",
    "we collect these values to show that they reproduce the expected behavior of the fes .",
    "the two regimes are separated by the appearance of a pronounced peak .",
    "since we plot an absolute value , the peak is nothing more than the change of sign in the difference @xmath38 when moving from the fss regime ( [ eq : cft_escaling_pbc ] ) to the fes regime ( [ eq : mps_escaling_tl ] ) .",
    "b ) the same plot for the hb model tells us that here the fss is much more difficult to study , since all data - sets deviate very soon from the pure fss prediction.,title=\"fig : \" ] b ) , and @xmath2 in the range @xmath34 .",
    "each line represents simulations performed at fixed @xmath2 and different @xmath1 .",
    "the plots show the absolute value of the difference @xmath35 .",
    "the fss is represented by a diagonal black line following the scaling from eq .",
    "[ eq : cft_escaling_pbc ] .",
    "all data sets initially follow this line .",
    "the fes regime corresponds to the various horizontal lines , where @xmath36 saturates for different @xmath2 to different values @xmath37 that do not depend on @xmath1 . in the inset",
    "we collect these values to show that they reproduce the expected behavior of the fes .",
    "the two regimes are separated by the appearance of a pronounced peak .",
    "since we plot an absolute value , the peak is nothing more than the change of sign in the difference @xmath38 when moving from the fss regime ( [ eq : cft_escaling_pbc ] ) to the fes regime ( [ eq : mps_escaling_tl ] ) .",
    "b ) the same plot for the hb model tells us that here the fss is much more difficult to study , since all data - sets deviate very soon from the pure fss prediction.,title=\"fig : \" ]    the two regimes are very clearly distinguished in fig .",
    "[ fig : e0_nd - e0_inf ] where we present plots of the absolute value of the difference of the ground state energy obtained with mps simulations and the exact value in the thermodynamic limit    @xmath39    as a function of @xmath1 in a log - log scale .",
    "note that in fig .",
    "[ fig : e0_nd - e0_inf ] we make an abuse of notation by using @xmath40 and @xmath41 , which can be only done as long as we specify what the constant value of @xmath2 or @xmath1 is .",
    "the data is collected from several simulations of the critical is with pbc for chain lengths in the range @xmath42 ( panel a ) and of the hb with pbc in the range @xmath43 ( panel b ) .",
    "@xmath2 is going in both cases up to @xmath44 .",
    "each line in the main plot represents simulations performed for different @xmath1 at fixed @xmath2 .",
    "the fss predictions of eq .",
    "[ eq : cft_escaling_pbc ] are straight lines plotted in black . for small @xmath1 ,",
    "each set of data follows the prediction of eq .",
    "[ eq : cft_escaling_pbc ] , which is a clear signal of the fss regime .",
    "the maximal @xmath1 for which the fss prediction holds increases with growing @xmath2 as expected . however , each set deviates at some big enough @xmath1 from the fss prediction to eventually stabilize to a value of the energy difference that only depends on @xmath2 .",
    "this is a clear footprint of the fes regime scaling , as described in eq .",
    "[ eq : mps_escaling_tl ] . in order to confirm this",
    "we have added to both panels insets where we have plotted several values of @xmath37 for large fixed @xmath1 as a function of @xmath2 in a log - log scale .",
    "similar plots in the thermodynamic limit can be found in  @xcite .",
    "the linear fits ( red lines ) in the insets yield @xmath45 for @xmath46 respectively @xmath47 for @xmath48 .",
    "these values are compatible with the analytical values obtained for @xmath4 in @xcite , namely @xmath49 and @xmath50 and thereby confirm the scaling of eq .",
    "[ eq : mps_escaling_tl ] .",
    "note that we are able to obtain much better precision for the is than for the hb model at at the same computational cost .",
    "this is visible by comparing the panel a ) to the panel b ) and observing that for fixed @xmath2 , the curves for the hb model deviate from the fss at much lower values of @xmath1 than the corresponding ones for the is model .      in figure",
    "[ fig : e0_nd - e0_inf ] we can observe that for each line with constant @xmath2 , the fss region is separated from the fes region by a well distinguishable peak in the absolute value of @xmath36 .",
    "we would now like to show that this transition does not depend on the choice of the observable but that it indicates a global change in the wave function .    to this end we can investigate the trace distance between the exact ground state of a chain with @xmath1 sites and the mps obtained from a series of simulations with different @xmath2 .",
    "we have chosen the step size in @xmath2 as small as possible , i.e. @xmath51 . since the exact ground state wave function is only available for very small systems due to the exponential scaling of the number of parameters , we use as a _ reference state _ a mps approximation of the ground state with very big @xmath2 .",
    "for the @xmath1 range in question , the biggest available bond dimension is @xmath44 .",
    "note that the energy difference between the exact ground states and the _ reference states _ is much smaller than the difference to the mps we want to compare to ( see fig .",
    "[ fig : ishb_nall_dall ] ) .",
    "a ) and ground state mps with bond dimensions @xmath52 for several different chain lengths .",
    "b ) heisenberg model : trace distance between _ reference states _ with @xmath53 and ground state mps with bond dimensions @xmath52 for several different chain lengths .",
    ", title=\"fig : \" ] b ) and ground state mps with bond dimensions @xmath52 for several different chain lengths .",
    "b ) heisenberg model : trace distance between _ reference states _ with @xmath53 and ground state mps with bond dimensions @xmath52 for several different chain lengths .",
    ", title=\"fig : \" ]    figure  [ fig : is_td_d64 ] shows the trace distance between states with relatively small @xmath2 and _ reference states _ for several different chain lengths @xmath1 for both the is and the hb models .",
    "note that for every @xmath1 there is a jump in the trace distance between states that are very far away from the _ reference state _ and states that are at least one order of magnitude closer to it .",
    "for the is model the jump is very steep and for each line of constant @xmath1 we can clearly identify @xmath54 as the biggest @xmath2 in the left ( fes ) regime and @xmath18 as the smallest @xmath2 in the right ( fss ) regime . in this case the appearance of the jump evidently indicates the transition from the fss regime , where the trace distance is close to zero to the fes regime where the trace distance abruptly increases . for the hb model",
    "the transition is much smoother and we can not unambiguously define @xmath54 and @xmath18 for all lines with constant @xmath1 .",
    "this happens presumably due to the fact that taking mps with @xmath44 as _ reference states _ is not accurate enough in the case of the @xmath55 model .    however , at least for the is model , we are now in the position to check if our intuitive expectation , that the transition occurs precisely when the correlation length of the finite size mps reaches the size of chain as described in eq .",
    "[ eq : transition ] , is quantitatively correct .",
    "the correlation length of mps with finite @xmath2 reads according to eq .",
    "[ eq : feg ] as @xmath56 where @xmath57 is a proportionality constant . for our numerical study",
    "we obtain the parameters @xmath57 and @xmath12 in the appendix [ sec : eff_corr_len ] .",
    "we can confirm that for each line of constant @xmath1 the jump in the trace distance is consistent with our assumption , i.e. @xmath58 .",
    "furthermore we would like to mention that jumps also occur in other quantities at the same @xmath54 , for instance in the half - chain correlation function reported in  @xcite ( see figure @xmath59 in that work for a plot of the jump for @xmath60 ) .",
    "the fact that the induced correlation length @xmath61 in the fes is smaller than the size of the system , suggests that the state is completely unaware of the presence of the boundaries .",
    "this confirms our intuition that mps in the fss regime are faithful approximations of finite chains with pbc while mps in the fes regime do not capture properties related to the boundary conditions .    summarizing",
    ", the main point of this section is that if one is interested in the effects of pbc , results collected for @xmath2 smaller than @xmath18 should not be taken into account .",
    "note that due to the residual dependence on @xmath2 ( see the appendix [ sec : correction_to_scaling ] for details on this point ) one still has to extrapolate the results in the limit @xmath5 in order to obtain accurate results .",
    "if , on the other hand , one is interested only in local universal quantities ( i.e. where boundary conditions are irrelevant ) , there is no point in simulating the system with pbc and one should rather perform a standard fes study @xcite .",
    "we have seen above how in the extremal regions of figure [ fig : e0_nd - e0_inf ] , the simulation results follow the behavior predicted by fss respectively fes . in the intermediate region however , the simulations display a behavior that can not be attributed to either regime .",
    "we would now like to point out that the real picture is somewhat more complex than the two - regime interpretation given above .",
    "the leading scaling behavior given in equations [ eq : cft_escaling_pbc ] and [ eq : mps_escaling_tl ] represents only the first terms of the series expansion of more complex analytic corrections .",
    "thus these terms are accompanied by higher order terms called corrections to scaling . in order to understand the scenario we must consider the general taylor expansion of a two variable function .",
    "let us consider two variables @xmath62 and @xmath63 with the property that @xmath64 and @xmath65 .",
    "obviously these variables can be identified with the gaps proportional to the inverse of the correlation length induced by the system size @xmath1 and by the finite matrix dimension @xmath2 as defined in eq .",
    "[ eq : fsg ] and eq .",
    "part of the scaling ansatz consists in assuming that all universal quantities are universal functions of these two variables .",
    "let us review the case of a one - scale problem . in this case , by neglecting higher than quadratic terms in the vanishing variable ( e.g. @xmath66 ) we get the following series expansion for some universal function @xmath67    @xmath68    in the regime where @xmath69 , the first two terms are considered the leading scaling behavior while the rest provides only higher order corrections . if we now take a two scale problem    @xmath70    in the regime where @xmath71 we are back to the previous situation and we can apply the one - scale ansatz of eq .",
    "[ eq : one_scale ] to the function @xmath72 ; the same thing is valid in the opposite regime @xmath73 with the obvious substitution @xmath74 .",
    "these two limits would correspond to what we have called in the main text the fss regime and the fes regime ( see eq .",
    "[ eq : fsr ] and [ eq : fer ] ) .    .",
    "all lines ending in the origin denote possible paths to approach the thermodynamic limit of critical systems when doing mps simulations . ]    now in general , there is a huge regime where for example @xmath75 or @xmath76 . in this case",
    "the leading scaling behavior is modified by corrections that are not proportional to the next power of the relevant variable but to the ratio among the two variables .",
    "indeed if we consider the scenario where @xmath76 in eq .",
    "[ eq : two_scales ] we obtain    @xmath77    how relevant the correction is clearly depends on the scale separation , i.e. on how close @xmath78 is to one . in the following we give a sketch of how this cross - over region looks like and we introduce two new terms : _ finite entanglement - size scaling _",
    "( fess for ) the region where the leading scaling is due to the finite size of the matrices and the corrections come from the size of the system and _ finite size - entanglement scaling _ ( fses ) where the leading scaling is due to the size of the system and the corrections come from the size of the matrices .",
    "figure  [ fig : fses_phase_diagram ] shows a classification of mps simulations according to the simulation parameter pair @xmath25 .",
    "the thermodynamical limit can be approached by moving along any path towards the origin of the diagram @xmath79 .",
    "however in order not to distort the scaling analysis by mixing the different @xmath1 and @xmath2 related corrections , moving from one point to the next on the path should leave the ratio @xmath78 unchanged .",
    "this is equivalent to the requirement that any path is completely determined by the path constant @xmath80 .",
    "we can distinguish three different regions and three important lines in fig .",
    "[ fig : fses_phase_diagram ] in the region above the _ blue line _ which is defined by @xmath81 , the mps bond dimension is large enough to represent the ground state exactly .",
    "of course doing mps simulations in this regime is pointless since the computational cost becomes exponential in @xmath1 and there is no advantage over exact diagonalization .",
    "thus no matter which path towards @xmath4 we choose in this region , it is completely equivalent to fss .",
    "the _ magenta line _ with @xmath82 represents the only path along which pure finite entanglement scaling ( fes ) holds .",
    "the _ red line _ represents the path along which the induced correlation length is equal to the system size , i.e. @xmath83 .",
    "we will call this line in the following the _",
    "critical line_. for critical models without conformal invariance the _ critical line _ can be obtained using the method described in appendix  [ sec : eff_corr_len ] . between this line and the _ fes line _",
    "there is a region where @xmath84 .",
    "all simulations done in this region barely registrate the boundaries of the system and the fixed point mps is more or less the same like that of a @xmath85 simulation with same @xmath2 .",
    "however there is a slight effect due to the finite size for points close to the @xmath83 line as can be seen in figure  [ fig : ishb_nall_dall ] .",
    "this is why we call this region the finite entanglement - size scaling ( fess ) region : the entanglement scaling predominates , but there is a small trace of finite size scaling behavior .",
    "the region between the _ critical line _ and the fss - regime describes mps simulations where @xmath86 , which turn out to reproduce faithfully the long range correlations throughout the entire chain ( see figure 9 in our previous work  @xcite ) .",
    "the fss aspect predominates in this region , however there is also the inherent error of mps simulations with @xmath87 , so we call it the finite size - entanglement scaling ( fses ) region .    despite the rigorous classification of regimes from figure [ fig : fses_phase_diagram ]",
    "we will restrict ourselves in the following to discriminate merely between the regimes on different sides of the critical line .",
    "we do this in order to improve the readability .",
    "thus we will refer to both fss and fses as fss ; analogously we will denote both fes and fess as fes .",
    "a ) and @xmath52 for a chain with @xmath88 sites .",
    "b ) heisenberg model : trace distance between ground state mps with different bond dimensions @xmath89 and @xmath52 for a chain with @xmath90 sites . by using relatively small bond dimensions we are able to localize the transition between the fes and fss regime for each @xmath1 . this can be used in case we are interested in performing a fss analisys by providing the lower bound @xmath18 such that the state we obtain is not orthogonal to the exact state . , title=\"fig : \" ] b ) and @xmath52 for a chain with @xmath88 sites .",
    "b ) heisenberg model : trace distance between ground state mps with different bond dimensions @xmath89 and @xmath52 for a chain with @xmath90 sites . by using relatively small bond dimensions we are able to localize the transition between the fes and fss regime for each @xmath1 . this can be used in case we are interested in performing a fss analisys by providing the lower bound @xmath18 such that the state we obtain is not orthogonal to the exact state .",
    ", title=\"fig : \" ]      we can outline a direct application of the presence of a transition between a fss regime and a fes regime . suppose that we want to simulate a critical chain with pbc such that it is in the fss regime , i.e. the properties due to the boundary conditions are faithfully reproduced since @xmath91 . in order to minimize the computational cost we would like to use the smallest possible @xmath2 that captures the pbc topology . by looking at figure  [ fig : is_td_d64 ] it is clear that we would have to choose @xmath92 to this end .",
    "the problem is that in order to make that plot we had to use as _ reference states _ mps with very large @xmath44 , which is exactly what we would like to avoid in this case .",
    "fortunately it turns out that even without a large @xmath2 simulation it is possible to detect the optimal @xmath92 .",
    "this is due to the fact that all mps with @xmath93 have a much smaller trace distance among eachother than with mps with @xmath94 .",
    "the trace distance among all states with @xmath95 for a is chain with @xmath88 is shown in figure  [ fig : is_td_d1d2_n1000 ] a ) .",
    "the plot is of course symmetric in @xmath89 and @xmath52 and we have omitted the points on the diagonal since they are trivially @xmath96 .",
    "the transition between the fss and the fes regime is clearly distinguishable at the same location of the jump as in figure  [ fig : is_td_d64 ] but in this plot we used only mps with relatively small bond dimension .",
    "note furthermore that if @xmath97 the trace distance between these states is wildly oscillating .",
    "however if @xmath89 and @xmath52 are on different sides of the jump , profiles similar to figure  [ fig : is_td_d64 ] emerge .",
    "now it is clear how we can find the optimal @xmath92 with the smallest computational cost possible : for a given @xmath1 run the pbc simulations by increasing @xmath2 in small steps , ideally @xmath51 . after each simulation",
    "compute the overlap with all previously obtained mps and when the nice profile with the jump appears , we know we have reached @xmath92 .",
    "the same strategy can be employed for the hb model , however , just like in figure [ fig : is_td_d64 ] , the transition is much smoother in this case .    as a side remark note that due to the fast decay of the eigenvalues of the mps transfer matrix one can compute the overlaps with computational cost scaling like @xmath98 .",
    "the meaning of @xmath22 and the method how to achieve this is described in  @xcite .",
    "what can figure  [ fig : is_td_d64 ] tell us about the behavior of the transition between the fss and fes in the limit @xmath4 ?    for the is model , qualitatively the height of the jump seems to remain constant for increasing @xmath1 .",
    "the trace distance between mps with bond dimensions @xmath54 and @xmath18 to the _ reference state _ also seems to remain more or less stable but this is of course not enough evidence for the persistence of the transition in the thermodynamic limit . in appendix",
    "[ sec : tl_of_transition ] , we present a detailed analysis that shows that for the is model i ) the @xmath99 limit of the trace distance between the exact ground state ( approximated by a _ reference state _ ) and mps obtained in the fss regime is strictly bigger than zero , ii ) the same limit for the trace distance with respect to mps obtained in the fes regime is zero .",
    "ii ) implies that states in the fes regime are globally orthogonal to the exact ground state of the pbc chain . as we already mentioned above this",
    "does not affect the possibility to extract local universal information from those states .",
    "however ii ) clearly shows that mps in the fes regime are globally not a good approximation for the ground state of the is model with pbc .",
    "unfortunately we can not obtain the same conclusions for the hb model .",
    "presumably this is due to the fact that the _ reference states _ that we use are not a good enough approximation of the true ground state of the model in this case .",
    "this becomes clear if we look again at figure  [ fig : ishb_nall_dall ] : for the is model the @xmath44 states have a much better precision than the mps we compared them to in order to prove the persistence of the transition in the thermodynamic limit ( see appendix [ sec : tl_of_transition ] for details ) . for the hb model on the other hand ,",
    "the @xmath44 line covers almost three orders of magnitude in the relative precision plot ; at its maximum it is over one order of magnitude above the points belonging to mps that we must compare the _ reference states _ to in order to perform our analysis of the thermodynamic limit ( e.g. the data points with @xmath100 and @xmath101 ) .",
    "the @xmath102 line in right plot of figure  [ fig : ishb_nall_dall ] seems to fulfill similar requirements like the @xmath44 line in the left plot .",
    "however , in that regime , for @xmath103 , the pbc algorithm is very inefficient and it would take unreasonably long to obtain the data points for @xmath102 .",
    "a ) versus @xmath104 that illustrates the collapse of the data into a single curve .",
    "the points with @xmath44 slightly deviate from the curve traced by data points with smaller @xmath2 .",
    "b ) heisenberg model : log - log plot of @xmath105 versus @xmath106 that illustrates the collapse of the data into a single curve . , title=\"fig : \" ] b ) versus @xmath104 that illustrates the collapse of the data into a single curve .",
    "the points with @xmath44 slightly deviate from the curve traced by data points with smaller @xmath2 .",
    "b ) heisenberg model : log - log plot of @xmath105 versus @xmath106 that illustrates the collapse of the data into a single curve . , title=\"fig : \" ]    finally we conduct an analysis of the scaling of mps simulations across the entire interval @xmath107 which covers all possible pairs @xmath25 .",
    "this is very much in the spirit of the scaling analysis performed by nishino et al . for classical 2d systems in ref .",
    "the main differences are that in our case the energy difference @xmath108 can take both positive and negative values , and that we obtain the effective correlation length @xmath61 from an analysis of the _ humps _ in the relative precision of the energy ( see appendix [ sec : eff_corr_len ] for details ) instead of using the ratio between the two biggest eigenvalues of the mps transfer matrix .",
    "analogously to nishino , we first eliminate the fss scaling from @xmath109 and then we plot the result ( in our case this is @xmath110 ) as a function of @xmath106 .",
    "the fact that all data ( with exception of the @xmath44 points for the is model ) collapses into a single curve justifies the assumption that    @xmath111    with some scaling function @xmath112 that is not exactly known .",
    "what we can easily write down however is its asymptotic behavior    @xmath113    for the is model we have used for @xmath61 the expression obtained from the hyperbola fit in fig .",
    "[ fig : ishb_effcorrlen ] of the appendix [ sec : eff_corr_len ] , i.e. @xmath114 .",
    "note that in plot a ) of the fig .",
    "[ fig : is_collapse ] , the data for different @xmath2 collapses almost perfectly in the extremal regimes @xmath103 and @xmath115 .",
    "there is a slight deviation of the @xmath44 curve that can be explained if we look at figure 1 in  @xcite ( there the @xmath44 data point also slightly deviates from the line that is traced by the points with @xmath116 ) . in the regime where @xmath117 the curves do not collapse so nicely which is a manifestation of the fact that the _ humps _ in fig .",
    "[ fig : ishb_nall_dall ] are so different for the is model .    for the hb model we have used for the effective correlation length @xmath118 as obtained from the hyperbola fit in fig .",
    "[ fig : ishb_effcorrlen ] .",
    "plot b ) of fig .",
    "[ fig : is_collapse ] shows an almost perfect collapse even in the region @xmath117 .",
    "presumably this is due to the fact that for the hb model the _ humps _ in fig .",
    "[ fig : ishb_nall_dall ] are much more similar among each other than in the case of the is model .",
    "an accurate analysis of mps simulations of critical spin chains with pbc reveals the appearance of two regimes .",
    "the fss regime where the energy gap of the system is induced by the size of the system and the fes regime where an effective energy gap is induced by finite @xmath2 . while in both regimes",
    "local universal quantities can be extracted by studying the scaling of the observable with respect to the relevant variable ( the size of the system for the fss or the size of the mps matrices for the fes regime ) , we have shown that for the quantum ising model , states in the fes regime are orthogonal to the exact ground state in the thermodynamic limit .",
    "intuitively this happens due to the fact that for mps simulations in the in the fes regime , the induced correlation length is smaller than the system size and thus the mps is not aware of the size of the system .",
    "since in critical systems the boundary conditions strongly affect global properties of the system , this result seems quite natural .",
    "our results can be interpreted as a further benchmark for recently introduced algorithms that try to lower the computational cost of pbc simulations with mps @xcite ( see appendix  [ sec : other_algorithms ] ) . here",
    "we provide strong hints that in order to correctly describe the ground state of a finite chain with pbc for critical systems , these algorithms should be used with care in order not to obtain wave functions that are orthogonal to the exact ones . what one would indeed interpret as the mps tensor for a pbc chain , in some regime could turn out to be closer to the mps tensor of an infinite obc system .",
    "however , considering that for obc systems the approach to the thermodynamic limit is by no means slower than for pbc systems ( for both the ground state energy converges to the thermodynamic limit as a function of the appropriate correlation length like @xmath119 ) , our results can be also used in a constructive way . in order to extract universal information about local operators ,",
    "one is better off by using fes rather than fss , since simulations in the fes regime have a much better scaling of the computational cost .",
    "things are more complex if one is interested in global observables , such as e.g. two point correlation functions at half chain length . for pbc systems",
    "the scaling analysis must be performed in this case on paths with constant @xmath120 that lie completely in the fss regime .",
    "the computationally least expensive such path is the one where for every given @xmath1 , the mps bond dimension @xmath2 is just big enough such that @xmath121 .",
    "we have shown how that minimal @xmath2 can be found for any @xmath1 by looking at the overlap between mps with increasing @xmath2 until the discrete transition between the fes and the fss regime is detected . regarding the scaling exponent @xmath12 , we have been able to numerically confirm the theoretically predicted values with an accuracy of approximately @xmath122 for both the quantum ising and the heisenberg models .",
    "furthermore we have shown in appendix  [ sec : eff_corr_len_analytical ] how the analytical expression for @xmath12 , originally derived in @xcite , can be obtained in an alternative way .",
    "following nishino s analysis for 2d classical systems  @xcite we have shown that also for mps simulations of 1d quantum systems the scaling of the mps ground state energy in simulations with finite @xmath1 and @xmath2 obeys a two - parameter scaling function .",
    "finding an analytical expression for this function is something that still has to be done .",
    "a further interesting future line of research is to understand how to extract information about the operator content of the conformal field theories related to the infrared behavior of the studied critical spin systems ( that strongly depend on boundary conditions @xcite ) directly out of the mps tensors .",
    "we thank v. murg , i. mcculloch , e. rico , v. eisler for valuable discussions .",
    "the tdvp computation was kindly performed by j. haegeman .",
    "this work was supported by the fwf doctoral program complex quantum systems ( w1210 ) the fwf sfb project foqus , the erc grant querg , and the arc grants ff0668731 and dp0878830 .",
    "we aknowledge the financial support of the marie curie project fp7-people-2010-iif `` engages '' 273524 .",
    "37 natexlab#1#1bibnamefont # 1#1bibfnamefont # 1#1citenamefont # 1#1url # 1`#1`urlprefix[2]#2 [ 2][]#2    , , , * * , ( ) , http://stacks.iop.org/0295-5075/24/i=4/a=010 , , , * * , ( ) , * * , ( ) , issn , , , * * , ( ) , issn , , http://dx.doi.org/10.1007/bf02099178 , , , , * * , ( ) , _ _ ( , ) , , , , * * , ( ) , , , * * , ( ) , , , , * * , ( ) , , , , * * , ( ) , http://link.aps.org/doi/10.1103/physrevb.83.014409 , , , , , * * , ( ) , http://link.aps.org/doi/10.1103/physrevlett.106.105302 , , , , * * , ( ) , issn , http://iopscience.iop.org/1751-8113/43/37/372001 ( ) , http://adsabs.harvard.edu/abs/2010arxiv1006.5584o , ( ) , http://arxiv.org/abs/0804.2509 , , , * * , ( ) , http://link.aps.org/doi/10.1103/physrevb.80.144417 , , , , * * , ( ) , http://link.aps.org/doi/10.1103/physreve.82.061127 , , , * * , ( ) , , , , * * , ( ) , , , * * , ( ) , * * , ( ) , , , * * , ( ) , http://stacks.iop.org/1742-5468/2011/i=05/a=p05021 , * * , ( ) , issn , , , , , * * , ( ) , http://link.aps.org/doi/10.1103/physrevb.82.060410 , , , , , , , * * , ( ) , http://link.aps.org/doi/10.1103/physrevb.82.161107 , , , * * , ( ) , issn , * * , ( ) , http://link.aps.org/doi/10.1103/physrevlett.56.746 , , , , * * , ( ) , * * , ( ) , issn , http://jpsj.ipap.jp/link?jpsj/78/014001/ , * * , ( ) , * * , ( ) , , , , , ( ) , , * * , ( )",
    "recently it has been shown numerically that any mps simulation of an infinite spin chain leads to the emergence of an effective correlation length induced by the finite rank @xmath2 of the mps matrices , even if the studied system is critical  @xcite . in ref .",
    "@xcite the authors relate the numerical observation that @xmath123 from ref .",
    "@xcite to analytical results on the spectrum of the mps transfer matrix @xcite and to well - known results from conformal field theory  @xcite in order to derive an analytical expression for the exponent @xmath12 . here",
    "we derive the same results in a different way .",
    "the starting point for our argument is the same like the one in @xcite , namely that corrections to the exact ground state energy in the thermodynamic limit can have different origins .",
    "on one hand conformal invariance yields in the vicinity of the critical point ( i.e. @xmath124 ) according to refs .",
    "@xcite    @xmath125    where @xmath126 is a non - universal constant . on the other hand , mps simulations with finite @xmath2 yield according to refs .",
    "@xcite    @xmath127    where @xmath128 is a non - universal constant , @xmath129 is the residual probability due to the usage of finite @xmath2 and @xmath130 is related to the dominant eigenvalue of the reduced density matrix of the half - chain ( see refs .",
    "now it has been observed that the usage of finite @xmath2 in mps simulations close to the critical point leads to an effective shift of the critical point ( see fig . 2 in  @xcite ) .",
    "this observation led us to the idea of equating the corrections in eqs .",
    "( [ eq : escaling_cft ] ) and ( [ eq : escaling_mps ] ) and identifying @xmath131 with @xmath26 . together with the assumption @xmath132 this yields    @xmath133    where we have collected all constants into @xmath134 .    in the large @xmath2 limit ( required due to our assumption of working in the scaling limit )",
    ", the residual probability reads according to @xcite    @xmath135    where    @xmath136    and @xmath30 denotes the central charge in the associated conformal field theory . inserting ( [ eq : pr_01 ] ) and ( [ eq : b_01 ] ) into ( [ eq : kappa_derivation_01 ] ) yields after several steps    @xmath137    equating the exponents in ( [ eq : kappa_derivation_02 ] ) yields a quadratic equation for @xmath12 with the solutions    @xmath138    the physical root is the one that is positive for all values of @xmath30 , i.e.    @xmath139    which is exactly the result obtained in ref",
    ".  @xcite .          in this appendix",
    "we show how the effective correlation length @xmath61 emerges in our simulations of finite spin chains with pbc .",
    "as the scaling of the algorithm  @xcite is quasi - independent of the chain length @xmath1 we can use it to approximate ground states of arbitrary long chains with pbc .",
    "the relative precision of the mps ground state energy for a given @xmath2 is plotted in figure  [ fig : ishb_nall_dall ] as a function of @xmath1 .",
    "each of the lines contains a _ hump _ which can be interpreted as the evidence for a finite correlation length @xmath61 . in order to see this",
    "let us have a look at how the _ hump _ emerges .",
    "the left part of figure  [ fig : is_nall_d8d16_2linefit ] shows a comparison between the relative precision of the pbc - mps ground state energy ( i.e. the mps towards which the algorithm in  @xcite has converged ) and the relative precision of the energy for the mps that we had used as a starting point for the gradient search .",
    "as explained in  @xcite this is the local mps tensor obtained by imaginary time evolution  @xcite for a chain in the thermodynamic limit ( tl ) when it is used in the finite pbc geometry .",
    "one can see that for a given @xmath2 , on the left side of the _ hump _ there is considerable improvement in the precision of the energy between starting and ending point of the gradient search . as one approaches the _ hump _ from the left",
    ", the improvement decreases in order to vanish completely on the right side .",
    "this can be interpreted as follows : if @xmath1 is too large for a given @xmath2 , the finite chain looks for a local mps - tensor as if it would be infinite .",
    "sites that lie further apart than a certain correlation length @xmath61 effectively do not see each other .",
    "the transition to this region happens more or less smoothly since for growing powers of the mps transfer matrix @xmath140 , the subspace spanned by these powers gets smoothly restricted to the dominant eigenvector i.e. @xmath141 .    .",
    "]    thus the _ humps _ must represent some evidence for the emergence of a finite correlation length , but how can we extract some reliable numbers from them , as they differ considerably in shape and width ?",
    "the answer is given by the right part of figure  [ fig : is_nall_d8d16_2linefit ] .",
    "we have observed empirically that if we make a log - log plot of @xmath142 is the energy of the mps obtained as the ground state by our conjugate gradient search for the finite chain with @xmath1 sites and pbc .",
    "@xmath143 is the energy obtained by plugging the mps resulting from imaginary time evolution of the infinite chain into the finite size geometry with pbc .",
    "as mentioned in the main text , this mps is used as the starting point of the conjugate gradient search . ]",
    "we obtain approximately two straight lines connected by a small piece that is more or less smooth .",
    "this picture is reminiscent of a rotated hyperbola .",
    "we know furthermore that in the large @xmath1 limit all points have ordinate @xmath96 .",
    "this suggests to fit a hyperbola that is degenerated to two straight lines through our data .",
    "the intersection of these lines is a well defined point which should be proportional to @xmath61 .",
    "figure  [ fig : ishb_effcorrlen ] shows log - log plots of the effective correlation length as defined above for both the quantum ising and the heisenberg models . after fitting straight lines through each of the data sets we can read off the scaling @xmath144 with @xmath145 and @xmath146 .",
    "comparison with the analytical results ( i.e. @xmath49 and @xmath50 ) yields a difference of roughly @xmath122 for the quantum ising model and of roughly @xmath147 for the heisenberg model .",
    "these results are the ones we refer to in sec .",
    "[ sec : transition ] as the ones fulfilling @xmath148 .",
    "an alternative way to extract the effective correlation length is obtained by interpreting the abscissa of the minimum of each curve in fig .",
    "[ fig : e0_nd - e0_inf ] as a length proportional to @xmath61 . fitting a straight line through these minima in a log - log plot of @xmath149 yields for the is model the exponent @xmath150 which approximates the analytical result with an accuracy of roughly @xmath151 . on one hand",
    "this result is closer to the analytical value than the one obtained using the degenerated hyperbola fit . on the other hand , if we want to predict the bond dimension @xmath2 for which the jump in the trace distance occurs in simulations with fixed @xmath1 , it turns out that the value obtained using this fit in does not always coincide with the actual values observed in figure  [ fig : is_td_d64 ] . as mentioned above , the degenerated hyperbola",
    "fit satisfies this consistency test , which is why we prefer using that method to extract an approximation for @xmath12 .",
    "furthermore the plots in figure  [ fig : e0_nd - e0_inf ] require knowledge of the exact ground state energy in the thermodynamic limit , which is not always available .",
    "the strategy with the hyperbola fit on the other hand does not require any analytical results and thus can always be used .",
    "in this appendix we present the details we used for the conclusion drawn in section  [ sec : is_tl ] of the main text . as mentioned above in appendix  [",
    "sec : correction_to_scaling ] a reliable analysis of the thermodynamic limit can only be made properly if we move towards it on paths of constant @xmath80 .",
    "however this analysis provides conclusive results only for the is model which is why we skip presenting the results obtained for the hb model . as mentioned in the main text ,",
    "the reason why this method fails for the hb model is that the _ reference states _ are in that case not precise enough .    as a first step",
    "let us normalize the tensors in our states such that the largest eigenvalue of the mps transfer matrix @xmath140 is equal to one ( i.e. @xmath152 and @xmath153 ) .",
    "this yields for the norm of such a state    @xmath154    we will always use in the following lower - case greek letters to denote states that are normalized to one and upper - case letters for the corresponding state normalized according to ( [ eq : mps_norm_01 ] ) , i.e.    @xmath155    for the computation of the trace distance between _ reference states _ and states lying on a curve with fixed @xmath156 we need the absolute square of the overlap which becomes    @xmath157 ^ 2 }    { \\left [ 1 + \\sum_{i=2}^{d^2_{k , n } } \\lambda_i^n(d_{k , n},n ) \\right ]      \\left [ 1 + \\sum_{i=2}^{d_{\\textrm{ref}}^2 }                 \\lambda_i^n(d_{\\textrm{ref}},n ) \\right ] }    \\,\\,\\ , .",
    "\\end{split}\\ ] ]    in the numerator we have used @xmath158 to denote the eigenvalues of the overlap transfer matrix    @xmath159    where the @xmath160 represent as usually the matrices of a translationally invariant mps with @xmath1 sites and virtual bond dimension @xmath2 . similarly we will use for the eigenvalues of the mps transfer matrix the notation @xmath161 in the following .",
    "this can be done since we need only two of the quantities @xmath162 to uniquely specify the point of the phase diagram that we want to refer to .",
    "the crucial argument in favor of the persistence of a discrete transition between the two regimes in the thermodynamic limit will be the fact that in this limit @xmath163 converges much faster to @xmath164 in the fss regime ( i.e. for @xmath165 ) than it does in the fes regime ( i.e. for @xmath166 ) .",
    "in fact we will show below that in the first case @xmath167 while in the second case we have @xmath168 .",
    "the other contributions in the numerator of ( [ eq : mps_overlap ] ) will turn out to be negligible for @xmath4 , i.e. @xmath169 for any @xmath156 and all @xmath170 .",
    "furthermore we will show that the denominator of ( [ eq : mps_overlap ] ) remains finite in all cases such that we will be able to conclude that the overlap of the _ _ quasi - exact _ _ that is _ much larger _ than the one of the studied points on the path of constant @xmath156 .",
    "if we restrict our scaling analysis to chains of length @xmath171 it is sensible to assume that the mps with bond dimension @xmath172 is much closer to the exact ground state than it is to the states we analyze .",
    "thus the overlap that we obtain in this way is very close to the overlap with the exact ground state . ]",
    "ground state with states in the fes regime converges to zero in the thermodynamic limit . along the same lines we will argue that the overlap of the _ quasi - exact _ ground state with states in the fses regime is always larger than zero in the thermodynamic limit , thereby concluding that a detectable transition between the two regimes persists for @xmath4 .    to this end we have considered three paths in the fss regime ( @xmath173 ) and two paths in the fes regime ( @xmath174 ) .",
    "the exact data points @xmath0 for four of these paths are listed in table  [ tab : path_parameters ] .",
    "note that since @xmath175 the exact value for @xmath80 varies slightly within each path .",
    "& & & + @xmath156 & @xmath1 & @xmath2 & @xmath156 & @xmath1 & @xmath2 & @xmath156 & @xmath1 & @xmath2 & @xmath156 & @xmath1 & @xmath2 + @xmath176 & @xmath177 & @xmath178 & @xmath179 & @xmath180 & @xmath181 & @xmath182 & @xmath183 & @xmath184 & @xmath185 & @xmath186 & @xmath184 + @xmath187 & @xmath188 & @xmath189 & @xmath190 & @xmath191 & @xmath192 & @xmath193 & @xmath194 & @xmath195 & @xmath196 & @xmath197 & @xmath195 + @xmath198 & @xmath199 & @xmath200 & @xmath190 & @xmath201 & @xmath189 & @xmath202 & @xmath203 & @xmath204 & @xmath205 & @xmath206 & @xmath204 + @xmath198 & @xmath207 & @xmath208 & @xmath209 & @xmath210 & @xmath211 & @xmath212 & @xmath213 & @xmath214 & @xmath215 & @xmath216 & @xmath214 + @xmath217 & @xmath218 & @xmath219 & @xmath220 & @xmath221 & @xmath208 & @xmath222 & @xmath223 & @xmath224 & @xmath225 & @xmath226 & @xmath224 + @xmath217 & @xmath227 & @xmath228 & @xmath229 & @xmath230 & @xmath231 & @xmath232 & @xmath233 & @xmath59 & @xmath225 & @xmath234 & @xmath59 + @xmath235 & @xmath186 & @xmath236 & @xmath237 & @xmath186 & @xmath228 & @xmath238 & @xmath239 & @xmath240 & @xmath241 & @xmath242 & @xmath240 + & & & & & & @xmath182 & @xmath243 & @xmath244 & @xmath245 & @xmath246 & @xmath244 + & & & & & & @xmath182 & @xmath247 & @xmath248 & @xmath245 & @xmath249 & @xmath248 +     in different regimes .",
    "the exact pairs @xmath0 for the data points are given in table  [ tab : path_parameters ] .",
    "in the legend we have only explained in detail what the different markers mean for the path with @xmath250 .",
    "the markers for the other paths follow the same pattern .",
    "the full red lines are linear fits through the data for each @xmath163 respectively .",
    "the legend entries for these lines contain the values @xmath251 . ]",
    "let us first investigate how the numerator of the ratio ( [ eq : mps_overlap ] ) behaves .",
    "we have observed that if we look at the eigenvalues @xmath252 along paths with constant @xmath156 , then @xmath253 scales polynomially in @xmath1 as can be seen in the log - log plot of figure  [ fig : is_tlpath_overlap_tmeigval ] , such that we have    @xmath254     & & & + @xmath255 & @xmath256 & @xmath257 & @xmath256 & @xmath257 & @xmath256 & @xmath257 + @xmath164 & @xmath258 & @xmath259 & @xmath260 & @xmath261 & @xmath262 & @xmath263 + @xmath264 & @xmath265 & @xmath266 & @xmath267 & @xmath268 & @xmath269 & @xmath270 + @xmath271 & @xmath272 & @xmath273 & @xmath274 & @xmath275 & @xmath276 & @xmath277 + @xmath184 & @xmath278 & @xmath279 & @xmath280 & @xmath281 & @xmath282 & @xmath283 + @xmath195 & @xmath284 & @xmath285 & @xmath286 & @xmath287 & @xmath288 & @xmath289 + @xmath204 & @xmath290 & @xmath291 & @xmath292 & @xmath293 & @xmath294 & @xmath295 + @xmath214 & @xmath296 & @xmath297 & @xmath298 & @xmath299 & @xmath300 & @xmath301 + @xmath224 & @xmath302 & @xmath303 & @xmath304 & @xmath305 & @xmath306 & @xmath307 + @xmath59 & @xmath308 & @xmath309 & @xmath310 & @xmath311 & @xmath312 & @xmath313 + @xmath240 & @xmath314 & @xmath315 & @xmath316 & @xmath317 & @xmath318 & @xmath319 +     & & + @xmath255 & @xmath256 & @xmath257 & @xmath256 & @xmath257 + @xmath164 & @xmath320 & @xmath321 & @xmath322 & @xmath323 + @xmath264 & @xmath324 & @xmath325 & @xmath326 & @xmath327 + @xmath271 & @xmath328 & @xmath329 & @xmath330 & @xmath331 + @xmath184 & @xmath332 & @xmath333 & @xmath334 & @xmath335 + @xmath195 & @xmath336 & @xmath337 & @xmath338 & @xmath339 + @xmath204 & @xmath340 & @xmath341 & @xmath342 & @xmath343 + @xmath214 & @xmath344 & @xmath345 & @xmath346 & @xmath347 + @xmath224 & @xmath348 & @xmath349 & @xmath350 & @xmath351 + @xmath59 & @xmath352 & @xmath353 & @xmath354 & @xmath355 + @xmath240 & @xmath356 & @xmath357 & @xmath358 & @xmath359 +    figure  [ fig : is_tlpath_overlap_tmeigval ] shows a log - log plot of @xmath253 for all @xmath156 and fixed @xmath360 .",
    "the numerical values of @xmath361 and @xmath362 for the @xmath240 largest @xmath252 are listed for the paths in the fes regime in table  [ tab : overlap_fit_fses ] .",
    "the equivalent data for paths in the fes regime can be found in table  [ tab : overlap_fit_fess ] .",
    "we see that in the fss regime for @xmath363 we have @xmath364 while in all other cases we get @xmath365 .",
    "this means that for @xmath4 the overlap ( [ eq : mps_overlap ] ) always converges to zero in the fes regime due to    @xmath366    and due to the fact that the denominator is always larger than zero ( in fact it is always larger than one ) . in the fss regime on the other hand ,",
    "the @xmath363 terms in the numerator of ( [ eq : mps_overlap ] ) survive in the thermodynamic limit due to    @xmath367    however this is not enough in order to show that the overlap is strictly larger than zero in this regime . a diverging denominator in the limit @xmath4 could spoil this line of reasoning , so we have to convince ourselves that both factors in the denominator of ( [ eq : mps_overlap ] ) remain finite in the thermodynamic limit .     and all @xmath1 occuring in table  [ tab : path_parameters ] . in the legend",
    "we have only explained in detail what the different markers mean for the @xmath1 in the path with @xmath250 .",
    "the markers for the other paths follow the same pattern .",
    "the dotted red lines are linear fits through the data for each @xmath368 respectively .",
    "the legend entries for these lines contain the values @xmath369 . ]     & & & + @xmath255 & @xmath256 & @xmath257 & @xmath256 & @xmath257 & @xmath256 & @xmath257 + @xmath264 & @xmath370 & @xmath371 & @xmath372 & @xmath373 & @xmath374 & @xmath375 + @xmath271 & @xmath376 & @xmath377 & @xmath378 & @xmath379 & @xmath380 & @xmath381 + @xmath184 & @xmath382 & @xmath383 & @xmath384 & @xmath385 & @xmath386 & @xmath387 + @xmath195 & @xmath388 & @xmath389 & @xmath390 & @xmath391 & @xmath392 & @xmath393 + @xmath204 & @xmath394 & @xmath395 & @xmath396 & @xmath397 & @xmath398 & @xmath399 + @xmath214 & @xmath400 & @xmath401 & @xmath402 & @xmath403 & @xmath404 & @xmath405 + @xmath224 & @xmath406 & @xmath407 & @xmath408 & @xmath409 & @xmath410 & @xmath411 + @xmath59 & @xmath412 & @xmath413 & @xmath414 & @xmath415 & @xmath416 & @xmath417 + @xmath240 & @xmath418 & @xmath419 & @xmath420 & @xmath421 & @xmath422 & @xmath423 +     & & + @xmath255 & @xmath256 & @xmath257 & @xmath256 & @xmath257 + @xmath264 & @xmath424 & @xmath425 & @xmath426 & @xmath427 + @xmath271 & @xmath428 & @xmath429 & @xmath430 & @xmath431 + @xmath184 & @xmath432 & @xmath433 & @xmath434 & @xmath435 + @xmath195 & @xmath436 & @xmath437 & @xmath438 & @xmath439 + @xmath204 & @xmath440 & @xmath441 & @xmath294 & @xmath442 + @xmath214 & @xmath443 & @xmath444 & @xmath445 & @xmath446 + @xmath224 & @xmath447 & @xmath448 & @xmath449 & @xmath450 + @xmath59 & @xmath451 & @xmath452 & @xmath453 & @xmath454 + @xmath240 & @xmath455 & @xmath456 & @xmath457 & @xmath458 +    let us first treat the norm of the reference mps since this turns out to be the easier one .",
    "figure  [ fig : is_tlpathd64_norm_tmeigval ] shows a log - log plot of @xmath459 for all @xmath156 and fixed @xmath360 .",
    "the numerical values for @xmath460 are given in tables  [ tab : normdref_fit_fses ] and  [ tab : normdref_fit_fess ] .",
    "for large chains with @xmath461 figure  [ fig : is_tlpathd64_norm_tmeigval ] clearly indicates polynomial scaling in @xmath1 .",
    "note that for small chains with @xmath462 the plot deviates from the nice linear behavior that we see for @xmath461 .",
    "the reason for this are numerical errors in the computation of the ground state mps .",
    "this effect can also be seen in figure  [ fig : ishb_nall_dall ] : for @xmath462 the algorithm we use can not minimze the energy beyond a relative precision of roughly @xmath463 even if we decrease @xmath1 while keeping a constant @xmath44 . apart from that ,",
    "the fitting in figure  [ fig : is_tlpathd64_norm_tmeigval ] yields all @xmath365 for @xmath464 thus we can conclude that the norm @xmath465 converges to one in the thermodynamic limit when we use the normalization prescription ( [ eq : mps_norm_01 ] ) .     in different regimes .",
    "the exact pairs @xmath0 for the data points are given in table  [ tab : path_parameters ] .",
    "in the legend we have only explained in detail what the different markers mean for the path with @xmath250 .",
    "the markers for the other paths follow the same pattern .",
    "the full red lines are linear fits through the data for each @xmath368 respectively .",
    "the legend entries for these lines contain the values @xmath369 . ]     & & & + @xmath255 & @xmath256 & @xmath257 & @xmath256 & @xmath257 & @xmath256 & @xmath257 + @xmath264 & @xmath466 & @xmath467 & @xmath468 & @xmath469 & @xmath470 & @xmath471 + @xmath271 & @xmath472 & @xmath473 & @xmath474 & @xmath475 & @xmath476 & @xmath477 + @xmath184 & @xmath478 & @xmath479 & @xmath480 & @xmath481 & @xmath482 & @xmath483 + @xmath195 & @xmath484 & @xmath485 & @xmath486 & @xmath487 & @xmath488 & @xmath489 + @xmath204 & @xmath490 & @xmath491 & @xmath492 & @xmath493 & @xmath494 & @xmath495 + @xmath214 & @xmath496 & @xmath497 & @xmath498 & @xmath499 & @xmath500 & @xmath501 + @xmath224 & @xmath502 & @xmath503 & @xmath504 & @xmath505 & @xmath506 & @xmath507 + @xmath59 & @xmath508 & @xmath509 & @xmath510 & @xmath511 & @xmath512 & @xmath513 + @xmath240 & @xmath514 & @xmath515 & @xmath516 & @xmath517 & @xmath518 & @xmath519 +     & & + @xmath255 & @xmath256 & @xmath257 & @xmath256 & @xmath257 + @xmath264 & @xmath520 & @xmath521 & @xmath522 & @xmath523 + @xmath271 & @xmath524 & @xmath525 & @xmath526 & @xmath527 + @xmath184 & @xmath528 & @xmath529 & @xmath530 & @xmath531 + @xmath195 & @xmath532 & @xmath533 & @xmath534 & @xmath535 + @xmath204 & @xmath536 & @xmath537 & @xmath538 & @xmath539 + @xmath214 & @xmath540 & @xmath541 & @xmath542 & @xmath543 + @xmath224 & @xmath544 & @xmath545 & @xmath544 & @xmath546 + @xmath59 & @xmath547 & @xmath548 & @xmath549 & @xmath550 + @xmath240 & @xmath551 & @xmath552 & @xmath553 & @xmath554 +    the norm of the states @xmath555 along paths with constant @xmath156 also turns out to converge to a finite value even though the argument is a bit trickier in this case .",
    "the scaling of the largest eigenvalues @xmath556 for each path is shown in figure  [ fig : is_tlpath_norm_tmeigval ] .",
    "the numerical values for @xmath460 are given in tables  [ tab : norm_fit_fses ] and  [ tab : norm_fit_fess ] .",
    "we see that most of the @xmath362 are very close to one for small @xmath255 in contrast to the values obtained for @xmath557 which are all well below one .",
    "in fact some of the @xmath362 are even bigger than one suggesting that @xmath558 in these cases . in section  [ sec : appendix_scaling_is_tlpath_norm ] of this appendix",
    "we give evidence for the fact that even if @xmath559 in some cases , the number of these values remains finite for any @xmath156 .",
    "furthermore we argue that in these cases it is reasonable to assume that we actually have @xmath560 which yields in the thermodynamic limit    @xmath561    summing up all relevant contributions then yields for the norm of states in the different regimes    @xmath562    this allows us to approximate the overlap ( with a _ quasi - exact _ state ) towards which mps simulations in different regimes converge to ( on the paths we considered ) as    @xmath563    thus we can conclude that the thermodynamic limit of the overlap in the fss regime is always greater than zero proving that there is indeed an discrete transition from the fss regime to the fes regime where the overlap becomes zero .      the first ten parameters @xmath257 and @xmath256 for the mps transfer matrix eigenvalues @xmath556 on paths in the fses regime are given in table  [ tab : norm_fit_fses ] , the ones for paths in the fess regime in table  [ tab : norm_fit_fess ] . in the fess regime we have @xmath564 which then yields a contribution of @xmath565 to the norm .",
    "for @xmath566 we clearly see how the @xmath256 rapidly decay below one , thereby making sure that the corresponding contributions to the norm become zero in the thermodynamic limit .",
    "this means that if we approach the thermodynamic limit on paths in the fess regime and always normalize the mps according to ( [ eq : mps_norm_01 ] ) , i.e. @xmath152 , the norm of these states does not get bigger than two .",
    "in fact it is very likely that the true contribution of @xmath567 is de facto zero : is in fact equal to one which yields in the thermodynamic limit @xmath568 .",
    "unfortunately , as opposed to the similar case in the fses regime , we can not conclude here that this must be the case . ] for @xmath1 as big as @xmath569 , using the values for @xmath570 and @xmath571 given in table  [ tab : norm_fit_fess ] , we get @xmath572 and @xmath573",
    ".    in the fses regime on the other hand the @xmath256 seem to oscillate randomly around one so we must look at the behavior of larger @xmath255 in order to see if and when they decay below one , which is what we ultimately need in order to show that the norm of these states remains finite in the thermodynamic limit when the normalization prescription ( [ eq : mps_norm_01 ] ) is employed .     for @xmath574 . a zoomed view on the first @xmath575 values is shown in the inset .",
    "]     to the norm of the states in the thermodynamic limit , i.e. @xmath576 .",
    "note how all contributions fall off exponentially below machine precision at @xmath577 . ]",
    "figure  [ fig : is_tlpath_norm_beta200 ] shows a log - plot of the first @xmath578 @xmath256 in the fses regime and of the first @xmath579 in the fess regime .",
    "all curves are approximately straight lines in this plot which means that the @xmath256 decay exponentially with @xmath255 .",
    "remember that on the paths we chose to investigate in the fess regime , the mps with the largest virtual bond dimension have @xmath580 , thus we can not fit any parameters @xmath256 for @xmath581 since we have only one data point available there .",
    "for @xmath582 we have only two data points , namely the ones for @xmath583 and @xmath580 ( see table  [ tab : path_parameters ] in the main text ) which is usually not the best premise for an accurate fit .",
    "nonetheless the @xmath256 fitted in this range obey the same exponential decay observed for smaller @xmath255 , where more data points are available .",
    "the inset in figure  [ fig : is_tlpath_norm_beta200 ] shows a zoom into the region with @xmath584 .",
    "while for @xmath585 all @xmath256 in the fses regime are very close to one , we observe that for larger @xmath255 , the @xmath586 line is visibly above the @xmath587 line .",
    "this would suggest that in the thermodynamic limit the eigenvalues @xmath588 would each yield a contribution equal to one to the norm while the contribution from the @xmath589 with @xmath590 would vanish , since in these cases @xmath591 .",
    "this makes however no sense since the @xmath589 are decreasingly ordered , i.e. @xmath592 if @xmath593 .",
    "this leads us to the conclusion that the oscillations around one that we observe for @xmath594 are numerical relics and that the true value of the @xmath256 is either one or something smaller than one .",
    "this conclusion is based on the fact that in mps simulations the transfer matrix eigenvalues that converge first are the dominant eigenvalues ( i.e. the ones with the largest absolute value ) so we can assume that the values obtained for @xmath595 are much more accurate than the other ones .",
    "thus the worst case for our purpose is when all @xmath256 that are not clearly smaller than one , are actually equal to one .",
    "let us investigate what we would get for the norm in this case . if @xmath587 , the contribution of these eigenvalues to the norm in the thermodynamic limit solely depends on @xmath257 due to    @xmath596    figure  [ fig : is_tlpath_norm_alpha60 ] shows the behavior of @xmath597 for the paths in the fses regime and @xmath598 , which according to figure  [ fig : is_tlpath_norm_beta200 ] is the problematic @xmath255-range .",
    "we see how all contributions rapidly decay below machine precision .",
    "note that the black line ( i.e. the path with @xmath599 ) is for @xmath600 several orders of magnitude above the @xmath586 and @xmath601 lines , which is due to the fact that the corresponding @xmath256 are so much smaller than one in this region , that the assumption @xmath602 simply does not hold , and the actual contribution to the norm converges to zero .",
    "note furthermore how for small @xmath255 all three lines are almost on top of each other meaning that the values to which the norm converges in the thermodynamic limit for mps on different paths in the fses regime will be very similar .",
    "in fact we get    @xmath603    which completes our argument that the norm of the mps remains finite on any path in the fses regime .",
    "in this appendix we will show that the algorithm  @xcite that we used to obtain all results in this work is performing better than other recently presented approaches .    for the sake of completeness let us first recapitulate the result of the comparison to the algorithm presented in  @xcite .",
    "we have already shown in  @xcite that our pbc algorithm yields a better precision .",
    "apart from several other differences in these two approaches , the crucial point is that we allow for a variable dimension @xmath22 of the dominant subspace used to approximate big powers of the transfer matrix .",
    "even though this contributes a factor @xmath604 to the overall computational cost @xmath605 , we have shown in  @xcite that there is no way to get rid of the factor @xmath22 if one wants to reproduce the correlation function throughout the entire pbc chain faithfully .",
    "if the same @xmath22-scanning strategy would be employed in  @xcite , probably the same precision level could be achieved , however the computational cost in that algorithm would then scale like @xmath606 .",
    "there is an additional factor @xmath1 in that scaling because that approach is not translationally invariant .",
    "the power of @xmath22 is reduced by one due to the fact that the energy is minimized directly and not using the gradient .",
    "next we would like to compare our pbc algorithm to the one presented in  @xcite . in that work",
    "the authors simulate the critical quantum ising model by using time evolving block decimation  @xcite to locally update a translationally invariant mps which is then plugged into a chain with pbc geometry in order to compute the energy .",
    "the weakness of that algorithm is that the local update of the mps tensors does not take into account the boundary conditions : the fixed point mps is exactly the same like the one obtained when trying to approximate the ground state of an infinite chain . in spite of this",
    ", the ground state energy can be approximated quite well since the scaling of the computational cost is only @xmath98 which allows the use of very large @xmath2 .",
    "unfortunately there are no explicit plots of the precision of the ground state energy in  @xcite as a function of @xmath2 . from the abstract and footnote 4 of that work",
    "we deduce that the simulation that yields the error @xmath607 for the critical quantum ising pbc chain with @xmath608 was done with a mps with bond dimension @xmath609 .",
    "we reach the same precision with @xmath2 as small as @xmath610 as can be seen in figure  [ fig : ishb_nall_dall ] . due to the higher computational cost of our algorithm",
    "@xmath609 is out of reach for us .",
    "nonetheless we have computed an approximation of the ground state of the infinite chain with a translationally invariant mps with @xmath609 ( details of this are given below ) and then plugged this mps into a pbc chain geometry with @xmath608 .",
    "the relative precision that we obtained _ _ _ _ using this strategy was @xmath611 which is in perfect agreement with the claim made in  @xcite .",
    "however , if we take into account the fact that a pbc simulation with @xmath608 and @xmath609 is well in the fses regime due to @xmath612 , it becomes immediately clear that with @xmath609 one can in principle reach a much better precision than @xmath613 .",
    "in other words , the results obtained in  @xcite correspond to the cyan ( light ) lines in the left plot of figure  [ fig : is_nall_d8d16_2linefit ] .",
    "while this is perfectly fine for simulations in the fess regime , if one is in the fses regime , there is room for one or more orders of magnitude of improvement of the relative precision .",
    "there is another point worth mentioning regarding our pbc algorithm  @xcite . in order to check the claims made in  @xcite",
    ", we needed to first approximate the ground state of the infinite chain with an mps with @xmath609 .",
    "for this we used a new method called time - dependent variational principle  @xcite .",
    "we did this because tdvp converges much faster than imaginary time evolution based on matrix product operators  @xcite or itebd  @xcite .",
    "the relative precision we achieved with tdvp was @xmath614 .",
    "we knew that this can not be the best precision that can be reached with @xmath609 since in  @xcite we get roughly the same precision with @xmath2 as small as @xmath615 .",
    "thus we ran the pbc algorithm for a huge chain with @xmath616 sites on top of the mps obtained by tdvp . choosing as the parameters of that algorithm @xmath617 and @xmath618 we managed to reduce the relative precision to @xmath619 which is in perfect agreement with the polynomial scaling shown in figure 1 of  @xcite .",
    "the lesson learned from this approach is that tdvp results can be improved using our pbc algorithm well in the fess regime .",
    "we emphasize that running the pbc algorithm with small @xmath22 did not yield any improvement to the tdvp result . only with @xmath22 as large as @xmath620 we obtained the improved precision .",
    "this is quite strange as when we compute the energy density for the infinite chain , only one dominant eigenvector is used , i.e. @xmath621 .",
    "so it seems that even if additional dominant eigenvectors do not enter the final computation of the ground state energy , they do have an effect during the local optimization procedure of the translationally invariant mps ."
  ],
  "abstract_text": [
    "<S> we investigate the use of matrix product states ( mps ) to approximate ground states of critical quantum spin chains with periodic boundary conditions ( pbc ) . </S>",
    "<S> we identify two regimes in the @xmath0 parameter plane , where @xmath1 is the size of the spin chain and @xmath2 is the dimension of the mps matrices . in the first regime mps can be used to perform finite size scaling ( fss ) . in the complementary regime </S>",
    "<S> the mps simulations show instead the clear signature of finite entanglement scaling ( fes ) . in the thermodynamic limit ( or large @xmath1 limit ) , only mps in the fss regime maintain a finite overlap with the exact ground state . </S>",
    "<S> this observation has implications on how to correctly perform fss with mps , as well as on the performance of recent mps algorithms for systems with pbc . </S>",
    "<S> it also gives clear evidence that critical models can actually be simulated very well with mps by using the right scaling relations ; in the appendix , we give an alternative derivation of the result of pollmann et al . </S>",
    "<S> [ phys . </S>",
    "<S> rev . </S>",
    "<S> lett . </S>",
    "<S> 102 , 255701 ( 2009 ) ] relating the bond dimension of the mps to an effective correlation length . </S>"
  ]
}