{
  "article_text": [
    "mapping the mass distributions of galaxy clusters via their weak gravitational lensing effect has become something of a standard tool in astrophysics , allowing these most massive objects to be better understood in terms of their matter content , dynamical state and their value as galaxy evolution laboratories and cosmic observatories . given this importance , it seems worthwhile to investigate  more accurate , more robust , and more practically useful methods for reconstructing the mass distributions in clusters from the available data .    following a number of seminal papers on the subject in the 1990s  @xcite ,",
    "the emphasis now is very much on the application of mapping methods to weak gravitational lensing shear data .",
    "large ccd mosaic cameras such as suprimecam at subaru , megacam at cfht and the eso wide field imager at la silla have enabled the mass distributions of clusters to be mapped to much larger radii than before  @xcite . from space with hst ,",
    "the same science has been made possible in higher redshift clusters , first though large multi - pointing wfpc2 datasets  @xcite and subsequently with observations with the advanced camera for surveys ( acs )  @xcite . as is always the case in astronomy ,",
    "these data are being pushed to their limits : the aim now is to understand cluster mass distributions in great detail , moving beyond the simple mass estimates of the early years . @xcite and",
    "@xcite measured the outer logarithmic slope of the density profile in two systems , while @xcite investigated the relative peak positions of the gravitating mass density and the intracluster gas density ( the latter being derived from the x - ray surface brightness ) .",
    "the quantification of the substructure in galaxy clusters is a topic of ongoing research , with progress being made in the central parts of clusters by comparing strong and weak lensing mass models with predictions from n - body simulations  @xcite .    despite the advances in data quality ,",
    "weak gravitational lensing data remains very sparse and very noisy .",
    "it is notable indeed that the most exciting results in the field in recent years have come from the comparison of weak lensing data with external observations , such as the modelling of strong gravitational lensing features @xcite , the x - ray emission ( as in * ? ? ?",
    "* ) , and the optical data on the cluster member galaxies @xcite . with this in mind",
    ", we ask how best to extract as much information as possible from the weak lensing data , and how to draw the most meaningful conclusions about the mass distributions in clusters . in general terms , including information from external sources means assigning appropriate prior probability distributions to whatever set of parameters we are using : to this end we seek a flexible fitting algorithm that is able to cope with such constraints and return parameter estimates ( with accurate uncertainties ) that reflect all the observational data in hand .",
    "moreover , the choice of model itself can be made so as to facilitate comparisons with independent observations .",
    "however , in the first instance , it seems sensible to postpone combination with other observational data until the lensing signal is understood .    in all weak lensing reconstruction algorithms to date",
    "the assumed model has been that of a grid of pixels , whose values ( be they surface mass density or lens potential ) comprise the model parameters , an approach often described as `` non - parametric . ''",
    "it is not at all clear that a grid of pixels is the optimal model for a cluster mass distribution ; as shown in  ( * ? ? ?",
    "* hereafter m02 ) , such a large number of parameters is very often discouraged by the data quality , leading to over - fitting and potentially over - interpretation of the data . in",
    ", the effective number of parameters was reduced by including the assumption of the mass pixels being correlated on some characteristic angular scale ( @xmath1arcmin ) , an algorithm implemented in the code .",
    "this assumption led to smoother , less noisy maps , which , by virtue of the resolution scale being inferred from the data themselves , were restricted to show only `` believable '' structures with angular scales greater than the resolution parameter . in this work we seek a more natural basis set of functions with which to model cluster mass distributions . by correlating pixels together",
    ", cluster - like structures can be more easily modelled : the logical extension of this idea is to build up a mass distribution from components that already have cluster - like properties .",
    "this is the principal concept in this work .    from n - body simulations we expect the ensemble average mass distribution to be ellipsoidal with an nfw profile  @xcite , and clusters to lie at the high mass end of a hierarchy of structures , each with this same universal profile .",
    "the nfw profile has some support from the data , at least for the most massive halos : previous gravitational lensing analyses have found the nfw profile mass distribution to provide a somewhat better description of the data than competing models  @xcite , as have high resolution x - ray studies @xcite .    if all the mass in clusters of galaxies were distributed exactly in ellipsoidal nfw - profile halos , then the optimal basis set for the lensing inverse problem would be a collection of ellipsoidal nfw profile mass components , shifted and scaled to match the various mass clumps in the field .",
    "the results of the simulations suggest that clusters do indeed look like this , and it is this that motivates our choice of mass model .",
    "this basis set allows a continuously multi - scale mass map to be reconstructed , with the angular resolution reflecting the local data quality and signal strength , but also the expected density profile cusps and slopes .",
    "we anticipate that such a basis set will be able to cope much better with the high level of noise in the data , provided that the data themselves are used to select the appropriate number of mass components used in the inference : if the weak shear data only support the inference of a small number of parameters associated with a small number of mass components , then we must be able to quantify this statement , and so automatically prevent the over - fitting that can plague pixel - based methods .    while it is the nfw component parameters that are to be inferred , it is a reconstructed projected mass map that best encapsulates our state of knowledge of the cluster potential .",
    "such maps can be constructed by tabulating the inferred ( shifted and scaled ) basis functions onto a grid of pixels .",
    "these maps will have , by design , highly correlated pixel values : the covariance of the pixel values should also be taken into account to make the maps quantitatively useful .",
    "the general ideas introduced above , whilst not previously applied in the field of weak gravitational lensing , are not new to the inferential science community .",
    "such `` atomic '' methods were suggested and developed for image reconstruction by  @xcite , who was motivated to move beyond pixellised models when analysing spectral and image data for the same reasons as outlined above .",
    "skilling s `` atoms '' were often very simple in nature , as he sought to reconstruct complex images with very little prior knowledge . to have such a natural choice of `` atom , '' as proposed above for galaxy clusters , is something of a rare treat .",
    "indeed , we might instead dub the nfw halos `` physical components '' to emphasise their highly motivated nature .",
    "this also helps to avoid the possible confusion that may be induced by the term `` atomic inference '' among the readership of this journal .",
    "however , we should remain open to the idea that the details of the component properties are best also determined from the data  how else would we learn that the numerical simulations are realistic ? in this work we demonstrate the use of nfw halos in modelling weak lensing data : alternative models may not have such well - defined prior distributions , which puts them at a natural disadvantage when comparing models .",
    "however , if a particular dataset demands a different profile atom then this can be straightforwardly inferred from the data @xcite .",
    "the methodology in this work can be rightly seen as an extension of the mass modelling of ( * ? ? ?",
    "* and subsequent works ) .",
    "in their approach , one or two smooth elliptical mass components were used to model the positions of the strongly lensed images , with the parameters of the components optimised , and the model refined , as more multiple image systems were identified ; the weak lensing data was used ( if at all ) as a weak constraint on the ( primarily strong lensing ) model . here ,",
    "we adopt and justify the same modelling philosophy , but focus on the weak lensing effects of lower mass substructure at larger radii , increasing the number of free parameters , automating their estimation , exploring parameter degeneracies and pushing the interpretation of the mass components beyond that of simply stating a best - fit parameter set .",
    "indeed , our method is much closer to the `` smooth particle inference '' approach put forward for x - ray data analysis by  @xcite : the differences in this case arise from the much lower signal - to noise weak lensing data ( and the correspondingly fewer parameters the data can support ) , and the more obvious choice of basis set .",
    "having introduced the relevant concepts , we present in section  [ sect : method ] a detailed description of the application of the atomic inference technique to weak gravitational lensing data and demonstrate its performance on simulated data in section  [ sect : discuss ] ; its application to hst data is presented in  ( * ? ? ?",
    "* to some extent ) and in jaunsen et al ( 2006 , in prep . ) .",
    "the data considered here are the ellipticities of @xmath2 background galaxies ; under the assumption of intrinsically randomly oriented galaxies , the average ellipticity provides a ( noisy ) estimate of the local gravitational reduced shear @xmath3 ( see * ? ? ? * for an introduction ) .",
    "the magnitude of the ( complex ) ellipticity , as used throughout this paper , is @xmath4 where @xmath5 is the ellipse axis ratio . in practice ,",
    "each of @xmath6 lensed ellipticity components  @xmath7 ( real and imaginary ) are assumed to have been drawn independently from a gaussian distribution with mean  @xmath8 ; here  @xmath8 is the true value of the @xmath9 component of the ( complex ) reduced shear at the position of the galaxy .",
    "the likelihood function can then be written as ( see * ? ? ?",
    "* m02 ) @xmath10 where @xmath11 is the vector of ellipticity ( component ) values , and @xmath12 are the parameters of the lens potential used to calculate the shear fields at the background galaxy positions .",
    "@xmath13 is the usual misfit statistic @xmath14 and the normalisation factor is @xmath15 the effect of errors introduced by the galaxy shape estimation procedure have been included by adding them in quadrature to the intrinsic ellipticity dispersion , @xmath16 ^ 2}. \\label{eq : newsigma}\\ ] ] this approximation rests on the assumption that the shape estimation error  @xmath17 is gaussian .",
    "correcting for the effect of lensing on the intrinsic ellipticity dispersion , as suggested by @xcite and implemented by  @xcite , effectively provides the correct weighting of the ellipticities of images close to the critical regions of a strong lensing cluster .",
    "any arclets lying within the critical curves of the cluster act as estimators for @xmath18 instead of  @xmath3 @xcite : we make this correction when calculating  @xmath13 . in practice",
    "very few galaxies are affected by this correction , since most lie well outside the critical region , but these are the ones that contain high lensing signal and so should be treated with care . for a projected mass distribution @xmath19",
    "composed of @xmath0 physical components , the reduced shear at position @xmath20 is given by @xmath21 where @xmath22 and @xmath23 are the shear and convergence due to the @xmath24-th component , @xmath25 ( see , , * ? ? ? * for more details on the weak lensing observables . )",
    "the ( lens and source redshift - dependent ) critical density for the @xmath26 galaxy is @xmath27  any redshift information can be included here , although non - neglible redshift errors would need to be absorbed into the likelihood function , broadening it somewhat .",
    "note that in the above model all mass components are assumed to be at the same redshift .",
    "this is both necessary for the thin lens plane formulae to be applicable , and appropriate for a cluster modelling algorithm where all mass in the field of view is assumed to be associated with the cluster .",
    "if there were massive clumps lying along the line of sight their gravitational shear effects would be interpreted within this model .",
    "extending the physical component analysis into three dimensions is an intriguing possibility but beyond the scope of this paper ; however we do note that it may be profitable to do so , as the additional information needed in constraining the redshift of the components , and the more complex lens equations needed to predict the observed shear , are both readily incorporated into the already non - linear data model .      in the spherically symmetric case the nfw density profile",
    "@xcite is @xmath28 where @xmath29 and @xmath30 are the radius and density at which the logarithmic slope breaks from @xmath31 to @xmath32 .",
    "it is useful to normalise this profile , which we treat as a two - parameter fitting function , to the mass contained within a region of overdensity 200 relative to the critical density at that redshift  @xcite : @xmath33 .",
    "\\label{eq : m200}\\end{aligned}\\ ] ] here , @xmath34 is a measure of the concentration of the halo .",
    "lensing properties of the nfw model have been worked out by a number of authors @xcite and we do not reproduce their results here .",
    "each nfw mass component contributes to the shear field : we assign a uniform prior distribution to the component positions within the observation region .",
    "it has been found in many previous lensing analyses that it is rather important to include the ellipticity of the lens  ( see * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "there is some choice as to whether the lens potential , the deflection angle or the surface density should be asserted to be elliptically symmetric  since the three quantities differ by the number of times the gradient operator has been applied ( 0 , 1 and 2 times respectively ) , only one of them can have concentric elliptical contours .",
    "@xcite chose the surface density , while @xcite opted for the slightly rectangular projected mass contours of a concentric elliptical deflection angle distribution .",
    "we follow @xcite and , citing analytic tractability , use the lens potential  @xmath35 : the major disadvantage of this approach is that for axis ratios of less than @xmath36 the corresponding mass distribution becomes dumbbell - shaped .",
    "however , massive cluster potentials are likely to be much closer to spherical than this : we quantify this point below .",
    "the breaking of axial symmetry means that the derivatives of the lens potential must be calculated explicitly in order to calculate the shear and convergence ; this can be done analytically for each nfw profile component . in this process",
    "the radius parameter is defined in such a way as to keep the mass within a given circular radius constant as the ellipticity changes @xcite .    as outlined in the introduction ,",
    "n - body simulations provide the prior probability distributions for the nfw profile parameters .",
    "for example , @xcite showed that numerically simulated cluster - scale halos can be reasonably well modelled using triaxial ellipsoidal density profiles , and produced fitting functions for the probability distributions of the two axis ratios .",
    "however , as indicated above , we prefer to use the more readily calculated elliptical lens potential : we use the following procedure to derive an approximate prior on the lens potential ellipticity parameter from the distributions tabulated by @xcite .",
    "we draw a large number of halos axis ratios from the fitted joint probability density function ( ) , numerically project the prescribed densities onto the lens plane , and then compute ( using , after padding with zeros , fast fourier transforms  ffts ) the corresponding lens potentials via the convolution @xmath37 we then measure the axis ratio of the resulting isopotentials , from the ratios of the second moments of the potential .",
    "these isopotentials are not quite elliptical , and the inferred ellipticity changes slightly with radius ; however the derived ellipticities were compared with the actual isopotential at the scale radius and found to deviate by only a few percent .",
    "the resulting derived probability distribution for the lens ellipticity , defined as in section  [ sect : method : wl ] , is given in figure  [ fig : ellprior ] .",
    "it is well - approximated by a gaussian distribution with mean 0.125 and width ( standard deviation ) 0.05 , and it is this that we use as our ellipticity prior .",
    "the effects of this prior are to suppress halos with unphysically high ellipticity , and to favour the non - spherical halos which are more commonly seen in the n - body simulations .",
    "the position angle of the halo is assumed to follow a uniform distribution between @xmath38 and @xmath39 degrees : in the two - dimensional ellipticity component space the prior peaks at the circularly symmetric model .",
    "the priors on the nfw profile parameters may also be derived from n - body simulations .",
    "for example , @xcite find the concentration parameter @xmath40 to be distributed log - normally with width @xmath41 about a value of 3 , for a massive cluster at redshift 0.5 .",
    "we note that this width corresponds to an uncertainty of @xmath42 .",
    "although much larger values of the concentration have been inferred in some lensing analyses  @xcite , it is not clear that the data have enough constraining power in the critical region to support this conclusion . in any case , a concentration of 20 is less than 3-sigma from the mean of the lognormal distribution , suggesting that this prior is flexible enough to cope with unusual concentrations ( whilst retaining the desired feature of rejecting very low , and indeed negative , values ) .    finally we consider the prior on the atom mass itself , @xmath43 .",
    "the press - schecter formalism  @xcite , or one of its many numerically - corrected forms @xcite , would serve to provide an approximate prior for the halo mass were we observing a random patch of sky .",
    "the logarithmic slope of the mass function at the mass scale of galaxy clusters is close to @xmath44 , indicating the rareness of massive clusters .",
    "however , we are interested in pre - selected clusters , whose masses are large and typically estimable to within an order of magnitude .",
    "we suggest a compromise , and assign a jeffreys prior ( logarithmic slope @xmath31 ) to the halo mass , sampling uniformly in the logarithm of the mass .",
    "this has the pleasant effect of suppressing the introduction of mass into the map unless it is required by the data , but is not so severe that the halos either have masses that are heavily biased low , or are discouraged completely .",
    "a more rigorous approach would be to use the predicted halo occupation distribution to provide a joint prior on the number and mass of sub - halos , given a main cluster component .",
    "this is beyond the scope of this paper : the specified priors suffice to define a robust data model .",
    "we will see in section  [ sect : sim ] that the method is somewhat insensitive to the exact form of this prior , with the presence of components , and their masses , being principally determined from the data .",
    "whilst linear methods are often favoured on the grounds of computation speed and ease of error propagation , we argue that the benefits of a fully non - linear fit outweigh these factors .",
    "we are seeking an optimal mass reconstruction , folding in as much information as we can : we do not wish to compromise this goal in favour of a computationally easier alternative . with the",
    "non - linearity comes flexibility : introducing new constraints on the mass distribution can be done in a conceptually straightforward way , adding extra terms to the posterior for the model parameters .    in the non - linear data model",
    "the global best - fit point is typically hard to find , and exists in a parameter space whose dimensionality can run well into double figures when many components are used . to solve these problems",
    "we employ a markov chain monte carlo ( mcmc ) sampler to explore the parameter space .",
    "this technique is now widespread in astronomical data analysis .",
    "good introductions to the technique are given by @xcite and @xcite ; here we make the following brief comments .",
    "having defined a likelihood function @xmath45 , and sensible priors @xmath46 on the parameters  @xmath12 of the @xmath0 mass components , we note that the distribution containing all the information about the mass distribution is the posterior : @xmath47 calculating the numerator of the right hand side on a fine grid throughout the parameter space would allow the normalising evidence @xmath48 to be calculated , the regions of high probability to be located , and any uninteresting parameters to be numerically integrated over .",
    "in any more than a few dimensions both these operations are computationally unfeasible .",
    "it is much more convenient to work with samples drawn from the posterior distribution : both marginalisation and changing variables are trivial , the latter being done on a sample - by - sample basis .",
    "mcmc provides an efficient way of drawing these samples .",
    "perhaps of greater practical importance is the robustness of mcmc to local maxima in the likelihood .",
    "optimisation schemes for locating the best - fit point are vulnerable to becoming trapped at the wrong point in parameter space : mcmc alleviates this problem by providing a way out of such traps ( with a random trial step to a nearby part of the parameter space ) .",
    "note the dependence of the likelihood and evidence on the number of components used in the model , @xmath0 ( the priors on each component s parameters having been chosen to be independent of @xmath0 ) .",
    "the posterior probability distribution for @xmath0 can be seen to be available from the data via the evidence : @xmath49 . with the assignment of a uniform prior on the number of components",
    ", the evidence gives the ( discrete ) for @xmath0 directly .",
    "in the same way the evidence may also be used to quantify the relative probabilities of two or more competing component models , a process carried out in @xcite .",
    "the evidence lies at the heart of all bayesian model selection and hypothesis testing ( see * ? ? ? * for an excellent introduction ) , and its use is growing in astronomy @xcite .",
    "we use the freely available software package ` bayesys3 ` , written by john skilling .",
    "this general purpose code , used in previous work on this subject @xcite , is known to cope well with the types of likelihood surface presented by weak lensing datasets : we find the evidence values to be accurate and their calculation readily repeated .",
    "the evidence is calculated by thermodynamic integration during the burn - in period @xcite .",
    "the only disadvantage to using mcmc rather than an optimisation followed by a gaussian approximation to the posterior is that it can be slow : typically , analysing a catalogue of some few thousand galaxies using a model consisting of three components on a 3ghz processor can be expected to take several hours , while a chi - squared minimisation may only take minutes .",
    "however , the problem of avoiding local posterior maxima typically leads one to consider an ensemble of minimisations from different starting points , or the use of some more advanced algorithm such as simulated annealing ( which incur many more likelihood evaluations ) . likewise , estimating uncertainties is commonly done using techniques such as bootstrap re - sampling or simulation of mock data .",
    "the mcmc process performs more or less the same calculation during the inference .",
    "therefore it is the _ total _ run time , to obtain both reliable parameter estimates and their uncertainties that should be compared between methods  with this metric mcmc becomes rather competitive .",
    "while the parameters of individual halos may well be of interest @xcite , the information on the mass distribution can be displayed in a more visually helpful way , in the form of a mass image .",
    "each mcmc sample corresponds to a set of halos that provide an acceptable fit to the data : the projected mass distribution of these halos can be mapped on to a pixellised grid .",
    "the probability distribution of the surface mass density in any given pixel can be built up by calculating its value for each sample , and forming a histogram .",
    "this is the marginalised over all halo parameters , so that the width of this distribution represents the maximum uncertainty of that pixel value , given the assumptions . to make a map , the individual pixel probability distributions have to be reduced to one number : we use the arithmetic",
    "mean for its ease of calculation  @xcite , but note that an alternative central value may be more appropriate if the pixel value is highly skewed .",
    "the resulting reconstructed maps inevitably retain some of the appearance of the halos from which they are composed : however , averaging over the posterior does bring out some extra information not present in any individual sample map .",
    "these reconstructions can be thought of as having been highly regularised , using a multi - scale kernel whose shape has been chosen to be appropriate for dark matter in cluster halos . in the next section we show some examples of these atomic maps , and how well they describe the lensing data .",
    "in order to demonstrate the methodology introduced above , we generated mock weak lensing data for a typical , moderately massive ( @xmath50 ) , unrelaxed cluster at redshift  0.55 .",
    "we used an n - body simulated cluster , from the sample in @xcite .",
    "we placed background galaxies at random positions on a single source plane at redshift  1.2 ( such that the cluster has a tangential critical curve with radius @xmath51  arcsec ) , with a number density of 80  per square arcmin over a square field 3  arcmin on a side .",
    "this was intended to represent a standard weak lensing dataset from the acs camera on hst , and resulted in a catalogue of 741 galaxy shapes .",
    "an intrinsic ellipticity distribution of width  0.25 , and shape estimation error of  0.2 , were assumed .",
    "the reduced shear due to the input cluster was calculated by convolving ( using ffts ) the simulated cluster mass distribution ( as provided by the simulators and after padding with zeros to avoid edge effects ) with the lensing kernel , and then scaling by the critical density , as in @xcite .",
    "we note that this process used a projected density map with pixel scale @xmath52 arcsec , fine enough to retain any cuspy features in the mass distribution .    when assessing the statistical performance of the atomic inference algorithm , multiple noise realisations were used .",
    "each realisation corresponds to a separate set of background galaxy positions and intrinsic ellipticities , and a different shape estimation noise term . the true projected mass distribution , scaled by the critical density for this lens and source redshift , is shown in figure  [ fig : truth ] , along with one realisation of the simulated weak lensing data .",
    "a single source plane was employed for simplicity , and to separate out the performance of the atomic modelling from systematic effects due to unknown background galaxy redshifts .",
    "we do note again , however , that including measured redshifts for each source is trivial in this algorithm , since we predict the convergence and shear at each background galaxy position .",
    "we first investigate the number of halos appropriate for modelling this mock dataset .",
    "this was done by sampling the posterior distributions of the parameters of an @xmath0-component model , where @xmath0 was allowed to increase from 1 to 5 . for each inference",
    ", the evidence was calculated , and is shown in figure  [ fig : evid ] .",
    "these evidence values are readily reproducible , as indicated by the error bars on the plot : these show the standard deviations of the mean log evidence , over 5 runs of the sampler , to be routinely less than one unit .",
    "this plot gives us some confidence in the ability of the sampler to simulate the posterior ; it also quantifies the quality of the data available in observations such as that simulated .",
    "the plot shows evidence curves from ten different noise realisations , all of which peak at between 1 and 3 components .",
    "the different noise realisations give rise to posterior probability distributions with different geometries and complexities : the different challenges thus presented to the sampler result in a range of error bar sizes . in contrast , the scatter between the curves shows the effect the noise has on the appropriateness of @xmath0 components .",
    "the evidence for the @xmath53-halo model is @xmath54 : the ratio of this to the evidence for zero atoms ( the null model , with zero predicted surface mass density ) gives a measure of the significance of the detection @xcite .",
    "had figure  [ fig : evid ] been plotted over a wider range in the ordinate , probability ( evidence ) ratios relative to the null model of @xmath55 would have been visible , indicating a resounding detection of the cluster in the shear data .",
    "the differences between evidence values for @xmath53 of 1 , 2 , 3 , 4 and 5 components are much smaller , typically reaching between two and four units in the logarithm between the peak evidence and the @xmath56 value .",
    "these differences correspond to probability ratios of approximately @xmath57 : the data are found to be typically an order of magnitude more likely to have come from a two - component model than a 5-component model ( with the exact favoured value of @xmath53 being dependent on the noise realisation ) .",
    "this is an important result : the simulated data were designed to be representative of that being analysed in contemporary work ; what we are seeing here is a quantification of the amount of information available to us from that data . with the well - appointed halo model used , only a handful of parameters",
    "are both required and supported by the data .",
    "this is in agreement with the findings of : in the next section we show how the inferred mass distributions differ from the maximum entropy maps .",
    "the left - hand panels of figure  [ fig : maps ] show the ensemble - averaged halo - model mass reconstructions , for two different noise realisations . for comparison ,",
    "the maximum - entropy maps are shown along side , at two different resolution scales .",
    "these plots serve to illustrate some general points about the two techniques .",
    "the algorithm , and any other method that uses a single resolution scale when smoothing the data or in the reconstruction process itself , does not cope well with the range of scales of mass structure in this cluster .",
    "a sharp , cuspy peak , surrounded by an extended irregular mass distribution in the outer regions clearly requires at least two scales ( approximated here by the 15 and 40-arcsec resolution kernels ) : these scales are provided naturally by the physical components .",
    "the `` atomic '' reconstruction is remarkably robust between noise realisations , whereas the more flexible pixel - based method maps contain transient structure as the noise is fitted .",
    "this problem was alleviated in by increasing the resolution scale until , at maximum evidence , only believable features remained ; the same may be said about the structure in the atomic maps , except that the small - scale , high signal - to - noise structure is retained ( at the centre of the cluster ) .",
    "finally we note the long standing problem of inferring super - critical density from weak shear data , outlined in some detail in the work of @xcite  ( @xcite ) . with no additional information it is impossible to infer uniquely the presence of convergence greater than unity : in contrast , when constructing the mass distribution from naturally cuspy components the convergence can be effectively interpolated upwards in a seamless and physically - reasonable way .",
    "the observations of the previous paragraph can be put on a more quantitative footing by plotting the correlation between the inputs and outputs of the algorithms .",
    "this is shown in figure  [ fig : corr ] .",
    "we use the correlation function @xmath58 , where @xmath59 is the angular separation between galaxy pairs ; this is given by @xcite : @xmath60 where @xmath61 ( @xmath62 ) is the tangential ( cross ) component of the reduced shear estimator at galaxy position of galaxy a , relative to galaxy position b ( and vice versa ) .",
    "this function conveniently quantifies the alignment of pairs of galaxy shapes .",
    "since we are interested in the difference between the reduced shear predicted by the reconstructions ( @xmath3 ) , and either the true reduced shear ( @xmath63 ) or measured ellipticities ( @xmath64 ) , we construct the difference function @xmath65 for a perfect match on all scales , this function would be zero .",
    "all correlation functions decrease with increasing pair separation , as the lensing signal diminishes in strength .",
    "the upper panel of figure  [ fig : corr ] shows that the residuals in the 3-atom reconstruction , and the evidence - preferred 40-arcsec reconstruction , are consistent with noise ; the high resolution reconstruction shows a small positive @xmath66 at scales of 5 - 40 arcsec indicative of an imperfect reconstruction .",
    "this shortcoming is seen more clearly in the lower panel ; in the figure the low resolution map and the 3-atom reconstruction are seen to perform roughly equally well in recovering the true mass distribution , with the atomic map doing slightly better on the smallest scales .",
    "this agrees with the maps of figure  [ fig : maps ] , where the cuspy cluster centre is not reproduced with the smooth maximum - entropy map .",
    "the information in the correlation functions may also be visualised via maps of residuals . plotted in the left panel of figure  [ fig : error ]",
    "is the difference between the reconstruction in the top left hand panel of figure  [ fig : maps ] , and the true mass distribution ; for comparison , the central panel shows the width of the pixel value , as estimated by the standard deviation of the samples .",
    "this `` error '' map is informative : even in the regions where the shear signal is strong , the uncertainty on the predicted convergence is high .",
    "however , using this uncertainty map to rescale the residuals between reconstruction and truth we see that the differences are fairly low significance : only in the region of the undetected sub - clump are the pixel values more than 3 sigma from the truth ( where `` sigma '' is the uncertainty mapped in the central panel ) .",
    "evident in figure  [ fig : error ] is the small - scale mass structure in the cluster core , undetectable by weak lensing , that makes pointwise convergence prediction at the level of a few percent or better very difficult .",
    "clearly more information is needed : the work of @xcite indicates that including the mass associated with galaxies ( via small components placed at the cluster member positions ) is sufficient to model this substructure .",
    "the ensemble average mass map is one way of representing the information in the joint posterior ; marginal distributions for other parameters of interest are also readily available . for example , figure  [ fig : subclump ] shows the position , and mass profile parameters , associated with the secondary sub - clump visible in the projected mass map .",
    "mcmc samples corresponding to a circular region centred on the map peak were excised and histogrammed , to plot the marginalised posterior distributions for component position @xmath67 , and density profile parameters @xmath68 , where @xmath69 is the assumption that a mass feature of interest lies within this aperture .",
    "the widths of these distributions provide estimates of the uncertainties on the parameters .",
    "this secondary feature is somewhat transient : in some noise realisations the signal is too broken up to be detected .",
    "we now discuss three of aspects of the physical component analysis in greater detail .",
    "first is the sensitivity of the method to the prior s assigned to the model parameters ; second is the effect of the assumed halo model on the accuracy of the reconstruction ; third is the potential for including strong lensing information .",
    "we point out explicitly that the mass maps derived in the physical component analysis are biased , in the sense that no matter how good the data is the predicted mass distribution still has to be constructed from nfw - shaped halos , and in any individual cluster observed at a high signal - to - noise ratio one can imagine this model breaking down",
    ". indeed , careful inspection of the maps in figure  [ fig : error ] shows that the reconstructed surface density is systematically higher than the true density in the outer parts of the field of view , by 0.05 in convergence or so .",
    "this is despite the ellipticity data being fitted to a fully satisfactory level ( figure  [ fig : corr ] ) , and is due to the mass sheet degeneracy  @xcite .",
    "this effect when working with parameterised profiles was pointed out by @xcite and further investigated by @xcite , and was left as a limitation on the measurement of cluster density profiles . in the present case we are effectively selecting a particular mass sheet transformation parameter through our choice of the nfw profile for our mass components : the error bars mapped in figure  [ fig : error ] are model - dependent .",
    "the bias does lie , however , within this statistical uncertainty : the simulated cluster used here is well - fit by a density profile close to nfw !    the model - dependence of the inferences advocated is therefore presented as a sensible use of the prior information available from n - body simulations .",
    "however , one should remember that the universal profiles came from fitting the ensemble average profiles of simulated halos : in any given cluster it may be that the prior distribution for the concentration may not afford the halo profiles sufficient freedom to fit the data well , or even that some alternative profile is more appropriate altogether . in this case , the profile can be inferred from the data via the evidence as was shown in @xcite .",
    "when using any other profile , the priors on the halo parameters will not be as readily derived , and indeed may be preferred to be kept uninformative . in this case the occam s razor factor inherent to the evidence will act to favour the basic ( and _ a priori _ better - constrained ) nfw atom set .",
    "a consequent increase in evidence when using the alternative profile will then be a rather robust conclusion , the analyst s natural tendency towards the expected forms having been taken care of already .",
    "weak lensing data is very noisy : in such situations , we should be wary of the prior becoming comparable in importance to the likelihood function .",
    "we investigated this for the simulated dataset described above by applying some alternative priors and examining the evidence values .",
    "for the component masses we tried a prior uniform in mass ( as opposed to the jeffrey s prior suggested above , which is uniform in the logarithm of the mass ) .",
    "this prior is more favourable to higher mass components : if the presence of an extra component were being suppressed by the jeffreys prior then we would be more likely to see it with the more forgiving uniform distribution .",
    "we found the jeffrey s prior to give slightly higher evidence , perhaps slightly better reflecting the true halo occupation distribution .",
    "the difference was however , much less than one unit , suggesting that the component number and mass are well - determined by the data .",
    "indeed , the resulting mass maps were indistinguishable from those from the main analysis .",
    "connected to the prior for the component mass is that for the component number , implicitly assumed to be uniform when interpreting figure  [ fig : evid ] .",
    "while there may be some theoretical motivation for attempting to model the cluster with a mass function , that gives a joint on @xmath0 and halo mass , that is steeper than that used here , we would run the risk of over - fitting the data . at present , figure  [ fig : evid ] shows that the fit is being sensibly regularised in models with small numbers of components , with the evidence clearly decreasing towards higher  @xmath0 .",
    "when using data with artificially low noise , the evidence does indeed favour higher numbers of components , and lower mass features in the field are indeed recovered , as expected .",
    "we also investigated the effect of changing the component ellipticity prior , broadening it to make higher ellipticity components intrinsically more probable .",
    "again , this made very little difference to the evidence values or to the mass maps .",
    "the non - linear nature of the inference process described in the previous sections makes it straightforward to include strong lensing constraints as priors .",
    "these constraints may come from galaxy - scale lenses in the field , or from objects multiply - imaged by the cluster potential itself .",
    "for example , an independent strong lens modelling ( on either scale ) might be designed to yield estimates of the convergence and shear ( or perhaps more likely , magnification @xmath70 ) at a particular point , with error bars (  @xmath71 ) .",
    "these uncertainties , when translated into gaussian ( or the appropriate error distribution ) s centred on the point estimate , can be used to weight the mcmc trial parameter sets : the weak lensing likelihood is simply multiplied by the value of a such as @xmath72 .",
    "this approach , while convenient for marrying two independent pieces of analysis software , would be somewhat wasteful in its use of information ( and has not yet been applied in practice ! ) .",
    "a more rigorous approach would be to include the strong lens image positions , or even the image pixel values themselves , as data , and form a joint likelihood from the product of the individual weak and strong lensing forms .",
    "such an analysis is beyond the scope of this work , but is being developed as an extension of the lenstool package @xcite .",
    "mcmc is anticipated as being very useful indeed here : the strong lensing likelihood surface is highly complex .",
    "one application of cluster lensing that has been suggested is to predict the `` external '' convergence at the position of galaxy - scale strong lenses in the cluster field @xcite .",
    "any contribution to the strong lens convergence is degenerate with the estimate of hubble s constant from that lens , motivating the study of additional constraints on the convergence , such as might be hoped for from weak lensing .",
    "while both strong and weak lens systems suffer from the mass sheet degeneracy referred to above , when assuming physically - motivated parameterised profiles for all mass distributions this degeneracy is broken . a model - dependent estimate of convergence at a particular point in the field ( and indeed its posterior probability distribution )",
    "can then be generated from the mcmc samples : its accuracy will be dependent on both the noise in the weak lensing data , and the assumptions of an nfw - profile component cluster .",
    "the maps in figure  [ fig : error ] suggest that , for the data quality investigated here , both the statistical and systematic parts of the error bar on a pointwise convergence estimate are likely to be in the region of 0.05 , representing a significantly greater fractional error than that due to the best - measured time delays .",
    "we have presented a new method for reconstructing the mass distribution of clusters of galaxies from weak gravitational lensing data , based on the atomic inference procedure suggested by @xcite . by investigating its performance on simulated hst acs data , we draw the following conclusions :    * perhaps as expected , the number of mass components supported by the data ( and selected via the evidence ) is typically quite small .",
    "this is a consequence of the domination of clusters by a single deep potential with a few satellite halos , combined with the paucity of information on the weak shear data . * the physical component ( posterior average ) mass maps are cleaner and more robust to the noise realisation , than those made with pixel - based methods : the natural basis set of elliptical nfw profile halos act to suppress spurious peaks and provide an accurate reconstruction .",
    "this accuracy is evident in the high - strength correlation between input map and reconstruction , that extends ( by virtue of the additional information input to the model ) to smaller angular scales than previous techniques . *",
    "the mass maps are biased towards the results of numerical simulations , incorporating our expectations of what clusters should look like . as a result",
    ", the mass sheet degeneracy is broken , and absorbed into the uncertainties associated with the maps .",
    "the accuracy of the reconstruction is partly determined by the assumption of the nfw profile for each halo , but this is an assumption that can be ranked against competing profiles using the evidence . * the necessarily non - linear method , while slow to execute , has the advantages of coping with local minima in the chi - squared surface , providing error bars on the model parameters directly , and easily accommodating additional physical constraints of an arbitrary functional form .",
    "this very last point opens the door for a more comprehensive weak plus strong lensing reconstruction strategy : the method outlined here is conceptually very clean , and consequently provides a framework within which additional constraints on the cluster mass distribution can be straightforwardly incorporated .",
    "the ( standard fortran77 and c ) code used in this and the cited work is available on request from the author .",
    "we thank mike hobson and steve gull for useful discussions on atomic inference methods , and john skilling for moreover providing his bayesys3 code ( freely available from ` http://www.inference.phy.cam.ac.uk/bayesys/ ` ) .",
    "we also thank jean - paul kneib , roger blandford for their comments and advice , patrick hudelot and farhan feroz for helping test the mcadam code , and marua brada for a careful reading of the manuscript .",
    "we are grateful for the encouragement and constructive criticism of the referee , peter schneider , that led to a much - improved piece of work .",
    "this work was supported in part by the u.s .",
    "department of energy under contract number de - ac02 - 76sf00515 ."
  ],
  "abstract_text": [
    "<S> we present a novel approach for reconstructing the projected mass distribution of clusters of galaxies from sparse and noisy weak gravitational lensing shear data . </S>",
    "<S> the reconstructions are regularised using knowledge gained from numerical simulations of clusters : trial mass distributions are constructed from @xmath0 physically - motivated components , each of which has the universal density profile and characteristic geometry observed in simulated clusters . </S>",
    "<S> the parameters of these components are assumed to be distributed _ a priori _ in the same way as they are in the simulated clusters . sampling mass distributions from </S>",
    "<S> the components parameters posterior probability density function allows estimates of the mass distribution to be generated , with error bars . </S>",
    "<S> the appropriate number of components is inferred from the data itself via the bayesian evidence , and is typically found to be small , reflecting the quality of the simulated data used in this work . </S>",
    "<S> ensemble average mass maps are found to be robust to the details of the noise realisation , and succeed in recovering the input mass distribution ( from a realistic simulated cluster ) over a wide range of scales . </S>",
    "<S> we comment on the residuals of the reconstruction and their implications , and discuss the extension of the method to include strong lensing information .    gravitational lensing  </S>",
    "<S> methods : data analysis  galaxies : clusters : general </S>"
  ]
}