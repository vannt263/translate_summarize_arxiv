{
  "article_text": [
    "the rapid urbanization becomes one of the predominant process in the human history .",
    "it arouses much interest to study cities and urban lives in the scientific communities@xcite . like many other physical systems , despite the complex underlying structure , macro statistical regularities such as power laws emerge@xcite . with the increasing ability to collect the spatial coordinate data of facilities and buildings from electronic map providers , researchers begin to study the spatial substructure of cities .",
    "it is reported in @xcite that @xmath0-function ( whose derivative gives the radial distribution function @xmath1 ) is a power function . besides , the mean - variance relationship of number of events in a series of expanding bins is also a power function .",
    "these empirical results can be embedded in a double stochastic process model when the covariance function is a power function .",
    "scientific interest in power law relations stems partly from the possibility that the power function might point to a deep origin in the dynamical process that generate the power law relation .",
    "unfortunately , the detection and characterization of power laws are complicated by the large fluctuations that occur in the tail of the distribution and by the difficulty of identifying the range over which power law behavior holds@xcite .",
    "the fact that actual physical systems are finite also hinders the test of power laws which characterize long range interactions . as @xcite points out that one should not only consider a detailed mechanism in driving dynamics , but also the extent of statistical support for a reported power law . the linear relationship on a log - log plot",
    "is clearly established for urban facilities in @xcite over more than 2 orders of magnitude , however the considered statistics @xmath0-function and mean - variance relationship only capture the statistical properties of the first two orders .",
    "they do not give a complete picture .",
    "as an illustration of the insufficiency of second - order statistics , @xcite describes a class of non - poisson processes however for which @xmath5 coincides with the poisson random process .",
    "besides , the empirical evidence from @xmath0-function is not strong enough to support the power laws . except for the power function",
    ", there are many other functions that can give good fit to @xmath6",
    ". the power law rule would be on a more solid basis if the model estimated from the first and the second order statistics fits other statistics including higher order statistics .",
    "higher order statistics can be defined in terms of the joint intensity functions for the occurrence of specified configurations of three , four , etc .",
    "interpretation would be difficult in practice since , for example , the third - order intensity functions of a stationary , isotropic process requires three arguments , the fourth - order function , five , and so on .",
    "there are several distribution functions which are easy to interpret .",
    "they can serve as additional statistics summary of spatial point process .",
    "these are @xmath2 the distribution function of inter - event distance , @xmath3 the distribution function of the distance from an arbitrary event to its nearest other event , and @xmath4 , the distribution function of the distance from an arbitrary point to its nearest event@xcite .    except these statistics ,",
    "mean - variance relationship can also serve as a statistical method to compare models .",
    "denote @xmath7 and @xmath8 as the average and variance of number of events in a series of expanding bins , respectively . as shown in @xcite , the power law rule of mean - variance relationship",
    "@xmath9 is a natural result of a double stochastic model if the @xmath0-function is given as @xmath10 . besides",
    ", their exponents are related by @xmath11 .",
    "the idea of this paper is to implement a double stochastic model which can generate random samples in resemblance to the actual point pattern of urban facilities .",
    "then we propose some other covariance functions in addition to the power function to fit the @xmath0-function .",
    "we compare these models in their capability to fit additional second order statistics such as mean - variance relationship , and other statistics beyond the first two orders , such as inter - event distribution function @xmath2 and nearest neighbor distribution functions @xmath3 and @xmath4 .",
    "a double stochastic process ( dsp ) model is introduced to model the spatial structure of urban facilities@xcite .",
    "the dsp model assumes that there are two layers of stochastic process .",
    "the first layer stochastic process is a correlated random field of density function @xmath12 , which models the inhomogeneous concentration of facilities in a city .",
    "conditional on the density , the location of urban facilities is based on a poisson process .",
    "the dsp model simulates the growth process of urban facilities in the sense that urban facilities are evolving stochastically on top of an existing structure of a city , while the city structure itself follows a separate stochastic process .    a relatively flexible and tractable construction to encompass the non - negative constraint for density processes is log - gaussian processes@xcite , i.e.",
    ", the density function is drawn from a log - gaussian random process @xmath13 .",
    "@xmath14 is assumed to be a stationery isotropic gaussian , @xmath15 .",
    "its spatial dependence is given by its covariance density @xmath16 .",
    "the first and second order statistics of @xmath14 and @xmath17 fields are related by @xmath18 = \\exp(\\mu+\\sigma^2/2)$ ] , and @xmath19 $ ] .",
    "the radial distribution function @xmath20 are related to the second order statistics of @xmath14 and @xmath21 by , @xmath22    now , we propose 3 models of the radial distribution function @xmath23 as , @xmath24 these different models of @xmath23 are hereafter referred as m1 , m2 and m3 respectively .",
    "the radial distribution function @xmath25 of m1 is actually a power function @xmath26 at large values of @xmath27 . 1",
    "is added to avoid the divergence at @xmath28 .",
    "note that for m1 @xmath29 , which is the model suggested in @xcite .",
    "note that m2 is the first order expansion of m3 @xmath30 .",
    "therefore , the covariance of both m2 and m3 are exponential function , which dies quickly as @xmath27 increases and the interaction between events are short - ranged .",
    "( a ) original locations of banks in a metropolitan area of beijing ( @xmath31 ) mapped to a ( @xmath32 ) lattice ; a random sample of the point pattern generated from the dsp when the radial distribution function @xmath23 is given by : ( b ) eq .  ( [ eq : model1 ] ) ; ( c ) eq .  ( [ eq : model2 ] ) ; ( d ) eq .  ( [ eq : model3 ] ) ]",
    "similar to @xcite , we take banks in beijing as an illustrative example .",
    "we present the original spatial data of banks in fig .  [",
    "fig : scatter](a ) .",
    "the data is constrained to the metropolitan area of beijing , which covers @xmath33 .",
    "we map the data to a @xmath34 lattice by taking a transformation of the coordinate @xmath35 of each point as @xmath36 $ ] , rounded to the nearest integer .",
    "the estimation of @xmath23 is not convenient in the spatial analysis of point patterns . knowing that @xmath37\\end{aligned}\\ ] ] where @xmath38 is the number of further events within distance @xmath27 of an arbitrary event , we estimate the models by fitting @xmath6 .    denote @xmath39 the estimator calculated from the data after edge correction is applied to the square window in our case , and @xmath40 the theoretical k - function .",
    "@xmath41 is estimated to minimize the square error @xmath42 between @xmath39 and @xmath40 .",
    "we choose 26 @xmath43s spanning from 5 to 500 units ( each unit is 16 meters ) which are separated in such a way that they are somehow uniformly distributed in log space to give more emphasis on small @xmath27s as shown in fig  [ fig:1 ] . from the figure ,",
    "all three models fit the data quite well in the large range from 100 meters to 7000 meters .",
    "there is a slight difference when @xmath44 meters as one can see from the log - log plot in the sub - window .",
    "the log - log plot shows that m1 fits slightly better than the other two models .",
    "after we fit the models to @xmath6 , we can use the parameters to run simulations .",
    "random samples can be generated with the fourier filtering method@xcite when the radial distribution function ( therefore the covariance function @xmath45 of @xmath14 filed ) is given .",
    "a random sample for each model of @xmath23 is depicted in fig .",
    "[ fig : scatter](b ) , fig .",
    "[ fig : scatter](c ) and fig.[fig : scatter](d ) respectively . by first checking the graphs with naked eyes",
    ", one may conclude that the point pattern generated by m1 matches closer to the actual pattern of banks than the other two models .",
    "rigorous statistical checks are conducted in a later section of this paper .",
    "fitting of @xmath6 by 3 models .",
    "all three models fit the data quite well in the large range from 100 meters to 7000 meters .",
    "there is a slight difference when @xmath46 meters as one can see from the log - log plot in the sub - window .",
    "the log - log plot shows that m1 fits slightly better than the other two models . ]    in fig .",
    "[ fig:1 ] , we plot the fitting results of three models in one figure .",
    "all three models are nearly indistinguishable in the large range of @xmath27 from 100 meters to 7000 meters .",
    "one can not really tell the difference in the regular plot .",
    "although the covariance function for m2 and m3 are exponential which would deviate from the power function of m1 at large values of @xmath27 , we can not reject them based on the fitting of @xmath6 given the finite size of actual physical systems .",
    "fortunately , there is slight difference when @xmath46 meters as one can see from the log - log plot in the sub - window of fig .",
    "[ fig:1 ] .",
    "the log - log plot shows that m1 fits slightly better than the other two models .",
    "we extend our analysis to include additional statistics to further test the goodness of fit of different models .",
    "the first one is the mean - variance relationship as reported in @xcite which is still the second order statistics .",
    "denote @xmath7 and @xmath8 as the average and variance of number of events in a series of expanding bins .",
    "they are shown in @xcite that the power law @xmath9 is a natural result if @xmath47 .",
    "we plot the mean - variance relationship in fig .",
    "[ fig:21](a ) , fig .",
    "[ fig:22](a ) , and fig .",
    "[ fig:23](a ) for m1 , m2 and m3 respectively .",
    "the solid line in each figure is obtained by taking average over 1,000 samples",
    ". the dashed line is obtained from the real data .",
    "we can see that m1 generates the best fit .",
    "statistical test of m1 using ( a ) mean - variance relationship ; ( b ) @xmath2 the distribution function of inter - event distance ; ( c ) @xmath3 the distribution function of the distance from an arbitrary event to the nearest other event ; and ( d ) @xmath4 , the distribution function of the distance from an arbitrary point to the nearest event . in log - log plot ( a )",
    "the solid line represents the average over 1,000 samples generated from model while the dashed line represents the real data . in qq - plot ( b ) , ( c ) and ( d ) , the solid lines represent the empirical distribution function(edf ) of the real data against the theoretic distribution function(tdf ) estimated from simulation samples ; dashed lines represent the 1st and 99th centiles of the simulated data ; dotted lines represent the median . ]     statistical test of m2 using ( a ) mean - variance relationship ; ( b ) @xmath2 the distribution function of inter - event distance ; ( c ) @xmath3 the distribution function of the distance from an arbitrary event to the nearest other event ; and ( d ) @xmath4 , the distribution function of the distance from an arbitrary point to the nearest event . in log - log plot ( a )",
    "the solid line represents the average over 1,000 samples generated from model while the dashed line represents the real data . in qq - plot ( b ) , ( c ) and ( d )",
    ", the solid lines represent the empirical distribution function(edf ) of the real data against the theoretic distribution function(tdf ) estimated from simulation samples ; dashed lines represent the 1st and 99th centiles of the simulated data ; dotted lines represent the median . ]     statistical test of m3 using ( a ) mean - variance relationship ; ( b ) @xmath2 the distribution function of inter - event distance ; ( c ) @xmath3 the distribution function of the distance from an arbitrary event to the nearest other event ; and ( d ) @xmath4 , the distribution function of the distance from an arbitrary point to the nearest event . in log - log plot ( a )",
    "the solid line represents the average over 1,000 samples generated from model while the dashed line represents the real data . in qq - plot ( b ) , ( c ) and",
    "( d ) , the solid lines represent the empirical distribution function(edf ) of the real data against the theoretic distribution function(tdf ) estimated from simulation samples ; dashed lines represent the 1st and 99th centiles of the simulated data ; dotted lines represent the median . ]",
    "the other three statistical tests are based on : @xmath2 the distribution function of inter - event distance , @xmath3 the distribution function of the distance from an arbitrary event to the nearest other event , and @xmath4 the distribution function of the distance from an arbitrary point to the nearest event@xcite . take @xmath2 as an example , conventional approach to assess the model is to use qq - plot to compare the empirical distribution functions(edf ) @xmath48 of data with the theoretical distribution function(tdf ) . in our case , it is not straightforward to compute the tdf given the complexity of double stochastic models . we therefore proceed to estimate the tdf from samples .",
    "we calculate edf s @xmath49 from each of @xmath50 independent simulations .",
    "an estimation of the tdf @xmath51 . with 1,000 samples",
    ", we can also estimate the centiles and median of the sampled edfs .",
    "if the real data can be explained by the model , it can be thought of as a random sample and therefore the edf @xmath48 of the real data should be enclosed in the envelope formed by the 1st and 99th centiles of the sampled edfs with probability 98% .",
    "we plot the edf @xmath48 against the tdf @xmath52 with solid lines in fig .",
    "[ fig:21](b ) , fig .",
    "[ fig:22](b ) , and fig .",
    "[ fig:23](b ) for m1 , m2 and m3 respectively .",
    "in addition we plot the medians of the sampled edfs against the tdf with dotted lines .",
    "note that the tdf is the mean of the sample edfs .",
    "the median of the sampled tdf is almost a straight line against the tdf in the figure , which suggests that the distribution of the sampled edfs could be somehow symmetric .",
    "the results for @xmath3 and @xmath4 are prepared similarly and plotted in sub - figure ( c ) and ( d ) .",
    "we can see from each subfigure ( b ) , @xmath48 is enclosed in 1st and 99th envelopes of the simulation data , which means that all three models pass the test .",
    "the distribution function @xmath2 of inter - event distance captures the overall characteristics of events over relative long distance .",
    "they produce similar results .",
    "however , both m2 and m3 fail the test if @xmath3 is involved .",
    "the actual data has more nearest neighbors than m2 and m3 predict at a given distance away from each event since @xmath53 is much larger than the 99th centile of the sampled edf when @xmath54 is less than 0.5 .",
    "the problem is not so severe for @xmath4 .",
    "however , @xmath55 lies close to , albeit above the 1st centile of the sample edf generated by m2 .",
    "the events generated from m2 are more closer to random than the other 2 models due to the fact that the covariance function of m2 decreases most quickly among 3 models .",
    "model 1 passes the test for @xmath4 .",
    "although it barely passes for @xmath3 , it is still the best among 3 models .",
    "the actual data is more strongly clustered than the power law predicts at small distance .",
    "small correction needs to be made to explain the small distance behaviors .",
    "we have extended out tests to include extra facilities such as pharmacy , convenient stores , and beauty salons and also to another big city chengdu located in southwestern part of china .",
    "the results are similar .",
    "the dsp model whose covariance function is a power function always produces the best fit .",
    "we present the results of two facilities in chengdu as representative examples .",
    "the original data appears to have vast distinct morphology mainly due to their different incidences in the metropolitan area of chengdu ( @xmath56 rectangular region around the center ) . the original point pattern and a sample is plotted in fig .",
    "[ fig : chengdu ] for chengdu banks and chengdu beauty salons , respectively . as one can see from the figure ,",
    "the dsp model with power covariance function can generate point patterns in good resemblance with the original data . once might notice the latent circular pattern in the real data of chengdu ( compared to the rectangular pattern in that of beijing ) , which is due to the circular city planning and road construction .",
    "it is an unnecessary detail which is not captured with the current homogeneous model .",
    "the statistical comparison is not presented since it involves too many figures , but can be given upon request .",
    "( a ) and ( c ) depict the original locations of banks and beauty salons in a metropolitan area of chengdu ( @xmath56 ) mapped to a ( @xmath32 ) lattice , respectively ; ( b ) and ( d ) depict a random sample of the corresponding point pattern of banks and beauty salon in chengdu , respectively .",
    "the sample is generated from the dsp when the radial distribution function @xmath23 is estimated as the power function eq .",
    "( [ eq : model1 ] ) . ]",
    "it is interesting to observe the power law relations in a system because they might point to a deep origin in the dynamical process that generates the power law relation .",
    "unfortunately , the detection and characterization of power laws are complicated by the large fluctuations that occur in the tail of the distribution and by the difficulty of identifying the range over which power law behavior holds .",
    "the fact that actual physical systems are finite also hinders the test of power laws which characterize long range interactions .    the linear relationship on a log - log plot",
    "is clearly established for urban facilities in @xcite over more than 2 orders of magnitude . in this paper , we implement a method to test the validity of power laws by showing that a double stochastic model whose power law covariance function is estimated from the first two orders of statistics can give the best fit to additional statistics .",
    "the statistics includes mean - variance relationship , and other statistics beyond the first two orders , such as inter - event distribution function @xmath2 and nearest neighbor distribution functions @xmath3 and @xmath4 .",
    "it should be noted that we assume that the density field @xmath57 of the double stochastic model is stationery and isotropic .",
    "this condition is violated in practice in that first the city is often developed around a center and the concentration of facilities is expected to gradually drop from the center to the outlying areas of the city , and secondly the occupation of parks and other big buildings like the forbidden city in beijing create a vacuum where no facilities can be found . despite the inadequacy , the model with only 2 parameters can still give good fit to many statistics , some of which are beyond the first two orders .",
    "we gratefully acknowledge the following financial supports : the start - up funds from sichuan university under grants no .",
    "yj201322 and no . yj201353 ; the fundamental research funds for the central universities under grants no .",
    "skyb201403 , no .",
    "skyb201404 and no .",
    ".    0 l.m.a .",
    "bettencourt , science , * 340 * , 1438 ( 2013 ) h.a .",
    "makse , s. havlin , and h.e .",
    "stanley , nature(london ) , * 377 * , 608 ( 1996 ) x. gabaix , the quarterly journal of economics , 739 ( 1999 ) .",
    "l. wu , x. yan , and j. du , phys .",
    "e , * 90 * , 062808 ( 2014 ) .",
    "a. clauset , c.r .",
    "shalizi , and m. newman , regional studies , * 51 * , 661 ( 2007 ) .",
    "stumpf , and m.a .",
    "porter , science , * 335 * , 6069 ( 2012 ) .",
    "baddeley , and b.s .",
    "silverman , biometrics , * 40 * , 1089 ( 1984 ) .",
    "diggle , _ statistical analysis of spatial and spatio - temporal point patterns _ , ( chapman and hall , london , 2013 ) j. moller , a.r .",
    "syversveen , and r.p .",
    "waagepetersen , scandinavian journal of statistics , * 25 * , 451 ( 1998 ) .",
    "h. a. makse , s. havlin , m. schwartz , and h. e. stanley , phys .",
    "e * 53 * , 5445 ( 1996 ) ."
  ],
  "abstract_text": [
    "<S> we implement a double stochastic process as the mathematical model for the spatial point patterns of urban facilities . we find that the model with power covariance function can produce the best fit not only to @xmath0 function ( whose derivative gives the radial distribution @xmath1 ) but also to additional facts of spatial point patterns . </S>",
    "<S> these facts include the mean - variance relationship of number of events in a series of expanding bins , and other statistics beyond the first two orders , such as inter - event distribution function @xmath2 and nearest neighbor distribution functions @xmath3 and @xmath4 .    </S>",
    "<S> urban facilities , double stochastic model , power law , covariance function , model check , </S>"
  ]
}