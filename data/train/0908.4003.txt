{
  "article_text": [
    "imagine an undirected , where @xmath8 , rather than @xmath9 . ]",
    "graph , described by placing graph vertices @xmath10 along the periphery of a circle in a counter - clockwise manner , and placing graph edges as chords within the circle .",
    "an _ outerplanar _",
    "graph is a graph whose circular representation is planar ; i.e. there are no crossings . an rna secondary structure , formally defined in section [ section : dsv ] ,",
    "is an outerplanar graph ( no pseudoknots ) with the property that no vertex is incident to more than one edge ( no base triples ) and that for every chord between vertices @xmath11 , there exist at least @xmath12 many vertices that are not incident to any edge ( hairpin requirement ) .",
    "rna secondary structure is equivalently defined to be a well - balanced parenthesis expression @xmath13 with dots , where if nucleotide @xmath14 is unpaired then @xmath15 , while if there is a base pair between nucleotides @xmath8 then @xmath16 and @xmath17 .",
    "this latter representation is known as the _ vienna representation _ or _",
    "dot bracket notation _ ( dbn ) .",
    "formally , a well - balanced parenthesis expression @xmath18 can be defined as follows .",
    "if @xmath19 denotes a finite alphabet , and @xmath20 , and @xmath21 is an arbitrary _ word _ , or sequence of characters drawn from @xmath19 , then @xmath22 designates the number of occurrences of @xmath23 in @xmath24 . letting @xmath25 ,",
    "a word @xmath26 is _ well - balanced _ if for all @xmath27 , @xmath28 and @xmath29 . finally ,",
    "when considering rna secondary structures , we consider instead the alphabet @xmath30 , but otherwise the definition of well - balanced expression remains unchanged .",
    "the number of well - balanced parenthesis expressions of length @xmath31 over the alphabet @xmath25 is known as the catalan number @xmath32 , while that over the alphabet @xmath33 is known as the motzkin number @xmath34 @xcite .",
    "stein and waterman @xcite computed the number @xmath35 of well - balanced parenthesis expressions in the alphabet @xmath36 , where there exist at least @xmath12 occurrences of @xmath37 between corresponding left and right parentheses @xmath38 respectively @xmath39 .",
    "it follows that @xmath35 is exactly the number of rna secondary structures on @xmath40 $ ] , where there exist at least @xmath12 unpaired bases in every hairpin loop .    in this paper",
    ", we are interested in specific classes of secondary structure : _ canonical _ and _ saturated _ structures .",
    "a secondary structure is canonical @xcite if it has no lonely ( isolated ) base pairs .",
    "a secondary structure is saturated @xcite if no base pairs can be added without violating the notion of secondary structure , formally defined in section [ section : dsv ] . in order to compute parameters like asymptotic value for number of structures , expected number of base pairs , etc . throughout this paper ,",
    "we adopt the model of stein and waterman @xcite . in this model ,",
    "any position ( nucleotide , also known as base ) can pair with any other position , and every hairpin loop must contain at least @xmath12 unpaired bases ; i.e. if @xmath11 are paired , then @xmath41 . this latter condition is due to steric constraints for rna . at the risk of additional effort , the combinatorial methods of this paper could be applied to handle the situation of most secondary structure software , which set @xmath42 .",
    "figure  [ fig : rna1 ] gives equivalent views of the secondary structure of 5s ribosomal rna with genbank accession number nc_000909 of the methane - generating archaebacterium _ methanocaldococcus jannaschii _ , as determined by comparative sequence analysis and taken from the _ 5s ribosomal rna database _",
    "@xcite located at http://rose.man.poznan.pl/5sdata/. the sequence and its secondary structure in ( vienna ) dot bracket notation are as follows :    _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ ` ugguacggcggucauagcgggggggccacacccgaacccaucccgaacucggaaguuaagccccccagcgaugccccgaguacugccaucuggcgggaaaggggcgacgccgccggccac ` + ` ( ( ( ( . ( ( ( ( ( ( ( .... ( ( ( ( ( ( ( ...... ( ( ( ( ( ( ............. ) ) ) ) .. ) ) ..... ) ) ) ) ) . ) ) ... ( ( ( ( ( ..... ( ( ( ( ( .... ) ) ) ) ) .... ) ) ) ) ) ... ) ) ) ) ) ) ) ) ) ) ) . `",
    "_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _    equivalent representations for the same secondary structure may be produced by software jviz @xcite , as depicted in figure [ fig : rna1 ] .",
    "the left panel of this figure depicts the _ circular feynman diagram _ ( i.e. outerplanar graph representation ) , the middle panel depicts the _ linear feynman diagram _ , and the right panel depicts the _ classical _ representation .",
    "this latter representation , most familiar to biologists , may also be obtained by rnaplot from the vienna rna package @xcite .              in section [ section :",
    "dsv ] , we review a combinatorial method , known as the dsv methodology and the important flajolet - odlyzko theorem , which allows one to obtain asymptotic values of taylor coefficients of analytic generating functions @xmath43 by determining the dominant singularity of @xmath44 .",
    "the description of the dsv methodology and flajolet - odlyzko theorem is not meant to be self - contained , although we very briefly describe the broad outline . for a very clear review of this method , with a number of example applications",
    ", please see @xcite or the recent monograph of flajolet and sedgewick @xcite .    in section [ section : numcanonstr ]",
    ", we compute the asymptotic number @xmath1 of canonical secondary structures , obtaining the same value obtained by hofacker , schuster and stadler @xcite by a different method , known as the bender - meir - moon method . in section [ section : expbpcanonicalstr ] we compute the expected number @xmath2 of base pairs in canonical secondary structures . in section [ section : numsatstr ]",
    ", we apply the dsv methodology to compute the asymptotic number @xmath45 of saturated structures , while in section [ section : expnumbasepairssatstr ] , we compute the expected number @xmath46 of base pairs of saturated structures . in section [ section :",
    "saturatedstemloops ] , we compute the asymptotic number @xmath5 of saturated stem - loop structures , which is substantially smaller than the number @xmath47 of ( all ) stem - loop structures , as computed by stein and waterman @xcite .    in section [ quniform distribution ] , we consider a natural stochastic process to generate random saturated structures , called in the sequel _ quasi - random saturated structures_. the stochastic process adds base pairs , one at a time , according to the uniform distribution , without violating any of the constraints of a structure .",
    "the main result of this section is that asymptotically , the expected number of base pairs in quasi - random saturated structures is @xmath48 , rather close to the expected number @xmath46 of base pairs of saturated structures .",
    "the numerical proximity of these two values suggests that stochastic greedy methods might find application in other areas of random graph theory . in section  [ conclusion ]",
    "we provide some concluding remarks . at the web site http://bioinformatics.bc.edu/clotelab/supplements/jbcbasymptotics/ ,",
    "we have placed python programs and mathematica code used in computing and checking the asymptotic number of canonical and saturated secondary structures , as well as the maple code for checking drmota s @xcite conditions to deduce the asymptotic normality of the density of states of rna structures .",
    "in this section , we describe a combinatorial method sometimes called _ dsv methodology _ , after delest , schtzenberger and viennot , which is a special case of what is called the _ symbolic method _ in combinatorics , described at length in  @xcite .",
    "see also the appendix of @xcite for a detailed presentation of this method .",
    "this method enables one to obtain information on the number of combinatorial configurations defined by finite rules , for any size .",
    "this is done by translating those rules into equations satisfied by various _ generating functions_. a second step is to extract asymptotic expansions from these equations .",
    "this is done by studying the singularities of these generating functions viewed as analytic functions .    since our goal is to derive asymptotic numbers of structures , following standard convention we define an rna secondary structure on a length @xmath31 sequence to be a set of ordered pairs @xmath49 , such that @xmath50 and the following are satisfied .    1 .",
    "_ nonexistence of pseudoknots : _ if @xmath49 and @xmath51 belong to @xmath52 , then it is not the case that @xmath53 .",
    "2 .   _ no base triples : _ if @xmath49 and @xmath54 belong to @xmath52 , then @xmath55 ; if @xmath49 and @xmath56 belong to @xmath52 , then @xmath57 .",
    "threshold requirement : _ if @xmath49 belongs to @xmath52 , then @xmath58 , where @xmath59 , generally taken to be equal to @xmath60 , is the minimum number of unpaired bases in a hairpin loop",
    "; i.e. there must be at least @xmath59 unpaired bases in a hairpin loop .",
    "note that the definition of secondary structure does not mention nucleotide identity ",
    "i.e. we do _ not _ require base - paired positions @xmath49 to be occupied by watson - crick or wobble pairs .",
    "for this reason , at times we may say that @xmath52 is a secondary structure on @xmath40 $ ] , rather than saying that @xmath52 is a structure for rna sequence of length @xmath31 .",
    "in particular , an expression such as `` the asymptotic number of structures is @xmath61 '' means that the asymptotic number of structures on @xmath40 $ ] is @xmath61 .",
    "we now proceed with basic definitions related to context - free grammars .",
    "if @xmath62 is a finite alphabet , then @xmath63 denotes the set of all finite sequences ( called _ words _ ) of characters drawn from @xmath62 .",
    "let @xmath19 be the set consisting of the symbols for left parenthesis @xmath38 , right parenthesis @xmath39 , and dot @xmath64 , used to represent a secondary structure in vienna notation .",
    "context - free _ grammar ( see , e.g. , @xcite ) for rna secondary structures is given by @xmath65 , where @xmath66 is a finite set of nonterminal symbols ( also called variables ) , @xmath67 , @xmath68 is the _",
    "start _ nonterminal , and @xmath69 is a finite set of production rules .",
    "elements of @xmath70 are usually denoted by @xmath71 , rather than @xmath72 . if rules @xmath73 , ",
    ", @xmath74 all have the same left - hand side , then this is usually abbreviated by @xmath75 .",
    "if @xmath76 and @xmath71 is a rule , then by replacing the occurrence of @xmath62 in @xmath77 we obtain @xmath78 . such a derivation in one step",
    "is denoted by @xmath79 , while the reflexive , transitive closure of @xmath80 is denoted @xmath81 .",
    "the _ language _ generated by context - free grammar @xmath82 is denoted by @xmath83 , and defined by @xmath84 for any nonterminal @xmath85 , we also write @xmath86 to denote the language generated by rules from @xmath82 when using start symbol @xmath52 .",
    "a derivation of word @xmath24 from start symbol @xmath87 using grammar @xmath82 is a _",
    "leftmost _ derivation , if each successive rule application is applied to replace the leftmost nonterminal occurring in the intermediate expression .",
    "a context - free grammar @xmath82 is _ non - ambiguous _",
    ", if there is no word @xmath88 which admits two distinct leftmost derivations .",
    "this notion is important since it is only when applied to non - ambiguous grammars that the dsv methodology leads to exact counts .    for the sake of readers unfamiliar with context - free grammars , we present some examples to illustrate the previous concepts .",
    "consider the following grammar @xmath82 , which generates the collection of well - balanced parenthesis strings , including the empty string .",
    "with as many closing parentheses as opening ones and such that when reading the word from left to right , the number of opening parentheses read is always at least as large as the number of closing parentheses .",
    "rna secondary structures can be considered to be well - balanced parenthesis strings that also contain possible occurrences of @xmath37 , and for which there exist at least @xmath59 occurrences of @xmath37 between corresponding left and right parentheses @xmath38 respectively @xmath39 . ]",
    "define @xmath89 , where the set @xmath66 of variables ( also known as nonterminals ) is @xmath90 , the set @xmath19 of terminals is @xmath91 , where @xmath52 is the start symbol , and where the set @xmath92 of rules is given by @xmath93 here @xmath94 denotes the empty string .",
    "we claim that @xmath82 is an ambiguous grammar .",
    "indeed , consider the following two leftmost derivations , where we denote the order of rule applications @xmath95 , @xmath96 , @xmath97 , by placing the rule designator under the arrow .",
    "clearly the leftmost derivation @xmath98 is distinct from the leftmost derivation @xmath99 yet both generate the same well - balanced parenthesis string .",
    "for the same reason , the grammar with rules @xmath100 generates precisely the collection of non - empty rna secondary structures , yet this grammar is ambiguous , and we would obtain an overcount by applying the dsv methodology .",
    "in contrast , the grammar whose rules are @xmath101 is easily seen to be non - ambiguous and to generate all _ non - empty _ rna secondary structures .",
    "suppose that @xmath102 is a non - ambiguous context - free grammar which generates a collection @xmath86 of objects ( e.g. canonical secondary structures ) .",
    "to this grammar is associated a generating function @xmath103 , such that the @xmath31th taylor coefficient @xmath104s(z ) = s_n$ ] represents the number of objects we wish to count . in the sequel",
    ", @xmath105 will represent the number of canonical secondary structures for rna sequences of length @xmath31 .",
    "the dsv method uses table  [ table : dsv ] in order to translate the grammar rules of @xmath70 into a system of equations for the generating functions .",
    ".translation between context - free grammars and generating functions . here , @xmath106 is a given context - free grammar , @xmath52 , @xmath107 and @xmath108 are any nonterminal symbols in @xmath66 , and @xmath109 is a terminal symbol in @xmath19 .",
    "the generating functions for the languages @xmath86 , @xmath110 , @xmath111 are respectively denoted by @xmath112 , @xmath113 , @xmath114 . [ cols= \"",
    "< , < \" , ]      in the sequel , we often compute the asymptotic value of the taylor coefficients of generating functions by first applying the dsv methodology , then using a simple corollary of a result of flajolet and odlyzko  @xcite .",
    "that corollary is restated here as the following theorem .",
    "[ thm : flajolet ] assume that @xmath112 has a singularity at @xmath115 , is analytic in the rest of the region @xmath116 , depicted in figure [ fig : flajolettriangle ] , and that as @xmath117 in @xmath118 , @xmath119 then , as @xmath120 , if @xmath121 , @xmath122    it is a consequence of table  [ table : dsv ] that the generating series of context - free grammars are algebraic ( this is the celebrated theorem of chomsky and schtzenberger  @xcite ) .",
    "in particular this implies that they have positive radius of convergence , a finite number of singularities , and their behaviour in the neighborhood of their singularities is of the type  .",
    "( see  @xcite for an extensive treatment . )",
    "a singularity of minimal modulus as in theorem  [ thm : flajolet ] is called a _ dominant singularity_.",
    "the location of the dominant singularity may be a source of difficulty .",
    "the simple case is when an explicit expression is obtained for the generating functions ; this happens for canonical secondary structures .",
    "the situation when only the system of polynomial equations is available is more involved ; we show how to deal with it in the case of saturated structures .      in bompfnewerer et al .",
    "@xcite , the notion of _ canonical secondary structure _",
    "@xmath52 is defined as a secondary structure having no _ lonely _ ( isolated ) base pairs ; i.e. formally , there are no base pairs @xmath123 for which both @xmath124 and @xmath125 . in this section ,",
    "we compute the asymptotic number of canonical secondary structures . throughout this section , secondary structure",
    "is interpreted to mean a secondary structure on an rna sequence of length @xmath31 , for which each base can pair with any other base ( not simply watson - crick and wobble pairs ) , and with minimum number @xmath59 of unpaired bases in every hairpin loop set to be @xmath126 . at the cost of working with more complex expressions , by the same method , one could analyze the case when @xmath42 , which is assumed for the software mfold @xcite and rnafold @xcite .",
    "consider the context - free grammar @xmath127 , where @xmath66 consists of nonterminals @xmath128 , @xmath19 consists of the terminals @xmath129 , @xmath52 is the start symbol and @xmath130 consists of the following rules : @xmath131 the nonterminal @xmath52 is intended to generate all _ nonempty canonical _ secondary structures . in contrast , the nonterminal @xmath92 is intended to generate all secondary structures which become canonical when surrounded by a closing set of parentheses .",
    "we prove by induction on expression length that the grammar @xmath82 is non - ambiguous and generates all nonempty canonical secondary structures .",
    "define context - free grammar @xmath132 to consist of the collection @xmath130 of rules from @xmath82 , defined above , with starting nonterminal @xmath52 , respectively .",
    "formally , @xmath133 let @xmath83 , @xmath134 denote the languages generated respectively by grammars @xmath135 . now define languages @xmath136 of _ nonempty _ secondary structures with @xmath12 by @xmath137 note that structures like @xmath138 and @xmath139 belong to @xmath140 , but not to @xmath141 , while structures like @xmath142 belong to both @xmath136 . note that any structure @xmath52 belonging to @xmath141 must be of the form @xmath143 ; indeed ,",
    "if @xmath52 were not of this form , but rather of the form either @xmath144 or @xmath145 , then by @xmath146 would have an outermost lonely pair of parentheses .",
    "@xmath147 , @xmath148 .",
    "proof of claim .",
    "clearly @xmath149 , @xmath150 , so we show the reverse inclusions by induction ; i.e. by induction on @xmath31 , we prove that @xmath151 , @xmath152 .",
    "base case : @xmath153 .",
    "clearly @xmath154 , @xmath155 .",
    "induction case : assume that the claim holds for all @xmath156 .",
    "_ subcase 1 .",
    "_ let @xmath157 be a canonical secondary structure with length @xmath158 . then either _ ( 1 ) _",
    "@xmath159 , where @xmath160 , or _ ( 2 ) _",
    "@xmath161 , where @xmath162 , or _ ( 3 )",
    "@xmath163 , where @xmath162 and @xmath164 .",
    "each of these cases corresponds to a different rule having left side @xmath52 , hence by the induction hypothesis , it follows that @xmath165 .",
    "_ subcase 2 .",
    "_ let @xmath166 be a secondary structure with length @xmath167 , for which @xmath168 is canonical .",
    "if @xmath157 were of the form @xmath169 or @xmath170 , then @xmath168 would not be canonical , since its outermost parenthesis pair would be a lonely pair .",
    "thus @xmath157 is of the form @xmath171 , where either _ ( 1 ) _",
    "@xmath172 begins with @xmath37 , or _ ( 2 ) _",
    "@xmath172 is of the form @xmath173 , where @xmath174 is not canonical , but @xmath173 becomes canonical , or _ ( 3 ) _",
    "@xmath172 is of the form @xmath173 , where @xmath174 is canonical and @xmath173 is canonical as well .    in case _ ( 1 ) _ , @xmath172 is either @xmath37 or @xmath175 , where @xmath174 is canonical . in case _ ( 2 ) _ , @xmath172 is of the form @xmath173 , where @xmath174 must have the property that @xmath173 is canonical . in case _ ( 3 ) _",
    ", @xmath172 is of the form @xmath176 , where it must be that @xmath173 is canonical and @xmath177 is canonical . by applying corresponding rules and the induction hypothesis",
    ", it follows that @xmath178 .",
    "it now follows by induction that @xmath147 , @xmath148 . a similar proof by induction shows that the grammar @xmath82 is non - ambiguous .",
    "now , let @xmath105 denote the number of canonical secondary structures on a length @xmath31 rna sequence .",
    "then @xmath105 is the @xmath31th taylor coefficient of the generating function @xmath179 , denoted by @xmath180s(z)$ ] .",
    "similarly , let @xmath181 be the generating function for the number of secondary structures on @xmath40 $ ] with @xmath12 , which become canonical when surrounded by a closing set of parentheses",
    ".    by table  [ table : dsv ] , the non - ambiguous grammar ( [ grammar : canonicalstr ] ) gives the following equations @xmath182 which can be solved explicitly ( solve the second equation for  @xmath92 and inject this in the first equation ) : @xmath183 and @xmath184 where @xmath185 when evaluated at @xmath186 , equation ( [ eqn:2 ] ) gives  @xmath187 .",
    "since  @xmath112 is known to be analytic at  0 , we conclude that @xmath112 is given by  .",
    "the square root function @xmath188 has a singularity at @xmath186 , so we are led to investigate the roots of @xmath189 .",
    "a numerical computation with mathematica  gives the 10 roots @xmath190 , @xmath191 , @xmath192 , @xmath193 , @xmath194 , @xmath195 , @xmath196 , @xmath197 , @xmath198 , @xmath199 .",
    "it follows that @xmath200 is the root of @xmath189 having smallest ( complex ) modulus .",
    "let @xmath201 and factor @xmath202 out of @xmath189 to obtain @xmath203 .",
    "it follows that @xmath204 where @xmath205 .",
    "this shows that @xmath206 is indeed a dominant singularity for  @xmath52 .",
    "note that for each  @xmath207 , @xmath112 and @xmath208 have the same taylor coefficient of index  @xmath31 , namely @xmath105 .",
    "now , it is a direct consequence of theorem  [ thm : flajolet ] that @xmath209 where @xmath210 and @xmath211 . plugging @xmath212 into equation ( [ eqn : derivationnumcanonstr ] ) , we derive the following theorem , first obtained by hofacker , schuster and stadler @xcite by a different method .",
    "the asymptotic number of canonical secondary structures on @xmath40 $ ] is @xmath213      in this section , we derive the expected number of base pairs in canonical secondary structures on @xmath40 $ ] .",
    "the dsv methodology is actually able to produce _ multivariate _ generating series . modifying the equations ( [ eqn : canonicalstr1],[eqn : canonicalstr2 ] ) by adding a new variable @xmath214 , intended to count the number of base pairs , we get @xmath215 this can be solved as before to yield the solution is known to be analytic at @xmath216 , we have discarded one of the two solutions as before . ]",
    "@xmath217 here , the coefficient  @xmath218 is the number of canonical secondary structures of size  @xmath31 with  @xmath219 base pairs .",
    "using a classical observation on multivariate generating functions , we recover the expected number of base pairs in a canonical secondary structure on @xmath40 $ ] using the partial derivative of @xmath220 ; indeed , @xmath221\\frac{\\partial s(z , u)}{\\partial u}(z,1)}{[z^n]s(z,1 ) } & = & \\frac{[z^n]\\left(\\sum_{i\\ge 0 } \\sum_{k\\ge 0 } s_{i , k } z^i k   u^{k-1}\\right)(z,1)}{s_{n}}\\\\ & = & \\frac{\\sum_{k\\ge 0 } s_{n , k } k } { s_{n } }   =   \\sum_{k\\ge 0 }   k \\frac{s_{n , k}}{s_n},\\end{aligned}\\ ] ] and @xmath222 is the ( uniform ) probability that a canonical secondary structure on @xmath40 $ ] has exactly @xmath219 base pairs .",
    "we compute that @xmath223 satisfies @xmath224 where @xmath225 and @xmath189 is as in  .",
    "simplification yields @xmath226      from this expression , it is clear that the dominant singularity is again located at the same  @xmath227 .",
    "a local expansion there gives @xmath228 with @xmath229 . by theorem  [ thm : flajolet ]",
    ", we obtain the asymptotic value @xmath230 plugging @xmath212 into equation ( [ eqn : flajoletexpbpcanon ] ) , we find the asymptotic value of @xmath104\\frac{\\partial s(z , u)}{\\partial u}(z,1)$ ] is @xmath231 dividing ( [ eqn : asymppartial ] ) by the asymptotic number @xmath104s(z)$ ] of canonical secondary structures , given in ( [ eqn : asymnumcanonstr ] ) , we have the following theorem .    [",
    "thm : expnumbasepairscanonstr ] the asymptotic expected number of base pairs in canonical secondary structures is @xmath2 .",
    "an rna secondary structure is _ saturated _ if it is not possible to add any base pair without violating the definition of secondary structures .",
    "if one models the folding of an rna secondary structure as a random walk on a markov chain ( i.e. by the metropolis - hastings algorithm ) , then saturated structures correspond to _ kinetic traps _",
    "with respect to the nussinov energy model @xcite .",
    "the asymptotic number of saturated structures was determined in @xcite by using a method known as bender s theorem , as rectified by meir and moon @xcite . in this section ,",
    "we apply the dsv methodology to obtain the same asymptotic limit , and in the next section we obtain the expected number of base pairs of saturated structures .",
    "consider the context - free grammar with nonterminal symbols @xmath128 , terminal symbols @xmath232 , start symbol @xmath52 and production rules @xmath233 it can be shown by induction on expression length that @xmath86 is the set of saturated structures , and @xmath234 is the set of saturated structures with no _ visible _ position ; i.e. external to every base pair @xcite . here",
    ", position @xmath14 is visible in a secondary structure @xmath107 if it is external to every base pair of @xmath107 ; i.e. for all @xmath235 , @xmath236 or @xmath237 .",
    "let @xmath238 denote the generating functions @xmath52 resp .",
    "@xmath92 , corresponding to the problems of counting number of saturated secondary structures resp .",
    "number of saturated structures having no visible positions .",
    "applying table  [ table : dsv],we are led to the equations @xmath239      by first solving   for  @xmath92 and injecting in  , we get @xmath240 which upon normalizing gives a polynomial equation of the third degree @xmath241 unlike earlier work in this paper , direct solution of this equation by cardano s formulas gives expressions that are difficult to handle .",
    "instead , we locate the singularity by appealing to general techniques for implicit generating functions  @xcite .    by the implicit function theorem , singularities of @xmath242 only occur when both @xmath243 and its partial derivative @xmath244 vanish simultaneously .",
    "the common roots of @xmath243 and @xmath245 can be located by eliminating  @xmath52 between those two equations , for instance using the classical theory of _ resultants _ ( see , e.g. , @xcite ) .",
    "this gives a polynomial @xmath246 that vanishes at all  @xmath247 such that  @xmath248 is a common root of  @xmath243 and  @xmath245 .",
    "numerical computation of the roots of @xmath249 yields @xmath216 , @xmath250 , @xmath251 , @xmath252 , @xmath253 , @xmath254 , @xmath255 , @xmath256 .",
    "a subtle difficulty now lies in selecting among those points the dominant singularity of the analytic continuation of the solution  @xmath52 of   corresponding to the combinatorial problem .",
    "indeed , it is possible that one solution of   is singular at a given  @xmath257 without the solution of interest being singular there .",
    "considering such a singularity would result in an asymptotic expansion that is wrong by an exponential factor .",
    "one way to select the correct singularity is to apply a result by meir and moon  @xcite to equation  .",
    "this results in a variant of the computation in  @xcite .    instead , we use pringsheim s theorem ( see , e.g. , @xcite ) .",
    "if @xmath112 has a series expansion at  0 that has nonnegative coefficients and a radius of convergence  @xmath92 , then the point @xmath258 is a singularity of  @xmath112 .",
    "in our example , there are only two possible real positive singularities , @xmath255 and @xmath256 .",
    "the latter can not be dominant , since it would lead to asymptotics of the form  @xmath259 , i.e. , an exponentially decreasing number of structures .",
    "thus the dominant singularity is at @xmath260 .",
    "since the moduli of the non - real roots of  @xmath249 is @xmath261 , the conditions of theorem  [ thm : flajolet ] hold , provided the function behaves as required as  @xmath262 .",
    "we now compute the local expansion of  @xmath112 at  @xmath206 . from equation ( [ eqn : p_s ] )",
    ", we have that @xmath263 whose ( numerical approximations of ) roots are the double root @xmath264 and single root @xmath265 .",
    "it is easily checked that @xmath266 is the only root of equation ( [ eqn : prhos ] ) in which @xmath267 is increasing ; thus we let @xmath268 .",
    "recall taylor s theorem in two variables @xmath269 we now expand @xmath242 at @xmath270 and @xmath271 and invert this expansion .",
    "this yields @xmath272 where the dots indicate terms of higher order .",
    "the first two terms are @xmath216 , so by denoting @xmath273 and @xmath274 , we have @xmath275 isolating  @xmath276 we get @xmath277 since @xmath104s(z)$ ] is the number of saturated secondary structures on @xmath40 $ ] and the taylor coefficients in the expansion of @xmath278 are negative , we discard the positive root and thus obtain @xmath279 we now make use of theorem [ thm : flajolet ] as before and recover the following result , proved earlier in @xcite by the bender - meir - moon method .",
    "[ thm : numsatstr ] the asymptotic number of saturated structures is @xmath280 .      in this section , we compute the expected number of base pairs of saturated structures , proceeding as in section  [ section : expbpcanonicalstr ] by first modifying the equations to obtain bivariate generating functions and then differentiating with respect to the new variable and evaluating at  1 to obtain the asymptotic expectation .",
    "we first modify equations ( [ eqn : grammarruless],[eqn : grammarrulesr ] ) by introducing the auxiliary variable @xmath214 , responsible for counting the number of base pairs : @xmath281    solving the second equation for  @xmath92 and injecting into the first one gives @xmath282      we are interested in the coefficients of  @xmath283 at  @xmath284 . differentiating   with respect to  @xmath214 gives @xmath285 using equation ( [ eqn : expansions ] ) , we replace @xmath286 by @xmath287 in this equation to obtain @xmath288 and finally    @xmath289    applying theorem  [ thm : flajolet ] to equation ( [ eqn : numeratorexpectednumbasepairsinsatstr ] ) gives @xmath290 \\frac{\\partial s}{\\partial u}(z,1 )   \\sim \\frac{0.642305}{\\gamma(1/2 ) } \\cdot n^{-1/2 }   = 0.362417 \\cdot n^{-1/2}.\\end{aligned}\\ ] ] it follows that the asymptotic expected number of base pairs in saturated structures on @xmath40 $ ] is @xmath221\\frac{\\partial s(z , u)}{\\partial u}(z,1)}{[z^n]s(z,1 ) }    \\sim \\frac { 0.362417 \\cdot   n^{-1/2 } \\cdot \\rho^{-n } } { 1.07427 \\cdot n^{-3/2 } \\cdot \\rho^{-n } }   = 0.337361   \\cdot   n\\end{aligned}\\ ] ] we have just proved the following .",
    "[ thm : expectednumbasepairsinsatstr ] the asymptotic expected number of base pairs for saturated structures is @xmath46 .    since the taylor coefficient @xmath218 of generating function @xmath291 is equal to the number of saturated structures having @xmath219 base pairs , it is possible that the methods of this section will suffice to solve the following open problem .    clearly , the maximum number of base pairs in a saturated structure on @xmath40 $ ] where @xmath12 is @xmath292 . for fixed values of @xmath219 ,",
    "what is the asymptotic number @xmath293 of saturated secondary structures having exactly @xmath219 base pairs fewer than the maximum ?",
    "note that in @xcite , we solved this problem for @xmath294 .    a related interesting question concerns whether the number of secondary structures @xmath218 having @xmath219 base pairs is approximately gaussian .",
    "as first suggested by y. ponty ( personal communication ) , this is indeed the case .",
    "more formally , consider for fixed @xmath31 the the finite distribution @xmath295 , where @xmath296 and @xmath297 . in the nussinov energy model ,",
    "the energy of a secondary structure with @xmath219 base pairs is @xmath298 , so the distribution @xmath299 is what is usually called the _ density of states _ in physical chemistry .",
    "it follows from theorem 1 of of drmota @xcite ( see also @xcite ) that @xmath299 is gaussian .",
    "similarly , it follows from theorem 1 of drmota that the asymptotic distribution of density of states of both canonical and saturated structures is gaussian .",
    "details of a maple session applying drmota s theorem to saturated structures appears in the web supplement http://bioinformatics.bc.edu / clotelab / supplements / jbcbasymptotics/.      define a _",
    "stem - loop _ to be a secondary structure @xmath52 having a unique base pair @xmath300 , for which all other base pairs @xmath123 satisfy the relation @xmath301 . in this case",
    ", @xmath302 defines a hairpin , and the remaining base pairs , as well as possible internal loops and bulges , constitute the stem .",
    "we have the following simple result due to stein and waterman @xcite .",
    "there are @xmath47 stem - loop structures . here",
    "we use the more proper term _",
    "stem - loop_. ] on @xmath40 $ ] .",
    "let @xmath303 denote the number of secondary structures with _ at most _ one loop on @xmath304 .",
    "then @xmath305 .",
    "there are two cases to consider for @xmath306 .",
    "if @xmath307 does not form a base pair , then we have a contribution of @xmath303 .",
    "@xmath307 forms a base pair with some @xmath308 . in this case , since only one hairpin loop is allowed , there is no base - pairing for the subsequence @xmath309 , and hence if @xmath307 base - pairs with @xmath310 , then we have a contribution of @xmath311 .",
    "hence @xmath312 and hence @xmath313 , @xmath314 , @xmath315 , and from there @xmath316 by induction .",
    "we now compute the asymptotic number of _ saturated _ stem - loop structures .",
    "let @xmath317 be the number of saturated stem - loops on @xmath40 $ ] , defined by @xmath318 for @xmath319 , @xmath320 , and @xmath321 for @xmath322 .",
    "note that we have defined @xmath323 for notational ease in the sequel , although there are in fact no stem - loops of size @xmath126 or @xmath324 . indeed in this case , the only structures of size @xmath126 respectively @xmath324 are @xmath37 and @xmath325 .    the first few terms in the sequence @xmath326 are @xmath126 , @xmath126 , @xmath126 , @xmath60 , @xmath327 , @xmath328 , @xmath329 , @xmath330 , @xmath331 , @xmath332 , @xmath333 , @xmath334 , @xmath335 , @xmath336 , @xmath337 , @xmath338 , @xmath339 , @xmath340 , @xmath341 , @xmath342 ; for instance , @xmath343 .",
    "it is easily seen that the following rules @xmath344 provide for a non - ambiguous context - free grammar to generate all non - empty saturated stem - loops .",
    "it defines actually a special kind of context - free language , called regular , whose generating function is rational .      by the dsv methodology",
    ", we obtain the functional relation @xmath345 whose solution is the rational function @xmath346 where @xmath347 and @xmath348 .      for rational functions ,",
    "an easy way to compute the asymptotic behaviour of the taylor coefficients is to compute a partial fraction decomposition and isolate the dominant part .",
    "this is equivalent to solving the corresponding linear recurrence .",
    "see also  @xcite or ( * ? ? ?",
    "partial fraction decomposition yields @xmath349 where the  @xmath350s are the roots of  @xmath249 and @xmath351 .",
    "it follows by extracting coefficients that @xmath352 ( note that this is an actual equality valid for all @xmath353 and not an asymptotic result ) .",
    "now , the roots of  @xmath249 are approximately @xmath354 since @xmath355 , it follows that the asymptotic behaviour is given by the term in  @xmath356 .",
    "we have proved the following theorem .",
    "[ thm : numbercanonicalstemloops ] the number @xmath317 of saturated stem - loops on @xmath40 $ ] satisfies @xmath357    convergence of the asymptotic limit in equation ( [ eqn : closedformnumsatstemloops ] ) is exponentially fast , so that when @xmath358 , @xmath359 , while the exact number of saturated stem - loops on @xmath360 $ ] is @xmath343 .",
    "in this section , we define a stochastic greedy process to generate _ random _ saturated structures , technically denoted _ quasi - random saturated structures_. our main result is that the expected number of base pairs in quasi - random saturated structures is @xmath361 , just slightly more than the expected number @xmath4 of all saturated structures .",
    "this suggests that the introduction of stochastic greedy algorithms and their asymptotic analysis may prove useful in other areas of random graph theory .",
    "consider the following stochastic process to generate a saturated structure .",
    "suppose that @xmath31 bases are arranged in sequential order on a line .",
    "select the base pair @xmath362 by choosing @xmath214 , where @xmath363 , at random with probability @xmath364 .",
    "is base - paired by selecting a random base @xmath214 such there are at least @xmath59 unpaired bases enclosed between @xmath126 and @xmath214.,width=377 ]    the base pair joining @xmath126 and @xmath214 partitions the line into two parts .",
    "the left region has @xmath219 bases strictly between @xmath126 and @xmath214 , where @xmath365 , and the right region contains the remaining @xmath366 bases properly contained within endpoints @xmath367 and @xmath31 ( see figure  [ line ] ) .",
    "proceed recursively on each of the two parts .",
    "observe that the secondary structures produced by our stochastic process will always base pair with the leftmost available base , and that the resulting structure is always saturated .    before proceeding further",
    ", we note that the probability that the probability @xmath368 that @xmath49 is a base pair in a saturated structure is _ not _ the same as the probability @xmath369 that @xmath49 is a base pair in a quasi - random saturated structure . indeed , if we consider saturated and quasi - random saturated structures on an rna sequence of length @xmath370 , then clearly @xmath371 while clearly @xmath372 .. clearly @xmath373 , where @xmath374 denotes the number of saturated structures on an rna sequence of length @xmath219 .",
    "a computation from a python program ( see web supplement ) shows that @xmath375 , @xmath376 and @xmath377 , hence @xmath378 . ] despite the very different base pairing probabilities when comparing saturated with quasi - random saturated structures , it is remarkable that the expected number of base pairs over saturated and quasi - random saturated structures is numerically so close .",
    "let @xmath379 be the expected number of base pairs of the saturated secondary structure generated by this recursive procedure .",
    "in general , we have the following recursive equation @xmath380 with initial conditions @xmath381 if we write equation ( [ qeq3b ] ) for @xmath382 and substitute in it the value for @xmath383 we derive @xmath384 if we multiply out by @xmath385 and simplify we obtain @xmath386 which is valid for @xmath387 .",
    "we now look at asymptotics . in particular",
    "we prove the following result .",
    "[ qgen : thm ] let @xmath388 denote the expected number of base pairs for quasi - random saturated structures of an rna sequence of length @xmath31 . then for fixed  @xmath59 , and as @xmath389 @xmath390 where @xmath391 is the @xmath392th harmonic number .    the first few values can easily be obtained numerically and we have @xmath393    for fixed integer  @xmath59",
    ", the recurrence   is linear with polynomial coefficients .",
    "it is a classical result that the generating functions of solutions of such recurrences satisfy linear differential equations .",
    "this is obtained by applying the following rules : if @xmath394 , then @xmath395 starting from  , we first shift the index by  @xmath396 and apply these rules together with the initial conditions   to get @xmath397 finally , this simplifies to    @xmath398    this is a first order non - homogeneous linear differential equation .",
    "the homogeneous part @xmath399 is solved by integrating a partial fraction decomposition @xmath400 from there , variation of the constant gives the following expression for the generating function : @xmath401 because the exponential is an entire function , we readily find that the only singularity is at  @xmath402 , where @xmath403 with @xmath404 as in the statement of the theorem . the proof is completed by the use of theorem  [ thm : flajolet ] .",
    "note that the asymptotic expected number of base pairs in quasi - random saturated structures with @xmath12 is @xmath7 , while by theorem [ thm : expectednumbasepairsinsatstr ] the asymptotic expected number of base pairs in saturated structures is @xmath4 , just very slightly less .",
    "this result points out that the stochastic greedy method performs reasonably well in sampling saturated structures , although the stochastic process tends not to sample certain ( rare ) saturated structures having a less than average number of base pairs .",
    "the stochastic process used to construct quasi - random saturated structures iteratively base - pairs the leftmost position in each subinterval .",
    "one can imaging a more general stochastic method of constructing saturated structures , described as follows .",
    "generate an initial list @xmath405 of all allowable base pairs @xmath49 with @xmath406 and @xmath407 .",
    "create a saturated structure by repeately picking a base pair from @xmath405 , adding it to an initially empty structure @xmath52 , then removing from @xmath405 all base pairs that form a crossing ( pseudoknot ) with the base pair just selected .",
    "this ensures that the next time a base pair from @xmath405 , it can be added to @xmath52 without violating the definition of secondary structure .",
    "iterate this procedure until @xmath405 is empty to form the stochastic saturated structure @xmath52 .    taking an average over 100 repetitions",
    ", we have computed the average number of base pairs and the standard deviation for @xmath408 .",
    "results are @xmath409 , @xmath410 for @xmath370 , @xmath411 , @xmath412 for @xmath413 and @xmath414 , @xmath415 for @xmath416 .",
    "this clearly is a different stochastic process than that used for quasi - random saturated structures .",
    "in this paper we applied the dsv methodology and the flajolet - odlyzko theorem to asymptotic enumeration problems concerning canonical and saturated secondary structures .",
    "for instance , we showed that the expected number of base pairs in canonical rna secondary structures is equal to @xmath2 , which is far less than the expected number @xmath417 of base pairs over all secondary structures , the latter which follows from theorem 4.19 of @xcite .",
    "this may provide a theoretical explanation for the speed - up observed for vienna rna package when restricted to canonical structures @xcite .    additionally , we computed the asymptotic number @xmath3 of saturated structures , the expected number @xmath4 of base pairs of saturated structures and the asymptotic number @xmath5 of saturated stem - loop structures .",
    "we then considered a natural stochastic greedy process to generate quasi - random saturated structures , and showed surprisingly that the expected number of base pairs of is @xmath7 , a value very close to the expected number @xmath4 of base pairs of all saturated structures .",
    "finally , we apply a theorem of drmota @xcite to show that the density of states for [ all resp .",
    "canonical resp .",
    "saturated ] secondary structures is asymptotically gaussian .",
    "we would like to thank yann ponty , for suggesting that drmota s work can be used to prove that the density of states for secondary structures is gaussian .",
    "thanks as well to two anonymous referees , whose comments led to important improvements in this paper .",
    "figure [ fig : flajolettriangle ] is due to w.a .",
    "lorenz , and first appeared in the joint article lorenz et al .",
    "@xcite .",
    "funding for the research of p. clote was generously provided by the foundation digiteo - triangle de la physique and the national science foundation dbi-0543506 and dms-0817971 .",
    "additional support is gratefully acknowledged to the deutscher akademischer austauschdienst for a visit to martin vingron s group in the max planck institute of molecular genetics .",
    "any opinions , findings , and conclusions or recommendations expressed in this material are those of the authors and do not necessarily reflect the views of the national science foundation .",
    "funding for the research of e. kranakis was generously provided by the natural sciences and engineering research council of canada ( nserc ) and mathematics of information technology and complex systems ( mitacs ) .",
    "funding for the research of b. salvy was provided by microsoft research - inria joint centre .",
    "a.  f. bompfunewerer , r.  backofen , s.  h. bernhart , j.  hertel , i.  l. hofacker , p.  f. stadler , and s.  will .",
    "variations on rna folding and alignment : lessons from benasque .",
    ", 56(1 - 2):129144 , january 2008 .",
    "n.  chomsky and m.  p. schtzenberger . the algebraic theory of context - free languages . in p.",
    "braffort and d.  hirschberg , editors , _ computer programing and formal languages _ , pages 118161 .",
    "north holland , 1963 .",
    "m.  zuker .",
    "folding prediction : the continued need for interaction between biologists and mathematicians . in _",
    "lectures on mathematics in the life sciences _ , volume  17 , pages 87124 .",
    "springer - verlage , 1986 ."
  ],
  "abstract_text": [
    "<S> it is a classical result of stein and waterman that the asymptotic number of rna secondary structures is @xmath0 . in this paper </S>",
    "<S> , we study combinatorial asymptotics for two special subclasses of rna secondary structures  _ canonical _ and _ saturated _ structures . </S>",
    "<S> canonical secondary structures are defined to have no lonely ( isolated ) base pairs . </S>",
    "<S> this class of secondary structures was introduced by bompfnewerer et al . , who noted that the run time of vienna rna package is substantially reduced when restricting computations to canonical structures . </S>",
    "<S> here we provide an explanation for the speed - up , by proving that the asymptotic number of canonical rna secondary structures is @xmath1 and that the expected number of base pairs in a canonical secondary structure is @xmath2 . </S>",
    "<S> the asymptotic number of canonical secondary structures was obtained much earlier by hofacker , schuster and stadler using a different method .    </S>",
    "<S> saturated secondary structures have the property that no base pairs can be added without violating the definition of secondary structure ( i.e. introducing a pseudoknot or base triple ) . here </S>",
    "<S> we show that the asymptotic number of saturated structures is @xmath3 , the asymptotic expected number of base pairs is @xmath4 , and the asymptotic number of saturated stem - loop structures is @xmath5 , in contrast to the number @xmath6 of ( arbitrary ) stem - loop structures as classically computed by stein and waterman . finally , we apply work of drmota @xcite to show that the density of states for [ all resp . </S>",
    "<S> canonical resp . </S>",
    "<S> saturated ] secondary structures is asymptotically gaussian . </S>",
    "<S> we introduce a stochastic greedy method to sample random saturated structures , called _ quasi - random saturated structures _ , and show that the expected number of base pairs of is @xmath7 . </S>"
  ]
}