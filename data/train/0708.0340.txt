{
  "article_text": [
    "after forty years of studies and applications it is now clear that the density functional theory ( dft )   constitutes a formidable tool for the understanding of the matter .",
    "nowadays , dft - based total energy calculations   and car - parrinello molecular dynamics simulations  @xcite are used in a growing number of scientific fields , ranging from physics to chemistry to biology .",
    "the reason of such an ubiquitous fortune is that these methods are _ ab initio _",
    ", in the sense that the only underlying models are the fundamental interactions laws and quantum mechanics .",
    "however , just because of their _ ab initio _ nature , dft - based methods generally require large computational resources . in spite of the availability of faster and faster computers , this circumstance sets up the limitations to the applicability of the same methods .",
    "most dft implementations are based on the kohn - sham scheme   and require the solution for the wave - functions of the appropriate kohn - sham schroedinger equation .",
    "this usually implies the orthogonalization or the inversion of large matrices and , hence , a number of operations scaling , in principle , as @xmath1 , where n is the number of atoms in the system .",
    "while for semiconductors or insulators , the wave - functions localization quite naturally leads to sparse problems , the case of metals appears to be the most challenging . for metallic systems , in fact , the computational effort required by wave - functions based approaches remains @xmath2 .",
    "nevertheless , even for metals , approaches based on the direct minimization of the hohenberg - kohn functional wrt . the charge density   could achieve @xmath0 scaling . in this case , the basic strategy consists in partitioning the system under consideration in a collection of weakly interacting fragments  @xcite .",
    "even with nowadays computers , the scaling properties of dft algorithms wrt .",
    "the size of the system remain a crucial issue since they determine which classes of phenomena can be studied by _",
    "ab initio _ methods .    among dft implementations ,",
    "the oldest methods using such a _ divide and conquer _ strategy for metallic systems are perhaps the self - consistent versions of the korringa  @xcite , kohn and rostoker multiple scattering theory ( mst ) .",
    "the mst method  @xcite views the system under consideration as a collection of fragments ( usually in a one to one correspondence to lattice sites ) whose scattering properties are determined by solving a kohn - sham schroedinger equation . once the fragment ( or single - site ) scattering matrices are determined , they are assembled together with the free electron propagator in order to obtain the scattering matrix , or , equivalently , the green s function of the system .",
    "both the determination of the fragment scattering matrices and the potential reconstruction are @xmath0 , while , in principle , the solution for the global scattering matrix is an @xmath2 problem , as it corresponds to the determination of the appropriate boundary conditions for the wave - functions in each fragment . however , a number of algorithms have been devised  @xcite that are able to obtain @xmath0 scaling by mapping the determination of the system s green function in a sparse problem .",
    "this is usually obtained by assuming zero the electronic propagator outside the so called local interaction zone ( liz ) of each fragment .",
    "if the free electrons propagator is used , about ten neighbors shells should be included in the liz  @xcite , while using screened propagators  @xcite allows to have much smaller liz s : typically one or two neighbors shells@xcite are sufficient .",
    "another remarkable feature of the mst method is that , being based on green functions rather than on wave - functions , it can deal easily with disordered systems and ensemble statistical averages .",
    "for this reason , since many years , the coherent potential approximation ( cpa ) theory  @xcite for disordered alloys has been used in conjuction with the mst  @xcite and the dft  @xcite .",
    "the present paper shall be concerned with the study of metallic alloys in which the nuclei are assumed to occupy the positions of an ordered lattice , while substitutional disorder may be permitted . for these systems , in spite of the apparent complexity of the dft algorithmic implementations , the analysis of large supercell calculations has allowed for the identification of remarkably simple trends .",
    "namely , the charge excesses associated with each lattice site appear to be linear functions of the electrostatic potentials at the same site  @xcite .",
    "these simple relationships , to be referred in the following to as to the qv laws , allow to describe the atoms of each chemical species in an extended metallic system in terms of two parameters , say , the slope and the intercept of the above linear functions@xcite , and appear to be the appropriate generalization of pauling s concept of electronegativity  @xcite to solid state physics .",
    "we have already suggested that the qv laws can lead to important simplifications for total energy calculations in metallic alloys  @xcite . in the present paper , we shall introduce the class of the generalized cpa s ( gcpa ) for dealing both with ordered and disordered metallic alloys . from the computational point of view ,",
    "gcpa schemes present @xmath0 scaling .",
    "their principal virtue , however , is that , as we shall demonstrate , the gcpa functional _ exactly _ reduces to a _ function _ of the relevant charge multipole moments at the various lattice sites , thus constituting a _ coarse grained _ approximate version of the original dft . at a further level of approximation , the gcpa density",
    "functional leads to a ginzburg - landau functional , the charge excesses functional ( cef )  @xcite , which is equivalent to the above linear qv laws and computationally inexpensive .",
    "the predictions of the gcpa and the cef about the qv laws and total energies shall be compared vs. full - potential linearized augmented plane waves ( lapw ) calculations  @xcite for 62 ordered crystal structures  @xcite .",
    "our conclusions shall be that , at least for the systems considered , both gcpa and cef are generally able to find out correctly the system ground state and to fairly well reproduce the energy differences between ordered structures in a fixed concentration ensemble .",
    "the following of this paper is organized as follows . in sect .",
    "ii we shall briefly review the mst version of the dft . in order to have a functional form as much localized as possible , the relevant electrostratic contributions shall be rewritten using an exact multipole expansion . in sect .",
    "iii , we shall introduce the class of the gcpa theories and investigate the analytical properties of the corresponding approximate density functional .",
    "moreover we shall obtain , as a further approximation to the gcpa , the cef theory , already obtained in a much more phenomenological context  @xcite , that here is offered in a generalized form suitable for the inclusion of dipole or quadrupole interactions . in sect .",
    "iv we shall compare the numerical results obtained from the gcpa and cef approximations with those from full - potential lapw calculations .",
    "cef and gcpa calculations appear _ numerically indistinguishable _",
    "one from the other and both theories appear able to fairly well reproduce the lapw total energies . in the final sect .",
    "v , we shall draw our conclusions , make our comments and briefly discuss the possible developments of cef and gcpa theories .",
    "in this subsection we shall briefly overview the grand canonical ensemble formulation of the mst - dft  .",
    "our aim shall be developing a common ground for dealing both with ordered and substitutionally disordered systems .",
    "although finite temperature , relativistic and magnetic generalizations could straightforwardly be carried out  , in this paper we focus on the non - relativistic , non spin - polarized case at @xmath3 .",
    "furthermore , when not otherwise stated , we shall consider the local density approximation ( lda )   to the dft and assume to have ions of charge @xmath4 fixed at the lattice positions @xmath5 .    in our discussion , the relevant density",
    "functional is the electronic grand potential  @xcite , @xmath6 where @xmath7 is the volume of the system , @xmath8 is the chemical potential and @xmath9 is the sum of the total electronic energy and the nuclei electrostatic interaction .",
    "@xmath10 is the integrated density of states which is related to to the electronic density of states ( dos ) , @xmath11 , through the following relationship : @xmath12 the notation highlights the implicit @xmath8 dependence of the dos that arises from the effective kohn - sham potential . in a frozen ions treatment , of course",
    ", the nuclear interactions term is just a constant that is included here for future convenience .",
    "the basic idea underlying the mst is partitioning the system in small scattering volumes , @xmath13 , @xmath14 , which in most implementations are centred at the nuclei positions .",
    "although at this stage the partitioning is quite arbitrary , as we shall see in the following , there is a natural choice for it . using the lloyd s formula  @xcite ,",
    "the integrated dos , @xmath10 , can be expressed as the excess with respect to the corresponding free electrons quantity , @xmath15 : @xmath16 where the trace is taken only over the angular momentum components . in eq .",
    "( [ lloyd1 ] ) the multiple scattering matrix , @xmath17 , or the scattering - path matrix  , @xmath18 are defined in terms of the single - site scattering matrices , , @xmath19 , @xmath20 , site components by small latin letters , @xmath21 . ]",
    "@xmath22 , and the free electron propagator , @xmath23 , is given by : @xmath24 it is convenient to recall here that the single - site scattering matrices convey the informations about the phase shifts at the surfaces delimiting each scattering volume .",
    "the continuity of the wave - functions at the same surfaces is ensured by the construction of the scattering - path matrix , @xmath25 , this is accomplished by the numerical inversion of the multiple scattering matrix @xmath17 . since the size of @xmath17 is proportional to the number of scatterers in the problem , its inversion is the source of @xmath2 scaling in the mst version of the dft .    within mst the link between the electronic density and the scattering matrices",
    "is provided by the green function  @xcite @xmath26 \\delta_{l l^\\prime } \\delta_{i j }   \\end{aligned}\\ ] ] where @xmath27 , @xmath28 .",
    "@xmath29 and @xmath30 are , respectively , the regular and irregular at @xmath31 solutions stands for @xmath32 with @xmath27 .",
    "] of the ks schroedinger equation for the energy @xmath33 . for real energies",
    "both @xmath29 and @xmath30 are real functions .",
    "the ( site resolved ) charge densities , the dos and the neat charges at the @xmath34-th site can be obtained by integrating the green function over the energy and/or the appropriate volumes and by taking the trace over the angular momentum indexes as follows : @xmath35 @xmath36 .    as it is shown in refs .",
    ", , , the hohenberg - kohn density functional , eq .",
    "( [ gpotnmu ] ) , can be more conveniently rewritten within the mst formalism as the sum of a kinetic and a potential energy functionals , as follows : @xmath37 where the above two contributions are given by the following expressions : @xmath38 @xmath39 ) + \\frac{e^2}{2}\\sum_{ij \\ ; ( i \\neq j ) } \\frac{z_i z_j}{r_{ij}}\\end{aligned}\\ ] ]    the effective potential in eq .",
    "( [ ti ] ) , @xmath40 , is specified by the kohn - sham equation , @xmath41)\\end{aligned}\\ ] ] it consists of the coulombian potential due to the electronic and ionic charges and of the exchange - correlation potential , @xmath42)=\\delta e^{xc}[\\rho ] / \\delta \\rho(\\mathbf{r})$ ] , where @xmath43 $ ] is the third term on the rhs of eq .  ( [ ualt ] ) . in the local density approximation ( lda )",
    "@xmath44 is assumed to depend locally on the electronic density , i.e. , @xmath42)=v^{xc}(\\rho(\\mathbf{r}))$ ] and @xmath45)=e^{xc}(\\rho(\\mathbf{r}))$ ] .",
    "we wish to highlight a useful consequence of the above partitioning of the system volume .",
    "the density functional defined by eq .",
    "( [ varform ] ) , which is , of course , variational wrt the global charge density , @xmath46 , turns out to be variational also wrt the charge densities in each scattering volume @xmath13 , in formulae , @xmath47 furthermore , it is possible to show@xcite that @xmath48 and that @xmath49    it is interesting to observe that , the expression for the site resolved dos , eq .",
    "( [ ni ] ) , allows to recast the integrated dos and the electronic grand potential as sums of site resolved contributions .",
    "these contributions , however , involve the site - diagonal part of the system green function or scattering matrix , @xmath50 , or @xmath51 , and then are non trivially coupled together through the boundary conditions .",
    "if this coupling was neglected , as it is done , for instance , in the case of the harris - foulkes density functional@xcite , @xmath0 scaling could be obtained . fortunately , similar numerical performances can be achieved with less dramatic approximations .",
    "a sensible alternative is to impose _ random _ boundary conditions at the fragments surfaces  . in this paper",
    "we shall follow a different approach and use _ averaged _ boundary conditions .",
    "as we shall see in the following section , this allows to have a tractable form for the coupling in the kinetic part of the density functional and permit to obtain @xmath0 algorithms .",
    "although it was proposed with a different aim , one of the oldest method applying such mean boundary conditions is the cpa , a generalized version of which shall be offered in the next section .",
    "before , however , we need to discuss a different source of coupling that is present in the potential energy part of the functional , namely , the electrostatic interactions between fragments . in the past",
    "this subject has received little consideration and it has been ruled out by invoking the screening properties of metals . however , nowadays there is a general consensus that careful estimates of these interactions are necessary in order to obtain accurate total energies for metallic alloys .",
    "we have shown in the previous sect .",
    "[ sectiia ] that the df - mst theory is variational wrt the local charge densities , @xmath52 , of each fragment or scattering volume . in this subsection",
    "we shall see how the multipole expansion used by most numerical implementations of the theory has the conceptual advantage of giving expressions for the effective kohn - sham potentials and the potential energy in which different scattering volumes are coupled together only through simple functions of the multipole moments .",
    "the relevant formulae can be obtained by splitting the volume integrals in eqs .",
    "( [ ualt ] ) and  ( [ effpot ] ) in sums of integrals extending over the scattering volumes , @xmath13 and by expanding the denominators in spherical harmonics .",
    "although they require some labour , the derivations are very straightforward and need not to be reported here .",
    "the resulting expressions for the potential energy and the effective potentials are listed below : @xmath53\\ ] ] and @xmath54    in eqs .",
    "( [ ualtsm ] ) and  ( [ effpotsm ] ) we have introduced the local multipole moments , @xmath55 and the madelung potentials , @xmath56 where @xmath57 the coefficients @xmath58 are given by @xmath59 @xmath60 are the gaunt numbers   and the functions @xmath61 in eq .",
    "( [ effpotsm ] ) are defined as , @xmath62 the only values that are relevant for spherical approximations are @xmath63 and @xmath64 .    in eq .",
    "( [ ualtsm ] ) , the contribution from the @xmath34-th lattice site to the potential energy is denoted as @xmath65)$ ] and given by    @xmath66 ) =   \\frac{e^2}{2}\\int_{v_i } d \\mathbf{r } \\int_{v_i } d \\mathbf{r}^\\prime \\frac{\\rho_i(\\mathbf{r } ) \\rho_i(\\mathbf{r}^\\prime ) } { |\\mathbf{r}-\\mathbf{r}^\\prime| }   - \\int_{v_i } d \\mathbf{r } \\frac{e^2 z_i \\rho_i(\\mathbf{r})}{r }    + \\int_{v_i } d \\mathbf{r } \\rho_i(\\mathbf{r } ) e^{xc}(\\rho_i(\\mathbf{r}))\\ ] ]    within the lda , @xmath67 depends on the electronic density at the @xmath34-th fragment only , while for non - local approximations to the dft there could be some dependence on the density at sites @xmath68 .    much published work has been done within spherical approximations ( sa ) , namely the muffin - tin ( mt ) or the atomic sphere approximation ( asa ) . in that case",
    "only the first terms , @xmath69 , of the multipole expansions are included .",
    "thus , eqs .",
    "( [ ualtsm ] ) and  ( [ effpotsm ] ) must be replaced by the following expressions , @xmath70)+\\frac{e^2}{2 } \\ ; q_i v^{mad}_i \\right]\\ ] ] and @xmath71    thus , for sa s , the only relevant multipole moments are the local charge excesses , @xmath72 and the madelung potentials are constant within each scattering volume to the values @xmath73    remarkably , in eqs .",
    "( [ ualtsm ] ) and  ( [ effpotsm ] ) , or in their sa counterparts , eqs .",
    "( [ ualts ] ) and  ( [ effpots ] ) , the charge densities at different sites , @xmath52 , are coupled only with the madelung potentials at the same sites , @xmath74 . of course",
    ", the last quantities contain information about the charge densities at all crystal sites .",
    ", @xmath75 .",
    "the partition of the system volume in voronoi polyhedra , marked by the lines , guarantees that the inequalities hold.,width=264 ]    we wish to highlight that the multipole expansion does not converge for arbitrary partitions of the system .",
    "actually , convergence requires that , for any pair of scattering centers , @xmath5 and @xmath76 , and for any point @xmath77 belonging to the scattering volume @xmath13 , the triangular inequality illustrated in fig .",
    "( 1 ) must be satisfied .",
    "it is easy to realize that partitioning of the system in voronoi polyhedra accordingly with the wigner - seitz construction guarantees the above condition to be fullfilled everywhere except but for the zero measure set of points constituted by the surfaces of the polyhedra , thus ensuring the convergence of the theory .",
    "the wigner - seitz construction , therefore , constitutes a natural choice for the partitioning .",
    "in this section we shall discuss a whole class of approximations for systems with atoms lying on a regular lattice , where , however , substitutional disorder is allowed for .",
    "metallic alloys , both ordered intermetallic compounds and random alloys , constitute the most relevant example of such systems .",
    "other examples are crystals with empty , or vacancy , sites .",
    "although , in general , these systems do not have translational invariance , nevertheless the underlying geometrical lattice does .",
    "forty years ago , this consideration led soven to formulate the coherent potential approximation or cpa  @xcite . since then , the cpa had an appreciable fortune .",
    "its crucial virtue was that , by introducing a mean field fashion effective crystal , it allows to use many techniques designed for ordered systems that were already well developed at the time at which the theory was proposed .    for many years",
    ", the dft implementations of the cpa   have been based on the assumption ( in the following referred to as the single - site approximation or ss ) that sites occupied by atoms of the same chemical species are characterized by the same effective kohn - sham potentials .",
    "although the dft - ss - cpa has been proved able to carefully determine the electronic structure and the spectral properties of many alloy systems  @xcite , nevertheless it leads to an incorrect description of the electrostatics and of the total energies in metallic alloys  @xcite . due to its mean field nature",
    ", in fact , the ss approximation neglects the fluctuations of the charge transfers and the energetic electrostatic contributions associated with them .",
    "this failure has stimulated many authors that envisaged cpa generalizations aimed to include the effects of different chemical environments  @xcite .    in this paper",
    "we define a _ class of approximations _ for dft - based electronic theories in which most of the above cpa generalizations can be included .",
    "we shall refer to the approximations belonging to such a class to as generalized cpa ( gcpa ) . a theory belonging to the gcpa class",
    "shall be identified by : ( a ) a theory specific _",
    "external model _ , i.e. a rule for determining the effective kohn - sham site potentials and the statistical weights @xmath78 to be assigned to each site , and ( b ) an approximate form for the kinetic part of the density functional , specified by eqs .",
    "( [ cpa0]-[cpa3 ] ) below .",
    "the last feature is common to all the theories belonging to the gcpa class .    before discussing the ansatz for the kinetic functional we wish to illustrate what a gcpa external model can be on the basis of a few examples .",
    "the first example of a gcpa theory is , of course , the dft implementation of the ss - cpa in refs .   and  .",
    "its external model is the ss assumption ( identical effective potentials for atoms of the same atomic species and weights proportional to the respective atomic concentrations ) .",
    "another example is the polymorphous cpa ( pcpa ) of ujfalussy et al .",
    "the external model is constructed using an auxiliary supercell containing @xmath79 atoms , usually hundreds or thousands , each to be weighted with the same weight .",
    "the effective site potentials are reconstructed on the same supercell via eq .",
    "( [ effpot ] ) , thus atoms of the same chemical species are allowed to have different potentials depending on their environments .",
    "this specific choice for the external model appears the reason why the pcpa theory substantially improves the alloy electrostatics while maintaining all the advantages of the standard ss - cpa about the spectral properties  @xcite .",
    "other existing cpa - based approaches like , e.g. , the non - local cpa  @xcite , or the sim - cpa  @xcite can also be considered as particular cases of gcpa s .",
    "we shall now introduce the kinetic ansatz that is common to all gcpa theories .",
    "for this purpose we prefer not to start from the definition of the functional .",
    "rather we shall follow a path closer to physical intuition and to the spirit of soven s original cpa formulation@xcite . at similarity of ss - cpa calculations",
    ", the gcpa defines an effective periodic crystal whose sites are occupied by effective coherent scatterers characterized by the single - site scattering matrix @xmath80 , the corresponding green function shall be @xmath81 . then , if we considers the green function of a single substitutional impurity with a single - site scattering matrix @xmath82 embedded in the above effective crystal , @xmath83 , the gcpa consists in requiring that @xmath84 in other words , the weighted average of the impurity green functions must be equal to the coherent green function @xmath81 . in eq .",
    "( [ cpa0 ] ) the energy dependences have been dropped for sake of simplicity and @xmath79 stands for the number of different scatterers in the model .     a pictorial illustration of the ss - cpa for a binary , a@xmath85b@xmath86 , alloy ( top ) and of the gcpa ( bottom ) .",
    "the rectangular frames have the meaning `` the green function of what is inside''.,width=264 ]    eq .",
    "( [ cpa0 ] ) is illustrated in fig .",
    "( 2 ) . in terms of the coherent scattering - path matrix of the effective lattice , @xmath87 , and of the cpa projectors , @xmath88",
    ", it can be rearranged as follows : @xmath89 @xmath90^{-1}\\ ] ]    a gcpa theory is then an approximation for the @xmath25 matrix , whose diagonal elements are given by @xmath91 while the diagonal matrix elements of the green function are given by eq .",
    "( [ greenfun ] ) with @xmath92 .    within the approximation defined by eqs .",
    "( [ cpa0]-[cpa3 ] ) above , the mst reviewed in the previous section allows to calculate the charge densities and the integrated dos , @xmath93 and , through eq .",
    "( [ ti ] ) , the kinetic part of the hohenberg - kohn functional . here",
    "we need not to trace all the intermediate steps that can be reproduced following the scheme of ref .",
    ". the gcpa approximate version of the lloyd formula , eq .",
    "( [ mkkr ] ) , is given by : @xmath94 it has the very remarkable property that the integrated dos @xmath10 and , hence , the kinetic functional are variational  @xcite wrt .",
    "both @xmath95 and @xmath87 .    in sec .",
    "ii a , we have mentioned that in the exact mst the contributions to the integrated dos associated with each lattice site and proportional to @xmath96 , are coupled together because each element of the @xmath25 matrix depends on the scattering properties of all the lattice sites . within the gcpa ,",
    "the only source of coupling is @xmath87 .",
    "each local contribution depends on @xmath87 and on the local potential .",
    "however , within the gcpa , the lloyd formula does not depend on @xmath87 nor on the local potentials . as a consequence , the integrated dos results in a sum of local contributions , coupled together only through @xmath87 , @xmath97 we shall call this very controlled and tractable kind of coupling _ marginal coupling_.    in view of further developments , it is convenient to isolate in eq .",
    "( [ lloyd4 ] ) two distinct terms .",
    "the first arises from the first two addends in eq .",
    "( [ lloyd3 ] ) , it is identical for all sites and related to the effective background defined by the gcpa medium .",
    "the second depends on the local cpa projectors and , through them , on the local potentials . in formulae : @xmath98    implementing the gcpa within the dft gives for the kinetic functional of eq .",
    "( [ ti ] ) the following marginally coupled form : @xmath99,\\mu)\\end{aligned}\\ ] ] where @xmath100 and @xmath101,\\mu)&= & \\frac{1}{\\pi } i m tr \\int_{-\\infty}^\\mu   d\\varepsilon \\log \\underline{d}_i(\\varepsilon ) \\nonumber \\\\ & -&\\int_{v_i } d \\mathbf{r }",
    "\\rho_i(\\mathbf{r};\\mu ) v_i^{eff}(\\mathbf{r};\\mu ) \\end{aligned}\\ ] ]    as mentioned in sect .",
    "ii , in mst - based dft calculations , the only source for @xmath2 scaling is the inversion of the multiple scattering matrix , eq .",
    "( [ mkkr ] ) , required to obtain the scattering - path matrix @xmath25 .",
    "this step is bypassed in a gcpa theory by approximating the relevant matrix elements @xmath51 via eq .",
    "( [ cpa1 ] ) in terms of the local scattering properties and the coherent scattering matrix @xmath87 , the last of which is , in turn , obtained by an averaging process . for this reason , gcpa theories are @xmath0 , allowing for very substantial savings of computing time .",
    "of course , the price for these savings is payed by the approximation implied by eq .",
    "( [ cpa3 ] ) . a diagrammatic analysis of these errors can be found in ref .  .",
    "it is necessary to make a couple of remarks about the physical meaning of the gcpa in the present context and to highlight the differences with respect to the traditional way in which cpa - based theories have been introduced in the past . in first place ,",
    "the gcpa has been introduced here as an approximation for the hohenberg - kohn density functional . as an approximation",
    ", it may well be used to describe an ordered alloy .",
    "its range of applicability is by no means confined to the realm of random alloys .",
    "in second place , the introduction of the weights @xmath78 to be assigned to each scatterer makes gcpa theories suitable for dealing with sophisticated pictures of the order ( or the disorder ) in metallic alloys .",
    "this , of course , requires what we have called an external model. in a foregoing paper we shall discuss a ( to some extent ) self - consistent way to define an external model that is able to provide a picture of ordering phenomena in metallic alloys as a function of the temperature .",
    "in the present subsection we shall analyze certain formal properties of the gcpa approximations introduced in the previous subsection .",
    "all the above discussion can be summarized in the following approximate density functional : @xmath102,\\mu ) \\nonumber \\\\ & + & \\frac{e^2}{2 } \\sum_l q_{i , l }   v^{mad}_{i , l } \\bigg ] \\end{aligned}\\ ] ] in eq .",
    "( [ gpot ] ) the @xmath103 are defined by eq .",
    "( [ qim ] ) and the _ local part _ of the gcpa _ functional _ by @xmath104,\\mu)= t_i([\\rho_i],\\mu)+u_i([\\rho_i],\\mu)\\ ] ] where the terms @xmath105,\\mu)$ ] and @xmath106,\\mu)$ ] are given by eqs .",
    "( [ tigcpa ] ) and  ( [ ualts2 ] ) above .",
    "we note that the local gcpa functional , @xmath107 , depends also on the atomic number of the atom at @xmath5 , @xmath108 , and on the volume and the shape of the @xmath109 voronoi polyhedron through the local potential energy term , @xmath67 . in the following",
    "we shall make the simplifying assumpion of having identical voronoi polyhedra for all the sites considered .    in eq .",
    "( [ gpot ] ) the coupling potentials , @xmath110 , are provided by the specific external model . in the following of this section we shall assume : @xmath111 appropriate choices of the coefficients @xmath112 and of the weights , @xmath78 , give then the ss - cpa or the pcpa .",
    "furthermore , eq .  ( [ vmadlam ] ) can also be used for spherical or for full - potential charge reconstructions .    as mentioned in sect .",
    ".  ( [ varfun ] ) , the density functional is variational not only wrt the global charge density , @xmath46 , and the chemical potential @xmath8 , but also wrt the charge densities in each scattering volume , @xmath52 .",
    "moreover , as discussed in sec .",
    "iii a and in ref .",
    ", the gcpa density functional is variational wrt the effective medium scattering matrix , @xmath87 .",
    "furthermore , in a gcpa theory , the background kinetic term , @xmath113 in eq .",
    "( [ gpot ] ) depends on the electronic density only through @xmath87 and @xmath8 .",
    "thus , the functional derivation of eq .",
    "( [ gpot ] ) wrt the local densities , @xmath52 , gives the following set of coupled equations : @xmath114 where we have used eqs .",
    "( [ qim ] ) , ( [ vmadm ] ) , ( [ vmadm2 ] ) and  ( [ pdef ] ) .    within a gcpa theory ,",
    "solving the set of the euler - lagrange equations  ( [ vargcpa ] ) , one for each scattering center , together with the equations that determine the chemical potential and the coherent scattering matrix @xmath87 , is completely equivalent to the minimization of the density functional . as it is apparent , these euler - lagrange equations are coupled each other _ only _ through the madelung potentials , @xmath87 and @xmath8 . moreover , the functionals @xmath115 are identical for sites occupied by the same chemical species .    in order to understand the consequences of the above result let us consider , for instance , an alloy sample constituted by a large supercell .",
    "one may wish to calculate , _ in the given sample _",
    ", the properties of different atoms , in first place the charge densities , @xmath52 . inside the sample , @xmath87 , @xmath8 and the cell geometry are fixed , thus the set of the @xmath52 is completely determined by the values of the madelung potentials @xmath74 and by the atomic number @xmath108 of the ion at the position @xmath116 . more generally , inside the given sample , any site diagonal property @xmath117 shall be completely determined by @xmath108 and by the set of madelung potentials . we can establish this result as follows : @xmath118 examples of such site diagonal properties are the local contributions to the grand potential , the multipole moments , and the local dos .",
    "the functional forms , one for each alloying species , given by eqs .",
    "( [ pii ] ) sometimes can be easily numerically fitted and then constitute a useful tool for the evaluation of the site quantities in the given sample .",
    "they are the source of the simple laws , as e.g. the qv laws , empirically found from extended metallic systems calculations .",
    "this notwithstanding , gcpa theories are able to predict complex trends for certain site diagonal properties as , e.g. , the site resolved dos s  @xcite .    since eqs .",
    "( [ pii ] ) allows to evaluate , among other properties , also the charge density of each fragment and , hence , the full charge density , @xmath46 , then , in virtue of the hohenberg and kohn theorem , it follows that any ground state observable in the sample given is a _ functional _ of the set of the madelung potentials at all the crystal sites , @xmath74 , and of the set of the atomic numbers _ only_. since the last is , again , specified by the sample , it follows the theorem : _ any ground state observable in the sample given is a functional of the madelung potentials only _ , or , equivalently , _ a function of the set of coefficients _",
    ", @xmath119 , that completely determine the madelung potentials .",
    "stands for the set of all the madelung coefficients of the @xmath34-th site , @xmath120 and @xmath119 for the set of all the madelung coefficients at all crystal sites , i.e. @xmath121 . the notations @xmath122 and @xmath123 have a similar meaning . ]    since , in virtue of eq .",
    "( [ vmadlam ] ) , the coefficients in the set @xmath119 are linear functions of the set of the multipole moments , @xmath123 , then the above theorem implies the corollary that any ground state property of the sample is a function of the same moments . within the gcpa and for the specific sample",
    "given , it is then possible to reformulate the dft in terms of the charge multipole moments . by neglecting a constant term with the physical meaning of the grand potential contribution due to the mean gcpa atom , eq .",
    "( [ gpot ] ) can be written as @xmath124    in deriving eq .",
    "( [ gpotcg ] ) , we have used eq .",
    "( [ vmadlam ] ) and the fact that , since @xmath107 is completely determined by the local density , @xmath52 , it can not depend on the multipole moments at other sites .",
    "moreover , we have isolated the contribution proportional to the chemical potential , @xmath8 .",
    "having introduced an explicit dependence on @xmath8 , the last term in eq .",
    "( [ gpotcg ] ) can be thought as a way of enforcing the global electroneutrality .",
    "this is unnecessary if we consider a specified sample in which , of course , @xmath8 has a precise , fixed vale .",
    "however , since the term proportional to @xmath8 has precisely the form it must have , its introduction is equivalent to extend the validity of eq .",
    "( [ gpotcg ] ) to _ all samples specified by the same mean atomic concentrations and by the same value for _ @xmath87 .    to summarize ,",
    "we have established the following results . within the gcpa class of approximations",
    "the hohenberg and kohn density functional can be recast in the form of eq .",
    "( [ gpotcg ] ) .",
    "it consists of ( a ) local terms , @xmath125 for the @xmath34-th scattering site , consisting in functions of the charge multipole moments that are identical for sites with the same chemical occupation ; ( b ) a bilinear form coupling the charge multipole moments at different sites , with coupling coefficients @xmath126 defined by the crystal geometry ; ( c ) a term proportional to the chemical potential that ensures the global electroneutrality . the functional defined by eq .",
    "( [ gpotcg ] ) is identical for all the alloy samples characterized by the same mean atomic concentrations and the same value for the coherent scattering - path matrix @xmath87 .",
    "evidently , it constitutes a _ coarse grained _ version of the dtf because the mathematical definition of the multipole moments , eq .",
    "( [ qim ] ) , does not completely determine the charge density .",
    "the last is determined by the multipole moments only within the gcpa theory .",
    "this reduction of the relevant information has been obtained at the price ( a ) of the gcpa approximation and ( b ) of having restricted the consideration to a specific sample .",
    "nevertheless , no restriction has been made about the size of the sample that , therefore can be chosen in such a way to guarantee an appropriate description for a fixed concentration ensemble , as we shall discuss at the end of the present section .",
    "having recast the gcpa _ functional _ as a sum of _ functions _ of the charge multipole moments has obvious mathematical advantages .",
    "however , we have not yet completely determined the functional form of the local energetic contributions @xmath127 . in order to do this ,",
    "we need to make the hypothesys that , in the sample considered , the distribution of the madelung potentials coefficients , @xmath119 , is continuous in the range of the values that the same potentials assume in the sample .",
    "this is consistent with the observations in refs .",
    "let us consider two scattering sites , say @xmath34 and @xmath128 , occupied by the same chemical species , @xmath129 , at which the madelung coefficients take very close numerical values , @xmath130 and @xmath131 .",
    "the local energetic contributions , the charge densities and the local multipole moments shall be : @xmath132 , @xmath133 and @xmath134 for the @xmath34-th site , and @xmath135 , @xmath136 and @xmath137 for the @xmath128-th site .",
    "to the first order in @xmath138 we have : @xmath139 where eq .",
    "( [ vargcpa ] ) has been used .",
    "the substitutions of the expansion for the madelung potential , eq.([vmadm ] ) , and of the expressions for the charge multipole moments , eq.([qim ] ) , then give : @xmath140 once integrated over @xmath141 eq .",
    "( [ domega ] ) gives @xmath142 eq .  ( [ intomega ] ) can be easily numerically evaluated from the qv data , @xmath143 obtained as an output from gcpa calculations .",
    "unless a constant with the meaning of the local energy contribution at @xmath144 , it determines the local energies for each chemical species @xmath129 .",
    "( [ domega ] ) and  ( [ intomega ] ) have been obtained under very broad conditions : the differentiability of the kinetic functional  @xcite and the monotonicity of the qv laws .",
    "the first is the usual requirement for the convergence of the kohn - sham scheme of the dft , while the second condition is certainly verified by all gcpa calculations reported in the literature , including those executed at extremely high values for the madelung potential ( see fig .",
    "7 in the next subsection and the related discussion ) .    in the remainder of the present section we shall make a few general comments about the validity of the framework defined by the gcpa theory in comparison with the exact density functional .",
    "\\(i ) the fact that the effective potential and the potential energy functional can be decomposed in site contributions coupled together only through the madelung potentials is an exact consequence of the lda and it has nothing to do with the gcpa .",
    "this kind of coupling is _",
    "marginal _ in the sense that , although not necessarily small , it has the simple and tractable functional form which arises from the bilinear terms involving the multipole moments in eq .",
    "( [ gpotcg ] ) .",
    "although this is beyond the purpose of the present paper , we notice that most non - local density functionals offered in the literature   are actually local wrt the density gradients , thus most non - local schemes will remain _ marginally _ coupled in the above sense .     the local interaction zones ( liz ) used in pcpa ( left frame ) and lsgf ( right frame ) calculations are marked by the dark areas . for each scattering site , the kinetic functional",
    "is evaluated using the appropriate single - site scattering matrices , @xmath145 , inside the liz , and the effective cpa scattering matrix , @xmath146 , outside.,width=257,height=115 ]    \\(ii ) splitting the kinetic functional into local contributions marginally coupled trough the coherent scattering matrix @xmath87 is a simplification due to the gcpa .",
    "in fact , it has been obtained by assuming averaged boundary conditions at the surfaces of the voronoi polyhedra through eq .",
    "( [ cpa0 ] ) .",
    "an estimate of the so induced errors can be obtained by the comparison of pcpa vs. locally self - consistent green function ( lsgf ) calculations  @xcite executed on the same supercell . as it is sketched in fig .",
    "( 3 ) , both calculations evaluate the kinetic contribution from the @xmath34-th to the functional by solving the problem of a single impurity , in the case of the pcpa , or of an impurity cluster , the local interaction zone ( liz ) , for the lsgf . in both cases the scattering matrices outside the liz are set to the coherent scattering matrix , @xmath95 .",
    "pcpa calculations can then be viewed as lsgf calculations with only one atom in the liz .",
    "this argument also suggest that , wrt gcpa calculations , exact dft results include , for each site , corrections depending on its chemical environment .",
    "\\(iii ) we have already seen that the coarse grained version of the gcpa functional , eq .",
    "( [ gpotcg ] ) , holds for all the alloy configurations characterized by a specified value for @xmath87 in a fixed concentration ensemble .",
    "this could appear as a serious limitation since it looks unlikely that , e.g. , @xmath87 could have the same functional energy dependence for two different systems .",
    "in general , in a gcpa theory , @xmath87 is a ground state property determined not only by the mean concentrations but also by the distributions of the madelung potentials for each alloying species . as opposite to the ss model",
    "where these distributions are trivial , more sophisticated external models , as e.g. the pcpa , give complicated charge and madelung potential distributions .",
    "how could then the gcpa functional be useful in such cases ?",
    "atoms in a random alloy configuration and @xmath147 atoms in an ordered configuration , both at the same mean atomic concentrations .",
    "@xmath79 is large enough to to guarantee an appropriate description of a random alloy within a gcpa theory .",
    "similarly , @xmath147 has been chosen to permit the description of an ordered alloy up to some length scale @xmath148 .",
    "the supercell in the frame ( c ) is identical to that in ( a ) except but for the dashed region which contains @xmath147 atoms in the same ordered configuration as in ( b ) .",
    "the cell ( c ) is therefore able to describe an ordering fluctuation up to the scale set by @xmath148 .",
    ", width=264 ]    as argued by faulkner et al .",
    "@xcite , the pcpa theory applied to ideal random alloys gives well - defined values for all physical properties .",
    "this is because , in perfect random alloys , the distribution of the chemical environments is easily obtained by statistical considerations and it is given by the appropriate multinomial distributions .",
    "therefore , the pcpa random alloy constitutes a privileged reference system whose physical properties , including @xmath87 , can be approximated up to an arbitrary accuracy by letting the number of atoms in the pcpa supercell , @xmath79 , going to infinity ( see fig .",
    "we believe that the same @xmath87 obtained for a random alloy at a given concentration can be used for building a physically clean , though approximate , theory also for ordered alloys at the same concentration . in the next section",
    "we shall provide numerical evidences for that , here we present a more formal argument .",
    "imagine that an ordered array containing @xmath147 atoms ( fig.4b ) is able to account for the properties of same ordered alloy configuration , up to a length scale , @xmath148 , that can be made large at will in the @xmath149 limit . in fig .",
    "4c we draw a supercell , a part of which is constituted by the supercell of fig .",
    "4b , while the remaining @xmath150 sites are occupied as in the random alloy supercell of fig .",
    "we can think that the supercell in fig .",
    "4c represents a fluctuation of an ordered phase in a random alloy matrix and that it describes the physical properties of such fluctuation up to the same length scale @xmath148 as in fig .",
    "4b . we are implicitly using the common idea of locality in physics , or , in a more specific context , of nearsightedness of the dft@xcite .",
    "however , as eq .",
    "( [ cpa1 ] ) implies , the difference between the coherent scattering - path matrices corresponding to figs . 4a and 4c ,",
    "@xmath151 , is proportional to the ratio @xmath152 and , then , it can be made small at will in the @xmath153 limit , for _ any _ value of @xmath147 .",
    "we conclude that the coherent scattering - path matrices of a random alloy , @xmath154 , is able to account for the physical properties of ordered configuration considered .",
    "the limitation @xmath155 , that comes from the above argument , does not impose any upper bound on the maximum length scale at which chemical fluctuations can be studied and it is of no practical importance provided that @xmath79 is large enough to ensure a good approximation @xmath154 . as reported in the literature  @xcite , it seems that @xmath79 about 100 is already enough .",
    "\\iv ) although we have suggested that the coherent scattering matrix from random alloys gcpa calculations can be used for ordered alloys too , we are aware of the limitations of such a physical picture . for instance , a gcpa theory always implies finite quasiparticle lifetimes  @xcite , and , hence , a smearing of the peaks of the bloch spectral function ( bsf ) .      as a matter of fact",
    ", the analysis of dft supercell calculations for metallic alloys suggests the existence of simple relationships between the charge excesses at the lattice sites , @xmath156 , and the madelung potentials at the same sites , @xmath157 .",
    "namely , simple linear laws , one for each alloying species , have been found to hold , say @xmath158 where @xmath159 and @xmath160 have the same numerical values for atoms of the same chemical species in the given supercell .",
    "examples of the linear qv laws obtained from pcpa calculations for a binary and a quaternary alloy are reported in figs . 5 and 6 .",
    "[ binqv ]   alloy .",
    "the excesses of electrons , @xmath161 are plotted vs. the madelung potentials , @xmath162 .",
    "the results have been obtained from @xmath163 pcpa calculations for a supercell containing 432 atoms at lattice costant @xmath164 a.u",
    ".. circles represent cu atoms and triangles zn atoms . note that positive values for @xmath165 correspond to negative net charges and vice versa . , title=\"fig:\",width=264 ]     qv relationships for an fcc random @xmath166 alloy .",
    "the excesses of electrons , @xmath161 are plotted vs. the madelung potentials , @xmath162 .",
    "the results have been obtained from @xmath163 pcpa calculations for a bcc supercell containing 108 atoms at lattice costant @xmath167 a.u .. circles , squares , triangles and crosses stand for cu , ni , zn and al atoms . , width=264 ]    it is interesting to observe that similar linear qv laws can be derived starting from the gcpa functional , eq .",
    "( [ gpotcg ] ) , for random alloys by a second order series expansion about the zero madelung field multipole moments , @xmath168 , that can be obtained by solving the following set of equations : @xmath169 this procedure leads to a ginzburg - landau configurational hamiltonian in which the relevant fields are constituted by the values of the multipole moments of each lattice site . in formulae :    @xmath170    where we have omitted the term @xmath171 that represent the gcpa energy at zero madelung field and chemical potential and that is constant in a fixed concentration ensemble . the coefficients @xmath172",
    "are given by the second derivatives of the gcpa functional @xmath173    the functional of eq .",
    "( [ gpotcef ] ) constitutes a generalization of the charge excess function ( cef ) proposed in ref .   for discussing the charge transfers in metallic alloys and",
    "shall then be referred in the following to as the cef .",
    "the novel feature here is that eq .",
    "( [ gpotcef ] ) includes not only the charge excesses , @xmath156 , but also the charge multipole moments with @xmath174 .",
    "the minimization of the cef functional @xmath175 wrt .",
    "its variables , the set of the multipole moments , @xmath123 , and the chemical potential , @xmath8 , gives @xmath176 = \\mu \\delta_{i,00}\\ ] ] and @xmath177    using the definition of the madelung potentials , eq .",
    "( [ vmadlam ] ) , and setting @xmath178 it is easy to show that eq .",
    "( [ gleq ] ) for @xmath179 coincides with the linear laws given by eq .",
    "( [ qv ] ) .",
    "versions of eqs .",
    "( [ gleq ] ) , ( [ electroneut ] ) and ( [ kdef ] ) with the angular momentum summations truncated at @xmath69 can be found in ref .  .",
    "we wish to highlight that the cef derivation from the gcpa functional is based on the assumption , common to all ginzburg - landau theories  @xcite , that the homogeneously disordered phase , in the present case the random alloy phase , can the starting point for a perturbative treatment of ordering or segregation phenomena . as discussed in the previous subsection , in the gcpa context",
    ", this amounts to conjecture that the coherent scattering - path matrix @xmath87 of a random alloy can be used for obtaining a physical picture of concentration fluctuations , or , in other words , that it is able to _ represent _ such fluctuations .",
    "qv relationships for light substitutional impurities ( vacancies , h and li atoms ) dissolved in bcc al , from cpa+lf calculations .",
    "the quantity @xmath180 is the number of valence electrons at the impurity site , therefore @xmath181 corresponds to 0 electrons for vacancies and h atoms and 2 electrons for li .",
    "the linear behaviors observed for small fields ( @xmath182 ) are superseded by power law trends ( see the log - log plot in the inset ) for very high fields.,width=264 ]    we wish to close this section with a few comments .",
    "the principal result of this paragraph , the cef functional of eq .",
    "( [ gpotcef ] ) , has been obtained by a series expansion of the gcpa functional about the values that the multipole moments would have in absence of coupling .",
    "the series has been terminated at the lowest order at which differences with respect to ss approximations are expected for .",
    "this , not surprisingly , is enough to obtain a physical picture of the charge transfers in metallic alloys . for a given alloy configuration",
    ", the linear euler - lagrange equations obtained by minimizing the cef can be easily solved for the charge multipole moments .",
    "the procedure require the inversion of the matrix @xmath183 of elements @xmath184    as we have shown elsewere  @xcite , for a given alloy configuration , the value of the cef functional at its minimum has the physical meaning of the total energy of the same configuration .",
    "the ambiguity due to the presence of the above mentioned concentration dependent constant can be resolved by comparing cef and gcpa calculations for a single configuration in a fixed concentration ensemble .    in the previous subsection",
    "we have described a general procedure based on the numerical integration of the qv laws for evaluating the functional form of @xmath185 .",
    "of course , if the random alloy @xmath87 was able to represent concentration fluctuations and the qv laws were linear , the gcpa and the cef functionals would be coincident .",
    "we do not think that the qv laws can be truly linear .",
    "the argument is as follows .",
    "the local excesses of electrons , @xmath156 , accordingly with the physical intuition and with the results plotted in figs",
    ". 5 and 6 , are non - increasing functions of the madelung potential @xmath157 .",
    "if the qv laws were really linear , @xmath156 would decrease indefinitively and eventually reach unphysical values , @xmath186 corresponding to negative charge densities .",
    "actually we expect that the linear laws can not be any longer valid when all valence electrons are expelled from the site .",
    "this circumstance would correspond to some critical value for the charge excess , say @xmath187 . before this critical value",
    "is reached , the qv laws should exhibit a crossover to an asymptotic behavior , say @xmath188 as @xmath189 .",
    "we have tested this conjecture by executing cpa+lf calculations  @xcite for a single impurities , vacancies , h or li atoms , embedded in al .",
    "the results are shown in fig .",
    "7 , where we plot @xmath190 for the impurity site as a function of the relevant madelung fields . in all the cases",
    "considered , a linear regime is clearly visible at low fields . a very high fields , a crossover to a power law dependence",
    "is observed , with the number of electrons tending to the critical value from above .",
    "the crossover field is comparable with the host band width .",
    "we recall that in cpa+lf calculations @xmath87 is that of the host while the madelung potential is just an adjustable papameter .",
    "while this is a sensible way for studying the response of the impurity to the perturbing field , this do not imply that all the range of the perturbations considered is physically meaningful .",
    "we do not think that such high fields , corresponding to the tunneling regime in the impurity site , could occur in real systems as this would require a too large defect of electrons at the impurity nearest neighbors . hence , fig .",
    "7 , while supporting the view that the linearity of the qv laws and the cef are just approximations , does not support the possibility that , at least for metallic systems , appreciable deviations from linearity or failures of the cef are likely to occur .",
    "another point we wish to address is concerned with the value of the chemical potential @xmath8 in eq .",
    "( [ gpotcef ] ) . in a recent paper ,",
    "drchal et al .",
    "@xcite argued that @xmath8 should be always zero since the fourier transform of the madelung coefficients with @xmath191 diverges as @xmath192 implying that the sum of the charge excesses @xmath193 must vanish , automatically satisfying the electroneutrality constraint .",
    "the observation of drchal et al . is correct for infinite systems , while for finite supercells , even with periodic boundary condition , the same fourier transform always remains finite .",
    "@xmath194 , in fact can take only the values of the reciprocal space vectors that consitute the tiling of the supercell considered  @xcite .",
    "the set of the allowed values for @xmath194 includes @xmath195 only for infinitely large supercells . in most practical calculations , then , @xmath8 is necessary , although usually it takes small non - zero values .",
    "in this section we present a series of numerical tests designed to study the limits of validity of the gcpa and cef theoretical frameworks .",
    "the central issues here shall be investigating the realm of validity of the linear qv laws , eq .",
    "( [ qv ] ) or  ( [ gleq ] ) , and of the energetics implied by the cef functional , eq .",
    "( [ gpotcef ] ) .",
    "furthermore , we shall try to answer two questions : ( i ) to what an extent the cef is able to approximate gcpa calculations and ( ii ) how do the predictions from the cef and the gcpa compare vs. exact dft calculations for ordered systems .",
    "the gcpa theory chosen for these tests is the pcpa  @xcite , that , being based on a supercell approach , allows for easy comparison vs. exact dft calculations .",
    "several kinds of calculations shall be presented in this section .",
    "the exact dtf results used for comparison shall be lda full - potential lapw calculations produced using the wien2k _ ab initio _",
    "package  @xcite .",
    "they are referred below to as lapw . in all the cases about 10@xmath196",
    "k - points in the full brillouin zone have been used , the spherical harmonics expansion of the potentials in the muffin - tin spheres has been truncated at @xmath197 and the parameter @xmath198 has been set to 7 .",
    "the pcpa calculations have been performed by a conveniently modified version of our kkr - cpa code  @xcite .",
    "all pcpa calculations are based on the asa approximation for the site potentials , use several thousands k - points in the full brillouin zone and 31 energies over a complex integration contour . for both lapw and pcpa calculations ,",
    "the core electrons treatment is fully relativistic while a non - relativistic approximation is used for valence states .",
    "finally , we present cef calculations  @xcite with the charge multipolar expansion truncated at @xmath69 .",
    "the concentration dependent parameters required by the cef have been obtained from the linear regressions of the qv data generated from supercells with random occupancies and the required mean atomic concentrations and are reported in tables  [ tabi ] and  [ tabii ] .",
    "depending on which was the source of the parameters , the cef calculations shall be referred to as cef - pcpa or cef - lapw . using the formalism of the previous section , for both pcpa and cef calculations we set @xmath199 for all lattice sites , @xmath200 and @xmath201 for @xmath202 .",
    ".[tabi ] cef parameters obtained by the linear regression of the qv data from pcpa calculations for random cu@xmath203zn@xmath204 alloys in bcc or fcc lattices . @xmath205 and @xmath206 are defined as the difference between 1 and the correlations obtained from the regressions for the cu and zn site charges .",
    "all the quantities are expressed in atomic units .",
    "cef calculations using the coefficients presented in this table are referred to as cef - pcpa . [",
    "cols=\"^,^,^,^,^,^,^\",options=\"header \" , ]     in a previous letter  @xcite we have shown that the cef is able to carefully reproduce the charges from lsms calculations .",
    "moreover , the parameters extracted from ordered structure calculations can be used to predict the charges for random structures and vice - versa .",
    "the quality of the cef predictions was very good either , with @xmath207 of the order of @xmath208 , i.e. about three orders of magnitude less than what we have found by the comparison of cef and pcpa . since the lsms calculations presented in ref .",
    "were based on the asa , we surmise that the modest lost of accuracy of cef predictions for lsms wrt .",
    "pcpa calculations constitutes a measure of the importance of the scattering effects from nearest neighbors .",
    "these effects , in fact , can be accounted for only in a mean field fashion by the pcpa .",
    "we have also investigated the effects of the spherical approximation for the atomic potentials by executing full - potential lapw calculations . in fig .",
    "8 we plot the site charge excesses obtained from lapw vs. the number of unlike nearest neighbors of the same sites , for all the structures corresponding to equimolar concentrations . in tables",
    "[ tabiii ] and  [ tabiv ] we report the results for @xmath207 at all the concentrations . as apparent from fig .",
    "8 , the trends of @xmath165 are not easily accounted for by the nearest neighbors environment only  @xcite , expecially for bcc based structures .",
    "[ magrifig7 ] , vs. the number of unlike nearest neighbors of the corresponding site , @xmath209 , from lapw calculations for many , bcc and fcc based , ordered and disordered , configurations , of @xmath210 alloys .",
    "circles and triangles represent charges on cu and zn sites , respectively .",
    "left frame : bcc - based alloys ; right frame : fcc - based alloys .",
    "the straight lines in each panel indicate the best fits obtained by the model of magri et al .",
    ", title=\"fig:\",width=264 ]    this notwithstanding , cef - pcpa calculations reasonably account for the lapw charges . as it can be seen in the columns marked as ( b ) of tables  [ tabiii ] and  [ tabiv ]",
    ", @xmath207 is usually of the order of @xmath211 , sometimes less , and about @xmath212 in the worst case . in order to understand how much these results can be affected by the pcpa input coefficients",
    ", we have repeated cef calculations by fitting the coefficients from lapw qv data for the random alloy configurations corresponding to the relevant stoichiometries and reported in tables  [ tabiii ] and  [ tabiv ] .",
    "as shown in the columns ( c ) of tables  [ tabiii ] and  [ tabiv ] , this reduces @xmath207 of about one order of magnitude .",
    "[ dqs8 ]   for the same @xmath210 alloys as in fig . 8 .",
    "circles , triangles and squares represent the calculated values by cef - pcpa , cef - lapw and by the model of ref .  , in abscissa the charge excesses obtained by lapw calculations are reported .",
    "left frame : bcc - based alloys ; right frame : fcc - based alloys . in oder to improve readability we plot also the straight lines @xmath213 .",
    "the deviations from these lines measure the accuracy of the various calculations .",
    ", title=\"fig:\",width=264 ]    interestingly , the present cef - lapw calculations confirm the observations about the transferability of cef parameters in ref .",
    ", where the cef charges have been compared vs. lsms results . as a typical example , let us consider the results for @xmath214 reported in table  [ tabiii ] .",
    "the @xmath215 obtained are alway small : @xmath216 in the worst case and @xmath217 in the best , corresponding respectively to structures 71 and 74 , while an intermediate value , @xmath218 is found for the structure @xmath219 , from which the cef - lapw coefficients have been obtained .",
    "the same holds for all the concentrations , both for bcc and fcc structures .",
    "a look to the columns ( c ) in the tables  [ tabiii ] and  [ tabiv ] , in fact , shows that while excellent results have been obtained for all the supercell , the random structure from which the cef coefficients have been extracted is not necessarily the best performing .",
    "the above arguments about the charges should not lead to the conclusion that , for this purpose , any fit is comparable with any other .",
    "this is clearly shown in fig . 9 ,",
    "where the performances of pcpa , cef - pcpa , cef - lapw and by the model of magri et al .",
    "@xcite are compared for the equiatomic concentration alloys . in the same figure , the distances from the diagonal lines measures the differences between the lapw charges and those by various approximations , for all the cu sites in the supercells with @xmath220 .",
    "it is there evident that the results by cef - lapw , marked by open triangles , are much better than those by other approximations .      in tables",
    "[ tabiii ] and  [ tabiv ] we compare the total energies obtained for cuzn alloys by cef , pcpa and lapw calculations .",
    "we have used the same extended set of bcc and fcc based structures listed in ref .  .",
    "since the cef energies contain a , concentration dependent constant , we report the quantity @xmath221 , defined as the energy difference between the structure at hand and the structure that , at the same concentration , has the lowest energy , according with pcpa calculations .",
    "the same @xmath221 is plotted in figs .",
    "10 and 11 for the cu concentrations @xmath222 , @xmath223 , an @xmath224 , for which the database of ref .",
    "contains a number of structure sufficient to individuate trends .",
    "total energy differences with respect to the pcpa predicted ground state , @xmath221 , for bcc based cu@xmath203zn@xmath204 alloys .",
    "the labels indicated in abscissa identify the various configurations in the database of ref .",
    ", @xmath225 stands for structures with randomly generated chemical occupations containing 16 atoms with mean cu contents c=0.25 , 0.5 and 0.75 .",
    "open triangles , open circles , open squares and filled triangles , indicate lapw , cef - lapw , cef - pcpa and pcpa calculations , respectively .",
    "lines are a guide for the eye .",
    ", width=264 ]    our first observation is that the total energies obtained by pcpa and cef - pcpa calculations perfectly overlap on the scale of figs .",
    "10 and 11 , where they are represented as filled triangles and open squares , respectively . as reported in tables  [ tabiii ] and  [ tabiv ] , in fact , the values obtained by the two methods are different by a few @xmath226 per atom , that is comparable with the accuracy of the calculations .",
    "thus , pcpa and cef - pcpa give indintinguishable results both for the charges ( as discussed in the previous subsection ) and the total energies .",
    "therefore , it is compelling to conclude that the cef theory is a numerically excellent and powerful tool to reproduce with much less efforts gcpa electronic structure calculations .",
    "moreover , since cef - pcpa calculations use as an input the qv data obtained from _ random _ supercells , the perfect agreement obtained for the properties of so many different _ ordered _ structures that have not been used to fit the cef coefficients has only one possible explanation . accordingly with the discussion in sects .",
    "iii b and iii c , both the following conditions must be fulfilled .",
    "( i ) the coherent scattering - path matrix @xmath87 of the random alloy configuration used as an input must be representative of the whole set of ordered structures considered ; ( ii ) the linearity of the qv laws is almost perfectly observed in all the range of values that the charge excesses and the madelung potentials take for the structures considered . in sect .",
    "iii we have offered several arguments supporting the validity of both points above , but we have not been able to provide an analytical demonstration .",
    "we think that the numerical evidence found is very strong and compelling .",
    "total energy differences with respect to the pcpa predicted ground state , @xmath221 , for fcc based cu@xmath203zn@xmath204 alloys .",
    "the labels indicated in abscissa identify the various configurations in the database of ref .",
    ", @xmath225 stands for structures with randomly generated chemical occupations containing 16 atoms with mean cu contents c=0.25 , 0.5 and 0.75 .",
    "open triangles , open circles , open squares and filled triangles , indicate lapw , cef - lapw , cef - pcpa and pcpa calculations , respectively . lines are a guide for the eye .",
    ", width=264 ]    accordingly with the discussion in sect .",
    "iii , the success of the cef theory in reproducing the charges or , equivalently , the madelung potentials guarantees the reproducibility of _ any _ ground state property within the gcpa theory through eq .",
    "( [ pii ] ) . hence ,",
    "even spectral properties as the dos or the bloch spectral functions , although buried , are contained in the cef functional that , if the input parameters are extracted from a gcpa theory , inherits all the good and the bad things of same gcpa theory .",
    "the comparison with lapw calculations is more difficult , for two different reasons . in first place",
    ", these calculations do not assume mean boundary conditions for the wave - functions and use a procedure equivalent to the full calculation of the @xmath25 matrix .",
    "in second place , within lapw calculations , the charge multipole summation is truncated at some high @xmath227 value . with these clarifications ,",
    "the agreement between lapw and pcpa or cef - pcpa calculations ( there is no reason for discussing the last two models separately ) is quite good . as a general rule ,",
    "the two set of calculations find the same ground states at the concentrations considered . in the few exceptions ( that correspond to the negative figures in the lapw columns of tables  [ tabiii ] and  [ tabiv ] ) the disagreement can be explained by the fact that the structures indicated as the ground state by the two theories are almost degenerate in energy .",
    "also the general trends for the total energies are well reproduced , as it is visible in figs .",
    "10 and 11 , though the pcpa generally underestimate the energy differences .",
    "fitting the cef parameters from the lapw qv laws generally improves the agreement . at variance of what found for the charges , however , the improvement is quite modest .    in summary :",
    "the cef appears able to perfectly reproduce gcpa calculations for both ordered and disordered metallic systems .",
    "the reasons why the agreement is so excellent are not yet completely understood . although cef and gcpa theories are both coarse grained versions of the dft , opposite to what numerical results suggest , they are not the _ same _ theory .",
    "in fact , as discussed in sect .",
    "iii , in order to be coincident to the cef , gcpa theories should ( i ) exactly observe linear qv laws and ( ii ) lead to coherent scattering matrices independent on the configuration in a fixed concentration ensemble .",
    "for metallic alloys , these conditions appear plausible and the numerical evidence strongly support the view that both are nearly satisfied",
    ". however we must highlight that the condition ( i ) is not verified for pathologically high values of the madelung field .",
    "the comparison vs. lapw calculations suggest that both coarse grained theories , gcpa and cef , are able to reproduce semiquantitatively the total energies of the alloy configurations considered .",
    "in particular , the results by the coarse grained theories are strongly correlated with those by lapw .",
    "this fact is better elucidated by figs .",
    "10 and 11 , where configurations belonging to the same fixed concentration ensemble are ordered in such a way to have increasing pcpa total energies .",
    "if the same ordering was not observed by some other method for some configuration , this would show up as a local minimum in the corresponding curve .",
    "the most visible of such events , occurs in fig .",
    "11 for @xmath228 , where the curve corresponding to lapw calculations presents a very weak local minimum at the configuration 25 .",
    "the examination of figs .",
    "10 and 11 suggests that the coarse grained theories are able to give qualitatively correct predictions about ordering for the alloys considered , while the fact that they generally underestimate the corresponding energies could imply incorrect estimates of the corresponding transition temperatures .",
    "we wish to conclude this paper with a summary and a few comments .",
    "we have introduced the class of the gcpa theories , that are characterized by ( i ) a specific ansatz for the kinetic part of the density functional , which is common to all cpa - based theories , and ( ii ) an external model that determines the way in which the atomic effective potentials should be reconstructed and the statistical weights to be assigned each .",
    "the gcpa class of approximations includes most existing cpa - based density functional theories , to mention a few : the cpa prototype , i.e. the single site cpa  @xcite , the screened impurity model cpa ( sim - cpa )  @xcite , the polymorphous cpa ( pcpa )  @xcite , the cpa including local fields ( cpa+lf )  @xcite , the non local cpa ( nl - cpa )  @xcite .",
    "the ansatz ( i ) consists in applying averaged boundary conditions at the surfaces of each scattering volume and naturally leads to algorithms requiring a number of operation that scales as @xmath79 .",
    "as it is discussed by abrikosov and johansson  @xcite , cpa - based approximations allow for a careful picture of the spectral properties of metallic alloys .",
    "the so much criticized results of the ss - cpa about the total alloy energies can be healed by external models that consider the charge distribution in the system .",
    "we have shown how this can be done systematically by writing the relevant energetic contributions as a series involving the charge multipole moments in each scattering volume .",
    "the truncation errors of the same series are probably already quite small when only the first term is included , as in the case of spherical approximations .",
    "we have derived an expression of the gcpa density functional that , together with the above multipole sums , includes local atomic terms , completely determined by the atomic number of the ion in the volume , and by the geometry of the same volume . the local term at the @xmath34-th site",
    "is coupled to the others only through the coherent scattering matrix @xmath87 and the madelung potential at the same site .",
    "although this kind of coupling , that we have called _ marginal coupling _ , is not necessarily weak , nevertheless , it is analytically tractable and it is the source of the @xmath0 scaling in gcpa theories .",
    "we have demonstrated that in a gcpa theory all ground state properties within a specific sample are functions of the appropriate coupling madelung potential _ only _ , or , equivalently , of the charge multipole moments at each lattice site . to put it into other words : we have demonstrated that the gcpa approximations realize a _ coarse graining _ of the hohenberg - kohn density functional , since only a part of the information conveyed by the electronic density field , namely the charge multipole moments , is actually entering in the gcpa approximate functional .",
    "moreover we have suggested that the explicit form of the gcpa functional dependence on the multipole moments can be obtained in a fixed concentration ensemble by the numerical integration of the qv relationships for a random alloy configuration belonging to the same ensemble .",
    "the above procedure does not rely on the linearity of the qv laws .",
    "we have re - derived the cef  @xcite as a sensible approximation of the gcpa theories , with which it would coincide provided the qv were exactly linear as claimed by many groups .",
    "the present derivation allows for the inclusion of higher order multipole moments .",
    "a very remarkable feature of the cef theory is that it shares the same structure of the mst .",
    "in fact , the minimization of the cef requires the solution of a set of euler - lagrange equations that has the same structure of the korringa - kohn - rostoker ( kkr ) matrix at zero energy and wave - vector  @xcite .",
    "more specifically , as it can be seen by comparing eqs .",
    "( [ mkkr ] ) and  ( [ fmatrix ] ) , the site - diagonal response functions , @xmath172 , and the madelung coefficients , @xmath126 , in the cef theory , play the role of the site diagonal scattering matrices and the kkr structure constants in the mst theory .",
    "the correspondence is not only formal , since the @xmath172 are single - site quantities in the same sense of the ss scattering matrices  @xcite and , in plain analogy with them , are related with the ss response to the appropriate perturbing field  @xcite .    in the present paper we have provided several formal arguments and strong numerical evidences that cef and gcpa theories",
    "lead to very similar results , the discrepancies being of the order of the numerical errors .",
    "we have also shown that cef and gcpa theories are able to reproduce the charges and the total energies for many ordered alloy configurations . in our view the _ coarse grained theories _ , gcpa and cef , constitute a valuable alternative to full dft calculations .",
    "although the cpa theory was proposed many year ago with the purpose of dealing with substitutionally disordered alloys , we think that we have shown that today gcpa theories are able to deal with ordered intermetallic compounds too .",
    "therefore , the fact that cpa - based theories are able to cope with sophisticated model of disorder is not an original sin but , rather , an added value .",
    "the computational performances of the cef have been discussed in more details elsewhere  @xcite .",
    "here we like to mention that the possibility of evaluating total energies for thousand atoms in a few seconds cpu time could constitute a substantial enlargement of the domain of the applications of the dft ."
  ],
  "abstract_text": [
    "<S> the class of the generalized coherent potential approximations ( gcpa ) to the density functional theory ( dft ) is introduced within the multiple scattering theory formalism with the aim of dealing with , ordered or disordered , metallic alloys . </S>",
    "<S> all gcpa theories are based on a common ansatz for the kinetic part of the hohenberg - kohn functional and each theory of the class is specified by an external model concerning the potential reconstruction . </S>",
    "<S> most existing dft implementations of cpa based theories belong to the gcpa class . the analysis of the formal properties of the density functional defined by gcpa theories shows that it consists of marginally coupled local contributions . </S>",
    "<S> furthermore it is shown that the gcpa functional does not depend on the details of the charge density and that it can be exactly rewritten as a function of the appropriate charge multipole moments to be associated with each lattice site . a general procedure based on the integration of the qv laws </S>",
    "<S> is described that allows for the explicit construction the same function . </S>",
    "<S> the coarse grained nature of the gcpa density functional implies a great deal of computational advantages and is connected with the @xmath0 scalability of gcpa algorithms . </S>",
    "<S> moreover , it is shown that a convenient truncated series expansion of the gcpa functional leads to the charge excess functional ( cef ) theory [ e. bruno , l. zingales and y. wang , phys . </S>",
    "<S> rev . </S>",
    "<S> lett . * 91 * , 166401 ( 2003 ) ] which here is offered in a generalized version that includes multipolar interactions .    </S>",
    "<S> cef and the gcpa numerical results are compared with status of art lapw full - potential density functional calculations for 62 , bcc- and fcc - based , ordered cuzn alloys , in all the range of concentrations . </S>",
    "<S> two facts clearly emerge from these extensive tests . in first place , </S>",
    "<S> the discrepancies between gcpa and cef results are always within the numerical accuracy of the calculations , both for the site charges and the total energies . in second place , </S>",
    "<S> the gcpa ( or the cef ) is able to very carefully reproduce the lapw site charges and a good agreement is obtained also about the total energies . </S>"
  ]
}