{
  "article_text": [
    "in the continuum form of the landau - lifshitz - gilbert equation , the effective field @xmath0 is the functional derivative of the total energy functional @xmath1 with respect to the magnetization @xmath2",
    "@xcite : @xmath3    in numerical micromagnetics , the dynamics of magnetization are described by the semi - discretized landau - lifshitz - gilbert equation , in which the motion of magnetization is computed from the discretized effective field . it is desireable to preserve the relation   between effective field and total energy in the semi - discretized formulation  @xcite  if   holds for the discrete system , then the total energy will decrease in the simulation , simplifying the use of energy - based criteria for the control of the simulation or the search for an equilibrium .",
    "in order to preserve  , the effective field has to be computed from the discretized total energy function using the corresponding discrete counterpart to the functional derivative  @xmath4 . for the exchange , anisotropy , and zeeman terms",
    "this is usually straightforward , however for the demagnetizing field it is more difficult . in finite difference ( fd ) micromagnetics , it can be achieved by computing the total demagnetizing energy of the system using the analytical expression  @xcite for the demagnetizing tensor , and then differentiating with respect to the degrees of freedom  @xcite . however , in finite element ( fe ) micromagnetics , the demagnetizing field is usually computed using the fem / bem method  @xcite where the field is derived from the magnetostatic potential , and the energy is not computed exactly .",
    "it is therefore desireable to be able to accurately and efficiently compute the total magnetostatic energy of a system represented by a set of polyhedral elements , with magnetization linear inside each polyhedron ( as in the fe method with linear lagrange elements ) .",
    "the total energy of the system is the sum of pairwise interactions between the polyhedrons and in this paper we describe how to compute this pairwise interaction .    given two interacting magnetized polyhedrons @xmath5 and @xmath6 with arbitrary magnetizations @xmath2 and @xmath7 , the energy @xmath8 of the magnetostatic interaction between them is : @xmath9 where @xmath10 is the demagnetizing ( stray ) field produced by the polyhedron  @xmath6 .",
    "the straightforward approach of numerically computing the integral   is problematic because it requires explicit integration over a 6-dimensional region of space ; additionally , when the polyhedrons overlap or coincide , the integrand is singular and regular integration methods can not be applied .",
    "many analytical results are available for similar 3-fold integrals arising during the calculation of the field  @xcite . however",
    ", none of the formulas can be easily adapted to this more complex 6d case . in",
    "@xcite a method is developed for removing the singularity in   that can be applied to the uniform magnetization case but does not generalize easily to the linear magnetization case .",
    "a fourier - transform method has been devised for the computation of magnetostatic energy  @xcite , however for the case investigated in this paper , the required 3d numerical integration in the fourier space is still somewhat impractical .",
    "the rest of the paper describes the proposed method for the computation of this integral .",
    "the main approach is to analytically perform 4 out of 6 iterated integrals resulting in a 2d surface integral that is nonsingular and can be evaluated numerically using standard methods .",
    "this semi - analytical approach is similar to  @xcite ; the use of notation and vector analysis in the analytical derivation is similar to the techniques in  @xcite .",
    "for the purposes of computation , an arbitrary linear vector - valued function in space @xmath2 can be represented by a @xmath11 matrix @xmath12 : @xmath13 . however , performing analytical calculations for this general case is quite inconvenient ; instead we only consider vector - valued linear functions of the form @xmath14 where @xmath15 is a scalar linear function and @xmath16 is a constant vector . for the common case of a tetrahedral element",
    ", an arbitrary linear vector - valued function @xmath2 can be reconstructed from the vertex values @xmath17 , @xmath18 : @xmath19 , where @xmath20 are the shape functions of the tetrahedron .",
    "we perform the computations for a pair of interacting linearly magnetized polyhedrons @xmath5 and @xmath6 with magnetizations @xmath14 and @xmath21 , where @xmath16 and @xmath22 are constant magnetization vectors and @xmath15 , @xmath23 are dimensionless linear functions in space ( figure  [ fig - tets ] ) . from  , the energy @xmath8 of the magnetostatic interaction between the polyhedrons is @xmath24 , where @xmath25 is the symmetric @xmath26 `` demagnetizing tensor '' @xmath27     of the magnetostatic interaction between polyhedrons @xmath5 and @xmath6 with magnetizations @xmath14 and @xmath21 , where @xmath16 and @xmath22 are constant magnetization vectors and @xmath15 , @xmath23 are dimensionless linear functions in space.,width=377 ]    the goal of this paper is to compute this sixfold integral given the coordinates of the vertices of @xmath5 and  @xmath6 and the coefficients of the linear functions @xmath15 and @xmath23 . when the polyhedrons @xmath5 and @xmath6 are separated , the integral can be computed numerically , however when the polyhedrons overlap or coincide , the integrand is singular and standard numerical integration is inaccurate .    to deal with this issue , we analytically reduce the double volume integral   to a double surface integral , then evaluate the surface integral over @xmath28 analytically , and the second surface integral integral over @xmath29 numerically .",
    "this procedure is similar to the one employed in  @xcite  the four analytical steps result in a surface integral with a bounded integrand that can be integrated numerically with reasonable accuracy and efficiency .",
    "a short notice on units : the demagnetizing tensor commonly used in finite difference micromagnetics  @xcite is dimensionless , however the tensor  @xmath25 computed in this paper   has units of volume .",
    "the analytical derivation proceeds in the following three steps :    * transform the double volume integral   to a double surface integral using gauss s theorem , removing linear factors via integration by parts ( section  [ sec : vol2surface ] ) , * express the integrand for the outer surface integral over @xmath29 as a linear combination of primitive terms ( section  [ sec : surf2terms ] ) , @xmath30 where @xmath31 is the polygonal surface of the polyhedron @xmath5 , @xmath32 is the same surface shifted by @xmath29 according to the the substitution @xmath33 , and @xmath34 denotes tensor multiplication ( i.e. @xmath35 is a symmetric tensor of rank 2 ) . *",
    "analytically integrate the primitive terms @xmath36 over each polygonal surface , again by applying integration by parts , stokes theorem ( for integration over a surface ) , and gradient theorem ( for integration over a line ) , section  [ sec : eval - ik ] .    the equation derived in step 2",
    "( see section  [ sec : analyticalresult ] ) together with the corresponding analytical formulas for the primitive terms @xmath36 form the main result of the paper .",
    "the derivation of the analytical formulas for @xmath36 requires the computation of a number of auxiliary functions :    @xmath37    the relation between the formulas for these functions is shown below ( an arrow indicates that the formula at the source depends on the formula at the target ) :    @xmath38",
    "the first step is the conversion of   to a double surface integral . due to the high complexity of intermediate expressions",
    "the derivation was performed using a computer algebra system ; the source code is included in the supplementary information for this paper  @xcite .",
    "table  [ tab - vol - surf - conversion ] shows the identities used in the derivation , they are applied repeatedly in a straightforward manner to integrate the terms and simplify the result .",
    "we chose to express the vector / tensor identities using tensor notation which is compact and more suitable for computer algebra than using explicit indices ( with einstein summation ) .",
    "after repeatedly applying the identities in table  [ tab - vol - surf - conversion ] , we arrive at the following formula for the demagnetizing tensor @xmath39 \\frac{1}{|{{\\mathbf r}}- { { \\mathbf r}}'| } ds\\ , ds ' \\end{split } \\label{eq - surfsurf}\\ ] ] where @xmath40 , @xmath41 are the normal vectors to the corresponding surfaces and @xmath42 , @xmath43 are the ( constant ) gradient vectors for the linear functions @xmath15 and @xmath23 .",
    "as expected , the formula is symmetrical under replacement @xmath44 , @xmath45 and reduces to gauss s theorem when @xmath15 and @xmath23 are constant .",
    "side note : in principle , all derivations could be performed with scalars instead of tensors by computing the scalar counterpart to the integral   @xmath46 with this method the auxiliary vectors @xmath47 and @xmath48 would have to be included in all intermediate derivations ; this would remove the need to keep track of tensor indices at the cost of slightly expanded notation .    [ cols=\"^,^\",options=\"header \" , ]",
    "we presented a method to compute the energy of the magnetostatic interaction between linearly magnetized polyhedrons .",
    "the magnetostatic energy integral   is computed using a hybrid procedure where four out of six integration steps are performed analytically resulting in a nonsingular 2d integral   which is then computed numerically .",
    "the method can be used in finite element micromagnetics to compute the demagnetizing energy with a high degree of accuracy ( for instance , as a reference value in comparison to fast , less accurate traditional methods such as fem / bem ) .",
    "combined with a suitable long range approximation for the magnetostatic integral  , it can allow an implementation of energy - based fast multpole method ( fmm ) or tree - code algorithms for the computation of the demagnetizing field .",
    "numerical testing showed excellent agreement between the hybrid computation using the new analytical formula   and the reference finite difference simulation .",
    "we thank prof .",
    "ronald cools for providing access to the online encyclopaedia of cubature formulas  @xcite .",
    "we acknowledge financial support from the epsrc centre for doctoral training grant ep / g03690x/1 .",
    "it is easy to verify that @xmath50 ; using eq .   for the first index of the rank-2 tensor",
    "@xmath51 we get @xmath52 \\,ds \\\\ & = \\int_{\\partial\\tau - \\mathbf r ' } \\left [          -{{\\mathbf n}}\\times ( { { \\mathbf n}}\\times \\nabla { { \\mathbf r}}|{{\\mathbf r}}| )          + { { \\mathbf n}}\\otimes ( { { \\mathbf n}}\\cdot \\nabla { { \\mathbf r}}|{{\\mathbf r}}| )          - \\mathbf{id } |{{\\mathbf r}}| \\right ] \\,ds \\\\ & = \\int_{\\partial\\tau - \\mathbf r ' } \\left [          -{{\\mathbf n}}\\times ( { { \\mathbf n}}\\times \\nabla { { \\mathbf r}}|{{\\mathbf r}}| )          + ( { { \\mathbf n}}^{\\otimes 2 } - \\mathbf{id } ) |{{\\mathbf r}}|          + ( { { \\mathbf n}}\\cdot { { \\mathbf r } } ) \\ , { { \\mathbf n}}\\otimes \\frac{{{\\mathbf r}}}{|{{\\mathbf r}}| } \\right ] \\,ds\\end{aligned}\\ ] ] in the expression @xmath53 the cross product acts on the first index of the tensor @xmath51 .    after applying the stokes theorem   and noticing that @xmath54 is constant over the facets of a polyhedron",
    ", we get the desired formula @xmath55\\ ] ]",
    "to compute @xmath57 , we decompose @xmath58 into components parallel and orthogonal to @xmath59  ( eq .  ) @xmath60 integrating over the line @xmath61 and using the fact that for points on the line @xmath62 = @xmath63 @xmath64 after applying the gradient theorem  ( eq .  ) we get the desired equation @xmath65",
    "we begin by writing the following identities that can be verified by direct differentiation @xmath67 & =      { { \\mathbf r}}|{{\\mathbf r}}|       + ( \\mathbf u \\cdot { { \\mathbf r } } ) \\mathbf u |{{\\mathbf r}}|      + ( \\mathbf u \\cdot { { \\mathbf r}})^2 \\frac{{{\\mathbf r}}}{|{{\\mathbf r}}| } \\\\ ( \\mathbf u \\cdot \\nabla ) [ ( \\mathbf u \\cdot { { \\mathbf r}})^2 |{{\\mathbf r}}| ] & =      2 ( \\mathbf u \\cdot { { \\mathbf r } } ) |{{\\mathbf r}}|      + ( \\mathbf u \\cdot { { \\mathbf r}})^3 \\frac{1}{|{{\\mathbf r}}|}\\end{aligned}\\ ] ] multiplying the second equation by @xmath68 and subtracting from the first to eliminate @xmath69 on the right - hand side , we get @xmath70 -   \\frac{\\mathbf u}{2 } ( \\mathbf u \\cdot \\nabla ) [ \\mathbf ( \\mathbf u \\cdot { { \\mathbf r}})^2 |{{\\mathbf r}}| ] = { { \\mathbf r}}|{{\\mathbf r}}| + ( \\mathbf u \\cdot { { \\mathbf r}})^2 \\frac{{{\\mathbf r}}}{|{{\\mathbf r}}| } - \\frac{\\mathbf u}{2 } ( \\mathbf u \\cdot { { \\mathbf r}})^3 \\frac{1}{|{{\\mathbf r}}|}\\ ] ] solving for @xmath71 and integrating @xmath72 \\,dl      - \\int_{{{\\mathbf r}}_1}^{{{\\mathbf r}}_2 } ( \\mathbf u \\cdot { { \\mathbf r}})^2 [ \\mathbf{id }   - \\frac{\\mathbf u}{2 } ( \\mathbf u \\cdot { } ) ] \\frac{{{\\mathbf r}}}{|{{\\mathbf r}}| } \\,dl\\ ] ] the first integral can be evaluated using the gradient theorem ; to evaluate the second , we note that @xmath73 again , the quantity @xmath62 is constant and can be moved outside of the integral , resulting in the following equation for @xmath74 : @xmath75 \\boldsymbol\\lambda_1       + [ \\mathbf{id }   - \\frac{\\mathbf u}{2 } ( \\mathbf u \\cdot { } ) ] |\\mathbf u \\times { { \\mathbf r}}_1|^2 \\boldsymbol\\eta_1\\ ] ] in this equation @xmath74 appears on both sides ; to solve for it we need to invert the matrix @xmath76 .",
    "it is straightforward to verify that @xmath77 and therefore we obtain the desired formula @xmath78 |\\mathbf u \\times { { \\mathbf r}}_1|^2 \\boldsymbol\\eta_1({{\\mathbf r}}_1 , { { \\mathbf r}}_2 )   \\big]\\ ] ]",
    "gradient theorem : @xmath79"
  ],
  "abstract_text": [
    "<S> in this paper we present a method to accurately compute the energy of the magnetostatic interaction between linearly ( or uniformly , as a special case ) magnetized polyhedrons . </S>",
    "<S> the method has applications in finite element micromagnetics , or more generally in computing the magnetostatic interaction when the magnetization is represented using the finite element method ( fem ) .    </S>",
    "<S> the magnetostatic energy is described by a six - fold integral that is singular when the interaction regions overlap , making direct numerical evaluation problematic . to resolve the singularity , </S>",
    "<S> we evaluate four of the six iterated integrals analytically resulting in a 2d integral over the surface of a polyhedron , which is nonsingular and can be integrated numerically . </S>",
    "<S> this provides a more accurate and efficient way of computing the magnetostatic energy integral compared to existing approaches .    </S>",
    "<S> the method was developed to facilitate the evaluation of the demagnetizing interaction between neighouring elements in finite - element micromagnetics and provides a possibility to compute the demagnetizing field using efficient fast multipole or tree code algorithms . </S>"
  ]
}