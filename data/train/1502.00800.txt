{
  "article_text": [
    "the main objective of this note is to demonstrate the advantage of schemes which are well balanced for moving water equilibrium , over those which are only well balanced for still water , for small perturbations of the moving water equilibrium for the shallow water equations .",
    "well - balanced schemes refer to those schemes which have zero truncation error for certain steady - state solutions of hyperbolic balance laws @xmath0 that is , for certain non - trivial functions @xmath1 satisfying @xmath2 the well balanced schemes do not have any truncation error . note that in general @xmath1 is unknown and is not a polynomial , thus to require a zero truncation error is a difficult task .    for shallow water equations ,",
    "there are typically two classes of well - balanced schemes , namely those which are well balanced for still - water equilibrium , where the velocity is zero , and those which are well balanced for general moving - water equilibrium .",
    "a scheme which belongs to the latter class is more difficult to construct .",
    "we refer to @xcite for a recently developed high - order accurate finite volume weighted essentially non - oscillatory ( weno ) scheme which is well balanced for general moving - water equilibrium .",
    "discussions on the history of the development of well balanced schemes for shallow water equations , with an extensive reference list , can be found in @xcite .",
    "since it is much more difficult to construct well - balanced schemes for moving - water equilibrium than for still water , a natural question is whether the former has any advantage over the latter .",
    "however , to our best knowledge , examples to show this advantage seem to be absent in the literature . in the castro urdiales meeting for which this special issue is dedicated to",
    ", there was an intense discussion on this issue but no such examples were provided in the discussion .",
    "the purpose of this note is therefore to provide carefully selected numerical examples to demonstrate the advantage of well - balanced schemes for moving - water equilibrium over well - balanced schemes for still water .",
    "these examples have solutions which contain small perturbations from a moving - water equilibrium . a well - balanced scheme for still water would generate spurious oscillations at the level of the truncation error of the scheme , until the mesh is extremely refined .",
    "on the other hand , a well - balanced scheme for the moving - water equilibrium could resolve these small perturbations on much coarser meshes .",
    "these examples clearly demonstrate the advantage of well - balanced schemes for moving - water equilibrium .",
    "we shall use the high order finite volume weno schemes in @xcite , which are well balanced for still water , and those in @xcite , which are well balanced for moving water , in the numerical tests .",
    "in one space dimension , the shallow water equations take the form @xmath3 where @xmath4 denotes the water height , @xmath5 is the velocity of the fluid , @xmath6 represents the bottom topography and @xmath7 is the gravitational constant . the still - water ( also referred as lake at rest ) steady state",
    "is given by @xmath8 which represents a still flat water surface .",
    "the general moving - water steady state is given by @xmath9 we introduce the notation @xmath10 for the conservative variables , with the superscript @xmath11 denoting the transpose , and @xmath12 for the equilibrium variables .",
    "we refer to @xcite for the variable transformation between @xmath13 and @xmath14 .",
    "the computational domain is discretized into cells @xmath15 $ ] , @xmath16 .",
    "we denote the size of the @xmath17-th cell by @xmath18 and the center of the cell by @xmath19 .",
    "let @xmath20 denote the cell average of @xmath21 over the cell @xmath22 .",
    "the computational variables are @xmath23 , which approximate the cell averages @xmath24 at the time @xmath25 . for the ease of presentation , we denote the shallow water equations ( [ main1 ] ) by @xmath26      many high - order well - balanced methods for the still - water steady state solution ( [ stationary ] ) have been developed in the literature for the shallow water equations , see for example @xcite for a list of references . in this note",
    ", we will use the fifth - order finite volume weno methods based on the separation of the source terms developed in xing and shu @xcite . in this subsection",
    ", we briefly review this well - balanced scheme in one dimension .",
    "we refer to @xcite for further details .",
    "we first reconstruct the point values @xmath27 at the cell interface from the given cell averages @xmath28 by the standard weno reconstruction procedure , which can be eventually written out as @xmath29 where @xmath30 for the fifth order weno approximation and the coefficients @xmath31 and @xmath32 depend nonlinearly on @xmath33 .",
    "now we freeze the cell averages @xmath33 and the corresponding coefficients @xmath31 and @xmath32 . with these fixed coefficients ,",
    "we apply the _ linear _ operators @xmath34 to @xmath35 to compute the reconstructed values @xmath36 .",
    "assume @xmath37 is the still - water steady state solution satisfying ( [ stationary ] ) , we clearly have @xmath38    the main idea in constructing well - balanced methods is to decompose the integral of the source term into a sum of several terms , then compute each of them in a way consistent with the approximation for the corresponding flux terms .",
    "we first rewrite the shallow water equations ( [ main1 ] ) as @xmath39 for which the semi - discrete numerical method takes the form @xmath40 where @xmath41 is a numerical flux , such as the lax - friedrichs flux @xmath42,\\ ] ] with @xmath43 .",
    "the first component of the source term approximation @xmath44 is zero , and the second component is given by @xmath45 with @xmath46 and @xmath47 .",
    "we have developed high - order well - balanced finite volume weno schemes for the moving - water equilibrium ( [ steady ] ) for the shallow water equations in @xcite . in this subsection",
    ", we briefly review these methods and refer to @xcite for further details .    at each time step",
    ", we first apply the usual weno reconstruction procedure to the cell averages @xmath28 , and obtain @xmath27 , hence @xmath48 .",
    "given the cell averages @xmath49 and a bottom function @xmath50 , we choose local reference values @xmath51 of the equilibrium variables .",
    "these are defined implicitly by the requirement that @xmath52 relation chooses @xmath53 as the unique ( see the paragraphs preceding ( * ? ? ?",
    "* def.3.2 ) ) local equilibrium such that the corresponding conserved variables @xmath54 have the same cell average @xmath28 as the numerical data .",
    "it is proven in ( * ? ? ?",
    "* def.3.2 ) that , if the data @xmath55 and @xmath50 are in local equilibrium ( @xmath56 for all cells @xmath22 ) , the reference equilibrium states @xmath53 computed via coincide with the true local steady state @xmath57 . the reconstruction is completed by limiting the reconstruction @xmath48 with respect to the reference values @xmath53 ( see ( * ? ? ? * ( 3.18 ) ) ) , to obtain the limited values @xmath58 and @xmath59 .",
    "the fourth - order well - balanced scheme is given by @xmath60 where the function @xmath61 is a conservative , lipschitz continuous numerical flux , and @xmath62    the total source term @xmath63 is given by @xmath64 where @xmath65 .",
    "the extrapolated interior source term @xmath66 is defined by @xmath67 and the well - balanced quadrature of the source term @xmath68 is given by @xmath69 where @xmath70 is given by ( * ? ? ?",
    "* ( 3.63)-(3.65 ) ) .",
    "in this section we present numerical results of both moving - water well - balanced methods and still - water well - balanced methods presented in section [ sec : lakeatrest ] , for a carefully selected set of test examples in one dimension .",
    "comparison of these results is provided as a demonstration of the advantage of moving - water well - balanced methods . in all the examples ,",
    "time discretization is by the classical third - order total variation diminishing ( tvd ) runge - kutta method @xcite , and the cfl number is taken as 0.6 .",
    "the gravitation constant @xmath7 is taken as 9.812@xmath71 .",
    "our initial conditions are given by imposing a small perturbation of size @xmath74 on the height of these steady states in the interval @xmath75 $ ] .",
    "theoretically , this disturbance should split into two waves , propagating to the left and right respectively .",
    "note that in @xcite , we have shown the numerical results of the moving - water well - balanced methods with a perturbation size @xmath76 , which demonstrate that these small perturbations are well captured . here",
    "we provide the numerical results of both the moving - water well - balanced methods and still - water well - balanced methods , and demonstrate the different behavior of these two methods .",
    "the initial condition is given by : @xmath77 together with the boundary condition that the discharge @xmath78=4.42 is imposed at upstream and the water height @xmath4=2 is imposed at downstream when the flow is subcritical .",
    "we run the tests with 100 uniform cells until @xmath79 , when the downstream - traveling water pulse has already passed the bump .",
    "the differences between the water height @xmath4 at that time and the background moving water state , are shown in figure [ f1 ] .",
    "the result of the still - water well - balanced method is plotted on the left and that of the moving - water well - balanced method is shown on the right .",
    "the difference can be easily observed , as there are significantly more spurious oscillations generated by the still - water well - balanced method . as we refine the mesh to @xmath80 cells ,",
    "the results are shown in figure [ f2 ] .",
    "because @xmath81 is now very small , the perturbation is relatively big in comparison with truncation errors of the schemes and can be well captured by both methods .     at time @xmath79 and",
    "the background moving steady state water height ( [ eq : subcritical ] ) , when 100 uniform cells are employed .",
    "an initial perturbation of size @xmath74 is imposed between @xmath75 $ ] .",
    "left : result based on still - water well - balanced scheme .",
    "right : result based on moving - water well - balanced scheme.,title=\"fig:\",width=307 ]   at time @xmath79 and the background moving steady state water height ( [ eq : subcritical ] ) , when 100 uniform cells are employed .",
    "an initial perturbation of size @xmath74 is imposed between @xmath75 $ ] .",
    "left : result based on still - water well - balanced scheme .",
    "right : result based on moving - water well - balanced scheme.,title=\"fig:\",width=307 ]        the initial condition is given by : @xmath82 together with the boundary condition that the discharge @xmath78=1.53 is imposed at upstream and the water height @xmath4=0.66 is imposed at downstream when the flow is subcritical .",
    "we run the tests with 100 uniform cells until @xmath79 , when the downstream - traveling water pulse has already passed the bump .",
    "the differences between the water height @xmath4 at that time and the background moving water state , are shown in figure [ f3 ] .",
    "again , the difference can be easily observed , as there are significantly more spurious oscillations generated by the still - water well - balanced method .",
    "as we refine the mesh to @xmath80 cells , the results in figure [ f4 ] show resolved solutions for both methods .     at time @xmath79 and the background moving steady state water height ( [ eq : transhock ] ) , when 100 uniform cells are employed .",
    "an initial perturbation of size @xmath74 is imposed between @xmath75 $ ] .",
    "left : result based on still - water well - balanced scheme .",
    "right : result based on moving - water well - balanced scheme.,title=\"fig:\",width=307 ]   at time @xmath79 and the background moving steady state water height ( [ eq : transhock ] ) , when 100 uniform cells are employed .",
    "an initial perturbation of size @xmath74 is imposed between @xmath75 $ ] .",
    "left : result based on still - water well - balanced scheme .",
    "right : result based on moving - water well - balanced scheme.,title=\"fig:\",width=307 ]          we run the tests with 200 uniform cells until @xmath84 .",
    "the differences between the water height @xmath4 at that time and the background moving water state , are shown in figure [ f5 ] .",
    "once again , the difference can be easily observed , as there are significantly more spurious structures generated by the still - water well - balanced method . as we refine the mesh to @xmath80 cells ,",
    "the results are shown in figure [ f6 ] . even at this resolution",
    "there is still an advantage using the moving - water well - balanced method .",
    "note that near the point @xmath85 there is a big displacement for both methods , as we recall that @xmath86 is the position where the shock is located .     at time @xmath84 and the background moving steady state water height ( [ eq : transhock1 ] ) , when 200 uniform cells are employed .",
    "an initial perturbation of size @xmath74 is imposed between @xmath75 $ ] .",
    "left : result based on still - water well - balanced scheme .",
    "right : result based on moving - water well - balanced scheme.,title=\"fig:\",width=307 ]   at time @xmath84 and the background moving steady state water height ( [ eq : transhock1 ] ) , when 200 uniform cells are employed .",
    "an initial perturbation of size @xmath74 is imposed between @xmath75 $ ] . left : result based on still - water well - balanced scheme .",
    "right : result based on moving - water well - balanced scheme.,title=\"fig:\",width=307 ]          we keep the main setup the same as in section [ sec : n1 ] , and impose a smaller perturbation of size @xmath87 to these steady states . to save space , only the results of the subcritical flow ( [ eq : subcritical ] ) are shown .",
    "the differences between the water height @xmath4 at that time and the background moving water state , when 100 uniform cells are used , are plotted in figure [ f11 ] .",
    "we also show the differences of the momentum @xmath88 in figure [ f21 ] .",
    "these figures clearly demonstrate that the still - water well - balanced method is not capable of capturing such a small perturbation on the coarse mesh , as large spurious oscillations are observed . as we refine the meshes to 200 cells ,",
    "the results are shown in figures [ f12 ] and [ f22 ] , where spurious oscillations for the still - water well - balanced method have a reduced magnitude , but its performance is still significantly inferior to that of the moving - water well - balanced method .",
    "the results with @xmath80 cells are shown in figures [ f13 ] and [ f23 ] . even though the difference between the two methods is now significantly reduced ,",
    "the advantage of the moving - water well - balanced method can still be observed on such a refined mesh .     at time @xmath79 and the background moving steady state water height ( [ eq : subcritical ] ) , when 100 uniform cells are employed .",
    "an initial perturbation of size @xmath87 is imposed between @xmath75 $ ] .",
    "left : result based on still - water well - balanced scheme .",
    "right : result based on moving - water well - balanced scheme.,title=\"fig:\",width=307 ]   at time @xmath79 and the background moving steady state water height ( [ eq : subcritical ] ) , when 100 uniform cells are employed .",
    "an initial perturbation of size @xmath87 is imposed between @xmath75 $ ] .",
    "left : result based on still - water well - balanced scheme .",
    "right : result based on moving - water well - balanced scheme.,title=\"fig:\",width=307 ]     at time @xmath79 and the background moving steady state water height ( [ eq : subcritical ] ) , when 100 uniform cells are employed .",
    "an initial perturbation of size @xmath87 is imposed between @xmath75 $ ] .",
    "left : result based on still - water well - balanced scheme .",
    "right : result based on moving - water well - balanced scheme.,title=\"fig:\",width=307 ]   at time @xmath79 and the background moving steady state water height ( [ eq : subcritical ] ) , when 100 uniform cells are employed .",
    "an initial perturbation of size @xmath87 is imposed between @xmath75 $ ] . left : result based on still - water well - balanced scheme .",
    "right : result based on moving - water well - balanced scheme.,title=\"fig:\",width=307 ]            the first author is a contractor [ ut - battelle , manager of oak ridge national laboratory ] of the u.s .",
    "government under contract no .",
    "de - ac05 - 00or22725 .",
    "accordingly , the u.s .",
    "government retains a non - exclusive , royalty - free license to publish or reproduce the published form of this contribution , or allow others to do so , for u.s .",
    "government purposes .",
    "s. noelle , y. xing and c .- w .",
    "shu , _ high order well - balanced schemes _ , to appear in numerical methods for relaxation systems and balance equations , g. puppo and g. russo , editors , quaderni di matematica , dipartimento di matematica , seconda universita di napoli , italy .",
    "y. xing and c .- w .",
    "shu , _ high order well - balanced finite volume weno schemes and discontinuous galerkin methods for a class of hyperbolic systems with source terms _ , j. comput .",
    "214 ( 2006 ) , 567 - 598 ."
  ],
  "abstract_text": [
    "<S> this note aims at demonstrating the advantage of moving - water well - balanced schemes over still - water well - balanced schemes for the shallow water equations . </S>",
    "<S> we concentrate on numerical examples with solutions near a moving - water equilibrium . for such examples , still - water well - balanced methods are not capable of capturing the small perturbations of the moving - water equilibrium and may generate significant spurious oscillations , unless an extremely refined mesh is used . on the other hand , moving - water well - balanced methods perform well in these tests . </S>",
    "<S> the numerical examples in this note clearly demonstrate the importance of utilizing moving - water well - balanced methods for solutions near a moving - water equilibrium .    </S>",
    "<S> * on the advantage of well - balanced schemes for moving - water equilibria of the shallow water equations *    yulong xing , chi - wang shu and sebastian noelle    * keywords : * shallow water equation , still water , moving water equilibrium , high order accuracy , well - balanced scheme </S>"
  ]
}