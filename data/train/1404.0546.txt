{
  "article_text": [
    "radially propagating filaments elongated along magnetic field lines are responsible for a major part of particle density , momentum , and energy cross - field transport in the scrape - off - layer ( sol ) in tokamaks@xcite .",
    "these filaments are widely known as blobs in l - mode operation and elm filaments in h - mode operation .",
    "the particle density amplitude of such structures compared to the background density can be well above unity @xcite .",
    "this can be seen as a consequence of the non - local nature of blobs .",
    "blobs are born in the vicinity of the last closed flux surface , where the plasma is denser , hotter , and has steeper gradients than in the sol region@xcite .",
    "furthermore , in the sol region the ion temperature can be equal to or even higher than the electron temperature @xcite .    despite these facts ,",
    "most existing simulations of seeded blob dynamics are based on models invoking a thin layer approximation @xcite .",
    "essentially , the thin - layer approximation linearizes the charge balance equation assuming that the ion mass entering the polarization density is constant .",
    "sometimes this approximation is called boussinesq - approximation , a term more commonly found in the context of thermal convection in ordinary fluids .",
    "in fact , there are close similarities between thermal convection in fluids and the interchange motion in magnetically confined plasmas@xcite .",
    "we refer to these models as `` local '' models .",
    "the linearization is done to avoid severe costs in runtime and/or major challenges in algorithmic development for the solution of the nonlinear polarization equation in the form of a generalized poisson problem . for this kind of problem fast fourier methods , which are highly effective for linear problems ,",
    "are inefficient .",
    "our work is based on a `` global '' model derived from the full - f gyrokinetic equations @xcite retaining the full nonlinear polarization density .",
    "we use discontinuous galerkin methods@xcite to discretize spatial derivatives .",
    "these methods have been developed during the last decades and received increasing attention from the numerical community@xcite .",
    "they are very versatile in the choice of the desired order of accuracy , and they retain a high degree of parallelism in the resulting algorithm . we exploit this in an implementation for gpus and are thus able to efficiently solve the nonlinear polarization equation in each timestep .    in the past",
    "mostly local drift - fluid models without flr effects were used for seeded blob simulations @xcite . yet , there has also been efforts to incorporate the fully nonlinear polarization density @xcite , or at least a reduced form of it@xcite , into these models .",
    "@xcite showed that the cross - field transport is enhanced by the nonlinear polarization equation compared to its reduced form . in @xmath0d simulations the blob",
    "is affected by drift - waves , which dominate the cross field transport @xcite .",
    "@xcite focussed on deriving scaling laws for the blob velocity , which for small amplitudes increases with the square root of blob width and amplitude .",
    "moreover , the effects of sheath dissipation and dynamical friction on blob motion were investigated .",
    "@xcite estimated the velocity scalings for warm ions .",
    "none of these works , however , discussed energetic consistency of the underlying model .",
    "the influence of flr effects on the convection of seeded blobs was investigated in ref.@xcite .",
    "a local , energetically consistent gyrofluid model was used .",
    "it was shown that flr effects can have a profound influence on the cross - field blob transport in certain parameter regimes .",
    "in particular , flr effects brake the poloidal up - down symmetry in the particle density field and reduce fragmentation compared to the zero larmor radius limit .    here , we present seeded blob simulations using a global gyrofluid model including flr effects , which allows studies of the cross - field transport of high amplitude , finite ion temperature blobs .",
    "we investigate transport properties and , furthermore , compare our global model with a local model in order to test the validity of the thin - layer approximation .",
    "this paper is organized as follows : in section [ sec : global ] we introduce the `` global '' gyrofluid model equations as well as a mass and an energy theorem .",
    "we then discuss `` local '' model equations in section [ sec : local ] that we use to investigate the implications of lifting the thin - layer approximation and derive the correspondence to existing isothermal drift - fluid models in [ sec : comparison ] . in section [ sec : simulations ] we present results of seeded blob simulations .",
    "in section [ sec : zlr ] we discuss the cold ion limit , in which flr effects are eliminated .",
    "then we explore the parameter range where flr effects dominate the blob evolution in section [ sec : flr ] .",
    "we present results of global , hot ion , and high amplitude simulations in section [ sec : high ] .",
    "we conclude in [ sec : conclusion ] .",
    "gyrofluid models@xcite emerge when taking gyrofluid moments of the gyrokinetic vlasov - maxwell equations@xcite .",
    "gyrokinetic models describe low - frequency turbulence in strongly magnetized plasmas .",
    "gyrokinetic theory was developed to decouple the fast gyration time - scale present in turbulent fusion plasmas while retaining important finite larmor radius ( flr ) effects and thereby significantly reduces the computational requirements for numerical simulations .",
    "the exact gyrokinetic system is highly complex , so for practical applications@xcite limiting forms are used .",
    "generally , two paths have been pursued : 1 ) delta - f models , in which gyrokinetic distribution functions are split into stationary background and small perturbed parts and 2 ) full - f models , in which finite larmor radius ( flr ) corrections to the polarization and magnetization densities in maxwell equations are neglected , but in which the gyrokinetic distribution functions are not linearized .",
    "no a priori assumptions about fluctuation amplitudes are made in full - f models .",
    "full - f models are therefore well suited for studies of edge and scrape - off - layer turbulence and the associated transport in magnetically confined fusion plasmas .      here",
    ", we will use a gyrofluid model@xcite derived from the full - f gyrokinetic model .",
    "the gyrofluid model retains all relevant nonlinearities including the full nonlinear polarization density , while also retaining flr effects .",
    "the gyrofluid model therefore allows us to investigate the interchange dominated convection of plasma filaments having large amplitudes and finite ion temperatures .",
    "we restrict ourselves to a simple paradigmatic two - field model , which describes the time evolution of the electron particle density @xmath1 and the ion gyrocenter density @xmath2 in a simple , quasi - neutral , isothermal , electrostatic plasma in the plane perpendicular to the magnetic field @xmath3 at the outboard midplane .",
    "parallel dynamics along magnetic field lines as well as sheath boundary physics are absent from the model .",
    "we employ a right - handed slab geometry with orthonormal unit vectors @xmath4 with @xmath5 aligned with the magnetic field and @xmath6 anti - parallel to the magnetic field gradient .",
    "the inverse magnetic field strength is given as @xmath7 , where @xmath8 is the radial distance to the inner edge of the plane at the outboard mid - plane .",
    "the equations appear as    [ eq : gf_slab ] @xmath9    where @xmath10 and @xmath11 denote electron and ion temperature , respectively , @xmath12 is the collisional diffusion coefficient , @xmath13 , and @xmath14 .",
    "the @xmath15-advection terms are written in terms of poisson brackets , which for two arbitrary functions @xmath16 and @xmath17 are defined as @xmath18 the compressibility of the perpendicular fluxes is described by the operator @xmath19 with @xmath20 .",
    "the third and fourth terms on the left hand side of eq .",
    "( [ eq : elec_cont_slab ] ) represent the compression of the @xmath15and the electron grad - b particle - density - fluxes , respectively .",
    "the latter is equivalent to the compression of the electron diamagnetic particle density flux , which is only finite when the magnetic field is inhomogeneous .",
    "ion flr effects appear in the quasi - neutrality constraint eq .",
    "( [ eq : qn_slab ] ) and in the generalized ion @xmath15-velocity explicitly through the pad approximant @xmath21 to the gyroaveraging operator@xcite , where @xmath22 denotes the thermal ion gyroradius with the constant ion gyrofrequency @xmath23 .",
    "the gyroaveraging operator @xmath24 enters the generalized ion @xmath15-velocity through the generalized potential @xmath25 , where @xmath26 denotes the @xmath15-velocity . the second term on the left hand side of the quasi - neutrality constraint eq .",
    "( [ eq : qn_slab ] ) is the nonlinear polarization density , which is the gyrofluid representation of ion inertia i.e. the ion polarization drift .",
    "the first term is the gyroaveraged charge contribution of ion gyroorbits belonging to gyrocenters described by @xmath2 .",
    "the right hand side describes the electron charge contribution .",
    "the time - evolution of the total particle and ion gyrocenter densities is governed by @xmath27 where @xmath28 is the total simulation domain . in the absence of diffusion , @xmath1 as well as @xmath2 are therefore conserved .    to derive the energy conserved by the gyrofluid equations ( [ eq : gf_slab ] ) , the electron particle density equation ( [ eq : elec_cont_slab ] ) is multiplied by @xmath29 and is integrated over space . in the same way",
    ", the ion gyrocenter density equation ( [ eq : ion_cont_slab ] ) is multiplied by @xmath30 and is integrated over space .",
    "the equations are integrated by parts and surface terms are dropped .",
    "note that the gyroaveraging operator @xmath24 is self - adjoint .",
    "summing the resulting equations and using the quasi - neutrality constraint eq .",
    "( [ eq : qn_slab ] ) , the energy invariant becomes @xmath31 the electron helmholtz free energy @xmath32 and the ion helmholtz - free - like energy @xmath33 are given as @xmath34 the ion gyrocenter density @xmath2 can be expressed in terms of @xmath1 and @xmath35 through the quasi - neutrality constraint eq .",
    "( [ eq : qn_slab ] ) .",
    "therefore , @xmath33 describes ion helmholtz free energy only to lowest order and will inevitably also include @xmath35-dependent terms .",
    "the @xmath15-energy is defined as @xmath36 an essential observation is that the full ion gyrocenter density @xmath2 enters @xmath37 . in delta - f",
    "based models the ion gyrocenter density entering the @xmath15-energy is constant and hence weighs all ion gyrocenter densities equally .",
    "this approximation is crude in the presence of high amplitude plasma filaments . finally",
    ", energy dissipation due to particle density diffusion and ion gyrocenter diffusion becomes @xmath38 \\nu \\nabla_{\\perp}^2 n      -\\big[e\\phi - t_e(1+\\ln n)\\big ] \\nu \\nabla_{\\perp}^2 n. \\end{aligned}\\ ] ]      in most previous works local models were used to investigate the convection of seeded blobs@xcite .",
    "here , we denote a model `` local '' when the polarization density is linearized . in order to quantify how the nonlinear polarization influences blob convection and in order to determine in which regimes local models are valid , we compare the global model eqs .",
    "( [ eq : gf_slab ] ) with the following local gyrofluid model@xcite    [ eq : gf_local ] @xmath39    where the gyroaverage operator @xmath40 describes local finite inertia effects as well as higher order flr corrections to the polarization drift@xcite ; @xmath41 = @xmath42 denote constant reference particle and ion gyrocenter densities , respectively .",
    "we explicitly denote the local electron and ion gyrocenter densities @xmath43 and @xmath44 in order to distinguish local and global gyrofluid models .",
    "we stress that the thin - layer approximation is invoked in the model , which can be seen from the polarization density in eq .",
    "( [ eq : qn_local ] ) , which in the long wavelength limit ( lwl ) equals @xmath45 . in the absence of collisional effects",
    "the local gyrofluid model@xcite is a superset of local drift fluid models e.g. @xcite",
    ". more detailed comparisons between local and global gyrofluid models as well as drift fluid models will be given in the next sections .",
    "gyrofluid models are remarkably simple compared with drift fluid models , which include flr effects e.g.@xcite .",
    "the reason why gyrofluid models are able to retain relatively simple functional forms is that much of the complexities associated with flr effects have been incorporated into the gyrofluid moments themselves through the underlying gyrocenter coordinate transformation .",
    "the downside to the simple functional forms is that the corresponding gyrofluid moments do not directly describe well - known physical quantities like particle density , electric potential etc .",
    "consider the global quasi - neutrality constraint eq .",
    "( [ eq : qn_slab ] ) .",
    "it is clear that we can not express @xmath2 in terms of @xmath1 and @xmath35 on a closed form .",
    "however , in the long wavelength limit ( lwl ) we obtain @xmath46 demonstrating that @xmath2 depends on particle density , the magnetic field - aligned component of the @xmath15-vorticity , and the ion diamagnetic vorticity@xcite .",
    "therefore , it is important always to keep the composite nature of gyrofluid moments in mind whenever gyrofluid models are used to describe plasma dynamics and when gyrofluid models are compared with other models .    to obtain a clearer picture of the dynamics described by the global gyrofluid model given in eq .",
    "( [ eq : gf_slab ] ) , we derive a charge continuity equation .",
    "the charge continuity equation describes the time - evolution of the magnetic field aligned component of the @xmath15-vorticity @xmath47 and is therefore often referred to as the _ vorticity equation_. this global lwl vorticity equation is derived by taking the time derivative of the quasi - neutrality equation ( [ eq : qn_slab ] ) using eq .",
    "( [ eq : n_lwl ] ) to eliminate @xmath2 @xmath48\\nabla_{\\perp}\\phi^*\\bigg )      = \\frac{t_e + t_i}{e}\\mathcal{k}(n ) .",
    "\\label{eq : vorticity}\\end{aligned}\\ ] ] here , diffusive terms are neglected and we have defined @xmath49 the vorticity equation shows that the global gyrofluid model is a superset of corresponding global drift fluid models@xcite in the absence of collisions .",
    "similarly , for the local gyrofluid model eqs .",
    "( [ eq : gf_local ] ) the approximate lwl representation of the ion gyrocenter density becomes @xmath50 which can be used to derive the local lwl vorticity equation @xmath51\\nabla_{\\perp } \\tilde{\\phi}^*\\bigg ) = \\frac{t_e + t_i}{e } \\mathcal{k}(\\tilde",
    "n ) ,           \\label{eq : vortlwl_df_local}\\end{aligned}\\ ] ] where @xmath52 the local vorticity equations equals the drift - fluid vorticity equation@xcite in the absence of collisions , showing that the local gyrofluid model is a superset of corresponding local drift - fluid models .",
    "the right hand sides of the lwl local eq .",
    "( [ eq : vortlwl_df_local ] ) and global eq .",
    "( [ eq : vorticity ] ) vorticity equations are identical .",
    "the right hands sides describe the compression of the electron and ion diamagnetic fluxes and transfer energy between helmholtz free energy end kinetic energy@xcite .",
    "the left hand sides describe the compression of the ion polarization flux , which consists of the magnetic field aligned components of @xmath15-vorticity and ion diamagnetic vorticity .",
    "the ion diamagnetic vorticity , i.e. the ion pressure dependent part , can be shown to be the manifestation of lwl flr effects@xcite in the vorticity equations . in the local model eq .",
    "( [ eq : vortlwl_df_local ] ) the particle density is taken as a constant .",
    "this has two immediate consequences .",
    "first , the nonlinearity @xmath53 entering the global vorticity equation is absent in the local model .",
    "the implications of this `` thin - layer '' approximation is a priori difficult to predict . in the local model ,",
    "if the ions are cold , the early blob evolution is characterized by a poloidal dipole structure in the electric potential , which is @xmath54 phase shifted with respect to the density field . therefore , one could expect that the nonlinearity in the initial phase plays a minor role .",
    "when the ion temperature is finite , the dipole part of the electric field is accompanied by an electric field , which circumferences the density field representing flr effects@xcite .",
    "therefore , the nonlinearity is expected to influence the blob convection even in the initial phase when the ion temperature is finite .",
    "second , in the local model vorticity is everywhere weighted by @xmath41 , which implies that plasma inertia is everywhere constant and therefore independent of the local plasma density .",
    "this approximation enters the `` inertial '' blob velocity scaling estimated by dimensional analysis@xcite , which in previous works has shown good agreement with numerical simulations in the high reynolds number regime . neglecting the nonlinearity , the inertial scaling emerges by balancing the electric field dependent part of the vorticity with the compression of the diamagnetic flux .",
    "the resulting local and global perpendicular velocity scalings become    @xmath55    [ eq : velocity_scaling ]    here , @xmath56 is the blob amplitude , @xmath57 is the acoustic speed , and @xmath58 denotes the characteristic blob size",
    "( [ eq : velocity_scaling ] ) also defines the interchange rates @xmath59 the global scaling reduces to the local velocity scaling@xcite for small perturbation amplitudes @xmath60 , which predicts a scaling @xmath61 .",
    "the local and global scalings predict very different blob velocities when @xmath62 .",
    "the local scaling does not differentiate small or high perturbation amplitudes , whereas the global scaling predicts that the blob velocity asymptotically approaches @xmath63 .",
    "another difference between the global and the local models is that the diamagnetic part of the vorticity is linearized in the local model ( see eq .",
    "( [ eq : gradphilocal ] ) ) , whereas the corresponding diamagnetic term in the global model has a logarithmic dependence . since the diamagnetic vorticity is the representation of flr effects in the vorticity equation , the local model could potentially overestimate the importance of flr effects in the presence of high fluctuation amplitudes .",
    "finally , we note a distinct difference between the local and the global model regarding the extent to which flr corrections are made to the polarization density . by taking the low - amplitude limit of the global polarization equation ( [ eq : qn_slab ] ) ,",
    "the local polarization equation ( [ eq : qn_local ] ) is not recovered because flr corrections residing in the `` @xmath64 '' operator in the local quasi - neutrality constraint eq .",
    "( [ eq : qn_local ] ) are not included in the global model .",
    "the local model is therefore more precise than the global model when gradient length scales are comparable to the ion gyroradius and amplitudes are small .",
    "gyrokinetic models , which can handle large fluctuations amplitudes and gradient length scales comparable to the ion gyroradius , have been formulated@xcite",
    ". however , compared with traditional nonlinear gyrokinetic models , these extended models are significantly more complex .",
    "gyrofluid models based on extended gyrokinetic models have not been derived yet .",
    "in this section we present results from numerical simulations of the local gyrofluid model eqs .",
    "( [ eq : elec_cont_local])-([eq : qn_local ] ) and the global gyrofluid model eqs .",
    "( [ eq : elec_cont_slab])-([eq : qn_slab ] ) . all results in this section",
    "describe simulations of blobs initialized as @xmath65 where @xmath58 is the initial blob width , ( @xmath66 , @xmath67 ) the initial position , and @xmath56 the initial blob amplitude . in this way the potential @xmath68 via the polarization equation .",
    "the simulation domain is a square box @xmath69 \\times [ 0,l]$ ] , where the box size is set to @xmath70 in order to mitigate the influence of the boundaries . for the global gyrofluid model",
    "the @xmath71 boundaries are periodic , whereas dirichlet boundary conditions are chosen at the @xmath72 boundaries    @xmath73    the local gyrofluid model is solved on a doubly periodic domain .    in order to solve eqs .",
    "( [ eq : gf_slab ] ) , we use discontinuous galerkin ( dg ) methods @xcite to discretize spatial derivatives .",
    "the dg methods have the advantage of being high order accurate and parallelizable .",
    "the nonlinear generalized poisson equation ( [ eq : qn_slab ] ) translates into a symmetric algebraic equation@xcite , which we solve via a conjugate gradient method .",
    "the resulting algorithm is very well suited for current parallel hardware architectures .",
    "our gpu implementation thus allows to solve the nonlinear polarization equation efficiently .",
    "in time we use an explicit adams - bashforth multistep method of @xmath0rd order .",
    "we carefully verified our global code with the help of the conservation equations ( [ eq : mass_balance ] ) and ( [ eq : energy_balance ] ) .",
    "in addition , we made quantitative convergence tests in the @xmath74-norm of density and potential . with @xmath75 grid cells , using third order polynomials in each cell , we ensured that convergence is very well reached in our global simulations .",
    "note that third order polynomials are defined by @xmath76 coefficients , which makes a total of @xmath77 discretization points .",
    "for the local model ( [ eq : gf_local ] ) we use a pseudospectral scheme@xcite combined with a @xmath78nd order discretization for the poisson brackets @xcite .",
    "the diffusive part is integrated implicitly .",
    "the local simulations use @xmath79 grid points , which also ensures convergence for all parameters discussed .",
    "we scanned the parameter space varying @xmath80 , the initial blob width @xmath58 and the initial amplitude @xmath56 .",
    "when comparing global to local simulations , we use equal physical parameters and initial conditions .",
    "the major radius is set to @xmath81 with @xmath82 .",
    "we fix the ratio of the effective gravity to the dissipative forces @xmath83 and thereby determine the diffusion coefficient @xmath12 given blob width and amplitude .",
    "note that we also tried to fix the diffusive coefficient to @xmath84 and found only marginal differences compared to the results presented here .",
    "this means that we are well in the high reynolds number regime .",
    "the initial blob position is @xmath85 , @xmath86 , and we simulate from @xmath87 to @xmath88 ( both local and global simulations ) using approximately @xmath89 timesteps . unless otherwise indicated , we fix these parameters throughout the rest of this paper",
    ".      first , we present results from simulations with @xmath90 .",
    "the gyroaveraging operators reduce to @xmath91 and @xmath92 , respectively , and hence flr effects are absent from the models . in this limit",
    "the global model eqs .",
    "( [ eq : gf_slab ] ) is a superset of the local model eqs .",
    "( [ eq : gf_local ] ) .",
    "therefore , the global model can be used to test the validity of the local model in this limit . for small amplitudes",
    "we expect the global and local models to show similar results .",
    "in fact we can use the limit @xmath93 as a consistency check for our numerical implementations .",
    "we first raise the question whether the nonlinearity qualitatively changes the blob evolution into a mushroom like structure , which was observed previously in local models@xcite .",
    "[ fig : t0s10a040_global ] shows a global simulation with initial blob width @xmath94 and amplitude @xmath95 .",
    "what is shown are contour plots of the particle density and the magnetic field - aligned component of the @xmath15-vorticity @xmath96 .",
    "here and in following plots we always show the total simulation domain of @xmath97 . in the initial phase of the evolution the interchange drive term creates a vorticity dipole that accelerates the blob radially .",
    "the dipole accelerates the blob center faster in the radial direction than the blob front and its edges .",
    "this then leads to a steepening and vertical stretching of the blob front .",
    "the resulting short length scales are subject to strong diffusion , which in turn leads to a decay of the maximum amplitude .",
    "the ultimate result is the characteristic mushroom shape with a fast moving blob cap and two lobes that roll - up and are subject to turbulent mixing . a thorough discussion of these phenomena is given in ref .",
    "@xcite .",
    "we observe that all our global simulations for zero ion temperature retain this behaviour , in particular the up - down symmetry as seen in fig .",
    "[ fig : t0s10a040_global ] .",
    "the reason is that the nonlinearity @xmath98 in the polarization equation ( [ eq : qn_slab ] ) is small since gradients in @xmath2 and @xmath35 are mostly perpendicular .",
    "note that both the local , as well as the global model contain the symmetry braking term @xmath99 .",
    "this is seen by considering the symmetries in the equations ( [ eq : elec_cont_slab ] ) with ( [ eq : vorticity ] ) and ( [ eq : elec_cont_local ] ) together with ( [ eq : vortlwl_df_local ] ) respectively .",
    "this term is however small as long as @xmath100 .    in order to determine",
    "if and what `` global effects '' are present in our simulations , we need to present more quantitative results .",
    "we show radial profiles taken at the symmetry axis @xmath101 in fig .",
    "[ fig : t0s10a020_radial ] , where we compare a global high amplitude simulation to a simulation of the local model with equal parameters .",
    "note that we reset the origin of the coordinate system to the initial blob position .",
    "we observe that the global blob is actually much slower than the local blob in the initial phase of the evolution .",
    "we also observe a weaker radial density gradient at the global blob front when compared to the very steep local one .",
    "this results in a reduced particle density diffusion for the global blob .",
    "while the global blob keeps a high maximal amplitude at later times , the local blob quickly looses more than half of its initial amplitude and slows down .",
    "both blobs thus travel almost the same distance after @xmath102 , yet at this point in time the amplitude of the global blob is twice as high as the local one . we conclude that the global model must indeed be used to simulate blob convection in this regime .    to quantify our findings further , we plot the maximum amplitude and the radial maximum amplitude position for various initial amplitudes in fig . [ fig : t0s10_ampa ] and [ fig : t0s10_ampb ] respectively . the maximum amplitude at time @xmath103 is @xmath104 , and @xmath105 denotes the corresponding position .",
    "the curves for low amplitudes almost fall on top of each other as expected .",
    "we observe that in both the local and the global model the amplitude is reduced with time for all initial amplitudes .",
    "however , the amplitude in the local model is clearly smaller when compared to the global one , especially for higher initial amplitudes .",
    "we can also confirm that in the initial phase the radial maximum amplitude positions for global blobs lag behind those of local blobs . only at later times",
    "global blobs catch up and the maximum amplitude positions coincide .",
    "the next step in our discussion is to investigate center of mass positions and velocities .",
    "we define the center of mass of a blob by @xmath106 { d\\bm{x}\\,}}\\int { { \\mathbf{x } } } \\left [ n -n_0 \\right ] { d\\bm{x}\\,}.      \\label{eq : com}\\end{aligned}\\ ] ] the center of mass velocity , which is also a measure for the advective @xmath15-flux@xcite , then follows as @xmath107 we plot center of mass velocities of local and global blobs for various amplitudes and fixed blob width @xmath108 in fig .",
    "[ fig : t0s10_global_vx ] .",
    "we used the standard gyro - bohm scaling in fig .",
    "[ fig : t0s10_global_vxa ] .",
    "again , the center of mass velocities for the blobs with the smallest amplitudes almost coincide as expected . in accordance with the radial profiles shown in fig .",
    "[ fig : t0s10a020_radial ] we observe that in the beginning of the blob evolution the high amplitude global blobs accelerate less and thus have lower velocities when compared with local blobs having identical parameters .",
    "the local blobs reach their maximum velocity earlier in their evolution and then quickly decelerate .",
    "the global blobs take longer times to reach their maximal velocities and retain increased speeds in the later phases .",
    "this is in line with the global model using the correct ion inertia , while the local model uses a constant background one .",
    "however , the maximum velocity is slightly reduced for global , high amplitude blobs . in order to test whether blob amplitude variations are captured by the previously derived scaling law for global blob velocities ( [ eq : velocity_scaling_global ] ) , we show the same simulation results using the global interchange rate and velocity as scaling parameters in fig .",
    "[ fig : t0s10_global_vxb ] . the curves do not fall on top of each other as we might have expected , yet the global scaling seems to capture the dynamics fairly well .",
    "kube et al .",
    "@xcite have used a drift fluid model to describe the behaviour of global blobs in the zero ion temperature limit .",
    "the local velocity scaling eq .",
    "( [ eq : velocity_scaling_local ] ) was validated very well for small amplitudes .",
    "we note that their model resembles our model if the term @xmath109 in the polarization equation is neglected and if @xmath110 .",
    "we plot the maximum velocity scaled by the global interchange velocity ( [ eq : velocity_scaling_global ] ) as a function of amplitude in fig .",
    "[ fig : t0_global_vmax ] .",
    "the scaling is apparently flawed as neither for low nor for high amplitudes the curves are constant horizontal lines .",
    "note that @xcite also failed to recover the velocity scaling in the high amplitude regime although even higher amplitudes than ours were used in the simulations .",
    "one reason might be that the amplitude of the blobs can be significantly decreased by the time the maximum velocity is actually reached ( cf . fig .",
    "[ fig : t0s10_ampa ] ) .",
    "the initial amplitude might thus not be the one that should be used for the plot .",
    "the variation in width is well captured for amplitudes higher than @xmath111 .",
    "we remark that @xcite did not vary the blob width , which was absorbed in their scaling .",
    "all in all , we see that the amplitude dependence of the velocity scaling in eq .",
    "( [ eq : velocity_scaling_global ] ) is not well described by the theoretical estimate .",
    "we now discuss simulations taking a constant finite ion temperature into account . local simulations with amplitude @xmath112 including flr effects",
    "were first published in @xcite .",
    "it was found that the blob dynamics is significantly altered by retaining flr effects in the model .",
    "blobs move radially as well as poloidally and stay more coherent compared to zero ion temperature simulations .",
    "our main point in this section is to investigate differences between the local and the global gyrofluid model .",
    "as described in the theory section [ sec : comparison ] , flr corrections to the polarization density are only present in the local model .",
    "these corrections enter as powers of @xmath113 as seen e.g. in eq .",
    "( [ eq : n_lwl_local ] ) . however , only the global model retains the nonlinear polarization density in the polarization equation .    as a first example we choose @xmath114 , @xmath115 , and @xmath112 . from both local and global simulations we plot the particle density and vorticity fields in fig .",
    "[ fig : t4s05a005_density ] and [ fig : t4s05a005_vorticity ] respectively .",
    "we loosely estimate @xmath116 and thus expect only weak flr effects , at least during the first timesteps . from the particle density plots we see that the qualitative blob movement in the initial phase is indeed similar in both cases .",
    "both blobs accelerate radially as well as in the poloidal direction , which in our case is in fact the @xmath117 direction , where @xmath118 points out of the paper ( cf . also @xcite ) .",
    "however , in the later phase of the evolution clear differences can be seen .",
    "the global blob is slower and looses more mass to dissolving vortices that separate from the main blob .",
    "the local blob travels much farther in the radial direction and retains its initial form during the whole simulation period .",
    "also the poloidal movements differ .",
    "the local blob reverses its poloidal velocity twice , the global blob only once .    in fig .",
    "[ fig : t4s05a005_vorticity ] we observe very pronounced differences in the vorticity between the local and the global model .",
    "the local blob quickly develops a strong and highly localized sheared flow around the blob .",
    "note that the color scale for the local case is @xmath119 times higher than that for the global case .",
    "this sheared flow is the reason for the enhanced stability of the blob shape , which is persistent over the whole simulation period@xcite .",
    "the global blob lacks such a violent vorticity roll - up and is thus unable to maintain its shape loosing mass in kelvin - helmholtz like vortices at later times .",
    "moreover , we observe more internal structures in the vorticity field",
    ".    a possible explanation for the observed differences between the local and global vorticity fields could be the absence of the @xmath120 nonlinearity in the local polarization equation ( [ eq : qn_slab ] ) .",
    "we observe that the particle density and the electric potential gradients align at the blob edge .",
    "however , a closer inspection reveals that the particle density amplitude is very small where the gradients align , so the effects of the nonlinearity is expected to be small .",
    "another possible explanation is the absence of flr corrections to the polarization density in the global polarization equation .",
    "these enter the local polarization equation as : @xmath121 .",
    "\\label{}\\end{aligned}\\ ] ] to check whether the differences in the vorticity fields are indeed due to this factor , we repeated our local simulations replacing @xmath122 by a laplacian in equation ( [ eq : qn_local ] ) : @xmath123 we denote this as the modified local model .",
    "we plot the center of mass velocities of local , modified , and global blobs in fig .",
    "[ fig : t4s05_vx ] . as in the zero ion temperature case",
    "the velocity in the initial phase is slightly higher in both local models than in the global model . at later times",
    "we see that the local blob is up to two times faster than its global and modified counterparts . as a side remark",
    "we note that velocity peaks coincide with poloidal turns . the global blob as well as",
    "the modified local blob quickly slows down after the first velocity peak , probably because the surrounding velocity field , which prevents blob fragmentation , is not as strong in the global and modified blob as it is in the local blob ( cf .",
    "[ fig : t4s05a005_vorticity ] ) . from fig .",
    "[ fig : t4s05_vx ] we conclude that the flr corrections to the polarization density are indeed responsible for the different behaviour of local and global blobs in the late phase of the blob evolution .",
    "all in all , we conclude that for low amplitudes , small blob widths , and high ion temperatures , the local model is the preferable model since flr corrections are consistently maintained in the polarization equation , which is not the case in the global model .",
    "we now show global , high amplitude blob simulations with moderate flr effects . in this parameter regime",
    "the local model is not valid .",
    "we reduce the ion temperature and increase the blob width compared to the previous section .",
    "this reduces the ratio of ion gyroradius to gradient length scale , which measures the strength of flr effects as discussed in the previous section .",
    "we exemplarily show contour plots of the particle density and vorticity for @xmath124 , @xmath108 , and @xmath125 in fig .",
    "[ fig : t2s10a020_global ] .",
    "the evolution is best described as a mixture of the high temperature blobs in the last section and the cold ion blobs in section [ sec : zlr ] .",
    "the blob accelerates radially as well as poloidally in the initial phase with the vorticity slightly rolling up .",
    "two side - arms with a pronounced cap develop afterwards , which resembles the mushroom shapes of cold ion blobs . in the poloidal turn the blob becomes stretched and separates from its lobes , streaming upwards thereafter . scanning the parameter range we found that the blob evolution either becomes more mushroom like for low ion temperature and large blob widths or more compact for high ion temperature and small widths . yet , before we come back to this observation of blob shapes , we want to examine radial profiles , maximum amplitude position , and center of mass velocities as we did in section [ sec : zlr ] .",
    "first , we show radial profiles of the plasma density in fig .",
    "[ fig : t2s10a020_radial ] . since the up - down symmetry of the cold ion blobs is broken , we take the profiles at the poloidal maximum amplitude position of the blob .",
    "profiles from local and global models resemble each other . in the vicinity of the maximal particle density",
    "the profiles are approximately gaussian shaped with a fluctuating , low amplitude tail .",
    "there are slightly more fluctuations present in the global curves . when compared to the profiles in fig .",
    "[ fig : t0s10a020_radial ] , where @xmath90 , we see that the low temperature blobs have steeper profiles than the blobs with @xmath126 .",
    "also the loss of maximum amplitude is not as pronounced for the warm ion case as it is for the cold ion case .",
    "furthermore , the local blob always stays ahead of the global one .",
    "next , we plot the maximum amplitude as a function of time in fig . [",
    "fig : t2s10_max_amp ] .",
    "as expected the small amplitude curves coincide .",
    "contrary to fig .",
    "[ fig : t0s10_ampa ] in section [ sec : zlr ] , which is the zero ion temperature version of fig .",
    "[ fig : t2s10_max_amp ] , we find that now local blobs retain their amplitude better than their global counterparts",
    ". with regard to the preceding discussion of blob stability this does not come as a surprise .",
    "local blobs stay coherent during the whole simulation time and keep mass and hence amplitude almost constant .    in order to test the global velocity scaling ( [ eq : velocity_scaling_global ] ) , we examine the radial center of mass velocity as a function of time .    in fig .",
    "[ fig : t2s10a ] we see that the global scaling captures the ion temperature variation very well .",
    "the variation of amplitude is , like in section [ sec : zlr ] , only partly captured . in both figures",
    "we see that the velocity in the initial phase increases almost linearly until it reaches a maximum and decreases again . at about @xmath127",
    "there is a sudden transition where the blob velocity stabilizes at an almost constant value until it finally drops down to smaller values again . when inspecting the particle density plots in fig .",
    "[ fig : t2s10a020_global ] , the transition takes place at the point where the lobes of the blob start to curl and roll up .",
    "the second drop of velocity occurs when the blob starts to fragment at about @xmath128 .",
    "we now come back to the observation that blobs have a tendency to either develop a mushroom shape , to retain a more coherent blob - like structure , or a mixture of both .",
    "we use the definition of blob compactness@xcite @xmath129 where @xmath130 is defined as a heaviside function @xmath131 the integration is thus performed on a circular field of radius @xmath58 around the maximum amplitude position .",
    "@xmath132 is a measure for the ability of the blob to retain its form and mass .",
    "a small compactness means that the blob has lost most of its initial mass or is spread out over a large area .",
    "the mushroom shapes in section [ sec : zlr ] should e.g. have a small compactness .",
    "a high compactness means that the blob preserves its initial particle density .",
    "the high ion temperature blobs in section [ sec : flr ] should correspondingly have a high compactness .    in fig .",
    "[ fig : figure17 ] we show the blob compactness at time @xmath133 as a function of the flr strength modeled by the control parameter @xmath134 @xmath135 is the ratio between the ion gyroradius and the initial gradient length scale , which we have already used in the preceding discussions . in line with the results presented in @xcite we identify a transition between @xmath136 and @xmath137 where @xmath132 increases significantly . for higher values of @xmath135",
    "the compactness constantly fluctuates around @xmath138 for all parameters investigated in this regime . for low values of @xmath135",
    "the compactness is a factor @xmath139 times smaller , showing that blob mass in this regime will rather spread out or diffuse away .",
    "furthermore , blobs with very low flr effects show a significant variation of compactness when amplitude is varied .",
    "the smallest values for @xmath132 in our plot can be observed for the low amplitude @xmath140 .",
    "when amplitude is increased , the blob compactness increases as well .",
    "we remark that the cold ion simulations in section [ sec : zlr ] are found on the left side of the plot at @xmath136 .",
    "the high temperature simulations in [ sec : flr ] are on the far right side , while the simulations presented in this section are found in between .",
    "our plot thus shows that @xmath135 , being a combination of blob parameters @xmath141 , @xmath56 , and @xmath58 only , is a very good indicator of whether a blob can retain its mass during its evolution or not .",
    "we showed that we can numerically solve the nonlinear polarization equation in the context of a mass and energy conserving , 2d gyrofluid model .",
    "the model was used to investigate blob dynamics of seeded blobs in the tokamak scrape - off - layer .",
    "we identified two regimes of blob convection .",
    "blobs , defined as the vicinity of the maximal amplitude position , quickly loose mass in the first and retain their mass in the second regime as they propagate radially .",
    "our simulations indicate that over a wide range of parameters , namely ion temperature , initial blob width , and initial blob amplitude , these two regimes are characterised by the ratio of ion gyroradius to the initial gradient scale length .",
    "this ratio is interpreted as a measure for the strength of flr effects .",
    "blobs with a low ratio belong to the first , blobs with strong flr effects belong to the second regime .    furthermore , we investigated the importance of using a global , fully nonlinear model in contrast to a local thin layer approximation for blob simulations . for low ion temperatures and high blob amplitudes",
    "we find that global blobs stay more coherent and have an increased cross - field transport compared to local model simulations .",
    "the amplitude in global simulations remains significantly higher than in local simulations with equal initial amplitudes .",
    "when the ion temperature is comparable to the electron temperature , global blob simulations show a decreased cross - field transport in comparison with local blob simulations . yet , for low amplitudes we find that the local model is preferable since flr corrections to the polarization density are absent from the global model .",
    "we would like to thank ole meyer for helpful comments on the manuscript .",
    "this work was supported by the austrian science fund ( fwf ) w1227-n16 and y398 , and by the european commission under the contract of association between euratom and aw , carried out within the framework of the european fusion development agreement ( efda ) .",
    "the computational results presented have been achieved in part using the vienna scientific cluster ( vsc ) .",
    "this work was supported by the austrian ministry of science bmwf as part of the uniinfrastrukturprogramm of the focal point scientific computing at the university of innsbruck .",
    "43ifxundefined [ 1 ] ifx#1 ifnum [ 1 ]",
    "# 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]  + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty @noop * * ,   ( ) link:\\doibase 10.1063/1.3594609 [ * * , ( ) ] http://stacks.iop.org/0029-5515/53/i=4/a=043021 [ * * , ( ) ] link:\\doibase 10.1088/0029 - 5515/35/11/i01 [ * * ,   ( ) ] link:\\doibase 10.1063/1.1445179 [ * * ,   ( ) ] link:\\doibase 10.1088/0741 - 3335/52/6/065005 [ * * ,   ( ) ] link:\\doibase    10.1088/0029 - 5515/47/7/017 [ * * ,   ( ) ] link:\\doibase    10.1063/1.3302535 [ * * ,   ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase    10.1088/0741 - 3335/54/8/085009 [ * * , ( ) ] link:\\doibase 10.1016/s0375 - 9601(01)00252 - 3 [ * * ,   ( ) ] link:\\doibase    10.1063/1.3658033 [ * * ,   ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1063/1.4813241 [ * * , ( ) ] link:\\doibase 10.1137/s0036142997316712 [ * * ,   ( ) ] @noop * * ,   ( ) @noop ( ) ,   @noop * * ,   ( ) link:\\doibase 10.1103/physrevlett.108.215002 [ * * ,   ( ) ] link:\\doibase 10.1063/1.2193087 [ * * ,   ( ) ] @noop * * ,   ( ) link:\\doibase 10.1063/1.3647553 [ * * , ( ) ] link:\\doibase 10.1063/1.4704793 [ * * , ( ) ] link:\\doibase 10.1063/1.4824799 [ * * ,   ( ) ] http://stacks.iop.org/1402-4896/38/i=6/a=014 [ * * , ( ) ] @noop * * ,   ( ) link:\\doibase 10.1063/1.3484219 [ * * , ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1063/1.2783993 [ * * , ( ) ] link:\\doibase 10.1139/p98 - 012 [ * * , ( ) ] @noop * * ,   ( ) link:\\doibase 10.1063/1.872368 [ * * ,   ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1063/1.3327211 [ * * , ( ) ] @noop * * ,   ( ) @noop * * ,   ( )"
  ],
  "abstract_text": [
    "<S> we present results from simulations of seeded blob convection in the scrape - off - layer of magnetically confined fusion plasmas . </S>",
    "<S> we consistently incorporate high fluctuation amplitude levels and finite larmor radius ( flr ) effects using a fully nonlinear global gyrofluid model . </S>",
    "<S> this is in line with conditions found in tokamak scrape - off - layers ( sol ) regions . </S>",
    "<S> varying the ion temperature , the initial blob width , and the initial amplitude , we found an flr dominated regime where the blob behavior is significantly different from what is predicted by cold - ion models . </S>",
    "<S> the transition to this regime is very well described by the ratio of the ion gyroradius to the characteristic gradient scale length of the blob . </S>",
    "<S> we compare the global gyrofluid model with a partly linearized local model . for low ion temperatures </S>",
    "<S> we find that simulations of the global model show more coherent blobs with an increased cross - field transport compared to blobs simulated with the local model . </S>",
    "<S> the maximal blob amplitude is significantly higher in the global simulations than in the local ones . </S>",
    "<S> when the ion temperature is comparable to the electron temperature , global blob simulations show a reduced blob coherence and a decreased cross - field transport in comparison with local blob simulations . </S>"
  ]
}