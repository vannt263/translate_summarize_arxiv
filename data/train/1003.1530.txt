{
  "article_text": [
    "the study of obliquely incident plane wave upon planar interfaces is of fundemantal interest to electromagnetic ( em ) wave propagation .",
    "it underlies snell s law of refraction and leads to important concepts such as total reflection and brewster s angle.@xcite one can easily relate to the concept of an obliquely incident plane wave by the daily experience of looking into a mirror . in practice ,",
    "oblique incidence is vastly applied in em related applications such as fiber optics,@xcite underground object detection,@xcite and rf - human body interaction.@xcite    in the growing field of nanoplasmonics,@xcite oblique incidence finds applications particularly in exciting surface plasmon polaritons ( spps ) , exemplified by the common experimental setup in which subwavelength defects or attenuated total reflection are utilized to couple the obliquely incident plane wave into propagating spps.@xcite by taking advantage of the incident angle degree of freedom , several experiments have demonstrated spp near - field manipulation,@xcite which has been proposed as a direct approach to measuring spp generation efficiency.@xcite most recently , it has been shown that spp s can be directly generated on a planar metal surface by interfering incoming light beams with different incident angles in a four - wave mixing scheme.@xcite    the effects of light incident at oblique angle on sub - wavelength defects in metallic layered media have been studied by frequency - domain calculations based on either coupled wave analysis or a semi - analytical model .",
    "these references have explored the obliquely incident light transmission through a single defect,@xcite and the spp generation efficiency.@xcite our work is largely motivated by recent experimental study of spp dynamics excited or controlled by a femto - second ( fs ) laser pulse obliquely incident on a spp propagating interface.@xcite to describe such experiments , a time - domain method is desirable because of the ultrafast nature of the exciting or controlling laser pulse . the major challenge in developing such a method , is to accurately treat the oblique incidence as well as the material dispersiveness .",
    "this poses a special challenge for mesh - based propagation method ( such as the finite - difference time domain method ) because even in the absence of the inhomogeneous media the wave front not aligned with the cartesian mesh is required to be uniform and to have arbitrary incident angle and time profile .    in this paper",
    ", we develop a numerical method to rigorously treat obliquely incident plane wave scattering at embedded scatterers in layered dielectric and dispersive media . to the best of our knowledge",
    ", such a method was not published as yet.@xcite targetted mainly at time - domain studies of em wave phenomena that involve spp excitation and propagation in metallic films , the developed method is formulated within the framework of the finite - difference time - domain ( fdtd ) method .",
    "this method has enjoyed a wide range of applications in the field of nanoplasmonics,@xcite and its time - domain nature makes it particularly well suited to ultrafast phenomena .",
    "our treatment of the oblique plane wave is an extension of the total field / scatter field ( tf / sf ) technique to describe media characterized by the combination of debye- , drude- and lorentz - type poles.@xcite the tf / sf technique has been applied successfully in the fdtd study of free - standing scatterers , layered dielectrics and dispersive media describable by a single debye pole.@xcite it is based on the linearity of maxwell s equations and decomposes the total field into an incident and a scattered field components,@xcite @xmath0 by setting up an artificial boundary between the tf and sf regions in the fdtd simulations , a plane wave of arbitrary time profile and incident angle can be achieved by matching the known incident field at the tf and sf boundary . in presenting our method ,",
    "we will focus on the derivation of an equivalent one - dimensional ( 1d ) wave equations for the tf / sf boundary condition , suitable for various types of material dispersiveness , and explain in detail the numerical considerations involved .",
    "this will be followed by extensive numerical tests of the convergence properties of the method . for clarity",
    ", several important concepts from the previous literature are reemphasized .",
    "this paper is organized as follows : in section [ sec : sec2 ] , we derive the equivalent 1d wave equations , show the numerical flow chart for matching the tf / sf boundary condition , and discuss several practical simulation details , including stability , interface treatment , and leakage .",
    "section [ sec : sec3 ] tests our approach by comparison of numerical with analytical results for model problems . finally , concluding remarks are provided in section [ sec : sec4 ] .",
    "in the following , we provide the equations and numerical method for solving the transverse magnetic ( tm ) mode in two dimensions ( magnetic field perpendicular to the two - dimensional plane ) . special emphasis is placed on the tm mode because of its relevance to spp excitation.@xcite the numerical approach for solving the transverse electric ( te ) mode equations is similar to that for the tm mode , and the corresponding equations are given in appendix [ appx1 ] .",
    "the media considered are vacuum , linear dielectric media ( characterized by a dielectric constant ) , and linear dispersive media ( characterized by a finite sum of debye , lorentz , and drude types of poles ) .",
    "our starting point is maxwell s equations in the frequency domain for the tm mode , @xmath1 where the coordinate system is defined in fig .",
    "[ fig : f1 ] , @xmath2 is the free space permitivity , @xmath3 is the free space permeability , and @xmath4 is the dielectric function for a dispersive media , which reduces to a constant for vacuum and dielectric media .    in the case studies below , we assume a dispersive medium with a single ( non - zero ) drude pole @xmath5 and provide two separate sets of equations for solving eqs .",
    "( [ eqn : eqn1]-[eqn : eqn3 ] ) .",
    "the first set of equations is based on the auxiliary differential equation ( ade ) approach with polarization currents to account for the dispersiveness . in this case",
    ", we further assume that media other than vacuum are not extended into the absorbing boundary , which allows us to use berenger s pml absorbing boundary condition.@xcite the second set of equations is formulated within the general context of the uniaxial perfectly matched layers ( upml ) absorbing boundary conditions,@xcite and involves a different approach to treat the dispersiveness . in this case",
    ", we can effectively absorb the outgoing waves exiting the simulation domain in the dielectric and dispersive media .",
    "separate tests have been done to ensure that the two approaches provide the same solution.@xcite in the following , we assume that the 2d electric and magnetic fields propagate on the yee mesh with the dependence @xmath6 .",
    "@xmath7 is the size of a unit cell , and @xmath8 is unit time step .",
    "details on the fdtd equations in both ade and upml approaches are given in appendix [ appx2 ] .",
    "if we now consider tm mode wave propagation with obliquely incident plane wave on layered media with translational invariance , the 2d equations of motion can be reduced to an equivalent 1d wave propagation problem along the direction perpendicular to the interfaces between the media.@xcite we proceed to derive the equivalent 1d wave equation for the tm mode , which will serve as a means of introducing incident fields along the tf / sf boundary . the corresponding derivation for the te mode",
    "is provided in appendix [ appx1 ] .",
    "substituting eq .",
    "( [ eqn : eqn3 ] ) into eq .",
    "( [ eqn : eqn1 ] ) yields , @xmath9 because of the translational invariance and phase matching across the interfaces between different layers , @xmath10 , with @xmath11 being a wavevector that is identical for waves in different layers.@xcite if we further assume that an oblique plane wave is incident from a dielectric medium with relative permitivity @xmath12 , then @xmath13 , which can be substituted into eq .",
    "( [ eqn : eqn4 ] ) to give , @xmath14h_z .",
    "\\label{eqn : eqn5}\\ ] ]    equations ( [ eqn : eqn2 ] ) and ( [ eqn : eqn5 ] ) constitute a system of equations for 1d tm wave propagation across the interfaces between the media . to translate those equations into fdtd equations , jiang et al .",
    "introduced a convenient method to overcome the difficulty of time - domain convolution between the term in the square bracket and @xmath15 in eq .",
    "( [ eqn : eqn5 ] ) . in this method,@xcite eq .",
    "( [ eqn : eqn5 ] ) is first split into a pair of equations as , @xmath16 equations ( [ eqn : eqn2 ] ) , ( [ eqn : eqn6 ] ) and ( [ eqn : eqn7 ] ) then lead to the following set of fdtd equations , @xmath17 in obtaining eq .",
    "( [ eqn : eqn11 ] ) , we have multiplied both sides of eq .",
    "( [ eqn : eqn7 ] ) by @xmath4 and fourier transformed the result into the time domain .",
    "we have also made the assumption that a drude model is used , @xmath5 .",
    "the updating coefficients in eq .",
    "( [ eqn : eqn11 ] ) are @xmath18\\label{eqn : eqn12}\\\\ \\end{cases}\\ ] ] in vacuum ( @xmath19 ) and dielectric media ( constant @xmath20 ) , and @xmath21}{(2         + \\gamma_d\\delta t)\\left[\\epsilon(\\infty)-\\epsilon_{1r}\\sin^2(\\theta)\\right]+\\omega_d^2\\delta t^2},\\\\ b_{y4}=-\\frac{(2-\\gamma_d\\delta t)\\left[\\epsilon(\\infty)-\\epsilon_{1r}\\sin^2(\\theta)\\right ]                + \\omega_d^2\\delta t^2 }               { ( 2+\\gamma_d\\delta t)\\left[\\epsilon(\\infty)-\\epsilon_{1r}\\sin^2(\\theta)\\right ]               + \\omega_d^2\\delta t^2},\\\\ b_{y5}=\\frac{(2+\\gamma_d\\delta t)\\epsilon(\\infty)+\\omega_d^2\\delta t^2 }              { ( 2+\\gamma_d\\delta t)\\left[\\epsilon(\\infty)-\\epsilon_{1r}\\sin^2(\\theta)\\right ]               + \\omega_d^2\\delta t^2},\\\\",
    "b_{y6}=\\frac{-4\\epsilon(\\infty ) }              { ( 2+\\gamma_d\\delta t)\\left[\\epsilon(\\infty)-\\epsilon_{1r}\\sin^2(\\theta)\\right ]               + \\omega_d^2\\delta t^2},\\\\ b_{y7}=\\frac{(2-\\gamma_d\\delta t)\\epsilon(\\infty)+\\omega_d^2\\delta t^2 }              { ( 2+\\gamma_d\\delta t)\\left[\\epsilon(\\infty)-\\epsilon_{1r}\\sin^2(\\theta)\\right ]               + \\omega_d^2\\delta t^2}\\label{eqn : eqn13}\\\\ \\end{cases}\\ ] ] in drude media",
    ". here , we note the similarity between the updates of the @xmath22 pair and the @xmath23 pair in the upml formulation , which results from the fact that both pairs involves updating an auxiliary variable before the treatment of the material dispersiveness . in the case that @xmath4 contains a linear sum of different types of poles ( e.g. , to accurately describe metals near inter - band transition energies@xcite ) , direct fourier transform may not be as efficient because of higher - order derivatives with respect to time . for a systematic treatment of this situation ,",
    "interested readers are referred to appendix [ appx3 ] .",
    "the updating coefficients in eqs .",
    "( [ eqn : eqn8 ] ) to ( [ eqn : eqn10 ] ) are identical to those in eqs .",
    "( [ eqn : a ] ) , ( [ eqn : b ] ) and ( [ eqn : c ] ) , which are given in eqs .",
    "( [ eqn : d]-[eqn : h ] ) .",
    "we note that the updating coefficients corresponding to berenger s pml formulation can be used here provided that the two end media in the layers are vacuum . in the case of non - vacuum semi - infinite media at the two ends ,",
    "1d upml can be used to effectively absorb the outgoing waves , for example , equations similar to eqs .",
    "( [ eqn : l]-[eqn : k ] , [ eqn : i0 ] , [ eqn : i ] ) can be used by setting @xmath24 and @xmath25 in eqs .",
    "( [ eqn : j1 ] ) and ( [ eqn : k2 ] ) .",
    "the main panel of fig .",
    "[ fig : f1 ] illustrates the geometry of the fdtd simulation region .",
    "the layered media are denoted by @xmath12 , @xmath26 , etc . and are stacked along the @xmath27 direction .",
    "the thick , dashed ( thin , dotted ) lines denote the tf / sf boundaries along which the incident @xmath28-field ( @xmath29-field ) is calculated .",
    "incident field alignments on the boundaries are shown more explicitly in the zoom - in panels to the left and below the main panel .",
    "in this work , we assume that the oblique incidence field is introduced from the lower left corner ( crossing point between lines @xmath30 and @xmath31 in the main panel of fig . [",
    "fig : f1 ] ) with incident angle @xmath32 to the normal of the media interfaces ( @xmath27 direction ) .",
    "we further assume that the two end media in the layers are vacuum . consequently @xmath33 , so that field propagation along the horizontal boundaries @xmath34 through @xmath35 can be readily calculated by a delay of the free - space propagation time .",
    "in addition , the 1d field propagation along the vertical lines can be terminated by berenger s pml formulation .",
    "the perfectly matched layers absorbing boundaries are not shown in fig .",
    "[ fig : f1 ] . they will be further illustrated and explained when we consider specific examples in section [ sec : sec3 ] .",
    "the lower left panel in fig .",
    "[ fig : f1 ] shows the field alignment along line @xmath36 for the 1d wave propagation .",
    "the same setup applies to lines @xmath30 ,",
    "@xmath37 and @xmath38 .",
    "importantly , a 1d total field / scattered field approach is used here ( the boundary points are highlighted in the shaded rectangle ) because we must allow the wave from the multiple interface reflection to exit the 1d simulation and be absorbed at the bottom on the 1d simulation line.@xcite    our simulation follows the flow chart shown in fig .",
    "[ fig : f2 ] . the procedures belonging to 1d and 2d field updates",
    "are highlighted in the shaded rounded rectangles . in each iteration ,",
    "the code updates the 1d @xmath29-field , 2d @xmath29-field , 1d @xmath28-field , and 2d @xmath28-field in a sequence .",
    "the order of 1d field storage and its matching to 2d simulation are important to ensure correct implementation of the 2d tf / sf scheme . before updating the 1d field",
    ", the code needs to store at each time instant the 1d field values at the crossing points between line @xmath36 and lines @xmath34 , @xmath31 , @xmath39 , and @xmath35 .",
    "the field matching at the tf / sf boundary is performed differently in accordance with the different updating schemes introduced in section [ sec2:subsec1 ] . in the ade approach , the tf / sf boundary matching equations on lines @xmath34 , @xmath31",
    ", @xmath30 read , @xmath40 these updates are performed immediately after eqs .",
    "( [ eqn : a ] ) , ( [ eqn : c ] ) , and ( [ eqn : b1 ] ) . for the @xmath41-field update on lines",
    "@xmath42 and @xmath43 , because @xmath44 depends on the updated value of @xmath41 in eq . (",
    "[ eqn : b3 ] ) , the @xmath41 boundary matching is performed in between eqs .",
    "( [ eqn : b2 ] ) and ( [ eqn : b3 ] ) , for example , on line @xmath42 , @xmath45    in the upml formulation , the tf / sf boundary matching is carried out immediately after the @xmath46 and @xmath47 updates ( before updating @xmath48 and @xmath28 ) in eqs .",
    "( [ eqn : l]-[eqn : i ] ) , for example , the updates on lines @xmath30 and",
    "@xmath42 read @xmath49 because the above updates are performed between the updates of @xmath46 and @xmath48 or @xmath47 and @xmath28 , they are indicated in the flow chart ( fig .",
    "[ fig : f2 ] ) by the upward arrows on the right .",
    "we note that if the same type of pml absorbing boundary condition is used to terminate both the 1d and the 2d field propagation , one can allow them to have the same updating coefficients in the pml region and therefore remove the procedures of saving and matching the field components on lines @xmath39 and @xmath35 [ @xmath50 and @xmath51.@xcite this particular setup is useful in the description of a very thick bottom layer ( semi - infinite in the positive @xmath27 direction ) .    in the case of normal incidence ,",
    "the code simplifies in two ways .",
    "first , in eq .",
    "( [ eqn : eqn7 ] ) , @xmath52 , and therefore eq . ( [ eqn : eqn11 ] ) is removed from the 1d @xmath28-field update procedure .",
    "second , it is not necessary to store and interpolate the field values @xmath50 , @xmath53 , @xmath54 , and @xmath55 , because field excitation is synchronized along lines @xmath34 , @xmath31 , @xmath39 and @xmath35 , respectively .",
    "the incident field values on lines @xmath36 , @xmath30 , @xmath37 and @xmath38 are calculated from eqs .",
    "( [ eqn : eqn8]-[eqn : eqn11 ] ) using a 1d tf / sf scheme that allows fields reflected from the interfaces to exit the 1d simulation domain . based on the geometry shown in the lower left panel in fig .",
    "[ fig : f1 ] , we assume that the incoming @xmath28-field with time - dependence @xmath56 excites the 1d field at point @xmath57 . paired with this excitation is an @xmath29-field of the form @xmath58 , exciting the 1d field at point @xmath59 .",
    "for example , on line @xmath36 in fig .",
    "[ fig : f1 ] , the 1d tf / sf boundary matching equations read , @xmath60 the values of @xmath61 and @xmath62 are calculated from the known expressions of @xmath56 and @xmath63 using time - domain interpolation when necessary .",
    "these values are stored at each instant to generate the excitation fields for lines @xmath30 , @xmath37 , and @xmath38 by introducing a time delay @xmath64 . the field values on the horizontal lines @xmath34 , @xmath31 , @xmath39 and @xmath35 are obtained in a similar fashion .",
    "one can also store the field values at each point on line @xmath36 , and save the computation along lines @xmath30 , @xmath37 and @xmath38 by introducing a proper time delay .",
    "this scheme reduces the computation time for the cost of larger memory requirement .",
    "finally , the 2d tf / sf boundary values [ @xmath65 along lines @xmath42 ( @xmath43 ) are readily calculated from the @xmath28-field values on lines @xmath36 and @xmath30 ( @xmath37 and @xmath38 ) using eqs .",
    "( [ eqn : b2 ] ) and ( [ eqn : b3 ] ) .",
    "in addition , we note that the excitation and pml absorbing boundary conditions are enforced on @xmath66 in the 1d field updates .",
    "several practical issues should be considered .",
    "first , in vacuum , the projection of the phase velocity of the oblique incident field on the @xmath27-axis is @xmath67 .",
    "as the incident angle @xmath32 increases , the phase velocity can be very large and cause numerical instability if a fixed courant criterium is enforced ( e.g. , @xmath68 ) . based on this observation ,",
    "we vary the courant number @xmath69 to ensure stability .",
    "when the incident angle is small , a small courant number is used to ensure resolution of the time domain interpolation along the horizontal boundaries . in our simulation ,",
    "the same courant number is used for both 1d and 2d wave propagations , while an interpolation scheme to match different courant numbers in 1d and 2d wave propagations is explained in ref . .",
    "second , as the dielectric function is discontinuous across the interface between layers of different media , we have used an average dielectric function for updating the fields at the interface.@xcite for example , in the left panel of fig . [",
    "fig : f1 ] , we use the dielectric function @xmath70 for the @xmath71-field updates at the interface . in section",
    "[ sec : sec3 ] , we will show that this scheme leads to faster convergence and/or higher accuracy as compared to the standard step - like change of @xmath72 .",
    "finally , we use a gaussian ramping in the hard source time - response in eqs .",
    "( [ eqn : eqn20 ] ) and ( [ eqn : eqn21 ] ) to slowly ramp the field to continuous wave so as to avoid high - frequency component leakage out of the tf / sf domain . specifically , @xmath73 , @xmath74 fs , @xmath75 fs , for the ramping phase @xmath76 .",
    "to test the accuracy of the tf / sf scheme , we compare our simulation results to analytical results by considering the oblique tm wave incident upon a slab sandwiched between two vacuum media .",
    "the analytical results for the reflection and transmission coefficients are given by@xcite @xmath77 for tm wave , @xmath78 here , @xmath79 and @xmath80 denote , respectively , the reflection and transmission coefficients at the interface between media @xmath81 and @xmath82 , and @xmath83 denotes the refractive index of media @xmath81 .",
    "we assume that medium @xmath84 is a slab of thickness @xmath35 .",
    "the waves at the input side of the slab , where the incident and reflected waves propagate , and at the output side , where the transmitted wave propagates , can then be expressed as , @xmath85+r\\exp[i(k_x x - k_y y)],\\label{eqn : eqn28}\\\\ \\psi^{\\rm output}&=&t\\exp[i(k_x x+k_y y)].\\label{eqn : eqn29}\\end{aligned}\\ ] ] the above expressions indicate that the maximum field amplitude on the input and output sides are @xmath86 and @xmath87 , respectively .",
    "these quantities can be obtained along a @xmath27-direction detection line in the tf / sf scheme for layered media without placing any scatterer inside the tf region . using this scheme",
    ", we also test the leakage , defined as the ratio of the maximum field magnitude in the scattered field region to the maximum field magnitude in the total field region : @xmath88 , where @xmath89 refers to @xmath71 , or @xmath41 , or @xmath15 . in the ideal case , @xmath90 , whereas in practice , @xmath91 ( or @xmath92 db ) is desirable.@xcite specific numerical examples of the tests are provided in section [ sec : sec3 ] , where `` leakage '' refers to the largest leakage among @xmath71 , or @xmath41 , or @xmath15 .",
    "in addition , we have tested the accuracy of the wave propagation in the layered media by inspecting the @xmath93 and @xmath27 projections of the wavelength [ where , for instance , the @xmath93-projection is @xmath94 and @xmath95 . in the case of a dispersive slab , we have also tested the skin depth ( the distance where the field decays to @xmath96 of its value at the surface , ca . 30 nm for the drude model and parameters in our calculation ) , by considering a slab with thickness larger than @xmath97 nm .",
    "these tests all show an error within @xmath98 compared to analytical results .",
    "to illustrate the generality of our formulation , we first consider the simple case of plane wave propagation in vacuum , illustrated in fig .",
    "[ fig : fig1 ] . in panels",
    "( a - c ) , the plane wave ( wavelength @xmath99 nm ) is injected from the lower left corner into the tf region ( bounded by the thick , dashed lines ) with incident angle @xmath100 . in panel",
    "( d ) , the plane wave propagates in the positive @xmath27 direction .",
    "it is shown that as the field penetrates into the berenger pml located at the top of the simulation domain , it is efficiently absorbed .",
    "negligible leakage is introduced at the pml boundary as the 1d field updating equations acquire the same coefficients as the 2d equations [ see section [ sec : sec2 ] ] . the dashed oval in panel ( a ) indicates considerable leakage ( @xmath101 ) outside the tf region because in this case the incident continuous wave ( cw ) field is turned on instantaneously .",
    "consequently , the high frequency components in the leading wave front are not well matched at the tf / sf boundary , resulting in the leakage .",
    "as shown by panels ( b ) and ( c ) , the leakage can be reduced by one order of magnitude by slow ( gaussian ) ramping of the incident field to steady - state cw oscillations . in light of this , hereafter we use gaussian ramping prior to cw in the excitation hard source @xmath56 and @xmath63 .",
    "the maximum leakage in the calculations of panels ( b  d ) is @xmath102 and the relative error in the vacuum wave impedance ( @xmath103 ) is @xmath104 .    as a second example",
    ", we study a plane wave obliquely incident on a dielectric slab.@xcite . in fig .",
    "[ fig : fig2 ] , we plot snapshots of the magnetic field of a plane wave ( wavelength @xmath99 nm ) incident at an angle @xmath105 on a @xmath106-nm thick dielectric slab ( dielectric constant @xmath107 ) . in both panels ,",
    "the solid rectangle indicates the location of the slab , while the thick , dashed rectangle shows the tf / sf boundary .",
    "the plane wave is injected from the lower left corner and first impinges on the lower vacuum / dielectric interface . in panel",
    "( a ) , we observe the interference patterns of the reflected wave with the incident wave below the lower vacuum / dielectric interface while the refracted wave front propagates in the slab .",
    "the faint wave front in the dielectric slab is due to the slow gaussian ramping of the incident field . after a steady state",
    "is established [ fig .",
    "[ fig : fig2](b ) ] , the magnetic field pattern clearly reveals the interference between the reflected and incident waves , the interference within the dielectric slab , and the final transmission through the slab . in fig .",
    "[ fig : fig2 ] ( b ) , it is observed that the final transmitted wave maintains the same propagation direction as the incident wave ( @xmath108 to @xmath109 direction ) because the media below and above the slab are both vacuum .",
    "we proceed to examine the convergence of the magnitude of the reflection ( @xmath110 ) and transmission ( @xmath111 ) coefficients to the analytical results given by eqs .",
    "( [ eqn : eqn22 ] ) and ( [ eqn : eqn23 ] ) . in fig .",
    "[ fig : fig3 ] , we plot the relative errors in ( a ) @xmath112 and ( b ) @xmath87 with respect to analytical results as a function of the mesh size @xmath113 . the red , solid ( blue , dashed ) curve in fig .",
    "[ fig : fig3 ] shows the convergence result without ( with ) the interface averaging of the dielectric constant . from the comparison ,",
    "it is clear that calculations with interface correction lead to uniformly smaller error than that without the interface correction .",
    "the slope of each line in the log - log plot obtained by the least - square fit indicates that second order accuracy of yee s algorithm is maintained with the interface correction , while the accuracy degrades to first order without the interface correction .",
    "similar effects have been reported in previous studies on the accuracy of fdtd results with dielectric interfaces,@xcite while here we observe such effects within the tf / sf formulation in the context of layered media .",
    "we note that the interface correction scheme does not entail additional computational and memory requirements and is thus always recommended . in fig .",
    "[ fig : fig3 ] ( c ) , we show that the maximum leakage with interface averaging is uniformly smaller than that without the interface averaging for different mesh sizes . throughout",
    ", the maximum leakage is below @xmath114 , substantiating our confidence in the tf / sf scheme.@xcite    to further test the accuracy of the dielectric slab reflection and transmission upon oblique incidence of a plane wave , we compare the analytical results with fdtd calculated results at different incident wavelengths in table [ tab : tab1 ] and at different incident angles in table [ tab : tab2 ] .",
    "as shown , the relative error ( given in parentheses ) is uniformly below @xmath98 , except for incident angle @xmath115 , where @xmath112 is below @xmath116 .",
    "it is interesting to note that the relative error diminishes with increasing wavelength , while a non - monotonic trend is seen in the errors of both reflection and transmission coefficients for an increasing incident angle .",
    "next we apply the tf / sf method to study the reflection and refraction of a plane wave obliquely incident upon a dispersive metal slab .",
    "snapshots of the magnetic field are shown in fig .",
    "[ fig : fig4 ] as the plane wave passes through the metal slab .",
    "specifically , we consider an incident plane wave with wavelength @xmath99 nm and @xmath105 injected from the lower left corner of the tf region upon an @xmath117 nm thick dispersive metal slab described by the drude model @xmath5 , with @xmath118 , @xmath119 rad / s , and @xmath120 rad / s .",
    "this set of parameters is optimized to fit the dielectric data reported in ref . for bulk silver in the spectral range from @xmath121 to @xmath122 nm . figures [ fig : fig4 ] ( a ) and ( b ) illustrate the magnetic field distribution before and after reaching a steady state , respectively . in fig .",
    "[ fig : fig4 ] ( b ) , the large curvatures at the interference minima between the incident and reflected fields below the lower interface indicate a large reflection coefficient ( @xmath123 ) . inside the metal , because of the complex dielectric function of the slab , the wave front is no longer a plane wave , as is clearly discernable in fig . [",
    "fig : fig4 ] .",
    "however , the final transmitted wave exiting from the upper interface recovers a plane wave front and the same propagation constant as the incident wave , because the media below and above the dispersive slab are both vacuum . from figs .",
    "[ fig : fig2](b ) and [ fig : fig4](b ) , it is seen that the periodicity in the @xmath93 direction of the fields below , inside , and above the slab is the same . by further observing the field propagation after reaching the steady state in both cases (",
    "not shown ) , it is clear that the phase of the total field in the @xmath93 direction is matched .",
    "this observation confirms the phase matching condition parallel to the interface ( same @xmath11 across the interfaces ) , which is critical to the derivation of the 1d field propagation , eq .",
    "( [ eqn : eqn5 ] ) .    to examine the convergence of our results in the case of the metal slab",
    ", we use the same incident field condition as that in fig . [",
    "fig : fig4 ] and plot the relative error of the reflection and transmission coefficients as a function of the mesh size @xmath113 in figs .",
    "[ fig : fig5 ] ( a ) and ( b ) , respectively .",
    "it is seen that the results with interface averaging ( blue , dashed curves ) of the dielectric function yield uniformly lower error than the results without the interface averaging ( red , solid curves ) .",
    "a first - order power law is seen in the error of the transmission coefficient as a function of the mesh size without interface averaging , all other errors are near and below @xmath124 , illustrating the convergence of the fdtd results .",
    "fdtd simulations on similar dispersive systems have been reported by mohammodi et al . , who suggested that the dispersive contour - path method is able to achieve smaller error even for a relatively large step - size ( @xmath113).@xcite fig .",
    "[ fig : fig5](c ) shows that the leakage decreases with a decreasing mesh size , albeit in this case the leakage with the interface averaging of the dielectric function is slightly larger than that without the averaging [ cf .",
    "[ fig : fig3](c ) ] .",
    "in tables [ tab : tab3 ] and [ tab : tab4 ] , we compare between the analytical and the fdtd calculated reflection and transmission coefficient magnitudes at various incident wavelengths and incident angles for the metal slab studied in fig .",
    "[ fig : fig4 ] .",
    "the fdtd results are obtained after steady state is reached under cw incident plane wave illumination . in the frequency domain",
    ", this corresponds to a fixed incident wavelength , and the drude model provides a constant complex value of dielectric function , which can be used in eqs .",
    "( [ eqn : eqn22 ] ) and ( [ eqn : eqn23 ] ) to obtain the reflection and transmission coefficients . in table",
    "[ tab : tab3 ] , we list the free space wavelength in the @xmath125 to @xmath122 nm range , to which the fitted drude model is applicable .",
    "the small relative errors ( @xmath126 ) shown in the parentheses in tables [ tab : tab3 ] and [ tab : tab4 ] illustrates the reliability of our calculations using the tf / sf formulation in the case of layered dispersive media .",
    "the maximum leakage found in obtaining the data in tables [ tab : tab3 ] and [ tab : tab4 ] is @xmath127 , which occurs at @xmath128 .",
    "panels in the left column of fig .",
    "[ fig : fig6 ] illustrate snapshots of the magnetic field as the wave propagates through two - layer media consisting of a lower layer of @xmath117-nm thick dispersive material and an upper layer of @xmath129-nm thick dielectric material under oblique plane wave incidence .",
    "the material parameters are given in the caption of fig .",
    "[ fig : fig6 ] . in these panels ,",
    "the solid horizontal lines define the boundaries between different layers , which are extended into the upml in the @xmath93 direction .",
    "the dashed box denotes the tf / sf boundary .",
    "the incident plane wave with wavelength @xmath99 nm and @xmath100 is injected from the lower left corner of the tf region .",
    "the magnetic field snapshots in the first column of fig . [ fig : fig6 ] show that snell s law is obeyed when the field passes through the two layers of materials .",
    "in particular , the propagation direction in the high - index dielectric material exhibits a smaller angle to the normal than the incident wave , whereas the final transmitted wave propagates along the direction of the incident wave .",
    "more importantly , we observe that the phase of the waves across the different layers is matched in the @xmath93 direction after a steady state is established ( bottom panel in the left column ) , which is again consistent with eq .",
    "( [ eqn : eqn5 ] ) . in this case , the magnitude of the reflection and transmission coefficients calculated by fdtd is @xmath130 and @xmath131 , respectively .",
    "the bottom panel in the left column also shows non - negligible leakage penetrating through the tf / sf box and propagating into the lower right corner of the simulation domain , nevertheless , the maximum value of the leakage in @xmath15 is @xmath132 , which is insignificant in practice .",
    "panels in the second column of fig .",
    "[ fig : fig6 ] are obtained under the same conditions as those in the first column except that a slit of @xmath133 nm width ( in the @xmath93 direction ) and @xmath134 nm depth ( in the @xmath27 direction ) is placed in the middle of the simulation domain . in the tf region ,",
    "the slit causes strong scattering of the injected plane wave , which results in the observed interference patterns .",
    "the slit introduces entirely new physics : outside the tf / sf boundary , the purely scattered wave distribution is reminiscent of a dipole radiation pattern .",
    "closer inspection reveals that the field distribution is asymmetric with respect to the slit center ( @xmath135 nm ) .",
    "the scattered field is strongest near the lower surface of the dispersive slab and to the right of the tf / sf box and weakest above the upper surface of the dielectric slab and to the left of the tf / sf box .",
    "the asymmetric angular distribution is a clear signature of the oblique incidence of the exciting plane wave . by enlarging the sf region size , we find that the purely scattered wave along the lower surface of the metal thin film consists mainly of surface plasmon polariton ( spp ) waves propagating away from the slit .",
    "these are identified by their wavelength - @xmath136 nm in the @xmath93 direction compared with the analytical result for the wavelength of spp at the interface between vacuum and metal , which is given by @xmath137 nm .    for the simulations in fig . [",
    "fig : fig6 ] , we have updated the field at the horizontal and vertical interfaces using the averaging scheme discussed above , and have tested the convergence of the fields in the tf and sf regions with respect to mesh size ( @xmath113 ) , tf box size , and physical size of the simulation region .",
    "we note that upml termination of the simulation domain is important because the scattered field due to the slit is significant .",
    "our tests show that the maximum scattered field in the sf region is only one order of magnitude less than the maximum field in the tf region .",
    "additionally , the upml can effectively absorb the outgoing wave in the dispersive and dielectric layers .",
    "furthermore , the boxed tf / sf boundary has advantage over the @xmath138-shaped boundary considered previously , particularly when one is interested in the full angular distribution of the scattered field in the far - field zone .",
    "using maxwell s equations for the transverse magnetic wave , along with translational invariance and phase matching principles , we derived an equivalent one - dimensional wave propagation equation along the direction perpendicular to the interfaces between layered media .",
    "we then derived the corresponding finite - difference time - domain equations for layered dielectric media and dispersive media with a drude pole pair . to utilize these equations for a plane wave with oblique incidence",
    ", we discussed the simulation setup and procedure in the framework of the total field / scattered field formulation with a special emphasis on techniques to match the fields at the total field / scattered field boundary .",
    "we have performed tests on vacuum propagation and on the reflection and refraction at a dielectric and a dispersive slab . converged simulation results for various incident angles and wavelengths reveal that the errors in the reflection and refraction coefficients are uniformly below @xmath98 compared to analytic results .",
    "the numerical example of scattering at a nano - scale ( sub - wavelength ) slit in a dispersive medium invites interesting applications of our formulation to time - dependent studies of electromagnetic wave scattering at surface or embedded scatters in dispersive media , for example , the coupling of incident oblique plane wave into surface plasmon polaritons . for this purpose",
    ", the developed method offers the flexibility of choosing the total field region inside which the near - field exhibits interference pattern between incident and scattered fields , while outside which the scattered far - field can be detected at all angles .",
    "this work is supported by the w. m. keck foundation ( grant number 0008269 ) and by the national science foundation ( grant number esi-0426328 ) .",
    "the authors thank hrvoje petek and atsushi kubo for the communications of corresponding experimental data , and maxim sukharev , gilbert chang , jeffrey mcmahon , stephen gray and allen taflove for insightful discussions .",
    "they are particularly thankful to ilker apolu for discussions on the total field / scattered field formalism .",
    "maxwell s equations in 2d in the frequency domain for the te mode read , @xmath139 substituting eq .",
    "( [ eqn : eqn32 ] ) into eq . ( [ eqn : eqn30 ] ) yields , @xmath140e_{z},\\label{eqn : eqn33}\\\\\\ ] ] where @xmath12 denotes the relative permitivity of the first medium ( see fig . [",
    "fig : f1 ] ) . equations ( [ eqn : eqn31 ] ) and ( [ eqn : eqn32 ] ) are used for 1d te mode wave propagation .",
    "these equations can be readily solved using the same fdtd procedure as for eqs .",
    "( [ eqn : eqn1 ] ) and ( [ eqn : eqn2 ] ) .",
    "the time - domain solution is facilitated by the fact that material dispersiveness introduces a factor @xmath141 $ ] in eq .",
    "( [ eqn : eqn33 ] ) , whereas in eq .",
    "( [ eqn : eqn5 ] ) it introduces a factor @xmath141/\\epsilon(\\omega)$ ] , which entails more difficulty for the fdtd solution.@xcite the simulation setup and flow chart in section [ sec : sec2 ] can be used for the te mode by exchanging the roles of the @xmath29 and @xmath28 fields .",
    "the fdtd equations based on the auxiliary differential equation ( ade ) approach read , @xmath142 the coefficients in the @xmath29-field updating equations are medium dependent ; specifically , in vacuum ( @xmath19 ) and dielectric media ( constant @xmath20),@xcite @xmath143 in drude media , @xmath5,@xcite @xmath144,\\\\ a_{x3 } = a_{y3 } = -\\delta t/\\left[\\epsilon_0\\epsilon(\\infty)\\right],\\\\ a_{x4 } = a_{y4 } = ( 1-\\gamma_d\\delta t)/(1+\\gamma_d\\delta t),\\\\ a_{x5 } = a_{y5}= \\epsilon_0\\omega_d^2\\delta t/(1+\\gamma_d\\delta t),\\label{eqn : e } \\end{cases}\\ ] ] and in the pml region , @xmath145/(\\delta x\\sigma_y),\\\\ a_{x3 } = a_{x4 } = a_{x5 } = 0;\\\\ a_{y1 } = \\exp(-\\sigma_x\\delta t/\\epsilon_0),\\\\ a_{y2 } = -\\left[1-\\exp(-\\sigma_x\\delta t/\\epsilon_0)\\right]/(\\delta x\\sigma_x),\\\\ a_{y3 } = a_{y4 } = a_{y5 } = 0.\\label{eqn : f } \\end{cases}\\ ] ] the coefficients in the @xmath28-field updating equations outside the pml regions are , @xmath146 whereas in the pml regions they read , @xmath147/(\\delta x\\sigma^*_x),\\\\ b_{y1 } = \\exp(-\\sigma^*_y\\delta t/\\mu_0),\\\\ b_{y2 } = \\left[1-\\exp(-\\sigma^*_y\\delta t/\\mu_0)\\right]/(\\delta x\\sigma^*_y).\\label{eqn : h } \\end{cases}\\ ] ] here , we assume a polynomial grading of the pml parameters:@xcite @xmath148 , where @xmath149 is the maximum conductance in the pml , @xmath150 is the distance into the pml , and @xmath151 is the thickness of the pml region . in this paper , we use a power @xmath152 and @xmath153 .",
    "@xmath149 is optimized to give a maximum reflection error on the order of @xmath154 .",
    "the fdtd equations based on the upml formulation read,@xcite @xmath155    the coefficients in the @xmath29-field updating equations in all media are , @xmath156 in vacuum ( @xmath19 ) and dielectric media ( constant @xmath20 ) , @xmath157 whereas in drude media , @xmath158 outside the upml regions , @xmath159 and in the upml regions , @xmath160 the coefficients in the @xmath28-field updating equations outside the upml region are , @xmath161 and in the upml regions , @xmath162 here , we assume a polynomial grading of the pml parameters,@xcite @xmath163 and @xmath164 , where @xmath149 and @xmath165 denote the maxima of the upml parameters @xmath150 is distance into the pml , and @xmath151 is the thickness of the pml .",
    "in this paper , we use power @xmath152 , @xmath153 , @xmath166 , and @xmath149 is optimized to give a maximum reflection error on the order of @xmath154 for a simulation region consisting of vacuum and on the order of @xmath167 for a simulation region consisting of drude dispersive media .",
    "in this appendix we provide a systematic solution for eq .",
    "( [ eqn : eqn7 ] ) when @xmath168 and @xmath4 consists of a linear superposition of debye , drude , and lorentz types of poles . in this case , we first rearrange eq .",
    "( [ eqn : eqn7 ] ) as @xmath169 where @xmath170 and@xcite @xmath171 we introduce auxiliary variables @xmath172 to rewrite eq .",
    "( [ eqn : eqn34 ] ) as a system of equations , @xmath173 equations ( [ eqn : eqn36 ] ) and ( [ eqn : eqn37 ] ) correspond to the set of fdtd equations , @xmath174 the translation of eq .",
    "( [ eqn : eqn38 ] ) into a set of fdtd equations depends on the type of pole(s ) considered [ see eq .",
    "( [ eqn : eqn35a ] ) ] . for a single debye pole ( @xmath175 ) ,",
    "@xmath176 for a drude pole pair ( @xmath177 ) , @xmath178 for a lorentz pole pair ( @xmath179 ) , @xmath180 equations ( [ eqn : eqn39 ] ) through ( [ eqn : eqn43 ] ) form a linear system of equations for the unknowns @xmath181 and @xmath182 ( @xmath183 ) , which can be solved by existing numerical solvers for linear systems of equations . the solution is then used to replace eq . ( [ eqn : eqn11 ] ) to proceed the 1d wave propagation for the tm mode comparing to a direct fourier transform of eq .",
    "( [ eqn : eqn5 ] ) , the above procedure only requires the storage of the quantities at the previous two time instances and thus avoids the complexity of numerical high - order derivatives with respect to time .",
    "this procedure can be extended systematically to multi - poles in the material dispersiveness , although it involves solving a linear system of equations .",
    "f. lpez - tejeira , sergio g. rodrigo , l. martn - moreno , f. j. garca - vidal , e. devaux , w. ebbesen , j. r. krenn , i. p. radko , s. i. bozhevolnyi , m. u. gonzlez . ,",
    "j. c. weeber , and a. dereux , nat .",
    "phys . * 3 * , 324 ( 2007 ) .",
    "we note that an obliquely incident beam in the finite - difference time - domain method has been developed previously .",
    "see , e.g. , t .- w .",
    "lee and s. k. gray , appl .",
    ". lett . * 86 * , 141105 ( 2005 ) ; k. j. willis , j. b. schneider , and s. c. hagness , opt . exp . *",
    "16 * , 1903 ( 2008 )",
    ". however , we stress that in these formulations the incident beam wave front is spatially non - uniform , in contrast to the formulation in this paper .",
    "we note that , when incoporated with the convolutional perfectly matched layers absorbing boundary conditions , the ade approach can systematically treat a general dispersive medium with a finite sum of debye- , lorentz- and drude - type poles , while the upml approach with higher order poles becomes increasingly difficult because of higher - order derivatives with respect to time . however , for a single drude pole considered in this paper , the upml approach is numerically tractable .                    if @xmath184 , total reflection occurs , and the solution of eqs .",
    "( [ eqn : eqn7 ] ) and ( [ eqn : eqn33 ] ) becomes unstable . in the examples provided in this paper , this situation is not allowed .",
    "interested readers are referred to ref . for a detailed discussion of the fdtd formulation and solution in this case .      , @xmath26 , etc .",
    "thick , dashed ( thin , dotted ) lines denote the boundaries to which the @xmath185 ( @xmath186 ) field is assigned .",
    "the left , lower left , and lower right panels show the specific field point assignment at the interface , along line @xmath36 , and at the horizontal boundaries , respectively .",
    "the @xmath93-coordinates of lines @xmath36 , @xmath42 , @xmath30 , @xmath37 , @xmath43 , @xmath38 are @xmath187 , @xmath188 , @xmath189 , @xmath190 , @xmath191 , and @xmath192 , respectively",
    ". the @xmath27-coordinates of lines @xmath34 , @xmath31 , @xmath39 , and @xmath35 are @xmath193 , @xmath194 , @xmath195 , and @xmath196 , respectively.,width=415 ]     coordinate . for",
    "1d field updates an auxiliary differential equation ( ade ) approach is used , while 2d field updates are performed by either the ade approach or the equations consistent with the uniaxial perfectly matched layers ( upml ) formulation.,width=453 ]    .",
    "( a ) magnetic ( @xmath28 ) field snapshot at @xmath197 fs for a plane wave propagating in vacuum .",
    "the dashed oval indicates the leakage outside the tf / sf boundary as a result of the instantaneous turn - on of the field .",
    "panels ( b  d ) show @xmath28-field snapshots for a plane wave propagation with initial gaussian ramping .",
    "( b ) @xmath28-field snapshot during ramping ( at @xmath198 fs ) and",
    "( c ) after steady state is established ( at @xmath199 fs ) .",
    "( d ) @xmath28-field snapshot at @xmath200 fs for a plane wave propagating in the positive @xmath27 direction .",
    "for all calculations , the incident wavelength is @xmath201 nm ( period @xmath202 fs ) , and the steady - state amplitude of the incident magnetic field is @xmath203 a / m .",
    "the mesh size is @xmath204 nm , and the courant number is @xmath205 .",
    "a log color scale ( @xmath206 ) is used in all plots . the thick , dashed ( thin , dotted ) rectangle indicates the tf / sf ( inner pml ) boundary.,width=472 ]",
    "fs ) and ( b ) after steady state is established ( at @xmath207 fs ) .",
    "the incident plane wave enters the tf region from the lower left corner of the tf / sf boundary with incident angle @xmath105 .",
    "the incident wavelength in vacuum is @xmath201 nm ( period @xmath202 fs ) , and the steady - state amplitude of the incident magnetic field is @xmath203 a / m in all calculations .",
    "the dielectric constant and thickness of the slab are @xmath107 and @xmath106 nm , respectively .",
    "the media above and below the slab are vacuum , the mesh size is @xmath208 nm , and the courant number is @xmath209 .",
    "a log color scale is used in all plots . the thick , dashed ( thin , dotted ) rectangle indicates the tf / sf ( inner pml ) boundary .",
    "the slab does not penetrate into the pml region.,width=472 ]     and ( b ) the transmission coefficient @xmath111 as a function of the mesh size @xmath113 .",
    "( c ) maximum leakage as a function of mesh size @xmath113 . in all calculations ,",
    "the courant number is @xmath209 . in all figures ,",
    "the red , solid ( blue , dashed ) curve shows the result without ( with ) the interface averaging of the dielectric constants .",
    "the parameters of the incident wave and the dielectric slab are as in the calculation leading to fig .",
    "[ fig : fig2].,width=453 ]     fs ) and ( b ) after ( at @xmath210 fs ) steady state is established . in all calculations ,",
    "the incident plane wave enters the tf region from the lower left corner of the tf / sf boundary ( dashed lines ) with incident angle @xmath105 .",
    "the incident wavelength in vacuum is @xmath201 nm ( period @xmath202 fs ) , and the steady - state amplitude of the incident magnetic field is @xmath203 a / m .",
    "the metal slab is @xmath117 nm thick with drude parameters : @xmath118 , @xmath119 rad / s , and @xmath120 rad / s .",
    "the media above and below the slab are vacuum , the mesh size is @xmath208 nm , and the courant number is @xmath209 .",
    "a log color scale is used in all plots .",
    "the thick , dashed ( thin , dotted ) rectangle indicates the tf / sf ( inner pml ) boundary .",
    "the slab does not penetrate into the pml region.,width=472 ]     and ( b ) the transmission coefficient @xmath111 as a function of the mesh size @xmath113 .",
    "( c ) maximum leakage as a function of mesh size @xmath113 .",
    "the courant number is @xmath209 in all calculations . in all figures ,",
    "the red , solid ( blue , dashed ) curve shows the result without ( with ) the interface averaging of the dielectric constants .",
    "the parameters of the incident wave and the metal slab are the same as in the calculations leading to of fig . [",
    "fig : fig4].,width=453 ]     nm thick drude metal with parameters : @xmath118 , @xmath119 rad / s , and @xmath120 rad / s .",
    "the upper layer is a @xmath129 nm dielectric with dielectric constant @xmath107 . the media below and above the two layers are vacuum .",
    "the panels in the right column illustrate the scattering due to a slit of width @xmath133 nm and depth @xmath134 nm in the same layered structure as in the left column . rows 1 , 2 , and 3 show snapshots at @xmath211 , @xmath212 , @xmath213 fs ( before a steady state is established ) ; row 4 shows the snapshot at @xmath210 fs ( after a steady state is established ) .",
    "for all calculations , the incident plane wave enters the tf region from the lower left corner of the tf / sf boundary with with incident angle @xmath100 .",
    "the incidence wavelength is @xmath201 nm ( period @xmath202 fs ) , and the steady - state amplitude of the incident magnetic field is @xmath203 a / m .",
    "the mesh size is @xmath214 nm , and the courant number is @xmath209 .",
    "a log color scale is used in all plots .",
    "the thick , dashed ( thin , dotted ) rectangle indicates the tf / sf ( inner pml ) boundary .",
    "the slabs are extended into the upml region.,width=321 ]      .[tab : tab1]comparison of the magnitude of the reflection ( @xmath110 ) and transmission ( @xmath111 ) coefficients between the analytical and numerical results for different incidence wavelengths ( @xmath215 ) .",
    "superscript @xmath36 denotes the analytical , and superscript @xmath216 denotes the numerical results . the percentages in brackets denote the relative errors in the numerical results .",
    "the mesh size is @xmath217 nm and the courant number is @xmath209 . [",
    "cols=\"^,^,^,^,^\",options=\"header \" , ]"
  ],
  "abstract_text": [
    "<S> we formulate a finite - difference time - domain ( fdtd ) approach to simulate electromagnetic wave scattering from scatterers embedded in layered dielectric or dispersive media . at the heart of our approach </S>",
    "<S> is a derivation of an equivalent one - dimensional wave propagation equation for dispersive media characterized by a linear sum of debye- , drude- and lorentz - type poles . </S>",
    "<S> the derivation is followed by a detailed discussion of the simulation setup and numerical issues . </S>",
    "<S> the developed methodology is tested by comparison with analytical reflection and transmission coefficients for scattering from a slab , illustrating good convergence behavior . </S>",
    "<S> the case of scattering from a sub - wavelength slit in a dispersive thin film is explored to demonstrate the applicability of our formulation to time- and incident angle - dependent analysis of surface waves generated by an obliquely incident plane wave . </S>"
  ]
}