{
  "article_text": [
    "we are concerned with image segmentation using the eigenvalue problem of an anisotropic linear diffusion operator , @xmath0 subject to a homogeneous dirichlet or neumann boundary condition , where the diffusion matrix @xmath1 is symmetric and uniformly positive definite on @xmath2 . in this study , we consider an anisotropic diffusion situation where @xmath1 has different eigenvalues and is defined based on the gray level of the input image .    a method employing an eigenvalue problem to study image segmentation is referred to as a spectral clustering method in the literature .",
    "this type of methods have extracted great interest from researchers in the past decade ; e.g. , see @xcite .",
    "they are typically derived from a minimum - cut criterion on a graph .",
    "one of the most noticeable spectral clustering methods is the normalized cut method proposed by shi and malik @xcite ( also see section  [ sec : relation-1 ] below ) which is based on the eigenvalue problem @xmath3 where @xmath4 is a vector representing the gray level value on the pixels , @xmath5 is a matrix defining pairwise similarity between pixels , and @xmath6 is a diagonal matrix formed with the degree of pixels ( cf .",
    "section 2.2 below ) .",
    "the operator @xmath7 corresponds to the graph laplacian in graph spectral theory .",
    "an eigenvector associated with the second eigenvalue is used as a continuous approximation to a binary or @xmath8-way vector that indicates the partitions of the input image .",
    "shi and malik suggested that image segmentation be done on a hierarchical basis where low level coherence of brightness , texture , and etc . guides a binary ( or @xmath8-way ) segmentation that provides a big picture while high level knowledge is used to further partition the low - level segments .",
    "while discrete spectral clustering methods give impressive partitioning results in general , they have several drawbacks .",
    "those methods are typically defined and operated on a graph or a data set .",
    "their implementation cost depends on the size of the graph or data set . for a large data set",
    ", they can be very expensive to implement .",
    "moreover , since they are discrete , sometimes their physical and/or geometrical meanings are not so clear . as we shall see in section  [ sec : relation-1 ] , the normalized cut method of shi and malik @xcite is linked to an anisotropic diffusion differential operator which from time to time can lead to isotropic diffusion .",
    "the objective of this paper is to investigate the use of the eigenvalue problem ( [ eq : hw - eigen ] ) of an anisotropic diffusion operator for image segmentation .",
    "this anisotropic model can be viewed as a continuous , improved anisotropic generalization of discrete spectral clustering models such as ( [ eq : malik - shi - eigen ] ) .",
    "the model is also closely related to the perona - malik anisotropic filter .",
    "the advantages of using a continuous model for image segmentation include ( i ) it has a clear physical interpretation ( heat diffusion or fick s laws of diffusion in our case ) ; ( ii ) many well developed theories of partial differential equations can be used ; ( iii ) standard discretization methods such as finite differences , finite elements , finite volumes , and spectral methods can be employed ; and ( iv ) the model does not have be discretized on a mesh associated with the given data set and indeed , mesh adaptation can be used to improve accuracy and efficiency . as mentioned early , we shall define the diffusion matrix @xmath1 using the input image and explore properties of the eigenvalue problem .",
    "one interesting property is that for many input images , the first few eigenfunctions of the model are close to being piecewise constant , which are very useful for image segmentation .",
    "however , this also means that these eigenfunctions change abruptly between objects and their efficient numerical approximation requires mesh adaptation . in this work",
    ", we shall use an anisotropic mesh adaptation strategy developed by the authors @xcite for differential eigenvalue problems .",
    "another property of ( [ eq : hw - eigen ] ) is that eigenfunctions associated with small eigenvalues possess coarse , global features of the input image whereas eigenfunctions associated with larger eigenvalues carry more detailed , localized features .",
    "the decomposition of features agrees with the view of shi and malik @xcite on the hierarchical structure of image segmentation but in a slightly different sense since all eigenfunctions come from low level brightness knowledge .",
    "the paper is organized as follows . in section  [ sec : eigen ] , we give a detailed description of the eigenvalue problem based on an anisotropic diffusion operator and discuss its relations to some commonly used discrete spectral clustering models and diffusion filters and some other models in image segmentation .",
    "section  [ sec : implement ] is devoted to the description of the finite element implementation of the model and an anisotropic mesh adaptation strategy . in section  [ sec : numerics ]",
    ", we present a number of applications in image segmentation and edge detection and demonstrate several properties of the model . some explanations to the piecewise constant property of eigenfunctions",
    "are given in section  [ sec : piecewise ] .",
    "concluding remarks are given in section  [ sec : conclusion ] .",
    "we shall use the eigenvalue problem ( [ eq : hw - eigen ] ) subject to a dirichlet or neumann boundary condition for image segmentation .",
    "we are inspired by the physics of anisotropic heat transport process ( e.g. , see @xcite ) , treating the dynamics of image diffusion as the transport of energy ( pixel values ) and viewing the eigenvalue problem as the steady state of the dynamic process .",
    "denote the principal diffusion direction by @xmath9 ( a unit direction field ) and its perpendicular unit direction by @xmath10 .",
    "let the conductivity coefficients along these directions be @xmath11 and @xmath12 .",
    "( @xmath9 , @xmath11 , and @xmath12 will be defined below . )",
    "then the diffusion matrix can be written as @xmath13 when @xmath11 and @xmath12 do not depend on @xmath14 , the diffusion operator in ( [ eq : hw - eigen ] ) is simply a linear symmetric second order elliptic operator .",
    "the anisotropy of the diffusion tensor @xmath1 depends on the choice of the conductivity coefficients .",
    "for example , if @xmath15 , the diffusion is preferred along the direction of @xmath9 .",
    "moreover , if @xmath16 , the diffusion is isotropic , having no preferred diffusion direction .    to define @xmath1 , we assume that an input image is given .",
    "denote its gray level by @xmath17 . in image segmentation",
    ", pixels with similar values of gray level will be grouped and the interfaces between those groups provide object boundaries . since those interfaces are orthogonal to @xmath18 , it is natural to choose the principal diffusion direction as @xmath19 . with this choice , we can rewrite ( [ d-1 ] ) into @xmath20 where @xmath21 .",
    "we consider two choices of @xmath11 and @xmath22 .",
    "the first one is @xmath23 where @xmath24 is a conductance function that governs the behavior of diffusion .",
    "this corresponds to linear isotropic diffusion . as in @xcite , we require @xmath25 to satisfy @xmath26 , @xmath27 , and @xmath28 as @xmath29 . for this choice , both @xmath11 and @xmath12 becomes very small across the interfaces of the pixel groups and therefore , almost no diffusion is allowed along the normal and tangential directions of the interfaces .",
    "the second choice is @xmath30 this choice results in an anisotropic diffusion process . like the first case",
    ", almost no diffusion is allowed across the interfaces of the pixel groups but , depending on the choice of @xmath25 , some degree of diffusion is allowed on the tangential direction of the interfaces .",
    "we shall show later that with a properly chosen @xmath25 the eigenfunctions of ( [ eq : hw - eigen ] ) capture certain `` grouping '' features of the input image @xmath31 very well .",
    "this phenomenon has already been observed and explored in many applications such as shape analysis @xcite , image segmentation and data clustering @xcite , and high dimensional data analysis and machine learning @xcite . in these applications ,",
    "all eigenvalue problems are formulated on a discrete graph using the graph spectral theory , which is different from what is considered here , i.e. , eigenvalue problems of differential operators .",
    "the application of the latter to image segmentation is much less known .",
    "we shall discuss the connection of these discrete eigenvalue problems with continuous ones in the next subsection .",
    "it is noted that the gray level function @xmath17 is defined only at pixels .",
    "even we can view @xmath31 as the `` ground truth '' function ( assuming there is one function whose discrete sample is the input image ) , it may not be smooth and the gradient can not be defined in the classical sense .",
    "following @xcite , we may treat @xmath31 as a properly regularized approximation of the `` true image '' so that the solution to the eigenvalue problem ( [ eq : hw - eigen ] ) exists . in the following ,",
    "we simply take @xmath31 as the linear interpolation of the sampled pixel values ( essentially an implicit regularization from the numerical scheme ) .",
    "more sophisticated regularization methods can also be employed .",
    "we only deal with gray level images in this work .",
    "the approach can be extended to color or texture images when a diffusion matrix can be defined appropriately based on all channels . in our computation , we use both dirichlet and neumann boundary conditions , with the latter being more common in image processing .      the eigenvalue problem ( [ eq : hw - eigen ] ) is closely related to a family of discrete spectral clustering models , with the earliest one being the normalized cut method proposed by shi and malik @xcite .",
    "to describe it , we define the degree of dissimilarity ( called @xmath32 ) between any two disjoint sets @xmath33 of a weighted undirected graph @xmath34 ( where @xmath35 and @xmath36 denote the sets of the nodes and edges of the graph ) as the total weight of the edges connecting nodes in the two sets , i.e. , @xmath37 wu and leahy @xcite proposed to find @xmath8-subgraphs by minimizing the maximum cut across the subgroups and use them for a segmentation of an image .",
    "however , this approach usually favors small sets of isolated nodes in the graph . to address this problem , shi and malik @xcite used the normalized cut defined as @xmath38 where @xmath39 .",
    "they sought the minimum of the functional @xmath40 recursively to obtain a @xmath8-partition of the image .",
    "the edge weight @xmath41 is chosen as @xmath42 where @xmath43 is a neighborhood of pixel @xmath44 and @xmath45 is a positive parameter . shi and malik showed that the above optimization problem is np - hard but a binary solution to the normalized cut problem can be mapped to a binary solution to the algebraic eigenvalue problem ( [ eq : malik - shi - eigen ] ) with @xmath6 being a diagonal matrix with diagonal entries @xmath46 and @xmath5 being the weight matrix @xmath47 .",
    "eigenvectors of this algebraic eigenvalue problem are generally not binary .",
    "they are used to approximate binary solutions of the normalized cut problem through certain partitioning .    to see the connection between the algebraic eigenvalue problem ( [ eq : malik - shi - eigen ] )",
    "( and therefore , the normalized cut method ) with the continuous eigenvalue problem ( [ eq : hw - eigen ] ) , we consider an eigenvalue problem in the form of ( [ eq : hw - eigen ] ) with the diffusion matrix defined as @xmath48 a standard central finite difference discretization of this problem on a rectangular mesh gives rise to @xmath49 where @xmath50 is the grid spacing and the coefficients @xmath51 are given as @xmath52 it is easy to see that ( [ eq : orthotropic - fe - scheme ] ) is almost the same as ( [ eq : malik - shi - eigen ] ) with the neighborhood @xmath53 of a pixel location @xmath54 being chosen to include the four closest pixel locations @xmath55 .",
    "the difference lies in that ( [ eq : malik - shi - eigen ] ) has a weight function on its right - hand side .",
    "moreover , it can be shown that ( [ eq : orthotropic - fe - scheme ] ) gives _ exactly _ the algebraic eigenvalue problem for the average cut problem @xmath56 where @xmath57 and @xmath58 denote the total numbers of nodes in @xmath59 and @xmath60 , respectively .",
    "notice that this problem is slightly different from the normalized cut problem and its solution is known as the fiedler value . furthermore ,",
    "if we consider the following generalized eigenvalue problem ( by multiplying the right - hand side of ( [ eq : hw - eigen ] ) with a mass - density function ) , @xmath61 we can obtain ( [ eq : malik - shi - eigen ] ) exactly with a proper central finite difference discretization .",
    "the above analysis shows that either the average cut or normalized cut model can be approximated by a finite difference discretization of the continuous eigenvalue problem ( [ eq : hw - eigen ] ) with the diffusion matrix ( [ d-5 ] ) which treats diffusion differently in the @xmath62 and @xmath63 directions . while ( [ d-5 ] ) is anisotropic in general , it results in isotropic diffusion near oblique interfaces where @xmath64 or @xmath65",
    "this can be avoided with the diffusion matrix ( [ d-2 ] ) which defines diffusion differently along the normal and tangential directions of group interfaces . in this sense ,",
    "our method consisting of ( [ eq : hw - eigen ] ) with ( [ d-2 ] ) can be regarded as an improved version of ( [ eq : hw - eigen ] ) with ( [ d-5 ] ) , and thus , an improved continuous generalization of the normalized cut or the average cut method .",
    "it should be pointed out that there is a fundamental difference between discrete spectral clustering methods and those based on continuous eigenvalue problems .",
    "the former are defined and operated directly on a graph or data set and their cost depends very much on the size of the graph or data . on the other hand ,",
    "methods based on continuous eigenvalue problems treat an image as a sampled function and are defined by a discretization of some differential operators .",
    "they have the advantage that many standard discretization methods such as finite difference , finite element , finite volume , and spectral methods can be used .",
    "another advantage is that they do not have to be operated directly on the graph or the data set .",
    "as shown in @xcite , continuous eigenvalue problems can be solved efficiently on adaptive , and especially anisotropic adaptive , meshes ( also see section  [ sec : numerics ] ) .",
    "it is worth pointing out that the graph laplacian can be connected to a continuous diffusion operator by defining the latter on a manifold and proving it to be the limit of the discrete laplacian .",
    "the interested reader is referred to the work of @xcite .",
    "the eigenvalue problem ( [ eq : hw - eigen ] ) is related to several diffusion models used in image processing .",
    "they can be cast in the form @xmath66 with various definitions of the diffusion matrix .",
    "for example , the perona - malik nonlinear filter @xcite is in this form with @xmath67 , where @xmath25 is the same function in ( [ d-3 ] ) and @xmath68 is the identity matrix .",
    "the above equation with @xmath1 defined in ( [ d-2 ] ) with @xmath69 and @xmath70 gives rise to a linear diffusion process that has similar effects as the affine gaussian smoothing process @xcite .",
    "the diffusion matrix we use in this paper in most cases is in the form ( [ d-2 ] ) with @xmath22 and @xmath11 defined in ( [ d-4 ] ) .",
    "a similar but not equivalent process was studied as a structure adaptive filter by yang et al . @xcite .",
    "the diffusion matrix ( [ d-2 ] ) can be made @xmath14-dependent by choosing @xmath22 and @xmath11 as functions of @xmath71 .",
    "weickert @xcite considered a nonlinear anisotropic diffusion model with a diffusion matrix in a similar form as ( [ d-2 ] ) but with @xmath18 being replaced by the gradient of a smoothed gray level function @xmath72 and with @xmath73 and @xmath74 .",
    "interestingly , perona and malik @xcite considered @xmath75 as an easy - to - compute variant to the perona - malik diffusion model ( with @xmath67 ) .",
    "zhang and hancock in @xcite considered @xmath76 where @xmath77 is the graph laplacian defined on the input image @xmath17 and image pixels are treated as the nodes of a graph .",
    "the weight between two nodes @xmath78 is defined as @xmath79 where @xmath80 is a prescribed positive integer and @xmath45 is a positive parameter . as in section",
    "[ sec : relation-1 ] , it can be shown that this model can be regarded as a discrete form of a linear anisotropic diffusion model .",
    "it has been reported in @xcite that the image denoising effect with this type of linear diffusion model is comparable to or in some cases better than nonlinear evolution models .",
    "the eigenvalue problem ( [ eq : hw - eigen ] ) is discretized using the standard linear finite element method with a triangular mesh for @xmath2 .",
    "the finite element method preserves the symmetry of the underlying continuous problem and can readily be implemented with ( anisotropic ) mesh adaptation . as will be seen in section  [ sec : numerics ] , the eigenfunctions of ( [ eq : hw - eigen ] ) can have very strong anisotropic behavior , and ( anisotropic ) mesh adaptation is essential to improving the efficiency of their numerical approximation .",
    "while both dirichlet and neumann boundary conditions are considered in our computation , to be specific we consider only a dirichlet boundary condition in the following .",
    "the case with a neumann boundary condition can be discussed similarly .",
    "we assume that a triangular mesh @xmath81 is given for @xmath2 .",
    "denote the number of the elements of @xmath82 by @xmath83 and the linear finite element space associated with @xmath82 by @xmath84 .",
    "then the finite element approximation to the eigenvalue problem ( [ eq : hw - eigen ] ) subject to a dirichlet boundary condition is to find @xmath85 and @xmath86 such that @xmath87 this equation can be written into a matrix form as @xmath88 where @xmath59 and @xmath89 are the stiffness and mass matrices , respectively , and @xmath4 is the vector formed by the nodal values of the eigenfunction at the interior mesh nodes .",
    "an error bound for the linear finite element approximation of the eigenvalues is given by a classical result of raviart and thomas @xcite .",
    "it states that for any given integer @xmath8 ( @xmath90 ) , @xmath91 where @xmath92 and @xmath93 are the eigenvalues ( ordered in an increasing order ) of the continuous and discrete problems , respectively , @xmath94 is the linear space spanned by the first @xmath8 eigenfunctions of the continuous problem , @xmath95 is the projection operator from @xmath96 to the finite element space @xmath97 , and @xmath98 is the energy norm , namely , @xmath99 it is easy to show ( e.g. , see @xcite ) that the project error can be bounded by the error of the interpolation associated with the underlying finite element space , with the latter depending directly on the mesh .",
    "when the eigenfunctions change abruptly over the domain and exhibit strong anisotropic behavior , anisotropic mesh adaptation is necessary to reduce the error or improve the computational efficiency ( e.g. see @xcite ) .",
    "an anisotropic mesh adaptation method was proposed for eigenvalue problems by the authors @xcite , following the so - called @xmath100-uniform mesh approach developed in @xcite for the numerical solution of pdes .",
    "anisotropic mesh adaptation provides one advantage over isotropic one in that , in addition to the size , the orientation of triangles is also adapted to be aligned with the geometry of the solution locally . in the context of image processing , this mesh alignment will help better capture the geometry of edges than with isotropic meshes .",
    "the @xmath100-uniform mesh approach of anisotropic mesh adaptation views and generates anisotropic adaptive meshes as uniform ones in the metric specified by a metric tensor @xmath101 . putting it in a simplified scenario",
    ", we may consider a uniform mesh defined on the surface of the gray level @xmath14 and obtain an anisotropic adaptive mesh by projecting the uniform mesh into the physical domain . in the actual computation , instead of using the surface of @xmath14",
    "we employ a manifold associated with a metric tensor defined based on the hessian of the eigenfunctions .",
    "an optimal choice of the metric tensor ( corresponding to the energy norm ) is given @xcite as @xmath102 where @xmath103 denotes a triangle element of the mesh , @xmath104 is the intersection of the recovered hessian matrices of the computed first @xmath8 eigenfunctions , and @xmath105 is the average of @xmath104 over @xmath103 .",
    "a least squares fitting method is used for hessian recovery .",
    "that is , a quadratic polynomial is constructed locally for each node via least squares fitting to neighboring nodal function values and then an approximate hessian at the node is obtained by differentiating the polynomial .",
    "the recovered hessian is regularized with a prescribed small positive constant which is taken to be @xmath106 in our computation .",
    "an outline of the computational procedure of the anisotropic adaptive mesh finite element approximation for the eigenvalue problem ( [ eq : hw - eigen ] ) is given in algorithm  [ alg : aniso ] . in step 5 ,",
    "bamg ( bidimensional anisotropic mesh generator ) developed by hecht @xcite is used to generate the new mesh based on the computed metric tensor defined on the current mesh .",
    "the resultant algebraic eigenvalue problems are solved using the matlab eigenvalue solver eigs for large sparse matrices .",
    "note that the algorithm is iterative .",
    "ten iterations are used in our computation , which was found to be enough to produce an adaptive mesh with good quality ( see @xcite for mesh quality measures ) .    \\1 .",
    "initialize a background mesh .",
    "compute the stiffness and mass matrices on the mesh .",
    "solve the algebraic eigenvalue problem for the first @xmath8 eigenpairs .",
    "use the eigenvectors obtained in step 3 to compute the metric tensor .",
    "use the metric tensor to generate a new mesh ( anisotropic , adaptive ) and go to step 2 .",
    "in this section , all input images are of size @xmath107 and normalized so that the gray values are between 0 and 1 .",
    "the domain of input images is set to be @xmath108\\times[0,1]$ ] .",
    "all eigenfunctions are computed with a homogeneous neumann boundary condition unless otherwise specified .",
    "when we count the indices of eigenfunctions , we ignore the first trivial constant eigenfunction and start the indexing from the second one .        a remarkable feature of the eigenvalue problem ( [ eq : hw - eigen ] ) with the diffusion matrix ( [ d-2 ] )",
    "is that for certain input images , the first few eigenfunctions are close to being piecewise constant . in fig .",
    "[ fig : synth1 ] , we display a synthetic image containing 4 objects and the first 7 eigenfunctions .",
    "the gaps between objects are 4 pixel wide .",
    "to make the problem more interesting , the gray level is made to vary within each object ( so the gray value of the input image is not piecewise - constant ) .",
    "we use the anisotropic diffusion tensor @xmath1 defined in ( [ d-2 ] ) and ( [ d-4 ] ) with @xmath109 where @xmath110 is a positive parameter . through numerical experiment",
    "section  [ sec:4.1.6 ] ) , we observe that the larger @xmath110 is , the closer to being piecewise constant the eigenfunctions are . in the same time , the eigenvalue problem ( [ eq : hw - eigen ] ) is also harder to solve numerically since the eigenfunctions change more abruptly between the objects .",
    "we use @xmath111 in the computation for fig .",
    "[ fig : synth1 ] .",
    "the computed eigenfunctions are normalized such that they have the range of @xmath112 $ ] and can be rendered as gray level images .",
    "the results are obtained with an adaptive mesh of 65902 vertices and re - interpolated to a @xmath107 mesh for rendering .",
    "the histograms of the first 3 eigenfunctions together with the plot of the first 10 eigenvalues are shown in fig .",
    "[ fig : synth7hist ] .",
    "it is clear that the first 3 eigenfunctions are almost piecewise constant .",
    "in fact , the fourth , fifth , and sixth are also almost piece constant whereas the seventh is clearly not .",
    "( their histograms are not shown here to save space but this can be seen in fig .",
    "[ fig : synth1 ] . )    fig.[fig : nzsynth1x ] shows the results obtained an image with a mild level of noise .",
    "the computation is done with the same condition as for fig .",
    "[ fig : synth1 ] except that the input image is different .",
    "we can see that the first few eigenfunctions are also piecewise constant and thus the phenomenon is relatively robust to noise .    ) , ( [ d-4 ] ) , and ( [ d-6 ] ) ( @xmath111).,width=377 ]    .",
    "the @xmath62 and @xmath63 axes of the histograms are the gray value and the number of pixels having the same gray value . ]    .",
    "the @xmath62 and @xmath63 axes of the histograms are the gray value and the number of pixels having the same gray value . ]    .",
    "the @xmath62 and @xmath63 axes of the histograms are the gray value and the number of pixels having the same gray value . ]    .",
    "the @xmath62 and @xmath63 axes of the histograms are the gray value and the number of pixels having the same gray value . ]    , width=377 ]      eigenfunctions of the laplace - beltrami operator ( on surfaces ) have been studied for image segmentation @xcite and shape analysis @xcite .",
    "thus , it is natural to compare the performance of the laplace - beltrami operator and that of the eigenvalue problem ( [ eq : hw - eigen ] ) . for this purpose ,",
    "we choose a surface such that the laplace - beltrami operator has the same diffusion matrix as that defined in ( [ d-2 ] ) , ( [ d-4 ] ) , and ( [ d-6 ] ) and takes the form as @xmath113 the main difference between this eigenvalue problem with ( [ eq : hw - eigen ] ) is that there is a weight function on the right - hand side of ( [ lb-1 ] ) , and in our model the parameter @xmath110 in ( [ d-6 ] ) is typically greater than 1 .",
    "the eigenfunctions of the laplace - beltrami operator obtained with a clean input image of fig .",
    "[ fig : nzsynth1x ] are shown in fig .",
    "[ fig : lb - eigenfunctions ] . from these figures",
    "one can see that the eigenfunctions of the laplace - beltrami operator are far less close to being piecewise constant , and thus , less suitable for image segmentation .     and the first 7 eigenfunctions of its associated laplace - beltrami operator.,width=377 ]      we continue to study the piecewise constant property of eigenfunctions of ( [ eq : hw - eigen ] ) .",
    "interestingly , this property seems related to whether the edges of the input image form a closed curve .",
    "we examine the two input images in fig .",
    "[ fig : openarc ] , one containing a few open arcs and the other having a closed curve that makes a jump in the gray level .",
    "the first eigenfunction for the open - arc image changes gradually where that for the second image is close to being piecewise constant .",
    "for the purpose of image segmentation , we would like the eigenfunctions to be as close to being piecewise constant as possible .",
    "this would mean that they change abruptly in narrow regions between objects . as a consequence",
    ", their numerical approximation can be difficult , and ( anisotropic ) mesh adaptation is then necessary in lieu of accuracy and efficiency .",
    "the reader is referred to @xcite for the detailed studies of convergence and advantages of using anisotropic mesh adaptation in finite element approximation of anisotropic eigenvalue problems with anisotropic diffusion operators . here",
    ", we demonstrate the advantage of using an anisotropic adaptive mesh over a uniform one for the eigenvalue problem ( [ eq : hw - eigen ] ) with the diffusion matrix defined in ( [ d-2 ] ) , ( [ d-4 ] ) , and ( [ d-6 ] ) and subject to the homogeneous dirichlet boundary condition . the input image is taken as the stanford bunny",
    "; see fig .",
    "[ fig : bunny41 ] .",
    "the figure also shows the eigenfunctions obtained on an adaptive mesh and uniform meshes of several sizes .",
    "it can be seen that the eigenfunctions obtained with the adaptive mesh have very sharp boundaries , which are comparable to those obtained with a uniform mesh of more than ten times of vertices .    ) , ( [ d-4 ] ) , and ( [ d-6 ] ) ( @xmath111 ) and subject to the homogeneous dirichlet boundary condition.,width=377 ]      next , we compare the performance of the diffusion matrix ( [ d-2 ] ) ( with ( [ d-4 ] ) , ( [ d-6 ] ) , and @xmath111 ) and that of a less anisotropic diffusion matrix ( cf . ( [ eq : pm - linear - diffusion ] ) , with ( [ d-6 ] ) and @xmath111 ) @xmath114 the eigenfunctions of ( [ eq : hw - eigen ] ) with those diffusion matrices with the stanford bunny as the input image are shown in fig .",
    "[ fig : ani - vs - iso ] . for ( [ d-7 ] )",
    ", we compute the eigenfunction on both a uniform mesh of size @xmath107 and an adaptive mesh of 46974 vertices .",
    "the computation with ( [ d-2 ] ) is done with an adaptive mesh of 45562 vertices .",
    "the most perceptible difference in the results is that the right ear of the bunny ( not as bright as other parts ) almost disappears in the first eigenfunction with the less anisotropic diffusion matrix .",
    "this can be recovered if the conductance is changed from @xmath111 to @xmath115 , but in this case , the eigenfunction becomes farther from being piecewise - constant .",
    "the image associated with the first eigenfunction for ( [ d-2 ] ) seems sharper than that with ( [ d-7 ] ) .    ) with the stanford bunny and with the diffusion matrix ( [ d-2 ] ) and a less anisotropic one ( [ d-7 ] ) . from left to right , ( [ d-2 ] ) on an adaptive mesh of 45562 vertices , ( [ d-7 ] ) on a uniform mesh of size @xmath107 , and ( [ d-7 ] ) on an adaptive mesh of 46974 vertices.,width=377 ]      we now examine the effects of the conductance and consider four cases : @xmath116 ( ( [ d-6 ] ) with @xmath115 ) , @xmath117 ( ( [ d-6 ] ) with @xmath111 ) , @xmath118 ( ( [ d-6 ] ) with @xmath119 ) , and @xmath120 where @xmath45 and @xmath121 are positive parameters",
    ". the last function is called tukey s biweight function and considered in @xcite as a more robust choice of the edge - stopping function in the perona - malik diffusion .",
    "we show the results with ( [ d-2 ] ) on the stanford bunny in fig .",
    "[ fig : g - choice ] .",
    "we take @xmath122 and @xmath123 for tukey s biweight function . increasing the power @xmath110 in @xmath24 defined in ( [ d-6 ] ) will make eigenfunctions steeper in the regions between different objects and thus , closer to being piecewise constant .",
    "tukey s biweight function gives a sharp result but the body and legs are indistinguishable .    .",
    "middle row : the first eigenfunctions on the bunny image for @xmath124 , respectively .",
    "bottom row : the histograms of the corresponding first eigenfunctions . ]    .",
    "middle row : the first eigenfunctions on the bunny image for @xmath124 , respectively .",
    "bottom row : the histograms of the corresponding first eigenfunctions . ]    .",
    "middle row : the first eigenfunctions on the bunny image for @xmath124 , respectively .",
    "bottom row : the histograms of the corresponding first eigenfunctions . ]    .",
    "middle row : the first eigenfunctions on the bunny image for @xmath124 , respectively .",
    "bottom row : the histograms of the corresponding first eigenfunctions . ]    .",
    "middle row : the first eigenfunctions on the bunny image for @xmath124 , respectively .",
    "bottom row : the histograms of the corresponding first eigenfunctions . ]    .",
    "middle row : the first eigenfunctions on the bunny image for @xmath124 , respectively .",
    "bottom row : the histograms of the corresponding first eigenfunctions . ]    .",
    "middle row : the first eigenfunctions on the bunny image for @xmath124 , respectively .",
    "bottom row : the histograms of the corresponding first eigenfunctions . ]    .",
    "middle row : the first eigenfunctions on the bunny image for @xmath124 , respectively .",
    "bottom row : the histograms of the corresponding first eigenfunctions . ]    .",
    "middle row : the first eigenfunctions on the bunny image for @xmath124 , respectively .",
    "bottom row : the histograms of the corresponding first eigenfunctions . ]",
    "eigenfunctions can serve as a low level image feature extraction device to facilitate image segmentation or object edge detection . generally speaking ,",
    "eigenfunctions associated with small eigenvalues contain `` global '' segmentation features of an image while eigenfunctions associated with larger eigenvalues carry more information on the detail .",
    "once the eigenfunctions are obtained , one can use numerous well developed edge detection or data clustering techniques to extract edge or segmentation information .",
    "we point out that spectral clustering methods also follow this paradigm . in this section ,",
    "we focus on the feature extraction step and employ only simple , well known techniques such as thresholding by hand , @xmath8-means clustering , or canny edge detector in the partitioning step .",
    "more sophisticated schemes can be easily integrated to automatically detect edges or get the segmentations .",
    "we point out that boundary conditions have an interesting effect on the eigenfunctions .",
    "a homogeneous dirichlet boundary condition forces the eigenfunctions to be zero on the boundary and may wipe out some structures there ( and therefore , emphasize objects inside the domain ) .",
    "it essentially plays the role of defining `` seeds '' that indicates background pixels on the image border .",
    "the idea of using user - defined seeds or intervene cues has been widely used in graph based image segmentation methods @xcite , @xcite , @xcite , @xcite . the pde eigenvalue problem ( [ eq : hw - eigen ] )",
    "can also be solved with more sophisticated boundary conditions that are defined either on the image border or inside the image . on the other hand , a homogeneous neumann boundary condition tends to keep those structures .",
    "since mostly we are interested in objects inside the domain , we consider here a homogeneous dirichlet boundary condition . the diffusion matrix defined in ( [ d-2 ] ) , ( [ d-4 ] ) , and ( [ d-6 ] ) ( @xmath111 ) is used .    in fig .",
    "[ fig : lenna_ef1 ] , we show the first eigenfunctions obtained with dirichlet and neumann boundary conditions with lenna as the input image . for the edge detection for lenna ,",
    "it is natural to extract the `` big picture '' from the first eigenfunction and get the edge information from it .",
    "we show the edges obtained by thresholding a few level lines in the top row of fig .",
    "[ fig : lenna - contour ] .",
    "since any level line with value @xmath125 is the boundary of the level set @xmath126 of an image @xmath68 , and @xmath127 is non - increasing with respect to @xmath125 , the level line is `` shrinking '' from the boundary of a wider shape to empty as @xmath125 increases from 0 to 255 .",
    "some intermediate steps give salient boundaries of the interior figure .",
    "however , to make the `` shrinking '' automatically stop at the correct edge , other clues potentially from mid or high level knowledge in addition to the low level brightness info should be integrated in the edge detection step .",
    "we also use the matlab function imcontour to get major contours , and apply @xmath8-means clustering to the eigenfunctions with @xmath128 , shown in the second row of fig .  [",
    "fig : lenna - contour ] .",
    "-means , @xmath128.,width=453 ]    we next compute for an image with more textures from @xcite ( fig .",
    "[ fig : tiger - gallery ] ) .",
    "this is a more difficult image for segmentation or edge detection due to many open boundary arcs and ill - defined boundaries .",
    "we display the the first eigenfunction and the @xmath8-means clustering results in fig .",
    "[ fig : tiger - gallery ] .",
    "the @xmath8-means clustering does not capture the object as well as in the previous example .",
    "better separation of the object and the background can be obtained if additional information is integrated into the clustering strategy .",
    "for instance , the edges detected by the canny detector ( which uses the gradient magnitude of the image ) on the first eigenfunction clearly give the location of the tiger .",
    "thus , the use of the gradient map of the first eigenfunction in the clustering process yields more accurate object boundaries . for comparison",
    ", we also show the edges detected from the input image with the canny detector .",
    "-means clustering with @xmath129.,width=529 ]    another way to extract `` simple '' features is to change the conductance @xmath25 ( e.g. , by increasing @xmath110 in ( [ d-6 ] ) ) to make the eigenfunctions closer to being piecewise constant .",
    "this makes eigenfunctions more clustered but wipes out some detail of the image too . to avoid this difficulty",
    ", we can employ a number of eigenfunctions and use the projection of the input image into the space spanned by the eigenfunctions to construct a composite image . a much better result obtained in this way with 64 eigenfunctions",
    "is shown in fig .",
    "[ fig : tigerfin ] .     in ( [ d-6 ] ) , the projection of the tiger image into the space spanned by the first 64 eigenfunctions , the contour of the projection image , the @xmath8-means clustering with @xmath130 of the projection image . ]     in ( [ d-6 ] ) , the projection of the tiger image into the space spanned by the first 64 eigenfunctions , the contour of the projection image , the @xmath8-means clustering with @xmath130 of the projection image . ]     in ( [ d-6 ] ) , the projection of the tiger image into the space spanned by the first 64 eigenfunctions , the contour of the projection image , the @xmath8-means clustering with @xmath130 of the projection image . ]     in ( [ d-6 ] ) , the projection of the tiger image into the space spanned by the first 64 eigenfunctions , the contour of the projection image , the @xmath8-means clustering with @xmath130 of the projection image . ]",
    "it should be pointed out that not always the first few eigenfunctions cary most useful information of the input image .",
    "indeed , fig .",
    "[ fig : sports - gallery ] shows that the first eigenfunction carries very little information .",
    "since the eigenfunctions form an orthogonal set in @xmath131 , we can project the input image onto the computed eigenfunctions .",
    "the coefficients are shown in fig .",
    "[ fig : sports - components ] .",
    "we can see that the coefficients for the first two eigenfunctions are very small compared with those for the several following eigenfunctions .",
    "it is reasonable to use the eigenfunctions with the greatest magnitudes of the coefficients .",
    "these major eigenfunctions will provide most useful information ; see fig .",
    "[ fig : sports - gallery ] .    -means clustering results with @xmath132 for the 3rd and the 4th eigenfunctions , respectively ; level line of value 205 of the 3rd eigenfunction , level line of value 150 of the 4th eigenfunction.,width=529 ]    . ]",
    "as we have seen in section  [ sec : numerics ] , the eigenfunctions of problem ( [ eq : hw - eigen ] ) are localized in sub - regions of the input image and the first few of them are close to being piecewise constant for most input images except for two types of images . the first type of images is those containing regions of which part of their boundaries is not clearly defined ( such as open arcs that are common in natural images ) . in this case , the first eigenfunction is no longer piecewise - constant although the function values can still be well clustered .",
    "the other type is input images for which the gray level changes gradually and its gradient is bounded ( i.e. , the image contrast is mild ) . in this case",
    ", the diffusion operator simply behaves like the laplace operator and has smooth eigenfunctions . for other types of images",
    ", the gray level has an abrupt change across the edges of objects , which causes the conductance @xmath133 to become nearly zero on the boundaries between the objects . as a consequence ,",
    "the first few eigenfunctions are close to being constant within each object . this property forms the basis for the use of the eigenvalue problem ( [ eq : hw - eigen ] ) ( and its eigenfunctions ) in image segmentation and edge detection . in this section , we attempt to explain this property from the physical , mathematical , and graph spectral points of view . we hope that the analysis , although not rigorous , provides some insight of the phenomenon .    from the physical point of view ,",
    "when the conductance @xmath133 becomes nearly zero across the boundaries between the objects , the diffusion flux will be nearly zero and each object can be viewed as a separated region from other objects . as a consequence , the eigenvalue problem can be viewed as a problem defined on multiple separated subdomains , subject to homogeneous neumann boundary conditions ( a.k.a . insulated boundary conditions ) on the boundary of the whole image and the internal boundaries between the objects .",
    "then , it is easy to see that the eigenfunctions corresponding to the eigenvalue 0 include constant and piecewise constant ( taking a different constant value on each object ) functions .",
    "this may explain why piecewise constant eigenfunctions have been observed for most input images .",
    "on the other hand , for images with mild contrast or open arc object edges , the portion of the domain associated any object is no longer totally separated from other objects and thus the eigenvalue problem may not have piecewise constant eigenfunctions .        mathematically , we consider a 1d example with an input image with two objects .",
    "the gray level of the image is sketched in fig .",
    "[ fig : a - fun ] .",
    "the edge is located at the origin , and the segmentation of the image is a 2-partition of @xmath134 $ ] and @xmath135 $ ] .",
    "the 1d version of the eigenvalue problem ( [ eq : hw - eigen ] ) reads as @xmath136 subject to the neumann boundary conditions @xmath137 .",
    "we take the conductance function as in ( [ d-6 ] ) with @xmath138 .",
    "although @xmath17 is not differentiable , we could imagine that @xmath17 were replaced by a smoothed function which has a very large or an infinite derivative at the origin . then , ( [ eq : example1 ] ) is degenerate since @xmath139 vanishes at @xmath140 . as a consequence , its eigenfunctions",
    "can be non - smooth . generally speaking , studying",
    "the eigenvalue problem of a degenerate elliptic operator is a difficult task , and this is also beyond the scope of the current work . instead of performing a rigorous analysis",
    ", we consider a simple approximation to @xmath141 , @xmath142 where @xmath121 is a small positive number .",
    "the corresponding approximate eigenvalue problem is @xmath143 the variational formulation of this eigenvalue problem is given by @xmath144 once again , the eigenvalue problem ( [ eq : exampe1-approx ] ) and the variational problem ( [ eq : ex1-variation - prob ] ) are degenerate and should be allowed to admit non - smooth solutions .",
    "the first eigenvalue of ( [ eq : exampe1-approx ] ) is 0 , and a trivial eigenfunction associated with this eigenvalue is a constant function . to get other eigenfunctions",
    "associated with 0 , we consider functions that are orthogonal to constant eigenfunctions , i.e. , we append to the optimization problem ( [ eq : ex1-variation - prob ] ) with the constraint @xmath145 it can be verified that an eigenfunction is @xmath146\\\\ c , & \\text { for } x\\in ( \\epsilon , l ] \\end{cases } \\label{1d - solution}\\ ] ] where @xmath147 .",
    "this function is piecewise constant for most part of the domain except the small region @xmath148 $ ] . since the original problem ( [ eq : example1 ] )",
    "can be viewed to some extent as the limit of ( [ eq : exampe1-approx ] ) as @xmath149 , the above analysis may explain why some of the eigenfunctions of ( [ eq : example1 ] ) behave like piecewise constant functions .",
    "the piecewise constant property can also be understood in the context of the graph spectral theory .",
    "we first state a result from @xcite .",
    "assume that @xmath150 is a undirected graph with @xmath8 connected components and the edge weights between those components are zero .",
    "if the nonnegative weights matrix @xmath5 and the diagonal matrix @xmath6 are defined as in section  [ sec : relation-1 ] , then the multiplicity of the eigenvalue 0 of the matrix @xmath151 equals the number of the connected components in the graph .",
    "moreover , the eigenspace of eigenvalue 0 is spanned by the indicator vectors @xmath152 of those components @xmath153 .",
    "[ prop-1 ]    this proposition shows that the eigenvalue zero of the algebraic eigenvalue problem ( [ eq : malik - shi - eigen ] ) could admit multiple eigenvectors as indicators of the components . as shown in section  [ sec : relation-1 ] , ( [ eq : malik - shi - eigen ] ) can be derived from a finite difference discretization of the continuous eigenvalue problem ( [ eq : hw - eigen ] ) ( with a proper choice of @xmath1 ) .",
    "thus , the indicators of the components can also be regarded as discrete approximations of some continuous eigenfunctions .",
    "this implies that the latter must behave like piecewise constant functions .",
    "interestingly , szlam and bresson @xcite recently proved that global binary minimizers exist for a graph based problem called cheeger cut where the minimum of the cut is not necessarily zero .    in the continuous",
    "setting , a properly designed conductance @xmath133 can act like cutting the input image @xmath17 into subregions along the boundary of the subregions and forcing the eigenvalue problem to be solved on each subregion . in a simplified case , we can have the following continuous analogue of proposition  [ prop-1 ] .",
    "the proof is straightforward .",
    "suppose @xmath154 is a bounded lipschitz domain , @xmath155 ( the collect of special functions of bounded variation ) and the discontinuity set @xmath103 of @xmath17 is a finite union of @xmath156 closed curves , @xmath157 is a bounded positive continuous function .",
    "we define @xmath158 for @xmath159 , and @xmath133 takes its usual meaning for @xmath160 . for any function @xmath161 , assuming @xmath162 is the discontinuity set of @xmath14 , we define the rayleigh quotient on @xmath14 as @xmath163 where @xmath164 then , the minimum of @xmath165 is zero and any piecewise constant function in @xmath166 with discontinuity set in @xmath103 is a minimizer .",
    "[ prop-2 ]    the eigenvalue problem related to the above variational problem can be formally written as    @xmath167    the equation should be properly defined for all @xmath17 , @xmath14 possibly in the space of @xmath168 .",
    "this is a degenerate elliptic problem which could admit discontinuous solutions , and it seems to be far from being fully understood . in the following proposition",
    ", we suggest a definition of weak solution in a simplified case .",
    "the property indicates that problem ( [ eq : general - eigen - prob ] ) is quite different from a classical elliptic eigenvalue problem if it has a solution in @xmath168 that takes a non - zero constant value on an open set .",
    "the proof is not difficult and thus omitted .",
    "suppose @xmath2 is a bounded lipschitz domain in @xmath169 , @xmath170 and the discontinuity set @xmath103 of @xmath17 is a finite union of @xmath156 closed curves , @xmath157 is a bounded positive continuous function .",
    "we define @xmath158 for @xmath159 , and @xmath133 takes its usual meaning for @xmath160 .",
    "we define @xmath161 to be a weak eigenfunction of ( [ eq : general - eigen - prob ] ) satisfying a homogeneous dirichlet boundary condition if @xmath171 where , assuming that @xmath162 is the discontinuity set of @xmath14 , the integral on the left side is defined by @xmath172 if a weak eigenfunction @xmath161 exists and takes a non - zero constant value on a ball @xmath173 , then the corresponding eigenvalue @xmath174 is zero .",
    "[ prop-3 ]    if ( [ eq : general - eigen - prob ] ) indeed admits non - zero piecewise - constant eigenfunctions , one can see an interesting connection between ( [ eq : general - eigen - prob ] ) ( for simplicity we assume a homogeneous dirichlet boundary condition is used ) and grady s random walk image segmentation model @xcite where multiple combinatorial dirichlet problems are solved for a @xmath8-region segmentation with predefined seeds indicating segmentation labels",
    ". using a similar argument in section 2.2 , one can show that the numerical implementation of the method is equivalent to solving a set of laplace problems which are subject to a neumann boundary condition on the image border and dirichlet boundary conditions on the seeds and are discretized on a uniform mesh for potentials @xmath175",
    ", @xmath176 . these boundary problems read as @xmath177 where @xmath178 is the set of seeds for label @xmath179 and @xmath180 is the set of all seeds . this problem with a proper choice of @xmath25",
    "also gives a solution that has well clustered function values , a phenomenon called `` histogram concentration '' in @xcite .",
    "note that when @xmath181 , the following equation , which is an anisotropic generalization of ( [ eq : general - eigen - prob ] ) , @xmath182 becomes exactly the laplace equation in grady s model which is the euler - lagrange equation of the energy @xmath183 while the proper definition of functional ( [ eq : bv - energy ] ) for general @xmath14 , @xmath31 possibly in @xmath168 is missing , we can still define it for a simpler case as in proposition 5.2 .",
    "then , there is no unique minimizer of this energy , and , as stated in proposition 5.2 , any minimizer of the above energy in @xmath184 yields the minimum value 0 in the ideal case ( with proper @xmath25 and @xmath31 as in proposition 5.2 ) .",
    "while the eigenvalue method considers the minimizer of the above energy on the admissible set @xmath185 , the random walk method considers the minimizer satisfying boundary conditions in ( [ eq : grady - model ] ) .",
    "both gives piecewise - constant minimizers that can be used for image segmentation .",
    "we have introduced an eigenvalue problem of an anisotropic differential operator as a tool for image segmentation .",
    "it is a continuous and anisotropic generalization of some commonly used , discrete spectral clustering models for image segmentation .",
    "the continuous formulation of the eigenvalue problem allows for accurate and efficient numerical implementation , which is crucial in locating the boundaries in an image .",
    "an important observation from numerical experiment is that non - trivial , almost piecewise constant eigenfunctions associated with very small eigenvalues exist , and this phenomenon seems to be an inherent property of the model .",
    "these eigenfunctions can be used as the basis for image segmentation and edge detection .",
    "the mathematical theory behind this is still unknown and will be an interesting topic for future research .",
    "we have implemented our model with a finite element method and shown that anisotropic mesh adaptation is essential to the accuracy and efficiency for the numerical solution of the model .",
    "numerical tests on segmentation of synthetic , natural or texture images based on computed eigenfunctions have been conducted .",
    "it has been shown that the adaptive mesh implementation of the model can lead to a significant gain in efficiency .",
    "moreover , numerical results also show that the anisotropic nature of the model can enhance some nontrivial regions of eigenfunctions which may not be captured by a less anisotropic or an isotropic model .",
    "d.  martin , c.  fowlkes , d.  tal , and j.  malik .",
    "a database of human segmented natural images and its application to evaluating segmentation algorithms and measuring ecological statistics . in _ proc .",
    "8th intl conf . computer vision _",
    ", volume  2 , pages 416423 , july 2001 ."
  ],
  "abstract_text": [
    "<S> we propose the eigenvalue problem of an anisotropic diffusion operator for image segmentation . </S>",
    "<S> the diffusion matrix is defined based on the input image . the eigenfunctions and </S>",
    "<S> the projection of the input image in some eigenspace capture key features of the input image . </S>",
    "<S> an important property of the model is that for many input images , the first few eigenfunctions are close to being piecewise constant , which makes them useful as the basis for a variety of applications such as image segmentation and edge detection . the eigenvalue problem is shown to be related to the algebraic eigenvalue problems resulting from several commonly used discrete spectral clustering models . </S>",
    "<S> the relation provides a better understanding and helps developing more efficient numerical implementation and rigorous numerical analysis for discrete spectral segmentation methods . </S>",
    "<S> the new continuous model is also different from energy - minimization methods such as geodesic active contour in that no initial guess is required for in the current model . </S>",
    "<S> the multi - scale feature is a natural consequence of the anisotropic diffusion operator so there is no need to solve the eigenvalue problem at multiple levels . a numerical implementation based on a finite element method with an anisotropic mesh adaptation strategy </S>",
    "<S> is presented . </S>",
    "<S> it is shown that the numerical scheme gives much more accurate results on eigenfunctions than uniform meshes . </S>",
    "<S> several interesting features of the model are examined in numerical examples and possible applications are discussed .    </S>",
    "<S> * key words . </S>",
    "<S> * eigenvalue problem , image segmentation , finite - element schemes , mesh adaptation , anisotropic diffusion .    * ams 2010 mathematics subject classification . * 65n25 , 68u10 , 94a08 </S>"
  ]
}