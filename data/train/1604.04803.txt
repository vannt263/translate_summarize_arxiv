{
  "article_text": [
    "error detection in next generation sequencing ( ngs ) data is an important task for the accurate interpretation of polymorphisms in a population of genomes . for example , detecting sequencing errors and their correction is one of the first pre - processing steps in the assembly of haplotypes in viral populations @xcite and in single nucleotide polymorphisms ( snps ) detection for viral populations @xcite .",
    "the fundamental premise of error correction is that a true sequence in the genome is sampled via multiple reads whereas errors in sample preparation and sequencing occur randomly .",
    "thus the replicates in ngs data can be used to identify true sequences and sequencing errors occurring in small numbers of reads can be differentiated from the true sequences . a number of error correction methods for ngs data from haploid or diploid genomes ( eg .",
    "@xcite ) use this principle to identify error - free regions in the sampled reads , and then correct the regions with sequencing errors .",
    "however , error correction is especially challenging for datasets from a heterogeneous population of closely related genomes , such as those observed in viruses within a host @xcite .",
    "typically , haplotypes that exist at a low frequency in the population , also known as rare variants , are sampled less frequently and their prevalence is close to that of sequencing errors in the ngs data .",
    "while the reasons for viral diversity are well understood @xcite , a mutation error rate close to the sequencing error rate for many viral polymerases makes it difficult to detect the full mutation spectrum of viruses .",
    "additionally , preparation of rna viruses such as the hepatitis c virus ( hcv ) and the human immunodeficiency virus ( hiv ) for sequencing include a reverse - transcriptase ( rt ) step and a polymerase chain reaction ( pcr ) step , both of which introduces errors in the sequenced reads .",
    "error correction for viral populations typically involves aligning reads to a known reference sequence , and then marking the bases observed corresponding to every position in the genome as either as a true variant or a sequencing error based on a probabilistic model followed by hypothesis testing @xcite .",
    "however , the possibility of extensive diversity in a virus population hinders the accurate mapping of reads to any one reference .",
    "alternatively , sampled reads are broken into small fixed length sub - strings called @xmath0-mersand their counts are used for error correction .",
    "the @xmath0-mercounts are modeled using a generative model to determine a @xmath0-merfrequency threshold @xcite ; @xmath0-merswith counts greater than the threshold are marked as true @xmath0-mersand used for correcting other @xmath0-mers .",
    "the size of the @xmath0-merand the frequency threshold are important parameters affecting an algorithm s performance . for viral populations ,",
    "a single threshold is not suitable as haplotypes occur at different relative frequencies .",
    "additionally , the choice of @xmath0-mersize either decreases the evidence for a segment of the genome for a large @xmath0 , or combines evidences from multiple segments for a small @xmath0 .",
    "moreover , most error correction algorithms based on @xmath0-merfrequencies @xcite have been designed assuming the reads are sampled from a single diploid genome ; thus these models are not applicable to single stranded viral populations",
    ".    currently , a number of time and memory efficient @xmath0-mercounting algorithms are available @xcite .",
    "thus , choosing an appropriate size of @xmath0-meris possible by performing @xmath0-mercounts at multiple sizes @xcite .",
    "however , a single appropriate @xmath0-mersize for error correction in viral populations is restrictive in nature , as a combination of different sized overlapping @xmath0-mers , although redundant , can provide richer information .",
    "the notion of utilizing redundant information from different @xmath0-merlengths simultaneously has parallels in signal processing , where signals analysis at different resolutions has traditionally been used for noise reduction @xcite .",
    "signals are represented as projections over a frame , which consists of a series of non - orthonormal basis functions @xcite ; these projections are used for error removal and signal recovery @xcite .    in this paper",
    ", we propose frames for genomic sequences and define genomic sequences as spatial signals .",
    "the spatial signals for the genomic sequences , the sequenced reads and @xmath0-mersin the ngs data are projected on the frames and these projections are used for removing sequencing errors and detecting rare variants in the ngs data .",
    "we propose a random forest classifier , multires , trained on the frame - based projections of ngs data for the detection of rare variants and the removal of sequencing errors .",
    "the frames are defined such that each frame corresponds to @xmath0-mersof a given size .",
    "the classifier in multires is trained on a simulated dataset that models ngs data generated from a replicating viral population .",
    "multires can then by used for error detection on real sequencing data obtained from the same sequencing technology .",
    "we evaluate the performance of multires on simulated and real datasets , and compare it to other error correction methods bless @xcite , quake @xcite , bfc @xcite , and musket @xcite .",
    "we also compare our results to bayeshammer @xcite and seecer @xcite , which can handle variable sequencing coverage across the genome and polymorphisms in the rna sequencing data respectively .",
    "multires has a high recall of the true @xmath0-mers , comparable to other methods and has 5 to 500 times better removal of erroneous @xmath0-merscompared to other methods .",
    "we also compare snp detection from multires to variant calling methods vphaser-2 @xcite , lofreq @xcite and haplotype reconstruction method shorah @xcite .",
    "multires has the higher recall of true snps compared to the snps called by vphaser-2 , lofreq and shorah on both simulated and real datasets , and misses the least number of true snps amongst all methods .",
    "multires has applications for studying the large scale variation in closely related genomes , such as viral populations .",
    "the complexity of de bruijn graphs , useful for studying structural variants and rearrangements in the population , increases because of sequencing errors .",
    "our method can provide a compact set of @xmath0-merswhile still retaining high recall of the true @xmath0-mers , which can be utilized for constructing the graph .",
    "additionally , the error corrected @xmath0-merspredicted by multires can be directly used for understanding the snps observed in the viral population to a high degree of accuracy .",
    "a family of functions @xmath1 in a hilbert space @xmath2 is a * frame * for @xmath2 if there exists positive constants @xmath3 and @xmath4 such that @xmath5 for all @xmath6 ( @xcite ) . here , @xmath7 is the inner product of the function @xmath8 with a function @xmath9 in the family , while @xmath10 is the inner product of the function @xmath8 with itself in the space @xmath2 , also known as the norm of @xmath8 .",
    "the functions in @xmath1 are not necessarily orthogonal to each other .",
    "thus , @xmath7 or the projections form a redundant representation of the function @xmath8 on the family @xmath11 .",
    "redundant projections of a signal have been exploited for noise reduction in signal processing @xcite .",
    "the genomic sequence of a haplotype in a viral population can be represented as a discrete spatial signal with a non - zero signal at a spatial position representing the base observed at the corresponding genomic position .",
    "notationally , a haplotype @xmath12 of length @xmath13 is represented as a discrete 4-dimensional spatial signal @xmath14 where the signal at the @xmath15 position is defined by a 4-dimensional vector @xmath16 = ( x_{a}[n],x_{c}[n],x_{g}[n],x_{t}[n])^{\\prime}$ ] for @xmath17 .",
    "the element @xmath18 $ ] corresponds to the base @xmath19 observed at position @xmath20 of the genome .",
    "a haplotype s spatial signal is represented by @xmath21 , or @xmath12 in short , and @xmath16 $ ] is used to denote its @xmath15 sample in the rest of the paper .    for the spatial signal @xmath14 of a single haplotype",
    "two conditions hold true at each position @xmath20 :",
    "( i ) @xmath18 \\in \\{0,1\\}$ ] , and ( ii ) @xmath22 } = 1 $ ] for @xmath23 .",
    "in other words , the non - zero entry in the 4-dimensional vector @xmath24,x_{c}[n],x_{g}[n],x_{t}[n])^{\\prime}$ ] at position @xmath20 indicates that the corresponding base is observed at that position .    for a viral population @xmath25 containing a collection of viral haplotypes , @xmath26",
    ", we can define a spatial signal for each of the individual haplotypes @xmath27 for @xmath28 , and @xmath20 denotes the spatial position in the signal for the haplotype @xmath29 , as mentioned above .    for a collection of reads",
    "@xmath30 sampled from the viral population @xmath25 , each read can be represented by a spatial signal @xmath31 .",
    "the signal is non - zero for a fixed number of spatial positions equal to the read length , and is defined as described above .",
    "a translation operator @xmath32 shifts a genomic signal @xmath12 by one spatial position to the right .",
    "mathematically , the translated signal @xmath33 is defined as @xmath34 = h[n-1]$ ] for its @xmath15 sample .    a genomic signal translated by @xmath35 bases to the right",
    "is denoted as @xmath36 , where @xmath37 = h[n - r]$ ] .",
    "the translation operator is useful as an identical subsequence of bases ( or a @xmath0-mer ) at multiple locations in the genome can be represented as translations of a single spatial signal .",
    "a read sampled from a specific location in the genome can be represented by translation of its spatial signal by an appropriate number of bases .",
    "thus , a single spatial signal @xmath38 can be constructed for all the reads where the signal at the @xmath15 position represents the distribution of bases observed at that position in all the haplotypes . here",
    "@xmath39 =   ( r_{a}[n],r_{c}[n],r_{g}[n],r_{t}[n])^{\\prime}$ ] where @xmath40 $ ] denotes the number of aligned reads which have the base @xmath41 at position @xmath20 , and so on .",
    "as the genomes are represented as 4-dimensional spatial signals , the standard definitions of vector addition and scalar multiplication apply to them . for two genomic signals @xmath42 and @xmath43 defined above",
    ", the inner product of the two signals is defined as : @xmath44\\cdot y_{b}[n]}}$ ] the inner product of two genomic signals measures the similarity of the two sequences represented by @xmath42 and @xmath43 .",
    "when @xmath42 , @xmath43 represent genomic signals of a single haplotype , the inner product reduces to a kronecker delta product between the elements of @xmath42 and @xmath43 at each spatial location @xmath20 .",
    "if @xmath42 is a spatial signal from the sequenced reads and @xmath43 represents a haplotype @xmath29 , then the inner product provides a measure of the concordance between the sequenced reads and the haplotype @xmath29 .        a set @xmath45 of signals is defined as a collection of @xmath46 discrete 4-dimensional spatial signals .",
    "the signals in the set @xmath45 have a one - to - one correspondence to the set of all possible @xmath46 @xmath0-mers .",
    "signals in the set @xmath45 are denoted as @xmath47 , where the index @xmath0 denotes that the signal belongs to the set @xmath45 and the index @xmath48 denotes one of the @xmath46 @xmath0-mers .",
    "each signal @xmath47 is non - zero only at spatial positions @xmath49 $ ] and has exactly one non - zero entry in the four axes at a given spatial position .",
    "for example , the set @xmath50 consists of four spatial signals : @xmath51 , where @xmath52 is defined as follows :    @xmath53 =   \\begin{cases } ( 1,0,0,0 ) & \\text{if } n=0 \\\\   ( 0,0,0,0 ) &   \\text{otherwise } \\end{cases}\\ ] ]    the signals @xmath54 , @xmath55 , and @xmath56 are defined in similar fashions where , at @xmath57 , the second , third , and fourth dimension of the 4-dimensional vector is respectively one .",
    "thus , the signals @xmath52 , @xmath54 , @xmath55 , and @xmath56 correspond to the @xmath58-mers ( a , c , g , t ) being observed at the first position of the genome .",
    "a pictorial representation for a signal in the set @xmath59 corresponding to @xmath60-mer aatcgat shows that the @xmath60-mer can be trivially reconstructed from the signal by replacing the non - zero base value on the y - axis at the spatial position depicted by the x - axis ( figure [ fig : timings ] ) .",
    "we can also obtain the set @xmath45 of signals iteratively using the signals in the set @xmath62 and the translations of the signals in the set @xmath50 .",
    "@xmath63    where @xmath64 is a signal in the set @xmath62 and @xmath65 is the translation of the signal @xmath66 to the position @xmath67 . in other words ,",
    "the signal for @xmath0-bases in the genome can be obtained by taking a signal for the first @xmath67-bases and appending it with the translated version of a signal in the set @xmath50 .",
    "the set of signals in @xmath45 thus denote the @xmath46 possible @xmath0-mersthat exist in @xmath68 .",
    "a family of signals is obtained by translating the signals in the set @xmath45 to any spatial position @xmath35 .",
    "mathematically , @xmath69 which corresponds to all translations of the signals in the set @xmath45 by @xmath70 spatial positions .",
    "the family is indexed by three parameters : @xmath0 indicating the set @xmath45 of signals used , @xmath71 indicating a particular signal of the possible @xmath46 signals in the set @xmath45 , and @xmath35 indicating a spatial position to which the signal @xmath47 is translated .",
    "the family of signals @xmath72 physically corresponds to signals for @xmath0-mersobserved at any position in a genome .",
    "for example , the signal @xmath73 corresponds to the signal @xmath47 translated by @xmath35 bases to the right , so that it is non - zero between positions @xmath35 to @xmath74 . in other words , it corresponds to the @xmath0-merrepresented by @xmath47 starting at position @xmath35 in the genome .",
    "thus , as @xmath47 varies over the set @xmath45 , the family @xmath72 can represent all @xmath0-mersat all genomic positions .",
    "this is important as the genome of any haplotype can be represented in terms of a family of signals for a given size @xmath0 .",
    "we define a function @xmath75 , given a genomic signal @xmath12 and a family @xmath72 , as :    @xmath76 , @xmath77 denotes the inner - product of the signal @xmath12 with the generating signal @xmath47 that has been translated by @xmath35 positions , a member of the family @xmath72 .",
    "the function @xmath77 is indexed by @xmath71 and @xmath35 , where @xmath71 ranges between @xmath58 to @xmath46 and @xmath35 ranges over the spatial positions .",
    "for example , consider the projections of @xmath12 onto the family @xmath78 .",
    "here , @xmath79 denotes the unique projections of @xmath12 onto the signals in the family @xmath78 . as a signal @xmath80 ,",
    "is non - zero only at one spatial position , namely @xmath35 , and the genomic signal @xmath12 has only non - zero entry at each spatial position , the function @xmath79 is equal to one only in the direction of the base observed in @xmath12 at a position @xmath35 .",
    "this allows us to uniquely express @xmath12 using its projections , namely : @xmath16",
    "= \\sum_{b\\in\\{a , c , g , t\\ } } { \\tilde{f_1}(l , r ) \\cdot ( t^r\\cdot c_{1,b})[n]}$ ] .",
    "this is easy to see , as the members of the family @xmath78 are orthonormal and are non - zero at only one spatial position and for only one of the four dimensions .",
    "each of the signal samples a single base at a single spatial position in the signal @xmath12 and the collection of projections @xmath79 is another way to specify the genomic signal @xmath12 .",
    "this is very similar to the concept of sifting property of discrete delta functions in signal processing .",
    "the family @xmath72 forms a frame for representing genomic signals @xcite and can be used for representing any genomic signal @xmath12 . in other words , genomic signal @xmath12 can be described using its projections onto the family of functions @xmath72 .",
    "these projections can be used to completely specify the signal @xmath12 .    in order to show that @xmath72 forms a frame ,",
    "we show that equation [ framedefn ] holds for all genomic signal @xmath12 with the inner - product as defined above .",
    "we show two properties for the function @xmath81 that demonstrate @xmath72 is indeed a frame for genomic signals and the fact that only analyzing the @xmath0-merspresent in a genome is sufficient for its representation .",
    "[ kmermaxvalue ] the maximum value of the projection @xmath81 for signal @xmath12 from a single genome , @xmath82    as the projection @xmath81 is bounded by @xmath0 for a single genome and there are only finite number of non - zero projections ( @xmath83 total projections ) on the family @xmath72 , the upper bound @xmath4 for the frame definition ( equation [ framedefn ] ) can be obtained trivially @xmath84 .",
    "even for the sampled reads signal @xmath85 , its projections are again bounded by @xmath86|}$ ] in a @xmath87spatial domain window .",
    "the lower bound @xmath3 can be obtained as all non - zero signals have projection of at least one .",
    "thus , the bounds in the frame definition are still valid and the family of signals @xmath72 is indeed a frame .",
    "we next show that the projection of a genomic signal @xmath12 is maximized when the generating signal is for the @xmath0-mermatching the genomic signal @xmath12 .",
    "[ kmermax ] the @xmath0-mer@xmath88 observed at position @xmath35 in the signal @xmath12 corresponds to the signal in the family @xmath72 for which the inner product @xmath89 is maximized @xmath90 .",
    "proposition [ kmermax ] suggests that of all the projections of @xmath12 onto the family @xmath72 in a @xmath87spatial positions window , the maximum projection is on the generating signal corresponding to the @xmath0-merof @xmath12 in the same window .",
    "we refer to this projection as the _ maximal projection _ for a signal @xmath12 in a @xmath87base window .",
    "this is helpful as it gives the mathematical proof from the signals domain about something that is well known in practice , namely , that the a genome can be expressed in terms in terms of @xmath0-mersof a given length .",
    "as the family @xmath72 forms a frame for the discrete four - dimensional spatial signals , the projections of the reads signal onto this family forms can be used to represent the signal .",
    "the maximal projections of the sampled reads signal @xmath92 onto the frame @xmath72 can be computed using the above definitions and we show below that they are directly proportional to the count of the @xmath0-merspresent in the sampled reads .",
    "consider the projection of the reads signal @xmath92 onto a signal @xmath93 : @xmath94 , ( t^r \\cdot c_{k , l } ) \\rangle = \\sum_{i } { \\langle r_i[n ] , ( t^r \\cdot c_{k , l } ) \\rangle } $ ] where the summation on the right is over all the reads . as",
    "the signal @xmath95 is non - zero only for spatial locations @xmath35 to @xmath96 , only reads sampled from that segment in the viral genomes would contribute terms to the summation .",
    "if we only focus on the maximal projections of the reads signal , the individual inner - products for a read @xmath97 $ ] will attain their maximum value @xmath0 ( using propositions [ kmermaxvalue ] and [ kmermax ] ) when the generating signal @xmath47 matches the @xmath0-merpresent in @xmath97 $ ] in this window .",
    "thus , for a particular generating signal @xmath98 , the number of times it achieves its maximum will be exactly equal to the number of times a @xmath0-meris observed in the all the reads at the positions @xmath35 to @xmath74 .",
    "if one considers all the maximal projections of the reads signal @xmath99 onto the frame @xmath72 , the values of the projections are in fact equal to the counts of @xmath0-merstimes the constant @xmath0 .",
    "this is crucial as the properties of projections of signals can now be applied to the counts of @xmath0-mersfor distinguishing between erroneous and rare variant @xmath0-mers , both of which have low @xmath0-mercounts in the sampled reads .",
    "the above equation implies that as long as the size of @xmath0 is large enough that a @xmath0-mercan only be sampled from a single location in the genome , all its observed counts would contribute to exactly one generating signal @xmath98 in the family @xmath72 . in viral populations , where repeats are small , it is possible to choose reasonable values of @xmath0 for the above to be true .",
    "thus , the choice of @xmath0 for the frame @xmath72 is important and should be large enough such that a @xmath0-meronly occurs once in the haplotypes . on the other hand",
    ", it should be smaller than the read lengths so that @xmath0-mercounting is still meaningful .",
    "the minimum @xmath0 can be approximated by ensuring that the probability of picking a string of length @xmath13 where all @xmath0-mersin it occur only once @xcite .",
    "thus the probability of picking approximately @xmath13 unique @xmath0-mersout of a set of @xmath100 ( considering reverse complements ) should be low .",
    "we set @xmath101 , where @xmath102 is a small number , to determine the smallest possible choice of @xmath0 ( @xmath103 ) for the frame @xmath104 .",
    "the reads signal can be projected onto multiple families of signals as additional redundancy helps in reducing the noise in the signal , as long as the noise is random @xcite .",
    "if the parameter @xmath0 for a frame @xmath72 is greater than @xmath103 , the maximal projections of the reads signal will be proportional to the counts of the @xmath0-mers , and one can choose multiple such frames for representing the reads .",
    "for example , given the frames @xmath72 , @xmath105 , @xmath106 for @xmath107 , the maximal projections of the reads signal on these three frames will correspond to the counts of the @xmath0-mers , @xmath108-mers , @xmath109-mers of all the reads .",
    "the projections of the reads signals onto a series of frames can be used for detection of erroneous windows and of rare variants similar to noise removal in signal processing @xcite . as the projections of the reads are obtained in a window of fixed size",
    "we also perform detection of rare variants and errors based on the @xmath0-mersand their projections onto a series of frames .    for a @xmath0-mer@xmath88 occurring @xmath110 times in the reads",
    "we denote its spatial signal as @xmath111 .",
    "the maximal projection of @xmath111 onto the frame @xmath72 is @xmath112 . for @xmath0-values @xmath113 in the range",
    "@xmath114 $ ] , the signal @xmath115 can also be projected onto the frames @xmath105 and @xmath106 .",
    "as before , the maximal projections of @xmath115 onto these frames are equal to the counts of @xmath108-mers and @xmath109-mers present within @xmath88 in their respective dimensions and frames .",
    "the counts of the @xmath0-mersalong with the counts of their sub - sequences ( sub @xmath0-merswithin a @xmath0-mer ) are used as features for training a classifier .",
    "the true @xmath0-mersobserved in the viral haplotypes with counts in the reads less than a threshold @xmath116 are defined to be rare variant @xmath0-mers , while the rest of @xmath0-merswith counts less than @xmath116 are erroneous @xmath0-mers .",
    "the @xmath0-mersthat occur at counts greater than @xmath116 are known as common @xmath0-mers , as they occur frequently in the viral haplotypes .",
    "the common @xmath0-mersare assumed to be error - free and the classifier is trained only for the erroneous and rare variant @xmath0-mers .",
    "we define a classifier , @xmath117 , for classifying a @xmath0-meras erroneous , a rare variant , or a common @xmath0-merin the dataset .",
    "algorithm [ alg:01 ] describes multires , the proposed algorithm for detecting rare variants and removing sequencing errors .",
    "the algorithm takes as input the sampled reads @xmath118 , the classifier @xmath117 , an ordered array @xmath119 , and a threshold parameter @xmath116 .",
    "it outputs for every @xmath0-merobserved in the sampled reads a status : whether the @xmath0-meris erroneous or a rare variant .",
    "it first computes the counts of @xmath0-mers , @xmath120-mers , and @xmath109-mers using the dsk @xmath0-mercounting software @xcite .",
    "the @xmath0-mers@xmath88 that have counts greater than @xmath116 are marked as true @xmath0-merswhile the rest of the @xmath0-mersare classified using the classifier @xmath117 based on their projections onto the two frames .",
    "the classifier @xmath117 captures the profile of erroneous versus rare variant @xmath0-mersfrom illumina sequencing of viral populations .",
    "we used the software dsk ( version 1.6066 ) @xcite for @xmath0-mercounting , which can perform the @xmath0-mercounts in a limited memory and disk space machine quickly .",
    "the run time of multires is linearly dependent on the number of unique @xmath0-mersin a dataset , as once the classifier @xmath117 is trained , it can be used for all datasets , and it can be easily parallelized .",
    "* input : * sampled reads @xmath118 , classifier @xmath117 , @xmath119 , @xmath116 + * output : * @xmath121 for all @xmath0-mers@xmath88 in the sampled reads , where @xmath122 ( true @xmath0-mer , erroneous @xmath0-mer )    compute counts @xmath123 of @xmath0-mers , @xmath108-mers and @xmath124-mers from the sampled reads @xmath118 .",
    "@xmath125 @xmath126 @xmath127 @xmath128 @xmath129 $ ] use classifier @xmath117 to classify the @xmath0-mer@xmath88 using its features @xmath130 output @xmath131 for @xmath0-mer@xmath88 based on the classifier output output @xmath132 for the @xmath0-mer@xmath88 // mark the @xmath0-meras true      multires assumes the availability of a classifier @xmath117 which can distinguish between the erroneous and rare variant @xmath0-mersbased on their projections onto frames .",
    "we use simulated datasets to train a series of classifiers and set @xmath117 to the classifier which has the highest accuracy .",
    "a simulated a viral population consisting of 11 haplotypes is generated by mutating 10% of positions on a known hiv-1 reference sequence of length 9.18 kb ( nc_001802 ) .",
    "the mutations introduced are randomly and uniformly distributed so that the classifier is not biased towards the distribution of true variants .",
    "thus , we introduces a total of 195k ground truth unique @xmath133-mers in the simulated hiv-1 dataset .",
    "we next simulate illumina paired - end sequencing reads using the software dwgsim ( https://github.com/nh13/dwgsim ) at 400x sequencing coverage from this viral population .",
    "the status of each @xmath0-merin this dataset is known as being erroneous , rare variant or a common @xmath0-mer . a 10% random sub - sample of all the @xmath0-mersis used as training dataset .",
    "in order to train a classifier , we need to choose the size of the @xmath0-mer , the sizes of @xmath108-mers for computing the projections of @xmath0-mersignals , and the number of such projections needed . the choice of the smallest of @xmath134 should be above the minimum length @xmath103 to ensure that each @xmath0-merstill corresponds to a unique location on a viral genome .    for hiv populations , with genome length 9180 base pairs ( 9.1 kbp ) and taking @xmath135 ( a small value , as mentioned before ) , the minimum length of @xmath0-meris @xmath136 .",
    "as in signal processing domain , we choose @xmath137 ( an integral multiple of @xmath103 ) as the largest @xmath0-mer , and consider its projections on frames of sizes ranging from @xmath138 to @xmath133 .",
    "multires assumes that @xmath0-mersabove the threshold count @xmath139 are error - free , and only classifies the @xmath0-merswith counts less than @xmath139 .",
    "the choice of @xmath139 should ensure that the probability of erroneous @xmath0-merswith counts above @xmath139 is negligible .",
    "we use the gamma distribution model mentioned in the quake error correction paper @xcite for modeling erroneous @xmath0-mers , as it nicely approximates the observed distribution of errors .",
    "based on this gamma distribution , we set @xmath140 for the simulated hiv population data .",
    "the classifiers are therefore trained on @xmath133-mers with counts less than 30 .",
    "three training datasets consisting of both erroneous and rare variant @xmath133-mers are generated .",
    "the features in the three datasets are the projection of the @xmath133-mers onto ( i ) the frame @xmath141 , ( ii ) the frame @xmath142 , and ( iii ) a combination of both frames , namely @xmath143 ( figure [ fig:02 ] a ) . using proposition [ kmermax ] ,",
    "the features translate to the counts of the @xmath138-mers and @xmath144-mers observed within the @xmath133-mer along with the counts of the @xmath133-mer .",
    "we observed @xmath145 million unique @xmath133-mers in the simulated hiv-1 population , from which features from 76000 erroneous @xmath133-mers and 32000 true variant @xmath133-mers distributed uniformly over counts @xmath58-@xmath146 were used for training the classifiers .",
    "classifiers nearest neighbor , decision tree , random forest , adaboost , naive bayes , linear discriminant analysis ( lda ) , and quadratic discriminant analysis ( qda ) are trained on the three training datasets and evaluated based on their test data accuracy over a 5-fold cross validation dataset .",
    "the classifiers are implemented in the scikit - learn library ( version is 0.16.1 ) in python programming language ( version 2.7.6 ) .",
    "for all the classifiers , the accuracy improves as the @xmath133-mers are projected onto @xmath138-mers rather than @xmath144-mers ( higher resolution , lower size of @xmath108-mers ) , and improves even further when @xmath133-mers are resolved onto both @xmath138-mers and @xmath144-mers ( figure [ fig:02 ] ) .",
    "random forest classifier performs the best on all three datasets , where the accuracy for dataset ( iii ) is @xmath147 .",
    "the accuracy for naive bayes and qda classifiers are lower for all datasets , and also decreases when the projections in both @xmath138-mers and @xmath144-mers are considered , indicating that inadequacy of their models for the classification of @xmath133-mers in these projections .",
    "the performance of other classifiers are comparable and follows similar trends .",
    "additionally , we generate a series of 4 projections of the @xmath133-mers onto frames of sizes a ) @xmath148 , b ) @xmath149 , c ) @xmath150 , and d ) @xmath151 to evaluate the effect of number of frames used for projection on the performance ( figure [ fig:02 ] b ) . increasing the number of projections",
    "has no visible effect on increasing the accuracy of performance , although it increases the memory requirements and time complexity for computing counts of all five different values of @xmath0 . based on this , we chose the random forest classifier with a resolution of @xmath133-mers decomposed into a combination of @xmath138-mers and @xmath144-mers for other simulated and real datasets .",
    "multires predicts a set of error - free @xmath0-mersconstituting the rare variant and conserved segments of the genomes present in a viral population .",
    "briefly , it classifies @xmath0-mersas erroneous or rare variant @xmath0-mersbased on a collection of features extracted from the sequenced reads using a random forest classifier . the features for a @xmath0-merinclude its count in the sequenced reads and the counts of sub - sequences ( small sized @xmath0-mers ) within the @xmath0-mer .",
    "the random forest classifier is trained on a simulated dataset where the status for a @xmath0-merbeing erroneous or rare - variant is known .",
    "we evaluate multires on simulated hiv and hcv datasets and a laboratory mixture of hiv-1 strains .",
    "multires is compared to the error correction methods quake ( last checked version feb 2012 ) @xcite , bless ( version 0.15 ) @xcite , musket ( last downloaded october 2015 ) @xcite , bfc ( last downloaded october 2015 ) @xcite , bayeshammer ( version 3.6.2 ) @xcite and seecer ( version 0.1.3 ) @xcite using three measures , defined in terms of the true and erroneous @xmath0-mers . _ precision _ is defined as the ratio of the known true @xmath0-mersidentified to the total number of @xmath0-merspredicted as true variants by an algorithm .",
    "_ recall _ is defined as the ratio of the true variant @xmath0-mersidentified to the total number of true @xmath0-mersby an algorithm and measures the goodness of a method to retain true @xmath0-mersfor a dataset . _",
    "false positives to true positives ratio _ ( fp / tp ratio ) is the ratio of the erroneous @xmath0-merspredicted as true variants to the true variant @xmath0-mersidentified by the algorithm .",
    "fp / tp ratio measures the number of erroneous @xmath0-mersidentified by an algorithm to detect a single true variant @xmath0-merand is a measure of the overall volume of @xmath0-merspredicted by an algorithm .",
    "the error correction method kec @xcite was not evaluated as it is applicable to 454 pyrosequencing data .",
    "shorah @xcite reconstructs a set of haplotypes as a final output rather than error corrected reads and thus was not evaluated for error correction , but was used for single nucleotide variant calling and comparison .",
    "we first assess the performance of multires on the reads simulated from the hiv-1 population containing 11 haplotypes , generated from a single hiv-1 reference sequence ( nc_001802 ) as mentioned before .",
    "two datasets are generated from the simulated reads : one with average haplotype coverage of 100x ( denoted as hiv 100x ) , and second where the average coverage is 400x ( denoted as hiv 400x ) as increasing sequencing depth increases the absolute number of erroneous @xmath0-mersintroduced in the data .",
    "we again mention that the classifier was only trained on a 10% random sub - sample of the simulated sequenced reads and we evaluate its performance on the complete data .",
    "the recall of multires is 95% and 98% on hiv 100x and hiv 400x datasets , respectively .",
    "this is comparable to the other methods where the recall is around 98% for hiv 100x and varies from 94% to 99% for hiv 400x dataset ( table [ tab:01 ] ) .",
    "the precision of multires is 89% in the hiv 100x while the all other methods have low precisions for hiv 100x .",
    "while precision in all other methods is less than 5% for hiv 400x dataset , the precision of multires is 95% , suggesting that precision decreases for other methods with increasing sequencing depth .",
    "seecer and bayeshammer , methods which can handle variability in sequencing coverage , also have very low precision values compared to the proposed method .",
    "the fp / tp ratio obtained by multires are 4 to 500 times better than other methods and the number of @xmath0-mersretained is close to the true set of @xmath0-mersin the two datasets ( fp / tp ratio is close to zero & recall close to 95 - 98% ) .",
    "thus , while all methods retain the true @xmath0-mersto the same extent , only multires reduces the number of false positive @xmath0-mers .",
    "[ cols=\"^,^,^,^,^,^,^ \" , ]     the recall , false positive to true positive ratios ( fp / tp ) , precision , number of false negatives , and % of mapped reads by methods lofreq , vphaser-2 , shorah , and multires are computed for listed datasets .",
    "outputs from lofreq ( version 2.1.2 ) , vphaser-2 ( last downloaded version october 2015 ) , and shorah ( last downloaded version from november 2013 ) are compared against known variants for simulated datasets . for 5-viral mix ,",
    "the consensus reference provided by @xcite was used to determine ground truth variants .",
    "multires variants are determined by aligning @xmath133-mers to a reference sequence and bases occurring at more than @xmath152 frequency as variants .",
    "bold for each dataset indicates the best method for the performance measures .",
    "we have proposed a frame - based representation for genomes and developed the classifier multires for identifying rare variant and erroneous @xmath0-mersobtained from illumina sequencing of viral populations .",
    "our method does not rely on a reference sequence and uses concepts from signal processing to justify using the counts of a set of @xmath0-mersfor the classification of a @xmath0-mer .",
    "we first gave a representation of haplotype genomes as four - dimensional spatial signals and demonstrate that @xmath0-mersof a fixed size form a mathematical frame for the genomic signals .",
    "next , we showed that the projection of the sampled reads signals are maximized onto the signals corresponding to its constituent @xmath0-mersand utilize the projections of sampled reads signals onto multiple frames as features for our classifier multires .",
    "we demonstrated the performance of multires on simulated hiv and hcv viral populations and real hiv viral populations containing viral haplotypes at varying relative frequencies , where it outperformed existing error correction methods in terms of recall and the total number of predicted @xmath0-mers . though most error correction methods evaluated assumed that sequenced reads originated from a single genome sequenced at uniform coverage , our method also works better than the method bayeshammer , which can tackle non - uniform sequencing coverage , and the method seecer , which can additionally deal with alternative splicing and polymorphisms .",
    "the error corrected @xmath0-merspredicted by multires enable the usage of _ de novo _ assembly methods for closely related genomes .",
    "a major challenge for using de bruijn graph based methods for viral populations has been the increased complexity of the graph due to the presence of large number of sequencing errors @xcite .",
    "the output of our method is a set of predicted error free @xmath0-mersthat can be directly used as an input to _ de novo _ de bruijn graph based assembly methods @xcite for reconstruction of viral haplotypes in the population , and for calling structural variants directly from the assembly graph .",
    "multires has high recall of true @xmath0-merswhile outputting the least number of false positive @xmath0-mers , thereby making _ de novo _ assembly graphs manageable .",
    "another end - goal of studying viral populations is to understand the single nucleotide variation in the viral population sample .",
    "we also tested multires for prediction of snps and showed that the error corrected @xmath0-merscan be directly used for snp calling .",
    "the snps called by multires data has either the highest or the second highest recall of the snps compared to other methods for viral population , demonstrating its comparable performance for such analysis .",
    "multires relies on the counts of multiple sizes of @xmath0-mersobserved in the sequenced reads , and the choice of @xmath0-merlength is an important parameter .",
    "the minimum value of @xmath0 chosen should be such that a @xmath0-mercan only be sampled from a single location in the genome .",
    "this is possible in viral populations where there are small repeats present .",
    "choosing the number of @xmath0-mersizes used is another parameter , and while accuracy can be improved by increasing it , additional @xmath0-mercounting increased the number of computations .",
    "as demonstrated by our experiments , choosing three different values of @xmath0 , namely ( @xmath153 ) was sufficient for accurate results .",
    "multires was primarily developed for detection of sequencing errors and rare variants in viral populations , which have small genomes .",
    "extending our method for larger genomes may require additional tuning of the parameters via re - training of the classifier , but the concepts developed here are applicable to studying variation in closely related genomes such as cancer cell lines .",
    "it is also applicable for understanding somatic variation in sequences as their variation frequency is close to the sequencing error rates .",
    "the technique can also be explored for newer sequencing machines , such as pacbio sequences and oxford nanopore long read sequencing , where the type of sequencing errors are different , but the concepts of projections of signals are still applicable .",
    "the software is available for download from the github link ( https://github.com/raunaq-m/multires ) .",
    "anton bankevich , sergey nurk , dmitry antipov , alexey  a gurevich , mikhail dvorkin , alexander  s kulikov , valery  m lesin , sergey  i nikolenko , son pham , andrey  d prjibelski , et  al .",
    "spades : a new genome assembly algorithm and its applications to single - cell sequencing . , 19(5):455477 , 2012 .",
    "francesca  di giallonardo , armin tpfer , melanie rey , sandhya prabhakaran , yannick duport , christine leemann , stefan schmutz , nottania  k. campbell , beda joos , maria  rita lecca , andrea patrignani , martin dumer , christian beisel , peter rusert , alexandra trkola , huldrych  f. gnthard , volker roth , niko beerenwinkel , and karin  j. metzner .",
    "full - length haplotype reconstruction to infer the structure of heterogeneous virus populations .",
    ", 42(14):e115 , 2014 .",
    "nehal hussein , abdel - rahman  n zekri , mohamed abouelhoda , hanaa m  alam el - din , ahmed  abdelwahab ghamry , mahmoud  a amer , abeer  a bahnassy , et  al .",
    "new insight into hcv e1/e2 region of genotype 4a .",
    ", 11(1):2512 , 2014 .",
    "pavel skums , zoya dimitrova , david  s campo , gilberto vaughan , livia rossi , joseph  c forbi , jonny yokosawa , alex zelikovsky , and yury khudyakov .",
    "efficient error correction for next - generation sequencing of viral amplicons .",
    ", 13(suppl 10):s6 , 2012 .",
    "andreas wilm , pauline poh  kim aw , denis bertrand , grace hui  ting yeo , swee  hoe ong , chang  hua wong , chiea  chuen khor , rosemary petric , martin  lloyd hibberd , and niranjan nagarajan .",
    "lofreq : a sequence - quality aware , ultra - sensitive variant caller for uncovering cell - population heterogeneity from high - throughput sequencing datasets . , 2012 .",
    "xiao yang , patrick charlebois , sante gnerre , matthew  g coole , niall  j lennon , joshua  z levin , james qu , elizabeth  m ryan , michael  c zody , and matthew  r henn . de novo assembly of highly diverse viral populations .",
    ", 13(1):475 , 2012 ."
  ],
  "abstract_text": [
    "<S> we propose a frame - based representation of @xmath0-mersfor detecting sequencing errors and rare variants in next generation sequencing data obtained from populations of closely related genomes . </S>",
    "<S> frames are sets of non - orthogonal basis functions , traditionally used in signal processing for noise removal . </S>",
    "<S> we define a frame for genomes and sequenced reads to consist of discrete spatial signals of every @xmath0-merof a given size . </S>",
    "<S> we show that each @xmath0-merin the sequenced data can be projected onto multiple frames and these projections are maximized for spatial signals corresponding to the @xmath0-mer s substrings . </S>",
    "<S> our proposed classifier , multires , is trained on the projections of @xmath0-mersas features used for marking @xmath0-mersas erroneous or true variations in the genome . </S>",
    "<S> we evaluate multires on simulated and real viral population datasets and compare it to other error correction methods known in the literature . </S>",
    "<S> multires has 4 to 500 times less false positives @xmath0-merpredictions compared to other methods , essential for accurate estimation of viral population diversity and their _ de - novo _ assembly . </S>",
    "<S> it has high recall of the true @xmath0-mers , comparable to other error correction methods . </S>",
    "<S> multires also has greater than 95% recall for detecting single nucleotide polymorphisms ( snps ) , fewer false positive snps , while detecting higher number of rare variants compared to other variant calling methods for viral populations . </S>",
    "<S> the software is freely available from the github link https://github.com/raunaq-m/multires . </S>"
  ]
}