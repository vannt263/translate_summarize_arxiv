{
  "article_text": [
    "the map - making problem for cmb anisotropy measurements was first considered in the context of the cobe - dmr mission @xcite .",
    "it was further extended to quick algorithms for differential measurements @xcite taking into account @xmath0 noise @xcite .",
    "given the size of the upcoming datasets ( @xmath1 pixels for _ map _ ) it is essential that the map - making algorithm remains quick ( typically @xmath2 where @xmath3 is the number of time - samples , and @xmath4 the effective noise - filter length ) . another related question , which has been pioneered by @xcite , is how to determine the noise statistical properties from the data itself .",
    "we present a map - making method , based on wright s fast algorithm , to compute iteratively a minimum variance map together with an estimate of the detector noise power spectrum which is needed to compute unbiased power spectrum estimators of the cosmological signal .",
    "we model the data stream in the following way : @xmath5 where @xmath6 is a pixelized version of the _ observed _ sky ( i.e. convolved by the experimental beam ) , and @xmath7 is the detector noise after primary deconvolution of any filter present in the instrumental chain ( e.g. bolometer time constant , read - out filters ) .",
    "we will assume here that the experiment is a total power measurement , i.e. that the pointing matrix @xmath8 contains only one non - zero element per row .",
    "we now want to estimate the minimum variance map from this data , i.e. the map that minimizes @xmath9 .",
    "the solution is given by : @xmath10 a few remarks are necessary at this point .",
    "first , the matrix to be inverted is huge ( @xmath11 ) so that an iterative linear solver is needed .",
    "secondly , the noise correlation matrix @xmath12 has to be determined from the data itself . to make this tractable we assume that , at least over subsets of the time - stream , the noise is reasonably stationary , so that the multiplication by @xmath13 becomes a convolution operator , in other words that it is diagonal in fourier space .",
    "we thus implemented the following algorithm : +    0.5 cm to keep the algorithm as fast as possible , we took @xmath14 to be diagonal and constant , so that @xmath15 is diagonal , with each element being equal to the number of observations per pixel , up to a multiplicative constant .",
    "the choice of the numerical value of this constant is only important for the convergence properties of the algorithm . in this form , the algorithm is very similar to a jacobi iterative solver ( in which we would have @xmath16 instead of @xmath17 ) .",
    "it has the additional advantage of being very easy to compute , for very similar convergence properties .",
    "since we made the assumption that each noise matrix is diagonal in fourier space , all time - domain operations are done in fourier space using ffts , thus reducing the number of floating point operations to @xmath18 for each subset .",
    "the advantages of this iterative method are obvious : it is fast ( @xmath2 operations ) and cheap in memory ( @xmath19 storage ) . however , since we try to estimate both the noise power spectrum and the map in a leap - frog manner , the convergence properties must be studied with numerical simulations . in particular , the stability of the algorithm is function of the number of parameters that we use to describe the noise power spectrum . in other words , we have to assume some regularity in the latter , which translated in practice in fitting the amplitude of the noise in frequency band powers of varying width .      to test the properties of the algorithm , we made simulations of boomerang ldb time - streams with an scdm sky , i.e. with precisely the same scanning strategy and a beam smoothing comparable to the 150a channel .",
    "we chose this channel because it was used to determine the angular power - spectrum @xmath20 of the cmb anisotropies @xcite .",
    "the 10 days of data are approximately divided in two halves corresponding to two different azimuthal scan speeds ( 2 degrees , then 1 degree per second ) at a mean elevation of @xmath21 degrees .",
    "these two scan - speeds excited differently mechanical / thermal resonances in the instrument payload , and therefore were characterized by different noise power - spectra at low frequency ; we simulated the noise time - streams for both halves according to the noise power spectra as measured by our method over the 150a data .",
    "these power spectra are shown in figure  [ fig2 ] ( left panel ) , for both scan velocities .",
    "one can see in particular that for the two degree per second spectrum ( dotted line ) the scan - synchronous harmonics are much stronger than in the one degree per second spectrum ( where the scan - synchronous signal is actually dominated by the dipole emission ) . for a more complete description of these effects , as well as a precise description of the instrument ,",
    "we refer the reader to brendan crill s thesis ( @xcite ) .    the right panel of figure  [ fig2 ] shows the ( 1 degree per second ) spectrum of the simulated ( signal+noise ) data ( magenta ) together with the recovered noise spectrum ( black ) .",
    "one can see that most of the signal power is concentrated in a smooth continuum contribution between @xmath22 and @xmath23 ( which corresponds approximately to the beam size ) .",
    "this plot shows that a naive estimation of the noise from the data time - stream would typically result in overestimating the noise by @xmath24 at the degree scale .",
    "[ fig2 ]    in principle , the presence of strong scan - synchronous lines in the noise power spectra at low frequency , as well as the overall @xmath25 property of the noise could be taken into account by the method which would down - weight those frequencies accordingly , but in practice , because of the phase - coherent , non - gaussian nature of those scan - synchronous patterns we had to high - pass filter the data at @xmath26 .",
    "this changes the effective pointing matrix @xmath27 to @xmath28 where @xmath29 is the high - pass filter ; however , looking at eq .  [ eq1 ] , this is equivalent to leaving @xmath27 unchanged , and replacing @xmath13 by @xmath30 , which is straightforward in fourier space .",
    "the boomerang data set provides a flag with each sample data , indicating the mode of observation ( cmb scans , source scans , sz regions , etc . ) and the quality of the data ( either good or bad , where bad data corresponds to cosmic ray contamination or a scan elevation change resulting in fluctuations of the cold plate temperature ) .",
    "we thus flagged as bad in our simulations all samples not corresponding to good cmb scan data . in principle , the proper way to deal with such a data with gaps would be to construct the orthonormal noise eigenmodes basis with support constrained to the valid chunks , and do the whole analysis on this basis instead of fourier space .",
    "however , given the length of the time - stream considered here ( @xmath31 time samples ) it is completely impractical .",
    "the solution we adopted was to model those gaps as being samples spent on the observation of a @xmath32 internal calibrator considered as an additional fake pixel .",
    "we had thus to make constrained realizations of the noise time - stream as measured by the algorithm at each iteration step in those gaps , and assign their pointing matrix element outside the map to this fake pixel .    here again , the length of the time - stream comes again as a problem , since the constrained realizations involve in the best case ( when the separation between gaps is bigger than the noise correlation length @xmath33 ) inverting a matrix of linear size @xmath33 , and in the worse case a matrix of linear size comparable to the entire time - stream .",
    "fortunately , fast algorithms have been developed to answer this problem ( known as linear prediction ) .",
    "in particular , we implemented a version of burg s algorithm ( see e.g. @xcite ) to solve this problem .",
    "finally , we used healpix @xmath34 pixels @xcite , resulting in a @xmath35 pixel map . the input simulated map ( i.e. `` before observation '' ) is shown in figure  [ fig1 ] ( upper left panel ) , together with the corresponding sky coverage ( lower left panel ) .",
    "the different `` broad bands '' in the coverage file correspond to distinct scan periods of the flight at different constant sky elevations , illustrating the compromise between a uniform sky coverage and a constant elevation scanning strategy ( to avoid atmospheric gradients ) .",
    "the lower right panel shows the difference between the input map and the map recovered from the time - stream by the iterative method .",
    "we can see several important things in this error map , namely :    * the net effect of the high - pass filtering in the time - stream is to kill the largest scales in the map .",
    "the fact that the pointing matrix has been effectively changed by the filtering has been properly taken into account by the algorithm ( see discussion above ) .",
    "* there is no apparent residual striping in the error map , although a more precise way to quantify this statement may be necessary to be able to compare this method with alternative map - making algorithms . * the apparent horizontal features in the error map",
    "are related to non - uniform coverage ( compare to coverage map in the lower - left panel ) , and are _ not _ caused by residual striping .",
    "residual striping can be seen in the upper right panel of figure  [ fig1 ] , where the difference of the coadded ( `` naive '' ) and iterative maps is shown .",
    "we can in particular see that the features follow the mean direction of the scan ( as expected from striping ) and form a non - zero angle to the iso - dec direction .",
    "the method is not free of caveats however . as in any iterative linear solver ,",
    "the convergence of the solution , decomposed on the ( noise ) kernel eigenmodes , is a function of the associated eigenvalue .",
    "thus the noisiest pixel modes ( usually at large scales since the time - stream is high - pass filtered , either by hand or as part of the algorithm if the noise is higher at low frequency ) take ( exponentially ) more time to converge .",
    "the problem scales as the noise matrix condition number , which is a direct function of the noise power spectrum dynamical range and of the scanning strategy .",
    "a solution to this problem @xcite is a multi - grid version of the present algorithm , exploiting the hierarchical structure of the healpix pixelization , and rebinning the time - stream accordingly . @xcite",
    "have shown that the convergence rate on large scales is then drastically reduced .",
    "another caveat is that the distribution of the noise power spectrum estimation is skewed , leading to a small bias in the noise estimation .",
    "this is similar to the `` cosmic bias '' discussed by @xcite in the case of the @xmath20 s .",
    "a possible solution would be to approximate the likelihood distribution of the noise spectrum estimator to correct for this bias . finally , this method does not deal yet with beam asymmetry , but fast convolution methods @xcite are being developed , and will be ultimately integrated , allowing the addition of different channels with different beams to the same map .",
    "[ fig1 ] -1.5 cm",
    "we described a fast iterative map - making method to simultaneously generate the maximum - likelihood map and the noise power spectrum from a scanning experiment time stream .",
    "we tested its convergence properties on realistic boomerang simulations , including the effect of complex scan strategy and noise power spectra , resulting in a complicated noise matrix .",
    "we concluded that , except for the spatially largest ( and ill conditioned ) modes , the map and noise power spectra converge very quickly .",
    "this caveat can be cured by means of a `` convergence accelerator '' , where multi - grid methods provide a very promising solution .",
    "in addition , this method , coupled to a fast @xmath20 quadratic estimator @xcite , provide a practical way to compute the angular power spectrum of cmb fluctuations in the future megapixel experiments ."
  ],
  "abstract_text": [
    "<S> we describe here an iterative method for jointly estimating the noise power spectrum from a cmb experiment s time - ordered data , together with the maximum - likelihood map . </S>",
    "<S> we test the robustness of this method on simulated boomerang datasets with realistic noise . </S>"
  ]
}