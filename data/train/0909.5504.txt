{
  "article_text": [
    "generally , vmc involves generating a statistical estimates of the expectation values of an operator of the form @xmath3 expressing this in terms of the statistical expectation of a function @xmath4 sampled over a random distribution of @xmath0 dimensional vectors , @xmath5 , with probability density function ( pdf ) @xmath6 , gives @xmath7 }           { \\mathbb{e}\\left [     \\psi^2/p;p \\right ] } , \\ ] ] where @xmath8 = \\int x p d\\mathbf{r}$ ] is the definition of the expectation .",
    "the function @xmath9 is the ` local value ' of the operator / trial wavefunction combination .",
    "this is true for any general distribution , @xmath10 .",
    "this can also be expressed as statistical estimates constructed from samples taken from @xmath10 . introducing the notation",
    "@xmath11 $ ] for an estimate of @xmath12 constructed using @xmath13 samples , gives @xmath14 =       \\frac { \\mathbb{e}\\left [ g_l\\psi^2/p;p \\right ] + \\mathsf{y}_r }           { \\mathbb{e}\\left [     \\psi^2/p;p \\right ] + \\mathsf{x}_r }                                  = g + \\mathsf{w}_r , \\ ] ] where @xmath15 , @xmath16 , and @xmath17 are random error variables .",
    "the random variable @xmath15 is not normal , but @xmath16 and @xmath17 may be , and may be correlated to some degree .",
    "the ` standard sampling ' solution is to choose @xmath18 , with @xmath19 an unknown normalisation constant , so that @xmath14 =       \\frac{1}{r } \\sum g_l(\\text{\\sffamily\\bfseries r}_n )                                  =",
    "g + \\mathsf{y}_r , \\ ] ] and @xmath20 .",
    "as has previously been shown@xcite , singularities in @xmath21 can easily prevent the distribution of @xmath16 from being normal by invalidating the clt .",
    "although standard sampling provides the simplest analytic form for a mc estimate , there is nothing to suggest that it is optimum for controlling the statistical error in @xmath22 $ ] .",
    "returning to general sampling complicates the analysis , but provide a means of influencing the random error present in estimated quantities since the distribution of the random error , @xmath15 , is influenced by the choice of sampling distribution , @xmath10 .    writing the general sampling distribution as @xmath23 where @xmath19 is an unknown normalisation factor ,",
    "provides the estimate of @xmath24 in the more concise form @xmath14 =       \\frac { \\mathbb{e}\\left [ wg_l;p \\right ] + \\mathsf{y}_r }           { \\mathbb{e}\\left [     w;p \\right ] + \\mathsf{x}_r } .\\ ] ]    in order to control the statistics of estimates of the total energy and ( residual ) variance , we begin by introducing the local energy , @xmath25 , defined in terms of the hamiltonian operator , @xmath26 .",
    "we then limit ourselves to weights that are functions of the local energy , @xmath27 , and to operators of the form @xmath28 .",
    "expectation values of this operator , @xmath29 , then have mc estimates given by @xmath30 =       \\frac{\\sum_{n=1}^r w(\\mathsf{e}_n ) f_l ( \\mathsf{e}_n ) }            { \\sum_{n=1}^r w(\\mathsf{e}_n )                      } , \\;\\;\\;\\;\\;\\;\\;\\ ; p(e)=p_{\\epsilon}(e)\\ ] ] where @xmath31 is the @xmath32 independent identically distributed ( iid ) random variable defined as the sample local energy at @xmath33 , and distributed as @xmath34 where @xmath35 is a further unknown normalisation constant , and the integral is taken over a @xmath36 dimensional surface of constant local energy@xcite . in the last line ,",
    "@xmath37 is the distribution of local energies that occurs for standard sampling .",
    "note that @xmath38 results in standard sampling , with the @xmath39 leptokurtotic tails for @xmath40 , and the resulting clt issues for vmc .",
    "the essential feature of this approach is that different choices of weight function , @xmath41 , provide different estimators for @xmath29 , with a different distributions of random error in the estimates .    `",
    "residual sampling ' is defined by choosing the weight function to take the particular form @xmath42 where @xmath43 are parameters that influence the random error in the estimate .",
    "equation  ( [ eq:2 ] ) may be interpreted as interpolating between a perfect sampling of the numerator and denominator of an estimate of the residual variance .",
    "this weight function ensures that , provided @xmath44 increases quadratically or slower in the limit of @xmath45 approaching infinity from above or below , the sampled quantities will be bounded from above and below even in the presence of singularities in the local energy .",
    "it is the introduction of this boundary to the sample values that results in the re - introduction of the clt , as described in the next section .",
    "a further significant difference between standard and residual sampling is that the former does not sample in the region of the nodal surface , whereas the latter does .    from this point on",
    ", @xmath41 refers to eq .",
    "( [ eq:2 ] ) , and the accompanying distribution of samples in multi - dimensional space is given by @xmath46 sampling and estimation using this distribution is straightforward to implement in standard monte carlo algorithms by using the new distribution at each metropolis step , and by including @xmath41 when evaluating estimates of expectation values .",
    "values are required for @xmath43 to define the sampling strategy , but only influence the distribution of random errors in the estimate .",
    "optimum values ( in the sense of resulting in the smallest random error ) exist and may be sought for a given calculation , but roughly speaking a good choice of @xmath47 can be expected to be an approximate total energy , and a good choice of @xmath48 an estimate of the accuracy of @xmath47 .",
    "two limits exist . for @xmath49",
    "the sampling is as for the standard sampling . for @xmath50 ( with @xmath51 the expectation value of the trial wavefunction / hamiltonian combination )",
    "the sampling is perfect for the numerator of the residual variance estimator , and all the statistical error is in the denominator . for any error in @xmath47 and any finite value of @xmath48",
    "this sampling scheme is somewhere between these two extremes , hence the numerator is sampled more efficiently at the cost of introducing more error in the denominator .",
    "of course this sampling strategy is only of interest if the estimate converges to the true value for increasing sample size ( @xmath13 ) , has a controlled error , and is insensitive to the values of the parameters @xmath43 .",
    "now that the residual sampling strategy is defined , estimates for the total energy and residual variance are considered .",
    "these are of interest in their own right , and from the point of view of wavefunction optimisation methods .",
    "the next two sections define these estimates , analyse their statistical properties , and obtain distributions of the random error in the large @xmath13 limit .",
    "in addition numerical vmc calculations for an all - electron carbon atom are performed using both standard and residual sampling strategies , in order to demonstrate the new sampling strategy for a real system .",
    "it should be borne in mind that many statements about standard sampling are not true for a more general sampling method .",
    "an important example is that the residual variance that is to be estimated is not the second moment of the sampled quantity , and is unrelated to the error in the total energy estimate .",
    "the residual sampling estimate of the total energy takes the form @xmath52 =       \\frac{\\sum_{n=1}^r w(\\mathsf{e}_n ) \\mathsf{e}_n }            { \\sum_{n=1}^r w(\\mathsf{e}_n )               } , \\;\\;\\;\\;\\;\\;\\;\\ ; p(e)=p_{\\epsilon}(e).\\ ] ] in the standard sampling limit @xmath53 possesses @xmath39 asymptotes@xcite , but for finite @xmath48 the @xmath54 term in eq .",
    "( [ eq:1 ] ) results in @xmath55 asymptotic tails .    in order to characterise the random error of this estimate , due consideration must be taken of the estimate being made up of a quotient of two random variables .",
    "although @xmath56 and @xmath31 are causally related there is no reason to expect this causal relationship to hold between sums of these random variables , hence the numerator and denominator are only partially correlated .",
    "this observation provides the required route to describing the statistics .",
    "defining @xmath57 provides a bivariate random variable with a pdf that is non - zero only on a parametric curve .",
    "a normalised sum of these iid random bivariates gives a new bivariate @xmath58 with a pdf , @xmath59 , that can be derived using a standard convolution / fourier transform approach@xcite , and limit theorems obtained .",
    "note that @xmath59 is not limited to a parametric curve in the two dimensional space unless @xmath60 .",
    "underlying variables @xmath61 the distribution of the total set of random variables exists in a @xmath62 dimensional space , and the pdf of the total set of random variables is non - zero only on a @xmath13 dimensional surface in this space . the distribution of the two sums is then found by integrating over a hyper - plane that defines the numerator , and over a hyper - plane that defines the denominator , resulting in the bivariate pdf @xmath59 . ]",
    "the total energy estimate is then provided by @xmath52 = \\frac{\\mathsf{m}_2}{\\mathsf{m}_1},\\ ] ] and associated confidence limits must be obtained from the bivariate distribution of the numerator and denominator in this expression .      the distribution of errors in the estimate is most easily arrived at by initially assuming that the bivariate clt is valid , and then proving that it is so . for a valid bivariate clt the random bivariate @xmath63 possesses the pdf @xcite @xmath64 in the large @xmath13 limit .",
    "the function @xmath65 is defined in matrix notation by @xmath66 where @xmath67,\\mathbb{e}[w])$ ] , and @xmath68 is the covariance matrix defined by the elements @xmath69         - \\mathbb{e}\\left [ w    e^{i-1 }    \\right ]           \\mathbb{e}\\left [ w    e^{j-1 }    \\right ] , \\label{eq:5}\\ ] ] with @xmath70 and @xmath71 .",
    "this is the bivariate clt .    to demonstrate that the clt is valid it is sufficient to show that all of the co - moments of the original distribution exist , or that @xmath72\\ ] ] exists for all non negative @xmath73 and @xmath74 . since the integrand is finite for all @xmath45 , and the asymptotes of @xmath41 and the sampling distribution",
    "are known , it follows that the inequality @xmath75 is true for some finite @xmath76 . performing the integral",
    "explicitly gives @xmath77 and hence @xmath78 is finite for all non negative @xmath73 and @xmath74 .",
    "this demonstrates that the bivariate clt is valid , and in addition that asymptotic power law behaviour does not occur in the pdf of the random variable @xmath63 for finite @xmath13.@xcite    now that the validity of the bivariate clt is established , the distribution of the quotient of the two random variables must be considered in order to characterise the error in the total energy estimate .",
    "two approaches to this problem suggest themselves . the most direct route is to extract the pdf of the quotient directly from the bivariate normal distribution .",
    "an alternative approach is to define a @xmath79-dimensional confidence region for the bivariate distribution .",
    "both are examined here , with the second proving to be the most appropriate .",
    "a pdf of the quotient is defined in terms of the bivariate pdf via the standard formula@xcite @xmath80 evaluating this explicitly using equations  ( [ eq:3],[eq:4],[eq:5 ] ) , and taking the large @xmath13 limit a second time gives @xmath81 } , \\end{aligned}\\ ] ] hence the distribution of quotients is clearly not normal in the large @xmath13 limit , even though @xmath82 does approach a bivariate normal distribution",
    ". however , the width of this distribution scales as @xmath83 in the same manner as a normal distribution , and for @xmath84 this distribution of total energy estimates approaches a normal distribution with higher power co - moments becoming undefined in the limit .    for the general covariance matrix the asymptotic behaviour in @xmath85",
    "is given by @xmath86 } \\frac{1}{u^2 } , \\label{eq:6}\\ ] ] hence the distribution of total energy estimates possesses neither a mean or a variance . at first",
    "this seems like a serious problem , but it turns out to be irrelevant for two reasons .    the magnitude of the power law tails in eq .",
    "( [ eq:6 ] ) decreases exponentially as the number of sample points increases , which means that for any reasonable set of parameters ( and for a wide range of unreasonable parameters ) the chance of a sample point appearing in these @xmath87 tails is vanishingly small .",
    "a typical numerical value for the coefficient of @xmath87 in the asymptotic form for calculations actually carried out is @xmath88 .",
    "in addition the weight , @xmath41 , falls within the closed interval @xmath89 , and @xmath90 is also bounded , hence for finite sampling these tails do not actually occur . in effect",
    "the deviation of the finite @xmath13 distribution from the large @xmath13 limit conspires to remove these undesirable tails .",
    "the analytic form given above is not the most elegant approach to visualising the distribution of gradients .",
    "confidence intervals for the estimate are more clearly defined directly from the bivariate normal distribution by generalising the one dimensional confidence interval to a two dimensional confidence region in the space of the bivariate pdf . to achieve this",
    "the approach of fieller@xcite is adopted , and is best described geometrically ( see fig .",
    "[ fig1 ] ) .",
    "figure shows confidence regions defined for a bivariate normal distribution , @xmath91 , in order to obtain confidence intervals for ratios of the two associated random variables .",
    "the grey ellipse follows a line of constant @xmath92 , and the straight lines enclose a ` wedge ' that contains lines of gradient @xmath93 with probability @xmath76 ( see main text ) . ]",
    "an ellipse of constant probability density is defined via a new parameter @xmath94 and the equation @xmath95 which defines an elliptical probability region that contains @xmath63 with probability @xmath96 .",
    "a ` wedge ' is then defined as the region between two straight lines that pass through the origin and are tangential to this ellipse of constant probability density .",
    "the region contained inside this wedge then defines a second confidence region , that contains @xmath63 with probability @xmath76 .",
    "fieller s theorem essentially provides @xmath94 as a function of one variable , either @xmath96 ( via the hotelling s @xmath97-distribution in the large @xmath13 limit ) or @xmath76 ( via the student s t - distribution in the large @xmath13 limit ) .",
    "the second of these , @xmath98 , provides a confidence interval for the total energy estimate from the confidence wedge , since a fraction @xmath76 of @xmath63 provide total energy estimates that fall between the bounding lines of the wedge .",
    "solving for the gradient at the boundaries of the @xmath76 confidence wedge gives @xmath99 < l_u \\ ;   \\text{with confidence } \\ ; \\alpha , \\label{eq:7}\\ ] ] where @xmath100 are the gradients of wedge boundaries and are given by    @xmath101    and @xmath102    for this confidence interval to be finite the ellipse must not cross the @xmath103 line since , if it does , the confidence interval may be @xmath104 > l_u , \\mathsf{a}_r\\left[e_l\\right ] < l_l$ ] , or even @xmath105 < \\infty$ ] ( these two cases are referred to as ` exclusive unbounded ' and ` completely unbounded ' respectively , with the usual case ` bounded'@xcite ) .",
    "a check for whether these ` unbounded boundaries ' occur is straightforward to implement , and is far from being satisfied for systems of interest .",
    "in addition , finite sample size and bounded samples ensure that the unbounded cases never occur for the actual ( finite @xmath13 ) distribution of errors .",
    "the magnitude of the confidence interval scales as @xmath83 .",
    "it is not immediately apparent what type of estimate is provided by this quotient of sample means .",
    "it is a statistical estimate , as in the limit of increasing @xmath13 it approaches the true total energy , however , it is not an unbiased estimate , as its distribution has no mean .",
    "in fact no unbiased estimate of the quotient exists , since the mean of a quotient of random variables is not equal to the quotient of the mean of the random variables .",
    "equation  ( [ eq:7 ] ) provides a ` central ' estimate , in that the probability that a sampled estimate value is higher than the true total energy is equal to the probability that a sample estimate value is less than the true total energy@xcite .      in this section calculated total energies and confidence limits for an isolated all - electron carbon atom are considered , both using standard sampling and residual sampling .",
    "a numerical multi - configuration - hartree - fock calculation was performed to generate a multideterminant wavefunction consisting of @xmath106 slater determinants ( corresponding to 7 configuration state functions ( csf ) ) using the atsp2k code of fischer _",
    "_ et al.__@xcite .",
    "further correlation was introduced via a @xmath107 parameter jastrow factor@xcite , and a @xmath108 parameter backflow transformation@xcite .",
    "this @xmath109 parameter trial wavefunction was optimised using a standard variance minimisation method@xcite , resulting in @xmath110 a.u . , compared with the",
    "` exact'@xcite result of @xmath111 a.u . of those trial wavefunctions that can practically be constructed and used in qmc",
    "this may be considered to be accurate , and reproduces @xmath112 of the correlation energy at vmc level . unless otherwise stated the parameters @xmath43",
    "are taken to be the estimated total energy and variance of the local energy taken from a small standard sampling calculation .",
    "this choice is justified in what follows .",
    "the analysis of the sampled local energies uses the formulae derived above , with the expectation integrals replaced by the normalised sums of samples that are the standard unbiased estimates .",
    "the sampled estimate of the quantity @xmath113 is denoted @xmath114 , and sample estimates of the bivariate mean and covariance matrix were calculated .",
    "the primary aim of analysing the data is to characterise the statistics of the random error in sample estimates for both residual and standard sampling . generating @xmath115 local energy samples ,",
    "breaking this set of samples into subsets of various sizes and analysing each of the subsets individually provides independent sample estimates for the total energy and variance , and these are then analysed as a set of samples from the underlying distribution , @xmath92 .    within residual sampling",
    "the sample estimate of the bivariate mean obtained from @xmath13 samples is @xmath116 and the sample estimate of the covariance matrix elements take the form @xmath117    these provide an estimated value of the total energy and accompanying confidence limits @xmath118 and @xmath119 with the limits given by    @xmath120    and @xmath94 a function of the required confidence interval via eq .",
    "( [ eq:9 ] ) .",
    "if required , further information on the deviation of this distribution from the large @xmath13 limit is available from statistical estimates of higher co - moments , a fundamentally different situation to the standard sampling case .",
    "the seed probability density function estimated by a histogram of @xmath121 sampled local energies using standard sampling ( black ) and residual sampling ( grey ) .",
    "these are results for an accurate all - electron carbon trial wavefunction , as described in the text .",
    "also shown is the model distribution of eq .",
    "( [ eq:10 ] ) that reproduces the mean and variance of the samples . ]",
    "figure  [ fig2 ] shows estimates of the seed pdf , @xmath37 , constructed from taking @xmath115 samples of the local energy , binning these into intervals , and normalising@xcite .",
    "estimates are constructed from both standard sampling , for which a weight of @xmath122 per sample is binned into the chosen energy intervals , and residual sampling , for which a weight @xmath123 is binned .",
    "in addition the figure shows a ` model ' distribution of the form @xmath124 with a mean and variance of @xmath125 and @xmath126 whose values are obtained from the data using the usual unbiased estimates .",
    "this is chosen as a simple analytic form that reproduces the @xmath39 asymptotic behaviour that has been shown to be present in the seed distribution@xcite .",
    "it is clear that residual sampling takes into account the statistics of the local energy for large deviations from the estimated total energy far more precisely than standard sampling .",
    "the energy range of the figure is chosen to show the breakdown of standard sampling , but for residual sampling the estimated pdf shows the same same precision over an interval of around @xmath127 a.u . in addition the expected @xmath39 asymptotic behaviour ( and agreement with the model distribution ) are reproduced by the estimate over this range .",
    "this demonstrates a distinct difference between the two approaches - standard sampling does not sample the nodal surface and this results in weak statistical convergence to the underlying pdf , whereas residual sampling does sample the nodal surface successfully , resulting in a faster statistical convergence to the underlying pdf .",
    "residual sampling requires a choice of parameters to specify the sampling pdf , @xmath43 . although the values of these parameters influence only the statistics of the random errors in estimates , it is important to examine how variations in these parameters change the confidence ranges for estimates .",
    "figure  [ fig3 ] shows the estimates of @xmath128 that result from the numerical calculations as a function of @xmath48 .",
    "each datum was obtained using @xmath129 samples , for a range of @xmath48 values , and for a fixed @xmath130 a.u . , the standard sampling total energy estimate for the trial wavefunction . the confidence range possesses a well defined minimum for @xmath48 close to the standard deviation of @xmath131 , and for increasing @xmath48 approaches the standard sampling limit .",
    "the optimum confidence range ( assumed to be at @xmath132 ) is approximately @xmath133 of that resulting from standard sampling .",
    "confidence limits for estimates of the total energy for residual sampling , as a function of @xmath43 .",
    "data points ( with a fitted pad form to guide the eye ) are calculated for @xmath47 taken as the standard sampling estimate of the total energy .",
    "grey curves are the confidence limits resulting from the model distribution of eq .",
    "( [ eq:10 ] ) , with @xmath134 the positive deviation from the exact vmc energy . the horizontal line at @xmath135 a.u .",
    "is the standard sampling limit corresponding to @xmath48 approaching infinity . ]",
    "also shown in the figure are the confidence ranges obtained analytically for the model distribution of eq .",
    "( [ eq:10 ] ) .",
    "the figure shows the same general behaviour for the model and actual distribution , with higher accuracy for the actual results .",
    "the confidence range is shown as several functions of @xmath48 , with @xmath47 chosen to overestimate the true mean value ( known for the model distribution ) by an increasing amount , @xmath134 .",
    "the results show that for the model system the presence of an improved confidence interval is resilient to the deviations of the parameters @xmath47 and @xmath48 from their optimum values .    for the model distribution the optimum reduction in the error relative to standard",
    "sampling is a factor of @xmath136 , which occurs for @xmath137 in the large @xmath13 limit .",
    "the results suggest that an inaccurate estimate of @xmath51 can be used for @xmath47 ( an accuracy of better that @xmath138 a.u",
    ". should be sufficient ) , and that an order of magnitude estimate of the variance of the local energy may be used for @xmath48 .",
    "should this be insufficient it is always possible to optimise the confidence interval itself with respect to variations in @xmath43 .",
    "this figure shows the statistics of estimate values of the total energy .",
    "scattered points are @xmath139 estimated values of the means whose quotient provides total energy estimates .",
    "the ellipse is the estimated confidence ellipse , and the two straight line enclose the estimated confidence wedge described in the main body of the text . for a valid bivariate clt ,",
    "@xmath140 of estimates fall within the confidence wedge . ]    in calculating the confidence intervals in fig .",
    "[ fig3 ] it is implicitly assumed that the large @xmath13 limit has effectively been reached . it is desirable to convincingly show that this is in fact the case for the example calculation considered here . first a ` big ' estimate of the bivariate mean and covariance matrix is constructed from the @xmath115 sample local energies .",
    "then this set of local energy samples is separated into @xmath141 blocks of @xmath142 samples , and @xmath141 estimates of the bivariate mean are constructed from these blocks of data .    figure  [ fig4 ] shows the confidence ellipse and confidence wedge of the @xmath143 estimates predicted using the ` big ' estimate of the bivariate mean and covariance matrix .",
    "in addition the @xmath141 @xmath144 estimates are also scattered over the figure . of the sampled bivariates ,",
    "@xmath145 fall within the @xmath146 confidence wedge , in good agreement with the bivariate clt , and no suspicious outliers occur . it should be noted that a linear combination of the means is plotted on the vertical axis of the figure to make the finite width of the confidence wedge visible - otherwise the correlation between the sample means dominates and all samples appear to fall on a line passing through the origin and with a gradient given by the total energy .",
    "this data supports the suitability of the residual sampling strategy , bivariate clt , and the accompanying interpretation of error .",
    "estimated pdfs for total energy estimates constructed from different sampling strategies .",
    "the unfilled solid curve is for standard sampling , and the grey filled curve for residual sampling . in both cases , a kernel estimate of the pdf was constructed from @xmath147 total energy estimates , with each total energy estimate constructed from @xmath148 samples . ]    finally , an estimate of the pdf for total energy estimates is constructed from the numerical data , for both standard and residual sampling . dividing the @xmath115 samples into @xmath147 blocks of @xmath147 samples provides @xmath147 sample estimates of the total energy in each case .",
    "a kernel estimate@xcite of the distribution of total energy estimates is then constructed using @xmath149}{h } \\right ) , \\label{eq:11}\\ ] ] where the kernel , @xmath150 , was chosen to be a centred top - hat function of width @xmath122 , @xmath151 is the number of estimates , and @xmath152 is the width parameter , chosen heuristically to provide the clearest plot .    the estimated @xmath153 for standard and residual sampling is shown in fig .  [ fig5 ] .",
    "although @xmath39 asymptotic tails are known to be present in the distribution for standard sampling total energy estimates , for this particular calculation they are not significant at an achievable statistical resolution .",
    "there is no guarantee that this will be the case for other calculations@xcite . for residual sampling",
    "the bivariate clt is valid in its strongest form , hence such persistent leptokurtotic tails are guaranteed to be absent .    assuming the large @xmath13 limit has been reached , it is apparent that residual sampling provides an improved confidence interval ( @xmath154 of the standard sampling interval ) , with an estimated total energy of @xmath155 a.u . for standard sampling , and @xmath156 for residual sampling . to put this another way",
    ", residual sampling requires approximately half as many samples as standard sampling to achieve a given accuracy .",
    "the residual variance , @xmath157 , is defined as the integral of the square of the residual associated with the schrdinger equation , @xmath158 where @xmath159 may be considered as a variational parameter@xcite . in terms of expectation of functions over the seed distribution of residual sampling ,",
    "@xmath160 , this takes the form @xmath161 }           { \\mathbb{e}\\left [ w \\right ]                     } . \\label{eq:12}\\ ] ] the parameter @xmath159 may be varied to minimise the residual variance , or taken to be the total energy ( the two are equivalent if the expectations in the above equation are not estimated ) .    for standard sampling",
    "the clt is not valid for estimates of the residual variance@xcite .",
    "this , together with the importance of the residual variance in wavefunction optimisation methods , makes the development of an improved residual variance estimator desirable .",
    "taking @xmath162 to be the total energy gives eq .",
    "( [ eq:12 ] ) in the form @xmath163}{\\mathbb{e } \\left [ w     \\right ] } -\\left ( \\frac{\\mathbb{e } \\left [ we    \\right]}{\\mathbb{e } \\left [ w     \\right ] } \\right)^2,\\ ] ] with a statistical estimate of this quantity provided by replacing each expectation by a normalised sum of samples .    a rigorous treatment of the statistics of this estimate requires a generalisation of the bivariate analysis to the trivariate case using @xmath164 and the accompanying unbiased estimates of the means that form the partially correlated random trivariate , @xmath165 to provide the estimated residual variance as @xmath166 =        \\frac{\\mathsf{m}_2}{\\mathsf{m}_0}- \\left(\\frac{\\mathsf{m}_1}{\\mathsf{m}_0}\\right)^2.\\ ] ] confidence intervals for this quantity",
    "may , in principle , be obtained by an analogous route to the bivariate case , by obtaining an ( unbiased ) estimate of a @xmath167 covariance matrix and defining a confidence region in the @xmath2-dimensional space to provide a trivariate clt and an analogue of fieller s theorem .",
    "this added complexity is not considered to be necessary here .    instead",
    ", @xmath159 is interpreted as a variational parameter which results in an estimate of the residual variance that takes a bivariate form , and that reproduces standard sampling for @xmath168 and finite @xmath13 .",
    "a random bivariate is defined as @xmath169 the associated bivariate @xmath170 provides the random variables whose quotient is an estimate of the residual variance @xmath166 =              \\frac{\\mathsf{m}_2}{\\mathsf{m}_1}.\\ ] ] the prefactor in the definition of @xmath171 ensures that the above estimate is unbiased for the case of standard sampling . as for total energy estimates , the bivariate clt is assumed to be valid in order to define the distribution of @xmath63 , and then shown to be valid .    provided the clt is valid , the large @xmath13 pdf takes the form @xmath172 and @xmath173 the bivariate mean @xmath174 and covariance matrix , @xmath68 , are defined in terms of the supplementary variables @xmath175 by @xmath176,\\mathbb{e}[x_1]),\\ ] ] and @xmath177          -\\mathbb{e}\\left [ x_{i }       \\right ]           \\mathbb{e}\\left [ x_{j }       \\right]\\ ] ] for @xmath70 and @xmath71 .",
    "this is the bivariate clt .    to show that this clt is valid it is sufficient to show that all of the co - moments of the original distribution exist .",
    "a general co - moment can be expressed in terms of the weights and energies as @xmath178 \\\\ & = & \\sum_{k=0}^{2 m }   \\begin{pmatrix } 2 m \\\\",
    "k \\end{pmatrix }   e_{g}^{2m - k } \\mathbb{e}\\left [ w^{m+n } e^k \\right ] , \\end{aligned}\\ ] ] hence it is required to show that @xmath179 $ ] is finite for all @xmath180 and @xmath181 ( this includes the co - moments associated with @xmath51 ) . noting that the integrand is finite for all @xmath45 , and possesses asymptotes proportional to @xmath182 provides the inequalities @xmath183 & < & \\int_{-\\infty}^{\\infty } |p_{\\epsilon } w^{m+n } e^{k}| de   \\nonumber \\\\ & < & \\alpha \\int_{-\\infty}^{\\infty }   \\frac{1}{1+|e|^{2-k+2(m+n ) } } de , \\end{aligned}\\ ] ] for some finite @xmath76 , or that @xmath184 <      \\frac{2\\pi\\alpha}{2-k+2(m+n ) } \\csc\\left ( \\frac{\\pi}{2-k+2(m+n ) } \\right).\\ ] ] this inequality is valid for all non - negative @xmath73,@xmath74 and @xmath181 , and hence all co - moments exist .",
    "it then follows that the bivariate clt is valid and no asymptotic power law behaviour occurs in the pdf of @xmath63 . converting this bivariate distribution into a description of the statistics of the residual variance estimate proceeds exactly as for the total energy estimates in the previous section .",
    "all that differs is the definition of the bivariate mean and the covariance matrix .    from this point on , and in all numerical results ,",
    "we choose @xmath185 , with @xmath51 taken as the estimate of the previous section .",
    "any deviation of @xmath159 from the true expectation value of the total energy of @xmath186 does not invalidate the variational principle for which the residual variance is of interest , but it should be borne in mind that the relatively small random variation in @xmath159 is not taken into account in this error analysis .      returning to the all - electron carbon atom , a vmc estimate of the residual variance is required . the same local energy samples used for the total energy estimates are used to construct the residual variance estimates .",
    "first a ` central ' estimate of the total energy is constructed , @xmath187 and this is used to construct an estimate of the mean bivariate @xmath188 and covariance matrix elements @xmath189 ^ 2 \\nonumber \\\\ \\widehat{c}_{12}&= & \\frac{1}{r-1 } \\sum_{n=1}^{r }    \\left [ w_n(e_n - \\widehat{e}_{tot})^2 - \\widehat{\\mu}_2 \\right ] .",
    "\\left [ w_n - \\widehat{\\mu}_1                             \\right ]    \\nonumber \\\\ \\widehat{c}_{11}&= & \\frac{1}{r-1 } \\sum_{n=1}^{r }   \\left [ w_n - \\widehat{\\mu}_1                             \\right]^2 .",
    "\\label{eq:14}\\end{aligned}\\ ] ]    equations  ( [ eq:13],[eq:14 ] ) provide the sample estimate of the residual variance as @xmath190 with @xmath191 and @xmath192 defined in terms of the new @xmath144 and @xmath68 using the fieller s theorem and eq .",
    "( [ eq:8 ] ) . as before , further information on the deviation of this distribution from the large @xmath13 limit is available from estimates of higher moments .",
    "results for the all - electron carbon atom are now considered in the same manner as for the total energy estimates of the previous section , and for the same reason .",
    "beginning with the influence of the sampling parameters , @xmath43 , on the statistical error , fig .",
    "[ fig6 ] shows estimates of @xmath128 that result from the numerical calculation for a range of values of @xmath48 .",
    "each datum was obtained using @xmath129 samples , and for a fixed @xmath130 a.u . , the standard sampling total energy estimate for the trial wavefunction . as for the total energy estimate , the confidence range possesses a well defined minimum for @xmath48 close to the standard deviation of @xmath131 . however , unlike the total energy estimate , this is not a finite reduction of the clt confidence range of standard sampling , since for standard sampling the clt confidence range is not defined . in other words",
    "@xmath128 is unbounded as @xmath48 increases , and no sample estimate of the standard sampling confidence interval is shown as such a quantity does not exist .     confidence limits for estimates of the residual variance for residual sampling , as a function of @xmath43 . data points",
    "( with a fitted pad form to guide the eye ) are calculated for @xmath47 taken as the standard sampling estimate of the total energy .",
    "grey curves are the confidence limits resulting from the model distribution of eq .",
    "( [ eq:10 ] ) , with @xmath134 the positive deviation from the exact total energy .",
    "the standard sampling limit for this quantity that corresponds to @xmath48 approaching infinity is not defined . ]",
    "the figure also shows the confidence ranges resulting from the model seed distribution ( eq .  ( [ eq:10 ] ) ) , obtained analytically and plotted as functions of @xmath48 for @xmath47 chosen to overestimate the true mean value ( known for the model distribution ) by @xmath134 .",
    "the analytic form shows no upper bound , as expected , and suggests that the usefulness of the confidence range is resilient to the deviations of the parameters @xmath47 and @xmath48 from their optimum values .",
    "given that no ` standard sampling confidence range ' exists , the case for improved accuracy for residual sampling is stronger than for the total energy estimate .",
    "parameter values may be chosen by the same criteria suggested for total energy estimates , or by minimising the confidence interval itself .",
    "this figure shows the statistics of estimate values of the residual variance .",
    "scattered points are @xmath139 estimated values of the means whose quotient provides residual variance estimates .",
    "the two straight line enclose the estimated confidence wedge described in the main body of the text . for a valid bivariate clt ,",
    "@xmath140 of estimates fall within the confidence wedge . ]    to justify the validity of having reached the large @xmath13 limit with real numerical results , and the related validity of the bivariate clt , the @xmath115 sample local energies were used to generate @xmath141 estimates of the bivariate mean made up of @xmath143 samples each , and an estimate of the distribution that these are sampled from .",
    "the quantity @xmath159 was defined as the estimate of the total energy defined in section [ sec : toten ] , evaluated separately for each block .",
    "figure  [ fig7 ] shows a confidence wedge predicted for the estimates constructed from the sample covariance and mean taken from all the samples , and also shows the @xmath141 @xmath144 estimates scattered over the figure .",
    "of the sampled bivariates , @xmath193 fall within the @xmath146 confidence wedge , in agreement with the bivariate clt , and no suspicious outliers occur .",
    "this also justifies the bivariate interpretation of the residual variance estimate by showing that the statistical variation in @xmath159 is not significant .",
    "note that the degree of correlation ( although not complete ) prevents the confidence ellipse being visible .",
    "this data supports the suitability of residual sampling , the bivariate clt , and the accompanying interpretation of error for obtaining estimates of the residual variance .",
    "this is fundamentally different to the standard sampling case , where no clt is valid and the statistical error is uncontrolled .",
    "estimated pdfs for residual variance estimates constructed from different sampling strategies .",
    "the unfilled solid curve is for standard sampling , and the grey filled curve for residual sampling . in both cases , a kernel estimate of the pdf was constructed from @xmath147 residual variance estimates , with each residual variance estimate constructed from @xmath148 samples .",
    "]    finally , a kernel estimate to the pdf of the residual variance estimate is constructed for both standard and residual sampling in order to compare the distributions of error that result in the two cases .",
    "the estimated pdfs where constructed by dividing @xmath115 local energy samples into @xmath147 blocks of @xmath147 samples , constructing a residual variance estimate for each block ( using a block by block total energy estimate ) , and then constructing a kernel estimate using eq .",
    "( [ eq:11 ] ) . figure  [ fig8 ]",
    "show the resulting estimated pdfs .",
    "the estimated standard sampling distribution clearly demonstrate the invalidity of the clt , leptokurtotic tails , and accompanying outliers predicted for standard sampling in a previous paper@xcite .",
    "the estimated residual sampling distribution reflects the error analysis given earlier in this section , providing numerical evidence that the large @xmath13 limit of the bivariate clt has been reached .",
    "on comparing the properties of the two distributions , two main points suggest themselves . due to",
    "the presence of power law tails for standard sampling , it provides a far wider distribution and is more vulnerable to outliers than residual sampling .",
    "in addition , for increasing @xmath13 , the statistical spread of estimates scales as @xmath194@xcite and @xmath83 for standard and residual sampling respectively , hence standard sampling becomes even less accurate relative to residual sampling as the number of samples increases .",
    "essentially this data tells us that the random error in estimates of the residual variance is very different for standard and residual sampling .",
    "the clt fails for standard sampling , but is reintroduced for residual sampling , so residual sampling provides a confidence interval for the residual variance , whereas standard sampling does not .",
    "in addition the data suggest that the large @xmath13 limit is easily reached for practical sample sizes . the model seed distribution of eq .",
    "( [ eq:10 ] ) and the numerical data for the carbon atom suggests a standard sampling error one to two orders of magnitude larger than for residual sampling for @xmath148 , and this ratio increases as @xmath195 .",
    "the analysis given above has involved only a particular sampling / weighting function combination , referred to as residual sampling . a more general sampling function",
    "is now considered in order to show how the presence of @xmath39 asymptotic behaviour in the ` standard ' distribution of local energies @xmath131 limits the quantities that may be estimated , and the statistics of the random errors in those quantities that can be estimated .",
    "the influence of the chosen weighting / sampling functions on the applicable limit theorems can be characterised by its asymptotic behaviour , specifically by the inverse power law behaviour of the weight function as singularities in the local energy are approached .",
    "a large @xmath45 power law behaviour of @xmath196 is taken for the weight , and used to estimate the @xmath197 physical moment of the seed distribution , @xmath198 the limit theorem valid for this moment will also be valid for the expectation of any function of @xmath45 that increases as @xmath199 in the large @xmath200 limit .    the distribution of an estimate of this moment will satisfy the clt in its strongest form if all of the co - moments for the sampling strategy characterised by @xmath41 exists , that is if @xmath201,\\ ] ] exists .",
    "this is the case if the inequalities @xmath202 are satisfied for all non - negative @xmath73,@xmath74 and some finite @xmath76 .",
    "the integral on the rhs is finite provided that @xmath203 which is true for all non - negative @xmath73,@xmath74 provided that @xmath204    if this pair of inequalities is satisfied then the least general version of the bivariate clt ( that provides the strongest limits on the deviation from a gaussian distribution ) is valid for the estimated moment .",
    "this is the most desirable case , and precludes the presence of power law tails for finite @xmath13 .",
    "note that this inequality demonstrates that it is not possible to estimate @xmath205 moments or higher of the @xmath131 , which is not surprising given that these integrals are not defined .",
    "the value of @xmath206 is an exclusive upper limit on the moments that can be estimated with strong limits on their statistical error , and can not be greater than or equal to @xmath2 .",
    "the most general version of the bivariate clt that provides no limit on the deviation from a gaussian pdf for finite @xmath13 is the bivariate form of the lindeberg theorem@xcite . for this theorem to hold requires only the @xmath207 and @xmath208 order co - moments of the estimate to exist , resulting in the weaker limits",
    "@xmath209 so there is a small range of @xmath65 values between the existence of all moments and the complete invalidity of the bivariate clt where power law tails will persist into the distribution of statistical errors .",
    "no integer @xmath65 falls in this region .",
    "the @xmath65,@xmath206 values for which all moments exist tells us that the clt with the strongest limits on finite sample error is valid for estimates of all the expectations that exist for the trial wavefunction .",
    "standard sampling does not provide this ideal strategy of sampling and estimation , and many of the expectations that exist have estimates that either satisfy the clt with the weakest limits on the finite sample error , or do not satisfy the clt . the case @xmath210 and @xmath211 corresponds to the total energy and residual variance estimates for residual sampling given in the previous two sections .",
    "this analysis is limited to expectations that can be expressed in terms of the local energy field variable .",
    "it is possible to generalise the analysis given to estimates of other quantities in vmc , since expectation values of operators are generally formulated as expectations of field variables ( the local energy in the previous analysis ) over the physical pdf of the system ( the @xmath212 in the above ) .",
    "this can always be reformulated through a change of random variables to provide the estimate as a mean of a lower dimensional pdf .",
    "it has been shown @xcite that for standard sampling the clt fails and the generalised central limit theorem takes its place for a variety of estimates of physical quantities .",
    "this is a direct consequence of singularities appearing in the sampled field variable , and may be dealt with using alternative sampling .",
    "an ideal estimator would be one for which the strongest form of the clt provides confidence intervals for the estimated quantity .",
    "two complementary approaches to creating such estimators naturally suggest themselves . a first method",
    "( essentially that described in the preceding sections for total energy and residual variance estimates ) is to choose a new sampling strategy such that power law tails in the sampled quantities are removed .",
    "a second method is to construct an alternative estimator by adding terms to the sampled quantity that have a mean of zero , hence preserving the large sample size limit of the estimated quantity , but modifying the distribution of random error that occurs for finite sample size .",
    "both these approaches play a role in controlling the statistical error for general estimates .",
    "one of the most basic physical quantities for which accurate estimates are required is the kinetic energy of a system ( the electronic kinetic energy for the examples considered here ) .",
    "estimates of this are straightforward to construct in terms of a mc estimate of integrals .",
    "unfortunately , the integrand generally possesses singularities on hyper - surfaces in @xmath0-dimensional space and so uncontrolled random errors occur in the form of power law tails in pdfs .    the most direct kinetic energy estimate is provided by the operator in the hamiltonian , and takes the form @xmath213     =   \\frac{\\sum_{n=1}^r w(\\mathsf{e}_n ) \\mathsf{k}_n }             { \\sum_{n=1}^r w(\\mathsf{e}_n )                                    } , \\label{eq:15}\\ ] ] where @xmath214_{\\text{\\sffamily\\bfseries r}_n}$ ] is a local kinetic energy at a random sample point , @xmath215 , in @xmath0-dimensional space , and @xmath168 corresponds to standard sampling .",
    "this local kinetic energy possesses singularities for an electron approaching a nucleus , for an electron approaching another electron , and at the nodal surface , referred as type 1 , 2 , and 3 in @xcite ( this is true for any @xmath186 for which the kato cusp conditions are satisfied , and for which @xmath216 on the nodal surface ) . for standard sampling ,",
    "these singularities remain present in the sampled quantity , and the clt is weakly valid in the sense that @xmath217 asymptotic tails are present in the pdf of the estimate for finite sample size . for residual sampling , type",
    "3 singularities are removed , but types 1 and 2 remain , hence again the clt is weakly valid . in both cases",
    "the error is dominated by the presence of singularities of types 1 and 2 , and these are unavoidable in the sense that they will be present for the exact wavefunction .",
    "green s @xmath207 theorem provides the means to remove the type 1 and 2 singularities , giving a new estimate of the form @xmath213     =   \\frac{1}{2 }        \\frac{\\sum_{n=1}^r w(\\mathsf{e}_n ) \\mathsf{f}^2_n }             { \\sum_{n=1}^r w(\\mathsf{e}_n )                           } , \\label{eq:16}\\ ] ] where @xmath218_{\\text{\\sffamily\\bfseries r}_n}$ ] , with the sum over all electrons , and @xmath219 the drift velocity vector of electron @xmath70 .    the distribution of the random error in the estimate for both the standard and residual sampling case can be obtained in the same way as for the total energy and residual variance estimates considered previously .",
    "the sole difference is in the order of the singularities present in the averaged field variable . for standard sampling",
    "the analysis shows that the sum of random variables that make up the estimate does not obey the clt , and an infinite variance stable distribution with @xmath220 tails results . for residual sampling ,",
    "the summed random variables are bounded , hence all co - moments exist , the bivariate clt is valid in its strongest form , and fieller s theorem provides a confidence interval for the estimated kinetic energy .",
    "figure  [ fig9 ] shows a kernel estimate of the pdf for kinetic energy estimates of the same carbon trial wavefunction described earlier .",
    "the figure explicitly shows the failure of the clt for standard sampling , and the improved estimate resulting from residual variance sampling , both using eq .",
    "( [ eq:16 ] ) .     estimated pdfs for kinetic energy estimates constructed from different sampling strategies .",
    "the unfilled solid curve is for standard sampling , and the grey filled curve for residual sampling . in both cases , a kernel estimate of the pdf was constructed from @xmath147 kinetic energy estimates , with each kinetic energy estimate constructed from @xmath148 samples . ]    if we compare the results from the two different types of estimator , eq .",
    "( [ eq:16 ] ) with residual sampling provides @xmath221 a.u . , whereas eq .",
    "( [ eq:15 ] ) with standard sampling gives @xmath222 a.u .",
    "standard sampling requires eight times as many samples as residual sampling to provide the same accuracy for kinetic energy estimates , and , in addition , to obtain the confidence intervals for standard sampling it must be assumed that enough samples have been taken for the power law tails to be unimportant .    finally , we note that residual sampling can only handle singularities at the nodal surface . for many estimates a ` transfer ' of singularities with types 1 and 2 to the nodal surface",
    "may be achieved using ` zero - variance , zero - bias ' corrections of the form described by assaraf and caffarel@xcite .",
    "however , there may be quantities for which estimates that possess no type 1 or type 2 singularities are unavailable .",
    "estimates of such quantities may be still be constructed using a more general sampling strategy defined by the estimator @xmath223     =   \\frac{1}{2 }        \\frac{\\sum_{n=1}^r w(\\mathsf{g}_n ) \\mathsf{g}_n   }             { \\sum_{n=1}^r w(\\mathsf{g}_n )                } , \\ ] ] where @xmath224_{\\text{\\sffamily\\bfseries r}_n}$ ] . the sampling strategy",
    "would be defined by choosing @xmath225 to be a function of @xmath226 that ensures that the summands are bounded , all co - moments exist , and so the strongest limit theorems apply .",
    "previously it has been shown that the distribution of statistical errors in the estimates of the two most important basic quantities of variational qmc , provided by the most common ` standard sampling ' implementation of the method , result in an uncontrolled statistical error .",
    "this results in the presence of unexpected outliers in estimates , and the failure of the clt . here",
    "a more general sampling strategy is used , referred to as ` residual sampling ' .",
    "residual sampling prevents the artificial introduction of singularities in the sampled quantities that is an inherent part of the standard sampling strategy , and the accompanying statistical difficulties .",
    "the new sampling strategy reintroduces the clt for the total energy and residual variance in a strong form such that the deviation of the distribution from normal for finite sample size is known and is bounded .",
    "the ` cost ' of residual sampling is that the local energy must be evaluated in order to generate sample points with the required distribution , increasing computational expense , and that the interpretation of the random error in estimates is more complicated as the estimate must be considered as a quotient of two correlated random variables , rather than a single random variable .",
    "the price of computational cost and complexity may be justifiable for estimating the total energy .",
    "numerical results for an isolated all - electron carbon atom suggest that residual sampling provides a modest improvement in the error of the estimated total energy for the all - electron carbon atom considered , since for this case leptokurtotic power law tails are weak for achievable sample sizes .",
    "however , it should be borne in mind that these tails may be stronger for other systems , can not be accurately ( that is without bias ) estimated , and are completely removed by residual sampling .",
    "the increases in cost and complexity is justifiable for estimating the residual variance , since residual sampling provides a qualitative as well as quantitative improvement to estimates .",
    "the analysis and numerical data clearly shows that residual sampling provides a controlled and small random error , unlike the standard sampling case .",
    "this approach to controlling the random error in estimates is also expected to be important for other physical quantities - the clt has been shown to be invalid for several estimates @xcite and residual sampling , or a variant of residual sampling , provides a natural approach to achieving a normal distribution of random error .",
    "a primary application of the sampling strategies described is expected to be the optimisation of trial wavefunctions . a considerably smaller number of samples are expected to be required to obtain an accurate minimum , since the random error of the optimised quantity is not normal for standard sampling but is described by a bivariate normal distribution for residual sampling .",
    "residual sampling also does not require the introduction of _ ad hoc _ stabilisation methods , such as weight limiting@xcite .",
    "a further feature of the new sampling strategy is that it samples the trial wavefunction close to the nodal surface - the standard sampling method avoids sampling here - the region where the accuracy of the trial wavefunction influences the accuracy of subsequent diffusion monte carlo ( dmc ) calculations@xcite .",
    "an analysis of the statistical errors of estimated quantities in vmc has not previously been available in the literature .",
    "an assumption of a valid clt has repeatedly been relied upon to justify methods and results , for both the estimation of physical quantities and optimisation of trial wavefunctions .",
    "the analysis and residual sampling approach described here provide a method for predicting the random errors in qmc , and designing new sampling strategies that control and reduce the random error .",
    "it also provides the possibility of preferentially optimising a trial wavefunction in the region of the nodal surface , and so providing a new means to control the fixed node error of dmc methods .",
    "j. r. trail , phys .",
    "e  * 77 * , 016703 ( 2008 ) .",
    "d. w. stroock , _ probability theory : an analytic view _",
    "( cambridge university press , 1993 ) .",
    "b. v. gnedenko and a. n. kolomogorov , _ limit distributions for sums of independent random variables _",
    "( addison - wesley , 1968 ) .",
    "j. h. curtiss , ann .  math stat .",
    "* 12 * , 409 ( 1941 ) .",
    "u. von luxburg and v. h. franz , confidence sets for ratios : a purely geometric approach to fieller s theorem .",
    "( 133 ) , max planck institute for biological cybernetics , tbingen , germany ( 2004 ) ; e. fieller , biometrika  * 24 * , 428 ( 1932 ) . c. f. fischer , g. tachiev , g. gaigalas , and m. godefroid , comput .",
    "phys .  commun . * 176 * , 559 ( 2007 ) ( http://atoms.vuse.vanderbilt.edu ) .",
    "n. d. drummond , m. d. towler , and r. j. needs , phys .",
    "b  * 70 * , 235119 ( 2004 ) .",
    "lpez ros , a. ma , n. d. drummond , m. d. towler , and r. j. needs , phys .",
    "e * 74 * , 066701 ( 2006 ) .",
    "r. j. needs , m. d. towler , n. d. drummond and p. lpez ros , _ casino user s guide , version 2.0.0 _ ( 2006 ) .",
    "s. j. chakravorty , s. r. gwaltney , e. r. davidson , f. a. parpia , and c. f. fischer , phys .",
    "a  * 47 * , 3649 ( 1993 ) .",
    "a. j. izenman , j.  am .",
    "stat .  assoc .",
    "* 86 * , 204 ( 1991 )",
    ". h. nakatsuji , phys .",
    "lett .   * 93 * , 030403 - 1 ( 2004 ) .",
    "r. assaraf and m. caffarel , phys .",
    "* 83 * , 4682 ( 1999 ) .",
    "r. assaraf and m. caffarel , j.  chem .",
    "phys .   * 119 * , 10536 ( 2003 ) .",
    "s. d. kenny , g. rajagopal , and r. j. needs , phys .",
    "rev .  a  * 51 * , 1898 ( 1995 ) .",
    "a. badinski and r. j. needs , phys .",
    "e   * 76 * , 036707 ( 2007 ) .",
    "p. r. c. kent , r. j. needs , and g. rajagopal , phys .",
    "b  * 59 * , 12344 ( 1999 ) . w. m. c. foulkes , l. mitas , r. j. needs , and g. rajagopal , rev .",
    "phys .  * 73 * , 33 ( 2001 ) ."
  ],
  "abstract_text": [
    "<S> expectation values of physical quantities may accurately be obtained by the evaluation of integrals within many - body quantum mechanics , and these multi - dimensional integrals may be estimated using monte carlo methods . in a previous publication </S>",
    "<S> it has been shown that for the simplest , most commonly applied strategy in continuum quantum monte carlo , the random error in the resulting estimates is not well controlled . </S>",
    "<S> at best the central limit theorem is valid in its weakest form , and at worst it is invalid and replaced by an alternative generalised central limit theorem and non - normal random error . in both cases the random error is not controlled . </S>",
    "<S> here we consider a new ` residual sampling strategy ' that reintroduces the central limit theorem in its strongest form , and provides full control of the random error in estimates . </S>",
    "<S> estimates of the total energy and the variance of the local energy within variational monte carlo are considered in detail , and the approach presented may be generalised to expectation values of other operators , and to other variants of the quantum monte carlo method .    </S>",
    "<S> a primary problem in solving for the ground states of many body quantum systems is the evaluation of @xmath0-dimensional integrals , where @xmath1 is the number of particles interacting in @xmath2-dimensional space . </S>",
    "<S> this paper considers estimates of expectation values of a many body - trial wavefunction and operator combinations , with particular emphasis on those used for the optimisation of a trial wavefunction via a parameterised freedom within that wavefunction . </S>",
    "<S> monte carlo ( mc ) methods provide a powerful numerical tool for evaluating these integrals by expressing the exact integral as an expectation value . by constructing a sample estimate of this expectation value </S>",
    "<S> , such problems can be made tractable .    </S>",
    "<S> the resulting estimate is a sample taken from a random distribution , so some knowledge of this distribution and its relationship with the underlying ` true ' value must be available for it to be useful . </S>",
    "<S> past work in quantum monte carlo has taken this distribution to be normal , usually justified by expressing the estimates as sums of random variables and assuming the validity of the central limit theorem ( clt ) . </S>",
    "<S> it has recently@xcite been shown that for the usual implementation of qmc ( referred to as ` standard sampling ' ) this is only partly true for estimates of the total energy , and completely untrue for estimates of the ( residual ) variance of the local energy . </S>",
    "<S> these two quantities are the most prominent estimated quantities in variational monte carlo ( vmc ) . </S>",
    "<S> for the first of these the deviation of random errors from normal _ may _ be significant for a finite number of samples in the vmc calculation , with outliers occurring . for the second of these the random error </S>",
    "<S> are _ not normal _ even in the large sample size limit , and large outlier errors are orders of magnitude more likely than the clt suggests . </S>",
    "<S> such non - normal distributions of errors are a direct consequence of the presence of singularities in the sampled quantities at the nodal surface . </S>",
    "<S> these singularities may not easily be prevented , and have been found to result in the failure of the clt for estimates of many physical expectation values sought using qmc methods .    in what follows a new sampling strategy , referred to as ` residual sampling ' , </S>",
    "<S> is developed that reintroduces the clt in its strongest form for estimates of the total energy and ( residual ) variance of the local energy . </S>",
    "<S> the paper consists of 6 sections . in section [ sec : res ] </S>",
    "<S> the new sampling strategy is described . </S>",
    "<S> sections [ sec : toten ] and [ sec : resvar ] describe the construction of estimates of the total energy and residual variance within this sampling strategy , and derive the distribution of random errors and confidence intervals for the estimates . section [ sec : gensamp ] considers the general conditions that a sampling strategy must satisfy in order for the clt to hold for a given estimated quantity , so justifying the choice of sampling strategy . </S>",
    "<S> analytical results , or numerical results for the example case of an isolated all - electron carbon atom are presented in each section as appropriate . </S>",
    "<S> section [ sec : otherestimates ] considers how an estimate / sampling strategy combination may be chosen such that the clt is valid for an estimate of a physical quantity of interest , and the example of the electronic kinetic energy is considered . </S>",
    "<S> section [ sec : conc ] concludes the paper .    before commencing we note that this paper is the second of two closely related papers . </S>",
    "<S> the preceding paper , @xcite , develops the statistical description of the random error inherent in qmc , and derives the deficiencies of the standard sampling method . in the current paper , new sampling strategies </S>",
    "<S> are developed , together with an analysis of the accompanying random errors in estimates . </S>",
    "<S> this provides a method for avoiding the deficiencies of standard sampling by controlling the random error and introducing a valid clt for an estimate of interest . </S>"
  ]
}