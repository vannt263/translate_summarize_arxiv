{
  "article_text": [
    "both mathematicians and computer scientists have found applications for finite automata augmented with registers which store values from a given group or monoid , and are modified by multiplication .",
    "these automata , variously known as _ valence automata _ , _ extended finite automata _ or _",
    "@xmath2-automata _ , provide an algebraic method to characterize important language classes such as the context - free , recursively enumerable and blind counter languages ( see @xcite ) .",
    "their study provides insight into computational problems in algebra ( see , for example , @xcite ) .",
    "these automata are also closely related to _ regulated rewriting systems _ , and in particular the _ valence grammars _ introduced by paun @xcite : the languages accepted by @xmath2-automata are exactly the languages generated by regular @xmath2-valence grammars @xcite .    traditionally , the monoid registers are initialised to the identity element , and a word is accepted only if it can be read by a successful computation which results in the register being returned to the identity .",
    "several authors have observed that the power of these automata to describe language classes may be increased by allowing a more general set of accepting values in the register .",
    "fernau and stiebe @xcite began the systematic study of the resulting _ valence automata with target sets _ , along with the corresponding class of regulated grammars .",
    "in particular they considered the natural restriction that the target set be a _",
    "rational subset _ of the register monoid .    of particular interest ,",
    "when considering semigroups and monoids in relation to automata theory , is the class of _ polycyclic monoids_. the polycyclic monoid of rank @xmath3 is the natural algebraic model of a pushdown store on an @xmath3-letter alphabet . for @xmath2 a polycyclic monoid of rank @xmath0 or more , it is well - known that @xmath2-automata are equivalent to pushdown automata , and hence accept exactly the context - free languages .",
    "the polycyclic monoid of rank @xmath1 is called the _ bicyclic monoid _ and usually denoted @xmath4 ; we shall see below that @xmath4-automata accept exactly the _ partially blind one - counter languages _ defined by greibach @xcite .",
    "one of the main objectives of this paper is to consider the class of languages accepted by polycyclic monoid valence automata with rational target sets .",
    "it transpires that , for @xmath2 a polycyclic monoid of rank @xmath0 or more , every language accepted by an @xmath2-automaton with rational target set is context - free , and hence is accepted by an @xmath2-automaton with target set @xmath5 . in the rank @xmath1 case the situation is rather different ; a language accepted by a @xmath4-automata with rational target set need not be a partially blind one - counter language , but it is always a finite union of languages , each of which is the concatenation of two partially blind one - counter languages .    a key element of the proofs is a simple but extremely useful characterisation of the rational subsets of polycyclic monoids ( corollary  [ splitcor ] below ) .",
    "from this we are easily able to derive a number of other consequences which may be of independent interest .",
    "these include the facts that the rational subsets of a finitely generated polycyclic monoid form a boolean algebra ( with operations effectively computable ) , and that membership is uniformly decidable for rational subsets of polycyclic monoids .",
    "in addition to this introduction , the present paper is divided into four sections .",
    "section  [ preliminaries ] recalls some basic definitions from formal language theory and the theory of valence automata , while section  [ transductions ] establishes some foundational results about valence automata with rational target sets . in section  [ adjoinzerosection ]",
    "we consider the effect of adjoining a zero to a monoid @xmath2 upon the classes of languages accepted by @xmath2-automata and by @xmath2-automata with rational target sets .",
    "finally , in section  [ polycyclicsection ] we turn our attention to polycyclic and bicyclic monoids , proving our main results about both rational subsets and valence automata with rational target sets .",
    "firstly , we recall some basic ideas from formal language theory . let @xmath6 be a finite alphabet",
    ". then we denote by @xmath7 the set of all words over @xmath6 and by @xmath8 the empty word . under the operation of concatenation and with the neutral element @xmath8 , @xmath7 forms a free monoid .",
    "a _ finite automaton _ over @xmath7 is a finite directed graph with each edge labelled with an element of @xmath7 , and with a distinguished initial vertex and a set of distinguished terminal vertices .",
    "a word @xmath9 is accepted by the automaton if there exists some path connecting the initial vertex with some terminal vertex , the product of whose edge labels in order is @xmath10 .",
    "the set of all words accepted by the automaton is denoted @xmath11 or for an automaton @xmath12 sometimes @xmath13 , and is called the _ language _ accepted by @xmath12 .",
    "a language accepted by a finite automaton is called _ rational _ or _ regular_.    more generally , if @xmath2 is a monoid then a _ finite automaton over @xmath2 _ is a finite directed graph with each edge labelled with an element of @xmath2 , and with a distinguished initial vertex and a set of distinguished terminal vertices .",
    "an element @xmath14 is accepted by the automaton if there exists some path connecting the initial vertex with some terminal vertex , the product in order of whose edge labels is @xmath15 .",
    "the _ subset accepted _ is the set of all elements accepted ; a subset of @xmath2 which is accepted by some finite automaton is called a _ rational subset_. the rational subsets of @xmath2 are exactly the homomorphic images in @xmath2 of regular languages .",
    "we now recall the definition of a finite valence automaton , or @xmath2-automaton .",
    "let @xmath2 be a monoid with identity @xmath1 and let @xmath6 be an alphabet .",
    "an _ @xmath2-valence automaton _ ( or @xmath2-automaton for short ) over @xmath6 is a finite automaton over the direct product @xmath16 .",
    "we say that it accepts a word @xmath9 if it accepts @xmath17 , that is if there exists a path connecting the initial vertex to some terminal vertex labelled @xmath18 .",
    "intuitively , we visualize an @xmath2-automaton as a finite automaton augmented with a memory register which can store an element of @xmath2 ; the register is initialized to the identity element , is modified by right multiplication by elements of @xmath2 , and for a word to be accepted the element present in the memory register on completion must be the identity element .",
    "we write @xmath19 for the class of all languages accepted by @xmath2-automata , or equivalently for the class of languages generated by @xmath2-valence grammars @xcite . more generally , an _",
    "@xmath2-automaton with ( rational ) target set _ is an @xmath2-valence automaton together with a ( rational ) subset @xmath20 .",
    "a word @xmath9 is accepted by such an automaton if it accepts @xmath21 for some @xmath22 .",
    "we denote by @xmath23 the family of languages accepted by @xmath2-automata with rational target sets .",
    "we recall the following result of fernau and stiebe @xcite .",
    "[ gxx ] let @xmath24 be a group",
    ". then @xmath25 .",
    "in this section we study the relationship between rational transductions and @xmath2-automata with target sets .",
    "consider a finite automaton over the direct product @xmath26 .",
    "we call an automaton of this type a _ rational transducer _ from @xmath27 to @xmath6 ; it recognises a relation @xmath28 called a _ rational transduction_. the image of a language @xmath29 under the relation @xmath30 is the set of @xmath31 such that @xmath32 for some @xmath33 .",
    "we say that a language @xmath34 is a _ rational transduction of _ a language @xmath11 if @xmath34 is the image of @xmath11 under some rational transduction .",
    "the following is a straightforward generalisation of a well - known observation concerning @xmath2-automata ( see for example ( * ? ? ?",
    "* proposition  2 ) ) .",
    "[ transduction ] let @xmath35 be a subset of a monoid @xmath2 , and let @xmath36 be a regular language .",
    "then the following are equivalent :    * @xmath11 is accepted by an @xmath2-automaton with target set @xmath35 ; * there exists a finite alphabet @xmath27 and a morphism @xmath37 such that @xmath11 is a rational transduction of @xmath38 .",
    "if @xmath2 is finitely generated then the following condition is also equivalent to those above .",
    "* for every finite choice of generators @xmath37 for @xmath2 , @xmath11 is a rational transduction of @xmath38 .    to show that ( i ) implies ( ii ) , suppose @xmath11 is accepted by an @xmath2-automaton with target set @xmath35 .",
    "choose a finite alphabet @xmath27 and a map @xmath39 such that the image @xmath40 contains every element of @xmath2 which forms the first component of an edge - label in the automaton .",
    "we now obtain from the automaton a transducer from @xmath27 to @xmath6 by replacing each edge label @xmath41 with @xmath42 where @xmath43 is some word such that @xmath44 .",
    "it is a routine exercise to verify that @xmath11 is the image of @xmath45 under the given transduction .",
    "conversely , suppose we are given a map @xmath37 and a transducer from @xmath27 to @xmath6 .",
    "we construct from the transducer an @xmath2-automaton with target set @xmath35 by replacing each edge label of the form @xmath42 with @xmath46 .",
    "it is readily verified that the language accepted by this @xmath2-automaton is exactly the image of @xmath35 under the transduction .",
    "suppose now that @xmath2 is finitely generated . clearly , ( iii ) implies ( ii ) .",
    "finally , if ( ii ) holds then we can extend @xmath47 arbitrarily to a finite choice of generators @xmath48 for @xmath2 , and check that we still have the desired property , so that ( iii ) holds .",
    "in particular , proposition  [ transduction ] gives a characterisation in terms of rational subsets and transductions of each class of languages accepted by @xmath2-automata with rational target sets .",
    "[ mrat ] let @xmath2 be a monoid and @xmath36 a language .",
    "then the following are equivalent .",
    "* @xmath49 ; * there exists a finite alphabet @xmath27 , a morphism @xmath37 and a rational subset @xmath50 such that @xmath11 is a rational transduction of @xmath38 .    if @xmath2 is finitely generated then the following condition is also equivalent to those above .",
    "* there exists a rational subset @xmath50 such that for every finite choice of generators @xmath37 for @xmath2 , @xmath11 is a rational transduction of @xmath38 .",
    "recall that a _ rational cone _",
    "( also known as a _ full trio _ ) is a family of languages closed under rational transduction , or equivalently under morphism , inverse morphism , and intersection with regular languages ( * ? ? ?",
    "* section  v.2 ) . since rational transductions",
    "are closed under composition ( * ? ? ?",
    "* theorem  iii.4.4 ) we have the following immediate corollary .    [ ratcone ]",
    "@xmath23 is a rational cone .",
    "in particular , it is closed under morphism , inverse morphism , intersection with regular languages , and ( since it contains a non - empty language ) union with regular languages .",
    "in this section we show that adjoining a zero to a monoid @xmath2 makes no difference to the families of languages accepted either by @xmath2-automata or by @xmath2-automata with rational target sets . recall that if @xmath2 is a monoid , the result of _ adjoining a zero _ to @xmath2 is the monoid @xmath51 with set of elements @xmath52 where @xmath53 is a new symbol not in @xmath2 , and multiplication given by @xmath54 we begin with the @xmath2-automaton case , where the required result is a very simple observation .    [ m0 m ]",
    "let @xmath2 be a monoid",
    ". then @xmath55 .    that @xmath56 is immediate , so we need only prove the converse .",
    "suppose @xmath57 , and let @xmath12 be an @xmath51-automaton accepting @xmath11 .",
    "clearly any path in @xmath12 containing an edge with first label component @xmath53 will itself have first label component @xmath53 ; thus , no accepting path in @xmath12 can contain such an edge .",
    "it follows that by removing all edges whose label has first component @xmath53 , we obtain a new @xmath51-automaton @xmath4 accepting the language @xmath11 . but",
    "now since @xmath2 is a submonoid of @xmath51 , @xmath4 can be interpreted as an @xmath2-automaton accepting @xmath11 , so that @xmath58 as required",
    ".    next we establish the corresponding result for @xmath2-automata with rational target sets , which is a little more involved .",
    "[ g0 g ] let @xmath2 be a monoid",
    ". then @xmath59 .    that @xmath60 is immediate .",
    "for the converse , suppose @xmath61 .",
    "then we may choose an @xmath51-automaton @xmath12 accepting @xmath11 with rational target set @xmath50 .",
    "let @xmath62 be the language of words @xmath63 such that @xmath64 labels a path from the initial vertex to a terminal vertex .",
    "let @xmath65 be the set of words @xmath10 such that @xmath66 labels a path from the initial vertex to a terminal vertex for some @xmath67 . clearly either @xmath68 ( in the case that @xmath69 ) or @xmath70 ( if @xmath71 ) .",
    "we claim that @xmath62 is regular and @xmath72 . by proposition  [ ratcone ]",
    "this will suffice to complete the proof .",
    "the argument to show that @xmath72 is very similar to the proof of proposition  [ m0 m ] .",
    "we construct from the @xmath51-automaton @xmath12 a new @xmath2-automaton @xmath4 by simply removing each edge with label of the form @xmath73 .",
    "the new automaton @xmath4 has target set @xmath74 .",
    "it is straightforward to show that @xmath4 accepts exactly the language @xmath65 .",
    "it remains to show that @xmath62 is regular .",
    "let @xmath75 be the vertex set of the automaton @xmath12 , and let @xmath76 and @xmath77 be disjoint copies of @xmath75 .",
    "we define from @xmath12 a finite automaton @xmath78 with    * vertex set @xmath79 ; * for each edge in @xmath12 from @xmath80 to @xmath81 with label of the form @xmath41 * * an edge from @xmath82 to @xmath83 labelled @xmath84 and * * an edge from @xmath85 to @xmath86 labelled @xmath84 ; * for each edge in @xmath12 from @xmath80 to @xmath81 with label of the form @xmath87 * * an edge from @xmath82 to @xmath86 labelled @xmath84 and * * an edge from @xmath88 to @xmath89 labelled @xmath84 ; * initial vertex @xmath83 where @xmath81 is the initial vertex of @xmath12 ; and * terminal vertices @xmath86 whenever @xmath81 is a terminal vertex of @xmath12",
    ".    we shall show that @xmath78 accepts exactly the language @xmath90 .",
    "let @xmath91 .",
    "then there exists an accepting path @xmath92 through @xmath12 labelled @xmath93 .",
    "it follows from the definition of @xmath51 that no product of non - zero elements can equal @xmath53 ; hence , this path must traverse at least one edge with label of the form @xmath87 for some @xmath94 .",
    "suppose then that @xmath95 where @xmath96 is a path from the initial vertex to a vertex @xmath80 with label @xmath97 , @xmath98 is an edge from @xmath80 to a vertex @xmath81 with label @xmath87 , and @xmath99 is a path from @xmath81 to a terminal vertex with label @xmath100 .",
    "it follows easily from the definition of @xmath78 that it has a path from the initial vertex to @xmath82 labelled @xmath101 , an edge from @xmath82 to @xmath86 with label @xmath84 , and an edge from @xmath86 to a terminal vertex with label @xmath102 .",
    "hence , @xmath103 is accepted by @xmath78 , as required .",
    "conversely suppose @xmath104 , and let @xmath92 be an accepting path for @xmath10 .",
    "notice that the initial vertex of @xmath78 lies in @xmath105 while all the terminal vertices lie in @xmath106 .",
    "then @xmath107 where @xmath96 is a path from the initial vertex to some @xmath82 with label @xmath101 , @xmath98 is an edge from @xmath82 to some @xmath86 with label @xmath84 , @xmath99 is a path from @xmath86 to a terminal vertex with label @xmath102 where @xmath103 .",
    "now it follows easily from the definition of @xmath78 that @xmath12 has paths from the initial vertex to @xmath80 with label of the form @xmath97 , from @xmath80 to @xmath81 with label @xmath108 and from @xmath81 to a terminal vertex with label of the form @xmath109 .",
    "thus , @xmath12 accepts @xmath110 so that @xmath111 as required .",
    "combining theorems  [ g0 g ] with the result of fernau and stiebe @xcite mentioned above ( theorem  [ gxx ] ) gives us the following immediate corollary .",
    "let @xmath24 be a group",
    ". then @xmath112",
    "in this section we study the language classes @xmath19 and @xmath23 , where @xmath2 is drawn from the class of _ polycyclic monoids _ , which form the natural algebraic models of pushdown stores . in the process",
    ", we obtain a number of results about rational subsets of these monoids which may be of independent interest .",
    "let @xmath35 be a set .",
    "recall that the _ polycyclic monoid _ on @xmath35 is the monoid @xmath113 generated , under the operation of relational composition , by the partial bijections of the form @xmath114 and @xmath115 the monoid @xmath113 is a natural algebraic model of a pushdown store on the alphabet @xmath35 , with @xmath116 and @xmath117 corresponding to the elementary operations of _ pushing @xmath84 _ and _ popping @xmath84 _ ( where defined ) respectively , and composition to performing these operations in sequence . for a more detailed introduction see @xcite .",
    "clearly for any @xmath22 , the composition @xmath118 is the identity map . on the other hand ,",
    "if @xmath84 and @xmath119 are distinct letters in @xmath35 , then @xmath120 is the _ empty map _ which constitutes a zero element in @xmath113 . in the case",
    "@xmath121 , say @xmath122 , the monoid @xmath113 is called the _",
    "bicyclic monoid _ , and is often denoted @xmath4 . the partial bijections @xmath116 and @xmath117 alone ( which we shall often denote just @xmath80 and @xmath81 ) do not generate the empty map , and so the bicyclic monoid does not have a zero element ; to avoid having to treat it as a special case , it is convenient to write @xmath123 for the union of @xmath113 with the empty map ; thus we have @xmath124 if @xmath125 but @xmath123 isomorphic to @xmath113 with a zero adjoined if @xmath121 .",
    "let @xmath126 and @xmath127 , and let @xmath128 be a new symbol not in @xmath129 which will represent the zero element .",
    "let @xmath130 .",
    "then there is an obvious surjective morphism @xmath131 , and indeed @xmath123 admits the monoid presentation @xmath132 it is well - known ( see for example @xcite ) that for @xmath125 , a @xmath113-automaton is equivalent to a pushdown automaton with stack alphabet @xmath35 , so that the language class @xmath133 is exactly the class of context - free languages .",
    "greibach @xcite has introduced and studied the class of _ partially blind counter automata_. the latter are non - determinstic finite automata augmented with a number of non - negative integer counters which can be incremented and decremented but not read ; attempting to decrement a counter whose value is @xmath53 causes the computation to fail .",
    "the counters are initialized to 0 , and a word is accepted only if some computation reading that word places the finite state control in an accepting state and returns all counters to 0 .",
    "the following equivalence follows immediately from the definitions .",
    "[ bicyclic ] for any @xmath134 , @xmath135 is exactly the class of languages accepted by partially blind @xmath3-counter automata .",
    "we now turn our attention to the classes @xmath136 of languages accepted by polycyclic monoid automata with rational target sets . for @xmath125",
    ", it transpires that every language accepted by a @xmath113-automaton with rational target set is accepted by a @xmath113-automaton , and hence that @xmath136 is the class of context free languages . in order to prove this",
    ", we shall need some results about rational subsets of polycyclic monoids , which we establish using techniques from string rewriting theory .",
    "recall that a _ monadic rewriting system _",
    "@xmath137 over an alphabet @xmath6 is a subset of @xmath138 .",
    "we normally write an element @xmath139 as @xmath140",
    ". then we write @xmath141 if @xmath142 and @xmath143 with @xmath140 .",
    "denote by @xmath144 the transitive , reflexive closure of the relation @xmath145 .",
    "if @xmath146 we say that @xmath147 is an _ ancestor _ of @xmath148 under @xmath137 and @xmath148 is a _ descendant _ of @xmath147 under @xmath137 ; we write @xmath149 for the set of all descendants of words in @xmath11 .",
    "it is well - known that if @xmath11 is regular then @xmath150 is again a regular language ; if moreover the rewriting system @xmath137 is finite , a finite automaton recognising @xmath150 can be effectively computed from a finite automaton recognising @xmath11 . for more information on such systems",
    "see @xcite .",
    "[ q*p * ] let @xmath35 be a finite alphabet and @xmath30 a rational subset of @xmath123 .",
    "then there exists a regular language @xmath151 such that @xmath152 .",
    "moreover , there is an algorithm which , given an automaton recognizing a regular language @xmath153 , constructs an automaton recognising a language @xmath154 with @xmath155 .",
    "since @xmath30 is rational , there exists a regular language @xmath156 such that @xmath157 .",
    "we define a monadic rewriting system @xmath137 on @xmath158 with the following rules : @xmath159 for all @xmath160 with @xmath161 .",
    "notice that the language of @xmath137-irreducible words is exactly @xmath162 .",
    "with this in mind , we define @xmath163 certainly @xmath11 is regular , and moreover an automaton for @xmath11 can be effectively computed from an automaton for @xmath34 .",
    "thus , it will suffice to show that @xmath152 .    by definition @xmath164 , and since the rewriting rules are all relations satisfied in @xmath123 , @xmath165 conversely , if @xmath166 then @xmath167 for some @xmath168 .",
    "now the rules of @xmath137 are all length - reducing , so @xmath10 must clearly have an irreducible descendant , say @xmath169 .",
    "but now @xmath170 and @xmath171 so that @xmath172 .",
    "thus , @xmath152 as required .    as an immediate corollary",
    ", we obtain a corresponding result for bicyclic monoids    [ bicyclicq*p * ] let @xmath30 be a rational subset of a bicyclic monoid @xmath4 , and @xmath173 the natural morphism .",
    "then there exists a regular language @xmath174 such that @xmath175 .",
    "moreover , there is an algorithm which , given an automaton recognizing a regular language @xmath176 , constructs an automaton recognising a language @xmath174 with @xmath155 .    before proceeding to apply the theorem to polycyclic monoid automata with target sets , we note some general consequences of theorem  [ q*p * ] for rational subsets of polycyclic monoids . recall that a collection of subsets of a given _ base set _ is called a _",
    "boolean algebra _ if it is closed under union , intersection and complement within the base set .",
    "[ booleanalgebra ] the rational subsets of any finitely generated polycyclic monoid form a boolean algebra",
    ". moreover , the operations of union , intersection and complement are effectively computable .",
    "the set of rational subsets of a monoid is always ( effectively ) closed under union , as a simple consequence of non - determinism .",
    "since intersection can be described in terms of union and complement , it suffices to show that the rational subsets of polycyclic monoids are closed ( effectively ) under complement . to this end , suppose first that @xmath30 is a rational subset of a finitely generated polycyclic monoid @xmath113 with @xmath125 .",
    "then by theorem  [ q*p * ] , there is a regular language @xmath177 such that @xmath152 .",
    "let @xmath178 .",
    "then @xmath34 is regular and , since @xmath179 contains a unique representative for every element of @xmath113 , it is readily verified that @xmath180 .",
    "thus , @xmath181 is a rational subset of @xmath113 , as required .    for effective computation of complements ,",
    "observe that given an automaton recognizing a language @xmath182 , we can by theorem  [ q*p * ] construct an automaton recognizing a regular language @xmath177 with @xmath183 .",
    "clearly we can then compute the complement @xmath184 of @xmath11 in @xmath185 , and since @xmath180 , this suffices .    in the case",
    "that @xmath121 , the statement can be proved in a similar way but using corollary  [ bicyclicq*p * ] in place of theorem  [ q*p * ] .",
    "recall that the _ rational subset problem _ for a monoid @xmath2 is the algorithmic problem of deciding , given a rational subset of @xmath2 ( specified using an automaton over a fixed generating alphabet ) and an element of @xmath2 ( specified as a word over the same generating alphabet ) , whether the given element belongs to the given subset .",
    "the decidability of this problem is well - known to be independent of the chosen generating set ( * ? ? ?",
    "* corollary  3.4 ) . as another corollary",
    ", we obtain the decidability of this problem for finitely generated polycyclic monoids .",
    "finitely generated polycyclic monoids have decidable rational subset problem .",
    "let @xmath125 [ respectively , @xmath121 ] .",
    "suppose we are given a rational subset @xmath30 of @xmath113 ( specified as an automaton over @xmath158 [ respectively @xmath187 ) and an element @xmath10 ( specified as a word in the appropriate alphabet ) .",
    "clearly , we can compute @xmath188 as a regular language .",
    "now by corollary  [ booleanalgebra ] we can compute a regular language @xmath189 [ respectively , @xmath187 such that @xmath190 .",
    "so @xmath191 if and only if @xmath192 is non - empty , that is , if and only if @xmath34 is non - empty .",
    "since emptiness of regular languages is testable , this completes the proof .",
    "we now return to our main task of proving that @xmath193 for @xmath2 a polycyclic monoid of rank @xmath0 or more , that is , that polycyclic monoid automata with target sets accept only context - free languages .",
    "we shall need some preliminary results .",
    "[ splitcor ] let @xmath30 be a rational subset of @xmath123 and suppose that @xmath194 .",
    "then there exists an integer @xmath3 and regular languages @xmath195 and @xmath196 such that @xmath197    by theorem  [ q*p * ] , there is a regular language @xmath198 such that @xmath152 .",
    "let @xmath12 be a finite automaton accepting @xmath11 , with vertices numbered @xmath199 .",
    "suppose without loss of generality that the edges in @xmath12 are labelled by single letters from @xmath200 .",
    "for each @xmath201 let @xmath202 be the set of all words in @xmath203 which label paths from the initial vertex to vertex @xmath201 .",
    "similarly , let @xmath204 be the set of all words in @xmath205 which label words from vertex @xmath201 to a terminal vertex .",
    "now if @xmath206 then @xmath207 where @xmath208 labels a path from the initial vertex to vertex @xmath201 , and @xmath209 labels a path from vertex @xmath201 to a terminal vertex .",
    "hence @xmath210 labels a path from the initial vertex to a terminal vertex , and so @xmath211 .",
    "conversely , if @xmath212 then @xmath10 admits a factorisation @xmath207 where @xmath208 and @xmath209 . since the edge labels in @xmath12 are single letters , an accepting path for @xmath10 must consist of a path from the initial vertex to some vertex @xmath201 labelled @xmath147 , followed by a path from @xmath201 to a terminal vertex labelled @xmath148 .",
    "it follows that @xmath213 and @xmath214 , so that @xmath206 .",
    "thus we have @xmath215 and so @xmath216 as required .    for the next proposition",
    ", we shall need some notation . for a word @xmath217 ,",
    "we let @xmath218 . similarly for a word @xmath219 , we let @xmath220 . note that @xmath221 and @xmath222 .",
    "note also that @xmath223 is the unique right inverse of @xmath224 , and @xmath225 is the unique left inverse of @xmath226 .",
    "[ factorise ] let @xmath227 , and let @xmath228 and @xmath229 .",
    "then @xmath230 if and only if there exists a factorisation @xmath231 such that @xmath232 .",
    "suppose first that @xmath230 .",
    "let @xmath137 be the monadic rewriting system defined in the proof of theorem  [ q*p * ] .",
    "then @xmath147 is reduced by @xmath137 to @xmath233 .",
    "notice that the only rules in @xmath137 which can be applied to words not representing zero remove factors representing the identity ; it follows easily that @xmath147 admits a factorisation @xmath231 where @xmath234 and @xmath235 .",
    "now we have @xmath236 and symmetrically @xmath237 as required .",
    "conversely , @xmath226 is the unique right inverse of @xmath225 , so if @xmath238 then we must have @xmath234 .",
    "similarly , if @xmath237 then @xmath239 , and so we deduce that @xmath240 as required .",
    "we are now ready to prove our main theorem about @xmath2-automata with rational target sets where @xmath2 is a polycyclic monoid .",
    "[ polyzero ] suppose @xmath241 .",
    "then @xmath11 is a finite union of languages , each of which is the concatenation of one or two languages in @xmath242 .",
    "let @xmath243 and let @xmath12 be an @xmath2-automaton with rational target set @xmath30 accepting the language @xmath11 . by corollary  [ splitcor ] there exists an integer @xmath3 and regular languages @xmath244 and @xmath245 such that @xmath246 where either @xmath247 or @xmath248 depending on whether @xmath249 .",
    "for @xmath250 , we let @xmath251 .",
    "it follows easily that we can write @xmath252 where each @xmath253 is accepted by a @xmath2-automaton with target set @xmath254 .",
    "clearly it suffices to show that each @xmath253 is a finite union of languages , each of which is the concatenation of at most two languages in @xmath19 .",
    "we begin with @xmath62 .",
    "let @xmath255 and .",
    "it is easily seen ( for example , by considering the rewriting system @xmath137 from the proof of theorem  [ q*p * ] ) that @xmath256 if and only if either @xmath147 contains the letter @xmath128 , or @xmath147 factorizes as @xmath257 where @xmath258 , @xmath259 and @xmath260 are such that @xmath261 represents the identity , that is , such that @xmath262 .",
    "thus , @xmath263 from this expression it is a routine matter to show that @xmath264 is a rational transduction of @xmath265 by proposition  [ transduction ] , @xmath62 is a rational transduction of the language @xmath264 .",
    "since the class of rational transductions is closed under composition , it follows that @xmath11 is a rational transduction of @xmath266 and hence by proposition  [ transduction ] that @xmath267 , as required .",
    "we now turn our attention to the languages @xmath253 for @xmath268 . recall that @xmath253 is accepted by a @xmath2-automaton with target set @xmath269 .",
    "let @xmath270 and similarly @xmath271 it is readily verified that @xmath272 and @xmath273 are rational subsets of @xmath274 ; let @xmath275 and @xmath276 be finite automata accepting @xmath272 and @xmath273 respectively , and assume without loss of generality that the first component of every edge label is either a single letter in @xmath277 or the empty word @xmath8 .    by proposition  [ transduction ]",
    "there is a rational transduction @xmath278 such that @xmath279 if and only if @xmath280 for some @xmath227 such that @xmath281 .",
    "let @xmath12 be an automaton recognizing @xmath282 , again with the property that the first component of every edge label is either a single letter in @xmath277 or the empty word @xmath8 .",
    "we construct a new automaton @xmath4 with    * vertex set the disjoint union of the state sets of @xmath276 , @xmath12 , and @xmath275 ; * all the edges of @xmath276 , @xmath12 and @xmath275 ; * initial vertex the initial vertex of @xmath276 ; * terminal vertices the terminal vertices of @xmath275 ; * an extra edge , labelled @xmath283 , from each terminal vertex of @xmath276 to the initial vertex of @xmath12 ; and * an extra edge labelled @xmath283 , from each terminal vertex of @xmath12 to the initial vertex of @xmath275 .",
    "it is immediate that @xmath4 recognizes the relation @xmath284 and again has the property that the first component of every edge label is either a single letter or the empty word .",
    "let @xmath75 be the vertex set of @xmath12 , viewed as a subset of the vertex set of @xmath4 . for each vertex @xmath285",
    ", we let @xmath286 be the language of all words @xmath10 such that @xmath287 labels a path in @xmath4 from the initial vertex of @xmath4 to @xmath119 for some @xmath147 with @xmath288 . by considering @xmath4 as an transducer but with terminal vertex @xmath119 , we see that @xmath286 is a rational transduction of the word problem of @xmath113 , and hence by proposition  [ transduction ] lies in the class @xmath133 .",
    "dually , we let @xmath289 be the language of all words @xmath10 such that @xmath290 labels a path in @xmath4 from @xmath119 to a terminal vertex for some @xmath147 with @xmath288 . this time by considering @xmath4 as a transducer but with initial vertex @xmath119 , we see that @xmath289 is also a rational transduction of the word problem of @xmath113 , and hence also lies in @xmath133 .",
    "we claim that @xmath291 which will clearly suffice to complete the proof .",
    "suppose first that @xmath279 .",
    "then there exists a word @xmath292 such that @xmath293 and that @xmath294 .",
    "since @xmath269 we have @xmath295 for some @xmath296 and @xmath297 .",
    "note that @xmath298 is accepted by @xmath4 . by proposition  [ factorise ]",
    ", @xmath147 admits a factorization @xmath231 such that @xmath299 and @xmath237 .",
    "now in view of our assumption on the edge labels of @xmath4 , @xmath10 must admit a factorization @xmath300 such that @xmath4 has a path from the initial vertex to some vertex @xmath119 labelled @xmath301 and a path from @xmath119 to a terminal vertex labelled @xmath302 ; moreover , the vertex @xmath119 can clearly be assumed to lie in @xmath75 . since @xmath303 , it follows that @xmath304 and @xmath305 so that @xmath306 , as required .",
    "conversely , suppose @xmath285 and that @xmath300 where @xmath307 and @xmath305 .",
    "then @xmath4 has a path from the initial vertex to vertex @xmath119 labelled @xmath308 and a path from the vertex @xmath119 to a terminal vertex labelled @xmath309 for some @xmath310 and @xmath261 with @xmath311 .",
    "since @xmath285 , it follows from the definition of @xmath4 that @xmath312 and @xmath313 for some @xmath314 and @xmath297 and @xmath315 and @xmath316 such that @xmath317 .",
    "but now @xmath318 and @xmath319 , so we deduce by proposition  [ factorise ] that @xmath320 and @xmath321 .",
    "but then @xmath322 and @xmath323 , from which it follows that @xmath324 as required",
    ".    thus , we have written @xmath11 as a finite union of languages @xmath253 where each @xmath253 either lies in @xmath19 ( in the case @xmath325 ) or is a finite union of concatenations of two languages in @xmath19 .",
    "this completes the proof .    in the case",
    "that @xmath125 , we have @xmath124 and @xmath133 is the class of context - free languages , which is closed under both finite union and concatenation .",
    "hence , we obtain the following easy consequence .",
    "[ contextfree ] if @xmath125 then @xmath136 is the class of context - free languages .    in the case",
    "@xmath121 , we have that @xmath123 is isomorphic to the bicyclic monoid @xmath326 with a zero adjoined . combining theorem  [ polyzero ] with proposition  [ m0 m ] and theorem  [ g0 g ] we thus obtain .    every language in @xmath327",
    "is a finite union of languages , each of which is the concatenation of one or two blind one - counter languages .    since the class @xmath328 of partially blind one - counter languages",
    "is not closed under concatenation , however , we can not here conclude that @xmath329 .",
    "indeed , the following result shows that this is not the case .",
    "the language @xmath330 lies in @xmath327 but not in @xmath328 .",
    "let @xmath331 .",
    "first , we claim that the @xmath4-automaton with rational target set shown in figure [ fig_l ] accepts the language @xmath11 .",
    "indeed , it is easily seen to accept exactly pairs of the form @xmath332 for @xmath333 .",
    "a straightforward argument shows that @xmath334 if and only if @xmath335 and @xmath336 , which suffices to establish the claim and proof that @xmath337 .    ( 80,25 ) q0=(10,5 ) ( q0)@xmath338 q1=(30,5 ) ( q1)@xmath89 q2=(50,5 ) ( q2)@xmath339 q3=(70,5 ) ( q3)@xmath340 ( q0)@xmath341 ( q1)@xmath342 ( q0,q1)@xmath343 ( q2)@xmath344 ( q3)@xmath342 ( q1,q2)@xmath345 ( q2,q3)@xmath346    assume now for a contradiction that @xmath347 . then there exists a @xmath4-automaton @xmath12 accepting @xmath11 , with @xmath348 vertices say . for @xmath349",
    "let @xmath350 be an accepting path for @xmath351 .",
    "suppose without loss of generality that the right - hand sides of edge labels in @xmath12 are all @xmath352 , @xmath353 or @xmath8 . then we can write @xmath354 and where @xmath355 has label @xmath356 , @xmath357 has label @xmath358 , @xmath359 has label @xmath360 and @xmath361 has label @xmath362 for some @xmath363",
    ".    the proof will proceed by considering loops ( that is , closed paths ) in the automaton @xmath12 ; we begin by introducing some terminology to describe particular types of loops . a loop with label @xmath364",
    "is called an _ increment loop _ if @xmath365 , a _ stable loop _ if @xmath366 and a _ decrement loop _ if @xmath367 .",
    "we call the loop an _ epsilon loop _ if @xmath368 and a _ non - epsilon _ loop otherwise",
    ". a path which does not traverse any loops is called a _",
    "simple path_.    first , notice that since there are only finitely many simple paths , there exists a constant @xmath34 such that every simple path in @xmath12 has label of the form @xmath369 with @xmath370 .",
    "now let us consider paths of the form @xmath355 .",
    "we claim that for all but at most @xmath371 values of @xmath201 , the path @xmath355 contains a non - epsilon increment loop . for all @xmath372 ,",
    "we can write @xmath373 where @xmath374 has label @xmath375 and @xmath376 has label @xmath377 .    first note that the only elements of @xmath4 which generate a right ideal [ left ideal ] including the identity element , are those of the form @xmath378 [ respectively @xmath379 for some @xmath380 .",
    "thus , we must have that both @xmath381 and @xmath382 are powers of @xmath80 , and that @xmath383 is a power of @xmath81 .",
    "in particular , we can let @xmath384 be such that @xmath385 .",
    "first suppose @xmath201 is such that @xmath374 does not traverse an increment loop .",
    "let @xmath386 be the path obtained from @xmath374 by removing all loops , and suppose @xmath386 has label @xmath387 .",
    "since none of the loops removed were increment loops , it follows easily that @xmath388 suppose now for a contradiction than more than @xmath371 values of @xmath389 are such that @xmath390 contains no increment loop .",
    "then by the pigeonhole principle , there exist @xmath391 with @xmath372 and @xmath392 such that @xmath393 and the paths @xmath374 and @xmath394 end at the same state .",
    "but now the composition @xmath395 is an accepting path with label @xmath396 so that @xmath397 is accepted by @xmath12 , giving a contradiction .",
    "thus , we have established that for all but @xmath371 values of @xmath372 , the path @xmath398 must traverse an increment loop .",
    "hence , for all but @xmath399 values of @xmath349 , the path @xmath398 must traverse an increment loop .    now let @xmath201 be such that @xmath398 traverses an increment loop and suppose for a contradiction that @xmath400 does not traverse a non - epsilon increment loop .",
    "consider the path @xmath401 . clearly",
    ", since this path has label with right - hand - side @xmath402 , and the right - hand - sides of edge labels in the automaton are single letters or @xmath8 , this path must traverse a non - epsilon loop . since @xmath355 does not traverse a non - epsilon increment loop , @xmath401 must traverse a non - epsilon stable or decrement loop , say with label @xmath403 where @xmath404 and @xmath405 .",
    "we also know that @xmath398 traverses an epsilon increment loop , say with label @xmath406 where @xmath407 . clearly , by traversing the latter loop an additional @xmath408 times and the former loop an additional @xmath409 times , we obtaining an accepting path for the word @xmath410 , which gives the required contradiction .",
    "thus , we have shown that for all but at most @xmath411 values of @xmath201 , the path @xmath400 traverses a non - epsilon increment loop .",
    "a left - right symmetric argument can be used to establish firstly that each @xmath412 for some @xmath413 , and then that for @xmath201 sufficiently large , @xmath361 must traverse a non - epsilon decrement loop .",
    "thus , for all but at most @xmath414 values of @xmath201 , the paths @xmath400 and @xmath415 traverse respectively a non - epsilon increment loop and a non - epsilon decrement loop .    now choose @xmath201 such that this holds , and let @xmath416 label a non - epsilon increment loop in @xmath355 and let @xmath417 label a non - epsilon decrement loop in @xmath361 where @xmath418 , @xmath419 and @xmath420 .",
    "let @xmath421 be the path obtained from @xmath422 by traversing the given increment loop an additional @xmath423 times , and the given decrement loop an additional @xmath424 times .",
    "then @xmath422 has label of the form @xmath425 where @xmath426 , @xmath147 and @xmath148 are such that @xmath92 has label @xmath427 so that in particular @xmath428 .",
    "now by our argument above regarding right and left ideals , the element @xmath429 must be a power of @xmath80 , while @xmath430 must be a power of @xmath81 . noting that powers of @xmath80 commute with each other , and powers of @xmath81 commute with each other , we get @xmath431 therefore @xmath432 is an accepting path .",
    "thus , the automaton accepts the word @xmath433 which is not in the language @xmath11 , giving the required contradiction .",
    "this completes the proof that @xmath434 .",
    "it is possible , however , to describe concatenations of partially blind one - counter languages using partially blind two - counter automata .",
    "indeed more generally we have the following proposition .",
    "[ product ] let @xmath435 and @xmath436 be monoids and @xmath65 and @xmath437 languages over the same alphabet . if @xmath438 and @xmath439 then @xmath440 .    by proposition  [ transduction ] for @xmath441",
    "there are alphabets @xmath442 , morphisms @xmath443 and rational transductions @xmath444 such that @xmath445 .",
    "assume without loss of generality that @xmath446 and @xmath447 are disjoint , and let @xmath448 . then there is a natural morphism @xmath449 extending @xmath450 .",
    "now let @xmath282 be the product of @xmath451 and @xmath452 : @xmath453 then @xmath282 is a rational transduction from @xmath454 to @xmath7 .",
    "clearly , if @xmath455 and @xmath456 then @xmath457 represents the identity element in @xmath458 if and only if @xmath310 and @xmath261 represent the identity elements in @xmath435 and @xmath436 respectively .",
    "it follows that @xmath10 is in the image under @xmath282 of the identity language of @xmath458 if and only if @xmath300 where @xmath459 and @xmath460 , so that @xmath461 .",
    "thus , @xmath462 is a rational transduction of the identity language of @xmath458 , so applying proposition  [ transduction ] again we see that @xmath440 as required .",
    "since classes of the form @xmath19 are closed under union , proposition  [ bicyclic ] , theorem  [ polyzero ] and proposition  [ product ] combine to give the following inclusion .",
    "the research of the second author was supported by an rcuk academic fellowship .",
    "r.h . gilman . formal languages and infinite groups . in _ geometric and computational perspectives on infinite groups ( minneapolis , mn and new brunswick , nj , 1994 ) , dimacs series _ ,",
    "volume  25 of _ discrete mathematics and theoretical computer science _ , providence ri , 1996 .",
    "american mathematical society ."
  ],
  "abstract_text": [
    "<S> we study the classes of languages defined by valence automata with rational target sets ( or equivalently , regular valence grammars with rational target sets ) , where the valence monoid is drawn from the important class of polycyclic monoids . </S>",
    "<S> we show that for polycyclic monoids of rank @xmath0 or more , such automata accept exactly the context - free languages . for the polycyclic monoid of rank @xmath1 ( that is , the bicyclic monoid ) </S>",
    "<S> , they accept a class of languages strictly including the partially blind one - counter languages . </S>",
    "<S> key to the proof is a description of the rational subsets of polycyclic and bicyclic monoids , other consequences of which include the decidability of the rational subset membership problem , and the closure of the class of rational subsets under intersection and complement .    </S>",
    "<S> elaine render and mark kambites +    school of mathematics ,  university of manchester + manchester m60 1qd ,   england +    ` e.render@maths.manchester.ac.uk ` + ` mark.kambites@manchester.ac.uk ` + </S>"
  ]
}