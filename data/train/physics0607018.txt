{
  "article_text": [
    "featuring simultaneous tracking and targeting of tumours , image - guided radiation therapy ( igrt ) paves a promising path towards a safer , more efficient and more accurate treatment . in autumn 2004 , varian medical systems , inc .",
    "( vms ) , palo alto , ca , installed the first clinically - applicable solution for igrt : the vms clinac accelerator equipped with imaging functionality .    unless a number of calibrations have been performed on such a complex system , the device is not operable .",
    "the aim of the present paper is to describe one such important process , the geometric calibration .",
    "the method outlined here applies equally to imaging and delivery units where the source and a flat - panel detector ( mounted in such a way as to face one another ) move in circular orbits around the irradiated object .",
    "the rotation plane of the source is assumed to contain the geometric centre of the detector ; modifications are needed in case of tilted geometry , e.g. , in a c - arm configuration .",
    "the aim of the geometric calibration is threefold .",
    "( i ) to yield the values of the important parameters defining the geometry of the system .",
    "if an imaging unit is calibrated , these values are subsequently used in the processing of the scan data ( reconstruction phase ) .",
    "if a delivery unit is calibrated , the output may lead to the suspension of the operation of the system in case , for instance , that the deviations of the parameter values from the nominal ones are beyond the tolerance limits .",
    "( ii ) to provide an assessment of the deviation from the ideal world , where the machine components move smoothly and rigidly in exact circular orbits ; these effects have appeared in the literature as ` mechanical flex ' , ` nonidealities ' , ` nonrigid motion of the system components ' , etc .",
    "( iii ) to enable the investigation of the long - term mechanical stability of the system ; this examination involves the creation of a database containing the output of each calibration .    on top of the arguments which were just put forth concerning the necessity of the geometric calibration separately for imaging and delivery units ,",
    "there is one additional remark which specifically applies to igrt systems : the geometric calibration links together the two units comprising the machine . with the relationship between the two components of the system having been set ,",
    "the updated anatomic information ( obtained from the imaging unit ) may be quickly processed and the dose distribution re - evaluated in the area which is subsequently subjected to radiation ( delivery unit ) ; thus , modifications in the treatment plan are enabled on the daily basis , reflecting the most up - to - date information in the region of interest .    concerning earlier methods pertaining to the calibration of the geometry in computed tomography , an overview may be obtained from the paper of noo ( 2000 ) ; that work set forth an approach to extract the parameters of the geometry from the elliptical projections of fixed points , and inspired additional research in the field .",
    "fahrig and holdsworth ( 2000 ) employed a small steel ball bearing ( bb ) placed at the isocentre , and traced its projection across a series of images ; corrections to the scan data were subsequently calculated ( as a function of the gantry angle ) from the movement of the image centroid on the detector .",
    "a similar approach was followed by jaffray ( 2002 ) , whereas mitschke and navab ( 2003 ) developed a method featuring a ccd camera attached to the head of the x - ray source .",
    "siewerdsen ( 2005 ) use a phantom consisting of a helical pattern of bbs ; the data analysis results in the creation of their ` flex maps ' , which then lead to the assessment of the mechanical nonidealities .",
    "finally , the interesting paper of cho ( 2005 ) introduces a phantom consisting of an arrangement of @xmath0 steel bbs in two circular patterns and achieves the description of the geometry of the system via a set of spatial lengths and distortion angles .    in this paper , we present one of the methods which are currently in use in the geometric calibration of the vms devices ; a shorter description of this image - based calibration technique has appeared in matsinos ( 2005 ) .",
    "contrary to the bulky cylinders which are generally needed in other schemes in order to extract the parameters of the geometry , we use an easy - to - handle ( i.e. , to mount and dismount ) and light needle phantom which , additionally , can easily be manufactured .",
    "the extraction of the values of the model parameters is achieved via a method which has been developed with attention to the robustness of the final outcome .",
    "the needle phantom comprises five cylindrical @xmath1-mm - long metallic needles ( @xmath2 @xmath3 mm ) embedded in a urethane compound ( obomodulan 500 , obo - werke gmbh & co.  kg , stadthagen , germany ) of cylindrical form .",
    "the dimensions of the urethane housing are : @xmath4 mm ( diameter ) and @xmath5 mm ( height ) .",
    "the weight of the needle phantom is about @xmath6 gr .",
    "the needles are made of a chromium - nickel alloy ( 1.4305 , edelstahlwerke sdwestfalen gmbh , siegen , germany ) and are coplanar , parallel and equidistant ( @xmath7-mm separation ) ; the axis of the central needle coincides with the symmetry axis of the needle phantom .",
    "marks have been incised into its surface to enable the proper alignment with a laser system .",
    "the needle phantom may easily be mounted directly onto the vms couch ( exact couch ) ; it is placed in such a way that the needles are parallel to the rotation axis .",
    "the vms paxscan 4030cb amorphous - silicon flat - panel detector , currently used in the data acquisition , is a real - time digital x - ray imaging device comprising @xmath8 square elements ( pixels ) ; the detector spans an approximate area of @xmath9 @xmath10 . in order to expedite the data transfer and processing , the so - called half - resolution ( @xmath11-binning ) mode is used in almost all applications",
    "; thus , the detector is assumed to consist of @xmath12 ( logical ) pixels ( pitch : @xmath13 @xmath14 m ) .",
    "the detector is connected to the body of the system via a set of robotic arms enabling three - dimensional ( 3d ) movement .",
    "the experimental data which are analysed in the present paper were obtained at the vms laboratory in baden , switzerland , and involved two vms devices : the acuity simulator ( as ) , a machine dedicated to imaging ( figure [ fig : placementatisocentre ] ) , and the ` on - board imager ' ( obi ) system , the imaging unit of the vms igrt devices . the description of these two units may be obtained directly from the website of the manufacturer ( ` www.varian.com ' ) .    in both devices ,",
    "the x - ray pulses are produced by an x - ray tube , the vms model g242 .",
    "the position of the x - ray source is fixed in the as device , but adjustable ( 2d movement ) in the obi unit . to correct for the ( large ) anisotropy in the radiation field ,",
    "wedge filters have been mounted at the head of the gantry in the as device ; there are no such filters in the obi unit .",
    "the ideal geometry and placement of the needle phantom are shown in figure [ fig : placementatisocentre ] , where @xmath15 and @xmath16 denote the source - isocentre ( often referred to as sad ) and isocentre - detector distances ; @xmath17 is the gantry angle , identifying the position of the source . in this ideal world , the isocentre , defined as the intersection of the rotation axis and the plane on which the x - ray - source locus s lies during a scan , is a fixed point in space ; a point source is assumed ( cone - beam geometry ) , circumscribing an exact circle .",
    "the projection of the isocentre onto the detector ( point m ) coincides with the geometric centre of the detector ; ideally , the line sm is perpendicular to the detector surface . concerning the perfect orientation of the detector , two of its sides are paraller to the rotation plane ( and two perpendicular to it ) .",
    "in the isocentre reference frame , a point will be represented as ( @xmath18,@xmath19,@xmath20 ) ; facing the gantry , the @xmath18 axis points to the right , the @xmath19 axis towards the gantry and the @xmath20 axis upwards .",
    "the second coordinate system pertains to the machine .",
    "the coordinates of points in this reference frame will carry the subscript @xmath21 , thus , a point will be represented as ( @xmath22,@xmath23,@xmath24 ) .",
    "the origin of the machine reference frame is the isocentre ; additionally , @xmath25 .",
    "the isocentre and machine reference frames are related via a simple rotation around the @xmath19 axis , the rotation angle being denoted as @xmath26 ( figure [ fig : coordinatesystems]a ) ; in the ideal case ( @xmath27 ) , the machine and isocentre reference frames are identical .",
    "the third coordinate system is attached to the needle phantom .",
    "the coordinates of points in this reference frame will carry the subscript @xmath28 , thus , a point will be represented as ( @xmath29,@xmath30,@xmath31 ) .",
    "the couch angle @xmath32 will relate this reference frame and an auxiliary one ( figure [ fig : coordinatesystems]b ) , denoted as ( @xmath33,@xmath34,@xmath35 ) , having the same origin ( the geometric centre of the needle phantom ) , but being parallel to the isocentre reference frame ( @xmath18,@xmath19,@xmath20 ) .      from figure",
    "[ fig : coordinatesystems]b , it is evident that @xmath36    the auxiliary and isocentre reference frames are parallel to one another . denoting the isocentre coordinates in the auxiliary reference frame as @xmath37 , @xmath38 and @xmath39 , one obtains @xmath40    from figure [ fig : coordinatesystems]a , it is deduced that @xmath41    these three transformations relate the sets of coordinates of a point in the needle - phantom and machine reference frames .",
    "two parameters ( @xmath32 and @xmath26 ) have been introduced to account for the miscalibration of the couch and gantry angles  .",
    "additionally , the parameter @xmath26 takes account of the movement of the source between the time instant corresponding to the retrieval of the gantry - angle value from the system and an average time associated with the actual exposure . including also the quantities @xmath37 , @xmath38 and @xmath39 , the transformation of the coordinates ( from the needle - phantom to the machine reference frame ) involves five parameters in total .",
    "the ideal geometry has already been shown in figure [ fig : placementatisocentre ] ; we will now introduce two deviations from this hypothetical situation _ on the rotation plane_. first , the straight line drawn from the isocentre perpendicular to the detector might not contain the source ; in figure [ fig : deviationsonplane ] , this imperfection is represented by the angle @xmath42 ( positive clockwise ) .",
    "second , the projection m@xmath43 of the isocentre onto the detector might not coincide with the middle of the segment defined by the intersection of the detector and the rotation plane ; the lateral ( tangential to the circular orbit ) displacement m@xmath43 m of the detector will be denoted as @xmath44 ( positive to the right as one faces the gantry at @xmath45 ) .",
    "starting from a point p(@xmath22,@xmath24 ) on the rotation plane and introducing its polar coordinates as @xmath46 and @xmath47 , the projected length @xmath48 onto the detector is given by the formula @xmath49 as the geometric centre of the detector is the origin of the detector reference frame , the trace q corresponds to a lateral reading equivalent to @xmath50 .",
    "the projected length @xmath51 onto the detector in the longitudinal direction ( parallel to the rotation axis ) for an abritrary point ( @xmath22,@xmath23,@xmath24 ) is given by the formula @xmath52 in analogy to the lateral direction , one must introduce a parameter representing the longitudinal displacement of the detector ; this parameter will be denoted as @xmath53 .",
    "thus , the trace p@xmath43 corresponds to a longitudinal reading equivalent to the length @xmath54 .",
    "the deviation in the orientation of the detector from the ideal geometry is a source of systematic effects .",
    "this misorientation may easily be described in terms of three rotations around the principal axes of the detector , corresponding to the lateral and longitudinal directions , as well as to the one which is perpendicular to its surface . due to the fact that some of our parameters show sensitivity to the last rotation ( i.e. , around the detector normal )",
    ", we will introduce one parameter ( @xmath55 ) to account for this degree of freedom ; concerning the two former rotations ( i.e. , around the lateral and longitudinal directions ) , our results show no sensitivity , at least up to the level at which these distortions are present in the vms devices which were calibrated .",
    "on the contrary , the inclusion of the parameter @xmath55 leads to an improved description of the longitudinal residuals ; we will address this point later on .    denoting the coordinates of a trace on the detector as @xmath56 and @xmath57 in the nonrotated reference frame ,",
    "the coordinates @xmath58 and @xmath59 in the rotated reference frame are obtained via the tranformation @xmath60      equations ( [ eq : mprimeq])-([eq : detectorrotation ] ) establish a relationship between the coordinates @xmath22 , @xmath23 and @xmath24 of an arbitrary point and its corresponding trace on the detector ; the trace is obtained from ( [ eq : mprimeq ] ) and ( [ eq : qpprime ] ) after involving the detector displacement ( that is , the parameters @xmath44 and @xmath53 ) and the transformation ( [ eq : detectorrotation ] ) on the detector plane . by using also the transformations ( [ eq : relationbetweenfandt])-([eq : relationbetweenmandi ] ) , one may determine the projection of an arbitrary point onto the detector plane starting from its coordinates @xmath29 , @xmath30 and @xmath31 in the needle - phantom reference frame .",
    "a number of parameters have been introduced in three steps : five parameters ( @xmath32 , @xmath26 , @xmath37 , @xmath38 and @xmath39 ) are associated with the transformation of the coordinates from the needle - phantom to the machine reference frame ; another five parameters ( @xmath15 , @xmath16 , @xmath44 , @xmath53 and @xmath42 ) pertain to the geometry in the machine reference frame ; finally , the parameter @xmath55 describes the orientation of the detector .",
    "all these parameters , save for @xmath15 and @xmath16 , vanish in an ideal world , devoid of mechanical imperfection and inaccurate calibrations .",
    "the input data to the geometric calibration comprise one complete scan of the needle phantom .",
    "the traces corresponding to the end - points of the needles are identified in the acquired images ; these two coordinates ( for each needle , in each input image ) represent the ` experimental ' values . for a given set of parameter values , the projections of the needle end - points onto the detector plane",
    "are calculated using the chain of equations ( [ eq : relationbetweenfandt])-([eq : detectorrotation ] ) ; these calculated values comprise the ` predictions ' .",
    "an optimisation scheme is set , by varying the model parameters and seeking the best description of the input data ; a standard @xmath61 function is minimised .",
    "we will now touch upon four issues which we consider important in our work .",
    "an image of the needle phantom is shown in figure [ fig : needlephantomprojection ] .",
    "the detection of the traces of the needle end - points is done in two steps .    to suppress noise , the average signal along the detector midline ( along the @xmath62 axis ) is created by averaging the contents of @xmath63 pixels in the @xmath64 direction , @xmath65 on either side of the midline . to remove the urethane background reliably , a fixed - width running window",
    "is applied to this average - signal data , creating the difference of the integrated signal to the ( linear ) background ( defined by the pixel values at the window limits ) .",
    "when the window covers places where only the urethane housing is projected , the values of the transformed signal are nearly @xmath66 .",
    "as the window approaches the projected axis of a needle , the transformed signal first attains a positive ( local ) maximum , then a negative ( local ) minimum ( at the position corresponding to maximum attenuation ) ; this signature is easily identified via simple software cuts .",
    "the algorithm is very efficient in detecting the signals corresponding to the needles , save for gantry - angle values around @xmath67 where the projected signals ( of the needles ) overlap .",
    "after the signal modes ( the peaks in the transformed - signal spectrum ) are assigned to the needles , the projection of each needle is followed towards the couch ( along the negative @xmath64 direction in figure [ fig : needlephantomprojection ] ) .",
    "two signal levels are identified : one corresponding to the projection of the needle , one to the urethane background . the projection of the needle end - point is assumed to correspond to the position where the signal is equal to the geometric mean of these two values .",
    "two coordinates ( @xmath58 and @xmath59 ) are thus determined for each needle in each input image . if more or fewer than five signals are detected in the lateral direction , the entire image is rejected . if a needle axis was found , but the identification of the end - point failed , the information relating to the particular needle is removed from the contribution of the current image to the database .      to decrease the correlations among the model parameters in the fits ,",
    "it was decided to fix the distance @xmath15 to the nominal value corresponding to the unit being calibrated .",
    "for one thing , the description of the data with variable @xmath15 hardly improves ; for another , if @xmath15 and @xmath16 are both treated as free parameters , the largeness of their correlation might result in cases where the fit ` drifts ' .",
    "due to the different sensitivity of the two directions ( @xmath62 and @xmath64 in figure [ fig : needlephantomprojection ] ) to the model parameters , the fit in the lateral direction ( @xmath62 coordinates ) is performed first ; this fit achieves the extraction of the values of the parameters @xmath26 , @xmath37 and @xmath39 ( associated with the relationship among the various coordinate systems ) , and @xmath16 , @xmath44 and @xmath42 ( associated with the geometry in the machine reference frame ) .",
    "the remaining parameters are determined from the fit to the @xmath64 coordinates , which is performed with the values of the aforementioned six parameters fixed from the @xmath62-direction fit . for small @xmath55 ,",
    "the movement of a trace in the @xmath64 direction is always small , whereas in the @xmath62 direction it may be small or large , depending on the position of the point being projected ; this is one of the reasons for the larger uncertainties in the determination of @xmath38 and @xmath53 ( compared to @xmath37 and @xmath44 ) , the other one being their strong correlation .",
    "the minuit package of the cern library , see james ( 1994 ) , has been invariably used in the present paper .",
    "all output uncertainties contain the birge factor @xmath68 , which adjusts the output uncertainties for the goodness of each fit ; ndf denotes the number of degrees of freedom .",
    "the output shows no sensitivity to the values of the model parameters which are used in the first iteration of the optimisation scheme .",
    "the dependence of the parameters of our model on the gantry angle can only indirectly be assessed ; in our scheme , their values are assumed constant within one scan .",
    "if present at a significant level , a departure from constancy will manifest itself in the creation of large residual effects ; the point will be discussed later on .      experience has shown that the presence of noise in the input data might lead to the extraction of erroneous signal modes in the transformed - signal spectrum ; this failure rate never exceeded the @xmath69 level .",
    "however , to safeguard against such cases , it was decided to precede the main optimisation by one performed on the data of each needle _ separately _ ; this approach is more efficient in detecting and excluding the outliers .",
    "since the results obtained with logarithmic forms of the objective function are considerably less sensitive to the presence of outliers ( compared with those of the standard @xmath61 optimisation ) , the minimisation of a simple logarithmic form has been implemented in this part of the analysis .",
    "the outliers are identified via a software cut corresponding to a @xmath70 effect for the normal distribution ; other values ( e.g. , @xmath3 and @xmath71 cuts ) have also been used , resulting in tiny differences in the numbers quoted here .",
    "the residuals are defined as the differences between the experimental values and the corresponding predictions obtained when using the optimal values of the model parameters .",
    "there are three reasons why the residuals are not identically zero : ( i ) the statistical fluctuation ( random noise ) which is always present in measurements , ( ii ) the inclusion of erroneous data in the input database and ( iii ) the use of an insufficient ( incomplete ) model in the description of the measurements .",
    "concerning potential sources of systematic effects in the present work , one may recall some assumptions on which our model is based ; for instance , it may be that ( within one scan ) the rotation axis is not constant , the movement of the x - ray source is irregular , the connecting arms are distorted under the weight of the gantry and/or of the detector , etc .",
    "additional effects may have been introduced by approximations assumed in the geometry of the systems ; for example , it could be that additional degrees of freedom are needed in describing the orientation of the detector . in any case ,",
    "given the smallness of these effects ( which will presently be shown ) , the question one has to answer is whether the complete description of the observations in terms of a model is called for , or it is adequate to make use of a simple model , grasp the main features of the geometry and attempt the empirical description of the residual effects ; a number of reasons compel us to adopt the latter strategy .",
    "examples of the residuals in the lateral and longitudinal directions are shown in figures [ fig : residuals ] . in both directions , when plotted versus the gantry angle separately for each needle , the residual distributions overlap ; therefore , two average numbers ( i.e. , one per direction ) may be used in each image . to demonstrate the reproducibility of the effect ,",
    "the results of five scans taken in identical conditions are shown .",
    "two conclusions can be drawn from figures [ fig : residuals ] : ( i ) the residual effects are small , the variation being of the order of one pixel size of the detector in the lateral and two in the longitudinal direction and ( ii ) the residual effects are systematic , hence they can be modelled",
    ". the description of the lateral ( @xmath72 ) and longitudinal ( @xmath73 ) residuals will be attempted by using the empirical formulae : @xmath74 and @xmath75",
    "the experimental data were acquired on january 31 , 2006 .",
    "the validity of the conclusions drawn from those data was confirmed by an analysis of additional measurements obtained on april 26 , 2006 ; the results of the analysis of the april data will not be given here .",
    "the ( adjustable ) distance @xmath16 was set to @xmath76 mm both in the as device and the obi unit . the nominal @xmath15 value in the",
    "as is @xmath77 mm ; @xmath15 was set to @xmath77 mm in the obi . on each machine , the following steps were taken .",
    "the voltage of the x - ray tube was set ( @xmath78 kv in the as , @xmath5 kv in the obi ) .",
    "the dark- and flood - field calibrations were performed , so that flat images may be obtained in open - field geometry .",
    "the needle phantom was placed close to the ideal geometry of figure [ fig : placementatisocentre ] .",
    "the acquisition settings ( x - ray - tube current and pulse width ) were chosen in such a way as to yield a good - quality signal on the detector .",
    "the frame rate was set to @xmath65 images per second on both machines , thus resulting in about @xmath79 images on the as device and @xmath80 on the obi unit ( the rotation of the clinac is slower ) . to investigate the short - term reproducibility of the results of the geometric calibration",
    ", five counterclockwise ( ccw ) and five clockwise ( cw ) scans were acquired in identical geometry ( except for the rotation of the gantry , no other movement of the system components was allowed ) on each of the two machines .",
    "both series started with a ccw scan ; successive scans were taken in opposite directions .",
    "it is noteworthy that , save for a trivial difference in the values of parameter @xmath26 , no other effect ( between ccw and cw scans ) is expected in systems behaving identically in the two rotation modes .",
    "we have already mentioned that @xmath26 takes account of two effects : ( i ) the miscalibration of the gantry angle and ( ii ) the movement of the source during the time interval from the retrieval of the gantry - angle value ( from the system ) to the instant associated with the ` average ' of the actual exposure ; as the gantry - angle value is obtained a few micro - seconds after the ` beam - on ' condition ( i.e. , at the beginning of the emission of the radiation pulse ) , the time delay of case ( ii ) above may be thought of as being equal to half the acquisition setting for the pulse width .",
    "since @xmath81-msec pulses were used , the difference in the @xmath26 values between ccw and cw scans is expected to be about @xmath82 in the as device and @xmath83 in the obi unit .",
    "the average of the two @xmath26 values between ccw and cw scans provides an estimate of the miscalibration of the gantry angle .",
    "our results for the optimal values of the model parameters are shown in table [ tab:1-table ] , separately for ccw and cw scans .",
    "inspection of this table leads to the following conclusions .    *",
    "the values of the model parameters come out reasonable .",
    "the values of the isocentre - detector distance @xmath16 are almost identical in ccw and cw scans and close to the expectation value .",
    "the values of the distortion angles are small . *",
    "the variation in the values of the model parameters within each rotation mode is , in most cases , smaller than the corresponding statistical uncertainty . *",
    "the @xmath26 and @xmath42 values come out different in the two rotation modes in the as device .",
    "we will prove , however , that these differences are the product of the strong correlation between these two parameters .",
    "concerning the obi data , the difference in the @xmath26 values may entirely be attributed to the delay time . * the largest difference between the two rotation modes in the as device relates to the description of the residuals in the longitudinal direction .",
    "the two amplitudes @xmath84 of equation ( [ eq : residualsy ] ) come out reasonably close , but the phase shifts @xmath85 do not .",
    "this discrepancy has been systematic for a long period of time and has been verified using other techniques ; it is _ not _ a result of strong correlations among the model parameters . due to the lack of obvious structure in the distribution of the residuals in the lateral direction in the as device",
    "( some structure was observed in part only of each scan ) , it was decided not to attempt a fit using equation ( [ eq : residualsx ] ) there .",
    "the difference in the @xmath85 values for the obi unit is statistically significant , but not so pronounced as in the case of the as device . *",
    "the remaining differences are small in absolute value ; for instance , the effect in @xmath37 , the largest one observed , corresponds to one - ninth of the pixel size of the detector in the as device and between one - sixth and one - seventh in the obi unit .",
    "notwithstanding the smallness of the mismatch , it is evident that the systems do not behave identically in the two rotation modes , suggesting the introduction of two sets of corrections to the scan data .",
    "the issue of the correlation among the model parameters has to be properly addressed .",
    "the parameters @xmath26 and @xmath42 are strongly correlated in the fit to the @xmath62 coordinates ( of the traces of the needle end - points ) , whereas @xmath38 and @xmath53 are correlated in the @xmath64-direction fits ; the remaining elements of the hessian matrix are ( in absolute value ) smaller than @xmath86 , indicating insignificant correlations . due to the fact that the differences in the values of the parameters @xmath38 and @xmath53 in the two rotation modes are not statistically significant and , additionally ,",
    "these two parameters are not correlated with any other , we will investigate the correlation only between the parameters @xmath26 and @xmath42 . from the theoretical point of view",
    ", these two parameters are independent ; the distortion angle @xmath42 defines the offset of the source with respect to the detector in the machine reference frame , whereas @xmath26 , pertaining to the relationship between the isocentre and machine reference frames , applies equally to all machine components . in reality however , possibly coupled with the smallness of these distortion angles , a strong correlation between @xmath26 and @xmath42 has been observed . to investigate whether the differences between the two rotation modes may be attributed to the correlation between these two parameters , we analysed the measurements acquired in the as device further , after fixing @xmath42 at @xmath87 ; the results for the model parameters are given in table [ tab:2-table ] .",
    "we found that the description of the data with fixed @xmath42 is as good as when it is allowed to vary freely .",
    "the changes induced by fixing @xmath42 are entirely absorbed by parameter @xmath26 , the values of which turn out now to be in good agreement with the expectation , based on the movement of the source within the delay time ( ` beam - on ' condition to average exposure ) .",
    "the values of all other parameters are almost intact .",
    "our conclusion is that the correlation between the model parameters @xmath26 and @xmath42 affects only the values of these two parameters .",
    "a good measure of the mechanical stability of a system may be obtained from the unexplained variation in the data , that is , from whichever fluctuation survives after all model contributions have been deducted .",
    "as previously mentioned , in the case of the as runs , the unexplained variation in the lateral direction is represented by the entire fluctuation contained in these residuals , whereas in the longitudinal direction the empirical formula ( [ eq : residualsy ] ) is assumed to be part of the model .",
    "for the ccw scans , the rms of the unexplained variation in the lateral direction is equal to @xmath88 @xmath14 m ; for the cw scans , it is @xmath5 @xmath14 m",
    ". therefore , the ccw scans seem to be somewhat smoother in the as device .",
    "the two values of the rms of the unexplained variation in the longitudinal direction come out almost identical : @xmath89 @xmath14 m . as the residuals in both directions",
    "are structured in the case of the obi unit  , they have been fitted to via equations ( [ eq : residualsx ] ) and ( [ eq : residualsy ] ) .",
    "figures [ fig : residuals ] correspond to the five ccw scans in the obi unit . in case of the ccw scans ,",
    "the rms of the unexplained variation in the lateral direction is equal to @xmath90 @xmath14 m ; in the cw scans , it is @xmath91 @xmath14 m .",
    "the corresponding numbers , assuming no modelling of the lateral residuals , are @xmath92 and @xmath93 @xmath14 m ; therefore , the unexplained variation in the lateral direction drops significantly when involving the empirical modelling of these residuals . in both rotation modes ,",
    "the rms values of the unexplained variation in the longitudinal direction come out identical : @xmath94 @xmath14 m .",
    "comparing the results obtained in the as device with those extracted from the obi unit , one notices that the as scans are less noisy in the longitudinal direction .",
    "the values of the unexplained variation in the data in the longitudinal direction come out the same for ccw and cw scans , smaller than one - fifth of the pixel size of the detector in the as device , one - third in the obi unit . in the lateral direction ,",
    "the unexplained variation is smaller than one - sixth of the pixel size of the detector in both systems .",
    "it is interesting to note that , after equation ( [ eq : residualsx ] ) has been invoked in the description of the residuals in the lateral direction , the ccw scans on obi correspond to a significantly smaller value of the unexplained variation ; a similar effect is observed in the as device , where equation ( [ eq : residualsx ] ) was not used . in any case , the description of the data has been achieved at the sub - pixel level in both systems which were calibrated .",
    "the aim of the geometric calibration of cone - beam imaging and delivery systems is threefold : to yield the values of important parameters in relation to the geometry of the system , to provide an assessment of the deviation from the ideal world ( where the machine components move smoothly and rigidly in exact circular orbits as the gantry rotates ) and to enable the investigation of the long - term mechanical stability of the system .",
    "the method described here applies to devices where an x - ray source and a flat - panel detector ( facing each other ) move in circular orbits around the irradiated object .",
    "contrary to the bulky cylinders , which are generally needed in other works in order to extract the parameters of the geometry , we introduce a light needle phantom which is easy to manufacture .",
    "a model has been set up to describe the geometry and the mechanical imperfections of the system being calibrated .",
    "the model contains five parameters associated with the transformation of the coordinates from the needle - phantom to the machine reference frame ; another five parameters account for the geometry in the machine reference frame ; finally , one parameter is introduced to account for the deviation in the orientation of the detector from the ideal geometry . to avoid strong correlations among the important parameters of the model , the source - isocentre distance",
    "is set to the nominal value of the device being calibrated .",
    "the input data comprise one complete scan of the needle phantom .",
    "the end - points of the needles are identified in the acquired images and comprise the ` experimental ' values",
    ". a robust optimisation scheme has been put forth to enable the extraction of the model parameters from the entirety of the input data .    the application of the approach to two sets of five counterclockwise ( ccw ) and five clockwise ( cw ) scans , acquired in two imaging devices manufactured by varian medical systems , inc .",
    ", yielded consistent and reproducible results .",
    "the values of the model parameters come out reasonable .",
    "the description of the data has been achieved at the sub - pixel level .",
    "a number of differences have been seen between ccw and cw scans , suggesting that the devices do not behave identically in the two rotation modes ; we are not aware of other papers which have investigated and reported this effect . as a indispensable part of our project , we have introduced and implemented a calibration scheme in which different parameter sets apply to the scan data depending on the rotation mode used .",
    "we would like to draw attention to this effect , since the differences , albeit small , are systematic .",
    "mitschke m and navab n 2003 recovering the x - ray projection geometry for three - dimensional tomographic reconstruction with additional sensors : attached camera versus external navigation system _ med .",
    "* 7 * 65 - 78    noo f ,",
    "clackdoyle r , mennessier c , white t a and roney t j 2000 analytic method based on identification of ellipse parameters for scanner calibration in cone - beam tomography _ phys .",
    "biol . _ * 45 * 3489 - 508    siewerdsen j h , moseley d j , burch s , bisland s k , bogaards a , wilson b c and jaffray d a 2005 volume ct with a flat - panel detector on a mobile , isocentric c - arm : pre - clinical investigation in guidance of minimally invasive surgery _ med .",
    "phys . _ * 32 * 241 - 54      the optimal values of the model parameters in the vms acuity - simulator ( as ) and ` on - board imager ' ( obi ) units .",
    "the values quoted represent averages of five counterclockwise ( ccw ) and five clockwise ( cw ) scans .",
    "all lengths are in mm , all angles in degrees .",
    "the first uncertainties are systematic , the second statistical .",
    "left : the vms acuity - simulator device ( vms laboratory , baden , switzerland ) .",
    "the x - ray source is at a position corresponding to about @xmath95 .",
    "right : a schematic view of the various elements of a system on the rotation plane ( facing the gantry , as in the figure on the left ) .",
    "shown is the placement of the needle phantom in the ideal geometry ; the axis of the central needle coincides with the rotation axis . @xmath15 and",
    "@xmath16 denote the source - isocentre and isocentre - detector distances.,title=\"fig:\",width=283 ] left : the vms acuity - simulator device ( vms laboratory , baden , switzerland ) .",
    "the x - ray source is at a position corresponding to about @xmath95 .",
    "right : a schematic view of the various elements of a system on the rotation plane ( facing the gantry , as in the figure on the left ) .",
    "shown is the placement of the needle phantom in the ideal geometry ; the axis of the central needle coincides with the rotation axis . @xmath15 and @xmath16",
    "denote the source - isocentre and isocentre - detector distances.,title=\"fig:\",width=283 ]    the coordinate systems used in the present paper .",
    "a ) the isocentre ( subscript @xmath96 ) and the machine ( subscript @xmath21 ) reference frames ; they are related via a simple rotation ( angle @xmath26 ) .",
    "b ) the needle - phantom ( subscript @xmath28 ) and the auxiliary ( subscript @xmath97 ) reference frames ; they are related via a simple rotation ( angle @xmath32 ) .",
    "the auxiliary and isocentre reference frames are related via a simple translation involving the vector ( @xmath37,@xmath38,@xmath39).,width=302 ]    machine reference frame : derivation of the projection of a point p ( on the rotation plane ) onto the detector ; the quantity @xmath46 represents the length ip .",
    "two deviations from the ideal geometry ( on the rotation plane ) have been introduced : the angle @xmath42 and the lateral displacement of the detector @xmath44 .",
    "the isocentre position is denoted by i.,width=283 ]    an example of an image of the needle phantom .",
    "the origin of the coordinate system shown coincides with the geometric centre of the detector ; ideally , @xmath64 is parallel to @xmath23 and @xmath62 to @xmath22 at @xmath45 .",
    "the shift of the axis of the central needle to the right is due to the nonzero values of the parameters @xmath37 and @xmath44 .",
    "a small tilt , hardly visible , is due to the nonzero values of the couch angle @xmath32 and of the detector orientation angle @xmath55.,height=377 ]    the residuals in the lateral direction ( left ) and those in the longitudinal direction ( right ) versus the gantry angle @xmath17 for the vms ` on - board imager ' ( obi ) unit ; each point represents the average value over the needles whose end - points were successfully identified in the corresponding image . shown",
    "are the results of five counterclockwise scans taken in identical conditions ; these scans are represented by different symbols.,title=\"fig:\",height=283 ] the residuals in the lateral direction ( left ) and those in the longitudinal direction ( right ) versus the gantry angle @xmath17 for the vms ` on - board imager ' ( obi ) unit ; each point represents the average value over the needles whose end - points were successfully identified in the corresponding image . shown",
    "are the results of five counterclockwise scans taken in identical conditions ; these scans are represented by different symbols.,title=\"fig:\",height=283 ]"
  ],
  "abstract_text": [
    "<S> we propose a method to achieve the geometric calibration of cone - beam imaging and delivery systems in radiation therapy ; our approach applies to devices where an x - ray source and a flat - panel detector , facing each other , move in circular orbits around the irradiated object . in order to extract the parameters of the geometry from the data </S>",
    "<S> , we use a light needle phantom which is easy to manufacture . </S>",
    "<S> a model with ten free parameters ( spatial lengths and distortion angles ) has been put forth to describe the geometry and the mechanical imperfections of the units being calibrated ; a few additional parameters are introduced to account for residual effects ( small effects which lie beyond our model ) . </S>",
    "<S> the values of the model parameters are determined from one complete scan of the needle phantom via a robust optimisation scheme . </S>",
    "<S> the application of this method to two sets of five counterclockwise ( ccw ) and five clockwise ( cw ) scans yielded consistent and reproducible results . </S>",
    "<S> a number of differences have been observed between the ccw and cw scans , suggesting a dissimilar behaviour of the devices calibrated in the two rotation modes . </S>",
    "<S> the description of the geometry of the devices was achieved at the sub - pixel level . </S>",
    "<S> +    _ keywords _ : geometric calibration + </S>"
  ]
}