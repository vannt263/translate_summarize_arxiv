{
  "article_text": [
    "charge transfer ( ct ) reactions are ubiquitous in all branches of chemistry , and huge efforts have been spent in the past to analyze these processes in terms of theoretical models @xcite .",
    "they can be categorized into process in which a charge separation in a donor  acceptor system takes place , @xmath0 and processes where the charge has been externally created ( either by injecting or removing an electron ) , @xmath1 where we define @xmath2 as the donor and @xmath3 as the acceptor . for the reactions in ( [ pm ] ) and ( [ m ] ) , donor and acceptor are defined in terms of donating and receiving electrons , while in ( [ p ] ) the definitions are in terms of the location of the excess positive charge .",
    "the three kinds of ct reactions in ( [ pm][p ] ) are involved in a plethora of important processes .",
    "for example ( [ pm ] ) may resemble a charge splitting event either at a semiconductor interface , between an organic dye and a semiconductor , or the charge separation event in the reaction centers of photosynthetic systems .",
    "generally , all the charge separation events can be thought of in terms of a two - state model comprised of a neutral state and a charge separated state . throughout this work",
    ", we call the reactions involving only the motion of an excess of charge , as in ( [ m ] ) and ( [ p ] ) , migration ct ( mct , hereafter ) reactions .",
    "mct reactions are the simplest type of reactions involving ct states , and take place in many fundamental processes related to charge mobility , transport , and enzyme functionality . in these processes",
    ", the charge separation event has happened in the past , and the problem shifts to the prediction of the kinetics of the excess charge , may that be across a polymer @xcite ( organic electronics ) , a protein ( enzyme functionality @xcite and photosynthesis @xcite ) , or dna @xcite ( oxidative damage )",
    ".    very often , the ground and mct states are close in energy and one easily finds the first mct state as being the first excited state of the system .",
    "this is an important advantage in theoretical studies of this type of states as opposed to other types of excited states for which the excited state search can be a daunting task .",
    "another important quality of mct states is the simple physical depiction of ground and excited states : the former has an excess charge on the , say , `` left '' , and the latter features an excess charge on the `` right '' .",
    "obviously , this simple depiction becomes more complicated as soon as the system under study contains more than two chemical moieties capable of accepting / donating an excess charge .",
    "these unique qualities make mct states a perfect testbed for new computational methods aiming at the accurate prediction of generally all kinds of ct excitations .",
    "there are two fundamentally different schemes for calculating ct excitations .",
    "the first one involves the construction of hamiltonian and overlap matrices in a basis of charge - localized broken - symmetry states .",
    "this basis set is often called a diabatic basis set , and the basis functions termed diabatic states .",
    "the chosen broken - symmetry states in the set should resemble the true ground and the ct excited states of the system . depending on the size of the basis set ( or equivalently",
    "the number of broken - symmetry states included in the calculation ) the simultaneous diagonalization of overlap and hamiltonian matrices ( i.e.  solving the generalized eigenvalue problem ) yields the sought ground and ct excited states .",
    "the latter diagonalization step is similar to the diagonalization step in the configuration interaction ( ci ) method carried out with valence bond configuration state functions .",
    "even though this is a general method , it is particularly suited for the calculation of ct excited states .",
    "this is because contrary to valence excitations , the broken - symmetry basis functions assume a simple charge - localized character and relatively uncomplicated computational criteria can be devised for their generation @xcite .",
    "this is the method that we use in this work and is described in detail in the next section for a basis set comprised of two broken - symmetry states .",
    "contrary to the first scheme mentioned above , the alternative is not tailored specifically to ct excitations and it involves obtaining directly the adiabatic ground and excited states of the system . as such it is more general than the first scheme and",
    "is most often adopted in the literature . due to the high computational throughput of modern computers , calculations based on the latter scheme",
    "are now commonplace .",
    "a plethora of quantum chemistry methods are devoted to the prediction of excited states energies , transition moments , densities , and wave functions . despite this , ct excited states have always been more challenging than others , because for this kind of excitations the electron density changes dramatically compared to the ground state one .",
    "density - functional theory ( dft ) , and specifically its time - dependent extension ( td - dft ) through the linear - response formalism for the calculation of electronic excitations and transition moments  @xcite has struggled to correctly deal with ct excitations when employing approximate density functionals  @xcite .",
    "pragmatic corrections exist , such as the one originally developed by gritzenko _ et al . _",
    "@xcite , or the one involving the _ peach factor _  @xcite .",
    "range separated  @xcite density functionals have also offered an effective solution to the problem by enforcing the correct long - range behavior at the price of including yet another parameter to the density functional ( the range separation parameter , often denoted by @xmath4 ) . methodologies to obtain @xmath4 parameters which satisfy certain system - dependent and process - dependent conditions",
    "have been proposed  @xcite .",
    "novel computational approaches to obtain charge - transfer excited states within a dft formalism are being explored .",
    "specifically , a variational formulation of td - dft  @xcite has shown to alleviate or to completely cure the ct excitation failures of linear - response td - dft when the fourth - order relaxed constrained - variational td - dft method is employed , however , at the expense of higher computational complexity than standard linear - response td - dft .    wave function",
    "based methods also have encountered difficulties when approaching ct excitations .",
    "the low end of wave function methods , configuration interaction with singles ( cis ) and time - dependent hartree ",
    "fock ( td - hf ) , are known to grossly overestimate ct excitation energies  @xcite .",
    "more balanced methods , such as multi - configuration self - consistent field ( mcscf ) , multi - reference ci ( mr - ci ) , or perturbative corrections to cis , such as cis(d ) , as well as adc(2 )  @xcite are able to deliver good ct excitation energies  @xcite and are often taken as benchmark  @xcite .",
    "mcscf , however , is known to fail near avoided crossings ( a feature always present in systems featuring mct excitations ) unless state averaging is employed  @xcite .",
    "the equation - of - motion coupled cluster ( eom - cc ) theory  @xcite is also known to fail in reproducing ct excitations with a similar accuracy than ionization potentials and electron affinities  @xcite due to its non size - extensivity stemming from the non - exponential from of the eom - cc ansatz for the excited states .",
    "linear - response cc , and specifically an approximation to it including only single and double excitations known as cc2 has been very successful in predicting ct excitations  @xcite . a particularly powerful implementation of cc2 utilizing the resolution of the identity ( ri - cc2 ) @xcite is routinely applied to systems with up to 100 atoms .",
    "it is now understood that to obtain an accurate description of ct excitations the employed method must describe the dynamic correlation of the ct excited states similarly to the one of the ground state  @xcite .",
    "in addition , the computational costs associated with all the wave function methods mentioned above ( with the exception of td - hf and cis ) are prohibitive for most systems in condensed - phase and biosystems of interest .    in the next section",
    ", we will describe in detail how ground and ct excited state energies and wave functions can be obtained starting from a basis set comprised of two broken - symmetry states . in section [ sect_fde ]",
    "we will introduce the frozen density embedding fomulation of subsystem dft ( a linear - scaling , full - electron electronic structure method ) which we use to determine the electronic structure of the broken - symmetry , charge - localized states .",
    "then in section [ sect_ctefde ] we will present the theory behind the calculation of the full - electron hamiltonian and overlap matrix elements among the broken - symmetry states ( generated with subsystem dft ) which we have implemented in the  ( ) computer software  @xcite .",
    "section [ sect_val ] is devoted to benchmarking of the method for two selected cases of mct , e.g.  hole transfer in water and ethylene dimers at several inter - monomer separations .",
    "section [ sect_pilot ] features two pilot calculations of the hole transfer in water and ethylene clusters containing up to 56 and 20 molecules , respectively .",
    "consider a system comprised of a charge donor and a charge acceptor moiety in the absence of low - lying intermediate bridge states ( da system hereafter ) .",
    "such a system can be well characterized by a two - state formalism .",
    "that is , it is enough to consider either the adiabatic ground and first excited state or a set of two broken - symmetry charge - localized states to capture most of the underlying physics .",
    "there is a large literature @xcite supporting the idea that the states with localized excess charges , i.e.  one where the charge is localized on the donor and , conversely , one where the charge is localized on the acceptor , are an appropriate basis for modeling the process of charge migration between donor and acceptor .",
    "a state with localized charges generally is not the ground state of the system hamiltonian .",
    "therefore , in the basis of charge - localized states , the hamiltonian matrix is non - diagonal .",
    "in addition , as these states are of broken - symmetry character , they are generally non - orthogonal to each other . throughout this work",
    ", we will refer to the full - electron wave functions of the two charge - localized states as @xmath5 and @xmath6 . for da systems ,",
    "the hamiltonian ( @xmath7 ) and overlap matrices ( @xmath8 ) in this basis are of dimension @xmath9 , namely @xmath10 @xmath11 the definitions in eqs .",
    "( [ hdia ] ) and ( [ sdia ] ) allow us to obtain the ct excitation energy as the energy difference of the orthonormal adiabatc states , which can be obtained by solving the generalized eigenvalue problem , @xmath12 the above equation yields two energy eigenvalues ( say @xmath13 and @xmath14 ) and their difference ( @xmath15 ) is the sought ct excitation . in a closed form , we obtain @xcite @xmath16 where @xmath17 $ ] . the problem",
    "is then shifted to calculating four matrix elements , i.e.  the two diagonal hamiltonian elements ( @xmath18 and @xmath19 , e.g.  the total energies of the charge - localized states or diabatic energies ) , the @xmath20 off - diagonal matrix element , and the @xmath21 overlap element .",
    "the @xmath22 element introduced above is commonly referred to as electronic coupling .",
    "several methods and algorithms have been proposed to generate ad - hoc charge - localized states and to calculate the above matrix elements both for purely wave function methods @xcite as well as dft methods @xcite .",
    "regular wave function and dft methods tend to scale non - linearly with the system size",
    ". therefore , important systems of biological interest , large organics and hybrid organic  inorganic systems ( such as dye - sensitized solar cells ) are largely out of reach of these methods unless truncated model systems or substantial approximations are introduced at the electronic structure theory level .    in this work , we build upon ideas presented in a previous paper  @xcite and we construct the broken - symmetry charge - localized states using a linear - scaling technique called frozen density embedding  @xcite .",
    "the construction of the charge - localized , diabatic states is a prerequisite in this formalism for the calculation of the ct excitation energies .",
    "a brief description of this technique follows this section .",
    "subsystem dft is a successful alternative to regular kohn ",
    "sham ( ks ) dft methods due to its ability to overcome the computational difficulties arising when tackling large molecular systems@xcite .",
    "one particular variant of subsystem dft is the fde approach developed by wesolowski and warshel  @xcite .",
    "fde splits a system into interacting subsystems and yields subsystem electron densities separately .",
    "hence , it defines the total electron density , @xmath23 , as a sum of subsystem densities  @xcite , @xmath24 where the sum runs over all subsystems .",
    "the subsystem densities are found by solving subsystem - specific ks equations , known as ks equations with constrained electron density or ksced @xcite . in these equations ,",
    "the ks potential @xmath25 is augmented by an embedding potential @xmath26 which includes the electrostatic interactions taking place between electrons and nuclei of the subsystems as well as a potential term deriving from the non - additive kinetic energy ( @xmath27 ) and non - additive exchange - correlation ( @xmath28 ) functional derivatives .",
    "we refer to refs .",
    "@xcite for more details on the fde theoretical framework , however , for sake of clarity we report here the spin ksced equations which lead to the subsystem orbitals @xmath29\\phi_{(i)_i}^{\\sigma}(\\br ) = \\epsilon_{(i)_i}^{\\sigma } \\phi_{(i)_i}^{\\sigma}(\\br),\\ ] ] where @xmath30 are the molecular orbitals of subsystem @xmath31 and of spin @xmath32 .",
    "the fde scheme greatly reduces the computational cost compared to ks - dft , as there is no need to calculate orbitals for the total ( `` super '' ) system , and the total computational complexity is then linear over the number of subsystems composing the total supersystem . however , the reduced cost in fde compared to ks - dft is achieved at the expense of approximating the non - additive functionals with semilocal density - functional approximants .",
    "this approximation , for the kinetic energy especially , is the single source of certain shortcomings of fde , for example when applied to covalently bound subsystems @xcite .",
    "recently , two of the present authors have shown in ref .",
    "@xcite that fde can be successfully used to calculate migration ct couplings and excitation energies . in this work",
    ", we present a different algorithm for obtaining the elements of the full - electron hamiltonian and overlap matrices defined in eqs .",
    "( [ hdia ] ) and ( [ sdia ] ) which has significant advantages over the previous method .",
    "specifically , the new formalism can be applied to symmetric systems ( out of reach before due to a singularity in the working equations @xcite ) and , as it will be clear in section [ sect_val ] , yields very accurate excitation energies with mainstream gga - type functionals , while before it was necessary to include hf non - local exchange to the functional to counteract the self - interaction error .",
    "in addition , two new algorithms have been implemented here .",
    "we call them subsystem - joint transition density ( jtd ) and subsystem - disjoint transition density ( dtd ) formalisms .",
    "while the former is computationally straightforward , it formally does not scale linearly with the number of subsystems . instead",
    ", the latter scales linearly with the number of subsystems and , thus , it is theoretically consistent with the fde formalism .",
    "suppose we have two broken - symmetry slater determinants describing two charge - localized states @xmath5 and @xmath6 .",
    "the wave functions in terms of the two set of molecular orbitals take the form @xmath33,\\ ] ] where the antisymmetrizer @xmath34 also contains appropriate normalization constants . generally , the two sets of molecular orbitals @xmath35 and @xmath36 may not be orthonormal to each other and within the sets .",
    "this usually happens for broken - symmetry hf and ks - dft solutions as well as for ks - determinants derived from constrained dft  @xcite and subsystem dft calculations @xcite .",
    "we define the transition orbital overlap matrix as follows @xmath37 in what follows , we only consider the case of a subsystem dft calculation , i.e.  we only deal with slater determinants of the system constructed form subsystem molecular orbitals as done in a previous work @xcite . to avoid redundance with the theory of ref .",
    "@xcite , let us briefly state that , similarly to the valence bond theory @xcite , the subsystem dft version of the slater determinant in eq .",
    "( [ phidef ] ) features products of occupied subsystem orbitals regardless of the fact that the orbitals between subsystems might not be orthogonal to each other . in the case of a two - subsystem partitioning ,",
    "the @xmath38 transition orbital overlap matrix can be formally written as @xmath39 where @xmath40 and @xmath41 are transition orbital overlap matrices calculated with the orbitals belonging to subsystem @xmath31 or @xmath42 , respectively ( subsystem transition orbital overlap matrices , hereafter ) , while @xmath43 and @xmath44 include the overlaps of the orbitals belonging to subsystem @xmath31 with the ones belonging to subsystem @xmath42 .",
    "let us clarify that there are two sources of non - orthogonality in this formalism .",
    "the first one stems from the overlap between the full - electron charge - localized states , i.e.  eq .  ( [ sdia ] ) , and the second one arises at the ( subsystem ) molecular orbital level in eqs .",
    "( [ phidef ] ) and ( [ overdef ] ) .",
    "the orbital overlap matrix is generally non - diagonal , also when it is computed from orbitals belonging to a single state , namely , @xmath45 it can be seen that the above matrix also is non - diagonal as the orbitals @xmath46 are borrowed from an fde calculation which does not impose orthogonality to orbitals belonging to different subsystems @xcite .",
    "going back to the elements of the @xmath43 and @xmath44 submatrices , it is clear that they are small in magnitude compared to the subsystem transition overlap matrices provided that the subsystems are not covalently bound to each other .",
    "the matrix form in eq .",
    "( [ overdef2 ] ) partially loses its block form in the case of electronic transitions that change the number of electrons in the subsystems , such as the ones considered in this work . specifically ,",
    "if the ct transition involves one electron , then the transition overlap matrix will have one column ( row ) with sizable non - zero elements across the subsystems involved in the ct event .",
    "in this work , we use the following formulas for the calculation of the hamiltonian coupling between the two charge - localized states  @xcite @xmath47 s_{12}\\ ] ] where @xmath48 , and @xmath49 is a scaled transition density derived from the orbitals of the two states , and the functional @xmath50 is an appropriate density functional . the transition density in eq .",
    "( [ supratrans ] ) is obtained from the integration of the one - particle dirac delta function , namely  @xcite @xmath51 where @xmath52 is the signed minor ( or cofactor ) of the transition orbital overlap matrix of eq .",
    "( [ overdef ] ) .",
    "then eq .",
    "( [ supratrans ] ) is obtained by simply dividing eq .",
    "( [ supratrans2 ] ) by @xmath53 , so that the scaled transition density integrates to the total number of electrons ( @xmath54 ) rather than to @xmath55 . scaling the transition density is a matter of algebraic convenience .",
    "( [ newcoupling ] ) is particularly simple in terms of a the scaled transition density , and is rigorous if the wavefunctions are single slater determinants and the hamiltonian is the molecular electronic hamiltonian @xcite ( i.e.  as in the hf method ) . in our work ,",
    "we consider two charge - localized states per calculation .",
    "these are generally non - orthogonal .",
    "however , for some systems , it is possible that the two states could accidentally be orthogonal . in this scenario ,",
    "the scaled transition density is recovered by employing the penrose inverse of the transition overlap matrix in eq .",
    "( [ supratrans ] ) .",
    "the matrix is inverted in the @xmath56 dimensional subspace ( usually @xmath57 ) where is it is not singular .",
    "it is important to point out that the coupling formula in eq .",
    "( [ newcoupling ] ) was derived assuming that @xmath58 are broken - symmetry hf wave functions . even though the hf and ks wave functions are both single slater determinants , the formula is not formally transferable from the hf method to a dft method ( as we do in this work ) .",
    "applying eq .",
    "( [ newcoupling ] ) in the context of dft is an approximation .",
    "it can be shown that in the context of linear - response td - dft eqs .",
    "( [ newcoupling ] ) and ( [ supratrans ] ) are equivalent to the tamm - dancoff approximation to td - dft . in addition , let us clarify that formally the hf exchange and hf and ks kinetic energy terms are computed with the transition density _ matrix _ , and thus the density in eq .",
    "( [ supratrans ] ) should be replaced by a quantity that depends on one electronic coordinate @xmath59 as well as another electronic coordinate , @xmath60 , namely @xmath61 . however , for sake of clarity , here we will limit ourselves to reporting the ( transition ) density without introducing the density matrix notation . as an example of how we apply eq .  ( [ newcoupling ] ) in practical calulations , consider a calculation in which we employ the lda exchange density functional , then the exchange contribution to the off - diagonal hamiltonian matrix element becomes @xmath62 s_{12}= - s_{12 } \\frac{3}{4}\\left ( \\frac{3}{\\pi } \\right)^{\\frac{1}{3 } } \\int \\left ( \\rho^{(12)}(\\br ) \\right)^{\\frac{4}{3 } } \\d\\br.\\ ] ] the diagonal elements of the hamiltonian are computed in a similar fashion as the off - diagonal ones , namely @xmath63\\ ] ] where @xmath64 note that the overlap element has disappeared in eq .",
    "( [ newener ] ) .",
    "while this is a trivial consequence of the normalization condition on the slater determinant in a regular ks - dft calculation , the ks slater determinant of the supersystem built with subsystem orbitals is not normalized .",
    "however , the corresponding fde density theoretically is the correctly normalized correlated density of the full system , integrating to the total number of electrons  @xcite .",
    "this is an important point as the number of electrons in a calculation is set by the trace of the ( transition or diagonal ) orbital overlap matrix , while the norm of a slater determinant depends upon the determinant of the corresponding orbital overlap matrix .    to summarize , the approximations we employ are equivalent to ( 1 ) replacing the hf slater determinants needed to define the charge - localized states @xmath58 with slater determinants made up of subsystem ks molecular orbitals , and ( 2 ) replacing the hf expression of @xmath65 $ ] by an approximate density functional .",
    "approximation ( 1 ) is often invoked in dft calculations of electronic couplings @xcite , while ( 2 ) was used before by kaduk _",
    "@xcite , and it is introduced here for the first time in the context of subsystem dft .",
    "contrary to the density , the scaled transition density introduced in eq .",
    "( [ supratrans ] ) might feature regions of space where it carries a negative sign .",
    "generally , exchange - correlation and kinetic - energy functionals may feature arbitrary fractional powers of the density that would render the exchange - correlation energy complex . by working with a scaled transition density that is quasi - positive almost everywhere in space ( see below ) , the simplest pragmatic workaround is to set the scaled transition density to zero everywhere in space where it actually has negative values . while this may seem to be a somewhat drastic approximation , we note that in practice only a small part of the scaled transition density needs to be changed , and the very good results observed in our test cases below empirically justify this procedure ( see section [ sect_val ] ) . in all the cases considered here , the neglect of the negative parts of the scaled transition density affected its total integral by less than a tenth of a percentile point .",
    "the quasi positivity of the scaled transition density can be explained with two arguments . in a frozen core approximation ,",
    "if the only orbital product term left in the scaled transition density is negative almost everywhere in space , then that product will give rise to a negative element of the inverse of the transition overlap matrix ( being just the inverse of that orbital overlap in this approximation ) .",
    "thus , the scaled transition density will be positive almost everywhere , as the above mentioned orbital product is multiplied by the inverse overlap in the equation for the scaled transition density .",
    "the second argument uses the fact that the scaled transition density integrates to @xmath54 , it can be decomposed into two contributions , one corresponding to the @xmath66 electron system undergoing little changes in the transition , and the other corresponding to the single transferring electron .",
    "only the latter component has possibly negative contributions to the scaled transition density , and is unlikely to overpower the much larger @xmath66 component .",
    "generally , in those cases where the @xmath21 overlap is zero because @xmath67 orbital overlaps ( @xmath67 rows / columns of the transition overlap matrix ) are identically zero , we employ the penrose inversion of the transition overlap matrix and @xmath68 is indeed a @xmath56 `` positive '' electron system `` plus '' an @xmath67 electron system that overall integrates to zero ( and thus half positive and half negative ) . in this case",
    "the scaled transition density integrates to @xmath56 and because @xmath69 , the negative parts of the @xmath67 electron system will unlikely overpower the positive @xmath56 electron system . in any even",
    ", this orthogonal case will yield a zero @xmath20 matrix element as calculated by eq .",
    "( [ newcoupling ] ) .",
    "thus , even in those cases where the scaled transition density has large negative parts ( which we never encountered in our calculations ) , its contribution to the hamiltonian matrix element will be negligible due to either a negligible or a zero overlap element .",
    "we should warn the reader that the sign of the scaled transition density is independent of wave function phase factors .",
    "in fact , wave function phase factors do not affect the scaled transition density as the overlap element between the @xmath54-electron wave functions ( slater determinants in the context of our work ) will carry with it the same phase factor as the conventional transition density .",
    "thus , following the definition of the scaled transition density in eq .",
    "( [ supratrans ] ) , dividing the conventional transition density by the overlap has the effect of removing the phase factor altogether . for sake of brevity",
    ", hereafter we will drop `` scaled '' when referring to the above scaled transition density . in calculating the transition density from fde subsystem orbitals coming from the ksced equation in eq .",
    "( [ ksced ] ) by applying eq .",
    "( [ supratrans ] ) , one must consider all of its subsystem contributions as well as its overlap - mediated inter - subsystem couplings .",
    "the transition density for a system partitioned in @xmath70 subsystems becomes @xmath71 it is interesting to notice that the above transition density `` joins '' orbital transitions of one subsystem with the ones of another subsystem through the terms in the sum over the subsystem s labels where @xmath72 .",
    "the coupling of these inter - subsystem transitions are weigthed by the matrix elements of the inverse of the transition orbital overlap matrix , @xmath73 .",
    "the diagonal density , i.e.  the density of the broken - symmetry charge - localized states , can be formulated similarly applying eq .",
    "( [ supradens ] ) , namely , @xmath74 as pointed out previously  @xcite this density is not exactly the sum of subsystem densities obtained with the fde calculation from eq .",
    "( [ eq : int:1 ] ) , as the intersubsystem overlap elements do not appear in the fde formalism .",
    "such a density mismatch constitutes a second - order effect  @xcite and is not a concern here as we are going to apply the method only to non - covalently bound subsystems , that is , super - systems with small inter - subsystems orbital overlap . as we will see in the next section ,",
    "this density issue is completely by - passed by an fde - compatible theory we call `` disjoint transition density formulation '' .      the transition density in eq .",
    "( [ newtrans ] ) can be approximated by a density composed only of intra - subsystem orbital transitions . by recognizing that the off - diagonal blocks @xmath75 in eq .",
    "( [ overdef2 ] ) are always very small in magnitude when the subsystems are not covalently bound and if there is no electron transfer between subsystems the disjoint transition density can be written as @xmath76 where the tilde has been included to distinguish the above definition of disjoint transition density with the one we use for charge - transfer transition , see below . the off - diagonal hamiltonian matrix element ( @xmath20 )",
    "can therefore be calculated with either the joint transition density ( jtd ) in eq .",
    "( [ newtrans ] ) , giving rise to the jtd hamiltonian couplings ; or with the disjoint transition density ( dtd ) of eq .",
    "( [ newtransu ] ) , giving rise to the dtd hamiltonian couplings .",
    "the above definition of disjoint transition density can be cast in terms of a pure subsystem dft formulation . because in the fde formalism both the ground and excited state densities can be written as a sum of subsystem densities , as in eq .",
    "( [ eq : int:1 ] ) , namely , @xmath77 given that the subsystem densities are derived from slater determinants of subsystem orbitals , then it is enough to invoke approximation ( 1 ) ( i.e.  replace the hf slater determinants needed to define the charge - localized states @xmath58 with slater determinants made up of subsystem ks molecular orbitals ) the transition density relating states 1 and 2 is of the dtd type [ as in eq .",
    "( [ newtransu ] ) ] .",
    "however , if the electronic transition involves electron transfer between subsystem @xmath78 and @xmath79 , then the transition density can not be completely disjoint , and it can be approximated by ( note , compared to eq .",
    "( [ newtransu ] ) the tilde is removed ) @xmath80 where @xmath81 are the subsystem transition orbital overlap matrices and @xmath82 is the full transition orbital overlap matrix of the combined @xmath78 and @xmath79 subsystems and @xmath83 is the same as in eq .",
    "( [ newtransub ] ) .",
    "the diagonal elements of the hamiltonian over the broken - symmetry states in the dtd calculations become @xmath84 \\\\ & = \\sum_i e\\left [ \\rho_i^{(i)}(\\br ) \\right ] + t_s^{\\mathrm{nadd } } \\left [ \\rho_i^{(i ) } , \\rho_{ii}^{(i ) } , \\ldots \\right ] + e_{\\mathrm xc}^{\\mathrm{nadd } } \\left [ \\rho_i^{(i ) } , \\rho_{ii}^{(i ) } , \\ldots \\right].\\end{aligned}\\ ] ] for the above expressions , we use the fde total energy partitioning in subsystem energies and non - additive functionals  @xcite .",
    "similarly , the off - diagonal elements become @xmath85 s_{12 } \\\\ & = s_{12 } \\left ( \\sum_i e\\left [ \\rho_i^{(12)}(\\br ) \\right ] + t_s^{\\mathrm{nadd } } \\left [ \\rho_i^{(12 ) } , \\rho_{ii}^{(12 ) } , \\ldots \\right ] + e_{\\mathrm xc}^{\\mathrm{nadd } } \\left [ \\rho_i^{(12 ) } , \\rho_{ii}^{(12 ) } , \\ldots \\right ] \\right),\\end{aligned}\\ ] ] where the sums run over the number of disjoint subsystems in the calculation and the non - additive functionals have the same meaning as in the regular fde formalism  @xcite .",
    "note that for charge - transfer transitions , the above sum over the disjoint subsystems is carried out in a similar way to the one in eq .",
    "( [ newtransu2 ] ) , i.e.  the subsystems undergoing variation of the number of electrons [ @xmath78 and @xmath79 in eq .",
    "( [ newtransu2b ] ) ] are grouped together in one supersystem that maintains an overall constant number of electrons during the transfer of charge .",
    "let us remark that the computational cost needed to calculate the matrix elements in the dtd formalism is linear - scaling with the number of subsystems , while the jtd formalism is not ",
    "it scales as @xmath86 with @xmath54 being the number of electrons in the supersystem even though with a much smaller scaling coefficient than regular ks calculations ( as in the jtd formalism the ks equations do not need to be self - consistently solved for the supermolecular system .",
    "instead the transition orbital overlap matrix is inverted only once ) .",
    "after implementation of the above described jtd and dtd algorithms in , in what follows , we aim at providing a thorough benchmark of the method .",
    "we compare our calculated migration ct excitation energies against two dimer systems : a water dimer radical cation , ( h@xmath87o)@xmath88 , and an ethylene dimer radical cation , ( c@xmath87h@xmath89)@xmath88 , at varying inter - monomer separations for which we carried out several different high - level wave function method calculations of the excitation energies .",
    "we also calculate hole transfer excitation energies for several dna nucleobase dimers , and compare them to caspt2 calculations . the idea behind this benchmark is to seek a validation of the ability of our fde method ( note jtd and dtd are equivalent for only two subsystems ) to reproduce quantitatively ( with at least chemical accuracy , 1 kcal / mol or 0.04 ev deviation ) the ct excitation energies calculated with the wave function methods considered .",
    "unless otherwise noted , all dft calculations have been carried out with the pw91 density functional and a tzp ( triple - zeta with polarization ) basis set with , all eom - ccsd(t ) calculations have been carried out with the nwchem 5.2 software @xcite , and all fock  space ccsd calculations have been carried out with the dirac 11 software @xcite .",
    "the nuclear positions of a neutral water dimer were first optimized with a dft method employing the bp86 functional and a tzp basis set ( triple zeta with polarization ) .",
    "figure s1 @xcite depicts the obtained structure .",
    "the subsequent calculations were carried out on the same system by translating one water molecule away from the other along the hydrogen - bond axis .",
    "the results are summarized in figure [ plot_wd ] .",
    "we calculated the excitation energy in two ways . in the first one ( fde / fde label in the figure ) the diabatic energies [ or the diagonal elements of the diabatic hamiltonian in eq .",
    "( [ hdia ] ) ] were computed using eq .",
    "( [ uncdiag ] ) with the fde density calculated as in eq .",
    "( [ eq : int:1 ] ) . in the second calculation ( fde / et )",
    "the diabatic energies were calculated by integrating the energy functional as in eq .",
    "( [ newener ] ) with the density computed from the fde subsystem orbitals as in eq .",
    "( [ supradens ] ) .",
    "we compare our values with excitation energies from four coupled cluster calculations .",
    "three of these calculations were carried out with the eom - cc method ( with different basis sets and reference determinant ) . in the fourth calculation",
    "the excitation energy is obtained by subtracting from each other the ionization potentials obtained with fock - space coupled - cluster  @xcite [ fs - ccsd ] calculated from two different guesses of the initial ionized state : one being the homo , almost entirely localized onto one monomer , and the other one the homo-1 , almost entirely localized onto the other monomer .",
    "the comparison of the cc methods with our values is very good for the fs - ccsd values while the eom - ccsd(t ) values are consistently larger in magnitude .",
    "this behavior of eom - cc methods has been noted before for mct excitations  @xcite and , as mentioned in the introdution , it is due to the fact that the eom - cc excited - state ansatz can not be written in the regular exponential form , thus making eom - cc non - size extensive  @xcite .",
    "one can rationalize this with an argument based on orbital relaxation . in the excited state",
    ", the charge has migrated to another location and the orbital of the donor must relax back to the neutral state .",
    "similarly , the orbitals of the acceptor must relax to the charged state . in both cases",
    "single excitations are the main contribution , however they must be computed on top of the single excitation needed to describe the ct itself",
    ". therefore one needs at least double excitations to describe these relaxation effects  @xcite .",
    "adding perturbatively the triple excitations usually further improves this situation allowing the eom - ccsd(t ) to reach typical deviations of 0.10.3 ev on excitation energies  @xcite .",
    "we therefore consider the eom - ccsd(t ) energy overestimation a good sign that our method yields accurate excitation energies .",
    "convincing evidence is provided by the fs - ccsd energies , as they compare with our values to within chemical accuracy at every inter - monomer separation .",
    "an issue of orthogonality arises , as the ionization potentials calculated by the fs - ccsd method are deduced from cationic wave function which are not strictly orthogonal to each other .",
    "this however , plays a very minor role here , as the overlap and the electronic coupling between the two diabatic states is almost zero as proved by our calculations of @xmath21 in table s1 and s2 in the supplementary materials @xcite .    for sake of completeness , in the supplementary materials",
    "@xcite we report the numerical values used to obtain the plot in figure [ plot_wd ] as well as additional fde calculations carried out with the blyp functional showing a similar behavior to the pw91 calculations .",
    "the nuclear positions of a neutral ethylene molecule were first optimized with a dft method employing the bp86 functional and a tzp basis set ( triple zeta with polarization ) .",
    "then a copy of the same molecule is pasted so as to obtain a @xmath90-stacked ethylene dimer with intermolecular separation of @xmath91 .",
    "figure s2 @xcite depicts the obtained structure .",
    "the calculated excitation energies are plotted in figure [ plot_ethd ] .",
    "due to the symmetric arrangment of the ethylene dimer , this system behaves in a very different way from the water dimer considered above . here",
    ", the orbital relaxation issues faced before are less important as the hole is completely delocalized between the two monomers  the inner orbitals are not dramatically affected by the excitation .",
    "the hole sits in orbitals with different symmetry in the ground and in the ct excited state .",
    "the ground state has a symmetric homo having @xmath92 symmetry , while the first excited state has the homo of @xmath93 symmetry .",
    "because of these reasons , we expect the eom - cc calculations to be of much higher accuracy than for the water dimer case . and",
    "in fact this is what we notice .",
    "our calculations are in very good agreement with both the eom - ccsd(t ) and the fs - ccsd calculations .",
    "our values slightly underestimate the cc calculation at shorter separations , even if only of 0.1 ev . at larger separations",
    "( r@xmath94 ) , due to the lowering magnitude of the excitation energy , and to a much reduced extent compared to the water dimer case , the overestimation of the excitation energy by eom - ccsd(t ) becomes noticeable again .",
    "instead , fs - ccsd and our calculations are still in very good agreement .",
    "the eom - cc calculations carried out with the 6 - 311g(d , p ) basis set show a slight off - trend behavior .",
    "we attribute this to the absence of augmented functions in the basis set .    once again , for sake of completeness , in the supplementary materials  @xcite we report the numerical values used to obtain the plot in figure [ plot_ethd ] as well as additional fde calculations carried out with the blyp functional showing a similar behavior to the pw91 calculations .      in a recent paper @xcite we have applied fde to constrain charges on dna nucleobases and subsequently we calculated electronic couplings and ct excitation energies . in the previous work we employed the formalism of migliore _",
    "@xcite for the calculation of the coupling which retained all the deficiencies of the approximate density functionals , particularly self interation .",
    "the self interaction error caused a gross overestimation of the coupling and excitation energies which was ameliorated by mixing in non - local hartree - fock exchange in the functional .",
    "here we recalculated the same systems , i.e.  guanine dimer , , and the guanine - thymine complex , .",
    "in addition , here we report calculations on the adenine dimer , , thymine dimer , , thymine - guanine , , adenine - guanine , , and the guanine - adenine , .",
    "the results are summarized in table [ tab_dna ] .",
    ".hole transfer excitations and couplings in @xmath90stacked dna nucleobase radical cation complexes .",
    "all energy values in ev .",
    "the  stands for `` not available '' . [ cols=\"^,^,^,^,^,^,^\",options=\"header \" , ]",
    "in this work , we have developed a new and linear - scaling dft method aimed at accurately predicting charge - transfer excitation energies and diabatic couplings among charge - localized states , and validated it against high - level wave function calculations .",
    "the success of the disjoint transition density method ( or dtd , see section [ sect_cu ] ) resides in two important properties .",
    "first , it computationally scales linearly with the number of non - covalently bound molecules in the system .",
    "secondly , the hole transfer excitation energies calculated with mainstream gga - type functionals reproduce within chemical accuracy calculations carried out with several types of coupled cluster methods . for the benchmark cases considered",
    ", our method outperforms the biased eom - ccsd(t ) , while it is in excellent agreement with vertical ionization potential differences calculated with fock - space ccsd(t ) calculations .",
    "we also carried out calculations of the hole transfer excitations in seven dna base pair combinations reproducing caspt2(11,12 ) calculations within a 0.1 ev deviation or better .",
    "pilot calculations on molecular clusters of water and ethylene have also been carried out with cluster sizes up to 56 molecules .",
    "we show how the method is able to recover solvation effects on diabatic couplings and site energies ( needed in electron transfer calculations ) as well as the excitation energies at the discrete molecular level and fully quantum - mechanically .",
    "this constitutes an important step forward in the development of linear scaling electronic structure methods tailored to electron transfer phenomena .",
    "future improvements of the method are underway and will include the implementation of hybrid functionals in the post - scf calculation of the full - electron hamiltonian matrix elements and the extension of the method to both excitations involving charge separation and covalently bound subsystems .",
    "we are indebted to daniel spngberg for providing us with the water cluster structures .",
    "we also acknowledge benjamin kaduk for helpful tips for coding of the transition density , and alexander voityuk for helpful discussions .",
    "m.p .  acknowledges partial support by the start - up funds provided by the department of chemistry and the office of the dean of fasn , rutgers - newark .",
    "is supported by a vidi grant ( 700.59.422 ) of the netherlands organization for scientific research ( nwo ) .",
    "dirac , a relativistic ab initio electronic structure program , release dirac11 ( 2011 ) , written by r. bast , h. j. aa .",
    "jensen , t. saue , and l. visscher , with contributions from v. bakken , k. g. dyall , s. dubillard , u. ekstrm , e. eliav , t. enevoldsen , t. fleig , o. fossgaard , a. s. p. gomes , t. helgaker , j. k. lrdahl , j. henriksson , m. ilia , ch .",
    "r. jacob , s. knecht , c. v. larsen , h. s. nataraj , p. norman , g. olejniczak , j. olsen , j. k. pedersen , m. pernpointner , k. ruud , p. saek , b. schimmelpfennig , j. sikkema , a. j. thorvaldsen , j. thyssen , j. van stralen , s. villaume , o. visser , t. winther , and s. yamamoto ( see http://dirac.chem.vu.nl ) ."
  ],
  "abstract_text": [
    "<S> quantum  mechanical methods that are both computationally fast and accurate are not yet available for electronic excitations having charge transfer character . in this work , we present a significant step forward towards this goal for those charge transfer excitations that take place between non - covalently bound molecules . in particular </S>",
    "<S> , we present a method that scales linearly with the number of non - covalently bound molecules in the system and is based on a two - pronged approach : the molecular electronic structure of broken - symmetry charge - localized states is obtained with the frozen density embedding formulation of subsystem density - functional theory ; subsequently , in a post - scf calculation , the full - electron hamiltonian and overlap matrix elements among the charge - localized states are evaluated with an algorithm which takes full advantage of the subsystem dft density partitioning technique . </S>",
    "<S> the method is benchmarked against coupled - cluster calculations and achieves chemical accuracy for the systems considered for intermolecular separations ranging from hydrogen - bond distances to tens of ngstroms . </S>",
    "<S> numerical examples are provided for molecular clusters comprised of up to 56 non - covalently bound molecules .    * </S>",
    "<S> an accurate and linear - scaling method for calculating charge - transfer excitation energies and diabatic couplings *   + michele pavanello + department of chemistry , rutgers university , newark , nj 07102 - 1811 , usa + troy van voorhis + department of chemistry , massachusetts institute of technology , + cambridge , ma 02139 - 4307 , usa + lucas visscher + amsterdam center for multiscale modeling , vu university , + de boelelaan 1083 , 1081 hv amsterdam , the netherlands + and + johannes neugebauer + theoretische organische chemie , organisch - chemisches institut der westflischen wilhelms - universitt mnster + corrensstrae 40 , 48149 mnster , germany +    date : = + status : accepted for publication + </S>"
  ]
}