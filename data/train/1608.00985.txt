{
  "article_text": [
    "tumours are highly heterogeneous ecosystems  @xcite , with various cancerous and non - cancerous sub - populations of cells competing for access to space , growth - factors , nutrients , oxygen , and other limited resources . this existence and persistence of heterogeneity has implications for diagnosis , treatment , and disease progression.@xcite yet , if tumour evolutionary dynamics proceed via clonal selection  @xcite then how can more than one clone stably coexist",
    "? current explanations of intra - tumour heterogeneity include evolutionary neutrality  @xcite , niche specialization  @xcite , non - equilibrium dynamics  @xcite , and frequency dependent selection  @xcite .",
    "it remains an open problem to identify which , or even how many , of these mechanisms are at work in any given neoplasm  @xcite .",
    "the progression of neoplasms to metastatic disease is marked by the acquisition of a number of hallmarks  @xcite , including self - sufficiency of growth factor production for angiogenesis and reprogramming energy - metabolism for aerobic glycolysis . as with many of the other hallmarks",
    ", there is evidence of intra - tumour heterogeneity in both the production of cytokines like vascular endothelial growth factor ( vegf )  @xcite , and glycolysis  @xcite .",
    "given that it is possible for an individual cancer cell to not invest ( as heavily ) in angiogenesis or not forgo the benefit of oxygen by avoiding aerobic glycolysis then how do these population level traits evolve , and how are they maintained ?",
    "we answer this question with a mathematical model that treats acid production through glycolosysis as a tumour - wide public good that is coupled to the club good of oxygen from better vascularisation .    by investing in better vascularisation  by over - producing vegf , for example",
    " the whole tumour can benefit from an increase ( or improvement ) in vascularisation and the associated rise in availability of nutrients and oxygen  @xcite .",
    "an individual cancer cell , however , could reap these benefits from mere proximity to ( over)-producers and save on the energetic cost of producing the relevant growth - factor : free - riding on the benefits created by other cancer cells .",
    "these free - riding cancer cells could out - compete the ( over)-producers and take over the tumour .",
    "such a switch away from growth factor ( over)-production , however , would decreases the overall fitness of the tumour by making fewer nutrients and oxygen available to all cancer cells .",
    "what is favourable to individual cancer cell is disfavourable to the society of cancer cells that make up the tumour .",
    "this represents a classic example of an evolutionary social dilemma .",
    "a similar social dilemma exists for the increase of acidification from glycolysis .",
    "it is striking that the up - regulation of glycolysis  the so called warburg effect  @xcite  occurs even in the absence of hypoxia  @xcite .",
    "glycolysis is inefficient when oxygen is not a limiting factor , raising the conundrum of what selective advantage it provides to a cell to compensate for its energetic cost .",
    "the acid mediated tumour invasion hypothesis suggests that this advantage comes from the acidification of the tumour microenvironment that leads to an increase in normal cell death and higher invasiveness through increased matrix degradation  @xcite . in order to benefit from this microenvironmental acidification ,",
    "the cancer cells need to be resistant to microenvironmental acidity .",
    "early models have assumed that this resistance is available only to glycolytic cells ,  @xcite but there is little evidence to suggest that aerobic cancer cells could not also develop this resistance . in the absence of hypoxia",
    ", such resistant non - glycolytic cells could benefit from aerobic respiration to out - compete the glycolytic cancer cells .",
    "but such a switch away from glycolysis decreases the overall acid production by the tumour , negating part of the advantage acid - resistant cells have against non - cancerous soma .    evolutionary game theory ( egt )",
    "is a tool available to theoretical biologists to make sense of these sort of social dilemmas . originating with maynard smith & price  @xcite , egt is a mathematical approach to modeling frequency - dependent selection where sub - populations interact through phenotypic strategies .",
    "we continue the trend of the earliest applications of egt to oncology  @xcite by focusing on the persistence of heterogeneity . in recent years",
    ", egt has been used more extensively in oncology to study the conditions that select for more aggressive tumour phenotypes in gliomas  @xcite , colorectal cancer  @xcite , multiple myeloma  @xcite and prostate cancer  @xcite ; as well as the effects of treatment on the progression of cancer  @xcite .",
    "most of this prior work focuses on matrix games , with pairwise interactions between cell types .",
    "recently , archetti introduced the multiplayer public goods game to oncology for looking separately at two - strategy problems like growth - factor production  @xcite and the warburg effect  @xcite . and",
    "with colleagues , he has implemented the growth - factor production game in an experimental system  @xcite .",
    "he has stressed the importance of non - linear benefits from these goods for maintaining heterogeneity .",
    "however , angiogenesis and glycolosysis are intimately related and should not be considered in separation because the benefits of oxygen affect the degree of hypoxia and thus the relative cost / benefit of glycolysis when compared to aerobic metabolism .",
    "we focus on this inter - dependence of these two hallmarks to continue this research programme by coupling the two goods  the public good of acidification and the club good of vascularization  in a three - strategy game .",
    "our model reveals dynamics that can not be predicted from treating micro - environmental acidification and vascularization in isolation from each other .",
    "in particular , we show that heterogeneity is possible with linear goods and that this heterogeneity is not a static equilibrium but a dynamic cycle of constantly changing proportions of cancer cell types .",
    "this has consequences for the design of treatments , as it suggests that the timing , and order , of therapeutic interventions could drastically affect the outcome.for example , it shows the importance of preparatory treatment or neoadjuvant therapy that manages the low - frequency cell types in contrast to simply targeting the most common clone , and of the advantages of targeting the tumour microenvironment instead of just targeting the cancer cell .",
    "acidity provides a ( relative ) benefit to all acid - resistant tumour cells that are competing against the acid - sensitive non - cancerous cells  @xcite , regardless of whether they have aerobic or anaerobic metabolism .",
    "consider a focal glycolytic cell  a cell undergoing anaerobic metabolism , even in an aerobic environment  interacting with @xmath0 other nearby cells of which @xmath1 $ ] are also glycolytic .",
    "together they produce a relative benefit @xmath2 due to acidity to be distributed among the @xmath3 cells .",
    "therefore , this focal glycolytic cells receives a net benefit of @xmath4 .    by averaging over all possible focal glycolytic cells and interaction group compositions",
    ", we get that the expected fitness of a population of glycolytic ( _ gly _ ) cells with random assortment is :    @xmath5    where @xmath6 is the proportion of _ gly _ in the population , and the angle brackets represent averaging with , in this case , @xmath7 sampled from the binomial distribution with @xmath0 trials and @xmath6 as the probability of success ( i.e. choosing a _ gly _ cell ) .    for an aerobic cell",
    " non-_gly _  in a similar case , the benefit due to acid is only @xmath8 since it does not itself produce acid .",
    "but , in addition to the effects of acid , an aerobic cell can also benefit from oxygen delivered by the vasculature .",
    "in particular , a vegf ( over)-producer ( _ vop _ ) will receive the benefit @xmath9 but pay a cost @xmath10 for the higher production , and the aerobic non-(over)-producer of vegf ( _ def _ ) will receive the benefit @xmath11 but pay no cost , essentially free - riding . note that , unlike acidity , the benefit of oxygen from vasculature is divided among only the non - glycolytic cells in the interacting group , thus we are treating it as a club good  @xcite . alternatively , this makes the glycolytic cells similar to loners in the optional public - goods game  @xcite .",
    "therefore , the expected fitnesses of the two aerobic populations with random assortment are :    @xmath12    where @xmath13 are the proportions of _ vop_and _ def_in the population , and the averages in the second summands are taken with @xmath14 sampled from the multinomial distribution with @xmath0 trials and @xmath6 as the probability of the first outcome ( i.e. choosing a _ gly _ cell ) , and @xmath15 as the probability of the second outcome ( i.e. choosing a _ vop _ cell ) . in each equation ,",
    "the first summand is the benefit due to acidification and the second is the benefit from the club good of vascularization .",
    "these fitness functions are described in more detail in appendix  [ app : genmodel ] .",
    "the evolutionary dynamics of the population are given by the replicator equation  @xcite :    @xmath16    where @xmath17 is the average fitness of the population .",
    "alternatively , we can write down these dynamics in their factored form ( see appendix  [ app : factor ] for a proof of equivalence ) as :    @xmath18    where @xmath19 is the proportion of _ gly _ , @xmath20 is the proportion of aerobic cells that over - produce vefg , and @xmath21 is the average fitness of the aerobic cells .",
    "these equations are accurate for large populations at carrying capacity  _ in vivo _",
    "tumours up against a resource limitation or managed by an immune response  or in their exponential growth phase ",
    "typical of _ in vitro _ experiments . in other cases",
    "they serve as an approximation .",
    "see appendix  [ app : repdyn ] for more discussion on interpreting replicator dynamics .",
    "+   possible dynamic regimes for the double goods game .",
    "the possible parameter settings for @xmath22 are varied horizontally , starting at @xmath10 .",
    "the possible parameter settings for @xmath23 are varied vertically , starting at @xmath24 .",
    "each of the three inset simplexes have the same coordinates , with the top vertex corresponding to all _ gly _ , left to all _ vop _ , and right to all _ def_. each simplex is a typical example of dynamics within its regime . the specific micro - environmental parameters for each example : ( 1 ) @xmath25 , @xmath26 , @xmath27 , @xmath28 for green , ( 2 ) @xmath29 , @xmath30 , @xmath27 , @xmath31 for red , and ( 3 ) @xmath29 , @xmath26 , @xmath27 , @xmath31 for yellow.,title=\"fig : \" ]     +    [ fig : dynreg ]    we can apply the model described in the previous section to study the temporal evolution of different populations in various scenarios .",
    "these scenarios are set by the four micro - environmental parameters of our model : @xmath32 , the benefit per unit of acidification ; @xmath22 , the benefit from oxygen per unit of vascularization ; @xmath10 , the cost of ( over)producing vegf ; and , @xmath0 , the number of interaction partners in the public good . within a scenario ,",
    "the last piece of information is the initial proportions of cells @xmath33 ( or @xmath34 in the factored form ) .",
    "the values of these variables will depend on the particular cancer ecosystem ( i.e. patient and kind of tumour ) . since these variables can be difficult or impossible to measure clinically , it is important to understand what broad qualitative relationships between them mean for long - term dynamics .    although the fitness functions in equations  [ eq : wg ] ,  [ eq : wv ] , and  [ eq : wd ] are bernstein polynomials of degree @xmath0 , we can use properties of binomial coefficients to simplify the corresponding gain functions of the factored replicator dynamics without any approximation ( see appendix  [ app : gain ] ) .",
    "this allows us to rewrite equations  [ eq : pgen ]  and  [ eq : qgen ] as :    @xmath35 - c}_{\\text{gain function for } q } ) \\label{eq : qsimp}\\end{aligned}\\ ] ]    notice that when @xmath36 , equation  [ eq : psimp ] recovers the social dilemma of angiogenesis that we discussed in the introduction with the free - riding _ def _ cells taking over the population of aerobic cells , driving @xmath37 towards @xmath24 .",
    "when @xmath38 and @xmath39 , we have a hypoxic tumour , and glycolytic cells are favored , driving @xmath40 towards @xmath41 . on the other hand , if @xmath38 and @xmath42 , then we recover the social dilemma of aerobic glycolysis , with _ vop",
    "_ cells favoured if @xmath43 , and _ gly _ cells otherwise .",
    "in other words , if one of the strategies is absent in the population then no persistence of heterogeneity is possible among the remaining two strategies .",
    "this is consistent with predictions from two - strategy linear public goods games .",
    "the more interesting case that is unique to our model is when all three strategies are initially expressed in the population . in this setting",
    ", we can analytically characterize the population dynamics into one of three qualitatively different regimes based on the values of the four main micro - environmental parameters by solving how the above functions for @xmath40 and @xmath37 cross zero ( for more information , see appendix  [ app : gain ] ) .",
    "this classification is shown visually in figure  [ fig : dynreg ] .",
    "we name these three regimes by their end points ( and evolutionary stable strategies ) ; fully glycolytic ( green region in figure  [ fig : dynreg ] ) , fully angiogenic ( red ) , and heterogeneous ( yellow ) .",
    "the following three subsections describe each of these three regimes in turn .",
    "we solve for the average fitness of aerobic cells as :    @xmath45    where the first summand is the benefit from acidification , and the second summand is the benefit due to oxygen from vascularization . since _",
    "def _ only consume the club good from vascularization , without producing any , equation  [ eq : wvd ] is maximized to @xmath46 when all aerobic cells are producers of the club good ( i.e. all _ vop _ , q = 1 ) .",
    "similarily , we can solve for the fitness of _ gly _ :",
    "@xmath47    where the first summand is the benefit from aciditification that all cancer cells receive , and the second summand is the slight increase in acidification that glycolytic cells get from always being in a group with an extra acid producer ( themselves ) .    from this , we see that if the fitness benefit of a single unit of acidification ( @xmath48 ) is higher than the maximum benefit from the club good for aerobic cells ( @xmath49 ) then the difference between eq .",
    "[ eq : wgsimp ] and eq .",
    "[ eq : wvd ] is always positive .",
    "gly _ will always have a strictly higher fitness than aerobic cells , and be selected for . in this scenario , the population will converge towards all _ gly _ , regardless of the initial proportions ( as long as there is at least some _ gly_in the population ) .",
    "this dynamic regime is achieved for any micro - environmental parameter settings corresponding to the green region in figure  [ fig : dynreg ] .",
    "typical dynamics are shown in the inset simplex with micro - environmental parameters @xmath50 .",
    "consider an interaction group with @xmath52 _ vop _ and @xmath53 _ def_cells .",
    "if the focal agent interacting with this group is an ( over)producer then it will receive a benefit from oxygen of @xmath54 .",
    "if the focal agent is a defector then they will receive @xmath55 .",
    "since , by definition , @xmath56 is less than the interaction group size @xmath0 then regardless of the number of glycolytic cells :    @xmath57    thus , if the benefit to ( over)producers from their extra unit of vascularization ( @xmath58 ) is higher than the cost @xmath10 to produce that unit ( or , equivalently , if @xmath59 ) then _ vop _ will always have a strictly higher fitness than _ def _ , selecting @xmath37 towards @xmath41 .",
    "in addition , if the maximum possible benefit of the club good to aerobic cells ( @xmath49 ) is higher than the benefit of an extra unit of acidification ( @xmath23 ) then ( based on the difference of eq .",
    "[ eq : wgsimp ] and  [ eq : wvd ] , or the negation of the conditions in the previous section ) for sufficiently high number of ( over)producers ( @xmath37 close enough to @xmath41 ) , _ gly _ will have lower fitness than aerobic cells .",
    "when both conditions are satisfied , the population will converge towards all _",
    "vop_. this dynamic regime is achieved for any micro - environmental parameter settings corresponding to the red region in figure  [ fig : dynreg ] .",
    "typical example dynamics are shown in the inset simplex with micro - environmental parameters @xmath60 .",
    "notice how if a population starts with mostly aerobic cells ( @xmath40 close to @xmath24 ) that are not overproducing vegf ( @xmath37 close to @xmath24 ) then on the way towards all-_vop _ , the population might see a transient decrease in the number of aerobic cells .      from eq .",
    "[ eq : vdlow ] , we know that if the benefit from an extra unit of vascularization in a fully aerobic group ( @xmath58 ) is lower than the cost @xmath10 to produce that unit then for a sufficiently low proportion of _ gly _ and thus sufficiently large number of aerobic cells sharing the club good , _ def_will have higher fitness than _",
    "vop_. this will lead to a decrease in the proportion @xmath37 of ( over)producers among aerobic cells and thus a decrease in the average fitness of aerobic cells @xmath62 ( see eq .  [ eq : wvd ] ) .",
    "a lower fitness in aerobic cells will lead to an increase in the proportion of _ gly _ until the aerobic groups among which the club good is split get sufficiently small and fitness starts to favour _ vop_over _ def _ , swinging the dynamics back .",
    "thus , resulting in a rock - paper - scissor like dynamics .    under this scenario ,",
    "the population will orbit around an internal fixed - point at @xmath63 and @xmath64 .",
    "the exact position of @xmath65 is the solution to the polynomial equation @xmath66 ( see appendix  [ app : gain ] for details ) .",
    "the amplitude of the orbit will depend on the distance between @xmath34 and @xmath67 .",
    "this dynamic regime is achieved for any micro - environmental parameter settings corresponding to the yellow region in figure  [ fig : dynreg ] .",
    "typical example dynamics are shown in the inset simplex with micro - environmental parameters @xmath68 .",
    "with the possible dynamic regimes in mind , we can think about treatment in one of two ways : ( 1 ) treatments that target the player by directly reducing the proportion of a given strategy in the population , or ( 2 ) treatments that target the game by changing the parameters ( @xmath32 , @xmath22 , @xmath10 or @xmath0 ) and taking us from one dynamic regime to another . in both cases we need to be mindful of counter - intuitive phenomena like timing and order effects and the importance of managing heterogeneity .      ) in green , _ vop _ ( @xmath15 ) in solid red , and _ def _ ( @xmath69 ) in blue .",
    "the dashed red lines show the proportion of _ vop _ among aerobic cells ( @xmath20 ) .",
    "all three graphs start with same initial conditions ( @xmath70 , @xmath71 ) and the same tumour micro - environment ( @xmath68 ) . in the second and third panel",
    ", we consider an anti - glycolytic treatment of the same strength ( subtracting @xmath72 from the fitness of _ gly _ ) and the same duration ( @xmath72 time steps ) .",
    "the difference between the second and third panel is in timing , marked in gray : the second panel starts treatment at @xmath73 , and the third at @xmath74 .",
    "if the proportion of a cell - type goes below @xmath75 then it dies off entirely . at @xmath76 ,",
    "no cell - types are extinct in the top panel ; in the second and third panel , the only non - extinct cell - types are _ gly _ and _ def _ , respectively .",
    "this highlights the importance of the timing of therapy for evolutionary outcome . ]",
    "a treatment that targets a given strategy and can be applied long enough to drive that strategy to extinction can be considered a viable intervention . if we were in the first dynamic regime ( green in fig .",
    "[ fig : dynreg ] ; @xmath44 ) or the second dynamic regime ( red in fig .",
    "[ fig : dynreg ] ; @xmath51 ) then the population will always converge towards all-_gly _ or all-_vop _ , respectively . this means that unless the strategy - targeting therapy is strong and long enough to drive that strategy to extinction , it will not affect the overall outcome beyond a potential transient delay . in particular , the timing of the therapy will not have a qualitatively significant effect . in the heterogeneous case ( yellow in fig .",
    "[ fig : dynreg ] ; @xmath61 ) , however , counter - intuitive results are possible and the timing of treatment becomes important .    as an example in figure  [ fig : time ] , we consider a tumour described by the micro - environmental parameters @xmath77 and @xmath31 and an initial composition @xmath78 .",
    "if left untreated then the proportions of strategies would cycle around an internal fixed point at @xmath79 , as seen in the top panel . in that panel , the proportion of glycolytic cells @xmath6 will oscillate between about @xmath80 and @xmath81 with a period of about @xmath82 time units .    in the standard paradigm of personalized medicine",
    ", the most likely target would be the cell subtype composing the largest proportion of the tumour . in this case",
    ", it would be the glycolytic cells ",
    "the most common , and least fit , strategy at @xmath83 .",
    "we can imagine targeting these cells specifically , with a therapy that imposes a large fitness cost , like lonidamine  @xcite , for example . here , we choose to set the fitness cost of this therapy to @xmath72 , which leads to very quick and aggressive reduction in the _ gly _ population . in a perfect world",
    ", the therapy would be applied long enough to drive _ gly _ to extinction .",
    "but what happens if it is only applied for @xmath72 time units , enough to drastically reduce the proportion of _ gly _ cells  below detecatble levels  but not below the extinct threshold ? the cyclic dynamics then allow the glycolytic cells to recover by out - competing the mostly _ def _ population .",
    "to make matters worse , as _ gly _ recovers , _ vop _ is pushed below the extinction threshold leaving just the other two - cells types to compete . without vegf over - production ,",
    "the remaining aerobic cells are less fit than the glycolytic cells and are also driven to extinction .",
    "the overall result at @xmath76 is a relapse with even more glycolytic cells than before treatment . in this scenario , while the goal was to eliminate glycolytic cells , the opposite occurred : elimination of all the aerobic cells and creation of a completely glycolytic tumour .",
    "if instead the treatment was delayed until @xmath74  when the",
    "_ gly_cells are at their lowest proportions , and highest fitness , in the tumour s natural cycle  then much more favourable results could be achieved . with the lower initial proportion of _ gly _ cells , @xmath72 units of time",
    "is long enough to drive the cells to extinction . without glycolytic cells , the competition between _ def _ and",
    "_ vop _ becomes a classic social dilemma and the vegf - overproducers are driven to extinction .",
    "the result is now what was desired : an aerobic tumour with no  or significantly diminished ",
    "ability to recruit blood vessels .    in this case , we can think of the natural tumour dynamics as a neoadjuvant ` treatment ' that lowered the _ gly _ population slightly while preparing the _ vop_-_def_composition to be in a favourable position after therapy .      ) in green ,",
    "( @xmath15 ) in red , and _ def _ ( @xmath69 ) in blue .",
    "the dashed red lines show the proportion of _ vop _ among aerobic cells ( @xmath20 ) .",
    "each graph on the right is @xmath84 versus @xmath22 and shows how treatment moves the tumour between qualitatively different dynamic regimes through the space on micro - environmental parameters ( for detailed explanation see figure  [ fig : dynreg ] ) .",
    "all graphs start with same initial proportions ( @xmath85 ) .",
    "the untreated tumour has parameters @xmath25 , @xmath26 , @xmath27 and @xmath31 . in the top two panels ,",
    "two treatments are applied : the first at time @xmath24 and the second at time @xmath41 . in the last panel ,",
    "a single treatment is applied at time @xmath24 .",
    "we consider two game - targeting treatments : ( 1 ) a buffer therapy that reduces the benefit of acidity ( setting @xmath29 from then on ; horizontal arrows in the right panel ) , and ( 2 ) a vascular renormalization therapy ( vnt ; setting @xmath30 from then on ; vertical arrows in the right panel ) . in the top panel , buffer therapy is followed by vnt , the second panel shows vnt followed by buffer therapy , and in the final panel both treatments are given simultaneously ( diagonal arrow in the right panel ) . ]    consider the hypothetical case - study in figure  [ fig : order ] . here",
    ", we have a situation with poor vasculature ( @xmath26 , @xmath27 , @xmath31 ) and a highly glycolytic tumour ( @xmath86 , @xmath25 ) .",
    "if left untreated , the tumour would quickly reach all-_gly _ , driving the other two strategies extinct .",
    "thus , the goal is to eliminate _",
    "gly _ , and create an easier - to - target all _ vop _ tumour without incurring too much tumour heterogeneity .",
    "we consider two possible interventions .",
    "the treatments can be applied sequentially with a brief recovery window of @xmath41 time - step between them or simultaneously .",
    "one treatment is a buffer therapy  @xcite that reduces the benefit of acidity ; setting @xmath29 from then on .",
    "another is vascular normalization therapy ( vnt)@xcite ; setting @xmath30 from then on . in figure",
    "[ fig : order ] , the top panel considers giving buffer therapy followed by vnt , the middle panel has the vnt preceding the buffer therapy , and the bottom panel has both treatments at given simultaneously at @xmath83 .",
    "the buffer then vnt ( top panel ) ordering produces immediate results , with the proportion of _ gly _ no longer increasing  and even starting to decline  right away and reaching minimal levels earlier than vnt followed by buffer therapy ( middle panel ) .",
    "however , the top ordering increases the heterogeneity among the anaerobic cells , and although the tumour will eventually move to a state of all _ vop _ ,",
    "by time - step @xmath72 ( when it is nearly all _ vop_for the middle panel ) there is a high level of _",
    "vop_-_def_heterogeneity , and earlier during treatment ( say @xmath87 ) the top panel has heterogeneity in all three cell types . something that the physician wanted to avoid .",
    "in contrast , the middle ordering sees no immediate results from the vnt . instead , this first treatment can be thought of as a neoadjuvant therapy that eliminates the _ vop_-_def _ heterogeneity among the rare aerobic cells before targeting the predominantly _ gly _ population . by time - step @xmath72 ,",
    "the middle ordering sees a similarly high level of response in the _ gly _ phenotype , but without creating a high level of heterogeneity in the tumour .    we might expect that both normalizing the benefit due to oxygen from vascularization and decreasing the benefit from acidification at the same time would offer superior results to sequential therapy . however , as we can see from the bottom panel of figure  [ fig : order ] , this is not necessarily the case .",
    "although the same reduction in glycolytic cells is reached @xmath41 time unit faster than the sequential therapies , the heterogeneity among aerobic cells remains high ; like buffer therapy followed by vnt .    staggering buffer therapy after vnt might not produce immediately evident results but it lets us reach those results without encountering a highly heterogeneous tumour .",
    "when targeting the micro - environment , it matters which qualitatively different dynamic regimes the game goes through , even if the final micro - environmental parameters are the same .",
    "both acidity and vascularization are goods that are costly to produce . but these goods are not exclusive to the producing cell and thus can benefit non - producers .",
    "this poses an evolutionary social dilemma .",
    "non - producing cancer cells can free - ride off the producers by benefiting from these goods ( for example , due to proximity to producers ) while not paying the energetic costs of production . due to their higher relative fitness",
    ", such free - riders could then out - compete the producers , driving them to extinction ( at a potential cost in absolute fitness to the tumour  the society of cancer cells ) .",
    "this raises the social dilemma of cooperation : if non - producers can free - ride then why do we see persistent heterogeneity in both aerobic metabolism  @xcite and growth factor production  @xcite ?    prior work has considered in isolation the production of growth factors like vegf  @xcite and of acidity from glycolysis  @xcite .",
    "they concluded that a heterogeneous equilibrium of producers and non - producers can not exist unless the benefits that these goods provide are non - linear in the number of producers . in the linear cases , considered separately",
    ", this would predict that vegf ( over)-producers ( _ vop _ ) and glycolytic ( _ gly _ ) cells would both go extinct , leaving a population of aerobic cells that do not call for more vasculature ( _ def _ ) .",
    "this is in accord with the intuition that free - riders always win in social dilemmas , and would result in the elimination of heterogeneity of production of vegf and acidity .    instead of the separate analyses above",
    ", we recognized the natural coupling between the vasculature called by growth factor production and the acidity from glycolytic metabolism .",
    "in particular , although the acidity from glycolysis is a good which is public to all tumour cells , the benefit from oxygen due to vasculature can not be enjoyed by the glycolytic cells ( _ gly _ ) .",
    "vascularization is a club good available only to the cells that continue to rely on aerobic metabolism ( _ vop_and _ def _ ) . in other words , a producer of the acidity good",
    "can not be a beneficiary of the vasculature good .",
    "we call such goods anti - correlated .",
    "we show that the reductionist intuition leading to all-_def_does not hold in this system of two anti - correlated linear goods . instead , we identify three qualitatively different dynamic regimes that end in a tumour that is either : ( 1 ) fully glycolytic ( all-_gly _ ) , ( 2 ) fully angiogenic ( all-_vop _ ) , or ( 3 ) heterogeneous ( polyclonal ) in all three cell types . which of these regimes is achieved depends on the micro - environmental parameters like the benefit per producer due to acidity ( @xmath32 ) , due to vasculature ( @xmath22 ) , and the cost of ( over)producing vegf ( @xmath10 ) .",
    "further , the heterogeneity is not static but maintained by a cycle in proportions of cellular strategies .",
    "thus , we show that polyclonal tumours made up of three different cellular strategies are evolutionary stable even with linear goods .",
    "this stands in stark contrast to the all-_def_equilibrium that we would expect from considering the linear goods in isolation .",
    "our results highlight the difficultly of ruling out possible dynamics from overly reductionist accounts of cancer , and the importance of modeling both the vascularization and acidity when studying the warburg effect  @xcite .",
    "the dynamic nature of the polyclonal equilibrium reminds us of the importance of tracking the tumour composition through time , not basing treatment on measurements from a single time - point , and optimizing the timing of treatment . as an example",
    ", we consider an anti - glycolysis treatment like _ lonidamine _",
    "@xcite . if timed correctly and applied for long enough , then this treatment can drive the glycolytic cells extinct and reduce the tumour to the two - strategy case of vegf - production considered in prior work  @xcite .",
    "from there , somatic evolution will drive vegf over - producers extinct , leaving us with an all-_def_tumour ( lower panel of figure  [ fig : time ] ) .",
    "however , if the same treatment is applied at the wrong time in the cycle of heterogeneity ( or not for long enough ) then the glycolytic population can recover while the vegf over - producers are driven extinct by non - producers . without vegf over - producers , the glycolytic cells can out - compete the aerobic cells and drive them to extinction , resulting in a fully glycolytic tumour ( middle panel of figure  [ fig : time ] ) . a backfire effect for treatment .",
    "since the heterogeneous equilibrium is not the only possible outcome of these game dynamics , it is also important to measure the micro - environmental parameters like the benefit per unit of vascularization and per unit of aciditification that determine the game .",
    "this dichotomy between tumour composition and micro - environmental parameters carries over from measurement to treatment . in section  [ sec : treat_game ] , we consider treatments like buffer therapy  @xcite and vascular renormalization therapy ( vnt)@xcite to change the microenvironmental parameters and thus target the game . by shifting to a more desirable game ,",
    "we allow natural somatic evolution to lead us to a better outcome .",
    "the order in which we shift between games is important , especially for transient heterogeneity .    for highly glycolytic tumours ,",
    "it is important to consider neoadjuvant vnt prior to buffer therapy .",
    "vnt allows us to reduce the heterogeneity in aerobic cells before targeting the more common glycolytic cells .",
    "thus , when buffer therapy turns the game against glycolytic cells , the tumour is prepped in a low heterogeneity state and moves to an all-_vop _ phenotype without high levels of transient polyclonality . if buffer therapy is applied before vnt , or even if the two are applied simultaneously , then the response of glycolytic cells is quicker but also prone to creating much longer lasting heterogeneity in the tumour .",
    "we expect that similar considerations of neo - adjuvant therapy for managing the rarer cancer sub - types might prove effective in other cancer settings .",
    "there are several different types of heterogeneity that can work for or against the patient .",
    "these include strategy heterogeneity ( i.e. a polyclonal tumour ) and game heterogeneity ( i.e. differences in micro - environmental parameters ) .",
    "physicians have to be mindful of both types when treating a given patient .",
    "so far , we concentrated on difference in micro - environmental parameters due to variation between patients , tissues , and the effects of therapy",
    ". however , there can also be game heterogeneity within different regions of the same tumour .",
    "for example , we have previously shown  @xcite that the game within the bulk of the tumour can differ from the game at static boundaries .",
    "but it is through static boundaries like blood vessels , organ capsules , or basement membranes that metastatic invasion happens .",
    "if physicians want to minimize the risk of metastates then it is important to measure the microenvironmental parameters at such boundaries .",
    "future work could more explicitly model invasiveness by coupling our model to the go - vs - grow game  @xcite and also broadening the analysis to _ ex situ _ cells .    in these appendices",
    ", we develop and discuss the tools used to define and solve our model from section  [ sec : game ] .",
    "the structure is as follows :    [ app : genmodel ] our model in general terms , with more detail than was possible in section  [ sec : game ] .",
    "we outline the linear benefit functions used in this paper , and possible generalizations to non - linear benefit functions for future work .",
    "[ app : factor ] proof of a theorem for factoring any replicator dynamics and application of it to the specific case of factoring from @xmath88 ( transforming eqs .",
    "[ eq : xggen ] ,  [ eq : xvgen ]  and  [ eq : xdgen ] to eqs .",
    "[ eq : pgen ]  and  [ eq : qgen ] ) presented in this paper .",
    "[ app : repdyn ] discuss of the generality of replicator dynamics with a focus on populations of constant size ( [ app : constant ] ) , exponentially growing populations ( [ app : exponential ] ) , and _ in vitro _ systems ( [ app : experimental ] ) .    [ app : gain ] solution to the gain functions needed to transform the system in equations  [ eq : pgen ]  and  [ eq : qgen ] into equations  [ eq : psimp ]  and  [ eq : qsimp ] .",
    "we use this second description of our model to characterize the possible dynamics into the three qualitatively different regimes used in section  [ sec : results ] .",
    "[ app : orbits ] proof of closed orbits for the heterogeneous regime of section  [ sec : het ] . to achieve this ,",
    "we show that  after dynamic rescaling of time  our system is hamiltonian .",
    "following archetti  @xcite , we consider the acidity produced by glycolysis , which affects normal cells more than cancer cells , as a public good for cancer cells .",
    "acidity benefits all tumour cells , regardless of whether they have aerobic or anaerobic metabolism .",
    "in contrast , the increased oxygen from vascularization benefits only aerobic cells and so within a tumour it is a good that is private to non - glycolitic cells . among just the aerobic tumour cells , following archetti",
    "@xcite , vascularization is a public good since it benefits all aerobic cells in a local population regardless of how much vegf  or other vascularization increasing factors  a particular individual is producing .",
    "therefore , vascularization is a club good  @xcite , and in game theoretic terms there are two kinds of defection .",
    "all tumour cells benefit from acidity but can defect from contributing to this public good by using aerobic metabolism .",
    "any aerobic cell can benefit from higher vascularization but can defect from contributing to this club good by not producing , or producing less , vegf . since being a defector in the public good is required to benefit from the club good , we call the two goods anti - correlated .",
    "if we consider a cell interacting with @xmath0 other nearby cells and define @xmath89 as the benefit due to acidity if @xmath90 cells are producing acid , and @xmath91 as the benefit ( to aerobic cells ) due to vascularization if @xmath90 cells are ( over ) producing vegf at a cost @xmath10 .",
    "this results in three pure strategies with the following payoffs :    _ gly _ the glycolytic strategy does not use oxygen and thus produces acid .",
    "it does not ( over ) produce vegf to call for more blood vessels and thus does not increase vascularization .",
    "when interacting with @xmath7 other _ gly_cells , its payoff is : @xmath92 .",
    "_ vop _ this strategy uses oxygen and thus does not produce acid .",
    "it also ( over ) produces vegf at a cost @xmath10 and thus calls for more blood vessels , directly increasing vascularization .",
    "when interacting with @xmath7 _ gly_cells and @xmath52 other _ vop_cells , its payoff is : @xmath93 .",
    "note that the oxygen benefit due to increased vasculization is shared only between non - glycolitic cells , hence the club good group size for @xmath94 is @xmath95 .",
    "_ def _ this strategy is the universal defector , it uses oxygen and thus does not produce acid , and it also does not ( over ) produce vegf .",
    "when interacting with @xmath7 _ gly _ cells and @xmath52 _ vop _ cells , its payoff is : @xmath96 .",
    "we do not explicitly consider the case of a strategy that does not use oxygen but produces vegf ; when the cost of ( over ) producing vegf @xmath97 , the fitness of this fourth strategy will always be strictly lower than _",
    "gly_and thus always driven to extinction . across our population of cells , our fitness functions are thus :    @xmath98    where @xmath99 is the binomial distribution with @xmath0 samples and @xmath6 is the probability of success ; @xmath100 is the multinomial distribution with @xmath0 samples and @xmath6 is the probability of the first outcome , @xmath15 of the second ; and @xmath101 means the expected value of @xmath102 over @xmath90 sampled from the distribution @xmath103 .",
    "if we define the proportion of glycolytic cells as @xmath104 and the proportion of vegf producers among the aerobic cells as @xmath105 , then we can express the replicator dynamics in the factored form ( see appendix  [ app : factor ] ) :    @xmath106    where @xmath21 .",
    "we discuss the generality and applicability of replicator dynamics in appendix  [ app : repdyn ] . in appendix",
    "[ app : gain ] , we show how the gain functions of these dynamics are simplified significantly in the linear case that we consider in this paper .",
    "our focus on the linear case allows us to borrow many tools of analysis from the optional public - goods game .",
    "@xcite more complicated functional forms of @xmath107 and @xmath108 could be considered , and yield a fascinating family of possible dynamics , but this is beyond the scope of the current paper . for an initial treatment of the non - linear case ,",
    "see kaznatcheev  @xcite . in the case of @xmath36",
    "the non - linear case reduces to  @xcite , and in the case of @xmath39 or @xmath42 the non - linear case reduces to  @xcite .",
    "mathematica notebooks for visualizing and interacting with the model are available at https://github.com/kaznatcheev/mathonco as _ dglinb.nb_ , _",
    "dglinb_simplexes.nb _ , and _",
    "in this section , we are going to present a general trick for factoring replicator dynamics into a nested form .",
    "we will then apply that trick to transform @xmath88 .",
    "an early form of the account in this appendix first appeared in  @xcite , and hauert et al .",
    "@xcite previously considered the special case of optional public goods game .    a compound strategy @xmath109 of a set of strategies @xmath110",
    "is defined by :    * a component function @xmath111 with @xmath112 , * a weight @xmath113 * a profile @xmath114 , and * a fitness @xmath115 .",
    "a set of compound strategies @xmath116 factors a set of strategies @xmath117 with @xmath118 if for all @xmath119 , @xmath120 .    if @xmath116 factors @xmath117 then the system @xmath121    where @xmath122 , and the system    @xmath123    where @xmath124 and @xmath125describe the same dynamics .",
    "first , notice that @xmath126 , and @xmath127    now check that the dynamics are equal :    @xmath128    we can apply the above theorem to the particular game in section  [ sec : game ] and appendix  [ app : genmodel ] .",
    "the dynamics given in section  [ sec : game ] for _ gly_-_vop_-_def _ competition : @xmath129 are equivalent to their factored form for glycolysis and angiogenesis competition : @xmath130 where @xmath131 .",
    "use the component functions @xmath132 and @xmath133 and name @xmath134 and @xmath135 .",
    "notice that @xmath136 and @xmath137 , giving us the equations : @xmath138",
    "in the late 1970s , replicator dynamics were introduced into theoretical biology and ecology literature by a number of authors  @xcite . as we discussed in the introduction , they have been used extensively since then , coming into mathematical oncology near the turn of the millennium  @xcite . however , confusion still exists about the range of applicability of replicator dynamics . in this section , we will describe three different ways to get the replicator equation from micro - dynamical or experimental considerations :    [ app : constant ] we discuss traulsen et al.s  @xcite treatment of constant size .",
    "[ app : exponential ] we build up from an exponential growth model .    [ app : experimental ] we will start from an experimental system with arbitrary _ in vitro _ growth .",
    "none of these micro - dynamical foundations perfectly capture the _ in vivo _ conditions of a cancer patient .",
    "but the robustness of the replicator equations to changes in founding assumptions should convince us that they are a good starting point for the heuristic model in this paper .",
    "this appendix closely follows kaznatcheev  @xcite .      a focus on individual agents pushes the theorist to look for definitions of fitness on the individual  rather than population  level .",
    "we find such a definition in the moran process  @xcite , and with it comes the realization of replicator dynamics as a process on well - mixed and large but fixed sized populations .    in a moran process",
    ", we imagine that a population is made up of a fixed number @xmath139 of individuals .",
    "an agent is selected to reproduce in proportion to their game payoff , and their offspring replaces another agent in the population , chosen uniformly at random .",
    "this gives us a very clear individual account of fitness as a measure of the probability to place a replicate into the population .",
    "traulsen , claussen , and hauert  @xcite wrote down the fokker - planck equation for the above moran process , and then use ito - calculus to derive a langevin equation for the evolution of the proportions of each strategy @xmath140 .",
    "the fluctuations in this stochastic equation scale with @xmath141 and so vanish in the limit of large @xmath139 .",
    "this reduces them to a deterministic limit of the replicator equation in maynard smith form  @xcite , with the fitness functions as the payoff functions :    @xmath142    where the extract condition of @xmath143 is introduced . in the limit of weak - selection , this form is equivalent to the taylor form  @xcite used in the body of the paper :    @xmath144    even without weak - selection , the two systems of equations differ only by dynamic time rescaling and thus have the same fixed points , orbits , and paths .",
    "since these are often the things we care most about during our analyses , we can use the equations interchangeably .",
    "suppose that for some theoretical reasons , we think that the microdynamics of our population is well represented by an exponential growth model .",
    "consider @xmath145 types of cells with @xmath146 individuals each , growing with growth rates @xmath147 , which could be functions of various other parameters .",
    "the population dynamics are then described by the set of @xmath145 differential equations : @xmath148 for @xmath149 .",
    "let @xmath150 , and look at the dynamics of @xmath151 :    @xmath152    which is just the replicator dynamics .",
    "thus , replicator dynamics perfectly describe an exponentially growing population .",
    "alternatively , we can start from measurement .",
    "in particular , measurements of growth rates as would be done for _ in vitro _ experiments .",
    "we will recover replicator dynamics from purely experimental outputs or their limits .",
    "if we are running an experiment with some tagged cells of @xmath145 many types : @xmath153 then our most basic primitives are ( estimates of ) the sizes of the seeding populations @xmath154 and the size of the final populations @xmath155 . given these values and a time difference @xmath156 between when the experiment was started and when it ended , the experimental population growth rates are :    @xmath157    this can be rotated to give us a mapping @xmath158 :    @xmath159    from defining the initial and final population sizes @xmath160 , we can compare the initial and final proportions of each cell type :    @xmath161    where @xmath162 .",
    "so far we were looking at a discrete process .",
    "but we can approximate it with a continuous one . in that case",
    ", we can define @xmath163 and look at the limit as @xmath156 gets very small :    @xmath164    therefore , we recover replicator dynamics and give an explicit experimental interpretation for all of our theoretical terms .",
    "this section closely follows @xcite .    in the linear public goods that we consider in this paper",
    ", each contributor increases the public ( or club ) good by a constant amount and the whole good is divided evenly among the whole public ( or club ) regardless of if they contributed . in symbols : @xmath165 and @xmath166 .",
    "this gives us the gain functions for @xmath37 :    @xmath167    where we relabeled by defining @xmath168 as the number of participants in the club good .",
    "the issue now is to eliminate the @xmath169 in the denominator which can be done by observing that @xmath170 . resuming :    @xmath171 - \\binom{n'}{0}p^{n ' } ) - c\\\\ & = \\frac{b_v}{(1 - p)(n + 1)}(1 - p^{n + 1})- c , \\label{eq : vdgain } \\\\ & = \\frac{b_v}{n + 1}[\\sum_{k = 0}^n p^k ] - c\\end{aligned}\\ ] ]    where in the first to second step , we relabel with @xmath172 and @xmath173 to get the binomial distribution .",
    "the final step follows from polynomial division .    continuing on to the edge between _ gly _ and _ def _",
    ":    @xmath174    which means that the gain function for @xmath40 is :    @xmath175    thus , our replicator dynamics are given by :    @xmath176 - c)}_{\\text{gain function for } q } \\label{eq : repq}\\end{aligned}\\ ] ]    to find the boundaries between the dynamics , we then have to solve for when the gain functions in eqs .",
    "[ eq : vdgain ] and  [ eq : ggain ] are equal to zero . from these gain functions",
    ", we can see that the the linear goods can have three possible dynamics .",
    "first , consider when",
    "the gain function for @xmath40 crosses @xmath24 :    * if @xmath177 then the gain function for @xmath40 is positive regardless of @xmath37 , and the population converges towards all _",
    "gly_(green in figure  [ fig : dynreg ] ) , else * if @xmath43 then we have consider when the gain function for @xmath37 crosses @xmath24 .",
    "one of two cases is possible : * * if @xmath178 then regardless of the value of @xmath40 , the gain function for @xmath37 is positive , so @xmath179 making the gain function for @xmath40 negative and the population converges towards all _ vop_(red in figure  [ fig : dynreg ] ) , else * * if @xmath180 then the population will orbit around an internal fixed - point at @xmath63 ( i.e. the zero of the gain function for @xmath40 ) and @xmath65 as the unique positive root of @xmath66 ( i.e. the zero of the gain function for @xmath37 ) .",
    "thus , @xmath181 .",
    "this is the yellow region in figure  [ fig : dynreg ] .    for a proof of closed orbits ,",
    "see appendix  [ app : orbits ] .",
    "let us rigorously establish the existence of closed orbits around the internal fixed point in the third dynamic region ( yellow in figure  [ fig : dynreg ] ) .",
    "for this , we will follow closely the analysis of the optional public good by hauert et al .",
    "@xcite as specified to this model in  @xcite .",
    "consider the equations governing the dynamics of the linear goods as given in eqs .",
    "[ eq : repp ] and  [ eq : repq ] . since @xmath182 is strictly positive for @xmath183 , dividing the right hand side of the system in eqs .",
    "[ eq : repp ] and  [ eq : repq ] by @xmath182 results only in a change of rate ( dynamic rescaling of time ) .",
    "thus , the resulting system preserves the orbits of our replicator dynamics .",
    "this new system is given by :    @xmath184 - \\frac{c}{p(1 - p ) } \\label{eq : hamqshort } \\\\ & = \\frac{b_v}{n + 1}\\big ( \\frac{1}{p(1 - p ) } + \\frac{n}{1 - p } - \\sum_{k = 0}^{n - 2}(n - 1 - k)p^k \\big ) - \\frac{c}{p(1 - p ) } \\label{eq : hamqlong}\\end{aligned}\\ ] ]            notice that eq .",
    "[ eq : hamp ]  and  [ eq : hamqlong ] can be rewritten as @xmath189 .",
    "thus , we have a 1-dimensional hamiltonian system .",
    "when our conditions @xmath43 and @xmath180 are met then @xmath190 from appendix  [ app : gain ] is a unique strict global minimum of @xmath191 in @xmath192 .",
    "thus @xmath190 is a center of the dynamics with orbits of constant @xmath191 . finally , as @xmath40 or @xmath37 go to @xmath24 or @xmath41",
    ", @xmath193 goes to @xmath194 if our conditions are met ; thus the orbits are internal to @xmath192 and closed .",
    "since our transformations preserved orbits , this means that the replicator dynamics of linear public and club goods have the same closed orbits ."
  ],
  "abstract_text": [
    "<S> * background : * tumours are diverse ecosystems with persistent heterogeneity in various cancer hallmarks like self - sufficiency of growth factor production for angiogenesis and reprogramming of energy - metabolism for aerobic glycolysis . </S>",
    "<S> this heterogeneity has consequences for diagnosis , treatment , and disease progression .    </S>",
    "<S> * methods : * we introduce the double goods game to study the dynamics of these traits using evolutionary game theory . </S>",
    "<S> we model glycolytic acid production as a public good for all tumour cells and oxygen from vascularization via vegf production as a club good benefiting non - glycolytic tumour cells . </S>",
    "<S> this results in three viable phenotypic strategies : glycolytic , angiogenic , and aerobic non - angiogenic .    </S>",
    "<S> * results : * we classify the dynamics into three qualitatively distinct regimes : ( 1 ) fully glycolytic , ( 2 ) fully angiogenic , or ( 3 ) polyclonal in all three cell types . </S>",
    "<S> the third regime allows for dynamic heterogeneity even with linear goods , something that was not possible in prior public good models that considered glycolysis or growth - factor production in isolation .    </S>",
    "<S> * conclusion : * the cyclic dynamics of the polyclonal regime stress the importance of timing for anti - glycolysis treatments like lonidamine . </S>",
    "<S> the existence of qualitatively different dynamic regimes highlights the order effects of treatments . </S>",
    "<S> in particular , we consider the potential of vascular renormalization as a neoadjuvant therapy before follow up with interventions like buffer therapy . </S>"
  ]
}