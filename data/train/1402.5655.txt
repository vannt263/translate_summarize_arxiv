{
  "article_text": [
    "spatial data arise when outcomes and predictors of interest are observed at particular points or regions inside a defined study area .",
    "spatial data sets are common in many fields including environmental science , economics , and epidemiology . in epidemiology ,",
    "understanding the underlying spatial patterns of a disease is an important starting point for further investigations .",
    "the risk of disease inherently varies in space because the risk factors are non - uniformly distributed in space .",
    "such risk factors may include lifestyle variables such as alcohol and tobacco use or exposure levels of environmental causes of disease such as air pollution or uv radiation .",
    "we expect that these risk factors are positively correlated in space meaning that nearby areas will have similar exposure levels or underlying characteristics .",
    "that is , we assume risk factors obey tobler s first law of geography : `` everything is related to everything else , but near things are more related than distant things '' @xcite .    in many studies ,",
    "underlying disease risk factors are unknown or unmeasured .",
    "bayesian models account for unknown or unmeasured risk factors using priors chosen to mimic their correlation structure .",
    "the most common bayesian framework for area - level spatial data uses gaussian random effects with a covariance structure that imposes positive spatial dependence between random effects of neighboring or near - by areas @xcite .",
    "the non - gaussian spatial clustering and potts model based priors also impose positive dependence in the relative risks of neighboring areas @xcite .",
    "more recently , several authors have developed modifications to existing models , specifically to preserve positive dependence for spatial statistics applications @xcite .",
    "further , positive spatial dependence is usually imposed in geostatistical models for data observed point - wise rather than area - wise .",
    "for example , the matrn family of marginal covariance functions for gaussian random fields yields positive correlations between observations at two locations locations , with the magnitude of the correlation decreasing with distance @xcite .",
    "we present a bayesian model for area - level count data that uses gaussian random effects with a novel type of g - wishart prior on the inverse variance  covariance matrix .",
    "the usual g - wishart or hyper inverse wishart prior restricts off - diagonal elements of the precision matrix to 0 according to the edges in an undirected graph @xcite .",
    "@xcite use the g - wishart prior to analyze mortality counts for ten cancers in the united states using a bayesian hierarchical model incorporating gaussian random effects with a separable covariance structure .",
    "their comparisons show that allowing different strengths of association between paris of neighboring states can have advantages over traditional conditional autoregressive priors that assume the same strength of conditional association across the study region .",
    "however , the g - wishart prior allows for both positive and negative conditional associations between neighboring areas .    the truncated g - wishart distribution that we introduce only has support over precision matrices that lead to positive conditional associations .",
    "we describe markov chain monte carlo ( mcmc ) algorithms for this new prior and construct a bayesian hierarchical model for areal count data that uses the truncated g - wishart prior for the precision matrix of gaussian random effects .",
    "we show via simulation studies that risk estimates based on a model using the truncated g - wishart prior are better than those based on conditional autoregression when the outcome is rare and the risk surface is not smooth . for univariate data ,",
    "there is little information to identify the parameters of the spatial precision matrix ; however , we can share information across outcomes in a multivariate model by assuming a separable covariance structure .",
    "we illustrate the improvement of using the truncated g - wishart prior in a separable model ( measured via cross - validation ) using cancer incidence data from the washington state cancer registry .",
    "the structure of this paper is as follows . in section 2 ,",
    "we present our modeling framework and give a brief overview of conditional autoregressive models . in section  3 , we define the truncated g - wishart distribution and give the details of an mcmc sampler for estimating relative risks in a spatial statistics context . in section 4 ,",
    "we present a simulation study based on univariate disease mapping using the geography of the counties of washington state . finally , in section 5 , we extend the univariate truncated g - wishart model to multivariate disease mapping using the separable gaussian graphical model framework of @xcite .",
    "let @xmath0 be a set of non - overlapping geographical areas , and let @xmath1 represent the set of counts of the observed number of health events in these areas .",
    "possible health events include deaths from a disease , incident cases of a disease , or hospital admissions with specific symptoms of a disease .",
    "next , let @xmath2 be the set of expected counts and @xmath3 be a matrix where @xmath4 is a vector of suspected risk factors measured in area @xmath5",
    ". the expected counts account for differences in known demographic risk factors .",
    "if the population in each area is stratified into @xmath6 groups ( e.g. , gender and 5 year age - band combinations ) , then the expected count for each area is @xmath7 where @xmath8 is the population in area @xmath5 in demographic group @xmath9 and @xmath10 is the rate of disease in group @xmath9 .",
    "the rates @xmath10 may be estimated from the data if the disease counts are available by strata ( internal standardization ) or they may be previously published estimates for the rates of disease ( external standardization ) .    a generic bayesian hierarchical model for data of this type is : @xmath11 where @xmath12 is the vector of counts with area @xmath5 excluded and @xmath13 is a probability distribution with spatial structure .",
    "most choices of @xmath13 encode the belief that the residual spatial random effects , @xmath14 , of nearby areas have similar values .",
    "this restriction follows from the interpretation of the random effects as surrogates for unmeasured risk factors , which are generally assumed to be positively correlated in space .",
    "the inclusion of @xmath13 produces smoother ( though biased ) estimates of the vector of relative risks , @xmath15 , with reduced variability compared to the maximum likelihood estimates @xmath16 .",
    "these maximum likelihood estimates , called standardized incidence ratios ( sirs ) or standardized mortality / morbidity ratios ( smrs ) , have large sampling variances when the expected counts are small . a key task in modeling areal count data",
    "is to choose a prior @xmath13 that is flexible enough to adapt to the smoothness of the risk surface .",
    "the most common choice for @xmath13 is the gaussian conditional autoregression or car prior @xcite , which is a type of gaussian markov random field . the car model for a vector of gaussian random variables",
    "is defined by a set of conditional distributions .",
    "the conditional distribution for the random variable , @xmath17 , given the other variables , @xmath18 , is @xmath19 the joint distribution of the vector @xmath14 is a mean - zero multivariate normal distribution with precision @xmath20 , where @xmath21 , @xmath22 , and @xmath23 .",
    "this is a proper joint distribution if @xmath24 is a symmetric , positive definite matrix @xcite .",
    "the _ intrinsic conditional autoregression _ or icar prior is the most commonly used prior for spatial random effects within the class of car priors . under the icar prior ,",
    "the conditional mean for a given random effect is the weighted average of the neighboring random effects , and the conditional variance is inversely proportion to the sum of these weights : @xmath25 here @xmath26 is nonzero if regions @xmath5 and @xmath9 are neighbors ( i.e. , share a border ) and 0 otherwise ; @xmath27 is the sum of all of the weights for a specific area . a binary specification for @xmath28",
    "is frequently used , though other weights that incorporate the distance between areas can also be used @xcite . in the binary case , @xmath29 for neighboring regions and @xmath30 , the number of regions that border area @xmath5 . under this specification , the conditional mean for a particular random effect is the average value of the random effects for the neighboring regions , and the conditional variance is inversely proportional to the number of neighbors of the area .",
    "@xcite use a car prior for spatial random effects in a disease mapping context in what has become known as the _ convolution model _ :",
    "@xmath31 here @xmath32 is a non - spatial random effect and @xmath17 is a spatial random effect .",
    "the prior for @xmath33 is @xmath34 , and the prior for @xmath35 is the icar prior .",
    "though popular , the convolution model has several drawbacks .",
    "first , there are only two parameters ( @xmath36 and @xmath37 ) to control the level of smoothing with only one of these ( @xmath37 ) contributing to the spatial portion of the model .",
    "this parsimony is ideal for estimating a smooth risk surface in the presence of large sampling variably , which is a common issue for rare diseases or for small area estimation .",
    "however , using icar random effects can lead to over - smoothing , which masks interesting features of the risk surface , including sharp changes .",
    "several authors have addressed this issue by incorporating flexibility in the conditional independence structure of the relative risks @xcite .",
    "these approaches are fairly parsimonious , but estimating the parameters requires careful reversible jump mcmc or access to data from previous years . in contrast",
    ", we develop a locally - adaptive approach with a separate parameter for the strength of spatial association between each pair of neighboring areas while preserving the conditional independence structure .",
    "a second drawback is that the icar prior is improper .",
    "the joint distribution implied by the conditional specification in ( [ icar ] ) is a singular multivariate normal distribution with precision matrix @xmath38 , where @xmath39 is a diagonal matrix with elements @xmath40 . since each row of @xmath41 sums to @xmath42",
    ", this precision matrix does not have full rank , and the joint prior for @xmath35 is improper .",
    "one way to alleviate both the over smoothing and the singularity issues is through the addition of a spatial autocorrelation parameter @xmath43 : @xmath44 this specification is called the proper car because it gives rise to a proper joint distribution as long as @xmath43 is between the reciprocals of the largest and smallest eigenvalues of @xmath45 @xcite .",
    "for the binary specification of @xmath46 , this always includes @xmath47 .",
    "the relationship between @xmath43 and the overall level of spatial smoothing in the proper car prior is complex .",
    "the prior marginal correlations between the random effects of neighboring areas increase very slowly as @xmath43 increases , with substantial correlation obtained only when @xmath48 is very close to @xmath49 @xcite .",
    "further , as @xmath43 increases , the ordering of these marginal correlations is not fixed @xcite .",
    "nonetheless , the icar prior remains a popular choice for spatially correlated errors in many applied settings .",
    "the conditional specification in ( [ icar ] ) is parsimonious , and one only needs to specify a single prior for the precision of the spatial random effects .",
    "prior specification has received some attention in the literature @xcite .",
    "further , off - the - shelf mcmc routines for the icar and convolution models are available in winbugs @xcite and various ` r ` packages .",
    "fast computation of approximate marginal posterior summaries is available using integrated nested laplace approximation ( inla ) @xcite .",
    "an alternative to specifying the prior for spatial random effects based on a set of conditional distributions is to work directly with the joint distribution . a gaussian graphical model or covariance selection model is a set of joint multivariate normal distributions that obey the pairwise conditional independence properties encoded by an undirected graph , @xmath50 @xcite .",
    "this graph has two elements : the vertex set @xmath51 and the edge list @xmath52 .",
    "the absence of an edge between two vertices corresponds to conditional independence and implies a specific structure for the precision matrix of the joint distribution .",
    "if @xmath35 follows a multivariate normal distribution with precision matrix  @xmath53 , then @xmath35 follows a gaussian graphical model if @xmath54 for any pairs @xmath5 and @xmath9 . here",
    "@xmath55 is the vector @xmath35 excluding the @xmath56 and @xmath57 elements .",
    "the conjugate prior for the precision matrix in the gaussian setting is the wishart distribution , which is a distribution over all symmetric , positive definite matrices of a fixed dimension .",
    "the wishart distribution has two parameters .",
    "the first is a scaler @xmath58 , which controls the spread of the distribution .",
    "the second is an @xmath59 matrix @xmath60 , which is related to the location of the distribution . for @xmath61 , @xmath62 and mode@xmath63 .",
    "the g - wishart distribution is the conjugate prior for the precision matrix in a gaussian graphical model @xcite .",
    "the g - wishart distribution is a distribution over @xmath64 , the set of all symmetric , positive definite matrices with zeros in the off - diagonal elements that correspond to missing edges in @xmath50 .",
    "the density of the g - wishart distribution for a matrix @xmath53 is @xmath65 where @xmath66 is the trace of @xmath67 .",
    "the normalizing constant @xmath68 has a closed form when @xmath50 is a decomposable graph and can be estimated for general graphs using the monte carlo method proposed by @xcite .",
    "we propose a new g - wishart distribution called the truncated g - wishart distribution that imposes additional constraints on @xmath53 .",
    "this is a distribution over positive definite matrices where the off - diagonal elements that correspond to ( non - missing ) edges in @xmath52 are less than @xmath42 .",
    "this restriction means that all pairwise conditional ( or partial ) correlations are positive because @xmath69 this restriction is attractive in a spatial statistics context where we believe neighboring areal units are likely to be similar to each other , given the other areas .    if @xmath53 follows a truncated g - wishart distribution , then @xmath70 here @xmath71 is the unknown normalizing constant , and @xmath72 is the set of matrices with negative off - diagonal elements .",
    "the normalizing constant in ( [ gwdistro ] ) is finite as long as @xmath58 and @xmath73 @xcite .",
    "the normalizing constant in ( [ ngwishdistro ] ) is finite under the same conditions because the support of the truncated g - wishart is a subset of the support of the g - wishart distribution .",
    "the mode of the truncated g - wishart is again @xmath74 , and for this reason we only consider @xmath75 . in this paper",
    ", we write @xmath76 for the truncated g - wishart distribution and @xmath77 for the g - wishart distribution .",
    "@xcite and @xcite transform @xmath53 to the cholesky square root , which we call @xmath78 , because it is easier to handle the positive definite constraint in the transformed space . in the g - wishart case ,",
    "the elements of @xmath78 are either variation independent or are deterministic functions of other elements .",
    "we call the off - diagonal elements of @xmath78 that correspond to missing edges in the graph @xmath50 `` non - free . '' these are deterministic functions of the `` free '' elements : the diagonal elements and the off - diagonal elements corresponding to edges in g. if we restrict @xmath53 to the space @xmath79 , we have the following constraints on the off - diagonal elements of the cholesky square root @xmath78 : @xmath80 the first two conditions guarantee that @xmath81 .",
    "the addition of the third inequality guarantees that @xmath82 ; however , this restriction comes at the cost of losing variation independence ( i.e. , the parameters space of @xmath78 is no longer rectangular ) .",
    "we sample from the truncated g - wishart distribution using a random walk metropolis ",
    "hastings algorithm similar to the sampler proposed by @xcite .",
    "we sequentially perturb one free element @xmath83 at a time , holding the other free elements constant . in doing so",
    ", we must find the support of the conditional distribution of @xmath84 given the other elements .",
    "the support of this conditional distribution is the set of @xmath84 that satisfy inequalities ( [ diagfree])([myineq ] ) when the free elements , the left - hand sides of ( [ diagfree ] ) and ( [ myineq ] ) , are fixed .    for each specific graph and fixed pair @xmath85",
    ", we can write the inequalities in ( [ myineq ] ) as @xmath86 where @xmath87 is the set of fixed , free elements of @xmath78 excluding @xmath88 and @xmath84 .",
    "we construct @xmath89 by substituting the equalities from ( [ completion ] ) for all of the non - free elements that depend on @xmath84 .",
    "each @xmath90 is ( at worst ) a quadratic function of @xmath84 .",
    "when @xmath90 is a linear function , solving @xmath90 for @xmath84 gives a solution set of the form @xmath91 , where @xmath92 .",
    "when @xmath90 is quadratic , the solution set is @xmath93 , where @xmath94 is again negative .    if @xmath95 in lexicographical order , then the upper bound for @xmath88 can not depend on @xmath84 .",
    "depending on the graphical structure , there are pairs @xmath96 such that the bound for @xmath88 does not depend on @xmath84 . in these cases @xmath97 .",
    "the conditional distribution of a free element @xmath98 given all other free elements is a continuous distribution over an open subinterval of @xmath99 given by @xmath100    we now give the analogous theorem for free , diagonal elements :    the conditional distribution of a free element @xmath101 given other free elements is a continuous distribution over a subinterval of @xmath102 given by @xmath103    for proofs , see the supplementary material @xcite .",
    "we use these bounds to construct a markov chain with stationary distribution equal to the truncated g - wishart distribution .",
    "suppose @xmath104 is an upper - triangular matrix at iteration @xmath105 such that @xmath106 .",
    "for each free element in @xmath107 do the following :    1 .   calculate the upper and lower limits for @xmath108 as described above .",
    "sample from a truncated normal with these limits , mean @xmath109 , and standard deviation @xmath110 .",
    "3 .   update the non - free elements in lexicographical order .",
    "these steps give a proposal @xmath111 where the free elements in @xmath112 equal to the free elements of @xmath104 except in the @xmath85 entry .",
    "4 .   accept according to the acceptance probability @xmath113 , where @xmath114    @xmath115 is the density of a normal distribution with mean @xmath116 and standard  deviation @xmath117 truncated to the interval @xmath118 , and @xmath119 is the number of areas that are neighbors of area @xmath5 but have larger index numbers , that is , @xmath120 .",
    "the speed of this sampler depends on both the number of areas and on the number of edges in the adjacency graph .",
    "these determine the number of non - zero elements in @xmath53 and the number of non - zero elements in @xmath121 .",
    "the elements of @xmath53 can be reordered to form a banded matrix .",
    "the size of the bandwidth depends on the proportion of non - missing edges ( i.e. , the edge density ) , and the bandwidth of @xmath121 is the same as @xmath53 @xcite .",
    "thus reordering the elements of @xmath53 can create sparsity in @xmath122 , which reduces the number of nonzero terms in .",
    "figure [ fig : scale ] shows the time to one thousand iterations for graphs with different numbers of nodes and edges , averaging over 50 simulated networks for each size - density combination . for each simulation , we randomly sample networks with a given size and density and reorder the elements using a bandwidth - decreasing algorithm ( the reverse cuthill  mckee algorithm , available in the ` spam ` package ) .",
    "the sampler scales well for very sparse networks , but the time to 1000 iterations grows quickly when the edge density is over @xmath123% .",
    "the edge densities of the counties in washington state and the states in the continental us are @xmath124 and @xmath125 , respectively.=-1    , and the edge density of the continental us and the district of columbia is @xmath125 . ]",
    "we use truncated g - wishart prior within the generic bayesian hierarchical model for areal counts given in section 2 : @xmath126 we suggest choosing the hyper parameters for the priors on @xmath127 and @xmath128 by first specifying a reasonable range for the average relative risk and then finding values of @xmath129 and @xmath130 that match this range for a fixed value of @xmath53 .",
    "for fixed @xmath53 , the distribution of @xmath131 is a univariate normal distribution depending on @xmath127 and @xmath128 . using the adjacency matrix of washington state as an example and letting @xmath132",
    ", @xmath133 of the prior on @xmath134 is between @xmath135 when @xmath136 and @xmath137 . for a more informative prior",
    ", setting @xmath138 gives a range of @xmath139 .",
    "more details of this prior specification framework are in the supplementary material .",
    "the prior on the spatial autocorrelation parameter @xmath43 was introduced by @xcite for computational convenience and to reflect the fact that large values of @xmath43 are needed to achieve non - negligible spatial dependence in the proper car prior .",
    "@xcite use a continuous uniform prior on @xmath140 and a @xmath141 prior in a similar multivariate context . for our purposes , using a discrete prior for @xmath43 is essential for carrying out mcmc because @xmath43 appears in the normalizing constant of the prior on @xmath53 .",
    "that is , the normalizing constant in ( [ ngwishdistro ] ) becomes @xmath142 .",
    "as will be shown below , we pre calculate ratios of these normalizing constants in advance .",
    "it is not practical to repeat this process at each step of the mcmc .",
    "we estimate the posterior distribution of the relative risks , @xmath15 , using mcmc .",
    "most of the transitions are standard metropolis or gibbs updates ( see supplementary material ) except for the updates on the precision matrix @xmath53 and the autocorrelation parameter @xmath43 .",
    "we update @xmath53 as described in section 3.3 , skipping over @xmath143 to preserve the restriction on @xmath144 .",
    "we update @xmath43 by choosing the next smallest or largest value in @xmath145 @xmath146 , each with probability @xmath147 .",
    "if @xmath148 and @xmath149 are not on the boundary of this list , then the acceptance probability is @xmath150 where @xmath151 \\label { acceptrho } \\\\ & \\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,+ \\log\\left[i_2\\left(g , \\delta , ( \\delta- 2 ) { \\mathbf{d}}(\\rho_t)\\right)\\right ] - \\log\\left[i_2\\left(\\delta , ( \\delta- 2 ) { \\mathbf{d}}(\\rho')\\right)\\right ] .",
    "\\nonumber\\end{aligned}\\ ] ] if either @xmath148 or @xmath149 is on the boundary , there is an extra factor of @xmath152 because the proposal is not symmetric : if @xmath153 , we propose @xmath154 with probability @xmath49 . because the graph @xmath50 is constant , the normalizing constants in ( [ acceptrho ] )",
    "only depend on @xmath43 .",
    "we estimate the necessary ratios of normalizing constants and store them in a table prior to running the full mcmc .    for two densities of the form @xmath155 and @xmath156 with normalizing constants @xmath157 and",
    "@xmath158 , the ratio of normalizing constants is given by @xmath159 $ ] when the support of the two distributions are the same @xcite . here",
    "@xmath160 is the expectation under the second density .",
    "we estimate this expectation for each consecutive pair @xmath161 using mcmc . here",
    "we give the details for estimating the normalizing constants of a set of g - wishart distributions without restrictions on the @xmath144 element and with @xmath162 .",
    "however , the same process will work for the truncated g - wishart and with the restriction that @xmath163 .    *",
    "generate a markov chain @xmath164 with stationary distribution@xmath165 .",
    "* for each state , let @xmath166 $ ] .",
    "* estimate @xmath167 - \\log[i_1(g,3 , { \\mathbf{d}}(\\rho_2))]$ ] by @xmath168 .",
    "$ ]    for each pair @xmath169 , we average over the estimates from @xmath170 parallel chains of @xmath171 iterations .",
    "figure 6 in the supplementary material shows the evolution of the estimates of @xmath172- \\log[i_1(g,3 , ( { \\mathbf{d}}_w - 0.98 { \\mathbf{w}})^{-1 } ) ] $ ] using the adjacency graph of the counties in washington state .",
    "in section 5 , we use the truncated g - wishart prior to analyze incidence data from the washington state cancer registry . in doing so",
    ", we adopt the same framework as @xcite and assign a matrix normal prior with a separable covariance structure to the log relative risks .",
    "this means we assume that the covariance in the log relative risks factors into a purely spatial portion and a purely between - outcomes portion .",
    "this assumption is common for modeling two - way data including multivariate spatial data @xcite and spatio - temporal data @xcite as well as multi - way data @xcite .",
    "here we assume that there are @xmath173 areas with counts for @xmath174 cancer sites ( site of primary origin of the cancer ) observed in each area .",
    "if @xmath175 is a matrix of observed counts and @xmath176 is a matrix of expected counts , then we have @xmath177 we use @xmath178 to denote the matrix normal distribution with separable covariance structure @xcite .",
    "that is @xmath179 , where `` @xmath180 '' is the kronecker product . in the absence of any information on cancer risk factors such as smoking rate or a socioeconomic summary measure , we only include an overall rate for each cancer in the mean model , that is , @xmath181 .",
    "the row covariance @xmath182 describes the spatial covariance structure of the log relative risks .",
    "the column covariance matrix @xmath183 describes the covariance between the cancers .",
    "we incorporate the truncated g - wishart distribution as the prior for the spatial precision matrix @xmath184 , and we use a g - wishart or wishart prior with mode equal to the identity matrix for @xmath185 . when the prior on @xmath186 is a g - wishart prior , we incorporate uncertainty in the between - cancer conditional independence graph @xmath187 using a uniform prior over all graphs . for both priors , we restrict @xmath188 for identifiability .",
    "finally , we use an independent normal prior on each @xmath189 .",
    "we estimate the relative risks under this model using an mcmc sampler identical to that in @xcite , substituting in the sampler from section 3.2 for the update on @xmath190 .",
    "the assumption of separability yields a more parsimonious covariance structure and can yield more stable estimation than with a full , unstructured covariance matrix .",
    "conditioning on one precision matrix forms ` replicates ' for estimating the other : @xmath191 thus , if @xmath186 is known , then the sample size for estimating @xmath190 is equal to the number of rows , and similarly , if @xmath190 is known , the sample size for estimating @xmath186 ( and @xmath187 ) is equal to the number of columns .",
    "this factorization appears in the iterative algorithm for finding the maximum likelihood estimates of the matrix normal distribution @xcite as well as in the gibbs sampler when using the conjugate wishart prior with matrix or array normal data @xcite .",
    "we compare the univariate disease mapping model using the truncated g - wishart prior to three other models in a simulation study based on a similar study in @xcite .",
    "the purpose of this simulation study is to investigate the potential of the truncated g - wishart prior in a bayesian hierarchical model for a single realization of a disease outcome in each area .",
    "we also directly compare the g - wishart to the standard gaussian markov random field formulation in a univariate context , which has not previously been done in the literature .",
    "we find that the more flexible g - wishart priors can be advantageous when the underlying disease risk surface has sharp changes , but there are serious concerns related to estimating a large number of covariance parameters .",
    "we illustrate a more realistic example relying on the assumption of separability in section 5 .",
    "we use the @xmath192 counties in washington state as our study region and generate expected counts based on the age - gender structure of these counties in the @xmath193 census and published rates for larynx , ovarian , and lung cancer in the united kingdom in 2008 @xcite .",
    "these three cancers are chosen to represent a range of disease incidence from rare to common .",
    "a map of the counties with the underlying undirected graph is shown in figure [ adjacency ] , and the distributions of expected counts for each cancer are shown on the log scale in figure [ expcounts ] .",
    "we generate the risk surface as the combination of a globally - smooth surface and a locally - constant surface .",
    "we label each area @xmath194 or @xmath49 using a potts model @xcite so that neighboring areas are more likely to have the same label .",
    "the label allocation for this simulation study is shown in figure [ simlabs ] .",
    "for each simulation , we generate @xmath195 where @xmath196 is the label assigned to county @xmath5 .",
    "we simulate @xmath197 and @xmath17 independently from multivariate normal distributions with matrn covariance function with smoothness parameter @xmath198 and range chosen so that the median marginal correlation is @xmath199 .",
    "thus , each of the vectors @xmath200 and @xmath14 are realizations of a smooth spatial process observed at a finite set of points . in different simulations , we set @xmath201 to @xmath199 , @xmath49 , or @xmath202 .",
    "larger values of @xmath201 lead to a risk surface with more discontinuities .",
    "we generate @xmath203 realizations from each combination of @xmath201 and the three sets of expected counts .    ) for simulation study . ]    for the simulation results described below , we run each chain for @xmath171 iterations , discarding the first half as burn in .",
    "we set the prior parameters for the model in section  3.3 to @xmath204 , @xmath205 , @xmath206 , and @xmath162 .",
    "figure 3 in the supplementary material shows the evolution of the posterior mean for @xmath170 different chains for two elements of the cholesky square root and two random effects . in all cases",
    ", we reach convergence in about @xmath207 iterations .",
    "we compare the model using the truncated g - wishart prior to three other models .",
    "the model using the g - wishart prior is identical to the model from section 3.3 except that the prior on the precision matrix @xmath53 is the g - wishart prior instead of the truncated g - wishart prior .",
    "we also compare against the convolution model from section 2.2 and a similar model that includes only spatial random effects with an icar prior . in the convolution and icar models",
    ", we estimate the posterior mean and variance of the relative risks using inla . for the models using truncated g - wishart and g - wishart priors",
    ", we explore the posterior distributions using mcmc .    in figure [",
    "fig : shrinktgwgw ] , we compare the true spatial random effects @xmath14 against the posterior estimates of the random effects for the truncated g - wishart model and the g - wishart models from one simulation for each set of expected counts .",
    "the estimates of the random effects are similar to the true values when the expected counts are high , but there is substantial shrinkage toward the prior mean of zero when the expected counts are small .",
    "this reflects the fact that there is much more information about the relative risks when the counts @xmath208 are larger , and we see the same relationship in other disease mapping models .     under the truncated g - wishart ( tgw ) and g - wishart ( gw ) models .",
    "the posterior estimates shrink toward the prior mean of zero as the expected counts decrease . ]",
    "we compare the four methods using the root - averaged mean squared error ( ramse ) of the posterior mean of each relative risk @xmath209 .",
    "this is the square root of the mean squared error averaged over all simulations and all areas .",
    "for @xmath210 simulations and @xmath211 iterations of the mcmc sampler , the ramse is @xmath212 where @xmath213 it the true relative risk for area @xmath5 in simulation @xmath214 and @xmath215 is the corresponding value at iteration @xmath216 of the mcmc .",
    "the results of this simulation are shown in figure [ simres ] , and the triangle indicates the lowest ramse within each scenario .",
    "in general , the ramse decreases for all four models when the expected counts increase , and the ramse increases when the level of smoothing decreases ( i.e. ,  m  increases ) . the model using the truncated g - wishart prior performs the best in six out of nine scenarios ,",
    "and we see the greatest benefit in the larynx , @xmath217 simulation when the expected counts are low and the local discontinuities in the risk surface are most prominent .    .",
    "the triangle signifies the smallest value for each experiment .",
    "the four models are : tgw , truncated g - wishart prior on the precision matrix for the spatial random effects ; gw , g - wishart prior on the precision matrix for the spatial random effects ; bym , convolution model with independent and icar random effects ; icar , only icar random effects .",
    "all models show increased ramse with increased spatial discontinuities ( large m ) and increased ramse with smaller expected counts .",
    "the tgw prior performs the best in six out of nine scenarios with the greatest benefit in the larynx , @xmath217 experiment . ]",
    "while the truncated g - wishart and g - wishart priors for the spatial covariance appear advantageous in this simulation study , there is little information in a single sample for estimating the full covariance matrix .",
    "figure [ fig : prvpostuniv ] shows that the posterior distributions of the elements of the chokesly square root are nearly identical to the prior distributions .",
    "this suggests that prior parameter choice plays a substantial role in the results from the tgw and gw models .",
    "furthermore , the tgw and gw models should struggle when the risk surface is smoothly varying and the degree of smoothness is common across the study region .",
    "table 2 in the supplementary material shows that the convolution model outperforms the tgw and gw models when there is no spatial association ( the log relative risks are generated independently ) and when the underlying risk surface is smooth ( the log relative risks are generated directly from the icar prior ) .",
    "in general , the tgw and gw results are comparable with the convolution model when the expected counts were larger and there was some spatial structure in the risk surface .",
    "however , with large expected counts ( e.g. , the lung cancer scenario ) , most reasonable methods will perform adequately .",
    "in this section , we use the truncated g - wishart prior in a multivariate disease mapping context using cancer incidence data from the washington state cancer registry . let @xmath218 be a @xmath219 matrix of incidence for @xmath170 cancers in each county in washington state in 2010 .",
    "these @xmath170 cancers have the largest incidence across the state in 2010 .",
    "the expected counts @xmath220 are calculated separately for each cancer using internal standardization based on sex and 5-year age bands .",
    "the standardized incidence ratios ( sirs = @xmath221 ) for these data are between @xmath42 and @xmath222 , and the range of the empirical correlations between the sirs of the different cancers ( not  taking into account spatial dependence ) is @xmath223 . just over @xmath224 of the counts",
    "are under  @xmath225 , but we do not treat small counts as missing in this analysis .",
    "we use cross - validation to compare the model in section 3.4 to models using the g - wishart prior @xcite and using the proper car form for @xmath190 @xcite .",
    "we compare @xmath226 different choices for the prior on @xmath190 and two choices for the prior on @xmath186 . for the truncated g - wishart and g - wishart priors on @xmath190 , we set @xmath227 and @xmath228 , where the prior on @xmath43 is the same as in section  3.3 .",
    "the mcar prior on @xmath190 is simply @xmath229 .",
    "for both the wishart and the g - wishart priors on @xmath186 , we set @xmath230 and @xmath231 .",
    "we randomly split all observations into @xmath170 bins and create @xmath170 data sets , each with one bin of counts held out .",
    "we impute the missing counts as part of the mcmc and compare the models based on average predictive squared bias ( @xmath232 ) and average predictive variance ( var ) .",
    "let @xmath233 be the predicted value under model @xmath234 , @xmath235 be the variance of the posterior predictive distribution , and @xmath236 be the observed count .",
    "the comparison criteria are @xmath237    the results ( based on running each mcmc for 200,000 iterations ) are given in table [ comparison ] .",
    "the truncated g - wishart model with a g - wishart prior on @xmath186 performs best in terms of bias , and the truncated g - wishart model with a wishart prior on @xmath186 performs best in terms of predictive variance . using the truncated g - wishart prior for the spatial precision matrix improves over the g - wishart prior for both choices of prior for @xmath186 .",
    "the mcar model is the second best model in terms of mse ( the sum of @xmath232 and var ) .",
    ".ten - fold cross - validation results for the washington state cancer incidence data .",
    "the five models use the matrix normal random effects model from section 3.4 .",
    "the priors on the precision matrices are : ggm , g - wishart priors on @xmath190 and @xmath186 ; tggm , truncated g - wishart prior on @xmath190 and g - wishart prior on @xmath186 ; full , g - wishart prior on @xmath190 and wishart prior on @xmath186 ; tfull , truncated g - wishart prior on @xmath190 and wishart prior on @xmath186 ; mcar , proper car prior on @xmath190 and wishart prior on @xmath186 . in the ggm and tggm models ,",
    "the cancer conditional independence graph @xmath187 is random . in the other three models",
    ", @xmath187 is a complete graph . [",
    "cols=\">,>,>,>,^,^\",options=\"header \" , ]     the cross - validation results are somewhat sensitive to the choice of prior on @xmath43",
    ". we investigated fixing @xmath43 to @xmath238 or @xmath239 ( the mean of the @xmath240 prior used in @xcite ) as well as using a discrete uniform prior on @xmath241 . in some cases , the predictive variance is substantially smaller than the variance in table  [ comparison ] , but this comes at the cost of greater bias .",
    "the best method in terms of overall mse is still the tggm model where the prior on @xmath43 is discrete uniform with additional values closer to @xmath49 .",
    "full cross - validation results for the three additional priors on @xmath43 are in the supplementary material .",
    "this article presents a novel extension of the g - wishart prior for the precision matrix of spatial random effects . in a simulation study ,",
    "the truncated g - wishart prior is able to better estimate the relative risks when the outcomes are rare ( i.e. , the expected counts are small ) and when the risk surface is not smooth .",
    "however , we found that there is not enough information in a single outcome to estimate the spatial correlation structure .",
    "the restriction of the g - wishart prior was shown to be advantageous when used in a multivariate disease mapping context with incidence data from the washington state cancer registry .",
    "the multivariate model relies on the assumption of separability to estimate the rich correlation structure by pooling information across outcomes .",
    "the validity of the separability assumption has been carefully considered for spatiotemporal applications @xcite , and alternative , non - separable space ",
    "time covariance models have been proposed for gaussian processes @xcite and gaussian markov random fields @xcite . @xcite extend the mcar to allow for different spatial autocorrelation parameters for each outcome , yielding non - separable model that is still relatively parsimonious , and @xcite further extend the mcar paradigm by including parameters that a directly represent the correlation between different outcomes in neighboring areas .",
    "ultimately , these mcar extensions still make an assumption similar to separability in that the correlation between outcomes within a single areas is the same for all areas.=1    as mentioned in section 2.1 , others have approached this problem by directly altering the conditional independence structure @xcite .",
    "given that these models have been shown to outperform the traditional convolution model in some scenarios and are fairly parsimonious , these methods may be better for univariate outcomes than our tgw model .",
    "one direction for future research is to incorporate the locally adaptive car @xcite in the matrix variate random effect framework of sections 3.4 and 5 .",
    "there are a number of computation issues when using the truncated g - wishart and g - wishart priors .",
    "each mcmc run for the univariate truncated g - wishart model in section 4 takes approximately @xmath202 hours to complete on a @xmath242 ghz intel xeon e5 - 2640 processor , and , with the exception of the mcar model , the mcmc for each model in section 5 takes about @xmath243 hours to complete .",
    "in contrast , estimating the convolution and icar models from section 4 takes a matter of seconds in inla . we have found that the proposal variance for updates of the cholesky square ( section 3.3 ) and the random effects ( see supplementary material ) must be chosen carefully to avoid poor convergence . in both sections @xmath244 and @xmath225 , we used @xmath245 for updating @xmath78 and @xmath246 for updating @xmath35 . while the computation time for the models detailed here are not prohibitive , they may pose a challenge as we extend to more complicated datasets , such as those including multiple diseases in time and space .",
    "r code for the simulation in section 4 and c++ code for the analysis in section 5 are available at http://www.lancaster.ac.uk/staff/smithtr/ngwsource.zip .",
    "included here are the expected counts and labeling scheme for section 4 and prototypical data for section 5 .",
    "a censored version of the data used in section  5 is available from https://fortress.wa.gov/doh/wscr/wscr/query.mvc/query .",
    "dobra , a. , lenkoski , a. , and rodriguez , a. ( 2011 ) .",
    "`` bayesian inference for general gaussian graphical models with applications to multivariate lattice data . '' _ journal of the american statistical association _",
    ", 106 : 14181433 .",
    "gneiting , t. and guttorp , p. ( 2010 ) .",
    "`` continuous parameter spatio - temporal processes . '' in : gelfand , a. , diggle , p. , guttorp , p. , and fuentes , m. ( eds . ) , _ handbook of spatial statistics _ , 427436 .",
    "crc press .",
    "hughes , j. and haran , m. ( 2013 ) .",
    "`` dimension reduction and alleviation of confounding for spatial generalized linear mixed models . ''",
    "_ journal of the royal statistical society : series b ( statistical methodology ) _ , 75 : 139159 .",
    "jin , x. , banerjee , s. , and carlin , b.  p. ( 2007 ) .",
    "`` order - free co - regionalized areal data models with application to multiple - disease mapping . '' _ journal of the royal statistical society : series b ( statistical methodology ) _ , 69 : 817838 .",
    "knorr - held , l. and best , n. ( 2001 ) . `` a shared component model for detecting joint and selective clustering of two diseases",
    "_ journal of the royal statistical society : series a ( statistics in society ) _ , 164 : 7385 .",
    "lee , d. and mitchell , r. ( 2013 ) .",
    "`` locally adaptive spatial smoothing using conditional auto - regressive models . ''",
    "_ journal of the royal statistical society : series c ( applied statistics ) _ , 62 : 593608 .",
    "mardia , k. and goodall , c. ( 1993 ) .",
    "`` spatial - temporal analysis of multivariate environmental monitoring data . '' in : patil , g. and rao , c. ( eds . ) , _ multivariate environmental statistics _ , 347385 .",
    "elsevier .",
    "roverato , a. ( 2002 ) .",
    "`` hyper inverse wishart distribution for non - decomposable graphs and its application to bayesian inference for gaussian graphical models . '' _ scandinavian journal of statistics _",
    ", 29 : 391411 .",
    "rue , h. , martino , s. , and chopin , n. ( 2009 ) .",
    "`` approximate bayesian inference for latent gaussian models by using integrated nested laplace approximations . ''",
    "_ journal of the royal statistical society : series b ( statistical methodology ) _ , 71 : 319392 .",
    "spiegelhalter , d. , best , n. , carlin , b. , and van der  linde , a. ( 2002 ) .",
    "`` bayesian measures of model complexity and fit . ''",
    "_ journal of the royal statistical society : series  b ( statistical methodology ) _ , 64 : 583639 .",
    "ts and ad were supported in part by the national science foundation ( dms 1120255 ) .",
    "jw was supported by 2r01ca095994 - 05a1 from the national institutes of health .",
    "the authors thank the washington state cancer registry for providing the cancer incidence data and the referees for their helpful comments ."
  ],
  "abstract_text": [
    "<S> we present a bayesian model for area - level count data that uses gaussian random effects with a novel type of g - wishart prior on the inverse variance  covariance matrix . </S>",
    "<S> specifically , we introduce a new distribution called the truncated g - wishart distribution that has support over precision matrices that lead to positive associations between the random effects of neighboring regions while preserving conditional independence of non - neighboring regions . </S>",
    "<S> we describe markov chain monte carlo sampling algorithms for the truncated g - wishart prior in a disease mapping context and compare our results to bayesian hierarchical models based on intrinsic autoregression priors . </S>",
    "<S> a simulation study illustrates that using the truncated g - wishart prior improves over the intrinsic autoregressive priors when there are discontinuities in the disease risk surface . </S>",
    "<S> the new model is applied to an analysis of cancer incidence data in washington state .    </S>",
    "<S> ./style / arxiv - ba.cfg    ,    , </S>"
  ]
}