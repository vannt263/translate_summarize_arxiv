{
  "article_text": [
    "the now standard  wave - function monte carlo method \" for simulating the evolution of a quantum system undergoing decoherence is a very important numerical tool  @xcite .",
    "this method allows a simulation of the density matrix , an object of size @xmath0 where @xmath1 is the dimension of the system , to be replaced by a simulation of a number of pure states , each of which is only of size @xmath1 . with the increasing relevance of continuous measurement  @xcite and feedback control  @xcite to experimental quantum systems , especially in superconducting circuits  @xcite and nanomechanics  @xcite",
    ", one needs to simulate continuously measured systems subject to decoherence .",
    "the standard monte - carlo method can not be used in this case , because it applies to master equations but not to _ stochastic _ ( or conditional ) master equations ( sme s ) .    to date , two monte carlo methods have been devised for simulating conditional master equations , but both suffer limitations . the first is by gambetta and wiseman  @xcite , who used the linear formulation  @xcite of quantum trajectories to derive their method .",
    "the less desirable feature of this method is that it requires evolving a fraction of ensemble members that end up contributing negligibly to the final density matrix , and to this extent it is inefficient . the second method , recently suggested by hush et al .",
    "@xcite , is specifically designed for simulating systems with very large state - spaces , in which it is not possible to use wave - function methods .",
    "this requires the use of a quasi - probablity density , such as the wigner function , and is therefore not as simple to apply to many systems .",
    "further , the elements in the ensemble for this method are not wave - functions but points in phase space .",
    "this is important for very large state - spaces , but less desirable when wave - functions ( pure - states ) can be used . here",
    "we present a wave - function monte carlo method that avoids all the above issues .",
    "this method was used to perform the simulations in reference  @xcite , but the details were not presented there .    in the next section we state the standard monte carlo method for reference purposes . in section  [ sec::meth ]",
    "we present the new method with a minimum of discussion .",
    "the purpose is that this section should serve as an easily accessible reference for anyone wanting to implement the method .",
    "we also note that a parallel implementation using c++/mpi is available from the author s website  @xcite . in section  [ sec::deriv ]",
    "we show how the method is derived , and thus show that it reproduces the evolution of a stochastic master equation . in section  [ sec::num ]",
    "we use the method to simulate a measurement of the energy of a harmonic oscillator , and compare it to a direct simulation of the sme .",
    "section  [ sec::conc ] concludes with a summary of the results .",
    "in what follows , @xmath2 and @xmath3 are operators , @xmath4 is the density matrix , and @xmath5 is a wiener process , independent of any other wiener processes that may be introduced .",
    "the standard wave - function monte carlo method is implemented as follows(see , e.g.  @xcite ) . to simulate the master equation",
    "@xmath6 we perform the following steps :    \\1 .",
    "create a set of @xmath1 pure states @xmath7 , so that the desired initial value of @xmath4 is approximately @xmath8    \\2 .",
    "evolve each pure state by repeating the following steps ( i and ii ) :    \\i ) increment each state using the stochastic schrdiner equation ( sse ) @xmath9",
    "l |\\psi_n\\rangle dt \\nonumber \\\\    & &   +   \\sqrt{2\\gamma } l   |\\psi_n\\rangle dv_n , \\end{aligned}\\ ] ] where @xmath10 and the @xmath11 are mutually independent wiener noise increments satisfying @xmath12 .",
    "\\ii ) normalize each of the @xmath7 .",
    "the density matrix at time @xmath13 is ( approximately ) @xmath14",
    "the conditional ( stochastic ) master equation @xmath15 describes a measurement of @xmath3 , and decoherence due to an interaction with @xmath2 .    to simulate the above sme we perform the following steps :    \\1 .",
    "create a set of @xmath1 pure states , and @xmath1 probabilities @xmath16 , so that the desired initial value of @xmath4 is approximately @xmath17 since the @xmath16 are the weightings of the pure states in the ensemble that forms @xmath4 , the effective size of the ensemble is no longer @xmath1 , but can be characterized , for example , by the exponential of the von neumann entropy of the set @xmath18 : @xmath19   \\leq n .",
    "\\end{aligned}\\ ] ] this effective size is maximized ( equal to @xmath1 ) iff all the @xmath16 are equal to @xmath20 .",
    "we therefore choose @xmath21 as the initial values of the weightings .",
    "evolve each pure state by repeating the following steps ( i  vii ) :    \\i ) increment each state using the sse @xmath22 l |\\psi_n\\rangle dt \\nonumber \\\\    & &   +   \\sqrt{2\\gamma } l   |\\psi_n\\rangle dv_n , \\end{aligned}\\ ] ] where @xmath10 and the @xmath11 are mutually independent wiener noise increments satisfying @xmath12 .",
    "\\ii ) normalize each of the @xmath7 .",
    "\\iii ) increment each state by @xmath23 m |\\psi_n\\rangle dt \\nonumber \\\\        & &   +   \\sqrt{2\\gamma } m   |\\psi_n\\rangle dw , \\end{aligned}\\ ] ] where @xmath24    \\iv ) update the probabilities @xmath16 using @xmath25    \\v ) normalize the @xmath16 : @xmath26    \\vi ) normalize each of the @xmath7 .",
    "\\vii ) every few iterations perform the following operation ( which might be referred to as  splitting \" ,  breeding \" , or  regenerating \" the ensemble ) : for each pure state whose probability @xmath27 is less than a fixed threshold @xmath28 , we pick the state from the ensemble , @xmath29 , whose probability , @xmath30 , is currently the largest in the ensemble .",
    "we then set @xmath31 equal to @xmath29 , thus erasing @xmath31 from the ensemble .",
    "we set both @xmath27 and @xmath30 equal to @xmath32 .",
    "thus we have  split \" the highest probability state into two members of the ensemble , and this state is ( most likely ) no longer the highest contributing member .",
    "after we have done this for each @xmath33 , we then normalize all the @xmath16 as per v ) above .",
    "the density matrix at time @xmath13 is ( approximately ) @xmath34      in the standard monte carlo method the only parameter that we must chose to reach a desired accuracy is @xmath1 ; we merely increase @xmath1 until we obtain this accuracy . for the new monte carlo method we have _ two _ parameters that affect the error .",
    "the first is the minimum effective ensemble size during the evolution , @xmath35 .",
    "the second comes from the regeneration step . in each regeneration",
    "we eliminate some states .",
    "if we denote sum of the probabilities for these  dropped \" states as @xmath36 , then the maximum value of @xmath36 during the simulation bounds the error from the regeneration step .",
    "so to ensure numerical accuracy we require that @xmath37 the values of these two quantities are determined jointly by @xmath1 and @xmath38 . for a given value of @xmath1 , there is some optimal value of @xmath38 that ensures that @xmath35 is large while keeping @xmath39 small .    for a given simulation",
    "it is simple to check whether @xmath1 and @xmath38 give sufficient accuracy .",
    "one merely runs the simulation a second time with the same realization for the measurement noise @xmath5 , and different set of realizations for the noises that model the decoherence , @xmath40 .",
    "the difference between the two simulations gives one an estimate of the error .      for simplicity we presented the monte carlo method for an sme with only a single source of decoherence and single measurement .",
    "extending this to @xmath41 sources of decoherence and @xmath42 measurements is very simple .",
    "a system subjected to @xmath42 continuous measurements and @xmath41 sources of decoherence is described by the sme @xmath43 where the @xmath44 are mutually independent wiener processes . to simulate",
    "this sme one simply repeats steps 2 .",
    "i and ii for each of the @xmath41 decoherence channels , and steps 2 .",
    "iii - vi for each of the @xmath42 measurement channels .",
    "the form of the sme given in eq.([smem ] ) above is general enough to include inefficient measurements  @xcite . to make the @xmath45 measurement inefficient we simply choose one of the @xmath46 to be equal to @xmath47 , and adjust the values of the corresponding @xmath48 and @xmath49 to obtain the desired efficiency",
    "if one simulates a stochastic differential equation ( sde ) simply by replacing @xmath50 with a small time - step @xmath51 , and @xmath5 by a zero mean gaussian random variable with variance @xmath51 ( which we will call @xmath52 ) , then the solution is only guaranteed to be accurate to half - order in @xmath51 . ensuring that the simulation is accurate to first - order in @xmath51 is simple , and the method for doing this is called _",
    "miltstien s _ method .",
    "milstein s method involves adding a term to the differential equation that is proportional to @xmath53 .",
    "the exact form of the milstien term depends on the form of the stochastic term in the sde .",
    "if the stochastic term is simply a linear operation , the this term is given by applying the linear operation twice , and multiplying by one half  @xcite .",
    "thus , the milstien term for an sde with the stochastic term @xmath54 , for a number @xmath55 and operator @xmath56 , is @xmath57",
    "we begin by noting that if we apply the part of the evolution containing @xmath2 first , and that containing @xmath3 second , we get the evolution correct to first - order in @xmath50 . if the density matrix is given by @xmath58 , then the @xmath2 part of the evolution is obtained by using the standard monte carlo method ( steps 2 .",
    "i and ii above ) . to simulate the part containing @xmath3 ( the measurement part ) , we note that this evolution can be written as  @xcite @xmath59 where @xmath60 is an operator that depends on the measurement result , @xmath55 , and @xmath61 is simply an overall normalization factor .",
    "the measurement result @xmath55 is the real number @xmath62 by substituting @xmath63 into eq.([eqa ] ) , we find that @xmath64 \\nonumber \\\\        & = & \\sum_{n=1}^n p_n(t+dt ) |\\psi_n ( t+dt ) \\rangle \\langle \\psi_n ( t+dt ) | , \\nonumber \\end{aligned}\\ ] ] which gives us the simple update rules @xmath65 where @xmath1 is chosen so that @xmath66 . from eq.(29 ) in reference  @xcite , the operator @xmath60 is @xmath67 m dt + \\sqrt{2\\gamma } m   dw , \\end{aligned}\\ ] ] and this gives us the evolution sequence for the monte carlo method presented above .",
    "the effect of the measurement is to increase the probabilities of some states , and reduce those of others .",
    "this reduces the effective size of the ensemble , and before too long there will only be one state left in the ensemble . to correctly model the noise being introduced into the system by the decoherence ( the part of the evolution containing @xmath2 ) we need to maintain a large number of states in the ensemble .",
    "we solve this problem by using the  regeneration \" procedure ( step 2 .",
    "once every so - often we discard those states from the ensemble whose probabilities , and thus contribution , has become negligible .",
    "this discarding process does not effect the density matrix unduly so long as the total amount of probability of the discarded states is very small .",
    "once the  small \" states have been discarded , we must choose new states to replace them , and we must do this without affecting the density matrix .",
    "this is easily achieved by duplicating some of the states that have a large contribution , and dividing the probability for each of these states equally between the original state and its duplicate .",
    "one should duplicate the states with highest probability , as this provides the biggest increase in the effective size of the ensemble . with the addition of this regeneration procedure ,",
    "our monte carlo method is complete .",
    "here we simulate a continuous measurement of the energy of a harmonic oscillator , using both the sme and the monte carlo method .",
    "we subject the oscillator to a randomly fluctuating white noise force , which serves as a simple model of ( infinite temperature ) thermal noise .",
    "the evolution due to the fluctuating force is given by  @xcite @xmath68 |\\psi\\rangle , \\ ] ] where @xmath69 determines the strength of the force .",
    "the term in this equation proportional to @xmath50 is due to the transformation from stratonovich to ito noise .",
    "since the observer does not know the fluctuating value of the force , she must average over it .",
    "the evolution of the observer s density matrix is then given by the master equation @xmath70 dt .\\ ] ] adding to this the evolution due the continuous measurement of energy ( equivalently a continuous measurement of the phonon number , @xmath71 ) , and the hamiltonian evolution , the sme is @xmath72 dt - \\frac{\\beta}{2 }   [ x,[x,\\rho ] ] dt - k [ n , [ n,\\rho ] ] dt   \\nonumber \\\\       & & + \\sqrt{2k}(n \\rho + \\rho n - 2 \\langle n \\rangle \\rho ) dw .",
    "\\end{aligned}\\ ] ] here @xmath73 is the frequency of the oscillator , @xmath74 is the dimensionless position , and @xmath75 is the measurement strength .",
    "we simulate this equation using the unnormalized version @xmath72 dt - \\frac{\\beta}{2 } [ x,[x,\\rho ] ] dt - k [ n , [ n,\\rho ] ] dt   \\nonumber \\\\       & & + ( n \\rho + \\rho n)(4k\\langle n \\rangle dt + \\sqrt{2k } dw ) \\nonumber \\\\       & & + k(dw^2 - dt)(n^2 \\rho + \\rho n^2 + 2 n \\rho n ) ,       \\label{eq::smesim}\\end{aligned}\\ ] ] and normalizing @xmath4 after each time - step .",
    "the reason we use this unnormalized version , which you will note is the same unnormalized version that we use for the wave - function in the monte carlo method , is that it makes the noise term in the sme linear in @xmath4 , which in turn makes the milstien term simpler to calculate . in the above equation",
    "the milstien term is the final term .",
    "since this equation is only accurate to first - order in the noise part of the evolution , we have also only included a first - order term for the deterministic evolution due to the hamiltonian .",
    "the corresponding evolution for the monte carlo wave function is @xmath76 dt |\\psi\\rangle \\\\      & & + ( 4k \\langle n \\rangle dt + \\sqrt{2k } dw ) n |\\psi\\rangle + i \\sqrt{\\beta } x dv |\\psi\\rangle \\nonumber \\\\       & & + k ( dw^2 - dt ) n^2 |\\psi\\rangle + \\frac{\\beta}{2 } ( dv^2 - dt )   x^2 |\\psi\\rangle \\nonumber ,   \\end{aligned}\\ ] ] where @xmath77 is uncorrelated with @xmath5 .",
    ", for a continuous measurement of @xmath1 , for an oscillator driven by a white - noise force .",
    "( a ) a direct simulation of the sme ( black line ) and a simulation using the monte carlo method ( grey line ( blue online ) ) . in this case",
    "the time - step is @xmath78 , and the ensemble has @xmath79 members .",
    "( b ) a zoomed - in version of the monte carlo simulation in ( a ) ( medium grey line ( blue online ) ) ; a direct simulation of the sme with half the time - step ( black line ) ; and the mc simulation with half the time - step ( light grey line ) . [ fig1 ] ]    we now simulate the sme , using both eq.([eq::smesim ] ) and the monte carlo method , and compare the results . for this simulation",
    "we set @xmath80 ( where @xmath81 ) , start the oscillator in the fock state with three phonons .",
    "we use a fock - state basis , and truncate the state space at @xmath82 phonons . for our first run",
    "we choose @xmath83 , and run for a time of @xmath84 . for the monte carlo run we choose the ensemble size to be @xmath85 , and @xmath86 .",
    "this choice results in @xmath87 and @xmath88 .",
    "we plot the expectation value of the phonon number for both simulations in fig .",
    "we see that the results agree , but the solutions slowly diverge . to determine the source of this divergence we perform to more simulations . for the first one we double the size of the ensemble , and for the second we halve the time - step .",
    "note that when we halve the time - step , we must use a noise realization that is consistent with that used for the first run , so that we can directly compare the trajectories in both cases  @xcite .",
    "we find that doubling the size of the ensemble has little effect on the result of the monte carlo simulation .",
    "halving the time - step , on the other hand , reduces the divergence between the two simulations considerably . in fig .",
    "[ fig1]b we plot the direct simulation of the sme using the smaller time - step , along with the monte carlo simulations using both time - steps . this plot is zoomed - in version of the trajectory in fig  [ fig1]b .",
    "these results show us that the ensemble size of @xmath79 is sufficient for this simulation , the inaccuracy being due almost entirely to the finite size of the time - step .",
    "we have presented a wave - function monte carlo method for simulating systems that are under continuous observation , while also being subjected to noise and decoherence .",
    "this method is more efficient than the previously available method  @xcite .",
    "we have also applied it to an example system , determining in this case sufficient resources to reproduce the sme .    _",
    "note added : _ upon writing up this work , we discovered that a key element , that of  splitting \" the ensemble , had been introduced previously by trivedi and ceperley for monte carlo simulations of classical systems .",
    "see  @xcite .",
    "the author acknowledges the use of the supercomputing facilities in the school of science and mathematics at umass boston , as well as prof .",
    "daniel steck s parallel cluster at the university of oregon and the oregon center for optics , which was funded by the national science foundation under project no .  phy-0547926 .",
    "this work was also supported by the national science foundation under project no .",
    "phy-0902906 .",
    "g. c. hegerfeldt and t. s. wilser , in h. d. doebner , w. scherer , and f. schroeck , eds . ,",
    "classical and quantum systems , proceedings of the second international wigner symposium , p. 104",
    "( world scientific , singapore , 1992 ) ."
  ],
  "abstract_text": [
    "<S> wave - function monte carlo methods are an important tool for simulating quantum systems , but the standard method can not be used to simulate decoherence in continuously measured systems . here </S>",
    "<S> we present a new monte carlo method for such systems . </S>",
    "<S> this was used to perform the simulations of a continuously measured nano - resonator in [ phys . </S>",
    "<S> rev . </S>",
    "<S> lett . * 102 * , 057208 ( 2009 ) ] . </S>"
  ]
}