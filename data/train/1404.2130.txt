{
  "article_text": [
    "periodic boundary conditions ( pbc ) and their use in supercell geometries constitute a most efficient approach to bulk and surface electronic structure calculations of solids . while focusing the computational effort on the finite supercell , this approach elegantly captures e.g. long - range electrostatic effects and in particular the delocalized electronic bonding in metallic systems .",
    "much of this elegance and efficiency is lost though in the application to localized perturbations of the lattice periodicity , for instance in form of defects or adsorbates .",
    "large supercells are then needed to suppress spurious interactions with periodic images , and for explicitly charged systems intricate correction schemes are required to reach convergence with respect to supercell size at all @xcite . for non - metallic systems",
    "this has long motivated an alternative solid - state embedding approach in form of hybrid quantum and molecular mechanical ( qm / mm ) calculations @xcite . here",
    ", a finite `` quantum region '' is embedded in a surrounding environment , generally modelled using classical molecular mechanics ( `` mm region '' ) .",
    "such aperiodic embedded - cluster models do not suffer from spurious interactions between defects , adsorbates and charges .",
    "simultaneously , the extended mm environment ensures correct long - range electrostatics and elasticity , and mitigates quantum confinement effects in comparison to approaches based on bare or hydrogen - saturated clusters .",
    "the exploration of advanced density - functional theory ( dft ) exchange - correlation ( xc ) functionals for solid - state applications adds another motivation for the qm / mm ansatz . with",
    "computationally particularly efficient implementations presently achieved for localized basis sets and finite systems , solid - state embedding promises unprecedented access to extended systems . with this objective ,",
    "we here present a qm / mm implementation integrating the fhi - aims program package @xcite into the general chemshell framework @xcite . exploiting tailored numeric atomic orbital ( nao ) basis sets@xcite ,",
    "the resolution - of - identity technique @xcite and massively parallel algorithms @xcite fhi - aims offers a wealth of tractable functionality beyond semi - local dft .",
    "this includes in particular exact exchange and second order perturbation theory ( pt2)@xcite , rendering fhi - aims an ideal platform to test the performance of hybrid and double hybrid xc functionals . on the other side ,",
    "chemshell is a powerful computational chemistry environment , which takes over the communication and data handling in hybrid qm / mm calculations . for solid state embedding in particular , chemshell allows the use of polarizable core - shell model potentials to fit the electrostatic potential to that of a periodic calculation @xcite .    in order to prevent spurious charge leakage out of the qm and into the mm region , solid - state embedding often requires the introduction of an intermediate shell at the qm boundary . in this shell",
    "all cations are replaced by effective core potentials , which prevent the spurious overpolarization of the electron density through adjacent bare positive mm charges , i.e. a spurious charge leakage into the mm region . a major part of the fhi - aims  chemshell coupling therefore concerns the implementation of efficient pseudopotential ( pp ) functionality into the all - electron full - potential code fhi - aims . tailored to the nao basis sets of fhi - aims we specifically achieve this through norm - conserving pps of kleinman - bylander type @xcite .",
    "the performance and validity of the resulting qm / mm implementation is demonstrated using fe - substituted zsm-5 zeolites and the tio@xmath0(110 ) surface as examples for semi - covalent and ionic systems , respectively .",
    "for the former , the purely electrostatic embedding is successfully benchmarked against previous qm / mm calculations using the gamess - uk package for the qm calculations @xcite . for the latter ,",
    "we exploit the fhi - aims capability of calculating finite and periodic systems within the same numerical framework and systematically compare the solid - state embedding against pbc slab calculations .",
    "both for reduction potentials of fe in fe - substituted zsm-5 and adsorption energies of reaction intermediates in the ( photo-)catalytic water oxidation at tio@xmath0(110 ) the obtained results underscore the importance of capturing the long - range electrostatics of the extended systems and the need to scrutinize more readily available semi - local dft energetics .",
    "the embedded - cluster models used in the qm / mm chemshell calculations generally consist of multiple concentric regions , each of which is described using more approximate methods as one moves further from the center of the cluster , as illustrated in figure [ fig1 ] .",
    "the central region of the embedded cluster is described quantum mechanically , with the applied level of theory being dft , hartree - fock ( hf ) or higher post - hf as offered by the employed qm calculator .",
    "atoms in the outer mm regions are treated at the level of interatomic potentials and are represented within the qm calculations as external point charges .",
    "the mm region is typically divided into an inner `` active '' part , where atoms are allowed to relax their positions , and an outer part where atoms are constrained to their lattice positions .",
    "shell model potentials can be employed in the mm region for an accurate treatment of polarizable materials .",
    "a final exterior shell of point charges is added to the embedded cluster , with the point charges fitted to reproduce the full electrostatic embedding potential of an infinite bulk reference calculation within the regions of physical and/or chemical interest ( the `` active '' region ) @xcite .",
    "this zero - reference potential for a given extended `` perfect '' system can be e.g. the bulk of a three - dimensional periodic solid , i.e. a crystal , or one of its surfaces or interfaces with another material or solvent . in this way a common absolute potential reference is provided for all embedded - cluster calculations .",
    "the latter is of special importance when modelling atomic and electronic processes involving a change in the charge ( oxidation ) state or comparing systems in different charge states .",
    "for example , calculation of defect levels in semiconductors and insulators that represent energies of defect ionisation with electrons or holes becoming delocalised over conduction states depend crucially on this property .",
    "another example is given by complementary oxidation - reduction cycles in acid - base and redox chemistry in solutions that involve ions or electrons to be removed or added to the system from remote locations . in all of these cases , a straightforward summation of the electrostatic contributions to the potential over a neutral extended system is typically performed using ewald - like techniques @xcite .",
    "the values of this potential on a grid of points spanning the active region serve then as reference for the embedded cluster model , i.e. the values of the point charges around the embedded cluster are fitted to reproduce optimally the potential of the extended reference calculation .",
    "the energy of the qm region , @xmath1 , thus combines the actual qm hamiltonian ( @xmath2 ) with the surrounding environment : @xmath3 where @xmath4 is the external embedding potential acting on @xmath5 from the surrounding point charges , and @xmath6 is the coloumbic interaction between the qm nuclei and the mm charges . for covalently",
    "bound , or semi - covalent / semi - ionic systems such as siliceous frameworks , saturation of dangling bonds on the exterior of the qm region with `` link''-atoms is a commonly used methodology @xcite .",
    "such a setup is sufficient for strongly covalent materials with directional bonds , for example , of a @xmath7 character .",
    "however , in the case of heteropolar semiconductors and ionic insulators , direct linkage of the field of mm point charges with the qm region as in eq .",
    "( [ eq1 ] ) results in a spurious overpolarization of the wavefunction , aka a charge leakage towards the attractive cations of the immediately surrounding mm region . in this instance",
    ", the introduction of a boundary region is necessary between qm and mm atoms . in the present work",
    "this is realized by replacing the cationic point charges in an intermediate shell surrounding the qm region with norm - conserving pps of kleinman - bylander type mimicking the corresponding ions .",
    "the energy of the qm region then reads : @xmath8 where @xmath9 is the potential acting on @xmath5 in form of the pps .",
    "the mm energy term ( @xmath10 ) , discussed in detail previously @xcite , depends on the problem being addressed , with the chemshell package accommodating various forms : the general utility lattice program ( gulp ) offers comprehensive mm functionality , especially in the implementations for strongly polarisable materials such as ionic oxides @xcite ; an alternative such as dl_poly provides excellent parallelisation of larger molecular dynamics problems , and contains forcefield implementations more suited for semi - covalent systems @xcite .",
    "the total energy ( @xmath11 ) of the embedded - cluster system is finally given by simple additive definition : @xmath12    chemshell manages the properties of an embedded cluster during calculations , outsourcing the calculation of energy and force terms through the varied qm and mm interfaces .",
    "the program couples a number of quantum chemistry and classical forcefield software packages : in a given geometry the qm driver computes the energy as given in eqs .",
    "( [ eq1 ] ) or ( [ eq2 ] ) , and the forces acting on all particles ( atoms , pps and point charges ) .",
    "the forcefield software then evaluates further forces on point charges , and geometry optimisation is performed using the dl - find routine @xcite .",
    "iteratively , this leads to self - consistent embedding and polarization . in this work we use the fhi - aims package for the qm calculations and modified it to be run as a library package rather than runtime executable . for the mm",
    "calculations gulp and dl_poly are used for the ionic and semi - covalently bound showcase systems , respectively .",
    "fhi - aims is a full - potential all - electron electronic structure theory package providing both dft and `` beyond - dft '' functionality @xcite .",
    "notably , this comprises efficient treatments beyond standard semi - local dft , such as bare or screened single - determinant exchange ; quantum - chemical perturbation theory for the coulomb interaction , e.g. , second - order mller - plesset ( mp2 ) perturbation theory , bare ( mp2 ) or screened ( gw ) self - energies for single - electron excitation energies ; or the random - phase approximation ( rpa ) in the adiabatic connection fluctuation dissipation theorem .",
    "it is based oni hierarchical sets of all - electron atom - centered nao basis functions of the form @xmath13 where @xmath14 are the spherical harmonics , and the radial functions @xmath15 are numerically tabulated and therefore fully flexible .",
    "each basis function is strictly localized inside a given radius , which enables a highly efficient computation of both finite and ( within pbcs ) infinite systems within the same numerical framework",
    ". the regular basis set levels ( called tiers , i.e. tier1 , tier2 , @xmath16 ) , as well as the recent valence - correlation consistent nao - vcc - nz basis sets for light elements @xcite are constructed to enable systematic accuracy improvements from fast qualitative to mev per atom .",
    "radial functions are integrated on a dense one - dimensional grid with logarithmic spacing .",
    "global integration is efficiently achieved on a sparser three - dimensional concatenation of atom - centered grids @xcite ( see ref . for details of the present implementation ) . converting between logarthimic and global integration grid",
    "is done by using cubic splines .",
    "when working with embedding potentials ( particularly , bare monopoles ) inside the range of other integrands ( e.g. , the kohn - sham hamiltonian matrix elements ) , these singularities must be integrated accurately , e.g. , by placing an additional atom - centered grid on the site of the embedding potential .    with analytic forces",
    "provided , the major effort in the interfacing of fhi - aims with the chemshell environment is the implementation of pp - functionality to describe cations at the boundary between the qm and mm region . for numerical efficiency reasons described below , we opt for normconserving pps of kleinman - bylander type @xcite . in general",
    ", pps are constructed to replace the atomic all - electron potential such that core states are eliminated and the then missing orthogonalization constraint of valence and core wavefunctions is achieved through appropriate scattering properties of the pp @xcite . in a real - space representation convenient to use with localized basis sets ,",
    "this energy - dependent scattering is expressed by a dependence on the angular momentum , @xmath17 for every angular momentum @xmath18 up to a maximum @xmath19 , usually 2 or 3 , there is thus a different spherically - symmetric pp channel @xmath20 with corresponding eigenfunctions @xmath21 the radial functions @xmath22 as well as",
    "the potentials @xmath23 are commonly tabulated on a logarithmic grid .",
    "our implementation is specifically tailored to read the tabulated format of the * .cpi pp files provided with the fhi98pp package @xcite . in principle ,",
    "any kind of pp can be used though , as long as it is made available in the * .cpi format of fhi98pp .",
    "an almost complete database of pps is e.g. available on the abinit webpage @xcite .    mimicking an ion with a net charge , all pp channels",
    "@xmath20 must embody the same coulomb behaviour and are thus independent of the angular momentum in the far field , i.e. all @xmath20 are the same outside the core radius @xmath24 of the pp by construction .",
    "one channel can thus be chosen to embody all ionic long - range behavior .",
    "this local potential @xmath25 then acts on all electrons independent of their angular momentum , while the remaining channels @xmath26 are now short - ranged with @xmath27 for @xmath28 .",
    "mathematically , the choice of the local component is hereby arbitrary . in practice",
    "a proper choice is crucial for the performance and transferability of the pp @xcite .",
    "for instance , the routine pswatch in the fhi98pp package provides full analysis capabilities according to rigorous criteria by gonze _",
    "_ @xcite .    numerically , it is most convenient to further transform the pp into the fully separable form of kleinman - bylander , where the short - ranged part @xmath29 is a fully nonlocal operator in @xmath30-space @xcite @xmath31 here , the projector functions @xmath32 are defined as @xmath33 with energies @xmath34    the local potential part is straightforward to implement .",
    "it is mapped from the ( finite ) logarithmic grid around the pp center onto the global integration grid with the help of cubic splines @xcite , and its long - range part beyond the limits of the atom - centered grid is extrapolated by its coulombic behavior ( formal charge over distance ) . in the evaluation of the hamiltonian matrix , @xmath35",
    "is then evaluated exactly like all other local potentials .",
    "the general matrix expression of the nonlocal potential involves the evaluation of a sum over the projections of every basis function @xmath36 on to every kleinman - bylander projector function @xmath32 @xmath37 for a given geometry , this matrix is computed once and is added to the hamiltonian matrix @xmath38 in every iteration in the self - consistent field ( scf ) cycle .",
    "the strength of the kleinman - bylander formalism lies generally in its scaling behavior . rather than having to evaluate and store all @xmath39 matrix elements , resulting in @xmath40 scaling with the number of basis functions , the fully separable kb form only requires evaluation and storage of @xmath41 projections with @xmath42 the ( small ) number of kb projector functions .",
    "in case of atom - centered basis sets the projections @xmath43 correspond furthermore to a two - center integral of basis function @xmath44 of atom @xmath45 at @xmath46 and @xmath47 of pp @xmath48 at @xmath49 .",
    "the explicit expression to be evaluated is then : @xmath50 which can be most efficiently computed with the help of spherical bessel transformations@xcite already implemented in fhi - aims @xcite .",
    "again , the radial functions @xmath22 and the potential @xmath20 , respectively potential differences @xmath51 of the projector are pretabulated in * .cpi format and provided as input for each relevant element . the total number of overlap integrals that needs to be computed at all is further reduced by locality , as overlap integrals are exactly zero if the distance of the involved atom centers exceeds a maximum value .",
    "this maximum value is given by the maximum extension of any basis function plus the maximum extension of any kb projector function , and is typically in the range of 8 .    for geometry optimization , molecular dynamics or vibrational analysis ,",
    "force contributions on the pp with formal charge @xmath52 and centered at position @xmath49 also need to be evaluated .",
    "hellman - feynman contributions arise from the embedding of the pp into the electrostatic fields of the electron density and all other nuclei in the qm region at positions @xmath46 and with charges @xmath53 @xmath54 here , @xmath55 is the gradient of @xmath35 with respect to the position @xmath56 and is needed on every global integration grid point .",
    "this is efficiently computed from a cubic spline interpolation of @xmath35 created before entering the scf cycle .",
    "analogous to the first term in eq .",
    "( [ formular : local_force ] ) , the coulomb interaction between nuclei and pps gives rise to a force term of the same shape that complements the general qm - force expression for atoms in fhi - aims ( eqs .",
    "( 69 ) and ( 71 - 75 ) in ref . ) . as written and implemented , eq .",
    "( 12 ) will work for non - periodic geometries . for periodic geometries , a formalism analogous to eq .",
    "( 70 ) in ref . would have to be adopted .",
    "the overlap , eq .",
    "( [ formular : projection_full ] ) , between any basis function and a kb - projector function @xmath47 of the pp @xmath48 at @xmath56 is a function of @xmath56 .",
    "this gives rise to a force acting on the pp , @xmath57 where @xmath58 is the occupation number of kohn - sham state @xmath59 , and @xmath60 is the density matrix . @xmath61,@xmath62 and @xmath63 are the subspaces of projector respectively basis functions belonging to pp @xmath48 and atoms @xmath45 and @xmath64 , respectively .",
    "again , derivatives of overlaps only have to be calculated for those pairs of functions , which have a non - zero overlap . since the overlap , eq .",
    "( [ formular : projection_full ] ) , is also a function of the position of atom @xmath45 , this gives reciprocally rise to a negative force acting on atom @xmath45 complementing the general force expression on atoms .    in order to compute the hartree potential ,",
    "fhi - aims follows the strategy of an atom - centered multipole ( mp ) decomposition as introduced by delley @xcite . here",
    ", the density difference to a sum - over - free - atom density is partitioned into atom - centered components on the integration grid shells centered around individual atoms @xcite . applying a mp decomposition to these atom - centered components leads ( together with the known mps of the free - atom density components ) to the total mp components of the hartree potential . @xcite .",
    "although the ionic pps do not introduce any electron density of their own , they do act as integration grid centers and are thus included into the partitioning . as a result ,",
    "some electron density components are assigned to the pps , even when no basis functions are centered at the position of the pp .",
    "the mp expansion always introduces an error @xmath65 though , as the expansion is truncated beyond a maximum angular momentum @xmath66 .",
    "this error leads to a net force @xcite , @xmath67 \\boldsymbol{\\nabla}_i v^{\\rm loc}(\\boldsymbol{r})\\ ] ] as the missing multipole terms move with the position of the center .",
    "for a first demonstration of the established qm / mm embedded - cluster framework we address the zeolite zsm-5 as an example for a semi - covalent system , where neither embedding pps nor a polarizable mm environment are required .",
    "zsm-5 is commonly used in catalytic applications @xcite , and has previously been the subject of investigations with the chemshell package coupled with the qm calculator gamess - uk @xcite .",
    "belonging to the mfi structural family , zsm-5 is a porous aluminium silicate framework ( sio@xmath68 building units with al - substitutions ) , which can be further doped with catalytically active transition metals such as fe and ti @xcite .",
    "quantifying the reaction energetics at such transition metal centers is then an obvious milestone on the route to improved catalyst design .",
    "the accurate calculation of corresponding energies has proven problematic though , due to the difficulty in accounting for both the extended bulk framework and the electron localization around the active site . as semi - local dft",
    "does not appropriately accomplish the latter ( _ vide infra _ ) , calculations at hybrid xc level are at least required . existing work for fe ",
    "zsm5 at this level of theory has hitherto been restricted to finite fragments that only reproduce the active site of the catalyst @xcite .",
    "as the surrounding framework undoubtedly does have an influence on the electrostatic potential at the active site @xcite , efficient qm / mm calculations are an ideal tool that in combination with powerful qm calculators such as fhi - aims also allows to assess the performance of advanced functionals . here",
    ", we illustrate this approach by calculating the reduction potential for intra - framework fe@xmath69 sites in mfi using semi - local , hybrid and double - hybrid functionals .",
    "double - hybrid functionals such as xyg3 @xcite are still rather uncommon in the application to extended systems , while their implicit ability to improve electron localisation could render them particularly appealing for systems such as fe  zsm-5 .",
    "we construct three different embedded clusters from the undoped parent mfi framework , each centered on a tetrahedral si atom ( t - sites ) of differing structural nature within a framework active site @xcite : a t - site at a straight channel ( m7-t1 ) , at a sinusoidal channel ( z6-t4 ) and at a channel intersection ( i2-t12 ) , cf .",
    "[ fig2 ] . around this central atom",
    "the qm region includes all other members of the active site , as well as any extra si atoms that are first neighbours to the active site , and all the corresponding linking oxygen atoms .",
    "all incomplete bonds from the oxygen atoms are saturated with h link - atoms , and a bond - dipole correction is added to the mm representation @xcite .",
    "concentric regions of mm atoms are then added ; first an active region up to a radius of 10.58 ( 20 bohr ) and then a fixed region up to a radius of 21.17 ( 40 bohr ) .",
    "this results in a total number of atoms in the embedded clusters in the range 2155  2180 .",
    "the mm interactions are represented using the forcefield of hill and sauer @xcite , and energy/ force calculations are performed using the dl_poly package . the accuracy of the fhi - aims  chemshell coupling is validated by calculating the same embedded clusters also with gamess - uk as qm calculator , and using the same tzvp gaussian basis sets of ahlrichs and taylor @xcite in both qm codes . at the pbe @xcite xc level of theory and",
    "using converged integration grid settings in both codes differences in total energies are below 18mev for each cluster , while forces on qm atoms differ by less than 0.05ev /  .    with this confidence , production calculations with fhi - aims",
    "are henceforth performed with the code s own numerical basis sets .",
    "for the three embedded clusters at pbe level , already tier1 leads hereby to total energies lower by 1ev than for the tzvp basis set , demonstrating the better description of e.g. the near - nuclear potential and kinetic energy integrals by the purposely designed nao basis sets .",
    "the fe@xmath70 active center is introduced to the embedded clusters by replacing the central si atom .",
    "the reduced fe@xmath71 state is described by coordinating an additional h atom to an o atom directly adjacent to the central fe species .",
    "the reduction potential can then be defined as @xmath72 where @xmath73 ) is the energy of a gas - phase hydrogen dimer .",
    "calculations are performed for the semi - local pbe and blyp , for the hybrid pbe0 and b3lyp , as well as for the double - hybrid xyg3 functionals @xcite .",
    "all geometries are fully relaxed at the corresponding semi - local level , with hybrid and double - hybrid calculations performed on these geometries , and specifically those of the according correlation treatment ( i.e. b3lyp and xyg3 on the blyp geometry , pbe0 on the pbe geometry ) .",
    "the xyg3 calculations are furthermore performed post - scf on the optimized b3lyp kohn - sham orbitals . at tier2 basis",
    "set level the obtained reduction potentials are already numerically converged to within 1 mev for the semi - local and hybrid functionals . at the double hybrid - level a sufficient convergence to within @xmath74mev",
    "can instead only be reached using the tier3 basis set for fe and for all other ( light ) species the nao - vcc-4z basis set that specifically converges the unoccupied - space sums @xcite .",
    "the more diffuse functions contained in this basis set then require an ensuing counterpoise correction @xcite though .",
    "lccc & m7-t1 & z6-t4 & i2-t12 +   + @xmath75(fe@xmath76 ) & -0.18 & -0.16 & -0.18 + @xmath77(fe@xmath76 ) & -0.29 & -0.39 & -0.17 + @xmath78(fe@xmath76 ) & -0.05 & 0.04 & -0.03 + @xmath79(fe@xmath76 ) & -0.09 & 0.01 & -0.02 + @xmath80(fe@xmath76 ) & -0.34 & -0.20 & -0.18 +   +    table [ table1 ] compiles the obtained reduction potentials for fe at the three structural sites in the mfi framework . at all levels of theory",
    "the differences between these three sites are very small , indicating a low structure sensitivity for the catalytic properties of the active center .",
    "this structure insensitivity warrants to directly compare to previous experimental voltammetry by prez - ramrez _ et al .",
    "_ , which gave very small reduction energies for intra - framework fe@xmath70 of the order 0.05ev @xmath81(fe@xmath76 ) @xmath82ev @xcite",
    ". there is , thus , a huge effect induced by the siliceous framework , when considering that the corresponding reduction potential of fe@xmath70 in a hexagonally coordinated [ fe(h@xmath68o)@xmath83@xmath70 complex was for instance calculated as 1.07ev at pbe level @xcite .",
    "this framework effect is well captured by essentially all xc levels studied , which in good overall agreement with the experimental findings yield small reduction potentials scattering around zero .",
    "more specifically , the majority of the xc - treatments agrees that the reduction potential is negative , indicating stability for fe(ii ) in the material .",
    "interestingly , the double - hybrid functional xyg3 yields reduction potentials closer to the ones at the semi - local ( blyp ) level , and thus makes up for most of the change observed at the hybrid ( b3lyp ) functional level .",
    "at least within the small scatter of table [ table1 ] there is thus no clear trend in the calculated reduction potentials that would prominently reflect the allegedly gradually increasing electron localization achieved in the sequence blyp @xmath84 b3lyp @xmath84 xyg3 .      as a show case application to a polarizable material , where both effective core potentials at the qm / mm boundary and core - shell potentials in the mm region are essential",
    ", we next consider the tio@xmath0(110 ) surface . among many other applications ,",
    "this semiconductor catalyst is particularly known for its ability to oxidize water using light @xcite .",
    "the desire for a molecular - level understanding of this intriguing property motivates detailed mechanistic studies unraveling the chemical steps involved . in surface science studies",
    "especially , the rutile tio@xmath0(110 ) surface has been frequently studied @xcite , with recent theoretical work considering a reaction mechanisms including an ooh intermediate on a defect - free surface @xcite .",
    "characteristic for the field of surface catalysis , these calculations were performed at the semi - local dft level , specifically with the rpbe @xcite functional .",
    "arguably because of its acceptable description of hydrogen bonds , this functional has been frequently employed in the context of water dissociation and photocatalysis at tio@xmath0 @xcite , but , of course , as a gga functional it still suffers from the well - known electron delocalization problems . the possibility to perform hybrid and double - hybrid level calculations efficiently with our qm",
    "/ mm setup offers therefore an ideal platform to assess how much this affects the reaction energetics .",
    "o@xmath85 cluster , exposing at its top center the fivefold coordinated ti adsorption site of the tio@xmath0(110 ) surface .",
    "ti atoms are shown as large white spheres , o atoms as small red spheres , and semi - transparent grey spheres mark the positions where pps represent the immediately surrounding ti - cations.,width=8 ]    for the qm region and systematic size convergence tests we employ a series of three clusters proposed by anmal and heyden @xcite , ti@xmath86o@xmath85 , ti@xmath87o@xmath88 and ti@xmath89o@xmath90 , with the ti@xmath86o@xmath85 cluster including the employed pps at the boundary region illustrated in fig .",
    "[ fig3 ] . at each level of theory",
    "the embedded clusters are constructed on the basis of optimized rpbe lattice positions .",
    "formal charges are used for the embedding point charges ( + 4 for ti and -2 for oxygen ) , whereby any positive point charge in a 8 vicinity of the qm region was replaced by ti@xmath91 pps .",
    "the mm region extends up to a distance of 27 from the central adsorption site , involving a total number of 4480 point charges .",
    "the interactions in the mm region are described with the well - established polarizable tio@xmath0 forcefield from ref .",
    ", where only the spring potential between oxygen shell and oxygen core has been modified to @xmath92 with @xmath93ev / @xmath94 and @xmath95 .",
    "this improves the representation of the dielectric constant of the mm region when setting it up with the dft lattice parameters . in order to describe the intrinsic surface polarization properly ,",
    "the position of the top - row o mm atoms is fully optimized for the clean tio@xmath0(110 ) surface . for the neutral systems studied here ,",
    "further geometry optimization and self - consistent polarization of the mm region in response to the adsorbates is neglected .",
    "the position of the adsorbates on top of the central fivefold - coordinated ti site in the qm region , cf .",
    "[ fig3 ] , is optimized at the rpbe level ; higher - level calculations are then performed for these fixed geometries . as reference",
    "we also compute supercell geometries with a 5 o - ti@xmath0o@xmath0-o trilayer slab , a 50 vacuum , and applying the identical surface geometry optimization protocol as for the embedded clusters . for @xmath96 and @xmath97",
    "surface unit cells @xmath98 and @xmath99 monkhorst - pack k - point grids were used , respectively , while for the density of states ( dos ) calculations of the clean @xmath96 cell this grid was increased to @xmath100 .",
    "following earlier theoretical work @xcite we assume the water oxidation pathway at defect - free tio@xmath0(110 ) to proceed along four electron - coupled proton transfer steps :    [ eq : nr - orig ] @xmath101    where the asterisk stands for the five - fold coordinated ti centers offered by the catalytic surface @xmath102 and particles attached to them ( e.g.  o@xmath103 ) , respectively .",
    "central energetic quantities for this pathway are correspondingly the binding energies of o , oh and ooh , defined as @xmath104 \\;=\\ ; e^{\\rm tot}[x{\\rm @tio_2 } ] - e^{\\rm tot}[{\\rm tio_2 } ] - e^{\\rm tot}[x ] \\quad .",
    "\\label{total_energy_qmmm}\\ ] ] here , @xmath105 $ ] and @xmath106 $ ] are the total energies of the tio@xmath0(110 ) surface with and without adsorbate @xmath107 , respectively , and @xmath108 $ ] is the total energy of the isolated adsorbate . at the hybrid and double - hybrid functional levels ,",
    "identical spin states are obtained in corresponding qm / mm and slab calculations . at the semi - local level , which significantly suffers from self - interaction ,",
    "this needed to be explicitly ensured by fixing the spin states to those of the higher - level calculations , i.e. doublet for oh and ooh , and triplet for o. this is an important issue , as most semi - local functionals yield the wrong spin - polarization for the o adsorbate , and already due to this produce a large deviation in the corresponding binding energy with respect to the higher - rung calculations @xcite .",
    "similar to the findings made for the zeolitic system , tier2 basis sets readily converge all @xmath109 to within 10mev at the semi - local and hybrid level , while at the double - hybrid level the valence - correlation consistent nao - vcc-4z basis set for all o atoms together with a counterpoise correction @xcite was required to reach this level of convergence .",
    ".[table2 ] calculated rpbe binding energies ( in ev ) of o , oh and ooh on the rutile tio@xmath0(110 ) surface . compared are results from different clusters with and without embedding against results obtained from a periodic supercell setup and differing surface unit - cells . [",
    "cols=\"<,^,^,^\",options=\"header \" , ]     notwithstanding , these differences are primarily due to the description of the bare radical in the gas phase , which is used as reference in the definition of @xmath109 in eq .",
    "( [ total_energy_qmmm ] ) and which is , of course , most sensitively affected by a varying degree of electron localization achieved at the different xc - levels . to circumvent this ,",
    "adsorption energies in photoelectrochemical calculations are often given with respect to the computational standard hydrogen electrode ( she ) @xcite .",
    "table [ table4 ] reproduces the same binding energies of table [ table3 ] with respect to this reference and demonstrates that this indeed removes most of the scatter and leads to consistent trends at all xc functional levels studied . under the above",
    "described constraint that the gga functionals are enforced to yield the correct spin polarization , these results thus suggest that despite the known electron localization problems , a description at the semi - local level seems indeed sufficient for computational screening work relying on trends and correlations between reaction intermediate binding energies@xcite , rather than quantitative differences within  0.2ev @xcite . of course",
    ", this may be quite different when addressing adsorption at defects , in charged states , or when calculating reaction barriers  with the present qm / mm - setup then forming an ideal tool to conduct higher - level calculations either directly for production or as reference .",
    "we have presented a general - purpose qm / mm - setup integrating the all - electron electronic structure theory code fhi - aims into the chemshell package . in this course",
    ", pseudopotential functionality was implemented into fhi - aims , which in the solid - state embedding context is employed to prevent spurious charge leakage out of the qm zone into nearby cationic mm charges .",
    "the fhi - aims nao basis sets enable particularly efficient access to exact exchange and second order perturbation theory .",
    "the here established qm / mm - approach is therefore ideally suited for hybrid and double - hybrid dft calculations of extended systems .",
    "the performance of our approach was demonstrated by the application to two different examples : the calculation of the fe reduction potential in a fe - substituted zsm-5 zeolitic framework and the calculation of adsorption energies of reaction intermediates in the water oxidation at defect - free tio@xmath0(110 ) . in both cases",
    "our results confirm the crucial importance of the appropriate description of the long - range electrostatics achieved through the solid - state embedding . systematic comparison to pbc supercell calculations for the more demanding tio@xmath0 system even shows that the possibility to adequately capture its polarizability through core - shell potentials in the mm region yields reliable absolute band edge positions , which predestines the approach for ( photo-)electrochemical applications .",
    "the calculation of the reduction potentials and adsorption energies at hybrid and double - hybrid xc level demonstrates the value of being able to scrutinize more readily available semi - local dft data . in case of the reduction",
    "potentials the higher - level reference data confirms the low structure sensitivity and the huge effect of the siliceous framework , with the small remaining scatter increasing the confidence in the quantitative numbers . in case of the adsorption energies the higher - level reference data",
    "reveals that the electron delocalization problem of the semi - local description can lead to wrong spin polarizations , which in turn would lead to qualitatively wrong results .",
    "if the correct spin polarization is enforced , the benchmark against the hybrid and double - hybrid numbers indicates that the semi - local binding energetics of the neutral reaction intermediates is reliable enough for computational screening work , in particular if referencing is done against the standard hydrogen electrode rather than delicate bare radicals .",
    "whether this prevails for more demanding cases like adsorption at ( charged ) defects remains to be seen and is the topic of on - going work  with the here established solid - state embedding approach providing a powerful tool that enables such calculations at higher xc - level efficiently and without the need for intricate charge compensation schemes .",
    "we thank jrgen wieferink ( now aleo solar ) for help with his logarithmic spherical bessel transform infrastructure in fhi - aims , igor zhang for his advice regarding numerical polarisation basis sets , and thomas w. keal for discussions regarding the implementation of the fhi - aims / chemshell interface .",
    "ajl , crac , ps and aas acknowledge funding from epsrc grant ep / io30662/1 , mrf and crac acknowledge funding from epsrc grant ep / i03014x/1 , and db acknowledges a scholarship from the tum international graduate school of science and engineering .",
    "further support came from the solar technologies go hybrid initiative of the state of bavaria .",
    "the authors acknowledge the use of the following high - performance computing facilities , and associated support services : hector , via our membership of the uk hpc materials chemistry consortium ( ep / l000202 ) ; iridis , provided by the centre for innovation ; hydra , provided by the max - planck supercomputing center .",
    "parts of this work were carried out under the hpc- europa2 project ( project number : 228398 ) , with the support of the european community - research infrastructure action of the fp7 .",
    "in the qm / mm - context the pp - functionality is exclusively used to prevent overpolarization of the qm charge due to immediately adjacent mm cationic monopoles . as such",
    ", the monopole term of the cation is replaced by a bare ionic pp with equal formal charge .",
    "in contrast , when using the pp in regular electronic structure calculations , valence electrons would be considered for the pseudoized atom and would then contribute to the total electronic energy .",
    "as the xc energy and potential are not additive with respect to the electron density , a non - linear core correction ( nlcc ) @xcite may be required to make up for the missing core density of the pseudoized atom and therewith allow to properly capture the xc contribution of the added valence electrons .",
    "the essential idea of the nlcc is to simply add the core density @xmath110 of a free atom in the calculation of the pertinent parts of the total energy expression .",
    "fhi - aims calculates the total energy , referred to as @xmath1 in the main text , as @xcite @xmath111(\\boldsymbol{r } ) ]   \\\\ \\nonumber & + &   e_{\\rm xc}[\\rho ]    \\\\&- &   \\frac{1}{2}\\int d r^3 [ \\rho(\\boldsymbol{r})v_{\\rm h}[\\rho](\\boldsymbol{r } ) ]   + e_{\\rm nuc - nuc } \\label{equation : harris}\\end{aligned}\\ ] ] with @xmath112 the occupation number of kohn - sham state @xmath113 and @xmath114 the hartree potential .",
    "the eigenvalues @xmath113 are hereby obtained in the standard manner from diagonalization of the hamiltonian of the kohn - sham system , @xmath115 . here , @xmath116 is the kinetic energy operator , @xmath117 the external potential , @xmath118 the electrostatic potential , and @xmath119 the xc potential for the single electrons .",
    "the nlcc correspondingly affects the first three terms in eq .",
    "( [ equation : harris ] ) , which are thus replaced as follows : @xmath120 & = & \\sum_i^{n_{\\rm states } } f_i { \\langle \\psi_i| } \\hat{v}_{\\rm xc}[\\rho + \\rho_{\\rm core}]{|\\psi_i\\rangle } \\\\",
    "\\nonumber & - & \\int d^3 r \\ ; \\rho \\ ; v_{\\rm xc}[\\rho + \\rho_{\\rm core } ] \\\\ & + & \\int d^3 r \\ ; ( \\rho + \\rho_{\\rm core } ) \\epsilon_{\\rm xc}[\\rho + \\rho_{\\rm core } ] \\quad .",
    "\\label{equation : e_nlcc}\\end{aligned}\\ ] ] even though not of concern for the qm / mm focus , this expression was also implemented into fhi - aims .",
    "thus , if an `` empty '' site ( no nucleus , but including basis functions and integration grids ) is placed atop a pp in fhi - aims , our present implementation also allows to perform norm - conserving pp calculations in fhi - aims .",
    "as smoothness of the core density is not an issue for nao basis sets and integration grids designed for an all - electron code , we hereby employ the full atomic core density @xmath110 and not a smoothed auxiliary representation as is commonly done in plane - wave codes @xcite .",
    "as the added core density is atom centered , a pulay - type force term on the pseudoized atom @xmath48 arises when adding the nlcc @xcite .",
    "differentiating eq .",
    "( [ equation : e_nlcc ] ) determines this term as @xmath121}{\\partial \\boldsymbol{r}_i }    \\nonumber\\\\ & = & - \\int   \\frac{\\delta ( ( \\rho + \\rho_{\\rm core } ) \\epsilon_{\\rm xc}[\\rho + \\rho_{\\rm core}])}{\\delta ( \\rho + \\rho_{\\rm core } ) }   \\frac{\\partial \\rho_{\\rm core}}{\\partial \\boldsymbol{r}_i }       \\nonumber\\\\ & = & - \\int d r^3 v_{\\rm xc}[\\rho + \\rho_{\\rm core } ]   \\frac{\\partial \\rho_{\\rm core}}{\\partial \\boldsymbol{r}_i } \\quad    \\end{aligned}\\ ] ] at the level of lda .",
    "p.  sherwood , a.  h. de  vries , m.  f. guest , g.  schreckenbach , c.  r.  a. catlow , s.  a. french , a.  a. sokol , s.  t. bromley , w.  thiel , a.  j. turner , s.  billeter , f.  terstegen , s.  thiel , j.  kendrick , s.  c. rogers , j.  casci , m.  watson , f.  king , e.  karlsen , m.  sjvoll , a.  fahmi , a.  schfer , and c.  lennartz .",
    ", * 632 * , 1 ( 2003 ) .",
    "a.  marek , v.  blum , r.  johanni , b.  lang v.  havu , t.  auckenthaler , a.  heinecke , h .- j .",
    "bungartz , and h.  lederer .",
    ", accepted , and psi - k scientific highlight for december , ( 2013 ) , http://www.psi-k.org/newsletters/news_20/highlight_120.pdf , ( 2014 ) ."
  ],
  "abstract_text": [
    "<S> we integrate the all - electron electronic structure code fhi - aims into the general chemshell package for solid - state embedding ( qm / mm ) calculations . </S>",
    "<S> a major undertaking in this integration is the implementation of pseudopotential functionality into fhi - aims to describe cations at the qm / mm boundary through effective core potentials and therewith prevent spurious overpolarization of the electronic density . </S>",
    "<S> based on numeric atomic orbital basis sets , fhi - aims offers particularly efficient access to exact exchange and second order perturbation theory , rendering the established qm / mm setup an ideal tool for hybrid and double - hybrid level dft calculations of solid systems . </S>",
    "<S> we illustrate this capability by calculating the reduction potential of fe in the fe - substituted zsm-5 zeolitic framework and the reaction energy profile for ( photo-)catalytic water oxidation at tio@xmath0(110 ) . </S>"
  ]
}