{
  "article_text": [
    "hidden markov models ( hmms ) and related state - switching models are prevalent in the field of animal movement modeling , where they provide a flexible framework to infer aspects of animal behavior from various types of movement data @xcite .",
    "they are very natural models for time series data related to animal movement , as they account for the serial dependence typically observed , yet also allow to ( loosely ) connect each observation to distinct underlying behavioral modes . a basic hmm for movement data consists of two stochastic processes : an observed movement process and an underlying state process",
    ", the latter of which can be related to distinct behavioral modes , at least in the sense of serving as a proxy of the actual behavioral process @xcite .",
    "applications of hmms to movement data often focus on investigating the effect of individual and environmental covariates on state occupancy , and thus ultimately on the dynamics of the variation in behavioral modes in response to internal and external drivers .",
    "generally , movement data are analyzed such that the observation process is assumed to stem from a single ( behavioral ) state process .",
    "it may however be the case that there are two ( connected ) behavioral processes that occur at distinct time scales .",
    "for instance , so - called hierarchical hmms have been used to process data on handwriting in order to distinguish between distinct letters but also to recognize a word , defined as a sequence of written letters @xcite . however , these versatile extensions of hmms have not yet been applied to movement data , even in light of the intuitive idea that distinct behaviors manifest themselves at different time scales ( hereafter referred to as multi - scale behaviors ) . a motivating example to have in mind is a central - place forager such as the southern elephant seal .",
    "these animals exhibit large - scale migration movements ( from land colonies to either the sea ice zone around antarctica or into open - ocean pelagic zones , and back ) , but also movement patterns where much more frequent changes take place between behavioral modes , e.g.  `` foraging '' and `` resting '' modes @xcite .",
    "the modeling framework we propose regards such data as stemming from two behavioral processes , which operate on different time scales : the first process determines the behavioral mode at the cruder time scale ( e.g. , whether or not an elephant seal is performing a migratory trip , and also what kind of migratory trip ) , while the second process , at the finer time scale , determines the behavioral mode _ nested within _ the large - scale mode ( e.g. , whether an elephant seal is resting or foraging , given it is close to the sea ice zone , or whether it is traveling or foraging , given it is on a migratory trip ) .",
    "for multi - scale modeling of animal movement data , we propose an extension to the standard hmm that allows for a hierarchical state process , where two ( or more ) different markov chains , operating at different time scales , will be tied together . to illustrate the application of hierarchically structured hmms in a real - data setting , we model vertical movements of a harbor porpoise ( _ phocoena phocoena _ ) throughout its natural habitat in the northeastern part of the north sea .",
    "while the data were collected at a dive - by - dive resolution , the aim here is to infer dive patterns at two different temporal scales : an hourly scale to infer the general behavioral mode ( e.g.  resting or traveling ) , which may persist for a large number of consecutive dives , and a fine - scale process to infer more nuanced state transitions at a dive - by - dive resolution given the general behavioral mode . as a second real - data example , we model baby garter snake ( _ thamnophis elegans _ ) movement data produced in a controlled experimental design context .",
    "the hierarchically structured hmm has two markov chains , where one markov chain models the transitions among three types of movements ( distance traveled in 1/2 s ) and the second markov chain models transitions across the six time series produced per snake . as this group of garter snakes",
    "was assigned to the control group , indicating no treatment effect , we use the second markov chain to investigate personality and repeatability in their movement patterns .",
    "that is , we attempt to answer if the garter snakes adapt their general movement strategies or if they have tendencies to exhibit the same general movement pattern across multiple time series .    a conceptual challenge with hmms , and in fact any discrete - time models for behavioral data , is that the temporal resolution of the observations being analyzed ( e.g. , hourly , daily , etc . )",
    "determines what kind of behaviors may be inferred at all . strictly speaking ,",
    "this is not a problem arising from the model applied , but rather from the sampling protocol , i.e. , the data .",
    "for instance , @xcite processed white shark location data , collected every five minutes , into distance traveled and turning angle and subsequently connected each bivariate observation to `` area - restricted search '' and `` transiting '' behavior .",
    "if the shark s location were observed once per day , we could not infer the same behaviors as switches between these behavioral modes occur at a much finer temporal scale .",
    "the hierarchically structured hmms will not solve the conceptual challenges associated with data processing or data collection required to infer multi - scale behaviors .",
    "however , it does offer new opportunities in the analysis of animal movement data , allowing for identification of general behavioral patterns that are a composition of fine - scale observations and inferences to be made at multiple time - scales .",
    "in section [ framework ] we first detail the basic hmm framework in order to introduce the necessary notation that will be used throughout the paper . in section [ hierarchical ]",
    ", we introduce the hierarchical model formulation , distinguishing between two types of latent states , production states and internal states , which occur at distinct time scales .",
    "a basic hmm is composed of two stochastic processes : an observable state - dependent process @xmath1 and an unobservable state process @xmath2 taking on a finite number of states . here",
    "we call the state a _ production state _ ( as it produces an observation ) , in order to differentiate it from other forms of the latent states which we introduce in section [ hierarchical ] . as is general practice , we assume a first - order markov process at the production state level , such that @xmath3 , the production state at time @xmath4 , given the states at all previous times , will only depend on @xmath5 .",
    "we further assume @xmath6 , @xmath7 , to be conditionally independent of past and future observations and production states , given the production state @xmath3 , such that the production states effectively select from which of finitely many possible distributions each observation is drawn . due to the markov property",
    ", the evolution of the production states over time is governed by the transition probability matrix ( t.p.m . ) , @xmath8 , where @xmath9 for @xmath10 , with @xmath0 denoting the number of production states .",
    "the initial distribution , @xmath11 , is a vector of probabilities with entries @xmath12 , of the first observation @xmath13 belonging to one of the @xmath0 production states .",
    "it is common to assume the initial distribution to be the stationary distribution , defined as the solution to @xmath14 .",
    "however , @xmath11 can also be estimated . in order to ensure identifiability when estimating the entries of the t.p.m .",
    ", we map the entries of each row onto the real line with the use of the multinomial logit link and set the diagonal entries of the matrix as the reference categories in the following manner , @xmath15 we similarly use a multinomial logit link transformation for the initial distribution , if estimated rather than assumed to the be the stationary distribution .",
    "the state - dependent distributions for @xmath6 will be represented in terms of probability density or mass functions @xmath16 .",
    "if the observations are multivariate , in which case we write @xmath17 , we can either formulate a joint distribution @xmath18 or assume contemporaneous conditional independence by allowing the joint distribution to be represented as a product of marginal densities , @xmath18=@xmath19 .",
    "while parametric families are usually chosen for the @xmath20 , such as a gaussian or gamma distribution , we can also estimate the distribution nonparametrically by expressing it as a linear combination of a large number of basis functions @xcite .",
    "the likelihood of an individual time series can be expressed concisely as a matrix product , @xmath21 where @xmath22 , @xmath11 denotes the initial distribution , and @xmath23 is a column vector of ones .",
    "calculation of the matrix product given above  the computational cost of which notably is only linear in @xmath24  is equivalent to applying the forward algorithm , which is an efficient recursive scheme for calculating the likelihood of an hmm @xcite .",
    "the framework for the basic hmm accounts for switches at the production state level . in a movement modeling analysis",
    ", the production states are generally thought to be proxies for behavior occurring at the time scale at which the data were collected ( or processed ) .",
    "however , as outlined in the elephant seal example in the introduction , production states alone may not be sufficient to encompass complex multi - scale behavioral processes .",
    "more specifically , there may be crude - scale behavioral processes ( e.g.  migration ) that manifest themselves as a sequence of production states and associated observations .",
    "intuitively , we would then connect a behavior occurring at a cruder time scale to one of @xmath25 _ internal states _",
    ", such that each internal state generates a distinct hmm , with the corresponding @xmath0 _ production states _ producing the actual observations .",
    "akin to the basic hmm framework , we can think of a fine - scale sequence of observations , @xmath26  with one such sequence for each @xmath27 to be produced by a sequence of production states , @xmath28 , during a given time frame ( namely the @xmath29 of @xmath30 time frames ) . however , in addition we now assume that the way in which the sequence of production states is generated depends on which of @xmath25 possible internal states is active during the current time frame",
    ". the length of the sequence of production states produced by the @xmath31 internal state can be dictated by the data collection process or imposed by the analysis . the corresponding @xmath25-state internal state process , @xmath32 , is such that @xmath33 serves as a proxy for a behavior occurring at a cruder time scale , namely throughout the @xmath29 time frame . in this manner",
    ", we account for differences observed across the time series @xmath34 , @xmath35 , by connecting each with one of @xmath25 crude - scale behavioral processes while still modeling the transitions among production states at the time scale at which the data were collected .",
    "supposing that there are multiple time series per individual , we can model the manner in which an animal switches among the @xmath25 internal states ( behavioral processes ) .",
    "we assume a markov process at the individual time series level , i.e.  @xmath36 , such that the @xmath29 internal state is conditionally independent of all other internal states given the internal state at the @xmath37 time point .",
    "the @xmath38 t.p.m .",
    "for the internal states @xmath39 examines persistence in the internal states , as well as the manner in which an animal will switch among them .",
    "figure 1 displays the dependence structure of hierarchically structured hmms with two markov chains , one at the level of the production states , @xmath40 , and the other at the level of the internal states , @xmath33 .",
    "\\(0 ) @xmath41 ; ( 1 ) [ right = 4 mm of 0 ] @xmath42 ; ( 2 ) [ right = 36.5 mm of 1 ] @xmath33 ; ( 3 ) [ right = 36.5 mm of 2 ] @xmath43 ; ( 4 ) [ right = 4 mm of 3 ] @xmath41 ; ( 6 ) [ above = 7.25 mm of 2 ] @xmath40 ; ( 5 ) [ left = 4 mm of 6 ] @xmath44 ; ( 7 ) [ right = 4 mm of 6 ] @xmath45 ; ( 8) [ above = 4 mm of 5 ] @xmath46 ; ( 9 ) [ above = 4 mm of 6 ] @xmath47 ; ( 10 ) [ above = 4 mm of 7 ] @xmath48 ; ( 14 ) [ above = 3.5 mm of 2 ] ; ( 15 ) [ left = 4 mm of 5 ] @xmath41 ; ( 16 ) [ right = 4 mm of 7 ] @xmath41 ; ( 17 ) [ above = 7.25 mm of 1 ] @xmath41 ; ( 18 ) [ above = 7.25 mm of 3 ] @xmath41 ; ( 19 ) [ above = 4 mm of 17 ] @xmath41 ; ( 20 ) [ above = 4 mm of 18 ] @xmath41 ; ( 11 ) [ right = 20.4 mm of 20 ] observable ; ( 12 ) [ below = 20.2 mm of 11 ] hidden ; ( 21 ) [ above = 3.5 mm of 1 ] ; ( 22 ) [ above = 3.5 mm of 3 ] ; ( 0 ) to ( 1 ) ; ( 15 ) to ( 5 ) ; ( 7 ) to ( 16 ) ; ( 1 ) to ( 2 ) ; ( 2 ) to ( 3 ) ; ( 3 ) to ( 4 ) ; ( 5 ) to ( 6 ) ; ( 6 ) to ( 7 ) ; ( 2 ) to ( 14 ) ; ( 5 ) to ( 8) ; ( 6 ) to ( 9 ) ; ( 7 ) to ( 10 ) ; ( 1 ) to ( 21 ) ; ( 3 ) to ( 22 ) ; ( 17 ) to ( 19 ) ; ( 18 ) to ( 20 ) ; ( 10.575,1.3 )  ( 2.6375,1.3 ) node ( 6)[midway , below , ] ; ( 2.3,1.3 )  ( 1.0,1.3 ) node ( 6)[midway , below , ] ; ( 12.2,1.3 )  ( 10.9,1.3 ) node ( 6)[midway , below , ] ; ( 13.9,2.65 )  ( 13.9,-0.6 ) node ( 6)[midway , below , ] ; ( 13.9,4.3 )  ( 13.9,3.0 ) node ( 6)[midway , below , ] ;    let @xmath49 denote a @xmath50vector of initial probabilities for the internal states , let @xmath51 denote the @xmath38 t.p.m .  for the internal state process , and",
    "define @xmath52    the likelihoods @xmath53 , @xmath54 , have the form as given in ( [ basiclikelihood ] ) , and only vary across @xmath55 in terms of the implied production - level t.p.m .",
    "( and potentially also the production state - dependent distributions ) .",
    "then the likelihood for the hierarchically structured hmm is ,    @xmath56    as the estimated production states are generally proxies for behaviors , allowing for only the t.p.m .  to vary across",
    "the @xmath25 hmms leads to an interpretation of the @xmath25 internal states ( loosely connected to @xmath25 behavioral processes ) as distinct manners in which an animal will persist and switch among the production states .",
    "as long as the individual time series likelihoods , @xmath57 , can be evaluated in an efficient manner , we can evaluate the likelihood of the hierarchically structured hmm via the forward algorithm , since the general structure does not differ from that of the basic hmm , and thus maximize it directly @xcite .",
    "the viterbi algorithm can be used for global state decoding , i.e.  finding the sequence of the most likely internal and production states , respectively , given the observations .",
    "_ 3.1.1 the data_. to illustrate the application of hierarchically structured hmms , we model vertical movements of a harbor porpoise ( _ phocoena phocoena _ ) throughout its natural habitat in the northeastern part of the north sea . from a time - depth recorder ( lat1800st , lotek , ontario , canada ) , we obtained observations of the dive depth every second . assuming a `` dive '' to be any vertical movement deeper than two meters below the surface",
    ", we used the ` r ` package ` divemove ` @xcite to process the raw data into measures of the dive duration , the maximum depth and the dive wiggliness ( as represented by the absolute vertical distance covered at the bottom of each dive ) to characterize the porpoise s vertical movements at a dive - by - dive resolution .",
    "previous applications of hmms , though not hierarchically structured hmms , with dive - by - dive data of marine mammals have been presented in @xcite and @xcite .",
    "overall , we consider 275 hours of observations , comprising 7,585 dives in total ( hence , about 28 dives per hour ) .",
    "_ 3.1.2 model formulation and model fitting_. behavioral modes of marine mammals , e.g. , resting , foraging and traveling , do not necessarily manifest themselves at a dive - by - dive resolution .",
    "for example , foraging behavior typically coincides with a large proportion of extensive , wiggly dive sequences .",
    "however , foraging sequences may be interspersed by short periods of resting behavior ( shallow and smooth dives ) even though the dominant behavioral mode may still be foraging .",
    "such patterns are especially likely to occur in harbor porpoise dive data , a species that needs to feed almost continuously to meet energy requirements @xcite . in these cases ,",
    "hierarchically structured hmms have strong potential to infer the movement strategies adopted over time , by modeling the transitions between distinct dive patterns ( as represented by multiple hmms ) rather than modeling dive - by - dive observations using a single hmm .",
    "thus , to draw a more detailed picture of the behavioral dynamics at multiple time scales , we use hierarchical hmms , where a crude - scale @xmath25-state markov chain selects which of @xmath25 fine - scale hmms describes the dive pattern observed at any point in time . intuitively , the crude - scale process describes the general behavioral mode ( e.g.  resting or traveling )  which may persist for a large number of consecutive dives  while the fine - scale process captures more nuanced state transitions at the dive - by - dive level , given the general behavioral mode .    in terms of the crude time scale , we segmented the time series into hourly intervals and allowed each segment to be connected to one of @xmath58 hmms with @xmath59 ( dive - by - dive - level ) states each .",
    "this somewhat arbitrary time scale was chosen based on exploratory analysis of the data set , which suggested that a certain dive pattern is typically adopted for several hours before switching to another one ( c.f .",
    "figure [ fig5 ] ) .",
    "as comprehensively discussed in @xcite , model selection criteria such as akaike s information criterion ( aic ) or the bayesian information criterion ( bic ) typically tend to favor models with larger number of states than are biologically sensible .",
    "this is indeed a well - known and notorious problem in applications of hmms to ecological data ( see also @xcite , @xcite , @xcite ) .",
    "thus , following @xcite , instead of relying on formal model selection procedures , the number of states was chosen pragmatically , with particular emphasis on model parsimony and biological intuition .",
    "the state - dependent distributions were kept the same across the two dive - level hmms , which were instead allowed to differ only by the t.p.m.s .",
    "this assumption implies that any of the three types of dives  as generated by the three different production states  could in principle occur in both crude - level behavioral modes , but will not occur equally often , on average , due to the different markov chains active at the dive - by - dive level .",
    "the initial state distributions , both for the internal and for the production state process , were assumed to be the stationary distributions of the respective markov chains .",
    "we assumed gamma distributions for each of the three dive variables ( dive duration , maximum depth and dive wiggliness ) , with an additional point mass on zero in case of dive wiggliness to account for the zeros observed .",
    "we assumed contemporaneous conditional independence , i.e.  for any given dive , the three variables observed are conditionally independent given the production state active at the time of the dive @xcite .",
    "these assumptions could in fact be relaxed if deemed necessary . however , for this case study we decided that in order to illustrate the key concepts , it would be best to focus on a relatively simple yet biologically informative model structure .",
    "we computed the likelihood using the forward algorithm @xcite and used the r function ` nlm ` @xcite to obtain maximum likelihood estimates via direct numerical likelihood maximization .",
    "_ 3.1.3 fitted state - dependent distributions_. the fitted ( dive - level ) state - dependent distributions displayed in figure [ fig4 ] suggest three distinct dive types : state 1 captures the shortest ( lasting less than 25 seconds ) , shallowest ( less than 10 meters deep ) and smoothest ( less than 8 meters absolute vertical distance covered ) dives with small variance .",
    "state 2 captures moderately long ( 10 - 60 seconds ) , moderately deep ( 5 - 25 meters ) and moderately wiggly ( 5 - 30 meters ) dives with moderate variance .",
    "state 3 captures the longest ( 40 - 180 seconds ) , deepest ( 10 - 80 meters ) and wiggliest ( 10 - 80 meters ) dives with high variance .        in the next section",
    ", we discuss the ( @xmath58 ) distinct dive - level switching patterns among the ( @xmath59 ) states discussed here , as well as the crude - level process that selects which of the dive - level switching patterns is active in any given hour .",
    "_ 3.1.4 estimated transition probability matrices_. the t.p.m",
    ".  of the crude - level markov chain , which selects among the dive - level hmms , and the t.p.m.s of those two dive - level hmms , which describe the switching between different types of dives , were estimated as follows :    * crude level : @xmath60 * dive level : @xmath61    the corresponding stationary distributions are @xmath62 , @xmath63 and @xmath64 @xmath65 , respectively .",
    "the former of these three stationary distributions implies that , according to the fitted model , in the long run , approximately half of the observations were generated by each of the two hmms .",
    "furthermore , according to the estimated t.p.m .",
    "@xmath66 , there is fairly strong persistence in the crude - level states , indicating that the porpoise typically remains in any given internal state for several hours before switching to the other internal state .",
    "this is also confirmed by figure [ fig5 ] , which displays the first 25% of the decoded observations . in particular , figure [ fig5 ] shows that there are bouts of several hours where production states 1 and 2 are dominant ( yet still interspersed with occasional dives generated by production state 3 ) , but also such where production state 3 is dominant .",
    "bouts of the former type are assigned to internal state 1 , while the latter are assigned to internal state 2 .",
    "this again highlights the need to apply hierarchically structured hmms , here effectively as a means to account for temporal heterogeneity in the state - switching pattern exhibited by the porpoise .        at the dive level ,",
    "when the first hmm is active , then in the long run about 28% , 51% and 22% of the observations are generated in state 1 , 2 and 3 , respectively , whereas when the second hmm is active , in the long run about 8% , 11% and 81% of the dives are generated in the respective states .",
    "furthermore , if the first hmm is active , then switching takes place primarily between states 1 and 2 , and additionally from state 3 to state 2 .",
    "if the second hmm is active , then state 3 is dominant , with fairly strong persistence and lots of switches from states 1 and 2 to state 3 . _",
    "3.1.5 concluding remarks_. the second hmm is indicative of foraging behavior , particularly due to the extensive wiggliness during dives , which often indicates prey - chasing .",
    "the interpretation of the first hmm , which involves a large proportion of relatively short , shallow and smooth dives , could indicate a resting and/or a traveling behavior .",
    "indeed , traveling from one area to another while remaining close to the water surface is likely the most efficient strategy .",
    "however , a more detailed interpretation of the first hmm would require inclusion of other variables such as the step length , which may prove useful to distinguish between resting and traveling .",
    "_ 3.2.1 the data_. we model the movements of 19 juvenile garter snakes ( _ thamnophis elegans _ ) in repeated trials that are a subset from a larger experiment quantifying behaviors in the offspring of wild - caught females across experimental treatments , manuscript in preparation . using ethovision xt 8.5 ( noldus information technology , wageningen , the netherlands ) , we extracted movement data for each of the snakes across three trials . in brief",
    ", snakes were placed in a novel test arena ( circular enclosure with diameter of 24.5 cm ) for 120 s. trials were videorecorded and divided into two segments , each lasting 50 s , to account for any possible disturbances of snakes by observer movement at the beginning and end of each trial .",
    "this resulted in a total of six recorded segments for each snake .",
    "the individuals included here represent the control group , which was not exposed to any additional in the test arena during the first two trials and was exposed to a novel object after the first minute of the third trial ( that is , between tracks 5 and 6 ) .",
    "_ 3.2.2 model formulation and model fitting_. the snakes displayed a variety of general movement strategies , from the extreme of remaining motionless to moving rapidly around the test arena for the duration of the trial .",
    "we calculated the distance moved within 1/2 s and subsequently applied a square root transformation to deal with extreme values present .",
    "we assumed that each observed distance conditional on one of three production states was generated by a state - dependent gamma density .",
    "further , to investigate habituation and behavioral plasticity over the course of the six time series per snake , we assumed that each time series was generated by one of three internal state - dependent hmms .",
    "the complete hierarchically structured hmm fitted to the observed distances was composed of three production states , kept the same across the internal states , and three internal states . in this manner , we investigated whether there was persistence at the internal state level , i.e.  if the garter snakes tended to repeat the same general movement patterns across time series or switch strategies .",
    "_ 3.2.3 fitted state - dependent distributions_. the fitted state - dependent gamma distributions for the three production states , shown in figure [ fig : gssdd ] , correspond to three general types of movement strategies : motionless ( or nearly so ) , slow exploratory , and rapid escape , which the video recordings demonstrate .",
    "the estimated average distance traveled in production states 13 are : 0.0148 , 0.459 and 1.891 cm per 1/2 s , respectively .",
    "the largest amount of variability in observed step lengths corresponds to production state 3 , with a standard deviation of 0.487 @xmath67 .        _",
    "3.2.4 estimated transition probability matrices and initial state distributions_.    * crude level : @xmath68 * movement level : @xmath69 @xmath70 @xmath71    the three estimated t.p.m.s at the movement level , corresponding to the three internal states , can generally be interpreted as representing three different levels of behavioral flexibility .",
    "when the first internal state is active , characterized by @xmath72 , individuals are showing more persistence in the motionless and slow exploratory behavioral states overall , and are likely to transition from the rapid escape state to the exploratory state .",
    "when the second internal state is active , @xmath73 demonstrates that individuals are switching regularly between behavioral states .",
    "when the third internal state is active , @xmath74 demonstrates that individuals seldom transition between states .",
    "thus , the three internal states reflect a continuum of behavioral flexibility within a short , but ecologically relevant time scale in the context of a potential predation event ( @xmath75 1 min ) .        at the crude level , the t.p.m .",
    "@xmath76 ) indicates that individuals are readily switching among the three movement level hmms across trials and in fact are more likely to switch between the movement hmms representing the greatest behavioral flexibility @xmath77 and @xmath78 . at the crude time scale , we observe persistence in the the movement - level hmm describing snakes that are behaviorally inflexible in their movements @xmath79 ) .",
    "overall , these results indicate that , at the broader time scale , many individuals are readily altering their level of behavioral flexibility while some individuals remain persistent in their behaviors both within and across trials ( i.e. , at both the movement and crude levels ) .    _",
    "3.2.5 concluding remarks_. hmms are not yet commonly applied to animal movement data from experimental designs , even though they typically produce multiple time series per individual .",
    "introducing multiple markov chains in the hmm formulation lends itself to characterizing the consistency of individual behaviors and variation among individuals at different time scales .",
    "we show that individuals employing multiple movement strategies in a narrow time frame are more likely to switch between strategies at a crude time scale , while individuals consistent in their behaviors at the movement time scale are also consistent at the crude time scale .",
    "furthermore , these patterns are independent of the behavioral strategies exhibited : individuals may consistently remain in any one of the three behavioral states .",
    "hmms have proven to be useful statistical tools for modeling animal movement data , providing a framework to infer drivers of variation in movement patterns , and thus behavior .",
    "the basic hmm , however , has so far been used to infer aspects of animal behavior only when a single data point can be thought to stem from one of @xmath0 possible ( production ) states , which are loosely connected to behavioral modes that manifest themselves at the temporal resolution at which observations are made . yet , thanks to advances in tag technology and battery life , data can be collected at finer temporal resolutions and over longer periods of time .",
    "inferences at time scales cruder than those at which data are collected , and which correspond to larger - scale behavioral processes , are not yet answered via hmms .",
    "we provide a corresponding extension to incorporate multiple markov chains in an hmm , allowing for multi - scale behavioral inferences .",
    "the extension is straightforward in the sense that likelihood inference via application of the forward algorithm is essentially analogous as in case of basic hmms .",
    "the hierarchically structured hmms can also be used to avoid coarsening data , such as acceleration data that can be collected many times per second @xcite . as this is , as of",
    "yet , an area of movement ecology that has received little attention , our proposed framework is one of the first that models animal behavior simultaneously at multiple time scales .    in this manuscript",
    ", we did not discuss how to implement model selection and model checking for hierarchically structured hmms . in principle , since we are fitting the models using maximum likelihood , model selection could be conducted using standard information criteria . however , while conceptually this is completely straightforward , in practice this procedure is notoriously error - prone already for basic hmms , due to the strong tendency of information criteria to favor models with many more states than are biologically reasonable @xcite . given the additional state process , this issue will be exacerbated within hierarchically structured hmms as presented in this work , since the number of states both for the production process and for the internal state process needs to be chosen .",
    "we can not currently offer a satisfactory solution to this problem , except by saying that biological _ a priori _ expert knowledge ought to be taken into account . for general advice regarding the issue of model selection in hmms , see @xcite . for model checking ,",
    "possible avenues are ( i ) simulation - based model assessment and ( ii ) analyses of pseudo - residuals . regarding ( i ) , the fundamental concept is the idea that the fitted model should generate data similar to the observed data in all important aspects .",
    "quantification of aspects of the data patterns should reflect key behaviors believed to be important to the problem .",
    "pseudo - residuals , as discussed for example in @xcite , @xcite and in @xcite , can be calculated also for hierarchically structured hmms , most easily by conditioning on viterbi - decoded internal states , hence calculating the pseudo - residuals at the production level , given the ( fixed ) most likely internal state sequence . both model selection and model checking needs to be explored further before these models may become a tool that is routinely applied in the analysis of animal behavior data .",
    "using _ ad hoc _ choices of the exact model formulations ( yet such that are grounded in biological theory ) , in section [ sec : apps ] we demonstrated how the hierarchically structured hmms , applied to movement data collected on harbor porpoises and garter snakes , respectively , provided new insights into the behavior of these species .",
    "however , a hierarchically structured hmm not only allows for new inferences to be made from movement studies  it can also be applied to the study of behavior in general .",
    "being able to characterize persistence of movement patterns at multiple time scales allows us to learn about personality , individual specialization , and cognition , among other things .",
    "several studies across a wide range of taxa have shown that individual animals behave differently from other individuals and that these differences are maintained through time @xcite .",
    "these observations have given rise to the burgeoning field of animal personality which explores the ecology and evolutionary significance of such behavioral differences among individuals .",
    "such studies have included a variety of behavioral measures but have only recently incorporated models of movement as a behavioral trait ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "importantly , the animal personality framework has recently incorporated an understanding of how individuals differ in their behavioral plasticity ( reviewed in * ? ? ?",
    "* ; * ? ? ?",
    "* ) , which requires more specific theoretical models as well as more sophisticated statistical approaches @xcite .",
    "thus , the field is attempting to address two fundamental questions : ( 1 ) how do behaviors differ among individuals and ( 2 ) how do individual behaviors change over time or context ? addressing these questions therefore requires analysis at two levels : ( 1 ) to identify and categorize behavioral states ( production states ) and ( 2 ) to identify patterns of changes in behavioral states ( internal states ) . in the hmm framework",
    ", the internal states may reflect general movement patterns associated with endogenous behavioral plasticity ( _ sensu _ * ? ? ? * ) or personality which allows for further examination of persistence or switching among them at the cruder time - scale .",
    "the addition of multiple markov chains in the hmm framework to conduct multi - scale behavioral inferences necessitates the selection of the temporal resolution at two time scales : the observation level and the level of the individual time series .",
    "the selected temporal resolution at the level of the internal states will need to be tied to the specific biological question of interest . there may be a natural manner in which the data are segmented that produces time series of unequal length .",
    "however , this need not be an issue as long as each time series is reflective of some general behavioral process irrespective of the length of the time series . formulating the hierarchically structured hmm , in terms of selecting the number of production states and internal states , will need to be done in a pragmatic fashion in order to balance model complexity with biological intuition . due to the hmm s inherent flexibility",
    ", the internal states may be formulated in a few manners , e.g.  a single hmm ( such as has been described in section 2 ) , assuming a distribution of hmms , or allowing for longer state dwell times via the hidden semi - markov model , in order to account for unexplained variability in the state processes .",
    "in particular , as the number of production states , @xmath0 , increases , so will the number of ways in which two hmm s",
    "t.p.m.s @xmath80 and @xmath81 can differ . to account for",
    "all of these possibilities may require a large number of internal states , if each internal state is assumed to only correspond to one t.p.m .  for the hmm .",
    "adding hierarchical structures to the hmm opens new possibilities for modeling multi - scale behaviors and provides an avenue to study animal personality and general behavior from movement studies . in this manner , environmental covariates",
    "can also be included to understand their effects on state occupancy and dynamics of variation in behavioral modes at broader time - scales than that at which the data are collected .",
    "further , this framework may be adapted for simultaneous modeling of multiple animal behavior data streams collected at distinct temporal resolutions .",
    "the internal states can be adapted to generate a sequence of fine - scale observations as well as one observation from a distinct data stream .",
    "the harbor porpoise movement data were collected as part of the depons project ( www.depons.au.dk ) funded by the offshore wind developers vattenfall , forewind , smart wind , eneco luchterduinen , east anglia offshore wind and dong energy .",
    "funding for snake project provided by iowa science foundation ( 15 - 11 ) and the gaige award of the american society of ichthyologists and herpetologists .",
    "ejg partially supported by a fellowship from the isu office of biotechnology .",
    "deruiter , s.l . ,",
    "langrock , r. , skirbutas , t. , goldbogen , j.a . ,",
    "calambokidis , j. , friedlaender , a.s .  & southall , b.l .",
    "( in press ) a multivariate mixed hidden markov model for blue whale behaviour and responses to sound exposure . _",
    "annals of applied statistics _ , .          hart , t. , mann , r. , coulson , t. , pettorelli , n.  & trathan , p.n .",
    "( 2010 ) behavioural switching in a central place forager : patterns of diving behaviour in the macaroni penguin ( _ eudyptes chrysolophus _ ) . _ marine biology _ , * 157 * , 15431553 .",
    "langrock , r. , king , r. , matthiopoulos , j. , thomas , l. , fortin , d.  & morales , j.m .",
    "( 2012 ) flexible and practical modeling of animal telemetry data : hidden markov models and extensions .",
    "_ ecology _ , * 93 * , 23362342",
    ".      langrock , r. , marques , t.a . , baird , r.w .  &",
    "thomas , l. ( 2014 ) modeling the diving behavior of whales : a latent - variable approach with feedback and semi - markovian components",
    ". _ journal of agricultural , biological and environmental statistics _ , * 19 * , 82100 .      leos - barajas , v. , photopoulou , t. , langrock , r. , patterson , t.a .",
    ", murgatroyd , m. , watanabe , y.y .  & papastamatiou , y.p .",
    "( 2016 ) analysis of accelerometer data using hidden markov models .",
    "_ methods in ecology and evolution _ , doi:10.1111/2041 - 210x.12657 .",
    "patterson , t.a . ,",
    "basson , m. , bravington , m.v .  & gunn , j.s .",
    "( 2009 ) classifying movement behaviour in relation to environmental conditions using hidden markov models .",
    "_ journal of animal ecology _ , * 78 * , 11131123 .              spiegel , o. , leu , s.t . , bull , c.m .  & sih , a. ( 2017 ) what s your move",
    "?  movement as a link between personality and spatial dynamics in animal populations . _ ecology letters _ , * 20 * , 318 .",
    "doi:10.1111/ele.12708      towner , a. , leos - barajas , v. , langrock , r. , schick , r. , smale , m. , taschke , t. , jewell , o.  & papastamatiou , y.p .",
    "( 2016 ) sex - specific and individual specialization for hunting strategies in white sharks .",
    "_ functional ecology _ , in press , doi : 10.1111/1365 - 2435.12613 .",
    "wisniewska , d. m. , m. johnson , j. teilmann , l. rojano - doate , j. shearer , s. sveegaard , l. a. miller , u. siebert  & p. t. madsen ( 2016 ) ultra - high foraging rates of harbor porpoises make them vulnerable to anthropogenic disturbance .",
    "_ current biology _ , * 26 * , 1441-1446"
  ],
  "abstract_text": [
    "<S> hidden markov models ( hmms ) are commonly used to model animal movement data and infer aspects of animal behavior . </S>",
    "<S> an hmm assumes that each data point from a time series of observations stems from one of @xmath0 possible states . </S>",
    "<S> the states are loosely connected to behavioral modes that manifest themselves at the temporal resolution at which observations are made . however , due to advances in tag technology , data can be collected at increasingly fine temporal resolutions . </S>",
    "<S> yet , inferences at time scales cruder than those at which data are collected , and which correspond to larger - scale behavioral processes , are not yet answered via hmms . </S>",
    "<S> we include additional hierarchical structures to the basic hmm framework in order to incorporate multiple markov chains at various time scales . </S>",
    "<S> the hierarchically structured hmms allow for behavioral inferences at multiple time scales and can also serve as a means to avoid coarsening data . </S>",
    "<S> our proposed framework is one of the first that models animal behavior simultaneously at multiple time scales , opening new possibilities in the area of animal movement modeling . </S>",
    "<S> we illustrate the application of hierarchically structured hmms in two real - data examples : ( i ) vertical movements of harbor porpoises observed in the field , and ( ii ) garter snake movement data collected as part of an experimental design .    1.9    * keywords : * animal behavior , bio - logging , experimental design , latent process , state - switching model , temporal resolution </S>"
  ]
}