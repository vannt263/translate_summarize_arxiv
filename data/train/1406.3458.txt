{
  "article_text": [
    "optimal control problems for diffusion processes have attracted a lot of attention in the last decades , both in terms of the development of the theory as well as in terms of concrete applications to problems in the sciences , engineering and finance  @xcite .",
    "stochastic control problems appear in a variety of applications , such as statistics @xcite , financial mathematics @xcite , molecular dynamics @xcite and materials science @xcite , to mention just a few .",
    "a common feature of the models used is that they are high - dimensional and possess several characteristic time scales .",
    "for instance , in single molecule alignment experiments , a laser field is used to stabilize the slowly - varying orientation of a molecule in solution that is coupled to the fast internal vibrations of the molecule , but ideally the controller would like to base the control protocol only on the relevant slow degree of freedom , i.e.  the orientation of the molecule @xcite .",
    "if the time scales in the system are well separated , it is possible to eliminate the fast degrees of freedom and to derive low - order reduced models , using averaging and homogenization techniques  @xcite .",
    "homogenization of stochastic control systems has been extensively studied by applied analysts using a variety of different mathematical tools , including viscosity solutions of the hamilton - jacobi - bellman equation  @xcite , backward stochastic differential equations @xcite , gamma convergence @xcite and occupation measures @xcite .",
    "the latter has been also employed to analyse deterministic control systems , together with differential inclusion techniques @xcite .",
    "the convergence analysis of multiscale control systems , both deterministic and stochastic , is quite involved and non - constructive , in that the limiting equations of motion are not given in explicit or closed form ; see @xcite for notable exceptions , dealing mainly with the case when the dynamics is linear .",
    "we shall refer to all these approaches  without trying to be exhaustive  as `` first optimize , then reduce '' .    on the other side of the spectrum",
    "are model order reduction ( mor ) techniques for large - scale linear and bilinear control systems that are based on tools from linear algebra and rational approximation .",
    "mor aims at approximating the response of a controlled system to any given control input from a certain class , e.g. , piecewise constant or square integrable functions ; see , e.g. , @xcite and the references given there . a very popular mor method is balanced truncation that gives easily computable error bounds in terms of the hankel norm of the corresponding transfer functions @xcite , and which has recently been extended to deterministic and stochastic slow - fast systems , using averaging and homogenization techniques @xcite . in applications",
    "mor is often used to drastically reduce the system dimension , before a possibly computational expensive optimal control problem is solved . in most real - world applications , solving an optimal control problems on the basis of the unreduced large - scale model is prohibitive , which explains the popularity of mor techniques .",
    "we will call this approach `` first reduce , then optimize '' .",
    "in this paper we focus on optimal control of diffusions with two characteristic time scales . as a representative example , we consider the diffusion of a driven brownian particle in a two - scale energy landscape in one dimension @xmath0 where @xmath1 is any time - dependent driving force ( or control variable ) and @xmath2 is standard one - dimensional brownian motion .",
    "the potential consists of a large metastable part with small - scale superimposed periodic fluctuations , @xmath3 with @xmath4 a 1-periodic function .",
    "a typical potential is shown in figure [ fig : multiscalepotential ] .",
    "( in blue).,width=302 ]    now , if @xmath1 is given as a function of time , say bounded and continuous , it is known that @xmath5 converges in distribution to a limiting process @xmath6 as @xmath7 , where @xmath6 solves the homogenized equation  @xcite @xmath8 here @xmath9 is an effective diffusivity that accounts for the slowing down of the dynamics due to the presence of local minima in the two - scale potential .",
    "the property that @xmath10 weakly converges to @xmath11 in the sense of probability measures will be referred to as _ forward stability _ of the homogenized equation .",
    "now imagine a situation , in which @xmath1 depends on @xmath5 via a feedback law @xmath12 where @xmath13 is a measurable function of @xmath11 .",
    "( for simplicity , we do not consider the case that @xmath14 carries an explicit time - dependence . ) specifically , we choose @xmath15 from an admissible class of feedback controls so that the cost functional @xmath16 is minimized for some given running cost @xmath17 associated with the sample paths of @xmath5 and @xmath18 up to a random stopping time @xmath19 of the process .",
    "the aim of the paper is to study situations where the cost functional evaluated at @xmath20 , converges to @xmath21 , with @xmath15 being the limit of @xmath20 ( in some appropriate sense ) .",
    "specifically , we are dealing with the situation that @xmath22 a property that we will refer to as _",
    "backward stability_. if the homogenized equation is backward stable , it does not matter whether one first solves the optimal control problem and then sends @xmath23 to @xmath24 or vice versa , in which case the control @xmath15 is simply treated as a parameter .",
    "one of the implications then is that we can compute optimal controls from the homogenized model , such as ( [ bmlim ] ) , and use them in the original equation when @xmath23 is sufficiently small .",
    "unfortunately very few systems are backward stable in this sense , a notable exception being a system of the form   when the running cost @xmath25 is quadratic in @xmath15 , e.g. ( * ? ? ?",
    "the reader may wonder why one should first reduce the equations * before * solving the optimal control problem anyway , rather than the other way round .",
    "one answer is that solving optimal control problems for high - dimensional multiscale systems is usually computationally infeasible , which often leaves no other choice ; another answer is that there may be situations , in which a fully resolved model may not be explicitly available , but one only has a sufficiently accurate low - order model that captures the relevant dynamics of the system . in both cases one wants to make sure that the controls obtained from the low - order reduced model can be used in order to control the original system .      in this article",
    "we consider the exceptional cases of backward stability and give necessary and sufficient conditions under which the reduced systems ( disregarding the control ) are indeed backward stable .",
    "it turns out that a class of optimal control problems that are backward stable are systems that are linear - quadratic in the control variable ; they may be nonlinear in the state variables , though , and therefore cover many relevant applications in the sciences and engineering .",
    "moreover we find that an additional requirement is that the controls of the multiscale system converge in a strong sense ; an example of weak convergence , in which the systems fails to be backward stable due to lack of sequence continuity , is when the controls are oscillatory with rate @xmath26 around its homogenization limit , in case of which @xmath27 does not converge to @xmath28 unless @xmath29 is linear in @xmath15 . for a related discussion of weak convergence issues in optimal control , we refer to @xcite .",
    "similar problems for parameter estimation and filtering are discussed in @xcite .",
    "strong convergence of the control is a necessary , but not sufficient condition for backward stability of the model reduction approach ( first reduce , then optimize ) , in which the control variable is treated as a parameter during the homogenization procedure . the class of control problems , which can be homogenized in the above way are systems of sdes that can be transformed to systems in which the controls are absent",
    ". the class of such systems are linear - quadratic in the controls ( but possibly nonlinear in the states ) , and can be transformed by a suitable _ logarithmic transformation _ of the value function of the optimal control problem : @xmath30 it can be shown ( see @xcite ) that the log - transformed value function solves a linear boundary value problem that does not involve any control variables and can be homogenized using standard techniques . once the linear equation has been homogenized , it can be transformed back to an equivalent optimal control problem that is precisely the limiting equation of the original multiscale control problem . a nice feature of the logarithmic transformation approach is that the optimal control can be expressed in terms of the solution of the linear boundary value problem , which can be solved efficiently using monte - carlo methods .",
    "this approach is helpful when the dynamics are high - dimensional , in which case any grid - based discretization of the above linear boundary value problem is prohibitive .",
    "( the case when the stopping time @xmath19 is deterministic and the log - transformed value function solves a linear transport pde can be treated analogously . )",
    "our approach is summarized in table [ table : approach ] .",
    ".schematic approach of the homogenization procedure using logarithmic transformation .",
    "[ cols=\"^,^,^ \" , ]     the article is organized as follows : in section [ sec : mms ] the model reduction approach for the indefinite time - horizon control problem with multiple time scales is outlined , with a brief introduction to dynamic programming and logarithmic transformations in section [ ssec : logtrafo ] .",
    "the model reduction problem is illustrated in section [ sec - examples ] with three different numerical examples : underdamped motion of langevin - type ( sec .",
    "[ subsec - examples - langevin ] ) , diffusion in a highly - oscillatory potential ( sec .",
    "[ subsec - examples - homo ] ) , and the gaussian linear quadratic regulator ( sec .",
    "[ subsec - examples - linear ] ) .",
    "the article contains three appendices : appendix [ sec : weak ] discusses weak convergence under logarithmic transformations , appendix [ sec : ergode ] introduces the infinite time - horizon problem associated with the linear quadratic regulator example , appendix [ sec : bounds ] contains the proof of theorem [ thm : entropyindefinite ] and records various identities to bound the cost functional and the value function when using suboptimal controls .",
    "we start by setting the notation which we will use throughout this article .",
    "we denote by @xmath31 a bounded open set with sufficiently smooth boundary @xmath32 .",
    "further let @xmath33 be a stochastic process assuming values in @xmath34 that is the solution of @xmath35 where @xmath36 is the control applied at time @xmath37 and @xmath38 is @xmath39-dimensional brownian motion and @xmath40 is the ( dimensionless ) inverse temperature of the system .",
    "we assume that , for each @xmath41 , drift and noise coefficients , @xmath42 and @xmath43 , are continuous functions on @xmath44 , satisfying the usual lipschitz and growth conditions that guarantee existence and uniqueness of the process @xcite .",
    "we want to control ( [ sde ] ) in such a way that an appropriate cost criterion is minimized where the control is active until the process leaves the set @xmath45 .",
    "assuming @xmath46 , we define @xmath19 to be the stopping time @xmath47 i.e. , @xmath19 is the first exit time of the process @xmath48 from @xmath45 .",
    "our cost criterion reads @xmath49 where @xmath25 is the running cost that we assume to be of the form @xmath50 with @xmath51 being continuous on @xmath44 .",
    "note that the @xmath23-dependence of the cost functional @xmath29 comes only through the dependence of the control on @xmath52 .",
    "we will omit the dependence on @xmath53 in @xmath54 and write it as @xmath28 whenever there is no ambiguity .      in order to pass to the limit @xmath7 in ( [ sde])([rgcost ] )",
    ", we resort to the technique of logarithmic transformations that has been developed by fleming and co - workers ( see @xcite and the references therein ) . we start by recalling the dynamic programming principle for stochastic control problems of the form ( [ sde])([rgcost ] ) . to this end",
    "we make the following assumptions ( see ( * ? ? ?",
    "vi.35 ) for further details on the first two of the following assumptions ) :      for every @xmath41 , the matrices @xmath55 are positive definite with uniformly bounded inverse @xmath56 .",
    "the running cost @xmath57 is continuous , nonnegative , and @xmath58 for all @xmath59 with bounded first order partial derivatives in @xmath53 .",
    "there exist constants @xmath60 , which are independent of @xmath23 , such that @xmath61 . + we define the generator of the dynamics @xmath62 by @xmath63 notice that the generator depends on the control @xmath15 .",
    "when the control is absent we will use the notation @xmath64 .",
    "the next result is standard ( e.g. , see ( * ? ? ?",
    "iv.2 ) ) ) and stated without proof .",
    "[ thm : verification ] let @xmath65 be the solution of the hamilton - jacobi - bellman ( hjb ) equation @xmath66 then @xmath67 where the minimum goes over all admissible feedback controls of the form @xmath68 .",
    "the minimizer is unique and is given by the feedback law @xmath69 [ thm - dp ]    the function @xmath70 is called _ value function _ or _ optimal cost - to - go_. the homogenization problem for ( [ sde])([rgcost ] ) can be studied using a multiscale expansion of the nonlinear pde ( [ hjb ] ) in terms of the small parameter @xmath23 ; see , e.g. , @xcite . in this article",
    "we remove the nonlinearity from the equation by means of a logarithmic transformation of the value function .",
    "specifically , let @xmath71 by chain rule , @xmath72 which , together with the relation @xmath73 implies that ( [ hjb ] ) is equivalent to the linear boundary value problem @xmath74 for the function @xmath75",
    ". by the feynman - kac formula , has an interpretation as a control - free sampling problem ( see ( * ? ? ?",
    ".  8.2.1 ) ) : @xmath76 where @xmath77 solves the control - free sde @xmath78 equations ( [ hjb])([phi - exp ] ) express a legrendre - type duality between the value of an optimal control problem and cumulant generating functions @xcite : @xmath79 in other words , @xmath80 where @xmath81 satisfies the controlled sde ( [ sde ] ) and @xmath82 . + by the above assumptions and the strong maximum principle for elliptic pdes it follows that ( [ linbvp ] ) has a classical solution @xmath83 .",
    "moreover , combining assumption 3 , ( [ phi - exp ] ) and hlder s inequality , we have that @xmath84 and @xmath85 where @xmath86 and @xmath87 , and thus @xmath88 for a constant @xmath89 that is independent of @xmath23 .",
    "in the course of the paper we will drop the assumption that the operator @xmath90 is uniformly elliptic and instead require only that is hypoelliptic @xcite . in this case",
    "the matrix @xmath91 can be semidefinite , if the vector field @xmath92 satisfies an additional controllability assumption , known as hrmander s condition @xcite , which guarantees that the transition probability has a strictly positive density with respect to lebesgue measure , in which case ( [ linbvp ] ) and ( [ hjb ] ) have classical solutions ; cf .",
    "iv ) .",
    "we now specify the class of multiscale systems considered in this article .",
    "specifically , we address slow - fast systems of the form    [ sdexy ] @xmath93    together with an exponential expectation @xmath94 letting @xmath90 denote the infinitesimal generator of ( [ sdexy ] ) , it holds that @xmath95 where @xmath96 with @xmath97 let us assume that @xmath98 admits the following perturbation expansion in powers of @xmath23 : @xmath99 by substituting the ansatz into ( [ fk - homo ] ) and comparing different powers of @xmath100 we obtain a hierarchy of equations , the first three of which are @xmath101 we suppose that for each fixed @xmath11 , the dynamics ( [ sdeadjoint ] ) of the fast variables are ergodic , with the unique invariant density @xmath102 . then by construction @xmath103 is the unique solution of the equation @xmath104 , which together with the first equation of ( [ terms - homo ] ) implies that @xmath105 is independent of @xmath106 . in order to proceed ,",
    "we further assume that @xmath107 satisfies the _ centering condition _ : @xmath108 the centering conditions , together with the strong maximum principle implies that the solution of the cell problem @xmath109 is unique , with @xmath110 .",
    "multiplying @xmath102 on both sides of the third equation in ( [ terms - homo ] ) and integrating with respect to @xmath106 , we obtain @xmath111 where @xmath112 with @xmath113 \\rho_x(y ) \\,dy , \\\\",
    "\\bar{g}(x )   = & \\int g(x , y ) \\rho_x(y ) \\,dy , \\\\",
    "\\bar{\\alpha}(x)\\bar{\\alpha}(x)^t   = & \\int \\left[\\beta\\left(\\theta(x , y)f_0(x , y)^t + f_0(x , y)\\theta(x , y)^t\\right ) \\right . \\\\ & + \\left . \\alpha_1(x , y)\\alpha_1(x , y)^t\\right ] \\rho_x(y)\\ , dy \\ , . \\end{split } \\label{homo - generator2}\\end{aligned}\\ ] ]      it follows using standard homogenization theory for linear elliptic equations ( e.g. @xcite ) that for @xmath114 the solution of ( [ fk - homo ] ) converges to the leading term of the asymptotic expansion : @xmath115 where @xmath116 is the solution of the homogenized sde @xmath117 with coefficients as given in ( [ homo - generator2 ] ) .",
    "the corresponding asymptotic expansion of the value function @xmath70 for @xmath118 is obained by the logarithmic transformation  :    @xmath119    therefore , using the ansatz @xmath120 it follows that @xmath121 using the log - transformation property of the cumulant generating function ( p.  ) , we conclude that @xmath122 is the value function of the optimal control problem @xmath123 ds ~\\bigg|~x^u_0 = x \\right),\\end{aligned}\\ ] ] where the minimization is subject to the homogenized dynamics @xmath124 according to , the optimal feedback law for the homogenized problem reads @xmath125      our goal is to find the optimal control policy @xmath126 for the fast / slow system   for @xmath127 .",
    "using theorem  [ thm - dp ] and the asymptotic expansion of @xmath70 , we have @xmath128    notice that the leading terms in ( [ opt - control-1 ] ) are related to the value function of optimal control problem for the reduced sde .",
    "this indicates that we may design the control policy from the reduced problem and use it to control the original multiscale equation .",
    "this assertion is justified by the following result for the general optimal control problem .",
    "let assumptions 1,2 and 3 hold and , furthermore , suppose that @xmath129 and @xmath130 uniformly in @xmath131 .",
    "then we have @xmath132 [ thm : entropyindefinite ]    the proof of the theorem can be found in appendix  [ sec - cost_function ] . + upon combining the above theorem with the formula for the optimal control policy in   we conclude that when the two time scales in the system are well separated , @xmath133 , the optimal control policy is well approximated by the leading order terms in   and results in a cost value that is nearly optimal .",
    "all considerations in this paper readily generalize to the averaging problem , i.e. when @xmath134 in ( [ sdexy ] ) .",
    "this is not surprising since for averaging problems strong convergence @xmath135 is expected to hold ( when the diffusion coefficient @xmath136 in   is independent of the fast variable @xmath106 ) .",
    "related problems have been addressed in @xcite , in which the authors study parameter estimation and convergence of the maximum likelihood function under averaging and homogenization .",
    "in this section we apply the results presented in the previous section to three typical multiscale models . for each model we first state the optimal control problem along with its log - transformed counterpart",
    ", then we study the asymptotic limits of the value function and of the optimal control policy and give explicit formulae for the solution .",
    "the first two examples are taken from @xcite , while the third is adapted from  @xcite .",
    "we consider the second - order langevin equation @xmath137 where @xmath138 , and @xmath139 being a smooth the potential energy function . introducing the auxiliary variable @xmath140 we can recast ( [ langevin ] ) as    @xmath141    [ langevin-2var ]",
    "we consider the solution of the optimal control problem @xmath142 ds~\\bigg|~x^{\\epsilon , u}_0 = x , y^{\\epsilon , u}_0 = y\\right)\\end{aligned}\\ ] ] under the controlled langevin dynamics    @xmath143    [ ex1-control - eqn ]    we notice that   is somewhat different to the form specified in section [ sec : mms ] , since there is no noise and hence no control term in the equation for @xmath144 .",
    "the infinitesimal generator correpsonding to ( [ langevin-2var ] ) is hypoelliptic ( rather than elliptic ) . yet",
    "the standard homogenization arguments apply , for here the fast variable is @xmath106 and the noise is acting uniformly in @xmath106 . as a consequence",
    "the generator of the fast dynamics is uniformly elliptic , ans hence the standard theory applies .",
    "let @xmath145 assuming that the linear boundary value problem ( [ linbvp ] ) associated with @xmath75 has a classical solution , then the dual relation @xmath146 holds and the results of the previous section carries over without alternations .      from the above and the considerations from the previous section we can conclude that the leading term of @xmath147 satisfies the optimal control problem of the homogenized sde , which is @xmath148 equation ( [ e : overdamped ] ) is called the _ overdamped langevin equation _",
    "that is obtained from ( [ langevin ] ) by letting the inertial second - order term tend to zero @xcite .",
    "we now derive an explicit asymptotic expression for the optimal feedback law @xmath149 , with @xmath150 and @xmath151 from ( [ ex1-control - eqn ] ) and the expansion @xmath152 we find @xmath153 as before @xmath154 is the solution to the associated cell problem . to solve it we notice that the infinitesimal generator of ( [ langevin-2var ] ) has the form @xmath155 with @xmath156 which implies that the cell problem for @xmath154 reads @xmath157 with unique solution @xmath158 . combining it with ( [ ex1-u-1 ] )",
    ", we obtain the sought asymptotic expression for the optimal feedback law : @xmath159 with @xmath160 as given in ( [ v0-langevin ] ) .",
    "we therefore conclude that the optimal control @xmath161 for the langevin equation converges to the optimal control of the overdamped equation   as @xmath114 .",
    "moreover , theorem  [ thm : entropyindefinite ] guarantees that the control value is asymptotically exact if we replace @xmath161 with the control @xmath162 in the multiscale dynamics ( [ ex1-control - eqn ] ) .",
    "hence the overdamped equation is backward stable .",
    "as an example consider the case @xmath163 , with running cost @xmath164 in ( [ value - fun - indefinite ] ) and random stopping time @xmath165 the dynamics are governed by the double - well potential @xmath166 depicted in figure [ fig - ex1a ] .",
    "as the homogenized problem is one - dimensional , the leading term @xmath122 of the value function @xmath70 can be computed by solving a two - point boundary value problem . the resulting leading term ( [ ex1-u ] ) for the optimal control @xmath167 is shown in figure [ fig - ex1c ] .",
    "we then computed the cost function @xmath168 starting from three different initial points @xmath169 , using the approximation @xmath170 figure [ fig - ex1d ] clearly shows that @xmath171 approaches its infimum @xmath172 as @xmath118 .",
    "a clear advantage of controlling the full dynamics using the optimal control obtained from the reduced model here is that the infinitesimal generator @xmath90 of the original langevin dynamics is not self - adjoint , whereas the infinitesimal generator @xmath173 of the reduced dynamics is essentially self - adjoint .",
    "that is , not only do we benefit from a lower dimensionality of the reduced - order model ( by a factor of 2 ) , but we also avoid solving a boundary value problem with a non - selfadjoint operator .     .",
    "( b ) leading term of optimal control in ( [ ex1-u ] ) .",
    "[ fig - ex1],title=\"fig:\",width=188 ] [ fig - ex1a ]     .",
    "( b ) leading term of optimal control in ( [ ex1-u ] ) .",
    "[ fig - ex1],title=\"fig:\",width=188 ] [ fig - ex1c ]    .",
    "different colors correspond to different initial values @xmath174 .",
    "lines marked with `` @xmath175 '' are the value function @xmath70 computed from the exponential expectation using monte - carlo .",
    "lines marked with `` @xmath176 '' are the cost function @xmath177 , computed from the homogenized control with the original dynamics .",
    "we observe that the two values approach @xmath172 as @xmath114 ( horizontal line ) .",
    "[ fig - ex1d],width=340 ]      we now consider the sde @xcite @xmath178 where @xmath179 and @xmath180 , with @xmath181 being a smooth , @xmath182-periodic function ( see fig .  [",
    "fig : mspot ] below ) .",
    "we study the optimal control problem @xmath183 where @xmath184 and @xmath185 is the first hitting time of the set @xmath186 ( blue region in fig .",
    "[ fig : mspot ] ) .",
    ", width=302 ]    in order to relate this system with the homogenization problem studied in section  [ ssec : homo ] , we introduce the auxiliary variable @xmath187 and reformulate ( [ ex2-dynamics ] ) as    @xmath188    [ ex2-sde-1 ]    where @xmath189 are driven by the same noise @xmath190 .",
    "the associated value function reads @xmath191 with    [ eq : controledperiodicms ] @xmath192    notice that the same noise and the same control are applied to both equations . clearly @xmath193 and the dual relation @xmath194 applies , where @xmath195 is defined as in section [ ssec : homo ] .",
    "the generator of ( [ ex2-sde-1 ] ) now is @xmath196 with @xmath197      applying the results of section [ sec : mms ] , we conclude that the leading term of @xmath198 is the value function of the following reduced - order optimal control problem : minimize @xmath199 subject to the homogenized dynamics @xmath200 with the effective diffusivity @xmath201 in the above formula @xmath202 denotes the invariant density of the fast variable @xmath106 and @xmath203 is the solution of the poisson equation @xmath204 specifically , we have ( cf .",
    "@xcite for details ) @xmath205    the value function of the homogenized control problem  and the corresponding optimal control satisfy @xmath206 and @xmath207 where @xmath208 as given in .",
    "in contrast to the previous example , however , the optimal control @xmath209 obtained from the homogenized equation alone does meet the requirements of backward stability .",
    "this can be understood by noting that the optimal control the original dynamics is given by the feedback law @xmath210 which can be formally derived from the expansion @xmath211 after some manipulations we find that the asymptotic expression for @xmath212 reads @xmath213 where we used the shorthand @xmath214 in the last row .",
    "therefore we conclude that @xmath215 must be of the form @xmath216 yet @xmath217 does not converge to @xmath218 in any reasonable norm , for the @xmath219 part keeps oscillating as @xmath7 .",
    "what does converge , however , is the _ average _ : @xmath220 this fact is illustrated in figure [ fig : multiscalecontrol ] which shows the oscillations of order one that are a consequence of the @xmath23-periodic oscillations of the value function ; since the optimal control law involves the derivative of the value function , oscillations of size @xmath23 in the value function turn into @xmath221 contributions to the optimal control .",
    "figure [ fig : convvf ] shows the difference between the homogenized value function @xmath222 and its multiscale counterpart @xmath198 in the @xmath223-norm .",
    "the figure also shows the @xmath223-difference between the multiscale optimal feedback law @xmath224 and the corrected homogenized feedback law @xmath225 , including the oscillatory correction .",
    "this demonstrates strong @xmath226 convergence in @xmath223 of both value function and optimal control .",
    "+     the above case is an example in which using a reduced - order models for optimal control is not recommended , for @xmath227 does not converge to @xmath228 as @xmath7 .",
    "nonetheless , theorem  [ thm : entropyindefinite ] suggests that we can use the leading term of @xmath212 in ( [ ex2-u-2 ] ) as an approximation of the feedback law for the multiscale dynamics ( [ controled_ex2 ] ) .",
    "the effect of the corrector estimate ( [ ex2-u-2 ] ) , is to enforce convergence of the _ derivative _ of the value function , which entails ( weak ) convergence of the optimal control and convergence of the optimal cost value ( cf .",
    "@xcite for an application in importance sampling ) .",
    "convergence of value function and optimal control.[fig : convvf],width=359 ]      as a specific example , we have solved the optimal control problem  for the mean first passage time , with @xmath229 and @xmath19 being the first passage time of the set @xmath230 , and compared it with the solution of the homogenized system . the potential @xmath231 is chosen to be a tilted double - well potential , @xmath232 with periodic perturbation @xmath233 we have solved the associated boundary value problems using the finite - volume method presented in @xcite using a mesh sufficiently fine for the error to be smaller than a certain threshold .",
    "the resulting value functions are presented in figure [ fig : vf1 ] . for comparison , we have also simulated the multiscale system driven by the optimal control for the homogenized system , @xmath234 with @xmath235 and @xmath236",
    ". this situation amounts to using the ( wrong ) homogenized control in the original multiscale dynamics . to illustrate the shortcoming of such an approach",
    ", we have calculated the control value @xmath237 by markov - jump monte carlo ( mjmc ) simulations ( see @xcite ) .",
    "as it is shown in figure [ fig : vf1 ] , equation does not capture the control value @xmath227 as @xmath7 ; in order to reproduce the control value correctly , one must instead use the corrected control @xmath238 as given in .     .",
    "solid line : numerical solution of eq .  .",
    "dashed line : numerical solution of eq .  .",
    "@xmath239 : mjmc sampling of .",
    "@xmath176 : mjmc sampling using . throughout the simulations we have set @xmath240,title=\"fig:\",width=264 ] [ fig : vfeps1 ]        .",
    "solid line : numerical solution of eq .  .",
    "dashed line : numerical solution of eq .  .",
    "@xmath239 : mjmc sampling of .",
    "@xmath176 : mjmc sampling using . throughout the simulations we have set @xmath240,title=\"fig:\",width=264 ] [ fig : vfeps2 ]",
    "the third example is a multiscale linear quadratic regulator ( lqr ) problem that slightly falls out of the previous category . specifically , we seek to minimize the time - averaged quadratic cost @xmath241 subject to the linear dynamics @xmath242 where @xmath243 , @xmath244 , and @xmath245 , @xmath246 are real matrices of appropriate size .",
    "note that both slow and fast equations are driven by the same noise and control .",
    "further let @xmath247 we make the following additional assumptions ( we suppress the @xmath23 in the matrix definition in order to keep the notation compact ) :    1 .",
    "the initial values @xmath248 are independent of @xmath23 and satisfy @xmath249<\\infty\\,,\\quad { { \\mathbf e}}[|y_{0}|^{2}]<\\infty\\,.\\ ] ] 2",
    ".   for all @xmath41 , the spectrum of @xmath250 lies entirely in the open left half complex plane , i.e. , all eigenvalues of @xmath250 have strictly negative real part .",
    "3 .   the spectrum of @xmath251 lies entirely in the open left half complex plane .",
    "4 .   for all @xmath41 ,",
    "the matrix pair @xmath252 is controllable , i.e. , the matrix @xmath253 has maximum rank @xmath39 .    for the control problem ( [ lqr1])([lqr2 ] ) ,",
    "the analog of ( [ hjb ] ) for the case of an infinite - time horizon with time - averaged cost and unbounded domain reads @xcite @xmath254 where @xmath255 and @xmath256 the unknown parameter @xmath257 in the hamiton - jacobi - bellman equation ( [ ergodhjb ] ) needs to be determined along with the function @xmath258 , in fact ( [ ergodhjb ] ) can be regarded as a nonlinear eigenvalue equation for the pair @xmath259 ; for details we refer to appendix [ sec : ergode ] .",
    "lqr problems of this kind have quadratic value functions and admit an explicit solution in terms of an algebraic riccati equation @xmath260 where @xmath261 denotes the @xmath262 identity matrix . specifically , plugging the ansatz @xmath263 into ( [ ergodhjb ] )",
    ", it readily follows that @xmath264 solves ( [ ricc ] ) .",
    "hence the optimal control for the linear quadratic regulator ( [ lqr1])([lqr2 ] ) is given by the linear feedback law @xmath265 under the above assumptions , the riccati equation has a unique symmetric positive definite solution @xmath264 for all values of @xmath41 .",
    "moreover , it follows that @xmath266 which is the principal eigenvalue of the linear eigenvalue equation @xmath267 for the log - transformed eigenfunction @xmath268 .",
    "notice that the eigefunction @xmath75 corresponding to the principal eigenvalue @xmath269 is strictly positive as a consequence of the perron - frobenius theorem , hence its log transformation is well defined .",
    "given the above assumptions on the matrices @xmath250 and @xmath270 , the homogenized version of the linear eigenvalue equation ( [ linevp ] ) can be easily computed , since the cell problem has an explicit solution .",
    "we find @xmath271 with the homogenized coefficients @xmath272 and @xmath273 denoting the sum of the eigenvalues of the asymptotic covariance matrix of the fast degrees of freedom .",
    "the limiting eigenpair @xmath274 is given by @xmath275 where @xmath276 is the solution of the homogenized riccati equation @xmath277 in accordance with the solution of the algebraic riccati equation of singularly - perturbed lqr problems that has been discussed in the literature ; see @xcite and the references therein .",
    "it can be shown by perturbation analysis of the riccati equation ( [ ricc ] ) using the chow transformation ( see , e.g. , @xcite and the references therein ) that @xmath276 corresponds to the top left @xmath278 block of the matrix @xmath276 up to @xmath279 . moreover , for any open and bounded subset @xmath280 with smooth boundary , we have @xmath281 for @xmath282 and some constant @xmath283 .",
    "the latter implies that @xmath284 uniformly on @xmath285 $ ] where @xmath286 is the first exit time from @xmath280 and @xmath287 . for large values of @xmath288 the probability that the process exits from @xmath289 is exponentially small in @xmath288 , i.e. , the exit from the domain is a rare event ( see , e.g. , @xcite ) and hence we can employ the approximation @xmath290 for all practical purposes .",
    "we consider the 270-dimensional model of a component of the international space station ( iss ) that is taken from the slicot benchmark library @xcite . in this case ,",
    "@xmath291 and @xmath292 in equation ( [ lqr1 ] ) ; the dimension of the slow subspace is set to @xmath293 , because the spectrum of dimensionless hankel singular values of the full system shows a significant spectral gap at @xmath293 when the slow variables are chosen as the observed variables ; see @xcite for details .",
    "the original system is hamiltonian , but we pay no attention to the specific geometric structure of the equations here ; cf .",
    "@xcite for related work .",
    "the corresponding control task for the 4-dimensional reduced system thus is to minimize @xmath294 subject to the dynamics @xmath295 with @xmath296 and @xmath297 as in ( [ riccred ] ) . without loss of generality",
    ", we have ignored the additive constant @xmath298 in the cost term that appears in the homogenized eigenvalue equation ( [ linevpred ] ) . as before the optimal control",
    "is given by the linear feedback law @xmath299 where @xmath276 denotes the solution of ( [ ricc ] ) .",
    "to verify the convergence of the value function numerically , we have computed eigenvalues of @xmath276 and @xmath264 , the matrix norms of @xmath300 and the norm of the matrix @xmath264 with the @xmath301 block set to zero , called @xmath302 .",
    "here @xmath301 refers to the upper left @xmath278 block of the matrix @xmath264 , in accordance with the notation in ( [ lqr2 ] ) . figure  [ fig : lqr ] shows this comparison for @xmath303 , which , given the parameters of the iss model , amounts to the small noise regime ; the plots clearly show that the convergence is of @xmath279 .",
    "we refrain from testing the convergence @xmath304 of the corresponding nonlinear eigenvalue since the @xmath305 singularity makes the evaluation of the trace term @xmath306 numerically unstable for all interesting values of @xmath23 .     in terms of the @xmath307 dominant eigenvalues ( upper left panel ) , the 1 - 1 matrix block ( upper right panel ) and the residual matrix @xmath308 ( lower left panel ) ; for smaller values of @xmath23 the numerical solution of the riccati equation is dominated by round - off errors , hence the results are not shown .",
    "the lower right panel shows the first 40 hankel singular values ( out of 270 ) when the slow variables are observed ; the hankel singular values are independent of @xmath23 .",
    ", title=\"fig:\",scaledwidth=49.5% ]   in terms of the @xmath307 dominant eigenvalues ( upper left panel ) , the 1 - 1 matrix block ( upper right panel ) and the residual matrix @xmath308 ( lower left panel ) ; for smaller values of @xmath23 the numerical solution of the riccati equation is dominated by round - off errors , hence the results are not shown .",
    "the lower right panel shows the first 40 hankel singular values ( out of 270 ) when the slow variables are observed ; the hankel singular values are independent of @xmath23 .",
    ", title=\"fig:\",scaledwidth=49.5% ] +   in terms of the @xmath307 dominant eigenvalues ( upper left panel ) , the 1 - 1 matrix block ( upper right panel ) and the residual matrix @xmath308 ( lower left panel ) ; for smaller values of @xmath23 the numerical solution of the riccati equation is dominated by round - off errors , hence the results are not shown .",
    "the lower right panel shows the first 40 hankel singular values ( out of 270 ) when the slow variables are observed ; the hankel singular values are independent of @xmath23 .",
    ", title=\"fig:\",scaledwidth=49.5% ]   in terms of the @xmath307 dominant eigenvalues ( upper left panel ) , the 1 - 1 matrix block ( upper right panel ) and the residual matrix @xmath308 ( lower left panel ) ; for smaller values of @xmath23 the numerical solution of the riccati equation is dominated by round - off errors , hence the results are not shown .",
    "the lower right panel shows the first 40 hankel singular values ( out of 270 ) when the slow variables are observed ; the hankel singular values are independent of @xmath23 . , title=\"fig:\",scaledwidth=49.5% ]",
    "as we have seen in section [ subsec - examples - homo ] loss of backward stability of the model reduction approach is related to weak convergence of the multiscale controls .",
    "weak convergence is mainly an issue for homogenization problems with periodic coefficients that do not involve any explicit time - dependence . for control problems on a finite time - horizon ,",
    "a well - known result ( e.g. , see ( * ? ? ?",
    "3 ) or ( * ? ? ?",
    "* sec .  20 ) ) that is based on the maximum principle states that the convergence of the log - transformed parabolic equation is uniform on bounded time intervals under fairly weak assumptions .    in the indefinite time - horizon case considered in this paper",
    ", however , the lowest order approximation gives only weak convergence .",
    "in general , weak convergence is not preserved under nonlinear transformation .",
    "that is , given a weakly convergent sequence @xmath75 on @xmath309 and a nonlinear continuous function @xmath310 , we have @xmath311 in our case , however , weak convergence follows from the properties of the logarithm and the fact that @xmath75 is bounded away from 0 . let @xmath75 be the solution of the elliptic boundary value problem ( [ linbvp ] ) for @xmath312 and recall that @xmath313 and @xmath314 moreover , we have that @xmath315 for some @xmath316 .",
    "we have @xmath317    since @xmath318 the monotony of the logarithm entails that @xmath319 since @xmath320 and @xmath31 is bounded it follows that @xmath321 and , by the same argument , @xmath322 .",
    "convergence now follows from the fact that @xmath323 is lipschitz continuous with a lipschitz constant @xmath324 if @xmath325 : @xmath326 which vanishes in the limit @xmath7 as @xmath135 in @xmath327 .",
    "this implies strong convergence of the value function . for the optimal control ,",
    "the above conditions give only weak convergence , which is implied by :    we have @xmath328    it suffices to show that @xmath329 in @xmath327 . to this end recall that @xmath330 in @xmath327 since @xmath75 converges weakly in @xmath331 .",
    "then , for all test functions @xmath332 , using again that @xmath333 pointwise and uniformly in @xmath23 , @xmath334 we look at the two integrals separately .",
    "using that @xmath335 it follows that @xmath336 since @xmath332 and @xmath330 weakly in @xmath327 .",
    "now for the second integral : since the weakly convergent sequence @xmath75 and its limit @xmath337 are bounded in @xmath331 we conclude that @xmath338 , which together with the boundedness of @xmath339 implies that @xmath340 .",
    "so , by the cauchy - schwarz inequality , @xmath341 for some constant @xmath342 . reiterating the preceding argument it follows that @xmath343 as @xmath135 in @xmath327 and @xmath338 .",
    "hence @xmath344 which , together with the last lemma yields the assertion .",
    "we briefly discuss the ergodic control problem of section [ subsec - examples - linear ] that is known to be related to an elliptic eigenvalue problem @xcite . in principle",
    ", the equivalence of ( [ linevp ] ) and ( [ ergodhjb ] ) directly follows from the logarithmic transformation . here",
    ", we give an alternative derivation of the associated hjb equation , starting from the underlying kolmogorov backward equation . to this end",
    "let @xmath345 for a continuous bounded function @xmath346 further let @xmath347 be given by @xmath348 by the feynman - kac formula @xmath349 is the solution of @xmath350 here @xmath351 denotes the infinitesimal generator of our generic uncontrolled diffusion process . setting @xmath352 , we can rewrite equation   in the form @xmath353 assuming that the limit exists , this motivates the following asymptotic ansatz for large @xmath131 : @xmath354 plugging the separation ansatz into ( [ fk3 ] ) it follows that @xmath75 solves the eigenvalue equation @xmath355 or , equivalently , @xmath356 as a consequence of the perron - frobenius theorem the eigenfunction @xmath75 corresponding to the principal eigenvalue @xmath357 is strictly positive . the equivalent nonlinear eigenvalue problem for",
    "the log - transformed eigenfunction @xmath358 reads @xmath359 which , as before , can be rewritten in the form @xmath360 the last equation is recognized as the dynamic programming equation of the ergodic optimal control problem , of which ( [ lqr1])([lqr2 ] ) is a special case : minimize @xmath361 subject to @xmath362      let @xmath255 and consider the expansion @xmath363 and @xmath364 , as in the previous subsections .",
    "the leading term in the expansion @xmath105 is independent of @xmath106 and satisfies @xmath365 with @xmath366 defined in  .",
    "now suppose @xmath367 , then again @xmath368 this indicates that the leading nonlinear eigenpair @xmath369 satisfies latexmath:[\\[\\eta_0 = \\limsup_{t \\to\\infty } { { \\mathbf e}}\\left(\\frac{1}{t}\\int_0^{t } \\left(\\bar{g}(x_s ) + \\frac{1}{2 }    where @xmath6 solves the optimally controlled sde @xmath371 by ergodicity of the controlled process , the above expectation is independent of the distribution of the initial values ; see @xcite and the references therein .",
    "in this section we study the cost function of the optimal control problem from the point of view of change of measure .",
    "[ sec - cost_function ] consider the sde @xmath372 and the controlled sde @xmath373 where @xmath374 is any bounded measurable control that is adapted to @xmath375 .",
    "let @xmath376 and @xmath377 denote the path measures generated by ( [ sec - cost - sde1 ] ) and ( [ sec - cost - csde ] ) , respectively .",
    "then by girsanov s theorem @xcite , we have that @xmath378 let a cost functional be given by @xmath379 where @xmath51 satisfies assumption 2 from section  [ ssec : logtrafo ] .",
    "here we use the notation @xmath380 to indicate that the expectation is understood with respect to the probability measure @xmath377 . moreover the dependence of @xmath29 on the initial value @xmath53 is omitted .",
    "let @xmath381 , then from theorem [ thm : verification ] we know @xmath382 only depends on @xmath375 .",
    "let @xmath383 denote the measure @xmath384 for simplicity .",
    "our purpose here is to estimate @xmath385 when @xmath386 is small .",
    "we will make use of the following definition .",
    "we also assume that assumption 3 from section  [ ssec : logtrafo ] holds : there exists @xmath391 , such that @xmath392 . as in section [ ssec : logtrafo ] , we have that @xmath393 here and in the following , the conditioning on the initial value is omitted .",
    "we have @xmath395 . using the dual relation @xmath396 and jensen s inequality , we know that @xmath397 where we have assumed the equivalence of @xmath376 and @xmath383 . since @xmath51 is nonnegative",
    ", @xmath398                it follows from ( [ jensen - as ] ) that we can write the above as @xmath410\\end{aligned}\\ ] ] combining this with ( [ sec - cost - girsanov ] ) , we get @xmath411 the conclusion now readily follows from lemma [ lemma-1 ] .                    , _ singular perturbations in stochastic control _ , in singular perturbations and asymptotic analysis in control systems , p.  v. kokotovic , a.  bensoussan , and g.  l. blankenship , eds .",
    "90 of lecture notes in control and information sciences , springer berlin heidelberg , 1987 , pp .",
    "171260 .                                                      , _ singular perturbation techniques in control theory _ , in singular perturbations and asymptotic analysis in control systems , p.  v. kokotovic , a.  bensoussan , and g.  l. blankenship , eds .",
    "90 of lecture notes in control and information sciences , springer berlin heidelberg , 1987 , pp .",
    "155 .                                                , _ optimal control of robot guided laser material treatment _ , in progress in industrial mathematics at ecmi 2008 , a.  d. fitt , j.  norbury , h.  ockendon , and e.  wilson , eds . ,",
    "springer berlin heidelberg , 2010 , pp ."
  ],
  "abstract_text": [
    "<S> we study optimal control of diffusions with slow and fast variables and address a question raised by practitioners : is it possible to first eliminate the fast variables before solving the optimal control problem and then use the optimal control computed from the reduced - order model to control the original , high - dimensional system ? </S>",
    "<S> the strategy `` first reduce , then optimize''rather than `` first optimize , then reduce''is motivated by the fact that solving optimal control problems for high - dimensional multiscale systems is numerically challenging and often computationally prohibitive . </S>",
    "<S> we state sufficient and necessary conditions , under which the `` first reduce , then control '' strategy can be employed and discuss when it should be avoided . </S>",
    "<S> we further give numerical examples that illustrate the `` first reduce , then optmize '' approach and discuss possible pitfalls . </S>"
  ]
}