{
  "article_text": [
    "density functional theory ( dft ) , in both its static @xcite and time - dependent @xcite forms , has become by far the most successful and widely used among all the electronic structure methods .",
    "the most obvious reason for this success is that it provides accurate predictions of numerous properties of atoms , inorganic molecules , bio - molecules , nanostructures and solids , thus serving different scientific communities .",
    "in addition dft has a solid theoretical foundation .",
    "the hohenberg - kohn theorem @xcite establishes the existence of a unique energy functional @xmath1 $ ] of the electron density @xmath2 which alone is sufficient to determine the exact ground - state of a @xmath3-electron system .",
    "although the energy functional itself is not known , several of its general properties can be demonstrated rigorously .",
    "these are crucial for constructing increasingly more predictive approximations to the functional and for addressing the failures of such approximations@xcite .",
    "finally , but no less important , the kohn - sham ( ks ) formulation of dft @xcite establishes a one to one mapping of the intrinsically many - body problem onto a fictitious single - particle system and offers a convenient way for minimizing @xmath1 $ ] .",
    "the degree of complexity of the kohn - sham ( ks ) problem depends on the approximation chosen for the density functional . in the case of the local density approximation ( lda )",
    "@xcite the ks problem typically scales as @xmath4 , where the scaling is dominated by the diagonalization algorithm . however , clever choices with regards to basis sets and sophisticated numerical methods make order-@xmath3 scaling a reality @xcite .    the energy",
    "functional @xmath5 $ ] ( @xmath6 , @xmath7 is the spin density , @xmath8 ) can be written as @xmath9=t_\\mathrm{s}[\\rho]+\\int\\mathrm{d}^3{\\bf r}\\:\\rho({\\bf r})v({\\bf r})+u[\\rho]+e_\\mathrm{xc}[\\rho^\\uparrow,\\rho^\\downarrow]\\ ; , \\label{enfunc}\\ ] ] where @xmath10 is the kinetic energy of the non - interacting system , @xmath11 the external potential , @xmath0 the hartree electrostatic energy and @xmath12 the exchange and correlation ( xc ) energy .",
    "this last term is unknown and must be approximated .",
    "the construction of an approximated functional follows two strategies : empirical and `` constraint satisfaction '' .",
    "empirical xc functionals usually violate some of the constraints imposed by exact dft , and rely on parameterizations obtained by fitting representative data .",
    "one includes in this category , xc functionals which borrow some functional dependence from other theories .",
    "this is for instance the case of the celebrated lda+@xmath0 scheme @xcite , where the hubbard-@xmath0 energy takes the place of the lda energy for certain `` strongly correlated '' atomic orbitals ( typically @xmath13 and @xmath14 shells ) .",
    "the method however depends on the knowledge of the coulomb and exchange parameters @xmath0 and @xmath15 , which vary from material to material , and can also be different for the same ion in different chemical environments @xcite .",
    "in contrast the construction based on `` constraint satisfaction '' proceeds by developing increasingly more sophisticated functionals , which nevertheless satisfy most of the properties of exact dft @xcite . it was argued that this method constructs a `` jacob s ladder '' @xcite , where functionals are assigned to different rungs depending on the number of ingredients they include .",
    "thus the lda , which depends only on the spin - densities is on the first rung , the generalized gradient approximation ( gga ) @xcite , which depends also on @xmath16 , is on the second rung , the so - called meta - gga functionals @xcite , which in addition to @xmath6 and @xmath16 depend on either the laplacian @xmath17 or the orbital kinetic energy density , are on the third rung and so on .",
    "the higher its position on the ladder the more accurate a functional becomes , but at the price of increasing computational overheads .",
    "therefore its worth investigating corrections to the functionals of the lower rungs , which preserve most of the fundamental properties of dft and do not generate massive additional numerical overheads .",
    "one of the fundamental problems intrinsic to the semi - local functionals of the first three rungs is the presence of self - interaction ( si ) @xcite .",
    "this is the spurious interaction of an electron in a given ks orbital with the hartree and xc potential generated by itself .",
    "such an interaction is not present in the hartree - fock method , where the coulomb self - interaction of occupied orbitals is cancelled exactly by the non - local exchange .",
    "however when using semi - local functionals such a cancellation is not complete and the rigorous condition for ks - dft @xmath18+e_\\mathrm{xc}[\\rho_n^\\sigma,0]=0\\ ] ] for the orbital density @xmath19 of the fully occupied ks orbital @xmath20 is not satisfied .",
    "a direct consequence of the self - interaction in lda / gga is that the ks potential becomes too repulsive and exhibits an incorrect asymptotic behavior @xcite .",
    "this `` schizophrenic '' ( self - interacting ) nature of semi - local ks potentials generates a number of failures in describing elementary properties of atoms , molecules and solids .",
    "negatively charged ions ( h@xmath21 , o@xmath21 , f@xmath21 ) and molecules are predicted to be unstable by lda @xcite and transition metal oxides are described as small - gap mott - hubbard antiferromagnets ( mno , nio ) @xcite or even as ferromagnetic metals ( feo , coo ) @xcite instead of charge - transfer insulators .",
    "moreover the ks highest occupied molecular orbital ( homo ) , the only ks eigenvalue that can be rigorously associated to a single particle energy @xcite , is usually nowhere near the actual ionization potential @xcite .    finally xc functionals affected by si do not present a derivative discontinuity as a function of the occupation @xcite .",
    "semi - local functionals in fact continuously connect the orbital levels of systems of different integer occupation .",
    "this means for instance that when adding an extra electron to an open shell @xmath3-electron system the ks potential does not jump discontinuously by @xmath22 where @xmath23 and @xmath24 are respectively the ionization potential and the electron affinity for the @xmath3-electron system .",
    "this serious drawback is responsible for the incorrect dissociation of heteronuclear molecules into charged ions @xcite and for the metallic conductance of insulating molecules @xcite .",
    "the problem of removing the si from a semi - local potential was acknowledged a long time ago when fermi and amaldi proposed a first crude correction @xcite .",
    "however the modern theory of self - interaction corrections ( sic ) in dft is due to the original work of perdew and zunger from almost three decades ago @xcite .",
    "their idea consists in removing directly the self - hartree and self - xc energy of all the occupied ks orbitals from the lda xc functional ( the same argument is valid for other semi - local functionals ) , thus defining the sic functional as @xmath25=e_\\mathrm{xc}^\\mathrm{lda}[\\rho^\\uparrow,\\rho^\\downarrow]- \\sum_{n\\sigma}^\\mathrm{occupied}(u[\\rho_n^\\sigma]+e_\\mathrm{xc}^\\mathrm{lda}[\\rho_n^\\sigma,0])\\;. \\label{efsic}\\ ] ] although apparently simple , the sic method is more involved than standard ks dft .",
    "the theory is still a density functional one , i.e. it satisfies the hohenberg - kohn theorem , however it does not fit into the kohn - sham scheme , since the one - particle potential is orbital - dependent .",
    "this means that one can not define a kinetic energy functional independently from the choice of @xmath12 @xcite .",
    "two immediate consequences are that the @xmath20 are not orthogonal , and that the orbital - dependent potential can break the symmetry of the system .",
    "this last aspect is particularly important for solids since one has to give up the bloch representation .    in this paper",
    "we explore an approximate method for sic to the lda , which has the benefit of preserving the local nature of the lda potential , and therefore maintains all of the system s symmetries .",
    "we have followed in the footsteps of filippetti and spaldin @xcite , who extended the original idea of vogel and co - workers @xcite of considering only the atomic contributions to the sic .",
    "we have implemented such a scheme into the localized atomic orbital code _ siesta _",
    "@xcite and applied it to a vast range of molecules and solids .",
    "in particular we have investigated in detail how the scheme performs as a single - particle theory , and how the sic should be rescaled in different chemical environments .",
    "the direct subtraction proposed by perdew and zunger is the foundation of the modern sic method . however",
    "the minimization of the sic functional ( [ efsic ] ) is not trivial , in particular for extended systems .",
    "the main problem is that @xmath12 itself depends on the ks orbitals .",
    "thus it does not fit into the standard ks scheme and a more complicated minimization procedure is needed .    following the minimization strategy proposed by levy @xcite , which prescribes to minimize the functional first with respect to the ks orbitals @xmath20 and then with respect to the occupation numbers @xmath26 , perdew and",
    "zunger derived a set of single - particle equations @xmath27\\psi_n^\\sigma=\\epsilon_{n}^{\\sigma,\\mathrm{sic } } \\psi_n^\\sigma\\ ; , \\label{kssic}\\ ] ] where the effective single - particle potential @xmath28 is defined as @xmath29 ; { \\bf r})+v_\\mathrm{xc}^{\\sigma,\\mathrm{lda}}([\\rho^\\uparrow,\\rho^\\downarrow ] ; { \\bf r})-\\nonumber \\\\ -u([\\rho_n ] ; { \\bf r})-v_\\mathrm{xc}^{\\sigma,\\mathrm{lda}}([\\rho_n^\\uparrow,0 ] ; { \\bf r } ) \\ ; , \\label{kssic - pot}\\end{aligned}\\ ] ] and @xmath30 ; { \\bf r})=\\int\\mathrm{d}^3{\\bf r}^\\prime\\frac{\\rho({\\bf r}^\\prime)}{|{\\bf r}-{\\bf r}^\\prime|}\\ ; , \\\\ v_\\mathrm{xc}^{\\sigma,\\mathrm{lda}}([\\rho^\\uparrow,\\rho^\\downarrow ] ; { \\bf r})=\\frac{\\delta}{\\delta \\rho^\\sigma({\\bf r } ) } e_\\mathrm{xc}^\\mathrm{lda}[\\rho^\\uparrow,\\rho^\\downarrow]\\;.\\end{aligned}\\ ] ] these are solved in the standard ks way for atoms , with good results in terms of quasi - particle energies @xcite . in this particular case",
    "the ks orbitals @xmath20 show only small deviations from orthogonality , which is re - imposed with a standard schmidt orthogonalization .    the problem of the non - orthogonality of the ks orbitals can be easily solved by imposing the orthogonality condition as a constraint to the energy functional , thus obtaining the following single - particle equation @xmath27\\psi_n^\\sigma = \\sum_m\\epsilon_{nm}^{\\sigma,\\mathrm{sic}}\\psi_m^\\sigma\\;. \\label{kssic - orth}\\ ] ] even in this case where orthogonality is imposed , two major problems remain : the orbitals minimizing the energy functional are not ks - type and in general do not satisfy the system s symmetries .",
    "if one insists in minimizing the energy functional in a ks fashion by constructing the orbitals according to the symmetries of the system , the theory will become size - inconsistent , or in other words it will be dependent on the particular representation employed .",
    "thus one might arrive at a paradox , where in the self - interaction of @xmath3 hydrogen atoms arranged on a regular lattice of large lattice spacing ( in such a way that there is no interaction between the atoms ) vanishes , since the sic of a bloch state vanishes for @xmath31 .",
    "however the sic for an individual h atom , when calculated using atomic - like orbitals , accounts for essentially all the ground - state energy error @xcite .",
    "therefore a size - consistent theory of sic dft must look for a scheme where a unitary transformation of the occupied orbitals , which minimizes the sic energy is performed .",
    "this idea is at the foundation of all modern implementations of sic .",
    "significant progress towards the construction of a size - consistent sic theory was made by pederson , heaton and lin , who introduced two sets of orbitals : localized orbitals @xmath32 minimizing @xmath33 and canonical ( kohn - sham ) de - localized orbitals @xmath20 @xcite .",
    "the localized orbitals are used for defining the densities entering into the effective potential ( [ kssic - pot ] ) , while the canonical orbitals are used for extracting the lagrangian multipliers @xmath34 , which are then associated to the ks eigenvalues .",
    "the two sets are related by unitary transformation @xmath35 , and one has two possible strategies for minimizing the total energy .",
    "the first consists in a direct minimization with respect to the localized orbitals @xmath32 , i.e. in solving equation ( [ kssic - orth ] ) when we replace @xmath36 with @xmath37 and the orbital densities entering the definition of the one - particle potential ( [ kssic - pot ] ) are simply @xmath38 .",
    "in addition the following minimization condition must be satisfied @xmath39 where @xmath40 ; { \\bf r})+v_\\mathrm{xc}^{\\sigma,\\mathrm{lda}}([\\rho_n^\\uparrow,0 ] ; { \\bf r})$ ] .",
    "an expression for the gradient of the sic functional , which also constrains the orbitals to be orthogonal has been derived @xcite and applied to atoms and molecules with a mixture of successes and bad failures @xcite .",
    "the second strategy uses the canonical orbitals @xmath36 and seeks the minimization of the sic energy by varying both the orbitals @xmath36 and the unitary transformation @xmath41 .",
    "the corresponding set of equations is @xmath42 @xmath43 @xmath44 where @xmath45 is the standard lda hamiltonian ( without sic ) .",
    "thus the sic potential for the canonical orbitals appears as a weighted average of the sic potential for the localized orbitals .",
    "the solutions of the set of equations ( [ kssic - pro ] ) is somehow more appealing than that associated to the localized orbitals since the canonical orbitals can be constructed in a way that preserves the system s symmetries ( for instance translational invariance ) .",
    "a convenient way for solving the equation ( [ kssic - pro ] ) is that of using the so called `` unified hamiltonian '' method @xcite .",
    "this is defined as ( we drop the spin index @xmath46 ) @xmath47 where @xmath48 is the projector over the occupied orbital @xmath20 , and @xmath49 is the projector over the unoccupied ones @xmath50 .",
    "the crucial point is that the diagonal elements of the matrix @xmath34 and their corresponding orbitals @xmath20 are respectively eigenvalues and eigenvectors of @xmath51 , from which the whole @xmath34 can be constructed .",
    "finally , and perhaps most important , at the minimum of the sic functional , the canonical orbitals diagonalize the matrix @xmath34 , whose eigenvalues can now be interpreted as an analogue of the kohn - sham eigenvalues @xcite .",
    "it is also interesting to note that an alternative way for obtaining orbital energies is that of constructing an effective si - free local potential using the krieger - li - iafrate method @xcite .",
    "this has been recently explored by several groups @xcite    when applied to extended systems the sic method demands considerable additional computational overheads over standard lda .",
    "thus for a long time it has not encountered the favor of the general solid state community . in the case of solids",
    "the price to pay for not using canonical orbitals is enormous since the bloch representation should be abandoned and in principle infinite cells should be considered .",
    "for this reason the second minimization scheme , in which the canonical orbitals are in a bloch form , is more suitable . in this case for each @xmath52-vector one can derive an equation identical to equation ( [ kssic - pro ] ) , where @xmath53 and @xmath54 is simply the band index @xcite .",
    "the associated localized orbitals @xmath37 for instance can be constructed as wannier functions and the minimization scheme proceeds in a similar way to that done for molecules .",
    "the problem here is that in practice , the cell needed to describe the localized states @xmath37 may be considerably larger than the primitive unit cell .",
    "this is not the case for ionic insulators @xcite , where the localized orbitals are well approximated by atomic orbitals .",
    "such a simplification is however not valid in general .",
    "for example supercells as large as 500 atoms have been considered for describing the localized @xmath13 shells in transition metals oxides @xcite . despite these difficulties",
    "the sic scheme has been applied to a vast range of solid state systems with systematic improvement over lda .",
    "these include , in addition to transition metals monoxides @xcite , rare - earth materials @xcite , diluted magnetic semiconductors @xcite , fe@xmath55o@xmath56 @xcite , heavy elements compounds @xcite , just to name a few .    in order to make the sic method more scalable several approximations",
    "have been proposed .",
    "one possibility is that of incorporating part of the sic into the definition of the pseudopotentials @xcite .",
    "the idea consists in subtracting the atomic si from the free atom , and then transferring the resulting electronic structure to the definition of a standard norm - conserving pseudopotential .",
    "this approximation is sustained by the fact that the transformation @xmath41 , which relates canonical and localized orbitals does hardly mix core and valence states @xcite . thus the sic contribution to the total energy can be separated into the contributions from the core and the valence and in first approximation the latter can be neglected @xcite .",
    "the benefit of this method is that translational invariance is regained and the complicated procedure of minimizing @xmath41 is replaced by a pseudopotential calculation .",
    "a further improvement over the pseudopotential method was recently presented by vogel and co - workers @xcite and then extended by filippetti and spaldin @xcite .",
    "the method still assumes separability between the core and the valence contributions to the sic , but now the sic for the valence electrons is approximated by an atomic - like contribution , instead of being neglected .",
    "this atomic sic ( asic ) scheme is certainly a drastic approximation , since it implicitly assumes that the transformation @xmath41 minimizing the sic functional leads to atomic like orbitals .    in the work of vogel this additional contribution is not evaluated self - consistently for the solid , while the implementation of filippetti assumes a linear dependance of the sic over the orbital occupation . in spite of the approximations involved ,",
    "the method has been applied successfully to a range of solids including ii - vi semiconductors and nitrites @xcite , transition metal monoxides @xcite , silver halides @xcite , noble metal oxides @xcite , ferroelectric materials @xcite , high - k materials @xcite and diluted magnetic semiconductors @xcite .",
    "interestingly most of the systems addressed by the asic method are characterized by semi - core @xmath13 orbitals , for which an atomic correction looks appropriate , and a similar argument is probably valid for ionic compounds as recently demonstrated for the case of sic @xcite .    here",
    "we further investigate the self - consistent asic method @xcite by examining both finite and extended systems , and by critically considering whether a scaling factor , additional to the orbital occupation , is needed for reproducing the correct single particle spectrum .",
    "in this section we derive the fundamental equations of the asic method , while looking closely at the main approximations involved in comparison to the fully self - consistent sic approach .",
    "our practical implementation is also described .",
    "the starting point of our analysis is the sic schrdinger - like equation ( [ kssic - pro ] ) for the canonical orbitals .",
    "let us assume , as from reference @xcite , that the rotation @xmath41 transforming localized orbitals ( to be determined ) into canonical orbitals ( see equation ( [ sic - rot ] ) ) does not mix core and valence states .",
    "we also assume that core electrons are well localized into atomic - like wave - functions and that they can be effectively described by a norm - conserving pseudopotential .",
    "let us now assume that @xmath41 is known and so are the localized orbitals @xmath57 . in this case the canonical orbitals diagonalize @xmath34 and the equation ( [ kssic - pro ] ) simply reduces to @xmath58 with @xmath59 defined in equation ( [ dsic ] )",
    ". the hamiltonian @xmath60 can be then re - written in a convenient form as @xmath61 where @xmath62 is the self - interaction potential for the localized orbital @xmath57 , and @xmath63 is the projector over the same state @xmath64 two main approximations are then taken in the asic approach @xcite .",
    "first the localized states @xmath57 are assumed to be atomic - like orbitals @xmath65 ( asic orbitals ) and the sic potential is approximated as @xmath66 with @xmath67 ; { \\bf r})+v_\\mathrm{xc}^{\\sigma,\\mathrm{lda}}([\\rho_m^\\uparrow,0 ] ; { \\bf r})$ ] and @xmath68 , @xmath69 is the projector of equation ( [ phiproj ] ) obtained by replacing the @xmath37 s with the asic orbitals @xmath70 , and @xmath71 is a scaling factor . note that the orbitals @xmath72 are not explicitly spin - dependent and one simply has @xmath65=@xmath73 with @xmath74 the orbital occupation ( @xmath75 ) .",
    "the factor @xmath71 is an empirical factor , which accounts for the particular choice of asic orbitals .",
    "this first approximation is expected to be accurate for systems retaining an atomic - like charge density as in the case of small molecules .",
    "it is also formally exact in the one - electron limit ( for @xmath76 ) . in the case of extended solids",
    "the situation is less transparent , since in general the functions minimizing @xmath33 are wannier - like functions @xcite .",
    "the second approximation taken in the asic method is that of replacing the non - local projector @xmath69 with its expectation value .",
    "the idea is that the sic potential for the canonical orbitals @xmath59 is formally a weighted average of the sic potential for the localized orbitals @xmath77 . for the exact sic method the weighting factor is the non - local projector @xmath78 .",
    "this means that the sic potential for a given canonical orbital @xmath79 is maximized in those regions where the overlap with some of the localized orbitals @xmath80 is maximum . in the asic method such non - local projector",
    "is replaced more conveniently by a scalar . in the original proposal by voegl et al .",
    "@xcite this was simply set to one .",
    "here we consider the orbital occupation @xmath74 of the given asic orbital @xmath72 , i.e. we replace @xmath69 with its expectation value @xmath81 where @xmath82 is the occupation number of the kohn - sham orbital @xmath20 .",
    "the final form of asic potential is then @xmath83    let us now comment on the empirical scaling factor @xmath71 . in reference @xcite @xmath71 was set to @xmath84 in order to capture eigenvalue relaxation .",
    "this choice however violates the one - electron limit of the sic potential , which is correctly reproduced for @xmath76 .",
    "we can then interpret @xmath71 as a measure of the deviation of the asic potential from the exact sic potential .",
    "ultimately @xmath71 reflects the deviation of the actual asic projectors @xmath85 from the localized orbitals defining the si corrected ground state .",
    "one then expects @xmath71 to be close to 1 for systems with an atomic - like charge density , and to vanish for metals , whose valence charge density resembles that of a uniform electron gas @xcite .",
    "intermediate values are then expected for situations different from these two extremes , and we will show that a values around @xmath84 describe well a vast class of mid- to wide - gap insulators .",
    "the final form of the sic potential to subtract from the lsda ( local spin density approximation ) one ( equation ( [ psic - appr - final ] ) ) is that of a linear combination of non - local pseudopotential - like terms .",
    "these are uniquely defined by the choice of exchange and correlation potential used and by asic orbitals @xmath72 .",
    "the practical way of constructing such potentials , i.e. the way of importing the atomic sic to the solid state , depends on the specific numerical implementation used for the dft algorithm . at present",
    "only plane - wave implementations are available @xcite , while here we present our new scheme based on the pseudo atomic orbital ( pao ) @xcite code _ siesta _",
    "@xcite .",
    "we start by solving the atomic all - electron sic - lsda equation for all the species involved in the solid state calculation . here",
    "we apply the original perdew - zunger ( pz - sic ) formalism @xcite and we neglect the small non - orthogonality between the kohn - sham orbitals .",
    "thus we obtain a set of si corrected atomic orbitals @xmath72 , which exactly solve the atomic sic - lsda problem .",
    "the atomic orbitals @xmath72 describing the valence electrons are then used to define the asic potentials @xmath86 @xmath87 ; { \\bf r})+v_\\mathrm{xc}^{\\sigma,\\mathrm{lda}}([\\rho_m^\\uparrow,0 ] ; { \\bf r})\\ ] ] with @xmath88 .    at the same time a standard lsda calculation for the same atoms is used to construct the pseudopotentials describing the core electrons .",
    "these are standard norm - conserving scalar relativistic troullier - martins pseudopotentials @xcite with nonlinear core corrections @xcite .",
    "thus we usually neglect the sic over the core states , when constructing the pseudopotentials .",
    "this is justified by the fact that the eigenvalues for the sic - lsda - pseudoatom , i.e. for the free atom where the effects of core electrons are replaced by lsda pseudopotentials but sic is applied to the valence electrons , are in excellent agreement with those obtained by all - electron sic - lsda calculations @xcite .",
    "the final step is that of recasting the asic potentials @xmath89 , which have a @xmath90 asymptotic behaviour , in a suitable non - local form .",
    "this is obtained with the standard kleinman - bylander @xcite scheme and the final asic potential ( equation ( [ psic - appr - final ] ) ) is written as @xmath91 where the asic projectors are given by @xmath92 and the normalization factors are @xmath93 the orbital functions @xmath94 are atomic - like functions with a finite range , which ensure that the asic projectors @xmath95 do not extend beyond that range .",
    "these are constructed in the same way as the _ siesta _ basis set orbitals , i.e. as solutions of the pseudo - atomic problem with an additional confining potential at the cutoff radius @xmath96 @xcite . the choice of the appropriate cutoff radius for the sic projectors should take into account the two following requirements . on the one hand",
    "it should be sufficiently large to capture most of the sic corrections .",
    "a good criterion @xcite is that the sic - lsda contribution to the orbital energy of the free atom @xmath97 is reproduced within some tolerance .",
    "on the other hand the cutoff should be reasonably short so as not to change the connectivity of the matrix elements of the pao hamiltonian .",
    "in other words we need to ensure that orbitals otherwise considered as disconnected in evaluating the various parts of the hamiltonian matrix are not considered connected for the @xmath98 matrix elements alone .    as a practical rule we set the cutoff radius for a particular orbital of a given atom to be either equal to the longest among the cutoff radii of the pao basis set for that particular atom ( typically the first @xmath99 of the lowest angular momentum ) , or , if shorter , the radius at which @xmath100  0.1mry . typically , when reasonable cutoff radii ( 6 to 9 bohr ) are used , we find that the atomic sic - lsda eigenvalues are reproduced to within 1 to 5 mry for the most extended shells and to within 0.1 mry for more confined shells .",
    "thus @xmath101 are rather well converged already for cutoff radii defined by a pao energies shifts @xcite of around 20mry , although usually smaller pao energy shifts are necessary for highly converged total energy calculations .",
    "finally the matrix elements of the sic potential are calculated as usual over the _ siesta _ basis set .",
    "additional basis functions @xmath102 are constructed from the confined localized atomic orbitals described before using the split - norm scheme @xcite .",
    "the density matrix @xmath6 is represented over such basis @xmath103 and the orbital populations are calculated as @xmath104 where @xmath105 is a matrix element of the overlap matrix . note that in principle the orbital population should be constructed for the atomic sic orbital @xmath72 .",
    "however , we notice that @xmath74 is rather insensitive to the specific choice of orbital , once this has a reasonable radial range . for practical numerical reasons in the present implementation",
    ", we always use the orbital populations projected onto the basis set sub - space consisting of the most extended first-@xmath99 orbitals of the atomic species involved .",
    "the matrix elements of the sic potential are simply @xmath106 and the asic - ks equation takes the final form @xmath107\\psi_n^\\sigma=\\epsilon_{n}^{\\sigma,\\mathrm{sic}}\\psi_n^\\sigma\\;. \\label{ks - asic - final}\\ ] ] with @xmath108 the pseudopotential .",
    "the energy corresponding to the sic - lsda functional is given by @xcite @xmath109=e^\\mathrm{lsda}[\\rho^\\uparrow,\\rho^\\downarrow]- \\sum_{n\\sigma}^\\mathrm{occ.}(u[\\rho_n^\\sigma]+e_\\mathrm{xc}^\\mathrm{lsda}[\\rho_n^\\sigma,0])\\ ; , \\label{totesic}\\ ] ] where @xmath18=\\int\\mathrm{d}^3{\\bf r}\\:\\frac{1}{2}\\rho_n({\\bf r})u([\\rho_n ] ; { \\bf r})\\ ; , \\label{hartree}\\ ] ] @xmath110)=\\int\\mathrm{d}^3{\\bf r}\\:\\rho_n({\\bf r})\\mathcal{e}^\\mathrm{lsda}_\\mathrm{xc } ( [ \\rho_n ] ; { \\bf r})\\ ; , \\label{xc}\\ ] ] with @xmath111 the lsda exchange and correlation energy density . the orbital densities entering in the si term are those associated to the local orbitals @xmath37 .",
    "as we have already mentioned , this functional needs to be minimized with respect to the @xmath37 s , which are an implicit function of the total spin density @xmath6 . in the asic approximation these orbitals are not minimized , but taken as atomic functions .",
    "this means that in the present form the theory is not variational , in the sense that there is no functional related to the ks equation ( [ ks - asic - final ] ) by a variational principle . with this in mind",
    "we adopt the expression of equation ( [ totesic ] ) as a suitable energy , where the orbital densities are those given by the asic orbitals @xmath112 in our implementation the lsda ks energy @xmath113 is directly available as calculated in the _ siesta _ code @xcite and thus , only the second term of equation ( [ totesic ] ) needs to be calculated .",
    "this is easily done by calculating both @xmath0 and @xmath114 on an atomic radial grid for each atomic orbital in the system .",
    "we now compare our asic method with another atomic - like correction to lsda , namely the lda+@xmath0 method @xcite . in lda+@xmath0 one",
    "replaces the lsda exchange and correlation energy associated to the `` correlated '' orbitals ( @xmath13 or @xmath14 shells ) , with the hubbard-@xmath0 energy .",
    "thus the functional becomes @xmath115=e^\\mathrm{lsda}[\\rho({\\bf r})]+e^\\mathrm{u}[\\{p_m^\\sigma\\}]-e^\\mathrm{dc}[\\{p_m^\\sigma\\}]\\ ; , \\label{ldau}\\ ] ] where the hubbard energy @xmath116 and the double counting term @xmath117 depend on the orbital populations @xmath74 of the correlated orbitals . several forms for the lda+@xmath0 functional",
    "have been proposed to date .",
    "a particularly simple and transparent one @xcite , which is also rotationally invariant , redefines the @xmath0 parameter as an effective parameter @xmath118 and the functional takes the form @xmath119 \\label{ldaurot}\\ ] ] where in we separate out the index for the atomic position @xmath120 from the magnetic quantum number @xmath121 , and introduce the off - diagonal populations @xmath122 with @xmath123 . note that the lda+@xmath0 functional is si free for those orbitals that are corrected .",
    "although a rotationally invariant form of the asic potential can be easily derived , we assume here for simplicity that the system under consideration is rotationally invariant , or alternatively that we have carried out a rotation , which diagonalizes the @xmath124 matrix .",
    "in this case the energy becomes simply @xmath125\\ ; , \\label{ldaurotation}\\ ] ] with @xmath126 .",
    "it is then easy to compute the ks potential @xmath127 \\hat{p}^{i\\phi}_m\\ ; , \\label{ldaupot}\\ ] ] and the orbital energy @xmath128 these need to be compared with the asic potential ( equation ( [ psic - appr - final ] ) ) and orbital energy @xmath129 where the last term follows from @xmath130 and from equation ( [ totesic ] ) .",
    "the main difference between the asic and lda+@xmath0 method is in the way in which unoccupied states are handled .",
    "in fact , while lda+@xmath0 corrects unoccupied states and pushes the orbital energies upwards by @xmath131 , asic operates only on occupied states , that are shifted towards lower energies by @xmath132 .",
    "this reflects the fact that the sic is defined only for occupied ks orbitals .",
    "an important consequence is that the opening of bandgaps in the electronic structures , one of the main features of both the lda+@xmath0 and asic schemes , is then driven by two different mechanisms . on the one hand in lda+@xmath0 , gaps open up since occupied and unoccupied states are corrected in opposite directions leading to a gap of @xmath133 . on the other hand asic is active only over occupied states and gaps open only if occupied and unoccupied bands have large differences in their projected atomic orbital content .",
    "thus one should not expect any corrections for covalent materials where conduction and valence bands are simply bonding and antibonding states formed by the same atomic orbitals .",
    "this is for instance the case of si and ge .",
    "in contrast asic will be extremely effective for more ionic situations , where the orbital contents of conduction and valence bands are different .",
    "finally , by comparing the corrections to the orbital energy of a fully occupied state , one finds @xmath134 which establishes an empirical relation between the hubbard energy and the asic correction . since @xmath0 is sensitive to the chemical environment due to screening @xcite ,",
    "while all the other quantities are uniquely defined by an atomic calculation , we can re - interpret the parameter @xmath71 as empirically describing the screening from the chemical environment within the asic scheme .",
    "the test calculations that we present in this work are for two classes of materials : extended and finite .",
    "first we investigate how our implementation performs in the solid state .",
    "in particular we discuss the rle of the parameter @xmath71 in determining the bandstructure of several semiconductors , considering both the ks band - gap and the position of bands associated with tightly bound electrons .",
    "the quasi - particle band gap @xmath135 in a semiconductor is defined as the difference between its ionization potential @xmath120 and electron affinity @xmath136 .",
    "these can be rigorously calculated from dft as the homo energy respectively of the neutral and negatively charged systems .",
    "this actual gap can not be directly compared with the ks band - gap @xmath137 , defined as the difference between the orbital energy of the homo and lumo states of the neutral system .",
    "in fact , the presence of a derivative discontinuity in the dft energy as a function of the electron occupation establishes the following rigorous relation @xcite @xmath138 with @xmath139}{\\delta n}\\left|_{n+\\omega}-\\frac{\\delta e_\\mathrm{xc}[n ] } { \\delta n}\\right|_{n-\\omega}\\right\\}_{n_n}\\ : .",
    "\\label{derdisc}\\ ] ] this is valid even for the exact xc potential , and therefore in principle one has to give up ks bandstructures as a tool for evaluating semiconductor band - gaps .",
    "the size of @xmath140 is however not known for real extended systems and the question of whether most of the error in determining @xmath135 from @xmath137 is due to the approximation in the xc potential or due to the intrinsic @xmath140 is a matter of debate .    in general si - free potentials",
    "bind more than lsda and one expects larger gaps .",
    "surprisingly , functionals based on exact exchange , provide ks gaps rather close to the experimental values @xcite .",
    "the reason for such a good agreement is not fully understood , but it is believed that the exact ks gaps should be smaller than the actual ones .    with this in mind , we adopt a heuristic approach and we use the ks band - gap as a quality indicator for interpreting the parameter @xmath71 and for providing its numerical value for different classes of solids .",
    "here we investigate the dependence of @xmath141 over @xmath71 and we determine the value for @xmath71 yielding the experimental band - gap .",
    "assuming that @xmath140 does not vary considerably across the materials investigated , this will allow us to relate @xmath71 to the degree of localization in a semiconductor and to extract the value useful for asic to be an accurate single - particle theory .    in figure [ fig1 ] we present the band - gap of four representative semiconductors as a function of @xmath71 together with the value needed to reproduce the experimental band - gap .",
    "lsda corresponds to @xmath142 and while @xmath76 accounts for the full asic .",
    "calculated band - gap for nacl , mgo , aln and zno as a function of the parameter @xmath71 .",
    "@xmath142 is the lsda value and @xmath76 accounts for complete atomic sic .",
    "the lattice parameters used for the calculations are either the equilibrium lsda or the experimental when available.,scaledwidth=43.0% ]    in general @xmath137 increases as @xmath71 increases , as a result of the stronger sic .",
    "the @xmath143 curve is almost linear with a slope , which appears to be material - specific .    for the most ionic compound , nacl",
    ", the experimental gap is reproduced almost exactly by @xmath76 , i.e. by the full asic .",
    "this is somehow expected since the charge density of solid nacl is rather close to a superposition of the na@xmath144 and cl@xmath21 ionic charge densities . in this case of strongly localized charge densities",
    "the asic approximation is rather accurate yielding results substantially identical to those obtained with full self - consistent pz - sic @xcite .",
    "indeed earlier calculations for licl @xcite demonstrate that the sic band - structure is rather insensitive of the localized orbitals @xmath37 once these have an atomic - like form .    for",
    "the other compounds the localized orbitals @xmath37 s are not necessarily atomic - like functions and deviations from @xmath76 are expected .",
    "interestingly we find that , for all the materials investigated , a value of around 1/2 reproduces the experimental band - gap rather accurately . as an illustration , in table [ tabgap ]",
    "we compare the experimental band - gap @xmath145 to the calculated @xmath137 for asic ( @xmath76 ) and lda , for several semiconductors ranging from ionic salts to wide - gap ii - vi and iii - v semiconductors .",
    "we also report the value of @xmath146 needed for @xmath147 .",
    ".[tabgap]experimental @xmath145 and ks @xmath137 band - gap ( in ev ) for a number of semiconductors .",
    "@xmath137 are calculated with both lsda and asic ( @xmath76 ) . in the last column",
    "we report the value of @xmath146 needed for @xmath147 .",
    "the lattice parameters used for the calculations are either the equilibrium lsda or the experimental when available ( in  )",
    ". rs = rocksalt , wz = wurtzite , zb = zincblende .",
    "the value for the experimental gaps are from the literature : @xmath148 @xcite , @xmath149 @xcite , @xmath150 @xcite , @xmath13 @xcite , @xmath151 @xcite , @xmath14 @xcite , @xmath152 @xcite , @xmath153 @xcite , @xmath154 @xcite [ cols=\"<,^,^,^,^,^\",options=\"header \" , ]     again the asic@xmath155 results compare rather well with experiment , and we can conclude that the asic method offers a rather efficient and inexpensive theory for single particle vertical excitations .",
    "we are now in a position to discuss the homo - lumo gap in asic .",
    "as already mentioned , even for the exact xc functional , the ks gap @xmath156 does not account for the actual quasi - particle gap @xmath157 .",
    "this in turn is the sum of @xmath137 and the discontinuity of the exchange and correlation potential @xmath140 .",
    "equivalently @xmath158 i.e. @xmath140 is the discontinuity in the eigenvalue of the lumo state at @xmath3 .",
    "therefore , in order to extract the actual gap from the ks gap , provided that the spectrum is reasonably well described at integer electron numbers @xmath3 , what remains is to model the derivative discontinuity at @xmath3 and ensure that @xmath159 is relaxation free for ( @xmath160 ) .",
    "local and semi - local ( lsda / gga ) xc functionals lack such a discontinuity , while self - interaction corrections are able to restore it , at least in part .",
    "for instance the pz - sic scheme is successful in this regard .",
    "ionization curve for the ethylene ( c@xmath161h@xmath56 ) molecule as the occupation of the homo state is varied from 0 to 1 in going from the ionized c@xmath161h@xmath162 to the netural c@xmath161h@xmath56 state.,scaledwidth=45.0% ]    in figure [ ethylene ] we illustrate the ionization curve for the ethylene ( c@xmath161h@xmath56 ) molecule as the occupation of the homo state is varied from 0 to 1 in going from the ionized c@xmath161h@xmath162 to the netural c@xmath161h@xmath56 configuration .",
    "it is seen that among the three schemes presented , only the pz - sic scheme approximately models the behaviour required by the equation ( [ discharge ] ) .",
    "the asic homo eigenvalue roughly agrees with the pz - sic eigenvalue at integer occupation but behaves linearly through non - integer values .",
    "thus we find that the derivative discontinuity for the molecule is smoothed out in asic , which still connects continuously different integer occupations .",
    "this is one of the limitations of the atomic representation employed in asic .    in view of the foregoing discussion ,",
    "the actual size of the homo - lumo gap in asic becomes significant with a direct bearing on the physics described .",
    "ideally , we want @xmath163 ( lumo for the @xmath3-electron system ) to be as close to @xmath164 so that the range of eigenvalue relaxation through fractional occupation numbers @xmath165 is minimized .",
    "looking at columns 6,7 and 8 in table [ eatab ] however , we see that for almost all the molecules , this is hardly the case .",
    "the agreement between @xmath163 and -ea from experiment ( @xmath166 ) for asic@xmath155 is quite poor implying a considerable energy range spanning fractional particle number .",
    "we still expect this energy range to be smaller for asic@xmath155 than lsda .",
    "it is also apparent from the table [ eatab ] that @xmath167 usually differs from @xmath168 and in fact by considerable magnitudes in some cases .",
    "thus the asic@xmath155  correction \" to the empty lumo state does not vanish in contrast to the pz - sic scheme where , by definition , the empty eigenstates are sic free .",
    "since the sic operator @xmath169 is constructed in an atomic orbital representation , the correction to any ks eigenstate @xmath170 either filled or empty @xmath171 is not necessarily zero unless @xmath170 only projects onto empty atomic orbitals .",
    "also this correction to the lumo with respect to the lsda is negative in most cases , exceptions being nh@xmath161 and ch@xmath55 where it is desirably positive .",
    "thus the fundamental homo - lumo gap in asic is a combination of both the homo and lumo corrections .",
    "table [ holutab ] shows how this combination works out in asic@xmath172 and asic@xmath155 when compared to lsda .",
    "the molecular test set is the same as that in table [ iptab ] .",
    "lccc molecule & +   + & lsda&asic@xmath172&asic@xmath155 + ch@xmath55 & 1.92 & 4.75 & 7.59 + nh@xmath173 & 7.1@xmath174 & 9.29@xmath174 & 11.61@xmath174 + sih@xmath175 & 8.44@xmath174 & 9.68 & 10.94 + c@xmath176h@xmath175 & 5.81 & 6.59 & 7.38 + sich@xmath175 & 6.19 & 7.07 & 8.06 + ch@xmath173chcl@xmath176 & 5.79 & 6.84 & 7.88 + c@xmath175h@xmath175s & 4.46 & 5.13 & 5.8 + c@xmath176h@xmath177s@xmath176 & 4.44 & 6.02 & 7.6 + pyridine & 3.85 & 4.56 & 5.26 + benzene & 5.22 & 5.9 & 6.59 + iso - butene & 4.88 & 5.56 & 6.26 + nitrobenzene & 3.25 & 4.03 & 4.42 + naphthalene & 3.36 & 3.83 & 4.29 + c@xmath178 & 1.62 & 1.87 & 2.12 + c@xmath179 & 1.75 & 1.99 & 2.23 +    we see in almost all cases the asic gap is systematically larger than the lsda one .",
    "this is expected because the correction to the homo is usually much stronger than that to the lumo . in general",
    ", asic is expected to work well for systems where the occupied and un - occupied ks eigenstates of the extended system have markedly different atomic orbital signatures being derived predominantly from filled and empty atomic orbitals respectively .",
    "in such a case , the asic correction to the empty states would be nullified in being scaled by near - zero atomic orbital populations . in some cases ,",
    "provided phase factors combine suitably , the correction to the empty states can even be positive with respect to the same in lsda . +      before we conclude , we discuss some general properties of the asic method which are relevant to any orbital dependent sic implementation and also some possible pitfalls . as with other sic schemes ,",
    "asic is not invariant under unitary transformations of the orbitals used in constructing the sic potential .",
    "thus the asic correction is likely to change as the atomic orbitals used for projecting onto the ks eigenstates of the system are rotated or transformed otherwise . unlike the perdew - zunger method however , there can be no variational principle over all possible unitary transformations of the atomic orbitals because in the general case they do not represent the hamiltonian of the system under consideration .",
    "this also implies that if the scheme is used with a system that is already well described by lsda , the  correction \" additional to the lsda result does not necessarily vanish .",
    "simple metals and narrow gap systems are likely candidates for this scenario .    furthermore , its pertinent to mention",
    "that asic becomes ineffective if not counterproductive for materials with homonuclear bonding , in which valence and conduction bands have the same atomic orbital character .",
    "in this situation the asic potential will shift the bands in an almost identical way , without producing any quantitative changes , such as the opening up of the ks gap .",
    "note that this is a pitfall of the asic approximation , which distinguishes occupied from empty states only through their projected atomic orbital occupation , but not of the sic in general .",
    "typical cases are those of si and ge .",
    "the ks gap in si goes from 0.48  ev in lsda to only 0.57  ev for asic@xmath172 , while ge is a metal in both cases .",
    "in addition the lsda calculated valence bandwidths of 12.2  ev for si and 12.8  ev for ge , in good agreement with experiments , are erroneously broadened to 14.3  ev and 14.8  ev respectively .",
    "in conclusion , we have implemented the asic scheme proposed by filipetti and spaldin within the pseudopotential and localized orbital framework of the _ siesta _ code .",
    "we have then investigated a broad range of semiconductors and molecules , with the aim of providing a reasonable estimate for the scaling parameter @xmath71 .",
    "we found that @xmath76 , which accounts for the full atomic si , describes surprisingly well ionic semiconductors and molecules .",
    "in particular for molecules , both the ip and the ea can be obtained with good accuracy from the homo ks eigenvalues respectively for the neutral and singly charged molecule .",
    "this makes the asic scheme particularly suited for application such as quantum transport , where the position of the homo level determines most of the @xmath120-@xmath180 curve .    in contrast",
    "iii - v and ii - vi semiconductors are better described by @xmath181 , which corrects the atomic si for screening .",
    "this makes asic@xmath172 an interesting effective band theory for semiconductors .",
    "the relation of the present scheme with the fully self - consistent sic methods has been emphasized , and so has been that with lda+@xmath0 .",
    "we acknowledge stimulating discussions with malgorzata wierzbowska , kieron burke and alessio filippetti .",
    "this work is supported by the science foundation of ireland under the grants sfi02/in1/i175 .",
    "dsp acknowledges financial support from the university of the basque country ( grant no .",
    "9/upv 00206.215 - 13639/2001 ) , the spanish ministerio de educacion y ciencia ( grant no . fis2004 - 06490-c03 - 00 ) and the basque goverment and diputacion foral de giupuzkoa ( grant nanomateriales and nanotron , etortek program ) .",
    "traveling has been sponsored by enterprise ireland under the international collaboration programme ei - ic/2003/47 .",
    "computational resources have been provided by the hea iitac project managed by the trinity center for high performance computing and by ichec .",
    "temmerman , z.  szotek and h.  winter , phys .",
    "b * 47 * , 1184 ( 1993 ) ; z.  szotek , w.m .",
    "temmerman and h.  winter , phys .",
    "lett . * 72 * , 1244 ( 1994 ) ; a.  svane , phys . rev .",
    "lett . * 72 * , 1248 ( 1994 ) ; a.  svane , phys .",
    "b * 53 * , 4275 ( 1996 ) ; a.  svane , v.  kanchana , g.  vaitheeswaran , g.  santi , w.m .",
    "temmerman , z.  szotek , p.  strange and l.  petit , phys .",
    "b * 71 * , 045119 ( 2005 ) .",
    "v.  bougrov , m.e .",
    "levinshtein.,s.l .",
    "rumyantsev , a.  zubrilov , in _ properties of advanced semiconductor materials gan , aln , inn , bn , sic , sige _ , eds .",
    "levinshtein m.e . ,",
    "rumyantsev s.l .",
    ", shur m.s .",
    ", john wiley & sons , inc .",
    ", new york , 2001 , 1 - 30 ."
  ],
  "abstract_text": [
    "<S> we present an atomic orbital based approximate scheme for self - interaction correction ( sic ) to the local density approximation of density functional theory . </S>",
    "<S> the method , based on the idea of filippetti and spaldin [ @xcite phys . </S>",
    "<S> rev . </S>",
    "<S> b * 67 * , 125109 ( 2003 ) ] , is implemented in a code using localized numerical atomic orbital basis sets and is now suitable for both molecules and extended solids . after deriving the fundamental equations as a non - variational approximation of the self - consistent sic theory , we present results for a wide range of molecules and insulators . in particular , we investigate the effect of re - scaling the self - interaction correction and we establish a link with the existing atomic - like corrective scheme lda+@xmath0 . </S>",
    "<S> we find that when no re - scaling is applied , i.e. when we consider the entire atomic correction , the kohn - sham homo eigenvalue is a rather good approximation to the experimental ionization potential for molecules . </S>",
    "<S> similarly the homo eigenvalues of negatively charged molecules reproduce closely the molecular affinities . </S>",
    "<S> in contrast a re - scaling of about 50% is necessary to reproduce insulator bandgaps in solids , which otherwise are largely overestimated . </S>",
    "<S> the method therefore represents a kohn - sham based single - particle theory and offers good prospects for applications where the actual position of the kohn - sham eigenvalues is important , such as quantum transport . </S>"
  ]
}