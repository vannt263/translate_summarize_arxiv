{
  "article_text": [
    "many relevant properties of condensed matter require understanding how the physics at the nanoscale ( nm and ns ) builds up or intertwines with structures and processes on the microscale ( @xmath0 m and @xmath0s ) and beyond .",
    "the so called _ multiscale modeling _",
    "techniques have been rapidly evolving during the last decade to bridge this gap .",
    "the `` multiple - scale '' problem is common to many different disciplines , and a variety of multiscale models are being designed to tackle different scenarios either in solids@xcite or soft matter@xcite .",
    "the main objective of multiscale modeling of complex fluids is to study the effect of large and slow flow scales on the structure and dynamics of complex molecules ( e.g. polymers , proteins ) , or complex interactions ( e.g. liquid - solid interfaces , wetting fronts , structure formation , etc . ) . in this contexts ,",
    "multiscale modeling is usually based on _ domain decomposition _ : a small part of the system [ @xmath1nm@xmath2 is solved using fully fledged ( classical mechanics ) atomistic detail and it is coupled to a ( much larger ) outer domain , described by a coarse - grained ( either particle or continuum ) model . the central idea of these `` dual - scale '' methods is to solve large and slow processes using a computationally low demanding description , while retaining an atomistic detail only where necessary .",
    "another important application of domain decomposition is the study of open systems .",
    "indeed , in general , a dynamic coupling based on domain decomposition requires to be able to `` open up '' a molecular dynamics ( md ) region , in the sense that mass , momentum and energy should be exchanged with the exterior in a physically sound way .",
    "a formulation for flux exchange across open boundaries in particle systems is already available @xcite , and was shown to allow for md simulations in different type of thermodynamic ensembles . the triple - scale scheme presented in this work",
    "is equipped with this idea , which permits to study the dynamics of confined ( yet open ) molecular systems , which evolve towards the grand canonical equilibrium ensemble ( see e.g. @xcite ) . in passing we",
    "note that the existing monte carlo @xcite ( mc ) or hybrid mc - md algorithms @xcite for the grand canonical ensemble can only provide restricted dynamical information of the system .    the first class of schemes based on domain decomposition to appear were based on particle - continuum coupling ( see @xcite for a review ) .",
    "in particular , unsteady flow can be solved by hybrids based on exchanging the momentum flux across the interface ( h ) between a molecular dynamics ( md ) domain and a continuum fluid dynamics ( cfd ) solver .",
    "one of these schemes ( hybridmd ) implements the open - boundary formulation @xcite , which allows to open up the md domain and include mass and energy exchanges across the md - cfd interface ( h ) .",
    "this requires consideration of the proper hydrodynamic fluctuations at the cfd domain @xcite .",
    "however , the particle insertion used by original `` open md '' scheme was restricted to small solvent molecules , such as argon or water @xcite , due to the large steric hindrance of any atomistic complex molecule description .",
    "more recently , another type of domain decomposition , based on particle - particle coupling , was developed .",
    "the adaptive resolution scheme ( adress ) @xcite couples a coarse - grained particle model with its corresponding atomistic description . to do so ,",
    "the number of degrees of freedom of the molecules is adapted ( reduced / increased ) as molecules move across a `` transition '' layer where the all - atom explicit model ( @xmath3 ) and the coarse - grained @xmath4 model are gradually switched on / off , through a hybrid model ( @xmath5 ) .",
    "the great benefit of adress resides in making feasible the gradual ( on - the - fly ) transition of a complex molecule description : from a coarse - grained potential with soft intermolecular interactions to an atomistic one , with the whole set of hard - cores .",
    "we realized that taking the advantages of hybridmd and adress should then have a symbiotic effect , potentially solving most of the limitations of each method .",
    "in a recent article @xcite we started to explore in such direction and applied the combined adress - hybridmd model to a liquid of simple tetrahedral molecules . by performing molecule insertion within the @xmath6 domain",
    ", the combined scheme enables to simulate an open md system and couple its dynamics to a continuum flow description of the outer region .",
    "however , the coupling strategy used in ref .",
    "@xcite does not avoid some drawbacks already present in the original setup of the adress scheme@xcite ( methodological improvements to overcome this limitations are underway ) .",
    "in particular , precise mapping of structural and dynamical properties of the @xmath6 and @xmath5 molecules @xcite were still required .",
    "hence , any simulation exploring a new thermodynamic state require new calibrations of the coarse - grained models ( in practice , each simulation is restricted to sample one single thermodynamic state ) . in the present work",
    "we show that the coupling geometry can be modified to yield a more flexible and robust adress - hybridmd scheme .",
    "this new implementation avoids the burden associated to the fine tuning of coarse - grained layers , thus relieving a great deal of the specificity of the coarse - grained model .",
    "this is important not only from the computational standpoint , but also because it opens a route to consider processes following a thermodynamic path .",
    "a general completion of this route requires the inclusion of the energy exchange into the combined scheme , and some possible solutions are hereby suggested .",
    "section [ s2 ] briefly introduces the ( dual - scale ) hybrid models ( hybridmd and adress ) .",
    "coupling strategies are explained in sec .",
    "( [ s3 ] ) and simulations and results are presented in secs .",
    "( [ s4 ] ) and ( [ s5 ] ) .",
    "some conclusions are given in ( [ s6 ] ) .",
    "the hybridmd @xcite scheme couples the hydrodynamic of a particle region , here called `` molecular dynamics '' ( md ) domain , with a continuum fluid dynamic description ( cfd ) of the external fluid .",
    "the essential quantity exchanged between cfd and md is the momentum flux across the md - cfd interface h ( see fig .",
    "1 ) ; which can be casted as @xmath7 , where @xmath8 is the local pressure tensor and @xmath9 is the unit vector normal to the h - interface , whose area is @xmath10 .",
    "the momentum flux is transferred to the md domain by imposing an external force @xmath11 to a particle buffer ( the overlapping domain b in fig .",
    "1 ) adjacent to the md domain .",
    "molecules are free to cross the h - interface , from or towards the buffer , but once in b , each molecule @xmath12 feels an external `` hydrodynamic '' force distributed according to @xmath13 , where @xmath14 is the coordinate normal to h. several options can be chosen for the distribution function @xcite , we used a step function @xmath15 , as in ref .",
    "@xcite .    through the interface h",
    ", the cfd domain receives exactly the same amount of momentum as the md system does , but in opposite direction , thus ensuring conservation .",
    "also , the particle s mass crossing h is injected into the cfd domain , via a relaxation procedure @xcite .",
    "this means that conservation of total mass and momentum only apply to the system md@xmath16cfd . in other words , strictly speaking b is not part of the total system @xcite and can be thought of as a particle reservoir where we apply flux boundary conditions to the md system .",
    "finally , we note that the only `` microscopic '' information required at the cfd level is the equation of state and viscosities of the atomistic fluid ( here , we assume that the constitutive relation is known ) .      as stated , the adress scheme couples an atomistic domain and a coarse - grained particle region by adapting , on - the - fly , the molecular description of those molecules moving across both domains .",
    "this is clearly illustrated in fig .",
    "1b , c , where the atomistic domain is labeled as @xmath3 , the coarse - grained region as @xmath6 and @xmath5 denotes the transition region between both domains . in this transition regime , the force acting on a molecule is an hybrid of the explicit and coarse - grained forces , @xmath17{\\bf f}^{cm}_{\\alpha\\beta},\\label{eq : adress}\\ ] ] where @xmath18 is the intermolecular force acting between centers of mass of molecules @xmath19 and @xmath20 , placed at @xmath21 and @xmath22 in the coupling coordinate , @xmath23 is the sum of all pair intermolecular atom interactions between explicit atoms of the molecules @xmath19 and @xmath20 , @xmath24 is the corresponding coarse - grained force acting on the center of mass of the molecule ( cm ) , and @xmath25 is the weighting function determining the degree of resolution of the molecules .",
    "the value @xmath26 corresponds to the @xmath3 region , @xmath27 to the @xmath6 region , while values @xmath28 corresponds to hybrid ( @xmath5 ) models . in this study",
    "we used the same functional form of @xmath25 as in ref.@xcite .    each time a molecule leaves ( or enters ) the coarse - grained region it gradually gains ( or loses ) its equilibrated vibrational and rotational dofs while retaining its linear momentum . note that the change in resolution carried out by adress is not time - reversible as a given @xmath6 molecule corresponds to many orientations and configurations of the corresponding @xmath3 molecule .",
    "since time reversibility is essential for energy conservation@xcite , adress does not conserve energy .",
    "in particular , the force in eq . [",
    "eq : adress ] is in general not conservative in the @xmath5 region ( i.e. , in general @xmath29)@xcite .",
    "hence , to supply or remove the latent heat associated with the switch of resolution we employ a standard dpd thermostat@xcite acting at the @xmath6 and @xmath5 regions . note that the thermostat forces do not enter into the adress interpolating scheme , eq .",
    "( [ eq : adress ] ) .",
    "instead they are added to the adress@xcite .",
    "the adress - hybridmd scheme can be applied in several contexts . in general terms",
    ", the scheme solves the hydrodynamic coupling of a md system with external ( cfd ) flow .",
    "this goal requires hydrodynamic consistency ( e.g. momentum conservation ) .",
    "also , a reduced , but yet important , application of the combined scheme consists on the study of the equilibrium molecular dynamics of open systems with relatively large molecules . for this sake thermodynamic consistency",
    "is required : in particular sampling the grand - canonical ensemble requires proper mass fluctuations across the simulation boundaries .",
    "confined systems are a relevant example of this sort of application ( see e.g. ref .",
    "@xcite ) , for which the role of cfd domain can be simplified to just provide the external pressure ( and temperature ) of the external mass reservoir .    in the same way ,",
    "the geometry used for the adress - hybridmd coupling allows for a certain flexibility ; the key issue being the location of the interface h connecting the md and cfd domains ( see fig .",
    "1 ) . in a previous work",
    "@xcite we proposed to place the h interface within the coarse - grained domain ( see fig .",
    "this setup is useful to include hydrodynamics in simulations requiring a particle - based multiscale description ( e.g. using adress ) .",
    "an example of application could be the study of the dynamics of ions nearby a charged surface under flow conditions ; here the @xmath3 layer would describe the physics near and at the surface , while away from it , charged @xmath6 particles will eventually transfer the external flow from the outer cfd region .",
    "on the other hand , many studies are focused on the atomistic region and do not really require a particle - based multiscale description around it . in these cases , a more logical setup is to place the interface h within the atomistic domain @xmath3 ( see fig .",
    "1b , c ) . in this paper",
    "we explore the benefits of this second coupling strategy which , as stated , might open a route to consistently couple the hydrodynamics and thermodynamics of qualitatively different levels of description ,      a detailed description of this setup which locates the hybrid interface h into the @xmath6 domain ( see fig .",
    "1a ) , can be found in ref .",
    "@xcite ; we now briefly summarize its requirements . in this setup",
    "the original adress scheme is implemented _ inside _ the the md domain .",
    "thus , the first requirements of this coupling geometry are demanded by adress @xcite . in particular , to guarantee a similar fluid structure along the adress layers , one needs to calibrate the radial distribution function and equation of state of the coarse - grained model @xmath6 and @xmath5 so as to fit the atomistic fluid values .",
    "extra pressure corrections require also the same type of calibrations for the intermediate hybrid model @xmath30 . on the other hand @xcite ,",
    "hydrodynamic consistency demands to take care of the viscosities of the @xmath6 and @xmath5 models , and fit them to the @xmath3 fluid value @xcite ( as shown in ref .",
    "@xcite this does not guarantees a perfect fit of the diffusion coefficients ) . in summary",
    ", for each thermodynamic state considered , one needs to perform the following calibration steps :    1 .",
    "calibrate the effective potential @xmath31 of the @xmath6 model @xcite so as to fit the center - of - mass radial distribution function ( rdf@xmath32 ) and pressure of the @xmath3 model @xcite ( solid line in the inset of fig .",
    "[ rdf ] ) .",
    "the interface pressure correction @xcite is used to suppress density oscillations in the @xmath5 layer .",
    "this requires the calibration of the effective potential @xmath33 for the hybrid model with @xmath30 ( dashed line in the inset of fig .",
    "[ rdf ] ) .",
    "measure the viscosity of the @xmath6 model .",
    "then calibrate the transverse friction coefficient of the transverse dpd thermostat @xcite so as to match @xmath34 and @xmath35 .",
    "this requires several viscosity calculations @xcite .",
    "the setup discussed in this work consists on placing the hybrid interface h inside the atomistic domain ( see fig .",
    "1b , c ) . in this setup adress works _ inside the buffer_. the md region is thus purely atomistic and this fact brings about an important benefit : around the hybrid interface h , all relevant fluid properties are properly defined .",
    "these include the fluid transport coefficients , energy and pressure equation of states and the corresponding mass and pressure fluctuations . in this context , md - cfd coupling by hybridmd",
    "is well defined @xcite . on the other side , by placing adress into the particle buffer it behaves as an _ adaptive resolution buffer _",
    ", where the atomistic dof s are gradually inserted into the md ( atomistic ) region of interest . note that the @xmath6 layer , with soft interaction potentials , is placed near the buffer end ( see fig .",
    "1b , c ) , so the insertion of complex molecules into the system is still an easy task , using standard insertion routines @xcite .",
    "the second relevant benefit of this coupling strategy is that it permits to properly impose the external pressure and stress into md , without having to perform a fine tuning of the structural and dynamic properties of the @xmath6 and @xmath5 models . in other words ,",
    "the adress - hybridmd scheme does not rely on the specificity of the coarse - grained description anymore .",
    "the reason for this is simple : the adress scheme conserves linear momentum .",
    "this means that any external momentum flux will be properly transferred across the adress layers to the atomistic core . as the external `` hydrodynamic '' force used in the hybridmd scheme decouples from any intermolecular interaction ( the total force on a molecule at the buffer b is , @xmath36 ) ,",
    "the transfer of mechanical variables ( pressure and stress ) should be robust against the details of the @xmath6 and @xmath5 models .",
    "we now present simulations to prove this claim .",
    "we will also consider any effect on the liquid structure near the interface h and check for proper mass fluctuations across h.",
    "the present hybrid simulations were implemented for the flexible tip3p water model , partly because of the relevance of water and also because it has well known structural and dynamical properties@xcite . in the remainder of the paper we use reduced lennard - jones units corresponding to the oxygen atom : mass @xmath37 a.u . ,",
    "oxygen - oxygen interaction energy @xmath38 , and diameter @xmath39 . simulations were done at ambient temperature , @xmath40k , which corresponds to @xmath41 in reduced units .",
    "tip3p - water density is @xmath42 gr/@xmath43 , which corresponds to @xmath44 .",
    "most particle simulations were done in boxes of total ( md@xmath16b ) volume @xmath45 , although in order check for finite size effects , boxes with larger dimensions were also used .",
    "the volume of the md domain was @xmath46 . and",
    "it contained about 865 water molecules .",
    "long - range electrostatic forces are computed using the reaction field method , in which all molecules outside a spherical cavity of a molecular based cutoff radius @xmath47 are treated as a dielectric continuum with a dielectric constant @xmath48  @xcite .",
    "the finite volume solver for the cfd domain was feeded with the equation of state for flexible tip3p water reported in ref .",
    "finally , the microscopic part of the stress tensor at the hybrid interface h was measured according to the mesoscopic approach explained in ref .",
    "@xcite ; i.e. by evaluating velocity gradients from the cell - averaged particle velocities and using the newtonian constitutive relation .",
    "_ coarse - grained buffers_. as expected , results proved the correct behavior of the combined scheme , both in terms of the structure and hydrodynamics at the md domain .",
    "however calibration steps , using the recipe explained in sec .",
    "[ cgb ] , involved significant work .",
    "strong corrections of the @xmath6 and @xmath5 viscosities @xcite were required ( without transverse dpd thermostat , @xmath34 is about five times smaller than @xmath35 ) . in these calibration steps we used hybridmd as a rheometer @xcite .",
    "_ adaptive resolution buffers_. in what follows we focus on the result obtained for the second , much lighter setup .",
    "it is important to stress that these simulations were done using an effective potential for the @xmath6 model which was deliberately not accurately fitted to reproduce the all - atom rdf@xmath32 ( see fig .",
    "[ rdf ] ) .",
    "moreover , steps @xmath49 and @xmath50 of the protocol of sec .",
    "[ cgb ] were also avoided , meaning that the shear viscosities at the @xmath6 and @xmath5 layers result in much smaller values than the atomistic ( @xmath3 ) one .",
    "we first compare , in fig .",
    "[ rdf ] , the local structure of the liquid inside the md region of the triple - scale model with that obtained from all - atom simulations within periodic boundaries .",
    "the agreement is perfect , indicating that the unfitted liquid structure in the buffer ( dashed line in fig .",
    "[ rdf ] ) does not affect the proper liquid structure inside the interest ( md ) region .",
    "the hydrodynamic behavior of the triple - scale scheme was tested considering both steady and unsteady flows .",
    "figure [ shear ] shows the density and velocity profiles in the particle region ( md@xmath16b ) obtained at the steady state of a simple couette flow .",
    "the density ( and temperature , not shown ) profile inside the md region is flat and confirm that the triple - scale scheme furnishes an homogeneous equilibrated liquid bulk .",
    "the expected linear velocity profile inside the md domain indicates that the transverse momentum is correctly transferred across the triple - scale fluid model .",
    "we also conducted simulations of stokes flow ( an oscillatory shear flow driven by the oscillatory motion of a wall along its plane direction ) .",
    "figure [ osc_shear ] shows the velocity in one of the md - cells of the system corresponding to a flow with a period 300@xmath51 .",
    "the hybrid result perfectly agrees with with the deterministic solution of the navier - stokes equation ( red solid line in fig .",
    "[ osc_shear ] ) .",
    "the large viscosity of liquid water induces a fast transfer of momenta across the buffers .",
    "hence , even for faster shear rates , no trace of phase delay between the md and cfd velocities is observed @xcite , ( see the inset of fig .",
    "[ osc_shear ] ) .",
    "one of the interesting properties of the adress - hybridmd approach is that the md region becomes an open system , which exchanges mass with its surroundings . as stated before , to that end it is quite important to check that mass fluctuation across the md border ( h ) is consistent with the grand canonical prescription .",
    "we measured the mass variance inside the md domain and compared it with the grand canonical ( gc ) result , @xmath52 = \\rho k_b t/ ( v c_t^2)$ ] , where @xmath53 is the system s volume and @xmath54 is the squared isothermal sound velocity ( related to the isothermal compressibility , @xmath55 ) . taking the sound velocity for the flexible tip3p water reported in ref .",
    "@xcite , @xmath56 and the mass density @xmath57 ( recall that @xmath58 ) , the gc prediction for @xmath59 is @xmath52=0.0187 $ ] . inside the md domain we obtained @xmath52=0.020\\pm 0.002 $ ] within different slices of the same volume",
    "this is a quite good agreement , considering the smallness of @xmath53 . in a larger volume @xmath60 ,",
    "the triple - scale result @xmath52=0.011\\pm 0.005 $ ] is even closer to the gc prediction @xmath52=0.0108 $ ] .",
    "although in this work we do not solve the energy exchange across h , we are in position to provide some arguments indicating that this task is solvable using the _ adaptive resolution buffer _ setup .",
    "energy exchange requires three properties : @xmath61 ) energy should be properly defined across md , @xmath49 ) the scheme should allow to change the thermodynamic state of the system and @xmath50 ) one should be able to control the amount of energy per unit time inserted into md . concerning @xmath61 ) ,",
    "it is important to stress that by placing the adress scheme inside the buffer one ensures that the energy is a well defined quantity over the total ( md@xmath16cfd ) system .",
    "also @xmath49 ) is satisfied because the _ adaptive resolution buffer _ setup does not rely on the specificity coarse - grained model : this means that it should be possible to change the thermodynamic state of the md domain ( e.g. the mean temperature ) without re - calibrating the @xmath6 layer ( we have tested this in simulations using tetrahedral molecules ) . finally , we believe that @xmath50 ) is solvable , but it will require a further development of the algorithm .",
    "one possible way could be to implement the flux - boundary conditions developed in ref . @xcite . we expect to present an algorithm of this sort in future works .",
    "to conclude , we have presented a flexible and robust hybrid scheme for hydrodynamics of molecular liquid , which combines atomistic , mesoscopic and continuum models .",
    "this triple - scale scheme uses a flux based particle - continuum hybrid to couple the atomistic core and continuum sides of the system , while it generalizes the role of the particle buffer to allow for a gradual change in molecular resolution : from an all - atom at the core to a mesoscopic one near the buffer end .",
    "structure and hydrodynamic of the core ( md ) region were shown to be robust against changes in the choice of the mesoscopic model , greatly reducing calibration burdens .",
    "further extensions to allow for energy exchange and multiple species will be explored in future works .    *",
    "acknowledgments * : we thank anne dejoan , christoph junghans , burkhard d \" unweg , and luigi delle site for useful discussions .",
    "this work is supported in part by the volkswagen foundation .",
    "r.d - b acknowledges additional funding from ramn y cajal contract and project fis2007 - 65869-c03 - 01 funded by the spanish government ( mec ) , and also funding from the `` comunidad de madrid '' through the mossnoho project , s-0505/esp/0299 .",
    "m.  p. acknowledges additional financial support through the project j1 - 2281 from the slovenian research agency .",
    "cfd ) ; where md stands for the molecular dynamics region , surrounded by continuum fluid dynamics ( cfd ) domains solved via the finite volume method @xcite .",
    "the md - cfd coupling is solved by the hybridmd scheme@xcite , based on the exchange of momentum flux across the interface h. pressure and stress are imposed into md via external forces acting on particles at the buffers b. the adress scheme @xcite ( see the middle figure ) gradually adapts the atomic resolution of the molecules : from all - atom ( @xmath3 ) to coarse - grained ( @xmath6 ) descriptions , passing through a hybrid ( @xmath5 ) model .",
    "adress and hybridmd can be combined in two ways depending on location of the interface h : either using a _ coarse - grained buffer _ ( a ) , see ref .",
    "@xcite ; or an _ adaptive resolution buffer _ ( b ) and ( c ) , explored in this work .",
    "figure ( c ) is an illustration of this triple - scale scheme for liquid water .",
    "the hydrodynamic coupling is made along @xmath14 direction , ( finite volume cells are @xmath62 wide ) and the system is periodic in the orthogonal directions . the atomic resolution of water molecules is gradually switched on as they move across the buffer , which is @xmath63 long .",
    "the @xmath5 region is @xmath64 and its distance to h is about 1@xmath65 .",
    "a standard dpd thermostat at @xmath66 is used for the @xmath6 and @xmath5 domains , with a friction constant @xmath67 .",
    "information between md and cfd is exchanged after every fixed time interval @xmath68 , with @xmath69 .",
    "here we typically used @xmath70 and @xmath71fs ( small enough to recover o - h vibrational motion ) .",
    "[ water_3s ] ]    s obtained in a all - atom ( @xmath3 model ) periodic boundary simulation of the flexible tip3p water at ambient conditions and within the md region of a triple - scale simulation . at the buffer we used a @xmath6 model",
    "whose rdf@xmath32 ( dashed line ) was not fitted to the all - atom result .",
    "the inset shows the effective potentials @xmath31 and @xmath33 used in the first protocol ( see text ) , which correctly reproduce the all - atom @xmath72 : two minima corresponding to the first and second hydration shells of the liquid are observed ."
  ],
  "abstract_text": [
    "<S> we have conducted a triple - scale simulation of liquid water by concurrently coupling atomistic , mesoscopic , and continuum models of the liquid . </S>",
    "<S> the presented triple - scale hydrodynamic solver for molecular liquids enables the insertion of large molecules into the atomistic domain through a mesoscopic region . </S>",
    "<S> we show that the triple - scale scheme is robust against the details of the mesoscopic model owing to the conservation of linear momentum by the adaptive resolution forces . </S>",
    "<S> our multiscale approach is designed for molecular simulations of open domains with relatively large molecules , either in the grand canonical ensemble or under non - equilibrium conditions . </S>"
  ]
}