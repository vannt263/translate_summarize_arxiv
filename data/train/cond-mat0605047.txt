{
  "article_text": [
    "wannier function@xcite is a powerful tool in the study of the chemical bonding , dielectric properties , excited electronic states , electron transport , and many body correlations in materials . in particular , the modern theory of bulk polarization",
    "relates the vector sum of the centers of the wannier functions to the macroscopic polarization of a crystalline insulator.@xcite however , the intrinsic nonuniqueness in the wannier function definition , and the difficulty in defining their centers within a periodic cell calculation , limited their practical use .",
    "fortunately , an elegant method has been recently proposed by marzari and vanderbilt to obtain a unique set of maximally - localized wannier functions ( mlwfs).@xcite by transforming the occupied electronic manifold into a set of mlwfs , it becomes possible to obtain an enhanced understanding of chemical bonding properties and electric polarization via an analysis of the mlwfs . beside the above points ,",
    "the mlwfs are now also being used as a very accurate minimal basis for a variety of algorithmic or theoretical developments , with recent applications ranging from linear - scaling approaches@xcite to the construction of effective hamiltonians for the study of ballistic transport,@xcite strongly - correlated electrons,@xcite self - interaction corrections , metal - insulator transitions,@xcite and photonic lattices.@xcite    in the seminal work of marzari and vanderbilt , first a ground state calculation was carried out to obtain the occupied delocalized canonical orbitals , then a sequence of unitary transformations were performed to obtain mlwfs which minimize the spread function.@xcite using the exponential representation for the unitary transformation , berghold _",
    "et al._@xcite derived an iterative scheme to obtain mlwfs in large supercells of arbitrary symmetry .",
    "also a simple jacobi orbital rotation scheme was found to be remarkably efficient.@xcite a simultaneous diagonalization algorithm similar to the jacobi diagonalization method , was used by gygi _",
    "_ to compute mlwfs.@xcite zicovich - wilson _",
    "proposed a wannier - boys scheme to obtain well localized wannier functions in linear combination of atomic orbital periodic calculations .",
    "@xcite however , all methods mentioned above for calculating mlwfs are nearly o(n@xmath0 ) scaling ( n is the number of electrons ) , which prohibits their applications to large systems containing hundreds or thousands of atoms .",
    "the unfavorable scaling comes from two steps in these methods : the conventional methods for getting ground state wavefunctions is o(n@xmath0 ) or o(n@xmath1n ) , and the localization step in the above localization algorithms is also o(n@xmath0 ) .",
    "usually , the traditional ground state calculation will cost more than the localization step .",
    "however , for large systems the computing amount of the localization step is also time - consuming .    in this work",
    ", we propose a simple order - n algorithm for effectively calculating mlwfs . the demanding ground state calculation",
    "is circumvented by using o(n ) density matrix purification methods .",
    "after adopting o(n ) method for the ground state calculation , the conventional o(n@xmath0 ) localization step will become time - dominant for large systems . to obtain mlwfs in linear scaling ,",
    "we first get initial localized orbitals from the density matrix , then an o(n ) localization method which uses the jacobi rotation scheme is utilized to maximally localize the orbitals .",
    "the linear scaling behavior of the new method is demonstrated by computing the mlwfs of boron nitride ( bn ) nanotubes .",
    "this paper is organized as follows : in sec .",
    "[ theory ] , we present our new o(n ) method for calculating mlwfs . in sec .",
    "[ impl ] , we describe the details of the implementation and perform some test calculations to illustrate the rightness , robustness , and linear - scaling behavior of our methods .",
    "we discuss some possible extensions and generalizations of our method in sec .",
    "[ dis ] . finally , our concluding remarks are given in sec .",
    "the wannier functions are defined in terms of a unitary transformation of the occupied bloch orbitals . however , they are not uniquely defined , due to the arbitrary freedom in the phases of the bloch orbitals .",
    "marzari and vanderbilt @xcite resolve this indeterminacy by minimizing the total spread function of the wannier functions @xmath2 @xmath3 where @xmath4 , and @xmath5 .    here since we aim at large systems , the @xmath6-point - only sampling of the brillouin zone ( bz ) is used throughout this work .",
    "the method of calculating mlwfs for supercells of general symmetry is proposed by silvestrelli _",
    "et al._.@xcite for the sake of simplicity , considering the case of a simple - cubic supercell of side @xmath7 , it can be proved that minimizing the total spread @xmath8 is equivalent to the problem of maximizing the functional @xmath9 where @xmath10 and similar definitions for @xmath11 and @xmath12 apply .",
    "the coordinate @xmath13 of the @xmath14th wannier - function center ( wfc ) is computed using the formula @xmath15 with similar definitions for @xmath16 and @xmath17 .",
    "our new o(n ) method consists of four o(n ) steps :",
    "first we obtain the density matrix , secondly we find out a set of linear independent nonorthogonal orbitals which span the occupied manifold , thirdly , a modified lwdin orthogonalization is used to orthogonalize these nonorthogonal orbitals , finally , the jacobi rotation scheme is utilized to maximally localize the orbitals .    in principles , any localized orbitals or density matrix based linear scaling methods can be used to obtain initial localized orbitals in linear scaling.@xcite here we use the o(n ) trace - correcting density matrix purification ( tc2)@xcite method to get the density matrix since it is very simple , robust , and efficient .",
    "the use of some other linear scaling methods based on localized orbitals will be discussed in sec .",
    "[ dis ] . here , the essence of the tc2 method is briefly outlined . in the begining ,",
    "the hamiltonian @xmath18 represented in the orthogonal basis is normalized to an initial matrix @xmath19 with all its eigenvalues mapped onto [ 0,1 ] : @xmath20 , where @xmath21 and @xmath22 are lowest and highest eigenvalues of @xmath18 , respectively .",
    "then we correct the trace of the density matrix while purifying it using the following iteration : @xmath23 where @xmath24 is the total number of electrons in a close - shell system .",
    "given an atomic orbital , one can project out its occupied component using the density matrix operator @xmath25 : @xmath26 where @xmath27 is the overlap matrix , @xmath28 and @xmath29 denote the atomic basis orbitals , @xmath30 denotes the density matrix in the atomic orbital basis . by applying the density matrix operator on @xmath31 atomic basis orbitals",
    ", we can get @xmath31 localized orbitals @xmath32 , among which only @xmath33 ( the number of occupied states ) localized orbitals are linear independent",
    ". one must select out @xmath33 linear independent localized orbitals among these localized orbitals @xmath32 before performing localization steps .",
    "we have implemented two algorithms to achieve this goal .",
    "one of the algorithms is similar to that proposed by maslen _",
    "et al._,@xcite who used cholesky decompositions for detecting the linear dependence .",
    "we note that in this method the total demanding for the construction of all the overlap matrices is o(n ) since the nonorthogonal orbitals are localized .",
    "furthermore , the total computing amount for performing all cholesky decompositions is almost the same as that for performing a sparse cholesky decomposition with the matrix dimension @xmath33 due to the nature of the cholesky decomposition . in the second algorithm ,",
    "we select these atomic basis orbitals to be projected according to the physical intuition . for example , in bn nanotubes , there are one 2s and three 2p basis orbitals for each b and n atoms when using pseudopotentials . since some electrons will transfer from b to n atoms , we can get @xmath33 linear independent localized orbitals by just projecting the density matrix on all atomic basis orbitals of n atoms in despite of the large covalency in these systems . for systems",
    "where the bonding properties are known , the algorithm is found to be very efficient and the resulting orbitals are very sparse . in cases where the second algorithm does nt apply , we will resort to the first algorithm .    since mlwfs",
    "are orthogonal to each other , the @xmath33 linear independent nonorthogonal localized orbitals must be orthogonalized .",
    "it is well known that the orthogonalized orbitals produced by the lwdin orthogonalization are closest to initial nonorthogonal orbitals in the sense of least squares . to obtain orthogonal localized orbitals in linear scaling ,",
    "we carry out a modified lwdin orthogonalization adopted by stephan and drabold.@xcite in this approach , we perform repeated first - order lwdin iterations @xmath34 the functions after every orthonormalization cycle have to be renormalized .",
    "typically , we can obtain well orthogonal localized orbitals in about five o(n ) orthonormalization cycles .",
    "now we will discuss how to maximally localize these orthogonal orbitals to get mlwfs in linear scaling .",
    "our target is maximizing @xmath35 to obtain mlwfs in linear scaling . the key point for the successful o(n )",
    "localization step is that these orbitals are localized in the whole localization procedure .",
    "we use the simple jacobi rotation method to maximize @xmath35 since it does nt require o(n@xmath0 ) diagonalization in contrast to the unitary transformation method.@xcite this method is a traditional method in quantum chemistry for computing localized molecular orbitals first introduced by edmiston and ruedenberg.@xcite the basic idea of the method is to tackle the problem of maximizing @xmath35 by carrying out several jacobi sweeps . in a traditional jacobi sweep ,",
    "we perform @xmath36 consecutive two - by - two rotations among all pairs of orbitals .",
    "the elementary step consists of a plane rotation where two orbitals are rotated through an angle and all other orbitals are fixed . in our o(n ) method , due to the localization of the orbitals , the computing amount of an orbital ratation is o(n ) . moreover ,",
    "each orbital overlaps with only o(1 ) orbitals , thus the number of the jacobi rotations in a jacobi sweep is of order n. assuming the number of the jacobi sweeps does nt change ( it is really the case for systems with similar characters ) , the total computing amount is o(n ) .",
    "our newly developed method has been implemented in siesta,@xcite a standard kohn - sham density - functional program using norm - conserving pseudopotentials and numerical atomic orbitals as basis sets . in siesta ,",
    "periodic boundary conditions are employed to simulate both isolated and periodic systems .",
    "the details about the implementation of the tc2 method can be found in ref . [ 18 ] .",
    "all our calculations reported in this work are done in the local density approximation ( lda).@xcite unless otherwise stated , the double-@xmath37 plus polarization functions ( dzp ) basis set is used in the calculations .",
    "first we calculate the mlwfs ( i.e. , boys orbitals@xcite ) of a water molecule .",
    "it is well known that there are four mlwfs for a h@xmath38o molecule : two covalent o - h @xmath39 bonds and two lone - pair orbitals .",
    "the distance between the centroids of these four mlwfs and the position of the oxygen ion is 0.52 , 0.52 , 0.30 , and 0.30   respectively .",
    "the results agree well with those reported by berghold _",
    "et al._.@xcite as a second check of the validity of our method , we calculate the piezoelectric constant of bulk zno .",
    "both the berry phase method@xcite and our new o(n ) method are used to calculate piezoelectric constant @xmath40 of bulk wurtzite zno . in our o(n ) calculation , we use a @xmath41 zno supercell since we use the @xmath6-only sampling .",
    "the results from these two methods agree very well : the computed values are @xmath42 and @xmath43 c / m@xmath44 , respectively . and",
    "both results accord with others result @xcite ( @xmath45 c / m@xmath44 ) computed through the density functional perturbation theory .",
    "then we test our method by applying it to calculate the mlwfs of bn(5,5 ) armchair nanotubes . fig .",
    "[ fig1 ] shows four mlwfs of bn(5,5 ) nanotubes computed using the supercell containing 200 atoms .",
    "we can clearly see that the three mlwfs in fig .",
    "[ fig1](a)-(c ) are b - n @xmath39 bonds . among these mlwfs ,",
    "the mlwf in fig .",
    "[ fig1](a ) has exactly the same character as that shown in fig .",
    "[ fig1](c ) due to the mirror plane symmetry in armchair bn nanotubes .",
    "the other mlwf in fig .",
    "[ fig1](d ) is a @xmath46 orbital , which almost centers at a nitrogen atom .",
    "it is interesting that in bn nanotubes mlwfs preserve @xmath47 separation .",
    "we will return to this point later . to see the efficiency of our new o(n ) method",
    ", we perform a series of calculations using the linear scaling method or the traditional jacobi rotation method which does nt take advantage of the localization property of the orbitals .",
    "two different basis sets ( single-@xmath37 ( sz ) , dzp ) are employed in the calculations using the new o(n ) method , and only the sz basis set is used for the traditional method . the cpu time is shown in fig .",
    "we clearly see the perfect linear scaling behavior of our new method . and",
    "the traditional method displays a nearly o(n@xmath0 ) scaling as expected .",
    "the computing saving of our method with respect to the traditional method is dramatically large , especially when the size of systems exceeds 400 atoms .",
    "in addition , we note that the ratio between the time for calculating mlwfs using dzp basis and that using sz basis is smaller than the case for the ground state calculation.@xcite",
    "we have also implemented the method for obtaining mlwfs from the localized orbitals produced by the o(n ) mauri - ordejn ( mo ) @xcite or kmg@xcite methods . in case of the mo method ,",
    "the number of localized orbitals is equal to the number of occupied states , and all localized orbitals produced by the o(n ) mo method are linear independent .",
    "thus the projection step is unnecessary .",
    "however , in the kmg energy functional , the number of localized orbitals is larger than the number of occupied states . in this case , we first get the density matrix using equation ( 87 ) in the paper written by soler et al .. @xcite once the density matrix is available , the steps to get mlwfs are the same as those described in sec .",
    "[ theory ] .    in our implementation , numerical localized atomic orbitals are used as basis sets . other localized basis such as gaussian orbitals or real space methods@xcite",
    "can also be used .",
    "however , the use of non - local plane - wave basis which was commonly adopted in previous calculations of mlwfs will not result in linear scaling behavior .",
    "our previous discussions mainly focus on mlwfs in periodic systems .",
    "we should note that our method could also be adopted to obtain boys@xcite localized orbitals of isolated molecular systems with or without using periodic boundary conditions . in this case",
    ", one can directly minimize the spread function instead maximize the functional @xmath35 . besides boys orbitals , edmiston - ruedenberg ( er)@xcite and pipek - mezey ( pm)@xcite localized orbitals are also popular among chemists .",
    "the benefit of these localized orbitals is that , unlike boys orbitals , er and pm orbitals always preserve @xmath47 separation .",
    "our method can be used to get pm orbitals in linear scaling .",
    "however , due to the long range character of the operator @xmath48 , our method is unable to reduce significantly the computing amount in the calculation of er orbitals .",
    "we notice that an efficient method which reduces the scaling from o(n@xmath49 ) to o(n@xmath44)-o(n@xmath0 ) has been proposed by subotnik _",
    "et al._.@xcite    although we only discuss spin - restricted systems up to now , combined with the spin - unrestricted linear scaling electronic structure theory,@xcite our o(n ) method can be straightforwardly applied to insulating magnetic systems .",
    "this method can be used to study the large multiferroic ( simultaneously ( ferro)magnetic and ferroelectric ) materials .",
    "to summarize , a linear scaling algorithm for calculating mlwfs has been proposed for the first time .",
    "the numerical atomic orbital basis instead of commonly adopted plane wave sets is used .",
    "first we perform a linear scaling ground state calculation using the tc2 purification method . from the density matrix",
    ", we get the initial non - orthogonal localized orbitals . through a modified lwdin orthogonalization",
    ", we obtain the initial orthogonal localized orbitals . due to the localization property of these initial orbitals , the computing requirement of the subsequent jacobi sweeps for getting mlwfs is also linear scaling .",
    "our results for water molecule and bulk wurtzite zno agree well with others results .",
    "the o(n ) behavior of the proposed method is clearly demonstrated by computing the mlwfs of bn nanotubes .",
    "our o(n ) method provides a very efficient way for obtaining mlwfs which have many possible applications .",
    "w. ku , h. rosner , w. e. pickett , and r. t. scalettar , phys .",
    "lett . * 89 * , 167204 ( 2002 ) ; i. schnell , g. czycholl , and r. c. albers , phys .",
    "b * 65 * , 075103(2002 ) ; k. nakamura , r. arita , y. yoshimoto , s. tsuneyuki , cond - mat/0510425 ."
  ],
  "abstract_text": [
    "<S> we have developed a linear scaling algorithm for calculating maximally - localized wannier functions ( mlwfs ) using atomic orbital basis . </S>",
    "<S> an o(n ) ground state calculation is carried out to get the density matrix ( dm ) . through a projection of the dm onto atomic orbitals and a subsequent o(n ) orthogonalization </S>",
    "<S> , we obtain initial orthogonal localized orbitals . </S>",
    "<S> these orbitals can be maximally localized in linear scaling by simple jacobi sweeps . </S>",
    "<S> our o(n ) method is validated by applying it to water molecule and wurtzite zno . </S>",
    "<S> the linear scaling behavior of the new method is demonstrated by computing the mlwfs of boron nitride nanotubes . </S>"
  ]
}