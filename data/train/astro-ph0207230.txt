{
  "article_text": [
    "understanding the formation and evolution of galaxies is a fundamental step in linking the initial condition of the universe and the cosmological observational data .",
    "recent systematic studies of high - redshift objects , such as quasars and lyman - break galaxies , should provide important clues to the early universe , although their proper interpretation is often not so straightforward , mainly because those objects certainly do evolve in time .    a theoretical study of galaxy evolution , especially its spectroscopic evolution , from a cosmological context ,",
    "was begun by @xcite and followed by many authors ( e.g. , @xcite ; @xcite ; @xcite ; @xcite ; @xcite ; @xcite ) .",
    "these studies are based on a so - called ` one - zone ' model which assumes that a galaxy does not interact with other galaxies .",
    "it is now fairly established , however , that structures in the universe have built up hierarchically from small to large scales as in a cold dark matter ( cdm ) model .",
    "this means that a galaxy interacts and sometimes merges with other galaxies even if it was an isolated system at birth .",
    "the predictions in the one - zone model therefore may be significantly different from what happened to galaxies in a hierarchical universe .",
    "white and frenk ( 1991 ) developed a detailed analytic formalism to describe the formation and evolution of galaxies while taking account of the hierarchical merging of dark - matter halos , gas cooling , star formation , and supernova feedback .",
    "subsequent numerical approaches in modeling hierarchical merging of dark halos employ two somewhat different algorithms ; one is called the ` block model ' in which a random - gaussian density fluctuation field is generated by dividing a hypothetical rectangular box recursively ( @xcite ; @xcite ; @xcite ) .",
    "while this algorithm is simple and straightforward , the resulting halo masses are necessarily binned in discrete steps of a factor of two .",
    "the other generates a realization of halo merger trees according to a probability distribution function predicted by the extended press  schechter theory ( @xcite ; @xcite ; @xcite ; @xcite ; @xcite ) .",
    "the latter is widely used in studying the cosmological evolution of galaxies in a hierarchical universe ( @xcite ; @xcite ; @xcite ; @xcite ; @xcite ) . throughout the present paper ,",
    "we call the latter method the monte - carlo modeling of merger histories ( simply , the monte - carlo modeling ) , while it is usually referred to as a semi - analytic model of galaxy formation ( sam ) .    the most important ingredient in monte - carlo modeling is the conditional joint - probability distribution function of a set of _ progenitor _ halos of mass @xmath1 at a redshift of @xmath2 , which is a part of a _ parent _ halo of mass @xmath3 at @xmath4 , conceptually written as @xmath5 unfortunately only an analytical expression for the conditional one - point probability distribution function , prob(@xmath6 , @xmath7 , @xmath4 ) , is known based on the extended press  schechter theory ( for the special case of the poisson initial power spectra , see a different approach by @xcite ) ; one thus needs to employ an additional _ assumption _ in generating realizations of merger trees of halos in general ( e.g. , @xcite ; @xcite ) .",
    "furthermore , any numerical procedure to generate them necessarily involves several _ ad hoc _ parameters due to the limitation of the available computation resources including the finite timestep of computation , the minimum mass of halos to be included in merger trees , and the maximum number of progenitors for each halo at each step .",
    "the purpose of the paper is to perform a systematic investigation of possible artificial effects of the above - mentioned problems on merger tree realizations , and to re - examine the validity of the monte - carlo modeling . in particular",
    ", we focus on the extent to which the resulting merger trees reproduce the conditional one - point probability distribution function predicted by the extended press  schechter theory , which directly changes the fraction of cold gas .",
    "exactly for this reason , we adopt a conventional @xmath8cdm model with the cosmological parameters @xmath9 , @xmath10 , @xmath11 , @xmath12 , and @xmath13 ( e.g. , kitayama , suto 1997 ; kitayama et al .",
    "1998 ) , and neglect star formation and a feedback effect for definiteness .",
    "our model of merging histories of dark - matter halos is mainly based on that of somerville and kolatt  ( 1999 ) , which we adopt as our fiducial choice and slightly modify their original scheme as follows .",
    "we begin with a halo of mass of @xmath14 at a redshift of @xmath15 , and consider its progenitors at a slightly earlier redshift of @xmath16 . since the joint conditional probability for the progenitors [ equation  ( [ eq : jointprob ] ) ] is not known , we choose the @xmath17-th progenitor halo of mass @xmath6 according to the _ one - point _ conditional probability , prob(@xmath6 , @xmath7 , @xmath4 ) , as long as @xmath18 and the total mass satisfies @xmath19 where @xmath20 is the expectation value of the total mass of halos smaller than the resolution mass ( @xmath21 ) with @xmath22 being the appropriate conditional mass function [ equation  ( [ eq : eps - num ] ) below ] . in other words ,",
    "we distinguish the discrete merging and the continual accretion at mass @xmath21 , and do not resolve the halos below @xmath21 in our merger trees . once all relevant progenitor halos are selected , we repeat the above procedure recursively for each progenitor until the maximum redshift ( @xmath23 ) . unless otherwise stated , we set @xmath24 and @xmath25 in the present paper . for convenience , we list in table  [ tab : parameters ] variables which are extensively discussed in the present paper .    in the original method by somerville and kolatt  ( 1999 ) ,",
    "one stops selecting progenitors when @xmath26 becomes less than @xmath27 , but without imposing the condition @xmath28 .",
    "they carefully tuned the timesteps depending on @xmath29 so that the resulting progenitor mass function becomes close to equation ( [ eq : eps - num ] ) below .",
    "rather , we stop choosing the progenitor when @xmath30 becomes negative , and the last selected progenitor @xmath31 is not included in the tree . in this case , the remaining mass @xmath32 is not necessarily smaller than @xmath21 .",
    "we find that our method reproduces equation ( [ eq : eps - num ] ) even with the @xmath3-independent timesteps .",
    "the most important and subtle issue is the proper choice of the _ one - point _",
    "conditional probability , prob(@xmath33 , @xmath7 , @xmath4 ) .",
    "bower ( 1991 ) and bond et al .",
    "( 1991 ) derived the conditional probability of @xmath33 at @xmath2 , which is a part of halo @xmath3 at @xmath4 : @xmath34   \\left|   \\frac{ds_{2}}{dm_{2 } }   \\right| , \\end{aligned}\\ ] ] where @xmath35 ( its useful approximate formula may be found in kitayama , suto 1996 ) is the critical over - density of the mass density field at a redshift of @xmath36 , @xmath37 is the linear growth rate , and @xmath38 is a mass variance of the density field top - hat smoothed over the mass scale @xmath39 . since equation ( [ eq : eps - mass ] ) is the _ mass - weighted _ probability for @xmath33 , it is easily translated to the _ number - weighted _ probability that we need in the halo number counting : @xmath40    ( 80mm,80mm)fig01onestep.eps    figures  [ fig : onestep ] and [ fig:100step ] present how the progenitor number distribution of the merger tree realizations reproduces the theoretical prediction : @xmath41 ( _ left _ ) and @xmath42 ( _ right _ ) . in these plots ,",
    "we adopt the logarithmically equal timestep in redshift : @xmath43 where @xmath44 is the total number of the redshift bins .",
    "we defer the discussion concerning the choice of @xmath44 to the next subsection ( [ sec : timestep ] ) , and fix @xmath45 throughout this subsection .",
    "the top panels in figure  [ fig : onestep ] show the result for the 1st timestep ( @xmath46 ) corresponding to @xmath47 according to equation ( [ eq : zbin ] ) .",
    "we call this model sk - n indicating the somerville and kolatt  ( 1999 ) method with the number - weighted probability .",
    "the symbols indicate the average @xmath48 with the quoted error - bars being the corresponding one - sigma dispersion , where @xmath49 is the number of progenitors in the range of mass @xmath50 , and we adopt @xmath51 . in the sk - n model",
    "we generate the random numbers according to the number - weighted probability distribution function [ equation  ( [ eq : eps - num ] ) ] .",
    "also we have to set the lower limit on the progenitor mass in adopting the sk - n model so as to avoid a divergent total probability .",
    "we adopted the lower limit of @xmath52 , and made sure that the mass function of progenitors of the mass range of our interest @xmath53 is properly reproduced .",
    "the solid triangles show our result based on the algorithm outlined in the previous subsection . somewhat surprisingly , they are completely different from the theoretical distribution that we use in generating the trees ( solid curve ) .",
    "note that figure  [ fig : onestep ] plots the number distribution multiplied by @xmath33 , @xmath54 [ see equation  ( [ eq : eps - num ] ) ] .",
    "to understand the origin of the discrepancy , we generate the progenitors at the 1st timestep for @xmath55 realizations simultaneously as long as they satisfy @xmath56 , \\end{aligned}\\ ] ] instead of the mass conservation [ equation  ( [ eq : massconserve ] ) ] for each individual parent halo . in the above ,",
    "@xmath57 is not the number of progenitors for a single halo at @xmath58 , but for an ensemble of @xmath59 halos with the same mass @xmath60 .",
    "the resulting distribution is plotted in open circles , and in fact shows good agreement with the theoretical curve .",
    "this is simply because we attempt to generate a joint distribution of progenitors with a repeated use of the conditional probability [ equation  ( [ eq : eps - num ] ) ] _ incorrectly _ ; except for the first progenitor , the mass conservation for each halo [ equation  ( [ eq : massconserve ] ) ] introduces an additional cutoff at higher mass in the selection probability of progenitors .",
    "in fact the conditional probability [ equation  ( [ eq : eps - num ] ) ] for @xmath61 is sharply peaked at a mass scale @xmath33 just below the parent mass @xmath3 , and thus even a small value of the first progenitor mass may effectively bias not to choose remaining progenitors in the peak .",
    "thus , the resulting distribution is significantly biased toward low - mass objects , i.e. , the number density of the low - mass objects exceeds the theoretical predictions by an order of magnitude ( top panels in figure  [ fig : onestep ] ) .    one way out of this problem is to generate many ( @xmath62 ) realizations simultaneously , as kauffmann and white  ( 1993 ) adopted . even in this case",
    ", one needs to specify an additional assumption on how to plant a set of progenitors in a single merger tree _ by hand_. moreover , a practical implementation of this method requires one to discretize the halo mass , and thus becomes computationally demanding as both the mass and time resolutions increase .",
    "another possibility is to artificially distort the input conditional probability so that the selected progenitors obey the distribution [ equation  ( [ eq : eps - num ] ) ] .",
    "while the required correction may be a fairly definite mathematical problem , we do not know the exact answer , and thus have to proceed in a phenomenological fashion .",
    "basically this is the approach taken by somerville and kolatt  ( 1999 ) and sheth and lemson  ( 1999 ) , who adopted the _ mass - weighted _ probability [ equation  ( [ eq : eps - mass ] ) ] as the theoretical input .",
    "the middle and bottom panels in figure  [ fig : onestep ] show the resulting distribution for sk - m ( @xcite - mass weighted ) and sl - m ( @xcite - mass weighted ) , respectively .",
    "clearly the resulting distributions ( filled triangles ) become much closer to equation ( [ eq : eps - num ] ) under the constraint [ equation  ( [ eq : massconserve ] ) ] although their original distributions [ i.e. , without the constraint ( [ eq : massconserve ] ) ] plotted in open circles are completely different .",
    "as this indicates , the input conditional probability for the current purpose should be small at lower mass scales of @xmath33 relative to equation ( [ eq : eps - num ] ) .",
    "thus , we also attempted to make the probability proportional to @xmath63 .",
    "note that the mass- and number - weighted probabilities [ equations  ( [ eq : eps - mass ] ) and ( [ eq : eps - num ] ) ] correspond to @xmath64 and @xmath65 .",
    "we were not able to obtain a similar degree of agreement for a value of @xmath66 very different from 0 , but did not find a significant change for @xmath67 .",
    "thus , we decided to adopt @xmath64 ( the mass - weighted probability ) as somerville and kolatt  ( 1999 ) .",
    "this choice has an advantage that a numerical routine to generate random numbers becomes easier than the cases of @xmath68 .",
    "define @xmath69 that obeys gaussian distribution of a unit variance .",
    "equation ( [ eq : eps - mass ] ) implies that the desired distribution of @xmath33 can be simply given via @xmath70 .",
    "since gaussian - distributed random numbers can be implemented easily , all we have to do is to supply the inverse function of the mass variance , @xmath71 .",
    "our sk - m implementation seems to yield a larger discrepancy between theory and the merger tree realizations at small @xmath33 regimes than their original results .",
    "this may be due to the different choice of the timestep and the condition how to stop selecting progenitor halos . in any case",
    ", however , this discrepancy rapidly fades away in constructing the merger tree using many timesteps , as we show in figures  [ fig:100step ] and [ fig:1000step ] .",
    "( 80mm,80mm)fig02z01.eps    figure  [ fig:100step ] plots a snapshot of the progenitor distribution at the 25th timestep ( @xmath72 ) , which makes sure that the mass - weighted probability reasonably works , even when we trace the merger tree by many steps .",
    "also sk - m works a bit better than sl - m especially at small mass scales .",
    "originally sl - m was proposed to correct for the halo exclusion effect , but does not work so efficiently at least in the range of parameters we surveyed .",
    "figure  [ fig:100step ] also indicates that sk - n is substantially different from the analytical solution .",
    "this is due to the fact that sk - n tends to select relatively less massive progenitors preferentially ( see figure  [ fig : onestep ] ) , and this tendency simply accumulates in many steps . on the contrary , the behavior of sk - m and sl - m becomes closer to the analytical solution than in the case of figure  [ fig : onestep ] .",
    "this is because the latter two models well approximate the probability distribution around @xmath3 , which is the most important range when constructing real merger trees with many timesteps .",
    "the next question that we address is the appropriate choice of the timestep .",
    "while this is an equally important problem in the monte - carlo modeling , the previous authors did not discuss it in an explicit manner .",
    "( 60mm,60mm)fig03timescale.eps    obviously , the timestep needs to be smaller than the dynamical timescale of halos just virialized at the redshift , @xmath73 , because they are the objects that serve as the initial condition for the monte - carlo modeling .",
    "figure  [ fig : timescale ] compares this timescale and our choice [ equation  ( [ eq : zbin ] ) ] for @xmath74 , 100 , 1000 . also , we plot the cosmic time @xmath75 and the timestep corresponding to the linearly equal bin ( @xmath76 ) .",
    "even this simple comparison indicates that the logarithmic time bin with @xmath77 is required .",
    "while the important question is how small timescales one should resolve , it critically depends on the problem that one would like to address .",
    "therefore , we rather ask how many timesteps we need to reproduce the progenitor distribution .",
    "( 80mm,80mm)fig04nstep1000.eps    to see explicitly how different values of @xmath78 affect the realizations of merger trees , we plot in figure  [ fig:1000step ] the progenitor distribution with @xmath79 at redshifts of @xmath80 , @xmath81 , and @xmath82 .",
    "a comparison of figures  [ fig:100step ] and [ fig:1000step ] indicates that the average progenitor distribution is indeed slightly better reproduced by @xmath79 than @xmath83 , particularly at small mass scales .",
    "( 80mm,80mm)fig05progmassfrac.eps    the difference between @xmath45 and 1000 is more clearly illustrated when we plot the cumulative mass fraction of progenitors of mass exceeding a threshold value of @xmath84 .",
    "more specifically , figure  [ fig : massfrac ] compares the theoretical prediction , @xmath85 with the average from the tree realizations , @xmath86 for @xmath87 ( _ left _ ) and @xmath88 ( _ right _ ) . in all panels shown here , the results with @xmath79",
    "better reproduce the theoretical prediction , mainly because of the small - scale behavior ( see figures  [ fig:100step ] and [ fig:1000step ] ) .",
    "since these small mass progenitors at earlier redshifts significantly contribute to radiative cooling and thereby subsequent star formation in the entire halo , this difference is indeed critical in the monte - carlo modeling of galaxy formation .",
    "we discuss the effect on gas cooling explicitly in the next section .",
    "( 60mm,60mm)fig06progmassfrac.eps    we interpret the above as an empirical result due to the balance between the mass - weighted probability and the timesteps . if the use of the mass - weighted probability _ were _",
    "strictly justified , the proper realizations with a smaller timestep would become more difficult numerically , and there is no reason why we could obtain better agreement with a larger @xmath78 . on the other hand , we understand that the mass - weighted probability is nothing but a phenomenological remedy of the problem , and with this choice @xmath79 seems to work better than @xmath83 empirically .    in fact ,",
    "still larger values of @xmath78 do not necessarily improve the result .",
    "figure  [ fig : mflargenstep ] is a similar plot as figure  [ fig : massfrac ] for @xmath89 , but with increasing @xmath90 .",
    "the cumulative mass fraction for @xmath91 is almost unchanged , but the contribution from smaller mass progenitors steadily increases as @xmath90 becomes larger .",
    "this reflects the fact that the empirical use of the mass - weighted conditional probability does not guarantee convergence of the result with respect to @xmath90 .",
    "we thus conclude that @xmath92 is the optimal value to reproduce the press ",
    "schechter mass function in our method .",
    "finally , we briefly discuss how many progenitors , @xmath93 , one should keep in order to properly reproduce the merger trees .",
    "figure  [ fig : nprog ] displays the distribution functions at @xmath94 for the merger tree of @xmath95 at @xmath96 . in this particular example , we use @xmath79 and the results are averaged over @xmath97 realizations for each @xmath93 .",
    "obviously a smaller value of @xmath93 does not properly link the merger tree back to higher redshifts , and the number of small - mass halos is systematically under - predicted compared with the extended press  schechter model ( solid curve ) . while we do not set any upper limit on @xmath98 , figure  [ fig : nprog ]",
    "indicates that @xmath99 is acceptable given the accuracy of the present scheme .",
    "although some authors employ a binary merger tree in monte - carlo modeling , that scheme needs to be adjusted with a careful choice of the timestep and other parameters .",
    "( 60mm,60mm)fig07nprog.eps    in conclusion , we have found that a reasonable agreement between the theory and the merger tree realizations can be obtained by employing the mass - weighted conditional probability into the somerville and kolatt  ( 1999 ) scheme with @xmath92 .",
    "so far , we have restricted our discussion to the gravitational aspect of the halo evolution .",
    "we next consider how the resulting merger trees affect the cold gas fraction in an individual halo .",
    "of course , we must eventually discuss the effects on the efficiency of star formation , but we focus on gas cooling alone , since modeling star formation , the feedback from supernovae , the chemical evolution and so on necessarily introduce additional ( numerical ) parameters and the interpretation becomes more complicated .",
    "thus , the principal aim of this section is to see if we can achieve a convergence of the cold gas fraction from different realizations of the merger trees .",
    "our prescription of gas cooling in the merger trees goes as follows .",
    "first , we assume that the density profile of dark halos obeys the universal shape ( @xcite ) : @xmath100 where @xmath101 is the mean density of the universe at @xmath102 , @xmath103 is the present critical density , @xmath104 is the characteristic density excess , and @xmath105 and @xmath106 indicate the virial radius and the scale radius of the halo , respectively .",
    "the virial radius is defined according to the spherical collapse model as @xmath107 and useful approximation for the critical over - density , @xmath108 , may be found in kitayama and suto ( 1996 ) .",
    "the two parameters , @xmath109 and @xmath110 , are related in terms of the concentration parameter , @xmath111 we use an approximate fitting function from the simulation data of bullock et al .",
    "( 2001 ) , @xmath112 the condition that the total mass inside @xmath113 be equal to @xmath114 relates @xmath115 to @xmath116 as @xmath117 @xcite showed that if the hot gas is isothermal and in hydrostatic equilibrium , the gas density profile is well approximated by the isothermal @xmath118-model , @xmath119^{3\\beta/2 } } ,   \\label{eq : rhogas}\\ ] ] where @xmath120 .",
    "we fix @xmath121 for simplicity . the amplitude @xmath122 is computed so as to reproduce the total hot gas in the halo when integrated up to @xmath123 .",
    "the hot gas is gradually converted to cold gas according to the prescription below , but still the total baryon ( hot + cold ) fraction within the virial radius of each halo is set to the cosmic average , @xmath124 .",
    "once the gas profile is specified , one can compute the cooling timescale at radius @xmath125 from the center of the halo , @xmath126 where @xmath127 is the mean molecular weight , @xmath128 the proton mass , @xmath129 the boltzmann constant , @xmath130 the radiative cooling function for gas of temperature @xmath131 , and @xmath132 the number density of hydrogen ( including both neutral and ionized ) .",
    "we assume that the gas has the primordial abundance of hydrogen and helium ( @xmath133 and @xmath134 , and thus @xmath135 ) , and compute the corresponding cooling function @xmath136 ( e.g. , sasaki and takahara 1994 ) .",
    "since we neglect the molecular and metal cooling , @xmath137 at @xmath138 .",
    "( 60mm,60mm)fig08tvirtom.eps    we further assume that the temperature of the hot gas , @xmath139 , is equal to the virial temperature , @xmath140 , of the halo .",
    "the relation between the virial temperature and the mass of a halo is plotted in figure  [ fig : tvirtom ] .",
    "we can then solve equation ( [ eq : tcool ] ) for the cooling radius , @xmath141 , within which the gas can cool within a given cooling timescale ( @xmath142 ) : @xmath143 it now remains to define the origin of @xmath142 .",
    "actually , this is fairly arbitrary in a sense , and we adopt the following simple picture . when a halo of mass @xmath144 _ forms _ at the formation redshift , @xmath145 , its hot gas is supposed to reach the profile [ equation  ( [ eq : rhogas ] ) ] instantaneously .",
    "this is defined to be the origin of @xmath142 for the halo . in the subsequent timesteps , we neglect the change in the hot gas profile",
    "even if the halo mass ( @xmath114 ) grows due to mergers and the cooling radius is computed with @xmath142 set to the elapsed cosmic time since @xmath146 .",
    "when @xmath114 exceeds @xmath147 , the halo is replaced by a _",
    "newly _ formed massive halo , and the hot gas profile is reset to the profile [ equation  ( [ eq : rhogas ] ) ] corresponding to the new mass and the virial temperature , and we reset the origin of @xmath148 as the new formation epoch .",
    "incidentally , we made sure that the value of @xmath149 instead of @xmath147 does not change the result , which is consistent with the finding of cole et al.(2000 ) .",
    "we apply this procedure for all halos , and the cold gas in each progenitor halo is simply accumulated ( without reheated ) according to the merger trees .      in a practical implementation of the merger tree algorithm",
    ", one has to stop tracing the progenitors of halos of mass below the resolution mass , @xmath21 .",
    "we discuss the relevance of our choice of @xmath27 by looking at the cold gas fraction .",
    "previous authors often apply the cutoff at a fixed mass or a circular velocity of halos ; for instance , @xcite consider halos with @xmath150 in their merger trees , while somerville and primack  ( 1999 ) take account of halos with the circular velocity exceeding @xmath151 ( corresponding to the virial temperature @xmath152 ) .",
    "the latter condition comes from an estimate of the smallest scale of halos which can cool in the presence of the uv background ( e.g. , @xcite ; @xcite ) .    in our present analysis , the cooling function , @xmath136 ,",
    "vanishes below @xmath153 , since we neglect both the uv heating and the metal / molecular cooling .",
    "thus , we set the resolution mass , @xmath154 , as @xmath155 .",
    "as figure  [ fig : tvirtom ] shows , this scale increases rapidly with time , resulting in a significant improvement of the computing time . on the other hand , this might systematically underestimate the cold gas fraction , since halos of mass below @xmath156 may have progenitors of mass larger than @xmath157 at the earlier epoch ( @xmath158 ) . fortunately",
    ", this is not an important effect , as we show below .",
    "( 60mm,60mm)fig09gasmres.eps    to see this in detail , we plot in figure  [ fig : convmres ] the cold gas fraction averaged over all progenitors at @xmath102 of a root halo of mass @xmath60 at @xmath96 , @xmath159 for a merger tree with @xmath79 .",
    "if we adopt a constant value for the resolution mass , @xmath160 yields the convergent result for the cold gas fraction .",
    "exactly the same convergence is obtained for the time - dependent @xmath161 when the value is set to @xmath155 , but not if we use @xmath162 , for instance .",
    "this critical value is expected to vary depending on the thermal history of the universe , but the appropriate value for @xmath163 is straightforwardly read off from the relevant cooling function . actually , @xmath161 increases in this case and exceeds @xmath164 ( see figure  [ fig : tvirtom ] ) .",
    "thus , the required merging tree is less demanding from a computational point of view than that for @xmath165 , for instance , as illustrated in table  [ tab : cputime ] .",
    "thus we decide to choose @xmath166 for gas with the primordial abundance .",
    "finally , we show the convergence with respect to @xmath78 .",
    "figure  [ fig : convnsamp ] plots the cold gas fraction for @xmath167 ( _ upper _ ) and @xmath168 ( _ lower _ ) for merging trees with different @xmath78 .",
    "the results are fairly in agreement for small @xmath169 , but are very different for large @xmath60 .",
    "this is because the merger tree at small mass scales , especially at @xmath170 , is well reproduced only when we use @xmath79 ( see figure  [ fig : massfrac ] ) .",
    "when we repeat the same calculation sampling every 10 steps from the @xmath79 tree , the result is almost indistinguishable .",
    "thus , we conclude that the progenitor distribution at small scales is quite essential in the estimate of the cold mass fraction of large halos",
    ".    incidentally the use of the timestep much smaller than @xmath73 enables one to describe the collapse and gas cooling more realistically than the instantaneous approximation . while we do not attempt this in the present paper",
    ", this would improve the estimate of the cold gas fraction quantitatively .",
    "we attempted several convergence tests of the merger trees generated with the monte - carlo method . while this method provides a useful tool for modeling galaxy formation in a complementary manner to more intensive cosmological simulations with ad hoc recipes of galaxy formation ( e.g. , cen , ostriker 1992 ; weinberg et al .",
    "1997 ; yoshikawa et al .",
    "2001 ) , the lack of an explicit expression for the joint distribution function of progenitors [ equation  ( [ eq : jointprob ] ) ] requires one to put an additional assumption in practice .",
    "we confirmed that a repeated use of the _ mass - weighted _ conditional probability [ equation  ( [ eq : eps - num ] ) ] reasonably reproduces the progenitor distribution predicted in the extended press ",
    "schechter theory if one adopts fairly small timesteps in redshift , @xmath171 , a factor of ten larger than a typical value used in previous work .",
    "we note , however , that one can alternatively achieve a similar result by fine - tuning the timestep as a function of @xmath29 ( e.g. , @xcite ) instead of equation  ( [ eq : zbin ] ) , as we adopted here .",
    "one may avoid the above problem also by using merger trees generated via @xmath172-body simulations ( @xcite ; somerville et al .",
    "in fact , they claim that the agreement between the @xmath172-body simulations and the monte - carlo method is good .",
    "benson et al .  ( 2001 ) compared the sph simulations and the monte - carlo modeling , and concluded that both agree with each other on the cold gas mass fraction and mass function of the halos .",
    "while this comparison is encouraging , it is not yet clear if the lack of the joint distribution function of progenitors [ equation  ( [ eq : jointprob ] ) ] in the monte - carlo modeling may not be essential . thus , further detailed studies are definitely important to test the reliability of _ both _ @xmath172-body and the monte - carlo modeling in generating merger tree realizations .",
    "we thank kazuhiro shimasaku and tomonori totani for discussions and suggestions in the early phase of this work .",
    "this research was supported in part by the grant - in - aid from monbu - kagakusho , japan ( 07ce2002 , 12304009 , 12640231 ) .",
    "t.k . gratefully acknowledges support from research fellowships of the japan society for the promotion of science for young scientists ( 7202 ) .",
    "arimoto , n. , & yoshii , y. 1986 , , 164 , 260 baugh , c. m. , cole , s. , frenk , c. s. , & lacey , c. g. 1998 , , 498 , 504 benson , a. j. , pearce , f. r. , frenk , c. s. , baugh , c. m. , & jenkins , a. 2001 , , 320 , 261 bond , j. , cole , s. , efstathiou , g. , & kaiser , n. 1991 , , 379 , 440 bower , r. 1991 , , 248 , 332 bruzual , a. g. 1983 , , 273 , 105 bruzual , a. g. , & charlot , s. 1993 , , 405 , 538 bullock , j. s. , kolatt , t. s. , sigad , y. , somerville , r. s. , kravtsov , a. v. , klypin , a. a. , primack , j. r. , & dekel , a. 2001 , , 321 , 559 charlot , s. , & bruzual , a. g. 1991 , , 367 , 126 cen , r. , & ostriker , j. p. 1992",
    ", , 399 , l113 cole , s. 1991 , , 367 , 45 cole , s. , aragn - salamanca , a. , frenk , c. s. , navarro , j. f. , & zepf , s. e. 1994 , , 271 , 781 cole , s. , & kaiser , n. 1988 , , 233 , 637 cole , s. , lacey , c. g. , baugh , c. m. , & frenk , c. s. 2000 , , 319 , 168 guiderdoni , b. , & rocca - volmerange , b. 1987 , , 186 , 1 kauffmann , g. , colberg , j. m. , diaferio , a. , & white , s. d. m. 1999 , mnras , 303 , 188 kauffmann , g. , & white , s. d. m. 1993 , , 261 , 921 kauffmann , g. , white , s. d. m. , & guiderdoni , b. 1993 , , 264 , 201 kitayama , t. , & ikeuchi , s. 2000 , apj , 529 , 615 kitayama , t. , sasaki , s. , & suto , y. 1998 , pasj , 50 , 1 kitayama , t. , & suto , y. 1996 , apj , 469 , 480 kitayama , t. , & suto , y. 1997 , apj , 490 , 557 kodama , t. , & arimoto , n. 1997 , , 320 , 41 lacey , c. , & cole , s. 1993 , , 262 , 627 makino , n. , sasaki , s. , & suto , y. 1997 , , 497 , 555 nagashima , m. , & gouda , n. 2001 , , 325 , l13 navarro , j. f. , frenk , c. s. , & white , s. d. m. 1996 , , 462 , 563 sasaki , s. , & takahara , f. 1994 , prog .",
    "phys . , 91 , 699 sheth , r. k. , & lemson , g. 1999 , , 305 , 946 somerville , r. s. , & kolatt , t. s. 1999 , , 305 , 1 somerville , r. s. , lemson , g. , sigad , y. , dekel , a. , kauffmann , g. , & white , s. d. m. 2001 , , 320 , 289 somerville , r. s. , & primack , j. r. 1999 , , 310 , 1087 tinsley , b. m. 1980 , , 241 , 41 thoul , a. a. , & weinberg , d. h. , 1996 , , 465 , 608 weinberg , d. h. , hernquist , l. , & katz , n. 1997 , , 477 , 8 white , s. d. m. , & frenk , c. s. 1991 , , 379 , 52 yoshikawa , k. , taruya , a. , jing , y. p. , & suto , y. 2001 , , 558 , 520"
  ],
  "abstract_text": [
    "<S> we examine the reliability of the merger trees generated for the monte - carlo modeling of galaxy formation . </S>",
    "<S> in particular we focus on the cold gas fraction predicted from merger trees with different assumptions on the progenitor distribution function , the timestep , and the mass resolution . </S>",
    "<S> we show that the cold gas fraction is sensitive to the accuracy of the merger trees at small - mass scales of progenitors at high redshifts . </S>",
    "<S> one can reproduce the press  </S>",
    "<S> schechter prediction to a reasonable degree by adopting a fairly large number of redshift bins , @xmath0 , in generating merger trees , which is a factor of ten larger than the canonical value used in previous literature . </S>"
  ]
}