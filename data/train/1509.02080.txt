{
  "article_text": [
    "during the past one and a half decade , topology has come to play an important role in several different but related aspects of condensed matter physics . in 2001",
    ", kitaev proposed that a one - dimensional ( 1d ) spinless @xmath1-wave superconductor can provide a route towards topological quantum computation , since it can host topologically protected majorana fermions.@xcite a few years later the subject of topological insulators was born , with the essential feature being an insulating bulk and topologically protected metallic interface states inside the bulk gap.@xcite the close connection between majorana fermions and the edge states in topological insulators was explicitly made clear through the application of topological band theory to superconductors.@xcite an early proposal of such a topological superconductor involved interfacing a topological insulator with a conventional @xmath0-wave superconductor.@xcite this was followed by proposals to construct a related setup using more conventional building blocks , such as @xmath0-wave superconductivity , magnetism , and rashba spin - orbit interaction.@xcite this latter approach is particularly interesting because it can physically be realized in many different ways and therefore leaves plenty of room for experimental implementation .",
    "one of the most recent experimental investigations of majorana fermions involves putting ferromagnetic impurities on top of a superconductor to create a 1d topological superconductor wire , where surface effects give rise to the needed rashba spin - orbit interaction.@xcite the same setup can also be used to assemble structures such as 2d ferromagnetic islands or blocks , which have attracted attention because of their topologically protected edge states.@xcite with this particular approach in mind , but also knowing that the system can be implemented in a variety of ways,@xcite we here investigate both block and wire configurations of magnetic moments on top of a rashba spin - orbit coupled superconductor . to accurately model these systems , we solve self - consistently for the superconducting order parameter .",
    "in particular , we investigate the persistent currents , local density of states ( ldos ) , and the spectral functions .",
    "we recently investigated the current patterns for a magnetic point impurity,@xcite providing insight into the properties of the individual atoms in ferromagnetic domains and also connecting to the well - known physics of yu - shiba - rusinov states of magnetic impurities in superconductors . here , we instead start from the topological band theory of a 2d ferromagnetic block and investigate the resulting edge states , which are shown to be spin - polarized .",
    "we then study 1d wires and connect their properties to the 2d blocks , by considering them as blocks with a width of a single site .",
    "specifically , the end - point majorana fermions are shown to be spin - polarized with a spin - polarization directly related to that of the edge states of the block . through this approach",
    "we are able to fully elucidate the close connection between the topological states in 2d and 1d , as well as the connection to the yu - shiba - rusinov states in 0d .",
    "in addition , we find persistent currents around the ferromagnetic block , which surprisingly flows in opposite direction to what is expected from the dispersion relation of the topologically protected edge states .",
    "this apparent contradiction is resolved as the gap - crossing edge states are indeed found to give rise to a current compatible with their dispersion relation , but lower energy quasiparticles are found to produce even stronger counter - propagating currents , a phenomenon known in other superconductors.@xcite this has important experimental consequences , since physical probes such as superconducting quantum interference devices ( squids ) , which measure the magnetic field generated from the total persistent currents , will give opposite results to probes measuring transport properties involving only states close to the fermi level .",
    "motivated by the presence of rashba spin - orbit interaction , @xmath0-wave superconductivity , and magnetic impurities in recent experimental setups,@xcite we consider the following hamiltonian @xmath2 here @xmath3 and @xmath4 are site indices on a square lattice , @xmath5 is a vector pointing along the four types of nearest neighbor bonds , @xmath6 is the angular coordinate of @xmath5 , and @xmath7 is the vector of pauli matrices .",
    "the parameters of the model are the strength of the hopping parameter @xmath8 , chemical potential @xmath9 , rashba spin - orbit interaction @xmath10 , and superconducting pair potential @xmath11 of the superconducting substrate , as well as the effective zeeman splitting coming from the ferromagnetic impurities @xmath12 .",
    "the superconducting pair potential is used to self - consistently determine the order parameter @xmath13 , where @xmath14 and @xmath15 are the @xmath16-spin electron and hole components , respectively , of the @xmath17th eigenstate .",
    "we here set the hopping parameter @xmath18 , rashba spin - orbit interaction @xmath19 , chemical potential @xmath20 , and superconducting pair potential @xmath21 .",
    "the specific values are not important , but our results are generally valid in a wide range of parameter space.@xcite the zeeman term is set to zero everywhere , except for a block- or line - shaped region , where it is set to a finite @xmath22 , with the direction determined by the unit vector @xmath23 .",
    "this allows us to study both 2d blocks and 1d wires of ferromagnetic impurities embedded within a conventional superconductor .",
    "the most essential property of topologically nontrivial systems is the appearance of gapless edge states . in the case of quantum hall systems , these give rise to persistent currents along the edges , while for topological insulators they instead result in persistent spin - currents .",
    "likewise , topological superconductors have gapless edge states , and it is therefore of interest to investigate the persistent currents in these systems . in fact , we find that a study of these currents help us understand also the spin - polarization of majorana fermions at the end points of 1d wires .",
    "we thus need not only expressions for calculating currents , but the spin - polarized currents for any given spin - polarization axis .    to derive expressions for the currents ,",
    "we consider the time rate of change of the spin - density operator @xmath24 : @xmath25.\\end{aligned}\\ ] ] because we are interested in arbitrary spin directions , the operators have to be understood to be written in the basis of the particular spin direction of interest . if @xmath16 is in the direction @xmath26 in spherical coordinates , the operators are related to the operators in the basis of the hamiltonian according to @xmath27 now let @xmath28 denote the opposite spin direction to @xmath16 and define @xmath29 where @xmath30 , @xmath31 , and @xmath32 are coefficients to be determined later .",
    "it is then possible to show , as is done in appendix [ appendix : derivation_of_expressions_for_currents ] , that eq .",
    "can be written as @xmath33 where the sum runs over all bonds @xmath5 for which there is a term in the hamiltonian ( for eq .",
    "only nearest neighbor bonds ) .",
    "it is clear from eq .   that @xmath34 is an on - site source operator which converts @xmath28-spins into @xmath16-spins",
    "this operator is unrelated to currents and is thus of no further interest here .",
    "next , @xmath35 is a current operator for @xmath16-spins moving away from site @xmath3 along bond @xmath5 , and is from eq .   seen to be responsible for decreasing the number of @xmath16-spins on site @xmath3 . finally , also @xmath36 is responsible for transferring @xmath16-spins away from site @xmath3 along bond @xmath5 , but it flips the spin in the process .    while @xmath35 allows us to investigate spin - polarized currents ,",
    "the total current is obtained by adding all contributions to the current and we are therefore also interested in the operator @xmath37 . here",
    "the summation over @xmath38 ensures that we add both spin - polarized currents as well as spin - flipping currents , while the summation over @xmath16 ensures that we consider the outflow of both types of spins . to be able to represent the current as a vector field",
    ", we also construct the on - site current operator by adding the currents along the bonds away from site @xmath3 into the directed - average vector operator @xmath39 , and similarly for the spin - polarized and spin - flipping currents .    to fully construct the current operators we also need to evaluate the @xmath40-coefficients in eq .  .",
    "this is complicated by the fact that we are interested in spin - polarized currents for arbitrary spin - polarization axes .",
    "in addition , the final expressions for the currents are obtained by evaluating expectation values @xmath41 and @xmath42 , where the calculation also needs to be done in the particular basis .",
    "a detailed derivation of the method used to calculate currents is provided in appendix [ appendix : derivation_of_expressions_for_currents ] . in the following",
    "we present the current in two complementary ways .",
    "first of all , @xmath43 as a function of the magnetic moment allows us to identify the onset of persistent currents in the material .",
    "however , because the maximum is taken over the whole sample , it gives no information about where these currents appear .",
    "therefore , for selected parameters we also show the current vector field .      for 1d wires the topologically protected edge states manifest themselves in the form of majorana fermions . for this reason we are interested in calculating the ldos for a cut along the wire .",
    "as we want to relate the spin - polarization of these majorana fermions to the spin - polarization of the edge currents of 2d blocks , we are further interested in the spin - polarized ldos for a given spin - polarization axis .",
    "this is calculated using the expression    @xmath44\\left[\\begin{array}{cc }              \\cos^2(\\frac{\\theta}{2 } ) & \\cos(\\frac{\\theta}{2})\\sin(\\frac{\\theta}{2})e^{-i\\varphi}\\\\              \\cos(\\frac{\\theta}{2})\\sin(\\frac{\\theta}{2})e^{i\\varphi } & \\sin^2(\\frac{\\theta}{2 } )          \\end{array}\\right]\\left[\\begin{array}{c }              u_{\\nu\\mathbf{i}\\uparrow}\\\\              u_{\\nu\\mathbf{i}\\downarrow }          \\end{array}\\right]\\delta(e - e_{\\nu}).\\end{aligned}\\ ] ]    the total ldos is obtained by adding the spin - polarized ldos for two opposite spin - polarizations .",
    "the edge states of the 2d block also appear in the spectral function .",
    "due to the limited size of the simulated system it is important to single out the contribution to the spectral function coming from the edge states , otherwise bulk states pollute the edge spectrum .",
    "we do this by introducing a state classification function @xmath45 , which is one for every state classified as an edge state , and zero otherwise .",
    "we here define a state to be an edge state if more than @xmath46 of its probability amplitude is located inside a region , six sites wide and symmetrically positioned across the boundary . with this definition , the contribution to the spectral function coming from edge states can be calculated as @xmath47 where @xmath48 is the fourier transform of @xmath49 , and @xmath49 is the restriction of @xmath14 to the @xmath50-coordinate at which the bottom of the ferromagnetic block is located .",
    "for a homogeneous bulk it is possible to write the 2d model of eq .",
    "as@xcite @xmath51,\\end{aligned}\\ ] ] where @xmath52 - \\mu,\\\\      \\mathcal{l}_{0}(\\mathbf{k } ) = & \\alpha(\\sin(k_y ) , -\\sin(k_x ) , 0).\\end{aligned}\\ ] ] this hamiltonian have been topologically classified and the relevant condition for being in a topologically nontrivial phase is@xcite @xmath53 where the last equality follows because @xmath54 .",
    "moreover , making the restriction @xmath55 in eq .   and defining @xmath56 , we obtain @xmath57 which describes a 1d superconducting wire oriented along the @xmath58-direction , recently intensively studied in e.g.  refs .",
    "it can easily be confirmed that this model , just like the 2d case , goes through a topological phase transition at @xmath59 .",
    "this is one example of a dimensional reduction from two to one dimension , and similar relations play an important role in this work .",
    "note , however , that if the 1d wire is embedded in a 2d surface , this type of dimensional reduction makes little sense physically .",
    "first of all , setting @xmath55 corresponds to considering wave - functions that are completely delocalized in the @xmath50-direction .",
    "second , a 1d infinite wire is produced by setting @xmath60 , not by ignoring the @xmath50-direction .",
    "a proper dimensional reduction would rather involve integrating out the @xmath50-dependence to arrive at an equation of similar form as eq .  .",
    "this would potentially renormalize the parameters , and the condition for being in the nontrivial phase should then be understood in terms of these renormalized parameters .",
    "we explicitly point this out here , because , while we have the strict condition in eq .   to rely on for identifying the topological phase transition of a 2d geometry",
    ", we have no such condition for a 1d wire .",
    "instead , we have to rely on a range of consequences , such as the appearance of majorana fermions and other indicators related to the current , in order to identify the nontrivial phase of the wire .",
    "we begin our investigation with a quadratic ferromagnetic block , with the magnetic moments perpendicular to the surface ( @xmath61 ) . in fig .  [",
    "figure : d_jmax_block_perp ] the maximum value of the current density and the size of the order parameter at the center of the ferromagnetic block is plotted as a function of the zeeman term , which quantify the strength of the magnetic impurity moments . the condition for being in the topologically nontrivial phase , given in eq .  ,",
    "is fulfilled in the shaded regions .",
    "it is clear that the maximum current density is comparatively small in the trivial phase , raises up inside the topologically nontrivial phase , and then falls off as superconductivity is destroyed in the ferromagnetic block .     in the direction @xmath61 .",
    "absolute value of the zeeman term is indicated with dashed lines .",
    "shaded regions indicate the topologically nontrivial phase where @xmath62 .",
    "top : maximum current density as a function of the zeeman term . ]",
    "we also plot the spatial distribution of the persistent currents in figs .",
    "[ figure : j_73_block_perp]-[figure : j_111_block_perp ] for the three points marked 1 - 3 in fig .",
    "[ figure : d_jmax_block_perp ] . for small zeeman splitting",
    "the current flows anti - clockwise along the edge of the block , in agreement with a recent ginzburg - landau calculation for a circular disk geometry.@xcite next , in fig .",
    "[ figure : j_80_block_perp ] , the persistent current in the nontrivial phase is seen to not only be much larger , but it also flows in the opposite direction to that in the trivial phase .",
    "we also note that this current is located mainly inside the ferromagnetic region . below",
    "we show that these currents are related to the appearance of edge states , but surprisingly propagates in the direction opposite to what is expected from the edge state spectrum .",
    "however , before we move on to a more detailed study of the currents in the nontrivial phase , which is the main focus of this work , we also say a few words about the currents in the third region .",
    ", as indicated by grey arrows .",
    "the current density is proportional to the arrow length , with the longest arrow corresponding to a current density of @xmath63 .",
    "see also ( 1 ) in fig .",
    "[ figure : d_jmax_block_perp ] . ]    .",
    "see also ( 2 ) in fig .",
    "[ figure : d_jmax_block_perp ] . ]    .",
    "see also ( 3 ) in fig .",
    "[ figure : d_jmax_block_perp ] . ]",
    "we see that the maximum current density remains fairly large even after superconductivity is destroyed in the ferromagnetic block region , and these currents are also located around the edge of the block .",
    "strong edge currents therefore remain even after the superconducting gap has been destroyed , even though it is not possible to motivate their presence using topological arguments for the block region .",
    "a few spikes also appear in the maximum current density , and these are due to the formation of vortex - like currents inside the block region , as illustrated in fig .",
    "[ figure : j_111_block_perp ] .",
    "the exact occurrence of these peaks as a function of the magnetization is dependent on the size of the block and these current patterns result from the interplay of the zeeman term , rashba spin - orbit interaction , and boundary conditions .",
    "a complete study of the currents in this regime is beyond the scope of this work , and we here only mention these effects to clarify the properties of the non - zero current in the third region .      having covered the basic behavior of the currents , we now investigate in detail the current in the nontrivial phase and relate it to the topologically protected edge states . in fig .",
    "[ figure : spectral_function ] we plot the contribution to the spectral function from states classified as edge states for a cut along the lower edge of the ferromagnetic block .",
    "the left and the right figure corresponds to the nontrivial phase that occurs for negative and positive zeeman term , respectively .",
    "it is clear that the edge states have opposite dispersion , in agreement with the two phases having opposite chern numbers .",
    "we now note that the slope of the edge state in panel ( 2 ) of fig .",
    "[ figure : spectral_function ] implies that the edge state has a propagation direction to the right , since @xmath64 .",
    "however , this is in contradiction to the direction of the persistent current plotted in fig .",
    "[ figure : j_80_block_perp ] , which flows to the left along the lower edge .",
    "the apparent contradiction is resolved once the contribution to the current from the edge states is singled out . in fig .",
    "[ figure : j_edge_contribution ] we plot the contribution to the current from eigenstates with energy in the narrow interval @xmath65 around the fermi level , and the current is seen to flow in opposite direction to the total current in fig .",
    "[ figure : j_80_block_perp ] .",
    "the somewhat unexpected conclusion is therefore that the persistent currents flows in opposite direction to the current carried by the topologically protected gap - crossing edge states .",
    "this have important experimental consequences as the measured current direction will depend on the physical probe used .",
    "if for example a squid is used to measure the magnetic field generated by the total persistent current , the current will be found to flow in opposite direction compared to the dispersion of the edge states . on the other hand ,",
    "any transport measurement relying on excitations close to the fermi level will find a propagation direction in agreement with the edge state dispersion .",
    "the reason for the reversed flow of the persistent currents compared to the edge state currents can be understood by considering why an ordinary bulk is free from persistent currents .",
    "this is not due to zero contribution to the current from individual charge carriers , but rather because the sum of all such contributions cancel each other out .",
    "the total current carried by the system is obtained by integrating the product of the occupied charge carriers charge and velocity : @xmath66 . here",
    "the first step follows because the charge of each quasiparticle state is the same , while the second step follows because the spectrum is continuous and periodic in @xmath67 .",
    "neither of these assumptions are true at the edge of a topological superconductor .",
    "first of all , a branch in the spectral function which crosses the fermi level an odd number of times can not be described by a simultaneously continuous and periodic spectrum .",
    "second , the quasiparticles in a superconductor are mixtures of electrons and holes and do not all carry the same charge . considering the persistent current carried by the edge states , we now note that only half of the branch corresponds to occupied states .",
    "further , the occupied edge states are strong mixtures of electrons and holes because they are close to the fermi level . the total current carried by this band",
    "is therefore much smaller than what would be expected if the band corresponded to a fully occupied electron band .",
    "it is this lack of occupied electron states associated with the gap - crossing band which fails to cancel the counter - propagating currents coming from the low energy states .",
    "this phenomenon of total currents adding up from contributions of quasiparticle currents of states `` inside the gap '' and deep states that contribute to overall condensate flow is known in unconventional superconductors and superfluids.@xcite    .",
    "only contributions from states classified as edge states are included",
    ". edge state on the left and right corresponds to the topologically nontrivial phases at negative and positive zeeman term , respectively , see ( 2 ) and ( 2 ) in fig .",
    "[ figure : d_jmax_block_perp ] .",
    "the opposite dispersions reflect the opposite signs of the chern number in the two phases . ]    , but when only contributions from eigenstates with energy in the interval @xmath65 have been included . ]",
    "next we study the spin - polarization of the currents .",
    "in particular , the @xmath58 and @xmath50 spin - polarization axes are of interest because the rashba spin - orbit interaction couples these axes differently to the momentum . in fig .",
    "[ figure : j_spin_polarized ] we plot the total spin - polarized current as well as that carried by eigenstates in the energy interval @xmath65 for spins polarized along the @xmath58-axis . the spin - polarized currents for @xmath50-up , @xmath58-down , and @xmath50-down spins are identical to these under a spatial rotation of @xmath68 , @xmath69 , and @xmath70 , respectively .",
    "it is clear from fig .",
    "[ figure : j_spin_polarized](a ) that strong spin - polarized currents flow through the block , but the total current in the bulk cancels , since the spins polarized along the negative @xmath58-axis flow in opposite direction .",
    "however , in the edge regions the two currents flow in the same direction and , together with the spin - flipping currents , these gives rise to the total edge currents in fig .",
    "[ figure : j_80_block_perp ] .",
    "we also note the partial depletion of @xmath58-up spin currents towards the right end of the block in fig .  [",
    "figure : j_spin_polarized](a ) .",
    "the picture is radically different in fig .",
    "[ figure : j_spin_polarized](b ) , where only contributions to the currents from states close to the fermi level are included . here",
    ", the @xmath58-up spins are located on the right side , and with a similar argument to that in sec .",
    "[ subsubsection : reversed_persistent_current ] , we can understand the depletion of the total @xmath58-up spin current in fig .",
    "[ figure : j_spin_polarized](a ) as a partial , but incomplete , cancellation by the states close to the fermi level .",
    "it is clear from both the total current in the bulk region and the edge currents in fig .",
    "[ figure : j_spin_polarized](b ) that @xmath58-up spins favor motion along the positive @xmath50-axis .",
    "this can be understood as a consequence of the presence of rashba spin - orbit interaction . the rashba spin - orbit interaction couples momentum and spin through @xmath71 , which leads to spin - momentum locking for the currents.@xcite this spin - momentum locking and localization of different spins on different edges are , as we will discuss next , also important for understanding 1d wire systems .",
    "we now move on to an investigation of a 1d wire with the magnetic moments still perpendicular to the surface , which corresponds to the 1d model in eq .  .",
    "as explained in sec .",
    "[ section : dimensional_reduction ] , we no longer have a simple condition , such as eq .",
    ", to rely on to identify the topological phase transition , because the system is embedded in a 2d surface rather than being truly 1d . however , we find that this present little problem since we have several other means to identify the nontrivial phase .      in fig .",
    "[ figure : d_jmax_w2_perp ] we plot the maximum current density and the value of the order parameter at the midpoint of a wire .",
    "first of all , we note that compared to fig .",
    "[ figure : d_jmax_block_perp ] the horizontal axis has been rescaled and , compared to the block , a roughly twice as strong magnetization is required to suppress superconductivity on the wires sites . a similar calculation for a point impurity",
    "reveals that the magnetization has to be about four times as large as as that of the block geometry in order to destroy superconductivity .",
    "this can be understood from the fact that each edge site in a block is connected to a single nonmagnetic superconducting site , while each site in the wire and for the single impurity is connected to two and four such superconducting sites , respectively .    , but for a 1d wire along the @xmath58-axis and magnetic moments along the direction @xmath61 .",
    "the topologically nontrivial phase is identified using the discontinuous onset of strong edge currents as well as the appearance of majorana fermions . ]",
    "next , we note that the partial collapse of the order parameter in itself does not imply a topological phase transition , even though we numerically always see these occurring at the same time .",
    "there are , however , good reasons for why these can be expected to occur at the same time .",
    "first of all , the topological phase transition occurs when @xmath72 and @xmath22 are related according to an expression similar to eq .",
    ", even though we can no longer rely on the last equality sign or the exact values of @xmath8 and @xmath9 .",
    "the inequality is clearly valid when making the zeeman term large enough , but also if the order parameter is small enough .",
    "a sudden drop in the order parameter will therefore likely induce the topological phase transition .",
    "thus , assuming no a priori knowledge of the value of @xmath72 at which the transition occurs , the likelihood of the transition to occur is proportional to the size of the drop in the order parameter .",
    "an even stronger argument for why the two phenomena should occur in tandem can be made if we instead consider the drop in the order parameter to be induced by the topological phase transition .",
    "this relies on the fact that a topological phase transition is fundamentally related to the interchange of energy levels across the fermi level , also known as a band inversion .",
    "because the order parameter is calculated using eigenstates below the fermi level , the value of the order parameter can be expected to experience discontinuous changes each time a pair of eigenstates are interchanged across the fermi level . moreover , because the size of the order parameter in turn affects the eigenstates , this has enhancing feedback effects , which are only captured in fully self - consistent calculations such as those performed here .",
    "discontinuous changes in the order parameter and the topological phase transition are therefore intimately tied to each other .",
    "we note that this is closely related to the physics of single magnetic impurities .",
    "the associated yu - shiba - rusinov states , which in non - self - consistent calculations cross the fermi level continuously , cross discontinuously in self - consistent models because of the feedback effect of the occupation numbers of these states on the order parameter.@xcite      so far we have discussed the relation between the collapse of the gap and the topological phase transition , arguing that there are strong reasons to expect them to occur at the same time . we have also mentioned that they always occur at the same time in our calculations , but so far not said what signatures we have used to identify the topological phase transition .",
    "the first signature is the strong peak in the maximum current density in fig .",
    "[ figure : d_jmax_w2_perp ] . just like for the square block ,",
    "the onset of the peak is also associated with a reversal of the direction of the persistent current , as can be seen in fig .",
    "[ figure : j_w2_perp ] .",
    "most important though , this is also the point where majorana fermions appear at the end points of the wire , as shown in fig .",
    "[ figure : ldos ] .",
    "the majorana fermion nature of these zero - energy states have been confirmed by checking that they appear as locally non - degenerate bogoliubov - de gennes quasiparticles .    .",
    "left : trivial phase .",
    "right : nontrivial phase .",
    "see also ( 4 ) and ( 5 ) in fig .",
    "[ figure : d_jmax_w2_perp ] . ]    ) . both total and spin - polarized ldos are shown , using the @xmath58-axis as spin - polarization axis .",
    "the extent of the wire is indicated at the bottom .",
    "one majorana fermion is clearly seen at each end of the wire . ]",
    "an interesting feature of the majorana fermions seen in fig .",
    "[ figure : ldos ] are their spin - polarizations .",
    "the majorana fermions at the right and left end of the wire are polarized along the @xmath58-up and @xmath58-down direction , respectively . that majorana fermions have spin - polarization has already been predicted,@xcite but we are here able to understand it in relation to the spin - polarized currents around a 2d ferromagnetic block . in fig",
    "[ figure : j_spin_polarized](b ) it was shown that the contribution to the @xmath58-up polarized current coming from states close to the fermi level is located on the right edge .",
    "this is in complete agreement with the @xmath58-up polarized majorana fermion localized on the right end of the wire .",
    "this demonstrates the intimate connection between the topologically protected edge states of a 2d and 1d system .",
    "the connection between edge states and majorana fermions can be made even clearer by considering the edge states plotted in fig .",
    "[ figure : spectral_function ] . for simplicity of argument",
    ", we first consider an infinite ferromagnetic strip rather than a square block and let the infinite dimension be along the @xmath50-direction . on each of the two edges one",
    "spectral branch cuts the fermi level , one of which is schematically depicted in the leftmost picture of fig .",
    "[ figure : edge_states_dimensional_reduction ] .",
    "next , consider the @xmath50-dimension wrapped around a cylinder , such that it is still translationally invariant but with finite length .",
    "this results in a discretization of the spectral function as shown in the middle picture of fig .",
    "[ figure : edge_states_dimensional_reduction ] . by finally making the cylinder small enough such that the @xmath50-direction consists of a single site , a 1d wire with a single majorana fermion at each edge results , as depicted to the right in fig .",
    "[ figure : edge_states_dimensional_reduction ] .",
    "this procedure closely resembles the dimensional reduction performed in sec .",
    "[ section : dimensional_reduction ] , and explicitly shows the close relation between majorana fermions in 1d and edge states in 2d .",
    "however , this dimensional reduction does not , just like that performed in sec .",
    "[ section : dimensional_reduction ] , correspond to the actual physical situation .",
    "this is important to recognize because it might otherwise give the false impression that it is enough to discretize the edge spectrum to obtain a localized majorana fermion .",
    "after all , the state at @xmath73 in the middle panel of fig .",
    "[ figure : edge_states_dimensional_reduction ] is also a majorana fermion .",
    "-axis , the majorana fermion at its end point can be understood as the single state that remains when the length of the @xmath50-edge becomes a single site . ]",
    "the reason why the relation between the 2d block and the 1d wire is slightly more complicated is that the two @xmath58-edges , which can be treated completely independent for the infinite strip , is joined by two @xmath50-edges .",
    "the spectral branches of the different edges therefore join into one single branch with eigenstates delocalized over the whole boundary . in particular , the majorana fermions that otherwise would have existed at the right and left edge overlap and hybridize .",
    "it is only once the @xmath50-dimension becomes small enough , such that the two @xmath50-edges start hybridizing and thereby gaps out the spectrum along these edges , that the two @xmath58-edges becomes independent of each other .",
    "it is therefore clear why it is not enough to have a discrete spectrum , such as for a block with finite edge length , to obtain localized majorana fermions , and why a ( quasi-)1d wire is required in spite of the close connection between the two systems .",
    "having investigated magnetic moments perpendicular to the surface , we now turn to a ferromagnetic block with the magnetic moments pointing along the @xmath58-direction ( @xmath74 ) .",
    "this system does not have a topologically nontrivial phase , but is of interest because of its relation to the corresponding 1d wires . in fig .",
    "[ figure : d_jmax_block_para ] we plot the order parameter and maximum current density .",
    "interestingly , a strong peak is observed also in this case , even though there is no topological phase transition .",
    "however , the build up of the peak is not discontinuous as in the previous cases . instead , the maximum current density is sizable already before superconductivity starts to collapse in the ferromagnetic block .",
    "in fact , it is not only the maximum current density that is large , but also the total persistent current .",
    "this is clear from fig .",
    "[ figure : j_73_block_para ] , where it is seen that the current flows through the whole sample , rather than being limited to the boundary of the ferromagnetic block .",
    "a similar behavior is predicted using a ginzburg - landau model in appendix [ appendix : ginzburg_landau ] .",
    "the current flowing through the bulk region of the ferromagnetic block can be understood as a consequence of @xmath58-up and @xmath58-down spins moving in opposite direction because of spin - orbit interaction , similar to what was seen in fig .",
    "[ figure : j_spin_polarized ] .",
    "the addition of a zeeman term in the @xmath58-direction creates an imbalance between the two spin - species and thereby also a total current through the sample .",
    "the current continues to increase until the ferromagnetic region enters the normal state .",
    "the peak in the total current density is therefore not due to a sudden onset of new physics , but rather because the continuous build up of current comes to an end as superconductivity is destroyed .",
    "we also note that the region following the partial collapse of the order parameter and up is complicated by the presence of vortex like currents inside the ferromagnetic bulk region .",
    "see for example fig .",
    "[ figure : j_77_block_para ] . for strong enough zeeman term",
    "the currents becomes localized on the left and right edges , similarly to what is predicted using a ginzburg - landau model in appendix [ appendix : ginzburg_landau ] .    , but for magnetic moments along the direction @xmath74 . ]    .",
    "see also ( 6 ) in fig .",
    "[ figure : d_jmax_block_para ] . ]    .",
    "vortex - like solutions continue to appear in the ferromagnetic region also for somewhat larger zeeman terms , until the current eventually becomes localized on the left and right edges . ]",
    "we now consider a wire with the magnetic moments along the wire .",
    "this is the dimensional reduction of the block in the previous section , where the width of the block has been set to one along the @xmath50-direction .",
    "this system can , just like the wire in sec .",
    "[ subsection : wire_with_zeeman_term_perpendicular_to_surface ] , be described by a hamiltonian of the form in eq .  , if the substitution @xmath75 is made .",
    "this substitution presents no problem because the two pauli matrices in eq .",
    "remain orthogonal , and the topological properties therefore remain the same .",
    "it is in fact appropriate to think of the substitution as a rotation of spin indices around the @xmath50-axis ; @xmath76 . in fig .",
    "[ figure : ldos_w2_para ] we plot the ldos and spin - polarized ldos using the @xmath77-axis as spin - polarization axis .",
    "it is clear that the majorana fermions spin - polarization that previously showed up in the @xmath58-component is now present in the @xmath77-component .",
    "moreover , direct comparison to fig .",
    "[ figure : ldos ] reveals that the @xmath58-up component goes into the @xmath77-down components and vice versa , exactly as implied by the rotation of spin - indices .    , but for ferromganetic wire magnetized along the wire ( @xmath74 and wire along @xmath78 ) .",
    "note that the majorana fermions are spin - polarized along the @xmath77-axis rather than the @xmath58-axis . ]    finally , the maximum current density and the value of the order parameter at the wires midpoint are shown in fig .",
    "[ figure : d_jmax_w2_para ] . the strong discontinuity in the maximum current density",
    "is correlated with the appearance of majorana fermions .",
    "we also mention that the current pattern for the wire closely resembles that for the ferromagnetic block in fig .",
    "[ figure : j_73_block_para ] .",
    "the current flows through the wire perpendicular to the direction of the wire , and the two patterns are so similar that we refrain from showing it in a figure of its own .    ,",
    "but for a ferromagnetic wire magnetized along the wire ( @xmath74 and wire along @xmath78 ) .",
    "the topologically nontrivial region has been identified using the discontinuous onset of strong edge currents , as well as the appearance of majorana fermions . ]",
    "the final setup we consider is a wire with in plane magnetic moments perpendicular to the wire .",
    "similarly as above , this system can be obtained by making the width of the ferromagnetic block in sec .",
    "[ subsection : block_with_zeeman_term_parallel_to_surface ] equal to one in the @xmath58-direction .",
    "however , because the dimension is reduced in a different direction , the substitution of pauli matrices needed to obtain an effective equation of the form in eq .",
    "[ equation : bulk_hamiltonian_1d ] is different .",
    "this time the substitution @xmath79 is required , and the two pauli matrices for the spin - orbit and zeeman term become the same .",
    "the consequence is that the system has no topologically nontrivial phase , and no majorana fermions appear .",
    "the maximum current density and order parameter at the midpoint of the wire is presented in fig .",
    "[ figure : d_jmax_w1_para ] .    , but for wire with in - plane magnetization perpendicular to wire ( @xmath74 and wire along @xmath80 ) . ]",
    "we have studied ferromagnetic impurities on top of a conventional @xmath0-wave superconductor with rashba spin - orbit interaction .",
    "we find a close relation between the topological properties of 2d blocks and 1d wires of the ferromagnetic impurities , as well as the physics of yu - shiba - rusinov states of 0d point impurities.@xcite    when the magnetic moments are directed perpendicular to the surface , both the 2d block and 1d wire has topologically nontrivial phases . for a 2d block the nontrivial phase gives rise to spin - polarized edge currents .",
    "interestingly , the total persistent current flows in opposite direction to the current contribution from the topologically protected gap - crossing edge states .",
    "this means that different experimental probes will observe different current directions , depending on if they measure the total persistent current or only that carried by low - energy excitations .",
    "the majorana fermions that appear at the end points of 1d wires are spin - polarized , and their spin - polarization direction are directly related to the spin - polarized edge currents of the 2d block .",
    "the spin - polarization of the majorana fermions is along the direction of the wire .",
    "when the magnetic moments are parallel to the surface the ferromagnetic block does not have a topologically nontrivial phase .",
    "however , 1d wires can still have a topologically nontrivial phase , depending on if the wire is aligned with the magnetic moments or not .",
    "when the wire is parallel with the magnetic moments , a topologically nontrivial phase exist and the corresponding majorana fermions are spin - polarized along the @xmath77-axis . for both the ferromagnetic block and the two wire directions , a substantial amount of current flows through the bulk , as long as superconductivity is present in the ferromagnetic region .",
    "we thank g.  volovik , m.  eschrig , y.  kedem , c.  triola , and t.  ojanen for useful discussions .",
    "this work was supported by the swedish research council ( vetenskapsrdet ) , the gran gustafsson foundation , and the swedish foundation for strategic research ( ssf ) ( k.b . and a.b .- s . ) and the european research council ( erc ) dm-321031 and the us doe bes e304 ( s.s.p . and",
    ".    38 a. kitaev , phys .",
    "usp . * 44 * , 131 ( 2001 ) . c. l. kane and e. j. mele , phys .",
    "rev . lett . *",
    "95 * , 226801 ( 2005 ) .",
    "b. a. bernevig and s .- c .",
    "zhang , phys .",
    "96 * , 106802 ( 2006 ) .",
    "b. a. bernevig , t. l. hughes , and s .- c .",
    "zhang , science * 314 * , 1757 ( 2006 ) .",
    "m. knig , s. wiedmann , c. brne , a. roth , h. buhmann , l. molenkamp , x. l. qi , and s .- c .",
    "zhang , science * 318 * , 766 ( 2007 ) .",
    "d. hsieh , d. qian , l. wray , y. xia , y. s. hor , r. j. cava , and m. z. hasan , nature * 452 * , 970 ( 2008 ) .",
    "y. xia , d. qian , d. hsieh , l. wray , a. pal , h. lin , a. bansil , d. grauer , y. s. hor , r. j. cava , and m. z. hasan , nat .",
    "* 5 * , 398 ( 2009 ) .",
    "h. zhang , c .- x .",
    "qi , x. dai , z. fang , and s .- c .",
    "zhang , nat . phys . * 5 * , 438 ( 2009 ) .",
    "y. l. chen , j. g. analytis , j .- h .",
    "chu , z. k. liu , s .- k .",
    "mo , x. l. qi , h. j. zhang , d. h. lu , x. dai , z. fang , s .- c .",
    "zhang , i. r. fisher , z. hussain , and z .- x .",
    "shen , science * 325 * , 178 ( 2009 ) .",
    "m. z. hasan and c. l. kane , rev .",
    "phys . * 82 * , 3045 ( 2010 ) .",
    "x. l. qi and s .- c .",
    "zhang , rev .",
    "phys . * 83 * , 1057 ( 2011 ) .",
    "l. fu and c. l. kane , phys .",
    "100 * , 096407 ( 2008 ) .",
    "m. sato , y. takahashi , and s. fujimoto , phys .",
    "lett . * 103 * , 020401 ( 2009 ) .",
    "m. sato , y. takahashi , and s. fujimoto , phys .",
    "b * 82 * , 134521 ( 2010 ) .",
    "j. d. sau , r. m. lutchyn , s. tewari , and s. das sarma , phys .",
    "lett . * 104 * , 040502 ( 2010 ) .",
    "j. alicea , phys .",
    "b * 81 * , 125318 ( 2010 ) .",
    "r. m. lutchyn , j. d. sau , and s. das sarma , phys .",
    "* 105 * , 077001 ( 2010 ) .",
    "y. oreg , g. refael , and f. von oppen , phys .",
    "lett . * 105 * , 177002 ( 2010 ) .",
    "s. nadj - perge , i. k. drozdov , j. li , h. chen , s. jeon , j. seo , a. h. macdonald , b. a. bernevig , and a. yazdani , science * 346 * , 602 ( 2014 ) .",
    "r. pawlak , m. kisiel , j. klinovaja , t. meier , s. kawai , t. glatzel , d. loss , and e. meyer , arxiv:1505.06078 ( 2015 ) . m. ruby , f. pientka , y. peng , f. von oppen , b. w. heinrich , and k. j. franke , arxiv:1507.03104 ( 2015 ) . j. rntynen and t. ojanen , phys .",
    ". lett . * 114 * , 236803 ( 2015 ) .",
    "jian li , titus neupert , zhi jun wang , a. h. macdonald , a. yazdani , and b. andrei bernevig , arxiv:1501.00999 ( 2015 ) .",
    "v. mourik , k. zuo , s. m. frolov , s. r. plissard , e. p. a. m. bakkers , and l. p. kouwenhoven , science * 336 * , 1003 ( 2012 ) .",
    "l. p. rokhinson , x. liu , and j. k. furdyna , nat . phys . * 8 * , 795 ( 2012 ) .",
    "a. das , y. ronen , y. most , y. oreg , m. heiblum , and h. shtrikman , nat .",
    "* 8 * , 887 ( 2012 ) .",
    "s. s. pershoguba , k. bjrnson , a. m. black - schaffer , a. v. balatsky , arxiv:1505.01672 ( 2015 ) . j. a. sauls , phys .",
    "b * 84 * , 214509 ( 2011 ) .",
    "h. wu and j. sauls , phys .",
    "b * 88 * , 184506 ( 2013 ) .",
    "k. bjrnson , a. m. black - schaffer , phys .",
    "b * 88 * , 024501 ( 2013 ) .",
    "k. bjrnson , a. m. black - schaffer , phys .",
    "b * 89 * , 134518 ( 2014 ) .",
    "a. v. balatsky , i. vekhter , and j .- x .",
    "zhu , rev .",
    "* 78 * , 373 ( 2006 ) .",
    "d. sticlet , c. bena , and p. simon , phys .",
    "rev . lett . * 108 * , 096802 ( 2012 ) .",
    "\\(a )   ( b )   ( c )   + ( d )   ( e )   ( f )     to complement the self - consistent calculations on a lattice , we here also provide the results of a ginzburg - landau ( gl ) treatment .",
    "the gl method gives an approximate description of the system , but is unable to capture microscopic details such as spin - polarization , edge states , density of states etc .. nevertheless , it may be interesting to compare the gl results with the exact numerical diagonalization discussed throughout the paper .",
    "we consider the following dimensionless gl free energy functional @xmath81 ,   \\nonumber\\end{aligned}\\ ] ] here , @xmath82 describes the superconducting order parameter in a 2d box , i.e. @xmath83 and @xmath84 , where @xmath85 . the magnetic block of size @xmath86 is placed in the center with the magnetization along the @xmath58 axis , i.e. @xmath87 for @xmath88 .",
    "the ferromagnetic vector @xmath89 is analogous to the zeeman term @xmath22 used throughout the main text . the first term in eq .",
    "( [ gl ] ) is conventional and favors the superconducting order at @xmath90 , whereas the second term describes the diamagnetic pauli energy disfavoring superconducting order .",
    "the superconducting order is destroyed when the pauli energy exceeds the the superconducting condensation energy ( the so - called chandrasekhar - clogston limit ) , which occurs for @xmath91 in eq .",
    "( [ gl ] ) . in order",
    "to smoothly interpolate the pauli term between the superconducting and metallic phases we introduced a sigmoid function @xmath92 note that @xmath93 ( @xmath94 ) in the absence ( presence ) of the superconductivity , i.e. if @xmath95 ( @xmath96 ) . to avoid possible spurious numerical effects",
    ", we also add a boundary term with a large coefficient @xmath97 , which destroys superconductivity at the boundary of the 2d box .",
    "the terms on the second line of eq .",
    "( [ gl ] ) describe the kinetic energy .",
    "the term proportional to @xmath98 describes the conventional superfluid kinetic energy , which defines the characteristic coherence length @xmath99 .",
    "the last term , proportional to @xmath100 , describes the magnetoelectric coupling@xcite between the current and magnetization @xmath89 .",
    "we search for the minimum of the free energy  ( [ gl ] ) numerically .",
    "we employ the gradient descent method in which the order parameter evolves in imaginary time @xmath101 as @xmath102 using eq .",
    "( [ graddescent ] ) , the order parameter is updated iteratively as @xmath103}{\\delta \\psi}$ ] .",
    "the time evolution stops for the solution @xmath82 satisfying @xmath104}{\\delta \\psi}=0 $ ] , which , thus , minimizes the free energy .    in fig .",
    "[ figure : gl ] we plot the order parameter magnitude @xmath105 , phase arg@xmath106 , and the current @xmath107 the panels in the top ( bottom ) row correspond to the field @xmath108 ( @xmath109 ) , which is below ( above ) the pauli limit @xmath110 . for the smaller field ( top row ) , the superconducting order @xmath105 is uniform , whereas the superconducting phase is non - uniform and is distributed in such a way that the total current is continuous .",
    "in contrast , for the large field ( bottom row ) , the superconducting order is destroyed in the region covered with the ferromagnetic block .",
    "the superconducting phase is strongly uniform outside the ferromagnetic block .",
    "the current is suppressed everywhere , except in small vicinity of the ferromagnetic block .",
    "in general , the gl modeling agrees qualitatively with those discussed in section  [ subsection : block_with_zeeman_term_parallel_to_surface ] : the current grows linearly with the magnetic field until superconductivity is destroyed . at the same time , we are not able to capture the non - linear peak of the current shown in fig .  [ figure : d_jmax_block_para ] as well as the appearance of the vortex structure in fig .  [",
    "figure : j_77_block_para ] .",
    "here we derive the general expressions for calculating the currents in an arbitrary spin - basis .",
    "the implementation of the numerical calculations are based on the algorithm described in sec .",
    "[ section : summary_of_method ] .",
    "the method itself is fairly straightforward .",
    "however , the derivation is complicated by the fact that the spin - polarized currents are not necessarily calculated in the same basis as the hamiltonian",
    ". a short summary of the appendix follows : + _ [ section : notation ] : notation _ + introduction of useful notation and derivations of important identities .",
    "+ _ [ section : generalized_current_operators ] : generalized current operators _ + the main problem is formulated .",
    "general sink - source and current operators are defined . in summary",
    ", there are three important terms for any given spin : the sink - source term @xmath111 , the current @xmath112 on bond @xmath113 , and the spin - flipping current @xmath114 on @xmath113 , which together satisfies @xmath115 to derive these operators , we need to find a certain set of coefficients @xmath116",
    ". + _ [ section : arbitrary basis ] : arbitrary basis _",
    "general expressions are derived for how to calculate the @xmath116 coefficients in an arbitrary basis from the knowledge of those same coefficients in the basis of the hamiltonian .",
    "+ _ [ section : calculate_current ] : calculate sink - sources and currents _ + expressions for the expectation values of the sink - source and current operators are derived .",
    "+ _ [ section : summary_of_method ] : summary of method _ + an algorithmic summary of the method is provided .",
    "+ _ [ section : tabulating_relevant_as ] : tabulating relevant @xmath40 s _ + the exact number of @xmath116 that needs to be evaluated in the basis of the hamiltonian are determined , and a useful way of tabulating them is introduced .",
    "+ _ [ section : evaluating_tables ] : evaluating tables _ +",
    "tables are evaluated for the following types of terms in the hamiltonian : chemical potential , kinetic , zeeman , and rashba spin - orbit interaction .",
    "the total table for a hamiltonian containing all these terms is also provided .",
    "+ _ [ section : note_on_superconductivity ] : note on superconductivity _ + it is shown that the introduction of an @xmath0-wave superconducting term in the hamiltonian does not modify the method described in the rest of this appendix . +      here we introduce useful notation and show relations which will be important later on .",
    "this section is purely algebraic , and no physical motivation will be provided .",
    "the usefulness of the expressions will only become clear once general currents are treated in section [ section : generalized_current_operators ] .",
    "consider a general quadratic hamiltonian @xmath117 where @xmath118 here @xmath119 are site indices , @xmath120 are spin indices , and @xmath10 is an index distinguishing between different terms in the hamitlonian such as kinetic , chemical potential , zeeman , etc ..      @xmath121 = & \\frac{i}{\\hbar}\\sum_{ij}f_{i\\lambda j\\lambda'}^{\\alpha}\\left(\\delta_{js}\\delta_{\\lambda'\\kappa}c_{i\\lambda}^{\\dagger }      c_{s\\kappa ' } - \\delta_{is}\\delta_{\\lambda\\kappa'}c_{s\\kappa}^{\\dagger}c_{j\\lambda'}\\right)\\nonumber\\\\      = & \\frac{i}{\\hbar}\\sum_{b}\\left(f_{s+b,\\lambda , s\\lambda'}^{\\alpha}\\delta_{\\lambda'\\kappa}c_{s+b,\\lambda}^{\\dagger}c_{s\\kappa ' } - f_{s\\lambda , s+b,\\lambda'}^{\\alpha}\\delta_{\\lambda\\kappa'}c_{s\\kappa}^{\\dagger}c_{s+b,\\lambda'}\\right ) .",
    "%    \\equiv & \\frac{i}{\\hbar}\\sum_{b}\\left[h_{\\lambda\\lambda'}^{\\alpha } , c_{s\\kappa}^{\\dagger}c_{s\\kappa'}\\right]_{b},\\end{aligned}\\ ] ]    the summation in the last expression is said to run over all bonds @xmath113 connected to site @xmath0 , where a bond between site @xmath0 and @xmath122 is said to exist if the hamiltonian contains a product of creation and annihilation operators with these two indices .",
    "in particular , the set of bonds has to be understood to include the bond between a site and itself if any on - site terms are included in the hamiltonian . using eq .",
    ", it is possible to decompose the commutator for the complete hamiltonian as    @xmath123 = & \\frac{i}{\\hbar}\\sum_{\\alpha\\lambda\\lambda'}\\left[h_{\\lambda\\lambda'}^{\\alpha } , c_{s\\kappa}^{\\dagger}c_{s\\kappa'}\\right]\\nonumber\\\\          = & \\frac{i}{\\hbar}\\sum_{b\\lambda}\\left(\\left(\\sum_{\\alpha}f_{s+b,\\lambda , s\\kappa}^{\\alpha}\\right )          c_{s+b,\\lambda}^{\\dagger}c_{s\\kappa ' } - \\left(\\sum_{\\alpha}f_{s\\kappa',s+b,\\lambda}^{\\alpha}\\right )          c_{s\\kappa}^{\\dagger}c_{s+b,\\lambda}\\right).\\end{aligned}\\ ] ]      @xmath125          = & \\sum_{b\\lambda\\lambda'\\eta\\eta'}\\left(a_{s+b,\\eta , s,\\eta'}^{\\lambda\\lambda'\\kappa\\kappa'}c_{s+b,\\eta}^{\\dagger}c_{s\\eta ' } - b_{s,\\eta , s+b,\\eta'}^{\\lambda\\lambda'\\kappa\\kappa'}c_{s\\eta}^{\\dagger}c_{s+b,\\eta'}\\right)\\nonumber\\\\          = & \\sum_{b\\lambda}\\left(a_{s+b,\\lambda , s,\\kappa'}^{\\lambda\\kappa\\kappa\\kappa'}c_{s+b,\\lambda}^{\\dagger}c_{s\\kappa ' } - b_{s,\\kappa , s+b,\\lambda}^{\\kappa'\\lambda\\kappa\\kappa'}c_{s\\kappa}^{\\dagger}c_{s+b,\\lambda}\\right).\\end{aligned}\\ ] ]      the hamiltonian is hermitian if @xmath126 , which using eq .",
    "implies @xmath127 identification of coefficients leads to the conclusion that @xmath128 , and using eq .",
    "we have @xmath129 it is therefore possible to rewrite eq .   as    @xmath130 = & \\sum_{b\\lambda\\lambda'\\eta\\eta'}\\left(a_{s+b,\\eta , s,\\eta'}^{\\lambda\\lambda'\\kappa\\kappa'}c_{s+b,\\eta}^{\\dagger}c_{s\\eta ' } + a_{s+b,\\eta',s,\\eta}^{\\lambda'\\lambda\\kappa'\\kappa*}c_{s\\eta}^{\\dagger}c_{s+b,\\eta'}\\right)\\nonumber\\\\          = & \\sum_{b\\lambda}\\left(a_{s+b,\\lambda , s,\\kappa'}^{\\lambda\\kappa\\kappa\\kappa'}c_{s+b,\\lambda}^{\\dagger}c_{s\\kappa ' } + a_{s+b,\\lambda , s,\\kappa}^{\\lambda\\kappa'\\kappa'\\kappa*}c_{s\\kappa}^{\\dagger}c_{s+b,\\lambda}\\right),\\end{aligned}\\ ] ]    which eliminates the need to calculate @xmath113 coefficients independently .",
    "we also note from eq .   that @xmath131 , which together with eq .   gives @xmath132 using @xmath133 and @xmath134 to denote the spins which are opposite to @xmath135 and @xmath136 , respectively , we also find from eq .   that @xmath137      in eq .",
    "explicit expressions for how to calculate @xmath138 were provided .",
    "it will also be useful to have a way of extracting coefficients from a general quadratic expression , also when the explicit expression for these coefficients are not known .",
    "to this end we consider a general quadratic expression @xmath139 where @xmath9 and @xmath17 are some arbitrary set of indices .",
    "it is clear that @xmath140 applying this to eq .",
    "we can for @xmath141 write @xmath142c_{s\\eta'}^{\\dagger}|0\\rangle = & \\sum_{\\lambda\\lambda'}a_{s+b,\\eta , s,\\eta'}^{\\lambda\\lambda'\\kappa\\kappa ' } = a_{s+b,\\eta , s,\\eta'}^{\\eta\\kappa\\kappa\\kappa'},\\end{aligned}\\ ] ] while for @xmath143 we have @xmath144c_{s\\eta'}^{\\dagger}|0\\rangle = & a_{s,\\eta , s,\\eta'}^{\\eta\\kappa\\kappa\\kappa ' } + a_{s,\\eta',s,\\eta}^{\\eta'\\kappa'\\kappa'\\kappa*},\\end{aligned}\\ ] ] which can also be written as    @xmath145c_{s\\eta'}^{\\dagger}|0\\rangle = & %    a_{s,\\eta , s,\\eta'}^{\\eta\\kappa\\kappa\\kappa ' } - a_{s,\\eta',s,\\eta}^{\\eta'\\kappa'\\kappa'\\kappa * }      \\left\\{\\begin{array}{ccc }          0                                                &    \\textrm{if } & \\eta \\neq \\kappa\\textrm{\\;and\\ ; } \\eta ' \\neq \\kappa',\\\\          a_{s\\eta s\\eta'}^{\\eta\\kappa\\kappa\\kappa ' }       &    \\textrm{if } & \\eta \\neq \\kappa \\textrm{\\;and\\ ; } \\eta ' = \\kappa',\\\\          a_{s\\eta's\\eta}^{\\eta'\\kappa'\\kappa'\\kappa * }     &    \\textrm{if } & \\eta = \\kappa \\textrm{\\;and\\;}\\eta ' \\neq \\kappa',\\\\          a_{s,\\eta , s,\\eta'}^{\\eta\\kappa\\kappa\\kappa ' } + a_{s,\\eta',s,\\eta}^{\\eta'\\kappa'\\kappa'\\kappa * }                       &    \\textrm{if } & \\eta = \\kappa \\textrm{\\;and\\ ; } \\eta ' = \\kappa ' .",
    "\\end{array}\\right.\\end{aligned}\\ ] ]      with the notation introduced in the previous section , we are now ready to formulate the problem in a way that eventually will allow us to calculate spin - polarized currents in any given basis . to this end",
    "we consider the local density operator for particles of spin @xmath16 on site @xmath0 , which can be written as @xmath146 .",
    "the time rate of change of this operator is @xmath147.\\end{aligned}\\ ] ] the right hand side of this expression is of the form considered in the previous section , and we therefore know from eq .",
    "that it can be written as @xmath148 where @xmath28 is the opposite spin of @xmath16 . in the last step",
    "the on - site terms have been singled out of the expression , and the remaining sum over the bonds have been divided into one part free of spin - flips , and one involving spin - flips . using eq .",
    "we can further conclude that the first term is zero .",
    "the next two terms converts @xmath16- and @xmath28-spins into each other on - site .",
    "when considering the density of a single spin species such as @xmath16 , these terms therefore acts as sink and source terms , respectively .",
    "we therefore define the sink - source operator on site @xmath0 as @xmath149 the third line describes processes where a @xmath16 spin jumps between site @xmath0 and site @xmath122 .",
    "it is therefore the current into site @xmath0 along bond @xmath113 .",
    "we accordingly define the current operator along bond @xmath113 as @xmath150 where it is implicitly understood that the operator is only defined for actual bonds between different sites .",
    "we have here included an additional minus sign in order to define the direction of the current to be along the bond away from site @xmath0 .",
    "the third term is similarly related to the in and out flow of @xmath16-spins on site @xmath0 .",
    "however , in contrast to the ordinary currents the spins flip during the transition .",
    "we therefore define the spin - flipping current along bond @xmath113 as @xmath151    with these definitions we can now write @xmath152 it is clear that in order to have a complete understanding of the currents in a given basis @xmath16 , it is sufficient to evaluate the three coefficients @xmath153 these can all be written as @xmath154    with knowledge of the eigenstates of the hamiltonian , the expressions just derived allow us to calculate on - site sink - sources , as well as currents on bonds , using @xmath155 and @xmath156 , respectively .",
    "however , it is also useful to know the current on a specific site , rather than on the bonds .",
    "if @xmath5 is the vector along bond @xmath113 , from @xmath0 to @xmath122 , we also define the two types of currents at site @xmath0 as @xmath157 this is a directed average of all currents flowing out from site @xmath0 and forms a vector field , in contrast to the scalar currents defined on the bonds .",
    "although we in principle can proceed to calculate the relevant coefficients in eq .   using eq .",
    ", this requires the hamiltonian to be expressed in the same basis as @xmath16 .",
    "it would be a nuisance if each time we want to calculate the current in a new basis , the hamiltonian would need to be rewritten in that basis , commutators be reevaluated , and finally also the expectation values @xmath158 and @xmath159 .",
    "it is much better if the current in one basis can be evaluated from the commutators and expectation values calculated in the basis of the original hamiltonian .",
    "consider therefore operators with arbitrary spin direction @xmath160 where @xmath16 is some arbitrary spin , and @xmath28 is the opposite spin .",
    "further , @xmath161 and @xmath162 here refers to up and down spins in the basis of the hamiltonian .",
    "if @xmath16 is along the direction ( @xmath163 ) , in ordinary polar coordinates relative to the basis of the hamiltonian , the coefficients can be chosen to be @xmath164 and the relevant commutator can be written as @xmath165 = \\sum_{\\kappa\\kappa'}b_{\\kappa}^{*}b_{\\kappa'}\\frac{i}{\\hbar}\\left[h , c_{s\\kappa}^{\\dagger}c_{s\\kappa'}\\right].\\end{aligned}\\ ] ] it is clear that the left hand side can be calculated for any spin direction @xmath16 if the right hand side has been evaluated in the basis of the hamiltonian .",
    "however , we remember that it is the expansion of the left hand side into @xmath40 coefficients that allows us to calculate currents .",
    "assume therefore that the @xmath40 coefficients in the expansion of the commutators on the right hand side have been evaluated .",
    "we denote these coefficients by a capital @xmath166 , to distinguish them from the @xmath40 coefficients in the expansion in the basis of the expression on the left hand side .",
    "we will now show how @xmath40 coefficients in any basis can be calculated from a knowledge of the @xmath166 coefficients . to this end , we remind ourselves that we in fact are only interested in calculating the three @xmath40 s in eq .  .",
    "further , using eq .   and",
    ", these can be written as    @xmath167c_{s\\kappa'''}^{\\dagger}|0\\rangle,\\nonumber\\\\      a_{s+b,\\sigma , s,\\sigma}^{\\sigma\\sigma\\sigma\\sigma } = & \\langle 0|c_{s+b,\\sigma}\\frac{d\\hat{\\rho}_{\\sigma}}{dt}c_{s\\sigma}^{\\dagger}|0\\rangle\\nonumber\\\\          = & \\sum_{\\kappa\\kappa'\\kappa''\\kappa'''}b_{\\kappa}^ { * }              b_{\\kappa'}b_{\\kappa''}b_{\\kappa'''}^{*}\\langle 0|c_{s+b,\\kappa''}\\frac{i}{\\hbar}\\left[h , c_{s\\kappa}^{\\dagger}c_{s\\kappa'}\\right]c_{s\\kappa'''}^{\\dagger}|0\\rangle\\nonumber\\\\      a_{s+b,\\bar{\\sigma},s,\\sigma}^{\\bar{\\sigma}\\sigma\\sigma\\sigma } = & \\langle 0|c_{s+b,\\bar{\\sigma}}\\frac{d\\hat{\\rho}_{\\sigma}}{dt}c_{s\\sigma}^{\\dagger}|0\\rangle\\nonumber\\\\          = & \\sum_{\\kappa\\kappa'\\kappa''\\kappa ' '' }              b_{\\kappa}^{*}b_{\\kappa'}\\bar{b}_{\\kappa''}b_{\\kappa'''}^ { * } \\langle 0|c_{s+b,\\kappa''}\\frac{i}{\\hbar}\\left[h , c_{s\\kappa}^{\\dagger}c_{s\\kappa'}\\right]c_{s\\kappa'''}^{\\dagger}|0\\rangle.\\end{aligned}\\ ] ]    the two last expressions can be simplified straightforwardly by using eq .   and then summing over indices appearing in @xmath168-functions in eq .  , which gives @xmath169 the on - site term is slightly more complicated due to the special cases in eq .",
    ": @xmath170          here also the expectation values on the right hand side have been expanded in the basis of the hamiltonian , which is indicated by the subscript @xmath172 . using that @xmath173 ,",
    "this can finally be written as @xmath174      here we give a short algorithmic summary of the method .",
    "we note that the two first steps only needs to be performed once in the basis of the hamiltonian .",
    "repeated application of the subsequent steps then allows for the sink - sources and currents in arbitrary bases to be calculated .",
    "[ [ calculate - expansion - coefficients - of - commutators - in - the - basis - of - the - hamiltonian ] ] calculate expansion coefficients of commutators in the basis of the hamiltonian ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^              choose appropriate coefficients @xmath177 and @xmath178 for the spin direction @xmath16 of interest @xmath179 for a spin pointing in the direction ( @xmath163 ) , use @xmath180 the coefficients for the opposite spin follows as @xmath181                  having summarized the method , it only remains to evaluate the @xmath40 coefficients in the basis of the hamiltonian , which are denoted by a capital @xmath166 . by counting the number of spin indices in eq .   to be six",
    ", it may seem like we in general need to evaluate @xmath184 @xmath40 s per bond to be fully able to expand the commutators on the form in eq .",
    "however , the three @xmath168-functions ensure that only @xmath185 of these are non - zero . for any given bond",
    ", we can therefore restrict ourselves to evaluate @xmath186 .",
    "further , eq .   allows us to reduce this number to four , by fixing @xmath187 .",
    "the right hand side of eq .",
    "can then be completely determined for any site @xmath0 from a full knowledge of the table          all terms in the hamiltonian treated so far are quadratic of the form @xmath190 .",
    "however , even within a mean - field treatment of ordinary @xmath0-wave superconductivity , we will also encounter terms in the hamiltonian which are of the form @xmath191 where @xmath192 , for some @xmath11 .",
    "this term is a spin - singlet and therefore appears similarly in any given spin - basis , such that we can assume that @xmath193 .",
    "if the term is included in the hamiltonian , then it is clear from @xmath194 = & \\frac{i}{\\hbar}\\left(\\delta^{*}c_{s\\downarrow}c_{s\\uparrow } - \\delta_{s}c_{s\\uparrow}^{\\dagger}c_{s\\downarrow}^{\\dagger}\\right)\\end{aligned}\\ ] ] that eq .",
    "has to be modified to read @xmath195 taking the expectation value of this expression and using that @xmath196 we find @xmath197 rewriting this as @xmath198 it is possible to view any non - zero term as a possible generator of density fluctuations . although the superconducting condensate can carry current , it is clear from the vanishing expectation value that it does not in itself generate density fluctuations .",
    "in fact , it is clear from eq .   that the superconducting term is unable to generate any currents at all , including currents which preserves the density , as it gives rise to a purely on - site contribution to @xmath199 .",
    "the superconducting term is therefore not responsible for generating any currents ; the condensate only carries them once they exist .",
    "the treatment of only ordinary quadratic terms is therefore sufficient for calculating the current also in the presence of @xmath0-wave superconductivity ."
  ],
  "abstract_text": [
    "<S> we investigate the persistent currents , spin - polarized local density of states , and spectral functions of topological superconductors constructed by placing ferromagnetic impurities on top of an @xmath0-wave superconductor with rashba spin - orbit interaction . </S>",
    "<S> we solve self - consistently for the superconducting order parameter and investigate both two - dimensional blocks and one - dimensional wires of ferromagnetic impurities , with the magnetic moments pointing both perpendicular and parallel to the surface . </S>",
    "<S> we find that the topologically protected edge states of ferromagnetic blocks give rise to spin - polarized edge currents , but that the total persistent current flows in opposite direction to what is expected from the dispersion relation of the edge states . </S>",
    "<S> we also show that the majorana fermions at the end points of one - dimensional wires are spin - polarized , which can be directly related to the spin - polarization of the edge currents of two - dimensional blocks . </S>",
    "<S> connections are also made to the physics of the yu - shiba - rusinov states for zero - dimensional impurities . </S>"
  ]
}