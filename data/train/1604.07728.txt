{
  "article_text": [
    "urban life is characterized by a huge mobility , mainly motorized . amidst the complex urban management problems there is a prevalent one : traffic congestion .",
    "several approaches exist to efficiently design road networks@xcite and routing strategies@xcite , however , the establishment of collective actions , given the complex behavior of drivers , to prevent or ameliorate urban traffic congestion is still at its dawn .",
    "usually , congestion is not homogeneously distributed around all city area but there are salient locations where congestion is settled .",
    "we call this locations congestion hotspots . these hotspots usually correspond to junctions and are problematic for the efficiency of the network as well as for the health of pedestrians and drivers .",
    "it has been shown@xcite that drivers in - queue in a traffic jam are the most affected individuals to car exhaust pollution inhalation .",
    "in addition , these hotspots are usually located in the city center , magnifying the problem@xcite .",
    "assuming that congestion is an inevitable consequence of urban motorized areas , the challenge is to develop strategies towards a sustainable congestion regime at which delays and pollution are under control .",
    "the first step to confront congestion is the modelling and understating of the congestion phenomena .",
    "the modeling of traffic flows it is prevalent hot topic since the late 70 s when the gipps model appear @xcite .",
    "the gipps model and other car - following models @xcite have evidenced the necessity of modeling traffic flows to improve road network efficiency and also have shown how congestion severely affects the traffic flows . since ten years ago",
    "also the complex networks community has proposed stylized models to analyze the problem of traffic congestion in networks and design optimal topologies to avoid it@xcite .",
    "the focus of attention of the previous works was the onset of congestion , which corresponds to a critical point in a phase transition , and how it depends on the topology of the network and the routing strategies used .",
    "however , the proper analysis of the system after congestion has remained analytically slippery .",
    "it is known that when a transportation network reaches congestion , the system becomes highly non - linear , large fluctuation exists and the travel time and the amount of vehicles queued in a junction diverge@xcite .",
    "this phenomenon is equivalent to a phase transition in physics , and its modeling is challenging@xcite . here , we propose an idealized model to predict the behaviour of transportation networks after the onset of congestion .",
    "the presented model is analytically tractable and can be iteratively solved up to convergence . to the best of our knowledge ,",
    "this is the first analytical model that is able to give predictions beyond the onset of congestion .",
    "we present the model in terms of road transportation networks but it could also be applied to analyze other types of transportation networks such as : computer networks , business organizations or social networks .",
    "to identify congestion hotspots in urban environments we propose a model based on the theory of critical ( congestion ) phenomena on complex networks . the model , that we call _ microscopic congestion model _",
    "( mcm ) , is a mechanistic model ( yet simple ) and analytically tractable .",
    "it is based on assuming that the growth of vehicles observed in each congested node of the networks is constant .",
    "this usually happens in real transportation networks at the stationary state .",
    "the assumption allows us to describe , with a set of balance equations ( one for each node ) , the increment of vehicles in the junction queues and the number of vehicles arriving or traversing each junction from neighboring junctions .",
    "mathematically , the increment of the vehicles per unit time at every junction @xmath0 of the city , @xmath1 , satisfies the following balance equation : @xmath2 where @xmath3 is the average number of vehicles entering junction @xmath0 from the area surrounding @xmath0 , @xmath4 is the average number of vehicles that arrive to junction @xmath0 from the adjacent links of that junction , and @xmath5 $ ] corresponds to the average of vehicles that actually finish in junction @xmath0 or traverse towards other junctions .",
    "note that the value of @xmath6 is upper - bounded by the maximum amount of vehicles @xmath7 that can traverse junction @xmath0 in a time step .",
    "this simulates the physical constraints of the road network .",
    "a graphical explanation of the variables of the model is shown in fig .",
    "[ fig : modelexplanation ] .        the system of eqs .",
    "[ be ] defined for every node @xmath0 , is coupled through the incoming flux variables @xmath4 , that can be expressed as @xmath8 where @xmath9 accounts for the routing strategy of the vehicles ( probability of going from @xmath10 to @xmath0 ) , @xmath11 stands for the probability of traversing junction @xmath10 but not finishing at @xmath10 and @xmath12 is the number of nodes in the network ( see _ materials and methods _ for a detailed description of the mcm ) .    for each junction @xmath0 ,",
    "the onset of congestion is determined by @xmath13 , meaning that the junction is behaving at its maximum capability of processing vehicles .",
    "thus , for any flux generation ( @xmath14 ) , routing strategy ( @xmath15 ) and origin - destination probability distribution , eqs .",
    "[ be ] can be solved using an iterative approach ( see _ materials and methods _ ) to predict the increase of vehicles per unit time at each junction of the network ( @xmath1 ) .",
    "the only hypothesis we use is that the system dynamics has reached a stationary state in which the growth of the queues is constant .",
    "it is worth commenting here that the mcm model considers a fixed average of new vehicles entering the system @xmath14 .",
    "however , @xmath14 certainly changes during day time , with increasing values in rush hours and lower values during off - peak periods .",
    "mcm can easily consider evolving values of @xmath14 provided the time scale to reach the stationary state in the mcm ( which is usually of the order of minutes in real traffic systems ) is shorter than the rate of change in the evolution of @xmath14 ( which is usually of the order of hours for the daily peaks ) .      to validate mcm we conducted experiments on several synthetic networks and with two different routing strategies : local search strategy and shortest path strategy . in both routing strategies we assume , for simplicity , that all vehicles randomly choose the starting and ending junctions of their journey uniformly within all junctions of the network .",
    "thus , each junction generates new vehicles with the same rate @xmath16 . for shortest path strategy",
    ", vehicles follow a randomly selected shortest path towards the destination . without loss of generality",
    "we fix @xmath17 and analyze the performance of mcm for different values of @xmath18 .",
    "figure  [ fig : validation_sp_n1000 ] shows the accuracy on predicting the values of the order parameter @xmath19 and @xmath6 for shortest paths routing strategy . as in refs .",
    "@xcite , this order parameter @xmath20 corresponds to the ratio between in - transit and generated vehicles .",
    "all experiments show that the mcm achieves high accuracy in predicting the macroscopic and microscopic variables of the stylised transportation dynamics .",
    "[ cols= \" < \" , ]     the inrix index is the percentage increase in the average travel time of a commute above free - flow conditions during peak hours , e.g.  an inrix index of  30 indicates a 40-minute free - flow trip will take 52  minutes .",
    "each city has been mapped to a graph with the indicated numbers of nodes and links .",
    "the previous results show that the mcm ( microscopic congestion model ) can be used to predict the local congestion before and beyond the onset of congestion of a transportation network . up to the knowledge of the authors ,",
    "this is the first analytical model that is able to give predictions beyond the onset of congestion where the system is highly non - linear , large fluctuation exists and the amount of vehicles on transit diverge with respect to time .",
    "our model is based on assuming that the growth of vehicles observed in each congested node of the networks is constant , which allowed us to derive a set of balance equations that can accurately predict microscopic , mesoscopic and microscopic variables of the transportation network .",
    "traffic congestion is a common and open problem whose negative impacts range from wasted time and unpredictable travel delays to a waste of energy and an uncontrolled increase of air pollution .",
    "a first step towards the understanding and fight of congestion and its related consequences is the analytical modelling of the congestion phenomena . here",
    ", we have shown that the mcm model is detailed enough to give real predictions considering real traffic data and topology .",
    "these results pave the way to a new generation of stilyzed physical models of traffic on networks in the congestion regime , that could be very valuable to assess and test new traffic policies on urban areas in a computer simulated scenario .",
    "let node @xmath0 denote a road junction , edge @xmath21 the road segment between junctions @xmath0 and @xmath10 , @xmath22 and @xmath23 the sets of ingoing and outgoing neighbouring junctions of junction @xmath0 respectively , and @xmath12 the number of junctions in the road network of the city .",
    "incoming vehicles to node @xmath0 at each time step can be of two types : those coming from other junctions @xmath22 and those that start its trip with node @xmath0 as its first crossed junction .",
    "we consider this second type of incoming vehicles as generated in node @xmath0 .",
    "our microscopic congestion model ( mcm ) describes the increment of the vehicles per unit time at every junction @xmath0 of the city , @xmath1 , as : @xmath24 where @xmath3 is the average number of vehicles generated in node @xmath0 , @xmath4 is the average number of vehicles that arrive to node @xmath0 from @xmath22 junctions , and @xmath5 $ ] corresponds to the average number of vehicles that actually finish in it , or traverse this junction towards neighboring nodes in @xmath23 .",
    "parameter @xmath7 represents the maximum routing rate of junction @xmath0 .",
    "as described in the main text , we decompose the incoming flux of vehicles @xmath25 to node @xmath0 as @xmath26 where @xmath27 is the probability that a vehicle waiting in node @xmath0 has not arrived to its destination ( i.e. , it is going to visit at least another junction in the next step ) and @xmath9 is the probability that a vehicle crossing node @xmath10 goes to node @xmath28 in its next step .",
    "since vehicles just generated in a certain node are not affected by the congestion in the rest of the network , we separate their contributions in the computation of probabilities @xmath29 and @xmath30 .",
    "thus , we decompose @xmath27 as @xmath31 where the first term accounts for vehicles generated in node @xmath0 ( @xmath32 ) whose destination is not @xmath0 ( @xmath33 ) and the second term accounts for vehicles not generated in @xmath0 whose destination is not @xmath0 ( @xmath34 ) . supposing trips consist in traveling through two or more junctions we have that @xmath35 .",
    "probability @xmath32 is equal to the fraction of vehicles generated in @xmath0 with respect to the total amount of incoming vehicles : @xmath36 considering the distribution of origins , destinations , the routing strategy and the congestion in the network , probability @xmath34 can be expressed in terms of the effective node betweenness @xmath37 and the effective vehicle arrivals @xmath38 ( the amount of vehicles with destination node @xmath0 that arrive to node @xmath0 at each time step ) : @xmath39 the effective betweenness @xmath37 of a node @xmath0 accounts for the expected amount of vehicles each node @xmath0 receives per unit time considering the routing algorithm and the overall congestion of the network .",
    "materials and methods _ subsection _ effective betweenness in congested transportation networks _ for an extended description and computation of the effective node betweenness @xmath37 and the effective vehicle arrivals @xmath38 .    in the same spirit",
    ", we decompose the probability @xmath9 that a vehicle waiting in node @xmath10 goes to node @xmath0 as : @xmath40 the first term corresponds to the routed vehicles generated in node @xmath10 ( @xmath41 ) that go to node @xmath0 ( @xmath42 ) and the second term to the routed vehicles not generated in @xmath10 that go to node @xmath0 ( @xmath43 ) .",
    "similarly as before , @xmath41 can be expressed as the rate between the vehicles generated in @xmath10 and the total amount of routed vehicles : @xmath44 and , @xmath42 and @xmath43 can be computed in terms of the normalized effective edge betweenness of the network : @xmath45 where the computation of @xmath46 only considers paths that start on node @xmath10 and @xmath47 only considers paths that do not start on node @xmath10 .",
    "equivalently to the effective node betweenness @xmath37 , computation of @xmath46 and @xmath47 consider , if required , all congested junctions in the network , as described in a later section , as well as the distribution of the vehicle sources and destinations .",
    "note that the sum of @xmath48 and @xmath49 corresponds to the classical edge betweenness .",
    "moreover , @xmath9 is an exact expression before and after the onset of congestion .",
    "eventually , the mcm is composed by a set of @xmath12 equations ( @xmath50 ) , one for each junction , and , in principle , a set of @xmath51 unknowns , @xmath1 and @xmath6 for each junction . to see that the system is indeed determined we need to note that for congested junctions @xmath52 and , thus , after the transient state , @xmath53 .",
    "for the non - congested junctions we have that @xmath54 and consequently @xmath55 . in conclusion , for any node @xmath0 , either @xmath13 or @xmath56 which reduces the amount of unknowns to @xmath12",
    ".    to solve the model given a fixed generation rate @xmath14 , we start by considering that no junction is congested and we solve the set of equations eqs .",
    "[ onelayermmc][onelayermmc_lasteq ] by iteration .",
    "it is possible that some nodes exceed their maximum routing rate",
    ". if this is the case , we set the node with maximum @xmath6 as congested and we solve the system again .",
    "this process is repeated until no new junction exceeds its maximum routing rate .",
    "most of the works that consider static routing strategies assume that the generation rate of vehicles is the same for all nodes , @xmath57 . in that case , it is possible to compute the critical generation rate @xmath58 such that for any generation rate @xmath59 the network will not be able to route or absorb all the traffic@xcite .",
    "after this point is reached , the amount of vehicles @xmath60 in the network will grow proportionally with time , @xmath61 , since some of the vehicles get stacked in the queues of the nodes .",
    "this transition to the congested state is characterized using the following order parameter : @xmath62 where @xmath63 represents the average increment of vehicles per unit of time in the stationary state .",
    "basically , the order parameter measures the ratio between in - transit and generated vehicles .    in the non - congested phase , the amount of incoming and outgoing vehicles for each node can be computed in terms of the node s algorithmic betweenness @xmath64 , see ref .",
    "in particular , @xmath65 where the second term inside the parentheses accounts for the fact that , in our model , vehicles are also queued at the destination node , unlike in ref .",
    "when no junction is congested we have that @xmath66 for all nodes and consequently @xmath67 a node @xmath0 becomes congested when it is required to process more vehicles than its maximum processing rate , @xmath68 .",
    "thus , the critical generation rate at which the first node , and so the system , reaches congestion is : @xmath69    this is one of the most important analytical results on transportation networks with static routing strategies . in the following ,",
    "we show that we can recover eq .",
    "( [ onelayersigma ] ) before the onset of congestion using our mcm approach .",
    "after substitution of the expression of the probabilities in eq .",
    "[ sigmadef ] : @xmath70 and , given we do not have congestion ( i.e. , @xmath71 ) , it simplifies to @xmath72 equation ( [ eq : sigmamcm ] ) in matrix form becomes @xmath73 where @xmath74 and then @xmath75 this expression can be shown to be equivalent to eq .",
    "( [ onelayersigma ] ) by using the following relationship between node and edge betweenness : @xmath76 the right hand side corresponds to the accumulated fractions of paths that pass through the neighbors of node @xmath0 and then go to @xmath0 .",
    "each neighbor contributes with two terms , the paths that go through @xmath10 coming from other nodes , and the paths that start in @xmath10 .",
    "the effective betweenness @xmath37 of a node @xmath0 , as defined in ref .",
    "@xcite , accounts for the expected amount of vehicles each node @xmath0 receives per unit time .",
    "when the network is not congested and the vehicle generation rate @xmath14 is equal for all nodes , @xmath16 , the number of vehicles each node receives can be obtained using eq .",
    "[ onelayersigma ] .",
    "however , if the network is congested , the traffic dynamics becomes highly non - linear and the value of @xmath25 computed in eq .",
    "[ onelayersigma ] becomes a poor approximation .",
    "suppose we focus on a particular congested node @xmath77 of the network . for @xmath77 ,",
    "being congested means that it is receiving more vehicles that the ones it can process and route . in particular , from the @xmath78 vehicles that arrive to the node , only @xmath79 can be processed at each time step .",
    "therefore , the contribution to the effective betweenness @xmath37 of the paths from a source / destination pair , @xmath80 , that traverse the congested node @xmath77 before reaching @xmath0 , must be rescaled by the fraction of processable vehicles : @xmath81 when a path traverses multiple congested nodes @xmath82 , the remaining fraction of paths that will reach the target node will be the result of the application of the multiple re - scalings @xmath83 .",
    "the computation of @xmath84 is not straightforward . in general",
    ", @xmath25 is not known after the onset of congestion and depends on the effective betweenness that requires , at the same time , to know the @xmath84 fraction for all congested nodes .",
    "thus , an iterative calculation is needed to fit all the parameters at the same time as we do in our microscopic congestion model .",
    "the effective arrivals @xmath38 account for the amount of vehicles with destination node @xmath0 that arrive to node @xmath0 at each time step .",
    "this value in the non - congested phase can be obtained , considering homogeneous source and destination nodes , as @xmath85 however , congestion affects the variable @xmath86 as well , and needs to be corrected accordingly using the same procedure presented above .      to simulate the traffic dynamics of the road network ,",
    "we assign a first - in - first - out queue to each junction that simulates the blocking time of vehicles before they are allowed to cross it and continue their trip .",
    "we suppose these queues have infinite capacity and a maximum processing rate that simulates the physical constraints of the junction .",
    "vehicles origins and destinations may follow any desired distribution . in this work ,",
    "we have considered two distributions : a random uniform distribution for the synthetic experiments , and one obtained considering the ingoing and outgoing flux of vehicles of the city of milan . at each time step ( of 1 minute duration )",
    "vehicles are generated and arrive to their first junction . during the following time steps ,",
    "vehicles navigate towards their destination following any routing strategy . here , we have used two different routing strategies : shortest - path and random local search .    for the particular case of simulating traffic in the city of milan we assume a traffic dynamics similar to the `` home - to - work '' travel pattern where vehicles arrive from the outskirts of the city , go to the city center and then return to the outskirts .",
    "specifically , in our simulation , traffic is generated in the peripheral junctions of the network , goes to a randomly selected junction within the city and then returns back to a randomly selected peripheral junction .",
    "we do not consider trips with origin and destination inside the city center since public transportation systems ( e.g. , train or subway ) usually constitute a better alternative than private vehicles for those trips .",
    "the maximum crossing rate of each junction @xmath7 accounts , among others , for the existence of traffic lights governing the junction , the width of the street as well as its traffic . we have not been able to get this information for the studied cities , and consequently we can not set to each junction its precise value . instead , without loss of generality and for the sake of simplicity , we set to all junctions the same maximum crossing rate , @xmath87 ( an estimation of the average of their real values ) .",
    "this work has been supported by ministerio de economa y competitividad ( grant fis2015 - 71582-c2 - 1 ) and european comission fet - proactive projects multiplex ( grant 317532 ) .",
    "a.a .  also acknowledges partial financial support from the icrea academia and the james s. mcdonnell foundation ."
  ],
  "abstract_text": [
    "<S> traffic congestion is one of the most notable problems arising in worldwide urban areas , importantly compromising human mobility and air quality . </S>",
    "<S> current technologies to sense real - time data about cities , and its open distribution for analysis , allow the advent of new approaches for improvement and control . here </S>",
    "<S> , we propose an idealized model , the microscopic congestion model , based on the critical phenomena arising in complex networks , that allows to analytically predict congestion hotspots in urban environments . </S>",
    "<S> results on real cities road networks , considering , in some experiments , real - traffic data , show that the proposed model is capable of identifying susceptible junctions that might become hotspots if mobility demand increases . </S>"
  ]
}