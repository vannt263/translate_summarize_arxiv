{
  "article_text": [
    "the calculation and prediction of the behavior of complex systems is one of the most pressing issues in theoretical physics@xcite and in many related fields .",
    "a common difficulty when dealing with statistical problems is that the state - space of possible outcomes is enormous .",
    "this is particularly so for quantum systems  but very similar issues can arise in many types of master equation , with applications ranging from kinetic theory to genetics .",
    "one of the earliest approaches to this problem was the method of langevin equations in brownian motion , which led to the theory of equations with random terms , or stochastic equations .",
    "an important subsequent development in the field of discrete master equations was the van kampen system - size expansion@xcite , which leads to an approximate fokker - planck equation equivalent to a stochastic equation  whose deterministic part has the usual rate - equation behavior . following this , a more systematic technique was introduced , called the poisson@xcite expansion .",
    "this gives an exact fokker - planck equation in cases with linear rate equations , and does not require a system - size expansion .",
    "the general advantage of poisson methods is that they employ a ` natural ' basis in which the distribution is expanded in the most entropically likely distribution for linear couplings .",
    "this allows for very efficient treatment of the underlying poissonian statistics .",
    "the disadvantage is that poisson methods involve a complex extension to the usual real space of number densities .",
    "this can result in large errors  both random and systematic  when nonlinear interactions generate unstable trajectories in the complex space .",
    "these are solutions to the deterministic drift equations which can reach infinity in a finite time .",
    "just as in related quantum phase - space methods@xcite , such trajectories result in power - law distribution tails which can cause large sampling errors",
    ". these can also give rise to systematic boundary term errors@xcite , since the derivation of the fokker - planck equation requires that the resulting distribution can be integrated by parts with vanishing boundary terms .",
    "in this paper , a new method called the gauge poisson representation is introduced .",
    "this removes any unstable trajectories or moving singularities , which are conjectured@xcite to be the cause of boundary term errors  thus allowing an exact mapping of many important master equations into stochastic differential equations , even when the poisson expansion can not be used .",
    "this is an example of a stochastic gauge@xcite , in which stochastic equations are modified by introducing an equivalence class of gauges that stabilize all complex trajectories .",
    "i find that correctly chosen stochastic gauges appear to eliminate the boundary term problem , and simultaneously give rise to greatly reduced sampling errors in practical numerical solutions .",
    "numerical simulations are presented for specific cases to verify that gauges with no moving singularities lead to exact results .    to illustrate the technique ,",
    "i show how the gauge method can be used to calculate means and correlation predictions from master equations .",
    "the first example describes genetic mutations in a simple model from evolutionary biology@xcite .",
    "the second treats the astrophysical problem of interstellar molecular hydrogen production on grain surfaces@xcite .",
    "the examples show relatively simple behavior that leads to sub - poissonian results in cases where there is an analytic theory available to compare with numerical simulations .",
    "this demonstrates that correct results can be obtained in the stochastic gauge simulations , with a range of stabilizing gauges  even when incorrect results are obtained with the standard poisson expansion , due to boundary terms . at the same time , these master equations have a great deal of intrinsic scientific interest .    in many cases , there are more degrees of freedom with correlations and fluctuations that are closer to poissonian .",
    "a type of problem where stochastic gauge methods would be useful is the treatment of complex systems where there are large numbers of modes , like a lattice or spatially extended continuum model .",
    "correlations in these types of system are also able to be treated , in principle , by these methods . other examples are cases where the statistics that are dominated by some rate - limiting step involving only small numbers .",
    "details of these applications will be given elsewhere .",
    "in master equations , the fundamental object is a probability distribution @xmath0_{\\mathbf{n}}$ ] for observing probabilities of discrete outcomes , labeled with integers @xmath1 .",
    "these numbers are typically the number of particles or atoms ( in physics ) , molecules ( in chemistry ) or organisms ( in biology)@xcite .",
    "the numbers may refer to a large , well - mixed volume , or to cells within a larger volume in the case of spatially extended systems .",
    "a common and very significant problem is the markovian time - evolution of the distribution , defined by an @xmath2 matrix @xmath3 so that :    @xmath4    there are severe complexity issues that arise in trying to solve this numerically as @xmath5 , the number of modes or dimensions , increases ( unless the problem is exactly soluble or factorisable , which is rarely the case in practice ) .",
    "the difficulty of solving this equation directly is that even when the maximum number is bounded by @xmath6 , the total number of discrete states @xmath7 involved is @xmath8 , which grows exponentially large with the number of distinct modes @xmath5 .",
    "thus , direct methods are not suitable for solving many problems of this type .",
    "the most general markovian master equation considered here describes a number of coupled reactions , labeled with an index @xmath9 .",
    "each reaction has the following generic structure:@xmath10    the reactions are restricted to be at most binary , so that @xmath11 , @xmath12 , and @xmath13 .",
    "the probability of a transition per unit time is proportional to the rate @xmath14 and the number of initial ` particles ' , giving a reaction rate of:@xmath15    the traditional rate equation for the process ( [ eq : kinetic ] ) , which ignores fluctuations , assumes deterministic changes for @xmath16 according to :    @xmath17    by contrast , equation ( [ eq : markovme ] ) describes both mean values and fluctuations . in this case the master equation for the probability of the outcome @xmath7  including fluctuations  has the form :    @xmath18\\ ] ]    where @xmath19 is the particle number prior to reaction ( @xmath9 ) that leads to a current number @xmath20 .",
    "the propagation matrix @xmath3 can now be constructed from a class of matrix ladder operators which either increase ( @xmath21 ) the number of particles in a particular mode @xmath22 , or decrease ( @xmath23 ) the number of particles and multiply the probability by a factor of @xmath24 . in terms of the probability vector @xmath25 , this means that : @xmath26_{\\mathbf{n } } & = & p(n_{1},\\ldots n_{j}-1,\\ldots)\\nonumber \\\\ \\left[\\mathbf{l}_{j}^{-}\\mathbf{p}\\right]_{\\mathbf{n } } & = & ( n_{j}+1)p(n_{1},\\ldots n_{j}+1,\\ldots)\\,\\,.\\end{aligned}\\ ] ]    combining products of these together gives the result that:@xmath27_{\\mathbf{n}}=\\frac{(n_{j}+\\nu-\\mu)!}{(n_{j}-\\mu)!}p(n_{1},\\ldots n_{j}+\\nu-\\mu,\\ldots)\\ ] ]    this is precisely the matrix operation required to construct the master - equation matrix .",
    "hence , after using the identities for the raising and lowering operators , one finds that the master equation matrix has a factorized structure given by :    @xmath28\\left[\\prod_{j}\\left(\\mathbf{l}_{j}^{-}\\right)^{\\nu_{j}^{a}}\\right]\\,\\,.\\label{eq : factor}\\ ] ]      in this section , the results of the poisson representation@xcite will be summarized .",
    "this important development employs an expansion of the distribution vector @xmath25 using ` prototype ' solutions , namely the complex poisson distribution @xmath29 , _ without requiring a system - size expansion_:@xmath30_{\\mathbf{n}}=\\prod_{\\mathbf{j}=1}^{d}e^{-\\alpha_{j}}\\left(\\alpha_{j}\\right)^{n_{j}}/n_{j}!\\,\\,\\,.\\ ] ] the positive poisson representation@xcite expands the distribution vector @xmath25 with a quasi - probability , @xmath31 , defined over a _ complex _ @xmath5-dimensional phase - space of variables @xmath32 . @xmath33 here the discrete variable @xmath7 , which is a vector of integers , is transformed into a continuous variable @xmath32 which is a vector of complex numbers . in the above form",
    "it is conventional to choose f@xmath34 as positive , so that it behaves much like a conventional probability .",
    "it is also possible to make other choices .",
    "for example , the complex poisson representation employs a complex contour integral form which is useful for finding exact solutions in special cases . in this expansion,@xmath35    with the aid of differential identities given in the next subsection , either expansion can be used to change the master equation given above into a differential form . introducing a generalised measure @xmath36 to indicate either a volume or contour integral , and",
    "a differential operator @xmath37 that is determined by the propagation matrix @xmath3 , @xmath38d\\mu(\\bm\\alpha)\\,\\,.\\label{anti}\\end{aligned}\\ ] ]    next , provided that the relevant boundary terms vanish , partial integration results in a modified form with a differential operator @xmath39 acting on the distribution rather than the basis itself , where @xmath39 conventionally is written with all derivative operators on the left:@xmath40\\mathbf{p}_{0}(\\bm\\alpha)d\\mu(\\bm\\alpha)\\,\\,.\\label{normal}\\ ] ]    this can then be used to deduce that a sufficient condition for the distribution function @xmath31 is that it should satisfy a partial - differential equation of fokker - planck form:@xmath41 this form is valid in either the positive or the complex poisson representation . since",
    "a contour integral can be chosen to be closed , or to have a direction in phase - space which gives rise to an exponentially damped behaviour , it is generally possible to choose a contour that gives rise to vanishing boundary terms for a complex poisson representation .",
    "the issue is more difficult in the case of the positive poisson representation , since the extended ( complex ) phase - space may include directions where the fokker - planck solutions have power - law tails which are not sufficiently bounded . in such cases ,",
    "the presence of boundary terms mean the technique is no longer exact .    in the positive poisson case ,",
    "provided the partial differential equation is of second order and has positive - definite diffusion , an equivalent stochastic differential equation is obtained .",
    "the crucial point is that this final equation has just linear rather than exponential growth in the problem size , as the number of modes @xmath5 increases .",
    "observables are calculated using the result that the @xmath42th factorial moment is now given by a probabilistic average in the positive poisson representation :    @xmath43    with a similar contour integral result for the complex poisson representation .",
    "the poisson expansion is best thought of as providing a systematic procedure that can replace approximations valid for large enough numbers @xmath20 , including rate - equations and system - size expansions@xcite .",
    "such large - number approximations are inapplicable to many important problems where the actual numbers may be small in at least one of the steps .",
    "examples of this are common in problems involving nano - structures  like the grains involved in astrophysical molecule production@xcite .",
    "other potential applications include genetic population dynamics@xcite , where population numbers in small regions are also critically important to reproduction , and spatially dependent master equations for diffusion or kinetic processes .",
    "direct monte - carlo simulations can be used in these problems@xcite , but these can be inefficient and time - consuming for large numbers of modes , since they do not make any use of the fact that most of the populations involved may be nearly poissonian .    as explained in the introduction ,",
    "the poisson method for birth - death master equations has similar properties to the positive - p@xcite representation in quantum mechanics .",
    "it is exact if the resulting differential equation is linear , but there are problems when there are nonlinear terms in the equations . if the poisson distribution has power - law tails at large radius , then the resulting transformation develops systematic boundary term errors .",
    "these typically develop when unstable trajectories occur@xcite in the drift terms of the corresponding stochastic equations , which can reach the boundary at infinity in a finite time.this is an intrinsic problem in the derivation of the fokker - planck form , eq ( [ fpe ] ) , from the earlier integro - differential equation , eq ( [ anti ] ) .      for the particular master equations considered here , the fokker - planck equation is easily constructed from the matrix factorization given in eq ( [ eq : factor ] ) .",
    "the ladder operators obey identities as follows , when acting on a poisson distribution:@xmath44    since @xmath29 is analytic in @xmath32 , @xmath45 symbolizes either @xmath46 $ ] or @xmath47 $ ] for each of the @xmath48 complex variables @xmath49 . using the identities of eq ( [ ident ] ) , together with eq ( [ eq : factor ] ) , one obtains:@xmath50\\,\\,,\\ ] ] where the poisson reaction rate @xmath51 corresponds to the deterministic reaction rate when @xmath52 and is given by:@xmath53    partial integration is used next , in order to obtain a differential operator @xmath54 acting on the distribution @xmath55 rather than the expansion kernel @xmath29 .",
    "this is most conveniently carried out using generalised spherical coordinates , so that there is one boundary at large radius @xmath56 , where boundary terms should vanish .",
    "more than one type of generalised radius is possible , and it is useful to define @xmath57{\\sum_{i=1}^{d}\\epsilon_{i}|\\alpha_{i}|^{p}}\\,\\,,\\label{radius}\\ ] ] where @xmath58 is a multiplicity factor , and @xmath59 defines the power law used to obtain the radial norm .",
    "conventional hyperspherical coordinates are obtained if @xmath60 , @xmath61 .    since the kernel can grow as fast as @xmath62 ( for @xmath63 ) , a sufficient condition to have vanishing boundary terms is that the distribution should vanish faster than @xmath64 , where @xmath65 . since the oscillatory nature of the kernel for @xmath66 can cause cancellation of boundary terms , this may not always be necessary . from eq ( [ stoch - av ] ) , a sufficient condition to obtain a well - defined observable moment of order @xmath67 ,",
    "is that the distribution should vanish at @xmath68 as @xmath69 or faster . if the distribution vanishes faster than * all * finite power laws , the stochastic equations have a well - defined set of moment equations which are identical to the moment equations of the original master equation .",
    "provided these have a unique solution for a given initial condition , the less stringent condition that all moments exist is presumably sufficient to ensure that boundary terms vanish at @xmath68 .",
    "after partial integration ( provided boundary terms vanish ) the following fokker - planck equation is found :    @xmath70r^{a}f(\\bm\\alpha)\\,\\,,\\nonumber \\end{aligned}\\ ] ]    in cases of interest involving at most binary kinetics , only first and second order derivatives occur , giving a differential operator in the form :    @xmath71    here the repeated latin indices @xmath72 are summed over @xmath73 , so that @xmath74 is a @xmath5-component complex vector called the drift vector , while @xmath75 is a @xmath76 square complex symmetric matrix called the diffusion matrix .    the basic drift and diffusion matrices@xcite are given on inspection of the fokker - planck equation ( [ eq : poissonfpe ] ) , on considering all possible values and combinations of @xmath77:@xmath78r^{a}(\\bm\\alpha)\\nonumber \\\\\\end{aligned}\\ ] ]      to obtain stochastic equations , it is necessary to take a matrix square root to generate the @xmath79 noise matrix @xmath80 , where @xmath81 the lack of uniqueness of matrix square - roots allows arbitrary functions in phase - space to be introduced , called diffusion gauges@xcite . as an example of this , it is always possible to choose a diffusion gauge corresponding to separate matrices for each different reaction @xmath9 , so that:@xmath82 with this choice , the noises are always proportional to @xmath83 . since each reaction has an individual noise matrix of size @xmath84 , the total noise dimension @xmath85",
    "is given by @xmath86 .",
    "if required , it is also possible to increase the noise dimension to @xmath87 , by adding @xmath5 matrix terms @xmath88 which have nonzero entries only in the @xmath89 row : @xmath90\\,\\,.\\\\ \\nonumber\\ ] ] these have the property that @xmath91 , so therefore they do not alter the diffusion matrix .",
    "in addition to these gauges that change the noise dimension , it is also possible to use orthogonal transformations on @xmath80 which keep the dimension invariant , but alter the noise correlations .",
    "the fokker - planck differential operator acting on the distribution @xmath55 is then transformed into a stochastic differential equation by taking advantage of the equivalent analytic forms in the differential operators , as described in more detail in the next section .",
    "the result is an ito stochastic differential equation:@xmath92 where the functions @xmath93 are delta - correlated gaussian real noise terms , with:@xmath94 the stochastic functions @xmath95 are delta - correlated gaussian complex noise terms , which give rise to a gauge symmetry , in that they have no effect on the resulting moments:@xmath96    the difficulty with the positive poisson method@xcite outlined above is that even normally stable drift equations can become unstable due to movable singularities in this extended complex phase - space , which become accessible when the noise term develops a complex part .",
    "the standard term ` movable singularity'@xcite describes any solution which can reach infinity in a finite time , depending on the initial conditions .",
    "the singularity therefore ` moves ' with the initial conditions , rather than occurring at a fixed time .",
    "these singular trajectories themselves are rare , and may form a set of measure zero on the extended phase - space . however , just one singularity has been shown in an earlier study of typical examples to lead to fokker - planck equations with power - law tails , that do not vanish sufficiently quickly at the phase - space boundaries@xcite .",
    "this leads to systematic boundary term errors in the results , as well as greatly increased numerical integration and sampling errors .      as an illustration",
    ", i will consider some elementary types of reaction , to demonstrate the derivation given here .",
    "these results are readily generalized to the stochastic gauge case treated later .",
    "first , consider one - species reactions  this can be a simple isomerization or cell diffusion with a rate @xmath97 of the form :    @xmath98    in this case , the master - equation reaction matrix has the usual property that the probability of an event is proportional to the rate and the initial number of particles @xmath99 .",
    "the master equation is therefore:@xmath100 where @xmath101 .",
    "this can also be represented using matrices as:@xmath102\\mathbf{l}_{1}^{-}\\mathbf{p}\\,\\,.\\ ] ] in this case the corresponding differential operator is:@xmath103\\,\\,.\\ ] ]    on transforming into a fokker - planck equation , one obtains : @xmath104\\alpha_{1}f\\mathbf{(\\bm\\alpha)}\\,\\,.\\label{fpe0}\\ ] ] hence , the deterministic differential equation for the characteristics , which are noise - free in this case , are:@xmath105    the important advantage of the poisson method is that these equations have an identical form to simple rate - equations , yet they are exact , and include all the relevant statistics . since the green s function is a delta - function , an initially bounded distribution remains bounded , and there are no boundary terms",
    ".      to illustrate the procedure in nonlinear cases , consider a dimerization process:@xmath106 the master equation can be represented using the elementary matrix operators as:@xmath107\\mathbf{l}_{1}^{-}\\mathbf{l}_{1}^{-}\\mathbf{p}\\,\\,.\\ ] ] the corresponding differential operator is:@xmath108\\,\\,.\\ ] ]    as long as partial integration is permissible ( which is questionable here ) the fokker - planck equation would be:@xmath109\\alpha_{1}^{2}f\\mathbf{(\\bm\\alpha)}\\,\\,.\\label{fpe1}\\ ] ] hence , the corresponding stochastic differential equations are:@xmath110 where @xmath111 .",
    "only the first equation needs to considered in detail , as it is autonomous . in this case , on defining dimensionless variables @xmath112 , @xmath113 the ungauged poisson equation reduces to the form@xmath114 with @xmath115 .    in recent studies of these equations ,",
    "clear evidence was found of substantial numerical errors@xcite . to understand this , note that there is a movable singularity in this drift equation of the form @xmath116 . in stochastic calculations",
    ", it is found that random trajectories are generated for negative initial conditions ( due to the noise term ) , and these can be arbitrarily close to the singularity .    to show the analytic consequences of the singularity@xcite , consider the inverse variable @xmath117 , which has the linear ito stochastic equation :    @xmath118    this equation has a uniform noiseless flow at @xmath119 , with no absorbing submanifold .",
    "hence it has a continuous distribution without a zero in the inverse variable distribution @xmath120 .",
    "on transforming back to the original variables , the jacobean of the transformation generates a power law tail , with @xmath121 . from the earlier analysis of boundary terms ,",
    "this power - law tail is insufficient to ensure the existence of any distribution moments .",
    "one must therefore expect systematic errors due to boundary terms which do not vanish on partial integration .      as a final illustration , consider a generic binary interaction , in which two species are transformed at a rate @xmath122 into two new species :    @xmath123    the master equation is:@xmath124 this can also be represented using matrices as:@xmath125\\mathbf{l}_{1}^{-}\\mathbf{l}_{2}^{-}\\mathbf{p}\\,\\,.\\ ] ] hence , in this case:@xmath126\\nonumber \\\\   & = & k\\alpha_{1}\\alpha_{2}\\left[\\partial_{3}+\\partial_{4}-\\partial_{1}-\\partial_{2}+\\partial_{3}\\partial_{4}-\\partial_{1}\\partial_{2}\\right]\\,\\,.\\label{la}\\end{aligned}\\ ] ]    in the present example , this procedure  which is only valid if boundary terms vanish during the partial integration  would result in a stochastic equation for the complex poisson mean variables @xmath127 .",
    "on introducing the complex ` reaction rate ' , @xmath128 , the resulting ito equations are : @xmath129    this shows very clearly a useful property of the poisson method .",
    "the modified particle statistics caused by nonlinear reactions are immediately apparent from the noise terms , since any fluctuations represent a departure from poisson statistics .    as in the previous example",
    ", singular trajectories can occur at negative values of @xmath130 , which can be reached via stochastic motion in the complex plane .",
    "singularities like this often exist in complex nonlinear equations of polynomial form , since these systems are generically non - integrable or even chaotic  and the painleve conjecture@xcite states that movable singularities are to be expected in analytically continued non - integrable sets of equations .",
    "thus , in this case also the boundary terms may not vanish , leading to systematic errors .",
    "although such errors are known to be exponentially small when there is large linear damping , they can cause problems when there is little or no linear damping .",
    "the results of direct numerical simulations can be used to test the accuracy of a stochastic method .",
    "the numerical results included in this paper are simple examples where the detailed results of simulations can be evaluated in exactly soluble cases .",
    "stochastic calculus is normally carried out in one of two different forms .",
    "the first is the ito calculus , where all terms that multiply a stochastic noise are evaluated before carrying out the stochastic step forward in time .",
    "this is the simplest form , and corresponds directly to the coefficients in the type of fokker - planck equation used elsewhere in this section .",
    "the second is the stratonovich form , where all the multiplicative terms are evaluated implicitly at the midpoint of a given step forward in time .",
    "this form corresponds to taking the wide - band limit of a finite band - width stochastic equation , and follows more standard calculus rules for variable - changes .    for numerical simulations@xcite",
    "it is generally more efficient to use stratonovich equations@xcite  in which the ito drift term is modified in a standard way to allow central difference algorithms to be employed . in a generic ito equation like",
    "eq ( [ poissonito ] ) , the stratonovich method generates a modified drift term @xmath131 , where:@xmath132 the resulting equations can be used directly in stable implicit central - difference algorithms , which are robust and well - suited to the present nonlinear equations . here",
    "the ( possible ) ambiguity in the analytic differential notation is immaterial , since by construction the noise matrix @xmath133 is analytic or meromorphic .",
    "discretization error can be estimated by comparing simulations with different step - sizes , but identical underlying noise sources .",
    "this error was typically of order @xmath134 in the simulations in this paper .",
    "the algorithm used was an iterative implicit central difference method@xcite , which directly implements the stratonovich form of the stochastic equation .",
    "all numerical code was generated in c++ including estimators of both the sampling error and discretization error , using an xml script and an automatic code generator@xcite obtained from the xmds project web - site .    as an estimator of sampling error ,",
    "i use the gaussian estimator of the standard deviation in the mean , @xmath135 .",
    "however , more sophisticated estimators must be used when the results are strongly non - gaussian . to ensure that the results were a strong test of the stochastic gauge method , a large number of samples ( @xmath136 ) were used in the numerical calculations reported here , so as to give low sampling errors @xmath137 .",
    "as shown in the previous section , the positive poisson method may have systematic errors in cases involving nonlinear drift , due to boundary terms on partial integration caused by unstable trajectories .",
    "the gauge poisson representation introduced here treats the problem of boundary terms , by utilizing a gauge technique similar to that recently proposed for the positive - p distribution@xcite .",
    "it adds an extra variable to the distribution , which eliminates instabilities by modifying the dynamical equations .",
    "a type of gauge - invariance allows this to be carried out exactly .",
    "the gauge equations retain the advantages of the poisson method , but have no boundary term errors for suitably chosen gauges .",
    "this is essential for correct results .",
    "the technical details are as follows .",
    "define an extended ( gauge ) phase - space with @xmath138 , and a weighted poisson distribution as @xmath139 .",
    "here @xmath140 is a complex - valued weighting factor which weights ( or multiplies ) the usual normalized poisson basis vector .",
    "the gauge expansion is defined for a real , positive distribution @xmath141 , as:@xmath142 i will show that this implies that a freedom of choice becomes available in the equivalent stochastic equations .",
    "importantly , it then is possible to choose an equivalent stochastic equation of motion without instabilities or boundary terms .    as with the standard poisson representation , time - evolution",
    "is treated here by introducing differential identities , so that :    @xmath143d^{2}\\omega d^{2d}\\bm\\alpha\\,\\,\\,.\\label{anti - g}\\end{aligned}\\ ] ]    just as previously , the goal of the transformation is to allow partial integration , so that , provided the boundary terms vanish , this equation has an equivalent form of :    @xmath144\\mathbf{p}(\\overrightarrow{\\alpha})d^{2}\\omega d^{2d}\\bm\\alpha\\,\\,\\label{normal - g}\\ ] ]    however , the crucial distinction between this method and the usual poisson method is that the introduction of a weighting factor in the basis means that there are now additional identities available .",
    "this allows the differential operator @xmath145 to be chosen so that the resulting time - evolution of the distribution @xmath146 remains sufficiently compact at all times to guarantee that boundary terms vanish .",
    "so far this is similar to the positive poisson representation@xcite .",
    "however , the @xmath42th factorial moment is now given by a weighted average , with @xmath147 as a complex weighting parameter in the averages :    @xmath148    where the notation @xmath149 for a complex poisson variable means a weighted _ stochastic gauge average_. from this one obtains the expected result that in a pure poisson distribution with @xmath150 , the mean and variance of modes with @xmath151 are given by :    @xmath152      the extra variable @xmath147 allows an additional differential identity to be used to introduce a _ stochastic gauge _  an arbitrary vector function in the extended phase - space with @xmath153 complex dimensions .",
    "this can be used to stabilize the drift equations throughout the extended phase - space , thus allowing integration by parts .",
    "there is no free lunch here , however !",
    "the price paid is that there is a new stochastic equation in @xmath147 , leading to a finite variance in the gauge amplitude @xmath147 . while this can cause practical problems due to sampling errors",
    " which must be minimized  it is important to note that these errors can be estimated and controlled by choice of gauge and by increasing the number of sample trajectories .",
    "by contrast , there is no presently known technique of estimating and controlling boundary term errors in the standard poisson expansion .",
    "the additional identity in the weight variable @xmath147 has the simple form of :    @xmath154    to derive the stochastic gauge equations , i now introduce @xmath85 arbitrary complex _ drift gauge _",
    "functions @xmath155 , to give a new differential operator @xmath156 which is equivalent to the usual poisson operator @xmath37 , but which includes @xmath147 derivatives in the extended phase - space : @xmath157\\left[\\omega\\partial_{0}-1\\right]\\,\\,\\,.\\label{eq : gauge - operator}\\ ] ] to simplify notation , i have used @xmath158 to symbolize either @xmath159 $ ] or @xmath160 $ ] for the complex weight variable @xmath161 .",
    "this allows a choice of analytic derivatives , which is later used to obtain a positive definite fokker - planck equation .",
    "since the added term has a factor @xmath162 $ ] which vanishes when operating on the gauge basis @xmath163 , the gauge functions can be arbitrary , just as in the analogous situation of gauge field symmetries in electrodynamics .",
    "summing repeated latin indices from now on over @xmath164 , eq ( [ eq : gauge - operator ] ) becomes : @xmath165\\,\\,\\,.\\ ] ] here , the _ total _ complex drift vector , including gauge corrections , is @xmath166 , where:@xmath167\\,.\\label{gaugedrift}\\ ] ] this remarkable result shows that as long as there is a non - vanishing noise term , the drift equation can be modified in an arbitrary way by adding a gauge term .",
    "the diffusion matrix changes as well .",
    "the _ total _",
    "diffusion matrix @xmath168 is a @xmath169 matrix , with a new @xmath170 square root @xmath171 :    @xmath172\\nonumber \\\\   & = & \\left[\\begin{array}{c } \\omega\\mathbf{g}\\\\ \\mathbf{b}\\end{array}\\right]\\left[\\omega\\mathbf{g}^{t},\\mathbf{b}^{t}\\right]=\\underline{\\underline{b}}\\,\\underline{\\underline{b}}^{t}\\,\\,\\,.\\end{aligned}\\ ] ]    thus , the @xmath170 complex stochastic noise matrix @xmath171 is as before , except with one added row:@xmath173\\,\\,\\,.\\label{gauge_{d}}\\ ] ]    the additional row means that whenever a gauge term is added , a corresponding noise term appears in the equation of motion for the gauge amplitude variable @xmath147 .",
    "the details of this are derived next .",
    "so far , there is no restriction on which of the choices of analytic derivative is utilized to obtain the identities .",
    "this means that it is possible to use the free choice of equivalent identities to give a differential operator which is entirely real and has a positive - definite diffusion .",
    "this procedure is also followed in the positive - p@xcite and positive poisson@xcite representations .",
    "here it is extended@xcite to include the gauge variable @xmath147 as well as the other variables .",
    "this is achieved by introducing a @xmath174 dimensional real phase space @xmath175 , with derivatives @xmath176 , and separating @xmath177 into its real and imaginary parts .",
    "a similar procedure is followed for @xmath178 .",
    "the choice for the analytic derivative , where @xmath179 or @xmath180 , can now be made definite by choosing it so the resulting drift and diffusion terms are always real .",
    "in more detail , this corresponds to choosing:@xmath181 at this point it is necessary to introduce a corresponding real drift vector @xmath182 and diffusion matrix @xmath183 which are defined on the @xmath174 dimensional real phase space .",
    "hence , the gauge differential operator can now be written explicitly in this equivalent real form , as:@xmath184\\,\\,\\,,\\ ] ] where @xmath185 is now positive semi - definite .",
    "this can be seen by writing @xmath186 as a @xmath187 real matrix:@xmath188\\,\\,\\,,\\ ] ] so that the diffusion matrix is the square of a real matrix , with :    @xmath189\\,\\times\\left[\\left(\\underline{\\underline{b}}^{x}\\right)^{t},\\left(\\underline{\\underline{b}}^{y}\\right)^{t}\\right]\\,\\,\\,.\\ ] ]    hence , choosing the analytic derivatives to give real terms in @xmath145 generates a positive semi - definite diffusion operator on a real space of @xmath174 dimensions .",
    "provided that one can integrate by parts , the full evolution equation is then:@xmath190\\mathbf{p}(\\overrightarrow{\\alpha})d^{2(d+1)}\\overrightarrow{\\alpha}\\,\\,\\,.\\label{gaugeint}\\end{aligned}\\ ] ] provided that one can integrate by parts , there is at least one solution for @xmath191 which satisfies the positive - definite fokker - planck equation : @xmath192g(\\overrightarrow{\\alpha},t)\\,\\,\\,.\\label{realfpe}\\ ] ]    it is important to note that the crucial partial integration step is only permissible if the distribution is strongly enough bounded at infinity ( @xmath193 ) so that all boundary terms vanish .",
    "just as in the positive - p expansion , this means that the distribution must be bounded in phase - space more strongly than all power laws in @xmath194 as @xmath68 , in order for the moments to be defined .",
    "there is an additional requirement that the distribution vanishes faster than @xmath195 as @xmath196 since there is now an additional integration over @xmath197 to be carried out .",
    "however , the freedom to choose a gauge means that there are now ways to eliminate movable singularities from the drift equations corresponding to @xmath182 .",
    "i will show in examples given later that this removes boundary terms as well  as expected from earlier conjectures about the relation between boundary terms and drift singularities .",
    "the positive - definiteness of the diffusion matrix @xmath198 implies that the fokker - planck equation is equivalent to a set of @xmath153 ito stochastic differential equations , with @xmath85 _ real _ gaussian processes @xmath199 .",
    "this central result can be written compactly using the complex variable form , as:@xmath200\\,\\,\\,.\\label{eq : gsde}\\end{aligned}\\ ] ] the noises @xmath201 have correlations @xmath202 , and are uncorrelated between time steps .",
    "repeated noise indices are summed over @xmath203 .    as with the poisson representation",
    ", if the stratonovich method is used , a modified drift term @xmath204 is generated where:@xmath205 the resulting equations can be used directly in stable implicit central - difference algorithms .",
    "care should be used here in differentiating the noise matrix @xmath206 . since this includes the gauge , and is no longer an analytic function , the real and imaginary parts need to be treated separately .",
    "it is crucial to choose the drift gauge @xmath207 so that the resulting distribution is more strongly bounded than any power - law in the radius , in order to remove boundary terms and ensure that all of the moments are well - defined . amongst the gauges that achieve this goal",
    ", it is preferable to use one that minimises the sampling error .",
    "an empirical rule is that no deterministic trajectory can be allowed to reach the boundary in a finite time , even on a set of initial conditions with measure zero , as this is the signature@xcite for a distribution with a power - law tail  which can not be integrated by parts exactly , and has large sampling errors .",
    "however , this is not always a sufficient condition , since it does not take into account the radial dependence of the stochastic noise . in the generic binary reaction equation ( [ psde ] )",
    ", it is clear that noise term has at most linear radial growth , since @xmath208 , where @xmath56 is defined as in eq ( [ radius ] ) .",
    "more generally , in all cases studied here , the noise has radial components with no more than linear radial growth in @xmath209 . in some cases ,",
    "the radial noise can vanish .",
    "in general , this relatively slow growth in radial noise means that moments remain well - defined as long as there is no more than linear asymptotic growth in the radial drift .",
    "a second criterion of practical significance , is to use a gauge that generates an attractive subspace on which the drift gauge vanishes .",
    "these gauges are called minimal gauges . if this condition is not satisfied , then the stochastic noise in the gauge amplitude @xmath147 creates a relatively large and growing sampling error .",
    "this is not just an issue of mathematics , but also one of computational efficiency . in performing a numerical calculation",
    ", there are always some numerical errors .",
    "these are due to the finite nature of computers ( and even human calculators ) .",
    "thus , one has to estimate and minimize numerical errors due to round - off error , finite step - size in time , and sampling error due to the use of a finite sample of trajectories . in general",
    ", there is an optimum gauge which minimizes sampling errors , but even a non - optimal gauge can be used simply by increasing the number of sampled trajectories .      in this section ,",
    "i demonstrate the existence of stabilizing gauges for systems with deterministically stable rate equations . in later sections , the numerical simulation of a realistic nonlinear master equation",
    " which generates boundary term errors _ without _ a stabilizing gauge  is shown to give correct results within the sampling error when suitable gauges are used .",
    "the important issue , as always , is that the calculated result must agree with the correct value within a known error - bar .",
    "the gauge must be chosen to stabilise the nonlinear drift equations . just as in the simpler example of eq ( [ la ] )",
    ", the drift equations can only have constant , linear and quadratic terms .",
    "hence , the unmodified drift equation for the @xmath210-th component can always be written as:@xmath211 where all coefficients are real .    any deterministic instability for standard rate equations  in the subspace of real , positive @xmath127",
    " is generally ruled out by number conservation laws _ a priori_. in this positive subspace , there is often a conservation law such that @xmath212 is conserved , and hence @xmath213 . here",
    "@xmath58 must be chosen appropriately , for example as the number of atoms in a given chemical species .",
    "the present equations are not always strictly number - conserving however , since reservoirs are allowed .",
    "nevertheless , i assume them deterministically stable , in the sense that in the positive subspace , the asymptotic stratonovich drift must be bounded so that @xmath214 .",
    "this does permit exponential growth , which certainly occurs in many cases .",
    "a movable singularity _ can _ occur in the analytic continuation of the rate equations , which are the precise equations found in the usual positive poisson equations .",
    "it is then essential to add a stabilizing gauge that removes any singularities if the resulting stochastic equations are to be accurate and useful  although the equations with singularities can still be used as approximate equations for large particle number .",
    "the painleve conjecture@xcite states that movable singularities are a generic property of the analytic continuations of nonlinear sets of equations , so it is to be expected that these will generally occur in quadratic equations of the form given in eq ( [ eq : quadratic ] ) .",
    "each singularity has the signature that for at least one component @xmath22 , it evolves to @xmath215 in a finite time @xmath216 , and hence must typically have a leading term with an inverse power - law time - dependence with power @xmath217 for @xmath218:@xmath219    it is necessary to demonstrate the existence of gauge choices that eliminate these singularities .",
    "i now wish to demonstrate that stabilizing gauges always exist , provided that the deterministic rate equations are stable .",
    "this proof gives only minimal conditions for gauge - stabilization .",
    "other stable gauges also exist , and may be more efficient in terms of sampling error in any given case .",
    "first , it is important to choose an appropriate diffusion gauge  that is , the choice of matrix square root of the diffusion matrix must be specified .",
    "this is most simply done by choosing to regard each different unidirectional reaction as having a distinct diffusion term proportional to the reaction rate , as in eq ( [ distinct - noise ] ) .",
    "unidirectional reactions are classified according to the number of initial species and final species .",
    "this leads to nine reaction types , as shown in table ( [ cap : different - types - of ] ) , ignoring factors of order unity for simplicity .",
    ".different types of uni - directional reactions , classified by initial and final species numbers.[cap : different - types - of ] [ cols=\"^,^,^,^,^\",options=\"header \" , ]     for each gauge and for the poisson expansion , the observed moment and its sampling error @xmath137 ( standard deviation in the mean ) is given in table ( [ cap : table - comparing ] ) , which tabulates the final near - equilibrium simulation results at @xmath220 , and compares them to the equilibrium analytic result for @xmath221 .",
    "for the stable gauges , the results are within @xmath137 of the analytic calculations in most cases , and are within @xmath222 in the remaining more accurate cases  where the residual discrepancy was partly due to the finite time - step discretization error of around @xmath223 .",
    "this indicates that all these ( stable ) gauges converge to the analytically known correct answer .",
    "the corresponding ( unstable ) poisson method clearly gives incorrect answers due to boundary term and/or sampling errors , with up to @xmath224 discrepancy in the case of the mean number of hydrogen atoms , @xmath225 .",
    "the graphical and tabular evidence indicates that the mean atom number is incorrect because the unstable trajectories cause power - law tails in the distribution , and consequent boundary term errors .",
    "in addition , the graph shows that the poisson time - history has large fluctuations with sampling errors of up to @xmath226 , showing no signs of equilibration for the molecule production rate , which is proportional to @xmath227 .",
    "this is further evidence for power - law tails , which are also found in a similar quantum - optical master equation .",
    "the amplitude gauge has no systematic errors , but gives the worst sampling error of the stable gauges , as the @xmath228 variable is the least constrained in this gauge , tending to diffuse in a circle . for these parameters",
    "the phase gauge gives the best results , as it localizes the @xmath228 variable near a deterministic stable point .",
    "the last gauge is a step gauge  only giving non - zero corrections when @xmath229 .",
    "this has the feature that the gauge term @xmath147 only changes when the trajectory reaches @xmath229 , and gives sampling errors intermediate between the others .",
    "one might expect that the step gauge would give lower sampling errors in @xmath230 , since this gauge is zero in the right half - plane .",
    "instead , the phase - stabilized gauge gives the lowest overall sampling errors for all quantities with these parameter values , even for the gauge amplitude @xmath230 .",
    "this is an example of ` prevention is better than cure ' .",
    "that is , phase - stabilization is also able to prevent amplitudes from growing along the @xmath231 axis .",
    "the step gauge corrects this growth too late for optimal results , having to use a numerically bigger gauge correction  with larger sampling errors .",
    "the gauge poisson method is shown to generate a stochastic differential equation that is exactly equivalent to a nonlinear master equation in certain cases . by comparison ,",
    "the system - size expansion is only approximate , and the positive poisson representation is not exact for problems which have boundary terms due to movable singularities .",
    "the gauge technique provides a way to eliminate boundary - term errors due to singular trajectories .",
    "the price paid for this advantage is an extra stochastic gauge amplitude , which generates a sampling error that grows in time .",
    "the focus of numerical simulations in this paper is on cases where the existence of exact analytic results allows the issue of random and systematic errors to be carefully investigated .",
    "while this is not a complete proof that boundary terms can be eliminated in all cases , it suggests that choosing a stabilizing gauge is a necessary condition .",
    "this type of model is very general .",
    "for example , one can easily include linear diffusion and extend the theory to treat fluctuations in reaction - diffusion models or even boltzmann kinetics@xcite .",
    "the method simply requires that the populations are defined as occurring in a lattice of bounded cells , either in ordinary space or in a classical phase - space , together with the appropriate hopping rates .",
    "the resulting deterministic equations are just the same as would occur in discretized non - stochastic equations .",
    "however it is necessary to include cell - volume factors in the nonlinear rate constants , so that the noise terms vary with the @xmath232th lattice cell volume @xmath233- typically resulting in stochastic noise terms proportional to @xmath234 .",
    "applications to these problems will be treated elsewhere .",
    "the technique can be easily extended to include a large number of coupled kinetic processes , as occurs both in genetics , and in the generation of chemical species of astrophysical importance : for example , @xmath235 @xmath236 , @xmath237 and so on .",
    "by contrast , the direct solution of the master equation grows exponentially more complex as the number of interacting species increases .",
    "similar considerations arise when treating biological species with typically very large numbers of genotypes , or when treating extended spatial ( multi - mode ) problems .",
    "the method of choosing stable gauges developed here may also be useful for the corresponding quantum problems .",
    "numerical calculations were carried out using open software from the xmds project@xcite .",
    "thanks to the australian research council and the alexander von humboldt - stiftung for providing support .",
    "useful discussions on genetic models with a. j. drummond and on astrophysical models with o. biham are gratefully acknowledged .",
    "10 h. haken , _ synergetics : an introduction _ ( 2nd ed , springer , berlin , heidelberg , new york , 1978 ) . n. g. van kampen , _",
    "stochastic processes in physics and chemistry _",
    "( north - holland , amsterdam , 1992 ) .",
    "gardiner , s. chaturvedi , j. stat .",
    "* 17 * , 429 ( 1977 ) ; 18 , 501 ( 1978 ) ; c. w. gardiner , _ handbook of stochastic methods _ , ( 2nd ed , springer , berlin , 1985 ) .",
    "s. chaturvedi , p. d. drummond and d. f. walls , j. phys .",
    "a * 10 * , l187 - 192 ( 1977 ) ; p.  d.  drummond and c.  w.  gardiner , j.  phys .",
    "a * 13 * , 2353 ( 1980 ) .",
    "a.  m.  smith and c.  w.  gardiner , phys .",
    "a * 39 * , 3511 ( 1989 ) ; r.  schack and a.  schenzle , phys .",
    "a * 44 * , 682 ( 1991 ) .",
    "a.  gilchrist , c.  w.  gardiner , and p.  d.  drummond , phys .",
    "a * 55 * , 3014 ( 1997 ) .",
    "p. deuar and p. d. drummond , phys .",
    "a * 66 * , 033812 ( 2002 ) .",
    "m. eigen , naturwissenschaften * 58 * , 465 ( 1971 ) ; i. hanski , nature * 396 * , 41 ( 1998 ) ; d. alves and j. f. fontanari , phys .",
    "rev e * 57 * , 7008 ( 1998 ) ; b. drossel , advances in physics * 50 * , 209 ( 2001 )",
    ". s. b. charnley , astrophys j 509 , * l121 * ( 1998 ) ; astrophys j 562 , * l99 * ( 2001);.o .",
    "biham , i. furman , v. pirronello and g. vidali , astrophys .",
    "j. * 553 * , 595  ( 2001 ) .",
    "d. t. gillespie , j. comput .",
    "* 22 * , 403 ( 1976 ) ; j. chem .",
    "phys * 81 * , 2340 ( 1977 ) .",
    "l. i. plimak , m. k. olsen , m. j. collett , phys .",
    "a * 64 * , 025801 ( 2001 ) .",
    "m. j. ablowitz and p.",
    "a. clarkson , _",
    "solitons , nonlinear evolution equations and inverse scattering _ ( cambridge university press , cambridge , 1991 ) .",
    "o. deloubriere , l. frachebourg , h. j. hilhorst , k. kitahara , physica a * 308 , * 135 ( 2002 ) .",
    "a. ramani , b. grammaticos , and t. bountis , physics reports * 180 * , 159 ( 1989 ) .",
    "f. baras and m. malek mansour , phys .",
    "e * 54 * , 6139 , ( 1996 ) ; u. l. fulco , d. n. messias , m. l. lyra , phys .",
    "e * 63 * , 066118 ( 2001 ) .",
    "p. d. drummond and i. k. mortimer , j. comp .",
    "93 , 144 - 170 ( 1991 ) .",
    "g. r. collecutt , p. d. drummond , comput .",
    ". commun . * 142 * , 219 - 223 ( 2001 ) ;   http://www.physics.uq.edu.au/xmds/ [ http://www.physics.uq.edu.au/xmds/ ]"
  ],
  "abstract_text": [
    "<S> poisson representation techniques provide a powerful method for mapping master equations for birth / death processes  found in many fields of physics , chemistry and biology  into more tractable stochastic differential equations . </S>",
    "<S> however , the usual expansion is not exact in the presence of boundary terms , which commonly occur when the differential equations are nonlinear . in this paper , a gauge poisson technique is introduced that eliminates boundary terms , to give an exact representation as a weighted rate equation with stochastic terms . </S>",
    "<S> these methods provide novel techniques for calculating and understanding the effects of number correlations in systems that have a master equation description . as examples , </S>",
    "<S> correlations induced by strong mutations in genetics , and the astrophysical problem of molecule formation on microscopic grain surfaces are analyzed . </S>",
    "<S> exact analytic results are obtained that can be compared with numerical simulations , demonstrating that stochastic gauge techniques can give exact results where standard poisson expansions are not able to . </S>"
  ]
}