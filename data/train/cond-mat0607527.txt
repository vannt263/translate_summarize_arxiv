{
  "article_text": [
    "there has been an increasing interest over the last decade in performing large - scale simulations of colloidal systems , proteins , micelles and other biological assemblies .",
    "simulating such systems , and the phenomena that take place in them , typically requires a description of dynamical events that occur over a wide range of time scales .",
    "nearly all simulations of such systems to date are based on following the microscopic time evolution of the system by integration of the classical equations of motion .",
    "usually , due to the complexity of intermolecular interactions , this integration is carried out in a step - by - step numerical fashion producing a time ordered set of phase - space points ( a _ trajectory _ ) .",
    "this information can then be used to calculate thermodynamic properties , structural functions or transport coefficients .",
    "an alternative approach , which has been employed in many contexts , is to use step potentials to approximate intermolecular interactions while affording the analytical solution of the dynamics @xcite .",
    "the simplification in the interaction potential can lead to an increase in simulation efficiency since the demanding task of calculating forces is reduced to computing momentum exchanges between bodies at the instant of interaction .",
    "this approach is called event - driven or _ discontinuous molecular dynamics _ ( dmd ) .    in the dmd approach ,",
    "various components of the system interact via discontinuous forces , leading to impulsive forces that act at specific moments of time . as a result ,",
    "the motion of particles is free of inter - molecular forces between impulsive _ events _ that alter the trajectory of bodies via discontinuous jumps in the momenta of the system at discrete interaction times . to determine the dynamics , the basic interaction rules of how the ( linear and angular ) momenta of the body are modified by collisions",
    "must be specified .    for molecular systems with internal degrees of freedom",
    "it is straightforward to design fully - flexible models with discontinuous potentials , but dmd simulations of such systems are often inefficient due to the relatively high frequency of internal motions@xcite .",
    "this inefficiency is reflected by the fact that most collision events executed in a dmd simulation correspond to intra rather than inter - molecular interactions .",
    "on the other hand , much of the physics relevant in large - scale simulations is insensitive to details of intra - molecular motion at long times .",
    "for this reason , methods of incorporating constraints into the dynamics of systems with continuous potentials have been developed that eliminate high frequency internal motion , and thus extend the time scales accessible to simulation .",
    "surprisingly , relatively little work has appeared in the literature on incorporating such constraints into dmd simulations .",
    "the goal of this paper is to extend the applicability of dmd methods to include constrained systems and to outline efficient methods that are generally applicable in the simulations of semi - flexible and rigid bodies interacting via discontinuous potentials .",
    "in contrast to systems containing only simple spherical particles @xcite , the application of dmd methods to rigid - body systems is complicated by two main challenges .",
    "the first challenge is to analytically solve the dynamics of the system so that the position , velocity , or angular velocity of any part of the system can be obtained exactly .",
    "this is in principle possible for a rigid body moving in the absence of forces and torques , even if it does not possess an axis of symmetry which facilitates its motion .",
    "however , an explicit solution suitable for numerical implementation seems to be missing in the literature ( although partial answers are abundant @xcite ) .",
    "for this reason , we will present the explicit solution here .",
    "armed with a solution of the dynamics of all bodies in the system , one can calculate the collision times in an efficient manner , and in some instances , analytically .",
    "the second challenge is to determine how the impulsive forces lead to discontinuous jumps in the momenta of the interacting bodies . for complicated rigid or semi - flexible bodies , the rules for computing the momentum jumps are not immediately obvious .",
    "it is clear however that these jumps in momenta must be consistent with basic conservation laws connected to symmetries of the underlying lagrangian characterizing the dynamics .",
    "often the basic lagrangian is invariant to time and space translations , and rotations , and , hence , the rules governing collisions must explicitly obey energy , momentum , and angular momentum constraints .",
    "such conservation laws can be utilized as a guide to derive the proper collision rules .",
    "a first attempt to introduce constraints into an event - driven system was carried out by ciccotti and kalibaeva@xcite , who studied a system of rigid , diatomic molecules ( mimicking liquid nitrogen ) .",
    "furthermore , non - spherical bodies of a special kind were treated by donev _",
    "et al._@xcite by assuming that all rotational motion in between interaction events was that of a spherically symmetric body .",
    "more recently , a spherically symmetric hard - sphere model with four tetrahedral short ranged ( sticky ) interactions ( mimicking water ) has been studied by de michele _ et al._@xcite with an event - driven molecular dynamics simulation method similar to the most basic scheme presented in this paper .",
    "this work primarily focuses on the phase diagram of this `` sticky '' water model as a prototype of network forming molecular systems .",
    "our purpose , in contrast , is to discuss a general framework that allows one to carry out event - driven dmd simulations in the presence of constraints and , in particular , for fully general rigid bodies .",
    "the methodology is applicable to modeling the correct dynamics of water molecules in aqueous solutions@xcite as well as other many body systems .",
    "the paper is organized as follows .",
    "section  [ calculation ] discusses the equations of motions in the presence of constraints and sec .",
    "[ includingcollisions ] discusses the calculation and scheduling of collision times .",
    "the collision rules are derived in sec .",
    "[ rules ] . in sec .  [ ensembles ] it is shown how to sample the canonical and microcanonical ensembles and how to handle subtle issues concerning missing events that are particular to event - driven simulations .",
    "finally , conclusions are presented in sec .",
    "[ conclusions ] .",
    "the motion of rigid bodies can be considered to be a special case of the dynamics of systems under a minimal set of @xmath0 time - independent holonomic constraints ( i.e.dependent only on positions ) that fix all intra - body distances : @xmath1 where the index @xmath2 runs over all constraints present in the system and @xmath3 is a generalized vector whose components are the set of all cartesian coordinates of the @xmath4 total particles in the system . for fully rigid bodies , the number of constraints @xmath0 can easily be calculated by noting that the number of spatial degrees of freedom of an @xmath5-particle body is @xmath6 in 3 dimensions , while only 6 degrees of freedom are necessary to completely specify the position of all components of a rigid body : 3 degrees of freedom for the center of mass of the object and 3 degrees of freedom to specify its orientation with respect to some arbitrary fixed reference frame .",
    "there are therefore @xmath7 constraint equations for a single rigid body with @xmath5 point masses .",
    "below , these point masses will be referred to as _ atoms _ while the body as a whole will be called a _",
    "molecule_. a typical constraint equation fixes the distance between atoms @xmath8 and @xmath9 in the molecule to be some value , @xmath10 , i.e. , @xmath11 the equations of motion for the system follow from hamilton s principle of stationary action , which states that the motion of the system over a fixed time interval is such that the variation of the line integral defining the action @xmath12 is zero : @xmath13 where the lagrangian @xmath14 in the presence of the constraints is written in cartesian coordinates as @xmath15 where @xmath16 is the interaction potential .",
    "for clarity throughout this paper , the einstein summation convention will be used for sums over repeated _ greek _ indices i.e.  @xmath17 , whereas the sum over atom indices will be written explicitly . in eq .  , the parameters @xmath18 are lagrange multipliers to enforce the distance constraints @xmath19 .",
    "the resulting equations of motion are : @xmath20 for an elementary discussion of constrained dynamics in the lagrangian formulation of mechanics , we refer to ref .  .    when there are no interactions , such as for a single molecule , the potential @xmath21 and eq",
    "becomes @xmath22 these equations of motion must be supplemented by equations for the @xmath0 lagrange multipliers @xmath18 , which are functions of time .",
    "although the @xmath18 are not functions of @xmath3 and @xmath23 in a mathematical sense , it will be shown below that once the equations are solved they can be expressed in terms of @xmath24 and @xmath23 .",
    "note that the equations of motion show that even in the absence of an external potential , the motion of the point masses ( atoms ) making up a rigid body ( molecule ) are non - trivial due to the emergence of a _ constraint force _ @xmath25 .    in fortuitous cases ,",
    "the time dependence of the lagrange multipliers is relatively simple and can be solved for by taylor expansion of the lagrange multipliers in time @xmath26 . to evaluate the time derivatives of the multipliers",
    ", one can use time derivatives of the initial constraint conditions , which must vanish to all orders .",
    "the result is a hierarchy of equations , which , at order @xmath27 , is linear in the unknown @xmath27th time derivatives @xmath28 but depends on the lower order time derivatives @xmath29 , @xmath30 ,  @xmath31 . in exceptional circumstances",
    ", this hierarchy naturally truncates .",
    "for example , for a rigid diatomic molecule with a single bond length constraint , one finds that the hierarchy truncates at order @xmath32 , and the lagrange multiplier is a constant @xcite .",
    "however this is not the typical case .    alternatively , since the constraints @xmath33 are to be satisfied at all times @xmath26 , and not just at time zero , their time derivatives are zero at all times . from the first time",
    "derivative @xmath34 one sees that the initial velocities @xmath35 must obey @xmath36 for each constraint condition @xmath2 .",
    "the lagrange multipliers can be determined by the condition that the second derivatives of all the constraints vanish so that @xmath37 yielding a linear equation for the lagrange multipliers that can be solved in matrix form as @xmath38 where @xmath39 it may be shown that with @xmath18 given by eq .  , all higher time derivatives of @xmath19 are automatically zero .    as eq .",
    "shows , in general the lagrange multipliers are dependent on both the positions @xmath3 and the velocities @xmath23 of the particles . to see that this makes the dynamics non - hamiltonian , the equations of motion can be cast into hamiltonian - like form using @xmath40 , i.e. , @xmath41 where it is apparent that the forces in the system depend on the momentum through @xmath42 in eq .  .",
    "there exists no hamiltonian that generates these equations of motion.@xcite    since the underlying dynamics of the system is non - hamiltonian , the statistical mechanics of the constrained system is potentially more complex . in general ,",
    "phase - space averages have to be defined with respect to a metric that is invariant to the standard measure of hamiltonian systems , but @xmath43 is not conserved under the dynamics and the standard form of the liouville equation does not hold @xcite . in general , there is a phase - space compressibility factor @xmath44 associated with the lack of conservation of the measure that is given by minus the divergence of the flow in phase space .",
    "it may be shown that@xcite @xmath45 where @xmath46 is the determinant of the matrix @xmath47 defined in eq .",
    "( [ zdef ] ) .",
    "the compressibility factor is related to the invariant phase - space metric @xmath48 with@xcite @xmath49 statistical averages are therefore defined for the non - hamiltonian system as@xcite @xmath50 where @xmath51 is the probability density for the unconstrained system and @xmath52 is the partition function for the constrained system , given by @xmath53 although the invariant metric is non - uniform for many constrained systems , for entirely rigid systems the @xmath54 matrix is a function only of the point masses and fixed distances .",
    "hence the term @xmath55 acts as a multiplicative factor which cancels in the averaging process .      although the solution of the dynamics of constrained systems via time - independent holonomic constraints is intellectually appealing and useful in developing a formal statistical mechanics for these systems , it is often difficult to analytically solve for the values of the lagrange multipliers at arbitrary times .",
    "one therefore often resorts to numerical solutions of the multipliers in iterative form , using algorithms such as shake@xcite .",
    "such an approach is not really consistent with the principles of dmd , in which a computationally efficient means of calculating event times is one of the great advantages of the method . for fully - constrained , rigid bodies , it is more sensible to apply other , equivalent , approaches , such as the principal axis or quaternion methods , to calculate analytically the evolution of the system in the absence of external forces .    the basic simplification in the dynamics of rigid bodies results from the fact that the general motion of a rigid body can be decomposed into a translation of the center of mass of the body plus a rotation about the center of mass .",
    "the orientation of the body relative to its center of mass is described by the relation between the so - called _ body frame _ , in which a set of axes are held fixed with the body as it moves , and the fixed external _",
    "laboratory frame_. the two frames of reference can be connected by an orthogonal transformation , such that the position of an atom @xmath8 in a rigid body can be written at an arbitrary time @xmath26 as : @xmath56 where @xmath57 is the position of atom @xmath8 in the body frame ( which is independent of time ) , @xmath58 is the center of mass , and the matrix @xmath59 is the orthogonal matrix that converts coordinates in the body frame to the laboratory frame . note that matrix - vector and matrix - matrix multiplication will be implied throughout the paper .",
    "the matrix @xmath59 is the transpose of @xmath60 , which converts coordinates from the laboratory frame to the body frame at time @xmath26 .",
    "the elements composing the columns of the matrix @xmath59 are simply the coordinates of the axes in the body frame written in the laboratory frame .",
    "note that eq .",
    "( [ cartesianpositions ] ) implies that the relative vector @xmath61 satisfies @xmath62 here as well as below , we have dropped the explicit time dependence for most time dependent quantities with the exception of quantities at time zero or at a time that is integrated over .",
    "one sees that in order to determine the location of different parts of the body in the laboratory frame , the rotation matrix @xmath63 must be specified .",
    "this matrix satisfies a differential equation that will now be derived and subsequently solved .    before doing so",
    ", it will be useful to restate some properties of rotation matrices and establish some notation to be used below .",
    "formally , a rotation matrix @xmath64 is an orthogonal matrix with determinant one and whose its inverse is equal to its transpose @xmath65 .",
    "any rotation can be specified by a rotation axis @xmath66 and an angle @xmath67 over which to rotate . here",
    "@xmath68 is a unit vector , so that one may also say that any non - unit vector @xmath69 can be used to specify a rotation , where its norm is equal to the angle @xmath67 and its direction is equal to the axis @xmath68 .",
    "according to rodrigues formula , the matrix corresponding to this rotation is@xcite    @xmath70    the derivation of the differential equation for @xmath63 starts by taking the time derivative of eq .  , yielding @xmath71 from elementary classical mechanics@xcite , it is known that this relative velocity can also be written as @xmath72 where @xmath73 is the angular velocity vector in the lab frame . since both eq .   and",
    "eq .   are true for any vector @xmath74 , it follows that @xmath75 is the matrix representation of a cross product with the angular velocity @xmath73 , i.e. , @xmath76 multiplying eq .   on the right with @xmath77 and taking the transpose on both sides ( note that @xmath78 is antisymmetric ) yields @xmath79 this equation involves the angular velocity in the laboratory frame , but the rotational equations of motion are more easily solved in the body frame .",
    "the angular velocity vector transforms to the body frame according to @xmath80 for any rotation @xmath63 and vector @xmath81 one has @xmath82 , hence one can write @xmath83 substituting eq .   into eq",
    ".   yields the differential equation for @xmath63 : @xmath84    although the choice of body frame is arbitrary , perhaps the most convenient choice of axes for the body are the so - called principal axes in which the moment of inertia tensor @xmath85 is diagonal , i.e. , @xmath86 .",
    "choosing this reference frame as the body frame , the representation of the components of the angular momentum @xmath87 is @xmath88 where @xmath89 and @xmath90 are the principal moments of inertia and principal components of the angular velocity .",
    "the time dependence of the principal components of the angular velocity may be obtained from the standard expression for the torque in the laboratory frame : @xmath91 .",
    "\\label{transformangularmomentum}\\end{aligned}\\ ] ] where eq .   was used in the last equality .",
    "transforming eq .   to the principal axis frame gives euler s equations of motion for a rigid body @xmath92 where @xmath93 are the components of the torque @xmath94 in the body frame .",
    "note that even in the absence of any torque , the principal components of the angular velocity are in general time dependent .",
    "once the angular velocity @xmath95 is known , it can be substituted into eq .   for the matrix @xmath96 .",
    "the general solution of eq .",
    "is of the form @xmath97 where @xmath98 is a rotation matrix itself which ` propagates ' the orientation @xmath99 to the orientation at time @xmath26 .",
    "@xmath98 satisfies the same equation as @xmath63 , but with initial condition @xmath100 . by integrating this equation",
    ", one can obtain an expression for @xmath98 . at first glance",
    ", it may seem that @xmath98 can only be written as a formal expression containing a time - ordered exponential .",
    "however , for the torque - free case @xmath101 , the conservation of angular momentum and energy and the orthogonality of the matrix @xmath98 can be used to derive the following explicit expression@xcite ( implicitly also found in ref .  ):",
    "@xmath102 here @xmath103 and @xmath104 are two rotation matrices .",
    "the matrix @xmath103 rotates @xmath105 to @xmath87 and can be written as @xmath106 where @xmath107 and @xmath108 while @xmath109 .",
    "the matrix @xmath104 can be expressed , using the notation in eq .",
    ", as @xmath110 where the angle @xmath111 is given by @xmath112 with @xmath113 the angle @xmath111 can be interpreted as an angle over which the body rotates .",
    "if the body rotates one way , the laboratory frame as seen from the body frame rotates in the opposite way , which explains the minus sign in eq .  .",
    "for the derivation of eqs .",
    "- we refer to ref .  .",
    "similar equations , but in a special reference frame , can be found in ref .  .",
    "in the following , the solution of eq .   with @xmath101 for bodies of differing degrees of symmetry will be analyzed and then used to obtain explicit expressions for the matrix @xmath98 as a function of time and of the initial angular velocity in the body frame @xmath114 .",
    "for the case of a spherical rotor in which all three moments of inertia are equal , @xmath115 , the form of the euler equations is particularly simple : @xmath116 .",
    "it is therefore clear that all components of the angular velocity in the body frame are conserved , as are those of the angular momentum . as a result , @xmath103 in eq .",
    "is equal to the identity matrix .",
    "a second consequence is that @xmath117 in eq .",
    "is constant , so that @xmath118 where @xmath117 may be rewritten , using @xmath115 , as @xmath119",
    ". therefore eqs .   and give @xmath120 corresponding to a rotation by an angle of @xmath121 around the axis @xmath122 .      for the case of a symmetric top for which @xmath123 , one can solve the euler equations in terms of simple sines and cosines , since eq .",
    "becomes @xmath124 where @xmath125 is the precession frequency .",
    "the full solution of the euler equations   is given by @xmath126 using eq .",
    "and the fact that @xmath127 and @xmath128 are conserved in this case , one can easily show that @xmath103 is given by @xmath129 and one can determine @xmath117 from eq .  :",
    "@xmath130 }    { i_1 ^ 2{\\tilde{\\omega}_{1}}^2(0 )    + i_1 ^ 2{\\tilde{\\omega}_{2}}^2(0 ) }    = \\frac{l}{i_1}.\\ ] ] this is a constant so that @xmath131 .",
    "thus @xmath132 and one gets from eq .  :",
    "@xmath133      if all the principal moments of inertia are distinct , the time dependence of the angular velocity @xmath95 involves elliptic functions@xcite .",
    "while this may seem complicated , efficient standard numerical routines exist to evaluate these functions@xcite .",
    "more challenging is the evaluation of the matrix @xmath98 .",
    "while its exact solution has been known for more than 170 years@xcite , it is formulated  even in more recent texts@xcite  in terms of undetermined constants and using complex algebra , which hinders its straightforward implementation in a numerical simulation .",
    "it is surprisingly difficult to find an explicit formula in the literature for the matrix @xmath98 as a function of the initial conditions , which is the form needed in dmd simulations .",
    "for this reason , the explicit general solution for @xmath98 will briefly be presented here in terms of general initial conditions .",
    "the details of the derivation can be found elsewhere@xcite .",
    "following jacobi@xcite , it is useful to adopt the convention that @xmath134 is the moment of inertia intermediate in magnitude ( i.e. , either @xmath135 or @xmath136 ) and one chooses the overall ordering of magnitudes , such that : @xmath137 where @xmath138 is the rotational kinetic energy @xmath139 and @xmath140 is the norm of the angular momentum @xmath141 . without this convention some quantities defined below would be complex valued , which is numerically inconvenient and inefficient . note that in a simulation molecules will often be assigned a specific set of physical inertial moments with fixed order , i.e. not depending on the particular values of @xmath138 and @xmath140 . a simple way to nevertheless adopt the convention in eq .   is to introduce internal variables @xmath142 , @xmath143 and @xmath144 which differ when necessary from the physical ones by a rotation given by the rotation matrix @xmath145 this matrix interchanges the @xmath146 and @xmath147 directions and reversed the @xmath148 direction , and is equal to its inverse .",
    "the euler equations can be solved because there are two conserved quantities @xmath149 and @xmath150 which allow @xmath151 and @xmath152 to be expressed in terms of @xmath153 , at least up to a sign which the quadratic conserved quantities can not prescribe . in this way",
    "the three coupled equations are reduced to a single ordinary differential equation for @xmath154 , from which @xmath26 can be solved as an integral over @xmath153 : this is an incomplete elliptic integral of the first kind@xcite . to get @xmath153 as a function of @xmath26 , one needs its inverse , which is the elliptic function @xmath155@xcite . without giving further details ,",
    "the solution of the euler equations is given by@xcite @xmath156 here @xmath157 and @xmath158 are also elliptic functions@xcite , while the @xmath159 are the extreme ( maximum or minimum ) values of the @xmath160 and are given by @xmath161 where @xmath162 is the sign of @xmath146 .",
    "furthermore , in eq .   the _ precession frequency _ @xmath163 is given by @xmath164 the elliptic functions are periodic functions of their first argument , and look very similar to the sine , cosine and constant function .",
    "they furthermore depend on the _ elliptic parameter _",
    "@xmath165 ( or elliptic modulus @xmath166 ) , which determines how closely the elliptic functions resemble their trigonometric counterparts , and which is given by @xmath167     ( solid line ) , @xmath155 ( bold dashed line ) , @xmath158 ( dotted line ) for @xmath168 ( @xmath169 , @xmath170 , @xmath171 ) .",
    "also plotted are the cosine ( short dashed line ) and sine ( thin short dashed line ) with the same period , for comparison . ]    by matching the values of @xmath153 at time zero , one can determine the integration constant @xmath172 : @xmath173 where @xmath174 is the incomplete elliptic integral of the first kind@xcite @xmath175 in fact , @xmath176 is simply the inverse of this function . as a result of the ordering convention in eq .",
    ", the parameter @xmath165 in eq .   is guaranteed to be less than one , which is required in order that @xmath177 in eq .",
    "not be complex - valued .",
    "three more numbers can be derived from the elliptic parameter @xmath165 which play an important role in the elliptic functions .",
    "these are the _ quarter - period _",
    "@xmath178 , the _ complementary quarter - period _ @xmath179 and the _ nome _ @xmath180 , which is the parameter in various series expansions .    the period of the elliptic functions @xmath157 and @xmath155 is equal to @xmath181 , while that of @xmath158 is @xmath182 .",
    "these elliptic functions have the following fourier series@xcite : @xmath183 note that the right - hand side of eqs .",
    "- depends on @xmath165 through @xmath184 and @xmath185 $ ] . for @xmath186 ,",
    "one gets @xmath187 and @xmath157 , @xmath155 and @xmath158 reduce to @xmath188 , @xmath189 and @xmath190 , respectively .",
    "the constancy of @xmath191 is reminiscent of the conservation of @xmath192 in the case of the symmetric top , and , indeed , for @xmath123 , @xmath186 according to eq .  .",
    "typical values for @xmath193 are quite small , hence often the elliptic function @xmath155 , @xmath157 and @xmath158 resemble the @xmath188 , @xmath189 and a constant function with value one ( as e.g.  in fig .",
    "[ cnsndn ] ) . for small values of @xmath193 , the series expressions for the elliptic functions converge quickly ( although this is not the best way to compute the elliptic functions@xcite ) .",
    "having given the solutions of the euler equations , we now turn to the solution of eq .   as given by eqs .  - .",
    "the expression on the right - hand side of eq .",
    "isnot a constant in this case but involves elliptic functions . despite this difficulty , the integral",
    "can still be performed using some properties of elliptic functions , with the result@xcite @xmath194 the constants @xmath195 , @xmath196 and the periodic function @xmath197 can be expressed using the theta function @xmath198@xcite as @xmath199 where we have used the definition @xmath200    the equations - involve complex values which are not convenient for numerical evaluation . using the known series expansions of the theta function @xmath201 and its logarithmic derivative@xcite in terms of the nome @xmath193 , these equations may be rewritten in a purely real form .",
    "in fact , one readily obtains the sine and cosine of @xmath111 , which are all that is needed in eqs .   and , @xmath202 with @xmath203 while the constant @xmath195 is @xmath204 + n\\pi,\\ ] ] where @xmath205 if @xmath206 , @xmath207 if @xmath208 and @xmath209 , and @xmath210 if @xmath208 and @xmath211 .",
    "finally , the constant @xmath196 is given by@xcite @xmath212 , \\label{c2}\\ ] ] where @xmath213 .",
    "the series expansion in @xmath193 in eq .",
    "convergences for @xmath214 . because @xmath215 ( cf .",
    "eq .  ) , one has @xmath216 , and the series always converges . since @xmath193 is typically small , the convergence is rarely very slow ( e.g.  for convergence up to relative order @xmath217 one needs @xmath218 terms ) . note that since the constants @xmath195 and @xmath196 depend only on the initial angular velocities , they only need to be calculated once at the beginning of the motion of a free rigid body . on the other hand , the series expansions in eqs .   and , which have to be evaluated any time the positions are desired , have extremely fast convergence due to the @xmath219 appearing in these expressions ( for example , unless @xmath220",
    ", the series converges up to @xmath221 occurs taking only three terms ) .",
    "there are efficient routines to calculate the functions @xmath157 , @xmath155 @xmath158 and @xmath174 , see e.g.  refs . , and the series in eqs .  , and converge , the former two quite rapidly in fact .",
    "therefore , despite an apparent preference in the literature for conventional numerical integration of the equations of motion via many successive small time steps even for torque - free cases , the analytical solution can be used to calculate the same quantities in a computationally more efficient manner requiring only the evaluation of special functions . the gain in efficiency",
    "should be especially pronounced in applications in which many evaluations at various times could be needed , such as in the root searches in discontinuous molecular dynamics ( see below ) .",
    "if the interaction potential between atoms @xmath8 and @xmath9 is assumed to be discontinuous , say of the form @xmath222 then rigid molecules interacting via this potential evolve freely until there is a change in the potential energy of the system and an _ interaction event _ or _ collision event _ occurs .",
    "the time at which an event occurs is governed by a collision indicator function @xmath223 defined such that at time @xmath224 , @xmath225 . here",
    ", the time dependence of @xmath226 and @xmath227 can be obtained using the results of sec .  [ calculation ] .",
    "the simplest example of this kind of system consists of two hard spheres of diameter @xmath10 located at positions @xmath226 and @xmath228 .",
    "if two spheres are approaching , when they get to a distance @xmath10 from one another , the potential energy would change from @xmath229 to @xmath230 if they kept approaching one another .",
    "as this eventually would lead to a violation of energy conservation , the spheres bounce off one another in a _ hard - core collision _ at time @xmath224 , where @xmath224 is determined by the criterion @xmath231 , i.e. by the zeros of the collision indicator function .",
    "another kind of interaction event , with @xmath232 and @xmath229 finite , will be called a _ square - well collision _ because the potential then has a square well shape .    to find the times at which collisions take place ,",
    "the zeros of the collision indicator functions must be determined , which generally has to be done numerically .",
    "the calculation of the collision times of non - penetrating rigid objects is an important aspect of manipulating robotic bodies , and is also an important element of creating realistic animation sequences . as a result",
    ", many algorithms have been proposed in these contexts to facilitate the event time search@xcite .",
    "the search for the earliest collision event time can be facilitated using screening strategies to decide when rigid bodies may overlap@xcite .",
    "usually , these involve placing the bodies in bounding boxes and using an efficient method to determine when bounding boxes intersect .",
    "the simplest way to do this in a simulation of rigid molecules is to place each molecule in the smallest sphere around its center of mass containing all components of the molecule@xcite .",
    "the position of the sphere is determined by the motion of the center of mass , while any change in orientation of the rigid molecule occurs within the sphere .",
    "collisions between rigid molecules can therefore only occur when their encompassing spheres overlap , and the time at which this occurs can be calculated analytically for any pair of molecules .",
    "this time serves as a useful point to begin a more detailed search for collision events ( see below ) .",
    "similarly , one can also calculate the time at which the spheres no longer overlap , and use these event times to bracket a possible root of the collision indicator function .",
    "it is crucial to make the time bracketing as tight as possible in any implementation of dmd with numerical root searches because the length of the time bracketing interval determines the required number of evaluations of the positions and velocities of the atoms , and therefore plays a significant role in the efficiency of the overall procedure .",
    "the simplest reliable and reasonably efficient means of detecting a root is to perform a _ grid search _ that looks for changes in sign of @xmath233 , i.e. , one looks at @xmath234 and @xmath235 for successive @xmath5 .",
    "the time points @xmath236 will be called the _ grid points_. when a time interval in between two grid points is found in which a sign change of @xmath233 occurs , the newton - raphson algorithm@xcite can be called to numerically determine the root with arbitrary accuracy .",
    "since the newton - raphson method requires the calculation of first time derivatives , one must also calculate , for any time @xmath26 , the derivative @xmath237 , where the notation @xmath238 and @xmath239 has been used .",
    "such time derivatives are readily evaluated using eqs .",
    "( [ cartesianpositions ] ) and ( [ step1vel ] ) .    unfortunately ,",
    "while the newton - raphson method is a very efficient algorithm for finding roots , it can be somewhat unstable when one is searching for the roots of an oscillatory function . for translating and rotating rigid molecules ,",
    "the collision indicator function is indeed oscillatory due to the periodic motion of the relative orientation of two colliding bodies .",
    "it is particularly easy to miss so - called _ grazing collisions _ when the grid search interval @xmath240 is too large , in which case the indicator function is positive in two consecutive points of the grid search , yet nonetheless `` dips '' below zero in the grid interval .",
    "it is important that no roots are missed , for a missed root can lead to a different , even infinite energy ( but see sec .",
    "[ ensembles ] below ) . to reduce the frequency of missing grazing collisions to zero , a vanishingly small grid interval @xmath240 would be required . of course such",
    "a scheme is not practical , and one must balance the likelihood of missing events with practical considerations since several collision indicator functions need to be evaluated at each point of the grid . clearly",
    "the efficiency of the root search algorithm significantly depends on the magnitude of grid interval .    to save computation time",
    ", a coarser grid can be utilized if a means of handling grazing collisions is implemented . since the collision indicator function has a local extremum ( maximum or minimum , depending on whether @xmath241 is initially smaller or larger than @xmath242 ) at some time near the time of a grazing collision , a reasonable strategy to find these kind of collision events is to determine the extremum of the indicator function in cases in which the indicator function @xmath233 itself does not change sign on the interval but its derivative @xmath243 does . furthermore , since the indicator function at the grid points near a grazing collision is typically small , it is fruitful to search only for extrema when the indicator function at one of the grid points lies below some threshold value@xcite . to find the local extrema of the indicator function , any simple routine of locating the extrema of a non - linear function can be utilized .",
    "for example , brent s minimization method@xcite , which is based on a parabolic interpolation of the function , is a good choice for sufficiently smooth one - dimensional functions .",
    "once the extremum is found , it is a simple matter to decide whether or not a real collision exists by checking the sign of @xmath233 .",
    "once the root has been bracketed ( either through a sign change of @xmath233 during the grid search or after searching for an extremum ) , one can simply use the newton - raphson algorithm to find the root to desired accuracy , typically within only a few iterations .",
    "the time value returned by the newton - raphson routine needs to be in the bracketed interval and @xmath244 if @xmath233 was initially positive and @xmath245 if it was initially negative .",
    "if those criteria are not satisfied , the newton - raphson algorithm has clearly failed and a less efficient but more reliable method is needed to track down the root . for example , the van  wijngaarden - dekker - brent method@xcite , which combines bisection and quadratic interpolation , is guaranteed to converge if the function is known to have a root in the interval under analysis .      in the previous section",
    "is was shown how to determine the time @xmath246 at which two atoms @xmath8 and @xmath9 collide under the assumption that there is no other earlier collision .",
    "this we will call a _ possible collision event_. in a dmd simulation ,",
    "once the possible collision events at times @xmath246 have been computed for all possible collision pairs @xmath8 and @xmath9 , the earliest event @xmath247 should be selected .",
    "after the collision event between atoms @xmath248 and @xmath249 has been executed ( according to the rules derived in the next section ) , the next earliest collision should be performed . however , because the velocities of atoms of the molecules involved in the collision have changed , the previously computed collision times involving these molecules are no longer valid .",
    "the next event in the sequence can be determined and performed only after these collision times have been recomputed .",
    "this process describes the basic strategy of dmd , which without further improvements would be needlessly inefficient . for",
    "if @xmath250 is the number of possible collision events , finding the earliest time would require @xmath251 checks , and @xmath252 , while the number of invalidated collisions that have to be recomputed after each collision would be @xmath253 .",
    "since the number of collisions in the system per unit of physical time also grows with @xmath4 , the cost of a simulation for a given physical time would be @xmath254 for the computation of collision times and @xmath255 for finding the first collision event@xcite .",
    "fortunately , there are ways to significantly reduce this computational cost@xcite .",
    "the first technique , also used in molecular dynamics simulations of systems interacting with continuous potentials , reduces the number of possible collision times that have to be computed by employing a _ cell division _ of the system@xcite . note",
    "that while the times of certain interaction events ( e.g. involving only the molecule s center of mass ) can be expressed in analytical form and thus computed very efficiently , the atom - atom interactions have , in general , an orientational dependence and the possible collision time has to be found by means of a numerical root search as explained in the previous section . as a consequence ,",
    "the most time consuming task in a dmd simulation with rigid bodies is the numerical root search for the collision times .",
    "one can however minimize the required number of collision time computations by dividing the system into a cell structure and sorting all molecules into these cells according to the positions of their centers of mass .",
    "each cell has a diameter of at least the largest `` interaction diameter '' of a molecule as measured from its center of mass . as a result",
    ", molecules can only collide if they are in the same cell or in an adjacent cell , so the number of collision events to determine and to recompute after a collision is much smaller . in this technique ,",
    "the sorting of molecules into cells is only done initially , while the sorting is dynamically updated by introducing a _ cell - crossing event _ for each molecule that is also stored@xcite .",
    "since the center of mass of a molecule performs linear motion between collision events , one can express its cell - crossing time analytically and therefore the numerical computation of that time is very fast .",
    "the second technique reduces the cost of finding the earliest event time .",
    "it consists of storing possible collision and cell - crossing events in a time - ordered structure called a _",
    "binary tree_. for details we refer to refs .   and ( alternative event scheduling algorithms exist@xcite but it is not clear which technique is generally the most efficient@xcite . )",
    "finally , a third standard technique is to update the molecules positions and velocities only at collisions ( and possibly upon their crossing the periodic boundaries ) , while storing the time of their last collision as a property of the molecule called its _ _ local clock__@xcite .",
    "whenever needed , the positions and velocities at later times can be determined from the exact solution of force - free and torque - free motion of the previous sec .",
    "[ calculation ] .",
    "the use of cell divisions , a binary event tree to manage the events , and local clocks is a standard practice in dmd simulations and largely improves the simulation s efficiency@xcite . to see this",
    ", note that in each step of the simulation one picks the earliest event from the tree , which scales as @xmath256 for randomly balanced trees@xcite .",
    "if it is a cell - collision event , it is then performed and subsequently @xmath257 collisions and cell crossings are recomputed and added to the event tree ( @xmath258 ) . if it is a crossing event , the corresponding molecule is put in its new cell , new possible collision and crossing events are computed ( @xmath259 ) and added to the tree ( @xmath256 ) .",
    "then the program progresses to the next event .",
    "since still @xmath253 real events take place per unit of physical time , one sees that using these techniques , the computational cost per unit of physical time due to the computation of possible collisions and cell crossing times scales as @xmath253 instead of @xmath254 , while the cost due to the event scheduling is @xmath260 per unit of physical time instead of @xmath255  a huge reduction .",
    "contrary to what their scaling may suggest , one often finds that the cost of the computation of collision times greatly dominates the scheduling cost for finite @xmath4 .",
    "this is due to fact that the computations of many of the collision times requires numerical root searches , although some can , and should , be done analytically .",
    "thus , to gain further computational improvements , one has to improve upon the efficiency of the numerical search for collision event times .",
    "a non - standard time - saving technique that we have developed for this purpose is to use _ virtual collision events_. in this case , the grid search ( see sec .",
    "[ includingcollisions ] ) for a possible collision time of atoms @xmath8 and @xmath9 is carried out only over a fixed small number of grid points , thus limiting the scope of the root search to a small search interval .",
    "if no collisions are detected in this search interval , a virtual collision event is scheduled in the binary event tree , much as if it were a possible future collision at the time of the last grid point that was investigated .",
    "if the point at which the grid search is curtailed is rather far in the future , it is likely this virtual event will not be executed because the atoms @xmath8 and @xmath9 probably will have collided with other atoms beforehand .",
    "thus , computational work has been saved by stopping the grid search after a few grid points . every now and then",
    "however , atoms @xmath8 and @xmath9 will not have collided with other atoms at the time at which the grid search was stopped . in this case , the virtual collision event in the tree is executed , which entails continuing the root search from the point at which the search was previously truncated . the continued search again may not find a root in a finite number of grid points and schedule another virtual collision , or it may now find a collision . in either case the new event is scheduled in the tree .",
    "this virtual collision technique avoids the unnecessary computation of a collision time that is so far in the future that it will not be executed in all likelihood anyway , while at the same time ensuring that if , despite the odds , that collision is to happen nonetheless , it is indeed found and correctly executed .",
    "the trade - off of this technique is that the event tree is substantially larger , slowing down the event management . due to",
    "the high cost of numerical root searches however , the simulations presented in the accompanying paper showed that using virtual collision events yields an increase in efficiency between 25% and 110% , depending mainly on the system size .",
    "at each moment of collision , the impulsive forces and torques lead to discontinuous jumps in the momenta and angular momenta of the colliding bodies . in the presence of constraints , there are two equivalent ways of deriving the rules governing these changes . in the first approach ,",
    "the dynamics are treated by applying constraint conditions to cartesian positions and momenta .",
    "this approach is entirely general and is suited for both constrained rigid and non - rigid motion . in its generality , it is unnecessarily complicated for purely rigid systems and is not suitable for continuum bodies .",
    "the second approach , suitable for rigid bodies only , uses the fact that only six degrees of freedom , describing the center of mass motion and orientational dynamics are required to fully describe the dynamics of an arbitrary rigid body .",
    "the derivation therefore consists of prescribing a collision process in terms of impulsive changes to the velocity of the center of mass and impulsive changes to the angular velocity .",
    "the general collision process in systems with discontinuous potentials can be seen as a limit of the collision process for continuous systems in which the interaction potential becomes infinitely steep . a useful starting point for deriving the collision rules",
    "is therefore to consider the effect of a force applied to the overall change in the momentum of any atom @xmath27 : @xmath261 where @xmath262 is the total force acting on atom @xmath27 and @xmath263 .",
    "furthermore , here and below the pre and post - collision values of a quantity @xmath264 are denoted by @xmath264 and @xmath265 , respectively .    for discontinuous systems , the intermolecular forces are impulsive and occur only at an instantaneous collision time @xmath224 .",
    "when atoms @xmath8 and @xmath9 collide , the interaction potential @xmath16 depends only on the scalar distance @xmath266 between those atoms , so that the force on an arbitrary atom @xmath27 is given by ( without summation over @xmath8 and @xmath9 ) @xmath267 note that this is non - zero only for the atoms involved in the collision , as expected . given that the force is impulsive , it may be written as @xmath268 where the scalar @xmath269 is the magnitude of the impulse ( to be determined ) on atom @xmath270 in the collision .    in general , the constraint forces on the right - hand side of eq .",
    "( [ eleq ] ) must also have an impulsive component whenever intermolecular forces are instantaneous in order to maintain the rigid body constraints at all times .",
    "we account for this by writing the lagrange multipliers as @xmath271 because @xmath18 enters into the equations of motion for all atoms @xmath27 involved in the constraint @xmath19 , there is an effect of this impulsive constraint force on all those atoms .",
    "thus , one can write for the force on a atom @xmath27 when atoms @xmath8 and @xmath9 collide : @xmath272 .",
    "\\label{forces}\\end{gathered}\\ ] ] substituting eq .",
    "( [ forces ] ) into  ( [ deltap1 ] ) , one finds that the term proportional to @xmath273 vanishes in the limit that the time interval @xmath240 approaches zero , so that the post - collision momenta @xmath274 are related to the pre - collision momenta @xmath275 by @xmath276 note that at the instant of collision @xmath277 , the positions of all atoms @xmath3 remain the same ( only their momenta change ) so that there is no ambiguity in the right - hand side of eq .   as to whether to take the @xmath3 before or after the collision .",
    "it is straightforward to show that due to the symmetry of the interaction potential , the total linear momentum and angular momentum of the system are conserved by the collision rule  eq.([deltap2 ] ) for arbitrary values of the unknown scalar functions @xmath269 and @xmath278 .",
    "in addition to these constants of the motion , the collision rule must also conserve total energy and preserve the constraint conditions , @xmath279 and @xmath280 , before and after the collision .",
    "the first constraint condition is trivially satisfied at the collision time , since the positions are not altered at the moment of contact .",
    "the second constraint condition allows the scalar @xmath278 to be related to the value of @xmath269 using eq .   before and after the collision , since we must have @xmath281 inserting eq .",
    "( [ deltap2 ] ) into eq .",
    ", one gets @xmath282 solving this linear equation for @xmath278 gives @xmath283 where the @xmath284 matrix was defined in eq .",
    "( [ zdef ] ) .",
    "note that if atoms @xmath8 and @xmath9 are on different bodies , a given constraint @xmath285 involves either one or the other atom ( or neither ) , so at least one of the two terms on the right - hand side of eq .",
    "is then zero .",
    "equation can now be written as @xmath286 where @xmath287 is a function of the phase - space coordinate as determined by eq .   and is independent of @xmath269 .",
    "finally , the scalar @xmath269 can be determined by employing energy conservation , @xmath288 where @xmath289 denotes the discontinuous change in the potential energy at the collision time . inserting the expression in  ( [ changep ] ) into and using eq .",
    ", one gets a quadratic equation for the scalar @xmath269 , @xmath290 for finite values of @xmath291 , the value of @xmath269 is therefore @xmath292 where the physical solution corresponds to the positive ( negative ) root if @xmath293 ( @xmath294 ) , provided @xmath295 .",
    "if this latter condition is not met , there is not enough kinetic energy to overcome the discontinuous barrier , and the system experiences a hard - core scattering , with @xmath296 , so that eq .",
    "gives @xmath297 .",
    "once the value of @xmath269 has been computed , the discrete changes in momenta or velocities are easily computed using eq .",
    "( [ changep ] ) .      the solution method outlined above can be applied to semi - flexible as well as rigid molecular systems , but is not very suitable for rigid , continuous bodies composed of an infinite number of point particles . for perfectly rigid molecules , a more convenient approach is therefore to analyze the effect of impulsive collisions on the center of mass and angular coordinates of the system , which are the minimum number of degrees of freedom required to specify the dynamics of rigid systems .",
    "the momentum of the center of mass @xmath298 and the angular momentum @xmath299 of rigid molecule @xmath270 are affected by the impulsive collision via @xmath300 where @xmath301 and @xmath302 are the moment of inertia tensor and the angular velocity of body @xmath270 in the laboratory frame , respectively .",
    "note that they are related to their respective quantities in the principal axis frame ( body frame ) via the matrix @xmath303 ( now associated with the body  @xmath270 ) : @xmath304    to derive specific forms for the impulsive changes @xmath305 and @xmath306 , one may either calculate the impulsive force and torque acting on the center of mass and angular momentum , leading to @xmath307 and @xmath308 , where @xmath309 and @xmath310 are the points at which the forces are applied on body @xmath270 and @xmath311 , respectively , while @xmath312 , and @xmath269 should be obtained from energy conservation . to understand this better and",
    "make a connection with the previous section , one may equivalently view the continuum rigid body as a limit of a non - continuum rigid body composed of @xmath5 constrained point particles , and use the expressions derived in the previous section for the changes in momenta of the constituents .    in the latter approach ,",
    "it is convenient to switch the notation for the positions and momenta of the atoms from @xmath227 and @xmath313 to @xmath314 and @xmath315 , which indicate the position and momentum of particle @xmath8 on body @xmath270 , respectively . using this notation and considering a collision between particle @xmath8 on body @xmath270 and particle @xmath9 on body @xmath311 , eq .",
    "( [ changep ] ) can be written as @xmath316 , \\label{changepa}\\end{aligned}\\ ] ] where @xmath317 is the unit vector along the direction of the vector @xmath318 connecting atom @xmath8 on body @xmath270 with its colliding partner @xmath9 on body @xmath311 .",
    "thus , noting that @xmath319 , where @xmath320 is the total mass of body @xmath270 , and using eq .",
    "( [ changepa ] ) , one finds that @xmath321 since @xmath322 similarly , one finds that @xmath323 where @xmath324 . comparing with eq .",
    ", it is evident that @xmath325 note that @xmath326 is a matrix inverse .",
    "once again the impulsive changes are directly proportional to @xmath269 , and the change of the angular velocity of body @xmath311 in the laboratory frame due to the collision can be calculated analogously .    to determine the scalar @xmath269 , one again uses the conservation of total energy ( @xmath327 ) to see that @xmath328 inserting eqs .",
    "( [ changepcom ] ) and ( [ changeomega ] ) into the energy equation above yields , after some manipulation , a quadratic equation for @xmath269 of the form of eq .",
    "( [ quadratic ] ) , with @xmath329 where @xmath330 with @xmath331 for a spherically symmetric system , @xmath332 , and @xmath333 .",
    "any event - driven molecular dynamics simulation relies on the assumption that no collision is ever missed .",
    "however , collisions will be missed whenever the time difference between two nearby events is on the order of ( or smaller than ) the time error of the scheduled events , which indicates that there is still a finite chance that a collision is missed even when event times are calculated in a simulation starting from an analytic expression , due to limits on machine precision .",
    "although this subtle issue is not very important in a hard sphere system , in the present context it is of interest .",
    "indeed , the extensive use of numerical root searches for the event time calculations combined with the need for computational efficiency demands a lower precision in the time values of collision events ( typically a precision of @xmath334 instead of @xmath335 for analytical roots ) . in this section",
    ", it will be shown how to handle missed collisions in the context of the hybrid monte carlo scheme ( hmc ) .    in general",
    ", the hmc method @xcite combines the monte carlo method with molecular dynamics to construct a sequence of independent configurations @xmath336 , distributed according to the canonical probability density @xmath337 , \\label{canonicalprob}\\ ] ] where @xmath338 is the configurational integral , @xmath339 is boltzmann s constant , and @xmath340 is the temperature . in the present context , this method can be implemented as follows : initially , a new set of momenta @xmath341 is selected by choosing a random center of mass momentum @xmath342 and angular velocity @xmath73 for each molecule from the gaussian distribution @xmath343.\\ ] ] the system is then evolved deterministically through phase - space for a fixed time @xmath344 according to the equations of motion .",
    "this evolution defines a mapping of phase - space given by @xmath345 .",
    "the resulting phase space point @xmath346 and trajectory segment are then accepted with probability @xmath347    \\right\\ } ,   \\label{probacceptance}\\ ] ] where @xmath348 and @xmath349    this algorithm generates a markov chain of configurations with an asymptotic distribution given by the stationary canonical distribution defined in eq .",
    "( [ canonicalprob ] ) provided that the phase space trajectory is _ time reversible _ and _ _ area preserving__@xcite . since free translational motion is time reversible , and the reversibility of the rotational equations of motion is evident from eq .",
    "( [ pmat ] ) , the first requirement is satisfied . furthermore , since the invariant phase space metric is uniform for fully rigid bodies ( see eq .   in sec .  [ constraineddynamics ] ) ,",
    "the _ area preserving _ condition is also satisfied .",
    "ideally , a dmd simulation satisfies @xmath350 so that according to eq .",
    "( [ probacceptance ] ) every trajectory segment is accepted . in the less ideal , more realistic case in which collisions are occasionally missed",
    ", the hmc scheme provides a rigorous way of accepting or rejecting the segment .",
    "if a hard - core collision has been missed and the configuration at the end of a trajectory segment has molecules in unphysical regions of phase space where the potential energy is infinite , then @xmath351 and the new configuration and trajectory segment are always rejected . on the other hand , if only a",
    "square - well interaction has been missed , @xmath352 at the end of the trajectory segment is finite and there is a non - zero probability of accepting the trajectory .",
    "an analogous strategy can be devised to carry out microcanonical averages . in this case , the assignment of new initial velocities in the first step is still done randomly but in such a way that the total kinetic energy of the system remains constant .",
    "such a procedure can be carried out by exchanging center of mass velocities between randomly chosen pairs of molecules .",
    "the system is evolved dynamically through phase space for a fixed time @xmath344 and the new phase space point @xmath346 is accepted according to @xmath353 where @xmath352 is given by eq .",
    "( [ deltah ] ) . clearly , the case @xmath354 only occurs when a collision has been missed , and in such a case the trajectory segment is never accepted .",
    "it should be emphasized that in the hmc scheme , a new starting configuration for a segment of time evolution is chosen only after every dmd time interval @xmath344 .",
    "an algorithm in which a new configuration is selected only after a collision is missed is likely to violate detailed balance , and is therefore not a valid monte - carlo scheme . on the other hand ,",
    "the length of the trajectory segments @xmath344 in the hmc method outlined above can be chosen to be slightly larger than the relevant relaxation time of the system .",
    "such a choice allows one to use the deterministic phase space trajectory to compute time - dependent correlation functions from the _ exact _ dynamics of the system without rejecting a significant fraction of the trajectory segments .",
    "in this paper we have shown how to carry out discontinuous molecular dynamics simulations for arbitrary semi - flexible and rigid molecules . for semi",
    "- flexible bodies , the dynamics and collision rules have been derived from the principles of constrained lagrangian mechanics .",
    "the implementation of an efficient dmd method for semi - flexible systems is hindered by the fact that in almost all cases the equations of motion must be propagated numerically in an event searching algorithm so that the constraints are enforced at all times .",
    "nonetheless , such a scheme can be realized using the shake@xcite or rattle@xcite algorithms in combination with the root searching methods outlined here .",
    "the dynamics of a system of completely rigid molecules interacting through discontinuous potentials is more straightforward .",
    "for such a system , the euler equations for rigid body dynamics can be used to calculate the free evolution of a general rigid object .",
    "this analytical solution enables the design of efficient numerical algorithms for the search for collision events .",
    "in addition , the collision rules for calculating the discontinuous changes in the components of the center of mass velocity and angular momenta have been obtained for arbitrary bodies interacting through a point based on conservation principles .",
    "furthermore , the sampling of the canonical and microcanonical ensembles , as well as the handling of missed collisions , has also been discussed in the context of a hybrid monte carlo scheme .    from an operational standpoint",
    ", the difference between the method of dmd and molecular dynamics using continuous potentials in rigid systems lies in the fact that the dmd approach does not require the calculation of forces and sequential updating of phase space coordinates at discrete ( and short ) time intervals since the response of the system to an impulse can be computed analytically .",
    "instead , the computational effort focuses on finding the precise time at which such impulses exert their influence .",
    "the basic building block outlined here for the numerical computation of collision times is a grid search , for which the positions of colliding atoms on a given pair of molecules need to be computed at equally spaced points in time . as outlined in sec .",
    "[ includingcollisions ] , this can be done efficiently starting with a completely explicit analytical form of the motion of a torque - free rigid body , without which the equations of motions would have to be integrated numerically .",
    "an efficient implementation of the dmd technique to find the time collision events should make use of a ) a large grid step combined with a threshold scenario to catch pathological cases , b ) sophisticated but standard techniques such as binary event trees , cell divisions , and local clocks , and c ) a new technique of finding collision times numerically that involves truncating the grid search and scheduling virtual collision events .    on a fundamental level",
    ", it is natural to wonder whether the ` stepped ' form of a discontinuous potential could possibly model any realistic interaction .",
    "such concerns are essentially academic , since it is always possible to approximate a given interaction potential with as many ( small ) steps as one would like in order to approximate a given potential to any desired level of accuracy@xcite .",
    "of course , the drawback to mimicking a smooth potential with a discontinuous one with many steps is that the number of ` collision ' events that occur in the system per unit time scales with the number of steps in the potential .",
    "hence , one would expect that the efficiency of the simulation scales roughly inversely with the number of steps in the interaction potential .",
    "nonetheless , the issue is a practical one : how small can the number of steps in the interaction potential be such that one still gets a good description of the physics under investigation ? in the accompanying paper@xcite , we will see for benzene and methane that it takes surprisingly few steps ( e.g.  a hard core plus a square - well interaction ) to get results which are very close to those of continuous molecular dynamics .",
    "additionally , we compare the efficiency of such simulations to simulations based on standard molecular dynamics methods .",
    "the authors would like to acknowledge support by grants from the natural sciences and engineering research council of canada ( nserc ) .                                              to be more precise ,",
    "no hamiltonian exists with @xmath228 and @xmath313 as conjugate variables .",
    "otherwise , @xmath355 should be equal to @xmath356 and @xmath357 should be equal to @xmath358 , whence @xmath359 , but eq .   violates this relation .",
    "the threshold value is found by trial and error ; a trial simulation with a very small threshold value is run which is sure to miss a collision at some point due to a grazing collision ; the collision indicator function around the time of this grazing collision is inspected and the threshold value is adjusted such that this collision will not be missed .",
    "new trial simulation are run , and the threshold adjusted , until the frequency of missed grazing collisions is acceptable .",
    "this assumes no optimization whatsoever .",
    "it is easy to reduce the cost of finding the first possible collision times to @xmath254 per unit physical time , however , by storing only the first collision for every given particle@xcite ."
  ],
  "abstract_text": [
    "<S> a general framework for performing event - driven simulations of systems with semi - flexible or rigid bodies interacting under impulsive torques and forces is outlined . </S>",
    "<S> two different approaches are presented . in the first , </S>",
    "<S> the dynamics and interaction rules are derived from lagrangian mechanics in the presence of constraints . </S>",
    "<S> this approach is most suitable when the body is composed of relatively few point masses or is semi - flexible . in the second method , </S>",
    "<S> the equations of rigid bodies are used to derive explicit analytical expressions for the free evolution of arbitrary rigid molecules and to construct a simple scheme for computing interaction rules . </S>",
    "<S> efficient algorithms for the search for the times of interaction events are designed in this context , and the handling of missed interaction events is discussed . </S>"
  ]
}