{
  "article_text": [
    "the next generation of spectroscopic surveys , such as the sloan digital sky survey ( sdss ) and the 2 degree field redshift survey ( 2df ; maddox et al .",
    "1998 ) will provide a wealth of information about the spectral properties of galaxies in the local and intermediate redshift universe .",
    "for the first time we will have high signal - to - noise spectrophotometry of large , systematically selected samples of galaxies .",
    "the quality of these data will be such that we will not be restricted to measuring just redshifts but will be able to extract the spectral characteristics of individual galaxies .",
    "if we can define robust methods for the classification of galaxy spectra we will be able to study the evolution of the spectral properties of galaxies and relate these observations to the physical processes that drive them .    in the light of this",
    "a number of statistical techniques have been developed for automated classification of galaxies based on spectral continuum and line properties .",
    "one of the most promising of these methods has been the principal component analysis or karhunen - love transform ( karhunen 1947 , love 1948 ) .",
    "the technique has been successfully applied to the classification of galaxy spectra ( connolly et al .",
    "1995 , folkes et al .",
    "1996 , sodre and cuevas 1997 , bromley et al .",
    "1998 , galaz and de lapparent , 1998 ) , qsos ( francis et al .",
    "1992 ) and stars ( singh et al .  1998 ) .",
    "the underlying basis behind these techniques is that a galaxy spectrum can be described by a small number of orthogonal components ( eigenspectra ) .",
    "these eigenspectra are found to correlate strongly with the physical properties of galaxies , such as the star formation rate or age of the stellar population . by projecting a galaxy spectrum onto these orthogonal components we have a measure of the relative contributions of these different stellar types and consequently an estimate for the spectral type of the galaxy .",
    "since the spectral energy distribution of galaxies is the sum of the seds of their stellar population , such an approach is quite natural and should give a reasonable description of the galaxies .",
    "each of these approaches makes the underlying assumption that the galaxy spectra are perfect . in the real world , where surveys will cover a wide range in redshift and luminosity",
    ", this will not be the case .",
    "the ensemble of galaxy spectra will cover a broad range of rest wavelengths , have variable signal - to - noise , and will contain spectral regions affected by sky lines or artifacts in the spectrographs .",
    "this will result in spectra whose wavelength coverage will only be a subset of that of the eigenspectra ( i.e.  the data will contain missing spectral regions or gaps within the spectra ) . applying the standard techniques whereby we project",
    "the galaxy spectra onto an eigenbasis with a simple scalar product will introduce biases in to the galaxy classification schemes .",
    "in this paper we address these issues .",
    "we extend the kl analysis of spectra to incorporate the effects of gappy data and variable signal to noise . in section 2",
    "we provide the mathematical basis for our analysis and in sections 3 and 4 we show how we can provide an optimal interpolation of galaxy spectra over the missing data .",
    "sections 5 and 6 demonstrate how eigenspectra can be built from noisy and incomplete spectra . finally in section 7",
    "we discuss the application of these techniques to the general case of incomplete data and how they might be used in astrophysical problems .",
    "it has been known for some time that galaxy spectra can be represented by a linear combination of orthogonal spectra ( i.e.  eigenspectra ) and that these eigenspectra can be used for galaxy classification . in an earlier paper ( connolly et al .",
    "1995 ) we described the technique for applying the karhunen - love transform ( kl ; also known as principal component analysis ) to derive these eigenspectra . in this paper",
    "we will discuss the application of the kl transform to the classification of galaxies when we have gaps in the spectra ( e.g.  due to the removal of sky lines , bad regions on a spectrograph s ccd camera or galaxies with different rest wavelength coverage ) .    from the kl",
    "transform we can construct an orthonormal eigenbasis such that each galaxy spectrum , @xmath0 , can be represented as a linear combination of eigenspectra , @xmath1 .",
    "@xmath2 where @xmath3 represents the wavelength dimension , @xmath4 is the number of the eigenspectrum and @xmath5 are the coefficients of the linear combination . if we project a galaxy onto this eigenbasis we can define the set of linear expansion coefficients , @xmath5 , that fully describe a galaxy spectrum .",
    "the eigenspectra @xmath1 are defined to be orthogonal such that , using a simple scalar product , @xmath6 where the sum in @xmath3 extends over a pre - defined wavelength range @xmath7 .",
    "the eigenspectra are ranked by decreasing eigenvalues , which in turn reflect the statistical significance of the particular eigenspectrum . for the details of the construction of the eigenbasis",
    "see connolly et al .",
    "( 1995 ) .",
    "we have shown that , for galaxy spectra , the majority of the information present within the data is contained within the first 3 - 7 eigencomponents ( connolly et al .",
    "consequently the expansion of each galaxy spectrum in terms of the eigenbasis can be truncated ( i.e.  we can retain most of the information present within the galaxy data using only a handful of components ) .",
    "this truncated expansion represents an optimal filtering of the data in the least squares sense . as such it provides a very efficient mechanism for describing galaxy spectra .    from this series of expansion coefficients",
    ", whether truncated or not , we can construct a very natural classification scheme . as we have shown ( connolly et al .",
    "1995 ) , the first three coefficients correlate with the amount of a galaxy spectral energy distribution that is dominated by an old stellar population or by active star formation .",
    "these coefficients form an approximately one parameter sequence , well correlated with the ages of galaxies and the distribution of these coefficients can be used to separate galaxies into distinct classes ( e.g. folkes et al .",
    "1996 , bromley et al.1998 ) .",
    "the underlying basis behind these analyses is that a galaxy can be represented as a linear combination of orthogonal spectral components .",
    "the orthogonality of the system is important as it means that the expansion coefficients are uncorrelated and , therefore , provide a very simple and general way to separate galaxies into distinct classes .",
    "the benefits of the orthogonal expansion only hold if the eigenspectra and the galaxy spectrum are constructed over the same wavelength range . if , as found in real spectra , there are regions of missing data within a galaxy spectrum , due , for example , to the presence of sky lines or the fact that the rest wavelength coverage of the galaxy spectra differ from that of the eigenspectra , then the orthogonality of the system no longer holds .",
    "this loss of orthogonality can be understood if we consider figure 1 .",
    "the eigenbasis ( as shown by the first 3 eigenspectra ) is clearly orthogonal over the full spectral range ( the scalar product between the individual eigenspectra is zero ) .",
    "if we exclude those data points with @xmath8   we see that the orthogonality no longer holds and the eigensystem is not linearly independent .",
    "this means that the coefficients that would be derived by simply projecting a galaxy spectrum onto this censored basis would be biased ( in other words the spectral modes become correlated ) . as the wavelength range over which the data can be defined as valid clearly varies as a function of redshift and spectrograph , comparison between the classification of different galaxy populations becomes extremely difficult .    for the case of reconstructing faces from gappy data everson and sirovich ( 1995 )",
    "have shown that we can account for the gaps within the data and reconstruct `` unbiased '' correlation coefficients .",
    "we extend here the analysis of everson and sirovich ( 1995 ) and connolly and szalay ( 1996 ) to the case of spectral data and generalize the problem to consider an arbitrary weighting of the spectra .",
    "we consider the gappy galaxy spectrum , @xmath9 , that we wish to project onto the eigenbasis , as consisting of the true spectrum ( i.e.without gaps ) , @xmath0 , and a wavelength dependent weight , @xmath10 .",
    "the wavelength dependent weight will be zero where there are gaps within the data ( corresponding to infinite noise ) , and @xmath11 for the remaining spectral range . by applying this weight function",
    "we have a general mechanism by which we can down- or up - weight not just bad regions but also particular spectral features ( e.g.  emission lines ) that we wish to emphasize within the data .",
    "it is worth noting that in the special case where we do not consider the effects of noise ( i.e.  the weight values are 0 or 1 ) then the wavelength dependent weight acts as a window function and @xmath12 . in the general case that we discuss below , where we include gaps and noise , the weight function is related to the true spectrum through the @xmath13 minimization ( equation 3 ) .    given the relative weight of each spectral element we wish to derive a set of expansion coefficients that minimize the quadratic deviation between the observed spectrum , @xmath9 , and its truncated reconstruction , @xmath14 , where the sum over @xmath4 extends to a small number of eigenspectra only .",
    "to do this we define the @xmath13 statistic such that , @xmath15 and minimize this function with respect to the @xmath5 s .",
    "this gives the minimal error in the reconstructed spectrum , over the full range in @xmath3 , weighted by the variance vector , @xmath10 .",
    "solving for @xmath5 we get , @xmath16 defining @xmath17 and @xmath18 this simplifies to @xmath19    clearly @xmath20 represents the expansion coefficients that we would have derived if we had undertaken a weighted projection of the observed galaxy spectrum @xmath9 onto the eigenbasis ( i.e.  a biased set of coefficients ) and @xmath21 tells us how the eigenbasis is correlated over the censored spectral range .",
    "if the weights were all equal ( there was no region that was masked or of lower signal - to - noise ) then equation 4 simplifies to that given in our original equation 1 and @xmath21 becomes a unity matrix . as we introduce gaps into the spectra the off - diagonal components of @xmath21 become more significant .",
    "therefore , by correcting for the correlated nature of the eigenbasis we can determine the values of the expansion coefficients , @xmath5 that we would have derived had we had complete spectral coverage and no noise within the observed spectra . as such they are independent ( within the errors ) of the wavelength range over which we observe a galaxy and can be used to classify galaxy spectra taken over a wide range in redshift and with differing signal - to - noise .",
    "this enables an objective comparison of galaxy spectral types using the complete spectral information and free from the wavelength dependent selection biases that may be present in existing analyses .",
    "associated with the corrected expansion coefficients @xmath5 we can define a covariance matrix .",
    "this measures the uncertainty in the coefficients due to the correlated nature of the eigensystem .",
    "it is straightforward to show that the covariance between the expansion coefficients is simply , @xmath22 where @xmath23 .",
    "the size of the uncertainty in the expansion coefficients , after the correction , is proportional to the amount that the eigenbasis is correlated ( as we would expect ) . from this analysis",
    "we , therefore , have a correction for the effect of the gaps inherent within real spectra and a measure of the error on these derived values .",
    "given this approach we can not only derive the set of corrected coefficients for the classification of galaxy spectra , but we can also use these coefficients to reconstruct the regions of the spectra that are masked .",
    "this tells us that if a galaxy spectrum can be reproduced using a handful of components then the spectral features present within the data ( e.g.  the balmer series of absorption lines ) are correlated ( as we would expect from the physics ) .",
    "therefore , if we have sufficient spectral coverage to detect a feature in the spectrum we can predict the strengths of additional features where we have no data .",
    "the gappy kl analysis does this in a mathematically rigorous way , allowing the data themselves to define the inherent correlations .",
    "section 2 outlines the basic mathematical and physical reasoning behind the classification of galaxy spectra in the case of gappy data .",
    "we now consider the application of these techniques to spectral data . in order to be able to test our technique",
    ", we create an eigenbasis , using the gissel96 model spectral energy distributions of bruzual and charlot ( 1993 ) .",
    "we use a simple stellar population model with an instantaneous burst of star formation at zero age and sample the model spectra from 0 to 20 gyr . in total",
    "the sample contains 222 spectra covering the wavelength range 3500   to 8000   ( designed to approximate the spectral coverage of the sdss data ) .",
    "the choice of our particular bruzual and charlot model is somewhat arbitrary as we are only concerned in having a set of spectra that cover a wide range in age and for which we can control the uncertainties within the data .",
    "we construct the eigenbasis as described in connolly et al .  ( 1995 ) for the bruzual and charlot data after normalizing all spectra to unit scalar product .",
    "the diagonalization of the correlation matrix is undertaken using the singular value decomposition algorithms of the meschach package . in figure 1",
    "we show the first three eigenspectra and in figure 2 the corresponding sequence of eigenvalues .",
    "the size of the eigenvalue is directly related to the amount of variance ( or information ) contained within each of the eigenspectra .",
    "the eigenvalues decrease rapidly with the first three components containing 99.97% of the total system variance . by the tenth eigenspectrum the eigenvalue ( or variance of the system contained within this spectrum )",
    "is at the level of @xmath24 of a percent . using just the first three eigencomponents ( i.e.  truncating the expansion ) we should , therefore , be able to reconstruct any given spectrum to an accuracy of better than 0.05% .    considering these eigenspectra in turn , the first eigenspectrum is the mean spectrum and represents the ` center of mass ' of the bruzual and charlot sample of galaxy spectra .",
    "the second eigenspectrum has the spectral shape of an o star and describes the star formation component of the galaxy spectral energy distribution .",
    "the third component is a mixture of an old g or k star stellar population ( with a strong 4000   break ) and an intermediate age a star population ( with strong balmer lines ) . from the distribution of eigenvalues",
    "( see above ) a linear combination of these three stellar spectra can , therefore , reproduce the full range of the bruzual and charlot spectral energy distributions to a very high accuracy .",
    "if we project a galaxy onto this eigenbasis the expansion coefficients tell us the relative contributions of each of these components .",
    "this provides not only a classification of the galaxy but also a means of reconstructing the underlying spectrum .",
    "as we can reproduce the galaxy spectra with a small number of eigenspectra we should be able to use these components to interpolate over regions without data .    for the case of real spectra we might expect the kl reconstruction to require more than just the handful of eigencomponents that we need for the synthetic data ( e.g.  to account for the distinct spectral signatures of the small number of agn present within any spectroscopic survey ) .",
    "the techniques we will apply here should be equally applicable to real spectra given the provisos that the eigenbasis will provide a better reconstruction if it is built from similar types of galaxies and that the number of components required may be significantly larger ( with the associated increase in computational resources ) .",
    "as we have shown in section 2 a simple projection of a galaxy spectrum onto the eigenbasis will result in a biased set of expansion coefficients .",
    "if , however , we account for the gaps within the data , we can correct the expansion coefficients and use these values to estimate the underlying spectrum . in the following analysis",
    "we will consider the case of randomly positioned gaps within a galaxy spectrum .",
    "this is designed to simulate the effect of excluding spectral regions due to the position of sky lines or artifacts in a spectrograph .",
    "we initially assume that we know the underlying eigenbasis that describes the galaxy populations ( in section 6 we will expand this analysis to construct the eigenbasis itself from gappy data ) and we ignore the effect of noise .    in figure 3",
    "we take three representative spectra , a zero age spectrum an intermediate age spectrum ( 0.16 gyr ) and an old stellar population ( 20 gyr ) .",
    "each of these spectra has been drawn from the sample of 222 galaxies in the bruzual and charlot sample described above .",
    "for each of these three spectra we mask the wavelength range 3800   to 4000  .",
    "we project each spectrum onto the eigenbasis over the spectral range 3500   to 8000   ( excluding the masked region ) .",
    "we then correct these derived coefficients for the correlated nature of the eigenbasis ( i.e.  due to the masked regions ) .",
    "figure 3 shows the reconstruction of the galaxy spectra within the masked region , when using 3 and 5 eigencomponents respectively .",
    "the solid line shows the true spectrum and the dotted line the reconstruction . to compare the accuracy of the reconstruction as a function of galaxy type we define an error that is independent of the overall galaxy flux",
    "this error is given by the rms deviation between the reconstructed and `` true '' spectra ( over the masked region ) when both spectra are normalized by their scalar product to unity .    for three eigencomponents",
    "the reconstruction works well for the 0 gyr and 0.16 gyr galaxy spectra .",
    "the normalized rms deviation between the true spectrum and the reconstructed data is only 0.0016 .",
    "for the 20 gyr model the reconstructed spectrum produces the correct features present within the data ( i.e.  the absorption lines present in the true spectrum are found in the reconstruction ) but their relative amplitudes are inconsistent . over the masked spectral range",
    "the deviation between the reconstructed and true spectrum for this 20 gyr model is 0.018 , a factor of ten worse than the younger stellar types . given that we are deriving the interpolation based on three spectral components that are constructed over the full wavelength range 3500   to 8000   it is remarkable that we can reproduce the observed spectra to such high accuracy .",
    "if we incorporate a further two eigencomponents ( @xmath25 ) the reconstruction of the 20 gyr model is substantially improved .",
    "the deviation between the true and reconstructed spectrum falls to only 0.0045",
    ". the other two spectral types also show improvement in the interpolation though the magnitude of this improvement is not as dramatic as for that of the 20 gyr spectrum .",
    "the first three eigenspectra are , therefore , more sensitive to the spectral features ( both continuum and absorption lines ) of star forming and intermediate age galaxies .",
    "this is not entirely surprising as the bruzual and charlot models from which we construct the eigenbasis are dominated by these types of galaxies ( over 135 of the 222 spectra come from galaxies with ages less than 1 gyr ) .",
    "the eigenspectra will , therefore , be weighted more towards these younger galaxy spectra than to the more evolved stellar populations .      while the interpolation of galaxy spectra across narrow spectral intervals may be seen as relatively straightforward a more challenging",
    "problem is how to extrapolate a galaxy spectrum .",
    "the need for this will arise if we wish to project a galaxy spectrum onto an eigenbasis where the galaxy s wavelength coverage is only a subset of that of the eigenspectrum ( e.g.  the eigenspectra and galaxy are at different redshifts ) .    in figure 4 we demonstrate that the correction for gappy data can equally apply to the case of extrapolating a galaxy spectrum as well as for simple interpolation . for the 0 gyr , 0.16 gyr and 20 gyr galaxy spectra we exclude the wavelength range 7100   to 8000   and apply the kl reconstruction as described above . as before , the solid line shows the true spectrum and the dotted line the reconstructed spectrum . the left hand panel shows the reconstruction when using three eigencomponents and the right hand panel for five components .",
    "the 0 gyr , 0.16 gyr and 20 gyr spectra are all accurately reconstructed from three components .",
    "the rms uncertainty in the 0 gyr 0.16 gyr and 20 gyr spectra amount to 0.0016 , 0.0006 and 0.001 respectively .",
    "the 0 gyr and 20 gyr models are systematically offset by approximately 4% when using three eigencomponents . as found in section 3.1 increasing the number of eigenspectra used in the reconstruction improves the resulting spectra for all three galaxy types .",
    "the most marked improvement occurs for the 0 gyr and 20 gyr models where the deviation drops to less than 0.0002 .",
    "the results are , unsurprisingly , similar to those found for the case of simple interpolation .",
    "all three spectral types are well described by 3 eigencomponents . of these the 0 gyr and 20 gyr spectra",
    "have the largest errors . increasing the number of components used in the reconstruction reduces the dispersion between the true and corrected spectrum decreases .",
    "it is , therefore , clear that projecting a galaxy spectrum onto its eigenbasis gives a natural ( and optimal in the quadratic sense ) interpolation scheme .",
    "it utilizes the correlations inherent within the data to determine how individual spectral regions are related .",
    "projecting a galaxy onto its eigenbasis provides a very simple and natural classification scheme . as we have shown in section 3 the eigenspectra",
    "are highly correlated with stellar spectral types ( with the second and third eigenspectra correlating with o and k stellar spectral energy distributions ) . by projecting a galaxy spectrum onto this eigenbasis the expansion coefficients , @xmath5 ,",
    "will tell us the contribution of each of these eigenspectra to the overall spectral energy distribution .",
    "as has been shown previously , these expansion coefficients can then be used to separate galaxies into distinct spectral classes ( connolly et al .",
    "1995 , folkes et al . , 1996 , bromley et al . , 1998 ) .    in figure 5a",
    "we demonstrate this effect for the bruzual and charlot model .",
    "the solid line shows the distribution of the first two expansion coefficients , @xmath26 and @xmath27 as a function of galaxy age .",
    "the galaxies form a simple , one parameter distribution , that transitions from star forming galaxies ( bottom of the plot ) to quiescent , old stellar populations ( top of the plot ) .",
    "for the simple stellar population given by the bruzual and charlot model the correlation between expansion coefficients and galaxy age is extremely tight . in the case of real data",
    "we find that there is a much larger dispersion in the relation ( bromley et al . , 1998 )",
    ".    some of this dispersion may be due to the failure to correct for the gappy nature of real spectra . as we have shown in section 2 , when galaxy spectra are projected onto an eigenbasis without correcting for the gaps within the data the eigenbasis is no longer orthogonal .",
    "this means that the eigenspectra become correlated .",
    "the consequence of this is that the expansion coefficients are also correlated and any classification scheme based on gappy data will be biased .",
    "as we will show , the biasing of the expansion coefficients due to the gappy nature of the data does not just introduce a larger statistical uncertainty into any derived classification , it can also produce systematic errors .",
    "we initially consider the case of spectra with missing spectral regions due to the presence of sky lines or defects in the spectrograph ( as in section 3.1 ) .",
    "the gaps within the data will manifest as small wavelength regions where the galaxy spectrum must be masked or interpolated across .",
    "we simulate this using the bruzual and charlot data by excising ten randomly positioned spectral regions , each of 45   in width .",
    "the effect of this masking on the derived expansion coefficients is shown in figure 5a .",
    "the coefficients derived from the masked data are shown by crosses .",
    "masking of these spectral regions introduces a significant dispersion into the classification scheme . for the 10% masking adopted above",
    ", the dispersion in the classification correlation is approximately 0.03 in absolute number or a 3% error in terms of the sum of the square of the coefficients ( the coefficients sum , in quadrature , to unity due to the scalar product normalization ) .",
    "if we apply the corrections to the expansion coefficients as described in section 2 we can reconstruct the original unbiased coefficients . in figure 5a",
    "the corrected coefficients are shown by the filled ellipses .",
    "the size of the ellipses are defined by the three sigma errors on the corrected expansion coefficients as calculated from the variance analysis in equation 6 .",
    "we find that by applying the corrections to the coefficients we can recover the underlying true expansion coefficients and thereby derive an unbiased classification .",
    "a more important effect in terms of the classification of galaxies is the effect of redshift .",
    "when we analyze an ensemble of galaxies over a range of redshifts , the intrinsic rest wavelengths that we sample will be dependent on the redshift of the galaxy in question . in principle",
    "we could just consider those spectral regions that are in common to all galaxies within our sample . in practice , however , the wide range in redshifts that we will be faced with in the 2df and sdss surveys may result in very little wavelength overlap for galaxies at the extremes of the redshift distribution ( e.g.  the redshift distribution for the sdss is expected to have a significant tail of @xmath28 galaxies which would reduce the wavelength range common to all galaxies by @xmath2940% ) .    in figure",
    "5b we simulate the effect of redshift on the classification of galaxies .",
    "we assume that the galaxies are randomly distributed between redshifts of @xmath30 ( a conservative assumption ) and mask out those regions of the spectrum that lie beyond the 8000   cutoff ( see section 3 ) .",
    "the effect on the derived coefficients due to these censored data is shown by the crosses in figure 5b .",
    "in contrast to the effect of randomly positioned gaps within a galaxy spectrum ( which introduce a random scatter into the classification coefficients ) we find that the effect of redshift is to systematically bias the expansion coefficients .",
    "the first expansion coefficient , @xmath26 , is systematically over estimated by approximately 10% and the second component underestimated by approximately 25% .",
    "as before , the solid ellipses in figure 5b show the expansion coefficients once corrected for the missing spectral regions .",
    "the size of the points reflect the three sigma uncertainties in the corrected coefficients due to the variance determined from equation 6 .    therefore , if we apply the correction for the gaps within the observed data we can reproduce , to high accuracy , the underlying classification coefficients .",
    "given our current , conservative , simulation where we excise up to 1500   we can recover the true coefficients to an accuracy of better than 0.002 in absolute number or 0.2% .",
    "increasing the amount of data that we mask will naturally make the eigenspectra more correlated and the derived coefficients less accurate .",
    "in the previous sections we assumed that the observed galaxy spectrum was gappy but free of noise ( essentially assuming that the weight function was zero or unity ) .",
    "the general form of equation 2 enables us to extend these analyses to account for galaxy spectra in the presence of noise .",
    "we demonstrate here that the use of the kl expansion provides an optimal filtering of a noisy spectrum and that the correction for gaps within a spectrum is equally applicable in the presence of noise .    in the top panel of figure 6",
    "we show a 20 gyr spectrum with a signal - to - noise of approximately 5 per pixel ( the noise is constant as a function of wavelength ) .",
    "we project the spectrum onto the first three eigenspectra ( as derived in section 3 ) and determine the expansion coefficients . from this truncated expansion",
    "we can reconstruct the underlying galaxy spectral energy distribution .",
    "the reconstructed spectrum is shown in the lower panel of figure 6 ( dotted line ) together with the true , noise free , spectrum ( solid line ) .",
    "a comparison of the true and reconstructed spectra shows that they are consistent with a total deviation of 0.00039 .",
    "even given significant amounts of noise ( on a pixel level ) we can , therefore , reconstruct the underlying spectral energy distribution with a high level of accuracy .",
    "the reason the reconstruction reproduces the galaxy spectrum so accurately is straightforward to understand if we consider the integrated signal - to - noise of the full spectrum .",
    "if each galaxy can be reproduced by 3 - 5 eigencomponents then we can describe a galaxy spectrum by at most 5 numbers . in principle",
    "we should , therefore , only require 5 data points on a spectrum to constrain these eigencomponents ( in practice with only a small number of data points the eigenspectra become very correlated and the uncertainty in the derived expansion is large ) . even in the case of substantial noise ( per pixel ) we can co - add the pixels to reduce the overall noise on the expansion . applying this truncated expansion to real life observations",
    "provides an optimal ( in the least - squares sense ) filtering of the data and should provide a substantial improvement in signal - to - noise .    for the case of gaps within noisy spectra we can still reconstruct missing spectral regions . in figure 7",
    "we reproduce the analysis of section 3.1 for a 20 gyr spectrum .",
    "we exclude those data in the wavelength range 3800   to 4000   and reduce the input spectrum to a signal - to - noise of 5 ( per pixel ) .",
    "the noisy spectrum is then projected onto the first three eigenspectra and the expansion coefficients corrected for the correlated eigenbasis . using the first three eigenspectra we reconstruct the overall galaxy spectrum .",
    "the reconstructed spectrum is shown in figure 7 by a dotted line and the true spectrum by a solid line .",
    "the reconstruction is almost identical to that derived from the noise - free spectrum . in the region",
    "3800 to 4000   the deviation between the reconstructed spectrum using noisy data and the error free data is 0.019 ( comparable to the noise free case ) . combining",
    "the optimal filtering of the kl truncated expansion with the correction for gaps within the data we can , therefore , reproduce galaxy spectra at very high signal - to - noise .",
    "a natural application for this procedure is the filtering of low signal - to - noise data derived from spectroscopic redshift surveys . using the eigenbasis as a template for cross - correlation with the observed galaxy spectrum ( glazebrook et al .",
    "1998 ) and correcting for the bias in the classification coefficients we can derive an optimal representation of the underlying spectrum , an estimate of the significance of the correlation and a measure of the classification coefficients ( which describe how closely the galaxy is related to the overall distribution of galaxy spectral types ) .",
    "this latter information is a quality assurance test .",
    "if the classification coefficients do not lie within the general distribution then the galaxy in question has either an unusual spectral type ( worth further study ) or there is a miss - match in the classification ( and the redshift is probably incorrect ) .",
    "how well we will be able to classify and repair galaxy spectra will ultimately be limited by how we construct the eigenbasis itself .",
    "if the type of galaxies that we construct the eigenspectra from do not fully sample the population of galaxies to which we wish to apply the classification then there could be a significant mismatch between the spectral properties of the eigentemplates and the galaxies being reconstructed ( e.g.  if we tried to use normal galaxy spectra to classify qsos and agns then the reconstruction would be poor ) .",
    "this problem can , however , be overcome by building the eigenbasis using a subset of galaxies that are selected to evenly sample the distribution of galaxy types rather than being weighted by the relative strengths of the different galaxy populations . even without this approach",
    "the residuals between the observed and reconstructed spectra ( within those spectral regions that contain valid data ) will provide a measure of how well the eigenbasis can describe a particular galaxy spectrum and , consequently , whether the classification is valid .",
    "by correcting for the gaps within galaxy spectra we have derived a simple mechanism for classifying galaxies ( and interpolating across the regions of missing data ) that can be applied to spectra that do not fully overlap .",
    "we can now extend the analysis to constructing an eigenbasis from gappy data .",
    "the earlier derivation assumed that we knew what the underlying eigenbasis should be .",
    "we also assumed that the eigenspectra are well constrained over the full spectral range that the galaxies cover .",
    "this is a feasible proposition if we use spectral synthesis models to derive a set of eigenspectra and then project observed galaxy spectra onto this basis .",
    "this has the advantage that one can relate the coefficients directly to the physical properties of the models ( e.g.  age or metalicity ) .",
    "its disadvantage is that we know that the spectral synthesis models can not yet reproduce the observed colors of galaxies ( particularly at high redshift ) and so may not describe fully the spectral properties of all galaxy populations . secondly , the models are generally derived from intermediate resolution spectra ( with a dispersion of @xmath2910  ) while the new generation of spectroscopic surveys will have a substantially higher resolution ( e.g.  3   for the sdss )",
    ". therefore , by restricting ourselves to model spectra we may miss important physical information present within the spectral data .",
    "in an ideal case we would want to build the set of eigenspectra directly from the observed spectra .",
    "in such a way the data for the eigenbasis and galaxies that we wish to classify would be taken through the same optical system and have the same intrinsic resolution . unfortunately , relying on observations means that we must construct a set of eigenspectra from data that have different restframe spectral coverage ( due to the redshift of the galaxies ) and gaps within the spectra ( e.g.  from the removal of sky lines ) .",
    "if the galaxies occupy a range of redshifts then missing spectral regions will occur at different rest wavelengths .",
    "therefore , for a large ensemble of galaxies over a range of redshifts , all spectral regions will be sampled by a number of galaxies and the eigenspectra can be constructed over the superset of wavelengths that the galaxies cover .    to build the eigenbasis we take an iterative approach in a manner analogous to that described in everson and sirovich ( 1995 ) . after shifting all galaxy spectra to their restframe we linearly",
    "interpolate across all gaps within the spectra .",
    "this gives the zeroth order correction for each spectrum , @xmath31 . from these corrected data we build the eigenspectra , @xmath32 , and",
    "project each of the individual spectra onto this basis .",
    "after correcting the expansion coefficients for the gappy nature of the projection we can use the kl basis @xmath32 to interpolate across the regions of missing data and form a first order corrected spectrum , @xmath33 .",
    "this procedure continues until convergence .",
    "the iterative technique used to construct the eigenbasis and then repair the galaxy spectra is shown in figure 8 .",
    "each galaxy used to create the eigenbasis has had 10 gaps of 100   randomly positioned within the spectrum . from this gappy data set",
    "we undertake the iterative procedure outline above .",
    "figure 8 shows the spectrum of a 2 gyr old galaxy for the wavelength range 3500   to 4500  . within this spectrum the wavelength range 3900   to 4000",
    "  has been masked out .",
    "the series of panels show how the reconstruction of this masked region improves as we iteratively improve the underlying eigenbasis ( with the true spectrum shown as a solid line and the reconstruction by a dotted line ) .",
    "figure 8a shows the initial linear interpolation across the spectral region 3900   to 4000   from which the zeroth order eigenbasis , @xmath34 is constructed .",
    "the rms dispersion between the true spectrum and the linearly interpolated reconstruction is 0.019 ( which should be treated as the fiducial mark against which all other reconstruction techniques are applied ) .",
    "the first order correction , @xmath33 ( for 3 eigencomponents ) is shown in figure 8b . at this point",
    "the rms dispersion between the true and reconstructed spectra has already fallen to 0.0095 . for a reconstruction using 3 eigencomponents",
    "the procedure converges rapidly with a difference between subsequent iterations of @xmath35 by the fifth iteration ( see figure 8c ) . at this stage",
    "the reconstruction is stable with an rms uncertainty of 0.0077 ( comparable to the values we derived when we knew the underlying eigenbasis ) .",
    "we can , therefore , increase the number of components used in the reconstruction ( to improve the eigenbasis and the interpolation ) .",
    "figure 8d shows this effect where , after iterating five times using 3 components , we increase the number of eigenspectra to five .",
    "the dispersion between the reconstructed and true spectrum falls to 0.0013 with five components .",
    "the number of iterations and components used in the construction is dependent on the information present within the data . with the bruzual and charlot models",
    "the galaxy spectra can be reconstructed to an accuracy of less than 1% using only 5 eigencomponents . for real spectra",
    "we would expect the number of components to be dependent on the spectral resolution of the data and the intrinsic wavelength coverage .",
    "we have described a general framework for undertaking spectral classification of galaxy spectra , accounting for gaps within the data and different intrinsic rest wavelength coverage .",
    "it is expected that when this technique is applied to galaxy spectra from the next generation of spectroscopic surveys ( such as the sdss and 2df ) we will have a mechanism for measuring the spectral evolution of galaxies in terms of a common classification scheme that is almost independent of redshift .",
    "standard techniques for classifying galaxy spectra using eigenspectra have either ignored the effect of gaps within the data or restricted their analysis to wavelengths that are common to all galaxies within their sample . for the next generation of redshift surveys we can expect the redshift distribution of the galaxies to be broad and , if we were to restrict our analysis to common wavelengths , the available spectral range on which we could classify a galaxy to be very small .",
    "our technique alleviates this problem .",
    "it allows a single eigenbasis to be derived over a very broad intrinsic wavelength range ( from the data themselves ) and the classification of the galaxy spectra to be corrected for the incomplete coverage .",
    "the derivation of the covariance matrix for this correction enables us to determine both a classification and a measure of the uncertainty on this parameter .",
    "we expect that this classification technique will be equally applicable to continuum subtracted data ( i.e.  absorption line spectra ) as it is to the spectrophotometric data we analyze here .",
    "the number of eigenspectra required to classify or reconstruct a galaxy spectrum will be dependent on the quality of the data ( i.e.resolution and signal - to - noise ) and the overall wavelength coverage .",
    "as noted previously the immediate application of this technique will be to measuring redshifts from local and high - redshift spectroscopic surveys .",
    "the analysis we describe provides an optimal noise suppression that , when combined with the redshift determination , will produce a high signal - to - noise representation of noisy and incomplete data together with an associated error estimate . in a following paper ( connolly and szalay 1999 )",
    "we describe the implementation of our techniques for constructing spectral energy distributions and classifying galaxy spectra using redshift survey data .",
    "the application of this technique to astrophysical problems is , however , substantially more general than providing corrections to galaxy classification .",
    "it can equally well be applied to galaxy broadband photometry ( csabai et al .",
    "1998 ) or a combination of spectrophotometry and photometry . in the next few years ground- and space - based instrumentation will provide broadband photometry and spectroscopy for large samples of galaxies covering wavelengths from the ultraviolet through to the far - infrared .",
    "the generalization of the construction of galaxy eigenspectra from noisy data and for spectra that do not have complete spectral coverage will enable us to construct a composite eigenbasis , and consequently composite galaxy spectral energy distributions , that cover a broad spectral range .",
    "the use of a principal component analysis or kl transform to classify galaxy spectra is becoming a standard technique in the analysis of spectroscopic survey data .",
    "the current applications of this approach have assumed that the galaxies we wish to classify and the eigenbasis we will use for the classification cover the same wavelength range . for real data this will clearly not be the case .",
    "sky lines that are masked out of spectra and changes in rest wavelength coverage due to the redshift of a galaxy will all introduce gaps into the spectra .",
    "unless we correct for this effect we will introduce systematic errors into our classification scheme . in this paper",
    "we derive a generalized form for the kl classification that accounts for the presence of gaps within galaxy spectra .",
    "we show that applying this technique to simulated spectra we can determine a robust classification of galaxy spectra ( together with an error ) that is relatively insensitive to the redshift of the galaxy in question .",
    "we would like to thank istvan csabai for many useful discussions on the application and interpretation of the gappy kl analysis and the anonymous referee for comments that helped clarify the technical discussion .",
    "we acknowledge partial support from nasa grants ar-06394.01 - 95a and ar-06337.11 - 94a ( ajc ) and an ltsa grant ( asz ) . the svd analysis was undertaken using the meschach library of linear algebra algorithms from stewart and leyk .",
    "bromley , b.c . , press , w.h .",
    ", lin , h. & kirshner , r. , 1998 , apj 505 , 25 bruzual , a.g .",
    "& charlot , s. , 1993 , apj , 405 , 538 connolly a.j . ,",
    "szalay a.s . ,",
    "bershady m.a .",
    ", kinney a.l . & calzetti d. , 1995 , aj , 110 , 1071 connolly , a.j . &",
    "szalay , a.s . , 1996 , to appear in new horizons from multi - wavelength sky surveys , iau symposium no.179 .",
    "connolly , a.j . &",
    "szalay , a.s . , 1999 , in preparation csabai , i. , connolly , a.j . ,",
    "szalay , a.s . & budavari , t. , in preparation everson r. , and sirovich l. , 1995 , j. opt .",
    "a. , 12 , 8 folkes , s. , lahav , o. & maddox , s.j . , 1996 , mnras , 283 , 651 francis , p.j . , hewett , p.c . ,",
    "foltz , c.b . & chaffee , f.h . , 1993 , , 398 , 476 galaz , g. & de lapparent v. , 1998 , a&a , 332 , 459 glazebrook , k. , offer , a.r .",
    "& deeley , k. , 1998 , apj , 492 , 98 karhunen , h. , 1947 , ann .",
    "science fenn , ser .",
    "37 love , m. , 1948 , processus stochastiques et mouvement brownien , hermann , paris , france maddox s.j . , 1998 , `",
    "large scale structure : tracks and traces ' , world scientific , in press ronen , s. , aragn - salamanca , a. & lahav , o. , 1998 , mnras submitted singh , h.p . ,",
    "gulati , r.k . & gupta , r. , 1998 , mnras , 295 , 312 sodre , l. & cuevas , h. , 1997 , mnras , 287,137"
  ],
  "abstract_text": [
    "<S> over the next few years new spectroscopic surveys ( from the optical surveys of the sloan digital sky survey and the 2 degree field survey through to space - based ultraviolet satellites such as galex ) will provide the opportunity and challenge of understanding how galaxies of different spectral type evolve with redshift . </S>",
    "<S> techniques have been developed to classify galaxies based on their continuum and line spectra . </S>",
    "<S> some of the most promising of these have used the karhunen and love transform ( or principal component analysis ) to separate galaxies into distinct classes . </S>",
    "<S> their limitation has been that they assume that the spectral coverage and quality of the spectra are constant for all galaxies within a given sample . in this paper </S>",
    "<S> we develop a general formalism that accounts for the missing data within the observed spectra ( such as the removal of sky lines or the effect of sampling different intrinsic rest wavelength ranges due to the redshift of a galaxy ) . </S>",
    "<S> we demonstrate that by correcting for these gaps we can recover an almost redshift independent classification scheme . from this classification </S>",
    "<S> we can derive an optimal interpolation that reconstructs the underlying galaxy spectral energy distributions in the regions of missing data . </S>",
    "<S> this provides a simple and effective mechanism for building galaxy spectral energy distributions directly from data that may be noisy , incomplete or drawn from a number of different sources .    </S>",
    "<S> # 1 </S>"
  ]
}