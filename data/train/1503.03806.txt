{
  "article_text": [
    "measuring the spectra of exoplanetary atmospheres gives us a window into their thermal structure and chemical compositions @xcite .",
    "a crucial bridge between observation and inference is the use of theoretical models of atmospheric radiation , both in the form of  forward models \" that adopt a set of fixed assumptions ( e.g. , solar composition ) and retrieval models that attempt to invert for various properties from the data . in both families of models",
    ", one needs to compute synthetic spectra , which in turn requires the computation of the opacity function of the atmosphere .    to achieve a high degree of accuracy , it is desirable to perform  line - by - line \" calculations , where every spectral line in the range of wavelengths considered , for a given molecule ( e.g. , water ) , is directly included either in the process of solving for radiative equilibrium ( in forward models ) or a multi - parameter search for an optimal solution based on a comparison to data ( in retrieval models )",
    ". such an approach may be readily adopted at low temperatures , but at the high temperatures ( @xmath63000 k ) of the exoplanetary atmospheres currently amenable to characterisation by astronomy , it becomes infeasible as the number of spectral lines involved increases by orders of magnitude .",
    "for example , the hitran database lists @xmath0 lines for the water molecule , but is only valid up till temperatures of about 800 k. at higher temperatures , millions of weak lines become important and the total number of lines involved increases to @xmath7 ; the hitemp database needs to be used instead . line - by - line calculations become expensive or even prohibitive as one attempts to explore the broad parameter space occupied by exoplanetary atmospheres .",
    "furthermore , in studies where line - by - line calculations are claimed , it is not always clear that sufficient resolution has been devoted to computing the @xmath8 lines of the opacity function for hot exoplanetary atmospheres . as different combinations of molecules ,",
    "temperature and pressure are considered , the problem becomes computationally intractable .",
    "k and @xmath9 atm @xmath10 bar .",
    "top panel : opacity function using spectroscopic quantities from the hitemp database . shown",
    "are calculations using the full voigt function and with an ad hoc line - wing cutoff of @xmath11 .",
    "middle panel : k - distribution functions for the three wavenumber different regions of the opacity function .",
    "bottom panel : transmission function corresponding to the three wavenumber regions , both with and without the voigt line - wing cutoff.,title=\"fig : \" ]   k and @xmath9 atm @xmath10 bar .",
    "top panel : opacity function using spectroscopic quantities from the hitemp database . shown",
    "are calculations using the full voigt function and with an ad hoc line - wing cutoff of @xmath11 .",
    "middle panel : k - distribution functions for the three wavenumber different regions of the opacity function .",
    "bottom panel : transmission function corresponding to the three wavenumber regions , both with and without the voigt line - wing cutoff.,title=\"fig : \" ]   k and @xmath9 atm @xmath10 bar .",
    "top panel : opacity function using spectroscopic quantities from the hitemp database . shown",
    "are calculations using the full voigt function and with an ad hoc line - wing cutoff of @xmath11 .",
    "middle panel : k - distribution functions for the three wavenumber different regions of the opacity function .",
    "bottom panel : transmission function corresponding to the three wavenumber regions , both with and without the voigt line - wing cutoff.,title=\"fig : \" ]    in the earth and planetary sciences , a well - worn strategy for dealing with an enormous number of lines is the method of  k - distribution tables \" and not  k \" , following the convention in some parts of the astrophysics literature .",
    "however , to preserve tradition we will retain the name ",
    "k - distribution \" . ] @xcite .",
    "the essence of the method is to perform lebesgue , instead of riemann , integration @xcite , when integrating over the opacity function of the atmosphere to determine if it is transparent or opaque within a given spectral window . instead of integrating over the opacity function itself , which is computationally unwieldy as it is hardly a smooth and predictable function ,",
    "one recasts it into its cumulative counterpart  a smooth , monotonically increasing and computationally pleasing function .",
    "this cumulative function may then be used to compute the transmission function : it is the fraction of radiation passing from one layer of the atmosphere to the next within a given spectral window .",
    "figure [ fig : main ] shows an example of this process .",
    "the cumulative counterpart of the opacity function is known as the  k - distribution function \" .",
    "the term  k - distribution table \" is commonly used , because this cumulative function may be tabulated beforehand and then used to perform integrations in forward models of radiative transfer ( e.g. , @xcite ) , retrieval models ( e.g. , @xcite ) and three - dimensional simulations of atmospheric circulation ( e.g. , @xcite ) .",
    "nevertheless , several physical and computational issues remain either unelucidated or poorly elucidated within the literature , which provide the motivation behind the current study .",
    "our main , physical conclusion is that _ physical _ ( and not computational ) uncertainties associated with the wings of spectral lines dominate the error budget .",
    "our technical contribution is an ultrafast , open - source computer code to compute the opacity function using modern computing methods and architectures .",
    "consider an arbitrary function @xmath12 , where @xmath13 is the wavenumber normalized by the entire range considered .",
    "we wish to evaluate the integral over the range @xmath14 , @xmath15",
    "imagine that @xmath12 may be recast as @xmath16 such that the quantity @xmath17 is the fractional area under the curve that satisfies @xmath18 , where @xmath19 is an arbitrary value of the function .",
    "then , the same integral may be evaluated as @xmath20 practically all of the functions we encounter in astrophysics may be integrated using this alternative expression .",
    "more generally , we have @xmath21 where @xmath22 is the fractional cumulative distribution function of another arbitrary function , @xmath23 , that satisfies @xmath24 and @xmath25 is an arbitrary value of @xmath26 . in other words",
    ", @xmath22 gives the fractional area under the curve corresponding to @xmath24 .",
    "we make these concepts less abstract by applying them to an atmosphere . in the simplest case ,",
    "suppose that @xmath27 , where @xmath28 is the opacity function ( with units of @xmath29 g@xmath30 ) .",
    "it follows that @xmath31 .",
    "the quantity @xmath32 is the cumulative sum of intervals .",
    "as expected , one gets the same answer whether one evaluates @xmath33 or @xmath34 .",
    "a more useful example considers @xmath35 where @xmath36 is the column mass , since the transmission function , @xmath37 is a quantity that is indispensible for computing synthetic spectra ( e.g. , @xcite ) .",
    "the transmission function is commonly integrated over some wavelength range and is the degree or transparency ( or opaqueness ) of this spectral window .",
    "for example , in a purely absorbing atmosphere the flux passing from one layer to another is given by @xmath38 , where @xmath39 is the flux from the previous layer and @xmath40 is the planck function ( e.g. , @xcite ) .",
    "the second equality in equation ( [ eq : transmission ] ) obtains from expressing the cumulative sum of intervals as @xmath41 we will refer to @xmath42 as the  k - distribution function \" .",
    "the k - distribution method is exact for a homogeneous atmosphere , which almost never happens in practice . for an inhomogeneous atmosphere ,",
    "the opacity changes with the temperature and pressure and we have @xmath43 } ~dx \\\\ & \\ne \\int^1_0 \\exp{\\left [ -\\int \\kappa\\left(y\\right ) ~d\\tilde{m } \\right ] } ~dy .",
    "\\end{split } \\label{eq : corr_k}\\ ] ]    that the k - distribution method can not be used for an inhomogeneous atmosphere may be illustrated using the example of a two - layered atmosphere .",
    "each layer has its own opacity function and column mass ( subscripted by  1 \" and  2 \" ) and the transmission function is @xmath44 } ~dy_1 \\\\ & + \\int^1_0 \\exp{\\left [ - \\kappa_1\\left(y_2\\right ) \\tilde{m}_1 -\\kappa_2\\left(y_2\\right ) \\tilde{m}_2 \\right ] } ~dy_2 \\\\ \\ne & 2 \\int^1_0 \\exp{\\left [ - \\kappa_1\\left(y\\right ) \\tilde{m}_1 -\\kappa_2\\left(y\\right ) \\tilde{m}_2 \\right ] } ~dy .",
    "\\end{split } \\label{eq : transfunc}\\ ] ] that there are two integrals originates from having @xmath45 and @xmath46 also , we have @xmath47    the non - equality in equation ( [ eq : transfunc ] ) derives from the fact that _ even identical ranges of values in @xmath48 and @xmath49 generally correspond to different ranges of wavenumbers_. for example , @xmath50 and @xmath51 are cumulative functions constructed from their own cumulative sum of intervals . by contrast , @xmath52 and @xmath53 are cumulative functions constructed from the cumulative sum of intervals of their counterparts , meaning that the contributions are drawn from different wavenumber intervals even at the same value of the cumulative sum of intervals . generally , we expect these four cumulative functions to have different functional forms .",
    "this peculiar property is an unavoidable consequence of working with cumulative functions .",
    "_ physically , in employing the k - distribution method , the price being paid is that the wavenumber information has been scrambled . _ if one _ assumes _ that @xmath54 , then one is making the  correlated - k approximation \" and the transmission function may then be computed as a single integral across @xmath17 .",
    "it is the assumption that each value of the cumulative opacity function is always drawn from the same wavenumber interval .",
    "the mathematics behind the reasoning is identical in the case of applying the correlated - k approximation to a homogeneous atmosphere with multiple atoms or molecules . for illustration , consider only two molecules and a single value of the column mass .",
    "let the mixing ratios ( relative abundance by number ) of the molecules be @xmath55 and @xmath56 .",
    "we then have @xmath57 } ~dy_1 \\\\ & + \\int^1_0 \\exp{\\left [ - x_1 \\kappa_1\\left(y_2\\right ) \\tilde{m } - x_2 \\kappa_2\\left(y_2\\right ) \\tilde{m } \\right ] } ~dy_2 \\\\ \\ne & 2 \\int^1_0 \\exp{\\left [ - x_1 \\kappa_1\\left(y\\right ) \\tilde{m } - x_2 \\kappa_2\\left(y\\right ) \\tilde{m } \\right ] } ~dy .",
    "\\end{split}\\ ] ] here , the fact that we have two integrals comes from having @xmath58}$ ] and @xmath59 also , we have @xmath60 we have intentionally written things out explicitly to illustrate the fact that one can avoid dealing with two integrals if a single , total opacity function is constructed first ( @xmath61 ) _ before _ its cumulative function is computed .    again , unless @xmath62 , the two integrals can not be combined .",
    "since this reasoning holds for multiple molecules in a homogeneous atmosphere , it must also hold for multiple molecules in an inhomogeneous atmosphere .",
    "we conclude that one needs to first add the opacities of the various molecules in an atmosphere , weighted by their relative abundances , prior to constructing the cumulative function of the opacity .",
    "if one adds the cumulative opacity functions of different molecules , then one is effectively employing the correlated - k approximation",
    ".    both lines of reasoning can be straightforwardly generalised to an inhomogeneous atmosphere containing a single atom or molecule and with @xmath63 layers , a homogenous atmosphere with @xmath63 atomic or molecular species , or an inhomogeneous atmosphere with an arbitrary number of layers and species .",
    "a common source of confusion in the literature is the failure to distinguish the method ( k - distribution ) from the approximation ( correlated - k ) .",
    "for example , the  correlated - k method \" is a misnomer .",
    "consider equal intervals in @xmath13 and let the interval be denoted by @xmath64 .",
    "such a uniform grid in @xmath13 generally leads to a non - uniform grid in @xmath65 .",
    "its virtue is that it reduces our problem to one of sorting and ordering , since every value of @xmath65 is associated with @xmath64 ( and we do not have to keep track of changing values of the interval ) . for a fixed value of the opacity ( @xmath66 ) ,",
    "we count the number of points that satisfy @xmath67 .",
    "if @xmath68 points are counted , then we have @xmath69 where @xmath70 is the range of @xmath13 being considered .",
    "we also have @xmath71 , where @xmath72 is the total number of intervals in @xmath13 .",
    "it implies that the interval in @xmath17 is also equal , @xmath73    by running through all possible values of @xmath66 , one constructs @xmath42 . since @xmath42 is a monotonic function that is typically smoother than @xmath65 , it may be resampled and defined over a much smaller number of points , @xmath74 .",
    "it is then used to calculate @xmath75 for any value of @xmath36 .",
    "the opacity function is a product of two quantities : the integrated line strength ( @xmath76 ) and the line profile or shape ( @xmath77 ) @xcite , @xmath78 the integrated line strength depends only on the temperature ( @xmath79 ) , while @xmath77 depends on both temperature and pressure ( @xmath80 ) .",
    "note that some references collectively refer to opacities ( with units of @xmath29 g@xmath30 ) , cross sections ( with units of @xmath29 ) and absorption coefficients ( with units of cm@xmath30 ) as  absorption coefficients \" ( e.g. , appendix 2 of @xcite ) .",
    "only when @xmath28 is an actual opacity is @xmath82 with no dependence on pressure .    by invoking the principle of detailed balance and local thermodynamic equilibrium , one obtains @xcite , @xmath83,\\ ] ] where @xmath84 is the statistical weight of the upper level ( of a given line transition ) , @xmath85 is the einstein a - coefficient , @xmath86 is the speed of light , @xmath87 is the wavenumber",
    ", @xmath88 is the mean molecular mass , @xmath89 is the partition function , @xmath90 is the energy difference associated with the line transition , @xmath91 is boltzmann s constant and @xmath92 is planck s constant .",
    "the partition function relates the number density associated with an energy level with the total number density and is a function of @xmath79 .    in practice ,",
    "a more useful expression for the integrated line strength is @xcite , @xmath93 where all of the quantities subscripted with a  0 \" are specified at a reference temperature , @xmath94 .",
    "the hitran @xcite and hitemp @xcite databases provide tabulated values of all of the quantities needed to construct @xmath76 using @xmath95 k.    the voigt profile is the convolution of the lorentz and the doppler profiles ( e.g. , @xcite ) , @xmath96 where @xmath97 is the half - width at half - maximum of the doppler profile , @xmath98 is the line - center wavenumber , @xmath99 is the damping parameter and @xmath100 .",
    "our definitions for @xmath101 , @xmath102 and @xmath103 depart slightly from the traditional ones in order to be consistent with @xcite .",
    "we have included the effects of pressure broadening within our definition of the half - width of the lorentz profile @xcite , @xmath104,\\ ] ] where the first term after the equality is typically subdominant .",
    "pressure broadening is included via an empirical fit @xcite , whose fitting parameters ( @xmath105 , @xmath106 and @xmath107 ) are given by hitran and hitemp .",
    "the reference pressure is @xmath108 atm @xmath10 bar .",
    "the subscripts  air \" and  self \" represent air- and self - broadening , respectively . for illustration",
    ", we assume that they are present in equal proportions ( @xmath109 )",
    ". we also account for a pressure - induced shift ( @xmath110 ) of the central wavenumber , @xmath111 where @xmath110 is again a tabulated quantity in hitran and hitemp .",
    "the data for @xmath110 is usually sparse .",
    "there are two challenges associated with the voigt profile .",
    "the first challenge is computational : it is difficult to evaluate efficiently as it is an indefinite integral .",
    "furthermore , we have to compute the voigt profile multiple times for every line and there is an enormous number of lines .",
    "to this end , we implement algorithm 916 , which was originally written for ` matlab ` @xcite .",
    "the essence of the algorithm is to first recast @xmath112 as the real part of the ( complex ) faddeeva function and proceed to express it in terms of cosines , sines , a scaled complementary error function and several series expansions , as stated in equations ( 13 ) , ( 15 ) , ( 16 ) and ( 17 ) of @xcite .",
    "the exponential terms in the series expansions are the bottleneck in terms of computational cost ; @xcite optimise this process by combining the three series evaluations within a single loop .",
    "it turns out that algorithm 916 is efficient only for small values of @xmath102 and @xmath103 . for @xmath113",
    ", we implement third - order gauss - hermite quadrature to compute @xmath112 as stated in equation ( 8) of @xcite . for @xmath114 , we switch from third- to first - order gauss - hermite quadrature @xcite .",
    "table 1 of @xcite provides more details on the integration methods used as a function of @xmath102-@xmath115 space . our criteria for switching between the three computational methods",
    "is loosely based on @xcite and verified by testing and trial - and - error .",
    "the second challenge is physical : the lorentz , and hence the voigt , profile over - estimates the far wings of the line profile due to pressure broadening ( see @xcite and references therein ) .",
    "even what  far \" actually means is not well understood .",
    "although this issue dominates the error budget , it is either treated as an ad hoc cutoff ( in wavenumber ) in the line wings ( e.g. , @xcite ) , described qualitatively as a problem with no explicit cutoff being specified ( e.g. , @xcite ) or simply left unmentioned ( e.g. , @xcite ) .",
    "it is our hope that this issue will be acknowledged more explicitly and transparently in future studies involving atmospheric radiative transfer and retrieval .    in the current study",
    ", we do not attempt to solve this physics problem , which requires a detailed quantum mechanical calculation . in the absence of a complete , first - principles theory , we instead compare calculations with the full voigt profile versus those with some arbitrary line - wing cutoff specified , which we nominally take to be 500 lorentz widths .",
    "we emphasize that there is no sound physical reason behind choosing this particular cutoff .",
    "it is merely used as a proof - of - concept comparison against calculations utilizing the full voigt profile .",
    "we develop our custom - built code ( ` helios - k ` ) using the native language of the nvidia gpus , ` cuda ` ( compute unified device architecture ) , which is basically an embellished version of the ` c ` programming language @xcite . a major advantage provided by",
    "a gpu is the large number of computational cores per card ( @xmath116 ) for a very low cost ( @xmath117 per core ) . when compared head - to - head , a single gpu will always lose out against a single cpu in terms of both computational power and memory  the point is that one wins by throwing many , many more gpu cores at the problem .",
    "a set of 32 consecutive threads is called a  warp \" and it is crucial that every warp performs exactly the same operation in order to optimise performance . if not , a  branch divergence \" occurs and some operations are performed in serial operation mode .",
    "each calculation is performed on a thread and all of the threads are organised into blocks .    an indispensible part of writing ultrafast ` cuda ` code is to understand the memory design and types on a gpu .",
    "global or device memory is the most abundant and can be accessed by every thread , but is generally the slowest type .",
    "shared memory is faster , but may only be accessed by threads within the same block .",
    "typically , a well - written ` cuda ` kernel ( usually called a  function \" in other languages ) reads data from global into shared memory , performs the necessary arithmetic operations and writes back to global memory .",
    "another bottleneck is the passing of information ( communication ) between the cpu and gpu .",
    "exploiting the order - of - magnitude speed - ups a gpu has to offer is an exercise in shrewd memory and communication management . rather than describe each and every computing trick we used , we highlight the main ones and refer the reader to our open - source code .    for our application , we need to compute the voigt profile for an enormous number of spectral lines across an even larger number of grid points in wavenumber . furthermore , we need to repeat this calculation for multiple combinations of temperature and pressure .",
    "it is impossible to perform this computation in a single step , but we may perform a serial loop across the lines and parallelise across wavenumber .",
    "this allows us to accumulate values of @xmath65 directly within a register ( i.e. , fastest available memory ) without additional write - outs to global memory .",
    "parallel sorting on a gpu is a non - trivial task .",
    "fortunately , this has already been implemented as part of the ` cuda ` library ( ` https://developer.nvidia.com/thrust ` ) .",
    "once we have computed @xmath65 , the challenge is to perform the sorting within each bin .",
    "each bin has a width @xmath118 and the number of bins typically used is @xmath2@xmath3 .",
    "sorting each bin in a serial fashion would be inefficient when the number of bins becomes large .",
    "instead , we sort the entire opacity function all at once , but keep track of the bin number each opacity point belongs to , which ultimately allows us to reconstruct @xmath42 in the individual bins .",
    "once we have sorted @xmath65 and obtained @xmath42 , we wish to resample @xmath42 such that it is defined using a much smaller number of points ( by orders of magnitude ) .",
    "numerous resampling strategies exist , including least - squares fitting , fast fourier transforms , etc .",
    "we find that using a least - squares fit with chebyshev polynomials gives the best outcome in terms of accuracy and efficiency , especially since one may exploit the recurrence relations to generate chebyshev polynomials of different orders .",
    "we perform the fit on @xmath119 to avoid numerical oscillations .",
    "the least - squares fitting essentially involves solving @xmath120 for the vector of chebyshev coefficients ( @xmath121 ) , where @xmath122 is the data vector . directly computing",
    "the inverse of the matrix @xmath123 is expensive ; instead , we implement  q - r decomposition \" to obtain @xmath121 @xcite .",
    "the final product of this step is a set of 20 chebyshev coefficients describing @xmath42 for each bin .",
    "unless otherwise stated , our results are based on computing a pure - water opacity function using the hitemp line list , which consists of @xmath7 spectral lines of water .",
    "we emphasize that this is a proof of concept and that ` helios - k ` may be used for general mixtures of atoms and molecules .",
    "we base the discussion of our results on a fiducial setup .",
    "we focus on computing the opacity function for the water molecule , since it has the most lines among the major molecules expected ( compared to co and co@xmath124 ) and has the least controversial line list available ( compared to ch@xmath125 ) . in figure",
    "[ fig : main ] , we show two instances of the opacity function : one computed using the full voigt profile and the other with a line - wing cutoff applied .",
    "we divide the wavenumber region into three equal ranges : 0.58573.5 cm@xmath30 ( infrared to near - infrared ; @xmath126 @xmath127 m ) , 8573.517146.5 cm@xmath30 ( near - infrared to optical ; 0.61.2 @xmath127 m ) and 17146.525719.5 cm@xmath30 ( optical ; 0.40.6 @xmath127 m ) .",
    "each bin has a width of @xmath128 cm@xmath30 . within each bin",
    ", we adopt a resolution of @xmath129 ; we will demonstrate later that this attains convergence .",
    "our results point to the same qualitative conclusions even when more bins are used ( not shown ) .",
    "it is readily apparent that the choice of cutoff is a significant source of error in the near - infrared and optical , because it affects the weak lines more strongly , even prior to the mapping of the opacity function to its k - distribution counterpart .",
    "we emphasize that this problem remains , regardless of whether the k - distribution method is used .",
    "for the k - distribution function and the transmission function , the influence of the choice of line - wing cutoff is seen to be significant .",
    "we will investigate this issue in more detail .",
    "a necessary , intermediate step to check is whether the resampling of the k - distribution function using least - squares fitting introduces a significant source of error to our results . in figure",
    "[ fig : resampling ] , we compute the transmission function in two ways : using the direct output from the mapping of @xmath65 to @xmath42 and the resampled @xmath42 . the difference between the two calculations",
    "is typically @xmath130 when @xmath131 .",
    "remarkably , resampling is not a significant source of error independent of the value of the column mass , i.e. , it is equally robust in both optically thin and thick parts of the atmosphere .      even though convergence within each bin is tied to the number of lines present , we find that an easier rule of thumb is to use a minimum value of @xmath72 as a convergence criterion .",
    "figure [ fig : resampling ] shows that convergence is comfortably attained for @xmath132 .",
    "this conclusion holds even when 1000 bins are used ( not shown ) .       and",
    "500 @xmath133 are chosen to match each other at @xmath134 atm . ]",
    "imposed , for 1000 bins across the same wavenumber range . ]",
    "we further explore our claim that the line - wing cutoff is the largest source of error in computing and using an opacity function , regardless of whether one uses the k - distribution method . in figure",
    "[ fig : cutoff ] , we show different calculations of @xmath75 for various cutoff choices : an absolute cutoff ( of 100 cm@xmath30 , following the choice made by @xcite ) and an ad hoc cutoff of 500 lorentz widths .",
    "these choices are made such that they produce the same results at @xmath134 atm . at higher pressures , we see that deviations appear . for a given value of the column mass ,",
    "the error is @xmath4 to even a factor of several in some instances .",
    "we quantify this error in more detail .",
    "figure [ fig:1000bins ] shows the fractional difference in @xmath75 , between calculations using the full voigt profiles and those with a cutoff of @xmath133 imposed , for 1000 bins across the same wavenumber range . across a broad range of column masses ( @xmath135 g @xmath136 )",
    ", we compute the median , mean and maximum fractional differences using the full - voigt calculations as a baseline comparison .",
    "( we emphasize this does _ not _ imply that using the full voigt profile is correct . )",
    "the median and maximum fractional differences are dominated by small and large column masses , respectively , and are not representative , but we show them for completeness .",
    "we see that the mean fractional difference is @xmath4 across all wavenumbers for @xmath134 atm , implying that a similar uncertainty is present for the computed flux or synthetic spectrum .",
    "we expect that the median fractional differences are larger for higher pressures . elucidating the full consequences of the uncertainty , associated with pressure broadening , for calculations of radiative transfer and retrieval is deferred to future work .    generally , we find that the uncertainties associated with the line - wing cutoff are typically larger than those due to , e.g. , resampling , as long as a sufficient bin resolution is used ( @xmath131 , as previously demonstrated ) .      \") ,",
    "sorting values of @xmath65 into @xmath42 (  sort \" ) , resampling @xmath42 (  resampling \" ) and computing @xmath75 for 1000 values of @xmath36 (  transmission \" ) .",
    "for this plot only , we are using the hitran database with @xmath0 water lines . ]",
    "we execute performance tests on a nvidia tesla k20 gpu card , which has 2496 cores . for these tests",
    ", we use the hitran ( @xmath0 water lines ) , instead of the hitemp , line list , as the entire calculation fits within a single k20 gpu card .",
    "( the hitemp water line list is provided in 34 separate chunks , which we simply load in serial . )",
    "figure [ fig : performance ] breaks down the performance of our code , which we name ` helios - k ` , in terms of the various tasks executed .",
    "unsurprisingly , the computational cost goes up with bin resolution and line - wing cutoff .",
    "generally , ` helios - k ` takes @xmath5 s to compute @xmath0 spectral lines of water .",
    "we anticipate that such a level of performance allows for efficient and broad sweeps of the parameter space of exoplanetary atmospheres .",
    "the details of how opacity functions are computed and used by various studies in the literature remain vague or incomplete .",
    "we suggest that a path towards uniform standards involves explicitly addressing the following questions ( and publishing the answers to them ) .",
    "* does the study claim a  line - by - line \" calculation of the opacity function ( e.g. , @xcite ) ?",
    "if so , are the lines being sampled in an adequate way ? e.g. , if there are @xmath137 lines , is @xmath138 , where @xmath139 is the number of wavenumber / wavelength points used ?",
    "if special circumstances ( e.g. , very broad lines ) allow for @xmath140 to be justified , has this been demonstrated explicitly ?",
    "does the study show results from convergence tests ?",
    "often , what are effectively opacity - sampling techniques ( @xmath141 ) are misleadingly claimed as being  line - by - line \" .",
    "* how is the voigt profile being computed ?",
    "is it being directly evaluated as an indefinite integral ? or has a transformation and/or approximation(s ) been taken ? * if the k - distribution method is adopted , how many bins are specified ?",
    "how is the opacity function resampled within each bin , i.e. , what is the resampling method ? has the study demonstrated that an adequate intra - bin resolution has been used ? * are k - distribution tables separately computed for each molecular species and then added together  weighted by the relative abundance of each species  afterwards ?",
    "if so , then the correlated - k approximation has been used and this should be explicitly mentioned .",
    "* is pressure broadening being considered ?",
    "if so , is the study imposing line - wing cutoffs ?",
    "is the cutoff specified as an absolute number or as a specific number of lorentz or doppler widths ?",
    "have the uncertainties associated with this choice been explored and quantified ?",
    "we have constructed an open - source , ultrafast , gpu code written using ` cuda ` , named ` helios - k ` , which takes a line list as an input and computes the opacity function of the atmosphere for any mixture of atoms and molecules .",
    "the dominant source of error stems from an unsolved physics problem : describing the far line wings of spectral lines affected by pressure broadening . in the absence of a complete theory ,",
    "we ( and others before us ) have applied an ad hoc cutoff of the line wing for our calculations . notwithstanding",
    "this issue , ` helios - k ` provides the exoplanet community with an efficient tool for computing opacity functions .",
    "s.l.g . and k.h .",
    "acknowledge support from the swiss national science foundation and the swiss - based merac foundation for grants awarded to the exoclimes simulation platform ( ` www.exoclime.org ` ) .",
    "we thank chris hirata for illuminating conversations and the exoplanets & exoclimes group for interactions and intellectual stimulation .",
    "we are grateful to david amundsen , isabelle baraffe and the anonymous referee for constructive comments that improved the clarity of the manuscript ."
  ],
  "abstract_text": [
    "<S> we present an ultrafast opacity calculator that we name ` helios - k ` . </S>",
    "<S> it takes a line list as an input , computes the shape of each spectral line and provides an option for grouping an enormous number of lines into a manageable number of bins . </S>",
    "<S> we implement a combination of algorithm 916 and gauss - hermite quadrature to compute the voigt profile , write the code in ` cuda ` and optimise the computation for graphics processing units ( gpus ) . </S>",
    "<S> we restate the theory of the k - distribution method and use it to reduce @xmath0@xmath1 lines to @xmath2@xmath3 wavenumber bins , which may then be used for radiative transfer , atmospheric retrieval and general circulation models . </S>",
    "<S> the choice of line - wing cutoff for the voigt profile is a significant source of error and affects the value of the computed flux by @xmath4 . </S>",
    "<S> this is an outstanding physical ( rather than computational ) problem , due to our incomplete knowledge of pressure broadening of spectral lines in the far line wings . </S>",
    "<S> we emphasize that this problem remains regardless of whether one performs line - by - line calculations or uses the k - distribution method and affects all calculations of exoplanetary atmospheres requiring the use of wavelength - dependent opacities . </S>",
    "<S> we elucidate the correlated - k approximation and demonstrate that it applies equally to inhomogeneous atmospheres with a single atomic / molecular species or homogeneous atmospheres with multiple species . using a nvidia k20 gpu , ` </S>",
    "<S> helios - k ` is capable of computing an opacity function with @xmath0 spectral lines in @xmath5 second and is publicly available as part of the exoclimes simulation platform ( esp ; ` www.exoclime.org ` ) . </S>"
  ]
}