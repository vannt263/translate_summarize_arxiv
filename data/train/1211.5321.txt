{
  "article_text": [
    "stellar spectra contain a wealth of information on the photospheres of stars , including their chemical makeup . in spite of decades of measuring and studying stellar spectra",
    ", we have a very limited knowledge of how many stars with a given chemical composition exist in the galaxy .",
    "large spectroscopic surveys such as rave @xcite or sdss ( e.g. , * ? ? ?",
    "* ) have increased by several orders of magnitude the number of stars with measured spectra , yet these surveys are limited in scope , reaching only a particular cross - section of the stellar population of the milky way , and biased , in that they target stars that have been preselected based on their color , distance or brightness .",
    "this situation will soon change as new large projects such as gaia ( e.g. , * ? ? ?",
    "* ) , or hetdex @xcite , with well controlled samples , appear in the scene .",
    "the advent of these new data sets poses an obvious problem .",
    "as the data flow continuously increases , performing systematic studies becomes more of an issue , and new efficient means of analyzing stellar spectra are needed .",
    "the study of stellar spectra to quantify the physical properties of stars requires model atmospheres , radiative transfer calculations , atomic and molecular data , and involves a large number of approximations .",
    "the model ingredients and our recipes to apply them to interpret observations are in constant evolution , and so are the values for the inferred quantities .",
    "avoiding such changes is one of the motivations behind spectroscopic classification in general , and in particular of the mk system of @xcite and which is still in use today enhanced with extensions .",
    "it assigns spectral classes in a way that is purely empirical and repeatable , providing basic information as a preliminary step for further , more detailed , analysis .",
    "this kind of typing system based on a series of predefined criteria is feasible as long as the criteria are set and applied by humans .",
    "such systems resemble the taxonomical classification of animal species and , by definition , are not optimal since they rely on subjective judgments .",
    "if such systems have to be updated for application to very large number of spectra , the classification has to be easily implemented and performed with computers , in a fast and homogeneous fashion .",
    "moreover , @xcite maintained that physics must not be used to drive a classification ; otherwise the arguments become circular when using the classification to support physics .",
    "thus , one is inclined to consider unsupervised classification systems , which are themselves defined by algorithms and data .",
    "the potentials of one of such methods , k - means , is explored in this paper .",
    "however , it must be stressed that _ unsupervised _ does not mean _ absolute _ or model _ independent_. the classification criteria are implicitly set by the algorithm , and the resulting classes depend on the specific dataset under analysis .    in data mining parlance ,",
    "the spectrum of a star is a point in the high - dimensional space where each coordinate corresponds to the intensity at a particular wavelength .",
    "given a comprehensive set of stellar spectra , classifying consists of identifying clusters in this high - dimensional space .",
    "the problem of finding structures in a multidimensional data set goes also by the name of cluster analysis ( see e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "one of the most widely used algorithms is k - means clustering @xcite , and it fulfills the requirements put forward above . moreover , k - means is simple to code and robust , even when exploring clustering in a high - dimensional space .",
    "previous works have shown successful applications of the method to the classification of spectra in various astrophysical contexts , e.g. , stars , solar polarization spectra , x - ray spectra @xcite , spectra from asteroids @xcite , and galaxy spectra @xcite .",
    "we now explore its application to medium - resolution stellar spectra from the sloan digital sky survey .",
    "sdss currently provides the largest available homogenous database of stellar spectra .",
    "the original sdss survey @xcite together with segue and segue-2 contain somewhere over half a million stellar spectra @xcite .",
    "the baryon oscillations spectroscopic survey ( boss ; * ? ? ?",
    "* ) , part of sdss - iii , uses similar but upgraded spectrographs , and in the first two years of operation has already obtained over 100,000 additional spectra of stars . even though these stars do not provide a fair sample of the milky way stellar population ,",
    "this rich data set is a good place to explore the application of clustering algorithms for classifying stars .",
    "actually , the set has already been used for this purpose . @xcite",
    "apply principal component analysis ( pca ) to spectra having narrow color bins , so as to separate stars of the same effective temperature according to their gravity and metallicity . in this case",
    "the spectra are not classified directly by the automated procedure , but the color cuts introduce human supervision into the classification . @xcite",
    "apply local linear embedding ( lle ) , which is a type of pca decomposition that preserves the nonlinear structure within high - dimensional data sets .",
    "the stellar spectra are found to form a 1d family when projected into the first three eigenvectors .",
    "finally , @xcite also use sdss data to show that stellar spectra are highly compressible , so that a small number of parameters suffice to reproduce the bulk of the observed spectra .    in this paper",
    "we focus on the k - means classification of stars observed as part of the segue and segue-2 surveys @xcite .",
    "section  [ data ] presents the selection of spectra used in the analysis , and sect .",
    "[ algorithm ] describes the basics behind k - means .",
    "section  [ classification ] applies the algorithm to sdss spectra , first considering continuum ( sect .  [ class_with ] ) , and then without continuum ( sect .",
    "[ class_out ] ) .",
    "the classification allows us to identify outliers , often rare objects that do not show up unless the catalogs are large enough and which turn out to be extremely revealing ( e.g. , * ? ? ?",
    "the properties of these outliers are analyzed in sect .",
    "[ outliers ] .",
    "section  [ conclusions ] explains the main results and outlines additional uses of the classification .",
    "the spectra come from segue and segue-2 @xcite .",
    "these programs obtained stellar spectra using the sdss 2.5-m telescope and the sdss double spectrograph @xcite between 2004 and 2009 .",
    "the spectra contain 3849 wavelengths covering the range 3800 - 9200  at a resolving power @xmath0 .",
    "they were downloaded from the sdss data release  8 ( dr8 ; * ? ? ?",
    "segue observed numerous types of targets , from very hot wd to very cool m and l  types , each chosen based on color criteria , and in some cases additional information such as proper motion .",
    "the survey observations sample the galaxy at mid and high galactic latitudes , covering very sparsely 3/4 of the sky , with only 3 plates ( less than 0.5% of the spectra ) at @xmath1 .",
    "the sample of dr8 spectra associated with segue and segue-2 programs include 355,840 spectra in 525 plug - plates .",
    "each plate , as for sdss , admits 640 fibers .",
    "we selected stars with a median signal - to - noise ratio @xmath2 , a radial velocity module smaller than 600  kms@xmath3 ( redshift @xmath4 ) , and which were not labeled as one of the following classes of objects : galaxy , na , qa , rosat_d , qso , ser , and caty_var .",
    "we processed the spectra to eliminate by interpolation the [ oiii ] nightglow lines at 5577 and 6300 , and corrected the doppler shifts associated with the radial velocities .",
    "the original spectra have units of flux per unit wavelength ( i.e. , erg@xmath5s@xmath3@xmath3 ) .",
    "we normalized them dividing by the median value of their fluxes in the spectral band between 5000 and 6000   .",
    "this step preserves the shape of the spectral energy distribution , while places all the spectra on the same scale regardless of the intrinsic luminosity of the stars , their distance , and the amount of interstellar absorption .",
    "missing sections of spectra were patched by interpolation , since any regions with extreme ( wrong ) values can damage the classification algorithm .",
    "a sample 173,390 stellar spectra passed all the selection criteria , and we refer to them as _ the reference set_. interstellar extinction is not corrected for , however , we analyze a version of the same data with a running mean subtracted from the spectral energy distribution , leaving only absorption features .",
    "this procedure is intended to partly remove the reddening produced by interstellar extinction , thus minimizing its potential impact on the results .",
    "two additional sets of spectra are mentioned in the paper .",
    "they were used only for testing in early stages of the work , but they are explicitly mentioned here because the sanity checks performed with them provide confidence on the technique . as far as we can tell , they are equivalent to the reference set in a statistical sense . for lack of imagination",
    ", we refer to them as _",
    "1st auxiliary set _ and _ 2nd auxiliary set_. auxiliary set  1 comprises 63,611 stellar spectra from 3800 to 8000 , drawn from sdss / dr6 and then purged to retain only those with best s / n .",
    "they are uniformly resampled in log - wavelength as to have 1617 wavelengths .",
    "this set is particularly rich in main sequence f - type stars , since they were used as spectrophotometric calibrators in the original sdss survey ( only 162 distinct segue plates were included in dr6 ) .",
    "auxiliary set  2 comes from dr8 , but the noise thresholding and other selection criteria differ from the reference set , and leaves only 121,272 targets .",
    "effective temperatures @xmath6 , surface gravities ( @xmath7 ) and metallicities ( [ fe / h ] ) computed with the segue stellar parameter pipeline ( hereafter sspp ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "? * ; * ? ? ?",
    "* ) are used here to characterize the physical properties of the stars .",
    "each one of these physical parameters results from the robust average of various independent estimates , discarding those which do not seem to be consistent ( for details , see * ? ? ?",
    "the mk types of the targets mentioned in the paper are also from the sspp .",
    "most of our discussion is based on the so - called elodie mk types , derived by best - fitting templates from the elodie library of synthetic spectra .",
    "the distribution of mk types of the reference set is shown in fig .",
    "[ original_classes2 ] .",
    "these types encompass a broad range of stellar properties from o to l and include wds , however , they face some difficulties when interpreting intermediate spectral types ( e.g. , the distribution of mk types in fig .",
    "[ original_classes2 ] peaks at type f whereas most of the segue stars have been selected to be of g type ; see * ? ? ?",
    "the sspp also provides a second set of mk types only for cool stars , the hammer mk types , which were inferred using the spectral typing software developed and described by @xcite .",
    "they cope much better with types g and f , and we apply them when appropriate .",
    "we use _ k - means _ to carry out the classification , which is a robust tool commonly used in data mining and artificial intelligence ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "the actual realization of the algorithm employed in our analysis is described in detail by @xcite , and we refer to that work for details . however , for comprehensiveness , this section sketches the operation of the algorithm , with its pros and cons .    as for most classification algorithms , the stellar spectra are vectors in a high dimensional linear space , with as many dimensions as the number of wavelengths .",
    "therefore the spectra to be classified are a set of points in this space .",
    "the points ( i.e. , the spectra ) are assumed to be clustered around a number of centers . classifying consists of ( a ) finding the number of clusters and their centers , ( b ) assigning each spectrum to one of these centers , and ( c ) estimating the probability that the choice is correct .",
    "the third step should be regarded as a sanity check that allows us to quantify the goodness of the classification for each particular spectrum . in the standard formulation ,",
    "k - means starts by selecting at random from the full data set a number @xmath8 of spectra .",
    "these spectra are assumed to be the center of a cluster .",
    "then each spectrum of the data set is assigned to the cluster center that is closest in a least squares sense .",
    "once all spectra have been assigned to one of the classes , the cluster centers are recomputed as the average of the spectra in the cluster .",
    "the procedure is iterated with the new cluster centers , quitting when most spectra are not re - assigned in two successive steps ( 99% of them in our realization ) .",
    "the number of clusters is arbitrarily chosen but , the results are insensitive to such selection since only a few clusters possess a significant number of members . thus the algorithm provides the number of clusters , their corresponding cluster centers , as well as the classification of all the original spectra now assigned to one of the clusters .",
    "this information completes steps ( a ) and ( b ) of the classification procedure . in order to estimate the probability that the assignation is correct ( step c ) , we compute for each cluster the distribution of the distances to the cluster center considering all spectra assigned to the cluster",
    "we then assume that this distribution describes the probability that any star with a given distance from the cluster center belongs to the class .",
    "specifically , the probability that a given star belongs to a cluster is estimated as the fraction of stars in the cluster with distances equal to or larger than the distance of the star .",
    "it is a sensible assumption ; it gives high probability to spectra close to the cluster center , and then drops down smoothly toward the outskirts of the cluster .",
    "the scale of this smooth decrease is provided by the measured distribution of distances in the class .",
    "the algorithm is simple , robust and fast , which makes it ideal to treat large data sets .",
    "it guarantees that similar spectra end up in the same cluster .",
    "moreover , it is unsupervised since no prior knowledge of the stellar properties is used , and the spectra to be classified are the only information passed on to the algorithm .",
    "these two properties ensure that the resulting classification is not biased by our ( physical ) prejudices , which follows the spirit of a good classification as advocated by @xcite .",
    "unfortunately , it also has three major drawbacks .",
    "one of them is technical , whereas the other two deal with the physical interpretation of the classes .",
    "the algorithm yields different classifications depending on the random initialization .",
    "this difficulty is overcome by repeating the classification multiple times , thus studying the dependence of the final classes on the random seeds .",
    "in addition , our implementation refines the initialization so that the random seeds are not chosen uniformly but according to the distribution of points in the classification space ( for details , see * ? ? ? * ) .",
    "the second difficulty has to do with interpreting the classes as actual clusters in the classification space , or as parts of larger structures .",
    "the algorithm does not guarantee that the derived classes correspond to actual clusters .",
    "however , one can figure out whether each particular class is isolated or belongs to a larger structure by studying the distances of the spectra in the class to the other classes .",
    "well defined classes contain stars that are distant from the other classes .",
    "the third difficulty refers to the physical interpretation of the resulting classes , which is not provided by the algorithm .",
    "the physical sense of a particular class and its cluster center ( dubbed in the paper as template spectrum ) has to be figured out later on .",
    "actually , most of this paper is devoted to this task , i.e. , to interpreting in terms of known stellar physics the classes resulting from the k - means classification .      as customary ,",
    "the dependence of the classification on the random initialization was studied by repeating the classification 100 times , and then comparing the results .",
    "this internal comparison was carried out using three parameters that we name : ( 1 ) _ coincidence _ , for the percentage of spectra in equivalent classes , ( 2 ) _ dispersion _ , for the rms fluctuations of the spectra in a class with respect its cluster center , and ( 3 ) _ number of classes _",
    ", for the number of classes that contain 99% of the spectra ( major classes ) . in order to decide which classes in two different classifications are _ equivalent _ , we compute the number of stars in common between each pair of classes formed by one class from one classification and the second class from the second classification",
    "the two classes sharing the largest number of stars are assumed to be _",
    "equivalent_. the same criterion is repeated until all the classes of one of the classifications have been paired .",
    "this criterion maximizes the number of stars sharing the same class in the two classifications .",
    "figure  [ the_class4 ] shows scatter plots of the three diagnostic parameters corresponding to repeated classifications of the reference dataset (   [ data ] ) including continuum .",
    "one finds classifications having between 15 and 20 major classes , a dispersion in the range 0.07 to 0.08 , and a mean coincidence between 62% and 68% .",
    "the ranges in these values are fairly narrow .",
    "the fact that the coincidence is about 65% means that one can pair the classes of any two classifications , and they will share about 65% of the spectra .",
    "( these apparently low values are discussed below . )",
    "the fact that the dispersion is of the order of 0.075 implies that the differences between the class template spectra and the spectra in the class are of the order of 7.5% rms .",
    "these numbers refer to the reference dataset including continua (   [ class_with ] ) but are similar to those obtained when spectra without continua are used (   [ class_out ] ) , or when using the auxiliary sets .",
    "in addition to the above tests , we made a numerical experiment splitting the 1st auxiliary set into two randomly chosen disjoint subsets , which were classified independently .",
    "the differences give an idea on the dependence of the classes on the particular dataset that is employed .",
    "the results are summarized in fig .",
    "[ split1 ] , which shows the template spectra of equivalent classes in the two classifications .",
    "( only nine classes are included , but they are representative of the general behavior . ) the differences between spectra are also plotted , and turn out to be of a few percent , i.e. , smaller than the scatter among the spectra included in each class ( the dispersion of these classifications was of the order of 5% ) .",
    "we have also computed the colors of the templates and of the individual stars , and the differences between the colors of the templates ( @xmath90.025 mag ) are smaller than the scatter among individual stars in a class ( @xmath90.05 mag ) .        as mentioned above , repeating the classification several times leaves only 6070% of the spectra in equivalent classes .",
    "this issue with k - means is not directly due to the random initialization ",
    "the cluster centers in equivalent classes are very similar , as shown in fig .",
    "[ split1 ] and in ( * ? ? ?",
    "it is due to the fact that k - means slices a rather continuum distribution .",
    "then small changes in the borders between clusters produce a significant relocation of the in - between stars .",
    "the effect is boosted because the clusters are in a high dimensional space ( see the analytic justification in the appendix of * ? ? ?",
    "we show in sect .",
    "[ class_with ] how some of the resulting clusters really have many stars near their borders .",
    "the actual classifications were carried out in parallel using several workstations .",
    "the reference data set has a volume of 6.1 gb , and the process requires some two cpu hours per single classification , or two hundred hours for studying the effects of the random initialization .",
    "these figures are mentioned to stress that the k - mean classification of a sizable data set , including studying initial conditions , is easily doable using standard hardware facilities .",
    "the description given in this section refers to the reference set defined in   [ data ] , however , the same procedures and analysis have been repeated with the two auxiliary sets , giving always consistent results .",
    "the classifications use all the 3849 wavelengths equally weighted .",
    "we consider two cases for the analysis . in the first case ,",
    "the full spectra are used (   [ class_with ] ) . in the second , a running average 193 pixels wide ( @xmath1017,400kms@xmath3 )",
    "is subtracted from each spectrum (   [ class_out ] ) .",
    "this high - pass filtering removes the continuum but leaves the spectral lines almost untouched .      in order to study the dependence of the classes on the random seeds inherent to k - means",
    ", we carried out 100 independent classifications (   [ repeatability ] ) .",
    "they are equally valid classifications , but we have to choose among them one to be used as _ the classification_. taking advantage of having all these possibilities , we try to selected the one that is as representative as possible of all of them , the spectra in their classes are as similar as possible , and has the smallest number of classes . in the parlance used in",
    "  [ repeatability ] , we try to select a classification having large coincidence , small dispersion and few classes .",
    "the scatter plots for these three parameters among the 100 independent classifications are shown in fig .",
    "[ the_class4 ] . asking the coincidence to be larger than 66%",
    ", the dispersion to be smaller than 0.074 , and the major classes to be fewer than 17 , one finds only two classifications .",
    "those are represented as asterisks in fig .",
    "[ the_class4 ] . for lacking a better criterion",
    ", we choose one of them at random .",
    "its coincidence is 67% , its dispersion 0.073 , and it has 16 major classes ( 26 in total , but some seem to correspond to failures of the sdss pipeline , as we explain later on ) .",
    "the average of all the spectra in the classes ( i.e. , the cluster centers or the cluster templates ) are shown as solid lines in fig .",
    "[ the_class_temp4 ] .",
    "the figure also includes the standard deviation among all the spectra in each class ( the dotted line ) , which quantifies the intra - class dispersion .",
    "the number of stars in each class is represented as an histogram in fig .",
    "[ the_class4_his ] .",
    "it shows that the classes have been numbered according to the stars than contain , being class  0 the most numerous , class  1 the second most numerous , and so on and so forth .",
    "since the template spectra come from averaging thousands of individual spectra , they have extremely high signal - to - noise ratios  from 200 to 2000 depending on the number of spectra in the class .",
    "the spectra of classes  22 and 24 are not included in fig .  [ the_class_temp4 ] .",
    "they collect faulty spectra that are similar to class  17 ( see the template spectrum in fig .",
    "[ the_class_temp4 ] , that has a large unphysical spike at the bluest wavelength ) .",
    "the templates are also represented in fig .",
    "[ the_class_temp4otro ] as a stack - plot ordered so that the image looks as smooth as possible .",
    "this image excludes those classes that are failures of the pipeline ( classes 17 , 22 and 24 ) and binary systems ( classes 20 and 21 ; see below ) .        as we discuss in sect .",
    "[ algorithm ] , k - means does not guarantee the inferred classes to be real clusters in the classification space .",
    "they may be parts of larger structures that have been sliced by the algorithm . a way to study whether the classes are isolated was explored in @xcite , and it is used here too .",
    "one can estimate the probability that each particular star belongs to the class it was assigned to .",
    "it depends on how far from the cluster center the star is as compared to the other members in its class .",
    "similarly , one can estimate the probability of the star belonging to any other class .",
    "well defined clusters will have most of their elements with a probability of belonging to any other cluster significantly smaller than the probability of belonging to the cluster .",
    "figure  [ groups_stars_pub ] shows histograms of the ratios between probabilities of belonging to the 2nd nearest cluster and to the assigned cluster for a few representative classes .",
    "there are classes where the histogram peaks at low ratios , thus indicating a well defined structure in the classification space ( e.g. , class  0 in fig .",
    "[ groups_stars_pub ] ) .",
    "conversely , other classes present a rather flat histogram indicating a dispersed structure ( e.g. , class  3 in fig .",
    "[ groups_stars_pub ] ) .",
    "classes 3 , 5 , 11 and 19 represent spread - out classes , whereas the rest are clustered classes . note , however , that even the histograms of well defined clusters have a significant tail towards large ratios , indicating the presence of many stars in the boundaries between clusters .",
    "those stars are partly responsible for the non - uniqueness of the classification studied in sect .",
    "[ repeatability ] .",
    "the physical interpretation of some of the classes is relatively straightforward .",
    "classes 20 and 21 , with upturns in both the blue and the red , are most likely composite spectra of systems with two ( or more ) stars with very different effective temperatures ( @xmath6 ) .",
    "they can be gravitationally bounded stellar systems , or stars that happen to be along the line of sight .",
    "the luminosity of the stars that contribute to the combined spectrum has to be similar , therefore , in case of binary systems both stars can not be in the main sequence because the hot star would outshine any cold companion .",
    "one common possibility is a hot white dwarf ( wd ) and a cold dwarf or giant , and this is indeed the conclusion reached when trying to reproduce the templates of classes  20 and 21 as a linear superposition of templates of two other classes .",
    "the best fit is obtained combining classes 16 and 18 , as shown in fig .",
    "[ composite1 ] .",
    "as we discuss later on , class  16 contains wds , and class  18 corresponds to k - type giants .",
    "we note that the templates of classes  20 and 21 resemble spectra of post - common envelope binaries , as identified and studied using sdss data .",
    "some other classes are really awkward , and so difficult to interpret unless they are associated with failures in the reduction pipeline ( e.g. , classes  17 and 19 )",
    ". figure  [ the_class_col4 ] shows an image with the distribution of @xmath11 vs @xmath12 colors of the full set , with the individual classes overlaid as contours containing 68% of the stars .",
    "the colors have been derived from the spectra using the transmission bandpasses of the broad - band sdss filters .",
    "note that the classification is basically a color classification . disregarding classes gathering failures of the pipeline ( classes 17 , 19 , 22 , and 24 ) and multiple systems ( classes  20 and 21 ) , the k - means classification of stellar spectra with continuum seems to separate stars according to their position on the color - color plot .",
    "the classes form a one - dimensional set in the diagram , with a bifurcation at @xmath13 .",
    "the bifurcation separates dwarf stars ( on top ) from giant stars , a result further discussed below .",
    "we note , in passing , that multiple systems are well separated in this color - color plot and , therefore , it can be used to select them .",
    "main sequence stars have @xmath14 larger than 3.8 ( with the surface gravity g in cms@xmath15 ) , which is even larger ( @xmath16 ) for stars with @xmath17k ( e.g. * ? ? ?",
    "vs @xmath12 plot for the full set ( the image in the background ) and for the different classes separately .",
    "the contours show the region with 68% of the spectra in the class , and have been labeled with the corresponding class number .",
    "this plot corresponds to the full spectrum classification .",
    "classes 17 , 19 , 22 , and 24 seem to be failures of the reduction pipeline .",
    "classes  20 and 21 are binary or multiple systems with spectra blue in the blue filters ( i.e. , @xmath11 ) and red in the red filters ( i.e. , @xmath12 ) . the rest of classes form a 1d sequence that bifurcates at @xmath13 ( at classes 0 and 3 ) .",
    ", scaledwidth=50.0% ]    figure  [ density4 ] shows the two - dimensional distribution of @xmath14  vs  @xmath6 , together with contours with the region containing 68% of the stars in the class .",
    "the gravities and effective temperatures of individual stars have been taken from the sspp ( parameters labeled adop ) , as we explain in sect .",
    "the plot does not include all the classes since many of them overlap and would clutter the figure .",
    "only those classes relevant for our argumentation are included , in particular classes  0 and 3 have similar @xmath6 but are parts of the two different branches of the color sequence ( see fig .",
    "[ the_class_col4 ] ) .",
    "note that class  0 gathers only main sequence stars ( @xmath18 ) whereas most class  3 targets are giants .",
    "something similar occurs with the pairs of classes 1 and 5 , and 8 and 11 .",
    "classes 0 , 1 , 4 and 8 contain only main sequence stars ( see classes  0 and 8 in fig .",
    "[ density4 ] ) .",
    "classes 14 and 18 contain only giant stars ( see class  18 in fig .",
    "[ density4 ] ) .",
    "several classes do not have enough valid @xmath6 and @xmath14 to know their location in the @xmath14  vs  @xmath6 plot , including the classes with faults plus classes 16 and 25 .",
    "class 25 is a minor class with few elements , but class  16 is not .",
    "the lack of effective temperatures and gravities for class  16 seems to be associated with the fact that it collects wds , for which no proper physical data are provided by the sspp ( but see , e.g. , * ? ? ? * ; * ? ? ?",
    "* ; * ? ? ?",
    "vs  @xmath6 for different classes resulting from the classification of stellar spectra with continuum .",
    "the contours containing 68%  of the stars in the class .",
    "only classes  0 , 3 , 7 , 8 , 9 , 15 and 18 are included to avoid cluttering the figure .",
    "the class numbers have been placed at the location of the mean of the corresponding distribution .",
    ", scaledwidth=50.0% ]    we note that classes 20 and 21 , multiple systems whose spectra combine hot and cold components ( see figs .  [ the_class_temp4 ] and [ composite1 ] ) , appear in fig .",
    "[ density4 ] as main sequence stars with @xmath6 between 5000k and 6000k .",
    "they are also metal rich systems according to the plot discussed in the next paragraph .",
    "figure  [ fe_vs_teff4 ] shows the two - dimensional distribution of [ fe / h ]  vs  @xmath6 , together with contours with the region containing 68% of the stars in the class . as the rest of physical parameters of stars , the metallicity [ fe / h ] comes from the sspp .",
    "the figure shows how the classes often contain both high and low metallicity stars .",
    "if the threshold between low and high metallicities is set at one tenth of the solar value ( i.e. , [ fe / h]@xmath19 ) , the classes that contain only high metallicity stars are 0 , 1 , 4 , 8 , 14 , and 18 .",
    "similarly , classes 12 and 15 include only low metallicity stars .",
    "some of these classes are included in fig .",
    "[ fe_vs_teff4 ] .",
    "class 18 contains low gravity , low temperature high metallicity stars  probably k giants . class 15 contains low gravity high temperature low metallicity stars .",
    "vs  @xmath6 for some representative classes resulting from the classification of spectra including continuum .",
    "the represented classes are the same as those in fig .",
    "[ density4 ] .",
    "the contours embrace 68%  of the stars in the class , and the class numbers have been placed at the mean point of the corresponding distributions .",
    ", scaledwidth=50.0% ]    the k - means classes do not exactly coincide with the classical mk types assigned to the stars by @xcite ( see sect .  [ data ] ) . figure  [ mkclasses4 ]",
    "presents the histogram of mk types corresponding to the k - means classes in figs .",
    "[ density4 ] and [ fe_vs_teff4 ] .",
    "as the histograms show , most classes can be ascribed to a single mk type or to a narrow range of them ( e.g. , class  0 , 8 and 9 ) .",
    "however , the spread in mk types is sometimes large ( e.g. , class  18 ) , becoming extreme in the bluest classes ( e.g. , class  15 ) , which often group a - type stars ( mainly on the horizontal branch ) with wd .        to recapitulate , the k - means classification of spectra with continuum seems to be basically a color classification .",
    "the stellar colors are driven mostly by the overall continuum shape , therefore , the k - mean classes separate stars according to their continua .",
    "as explained in the previous section , the k - means classification of stellar spectra with continuum is essentially a color classification .",
    "since the colors are dictated mostly by the continuum , the classification is driven by the shape of the continuum .",
    "dust extinction and errors in the spectro - photometric calibrations corrupt continua but not so much spectral lines , which retain the information on the stellar properties . in order to study the potential of k - means to identify and",
    "separate spectra according to subtle spectral - line differences , we repeated the classification using spectra without continuum .",
    "explicitly , the spectra to be classified are the original spectra after removal of a running mean filter 193 pixels wide , which corresponds to 170  in the blue and 400  in the red .",
    "the width of the numerical filter was determined as a trade off to be broader than most spectral features , yet narrow enough to be representative of the local continua . because sdss spectra are sampled in log wavelength , our constant width in pixels represents a single doppler broadening of the order of 17,400 kms@xmath3 .",
    "the procedure leading to the classification is similar to that used for the full spectra described in the previous sect .",
    "[ class_with ] .",
    "the _ dispersion _ ,",
    "_ coincidence _ , and _ number of major classes _ were used to select one among 100 independent initializations .",
    "the selection criteria try to make this classification as representative of the rest as possible .",
    "the selected class has @xmath20% , @xmath21 , 13  mayor classes , and 1  minor class .",
    "note that the coincidence is larger than that for the classification with continuum , and the dispersion and number of classes smaller . the number of stars in each class is shown in fig .  [ the_class6_his ] . as we did for the classes resulting from classifying the spectra with continuum ( sect .",
    "[ class_with ] ) , the new classes are also named class  0 , class  1 , and so on , with the number increasing as the elements in the class decrease .",
    "the average spectra of all the stars in each class are shown in fig .",
    "[ the_class_temp6 ] .",
    "we just show a small portion of the blue spectrum where individual spectral lines can be appreciated .",
    "( two spectra spanning the full spectral range are shown for illustration , but then it is impossible to appreciate details of the lines . ) note that each template spectrum is the average of thousands of individual spectra , so all the small noise - looking wiggles are real spectral features .",
    "the full templates are shown as a stack - plot image in fig .",
    "[ the_class_temp6otro ] ( c.f .",
    "[ the_class_temp4otro ] ) .",
    "they have been ordered so that the sequence looks as smooth as possible .",
    "the balmer lines , which are the only ones present in class  12 , decrease in strength as one moves up in the image .",
    "the conspicuous molecular bands of tio are present only in class  7 .",
    "figure  [ the_class_temp6mas ] also shows the average spectra of the classes , but this average was computed using the original spectra with their continua intact .",
    "the comparison of these spectra with those corresponding to the classification including continuum ( fig .  [ the_class_temp4 ] ) renders a few differences .",
    "first , the faulty classes with a fake emission peak in the blue ( e.g. , class  17 in fig .  [ the_class_temp4 ] ) have disappeared .",
    "this is a side - effect of removing the continuum from the spectra , which in our implementation blacks out the 193 pixels in the extreme wavelengths , thus removing the problem .",
    "second , there is a new class that shows spectra with emission lines ( class  9 ) , which most probably are not real but poorly corrected sky lines at the wavelengths of the ca ii ir triplet ( see .",
    ", e.g. , * ? ? ?",
    "finally , the spectra corresponding to binary systems do not form a separate class , so that they have to show up as outliers of the classification ( sect .",
    "[ outliers ] ) .",
    "the classes are shown in the @xmath11 vs @xmath12 color plot in fig .",
    "[ the_class_col6 ] .",
    "they overlap more than the classes inferred when the continuum is included ; see fig .",
    "[ the_class_col4 ] .",
    "there are several conclusions to be drawn from the comparison of these two figures .",
    "the continua influence the classification or , in other words , the classifications with and without continua do not fully agree .",
    "however , most classes can be viewed as mergers of classes with continuum .",
    "even if the continuum is not included for classifying , the different classes have different colors  classes 0 and 9 represent an exception since they overlap in the color - color plot ( see fig .  [ the_class_col6 ] ) .     vs @xmath12 plot for the reference set of stellar spectra ( background image ) and for the different classes separately .",
    "the contours show the region with 68% of the spectra in the class , and the centroid of each distribution has been labeled with the class number it belongs to .",
    "this plot corresponds to the classification where the continuum was removed .",
    ", scaledwidth=50.0% ]    the color - color plot also shows two parallel sequences that split at @xmath22 ( or at class  6 ) .",
    "as it happens with the classification including continuum , the upper branch corresponds to main sequence stars whereas the lower branch includes giants .",
    "this separation by stellar size is more clear in fig .",
    "[ density6 ] , which shows the 2d distribution of @xmath14  vs  @xmath6 for the stars in a number of selected classes  the classes in the lower branch of fig .",
    "[ the_class_col6 ] include low gravity stars in fig .",
    "[ density6 ] ( see classes  6 and 2 ) .    vs  @xmath6 for a number of selected classes resulting from the classification of the stellar spectra with the continuum removed .",
    "the image shows the full set , and the contours indicate the regions containing 68%   of the stars in the class .",
    "the class numbers appear at the centroid of the distributions .",
    "the distribution of class  11 has two separated peaks at @xmath23 and 4.2 , so that the corresponding label appears between them .",
    ", scaledwidth=50.0% ]    vs  @xmath6 for the different classes resulting from the classification of the segue stars with their continua removed .",
    "the image displays the histogram of the full set , whereas the contours mark the regions containing 68%  of the stars in the class .",
    "class numbers are located at the center of the corresponding distribution .",
    ", scaledwidth=50.0% ]    figure  [ fe_vs_teff6 ] shows the 2d distribution of [ fe / h ]  vs  @xmath6 for the full set of stars , together with contours with the region containing 68% of the stars in selected classes .",
    "note how well separated are the classes in this plot , in contrast with the overlap present in the color - color plot ( fig .",
    "[ the_class_col6 ] ) .",
    "the behavior is opposite to that of the classes resulting from classifying spectra with continua , which are well separated in the color - color plot ( fig .",
    "[ the_class_col4 ] ) , but overlap in the [ fe / h]-@xmath6 diagram ( fig .",
    "[ fe_vs_teff4 ] ) .",
    "note also that classes 5 and 6 occupy the same region of the color - color plot and overlap in the @xmath14-@xmath6 plot , but they have different metallicities .",
    "these are f stars that approximately split according to their membership to the thick disk and the halo @xcite , therefore , the classification provides a quick - look tool to separate disk and halo stars .",
    "class  12 is dominated by da wds ( see below and the class template in fig .  [ the_class_temp6mas ] ) , however , it shows up as extremely low metallicity in fig .",
    "[ density6 ] .",
    "since the sspp does not deal with wds , these must have been confused with a - type stars and analyzed as such , finding that they are best matched with no metals .",
    "figure  [ mkclasses6 ] shows the distribution of mk spectral types corresponding to the k - means classes .",
    "note how each class tends to belong to a single spectral type , but not always .",
    "moreover , the correspondence seems to be better than that for the classification including continuum ( cf .",
    ", fig.[mkclasses4 ] ) .",
    "note how class  12 is basically formed by wds , whereas classes 8 , 10 and 11 are made of type a stars .",
    "the most numerous class  0 contains almost exclusively f9 stars , as it also happens with the classification with continuum ( fig .",
    "[ mkclasses4 ] ) .",
    "we think that the concentration of class  0 around a particular type is real , but the particular type is not , since most stars selected by segue are g - type rather than f - type ( see sect .  [ data ] ) .",
    "there seems to be a problem with the mk typing based on elodie templates because , as expected , the hammer mk types associated with class  0 are late g types .",
    "figure  [ mkclasses6_otro ] is equivalent to fig .",
    "[ mkclasses6 ] but showing hammer types ( sect .  [ data ] ) .",
    "class  0 corresponds to types between g6 and k2 .",
    "note , in passing , that the classes of hot stars have disappeared from the histograms since hammer typing does not allocate classes to them .",
    "table  [ summary ] gives a summary of the physical properties of the classes , namely , it contains mean values and standard deviations for colors , temperatures , gravities and metallicities .",
    "( class  13 has been excluded since it seems to be collecting faulty spectra . )",
    "note that some classes present a fairly small range of physical parameters .",
    "for instance , if a star is assigned to class  0 then we know its temperature , gravity and metallicity with standard deviations of 190  k , 0.25  dex , and 0.36  dex , respectively .",
    "these uncertainties are comparable to those associated with other approaches currently used to estimate effective temperature and gravity .",
    "this fact opens up the possibility of using k - means for a quick - look estimate of the main physical parameters of the stars at a minimum computational cost .",
    "once the classes are known , assigning a new spectrum to one of them is virtually instantaneous ",
    "it is just a matter of computing the difference between the new spectrum and the class templates , and then selecting the class of least rms deviation .",
    "cccccc 0 & 0.64@xmath240.08&1.39@xmath240.20&5370@xmath24190 & 4.51@xmath240.25&-0.53@xmath240.36 + 1 & 0.53@xmath240.10&1.03@xmath240.17&5660@xmath24290 & 4.13@xmath240.47&-0.79@xmath240.40 + 2 & 0.60@xmath240.13&0.96@xmath240.21&5450@xmath24340 & 3.33@xmath240.75&-1.71@xmath240.53 + 3 & 0.87@xmath240.13&1.86@xmath240.29&4830@xmath24230 & 4.61@xmath240.22&-0.52@xmath240.40 + 4 & 1.02@xmath240.25&1.70@xmath240.44&5260@xmath24440 & 3.74@xmath240.74&-0.55@xmath240.50 + 5 & 0.36@xmath240.12&0.74@xmath240.13&6400@xmath24300 & 3.98@xmath240.35&-0.79@xmath240.45 + 6 & 0.30@xmath240.20&0.64@xmath240.23&6500@xmath24330 & 3.74@xmath240.47&-1.86@xmath240.61 + 7 & 1.31@xmath240.17&2.24@xmath240.33&4290@xmath24150 & 4.39@xmath240.34&-0.55@xmath240.42 + 8 & 0.18@xmath240.14&0.64@xmath240.17&7250@xmath24340 & 4.05@xmath240.37&-0.90@xmath240.62 + 9 & 0.69@xmath240.16&1.31@xmath240.35&5340@xmath24330 & 4.24@xmath240.47&-0.89@xmath240.50 + 10 & 0.02@xmath240.14&0.59@xmath240.17&8020@xmath24340 & 4.12@xmath240.40&-0.98@xmath240.70 + 11&-0.14@xmath240.08&0.49@xmath240.12&8700@xmath24350 & 3.80@xmath240.47&-1.36@xmath240.66 + 12&-0.27@xmath240.13&0.35@xmath240.18&8890@xmath24410 & 4.67@xmath240.17&-3.03@xmath240.66 [ summary ]",
    "having a classification automatically provides outliers , i.e. , uncommon objects which therefore do not belong to any of the classes . we can easily identify them since , in addition to assigning class memberships , our algorithm estimates the probability of belonging to the class ( see sect .  [ algorithm ] ) .",
    "outliers are therefore those objects whose probability of belonging to their class is below a threshold .",
    "we set the threshold to 0.01 , which implies selecting as outliers the 1% spectra furthest from their clusters centers .",
    "the actual threshold is both arbitrary and unimportant , since our purpose was figuring out the type of spectra that do not fit in the classification .",
    "the adopted threshold renders some 2200 spectra , that were inspected individually .",
    "we carried out the inspection for both classifications , the one including continuum and the one without continuum . in both cases",
    "the vast majority of the outliers are noisy spectra or failures of the sdss pipeline ( e.g. , gaps , unsuccessful removal of telluric lines , mismatches between the red and the blue spectrograph arms , and so on ) .",
    "these problematic spectra represent three - quarters of the outliers for the classification using continuum , and a bit less when continuum is removed .",
    "( this difference is to be expected since subtracting the continuum automatically cancels many of the calibration problems . ) here we focus on the outliers of the classification with continuum , although they are qualitatively similar to those of the classification with the continuum subtracted . in this case",
    "we count 548 genuine outliers .",
    "they are illustrated in fig .",
    "[ outlier1b ] and described in the following list ordered from more to less common :    * quasars ( qsos ) at redshift between 2 and 4 , so that ly@xmath25 appears in the visible spectral range ( e.g. , fig .",
    "[ outlier1b]a  we identified the observed lines in the qso spectrum template by * ? ? ?",
    "most outliers are of this kind ( some 320 or 60% of the sample ) .",
    "they represent only 0.3% of qsos in the latest sdss qso catalog @xcite , but they tend to appear in the redshifts where the sdss identification algorithm has known problems ( redshifts 2.9 and 3.2 ) .",
    "a bad redshift assignation at these particular redshifts would explain the presence of a large number of qsos contaminating our stellar sample . * broad absorption line ( bal ) qsos at the same high redshifts ( fig .  [ outlier1b]b ) .",
    "those are believed to be agns with very rapid outflows ( of a few times 10@xmath26kms@xmath3 ) along the line of sight @xcite .",
    "we get 33 of these objects , which represent 6.0% of the outliers , and 9.3% of the qso  a percentage that seems to be normal for bal qsos ( e.g. , * ? ? ?",
    "* composite spectra of blue and red stars combined ( e.g. , fig .  [",
    "outlier1b]c , where h@xmath25 shows up in emission )",
    ". they may be genuine binary systems with the two stars gravitationally bounded , or just two or more stars that happen to be along our line of sight .",
    "we ignore why these stars appear as outliers rather than elements of existing classes ( classes  20 or 21 in fig .  [ the_class_temp4 ] ) , but it may be due to having an excess of blue upturn as compared to the template spectra . * flat spectra , showing absorption line features characteristics of hot stars in the blue , and of cold stars in the red ( e.g. , fig .  [ outlier1b]d ) .",
    "they may be composite spectra like in fig .",
    "[ outlier1b]c , but with the luminosities of the stars fine - tuned so that the combination looks spectrally flat . * extreme spectra .",
    "they look - like the corresponding templates , but seem to be extreme cases ( e.g. , extreme colors or particularly deep absorption lines ) .",
    "figure  [ outlier1b]e shows a particularly cold star or sub - stellar object ",
    "the spectrum and the corresponding template are shown as solid and dotted lines , respectively .",
    "figure  [ outlier1b]f shows the spectrum of a star ( the solid line ) hotter than its template ( the dotted line ) . *",
    "star - forming galaxies at intermediate redshifts ( e.g. , fig .  [ outlier1b]g ) . *",
    "qsos at redshifts around one ( e.g. , fig .",
    "[ outlier1b]h ) . * strongly dust - reddened blue stars ( e.g. , fig .  [ outlier1b]p ) . * carbon rich wds with strong c@xmath27 bands ( e.g. , fig .",
    "[ outlier1b]i and [ outlier1b]j )  see the observed and synthetic spectra in @xcite . * carbon stars ( e.g. , fig .",
    "[ outlier1b]o ) , where the photospheric opacity is dominated by c - bearing molecules .",
    "the carbon , dredged up to the photosphere , comes from the he burning shell characteristic of low mass stars during their late stages of evolution .",
    "figure  [ outlier1b]o should be compared with c - star spectra in , e.g. , and . *",
    "strange - looking spectra .",
    "they may be failures of the reduction pipeline , but they may be genuine abnormal objects as well .",
    "figures  [ outlier1b]k[outlier1b]n show a few of them , chosen only when they are not the sole representative of its class .",
    "they include spectra with strong emission lines ( e.g. , fig .",
    "[ outlier1b]m ) , or spectra with a single absorption line ( e.g. , fig .",
    "[ outlier1b]n ) .",
    "the traditional approach to classify stellar spectra has to be adapted to process the volume of data produced by large surveys underway ( see sect .  [ intro ] ) .",
    "there is a need for new automated techniques of analysis . in this work",
    "we explore the use of the algorithm k - means for the task , i.e. , as a tool for the automated unsupervised classification of massive stellar spectrum catalogs .",
    "the algorithm has already proven its potential to fast processing other astronomical spectra ( sect .",
    "[ intro ] ) , and we expected it to be useful in this context as well .    for this exploratory application of k - means , we selected the data set of stellar spectra associated with the segue and segue 2 programs .",
    "even though it is not a fair sample of the milky way stellar populations , it contains a rich variety of stellar types and so it is a good test - bench for the classification algorithm . after discarding faulty cases ,",
    "the reference dataset consists of 173,390 stellar spectra from 3800 to 9200   sampled in 3849 wavelengths .",
    "therefore , the problem for k - means is to find clusters among 173,390 vectors defined in a 3849-dimensional space .",
    "the full data set occupies 6.1 gb , and is classified using a standard up - to - date workstation in some two hours ( see sect .",
    "[ repeatability ] ) .",
    "we apply the classification to the original spectra and also to the spectra with the continuum removed . the latter data set",
    "contains only spectral lines , and it is less dependent on observational and instrumental problems like dust extinction , spectro - photometric mis - calibrations , or failures in the reduction pipeline .",
    "the classification of the spectra with continuum renders 16 major classes , with 99% of the objects , and ten minor classes with the remaining 1% ( sect .",
    "[ class_with ] ) .",
    "roughly speaking , the stars are split according to their colors , with enough finesse to distinguish dwarf and giant stars ( fig .",
    "[ the_class_col4 ] ) .",
    "figure  [ the_class_temp4 ] shows the template spectra representative of all the classes : there are classes for wds ( class  15 ) , a - type stars ( class 9 ) , f - type stars ( class  0 ) , k - type stars ( class  8) , m - type stars ( class  23 ) , dust - reddened intrinsically blue stars ( class  18 ) , binary systems ( class 21 ) , and even classes with faulty spectra ( classes 17 and 19 )",
    ". it must be stressed , however , that there is not a one - to - one correspondence between the classes we derived and the mk types .",
    "often our classes mix - up several mk types , and vice versa .",
    "the classification is able to separate stars with similar temperatures but different surface gravities ( compare classes 0 and 3 in fig .",
    "[ density4 ] ) , but has difficulties to separate stars with different metallicities ( fig .",
    "[ fe_vs_teff4 ] ) .",
    "the classification of spectra without continuum renders less classes ( sect .",
    "[ class_out ] )  13 major classes and only 1 minor class that probably collects faults of the reduction pipeline ( figs .",
    "[ the_class_temp6 ] and [ the_class_temp6mas ] ) . in this case",
    "the color separation is not so sharp as it is for the classification with continuum included ( cf . , figs  [ the_class_col4 ] and [ the_class_col6 ] ) .",
    "however , it is able to separate stars in classes with the same effective temperatures but different metallicities ( fig .",
    "[ fe_vs_teff6 ] ) .",
    "the behavior is opposite to that of the classes resulting from classifying spectra with continua , which are well separated in the color - color plot but overlap in [ fe / h ]  vs  @xmath6 .",
    "some classes include starts with a fairly small range of physical parameters , as assigned by the sspp .",
    "the mean value and dispersion of the effective temperature , surface gravity , and metallicity of the classes without continuum are listed in table  [ summary ] .",
    "a small dispersion implies that our classification can be used to estimate the main physical parameters of the stars at a minimum computational cost .",
    "one only has to assign the problem spectrum to one of the existing classes , e.g. , to the one of minimum residual .",
    "then the properties of the class can be passed on to the new spectrum , thus providing its main physical properties .",
    "for example , if the problem spectrum happens to belong to class  0 , then we know its temperature , gravity , and metallicity within a standard deviation of 190  k , 0.25  dex , and 0.36  dex , respectively .",
    "these uncertainties are probably upper limits since the estimate of the physical parameters by the sspp has non - negligible internal errors that are included in the dispersions .",
    "note that the uncertainties are comparable with those associated with other approaches currently used to estimate effective temperature and gravity , which are far more time consuming .",
    "moreover , since we derive physical parameters from spectra without continuum , the estimates are fairly robust against dust reddening and other observational issues , which are often a serious problem when dealing with stars at low galactic latitudes .",
    "the classification also provides a means of finding rare but scientifically interesting objects , e.g. , unusually low metallicity stars , odd spectral types , etc . by definition , rare objects must be outliers of any classification , otherwise they would be common and would have classes associated to them .",
    "our rendering of k - means gives the goodness of the assignation , i.e. , the probability that each star belongs to the class it has been assigned to .",
    "therefore , the outliers of the classification are easy to pinpoint as those spectra whose probability of a correct assignation is low enough .",
    "the nature of the outliers thus selected was examined in sect .",
    "[ outliers ]  see fig .",
    "[ outlier1b ] .",
    "most outliers are faulty data or failures of the sdss reduction pipeline .",
    "the remaining 25% is firstly formed by high redshift qsos .",
    "since they are in the appropriate redshift range , we speculate that these qso may be those lost by a known problem in the sdss qso identification algorithm .",
    "there is a large number of outliers corresponding to composite spectra formed by either real or fake double or multiple stellar systems .",
    "the spectrum is that of a hot star in the blue and a cold star in the red .",
    "there are also reddened stellar spectra , and galaxy spectra . finally , there are odd spectral types whose nature we did not manage to figure out , and which we plan to observe in follow up work .",
    "one obvious use of the present classification is identifying spectra having instrumental problems or being produced by flaws of the reduction pipeline .",
    "we find classes containing faulty spectra when the problem is common , and then we find faulty spectra as outliers of the classification when the problem is unusual .",
    "stellar spectra are known to be highly compressible so that they can be characterized using only a few independent parameters ( see sect .",
    "[ intro ] ) . then the fact that the classes present a regular behavior",
    "was somehow expected , and this fact is not the main outcome of our exercise .",
    "instead , our exploratory work shows k - means to provide a viable tool for the systematic classification of large data sets of stellar spectra .",
    "moreover , there is plenty of room for improving the procedure , i.e. , for upgrades that have not been considered in the paper , but which may be of interest in future uses .",
    "one can focus the classification in a particular spectral range ( or set of ranges ) particularly sensitive to the physical parameter one wants to select ( say , the metallicity if searching for classes of extremely metal poor stars ) .",
    "then the resulting classes would emphasize this particular aspect of the spectra .",
    "obviously , using smaller spectral ranges for classification also speeds up the procedure .",
    "one can also resort to nested k - means classifications , where the spectra of a given class are separated into subclasses .",
    "this can be used to fine - tuning separation .",
    "thanks are due to j.  casares , l.  girardi , and c.  ramos - almeida for help with deciphering the nature of some of the outliers , and to i.  ferreras and b.  gustafsson for illuminating discussions .",
    "in addition , we thank the referee , c. bailer - jones , for his constructive criticisms that tempered the statements made in the paper .",
    "this work has been partly funded by the spanish ministry for science , project aya  2010 - 21887-c04 - 04 .",
    "jsa is member of the consolider - ingenio 2010 program , grant micinn csd2006 - 00070 : first science with gtc .",
    "funding for sdss , sdss - ii , and sdss - iii has been provided by the alfred p. sloan foundation , the participating institutions , the national science foundation , and the u.s .",
    "department of energy office of science .",
    "sdss - iii is managed by the astrophysical research consortium for the participating institutions of the sdss - iii collaboration including the university of arizona , the brazilian participation group , brookhaven national laboratory , university of cambridge , carnegie mellon university , university of florida , the french participation group , the german participation group , harvard university , the instituto de astrofisica de canarias , the michigan state / notre dame / jina participation group , johns hopkins university , lawrence berkeley national laboratory , max planck institute for astrophysics , max planck institute for extraterrestrial physics , new mexico state university , new york university , ohio state university , pennsylvania state university , university of portsmouth , princeton university , the spanish participation group , university of tokyo , university of utah , vanderbilt university , university of virginia , university of washington , and yale university .",
    "_ facilities : _                                              , g.  j. , gebhardt , k. , komatsu , e. , et  al .",
    "2008 , in astronomical society of the pacific conference series , vol .",
    "399 , panoramic views of galaxy formation and evolution , ed .",
    "t.  kodama , t.  yamada , & k.  aoki , 115"
  ],
  "abstract_text": [
    "<S> large spectroscopic surveys require automated methods of analysis . </S>",
    "<S> this paper explores the use of k - means clustering as a tool for automated unsupervised classification of massive stellar spectral catalogs . </S>",
    "<S> the classification criteria are defined by the data and the algorithm , with no prior physical framework . </S>",
    "<S> we work with a representative set of stellar spectra associated with the sdss segue and segue-2 programs , which consists of 173,390 spectra from 3800 to 9200   sampled on 3849 wavelengths . </S>",
    "<S> we classify the original spectra as well as the spectra with the continuum removed . </S>",
    "<S> the second set only contains spectral lines , and it is less dependent on uncertainties of the flux calibration . </S>",
    "<S> the classification of the spectra with continuum renders 16 major classes . roughly speaking , </S>",
    "<S> stars are split according to their colors , with enough finesse to distinguish dwarfs from giants of the same effective temperature , but with difficulties to separate stars with different metallicities . </S>",
    "<S> there are classes corresponding to particular mk types , intrinsically blue stars dust - reddened , stellar systems , and also classes collecting faulty spectra . </S>",
    "<S> overall , there is no one - to - one correspondence between the classes we derive and the mk types . </S>",
    "<S> the classification of spectra without continuum renders 13 classes , the color separation is not so sharp , but it distinguishes stars of the same effective temperature and different metallicities . </S>",
    "<S> some classes thus obtained present a fairly small range of physical parameters ( 200  k in effective temperature , 0.25 dex in surface gravity , and 0.35 dex in metallicity ) , so that the classification can be used to estimate the main physical parameters of some stars at a minimum computational cost . </S>",
    "<S> we also analyze the outliers of the classification . </S>",
    "<S> most of them turn out to be failures of the reduction pipeline , but there are also high redshift qsos , multiple stellar systems , dust - reddened stars , galaxies , and , finally , odd spectra whose nature we have not decipher . </S>",
    "<S> the template spectra representative of the classes are publicly available ( ftp://stars:kmeans@ftp.iac.es ) . </S>"
  ]
}