{
  "article_text": [
    "many relativistic corrections are applied to the global navigation satellite systems ( gnss ) .",
    "neil ashby presents in physics today ( may 2002 ) a good account of how these relativistic corrections are applied , why , and which are their orders of magnitude .",
    "unfortunately , it is generally proposed that relativity is only a correction to be applied to newtonian physics .",
    "we rather believe that there is a fully relativistic way to understand a gnss system , this leading to a new way of operating it .    as gravitation has to be taken into account , it is inside the framework of general relativity that the theory must be developed .",
    "the shift from a newtonian viewpoint ( relativistic corrections included or not ) into a relativistic framework requires some fundamental conceptual changes .",
    "perhaps the most important concerns the operational definition of a system of four space - time coordinates .",
    "we reach the conclusion that there is an ( essentially unique ) coordinate system that , while being consistent with a relativistic formulation , allows an _ immediate _ positioning of observers ( the traditional minkowski coordinates @xmath0 of flat space - time do not allow such an immediate positioning ) .",
    "these coordinates are defined as follows .",
    "if four clocks having an arbitrary space - time trajectory broadcast their proper time using electromagnetic signals, then , any observer receives , at any point along his personal space - time trajectory , four times , corresponding to the four signals arriving at that space - time point .",
    "these four times , say @xmath1 , _ are _ , by definition , the coordinates of the space - time point .",
    "one does nt has one time coordinate and three space coordinates , as usual , but a ` symmetric ' coordinate system with four time coordinates .",
    "the space - time having been endowed with those coordinates , any observer with a receiver may obtain ( in real time ) his personal trajectory .",
    "this is true , in particular , for the four clocks themselves : each clock constantly receives three of the coordinates and it defines the fourth .",
    "therefore , _ each clock knows its own trajectory _ in this self - consistent coordinate system .",
    "note that even if the clocks are satellites around the earth , the coordinates and the orbits are defined without any reference to an earth based coordinate system : this allows to achieve maximum precision for this _ primary _ reference system .",
    "of course , for applications on the earth s surface , the primary coordinates must be attached to some terrestrial coordinate system , but this is just an attachment problem that should not interfere with the problem of defining the primary system itself .    in general relativity , the gravity field is the space - time metric .",
    "should this metric be exactly known ( in any coordinate system ) , the system just described would constitute an ideal positioning system ( and the components of the metric could be expressed in these coordinates ) . in practice the space - time metric ( i.e. , the gravity field ) is not exactly known , and the satellite system itself has to be used to infer it .",
    "this article is about the problem of using a satellite system for both , positioning , and measuring the space - time metric .",
    "information on the space - time metric may come from different sources .",
    "first , any satellite system has more than four clocks .",
    "while four of the clocks define the coordinates , the redundant clocks can be used to monitor the space - time metric .",
    "the considered satellites may have more that a clock : they may have an accelerometer ( this providing information on the space - time connection ) , a gradiometer ( this providing information on the riemann ) , etc",
    ". our theory will provide seamless integration of positioning systems with systems designed for gravimetry .",
    "in the `` post newtonian '' paradigm used today for operating positioning and gravimetry systems , the ever increasing accuracy of clocks makes that more and more `` relativistic effects '' have to be taken into account . on the contrary ,",
    "the fully relativistic theory here developed will remain valid as long as relativity itself remains valid .",
    "it is our feeling that when gnss and gravimetry systems will be operated using the principles here exposed , new experimental possibilities will appear .",
    "one must realize that with the optical clocks being developed may one day have a relative accuracy of @xmath2 .",
    "the possibility that some day we may approach this accuracy for positioning immediately suggests extraordinarily interesting applications",
    ".    these applications would simply be impossible if sticking to the present - day paradigm . to realize how deeply nonrelativistic this paradigm is ,",
    "consider that gps clocks are kept synchronized . in this year 2005 , when we celebrate the centenary of relativity",
    ", this sounds strange : is there anything less relativistic than the obstination to keep synchronized a system of clocks in relative movement ?    there is one implication of the theory here developed for the galileo positioning system now being developed by the european union .",
    "our theory requires , as a fundamental fact , that the gnss satellites exchange signals .",
    "the most recent gps satellites ( from the usa ) do have this `` cross - link '' capability .",
    "one could , in principle , use the cross - link data ( or an ameliorated version of it ) to operate the system in the way here proposed .",
    "unfortunately , the galileo satellites will not have , to our knowledge , this cross - link capability .",
    "this is a serious limitation that will complicate the evolution of the system towards a more precise one .",
    "finally , we need to write a disclaimer here .",
    "none of the algorithms proposed below are intended to be practical .",
    "they are the simplest algorithms that would be fully consistent with relativity theory . passing from these to actually implementable algorithms",
    "will require some developments in numerical analysis .",
    "finally , some of the simplifying hypotheses made below are not necessary and are only intended to start with a theory that is as simple as possible .",
    "imagine that four clocks ( called below the _ basic clocks _ ) broadcast their proper time using light signals .",
    "any observer in space - time may receive , at any point along its space - time trajectory , four times @xmath3 : these are , by definition , the ( space - time ) coordinates of the space - time point where the observer is .",
    "if the observer had his own clock , with proper time denoted @xmath4 , then he would know his trajectory @xmath5 i.e. , he would know four functions ( of his proper time @xmath4 ) .",
    "he could , in addition , evaluate his four - velocity , and his four - acceleration ( see below ) .    in an actual experiment ,",
    "the clocks are never ideal , and the reception of times implies a measurement that has always attached uncertaities .",
    "we must , therefore , carefully distinguish between model parameters and observable parameters .",
    "this places the present discussion into the usual conceptual frame of inverse problem theory .      for us , a _",
    "complete model _ consists in :    * a * space - time metric field * , denoted @xmath6 , and some ( at least four ) * trajectories * , denoted @xmath7 , parameterized by some parameters @xmath8   because the metric is given , these parameters can be converted into proper time ( by integration of the element @xmath9 ) , so the four trajectories can always be considered to be given as a function of proper time , @xmath10 .",
    "these trajectories shall be the model of the trajectories of `` satellites '' consisting on physical clocks , and , perhaps , accelerometers , gradiometers , and other measuring instruments .",
    "four of the trajectories are arbitrarily selected as  basic trajectories , and the * working coordinates * @xmath11 are assumed to be linked to the metric and the four basic trajectories as follows : the four coordinates @xmath11 of a space - time point @xmath12 are , by definition , the four emission times ( one in each of the four trajectories ) of the four light `` cones '' passing by the point @xmath12 .",
    "this is an idealization of the heuristic protocol suggested in the introduction . *",
    "associated to each trajectory , a ( typically smooth ) * clock drift function * @xmath13 , describing the drift of the physical clock with respect to proper time ( if @xmath14 is clock time , and @xmath4 is proper time , then @xmath15 ) .    to these fundamental parameters ,",
    "we need to add another set , that are also necessary for the prediction of observations :    * a * set of instants * @xmath16 along each trajectory , that represent the nominal instants when a clock is observed , a light signal is emitted ( that will be received by some other satellite ) , or the instant when a measurement ( acceleration , gradiometry , etc . )",
    "is made .",
    "to simplify the theory , we shall assume that the space - time trajectory of all the satellites has crossed at a given space - time point , and that all the clocks have been synchronized ( to zero time ) at this point .",
    "from then on , all clocks will follow their proper time , without any further synchronization ( the drift function just mentioned takes into account that physical clocks never exactly follow proper time ) .",
    "we choose in this first version of the theory , not to introduce the fact that light does not propagate in absolute vacuum .",
    "one very simple model for the upper layers of the atmosphere would be as follows .",
    "one could assume that light propagates in a gas that , at rest , is homogeneous and isotropic , with an index of refraction @xmath17 that , in general , depends on the carrier frequency of the signal .",
    "if the four - velocity of the gas is @xmath18 , then maxwell equations in the gas take the same form as in vacuum , excepted that one must replace the actual ( riemannian ) metric by the ( finslerian ) metric ( see gordon ( 1923 ) or pham mau quan ( 1957 ) for details ) @xmath19 when we will introduce this aspect in the theory , a complete model will also include the field @xmath17 ( index of refraction at different frequencies ) , and the field @xmath18 ( four - velocity of the gas ) .",
    "the a priori information that one has on these quantities is precise enough as for hoping that satellite data will easily be able to refine the model ( tomography of the ionosphere using gps data is already a well developed topic of research ) .    in a physical implementation of the proposed system , the space - time trajectory of any satellite can be approximately known by just recording the time signals received from the four basic satelites .",
    "but the arrival time of the signals must be _ measured _ and any measurement is subject to experimental uncertainties .",
    "it is only through the methodology to be proposed below that an optimal ` model trajectory ' is produced .      given a complete model , as just defined , any observation can be predicted , as , for instance :    * the reading of the time of a physical clock ( on board of a satellite ) can be predicted as @xmath20 along the trajectory ; * the signals sent by the satellites may be observed by other satellites ( this measurement being subject to experimental uncertainties ) .",
    "the time of arrival of the signals can be predicted by tracing the zero length geodesic going from the emission point to the reception trajectory ( see the methods proposed in appendix  [ sec : arrival time data-2 ] ) .",
    "* the satellites may have accelerometers , gradiometers , gyroscopes , etc .",
    "the observations can also be computed using the given metric and the given trajectories .",
    "the methodology here proposed in based in the assumption that _ any observation made by a satellite ( the time of the physical clock , the time of arrival of a received signal , the satellite acceleration , etc . ) is broadcasted . _",
    "the goal of the paper is to propose a methodology that can allow any observer to use all the broadcasted observations to build a complete model that is as good as possible .",
    "the model should predict values of the observations that are close to the actual observations ( within experimental uncertainties ) and it should also have some simple properties ( for instance , the metric and the trajectories should have some degree of smoothness ) . in principle , any observer could run his ( inverse ) modelization in real ( proper ) time .",
    "as the accessible information will differ for the different observers , the models will also differ .",
    "it is only for the part of the space - time that belongs to the common past of two observers that the models may be arbitrarily similar ( although not necessarily identical ) .",
    "note that the assumed smoothness of the metric and of the trajectories will allow not only to obtain a model of space - time in the past of an observer , but also in his future , although the accuracy of his prediction will rapidly degrade with increasing prediction time ( the methodology proposed spontaneously evaluates uncertainties ) .    in some applications , the observer may not need to make a personal modelization , but just use a simple extrapolation of the information about space - time broadcasted by a central observer in charge of all the computations .",
    "it can be shown ( see the lecture by j.m .",
    "pozo in this school ) that in the ` light - coordinates ' @xmath21 being used , the contravariant components of the metric must are have zeros on the diagonal , @xmath22 so the basic unknowns of the problem are the six quantities @xmath23 .",
    "this constraint is imposed exactly , by just expressing all the relations of the theory in terms of these six quantities , @xmath24 , and @xmath25 , one must have @xmath26 , @xmath27 , and @xmath28 .",
    "this constraint is not yet introduced , as it may be strongly simplified when using the logarithmic metric . ] .",
    "the covariant components @xmath29 are defined , as usual , by the condition @xmath30 .",
    "the diagonal components of @xmath29 are _ not _ zero .",
    "let @xmath31 be some simple initial estimation of the space - time metric field .",
    "for instance , we could take for @xmath31 the metric of a flat space - time , the schwarzschild metric of a point mass with the earth s mass , or a realistic estimation of the actual space - time metric around the earth .",
    "we wish that our final estimation of the metric , @xmath32 , is close to the initial estimation .",
    "more precisely , letting @xmath33 be a suitably chosen covariance operator , we are going to impose that the least - squares norm , that is based on a difference of ( contravariant ) metrics , is only provisional . in a more advanced state of the theory",
    ", we should introduce the logarithm of the metric , and base the minimization criterion on the difference of logarithmic metrics .",
    "] @xmath34 is small .",
    "the covariance operator , to be discussed later , shall be a smoothing operator this implying , from one side , that at every point of space - time the final metric is close to the initial metric , and , from another side , that the difference of the two metrics is smooth .",
    "as the initial metric shall be smooth , this imposes that the final metric is also smooth .",
    "in particular , the final metric will be defined ` continously ' , in spite of the fact that we only ` sample ' it along the space - time trajectories of the satellites and of the light signals .",
    "this kind of smoothing , could perhaps be replaced by a criterion imposing that the riemann tensor should be as ` small ' as possible .",
    "the two possibilities must be explored .",
    "the notations use in this text for the connection @xmath35 , the riemann @xmath36 , and the ricci @xmath37 associated to a metric @xmath29 , are as follows : @xmath38 r^\\alpha{}_{\\beta\\gamma\\delta } \\ & = \\",
    "\\partial_\\gamma   \\ , \\gamma^\\alpha{}_{\\delta\\beta }   - \\partial_\\delta   \\ , \\gamma^\\alpha{}_{\\gamma\\beta }   + \\gamma^\\alpha{}_{\\mu\\gamma } \\ , \\gamma^\\mu{}_{\\delta\\beta }    - \\gamma^\\alpha{}_{\\mu\\delta } \\ , \\gamma^\\mu{}_{\\gamma\\beta } \\\\[3pt ]",
    "r_{\\alpha\\beta } \\ & = \\",
    "r^\\gamma{}_{\\alpha\\gamma\\beta } \\quad .",
    "\\\\ \\end{split } \\label{eq : bas - ei - eq}\\ ] ] the einstein tensor is then @xmath39 where @xmath40 .",
    "the einstein equation states that , at every point of the space - time , the einstein tensor @xmath41 ( associated to the metric ) is proportional to the stress - energy tensor @xmath42 describing the matter at this space - time point : @xmath43 where the proportionality constant is @xmath44 .",
    "for instance , in vacuum , @xmath45 , and , therefore , @xmath46 . when solving the einstein equation for @xmath42 , @xmath47 we obtain ( when replacing @xmath41 by the expressions  [ eq : bas - ei - eq-0][eq : bas - ei - eq ] ) the application @xmath48 associating to any metric field @xmath32 the corresponding stress - energy field @xmath49 .",
    "let @xmath50 be our estimation of the stress - energy of the space - time .",
    "it could , for instance , be zero , if we take for the space - time the model of vacuum .",
    "more realistically , we may take a simple model of the rarefied gas that constitutes the high atmosphere .",
    "we wish that the space - time metric @xmath32 is such that the associated stress - energy @xmath51 is close to @xmath50 .",
    "more precisely , we are going to impose that the @xmath52 is small in the sense of a least - squares norm @xmath53 where @xmath54 is a covariance operator to be discussed later .",
    "the notation @xmath55 stands for a duality product .",
    "we shall later need the tangent linear application , @xmath56 , to the application @xmath51 . by definition , @xmath57 as demonstrated in appendix  [ sec : perturbation of einstein tensor ] ( see equations  [ eq : jmp-01][eq : jmp-02 ] ) , this linear tangent application is the ( linear ) application that to every @xmath58 associates the @xmath59 given by @xmath60 where @xmath61      assume that there is a physical clock ( i.e. , a perhaps accurate , but certainly imperfect clock ) on board of some of the satellites . at some instant along the trajectory of such a satelite , a reading of the physical clock is made ( i.e. , the proper time is measured ) , this giving some value @xmath62 with some associated uncertainty .",
    "the theoretical prediction of the observation is made via the integration of the space - time length element along trajectory .",
    "so , given a model of the metric @xmath63 , a model of the trajectory , @xmath64 , and a model of the clock drift , @xmath65 , the prediction of the clock reading is @xmath66 where the integral is performed along the trajectory where the vector @xmath67 is defined ( along the trajectory ) as @xmath68 and where @xmath69 is a parameter along the trajectory .",
    "expression  [ eq : one - single - t ] is written for the evaluation of one single time , while we shall typically many times evaluated along the trajectory , @xmath70 . the application defined by expression  [ eq : one - single - t ] , but considered for all times ,",
    "shall be written as @xmath71    let @xmath72 the set of observed values , with experimental uncertainties represented by a covariance matrix @xmath73 .",
    "we wish that our final model @xmath74 is such that the ( least - squares ) norm @xmath75 is small .    for later use",
    ", we shall need the three ( partial ) linear tangent applications to the application so defined .",
    "they are defined through the series development @xmath76 where , for short , we write @xmath77 , @xmath78 , and @xmath79 , instead of @xmath80 , @xmath81 , and @xmath82 .",
    "one asily sees that @xmath77 is the ( linear ) operator that to any metric perturbation @xmath83 , associates , at each measure point , the time perturbation @xmath84 @xmath78 is the ( linear ) operator that to any trajectory perturbation @xmath85 , associates , at each measure point , the time perturbation @xmath86 where @xmath87 finally , @xmath79 is the ( linear ) operator that to any perturbation @xmath88 of the clock drift function associates @xmath89      at some instant @xmath90 along its trajectory , a satellite emits a time signal , that is received by another satellite at ( proper ) time @xmath91 .    given a model of the metric @xmath63 , a model of the trajectory that emits the signal , @xmath92 , a model of the emission time @xmath90 along this trajectory , a model of the trajectory that receives the signal , @xmath93 , and a model of the clock drift of the receiving satellite , @xmath94 , we can predict the reception time by tracing the zero - length geodesic that connects the emission point to the receiving trajectory .",
    "we shall write this theoretical prediction as @xmath95 in the real situation , the metric is only known approximately , and the computed value of the arrival time will not be identical to the time actually observed time , say @xmath96 .",
    "roughly speaking , our goal is going to be to determine the space - time metric that minimizes the differences between calculated and observed arrival times .    our data , therefore , consists on a set of values @xmath97 assumed to be subjected to some observational uncertainties . letting @xmath98",
    "denote the covariance operator describing experimental uncertainties , we wish the ( least - squares ) norm @xmath99 to be small .",
    "below , we shall need the ( partial ) tangent linear operators to the operator @xmath100 , defined as follows , @xmath101 & \\bfsigma(\\bfg,\\bftau_e,\\tau_e,\\bftau_r,\\bff_r )   + \\bfsigma_{\\bfg } \\",
    ", \\delta \\bfg + \\bfsigma_{\\bftau_e } \\ , \\delta \\bftau_e + \\bfsigma_{\\tau_e } \\ , \\delta \\tau_e   + \\bfsigma_{\\bftau_r } \\ , \\delta \\bftau_r + \\bfsigma_{\\bff_r } \\ , \\delta \\bff_r + \\dots \\quad",
    ". \\\\ \\end{split}\\ ] ] let us evaluate them .",
    "when the metric is perturbed from @xmath29 to @xmath102 , the computed arrival times are perturbed from @xmath91 to @xmath103 , where ( see equation  [ eq : klimes-226 ] in appendix  [ sec : arrival time data-2 ] ) @xmath104 where @xmath67 is the tangent vector to the trajectory of the receiver , @xmath105 , and @xmath106 is the tangent vector to the trajectory of the light ray , @xmath107 ( where @xmath69 is an affine parameter along the ray ) .",
    "therefore , @xmath108 is the linear operator that to any metric perturbation @xmath109 associates the @xmath110 in equation  [ eq : lin - phi-337 ] .    to evaluate the operator @xmath111 we have to solve the following problem : which is the first order perturbation @xmath110 to the arrival time when the trajectory of the emitter is perturbed from @xmath112 to @xmath113 ?",
    "( @xmath114 computation being performed ) .    to evaluate the operator @xmath115 we have to solve the following problem : which is the first order perturbation @xmath110 to the arrival time when the ( proper ) time the emitter is perturbed from @xmath90 to @xmath116 ?",
    "( @xmath114 computation being performed ) .    to evaluate the operator @xmath117 we have to solve the following problem : which is the first order perturbation @xmath110 to the arrival time when the trajectory of the receiver is perturbed from @xmath118 to @xmath119 ?",
    "( @xmath114 computation being performed ) .",
    "the operator @xmath120 is the linear operator that to any perturbation @xmath121 of the receiver clock drift functions associates ( check the notations ) @xmath122      we have to explore here the case where each ` satellite ' has an accelerometer .",
    "the acceleration along a trajectory is @xmath123 where @xmath4 is the proper time along the trajectory .",
    "the easiest way to ` measure ' the acceleration on - board would be , of course , to force the satellite ( or its clock ) to be in free - fall ( i.e. , to follow a geodesic of the spacetime metric ) . then , one would have @xmath124 .",
    "let us keep considering here the general case where the acceleration may be nonzero ( because , for instance , by residual drag by the high atmosphere ) , but it is measured .",
    "the measure of the acceleration provides information on the connection , i.e. , in fact , on the gradients of the metric .",
    "given a model @xmath32 of the metric field and a model @xmath125 of the trajectory , equation  [ eq : acceleration - gamma ] allows to compute the acceleration at all the space - time points when it is measured .",
    "we write @xmath126 the application so defined .",
    "we wish that the computed accelerations , @xmath127 , are close to the observed ones , say @xmath128 .",
    "more precisely , we wish the ( least - squares ) norm @xmath129 to be small , where @xmath130 is a covariance operator describing the experimental uncertainties in the measured acceleration values .",
    "we introduce the tangent linear operators @xmath131    it follows from equation  [ eq : acceleration - gamma ] that a perturbation of the metric @xmath132 , produces a perturbation of the computed acceleration given by @xmath133 .",
    "the expression for @xmath134 is in appendix  [ sec : perturbation of einstein tensor ] ( see equation  [ eq : delta - gamma ] , page  ) , @xmath135 , with @xmath136 .",
    "this gives @xmath137 the linear operator so defined was denoted @xmath138 in equation  [ eq : perturbing - acceleration ] .",
    "to any metric field perturbation @xmath58 this operator associates , at every point of a space - time trajectory where the acceleration was measured , the values @xmath139 just written .",
    "we leave to the reader the characterization of the operator @xmath140 .",
    "a gyroscope is described by its _",
    "spin vector _ ( or angular momentum vector ) @xmath141 , a four - vector that is orthogonal to the four - velocity @xmath67 of the rotating particle : @xmath142 .",
    "assume that the gyroscope follows a trajectory @xmath143 , whose velocity is @xmath144 and whose acceleration @xmath145 is that expressed in equation  [ eq : acceleration - gamma ] .",
    "then , the evolution of the spin vector along the trajectory is described by the so - called fermi - walker transport : @xmath146 should the gyroscope be in free fall , @xmath124 , and @xmath147 , this meaning that the spin vector would be transported by parallelism .    in our case , the monitoring of the spin vector @xmath148 ( besides the monitoring of the acceleration @xmath145 ) would provide the values @xmath149 , an information complementary to that provided by the monitoring of the acceleration ( that provides the values @xmath150 ) .",
    "consider that our data is @xmath151 then we have @xmath152    given the metric field model @xmath32 and the trajectory model @xmath125 , this equation allows to compute the vector @xmath153 at all the space - time points when it is measured .",
    "we write @xmath154 the application so defined .",
    "we wish that the computed values , @xmath155 , are close to the observed ones , say @xmath156 .",
    "more precisely , we wish the ( least - squares ) norm @xmath157 to be small , where @xmath158 is a covariance operator describing the experimental uncertainties in the measured values .",
    "of course , one may not wish to measure the evolution of the spin vector to provide information on the connection , but to ` test ' general relativity , as in the gravity probe b experiment . from the viewpoint of the present work ,",
    "the detection of any inconsistency in the data would put relativity theory in jeopardy .",
    "let us introduce the linear tangent operators @xmath159    the application @xmath160 is given in equation  [ eq : spin - gamma ] . to compute the first order perturbation @xmath161 produced by a perturbation @xmath162",
    ", we must , in this equation , make the replacements @xmath163 and @xmath164 , with subsequent expression of @xmath134 and @xmath165 in terms of @xmath166 .",
    "we obtain @xmath167 using the expression for @xmath134 in appendix  [ sec : perturbation of einstein tensor ] , we are immediately left to an expression similar to  [ eq : delta - a - alpha ] : @xmath168 the operator that to any @xmath58 associates the @xmath169 given by this equation is the operator @xmath170 , we were searching for .",
    "we leave to the reader the evaluation of the operator @xmath171 .      to study the gravity field around the earth , different satellite missions are on course or planned",
    ". of particular importance are the _ gradiometers _ with which modern gravimetric satellites are equipped . in the goce satellite ,",
    "there are three perpendicular `` gradiometer arms '' , each arm consisting in two masses ( 50 cm apart ) that are submitted to electrostatic forces to keep each of them at the center of a cage .",
    "these forces are monitored , thus providing the accelerations .",
    "the basic data are the half - sum and the difference of these accelerations ( for each of the three gradiometer arms ) .",
    "the half - sum of the accelerations gives what a simple accelerometer would give .",
    "the difference corresponds to the `` tidal forces '' in the region where the satellite operates .",
    "a simple model for the gradiometry data is as follows .",
    "a mass follows some space - time line that , to simplify the discussion , is assumed to be a geodesic ( i.e. , the mass is assumed to be in free - fall , but taking into account its possible acceleration would be simple ) .",
    "( we leave to the reader the writing of the general formulas for the case when the initial trajectory is not a geodesic . )",
    "this geodesic is represented at the left in figure  [ fig : gradiometry ] .",
    "let @xmath67 be the unit vector tangent to this geodesic trajectory .",
    "consider , at some initial point along the geodesic , a `` small '' space - time vector @xmath172 that , to fix ideas , may be assumed to be a space - like vector . by parallel transport of @xmath172 along the geodesic one defines a second trajectory , that is not necessarily a geodesic ( the line at the right in figure  [ fig : gradiometry ] ) .",
    "let us denote @xmath173 the tangent vector to this trajectory , and @xmath139 the acceleration along it .",
    "note that , as the trajectory is close to being geodesic , the acceleration @xmath139 is small ( and would vanish if @xmath174 ) .",
    "notice that one has @xmath175 and that ( i ) the tangent vector @xmath173 is obtained , all along the trajectory , by parallel transport of @xmath67 along @xmath172 , and ( ii ) at this level of approximation , the proper time along the second trajectory is identical to the proper time along the first trajectory .",
    "a mass can be forced to follow this line , and the forces required to do this can be monitored , this giving a measurement of the acceleration @xmath139 of the mass .",
    "we do not need to exactly evaluate the theoretical relation expressing @xmath139 , the approximation that is first order in @xmath172 will be sufficient ( because @xmath172 is small ) . as demonstrated by pozo et al .",
    "( 2005 ) , one has @xmath176 , where the remaining terms are at least second order in @xmath172 .",
    "then , with a sufficient approximation , we use below the expression @xmath177 as the three vectors @xmath145 , @xmath67 , and @xmath172 are known , we have a direct information on the components of the riemann tensor .",
    "a typical gradiometer contains three arms ( in three perpendicular directions in space ) .",
    "this means that we have three different vectors @xmath172 with which to apply equation  [ eq : constraints - riemann ] .",
    "the vector @xmath67 is unique ( fixed by the trajectory of the satellite ) .",
    "should one have different satellites at approximately the same space - time point , with significantly different trajectories , one would have extra constraints on the riemann tensor ( at the given space - time point ) .    in order to simplify the notations in later sections of the paper , we drop the @xmath178 for the vector @xmath172 , and we write @xmath179 instead of @xmath139 .",
    "then , equation  [ eq : constraints - riemann ] becomes @xmath180    given a model metric field @xmath32 and a model trajectory @xmath125 , the theoretical values of the tidal acceleration are detoted @xmath181 , and we write @xmath182 where @xmath183 .",
    "the gradiometer provides the ` observed acceleration ' @xmath184 , with observational uncertainties represented by a covariance operator @xmath185 .",
    "we wish that the tidal accelerations , @xmath186 , are close to the observed ones , @xmath184 .",
    "more precisely , we wish the ( least - squares ) norm @xmath187 to be small .    we introduce the linear tangent operators @xmath188    in view of equation  [ eq : constraints - riemann-2 ] , a perturbation of the metric field will produce the perturbation @xmath189 of the tidal acceleration , where @xmath190 is the first order perturbation to the riemann tensor .",
    "this perturbation is obtained as a by product in our computation of the perturbation of the einstein tensor in appendix  [ sec : perturbation of einstein tensor ] ( see equation  [ eq : first - order - riemann ] , page  ) . the result is @xmath191\\beta } \\quad , \\ ] ] where @xmath192 this characterizes the operator @xmath193 .",
    "we leave to the reader the characterization of the operator @xmath194 .",
    "it is clear that we need to optimize for all the components of a complete model , and these include , in particular , the space - time metric and the space - time trajectories . in the context of this school , we choose to present a simplified version of the theory , were only the space - time metric is optimized .",
    "the students should be able to complete the expression of the total misfit , as an exercise .    using standard arguments from least - squares theory ( see tarantola [ 2005 ] ) , we shall define here the ` best metric field ' as the field @xmath32 that minimizes the sum of all the misfit terms introduced above ( equations  [ eq : el - ese - del - e ] , [ eq : el - ese - del - g ] , [ eq : misfit - one ] , [ eq : data - misfit - r ] , [ eq : data - misfit - a ] , [ eq : data - misfit - s ] , and  [ eq : data - misfit - alpha ] ) . the total misfit function , that we denote @xmath195 , is , therefore , given by @xmath196 + & \\vert \\ , \\bfa(\\bfg ) - \\bfa_\\obs \\ , \\vert_{\\bfc_\\bfa}^2 +   \\vert \\ , \\bfpi(\\bfg ) - \\bfpi_\\obs \\ ,",
    "\\vert_{\\bfc_\\bfpi}^2 + \\vert \\ , \\bfomega(\\bfg ) - \\bfomega_\\obs \\ ,",
    "\\vert_{\\bfc_\\bfomega}^2 \\quad , \\\\ \\end{split } \\quad } % end boxed \\label{eq : total misfit}\\ ] ] i.e. , @xmath197 + & \\langle \\ \\bfc_\\bfz^{-1 } \\ , ( \\ , \\bfz(\\bfg ) - \\bfone \\ , ) \\ , \\   ( \\ , \\bfz(\\bfg ) - \\bfone \\ , ) \\",
    "\\rangle \\\\[3 pt ] + & \\langle \\",
    "\\bfc_\\bft^{-1 } \\ , ( \\ , \\bft(\\bfg ) - \\bft_\\obs \\ , ) \\ , \\   ( \\ , \\bft(\\bfg ) - \\bft_\\obs \\ , ) \\",
    "\\rangle \\\\[3 pt ] + & \\langle \\",
    "\\bfc_\\bfsigma^{-1 } \\ , ( \\ , \\bfsigma(\\bfg ) - \\bfsigma_\\obs \\ , ) \\ , \\   ( \\ , \\bfsigma(\\bfg ) - \\bfsigma_\\obs \\ , ) \\",
    "\\rangle \\\\[3 pt ] + & \\langle \\",
    "\\bfc_\\bfa^{-1 } \\ , ( \\ , \\bfa(\\bfg ) - \\bfa_\\obs \\ , ) \\ , \\",
    "( \\ , \\bfa(\\bfg ) - \\bfa_\\obs \\ , ) \\",
    "\\rangle \\\\[3 pt ] + & \\langle \\",
    "\\bfc_\\bfpi^{-1 } \\ , ( \\ , \\bfpi(\\bfg ) - \\bfpi_\\obs \\ , ) \\ , \\ ( \\ , \\bfpi(\\bfg ) - \\bfpi_\\obs \\ , ) \\",
    "\\rangle \\\\[3 pt ] + & \\langle \\",
    "\\bfc_\\bfomega^{-1 } \\ , ( \\ , \\bfomega(\\bfg ) - \\bfomega_\\obs \\ , ) \\ , \\   ( \\ , \\bfomega(\\bfg ) - \\bfomega_\\obs \\ , ) \\",
    "\\rangle \\quad .",
    "\\\\ \\end{split } \\label{eq : total misfit-2}\\ ] ]    sometimes , in least - squares theory it is allowed for these different terms to have different ` weights ' , by multiplying them by some ad - hoc numerical factors .",
    "this is not necessary if all the covariance operators are chosen properly . in any case , adding some extra numerical factors is a trivial task that we do not contemplate here .",
    "although in this paper we limit our scope to providing the simplest method that could be used to actually find the metric field @xmath32 that minimizes the misfit function , it is interesting to know that the function @xmath195 carries a more fundamental information .",
    "in fact , as shown , for instance , in tarantola ( 2005 ) , the expression @xmath198 defines a probability density ( infinite - dimensional ) that represents the information we have on the actual metric field , i.e. , in fact , the respective ` likelihoods ' of all possible metric fields .",
    "we are going to present here a very plain optimization algorithm , based on the newton s method .",
    "this is not a valid candidate for a practical algorithm .",
    "let us see why .",
    "the newton algorithm , as proposed here , produces an ab - initio calculation : one takes all the observations , the a priori information on the complete model and produces the a posteriori information on the complete model .",
    "all the data are treated together .",
    "of course , any practical algorithm should rather use the basic idea of a _ kalman filter _ :",
    "data are integrated into the computation as they are available ( see appendix  [ sec : kalman filter ] for a short description of the linear kalman filter ) .    in itself , this in an important topic for our future research",
    ": kalman filter computations are made in real time , but what is ` real time ' in the context of the relativistic physics used here ?",
    "it turns out that ` real time ' is replaced in this context by ` proper observer time ' and that the data integrated by an observer in his kalman filter are the data arriving to him at this moment , i.e. , the data belonging to the ` surface ' of his past light cone .",
    "we leave this advanced topic out from the teachings of this school .",
    "therefore , we proceed with the analysis of a simple steepest - descent algorithm .      once the misfit function @xmath195 as been defined ( equation  [ eq : total misfit-2 ] ) , and",
    "the associated probability distribution @xmath199 has been introduced ( equation  [ eq : total misfit proba ] ) , the ideal ( although totally impractical ) approach for extracting all the information on @xmath32 brought by the data of our problem would be to sample the probability distribution are considered , this discretization rendering the probability distribution finite - dimensional . ] @xmath199 .",
    "examples of the sampling of a probability distribution in the context of inverse problems can be found in tarantola ( 2005 ) .    in the present problem , where the initial metric shall not be too far from the actual metric",
    ", the nonlinearities of the problem are going to be weak .",
    "this implies that the probability distribution @xmath199 is monomodal , i.e. , the misfit function @xmath195 has a unique minimum ( in the region of interest of the parameter space ) .",
    "therefore , the general sampling techniques can here be replaced by the much more efficient optimization techniques .",
    "the basic question becomes : _ for which metric field @xmath32 the misfit function @xmath195 attains its minimum ? _",
    "this problem can be solved using gradient - based techniques .",
    "these techniques are quite sophisticated , and require careful adaptation to the problem at hand if they have to work with acceptable efficiency . as we do not wish to develop this topic in this paper , we just choose here to explore the simple steepest descent algorithm , while we explore the more complete newton algorithm in appendix  [ sec : newton algorithm ] .    to run a steepest descent optimization algorithm , there is only one evaluation that must be done extremely accurately , the evaluation of the direction of steepest ascent .",
    "for this one may use the formulas developed in tarantola ( 2005 ) .",
    "one obtains the following direction of steepest ascent , @xmath200 & + ( \\bft_k \\ , \\bfc_\\bfg)^t \\ , \\bfc_\\bft^{-1 } \\ , ( \\bft(\\bfg_k ) - \\bft_\\obs ) \\\\[3 pt ] & + ( \\bfsigma_k \\ , \\bfc_\\bfg)^t \\ ,                   \\bfc_\\bfsigma^{-1 } \\ , ( \\bfsigma(\\bfg_k ) - \\bfsigma_\\obs ) \\\\[3 pt ] & + ( \\bfa_k \\ , \\bfc_\\bfg)^t \\ , \\bfc_\\bfa^{-1 } \\ , ( \\bfa(\\bfg_k ) - \\bfa_\\obs ) \\\\[3 pt ] & + ( \\bfpi_k \\ , \\bfc_\\bfg)^t \\ , \\bfc_\\bfpi^{-1 } \\ , ( \\bfpi(\\bfg_k ) - \\bfpi_\\obs ) \\\\[3 pt ] & + ( \\bfomega_k \\ , \\bfc_\\bfg)^t \\ ,                        \\bfc_\\bfomega^{-1 } \\ , ( \\bfomega(\\bfg_k ) - \\bfomega_\\obs ) \\quad , \\\\ \\end{split } \\quad } % end boxed \\label{eq : gradient vector - new}\\ ] ] where the linear operators @xmath201 , @xmath202 , @xmath203 , @xmath204 , @xmath205 , and @xmath206 have all been introduced above .",
    "the meaning of @xmath207 in the above should be obvious .",
    "we say _ transpose _ operators , better than _ dual _ operators , because the difference between the two notions matters inside the theory of least - squares , @xmath208 , @xmath209 , @xmath210 , @xmath211 , and @xmath212 .",
    "see tarantola ( 2005 ) for details . ] .",
    "the newton algorithm presented in appendix  [ sec : newton algorithm ] , is typically not used as such .",
    "one rather uses a ` preconditioned steepest descent algorithm ' , @xmath213 where @xmath214 is an ad - hoc positive definite operator , suitably chosen to produce a convergence of the algorithm as rapid as possible .",
    "should one choose to use for @xmath214 the hessian of the misfit function , one would obtain the newton algorithm .    alternatively , one may choose to use a ` relaxation algorithm ' , where succesive ` jumps ' are performed along the different directions defined by the different terms in equation  [ eq : gradient vector - new ] .",
    "one should keep in mind that to obtain a proper estimation of the posterior uncertainties in the metric , one needs the evaluation of the inverse of the hessian operator ( see appendix  [ sec : newton algorithm ] ) .",
    "let @xmath215 be a linear operator mapping a linear space @xmath216 into a linear space @xmath217 .",
    "let @xmath218 and @xmath219 the respective dual spaces , and @xmath220 and @xmath221 the respective duality products .",
    "the transpose of @xmath215 is the linear operator mapping @xmath219 into @xmath218 such that for any @xmath222 and any @xmath223 , @xmath224 for a good text on functional analysis , in particular on the transpose and adjoint of a linear operator , see taylor and lay ( 1980 ) .",
    "some of the results in the following sections are provided without demonstration : to check the proposed results , the reader should become familiar with the concepts proposed in that book .",
    "let us only mention here two elementary results .",
    "the transpose of the linear operator defined through @xmath225 is the linear operator defined through @xmath226 the transpose of the linear operator defined through @xmath227 is the linear operator defined through @xmath228 there are typically some boundary conditions to be attached to a differential operator , what implies for the transpose operator a set of ` dual ' boundary conditions , but we shall not enter into these ` details ' in this preliminary version of the theory .      considering the two duality products @xmath229 the transpose operator @xmath230 is defined by the condition that for any @xmath231 and for any @xmath109 , one must have @xmath232 using equation  [ eq : eva - t - k-1 ] and the expression of the duality products , this can be written @xmath233^{\\alpha\\beta } \\",
    "\\delta g_{\\alpha\\beta } \\",
    "= \\ \\\\ & \\frac{1}{\\chi } \\int d\\tau^1\\int d\\tau^2\\int d\\tau^3\\int d\\tau^4 \\",
    "\\delta\\hat{t}^{\\alpha\\beta } \\",
    "\\big ( \\   a_{\\alpha\\beta}{}^{\\mu\\nu,\\rho\\sigma } \\ , \\nabla_{\\!(\\rho}\\nabla_{\\!\\sigma ) } \\ , \\delta g_{\\mu\\nu }   + b_{\\alpha\\beta}{}^{\\mu\\nu } \\ , \\delta g_{\\mu\\nu } \\",
    "\\big ) \\quad .",
    "\\end{split } \\label{eq : from - met - toc55}\\ ] ] to compute the direction of steepest descent we need to evaluate the term @xmath234 , i.e. , we need to evaluate @xmath235_{\\gamma\\delta } ( \\sigma^1,\\sigma^2,\\sigma^3,\\sigma^4 ) \\\\ & = \\   \\int d\\tau^1\\int d\\tau^2\\int d\\tau^3\\int d\\tau^4 \\",
    "\\left [ \\bft^t \\ , \\delta\\hat{\\bft } \\right]^{\\alpha\\beta } ( \\tau^1,\\tau^2,\\tau^3,\\tau^4 ) \\   c_{\\alpha\\beta\\gamma\\delta}(\\tau^1,\\tau^2,\\tau^3,\\tau^4 , \\sigma^1,\\sigma^2,\\sigma^3,\\sigma^4 ) \\quad .",
    "\\\\ \\end{split}\\ ] ] this can be evaluated by just replacing @xmath236 by @xmath237 in equation  [ eq : from - met - toc55 ] .",
    "one gets @xmath235_{\\gamma\\delta } ( \\sigma^1,\\sigma^2,\\sigma^3,\\sigma^4 ) \\ = \\",
    "\\\\[5 pt ] & \\frac{1}{\\chi } \\int d\\tau^1\\int d\\tau^2\\int d\\tau^3\\int d\\tau^4 \\",
    "\\delta\\hat{t}^{\\alpha\\beta}(\\tau^1,\\tau^2,\\tau^3,\\tau^4 ) \\\\ & \\big ( \\   a_{\\alpha\\beta}{}^{\\mu\\nu,\\rho\\sigma}(\\tau^1,\\tau^2,\\tau^3,\\tau^4 ) \\",
    "\\nabla_{\\!(\\rho}\\nabla_{\\!\\sigma ) } \\ , c_{\\mu\\nu\\gamma\\delta } ( \\tau^1,\\tau^2,\\tau^3,\\tau^4,\\sigma^1,\\sigma^2,\\sigma^3,\\sigma^4 ) \\\\[5 pt ] & + b_{\\alpha\\beta}{}^{\\mu\\nu}(\\tau^1,\\tau^2,\\tau^3,\\tau^4 )",
    "\\   c_{\\mu\\nu\\gamma\\delta}(\\tau^1,\\tau^2,\\tau^3,\\tau^4,\\sigma^1,\\sigma^2,\\sigma^3,\\sigma^4 ) \\",
    "\\big ) \\quad .",
    "\\end{split } \\label{eq : from - met - toc555}\\ ] ]      for each satellite trajectory , to any space - time metric field perturbation @xmath236 , expression  [ eq : lin - phi-337 ] associates the scalar @xmath238 defined along the trajectory .",
    "let us here characterize the transpose , @xmath239 , of this operator .",
    "considering the two duality products @xmath240 the transpose operator is defined by the condition that for any @xmath241 and for any @xmath109 , one must have @xmath242 using equation  [ eq : lin - phi-337 ] and the expression of the duality products , this can be written @xmath243^{\\alpha\\beta } ( \\tau^1,\\tau^2,\\tau^3,\\tau^4 ) \\",
    "\\delta g_{\\alpha\\beta}(\\tau^1,\\tau^2,\\tau^3,\\tau^4 ) \\\\ & = \\ \\int d\\tau \\",
    "\\delta\\hat{\\sigma}(\\tau ) \\   \\left ( - \\frac{1/2}{g_{\\mu\\nu}(\\tau^\\kappa(\\tau ) ) \\ , u^\\mu(\\tau ) \\ ,   \\ell^\\nu(\\tau ) }   \\",
    "\\int_{\\lambda(\\bfg,\\tau ) } d\\lambda \\",
    "\\ell^\\alpha(\\lambda ) \\ ,   \\ell^\\beta(\\lambda ) \\ , \\delta g_{\\alpha\\beta}(\\tau^\\kappa(\\lambda))\\right ) \\quad .",
    "\\\\ \\end{split } \\label{eq : from - met - toc}\\ ] ] to compute the direction of steepest descent we need to evaluate the term @xmath244 , i.e. , we need to evaluate @xmath245_{\\gamma\\delta } ( \\sigma^1,\\sigma^2,\\sigma^3,\\sigma^4 ) \\\\ & = \\   \\int d\\tau^1\\int d\\tau^2\\int d\\tau^3\\int d\\tau^4 \\",
    "\\left [ \\bfsigma^t \\ , \\delta\\hat{\\bfsigma } \\right]^{\\alpha\\beta } ( \\tau^1,\\tau^2,\\tau^3,\\tau^4 ) \\   c_{\\alpha\\beta\\gamma\\delta}(\\tau^1,\\tau^2,\\tau^3,\\tau^4 , \\sigma^1,\\sigma^2,\\sigma^3,\\sigma^4 ) \\quad .",
    "\\\\ \\end{split}\\ ] ] this can be evaluated by just replacing @xmath236 by @xmath237 in equation  [ eq : from - met - toc ] .",
    "one gets @xmath245_{\\gamma\\delta } ( \\sigma^1,\\sigma^2,\\sigma^3,\\sigma^4 ) \\ = \\",
    "\\int d\\tau \\",
    "\\delta\\hat{\\sigma}(\\tau ) \\   \\left ( - \\frac{1/2}{g_{\\mu\\nu}(\\tau^\\kappa(\\tau ) ) \\ , u^\\mu(\\tau ) \\",
    ",   \\ell^\\nu(\\tau ) }   \\right .",
    "\\\\ & \\left .",
    "\\int_{\\lambda(\\bfg,\\tau ) } d\\lambda \\",
    "\\ell^\\alpha(\\lambda ) \\ ,   \\ell^\\beta(\\lambda ) \\ ,",
    "c_{\\alpha\\beta\\gamma}(\\tau^1(\\lambda),\\tau^2(\\lambda),\\tau^3(\\lambda),\\tau^4(\\lambda ) , \\sigma^1,\\sigma^2,\\sigma^3,\\sigma^4)\\right ) \\quad .",
    "\\\\ \\end{split}\\ ] ] as the covariance function @xmath237 shall be a smooth function , we see that this equation ` spreads ' the arrival time residuals into the region of the space - time that is around each satellite trajectory .",
    "it follows from equation  [ eq : delta - a - alpha ] that the transpose operator @xmath246 is the linear operator that to any @xmath247 , defined at the points where the acceleration was measured , associates , at the same points , the values @xmath248 this operator appears in equations  [ eq : gradient vector 2 ] and  [ eq : final linear system ] .",
    "the operator , @xmath249 , transpose of the operator @xmath170 characterized in equation  [ eq : delta - pi - alpha ] is @xmath250 it appears in equations  [ eq : gradient vector 2 ] and  [ eq : final linear system ] .",
    "the operator @xmath193 was characterized in equations  [ eq : bf - omega-1][eq : bf - omega-3 ] . the transpose operator , @xmath251 , associates to any @xmath252 the @xmath253 given by @xmath254 it appears in equations  [ eq : gradient vector 2 ] and  [ eq : final linear system ] .",
    "we have been able to develop a consistent theory , fully relativistic , where the data brought by satellites emitting and receiving time signals is used to infer trajectories and the space - time metric .",
    "this constitutes both , a kind of ultimate gravimeter and a positioning system .",
    "any observer with receiving capabilities shall know its own space - time trajectory `` in real time '' .",
    "these coordinates are not the usual ` geographical ' coordinates plus a time , but are four times .",
    "the problem of attaching these four time coordinates to any terrestrial system of coordinates is just an attachment problem that should not interfere with the basic problem of defining an accurate reference system , and of knowing space - time trajectories into this system .    for more generality",
    ", we have considered the possibility that the satellites may have accelerometers , gradiometers , or gyroscopes .",
    "this is because the positioning problem and the problem of estimating the gravity field ( i.e. , the space - time metric ) are coupled . if fact",
    ", all modern gravimetry satellite missions are coupled with gnss satellites .",
    "our theory applies , in particular , to the goce satellite mission ( orbiting gradiometers ) .",
    "it also applies to the gravity probe b or the lisa experiments , that could be analyzed using the concepts presented here .",
    "the optimization algorithm proposed ( newton algorithm ) is by no means the more economical to be used in the present context , and considerable effort is required to propose a practical algorithm , possibly using the ` kalman filter ' approach briefly mentioned in appendix  [ sec : kalman filter ] .",
    "we are quite confident in our prediction that , some day , all positioning systems will be run using the basic principles exposed in this paper : the ever - increasing accuracy of time measurements with eventually force everyone to take relativity theory seriously at last.",
    "ashby , n. , 2002 , relativity and the global positioning system , physics today , 55 ( 5 ) , may 2002 , pp .  4147 .",
    "blagojevi , m. , j.  garecki , f.w .",
    "hehl , and yu.n .",
    "obukhov , 2001 , real null coframes in general relativity and gps type coordinates , arxiv : gr - qc/0110078v3 .",
    "ciarlet , p.g . , 1982 ,",
    "introduction  lanalyse numrique matricielle et  loptimisation , masson , paris .",
    "erven ,  v. , 2002 , fermat s variational principle for anisotropic inhomogeneous media , stud .",
    "geophys .",
    "46 , pp .",
    "( http://sw3d.mff.cuni.cz ) .",
    "ciufolini , i. , and pavlis , e.c . , 2004 , a confirmation of the general relativistic prediction of the lense - thirring effect , nature , vol .  431 , pp .  958960 .",
    "coll , b. , 1985 , coordenadas luz en relatividad , proc .",
    "spanish relativity meeting , ere-85 , publ .",
    "servei publ .",
    "etseib , barcelona , p 2939 .",
    "english translation ( light coordinates in relativity ) at    http://    -0.4 mm1 mm syrte.obspm.fr/@xmath255coll/papers/coordinatesystems/lightcoordinates.pdf    coll , b. , and morales , j.a . , 1992 , 199 causal classes of space - time frames , international journal of theoretical physics , vol .  31 , no .  6 , pp .  10451062 .    coll , b. , 2000 , elements for a theory of relativistic coordinate systems , formal and physical aspects , eres 2000 , valladolid",
    ".    coll , b. , 2001a , elements for a theory of relativistic coordinate systems ; formal and physical aspects , proc .",
    "xxiii spanish relativity meeting ere2000 , world scientific .",
    "coll , b. , 2001b , physical relativistic frames , jsr 2001 , ed .",
    "n.  capitaine , pub .",
    "observatoire de paris , pp .",
    "169174 .",
    "coll , b. , 2002 , a principal positioning system for the earth , jsr 2002 , eds .",
    "n.  capitaine and m.  stavinschi , pub .",
    "observatoire de paris , pp .",
    "coll , b.  and tarantola , a. , 2003 , galactic positioning system ; physical relativistic coordinates for the solar system and its surroundings , eds .",
    "a.  finkelstein and n.  capitaine , jsr 2003 , pub .",
    "petersbourg observatory , pp .",
    "333 - 334 .",
    "gordon , w. , 1923 , ann .",
    "( leipzig ) , 72 , p.  421 .",
    "grewal , m.s . ,",
    "weill , l.r .",
    ", and andrews , a.p . , 2001 , global positioning systems , inertial navigation , and integration , john wiley & sons .",
    "hernndez - pastora , j.l . ,",
    "martn , j. , and ruiz , e. , 2001 , on gyroscope precession , arxiv : gr - qc/0009062 .",
    "klime ,  l. , 2002 , second - order and higher - order perturbations of travel time in isotropic and anisotropic media , stud .",
    "geophys .",
    "46 , pp .  213248 .",
    "( http://sw3d.mff.cuni.cz ) .",
    "papapetrou , a. , 1951 , spinning test - particles in general relativity ( i ) , proceedings of the royal society of london .",
    "a209 , pp .",
    "248258    pham mau quan , 1957 , arch .",
    ".  and anal . , 1 , p.  54 .",
    "rovelli , c. , 2002 , gps observables in general relativity , phys .",
    "d 65 , 044017 . posted in the arxiv in 2001 as arxiv : gr - qc/0110003 .",
    "tarantola , a. , 2005 , inverse problem theory and methods for model parameter estimation , siam .",
    "taylor , a.e . , and lay , d.c .",
    ", 1980 , introduction to functional analysis , wiley .",
    "weinberg , s. , 1972 , gravitation and cosmology , wiley .",
    "when introducing the perturbations  [ eq : per - met-1][eq : per - met-2 ] in the expressions  [ eq : bas - ei - eq ] , one obtains , keeping only first order terms in @xmath58 , the perturbation @xmath260 of the einstein tensor .",
    "we consider the perturbation of the metric and the perturbation of the connection .",
    "@xmath261 in this appendix , and in order to make the expressions more compact , let us denote @xmath262 we will use the unperturbed metric to raise and lower indices . for instance , we will write @xmath263 .    by requiring that both , the unperturbed and the perturbed connection , to be metric , @xmath264 , and symmetric , @xmath265}=0 $ ] , we get : @xmath266}=0 \\end{array } \\right\\ } \\ \\rightarrow\\   g'_{\\alpha\\delta}\\omega^\\delta{}_{\\beta\\gamma}= \\frac{1}{2 } \\ , ( \\nabla_{\\!\\gamma } h_{\\alpha\\beta}+\\nabla_{\\!\\beta } h_{\\alpha\\gamma}-\\nabla_{\\!\\alpha } h_{\\beta\\gamma } ) \\ .\\ ] ] then",
    ", @xmath267 is obtained by contracting this expression with the inverse of the perturbed metric @xmath268 .",
    "but the first order is given by the contraction with the unperturbed one : @xmath269 the two riemann tensors are related by @xmath270\\beta}+2\\omega^\\alpha{}_{\\mu[\\gamma}\\omega^\\mu{}_{\\delta]\\beta } \\ .\\ ] ] thus , the first order perturbation of the riemann is given by @xmath271\\beta } \\ , \\label{eq : first - order - riemann}\\ ] ] from which we get the first order perturbation of the ricci tensor : @xmath272\\alpha}= \\nabla_{\\![\\delta}\\nabla_{\\!\\beta]}h^\\delta{}_\\alpha + \\frac{1}{2 } \\ , ( \\nabla_{\\!\\delta}\\nabla_{\\!\\alpha}h^\\delta{}_\\beta   -\\nabla_{\\!\\beta}\\nabla_{\\!\\alpha}h^\\delta{}_\\delta ) -\\frac{1}{2 } \\ , ( \\nabla_{\\!\\delta}\\nabla^\\delta h_{\\alpha\\beta } + \\nabla_{\\!\\beta}\\nabla^\\delta h_{\\alpha\\delta } ) \\ .\\ ] ] splitting into symmetric and intisymmetric parts of the two covariant derivatives @xmath273}h^\\delta{}_\\alpha",
    "+ \\frac{1}{2 } \\ , \\nabla_{\\![\\delta}\\nabla_{\\!\\alpha]}h^\\delta{}_\\beta   + \\frac{1}{2 } \\ , \\nabla_{\\![\\beta}\\nabla_{\\!\\delta ] } h^\\delta{}_\\alpha   \\\\ & { } + \\frac{1}{2 } \\ , \\nabla_{\\!(\\delta}\\nabla_{\\!\\alpha)}h^\\delta{}_\\beta   - \\frac{1}{2 } \\ , \\nabla_{\\!(\\beta}\\nabla_{\\!\\alpha)}h^\\delta{}_\\delta - \\frac{1}{2 } \\",
    ", \\nabla_{\\!\\delta}\\nabla^\\delta h_{\\alpha\\beta } + \\frac{1}{2 } \\ , \\nabla_{\\!(\\beta}\\nabla_{\\!\\delta ) } h^\\delta{}_\\alpha   \\ . \\end{array}\\ ] ] substituting now the identity @xmath274}h^\\delta{}_\\beta",
    "= r^\\delta{}_{\\mu \\delta \\alpha } \\ , h^\\mu{}_\\beta -r^\\mu{}_{\\beta\\delta \\alpha } \\ , h^\\delta{}_\\mu $ ] and introducing the notation @xmath275",
    "@xmath276    in order to obtain the perturbation of the ricci scalar we also need the perturbation of the contravariant metric : @xmath277 thus , the perturbation of the ricci scalar is @xmath278 finally we obtain the first order perturbation of the einstein tensor , @xmath279 this result can be rewriten as @xmath280 with @xmath281 note that using he definition  [ eq : h - as - h ] , equation  [ eq:195729 ] can be written , explicitly , @xmath282    observe that , by construction , the two tensors @xmath283 and @xmath284 are symmetrics in each pair of indices , @xmath285 in addition , it results that @xmath286 is symmetric respect to the interchange of the two contravariant pairs : @xmath287 this implies that not all the information in @xmath288 contrubutes to @xmath289 .",
    "in fact , we can express the term @xmath290 in an interesting form .",
    "let us define @xmath291|\\gamma]}$ ] .",
    "this tensor contains less information than @xmath292|\\delta]}$ ] , and has the same symmetries as a riemann : @xmath293[\\gamma\\delta]}=j_{\\gamma\\delta \\alpha\\beta }   \\qquad\\mbox{and}\\qquad j_{\\alpha[\\beta\\gamma\\delta]}=0 \\ .\\ ] ] we can then take the traces of this tensor ( obtaining a ricci - like tensor and scalar ) : @xmath294 and @xmath295 . then , it is easy to check that the contribution of @xmath288 is only the einstein - like tensor of @xmath296 : @xmath297 in contrast , observe that @xmath298 contains all the information of the riemann tensor .",
    "it is easy to understand the meaning of @xmath299 . while @xmath100 associates to any metric @xmath32 some arrival times @xmath302 , the operator @xmath299 associates to every metric perturbation @xmath303 ( around @xmath32 ) the perturbation @xmath304 of arrival times .",
    "let us compute these perturbations .",
    "proper time @xmath305 in the finsler space satisfies the stationary hamilton - jacobi equation @xmath306 where @xmath307 is the hamiltonian .",
    "the geodesics can then be described by the hamilton equations @xmath308 @xmath309 with initial conditions @xmath310 then @xmath311 \\ = \\ p_\\alpha(\\lambda ) \\quad \\label{eq : klimes-205}\\ ] ] along the geodesics .",
    "parameter @xmath312 along a geodesic is determined by the form of the hamiltonian and by initial conditions ( equation  [ eq : klimes-204 ] ) for the geodesic .",
    "proper time @xmath305 along the geodesic is then given by @xmath313 which follows from equations  [ eq : klimes-202 ] and  [ eq : klimes-205 ] .",
    "note that equal geodesics may be generated by various hamiltonians .",
    "for example , hamiltonian @xmath314 $ ] , where @xmath315 is an arbitrary function with a non  vanishing finite derivative at @xmath316 equal to the right  hand side of equation  [ eq : klimes-201 ] , yields equal geodesics as hamiltonian @xmath307 .",
    "the hamiltonian is often chosen as a homogeneous function of degree @xmath317 in @xmath318 .",
    "especially , homogeneous hamiltonians of degrees @xmath319 , @xmath320 or @xmath321 are frequently used .    if the hamiltonian is chosen as a homogeneous function of degree @xmath319 in @xmath318 , and is properly normalized , then @xmath322 is the contravariant finslerian metric tensor . if metric tensor in equation  [ eq : klimes-207 ] is independent of @xmath323 , @xmath324 the finsler space reduces to the _ riemann space_.",
    "on the other hand , if we know the contravariant metric tensor , we may construct a homogeneous hamiltonian of degree @xmath317 in @xmath318 as @xmath325^{n\\over2 } \\quad .",
    "\\label{eq : klimes-209}\\ ] ] whereas degree @xmath317 may be arbitrary for spatial or time - like geodesics , @xmath326 should be avoided for zero - length geodesics in order to keep the right  hand sides of hamilton equations  [ eq : klimes-202 ] and  [ eq : klimes-203 ] finite and non - vanishing identically .    for homogeneous hamiltonians ( equation  [ eq : klimes-209 ] ) , equation  [ eq : klimes-206 ] reads @xmath327^{n\\over2 } \\quad , \\label{eq : klimes-210}\\ ] ] and equation  [ eq : klimes-202 ] yields @xmath328^{n-1 } \\quad .",
    "\\label{eq : klimes-211}\\ ] ] considering equation  [ eq : klimes-211 ] , equation  [ eq : klimes-210 ] , can be expressed in the form @xmath329^{n\\over2(n-1 ) } \\quad .",
    "\\label{eq : klimes-212}\\ ] ] in the hamiltonian formulation , the finsler geometry is no more complex than the riemann geometry .      the first - order perturbation of proper time ( equation  [ eq : klimes-206 ] ) is ( klime , 2002 , eq .  25 ) @xmath330 if we wish to perform perturbations with respet to the components of the metric tensor along zero  length space ",
    "time geodesics , homogeneous hamiltonians ( equation  [ eq : klimes-209 ] ) should be of degree @xmath319 to avoid zero or infinite perturbations @xmath331 of the hamiltonian .",
    "one alternative to the present hamiltomian formulation , would be to use a lagrangian formulation of the first degree , this leading to the usual fermat s integral .",
    "there are four reasons why the formulation here presented is better :    * perturbations of a homogeneous lagrangian of degree @xmath317 with respect to the components of the metric tensor are zero for @xmath332 and infinite for @xmath333 , which results in singularities in the computation ; * hamilton equations beak down for @xmath326 , which would prevent us from using efficient tools of hamiltonian formulation ; * dual legendre transform between homogeneous hamiltonian and lagrangian of the first degree is not possible ( erven , 2002 ) , which also holds for spatial and time  like geodesics ; * the integral is generally complex - valued for indefinite metric tensors .    in the following , we shall thus consider an homogeneous hamiltonian ( equation  [ eq : klimes-209 ] ) of degree @xmath319 , @xmath334 equation  [ eq : klimes-202 ] then reads @xmath335 and equation  [ eq : klimes-213 ] , with @xmath336 , reads @xmath337 inserting @xmath338 , we obtain @xmath339 inserting equation  [ eq : klimes-215 ] into equation  [ eq : klimes-219 ] , we arrive at @xmath340      assume the trajectory @xmath341 parametrized by proper time @xmath342 along it ( in general , @xmath342 may represent an arbitrary parameter along the trajectory ) . a light signal emitted at the given point will hit the given trajectory at proper time @xmath343 .",
    "assume now that the space ",
    "time metric is perturbed from @xmath344 to @xmath345.the light signal will now hit the trajectory at proper time @xmath346 .",
    "we shall now derive the first order relation between @xmath347 and delta @xmath344 .",
    "the space - time wavefront may be expressed in the form @xmath348 where @xmath349 is measured along the geodesic from the given point to point @xmath350 .",
    "the geodesics can be calculated by hamiltonian ray tracing from the given point .",
    "proper time @xmath342 at the point of intersection of the trajectory with the space - time wavefront then satisfies equation @xmath351 perturbation of this equation yields @xmath352 then @xmath353 inserting @xmath318 from equation  [ eq : klimes-215 ] for @xmath354 and equation  [ eq : klimes-220 ] for @xmath355 , equation  [ eq : klimes-225 ] can be expressed in the form @xmath356^{-1 } \\int_{\\lambda_0}^{\\lambda}{\\rm d}\\lambda\\ ; { { \\rm d}x^\\alpha\\over{\\rm d}\\lambda } \\delta g_{\\alpha\\beta } { { \\rm d}x^\\beta\\over{\\rm d}\\lambda }   \\quad .",
    "\\label{eq : klimes-226}\\ ] ]      let @xmath31 some reference space - time metric ( for instance the minkowski or the schwarzschild metric ) , and let @xmath32 be the actual metric . in the simple ( and a little bit simplistic ) approach proposed here , it is assumed that the difference @xmath357 is small , and is assumed to be a random realization of a gaussian random field with zero mean and prescribed covariance .",
    "because in the light coordinates used here it is the contravariant metric that has some simple properties , the difference in equation  [ eq : dii - mert ] is taken using the contravariant components .    to obtain a reasonable model of covariance operator for the metric",
    ", we could perform a thought experiment .",
    "we imagine a large number of metric fields , all of the form @xmath358 at every point , all smoothly varying over space - time , and with the quantities @xmath359 randomly varying around the values corresponding to the reference metric , with prescribed , simple probability distributions ( independent , to start with ) .",
    "the we could evaluate the covariance of such a ` random field ' using the direct definition of covariance : @xmath360 & \\overline { \\left(g^{\\alpha\\beta}(\\tau^1,\\tau^2,\\tau^3,\\tau^4 ) -   \\overline{g^{\\alpha\\beta}(\\tau^1,\\tau^2,\\tau^3,\\tau^4)}\\right ) \\",
    "\\left(g^{\\mu\\nu}(\\sigma^1,\\sigma^2,\\sigma^3,\\sigma^4 ) -   \\overline{g^{\\mu\\nu}(\\sigma^1,\\sigma^2,\\sigma^3,\\sigma^4)}\\right ) } \\ , \\end{split}\\ ] ] where @xmath361 means the mean value of @xmath362 .",
    "the mean metric @xmath363 would be the reference metric .",
    "another option is to try to insert more constraints that we know are satisfied by the metric .",
    "for instance , pozo ( 2005 ) shows that the metric has necessarily the form @xmath364 where the constants @xmath365 are positive , and the constants @xmath366 should satisfy the constraint that a triangle exists in the euclidean plane whose sides have the lengths @xmath367 .",
    "one could perhaps use the six quantities @xmath368 as basic quantities , and assume a gaussian distribution for some simple functions of them .",
    "we do not explore yet this possibility .",
    "also , it is very likely that the basic variable to be used in the optimization problem is not the metric @xmath359 , but the logarithmic metric .",
    "this point is , for the time being , not examined .",
    "we do nt try to be more specific at this point , we simply assume that some covariance function @xmath369 is chosen .",
    "the inverse @xmath370 of the covariance operator ( a distribution ) has the kernel @xmath371 by definition ( formally ) @xmath372 & = \\ \\delta_\\alpha^\\mu \\ , \\delta_\\beta^\\nu \\ , \\delta(\\tau^1-\\sigma^1 ) \\ , \\delta(\\tau^2-\\sigma^2 ) \\ , \\delta(\\tau^3-\\sigma^3 ) \\ , \\delta(\\tau^4-\\sigma^4 )",
    "\\quad , \\end{split}\\ ] ] where @xmath373    the operators @xmath374 and @xmath375 being symmetric and positive definite , define a bijection between @xmath376 , the space of metric field perturbations and its dual , @xmath377 .",
    "we shall write @xmath378 explicitly , @xmath379 and @xmath380    the duality product of a dual metric field perturbation @xmath381 by a metric field perturbation @xmath382 is defined as @xmath383 the scalar product of two metric field perturbations is @xmath384 and the norm of a metric field perturbation is @xmath385        while in section  [ sec : iterative algorithm ] we have examined the simple steepest descent algorithm , let us now develop the quasi - newton method . to obtain the actual algorithm , one may use the formulas developed in tarantola ( 2005 ) .",
    "the resulting iterative algorithm can be written @xmath387 where the ` hessian operator ' @xmath388 is @xmath389 the ` gradient vector ' is @xmath390 & + ( \\bft_k \\ , \\bfc_\\bfg)^t \\ , \\bfc_\\bft^{-1 } \\ , ( \\bft(\\bfg_k ) - \\bft_\\obs ) \\\\[3 pt ] & + ( \\bfsigma_k \\ , \\bfc_\\bfg)^t \\ , \\bfc_\\bfsigma^{-1 } \\ , ( \\bfsigma(\\bfg_k ) - \\bfsigma_\\obs ) \\\\[3 pt ] & + ( \\bfa_k \\ , \\bfc_\\bfg)^t \\ , \\bfc_\\bfa^{-1 } \\ , ( \\bfa(\\bfg_k ) - \\bfa_\\obs ) \\\\[3 pt ] & + ( \\bfpi_k \\ , \\bfc_\\bfg)^t \\ , \\bfc_\\bfpi^{-1 } \\ , ( \\bfpi(\\bfg_k ) - \\bfpi_\\obs ) \\\\[3 pt ] & + ( \\bfomega_k \\ , \\bfc_\\bfg)^t \\ , \\bfc_\\bfomega^{-1 } \\ , ( \\bfomega(\\bfg_k ) - \\bfomega_\\obs ) \\quad , \\\\",
    "\\end{split } \\label{eq : gradient vector}\\ ] ] where the linear operators @xmath201 , @xmath202 , @xmath203 , @xmath204 , @xmath205 , and @xmath206 , are the frchet derivatives ( tangent linear applications ) of the operators @xmath391 , @xmath51 , @xmath392 , @xmath127 , @xmath155 , and @xmath393 , introduced in equations  [ eq : defino - t ] , [ eq : defino - z ] , [ eq : defino - sigma ] , [ eq : defino - a ] , [ eq : defino - s ] , and  [ eq : defino - omega ] , all the operators evaluated for @xmath394 , and where @xmath395 denotes the transpose of a linear operator @xmath215 .",
    "we say _ transpose _ operators , better than _ dual _ operators , because the difference between the two notions matters inside the theory of least - squares .",
    "the quasi - newton algorithm  [ eq : newton - algorithm ] can be initialized at an arbitrary point ( i.e. , at any metric field ) @xmath300 .",
    "if working in the vicinity of an ordinary planet , the present problem will only be mildly nonlinear , and the convergence point will be independent of the initial point .",
    "the simplest choice , of course , is @xmath396    before entering on the problem of how many iterations must the done in practice , let us take the strict mathematical point of view that , in principle , an infinite number of iterations should be performed .",
    "the optimal estimate of the space - time metric would then be @xmath397 the least - squared method not only provides an optimal solution , it also provides a mean of estimating the uncertainties on this solution .",
    "it can be shown ( tarantola , 2005 ) that these uncertainties are those represented by the covariance operator @xmath398 crudely speaking , we started with the a priori metric @xmath31 , with uncertainties represented by the covariance operator @xmath33 , and we end up with the a posteriori metric @xmath399 , with uncertainties represented by the covariance operator @xmath400 .",
    "the practical experience we have with the quasi - newton algorithm for travel - time fitting problems suggests that the algorithm should converge to the proper solution ( with sufficient accuracy ) in a few iterations ( less than 10 ) .",
    "then , for all practical purposes , we can replace @xmath401 by @xmath402 in the two equations  [ eq : infinity-1][eq : infinity-2 ] .",
    "an important practical consideration is the following .",
    "the hessian operator ( equation  [ eq : hessian operator ] ) shall be completely characterized below , and the different covariance operators shall be directly given .",
    "but the algorithm in equations  [ eq : newton - algorithm][eq : gradient vector ] contains the inverse of these linear operators .",
    "it is a very basic result of numerical analysis ( ciarlet , 1982 ) that the numerical resolution of a linear system may be dramatically more economical than the numerical evaluation of the inverse of a linear operator .",
    "therefore , we need to rewrite the quasi - newton algorithm replacing every occurrence of the inverse of an operator by the associated resolution of a linear system .",
    "let us start by the evaluation of the gradient vector @xmath403 .",
    "expression  [ eq : gradient vector ] can be rewritten @xmath404 where @xmath405 and where the vectors @xmath406 , @xmath407 , @xmath408 @xmath409 , @xmath410 , and @xmath411 , are the respective solutions of the linear systems @xmath412 \\bfc_\\bft \\ , \\delta\\bft_k^\\ast \\ & = \\",
    "\\bft(\\bfg_k ) - \\bft_\\obs \\\\[3 pt ] \\bfc_\\bfsigma \\ , \\delta\\bfsigma_k^\\ast \\ & = \\",
    "\\bfsigma(\\bfg_k ) - \\bfsigma_\\obs \\\\[3 pt ] \\bfc_\\bfa \\ , \\delta\\bfa_k^\\ast \\ & = \\",
    "\\bfa(\\bfg_k ) - \\bfa_\\obs \\\\[3 pt ] \\bfc_\\bfpi \\ , \\delta\\bfpi_k^\\ast \\ & = \\",
    "\\bfpi(\\bfg_k ) - \\bfpi_\\obs \\\\[3 pt ] \\bfc_\\bfomega \\ , \\delta\\bfomega_k^\\ast \\ & = \\",
    "\\bfomega(\\bfg_k ) - \\bfomega_\\obs \\quad .",
    "\\\\ \\end{split } \\quad } % end boxed \\label{eq : gradient vector 3}\\ ] ]    once the gradient vector @xmath403 is evaluated , one can turn to the iterative step ( equation  [ eq : newton - algorithm ] ) .",
    "it can be written @xmath413 where @xmath414 is the solution of the linear system @xmath415 using the expression  [ eq : hessian operator ] for the operator @xmath388 we can equivalently say that @xmath414 is the solution of the linear system @xmath416 where , when introducing the vectors @xmath417 the vectors @xmath418 , @xmath419 , @xmath420 , @xmath421 , @xmath422 , and @xmath423 , are the respective solutions of the linear systems @xmath424    in equations  [ eq : gradient vector 2 ] and  [ eq : final linear system ] one needs to evaluate vectors whose generic form is @xmath425 the vector @xmath256 being known .",
    "they involve the transpose of an operator .",
    "to evaluate these vectors one must resort to the very definition of transpose operator . by definition ,",
    "the operator @xmath426 is the transpose of the linear operator @xmath427 if , and only if , for any @xmath428 and any @xmath256 , @xmath429 as the linear tangent operators are characterized ( for all the nonlinear applications appearing above ) , we know how to write the right - hand side of this equation explicitly .",
    "as the vector @xmath256 is known , the condition that the obtained expression must hold for any vector @xmath428 gives an explicit expression for @xmath430 .",
    "appendixes  [ sec : appendix einstein equation ] and  [ sec : arrival time data ] provide two examples of this kind of evaluations .",
    "assume that some _ linear model _ allows to make a _ preliminary _ prediction of the state of the system at time @xmath431 in terms of the state of the system at time @xmath432 ( we retain here the notations in grewal et al .",
    "( 2001 ) ) : @xmath433 if the uncertainties we had on @xmath434 are represented by the covariance matrix @xmath435 and if the prediction by the linear model @xmath436 has uncertainties described by the covariance matrix @xmath437 , the uncertainty we have on @xmath438 is represented by the covariance matrix @xmath439    so we have the prior value @xmath438 with uncertainties described by the prior covariance matrix @xmath440 . to pass from the preliminary estimate @xmath438 to the actual estimate @xmath441 we now use some observed data @xmath442",
    "that is assumed to be related to @xmath441 via a linear relation @xmath443 , with uncertainties described by the covariance matrix @xmath444 .",
    "the standard theory of linear least - squares then provides the posterior estimate as @xmath445 that has uncertainties represented by the posterior covariance matrix @xmath446    then , if at each time step we input @xmath436 , @xmath447 , @xmath442 , @xmath448 , and @xmath444 , equations  [ eq : kalman-1][eq : kalman-4 ] allow to have a continuous estimation of the state of the system , @xmath441 , together with an estimation of the uncertainties , @xmath449 .",
    "the reader may recognize that equations  [ eq : kalman-3][eq : kalman-4 ] are identical to the standard equations of linear least - squares theory ( see equations  3.37 and 3.38 in tarantola ( 2005 ) ) .",
    "the matrix @xmath450 that appears in the two equations  [ eq : kalman-3][eq : kalman-4 ] , is called the ` kalman gain matrix ' .",
    "_ example .",
    "_ as a simple example , consider , in non - relativistic physics , the trajectory of a mass that has been equipped with some sensors",
    ". we can choose to represent the state of the system at any time by a 9-dimensional vector @xmath362 , that contains the three values of the position , the three values of the velocity and the three values of the acceleration .",
    "assume that , as a result of the previous iteration , at some moment we have the estimation @xmath434 with uncertainties @xmath435 .",
    "equation  [ eq : kalman-1 ] may simply correspond to the use of the velocity to extrapolate the position one step in time , to use the acceleration to extrapolate the velocity , and to keep the acceleration unchanged .",
    "this perfectly characterizes the matrix @xmath436 .",
    "equation  [ eq : kalman-2 ] then is used to update the estimation of uncertainty , where we can take for @xmath447 something as simple as a zero matrix excepted for the three diagonal elements associated to the acceleration , where a small variance will take into account that our extrapolation of acceleration is uncertain .",
    "the data @xmath442 may consist in the output of some sensors , like accelerometers or data from a satellite positioning system .",
    "the relation @xmath451 would correspond to the theoretical calculation of the data @xmath442 given the state @xmath438 .",
    "this is not a linear relation , and the theory should be developed to directly account for this , but if the time steps are small enough , we can always linearize the theory , this then defining the matrix @xmath448 . denoting now by @xmath442 the actual output of the sensors , and by @xmath444 the experimental uncertainties , equation  [ eq : kalman-3 ]",
    "is used to obtain our second estimation of the state of the system , equation  [ eq : kalman-4 ] providing the associated uncertainties ."
  ],
  "abstract_text": [
    "<S> relativity is an integral part of positioning systems , and this is taken into account in today s practice by applying many ` relativistic corrections ' to computations performed using concepts borrowed from galilean physics . </S>",
    "<S> a different , fully relativistic paradigm can be developed for operating a positioning system . </S>",
    "<S> this implies some fundamental changes . </S>",
    "<S> for instance , the basic coordinates are four times ( with a symmetric meaning , not three space coordinate and one time coordinate ) and the satellites _ must _ have cross - link capabilities . </S>",
    "<S> gravitation must , of course , be taken into account , but not using the newtonian theory : the gravitation field is , and only is , the space - time metric . </S>",
    "<S> this implies that the positioning problem and the gravimetry problem can not be separated . </S>",
    "<S> an optimization theory can be developed that , because it is fully relativistic , does not contain any ` relativistic correction ' . </S>",
    "<S> we suggest that all positioning satellite systems should be operated in this way . </S>",
    "<S> the first benefit of doing so would be a clarification and a simplification of the theory . </S>",
    "<S> we also expect , at the end , that positioning systems will provide increased positioning accuracy . </S>"
  ]
}