{
  "article_text": [
    "the study of the constraint satisfaction problem ( csp ) and especially the dichotomy conjecture triggered a wave of research in universal algebra , as it turns out that the algebraic approach to the csp developed in @xcite is the most prolific one in this area .",
    "these developments have led to a number of strong results about the csp , see , e.g. , @xcite .",
    "however , successful application of the algebraic approach also requires new results about the structure of finite algebras .",
    "two ways to describe this structure have been proposed .",
    "one is based on absorption properties @xcite and has led not only to new results on the csp , but also to significant developments in universal algebra itself .    in this paper",
    "we refine and advance the alternative approach originally developed in @xcite , which is based on the local structure of finite algebras .",
    "this approach identifies subalgebras or factors of an algebra having ` good ' term operations , that is , operations of one of the three types : semilattice , majority , or affine .",
    "it then explores the graph or hypergraph formed by such subalgebras , and exploits its connectivity properties . in a nutshell",
    ", this method stems from the early study of the csp over so called conservative algebras @xcite , and has led to a much simpler proof of the dichotomy conjecture for conservative algebras @xcite and to a characterization of csps solvable by consistency algorithms @xcite . in spite of these applications",
    "the original methods suffers from a number of drawbacks that make its use difficult . in the present paper",
    "we refine many of the constructions and fix the deficiencies of the original method . as in @xcite",
    "an edge is a pair of elements @xmath0 such that there is a factor algebra of the subalgebra generated by @xmath0 that has an operation which is semilattice , majority , or affine on the blocks containing @xmath0 ; this operation determines the type of edge @xmath1 . in this paper",
    "we allow edges to have more than one type if there are several factors witnessing different types .",
    "the main difference from the previous results is the introduction of oriented _ thin _ majority and afiine edges .",
    "an edge @xmath1 is said to thin if there is a term operation that is semilattice on @xmath2 , or there is a term operation that satisfies the identities of a majority or affine term ( say , in variables @xmath3 ) on @xmath2 , but only when @xmath4 and @xmath5 .",
    "oriented thin edges allow us to prove a stronger version of the connectivity of the graph related to an algbera .",
    "this updated approach makes it possible to give a much simpler proof of the result of @xcite ( see also @xcite ) , however , this is a subject of subsequent papers .",
    "in terminology and notation we follow the standard texts on universal algebra @xcite .",
    "we also assume familiarity with the basics of the tame congruence theory @xcite .",
    "all algebras in this paper are assumed to be finite , idempotent , and omitting type .",
    "algebras will be denoted by @xmath6 , etc .",
    "the subalgebra of an algebra @xmath7 generated by a set @xmath8 is denoted @xmath9 , or if @xmath7 is clear from the context simply by @xmath10 .",
    "the set of term operations of algebra @xmath7 is denoted by @xmath11 .",
    "subalgebras of direct products are often considered as relations .",
    "an element ( a tuple ) of @xmath12 is denoted in boldface , say , @xmath13 , and its @xmath14th component is referred to as @xmath15 $ ] , that is , @xmath16\\zd\\ba[n])$ ] .",
    "the set @xmath17 will be denoted by @xmath18 $ ] . for @xmath19 $ ] ,",
    "say , @xmath20 , @xmath21 , by @xmath22 we denote the @xmath23-tuple @xmath24\\zd\\ba[i_k])$ ] , and for @xmath25 by @xmath26 we denote the set @xmath27 .",
    "if @xmath28 or @xmath29 we write @xmath30 rather than @xmath31 .",
    "the tuple @xmath22 and relation @xmath26 are called the _ projections _ of @xmath13 and @xmath32 on @xmath33 . a subalgebra ( a relation )",
    "@xmath32 of @xmath12 is said to be a _",
    "subdirect product _ of @xmath34 if @xmath35 for every @xmath36 $ ] . for a congruence @xmath37 of @xmath7 and @xmath38 , by @xmath39",
    "we denote the @xmath37-block containing @xmath40 , and by @xmath41 the factor algebra modulo @xmath37 . for @xmath42 , the congruence generated by @xmath43",
    "will be denoted by @xmath44 or just @xmath45 . by @xmath46",
    "we denote the least ( i.e.  the equality relation ) , and the greatest ( i.e.  the total relation ) congruence of @xmath7 , respectively .",
    "again , we often simplify this notation to @xmath47 .",
    "let @xmath7 be an algebra with universe @xmath48 .",
    "we introduce graph @xmath49 as follows .",
    "the vertex set is the set @xmath48 .",
    "a pair @xmath1 of vertices is a _",
    "edge _ if and only if there exists a congruence @xmath50 of @xmath51 and a term operation of @xmath7 such that either @xmath52 is an affine operation on @xmath53 , or @xmath52 is a semilattice operation on @xmath54 , or @xmath52 is a majority operation on @xmath54 .",
    "if there exists a congruence and a term operation of @xmath7 such that @xmath52 is a semilattice operation on @xmath54 then @xmath1 is said to have the _",
    "semilattice type_. an edge @xmath1 is of _ majority type _ if there are a congruence @xmath50 and @xmath55 ( a term operation of @xmath7 , respectively ) such that @xmath52 is a majority operation on @xmath54 .",
    "finally , @xmath1 has the _ affine type _ if there are a congruence @xmath50 and @xmath55 ( a term operation of @xmath7 , respectively ) such that @xmath52 is an affine operation on @xmath56 . in all cases",
    "we say that congruence @xmath50 _ witnesses _ the type of edge @xmath1 .",
    "note that , for every edge @xmath1 of @xmath49 , there is the associated pair @xmath57 from the factor structure .",
    "we will need both of these types of pairs and will sometimes call @xmath57 a _ thick _ edge ( see fig .  1 ) . the smallest congruence certifying the type of an edge @xmath1",
    "will be denoted by @xmath58 .",
    "note also that a pair @xmath1 may have more than one type witnessed by different congruences @xmath50 .",
    "sometimes we need a stricter version of type .",
    "a pair @xmath1 is _ strictly semilattice _ if it is semilattice ; @xmath1 is said to be _ strictly majority _ , if it is majority but not semilattice .",
    "finally , pair @xmath1 is said to be _ strictly affine _ if it is affine , but not semilattice or majority .",
    "[ the : connectedness ] if an idempotent algebra @xmath7 omits type , then @xmath59 is connected for every subalgebra of @xmath7 .",
    "let @xmath60 be an idempotent algebra . recall that a _ tolerance _ of @xmath7 is a binary reflexive and symmetric relation compatible with @xmath7 .",
    "the transitive closure of a tolerance is a congruence of @xmath7 . in particular ,",
    "if @xmath7 is simple then the transitive closure of every its tolerance different from the equality relation is the total relation .",
    "if a tolerance satisfies this condition then we say that it is _",
    "connected_. let @xmath61 be a tolerance .",
    "a set @xmath62 maximal with respect of inclusion and such that @xmath63 is said to be a _ class _ of @xmath61 .",
    "we will need the following simple observation .",
    "[ lem : tol - class ] every class of a tolerance of an idempotent algebra is a subalgebra .",
    "let @xmath64 be a hypergraph .",
    "a _ path _ in @xmath65 is sequence @xmath66 of hyperedges such that @xmath67 , for @xmath68 .",
    "the hypergraph @xmath65 is said to be _ connected _ if , for any @xmath69 , there is a path @xmath66 such that @xmath70 , @xmath71 .",
    "clearly , the universe of an algebra @xmath7 along with the family of all its proper subalgebras forms a hypergraph denoted by @xmath72 .",
    "lem : tol - class ] implies that , for a simple idempotent algebra @xmath7 , the hypergraph @xmath72 is connected unless @xmath7 is tolerance free . in the latter case",
    "it can be disconnected .",
    "if @xmath37 is a congruence of a finite algebra @xmath7 and @xmath32 is a compatible binary relation , then the _ @xmath37-closure _ of @xmath32 is defined to be @xmath73 .",
    "a relation equal to its @xmath37-closure is said to be _",
    "@xmath37-closed_. if @xmath74 is a prime quotient of @xmath7 , then the _ basic tolerance for _ @xmath74 ( see @xcite , chapter  5 ) is the @xmath37-closure of the relation @xmath75 is an @xmath74-trace@xmath76 if @xmath77 , and it is the @xmath37-closure of the compatible relation generated by @xmath75 is an @xmath74-trace@xmath76 if @xmath78 .",
    "the basic tolerance is the smallest @xmath37-closed tolerance @xmath61 of @xmath7 such that @xmath79 .",
    "let @xmath74 is a prime quotient of @xmath7 .",
    "@xmath74-quasi - order _ is a compatible reflexive and transitive relation @xmath32 such that @xmath80 , and the transitive closure of @xmath81 is @xmath82 .",
    "the quotient @xmath74 is said to be _",
    "orderable _ if there exists an @xmath74-quasi - order . by theorem  5.26 of @xcite",
    ", @xmath74 is orderable if and only if @xmath78 .",
    "recall that an element @xmath40 of an algebra @xmath7 is said to be _ absorbing _ if whenever @xmath83 is an @xmath84-ary term operation of @xmath7 such that @xmath85 depends on @xmath86 and @xmath87 , then @xmath88 .",
    "a congruence @xmath50 of @xmath89 is said to be _ skew _ if it is the kernel of no projection mapping of @xmath89 onto its factors . if @xmath7 is a simple idempotent algebra , then the result of @xcite states that one of the following holds : ( a ) @xmath7 is term equivalent to a module ; ( b ) @xmath7 has an absorbing element ; or ( c ) @xmath89 has no skew congruence .",
    "we also need the following easy observation .",
    "[ lem : binary - tol ] let @xmath32 be an @xmath90-ary compatible relation on @xmath7 such that , for any @xmath91 , @xmath92 .",
    "then , for any @xmath36 $ ] , the relation @xmath93 there are @xmath94 such that @xmath95 is a tolerance of @xmath7 .",
    "tolerance of the form @xmath96 will be called _ link tolerance _ , or _",
    "@xmath14th link tolerance _",
    "[ pro : simple ] let @xmath7 be a simple idempotent algebra .",
    "+ ( 1 ) if @xmath97 then @xmath72 is connected .",
    "+ ( 2 ) if @xmath98 and @xmath7 has a proper tolerance , then @xmath72 is connected . + ( 3 ) if @xmath99 then @xmath7 is term equivalent to a module .",
    "+ ( 4 ) if @xmath100 , @xmath98 and @xmath7 is tolerance free , then either @xmath0 are connected in @xmath72 , or there is a binary term operation @xmath101 or a ternary term operation @xmath102 such that @xmath101 is a semilattice operation on @xmath2 , or @xmath102 is a majority operation on @xmath2 .",
    "\\(1 ) by theorem  5.26 of @xcite , there exists @xmath103-quasi - order @xmath104 on @xmath7 , which is , clearly , just a compatible partial order",
    ". let @xmath105 be such that @xmath106 implies @xmath107 or @xmath108 .",
    "we claim that @xmath2 is a subalgebra of @xmath7 .",
    "indeed , for any term operation @xmath109 of @xmath7 and any @xmath110 , we have @xmath111 . finally , it follows from lemma  5.24(3 ) and theorem  5.26(2 ) that @xmath104 is connected .",
    "+ ( 2 ) follows straightforwardly from lemma  [ lem : tol - class ] and the fact that the transitive closure of any proper tolerance of @xmath7 is the total relation .",
    "+ ( 3 ) follows from the results of @xcite .",
    "+ ( 4 ) we consider two cases .",
    "case 1 . there is no automorphism @xmath112 of @xmath7 such that @xmath113 and @xmath114 .",
    "+ consider the relation @xmath32 generated by @xmath115 . by the assumption made",
    ", @xmath32 is not the graph of a bijective mapping . by lemma  [ lem : binary - tol ] , @xmath116 are tolerances of @xmath7 different from the equality relation .",
    "thus , they are the total relation . therefore , there is @xmath117 such that @xmath118 .",
    "if both @xmath119 are proper subalgebras of @xmath7 , then @xmath0 are connected in @xmath72 .",
    "otherwise , let , say , @xmath120 . since @xmath121 and @xmath7 is idempotent , @xmath122 for any @xmath123 .",
    "in particular , @xmath124 .",
    "this means that there is a binary term operation @xmath101 such that @xmath125 , as required .",
    "there is an automorphism @xmath112 of @xmath7 such that @xmath113 and @xmath114 .",
    "+ consider the ternary relation @xmath32 generated by @xmath126 . as in the previous case , if we show that @xmath127 , then the result follows .",
    "let also @xmath128 denotes the graph of an automorphism @xmath112 with @xmath113 and @xmath114 .",
    "+ let @xmath130 and @xmath131 .",
    "since @xmath132 , this relation is compatible . clearly , @xmath133 if and only if @xmath134 .",
    "notice that @xmath135 .",
    "since @xmath98 and @xmath7 is tolerance free , every pair @xmath136 is a trace .",
    "therefore , there is a polynomial operation @xmath137 with @xmath138 and , hence , there is a term operation @xmath139 such that @xmath140 . for this operation",
    "we have @xmath141    next we show that @xmath142 can not be the equality relation .",
    "suppose for contradiction that it is .",
    "then the relation @xmath143 there is @xmath144 such that @xmath145 is a congruence of @xmath146 .",
    "it can not be a skew congruence , hence , it is kernel of the projection of @xmath89 onto one of its factors . without loss of generality",
    "let @xmath147 .",
    "this means that , for any @xmath144 and any @xmath148 , we have @xmath149 .",
    "however , @xmath150 , a contradiction .",
    "the same argument applies when @xmath151 .",
    "thus , @xmath142 is the total relation , and there is @xmath152 such that @xmath153 which implies @xmath154 .",
    "claim 2 . for any @xmath155 , the tuple @xmath156 .",
    "+ take a term operation @xmath157 such that @xmath158 and @xmath159 .",
    "such an operation exists whenever @xmath160 , because every pair of elements of @xmath7 is a trace .",
    "then @xmath161 what is left is to show that there are @xmath162 such that @xmath163 and @xmath160 .",
    "suppose @xmath164 . if @xmath165 , the @xmath0 are connected in @xmath72",
    "let @xmath120 , and @xmath166 such that @xmath167 .",
    "since @xmath32 is symmetric with respect to any permutation of coordinates , @xmath168 . in particular , @xmath169 .",
    "then @xmath170 as @xmath164 and @xmath171 .",
    "the tuple @xmath172 is as required .",
    "thus , @xmath127 which means that there is a term operation @xmath139 such that @xmath173 . since @xmath112 is an automorphism , we also get @xmath174 , i.e.  @xmath101 is a majority operation on @xmath2 .",
    "suppose for contradiction that @xmath49 is disconnected .",
    "let @xmath175 be a minimal subalgebra of @xmath7 such that @xmath59 is disconnected .",
    "since the graph of every proper subalgebra of @xmath175 is connected , @xmath175 is 2-generated , say , @xmath176 .",
    "let @xmath50 be a maximal congruence of @xmath175 .",
    "clearly , if @xmath177 is connected then @xmath59 is connected .",
    "therefore , @xmath178 is tolerance free and of type .",
    "take @xmath179 ; let @xmath180 .",
    "if @xmath181 then @xmath162 are connected by the assumption made . otherwise @xmath182 . by proposition",
    "[ pro : simple ] , either @xmath183 are connected in @xmath184 and hence in @xmath177 , or @xmath185 is an edge in @xmath177 . in the former case @xmath162",
    "are connected because every proper subalgebra of @xmath178 gives rise to a proper subalgebra of @xmath175 . in the latter case @xmath186",
    "is an edge of @xmath59 .",
    "thus , @xmath59 is connected , a contradiction .      generally , an edge , or even a thick edge is not a subalgebra .",
    "however , we show that every idempotent algebra @xmath7 omitting type  has a reduct @xmath187 such that @xmath187 also omits type one , but every its edge of semilattice or majority type is a subalgebra of @xmath187 .",
    "moreover , some type restrictions are also observed .",
    "we say that @xmath49 is _ semilattice _",
    "( _ semilattice / majority_)-_connected _ if every two vertices in @xmath49 are connected by a path consisting of semilattice ( semilattice and strict majority ) edges . for short",
    "we will abbreviate it to s - connected and sm - connected .    [ the : adding ] let @xmath7 be an idempotent algebra omitting type , @xmath1 an edge of @xmath49 of semilattice or strict majority type , and @xmath188 the thick edge @xmath1 .",
    "let also @xmath189 denote set of term operations of @xmath7 preserving @xmath190 + ( 1 ) @xmath191 omits type .",
    "+ ( 2 ) if @xmath1 is semilattice and @xmath49 is s - connected , then @xmath192 is s - connected .",
    "+ ( 3 ) if @xmath1 is strict majority and @xmath49 is sm - connected , then @xmath192 is sm - connected .",
    "we prove theorem  [ the : adding ] by induction on the ` structure ' of the algebra .",
    "the base case of this induction is given by strictly simple algebras .",
    "recall that a simple algebra whose proper subalgebras are all 1-element is said to be _",
    "strictly simple_. we need the description of finite idempotent strictly simple algebras given in @xcite .",
    "let @xmath65 be a permutation group acting on a set @xmath48 .",
    "by @xmath193 we denote the set of operations on @xmath48 preserving each relation of the form @xmath194 where @xmath195 , and @xmath196 denotes the set of idempotent members of @xmath193 .",
    "let @xmath197 be a finite dimensional vector space over a finite field @xmath198 , @xmath199 the group of translations @xmath200 , and @xmath201 the endomorphism ring of @xmath202",
    ". then one can consider @xmath203 as a module over @xmath201 .",
    "this module is denoted by @xmath204 .",
    "finally , let @xmath205 denote the set of all operations preserving the relation @xmath206 where @xmath207 is some fixed element of @xmath48 , and let @xmath208 .",
    "[ str ] a finite strictly simple idempotent algebra @xmath7 is term equivalent to one of the following algebras :    \\(a ) @xmath209 for a permutation group @xmath65 on @xmath48 such that every nonidentity member of @xmath65 has at most one fixed point ;    \\(b ) @xmath210 for some vector space @xmath202 over a finite field @xmath198 ;    \\(c ) @xmath211 for some @xmath23 ( @xmath212 ) , some element @xmath213 and some permutation group @xmath65 acting on @xmath48 such that @xmath207 is the unique fixed point of every nonidentity member of  @xmath65 ;    \\(d ) @xmath214 where @xmath215 and @xmath216 contains a semilattice operation ;    \\(e ) a two - element algebra with an empty set of basic operations .",
    "it can be easily shown ( see e.g.  @xcite ) that in case ( c ) @xmath7 has a term _ zero - multiplication _ operation , that a binary operation @xmath166 such that @xmath217 whenever @xmath218 .",
    "let @xmath1 be an edge of semilattice type and @xmath101 is a term operation such that @xmath219 is a semilattice operation on @xmath220 .",
    "we will omit index @xmath58 everywhere it does not lead to a confusion . let @xmath221 where @xmath222 is the set of binary term operations @xmath102 of @xmath7 such that @xmath223 on @xmath224 is either a projection or equals @xmath219 .",
    "the subalgebra of @xmath7 generated by a set @xmath62 will be denoted by @xmath225 , while the subalgebra of @xmath187 generated by the same set will be denote by @xmath226 . in general , @xmath227 .",
    "_ claim 1 .",
    "_ @xmath101 can be chosen to satisfy the identity @xmath228 .",
    "+ for every @xmath229 , we consider the unary operation @xmath230 . there is a natural number @xmath231 such that @xmath232 is an idempotent transformation of @xmath48 .",
    "let @xmath90 be the least common multiple of the @xmath231 , @xmath229 and @xmath233 since @xmath234 is an idempotent for any @xmath229 , we have @xmath235 .",
    "finally , as is easily seen @xmath166 equals @xmath101 on @xmath236 .",
    "we prove that , for any @xmath237 , the graph @xmath238 is connected .",
    "moreover , if for every subalgebra @xmath175 of @xmath7 , @xmath59 is s - connected , then this holds also for every subalgebra of @xmath187 .",
    "we proceed by induction on order ideals of @xmath239 . to prove the base case for induction , suppose that for @xmath240 , the algebra @xmath241 is strictly simple . by theorem  [ str ]",
    ", we have to consider five cases .",
    "@xmath241 is a set .",
    "+ in this case , @xmath242 and @xmath243 . if @xmath244 then there exists a term operation @xmath102 of @xmath187 such that @xmath245 . as is easily seen , the operation @xmath246 equals @xmath101 on @xmath224 ; hence , it belongs to @xmath222 .",
    "however , @xmath247 , a contradiction with the assumption made .",
    "thus , @xmath248 .",
    "then there is a term operation @xmath102 of @xmath7 which is either an affine or majority or semilattice operation on @xmath249 .",
    "the operation @xmath250 in the first two cases or @xmath251 in the latter case belong to @xmath222 and is an affine or majority or semilattice operation on @xmath249 respectively .",
    "@xmath252 is a 2-element semilattice .",
    "+ there is nothing to prove in this case .",
    "@xmath241 is a module . +",
    "the operation @xmath101 on @xmath241 has the form @xmath253 and either @xmath254 or @xmath255 is invertible .",
    "suppose that @xmath254 is invertible and @xmath256 for a certain @xmath90 . then set @xmath257 since @xmath101 and @xmath258 are idempotent , @xmath259 on @xmath241 and @xmath260 on @xmath224 .",
    "then , as in case  1.a we show that @xmath261 . therefore , @xmath262 is a strictly simple algebra .",
    "if @xmath175 is 2-element then we get one of the previous cases .",
    "otherwise , @xmath175 either has a zero - multiplication operation @xmath166 or it is of the form @xmath263 for a certain permutation group @xmath264 . in the former case , @xmath265 belongs to @xmath222 and is a zero - multiplication operation on @xmath175 . in the latter case",
    ", @xmath175 has an operation which is either a semilattice or majority operation on @xmath249 . arguing as above we get an operation of @xmath187 which is semilattice or majority on @xmath249 respectively .",
    "@xmath241 has a zero - multiplication operation @xmath166 .",
    "+ let @xmath207 be the zero - element",
    ". then @xmath162 are connected by edges @xmath266 and @xmath267 .",
    "@xmath241 is of the form @xmath263 for a certain permutation group @xmath264 .",
    "( note that this algebra has the boolean type . )",
    "+ if there is no automorphism @xmath112 in @xmath264 such that @xmath268 and @xmath269 , then , by proposition  [ pro : simple ] , @xmath187 has a term operation @xmath102 which is a semilattice operation on @xmath249 .",
    "so , let us suppose that there is an automorphism swapping @xmath270 and @xmath271 .",
    "if @xmath272 has no operation which is semilattice on @xmath249 then we are done .",
    "otherwise , let @xmath102 be a term operation of @xmath7 semilattice on @xmath249 and @xmath166 a term operation of @xmath187 majority on @xmath249 .",
    "if one of @xmath273 is a semilattice operation on @xmath224 then we proceed as before .",
    "otherwise , @xmath166 is a projection on @xmath224 ; without loss of generality let it be the first projection .",
    "then @xmath274 equals @xmath101 on @xmath224 and is a projection on @xmath249 .",
    "we complete the proof as before .    now",
    ", suppose that the claim proved for all proper subalgebras of @xmath275 .",
    "we consider two cases .",
    "there is a maximal congruence @xmath50 of @xmath276 such that @xmath52 is commutative on @xmath277 .",
    "+ by claim 1 , @xmath101 is a semilattice operation on @xmath278 and @xmath279 .",
    "the set @xmath280 generates the total congruence of @xmath276 .",
    "+ if , for every pair @xmath281 , where @xmath282 , and @xmath102 is a term operation of @xmath276 , the subalgebra @xmath283 of @xmath187 is a proper subalgebra of @xmath272 , then @xmath284 is connected and , therefore @xmath162 are connected by induction hypothesis . indeed , if @xmath285 , then @xmath286",
    "therefore , @xmath287 .",
    "suppose that , for a certain @xmath288 and a ternary term operation @xmath102 of @xmath276 , we have @xmath289 .",
    "then , for any @xmath290 , there is a term operation @xmath166 of @xmath7 such that @xmath291 .",
    "consider @xmath292 .",
    "we have @xmath293 , hence , @xmath294 . on the other hand , @xmath295 , where @xmath296 , @xmath297 .",
    "thus , @xmath261 .",
    "the elements @xmath270 and @xmath271 are connected by a path @xmath298 in @xmath65 .",
    "thus , it is enough to show that if @xmath272 is connected by edges of semilattice , majority or affine type in @xmath65 , then so is @xmath241 .",
    "we may assume @xmath186 is an edge .",
    "let @xmath50 be a maximal congruence of @xmath272 witnessing that it is an edge and @xmath299 a maximal congruence of @xmath241 containing @xmath50 .    if @xmath300 is affine or 2-element we proceed in the same way as in the base case of induction .",
    "if @xmath301 then @xmath302 are connected by a chain of 2-element subalgebras , and the result follows from induction hypothesis .",
    "so , suppose that @xmath303 .",
    "if @xmath304 is connected then we are done by induction hypothesis .",
    "otherwise we use proposition  [ pro : simple ] .",
    "if there is no automorphism @xmath112 of @xmath175 such that @xmath305 and @xmath306 , then , by proposition  [ pro : simple ] , @xmath187 has a term operation @xmath102 which is a semilattice operation on @xmath307 .",
    "so , let us suppose that there is an automorphism swapping @xmath308 and @xmath309 .",
    "if @xmath272 has no operation which is semilattice on @xmath307 then we are done .",
    "otherwise , let @xmath102 be a term operation of @xmath7 semilattice on @xmath307 and @xmath166 a term operation of @xmath187 majority on @xmath307 .",
    "if one of @xmath273 is a semilattice operation on @xmath224 then we proceed as before .",
    "otherwise , @xmath166 is a projection on @xmath224 ; without loss of generality let it be the first projection .",
    "then @xmath274 equals @xmath101 on @xmath224 and is a projection on @xmath307 .",
    "we complete the proof as before .",
    "now let @xmath1 be of majority type and @xmath310 a term operation such that @xmath311 is a majority operation on @xmath220 .",
    "let @xmath221 where @xmath222 is the set of binary and ternary term operations @xmath102 of @xmath7 such that @xmath223 on @xmath224 is either a projection or equals @xmath311 .",
    "as before , the subalgebra of @xmath7 generated by a set @xmath62 will be denoted by @xmath225 , while the subalgebra of @xmath187 generated by the same set will be denote by @xmath226 . in general , @xmath227 .",
    "_ claim 2 .",
    "_ @xmath310 can be chosen to satisfy the identity @xmath312 .",
    "+ for every @xmath229 , we consider the unary operation @xmath313 .",
    "there is a natural number @xmath231 such that @xmath232 is an idempotent transformation of @xmath48 .",
    "let @xmath90 be the least common multiple of the @xmath231 , @xmath229 , and @xmath314 since @xmath234 is idempotent for any @xmath229 , we have @xmath315 . finally , as is easily seen @xmath166 is a majority operation on @xmath224 .",
    "we proceed by induction on order ideals of @xmath239 . to prove the base case for induction ,",
    "suppose that for @xmath240 , the algebra @xmath241 is strictly simple . by theorem  [ str ] , we have to consider five cases .",
    "@xmath241 is a set .",
    "+ in this case , @xmath252 and @xmath316 . if @xmath244 then there exists a term operation @xmath102 of @xmath7 such that @xmath245 .",
    "as is easily seen , the operation @xmath317 equals @xmath310 on @xmath224 ; hence , it belongs to @xmath222 .",
    "however , @xmath318 , a contradiction with the assumption made .",
    "thus , @xmath248 .",
    "then there is a term operation @xmath102 of @xmath7 which is either an affine or majority or semilattice operation on @xmath249 .",
    "the operation @xmath319 in the first two cases or @xmath320 in the latter case belong to @xmath222 and is an affine or majority or semilattice operation on @xmath249 respectively .",
    "@xmath252 is a 2-element semilattice .",
    "+ there is nothing to prove in this case .",
    "@xmath241 is a module over a ring @xmath198 .",
    "+ the operation @xmath310 on @xmath241 has the form @xmath321 and either @xmath254 or @xmath322 or @xmath323 is invertible .",
    "suppose that @xmath254 is invertible and @xmath256 for a certain @xmath90 .",
    "then set @xmath324 we have , @xmath325 on @xmath241 and @xmath326 on @xmath224 .",
    "let @xmath23 be the characteristics of the ring @xmath198 .",
    "we set @xmath327 for the operation @xmath328 we have @xmath329 on @xmath241 and @xmath330 on @xmath224 .",
    "then , as in case  2.a we show that @xmath261 ( by substituting @xmath331 ) .",
    "therefore , @xmath262 is a strictly simple algebra .",
    "if @xmath175 is 2-element then we get one of the previous cases .",
    "otherwise , @xmath175 either has a zero - multiplication operation @xmath166 or it is of the form @xmath332 for a certain permutation group @xmath264 . in the former case , @xmath333 belongs to @xmath222 and is a zero - multiplication operation on @xmath175 . in the latter case",
    ", @xmath175 has an operation which is either a semilattice or majority operation on @xmath249 . arguing as above we get an operation of @xmath187 which is semilattice or majority on @xmath249 respectively .",
    "@xmath241 has a zero - multiplication operation @xmath166 .",
    "+ let @xmath207 be the zero - element .",
    "then @xmath162 are connected by edges @xmath266 and @xmath267 .",
    "@xmath241 is of the form @xmath332 for a certain permutation group  @xmath264 .",
    "+ if there is no automorphism @xmath112 in @xmath264 such that @xmath268 and @xmath269 , then , by proposition  [ pro : simple ] , @xmath187 has a term operation @xmath102 which is a semilattice operation on @xmath249 .",
    "so , let us suppose that there is an automorphism swapping @xmath270 and @xmath271 .",
    "if @xmath272 has no operation which is semilattice on @xmath249 then we are done . otherwise , let @xmath102 be a term operation of @xmath7 semilattice on @xmath249 and @xmath166 a term operation of @xmath187 majority on @xmath249 .",
    "if @xmath166 can be chosen such that it is a majority operation on @xmath224 then we proceed as before . otherwise , @xmath166 is either a projection or minority or 2/3-minority operation on @xmath224 . in the two latter case one of @xmath334",
    "is the first projection on @xmath224 and the second projection on @xmath249 ; let it be @xmath335",
    ". then @xmath336 equals @xmath310 on @xmath224 and is a projection on @xmath249 .",
    "we complete the proof as before .    now",
    ", suppose that the claim proved for all proper subalgebras of @xmath275 .",
    "we consider two cases .",
    "there is a maximal congruence @xmath50 of @xmath276 such that @xmath337 in @xmath277 .",
    "+ we consider the algebra @xmath338 . by the results of @xcite , @xmath175 is either a set or term equivalent to a module or has an absorbing element or @xmath339 has no skew congruence .",
    "the algebra @xmath175 can not be a set , because @xmath310 is not a projection on @xmath175 .",
    "if it has an absorbing element , @xmath304 is connected via the absorbing element . in the last case ,",
    "if @xmath304 is connected then the result follows from induction hypothesis .",
    "if @xmath304 is disconnected then , by proposition  [ pro : simple ] , there is a term operation @xmath101 of @xmath175 which is either semilattice or majority on @xmath340 .",
    "finally , suppose that @xmath175 is term equivalent to module .",
    "then @xmath310 on @xmath175 is of the form @xmath341 . since @xmath337",
    ", we have @xmath342 hence , @xmath343 therefore , @xmath344 , @xmath345 , @xmath346 and thus @xmath254 is invertible .",
    "since @xmath310 satisfies the identity @xmath347 , we have @xmath348 this implies @xmath349 and hence @xmath350 . comparing this with the equality @xmath346",
    "we conclude that the abelian group of @xmath175 has period 2 , and @xmath351 is the minority operation @xmath352 .",
    "as is easily seen , @xmath353 is the second projection on @xmath224 and the first projection on @xmath175 .",
    "moreover , @xmath166 can be chosen such that @xmath354 . by the induction hypothesis , @xmath270 and @xmath355",
    "are connected by edges ( and these edges are of the semilattice and majority types if they are such in @xmath7 ) .",
    "let us suppose first that @xmath356 .",
    "then there is a term operation @xmath357 of @xmath7 such that @xmath358 . the operation @xmath359 on @xmath224 and @xmath360 a contradiction .",
    "since @xmath361 is a maximal congruence of @xmath241 , we may assume that @xmath261 .",
    "the proof in this case can be completed in the same way as in case  2.2 .",
    "the set @xmath362 generates the total congruence of @xmath276 .",
    "+ if , for every pair @xmath281 , where @xmath282 and @xmath102 is a term operation of @xmath187 , the subalgebra @xmath283 of @xmath187 is a proper subalgebra of @xmath272 , then @xmath284 is connected and , therefore @xmath162 are connected by induction hypothesis . indeed , if @xmath285 , then @xmath286",
    "therefore , @xmath287 .",
    "suppose that , for a certain @xmath288 and a ternary term operation @xmath102 of @xmath276 , we have @xmath289 .",
    "then , for any @xmath290 , there is a term operation of @xmath7 such that @xmath291 . without loss of generality",
    "we may assume that @xmath363 for certain @xmath364 .",
    "consider @xmath365 .",
    "we have @xmath366 , hence , @xmath294 . on the other hand , @xmath295 .",
    "thus , @xmath261 .",
    "the elements @xmath270 and @xmath271 are connected by a path @xmath298 in @xmath367 .",
    "thus , it is enough to show that if @xmath272 is connected by edges of semilattice , majority or affine type in @xmath65 , then so is @xmath241 .",
    "assume @xmath186 is an edge .",
    "let @xmath50 be a maximal congruence of @xmath272 witnessing that it is an edge and @xmath299 a maximal congruence of @xmath241 containing @xmath50 .    if @xmath300 is affine or 2-element we proceed in the same way as in the base case of induction .",
    "if @xmath301 then @xmath302 are connected by a chain of 2-element subalgebras , and the result follows from induction hypothesis .",
    "so , suppose that @xmath303 .",
    "if @xmath304 is connected then we are done by induction hypothesis .",
    "otherwise we use proposition  [ pro : simple ] .      to conclude this section we prove that the polymorphisms ( or term operations ) certifying the strict type of edges can be significantly unifying ( cf",
    ".  proposition  2 from @xcite ) .",
    "[ the : uniform ] let @xmath7 be an idempotent algebra .",
    "there are term operations @xmath368 of @xmath7 such that    @xmath369 is a semilattice operation if @xmath1 is a strict semilattice edge , it is the first projection if @xmath1 is a strict majority or affine edge ;    @xmath370 is a majority operation if @xmath1 is a strict majority edge , it is the first projection if @xmath1 is a strict affine edge , and @xmath371 if @xmath1 is strict semilattice ;    @xmath372 is an affine operation operation if @xmath1 is a strict affine edge , it is the first projection if @xmath1 is a strict majority edge , and @xmath373 if @xmath1 is strict semilattice .",
    "show first that there is an operation @xmath101 that is semilattice on each semilattice edge .",
    "let @xmath374 be the list of all semilattice edges in the graph @xmath49 . to avoid clumsy notation",
    "we shall denote the operation @xmath375 , @xmath376 simply by @xmath377 .",
    "let also @xmath378 be the list of term operations of the algebra such that @xmath379 is a semilattice operation .",
    "notice that every binary idempotent operation on a 2-element set is either a projection or a semilattice operation , and every binary operation of a module can be represented in the form @xmath380 .",
    "since each @xmath101 is idempotent , for any @xmath381 , @xmath382 is either a projection , or a semilattice operation .",
    "we prove by induction , that the operation @xmath383 constructed via the following rules is a semilattice operation on @xmath384 :    * @xmath385 ; * @xmath386 .    the base case of induction , @xmath387 holds by the choice of @xmath388 .",
    "suppose that @xmath389 satisfies the required conditions .",
    "if @xmath390 is a projection , say , @xmath391 , then @xmath392 that is a semilattice operation on @xmath393 .",
    "let @xmath394 , and @xmath389 a semilattice operation such that @xmath395 .",
    "then @xmath396 hence , @xmath383 is again a semilattice operation .",
    "thus , for each edge @xmath43 , @xmath397 is a semilattice operation if @xmath43 is red and either a semilattice operation or a projection or @xmath380 otherwise .",
    "however , if @xmath43 is not red , then the subalgebra with the universe @xmath43 has no semilattice operation , therefore , @xmath397 is a projection or @xmath380 whenever @xmath43 is yellow or blue . arguing as in the previous section",
    ", one can transform @xmath398 such that it become a projection on blue edges .",
    "finally , it is easy to check that @xmath399 satisfies the conditions of the proposition .",
    "now let @xmath400 , @xmath401 be the lists of all yellow and all blue edges respectively , and @xmath402 , @xmath403 the lists of term operations of the algebra such that @xmath404 is an affine operation , and @xmath405 is the minority operation .",
    "notice first , that since neither @xmath406 nor @xmath407 has a term semilattice operation , every their binary term operation is either a projection or , for blue edges an operation of the form @xmath380 .",
    "therefore , for any @xmath381 , @xmath408 , @xmath409 , and @xmath410 , @xmath411 , @xmath412 .",
    "this means that the operations @xmath413 are of one of the following types : a projection , the minority operation , the majority operation , a 2/3-_minority operation _ , that is an operation satisfying the equalities @xmath414 , @xmath415 or similar .",
    "first we prove by induction that for every @xmath416 there is an operation @xmath417 which is majority on @xmath393 for @xmath418 .",
    "the operation @xmath419 gives the base case of induction .",
    "let us assume that @xmath420 is already found . if @xmath421 is the majority operation , set @xmath422 . otherwise , it is either a projection , or a 2/3-minority operation , or the minority operation . in all these case",
    "its variables can be permuted such that @xmath423 .",
    "then the operation @xmath424 satisfies the conditions @xmath425 , and @xmath426 for all @xmath427 .",
    "it is not hard to see that the operation @xmath428 satisfies the required conditions .",
    "further , consider the operation @xmath429 .",
    "its restriction @xmath430 , @xmath431 , is either a projection , or the minority operation .",
    "if @xmath430 is an operation @xmath432 , then using the methods of the previous section we can derive an operation @xmath433 such that @xmath426 for all @xmath434 , and @xmath435 .",
    "the operation @xmath436 is majority on @xmath393 , @xmath437 , a projection on @xmath438 .",
    "therefore , @xmath439 can be assumed to be a projection for all @xmath440 .",
    "then for the operation @xmath441 we have @xmath442 finally , to make @xmath443 acting correctly on red edges we set @xmath444 the operation @xmath102 is as required .",
    "next we show that for any @xmath431 there is @xmath445 such that @xmath446 is an affine operation for @xmath418 . as usual",
    ", @xmath447 gives the base case of induction .",
    "if @xmath448 is obtained , then if @xmath449 is an affine operation then set @xmath450 .",
    "otherwise , @xmath451 .",
    "one of the coefficients is invertible , let @xmath254 is invertible and @xmath256",
    ". then set @xmath452 we have @xmath453 and @xmath454 for @xmath427 .",
    "furthermore , @xmath455 : @xmath456 , @xmath454 for @xmath427 .",
    "if @xmath322 is invertible then repeating the procedure above we get @xmath457 which an affine operation on all the @xmath458 , @xmath418",
    ". otherwise , @xmath459 is invertible , therefore , applying the same procedure to @xmath460 we get an operation @xmath461 such that @xmath462 and @xmath463 for @xmath427 . then to obtain the required operation we set @xmath464 .    finally , set @xmath465 , @xmath466 and @xmath467 as is easily seen @xmath166 satisfies the conditions required .",
    "we start with an observation that operations @xmath368 identified in theorem  [ the : uniform ] can be assumed to satisfy certain identities .",
    "[ lem : fgh - identities ] operations @xmath368 found in theorem  [ the : uniform ] can be chosen such that    * @xmath228 for all @xmath468 ; * @xmath469 for all @xmath468 ; * @xmath470 for all @xmath468 .",
    "let @xmath471 for @xmath472 .",
    "we need to show that @xmath101 can be chosen such that @xmath473 .",
    "clearly , this can be done by substituting @xmath474 @xmath475 times .",
    "it remains to show that every function @xmath476 obtained inductively from @xmath477 and @xmath478 is a replacement for @xmath101 .",
    "that is , for any semilattice edge @xmath1 , where @xmath479 witnesses that @xmath1 is a semilattice edge , @xmath480 by induction we have @xmath481    \\2 .",
    "let @xmath102 be the operation that is majority on all strict majority edges , and @xmath482 .",
    "we need to show that @xmath102 can be chosen such that @xmath483 .",
    "clearly , this can be done by substituting @xmath484 @xmath475 times .",
    "it remains to show that every function @xmath485 obtained inductively from @xmath486 and @xmath487 is a replacement for @xmath102 .",
    "that is , for any strict majority edge @xmath1 , where @xmath479 witnesses that @xmath1 is a majority edge , @xmath488 by induction we have @xmath489    \\3 .",
    "let @xmath490 for @xmath491 .",
    "the goal is to find @xmath310 such that @xmath492 for all @xmath493 and all @xmath86 .",
    "clearly , this can be done by substituting @xmath494 @xmath475 times .",
    "it remains to show that every function @xmath495 obtained inductively from @xmath496 and @xmath497 is a replacement for @xmath166 .",
    "that is , for any affine edge @xmath1 , where @xmath479 witnesses that @xmath1 is an affine edge , @xmath498 by induction we have @xmath499      in this section we focus on ( strict ) semilattice edges of the graph @xmath49 .",
    "note first that if one fix a term operation @xmath101 such that @xmath101 is a semilattice operation on every thick semilattice edge of @xmath49 , then one can define an orientation of every semilattice edge .",
    "a semilattice edge @xmath1 is oriented from @xmath40 to @xmath493 if @xmath500 . clearly , the orientation strongly depends on the choice of the term operation @xmath101 .",
    "the graph @xmath49 oriented according to a term operation @xmath101 will be denoted by @xmath501 .",
    "we then can define _ semilattice - connected _ and _ strongly semilattice - connected _ components of @xmath501 .",
    "we will also use the natural order on the set of strongly semilattice - connected components of @xmath501 : for components @xmath502 , @xmath503 if there is a directed path in @xmath501 consisting of semilattice edges and connecting a vertex from @xmath48 with a vertex from @xmath43 .",
    "we shall now improve the choice of operation @xmath101 and restrict the kind of semilattice edges we will use later .",
    "first we show that those semilattice edges @xmath1 for which @xmath58 is not the equality relation can be thrown out of the graph @xmath49 such that the graph remains connected .",
    "therefore , we can assume that every semilattice edge @xmath1 is such that @xmath101 is a semilattice operation on @xmath2 .",
    "[ pro : thin - thick ] let @xmath7 be a finite algebra omitting type , @xmath101 a binary term operation semilattice on every ( thick ) semilattice edge and such that @xmath228 , and @xmath504 the subgraph of @xmath49 obtained by omitting semilattice edges @xmath1 such that @xmath58 is not the equality relation",
    ". then @xmath504 is connected . moreover , if @xmath49 is s - connected then @xmath504 is semilattice - connected . if @xmath49 is sm - connected then @xmath504 is sm - connected .",
    "firstly , by theorem  [ the : adding ] we may assume that every thick semilattice edge of @xmath7 is a subalgebra .",
    "it suffices to show that for any semilattice edge @xmath1 ( in @xmath501 ) , the veritces @xmath0 are connected ( s - connected or sm - connected ) in @xmath504 .",
    "so , assume @xmath100 and @xmath1 is a semilattice edge in @xmath501 .",
    "we proceed by induction on order ideals of the lattice @xmath505 of subalgebras of @xmath7 .",
    "the base case of induction , when @xmath51 is strictly simple is obvious , because @xmath506 and there is a semilattice operation on this algebra .",
    "let @xmath50 be the maximal congruence of @xmath51 witnessing that @xmath1 is an edge .",
    "let @xmath507 , then @xmath508 .",
    "by the induction hypothesis @xmath509 is connected ( s - connected , sm - connected ) with @xmath493 in @xmath510 .",
    "therefore , we may assume @xmath511 .",
    "if @xmath512 then we are done , because @xmath493 and @xmath513 are connected inside @xmath514 and @xmath40 and @xmath513 are connected inside @xmath515 .",
    "otherwise there is a term operation @xmath85 such that @xmath516 .",
    "then , for the operation @xmath517 , we have @xmath518 thus , there is a semilattice operation on @xmath2 , hence @xmath519 .",
    "the graph @xmath504 oriented according to a binary term operation @xmath101 will be denoted by @xmath520 .",
    "semilattice edges @xmath1 such that @xmath58 is the equality relation will be called _ thin semilattice edges_.    using proposition  [ pro : thin - thick ] we are able to impose more restrictions on the term operation @xmath101 .",
    "[ pro : good - operation ] let @xmath7 be a finite algebra omitting type .",
    "there is a binary term operation @xmath101 of @xmath7 such that @xmath101 is a semilattice operation on every thick semilattice edge of @xmath49 and , for any @xmath521 , either @xmath522 or the pair @xmath523 is a semilattice edge of @xmath520 .",
    "let @xmath101 be a binary term operation such that @xmath101 is semilattice on every semilattice edge and @xmath524 .",
    "let @xmath525 be such that @xmath526 , and set @xmath527 and @xmath528 for @xmath529 .",
    "claim 1 . for any @xmath14 , @xmath530 .",
    "indeed , @xmath531 , and for any @xmath529 @xmath532    let @xmath533",
    ". then @xmath534 , and there is @xmath23 with @xmath535 .",
    "@xmath536 .",
    "since @xmath537 , there is a term operation @xmath85 such that @xmath538 .",
    "let @xmath539 .",
    "for this operation we have @xmath540    this means that @xmath1 is a semilattice edge , and the congruence witnessing it is the equality relation . by the choice of @xmath101 , it is a semilattice operation on any such pair .",
    "let @xmath23 be the maximal among the numbers chosen as before in claim 2 for all pairs @xmath541 with @xmath526 .",
    "let @xmath542 , and @xmath543 for @xmath544 .",
    "let also @xmath545 .",
    "claim 3 . for any @xmath546 , either @xmath547 , or the pair @xmath548 , where @xmath549 is a semilattice edge witnessed by the equality relation .",
    "if @xmath550 then it is straightforward that @xmath547 .",
    "suppose @xmath526 .",
    "we proceed by induction . since @xmath551 , where the @xmath552 are constructed as before , by claim 2 @xmath553 .",
    "this gives the base case of induction .",
    "suppose @xmath554 .",
    "then @xmath555 claim 3 is proved .    to complete the proof it suffices to check that @xmath258 is a semilattice operation on every ( thick ) semilattice edge of @xmath49 . however",
    ", this is straightforward from the construction of @xmath258",
    ".    it will be convenient for us to denote binary operation @xmath101 that satisfies the conditions of theorem  [ the : uniform ] , lemma  [ lem : fgh - identities](1 ) , and proposition  [ pro : good - operation ] by @xmath556 , that is , to write @xmath557 or just @xmath558 for @xmath559 .",
    "the fact that @xmath1 is a thin semilattice edge we will also denote by @xmath560 . in other words , @xmath560 if and only if @xmath561 .",
    "[ lem : sl - thick - thin ] let @xmath1 be a thick semilattice edge , @xmath50 the congruence of @xmath51 that witnesses this , and @xmath562 .",
    "then there is @xmath563 such that @xmath186 is a thin semilattice edge .    by proposition  [ pro : good - operation ]",
    "@xmath564 or @xmath565 .",
    "since @xmath566 the former option is impossible . therefore @xmath186 is a thin semilattice edge .",
    "here we introduce thin majority edges in a way similar to thin semilattice edges , although in a weaker sense .",
    "[ lem : thin - majority ] let @xmath7 be an algebra , @xmath1 a majority edge in it , and @xmath50 the congruence of @xmath51 witnessing that .",
    "then there is @xmath567 and a ternary term operation @xmath568 of @xmath7 such that @xmath569 .",
    "suppose that @xmath493 is such that @xmath51 is minimal among all subalgebras @xmath570 for @xmath567 , and such that @xmath571 .",
    "such an element exists by lemma  [ lem : fgh - identities ] .",
    "consider the ternary relation @xmath32 generated by @xmath572 .",
    "applying @xmath102 to these tuples we get @xmath573 for some @xmath574 .",
    "since @xmath575 , say , @xmath576 , @xmath577 again , as @xmath578 , using @xmath579 we get @xmath580 .    a majority edge satisying the conditions of lemma  [ lem : thin - majority ]",
    "will be called a _ thin majority edge_. more precisely , a pair @xmath1 is called a thin majority edge if ( a ) it is a majority edge , ( b ) for any @xmath581 , @xmath582 , ( c ) @xmath571 , and ( d ) there exists a ternary term operation @xmath568 such that @xmath583 .",
    "the operation @xmath102 from theorem  [ the : uniform ] does not have to satisfy any specific conditions on the set @xmath2 , except what follows from its definition .",
    "also , thin majority edges are directed , since @xmath0 in lemma  [ lem : thin - majority ] occur asymmetrically .",
    "[ cor : thin - majority ] for any strict majority edge @xmath1 , where @xmath50 is a witnessing congruence , there is @xmath567 such that @xmath584 is a thin majority edge .",
    "we now consider the interaction of term operations on thin edges in different similar algebras .",
    "[ lem : thin - majority - triple ] let @xmath585 be similar idempotent algebras all omitting type .",
    "let @xmath586 , @xmath587 , and @xmath588 be thin majority edges in @xmath585 , witnessed by congruences @xmath589 , respectively .",
    "then there is an operation @xmath568 such that @xmath590 , @xmath591 , @xmath592 .",
    "let @xmath32 be the subalgebra of @xmath593 generated by @xmath594 . since @xmath586 satisfies condition ( c ) of the definition of thin majority edges , @xmath595 and @xmath596 .",
    "by condition ( b ) @xmath597 , in particular , there is a term operation @xmath85 such that @xmath598",
    ". then @xmath599 and @xmath600 .",
    "again by condition ( b ) @xmath601 , in particular , there is a term operation @xmath602 such that @xmath603",
    ". then @xmath604 the result follows .",
    "[ lem : majority - sl ] let @xmath605 be similar idempotent algebras all omitting type .",
    "let @xmath1 be a thin majority edge in @xmath606 , witnessed by congruences @xmath50 , and @xmath607 in @xmath608 . then there is an binary operation @xmath85 such that @xmath609 and @xmath610 .",
    "let @xmath32 be the subalgebra of @xmath611 generated by @xmath612 . since @xmath1 satisfies condition ( c ) of the definition of thin majority edges , @xmath613 as @xmath102 is the first projection on semilattice edges .",
    "therefore @xmath614 satisfies the conditions .",
    "[ lem : thin - affine ] let @xmath7 be an algebra , @xmath1 an affine edge in it , and @xmath50 the congruence of @xmath51 witnessing that . then there is @xmath567 and a ternary term operation @xmath615 of @xmath7 such that @xmath616 .",
    "suppose @xmath0 satisfy the conditions of the lemma .",
    "let @xmath617 , by lemma  [ lem : fgh - identities](3 ) @xmath618 . as is easily seen",
    ", there is @xmath509 that satisfies this condition and such that for any @xmath619 where @xmath299 is the restriction of @xmath50 on @xmath570 , it holds @xmath620 .    consider relation @xmath32 generated by pairs @xmath621 . since @xmath618 , @xmath622 and @xmath623 . by the assumption @xmath624 , in particular , @xmath625 .",
    "the result follows .",
    "similar to the majority case , an affine edge satisying the conditions of lemma  [ lem : thin - affine ] will be called a _ thin affine edge_. more precisely , a pair @xmath1 is called a thin majority edge if ( a ) it is an affine edge , ( b ) for any @xmath581 , @xmath582 , ( c ) @xmath626 , and ( d ) there exists a ternary term operation @xmath615 such that @xmath627 .",
    "the operation @xmath166 from theorem  [ the : uniform ] does not have to satisfy any specific conditions on the set @xmath2 , except what follows from its definition .",
    "also , thin affine edges are directed , since @xmath0 in lemma  [ lem : thin - affine ] occur asymmetrically .",
    "[ cor : thin - affine ] for any affine edge @xmath1 , where @xmath50 is a witnessing congruence , there is @xmath567 such that @xmath584 is a thin affine edge .",
    "[ lem : thin - affine - pair ] let @xmath605 be similar idempotent algebras all omitting type .",
    "let @xmath1 and @xmath186 be thin affine edges in @xmath605 , witnessed by congruences @xmath628 , respectively .",
    "then there is an operation @xmath615 such that @xmath629 and @xmath630 .",
    "let @xmath32 be the subalgebra of @xmath611 generated by @xmath631 . by condition ( c ) of the definition of thin affine edges , @xmath632 and @xmath633 . by condition ( b ) @xmath634 , in particular , @xmath122",
    "the result follows .",
    "[ lem : affine - sl ] let @xmath605 be similar idempotent algebras all omitting type .",
    "let @xmath1 be a thin affine edge in @xmath606 , witnessed by congruences @xmath50 , and @xmath607 in @xmath635 .",
    "then there is an operation @xmath636 such that @xmath637 and @xmath638 .",
    "let @xmath32 be the subalgebra of @xmath611 generated by @xmath612 . by condition ( c ) of the definition of thin affine edges , @xmath639 as @xmath640 on semilattice edges .",
    "the result follows .",
    "[ lem : affine - maj ] let @xmath1 be a thin affine edge in @xmath606 , witnessed by congruences @xmath50 , and @xmath186 is a thin majority edge in @xmath608 . then there is a binary operation @xmath85 such that @xmath641 and @xmath642 .",
    "let @xmath605 be similar idempotent algebras all omitting type .",
    "let @xmath32 be the subalgebra of @xmath611 generated by @xmath612 . by condition ( c ) of the definition of thin majority edges , @xmath643 where @xmath644 , as @xmath102 is the first projection on @xmath645 .",
    "then as @xmath575 , we get @xmath122 .",
    "the result follows .",
    "let @xmath7 be an algebra omitting type .",
    "a _ path _ in @xmath7 is a sequence @xmath646 such that @xmath647 is a thin edge for all @xmath648 $ ] ( note that thin edges are always assumed to be directed ) .",
    "we will distinguish paths of several types depending on what types of edges are allowed .",
    "if @xmath649 for @xmath648 $ ] then the path is called a _ semilattice _ or _",
    "s - path_. if for every @xmath648 $ ] either @xmath649 or @xmath647 is a thin affine edge then the path is called _ affine - semilattice _ or _ as - path_. similarly , if only semilattice and thin majority edges are allowed we have a _ semilattice - majority _ or _ sm - path_. we say that @xmath40 is _ connected _ to @xmath493 , @xmath521 , if there is a path @xmath650 . if this path is semilattice ( aftine - semilattice , semilattice - majority ) then @xmath40 is said to be _ s - connected _ ( or _ as - connected _ , or _",
    "sm - connected _ ) to @xmath493 .",
    "we denote this by @xmath651 ( for s - connectivity ) , @xmath652 and @xmath653 for as- and sm - connectivity , respectively .",
    "let @xmath654 denote the digraph whose nodes are the elements of @xmath7 , and the arcs are the thin semilattice edges .",
    "the strongly connected component of @xmath655 containing @xmath38 will be denoted by @xmath656 .",
    "the set of strongly connected components of @xmath655 are ordered in the natural way ( if @xmath560 then @xmath657 ) , the elements belonging to maximal ones will be called _",
    "maximal _ , and the set of all maximal elements from @xmath7 by @xmath658 . in a similar way we construct the graph @xmath659 by including all the thin semilattice and affine edges",
    "the strongly connected component of @xmath659 containing @xmath38 will be denoted by @xmath660 .",
    "a maximal strongly connected component of this graph is called an _ as - component _ , an element from an as - component is called _ as - maximal _ , and the set of all as - maximal elements is denoted by @xmath661 .    in this section",
    "we show that all maximal elements are connected to each other .",
    "the undirected connectivity easily follows from the definitions , so the challenge is to prove directed connectivity , as defined above .",
    "we start with an auxiliary lemma .",
    "[ lem : going - maximal ] let @xmath100 be simple , @xmath664 , and @xmath32 a subdirect square of @xmath7 .",
    "let also @xmath665 be the tolerance defined by @xmath666 .",
    "if @xmath667 is a connected tolerance then there is a sequence @xmath668 such that @xmath669 , @xmath670 is maximal , @xmath671 , and if @xmath672 is such that @xmath673 then @xmath672 can also be chosen maximal .",
    "we start with any sequence @xmath674 , @xmath669 connecting @xmath40 and @xmath493 .",
    "such a sequence exists because @xmath667 is a connected tolerance .",
    "we prove by induction on @xmath23 .",
    "the base case of induction is obvious by the choice of @xmath40 .",
    "suppose @xmath670 is maximal .",
    "let @xmath675 be a semilattice path and @xmath676 a maximal element .",
    "let also @xmath677 be extensions of the @xmath678 and @xmath679 for @xmath680 $ ] .",
    "then for each @xmath322 , @xmath681 , we construct the sequence @xmath682 and for each @xmath322 , @xmath683 , the sequence @xmath684 , where @xmath685 then observing that @xmath686 we get that @xmath687 for any @xmath688 .",
    "note also that @xmath689 is a maximal element .",
    "continuing in a similar way we also can guarantee that @xmath690 is a maximal element .",
    "this process replaces @xmath691 with a maximal element .",
    "however , @xmath670 is also replaced with another element , and we need to restore the connection of @xmath670 with the preceding elements . since @xmath670 is maximal and @xmath692 , these two elements belong to the same maximal component . therefore , there is a semilattice path @xmath693 .",
    "we now proceed as before .",
    "let @xmath694 be extensions of the @xmath695 . then for each @xmath322 , @xmath696",
    ", we construct sequence @xmath697 and for each @xmath322 , @xmath683 , sequence @xmath698 , where @xmath699 then observing that @xmath700 we get that @xmath701 for any @xmath688 . note also that @xmath702 , @xmath703 is a maximal element , and @xmath704 belongs to the same maximal component as @xmath493 .",
    "if @xmath705 , @xmath176 , then we are done by the induction hypothesis .",
    "suppose they are not and let @xmath706 be such that @xmath707 and @xmath708 . by the induction hypothesis @xmath270",
    "is connected to @xmath271 . as @xmath707",
    ", @xmath40 is connected to @xmath270 .",
    "it remains to show that @xmath271 is connected to @xmath493 .",
    "this , however , follows straightforwardly from the assumption that @xmath493 is maximal , and therefore @xmath709 , and so @xmath710 in @xmath7 .",
    "suppose @xmath7 is not simple and @xmath37 is its maximal congruence .",
    "let @xmath711 . by the induction hypothesis @xmath39",
    "is connected to @xmath712 , that is , there is a sequence @xmath713 such that @xmath714 or @xmath715 is a thin affine or majority edge in @xmath175 .",
    "we will choose some @xmath716 , where @xmath717 is viewed as a subalgebra of @xmath7 , such that @xmath672 is connected to @xmath718 in @xmath7 .",
    "set @xmath719 .",
    "depending on whether @xmath715 is a semilattice , affine , or majority edge , use lemma  [ lem : sl - thick - thin ] , [ lem : thin - affine ] , or  [ lem : thin - majority ] to choose @xmath720 such that @xmath721 is a thin edge .",
    "it remains to show that @xmath722 is connected to @xmath493 .",
    "since @xmath493 is maximal , it suffices to take elements @xmath723 maximal in @xmath712 and such that @xmath724 and @xmath725 .",
    "then @xmath722 is connected to @xmath509 by the induction hypothesis , and @xmath509 is connected to @xmath493 in @xmath7 , as @xmath726 .",
    "there are @xmath739 such that @xmath740 , @xmath741 , and @xmath742 for every @xmath743 $ ] . by lemma",
    "[ lem : going - maximal ] the @xmath744 s can be chosen maximal , and therefore for every @xmath743 $ ] we can choose @xmath745 which is maximal in @xmath7 .",
    "for each @xmath743 $ ] choose @xmath746 with @xmath747 and @xmath748 . by the induction hypothesis @xmath270",
    "is connected to @xmath271 .",
    "then clearly @xmath749 is connected to @xmath270 , and , as @xmath670 is maximal and @xmath750 , @xmath271 is connected to @xmath670 .      by lemma  [ lem : going - maximal ]",
    "there are @xmath728 , @xmath726 , and a maximal element @xmath752 such that @xmath753 .",
    "since @xmath754 , we have @xmath755 .",
    "thus , @xmath756 can be assumed maximal .",
    "we have therefore @xmath757 .",
    "if both @xmath758 and @xmath759 are proper subalgebras of @xmath7 , then proceed as in subcase 1a .",
    "otherwise suppose @xmath760 .",
    "this means @xmath761 , and , in particular , @xmath762 .",
    "therefore there is a binary term operation @xmath101 such that @xmath763 , that is @xmath764 . since both elements are maximal , @xmath765 , implying they are connected .",
    "if there is a maximal @xmath271 such that @xmath769 for some nonmaximal @xmath770 ( that is , @xmath771 ) , then by case  1 and subcase  2b @xmath40 is connected to @xmath271 and @xmath271 is connected to @xmath493 .",
    "suppose all elements in @xmath7 are maximal .",
    "by theorem  [ the : connectedness ] and proposition  [ pro : thin - thick ] there are @xmath772 such that for any @xmath743 $ ] either @xmath721 is an affine or majority edge ( not a thin edge ) , or @xmath773 , or @xmath774 . in the latter two cases",
    "@xmath775 , and therefore there is a semilattice path from @xmath672 to @xmath718 . we need to show that if @xmath721 is an affine or majority edge then @xmath672 is connected to @xmath718 .",
    "let @xmath50 be a congruence of @xmath776 witnessing that @xmath721 is an affine or majority edge . by lemmas  [ lem : thin - majority ] and  [ lem : thin - affine ]",
    "there is @xmath777 such that @xmath778 is a thin edge .",
    "then take @xmath706 such that @xmath779 and @xmath780 . by the induction hypothesis @xmath270",
    "is connected to @xmath271 . finally , as all elements in @xmath7",
    "are maximal , @xmath271 is connected with @xmath718 in @xmath7 with a semilattice path .",
    "subcase 2b .",
    "there is a nonmaximal element @xmath270 with @xmath766 or @xmath767 for some @xmath781 or @xmath726 . in particular",
    ", this happens whenever there is a nonmaximal element @xmath270 with @xmath782 or @xmath783 .",
    "note first that we may assume that , for any @xmath726 , there is an automorphism that sends @xmath509 to @xmath40 and @xmath40 to @xmath509 , as otherwise we are in the conditions of case  1 .",
    "recall that we also assume @xmath784 . because of this and the automorphism swapping @xmath40 and @xmath493 , without loss of generality we may assume that there is nonmaximal @xmath785 .",
    "consider @xmath786 .",
    "if @xmath120 , consider the relation @xmath787 generated by @xmath788 . since @xmath270 is not maximal , @xmath787 can not be the graph of an automorphism .",
    "therefore @xmath787 induces a nontrivial tolerance on @xmath7 that , in particular , connects @xmath40 and @xmath493 , and we either complete as in case  1 , or show that @xmath789 , which is a contradiction , as @xmath790 in this case .    if @xmath791 , take @xmath792 and such that @xmath793 . by the induction hypothesis @xmath40",
    "is connected to @xmath271 .",
    "now let @xmath794 such that @xmath795 .",
    "it remains to show that @xmath796 is connected to @xmath493 .",
    "if @xmath797 , the result follows by the induction hypothesis . if there is no automorphism that swaps @xmath796 and @xmath493 , we argue as in case  1 .",
    "so , let @xmath798 and there is an automorphism swapping @xmath796 and @xmath493 .",
    "let @xmath793 .",
    "the _ s - distance _ from @xmath270 to @xmath271 is the length of the shortest semilattice path from @xmath270 to @xmath271 .",
    "the s - distance from @xmath270 to @xmath800 is the shortest s - distance from @xmath270 to an element from @xmath800 .",
    "the _ depth _ of an element @xmath270 is the greatest s - distance to a maximal component , denoted @xmath801 .",
    "we prove the claim by induction on the size of @xmath51 and @xmath801 , provided @xmath782 , @xmath783 .",
    "if @xmath789 , @xmath785 , in particular , if @xmath802 , then there is a binary term operation @xmath101 such that @xmath803 .",
    "let @xmath804 . since there is an automorphism swapping @xmath40 and @xmath493 , @xmath805 and @xmath806 .",
    "set @xmath807 .",
    "we have @xmath808 since @xmath40 and @xmath493 are automorphic , @xmath102 is a majority operation on @xmath2 .",
    "therefore , @xmath40 and @xmath493 are connected .",
    "suppose the claim is proved for all algebras and pairs of elements v - connected through an element of depth less than @xmath801 .",
    "let @xmath809 and @xmath810 , and @xmath811 or @xmath812 .",
    "we may assume @xmath813 is a nonmaximal element and consider @xmath814 .",
    "as in case  1a if @xmath815 then there is no automorphism swapping @xmath40 and @xmath813",
    ". then we consider relation @xmath787 generated by @xmath816 .",
    "we can show that @xmath40 and @xmath493 are connected in this case .",
    "suppose @xmath817 .",
    "let @xmath818 be such that @xmath819 , let also @xmath820 be such that @xmath821 . by the induction hypothesis @xmath40",
    "is connected to @xmath271 , and therefore to @xmath756 .",
    "also , @xmath756 and @xmath493 are v - connected through @xmath813 , and @xmath822 . if @xmath823 , we conclude by the induction hypothesis of the proposition . if @xmath824 , by the induction hypothesis of claim  4 , @xmath756 is connected to @xmath493 .",
    "libor barto , marcin kozik , and ross willard .",
    "near unanimity constraints have bounded pathwidth duality . in _ proceedings of the 27th annual ieee symposium on logic in computer science , lics 2012 , dubrovnik , croatia , june 25 - 28 , 2012 _ , pages 125134 , 2012 .",
    "andrei  a. bulatov .",
    "tractable conservative constraint satisfaction problems . in _",
    "18th ieee symposium on logic in computer science ( lics 2003 ) , 22 - 25 june 2003 , ottawa , canada , proceedings _",
    ", page 321 , 2003 .",
    "andrei  a. bulatov . on the csp dichotomy conjecture . in _ computer science - theory and applications - 6th international computer science symposium in russia , csr 2011 , st .",
    "petersburg , russia , june 14 - 18 , 2011 .",
    "proceedings _ , pages 331344 , 2011 .",
    "andrei  a. bulatov and matthew valeriote .",
    "recent results on the algebraic approach to the csp . in _ complexity of constraints - an overview of current research themes [ result of a dagstuhl seminar ] .",
    "_ , pages 6892 , 2008 ."
  ],
  "abstract_text": [
    "<S> we refine and advance the study of the local structure of idempotent finite algebras started in [ a.bulatov , _ the graph of a relational structure and constraint satisfaction problems _ , lics , 2004 ] . </S>",
    "<S> we introduce a graph - like structure on an arbitrary finite idempotent algebra omitting type . </S>",
    "<S> we show that this graph is connected , its edges can be classified into 3 types corresponding to the local behavior ( semilattice , majority , or affine ) of certain term operations , and that the structure of the algebra can be ` improved ' without introducing type  by choosing an appropriate reduct of the original algebra </S>",
    "<S> . then we refine this structure demonstrating that the edges of the graph of an algebra can be made ` thin ' , that is , there are term operations that behave very similar to semilattice , majority , or affine operations on 2-element subsets of the algebra . </S>",
    "<S> finally , we prove certain connectivity properties of the refined structures .    </S>",
    "<S> this research is motivated by the study of the constraint satisfaction problem , although the problem itself does not really show up in this paper .    </S>",
    "<S> [ theorem]corollary [ theorem]proposition [ theorem]problem [ theorem]lemma [ theorem]remark [ theorem]observation    h  s # 1#1_fin p # 1var(#1 ) # 1sg(#1 ) # 1sg_(#1 ) # 1sg_(#1 ) # 1#2sg_#1(#2 ) # 1cg(#1 ) # 1#2cg_#1(#2 ) # 1rbcomp(#1 )    = = = = = = =    # 1(_#1,_#1 )    = = = = =    p *o *    # 1(#1 ) # 1(#1 ) # 1(#1 ) # 1(#1 ) =    = # 1#1 # 1#1 # 1 # 1#2#1 _ 1#1 _ # 2 # 1#2#1 _ 1  #1 _ # 2 = \\ # 1height7pt depth3pt width.4pt # 1/ # 1 # 1#2    (    c # 1 + # 2    )    # 1#2#3    (    c # 1 + # 2 + # 3    )    # 1#2#3#4    (    c # 1 + # 2 + # 3 + # 4    )    # 1#2#3#4#5#6    (    c # 1 + # 2 + # 3 + # 4 + # 5 + # 6    )    = # 1 - 1.7mm^#1 # 1 - 0.2mm^#1 # </S>",
    "<S> 1#2#3    (    ccc 1&2&3 + # 1&#2&#3    )    = =    = = = = = = = = = = = =    = eufm10 scaled 1200 = eufm6 12= 12=12= = msbm10 = msbm8 11=11= 11==msbm10 scaled 1200 13=13= 13==``0b4e = ' ' 0d3f </S>"
  ]
}