{
  "article_text": [
    "the @xcite procedure represents one of what has become a rather large class of techniques in which we would like to be able to calculate order statistics arising from several populations .",
    "the complexity of the calculations implied by such approaches has remained a barrier to accurate probability statements .",
    "we provide tools which greatly extend the range of computable cases .",
    "order statistics obtained by sampling from two different populations occur , e.g. , when @xmath0-values arise from null or alternative hypotheses , from men or women , or from two different types of cancer .",
    "the distribution of order statistics for independent , identically distributed random variables is well known , and appears in every basic statistics book ; for example , ( * ? ? ?",
    "* chapter 4 , section 6 ) . @xcite and @xcite provide a thorough review of order statistics . for identically distributed random variables ,",
    "the cumulative distribution function is concise and fast to compute .    for independent , but not identically distributed random variables , a formula for computing the joint cumulative distribution function of the order statistics",
    "was given by @xcite .",
    "however , this formula is computationally intractable , because it involves an exponential number of permanents of the size of the number of random variables .",
    "in addition , the complexity of the computation of the permanent by the best algorithms grows exponentially @xcite .",
    "approximate algorithms for computing the permanent @xcite with lower asymptotic complexity are still not practical .",
    "we show that the computational cost of the formula in the case of two populations is still exponential , but is a dramatic improvement compared to the general formula by bapat and beg . in the case when only the joint distribution function of a subset of the order statistics of fixed size is needed , we show that the complexity is polynomial , in the case of two populations .",
    "for an @xmath1 matrix @xmath2 , with entries @xmath3 , the permanent is given by @xcite @xmath4   = \\sum_{\\pi}\\prod_{i=1}^{m}a_{i,\\pi\\left (   i\\right )   } \\text { . }",
    "\\label{eq : permanent}\\ ] ] where @xmath5 ranges over all permutations of @xmath6 .",
    "hence , the permanent is defined much like the determinant , but with all signs positive .",
    "the permanent can be expanded by row or columns exactly like the determinant .",
    "the computational cost of evaluating the permanent by expansion is @xmath7 operations .",
    "the computational cost using the best algorithms is exponential @xcite .",
    "the following notation will be used in all theorems and proofs in this paper without further explicit reference .",
    "@xmath8 , @xmath9 are independent real valued random variables with cumulative distribution functions @xmath10 .",
    "the order statistics @xmath11 are random variables defined by sorting the values of @xmath8 . in particular , @xmath12 . the arguments of the joint cumulative distribution function of order statistics are customarily written omitting redundant arguments ; thus let @xmath13 @xmath14 , denote the indices of the remaining arguments and @xmath15 their values",
    ". finally , define the index vector @xmath16 and the summation index set@xmath17{c}0=i_{0}\\leq i_{1}\\leq\\cdots\\leq i_{k}\\leq i_{k+1}=m\\text { , } \\\\",
    "\\text{and } i_{j}\\geq n_{j}\\text { for all } 1\\leq j\\leq k \\end{array } \\right\\ }   .",
    "\\label{eq : def - i}\\ ] ] writing summation over the set @xmath18 in terms of loops is straightforward .",
    "using the set @xmath18 instead of the loop in this paper allows an insight into the structure of the method and its complexity , and it does not tie the mathematical formulation to any particular implementation .",
    "the joint cumulative distribution function of the set @xmath19 , which is a subset of the complete set of order statistics , is defined as@xmath20    for two sequences @xmath21 and @xmath22 , let @xmath23 denote @xmath24 .",
    "let @xmath25 be a generic positive constant independent of @xmath26 ; that is , @xmath25 can have a different value every time it is used .",
    "now @xmath27 can be written as @xmath28 .",
    "first consider the distribution of the order statistics of a random sample where each sample member is taken from a possibly different population with its own distribution .",
    "[ @xcite , theorem 4.2][thm : bb]the cumulative distribution function of the order statistics satisfies @xmath29 where @xmath30   _ { \\left (   i_{j}-i_{j-1}\\right ) \\times1}\\end{bmatrix } _",
    "{ j=1,i=1}^{j = k , i = m } \\label{eq : bp - perm}\\ ] ] is the permanent of the block matrix with the block row index @xmath31 and block column index @xmath32 .",
    "the blocks have @xmath33 rows , and @xmath34 column each , which is denoted by the subscript @xmath35 .",
    "each block has only one distinct entry , which is @xmath36   $ ] .",
    "we take @xmath37 .",
    "@xmath38    in expanded form , the permanent ( [ eq : bp - perm ] )  can be written as@xmath39   & \\left [   1-f_{2}\\left ( y_{k}\\right )   \\right ]   & \\cdots & \\left [   1-f_{m}\\left (   y_{k}\\right )   \\right ] \\\\",
    "\\vdots & \\vdots &   & \\vdots\\\\ \\left [   1-f_{1}\\left (   y_{k}\\right )   \\right ]   & \\left",
    "[   1-f_{2}\\left ( y_{k}\\right )   \\right ]   & \\cdots & \\left [   1-f_{m}\\left (   y_{k}\\right ) \\right ] \\end{bmatrix } , \\ ] ] where the @xmath31-th group , @xmath40 , contains @xmath41 repetitions of the same row .    the theorem is stated , but not proved in @xcite .",
    "we provide a proof for the sake of completeness , and to prepare the ground for our result .",
    "define @xmath42 , and @xmath43 .",
    "note that for @xmath44 , @xmath45 , and @xmath46 , since the @xmath47 are cumulative distribution functions .",
    "denote @xmath48 .",
    "then we have@xmath49 denote by @xmath50 the random variable equal to the number of @xmath8 such that @xmath51 .",
    "then @xmath52 , and the condition that at least @xmath53 of @xmath51 is equivalent to @xmath54 .",
    "thus , @xmath55 and , since the events @xmath56 for different @xmath57 are disjoint , @xmath58\\right\\ }   \\right )   .",
    "\\label{eq : ultimate}\\ ] ]    now fix @xmath57 and write an arbitrary permutation of @xmath59 as @xmath60 where each subsequence @xmath61 has exactly @xmath41 terms",
    ". we will use @xmath62 to denote the set of the terms .",
    "then , @xmath63\\quad\\\\ &   \\longleftrightarrow\\exists\\pi\\forall j\\in\\left\\ {   1,2,\\ldots , k+1\\right\\ }   : \\forall i\\in\\left\\ {   \\pi_{j}\\right\\ }   : x_{i}\\in(y_{j-1},y_{j}].\\end{aligned}\\ ] ] hence,@xmath64\\right\\ }   \\right ) \\\\ &   = \\frac{\\sum_{\\pi}\\pr\\left (   \\bigcap_{j=1}^{k+1}\\bigcap_{i\\in\\left\\ { \\pi_{j}\\right\\ }   } \\text { } \\left\\ {   x_{i}\\in(y_{j-1},y_{j}]\\right\\ }   \\right ) } { \\left (   i_{1}-i_{0}\\right )   !",
    "\\cdots\\left (   i_{k+1}-i_{k}\\right )   ! } \\\\ &   = \\frac{\\sum_{\\pi}\\prod\\limits_{j=1}^{k+1}\\prod\\limits_{i\\in\\left\\ {   \\pi _ { j}\\right\\ }   } \\left [   f_{i}\\left (   y_{j}\\right )   -f_{i}\\left (   y_{j-1}\\right )   \\right ]   } { \\left (   i_{1}-i_{0}\\right )   ! \\cdots\\left (   i_{k+1}-i_{k}\\right )   ! } , \\end{aligned}\\ ] ] because the events in the intersection are independent :  there is one event for each @xmath8 , which are independent random variables . substituting into ( [ eq : penultimate ] )  and comparing with the definition of the permanent ( [ eq : permanent ] ) concludes the proof .    as noted in the introduction ,",
    "using a general algorithm for permanents is prohibitively expensive . given simplifying assumptions",
    ", however , the problem becomes easier . in the case",
    "when the variables @xmath65 , @xmath66 are independent and identically distributed ( that is , the classical case of sampling from a single population ) , theorem [ thm : bb ] reduces to the following well - known result @xcite .",
    "[ thm : one - population]suppose that @xmath67 for all @xmath32",
    ". then the joint cumulative distribution function of the order statistics satisfies @xmath68   ^{i_{j}-i_{j-1}}}{\\left (   i_{j}-i_{j-1}\\right )   ! } .\\ ] ]    now consider drawing a random sample from two populations , each with a different cumulative distribution function , say @xmath69 , and @xmath70 .",
    "sample the first @xmath71 random variables from the first population with the distribution function @xmath72 , and then @xmath73 from the second population with the distribution function @xmath74 .",
    "then the permanents from equation [ eq : first ] ( @xcite ) simplify to the block form with constant blocks,@xmath75   _ { \\left (   i_{1}-i_{0}\\right )   \\times n } & \\left [   g(y_{1})-g(y_{0})\\right ]   _ { \\left (   i_{1}-i_{0}\\right )   \\times\\left ( m - n\\right )   } \\\\ \\left [   f(y_{2})-f(y_{1})\\right ]   _ { \\left (   i_{2}-i_{1}\\right )   \\times n } & \\left [   g(y_{2})-g(y_{1})\\right ]   _ { \\left (   i_{2}-i_{1}\\right )   \\times\\left ( m - n\\right )   } \\\\ \\vdots & \\vdots\\\\ \\left",
    "[   f(y_{k+1})-f(y_{k})\\right ]   _ { \\left (   i_{k+1}-i_{k}\\right )   \\times n } & \\left [   g(y_{k+1})-g(y_{k})\\right ]   _ { \\left (   i_{k+1}-i_{k}\\right ) \\times\\left (   m - n\\right )   } \\end{bmatrix } , \\label{eq:2-perm}\\ ] ] where the subscripts indicate the dimensions of blocks created by the repetition of the term in the brackets , and we take @xmath76    in expanded form , the permanent ( [ eq:2-perm ] )  can be written as@xmath77    this special form of the permanent allows us to evaluate the joint distribution of the order statistic more efficiently .",
    "[ thm : two - polulations]suppose that @xmath78 , for all @xmath79 and @xmath80 , for all @xmath81 . then @xmath82   ^{\\lambda_{j}}\\left [   g\\left (   y_{j}\\right )   -g\\left (   y_{j-1}\\right )   \\right ]   ^{i_{j}-i_{j-1}-\\lambda_{j}},\\end{aligned}\\ ] ] where @xmath83 ranges over all integer vectors such that@xmath84    we evaluate the permanents @xmath85 from ( [ eq:2-perm ] ) .",
    "let @xmath86 and @xmath87 .",
    "write a permutation of @xmath6 as @xmath88 , where each subsequence @xmath61 has exactly @xmath41 terms .",
    "the subsequence @xmath61 is a list of the subscripts of the random variables that fall in the interval @xmath89 .",
    "then the term in the definition of the permanent ( [ eq : permanent ] ) associated with @xmath5 is@xmath90   ^{\\lambda_{j}}\\left [ g\\left (   y_{j}\\right )   -g\\left (   y_{j-1}\\right )   \\right ]   ^{i_{j}-i_{j-1}-\\lambda_{j}},\\ ] ] where @xmath91 is the number of random variables with subscripts listed in @xmath92 that are in @xmath93 . for illustration ,",
    "the intervals and the number of order statistics of each type in them are shown in table [ tab:2-pop ] .",
    "[ c]c|cccc|cinterval & @xmath94 $ ] & @xmath95 $ ] & @xmath96 & @xmath97 & total + @xmath98 & @xmath99 & @xmath100 & @xmath96 & @xmath101 & @xmath71 + @xmath102 & @xmath103 & @xmath104 & @xmath96 & @xmath105 & @xmath73 + total & @xmath106 & @xmath107 & @xmath96 & @xmath108 & @xmath26    the number of permutations @xmath5 such that @xmath91 is the number of the elements from @xmath92 that are in @xmath93 is found as the product @xmath109 , where@xmath110 is the number of ways to distribute the @xmath71 elements of @xmath93 so that set @xmath31 has @xmath91 elements ( the multinomial coefficient ) , @xmath111 is the number of ways to distribute the @xmath73 elements of @xmath93 so that set @xmath31 has @xmath112 elements , and@xmath113 is the number of permutations that do not change the distribution of the elements @xmath93 and @xmath114 into those sets .",
    "thus,@xmath115   ^{\\lambda_{j}}\\left [   g\\left (   y_{j}\\right )   -g\\left (   y_{j-1}\\right )   \\right ]   ^{i_{j}-i_{j-1}-\\lambda_{j}},\\end{aligned}\\ ] ] with the sum over all @xmath116 that satisfy ( [ eq : lambda - constr ] ) .",
    "the result now follows from theorem  [ thm : bb ] .",
    "the proof of theorem [ thm : two - polulations ] easily carries over to the general case of order statistics of a sample selected from an arbitrary number of populations .",
    "the proof of the next theorem can therefore be omitted .",
    "[ thm : arbitrary]suppose that @xmath117 for the first @xmath118 indices @xmath32 , @xmath119 for the next @xmath120 indices @xmath32 , etc . , and @xmath121 for the last @xmath122 indices @xmath32 , with@xmath123 then @xmath124   } \\prod_{j=1}^{k+1}\\prod\\limits_{s=1}^{n}\\frac{m_{s}!}{\\lambda_{js}!}\\left [ g_{s}\\left (   y_{j}\\right )   -g_{s}\\left (   y_{j-1}\\right )   \\right ] ^{\\lambda_{js}}\\ ] ] where the summation is over all integer matrices @xmath125 $ ] size @xmath126 by @xmath127 such that@xmath128 and we take @xmath129 , @xmath130 .",
    "theorem [ thm : arbitrary ] covers all of the theorems above . in the particular case when all @xmath131 , i.e. , every distribution is different because it comes from a different population , it gives exactly the same result as theorem [ thm : bb ] . with two populations",
    ", the complexity of theorem [ thm : arbitrary ] reduces to the complexity of theorem [ thm : two - polulations ] .",
    "the complexity of theorem [ thm : two - polulations ] is less than that of the theorem [ thm : bb ] from @xcite , as discussed in the next section .",
    "we will now compare the relative complexity of theorem [ thm : bb ] , from @xcite , and our formula , theorem [ thm : two - polulations ] .",
    "we assume that the evaluation of the cumulative distribution function of each of the statistics takes a constant number of operations .        the inequalities in ( [ eq : i - ineq ] )",
    "are obtained by taking the smallest numbers for @xmath138 and the largest possible value for @xmath139 , which both give the largest number of terms .",
    "we now prove that@xmath140 by induction over @xmath139 . for @xmath141 , ( [ eq : induction ] )",
    "follows from@xmath142 and@xmath143    now assume that ( [ eq : induction ] ) holds for some @xmath139 and we will show that @xmath144 from the definition ( [ eq : summation ] ) and the induction assumption ( [ eq : induction ] ) , it follows that@xmath145 \\\\ &   \\quad-\\sum_{i = k+1}^{m}\\left [   \\binom{i+k}{k}-\\binom{i+k+1}{k}\\right ]   , \\end{aligned}\\ ] ] where we have used the identity @xmath146 twice . both sums telescope , and we get @xmath147 \\\\ &   -\\left [   \\binom{m+k+1}{k}+\\binom{2k+1}{k}\\right ]   , \\end{aligned}\\ ] ] which , noting that@xmath148 gives ( [ eq : k - plus-1 ] ) . equations ( [ eq : catalan - triangle ] )  and ( [ eq : catalan ] ) follow from ( [ eq : induction ] ) by a direct computation : @xmath149 and@xmath150 which concludes the proof .",
    "the numbers @xmath151 defined by ( [ eq : catalan ] ) are known as the catalan numbers @xcite , and the numbers @xmath152 are called the catalan triangle @xcite . from the stirling approximation @xmath153 , the growth of catalan numbers is exponential , @xmath154 for any @xmath155 ( with a different @xmath25 for each @xmath156 ) .",
    "the worst case complexity of computing the distribution function of the order statistics from theorem [ thm : bb ] is@xmath157 where @xmath158 is the number of operations for computing permanent of order @xmath26 .",
    "it is known that the complexity of computing the permanent is bounded by @xmath160 for some @xmath161 , e.g. , from the ryser s formula @xcite .",
    "so , the complexity of the computation of the distribution function from theorem [ thm : bb ] is exponential in @xmath26 .",
    "therefore , the computation is practical only for small @xmath26 .",
    "fortunately , a drastic reduction of complexity is possible in the case when the order statistics come from two populations .",
    "in fact , the complexity reduces still farther when we need only a small number @xmath139 of order statistics .",
    "[ thm : two - k]let @xmath162 be the number of operations in theorem [ thm : two - polulations ] to evaluate the joint distribution function of @xmath139 order statistics from @xmath26 random variables from two populations , with @xmath163 of the variables from the first population .",
    "then@xmath164 in the worst case over all @xmath139 and @xmath71 , the complexity is bounded by @xmath165 for any fixed @xmath139 , the complexity is bounded by@xmath166 i.e. , the complexity is polynomial in @xmath26 .",
    "the complexity is bounded by @xmath167 , where @xmath168 is the number of terms in the sum over @xmath57 , @xmath169 is the number of possible index vectors @xmath116 satisfying ( [ eq : lambda - constr ] ) , and @xmath170 is the complexity of evaluating the products in one term of the sum , which is @xmath171 . to bound @xmath169 , drop the upper bounds in ( [ eq : lambda - constr ] ) . thus @xmath169 is bounded above by the number of all integer vectors @xmath116 such that@xmath172 which is the same as the number of ways to distribute @xmath71 indistinguishable objects to @xmath126 distinguishable bins , which equals to @xmath173 .",
    "this gives ( [ eq : two - k ] ) .    the bound ( [ eq : two - k - worst - case ] ) follows by taking a pessimistic value of @xmath139 in each term ( [ eq : two - k ] ) - twice @xmath174 , then @xmath175 , and pessimistic value @xmath176 .",
    "the second part of ( [ eq : two - k - worst - case ] ) follows from the stirling formula .",
    "although the complexity of evaluating the cumulative distribution function of order statistics from theorem [ thm : bb ] is exponential in the general case , we have shown in theorem [ thm : two - k ] that the complexity is bounded by a polynomial of a small degree when there are only two populations , and the number of order statistics considered , @xmath139 , is fixed and small .",
    "the complexity also depends on @xmath71 , the number of random variables from the first population , @xmath93 . in general , @xmath71 is fixed by the state of nature .            to confirm and illustrate the result , we have conducted a timing experiment .",
    "we calculated the joint distribution function in the case of two populations .",
    "we considered @xmath141 , @xmath183 , and @xmath184 , and fixed @xmath185 .",
    "we measured the amount of time it took to compute the joint distribution function using the general bapat beg formula with permanents ( fig .",
    "[ fig : bb ] ) and the new special formula ( fig .",
    "[ fig : nw ] ) .",
    "both theorems were implemented in mathematica .",
    "the permanents were computed in mathematica using the code @xmath186:= } &   \\mathtt{with[{v = array[x , length[a]]},}\\\\ &   \\mathtt{coefficient[times@@(a.v),times@@v]}\\ ] ] from @xcite .",
    "this function computes the permanent of matrix @xmath187 by vardi s formula as the coefficient of @xmath188 in @xmath189 using symbolic manipulation with automatic caching of partial results by the mathematica kernel .",
    "amazingly , calculating the permanent from ( [ eq:2-perm ] ) in mathematica results in times that grow polynomially with @xmath26 , the number of rows in the permanent .",
    "consequently , for two populations , while the theoretical complexity of bapat beg is exponential , the actual time observed while calculating the formulas in mathematica was polynomial ( fig .",
    "[ fig : bb ] ) . graphing the time versus the log of @xmath26 produces almost straight lines in a log - log plot .",
    "we attribute this speedup to the reuse of partial results by the mathematica kernel .",
    "mathematica calculates the bapat beg formula more rapidly than predicted . in the timing experiment ,",
    "the observed times for the new formula ( theorem [ thm : two - polulations ] ) are much faster than the bapat beg formula .",
    "the observed improvement was quite dramatic ( fig .",
    "[ fig : im ] ) .",
    "the observed improvement is of the order @xmath190 ( table [ tab : fit ] )",
    ". the observed complexity of the new formula for two populations was of the order @xmath191 , which confirms the result of theorem [ thm : two - k ] for constant @xmath185 .",
    "mathematica code to calculate the cumulative distribution function for arbitrary collections of order statistics of independent random variables which may have different distributions is available free from the authors .",
    "examples demonstrating the use of the software are also available from the authors ."
  ],
  "abstract_text": [
    "<S> the joint cumulative distribution function for order statistics arising from several different populations is given in terms of the distribution function of the populations . </S>",
    "<S> the computational cost of the formula in the case of two populations is still exponential in the worst case , but it is a dramatic improvement compared to the general formula by bapat and beg . in the case when only the joint distribution function of a subset of the order statistics of fixed size is needed , the complexity is polynomial , for the case of two populations .    * keywords : * block matrix , computational complexity , multiple comparison . </S>"
  ]
}