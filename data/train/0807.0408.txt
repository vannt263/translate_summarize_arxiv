{
  "article_text": [
    "a number of relations valid in the far from equilibrium regime have appeared in the last fifteen years@xcite that show intriguing relationships between fluctuations in non - equilibrium systems governed either by deterministic or stochastic dynamics . among these relations ,",
    "the jarzynski@xcite and crooks relations@xcite provide a means to compute the free energy difference between two classical systems by use of a control parameter that switches the system from one ensemble to another in a well - defined manner .",
    "the extension of these relations to quantum systems has been analyzed recently by several authors@xcite .",
    "current methods of calculating free energy differences in quantum systems using non - equilibrium processes rely on the knowledge of the quantum history of the system which , while yielding a conceptually appealing picture , can not provide a reasonable scheme for the computation of free energy differences in practical applications .",
    "the challenges associated with constructing the correct coherent quantum dynamics make the approach difficult to implement .",
    "the path integral representation of the canonical partition function is based on mapping a quantum system at finite temperature onto a classical system with additional degrees of freedom@xcite .",
    "a non - equilibrium process can be carried out on this isomorphic classical system along a well defined trajectory in fictitious time . as will be demonstrated ,",
    "the jarzynski and crooks relations are valid for such a process provided conditions analogous to the ones required for the relations in a classical system are met . as a consequence , quantum free energies using fictitious non - equilibrium classical processes can be obtained using the path integral representation .",
    "the path integral formulation , however , involves an infinite number of degrees of freedom , and , as a result , non - equilibrium dynamical processes in this representation could lead to divergences which need to be regularized .",
    "the practicality of the method depends sensitively on the rate of convergence of properties determined from the regularized path integral to their true quantum values , an issue that is given considerable attention in this paper and the following paper in the series , which treats the case of a harmonic oscillator in detail@xcite .",
    "the paper is organized as follows . in sec .",
    "[ system ] , the path integral formalism and two equilibrium methods to compute free energy differences are reviewed .",
    "the jarzynski non - equilibrium work relation and the crooks fluctuation relation using fictitious non - equilibrium processes are derived in sec .",
    "[ non - equilibrium ] . in sec .",
    "[ regularization ] , the subtleties associated with the divergence of the total energy and work of a system with an infinite number of degrees of freedom are discussed , and two regularization methods are introduced . the first one is based on the fourier representation of closed paths representing quantum particles and the second is based on a spatial discretization of the closed paths . in sec .",
    "[ numerical - quartic ] , the non - equilibrium free energy method is applied numerically to the free energy of a double well potential of quartic form as the asymmetry between the wells is varied .",
    "the conclusions are given in sec .",
    "[ conclusions ] .",
    "consider a quantum system with a hamiltonian of the form @xmath0 with @xmath1 and @xmath2 .",
    "for simplicity of presentation , the position operator @xmath3 and the associated momentum operator @xmath4 here are taken to be one - dimensional though the extension of the analysis to higher dimensional systems is straightforward . note that the potential energy @xmath5 depends on a control parameter @xmath6 which is independent of the configuration of the system .",
    "the canonical partition function of this system at an inverse temperature @xmath7 is defined by @xmath8 which is related to the free energy by @xmath9    the partition function can be written in path integral form as@xcite @xmath10 } , \\label{partitionfunction}\\ ] ] where the integral is over closed paths @xmath11 [ i.e. , @xmath12 and the euclidean action @xmath13 is a functional of @xmath14 given by @xmath15 = \\int_0^{\\beta\\hbar}\\ !",
    "\\mathrm ds   \\left [ \\frac12 m                    \\big({\\frac{\\mathrm{d}^{}x}{\\mathrm{d}s^{}}}\\big)^2 + v(x,\\lambda ) \\right ] .",
    "\\label{euclideanaction}\\end{aligned}\\ ] ] here and below the @xmath16 dependence of @xmath14 in integrals over @xmath16 will always be implied . due to the cyclic property of the trace , the quantum mechanical equilibrium ensemble average @xmath17\\}/z(\\lambda)$ ] of an operator @xmath18 can be written in the path integral formulation as @xmath19~e^{-\\frac{1}{\\hbar}s[x,\\lambda ] }     = \\langle\\overline{a}[x,\\lambda]\\rangle_\\lambda , \\label{average}\\ ] ] where @xmath20 denotes a path integral average @xmath21}$ ] and @xmath22 denotes the imaginary time average @xmath23     = \\frac{1}{\\beta\\hbar}\\int_0^{\\beta\\hbar } \\mathrm ds\\ , a(x(s),\\lambda).\\ ] ] note that the path integral average of a function of a single imaginary time point , @xmath24 , does not depend on the choice of the time point @xmath25 , due to the imaginary time translational invariance of the euclidean action .",
    "one may therefore replace @xmath24 by the imaginary time average @xmath26\\rangle_\\lambda$ ] , which is often advantageous for reasons of computational efficiency .",
    ".   defines the equilibrium ensemble average of a general functional @xmath27 $ ] of the path @xmath11 , which could also be in general a function of @xmath6 .",
    "note that for multiple - particle systems , one needs to incorporate exchange effects associated with quantum statistics@xcite .    in the context of equilibrium statistical mechanics ,",
    "the free energy difference between two systems characterized by different values of the control parameter @xmath6 can be computed in this picture through the so - called thermodynamic integration method , and is given by @xmath28 \\right\\rangle_{\\lambda } \\label{thermintegration } , \\end{aligned}\\ ] ] where the free energy change refers to the difference between the initial and final states through @xmath6 ( i.e. @xmath29 ) .",
    "alternatively , one can compute the free energy change directly using the following identities@xcite @xmath30-s[x,\\lambda_a])\\right ] \\right\\rangle_{\\lambda_a }   \\nonumber \\\\ & = & -\\frac{1}{\\beta } \\log \\left\\langle \\exp\\left [ -\\beta   \\left ( \\ : \\overline{v}[x,\\lambda_b]-\\overline{v}[x,\\lambda_a ] \\right )   \\right ] \\right\\rangle_{\\lambda_a } \\label{freeenergydirect } .\\end{aligned}\\ ] ] in the classical limit , the closed paths @xmath11 transform into a point @xmath14 and eqs.([thermintegration ] ) and ( [ freeenergydirect ] ) transform into the well - known classical expressions@xcite .",
    "the non - equilibrium relations derived in this section pertain to a non - equilibrium process in fictitious time . to construct the fictitious dynamics , a new field @xmath31",
    "is introduced which is also periodic in imaginary time , satisfying @xmath32 . by multiplying the path integral representation of the partition function in eq .   by @xmath33 where @xmath34 is",
    "a normalization constant and @xmath35 is an arbitrary fictitious mass , one obtains @xmath36-\\frac{1}{\\hbar}\\int\\ !                   \\mathrm",
    "ds\\,\\frac{p^2}{2\\mu}}.   \\label{zpx}\\ ] ] using eq .",
    ", this equation can be cast in the form of a classical partition function @xmath37 } , \\label{zpx2}\\ ] ] where the fictitious hamiltonian is given by @xmath38 =     \\int_0 ^ 1\\ !",
    "\\mathrm du   \\bigg [       \\frac{p^2}{2\\mu } +      \\frac12\\kappa\\big({\\frac{\\mathrm{d}^{}x}{\\mathrm{d}u^{}}}\\big)^2       + v(x,\\lambda ) \\bigg ] .",
    "\\label{scaledh}\\ ] ] here , a scaled imaginary time variable @xmath39 , has been introduced , while @xmath40 equations and correspond to the thermal field theory of a classical closed elastic string of unit length in one dimension with mass @xmath35 and string tension @xmath41 .",
    "recently , schll - paschinger and dellago showed that jarzynski s non - equilibrium work relation@xcite holds for a wide class of classical deterministic systems with a finite number of degrees of freedom@xcite .",
    "it was demonstrated that if the dynamics of a system for fixed values of @xmath6 admits an invariant distribution of the system plus bath equal to the canonical distribution at an inverse temperature @xmath7 multiplied by a function dependent on the bath variables only , then the free energy difference can be found from @xmath42 where the average is over repetitions of a non - equilibrium process in which the system starts from a configuration drawn from the above mentioned invariant distribution at @xmath43 and is driven out of equilibrium by varying the control parameter @xmath6 in a finite amount of time @xmath44 from @xmath45 to @xmath46 via an arbitrary protocol @xmath47 .",
    "furthermore , the work @xmath48 done in the process in eq .",
    "is given by @xmath49 the result of schll - passinger and dellago holds for a variety of different deterministic dynamics .",
    "thus , for the purpose of computing @xmath50 from eq .  , any dynamical evolution scheme can be used .",
    "perhaps the simplest dynamical evolution is generated by hamiltonian dynamics . in the current context , this dynamics is governed by the fictitious hamiltonian in eq .",
    ", so the work @xmath48 is also fictitious .",
    "the equations of motion for the fields @xmath51 and @xmath52 resulting from the fictitious hamiltonian are    @xmath53}{\\delta p(u ) }     = \\frac{p}{\\mu }   \\label{dxdt } \\\\    { \\frac{\\partial^{}p}{\\partialt^ { } } }     & = -\\frac{\\delta h[x , p,\\lambda]}{\\delta x(u ) }     = \\kappa{\\frac{\\partial^{2}x}{\\partialu^{2}}}-{\\frac{\\partial^{}}{\\partialx^{}}}v(x,\\lambda ) .",
    "\\label{dpdt}\\end{aligned}\\ ] ]    equations   and are the usual equations of motion of a single elastic string in an external potential @xmath5 . it should be stressed that these equations have no relation to the real time evolution of the original quantum particle .",
    "because the system is isolated , the fictitious work done on the system in changing the control parameter @xmath6 is precisely the difference between values of the fictitious hamiltonian at time @xmath44 and at time @xmath54 . introducing the convention that quantities without explicit time arguments",
    "are taken at time zero , one can thus write @xmath55-h[x , p,\\lambda_a ] .",
    "\\label{wdef}\\ ] ] now consider the exponential average of @xmath48 over initial conditions drawn from the canonical equilibrium of the string at @xmath43 : @xmath56 }     } {       \\int\\ ! \\mathcal{d}x\\mathcal{d}p\\:e^{-\\beta h[x , p,\\lambda_a ] }     } \\nonumber\\\\    & =      \\frac {       \\int\\ !",
    "\\mathcal{d}x\\mathcal{d}p\\:e^{-\\beta h[x(\\tau),p(\\tau),\\lambda_b ] }     } {       \\int\\ ! \\mathcal{d}x\\mathcal{d}p\\:e^{-\\beta h[x , p,\\lambda_a ] }     } .",
    "\\nonumber\\end{aligned}\\ ] ] in the numerator , one can change path integration variables from the initial field @xmath14 and @xmath57 to @xmath58 and @xmath59 .",
    "the jacobian of this transformation is equal to unity due to liouville s theorem@xcite , so that @xmath60 }     } {       \\int\\!\\mathcal{d}x\\mathcal{d}p\\:e^{-\\beta h[x , p,\\lambda_a ] }     } \\nonumber\\\\     & = \\frac{z(\\lambda_b)}{z(\\lambda_a ) } = e^{-\\beta\\delta f } , \\label{jeh}\\end{aligned}\\ ] ] which is jarzynski s non - equilibrium work relation , i.e. eq .  .",
    "it should be stressed that while @xmath48 is fictitious work , the resulting @xmath50 is the real quantum free energy difference .",
    "note that for a process that occurs infinitely fast , i.e. the switching time @xmath61 , one recovers eq .  .",
    "for an infinitely slow process , however , one does nt recover the canonical equilibrium expression eq .   due to the fact that the system evolves in isolation .",
    "another non - equilibrium relation , the crooks fluctuation relation@xcite , can also be shown to hold in this context .",
    "consider a non - equilibrium process performed as stated above , as well as in the reversed sense , i.e.  starting from configurations drawn from a canonical distribution at @xmath62 and driven out of equilibrium by varying @xmath6 in time from @xmath46 to @xmath45 in the reversed direction of time , that is , with @xmath63 .",
    "then the probability that an amount @xmath48 of work is done during the forward process can be written as @xmath64}}{z_a}\\delta\\left(w-\\int_0^\\tau \\mathrm dt\\:\\dot{\\lambda } { \\frac{\\partial^{}h}{\\partial\\lambda^{}}}\\right ) \\nonumber\\\\    & =       \\int\\ ! \\mathcal{d}x'\\mathcal{d}p'~\\frac{e^{-\\beta w}e^{-\\beta h[x',p',\\lambda_b]}}{z_a}\\delta\\left(w+\\int_0^\\tau \\mathrm dt\\:\\dot{\\lambda } { \\frac{\\partial^{}h}{\\partial\\lambda^{}}}\\right ) \\nonumber\\\\    & = e^{\\beta w}e^{-\\beta\\delta f } p_r(-w ) , \\label{cfr}\\end{aligned}\\ ] ] where @xmath65 is the probability that an amount of work @xmath66 is done during the reverse process .",
    "is known as the crooks fluctuation relation@xcite .",
    "note that the value of @xmath48 at which the two distributions @xmath67 and @xmath65 become equal , which will be denoted by @xmath68 , is precisely when @xmath69 .",
    "thus this relation allows @xmath50 to be computed by determining where the plots of @xmath67 and @xmath65 versus @xmath48 intersect .",
    "this approach is known as the crossing method@xcite .",
    "the crooks fluctuation relation , eq .  , can be extended to a conditional ensemble in which a particular value of a variable , called the `` reaction coordinate '' , is held fixed to a value @xmath70@xcite .",
    "the free energy @xmath71 at this constrained value of the reaction coordinate is known as the potential of mean force . here",
    ", we consider the reaction coordinate @xmath70 to be given by a functional @xmath72 of the position - field @xmath14 , and the hamiltonian to take the form @xmath73=h_0[x , p]+\\phi(\\tilde\\chi[x],\\lambda ) .",
    "\\label{hpmf}\\end{aligned}\\ ] ] the potential of mean force @xmath71 is then defined as @xmath74)\\rangle_0 \\label{pmf}\\end{aligned}\\ ] ] plus an arbitrary constant , where the average is over the path integral corresponding to @xmath75 . defining @xmath76 as the joint probability that work",
    "@xmath48 is done in the forward process with a final value of @xmath70 for the reaction coordinate , and @xmath77 as the joint probability for work @xmath48 and initial value @xmath70 in the reverse process , then one can derive analogously to eq .   that @xmath78 , again using liouville s theorem .",
    "integrating this identity over @xmath48 gives @xmath79)\\rangle_{\\lambda_b } = \\langle\\delta(\\chi-\\tilde\\chi[x(\\tau)])e^{-\\beta ( w-\\delta f)}\\rangle_{\\lambda_a } .",
    "\\label{tmp1}\\end{aligned}\\ ] ] since the objective is to get the potential of mean force , the appearance of @xmath50 seems to be a complication .",
    "however , the left hand side of eq .",
    "does not correspond to the potential of mean force in eq .",
    ", since the @xmath80 and @xmath75 ensembles are different . instead , from eq .",
    ", one easily shows that @xmath81)\\rangle_{\\lambda_b } = \\frac{z_0}{z_b}e^{-\\beta\\phi(\\chi,\\lambda_b ) } \\langle\\delta(\\chi-\\tilde\\chi[x])\\rangle_0 , $ ] and since @xmath82 , eq .   becomes @xmath83)e^{-\\beta[w-\\phi(\\chi,\\lambda_b)]}\\right\\rangle_{\\lambda_a } , \\end{aligned}\\ ] ] which is the path - integral analog of the result of paramore et al.@xcite .",
    "note that @xmath84 is a constant , which does not matter for the potential of mean force , so that @xmath71 can be determined from a non - equilibrium process in a similar way as the free energy @xmath50 .",
    "the invariance of the volume element @xmath85 under hamiltonian dynamics is essential to derive the jarzynski equality in , the crooks fluctuation relation in and its extension to constrained ensembles .",
    "however , strictly speaking the phase space volume element is infinite here .",
    "the infinite volume of the phase space volume element is reminiscent of ultraviolet divergences in classical field theories that arise from an infinite dimensional phase space .",
    "for instance , the average kinetic energy of a classical elastic string is equal to the number of degrees of freedom times @xmath86 , but since the number of degrees of freedom of the string is infinite , the average kinetic energy diverges .",
    "the ultraviolet divergences present difficulties in the direct application of the results of schll - paschinger and dellago@xcite to the elastic string , because in the definition of the work , both @xmath87 $ ] and @xmath88 $ ] are divergent quantities , so @xmath48 might not be well defined .",
    "other complications would arise for dynamics with phase space contraction , which are not considered here .    to assess whether the fluctuation relations derived in the previous section are meaningful for a system with an infinite number of degrees of freedom , the divergences need to be regularized such that a finite number @xmath89 of degrees of freedom results .",
    "there are two general approaches to regularizing the path integral : the first is a _ fourier regularization _ , in which a wave vector cut - off in fourier space is introduced , while the other is a _ bead regularization _ , which consists of discretizing the points of the elastic string by replacing the continuous imaginary time @xmath16 by a finely spaced lattice of imaginary time points . in order to establish a proper theory , the regularized quantities such as the free energy and the distribution of fictitious work must converge to a finite limit as the @xmath90 , corresponding to the imaginary time lattice spacing going to zero or the cut - off to infinity , respectively .",
    "such regularization is also required to obtain feasible computational methods , and for these the _ nature _ of the convergence ( of the free energy , the work distribution etc . ) to a finite result is important for the efficiency of the method .    while taking a finite value for @xmath89",
    "solves the infinite phase space volume problem for the partition function using either of the two regularization procedures , it is a separate question whether the distribution of work values is well defined in the limit @xmath90 .",
    "the work distribution is used in the jarzynski and crooks relations , and is central to the non - equilibrium methods . for any finite @xmath89 , this distribution will be well defined and yield information on the finite-@xmath89 free energy difference @xmath91 . while @xmath92 is equal to the true quantum free energy difference @xmath50 , it must be noted that there is currently no general method to show that @xmath93 is well behaved as @xmath90 . in sec .",
    "[ numerical - quartic ] , it is demonstrated numerically that the work distribution converges for an asymmetric double - well potential . in the companion paper@xcite",
    ", the convergence of the work distribution will be shown analytically for the specific case of a particle in a harmonic well of changing strength , which can be solved exactly .",
    "the central idea of the fourier space regularization approach is to restrict the number of fourier components @xmath94 and @xmath95 of the continuous fields @xmath96 and @xmath97 to be finite , where    @xmath98    and @xmath99 note that because @xmath14 and @xmath57 are periodic with period @xmath100 , @xmath101 only takes integer values .",
    "furthermore , since @xmath14 and @xmath57 are real fields , their fourier modes satisfy @xmath102 and @xmath103 . in the fourier representation ,",
    "the hamiltonian becomes @xmath104 where @xmath105 and @xmath106 are the collections of all @xmath94 and @xmath107 , respectively , and the dispersion relation is @xmath108 and @xmath109 note that for @xmath110 modes @xmath101 and @xmath111 are degenerate .",
    "given the taylor series for the potential , @xmath112 , from eq .",
    "one gets @xmath113    because of the periodic boundary conditions imposed on the fields @xmath96 and @xmath97 , the infinite volume in phase space is now countable",
    ". we can thus regularize the theory by imposing a cut - off @xmath114 on the values of @xmath101 . with a finite cut - off , the application of liouville s theorem to derive eqs .   and",
    "poses no problem since the hamiltonian flow involving @xmath115 degrees of freedom preserves phase - space volume for any finite @xmath89 , and hence also in the limit @xmath90 .",
    "note that the limit @xmath116 corresponds to the classical limit , as can be seen by taking only the @xmath117 term in eq .  .",
    "using this fourier space regularization , the free energy converges in the limit @xmath90 as @xmath118 when used in the above straightforward form@xcite .",
    "using so - called partial averaging techniques@xcite , this can be turned into a @xmath119 convergence@xcite . however , the next regularization approach , based on replacing the string by a set of beads connected by springs , is a much simpler and more general way to get an @xmath119 convergence ( or higher ) .",
    "in contrast with the fourier regularization , in the bead regularization procedure , the closed path @xmath96 is represented by a lattice of @xmath89 points .",
    "the points @xmath120 of the lattice are called beads , and their positions and momenta are denoted by @xmath121 and @xmath122 , respectively . using these variables , the partition function @xmath123 in eq .",
    "can be approximated by@xcite @xmath124 where @xmath125 \\label{discreteh}\\ ] ] and @xmath126 , i.e. , the @xmath127 form a `` ring polymer . '' in eqs .   and , @xmath128 is the mass associated with each bead . to ensure that the ring polymer approaches the elastic string limit as @xmath90 ,",
    "the mass of each of the @xmath89 beads has to be @xmath129 , but for numerical applications at finite @xmath89 , @xmath128 is a free parameter .",
    "this regularization scheme is the basis of the frequently used path integral molecular dynamics ( pimd ) method@xcite for computing canonical equilibrium averages for quantum systems .    to derive the bead regularization of the partition function in eq .   and the fictitious hamiltonian in eq .",
    ", one usually starts from the trotter formula for the boltzmann operator , i.e.@xcite @xmath130 however , it is hard to see from eq .   why the convergence of the free energy for large @xmath89 would behave @xmath119 , as mentioned above .",
    "the convergence properties are easier to determine starting from the symmetric version @xmath131 which follows from the baker - campbell - hausdorff formula@xcite .",
    "equation allows the boltzmann operator to be expressed as @xmath132^m + { \\mathcal{o}(m^{-2})}.   \\label{verlettotal}\\ ] ] when taking the trace of the boltzmann operator to obtain the partition sum in eq .  , the first term on the right - hand side of eq .",
    "can be rewritten using the cyclic properties of the trace in the form of the trotter formula .",
    "thus , for the partition sum , the two so - called splitting methods and lead to the same result . since the latter converges as @xmath119 , so does the former . note that if the trace is not taken , such as for the imaginary time propagator or for expectation values of operators which do not commute with @xmath3 , the two splitting methods exhibit different convergence behavior@xcite .",
    "in particular , the convergence behavior of the trotter form then becomes @xmath118@xcite .",
    "taking the trace to get the partition sum , and the standard technique of inserting closure relations@xcite , one finds @xmath133}. \\label{almost } \\ ] ] finally , multiplying the right - hand side of eq .   with",
    "@xmath134 one obtains eqs .   and , and one sees that @xmath135 converges to @xmath123 as @xmath119 .    the bead regularization in eq .",
    "is not as different from the string s fourier representation in eq .   as it may appear at first sight , as becomes clear when eq .",
    "is written in the fourier representation as well . since the beads are discrete , the fourier transform is also discrete and takes the form    @xmath136    where @xmath101 runs from @xmath54 to @xmath137 . because @xmath138 , one can also choose the range of @xmath101 to be from @xmath139 to @xmath140 , and this is more convenient since a natural cut - off @xmath141 then arises .",
    "the asymmetry between the position and the momentum transformation in eqs .   and is necessary to have the fourier transformation preserve the canonical structure , while at the same time letting the definition of @xmath94 in eqs .   and coincide for @xmath90 . applying this transformation to the fictitious hamiltonian in eq .",
    "gives @xmath142 where the only real difference with the fictitious elastic string hamiltonian ( with a wave vector cut - off @xmath114 ) lies in the dispersion relation @xmath143 instead of eq .  .",
    "note that for @xmath144 , @xmath101 and @xmath111 are again degenerate , with the exception that for even @xmath89 , the mode @xmath145 is identical to the mode @xmath146 and only one of these should be included .",
    "naturally , in the limit @xmath147 , eq .   reduces to eq .   for fixed  @xmath101 .",
    "the potential term @xmath148 in eq .",
    "is given by the same expression as for the elastic string , with all sums over wave vectors cut - off at @xmath114 .",
    "therefore , both for the fourier and the bead regularization , the equations of motion in terms of @xmath149 and @xmath150 take the form    @xmath151    where @xmath152 for the fourier regularization and @xmath153 for the bead regularization .",
    "as an illustration of calculations of free energy differences in non - trivial quantum systems , consider the difference in free energy between a quantum particle confined in a symmetric quartic double - well potential @xmath154 and a quartic potential with a linear bias @xmath155 ( see fig .",
    "[ potentials ] )    @xmath156    the free energy difference for a quantum particle confined by the potentials @xmath157 and @xmath158 will be computed from the crooks fluctuation relation using the time - dependent potential @xmath159 , where we assume @xmath160 and @xmath44 defines the rate at which the potential is switched .",
    "note that @xmath161 and @xmath162 .",
    "the bead regularization will be used because of its better convergence properties compared to the fourier regularization .",
    "for application of the non - equilibrium relations , the procedure consists of drawing @xmath163 initial values of the bead positions @xmath164 and conjugate momenta @xmath165 from the canonical probability density @xmath166 and propagating each phase point @xmath167 ( @xmath168 ) forward to time @xmath44 under the influence of the time - dependent potential @xmath169 .    .",
    "note that the @xmath6 values given correspond to @xmath170 and @xmath171 . ]",
    "the sampling of initial conditions for the dynamics was done using a monte carlo procedure . for systems that have weak quantum character , i.e. , with large @xmath172",
    ", the harmonic part @xmath173 of @xmath174 arising from the kinetic energy operator of the quantum particle , forces the bead positions @xmath127 to be near one another .",
    "this strong harmonic potential @xmath175 makes monte - carlo sampling of the canonical distribution inefficient if the sampling is based only on trial moves generated by uniformly chosen random displacements of the bead positions @xmath127 . for this reason ,",
    "it is helpful to use importance sampling based on the probability density for a free particle .",
    "the procedure consists of dividing the trial configurations generated in the monte - carlo sampling into two types .",
    "the first type consists of randomly displacing the centroid or center - of - mass of the ring polymer .",
    "since the potential @xmath176 is constant for this type of displacement , only the potential @xmath177 determines the acceptance probability of this type of move .",
    "the second way of generating trial configurations consists of drawing independent , non - zero fourier modes @xmath178 with @xmath179 to @xmath180 based on the probability density    @xmath181    where @xmath182 and @xmath183 and @xmath184 are the real and imaginary parts of @xmath94 , respectively .",
    "note that if @xmath89 is even , then @xmath185 and @xmath186 is drawn from @xmath187    with @xmath188 .",
    "the fourier modes @xmath189 are then inverted to form the positions of the beads @xmath190 for the trial configuration , which is then accepted with probability @xmath191 , where @xmath192 is the difference in the potential between the trial and original positions ( i.e. with no harmonic contribution @xmath176 ) .",
    "since this procedure generates trial configurations with the same centroid as the original configuration , @xmath192 is typically small and most trial configurations are accepted if quantum effects are not too large .",
    "once a statistically independent configuration of the ring polymer has been obtained , conjugate momenta @xmath193 may be drawn from a maxwell - boltzmann density to obtain an initial phase point for the system [ cf .",
    "although the numerical time propagation of the system can be carried out in a multitude of ways , symplectic integration methods usually offer superior stability and accuracy .",
    "the general hamiltonian is time - dependent and the dynamics is more complicated than that of autonomous systems .",
    "nonetheless , it can be shown that phase space volume still satisfies liouville s theorem under the dynamical flow and that integration schemes of second and higher order can be derived for the time - dependent potentials in the same manner as for autonomous systems , as long as the time is updated only after the momentum - propagation step@xcite . for our test system , we used a second - order verlet - like integration scheme that satisfies this requirement , where first the momenta are propagated for a half - step @xmath194 using initial forces , then an update of the positions and the system time is done using the current momenta by a full step @xmath195 .",
    "the time - dependent force is then computed at this system time using the updated positions , and finally a final momentum update of a half - step @xmath194 is carried out .",
    "it is readily established that a trajectory using this scheme is exact for a hamiltonian that differs from @xmath174 by terms of order @xmath196 at all times .",
    "after each phase point has been propagated to time @xmath44 , the non - equilibrium work @xmath197 is computed . from a set of @xmath198 initial conditions and work values , the free energy difference for the quantum system can then be computed using the jarzynski estimator @xmath199 statistical uncertainties for this estimator may computed using jackknife@xcite or bootstrap@xcite methods on the sample .    as is clear from eq .  , the free energy difference computed from the exponential average of the work is sensitive to large fluctuations in the value of the work @xmath200 and may converge slowly if there are large tails in the work distribution@xcite .",
    "the crooks fluctuation relation , on the other hand , is based on finding the value of the work @xmath68 at which the probability density of the work @xmath201 is equal to the probability density @xmath202 of the negative of the work in the reverse process in which initial conditions are drawn from a canonical distribution based on the potential @xmath203 . according to the crooks relation in eq .  , the free energy difference is then given by @xmath204 .",
    "calculations of the free energy difference based on the crooks fluctuation relation therefore require constructing the probability densities of the work in the forward and reverse directions .",
    "the traditional approach of approximating such densities is to use histograms . while the use of histograms is parameter free for systems in which the variable is confined to discrete values , the more typical situation concerns probability densities of continuous variables , which requires the specification of a bin size for representing the density .",
    "thus , in contrast to the calculation of the free energy difference using the jarzynski fluctuation relation , the use of a histogram approach to approximating probability densities leads to an undesirable parameter dependence to the free energy differences computed in the crooks fluctuation approach .",
    "in fact it is possible to reconstruct probability densities of continuous variables without resorting to parameter - dependent histogram methods@xcite .",
    "the idea is to expand the empirical cumulative distribution function ( ecdf ) obtained after sorting the data in a series of complete orthogonal polynomials . from the mathematical properties of the cumulative distribution function",
    ", the number of terms required in the expansion of the ecdf can be determined without user intervention by application of the kolmogorov or kuiper s test@xcite . from this expansion , an analytical form for the probability density",
    "can be obtained by differentiation .",
    "this approach can be applied to the probability densities of the work for both the forward and reverse processes .",
    "the free energy is then obtained numerically by finding the value of the work where the analytical probability densities are equal .    in principle , any orthogonal set of polynomials can be utilized for the expansion of the ecdf . in ref .",
    "( ) , a fourier series for the difference between the ecdf and a linear function was used to construct an analytical approximation to the ecdf .",
    "although such an approach successfully produces a fairly smooth approximation of the ecdf , the use of oscillatory transcendental functions introduces high frequency oscillations in the smooth approximation that may lead to systematic errors when finding points of overlap of densities , particularly when the densities intersect in regions where there are prolonged tails . as an alternative",
    ", we consider using a high - order polynomial expansion via the chebyshev polynomials .    to illustrate the method , consider a series of @xmath198 _ sorted _ work values @xmath205 where @xmath206 .",
    "an unbiased estimator of the distribution function of the work @xmath207 is the ecdf defined in the range @xmath208 $ ] as @xmath209 to allow an expansion in chebyshev polynomials which are defined on the interval @xmath210 $ ] , the ecdf is mapped to that domain using @xmath211 the new ecdf @xmath212 can then be expanded in terms of chebyshev polynomials of the first kind @xmath213 to yield the approximation @xmath214 where the coefficients @xmath215 are given by @xmath216 the analytical approximation to the probability density @xmath217 in terms of @xmath218 chebyshev polynomials is then given by @xmath219 where @xmath220 are chebyshev polynomials of the second kind@xcite .",
    "the expansion coefficients @xmath215 can be evaluated analytically using the form of the ecdf in , and are given by @xmath221 in practice , one hopes that the number of polynomials @xmath218 required in the expansion of the ecdf is modest so that a smooth approximation is obtained .",
    "what number of polynomials is appropriate can be estimated using either the kolmogorov@xcite or kuiper s test@xcite , which determine how likely it is that the difference between the ecdf @xmath222 and its analytical approximation @xmath223 is due to random variations .",
    "the tests take the maximum variation between @xmath224 and @xmath225 over the sampled points and return a probability @xmath226 that the difference between the two cumulative distribution functions is due to chance .",
    "a small value of @xmath226 indicates that the difference between the cumulative distribution functions is significant , so that the quality of the expansion @xmath225 is insufficient to represent the data .",
    "one therefore carries out a process of progressively increasing the number of polynomials @xmath218 and evaluating @xmath225 as well as @xmath226 until the value of @xmath226 is larger than some threshold , say @xmath227 .",
    "once analytical approximations to the probability densities of the work in the forward and reverse directions have been obtained , the intersection point @xmath68 is readily evaluated by numerically searching for a solution of @xmath228 using the brent method@xcite .",
    "the brent method requires that the solution be bracketed on an interval @xmath229 .",
    "since the free energy difference between ensembles are single - valued , there is only one point of intersection of the probability densities in the forward and reverse directions .",
    "the interval end - points @xmath230 and @xmath231 can therefore be taken to be near the extremal values of the @xmath200 values found in the simulations .",
    "finally , statistical uncertainties can also be computed for the free energy difference by repeating the calculation of the intersection point for a series of jackknifed samples of the data and using the variance of the free energy differences over the jackknife samples .    ) .",
    "the solid line is drawn as a guide to the eyes , while the dotted line in the inset is a fit to @xmath232 , as predicted by the theory , which agrees within errorbars . ]      to illustrate this approach , numerical tests were carried out to calculate the quantum free energy difference between systems with @xmath233 ( symmetric quartic double - well potential ) and @xmath234 ( biased quartic potential ) with parameters @xmath235 , @xmath236 , @xmath237 and @xmath238 , while the mass @xmath128 per bead was also set to @xmath100 .",
    "the time step for the propagation was @xmath239 such that the fluctuations in the total energy at constant @xmath233 relative to the fluctuations in potential energy were less than @xmath240 .",
    "the calculations were carried out at two different switching rates , @xmath241 ( fast switching ) and @xmath242 ( slow switching ) .    in fig .",
    "[ freeeresult ] , the free energy difference @xmath243 calculated using the crooks fluctuation relation for fast - switching process is shown as a function of the number of beads @xmath89 in the ring polymer regularization of the path integral . the work value @xmath68 at which @xmath244 was based on the analytical approximation of the empirical cumulative distribution functions formed out of @xmath245 independent realizations of the non - equilibrium process in the forward and reverse directions .",
    "the inset graph in this figure clearly suggests that @xmath243 converges as @xmath246 , to a final value of @xmath247 .",
    "this value agrees with the quantum free energy difference found by evaluating the partition sum using the numerically determined eigenvalues of the hamiltonians @xmath248 and @xmath249 .",
    "the free energy difference is not just due to the difference in zero - point energy , which is @xmath250 , but to the higher energy levels as well .",
    "note also that the quantum contributions to the free energy difference lead to a quantum free energy difference that is roughly @xmath251 higher than the classical value of @xmath252 .    in fig .",
    "[ kappa12result ] , the first and second cumulants of the work done ( i.e. , the average and the variance of the work ) in the fast reverse process are plotted against @xmath89 .",
    "as the fits in the figures show , the asymptotic convergence of both cumulants is consistent with a @xmath119 behavior .",
    "the results presented in this figure suggest , in general , that the work distributions converge in the infinite @xmath89 limit as @xmath119 , which can be rationalized from the consideration of a harmonic oscillator system ( see the companion paper@xcite ) .    ) .",
    "the solid lines are a fit to @xmath232 . ]",
    "the probability densities of the work and negative work in the forward and reverse directions are shown in fig .",
    "[ crooksresults ] as histograms and expanded analytical forms .",
    "the convergence properties of the analytical expansions of the empirical cumulative distribution function were determined by the asymptotic kuiper s test with a threshold value @xmath253 of @xmath254 . typically , @xmath255 terms were required to reach convergence with this choice of @xmath253 .",
    "the probability densities shown in fig .",
    "[ crooksresults ] were estimated from @xmath256 values of the work and negative work for the non - equilibrium switching process .",
    "the data shown are for a @xmath257 bead discretization of the path integral .",
    "note that even though the shape of the probability densities is sensitive to the switching rate , the intersection point of the forward and reverse densities is independent of the rate and equal to the free energy difference .",
    "it is apparent from the detail of the work densities near their point of intersection shown in the inset of the panels that it is difficult to arrive at an estimate of the free energy difference based on noisy histograms of the work .",
    "in contrast , the analytical forms of the probability densities lead to smooth curves and unambiguous points of intersection .",
    "non - equilibrium methods for the calculation of free energy differences in quantum systems in the context of the path integral representation of the canonical partition function have been presented . instead of using the real quantum dynamics of the system , the path integral representation",
    "allows a fictitious path to be defined for which the jarzynski and crooks relations are valid . by evolving the ring polymer in the path integral representation under fictitious dynamics ,",
    "the difficulties associated with the complexity of the full evolution of a quantum system are avoided . from a computational perspective , avoiding true quantum dynamics is a great advantage , although the actual efficiency as compared to other methods to compute free energy differences will depend greatly on implementation details and on using additional techniques such as importance sampling",
    ".     realizations of the non - equilibrium process for the quartic system , using @xmath258 .",
    "the top panel corresponds to results for the fast - switching process with @xmath241 while the lower panel contains the results for a slow - switching process with @xmath259 .",
    "noisy curves correspond to the histogram form and the smooth curves to the analytical expanded form of the work distributions .",
    "the insets show the detail in the vicinity of the crossing point . ]    from a formal point of view , the path integral approach exploits the well - known isomorphism between a quantum system and a classical system of higher dimensionality described by a field theory .",
    "while the dynamical evolution of the classical field is well - defined , the isomorphic classical system exhibits the typical divergent behavior of classical field theories on short length scales , due to the infinite number of degrees of freedom .",
    "it was demonstrated that the equations of motion and field variables can be regularized using either a wave - vector cut - off of the fourier modes of the fields @xmath96 and @xmath97 , or a real space discretization of the ring polymer representing the quantum particle , yielding a finite number @xmath89 of degrees of freedom .",
    "a general numerical procedure for calculating the free energy difference between non - trivial quantum systems was elaborated using a particle confined in a quartic potential as a test model .",
    "general issues pertaining to sampling the initial phase points , performing the dynamics of non - autonomous systems , and estimating free energy differences using the exponential average of the work ( jarzynski method ) and the crossing method ( crooks approach ) were discussed . a parameter - free method for calculating the free energy difference using the crossing of the forward and reverse work distributions was introduced .",
    "the parameter - free method is based on expanding the empirical cumulative distribution function in orthogonal chebyshev polynomials and is controlled by a rigorous statistical convergence test . from these expansions , analytical functions of the estimated forward and reverse work distributions",
    "are then obtained from which precise values of the crossing point and hence the free energy can be extracted .",
    "the expansion procedure utilized here is quite general , and can be used to construct analytical estimates of any probability density of a single continuous variable",
    ". the approach should be particularly useful whenever the specific value of a probability density if desired , such as in the calculation of the value of the radial distribution function at contact in a system of hard spheres .",
    "the method could also be of use in construction of the free energy as a function of a reaction coordinate or other parameter , where the dispensing of parameter - dependent histograms is desired .",
    "the numerical results indicated that for the quartic potential the work distribution converges as the regularization parameter @xmath89 gets large , and hence so does the free energy estimate obtained from the crossing method . although the general convergence of the free energy and work distribution utilized in the crossing method must be demonstrated on a case - by - case basis , the following paper shows that for the harmonic oscillator the work distribution and free energy converges rigorously but that the nature of the convergence depends on the regularization used@xcite .",
    "in particular , it is shown that the bead regularization converges faster than the fourier regularization .",
    "while the focus here has been on deterministic methods with hamiltonian dynamics in non - equilibrium statistical mechanics , it is worth mentioning that an alternative to the use of hamiltonian dynamics is to evaluate the path integral via the path integral monte carlo ( pimc ) method .",
    "both the jarzynski and crooks relations hold in this context provided that the process is markovian and time reversible@xcite . furthermore ,",
    "for a given regularization at finite @xmath89 , one can in principle also use thermostatted deterministic dynamics , for which the jarzynski and crooks relations also hold@xcite .",
    "the convergence properties of these alternative non - equilibrium processes as @xmath90 will be assessed in future work .",
    "finally , it should also be noted that the dynamics generated both through deterministic and stochastic evolution is completely artificial and generally has little to do with the real time quantum dynamics of the system ( except when @xmath260 ) .",
    "still , the computation of the free energy difference through the dynamical non - equilibrium procedure described above yields exact quantum results in the limit @xmath90 .",
    "moreover , the use of either deterministic or stochastic evolution bypasses the problem of computing the real time quantum dynamics and illustrates the power of path integral methods in practical applications .",
    "r.  van zon , l.  hernndez de la pea , g.  h. peslherbe and j.  schofield , quantum free energy differences from non - equilibrium path integral methods : ii .",
    "convergence properties for the harmonic oscillator , arxiv:0807.0409v2 [ cond-mat.stat-mech ] ."
  ],
  "abstract_text": [
    "<S> in this paper , the imaginary - time path integral representation of the canonical partition function of a quantum system and non - equilibrium work fluctuation relations are combined to yield methods for computing free energy differences in quantum systems using non - equilibrium processes . the path integral representation is isomorphic to the configurational partition function of a classical field theory , to which a natural but fictitious hamiltonian dynamics is associated . </S>",
    "<S> it is shown that if this system is prepared in an equilibrium state , after which a control parameter in the fictitious hamiltonian is changed in a finite time , then formally the jarzynski non - equilibrium work relation and the crooks fluctuation relation are shown to hold , where work is defined as the change in the energy as given by the fictitious hamiltonian . since the energy diverges for the classical field theory in canonical equilibrium , two regularization methods are introduced which limit the number of degrees of freedom to be finite . the numerical applicability of the methods is demonstrated for a quartic double - well potential with varying asymmetry . a general parameter - free smoothing procedure for the work distribution functions is useful in this context . </S>"
  ]
}