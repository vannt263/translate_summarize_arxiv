{
  "article_text": [
    "[ [ section ] ]    estimating a probability density function ( _ pdf _ ) is an important and well studied field of research in statistics .",
    "the most basic problem in this area is that of univariate _ pdf _ estimation from _ iid _ samples , henceforth referred to as unconditional density estimation .",
    "another problem of utmost importance is conditional density estimation .",
    "here one needs to characterize the behavior of the response variable for each of the different values of the predictors .",
    "a natural extension of the these problems is that of estimating the joint _ pdf _ for multiple random variables .    given the importance of _ pdf _ estimation in statistics and related disciplines , a large number of solutions have been proposed for each of these problems . while the earliest works focused on parametric solutions , the trend over the last three decades is to use a nonparametric approach as it minimizes making assumptions about the underlying density ( and the relationships between variables for conditional and joint densities ) .",
    "the most common nonparametric techniques are kernel based ; refer to @xcite for a narrative of works .",
    "related to these approaches are `` tilting '' or `` data sharpening '' techniques for unconditional density estimation , for example @xcite and the references therein .",
    "kernel methods are very powerful in univariate setting . however , as the number of variables involved gets higher , the methods become computationally inefficient because of the complexities involved in bandwidth selection , especially in conditional density estimation setup .",
    "another common approach @xcite for _ pdf _ estimation is a two step estimation procedure , where one first estimates an initial _ pdf _ , say @xmath0 , from the data , perhaps restricting to a parametric family .",
    "then , one _ improves _ upon this estimate by considering a function @xmath1 depending on the initial estimate @xmath0 and an unknown function @xmath2 , to reach a final estimate of the type @xmath3 . in a classical paradigm",
    "one can choose @xmath4 as @xmath5 where @xmath6 is a positive function .",
    "in a bayesian context , the function @xmath7 is assigned a gaussian process prior @xmath2 with mean @xmath0 .",
    "often the calculation of the normalization constant makes the computation very cumbersome . on the other hand , two step procedures for conditional density estimation",
    "are based on estimating the conditional mean function , and then the conditional density of the residuals @xcite . over the recent years , bayesian methods for estimating _ pdfs _ based on mixture models and latent variables",
    "have received a lot of attention because of their excellent practical performances and an increasingly rich set of algorithmic tools for posterior computation using markov chain monte carlo ( mcmc ) methods .",
    "references include @xcite among others .",
    "however these results also come at a very high computational cost associated with implementing the mcmc algorithms .",
    "applications of flexible bayesian models for conditional densities are discussed in @xcite , among others .",
    "although the literature suggests that such methods based on mixture models have several attractive properties , they lack interpretability and the mcmc solutions for model fitting are overly complicated and expensive .    in this article a geometrically intuitive framework for a two step approach",
    "is proposed that is applicable to both conditional and unconditional density estimation .",
    "the motivation here is to avoid the computational cost associated with traditional techniques , while not losing out on practical performance .",
    "assume that we have a strictly positive univariate density @xmath8 on the interval @xmath9 $ ] ; @xmath0 serves as an initial estimate as in the traditional two step methods .",
    "let @xmath10 be the set of all positive diffeomorphisms from @xmath9 $ ] to itself : @xmath11 the elements of @xmath10 play the role of warping functions , or transformations of @xmath0 . given a @xmath12 , the transformation of @xmath8 is defined by : @xmath13",
    "henceforth this transformation is referred to as _ warping _ and the resulting _ pdf _ @xmath14 as a _ warped density_. this",
    "mapping is comprehensive in the sense that it forms a transitive group action on the space of all strictly positive _ pdfs _ on @xmath9 $ ] .",
    "this allows one to go from any positive _ pdf _ to any other positive _ pdf _ using an appropriate @xmath15 .",
    "note that since @xmath16 , there is no need to normalize this transformation .",
    "however , since @xmath10 is not a vector space , one has to map the elements of @xmath10 , using a nonlinear mapping , to a vector space to facilitate expansion using an orthogonal basis .",
    "the diffeomorphisms as transformations of a probability density shape have been used in the past , albeit with a different setup and scope @xcite .",
    "also , the notion of transformation between _ pdf_s has been used in the literature on _ optimal transport _ @xcite .",
    "the transport is achieved using an iterated composition of maps and is thus very different from estimating a diffeomorphism .    in this article",
    ", we develop the framework for estimating an unconditional , univariate _ pdf _ defined on @xmath9 $ ] .",
    "this simple setting helps explain and illustrate the main ingredients of the framework .",
    "besides , the proposed geometric framework is naturally univariate in the sense that the transformation defined in acts on univariate density shapes making it a logical starting point for developments . in this simple setup",
    ", the approach delivers excellent performance while avoiding heavy computational cost , and is comparable to standard kernel methods , even at very low sample sizes .",
    "the framework is extended to univariate densities with unknown support by scaling the observation domain to @xmath9 $ ] .",
    "a defining characteristic of this warping transformation is that it takes any initial density estimate to any final desired estimate , as long as they are both strictly positive .",
    "hence the initial estimate can be constructed in anyway  parametric ( e.g. gaussian ) or nonparametric ( e.g. kernel estimate ) , and",
    "is allowed to be a sub - optimal estimate of the true density .",
    "the second part of the article focuses on extending the framework to estimation of conditional density @xmath17 from @xmath18 .",
    "the approach is to start with a nonparametric mean regression model of the form @xmath19 , @xmath20 , where @xmath21 is estimated using a standard nonparametric estimator , to obtain an initial conditional density estimate @xmath22 at the location @xmath23 .",
    "then @xmath24 is warped using a warping function @xmath25 into a final conditional density estimate .",
    "importantly , the set @xmath10 and the warping transformation remain the same as the unconditional density estimation , and do not involve the predictors . only the choice of the element @xmath26 varies with the predictor @xmath23 .",
    "this makes the estimation process computationally efficient even in the presence of many predictors .",
    "the selection of @xmath25 is based on a weighted - likelihood objective function that borrows information from the neighborhood of the location @xmath23 at which the conditional density is evaluated . since the transformation operation does not involve the predictors ,",
    "the final estimate is naturally resistant to the effect of predictors that are irrelevant to the response .",
    "the rest of this paper is organized as follows .",
    "section 2 introduces the formal methodology and framework on a univariate unconditional density estimation setting .",
    "section 3 presents notations and the convergence rate of the density estimator . section 4 focuses on the practical implementation of the method and outlines the associated numerical techniques .",
    "illustrations of univariate density estimation on simulated datasets are presented in section 5 . in section 6 the theory for conditional density estimation",
    "is developed and the properties of the proposed method are illustrated using simulated datasets .",
    "the application of conditional density estimation using the proposed framework on a real dataset is also presented .",
    "section 7 includes a discussion on how the ideas presented in earlier sections can be used to perform bivariate unconditional density estimation , the challenges involved in higher dimensions , and a simple bivariate illustration .",
    "finally , the proofs of the convergence rate presented in section 3 is derived in an appendix .",
    "in this section we develop a two - step framework for estimating univariate , unconditional _ pdf _ , and start by introducing some notation .",
    "let @xmath27 be the set of all strictly positive , univariate probability density functions on @xmath9 $ ] .",
    "let @xmath28 denote the underlying true density and @xmath29 , @xmath30 be independent samples from @xmath31 .",
    "furthermore , let @xmath32 be a pre - determined subset of @xmath27 , such that an optimal element ( defined appropriately ) @xmath33 is relatively easy to compute .",
    "for instance , any parametric family with simple estimation procedure is a good candidate for @xmath8 .",
    "similarly , kernel density estimates are also good since they are computationally efficient and robust in univariate setups .    [",
    "cols=\"^,^\",options=\"header \" , ]     extension to higher dimensional case is not straightforward . in the case",
    "@xmath34 , @xmath35 the performance of @xmath36 deteriorates .",
    "this is because , the term @xmath37 defined in becomes an inaccurate measure of the sparsity around the point of interest @xmath38 due to the dependence structure among the predictors .",
    "to control the approximation error , @xcite introduces a family of discrepancies .",
    "they define @xmath39 , called the @xmath40-approximation error at @xmath41 . here",
    "@xmath41 is the true density which is assumed to be @xmath42-smooth .",
    "the control of the approximation error of @xmath43 at @xmath41 is necessary for obtaining results on the convergence rate for sieve mles .",
    "we follow @xcite to introduce a family of indexes of discrepency in order to formulate the condition on the approximation error of @xmath43 .",
    "let @xmath44 , -1<\\alpha<0 \\text { or } 0<\\alpha \\leq 1\\\\ \\log{x } , \\text {   if } \\alpha=0 + \\end{array } \\right.\\ ] ] set @xmath45 and define @xmath46 we define @xmath47 .",
    "we call a finite set @xmath48 a hellinger @xmath49-bracketing of @xmath43 if @xmath50 for @xmath51 , and for any @xmath52 , there is a @xmath53 such that @xmath54 .",
    "let @xmath55 be the hellinger metric entropy of @xmath43 , defined as the cardinality of the @xmath49-bracketing of @xmath43 of the smallest size .",
    "let @xmath0 be the initial estimate on which we use the group action of the space of diffeomorphisms to arrive at the final estimate . throughout , @xmath56 and @xmath57",
    "have been used to represent coefficient vectors in the tangent space of the hilbert sphere for some fixed basis set corresponding to warping function that act on @xmath0 .",
    "when @xmath56 denotes the coefficient vector corresponding to the true density denoted by @xmath58 and @xmath59 corresponds to the estimate @xmath60 , @xmath61 represents the @xmath62th onwards coordinates of @xmath56 .",
    "@xmath63 and @xmath64 are used to indicate specific constants .",
    "also , @xmath65 have been used to represent generic constants whose value can change from step to step but is independent of other terms in the expressions .",
    "let @xmath66 and @xmath67 be two _ pdfs _ on @xmath43 with corresponding cumulative distribution functions @xmath68 and @xmath69 .",
    "let @xmath0 be the initial density estimate on @xmath32 such that @xmath0 is strictly positive and lipschitz continuous with cumulative distribution function @xmath70 .",
    "let @xmath71 and @xmath72 .",
    "let @xmath73 and @xmath74 be the coefficients associated with the two elements of @xmath75 corresponding to the tangent space representation of @xmath76 and @xmath77 . here",
    "@xmath43 and @xmath78 are as introduced in section [ fnnotation ] . then the following lemma bounds the norm difference of @xmath66 and @xmath67 with the norm difference in the coefficients .",
    "let @xmath56 and @xmath59 be the coefficients associated with two elements of @xmath75 .",
    "then there exists @xmath81 such that @xmath82 , where @xmath83 is the @xmath84th basis function , @xmath85 .",
    "let @xmath86 @xmath87 then @xmath88 with @xmath89 and @xmath90 .",
    "hence we have @xmath91 @xmath92            noting that @xmath98 and [ eq : sinxbyx ] , @xmath99 now consider @xmath100 .",
    "observe that @xmath101 now @xmath102 is a bounded function . hence @xmath103 using equation [ gamdot ] .",
    "now we have @xmath104 , @xmath105,i=1,2 $ ] . then latexmath:[\\[\\begin{aligned }                the @xmath118-cover of a set @xmath119 wrt",
    "a metric @xmath40 is a set @xmath120 such that for each @xmath121 , there exists some @xmath122 with @xmath123 .",
    "the covering number @xmath124 is the cardinality of the smallest delta cover .",
    "then @xmath125 is the metric entropy for t. first we bound the metric entropy for @xmath43 .",
    "let us consider a fixed @xmath126 .",
    "we choose the hellinger metric so that we can borrow results directly from @xcite .",
    "we note that @xmath127 for some @xmath128 following the steps in section [ equivproof ] .",
    "so finding a @xmath118 covering for @xmath43 is equivalent to finding an @xmath129 covering for the space of coefficients in the tangent space using @xmath130 norm .",
    "let us have a closer look at the space of coefficients .",
    "we have @xmath131 for tangent space representation of @xmath10 , which is equivalent to @xmath132,say .",
    "therefore @xmath133,say . then @xmath134,say .",
    "now @xmath135 is a compact set with @xmath136 as a compact subset .",
    "so the @xmath118-cover for @xmath136 would be a proper subset of the @xmath118-cover for @xmath135 .",
    "therefore the covering number",
    "n for @xmath136 would be less than the covering number for @xmath135 . since @xmath137}^{k_n}\\}$ ] , we have the covering number for @xmath135 as @xmath138 .",
    "we obtain this by partitioning the interval@xmath139 $ ] into pieces of length @xmath129 for each coordinate so that the partition of @xmath135 is reached through cross product . then in each equivalent class of the partition of @xmath135 we will have @xmath140 which is equivalent to @xmath141 .",
    "so we have the metric entropy for @xmath142 , where @xmath143 and @xmath144 .",
    "let @xmath152 , be as in theorem [ thm:1 ] and @xmath148 be the smallest value of @xmath153 satisfying condition [ hellinger ] .",
    "@xmath43 be a sequence of approximating spaces , @xmath154 be the corresponding @xmath155-sieve mle .",
    "let @xmath156 be as defined in section [ familydisc ] .",
    "define , for any @xmath157 @xmath158 it follows from @xcite , that for any @xmath159 $ ] , if @xmath160 and @xmath161 , then @xmath162    consider @xmath163 in .",
    "let @xmath165 and @xmath70 be the cdfs corresponding to the true density and the initial parametric estimate respectively .",
    "then we have @xmath166 has the tangent space representation @xmath167 obtained via exponential map of @xmath168 satisfying @xmath169 .",
    "this forces @xmath170 to be always positive .",
    "now we look at @xmath171 , where @xmath154 is the final warped maximum likelihood estimate of @xmath41 .",
    "let @xmath56 be the coefficient vector corresponding to @xmath41 .",
    "let @xmath59 be the coefficient vector corresponding to @xmath154 .",
    "then @xmath56 is infinite dimensional and @xmath59 is just the first @xmath78 coordinates of @xmath56 , where @xmath78 is the dimension of the coefficient vectors corresponding to @xmath43 . we replace @xmath59 by its corresponding infinite dimensional vector , i.e the infinite dimensional vector with first @xmath78 coordinates @xmath59 and the rest coordinates all @xmath172 .",
    "then we have @xmath173 , where @xmath42 is the smoothness degree of @xmath41 .",
    "thus , assuming that @xmath78 is large enough , we have @xmath89 corresponding to @xmath154 .",
    "that implies @xmath174 , i.e. @xmath175\\ ] ] also @xmath176 is continuous in @xmath177 on a closed and bounded interval .",
    "so it attains its minima at some point @xmath178 such that @xmath179 for all @xmath180 $ ] .",
    "thus it follows that @xmath181 .",
    "then we have,@xmath182 .",
    "we have from equation [ satisfiesprop ] @xmath183 so for the smallest root we can solve the equation @xmath184 .",
    "let @xmath148 be of the form @xmath185 , and , let @xmath186,@xmath187 then @xmath188 therefore equating , @xmath189 with @xmath190 , we get @xmath191 , and @xmath192 .",
    "thus we have @xmath193 .",
    "we take @xmath194 to be @xmath195 where @xmath42 is the smoothness of the true density .",
    "therefore @xmath196 is the smallest value that satisfies the condition for theorem [ thm:1 ] .",
    "therefore , using the definition given in theorem [ thm:2 ] , and using @xmath163 , we get @xmath197"
  ],
  "abstract_text": [
    "<S> we introduce a geometric approach for estimating a probability density function ( _ pdf _ ) given its samples . </S>",
    "<S> the procedure involves obtaining an initial estimate of the _ pdf _ and then transforming it via a warping function to reach the final estimate . </S>",
    "<S> the initial estimate is intended to be computationally fast , albeit suboptimal , but its warping creates a larger , flexible class of density functions , resulting in substantially improved estimation . </S>",
    "<S> the warping is accomplished by mapping diffeomorphic functions to the tangent space of a hilbert sphere , a vector space whose elements can be expressed using an orthogonal basis . using a truncated basis expansion </S>",
    "<S> , we estimate the optimal warping and , thus , the optimal density estimate . </S>",
    "<S> this framework is introduced for univariate , unconditional _ pdf _ estimation and then extended to conditional _ pdf _ estimation . </S>",
    "<S> the approach avoids many of the computational pitfalls associated with current methods without losing on estimation performance . in presence of irrelevant predictors </S>",
    "<S> , the approach achieves both statistical and computational efficiency compared to classical approaches for conditional density estimation . </S>",
    "<S> we derive asymptotic convergence rates of the density estimator and demonstrate this approach using synthetic datasets , and a case study to understand association of a toxic metabolite on preterm birth .    </S>",
    "<S> keywords : conditional density ; density estimation ; hilbert sphere ; irrelevant predictors ; sieve estimation ; tangent space ; weighted likelihood maximization </S>"
  ]
}