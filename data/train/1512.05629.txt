{
  "article_text": [
    "originally introduced by @xcite , copulas @xcite play an important role in probability and statistics whenever the modeling of stochastic dependence is required @xcite .",
    "a copula is an @xmath0-variate cumulative distribution function ( cdf ) with standard uniform univariate marginal cdfs @xmath1)}$ ] , where @xmath2 , @xmath3 .",
    "hence , copulas form the frchet class @xmath4)},\\ldots , f_{\\mathcal{u}([0,1])})$ ] , where in this context , a frchet class generally refers to a class of multivariate distributions with fixed uni- or multivariate margins @xcite . as is manifested in the famous sklar s theorem @xcite , a copula links a multivariate cdf to its univariate marginal cdfs .",
    "the field of copulas has been developing rapidly over the last decades , and copulas have been applied to a wide range of problems in various areas such as climatology , meteorology and hydrology or risk management , insurance and mathematical finance .",
    "moreover , copulas are of theoretical interest , due to their appealing mathematical properties @xcite . however , @xcite has pointed out that they also reveal some shortcomings and that an uncritical use is problematic .",
    "hence , copulas can not be seen as a panacea for all problems connected to the modeling of stochastic dependence @xcite .",
    "a debate about the advantages and disadvantages of copulas can be found in the discussion related to mikosch s paper @xcite .",
    "+   + a special type of copulas are the so - called discrete copulas , whose properties have been studied by , and @xcite in the last decade .",
    "related work in the discrete copula setting can be found in @xcite , @xcite , @xcite and @xcite .",
    "the discussion in these references focuses on the bivariate case , and an explicit treatment of the general multivariate situation is not conducted , even though it is occasionally mentioned that a generalization of many results is possible @xcite .",
    "recently , have addressed the multivariate case by studying the empirical multilinear copula process based on count data .",
    "we also explicitly focus on the multivariate setting in this paper and generalize both the notion of discrete copulas employed by and and some of their results from the bivariate to the multivariate case .",
    "a new emphasis is put on the equivalence of multivariate discrete copulas and stochastic arrays @xcite .",
    "this is employed to prove an extension lemma , which in turn enables us to show a multivariate discrete version of sklar s theorem .",
    "our approach is clearly driven by the goal to develop a theoretical frame specifically tailored to several multivariate ensemble postprocessing methods that are employed in probabilistic weather forecasting .",
    "in particular , the ensemble copula coupling technique and the schaake shuffle , which are postprocessing methods essentially based on ordering notions , can be interpreted within this frame .",
    "hence , this paper bridges the gap between purely theoretical investigations on multivariate discrete copulas on the one hand and topical applications in probabilistic weather forecasting on the other hand .",
    "+   + the remainder of this paper , which is based on the findings of @xcite , is organized as follows . in section [ basics ] , we introduce the multivariate discrete copula concept .",
    "we then point out the equivalence of multivariate discrete copulas and stochastic arrays @xcite in section [ dcstar ] and continue with a multivariate discrete version of sklar s theorem in section [ mdcsklar ] .",
    "then , section [ applecc ] deals with the relationships of the presented results to multivariate statistical postprocessing methods for ensemble weather forecasts , with a focus on the approaches named above .",
    "finally , the paper closes with a discussion in section [ discussion ] .",
    "first , we extend the notions of bivariate discrete copulas and bivariate discrete subcopulas to the general multivariate case .",
    "let @xmath5 and @xmath6 , where @xmath7 , and let @xmath8 .",
    "[ mdc ] a function @xmath9 $ ] is a discrete copula on @xmath10 if it satisfies the following conditions ( d1 ) , ( d2 ) and ( d3 ) .",
    "* @xmath11 is grounded , in that @xmath12 if @xmath13 for at least one @xmath14 . *",
    "@xmath15 for all @xmath14 .",
    "* @xmath11 is @xmath0-increasing , in that @xmath16 for all @xmath17 , @xmath14 , where @xmath18    [ irrmdc ] a discrete copula @xmath19 $ ] is irreducible if it has minimal range , that is , @xmath20 .",
    "following @xcite and @xcite , a multivariate discrete copula can be interpreted as a multivariate distribution in the frchet class @xmath21 , where @xmath22 is the cdf of a uniformly distributed random variable on a set @xmath23 of cardinality @xmath24 .",
    "[ mdsubcop ] let @xmath25 .",
    "a function @xmath26 $ ] is a discrete subcopula if it satisfies the following conditions ( s1 ) , ( s2 ) and ( s3 ) .    *",
    "@xmath27 if @xmath13 for at least one @xmath14 .",
    "* @xmath28 for all @xmath29 .",
    "*   @xmath30 for all @xmath31 such that @xmath32 for @xmath14 , where @xmath33    [ irredsubcop ] a discrete subcopula @xmath26 $ ] is irreducible if @xmath34 .    the definition of discrete ( sub)copulas can be generalized .",
    "a discrete copula need not necessarily have domain @xmath35 , but can generally be defined on @xmath36 , where @xmath37 might take distinct values .",
    "then , the axioms ( d1 ) , ( d2 ) and ( d3 ) apply analogously to this case . similarly , discrete subcopulas can generally be defined on @xmath38 for possibly distinct numbers @xmath37 , satisfying the conditions in definition [ mdsubcop ] . for convenience and in view of the applications in section [ applecc ] , we confine ourselves to the case of @xmath39 as in the above definitions [ mdc ] to [ irredsubcop ] in what follows .",
    "+   + further tailored to the applications in section [ applecc ] , we defined the multivariate discrete copula on points that are equally spaced across the set @xmath10 .",
    "however , when considering a multivariate distribution with discrete margins , the points where the copula is of interest typically do not need to be equidistant across @xmath10 , but rather are heterogeneously spaced across the margins .",
    "such more general situations are studied in @xcite and , for instance .",
    "[ pim ] let @xmath40 .    1 .",
    "the function @xmath41 is a discrete copula .",
    "it represents the restriction of the so - called product or independence copula from @xmath42^{l}$ ] to @xmath35 .",
    "the function @xmath43 is an irreducible discrete copula .",
    "it represents the restriction of the so - called comonotonicity copula , which is the frchet - hoeffding upper bound and models perfect positive dependence , from @xmath42^{l}$ ] to @xmath35 .",
    "another example for an irreducible discrete copula is given by the so - called empirical copula @xcite , which has also become popular under the term `` empirical dependence function '' @xcite .",
    "the empirical copula is particularly relevant in view of the applications to be discussed in section [ applecc ] , for which it provides the theoretical background .",
    "+ let @xmath44 , where @xmath45 for @xmath46 and @xmath47 with @xmath48 for @xmath49 , @xmath50 .",
    "that is , we assume for simplicity that there are no ties among the respective samples .",
    "moreover , let @xmath51 be the marginal order statistics of the collections + @xmath52 , respectively .",
    "+ then , the empirical copula @xmath53 defined from @xmath54 is given by @xmath55 equivalently , @xmath56 where @xmath57 denotes the rank of @xmath58 in @xmath59 for @xmath46 and @xmath14 @xcite .",
    "+ obviously , the empirical copula is an irreducible discrete copula .",
    "conversely , any irreducible discrete copula is the empirical copula of some set @xmath54 , as will be discussed in example [ exequiv ] ( c ) in section [ dcstar ] . + asymptotic theory for the corresponding empirical processes is readily available .",
    "an explicit example for a discrete copula in the case of @xmath60 and @xmath61 is given by the function @xmath11 specified in table [ tab1 ] .",
    "the axioms ( d1 ) , ( d2 ) and ( d3 ) from definition [ mdc ] can be verified straightforwardly .",
    "+ @xmath62 + + . [ cols=\"^,^,^,^,^\",options=\"header \" , ]     we illustrate the second part of theorem [ sklarmdc ] for the case of @xmath60 and @xmath61 and give an example for obtaining a discrete copula associated to a finite three - dimensional cdf with given univariate marginal cdfs .",
    "let @xmath63 be a random variable that is uniformly distributed on the set @xmath64 .",
    "moreover , let @xmath65 and @xmath66 be the @xmath67- and @xmath68-valued random variables , respectively , defined by @xmath69 and @xmath70 the finite three - dimensional cdf @xmath71 for the random vector @xmath72 is then given by @xmath73 where @xmath74 , and @xmath75 has the marginal cdfs @xmath76 of @xmath63 with @xmath77 , @xmath78 of @xmath65 with @xmath79 and @xmath80 of @xmath66 with @xmath81 .",
    "+ we have @xmath82 , and our goal is now to get a discrete copula corresponding to @xmath75 and @xmath83 and @xmath84 .",
    "first , we define the discrete subcopula @xmath85 via @xmath86 where @xmath74 , are such that @xmath87 , @xmath88 and @xmath89 .",
    "the domain of this discrete subcopula is @xmath90 , where @xmath91 , @xmath92 and @xmath93 . due to lemma [ extension ] , we can extend the discrete subcopula @xmath85 defined on @xmath90 to a discrete copula @xmath11 defined on @xmath94 .",
    "however , the discrete extension copula @xmath11 is not uniquely determined , and there are in general multiple possibilities to complete the missing values of @xmath11 which are not covered by the values of @xmath85 . + a possible discrete extension copula @xmath11 for our scenario is shown in table [ tab1.exsklar ] , in which we give the explicit values @xmath95 .",
    "the values of @xmath11 which are uniquely determined by the corresponding values of the discrete subcopula @xmath85 are indicated by the bold font in table [ tab1.exsklar ] , whereas the other values are chosen in confirmity with the axioms for discrete copulas .",
    "now we relate the concepts and results from the previous sections to multivariate statistical postprocessing techniques for ensemble weather forecasts . particularly , we study connections to the ensemble copula coupling approach and the schaake shuffle and thus deepen the considerations in .",
    "+   + in state - of - the - art meteorological practice , weather forecasts are usually derived from ensemble prediction systems .",
    "an ensemble comprises multiple runs of numerical weather prediction models differing in the initial conditions and/or in details of the parameterized numerical representation of the atmosphere @xcite , thereby addressing the major sources of uncertainty . as",
    "ensemble forecasts typically reveal biases and dispersion errors , it is common that they get statistically postprocessed in order to remove these shortcomings .",
    "ensemble predictions and their postprocessing lead to probabilistic forecasts in form of predictive probability distributions over future weather quantities . in this context , a forecast distribution of good quality should be as sharp as possible , but on condition of being calibrated , that is , statistically compatible with the verifying observation .",
    "several ensemble postprocessing methods have been proposed , including bayesian model averaging ( bma ) and ensemble model output statistics ( emos ) as prominent examples .",
    "involved model parameters are typically estimated from a sliding training window consisting of past forecasts and observations .",
    "many of these approaches only apply to a single weather quantity at a single location and for a single prediction horizon . however , in various applications it is crucial to account for spatial , temporal and inter - variable dependence structures .",
    "+   + to address this , several multivariate ensemble postprocessing techniques have been developed .",
    "for instance , dependencies between locations can be handled by spatial variants of bma and emos , respectively .",
    "in contrast , the approaches in , @xcite and account for purely inter - variable dependencies , with the latter two applying specifically to wind vectors .",
    "these methods are parametric and can be interpreted in a gaussian copula framework .",
    "they are suitable in low - dimensional settings or if a specific structure can be exploited .",
    "we are often confronted with very high dimensions in weather forecasting .",
    "hence , alternative non - parametric approaches which rely on the use of empirical copulas and are able to address spatial , inter - variable and temporal dependencies simultaneously are of critical interest .",
    "examples for such methods are the ensemble copula coupling ( ecc ) approach and the schaake shuffle , which are reviewed and related to the previous results in this paper in what follows , with an emphasis on ecc .",
    "+   + the ecc method is based on the rank order information given by the unprocessed raw ensemble forecast .",
    "it applies to ensembles consisting members which are exchangeable , that is , statistically indistinguishable , and relies on the mostly plausible assumption that the ensemble is able to represent observed spatial , temporal and inter - variable dependencies appropriately . to describe ecc formally ,",
    "let @xmath96 be a weather variable , @xmath97 a location and @xmath98 a prediction horizon , summarized in the multi - index @xmath99 .",
    "we are given the univariate margins @xmath100 of an @xmath24-member unprocessed raw ensemble which comprises output in @xmath101 , where the dimension is @xmath102 .",
    "let @xmath103 , where @xmath46 , be the permutation of @xmath104 induced by the order statistics @xmath105 of the raw ensemble for each fixed margin @xmath106 , with any ties resolved at random .",
    "our goal is to come up with the postprocessed ecc ensemble @xmath107 of the same size @xmath24 as the raw ensemble . + to achieve this , we first apply a state - of - the - art univariate postprocessing method , such as bma or emos , to the raw ensemble @xmath108 and obtain a postprocessed predictive cdf @xmath109 for each variable , location and look - ahead time individually .",
    "then , each cdf @xmath110 is represented by a discrete sample @xmath111 of size @xmath24 .",
    "for instance , this can be conveniently done by taking the equally spaced @xmath112 + quantiles of @xmath109 .",
    "+ in the final ecc step , the sample @xmath113 is rearranged for each margin @xmath106 with respect to the ranks of the raw ensemble members .",
    "that is , the final postprocessed ecc ensemble @xmath107 is for each @xmath106 given by @xmath114 the last reordering step is essential , as it transfers the spatial , inter - variable and temporal rank dependence structure of the raw ensemble to the postprocessed ecc ensemble , thereby capturing the flow dependence .",
    "if we simply stopped the procedure at the sampling stage , we would obtain a postprocessed ensemble which does not conserve dependence patterns .",
    "such an ensemble will be referred to as an individually postprocessed ensemble in what follows .",
    "+ ecc performed well in several case studies . since",
    "its crucial reordering step is computationally non - expensive , one of the major advantages of ecc is that it practically comes for free , once the univariate postprocessing has been performed .",
    "however , bma and emos as univariate postprocessing methods are already implemented in the r packages ` ensemblebma ` and ` ensemblemos ` , respectively , which are freely available at http://cran.r-project.org @xcite .",
    "in addition , ecc offers a simple and intuitive , yet powerful technique that goes without complex modeling or sophisticated parameter fitting , thus providing a natural benchmark .",
    "it combines analytical , statistical and numerical modeling and is generally applicable to much broader settings apart from weather forecasting .",
    "+   + as indicated by its name , ecc has strong connections to copulas , particularly to the notions and results presented before . to deepen this ,",
    "let @xmath115 be discrete random variables taking values in @xmath52 , respectively , where @xmath108 for @xmath14 is the @xmath24-member raw ensemble forecast from above .",
    "for convenience , we assume that there are no ties among the corresponding raw ensemble margins . concerning the multivariate random vector @xmath116 , the respective univariate cdfs @xmath117 take values in @xmath118 , that is , @xmath119 . for the multivariate cdf @xmath120 of @xmath121 , we also have @xmath122 . according to the multivariate discrete version of sklar s theorem in theorem [ sklarmdc ] tailored to such a framework",
    ", there exists a uniquely determined irreducible discrete , and hence a uniquely determined empirical , copula @xmath123 such that @xmath124 for @xmath125 .",
    "that is , the multivariate distribution @xmath126 is connected to its univariate margins @xmath127 via @xmath128 .",
    "conversely , if we take @xmath128 to be the empirical copula induced by the raw ensemble forecast @xmath129 and @xmath127 to be the univariate cdfs of the raw ensemble margins , then @xmath126 as constructed in is a multivariate cdf . +   + following and generalizing the statistical interpretation of discrete copulas for the bivariate case in @xcite , @xmath130   \\times \\cdots \\times [ -\\infty , y_{l}]),\\ ] ] where @xmath125 such that @xmath131 that is , @xmath132 to describe the discrete probability distribution of the random vector @xmath121 , we set @xmath133 where @xmath134 for @xmath17 and @xmath14 denote the corresponding order statistics of the values @xmath115 attain",
    "then , @xmath135 for all @xmath136 .",
    "hence , @xmath137 for @xmath136 , @xmath138 is a permutation array of order @xmath24 , and @xmath139 in accordance with theorem [ equiv ] .",
    "+   + in our setting , the above considerations hold analogously for both an individually postprocessed ensemble @xmath140 as in and the ecc ensemble @xmath141 as in . in obvious notation ,",
    "let @xmath142 and @xmath143 be the respective multivariate empirical cdfs",
    ". moreover , let @xmath144 denote the marginal empirical cdfs of the individually postprocessed ensemble , with @xmath145 being the corresponding empirical copula .",
    "then , @xmath146 and @xmath147 for @xmath148 .",
    "+   + comparing equations , and , the individually postprocessed ensemble and the ecc ensemble have the same marginal distributions , whereas the raw ensemble and the ecc ensemble are associated with the same empirical copula modeling the dependence , due to the design of ecc aiming at retaining the rank dependence pattern from the raw ensemble",
    ". in particular , the ecc ensemble conserves the bivariate spearman rank correlation coefficients in the raw ensemble output .     +   + to illustrate the ecc approach and its relations to multivariate discrete copulas",
    ", we consider a real data example with forecasts provided by the @xmath149-member european centre for medium - range weather forecasts ( ecmwf ) ensemble @xcite .",
    "although our focus has been on the general multivariate case in this paper , we consider for illustrative purposes a bivariate setting , that is , @xmath150 , dealing with 24 hour ahead forecasts for temperature ( in degrees celsius ; @xmath151c ) at berlin and hamburg , valid 2:00 am on 27 june 2010 . in the left panel of the first row of figure [ ecc ] ,",
    "the unprocessed raw ensemble forecast according to is shown , where each red dot represents an ensemble member @xmath152 , and the verifying observation is indicated by the blue cross .",
    "the ensemble members reveal a pronounced positive correlation .",
    "the mid - plot in the first row shows an individually postprocessed ensemble as in , where the univariate postprocessing has been performed via bma here .",
    "while correcting for biases and dispersion errors , the individually site - by - site bma postprocessed ensemble essentially provides no correlation structure , in that the bivariate rank order characteristics of the unprocessed forecast from the left panel are lost .",
    "finally , the postprocessed ecc ensemble according to in the right panel of the first row corrects for biases and dispersion errors as the individually bma postprocessed ensemble does , but additionally conserves the rank dependence pattern given by the raw ensemble .",
    "thus , although the individually bma postprocessed and the ecc ensemble have the same marginal distributions , as indicated by the histograms , they differ drastically in their multivariate rank dependence structures . + in the second and third row of figure [ ecc ] , the perspective and stabilized contour plots , respectively , of the empirical copulas linked to the different ensembles in our illustrative example are shown . as discussed before , the raw and the ecc ensemble are associated with the same empirical copula @xmath153 . on the other hand , the individually bma postprocessed ensemble",
    "is linked to a distinct empirical copula @xmath154 , whose plots meaningfully resemble those of the independence copula @xmath155 from example [ pim ] ( a ) . according to the equivalences discussed in section [ dcstar ] , the raw and the ecc ensemble",
    "are also related to the same latin square of order @xmath149 , which is a latin hypercube @xcite in @xmath150 dimensions , whereas the individually bma postprocessed ensemble is not , as illustrated in the fourth row in figure [ ecc ] .",
    "+   + in a nutshell , ecc indeed can be considered a discrete copula approach .",
    "it comes up with a postprocessed , discrete @xmath0-dimensional distribution , which is according to equation constructed from univariate empirical cdfs @xmath156 and an empirical copula @xmath128 . while the marginal cdfs @xmath156 are defined by the samples drawn from the predictive cdfs @xmath157 obtained by univariate postprocessing , the empirical copula @xmath128 , which models the dependence structure , is induced by the unprocessed raw ensemble . +   + in close analogy to ecc and with very similar justifications , the schaake shuffle , which is an established concept in meteorology , can also be interpreted as a discrete copula approach . however , the main difference is that the corresponding empirical copula in the schaake shuffle method is defined based on historical verifying observations , rather than on a raw ensemble forecast as in the ecc approach .",
    "moreover , the size @xmath158 of the postprocessed schaake shuffle ensemble is in contrast to that of the ecc ensemble not restricted to equal the size @xmath24 of the raw ensemble .",
    "+ to describe the schaake shuffle formally , let @xmath159 denote a multi - index comprising a fixed weather variable @xmath96 at a fixed location @xmath97 , and let @xmath160 .",
    "suppose further that for each margin @xmath161 , we have a univariate postprocessed predictive cdf @xmath162 , which is represented by a discrete sample @xmath163 of size @xmath158",
    ". moreover , let @xmath164 denote a set of @xmath158 historical weather observations , where the same @xmath158 verification dates have to be taken for all margins @xmath165 .",
    "these past observations define an empirical copula @xmath166 .",
    "the multivariate empirical cdf @xmath143 of the postprocessed schaake shuffle ensemble is then given by analogy with equation by @xmath167 for @xmath168 , with the empirical marginal cdfs @xmath169 based on the samples @xmath163 for @xmath161 .",
    "that is , the empirical copula of the historical weather field record is applied to the discrete samples from the univariate postprocessed predictive cdfs .",
    "the thus reordered forecast in the schaake shuffle ensemble consequently inherits the multivariate rank dependence pattern as well as the pairwise spearman rank correlation coefficients from the underlying historical weather record , rather than from the raw ensemble as in the ecc approach .",
    "+   + in practice , both ecc and the schaake shuffle have performed well in case studies , and consequently , both are valuable tools for multivariate ensemble postprocessing that can be used as a benchmark",
    ". however , the standard ecc implementation as presented in this paper only applies to raw ensembles consisting of exchangeable members .",
    "moreover , the size of the postprocessed ecc ensemble is restricted to equal that of the raw ensemble .",
    "when employing ecc , the raw ensemble should thus be reasonably large to have reliable information about the dependence structure .",
    "in contrast , the schaake shuffle can principally create a postprocessed ensemble of arbitrary size , provided that there is a sufficiently large database of observations .",
    "however , its standard implementation fails to address atmospheric flow and time dependence , unlike ecc . + the development of modified variants of ecc and the schaake shuffle that are able to solve the shortcomings mentioned above is an issue of current research , where first attempts can be found in @xcite and @xcite .",
    "+ the question whether to prefer ecc or the schaake shuffle can not be definitely answered yet , as investigations on this are still in progress and not exhausted .",
    "a direct comparison of the predictive performances of the two methods has hitherto been conducted in a recent paper by @xcite only . in many of the settings considered in @xcite , but not in all",
    ", the schaake shuffle outperforms ecc .",
    "however , the case study in @xcite is based on a comparably small raw ensemble of size @xmath170 , and ecc would be expected to perform better and similarly well as the schaake shuffle if the raw ensemble was larger .",
    "a reimplementation of wilks initial case study @xcite using an unprocessed ensemble consisting of more members , such as the @xmath149-member ecmwf ensemble , together with a comparison to the ecc modificatins in @xcite , is therefore of great interest .",
    "in this paper , we have extended the notion of discrete copulas from the bivariate to the multivariate case . moreover , we have shown the equivalence of multivariate discrete copulas to stochastic arrays and have proven a multivariate discrete version of sklar s theorem .",
    "+   + the theoretical frame , in which the presented results have been developed , is driven by and tailored to the applications in meteorology considered in the last section . in particular , we focused on data with no ties , and multivariate discrete copulas have been defined on the domain @xmath10 and thus on points that are equally spaced across @xmath10 .",
    "hence , the discrete copula concept could be generalized to settings in which either the domain is @xmath171 , where @xmath172 are distinct , or the points where the copula is of interest are heterogeneously spaced across the margins . +   + the second part of the multivariate discrete version of sklar s theorem as formulated in theorem [ sklarmdc ] can very likely be extended and accentuated to the effect that the irreducible discrete copula @xmath11 is uniquely determined if and only if @xmath173 for all @xmath14 .",
    "following the procedure for the bivariate case in , a rigorous proof of this would require the construction of a smallest and largest discrete extension copula , respectively .",
    "the corresponding algorithms to achieve this appear to be supplied by modifying those for the bivariate case in .",
    "however , due to its expected length and technical character , a detailed study of this question has not been conducted here and is therefore an issue for future work . +   + although several multivariate copula - based methods for discrete data have already been proposed , for instance in using vine and pair copulas , approaches based on multivariate discrete copulas as introduced in this paper provide appropriate and useful alternatives .",
    "as we have seen , the notion of discrete copulas quite naturally arises in the context of the ecc method and the schaake shuffle related to statistical ensemble postprocessing in weather forecasting .",
    "it allows for a unifying interpretation and builds an overarching theoretical frame of many other state - of - the - art ensemble postprocessing techniques which can be considered special cases of ecc .",
    "examples include the methods in @xcite , @xcite and @xcite , for instance .",
    "the ecc scheme principally can also be employed in applications apart from weather prediction , and the theoretical frame then continues to hold analogously in much broader situations .",
    "+   + following the pioneering work of @xcite , further research should be conducted towards a comparison of the predictive performances of ecc , the schaake shuffle and their modifications @xcite in order to provide practical guidance when to use which method .",
    "ideally , the approaches of ecc and the schaake shuffle or parts thereof could be combined , while retaining the advantages of each method .",
    "an initial attempt into this direction has been performed in @xcite , where a specific implemetation of the schaake shuffle is proposed . in this approach",
    ", the empirical copula modeling the dependence is derived from past observations at dates for which the corresponding historical ensemble forecast resembles the current one with respect to a particular similarity criterion .",
    "we first prove the implication from ( 1 ) to ( 2 ) .",
    "if @xmath174 for at least one @xmath14 , @xmath175 by axiom ( d1 ) in definition [ mdc ] , in accordance with setting the empty sum equal to zero by convention , that is , @xmath176 for some sequence @xmath177 . for @xmath178 , we set @xmath179 with @xmath180 as defined in axiom ( d3 ) in definition [ mdc ] , and @xmath138 and show that @xmath181 satisfies the axioms ( a1 ) and ( a2 ) from definition [ stocharr ] and therefore is an @xmath0-dimensional stochastic array of order @xmath24 .    *",
    "since @xmath11 is a discrete copula , @xmath11 is @xmath0-increasing , that is , @xmath182 hence , @xmath183 by definition , and ( a1 ) is fulfilled .",
    "* now let @xmath14 be fixed .",
    "we have to show that @xmath184 to this end , let @xmath185 and first consider @xmath186 . by using the above definition of @xmath187 , writing down the sum @xmath188 explicitly yields that all of the @xmath189 addends @xmath190 of @xmath188 cancel out except for those @xmath191 having 0 or 1 in the @xmath192-th component . since discrete copulas are grounded according to axiom ( d1 ) in definition [ mdc ] , all the @xmath193 terms of @xmath188 that have a 0 in the @xmath192-th component vanish , and the @xmath193 terms @xmath194 remain . by writing down the multiple sum @xmath195 explicitly , iteratively applying the above considerations for the calculation of a sum of the type @xmath196 and accounting for the fact that discrete copulas are grounded due to axiom ( d1 ) in definition [ mdc ] , all but two of the terms @xmath190 of @xmath195 vanish or cancel out , such that @xmath197 where the axiom ( d2 ) in definition [ mdc ] is employed in the third equality .",
    "hence , ( a2 ) is fulfilled .",
    "thus , @xmath181 is an @xmath0-dimensional stochastic array of order @xmath24 .",
    "+   + finally , the definition of @xmath181 gives the structure of @xmath11 in .",
    "indeed , similar arguments as in the proof of ( a2 ) above yield that for fixed @xmath198 , the sum @xmath199 can be calculated as @xmath200 for fixed @xmath14 and using the expression for @xmath201 , similar calculations as in the proof of ( a2 ) before yield @xmath202 we then employ @xmath203 to calculate @xmath204\\\\ & = & d \\left(\\frac{i_{1}}{m},\\ldots,\\frac{i_\\ell}{m},\\ldots,\\frac{i_{l}}{m } \\right)-\\underbrace{d \\left(\\frac{i_{1}}{m},\\ldots,\\frac{1 - 1}{m},\\ldots,\\frac{i_{l}}{m } \\right)}_{=0,\\,\\ , \\text{as $ d$ is grounded}}\\\\ & = & d \\left(\\frac{i_{1}}{m},\\ldots,\\frac{i_{l}}{m } \\right),\\end{aligned}\\ ] ] where the second last equality takes advantage of a telescoping sum .",
    "thus , holds .",
    "+   + we now prove the implication from ( 2 ) to ( 1 ) .",
    "let the function @xmath11 be defined as in . obviously , @xmath11 has domain @xmath205 .",
    "since @xmath181 is an @xmath0-dimensional stochastic array of order @xmath24 , and according to the rules for multiple sums , we have @xmath206 for fixed @xmath207 , @xmath14 , and hence get the range @xmath208 $ ] .",
    "moreover , we have to check the axioms ( d1 ) , ( d2 ) and ( d3 ) in definition [ mdc ] for @xmath11 .",
    "* let @xmath13 for some @xmath14 .",
    "since the empty sum is equal to zero by convention , we get @xmath209 clearly , this is also the case if there are two or more @xmath14 such that @xmath13 .",
    "hence , @xmath11 is grounded .",
    "*   let @xmath14 .",
    "then , @xmath210 according to the rules for multiple sums .",
    "* we have to show that @xmath11 is @xmath0-increasing , that is , @xmath211 by definition , @xmath212 involves @xmath191 terms of the form @xmath190 , where @xmath193 of them have positive sign and @xmath193 negative sign .",
    "moreover , each of the @xmath0 arguments of a term @xmath190 is either of the form @xmath213 or of the form @xmath214 for @xmath14 .",
    "+   + let @xmath14 be fixed .",
    "in addition , let the arguments @xmath215 for @xmath185 also be fixed , that is , @xmath216 is either equal to @xmath217 or equal to @xmath218 .",
    "first , @xmath219 where to some extent , the multiple sum is now reduced due to the fact that the index @xmath220 is fixed . +   + using the definition of @xmath212 and writing down @xmath212 explicitly in terms of the @xmath191 terms @xmath190 step by step , we obtain @xmath193 such differences as described above within the expression for @xmath212 .",
    "having calculated all those @xmath193 differences in the way as proposed before , we get @xmath221 new differences of the same type as in @xmath222 , where the index @xmath223 in the multiple sums becomes fixed , and can thus proceed as before . by applying this scheme successively , we finally end up with @xmath224 since @xmath225 is an @xmath0-dimensional stochastic array of order @xmath24 by assumption , @xmath226 for all @xmath17 , @xmath14 .",
    "hence , @xmath227 , and @xmath11 is @xmath0-increasing .",
    "thus , @xmath11 is indeed a discrete copula.@xmath228      let @xmath229 for @xmath14 , with the corresponding equivalent sets @xmath230 according to theorem [ equiv ] , it suffices to construct an @xmath0-dimensional permutation array @xmath181 of order @xmath24 to get an irreducible discrete extension copula @xmath11 of an irreducible discrete subcopula @xmath85 . the array @xmath181 has to be such that each block specified by the positions @xmath231 and @xmath232 , which consists of the rows from @xmath233 to @xmath234 , from @xmath235 to @xmath236 , and so forth , up to the row from @xmath237 to @xmath238 , contains a number of 1 s equal to the volume @xmath239 where @xmath240 and @xmath14 .",
    "+   + to show the existence of such a permutation array @xmath181 , let @xmath14 be fixed and consider the subarray which contains all the blocks determined by the positions @xmath241 and @xmath242 for all @xmath243 , where @xmath185 . +   + we need to show that the number @xmath244 of rows in this subarray is equal to the number of 1 s corresponding to all those blocks .",
    "this indeed holds , as @xmath245 where we use axiom ( s2 ) in definition [ mdsubcop ] for the second last equality .",
    "+   + to see the second equality explicitly , we proceed analogously as in the proof of axiom ( a2 ) in theorem [ equiv ] for the implication from ( 1 ) to ( 2 ) .",
    "we set @xmath246 let @xmath185 be fixed and first consider the sum @xmath247 the @xmath248 addends @xmath190 of @xmath249 cancel except for those @xmath250 having a 0 or a 1 in the @xmath192-th component , which indeed occurs as @xmath251 and @xmath252 . according to axiom ( s1 ) in definition [ mdsubcop ] , all the @xmath193 terms having a 0 in the @xmath192-th component vanish , and we obtain @xmath253 applying this iteratively and using again axiom ( s1 ) in definition [ mdsubcop ] , all but two of the terms @xmath190 of @xmath254 vanish or cancel out , such that @xmath255 as desired.@xmath228      1 .",
    "this is just a special case of the common sklar s theorem .",
    "the claim follows straightforwardly by checking the well - known axioms of a finite @xmath0-dimensional cdf for @xmath75 as defined in . 2 .",
    "let @xmath75 be a finite @xmath0-dimensional cdf with @xmath256 having univariate marginal cdfs @xmath257 .",
    "set @xmath258 for @xmath14 and define @xmath259 where @xmath260 satisfies @xmath261 for @xmath14 .",
    "+   + we now show that @xmath85 is an irreducible discrete subcopula .",
    "first , @xmath262 by assumption , and @xmath85 is well - defined , due to the well - known fact that @xmath263 for points @xmath148 and @xmath264 such that @xmath265 for all @xmath14 .",
    "furthermore , the axioms ( s1 ) , ( s2 ) and ( s3 ) for discrete subcopulas in definition [ mdsubcop ] are fulfilled , as shown in what follows .",
    "* let @xmath13 for an @xmath14 . then , @xmath266 with @xmath267 and @xmath268 for all @xmath185 .",
    "however , @xmath269 and since @xmath75 is non - decreasing in each argument , we have @xmath270 and hence @xmath271 for all @xmath272 , where @xmath185 . clearly , this is also true if @xmath13 for two or more @xmath14 . * for @xmath14 , consider @xmath273 with @xmath261 and @xmath274 for @xmath185 .",
    "set @xmath275 for @xmath185 .",
    "then , @xmath276 for all @xmath29 . * to show that @xmath85 is @xmath0-increasing , we use the @xmath0-increasingness of @xmath75 as a multivariate cdf and obtain @xmath277 for all @xmath278 such that @xmath279 , where @xmath261 and @xmath280 for all @xmath281 and @xmath14 . hence , @xmath85 is @xmath0-increasing .",
    "+ thus , @xmath85 is indeed a subcopula .",
    "+   + according to lemma [ extension ] , @xmath85 can be extended to a discrete copula @xmath11 , which satisfies @xmath282 for @xmath125 .",
    "hence , @xmath283 .",
    "+   + if @xmath284 for all @xmath14 , then the discrete subcopula @xmath85 has domain @xmath35 , and thus we have @xmath285 , that is , @xmath11 is uniquely determined.@xmath228",
    "i gratefully acknowledge support by the klaus tschira foundation and the volkswagenstiftung under the project `` mesoscale weather extremes : theory , spatial modeling and prediction '' and by deutsche forschungsgemeinschaft through the research training group rtg 1953 .",
    "+ most of the work has been done during my time as a phd student at the institute for applied mathematics at heidelberg university .",
    "i thank my advisors tilmann gneiting and thordis thorarinsdottir for many helpful discussions .",
    "+ moreover , i thank an anonymous reviewer of this paper , who has provided many valuable comments and suggestions . + for the real data illustration in figure [ ecc ] , the forecasts have been made available by the european center for medium - range weather forecasts and the observations by the german weather service , which is gratefully acknowledged .",
    "m.  p. clark , s.  gangopadhyay , l.  e. hay , b.  rajagopalan , and r.  l. wilby .",
    "the schaake shuffle : a method for reconstructing space - time variability in forecasted precipitation and temperature fields .",
    "_ journal of hydrometeorology _ , 5:0 243262 , 2004 .",
    "p.  deheuvels .",
    "la fonction de dpendance empirique et ses proprits .",
    "un test non paramtrique dindpendance .",
    "_ acadmie royale de belgique , bulletin de la classe des sciences , srie 5 _ , 65:0 274292 , 1979 .",
    "p.  embrechts , f.  lindskog , and a.  mcneil . modelling dependence with copulas and applications to risk management . in s.",
    "t. rachev , editor , _ handbook of heavy tailed distributions in finance _ ,",
    "pages 329384 .",
    "elsevier , amsterdam , 2003 .",
    "k.  feldmann , m.  scheuerer , and t.  l. thorarinsdottir .",
    "spatial postprocessing of ensemble forecasts for temperature using nonhomogeneous gaussian regression .",
    "_ monthly weather review _",
    ", 143:0 955971 , 2015 .",
    "t.  gneiting , a.  e. raftery , a.  h. westveld , and t.  goldman . calibrated probabilistic forecasting using ensemble model output statistics and minimum crps estimation .",
    "_ monthly weather review _",
    ", 133:0 10981118 , 2005 .",
    "a.  mller , a.  lenkoski , and t.  l. thorarinsdottir .",
    "multivariate probabilistic forecasting using ensemble bayesian model averaging and copulas .",
    "_ quarterly journal of the royal meteorological society _ , 139:0 982991 , 2013 .                              c.  schoelzel and p.  friederichs",
    "multivariate non - normally distributed random variables in climate research  introduction to the copula approach . _ nonlinear processes in geophysics _ , 15:0 761772 , 2008 .",
    "b.  van  schaeybroeck and s.  vannitsem .",
    "ensemble post - processing using member - by - member approaches : theoretical aspects .",
    "_ quarterly journal of the royal meteorological society _ , 141:0 807818 , 2015",
    ". m.  vrac and p.  friederichs .",
    "intervariable , spatial , and temporal  bias correction .",
    "_ journal of climate _ , 28:0 218237 , 2015 .",
    "d.  s. wilks .",
    "multivariate ensemble model output statistics using empirical copulas .",
    "_ quarterly journal of the royal meteorological society _ , 141:0 945952 , 2015",
    ". j.  j. xu .",
    "_ statistical modelling and inference for multivariate and longitudinal discrete response data_. phd thesis , the university of british columbia , 1996 ."
  ],
  "abstract_text": [
    "<S> in probability and statistics , copulas play important roles theoretically as well as to address a wide range of problems in various application areas . </S>",
    "<S> we introduce the concept of multivariate discrete copulas , discuss their equivalence to stochastic arrays , and prove a multivariate discrete version of sklar s theorem . </S>",
    "<S> these results provide the theoretical frame for multivariate statistical methods to postprocess weather forecasts made by ensemble systems , including the ensemble copula coupling approach and the schaake shuffle .    _ </S>",
    "<S> keywords : _ multivariate discrete copula , stochastic array , sklar s theorem , probabilistic weather forecasting , statistical ensemble postprocessing , ensemble copula coupling , schaake shuffle </S>"
  ]
}