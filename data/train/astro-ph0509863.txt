{
  "article_text": [
    "the number of known gravitational lenses has grown steadily over recent decades .",
    "they hold much promise for being able to constrain theories about dark matter ( by probing the mass distribution of the lensing object ) , and also for being able to magnify distant sources into view , that would have been unobservable otherwise .",
    "however , it is slightly disconcerting that as the number of observed gravitational lens systems has increased , so has the number of seemingly distinct methods for analysing them .",
    "a few examples are : the ring cycle @xcite , lensclean @xcite , lensmem @xcite , semi - linear inversion @xcite , and genetic algorithms @xcite .",
    "these techniques all have their own particular advantages and disadvantages , and it is not clear whether or not there is one method that is in some sense more justified than the others . in this paper",
    "we seek to unify these approaches and show that they are all different methods of doing essentially the same thing .",
    "of course , practical considerations such as computational efficiency must also be taken into account in judging the relative merits of different inversion methods , although this is not such a huge issue due to increasing computer power and the relative rarity of discoveries of these systems . in this paper , we only consider the question of theoretical justification of these methods ; discussions of the practical considerations can be found in the respective literature .",
    "bayesian inference is an approach to statistical analysis that is based almost entirely on probability theory , viewed as a generalisation of logic to include uncertainty @xcite .",
    "this was the original approach to probability theory as developed by laplace , but was largely rejected in the early 20th century in favour of the `` frequentist '' school of thought , where probabilities can only be interpreted as long - run frequencies in a random experiment .",
    "however , bayesian methods enjoyed a resurgence in the latter half of the 20th century .",
    "one reason for this is the proofs of @xcite , who showed that any system which measures plausibility with real numbers , and satisfies several consistency criteria , is equivalent to probability theory .",
    "more convincing , however , is the rapidly growing number of practical examples of its use in real applications ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* and many others ) .",
    "the product rule of probability is as follows . for two propositions @xmath0 and @xmath1 , the probability that both @xmath0 and @xmath1 are true , given some background information and/or assumptions @xmath2 , is given by    @xmath3    where @xmath4 is the probability that @xmath1 is true , _ given _ that a is true .",
    "rearranging the above equation gives bayes theorem :    @xmath5    by considering propositions of the form `` the quantity x lies in the interval @xmath6 '' , it can be shown that a version of bayes s theorem also holds for probability density functions ( pdfs ) of continuous variables .",
    "thus , whenever you want to learn the value of some unknown quantities @xmath7 , given some other known quantities ( the data @xmath8 ) that depend on the @xmath7 values in a probabilistic ( i.e. not entirely predictable ) way , then the correct procedure is to calculate the probability distribution of the unknown quantity , given the data :    @xmath9    which is the `` posterior '' pdf of the parameters given the data .",
    "the @xmath10 term which should be in the denominator has been omitted , because it does not depend on @xmath7 and can be absorbed into the normalisation constant .",
    "thus , bayes theorem tells us how to modify our state of knowledge of the unknown @xmath7 values by taking the data @xmath8 into account .",
    "however , the posterior pdf depends on @xmath11 , the so called `` prior distribution '' of the unknown quantities . in other words",
    ", we ca nt learn from the data unless we specify our prior knowledge ( or ignorance ) about the values of those unknown parameters , before observing the data .",
    "the second term in equation  [ bayes2 ] , the probability density of the data if we knew the values of the parameters , is called the sampling distribution if we consider a fixed set of parameters , and imagine calculating the probability of obtaining different data sets @xmath8 . however , for a fixed data set ( the one that is observed ) , and considering its dependence on @xmath7 , it is called the likelihood function .",
    "it is immediately clear that the `` maximum likelihood estimate '' of statistics is just the mode of the posterior distribution , for a uniform prior distribution , because the posterior pdf is proportional to the likelihood function in this case .",
    "as shown by @xcite , this leads to a neat justification for the method of least squares , as being appropriate when the sampling distribution is gaussian .",
    "the presence of the prior term in the bayesian approach has been the subject of much controversy @xcite , and is usually the reason why some people avoid it .",
    "the point of the prior distribution is not to describe randomness or variation of the quantity , but our state of knowledge about it .",
    "however , the results of a calculation are generally insensitive to the choice of prior , particularly when it is diffuse compared to the likelihood function . in addition , conventional statistics , while appearing more `` objective '' due to the lack of things like prior distributions , has merely swept the matter under the carpet .",
    "use of statistical methods that do nt make reference to prior distributions can usually be shown to be equivalent to a specific choice of prior ; the maximum likelihood estimate mentioned above is one example .",
    "there also exist a limited number ( at this time ) of general principles for the objective assignment of prior distributions , given particular types of prior information @xcite .",
    "a simple example is the principle of insufficient reason , given by laplace ; if we only know that there are @xmath12 possibilities that are mutually exclusive and exhaustive , and nothing more , we assign equal prior probabilities of @xmath13 to each .",
    "one of the main observable predictions of the theory of general relativity is that light rays can be bent as they pass through the gravitational field of a massive object .",
    "usually , we assume that all of the mass in the lensing object is located in a plane , called the lens plane .",
    "if the coordinates on the lens plane are @xmath14 and @xmath15 , the mass distribution of the lensing object is described by a function @xmath16 .",
    "a light ray passing through the lens plane will be bent by an angle called the deflection angle @xmath17 . for the case of a point mass lens",
    ", the deflection angle is directed towards the mass , and has magnitude proportional to @xmath18 , where @xmath19 is the distance from the point mass . for the case of a continuous mass density , the deflection angle at a point @xmath20 in the lens plane",
    "is obtained by integrating the deflection angles due to all other mass elements . in the usual scaled coordinates , any light that is observed at position @xmath20 in the image plane had its origin at the position @xmath21 in the source plane , given by    @xmath22    @xmath23    note that equation  [ scaledlens ] gives a unique source plane position @xmath21 for a given image plane position @xmath20 . in general , though , the inverse function does not exist , so any particular position @xmath21 in the source plane can be mapped to multiple positions in the lens plane .",
    "this is the mathematical reason why the background source is often multiply imaged in gravitational lens systems . for an extended source",
    ", the source may be described by a surface brightness profile @xmath24 .",
    "the observed image is usually considered as a function over the lens plane , @xmath25 . since surface brightness ( intensity per unit area )",
    "is not changed by lensing , we have that the observed image is given by    @xmath26    when the source and image are pixellated , this relation does not hold exactly because the image consists of the integrated surface brightness over the pixels",
    ". however , there is a linear relationship between the source and the image in this case , which is given in section  [ pixellated ] .",
    "in this section we present the general procedure of the calculations that need to be done , but the equations are left in a generic form , appropriate for whatever parameterisation of lens and source is chosen .",
    "later on , we will specialise to the case of a pixellated source and a parameterised lens model . in the context of lensing , we have an underlying source @xmath27 and a lens @xmath28 , which we wish to infer from observations , which are the observed image @xmath29 . in other words ,",
    "we want the joint posterior distribution of the @xmath27 and @xmath28 parameters ( whatever quantities we are using in our mathematical description of the source and lens ) , given @xmath29 .",
    "bayes theorem states    @xmath30    where the factor @xmath31 is determined by the model of the noise . if the lens parameters are of interest , but the source is not , then the inference about the lens is given by the marginal probability density of the @xmath28 parameters :    @xmath32    in general , any prior knowledge of the source will not affect our prior knowledge about the lens , and vice versa .",
    "therefore the joint prior pdf for @xmath28 and @xmath27 can be factorised into independent priors for @xmath28 and @xmath27 , giving    @xmath33    in some special cases , it may be possible to evaluate these integrals analytically .",
    "this is not the case in the following discussion , however there are numerical methods which can be used .",
    "when all is said and done , we would like to describe our knowledge of the source and the lens by a finite number of values , and the uncertainties in those values . in this paper",
    ", we are concerned with the case of extended sources , which can have detailed structure in them .",
    "thus , we need to choose a parametrisation that allows for the possibility of arbitrarily complicated structures in the source .",
    "pixels are the obvious choice .",
    "suppose we are given an observed image .",
    "for any lens model we choose , it is possible to find a source light distribution that reproduces the observed image . in the case",
    "that two points with different brightness in the image map to almost the same point in the source plane , we could get around this by having rapidly varying structure in the source , with extremely high positive and negative values of surface brightness .",
    "however , nobody would seriously propose such a reconstruction ; we already have prior knowledge that rules out this possibility .",
    "we expect in advance that the source should be non - negative and smooth on some scale .",
    "there are several ways of taking this into account , using pixels is one way , because structure within pixels is impossible .",
    "other possibilities include using non - square basis functions ( for example , reconstructing the source as a combination of gaussian blobs ) , use of `` fuzzy pixels '' , or by choosing a prior distribution that rewards smooth sources .    in using pixels to describe the source light profile",
    ", we are restricting our resolution to scales larger than the size of the pixels .",
    "it is often clear how to judge in advance the pixel size that is necessary . with gravitational lensing",
    ", however , intuition suggests that our image will allow us to reconstruct the source with better resolution in some regions of the source plane than in others .",
    "for example , we might expect that we could achieve higher resolution in the reconstructed source for areas in the source plane that are near the caustics - these regions have been imaged more times ( ie they affect more pixels of the image ) than the others , so our image provides more constraints on them .",
    "@xcite have devised a clever method of adaptive pixellation of the source plane for use with their semi - linear inversion method , that puts more pixels on high magnification regions .    in this paper",
    "we use a uniform pixel size , and since we calculate the posterior distribution for the brightness of each pixel , will be able to see directly which pixels are strongly constrained by the observations , and which ones are nt . hence we can check if the high magnification regions of the source plane really are more tightly constrained by the data .    in reality , sources are not made up of pixels , ie square regions of constant surface brightness .",
    "we are obliged to use them because we must have some way of describing the source by a finite set of numbers . however , observed images taken with ccds do actually consist of pixels .",
    "the intensity in each pixel corresponds to an estimate of the _ integral _ of the true surface brightness ( `` intensity density '' ) of the image , over the area covered by the pixel .",
    "hence , the object we wish to infer ( the source ) is a surface brightness function @xmath24 , yet our observed data consists only of integrals of that function over certain regions .",
    "thus , our data can only ever constrain those integrals , and prior information is the only way of deciding between different reconstructions that all fit the data .",
    "bayesian methods give us the posterior pdf of all of the pixel values , given the data .",
    "if we reconstruct with a large number of pixels , then any individual pixel is likely to be constrained very weakly by the data , so the marginal posterior pdf of any individual pixel will be very wide . however , a question we would like to answer is `` if the lensing object was not there , and we observed the source , what would we see ? '' .",
    "since observed images are pixellated , in effect we want to estimate the integral of the surface brightness over some square regions , which may be larger than the pixels we did the reconstruction with .",
    "we will see that , while the individual pixels are only weakly constrained by the data , sums of them over particular regions ( which approximate the integral of the surface brightness over those regions ) can be quite precisely determined .",
    "a strong analogy can be drawn between this reasoning and that used in statistical mechanics . in statistical mechanics , we start off completely ignorant of the microscopic state of the system .",
    "then , measurement of a macroscopic thermodynamic variable narrows down the range of possible `` microstates '' that the system could be in , but there are still a huge number that are compatible with the macroscopic constraints imposed by the data [ the `` ensembles '' of statistical mechanics are somewhat like posterior pdfs of the microscopic variables , given the macroscopic data , see @xcite ] .",
    "when we use this to make predictions about other macroscopic quantities , though , we find that there is enough information to make accurate predictions of these .",
    "it is well known that , when attempting to infer a large number of parameters from some noisy data , the large number of parameters makes it possible to `` overfit '' the data by fitting the noise . with conventional strategies , the best possible",
    "fit within the parameter space is obtained , and is usually accepted or rejected based on the @xmath34 criterion @xcite .",
    "this penalises the use of large numbers of parameters , and behaves like a kind of `` occam s razor '' . from a bayesian perspective",
    ", however , it is clear that @xmath34 is not the final answer to the question of goodness of fit .",
    "it is possible that a correct model could give a best fit which is not good enough by the @xmath34 criterion , yet the fit is still good over a wide range of parameter space . to reject a model altogether ,",
    "it is not the value of @xmath34 of the best fitting parameters that is important ( although it may be a useful indicator ) , but the `` evidence '' value @xmath35 , which is required in order to test one model against a particular alternative model @xmath36 , as can be seen by writing down bayes theorem for the posterior probabilities for two competing models @xmath37 and @xmath36 .",
    "the answer we get from bayesian analysis is the joint posterior pdf of all of the parameters , indicating what values are plausible in the light of the data .",
    "even though the _ best _ fitting set of parameters may dramatically overfit the data , the volume of parameter space that is near this peak is exceedingly small , and decreases with the number of parameters .",
    "thus , the overwhelming majority of plausible reconstructions do not `` fit the noise '' , even if we use a large number of parameters .",
    "@xcite noted that the use of `` regularisation '' made the @xmath34 criterion inapplicable , by effectively reducing the number of free paramaters , by tying some together or limiting their allowed ranges . since the use of regularisation is equivalent to a particular choice of prior distribution ( see section  [ relation ] ) , it is possible to compare different reconstructions objectively .",
    "the theory of bayesian model selection @xcite provides the means for accomplishing this , and automatically displays phenomena such as occam s razor , and penalising models that require fine tuning ( one model may fit the data well , but only in a small region of its parameter space , while another model which fits the data over a wide range of its parameter space will be preferred ) .",
    "unfortunately , this usually involves integrals of complicated functions over many dimensions , so is often impractical . with this problem , @xmath34 is not strictly applicable , but the alternative is difficult , and is beyond the scope of this paper .",
    "it seems as if this problem can become arbitrarily complicated .",
    "this is true of every problem in science .",
    "any phenomenon can be modelled either crudely or in great detail , and it is only the limits in the abilities and attention spans of the people studying them that determines when they decide to stop .",
    "when both the image and the source are pixellated , they can be regarded as vectors @xmath38 and @xmath39 respectively , where each component of the vector is the value of a pixel . in general",
    ", these vectors will be of different lengths . due to conservation of surface brightness ,",
    "if the source was multiplied by a constant or had a constant added to it , the effect of this on the image , and hence the image pixel values , would be the addition or multiplication of the same constant .",
    "in other words , lensing is a linear operator , so for the case of pixellated images and sources , there must be a linear relation between @xmath38 and @xmath39 .",
    "ie a matrix @xmath40 exists such that    @xmath41    the form of the matrix @xmath40 is completely determined by the lens mass distribution @xmath16 , and can be calculated by ray tracing @xcite .",
    "the blurring by the point spread function is also a linear operation , so can be represented by another matrix multiplication , alternatively , we regard @xmath40 as being the matrix product of a lensing matrix and a blurring matrix .",
    "the observed image is vector @xmath42 which is related to the true source @xmath39 by    @xmath43    [ linear ]    where @xmath40 is an _",
    "unknown _ lensing / blurring matrix and @xmath44 is a vector of `` random noise '' , the observational errors in each pixel of the observed image .",
    "thus , this problem is of a standard type @xcite as the structure of the problem in equation  [ linear ] arises in many different contexts , and is not limited to ccd pixel values . here , the matrix @xmath40 is unknown , but we will describe the lens by a parametrised model , so the number of degrees of freedom of the matrix @xmath40 is not too large .",
    "the point spread function is assumed to be known for our simulations ; this is at least approximately true in practice , as the point spread function can be measured or simulated from the instrumental response to a point source . due to the presence of the blurring , we are effectively also doing bayesian deconvolution @xcite .",
    "the choice of prior distributions often gets little attention .",
    "however , it is usually the case that neglecting this question by using some other method is equivalent to using a particular prior distribution .",
    "for example , it is quite easy to show that the method of @xcite , being a least squares method , is equivalent to finding the peak of the posterior pdf @xmath45 for a uniform prior distribution @xmath46 , and gaussian noise .",
    "this has the obvious drawback that it allows pixels to be negative , and hence ignores the most basic prior information that we know of - surface brightness is a nonnegative quantity .",
    "however , this may be a small price to pay for the convenience it delivers .    a simple way to rectify",
    "this is to consider the problem as one of constrained least squares , where the @xmath34 deviation between the model and the data is minimised subject to a positivity constraint on all of the source pixels values @xcite .",
    "least squares is equivalent to the bayesian approach with a uniform prior distribution , but with negative values forbidden .",
    "there are some problems associated with this method that are discussed in section  [ failure ] .",
    "these problems were not noticed previously because the methods focused on _ optimisation _ of the source ( i.e. finding the best fit ) , rather than _ exploration _ , where the set of all plausible fits is considered .",
    "when `` regularisation '' is used @xcite , whereby an additional term representing `` quality '' is added to the merit function to be optimised , this is equivalent to assuming a particular form of prior distribution , and then seeking the most probable reconstruction ( for a given lens model ) by maximising @xmath45 .",
    "the maximum entropy method @xcite is similar in nature , and has the added benefit that positivity of the source is guaranteed .",
    "these approaches tend to give results that are useful and visually appealing , but some issues arise when these are applied to astronomical images .",
    "astronomical images are mostly blank .",
    "this is a simple and important fact that none of the above priors take into account , but which is important .",
    "for example , use of the prior that is constant everywhere where the source pixels are positive , while seeming very conservative about the values of individual pixels , can end up making dogmatic statements about the sum of many pixels .",
    "use of regularisation or the entropic prior of lensmem actually exacerbate this problem , by making reconstructions which are compressed ( have more moderate values and less extreme ones ) more likely a priori .",
    "in later sections with simulated data , we will use a prior that , while not having as sophisticated a justification as the entropic prior , is closer to what we actually think about astronomical data .",
    "we will make the conventional choice of a gaussian distribution for the noise , leading to the following sampling distribution / likelihood function @xmath47 ,    @xmath48 = e^{-\\frac{1}{2}\\chi^2}\\ ] ]    where the @xmath49 are the `` uncertainties '' of each pixel of the observed image . before applying any lensing reconstruction procedures to the data",
    ", it has usually been subjected to some other procedures , such as foreground galaxy subtraction and also the subtraction of the mean sky brightness .",
    "thus , it is unreasonable to expect to be able to use a poisson sampling distribution ( from photon counting arguments ) , because after these necessary procedures been performed , the data are no longer integer valued , and can be negative .",
    "as long as the @xmath49 correctly indicate the expected ( rms ) magnitude of the noise , then the independent gaussian pdf is the most conservative and general probability assignment we could make .",
    "it does not necessarily have to correctly represent the long run frequency distribution of the errors in repeated experiments ( if such a thing exists ) , as discussed by @xcite and demonstrated empirically by @xcite .",
    "as long as the gaussian model does not assign extremely low probability to the actual errors that are present in the one observed image that we actually have , then no problems will arise from its use .",
    "the worst case scenario is that parameter estimates will be slightly more conservative than they would have been if we had additional information about the noise .      in order to set up a prior distribution @xmath50 for the parameters of the lens model",
    ", we must consider what little information we have about the lens mass distribution , without considering the image .",
    "however , we are allowed to consider the image of the foreground galaxy as information which is relevant to the lens model parameters . in the dark matter paradigm , there is typically a poor correlation between the observed light distribution of the foreground lensing galaxy and the way its mass is distributed @xcite . in this case , the prior distributions for the lens parameters would be very diffuse , with the galaxy image only providing information about the general order of magnitude of the lens parameters .",
    "however , if we assume some particular relativistic theory of mond [ such as @xcite ] is true , and its implications for lensing are known , then the observed galaxy image will provide quite strong constraints on the parameters of the lensing model .",
    "thus , lensing can provide a test of dark matter vs mond , because if mond is used , the brightness profile of the lensing galaxy should all but fix the lens model . in the coming simulations , uniform priors are used for all lens parameters .",
    "this has little effect on the conclusions because the data are able to constrain the lens parameters quite strongly .",
    "it is usually straightforward to write down the posterior pdf for all of the unknown parameters ( equations  [ bayeslens ] together with  [ gaussian ] ) .",
    "however , written in this form it is often not of much use .",
    "we are usually interested in some of the parameters , but not all of the others . for example , we might want to know the posterior pdf for the total mass in the lens , so we can quote an estimate and its uncertainty . in principle , the way to deal with this is to obtain the marginal pdf for all of the wanted parameters , by integrating the joint pdf with respect to all of the unwanted parameters . however , in practice this is usually impossible to do analytically .",
    "markov chain monte carlo ( mcmc ) methods are a computational tool for solving this problem .",
    "they seek to generate a random sample from the posterior pdf [ a cosmological example is @xcite ] . by looking at only one parameter of the models in the sample ( for example as a histogram ) , we can immediately get an idea of the marginal posterior pdf for that parameter .",
    "we can also approximate its mean and standard deviation ( which we might give as the estimate and the uncertainty ) by using the mean and standard deviation of the sample .",
    "the markov chain aspect comes from the way these methods work .",
    "most work by taking a kind of random walk through the parameter space , with the transition probabilities constructed in such a way that the stationary distribution of the markov chain is the posterior distribution that we are interested in .",
    "then , in the long run , the random walk visits different regions of the parameter space in proportion with their posterior probability @xcite .      the metropolis algorithm @xcite is the starting point for many markov chain monte carlo schemes .",
    "start from a point @xmath51 in the parameter space .",
    "denote the target distribution ( which we want to sample from , in our case it is the posterior distribution @xmath52 by @xmath53 .",
    "a proposal step is made , from the point @xmath51 to the point @xmath54 according to the _ proposal distribution _",
    "@xmath55 , which is assumed to be symmetric , meaning that @xmath56 .",
    "this proposal step is always accepted if @xmath57 , otherwise it is accepted with probability @xmath58 .",
    "this procedure is repeated many times , resulting in a random walk through the parameter space whose long term frequency distribution is equal to the target distribution .",
    "the performance of this algorithm depends on the form of the proposal distribution ( the method should always work , but some proposal distributions may explore the parameter space more quickly ) .",
    "typically , a normal distribution centred at the current value is used , and the variance is adjusted to achieve a moderate acceptance rate of 20 - 50 per cent .",
    "the success ( or otherwise ) of markov chain monte carlo methods is highly dependent on the starting point of the random walk .",
    "if the starting point is somewhere of extremely low posterior probability , the chain can wander around and get stuck in local minima , possibly never reaching the correct region . in principle",
    ", it eventually will , for instance it might spend @xmath59 years in one local maximum before leaping by chance into the high probability region , where it would spend @xmath60 years , say .",
    "unfortunately , there are no general methods for discovering whether this has occurred .",
    "mcmc can also struggle to cope with a situation where good fit is achievable within two parts of the parameter space that have very different parameter values .",
    "this is a problem shared by virtually all other methods , some more so than others .",
    "if multiple maxima are expected to occur then simulated annealing or genetic algorithms may be helpful in finding the maxima . once the maxima are found using any method , they can be used as a starting point for the mcmc method for evaluating the uncertainties . for the lens modelling",
    ", we specified an initial point where the lens parameters were close to the optimal values , and the source was blank .",
    "we tested this algorithm on some simulated data .",
    "the source profile was two gaussians , and these were lensed to create an image on a 64x64 pixel grid .",
    "the image was created by ray tracing , with the source evaluated analytically . hence we can see the effect that assuming pixels has on the final conclusions , when the source is nt really made from pixels .",
    "this image was then convolved with a point spread function , and random noise of known standard deviation was also added .",
    "these are shown in figure  [ sim ] .",
    "the units were chosen so that the image covers a region 2.4 einstein radii across .",
    "the lens model that was used was a pseudo isothermal elliptical potential ( piep ) lens model @xcite with parameters @xmath61 , @xmath62 , @xmath63 , centred at the origin and with the principle axes of the ellipse aligned with the @xmath14 and @xmath15 axes .",
    "the @xmath64 parameter describes the strength of the lens , @xmath65 is the ellipticity , and @xmath66 is the core radius .      at first , a reconstruction was attempted , using the prior distribution which is a constant as long as all source pixels are positive .",
    "the proposal distribution for moving from one step of the chain to the next was done by adding a normally distributed random number to each pixel , and then taking the absolute value . to achieve a moderate acceptance rate in the metropolis method , the standard deviation of the proposal distribution was set to 5 per cent of the noise level in the image , in the case where all pixels are updated at once . for this run",
    ", a 24x24 pixel grid was used , and the lens parameters were held constant at the known true values ; this suffices to illustrate the point .",
    "a random source sampled from the posterior distribution is shown in figure  [ redstuff ] .",
    "the corresponding image , and the residuals ( difference between the reconstructed and observed image ) are also displayed .",
    "the @xmath34 deviation between the model and the observed image is 4536 , which is much higher than the expected value of @xmath67 if this model was correct .",
    "this is because the reconstructed source is much too bright in just those areas where it should be dark .",
    "this is a fatal flaw of this prior distribution - when it is used , the majority of `` plausible '' reconstructions do nt actually match the data ! there are several reasons why this effect was not noticed in previous studies .",
    "firstly , they focused on optimisation rather than exploration .",
    "the source that maximises the posterior pdf would surely fit the data , but the volume of parameter space around this source is very small due to the positivity cutoffs .",
    "also , some authors have chosen to put a `` mask '' around the image , so that the blank regions are deemed irrelevant and not included in the calculations @xcite .",
    "thus , they only looked at the residuals in the bright regions of the image , which is the region that is nt affected by this problem . by masking out blank parts of the image , possibly important information",
    "is also being wasted .",
    "for example , suppose a model was found that reproduces the bright parts of the image faithfully , but also predicts that there should be bright regions where in fact darkness has been observed",
    ". this model would be acceptable if the mask was used , but if we always use the whole image , this situation can never arise .    when the lens parameters were also allowed to vary , the estimates obtained were also slightly incorrect , with the true values lying several standard deviations away from the estimates .",
    "thus , using a positive constant prior ( or something that turns out to be equivalent to it , such as constrained least squares ) in this situation can bias the lens model results slightly . the biasing effect of the uniform prior increases with the number of pixels that are used , since for more pixels , the implied prior estimate on the integrated flux over any region becomes higher .",
    "the idea behind the prior distributions that were used in the remainder of the runs was as follows .",
    "each pixel has an independent distribution , with some positive probability of being very close to zero .",
    "this accounts for the `` astronomical images have a lot of blank regions '' observation noted earlier .",
    "if a pixel is not blank , then we at least know the order of magnitude of the surface brightness distribution , so the positive part of the prior distribution was taken as an exponential with a mean value of 100 ( the typical brightness scale of the bright parts of the image ) .",
    "the prior distributions will be written down explicitly in later sections .",
    "a more sophisticated analysis leads to a slightly different prior which has been called `` massive inference '' @xcite , which is a generalisation of maximum entropy , that has similar features to our priors . in the following sections we show how priors based on these seemingly trivial observations lead to more sensible reconstructions .    in all of the following simulations ,",
    "the lens parameters were also varied .",
    "since this is a more computationally intensive task , involving ray tracing , it was only done once every 10th step .",
    "unfortunately , to achieve a moderate acceptance rate , the proposal distribution for the lens model had to be quite narrow .",
    "we used a normal distribution centred at the current lens parameters , with a standard deviation of 0.001 .",
    "for the first 50,000 steps of the chain , only the source was varied , so that the reconstruction is reasonable before the lens parameters start changing .      in this section we present two different reconstructions of the same simulated data , which both lead to sensible results .",
    "at first , we reconstructed with a 16x16 pixel model for the source , covering a square region from -0.5 to 0.5 einstein radii in the source plane .",
    "the prior probability density on each pixel was taken as a mixture of two exponentials , with 50 per cent weighting given to each :    @xmath68    the first exponential gives a 50 per cent prior probability of the pixel being quite dark , while the other exponential allows for the possibility that the pixel is quite bright .",
    "the mcmc approach that was used for this reconstruction was a slightly modified version of the metropolis algorithm .",
    "the prior distribution was actually incorporated within the proposal step , rather than in calculating the ratio of the posterior probabilities . in other words ,",
    "the proposal step was created such that it would have sampled from the prior distribution , in the absence of any data .",
    "then the acceptance / rejection decision was based on just the ratio of the likelihoods , as the prior had already been taken into account .",
    "figure  [ sample ] shows a sample reconstruction from the posterior distribution , both the source and the resulting blurred image .",
    "the problem of overly bright areas in the reconstruction has disappeared , and the residuals look just like a uniform noise map , as they should .    the mean and standard deviation of the entire sample are also shown ( figure  [ rec1 ] ) , as is the posterior pdf of the total amount of light in the source .",
    "as described in the introduction , the marginal posterior pdf of each pixel is quite wide , but the inference about a `` macro '' quantity ( the total integrated intensity ) is fairly strongly constrained at @xmath69 ( posterior mean @xmath70 standard deviation , so a `` 1-sigma '' uncertainty ) .",
    "the reason for displaying the mean of all of the reconstructions is because expectation values satisfy a linear property , so if we want to predict any integral property of the source ( for instance , the sum of all pixels within a certain region ) , the mean of the sum is equal to the sum of the means .",
    "the trajectory of the lens model parameters , and the corresponding histograms , are shown in figure  [ lens1 ] .",
    "only every 100,000th step of the chain was saved , so that there are no strong correlations between one point and the next .",
    "we can see from the histograms what the inference would be about the three `` interesting '' lens parameters , @xmath64 , @xmath65 and @xmath66 .",
    "the position of the centre of the lens , and the angle of its orientation , were also varied and the marginal pdfs of those parameters can also be viewed , but since these are uninteresting nuisance parameters , we have not displayed them here .    with a prior distribution on each pixel that allows a significant probability of the pixel being very dark ,",
    "the inference about the lens parameters is more accurate than with the uniform positive prior .",
    "the measured values of @xmath64 , @xmath65 and @xmath66 would be @xmath71 , @xmath72 and @xmath73 , respectively , which are consistent with the known true values of 0.5 , 0.25 and 0.1 .",
    "a similar consistency is also seen with the position of the centre of the lens , and its orientation angle , for which the true values were zero .",
    "an alternative pixellated model was also attempted , with 64x64 pixels . with this reconstruction",
    ", we used a more informative prior , this time with a prior probability of 90 per cent that the pixel is exactly zero :    @xmath74    to incorporate this in the metropolis method , we proceeded as before by defining the proposal step so that it would have sampled from the prior distribution if there was nt any data .",
    "in each proposal step , one pixel was selected at random , and switched off with probability 0.9 , or on with probablility 0.1 , in which case its surface brightness was taken from an exponential distribution with a mean of 100 .",
    "the accept / reject decision was then based on the likelihood ratio of the proposed step to the current one .",
    "usually , if a proper model selection analysis is done ( by calculating @xmath75 ) , the 16x16 reconstruction would be favoured because it has managed to explain the data adequately with fewer parameters . within the bayesian framework",
    ", however , the more informative prior distribution in the 64x64 case counteracts this tendency to some extent ( in principle this can be calculated , but it is beyond the scope of this paper ) .",
    "this is because the posterior probability of a model depends not only on the number of parameters , but also on the amount of prior information that there is about the values of the parameters .",
    "a model is favoured if it predicts the observed data ( by assigning high probability to it ) - but if we do not know much about the values of parameters , then we know less about what the model actually predicts .",
    "hence it must spread its share of probability over a larger range of possible data sets , and therefore assigns lower probability to the data set that was actually observed .    from the error maps in figure  [ rec2 ] , it is clear that the uncertainty as to the value of a pixel is far from uniform over the source plane .",
    "the standard deviation image shows that the uncertainty is greatest in the bright regions .",
    "there is also a slight effect due to the magnification pattern , as the diamond - shaped caustic shows up weakly as a region of lower uncertainty .",
    "however , the fractional uncertainty ( standard deviation divided by the mean ) actually follows the opposite trend .",
    "the bright values have low percentage error , and within the high magnification regions , the percentage error is highest .",
    "this suggests that the answer as to which regions of the source plane are more constrained is not so clear cut .",
    "various methods have been proposed for analysing extended gravitational lens systems , in order to extract as much information as possible about the lens and the source .",
    "most have been found to be useful , but all have limitations .",
    "one feature common to all previous methods is the lack of a simple way to evaluate the uncertainties in all of the inferred quantities . by using bayesian inference",
    ", it is possible to reinterpret these methods , showing that they are all equivalent to bayesian inference with different priors .",
    "this suggests how methods may be improved by using more informative priors , and also how uncertainties should be quantified by exploring , rather than maximising , the resulting probability distribution . in this paper , we used a simple markov chain monte carlo method to explore the parameter space and sample from the posterior distribution , leading to quantitative uncertainties on all of the lens model parameters , and also the source pixel brightnesses .",
    "simulated data was used , but we hope to apply this method to actual data in the near future .",
    "when modelling the einstein ring er 0047 - 2808 using the maximum entropy method , @xcite showed that is usually possible to find a plausible reconstruction of an image with several different lens models , when only the best fit parameters are considered .",
    "thus , the lens models remain on an even footing and we can not distinguish which one is more realistic .",
    "luckily , many conclusions about the source are unchanged by the use of different lens models .",
    "however , it should be possible to do bayesian model selection analysis which may show that one of the models is preferred because it fits the data over a larger volume of its parameter space . this possibility will be explored in future contributions , along with an application of these ideas to er 0047 - 2808 and other extended gravitational lens systems .",
    "bjb thanks tom loredo and sarah bridle for some tips regarding mcmc , and also the referee for helpful comments .",
    "gfl acknowledges support through the grant arc dp 0452234 ."
  ],
  "abstract_text": [
    "<S> if an extended source , such as a galaxy , is gravitationally lensed by a massive object in the foreground , the lensing distorts the observed image . it is straightforward to simulate what the observed image would be for a particular lens and source combination . in practice </S>",
    "<S> , one observes the lensed image on the sky , but blurred by atmospheric and telescopic effects and also contaminated with noise . </S>",
    "<S> the question that then arises is , given this incomplete data , what combinations of lens mass distribution and source surface brightness profile could plausibly have produced this image ? </S>",
    "<S> this is a classic example of an inverse problem , and the method for solving it is given by the framework of bayesian inference . in this paper </S>",
    "<S> we demonstrate the application of bayesian inference to the problem of gravitational lens reconstruction , and illustrate the use of markov chain monte carlo simulations which can be used when the analytical calculations become too difficult . </S>",
    "<S> previous methods for performing gravitational lens inversion are seen in a new light , as special cases of the general approach presented in this paper . </S>",
    "<S> thus , we are able to answer , at least in principle , lingering questions about the uncertainties in the reconstructed source and lens parameters , taking into account all of the data and any prior information we may have . </S>"
  ]
}