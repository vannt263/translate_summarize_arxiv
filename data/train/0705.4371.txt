{
  "article_text": [
    "the simulation of high - reynolds number flow is notoriously difficult . in two space dimensions , a partial differential equation model for such flows",
    "is the navier ",
    "stokes equations : @xmath0 where @xmath1 , @xmath2 , @xmath3 and @xmath4 are density , velocity , pressure and energy density respectively .",
    "these equations model the conservation of mass , momentum and energy .",
    "the number @xmath5 is the coefficient of viscosity , and as this number tends to zero we recover the euler equations for inviscid flow .",
    "the reynolds number of the flow is @xmath6 where @xmath7 is the characteristic length scale in the problem , @xmath8 is the free - stream fluid velocity , and @xmath9 is the kinematic viscosity . as @xmath10 , @xmath11 .",
    "our aim is to model the flow in a physical way , so that the limit as the viscosity gets small is the euler equations , but also that diffusion is added in a targeted , physical and controlled way .",
    "we will present a variant of the lattice boltzmann method which was introduced in  @xcite . we will also set this method in the context of a more general coarse - graining paradigm .",
    "let @xmath12 be a one - particle distribution function , i.e. , the probability of finding a particle in a volume @xmath13 around a point @xmath14 , at a time @xmath15 , in phase space is @xmath16 .",
    "then , boltzmann s kinetic transport equation is the following time evolution equation for @xmath17 , @xmath18 the _ collision integral _ , @xmath19 , describes the interactions of the _ populations _",
    "@xmath17 .",
    "equation   describes the microscopic dynamics of our model . we will wish to recover the macroscopic dynamics , the fluid density , momentum density and energy density .",
    "we do this by integrating the distribution function : @xmath20 such functionals of the distribution are called _ moments_. the pressure @xmath3 is given by @xmath21 where we have set boltzmann s constant to 1 .",
    "the lattice boltzmann approach drastically simplifies this model by stipulating that populations can only move with a finite number of velocities @xmath22 : @xmath23 where @xmath24 is the one - particle distribution function associated with motion in the @xmath25th direction .",
    "let @xmath26 be the linear mapping which takes us from the microscopic variables @xmath17 to the vector of macroscopic variables @xmath27 : @xmath28 there are an infinite number of distribution functions which give rise to any particular macroscopic configuration @xmath27 . given a strictly concave entropy functional @xmath29 ,",
    "for any fixed @xmath27 there will be a unique @xmath17 which is the solution of the optimisation @xmath30 we call @xmath31 the _ quasiequilibrium _ as it is not a global equilibrium .",
    "the manifold of quasiequilibria , parameterised by the macroscopic moments @xmath27 , is called the _ quasiequilibrium manifold_.",
    "if the entropy is the boltzmann entropy @xmath32 the quasiequilibrium is the maxwellian distribution @xmath33    since @xmath34 an integration rule which evaluates @xmath35 exactly for low - degree polynomials will preserve the conservation of the macroscopic variables @xmath27 .",
    "since the maxwellian   is essentially gaussian , the first candidate for this is a gauss  hermite - type integration formula .",
    "if we do this we get an approximation @xmath36 if we write @xmath37 then we can view the lattice boltzmann equation   as a quadrature approximation in the velocity variable to boltzmann s equation  . for a complete treatment of this point of view",
    "see  @xcite .    in the lattice boltzmann community",
    "the collision of choice has become the bhatnager ",
    "krook  @xcite collision @xmath38 this is due to its simplicity and the nice intuitive interpretation that the dynamics relaxes towards the quasiequilibrium in a time that is proportional to the relaxation time @xmath39 , which models viscous processes . via the chapman ",
    "enskog procedure it can be shown ( see , e.g. ,  @xcite ) that the associated macroscopic dynamics is the navier ",
    "stokes equations to second - order in @xmath40 .",
    "the kinetic equation appears as an intermediate object between the macroscopic transport equations and the numerical lbm simulation .",
    "but , unfortunately , in the very intriguing limit of small viscosity and time step @xmath41 , the discrete lbm model can not be a good approximation for the continuous - in - time kinetics .",
    "nevertheless , the discrete model can still provide @xmath42 accurate approximation of the macroscopic transport equations  @xcite .",
    "we will see that it is possible to avoid the use of the kinetic equation as an intermediary between lbm and the hydrodynamic context .",
    "what we will demonstrate here ( following the method presented in  @xcite ) is that the navier ",
    "stokes equations arise in a natural way via free - flight dynamics for a time @xmath40 , followed by equilibration",
    ". the coefficient of viscosity will be @xmath43 .",
    "for the remainder of the paper , the _ coarse - graining time _ , @xmath40 , should not be confused with the relaxation time in",
    ". we will also show that we can approximate the euler equations to order @xmath44 by a judicious choice of numerical scheme .",
    "a more detailed treatment of the construction of such numerical schemes for the approximation of the navier  stokes and euler equations may be found in  @xcite .",
    "the original ehrenfests method  @xcite for introducing diffusion into a system was to divide phase space into cells .",
    "then , after the dynamic motion of the microscopic ensemble under , which is conservative , an averaging occurs in the cells , giving rise to an entropy increase .",
    "many other methods in statistical mechanics can be understood as a generalisation of this coarse - graining paradigm  @xcite . we will be using a modified lattice boltzmann method to simulate the flow and we will describe this in the more general context of coarse - graining .",
    "we start from the phase flow transformation of the conservative dynamics : @xmath45 . for the ehrenfests this was the flow of the liouville equation .",
    "we mostly use the free - flight conservative dynamics : @xmath46 ( this means : @xmath47 ) .",
    "let @xmath40 be a fixed coarse - graining time and suppose we have an initial quasiequilibrium distribution @xmath48 .",
    "the ehrenfests chain @xmath49 is the following sequence of quasiequilibrium distributions : @xmath50    entropy increases in the ehrenfests chain . by virtue of the conservative dynamics",
    "there is no entropy gain from the mechanical motion ( from @xmath24 to @xmath51 ) , the gain follows from the equilibration ( from @xmath51 to @xmath52 ) .",
    "consequently , conservative systems become dissipative .",
    "we wish to determine the macroscopic dynamics which passes through the points @xmath53 , @xmath54 . in general",
    ", this will depend on the parameter @xmath40 , so we seek an equation of the form @xmath55 following  @xcite we will expand this for small @xmath40 in a series @xmath56 and match terms in powers of @xmath40 to determine @xmath57 and @xmath58 .",
    "in other words , for any quasiequilibrium state @xmath48 , we wish to have @xmath59 to second - order in @xmath40 .    in phase space",
    "we have chosen free - flight dynamics @xmath60 with exact solution @xmath61 since @xmath48 is on the quasiequilibrium manifold we will replace @xmath48 with @xmath62 from now on .",
    "the second - order expansion in time for the dynamics of the distribution @xmath17 is @xmath63 thus , to second - order , @xmath64    similarly , to second - order , @xmath65 since @xmath66 , we have @xmath67    comparing the first - order terms we have @xmath68 comparing the second - order terms gives @xmath69 and , upon rearrangement , we get @xmath70 hence , to second - order , the macroscopic equations are @xmath71    in what follows , to aid the flow of the presentation , we consign some of the calculations to an appendix .",
    "now , let us look at the term @xmath72 more carefully .",
    "the first component is @xmath73    using  , the second component is @xmath74 similarly , @xmath75    finally , using  , @xmath76    hence , from   , the first - order approximation of the macroscopic dynamics is   with @xmath77 , i.e. , the euler equations .",
    "more specifically we have ( spelling out the details for the first two components ) , @xmath78    we now look at the second - order correction @xmath79 due to the computational complication of what is to follow we will only look at the first and second components of the above vector .",
    "this will give the reader a flavour of the computation .",
    "let us look at the first component .",
    "firstly , @xmath80 now , from  , @xmath81 where @xmath82 is viewed as an operator .",
    "now , @xmath83 so that @xmath84 hence , the first component of the second - order correction is zero , which we would expect as this is the equation of mass conservation .",
    "now we look at the second term in the second - order correction , and focus only on the pressure terms .",
    "to compute the correction terms for the navier - stokes equations we need to compute @xmath85 now , we have from  , @xmath86 thus , @xmath87 hence , @xmath88    on the other hand , from  , we have @xmath89    if we denote by @xmath90 the difference of the pressure terms in   and those in equations   then we obtain @xmath91    similar calculations show that the momentum terms involving the derivative of terms of the form @xmath92 all cancel .",
    "thus we have @xmath93 which is the second of the navier ",
    "stokes equations   with @xmath94 .",
    "thus we have demonstrated that , in performing an ehrenfests step after free - flight we get , to the second - order , the navier  stokes equations   with coefficient of viscosity @xmath43 .",
    "this is remarkable , because it does not involve any particular form for the collision integral in boltzmann s equation  , just free - flight and equilibration .",
    "there is of course a difficulty in simulating a navier  stokes flow where viscosity is given , with a numerical scheme in which the viscosity is directly proportional to the time step .",
    "the free - flight and equilibration scheme detailed above is such a scheme .",
    "we can write the governing equation in the form @xmath95 where @xmath96 .",
    "thus , after free - flight dynamics we move along a vector in the direction of the _ mirror point _ , @xmath97 , which is the reflection of @xmath17 in the quasiequilibrium manifold . with the bgk collision",
    "we move some part of the way along this direction .",
    "this then suggests a more general numerical simulation process @xmath98 where @xmath99 may be chosen to satisfy a physically relevant condition .",
    "a choice of @xmath100 gives the ehrenfests step with viscosity proportional to the time step @xmath101 .",
    "for @xmath102 the viscosity is even bigger .",
    "hence , in these cases the time step gives the lower boundary of viscosity we can realise .",
    "an important development in lbm was the overrelaxation step , with @xmath103  @xcite .",
    "in this case the idea is that the dynamics passes through the quasiequilibrium manifold so that the next phase of free - flight would normally take us back through the quasiequilibrium manifold . now",
    "this method , commonly called lbgk , is used for all @xmath104 from the stability interval @xmath105 $ ] . for @xmath106 viscosity",
    "goes to zero .",
    "one variant of lbgk is the so - called _ entropic _ lbm ( elbm ) @xcite in which instead of a linear mirror reflection @xmath107 an _ entropic involution _",
    "@xmath108 is used , where @xmath109 .",
    "the number @xmath110 is chosen so that the constant entropy condition is satisfied : @xmath111 .    both lbgk and elbm decouple the viscosity parameter from the time step .",
    "there are a number of other ways in which one can achieve the same goal ( see , e.g. ,  @xcite ) .",
    "we do not concern ourselves with this issue here but just remark that the essence is to construct a numerical method from the dynamics @xmath112 , then the first - order term in @xmath40 is cancelled and one obtains an order @xmath44 approximation to the euler equations .",
    "after discretization of velocity space , the additional space discretization for lbm is not necessary in the following sense : the restriction of the discrete - in - time and continuous - in - space lbm chain of free - flights and collisions on a grid is exact , if this grid is invariant with respect to parallel transitions on the vectors @xmath113 .",
    "unfortunately , as we will see in sec .  [ numer ] below",
    ", there are instabilities in the simulation with lbgk and elbm .",
    "this is because the free - flight dynamics sometimes takes us too far ( to be understood in terms of entropy ) from the quasiequilibrium manifold . in this case",
    "we apply a single ehrenfests step and return to the quasiequilibrium manifold .",
    "as you will see , this technique is capable of stabilising the method . in order to retain an order @xmath44 method ( on average ) we can only apply ehrenfests steps at a bounded number of sites .",
    "thus we fix a tolerance @xmath114 which measures the entropy deviation @xmath115 from its conditional maximum on the quasiequilibrium manifold , and then we choose the @xmath116 ( a fixed number ) most distant points with @xmath117 and return these to quasiequilibrium .",
    "if there is less than @xmath116 such points , we choose to return all of them .",
    "we call @xmath118 _ nonequilibrium entropy_.      there are several ways to define the discrete quasiequilibria @xmath119 .",
    "one of them is by the postulating of moment conditions : the moments @xmath120 and their fluxes ( moments of the next order , usually ) should coincide for the discrete quasiequilibrium and for the corresponding continuous one ( in this approach ,  continuous \" means  genuine \" ) .",
    "this is the approach used to derive the popular polynomial quasiequilibria  @xcite .",
    "another approach is based on an entropy condition : the discrete system must have its own thermodynamics and @xmath121-theorem , and the discrete quasiequilibrium should be the conditional maximum of the discrete entropy",
    ".    we would like to apply ehrenfests stabilisation ( as described at the end of the previous section ) for all sorts of quasiequilibria . but this stabiliser requires the notion of entropy . in this section ,",
    "we demonstrate how to use this entropic stabiliser for non - entropic quasiequilibria .",
    "let the discrete entropy have the standard form for ideal ( perfect ) mixtures : @xmath122 after the classical work of zeldovich  @xcite , this function is recognized as a useful instrument for the analysis of kinetic equations ( especially in chemical kinetics  @xcite ) . for applications in elbm see  @xcite .",
    "if we define @xmath62 as the conditional entropy maximum   for given @xmath123 , then @xmath124 where @xmath125 are the lagrange multipliers ( or  potentials \" ) . for this entropy and conditional equilibrium we find @xmath126 if @xmath17 and @xmath62 have the same moments , @xmath127 .",
    "the right hand side of   is ( minus ) kullback entropy  @xcite . in thermodynamics",
    ", the kullback entropy belongs to the family of massieu ",
    "kramers functions ( canonical or grandcanonical potentials ) .",
    "the estimate of nonequilibrium entropy @xmath118 can be performed for both entropic and non - entropic quasiequilibria .",
    "any quasiequilibrium ( entropic or not ) is the conditional maximum of the kullback entropy .",
    "the main difference between the kullback entropy   of the form @xmath128 and the perfect entropy   is dependence of the denominators @xmath129 on @xmath130 : @xmath131 .",
    "the perfect entropy   is a free - flight invariant , and the kullback entropy is not because of this dependence .",
    "to conclude this paper we report two numerical experiments conducted to demonstrate the performance of the proposed ehrenfests step stabilisation proposed in the previous section .",
    "the first test is a @xmath132d shock tube and we are interested in testing the ehrenfests regulariser on the lbgk and elbm simulations for small ( almost zero ) viscosity ( @xmath133 ) .",
    "we compare the lbgk simulation for the popular polynomial quasiequilibria  @xcite and for entropic quasiequilibria  @xcite , as well as elbm simulation . in each case",
    "the scheme is supplemented by ehrenfests steps in a small number @xmath116 sites with highest @xmath134 .",
    "the second test is the @xmath135d unsteady flow around a square - cylinder .",
    "the unsteady flow around a square - cylinder has been widely experimentally investigated in the literature ( see , e.g. , @xcite ) .",
    "we demonstrate that lbgk , with the ehrenfests regularisation , is capable of quantitively capturing the strouhal ",
    "reynolds relationship .",
    "the relationship is verified up to @xmath136 and compares well with okajima s experimental data  @xcite .      the @xmath132d shock tube for a compressible isothermal fluid is a standard benchmark test for hydrodynamic codes .",
    "we will fix the kinematic viscosity of the fluid at @xmath137 ( essentially zero ) .",
    "our computational domain will be the interval @xmath138 $ ] and we discretize this interval with @xmath139 uniformly spaced lattice sites .",
    "we choose the initial density ratio as @xmath140 so that for @xmath141 we set @xmath142 , otherwise we set @xmath143 .    in all of our simulations",
    "we use a lattice with spacing @xmath144 , time step @xmath145 and a discrete velocity set @xmath146 so that the model consists of static , left- and right - moving populations only . for a lattice site @xmath147 ,",
    "the neighbouring lattice sites are @xmath148 and @xmath149 .",
    "the governing equations for lbgk are then @xmath150 where the subscript @xmath25 denotes population ( not lattice site number ) and @xmath151 , @xmath152 and @xmath153 denote the static , left- and right - moving populations , respectively",
    ".    the standard polynomial quasiequilibria  @xcite are @xmath154 where we recall that @xmath155    for entropic quasiequilibria the entropy is @xmath156 , with @xmath157 ( see , e.g. ,  @xcite ) . for this entropy",
    "the quasiequilibrium is available explicitly : @xmath158    for our realisation of the ehrenfests regularisation , which is intended to keep states uniformly close to the quasiequilibrium manifold , we monitor nonequilibrium entropy @xmath118 at every lattice site throughout the simulation .",
    "if a pre - specified threshold value @xmath114 is exceeded , then an ehrenfests step is taken at the corresponding site .",
    "now , the governing lbgk equations become : @xmath159 we select the @xmath116 sites with highest @xmath160 so that the ehrenfests steps are not allowed to degrade the accuracy of lbgk .    for elbm ,",
    "entropic quasiequilibria are always employed and the governing equation is @xmath161 this equation differs from lbgk by the introduction of a parameter @xmath162 which is selected to satisfy the constant entropy condition : @xmath163 this is a nonlinear equation for @xmath162 which we solve , using the bisection method , to an accuracy of @xmath164 ( see  @xcite for further details of the implementation ) . supplementing elbm with ehrenfests steps is the same as for lbgk .    we observe that the ehrenfests stabilisation recipe is capable of subduing spurious post - shock oscillations whereas lbgk fails in this respect ( fig .  [ shocktube ] ) . in the example",
    "we have considered a fixed tolerance of @xmath165 . of course , we note also that the smaller the tolerance @xmath114 the more smoothing we have of the shock . therefore we reiterate that it is important for ehrenfests steps to be employed at only a small proportion of the sites .     time steps using ( a ) lbgk with polynomial quasiequilibria   [ @xmath166 ; ( b ) lbgk with entropic quasiequilibria   [ @xmath167 ; ( c ) elbm   [ @xmath167 ; ( d ) lbgk with polynomial quasiequilibria   [ @xmath137 ] ; ( e ) lbgk with entropic quasiequilibria   [ @xmath137 ] ; ( f ) elbm   [ @xmath137 ] ; ( g ) lbgk with polynomial quasiequilibria and ehrenfests steps   [ @xmath137 , @xmath165 ] ; ( h ) lbgk with entropic quasiequilibria and ehrenfests steps   [ @xmath137 , @xmath165 ] ; ( i ) elbm with ehrenfests steps [ @xmath137 , @xmath165 ] . sites where ehrenfests steps are employed are indicated by crosses.[shocktube],title=\"fig:\",width=415 ] +    we do not detect any advantage of using elbm over lbgk with entropic quasiequilibria for this example . however , there appears to be some gain in employing entropic rather than polynomial quasiequilibria .",
    "we observe that the post - shock region for the unregularised lbgk simulations is more oscillatory when polynomial quasiequilibria are used . in fig .",
    "[ shocktube ] we have also included a panel with the simulation resulting from a much higher viscosity ( @xmath170 ) . here",
    ", we observe no appreciable differences in the results of lbgk and elbm .",
    "our second test is the @xmath135d unsteady flow around a square - cylinder .",
    "the realisation of lbgk that we use will employ a uniform @xmath171-speed square lattice with discrete velocities @xmath172 the numbering @xmath48 , @xmath173 are for the static , east- , north- , west- , south- , northeast- , northwest- , southwest- and southeast - moving populations , respectively . here , we select entropic quasiequilibria by maximising the entropy functional @xmath174 subject to the constraints of conservation of mass and momentum  @xcite : @xmath175 here , the _ lattice weights _ , @xmath176 , are given lattice - specific constants : @xmath177 , @xmath178 and @xmath179 .",
    "as is usual , the macroscopic variables are given by the expressions @xmath180    the computational set up for the flow is as follows .",
    "a square - cylinder of side length @xmath7 , initially at rest , is emersed in a constant flow in a rectangular channel of length @xmath181 and height @xmath182 . the cylinder is place on the centre line in the @xmath183-direction resulting in a blockage ratio of @xmath184% .",
    "the centre of the cylinder is placed at a distance @xmath185 from the inlet .",
    "the free - stream fluid velocity is fixed at @xmath186 ( in lattice units ) for all simulations .    on the north and south channel walls a free - slip boundary condition",
    "is imposed ( see , e.g. ,  @xcite ) . at the inlet ,",
    "the inward pointing velocities are replaced with their quasiequilibrium values corresponding to the free - stream fluid velocity . at the outlet ,",
    "the inward pointing velocities are replaced with their associated quasiequilibrium values corresponding to the velocity and density of the penultimate row of the lattice .",
    "some care should to be taken with the boundary conditions on the cylinder , but for more information on these the reader may consult , e.g. ,  @xcite .      as a test of the ehrenfests regularisation , a series of simulations , all with characteristic length fixed at @xmath187 , were conducted over a range of reynolds numbers the parameter pair @xmath188 , which control the ehrenfests steps tolerances , are fixed at @xmath189 .",
    "we are interested in computing the strouhal  reynolds relationship .",
    "the strouhal number @xmath190 is a dimensionless measure of the vortex shedding frequency in the wake of one side of the cylinder : @xmath191 where @xmath192 is the shedding frequency .    for our computational set up ,",
    "the vortex shedding frequency is computed using the following algorithmic technique .",
    "firstly , the @xmath147-component of velocity is recorded during the simulation over @xmath193 time steps .",
    "the monitoring points is positioned at coordinates @xmath194 ( assuming the origin is at the centre of the cylinder ) .",
    "next , the dominant frequency is extracted from the final @xmath195% of the signal using the discrete fourier transform .",
    "the monitoring point is purposefully placed sufficiently downstream and away from the centre line so that only the influence of one side of the cylinder is recorded .        the computed strouhal ",
    "reynolds relationship using the ehrenfests regularisation of lbgk is shown in fig .",
    "the simulation compares well with okajima s data from wind tunnel and water tank experiment  @xcite .",
    "the present simulation extends previous lbm studies of this problem  @xcite which have been able to quantitively captured the relationship up to @xmath196 .",
    "[ sqcy ] also shows the elbm simulation results from  @xcite .",
    "furthermore , the computational domain was fixed for all the present computations , with the smallest value of the kinematic viscosity attained being @xmath197 at @xmath136 .",
    "it is worth mentioning that , for this characteristic length , lbgk exhibits numerical divergence at around @xmath198 .",
    "we estimate that , for the present set up , the computational domain would require at least @xmath199 lattice sites for the kinematic viscosity to be large enough for lbgk to converge at @xmath136 .",
    "this is compared with @xmath200 sites for the present simulation .",
    "this work is supported by engineering and physical sciences research council ( epsrc ) grant number gr / s95572/01 .",
    "the authors acknowledge i.  v.  karlin for important discussions , s.  chikatamarla for kindly providing the digitally extracted data used in fig .",
    "[ sqcy ] and anonymous referee for valuable comments .",
    "in this appendix we calculate the moments of the distribution @xmath62 so as to keep the presentation in the main body of the paper clean .",
    "all integrals are over the whole velocity space .",
    "firstly , we have by definition @xmath201    next , we have @xmath202 now , using the identity @xmath203 it follows by a change of variables that , for @xmath204 , @xmath205 further , it follows from the identity @xmath206 that @xmath207 hence , from  , we have @xmath208                                a.  n. gorban . basic types of coarse - graining . in : a.",
    "n. gorban , n.  kazantzis , i.  g. kevrekidis , h .- c .",
    "ttinger , and c.  theodoropoulos , editors , _ model reduction and coarse - graining approaches for multiscale phenomena _ , pages 117176 .",
    "springer , berlin - heidelberg - new york , 2006 .",
    "cond - mat/0602024 .",
    "a.  gorban , b.  kaganovich , s.  filippov , a.  keiko , v.  shamansky , i.  shirkalin , _ thermodynamic equilibria and extrema : analysis of attainability regions and partial equilibrium _ , springer , berlin , heidelberg , new york , 2006 ( in press ) .",
    "y.  b.  zeldovich , proof of the uniqueness of the solution of the equations of the law of mass action , in : _ selected works of yakov borisovich zeldovich , _ vol . 1 , j.  p.  ostriker ( ed . ) , princeton university press , princeton , usa , 1996 , 144148 ."
  ],
  "abstract_text": [
    "<S> the navier  stokes equations arise naturally as a result of ehrenfests coarse - graining in phase space after a period of free - flight dynamics . </S>",
    "<S> this point of view allows for a very flexible approach to the simulation of fluid flow for high - reynolds number . </S>",
    "<S> we construct regularisers for lattice boltzmann computational models . </S>",
    "<S> these regularisers are based on ehrenfests coarse - graining idea and could be applied to schemes with either entropic or non - entropic quasiequilibria . </S>",
    "<S> we give a numerical scheme which gives good results for the standard test cases of the shock tube and the flow past a square cylinder . </S>"
  ]
}