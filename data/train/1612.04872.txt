{
  "article_text": [
    "gravitational lensing is the deflection of light from a distant source by intervening massive objects , resulting in magnification or de - magnification of images . in some regions , areas of high magnification ( caustics )",
    "are formed . by measuring this magnification , observers passing through these caustics may be able to determine properties of the lens or source .",
    "modelling these phenomena is computationally expensive , particularly for ` ray shooting ' methods which deflect individual rays , then identify where these rays intersect with the source plane ( or the observer s plane ) , and finally calculate the magnification factor by counting the number of rays which intersect each small area ( or pixel ) in the plane .",
    "several sophisticated methods have been developed which greatly improve the efficiency of this procedure ( for example , see @xcite , @xcite and @xcite ) .",
    "also , techniques which make use of parallel processing have been developed to reduce the time required for generating these magnification maps ( for example , see @xcite and @xcite ) .    in this note",
    ", we present an alternative ray shooting method for drawing magnification maps . for each ray emitted by the source",
    ", we will derive an expression for its location at the target as the end point of a straight line segment plus a small correction due to each lens in the system .",
    "this will be done using a linearized solution to the schwarzschild path equations , and we will approximate the solution to first order in the small parameter @xmath0 , the schwarzschild radius of the lens .",
    "this assumes that @xmath0 is small relative to any other lengths appearing in the equation , principally the distances of closest approach of the ray to the lenses .",
    "this linearized solution has been shown to be a good approximation to the full ( non - linear ) geodesic equations in @xcite .",
    "the present approach does not claim to be faster to run than existing methods .",
    "however , it has the advantage that any lens can be easily modelled by simple combination of point masses .",
    "the code included in the appendix loops through a list of masses , adding up the perturbation due to each mass . adding any additional lensing object is merely the inclusion of an item in the list , specifying the object s @xmath1 and @xmath2 co - ordinates and its mass .",
    "the transparency and versatility of this approach will be demonstrated by the modelling of various lens configurations .",
    "in order to apply a fully consistent first order approximation to a ray passing by several lenses , we begin with the first order path equations derived from the acceleration vector for a massless test particle in the gravitational field of a massive lens located at the origin ( see @xcite ) .",
    "these are :    @xmath3    where @xmath0 is the schwarzschild radius of the lens , @xmath4 is the square of the impact parameter , and @xmath5 is the normal position vector , and @xmath6 is the distance from the origin .",
    "the dot - notation refers to differentiation by the proper time parameter , @xmath7 . using a first order expansion in @xmath0 , we approximate the light path as    @xmath8    where the zeroth order components ( straight lines ) are given by @xmath9 and the first order corrections are @xmath10    in these equations , @xmath11 is the distance at ` time ' @xmath7 from the lens mass to the point where the test particle would be if it were not deflected ( that is , in a straight line path from the source ) .",
    "the constants @xmath12 to @xmath13 are determined by initial conditions , and the constant @xmath14 .",
    "these equations are for a lens mass located at the origin . in the current study , it is convenient to place the source , rather than the lens , at the origin , as this will allow us easily to include more than one lens mass .",
    "we will specify that the ray leaves the origin at @xmath15 . in this case ,",
    "@xmath16 , and the zeroth order terms simplify to    @xmath17    and the first order corrections are now @xmath18 the new constants @xmath19 and @xmath20 are the co - ordinates of the massive lens ( with subscript @xmath21 for mass ) , and the other terms relating to this mass are given by @xmath22 as we have specified that the light ray leaves the origin at @xmath15 , equations ( [ xyz1b ] ) are zero at that time .",
    "solving defines three of the constants as : @xmath23    by also specifying that the ray leaves the origin at some trajectory @xmath24 , where @xmath25 is the azimuthal angle and @xmath26 is the inclination angle above the @xmath27 plane , along with the speed constraint equation , @xmath28 ( see @xcite ) , we can solve for the other constants as follows : @xmath29    substituting these constants into the first order corrections ( [ xyz1 ] ) and then into the path equations ( [ xyz1 ] ) we have the general path equations for rays leaving the origin at @xmath15 in a system containing a single lensing object :    @xmath30+o(r_s^2 ) \\nonumber \\\\",
    "y&=&c_3\\tau+\\frac{r_s}{2}\\bigg[c_3\\bigg(\\frac{\\tau}{r_0}-\\frac{b_m}{k_m}p\\bigg)+y_m q\\bigg]+o(r_s^2 ) \\nonumber \\\\",
    "z&=&c_5\\tau+\\frac{r_s}{2}\\bigg[c_5\\bigg(\\frac{\\tau}{r_0}-\\frac{b_m}{k_m}p\\bigg)+z_m q\\bigg]+o(r_s^2 ) \\nonumber\\end{aligned}\\ ] ]    where @xmath31 and @xmath32 have been introduced for readability .",
    "the correction to the straight line path is given above , accurate to first order in the small variable @xmath0 , which serves as a surrogate for the mass of the lensing object , since @xmath33 where @xmath34 is the mass of the lens , @xmath35 is newton s constant and @xmath36 is the speed of light . in this paper",
    "we are using geometrized units , that is @xmath37 , unless noted otherwise .",
    "the correction due to additional lensing masses may now be easily included .",
    "as the approach undertaken here has been one of linearisation of the path equations , the superposition principle holds , and the change to the path is the sum of corrections for each mass . to clarify , this comes about by making the assumption that summation of acceleration components will be accurate at least to first order in @xmath0 .",
    "explicitly , we are saying that the acceleration due to @xmath38 massive objects is : @xmath39 where the sum is over all the massive bodies in the system , each with its own value for mass ( @xmath0 ) , square of the angular momentum of the light ray about the mass ( @xmath4 ) and position of the particle relative to the mass ( @xmath5 ) .",
    "we now have the first order path equations for @xmath1 and @xmath2 .",
    "this enables us to solve for @xmath7 to first order in @xmath0 , for various observer locations .",
    "we can then solve the equations for that value of @xmath7 to determine the @xmath1 and @xmath2 values at the observer s location .",
    "this procedure will be illustrated in this paper by solving for an observer sphere and for an observer plane .      in order to evaluate the intersection of light rays with some outer sphere ,",
    "centred on the source , we specify that the ray meets a sphere of radius @xmath40 at some ` time ' @xmath7 .",
    "that is , let @xmath41 , and solve the following equation for @xmath42 and @xmath43 : @xmath44 the solution of this equation leads to the following zeroth - order and first - order components of @xmath7 : @xmath45 where @xmath46 is the distance from the lens to the observer . substituting in this value of @xmath7 ,",
    "the values of @xmath1 and @xmath2 at the sphere can be calculated , given an initial trajectory ( @xmath47 ) .",
    "after some simplification , these final values may be written : @xmath48 in which @xmath49    we are now in a position to plot the points where rays from a star at the centre of an observer s sphere intersect with that sphere .",
    "[ fig1 ] shows the points due to a central source , with a massive lens ( @xmath50 ) located at ( 20,0,0 ) , and a secondary lens ( @xmath51 ) located at ( 20,11.8,0 ) . for clarity ,",
    "the rear part of the sphere has not been plotted .",
    "+ [ fig1 ]      solving for the magnification on a plane surface follows a similar procedure . in this case",
    ", we will solve for a plane which is perpendicular to the @xmath52-axis .",
    "this does not involve any loss of generality , as the axes can be arbitrarily positioned , each lensing object having its own @xmath1 and @xmath2 co - ordinates . setting the final @xmath52-position of the ray to a constant , @xmath53 , we solve for @xmath7 and then @xmath54 and @xmath2 in a similar way to that in section [ sectionsphere ] above to obtain :",
    "@xmath55    where @xmath56    using these formulae , points can be plotted on the observer s plane . beginning with an array of regularly spaced rays leaving the source , the final position is calculated .",
    "a magnification map can be produced by counting the number of points within each small area of the observer s plane . in fig .",
    "[ fig2 ] , a source is placed at the origin , a primary mass with @xmath57 is at ( 20,0,0 ) and a secondary mass is at ( 20,0.9,0 ) with @xmath58 .",
    "the intersection of each ray with a plane at @xmath59 has been calculated and a smooth binning routine @xcite has been used to assign a colour based on number of points in each bin .    to simulate a many body system ,",
    "16 masses have been placed near @xmath60 , using a random number generator to ensure their @xmath54 co - ordinates lay in the interval @xmath61 , and their @xmath2 co - ordinates lay in @xmath62 , as may be seen from the matlab code in the appendix .",
    "the magnification map resulting from the code provided in the appendix is shown in fig .",
    "it clearly consists of many caustic patterns , due to the 16 masses .",
    "+ [ fig2 ]     + [ fig3 ]    a simulation of an elliptical galaxy has been developed to produce the caustic plot in fig .",
    "two hundred thousand masses have been placed randomly in an elliptical structure with an inverse squared density .",
    "the elliptical shape breaks the spherical symmetry and produces the diamond - shaped caustic pattern . for this figure",
    "the lens approximates the central bar of the lensing galaxy in the einstein cross ( @xcite , @xcite ) . the lens - source and lens - observer distances",
    "have also been set to correspond to the einstein cross . with the point source at the origin ,",
    "the lensing galaxy is placed at 7600 , and the observer s plane is at 8000 .",
    "all distances are in millions of light years .",
    "the lensing galaxy has a mass of @xmath63 solar masses , and a height of @xmath64 arcminutes as seen from the observer s plane by an observer on the optical axis .",
    "a path through the caustic has been chosen , and the corresponding light curve is shown below the magnification map . in the lower image , a structure of @xmath65 solar masses has been added .",
    "the small deviation can be seen in the magnification map and in the corresponding light curve below it .",
    "computational time for this procedure is proportional to the number of rays multiplied by the number of lensing masses . for the elliptical galaxy with @xmath66 stars ,",
    "an array of @xmath67 light rays was used .",
    "the running time for each of these maps on a desktop pc ( core i7 ) with four cores was @xmath68 hours .",
    "solar masses .",
    "distances are in millions of light years . in the lower half of the figure , an additional substructure of @xmath65 solar masses has been added .",
    "the magnification map and corresponding light curve show a small deviation due to this substructure.,title=\"fig : \" ] +   solar masses .",
    "distances are in millions of light years . in the lower half of the figure , an additional substructure of @xmath65 solar masses has been added .",
    "the magnification map and corresponding light curve show a small deviation due to this substructure.,title=\"fig : \" ] +   solar masses .",
    "distances are in millions of light years . in the lower half of the figure , an additional substructure of @xmath65 solar masses has been added .",
    "the magnification map and corresponding light curve show a small deviation due to this substructure.,title=\"fig : \" ] +   solar masses .",
    "distances are in millions of light years . in the lower half of the figure , an additional substructure of @xmath65 solar masses has been added .",
    "the magnification map and corresponding light curve show a small deviation due to this substructure.,title=\"fig : \" ] + [ fig4 ]",
    "this short paper has presented a new method for generating magnification patterns due to the gravitational effects of massive objects on light rays from a source .",
    "an algorithm has been described for solving the linearised first order path equations for rays from the origin passing through a lens and intersecting with a viewing surface .",
    "this general algorithm has been illustrated by solutions for two simple viewing surfaces , a sphere surrounding the source , and a plane .",
    "once the solution has been derived for the linearised path equations , the final locations for an initial array of light rays can be found by first calculating the value of the time parameter at the observer s location , and from that , the small deviations due to each mass in the system can be obtained .",
    "as the path equations have been linearised , the superposition principle holds and the total deflection can be found as the sum of the deflections due to each of the massive objects .",
    "this makes it simple to add many lensing objects to the system .",
    "it is hoped that the method and code presented here may be helpful for quickly identifying the magnification patterns for any desired lens configuration .",
    "an interesting area of future research would be to solve the equations for incoming angle at the observer s position rather than for position over the observer s plane .",
    "this would allow a modelling of macro - lensing effects , and reproduction of the observer s view of the einstein cross at a single point , rather than of the spatially extended magnification map .    a further modification would be to generate light curves which reflect the motion of the lensing objects over the time period , in the case where there is significant change in configuration of the lens during the traversal of the magnification map . in the approach covered in this note , this presents a significant challenge , as it involves continually creating new sections of the magnification map as the lens configuration changes .",
    "the authors gratefully acknowledge the financial support for this work provided by australian research council discovery grant dp140100094 .",
    "the authors are also indebted to dr l. wyrzykowski for helpful comments on an earlier draft of this paper .",
    "bate n. f. , fluke c. j. , barsdell b. r. , garsden h. , & lewis g. f. 2010 , new astronomy , 15(8 ) , 726 - 734 .",
    "huchra j. , gorenstein m. , kent s. , shapiro i. , smith g. , horine e. , and perley r. 1985 , the astronomical journal , 90 , 691 - 696 .",
    "lewis g. f. , miralda - escud j. , richardson d. c. , and wambsganss j. 1993 , mon . not .",
    "r. astron .",
    "soc , 261(3 ) , 647 - 656 .",
    "mediavilla e. , mediavilla t. , muoz j. a. , ariza o. , lopez p. , gonzalez - morcillo c. , & jimenez - vicente j. 2011 apj 741(1 ) , 42 .",
    "metcalf r. b. , & petkova m. 2014 , mon . not .",
    "r. astron .",
    "soc , 445(2 ) , 1942 - 1953 .",
    "perkins p. 2006",
    ", matlab central file exchange , http://www.mathworks.com.au/matlabcentral/ fileexchange/13352-smoothhist2d .",
    "thompson a. c. , fluke c. j. , barnes d. g. , & barsdell , b. r. 2010 , new astronomy , 15(1 ) , 16 - 23 .",
    "walters s.j . &",
    "forbes l.k .",
    "2011 , mon . not .",
    "r. astron .",
    ", vol 416 , issue 4 , 3067 - 3074 .",
    "walters s.j . &",
    "forbes l.k . , 2014 ,",
    "mon . not .",
    "r. astron .",
    "vol 444 , issue 3 , 2470 - 2486",
    ".    wambsganss j. & paczynski b. 1994 , the astronomical journal 108 , 1156 - 1162 .",
    "the code presented here is a very basic implementation of the planar solution described in the text .",
    ".... % set up an array of rays large enough to cover the % target area .",
    "this rectangular array is a suitable % approximation for an isotropically emitting % source near the optical axis , but more care is % required if plotting further out . xf=2000 ;   % observer plane at x=2000 yf0=390 ; yf2=590 ; zf0=-100 ; zf2=105 ; gy=500 ;   % number of points in y - direction gz=500 ;   % number of points in z - direction yf = linspace(yf0,yf2,gy ) ; zf = linspace(zf0,zf2,gz ) ;      % set up meshgrid of rays and their initial % velocity components y = ndgrid(yf , zf ) ' ; z = ndgrid(zf , yf ) ; r = sqrt((xf^2+y.^2+z.^2 ) ) ; c3=y./r ; c5=z./r ; c1=sqrt(1-c3.^2-c5.^2 ) ; % set up array of lensing object locations and % masses ( x , y , z , mass ) masses= [     20.0000     4.3334    -0.5146     0.0001     20.0000     4.2860     0.2038     0.0007     20.0000     4.2442    -0.0532     0.0005     20.0000     4.7654     0.7264     0.0002     20.0000     4.7766    -0.0858     0.0008     20.0000     4.3825     0.7482     0.0008     20.0000     5.0801    -0.6292     0.0002     20.0000     4.5315     0.1704     0.0008     20.0000     5.0130    -0.4282     0.0003     20.0000     5.0609     0.2037     0.0004     20.0000     4.9703    -0.5343     0.0003     20.0000     5.5696     0.0963     0.0009     20.0000     5.4713    -0.7395     0.0007     20.0000",
    "4.3961     0.5765     0.0002     20.0000     4.4599    -0.4150     0.0001",
    "20.0000     5.3170     0.2771     0.0009 ] ; [ n,~]=size(masses ) ; % number of lensing masses % pre - allocate space for storing first order % corrections yrs = zeros(size(y ) ) ; zrs = yrs ; % calculate first order deviations due to each mass for i=1:n ;      xn = masses(i,1 ) ;      yn = masses(i,2 ) ;      zn = masses(i,3 ) ;      mn = masses(i,4 ) ;           rn = sqrt(xn^2 + yn^2 + zn^2 ) ;      bn = -(c1*xn+c3*yn+c5*zn ) ;      kn = rn^2 - bn.^2 ;      rf = sqrt(xf^2+c1.^2*rn^2 + 2*xf*c1.*bn ) ;      f = 1/rn - c1./rf-(2*rn)./kn+(2*rf)./(c1.*kn )        -(2*xf*bn)./(c1.*kn*rn)-(xf*bn)./(c1*rn^3 ) ;           yrs = yrs+mn/2*(yn - c3*xn./c1).*f ;      zrs = zrs+mn/2*(zn - c5*xn./c1).*f ; end % final locations equal straight line plus sum of % corrections yy = c3*xf./c1+yrs ;   zz = c5*xf./c1+zrs ; % sort the data points into two columns for y and z % for plotting data = reshape(cat(3,yy , zz),[gy*gz,2,1 ] ) ; % for display , only keep the points falling within % the desired target area datanew= [ ] ; for k=1:gy*gz      if data(k,1)>yt0          if data(k,1)<yt2              if data(k,2)>zt0                  if data(k,2)<zt2                      datanew = cat(1,datanew , data(k , : ) ) ;                  end              end          end      end end % plot the data as a coloured density plot figure(1 ) clf smoothhist2d(datanew,5,[900 , 900],0,'image ' ) ; set(gca,'ydir','normal ' ) ; ...."
  ],
  "abstract_text": [
    "<S> in this brief communication a new method is outlined for modelling magnification patterns on an observer s plane using a first order approximation to the null geodesic path equations for a point mass lens . for each ray emitted from a source , </S>",
    "<S> an explicit calculation is made for the change in position on the observer s plane due to each lens mass . by counting the number of points in each small area of the observer s plane , the magnification at that point can be determined . </S>",
    "<S> this allows for a very simple and transparent algorithm . a short matlab code sample for creating simple magnification maps due to multiple point lenses is included in an appendix .    </S>",
    "<S> gravitational lensing : micro , planets and satellites : detection , methods : analytical , methods : numerical . </S>"
  ]
}