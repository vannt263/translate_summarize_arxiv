{
  "article_text": [
    "hydrodynamical and microphysical processes of baryonic matter play an important role in structure formation at the smaller sub  cluster scales . indeed , microphysics can play a more important role than gravity , especially when the cooling time of the gas is much shorter than the dynamical or hubble times .",
    "protogalactic clouds , which may form , for example , at high redshifts in cdm models can collapse through cooling instabilities to form an early generation of stars .",
    "the feedback from primordial stars can change the physical state of the pre  galactic medium and thus have considerable influence over the subsequent formation of stars and galaxies and the general state of the intergalactic medium ( couchman & rees 1986 ; tegmark et al .",
    "microphysical processes are also very important at the center  most regions of cosmological sheets or pancakes",
    ". originally studied by zeldovich ( 1970 ) in the context of neutrino - dominated cosmologies , sheets are ubiquitous features in nonlinear structure formation simulations of cdm - like models with gas , and manifest on a spectrum of length scales and formation epochs .",
    "cooling processes occur on very short time scales at the center  most densest parts of the pancake structures where stars and galaxies can form from the fragmentation of the gas .",
    "( bond et al .",
    "1984 ; shapiro & struck  marcell 1985 ; yuan , centrella & norman 1991 ; anninos & norman 1996 ) .",
    "it is well known that when nonequilibrium atomic reactions are properly taken into account , the cooling time can be shorter than the hydrogen recombination time and that gas which cools to @xmath9 will likely cool faster than it can recombine .",
    "the effect of this nonequilibrium cooling is to leave behind a greater residual of free electrons and ions , as compared to the equilibrium case .",
    "the free electrons can be captured by neutral hydrogen to form @xmath5 that subsequently produce hydrogen molecules .",
    "if large concentrations of molecules can form , the cooling is dominated by the vibrational / rotational modes of molecular hydrogen which acts to efficiently cool the gas to about @xmath10 , thereby reducing the jeans mass of the gas .",
    "hydrogen molecules can therefore play a crucial role in the formation of stars as they provide the means for cloud fragments to collapse and dissipate their energy .    however , the typically high computational requirements and technical difficulties needed to solve the chemical rate equations relevant for @xmath7 production in hydrodynamic flows have forced previous authors to impose simplifying assumptions such as the steady state shock condition which reduces the problem to zero dimension . in this case , only the time development of the hydrodynamic and thermodynamic variables are solved ( izotov & kolesnick 1984 ; maclow & shull 1986 ; shapiro & kang 1987 ; kang & shapiro 1992 ) .",
    "all of these studies have consistently found that the mass fraction of @xmath7 can reach @xmath11 behind sufficiently strong shocks , which is adequate to cool the gas to temperatures of order @xmath10 well within a hubble time .",
    "more recently haiman , thoul & loeb ( 1995 ) have investigated the formation of low mass objects in one  dimensional numerical calculations .",
    "they confirm the importance of @xmath7 in the collapse of spherically symmetric isolated objects at high redshifts .",
    "although much insight has been gained about the chemical aspects of molecular hydrogen formation and cooling , it remains to incorporate chemical reaction flows in realistic cosmological models .",
    "this paper discusses a method that we have developed for solving the kinetic rate equations with multi  species chemistry in nonequilibrium and self  consistently with the hydrodynamic and @xmath12body equations in an expanding flrw universe .",
    "the method is based on a backward differencing formula ( bdf ) for the required stability when solving stiff sets of equations , and is designed for both accuracy but especially speed so that it may be used in three dimensional codes with a minimal strain on computational resources . in all , we solve for 28 kinetic reactions including collisional and radiative processes for nine different species : @xmath13 , and @xmath8 , which we track individually with their unique mass transport equations .",
    "we have also implemented a comprehensive model for the radiative cooling of the gas that includes atomic line excitation , recombination , collisional ionization , free - free transitions , molecular line excitations , and compton scattering of the cosmic background radiation by electrons .",
    "the set of hydrodynamic , @xmath12body , kinetic and cosmological equations that we solve are summarized in ",
    "[ sec : equations ] .",
    "section [ sec : numerical ] discusses the bdf method and its integration into the hydrodynamic solver .",
    "several tests of our code are presented in ",
    "[ sec : codetests ] , including 1d radiative shock waves , 2d cosmological sheets , and fully 3d simulations of cdm cosmological evolutions in which we compare the bdf method to results obtained when the packaged routine lsodar ( hindmarsh 1983 ; petzold 1983 ) is substituted in its place .",
    "we provide concluding remarks in  [ sec : summary ] .",
    "finally we note that a companion paper has been written which discusses the chemical model and cooling functions in more detail ( abel et al .",
    "1996 ) . in that paper",
    ", we motivate the model and argue its comprehensive nature in the choice of reactions , insofar as the formation of hydrogen molecules in cosmological environments is concerned .",
    "we also provide more up  to  date and accurate fits to the different rate coefficients . for completeness ,",
    "we tabulate the reaction list and cooling processes in appendices a and b of this paper , but leave the rate coefficients to abel et al .",
    "the hydrodynamical equations for mass , momentum and energy conservation in an expanding frw universe with comoving coordinates are @xmath14 @xmath15      + 5{\\frac{\\dot{a}}{a}}{\\rho_b}{{v}_{b , i } }      = - { \\frac{1}{a^2}}{\\frac{\\partial p}{\\partial x_i } }        - { \\frac{\\rho_b}{a^2}}{\\frac{\\partial \\phi}{\\partial x_i } } , \\label{hydromom}\\ ] ] @xmath16 where @xmath17 , @xmath18 and @xmath19 are the baryonic density , pressure and specific internal energy defined in the proper reference frame , @xmath20 is the comoving peculiar baryonic velocity , @xmath21 is the comoving gravitational potential that includes baryonic plus dark matter contributions , @xmath22 is the cosmological scale factor , and @xmath23 and @xmath24 are the microphysical cooling and heating rates .    the equations for collisionless dark matter in comoving coordinates are @xmath25 the baryonic and dark matter components are coupled through poisson s equation for the gravitational potential @xmath26 where @xmath27 is the total density and @xmath28 is the proper background density of the universe .",
    "the cosmological scale factor @xmath29 is given by einstein s equation @xmath30^{1/2}\\ ] ] where @xmath31 is the density parameter including both baryonic and dark matter contributions , @xmath32 is the density parameter attributed to the cosmological constant @xmath33 , and @xmath34 is the present hubble constant .",
    "in addition to the usual hydrodynamic equations ( [ hydromass ] )  ( [ hydroenergy ] ) , we must also solve equivalent mass conservation equations for the densities @xmath35 of each of the nine separate atomic and molecular species that we track @xmath36 where the signs of each term on the right  hand  side depend on whether the process creates or destroys the species @xmath35 .",
    "the @xmath37 are rate coefficients for the two body reactions and are functions of the gas temperature @xmath38 .",
    "explicit analytic fits for these coefficients over a broad range of temperatures , and a general discussion of the relevant chemical reactions , can be found in abel et al .",
    "( 1996 ) . in all",
    ", we include 28 rate coefficients , one for each of the chemical reactions shown in appendix a. the @xmath39 in equation ( [ hydrospecies ] ) are integrals due to photoionizations and photodissociations @xmath40 where @xmath41 is the intensity of the radiation field , @xmath42 is the flux , @xmath43 are the cross - sections for the photoionization and photodissociation processes , and @xmath44 are the frequency thresholds for the respective processes .",
    "we note that the nine equations represented by ( [ hydrospecies ] ) are not all independent . the baryonic matter is composed of hydrogen and helium with a fixed primordial hydrogen mass fraction of @xmath45 .",
    "hence we have the following three conservation equations @xmath46 where @xmath47 is the number density of free electrons and @xmath48 the proton mass .    to complete the set of equations ( [ hydromass ] )  ( [ hydroenergy ] )",
    ", we must also specify the equation of state appropriate for an ideal gas @xmath49 where @xmath50 is the ratio of specific heats for the baryonic matter , @xmath51 is boltzmann s constant , @xmath38 is the gas temperature , and @xmath52 are the number densities for each of the different species .",
    "we also need to provide the necessary cooling @xmath23 and heating @xmath24 functions to the right - hand - side of equation ( [ hydroenergy ] ) @xmath53 where @xmath54 is the compton cooling ( or heating ) due to interactions of free electrons with the cosmic microwave background radiation , and @xmath55 are the cooling rates from two - body interactions between species @xmath56 and @xmath57 .",
    "the @xmath58 are integrals due to photoionizing and photodissociating heating @xmath59 we include a total of fourteen processes in the cooling function and three processes for heating . the physical mechanisms and mathematical expressions for each process are given in appendix b.",
    "it is well known that the differential equations describing non - equilibrium atomic and molecular rate reactions can exhibit variations on extreme time scales .",
    "characteristic creation and destruction scales can differ by many orders of magnitude among the different species and reactions . as a result , explicit schemes for integration can be unstable unless unreasonably small time steps ( smaller than the shortest dynamical times in the reaction flow ) are taken , which makes any multi - dimensional computation prohibitively expensive . for this reason implicit methods are preferred for stiff sets of equations .",
    "these methods generally involve a newton s iterative procedure to achieve convergence , and for large dimensional jacobian matrices these implicit methods can also be very time consuming .",
    "a number of packaged routines exist which are based on identifying the disparity in time scales among the species and switching between stiff and nonstiff solvers .",
    "an example of such a package is the livermore solver for ordinary differential equations with automatic method switching for stiff and nonstiff problems lsodar ( hindmarsh 1983 ; petzold 1983 ) .",
    "however , an implementation of this solver in multi - dimensions is extremely costly in computer time and an alternative numerical scheme is desirable for fully three - dimensional calculations where computational speed is crucial .",
    "we use an operator and directional splitting of the hydrodynamic equations ( [ hydromass ] )  ( [ hydroenergy ] ) and ( [ hydrospecies ] ) to update the fourteen state variables @xmath17 , @xmath60 , @xmath19 and @xmath35 .",
    "six basic steps are utilized .",
    "first , the source step accelerates the fluid velocity due to pressure gradients and gravity , and modifies the velocity and energy equations to account for artificial viscosity @xmath61 where @xmath62 is a second rank tensor representing the artificial viscous stresses ( stone & norman 1992 ) .",
    "a staggered mesh scheme is utilized whereby the scalar variables @xmath17 , @xmath35 , @xmath19 , @xmath21 and the artificial viscosity are zone centered , while the velocities are located at the zone interfaces . the pressure ,",
    "potential , and viscosity gradients are thus naturally aligned with the momentum terms .    in the second cooling / heating step ,",
    "the energy changes are computed from `` pdv '' work and radiative cooling and heating from microphysical processes @xmath63 we discuss solving this equation further in the following subsection .",
    "the third expansion step updates all state variables from the terms arising from the expansion of the universe @xmath64 the homogeneous nature of the expansion allows a simple solution @xmath65 , although a more generalized procedure is required for the energy equation in which an effective adiabatic index must be defined to eliminate the pressure term in the case of ionized gas ( anninos & norman 1994 ) .",
    "the fourth or transport step solves the advection terms @xmath66 several different monotonic schemes have been implemented , including donor cell , van leer , and piecewise parabolic advection .",
    "all results presented here use the second order van leer method which has the best accuracy - to - efficiency performance .",
    "a fifth step evolves the densities of the separate species according to the chemistry of the collisional and radiative kinetic equations @xmath67 the methods for solving these equations is the focus of the next subsection .",
    "the total baryonic density @xmath17 and the density of each individual species @xmath35 are updated independently in the expansion , transport and chemistry steps .",
    "we are thus able to monitor the accuracy of our methods by evaluating the constraint equations for hydrogen , helium and charge conservation , equations ( [ conserveh ] )  ( [ conservene ] ) .",
    "over the course of a typical 3d calculation of approximately one - thousand time steps , we find _ maximum _ errors , which are mostly concentrated at the shock fronts , to be of order 10 to 30% .",
    "however , for increased stability and accuracy , we introduce a sixth step in our scheme to enforce the constraint equations at every time step .",
    "an important point that one must consider in taking this approach is that the errors can be larger than the concentration of those species that are depleted .",
    "it is therefore necessary to modify only the concentrations of the dominant species . for a hot gas in which @xmath0 and @xmath2 are mostly ionized",
    ", the hydrogen and helium constraints should be solved for the ionized components @xmath1 and @xmath4 . in cold ( @xmath68 )",
    "gas the neutral hydrogen and neutral helium concentrations must be adjusted to satisfy the constraints . in this way",
    ", we are guaranteed to make only small ( typically much less than one percent ) fractional changes to any of the species at each timestep .",
    "more specific details of the numerical methods used in the hydrodynamic updates ( [ split1 ] )  ( [ split4 ] ) can be found elsewhere ( stone & norman 1992 , anninos et al . 1994 ) .",
    "here we emphasize the solution to the chemistry step ( [ split5 ] ) .",
    "notice that equations ( [ split5 ] ) can be written schematically as @xmath69 where @xmath70 and @xmath71 is the atomic mass number of the @xmath72th element and @xmath48 is the proton mass .",
    "the @xmath73 are the collective source terms responsible for the creation of the @xmath72th species .",
    "the second terms involving @xmath74 represent the destruction mechanisms for the @xmath72th species and are thus proportional to @xmath52 .",
    "equation ( [ model ] ) suggests a backward difference formula ( bdf ) can be used in which all source terms are evaluated at the advanced time step .",
    "discretization of ( [ model ] ) yields @xmath75 lower order backward differentiation methods when applied to problems of the form @xmath76 are stiffly stable .",
    "this rather restrictive stability property is highly desirable when solving sets of stiff equations ( oran & boris 1987 ) .",
    "we have tried other less stable methods including higher order multi - step predictor - corrector schemes , various runge - kutta and adams - bashforth algorithms , and a newton s procedure to solve the backwards differenced linearized equations .",
    "all of these alternative schemes have either proven to be unstable , less accurate or more expensive computationally compared to the simple bdf method .",
    "the solver can be optimized further by noting that the intermediaries @xmath5 and @xmath6 in the molecular hydrogen production processes have large rate coefficients and low concentrations .",
    "they are thus very sensitive to small changes in the more abundant species .",
    "on the other hand , the low concentrations of @xmath5 and @xmath6 implies that they do not significantly influence the more abundant electron , hydrogen and helium concentrations .",
    "this suggests that the nine species can be grouped into two categories : fast and slow reacting .",
    "the fast reacting group , comprised of @xmath5 and @xmath6 , can be decoupled from the slower network and treated independently since the kinetic time scales for these species are much shorter than the characteristic times of the other seven species and the cosmological or gravitational times . @xmath5 and @xmath6",
    "can thus be considered in equilibrium at all times , independent of the hydrodynamic state variables .",
    "the expressions for the equilibrium abundances of @xmath5 and @xmath6 can be reduced by recognizing that reaction ( 19 ) , according to appendix a , can be neglected as a small order correction to @xmath5 , due to the low concentrations of both species @xmath5 and @xmath6 . neglecting reaction ( 19 )",
    ", the equilibrium abundance of @xmath5 can be written independent of @xmath6 @xmath77 where the variables @xmath78 are the rate coefficients with subscripts referring to the reaction number in appendix a. then given @xmath79 , the equilibrium abundance of @xmath6 can be written with no additional assumptions as @xmath80 the separation into fast and slow reacting systems helps to further increase the accuracy and stability of the bdf method when applied only to the slower network over the longer characteristic time scales required by the hubble , hydrodynamic courant , and gravitational free - fall times in cosmological simulations .    due to the intrinsic nonlinearity of equation ( [ model ] ) , not all source terms can be evaluated at the advanced time levels .",
    "significant errors ( of order 20% as measured by the final fractional abundance of hydrogen molecules ) can be introduced if the source terms @xmath73 and @xmath74 are evaluated at the current time level at which the species data is known .",
    "improvements to this crude approximation can be made by sequentially updating each species in order , rather than updating all species simultaneously from the data at the past time step .",
    "for example , the order in which we solve the rate equations was determined finally through experimentation to be @xmath0 , @xmath1 , @xmath2 , @xmath3 , @xmath4 and @xmath8 , followed by the algebraic equilibrium expressions for @xmath5 and @xmath6 , then in the end updating @xmath7 also using the bdf scheme ( [ bdf ] ) .",
    "the updated concentrations of the @xmath72th ( and previous ) species are used as source terms in the equation for @xmath81 .",
    "further improvements in accuracy and stability can be made by mimicking more closely a fully bdf scheme by subcycling the rate solve over a single hydrodynamic courant time step .",
    "the subcycle time steps are determined so that the maximum fractional change in the electron concentration is limited to 10% per timestep , ie .",
    "@xmath82 with @xmath83 .",
    "we note that this same subcylcing procedure can be used to update the energy in the cooling / heating step in equation ( [ split2 ] ) .",
    "the equation of state ( [ eqos ] ) couples the energy and pressure through the gas temperature , and although we have tried a newton - raphson iterative procedure , we found it to converge very slowly or sometimes not at all because the cooling / heating rates are strongly nonlinear and non  monotonic functions of temperature ( anninos & norman 1994 ) .",
    "for this reason we solve equation ( [ split2 ] ) with an explicit method that subcycles the cooling source terms .",
    "the timesteps for each subcyle are determined as @xmath84 , where @xmath83 as in the rate equation solve .",
    "this algorithm has been tested to be both fast and accurate .",
    "the robustness of our methods has been verified by switching the order in which the rate equations are solved relative to the other updates .",
    "we have also experimented with the sensitivity to the temperature ( ie .",
    "time centered , retarded and advanced temperatures ) used in updating the rate equations .",
    "the results are stable and unchanged under all these sorts of permutations .",
    "the numerical scheme described in section [ sec : numerical ] has been implemented in two separate codes : zeus-2d and hercules .",
    "zeus-2d is a two dimensional eulerian hydrodynamics code originally developed by stone & norman ( 1992 ) and modified for cosmology by anninos & norman ( 1994 ) .",
    "hercules is a three - dimensional hydrodynamics code derived from a 3d version of zeus , but modified for cosmology and generalized to include a hierarchical system of nested grids by anninos et al .",
    "extensive tests of the two codes can be found in the references provided above . in this paper , we present tests only for the new additions to the codes , namely the multi ",
    "species chemistry and the non  equilibrium cooling . due to the intrinsic complexity of such systems ,",
    "the diversity of tests is rather limited .",
    "we consider two crucial and relevant ( for cosmology ) tests : radiative shock waves and cosmological sheets .",
    "in addition we have also developed an independent method of solution that is based on the well - tested packaged solver lsodar .",
    "fully three - dimensional calculations of large scale structure formation are presented , comparing results from our method to that of lsodar .",
    "chevalier & imamura ( 1982 ) and imamura , wolff & durisen ( 1984 ) have demonstrated through both analytic and numerical calculations that the fundamental mode of oscillations in one dimensional radiative shocks with cooling rates @xmath85 are unstable if @xmath86 . because the cooling rate is determined from the density of electrons and ions , a comparison to their published work provides an excellent test of both our cooling algorithm and the reaction network .",
    "the initial data for this test is characteristic of pre - shock flows expected from the collapse of zeldovich pancakes @xmath87 corresponding to a uniform flow of gas along the @xmath88 direction .",
    "reflection boundary conditions are imposed at @xmath89 and we use 100 zones to resolve a spatial extent of @xmath90 .",
    "we assume only bremsstrahlung cooling of the form in appendix b , which has an exponent of @xmath91 .",
    "a shock wave forms at the wall ( @xmath89 ) and propagates outward at a velocity @xmath92 . as the heated gas cools",
    ", the shock begins to lose pressure support and slows down . because the cooling rate is proportional to @xmath93 ( ie .",
    "@xmath94 ) , the cooled gas experiences an accelerated energy loss as it gets denser .",
    "eventually the higher density gas nearest the wall loses pressure support and the shock collapses and re - establishes a new pressure equilibrium closer to the wall .",
    "the shock front then begins again to propagate away from the wall , repeating the cycle of oscillations .",
    "this behavior is shown in figure [ fig : radshk ] where the shock position @xmath95 is plotted as a function of time .",
    "our numerical results indicate that the fundamental mode is indeed stable and damped , consistent with the analytic results of chevalier and imamura ( 1982 ) and the numerical simulations of imamura et al .",
    "( 1984 ) .",
    "the shock jump conditions @xmath96 provide a more quantitative check of our numerical results .",
    "for the choice of initial data ( [ initial_data ] ) , the jump conditions give @xmath97 and @xmath98 , in excellent agreement with our numerical results @xmath97 and @xmath99 .",
    "we can estimate the maximum distance the shock front will travel as @xmath100 where @xmath101 is the cooling time and @xmath102 is the shock speed .",
    "substituting the bremsstrahlung cooling formula at the temperature predicted by the jump conditions and assuming a fully ionized gas with @xmath103 and hydrogen mass fraction @xmath104 , gives @xmath105 .",
    "this is again consistent with our numerical result @xmath106 .",
    "chevalier and imamura also characterize their linearized analytic solutions by the frequency of oscillations @xmath107 in units of @xmath108 where @xmath109 is the average shock front position . defining the period @xmath110 of perturbations as the time for the shock to first collapse back to the wall",
    ", we find @xmath111 and @xmath112 , again in good agreement .",
    "we use the zeldovich ( 1970 ) solution to set up a linearized single mode perturbation for the collapse of gas in one dimension @xmath113^{-1},\\label{pertd}\\end{aligned}\\ ] ] where @xmath114 and @xmath115 are the comoving positions and velocities , @xmath116 the proper density , @xmath117 the unperturbed coordinate , @xmath118 , @xmath119 the comoving wavelength of perturbation , @xmath34 the present hubble constant , and @xmath120 the redshift corresponding to the collapse time .",
    "parameters for the calculations presented here are the following @xmath121    at the higher temperatures ( @xmath122 ) characteristic of shock heated gas in high velocity pancake structures , the kinetic time scales are extremely short compared to the hubble time . neglecting the photoionization processes ,",
    "collisional ionization equilibrium is then a good approximation to the following pairs of reactions    @xmath123    for a fully ionized gas , we have @xmath124 where @xmath125 is the mass fraction of hydrogen . the corresponding equilibrium fractional abundances from reactions ( [ eq_first ] )  ( [ eq_last ] )",
    "can then be written as @xmath126 which are functions only of the gas temperature .    in figure",
    "[ fig : pancake1 ] we show the mass fractions @xmath127 throughout the pancake structure at redshift @xmath128 . at this time",
    ", the shock front is located at a distance of approximately @xmath129 from the central plane at @xmath89 , and is propagating outward at an average comoving velocity of about 110 @xmath130 ( 355 @xmath131 relative to the infalling gas ) .",
    "two distinct cooling layers form , as evidenced by the thick solid line representing the gas temperature .",
    "the gas between @xmath132 first cools mostly by atomic processes to a temperature of about @xmath9 . the second colder layer at @xmath133 results from cooling by hydrogen molecules which form from the residual electrons leftover from the nonequilibrium cooling through the first plateau at @xmath9 .",
    "( we refer the reader to anninos & norman ( 1996 ) for further details concerning the chemistry , dynamics and radiative cooling of cosmological sheets . ) although nonequilibrium effects are important as the gas cools through @xmath9 , collisional ionization equilibrium is a good approximation to the species concentrations in the hot gas between @xmath134 .",
    "the different symbols plotted across this region in figure [ fig : pancake1 ] represent the equilibrium abundances given by equations ( [ eq1 ] )  ( [ eq5 ] ) . differences between the numerical results and the equilibrium estimates are less than 0.5% for all species except @xmath7 which differ by roughly 5% .",
    "however , the larger discrepancy in the @xmath7 mass fraction is not due to numerical errors , but to the inadequacy of equation ( [ eq5 ] ) to fully describe the kinetics .",
    "a more accurate equilibrium ratio is derived by considering all the reactions involving @xmath7 @xmath135 equation ( [ eq6 ] ) agrees with our numerical results to within about 0.1% .",
    "we have also run this same problem using the lsodar routines in place of the bdf method to solve for all nine species in full non - equilibrium .",
    "a comparison of the two results at redshift @xmath128 is shown in figure ( [ fig : pancake2 ] ) .",
    "the symbols represent the bdf calculation and the various line types are the lsodar results for the different species .",
    "the two methods agree to within about 0.5% throughout all the different pancake layers , hot and cold .",
    "notice also the excellent agreement in the mass fractions of @xmath5 and @xmath6 , which is further justification of the hybrid model ( in which the fast reacting species are singled out over cosmological dynamical times to be in equilibrium ) .",
    "finally we point out that the fractional abundance of hydrogen molecules that form in the central cooled gas is consistent with the steady state shock calculations of shapiro & kang ( 1987 ) .",
    "a final test is presented for an actual three dimensional cosmological calculation in which we compare our method of solving the rate equations to that of lsodar .",
    "both accuracy and computational efficiency are stressed in this comparison .",
    "the simulation is performed for a flat ( @xmath136 ) model universe with baryon mass fraction @xmath137 and hubble constant @xmath138 with @xmath139 .",
    "the baryonic matter is composed of hydrogen and helium in cosmic abundance with a hydrogen mass fraction @xmath140 . the initial data is the harrison - zeldovich power spectrum modulated with a transfer function appropriate for cold dark matter ( cdm ) adiabatic fluctuations and normalized to a bias factor of @xmath141 .",
    "we begin the simulations at redshift @xmath142 and evolve to the present time at @xmath143 .",
    "the computational box size is set to @xmath144 ( comoving ) resolved by @xmath145 cells .",
    "our calculation thus has a spatial grid resolution of @xmath146 and baryonic mass resolution of @xmath147 which is just marginally adequate to resolve cooling flows and the formation of hydrogen molecules .",
    "the computational demands of lsodar implemented in three dimensions prohibits comparative calculations of much higher resolution .",
    "we have run two separate simulations with identical initial conditions and model parameters .",
    "the only difference in the two runs is the rate equation solver : in the one case we use our bdf method , in the other lsodar .",
    "the results of comparison are shown in figures [ fig : hist ] to [ fig : cont2 ] .",
    "figure [ fig : hist ] shows the cell distributions ( defined by counting up the number of cells at a particular binned range of values ) for three key variables that would be particularly sensitive to errors in the rate solver : ( a ) gas temperature which is constructed from the concentrations of all the species combined , and ( b ) molecular hydrogen mass fraction @xmath148 and electron number density fraction @xmath149 .",
    "all results are shown at redshift @xmath150 .",
    "the prominent peaks in the @xmath7 and electron fraction distributions correspond closely to values initialized at the start of the runs .",
    "because most of the box volume is comprised of cosmic voids that do not undergo shock heating , the molecular hydrogen and electron fraction do not change significantly in most of the cells .",
    "the relative @xmath151 deviations between the bdf and lsodar results are 0.018 , 0.039 and 0.13 for the gas temperature , molecular hydrogen and electron fractions , respectively .",
    "we note , however , that deviations are due in part to the final output redshifts not being exactly the same in the two runs ; the relative difference is about 0.01 .",
    "the larger differences found here ( as compared to the cosmological sheet calculations ) can also be attributed to the coarse grid resolution and the resulting large courant time step in the hydrodynamical calculation .",
    "the agreements improve with resolution .",
    "figure [ fig : cont ] shows contour graphs of the fractional volume of those cells with a particular combination of temperature and baryonic density , electron number density fraction and molecular hydrogen mass fraction .",
    "two sets of graphs are presented : the three plots in the first column are results from the bdf method , the second column are the lsodar results .",
    "we note that the sharp boundaries in the electron contours at the level @xmath152 correspond to the initialized fraction at @xmath142 : @xmath153 ( peebles 1993 ) .",
    "the volume weighted distribution is concentrated at the initial value for @xmath7 since there is no mechanism to efficiently create nor destroy molecules at the low temperatures of the voids , and slightly lower than the initial value for the electron fraction since the expansion ( cosmological and gravitational ) of the voids continues to cool and recombine the gas .",
    "contours of the spatial distribution of @xmath149 and @xmath148 are shown in figure [ fig : cont2 ] .",
    "the data is projected ( and averaged ) along the @xmath154-axis at redshift @xmath155 .",
    "the first row is the electron fraction , the second molecular hydrogen .",
    "the first column are the bdf results , the second lsodar .",
    "notice that hydrogen molecules form preferentially within the high dense filamentary structures but mostly in the knot  like intersections of the filaments .",
    "these are the highest density regions where the gas cools rapidly and the electrons are depleted by recombination .",
    "peaks in the @xmath7 concentration therefore correspond to valleys in the electron distribution . in comparing results from the two solvers , bdf versus lsodar",
    ", we see the distributions in both figures [ fig : cont ] and [ fig : cont2 ] are basically the same .",
    "in addition to the accuracy of the bdf method , another very important point that should be stressed is the amount of computational time required to solve the rate equations .",
    "the bdf run takes about 1.2 cpu hours with the full reaction network on the ncsa convex c3880 , in contrast to the equivalent lsodar calculation which takes about 16.7 hours to complete on the same machine .",
    "the speedup of the bdf method over lsodar is roughly a factor of 14 .",
    "we have developed and tested a new scheme to solve a system of stiff kinetic equations appropriate for chemical reaction flows in cosmological structure formation .",
    "twenty  eight chemical reactions for collisional and radiative processes are included in our model , which tracks nine separate atomic and molecular species : @xmath0 , @xmath1 , @xmath2 , @xmath3 , @xmath4 , @xmath5 , @xmath6 , @xmath7 , and @xmath8 .",
    "the reaction network is solved in a self - consistent manner with the hydrodynamic , n - body and cosmological expansion equations , and the accuracy of the solver has been verified by performing a series of test - bed calculations that includes radiative shock waves , cosmological sheets and monitering the conservation constraints . we have also implemented a publicly available and well - tested solver called lsodar in place of our scheme and made direct comparisons of the different results in one , two and three dimensions .",
    "we find our methods are both fast and accurate , making fully three - dimensional calculations of non - equilibrium cosmological reaction flows feasible .",
    "we have incorporated the species solver into two separate cosmological hydrodynamic codes : a two  dimensional ratioed grid code to model zeldovich pancakes , and a more general three  dimensional nested grid cosmological code hercules .",
    "applications to date include investigations of star and galaxy formation in cosmological sheets ( anninos & norman 1996 ) , primordial star formation in cdm models ( zhang et al .",
    "1996 ) , and simulations of the ly@xmath156 forest ( zhang , anninos & norman 1995 ; charlton et al .",
    "1996 ) . in the future",
    ", we plan to extend this work and develop a more sophisticated treatment of radiation to account for self  shielding and to more accurately model the microphysics of optically thick gas .",
    "this work is done under the auspices of the grand challenge cosmology consortium ( gc@xmath157 ) and supported in part by nsf grant asc-9318185 .",
    "the calculations were performed on both the c90 at the pittsburgh supercomputing center and the convex c3880 at the national center for supercomputing applications at the university of illinois .",
    "the following is a list of all chemical reactions that we include in our calculations .",
    "further discussions and justification of the completeness of this set of reactions can be found in abel et al .",
    "there we also include explicit formulae for the different rate coefficients .",
    "= ( 16 ) = @xmath4 = + @xmath158 = @xmath159 @xmath4 = + @xmath158 = + ( 1 ) @xmath0 + @xmath160 @xmath159 @xmath1 + 2@xmath160 + ( 2 ) @xmath1 + @xmath160 @xmath159 @xmath0 + @xmath161 + ( 3 ) @xmath2 + @xmath160 @xmath159 @xmath162 + 2@xmath160 + ( 4 ) @xmath3 + @xmath160 @xmath159 @xmath2 + @xmath161 + ( 5 ) @xmath3 + @xmath160 @xmath159 @xmath4 + 2@xmath160 + ( 6 ) @xmath4 + @xmath160 @xmath159 @xmath3 + @xmath161 +   + ( 7 ) @xmath0 + @xmath160 @xmath159 @xmath5 + @xmath161 + ( 8) @xmath5 + @xmath0 @xmath159 @xmath7 + @xmath160 + ( 9 ) @xmath0 + @xmath1 @xmath159 @xmath6 + @xmath161 + ( 10 ) @xmath6 + @xmath0 @xmath159 @xmath7 + @xmath1 + ( 11 ) @xmath7 + @xmath1 @xmath159 @xmath6 + @xmath0 + ( 12 ) @xmath7 + @xmath160 @xmath159 @xmath163 + @xmath160 + ( 13 ) @xmath7 + @xmath164 @xmath159 @xmath165 + ( 14 ) @xmath5 + @xmath160 @xmath159 @xmath0 + 2@xmath160 + ( 15 ) @xmath5 + @xmath0 @xmath159 @xmath163 + @xmath160 + ( 16 ) @xmath5 + @xmath1 @xmath159 @xmath163 + ( 17 ) @xmath5 + @xmath1 @xmath159 @xmath6 + @xmath160 + ( 18 ) @xmath166 + @xmath160 @xmath159 @xmath163 + ( 19 ) @xmath166 + @xmath5 @xmath159 @xmath7 + @xmath0 +   +   + ( 20 ) @xmath0 + @xmath161 @xmath159 @xmath1 + @xmath160 + ( 21 ) @xmath2 + @xmath161 @xmath159 @xmath3 + @xmath160 + ( 22 ) @xmath3 + @xmath161 @xmath159 @xmath4 + @xmath160 + ( 23 ) @xmath5 + @xmath161 @xmath159 @xmath0 + @xmath160 + ( 24 ) @xmath7 + @xmath161 @xmath159 @xmath166 + @xmath160 + ( 25 ) @xmath6 + @xmath161 @xmath159 @xmath0 + @xmath1 + ( 26 ) @xmath6 + @xmath161 @xmath159 @xmath167 + @xmath160 + ( 27 ) @xmath7 + @xmath161 @xmath159 @xmath168 @xmath159 @xmath163 + ( 28 ) @xmath7 + @xmath161 @xmath159 @xmath163 +      the cooling rates @xmath23 and photoionization cross sections @xmath43 included in our calculations .",
    "we use units of @xmath169 for the rates , @xmath170 for the cross sections , and degrees kelvin for temperature @xmath38 . also , @xmath171 , @xmath172 with @xmath173 being the threshold frequencies of the @xmath72th species , and @xmath174 , @xmath175 and @xmath176 are the rate coefficients for the ionizing chemical reactions ( 1 ) , ( 3 ) and ( 5 ) listed in appendix a.    = @xmath177 ( black 1981 ; cen 1992 ) : + @xmath178 + @xmath179 + @xmath180 +   + * collisional ionization cooling * ( shapiro & kang 1987 ; cen 1992 ) : + @xmath181 + @xmath182 + @xmath183 + @xmath184 +   + * recombination cooling * ( black 1981 ; spitzer 1978 ) : + @xmath185 + @xmath186 + @xmath187~                  \\exp{(-470000/t)}~n_e n_{he^+}$ ] + @xmath188 +   + * molecular hydrogen cooling * ( lepp & shull 1983 ) .",
    "+   + * bremsstrahlung cooling * ( black 1981 ; spitzer & hart 1979 ) : + @xmath189                  ~n_e ( n_{h^+ } + n_{he^+ } + n_{he^{++}})$ ] +   + * compton cooling or heating * ( peebles 1971 ) : + @xmath190~n_e$ ] +   + * photoionization heating crossections * ( osterbrock 1974 ) : + @xmath191~                  [ 1-\\exp{(-2\\pi/\\alpha_h)}]^{-1}$ ] + @xmath192 $ ] + @xmath193~                  [ 1-\\exp{(-2\\pi/\\alpha_{he^+})}]^{-1}$ ] +"
  ],
  "abstract_text": [
    "<S> we have developed a method of solving for multi - species chemical reaction flows in non  equilibrium and self  consistently with the hydrodynamic equations in an expanding flrw universe . </S>",
    "<S> the method is based on a backward differencing scheme for the required stability when solving stiff sets of equations and is designed to be efficient for three - dimensional calculations without sacrificing accuracy . in all , 28 kinetic reactions are solved including both collisional and radiative processes for the following nine separate species : @xmath0 , @xmath1 , @xmath2 , @xmath3 , @xmath4 , @xmath5 , @xmath6 , @xmath7 , and @xmath8 . </S>",
    "<S> the method identifies those reactions ( involving @xmath5 and @xmath6 ) ocurring on the shortest time scales , decoupling them from the rest of the network and imposing equilibrium concentrations to good accuracy over typical cosmological dynamical times . </S>",
    "<S> several tests of our code are presented , including radiative shock waves , cosmological sheets , conservation constraints , and fully three - dimensional simulations of cdm cosmological evolutions in which we compare our method to results obtained when the packaged routine lsodar is substituted for our algorithms . </S>"
  ]
}