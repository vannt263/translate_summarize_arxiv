{
  "article_text": [
    "nowadays , a wide variety of products are browsed and purchased on e - commerce sites  @xcite .",
    "this enables the automated collection of clickstream data , which is a record of a visitor s page view ( pv ) history .",
    "consequently , the analysis of clickstream data has been drawing intense research interest with respect to various topics , such as website browsing and navigation , internet advertising , and online purchase behavior on e - commerce sites  @xcite . in particular",
    ", the present paper analyzes customer product - choice behavior based on clickstream data .",
    "the results of this research could be used to help visitors go to a target page on an e - commerce site and find the products they want .",
    "it could also be useful in demand forecasting for inventory management  @xcite .",
    "the recency and frequency of a customer s previous purchases have been shown to be key indicators for forecasting repeat purchases  @xcite . in light of this fact , iwanaga et al .",
    "@xcite recently devised optimization models for estimating product - choice probabilities from the recency and frequency of each customer s previous pvs .",
    "these models exploit the properties of recency and frequency of pvs to enhance their predictive performance . in particular ,",
    "the monotonicity  convexity",
    " concavity ( mcc ) model estimates product - choice probabilities that satisfy monotonicity , convexity , and concavity constraints with respect to recency and frequency .",
    "iwanaga et al .",
    "@xcite demonstrated that higher predictive performance is achieved with mcc model than with the standard general - purpose methods for binary classification , namely , logistic regression and kernel - based support vector machines .",
    "however , it is noteworthy that typical e - commerce sites deal in a wide variety of products .",
    "it is clear that purchase behavior toward products varies according to price range , purchase interval , and so on ; nevertheless , such product heterogeneity is completely absent from the mcc model .",
    "for this reason , its predictive performance could be further improved by integrating product heterogeneity into the mcc model .    for this purpose",
    ", we propose a latent - class shape - restricted model by applying latent - class modeling  @xcite to the mcc model .",
    "our model classifies products into a specified number of latent classes and simultaneously estimates the product - choice probabilities for each latent class . to estimate the parameters of our model efficiently ,",
    "we develop a tailored expectation - maximization ( em ) algorithm  @xcite .",
    "we assess the predictive performance of our model through computational experiments that use actual clickstream data .",
    "the contributions of the present paper are summarized as follows :    * we establish a novel latent - class approach to estimating product - choice probabilities and we develop an em algorithm to determine the associated parameter values . *",
    "we verify through computational experiments that higher predictive performance is achieved with our model than with the mcc model  @xcite and latent - class logistic regression  @xcite .",
    "* we closely examine customer product - choice behavior toward each latent class of products on the basis of the estimated product - choice probabilities .",
    "the remainder of this paper is organized as follows .",
    "section  2 gives a brief review of related work .",
    "section  3 presents the mcc model  @xcite for estimating product - choice probabilities from clickstream data .",
    "section  4 develops our latent - class mcc model and em algorithm .",
    "section  5 evaluates the effectiveness of our model through computational experiments .",
    "section  6 concludes with a brief summary of our work and a discussion of future research directions .",
    "this section discusses some related works on the prediction of online purchasing behavior .",
    "then it gives a brief survey of the shape - restricted regression and latent - class regression .",
    "one of the most active areas of clickstream research has been the analysis of online purchasing behavior of customers on e - commerce sites  @xcite .",
    "moe and fader  @xcite proposed a stochastic model for predicting online purchasing conversion rates based on an observed history of visits and purchases .",
    "many other studies used logit and/or probit modeling based on various types of explanatory variables to predict online purchasing behavior  @xcite , whereas boroujerdi et al .",
    "@xcite applied several classification algorithms to predict customers buying intentions .",
    "however , these studies focused on predicting customer visits that culminated in purchases , and so they did not assign a purchase probability to each product .    although various studies have analyzed online product - choice behavior , most have emphasized more detailed data ( e.g. , multiplex data  @xcite , social media profiles  @xcite , and product reviews and ratings  @xcite ) rather than clickstream data .",
    "in contrast to these studies , the present paper focuses on investigating the relationship between customer pvs and product - choice probabilities based on clickstream data .",
    "our research will be of significant value to most e - commerce sites , for which the analysis of clickstream data is a major challenge .",
    "shape - restricted regression , which has its origin in earlier work  @xcite , fits a nonparametric function to given data points under shape restrictions such as monotonicity , convexity , and concavity .",
    "some popular examples include the estimation of utility / production / cost / profit functions in economics  @xcite and option pricing functions in finance  @xcite .",
    "various algorithms have been developed for shape - restricted regression  @xcite , a special case of which is isotonic regression .",
    "this has many applications in statistics , operations research , and image processing  @xcite .",
    "iwanaga et al .",
    "@xcite recently used the maximum likelihood method to estimate product - choice probabilities subject to the monotonicity , convexity , and concavity constraints with respect to recency and frequency .",
    "their shape - restricted model was a new effective application of shape - restricted regression to the analysis of clickstream data .",
    "latent - class ( or mixture ) regression  @xcite is a traditional form of latent - class modeling  @xcite .",
    "it is aimed at classifying a sample into latent classes and simultaneously forming a regression model within these classes .",
    "there are two main algorithms for maximum likelihood estimation of latent - class regression models : the newton ",
    "raphson algorithm  @xcite and the em algorithm  @xcite .",
    "while these models are frequently used in marketing and business research to represent consumer heterogeneity , we apply latent - class modeling to the classification of a wide variety of products on e - commerce sites . for this purpose",
    ", we develop a latent - class model for estimating the product - choice probabilities that satisfy monotonicity , convexity , and concavity constraints . to the best of our knowledge ,",
    "none of the existing studies have considered a latent - class model under such a variety of shape restrictions .",
    "we also demonstrate that our latent - class model is superior to latent - class logistic regression  @xcite in terms of predictive performance based on clickstream data .",
    "this section introduces the optimization models developed by iwanaga et al .",
    "@xcite for estimating product - choice probabilities from the recency and frequency of each customer s previous pvs .",
    "recency and frequency of pvs are defined for each customer  product pair .",
    "roughly speaking , the _ recency _ of customer @xmath0 with respect to product @xmath1 represents the time of the most recent visit of customer @xmath0 to the webpage of product @xmath1 , while the _ frequency _ represents the number of visits of customer @xmath0 to the webpage of product @xmath1 .",
    "let @xmath2 and @xmath3 denote finite sets of positive integers associated with the recency and frequency values , respectively .",
    "then , the two - dimensional probability table is expressed as a matrix @xmath4^{i \\times j},\\ ] ] where @xmath5 indicates the probability that a product will be chosen ( e.g. , purchased ) by a customer for recency @xmath6 and frequency @xmath7 of this customer  product pair .",
    "we will analyze customer product - choice behavior based on this probability table .",
    "it is relatively easy to calculate empirical product - choice probabilities by counting the number of purchases for each recency  frequency pair @xmath8 in past clickstream data . in this case , however , if the element @xmath5 is calculated from only a few training samples , it will not be particularly reliable . to resolve this problem , iwanaga et al .",
    "@xcite exploited the properties of recency and frequency of pvs in their optimization models .",
    "let us specify the base date in past clickstream data ; accordingly , we predict a customer s choice of products on the basis of information as of this date .",
    "for each @xmath8 , we denote by @xmath9 the number of customer  product pairs @xmath10 for which customer @xmath0 had recency @xmath6 and frequency @xmath7 for product @xmath1 as of the base date .",
    "we then set @xmath11 to the number of those pairs that led to purchases since the base date .",
    "given a probability table @xmath12 , the occurrence probability of event @xmath13 is expressed by the binomial distribution as follows : @xmath14 the following optimization models maximize the log - likelihood function @xmath15 after omitting its constant terms .",
    "it is assumed that the product - choice probability increases with recency and frequency because they reflect growing customer interest in a particular product .",
    "accordingly , the monotonicity model  @xcite estimates a probability table @xmath12 under the following monotonicity constraints : @xmath16    additionally , as the customer s most recent visit becomes longer ago , the variation in recency value should have less effect . in other words ,",
    "the larger the recency value , the larger the increment in the purchase probability . moreover , as the number of visits of a particular customer grows , the effect of each visit will be smaller ; that is , the larger the frequency value , the smaller the increment in the purchase probability .",
    "the mcc model  @xcite includes these properties via the convexity  concavity constraints on product - choice probability : @xmath17    it should be noted here that these optimization models apply the same probability table to all products ; however , distinct categories of products can elicit different purchasing behavior .",
    "hence , in the next section , we consider developing multiple probability tables that reflect the diversity of products .",
    "this section presents our latent - class model for estimating product - choice probabilities .",
    "it then describes an em algorithm for setting the parameters of our model .",
    "suppose that we are given a set @xmath18 of product categories .",
    "for each @xmath19 , we define @xmath20 as the number of customer  product pairs that had recency @xmath6 and frequency @xmath7 for a product of category @xmath21 as of the base date .",
    "we also set @xmath22 to the number of those pairs that were accompanied by purchases since the base date .",
    "the simplest way to distinguish between product categories would be to create a different probability table for each category .",
    "however , such an approach would lead to an unreliable probability table if some categories have only a small number of training samples .",
    "for this reason , we aggregate homogeneous categories of products in the same manner as latent - class regression  @xcite .    specifically , we introduce a set @xmath23 of latent classes such that @xmath24 .",
    "the size of class @xmath25 is @xmath26 and satisfies @xmath27 a two - dimensional probability table is then defined for each class @xmath25 : @xmath28^{i \\times j},\\ ] ] where @xmath29 indicates the probability that a product in class @xmath30 will be chosen by a customer when the corresponding recency and frequency values are @xmath6 and @xmath7 , respectively .    as with eq .",
    ", the conditional probability of event @xmath31 , given that category @xmath21 belongs to class @xmath30 , is written as @xmath32 by mixing these probabilities with weight @xmath26 , the unconditional probability of event @xmath33 becomes @xmath34 the posterior probability of category @xmath21 belonging to class @xmath30 is given by bayes rule as follows : @xmath35      to determine the parameters of our latent - class model , we develop a tailored em algorithm .",
    "we begin by introducing unknown membership variables @xmath36 $ ] for @xmath37 ; that is , @xmath38 if category @xmath21 belongs to class @xmath30 ; otherwise , @xmath39 .",
    "then , the complete - data log - likelihood function is expressed as @xmath40    the em algorithm starts with some initial estimate of membership variables @xmath41 for @xmath37 .",
    "it then repeats the e - step ( expectation step ) and m - step ( maximization step ) to maximize the log - likelihood function  .",
    "the m - step substitutes @xmath41 into the log - likelihood function   and then maximizes it with respect to other decision variables .",
    "specifically , the latent - class size is determined by maximizing @xmath42 subject to constraints  .",
    "the method of lagrange multipliers yields @xmath43 for each @xmath25 .",
    "next , the product - choice probabilities are determined by maximizing @xmath44 subject to the monotonicity and convexity  concavity constraints .",
    "this optimization problem can be decomposed into one for each @xmath25 ; consequently , we solve @xmath45 to find a solution @xmath46 for each @xmath25 .",
    "this optimization problem is similar to problem   and maximizes a concave function subject to linear constraints ; hence , it can be solved exactly and efficiently with standard nonlinear optimization software .",
    "after that , the e - step calculates the expected value of each membership variable based on the current estimates of the other variables .",
    "this amounts to assigning the posterior probability   to the membership variable @xmath47 for each @xmath37 .",
    "the e - step and m - step are repeated until a termination condition is satisfied .",
    "our em algorithm for estimating the latent - class mcc model is summarized as follows :    step 0 : :    ( initialization )   set @xmath41 for    @xmath37 as initial estimates , and go to    step 2 .",
    "step 1 : :    ( e - step )   update @xmath41 according to eq .   for    @xmath37 .",
    "step 2 : :    ( m - step )   update @xmath48 according to eq .   for    @xmath25 .",
    "update @xmath49 with a solution    to problem   for @xmath25 .",
    "step 3 : :    ( termination condition )   terminate the algorithm if a termination    condition is satisfied .",
    "otherwise , return to step 1 .",
    "the computational results reported in this section evaluate the effectiveness of our latent - class model for estimating product - choice probabilities .",
    "we used actual clickstream data provided by recruit lifestyle co. , ltd .",
    ", a leading japanese company in products and services for food , beauty , travel , mail order , group discount tickets , and other areas of daily consumption .",
    "as will be seen in section  [ sec : aelc ] , we considered 56 categories of products that were purchased relatively frequently on the targeted e - commerce site .",
    "the clickstream data were collected during august  october 2015 from roughly 4 million customers , the top 1% of which in terms of the number of purchases were excluded as outliers .",
    "each transaction in the data corresponds to either a  page view ( pv ) \" or a `` purchase '' and contains information such as time , customer i d , and product i d .",
    "we prepared the following six features representing recency and frequency based on pv , session , and day :    viewr : :    recency that is measured in pvs ( @xmath50 ) sesr : :    recency that is measured in sessions ( @xmath51 ) dayr : :    recency that is measured in days ( @xmath50 ) viewf : :    frequency that is measured in pvs ( @xmath52 ) sesf : :    frequency that is measured in sessions ( @xmath53 ) dayf : :    frequency that is measured in days ( @xmath53 )    for instance , if the most recent pv for a customer ",
    "product pair was made @xmath54 days ago , the dayr value was set to @xmath55 . if @xmath56 pvs were made for a customer ",
    "product pair , the viewf value was set to @xmath57 .",
    "these recency and frequency values were calculated from the clickstream data observed in the four weeks before the base date . also , the threshold values ( i.e. , @xmath58 and @xmath59 ) of recency and frequency were determined such that the recency / frequency values were rounded up / down for less than 5% of all customer  product pairs .",
    "we compare the predictive performances of the following models through the top-@xmath60 purchase prediction :    mcc(@xmath61 ) : :    mcc model  , which develops only one probability table and applies it    to all products .",
    "mcc(@xmath62 ) : :    mcc model  , which develops 56 probability tables separately for the    various product categories .",
    "lcmcc(@xmath63 ) : :    our latent - class mcc model ( see section  [ sec : lcm ] ) ; @xmath63    is the number of latent classes .",
    "lclr(@xmath63 ) : :    latent - class logistic regression that predicts a product purchase from    two input variables , namely the recency and frequency of each    customer  product pair ; @xmath63 is the number of latent    classes .    the model parameters of lcmcc(@xmath63 )",
    "were tuned by our em algorithm ( see section  [ subsec : ema ] ) , and those of lclr(@xmath63 ) were tuned by the standard em algorithm  @xcite .",
    "the two em algorithms were terminated if the increment in the log - likelihood from the previous iteration was sufficiently small , where the maximum number of iterations was set to 10 .",
    "we repeated this em - algorithm process 10 times with random initial estimates and chose the best obtained estimates in log - likelihood .",
    "the associated optimization problems ( e.g. , and ) were solved using numerical optimizer v17 , a numerical optimization software developed by ntt data mathematical systems inc . here , the inequality constraint @xmath64 was replaced with @xmath65 with @xmath66 .",
    "all the computations were performed on a windows computer with an amd opteron 4133 cpu ( 2.80  ghz ) and 128  gb of memory .    in our top-@xmath60 purchase prediction ,",
    "the purchase data collected in september 2015 were used in the training phase and those collected in october 2015 were used in the test phase .",
    "the training phase estimates two - dimensional probability tables .",
    "the base date was first set to september 3 , and the recency and frequency values and the purchase data of the base date were gathered for every customer  product pair .",
    "similar data were collected by moving the base date one day at a time from september 3 to 30 .",
    "this data set was used as a training set that consists of 43,566 purchase samples and 96,495,418 non - purchase samples , in which each customer  product pair corresponds to one sample . to examine the relationship between the number of training samples and the predictive performance , two additional training sets were generated by randomly selecting samples from the original training set at sampling rates of @xmath67 or @xmath68 .",
    "these synthetic training sets are referred to as the `` 1%-sampled '' and `` 10%-sampled '' sets , and the original one is referred to as the `` 100%-sampled '' set as required .",
    "two - dimensional probability tables were estimated from these training sets .",
    "the test phase evaluates the predictive performances of the two - dimensional probability tables .",
    "the base date was first set to october 1 , and the product - choice probabilities were computed by entering the recency and frequency values to the probability tables . then @xmath60 products were selected for each customer in descending order of the computed product - choice probabilities . here",
    ", viewf was used for tie - breaks when some products had the same product - choice probability . for customers who viewed fewer than @xmath60 products in the previous four weeks",
    ", those products were all selected .",
    "this process was repeated by moving the base date from october 1 to 28 .",
    "consequently , 28 test sets were completed , each of which contained around 1,214 purchase samples and 3,316,018 non - purchase samples on average .    in each test set",
    ", we calculated the following criteria for every customer :    * @xmath69 , * @xmath70 , * @xmath71 ,    where @xmath72 stands for the number of corresponding products . here",
    ", the purchased products were restricted to those viewed by the targeted customer in the previous four weeks .",
    "these f1 scores were averaged over customers , and they were further averaged over the 28 test sets as needed .",
    "we begin by finding the best combination of recency and frequency features for estimating the product - choice probability .",
    "the box plots in figure  [ fig:1 ] display the distribution of the f1 scores of mcc(1 ) for the 28 test sets , where the number of selected products is @xmath73 . here , the nine combinations of recency features \\{viewr , sesr , dayr } and frequency features \\{viewf , sesf , dayf } were tested .",
    "it is clear from figure  [ fig:1 ] that the use of viewf improved the f1 score significantly .",
    "we can also see that dayr@xmath74viewf was the best combination for all @xmath73 . in view of these results",
    ", we employ this combination of dayr and viewf in the following computational experiments .    [",
    "cols=\"^,^,^ \" , ]     to highlight the differences between these four probability tables , we express the product - choice probability as a function of one variable by fixing either the recency or the frequency to a certain value , as shown in figure  [ fig:6 ] . in view of table  [ tbl :",
    "summary ] and figures  [ fig:5 ] and [ fig:6 ] , we identify the characteristics of the four latent classes of product categories as follows .",
    "[ [ class-1 ] ] class 1 + + + + + + +    this class is composed mainly of clothing items and furnishings , as shown in table  [ tbl : summary ] . as we can see from figures  [ fig:5 ] and [ fig:6 ]",
    ", the product - choice probabilities of class 1 are lower than those of the other classes .",
    "this is probably because customers of the e - commerce site repeatedly browse and compare various products in this class , such as `` ladies clothing , '' `` shoes , '' `` bags , '' and `` accessories . ''",
    "in addition , many customers are likely to inspect and purchase such products at a brick - and - mortar store after having seen them on e - commerce sites .",
    "[ [ class-2 ] ] class 2 + + + + + + +    this class contains product categories such as `` food , '' `` soft drinks / coffee / tea , '' `` cosmetics , '' and `` pc accessories . '' because these products are relatively inexpensive , they are likely to be purchased even if their frequency value is not very high .",
    "indeed , the product - choice probabilities of class 2 are the second highest when @xmath75 , as shown in figure  [ fig:6](a ) . moreover , in figure  [ fig:6](c ) and ( d ) , the product - choice probabilities of class 2 are higher than those of class 4 only when @xmath76 is less than a certain value .",
    "[ [ class-3 ] ] class 3 + + + + + + +    this class consists mainly of products for daily use , such as `` water , '' `` rice / cereal , '' `` contact lenses , '' and `` dog food . ''",
    "figure  [ fig:6 ] shows that the product - choice probabilities of class 3 are always the highest of the four classes .",
    "this implies that customers regularly purchase favorite products in this class without viewing the product details repeatedly .",
    "[ [ class-4 ] ] class 4 + + + + + + +    this class is composed mainly of more expensive products such as `` home electronics , '' `` stationery , '' `` kitchen supplies , '' and `` car supplies . ''",
    "we note also that `` everyday sundries '' contains durable and expensive goods such as electric toothbrushes , suitcases , and high - quality towels .",
    "since these products are not purchased frequently , customers may purchase them after checking the product details repeatedly .",
    "indeed , figure  [ fig:6](c ) reveals that the product - choice probability of class 4 increases monotonically with viewf and exceeds that of class 2 at @xmath77 .",
    "in other words , products in class 4 become more likely to be purchased as the number of pvs increases .",
    "we devised a novel latent - class shape - restricted model for estimating product - choice probabilities from the recency and frequency of each customer s previous pvs .",
    "our model classifies products into a specified number of latent classes , for each of which it estimates a two - dimensional probability table that satisfies monotonicity , convexity , and concavity constraints with respect to recency and frequency .",
    "we also developed a specialized em algorithm for estimating the parameters of our model .",
    "moreover , we analyzed customer product - choice behavior based on actual clickstream data by means of our latent - class model .",
    "our research contribution is to open up a new possibility for latent - class modeling in the analysis of clickstream data .",
    "specifically , we successfully improved the predictive performance of the existing mcc model by applying latent - class modeling .",
    "we also established a new method of product cluster analysis based on the recency and frequency of pvs on e - commerce sites .",
    "the computational results demonstrated clearly that our latent - class mcc model outperformed common latent - class logistic regression . since this fact proves the effectiveness of combining latent - class regression with shape - restricted regression , this paper will motivate further work on latent - class shape - restricted regression in the areas of marketing and business research .",
    "the estimated product - choice probabilities represent a customer s preferences for the products .",
    "such information is essential in recommender systems ( e.g. , collaborative filtering ) , and thus , the performance of recommender systems on e - commerce sites would be enhanced by incorporating our probability tables .",
    "additionally , once probability tables have been developed by the em algorithm , they can easily be put into practical use on e - commerce sites .",
    "furthermore , our latent - class model provides useful information for formulating an individual sales promotion strategy for each product category .",
    "a future direction of study is the effective use of latent classes of customers in the shape - restricted model .",
    "our preliminary experiments show that the use of latent customer classes does not lead to improved predictive performance on the clickstream data analyzed in this paper . however , since the modeling of customer heterogeneity is the central challenge of many statistical marketing studies , the use of latent customer classes will offer certain advantages in other application areas .",
    "the authors would like to thank recruit lifestyle co. , ltd . for providing the clickstream data used in the computational experiments .",
    "boroujerdi , e. g. , mehri , s. , garmaroudi , s. s. , pezeshki , m. , mehrabadi , f. r. , malakouti , s. , & khadivi , s. ( 2014 ) .",
    "a study on prediction of user s tendency toward purchases in websites based on behavior models . in proceedings of the 6th ieee conference on information and knowledge technology ( pp .",
    "6166 ) .",
    "ngai , e. w. , xiu , l. , & chau , d. c. ( 2009 ) .",
    "application of data mining techniques in customer relationship management : a literature review and classification .",
    "expert systems with applications , 36(2 ) , 25922602 .",
    "reinartz , w. j. , & kumar , v. ( 2000 ) . on the profitability of long - life customers in a noncontractual",
    "setting : an empirical investigation and implications for marketing .",
    "journal of marketing , 64(4 ) , 1735 ."
  ],
  "abstract_text": [
    "<S> this paper analyzes customer product - choice behavior based on the recency and frequency of each customer s page views on e - commerce sites . </S>",
    "<S> recently , we devised an optimization model for estimating product - choice probabilities that satisfy monotonicity , convexity , and concavity constraints with respect to recency and frequency . </S>",
    "<S> this shape - restricted model delivered high predictive performance even when there were few training samples . </S>",
    "<S> however , typical e - commerce sites deal in many different varieties of products , so the predictive performance of the model can be further improved by integration of such product heterogeneity . for this purpose </S>",
    "<S> , we develop a novel latent - class shape - restricted model for estimating product - choice probabilities for each latent class of products . </S>",
    "<S> we also give a tailored expectation - maximization algorithm for parameter estimation . </S>",
    "<S> computational results demonstrate that higher predictive performance is achieved with our latent - class model than with the previous shape - restricted model and common latent - class logistic regression .    </S>",
    "<S> product choice , latent class , em algorithm , optimization , e - commerce , clickstream data </S>"
  ]
}