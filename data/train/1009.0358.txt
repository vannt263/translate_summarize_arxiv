{
  "article_text": [
    "a _ trigraph _ @xmath1 consists of a set @xmath2 of vertices , and two disjoint sets of directed edges on @xmath3  the set of _ weak edges _",
    "@xmath4 , and the set of _ strong edges _ @xmath5 . if both edge sets @xmath6 , viewed as relations on @xmath3 , are symmetric , we have a _ symmetric _ , or _",
    "undirected _ trigraph .",
    "a weak , respectively strong , edge @xmath7 is called a _ weak _ , respectively _ strong , loop _ at @xmath8 .",
    "the _ adjacency matrix _ of a trigraph @xmath1 , with respect to an enumeration @xmath9 of its vertices , is the @xmath10 matrix @xmath11 over @xmath12 , in which @xmath13 if @xmath14 is not an edge , @xmath15 if @xmath14 is a weak edge , and @xmath16 if @xmath14 is a strong edge .",
    "note that a trigraph @xmath1 is symmetric if and only if its adjacency matrix is symmetric .",
    "we consider the class of digraphs included in the class of trigraphs , by viewing each digraph @xmath1 as a trigraph with the same vertex set @xmath17 , and with the weak edge set @xmath18 and strong edge set @xmath19 .",
    "conversely , if @xmath1 is a trigraph , the _ associated digraph _ of @xmath1 is the digraph with the same vertex set @xmath17 , and with the edge set @xmath20 .",
    "moreover , the _ underlying graph _ of the trigraph @xmath1 is the underlying graph of the associated digraph , and the _ symmetric graph _ of the trigraph @xmath1 is the symmetric graph of the associated digraph . to be specific",
    ", @xmath21 is an edge of the _ underlying graph _ of @xmath1 just if @xmath22 or @xmath23 , and @xmath21 is an edge of the _ symmetric graph _ of @xmath1 just if @xmath22 and @xmath23 .",
    "these conventions allow us to extend the usual graph and digraph terminology to trigraphs .",
    "we speak , for instance , of _ adjacent vertices , components , neighbours , cutpoints , or bridges _ of a trigraph @xmath1 , meaning the corresponding notions in the associated digraph of @xmath1 , or in its underlying graph ; and we speak of _ symmetric edges , symmetric neighbours , etc .",
    "_ in a trigraph @xmath1 , meaning the edges , neighbours , etc . , in the symmetric graph of @xmath1",
    "let @xmath24 be a digraph and @xmath1 a trigraph .",
    "a _ homomorphism _ of @xmath24 to @xmath1 is a mapping @xmath25 such that the following two conditions are satisfied for each @xmath26 :    1 .   if @xmath27 then @xmath28 2 .",
    "if @xmath29 then @xmath30 .    in other words , edges of @xmath24 must map to either weak or strong edges of @xmath1 , and non - edges of @xmath24 must map to either non - edges or weak edges of @xmath1 .    if each vertex @xmath8 of the digraph",
    "@xmath24 has a _ list _ @xmath31 , then a _ list homomorphism _ of @xmath24 to @xmath1 , with respect to the lists @xmath32 , is a homomorphism @xmath33 of @xmath24 to @xmath1 such that @xmath34 for all @xmath35 .",
    "following standard practice  @xcite , we also call a homomorphism of @xmath24 to @xmath1 an _ @xmath1-colouring of @xmath24 _ , and a list homomorphism of @xmath24 to @xmath1 ( with respect to the lists @xmath32 ) a _ list @xmath1-colouring _ of @xmath24 ( with respect to @xmath32 ) .",
    "suppose @xmath1 is a fixed trigraph .",
    "the _ @xmath1-colouring problem _ @xmath36 has as instances digraphs @xmath24 , and asks whether or not @xmath24 admits an @xmath1-colouring .",
    "the _ list @xmath1-colouring problem _ @xmath36 has as instances digraphs @xmath24 with lists @xmath32 , and asks whether or not @xmath24 admits a list @xmath1-colouring with respect to @xmath32 . as noted earlier , @xmath1 could be a digraph , viewed as a trigraph ( with @xmath18 , @xmath37 ) .",
    "digraph homomorphism and list homomorphism problems have been of much interest @xcite . if necessary , we will emphasize the distinction between _ trigraph _ list homomorphism problems and _ digraph _ list homomorphism problems , depending on whether @xmath1 is a trigraph or a digraph respectively , i.e. , whether @xmath1 has any strong edges or not .",
    "however , note that the input @xmath24 is always  a  digraph .    for a fixed trigraph @xmath1 , the list @xmath1-colouring problem l - hom@xmath36 concerns the existence of vertex partitions of the input digraphs @xmath24 . for instance , if @xmath1 is the undirected trigraph with @xmath38 , with a strong loop at @xmath39 and a weak edge joining @xmath40 and @xmath39 , then an @xmath1-colouring of @xmath24 is precisely a partition of @xmath41 into a clique and an independent set .",
    "thus @xmath24 is @xmath1-colourable if and only if @xmath24 is a split graph .",
    "many graph partition problems , especially those arising from the theory of perfect graphs , can be formulated as trigraph homomorphism ( or list homomorphism ) problems ; this is discussed in detail in @xcite .",
    "equivalently , all these problems can be described in terms of the adjacency matrix of the trigraph , in the language of matrix partitions and list partitions ( see @xcite ) . in this paper",
    "it will be more convenient to emphasize the trigraph ( rather than the matrix ) terminology , since we are dealing with the structure of the trigraph @xmath1 .",
    "it is generally believed @xcite that for each digraph @xmath1 the @xmath1-colouring problem hom@xmath36 is @xmath0-complete or polynomial time solvable .",
    "( this is equivalent to the so - called _ csp dichotomy conjecture _ of feder and vardi @xcite . )",
    "one special case when the dichotomy conjecture is known to hold is the case of undirected graphs ( i.e. , symmetric digraphs ) . in this case , hom@xmath36 is polynomial time solvable if @xmath1 has a loop or is bipartite and is @xmath0-complete otherwise @xcite . for the list homomorphism problem ,",
    "it is shown in @xcite that l - hom@xmath36 is polynomial time solvable if @xmath1 is a so - called _ bi - arc graph _ ( a simultaneous generalization of reflexive interval graphs and bipartite graphs whose complements are circular arc graphs ) , and is @xmath0-complete otherwise . a more general result of bulatov @xcite handles all constraint satisfaction problems , implying , in particular , that for each digraph @xmath1 , the list @xmath1-colouring problem l - hom@xmath36 is @xmath0-complete or polynomial time solvable .",
    "by contrast , this is not known for trigraph list homomorphism problems , and in @xcite it is only proved that for each trigraph @xmath1 , the list @xmath1-colouring problem is @xmath0-complete or _ quasi - polynomial _ ( of complexity @xmath42 ) .",
    "all list @xmath1-colouring problems l - hom@xmath36 for trigraphs @xmath1 with three or fewer vertices have been classified as @xmath0-complete or polynomial time solvable in @xcite . for symmetric trigraphs with four vertices , this has been accomplished in @xcite , with the exception of a single trigraph @xmath1 ; the corresponding problem remains open and has earned the name _ the stubborn problem _ ( figure [ fig : ex1]a ) .",
    "the best known algorithm for this problem has complexity @xmath43 , implying it is unlikely to be @xmath0-complete @xcite .",
    "thus ( polynomial / @xmath0-complete ) dichotomy for trigraph list homomorphism problems seems less likely than for _ digraph _ list homomorphism problems .    in this paper",
    "we prove dichotomy for the class of _ trigraph trees _",
    ", i.e. , for trigraphs whose underlying graph is a tree .",
    "it turns out that if @xmath1 is a trigraph tree , then the list @xmath1-colouring problem is polynomially equivalent to a list @xmath44-colouring problem where @xmath44 is a _ digraph _",
    "obtained from @xmath1 by removing all vertices with a strong loop and removing all other strong edges @xmath21 ( and their converses @xmath45 if any ) .",
    "we conduct the proof of this result in such a way that it in fact implies the dichotomy for a large class of trigraphs , which includes all digraphs and all trigraph trees .",
    "we think of these trigraphs as _ tree - like _ , although it is only the structure of the strong edges that is tree - like . for trigraphs that are not tree - like ( in our definition )",
    ", we illustrate the possible complications .",
    "we believe that our class of tree - like trigraphs covers an important portion of the class of trigraphs @xmath1 in which the strong edges do not significantly impact the complexity of the list @xmath1-colouring problem .",
    "let @xmath1 be a trigraph , and let @xmath24 be a digraph with list @xmath46 for each @xmath47 .",
    "we shall denote by @xmath48 the number of vertices in @xmath24 , and by @xmath49 the number of vertices in @xmath1 .",
    "we say that lists @xmath50 are _ a reduction of @xmath32 _ , if we have @xmath51 for each @xmath47 .    in the following text",
    ", we shall say that lists @xmath32 can be _ reduced _ to satisfy property @xmath52 to mean that for every instance consisting of a graph @xmath24 with lists @xmath32 , there exist lists @xmath50 on @xmath24 such that    a.   the lists @xmath50 can be found in polynomial time b.   the lists @xmath50 are a reduction of @xmath32 c.   the lists @xmath50 satisfy property @xmath52 , and d.   @xmath24 has a list @xmath1-colouring with respect to @xmath32 if and only if @xmath24 has a list @xmath1-colouring with respect to @xmath50 .",
    "we shall say that lists @xmath32 can be _ transformed _ to satisfy property @xmath52 to mean that for every instance @xmath24 with lists @xmath32 , there exists a set @xmath53 of lists such that    a.   the set @xmath54 can be constructed in polynomial time b.   each @xmath55 is a reduction of @xmath32 c.   each @xmath55 satisfies property @xmath52 , and d.   @xmath24 has a list @xmath1-colouring with respect to @xmath32 if and only if there exists an @xmath56 such that @xmath24 has a list @xmath1-colouring with respect to @xmath55 .",
    "note that while reducing the lists results in a single problem , transforming the lists produces a family of problems , as illustrated in figure [ fig:1 ] .",
    "@xmath57[f]{\\phantom{s}}=\"a1 \" ; ( -1,-0.5)*[o][f]{\\phantom{s}}=\"a2 \" ; { \\ar \" a1\";\"a2 \" } ; \" a1\"+(0,0.4)*{l } ; \" a2\"+(0.1,-0.4)*{l ' } ; ( 0,0)*[r]{\\mbox{\\em `` reduced '' } } ; ( -1,-2.5)*[o][f]{\\phantom{s}}=\"a1 \" ; ( -2,-3.5)*[o][f]{\\phantom{s}}=\"a2 \" ; ( -1.5,-3.5)*[o][f]{\\phantom{s}}=\"a3 \" ; ( -1,-3.5)*[o][f]{\\phantom{s}}=\"a4 \" ; ( -0.5,-3.5)*[o]{\\ldots}=\"a5 \" ; ( 0,-3.5)*[o][f]{\\phantom{s}}=\"a6 \" ; { \\ar \" a1\";\"a2 \" } ; { \\ar \" a1\";\"a3 \" } ; { \\ar \" a1\";\"a4 \" } ; { \\ar \" a1\";\"a6 \" } ; \" a1\"+(0,0.4)*{l } ; \" a2\"+(0.1,-0.3)*{_{l_1 } } ; \" a3\"+(0.1,-0.3)*{_{l_2 } } ; \" a4\"+(0.1,-0.3)*{_{l_3 } } ; \" a6\"+(0.25,-0.35)*{_{l_{p(n ) } } } ; ( 0,-2.7)*[r]{\\mbox{\\em `` transformed '' } } ; ( 4.3,0.5)*[o][f]{\\phantom{s}}=\"a1 \" ; ( 4.3,-0.5)*[o][f]{\\phantom{s}}=\"a2 \" ; ( 4.3,-1.5)*[o][f]{\\phantom{s}}=\"a3 \" ; ( 4.3,-1.9)*[o]{\\vdots } ; ( 4.3,-2.5)*[o][f]{\\phantom{s}}=\"a4 \" ; ( 4.3,-3.5)*[o][f]{\\phantom{s}}=\"a5 \" ; { \\ar \" a1\";\"a2 \" } ; { \\ar \" a2\";\"a3 \" } ; { \\ar \" a4\";\"a5 \" } ; \" a1\"+(0,0.4)*{l } ; \" a5\"+(0.1,-0.4)*{l^ * } ; ( 4.8,0)*[r]{arc } ; ( 4.8,-1)*[r]{sep } ; ( 4.8,-2)*[r]{arc } ; ( 4.3,-4.5)*{arc+sep } ; ( 9,1)*[o][f]{\\phantom{s}}=\"a0 \" ; ( 9,0)*[o][f]{\\phantom{s}}=\"a1 \" ; ( 8,-1)*[o][f]{\\phantom{s}}=\"a21 \" ; ( 8.5,-1)*[o][f]{\\phantom{s}}=\"a22 \" ; ( 9,-1)*[o][f]{\\phantom{s}}=\"a23 \" ; ( 9.5,-1)*[o]{\\ldots}=\"a24 \" ; ( 10,-1)*[o][f]{\\phantom{s}}=\"a25 \" ; { \\ar \" a0\";\"a1 \" } ; { \\ar \" a1\";\"a21 \" } ; { \\ar \" a1\";\"a22 \" } ; { \\ar \" a1\";\"a23 \" } ; { \\ar \" a1\";\"a25 \" } ; ( 8,-2)*[o][f]{\\phantom{s}}=\"a31 \" ; ( 8.5,-2)*[o][f]{\\phantom{s}}=\"a32 \" ; ( 9,-2)*[o][f]{\\phantom{s}}=\"a33 \" ; ( 9.5,-2)*[o]{\\ldots}=\"a34 \" ; ( 10,-2)*[o][f]{\\phantom{s}}=\"a35 \" ; { \\ar \" a21\";\"a31 \" } ; { \\ar \" a22\";\"a32 \" } ; { \\ar \" a23\";\"a33 \" } ; { \\ar \" a25\";\"a35 \" } ; ( 8,-2.4)*[o]{\\vdots } ; ( 8.5,-2.4)*[o]{\\vdots } ; ( 9,-2.4)*[o]{\\vdots } ; ( 10,-2.4)*[o]{\\vdots } ; ( 8,-3)*[o][f]{\\phantom{s}}=\"a41 \" ; ( 8.5,-3)*[o][f]{\\phantom{s}}=\"a42 \" ; ( 9,-3)*[o][f]{\\phantom{s}}=\"a43 \" ; ( 9.5,-3)*[o]{\\ldots}=\"a44 \" ; ( 10,-3)*[o][f]{\\phantom{s}}=\"a45 \" ; ( 8,-4)*[o][f]{\\phantom{s}}=\"a51 \" ; ( 8.5,-4)*[o][f]{\\phantom{s}}=\"a52 \" ; ( 9,-4)*[o][f]{\\phantom{s}}=\"a53 \" ; ( 9.5,-4)*[o]{\\ldots}=\"a54 \" ; ( 10,-4)*[o][f]{\\phantom{s}}=\"a55 \" ; { \\ar \" a41\";\"a51 \" } ; { \\ar \" a42\";\"a52 \" } ; { \\ar \" a43\";\"a53 \" } ; { \\ar \" a45\";\"a55 \" } ; \" a0\"+(0,0.4)*{l } ; \" a5\"+(0.1,-0.4)*{l^ * } ; ( 10,0.8)*[r]{weak } ; ( 9.5,0.4)*[r]{domination } ; ( 10.5,-0.5)*[r]{s\\mbox{-}d } ; ( 10.5,-1.5)*[r]{arc } ; ( 10.5,-2.5)*[r]{sep } ; \" a51\"+(0.1,-0.35)*{_{l^*_1 } } ; \" a52\"+(0.1,-0.35)*{_{l^*_2 } } ; \" a53\"+(0.1,-0.35)*{_{l^*_3 } } ; \" a55\"+(0.25,-0.4)*{_{l^*_{p(n ) } } } ; ( 9,-5)*{arc+sep+s\\mbox{-}d } ; \\endxy $ ]    we say that lists @xmath32 are _ non - empty _ if the list @xmath58 for each vertex @xmath47 is not empty . clearly , if @xmath24 admits a list homomorphism to @xmath1 with respect to @xmath32 , then the lists @xmath32 are non - empty . hence ,",
    "to avoid trivial cases in what follows , we shall always assume that lists @xmath32  are  non - empty .",
    "we say that lists @xmath32 are _ arc - consistent _ if for each @xmath59 and each @xmath60 , there exists @xmath61 such that ( i ) @xmath62 if @xmath63 , ( ii ) @xmath64 if @xmath65 , ( iii ) @xmath66 if @xmath67 , and ( iv ) @xmath68 if @xmath69 .    [ lem:1 ] lists @xmath32 can be reduced to be arc - consistent .",
    "if some @xmath59 violate the above condition for @xmath60 , no @xmath1-colouring of @xmath24 with respect to @xmath32 maps @xmath70 to @xmath71 . hence , @xmath71 can be removed from @xmath58 without changing the existence of solutions .",
    "we repeatedly test for such violations and reduce the lists if a violation is found .",
    "after at most @xmath72 such steps either we obtain arc - consistent lists .",
    "( note that if one final list is empty then all are empty , by arc - consistency . )",
    "we say that lists @xmath32 contain _ representatives _ , if there is a set @xmath73 such that    a.   for each @xmath74 , the list @xmath75 , and b.   for each @xmath76 , there is a vertex @xmath74 with @xmath77 ,    [ lem:2 ] lists @xmath32 can be transformed to contain representatives .",
    "we construct the set @xmath78 as follows .",
    "the lists @xmath55 are obtained in performing in every possible way the following process . for each vertex @xmath79 , we either select a vertex of @xmath24 and set its list to @xmath80 , or we remove @xmath71 from all lists .",
    "the resulting lists @xmath55 contain representatives for the set @xmath81 of vertices @xmath71 for which some list in @xmath24 was set to @xmath80 .",
    "moreover , the vertices of @xmath82 do not appear in @xmath55 .",
    "the _ symmetric trigraph @xmath83 associated with @xmath1 _ is the trigraph on the vertices of @xmath1 with strong edges @xmath21 iff @xmath84 , and with weak edges @xmath21 iff @xmath85 or @xmath68 but @xmath86 .",
    "a graph @xmath24 is _ chordal _ if @xmath24 contains no induced cycle of length four or longer .",
    "chordal completion _",
    "@xmath87 of @xmath24 is a chordal graph on the vertices of @xmath24 with @xmath88 .",
    "a chordal completion @xmath87 is _ minimal _ if no chordal completion @xmath89 of @xmath24 satisfies @xmath90 .",
    "@xcite[prop : tarjan ] let @xmath87 be a minimal chordal completion of @xmath24 , and let @xmath91 be a clique of @xmath24 .",
    "then there are no edges in @xmath87 between vertices of different components of @xmath92 .",
    "we say that lists @xmath32 contain _ strong representatives _ , if for each strong loop @xmath71 of @xmath1 , there is a set @xmath93 such that    a.   @xmath94 whenever @xmath95 , b.   each vertex of @xmath96 is a symmetric neighbour of @xmath71 , and c.   @xmath97 is connected in the symmetric graph of  @xmath1 .",
    "[ lem:3 ] lists @xmath32 can be transformed to contain strong representatives .",
    "let @xmath24 be a digraph with lists @xmath32 , and let @xmath33 be a list @xmath1-colouring of @xmath24 with respect to @xmath32 .",
    "by lemmata [ lem:1 ] and [ lem:2 ] , we may assume that the lists @xmath32 are arc - consistent and contain representatives .",
    "let @xmath71 be a strong loop of @xmath1 . since @xmath33 is a homomorphism , if @xmath98 for @xmath59 , we must have both @xmath99 and @xmath100 in @xmath101 . hence , the set @xmath102 induces a symmetric clique in @xmath24 .",
    "let @xmath87 be the symmetric graph of @xmath24 , and @xmath83 be the symmetric trigraph associated with @xmath1 .",
    "clearly , @xmath91 also induces a clique in @xmath87 .",
    "moreover , it is easy to show that @xmath33 is also a list @xmath83-colouring of @xmath87 with respect to @xmath32 .    now , suppose that @xmath71 appears on some list .",
    "then , since the lists @xmath32 contain representatives , there is a vertex @xmath103 with @xmath104 .",
    "let @xmath105 denote the subset of @xmath17 containing @xmath71 and its symmetric neighbours .",
    "let @xmath106 denote the subset of @xmath41 containing @xmath107 and its symmetric neighbours .",
    "let @xmath108 denote the subset of @xmath41 containing all vertices @xmath109 with @xmath60 .",
    "since the lists @xmath32 are arc - consistent , we must have @xmath110 .",
    "also , for each @xmath111 , we have @xmath112 .",
    "now , since @xmath33 respects the lists @xmath32 , we have @xmath60 , for each @xmath113 .",
    "hence , @xmath114 , and therefore , @xmath91 induces a clique in @xmath115 $ ] .",
    "furthermore , since @xmath110 , we have @xmath112 for each @xmath116 .",
    "hence , @xmath33 restricted to @xmath108 is a homomorphism of @xmath115 $ ] to @xmath117 $ ] .",
    "in particular , each component of @xmath115-c$ ] maps by @xmath33 to a unique component of @xmath117-x$ ] .",
    "now , let @xmath89 be a minimal chordal completion of @xmath115 $ ] .",
    "let @xmath118 be the vertices of a maximal clique of @xmath89 that completely contains @xmath91 . by proposition [ prop : tarjan ] , all vertices of @xmath119 belong to one component of @xmath115-c$ ] .",
    "hence , by the above remark , there is a unique component @xmath120 of @xmath117-x$ ] such that @xmath121 for each @xmath122 .",
    "it now follows that @xmath24 admits a list @xmath1-colouring with respect to @xmath32 if and only if for some maximal clique @xmath118 of a minimal chordal completion @xmath89 of @xmath115 $ ] , and some component @xmath120 of @xmath117-x$ ] , the graph @xmath24 admits a list @xmath1-colouring with respect to @xmath32 such that the vertices outside of @xmath118 do not map to @xmath71 , and the vertices in @xmath118 map to @xmath71 or the vertices of @xmath120 .",
    "hence , we can modify the lists @xmath32 by removing @xmath71 from the vertices outside @xmath118 and by reducing the lists of the vertices in @xmath118 to @xmath123 .",
    "such lists , clearly , contain a strong representative for @xmath71 .",
    "( take @xmath124 to be  @xmath123 . )",
    "to conclude , we remark that the graph @xmath87 and the sets @xmath108 and @xmath105 , as well as , a minimal chordal completion @xmath89 of @xmath115 $ ] by the result @xcite can be found in polynomial time . since @xmath89 is chordal , it has at most @xmath48 maximal cliques @xcite",
    ". also , there are at most @xmath49 different components @xmath120 of @xmath117-x$ ] .",
    "hence , we can reduce the problem to at most @xmath125 different instances with strong representatives .",
    "the proof is now complete .",
    "note that if lists @xmath32 contain representatives , respectively strong representatives , then any non - empty reduction @xmath50 of @xmath32 also contains representatives , respectively strong representatives .",
    "let @xmath126 be a set of edges of @xmath1 .",
    "let @xmath127 denote the graph obtained from @xmath24 by removing all edges @xmath63 such that @xmath128 for some @xmath129  and  @xmath61 .",
    "we say that lists @xmath32 are _ separator - consistent on @xmath126 _ , if for each component @xmath91 of @xmath127 and each component @xmath120 of @xmath130 ,    a.   either there exists a list @xmath120-colouring of @xmath91 with respect to @xmath32 , b.   or no vertex of @xmath120 appears on the list of any vertex of @xmath91 .    [ lem:4 ] if l - hom@xmath131 is polynomial time solvable , then the lists @xmath32 can be reduced to be separator - consistent on @xmath126 .",
    "we obtain a separator - consistent lists @xmath50 from @xmath32 as follows . for each component @xmath91 of @xmath127 , and each component @xmath120 of @xmath130 , we test if @xmath91 admits a list @xmath120-colouring with respect to @xmath32 . if not , then we remove all vertices of @xmath120 from the lists of the vertices of @xmath91 . since homomorphisms map connected graphs only to connected graphs , the claim follows .    in particular , we have the following property .",
    "[ lem:5 ] if l - hom@xmath131 is polynomial time solvable , then the lists @xmath32 can be reduced to be arc - consistent and separator - consistent on @xmath126 .",
    "we apply lemmata [ lem:1 ] and [ lem:4 ] to @xmath32 until the lists no longer change .",
    "since at each step the lists are reduced , the claim follows .",
    "we remark that for @xmath73 , we say that the lists @xmath32 are _ separator - consistent on @xmath81 _ , if they are separator - consistent on @xmath126 , where @xmath126 is the set of edges of @xmath1 with at least one endpoint in @xmath81 .",
    "let @xmath81 and @xmath132 be two sets of vertices of @xmath1 such that each vertex of @xmath81 has a strong loop , and no vertex of @xmath132 has a loop .",
    "we say that lists @xmath32 are _ sparse - dense - consistent on @xmath81 and @xmath132 _ if for each @xmath74 such that @xmath133 , we have @xmath75 or @xmath134 .    [ lem:6 ] if l - hom@xmath135)$ ] and l - hom@xmath136)$ ] are polynomial time solvable , then the lists @xmath32 can be transformed to be sparse - dense - consistent on @xmath81 and @xmath132 .",
    "let @xmath137 and @xmath138 be classes of digraphs closed under taking induced subgraphs .",
    "suppose that there is a constant @xmath139 such that each digraph in @xmath140 has at most @xmath141 vertices .",
    "then by @xcite , for any @xmath48-vertex digraph @xmath24 , there are at most @xmath142 partitions @xmath143 such that @xmath144\\in\\mathcal s$ ] and @xmath145\\in\\mathcal d$ ] .",
    "( we call each such partition an",
    "_ @xmath146-partition _ of @xmath24 . )",
    "all these partitions can be enumerated in time @xmath147 where @xmath148 is the complexity of recognizing digraphs in @xmath137 and in @xmath138 .",
    "now , let @xmath137 be the set of all digraphs admitting an @xmath149$]-colouring and @xmath138 be the set of all digraphs admitting an @xmath150$]-colouring ; we have @xmath151 .",
    "let @xmath152 denote the vertices @xmath70 of @xmath24 with @xmath153 .",
    "we observe that any list @xmath1-colouring of @xmath24 with respect to @xmath32 induces an @xmath154-partition of @xmath155 $ ] .",
    "hence , for each @xmath154-partition @xmath156 of @xmath155 $ ] , we construct lists @xmath50 on @xmath1 as follows : @xmath157 if @xmath158 , @xmath159 if @xmath116 , and @xmath160 otherwise . clearly",
    ", @xmath50 is sparse - dense consistent on @xmath81 and @xmath132 .",
    "now , since there are at most @xmath161 such partitions , the claim follows .",
    "let @xmath162 be a set of vertices of @xmath1 , and let @xmath163 be two vertices of @xmath1 .",
    "we say that @xmath164 _ weakly dominates @xmath71 on @xmath162 _ , if for each @xmath165 , we have that @xmath166 is a weak edge in @xmath1 whenever @xmath167 is a weak edge in @xmath1 , and @xmath168 is a weak edge in @xmath1 whenever @xmath169 is a weak edge in @xmath1 .",
    "we say that _",
    "@xmath164 weakly dominates @xmath71 _ if @xmath164 weakly dominates @xmath71 on @xmath17 .",
    "[ lem:7 ] if @xmath164 weakly dominates @xmath71 , then the lists @xmath32 can be reduced to satisfy @xmath170 whenever @xmath171 .    by lemmata [ lem:1 ] and [ lem:2 ] , we may assume that the lists @xmath32 are arc - consistent and contain representatives .",
    "let @xmath33 be a list @xmath1-colouring of @xmath24 with respect to @xmath32 .",
    "let @xmath172 be a mapping such that @xmath173 if @xmath174 and @xmath171 , and @xmath175 otherwise .",
    "we show that @xmath172 is also a homomorphism and the claim will follow .",
    "let @xmath176 be any vertex ( including @xmath71 and @xmath164 ) of @xmath1 .",
    "suppose that @xmath177 , @xmath178 is not an edge , and @xmath176 appears on some list .",
    "we claim that no list @xmath58 contains both @xmath71 and @xmath164 . to prove this ,",
    "let @xmath179 be a vertex with @xmath180 .",
    "suppose that @xmath181 .",
    "if @xmath182 , then by arc - consistency of @xmath32 , we obtain @xmath183 .",
    "if @xmath184 , similarly @xmath185 , a contradiction .    moreover , by symmetry , if @xmath186 and @xmath187 is not an edge , or if @xmath71 and @xmath164 exchange places , we also have that no list contains both @xmath71 and @xmath164 . in  addition , since @xmath164 weakly dominates @xmath71 , we obtain that either both @xmath71 and  @xmath164 have strong loops , or both have no loops , or @xmath164 has a weak loop .    now , it is not difficult to directly verify that @xmath172 is a homomorphism using the above observations and the fact that @xmath164 weakly dominates @xmath71 .",
    "hence , @xmath24 has a list @xmath1-colouring with respect to @xmath32 if and only if @xmath24 has a list @xmath1-colouring with respect to the lists @xmath50 obtained from @xmath32 by removing @xmath71 from each list @xmath188 that also contains @xmath164 . that concludes the proof .",
    "let @xmath81 , @xmath132 , and @xmath152 be three sets of vertices of @xmath1 such that each vertex of @xmath81 has a strong loop , no vertex of @xmath132 has a loop , and each vertex of @xmath152 has a weak loop .",
    "suppose that each vertex of @xmath152 weakly dominates each vertex of @xmath132 , and that we have @xmath189 whenever @xmath190 .",
    "[ lem:8 ] let @xmath191 be as above . if l - hom@xmath135)$ ] and are polynomial time solvable , then the lists @xmath32 can be transformed to be arc - consistent , separator - consistent on @xmath81 , and sparse - dense - consistent on @xmath81  and  @xmath132 .    we observe that by lemma [ lem:7 ] , we may assume that no list @xmath58 contains both a vertex of @xmath132 and a vertex of @xmath152 .",
    "hence , either @xmath192 , or @xmath153 , or @xmath193 for each @xmath47 .",
    "now , let @xmath55 be one of the lists we obtain from @xmath32 by applying sparse - dense consistency on @xmath81 and @xmath132 ( lemma [ lem:6 ] ) .",
    "then we must have either @xmath194 , or @xmath195 , or @xmath196 , or @xmath197 for each @xmath47 .",
    "in particular , any reduction of @xmath55 must also satisfy this condition .",
    "hence , we can apply lemma [ lem:5 ] to @xmath55 , and the claim follows .",
    "let @xmath198 be a partition of the vertices of @xmath1 .",
    "let @xmath126 be the edges of @xmath1 that have exactly one endpoint in @xmath199 .",
    "let @xmath81 respectively @xmath132 be the vertices of @xmath199 respectively @xmath108 with at least one incident edge in @xmath126 .",
    "we say that @xmath24 is _ separable _ on @xmath126 , if for each vertex @xmath74 ,    a.   @xmath188 contains at most one vertex of @xmath81 and at most one vertex of @xmath132 , b.   if @xmath188 contains a vertex of @xmath81 , it contains no vertex of @xmath200 , and c.   if @xmath188 contains a vertex of @xmath132 , it contains no vertex of @xmath201 .",
    "[ lem:9 ] if l - hom(@xmath202 ) is polynomial time solvable , then l - hom(@xmath1 ) is polynomial time solvable on the class of all digraphs @xmath24 separable on @xmath126 .",
    "first , we observe if @xmath24 with lists @xmath32 is separable on @xmath126 , then for any reduction @xmath50 of @xmath32 , the graph @xmath24 with lists @xmath50 is separable on @xmath126 .",
    "hence , by lemmata [ lem:1 ] and [ lem:2 ] , we may assume that the lists @xmath32 are arc - consistent and contain representatives .",
    "next , we show that l - hom@xmath203)$ ] can be solved in polynomial time on any @xmath127 given that @xmath24 is separable on @xmath126 .",
    "indeed , consider a component @xmath91 of @xmath127 , and let @xmath50 be lists such that @xmath204 for each @xmath205 .",
    "since @xmath24 is separable on @xmath126 , we have either @xmath206 , or @xmath207 . hence",
    ", if @xmath108 denotes the vertices with @xmath207 , then arc - consistency of @xmath32 implies that @xmath91 has a list @xmath208$]-colouring with respect to @xmath32 if and only if @xmath209 has a list @xmath210-colouring with respect to @xmath50 .",
    "similarly , for l - hom@xmath211)$ ] .",
    "hence , l - hom@xmath131 can be solved in polynomial time for @xmath127 given @xmath24 is separable  on  @xmath126 .",
    "it now follows by lemma [ lem:5 ] that we may assume that the lists @xmath32 are arc - consistent and separator - consistent on @xmath126 .",
    "we also assume that lists @xmath32 are non - empty , since otherwise there is no solution .",
    "let @xmath212 be the trigraph constructed from @xmath213 $ ] by adding vertices @xmath214 and @xmath215 with weak loops such that @xmath214 has a weak symmetric edge to each vertex of @xmath81 , and @xmath215 has a weak symmetric edge to each vertex  of  @xmath132 .",
    "let @xmath216 be the lists obtained from @xmath32 by replacing by @xmath214 each @xmath217 such that @xmath218 , and replacing by @xmath215 each @xmath217 such that @xmath219 .",
    "also , let @xmath220 and @xmath221 .",
    "let @xmath222 be a list @xmath212-colouring of @xmath24 with respect to @xmath216 .",
    "let @xmath33 be a list @xmath131-colouring of @xmath127 with respect to @xmath32 such that for each @xmath47 , we have @xmath223 if @xmath224 , and @xmath225 if @xmath226 .",
    "since the lists @xmath32 are separator - consistent on @xmath126 , such a colouring can be found .",
    "we make some observations about @xmath33 .",
    "first , note that @xmath174 if @xmath227 where @xmath76 .",
    "indeed , this follows since @xmath24 is separable on @xmath126 , and @xmath222 respects the lists @xmath216 .",
    "similarly , @xmath228 if @xmath229 . moreover , @xmath230 if @xmath231 , and @xmath232 if @xmath233 .",
    "it now follows that @xmath33 is a homomorphism of @xmath24 to @xmath1 with respect to @xmath32 .    finally , we observe that the lists @xmath216 are all of size at most two .",
    "hence , the mapping @xmath222 can be found in polynomial time by the standard reduction to @xmath234 . that concludes the proof .",
    "in this section , we prove the dichotomy for l - hom@xmath36 for trigraph trees  @xmath1 , i.e. , for trigraphs @xmath1 whose underlying graph is a tree .",
    "partial results along these lines are included in @xcite ; specifically , the case when the underlying graph of @xmath1 is a path is solved there .",
    "let @xmath44 be the digraph obtained from a trigraph @xmath1 by removing all edges @xmath21 such that at least one of @xmath235 is a strong edge of @xmath1 , and by removing all vertices @xmath71 such that @xmath236 is a strong loop in @xmath1 .",
    "[ thm : trees ] if @xmath1 is a trigraph tree , then l - hom@xmath36 is polynomially equivalent to l - hom@xmath237 .",
    "if @xmath1 is a trigraph tree , then l - hom@xmath36 is polynomial time solvable or @xmath0-complete .",
    "suppose that l - hom@xmath36 is polynomial time solvable .",
    "observe that , since the underlying graph of @xmath1 is a tree , each connected component of @xmath44 is an induced subgraph of @xmath1 .",
    "it follows that l - hom@xmath237 is also polynomial time solvable .",
    "suppose that l - hom@xmath237 is polynomial time solvable .",
    "we prove the theorem by induction on the size of @xmath17 .",
    "hence , we shall assume that for each vertex @xmath71 of @xmath1 , l - hom(@xmath238 ) is polynomial time solvable .",
    "let @xmath24 with lists @xmath32 be an instance of l - hom@xmath36 . if @xmath1 contains no strong loops or strong edges , then @xmath239 and there is nothing to prove .",
    "suppose that @xmath1 contains a strong loop at @xmath71 .",
    "by lemmata [ lem:1 ] , [ lem:2 ] , and [ lem:3 ] we may assume that the lists @xmath32 are arc - consistent and contain representatives and strong representatives .",
    "consider the strong representative @xmath124 of @xmath71 .",
    "let @xmath108 denote the vertices @xmath47 with @xmath60 . if @xmath71 has no symmetric neighbours , @xmath240 .",
    "hence , @xmath77 whenever @xmath95 .",
    "therefore , since the lists @xmath32 are arc - consistent , @xmath24 admits a list @xmath1-colouring with respect to @xmath32 if and only if @xmath241 admits a list @xmath242-colouring with respect to @xmath32 .",
    "since l - hom@xmath242 is polynomial time solvable , the claim follows .",
    "now , suppose that @xmath71 has symmetric neighbours .",
    "since the underlying graph of @xmath1 is a tree , it follows that @xmath243 where @xmath164 is a symmetric neighbour  of  @xmath71 .",
    "first , suppose that @xmath164 has no loop .",
    "we apply lemma [ lem:8 ] for @xmath244 , @xmath245 , and @xmath246 , and we see that we may assume that the lists @xmath32 are arc - consistent and sparse - dense - consistent on @xmath80 and @xmath247 .",
    "that is , we have @xmath248 or @xmath249 or @xmath250 for each @xmath47 . in particular , because @xmath243 , we have @xmath248 whenever @xmath60 . since the lists @xmath32 are arc - consistent , the claim follows exactly as above .",
    "next , suppose that @xmath164 has a weak loop .",
    "let @xmath120 be the component of @xmath238 to which @xmath164 belongs .",
    "observe that @xmath164 weakly dominates @xmath71 on @xmath251 .",
    "we apply lemma [ lem:8 ] for @xmath244 , @xmath252 , and @xmath253 .",
    "this implies that we may assume that the lists @xmath32 are arc - consistent and separator - consistent on @xmath81 .",
    "moreover , @xmath241 admits a list @xmath242-colouring with respect to @xmath32 , since otherwise lhom@xmath36 has no solution for @xmath24 with lists  @xmath32 .",
    "hence , we let @xmath222 be a list @xmath242-colouring of @xmath241 with respect to @xmath32 such that @xmath222 restricted to any component @xmath91 of @xmath241 is a @xmath120-colouring as long as a vertex of @xmath120 appears on the list of some vertex of @xmath91 .",
    "since the lists @xmath32 are separator - consistent on @xmath81 , such a mapping must exist .",
    "in fact , @xmath222 can be constructed in polynomial time , since l - hom@xmath242 is polynomial time solvable .",
    "we extend this mapping to @xmath24 and show that this yields a homomorphism .",
    "let @xmath33 be a mapping defined as follows .",
    "@xmath254    note that since @xmath243 , we have for @xmath116 either @xmath248 or @xmath255 .",
    "hence , the mapping @xmath33 is well - defined .",
    "moreover , @xmath33 clearly respects the lists @xmath32 .",
    "we show that @xmath33 is also a homomorphism .",
    "suppose that @xmath256 for some @xmath63 .",
    "clearly , at least one of @xmath257 must belong to @xmath108 , since @xmath222 is a homomorphism .",
    "also , if @xmath248 , or @xmath77 , or both @xmath258 , we obtain a contradiction by arc - consistency of @xmath32 .",
    "hence , we can assume , by symmetry , that @xmath116 , @xmath259 , and @xmath228 . since the list @xmath32 are arc - consistent , there exists @xmath260 such that @xmath261 .",
    "in particular , @xmath262 since @xmath259 , and hence , @xmath263 belongs to @xmath120 .",
    "therefore , if @xmath91 is the component of @xmath241 to which @xmath8 belongs , @xmath222 restricted to @xmath91 is a @xmath120-colouring .",
    "in particular , @xmath264 .",
    "now , if @xmath265 , both @xmath71 and @xmath164 can not belong to @xmath58 by arc - consistency . if @xmath266 , then @xmath267 since @xmath164 weakly dominates @xmath71 on @xmath251 .",
    "therefore , @xmath268 .",
    "but , since the lists @xmath32 are arc - consistent , and @xmath255 , we obtain a contradiction .",
    "suppose now that @xmath269 for @xmath67 . clearly , @xmath116 or @xmath270 .",
    "again , if @xmath248 , or @xmath77 , or @xmath258 , we have a contradiction .",
    "hence , we can assume , by symmetry , that @xmath116 , @xmath259 , and @xmath228 . also , since @xmath271 is an edge and @xmath259 , @xmath272 belongs to @xmath120 .",
    "as above , @xmath273 can neither be a non - edge nor a weak edge by arc - consistency of @xmath32 , respectively the fact that @xmath164 weakly dominates @xmath71 on @xmath251 .",
    "therefore , @xmath265 , and again , since the lists @xmath32 are arc - consistent and @xmath255 , we have a contradiction .",
    "this proves that @xmath33 is indeed a list @xmath1-colouring of @xmath24 with respect to @xmath32 , and clearly , @xmath33 can be constructed in polynomial time .    next ,",
    "suppose that @xmath164 has a strong loop .",
    "consider the strong representative @xmath274 .",
    "if  @xmath275 or @xmath276 where @xmath277 , it follows that @xmath248 whenever @xmath60 . in this case , the claim follows , as above , from arc - consistency of @xmath32 .",
    "hence , we may assume @xmath278 .",
    "we observe that @xmath279 contains two components , a component @xmath199 which contains @xmath71 , and a component @xmath108 which contains @xmath164 .",
    "therefore , if we let @xmath244 and @xmath245 , then the list @xmath188 of any vertex @xmath74 either does not contain both @xmath71 and @xmath164 , or @xmath280 .",
    "this shows that @xmath24 is separable on @xmath281 .",
    "in addition , l - hom@xmath282 is polynomial time solvable .",
    "therefore , by lemma [ lem:9 ] , we can solve l - hom@xmath36 for @xmath24 with the lists @xmath32 in polynomial  time .",
    "finally , suppose that @xmath1 contains a strong edge @xmath21 , and @xmath45 is an edge of @xmath1 .",
    "let @xmath199 be the component of @xmath279 which contains @xmath71 , and @xmath108 be the component which contains @xmath164 .",
    "let @xmath244 and @xmath245 . if @xmath71 does not appear on the list of any vertex in @xmath24 , then @xmath24 with the lists @xmath32 is an instance of which is polynomial time solvable .",
    "similarly for @xmath164 .",
    "hence , since the lists @xmath32 contain representatives , there exist vertices @xmath283 such that @xmath104 and @xmath284 . now , suppose that the list @xmath58 contains  @xmath71 . by arc - consistency",
    ", we must have @xmath285 . since @xmath164 is not adjacent to any vertex of @xmath200 and @xmath285",
    ", no vertex of @xmath200 can appear on the list @xmath58 .",
    "similarly , if @xmath171 , no vertex of @xmath201 appears on the list @xmath58 .",
    "this shows that @xmath24 is separable on @xmath286 .",
    "if @xmath45 is not an edge of @xmath1 , the same argument shows that @xmath24 is separable on @xmath281 . in both cases ,",
    "the claim follows by lemma  [ lem:9 ] .",
    "that concludes the proof .",
    "in this section , we extend the dichotomy from the previous section to a larger class of trigraphs which we refer to as _ tree - like_. in fact , we prove the dichotomy for this class using the same tools we used in the previous section .",
    "we have stated these tools in a sufficiently general way to easily allow for this extension .",
    "_ domination property _",
    "we say that an ordering @xmath287 of vertices is a _ domination ordering _",
    ", if @xmath288 weakly dominates @xmath289 whenever @xmath290 .",
    "let @xmath1 be a trigraph , and suppose that @xmath71 is strong loop of @xmath1 .",
    "for a component @xmath120 of @xmath238 , let @xmath291 denote the set of all symmetric neighbours of @xmath71 in @xmath120 . recall that according to our definitions , @xmath164 is a symmetric neighbour of @xmath71 just if both @xmath21 and @xmath45 are in @xmath292 .",
    "we say that a component @xmath120 satisfies _ the domination property _ if    1 .",
    "no vertex of @xmath291 has a strong loop , and 2 .",
    "the vertices of @xmath291 with weak loops admit a domination ordering , each weakly dominates @xmath71 on @xmath251 , and each weakly dominates every vertex of @xmath291 without a loop .    _ matching property _",
    "let @xmath126 be the edges of @xmath1 .",
    "we say that @xmath126 _ separates @xmath1 _ if each edge @xmath128 has its endpoints @xmath163 in different components of @xmath130 .",
    "thus @xmath126  separates @xmath1 if and only if there is a partition of @xmath17 such that @xmath126 is the set of all edges between different parts .",
    "let @xmath293 consist of all edges @xmath294 such that neither @xmath21 nor @xmath45 is a strong edge of @xmath1 .",
    "we say that @xmath126 satisfies _ the matching property _ if    1 .",
    "@xmath126 separates @xmath1 , 2 .   for any @xmath295 ,",
    "both @xmath236 and @xmath296 are strong loops , 3 .",
    "if @xmath297 , and neither @xmath21 nor @xmath166 is a bridge of @xmath1 , then @xmath169 is not a symmetric edge , and @xmath236 or @xmath298 is a strong loop , 4 .   if @xmath299 , and neither @xmath21 nor @xmath169 is a bridge of @xmath1 , then @xmath168 is not a symmetric edge , and @xmath296 or @xmath298 is a strong loop .",
    "if @xmath295 , and @xmath169 and @xmath300 are symmetric edges with @xmath301 , then @xmath302 and @xmath303 .",
    "if @xmath295 , and @xmath169 and @xmath300 are symmetric edges with @xmath304 , then @xmath302 and @xmath305 .",
    "we are now in a position to define the class @xmath306 of _ tree - like trigraphs_.    1",
    ".   if @xmath1 has no strong edges ( or loops ) , then @xmath307 2 .",
    "if @xmath1 contains a strong loop at @xmath71 such that @xmath308 and each component of @xmath238 satisfies the domination property , then @xmath307 .",
    "3 .   if @xmath1 contains a set @xmath126 of edges such that @xmath309 and the set @xmath126 satisfies the matching property , then @xmath307 .",
    "[ thm:4 ] if @xmath1 is a tree - like trigraph , i.e. , if @xmath310 , then is polynomially equivalent to l - hom@xmath237 . in particular , is polynomial time solvable or @xmath0-complete .",
    "we prove the theorem by structural induction on @xmath1 .",
    "we shall assume that @xmath1 is connected , otherwise we treat each component of @xmath1 separately . if @xmath1 is a digraph , there is nothing to prove .",
    "suppose that @xmath1 contains a strong loop at @xmath71 such that @xmath311 and each component of @xmath238 satisfies the domination property .",
    "if l - hom@xmath36 is polynomial time solvable , then so is l - hom@xmath242 . on the other hand , since @xmath311 , we shall assume , by induction , that l - hom@xmath242 is polynomial time solvable .    let @xmath24 with lists @xmath32 be an instance of l - hom@xmath36 . by lemmata [ lem:1 ] , [ lem:2 ] , and [ lem:3 ]",
    ", we may assume that the lists @xmath32 contain representatives and strong representatives .",
    "consider the strong representative @xmath124 .",
    "let @xmath108 be the vertices @xmath47 with @xmath60 .",
    "it follows that there is a unique connected component @xmath120 of @xmath238 such that @xmath312 .",
    "let @xmath244 , let @xmath132 be the vertices of @xmath124 with no loops , and @xmath152 be the vertices of @xmath124 with weak loops . since @xmath120 satisfies the domination property , we have @xmath313 .",
    "also , @xmath152 admits a domination ordering @xmath314 , and each vertex of @xmath152 dominates every vertex of @xmath132 . for @xmath47 ,",
    "let @xmath315 denote the vertex @xmath316 with the smallest index @xmath317 .",
    "now , by lemma [ lem:6 ] , we may assume that for each @xmath47 , either @xmath248 , or @xmath318 , or @xmath185 .",
    "moreover , l - hom@xmath135)$ ] and l - hom@xmath319 are polynomial time solvable since @xmath244 , and by the inductive hypothesis , respectively .",
    "hence , by applying lemma [ lem:8 ] to @xmath191 , we see that may assume that the lists @xmath32 are arc - consistent , separator - consistent on @xmath81 , and sparse - dense - consistent on @xmath81  and  @xmath132 .",
    "now , let @xmath222 be a list @xmath242-colouring of @xmath241 with respect to @xmath32 , such that @xmath222 reduced to any component @xmath91 of @xmath241 is a @xmath120-colouring as long as a vertex of @xmath120 appears on the list of some vertex of @xmath91 .",
    "since the lists @xmath32 are separator - consistent on @xmath81 , such mapping must exist and can be found in polynomial time .",
    "we extend the mapping @xmath222 to a mapping @xmath33 as follows .",
    "@xmath320 by the above remark , the mapping @xmath33 is well - defined .",
    "it also clearly respects the lists @xmath32 .",
    "it remains to show that @xmath33 is a homomorphism .",
    "the proof of this follows exactly as in the proof of theorem [ thm : trees ] , and hence , we skip further  details .",
    "now , suppose that @xmath1 contains edges @xmath126 satisfying the matching property and such that @xmath321 .",
    "again , we assume that l - hom@xmath322 is polynomial time solvable , and that the lists @xmath32 are arc - consistent , contain representatives and strong representatives .",
    "first , we observe that any subset @xmath323 of @xmath126 satisfies the matching property in @xmath324 .",
    "in particular , @xmath325 .",
    "therefore , we can proceed by induction on @xmath126 .",
    "we denote by @xmath326 the vertices of @xmath1 with at least one incident edge from @xmath126 .",
    "we observe that if a vertex @xmath327 does not appear on any list , we can remove from @xmath126 all edges incident to @xmath71 .",
    "since there is at least one such edge , the claim follows by induction .",
    "hence , we shall assume that each vertex of @xmath326 appears on some list .",
    "let @xmath327 be a strong loop .",
    "consider the strong representative @xmath124 .",
    "we claim that either @xmath243 where @xmath128 , or @xmath124 belongs to a component of @xmath130 . to prove this ,",
    "suppose that @xmath328 and @xmath128 . clearly , all of @xmath21 , @xmath329 , and @xmath330 are symmetric edges",
    ". since @xmath126 separates @xmath1 , at least one of @xmath331 must be in @xmath126 .",
    "but that contradicts the matching property .    now , suppose that @xmath124 belongs to a component of @xmath130 .",
    "let @xmath332 denote the union of lists of vertices @xmath47 with @xmath60 .",
    "we have @xmath333 .",
    "since @xmath327 , there exists @xmath164 with @xmath128 or @xmath334 .    by symmetry , suppose that @xmath128 , and suppose also that @xmath21 is a weak edge .",
    "hence , @xmath164 is a strong loop .",
    "consider the strong representative  @xmath274 .",
    "suppose first that @xmath274 also belongs to a component of @xmath130 .",
    "clearly , @xmath335 .",
    "in particular , @xmath336 where  @xmath337 is the union of lists @xmath58 with @xmath171 . furthermore , for @xmath338 and @xmath339 , we have by the matching property that @xmath340 are not edges of @xmath1 , and either @xmath341 or @xmath342 is not an edge of @xmath1 . in particular , if @xmath341 , then arc - consistency of @xmath32 implies @xmath343 .",
    "hence , it follows that the only edge in @xmath1 from @xmath332 to @xmath337 is the edge @xmath21 .",
    "this implies that for any @xmath63 with @xmath60 and @xmath61 , we have @xmath248 and @xmath344 by arc - consistency of @xmath32 .",
    "therefore , we can remove all such edges @xmath99 , and after that , we can remove @xmath21 from @xmath126 .",
    "the claim now follows  by  induction .",
    "next , suppose that @xmath345 where @xmath346 .",
    "let @xmath347 .",
    "by the matching property , we have @xmath348 .",
    "also , either @xmath349 or @xmath342 is not an edge , and either @xmath350 or @xmath351 is not an edge . if @xmath341 , then arc - consistency of @xmath32 implies @xmath352 .",
    "if @xmath353 and @xmath342 is not an edge , then arc - consistency of @xmath32 implies @xmath354 .",
    "again , the only edge from @xmath332 to @xmath337 is the edge @xmath21 , and the claim follows by induction .",
    "therefore , we may assume that any strong loop @xmath327 is either incident to a strong edge of @xmath126 , or we have @xmath243 where @xmath128 .",
    "recall that @xmath126 separates @xmath1 .",
    "first , suppose that @xmath130 contains exactly two components .",
    "we prove that @xmath24 is separable on @xmath126 .",
    "suppose that we have @xmath60 where @xmath327 .",
    "let @xmath120 be the component of @xmath130 which contains @xmath71 .",
    "suppose that there exists @xmath164 such that @xmath128 or @xmath355 and one of @xmath356 is strong .",
    "then , by the matching property and arc - consistency of @xmath32 , the list @xmath58 contains no vertex of @xmath120 other than @xmath71 .",
    "if no such @xmath164 exists , then @xmath236 must be a strong loop .",
    "hence , by the above assumption , we have @xmath243 where @xmath128 .",
    "therefore , @xmath58 again contains no vertex of @xmath120 other than @xmath71 .",
    "the claim now follows by lemma [ lem:9 ] .",
    "finally , suppose that @xmath130 contains more than two components .",
    "let @xmath323 be a smallest subset of @xmath126 such that @xmath357 is disconnected .",
    "since @xmath1 is connected and @xmath130 is disconnected , the set @xmath323 must exist . as remarked above",
    ", @xmath358 satisfies the matching property in @xmath357 .",
    "also , it can be seen that @xmath323 satisfies the matching property in @xmath1 .",
    "since @xmath323 contains at least one edge and @xmath357 contains exactly two components because of minimality , the claim follows by  induction .",
    "that concludes the proof .",
    "the class @xmath306 admits a few natural extensions which we shall only mention tangentially .",
    "for instance , we shall observe the following simple fact .",
    "[ thm : simple ] if each vertex of @xmath1 has a strong loop , and the symmetric graph of @xmath1 contains no triangles , then l - hom@xmath36 is polynomial time solvable .",
    "let @xmath24 with lists @xmath32 be an instance of l - hom@xmath36 .",
    "by lemma [ lem:3 ] , we may assume that the lists @xmath32 contain strong representatives .",
    "since the symmetric graph of @xmath1 has no triangles , it follows that for each @xmath359 , the strong representative @xmath124 contains at most two elements .",
    "the problem now can be reduced to @xmath234 which is polynomial time solvable .    as a consequence",
    ", we can extend the class @xmath306 by adding another basis clause to its recursive description :    1 .",
    "if each vertex of @xmath1 has a strong loop , and the symmetric graph of @xmath1 contains no triangles , then @xmath307 .    similarly , if @xmath1 has no weak edges , i.e. , if @xmath360 , then l - hom@xmath36 is polynomially solvable @xcite .",
    "hence , we can also add the following clause :    1 .   if @xmath1 has no weak edges , then @xmath307 .         since the recursive description of the class @xmath306 is complex",
    ", we shall identify a subclass of @xmath306 which can be defined directly .",
    "let @xmath361 denote all edges @xmath21 of @xmath1 such that either    a.   @xmath21 or @xmath45 is a strong edge of @xmath1 , or b.   @xmath21 and @xmath45 are weak edges of @xmath1 , and @xmath71 and @xmath164 are strong loops of @xmath1 .",
    "we say that @xmath1 is a",
    "_ special tree - like trigraph _ if there is a set @xmath362 of edges of @xmath1 such that    1 .",
    "@xmath363 satisfies the matching property , and 2 .   for every strong loop @xmath71 of @xmath364 ,",
    "each component @xmath120 of @xmath365 satisfies the domination property in @xmath364 .",
    "let @xmath137 denote the class of all special tree - like trigraphs .",
    "also , let @xmath366 denote the class of all trigraph trees .",
    "@xmath367 .",
    "first , let @xmath1 be in @xmath366 .",
    "consider the set @xmath368 . since each edge in @xmath363 is a bridge of @xmath1 , conditions ( m1 ) , ( m3 ) and ( m4 )",
    "are satisfied for @xmath363 .",
    "also , the edges of @xmath363 do not form cycles in @xmath1 since @xmath1 is a trigraph tree , and hence , ( m5 ) and ( m6 ) are satisfied .",
    "therefore , @xmath363 satisfies the matching property . on the other hand , for every vertex @xmath71 of @xmath1 with a strong loop",
    ", each component of @xmath238 satisfies the domination property , since @xmath71 is adjacent to at most one vertex of this component .",
    "it follows that  @xmath369 .",
    "now , for @xmath369 , it suffices to observe that edges @xmath21 of @xmath370 have both @xmath71 and @xmath164 strong loops .",
    "hence , after removing @xmath363 using ( t3 ) and then removing all vertices with strong loops using ( t2 ) , we obtain precisely @xmath44 which is a digraph .",
    "hence , by ( t1 ) , we conclude that @xmath371 .    if @xmath1 is a special tree - like trigraph , i.e. , if @xmath369 , then is polynomial time solvable or @xmath0-complete .",
    "although some simple extensions of tree - like , or special tree - like trigraphs are possible ( such as , say , theorem [ thm : simple ] ) , we shall mention in the conclusions some example trigraphs outside @xmath306 for which the first part of theorem [ thm:4 ] fails .",
    "in this section , we describe an extension of the notion of strong representatives to strong edges of trigraphs .",
    "the _ underlying trigraph @xmath83 of @xmath1 _ is the trigraph on the vertices of @xmath1 with strong edges @xmath21 such that @xmath372 or @xmath373 , and with weak edges @xmath21 such that @xmath374 and @xmath375 or @xmath376 .",
    "we denote by @xmath377 the digraph on the vertices of @xmath24 with edges @xmath21 such that @xmath378 or @xmath379 for some @xmath380 .",
    "we denote by @xmath381 the trigraph on the vertices of @xmath1 with strong edges @xmath21 such that @xmath372 or @xmath382 for some @xmath380 , and with weak edges @xmath21 such that @xmath383 , and @xmath375 or @xmath384 for some @xmath380 .",
    "we say that an edge @xmath21 of @xmath1 is _ admissible _ , if there exist vertices @xmath59 such that @xmath60 and @xmath61 .",
    "we say that lists @xmath32 contain _ representatives for strong edges _ ,",
    "if for each admissible strong edge @xmath21 in @xmath1 , there is a set @xmath385 such that    a.   @xmath386 whenever @xmath95 or @xmath61 , b.   each vertex of @xmath387 is a neighbour of @xmath71 or a neighbour  of  @xmath164 , c.   if @xmath71 and @xmath164 have no common neighbours , then @xmath388 contains only neighbours of @xmath71 or only neighbours of @xmath164 , d.   if @xmath45 is a strong edge , then each vertex of @xmath389 is a symmetric neighbour of @xmath71 or a symmetric neighbour of @xmath164 , e.   if @xmath45 is a strong edge , and @xmath71 and @xmath164 have no common symmetric neighbours , then contains only symmetric neighbours of @xmath71 or only symmetric  of  @xmath164 .",
    "[ lem:10 ] lists @xmath32 can be transformed to contain representatives for strong edges .    by lemmata [ lem:1 ] and [ lem:2 ]",
    ", we may assume that the lists @xmath32 are arc - consistent and contain representatives .",
    "let @xmath33 be a list @xmath1-colouring of @xmath24 with respect to @xmath32 , and let @xmath21 be an admissible strong edge of @xmath1 .",
    "let @xmath390 , let @xmath105 denote all vertices of @xmath17 that are neighbours of @xmath71 or @xmath164 , and let @xmath108 denote all vertices @xmath47 with @xmath60 or @xmath171 .",
    "we have @xmath114 .",
    "also , since the lists @xmath32 are arc - consistent , we have @xmath112 for each @xmath116 .",
    "let @xmath87 be the underlying graph of @xmath24 and @xmath83 be the underlying trigraph of @xmath1 .",
    "it is easy to verify that @xmath33 is a homomorphism of @xmath87 to @xmath83 . in particular",
    ", @xmath33 is a surjective mapping from of @xmath108 to @xmath391 , where @xmath392 .",
    "clearly , @xmath393 .",
    "now , it is not difficult to prove that @xmath33 is a homomorphism of @xmath394)^2 $ ] to @xmath395)^2 $ ] .",
    "( for this , we need the above remark about surjectivity . )",
    "we observe that @xmath91 induces a clique in @xmath394)^2 $ ] .",
    "hence , using the same argument as in the proof of lemma [ lem:3 ] , there is a maximal clique @xmath118 of a minimal chordal completion @xmath89 of @xmath394)^2 $ ] such that for each @xmath396 , we have @xmath121 where @xmath120 is a unique component of @xmath395)^2-\\{x , y\\}$ ] .",
    "in particular , if @xmath71 and @xmath164 have no common neighbours , then @xmath251 either contains only neighbours of @xmath71 or it contains only neighbours of @xmath164 .",
    "hence , we let @xmath397 .    now , if @xmath45 is also a strong edge , we obtain @xmath385 by replacing @xmath24 with the symmetric graph of @xmath24 , and replacing @xmath1 with the symmetric trigraph of @xmath1 .",
    "the remainder of the proof follows exactly as in lemma  [ lem:3 ] .",
    "a trigraph @xmath1 is a _ trigraph cycle _ if the underlying graph of @xmath1 is a cycle .",
    "let @xmath1 be a trigraph cycle .",
    "we say that @xmath1 is a _ good cycle _",
    "if @xmath1 has at least one of the following :    a.   two strong edges , or b.   three consecutive strong loops , or c.   two pairs of consecutive strong loops , or d.   a strong edge and a distinct pair of consecutive strong loops , or e.   two strong loops joined by a nonsymmetric edge , or f.   a strong loop whose neighbours have no loops , or g.   a strong loop with non - symmetric edges to neighbours , or h.   a strong edge with at least one endpoint having no loop .    if @xmath1 is a good cycle , then the problem l - hom@xmath36 is polynomial time solvable or @xmath0-complete .",
    "figure [ fig : cycle1 ] illustrates example trigraph cycles whose complexity is not determined by our theorem .",
    "these are cycles @xmath1 that contain vertices @xmath163 such that either @xmath372 and @xmath398 , or all of @xmath236 , @xmath21 , @xmath45 , and @xmath296 are edges ( weak or strong ) but at least one is strong .",
    "( only three typical cases of this are shown in the figure . )",
    "we prove the theorem by reducing the problem to an induced subgraph of @xmath1 . unfortunately , if @xmath1 is a trigraph cycle that is not a good cycle , such reduction may not be possible at all .",
    "the  complement of the stable cutset problem ( figure [ fig : ex1]c ) is a good example illustrating this  difficulty .",
    "we assume that @xmath1 has at least five vertices , since otherwise the claim follows from @xcite .",
    "let @xmath24 with lists @xmath32 be an instance of l - hom@xmath36 .",
    "by lemmata [ lem:1 ] , [ lem:2 ] , [ lem:3 ] , and [ lem:10 ] , we assume that the lists @xmath32 are arc - consistent , contain representatives , strong representatives , and representatives for strong edges .",
    "also , we assume that each vertex @xmath71 of @xmath1 appears on some list , since otherwise we can reduce the problem @xmath238 , which is a trigraph tree , and the claim follows by theorem [ thm : trees ] .",
    "suppose that @xmath1 contains two strong edges @xmath399 , @xmath400 .",
    "if @xmath401 satisfies the matching property , then we are done by theorem [ thm:4 ] . otherwise , we must have @xmath402 and @xmath403 .",
    "( the case @xmath404 and @xmath405 is symmetric . )",
    "let @xmath176 be any vertex ( including @xmath406 ) of @xmath1 other than @xmath164 .",
    "by arc - consistency of @xmath32 , no list @xmath58 contains both @xmath164 and @xmath176 since @xmath21 and @xmath166 are strong , but at least one of @xmath407 is not an edge .",
    "hence , we have @xmath249 whenever @xmath171 . by arc - consistency of @xmath32 , we can reduce the problem to @xmath408 and we are done .    next , if @xmath1 contains two pairs of consecutive strong loops @xmath163 and @xmath409 with possibly @xmath410 , or a strong edge @xmath21 and a pair of strong loops @xmath409 where @xmath411 , then @xmath412 satisfies the matching property , and again we are done .    hence , suppose that @xmath1 contains strong loops @xmath163 where @xmath21 is an edge , but @xmath45 is not . consider the strong representatives @xmath124 and @xmath274 .",
    "clearly , @xmath124 and @xmath274 are disjoint . also , the only edge from @xmath124 to @xmath274 is the edge @xmath21 .",
    "hence , by arc - consistency of @xmath32 , if @xmath63 with @xmath60 and @xmath61 , we have @xmath248 and @xmath344 . in particular , we can remove all such edges @xmath99 , and afterwards , we remove the edge @xmath21 from @xmath1 .",
    "now , since @xmath413 is a trigraph tree , by theorem [ thm : trees ] , we conclude that l - hom@xmath414 is polynomially equivalent to l - hom@xmath242 .",
    "hence , we are done .",
    "next , suppose that @xmath1 contains a strong loop @xmath71 with neighbours @xmath415 having no loops .",
    "consider the strong representative @xmath124 .",
    "if @xmath243 , then we apply lemma [ lem:8 ] for @xmath244 , @xmath245 , and @xmath246 .",
    "this yields that the lists @xmath32 are arc - consistent and sparse - dense - consistent on @xmath81 and @xmath132 . in particular , @xmath248 whenver @xmath60 .",
    "similarly , if @xmath416 .",
    "hence , we can reduce the problem to @xmath238 and we are done .    now , suppose that @xmath1 contains a strong loop @xmath71 with non - symmetric edges between @xmath71 and its neighbours @xmath415 .",
    "clearly , we have @xmath240 . hence , we can reduce the problem to @xmath238 and we are done .",
    "finally , suppose that @xmath1 contains a strong edge @xmath21 whose one endpoint has no loop . by symmetry",
    "suppose that @xmath71 has no loop .",
    "let @xmath417 be the other neighbour of @xmath71 and let @xmath418 be the other neighbour of @xmath164 . consider the representative @xmath385 .",
    "we have that either @xmath419 or @xmath420 . by arc - consistency of @xmath32 ,",
    "no list @xmath58 contains both @xmath164 and @xmath418 since @xmath21 is strong , but @xmath351 is not an edge .",
    "similarly , no list @xmath58 contains both @xmath71 and @xmath164 , or both @xmath71 and @xmath417 .",
    "hence , if @xmath420 , we have @xmath248 whenever @xmath60 , and if @xmath419 , we have @xmath249 whenever @xmath171",
    ". therefore , we can reduce the problem to @xmath238 or to @xmath408 , and we are done .",
    "@xmath421[f]{\\phantom{s } } ; \" a4\"*[o][f]{\\phantom{s } } ; { \\ar@{-}@/^0.1pc/ \" a4\";\"a4\"+(-0.07,0.3 ) } ; { \\ar@{-}@/^0.2pc/ \" a4\"+(-0.07,0.3);\"a4\"+(0.07,0.3 ) } ; { \\ar@{-}@/_0.1pc/ \" a4\";\"a4\"+(0.07,0.3 ) } ; { \\ar@{-}@/^0.1pc/ \" a3\";\"a3\"+(-0.07,0.3 ) } ; { \\ar@{-}@/^0.2pc/ \" a3\"+(-0.07,0.3);\"a3\"+(0.07,0.3 ) } ; { \\ar@{-}@/_0.1pc/ \" a3\";\"a3\"+(0.07,0.3 ) } ; \" a4\"+(0,-0.2)*{x } ; \" a3\"+(0,-0.2)*{y } ; \\endxy \\quad \\xy / r3pc/ : ( 1.5,0);(0,0);{\\xypolygon10\"a\"{~>{}{\\phantom{s } } } } ; \" a3\";\"a4\";{\\ellipse : a(-55),^{. } } ; { \\ar@/^0.15pc/ \" a3\";\"a4 \" } ; { \\ar@/^0.15pc/ \" a4\";\"a3 \" } ; \" a3\"*[o][f]{\\phantom{s } } ; \" a4\"*[o][f]{\\phantom{s } } ; { \\ar@{=}@/^0.1pc/ \" a4\";\"a4\"+(-0.07,0.3 ) } ; { \\ar@{=}@/^0.2pc/ \" a4\"+(-0.07,0.3);\"a4\"+(0.07,0.3 ) } ; { \\ar@{=}@/_0.1pc/ \" a4\";\"a4\"+(0.07,0.3 ) } ; { \\ar@{=}@/^0.1pc/ \" a3\";\"a3\"+(-0.07,0.3 ) } ; { \\ar@{=}@/^0.2pc/ \" a3\"+(-0.07,0.3);\"a3\"+(0.07,0.3 ) } ; { \\ar@{=}@/_0.1pc/ \" a3\";\"a3\"+(0.07,0.3 ) } ; \" a4\"+(0,-0.2)*{x } ; \" a3\"+(0,-0.2)*{y } ; \\endxy \\quad \\xy / r3pc/ : ( 1.5,0);(0,0);{\\xypolygon10\"a\"{~>{}{\\phantom{s } } } } ; \" a3\";\"a4\";{\\ellipse : a(-55),^{. } } ; { \\ar@/^0.15pc/ \" a3\";\"a4 \" } ; { \\ar@/^0.15pc/ \" a4\";\"a3 \" } ; \" a3\"*[o][f]{\\phantom{s } } ; \" a4\"*[o][f]{\\phantom{s } } ; { \\ar@{=}@/^0.1pc/ \" a4\";\"a4\"+(-0.07,0.3 ) } ; { \\ar@{=}@/^0.2pc/ \" a4\"+(-0.07,0.3);\"a4\"+(0.07,0.3 ) } ; { \\ar@{=}@/_0.1pc/ \" a4\";\"a4\"+(0.07,0.3 ) } ; { \\ar@{-}@/^0.1pc/ \" a3\";\"a3\"+(-0.07,0.3 ) } ; { \\ar@{-}@/^0.2pc/ \" a3\"+(-0.07,0.3);\"a3\"+(0.07,0.3 ) } ; { \\ar@{-}@/_0.1pc/ \" a3\";\"a3\"+(0.07,0.3 ) } ; \" a4\"+(0,-0.2)*{x } ; \" a3\"+(0,-0.2)*{y } ; \\endxy \\quad \\xy / r3pc/ : ( 1.5,0);(0,0);{\\xypolygon10\"a\"{~>{}{\\phantom{s } } } } ; \" a3\";\"a4\";{\\ellipse : a(-55),^{. } } ; { \\ar@{->}@/^0.2pc/ \" a3\";\"a4 \" } ;",
    "{ \\ar@{=>}@/^0.2pc/ \" a4\";\"a3 \" } ; \" a3\"*[o][f]{\\phantom{s } } ; \" a4\"*[o][f]{\\phantom{s } } ; { \\ar@{=}@/^0.1pc/ \" a4\";\"a4\"+(-0.07,0.3 ) } ; { \\ar@{=}@/^0.2pc/ \" a4\"+(-0.07,0.3);\"a4\"+(0.07,0.3 ) } ; { \\ar@{=}@/_0.1pc/ \" a4\";\"a4\"+(0.07,0.3 ) } ; { \\ar@{-}@/^0.1pc/ \" a3\";\"a3\"+(-0.07,0.3 ) } ; { \\ar@{-}@/^0.2pc/ \" a3\"+(-0.07,0.3);\"a3\"+(0.07,0.3 ) } ; { \\ar@{-}@/_0.1pc/ \" a3\";\"a3\"+(0.07,0.3 ) } ; \" a4\"+(0,-0.2)*{x } ; \" a3\"+(0,-0.2)*{y } ; \\endxy $ ]         finally , we describe how we can use our results to classify the complexity of finding surjective list homomorphisms for some trigraphs .",
    "we say that a homomorphism @xmath33 of @xmath24 to @xmath1 is a _ a ( vertex ) surjective homomorphism _ if @xmath33 is a surjective mapping of @xmath41 onto @xmath17 .",
    "the _ surjective list @xmath1-colouring problem _ sl - hom@xmath36 takes as input a digraph @xmath24 with lists @xmath32 , and asks whether or not @xmath24 admits a surjective list homomorphism to @xmath1 with respect to @xmath32 .",
    "let @xmath422 be the digraph obtained from a trigraph @xmath1 by removing all vertices @xmath71 with a strong loop at @xmath71 or a strong edge @xmath21 or @xmath45 for some @xmath164 .",
    "[ thm:5 ] if @xmath1 is a special tree - like trigraph , i.e. , if @xmath369 , then is polynomially equivalent to sl - hom@xmath423 .",
    "in particular , sl - hom@xmath36 is polynomial time solvable or @xmath0-complete .",
    "let @xmath1 be any trigraph ( not necessarily a special tree - like ) .",
    "first , we observe that sl - hom@xmath36 is polynomially reducible to l - hom@xmath36 , since sl - hom@xmath36 is a special case of l - hom@xmath36 .    now",
    ", suppose that @xmath1 contains a digraph @xmath212 as an induced subgraph .",
    "let @xmath424 with lists @xmath216 be an instance of l - hom@xmath425 .",
    "let @xmath83 be the digraph associated with @xmath1 , and let @xmath24 be the disjoint union of @xmath424 and @xmath83 .",
    "define @xmath426 for @xmath427 , and @xmath428 for @xmath429 .",
    "it now follows that @xmath424 admits a list @xmath212-colouring with respect to @xmath216 if and only if @xmath24 admits a surjective list @xmath1-colouring with respect to @xmath32 .",
    "this yields that l - hom@xmath423 is polynomially equivalent to sl - hom@xmath423 .",
    "in fact , we can also conclude that sl - hom@xmath423 is polynomially reducible to sl - hom@xmath36 .",
    "now , let @xmath1 be a special tree - like digraph .",
    "let @xmath362 be the set of edges from the definition of @xmath1 .",
    "let @xmath24 with lists @xmath32 be an instance of sl - hom@xmath36 .",
    "we can assume that each vertex of @xmath1 appears on some list , since otherwise there is no solution .",
    "now , following the proof of theorem  [ thm:4 ] , we conclude ( depending on @xmath32 ) that there is a set @xmath430 such that the instance @xmath431 of l - hom@xmath36 is polynomially reducible to an instance of l - hom@xmath432 ) .",
    "in fact , the proof implies the instance is reducible to an instance of l - hom@xmath433 where @xmath434 are the vertices incident to the edges of @xmath435 .",
    "moreover , since each vertex of @xmath1 appears on some list , the edges of @xmath436 are only between strong loops .",
    "hence , @xmath434 contains all vertices of @xmath1 incident to strong edges .",
    "therefore , @xmath437 .",
    "also , by the definition of @xmath1 , for each strong loop @xmath71 of @xmath438 , each connected component of @xmath439 satisfies the domination property .",
    "hence , by theorem [ thm:4 ] , @xmath433 is polynomially equivalent to @xmath423 . also , as remarked earlier , @xmath423 is polynomially equivalent to l - hom@xmath423 .",
    "hence , @xmath36 is polynomially reducible to sl - hom@xmath423 .",
    "that concludes the proof .",
    "the proof of this theorem in particular implies the following",
    ".    if @xmath1 is a digraph , then l - hom@xmath36 and sl - hom@xmath36 are polynomially equivalent .",
    "in fact , similarly , one can prove a stronger statement .",
    "if for no vertices @xmath440 of @xmath1 we have @xmath372 and @xmath441 , then l - hom@xmath36 and sl - hom@xmath36 are polynomially equivalent .",
    "note that if we have vertices @xmath440 as described above , then an instance @xmath24 in which @xmath71 occurs on some list allows us to use arc - consistency to make sure that no vertex has both @xmath164 and @xmath417 on its list ; while if @xmath71 appears on no list , this no longer happens .",
    "we investigated the list ( and surjective list ) homomorphism problems for trigraphs  @xmath1 . when @xmath1 is a digraph , we know that each such problem is polynomial time solvable or @xmath0-complete @xcite",
    "however , there are small trigraphs @xmath1 for which such dichotomy is not known , for instance , the trigraph in figure [ fig : ex1]a ( corresponding to the so - called `` stubborn '' problem from @xcite ) .",
    "hence , we have tried to identify properties of trigraphs @xmath1 which allow us to prove dichotomy . with this in mind , we have defined the class @xmath443 of tree - like trigraphs , and we proved that these trigraphs enjoy dichotomy . slightly easier to define",
    "is the class @xmath137 of special tree - like trigraphs , included in @xmath443 . in particular , the class of trigraphs whose underlying graph is a tree , is included in @xmath137 ( and hence in @xmath444 ) .",
    "we now offer some tangential evidence that our class @xmath443 carves out a reasonable portion of trigraphs where l - hom(@xmath1 ) is polynomially equivalent to l - hom(@xmath44 ) .",
    "for instance , one way to violate the matching property is by having a vertex with a strong loop adjacent to two other vertices with strong loops joined by a symmetric edge .",
    "the trigraph in figure [ fig : ex1]b illustrates this possibility , and also illustrates that a polynomial time solvable ( in this case trivial ) problem l - hom(@xmath44 ) can arise from an @xmath0-complete problem l - hom(@xmath1 ) .",
    "( in this case , @xmath24 admits a homomorphism to @xmath1 if and only if the complement of @xmath24 is 3-colourable . )",
    "the trigraph in figure [ fig : ex1]c illustrates another way to have this take place . here",
    ", the two other vertices have weak loops and are joined by a strong symmetric edge . in this case",
    "l - hom(@xmath1 ) is also np - complete , since it corresponds ( in the complement ) to the stable cutset problem @xcite .",
    "thus we again have an easy with a hard l - hom(@xmath1 ) .    of course , it is possible that some class of trigraphs enjoys dichotomy for reasons different from polynomial equivalence of l - hom(@xmath1 ) and l - hom(@xmath44 ) .",
    "however , the stubborn problem ( figure [ fig : ex1]a ) illustrates the fact that there are trigraphs @xmath445 where even the dichotomy is not clear .",
    "we note that the trigraph @xmath1 for the stubborn problem ( the trigraph in figure [ fig : ex1]a ) violates the domination property , since the statement ( d2 ) does not hold for the strong loop at @xmath71 .",
    "finally , we have also introduced the surjective list homomorphism problem sl - hom(@xmath1 ) as an interesting variant of l - hom(@xmath1 ) .",
    "we were able to completely classify the complexity of sl - hom(@xmath1 ) for trigraphs @xmath1 in the class @xmath446 by proving polynomial equivalence with sl - hom(@xmath447 .",
    "this result implies , in particular , that the two problems , l - hom(@xmath1 ) and sl - hom(@xmath1 ) , may not necessarily have the same complexity for all trigraphs @xmath1 .",
    "this difference was not noted before , since the two problems are polynomially equivalent for all digraphs @xmath1 .",
    "in fact , we have given a general condition for trigraphs @xmath1 under which the two problems sl - hom(@xmath1 ) and l - hom(@xmath1 ) are polynomially equivalent .",
    "nonetheless , the trigraph @xmath1 in figure  [ fig : ex1]d illustrates a case where sl - hom(@xmath1 ) is polynomial time solvable , because using representatives and arc - consistency reduces all lists to size at most two , while l - hom(@xmath1 ) is @xmath0-complete , because @xmath238 corresponds to the stable cutset problem @xcite ."
  ],
  "abstract_text": [
    "<S> trigraph list homomorphism problems ( also known as list matrix partition problems ) have generated recent interest , partly because there are concrete problems that are not known to be polynomial time solvable or @xmath0-complete . </S>",
    "<S> thus while _ digraph _ list homomorphism problems enjoy _ dichotomy _ ( each problem is @xmath0-complete or polynomial time solvable ) , such dichotomy is not necessarily expected for trigraph list homomorphism problems . </S>",
    "<S> however , in this paper , we identify a large class of trigraphs for which list homomorphism problems do exhibit a dichotomy . </S>",
    "<S> they consist of trigraphs with a tree - like structure , and , in particular , include all trigraphs whose underlying graphs are trees . </S>",
    "<S> in fact , we show that for these tree - like trigraphs , the trigraph list homomorphism problem is polynomially equivalent to a related _ digraph _ list homomorphism problem . </S>",
    "<S> we also describe a few examples illustrating that our conditions defining tree - like trigraphs are not unnatural , as relaxing them may lead to harder problems .    </S>",
    "<S> trigraph , list homomorphism , matrix partition , trigraph homomorphism , surjective list homomorphism , dichotomy , trigraph tree </S>"
  ]
}