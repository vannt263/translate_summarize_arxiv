{
  "article_text": [
    "trapped ultracold ions have represented a major candidate for the implementation of scalable quantum information processing since the beginning of this research field . the first proposal of an ion - based quantum computer by cirac and zoller in 1995 @xcite has been followed by a great variety of other schemes based on ions @xcite , on other quantum optical systems like neutral atoms @xcite and on solid - state systems @xcite as well . with the progress of experimental techniques and the demonstration of entangling quantum gates based on several different candidate physical systems , the focus has progressively shifted toward the fulfilment of scalability desiderata @xcite , that is , the realization of quantum gates with very high fidelities , in the range 0.999  0.9999 .",
    "gate errors in a real implementation of a given quantum gate scheme can be reduced by different means .",
    "some errors arise from ( or are increased by ) experimental imprecisions of a technical nature and can be controlled by careful alignment , stabilization etc .  of the experimental apparatus .",
    "other errors stem from unaviodable interactions with the environment and can be reduced by simply completing the gate in as short a time as possible .",
    "typically , a gate scheme can be made faster by simple scaling to higher intensities , shorter distances etc .",
    "if such simple optimizations of the gate prove insufficient , one needs to consider changes to the scheme itself and trade simplicity for improved performance .",
    "this is exactly the goal of _ quantum optimal control techniques _",
    "@xcite which allow for a precise tailoring of the system s evolution by time - dependent tuning of some external parameters . with sufficient control over these parameters",
    ", a given target state can often be reached with minimal errors even over short gate operation times .",
    "the application of these methods to quantum information systems requires in turn a very accurate simulation of the dynamics and a careful understanding of the targeted error sources .",
    "this is precisely the aim of this paper , in the specific case of the two - qubit ion gate first proposed in @xcite and subsequently analyzed in @xcite . in this `` pushing gate '' the qubits are encoded in the internal states of two ions . each ion is held in a separate microtrap and state - selective `` push '' potentials are applied in order to modify the distance and thus the coulomb interaction between ions , see sec .",
    "[ sec : pushing_gate ] below . we shall first point out a series of issues that arise when the assumption of spatial homogeneity of the ion - driving force is dropped , and subsequently develop a way to correct each of these issues , exploting a range of ideas , including in a crucial way optimal control methods .",
    "it should be noted from the outset that in the present paper , we analyze the pushing gate without what is called the @xmath0-pulse method in refs .",
    "@xcite , where it was shown to dramatically reduce some types of errors .",
    "the @xmath0-pulse method is a spin - echo technique and requires the gate to be repeated with the internal state of the ions flipped .",
    "typically , single particle operations like flipping the internal states can be done with high fidelity , and it is reasonable to expect that eventually the @xmath0-pulse method will be used .",
    "however , internal state control is at least in principle a separate issue from the pushing gate operation itself . keeping the design process modular in spirit",
    ", it is relevant to optimize the gate without this additional trick and thus pave an alternative road to high fidelities .",
    "as will become clear below , we extract quite general noise reduction methods from the automated numerical optimization results and it is an interesting topic for future research to combine these with the @xmath0-pulse method .    the remainder of the paper is organized as follows . in sec .",
    "[ sec : td - potentials ] we introduce the general setting of conditional dynamics gate schemes , a useful approximation for simulating such a gate , and a measure of the gate errors . in sec .",
    "[ sec : pushing_gate ] we specialize to the pushing gate .",
    "the un - optimized performance of the gate is reported in sec .",
    "[ sec : results ] and in sec .",
    "[ sec : optimal_control ] we show how this performance can be significantly improved by a combination of `` manual '' changes and numerical optimal control methods .",
    "finally we conclude in sec .",
    "[ sec : conclusion ] .",
    "the appendix contains a number of more technical results and derivations .",
    "the basic idea of the so - called pushing gate is one of _ conditional dynamics _ , i.e.  we apply potentials depending on the internal state of the two ions .",
    "the internal states themselves are not changed during the gate , or , in the case of the @xmath0-pulse method , are changed on a much shorter time - scale than the external dynamics .",
    "this means that the analysis of the problem splits into four separate evolutions for the external state , one for each of the logical ( internal ) states , @xmath1 , @xmath2 , @xmath3 , and @xmath4 . in the following",
    ", these four evolutions will be denoted `` branches '' and will be indexed by @xmath5 .",
    "the complete hamiltonian can be written in the form of a sum of internal@xmath6external factorized terms @xmath7 and it results in an evolution operator of a similar form @xmath8    ideally , when @xmath9 at the end of the gate , the @xmath10 should differ from each other by at most a phase factor multiplying a common unitary operator @xmath11 @xmath12 so that @xmath13 itself can be factorized : @xmath14 the internal evolution is then that of a phase gate , while the external evolution can in principle be undone using internal - state independent potentials .",
    "the requirement ( [ eq : u_ex_phase_factor ] ) is very hard to achieve and would make the gate completely independent on the initial external state . however , we can typically assume to have some degree of control over the initial external state , e.g.  by cooling the particles before the gate .",
    "this means that  ( [ eq : u_ex_phase_factor ] ) need only hold when restricted to a subset of the complete hilbert space , typically the states of relatively low energy . in appendix",
    "[ sec : fidelity ] we show how to evaluate the performance of the gate in general . for now , we note that since only the low energy part of @xmath15 will be important , we can focus on getting a good approximation for this part when trying to simulate the gate dynamics .",
    "a low initial energy means particles localized near the potential minimum and this suggests using a harmonic approximation to the real potential  .",
    "the simplest choice is to taylor expand around a fixed point , which is not changed during the gate operation .",
    "the next level of refinement is to expand around the instantaneous potential minimum .",
    "this works very well if the gate operation is nearly adiabatic so the particles stay near the ( moving ) minimum at all times",
    ". however , it may be desirable to make fast and substantial changes to the potential during the gate and that may induce pronounced non - adiabatic dynamics . in that case",
    ", the harmonic approximation can still be a good one provided it is done around the _ classical trajectories _ of the particles .",
    "typically these trajectories can not be computed analytically , but for any moderate number of particles it is a numerically simple task to find them .",
    "below we will use this method and show how it leads to a relatively simple characterization of @xmath16 .      in this section",
    "we focus on a single branch of the evolution and thus suppress the @xmath17 index .",
    "let us denote by @xmath18 the classical trajectory , which is found by solving classical equations of motion .",
    "the time - dependent , second order taylor expansion of the potential @xmath19 around @xmath18 reads simply @xmath20 with @xmath21 $ ] and @xmath22 note that we will still use @xmath23 as our coordinate , i.e.  we are _ not _ changing to a coordinate system moving with @xmath18 , we simply use a potential that approximates the real potential close to @xmath18 . collecting terms of equal order in @xmath23 leads to the alternative form @xmath24 with @xmath25      the big advantage of choosing a second order approximation to the real potential is that this restricts the corresponding approximate @xmath26 to be _ gaussian _ for all @xmath27 .",
    "let us introduce the compact notation @xmath28 and define the matrix @xmath29 by @xmath30 where @xmath31 is the number of degrees of freedom .",
    "then the usual canonical commutation relations can be written as @xmath32 = i j_{ij }    .\\ ] ] with the potential of eq .",
    "( [ eq : so_taylor_order ] ) and a matrix of particle masses @xmath33 the time - dependent hamiltonian becomes @xmath34 in appendix  [ sec : evol_quad_ham ] we show that such a hamiltonian leads to an evolution operator of the form @xmath35 where @xmath36 is a displacement operator and @xmath37 a squeezing operator @xmath38 the scalar @xmath39 , the vector @xmath40 , and the matrix @xmath41 should satisfy the following equations of motion : @xmath42 where the @xmath43 matrix @xmath44 is defined by @xmath45    the form of solution ( [ eq : evol_operator])([eq : eoms_d_b ] ) holds for any second order hamiltonian . in the particular case where @xmath46 is a taylor expansion of a real potential around the classical trajectory @xmath18 , the equation of motion for @xmath40 reduces to the exact equation of motion for @xmath47 where @xmath48 is the classical momentum . in the following , we will therefore write @xmath49 instead of @xmath40 .",
    "it is then important to remember that the right - hand sides of eqs .",
    "( [ eq : eoms_d_b ] ) are in general _ non - linear _ functions of @xmath50 .",
    "we can quantify the performance of the gate by calculating the average _ fidelity _ @xmath51 ( see appendix  [ sec : fidelity ] ) between the obtained output state and the ideal one when the input state is varied .",
    "one can then separate out three kinds of contributions to the deviation of @xmath51 from 1 ( the perfect gate ) @xmath52 the three types of errors each have their physical interpretation .",
    "the most straightforward one pertains to the _ sloshing errors _",
    "@xmath53 which correspond to a residual motion of the ions after the gate has been completed and the micro - traps are again at rest . the _ phase errors _",
    "@xmath54 are errors in the gate phase .",
    "finally , the _ breathing errors _ @xmath55 are induced by differences in the harmonic approximation parameters around the classical trajectory for different internal states .",
    "for example , in the case we consider , when the particles are pushed closer together , the second order term in the coulomb repulsion becomes larger , cf .",
    "( [ eq : k_ii ] ) below .    in our model",
    "we assume that systematic , _ local _ phase errors can be undone .",
    "then an explicit calculation in appendix  [ sec : fidelity ] , shows that the phase errors are given by @xmath56 with @xmath57 $ ] , where @xmath58 is the covariance matrix of the external state , see section  [ sec : gaussian_case ] of the appendix .",
    "note the inclusion of the @xmath59 $ ] terms in the definition of @xmath60 : these terms correspond to phase contributions from average excitation energy in the traps and are therefore temperature dependent through @xmath58 . for our parameters they are small .",
    "the sloshing errors are given by @xmath61 and the breathing errors are @xmath62    \\\\    & + \\frac{1}{160}\\sum_{\\alpha<\\beta }    { \\text{tr}}\\left[(b_\\alpha - b_\\beta ) j(b_\\alpha - b_\\beta ) j    \\right ]    .",
    "\\end{split}\\ ] ] here @xmath63 , @xmath64 , and @xmath65 are defined in eqs .",
    "( [ eq : evol_operator],[eq : def_d_w ] ) , and are the variables describing the gaussian approximation in the @xmath17 branch of the evolution . again",
    "@xmath58 introduce temperature dependence .",
    "let us now focus on the particular case of the pushing gate .",
    "here we have two ions , each in a separate micro - trap  . to further simplify the discussion ,",
    "we concentrate on just one spatial dimension , i.e.  there are two degrees of freedom , @xmath66 .",
    "the ions are assumed to be of identical mass , @xmath67 , and thus @xmath68 .",
    "the potential energy consists of a micro - trap for each ion , time- and internal state - dependent pushing potentials , and the coulomb interaction .",
    "the pushing potentials can be realised as optical dipole potentials generated by focused laser beams .",
    "the time - dependence of these potentials is most easily achieved by controlling the intensity of the laser and the state - selectivity by polarization selection rules  @xcite .",
    "we assume that the form for the internal state labeled by @xmath17 is @xmath69    .",
    "\\end{split}\\ ] ] the trapping potentials are assumed to be perfectly harmonic .",
    "the state - dependent pushing amplitudes @xmath70 are such that the ions are only pushed if they are in the internal state 1 , @xmath71 .",
    "note that the @xmath72 factor means that ion 1 is pushed to the left and ion 2 to the right .",
    "non - linear contributions to the pushing potentials are included _ via _ the constant @xmath73 .",
    "the harmonic oscillator ground state size is @xmath74 .",
    "the two coordinates @xmath75 and @xmath76 are taken to have origin in the respective trap centers , a distance @xmath77 apart .",
    "experimentally , the parameters in ( [ eq : def_v ] ) can be varied quite a lot ( see e.g.  @xcite ) .",
    "trap distances @xmath77 from @xmath78 all the way down to @xmath79 are within technological reach .",
    "the trap frequency @xmath80 can be chosen in the range @xmath81 which for e.g.  ca@xmath82 ions will mean an oscillator length @xmath83 from @xmath84 down to @xmath85 .",
    "it should be noted that the use of optical dipole potentials to generate the state selective pushing forces will in general introduce large single qubit phases due to ac - stark shifts .",
    "this is not a problem as such , but it means that even small fluctuations in laser intensities will lead to loss of gate fidelity . for the particular case of the pushing gate ,",
    "the ac - stark shifts can be balanced against the coulomb energy as discussed in ref .",
    ". obviously ac - stark shifts are common to many gate proposals that uses optical potentials .",
    "an experimentally demanding , but quite general solution is to compensate the shifts along the lines of refs .",
    "@xcite . in the present work ,",
    "we focus on errors that are more directly related to the motion of the ions and assume that the push potentials are effectively non - fluctuating .    .",
    "the relative strength of the coulomb interaction to the trapping potentials turns out to be conveniently quantified by @xmath86 which is the ratio of the energy scale of the coulomb and trap potential energies at the equilibrium positions of the ions . in ref .",
    "@xcite it was found that @xmath87 is the most promising regime . in oscillator units ,",
    "the hamiltonian for the branch labeled by @xmath17 reads @xmath88      +      \\frac{\\epsilon}{4 }      \\frac {        \\frac{d^2}{{a_0}^2 }      } {        \\left| 1+\\frac{{a_0}}{d}\\left({\\hat{x}}_2-{\\hat{x}}_1\\right )   \\right|      }      \\\\      & -      \\sum_{i=1,2 } f^{(\\beta)}_i(t )      \\left [ { \\hat{x}}_i + g { \\hat{x}}_i^2            \\right ]",
    ".    \\end{split}\\ ] ]      when eqs .",
    "( [ eq : def_eff ] ) are specialized to the pushing gate , we get the following : @xmath89 ^ 3 }    \\\\    \\label{eq : k_ii }    \\begin{split }      k_{ii}^{(\\beta)}(t )      & =      1 + 2 f_i^{(\\beta)}(t ) g      \\\\      & \\phantom{=f_i}+ \\frac{1}{2}\\epsilon      \\frac{1 }      { \\left [ 1 + \\frac{{a_0}}{d }          \\left({\\overline{x}}_2^{(\\beta)}-{\\overline{x}}_1^{(\\beta)}\\right ) \\right]^3 }    \\end{split }    \\\\",
    "\\label{eq : k_12 }    \\begin{split }      k_{12}^{(\\beta)}(t )      & =      k_{21}^{(\\beta)}(t )      =      -\\frac{1}{2}\\epsilon      \\frac{1 }      { \\left [ 1 +          \\frac{{a_0}}{d}\\left({\\overline{x}}_2^{(\\beta)}-{\\overline{x}}_1^{(\\beta)}\\right )        \\right]^3 }      .",
    "\\end{split}\\end{aligned}\\ ] ] when these expressions are inserted into eqs .",
    "( [ eq : eoms_d_b ] ) and ( [ eq : def_h ] ) we are ready to simulate the gate .",
    "even with the simplifications we have introduced , there are still a lot of parameters in the problem . the optimal `` working point",
    "'' will always be dependent on experimental considerations beyond the simplified model treated here . for a discussion of parameters and design decisions , see ref .",
    "@xcite . for concreteness",
    "we have chosen to focus on a limited set of parameters .",
    "we first of all assume the individual ion traps to be very well separated and let @xmath90 in all calculations .",
    "likewise , we assume a reasonably low value for @xmath91 of @xmath92 . such parameters would result from e.g.  @xmath93ca ions placed in micro - traps with trapping frequencies of @xmath94 and separated by a distance of @xmath95 .",
    "for a the traveling wave configuration with beam waist @xmath96 considered in ref .",
    "@xcite , @xmath97 where @xmath98 is the initial position of the ion relative to the beam center . for realistic focusing of the push beam , @xmath99 this suggests to vary the non - linearity coefficient @xmath73 between @xmath100 and @xmath101 . as the initial temporal shape of the push pulse",
    "we choose a gaussian @xmath102 , where the amplitude @xmath103 should be chosen to give a gate phase of @xmath0 .",
    "a simple estimate ( for @xmath104 ) suggests that we choose  @xcite @xmath105 the temporal width of the pulse , @xmath106 , should be within an order of magnitude from the trap period if we want a fast gate .",
    "we will mainly look at @xmath106 in the range 1 to 10 trap periods , which for the parameters quoted above results a maximum excursion due to the push in the range from 12@xmath107 down to 3@xmath107 .      the choice of push amplitude expressed by eq .",
    "( [ eq : xi ] ) is not optimal .",
    "this can be seen in fig .",
    "[ fig : infidel_theta_gnot0 ] where we plot @xmath54 as a function of @xmath73 . even for @xmath104",
    "the gate phase is not exactly @xmath0 . for @xmath108",
    "we see that a nonzero @xmath73 can improve the gate phase .",
    "this is not surprizing , but also not very useful as we shall see below that @xmath54 is in general easy to reduce .    , @xmath90 , and @xmath108 ( black ) , @xmath109 ( red ) and @xmath110 ( blue ) .",
    "results for temperatures of @xmath111 and @xmath112 are plotted for each value of @xmath106 and are indistinguishable from each other . ]    in fig .",
    "[ fig : infidel_theta_gnot0 ] results for three different temperatures are plotted , but the dependence on temperature is completely negligible .",
    "let us now turn to the errors described by the @xmath53 term in eq .",
    "( [ eq : def_jobj ] ) , the sloshing errors . fig .",
    "[ fig : infidel_q_gnot0 ]    , @xmath90 , and @xmath108 ( black ) , @xmath109 ( red ) , and @xmath110 ( blue ) .",
    "we plot @xmath53 as a function of @xmath73 .",
    "as explained in the text , there exist nonzero values of @xmath73 where the sloshing is strongly suppressed .",
    "results for temperatures of @xmath113 , 1 and @xmath112 are plotted as dashed , full and dotted lines , respectively . ]",
    "shows how these errors are strongly dependent on @xmath73 , the strength of the non - linearity of the pushing potential .",
    "a series of minima of @xmath53 as a function @xmath73 can be seen .",
    "the optimal values of @xmath73 depends on the chosen duration of the pulse , @xmath106 .",
    "each minima is associated with the ions performing an integer number of `` non - adiabatic oscillations '' during the push pulse .",
    "this is illustrated in fig .",
    "[ fig : phase_space_comb ]    .",
    "the coordinates are relative to the potential minimum in which ion 1 is trapped .",
    "perfect adiabatic evolution would correspond to the ion simply following this minimum and thus the trajectory would be the single point @xmath114 in this plot . since the push is not infinitely slow , the ion will first lag behind the moving minimum and then oscillate in the moving potential . when the potential minimum again approaches its original position , the ion may happen to have just the right position and speed in order to end up at rest . whether this is the case depends ( for fixed push pulse ) on @xmath73 : the higher @xmath73 , the more the confinement is increased during the push . in the figure , the thick line corresponds to @xmath115 , which is nearly optimal w.r.t .  returning the ion to rest .",
    "the thin lines correspond to @xmath116 .",
    "the lowest @xmath73 gives the outermost curve over the main part of the `` loop '' in the figure . ]    where the trajectory of ion 1 with respect to its trap minimum is plotted for values of @xmath73 that are below , at and above the one that leads to the lowest @xmath53 .",
    "in contrast to @xmath54 above , @xmath53 depends noticeably on whether @xmath117 is @xmath118 , @xmath119 or @xmath112 .",
    "higher temperatures always increase the sloshing errors and for @xmath120 we find that @xmath53 scales as @xmath117 since @xmath58 does [ see eqs .",
    "( [ eq : gamma_rel ] ) and ( [ eq : gamma_cm ] ) ] .",
    "curves for three different values of @xmath106 are plotted in fig .",
    "[ fig : infidel_q_gnot0 ] and it is immediately clear that one can dramatically decrease sloshing errors by make the gate slower and thus more adiabatic .",
    "the suppression of @xmath53 is exponential and this is thus in general an efficient strategy .",
    "we now turn to the @xmath55 term of eq .",
    "( [ eq : fidelity_split ] ) .",
    "these `` breathing '' errors come from the _ different _ changes in the effective quadratic hamiltonian for the different branches of the evolution . in fig .",
    "[ fig : infidel_s_gnot0 ] we plot @xmath55 for different values of @xmath73 and @xmath106 and for different temperatures of the external motion .",
    "results for temperatures of @xmath1210.125 , 1 and 8@xmath122 are shown and it is first of all clear that @xmath55 depends strongly on @xmath117 .    , @xmath90 , and @xmath108 ( black ) , @xmath109 ( red ) , and @xmath110 ( blue ) .",
    "results for temperatures of @xmath113 , 1 and @xmath112 are plotted as dashed , full and dotted lines , respectively .",
    "for all three temperatures , larger @xmath106 leads to larger @xmath55 .",
    "@xmath55 is increasing approximately linearly with @xmath123 , i.e. for fixed @xmath73 , @xmath55 will be proportional to @xmath106 , the pulse duration ! this is very different from the behavior of @xmath53 above , which is rapidly decreased by increasing @xmath106 and thereby making the push more adiabatic . ]",
    "we also see that @xmath55 is nearly proportional to @xmath123 .",
    "that larger @xmath73 leads to larger errors is not surprising , but that larger @xmath106 does is rather counter - intuitive : larger @xmath106 means a more smooth and thus more adiabatic push .",
    "it also means a smaller amplitude for the push since the ions will have more time to pick up the gate phase , cf .",
    "( [ eq : xi ] ) .",
    "let us discuss the explanation for this behaviour in more detail .    for exponential suppression of errors to be valid , the evolution should be well into the adiabatic regime . at first sight ,",
    "the relevant timescale is @xmath124 , the oscillation period of the micro traps .",
    "since the traps are assumed to be far apart ( @xmath125 ) the parameter @xmath91 is small and the normal modes of the system have periods shifted little from this value : the cm mode is in fact unaffected by the coulomb interaction and has frequency @xmath80 while the relative motion mode oscillates at @xmath126 . with @xmath127",
    "one should therefore not be able to put excitations into either of these modes .",
    "however , it is perfectly possible to _ transfer _ excitations between the modes , as the adiabatic timescale for this process is @xmath128 .",
    "such a transfer will be induced by mixing of the cm and relative motion during the gate operation .",
    "a linear push potential will not mix the two , but a non - linear one will .",
    "another effect to remember is that when the instantaneous oscillation frequencies change during the push , the external motion will pick up different phases depending on the number of excitation quanta . like the transfer of excitations",
    ", this effect of course disappears if the system is cooled to the ground state . a perturbative calculation to lowest order in @xmath129 , @xmath73 and @xmath91 gives the result @xmath130    \\\\    + 2\\left [      \\frac{1}{\\sinh^2\\left(\\hbar\\omega/2{k_\\mathrm{b}}t\\right)}+2    \\right ]    \\exp\\left(-2\\omega^2\\tau^2\\right )    \\biggr\\ }    .\\end{gathered}\\ ] ] the prefactor gives the scaling behaviour both in the `` nave ''",
    "nonadiabatic limit @xmath131 and in the more relevant intermediate region @xmath132 : @xmath133 in fact , even in the adiabatic limit @xmath134 this scaling holds true since one term in eq .",
    "( [ eq : perturbative_es ] ) does not contain an exponential damping factor with @xmath135 .",
    "this unsuppressed term is stemming from the above mentioned effect of time - varying instantaneous mode frequencies .    from eq .",
    "( [ eq : perturbative_es ] ) we can also understand the strong temperature dependence of the breathing errors . for @xmath136",
    ", the breathing errors will scale approximately like @xmath137 .",
    "however , as seen in figure  [ fig : infidel_s_gnot0 ] , high temperatures require very low values for @xmath73 . for low temperatures , note that one term in eq .",
    "( [ eq : perturbative_es ] ) is not suppressed even at @xmath138 .",
    "this term stems from changes in the ground state widths of the two instantaneous normal modes and is adiabatically suppressed when @xmath139 . to find the dominant term for very low temperatures and short pulses one should do a higher order perturbative calculation .",
    "from the simulations in sec .  [",
    "sec : results ] we learn that without improvement high fidelities require either very low values of @xmath73 or cooling the external motion almost to the ground state . in this section",
    "we shall see how a better performance can be achieved by modifying the temporal shape of the push - pulses .      our first step will be to correct the gate phase by a simple scaling of the push pulse - shape . from fig .",
    "[ fig : infidel_theta_gnot0 ] we know that typical errors can be well above the percent level .",
    "our strategy is based on the observation that the simplest estimate of the gate - phase suggest that it scales as the square of the push - amplitude , @xmath103 .",
    "[ a general gate - phase replaces the @xmath0 in the numerator of eq .",
    "( [ eq : xi ] ) . ]",
    "we therefore divide @xmath103 by the _ square - root _ of the ratio of the observed gate - phase and the ideal gate - phase ( @xmath0 ) and repeat the propagation . in fig .",
    "[ fig : theta_improve ]     by iteratively adjusting the push - amplitude @xmath103 .",
    "the pulse - duration is @xmath140 and the other parameters are as in the previous figures .",
    "four sets of curves are shown , each with results for @xmath113 ( dashed ) , 1 ( full ) , and 8@xmath141 ( dotted ) . the uppermost set ( looks like a single curve ) is for the un - optimized pulse - amplitude and identical to the @xmath140 curves of fig .",
    "[ fig : infidel_theta_gnot0 ] .",
    "the progressively lower sets are for one and two iterations of the amplitude scaling described in the text .",
    "note that as the error gets smaller , temperature begins to have an effect .",
    "this simple adjustment is capable of reducing @xmath54 below @xmath142 for all the considered @xmath143 . ]",
    "we show the results of applying this algorithm to the @xmath140 curves of fig .",
    "[ fig : infidel_theta_gnot0 ] .",
    "as can be seen , @xmath54 is rapidly reduced and can be brought below e.g.@xmath142 in a very modest number of iterations . for simplicity",
    "we ignore the temperature dependent @xmath144 $ ] contribution to @xmath54 when rescaling the pulse .",
    "this is the reason for the @xmath145 ( dotted curves ) departing from the @xmath146 and @xmath147 curves especially at low @xmath73 .",
    "a big advantage of the simple harmonic approximation is that it becomes feasible to solve the equations of motion many times with different temporal shapes of @xmath148 in order to optimize the performance of the gate . rather than simple trial - and - error",
    "we will apply the global control algorithm of krotov , which is guaranteed to improve the performance at each iteration  @xcite .",
    "the relevant equations for our case are given in appendix  [ sec : krotov ] .",
    "in general , it is desirable to complete the gate in as short a time as possible .",
    "this will limit many undesired effects and it will ultimately enable faster quantum computations . a fast gate , however , means that the pushing force will deliver a rather abrupt impulse .",
    "this can lead to excitations of the external motion being left after the completion of the gate , limiting the fidelity . in this section",
    "we show how such `` sloshing '' effects can be avoided by using optimal control .",
    "we start from an initial gaussian temporal shape of the push .",
    "the overall amplitude is first optimized iteratively to get the desired gate phase as described above .",
    "we then run the krotov algorithm to get a better shape of the pulse .",
    "we assume a non - uniform pushing force , @xmath149 .",
    "the result is plotted in fig .",
    "[ fig : elim_slosh ] .    , the contribution of sloshing to the total infidelity , as a function of the number of krotov iterations performed .",
    "the parameters in this example are : @xmath150 , @xmath90 , @xmath151 .",
    "each curve corresponds to a separate value of the pulse duration , @xmath1523.5 , 5.5 , 7.5 , with larger @xmath106 always giving a lower value of @xmath53 . ]    as can be seen , the influence of sloshing motion can be decreased by a couple of orders of magnitude in a modest number of iterations .    to investigate the physical mechanism behind the reduction of the sloshing error , we plot in the lower panel of fig .",
    "[ fig : pulse_shape ]     upper panel : pulse shape both before ( full line ) and after ( dashed line ) krotov optimization .",
    "curves for three different pulse duration are shown , @xmath108 , 5.5 and 7.5 , other parameters are as in fig .",
    "[ fig : elim_slosh ] . only for the shortest pulse is the optimized curve distinguishable from the original gaussian .",
    "lower panel : difference between optimized pulse and initial gaussian pulse ( after adjusting overall amplitude to reduce phase errors ) .",
    "the left plot is for @xmath104 , the right plot is for @xmath149 .",
    "each curve has been normalized to the prediction of a @xmath104 perturbative calculation , which is seen to describe well the @xmath104 case as all curves have a maximal excursion of approximately -1 , while the @xmath153 case is only qualitatively similar . ]    the difference between the optimized pulse @xmath154 and the original gaussian pulse @xmath155 .",
    "this difference looks a lot like a simple cosine - wave with a period close to @xmath156 multiplied by a gaussian of the same width as @xmath157 .",
    "thus the optimized pulse is approximately of the form @xmath158 .",
    "an approximative calculation of the sloshing excitation for the simplest @xmath104 case reveals that for such a pulse , the _ non - resonant _ contribution of the bare gaussian pulse is cancelled by a _ resonant _",
    "contribution from the cosine - modulated pulse .",
    "since the resonant response is much stronger , only a small , negative @xmath159 is needed for this cancellation .",
    "more precisely , the optimal @xmath159 from first order pertubation theory is given by @xmath160 and fig .",
    "[ fig : pulse_shape ] shows that this is also what the krotov algorithm converges to for @xmath104 .",
    "the `` strategy '' of the krotov algorithm in this case seems therefore to be well understood . for @xmath153 ,",
    "it is more difficult to predict the value of @xmath159 , but nonetheless the krotov algorithm seems to be highly efficient .",
    "we now know that phase errors and sloshing errors can be controlled and we turn to the breathing errors of fig .",
    "[ fig : infidel_s_gnot0 ] . without optimization",
    ", these errors put rather stringent limits on the parameters . in order to keep @xmath55 at an acceptable level , either very low temperature or very small @xmath73",
    "is required .",
    "for very low temperature @xmath161 , we need just @xmath162 to get @xmath55 below @xmath163 , but if we assume a more modest cooling to @xmath164 the same error - level require @xmath165 .",
    "note that even at @xmath104 , breathing errors persist and that for @xmath166 they never get below the 10@xmath167 level .",
    "these errors stem from the high order terms in the coulomb potential which have been ignored in eq .",
    "( [ eq : perturbative_es ] ) .    as described in sec .",
    "[ sec : errors_from_s ] , breathing errors can not be eliminated by simply increasing the push duration @xmath106 : first of all the adiabatic time - scale is @xmath168 which will mean a slow gate and secondly even in that limit errors from the change in normal modes frequencies remain and even increase , cf .",
    "discussion below eq .",
    "( [ eq : dom_g_contrib_to_js ] ) .",
    "it turns out that a simple application of the krotov algorithm is also not very efficient in reducing the breathing errors .",
    "a partial explanation for this can be found from the perturbative calculation leading to eq .",
    "( [ eq : perturbative_es ] ) and the analysis of sloshing error - reduction above : since the adiabatic time - scale for the breathing errors is long , the gaussian pulses we consider are not adiabatic w.r.t .",
    "breathing errors and thus the admixture of a small resonant component in the push - pulse will not be enough to get the cancellation we found in the case of sloshing errors .",
    "in fact , the amplitude of the cosine modulation should be comparable to the total amplitude for the relatively short pulses considered",
    ". there is nothing to be gained from a small amplitude modulation and thus the `` linear '' version of the krotov algorithm we apply ( see appendix  [ sec : krotov ] ) will not work .",
    "in fact , in order to cancel out the contribution to the breathing errors due to mode frequency changes , sign changes in the push amplitudes are required during the pulse .",
    "this is beyond the simplest physical implementations where the push amplitude is proportional to some laser intensity . in principle",
    "it is possible to play with detunings to implement the sign changes , and this will in fact give many of the advantages of the @xmath0-pulse method , see ref .",
    "@xcite . allowing negative push amplitudes and putting `` by hand '' an optimized @xmath169 modulated contribution ,",
    "we have been able to e.g.  reduce @xmath170 below @xmath142 for @xmath171 , @xmath172 , and @xmath173 .",
    "compared to the results reported in fig .",
    "[ fig : infidel_s_gnot0 ] , this is a reduction by more than 3 orders of magnitude .",
    "unfortunately , the strongly modified pulse now gives rise to large sloshing errors . to obtain an overall safisfactory fidelity we use a combined strategy",
    ": we first put the breathing error reduction by hand , then iteratively reduce phase errors and finally use the krotov algorithm to reduce the sloshing errors . in fig .",
    "[ fig : opt_pulse_hand_krotov ]     and @xmath149 .",
    "the three contributions @xmath174 , @xmath175 , and @xmath170 are labeled by @xmath176 , @xmath177 , and @xmath178 , respectively .",
    "their sum is labeled by @xmath179 .",
    "the leftmost column are the results for a simple gaussian with @xmath171 .",
    "the breathing errors dominate . in the next column ,",
    "breathing errors have been reduced ( but sloshing increased ) by using a cosine - modulated pulse based on eq .",
    "( [ eq : perturbative_es ] ) .",
    "the overall amplitude is then iteratively optimized to reduce phase errors as described in sec .",
    "[ sec : correcting_phase ] .",
    "as can be seen , 3 iterations are more than sufficient to render @xmath174 completely insignificant .",
    "the dominating error type is now sloshing and in the third column , the krotov algorithm is applied to finally reduced the total infidelity below @xmath163 . ]",
    "we show results of this strategy starting from @xmath171 .",
    "in this paper we have shown how a time - dependent , quadratic approximation to the hamiltonian can be a useful tool when analyzing quantum gates based on conditional external dynamics .",
    "the resulting equations are much more manageable than the original two - body schrdinger equations .",
    "this is especially true if one were to include more spatial dimensions than the one considered here : a full time - dependent , three dimensional , two - body wavefunction calculation is an extremely demanding numerical task , whereas the corresponding quadratic approximation will be much more manageable .",
    "we used the developed method to show how to improve on a nave design of the pushing gate .",
    "this was done including a non - uniform contribution to the pushing force .",
    "an important lesson of our analysis and simulations , is to pay attention to changes in the symmetry of the hamiltonian during the gate operation . in the present case ,",
    "a nonlinear push potential invalidates the separation of the dynamics into cm and relative motion .",
    "this opens up another type of non - adiabaticity , namely transfer of excitations between the two normal modes .",
    "the adiabaticity parameter for this type of error is @xmath180 and for small @xmath91 , adiabaticity will require gate times much larger than the charateristic time of the micro - traps .",
    "an efficient counter - measure is to decrease temperature so that there are in fact no excitations to transfer between modes . failing that",
    ", one should increase @xmath91 as much as possible and , somewhat counter - intuitively , do the gate as fast possible . sloshing errors puts a lower limit on the gate - time , but as we show an optimized choice of the temporal shape of the push can dramatically reduce this problem .    by analyzing the way that the krotov optimized",
    "pulse reduces sloshing errors , we identified the basic mechanism as a destructive interference between the non - resonant , non - adiabatic contribution from the finite push pulse duration and a resonant contribution from a small amplitude superposed oscillation of the push force .",
    "generalizing this idea to deal with breathing errors , we were able to reduce them by several orders of magnitude .",
    "however , since breathing errors are not significantly adiabatically suppressed for the considered pulse durations , the destructive interference required sign - changes in the push amplitude , which introduce experimental complications .",
    "the suppression of breathing errors also came at the price of increased sloshing errors , but we showed that the krotov algorithm once again was able to improve the pulse shape .",
    "one may ask to what extent is the final pulse shape optimal for the given overall gate - time ?",
    "this is an interesting question in general and in this study we saw examples both where the krotov algorithm seemed to exhaust the potential in its `` strategy '' ( the @xmath104 case in fig .",
    "[ fig : pulse_shape ] ) and where it was not able to find an optimization . in the latter case",
    "we could improve the pulse by hand ( eliminate the breathing errors by destructive interference ) .",
    "the problem of optimality is related to the question of a _ quantum speed limit _ ( qsl )",
    "@xcite and this connection has been studied in ref .",
    "note , however , that in our case the hamiltonian is time - dependent and what we want is in fact to leave the external motion unaffected after the pulse .",
    "it would be interesting to investigate such a general adiabaticity problem along the same lines as the work on the qsl .",
    "this research was supported in part by the national science foundation under grant no .",
    "phy05 - 51164 , and in part by the ec projects aqute and emali .",
    "in this section we show that a second order hamiltonian leads to an evolution operator that can be written like @xmath181 eq .",
    "( [ eq : evol_operator ] ) . for alternative parameterizations ,",
    "see refs.@xcite .",
    "we will do a direct calculation showing that @xmath181 fulfills the schrdinger equation @xmath182 the demanding part of the the calculation involves differentiating expontials of time dependent operators .",
    "a useful formular can be found in e.g.  @xcite and involves integration over an auxillary variable @xmath183 .",
    "it results in @xmath184 for the displacement operator and @xmath185 for the squeezing operator .",
    "it is now easy to show that the equations of motion ( [ eq : eoms_d_b ] ) for @xmath39 , @xmath40 and @xmath41 leads to @xmath186 fulfilling eq .",
    "( [ eq : schrodinger ] )  .",
    "in this section we derive expressions for the fidelity as a function of the variables used to characterize the evolution in the harmonic approximation , @xmath63 , @xmath64 , and @xmath187 , @xmath188 .",
    "if we assume that the initial state of the system is a product of an internal state density matrix and an external state density matrix , @xmath189 , we get the following state for the internal degrees of freedom after the application of @xmath13 of eq .",
    "( [ eq : con_dyn_u ] ) : @xmath190    \\\\    = &    \\sum_{\\alpha\\beta }    { { |   \\alpha   \\rangle } \\",
    "! { \\langle   \\beta   | } }    \\ ;    [ \\rho\\circ r]_{\\alpha\\beta }    .",
    "\\end{split}\\ ] ] here `` @xmath177 '' denotes the element - wise matrix product ( the hadamard product ) and @xmath191 is the matrix given by : @xmath192_{\\alpha\\beta }    =    { \\text{tr}}\\left [      { \\hat{u}}^\\text{ex}_{\\alpha }      \\sigma      \\left({\\hat{u}}^\\text{ex}_{\\beta}\\right)^\\dagger    \\right]\\ ] ] it is easy to see that @xmath191 er hermitian and that all its diagonal elements are 1 .",
    "in particular , @xmath193 .",
    "slightly less obvious is it that @xmath191 is positive semi - definite : let @xmath194 .",
    "then : @xmath195    \\\\    & =    { \\text{tr}}\\left [      \\bigl\\{\\sum c_{\\beta}^ * { \\hat{u}}^\\text{ex}_{\\beta}\\bigr\\}^\\dagger      \\bigl\\{\\sum c_{\\alpha}^ * { \\hat{u}}^\\text{ex}_{\\alpha}\\bigr\\ }      \\sigma    \\right ]    \\ge    0 \\end{split}\\ ] ] where we have used the cyclic property of the trace and the fact that the trace of a product of positive semi - definite operators is non - negative .    the element - wise product form in eq .",
    "( [ eq : hadamard_form ] ) is perhaps not the most illuminating .",
    "if we diagonalize @xmath196 , we get instead a krauss operator sum form : @xmath197 with @xmath198 .",
    "there are different ways to define the fidelity of the gate .",
    "the one used in refs .",
    "@xcite and  @xcite is as the minimum fidelity of the obtained final state w.r.t .",
    "the wanted final state when the input state is varied .",
    "this means that @xmath199 with @xmath200 and @xmath201 the gate operator we aim for . in the case of a phase gate , @xmath201 is diagonal in the logical state basis : @xmath202 and we get the simpler minimization problem : @xmath203 where the @xmath204 and @xmath205 .",
    "the matrix @xmath206 is hermitian , but since @xmath207 is confined to be real , only its real symmetric part contributes .",
    "the minimization in eq .",
    "( [ eq : simple_f ] ) is a so - called quadratic programming problem and very efficient numerical methods for its solution exist . given @xmath208 it is therefore simple to calculate @xmath209 on the computer .",
    "however , a more direct evaluation is possible if fidelity is instead defined as an _ average _ over input states as @xmath210 here @xmath211 denotes the normalized states ( unit sphere ) in @xmath212 and the volume element @xmath213 is such that @xmath214 . for @xmath51",
    "a compact formula exist  @xcite and using it in the present case leads to @xmath215 or when using the properties of @xmath208 : @xmath216    \\right )    .\\ ] ]      typically , we will be mostly interested in situations where the four logical states leads to almost identical evolutions for the external states .",
    "it is then useful to write @xmath217 where @xmath218 $ ] and @xmath219 . calculating @xmath208 to second order in the @xmath220 s ,",
    "we get : @xmath221 this form is useful , as it separates the infidelity into systematic phase - errors ( the @xmath222 factors ) and `` decoherence '' ( factor in curly brackets ) .",
    "the phase errors @xmath223 can be made small by tuning the average of laser powers etc .  and this can usually be done very well .",
    "the challenge will therefore most often be to suppress the fluctuations , i.e. , the terms in curly brackets in eq .",
    "( [ eq : r_2nd_order ] ) .    assuming also the @xmath224 s to be small , eq .",
    "( [ eq : infidel_of_r ] ) becomes : @xmath225 ^ 2      +      \\left\\langle \\left(\\delta { \\hat{d}}_\\alpha- \\delta { \\hat{d}}_\\beta \\right)^2\\right\\rangle    \\right )    .\\ ] ] at first sight , this form might seem dubious since only _ differences _ in the @xmath224 s and @xmath220 s enter",
    ". however , one should remember that any _ common _ evolution on the four branches can be absorbed into @xmath226 in eq .",
    "( [ eq : def_d ] ) .",
    "this emphasizes that for the implementation of a single gate on the logical state , the external motion must not necessarily be returned to its initial state as long as the final state is common to all logical input states .",
    "typically , the further requirement that energy is not pumped into the external degrees of freedom by repeated application of the gate must be made . in the particular case of the pushing gate , this requirement is in fact already hidden in eq .",
    "( [ eq : infidel_2_order ] ) since the @xmath227 branch contains no pushing . in other cases , one could apply cooling to the external state between gate operations .",
    "we are seeking to implement the phase - gate ( [ eq : def_u0 ] ) .",
    "in many cases , the @xmath60 s are not so important individually since single - particle operations are easy to perform and only the truely non - local phase is interesting . assuming that perfect single - particle phase changes can be implemented _ on average _ , it is straightforward to show that one should replace @xmath228 ^ 2 $ ] by @xmath229 ^ 2\\ ] ] in eq .",
    "( [ eq : infidel_2_order ] ) .    this simplified view of single - particle phase - changes should of course be revisited in a more complete analysis of any given proposal for quantum - computing . in the present work we use the replacement ( [ eq : non - local_phase ] ) throughout , but let us emphasize that _ fluctuations _ in the single - particle phaserotations are more naturally incorporated in the @xmath220 terms of eq .",
    "( [ eq : infidel_2_order ] ) than in the @xmath224 terms : one simply model the fluctations as a consequence of some fluctuating parameter which can be included in @xmath230 .",
    "for gaussian evolutions like ( [ eq : evol_operator ] ) and a gaussian ( e.g. thermal ) external state @xmath231 with _ covariance _ matrix @xmath232      -{\\text{tr}}\\left[q_i\\sigma\\right ] { \\text{tr}}\\left[q_j\\sigma\\right ]    \\end{split}\\ ] ] and vanishing means @xmath233 = 0\\ ] ] one gets phase contributions @xmath234\\ ] ] and decoherence terms @xmath235    \\\\",
    "+ \\frac{1}{8 } { \\text{tr}}\\left[(b_\\alpha - b_\\beta ) j(b_\\alpha - b_\\beta ) j \\right]\\end{gathered}\\ ] ]    in general , for a harmonic oscillator in thermal equilibrium at temperature @xmath117 , the covariance matrix is given by @xmath236 where @xmath237 is the boltzmann constant . in the present case ,",
    "the cm and the relative motion are separately in thermal equilibrium and for the corresponding dimensionless position and momentum operators [ @xmath238 etc . ]",
    ", we get : @xmath239 with @xmath240 and @xmath241 in the limit @xmath242 , a we have approximately @xmath243 if we use the set of individual - ion operators @xmath244 .",
    "optimizing the temporal shape of the push pulse is done using the krotov algorithm  @xcite . for an introduction to the method , see e.g.  ref .",
    "@xcite .",
    "the key ingredient in this approach is a function @xmath245 which allow us to translate the _ global _ goal of improving the final @xmath246 to a _ local _ problem of choosing a better @xmath148 for each @xmath27 .",
    "constructing @xmath247 is in general very difficult , but it is relatively simple to get a linear approximation to it .",
    "the coefficients in this approximation will constitute a set of auxillary variables .",
    "for each branch , the equations of motion for the auxillary variables @xmath248 , @xmath249 and @xmath250 are determined by the requirement that they are conjugate to the physical variables @xmath63 , @xmath64 , and @xmath187 , respectively .",
    "let us focus on a single branch and suppres the @xmath17 index like in sec .",
    "[ sec : harmonic_approx ] .",
    "we then need to construct @xmath251 such that eqs .",
    "( [ eq : eoms_d_b ] ) can be written @xmath252 this leads simply to @xmath253    \\\\    & \\phantom{= }    + { \\mathbf{\\tilde{q}}}^\\mathrm{t}\\bigl[jh(t,{\\mathbf{\\overline{x}}}){\\mathbf{\\overline{q}}}-j{\\mathbf{f}}(t,{\\mathbf{\\overline{x}}})\\bigr ]    \\\\    & \\phantom{= }    + { \\text{tr}}\\bigl[{\\tilde s}^\\mathrm{t } j h(t,{\\mathbf{\\overline{x}}})s \\bigr ] \\end{split}\\ ] ] then the equations of motion for the auxillary variables become @xmath254 the equation of motion for @xmath255 is rather involved since @xmath256 depends on @xmath50 in a complicated manner through @xmath44 , @xmath257 and @xmath258 .",
    "it can be rewritten as two coupled time - dependent , forced harmonic oscillators .",
    "note on the other hand that @xmath259 is time - independent and that @xmath260 solves the same equation as @xmath261 .",
    "our ultimate goal is to improve the fidelity of the gate .",
    "however , it is somewhat impractical to apply this as the objective in the krotov algorithm : calculating the fidelity is only simple for small errors and in general it depends on e.g.  the temperature of the external motion",
    ". instead we shall work with a simpler function of the variables @xmath39 , @xmath49 and @xmath261 for the four branches .",
    "the reduction of this _ objective function _ should tend to increase the fidelity of the gate .",
    "based on the fact that in the pushing gate , the branch @xmath227 is not subject to any time - dependent forces , we choose the following : @xmath262 ^ 2      \\\\      & \\phantom{\\beta=}+      \\frac{1}{2}\\sum_\\beta \\left [        \\bigl({\\mathbf{x}}_\\beta-{\\mathbf{x}}_{00}\\bigr)^2        + \\bigl({\\mathbf{p}}_\\beta-{\\mathbf{p}}_{00}\\bigr)^2      \\right ]      \\\\      & \\phantom{\\beta=}+      \\frac{1}{2}\\sum_\\beta      { \\text{tr}}\\left [        \\bigl(s_\\beta - s_{00}\\bigr)^\\mathrm{t}\\bigl(s_\\beta - s_{00}\\bigr )      \\right ]      .",
    "\\end{split}\\ ] ] the term with @xmath39 s aim to ensure the correct phase in the phasegate , while the other terms aim at identical evolution for the external motin in the four branches . in the limit @xmath242 eq .  ( [ eq : infidel_2_order ] ) formally justifies the use of our chosen objective function , given the extra proviso that we are only interested in the non - local part of the phase .",
    "the objective function supplements the auxillary - variable equations of motion ( [ eq : eoms_auxphi][eq : eoms_auxs ] ) with the following _ terminal conditions _ ,",
    "i.e. boundary conditions at @xmath9 : @xmath263 where @xmath264 is @xmath265 for @xmath227 and @xmath4 and @xmath266 for @xmath267 and @xmath3 .",
    "these equations express the values of the auxillary varibles at time @xmath9 in terms of the physical varibles also at @xmath9 and give the input to the backwards propagation of the auxillary variables , cf .  ref ."
  ],
  "abstract_text": [
    "<S> we analyze in detail the so - called `` pushing gate '' for trapped ions , introducing a time dependent harmonic approximation for the external motion . </S>",
    "<S> we show how to extract the average fidelity for the gate from the resulting semi - classical simulations . </S>",
    "<S> we characterize and quantify precisely all types of errors coming from the quantum dynamics and reveal for the first time that slight nonlinearities in the ion - pushing force can have a dramatic effect on the adiabaticity of gate operation . by means of quantum optimal control techniques , </S>",
    "<S> we show how to suppress each of the resulting gate errors in order to reach a high fidelity compatible with scalable fault - tolerant quantum computing . </S>"
  ]
}