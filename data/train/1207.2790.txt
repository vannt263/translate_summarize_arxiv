{
  "article_text": [
    "this is paper iv of a series that explores the three - dimensional ( 3d ) reconstruction of coronal loops with data from the two stereo a and b spacecraft .",
    "the previous three studies focused on the 3d geometry of coronal loops ( aschwanden et al .",
    "2008b ) , on electron density and temperature measurements ( aschwanden et al .",
    "2008c ) , and on active region modeling with a stereoscopic tomography method ( aschwanden et al .",
    "2009 ) . in this fourth study",
    "we concentrate on magnetic modeling of four stereoscopically observed active regions , which should reveal whether potential or non - potential magnetic field models fit the observed data better , and should provide more accurate information on magnetic fields and electric currents that are directly inferred from observables , and this way allow us to test theoretical magnetic field models of the solar corona .",
    "the crucial benefit of this study is the inference of the true 3d magnetic field geometry , which presently can only be accurately measured by stereoscopic triangulation with the dual spacecraft stereo / a and b , and thus it provides a most crucial input to test theoretical magnetic field models .",
    "the _ solar terrestrial relations observatory ( stereo ) _ was launched on october 26 , 2006 , consisting of two identical spacecraft a(head ) and b(ehind ) that orbit from the earth in opposite directions around the sun , with a separation angle that increases by @xmath12 per year ( kaiser 2008 ) .",
    "some tutorials or reviews on magnetic modeling using stereo data can be found in inhester ( 2006 ) , wiegelmann et al .",
    "( 2009 ) , and aschwanden ( 2011 ) .",
    "early methods of stereoscopic 3d magnetic field modeling have been already proposed in the pre - stereo era , including loop twist measurements by fitting the projected shape of curved helical field lines ( portier - fozzani et al .",
    "2001 ) , by fitting a linear force - free model to coronal loops geometrically reconstructed with solar - rotation stereoscopy ( wiegelmann and neukirch 2002 ; feng et al .",
    "2007a ) , by tomographic reconstruction constrained by the magnetohydrostatic equations ( wiegelmann and inhester 2003 ; ruan et al .",
    "2008 ) , by comparison of theoretical magnetic field models with spectro - polarimetric loop detections ( wiegelmann et al .",
    "2005 ) , or by using theoretical magnetic field models to resolve the stereoscopic correspondence ambiguity of triangulated loops ( wiegelmann and inhester 2006 ; conlon and gallagher 2010 ) .",
    "once the stereo mission was launched , the first stereoscopic triangulations of loops were performed from data of april 2007 onward , with a spacecraft separation angle of @xmath13 ( feng et al .",
    "2007b ; aschwanden et al .",
    "first fits of linear force - free field extrapolations ( using soho / mdi magnetograms ) to stereoscopically triangulated loops were found to be offset ( feng et al .",
    "2007b ; inhester et al .",
    "a benchmark test of one potential field code and 11 nonlinear force - free field codes modeling a partial active region ( noaa 10953 ) observed with hinode / sot and stereo / euvi on 2007 apr 30 revealed mean 3d misalignment angles of @xmath14 for the potential field code , and a range of @xmath15 for the non - potential field ( nlfff ) codes , which was attributed to the non - force - freeness in chromospheric heights and uncertainties in the boundary data ( derosa et al .",
    "misalignment measurements between stereoscopically triangulated loops and _ potential field source surface ( pfss ) _ magnetic field extrapolations were then extended to four active regions with a similar finding of @xmath16 ( sandman et al .",
    "2009 ) . the misalignment could be reduced by about a factor of two for potential field models that were not constrained by observed magnetograms , where the magnetic field is parameterized by buried unipolar magnetic charges ( aschwanden and sandman 2010 ) or by a small number of 3 - 5 submerged dipoles ( sandman and aschwanden 2011 ) .",
    "these exercises demonstrated that potential field solutions exist that match the 3d geometry of coronal loops better than standard extrapolations from photospheric magnetograms .",
    "modeling of non - potential magnetic fields , constrained by stereoscopically triangulated loops , however , is still unexplored . a first step in this direction",
    "was pioneered by malanushenko et al .",
    "( 2009 ) , taking a particular model of a nonlinear force - free field with a known analytical solution ( low and lou 1990 ) and fitting a linear force - free field individually to each field line , which yields the twist and force - free @xmath6-parameter for each loop individually , but not in form of a self - consistent nonlinear force - free field .",
    "in a next step , a self - consistent nonlinear force - free field was fitted to the @xmath6 s or each loop ( malanushenko et al .",
    "2012 ) . in this study",
    "we pursue for the first time non - potential magnetic field modeling applied to an observed set of coronal loops , i.e. , to some 500 loops that have been stereoscopically triangulated from four different active regions .",
    "since currently available nlfff codes are very computing - intensive , which precludes an iterative fitting to individual loops , we developed a magnetic field parameterization that is suitable for fast forward - fitting .",
    "in this parameterization , the magnetic field is characterized by a superposition of point charges with vertically twisted fields , which is approximately force - free ( to second order in @xmath6 ) , as derived analytically ( aschwanden 2012 ) and tested numerically ( aschwanden and malanushenko 2012 ) .",
    "since forward - fitting requires some form of model parameterization , tests with physics - based models ( such as twisted field components used here ) will be useful to explore how closely the observed loop geometry can be fitted at all , although our choice of parameterization represents only a subset of all possible nonlinear force - free solutions .",
    "we will test the validity of the divergence - freeness and force - freeness numerically and quantify it by common figures of merit , which can be compared with the performance of other full - fledged nlfff codes ( which , however , are not capable of fast forward - fitting to observations ) .",
    "the outline of this paper is as follows : section 2 contains the theoretical outline of a force - free field approximation , section 3 presents the results of forward - fitting to some 500 stereoscopically triangulated loops , and section 4 concludes with a discussion of the results .",
    "technical details of the forward - fitting code are described in appendix a and in two related documentations ( aschwanden 2012 ; aschwanden and malanushenko 2012 ) .",
    "here we develop a novel method to determine an approximate 3d magnetic field model of a solar active region , using a magnetogram that contains the line - of - sight magnetic field component and a set of stereoscopically triangulated loops , observed with stereo / a and b in extreme ultraviolet ( euv ) wavelengths . a flow chart of this magnetic field modeling algorithm is given in fig .  1 .",
    "magnetograms that contain the line - of - sight magnetic field component @xmath17 are readily available , while vector magnetograph data that provide the 3d magnetic field components @xmath18 $ ] are only rarely available , are difficult to calibrate , resolving the @xmath19 ambiguity is challenging ( even with the recent hmi / sdo instrument ) , and they generally contain substantially larger data noise in the b - components than magnetograms .",
    "it is therefore desirable to develop a method that infers 3d magnetic field components from magnetogram images .",
    "such a method was recently developed with the concept of parameterizing the 3d magnetic field with subphotospheric unipolar magnetic charges that can be determined from an observed line - of - sight magnetogram , as described in aschwanden and sandman ( 2010 ) . in the first version we neglected the curvature of the solar surface , because the analyzed active regions have generally a substantially smaller size than the solar radius . for higher accuracy of the magnetic field model ,",
    "however , we generalize the method by including here the full 3d geometry of the curved solar surface .",
    "the simplest representation of a magnetic potential field that fulfills maxwell s divergence - free condition ( @xmath20 ) is a magnetic charge that is buried below the solar surface ( to avoid magnetic monopoles in the corona ) , which predicts a magnetic field @xmath21 that points away from the buried unipolar charge and whose field strength falls off with the square of the distance @xmath22 , @xmath23 where @xmath24 is the magnetic field strength at the solar surface directly above the buried magnetic charge , @xmath25 is the subphotospheric position of the buried charge , @xmath26 is the depth of the magnetic charge , and @xmath27 $ ] is the distance vector of an arbitrary location @xmath28 in the solar corona ( where we desire to calculate the magnetic field ) from the location @xmath29 of the buried charge .",
    "we choose a cartesian coordinate system @xmath30 with the origin in the sun center and use units of solar radii , with the direction of @xmath31 chosen along the line - of - sight from earth to sun center . for a location near disk center ( @xmath32 ) ,",
    "the magnetic charge depth is @xmath33 , an approximation that was used earlier ( aschwanden and sandman 2010 ) , while we use here the exact 3d distances to account for the curvature of the solar surface and for off - center positions of active region loops .",
    "our strategy is to represent an arbitrary line - of - sight magnetogram with a superposition of @xmath34 magnetic charges , so that the potential field can be represented by the superposition of @xmath34 fields @xmath35 from each magnetic charge @xmath36 , @xmath37 with @xmath38 $ ] the distance from the magnetic charge @xmath39 . since the divergence operator is linear , the superposition of a number of potential fields is divergence - free also , @xmath40 this way we can parameterize a 3d magnetic field @xmath21 ( eq .",
    "2 ) with @xmath41 parameters , i.e. , @xmath42 .    a simplified algorithm to derive the magnetic field parameters @xmath42 from a line - of - sight magnetogram @xmath17 is described in the previous study ( aschwanden and sandman 2010 ) .",
    "essentially we start at the position @xmath43 of the peak magnetic field @xmath44 in the magnetogram image , fit the local magnetic field profile @xmath45 ( eq .  1 ) to obtain the parameters of the first magnetic field component @xmath46 , subtract the first component from the image @xmath17 , and then iterate the same procedure at the second - highest peak to obtain the second component @xmath47 , and so forth , until we stop at the last component @xmath48 above some noise threshold level .",
    "we alternate the magnetic polarity in the sequence of subtracted magnetic charge components , in order to minimize the absolute value of the residual maps .",
    "the number of necessary components typically amounts to @xmath49 for an active region , depending on the complexity and size of the active region .",
    "the geometrical details of the inversion of the parameters @xmath50 of a magnetic field component from the observables @xmath51 of an observed peak in a line - of - sight magnetogram at position @xmath52 with peak value @xmath53 and width @xmath54 is derived in appendix a.      with the 3d parameterization of the magnetic field described in the foregoing section we can compute magnetic potential fields that fulfill maxwell s divergence - free condition and are `` current - free '' , @xmath55 however , magnetic potential field models do not fit observed 3d loop geometries sufficiently well ( derosa et al .",
    "2009 ; sandman et al .",
    "2009 ; aschwanden and sandman 2010 ; sandman and aschwanden 2011 ) .",
    "therefore , we turn now to non - potential magnetic field models of the type of nonlinear force - free fields ( nlfff ) , @xmath56 where @xmath57 is a scalar function that varies in space , but is constant along a given field line , and the current @xmath58 is co - aligned and proportional to the magnetic field @xmath59 .",
    "general nlfff solutions of eq .",
    "( 5 ) , however , are very computing - intensive and are subject to substantial uncertainties due to insufficient boundary constraints and non - force - free conditions in the lower chromosphere ( schrijver et al .  2006 ; derosa et al .",
    "2009 ) . in our approach to model nlfff solutions that fit stereoscopically triangulated loops",
    "we thus choose approximate analytical nlfff solutions that can be forward - fitted to the observed 3d loop geometries much faster .",
    "the theoretical formulation of the force - free magnetic field approximation suitable for fast forward - fitting is described in aschwanden ( 2012 ) and numerical tests are given in aschwanden and malanushenko ( 2012 ) .",
    "the essential idea is that we generalize the concept of buried point charges we used for the representation of a potential field , by adding an azimuthal magnetic field component @xmath60 that describes a twist around a vertical axis .",
    "the concept is visualized in fig .",
    "an untwisted flux tube can be represented by parallel field lines @xmath61 along an axis @xmath62 with variable distances @xmath63 from a given axis @xmath62 ( fig .  2 ,",
    "left ) . a uniformly twisted flux tube with some azimuthal component @xmath60 around the twist axis @xmath62 ( fig .",
    "2 , middle ) has the following analytical solution for a force - free field ( gold and hoyle 1958 ; priest 1982 , p.125 ; sturrock 1994 , p.216 ; boyd and sanderson 2003 , p.102 ; aschwanden 2004 , p.216 ) , @xmath64 @xmath65 where @xmath66 is a parameter that quantifies the number @xmath67 of full twist turns over a ( loop ) length @xmath68 , @xmath69 and is related to the force - free parameter @xmath6 in the force - freeness condition @xmath70 by , @xmath71 thus , we see that @xmath6 has a finite value @xmath72 at the twist axis and drops monotonically with increasing distance @xmath63 from the twist axis .    in a next step",
    "we generalize the concept of a cylindrical twisted flux tube ( fig .  2 , middle ) to a point",
    "charge with an associated vertically twisted field ( fig .  2",
    ", right ) .",
    "the main difference to the twisted flux tube , which has a constant cross - section and thus a constant magnetic flux along the cylinder axis , is the quadratically decreasing field strength of the longitudinal field component @xmath73 along the twist axis with distance @xmath62 , to conserve the magnetic flux .",
    "it can be shown analytically , that this topology has the following approximate force - free and divergence - free solution ( satisfying eqs .  4 and 5 ) ,",
    "if we neglect second - order and higher - order terms of @xmath74 $ ] ( aschwanden 2012 ) , @xmath75 @xmath76 @xmath77 @xmath78 since @xmath79 for @xmath80 ( eq .  13 ) , we refer to this approximation as second - order accuracy in @xmath6 for short .",
    "thus we can characterize a point charge with a vertically twisted field with 5 parameters : @xmath81 , where the force - free parameter @xmath82 at the twist axis is related to @xmath83 by @xmath84 .    in analogy to the superposition principle we used to construct an arbitrary potential field based on a number of @xmath34 magnetic charges , we apply the same superposition rule to a number of @xmath34 point charges with vertical twist , @xmath85 and we can parameterize an arbitrarily complex non - potential field with @xmath86 free parameters .",
    "the superimposed field @xmath59 , which consists of a linear combination of quasi - force - free field components ( to second order in @xmath6 ) is not exactly force - free , but it can be shown that the nlfff approximation expressed in eq .",
    "( 10 - 13 ) is divergence - free to second - order accuracy in the term @xmath74 $ ] , and force - free to third - order accuracy ( aschwanden 2012 ) , which we call `` quasi - force - free '' here .",
    "the superposition of multiple twisted sources , which have each a twist axis with a different location and orientation ( due to the curvature of the solar surface ) , needs to be transformed into a common cartesian coordinate system , which is derived in detail in section 2.4 in aschwanden ( 2012 ) .",
    "we show a few examples of this non - potential magnetic field model in fig .  3 , for a unipolar , a dipolar , and a quadrupolar configuration .",
    "more cases are simulated in aschwanden ( 2012 ) .",
    "three cases are shown for the non - potential case with twist ( fig .  3 , right panels ) , which degenerate to the potential field case if the twist parameter is set to zero ( @xmath87 ) ( fig .  3 , left panels ) .",
    "in our data analysis we perform a global fit of our non - potential field model to a set of stereoscopically triangulated loops , typically we use a magnetic field model with @xmath88 magnetic field components ( which has @xmath89 potential field parameters that can directly be inverted from the line - of - sight magnetogram @xmath90 , and @xmath91 non - potential field parameters @xmath92 , which need to be forward - fitted to the data , consisting of the stereoscopic 3d coordinates of some @xmath93 loops per active region .",
    "each forward - fit minimizes the average misalignment angle ( along and among the loops ) between the theoretical model ( i.e. , twisted fields ) and the observed loop ( with stereoscopically triangulated 3d coordinates ) .",
    "the misalignment angle at a position @xmath94 is defined as ( sandman et al .",
    "2009 ; aschwanden and sandman 2010 ; sandman and aschwanden 2011 ) : @xmath95 we derive a characteristic misalignment angle from measurements at 10 equi - spaced postions @xmath94 along each observed loop segment , where a unique theoretical field line @xmath96 is calculated at each loop position . generally , this yields 10 theoretical field lines that intersect a single loop at the 10 chosen positions , which degenerate to one single theoretical field line in the case of a perfectly matching model .",
    "the range of misalignment angles ignores the @xmath19-ambiguity and is defined in the range of @xmath97 $ ] .",
    "technical details of the numerical algorithm of our forward - fitting code to the stereoscopic loop coordinates are provided in aschwanden and malanushenko ( 2012 ) .      in order to obtain",
    "the 3d coordinates of coronal loops we require one ( or multiple wavelength filter ) image pairs recorded with the two spacecraft stereo / a(head ) and b(ehind ) , at some spacedraft separation angle that is suitable for stereoscopy . here",
    "we will use stereo data from the first year ( 2007 ) of the mission , when the spacecraft separation was @xmath98 .",
    "an example of such a stereoscopic pair of euvi images recorded at a wavelength of 171  is shown in fig .  1 ( top right ) .",
    "loop recognition requires a segmentation algorithm that traces curvi - linear features .",
    "there are visual / manual methods as well as automated methods , which have been compared in a benchmark study ( aschwanden et al .",
    "although automated detection algorithms have improved to the level or approaching visual perception for single images ( aschwanden 2010 ) , an automated algorithm for dual detection of corresponding loop patterns in stereoscopic image pairs has not yet been developed yet , so that we have to rely on manual / visual detection .",
    "the 3d coordinates of such visually detected loops have been documented in previous publications ( aschwanden 2008b , c , 2009 ; sandman et al .  2009 ; aschwanden and sandman 2010 ; sandman and aschwanden 2011 ) .",
    "the technique of loop detection falls into the category of image segmentation algorithms .",
    "the easiest way to segment coronal loops in an euv image is to apply first a highpass filter ( fig .  1 ) , which enhances fine structures , in particular coronal loops with narrow widths .",
    "stereoscopic triangulation can then be accomplished by ( 1 ) co - aligning a stereoscopic image pair into epipolar coordinates ( where the stereoscopic parallax effect has the same direction in both images ) , ( 2 ) tracing a loop visually in a stereo / a image , ( 3 ) identifying the corresponding counterpart in the stereo / b image using the expected projected altitude range ; ( 4 ) stereoscopic triangulation of the loop coordinates @xmath99,y_l[s],z_l[s])$ ] ( along the loop length coordinate @xmath62 ) , and ( 5 ) coordinate transformations into an earth - sun heliographic coordinate system . here",
    "we have to transform stereo / a coordinates into the soho / mdi coordinate system , in order to enable magnetic modeling with mdi magnetograms .",
    "the height range of stereoscopically triangulated loops does generally not exceed 0.15 solar radii , due to the decrease of dynamic range in flux for altitudes in excess of one hydrostatic scale height . here",
    "we used the loop tracings and stereoscopic measurements from three different euvi channels combined ( 171 , 195 , 284 ) .",
    "the method of stereoscopic triangulation is described in detail in previous papers ( aschwanden 2008b , c , 2009 ) .    what is also important to know when we attempt magnetic modeling of stereoscopically triangulated coronal loops is the related uncertainty .",
    "the parallax effect occurs mostly in east - west direction , which implies that loop segments with north - south direction can be most accurately triangulated , while the accuracy decreases progressively for segments with longer components in east - west direction ( aschwanden 2008b ) .",
    "another source of error is mis - identification or confusion of dual loop counterparts in stereoscopic image pairs , an uncertainty that can only be quantified in an empirical manner .",
    "such empirical estimates of stereoscopic errors were evaluated by measuring deviations from parallelity of loop pairs triangulated in near proximity , which yielded an estimated uncertainty in the absolute direction of @xmath100 for four analyzed active regions ( aschwanden and sandman 2010 ) .",
    "so , even when we achieve a theoretical magnetic field model that perfectly matches the observed loops , we expect a residual misalignment error of @xmath101 due to the uncertainty of stereoscopic triangulation .",
    "the input from the line - of - sight magnetogram provides the longitudinal component @xmath90 at the photospheric level @xmath102 , which corresponds to the z - coordinate @xmath103 .",
    "the decomposition of the magnetogram data into unipolar magnetic charges ( section 2.1 and appendix a ) yields the full 3d vector field , @xmath104 $ ] on the solar surface at the photospheric level @xmath105 , which is a potential field by definition , since the derived field consists of a superposition of potential fields from single magnetic charges ( eq .  2 ) .    the nonlinear force - free magnetic field model ( section 2.2 ) , which we fit to the data by optimizing the misalignment angles with our chosen parameterization , defines a non - potential field @xmath106 , @xmath107 , @xmath108 $ ] , which can be extrapolated at any point in the corona by stepping along a field line @xmath109 $ ] in small incremental steps @xmath110 , where the cosines of the cartesian magnetic field components @xmath3 define also the direction of the field line , so that it can be iteratively calculated with @xmath111 p \\\\          y(s+\\delta s ) & = y(s ) + \\delta s [ b_y(s)/b(s ) ] p \\\\",
    "z(s+\\delta s ) & = z(s ) + \\delta s [ b_z(s)/b(s ) ] p \\\\      \\end{array } \\ .\\ ] ] where @xmath112 represents the sign or polarization of the magnetic charge .",
    "the force - free parameter @xmath113 of our forward - fitted field @xmath114 at any given point of space in the computational box @xmath115 can be numerically computed for each of the three vector components of @xmath116 , @xmath117 @xmath118 @xmath119 using a second - order scheme for the spatial derivatives , i.e. , @xmath120 . in principle , the three values @xmath121 , @xmath122 , @xmath123 should be identical , but the numerical accuracy using a second - order differentiation scheme is most handicapped for those loop segments with the smallest values of the @xmath124-component ( appearing in the denominator ) , for instance in the @xmath123 component @xmath125 near the loop tops ( where @xmath126 ) .",
    "it is therefore most advantageous to use all three parameters @xmath121 , @xmath122 , and @xmath123 in a weighted mean , @xmath127 but weight them by the magnitude of the ( squared ) magnetic field strength in each component , @xmath128 so that those segments have no weight where the @xmath124-component approaches zero .",
    "this numerical method was found to render the @xmath6-parameters most accurately ( aschwanden and malanushenko 2012 ) , while the analytical approximation ( eq .  13 ) breaks down near loop tops ( where @xmath126 ) .",
    "the computation of the current densities @xmath129 follows then directly from eq .",
    "( 5 ) , @xmath130 for instance , a photospheric ( vertical ) current map , i.e. , @xmath131 , as shown in in fig .  1 ( bottom panel ) , can be calculated with eq .",
    "( 22 ) for the photospheric level at @xmath103 .",
    "we present now the results from four active regions , which all have been modeled with different magnetic field models before also ( derosa et al .  2009 ; sandman et al .",
    "2009 ; aschwanden and sandman 2010 ; sandman and aschwanden 2011 ) and can now be compared with our modeling results .",
    "a summary of the four active regions , including the observing time , heliographic position , stereo spacecraft separation , number of stereoscopically triangulated loops , maximum magnetic field strength , and magnetic flux is given in table 1 , which is reproduced from aschwanden and sandman ( 2010 ) .",
    "the first step of our analysis is the decomposition of the observed _",
    "soho_/mdi magnetograms of four active regions into @xmath34 magnetic charges ( eq .  2 ) , which yields the @xmath132 parameters @xmath133 $ ] , @xmath36 for the 3d parameterization @xmath21 of the magnetic field . in the remainder of the paper",
    "we will label the four active regions observed at the given times as follows ( see also table 1 ) :    _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ @xmath134 for active region 10953 , 2007-apr-30 , 23:00 ut , + @xmath135 for active region 10955 , 2007-may-9 , 20:30 ut , + @xmath136 for active region 10953 , 2007-may-19 , 12:40 ut , + @xmath137 for active region 10978 , 2007-dec-11 , 16:30 ut .",
    "+ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _    the pixel size of mdi magnetograms is @xmath138 and the mdi magnetograms have been decomposed into gaussian - like peaks ( each one corresponding to a buried unipolar magnetic charge ) .",
    "the chosen field - of - views ( fov ) of the four active regions are ( in units of solar radii ) :    _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ @xmath139 $ ] , + @xmath140 $ ] , + @xmath141 $ ] , + @xmath142 $ ] .",
    "+ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _    so , all four active regions are located near disk center @xmath143 $ ] , but some extend out to 0.65 solar radii ( fov a ) .",
    "we show the observed magnetograms @xmath17 for the 4 active regions in fig .  4 ( left column ) , the corresponding model maps @xmath17 built from @xmath144 magnetic charge components ( fig .  4 , middle column ) , and the difference between the observed and model maps ( fig .  4 , right column ) , all on the same grey scale , so that the fidelity of the model can be judged .",
    "the residual fields of the decomposed magnetograms after subtraction of @xmath144 components are    _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ @xmath145 for @xmath134 , + @xmath146 for @xmath135 , + @xmath147 for @xmath136 , + @xmath148 for @xmath137 , + _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _    ( with the maximum field strengths @xmath149 listed in table 1 ) .",
    "therefore , our decomposition algorithm ( appendix a ) represents the observed magnetic field down to a level of @xmath150 residuals .",
    "note that this method yields the 3d components of the magnetic field , @xmath151 $ ] , with the accuracy specified for the case of a potential field , while the accuracy for a non - potential field components ( i.e. , horizontal components @xmath152 and @xmath53 ) probably does not exceed a factor of two of this accuracy ( i.e. , @xmath153 ) , which is still better than the accuracy of currently available vector magnetograph data ( in the order of @xmath154 for strong fields and worse for weak fields ; marc derosa , private communication ) .      in fig .",
    "5 we show the comparison of @xmath155 stereoscopically triangulated coronal loops for active region @xmath156 ( 2007 apr 30 ) , obtained from stereo spacecraft euvi / a and euvi / b data , with the potential - field model composed from @xmath157 buried magnetic charges ( eq .  2 ) . for each modeled magnetic field line",
    "we have chosen the midpoint of the observed stereo loop segment as the starting point , from which we extrapolate the potential field in both directions for segments ( red curves ) that are equally long as the observed loop segments ( blue curves ) .",
    "a histogram of the median misalignment angles is shown in fig .",
    "5 ( bottom ) , measured at 10 positions along each loop segment , which has an average ( a ) of @xmath158 , a median ( m ) of @xmath159 , or a gaussian peak ( p ) fit with a centroid and width of @xmath160 .",
    "so , there is broad distribution of misalignment angles in the range of @xmath161 , which clearly indicates that a potential field model is not a very good fit for these observables .    in figs .  6 - 9 we present the main results of our force - free field forward - fitting code applied to the stereoscopically triangulated coronal loops data , for all four active regions @xmath156 , @xmath124 , @xmath162 , and @xmath163 .",
    "the 3d coordinates of the observed stereoscopic loops ( figs .  6 - 9 ; blue curves ) and forward - fitted theoretical field lines ( figs .",
    "6 - 9 : red curves ) are shown in three projections , in the @xmath164 plane ( in direction of the line - of - sight ) , as well as in the orthogonal @xmath165 and @xmath166 planes .",
    "the theoretical field lines are extrapolated to equally long segments as the observed euv loops .",
    "the field lines have been computed with a step size of @xmath167 solar radii ( i.e. , @xmath168 km ) , which is identical to the spatial resolution of the magnetogram from soho / mdi ( @xmath169 km ) , and commensurable with the spatial resolution of stereo / euvi ( i.e. , 2 pixels with a size of @xmath170 , which is @xmath171 km ) .",
    "fig .  5 and fig .",
    "6 show a direct comparison of modeling potential and non - potential fields for active region @xmath156 , which results into a broad gaussian distribution of @xmath172 for the potential field , and to a much narrower distribution of @xmath173 for the non - potential field model .",
    "a * online - movie * that visualizes the forward - fitting process from the initial guess of a potential field model to the best - fit non - potential model is also included in the * online electronic supplementary material * of this paper .      a quantitative measure of the agreement between a theoretical magnetic field model and the 3d coordinates of observed coronal loops is the statistics of misalignment angles , which is shown for all four active regions in the bottom panels of figs .",
    "we find the following gaussian distributions of misalignment angles for each of the four active regions \"    _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _",
    "@xmath174 for @xmath156 ( 2007 april 30 ; fig .",
    "6 ) , + @xmath175 for @xmath124 ( 2007 may 9 ; fig .  7 ) , + @xmath176 for @xmath162 ( 2007 may 19 ; fig .  8) , + @xmath177 for @xmath163 ( 2007 dec 11 ; fig .",
    "9 ) , + _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _    so they have a most frequent value of @xmath178 , which matches very closely the estimated uncertainty of stereoscopic errors ( based on the parallelity of loops in near proximity ) , which was found in a similar range of @xmath179 ( aschwanden and sandman 2010 ) .",
    "* online - movies * that visualizes the forward - fitting process from the initial potential field model to the best - fit non - potential model are also included in the * online electronic supplementary material * of this paper .",
    "a comparison of our results with previous magnetic modeling of the same four active regions is compiled in table 2 .",
    "the improved misalignment statistics obtained with our code in the range of @xmath180 is about two times smaller than what was obtained with earlier nlfff models ( @xmath181 \\approx 24^\\circ-44^\\circ$ ] ; derosa et al .",
    "2009 ) , and also about two times smaller than potential field models , i.e. , with potential source surface models ( pfss : @xmath182 , sandman et al .",
    "2009 ) , with potential field models with unipolar charges ( @xmath183 , aschwanden and sandman  2009 ) , also measured with our new code described in this paper ( @xmath184 ) .",
    "thus , we find that our non - potential ( force - free ) field model clearly yields a better matching model than any previous potential or non - potential field model .",
    "the mean value of the misalignment angle @xmath185 in an active region depends also on the number @xmath34 of magnetic charges that have been used in the model , which is shown in fig .",
    "10 ( right panels ) .",
    "we repeated the forward - fitting for @xmath186 magnetic charges and find that the mean misalignment angle @xmath187 generally improves ( or decreases ) with the number of magnetic components , up to @xmath188 , while for larger numbers ( i.e. , @xmath144 ) a diminuishing effect sets in ( probably due to less efficient convergence in forward - fitting with a too large number of variables ) .",
    "we show the dependence of the mean misalignment angle @xmath187 for both the potential field model ( p ) and the force - free field non - potential model ( np ) in fig .",
    "10 ( right panels ) , which reveal interesting characteristics how potential - like an active region is .",
    "clearly , active region b ( 2007 may 9 ) is the most potential one , while active region c ( 2007 may 19 ) is the most non - potential one , where a potential field model does not fit at all , regardless how many magnetic components are used .",
    "a similar result was also obtained in the study of aschwanden and sandman ( 2010 ) , where the potential - like active region b was associated with the lowest goes - class level ( a7 ) , while the most non - potential - like region c was exhibiting a goes - class c0 flare .",
    "maps of the magnetic field components @xmath190 , @xmath191 , and @xmath17 obtained from the decomposition of line - of - sight magnetograms into 100 buried magnetic charges are shown for one ( i.e. , region a of 2007 apr 30 ) of the four analyzed active regions in fig .  11 .",
    "note that only the line - of - sight component map @xmath17 is directly observed ( with soho / mdi ) , as shown in the bottom right panel in fig .  11 , while the other two component maps @xmath190 and @xmath191 are inferred from the spherical symmetry of the magnetic field of point charges assumed for a potential field ( eq .  1 ) .",
    "these inferred field components define our potential field solution @xmath192 .",
    "our non - potential field model adds additional azimuthal field components @xmath193 that are only constrained by fitting the stereoscopically triangulated loops .",
    "we show the difference between the non - potential and potential field components for the photospheric level in the middle column of fig .  11 .",
    "we notice that the difference between the non - potential and potential solution is essentially contained in the transverse field components @xmath190 and @xmath191 , because the line - of - sight component @xmath17 is an observed quantity and has to be matched by any model .",
    "the difference maps shown in fig .",
    "11 confirm that our model retrieves the non - potential field mostly from the transverse field components that are not measured with a line - of - sight magnetogram .",
    "from our model we can also derive a photospheric force - free @xmath194 map ( top right panel in fig .",
    "11 ) and a photospheric electric current density map @xmath195 ( middle right panel in fig .  11 ) , based on eq .  22 . the magnetograms and inferred current maps are shown for active region ( a ) in fig .  11 , and for the other active regions ( b ) , ( c ) , and ( d ) in fig .  12 .",
    "these inferred maps reveal that the locations of significant electric currents are located in strong field regions , and exhibit as much small - scale fine structure as the magnetic field line - of - sight component @xmath17 .",
    "statistics of obtained parameters of our non - potential field model is shown in form of histogrammed distributions in fig .",
    "13 , lumped together from all 454 stereoscopically triangulated loops of our four analyzed active regions .",
    "the histograms are shown in lin - lin ( fig .",
    "13 left ) as well as in log - log representation ( fig .",
    "13 right ) and can be characterized by powerlaw distributions .",
    "the median values are : @xmath196 mm for the length of the extrapolated field lines that were extrapolated through the midpoint of the observed loops , @xmath5 for the number of twisted turns along the extrapolated full loop lengths ; @xmath197 @xmath8 for the force - free @xmath6-parameter , and @xmath198 mx @xmath10 s@xmath11 for the electric current density .",
    "the statistics of misalignment angles is given in fig .",
    "10 and table 2 .      in order to test the accuracy of our analytical force - free model , which represents an approximation to a truly force - free field with an accuracy to second order ( in @xmath6 ) , it is useful to calculate some figures of merit .",
    "the divergence - freeness @xmath199 can be compared with the field gradient @xmath200 over a pixel length @xmath201 , @xmath202 similarly , the force - freeness can be quantified by the ratio of the lorentz force , @xmath203 to the normalization constant @xmath204 , @xmath205 where @xmath206 .",
    "these quantities , integrated over a computational box that covers the field - of - views of an active region and extends over a height ragne of @xmath207 solar radii , were found to be for the four active regions a , b , c , and d :    _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \\(a ) @xmath208 and @xmath209 + ( b ) @xmath210 and @xmath211 + ( c ) @xmath212 and @xmath213 + ( d ) @xmath214 and @xmath215 + _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _    in comparison , figure of @xmath216 and @xmath217 were found for simulated cases ( aschwanden and malanushenko 2012 ) , and @xmath218 and @xmath219 for forward - fitting to the low and lou ( 1990 ) model , which is an analytical exact force - free solution ( aschwanden and malanushenko 2012 ) .",
    "our values do not exceed figures of merits quoted from other nlfff codes , i.e. , @xmath220 and @xmath221 ( schrijver et al .",
    "2006 ; table iii therein ) .",
    "for sake of convenience we evaluated these figures of merit in a rectangular box tangential to the solar disk at disk center , extending over a height range of @xmath222 , which covers the strong field regions only for active regions near disk center .",
    "of course , the widely used definition of divergence - freeness ( eq .  23 ) and force - freeness ( eq .  24 ) is proportional to the square of the normalization length scale @xmath68 , i.e. , @xmath223 and @xmath224 , and thus would yield larger values for typical loop lengths or box sizes @xmath225 .",
    "as a first step we derived a potential field model of an active region .",
    "the knowledge of the potential field is a useful starting point for reconstructing a non - potential field model . in the asymptotic limit of small currents ,",
    "i.e. , for small values of the force - free parameter ( @xmath226 ) , the force - free field solution automatically converges to the potential field solution .",
    "furthermore , since our analytical force - free field approximation is accurate to second order ( in @xmath6 ) , the highest accuracy is warranted for a small non - potentiality , say up to one full turn of twist along a loop length .",
    "the fact that we measured small twists with a statistical median of @xmath227 for the four analyzed active regions , justifies the neglect of second- and higher - order terms in our analytical approximation .",
    "generally , vector magnetograph data are required to uniquely define the complete 3d magnetic field @xmath21 at the photospheric boundary . in constrast , potential - field codes can extrapolate a unique 3d field solution from a single b - component only , i.e. , from the line - of - sight component @xmath228 .",
    "consequently , in our method of superimposed fields from buried magnetic charges , the potential field solution is unique in every point of space , as well as at the boundaries ( neglecting exterior magnetic charges ) .",
    "the potential - field solution fixes also the line - of - sight component of the non - potential solution , @xmath229 , because this component is a direct observable that must be matched with every model , and thus is identical for both the potential and the non - potential model , while the transverse components represent the only free parameters for a non - potential solution , i.e. , @xmath230 and @xmath231 .    in this study we derived an algorithm that accurately calculates a potential magnetic field by properly including the curvature of the solar surface and for locations away from the solar disk center .",
    "we are not aware that such a potential - field code , defined in terms of buried unipolar magnetic charges and deconvolved from an observed magnetogram ( aschwanden and sandman 2010 ) , has been developed elsewhere , although similar parameterizations have been used in _",
    "magnetic charge topology ( mct ) _ models ( e.g. , longcope 2005 ) .",
    "it would be interesting to compare its performance with other potential field codes , such as with the green s function method ( sakurai 1982 ) , the eigenfunction expansion method ( altschuler and newkirk 1968 ) , or the potential field source surface ( pfss ) code ( e.g. , luhmann et al .",
    "our magnetic charge decomposition method is related to the green s function method , but differs in the discretization of discrete magnetic elements of various strengths and variable location , while the green s method uses a regular surface grid .",
    "magnetic elements with sub - pixel size represent no particular problem ( except that no more than one element can be resolved per pixel ) , because our method fits their radial field above the photosphere , but treats them as point charges below the photosphere . however , the resolution of our method is somehow limited by the depth of the point charges ( which introduces finite numerical errors in the calcuation of @xmath232 and @xmath233 ) , as well as by the number of point charges ( which represent a sensitivity threshold for weak magnetic field sources ) .",
    "thus , smaller grid pixel sizes and larger number of magnetic field charges can enhance the accuracy of the solutions , but are more demanding regarding computation times .",
    "similarly , the resolution of the green s function method is limited by the grid size , which is either given by the measurements , or limited by computation ressources .",
    "models of twisted flux tubes have been applied abundantly in solar physics , e.g. , to braiding of coronal loops ( berger 1991 ) , to prominences ( priest et al .",
    "1989 , 1996 ) , to sigmoid - shaped filaments ( rust and kumar 1996 ; pevtsov et al .",
    "1997 ) , to emerging current - carrying flux tubes ( leka et al .  1996 ; longcope and welsch 2000 ) , or to turbulent coronal heating ( inverarity and priest 1995 ) .",
    "magnetic structures are believed to be twisted and current - carrying before they emerge at the solar surface ( leka et al .",
    "1996 ) , many active region loops are observed to have a visible twist ( see section 6.2.4 in aschwanden 2004 ) , and filaments or prominences become unstable and erupt once their twist exceeds a critical angle of a few full turns due to the kink instability or torus instability ( fan and gibson 2003 , 2004 ; trk and kliem 2003 ; kliem et al .",
    "the twist of a magnetic structure is therefore an important indicator for its stability or transition to an instability , followed by the dynamic evolution that leads to eruptive flares and coronal mass ejections ( cme ) .",
    "our method allows us to determine the number of twisting turns of most stereoscopically triangulated coronal loops directly , and thus provides a reliable diagnostics on its stability and the amount of electric current the loop carries .",
    "the statistics in fig .",
    "13 shows that the number of twisting turns has a range up to @xmath234 ( fig .",
    "13 ) , which is far below the critical limit of @xmath235 full turns required for the onset of the kink instability in a force - free magnetic field ( mikic et al .",
    "1990 ; trk and kliem 2003 ) .",
    "the amount of twisting clearly varies among different active regions .",
    "the improvement in the misalignment angle between a potential and a non - potential model characterizes the potentiality and free energy of an active region .",
    "the most potential active region is b ( 2007 may 9 ) , where we achieve only a slight improvement of @xmath236 ( table 2 , for the gaussian peak of the distribution ) .",
    "also active region d ( 2007-dec-11 ) is moderately potential , where we find @xmath237 .",
    "significant non - potentiality is found for active region a ( 2007-apr-30 ) , where the improvement amounts to @xmath238 .",
    "the strongest non - potentiality is found for active region c ( 2007-may-19 ) , where we achieve an improvement of @xmath239 .",
    "therefore , the misalignments reduce by an amount of @xmath240 for these four active regions . during the time of observations , active region",
    "c indeed featured a goes - class c0 flare , which explains its non - potentiality .",
    "the remaining amount of misalignment , in the order of @xmath241 is attributed partly to stereoscopic measurement errors , which were estimated to @xmath242 , and partly to our particular parameterization of a force - free field model , which is optimally designed for vertically twisted structures .      for the force - free @xmath6 parameter",
    "we find a distribution extended over the range of @xmath243 @xmath8 ( fig .",
    "13 ) , with a median of @xmath7 @xmath8 . using a sheared arcade model , where the force - free @xmath6 parameter is defined as @xmath244 ( with @xmath68 the length of the loops ) , a range of @xmath245 @xmath8 was found for the same dataset , based on the residual misalignment of @xmath246 attributed to non - potentiality ( table 4 in sandman and aschwanden 2011 ) .",
    "modeling of stereoscopically triangulated loops with a linear force - free model yielded also a similar range of @xmath247 @xmath8 ( feng et al .",
    "thus , the range of our determined @xmath6 parameters agrees well with these three studies .",
    "the current densities have been determined in a range of @xmath248 mx @xmath10 s@xmath11 , with a median of @xmath249 mx @xmath10 s@xmath11 ( fig .",
    "13 ) , for spatial locations with @xmath250 g at the photospheric level . for comparison , leka et al .",
    "( 1996 ) determined similar currents of @xmath251 mx @xmath10 s@xmath11 ( i.e. , @xmath252 ma m@xmath253 , see table 3 in leka et al .",
    "1996 ) , using vector magnetograph data at the mees solar observatory measured in emerging bipoles in active regions . in principle",
    ", the knowledge of the magnitude of the electric current density @xmath39 allows one to estimate the amount of joule dissipation , @xmath254 where @xmath255 s@xmath11 is the classical conductivity for a @xmath256 mk hot corona . our measured maximum current density of @xmath257 mx @xmath10 s@xmath11 yields then a value of @xmath258 erg @xmath259 s@xmath11 for the volumetric heating rate .",
    "the corresponding poynting flux @xmath260 for a field line with a density scale height of @xmath261 cm ( corresponding to the thermal scale height at a temperature of @xmath262 mk ) , is @xmath263 which yields @xmath264 erg @xmath10 s@xmath11 , which is far below the heating requirement for active regions ( @xmath265 erg @xmath10 s@xmath11 ; withbroe and noyes 1977 ) .",
    "thus , joule dissipation is far insufficient to heat coronal loops in active regions , according to our current measurements .",
    "obviously , more energetic processes , such as magnetic reconnection with anomalous resistivity in excess of classical conductivity is needed .",
    "nevertheless , our technique of measuring current densities from the twist of observed loops may provide a useful diagnostic where currents are generated in active regions , e.g. , near neutral lines with large gradients in the magnetic field , or in areas with large photospheric shear that produces magnetic stressing .",
    "modeling of the magnetic field with a non - potential model matches the observed loop geometries about a factor of two better than potential field models , as demonstrated in this study ( table 2 ) .",
    "while our attempt of forward - fitting of twisted fields to stereoscopically triangulated loops represents only a first step in this difficult problem of data - constrained non - potential field modeling , we expect that future non - potential models with similar parameterizations will be developed , which yield the 3d magnetic field with high accuracy , satisfying maxwell s equations of divergence - freeness and force - freeness .",
    "there are a number of benefits that will result from the knowledge of a realistic 3d magnetic field , of which we just mention a few :    1 .",
    "the spatial distribution of coronal dc current heating can be inferred from localizations of non - potential field lines with a high degree of twist and current density ( e.g. , bobra et al .  2008 ; derosa et al .  2009 ; su et al .",
    "the free ( non - potential ) energy @xmath266 can be determined from the difference of the non - potential ( @xmath267 ) and potential ( @xmath268 ) energy in a loop .",
    "correlations between the free energy @xmath269 and the soft x - ray brightness @xmath270 can quantify the volumetric heating rate @xmath271 and pointing flux @xmath260 in loops and active regions , and be related to the flare productivity ( e.g. , jing et al .",
    "2010 ; aschwanden and sandman 2010 ) .",
    "4 .   the helicity and its evolution can be traced in twisted coronal loops , which can be used to diagnose whether helicity injection from below the photosphere takes place ( e.g. , malanushenko 2011b ) .",
    "hydrodynamic modeling of coronal loops , which is mostly done in a one - dimensional coordinate @xmath272 along the loop , requires the knowledge of the 3d geometry @xmath109 $ ] , which otherwise can only be obtained from stereoscopy .",
    "the inclination of the loop plane determines the ratio of the observed scale height to the effective thermal scale height , and thus the inferred temperature profile @xmath273 .",
    "also the inference of the electron density @xmath274 along the loop depends on the column depth of the line - of - sight integration ( e.g. , aschwanden et al .",
    "most loop scaling laws depend explicitly on the loop length @xmath68 ( e.g. , the rosner - tucker - vaiana law , rosner et al .  1978 ) , which can only be reliably determined from magnetic models .",
    "electron time - of - flight measurements require the trajectory of electrons that stream along field lines from coronal acceleration sources to the photospheric footpoints .",
    "the location of the coronal acceleration can be determined from the observed energy - dependent time delays in hard x - rays and the knowledge of the pitch angle of the electron and the magnetic twist of the field line , which can only be obtained from magnetic models ( e.g. , aschwanden et al .",
    "1996 ) . 7 .",
    "modeling of entire active regions require models of the 3d magnetic field , the temperature @xmath273 , and density @xmath274 , using hydrostatic or hydrodynamic loop models , which can reveal scaling laws between the volumetric heating rate @xmath271 , hydrodynamic loop parameters ( @xmath275 ) , and magnetic parameters ( @xmath124 ) , ( e.g. , schrijver et al .  2004 ; warren & winebarger 2006 , 2007 ; warren et al .  2010 ; lundquist et al .  2008a , b ) .",
    "nonlinear force - free modeling of active regions and global coronal fields can establish better lower boundary conditions for modeling of the heliospheric field ( e.g. , petrie et al .",
    "there are two classes of coronal magnetic field models , potential fields and non - potential fields , which both so far do not fit the observed 3d geometry of coronal loops well .",
    "nonlinear force - free fields ( nlfff ) are found to match the data generally better than linear force - free fields ( lfff ) .",
    "the 3d geometry of coronal loops is most reliably determined by stereoscopic triangulation , as it is now available from the twin stereo / a and b spacecraft , and we made use of a sample of some 500 loops observed in four active regions during the first year of the stereo mission ( with spacecraft separation angles in the range of @xmath276 ) . we forward - fitted a force - free approximation to the entire ensemble of stereoscopically triangulated loops in four active regions and obtained the following results and conclusions :    1 .",
    "a line - of - sight magnetogram that measures the longitudinal magnetic field component @xmath17 can be decomposed into @xmath188 unipolar magnetic charges , from which maps of all three magnetic field components @xmath190 , @xmath191 , and @xmath17 can be reconstructed at the solar surface with an accuracy of @xmath150 .",
    "this boundary condition allows us to compute a 3d potential field model @xmath277 in a 3d cube encompassing an active region , by superimposing the potential fields of each buried magnetic charge .",
    "our algorithm takes the curvature of the solar surface into account and is accurate up to about a half solar radius away from disk center .",
    "2 .   forward - fitting of the twisted flux tube model to 70 - 200 loops per active region",
    "improves the median 3d misalignment angle between the theoretical field lines and the observed stereoscopically triangulated loops from @xmath0 for a potential field model to @xmath1 for the non - potential field model , which corresponds to a reduction of @xmath278 .",
    "the residual misalignment is commensurable with the estimated stereoscopic measurement error of @xmath279 .",
    "3 .   the application of our stereoscopy - constrained model allows us to obtain maps of the non - potential magnetic field components , @xmath280 , the force - free @xmath6-parameter @xmath194 , and the current density @xmath195 at the photospheric level or in an arbitrary 3d computation box .",
    "the divergence - freeness and force - freeness , numerically evaluated over a 3d computation box , was found to be reasonable well fulfilled .",
    "4 .   the statistics of parameters obtained from forward - fitting of our force - free model yields the following values : field line lengths @xmath4 mm ( median 163 mm ) , number of twist turns @xmath281 ( median @xmath5 ) , nonlinear force - free @xmath6-parameter @xmath282 @xmath8 ( median @xmath7 @xmath8 ) , and current density @xmath283 mx @xmath10 s@xmath11 ( median @xmath284 mx @xmath10 s@xmath11 ) .",
    "all twisted loops are found to be far below the critical value for kink instability ( @xmath285 turns ) and joule dissipation of their currents ( with a median poynting flux of @xmath264 erg @xmath10 s@xmath11 ) is found be be far below the coronal heating requirement ( @xmath265 erg @xmath10 s@xmath11 ) .",
    "where do we go from here ? the two algorithms developed here provide an efficient tool to quickly compute a potential field and a quasi - force - free solution of an active region , yielding also accurate measurements of geometric ( helically twisted ) loop parameters ( full length of field line , number of twist turns ) , based on the constraints of stereoscopically triangulated loops .",
    "our approach of forward - fitting a magnetic field model to coronal structures has also the crucial advantage to bypass the non - force - free zones in the lower chromosphere , which plague standard nlfff extrapolation algorithms .",
    "a next desirable project would be to generalize the non - potential field forward - fitting algorithm to 2d projections @xmath286 $ ] of 3d loop coordinates @xmath109 $ ] ( as they are obtained from stereoscopic triangulation ) , so that the model works for a single line - of - sight magnetogram combined with a suitable single - spacecraft euv image , without requiring stereoscopy .",
    "the stereoscopic 3d loop measurements ( used here ) as well as 3d vector magnetograph data ( once available from hmi / sdo ) , however , represent important test data to validate any of these non - potential field models .",
    "a 3d parameterization of a line - of - sight magnetogram @xmath17 can be obtained by a superposition of buried magnetic point charges , which produce a surface magnetic field @xmath287 that is constrained by the observed magnetogram , as defined in section 2.1 . here",
    "we describe the geometric inversion of the 3d coordinates @xmath288 and surface field strength @xmath289 of a single magnetic point charge @xmath290 that produces a local peak @xmath53 with width @xmath54 at an observed position @xmath52 ( fig .",
    "14 , left ) .",
    "the geometric relationships can be derived most simply in a plane that intersects the point souce @xmath291 and the line - of - sight axis . in the plane - of - sky",
    "we define a coordinate axis @xmath63 that is orthogonal to the line - of - sight axis @xmath31 and is rotated by an angle @xmath292 with respect to the @xmath293-axis , so that we have the transformation , @xmath294 thus we have the four observables @xmath295 and want to derive the model parameters @xmath296 . in fig .",
    "14 ( right hand side ) we show the geometric definitions of the depth @xmath297 of the magnetic charge ( the radial distance between @xmath290 and the surface ) , the distance @xmath298 between the magnetic charge @xmath290 and the surface field at an observed position @xmath291 , which is inclined by an angle @xmath299 to the vertical direction above the magnetic charge @xmath290 , so we have the relation , @xmath300 the line - of - sight component @xmath53 at point @xmath291 has an angle @xmath301 to the radial direction @xmath302 with field strength @xmath303 ( eq .  1 ) , and thus obeys the following dependence on the aspect angle @xmath6 and inclination angle @xmath299 ( with a2 ) , @xmath304 the radial coordinate @xmath305 is related to the radial coordinate @xmath306 of the magnetic charge by , @xmath307 further we have the geometric relationships for the aspect angle @xmath6 , the 3d distance @xmath308 from sun center , and the depth @xmath297 , @xmath309 the observed line - of - sight component @xmath53 has a dependence on the inclination angle @xmath299 ( eq .",
    "a3 ) , and thus we need to compute the optimum angle @xmath310 where the component @xmath53 has a maximum , because we can only measure the locations of local peaks in magnetograms @xmath17 .",
    "we obtain this optimum angle @xmath310 by calculating the derivative @xmath311 from eq .",
    "( a3 ) and setting the derivative to zero at the local maximum , i.e. , @xmath312 at @xmath313 , which yields a quadratic equation for @xmath314 that has the analytical solution , @xmath315 for the special case of a source at disk center ( @xmath316 ) this optimum angle is @xmath317 , but increases monotonically with the radial distance from disk center and reaches a maximum value of @xmath318 at the limb ( @xmath319 ) .",
    "further we need to quantify the half width @xmath54 of the radial magnetic field profile @xmath320 across a local peak , which is also one of the observables .",
    "a simple way is to approximate the magnetic field profile @xmath321 with a gaussian function , which drops to the half value @xmath322 at an angle @xmath323 , @xmath324 inserting the function @xmath325 ( eq .  a3 ) yields then the following relationship for the half width @xmath326 , @xmath327 \\ .",
    "\\eqno(a8)\\ ] ] for the special case at disk center @xmath328 , the solution is @xmath329 , and @xmath330 is related to @xmath310 by @xmath331 a general analytical solution is not possible , but numerical inversions of eq .  (",
    "a3 ) give the following very close approximation , @xmath332    we have now all geometric relationships to invert the theoretical parameters @xmath296 from the observables @xmath333 .",
    "an explicit derivation of the theoretical parameters is not feasible , but an efficient way is to start with an approximate value for the aspect angle , since @xmath334 , followed by a few iterations to obtain the accurate value .",
    "the inversion can be done in the following order ( using eqs .",
    "a1-a10 ) , @xmath335 } \\\\      b_m      & = { b_z / [ \\cos^2{\\beta_p } \\",
    "\\cos{(\\alpha-\\beta_p ) } ] } \\\\",
    "\\beta_2 & = \\arccos{\\left [           \\left ( ( \\cos{\\beta_p})^3 / 2 \\right)^{1/3 } \\right ] } \\\\      d_m      & = { w / \\left [ \\tan{\\beta_2}\\ \\cos{\\alpha } \\ ( 1 - 0.1\\alpha )           \\right ] } \\\\",
    "r_m & = ( 1-d_m )    \\\\      \\rho_m   & = \\rho_p - d_m { \\sin{(\\alpha-\\beta_p ) } /          \\cos{\\beta_p } } \\\\      z_m      & = \\sqrt{r_m^2-\\rho_m^2 } \\\\",
    "x_m & = \\rho_m \\ \\cos{\\gamma } \\\\",
    "y_m & = \\rho_m \\ \\sin{\\gamma } \\\\      \\end{array }      \\eqno(a11)\\ ] ] in our algorithm we iteratively determine the local peaks of the line - of - sight components @xmath17 and their widths @xmath54 , which are found to be close to gaussian 2d distribution functions , and invert the model parameters @xmath296 with the inversion procedure given in eq .",
    "( a11 ) .",
    "we thank the anonymous referee and allen gary for constructive and helpful comments .",
    "this work is supported by the nasa stereo under nrl contract n00173 - 02-c-2035 .",
    "the stereo/ secchi data used here are produced by an international consortium of the naval research laboratory ( usa ) , lockheed martin solar and astrophysics lab ( usa ) , nasa goddard space flight center ( usa ) , rutherford appleton laboratory ( uk ) , university of birmingham ( uk ) , max - planck - institut fr sonnensystemforschung ( germany ) , centre spatiale de lige ( belgium ) , institut doptique thorique et applique ( france ) , institute dastrophysique spatiale ( france ) .",
    "the usa institutions were funded by nasa ; the uk institutions by the science & technology facility council ( which used to be the particle physics and astronomy research council , pparc ) ; the german institutions by deutsches zentrum fr luft- und raumfahrt e.v .",
    "( dlr ) ; the belgian institutions by belgian science policy office ; the french institutions by centre national detudes spatiales ( cnes ) , and the centre national de la recherche scientifique ( cnrs ) . the nrl effort was also supported by the usaf space test program and the office of naval research .",
    "altschuler , m.d . and newkirk , g.jr .",
    "1969 , 9 , 131 .",
    "aschwanden , m.j . ,",
    "kosugi , t. , hudson , h.s . ,",
    "wills , m.j . , and schwartz , r.a .",
    "1996 , 470 , 1198 .",
    "aschwanden , m.j .",
    ", newmark , j.s . , delaboudiniere , j.p . ,",
    "neupert , w.m . ,",
    "klimchuk , j.a . ,",
    "gary , g.a .",
    ", portier - fornazzi , f. , and zucker , a. , 1999 , 515 , 842 .",
    "aschwanden , m.j .",
    "2004 , _ physics of the solar corona .",
    "an introduction _ , praxis publishing co. , chichester uk , and springer , berlin .",
    "aschwanden , m.j . ,",
    "lee , j.k . ,",
    "gary , g.a . ,",
    "smith , m . , and inhester , b .",
    "2008a , 248 , 359 .",
    "aschwanden , m.j . ,",
    "wuelser , j.p . ,",
    "nitta , n.v .",
    ", & lemen , j.r .",
    "2008b , apj 679 , 827 ( paper i ) .",
    "aschwanden , m.j . ,",
    "nitta , n.v . ,",
    "wuelser , j.p .",
    ", & lemen , j.r .",
    "2008c , apj 680 , 1477 ( paper ii ) .",
    "aschwanden , m.j .",
    ", wuelser , j.p . , nitta , n. , lemen , j. , and sandman , a. 2009 , 695 , 12 ( paper iii ) .",
    "aschwanden , m.j .",
    "2010 , 262 , 399 .",
    "aschwanden , m.j . and",
    "sandman , a.w .",
    "2010 , astronomical j. 140 , 723 .",
    "aschwanden , m.j .",
    "2011 , living reviews in solar physics 8 , 5 .",
    "aschwanden , m.j .",
    "2012 , ( in press ) , + http://www.lmsal.com/@xmath336aschwand/eprints/2012@xmath337fff1.pdf aschwanden , m.j . and malanushenko , a. 2012 , ( in press ) , + http://www.lmsal.com/@xmath336aschwand/eprints/2012@xmath337fff2.pdf .",
    "berger , m.a .",
    "1991 , 252 , 369 .",
    "bobra , m.g . ,",
    "van ballegooijen , a.a . , and deluca , e.e .",
    "2008 , 672 , 1209 .",
    "boyd , t.j.m . and",
    "sanderson , j.j .",
    "2003 , _ the physics of plasmas _ , cambridge university press , cambridge .",
    "conlon , p.a . and",
    "gallagher , p.t .",
    "2010 , 715 , 59 .",
    "derosa , m.l . ,",
    "schrijver , c.j . ,",
    "barnes , g. , leka , k.d . , lites , b.w . , aschwanden , m.j . ,",
    "amari , t. , canou , a. , mctiernan , j.m .",
    ", regnier , s. , thalmann , j. , valori , g. , wheatland , m.s . , wiegelmann , t. , cheung , m.c.m . ,",
    "conlon , p.a . ,",
    "fuhrmann , m. , inhester , b. , and tadesse , t. 2009 , 696 , 1780 .",
    "fan , y. and gibson , s.e .",
    "2003 , 589 , l105 .",
    "fan , y. and gibson , s.e . 2004 , 609 , 1123 .",
    "feng , l. , wiegelmann , t. , inhester , b. , solanki , s. , gan , w.q . , and ruan , p. 2007a",
    ", 241 , 235 .",
    "feng , l. , inhester , b. , solanki , s. , wiegelmann , t. , podlipnik , b. , howard , r.s . ,",
    "wuelser , j.p .",
    "2007b , apj 671 , l205 gold , t. and hoyle , f. 1958 , mnras 120 , 89 .",
    "inhester , b. , feng , l. , and wiegelmann , t. 2008 , 248 , 379 .",
    "inverarity , g.w . and priest , e.r .",
    "1995 , 296 , 395 .",
    "jing , j. , tan , c. , yuan , y. , wang , b. , wiegelmann , t. , xu , y. , wang , h. 2010 , 713 , 440 .",
    "kaiser , m.l .",
    ", kucera , t.a . ,",
    "davila , j.m .",
    ", st.cyr , o.c . ,",
    "guhathakurta , m . , and christian , e. 2008 , space science reviews 136 , 5 .",
    "kliem , b. , titov , v.s . , and trk , t. 2004 , 413 , l23 .",
    "leka , k.d . ,",
    "canfield , r.c . , and mcclymont , a.n .",
    "1996 , 462 , 547 .",
    "longcope , d.w . , fisher , g.h . , and pevtsov , a.a .",
    "1998 , 507 , 417 .",
    "longcope , d.w . and welsch , b.t .",
    "2000 , 545 , 1089 .",
    "longcope , d.w .",
    "2005 , living reviews in solar physics 2 , 7 . low , b.c . and lou , y.q . 1990 , , 343 .",
    "luhmann , j.g . ,",
    "gosling , j.t . ,",
    "hoeksema , j.t . , and zhao , x. 1998 , 103(a4 ) , 6585 .",
    "lundquist , l.l .",
    ", fisher , g.h .",
    ", & mctiernan , j.m .",
    "2008a , apjs 179 , 509 .",
    "lundquist , l.l .",
    ", fisher , g.h . , & mctiernan , j.m .",
    "2008b , apj 689 , 1388 .",
    "malanushenko , a. , longcope , d.w .",
    ", and mckenzi , d.e .",
    "2009 , 707 , 1044 .",
    "malanushenko , a. , longcope , d.w . , and mckenzi , d.e .",
    "2009 , 707 , 1044 .",
    "malanushenko , a. , schrijver , c.j .",
    ", derosa , m.l . ,",
    "wheatland , m.s . , and gilchrist , s.a . , ( in press ) .",
    "mikic , z. , schnack , d.d . , and vanhoven , g .",
    "1990 , 361 , 690 .",
    "parker , e.n .",
    "1988 , 330 , 474 .",
    "petrie , g.j.d . ,",
    "canou , a. , and amari , t. 2011 , ( in press ) .",
    "pevtsov , a.a . ,",
    "canfield , r.c .",
    ", and mcclymont , a.n .",
    "1997 , 481 , 973 .",
    "portier - fozzani , f. , aschwanden , m.j . , demoulin , p. , neupert , w. , and eit team 2001 , 203 , 289 . press , w.h . ,",
    "flannery , b.p .",
    ", teukolsky , s.a . , and vetterling , w.t . 1986 , _ numerical recipes .",
    "the art of scientific computing _",
    ", cambridge university press : new york .",
    "priest , e.r .",
    "1982 , _ solar magnetohyrdodynamics _",
    ", geophysics and astrophysics monographs volume 21 , d. reidel publishing company , dordrecht .",
    "priest , e.r . , hood , a.w . , and anzer , u. 1989 , 344 , 1010 .",
    "priest , e.r . , van ballegooijen , a.a . , and mackay , d.h .",
    "1996 , 460 , 530 .",
    "rosner , r. , tucker , w.h .",
    ", and vaiana , g.s .",
    "1978 , 220 , 643 .",
    "ruan , p. , wiegelmann , t. , inhester , b. , neukirch , t. , solanki , s.k . , and feng , l. 2008 , 481 , 827 .",
    "rust , d.m . and kumar , a. 1996 , 464 , l199 .",
    "sakurai , t. 1982 , 76 , 301 .",
    "sandman , a. , aschwanden , m.j . ,",
    "derosa , m. , wuelser , j.p . and alexander , d. 2009 , 259 , 1 .",
    "sandman , a.w . and aschwanden , m.j . 2011 , 270 , 503 .",
    "schrijver , c.j . ,",
    "sandman , a.w . ,",
    "aschwanden , m.j . , and derosa , m.l .",
    "2004 , 615 , 512 .",
    "schrijver , c.j .",
    ", derosa , m. , metcalf , t.r . ,",
    "liu , y. , mctiernan , j. , regnier , s. , valori , g. , wheatland , m.s . , and wiegelmann , t. 2006 , 235 , 161 .",
    "sturrock , p.a .",
    "199i4 , _ plasma physics .",
    "an introduction to the theory of astrophysica , geophysical and laboratory plasmas _ , cambridge university press , cambridge .",
    "su , y.n . , surges , v. , vanballegooijen , a.a . , deluca , e. , and golub , l .",
    "2011 , 734 , 53 .",
    "trk , t. , and kliem , b. 2003 , 406 , 1043 .",
    "warren , h.p . and",
    "winebarger , a.r .",
    "2006 , apj 645 , 711 .",
    "warren , h.p . and",
    "winebarger , a.r .",
    "2007 , apj 666 , 1245 .",
    "warren , h.p . ,",
    "winebarger , a.r . , and brooks , d.h .",
    "2010 , 711 , 228 .",
    "wiegelmann , t. and neukirch , t. 2002 , 208 , 233 .",
    "wiegelmann , t. and inhester , b. 2003 , 214 , 287 .",
    "wiegelmann , t. , lagg , a. , solanki , s.k . ,",
    "inhester , b. , and woch , j. 2005 433 , 701 .",
    "wiegelmann , t. and inhester , b. 2006 , 236 , 25 .",
    "wiegelmann , t. , inhester , b. , and feng , l. 2009 , annales geophysicae 27/7 , 2925 .",
    "withbroe , g.l .",
    "and noyes , r.w .",
    "1977 , ann .",
    "15 , 363 .",
    "llllrrcc a & 10953 ( s05e20 ) & 2007-apr-30 & 23:00 - 23:20 & 6.0@xmath338 & 200 & [ -3134,+1425 ] & 8.7 + b & 10955 ( s09e24 ) & 2007-may-9 & 20:30 - 20:50 & 7.1@xmath338 & 70 & [ -2396,+1926 ] & 1.6 + c & 10953 ( n03w03 ) & 2007-may-19 & 12:40 - 13:00 & 8.6@xmath338 & 100 & [ -2056,+2307 ] & 4.0 + d & 10978 ( s09e06 ) & 2007-dec-11 & 16:30 - 16:50 & 42.7@xmath338 & 87 & [ -2270,+2037 ] & 4.8 +    lllll misalignment nlfff@xmath339 & @xmath340 & & & + misalignment pfss@xmath341 & @xmath342 & @xmath343 & @xmath344 & @xmath345 + potential field@xmath346 & @xmath347 & @xmath348 & @xmath349 & @xmath350 + force - free field@xmath351 & @xmath352 & @xmath353 & @xmath354 & @xmath355 + stereoscopy error se@xmath356&@xmath357 & @xmath358 & @xmath359 & @xmath357 +"
  ],
  "abstract_text": [
    "<S> the three - dimensional ( 3d ) coordinates of stereoscopically triangulated loops provide strong constraints for magnetic field models of active regions in the solar corona . here </S>",
    "<S> we use stereo / a and b data from some 500 stereoscopically triangulated loops observed in four active regions ( 2007 apr 30 , may 9 , may 19 , dec 11 ) , together with soho / mdi line - of - sight magnetograms . </S>",
    "<S> we measure the average misalignment angle between the stereoscopic loops and theoretical magnetic field models , finding a mismatch of @xmath0 for a potential field model , which is reduced to @xmath1 for a non - potential field model parameterized by twist parameters . </S>",
    "<S> the residual error is commensurable with stereoscopic measurement errors ( @xmath2 ) . </S>",
    "<S> we developed a potential field code that deconvolves a line - of - sight magnetogram into three magnetic field components @xmath3 , as well as a non - potential field forward - fitting code that determines the full length of twisted loops ( @xmath4 mm ) , the number of twist turns ( median @xmath5 ) , the nonlinear force - free @xmath6-parameter ( median @xmath7 @xmath8 ) , and the current density ( median @xmath9 mx @xmath10 s@xmath11 ) . </S>",
    "<S> all twisted loops are found to be far below the critical value for kink instability , and joule dissipation of their currents is found be be far below the coronal heating requirement . </S>",
    "<S> the algorithm developed here , based on an analytical solution of nonlinear force - free fields that is accurate to second order ( in the force - free parameter @xmath6 ) , represents the first code that enables fast forward - fitting to photospheric magnetograms and stereoscopically triangulated loops in the solar corona . </S>"
  ]
}