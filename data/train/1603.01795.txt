{
  "article_text": [
    "in the past four decades , dynamic financial time series based on nonlinear models has been a topic of interest . for financial time",
    "series , the arch and garch model , introduced by engle @xcite and bollerslev @xcite , are surely the most popular classes of volatility models .",
    "hamilton and susmel @xcite introduced markov - switching garch ( ms - garch ) by merging garch model with a hidden markov chain , where each state of the chain allows a different garch behavior .",
    "such structure exploits advantages of both , the conditional heteroscedasticity structure of garch models and the time - varying specifications of hidden markov chains which improves forecasting of volatilities .",
    "gray @xcite , klaassen @xcite and haas , et al .",
    "@xcite proposed some different variants of ms - garch models . for further studies on ms - garch models see abramson and cohen @xcite , ardia @xcite , alemohammad et .",
    "al @xcite and bauwens et al .",
    "+    one restriction of the garch model is its symmetry to the volatility of the past shocks . in other words , the dynamic of conditional variance in garch models change only with the size of square observations .",
    "this is improved by letting the conditional variance to be a function of size and sign of the lagged observations .",
    "study of such asymmetric effects started by the work of black @xcite , which studied the asymmetry of the volatility to the positive and negative shocks .",
    "this consideration is important in financial markets as there exist more volatile in response to bad news ( negative shocks ) than to good news ( positive shocks ) @xcite . the asymmetric garch model ( agarch ) which introduced by engle @xcite captures the asymmetric effects that negative shocks have more volatile than the positive ones .",
    "some of the main asymmetric garch structures which studied later on are the exponential garch ( egarch ) model by nelson @xcite , gjr - garch model by glosten , et al.@xcite and threshold garch ( tgarch ) model by zakoian @xcite which presented in econometric literatures .",
    "the other asymmetric structures are smooth transition models introduced by gonzalez - rivera @xcite , medeiros and veiga @xcite and haas et al .",
    "@xcite .    in this paper",
    ", we propose a generalization of the markov switching garch model where the volatility of each regime is coupled with the smooth transition structure . the new model obviates the absence of asymmetric property in the markov switching garch model and also the loss of transition of different levels of volatility in the smooth transition garch models . by considering different smooth transition models for states ,",
    "the model is talent to provide a more efficient structure for modeling series with wide levels of volatilities and also encompasses the different leverage of effects causes by positive and negative shocks in each regime . as such model employ all past observations , forecasting structure could increase the complexity of the model .",
    "so we reduce the volume of calculations by proposing a dynamic programming algorithm .",
    "we also derive necessary and sufficient conditions for stability and obtain an upper bound for the limit of the second moment by using the method of abramson and cohen @xcite and medeiros @xcite . for the estimation of the parameters ,",
    "the bayesian inference using gibbs and griddy gibbs sampling is considered .",
    "the organization of this paper is as follows : the markov switching smooth transition garch model is presented in section 2 .",
    "section 3 is devoted to the statistical properties of the model .",
    "estimation of the parameters of the model are studied in section 4 .",
    "section 5 is dedicated to the analysis of the efficiency of the proposed model by applying the model to the @xmath0 and swiss market index for some special periods .",
    "section 6 concludes .",
    "the markov switching smooth transition garch model , ms - stgarch , for time series @xmath1 is defined as @xmath2 where @xmath3 are iid standard normal variables , @xmath4 is an irreducible and aperiodic markov chain on finite state space @xmath5 with transition probability matrix @xmath6 where @xmath7 , and stationary probability measure @xmath8 also given that @xmath9 , @xmath10 ( the conditional variance in regime j ) is driven by @xmath11 and each of the weights ( @xmath12 ) is a logistic function of the past observation as @xmath13    which are bounded , @xmath14 , and monotonically increasing .",
    "the parameter @xmath15 is called the slope parameter . since @xmath16",
    ", the weight function @xmath14 goes to zero when @xmath17 and to one when @xmath18 .",
    "so @xmath19 in each state will characterize negative shocks and @xmath20 positive ones .",
    "it refers to the fact that negative and positive shocks have different effects on volatility .",
    "when @xmath21 , the logistic function becomes a step function .",
    "for @xmath15 tending to zero , @xmath22 goes to @xmath23 and the ms - stgarch model tends to markov switching garch model(ms - garch ) . in the case of single regime ,",
    "our model is the smooth transition garch ( stgarch ) model that is introduced by lubrano @xcite . +    it is assumed that @xmath3 and @xmath4 are independent .",
    "sufficient conditions to guarantee strictly positive conditional variance are @xmath24 to be positive and @xmath25 being nonnegative .",
    "+    let @xmath26 be the observation set up to time t. the conditional density function of @xmath27 given past information is obtained as follows : + @xmath28 in which @xmath29 ( that is obtained in the next section ) , and @xmath30 is the probability density function of the standard normal distribution .",
    "in this section , the statistical properties of the ms - stgarch model are investigated and the conditional variance of the process is obtained .",
    "we show that the model , under some conditions on coefficients and transition probabilities , is asymptotically stable in the second moment .",
    "an appropriate upper bound for the limiting value of the second moment is obtained .",
    "+      the conditional variance of ms - stgarch model is given by @xmath31 as @xmath32 is the conditional variance of i - th state .",
    "this relation shows that the conditional variance of this model is affected by changes in regime and conditional variance of each state . + as using all past observations for forecasting could increase the complexity of the model , we reduce the volume of calculations by proposing a dynamic programming algorithm . at each time @xmath33 , @xmath34 ( in equation ( [ 7 ] ) , ( [ 8 ] ) ) can be obtained from a dynamic programming method based on the forward recursion algorithm , proposed in remark ( [ 9 ] ) .",
    "see appendix a.      in this subsection , we investigate the stability of second moment of the ms - stgarch model .",
    "similar to our previous work @xcite , we are looking for an upper bound of our model for the second moment .",
    "assume m is a positive constant and let @xmath35^{\\prime},\\ ] ] be a vector with k component , @xmath36 denotes a @xmath37-by-@xmath37 block matrix as + @xmath38 with each block given by @xmath39 where @xmath40^{\\prime}$ ] , @xmath41 is a k - by-1 vector of all zeros , except its jth element , which is one , and @xmath42 is a diagonal k - by - k matrix with elements @xmath43 $ ] on its diagonal . + let @xmath44 $ ]    and consider @xmath45 denotes the spectral radius of a matrix a , then we have the following theorem for the stationarity condition of the ms - stgarch model",
    ".    let @xmath46 follows the ms - stgarch model , defined by ( [ 1])-([4 ] ) , the process is asymptotically stable in variance and @xmath47 , if @xmath48 + see appendix b.",
    "for the estimation of parameters , we apply the bayesian inference , that is extensively used in literature ( @xcite , @xcite and @xcite ) .",
    "let @xmath49 be the vector @xmath50 . in what follows , for the case of two regimes",
    ", we are going to estimate the @xmath51 and the parameter vectors @xmath52 and @xmath53 , where @xmath54 for @xmath55 from the posterior density    @xmath56    in which @xmath57 , @xmath58 and @xmath59 is the prior of the parameters .",
    "the conditional probability mass function of @xmath60 given the @xmath61 is independent of @xmath62 , so @xmath63 where @xmath64 ( the number of transitions from regime i to regime j ) . the conditional density function of @xmath65 given the realization of @xmath60 and the parameters is factorized in the following way : @xmath66 where the one step ahead predictive densities are : @xmath67",
    "since the straight sampling from the posterior density ( [ 21 ] ) is not possible , we apply the gibbs sampling algorithm with three blocks : @xmath62 , @xmath68 and @xmath60 . +",
    "a brief description of the gibbs algorithm : suppose the superscript @xmath69 on a parameter is a sample of the parameter at the r - th iteration of the algorithm . at any iteration of the algorithm , three steps will be done : + ( i ) draw the random sample of the state variable @xmath70 given @xmath71 .",
    "+ ( ii ) draw the random sample of the transition probabilities @xmath72 given @xmath70 .",
    "+ ( iii ) draw the random sample of the @xmath73 given @xmath70 and @xmath72 .",
    "+ these steps are repeated until the convergency is obtained . in",
    "what follows the sampling of each block are explained .",
    "+      this step is devoted to the sampling of @xmath75 that is performed by chib@xcite , ( see also @xcite ) .",
    "suppose @xmath76 be the stationary distribution of the chain , + @xmath77 where the predictive density @xmath78 is calculated by the relation ( [ 22 ] ) and by the law of total probability @xmath79 is given by : + @xmath80    given the filter probabilities ( @xmath75 ) , we run a backward algorithm , starting from @xmath81 that @xmath82 is derived from @xmath83 .",
    "for @xmath84 the sample is derived from @xmath85,which is obtained by @xmath86 to derive @xmath74 from @xmath87 is by sampling from the conditional probabilities @xmath88 which are given by @xmath89 after generating a uniform ( 0,1 ) number @xmath90 , if @xmath91 then @xmath92 , otherwise increase @xmath93 to @xmath94 and generate another uniform ( 0,1 ) and compare it by @xmath95 .",
    "this stage is devoted to sample @xmath52 from the posterior probability @xmath96 that is independent of @xmath97 .",
    "we consider independent beta prior density for each of @xmath98 and @xmath99 .",
    "for example , @xmath100 where @xmath101 and @xmath102 are the parameters of beta prior , @xmath103 is the number of transition from @xmath104 to @xmath92 . in the same way the sample of @xmath99 is obtained .",
    "the posterior density of @xmath62 given the prior @xmath105 is given by : @xmath106 which is independent of @xmath68 .",
    "to sample from the @xmath107 we use the griddy gibbs algorithm that introduced by ritter and tanner @xcite .",
    "this method is very applicable in researches ( for example @xcite , @xcite and @xcite ) .",
    "given samples at iteration @xmath108 the griddy gibbs at iteration @xmath109 proceeds as follows : +   + 1 . select a grid of points , such as @xmath110 . using ( [ 23 ] ) , evaluate the conditional posterior density function @xmath111 over the grid points to obtain the vector @xmath112 .",
    "+ 2 . by a deterministic integration rule using the g points ,",
    "compute @xmath113 with @xmath114 3 . simulate @xmath115 and invert @xmath116 by numerical interpolation to obtain a sample @xmath117 from @xmath118 .",
    "repeat steps 1 - 3 for other parameters .",
    "+    for the prior densities of all elements of @xmath62 , it can be can considered independent uniform densities over the finite intervals .",
    "in this section we apply the daily log returns of the @xmath0 and swiss market index ( smi ) .",
    "the sample period of @xmath0 is from 03/01/2005 to 03/11/2014 ( 2500 observations ) , the first 2000 observations are employed to estimate the parameters while the remaining 500 are used in a forecasting analysis . the selected interval of smi is from 10/02/2004 to 11/11/2015 ( 3000 observations ) , the first 2500 indexes are used to estimate and the rest of them for forecasting .",
    "figure 1 demonstrates the percentage returns of , where @xmath119 is the index level at time t. ] of the @xmath0 and smi . in table 1",
    ", we report summary descriptive statistics of returns .",
    "we observe the means are close to zero and also a slightly negative skewness and a common excess kurtosis for each data set .",
    "using the bayesian inference , we estimate the parameters of stgarch @xcite , two - state ms - garch @xcite and ms - stgarch with two regimes . the prior density of @xmath98 and @xmath99 ( the transition probability from one regime to other regime ) are drawn from the beta distribution and the others",
    "are assumed to be uniform over a finite intervals .",
    "the number of iterations of gibbs algorithm for each model is 10000 which half of them are burn - in - phase .",
    "the posterior means and standard deviations for the models corresponding to @xmath0 and smi are reported in table 2 and table 3 show that the standard deviations are small enough in most cases . the single - regime me stgarch has different reactions to negative and positive shocks are nt flexible like markov switching model to transit between low volatility and high volatility and reverse . according to results we find that in the ms - garch and ms - stgarch models the second regimes have higher volatility .",
    "ms - garch defined by setting @xmath120 and @xmath15 , @xmath121 equal to zero in relation ( [ 2 ] ) that implies a symmetric response respect to positive and negative shocks of the same magnitude .",
    "the ms - stgarch encompasses two previlages : the transition between low and high volatility states and the different reactions to positive and negative shocks . since in the ms - stgarch , @xmath122 and @xmath123 and according to structure of @xmath22 ( [ 4 ] )",
    "we deduce that the negative shocks have more affect on volatility than the positive shocks in two regimes .",
    "the obvious differences between @xmath124 and @xmath125 in table 2 and 3 expresses that the leverage effect in each regime is different . in all cases",
    "the posterior means of transition probability ( @xmath98 and @xmath99 ) indicate scarce mixing between regimes . smoothed probabilities for the second regimes of ms - stgarch according to @xmath0 and smi log returns",
    "are plotted in figure 2 .      in order to evaluate the goodness of fit of models , we apply the deviance information criterion introduced by spiegelhalter et al .",
    "see also @xcite .",
    "the smallest dic determines the best fitting model .",
    "+ in the markov - switching models , the likelihood is calculated by the following formula : @xmath126 in which @xmath127 is the vector of all parameters in model and @xmath128 is obtained from ( [ 7 ] ) .",
    "the deviance information criterion is computed as : @xmath129,\\ ] ] that @xmath130 is the posterior means of the vector @xmath127 .",
    "the results concerning dic are reported in table 4 .",
    "it is apparent that the dic of ms - stgarch is the smallest value in both data sets .",
    "for appraising the ms - stgarch model to forecast the future treatment , we survey the one - day - ahead value at risk ( var ) forecasts .",
    "the one - day - ahead var at risk level @xmath131 , var@xmath132 is obtained by calculating the @xmath133th percentile of the one - day - ahead predictive distribution @xcite .",
    "based on the last 500 returns ( of @xmath0 and smi),the out of sample var measures for each model are calculated . to test the var values",
    ", we investigate the random sequence @xmath134 that @xmath135 the out - of - sample var measures has the good performance if @xmath134 is an independent and also follows the bellow distribution ( unconditional coverage ) : @xmath136 the statistics for the independency ( @xmath137 ) and unconditional coverage ( @xmath138 ) asymptotically are chi - squared distributed with one degree of freedom . by adding the @xmath137 and @xmath138 , a dual test that inquires both hypotheses (",
    "independency and unconditional coverage ) , i.e. conditional coverage ( see @xcite and @xcite ) : @xmath139 @xmath140 is @xmath141 distributed with two degrees of freedom .",
    "the lower value of @xmath140 than the critical @xmath141 distribution means that the correct conditional coverage and as a result the good var forecasts .",
    "+    the results of the tests are reported in table 5 for @xmath0 and table 6 for smi .",
    "the second and third columns demonstrate the theoritical expected violations and the number of empirical violations .",
    "the @xmath137 statistics in table 5 and 6 are smaller than critical @xmath141 distribution for all cases and so independency test is nt rejected .",
    "the results of table 5 show that the real number of violations for the ms - stgarch are closer to expected values than for the stgarch and ms - garch except for @xmath142 , which can be considered as a better performance . at the @xmath143 significance level ,",
    "the @xmath138 test is rejected three times for the stgarch , two times for ms - garch and is accepted for all quantities of @xmath144 for the ms - stgarch .",
    "also the values of @xmath140 are lower than the critical @xmath141 distribution for ms - stgarch , while this test are rejected three times for the stgarch and one time for the ms - garch . in table 6 the @xmath138 is larger than critical value three times for stgarch and two times for the ms - garch and ms - stgarch . also the conditional coverage test is rejected thrice for the stgarch , once for the ms - garch and twice for the ms - stgarch .",
    "the results indicate that the new model has the better forecasting performance than the stgarch model in both examples . in the case of greater negative skewness ( @xmath0 returns ) ,",
    "the out - of - sample var forecasts of the ms - stgarch has better performance than the ms - garch .",
    "[ fig1 ]    = 5.7 in = 1.8 in    [ fig2 ]    = 6.2 in = 3.5 in    .deviance information criterion ( dic ) [ cols=\"^,^,^\",options=\"header \" , ]",
    "the ms - stgarch model extend the ms - garch model by considering the different smooth transition structures in each regime .",
    "it is also an extension of the stgarch model that transits between the different levels of volatilities .",
    "the proposed model authorizes for greater flexibility to capture volatility clustering and leverage effect that are usual patterns in financial time series . for the estimation of parameters",
    "we apply the bayesian estimation algorithm .",
    "we present a simple necessary and sufficient condition for the existence of an upper bound for the second moment . for the estimation of the parameters the bayesian inference",
    "is used by applying the griddy gibbs algorithm .",
    "we fit stgarch , ms - garch and ms - stgarch models to the @xmath0 and smi log returns .",
    "we demonstrate that when the negative skewness coefficient is large enough our model has the best var forecasts among other models .",
    "this model has the potential to be applied for modeling and forecasting conditional volatility of financial time series .",
    "further researches could be oriented to investigate the existence of the third and the fourth moments of the process and derive the necessary and sufficient conditions for stationarity and ergodicity properties of the process . for the sake of simplicity",
    "it was assumed that the process conditional mean is zero , this assumption could be relaxed by refining the structure of model to allow arma structure for conditional mean .",
    "finally it might be interesting to replace the gaussian distribution with t - distribution and investigate the ability for modeling heavy tailed property of financial time series .",
    "@xmath150 denotes the expectation with respect to the information up to time t. also for summarization , we shall use @xmath151 and @xmath152 to represent @xmath153 and @xmath154 , respectively , where @xmath74 is the realization of the state at time t. the conditional variance under the chain state , @xmath155 , is investigated as follows : @xmath156}_{ii}+\\underbrace{(a_{2m}-a_{1m})e_{t-1}[y^2_{t-1}w_{m , t-1}|z_t]}_{iii } \\nonumber \\\\ & \\qquad\\qquad\\qquad \\ \\ \\ \\ \\ \\ \\ \\ \\qquad\\qquad+\\underbrace{b_me_{t-1}[h_{m , t-1}|z_t]}_{iv}.\\end{aligned}\\ ] ] the term ( ii ) in ( [ 11 ] ) can be interpreted as follows :    @xmath157=\\sum_{z_{t-1}=1}^{k }   { \\int_{s_{\\mathcal{i}_{t-1}}}{y^2_{t-1}p(\\mathcal{i}_{t-1}|z_t , z_{t-1})p(z_{t-1}|z_t)d\\mathcal{i}_{t-1}}}\\ ] ] @xmath158},\\ ] ] where @xmath159 is the support of @xmath160 . + * upper bound for iii in ( [ 11 ] ) : * let @xmath161 be a constant , so @xmath162= & e_{t-1}[y^2_{t-1}w_{m , t-1}i_{|y_{t-1}|<m}|z_t ] \\nonumber\\\\ & + e_{t-1}[y^2_{t-1}w_{m , t-1}i_{|y_{t-1}|\\geq m}|z_t ] \\nonumber\\end{aligned}\\ ] ] in which @xmath163 as by ( [ 4 ] ) , @xmath164 and so @xmath165\\leq m^2+e_{t-1}[y^2_{t-1}w_{m , t-1}i_{|y_{t-1}|\\geq m}|z_t],\\ ] ] also @xmath166=&\\int_{s_{\\mathcal{i}_{t-2}},y_{t-1}\\leq -m}{y^2_{t-1}[w_{m , t-1}]p(\\mathcal{i}_{t-1}|z_t)d\\mathcal{i}_{t-1 } } \\nonumber\\\\ & + \\int_{s_{\\mathcal{i}_{t-2}},y_{t-1}\\geq m}{y^2_{t-1}[w_{m , t-1}]p(\\mathcal{i}_{t-1}|z_t)d\\mathcal{i}_{t-1 } } , \\nonumber\\end{aligned}\\ ] ] by ( [ 4 ] ) , @xmath167 therefore according to the definition of limit at infinity , for a small number @xmath168 , there will exist a finite constant @xmath169 such that if @xmath170 , @xmath171 and if @xmath172 , @xmath173 . hence @xmath166 \\leq \\ & \\delta \\int_{s_{\\mathcal{i}_{t-2}},y_{t-1}\\leq -m}{y^2_{t-1}p(\\mathcal{i}_{t-1}|z_t)d\\mathcal{i}_{t-1 } } \\nonumber\\\\ & + ( \\delta+1 ) \\int_{s_{\\mathcal{i}_{t-2}},y_{t-1}\\geq",
    "m}{y^2_{t-1}p(\\mathcal{i}_{t-1}|z_t)d\\mathcal{i}_{t-1}}. \\nonumber\\end{aligned}\\ ] ] since the distribution of the @xmath3 is symmetric , then @xmath174}{2 } \\nonumber\\end{aligned}\\ ] ] + and @xmath175}{2}.   \\nonumber\\end{aligned}\\ ] ] + therefor @xmath165\\leq   m^2+(\\delta+\\frac{1}{2})e_{t-1}[y^2_{t-1}|z_t].\\ ] ] * upper bound for iv in ( [ 11 ] ) : * @xmath176 @xmath177 by replacing the obtained upper bounds and relations ( [ 12 ] ) in ( [ 11 ] ) , the upper bound for @xmath178 is obtained by : @xmath179 p(z_{t-1}|z_t)}e_{t-2}[h_{z_{t-1},t-1}|z_{t-1}]}\\nonumber \\\\&+\\sum_{z_{t-1}=1}^{k}{b_mp(z_{t-1}|z_t)e_{t-2}(h_{m , t-1}|z_{t-1})},\\end{aligned}\\ ] ] in which by bayes rule @xmath180 where @xmath181 is the transition probability matrix .",
    "let @xmath182 $ ] , @xmath183 $ ] be a @xmath37-by-1 vector and consider @xmath184 be a vector that is made of k vector @xmath185 . by ( [ 16])-([18 ] ) ,",
    "the following recursive inequality is attained , @xmath186 with some initial conditions @xmath187 the relation ( [ 19 ] ) implies that @xmath188 following the matrix convergence theorem @xcite , the necessary condition for the convergence of @xmath189 when @xmath190 is that @xmath191 . under this condition",
    ", @xmath192 converges to zero as t goes to infinity and @xmath193 converges to @xmath194 provided that matrix @xmath195 is invertible .",
    "so if @xmath191 , @xmath196 by ( [ 10 ] ) the upper bound for the asymptotic behavior of unconditional variance is given by @xmath197      alemohammad , n. rezakhah , s. alizadeh , s. h. ( 2015 ) .",
    "markov switching component garch model : stability and forecasting , _ communications in statistics- theory and methods _ , in press .",
    "http://www.tandfonline.com/doi/abs/10.1080/03610926.2013.841934    amado , c. terasvirta , t. ( 2011 ) .",
    "conditional correlation models of autoregressive conditional heteroskedasticity with nonstationary garch equations , _ nipe working paper _ , university of minho .",
    "ardia , d. ( 2009 ) .",
    "bayesian estimation of a markov switching threshold asymmetric garch model with student - t innovations , _ the in econometric journal_,12 ( 2),105 - 126 .",
    "chib , s. ( 1996 ) .",
    "calculating posterior distributions and model estimates in markov mixture models , _ journal of econometrics _",
    ", 75 , 79 - 97 .",
    "christofferssen , p. ( 1998 ) . evaluating interval forecasting , _ international economic review _ , 39 , 841 - 862 .",
    "engle , r. f. ( 1982 ) .",
    "autoregressive conditional heteroscedasticity with estimates of the variance of united kingdom inflation , _ econometrica _ , 50 , 987 - 1007 .",
    "engle , r. f. ( 1990 ) .",
    "discusion : stock volatility and the crash of 87 , _ review of financial studies _ , 3 , 103 - 106 .",
    "kaufman , s. fruhwirth - schnatter , s. ( 2002 ) .",
    "bayesian analysis of switching arch models , _ journal of time series analysis _",
    ", 23 , 425 - 458 .",
    "klaassen , f. ( 2002 ) . improving garch volatility forecasts with regime - switching garch , _ empirical economics _ 27 , 363 - 394 ."
  ],
  "abstract_text": [
    "<S> a markov switching asymmetric garch model which imposes more leverage effect of the negative shocks is considered . the asymptotic behavior of the second moment is investigated and an upper bound for it is calculated . a bayesian strategy through gibbs and griddy gibbs sampling is used to estimate the parameters . </S>",
    "<S> finally we study the performance of the model by two real data sets . </S>",
    "<S> we show that this model has the best in - sample fit via dic and provides a better forecast when the negative skewness is large enough . + _ keywords _ : markov switching , leverage effect , smooth transition , dic , bayesian inference , griddy gibbs sampling . </S>",
    "<S> +   + _ mathematics subject classification : _ </S>",
    "<S> 60j10 , 62m10 , 62f15 . </S>"
  ]
}