{
  "article_text": [
    "in this paper we investigate the total path length , that is , sum of all depths , of random split trees defined by devroye  @xcite ( we will be more precise shortly ) .",
    "split trees model a large class of efficient data structures or sorting algorithms",
    ". some important examples of split trees are binary search trees ( which are also the representation of quicksort ) @xcite , @xmath0-ary search trees  @xcite , quad trees  @xcite , median - of-@xmath1 trees  @xcite , simplex trees ; all these are covered by the results in this document .",
    "the case of tries  @xcite and digital search trees @xcite is also important in practice  @xcite ; however , their treatment necessitates different tools , and we leave this case for later studies .",
    "the magnitude of the depths in tree data structures naturally influences their efficiency ; in the case where the tree represents the branching choices made by an algorithm , the depths are related to the running time of the algorithm . in this sense ,",
    "the sum of the depths is a natural and important measure of the efficiency of tree data structures or sorting algorithms .",
    "the path length of tree data structures has been studied by many authors , but in most cases the analyses and proofs are very much tied to a specific case .",
    "the main result of this study is to prove that for a large class of split trees , the total path length converges in distribution to a random variable characterized by some fixed point equation . in that sense",
    "our result extends the earlier studies of rsler  @xcite and neininger and rschendorf  @xcite who used the so - called contraction method to show convergence in distribution of the total path length for the specific examples of the binary search trees , the median - of-@xmath1 trees and quad trees .",
    "our method actually relies on previous work of neininger and rschendorf  @xcite who gave a limit theorem for the path length of general split trees , under the assumption that the mean satisfies some precise asymptotic form , which we prove .    in section  [ secbackground ]",
    ", we introduce the model of split trees of devroye  @xcite .",
    "we also discuss previous work on the path length and similar topics .",
    "this is also the place where we state our main result , theorem  [ main ] .    in section  [ seccontraction ] ,",
    "we explain our general approach , which relies heavily on previous work by neininger and rschendorf @xcite .",
    "these authors stated a  general condition for convergence in distribution of the path length , and our contribution is to prove that it indeed holds for a large class of split trees . so section  [ seccontraction ] is included so that the reader has a general view of the argument .",
    "once we have stated the precise condition in section [ seccontraction ] , we will move on to explaining our approach to proving it in section  [ secaverage ] .",
    "finally , in section [ secconcl ] we discuss extensions of our results .",
    "we introduce the split tree model of devroye  @xcite .",
    "consider an infinite rooted @xmath2-ary tree ( every node has @xmath2 children ) .",
    "the nodes are identified with the set of finite words on an alphabet with @xmath2 letters , @xmath3 .",
    "the root is represented by the empty word  @xmath4 .",
    "we write @xmath5 to denote that @xmath6 is an ancestor of @xmath7 ( as words , @xmath6 is a prefix of @xmath7 ) . in particular",
    ", for the empty word @xmath4 , we have @xmath8 for any @xmath9 .    a split tree @xmath10 of _ cardinality _ @xmath11 is constructed by distributing @xmath11 items ( pieces of data ) to the nodes @xmath12 .",
    "to describe the tree , it suffices to define the number of items @xmath13 in the subtree rooted at any node @xmath12 .",
    "the tree  @xmath10 is then defined as the smallest relevant tree , that is , the subset of nodes  @xmath6 such that @xmath14 ( which is indeed a tree ) .    in the model ,",
    "internal nodes all contain @xmath15 items , and external nodes can contain up to @xmath16 items .",
    "the construction then resembles a divide - and - conquer procedure , where the partitioning pattern depends on a random vector of proportions .",
    "let @xmath17 satisfy @xmath18 and @xmath19 ; each node @xmath12 receives an independent copy @xmath20 of the random vector @xmath21 . in the following",
    ", we always assume that @xmath22 .",
    "we can now describe @xmath23 .",
    "the tree contains @xmath11 items , and we naturally have @xmath24 . the split procedure is then carried on from parent to children as long as @xmath25 . given the cardinality @xmath26 and the split vector @xmath27 of @xmath7 , the cardinalities @xmath28 of the @xmath2 subtrees rooted at @xmath29 are distributed as @xmath30 where @xmath31 and @xmath32 .",
    "depending on the choice of parameters @xmath33 and the distribution of @xmath34 , many important data structures may be modeled , such as binary search trees , @xmath0-ary search trees , median - of-@xmath1 trees , quad trees , simplex trees ( see  @xcite ) . to make sure that the model is clear and to give a hint of the wide applicability of the model , we illustrate the construction with two canonical examples .",
    "[ ex1 ] the binary search tree is one of the most common data structures for sorted data .",
    "here we assume that the data set is @xmath35 .",
    "a first ( uniformly ) random key is drawn @xmath36 , and stored at the root of a binary tree .",
    "the remaining keys are then divided into two subgroups , depending on whether they are smaller or larger than @xmath37 .",
    "the left and right subtrees are then binary search trees built from the two subgroups @xmath38 and @xmath39 , respectively",
    ". the sizes of the two subtrees of the root are @xmath40 and @xmath41 .",
    "one easily verifies that , since @xmath36 is uniform in @xmath42 , one has @xmath43 where @xmath44 is a uniform @xmath45 random variable .",
    "thus , a binary search tree can be described as a split tree with parameters @xmath46 , @xmath47 , @xmath48 , @xmath49 and @xmath21 is distributed as @xmath50 for @xmath44 a random variable uniform on @xmath51 $ ] .",
    "[ ex2 ] we are given @xmath11 ( infinite ) strings @xmath52 on the alphabet @xmath53 .",
    "the strings are drawn independently , and the symbols of every string are also independent with distribution on @xmath53 given by @xmath54 .",
    "each string naturally corresponds to an infinite path in the infinite complete @xmath2-ary tree , where the sequence of symbols indicates the sequence of directions to take as one walks away from the root .",
    "the trie is then defined as the smallest tree so that all the paths corresponding to the infinite strings are eventually distinguished ; that is , for every string  @xmath55 , there exists a node @xmath6 in the tree such that @xmath55 is the only string with @xmath56 .",
    "the internal nodes store no data ; each leaf stores a unique string . in this case , @xmath26 is the number of strings that have prefix @xmath7 , and one clearly has for the children of the root @xmath57 the trie is thus a random split tree with parameters @xmath58 and @xmath59 almost surely .    rather than using the divide - and - conquer description above , the random trees may be equivalently defined using incremental insertion of data items into an initially empty data structure .",
    "the items are labeled using @xmath60 in the order of insertion .",
    "initially , @xmath61 for every @xmath62 .",
    "we first sample the i.i.d .",
    "copies of @xmath21 that are assigned to the nodes @xmath12 .",
    "* upon insertion , an item first trickles down along a random path from the root until it finds a leaf ( i.e. , a node @xmath6 such that all its children @xmath63 satisfy @xmath64 ) .",
    "if the path currently corresponds to a word @xmath9 , and @xmath7 is not a leaf , then it is extended to @xmath65 , the @xmath66th child of @xmath7 with probability  @xmath67 , where @xmath68 is the copy of @xmath21 associated with @xmath7 .",
    "* when the first phase is finished , the item is stored in a leaf , say @xmath7 .",
    "the leaves can contain up to @xmath16 items .",
    "so if @xmath69 ( before the insertion ) , then the item is stored at @xmath7 , and all the @xmath13 for @xmath5 are updated . *",
    "if @xmath70 , there is no space for the new item at @xmath7 . with the new item , we formally have @xmath71 . in this case , @xmath72 of these @xmath73 items are randomly chosen to remain at @xmath7 while the other @xmath74 are distributed among the children @xmath75 of @xmath7 .",
    "each child receives @xmath76 items chosen at random .",
    "the remaining @xmath77 each choose ( independently ) a child @xmath65 at random with probability @xmath67 , where @xmath68 is the copy of @xmath21 at node @xmath7 .",
    "if @xmath78 , it may happen that all @xmath73 items now lie at one child @xmath65 , in which case the scheme is repeated until a stable position is found .",
    "[ this happens with probability 1 , since @xmath22 .",
    "] this last step is the reason why an item may move down when a further item is inserted .",
    "the properties of the multinomial distribution ensure that the tree @xmath10 obtained in this way has the correct distribution ( see @xcite for details ) .",
    "in the present case we can assume without loss of generality that the components of @xmath79 are identically distributed ; applying a random permutation to the components would leave the path length unchanged .",
    "we now let @xmath80 denote a uniformly random component of @xmath21 .",
    "so , for instance , @xmath81=1/b$ ] and @xmath82 by our assumption that @xmath22 .",
    "the labeling of the items induced by the algorithm above is interesting for the analysis .",
    "let @xmath83 be the depth of the item labeled @xmath66 when all @xmath11 items have been inserted .",
    "then , the total path length is @xmath84 the analysis of the depth @xmath85 of the last item @xmath11 is thus tightly related to the analysis of @xmath86 , and yet is much simpler since it avoids the intricate dependence between the @xmath83 .",
    "devroye  @xcite proved a weak law of large numbers and a central limit theorem for @xmath85 in general split trees .",
    "let @xmath87 be a  component of @xmath88 picked with probability proportional to its size ; that is , given @xmath88 , let @xmath89 with probability @xmath90 .",
    "we write @xmath91=b\\mathbf{e}[-v\\ln{v } ] \\quad\\mbox{and}\\nonumber\\\\[-8pt]\\\\[-8pt ] \\sigma^2&:=&\\operatorname{\\mathbf{var}}(\\ln\\delta)=b\\mathbf { e}[v\\ln^2 v]-\\mu^2.\\nonumber\\end{aligned}\\ ] ] note that @xmath92 and @xmath93 .",
    "then @xmath94 converges in probability to  @xmath95 , and @xmath96/\\ln n\\rightarrow \\mu^{-1}$ ] ( devroye assumed that @xmath97 , but this assumption can be relaxed as long as @xmath80 satisfies @xmath98 ; this is done using trees in which edges are weighted by geometric random variables ( see , e.g. ,  @xcite ) ) . if we also have @xmath99 , then @xmath100 in distribution where @xmath101 denotes the standard normal distribution .",
    "note that @xmath99 precisely when @xmath80 is not monoatomic , that is , if @xmath102 with positive probability .",
    "the total path length @xmath103 itself has been extensively studied for specific cases of split trees .",
    "the first moment follows from that of @xmath85 since @xmath104=\\sum_{i=1}^n \\mathbf{e}[d_i].\\ ] ] for instance , in the binary search tree , we have  @xcite @xmath105=2n\\ln{n}+n(2\\gamma-4)+2\\ln { n}+2\\gamma+1 + \\mathcal o ( n^{-1}),\\ ] ] where @xmath106 is euler s constant . for higher moments and the distribution of  @xmath103",
    ", one needs to carefully take the dependence in the terms of the sum into account .",
    "most studies of this type concern the model of binary search tree , or equivalently the cost of quicksort ( e.g. , @xcite ) .",
    "let @xmath107}{n}.\\ ] ] using martingale arguments , rgnier  @xcite showed that @xmath108 converges in distribution to a random variable @xmath109 .",
    "rsler  @xcite showed that @xmath109 is satisfying the following distributional equality : @xmath110 where @xmath111 , @xmath44 is uniform on @xmath51 $ ] , @xmath109 and @xmath112 are independent .",
    "he also proved that the stochastic equality in ( [ regnier ] ) actually characterizes the distribution of @xmath109 : there exists a unique solution @xmath109 of ( [ regnier ] ) such that @xmath113=0 $ ] and @xmath114 .",
    "the distribution of @xmath109 is usually called the quicksort distribution .",
    "properties of @xmath109 and the rate of convergence of @xmath108 to @xmath109 are studied in @xcite .",
    "the aim of the present study is to prove that the path length exhibits a  similar asymptotic behavior regardless of the precise model of split tree :    [ main]let @xmath115 be the total path length in a general split tree with split vector @xmath116 .",
    "suppose that @xmath22 .",
    "let @xmath117}n \\quad\\mbox{and}\\quad c(\\mathcal{v})=1+\\frac1 \\mu\\sum_{i=1}^{b}v_i\\ln v_i.\\ ] ] if @xmath118 with positive probability , then @xmath119 in distribution , where @xmath120 is the unique solution of the fixed point equation @xmath121 satisfying @xmath122=0 $ ] and @xmath123 . furthermore ,",
    "exponential moments of @xmath124 exist and converge @xmath125\\rightarrow\\mathbf{e}[e^{\\lambda x}]$ ] for any @xmath126 .",
    "as mentioned in the , neininger and rschendorf @xcite proved a version of theorem  [ main ] conditional on the type of asymptotic expansion for @xmath127 ; our contribution is to prove that this expansion indeed holds ( theorem  [ expectedpath ] ) , which implies the unconditional version stated in theorem  [ main ] .",
    "we have recently been informed that , based on a markov chain representation of bruhn  @xcite and coupling arguments , munsonius  @xcite has shown a  result similar to our theorem  [ main ] in the special case when the distribution of @xmath80 has a density with respect to lebesgue measure .",
    "\\(i ) when the split vector @xmath21 is deterministic , that is , @xmath21 is a permutation of some fixed vector @xmath128 , the cost function @xmath129 .",
    "such a split tree is a digital tree  @xcite . in some sense ,",
    "part of theorem  [ main ] still holds , but the limit @xmath120 is trivial since @xmath130 almost surely .",
    "the renormalization is actually too strong , since the variance in this case should be of order @xmath131 , rather than @xmath132 [ and order @xmath11 in the special case when @xmath133 .",
    "the total path length for binary tries has been treated by jacquet and rgnier  @xcite .",
    "they showed that the variance of @xmath86 is of order @xmath134 if @xmath135 and of order @xmath136 if @xmath137 and that the path length is asymptotically normal .",
    "schachinger  @xcite showed that , for tries with a general branch factor , the variance of the total path length for general tries is @xmath138 .",
    "see also  @xcite .    in general , in the case of digital trees [ when @xmath129 ] , it is expected that under the correct rescaling the limit distribution should be normal .",
    "neininger and rschendorf @xcite gave a general conditions under which limit distributions are gaussian .",
    "the case of the binary tries is one example when this theorem can be applied as an alternative proof to the method in  @xcite . in general , to apply the result in  @xcite one needs to have approximations for the first two moments of the path length .",
    "this is the reason why we report the analysis of this case : a lot more work is required to estimate the variance to the correct order .",
    "it might seem at first that one should have @xmath140 when @xmath141 is lattice ( trie case ) .",
    "however , one can easily construct examples with @xmath118 and @xmath141 lattice : for instance , take @xmath142 and @xmath21 a random permutation of either @xmath143 or @xmath144 , each with probability @xmath145 .    note , although it might come as a surprise since our main tool is renewal theory , theorem  [ main ] does not require any condition on arithmetic properties related to the vector @xmath146 .",
    "in particular , it holds whether @xmath147 is lattice or not",
    ". however , the behavior of the average path length does depend on arithmetic properties of @xmath141 ; see theorem  [ expectedpath ] later for details .",
    "note that the limit fixed equation only depends on @xmath21 , so in particular , the limit distribution @xmath120 does not depend on the parameters @xmath148 or @xmath76 .",
    "however , the average @xmath149 $ ] should clearly depend on these parameters , although we do not prove it formally .    for the sake of simplicity",
    ", we cover only trees with bounded degree , which is usually the case for trees representing data structures .",
    "the path length of recursive trees , which do not have bounded degree , has been studied by  @xcite .",
    "the condition stated by neininger and rschendorf  @xcite to ensure weak convergence of the path length concerns the asymptotics of the average path length . more precisely , if one has , for some constant @xmath150 , @xmath151=\\mu^{-1 } n\\ln",
    "n + \\varsigma n + o(n)\\ ] ] and @xmath152 , then theorem 5.1 of  @xcite ensures that @xmath119 in distribution .",
    "the purpose of this section is to explain why these conditions are sufficient to prove theorem  [ main ] . in particular , we give the necessary background about the contraction method , and we explain the general approach that has been devised in  @xcite .",
    "this section is included only to put our result in context , and no new result is proved with respect to the contraction method .",
    "note first that ( [ eqexpectedcond ] ) holds in the case of binary search trees ( [ bin ] ) .",
    "recall that  @xmath83 is the depth of the @xmath66th item in the construction where items are inserted one after another .",
    "it is not difficult to deduce from the results on  @xmath83 by devroye @xcite that @xmath104=\\mu^{-1 } n \\ln n + n q(n)\\ ] ] with @xmath153 ( see theorem 2.3 of  @xcite for a formal proof ) . so proving  ( [ eqexpectedcond ] ) reduces to proving that @xmath154 as @xmath155 .",
    "our contribution is to prove that this is indeed the case as soon as the random variable @xmath80 is such that @xmath147 is not lattice , that is , there is no @xmath156 such that @xmath157 almost surely . in the following , we let @xmath158 so that @xmath159 is the span of the lattice when @xmath160 and @xmath141 is nonlattice when @xmath161 .",
    "more precisely , we prove :    [ expectedpath ] the expected value of the total path length @xmath162 exhibits the following asymptotics , as @xmath155 : @xmath163=\\mu^{-1 } n\\ln n+n \\varpi(\\ln n)+o(n),\\ ] ] where @xmath164 is the constant in ( [ mu ] ) and @xmath165 is a continuous periodic function of period  @xmath159 .",
    "in particular , if @xmath141 is not lattice , then @xmath161 and @xmath165 is constant .    if @xmath141 is nonlattice , then theorem  [ expectedpath ] and theorem 5.1 of  @xcite together prove theorem  [ main ] .",
    "if the random variable @xmath141 is lattice with span @xmath159 , then theorem  [ expectedpath ] implies that @xmath166 as @xmath155 , where @xmath165 is @xmath159-periodic .",
    "so it seems that theorem  [ expectedpath ] does not permit to conclude along the arguments by neininger and rschendorf  @xcite",
    ". however , the techniques in  @xcite only require convergence of the coefficients of a certain recursive equation ; this fact was used in @xcite to deal with certain cases involving oscillations .",
    "we now move on to the approach developed by neininger and rschendorf .",
    "let @xmath167 denote the vector of cardinalities of the children of the root .",
    "then we have , for @xmath168 , @xmath169 where @xmath170 are copies of @xmath171 that are independent conditional on @xmath172 . introducing the normalized total path length @xmath173}{n},\\ ] ] we can rewrite the distributional identity above as @xmath174 where @xmath175}n+\\sum _ { i=1}^b\\frac{\\mathbf{e}[\\psi(t^{n_i})]}n\\vadjust{\\goodbreak}\\ ] ] and @xmath176 , @xmath177 , are independent conditional on @xmath178 . by definition ,",
    "the vector of cardinalities @xmath179 is @xmath180 so that @xmath181 almost surely as @xmath155 .",
    "this is where ( [ eqexpectedcond ] ) comes into play : it ensures that the cost @xmath182 ( the `` toll function '' ) in the recursive distributional equation does converge ( in distribution ) as @xmath155 . indeed @xmath183-\\frac{\\mathbf { e}[\\psi(t^n)]}n - \\frac{s_0}n\\\\ & = & 1+\\frac1 \\mu\\sum_{i=1}^b \\frac{n_i}n \\ln\\frac{n_i}n + \\frac1 \\mu",
    "\\biggl(\\sum_{i=1}^b \\frac{n_i}n \\varpi(\\ln n_i ) - \\varpi(\\ln n)\\biggr)+o(1).\\end{aligned}\\ ] ] now , by ( [ eqlimitsplit ] ) and the continuity of @xmath165 , it follows that @xmath184\\\\[-8pt ] & = & 1+\\frac1 \\mu\\sum_{i=1}^b v_i \\ln v_i + o(1),\\nonumber\\end{aligned}\\ ] ] since @xmath165 is @xmath159-periodic and @xmath185 by assumption ( if @xmath161 , @xmath186 is constant and the claim also holds ) .",
    "note that , apart from ( [ eqlimitsplit ] ) , only asymptotics for the first moments are required for ( [ eqtoll ] ) to hold .",
    "together ( [ eqlimitsplit ] ) and ( [ eqtoll ] ) suggest that if @xmath124 converges in distribution to some limit @xmath120 , then @xmath120 should satisfy the following fixed point equation : @xmath187 and @xmath188 are independent and identically distributed copies of @xmath120 .",
    "the point of the contraction method is to make the previous arguments rigorous , that is , to show that if the coefficients @xmath182 do converge , then  ( [ fixsplit ] ) has a unique solution @xmath120 and that @xmath119 in distribution ; this is precisely what was done in .",
    "this is done by proving that the recursive map defined by ( [ fixsplit ] ) is a contraction in a suitable space of probability measures  @xcite .",
    "we now expose the lines of the arguments to show the extent of the results that follow from the mere convergence of the coefficients  @xmath182 .",
    "( we claim no novelty . )",
    "let @xmath189 be the set of probability measures with a finite second moment .",
    "for a random variable @xmath120 , we write @xmath190 for its law . for @xmath191 and @xmath120",
    "a random variable with law @xmath192 , define the @xmath193-norm by @xmath194^{1/2}$ ] .",
    "we can then define a metric @xmath195 on @xmath189 ( the mallow metric ) : for @xmath196 , let @xmath197 where the range of the infimum is the set of couples @xmath198 with marginal distributions @xmath192 and @xmath199 . for simplicity",
    "we write @xmath200 for random variables @xmath120 and @xmath109 , but note that this only depends on the marginal distributions @xmath201 and @xmath186 .",
    "convergence of @xmath202 to @xmath201 in @xmath203 is equivalent to weak convergence with convergence of the second moment  @xcite : @xmath204    let @xmath205 be the subset of @xmath189 containing distributions @xmath201 such that @xmath206 .",
    "define the operator @xmath207 . for a distribution @xmath208 ,",
    "let @xmath209 be the distribution of the random variable given by @xmath210 where @xmath211 are i.i.d .",
    "random variables with distribution @xmath201 .",
    "then , calculations similar to that in the proof of lemma 3.2 in @xcite yield @xmath212\\cdot d_2(x , y)\\\\ & = & b \\mathbf{e}[v^2 ] \\cdot d_2(x , y).\\end{aligned}\\ ] ] since @xmath213<1 $ ] the operator @xmath214 is a contraction in @xmath215 .",
    "thus the banach fixed point theorem implies that @xmath214 has a unique fixed point .",
    "the random variable @xmath120 has this fixed point as distribution .",
    "the same line of thought actually implies that @xmath216 . a formal proof can be found in  @xcite .",
    "as stated in ( [ mallow ] ) , the convergence in @xmath217 is strong enough to imply convergence of second moments . in particular , @xmath218 where @xmath219 .",
    "computing @xmath220 $ ] using the fixed point equation , one easily obtains the following expression for @xmath221 : @xmath222 - 1}{1-\\sum _ { i=1}^{b}\\mathbf{e}[v_i^2]}.\\ ] ] this expression may also be obtained using estimates based on renewal theory in the spirit of our proof of theorem  [ expectedpath ] .",
    "in the previous section , we have explained why precise asymptotics for @xmath149 $ ] imply convergence in distribution of @xmath103 ( suitably rescaled ) .",
    "we now move on to the proof of theorem  [ expectedpath ] .",
    "recall that @xmath83 denotes the depth of the @xmath66th inserted item .",
    "write @xmath223 if the item @xmath66 is stored in the subtree rooted at @xmath6 . then rearranging the sum in the definition of  @xmath103",
    ", we see that @xmath224    recall the following fact , which we used already in section [ seccontraction ] : @xmath225 almost surely , as @xmath155 .",
    "we actually have a similar behavior for any random variable @xmath26 , when @xmath7 is a fixed node ( so in particular , its depth does not depend on  @xmath11 ) . for a node @xmath6 , the components @xmath226 of @xmath227 are naturally associated to the children @xmath228 of @xmath6 , and we can define @xmath229 . for the root node",
    "@xmath4 , define @xmath230 .",
    "then let @xmath231 where @xmath232 if @xmath7 is an ancestor of @xmath6 . the random variables",
    "@xmath233 define a recursive partition of @xmath51 $ ] , where @xmath234 is the _ length _ of the interval associated with  @xmath6 .",
    "in general , for any fixed node @xmath6 , we have @xmath235 almost surely as @xmath155 .",
    "so , as long as @xmath26 is large it should be well approximated by @xmath236 .",
    "this suggests that the sum in ( [ eqsumsizes ] ) be decomposed into the contributions of the top and of the fringe of the tree .",
    "we define the separation in terms of a parameter @xmath237 measuring the size of the trees pending in the fringe . the lengths @xmath238 are decreasing on any path from the root .",
    "so let  @xmath239 be the collection of nodes such that @xmath240 if @xmath241 has @xmath242 but for all its strict ancestors @xmath7 we have @xmath243 .",
    "we write @xmath244 , for the subtrees rooted at the nodes that belong to  @xmath239 . then@xmath245=\\mathbf{e}\\biggl[\\sum_{v\\ne\\varnothing } n_v{\\mathbf{1 } } _ { \\ { nl_v\\geq b \\ } } \\biggr]+\\mathbf{e}\\biggl[\\sum_{r\\in r}\\psi(t^{n_r})+n_r\\biggr],\\ ] ] since given @xmath246 , the total path length of @xmath247 , @xmath240 , is distributed like @xmath248 . [ the term @xmath246 needs to be added since the cardinality of the root of a tree  @xmath214 is not taken into account from our definition of @xmath249 . ]",
    "the following two propositions gather the asymptotics for the two terms in ( [ eqdecompositionsum ] ) above that will enable us to prove theorem  [ expectedpath ] . in the following , we let @xmath250 indeed , as we already mentioned ( it will become clear soon ) , the arithmetic properties of @xmath141 influence the asymptotics .",
    "[ lemma1 ] there exists a constant @xmath251 such that , for all @xmath11 large enough , and all @xmath237 , we have @xmath252-\\frac1 \\mu n \\ln \\biggl(\\frac n b\\biggr)- n \\phi_1\\biggl(\\ln\\frac n b\\biggr)\\biggr|\\le k \\frac n b , \\ ] ] where @xmath164 is the constant in ( [ mu ] ) and @xmath253 is a continuous @xmath159-periodic function ; in particular , @xmath253 is constant when @xmath161 .",
    "[ lemma2 ] there exists a constant @xmath251 such that , for all @xmath11 large enough , all @xmath254 small enough and @xmath255 , we have @xmath256- n \\varphi_b \\biggl(\\ln \\frac n b\\biggr ) \\biggr|\\le k \\varepsilon n\\ ] ] for some @xmath257 , a @xmath159-periodic function that depends on @xmath237 .",
    "furthermore , there exists a constant @xmath258 ( independent of @xmath237 ) such that , for @xmath254 small enough , @xmath259    the proofs of propositions  [ lemma1 ] and  [ lemma2 ] both rely on renewal theory : first , the sum @xmath260 is easily approximated by a function of sums of i.i.d .",
    "random variables ; second , the sizes @xmath246 in the second contribution can be estimated using overshoot arguments .",
    "the necessary technical lemmas are introduced in the following section .",
    "then , we prove propositions  [ lemma1 ] and  [ lemma2 ] in sections  [ sectop ] and  [ secfringe ] , respectively .    before we proceed to the proofs of propositions  [ lemma1 ] and [ lemma2 ]",
    ", we prove that they indeed imply theorem  [ expectedpath ] .",
    "the nonlattice case should be rather clear , but the lattice case requires a little care .",
    "proof of theorem  [ expectedpath ] we have been precise in the statements of propositions  [ lemma1 ] and  [ lemma2 ] ; we now take the liberty to use @xmath261 notation to simplify the discussion .",
    "it is understood that the hidden constants do not depend on @xmath262 or @xmath237 .",
    "first assume that @xmath141 is nonlattice ( @xmath161 ) .",
    "let @xmath263 be integers such that @xmath264 .",
    "fix @xmath254 , and choose @xmath265 . then by the triangle inequality and propositions  [ lemma1 ] and [ lemma2 ] , @xmath266}{n}-\\mu^{-1}\\ln n\\biggr)- \\biggl(\\frac{\\mathbf{e}[\\psi(t^{\\widehat{n}})]}{\\widehat{n}}-\\mu ^{-1}\\ln \\widehat n\\biggr)\\biggr|=o(\\varepsilon)\\vadjust{\\goodbreak}\\ ] ] as @xmath155",
    ". thus , the sequence @xmath267-\\mu ^{-1}\\ln n , n\\ge0)$ ] is cauchy , hence the result .    if @xmath141 is lattice , the situation is different since we can not directly invoke similar arguments . in particular , we need to prove the existence and continuity of the function @xmath165 . fix @xmath268 and consider @xmath269 , the set of integers such that @xmath270 is close to @xmath271 . then , by the triangle inequality and propositions  [ lemma1 ] and  [ lemma2 ] , we have @xmath272}{n}-\\mu^{-1}\\ln n\\biggr)- \\biggl(\\frac{\\mathbf{e}[\\psi(t^{\\widehat{n}})]}{\\widehat{n}}-\\mu ^{-1}\\ln \\widehat n\\biggr)\\biggr|\\\\ & & \\qquad\\le\\biggl|\\phi_1\\biggl(\\ln\\frac n b\\biggr ) - \\phi_1\\biggl(\\ln\\frac{\\widehat n}b\\biggr)\\biggr|+\\biggl|\\varphi_b\\biggl(\\ln\\frac n b\\biggr ) - \\varphi_b\\biggl(\\ln\\frac { \\widehat n } b\\biggr)\\biggr|\\\\ & & \\qquad\\quad{}+o(\\varepsilon)+o(1/b)\\\\ & & \\qquad= |\\phi_1(\\ln n ) - \\phi_1(\\ln\\widehat n)|+    _ b(\\ln n ) -",
    "\\varphi_b(\\ln\\widehat n)|+o(\\varepsilon),\\end{aligned}\\ ] ] if we choose @xmath273 in such a way that @xmath274 .",
    "now , @xmath253 is continuous and @xmath159-periodic so that there exists @xmath275 ( independent of @xmath271 ) such that @xmath276 when @xmath277 inside @xmath278 . on the other hand , for @xmath279 such that @xmath280",
    ", we have @xmath281 note that the bounds obtained are all uniform in @xmath271 .",
    "it follows that for every @xmath254 , there exists @xmath282 such that for @xmath279 satisfying @xmath283 , we have @xmath266}{n}-\\mu^{-1}\\ln n\\biggr)- \\biggl(\\frac{\\mathbf{e}[\\psi(t^{\\widehat{n}})]}{\\widehat{n}}-\\mu ^{-1}\\ln \\widehat n\\biggr)\\biggr|\\le o(\\varepsilon)+k ' \\varepsilon\\ln(1/\\varepsilon).\\ ] ] therefore , the subsequences @xmath284-\\mu ^{-1}\\ln n , n\\in \\omega_\\beta)$ ] , @xmath268 , are uniformly cauchy ( in @xmath285 ) .",
    "it follows that there exists a fixed function @xmath165 defined on @xmath286 such that , for every @xmath271 and @xmath287 , @xmath104=\\frac1 \\mu n \\ln n + n \\varpi(\\beta)+o(n).\\ ] ] furthermore , the function @xmath165 is continuous .",
    "this is easily seen using the same arguments with @xmath288 , @xmath289 and @xmath290 .",
    "once the definition of @xmath291 is extended by periodicity , the continuity ensures that we can write the asymptotics for @xmath149 $ ] in the form claimed in ( [ exptotal1h ] ) .",
    "this completes the proof in the lattice case .",
    "renewal theory has already been used for studying random trees in @xcite .",
    "the present paper is another example of its wide applicability .",
    "we start by quantifying the deviation between @xmath26 and @xmath292 for fixed nodes @xmath9 .",
    "[ cardinality]for any node @xmath7 , we have for all @xmath293 large enough @xmath294    first note that by the triangle inequality @xmath295 suppose that @xmath296 and let @xmath297 be the @xmath298-field generated by the random variables @xmath299 for @xmath300 . conditioning on @xmath301 ,",
    "the recursive splits of the cardinalities @xmath26 defined in ( [ mult ] ) give in a stochastic sense the following bound for  @xmath26 : @xmath302 now , by ( [ binomial2 ] ) , chebyshev s inequality and chernoff s bound for binomials ( see , e.g. , @xcite ) we obtain @xmath303\\\\ & & \\qquad\\quad { } + \\mathbf{e}\\biggl[\\exp\\biggl(\\frac{- ( nl_v)^{4/3}}{8(nl_v+(nl_v)^{2/3}/6)}\\biggr ) \\bigm| nl_v > x\\biggr]\\\\ & & \\qquad\\leq2 s x^{-2/3}\\sum_{k\\ge0}b^{-k}+e^{-x^{1/4 } } \\leq x^{-1/4}\\end{aligned}\\ ] ] for all @xmath293 large enough .",
    "when the cardinalities @xmath26 are close to the product @xmath236 , renewal theory allows us to get approximations suitable to prove propositions  [ lemma1 ] and  [ lemma2 ] .",
    "it is convenient to introduce the additive form @xmath304 . for @xmath305 , @xmath306 where @xmath67 , @xmath307 , are i.i.d .",
    "copies of @xmath80 .",
    "we define the exponential renewal function @xmath308 which satisfies the following renewal equation with @xmath309 : @xmath310 the measure @xmath311 is not a probability measure . to work with more convenient renewal equations , involving probability measures",
    ", we introduce the tilted measure @xmath312 .",
    "it is easily seen that @xmath313 is a probability measure , and defines a random variable @xmath120 by @xmath314 .",
    "in fact  @xmath315 is the distribution function of @xmath316 , where @xmath87 is the size - biased random variable in ( [ mu ] ) : writing @xmath317 for a random variable that is @xmath66 with probability @xmath67 given @xmath68 , we have @xmath318\\\\ & = & \\mathbf{e}\\biggl[\\sum_{i=1}^{b}{\\mathbf{1 } } _ { \\ { -\\ln v_i\\leq x \\ } } v_i\\biggr]\\\\ & = & b\\mathbf{e}\\bigl[{\\mathbf{1 } } _ { \\ { -\\ln v\\leq x \\ } } e^{-\\ln v}\\bigr]=\\omega(x).\\end{aligned}\\ ] ]    then , from ( [ mu ] ) , @xmath120 obviously satisfies @xmath319=\\mathbf{e}[-\\ln\\delta]=\\mu\\quad\\mbox{and}\\quad \\mathbf{e}[x^2]=\\sigma^2+\\mu^2.\\ ] ] the renewal equation ( [ eqnsrenewal ] ) can then be rewritten as @xmath320 where @xmath321 and @xmath322 .",
    "the first - order asymptotics for @xmath323 as @xmath324 follows from the standard renewal theorem applied to @xmath325 ( see also theorem 7.1 , chapter v of  @xcite or lemma 3.1 of @xcite for a formal proof ) : @xmath326    we will need some information about the second - order behavior of @xmath323 .",
    "the following lemma will be sufficient for us .",
    "[ vlem ] let @xmath327 , so that @xmath161 if @xmath141 is nonlattice . then , as @xmath328 @xmath329\\\\[-8pt ] & & \\qquad= \\cases { \\displaystyle \\frac{\\sigma^2-\\mu^2}{2\\mu^2}-\\mu^{-1}+o(1),&\\quad if $ d=0$,\\vspace*{2pt}\\cr \\displaystyle \\frac{\\sigma^2-\\mu^2}{2\\mu^2}-\\mu^{-1}+\\phi(x)+o(1 ) , & \\quad if $ d>0$,}\\nonumber\\end{aligned}\\ ] ] where @xmath330 is a bounded continuous periodic function with period @xmath159 .",
    "let @xmath331 be i.i.d .",
    "copies of a random variable @xmath120 defined by @xmath332 .",
    "define the ( standard ) renewal function @xmath333 then the renewal theorem ( theorem v.2.4 of  @xcite ) applied to ( [ ny ] ) yields @xmath334 [ note that @xmath335 includes a term @xmath336 . ] by fubini s theorem we obtain @xmath337\\\\[-8pt ] & = & \\int_{0}^{\\infty}\\widehat{\\nu}(u)f(x - u)\\,du-\\frac{x}{\\mu } .\\nonumber\\end{aligned}\\ ] ] recall that @xmath338 .",
    "integration by parts gives @xmath339_{0}^{\\infty}+\\int_{0}^{\\infty}e^{-t}\\,d\\nu(t)=b\\mathbf{e}[e^{-\\ln v}]=1.\\hspace*{-28pt}\\ ] ] rewriting ( [ standardrenewal5 ] ) as a single integral , it follows that @xmath340\\\\[-8pt ] & & \\qquad=-\\frac{1}{\\mu}\\int_{0}^{x}\\widehat{\\nu}(u)u\\,du- \\frac{1}{\\mu}\\int_{x}^{\\infty}\\widehat{\\nu}(u)x\\,du\\nonumber\\\\ & & \\qquad\\quad{}+\\int _ { 0}^{x}\\widehat { \\nu}(u)\\biggl(f(x - u)-\\frac{x - u}{\\mu}\\biggr)\\,du.\\nonumber\\end{aligned}\\ ] ] we start with the first two terms in ( [ standardrenewal6 ] ) .",
    "using again integration by parts and applying ( [ reneq ] ) yields @xmath341=1+\\mu,\\nonumber\\end{aligned}\\ ] ] where the last equality follows from the definition of @xmath164 in ( [ mu ] ) . finally , note that for all @xmath293 , @xmath342 as @xmath343 since @xmath344 .",
    "so it only remains to estimate the third term in ( [ standardrenewal6 ] ) .",
    "this is related to the asymptotics for the renewal function @xmath345 , which are different depending on whether @xmath141 is lattice or not .",
    "write @xmath346 for the fractional part of a real number @xmath293 , that is , @xmath347 . then , by theorem 5.1 in @xcite we have , as @xmath324 , @xmath348 in the nonlattice and the @xmath159-lattice case , respectively .",
    "furthermore , by lorden s inequality ( @xcite , theorem 1 ) , @xmath349    \\(i ) we now first assume that @xmath141 is nonlattice .",
    "the dominated convergence theorem applied to the last integral in ( [ standardrenewal6 ] ) , and ( [ reneq ] ) , yield @xmath350\\\\[-8pt ] & = & \\frac{\\sigma^2+\\mu^2}{2\\mu^2}.\\nonumber\\end{aligned}\\ ] ] putting ( [ standardrenewal7 ] ) together with ( [ standardrenewal6 ] ) , ( [ parts ] ) and ( [ eqsecterm ] ) we obtain , as @xmath343 , @xmath351 which proves the claim in ( [ v ] ) in the nonlattice case .",
    "\\(ii ) similarly in the lattice case with span @xmath159 , from the dominated convergence theorem we obtain @xmath352 by ( [ eqsecterm ] ) .",
    "the function @xmath201 defined for @xmath353 by @xmath354 is clearly @xmath159-periodic .",
    "furthermore , the function @xmath355 is continuous .",
    "indeed , for any @xmath356 such that @xmath357 we have @xmath358 \\ } } \\widehat\\nu(u)\\,du\\\\ & & { } + \\frac{d}{\\mu } \\int_0^\\infty\\biggl(\\frac{1}{2}-\\biggl\\{\\frac { y - u}{d}\\biggr\\}\\biggr ) { \\mathbf{1 } } _ { \\ { y - u\\ \\mathrm{mod}\\ d \\notin[\\varepsilon , 1-\\varepsilon ] \\ } } \\widehat\\nu(u)\\,du.\\end{aligned}\\ ] ] it follows that @xmath359 \\ } } \\widehat\\nu(u)\\,du\\\\ & \\le&\\frac2 \\mu\\varepsilon+2 \\sup_{z\\in\\{x , y\\ } } \\frac d \\mu\\int _ 0^\\infty{\\mathbf{1 } } _ { \\ { z - u\\ \\mathrm{mod}\\ d \\notin[\\varepsilon,1-\\varepsilon ] \\ } } \\widehat \\nu(u)\\,du.\\end{aligned}\\ ] ] since @xmath360 , the dominated convergence theorem implies that @xmath361 as @xmath362",
    ".    finally , putting ( [ standardrenewal7,1 ] ) together with ( [ standardrenewal6 ] ) , ( [ parts ] ) and ( [ eqsecterm ] ) as before proves the lattice case in ( [ v ] ) .      in this section , we prove proposition  [ lemma1 ] .",
    "for the top of the tree , the sizes @xmath26 are well approximated by @xmath363 .",
    "this suggests that the main contribution of the top of the tree should be @xmath364=\\mathbf{e}\\biggl[\\sum_{v\\ne\\varnothing } { \\operatorname{bin}}(n , l_v){\\mathbf{1 } } _ { \\ { nl_v\\ge b \\ } } \\biggr]+r_{n , b}\\ ] ] for a remainder @xmath365 that should be small .",
    "we first estimate the main contribution ; we will then quantify @xmath365 using ( [ binomial2 ] ) .",
    "[ lemma3 ] let @xmath366 , so that @xmath161 if @xmath367 is nonlattice . then , as @xmath368 , @xmath369 \\\\ & & \\qquad= \\cases { \\displaystyle \\frac1 \\mu n \\ln\\biggl(\\frac",
    "nb\\biggr)+ n \\frac{\\sigma^2-\\mu^2}{2\\mu^2}+o(n ) , & \\quad if $ d=0$,\\vspace*{2pt}\\cr \\displaystyle \\frac1 \\mu n \\ln\\biggl(\\frac nb\\biggr)+ n \\frac{\\sigma^2-\\mu^2}{2\\mu ^2}+n\\phi \\biggl(\\ln\\frac n b\\biggr)+ o(n),&\\quad if $ d>0$,}\\end{aligned}\\ ] ] where @xmath164 and @xmath298 are the constants in ( [ mu ] ) and @xmath370 is a bounded continuous @xmath159-periodic function .",
    "let @xmath67 , @xmath307 be i.i.d .",
    "copies of @xmath80 , and define @xmath371 and @xmath372 .",
    "then , we have @xmath373 & = & n \\mathbf{e}\\biggl[\\sum_{k\\ge1 } b^k l_k { \\mathbf{1 } } _ { \\ { n l_k\\geq b \\ } } \\biggr]\\\\ & = & n \\mathbf{e}\\biggl[\\sum_{k\\ge1 } b^d e^{-s_k}{\\mathbf{1 } } _ { \\ { s_k\\leq\\ln n -\\ln b \\ } } \\biggr]\\\\ & = & n \\int_0^{\\ln(n / b)}\\sum_{k\\ge1 } b^k e^{-t}\\,d{\\mathbf p}(s_k\\leq t)\\\\ & = & n \\int_0^{\\ln(n / b ) } e^{-t } \\,du(t),\\end{aligned}\\ ] ] where @xmath323 is the renewal function defined in ( [ renewalfunction ] ) . using integration by parts",
    "we obtain , if @xmath147 is nonlattice , @xmath374^{\\ln(n / b)}_0+\\int^{\\ln ( n / b)}_0e^{-t}u(t)\\,dt\\\\ & & \\qquad=\\frac b n u\\bigl(\\ln(n / b)\\bigr)+\\int^{\\ln(n / b)}_0e^{-t}\\bigl(u(t)-\\mu ^{-1}e^t\\bigr)\\,dt\\\\ & & \\qquad\\quad{}+\\mu ^{-1 } \\ln(n / b)\\\\ & & \\qquad=\\mu^{-1 } + o(1 ) + \\frac{\\sigma^2-\\mu^2}{2\\mu^2}-\\mu^{-1}\\\\ & & \\qquad\\quad{}+\\mu ^{-1 } \\ln ( n / b ) + o(1)\\end{aligned}\\ ] ] by lemma  [ vlem ] and ( [ renewalequation3 ] ) .",
    "similarly if @xmath375 is lattice with span @xmath159 , lemma  [ vlem ] and ( [ renewalequation3 ] ) yield @xmath376 where @xmath377 is a continuous periodic function with period @xmath159 .",
    "we now deal with the remainder @xmath365 introduced in ( [ eqdefrnb ] ) .",
    "the difference between @xmath26 and the binomial is bounded in ( [ binomial2 ] ) and we have @xmath378.\\ ] ]    [ lemma4 ] the following estimate holds : there exist a constant and @xmath275 such that , for every fixed @xmath237 and @xmath379 , we have @xmath380=o \\biggl(\\frac{n}{b}\\biggr).\\ ] ]    in the following , @xmath296 , @xmath381 , and we write @xmath382 . then @xmath238 is distributed as @xmath383 , where the two factors are products of @xmath384 and @xmath385 copies of @xmath80 , respectively ; all of them are independent . swapping the sums over @xmath6 and @xmath7",
    ", we obtain @xmath386 \\nonumber\\\\ & & \\qquad=\\mathbf{e}\\biggl[\\sum_u \\sum_{v\\dvtx u\\preceq v , v\\ne\\varnothing } s \\frac { l_v}{l_u } { \\mathbf{1 } } _ { \\ { nl_v\\ge b \\ } } \\biggr ] \\le s \\mathbf{e}\\biggl[\\sum_{k\\ge0 } b^k \\sum_{\\ell\\ge0 } b^\\ell l_\\ell{\\mathbf{1 } } _ { \\ { n l_k l_\\ell\\ge b \\ } } \\biggr]\\\\ & & \\qquad = s \\mathbf{e}\\biggl[\\sum_{k\\ge0}b^k\\sum_{\\ell\\ge0}b^\\ell e^{-s_\\ell } { \\mathbf{1 } } _ { \\ { e^{s_k+s_\\ell}\\leq n / b \\ } } \\biggr].\\nonumber\\end{aligned}\\ ] ] first conditioning on @xmath387 in each term of the sum above , and recalling the renewal function @xmath323 defined in ( [ renewalfunction ] ) , we see that @xmath388 = \\int^{\\ln(n / b)-s_k}_0 e^{-t}\\,du(t)+b{\\mathbf{1 } } _ { \\ { e^{s_k}\\le n / b \\ } } .\\ ] ] however , there exists a constant @xmath389 such that , for any real number @xmath293 , @xmath390 going back to ( [ salt ] ) and choosing @xmath391 , it follows that @xmath392\\\\ & & \\qquad\\leq c \\mathbf{e}\\biggl[\\sum_{k\\ge0 } b^k \\bigl(\\ln(n / b)-s_k+b \\bigr){\\mathbf{1 } } _ { \\ { s_k\\leq\\ln(n / b ) \\ } } \\biggr]\\\\ & & \\qquad = c \\int^{\\ln(n / b)}_0 \\bigl(\\ln(n / b)-t+b\\bigr)\\,du(t)\\\\ & & \\qquad = c \\bigl[\\bigl(\\ln(n / b)-t\\bigr)u(t)\\bigr]^{\\ln(n / b)}_0\\\\ & & \\qquad\\quad{}+c ' \\int^{\\ln(n / b)}_0 u(t)\\,dt,\\end{aligned}\\ ] ] where the last line follows by integration by parts and we wrote . the claim then follows from ( [ renewalequation3 ] ) .      finally , we prove proposition  [ lemma2 ] that deals with the contribution of the fringe of the tree . recall that from ( [ eqdecompositionsum ] ) , we have to estimate @xmath393:=\\mathbf{e}\\biggl[\\sum _ { r\\in r } \\psi(t^{n_r})+n_r\\biggr],\\ ] ] where , for convenience , we introduced @xmath394 .",
    "the proofs here get quite technical at times , and the reader should bear in mind that we will essentially express the expected value in ( [ eqfringereminder ] ) as a mixture of the expected values of @xmath395 $ ] , for @xmath384 lower than @xmath237 .    for a node @xmath241 , define the conditional expectation @xmath396 $ ] .",
    "first , the first asymptotic order of the expected total path length implies that @xmath397 the next lemma is used to get an error bound for the sum of the expected total path lengths of the subtrees @xmath398 , with cardinalities @xmath246 that differ from @xmath399 by at least @xmath400 items , so that we only have to bother about the subtrees @xmath398 , with cardinalities @xmath246 that are close to @xmath401 .",
    "[ hoaloa]the following error bound holds : @xmath402=\\mathcal { o}\\biggl(\\frac{n\\ln b}{b^{1/4}}\\biggr).\\ ] ]    we omit the proof ; it follows by a simple modification of the proof of lemma  4.3 of  @xcite . by lemma  [ hoaloa ] , we have @xmath403=\\mathbf{e}\\biggl[\\sum _ { r\\in r } \\gamma_{r}{\\mathbf{1 } } _ { \\ { |n_{r}-nl_{r}|\\leq b^{2/3 } \\ } } \\biggr]+o\\biggl(\\frac{n\\ln b}{b^{1/4}}\\biggr).\\ ] ] define @xmath404 to be the set of `` good '' nodes in @xmath239 : @xmath405 and let @xmath406 be the subset of nodes @xmath407 that also satisfy @xmath408",
    ".    we will now explain that it is enough to consider the nodes @xmath409 .",
    "the approximation of @xmath323 in ( [ renewalequation3 ] ) implies that the expected number of nodes @xmath7 such that @xmath410 is @xmath411 ; thus , since each node has at most @xmath2 children , @xmath412={o}(n / b)\\ ] ] as well .",
    "hence , it follows from ( [ epsilonigen ] ) that the expected number of nodes in the @xmath413 , @xmath407 , with @xmath414 is bounded by @xmath415 .",
    "using this fact yields @xmath416=\\mathbf{e}\\biggl[\\sum _ { r\\in r '' } \\gamma_{r}\\biggr]+ \\mathcal{o}(\\varepsilon^{2}n\\ln b)+{o}\\biggl(\\frac{n\\ln b}{b^{1/4}}\\biggr).\\ ] ]    because of the concentration of @xmath246 around @xmath401 , the cardinalities @xmath246 of the nodes @xmath240 are naturally related to the behavior of the `` overshoot '' of the renewal process @xmath417 , when it crosses the line @xmath418 . estimating the empirical distribution of the cardinalities of the nodes @xmath240 will allow us to approximate the right - hand side above .",
    "so we further subdivide the nodes @xmath240 into smaller classes according to the values of @xmath399 , @xmath240 .",
    "let @xmath419 , where we let @xmath420 .",
    "we write @xmath421 , for the set of nodes @xmath240 , such that @xmath422 .",
    "then  ( [ limsuphajul ] ) can be rewritten as @xmath423 = \\mathbf{e}\\biggl[\\sum_{z\\in z}\\sum_{r\\in r'\\cap r_{z}}\\gamma_{r}\\biggr]+ { o}(\\varepsilon^{2 } n\\ln b)+{o}\\biggl(\\frac{n\\ln b}{b^{1/4}}\\biggr).\\ ] ] even in a fixed class @xmath424 , not all the nodes have the same cardinality @xmath246 .",
    "so , in order to estimate the expected value in ( [ limsupnujul ] ) we need the following lemma that quantifies the discrepancy of @xmath149 $ ] under small variations of @xmath11 .",
    "[ lemmatot]there exists a constant @xmath389 such that , for any natural numbers @xmath11 and @xmath251 , we have @xmath425-\\mathbf{e}[\\widetilde \\psi{(t^{n } ) } ]     from the iterative construction , we clearly have @xmath426\\ge\\mathbf{e}[\\widetilde\\psi(t^n)]$ ] ; so it suffices to bound the increase in path length when adding  @xmath251 extra items to the tree @xmath10 .",
    "thinking again of the iterative construction , every ball trickles down until it finds a leaf .",
    "then , either it sits there if there is room left , or it triggers a growth of the tree .",
    "it is important to notice that only these @xmath73 balls may move .",
    "furthermore , the increase in depth of any of the @xmath73 items ( the last one , plus the @xmath16 that were already sitting at the leaf ) is at most the height of the final tree @xmath427 .",
    "hence , upon adding @xmath251 items , the path length increases by @xmath428 , by the results of  @xcite on the height of split trees .",
    "write @xmath429 $ ]",
    ". then lemma [ lemmatot ] ensures that , for any node @xmath430 , we have @xmath431 . by using ( [ epsilonigen ] ) and",
    "lemma  [ lemmatot ] , from  ( [ limsupnujul ] ) we obtain @xmath432 & = & \\sum_{z\\in z}\\mathbf{e}[|r'\\cap r_z|]\\bigl(f_z+{o}(\\gamma b\\ln b)\\bigr)\\nonumber\\\\ & & { } + { o}(\\varepsilon ^{2}n \\ln b ) + { o}\\biggl(\\frac{n \\ln b}{b^{1/4}}\\biggr)\\nonumber\\\\[-8pt]\\\\[-8pt ] & = & \\sum_{z\\in z}\\mathbf{e}[|r'\\cap r_z| ] f_z + o ( \\gamma n \\ln b ) \\nonumber\\\\ & & { } + { o}(\\varepsilon ^{2}n \\ln b ) + { o}\\biggl(\\frac{n \\ln b}{b^{1/4}}\\biggr),\\nonumber\\end{aligned}\\ ] ] since @xmath433= o(n / b)$ ] by ( [ eqsizer ] ) .",
    "so the contribution of the fringe is essentially a mixture of the @xmath434 , @xmath435 . to complete the proof of proposition  [ lemma2 ]",
    ", it suffices to estimate the mixing measure @xmath436 $ ] , @xmath435 .",
    "we first focus on the asymptotics for @xmath437 $ ] , @xmath435 .",
    "the following result is obtained by an application of the key renewal theorem .",
    "[ lem12 ] fix @xmath254 and let @xmath438 , where .",
    "let @xmath439 .",
    "if @xmath160 , we suppose that @xmath440 .",
    "then for any @xmath441 we have , as @xmath442 , @xmath443}{n / b}= \\cases { c_{\\alpha } + o(1 ) , & \\quad if $ \\ln v$ is nonlattice $ ( d=0)$,\\cr \\psi_{\\alpha}(\\ln n ) + o(1 ) , & \\quad if $ \\ln v$ is $ d$-lattice $ ( d>0)$,}\\ ] ] for a constant @xmath444 ( only depending on @xmath445 and @xmath106 ) , @xmath446 is the @xmath159-periodic function given in ( [ hopp2,1 ] ) below .",
    "let @xmath447 , be i.i.d .",
    "copies of @xmath80 . for an integer @xmath384 ,",
    "write @xmath448 . then",
    ", by definition , for @xmath441 , we have @xmath449 & = & \\sum_{u\\in u } { \\mathbf p}(u\\in r_{\\alpha b})\\\\ & = & \\sum_{k=0}^{\\infty}b^{k+1 } \\bigl({\\mathbf p}\\bigl(s_k-\\ln v_{k+1 } > \\ln ( n / b)-\\ln\\alpha\\mbox { and } s_k\\leq\\ln(n / b)\\bigr)\\\\ & & \\hspace*{40pt } { } -{\\mathbf p}\\bigl(s_k- \\ln v_{k+1}>\\ln(n / b)-\\ln ( \\alpha-\\gamma ) \\\\ & & \\hspace*{188pt}\\mbox { and } s_k\\leq\\ln(n / b)\\bigr)\\bigr)\\\\ & = & \\int_0^{\\ln(n / b)}b{\\mathbf p}\\bigl(\\ln(n / b)-t-\\ln\\alpha\\\\ & & \\hspace*{57pt}<- \\ln v_{k+1}\\leq\\ln(n / b)-t-\\ln ( \\alpha-\\gamma)\\bigr)\\,du_0(t),\\end{aligned}\\ ] ] where @xmath450 is a simple modification of the renewal @xmath451 defined in ( [ renewalfunction ] ) .",
    "thus , seeing @xmath452 $ ] as a function of @xmath418 and writing @xmath453 we have @xmath452=h(\\ln(n / b))$ ] .",
    "so we are after the asymptotics for @xmath454 , as @xmath455 .",
    "it is convenient to use a change of measure to relate @xmath454 to a  renewal function associated to a _",
    "probability _ measure .",
    "we have @xmath456 where @xmath345 is the standard renewal function already introduced in ( [ eqstandardrenewal ] ) .",
    "the asymptotics for the integral above are then easily obtained by using the key renewal theorem . in particular , they depend on whether @xmath141 is lattice or not .",
    "\\(i ) if @xmath141 is nonlattice , by the key renewal theorem ( @xcite , theorem ii.4.3 ) , we obtain @xmath457 note that the constant @xmath444 only depends on @xmath445 ( and @xmath106 ) and that @xmath458 . thus , since @xmath459 it follows immediately that @xmath452 = \\frac{n}{b}c_{\\alpha}+o(\\frac{n}{b})$ ] which proves the nonlattice case in ( [ residual42 ] ) .",
    "\\(ii ) similarly , if @xmath141 is lattice with span @xmath159 , the key renewal theorem ( see  @xcite , theorem ii.4.3 , or @xcite , theorem a.7 ) implies that @xmath460\\\\[-8pt ] : \\!&= & \\frac{bd}{\\mu}\\sum_{k\\dvtx kd\\le q } e^{kd - q } { \\mathbf p}\\bigl(q - kd-\\ln\\alpha<- \\ln v\\leq q - kd-\\ln ( \\alpha-\\gamma)\\bigr)\\nonumber \\ ] ] as @xmath455 . note that @xmath461 is a ( positive ) @xmath159-periodic function .",
    "observe also that for fixed @xmath445 , the function @xmath462 is not continuous since @xmath463 almost surely .",
    "since @xmath459 , it follows from ( [ hopp2,1 ] ) that @xmath452 \\sim\\frac{n}{b}\\psi_{\\alpha}(\\ln(n / b))$ ] .",
    "this proves the lattice case in ( [ residual42 ] ) , and completes the proof .    with lemma  [ lem12 ] in hand",
    ", we can now deduce the asymptotics for @xmath436 $ ] , @xmath435 and use them in ( [ limsupnuigen ] ) to complete the proof of proposition  [ lemma2 ] . recall that @xmath464 . clearly , @xmath465\\le\\mathbf{e}[|r_{\\alpha b}|]$ ] .",
    "furthermore , @xmath466 & = & \\sum_{r\\in r } { \\mathbf p}\\bigl(|n_r - nl_r|\\le b^{2/3 } , ( \\alpha-\\gamma ) b\\le nl_r < \\alpha b\\bigr)\\\\ & = & \\sum_{r\\in r } { \\mathbf p}\\bigl((\\alpha-\\gamma ) b \\le n l_r",
    "< \\alpha b\\bigr ) \\\\ & & \\hspace*{14pt}{}\\times\\mathbf{p}\\bigl(|n_r - nl_r|\\le b^{2/3 } \\mid(\\alpha-\\gamma)b\\le n l_r < \\alpha b \\bigr)\\\\ & \\ge&\\mathbf{e}[|r_{\\alpha b}|]\\bigl(1-o(b^{-1/4})\\bigr)\\end{aligned}\\ ] ] by lemma  [ cardinality ] .",
    "we now choose @xmath265 so that @xmath467 .",
    "\\(i ) if @xmath141 is nonlattice , it follows from lemma  [ lem12 ] that for each choice of  @xmath106 there is a constant @xmath468 such that for all @xmath441 and some constant @xmath469 ( that of lemma  [ lem12 ] ) we have @xmath470}{n / b}-c_{\\alpha } \\biggr|\\leq\\gamma^{2}+{o}(b^{-1/4})=\\gamma^2+o(\\varepsilon^5)=o(\\varepsilon^5),\\ ] ] whenever @xmath471 .",
    "so for all @xmath11 large enough , since @xmath472 , we have @xmath473 & = & \\sum_{\\alpha\\in s}c_{\\alpha}\\frac{n}{b}f_{\\alpha b}+\\frac { n}{b}\\sum _ { \\alpha\\in s}{o}(f_{\\alpha b}\\varepsilon^{5})+{o}(n \\gamma\\ln b)+{o}(\\varepsilon^{2 }",
    "n \\ln b ) \\\\ & = & n\\sum_{\\alpha\\in s } \\frac{f_{\\alpha b}}{b}c_{\\alpha } + { o}(\\varepsilon n).\\end{aligned}\\ ] ] this proves proposition  [ lemma2 ] when @xmath141 is nonlattice .",
    "( ii ) similarly , if @xmath141 is @xmath159-lattice , for any choice of @xmath106 , there is a @xmath474 such that for any @xmath441 and some continuous @xmath159-periodic function @xmath475 [ that of lemma  [ lem12 ] defined in ( [ hopp2,1 ] ) ] , we have @xmath470}{n / b}-\\psi_{\\alpha } ( \\ln n)\\biggr| \\leq\\gamma^{2}+{o}(b^{-1/4})=\\gamma^2 + o(\\varepsilon^5),\\ ] ] whenever @xmath471 .",
    "it follows that @xmath476 & = & \\sum_{\\alpha\\in s}\\psi_{\\alpha}(\\ln n)\\frac{n}{b}f_{\\alpha b}+\\frac { n}{b}\\sum_{\\alpha\\in s}{o}(f_{\\alpha b}\\varepsilon^{5})\\nonumber\\\\ & & { } + { o}(n \\gamma \\ln b)+{o}(\\varepsilon^{2 } n \\ln b ) \\\\ & = & n\\sum_{\\alpha\\in s } \\frac{f_{\\alpha b}}{b}\\psi_{\\alpha}(\\ln n)+{o}(\\varepsilon n).\\nonumber\\end{aligned}\\ ] ] this proves the claim in the lattice case with @xmath257 defined by @xmath477    it now only remains to prove that , although the functions @xmath478 , @xmath441 , are not continuous , the @xmath159-periodic function @xmath257 satisfies the bound in ( [ eqcontinuityphib ] ) .",
    "the function @xmath257 defined in ( [ eqfixedcontinuous ] ) satisfies @xmath479    from the expresssion for @xmath480 in ( [ hopp2,1 ] ) , we have @xmath481 note that , since @xmath420 and @xmath482 , @xmath483 as @xmath484 . as a consequence , for all @xmath254 small enough , the intervals involved in the definition of @xmath480 satisfy , uniformly in @xmath441 , @xmath485 in particular , since @xmath463 almost surely , there is at most one atom in the interval as soon as @xmath486 .",
    "it follows that , if we choose @xmath487 , we have for any @xmath488 such that @xmath489 @xmath490 for some @xmath491 in @xmath492 .",
    "we adopt the following point of view : for fixed @xmath384 and @xmath493 , @xmath494 induces a partition into the intervals @xmath495 , @xmath441 .",
    "each interval contains at most one atom of @xmath375 .",
    "changing @xmath493 into @xmath496 as above modifies the partition , but each atom may only move to an adjacent interval .",
    "all atoms of @xmath141 appear in both sums , except if one is so far that it escapes the range of the partition ( recall that @xmath482 ) .",
    "so following the atoms of @xmath147 rather than the intervals in one or the other partition yields @xmath497 where the second term accounts for the escape of one atom .",
    "it follows that @xmath498 for some constant @xmath251 , by lemma  [ lemmatot ] and the asymptotics for @xmath434 . swapping the sums once again to recover the functions @xmath499",
    ", it follows that @xmath500 however , since every summand is nonnegative , we have for any @xmath293 @xmath501\\\\[-8pt ] & \\le&\\frac{bd } \\mu\\sum_{k\\dvtx kd\\le x } e^{kd - x}\\le\\frac{b e^{d}}\\mu.\\nonumber\\end{aligned}\\ ] ] the desired bound follows : for any @xmath488 such that @xmath502 , we have @xmath503 for some constant @xmath504 independent of @xmath488 or @xmath273 .",
    "the notion of path length we have considered so far is the sum of the depths of the _ items _ in the tree .",
    "this is most natural when one thinks about performance measures for algorithms or sorted data structures .",
    "however , for some applications , it is sometimes important to introduce a related notion of path length @xmath505 , that is the sum of the depths of _ nodes _ : @xmath506 where @xmath507 denotes the number of nodes in the subtree rooted at @xmath6 .",
    "this notion of path length appears , for instance , in the analysis of cutting - down processes .",
    "suppose that you are given a rooted tree @xmath214 .",
    "initially , the process starts with @xmath214 . at each time step ,",
    "a uniformly random edge is cut , the portion of the tree that is disconnected from the root is lost , and the process continues with the portion containing the root .",
    "how many random cuts does it take to isolate the root ?",
    "the question originates in the seminal work of meir and moon @xcite .",
    "recently , the subject has regained interest , and new results have been proved about the weak limit of the number of cuts when the initial tree is randomly picked according to various distributions .",
    "see @xcite for more references and details about the precise models and results .",
    "for instance , holmgren  @xcite has proved that , when the initial tree is a  split tree satisfying two general conditions ( one on @xmath508 $ ] and one on the number of nodes ) , the normalized number of cuttings converges in distribution to a weakly 1-stable law ( theorem 1.1 there ) .",
    "our theorem  [ expectedpath ] allows us to prove that one of the conditions assumed in  @xcite actually implies the other .",
    "more precisely , the conditions assumed in  @xcite are that @xmath509 ( the path length of nodes ) satisfies @xmath510=\\frac\\alpha\\mu n \\ln n + \\zeta n + o(n),\\ ] ] and that the number of nodes @xmath511 verifies , for some constants @xmath512 and @xmath254 , @xmath513=\\alpha n + f(n ) \\qquad\\mbox{where } f(n)=o\\biggl(\\frac n { \\ln^{1+\\varepsilon}n}\\biggr).\\ ] ] we deduce from theorem  [ expectedpath ] :    [ christmas]suppose that @xmath141 is nonlattice , and assume that ( [ eqasymptoticsn ] ) holds true ; then , as @xmath155 , @xmath510=\\frac\\alpha\\mu n \\ln n + \\zeta n + o(n).\\ ] ]    the assumption in ( [ eqasymptoticsn ] ) is just slightly stronger than the estimate proved by holmgren @xcite , that is , that for split tree with nonlattice @xmath367 , we have @xmath514 .",
    "moreover , the assumption in ( [ eqasymptoticsn ] ) does make sense , since it is known to hold , for instance , for @xmath0-ary search trees @xcite : for such random trees , @xmath515 is @xmath516 when @xmath517 and is @xmath518 when @xmath519 . on the other hand",
    ", it is also known that the condition in  ( [ eqasymptoticsn ] ) does not always hold .",
    "for instance , flajolet et al .",
    "@xcite proved that , in the case of binary tries generated by a memoryless source with probabilities @xmath520 such that @xmath521 is a liouville number , then the error term @xmath515 can come arbitrarily close to @xmath522 [ but of course , stays @xmath523 .",
    "see  @xcite , page  249 , and the monograph by baker  @xcite for more information about liouville numbers .",
    "sketch of proof define @xmath524 and @xmath525 by @xmath104=\\frac1 \\mu n \\ln n + n q(n ) \\quad\\mbox{and}\\quad \\mathbf{e}[\\upsilon(t^n)]=\\frac\\alpha\\mu n \\ln",
    "n + n r(n).\\ ] ] let @xmath526 , and note that @xmath527-\\mathbf{e}[\\upsilon{(t^{n})}].\\vadjust{\\goodbreak}\\ ] ] since , by theorem  [ expectedpath ] , @xmath524 converges as @xmath155 , it suffices to prove that @xmath528 also converges to some constant . from ( [ snow ] ) and the assumption in  ( [ eqasymptoticsn ] ) we obtain @xmath529-\\mathbf { e}\\biggl[\\sum_{v\\neq\\sigma } \\biggl(\\alpha n_v+{o}\\biggl(\\frac{n_v}{\\ln ^{1+\\varepsilon } n_v}\\biggr)\\biggr)\\biggr]\\nonumber\\\\[-8pt]\\\\[-8pt ] & = & \\mathbf{e}\\biggl[\\sum_{v } { o}\\biggl(\\frac { n_v}{\\log^{1+\\varepsilon}n_v}\\biggr)\\biggr].\\nonumber\\end{aligned}\\ ] ] [ the constants hidden in the @xmath530 above are the same for every term . ]    consider the subtrees @xmath413 , @xmath240 , introduced in the course of the proof of theorem  [ expectedpath ] .",
    "recall that a node @xmath241 is in @xmath239 if it is the first on its path from the root such that @xmath531 , for some parameter @xmath237 . in the following ,",
    "we take @xmath532 , for @xmath533 .",
    "we now show that the main contribution to  @xmath534 is accounted for by the nodes in the subtrees @xmath247 , @xmath240 ; in other words @xmath535+o(n)$ ] , where @xmath536-\\mathbf{e}[\\upsilon{(t_{r})}|n_r].\\ ] ] to see this , observe that we deduce from ( [ snowy ] ) and ( [ eqasymptoticsn ] ) that @xmath537 & = & \\mathbf{e}\\biggl[\\mathop{\\sum_{v\\notin t_{r } , r\\in r,}}_{{v\\neq\\sigma } } { o } \\biggl(\\frac{n_v}{\\log^{1+\\varepsilon}n_v}\\biggr)\\biggr]\\\\ & = & \\mathbf{e}\\biggl[\\sum_{k\\ge0}\\mathop{\\sum_{v\\notin t_{r } , r\\in r,}}_{{2^{k}\\leq n_v<2^{k+1 } } } { o}\\biggl(\\frac{n_v}{\\log^{1+\\varepsilon } n_v}\\biggr)\\biggr]+ o\\biggl(\\frac n { \\log n}\\biggr).\\end{aligned}\\ ] ] we split the sum in @xmath384 above at some constant @xmath251 to be chosen later . by lemma  [ cardinality ] and since the expected number of nodes @xmath538 with @xmath539 is @xmath540 , we obtain @xmath537 & = & \\sum_{k > k } { o}\\biggl(\\frac{n}{2^{k}}\\cdot\\frac { 2^{k } } { k^{1+\\varepsilon } } \\biggr ) + \\sum_{0\\le k \\le k } { o}\\biggl(\\frac{n}{b}\\cdot\\frac { 2^{k } } { k^{1+\\varepsilon}}\\biggr)+o(n)\\\\ & = & o(n k^{-\\varepsilon})+ o(n k 2^k / b)+o(n).\\end{aligned}\\ ] ] we choose @xmath541 , for some small constant @xmath542 . since @xmath533 was arbitrary , the claim follows .    now since @xmath543 , the proof of proposition [ lemma2 ] ( in the nonlattice case ) may be extended to show that @xmath544=n\\zeta+o(n)$ ] for some constant  @xmath221 .",
    "the details are omitted .      to conclude",
    ", we indicate the lines of the arguments to extend the applicability of our main theorem to a greater family of random trees .",
    "the model of split trees  @xcite supposes that the distribution of the subtree cardinalities @xmath545 of a  node of cardinality @xmath11 is _ exactly _ of the form @xmath546 for a random vector @xmath68 ; in particular , the vector @xmath68 can not depend on @xmath11 .",
    "although many important data structures satisfy this property , some other more combinatorial examples do not ; see , for instance , the case of increasing trees @xcite .",
    "also , the reader might have noticed that our proof does not quite use the full strength of the assumption in ( [ eqmultform ] ) .",
    "indeed , our proof mainly uses two facts : first , that the sequence of subtree sizes along a branch is well approximated by the product form @xmath547 , which modulo some details about @xmath548 , implies that @xmath549 and second , that the addition of some items to the tree only modifies moderately @xmath550 $ ] ( see lemma  [ lemmatot ] ) .",
    "the two requirements are satisfied when the items are distributed in subtrees according to ( [ eqmultform ] ) .",
    "we now indicate why our result would still hold under the much weaker condition that there exists a vector @xmath551 such that the cardinalities @xmath552 of the children of a node of cardinality @xmath11 satisfy @xmath553 as @xmath155 . of course , the copies of the limit vectors @xmath554 at distinct nodes should be independent .",
    "the general shape of trees under this model has recently been completed by work by broutin et al .",
    "@xcite ( see also drmota  @xcite who treats the model of increasing trees by bergeron et al .  @xcite more directly ) .",
    "one should be easily convinced that the relaxed condition in ( [ eqlimitv ] ) should be sufficient for the result to hold :    * proposition  [ lemma1 ] may be extended using the coupling arguments already used in  @xcite , proving that the contribution of the top of the tree to the path length may be estimated using renewal functions associated to the limit vector @xmath21 . * similarly , the extension of proposition  [ lemma2 ] relies on the same coupling argument ( the overshoot there is still approximated by that of the limit vector ) . here",
    ", it is important to note that the proof of smoothness of the path length ( lemma  [ lemmatot ] ) requires the existence of a fixed function @xmath555 such that the size @xmath556 of a `` generalized '' split tree of cardinality @xmath11 satisfies @xmath557 with probability 1 ( at least our proof does ) .",
    "this was already necessary for the results on the shape of the trees in @xcite to hold .",
    "the constraint is not too strong , since it holds as soon as @xmath72 or @xmath76 is nonzero , and any function would do , regardless of its growth .",
    "( this is another reason why the case of digital trees should be treated separately : for such trees , the size of a tree containing two items can be arbitrarily large . ) * as already noted in section  [ seccontraction ] , the part of the proof relative to the contraction method in @xcite will go through as long as the coefficients @xmath182 converge , and the expansion for mean implies their convergence .",
    "we would like to warmly thank svante janson and ralph neininger for very helpful discussions .",
    "we are also grateful to an anonymous referee for his helpful comments ."
  ],
  "abstract_text": [
    "<S> we consider the model of random trees introduced by devroye [ _ siam j. comput . </S>",
    "<S> _ * 28 * ( 1999 ) 409432 ] . </S>",
    "<S> the model encompasses many important randomized algorithms and data structures . </S>",
    "<S> the pieces of data ( items ) are stored in a randomized fashion in the nodes of a  tree . </S>",
    "<S> the total path length ( sum of depths of the items ) is a natural measure of the efficiency of the algorithm / data structure . using renewal theory , </S>",
    "<S> we prove convergence in distribution of the total path length toward a distribution characterized uniquely by a fixed point equation . our result covers , using a unified approach , many data structures such as binary search trees , @xmath0-ary search trees , quad trees , median - of-@xmath1 trees , and simplex trees .    .    . </S>"
  ]
}