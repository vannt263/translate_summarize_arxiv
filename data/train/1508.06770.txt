{
  "article_text": [
    "regime - switching models have been introduced by hamilton  @xcite in discrete time and are among the most popular and effective risky asset models . the regime - switching property is reflected in the changes of states of a markov chain @xmath0 , which stands for the influence of external market factors .",
    "+ european options have been priced in continuous - time regime - switching models by yao , zhang and zhou  @xcite via a recursive algorithm , and in liu , zhang and yin  @xcite using the fast fourier transform .",
    "optimal stopping for option pricing in regime - switching models has been considered in guo  @xcite , guo and zhang  @xcite , le and wang  @xcite , and in ly vath and pham  @xcite with optimal switching .",
    "optimal selling under threshold rules has been dealt with in eloe et al .",
    "@xcite in an exponential gaussian diffusion model with regime switching .",
    "we refer to shiryaev  @xcite and peskir and shiryaev  @xcite for background on the characterization of optimal stopping times and rewards .",
    "+ the problem of selling a stock at the ultimate maximum has been considered by du toit and peskir  @xcite as an extension of the results of shiryaev , xu and zhou  @xcite . in this paper",
    "we extend the result of @xcite to the framework of markovian regime switching .",
    "some of our results are natural extensions of those of @xcite by averaging over the regime - switching component , however the regime - switching case presents notable differences and additional difficulties compared with the classical brownian case . for example",
    ", the optimal boundary functions depend on the regime state of the system , and they may not be monotone if the drift coefficients have switching signs .",
    "in addition we can no longer rely on closed form expressions as in @xcite and instead we use pde arguments , cf .",
    "e.g. lemma  [ equationg ] , that also simplify the original approach .",
    "+ in lemma  [ 1.1 ] we write the optimal value of the problem as a function of time , the regime state , and the relative maximum of the underlying asset . in the general case of real - valued drifts",
    "@xmath1 , @xmath2 , we identify the optimal stopping time @xmath3 in proposition  [ 3.1 ] , and in proposition  [ 3d ] we determine the structure of the optimal stopping set via its boundary functions @xmath4 for @xmath5 in the state space @xmath6 of the regime - switching chain .",
    "+ when the drift parameters @xmath7 of the regime - switching chain are nonnegative we prove the continuity and monotonicity of boundary functions @xmath4 in proposition  [ boundarydec ] , by extending arguments of @xcite to the regime - switching setting .",
    "those results are illustrated in figures  [ fig2 - 3 ] and [ fig3 ] by the plotting of value functions that yield the optimal stopping boundaries .",
    "+ in proposition  [ 2spcase ] we show that immediate exercise is optimal when all drift parameters @xmath8 are negative , @xmath9 , while exercise at maturity becomes optimal when @xmath10 for all @xmath9 , where @xmath11 are the volatility parameters .",
    "+ in proposition  [ bdry ] we derive a volterra type integral equation which is satisfied by the boundary function @xmath4 of the stopping set .",
    "such an equation is difficult to solve because , unlike in the classical setting @xcite , it also relies on the knowledge of the optimal value function , cf .",
    "remark  [ r1 ] .",
    "in addition the associated free boundary problem - consists in a system of interacting pdes that can not be solved without additional assumptions , cf .",
    "e.g. buffington and elliott  @xcite for a solution under an ordering condition on boundary functions in the case of american options . + a treatment of drifts coefficients @xmath12 with switching signs has been proposed in of @xcite via a recursive algorithm that does not rely on a volterra equation . in this case",
    "it turns out that the boundary functions @xmath13 may not be decreasing in @xmath14 $ ] . + we proceed as follows . in section  [ s1 ]",
    "we formulate the optimal prediction problem using optimal value functions . in section  [ ss2 ]",
    "we derive the optimal stopping strategies in terms of the hitting time of the boundary function of a stopping set .",
    "section  [ ss3 ] is devoted to continuity lemmas , which are used to prove the continuity of boundary functions . in section  [ ss4 ]",
    "we also derive the volterra integral equation which is satisfied by the boundary functions when the drift coefficients are nonnegative .",
    "finally we study particular exercise strategies and we present a numerical simulation of boundary functions .",
    "given a standard brownian motion @xmath15 independent of the markov chain @xmath16 , and the filtration @xmath17 generated by @xmath15 and @xmath16 , we consider an asset price @xmath18 modeled by a geometric brownian motion @xmath19 with regime switching driven by a finite - state continuous - time markov chain @xmath16 on @xmath20 , where @xmath21 , and @xmath22 are deterministic functions . in this paper",
    "we deal with the optimal prediction problem @xmath23,\\ ] ] introduced in @xcite for geometric brownian motion , in which the infimum of expected values over all @xmath24}$]-stopping times @xmath25 minimizes the `` regret '' of the stopping decision , where @xmath26 , @xmath27 $ ] .",
    "+ the next lemma  [ 1.1 ] shows that the optimal value function @xmath28 in can be written as a function of @xmath29 , where @xmath30 is defined by @xmath31    [ 1.1 ] the optimal value function @xmath28 in takes the form @xmath32 where the function @xmath33\\times [ 1,+\\infty)\\times { \\cal m}\\rightarrow \\real_+$ ] is given by @xmath34,\\ ] ] @xmath35 , @xmath36 , @xmath37 .",
    "given @xmath38 $ ] , using the drifted brownian motion @xmath39,\\ ] ] we rewrite the solution of as @xmath40,\\ ] ] and define @xmath41.\\ ] ] by the definition of @xmath42 in and expression , and from the conditional independence of @xmath43 with @xmath44 given @xmath0 we have , for any @xmath24}$]-stopping time @xmath25 with values in @xmath45 $ ] , letting @xmath46 , @xmath47=e\\left[\\frac{\\hat { y}_{0,t}}{y_\\tau }   \\vee \\frac{\\hat{y}_{t , t}}{y_\\tau}\\big|{\\cal f}_t\\right]}\\nonumber\\\\ & = & e\\left[\\left(\\frac{\\hat { y}_{0,t}}{y_t}\\ ; \\e^{-\\int_0^{\\tau - t}\\sigma(\\beta_{u+t})d\\hat { b}^t_u}\\right)\\vee \\e^{\\hat { s}^t_{t - t}-\\int_0^{\\tau - t}\\sigma(\\beta_{u+t})d\\hat { b}^t_u}\\big|{\\cal f}_t\\right]\\nonumber\\\\ & = & e\\left[\\left(\\frac{\\hat { y}_{0,t}}{y_t}\\;\\e^{-\\int_0^{\\tau - t}\\sigma(\\beta_{u+t})d\\hat { b}^t_u}\\right)\\vee \\e^{\\hat { s}^t_{t - t}-\\int_0^{\\tau - t}\\sigma(\\beta_{u+t})d\\hat { b}^t_u}\\;\\big|\\;\\beta_t,\\frac{\\hat { y}_{0,t}}{y_t}\\right]\\nonumber\\\\ & = & e\\left[\\frac{\\hat { y}_{0,t}\\vee\\hat{y}_{t , t}}{y_\\tau}\\;\\big|\\;\\beta_t , \\frac{\\hat{y}_{0,t}}{y_t } \\right]\\nonumber\\\\ & = & e\\left[\\frac{1}{{y_\\tau}}\\max\\left(xy_t,\\hat{y}_{t , t}\\right)\\;\\big|\\;\\beta_t \\right]_{x=\\hat{y}_{0,t}/y_t}\\end{aligned}\\ ] ] where the last line follows from the conditional independence between @xmath48 and @xmath49 given @xmath0 .",
    "therefore by definition and expression , we obtain @xmath50\\nonumber\\\\ & = & \\inf_{t\\le\\tau\\le t}e\\left[\\frac{1}{{y_\\tau}}\\max\\left(xy_t,\\hat{y}_{t , t}\\right)\\;\\big|\\;\\beta_t \\right]_{x=\\hat{y}_{0,t}/y_t}\\\\ & = & v \\left ( t\\frac{\\hat{y}_{0,t}}{y_t } , \\beta_t,\\right).\\end{aligned}\\ ] ] -1 cm    in the next lemma we rewrite the optimal stopping problem in the standard form below , using the function @xmath51 ,    \\quad t\\in[0,t ] , \\",
    "i\\in{\\cal m } , \\ x\\geq 1,\\ ] ] with @xmath52 , @xmath36 .",
    "[ v = g ] the function @xmath33\\times [ 1,+\\infty)\\times { \\cal m}\\rightarrow \\real_+$ ] defined by admits the expression @xmath53,\\ ] ] for @xmath38 , j\\in{\\cal m } , x\\geq 1 $ ] , where @xmath54 ,",
    "\\quad x\\geq 1.\\ ] ]    by a conditional independence argument as in the proof of lemma  [ lem1.1 ] , for any @xmath55 $ ] we have @xmath56&=&e\\left[\\frac{\\hat{y}_{0,s}\\vee\\hat{y}_{s , t}}{y_s}\\;\\big|\\;{\\cal f}_s\\right]\\nonumber\\\\ & = & e\\left[\\frac{\\hat{y}_{0,s}\\vee\\hat{y}_{s , t}}{y_s}\\;\\big|\\ ; \\frac{\\hat{y}_{0,s}}{y_s},\\beta_s\\right]\\nonumber\\\\ & = & e\\left[y\\vee\\frac{\\hat{y}_{s , t}}{y_s}\\;\\big|\\;\\beta_s\\right]_{y=\\hat{y}_{0,s}/y_s}\\nonumber\\\\ & = & g\\left(s,\\frac{\\hat{y}_{0,s}}{y_s},\\beta_s\\right).\\end{aligned}\\ ] ] next , we extend the above relation to @xmath24}$]-stopping times @xmath25 written as the limit of a decreasing sequence of discrete stopping times by checking that for any discrete @xmath24}$]-stopping time @xmath57 , @xmath58 $ ] , @xmath59 , by we have @xmath60&=&\\sum_{i=1}^ne\\left[\\frac{\\hat{y}_{0,t}}{y_\\tau}{\\bf 1}_{\\{\\tau = s_i\\ } } \\;\\big|\\;{\\cal f}_\\tau\\right]\\nonumber\\\\ & = & \\sum_{i=1}^ne\\left[\\frac{\\hat{y}_{0,t}}{y_{s_i}}{\\bf 1}_{\\{\\tau = s_i\\ } } \\;\\big|\\;{\\cal f}_{s_i}\\right]\\\\ & = & \\sum_{i=1}^ne\\left[\\frac{\\hat{y}_{0,t}}{y_{s_i}}\\;\\big|\\;{\\cal f}_{s_i}\\right]{\\bf 1}_{\\{\\tau = s_i\\}}\\\\ & = & \\sum_{i=1}^ng\\left(s_i,\\frac{\\hat{y}_{0,s_i}}{y_{s_i}},\\beta_{s_i}\\right){\\bf 1}_{\\{\\tau = s_i\\}}\\\\ & = & g\\left(\\tau,\\frac{\\hat{y}_{0,\\tau}}{y_\\tau},\\beta_\\tau\\right).\\end{aligned}\\ ] ] taking the conditional expectation @xmath61 $ ] on both sides of the above equality , we obtain @xmath62 = e\\left[g\\left(\\tau,\\frac{\\hat{y}_{0,\\tau}}{y_\\tau},\\beta_\\tau\\right)\\;\\big|\\;\\beta_t = j,\\frac{\\hat{y}_{0,t}}{y_t}=x\\right].\\ ] ] by and the conditional independence between @xmath63 and @xmath64 given = 369 @xmath65 we find @xmath66 = e\\left[\\frac{\\hat{y}_{0,t}}{y_\\tau}\\;\\big|\\;\\beta_t = j,\\frac{\\hat{y}_{0,t}}{y_t}=x\\right]}\\nonumber\\\\ & & \\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!=e\\left[g\\left(\\tau,\\frac{\\hat{y}_{0,\\tau}}{y_\\tau},\\beta_\\tau\\right)\\;\\big|\\;\\beta_t = j,\\frac{\\hat{y}_{0,t}}{y_t}=x\\right ] \\nonumber\\\\ & & \\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!=e\\left[g\\left(\\tau,\\frac{(xy_t)\\vee\\hat{y}_{t,\\tau}}{y_\\tau},\\beta_\\tau\\right ) \\;\\big|\\;\\beta_t = j,\\frac{\\hat{y}_{0,t}}{y_t}=x\\right]\\nonumber\\\\ & & \\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!=e\\left[g\\left(\\tau , x_\\tau^{t , x},\\beta_\\tau\\right)\\;\\big|\\;\\beta_t = j\\right],\\end{aligned}\\ ] ] which completes the proof by .",
    "in this section we apply corollary  2.9 in @xcite in the framework of the regime - switching model with @xmath1 , @xmath67 , in order to specify the stopping set and optimal stopping time associated to the optimal stopping problem , cf .",
    "proposition  [ 3.1 ] below . in order to deal with the existence of an optimal stopping time for rewritten as",
    ", we define the set @xmath68\\times [ 1,\\infty ) \\times { \\cal m}\\ : \\",
    "v(t , x , j)=g(t , x , j)\\right\\}.\\ ] ] from the relation @xmath69 , @xmath37 , @xmath36 , we check that @xmath70 , which is consistent with the fact that the infimum in is over @xmath24}$]-stopping times @xmath71 $ ] .    [ 3.1 ] let @xmath38 $ ] . given @xmath72 and @xmath73 , the @xmath24}$]-stopping time @xmath74 is an optimal stopping time for , or equivalently for , provided it is a.s .",
    "finite .    by corollary  2.9 in @xcite",
    "the optimal stopping time for problem exists and is equal to @xmath75 in provided we check that for all @xmath76 $ ] we have :    a.   @xmath77 is lower semicontinuous with respect to @xmath78 , as follows directly from the definition of @xmath77 .",
    "b.   @xmath79 is upper semicontinuous with respect to @xmath78 , as follows from the continuity lemma  [ contlemma ] below .",
    "c.   we have @xmath80<\\infty$ ] . indeed , from and we have @xmath81.\\end{aligned}\\ ] ] hence by and the conditional independence between @xmath82 and @xmath83 given @xmath84 , we find that @xmath85_{y = x_s^{t , x } }    }   \\\\ \\nonumber & = & e\\left[x_s^{t , x}\\vee\\frac{\\hat{y}_{s , t}}{y_s}\\;\\big|\\;\\beta_s , x_s^{t , x}\\right ] \\\\",
    "\\nonumber & = & e\\left[\\e^{-\\int_0^{s - t}\\sigma(\\beta_{u+t})d\\hat{b}_u^t}\\left(\\e^ { \\max \\left (    \\log x,\\sup_{t\\le r\\le s}\\int_0^{r - t}\\sigma(\\beta_{u+t})d\\hat{b}_u^t\\right ) }   \\vee \\e^{\\sup_{s\\le r\\le t}\\int_0^{r - t}\\sigma(\\beta_{u+t})d\\hat{b}_u^t}\\right)\\;\\big|\\beta_s , x_s^{t , x}\\right]\\\\ \\label{g+ } & = & e\\left [ \\e^ { \\max \\left(\\log x,\\;\\hat{s}_{t - t}^t\\right ) -\\int_0^{s - t}\\sigma(\\beta_{u+t})d\\hat{b}_u^t } \\;|\\;\\beta_s , x_s^{t , x}\\right].\\end{aligned}\\ ] ] letting @xmath86,\\end{aligned}\\ ] ] we conclude that @xmath87 = e\\left[\\sup_{t\\leqslant s \\leqslant t } e\\left[\\e^{\\max\\left (    \\log x,\\;\\hat{s}_{t - t}^t\\right ) - \\int_0^{s - t}\\sigma(\\beta_{u+t})d\\hat { b}^t_u}\\;\\big|\\ ; \\beta_s , x_s^{t , x } \\right]\\right]\\nonumber \\\\   & \\le   xe\\left[\\sup_{t\\leqslant s \\leqslant t } e\\left[\\e^{\\hat{s}_{t - t}^t-\\int_0^{s - t}\\sigma(\\beta_{u+t})d\\hat { b}^t_u}\\;\\big|\\ ; \\beta_s , x_s^{t , x } \\right]\\right]\\nonumber \\\\   & \\le   xe\\left[\\sup_{t\\leqslant s \\leqslant t } e\\left[\\e^{\\hat{s}_{t - t}^t-\\inf_{t\\leqslant r \\leqslant t}\\int_0^{r - t}\\sigma(\\beta_{u+t})d\\hat { b}^t_u}\\;\\big|\\ ; \\beta_s , x_s^{t , x } \\right]\\right]\\nonumber \\\\   & =   x e\\left[\\e^{\\hat{s}_{t - t}^t-\\inf_{t\\leqslant r \\leqslant t}\\int_0^{r - t}\\sigma(\\beta_{u+t})d\\hat { b}^t_u}\\right]\\nonumber \\\\   & =   x e\\left[\\e^{\\hat{s}_{t - t}^t-\\check{s}_{t - t}^t }   \\right]\\nonumber \\\\ & \\leq x \\sqrt{e\\left[\\e^{2\\hat{s}_{t - t}^t}\\right ] e\\left[\\e^{-2\\check{s}_{t - t}^t}\\right ] } \\nonumber\\\\ & \\leq x \\e^{\\max_{i\\in{\\cal m}}|\\sigma^2(i)-2\\mu(i)|(t - t ) } \\sqrt{e\\left[\\e^{2\\hat{s}_{t - t}^t}\\right ] e\\left[\\e^{2\\hat{s}_{t - t}^t}\\right ]   } \\nonumber\\\\   & \\leq   x e\\left[\\e^{2\\hat{s}_{t - t}^t}\\right]\\e^{\\max_{i\\in{\\cal m}}|\\sigma^2(i)-2\\mu(i)|(t - t)}\\nonumber\\\\   & < \\infty.\\label{<infty}\\end{aligned}\\ ] ]    -1 cm    define @xmath88 which is nonpositive by , @xmath38 $ ] , @xmath37 , @xmath36 , so that we have @xmath89\\times [ 1,\\infty ) \\times { \\cal m } \\ : \\ f(t , x , j)=0\\right\\},\\ ] ] hence @xmath90 is closed from the continuity of @xmath91 and @xmath92 on @xmath93 \\times [ 1,\\infty ) $ ] , cf .",
    "lemmas  [ contlemma ] and lemmas  [ contlemma1 ] below , respectively .",
    "the continuation set @xmath94 is an open set that can be written as @xmath95\\times [ 1,\\infty ) \\times { \\cal m } \\ : \\",
    "f(t , x , j)<0\\right\\}.\\ ] ] in the next proposition  [ 3d ] we characterize the shape of the stopping set @xmath90 defined in in terms of the boundary function @xmath96 defined by @xmath97 from the relation @xmath98 we deduce the terminal condition @xmath99 , @xmath37 .    [ 3d ] for any @xmath100\\times [ 1,\\infty ) \\times { \\cal m}$ ] such that @xmath101 we have @xmath102 and @xmath103 \\times [ 1,\\infty)\\times { \\cal m }    \\ : \\ y\\ge b_d ( t , j)\\right\\}.\\ ] ]",
    "let @xmath104 \\times \\ { j \\ } \\subset d\\}$ ] .",
    "if @xmath105 then we have @xmath106 by the closedness of @xmath90 , and from the monotonicity property of @xmath107 stated in lemma  [ 3.3 ] , @xmath106 admits a right neighborhood of the form @xmath108 \\times \\ { j \\ } \\subset d\\ ] ] for some @xmath109 , which leads to a contradiction .",
    "hence @xmath110 and holds .",
    "relation follows from the equivalence @xmath111 that follows from .",
    "the following lemma has been used in the proof of proposition  [ 3d ] .    [",
    "3.3 ] for any @xmath101 , we have",
    "@xmath112    we split the proof into two parts .",
    "+ @xmath113 from we have @xmath114 = e\\left[x_s^{t , x}\\vee\\frac{\\hat{y}_{s , t}}{y_s}\\big|{\\cal f}_s\\right]\\\\ & = e\\left [ \\e^ { \\max\\left(\\log x,\\;\\hat{s}_{t - t}^t\\right ) -\\int_0^{s - t}\\sigma(\\beta_{u+t})d\\hat{b}_u^t } \\;\\big|\\;{\\cal f}_s\\right],\\quad s\\in[t , t],\\end{aligned}\\ ] ] which extends to any @xmath24}$]-stopping time @xmath115 $ ] as @xmath116,\\ ] ] as in - above . for all @xmath36 and @xmath117 , consider the @xmath24}$]-stopping time @xmath118\\ ] ] defined by , which solves the optimal stopping problem @xmath119   = e \\left [   g \\left ( \\tau_\\varepsilon^+ , x_{\\tau_\\varepsilon^+}^{t , x+\\varepsilon},\\beta_{\\tau_\\varepsilon^+}\\right)\\ ; \\big| \\ ; \\beta_t = j   \\right],\\ ] ] cf . .",
    "the following argument relies on the fact that for any @xmath101 we have @xmath120 as will be shown in part @xmath121 below .",
    "relations  , , and imply @xmath122\\nonumber\\\\ & = & \\liminf\\limits_{\\varepsilon\\searrow 0}\\frac{1}{\\varepsilon}e\\left[e\\left [   \\e^{\\log ( x+\\varepsilon)\\vee\\hat{s}_{t - t}^t-\\int_0^{\\tau_\\varepsilon^+-t}\\sigma(\\beta_{u+t})d\\hat b_u^t }   -\\e^{\\log x\\vee\\hat{s}_{t - t}^t-\\int_0^{\\tau_\\varepsilon^+-t}\\sigma(\\beta_{u+t})d\\hat b_u^t}\\big|{\\cal f}_{\\tau_\\varepsilon^+}\\right]\\big|\\beta_t = j \\right]\\nonumber\\\\   & = & \\liminf\\limits_{\\varepsilon\\searrow 0 } \\frac{1}{\\varepsilon}e\\left [   \\e^{\\log ( x+\\varepsilon)\\vee\\hat{s}_{t - t}^t-\\int_0^{\\tau_\\varepsilon^+-t}\\sigma(\\beta_{u+t})d\\hat b_u^t }   -\\e^{\\log x\\vee\\hat{s}_{t - t}^t-\\int_0^{\\tau_\\varepsilon^+-t}\\sigma(\\beta_{u+t})d\\hat b_u^t}\\big|\\beta_t = j \\right]\\nonumber\\\\ & = & \\liminf\\limits_{\\varepsilon\\searrow 0}\\frac{1}{\\varepsilon}e\\left [   \\e^{\\log ( x+\\varepsilon)\\vee\\hat{s}_{t - t}^t }   -\\e^{\\log x\\vee\\hat{s}_{t - t}^t}\\;\\big|\\;\\beta_t = j \\right]\\nonumber\\\\ & = & \\frac{\\partial}{\\partial x}e\\left [   \\e^{\\max\\left(\\log x,\\hat{s}_{t - t}^t\\right)}\\;\\big|\\;\\beta_t = j \\right]\\nonumber\\\\ & = & \\frac{\\partial g}{\\partial x}(t , x , j ) ,   \\label{xup}\\end{aligned}\\ ] ] hence we conclude to .",
    "here we used the dominated convergence theorem with the bound @xmath123 where @xmath124 is defined in and the righthand side is integrable as in the derivation of .",
    "+ @xmath121 we turn to the proof of . from the expression in lemma  [ lem1.1 ]",
    ", we have @xmath125\\nonumber\\\\ & = \\inf_{t \\le\\tau\\le t }   e \\left[\\e^{-\\int_0^{\\tau - t}\\sigma(\\beta_{u+t})d\\hat{b}_u^t}\\big(x\\vee \\e^{\\hat{s}_{t - t}^t}\\big)\\;\\big|\\;\\beta_t = j,{\\cal f}_t\\right ] . \\end{aligned}\\ ] ] from and @xmath126 cf .",
    ", we obtain @xmath127_{y = x_r^{t , x+\\varepsilon}}\\nonumber\\\\ & = \\inf_{r\\le\\tau\\le t }   e\\left[\\e^{-\\int_0^{\\tau - r } \\sigma(\\beta_{u+r } ) d\\hat{b}_u^r } \\big ( x_r^{t , x+\\varepsilon}\\vee    \\e^{\\hat{s}_{t - r}^r } \\big)\\;\\big |\\ ; { \\cal f}_r \\right].\\end{aligned}\\ ] ] next , from the definition of @xmath128 and we have , on the event @xmath129 , @xmath130= e\\left[x_r^{t , x+\\varepsilon}\\vee \\e^{\\hat{s}_{t - r}^r } \\;\\big |\\ ; { \\cal f}_r \\right]\\right\\ } \\\\",
    "\\nonumber & \\leq&\\inf\\left\\{r\\geq t \\ : \\ \\ ! \\inf_{r\\le\\tau\\le t }   \\ ! \\ ! \\ !",
    "e\\left[\\e^{-\\int_0^{\\tau - r}\\sigma(\\beta_{u+r})d\\hat{b}_u^r } \\big(x_r^{t , x}\\vee \\e^{\\hat{s}_{t - r}^r}\\big)\\;\\big |\\;{\\cal f}_r \\right]\\geq   e\\left[x_r^{t , x+\\varepsilon}\\vee \\e^{\\hat{s}_{t - r}^r}\\;\\big |\\;{\\cal f}_r \\right]\\right\\ } \\\\",
    "\\nonumber & \\leq&\\inf\\left\\{r\\geq t \\ : \\ \\ ! \\inf_{r\\le\\tau\\le t }   \\ ! \\ ! \\ !",
    "e\\left[\\e^{-\\int_0^{\\tau - r}\\sigma(\\beta_{u+r})d\\hat{b}_u^r}\\big(x_r^{t , x}\\vee \\e^{\\hat{s}_{t - r}^r}\\big)\\;\\big |\\;{\\cal f}_r \\right]\\geq   \\e^{\\varepsilon}e\\left[x_r^{t , x}\\vee \\e^{\\hat{s}_{t - r}^r } \\;\\big |\\ ; { \\cal f}_r\\right]\\right\\},\\end{aligned}\\ ] ] where we applied the inequality @xmath131 @xmath36 , @xmath132 , @xmath133 $ ] .",
    "this implies @xmath134\\geq    \\e^{\\varepsilon}e\\left [ x_r^{t , x } \\vee \\e^{\\hat{s}_{t - r}^r } \\;\\big |\\ ; { \\cal f}_r \\right]\\right\\ } \\\\",
    "\\nonumber & = & \\inf\\left\\{r\\geq t \\ : \\ \\ ! \\inf_{r\\le\\tau\\le t }   \\ ! \\ ! \\ !",
    "e\\left[\\e^{-\\int_0^{\\tau - r}\\sigma(\\beta_{u+r})d\\hat{b}_u^r }    \\big(x_r^{t , x } \\vee \\e^{\\hat{s}_{t - r}^r}\\big)\\;\\big |\\;{\\cal f}_r\\right]\\geq e\\left [ x_r^{t , x } \\vee \\e^{\\hat{s}_{t - r}^r } \\;\\big |\\;{\\cal f}_r \\right]\\right\\ } \\\\",
    "\\nonumber & = & \\inf\\left\\{r\\geq t \\ : \\ \\ ! \\inf_{r\\le\\tau\\le t }   \\ ! \\ ! \\ !",
    "e\\left[\\e^{-\\int_0^{\\tau - r}\\sigma(\\beta_{u+r})d\\hat{b}_u^r}\\big(x_r^{t , x } \\vee \\e^{\\hat{s}_{t - r}^r}\\big)\\;\\big |\\ ; { \\cal f}_r \\right]=e\\left [    x_r^{t , x } \\vee \\e^{\\hat{s}_{t - r}^r } \\;\\big |\\ ; { \\cal f}_r\\right]\\right\\ } \\\\",
    "\\nonumber & = & \\inf \\left\\{r\\geq t \\ : \\ \\ !",
    "( r , x_r^{t , x},\\beta_r)\\in d\\right\\}\\nonumber\\\\ & = & t,\\end{aligned}\\ ] ] since @xmath101 , @xmath65 and @xmath135 .",
    "since @xmath136 we conclude to .",
    "the following property of smooth fit , namely the continuity of the function @xmath137 over the optimal stopping boundary @xmath138 , will be needed in the proof of proposition  [ bdry ] below .",
    "[ sf ] for any @xmath139 , @xmath140 , we have @xmath141    for any @xmath142 , let @xmath143 $ ] , cf . .",
    "since @xmath139 and @xmath90 is closed we have @xmath144 . similarly to to",
    ", @xmath145 converges to @xmath146 a.s .",
    "when @xmath147 tends to 0 . by the same approach as in , replacing @xmath148 with @xmath149 shows that @xmath150 on the other hand , since @xmath151 , we have @xmath152 hence @xmath153 finally the fact that @xmath154 on the closed set @xmath90 implies @xmath155    in the next proposition , which will be used in the proof of proposition  [ bdry ] , we show the normal reflection of the free boundary problem by proving that the right derivative of the value function @xmath156 vanishes at @xmath157 , cf .",
    "also page  264 of @xcite without regime switching .",
    "[ nr ] for any @xmath38 $ ] and @xmath37 we have @xmath158    for convenience of notation we set @xmath159 , and note that @xmath160\\\\ & = \\limsup_{\\varepsilon\\searrow 0}\\frac{1}{\\varepsilon } e\\left [   \\e^{\\log(1+\\varepsilon)\\vee\\hat{s}_{t - t}^t-\\int_0^{\\tau_0 -t}\\sigma(\\beta_{t+r})d\\hat{b}_r^t }   -\\e^{\\hat{s}_{t - t}^t-\\int_0^{\\tau_0 -t}\\sigma(\\beta_{t+r})d\\hat{b}_r^t}\\;\\big|\\;\\beta_t = j \\right ]   \\\\ & = \\limsup_{\\varepsilon\\searrow 0}e\\left[\\frac{1}{\\varepsilon }    \\left (    \\e^{\\log(1+\\varepsilon)\\vee\\hat{s}_{t - t}^t-\\int_0^{\\tau_0 -t}\\sigma(\\beta_{t+r})d\\hat{b}_r^t }   - \\e^{\\hat{s}_{t - t}^t-\\int_0^{\\tau_0 -t}\\sigma(\\beta_{t+r})d\\hat{b}_r^t }    \\right ) { \\bf 1}_{\\{\\hat s^t_{t - t}<\\log(1+\\varepsilon)\\}}\\big|\\;\\beta_t = j\\right]\\\\ & = e\\left[\\limsup_{\\varepsilon\\searrow 0 }   \\frac {   \\e^{\\log(1+\\varepsilon)\\vee\\hat{s}_{t - t}^t-\\int_0^{\\tau_0 -t}\\sigma(\\beta_{t+r})d\\hat{b}_r^t}-   \\e^{\\hat{s}_{t - t}^t-\\int_0^{\\tau_0 -t}\\sigma(\\beta_{t+r})d\\hat{b}_r^t}}{\\varepsilon }   { \\bf 1}_{\\{\\hat s^t_{t - t}<\\log(1+\\varepsilon)\\}}\\big|\\;\\beta_t = j\\right]\\\\ & = 0,\\end{aligned}\\ ] ] since @xmath161 , where we applied the dominated convergence theorem as in the proof of lemma  [ 3.3 ] with the same dominating function as in .",
    "since @xmath156 is nondecreasing in @xmath162 , we have @xmath163 which shows that @xmath164    next we consider the infinitesimal generator @xmath165 of the markov process @xmath166}$ ] , where @xmath167 is the infinitesimal matrix generator of the markov process @xmath168}$ ] , for any sufficiently differentiable function @xmath169 of @xmath170\\times[1,\\infty)\\times{\\cal m}$ ] , cf .",
    "lemma  [ mgenerator ] below .",
    "+ the following lemmas will be used in the proof of proposition  [ 2spcase ] below . in lemma  [ equationg ]",
    "we replace the use of closed form expressions for @xmath171 , which are no longer available in our setting , with the differential expression .",
    "[ equationg ] we have @xmath172,\\ ] ] and @xmath173,\\ ] ] with @xmath174 , @xmath37 , @xmath175 . in particular , for any @xmath176 we have @xmath177 in addition , @xmath171 is nondecreasing and continuous in @xmath146 for all @xmath36 when @xmath178 .    for all",
    "@xmath179 we let @xmath180 ,    \\quad t \\in [ 0,t ] , \\quad y , z > 0.\\ ] ] by and the it formula we have @xmath181 and given that @xmath182=e\\big[\\;\\hat{y}_{0,t}\\;|\\;{\\cal f}_t\\;\\big ] , \\qquad t\\in [ 0,t],\\ ] ] is a martingale and @xmath183}$ ] has finite variation , we find @xmath184 and @xmath185 . substituting into shows that @xmath186 which shows that the function @xmath77 satisfies the pde @xmath187 and we conclude to by .",
    "next we note that follows from @xmath188\\times[1,\\infty)\\times{\\cal m},\\ ] ] cf . the definition of @xmath189 .",
    "next , by and lemma  [ equationg ] , for any @xmath190\\times [ 1,\\infty)\\times { \\cal m}$ ] , we find @xmath191",
    "\\\\ \\label{h2terms } & = e\\left [    x\\sigma^2(j )    { \\bf1 } _",
    "{ \\left\\ { \\hat{y}_{t , t } / y_t < x\\right\\ } }    -\\mu(j)\\left(x\\vee\\frac{\\hat{y}_{t , t}}{y_t}\\right )   \\;\\big|\\;\\beta_t = j\\right ] \\\\",
    "\\nonumber   & = e\\left[x(\\sigma^2(j)-\\mu(j)){\\bf1}_{\\left\\ { \\hat{y}_{t , t } / y_t < x\\right\\}}\\;\\big|\\;\\beta_t = j\\right ] -e\\left[\\mu(j)\\left(x\\vee\\frac{\\hat{y}_{t , t}}{y_t}\\right){\\bf1}_{\\left\\ {    \\hat{y}_{t , t } / y_t \\geq x\\right\\ } } \\;\\big|\\;\\beta_t = j\\right],\\end{aligned}\\ ] ] which shows , and implies by that @xmath171 is nondecreasing and continuous in @xmath76 $ ] when @xmath178 .",
    "the proof of the next lemma , which will be used in proposition  [ 2spcase ] below , extends the argument of @xcite page  993 to the regime - switching setting .",
    "[ h<0 ] we have @xmath192 where @xmath193 is the continuation set .    by lemma  [ mgenerator ] below and",
    "lemma  1 in @xcite we have @xmath194   = g(t , x , j)+e\\left[\\int_t^s    \\mathbb{l}g(r , x_r^{t , x},\\beta_r)dr \\;\\big|\\;\\beta_t = j\\right],\\ ] ] @xmath195 $ ] .",
    "assume now that @xmath196 is such that @xmath197 .",
    "by the continuity of @xmath198 with respect to @xmath146 , there exists an open neighbourhood @xmath199 of @xmath200 such that @xmath201 for all @xmath202 . replacing @xmath203 in with the first exist time @xmath204 of @xmath205 when @xmath206}$ ]",
    "is started at @xmath207 at time @xmath146 , relation   above shows by optional sampling that @xmath208=g(t , x , j)+e\\left[\\int_t^{\\tau_u}\\mathbb{l}g(r , x_r^{t , x},\\beta_r)dr\\;\\bigg|\\;\\beta_t = j\\right].\\end{aligned}\\ ] ] since @xmath209 a.s . and",
    "@xmath210 when @xmath211 , the right hand side is strictly smaller than @xmath77 , while we have @xmath212\\geq v(t , x , j),\\ ] ] showing that @xmath213 , which implies that @xmath214 .",
    "next we derive the following continuity result wich has been used in the proof of proposition  [ 3.1 ] .",
    "[ contlemma ] for any @xmath179 , the mapping @xmath215 is jointly continuous on @xmath93\\times [ 1,\\infty)$ ] .",
    "we proceed in two steps .",
    "@xmath113 we show that the mapping @xmath216 is continuous on @xmath93 $ ] for every fixed @xmath36 and any @xmath179 . by we",
    "have @xmath217\\\\ \\nonumber   & = & \\inf\\limits_{0\\leq\\tau\\leq t - t}e\\left[\\frac{x\\vee \\e^{\\max\\limits_{0\\leq r\\leq t - t}((\\mu(\\beta_r)-        \\sigma^2(\\beta_r ) /2 ) r        + \\sigma(\\beta_r)b_r ) } }    { \\e^{(\\mu(\\beta_\\tau)-        \\sigma^2(\\beta_\\tau ) /2 ) \\tau+\\sigma(\\beta_\\tau)b_\\tau}}\\,\\bigg|\\,\\beta_0=j\\right ]   \\\\",
    "\\nonumber     & = & \\inf\\limits_{0\\leq\\tau\\leq t - t}e\\left[u(t,\\tau)\\,\\bigg|\\,\\beta_0=j\\right ] ,    \\quad    t\\in[0,t ] , \\",
    "j\\in{\\cal m } , \\",
    "x\\in[1,\\infty ) , \\end{aligned}\\ ] ] where @xmath218.\\ ] ] for any @xmath24}$]-stopping time @xmath219 $ ] we have @xmath220     \\\\ \\nonumber & \\leq \\sqrt {    e\\left[\\left(\\e^{\\max\\limits_{0\\leq r\\leq t - t}((\\mu(\\beta_r)-        \\sigma^2(\\beta_r ) / 2 ) r+\\sigma(\\beta_r)b_r ) }      -\\e^{\\max\\limits_{0\\leq r\\leq t - t - s}((\\mu(\\beta_r)-        \\sigma^2(\\beta_r ) / 2 ) r+\\sigma(\\beta_r)b_r)}\\right)^2 \\,\\bigg|\\,\\beta_0=j\\right ] }   \\\\ \\nonumber & \\quad \\times \\sqrt {    e\\left[\\e^{-2(\\mu(\\beta_\\tau)-        \\sigma^2(\\beta_\\tau ) / 2 ) \\tau-2\\sigma(\\beta_\\tau)b_\\tau } \\,\\bigg|\\,\\beta_0=j\\right ] }   \\\\ \\nonumber & \\leq \\sqrt {    e\\left[\\left(\\e^{\\max\\limits_{0\\leq r\\leq t - t}((\\mu(\\beta_r)-        \\sigma^2(\\beta_r ) / 2 ) r+\\sigma(\\beta_r)b_r ) }      -\\e^{\\max\\limits_{0\\leq r\\leq t - t - s}((\\mu(\\beta_r)-        \\sigma^2(\\beta_r ) / 2 ) r+\\sigma(\\beta_r)b_r)}\\right)^2 \\,\\bigg|\\,\\beta_0=j\\right ] }   \\\\ \\nonumber & \\quad\\times \\sqrt {    \\e^ { ( t - t ) \\max\\limits_{i\\in{\\cal m}}|3\\sigma(i)-2\\mu(i)| } e\\left[\\e^{-2\\sigma^2(\\beta_\\tau)\\tau-2\\sigma(\\beta_\\tau)b_\\tau } \\,\\bigg|\\,\\beta_0=j\\right ] }   \\\\ \\nonumber & \\leq \\sqrt {    e\\left[\\left(\\e^{\\max\\limits_{0\\leq r\\leq t - t}((\\mu(\\beta_r)-        \\sigma^2(\\beta_r ) / 2 ) r+\\sigma(\\beta_r)b_r ) }      -\\e^{\\max\\limits_{0\\leq r\\leq t - t - s}((\\mu(\\beta_r)-        \\sigma^2(\\beta_r ) / 2 ) r+\\sigma(\\beta_r)b_r)}\\right)^2 \\,\\bigg|\\,\\beta_0=j\\right ] }   \\\\ \\label{ia } & \\quad\\times \\e^ { ( t - t ) \\max\\limits_{i\\in{\\cal m}}|3\\sigma(i)-2\\mu(i)| / 2 } , \\end{aligned}\\ ] ] where we applied the optional sampling theorem . letting @xmath203 tend to @xmath221 on both sides of , we get @xmath222=e\\big[u(t,\\tau ) \\mid \\beta_0=j\\big],\\ ] ] and since the convergence is uniform on all @xmath223}$]-stopping times @xmath224 $ ] , we obtain @xmath225 \\geq   \\liminf\\limits_{s\\searrow 0}\\inf\\limits_{0\\leq\\tau\\leq",
    "t - t}e\\big[u(t+s,\\tau )   \\mid \\beta_0=j\\big ]    }    \\\\",
    "\\label{fjhksdf }     & = & \\inf\\limits_{0\\leq\\tau\\leq t - t}\\lim\\limits_{s\\searrow 0}e\\big[u(t+s,\\tau )   \\mid \\beta_0=j\\big ] = \\inf\\limits_{0\\leq\\tau\\leq t - t}e\\big[u(t,\\tau )   \\mid \\beta_0=j\\big].\\end{aligned}\\ ] ] next , according to proposition [ 3.1 ] there exists an optimal @xmath223}$]-stopping time @xmath226 $ ] such that @xmath227=e\\big[u(t,\\tau^*_t ) \\mid \\beta_0=j\\big],\\ ] ] hence we have @xmath228 & \\leq    &    \\inf\\limits_{0\\leq\\tau\\leq t - t - s}e\\big[u(t,\\tau ) \\mid \\beta_0=j\\big]\\\\ \\nonumber     & \\leq & e\\big[u(t,\\tau^*_t\\wedge(t - t - s ) ) \\mid \\beta_0=j\\big].\\end{aligned}\\ ] ] since @xmath229 is nonnegative for any @xmath230 $ ] , we have @xmath231}(\\mu(i)-        \\sigma^2(i ) / 2 ) r+\\inf\\limits_{i\\in{\\cal m},r\\in[0,t - t]}(\\sigma(i)b_r)}},\\end{aligned}\\ ] ] which is integrable by . by the reverse fatou lemma we have @xmath232       \\leq       e\\big[\\limsup\\limits_{s\\searrow 0}u(t,\\tau^*_t\\wedge(t - t - s ) ) \\mid \\beta_0=j\\big ]     }     \\\\",
    "\\label{iib } & = & e\\big[u(t,\\tau^*_t ) \\mid \\beta_0=j\\big].\\end{aligned}\\ ] ] combining , , and we find @xmath233 = \\inf\\limits_{0\\leq\\tau\\leq t - t}e\\left[u(t,\\tau)\\,\\bigg|\\,\\beta_0=j\\right].\\ ] ] similarly we have @xmath234 = \\inf\\limits_{0\\leq\\tau\\leq t - t}e\\left[u(t,\\tau)\\,\\bigg|\\,\\beta_0=j\\right],\\ ] ] hence @xmath216 is continuous on @xmath93 $ ] . +    @xmath121 we show that @xmath235 is continuous on @xmath236 , uniformly in @xmath237 $ ] , extending the argument of @xcite page  995 to the regime - switching setting . by relation   and the mean value theorem , for all @xmath238 there",
    "exists a ( random ) @xmath239 $ ] such that for any @xmath223}$]-stopping time @xmath219 $ ] we have @xmath240 since @xmath241 by .",
    "let now @xmath100\\times[1,\\infty)\\times{\\cal m}$ ] and consider @xmath242 given by .",
    "by lemma  [ v = g ] we have @xmath243.\\ ] ] since @xmath244 $ ] is uniformly bounded as in , taking expectation on both sides of yields @xmath245=0,\\ ] ] uniformly in @xmath14 $ ] and in the @xmath223}$]-stopping times @xmath246 $ ] .",
    "since @xmath79 is increasing in @xmath247 , and yield @xmath248 which shows the continuity of @xmath235 , uniformly in @xmath76 $ ] , for all @xmath179 .",
    "+ from @xmath113 and @xmath121 we conclude to the joint continuity of @xmath215 on @xmath93\\times [ 1,\\infty)$ ] by classical arguments .",
    "[ contlemma1 ] the mapping @xmath249 is jointly continuous on @xmath93\\times [ 1,\\infty)$ ]",
    ".    by relation   and the mean value theorem , for all @xmath238 there exists an @xmath250 $ ] such that for any @xmath38 $ ] we have @xmath251 which shows the continuity of @xmath252 , uniformly in @xmath38 $ ] . on the other hand",
    ", we have by that @xmath253 is continuous on @xmath93 $ ] for every @xmath254 .",
    "we conclude to the joint continuity of @xmath249 on @xmath93\\times [ 1,\\infty)$ ] by a classical argument .",
    "we close this section with the following lemma .",
    "[ mgenerator ] the markov process @xmath166}$ ] has the infinitesimal generator @xmath255 @xmath256 $ ] , @xmath37 , @xmath257 , for @xmath258 satisfying @xmath259 .",
    "letting @xmath260 @xmath261 $ ] , @xmath36 , from we have @xmath262 , @xmath261 $ ] , @xmath36 .",
    "since @xmath263}$ ] is nondecreasing it has finite variation , hence @xmath264 which shows that @xmath265 given that @xmath259 for @xmath170\\times[1,\\infty)\\times{\\cal m}$ ] , we have @xmath266 since @xmath267 when @xmath268 , @xmath55 $ ] . from this",
    "shows that @xmath269 and we conclude the proof by it s calculus .",
    "in this section we turn to the solution of the free boundary problem .",
    "we start by providing sufficient conditions on the drift coefficients @xmath270 for the boundary function @xmath96 defined by to be nonincreasing and continuous in @xmath38 $ ] .",
    "the next proposition  [ boundarydec ] relies on lemma  [ ft ] below .",
    "@xmath113 monotonicity .",
    "let @xmath272 and @xmath195 $ ] .",
    "we have @xmath273 and @xmath274 since @xmath107 is nondecreasing in @xmath146 by lemma  [ ft ] , hence @xmath275 \\times \\ { x \\ } \\times \\ { j \\ } \\subset d,\\ ] ] showing that @xmath276 \\times \\{x\\ } \\times \\ { j \\ } \\subset d$ ] .",
    "then for any @xmath277 $ ] , we have @xmath278 since @xmath279 . by proposition  [ 3d ] and noting that @xmath280 , we conclude that @xmath281 .",
    "+ @xmath121 right continuity . given @xmath282 ,",
    "consider a strictly decreasing sequence @xmath283 such that @xmath284 . by part",
    "@xmath113 above we know that @xmath285 , @xmath286 , and @xmath287 .",
    "next , by proposition  [ 3d ] we have @xmath275\\times[b_d(t , j ) , \\infty ) \\times\\{j\\ } \\subset    d,\\ ] ] and since @xmath288 , @xmath286 , and @xmath90 is closed , we have @xmath289 , hence @xmath290 .",
    "+ @xmath291 left continuity . using lemma  [ h<0 ]",
    "we can repeat the argument of @xcite page  998 provided we show that the function @xmath292 defined by @xmath293 is continuous in @xmath76 $ ] for all @xmath37 , with @xmath294 . by lemma  [ equationg ]",
    "the function @xmath171 is nondecreasing in @xmath146 for all @xmath36 since @xmath295 and it follows from the definition of @xmath292 that @xmath296 is nonincreasing in @xmath76 $ ] . for any @xmath297 and decreasing sequence @xmath298 $ ] converging @xmath299 from the righthand side we have @xmath300 and @xmath301 for any @xmath302 , hence @xmath303 as by the continuity of @xmath304 we have @xmath305 and this proves that @xmath306 . on the other hand we have @xmath307 for any @xmath308",
    "$ ] , @xmath271 . in case",
    "@xmath309 we have @xmath310 for all @xmath311 $ ] .",
    "in addition , for any @xmath312 and @xmath313 we have @xmath314 since @xmath315 , hence @xmath316 for all @xmath313 by the continuity of @xmath317 . by lemma  [ equationg ] we would have @xmath318 which shows that @xmath319 , where @xmath320 depends only on @xmath299 and @xmath37 .",
    "this is a contradiction since @xmath321 for @xmath313 can not hold when @xmath322 , and more generally @xmath323 can not have a power law , even locally .",
    "figure  [ fig2 - 3 ] illustrates the result of proposition  [ boundarydec ] by applying the recursive algorithm of @xcite in order to plot the value functions @xmath324 and @xmath325 . in figure",
    "[ fig2 - 3 ] we take the positive drifts @xmath326 , @xmath327 , with @xmath328 , @xmath329 , @xmath330 , @xmath331 , @xmath332 , and @xmath333.\\ ] ]            figure  [ fig2 - 3 ] also allows us to visualize the stopping set @xmath90 and the continuation set @xmath334 \\times [ 1,\\infty ) \\times { \\cal m } \\ : \\",
    "v(t , a , j ) < g(t , a , j )     \\big\\}.\\ ] ] the numerical instabilities observed are due to the necessity to check the equality @xmath335 when @xmath324 and @xmath325 are very close to each other",
    ".      the boundary functions are plotted in figure  [ fig3 ] based on figure  [ fig2 - 3 ] , with spline smoothing .",
    "we observe that starting from state @xmath336 it is better to exercise earlier than if we start from state @xmath337 which has a lower drift .",
    "this is due to the possibility to switch from state @xmath336 to state @xmath337 after the average time @xmath338 and to stay at state @xmath337 for the remaining time @xmath339 , in which case the drift takes the lower value @xmath340 .",
    "the opposite occurs if we start from state @xmath337 , for which the boundary graph is higher than if we start from state @xmath336 .",
    "+ similarly to ( 3.22)-(3.23 ) in @xcite , we now show that @xmath107 defined by is nondecreasing in @xmath76 $ ] for all @xmath37 and @xmath175 , as in the following lemma  [ ft ] which has been used for proposition  [ boundarydec ] , and whose proof follows @xcite page  994 .",
    "+ we note that without the condition @xmath341 for all @xmath9 , the function @xmath107 in lemma  [ ft ] may not be nondecreasing in @xmath76 $ ] , in which case the equivalence @xmath276 \\times \\{x\\ } \\times \\ { j \\ } \\subset d$ ] in the proof of the next proposition  [ boundarydec ] does not hold and in this situation the boundary function @xmath342 may not be decreasing in @xmath38 $ ] , cf .",
    "figure  4 in @xcite .      for any @xmath345",
    "$ ] , and @xmath346 , denote @xmath347 $ ] by the definition of @xmath3 . replacing @xmath203 with @xmath348 and @xmath146 with @xmath349 in the formula , and using optional sampling , we have @xmath350-g(r , x , j ) \\\\",
    "\\nonumber & = & e\\left[\\int_r^{r+\\tau_s}\\mathbb{l}g(v , x_v^{r , x},\\beta_v)dv\\;\\big|\\;\\beta_r = j\\right ] \\\\",
    "\\nonumber & = & e\\left[\\int_0^{\\tau_s}\\mathbb{l}g(v+r , x_{v+r}^{r , x},\\beta_{v+r})dv\\;\\big|\\;\\beta_r = j\\right ] \\\\",
    "\\nonumber & = & e\\left[\\int_0^{\\tau_s}\\mathbb{l}g(v+r , x_{v}^{0,x},\\beta_{v})dv\\;\\big|\\;\\beta_0=j\\right].\\end{aligned}\\ ] ] combining with @xmath351-g(s , x , j )    }    \\\\",
    "\\nonumber   & = &    e\\left[\\int_0^{\\tau_s}\\mathbb{l}g(v+s , x_{v}^{0,x},\\beta_{v})dv\\;\\big|\\;\\beta_0=j\\right ] , \\end{aligned}\\ ] ] we have @xmath352    -e\\left[\\int_0^{\\tau_s}\\mathbb{l}g(v+r , x_{v}^{0,x},\\beta_{v})dv\\;\\big|\\;\\beta_0=j\\right ] \\\\",
    "\\nonumber   & = & e\\left[\\int_0^{\\tau_s}\\mathbb{l}g(v+s , x_{v}^{0,x},\\beta_{v})-\\mathbb{l}g(v+r , x_{v}^{0,x},\\beta_{v})dv\\;\\big|\\;\\beta_0=j\\right].\\end{aligned}\\ ] ] since by the function @xmath353 is nondecreasing in @xmath146 when @xmath341 , we find that the right hand side of is nonnegative , thereby @xmath107 is nondecreasing in @xmath38 $ ] .",
    "a.   immediate exercise . under the condition @xmath354 for all @xmath271",
    ", we have @xmath355\\times [ 1,\\infty ) \\times{\\cal m}$ ] .",
    "b.   exercise at maturity . under the condition @xmath356 for all @xmath271",
    ", we have @xmath357 .",
    "a.   in case @xmath354 for all @xmath271 , by lemma  [ equationg ] , we have @xmath359 for all @xmath360 , hence implies @xmath361 a.s .",
    ", otherwise it contradicts the fact that @xmath362 because of .",
    "this implies @xmath93\\times [ 1,\\infty ) \\times{\\cal m } \\subset d$ ] .",
    "b.   in case @xmath356 for all @xmath271 , by lemma  [ equationg ] we have @xmath363 for all @xmath360 , and applying lemma  [ h<0 ] , we see that @xmath364 , which means @xmath357 .    finally we derive a volterra type equation below satisfied by the function @xmath365 defined in , for the boundary curves @xmath366 \\times [ 1,\\infty )   \\ : \\ x = b_d ( t , j)\\right\\}\\ ] ] of the optimal stopping set @xmath90 in , for any @xmath179 .    [ bdry ] assume that @xmath178 , @xmath271 .",
    "the boundary function @xmath367 satisfies the volterra type equation @xmath368 @xmath35 , with terminal condition @xmath369 , @xmath179 , where @xmath370,\\ ] ] and @xmath371,\\ ] ] for @xmath372 and @xmath36 .    noting that @xmath373 for all @xmath100\\times[1,\\infty ) \\times{\\cal m}$ ] by , the continuation set @xmath374 is given by @xmath375\\times [ 1,\\infty ) \\times { \\cal m } \\ : \\",
    "v(t , x , j)<g(t , x , j)\\right\\}.\\ ] ] according to proposition  [ 3.1 ] , for any @xmath214 , we have @xmath376,\\ ] ] where @xmath377 is defined by . given that @xmath378 by lemma  [ nr ] , by the application of @xcite , chapter  iii , ",
    "7.1.1 ,   7.4.1 as in @xcite   3.5",
    ", page  996 , the function @xmath379 in is @xmath380 in the continuation set @xmath381 in and it solves the cauchy - dirichlet free boundary problem      hence @xmath382 , where @xmath138 denotes the boundary of the open set @xmath381 . by the local time change of variable formula of @xcite , and by lemma  [ mgenerator ] below with the property @xmath378 shown in lemma  [ nr ] above , we have @xmath383=e[v(t , x_t^{t , x},\\beta_t)\\;|\\;\\beta_t = j]}\\nonumber } \\\\ \\label{p31a } & = & v(t , x , j)+e\\left[\\int_t^t\\mathbb{l}v(r , x_r^{t , x},\\beta_r){\\bf 1}_{\\{x_r^{t , x}\\neq b_d(r,\\beta_r)\\}}dr\\;\\big|\\;\\beta_t = j\\right ] \\\\",
    "\\nonumber & &    \\ ! \\ ! \\ ! \\ ! \\ ! \\ ! \\ ! \\ ! \\ ! \\ ! \\ ! \\ !    + \\frac{1}{2 }    e\\left[\\int_t^t\\left (    \\frac{\\partial v}{\\partial y } ( r , x_r^{t , x}+,\\beta_r ) -    \\frac{\\partial v}{\\partial y } ( r , x_r^{t , x}-,\\beta_r)\\right )   { \\bf 1}_{\\{x_r^{t , x}=b_d(r,\\beta_r)\\}}d{\\ell}^b_r(x^{t , x})\\;\\big| \\;\\beta_t = j\\right],\\end{aligned}\\ ] ] where we applied the equality @xmath384 , and @xmath385}$ ] denotes the local time of @xmath386 on the ( piecewise continuous and nonincreasing by proposition  [ boundarydec ] ) curve @xmath387 . by the smooth fit property shown in lemma  [ sf ] above , the last term in vanishes . by proposition  [ 3d ] above and the definition of @xmath96 ,",
    "relation   can be rewritten as @xmath388 , \\",
    "j\\in{\\cal m } , \\ y\\geq 1,\\ ] ] which implies @xmath389=e\\left[\\int_t^t\\mathbb{l}v(r ,",
    "x_r^{t , x},\\beta_r){\\bf 1}_{\\{x_r^{t , x } > b_d(r,\\beta_r)\\}}dr\\;|\\;\\beta_t = j\\right].\\ ] ] hence , combining and , we obtain @xmath390=v(t , x , j)+\\int_t^te\\left[\\mathbb{l } v(r , x_r^{t , x},\\beta_r){\\bf 1}_{\\{x_r^{t , x } > b_d(r,\\beta_r ) \\}}\\;|\\;\\beta_t = j\\right]dr,\\ ] ] and substituting @xmath78 with @xmath96 in above we find that @xmath391-e\\left[\\int_t^t\\mathbb{l}v(r , x_r^{t , b_d ( t , j)},\\beta_r){\\bf 1}_{\\{x_r^{t , x}\\geq",
    "b_d(r,\\beta_r)\\}}dr\\;|\\;\\beta_t = j\\right]\\\\ & = j(t , b_d ( t , j),j)-\\int_t^{t}k(t , r , b_d ( t , j),j)dr,\\end{aligned}\\ ] ] where the functions @xmath392 , @xmath393 are defined by - .",
    "[ r1 ] note that the equation also involves the optimal value function @xmath394 and not only the function @xmath395 . indeed ,",
    "when @xmath396 the equality @xmath397 in for a given @xmath398 does not imply @xmath399 as in @xcite because we may not have @xmath400 for all @xmath401 in the summation over the states of @xmath168}$ ] in the definition of @xmath402 . in @xcite",
    "this issue is dealt with via an ordering assumption on the boundary functions @xmath403}$ ] in the two - state case @xmath404 , see assumption  3.1 therein , however this method applies specifically to american options and not to ultimate maximum problems , which have a more complex payoff structure .",
    "moreover , such an ordering condition may not be satisfied in our current setting , cf .",
    "figure  4 of @xcite .    in the absence of regime switching with @xmath405 ,",
    "relation   is replaced by @xmath406,\\ ] ] and the boundary equation becomes @xmath407-e \\left[\\int_t^{t }    \\mathbb{l } g ( r , x_r^{b_d(t)}){\\bf 1}_{\\left\\{x_r^{t , b_d(t ) } > b_d(r)\\right\\ } } dr \\right],\\ ] ] which recovers ( 3.50 ) in @xcite , with @xmath408,\\;x\\in\\real_+.\\ ] ] since the volterra type equation can not be solved by standard methods under regime switching , we have applied the recursive algorithm of @xcite in order to plot figures  [ fig2 - 3 ] and [ fig3 ] ."
  ],
  "abstract_text": [
    "<S> this paper deals with optimal prediction in a regime - switching model driven by a continuous - time markov chain . </S>",
    "<S> we extend existing results for geometric brownian motion by deriving optimal stopping strategies that depend on the current regime state , and prove a number of continuity properties relating to optimal value and boundary functions . </S>",
    "<S> our approach replaces the use of closed form expressions , which are not available in our setting , with pde arguments that also simplify the approach of @xcite in the classical brownian case .    </S>",
    "<S> * key words : * _ optimal stopping ; ultimate maximum ; regime - switching models ; free boundary problems ; diffusion processes . </S>",
    "<S> _    _ mathematics subject classification ( 2010 ) : _ 60g40 ; 35r35 ; 93e20 ; 60j28 ; 91g80 .    0.7 cm </S>"
  ]
}