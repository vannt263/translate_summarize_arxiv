{
  "article_text": [
    "the density functional theory ( dft)@xcite is very successful in solid state physics and materials science . first - principles calculations based on this theory , using the local density approximation ( lda ) or the generalized gradient approximation ( gga ) , have been well developed and widely accepted as a powerful theoretical tool for explaining and predicting ground state properties and electronic structures of a large amount of materials such as simple metals and band insulators .",
    "however both the lda and gga fail when they are applied to strongly correlated electron systems , a very important class of materials in condensed - matter physics .",
    "these materials contains unfilled d or f shells such as cuprates , manganites , ruthenates , fe - pnictides , plutonium as well as the heavy fermion systems . in the last twenty years",
    ", many efforts have been made to improve the situation , new methods , such as lda+u@xcite , self - interaction corrected ( sic ) lda@xcite and lda plus dynamical mean field ( dmft ) theory@xcite , have been proposed to provide new computational tools for the quantitative study of the strongly correlated materials .",
    "those methods are quite successful in many aspects , nevertheless a method that is practically efficient and can capture the key feature of the correlation effect as well is still absent for the ground state studies .",
    "one of the main features in correlated electron systems is that although the electrons in those narrow 3d or 4f bands are delocalized they still show some atomic features , which manifest itself in the appearance of the hubbard band and the enhancement of the effective mass . in weakly correlated electron systems ,",
    "electron states are delocalized in real space , exhibiting nearly free electron behavior which leads to good energy bands description .",
    "the delocalization feature grants suitable electron density dependent forms for correlation energy as presented in lda and gga since the electron distribution is not far from homogeneous electron gas . however , if electrons exhibit strong localization feature of the atomic orbitals , it is better to describe the electron states in real space .",
    "the presence of strong on - site correlations require proper treatment of atomic configurations , which is orbital dependent and plays important roles in determining the physical property in this case .",
    "methods such as lda+u @xcite and lda+dmft @xcite are proposed as remedies since this orbital - dependent feature is absent in both lda and gga .",
    "these methods start from similar hamiltonians including on - site correlations but operate in different ways .    in lda+u method , the on - site interaction is treated in a static hartree mean field manner , it is suited for strongly correlated systems with long - range ordering , such as the af ordered insulators , but it fails for intermediately correlated metallic systems . in dmft method , the self energy which is purely local in space is obtained in a self - consistent way , which make the lda+dmft method the most accurate and reliable method now",
    ". however , the frequency dependent feature of the self energy makes it very time consuming , and the full charge density self - consistency , which is very important for the accurate total energy calculation , is hard to be achieved .",
    "looking back to the progress of analytical treatment of strongly correlated system , we can notice that the gutzwiller variational approach ( gva ) has been proofed to be quite efficient and accurate @xcite for the ground state studies of many important phenomena , i.e. the mott transition , ferromagnetism and superconductivity .",
    "this approach was first introduced by gutzwiller to study the itinerant ferromagnetism in systems with partially filled @xmath0 bands described by the hubbard model@xcite . in this approach ,",
    "a many body trial wave function was proposed , in which the weights of unfavorable atomic configurations are reduced according to the variational parameters .",
    "both itinerant and atomic features can be described spontaneously by this type of wave functions .",
    "thus , an unified description from weakly to strongly correlated system can be built up by the gva , this grants its capability to accurately capture the essence of correlated systems .",
    "various techniques have been developed to formulate this approach @xcite for different model hamiltonians .",
    "the reliability and feasibility of gva applied to correlated systems have been demonstrated by these theoretical studies .    in this article , we will show that the gva can be naturally combined with the dft . as the result , the lda+gutzwiller ( simply called lda+g hereafter ) method@xcite is proposed for practical calculations of correlated electron systems . to understand the formalism , we will show that a generalized gutzwiller density functional theory ( gdft ) can be established following the same spirit of kohn - sham ( ks ) formalism in the dft .",
    "the gdft itself is rigorous , however , its exchange - correlation functional is unknown . by introducing certain approximation to the exchange - correlation energy in gdft , the lda+g method can be derived , very similar to the lda or lda+u methods derived by approximation to the exchange - correlation term in the ks formalism . in order to show the validity and the advantage of this method",
    ", we will demonstrate that gva is as accurate as dmft for the ground state properties , but computationally much cheaper .",
    "in addition , the present method is fully variational , which guarantees that many of the important physical quantities , such as the force or the linear response can be naturally obtained from the variational principle .",
    "detailed formalism of this method will be explicitly introduced here , and we will also show that a fully charge density self - consistent procedure can be carried out , which is quite crucial for the total energy calculations . furthermore we will also show that lda+g method is easy to be implemented into the existing codes , particularly if the lda+u method is already available .",
    "this paper is organized as follows . in sec .",
    "ii , gva is introduced for a multiband tight - binding hamiltonian .",
    "then we make detailed comparison between gva and dmft results in sec .",
    "the combination of gva with dft and its derivation from gdft will be presented in sec .",
    "iv . in sec .",
    "v , we apply the method to several typical systems and the results will be discussed .",
    "the proofs of some equations are put in the appendix .",
    "we start with the gva for the ground state of correlated electron model systems .",
    "the detailed description of gva has been presented by many authors , here we refer to reference @xcite for the review . for generality",
    ", we consider a model system with a set of localized orbitals , such as @xmath0 or @xmath1 electrons , which can be described quite generally by the multiband hubbard model .",
    "the hamiltonian reads @xcite    @xmath2    and @xmath3 where @xmath4 is combined spin - orbit index of localized orbitals basis @xmath5 on site @xmath6 , @xmath7 ( @xmath8 is orbital number , e.g. @xmath9 for @xmath0 electrons ) .",
    "the first part is just a tight - binding hamiltonian extracted from lda calculation , and the second term is the local atomic on - site interaction in which only density - density correlations are taken into account for simplicity . for generalized on - site interactions",
    ", please refer to ref  @xcite .",
    "we first examine the hamiltonian in atomic limit ( i.e , considering only the @xmath10 term for single site ) .",
    "there are @xmath11 different spin - orbitals and each spin - orbital could be either empty or occupied , thus totally @xmath12 number of multi - orbital configurations @xmath13 .",
    "@xmath10 is diagonal in the space casted by all @xmath14 configurations since the on - site interactions are density - density type .",
    "@xmath15    @xmath16 is the interaction energy of configuration @xmath13 for the @xmath6-th site .",
    "( for general interactions , the atomic part should be diagonalized , and the eigen vectors are linear combination of @xmath13 ) .",
    "of course those possible configurations should not be equally weighted , and electrons tend to occupy those configurations which has relatively lower energy . for this purpose , we could construct projectors which project onto specified configurations @xmath13 on site @xmath6 @xmath17 with the normalization condition , @xmath18 since all the configurations \\",
    "{ @xmath14 } form a locally complete set of basis .    in eq .",
    "( [ eq : multibandh ] ) , if the interactions are not presented , the ground state is exactly given by the hartree uncorrelated wave function ( hwf ) @xmath19 , which is a single determinant of single particle wave functions . however , after turning on the interaction terms , the hwf is no - longer an good approximation , since there are many energetically unfavorable configurations . in a physical view , to describe the ground state better , the weights of those unfavorable configurations should be suppressed .",
    "this is the main idea of gutzwiller wave functions ( gwf ) .",
    "gwf @xmath20 is constructed by acting a many - particle projection operator on the uncorrelated hwf .",
    "@xmath21    the role of projection operator @xmath22 is to adjust the weight of each configuration through variational parameters @xmath23 ( @xmath24 ) .",
    "the gwf falls back to non - interacting hwf if all @xmath25 . on the other hand , if @xmath26 , the configuration @xmath27 on site @xmath6 will be totally removed .",
    "in this way , both the itinerant behavior of uncorrelated wave functions and the localized behavior of atomic configurations can be described consistently , and the gwf will give a more reasonable physical picture of correlated systems than hwf does .",
    "the evaluation of gwf is a difficult task due to its many - body nature .",
    "there are many efforts in the literature , and the most famous one is gutzwiller approximation@xcite , introduced by gutzwiller along with his proposal of gwf . in this approximation , the inter - site correlation effect has been neglected and the physics meaning was discussed in ref  @xcite and ref  @xcite . the exact evaluation of the single - band gwf in one dimension@xcite and in the limit of infinite dimensions@xcite were carried out .",
    "it turns out that gutzwiller approximation is exact in the latter case .",
    "extensions to multi - band correlated systems using gutzwiller approximation were carried out by j. bnemann _ et al .",
    "_ @xcite . meanwhile gutzwiller approximation was proofed to be equivalent to slave - boson theories@xcite on a mean - field level for both one - band case@xcite and multi - band case@xcite .    the expectation value of hamiltonian eq .",
    "( [ eq : multibandh ] ) in gwf is : @xmath28 using the gutzwiller approximation , in the limit of infinite dimensions , according to ref  @xcite we have , @xmath29 where @xmath30 is the weight of configuration @xmath27 , @xmath31 and @xmath32 with @xmath33 , @xmath34 .",
    "( see appendix for details ) .    in order to understand the above gutzwiller results properly ,",
    "it is better to compare it with the hartree - fock scheme .",
    "for this purpose , here we give the hartree - fock expectation value of hamiltonian ( [ eq : multibandh ] ) using hwf @xmath35 , @xmath36 where c is a constant , and @xmath37 , which is proportional to interaction strength @xmath38 , is a correction to the on - site energy ( level shift ) introduced by the static mean field treatment of the interaction term .",
    "comparing eq .",
    "( [ eq : mgutzh ] ) with ( [ e_hfw ] ) , now it is clear that the main differences between the gutzwiller and the hartree approaches are : ( 1 ) there are orbital - related factors @xmath39 in the former associated with the hopping terms , which describe the renormalization of kinetic energy , while the kinetic energy in the hartree approach is not renormalized ; ( 2 ) the interaction energy in the gutzwiller approach is not simply scaled with the interaction strength @xmath38 , but it is related to the configuration weights . while in the hartree approach , the presence of interaction term will contribute simply to the on - site energy correction in proportional to @xmath38 after the mean field treatment .",
    "the total energy under the gwf can be obtained by minimizing eq .",
    "( [ eq : mgutzh ] ) with respect to configuration weights @xmath30 , which now in fact are variational parameters .",
    "since more variational parameters are presented in this approach , the obtained ground state total energy is much better than that in hwf . in other words , by using the gwf , the obtained ground state total energy is further reduced due to the reduction of interaction energy , but in the cost of kinetic energy .",
    "the balance of two ( _ gain _ and _ cost _ ) is achieved by the energy minimization with respect to variational parameters .",
    "for the convenience of our following discussions , here we would like to generalize the formalism and make several definitions .",
    "any operator @xmath40 acting on the gwf , can be mapped to an corresponding gutzwiller effective operator @xmath41 which acts on the hwf ( rather than gwf ) , requiring that its expectation values is kept as the same , @xmath42 here we have , @xmath43    if the operator @xmath40 is a single - particle operator , such as @xmath44 ( where @xmath45 ) , then similar to the above procedure for the evaluation of kinetic energy in eq .",
    "( [ eq : mgutzh ] ) , its gutzwiller effective operator ( in gutzwiller approximation ) can be written as , @xmath46 where again @xmath47 are orbital dependent renormalization factors , which are determined through the configuration weights presented in the projector @xmath22 . here",
    "please note that the diagonal term and the hopping term should be treated separately ( see the appendix ) .    following the above general definition",
    ", we can now define an gutzwiller effective hamiltonian @xmath48 which acts on hwf , @xmath49 such that the following equation holds , @xmath50 here the kinetic part @xmath51 can be written out according to eq .",
    "( [ eq : oneparticleoperator ] ) , and the interaction part is @xmath52 for the density - density type interaction as discussed above .",
    "now we are coming to a stage that we can solve the gutzwiller problem easily through energy minimization . in practice",
    ", the minimization procedure will be done iteratively with each loop being divided into two steps .",
    "the first step is to fix the gutzwiller variational parameters @xmath53 and find the optimal hwf . as we know",
    "the @xmath54 for given @xmath53 , which is non - interacting , this step can be easily done by diagonalize it and fill the corresponding bands up to the fermi level . then in the next step",
    ", we will fix the hwf and optimize the energy respect to all the gutzwiller variational parameters @xmath53 .",
    "the explicit equation can be written as : @xmath55 + e_{i\\gamma}=0    \\end{split}\\ ] ] in this second step of calculations , for the lattice model with crystal periodicity , usually additional constrains can be adopted : ( 1 ) there is no site - dependency for @xmath47 factors and occupation number @xmath56 , i.e , @xmath57 and @xmath58 ; ( 2 ) the charge on each orbital should be kept to be the same as that obtained by hwf ( for pure density - density interaction as discussed in @xcite ) , in other words we have : @xmath59 when all @xmath30 are obtained , go back the first step to construct an new effective gutzwiller hamiltonian again . by this recursive method , all parameters @xmath30 and @xmath60 can be obtained self - consistently .    typically , the second step of variations , i.e. the optimization of @xmath30 , is not so easy for multi - band systems , because a large number of non - linear equations need to be solved spontaneously .",
    "fortunately , following the steps described in our previous publication  @xcite , we are able to transfer the non - linear equations into linear equations set , and furthermore a so called `` adiabatic solution searching '' procedure can be adopted",
    ". those techniques will greatly reduce the computational cost and stabilize the calculations .",
    "in this section , we will compare the results obtained by the gva and that by the dynamical mean field theory ( dmft ) for the single and two bands hubbard model . with the careful comparison of kinetic energy , interaction energy and quasi - particle spectrum",
    ", we are going to clarify the following important issue : can the gutzwiller approximation ( ga ) capture the important incoherent motion  of the correlated - electrons or not ?",
    "this problem is considered to be the biggest shortcoming of ga , which prevents it to be widely used in the first - principles calculations of strongly correlated materials . as we will show below",
    ", the ga can definitely capture the effect of incoherent  motion in the ground state by its multi - configuration nature , which leads to very good agreement with the dmft ground state results for both the kinetic and interaction energies . while the situation is not as good for the excited states , since the variational parameters in the ga are determined by optimizing only the ground state energy , not that of excited states .",
    "therefore , ga is a much better approximation for the ground state than for excited states . within the frame of ga",
    ", it is difficult to construct the high energy excited states corresponding to the upper and lower hubbard bands .",
    "that is why in the green s function obtained by ga , we only have quasi - particle part and no hubbard bands . while the problem only exists for the high energy excited states not for the ground state and the low energy quasi - particle states .",
    "we start from the multi - band hubbard model ( [ eq : multibandh ] ) , for the clarity we only keep the intra - orbital hoping @xmath61 and neglect the on - site energy @xmath62 in the following ( restoring them does not change the conclusions ) . to describe quasi - particle states ,",
    "an important physical quantity is @xmath63-factor . actually , there are two different definitions of @xmath63 in literature .",
    "the first one is the renormalization factor of the effective band width for the quasi - particles , the second one is the weight of the coherent part in the electron green s function near fermi surface . as we will show below , in ga the @xmath63-factors obtained by the above two definitions match each other , while in dmft they are quite different . in the following comparison ,",
    "we compute @xmath63 within dmft by @xmath64 , which is quasi - particle weight . while in ga calculation we define @xmath65 .    under gutzwiller approximation ,",
    "the quasi - particle states and quasi - hole states can be expressed as@xcite    @xmath66    with the above trial wave function , the excitation energy can be calculated as    @xmath67    for quasi - particle ( quasi - hole ) excitations .",
    "the above equation can be evaluated by ga as shown in appendix , which leads to a simple expression of green s function , @xmath68 with @xmath69being the weight of the coherent part spectrum , which can also be evaluated to be equal to @xmath70 under ga as shown in appendix .",
    "therefore within ga the quasi - particle weight coincident with the renormalization factor of the kinetic energy , thus dynamical informations are captured by variational approach .",
    ", width=302 ]    .",
    "[ 1.0 ]    = 0.9.,width=302 ]    = 0.8.,width=302 ]        in fig .",
    "[ 1.0]-[2band ] , we compare the kinetic energy , interaction energy and @xmath63 -factor from ga and dmft calculations .",
    "we choose the non - interaction density of state to be @xmath71 , which corresponds to bethe lattice with infinite connectivity .",
    "anderson impurity model in dmft is solved by lanczos method , which gives essentially exact results . as could be seen in fig .",
    "[ 1.0]@xmath72[2band ] , gva captures ground state energies quite well for almost all correlation strength and band fillings .",
    "although as a variational approach it targets at total energy and does not ensure the correctness of kinetic and interaction energy in principle , we still observe quite good coincidence of kinetic and interaction energy respectively .",
    "we also notice that as the band degeneracy increase there is further coincident between ga and dmft results as shown in the fig.4 for two band case .    for half - filling @xmath73",
    "where there is mott insulator transition for large @xmath38 , the introduction of ga further neglects spatial correlation and under - estimate the absolute value of kinetic energy ( fig .",
    "[ 1.0 ] ) . in mott phase",
    ", ga gives vanishing double occupancy , while dmft result always shows finite double occupancy due to spatial fluctuation .",
    "the flaw at large @xmath38 could be traced back to the fact that the starting wave function of gutzwiller projection is uncorrelated fermi liquid state @xmath74 .",
    "this fact is also part of the reasons for the important shortcoming of ga : it miscaptures the high energy excited states ( seen from the overestimate of @xmath63-factor in fig .",
    "[ 1.0]@xmath72[2band ] for large @xmath38 ) .",
    "for all interaction strengths and band fillings , @xmath63-factor from ga is larger than dmft treatment , _",
    "i.e. , _ the method gives more weight to low energy coherent part .",
    "nevertheless , we recently demonstrated  @xcite that this overestimation of @xmath63-factor can be further corrected by properly taking into account the contribution from excited states ( namely the incoherent motion of electrons ) .    to conclude this section",
    ", we make the assertion that as a cheap tool for correlated systems ga has fairly good energy resolution , particularly good for the ground state total energy with dynamical information included , but careful must be taken when dynamical information associated with high energy excitations is trying to be extracted from the ga results .",
    "in this section , we will discuss how we can combine the dft with the gva .",
    "the discussions will be separated into three parts .",
    "the detailed formalism of lda+g method are explicitly derived in the first part , which are used in realistic calculations . in the second part ,",
    "we first introduce a general gutzwiller density functional theory ( gdft ) , and then we derive the lda+g formalism from the firm base of gdft . in such a way",
    ", we demonstrate the rigidity of this method .",
    "finally , in the third part , we will discuss the on - site interactions and the double counting term .      as we discussed above , the strong on - site correlation",
    "is underestimated in lda . for those strongly correlated materials , in which the correlations play very important roles in determine the electronic structure ,",
    "this underestimation may lead to qualitative mistakes .",
    "one common procedure to overcome this problem is that we treat the interactions more explicitly on top of lda level , just like what has been done in lda+u or lda+dmft schemes .",
    "the starting effective hamiltonian is usually written as : @xmath75 where @xmath76 is the lda part hamiltonian extracted from the standard lda calculation , @xmath77 is the on - site interaction term , and @xmath78 is the double counting term representing the average orbital independent interaction energy already included by lda .",
    "both lda+u and lda+dmft methods start from the same hamiltonian as shown above , however they treat the problem in different ways . in the lda+u scheme ,",
    "hartree like mean field approximation is used to solve the above hamiltonian , which can capture the orbital dependent physics ( which is absent in lda ) , but the dynamical correlation is still not included .",
    "while in the lda+dmft method , the purely local self energy is evaluated by solving an effective quantum impurity model mapped from the original lattice model . with the frequency dependent self energy , not only the ground state properties but also the dynamical response around the equilibrium can be considered by lda+dmft .",
    "because of the frequency dependency of the self energy , the lda+dmft is quite expensive in computational time . in many applications , we are only interested in the ground state properties and it is quite important to develop a new computational method for correlation materials , which is as fast as lda+u and can capture the dynamical correlation effect as well for the ground state .    as we have proposed in the previous paper @xcite , an alternative way to solve the problem is to use gutzwiller wave function rather than single determinant hartree wave function .",
    "this approach is much cheaper than dmft , but its quality is as good as dmft for the ground state determination ( as been shown in the last section ) , because it can capture the dynamical correlation effect due to the multi - configuration nature of the gutzwiller wave function .",
    "more importantly , this approach is fully variational , and can be easily combined with the dft as will be discussed below .",
    "now the goal is to solve the hamiltonian  ( [ lda++ ] ) by the gva . for this purpose",
    ", we need to discuss the hamiltonian in more detail . since the problem to be addressed here is generally orbital - dependent",
    ", the effective hamiltonian should be written in a set of complete orbital basis , which are always available , such as wannier functions or atomic orbitals .",
    "these orbitals can be denoted by @xmath79 , in which @xmath6 is site index , @xmath80 is spin - orbital index and @xmath81 is the corresponding creation operator .    following the basic idea of lda+u or lda+dmft approaches , the @xmath76 term in the effective hamiltonian  ( [ lda++ ] ) is regarded as single - particle operator , it can be therefore expressed in terms of a complete set of orbitals as @xmath82 suppose all the orbitals on the same site are correlated , and the interaction term can be written as @xmath83 in which @xmath84 .",
    "now it is easy to see that the effective hamiltonian  ( [ lda++ ] ) has the same form as that shown in hamiltonian  ( [ eq : multibandh ] ) .",
    "( please note the double counting term only contribute to a constant uniform shift , and has no orbital - dependency , as will be addressed in the later part ) . then following the steps discussed in the section i",
    ", we will be able to solve the problem .",
    "this is the scheme used in most of post - lda techniques , where a tight - binding fit to lda results are first obtained , and then local orbital dependent interaction terms are implemented and the problem with interaction should be solved by some many - body techniques .",
    "we can therefore call the above procedures as post - lda plus gutzwiller approaches , which has been recently used for several examples  @xcite .    however , our intention is to develop a complete lda+g method with full charge self - consistency and without tight - binding fitting .",
    "two important factors have to be considered for this purpose : ( 1 ) realistic materials consist of non - strongly - correlated bands as well , which can be treated nicely by lda , and those strongly - correlated bands , which require the gutzwiller step . proper separation of two sets of energy bands is therefore necessary ; ( 2 ) full charge density self - consistency need to be considered",
    ". these will be the main points for our following discussions .",
    "we first divide the complete orbital basis into localized and extended orbitals , and the interactions are added only for localized orbitals , for example @xmath0 or @xmath1 orbitals in transition metal or rare earth compounds .",
    "the localized and extended orbitals are labeled by \\{@xmath85 } and @xmath86 respectively , and the completeness of orbital basis requires that : @xmath87 under the representation of this basis set , the @xmath76 reads @xmath88    as discussed in section i , the gwf @xmath89 is constructed from the hwf @xmath90 with proper projection .",
    "any operator acting on gwf can be mapped to an gutzwiller effective operator which acts on hwf instead . since @xmath76 only consists of single particle operators , following the definition in eq .",
    "( [ definition_g ] ) , its corresponding gutzwiller effective hamiltonian can be written as , @xmath91 to derive this gutzwiller effective hamiltonian , it is essential to understand that for those non - interacting orbitals , the corresponding renormalization fact @xmath92 is equal to 1 .",
    "this formula could be further simplified using the completeness condition  ( [ eq : localcompleteness ] ) @xmath93 and the interaction energy is given as , @xmath94    now it is clear that the complete basis set defined at beginning is actually not necessary for realistic calculations , because only the localized orbitals @xmath95 appear in the above equation . the interaction term are also defined only for those localized orbitals .",
    "we then come to a stage very similar to lda+u , where localized orbitals are defined and interaction within those orbitals is supplemented .",
    "what is in additional to lda+u scheme is that the kinetic energy of each local orbitals is renormalized by factor @xmath47 which need to be determined in terms of configuration weights and configuration energy through the variational approach as shown below .    in realistic calculations for solid crystals , it is more convenient to carry out the calculations in reciprocal space , especially for those plane wave methods .",
    "the transformation to the reciprocal space is quite straightforward , because the gutzwiller approximation keeps the translational symmetry unbroken .",
    "we first define the bloch states of localized orbitals @xmath96 @xmath97 then the gutzwiller effective hamiltonian @xmath98 in @xmath99-space can be written as , @xmath100 let s define the projector @xmath101 which projects onto the bloch state of localized orbital , then the projection to the remaining delocalized orbitals is taken into account by @xmath102 . for convenience , here we also define another projector @xmath103",
    ". then we have @xmath104    the total energy is obtained by evaluating the expectation value of the hamiltonian , @xmath105 in which @xmath106 , @xmath107 , and @xmath108 is the double counting energy .",
    "now the remaining task is to minimize the total energy functional with respect to variational parameters : uncorrelated wave function @xmath74 and atomic configuration weight @xmath53 . very similar to the familiar kohn - sham equation , the uncorrelated wave function @xmath74 in the periodic lattice can be written as a simple slater determinant of single particle wave functions @xmath109 .",
    "two sets of variational equations can be derived from minimization of eq .",
    "( [ eq : totalenergy_g ] ) with respect to @xmath109 and @xmath53 , respectively . for the variation with respect to @xmath109",
    ", please note that the orbital occupation number @xmath110 also depends on @xmath109 inexplicitly .",
    "@xmath111|\\psi_{nk}\\rangle\\\\ = & \\epsilon_{nk}|\\psi_{nk}\\rangle\\end{split } \\label{eq : evar_psi_nk}\\ ] ] @xmath112 in which @xmath113 when deriving this equation , the following relation is used @xmath114 there are several constraints .",
    "the wave functions should be orthogonal and normalized , the total configurations weight must be unity , and for pure density correlations the local densities will not be changed in gva : @xmath115 through the above steps , we will be able to solve the problem for fixed lda hamiltonian @xmath76 .",
    "now the question is how can we achieve self - consistency in the charge density .",
    "this step is very crucial , and the reason is the following . as we discussed above , all electrons ( both delocalized and localized ) should be included in realistic calculations",
    ". however those delocalized orbitals are treated in lda level , and localized states are treated by the lda+g step .",
    "the modification of the localized state will in return affect the charge distribution of all other delocalized state , particularly the charge transfer process between the delocalized and the localized orbitals may happen .",
    "this is of course important physics .",
    "if it is not treated properly , different conclusions may be drawn , as already discussed in the example studies for na@xmath116coo@xmath117  @xcite , where several post - lda plus dmft studies give different results .",
    "the charge density self - consistency can be achieved easily as long as the charge density can be constructed , because the lda hamiltonian is determined by the electron density . in the present lda+g scheme ,",
    "the electron density can be constructed from the gutzwiller wave functions by : @xmath118 since @xmath119 is also a one - particle operator , similar to previous steps , with the help of eq .",
    "( [ eq : oneparticleoperator ] ) we have @xmath120 or we can write down the expression in the momentum space with the following simple expression , @xmath121    eq .",
    "( [ eq : evar_psi_nk ] ) , ( [ eq : evar_m_nk ] ) together with eq .",
    "( [ eq : zfac ] ) and ( [ eq : density_oper_g ] ) provide a self - consistent scheme , which is named lda+gutzwiller method by us .",
    "( [ eq : evar_psi_nk ] ) is similar to the ks - equation in lda or gga , except that the hamiltonian has been replaced by the corresponding effective gutzwiller one with orbital - dependent terms .",
    "( [ eq : evar_m_nk ] ) , which is used to determine the configuration weight , and eq .",
    "( [ eq : zfac ] ) , which determine the factors @xmath122 , are newly introduced by gva .",
    "we illustrate our schematic self - consistent loops for lda+g method in fig .",
    "[ fig : flowchartsforldag ] . two main steps in this scheme",
    "are : ( 1 ) for fixed factor @xmath122 , solving the kohn - sham - like equation to get uncorrelated wave function @xmath123 .",
    "( 2 ) for fixed @xmath123 , calculate the configuration weights @xmath53 and then obtain factor @xmath122 .",
    "the iteration loops end when both electron density and renormalization factors are self - consistent .",
    "this scheme could be easily implemented in all kinds of existing _ ab initio _ codes , no matter what kinds of basis set are used for the wave - function , because the essential computational requirement is just the calculations of projection to some local orbitals .",
    "if the lda+u method is already available in the original code , the implementation of lda+g method will be much easier , since the local orbitals defined in lda+u can be also used in the lda+g formalism .",
    "after the charge density self consistency has been achieved , the ground state properties such as the stable crystal structure , magnetic structure as well as the elastic properties can be calculated , which is quite similar with the standard lda procedure . besides that",
    ", we can also obtain the density of states by lda+g . because the band dispersion @xmath124 obtained by lda+g is for the quasi - particle excitations , we can derive two types of density of states ( dos ) from the lda+g band structure .",
    "the first one is the quasi - particle dos , which can be expressed as @xmath125 experimentally the electronic part of the low temperature specific heat is directly determined by the quasi - particle dos and thus can be estimated by lda+g for correlated materials .",
    "another type of dos is the integrated electronic spectral function , which is called electron dos in lda+g . using @xmath122 obtained by the gutzwiller approximation",
    ", the weight of the quasi - particle peak at @xmath124 appearing in the electronic spectral function can be expressed as @xmath126 then the electron dos can be obtained by the summation over all @xmath99 , which reads @xmath127    as we mentioned in the previous section , only the coherent parts(quasi - particle peaks ) can be captured by lda+g not the incoherent parts ( hubbard bands ) .",
    "the electron dos in lda+g corresponds to the low energy part of the photo emission spectrum , which is mainly determined by the quasi - particle dynamics .    in the end",
    ", we would like to comment on the relationship between lda+g method and lda or lda+u .",
    "first it can be easily figured out that , lda+g method falls back to dft - lda method spontaneously in non - correlated systems .",
    "this can be seen from the multi - band hubbard model in which on - site interactions go to zero , then no configuration is energetically unfavorable and gwf falls back to hwf .",
    "in lda+g method , this case means that the supplemented on - site interaction energy and double - counting term are zero , then all localized orbitals are really delocalized and the corresponding renormalization parameters are @xmath128 .",
    "the formalism falls back exactly to dft - lda .",
    "lda+gutzwiller method can also cover the lda+u method when applying to strongly correlated insulators with long range ordering , in which lda fails while lda+u makes its success .",
    "actually this is quite easy to be understood . in the strongly correlated insulator with long range ordering and integer occupation , such as the anti - ferromagnetic phase in the half filled hubbard model , the unit cell",
    "is doubled by the af order , which greatly reduces the local fluctuation among the atomic configurations and thus increases the z - factor to be close to unity . again in the @xmath129=1 limit , the gwf returns back to hwf , the lda+g energy functional is equivalent to that of lda+u when the @xmath129-factors approach one .      in the last section ,",
    "we have derived the lda+g method in a physical but yet not rigorous way . in this section , however , we will derive the lda+g method from a sound base .",
    "we will first introduce a gutzwiller density functional theory ( gdft ) , which is rigorous and exact , just like the kohn - sham ( ks ) formalism developed from the density functional theory ( dft ) . in the ks formalism , as long as we know the functional of exchange - correlation energy @xmath130 , we can solve the ground state problem .",
    "this is also true for gdft , where we have @xmath131 in its rigorous form instead of @xmath130 .",
    "of course , exact @xmath131 is unknown , and certain kinds of approximation have to be used in realistic calculations . in the ks formalism , if the lda is used for the @xmath130 ( @xmath132 ) , then the lda - ks type formalism is realized ; in addition , if lda+u approximation is used for the @xmath130 ( @xmath133 ) , the lda+u method can be obtained .",
    "we will show here that the lda+g method can be actually regarded as a `` _ lda+u approximation in gdft formalism _ '' , where lda+u type approximation is used for the exchange correlation term .",
    "we will first establish the gdft , then we derive the lda+g formalism from the firm base of gdft .",
    "it is helpful to recall the basis of dft first .",
    "the hohenberg - kohn ( hk ) theorem@xcite shows that the total energy of a interacting electron system can be defined as a universal functional in terms of electron density @xmath134 .",
    "the ground state energy is the global minimum of the functional .",
    "the electron density that minimizes the functional is the exact ground state electron density .",
    "the equations are written as @xmath135 & = & \\langle\\psi\\vert h\\vert\\psi\\rangle = t[\\rho]+e_{int}[\\rho ]   \\nonumber \\\\ \\rho & = & \\langle\\psi\\vert \\hat{\\rho } \\vert\\psi\\rangle \\label{eq : hk}\\end{aligned}\\ ] ] where @xmath136 is the ground state many - body wave function , @xmath137 is the kinetic energy , and @xmath138 is the interaction energy . at this stage for simplicity , the energy due to external potential are not included in the formula ( it will be supplemented later ) .",
    "this theorem is exact , but can not be used directly since the explicit form of this functional is unknown .",
    "this problem can be transferred to a equivalent kohn - sham ( ks ) problem by using the well - known kohn - sham _ _",
    "ansatz__@xcite , which is now become one of the most important basis of first principle electronic structure calculations for solid states . in this",
    "_ ansatz _ , a reference system is introduced , whose exact hamiltonian is still unknown , but we know that its ground state wave function can be exactly written as the hwf @xmath35 .",
    "( therefore , the reference system here is actually a non - interacting system because we know that its wave function is @xmath35 ) .",
    "as long as the charge density of the reference system @xmath139 matches the true ground state charge density ( i.e , @xmath140 ) , then from the hohenberg - kohn dft , the total energy of the true system can be reproduced through the reference system , @xmath141=&e^{ks}[\\rho^0]=t^{ks}[\\rho^0]+e_h^{ks}[\\rho^0]+e_{xc}^{ks}[\\rho^0 ] \\\\           = & \\langle\\psi_0|\\hat{t}|\\psi_0\\rangle + e_h^{ks}[\\rho^0]+e_{xc}^{ks}[\\rho^0 ] \\\\    \\rho=&\\rho^0=\\langle\\psi_0\\vert \\hat{\\rho } \\vert \\psi_0\\rangle \\end{split}\\ ] ]    the ks kinetic energy @xmath142 and the hartree energy @xmath143 of the reference system is different with the true kinetic and interaction energy , @xmath137 and @xmath138 , but importantly their functional forms are known .",
    "ks s idea is simply to re - organize the total energy expression , such that those known parts can be treated explicitly and all unknown parts are moved into the third term called exchange - correlation energy @xmath130 .",
    "it is in this sense that ks formalism is still exact for the ground state total energy .",
    "the merit of ks formalism is that the problem is solvable as long as the functional form @xmath130 is known . by definition ,",
    "the exchange - correlation energy is given as , @xmath144 where two contributions should be physically included : ( 1 ) the correction to the kinetic energy @xmath145 ; ( 2 ) the correction to the interaction energy @xmath146 .    the ks formalism up to now is exact , however certain kinds of approximations have to be made for @xmath130 in realistic calculations , as will be discussed below .",
    "nevertheless , here we want to put a note for the reference system .",
    "once the approximation has been introduced for the exchange - correlation term @xmath130 , the nature of the reference system may be modified . in reality , if the lda+u approximation is used for the exchange - correlation potential in ks formalism , the reference system is no - longer non - interacting , and the @xmath35 is just a approximate wave function .      here we can establish a exact gutzwiller density functional theory ( gdft ) in parallel to ks formalism .",
    "one can see from ks formalism that , taking a non - interacting system as reference is not a necessity .",
    "what is really important is to know the exact form of the wave - function of the reference system , such as @xmath35 in ks .",
    "the main benefit of this strategy is that in the reference system the kinetic operator can be evaluated explicitly in quite a simple form . in the spirit of kohn - sham _",
    "ansatz _ , any systems can be taken as reference providing that it has the same electron density as the true system .",
    "we can theoretically formulate the exact gutzwiller density functional theory ( gdft ) , similar to ks , as follows .",
    "\\(1 ) to replace the original difficult interacting many - body system , we choose a auxiliary reference system , whose exact hamiltonian is still unknown , but we know that its ground state wave function is given as the gutzwiller wave function @xmath147 ( rather than the hfw @xmath35 ) . an important point to be noticed here is that the fact whether the reference system is interacting or non - interacting actually does not matter , since the gutzwiller wave function can be used to describe both the interacting and non - interacting systems in a better way .",
    "( the nature of the reference system depends on the choice of exchange - correlation potential as will be further discussed in the following part ) ; ( 2 ) following the ks _ ansatz _ , we assume that the ground state density of the original interacting system is equal to that of the reference system @xmath148 .",
    "( the representability is not rigorously proofed at this stage , therefore this step is still an _",
    "ansatz_. however , considering the fact that the @xmath149 automatically return back to @xmath150 in the non - interacting limit , it has the same spirit as ks _ ansatz _ which has been proofed to be valid for many applications . )",
    "( 3 ) the kinetic energy of the reference system can be explicitly written as @xmath151 .",
    "( 4 ) all unknown parts are moved into the exchange - correlation energy @xmath131 .",
    "finally , the total energy and the charge density will be written as , @xmath141=&e^g[\\rho^g]=t^g[\\rho^g]+e_h^g[\\rho^g]+e_{xc}^g[\\rho^g ] \\\\           = & \\langle\\psi_g|\\hat{t}|\\psi_g\\rangle+e_h^g[\\rho^g]+e_{xc}^g[\\rho^g ] \\\\",
    "\\rho=&\\rho^g=\\langle \\psi^g \\vert \\hat{\\rho } \\vert \\psi^g \\rangle \\end{split}\\ ] ]    the above formulation of gdft is still exact similar to ks .",
    "we can also come to the same conclusion as ks that if the exact exchange - correlation energy @xmath131 is known , the exact ground state energy of the true system will be obtained .",
    "again for the physical understanding , two terms are included in the exchange - correlation energy : ( 1 ) the correction to the kinetic energy @xmath152 ; ( 2 ) the correction to the interaction energy @xmath153 , as expressed as , @xmath154    as already mentioned , the @xmath155 automatically return back to @xmath150 in the non - interacting limit , therefore the present gdft can be regarded as a general extension of original ks formalism .",
    "certain approximation has to be introduced for the unknown exchange - correlation part in order to perform practically calculations .",
    "we will start from the lda and lda+u approximations used in ks formalism , and then we will show that by introducing the lda+u type approximation in gdft , the lda+g method can be derived .",
    "\\(1 ) _ lda or gga _",
    "the most popularly used and widely accepted approximation is the lda , where the exchange - correlation energy is approximated as , @xmath157 we assume the readers have the basic knowledge about lda , we therefore do not discuss its details here .",
    "the only point we want to emphasize is that the lda is basically parametrized from the uniform electron gas , and only the _ local _ part of the exchange - correlation potential is kept , in other words , the _ non - local _ part of the exchange - correlation potential is neglected .",
    "this is the reason why lda works well for simple metals , such as the na , k , where wide @xmath158 band cross the fermi level , but it fails for strongly correlated systems , such as transition - metal oxides .",
    "( 2)_lda+u for strongly correlated systems _",
    "to overcome the problem of lda for strongly correlated systems , lda+u method has been introduced , where the exchange - correlation energy is approximated as , @xmath159 the spirit of lda+u method is that the lda do not treat the interaction energy sufficiently well , and it need to be corrected for strongly correlated systems .",
    "therefore , the interaction energy correction in original lda @xmath160 is replaced by the lda+u counterpart @xmath161 . in such a way",
    ", the interaction term is treated more explicitly , and the energy is improved .",
    "to understand the lda+u formalism , it is very important to notice the following points : ( 1 ) the reference system ( in ks ) is no longer non - interacting anymore , since the interaction term @xmath77 is supplemented from the exchange - correlation potential .",
    "therefore , the @xmath35 is no longer the rigorous eigen state of the reference system , instead it is just a approximation ; ( 2 ) it is only up to this step that the definition of local orbital and interaction strength @xmath38 is necessary . in such a way ,",
    "the orbital - dependent potential is introduced ( the lda type @xmath162 only depends on the density , not on the orbital ) .",
    "the lda+u method is quite successful for many of the insulating systems , which have af long - range ordered ground state , however its quality is still not sufficient and can be improved further .",
    "the main drawbacks of lda+u are two folds : ( 1 ) the supplemented interacting term @xmath77 is treated by crude hartree - scheme , and the interaction energy is typically overestimated . actually , once the reference system becomes interacting system , the @xmath150 is no - longer a rigorous wave function ; ( 2 ) due to the usage of @xmath150 as an approximate wave function , only the interaction energy is further corrected ( over lda ) , namely @xmath163 is the further correction to the interaction energy .",
    "but the kinetic part @xmath164 is still kept to be the same as that in lda ( @xmath165 ) .",
    "however it is known that the presence of interaction term should also renormalize the kinetic energy .",
    "those drawbacks can be improved from our lda+g formalism as will be derived below .",
    "the gdft itself is also exact , however , certain approximations have to be used for the @xmath131 in practical calculations . since the exchange - correlation energy is a functional of charge density , the easiest way of course is still to use the local density approximation , and neglect the non - local part of the potential , i.e , @xmath166 . for the hartree energy",
    ", it only depends on the charge density , and it is the same for both ks - dft and gdft , i.e. @xmath167 .",
    "therefore , after applying the lda to @xmath131 , all the potential energies in gdft recover to be the same as that in lda - ks . in this limit , we already know that the reference system is a non - interacting system , and the wave function @xmath155 should return back to @xmath150 .",
    "therefore , all the above gdft formalism returns back to lda - ks if the lda is used for @xmath131 .",
    "so far , we gain nothing from the usage of gdft .",
    "however , if the lda+u type approximation is used for @xmath131 in gdft , the situation will be much improved .    as have been discussed above , to overcome the problem of lda for strongly correlated system ,",
    "the strategy of lda+u approximation is to introduce a supplemented interaction term @xmath77 in the exchange correlation potential , such that the electron - electron interaction can be treated more explicitly beyond lda .",
    "the reference system now is no longer non - interacting , but @xmath150 is still used to approximate the wave function of the reference system in the lda+u ks formalism . the same approximation for the exchange correlation term can be also used in the gdft , namely a interaction term @xmath77 can be supplemented in the exchange correlation potential to describe the electrons in localized orbitals better ( beyond uniform electron gas in lda ) .",
    "again , the reference system is a interacting system now , however , what is different in gdft is that the wave function of reference system is given as @xmath155 rather than @xmath150 .",
    "of course , the gwf @xmath155 is much better than hwf @xmath150 for interacting system , and it is in this sense that the formalism is improved over lda+u .",
    "therefore , using the similar lda+u approximation in the gdft , exchange - correlation energy and the corresponding total energy can be written as , @xmath168=&t^g[\\rho]+e_h[\\rho]+e_{xc}^g[\\rho ] \\\\         = & \\langle\\psi_g|\\hat{t}|\\psi_g\\rangle + e_h[\\rho]+e_{xc}^g[\\rho ] \\\\",
    "e_{xc}^{g}\\approx & e_{xc}^{lda+g}=\\delta t^{lda}+\\delta e_{int}^{lda+g } \\\\ = & \\delta t^{lda}+\\delta e_{int}^{lda}+\\langle h_{int } \\rangle_g - e_{dc } \\\\",
    "= & e_{xc}^{lda}+\\langle h_{int } \\rangle_g - e_{dc } \\end{split } \\label{lda+g}\\ ] ] it differs from the lda+u ks scheme in the following two points : ( 1 ) the supplemented interaction term is more precisely dealt with the gutzwiller wave function , namely the @xmath169 is used instead of @xmath163 ; ( 2 ) although the @xmath170 is still used in the exchange - correlation functional , the kinetic energy is actually improved through the replacement of @xmath142 by @xmath171 .",
    "the usage of @xmath165 in @xmath131 requires more discussions .",
    "it is known that the drawback of @xmath170 is that it keeps only the local part and neglects the non - local part .",
    "therefore , to make improvement , non - local correction should be supplemented .",
    "however , it is seen from our above gdft formalism , the non - local correction to the kinetic energy has been naturally included through the replacement of @xmath172 by @xmath173 .",
    "therefore , in the exchange - correlation part , the non - local correction to the kinetic energy is no - longer necessary , and only local - part need to be considered .",
    "this is the reason why @xmath165 can be used for @xmath131 .",
    "the usage of @xmath165 in @xmath131 can also guaranty that the present lda+g formalism return back to the lda+u solution in the static limit , where the @xmath129-factors approaching unity and @xmath174 approaching @xmath175 .    up to this stage , we have finished all the necessary steps , and we show that the original lda+g formalism discussed in the last section can be derived from a more rigorous base , namely the `` lda+u type approximation for the exchange correlation potential in the exact gdft formalism '' . using the eq .",
    "( [ lda+g ] ) , the hamiltonian  ( [ lda++ ] ) discussed in the last section under gwf will be recovered . to be more practical , here",
    "we will write down the final version of the necessary equations explicitly . the total energy and the exchange - correlations read , @xmath176=&\\langle\\psi_{g}\\vert    \\hat{t}\\vert\\psi_{g}\\rangle+e_{h}[\\rho]+\\int\\!\\ !",
    "v_{ext}\\,\\rho    d^{3}r+e_{xc}^{g}[\\rho ] \\\\",
    "e_{xc}^g\\approx & e_{xc}^{lda+g}=e_{xc}^{lda}+\\langle\\psi_g\\vert h_{int }    \\vert\\psi_g\\rangle - e_{dc } \\\\",
    "%   \\rho(r)=&\\langle\\psi_{g}\\vert \\hat{\\rho } %   \\vert\\psi_{g}\\rangle=\\langle\\psi_{0}\\vert\\hat{\\rho}^{g}\\vert\\psi_{0}\\rangle \\end{split } \\label{eq : etot_rho_g}\\ ] ] in which the electron density now is , @xmath177 and the kinetic energy operator is @xmath178 where @xmath6 is electron label .",
    "the hartree interaction energy of electrons is @xmath179    if the supplemented interaction part of the hamiltonian is diagonal in configuration space ( this is true if only density - density interactions are considered ) , the interaction term in the exchange - correlation energy reads according to eq .",
    "( [ eq : h_at ] ) , ( [ eq : uii ] ) , ( [ eq : mgutzh ] ) , @xmath180    for convenience , external potential energy , hartree energy and exchange - correlation energy ( of lda part ) can be grouped together , and written as an functional form of charge density , @xmath181=e_{h}[\\rho]+\\int\\ ! v_{ext}\\;\\rho\\ ; d^{3}r+e_{xc}^{lda}[\\rho ] \\label{eq : eehxc}\\ ] ] and the effective potential is defined as @xmath182}{\\delta\\rho } \\label{eq : v_ehxc}\\ ] ] which is exactly the same as that in the lda - ks formalism .",
    "now the total energy is , @xmath183= & \\langle\\psi_{g}\\vert t\\vert\\psi_{g}\\rangle+e_{ehxc}[\\rho]+\\sum_{i;\\gamma}e_{i\\gamma}m_{i\\gamma}-e_{dc}\\\\   = & \\langle\\psi_{0}\\vert t^g\\vert\\psi_{0}\\rangle+e_{ehxc}[\\rho]+\\sum_{i;\\gamma}e_{i\\gamma}m_{i\\gamma}-e_{dc } \\end{split}\\ ] ] the total energy is a functional of uncorrelated wave functions @xmath90 and the configuration weight @xmath30 , and have just the same form as eq .",
    "( [ eq : totalenergy_g ] ) .",
    "both should be variationally optimized as already shown in the last section .    for a summary of this section ,",
    "we have performed a explicit derivation just in the spirit of the kohn - sham ansatz to incorporating the gutzwiller approach into density functional theory . with some reasonable approximations ,",
    "we proof that this scheme gives the same result as what we developed in the last section within a simple physical interpretation .",
    "this provides a reliable foundation of this new lda+g method .",
    "similar to all kinds of lda+u or lda+dmft calculations , the interaction and the double - counting terms still remain to be defined explicitly in the present lda+g method , it is therefore also a kind of semi - empirical _ ab initio _ method in this sense .",
    "nevertheless , we can in general follow the same definition used in lda+u or lda+dmft method . from the physical point of view",
    ", we only consider the strong on - site interactions of localized orbitals",
    ". the interaction strength can be explicit expressed with slater integrals ( or called slater - condon parameters ) ( @xmath184 ) in the atomic limit .",
    "however , in practice , it is more convenient to use `` kanamori parameters '' , @xmath38,@xmath185,@xmath186 , and @xmath187 , which are combinations of slater integrals .",
    "the general form of the on - site interactions can be written as @xcite @xmath188 where @xmath80 denotes localized orbital and @xmath189 denotes spin .",
    "the first two terms are intra - orbital coulomb interaction , and inter - orbital coulomb interaction , respectively . the hund s rule exchange coupling",
    "are divided into three parts : one is the longitudinal part ( the third term ) which only involves density - density coupling ; the other two terms ( the 4-th and 5-th terms ) describe the spin flip and pair hopping processes respectively . in the atomic case ,",
    "the relation @xmath190 holds to retain the rotational invariance in orbital space . and",
    "for typical @xmath0-orbital systems , where spin - orbital coupling is not so strong , the relation @xmath191 also holds , we therefore have @xmath192 in general .    in this article",
    ", we restricted ourselves to the pure density - density interactions for simplicity , and the interactions to be considered are @xmath193 this on - site interaction hamiltonian is already diagonal in the atomic configuration @xmath13 space , and the corresponding configuration energy @xmath194 is a linear combination of @xmath38 , @xmath185 and @xmath186  @xcite .    with the on - site interactions determined , we come to the question how much of them are taken into account in lda , that is , how to write down the double counting terms .",
    "it is known that these interactions goes into lda in an average way without orbital dependence . as",
    "already discussed in lda+u or lda+dmft methods , we just follow the common choice of the double counting terms as  @xcite : @xmath195= & \\sum_{i}\\frac{\\overline{u}}{2}n_{i}(n_{i}-1)\\\\   & -\\sum_{i}\\frac{\\overline{j}}{2}(n_{i\\uparrow}(n_{i\\uparrow}-1)+n_{i\\downarrow}(n_{i\\downarrow}-1 ) ) \\end{split } \\label{eq : e_dc}\\ ] ] where @xmath196 is the total electron number of localized orbitals on the same site @xmath6 , @xmath197 , and @xmath198 , @xmath199 are spherically averaged interactions , which can be given as  @xcite , @xmath200    @xmath201    where @xmath202 is the angular momentum number of the corresponding localized shell",
    ".    the coulomb and exchange interactions , @xmath38 and @xmath186 , can in principle be obtained using corresponding slater integrals . however , in real materials , the bare electron - electron interactions must be screened , and the slater integrals have to be renormalized .",
    "therefore , it is a hard task to determine the effective @xmath38 and @xmath186 exactly . in practice , usually two possible ways are followed : ( 1 ) determining the parameters from available experimental information empirically ; ( 2 ) calculating the parameters from constrained lda method  @xcite and the linear response approach  @xcite . depending on different method ,",
    "different values might be obtained , however the important strategy is that for single fixed parameter , the method should be able to explain all possible properties spontaneously and systematically , rather than using different parameters for different properties .",
    "it is only in this way , the obtained results can be justified .",
    "we should also notice that the interaction parameters also depend on the choice of local orbitals , because of the different screening processes involved .",
    "for example , both atomic orbitals and wannier functions can be used to define the local orbitals , however generally the effective interaction strength for atomic orbitals should be larger than that for wannier orbitals because the former is more localized . to construct the wannier orbitals , either the projected wannier method  @xcite or the maximally localized wannier function  @xcite can be used .    finally , a very similar approach has been recently proposed independently by k. m. ho .",
    "to combine the gutzwiller approach with the dft @xcite .",
    "the spirit of our method and their proposal are almost the same , however , they differs in the definition of the interaction and double counting terms .",
    "it is still remained to be justified which way should be the best in future .",
    "the above proposed lda+g method was implemented in our bstate ( beijing simulational tool for atom technology ) code  @xcite , which uses plane - wave ultra - soft pseudo - potential method , with projected wannier function for the definition of local orbitals .",
    "we have applied the method to study several typical systems , where the strong e - e interactions play important roles .",
    "they are non - magnetic metal srvo@xmath203 , magnetic metal fe and ni , af insulator nio , and unconventional superconductor na@xmath116coo@xmath117 .",
    "some of the results have been published  @xcite with emphasis on particular issues in each example . on the other hand ,",
    "the main purpose of this full paper is to present the whole formalism of lda+g and to demonstrate its advantage , namely what knowledge can be gained beyond lda or lda+u .",
    "therefore , to keep the completeness of our present paper , here we would like to concentrate on the physical consequence of our method by grouping all results together . we will discuss all those results in a totally different manner , such that we can understand the lda+g method better .          an essential quantity included in the lda+g method",
    "is the kinetic renormalization factor @xmath204 due to the dynamic correlation .",
    "the @xmath122 factors are orbital - dependent , and can be self - consistently obtained from the energy minimization . under the gutzwiller approximation ,",
    "the @xmath63 factor can be also understood as the quasi - particle weight .",
    "it has been widely recognized that lda type calculations overestimate the band - width of correlated - electron systems",
    ". the error - bar could be as large as an order ( such as in heavy fermion system ) depending on the strength of correlation .",
    "we will show here , that this band - narrowing ( or mass renormalization ) physics can be correctly obtained from the lda+g method .",
    "for example , srvo@xmath203 is a intermediately correlated metal with @xmath205-@xmath206 configuration .",
    "it has simple cubic perovskite crystal structure , and magnetic instabilities are not involved for the ground state property  @xcite .",
    "although the lda calculation can correctly predict the non - magnetic metallic nature of the ground state , the calculated band width is about 40% wider than photoemission observation  @xcite , and the estimated effective mass is about 2 - 3 times lower than experimental results from specific heat and susceptibility . on the other hand ,",
    "all these features can be improved by lda+g calculations , and correct band - narrowing and mass renormalization can be obtained as shown in fig .",
    "[ fig : srvo3-z ] and fig .",
    "[ fig : srvo3-dos ] by using reasonable @xmath38(@xmath207 5.0ev ) . to gain further understanding , here",
    "we would also like to compare the results to that obtained by lda+u method . in the lda+u ,",
    "only the interaction energy part is corrected over lda , and the kinetic part is not renormalized , as already discussed in the previous section .",
    "therefore , lda+u can not explain the observed large renormalization as shown in fig .",
    "[ fig : srvo3-dos ] , where the density of states ( dos ) obtained by lda+u almost coincide with that by lda .            except the band renormalization",
    ", we will show here that the spin polarization of magnetic systems can be also improved to certain extend .",
    "to understand the physics better , we would like to divide the mechanisms of spin polarization into two parts : ( 1 ) the inter - site exchange ( or the spacial long - range exchange ) ; ( 2 ) the intra - site exchange ( mostly the inter - orbital hund s coupling ) .",
    "such a separation is not rigorous , but just for the physical understanding .",
    "it is important to note that , in our formalism , the spacial inter - site part still remain to be treated by lda level , and only the intra - site part is improved explicitly . of course , through the charge - density self - consistency , the inter - site part may be also tuned slightly , but it is not a main effect .",
    "it is therefore understood that the issues related to the inter - site exchange , such as the spin spacial fluctuation or the geometrically frustrated spin systems , can not be improved through the lda+g treatment .",
    "even for the intra - site interaction , it is treated both in lda+u and in lda+g , what will be the difference ? in the lda+u , it is treated from the static mean field level , which always tends to give larger spin polarization than that in lda for positive effective @xmath208(=@xmath38-@xmath186 ) .",
    "on the other hand in the lda+g method , the dynamic effects are included and the intra - site ( inter - orbital ) charge and spin fluctuations are all included in a better way .",
    "it is in this sense that the results by lda+g should be more reasonable . to demonstrate the effect of lda+g on spin polarization , here",
    "we would like to show three examples :    \\(1 ) for ferromagnetic ( fm ) bcc fe , as shown in fig .",
    "[ fig : fe - xc ] and [ fig : fe - dos ] , the calculated magnetic moment in lda+u is always larger than that in lda , and is significantly overestimated compared to experiments . on the other hand , in lda+g , this overestimation by lda+u is suppressed .",
    "( 2 ) for the bulk fcc ni , the calculated moment by lda+g is even smaller than that in lda , in better agreement with experiments ( see table i ) .",
    "( 3 ) for na@xmath116coo@xmath117 , the lda level calculations predict that the system is magnetic for all the doping range , the lda+u calculations even enhance the tendency to be magnetic , in contrast to experimental observation .",
    "however , using lda+g , we show in ref .",
    "@xcite that the ground state is actually non - magnetic for the intermediate doping range ( around 0.3@xmath2090.5 ) , in nice agreement with experiments .",
    "a big advantage of lda type calculations based on dft is its ability to get the ground state total energy accurately . here",
    "we will show that , by explicitly treating the interaction term through our lda+g formalism , the calculated total energy and equilibrium properties of correlated electron systems can be also improved significantly .",
    "bulk fe and ni are typical magnetic metals with intermediate correlations , where lda produce big error bar for the ground state properties in comparison to experiments .",
    "for fe , the lda even fails to predict the correct bcc fm ground state ( although gga correctly do so , the reason is not clearly understood ) .",
    "the results , summarized in table i shows that most of the discrepancies are systematically improved , compared with experiments , suggesting the advantages of present scheme .",
    "first of all , the bcc fm ground state is now correctly predicted by lda+g ( see ref .",
    "@xcite for original figure ) , we therefore understand that the failure of lda to predict the correct ground state is due to its underestimation of strong on - site correlation .",
    "second , the calculated equilibrium volume , bulk modulus , magnetic moment , specific heat coefficient , and band width are all improved in a systematic way by a simple fixed interaction strength ( @xmath38=7.0ev and @xmath186=1.0ev ) .",
    "this is in sharp contrast to that obtained in lda+u , for instance , the lda+u may also get the correct equilibrium volume by certain @xmath38 value , but the obtained magnetic moment will be unreasonably larger than experimental results if the same @xmath38 is used .",
    "now we come to discussions for the large gap af ordered insulator with integer occupation , where lda+u works well .",
    "we will show that the lda+g actually gives similar results in this limit .",
    "the reason is very straight forward as has been pointed out in the formalism . in the present lda+g scheme ,",
    "both the on - site level and the kinetic energy should be renormalized due to the presence of interaction term",
    ". however , in the case that long - range ordering is established with integer occupation , if the energy gap is big , each orbital should be close to either fully occupied or totally empty , because the charge fluctuation between the states should be small . in this limit",
    ", the kinetic renormalization @xmath63 factor will be very close to unity , and @xmath155 returns back to @xmath150 .",
    "therefore , the kinetic renormalization is very small , and only the renormalization to the on - site level take effect , this is exactly just the limit that obtained in lda+u . as we have shown in the calculations for nio  @xcite , the obtained electronic structure is very similar to that of lda+u .",
    "however please note , even for the af long - range ordered insulators , if the band gap is small and the spin moment is far away from integer , the dynamic processes crossing the band gap may also take effect , in this case , the @xmath63 factor will be no longer unity , and of course , the results by lda+g will be different with that of lda+u , and the one by lda+g should be more close to reality .",
    "we expect that this situation may happen in the latio@xmath203  @xcite , where the gap is about 0.2ev and the calculated moment from lda+u is much larger than that observed experimentally .      here we will show that the charge density self - consistency is really important for the calculations on realistic systems , and we take na@xmath116coo@xmath117 , a typical multi - orbital system , as an example . as we have pointed out in our recent publication  @xcite , all the issues discussed above , such as the band - narrowing , spin polarizations , orbital fluctuations , are encountered in na@xmath116coo@xmath117 , and systematic improvement are obtained through lda+g treatment .",
    "however , we want to take na@xmath116coo@xmath117 as an example to demonstrate the importance of charge self - consistency , because several post - lda techniques ( without charge self - consistency ) have been applied to this compound and conflicting results are obtained  @xcite .",
    "the issue is related to the relative splitting of energy level between @xmath210 and @xmath211 states , and the appearance of @xmath210 hole pockets at the fermi surface ( for @xmath212=0.3 ) .",
    "if the splitting is large , the @xmath210 orbital will be totally occupied , and there will be no @xmath210 hole pockets at the fermi surface . starting from different hamiltonians fitted to lda band structure ,",
    "advanced techniques such as gutzwiller or dmft have been applied in post - lda scheme , however , one of the results suggests the absence of @xmath210 hole pockets  @xcite , and the other suggests the appearance  @xcite .",
    "it is now understood  @xcite that the main reason is due to the difference in the fitted tight - binding hamiltonian , namely the crystal field splitting ( or the on - site energy ) in the two studies are different . in our lda+g method ,",
    "full charge self - consistency is achieved and no tight - binding fitting is required . only after such kind treatment",
    ", the discrepancy can be nicely resolved  @xcite . on the other hand , because of the feedback effect in the charge self - consistency , the on - site level renormalization which is overestimated by post - lda techniques is now suppressed as show fig .",
    "[ fig : nacoo - sp ] .     and the @xmath213 states for na@xmath116coo@xmath117 .",
    "the original figure is obtained from ref .",
    "the one - loop result corresponds to the calculation without charge density self - consistency.,width=264 ]    in summary , we have show in this full paper the detailed formalism of lda+gutzwiller method , and its firm derivation from the gdft . by comparing the results to",
    "that obtained by dmft , we have shown that the energy resolution of gutzwiller approach is pretty good for the ground state determination .",
    "it is computationally cheaper , and yet with dynamic fluctuations included .",
    "the calculated results for several typical systems demonstrate that it can be widely applied to many of the correlated electron systems with quality beyond lda+u .          in this appendix",
    ", we will proof several equations discussed in the text part .",
    "we will pay special attention to when and how ga is applies .",
    "even a variational ansatz is given for a lattice model , evaluation of expect value is not straightforward .",
    "ga is a systemically approximation to make the evaluation accessible .",
    "the spirit of ga actually is to neglect wick contractions between operators with different site / orbital indices , thus in the following we often need to fourier transform the expression into real space and then apply ga .",
    "first we note that by choose @xmath214 , @xmath20 is normalized under ga .",
    "@xmath215 . in the first equality we separate the average of a projection operator string into the product of single site averages .",
    "then the expectation value of kinetic energy is @xmath216 where in the first equality we adopt ga to neglect all wick contractions from site @xmath217 and site @xmath218 . to evaluate the expectation value",
    "we define @xmath219 where @xmath220 ( @xmath221 ) are projection operators for orbital other than @xmath4(@xmath222 )",
    ". then we have @xmath223          in this section , we proof @xmath226 under ga , here we focus on quasi - particle sector without loss of generality . to compute @xmath227 , we first fourier transform the operators into real space then apply ga .",
    "similarly , we could proof that under ga @xmath229 .",
    "thus we have @xmath230 under ga .",
    "also note that under ga the @xmath99 dependence of the @xmath63 is missing , only the fact that above or below the fermi surface matters .                  for the second term",
    ", we have @xmath238 cases : @xmath239 but @xmath240 ; @xmath236 but @xmath241 ; @xmath239 , @xmath241 and @xmath242 . following previous technique",
    ", one could find out each of the cases the projection operator @xmath243gives a @xmath70 factor .",
    "thus ,        @xmath246 \\\\ & \\times z_{\\mu } ^{2}\\sum_{i , j}t_{ij}\\langle \\psi _ { 0}|c_{i\\mu } ^{\\dagger } c_{j\\mu } |\\psi _ { 0}\\rangle \\\\ = & \\sum_{k\\mu } z_{\\mu } ^{2}\\varepsilon _ { k\\mu } \\langle \\psi _ { 0}|c_{k\\mu } ^{\\dagger } c_{k\\mu } |\\psi _ { 0}\\rangle\\end{aligned}\\ ] ]                  v. i. anisimov , j. zaanen , and o. k. andersen , phys . rev .",
    "b * 44 * , 943 ( 1991 ) ; v. i. anisimov , i. v. solovyev , m. a. korotin , m. t. czyzyk , and g. a. sawatzky , phys . rev .",
    "b * 48 * , 16929 ( 1993 ) ; i. v. solovyev , p. h. dederichs , and v. i. anisimov , phys .",
    "b * 50 * , 16 861 ( 1994 ) .",
    "a. i. liechtenstein , v. i. anisimov , and j. zaanen , phys .",
    "b * 52 * , r5467 ( 1995 ) v. i. anisimov , f. aryasetiawan , and a. i. liechtenstein , j. phys . : condens . matter * 9 * , 767 ( 1997 ) .",
    "j. bnemann , f. gebhard , and w. weber , j. phys : cond - matt , * 9 * , 7343 ( 1997 ) ; j. bnemann , and w. weber , phys .",
    "b * 55 * , 4011 ( 1997 ) ; j. bnemann , and w. weber , f. gebhard , phys . rev .",
    "b * 57 * , 6896 ( 1998);j .",
    "bunemann , f. gebhard , and w. weber , foundations of physics 30 , 2011 ( 2000 ) ; c. attaccalite and m. fabrizio , phys .",
    "b * 68 * , 155117 ( 2003 ) .",
    "j. p. julien , and j. bouchet , physica b * 359 - 361 * , 783 ( 2005 ) ; j. p. julien , and j. bouchet , _ recent advances in the theory of chemical and physical systems _",
    ", in _ prog .",
    "_ , * 15 * 509534 , ( springer netherlands , 2006 )                      a. liebsch , phys . rev . lett . * 90 * , 096401 ( 2003 ) ; i. a. nekrasov , g. keller , d. e. kondakov , and et.al . phys",
    "b * 72 * , 155106 ( 2005 ) ; f. lechermann , a. georges , a. poteryaev , cond - mat/0605539 ( 2006 ) .",
    "a. fujimori , i. hase , h. namatame , and et .",
    "al . , phys .",
    "lett . * 69 * , 1796 ( 1992 ) ; i. h. inoue et al .",
    "lett . * 74 * , 2539 ( 1995 ) ; i. h. inoue , o. goto , h. makino , n. e. hussey , m. ishikawa , phys .",
    "b * 58 * , 4372 ( 1998 ) ; a. sekiyama , h. fujiwara , s. imada , and et.al .",
    "lett . * 93 * , 156402 ( 2004 ) ;"
  ],
  "abstract_text": [
    "<S> we introduce in detail our newly developed _ </S>",
    "<S> ab initio _ lda+gutzwiller method , in which the gutzwiller variational approach is naturally incorporated with the density functional theory ( dft ) through the `` gutzwiller density functional theory ( gdft ) '' ( which is a generalization of original kohn - sham formalism ) . </S>",
    "<S> this method can be used for ground state determination of electron systems ranging from weakly correlated metal to strongly correlated insulators with long - range ordering . </S>",
    "<S> we will show that its quality for ground state is as high as that by dynamic mean field theory ( dmft ) , and yet it is computationally much cheaper . in additions , the method is fully variational , the charge - density self - consistency can be naturally achieved , and the quantities , such as total energy , linear response , can be accurately obtained similar to lda - type calculations . </S>",
    "<S> applications on several typical systems are presented , and the characteristic aspects of this new method are clarified . </S>",
    "<S> the obtained results using lda+gutzwiller are in better agreement with existing experiments , suggesting significant improvements over lda or lda+u . </S>"
  ]
}