{
  "article_text": [
    "computer experiment by the method of molecular dynamics ( md ) is intensively exploited in solving various tasks of chemical physics [ 1 ] , biochemistry [ 2 ] and biology [ 3 ] . among these",
    "are investigations of structure and dynamical properties of molecular liquids which normally are treated as collections of rigid bodies . despite the long prehistory of md simulation ,",
    "the development of efficient and stable algorithms for the integration of motion for such systems still remains an actual problem .",
    "usually , molecular movements are simulated using constrained dynamics [ 47 ] in which the phase trajectory of each atom is evaluated by newton s equations , while the molecular structures are maintained by holonomic constraints to keep intramolecular bond distances .",
    "although the atomic - constraint technique can be applied , in principle , to arbitrary polyatomics regardless of its chemical structure and size , it appears to be very sophisticated to implement for some particular models .",
    "for example , when there are more than two , three or four interaction sites per molecule for linear , planar and three - dimensional bodies , bond lengths and angles can not be fixed uniquely [ 5 ] .",
    "systems of point molecules with embedded multipoles present additional complexities too , because then the intermolecular forces can not easily be decomposed into direct site - site interactions .",
    "the limitation of constrained dynamics is also caused by the fact that constraint forces are calculated at each time step of the produced trajectory to balance all other potential forces in the system .",
    "as the number of atoms in each molecule is increased , the number of constraints raises dramatically , resulting in a decreased speed of computations .",
    "moreover , to reproduce the rigid molecular structure , cumbersome systems of nonlinear equations must be solved iteratively .",
    "this can lead to a problem for molecules with light hydrogen atoms or with linear or planar fragments . in this case",
    ", the algorithm converges rather slowly [ 8 ] already at relative small step sizes and , thus , it requires a considerably portion of the computational time .",
    "recently , it was shown that a non - iterative calculation of constraint forces is possible [ 9 ] , but this is practical only for simple models in which the problem can be reduced to inversion of a banded matrix [ 10 , 11 ] .",
    "some of the limitations just mentioned are absent in the molecular approach , when the displacements of rigid bodies are analyzed in view of translational and rotational motions .",
    "the translational dynamics is defined by motion of molecular centres of masses , whereas the orientations typically are expressed in terms of quaternions [ 1214 ] or principal - axis vectors [ 13 ] .",
    "the straightforward parameterization of orientational degrees of freedom , euler angles , is very inefficient for numerical calculations because of singularities inherent in the description [ 12 , 15 , 16 ] .",
    "multistep predictor - corrector methods were applied to integrate rotational motion in early investigations [ 1720 ] . as was soon established , the extra order obtained in these methods is not relevant , because the forces existing in a real system are not sufficiently smooth . as a result , high - order schemes appear to be less accurate at normal step sizes than low - order integrators , such as verlet [ 21 ] , velocity verlet [ 22 ] and leapfrog [ 23 ] ones .",
    "the last algorithms are also the most efficient in view of cost measured in terms of force evaluations .",
    "that is why , they are widely used in different approaches , for instance , in the atomic - constraint technique , to integrate translational motion .",
    "these traditional algorithms were derived , however , assuming that velocities and forces are coordinate- and velocity - independent , respectively . in general ,",
    "the time derivatives of orientational positions may depend not only on angular velocities but also on these positions themselves resulting in the explicit velocity - dependence of angular accelerations .",
    "therefore , additional revisions are necessary to apply the standard integrators to rotational motion .    in the atomic approach",
    ", the problem with the coordinate and velocity dependencies is circumvented by involving fundamental variables , namely , the individual cartesian coordinates of atomic sites .",
    "similarly , this problem can be solved within the molecular approach choosing appropriate generalized coordinates in orientational space .",
    "ahlrichs and brode proposed a method [ 24 ] in which the principal axes of molecules are treated as pseudo particles and constraint forces are introduced to maintain their orthonormality .",
    "considered the entire rotation matrix and the corresponding conjugate momentum as dynamical variables [ 25 ] .",
    "the rotation matrices can be evaluated within the usual verlet or leapfrog frameworks , using either recursive [ 24 ] or iterative [ 25 ] procedures , respectively .",
    "the recursive method behaves relatively poor with respect to long - term stability of energy , whereas the iterative procedure requires again , as in the case of constrained dynamics , to find solutions for systems of highly nonlinear equations . in general , the convergence of iterations is not guaranteed and looping becomes possible even at not very large step times .",
    "examples for not so well behaved cases are models with almost linear or planar molecules , when the diagonal mass matrices are hard to numerical inversion since they have one or two elements which are very close to zero .",
    "the extension of the atomic and pseudo - particle approaches to temperature - conserving dynamics is also a difficult problem , given that the rigid - reactions and temperature - constraint forces are coupled between themselves in a very complicated manner .",
    "a viable alternative to integrate the rigid - body motion has been provided by explicit and implicit angular - momentum algorithms of fincham [ 2627 ] .",
    "this was the first attempt to adopt the leapfrog framework to rotational motion in its purely classical treatment .",
    "the chief advantage of these rotational leapfrog algorithms is the possibility to perform thermostatted simulations .",
    "however , even in the case of a more stable implicit algorithm , the total energy fluctuations in energy - conserving simulations are too big with respect to those identified in the atomic - constraint technique . moreover , despite the fact that no constraint forces are necessary in the rotation dynamics , the rigidness of molecules is not satisfied automatically , because the equations of motion are not solved exactly .",
    "usually , the artificial rescaling method [ 19 , 27 ] is used to preserve the unit norm of quaternions and , as a consequence , to ensure the molecular rigidity .",
    "recently [ 28 ] , it has been shown that the crude renormalization can be replaced by a more rigorous procedure introducing so - called numerical constraints . as a result ,",
    "quaternion [ 28 ] and principal - axis [ 29 ] algorithms were devised within the velocity verlet framework .",
    "it was demonstrated [ 29 , 30 ] that these algorithms conserve the total energy better than the implicit leapfrog integrator [ 27 ] , but worse with respect to the atomic - constraint method , especially in the case of long - duration simulations with large step sizes .    quite recently , to improve the stability ,",
    "a new angular - velocity leapfrog algorithm for rigid - body simulations has been introduced [ 30 ] .",
    "the automatic preservation of rigid structures and good stability properties can be related to its main advantages . but a common drawback , existing in all long - term stable integrators on rigid polyatomics , still remained here , namely , the necessity to solve by iteration the systems of nonlinear equations .",
    "although such equations are much simpler than those arising in the atomic and pseudo - particle approaches , the iterative solution should be considered as a negative feature . moreover , since the nonlinear equations are with respect to velocities , it is not so simple matter to extend the angular - velocity algorithm to a thermostatted version .",
    "this study presents a modified formulation of the angular - momentum approach within the leapfrog framework . unlike the standard approach by fincham [ 27 ]",
    ", the new formulation is based on more natural interpolations of dynamical variables and it uses no extrapolation .",
    "the algorithm derived appears to be free of all the drawbacks inherent in previous descriptions .",
    "it can easily be implemented to arbitrary rigid bodies and applied to temperature - conserving dynamics .",
    "the integrator exhibits an excellent energy conservation , intrinsically reproduces rigid structures and allows to avoid any iterative procedures at all .",
    "let us consider a system of @xmath0 interacting rigid bodies .",
    "according to the classical approach , any movements of a body can be presented as the sum of two motions , namely , a translational displacement of the centre of mass and a rotation about this centre .",
    "the translational displacements in the system are expressed in terms of the centre - of - mass positions @xmath1 and velocities @xmath2 , where @xmath3 , given in a space - fixed laboratory frame . the time evolution of such quantities can described by writing newton s law in the form of two per particle three - dimensional differential equations of first order , @xmath4 \\\\ [ -6pt ] \\frac{{\\rm d } { \\bf r}_i}{{\\rm d } t}&=&{\\bf v}_i \\ , , \\nonumber\\end{aligned}\\ ] ] where @xmath5 is the total force acting on body @xmath6 due to the interactions with all the rest of particles and @xmath7 denotes the mass of the body .      to determine the rotational motion , one needs to use frames attached to each body together with the laboratory system of coordinates .",
    "it is more convenient for further consideration to direct the body - fixed - frame axes along the principal axes of the particle , which pass through its centre of mass .",
    "then the matrix @xmath8 of moments of inertia will be diagonal and time - independent in the body - fixed frame .",
    "we will use the convention that small letters stand for the representation of variables in the fixed laboratory frame , whereas their counterparts in the body frame will be designated by capital letters .",
    "the transitions @xmath9 and @xmath10 between these both representations of vectors @xmath11 and @xmath12 in the laboratory and body frames , respectively , can be defined by the @xmath13 time - dependent rotation matrix @xmath14 .",
    "such a matrix must satisfy the orthogonormality condition @xmath15 , or in other words @xmath16 , to ensure the invariance @xmath17 of quadratic norms for vectors @xmath11 and @xmath12 . in our notations @xmath18 and @xmath19 are the matrices inversed and transposed to @xmath20 , correspondingly , and @xmath21 denotes the unit matrix .",
    "let @xmath22 be an arbitrary vector fixed in the body . by definition ,",
    "such a vector does not change in time in the body - fixed frame , @xmath23 .",
    "the angular velocity @xmath24 is introduced differentiating its counterpart @xmath25 in the laboratory frame over time , @xmath26 .",
    "then , using the equality @xmath27 and the orthonormality of @xmath28 , the rate of change in time of the orientational matrix can be expressed in terms of either laboratory @xmath24 or principal @xmath29 angular velocity as @xmath30 where @xmath31 is a skewsymmetric matrix , i.e. , @xmath32 , and @xmath33 , @xmath34 and @xmath35 are components of vector @xmath36 .    from the orthogonormality condition",
    "it follows that maximum three independent parameters are really necessary to describe orientations of a rigid body and to evaluate the nine elements of the rotation matrix .",
    "however , the well - known parameterization of @xmath28 in terms of three eulerian angles [ 12 ] is unsuitable for numerical calculations because of the singularities . in the body - vector representation",
    "[ 13 , 24 , 25 , 29 ] , all the elements of the rotation matrix @xmath28 are considered as dynamical variables .",
    "these variables present , in fact , cartesian coordinates of three principal axes @xmath37 of the body in the laboratory frame .",
    "the alternative approach applies the quaternion parameterization [ 4 , 9 ] of rotation matrices , @xmath38 where @xmath39 is a vector - column consisting of four quaternion components . using the normalization condition @xmath40 , which ensures the orthonormality of @xmath41 $ ]",
    ", the time derivatives of quaternions can be cast [ 13 , 27 , 30 ] in the form @xmath42 where @xmath43 is a skewsymmetric matrix again .",
    "expressions ( 2 ) and ( 5 ) are rotation - motion analogues of the second line of eq .",
    "( 1 ) in the case of body - vector and quaternion representations , respectively .",
    "they must be complemented by equations defining the time evolution of angular velocities .",
    "the simplest form of these equation is obtained for the angular momenta @xmath44 of bodies in the laboratory frame , where @xmath45 are principal angular momenta .",
    "the result is @xmath46 where @xmath47 is the torque exerted on body @xmath6 with respect to its centre of mass .",
    "the angular velocities in the body- or space - fixed frames can easily be reproduced , whenever they are needed , using the relations @xmath48 and @xmath49 , where @xmath50 is the time - dependent matrix of moments of inertia in the laboratory frame .",
    "another way lies in involving explicit equations for principal angular velocities .",
    "such equations , known also as euler s ones , can be derived substituting @xmath51 into eq .",
    "( 6 ) and using equations of motion ( 2 ) for orientational matrices . as a result ,",
    "one obtains @xmath52 \\ , , \\ ] ] where @xmath53 are the principal torques . formally replacing the quantities @xmath36 , @xmath54 and @xmath8 by @xmath55 , @xmath47 and @xmath56 yields quite similar equations of motion for angular velocities @xmath24 in the laboratory frame .",
    "it is worth remarking that the body - vector ( eq .  ( 2 ) ) and quaternion ( eq .  ( 5 ) ) representations as well as the angular - momentum ( eq .  ( 6 ) ) and angular - velocity ( eq .  ( 7 ) )",
    "approaches are completely equivalent between themselves from the mathematical point of view . for numerical evaluations",
    ", the preference must be given to equations which allow to be integrated in the simplest manner with the greatest precision and the best stability .",
    "in the present study we shall deal with more simple equations of motion ( 6 ) for angular momenta in the laboratory frame rather than with equations ( 7 ) for principal angular velocities . in such a way , difficulties with the velocity - dependence of angular accelerations are excluded automatically .",
    "moreover , we shall show that the angular - momentum approach allows to obviate iterative solutions within a leapfrog framework choosing the entire - rotation - matrix elements , instead of quaternions , as orientational variables .",
    "thus , the body - vector representation should be considered as a more preferable method for such calculations .",
    "in the case of translational motion , equations ( 1 ) can readily be integrated with the help of the usual [ 23 ] leapfrog algorithm : @xmath57 \\\\ [ -12pt ] { \\bf r}_i(t+h)&=&{\\bf r}_i(t)+h\\,{\\bf v}_i(t+{\\textstyle \\frac{h}{2 } } ) + { \\cal o}(h^3 ) \\nonumber \\ , , \\end{aligned}\\ ] ] where @xmath58 is the time increment , and forces @xmath59 are evaluated using known spatial coordinates @xmath60 and @xmath14 .",
    "the truncation local errors , appearing during such an integration , are of order @xmath61 in both coordinates and velocities .",
    "if an estimator of @xmath62 is required , for example to evaluate the total energy , the usual choice is @xmath63 + { \\cal o}(h^2 ) \\ , , \\ ] ] where interpolation uncertainties @xmath64 are in the self - consistency with the second order of global errors ( one order lower than that for local errors ) of the leapfrog integrator ( 8) .      for the rotational motion the time derivatives of orientational positions ( eqs .",
    "( 2 ) and ( 5 ) ) depend not only on angular velocities but also on these positions themselves .",
    "this difficulty can not be handled with a simple leapfrog scheme in which the positions and velocities are known at different times .",
    "relatively recently , fincham [ 27 ] has proposed a solution to the problem by introducing an implicit leapfrog - like algorithm .",
    "his method can briefly be described as follows .",
    "first , quite analogously to the case of translational - velocity evaluations ( fist line of eq .",
    "( 8) ) , angular - momentum equations ( 6 ) are integrated as @xmath65 at this stage the principal angular velocities @xmath66 can be calculated using the relation @xmath67 and the propagation @xmath68= { \\bf l}_i(t-{\\textstyle \\frac{h}{2 } } ) + { \\textstyle \\frac{h}{2 } } { \\bf k}_i(t ) + { \\cal o}(h^2)\\ ] ] of angular momenta to on - step level of time .    further , according to the leapfrog framework , the evaluation of orientational coordinates must be performed as @xmath69 where @xmath70 , and either @xmath71 and @xmath72 or @xmath73 and @xmath74 in the case of either entire - matrix or quaternion space , respectively .",
    "note that in the quaternion representation the orientational matrices @xmath75 $ ] appear implicitly , and they are computed via relation ( 4 ) using quaternion values @xmath76 .",
    "as far as the quantities @xmath77 and @xmath36 are not known at mid - step level @xmath78 , it was assumed to propagate the time derivatives of @xmath77 by means of the relation @xmath79 + { \\cal o}(h^2)$ ] , i.e. , @xmath80 + { \\cal o}(h^2 ) \\",
    ", , \\ ] ] where @xmath81 propagation ( 14 ) requires in its turn the knowledge of advanced angular momenta @xmath82 which were predicted by writing @xmath83    in view of ( 14 ) and ( 15 ) , relation ( 13 ) is an implicit system of equations with respect to elements of @xmath84 , defined through the auxiliary parameters @xmath85 and @xmath82 which are not stored , but used to calculate the angular velocities @xmath66 and @xmath86 in the body frame .",
    "the system can be solved by iteration taking @xmath87 as the initial guess .",
    "a thermostatted version is based on interpolations ( 9 ) and ( 12 ) of on - step translational velocities and angular momenta .",
    "such interpolations are used in microcanonical simulations to evaluate the kinetic temperature @xmath88 $ ] , where @xmath89 , @xmath90 and @xmath91 are nonzero elements of matrix @xmath8 , @xmath92 is the boltzmann s constant and @xmath93 denotes the number of degrees of freedom per particle ( for linear bodies @xmath94 ) .",
    "this allows to synchronize in time the temperature with the potential energy @xmath95 and , therefore , to calculate the total energy @xmath96 of the system . in the temperature - conserving dynamics , on - step velocities and angular momenta",
    "are modified as @xmath97 and @xmath98 using the scaling factor @xmath99 , where @xmath100 is the required constant temperature [ 27 , 31 ] .",
    "the velocity integration is completed by @xmath101 { \\bf v}_i'(t)+{\\textstyle \\frac{h}{2 } } { \\bf f}_i(t)/m \\ , , \\\\ [ 3pt ]",
    "{ \\bf l}_i'(t+{\\textstyle \\frac{h}{2}})&= & [ 2-\\beta^{-1}(t ) ] { \\bf l}_i'(t)+{\\textstyle \\frac{h}{2 } } { \\bf k}_i(t)\\end{aligned}\\ ] ] which satisfy the interpolations @xmath102 $ ] , @xmath103 $ ] and the constant - temperature condition @xmath104 , where @xmath105 . finally , the translational and orientational positions are updated according to the same equations replacing @xmath106 by @xmath107 and @xmath108 by @xmath109 .",
    "as has been established [ 29 , 30 ] , the rotational leapfrog algorithm , described in the preceding subsection , exhibits rather poor long - term stability of energy with respect to atomic - constraint integrators [ 47 ] , for example .",
    "moreover , it requires iterative solutions and does not conserve the unit norm and orthonormality of quaternions and orientational matrices . for this reason",
    ", a question arises how about the existence of a revised scheme which is free of all these drawbacks and which has all advantages of the standard approach .",
    "we shall show now that such a scheme really exists .",
    "first of all , one points out some factors which can explain bad stability properties of the standard scheme .",
    "when calculating orientational variables , the fincham s algorithm uses up three additional estimators , namely , the propagations for on - step angular momentum @xmath85 ( eq .  ( 12 ) ) and mid - step time derivative @xmath110 ( eq .  ( 14 ) ) as well as the prediction ( eq .  ( 16 ) ) of angular momentum @xmath111 . among these only the first two evaluations",
    "can be classified as interpolations which correspond to a simple averaging over the two nearest neighbouring values . at the same time , the last prediction ( 16 ) presents , in fact , an extrapolation that is , strictly speaking , beyond the leapfrog framework . indeed , applying equation ( 12 ) for the next step time @xmath112 yields the following interpolated values @xmath113 for angular momenta , which differ from previously predicted ones , i.e. , @xmath114 and , as a consequence , @xmath115 .",
    "extrapolations are commonly used in low - precision explicit schemes and they should be absent in more accurate implicit integrators .    the main idea of the revised approach is to derive an implicit equation for @xmath84 reducing the number of auxiliary interpolations to a minimum and involving no extrapolations .",
    "this can be realized starting from the same evaluation ( 10 ) for mid - step angular momenta , but treating the time derivatives @xmath116 in a somewhat other way .",
    "as was mentioned earlier , these derivatives are necessary to evaluate orientational positions ( eq .  ( 13 ) ) , and they require the knowledge of two per body quantities , namely , @xmath117 and @xmath118 .",
    "it is crucial to remark that since the advanced angular momenta @xmath119 are already known , such two quantities are not independent but connected between themselves by the relation @xmath120 then , as can be seen easily , the calculation of @xmath121 is reduced to a propagation of one variable only , namely , @xmath118 .",
    "it is quite naturally to perform this propagation by writing @xmath122 + { \\cal o}(h^2)\\ ] ] and the algorithm proceeds as follows @xmath123    taking into account expressions ( 19 ) and ( 20 ) , matrix equation ( 21 ) constitutes an implicit system for unknown elements of @xmath84 . as for the usual scheme , the system can be solved iteratively , putting initially @xmath124 for @xmath84 in all nonlinear terms collected in the right - hand side of ( 21 ) .",
    "then the obtained values for @xmath84 in the left - hand side are considered as initial guesses for the next iteration .",
    "the convergence of iterations is justified by the smallness of nonlinear terms which are proportional to the step size @xmath58 .    in such a way",
    ", we have derived a new leapfrog algorithm to integrate orientational degrees of freedom .",
    "it involves only one auxiliary interpolation ( 20 ) which is completely in the spirit of the leapfrog framework .",
    "moreover , this interpolation concerns the most slow variables @xmath77 , rather than their more fast time derivatives @xmath125 and angular momenta @xmath126 , thus , leading to an increased precision of the calculations .",
    "when on - step temperature @xmath127 is required , for instance to check the energy conservation , we can apply usual interpolation ( 12 ) of angular momenta and relation ( 11 ) for velocities .",
    "it is worth underlining that , unlike the standard rotational integrator , the angular - momentum interpolation errors are not introduced into trajectories ( 21 ) produced by the revised algorithm at least within the energy - conserving dynamics .",
    "the extension of the revised scheme to a thermostatted version is trivial . using the calculated temperature @xmath127",
    "we define the scaling factor @xmath99 .",
    "the mid - step angular momenta @xmath128 are then replaced by their modified values @xmath129 ( see eq .  ( 18 ) ) and substituted into eq .",
    "( 19 ) to continue the integration process according to equations ( 20 ) and ( 21 ) .",
    "besides the evident simplicity of the revised approach with respect to the standard scheme , a very nice surprise is that the unit norm of quaternions and the orthonormality of orientational matrices appear to be now by numerical integrals of motion . indeed , considering the quantity @xmath130 as a parameter and explicitly using coordinate interpolation ( 20 ) , we can present eq .",
    "( 21 ) in the equivalent form @xmath131^{-1 } [ { \\bf i}+{\\textstyle \\frac{h}{2 } } { \\bf h}_i(t+{\\textstyle \\frac{h}{2 } } ) ] { \\bf s}_i(t ) \\ , , \\ ] ] where @xmath132 and it is understood that @xmath133 designates either three- or four - dimensional unit matrix in the principal - axis or quaternion domain , respectively .",
    "it can be checked readily that the matrix @xmath134 is orthonormal for an arbitrary skewsymmetric matrix @xmath135 .",
    "as far as the matrix @xmath136 is skewsymmetrical by definition , the following important statement emerges immediately .",
    "if initially the orthonormality of @xmath137 is fulfilled , it will be satisfied perfectly for the advanced matrices @xmath84 as well , despite an approximate character of the integration process .",
    "thus , no artificial or constraint normalizations and no recursive procedures are necessary to conserve the rigidness of molecules .",
    "the alternative presentation ( 22 ) may be more useful for iterating since it provides the orthonormality of @xmath84 at each iteration step and leads to an increased speed of the convergence .",
    "because of this , we show eq .",
    "( 22 ) more explicitly , @xmath138+h { \\bf q}_i}{1+{\\textstyle \\frac{h^2}{16 } } \\omega_i^2(t+{\\textstyle \\frac{h}{2 } } ) } \\ , { \\bf q}_i(t ) \\equiv { \\bf g}_i(t , h ) \\ , { \\bf q}_i(t ) \\ , , \\\\ [ 15pt ] { \\bf a}_i(t+h)&=&\\frac{{\\bf i}\\,[1-{\\textstyle \\frac{h^2}{4 } } \\omega_i^2(t+{\\textstyle \\frac{h}{2}})]+h{\\bf w}_i+ { \\textstyle \\frac{h^2}{2}}{\\bf p}_i}{1 + { \\textstyle \\frac{h^2}{4 } } \\omega_i^2(t+{\\textstyle \\frac{h}{2 } } ) } \\ , { \\bf a}_i(t ) \\equiv { \\bf d}_i(t , h ) \\ , { \\bf a}_i(t ) \\ , , \\end{aligned}\\ ] ]    for the cases of quaternion and entire - rotation - matrix representations , respectively , where expressions ( 3 ) and ( 5 ) for matrices @xmath139 and @xmath140 have been taken into account , @xmath141 and @xmath142 are orthonormal evolution matrices , and @xmath143_{\\alpha \\beta}={\\omega}_\\alpha^i { \\omega}_\\beta^i$ ] denotes a symmetric matrix which , like @xmath144 and @xmath145 , is calculated using principal angular velocities ( 19 ) . in view of the equalities @xmath146 and @xmath147 , the evolution matrices can be cast also in the matrix - exponential forms @xmath148_{t+\\frac{h}{2 } } \\ , , \\ \\ \\ \\ \\ \\",
    "\\phi_i=2 \\arcsin \\frac{\\frac{h}{2 } \\omega_i(t+{\\textstyle \\frac{h}{2 } } ) } { 1+{\\textstyle \\frac{h^2}{16 } } \\omega_i^2(t+{\\textstyle \\frac{h}{2 } } ) } \\ , , \\nonumber \\\\ [ -2pt ] \\\\ [ -2pt ] { \\bf d}_i(t , h)&=&{\\rm \\bf exp}[\\varphi_i { \\bf w}_i/ \\omega_i]_{t+\\frac{h}{2 } } \\ , , \\ \\ \\ \\ \\",
    "\\varphi_i=\\arcsin \\frac{h \\omega_i(t+{\\textstyle \\frac{h}{2 } } ) } { 1+{\\textstyle \\frac{h^2}{4 } } \\omega_i^2(t+{\\textstyle \\frac{h}{2 } } ) } \\ , . \\nonumber\\end{aligned}\\ ] ]    then it becomes clear that the matrices @xmath149 and @xmath150 define three- and four - dimensional rotations on angles @xmath151 and @xmath152 in the laboratory frame and quaternion space , respectively .",
    "in the first case the rotation is carried out around the unit vector @xmath153 , whereas in the second one it is performed around an orth which is perpendicular to all four orths of quaternion space .",
    "another excellent feature of the algorithm is that within the entire matrix representation , equation ( 24 ) can be handled in a non - iterative way using so - called quasianalytical solutions for mid - step angular velocities @xmath130 . to show this we first perform a set of further transformations . remembering that now @xmath154 and @xmath155 , one adds the matrix @xmath14 to the both sides of eq .",
    "( 21 ) and divides the obtained equation by factor 2 .",
    "then using coordinate propagation ( 20 ) leads to @xmath156 multiplying eq .",
    "( 26 ) on the matrix @xmath157 from the left and additionally on the vector @xmath108 from the right , and taking into account definition ( 19 ) yields @xmath158    therefore , the iterative problem is much simplified , because it is reduced to finding solutions to three - dimensional vector equation ( 27 ) for three unknown components @xmath159 , @xmath160 and @xmath161 of @xmath117 rather than to matrix equation ( 24 ) ( or ( 21 ) ) for nine unknowns elements of @xmath162 .",
    "equation ( 27 ) can be solved iteratively again , choosing @xmath163 as the initial guess for @xmath164 .",
    "a next simplification lies in the following .",
    "let us rewrite equation ( 27 ) in the explicit form @xmath165 where @xmath166 , @xmath167 , @xmath168 , and @xmath169 are the components of known vector @xmath170 , keeping in mind that vector @xmath108 must be replaced by @xmath129 in the case of temperature - conserving dynamics .",
    "unless @xmath171 , the system of equations ( 28 ) appears to be linear and , therefore , it can easily be solved exactly ( see subsect .",
    "d , where specific models are described ) . here",
    ", we consider the most general case when all the principal moments of molecules are different and assume for definiteness that @xmath172 .",
    "then the first two unknowns @xmath159 and @xmath160 are the most fast variables and they should be excluded from the iteration to increase the convergence . such an excluding indeed can be realized solving the first two equations of ( 28 ) with respect to @xmath159 and @xmath160 .",
    "the result is @xmath173 where @xmath174 .",
    "the last inequalities follow from the requirements @xmath175 and @xmath176 imposed on principal moments of inertia , where @xmath177 denote an array of three cyclic permutations of @xmath178 . in view of ( 29 ) , only the third equation of system ( 28 ) really needs to be iterated with respect to one variable @xmath161 .",
    "since @xmath161 is the most slow quantity , a well convergence can be guaranteed even for not so well normally behaved case as an almost linear body , when @xmath179 .    finally , one considers the question of how to obviate iterative solutions at all . substituting the result ( 29 ) into the third equation of system ( 28 ) and presenting the @xmath180th component of the angular velocity in the form @xmath181 yields the following algebraic equation @xmath182 with the coefficients @xmath183 \\ , , \\nonumber \\\\ a_1&=&\\vartheta_+ - h^2 \\ { ( \\varrho_y \\theta_x^2 + \\varrho_x \\theta_y^2 ) \\varrho_z - \\nu^2 s_0 [ ( 5 s_0 - 4 \\theta_z ) \\vartheta_+ + 2 h \\theta_x \\theta_y   \\varrho_z ] \\ } \\ , , \\nonumber",
    "\\nu^2 [ 6 s_0 - 2 \\theta_z + h \\varrho_z \\theta_x \\theta_y + h^2 \\nu^2 s_0 ^ 2 ( 10 s_0 - 6 \\theta_z ) ] \\ , , \\\\ a_3&= & 2 h^2 \\nu^2 [ 1 + h^2 \\nu^2 s_0 ( 5 s_0 - 2 \\theta_z ) ] \\ , , \\nonumber \\\\",
    "a_4&=&h^4 \\nu^4 ( 5 s_0 - \\theta_z ) \\ , , \\ \\",
    "a_5 = h^4 \\nu^4 \\ , , \\nonumber\\end{aligned}\\ ] ] where @xmath184 . the equation ( 30 )",
    "is fifth order and the corresponding solutions for @xmath35 are independent on parameter @xmath185 , provided the unknown @xmath186 is precisely determined .",
    "however , as is well known , only algebraic equations of fourth or less order allow to be solved in quadratures .",
    "the main idea of quasianalytical solutions consists in the fact that actual md simulations are performed with relative small values of the time step @xmath58 .",
    "then it is necessary to choose the parameter @xmath185 as a good prediction for @xmath161 to be entitled to ignore high - order terms in the left - hand side of eq .",
    "( 30 ) . the simplest choice for this can be found putting @xmath187 in the right - hand side of the third equation of system ( 28 ) . as a result , one obtains @xmath188 that represents the original value of @xmath161 with second - order truncation errors , so that @xmath189 .",
    "it is easy to see that in this case the two last terms @xmath190 and @xmath191 in the left - hand side of eq .",
    "( 30 ) behaves as @xmath192 and @xmath193 , respectively .",
    "taking into account the smallness of @xmath58 , such terms can merely be omitted without any loss of the precision , because they involve uncertainties of order @xmath192 into the solutions and appear to be too small with respect to third - order truncation errors @xmath194 inherent initially in the algorithm .",
    "( 30 ) is now transformed to the third - order algebraic equation @xmath195 which can easily be solved analytically .",
    "the result is @xmath196+{\\cal o}(h^{12 } ) \\ , , \\nonumber\\end{aligned}\\ ] ] where @xmath197 among three solutions ( 34 ) , only the first one @xmath198 is real and satisfies the physical boundary condition @xmath199 when @xmath58 goes to zero ( the other two solutions @xmath200 are purely imaginary at @xmath201 and they tend to infinity as @xmath202 ) .",
    "therefore , the desired @xmath180th component of the angular velocity is @xmath203 the rest two components @xmath159 and @xmath160 are reproduced on the basis of equalities ( 29 ) .",
    "the obtained vector @xmath204 is substituted into equation ( 24 ) to perform the explicit evaluation for advanced orientational matrices @xmath162 .",
    "this completes the algorithm .",
    "there are two main classes of models for interacting rigid bodies , which most frequently are applied in md simulations .",
    "more realistic so - called interaction site models can be related to the first class . for these models , each @xmath6th body of the system",
    "is considered as a molecule which in its turn is composed of @xmath205 point interaction sites ( atoms ) .",
    "the rigid structure of molecules is completely defined by time - independent vector - positions @xmath206 ( @xmath207 ) of atom @xmath208 within molecule @xmath6 in the body frame , whereas these positions in the laboratory frame are : @xmath209 . using the known site - site potentials @xmath210",
    ", the desired molecular forces and torques can easily be computed as @xmath211 and @xmath212 , respectively , where @xmath213 and @xmath214 .",
    "the second class is point molecules ( @xmath215 ) with embedded multipoles .",
    "the most popular model belonging this class is a system of point electro - dipoles .",
    "the molecular forces and torques caused by dipole - dipole interactions can be calculated using the relations @xmath216 $ ] and @xmath217 $ ] , respectively , where @xmath218 and @xmath219 denotes the dipole moment of @xmath6th molecule .    although the proposed algorithm can be implemented for arbitrary rigid models , some simplifications with respect to the general formulation are possible using special properties of the body .",
    "the simplest case is bodies with a spherical distribution of mass , when all the moments of inertia are equal between themselves , i.e. , when @xmath220 and , thus , @xmath221",
    ". then it is more convenient to work with equations ( 2 ) for rotational matrices , presented in terms of angular velocities @xmath222 in the laboratory frame , i.e. , with @xmath223 .",
    "the leapfrog trajectories for these equations are obvious : @xmath224 _ { t+\\frac{h}{2}}$ ] , where @xmath225 and @xmath226_{t+\\frac{h}{2}}$ ] .    for some particular models ,",
    "the orientational part of the intermolecular potential can be expressed using only unit three - component vectors @xmath227 passing through the centres of mass of molecules .",
    "the examples are point dipole interactions , when @xmath228 , or when all force sites of the molecule are aligned along @xmath229 , resulting in torques which are perpendicular to @xmath230 , i.e. , @xmath231 . if then additionally @xmath232 ( for the last example this can be possible when forceless mass sites are placed in such a way to ensure the spherical mass distribution ) , it is no longer necessary to deal with orientational matrices or quaternions . in this case",
    "the equation for @xmath227 looks as @xmath233 with the solution @xmath234_{t+\\frac{h}{2 } } { \\mbox{\\boldmath $ \\rho$}}_i(t)$ ] .    for molecules with cylindric distribution of mass sites ,",
    "when two of three of principal moments of inertia are equal , the numerical trajectory can also be determined in a simpler manner .",
    "let us assume for definiteness that @xmath235 and @xmath236 .",
    "then arbitrary two perpendicular between themselves axes , lying in the plane perpendicular to the @xmath180th principal axis , can be considered initially as @xmath237- and @xmath238-th principal orths . since now @xmath239 , the @xmath180th component of the angular velocity is found automatically , @xmath240 . as in the general case ,",
    "the two rest solutions @xmath159 and @xmath160 of system ( 28 ) are calculated on the basis of eq .",
    "( 29 ) taking into account that @xmath241 , whereas the orientational matrices are evaluated via eq .",
    "( 24 ) .    a special attention must be paid for purely linear molecules when @xmath242 and each body has two , instead of free , orientational degrees of freedom .",
    "the relative positions @xmath243 of all atoms within a linear molecule can be expressed in terms of an unit vector @xmath227 and besides @xmath244 one finds that @xmath245_z= j_{zz}^i { \\omega_z^i}=0 $ ] .",
    "the rotational part @xmath246 of the kinetic energy is also indifferent to the @xmath180th component @xmath35 of the principal angular velocity .",
    "such a component causes irrelevant rotations of the molecule around @xmath227-axis and it does not lead to any change of @xmath247 and the potential energy .",
    "it can be shown that the angular - momentum approach allows to reproduce the correct time evolution of two - dimensional unit vector @xmath227 by the three - dimensional leapfrog rotation @xmath248_{t+ \\frac{h}{2 } } { \\mbox{\\boldmath $ \\rho$}}_i(t)$ ] putting formally @xmath249 , where two other components of @xmath250 are @xmath251 and @xmath252 ( this immediately follows from eq .  ( 28 ) ) .",
    "planar molecules do not present a specific case within our approach and they are handled in the usual way as tree - dimensional bodies .",
    "the system chosen for numerical tests was the tip4p model ( @xmath253 ) of water [ 32 ] at a density of @xmath254 g @xmath255 and a temperature of @xmath256 k. because of the low moments of inertia of the water molecule and the large torques due to the site - site interactions , such a system should provide a very severe test for rotational algorithms . in order",
    "to reduce cut - off effects to a minimum we have applied an interaction site reaction field geometry [ 33 ] and a cubic sample with @xmath257 molecules . all runs were started from an identical well equilibrated configuration .",
    "the md simulations have been carried out in both energy - conserving ( nve ) and thermostatted ( nvt ) ensembles .",
    "the equations of rotational motion were integrated using the standard quaternion integrator [ 27 ] and our revised leapfrog algorithm .",
    "as far as water is usually [ 34 ] simulated in an nve ensemble by the atomic - constraint technique [ 4 , 5 ] , the corresponding calculations on this approach and the angular - velocity verlet method [ 28 ] were performed for the purpose of comparison as well .",
    "all the approaches required almost the same computer time per step given that near 97% of the total time were spent to evaluate pair interactions .",
    "the following thermodynamic quantities were evaluated : total energy , potential energy , temperature , specific heat at constant volume , and mean - square forces and torques .",
    "the structure of the tip4p water was studied by determining the oxygen - oxygen and hydrogen - hydrogen radial distribution functions ( rdfs ) .",
    "orientational relaxation was investigated by evaluating the molecular dipole - axis autocorrelations .",
    "centre - of - mass and angular - velocity time autocorrelation functions were also found . to reduce statistical noise ,",
    "the measurements were averaged over 20 000 time steps .    in the case of nve dynamics to verify whether the phase trajectories are produced properly , we applied the most important test on conservation of total energy @xmath258 of the system .",
    "the total energy fluctuations @xmath259^{1/2}/|\\langle e \\rangle|$ ] as functions of the length of the simulations over 10 000 time steps are plotted in fig .  1 ( a)(d ) at four fixed step sizes , @xmath260 1 , 2 , 3 and 4 fs . both principal - axis (",
    "the boldest curves in subsets ( a)(d ) ) and quaternion representations were used to integrate the equations by the revised leapfrog algorithm .",
    "it has been established that the functions @xmath261 corresponding to these representations are practically the same .",
    "for this reason and to simplify the graph notations the results obtained within quaternion variables are shown ( as crosses ) only in subset ( d ) of the figure .",
    "as can be seen easily , the standard rotational leapfrog algorithm exhibits relatively bad stability properties and conserves the energy rather poor even at the smallest step size considered .",
    "it is worth remarking that investigating the system during shorter time periods with small step sizes , for example over 1000 time steps with @xmath260 1 fs , one may come to very misleading conclusions on the energy conservation .",
    "a significantly better pattern is observed for the angular velocity verlet integrator .",
    "however , the improvements in stability are quite insufficient especially for moderate and large step sizes ( @xmath262 3 fs , subsets ( c)(d ) ) . finally , we can talk about the best energy conservation and long - term stability for the atomic - constraint scheme and the revised leapfrog algorithm which lead to virtually identical results .",
    "it is necessary to emphasize that within the principal - axis representation , the revised leapfrog trajectories were evaluated using the non - iterative quasianalytical scheme . the exact solutions ( by means of iterations of eq .  ( 28 ) )",
    "were computed too to compare it with quasianalytical values .",
    "no deviation between both trajectories has been found up to @xmath263 fs .",
    "they differed on each step by uncertainties of order round - off errors , so that the quasianalytical hypothesis appears to be in an excellent accord . at the same time , the quaternions converged at each step to a relative tolerance of @xmath264 in average from 6 to 14 iterations with varying the step size from 2 fs to 6 fs .",
    "we also tried to avoid iterative procedures for quaternion variables by applying a hybrid leapfrog scheme when the quasianalytical solutions for mid - step angular velocities are substituted directly into orthogonormal matrices for quaternion evaluation ( 23 ) .",
    "however , the hybrid scheme leads to a significant loss of the precision ( see the long - dashed curve in subset ( d ) of fig .  1 ) .",
    "this is so because equation ( 27 ) for angular velocities was obtained on the basis of interpolation ( 20 ) for principal - axis variables , i.e. , when @xmath265 $ ] . using these velocities in the quaternion space causes an inconsistency of such an interpolation with the corresponding interpolation @xmath266 $ ] for quaternions since @xmath267 \\ne \\frac12 ( { \\bf a}_i[{\\bf q}_i(t)]+{\\bf a}_i[{\\bf q}_i(t+h)])$ ] .",
    "therefore , to follow rigorously the leapfrog framework , the auxiliary mid - step angular velocities must be involved within the principal - axis representation exclusively .",
    "no shift of the total energy and temperature was observed during the revised leapfrog trajectories at @xmath268 fs over a length of 20 000 time steps . as is well known , to reproduce features of an nve ensemble correctly",
    ", the ratio @xmath269 of the total energy fluctuations to the corresponding fluctuations @xmath270 of the potential energy must be within a few per cent .",
    "the following levels of @xmath261 at the end of the revised leapfrog trajectories have been obtained : 0.0016 , 0.0066 , 0.017 , 0.030 , 0.051 and 0.11 % .",
    "they correspond to @xmath271 0.29 , 1.2 , 3.0 , 5.4 , 9.1 and 20 % at @xmath260 1 , 2 , 3 , 4 , 5 and 6 fs , respectively , where it was taken into account that @xmath272 for the investigated system .",
    "the deviations in all the rest measured functions with respect to their benchmark values ( obtained in the atomic - constraint nve simulations with @xmath260 2 fs ) were in a complete agreement with the corresponding relative deviations @xmath273 in the total energy conservation .",
    "for example , the results of the revised leapfrog algorithm at @xmath260 2 fs were indistinguishable from the benchmark ones , whereas they differed as large as around 5% , 10% and 20% with increasing the time step to 4 fs , 5 fs and 6 fs , respectively . however , the differences were much smaller than in the case of the standard rotational integrator .",
    "we see , therefore , that step sizes of order 5 fs are still suitable for precise nve calculations .",
    "even a time step of 6 fs can be acceptable when a great precision is not so important , for instance , to achieve an equilibrium state .    what about the nvt simulations",
    "? it is well established [ 27 , 35 ] that thermostatted versions allow to perform reliable calculations with significantly greater step sizes than those used within the energy - conserving dynamics . to confirm such a statement ,",
    "we have made nvt runs on the basis of our non - iterative revised leapfrog algorithm ( within principal - axis variables ) and a thermostatted version of the standard implicit integrator [ 27 ] of fincham .",
    "the oxygen - oxygen and hydrogen - hydrogen rdfs , calculated during the revised leapfrog trajectories for three different step sizes , @xmath260 2 , 8 and 10 fs , are plotted in fig .",
    "2a by the curves in comparison with the benchmark result ( open circles ) .",
    "note that the rdfs corresponding to @xmath274 and 6 fs coincide completely with those for @xmath275 fs and they are not included in the graph .",
    "a similar behaviour of rdfs was identified for the standard rotational integrator , but the results are somewhat worse especially at @xmath260 8 and 10 fs .",
    "no drift of the potential energy was observed at @xmath276 fs and @xmath277 fs for the revised and standard algorithms , respectively . from the above",
    ", we can conclude that the revised leapfrog integrator is suitable for simulating even with huge step sizes of 10 fs , because then there is no detectable difference in rdfs .",
    "other thermodynamic quantities such as the centre - of - mass and angular - velocity time autocorrelation functions appeared to be also close to genuine values .",
    "quite recently , it was shown [ 36 ] that the time interval of 10 fs should be considered as an upper theoretical limit for the step size in md simulations on water .",
    "we see , therefore , that this limit can be achieved in practice using the revised leapfrog algorithm .",
    "the molecular dipole - axis time autocorrelation function is the most sensitive quantity with respect to varying the step size .",
    "such a function obtained within the standard ( s ) and revised ( r ) schemes at five fixed step sizes , @xmath260 2 , 4 , 6 , 8 and 10 fs , is presented in fig .",
    "2b . for @xmath278 6 fs the results of s- and r - schemes are indistinguishable between themselves .",
    "with increasing the step size to 8 fs or higher we can observe a systematic discrepancy which is smaller in the case of the r - scheme .",
    "reliable results can be obtained here at time steps of @xmath279 8 fs for both the standard and revised schemes .",
    "however within the standard approach , the solutions converged too slow already at @xmath260 6 fs and they began to diverge at greater step sizes . to perform the simulations in this case , special time - consuming transformations to unsure the convergence have been applied . for",
    "the revised integrator which is free of iterations , the computer time did not depend on the step size .",
    "during last years there was a slow progress in the improvement of existing md techniques concerning the numerical integration of motion for systems with interacting rigid bodies .",
    "we have attempted to remedy such a situation by formulating a revised angular - momentum approach within the leapfrog framework . as a result , a new integrating algorithm has been derived .",
    "the revised approach reduces the number of auxiliary interpolations to a minimum , applies the interpolations to the most slow variables and avoids any extrapolations .",
    "this has allowed to achieve the following two significant benefits : ( i ) all final expressions are evaluated explicitly without involving any iterative procedures , and ( ii ) the rigidity of bodies appears to be a numerical integral of motion .",
    "another positive feature of the algorithm is its simplicity and universality for the implementation to arbitrary rigid structures with arbitrary types of interactions .    as has been shown on the basis of actual simulations of water , the proposed algorithm exhibits very good stability properties and conserves the total energy in microcanonical simulations with the same precision as the cumbersome atomic - constraint technique . in the case of temperature - conserving dynamics , reliable calculations are possible with huge step sizes around 10 fs .",
    "such sizes are very close to the upper theoretical limit and unaccessible in usual approaches .",
    "j. p. ryckaert , g. ciccotti , and h. j. c. berendsen , `` numerical integration of the cartesian equations of motion of a system with constraints : molecular dynamics of @xmath280-alkanes '' , j. comput .",
    "phys . , 23 , 327 ( 1977 ) .",
    "d. levesque , j. j. weis , and g. n. patey , `` fluids of lennard - jones spheres with dipoles and tetrahedral quadrupoles . a comparison between computer simulation and theoretical results '' , mol .",
    ", 51 , 333 ( 1984 ) .",
    "w. c. swope , h. c. andersen , p. h. berens , and k. r. wilson , `` a computer simulation method for the calculation of equilibrium constants for the formation of physical clusters of molecules : application to small water clusters '' , j. chem .",
    "phys . , 76 , 637 ( 1982 ) .",
    "d. brown and j. h. r. clarke , `` a comparison of constant energy , constant temperature and constant pressure ensembles in molecular dynamics simulations of atomic liquids '' , mol .",
    "phys . , 51 , 1243 ( 1984 ) .",
    "1 . the total energy fluctuations as functions of the length of the nve simulations on the tip4p water , evaluated in various techniques at four fixed time steps : * ( a ) * 1 fs , * ( b ) * 2 fs , * ( c ) * 3 fs and * ( d ) * 4 fs .    fig .",
    "oxygen - oxygen ( o - o ) and hydrogen - hydrogen ( h - h ) radial distribution functions * ( a ) * , and orientational relaxation * ( b ) * , obtained in nvt simulations on the tip4p water using the revised ( * ( a ) * , * ( b ) * ) and standard ( * ( b ) * ) leapfrog algorithms .",
    "the results corresponding to the step sizes @xmath260 2 , 8 and 10 fs are plotted by bold solid , short - dashed and thin solid curves , respectively .",
    "additional long - short dashed and dashed curves in * ( b ) * correspond to cases of @xmath260 4 and 6 fs .",
    "the sets of curves related to standard and revised integrators are labelled in * ( b ) * as `` s '' and `` r '' , respectively .",
    "the benchmark data are shown as open circles .",
    "note that the standard- and revised - algorithm curves are indistinguishable in * ( b ) * at @xmath260 2 , 4 and 6 fs ."
  ],
  "abstract_text": [
    "<S> a new algorithm is introduced to integrate the equations of rotational motion . </S>",
    "<S> the algorithm is derived within a leapfrog framework and the quantities involved into the integration are mid - step angular momenta and on - step orientational positions . </S>",
    "<S> contrary to the standard implicit method by fincham [ mol . </S>",
    "<S> simul . , 8 , 165 ( 1992 ) ] , the revised angular momentum approach presented corresponds completely to the leapfrog idea on interpolation of dynamical variables without using any extrapolations . </S>",
    "<S> the proposed scheme intrinsically preserves rigid molecular structures and considerably improves stability properties and energy conservation . </S>",
    "<S> as is demonstrated on the basis of simulations for water , it allows to reproduce correct results with extra large step sizes of order 5 fs and 10 fs in the cases of energy- and temperature - conserving dynamics , respectively . </S>",
    "<S> we show also that iterative solutions can be avoided within our implicit scheme shifting from quaternions to the entire rotation - matrix representation .    </S>",
    "<S> * keywords : * numerical algorithms ; long - term integration ; motion of rigid bodies ; polyatomic molecules </S>"
  ]
}