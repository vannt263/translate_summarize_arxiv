{
  "article_text": [
    "the problem of approximating the ground energy of a local hamiltonian describing a physical system is one of the major problems in condensed matter physics ; in the area of quantum computation this problem is called the local hamiltonian problem @xcite .",
    "formally , in the @xmath1-local hamiltonian problem , we are given a hamiltonian @xmath2 which is a sum of positive semidefinite terms , each acting on a set of at most @xmath1 out of @xmath3 qubits , where @xmath1 is of order @xmath4 , and each term is of bounded norm .",
    "moreover , we are given two numbers , @xmath5 such that @xmath6 .",
    "we are asked whether @xmath2 has an eigenvalue below @xmath7 or all its eigenvalues are above @xmath8 , and we are promised that the instance belongs to one of the two cases .",
    "it turns out that the problem of understanding ground states and ground values of local hamiltonians , central to condensed matter physics , is the quantum generalization of one of the most important problems in classical computational complexity , namely , sat . indeed , in a seminal work",
    ", kitaev has shown that in parallel to the important of the sat problem in np theory , the local hamiltonian problem is complete for the quantum analogue of np ( denoted qma ) in which both witness and verifier are quantum rather than classical .",
    "the analogy between the quantum and the classical problems is derived by viewing the terms of the hamiltonians as generalizing the notion of classical constraints ; energies are viewed as a penalty for a constraint violation .",
    "for example , to view the local constraints for the classical sat as a special instance of local hamiltonians , we assign for each clause a projection on the assignment forbidden by this clause .",
    "the projections we derive are of course all projections in the computational basis ; in the general quantum case , the terms need not be diagonal in any particular basis , and the ground state can be highly entangled .",
    "this connection linking the physics and the computational complexity problems has drawn much attention over the past few years , and has led to many exciting results and insights ( eg . , @xcite ) .",
    "the computational view of the local hamiltonian problem and its connection to classical np problems , has led bravyi and vyalyi in @xcite to the following very natural question : what would happen if we only generalize from classical to quantum `` half way '' : we allow the terms in the hamiltonian to be projections in any basis , but we restrict them in that all the projections pairwise commute .",
    "we are asked to decide whether the ground energy is @xmath9 ( namely , there exists a state which is in the ground space of all projections ) or it is larger than @xmath9 ( for pairwise - commuting projections , the overall energy , namely eigenvalue , of such a state must be at least @xmath4 ) .",
    "this problem is the commuting local hamiltonian problem .",
    "the interest in the commuting hamiltonian problem is related to several important issues in quantum computational complexity .",
    "the first is conceptual : a common intuition is that the counter intuitive phenomena in quantum mechanics stems from the fact that non - commuting operators are involved ( cf the heisenberg s uncertainty principle ) .",
    "one might conjecture , using this intuition , that the commuting local hamiltonian problem is far weaker than the general local hamiltonian problem , and might be of the same complexity as sat , namely , lie in np .",
    "however , a counter intuition exists : the intriguing strictly quantum phenomenon of topological order , which is exhibited for example in toric codes @xcite , can be achieved by ground states of commuting hamiltonians .",
    "it is thus natural to ask where does the computational complexity of the commuting hamiltonian problem lie : is it in np , is it perhaps quantum - np complete ( where here the relevant quantum analogue of np is in fact , @xmath10 , where there is only one sided error ) or maybe the commuting local hamiltonian problem defines an intermediate computational class of its own ?",
    "the study of this problem can also be viewed as tightly related to an exciting major open problem in quantum hamiltonian complexity : the question of whether a pcp - like theorem holds in the quantum setting or not @xcite .",
    "embarrassingly , this problem is still open even for the seemingly much easier case of commuting local hamiltonians .",
    "clearly , a pcp - type theorem would follow trivially if the commuting local hamiltonian problem were in np , but even if this were not true , one might still hope to prove a pcp - type theorem for the restricted problem before proceeding to the more general case .",
    "we recall that several results in quantum hamiltonian complexity , such as the area law in 1dim @xcite the decay of correlations in gapped hamiltonians @xcite , and quantum gap amplification @xcite were all proven exactly in this way , by starting from the easier commuting case , and generalizing from there ; it seems reasonable to hope that better understanding of the commuting case would help clarify the quantum pcp conjecture in general . more generally ,",
    "understanding the complexity of the commuting local hamiltonian problem might not only shed light on the role of commutativity in quantum hamiltonian complexity , and possibly lead to progress on open problems in quantum complexity theory , but also , it seems that an answer to this question would necessarily require new insights regarding the nature of multi - particle entanglement .    in @xcite",
    "an important step was made towards resolving the computational complexity of the commuting local hamiltonian problem .",
    "bravyi and vyalyi showed that for @xmath11 , namely for two - body interactions , regardless of the dimensionality @xmath12 of the particles involved , the problem lies in np .",
    "the method they use is interesting by itself ; they cleverly apply the theory of representations of @xmath13-algebras to the problem . however , their methods break down for three - wise interactions .",
    "the general problem was thus left open by @xcite , and no progress was noted on this problem since its inception in 2003 .      in this paper",
    "we extend the results of @xcite to three - local interactions with the following two results .",
    "we prove :    [ mainclaim ] the problem of @xmath14-local commuting hamiltonian on qubits is in np .",
    "[ mainclaim2 ] ( roughly stated ) the problem of @xmath14-local commuting hamiltonian on qutrits is in np , as long as the interaction graph is planar , and moreover , _ _ n__early euclidean .",
    "the notion of nearly euclidean will be defined later ( see definition [ def : nedef ] ) ; roughly , it formalizes the requirement that the embedding makes sense physically : no area on the plane can have a particularly high density of particles , and only close - by particles can interact .",
    "this of course includes also the interesting special case of periodic lattices , or small perturbations of those .    unlike what might be expected",
    ", the extension does not seem to follow easily from the result of @xcite . when attempting to apply the proof of @xmath15 to the case in which three local interactions are involved , ( even when the particles are assumed to be qubits ) severe problems occur .",
    "we will provide the overview of the proof of bravyi and vyalyi , why it breaks down for three - wise interactions and how we overcome this , later in the introduction .",
    "let us first describe some implications of our results to the seemingly unrelated topic of conditions for topological order .",
    "topological order is a purely quantum phenomenon ; roughly , a state exhibits a topological order if there exists a state orthogonal to it , and the two can not be distinguished or connected by a local operator .",
    "such characteristics are extremely valuable in the context of fault tolerance , and topological order has attracted much attention for theoretical and implementation purposes for that reason .",
    "a celebrated example of a system exhibiting topological order in the context of quantum computation is the toric code , due to kitaev @xcite ; it can be defined as the ground space of a set of @xmath0-local commuting operators on qubits arranged on the two dimensional grid , or alternatively , by @xmath14-local commuting interactions between @xmath0-dimensional particles .",
    "topological order defined via commuting local hamiltonians is particularly interesting : for example , recently it has been shown ( @xcite ) that such systems are also resilient to local perturbations .",
    "it is therefore natural to ask whether it is possible to achieve topological order in ground states of local commuting hamiltonians , with smaller dimensionality or with less particles interacting . using the above results",
    ", we can resolve this problem to the negative .",
    "we show that kitaev s construction is optimal in a well defined sense .",
    "* tight conditions for topological order * [ thm : to ] ( roughly ) consider a system of particles with commuting interactions which are either @xmath16-local , or they are @xmath14-local and the dimensionality of the particles is at most @xmath14 .",
    "moreover , assume the interaction graph is nearly euclidean planar",
    ". then this system can not exhibit topological order , and moreover , in a well defined sense , the entanglement in the ground space is local . on the other hand ,",
    "there exist nearly euclidean planar systems of @xmath14-local interactions with particles of dimensionality @xmath0 that exhibit topological order , hence we derive a tight boundary between local entanglement and topological order .",
    "to explain how our results are related to conditions on topological order , observe the following .",
    "a key property of topological order states is that their entanglement is non - local .",
    "in particular , bravyi , hastings and verstraete showed in @xcite ( see theorem ( [ thm : bhv ] ) , that if a nearest neighbor quantum circuit generates a state with topological order on the @xmath17 grid , the circuit has to be of depth @xmath18 .",
    "the methods we use , as well as those of @xcite , however , imply that the ground space has a basis of states with localized entanglement .",
    "more precisely , the proofs of theorems [ mainclaim ] and [ mainclaim2 ] also imply that any nearly euclidean planar commuting hamiltonian system , that is either @xmath16-local , or @xmath14-local with particle dimensionality @xmath19 , has a basis of eigenstates all of which can be generated by a constant depth quantum circuit whose gates act on nearest neighbor particles on the plane ( where by nearest neighbor , we mean neighbors in the interaction graph of the hamiltonian ) .",
    "this means that such systems can not exhibit topological order in all the states in their groundspace .",
    "the toric codes , however , can be easily seen as a the ground space of an instance of the commuting @xmath14-local hamiltonian problem on qudits of dimension @xmath0 ( by gluing pairs of qubits together - see section [ sec : to ] and in particular figure ( [ fig : tc ] ) ) .",
    "thus , this is an instance of @xmath20 in which any state in the groundspace exhibits topological order .",
    "our results thus imply that in the context of `` physical '' planar systems , there exists a tight boundary between topological order systems and constant - depth systems : for @xmath21 and all @xmath22 or @xmath23 and @xmath24 there exist nearly euclidean planar systems which exhibit topological order , whereas for @xmath23 and @xmath25 , or for @xmath11 and any @xmath12 , all nearly euclidean planar systems have a constant - depth diagonalizing circuit and can not exhibit topological order .",
    "we deduce that kitaev s construction can not be simplified either in terms of particle dimensionality or number of particles in each interaction , and so it is optimal for commuting hamiltonians .",
    "let us embark on trying to explain the proof , by first explaining the main idea in the proof of bravyi and vyalyi of the two - local case , for any particle dimensionality . to do that",
    ", we consider the hypergraph describing the interactions in the hamiltonian .",
    "we observe that in the two - local case , every particle is the center of a `` star '' of interactions - the interactions acting on @xmath26 intersect only on @xmath26 .",
    "this is not true when interactions are three - local , as one can see in figure ( [ fig : hyper ] ) .",
    "bravyi and vyalyi prove a lemma ( restated here as lemma [ lem : bv ] ) , which shows that particles which are centers of `` stars '' , are what we call `` separable '' .",
    "this means that if @xmath26 is such a center of a star , its hilbert space @xmath27 can be _ decomposed _ to a direct sum of subspaces , which are all preserved by all interactions involving @xmath26 : @xmath28 moreover , each subspace @xmath29 can be written as a tensor product of sub - particles , @xmath30 where @xmath1 runs over all particles that interact with @xmath26 , and the interaction between @xmath26 and @xmath1 is non - trivial only on the relevant sub - particle , @xmath31 . this way , the restriction to one of the subspaces implies a decoupling of the interactions involving @xmath26 to interactions that act on separate sub - particles !",
    "when all particles are center of stars as is the case for the two - local , after each particle is restricted to one of its subspaces the restricted hamiltonian is a set of disjoint edges .    from this @xcite",
    "derive a proof that the two - local problem lies in np - essentially , the witness is the specification of the choice @xmath32 of the correct subspace of each particle , in which the groundstate lies .",
    "the above proof also implies that in the two - local case , there is an eigenbasis of the hamiltonian in which any eigenstate ( and in particular any ground state ) has a very limited and local structure of entanglement - the state can be generated by a depth - two quantum circuit which uses only two - local gates .",
    "of course , a natural question is whether these techniques can be applied for the more general case , namely , for higher values of @xmath1 .",
    "trivially , when generalizing from @xmath16-local interactions to @xmath14-local interactions we immediately loose the star topology which was a crucial component in ( @xcite ) .",
    "see , for example , figure [ fig : ex1 ] .",
    "however , this example is not truly a problem .",
    "because we restrict our attention to qubits , the low dimensionality implies that one can not `` block - diagonalize '' an operator on a qubit @xmath26 in more than one way .",
    "thus it turns out that in the example above , there is indeed a `` consensus '' decomposition of @xmath26 preserved by all @xmath14 operators on @xmath26 .",
    "however , consider the example of @xmath0 operators on @xmath0 qubits in figure [ fig : ex2 ] .",
    "since any pair of operators share @xmath16 qubits , it may be that for none of the qubits does there exist a direct - sum decomposition which is preserved by all operators on that qubit .",
    "this in fact emanates from the nature of the commutativity relation for @xmath14-local terms : it can be generated using not just one particle as in @xmath15 but may involve more complex relations involving two particles .      the way we overcome this obstacle is by showing that truly complex structures , such as the example of figure [ fig : ex2 ] , can only be of local nature ,",
    "after we remove all separable qubits from the system . in other words , any attempt to expand such examples by adding more interactions with additional qubits inevitably makes are least one qubit separable .",
    "the proofs of the two theorems turn out to require quite different tools to achieve this goal ; below we provide overviews of those proofs .",
    "let us start with explaining the proof of theorem [ mainclaim ] , namely the case of qubits .",
    "we build upon the analysis of @xcite , identifying qubits which behave `` classically '' . those are qubits for which there exists an orthogonal basis , such that all operators are block - diagonal w.r.t . this basis .",
    "we call those qubits `` separable '' . if the original system has a zero eigenstate , so does a restricted version of the system when each separable qubit is restricted to one of those subspaces .",
    "this restriction of each of the qubits can be provided by the prover , which implies that those qubits can be removed from the problem altogether . unlike in the case of two - body interactions",
    ", however , not all qubits can be removed this way .",
    "most of the proof of theorem [ mainclaim ] is focused on handling the residual problem .",
    "the main point is that in the residual problem , configurations such as that in figure [ fig : ex2 ] may exist , however , when the qubits are non - separable , they can only grow to some bounded constant size . more precisely , we prove that the fact that the remaining qubits are not separable , implies severe restrictions on the geometry of the problem .",
    "we show that any connected component of the residual problem after removing the separable qubits contains a certain one dimensional structure in the interaction graph , which we call a _",
    "backbone_. the backbone is a long sequence of local hamiltonian terms , as in figure ( [ fig : bkbn ] ) .",
    "the key property is that all hamiltonian terms in one connected component in the residual problem must act on at least _ two _ qubits in the backbone of that component .",
    "moreover , the backbone qubits that a term acts on , must be within a constant distance , in terms of edges of the backbone .",
    "thus , hamiltonian terms can not connect distant particles in the backbone ; moreover , there can not be other `` shortcuts '' connecting distant parts of the backbone through interactions with qubits outside of the backbone .",
    "we call this an _ almost one dimensional structure_. we use this structure to prove that we can combine sets of constantly many nearest neighbor particles in the backbone into large particles , which are still of constant dimension , but in which interactions only act on nearest neighbors large particles",
    ". the methods of @xcite can be used here again to show that the large particles can then be sliced , in such a way that all interactions become two - local .",
    "the proof of theorem [ mainclaim2 ] which proves a similar result with qutrits on the plane is quite different .",
    "the first step is similar : we identify qutrits that behave `` classically '' ( i.e. , separable ) , which enables us to remove them , or at least reduce their dimensionality to @xmath16 ; we then proceed to prove strong geometric restrictions on the residual problem , in which no particle can be further reduced .    to deduce the geometrical constraints",
    ", we would like to make use of the fact that the remaining particles are not separable . however , the phenomenon of separability of a qutrit is somewhat more involved than that of a qubit .",
    "we say a qutrit is separable if there exists a non - trivial decomposition of its space to orthogonal subspaces , and each of these subspaces is preserved by all operators acting on the qutrit .",
    "but whereas for qubits , due to the low dimensionality , such a decomposition , if exists , is unique , for qutrits this is no longer the case , as there is freedom in the choice of basis of a two dimensional space .",
    "this prevents the proof for the case of qubits from going through .",
    "we can overcome this difficulty in the case of nearly euclidean planar interactions .",
    "for such instances , we show that the fact that all qudits are inseparable , implies that each qudit can be acted upon by at most a constant number of operators ; more precisely , the degree of each vertex in the interaction graph is at most @xmath33 .",
    "this is a completely geometrical constraint on the interaction graph of the residual problem , and it is in fact a very strong constraint which suffices for our purposes . we show that if one attempts to cover large regions of the plane with faces with only three edges ( corresponding to the three - local interactions ) and such that no vertex has degree @xmath34 or more , then `` holes '' must be formed , i.e. , faces which are not distorted - triangles but have more edges , and thus do not correspond to any term in the hamiltonian .",
    "the point is that those holes have a constant density ; in other words , each vertex in the graph has a hole within constant distance ( measured in number of faces separating the vertex from the hole ) .",
    "we use those holes in order to cut the interaction graph to smaller ( constant size ) pieces which when combined to particles , induce two - local interactions .",
    "the problem thus lies in np by @xcite .",
    "we provide more detailed overviews of the two proofs in subsections ( [ sec:3lcl2 ] ) and ( [ sec:3lcl3 ] ) , this will be easier after we provide some of the necessary definitions and notations in section [ sec : notation ] .      the results in this paper focus on two aspects of commuting hamiltonians : the first is extending the containment in np also for three body interactions , where a fundamental barrier is encountered exactly when topological order can be present in the ground space .",
    "three body interactions seemed before as the barrier standing between @xcite and the extension towards a proof of containment in np of the general case ; here we show that the barrier is far more intriguing , and has to do with the appearance of topological order .",
    "the second aspect is the proof that kitaev s celebrated construction of topological order using toric codes is optimal , a statement which is of interest in various contexts , such as physical implementations of topological order states , the understanding of topological quantum codes , and our general understanding of quantum multiparticle entanglement and quantum states .",
    "the barrier exposed in this paper by no means implies that we should neglect the hope to prove that the general commuting hamiltonian problem is in np .",
    "in fact , we hope that the barrier encountered here would clarify as to how we need to proceed in order to prove ( or possibly disprove ) the conjecture that the general problem lies in np .    one possible direction to explore in order to attack the general commuting case is the following . as is well known , topological order states such as toric codes do have short classical descriptions , which are in fact classical descriptions of small depth quantum circuits , except those circuits are _ non - local _",
    "( i.e. , not nearest neighbor on the grid ) . these are called mera @xcite .",
    "those descriptions allow computing local observables efficiently using a classical computer .",
    "from the point of view of @xmath35 verification , this is clearly sufficient . if one can show that such mera descriptions exist for any ground state of commuting hamiltonian",
    ", this would imply that the problem lies in np .",
    "it is possible that the algebraic methods of @xcite can be used in an innovative way ( perhaps by recursion or by other means ) to imply that there exist such mera - type poly - size classical descriptions of eigenstates for any @xmath1-local commuting hamiltonian on a grid .",
    "our proofs are quite involved .",
    "an indication to this complexity is that though our results imply that the ground states in the systems we study can be generated by constant depth quantum circuits , and thus can only create local entanglement , the locality we derived is quite large - the scale of entanglement involves a number of qubits or qutrits which is of the order of a few tens .",
    "an intriguing open question is whether the complexity of our results is essential to the problem , or it can be removed . if not , the proofs indicate that in the three - local systems we study , though the entanglement structure is restricted to being local , still quite complicated ( though local ) structures of entanglement can emerge , which span large though constant sets of particles , with the constant much larger than the natural scales in the system ( say , @xmath16 or @xmath14 )",
    ". it would be interesting to understand this aspect further .    finally , a technicality in the proof of the qutrit case is that the graph is required to be ne , rather than just planar .",
    "we speculate that in fact the ne restriction is not necessary ; it is used only in the proof of claim [ cl : cutting ] and we believe the claim holds for the general planar case .",
    "indeed , this restriction does not have strong implications for the main message of the paper ( namely , the tight boundary between to and local entanglement ) , since to is in any case studied only in such ne systems ; still it would be nice to close that corner and it would make our statements somewhat cleaner .",
    "* organization of paper : * the structure of this paper is as follows : in section ( [ sec : notation ] ) we lay out some notations and definitions , and in section ( [ sec:2lcl ] ) we restate an important lemma in the representation theory of @xmath13-algebra that was at the center of @xcite , and use it to reprove their result that the @xmath16-local hamiltonian problem is in np ( perhaps providing a slightly simpler representation of the proof ) .",
    "then , in section ( [ sec:3lcl2 ] ) we prove that @xmath36 for @xmath14-local operators on qubits has a classical verification protocol . in section ( [ sec:3lcl3 ] )",
    "we extend this result for qutrits , in cases where the interaction graph is a nearly euclidean planar graph .",
    "we then use these two proofs , and the result of @xmath37 to derive tight conditions for topological order .",
    "we use the following standard notation :    * we denote hilbert spaces by graphical symbols : @xmath38 , etc . the set of linear operators over the complex numbers , acting on a given hilbert space @xmath39 , is denoted by @xmath40 . *",
    "unless otherwise noted , we denote by @xmath39 the hilbert space of @xmath3 qudits : @xmath41 the dimensionality of the qudits is denoted by @xmath12 .",
    "* a @xmath1-local operator @xmath42 is an operator which acts on a subset of size @xmath1 of the @xmath3 qudits @xmath43 , hence @xmath44 , and we have @xmath45 .",
    "less standard notation includes :    * to specify that an operator @xmath2 acts non - trivially on some specific qubit @xmath26 , we write @xmath46 .",
    "we say an operator acts non - trivially on a particle @xmath26 if the operator can not be written as a scalar on @xmath26 tensor some operator on the remaining particles .",
    "* the set of qudits examined non - trivially by an operator @xmath47 is denoted by @xmath48 ; the set of particles examined non - trivially by a set of operators @xmath49 , is denoted by @xmath50 .      * the @xmath51 local hamiltonian problem for commuting operators , @xmath52 *    the @xmath51 local commuting hamiltonian problem on @xmath3 qudits of dimension @xmath12 , denoted by @xmath52 , is defined as follows .",
    "we are given a set @xmath53 of @xmath54 @xmath1-local projections , @xmath47 , acting on @xmath3 particles each of dimension @xmath12 , such that all terms in @xmath53 pairwise commute .",
    "we are asked whether there exists an eigenstate of @xmath55 with eigenvalue @xmath9 .    * @xmath56 : interaction graph of a @xmath36 instance *    the interaction graph of an instance @xmath53 of @xmath52 is the graph @xmath57 , where @xmath58 is a set of @xmath3 nodes , each corresponding to a qudit , and an edge connecting nodes @xmath59 and @xmath60 is in @xmath61 ( namely , @xmath62 ) if there exists some @xmath63 such that both @xmath59 and @xmath60 belong to @xmath64 .    *",
    "neighborhood of a qudit in an instance @xmath53 of @xmath52 *    we denote by @xmath65 the neighboring set of a qudit @xmath26 w.r.t .",
    "@xmath53 , namely , the set of all qudits @xmath66 adjacent to @xmath26 in @xmath56 .",
    "an operator @xmath67 is said to preserve a subspace @xmath53 if @xmath68 .",
    "the following facts are trivial to prove :    [ fact : trivial1 ] if @xmath67 is hermitian , if it preserves a subspace @xmath53 it also preserves the orthogonal complement of @xmath53 .",
    "[ fact : trivial2 ] if a linear operator @xmath67 commutes with a projection on a subspace @xmath53 , then @xmath67 preserves @xmath53 .      in this paper",
    "we consider finite dimensional @xmath69-algebras .",
    "for the purposes of this paper , these are complex algebras ( denoted @xmath70 ) of linear operators ( described by matrices ) with the additional restriction that @xmath70 is closed under the operation of taking adjoints of operators ( i.e , the _ _",
    "d__agger , @xmath71 operation ) .",
    "we often refer to the algebra _",
    "_ g__enerated by a given set of linear operators , referred to as generators .",
    "the generators are always a set of matrices of the same dimensionality ; and the algebra generated by them is defined either as the minimal algebra that contains the linear subspaces spanned by the generators , or equivalently , the algebra generated by the set of generators union with the identity matrix .",
    "[ def : induced ] * algebra induced by an operator *    let @xmath72 be an operator on @xmath26 , and let us write @xmath73 such that @xmath74 acts on @xmath26 , and @xmath75 acts on the rest of the environment , and the set @xmath76 is linearly independent .",
    "then the _ algebra induced by @xmath2 on @xmath26 _ is the algebra inside @xmath77 generated by @xmath78 .",
    "[ fact : independent ] given an operator @xmath46 , the induced algebra on @xmath26 , @xmath79 is independent of our choice of how to write @xmath2 as a sum as in equation [ eq : deq ] , so long as the @xmath75 operators are linearly independent .",
    "let us decompose @xmath46 in two different ways : @xmath80 where the sets @xmath81 and @xmath82 are each linearly independent .",
    "let @xmath83 denote the @xmath13-algebra of @xmath2 on @xmath26 induced by the first and second decompositions , respectively .",
    "we show that @xmath84 , by symmetry this suffices to show that the two algebras are equal .",
    "let us complete the set @xmath49 into a basis of the second subsystem , by the matrices @xmath85 .",
    "we can thus write the @xmath86 matrices in terms of this basis : @xmath87 with @xmath88 , @xmath89 complex numbers .",
    "setting the equation above , in the second decomposition , we get : @xmath90 which means that @xmath91 we now recall that the decomposition in terms of a basis of linearly independent matrices is unique . comparing the last equation with @xmath92",
    "the matrix in front of each @xmath75 must be the same .",
    "hence , @xmath93 is contained in the algebra @xmath70 spanned by @xmath94 .",
    "[ fact : closed ] given a hermitian operator @xmath46 , the induced algebra on @xmath26 is closed under the adjoint operator .",
    "we write @xmath95 with @xmath96 linearly independent ; then the induced algebra is the one generated by @xmath78 .",
    "but since @xmath2 is hermitian , @xmath97 and so the induced algebra is also the algebra generated by @xmath98 by fact [ fact : independent ] .",
    "this means that the induced algebra also contains the adjoint of the generators , and hence is closed under the adjoint .",
    "a simple but crucial fact to this paper is that if two terms that intersect only on a qubit commute , then the two algebras they induce on @xmath26 commute :    [ fact : algcomm ] consider two hamiltonian terms @xmath99 intersecting only on the qudit @xmath60 .",
    "then the algebras @xmath100 induced by these operators on @xmath60 commute with each other .",
    "let @xmath101 and @xmath102 be two commuting operators that share only qudit @xmath60 , and let their decomposition be as follows : @xmath103 where @xmath104 and @xmath105 are operators on qudit @xmath60 , and the sets @xmath106 and @xmath107 are each linearly independent , and act on different qudits .",
    "we get : @xmath108 = \\sum_{\\alpha,\\beta } [ a_{\\alpha}^1,a_{\\beta}^2]\\otimes b_{\\alpha}^1 \\otimes b_{\\beta}^2 = 0.\\ ] ] by the linear independence of @xmath106 and @xmath107 we have that the set @xmath109 is also linearly independent , thus @xmath110 = 0 $ ] for all @xmath111 , meaning that the algebras @xmath112 and @xmath113 commute .",
    "the proof of @xcite , as well as our proofs , rely on fundamental facts from the representation theory of @xmath13 algebra . for the purposes of this paper , we restrict attention to algebras @xmath114 , such that @xmath70 is closed under the @xmath115 operation .",
    "all the algebras we will consider are of this form .",
    "* center of a @xmath13-algebra , @xmath116 .",
    "*    the center of a sub - algebra @xmath70 is defined to be the set of all operators in @xmath70 which commute with all the elements in @xmath70 .",
    "it is denoted by @xmath116 .    * a reducible / irreducible @xmath13-algebra *",
    "an algebra @xmath70 is said to be irreducible if its center is trivial , i.e. @xmath117 , and otherwise it is reducible .",
    "let @xmath70 be an irreducible subalgebra of @xmath40 , i.e. @xmath118 . then @xmath39 can be written as a tensor product of two subsystems @xmath119 such that @xmath120    a generalization of the previous fact is a well - known decomposition theorem from the representation theory of @xmath13-algebras :    [ fact2 ] let @xmath70 be a @xmath13-algebra on some hilbert space @xmath39 .",
    "then , there exists a decomposition of @xmath39 into a direct sum of orthogonal subspaces @xmath121 , where each @xmath121 is a tensor product of two hilbert spaces , @xmath122 such that @xmath123    the projections on the subspaces @xmath121 generate @xmath124 , and for each subspace @xmath125 the algebra @xmath126 ( which is defined to be the algebra @xmath70 restricted to @xmath125 ) , is irreducible .",
    "[ fact : presdec ] let @xmath127 and @xmath128 be two commuting algebras on a hilbert space @xmath39 , and let @xmath127 be decomposed by its center as in fact ( [ fact2 ] ) - i.e. a decomposition @xmath129 such that @xmath130 then @xmath128 preserves each subspace @xmath121 in the decomposition above .    for each subspace",
    "@xmath121 there exists a projection @xmath131 whose image is @xmath121 . since @xmath127 and @xmath128 commute ,",
    "then each projection @xmath132 commutes with all operators in @xmath128 .",
    "thus , by fact [ fact : trivial2 ] @xmath128 preserves @xmath121 for all @xmath32 .",
    "the basic facts from the theory of representations of algebras presented in section [ sec : notation ] can be used to prove an important lemma , which is the basis of the proof of @xcite .",
    "we start with the following definition and a preliminary claim :    [ def : algdec ] let @xmath133 be @xmath1 mutually commuting algebras on some hilbert space @xmath39 .",
    "a separating decomposition is a direct - sum decomposition of @xmath39 : @xmath134 that is preserved by all algebras , such that inside each subspace @xmath121 there appears a tensor product structure @xmath135 such that @xmath136    [ cl : algdec ] let @xmath133 be @xmath1 mutually commuting algebras on some hilbert space @xmath39 .",
    "there exists a separating decomposition of @xmath39 .",
    "suppose that the algebra @xmath137 are all irreducible algebras - i.e. have trivial centers .",
    "using fact ( [ fact1 ] ) we have that each @xmath137 is isomorphic to the full set of linear operators on some subsystem of @xmath39 . in other words ,",
    "@xmath138 and @xmath139 consider first @xmath127 and @xmath140 . since the algebras commute , each @xmath137 for",
    "@xmath141 must act as the identity on the @xmath142 , and hence acts not trivially only on @xmath143 ; we proceed by induction , to derive that each @xmath137 is isomorphic to the full set of linear operators on a separate sub - particle and thus the lemma follows in this case .",
    "now we generalize to the case where at least one algebra is reducible .",
    "let us examine the algebra @xmath70 generated by the set of all operators on the particle @xmath39 , that commute with any @xmath144 for all @xmath60 .",
    "it is easy to check that since the @xmath137 are closed under adjoint ( by fact [ fact : closed ] ) then so is @xmath70 .",
    "by fact ( [ fact2 ] ) algebra @xmath70 admits a decomposition , such that inside each subspace , it is isomorphic to the full set of operators on some subsystem , tensor with identity .",
    "by fact ( [ fact : presdec ] ) this decomposition is preserved by all @xmath137 since they commute with @xmath70 .",
    "we consider the algebras @xmath137 restricted to these subspaces .",
    "we want to show that these restricted algebras are all irreducible .",
    "this follows since it turns out that the center of the algebra @xmath70 in fact contains the centers of the algebras @xmath137 . to show this , first notice that @xmath145 since any element of @xmath146 commutes with any element of @xmath137 by definition of a center of an algebra , and also commutes with any element of all the other algebras @xmath147 for @xmath148 since it consists of elements from @xmath137 and the algebras @xmath137 and @xmath147 commute",
    "in fact , since @xmath146 commutes with all the generators of @xmath70 , it is also contained in the center of @xmath70 .",
    "so @xmath149 .",
    "therefore , since @xmath70 is irreducible inside each of the subspaces , so are @xmath137 .",
    "so the decomposition of the algebra @xmath70 decomposes each algebra @xmath137 , into irreducible commuting algebras , which by the first paragraph must act on separate subsystems inside each subspace .",
    "we are now ready to prove the following crucial fact , which is the basis for the result of bravyi and vyalyi @xcite as well as the current paper :    [ lem : bv ]    * decomposition of the center of a star ( adapted from @xcite ) *    let @xmath53 be an instance of @xmath150 whose interaction graph is a star : this means that there is a particle @xmath60 , and each @xmath16-local @xmath99 examines @xmath60 and another particle @xmath1 ( where different terms act on different @xmath1 s ) .",
    "then there exists a direct sum decomposition @xmath151 such that inside each subspace @xmath152 there appears a tensor product structure @xmath153 where @xmath1 runs over all other particles , such that all operators @xmath99 preserve the subspaces @xmath152 , and moreover ,    @xmath154    we write each hamiltonian as a sum of tensor product terms .",
    "@xmath155 where @xmath156 acts on @xmath157 and @xmath158 acts on @xmath159 , and the operators @xmath160 are linearly independent .",
    "we consider the @xmath13-algebra generated by @xmath161 , and denote it @xmath100 .",
    "the key point is that any pair of @xmath100 algebras commute , due to fact ( [ fact : algcomm ] )",
    ". we can therefore apply claim ( [ cl : algdec ] ) and this implies the result .",
    "the above lemma implies the following .",
    "when the interaction graph of the commuting hamiltonian is a star ( which is indeed the case for every qudit in the two - local case ) , the hilbert space of the center particle @xmath157 can be decomposed into a direct sum of spaces @xmath162 , such that each of the terms in the hamiltonian preserves those subspaces @xmath162 .",
    "this means that the original system has a zero eigenstate , if and only if for every particle there exists some subspace index @xmath163 such that the restriction of the terms in the hamiltonians to the subspaces @xmath164 is an instance which contains a zero eigenstate .",
    "moreover , under this restriction , the terms in the hamiltonian become _ _",
    "d__isjoint , namely , they can be described as working on separate particles , described by the subspaces @xmath165 .",
    "thus , the interaction graph of the restricted hamiltonian is simply a set of disjoint edges .",
    "we can now prove the result of @xcite stating that @xmath150 is in @xmath35 for any @xmath12 .",
    "we present a slightly modified proof here , since a similar approach will be useful when we generalize the result to @xmath166 and @xmath167 .",
    "the main point is that in the two local case , for any qudit , the interactions involving that qudit form a star .",
    "lemma [ lem : bv ] can therefore be applied .",
    "merlin helps arthur find the ground state by providing him with the correct index @xmath32 in the decomposition of each particle .    to present the proof in more detail",
    ", we use an interactive picture : a communication protocol between merlin and arthur . in our protocol",
    ", only merlin sends messages to arthur , so in fact he can send all messages at once and this concatenation of messages can be viewed as the witness ; but the protocol point of view is more convenient for our purposes .",
    "input : @xmath53 , an instance of @xmath150 .",
    "repeat until there is no node in the interaction graph whose degree is @xmath16 or more .    1 .",
    "merlin picks a vertex @xmath26 , and sends arthur the description of one subspace @xmath168 from the direct sum decomposition of @xmath27 given by lemma [ lem : bv ] .",
    "both merlin and arthur can generate the decomposition so merlin only needs to send arthur the index @xmath32 .",
    "2 .   both arthur and merlin slice the qudit @xmath26 after restricting it to @xmath168 , according to lemma [ lem : bv ] .",
    "accordingly , the node @xmath26 is replaced by at most @xmath169 new nodes , each with a degree @xmath4 in the new interaction graph .    after all particles with degree more",
    "than @xmath4 have been removed , arthur verifies that the hamiltonian , which is now a set of non - intersecting terms ( each term corresponds to a disjoint edge ) has a nonzero kernel .",
    "in this section we prove theorem [ mainclaim ] . we start with a more detailed overview of the proof .      as mentioned before , the first step in the proof is to use the tools of @xcite to identify and remove qubits that are `` separable '' , namely , for which there is a decomposition to a direct sum of subspaces , such that all operators acting on the qubit preserve those subspaces . in the case of qubits ,",
    "when a non - trivial decomposition exists , it must be into two subspaces of dimension one each ; when restricting to one such subspace , the state of the qubit becomes some tensor product state with the rest of the system .",
    "this means that those qubits can in fact be removed from the system since merlin can provide their state separately .",
    "we have thus reduced the problem to a problem in which all qubits are non - separable ; this is done in subsection ( [ subsec : removingsep ] ) .",
    "we now embark on the most important component in the proof , which is the characterization of the geometric properties of the interaction graph , after the removal of separable qubits .",
    "we treat each connected component separately , so we may assume the graph is connected .",
    "we ask , how can we constrain the interactions of a qubit @xmath26 , for which we know that no single decomposition exists which all operators on @xmath26 agree on .    we define a @xmath170 ( butterfly ) relation between two operators acting on the same qubit @xmath26 , @xmath171 , @xmath172 if @xmath173 .",
    "we denote this by @xmath174 .",
    "each @xmath170 relations yields a direct - sum decomposition by @xmath175 which is preserved by both operators .",
    "as mentioned in the introduction , we notice as a first step , that if there are two butterflies with respect to @xmath26 , @xmath176 and @xmath177 , then due to the low dimensionality , the decompositions induced by both @xmath170 relations are the same ( see claim [ cl : same ] ) .",
    "this yields an important transitivity conclusion : i.e. , if @xmath171 and @xmath172 agree on some decomposition of @xmath26 , and @xmath171 and @xmath178 agree on some decomposition of @xmath26 , then @xmath172 , and @xmath178 agree on the same decomposition .",
    "we can now talk about two operators on @xmath26 which are connected by a path of such butterflies : two operators are said to be @xmath170 connected ( read this `` butterfly - connected '' ) if there is a sequence of @xmath170 relations that connects them , i.e. @xmath179 . a basic tool in this paper is theorem ( [ bflychainclaim ] ) proved in section ( [ subsec : sep ] ) :    [ bflychainclaim0 ] if any two operators @xmath180 acting on a qubit @xmath26 are butterfly connected , then @xmath26 is separable .",
    "this implies that an interaction graph made of non - separable qubits is severely limited , since its operators can not be all connected by butterfly paths .",
    "the operators on any qubit thus can not `` fan - out '' too much , as this would induce pairwise @xmath170 paths and would make this qubit separable .    in sections ( [ subsec : crowns ] ) and ( [ subsec : limit ] )",
    "we make this intuition more tangible , and show two important conclusions from theorem ( [ bflychainclaim ] ) .",
    "first , we define an `` operator crown '' on @xmath26 , which is a set of three operators acting on @xmath26 organized as in figure [ fig : crown ] .",
    "we show in claim ( [ cl : nosep1 ] ) that operator crowns , act as `` qubit traps '' ; this means that if @xmath26 has such an operator crown , then any operator on @xmath26 must also act on at least one other qubit of the crown .",
    "second , we show in claim ( [ cl : nosep2 ] ) that any two operators on @xmath26 must either intersect on one other qubit than @xmath26 , or they are connected through another operator @xmath181 , which intersects each of them with @xmath26 and another qubit .",
    "another claim which we call the bridge claim ( claim [ cl : bridge ] ) is a slightly strengthened version of claim ( [ cl : nosep2 ] ) .",
    "these latter properties impose severe restrictions on the geometry of the interaction graph .",
    "having characterized the local geometric behavior of each individual nonseparable qubit in the residual graph , we are ready to take one step further , and make some claims w.r.t .",
    "the global structure of the residual graph . to this end",
    ", we define the `` backbone '' of the graph : this is the longest `` path of operators '' in the residual graph .",
    "intuitively , the backbone constitutes the longest possible stretch of `` operator crowns '' that are attached back to back , without revisiting qubits that have already been visited . recall that by claim [ cl : nosep1 ] an operator crown on qubit @xmath26 essentially `` traps '' at least one other qubit of any operator acting on @xmath26 .",
    "this means that essentially any operator that acts on a backbone qubit , must act on at least one more backbone qubit which is not very `` far '' in terms of backbone edges ; this is captured by lemma [ lem : entrap ] below .",
    "this `` qubit '' entrapment property alone is not sufficient for our purposes , as it does not handle operators that do not act on backbone qubits .",
    "we want to show that _ all _ operators ( if we started with an instance whose interaction graph is connected ) must examine at least two backbone qubits , and therefore these qubits must be close by the above lemma [ lem : entrap ] .",
    "moreover , we want to show that there are no `` shortcuts '' between far away qubits in the backbone , through interactions with qubits outside the backbone : consider any qubit outside the backbone which interacts with two backbone qubits , through two different terms in the hamiltonian .",
    "we want to show that even these two qubits can not be too distant in terms of number of backbone edges .",
    "those two properties are proved in claims ( [ cl : bkbn1 ] ) and ( [ cl : bkbn2 ] ) using the geometric claims above .",
    "the result of all this is the following .",
    "consider a coarse - graining of the backbone , in which say consecutive sets of @xmath182 qubits are aggregated together and are considered as one particle of constant dimension ; denote those by @xmath183 . by the above arguments , all interactions inside the backbone are two - local ,",
    "namely , interact only @xmath183 and @xmath184 ; and moreover , any qubit outside the backbone may interact only with a specific pair of consecutive large particles @xmath185    we examine this structured problem more closely .",
    "consider the operators interacting @xmath183 with the qudit to its left , @xmath186 .",
    "consider also the operators that interact @xmath183 with the qudit to its right , @xmath184 .",
    "we have a @xmath170 relation between any operator acting on @xmath183 from the left and any operator acting on @xmath183 from the right .",
    "we can then show , very similarly to lemma ( [ lem : bv ] ) , that there exists a decomposition of the hilbert space of @xmath183 , such that when we restrict all operators on @xmath183 to a specific subspace in this decomposition , then @xmath183 can be written as a tensor product of two subparticles , the left subparticle @xmath187 and the right subparticle @xmath188 , and the operators acting on @xmath183 from the left ( right ) interact only with the left ( right ) subparticle of @xmath183 .",
    "this paves the way for achieving two - locality : after partitioning each @xmath183 into those two separate subparticles @xmath187 and @xmath188 , we can fuse the right side of one particle with the left side of the next : @xmath188 with @xmath189 .    the resulting problem is two - local : all interactions are of the form in which one fused particle and one particle out of the backbone interact , or they are @xmath4-local ; hence , we get that each fused particle is a center of a star , and the stars are non - intersecting .",
    "this is already a problem in np by lemma [ lem : bv ] , namely , by the methods of bravyi and vyalyi @xcite .",
    "we now provide the details .",
    "we start by defining separable qubits , and explaining why they can be removed from the graph , using classical witness . by the end of this section",
    ", we will have removed all those qubits and remain with the residual problem in which all qubits are non - separable .",
    "we start by defining :    * separable qubit *    a qubit @xmath26 is said to be separable if there exists a direct - sum decomposition of its hilbert space to two one dimensional spaces , @xmath190 such that any operator @xmath46 which acts on @xmath26 preserves this decomposition : @xmath191 where @xmath192 is the restricted projector .",
    "observe that the restricted projection in this case is also a projection .",
    "this definition is aimed to capture a similar situation to what happens in the case of @xmath150 when a particle is handled , according to lemma [ lem : bv ] .",
    "note that the fact that the above direct sum decomposition is into subspaces of dimension @xmath4 , meaning that knowing the index @xmath32 , a separable qubit has a well defined quantum state ; since the verifier will receive the index @xmath32 from the prover , this qubit can simply be removed from the graph .",
    "so , the first step in the protocol between merlin and arthur is as follows :    [ alg : restrict ] * restrict graph ( @xmath53 ) *    input : @xmath53 , an instance of @xmath166 .",
    "iteratively change @xmath56 until there is no separable qubit in @xmath56 :    1 .",
    "merlin picks a separable qubit @xmath26 in @xmath53 and sends arthur an index @xmath32 whose corresponding subspace contains a common zero eigenspace of @xmath53 .",
    "2 .   arthur restricts all terms in the hamiltonian to this subspace , and removes the vertex @xmath26 and all its incident edges in @xmath56 . if after this restriction , some term acts trivially on one or more of its particles , both arthur and merlin replace this term ( or those terms if there are more than one ) by the appropriate @xmath4-qubit terms in the hamiltonian .",
    "the resulting instance is one without separable qubits , and where all terms act non - trivially on all their particles .",
    "[ step1 ] given a @xmath166 instance @xmath53 , algorithm ( [ alg : restrict ] ) generates a @xmath166 instance @xmath193 with no separable qubits ; if @xmath53 has a non - trivial common groundspace then merlin can choose his restrictions so that @xmath193 has such a subspace .",
    "if @xmath53 has no zero eigenspace , for any choice of subspace restriction the ground energy of @xmath193 is at least @xmath4 .",
    "let @xmath26 be a separable qubit which merlin removes .",
    "there exists a basis of @xmath27 , such that any hamiltonian term @xmath47 is block diagonal in this basis .",
    "@xmath53 has a ground energy zero if and only if one of those subspaces contains such a state .",
    "it remains to show that the new instance is still a legal @xmath166 instance .",
    "indeed , if two operators @xmath194 and @xmath195 commute and are block diagonal in some basis of @xmath26 , then the restricted operators to any @xmath4-dimensional subspace spanned by this basis also commute . this logic is preserved , at every iteration , leading to finer and finer slicing of the original hilbert space , until we exhaust all separable qubits .",
    "we note that during the process of `` slicing '' separable qubits , qubits which were previously nonseparable may become separable , yet a qubit can not be sliced twice .",
    "here we define butterflies , operator crowns , operator paths , and provide all sorts of geometric restrictions on the interactions between separable qubits using those notions .",
    "* butterfly *    consider two operators @xmath196 and @xmath197 , where @xmath49 is a qubit , and @xmath67 and @xmath198 are sets of qubits , such that @xmath67 does not intersect @xmath198 .",
    "we say that @xmath199 and @xmath200 constitute a butterfly and denote @xmath174 .",
    "a butterfly is always with respect to the particle in the intersection , here @xmath49 ; most of the time the identity of the qubit @xmath49 will be clear from the context and we will omit specifying it .    [ cl : bfly ] for any pair of operators acting non",
    "trivially on @xmath26 , @xmath199 and @xmath200 , with @xmath201 with respect to @xmath26 , there exists a non - trivial decomposition of @xmath27 into a sum of two one dimensional subspaces , each of dimension one , which are preserved by both operators .    denote by @xmath67 the set of qubits which @xmath199 acts upon , excluding @xmath26 .",
    "likewise , denote by @xmath49 the set of qubits which @xmath200 acts on , excluding @xmath26 . by the definition of the @xmath170 relation , we have @xmath202 .",
    "we can consider all operators in @xmath67 as one qudit .",
    "similarly , we can consider all qubits in @xmath49 as another qudit .",
    "we can then apply lemma [ lem : bv ] and conclude that there exists a direct - sum decomposition of @xmath26 that is preserved by both operators .",
    "the reason the decomposition of lemma ( [ lem : bv ] ) must be non - trivial is that otherwise ( namely , a decomposition to a sum of zero and two - dimensional spaces ) , since @xmath203 , it means that one of the operators acts trivially on @xmath26 , contradicting to our assumption .",
    "* decomposition induced by the butterfly * by claim [ cl : bfly ] , a butterfly induces a well defined decomposition on its center qubit , which is called the decomposition induced by the butterfly    now , what if there are several butterflies in which one qubit participates ?",
    "could it be that the decompositions induced on @xmath26 by different butterflies are different ?",
    "the following simple claim says that the answer is negative .",
    "this follows from the limited dimensionality of the qubit .",
    "this clearly leads to strong transitivity relations , as we will soon see , but let us first state and prove the uniqueness of induced decomposition :    [ cl : same ] * unique butterfly induced decomposition of @xmath26 * consider two butterflies @xmath201 , @xmath204 , both with respect to @xmath26 , where all three operators act non - trivially on @xmath26 .",
    "then the decompositions induced on @xmath26 from both butterflies , using claim [ cl : bfly ] , must be the same .",
    "as in claim ( [ cl : bfly ] ) , @xmath26 can be decomposed into a direct sum of two one dimensional subspaces , based on the first butterfly @xmath174 .",
    "let @xmath205 be the projections on those subspaces of @xmath27 , so @xmath206 .",
    "we can write @xmath207 where @xmath208 are some projections on @xmath67 .",
    "the operators on @xmath67 are projections by lemma ( [ lem : bv ] ) .",
    "we claim that if another @xmath170 relation with @xmath199 results in a different decomposition of @xmath199 @xmath209 then this would imply a contradiction . to see this ,",
    "suppose wlog that @xmath210 ( @xmath211 ) projects on the state @xmath212 ( @xmath213 ) . and",
    "suppose @xmath214 projects on the state @xmath215 with neither @xmath32 not @xmath216 equal to @xmath9 . since @xmath26 is a qubit , we can write wlog that @xmath217 projects on the state @xmath218 .",
    "then we write : @xmath219 and @xmath220 plugging these terms in equation ( [ eq2 ] ) for @xmath199 , and using the fact that @xmath199 is block diagonal in the computational basis , by equation ( [ eq:1 ] ) , we set to @xmath9 the terms in tensor with @xmath221 and @xmath222 , and get @xmath223 which by equation ( [ eq2 ] ) means that @xmath199 can be written as @xmath224 .",
    "thus , @xmath199 acts trivially on @xmath26 , contrary to our assumption .",
    "we would like now to deduce various properties from transitivity .",
    "we first define :    * butterfly path , butterfly - connectedness *    consider two operators both acting on a qubit @xmath26 , denoted @xmath225 and @xmath226 .",
    "we say there is a butterfly path between @xmath225 and @xmath226 if there is a sequence of operators @xmath227 such that @xmath228 .",
    "( where all butterflies are with respect to @xmath26 ) .",
    "we say that these two operators are butterfly - connected .",
    "[ bflychainclaim]*butterfly connectedness of operators implies separability * if all pairs of operators @xmath180 acting on a qubit @xmath26 , are connected by a butterfly path on @xmath26 , then @xmath26 is separable .",
    "pick one operator acting on @xmath26 , and now use claim ( [ cl : same ] ) along the path connecting it to any other operator on @xmath26 , to show that by transitivity all butterflies along the path induce the same decomposition on @xmath26 , and thus by transitivity all operators on @xmath26 preserve this decomposition , hence by definition @xmath26 is separable .",
    "[ partitionclaim ] * `` left - right '' partition implies separability : * if there is a partition of the operator set @xmath53 into two disjoint non - empty sets @xmath229 and @xmath230 such that for each @xmath231 and @xmath232 we have @xmath233 ( we call this a `` left - right '' partition ) , then @xmath26 is separable .    for any pair of operators @xmath199 and @xmath200 one can construct a chain of @xmath170 relations @xmath234 that goes back and forth between @xmath229 and @xmath230 as both sets are nonempty .",
    "then by theorem ( [ bflychainclaim ] ) we get that @xmath26 is indeed separable .",
    "what structures then can be present in a graph which contains only non - separable qubits ?",
    "for that , we need to define one more notion of connectivity , namely operator - path connectivity .      * open and cyclic operator paths *    an open operator path is an ordered set of @xmath235 distinct operators @xmath236 such that",
    "for any pair of indices @xmath237 where @xmath238,k\\in [ l]$ ] we have :    1 .",
    "@xmath239 for @xmath240 2 .",
    "@xmath241 for @xmath242 .",
    "3 .   @xmath243 for @xmath244    similarly , a closed operator path , is an ordered set of operators that are distinct , except @xmath245 , and the index additions above are taken modulo @xmath235 .",
    "the length of an operator path is defined as the number of its distinct operators .",
    "[ connected ] * graph connectivity implies operator path connectivity *    if @xmath53 is a set of operators such that no qubit in @xmath246 is separable , and @xmath56 is connected , then @xmath246 is also operator - path - connected , i.e. , any pair of qubits @xmath247 , are connected by an operator path which starts with an operator which acts on @xmath26 and ends with an operator which acts on @xmath248 .",
    "let @xmath249 .",
    "consider the set @xmath250 built as follows .",
    "start with all operators acting on @xmath26 .",
    "add to @xmath250 any operator which intersects an operator in @xmath250 with an intersection of size @xmath16 .",
    "continue until it is impossible to add operators this way .",
    "@xmath250 is the final set of operators we get .",
    "now , if @xmath251 contains @xmath248 , we are done ( since clearly we can construct an operator path as desired ) . if not , consider a path from @xmath26 to @xmath248 is @xmath56 .",
    "let @xmath252 be the last qubit that belongs to @xmath251 along that path .",
    "we claim that @xmath252 is separable by corollary ( [ partitionclaim ] ) as follows : let us partition the operators acting on @xmath252 to two non - empty sets : the set @xmath67 which contains all operators in @xmath250 , and @xmath49 of all other operators . we know that any operator in @xmath49 can not intersect any operator in @xmath67 by @xmath16 particles , since otherwise it would have been in @xmath250 ; also , we know that @xmath49 is non - empty since it contains the operator inducing the edge from @xmath252 to the next qubit on the path to @xmath248 in @xmath56 , and @xmath67 is also not empty , since @xmath252 belongs to @xmath251 .",
    "hence , the conditions of corollary ( [ partitionclaim ] ) apply .",
    "we are now ready to deduce various restrictions on the connectivity of the operators acting on a nonseparable qubit @xmath26 .",
    "we will often restrict attention to operator paths all of whose operators act on one particular qubit :    * operator path on a qubit *    an operator path on @xmath26 ( where @xmath26 is a qubit ) is an operator path all of whose operators act on @xmath26 .    a certain structure which will appear useful is the length-@xmath14 operator path on a qubit @xmath26 :    * operator crown *    for a qubit @xmath26 , an operator crown on @xmath26 , is a set of @xmath14 operators that act on @xmath26 , and @xmath0 other distinct qubits , which we call the crown qubits @xmath253 , as follows : @xmath254,@xmath255,@xmath256 .",
    "see figure [ fig : crown ] for an illustration .",
    "this structure acts as an `` operator - trap '' : any operator that acts on @xmath26 must act also on some qubit which participates in the crown :    [ cl : nosep1]*operator crown as an operator trap : * let @xmath26 be a nonseparable qubit , and let @xmath198 be some operator crown on @xmath26 .",
    "then any operator on @xmath26 acts on some crown qubit of @xmath198 .",
    "suppose on the negative , that there exists some crown @xmath257 and an operator @xmath2 , such that @xmath198 and @xmath2 intersect only on @xmath26 .",
    "then there exists a subgraph on @xmath26 made of @xmath14 operators , namely @xmath258 such that each pair intersects only on @xmath26 .",
    "thus @xmath26 is separable by the following argument : we prove @xmath259 , that any operator on @xmath26 has a @xmath170 path to @xmath199 .",
    "this implies that any two operators are @xmath170-path connected , so by theorem ( [ bflychainclaim ] ) @xmath26 is separable .",
    "we now show that indeed @xmath259 is true : the operators @xmath2 , and @xmath260 are @xmath170-path connected to @xmath199 as @xmath261 .",
    "regarding @xmath200 , we have @xmath262 . any other operator on @xmath26 can share two qubits with at most @xmath16 of the operators : @xmath263 , so it has a @xmath170 path to at least one of them , which implies it is also @xmath170 connected to @xmath199 .",
    "we now use theorem ( [ bflychainclaim ] ) and claim ( [ connected ] ) to prove that the operators acting on one non - separable qubit @xmath26 must be close in terms of the shortest operator path connecting them :    [ cl : nosep2]*operators on @xmath26 are connected by length - three operator paths : * let @xmath26 be some nonseparable qubit . then any @xmath16 operators on @xmath26 are operator - path connected by an operator path on @xmath26 of length at most @xmath14 .    first , consider the connected component in @xmath56 which contains @xmath26 . by claim ( [ connected ] ) it is also operator path - connected . assume on the negative , that there exist two operators @xmath264 such that any operator path on @xmath26 that connects them is of length at least @xmath0 . since @xmath265",
    "this must be an open operator path .",
    "we know that any open operator path on @xmath26 must be of length exactly @xmath0 , since if the shortest open path is of length at least @xmath33 , we get a structure as in figure [ fig : crown2 ] and we contradict claim ( [ cl : nosep1 ] ) .",
    "let us choose such an operator path on @xmath26 and denote its operators as follows : @xmath266 , @xmath267 , @xmath268 , @xmath269 .",
    "then any operator @xmath2 that examines @xmath26 and some qubit of the set @xmath270 can not examine any qubit in the set @xmath271 as this would shorten the path between @xmath199 and @xmath272 to @xmath273 .",
    "so let @xmath46 be some operator on @xmath26 .",
    "we claim that it has a @xmath170 path to @xmath199 . indeed ,",
    "if @xmath2 does not examine any qubit in the set @xmath270 , then it has a @xmath170 relation with @xmath199 .",
    "otherwise , it does not examine any qubit in the set @xmath271 , so it has a @xmath170 relation with @xmath272 , yet @xmath274 , so @xmath275 .",
    "any of the operators @xmath276 is also @xmath170 connected to @xmath199 , thus by theorem ( [ bflychainclaim ] ) @xmath26 is separable .",
    "we also give a slightly strengthened version of the above .",
    "we examine a case where there are two operators @xmath180 on a nonseparable qubit @xmath26 connected by an operator path @xmath277 of length @xmath0 on @xmath26 . by claim [ cl : nosep2 ] this is not the minimal length operator path connecting these two operators .",
    "we show that in that case , not only is there a shorter path of length @xmath14 between @xmath171 and @xmath172 , but there exists a path of length @xmath14 that shortcuts @xmath277 itself as follows :    [ cl : bridge]*(bridge claim ) * let @xmath266 , @xmath267 , @xmath268 , @xmath269 , be a length @xmath0 open operator path on a nonseparable qubit @xmath26 .",
    "then there exists an operator @xmath278 .",
    "we assume on the negative that no such operator exists , and show that @xmath26 is separable .",
    "all operators of the path are @xmath170 connected to @xmath199 .",
    "any operator that shares only @xmath26 with @xmath279 is @xmath170 connected to @xmath199 .",
    "any operator that shares @xmath26 and just one other qubit out of @xmath280 is also @xmath170 connected to @xmath199 .",
    "let @xmath2 be an operator that acts on @xmath26 and two other qubits out of @xmath280 .",
    "these qubits can not be adjacent so the possible pairs ( excluding ( @xmath281 ) ) are @xmath282 .",
    "each such pair of qubits examined by @xmath2 , corresponds to a @xmath170 relation of @xmath2 with the operator @xmath283 , respectively , so @xmath2 is @xmath170-connected to @xmath199 .",
    "thus @xmath26 is separable by theorem ( [ bflychainclaim ] ) .",
    "having arrived from the initial input @xmath53 to one with no separable qubits , using input from merlin , we now show that with the help of merlin , the new instance can be viewed as a @xmath16-local problem .",
    "this is formalized by the following theorem :    [ thm:2lclreduce ] for any instance @xmath53 of @xmath166 with no separable qubits there exists a partition of the set of vertices of @xmath56 into disjoint sets : @xmath284 where each @xmath183 is of constant size , such that any operator @xmath285 , acts on qudits from at most @xmath16 such sets @xmath183 .",
    "as previously discussed , the way this theorem is proved , is by identifying a special @xmath4-d structure called the backbone whose properties allow to coarse - grain the set of qubits into constant - dimension sets , such that each operator is @xmath16-local w.r.t . these sets .",
    "here we define and identify the backbone , and prove its desired properties .",
    "[ def : bkbn ]    * backbone *    for an instance @xmath53 of @xmath166 we define the backbone to be a maximal length operator path @xmath49 in the connectivity graph @xmath56 .",
    "if there are several such maximal length paths , we take one of them arbitrarily .",
    "we start by proving a lemma which states that for any backbone qubit , any operator that acts on that qubit must also act on some `` nearby '' backbone qubit .",
    "[ lem : entrap]*short range connectivity in the backbone * let @xmath286 be a backbone of a connected - graph instance @xmath53 with no separable qubits , such that @xmath287 .",
    "let @xmath288 and let @xmath289 be some backbone operator .",
    "then for any @xmath290 that acts on @xmath26 , there exists another qubit @xmath291 examined by @xmath2 , and a backbone operator @xmath292 such that @xmath293 where addition is modulo @xmath235 for a closed operator path .",
    "we say @xmath288 is a `` middle '' qubit if it is acted upon by @xmath14 consecutive backbone operators @xmath294 ; if @xmath49 is a closed path , then all qubits in @xmath50 are middle qubits .",
    "if @xmath49 is an open path , all qubits are middle qubits except for the two qubits at the beginning and the two qubits and the end of the path ; we call those edge qubits .",
    "the claim easily follows for a middle qubit @xmath26 : let @xmath26 be such a qubit , acted upon by @xmath14 backbone operators @xmath294 .",
    "these constitute an operator crown on @xmath26 , so any @xmath46 acts on some other qubit @xmath66 in @xmath295 ; @xmath66 and @xmath26 are thus acted upon by @xmath296 where @xmath297 .",
    "this proves the claim for the case in which the backbone is a closed path . for the case of an open path",
    ", we only need to prove the claim for its edge qubits .",
    "let us consider an edge qubit which belongs to the `` left '' edge , namely , the qubit belongs to @xmath199 ; the proof for the other side is essentially identical .",
    "let @xmath298 be some operator in @xmath53 .",
    "we discuss separately @xmath14 cases : at least one of @xmath299 is a middle qubit , at least one of @xmath299 is an edge qubit , or both of them are outside of @xmath50 .    1 .",
    "* either @xmath7 or @xmath8 is a middle qubit * assume wlog that @xmath7 is a middle qubit .",
    "suppose on the negative , that the minimal value @xmath300 for which there exists some @xmath301 such that @xmath302 or @xmath303 is @xmath34 .",
    "let @xmath304 be the set of the crown qubits of @xmath7 .",
    "since @xmath305 then @xmath306 , so by claim ( [ cl : nosep1 ] ) it must be that @xmath307 .",
    "in addition , since @xmath305 we know that @xmath8 is a middle qubit , which is adjacent to @xmath7 .",
    "@xmath8 can not be in @xmath64 for @xmath308 by our assumption ; hence we know that both @xmath7 and @xmath8 are adjacent `` middle qubits '' that are distant from @xmath26 .",
    "consider then the terms @xmath2 and @xmath199 .",
    "since both @xmath7 and @xmath8 are distant from @xmath26 , we have that @xmath275 w.r.t . qubit @xmath26 . by claim ( [ cl : nosep2 ] ) there exists an operator path of length exactly @xmath14 between @xmath2 and @xmath199 , which implies the existence of an operator @xmath309 that shares two qubits with @xmath199 , and hence acts on at most one particle from @xmath310 .",
    "however , since @xmath181 shares two particles with @xmath2 , it must act on either @xmath7 or @xmath8 ; this contradicts claim @xmath311 w.r.t either qubit @xmath7 or qubit @xmath8 .",
    "@xmath7 or @xmath8 is an edge qubit * suppose at least one of @xmath7 or @xmath8 are edge qubits , say qubit @xmath7 . hence , either @xmath312 or @xmath313 , in both cases we are done as @xmath314 .",
    "* @xmath7 and @xmath8 are not in the backbone * in this last case we assume that neither @xmath7 nor @xmath8 are in @xmath50 . we show that this case is impossible , since it implies that the backbone can be extended , contradictory to the definition of the backbone ( definition [ def : bkbn ] ) .",
    "+ denote by @xmath315,@xmath316 , and @xmath317 as the first @xmath14 operators .",
    "so we assume that either @xmath318 or @xmath319 .",
    "+ if @xmath318 , there exists by claim ( [ cl : nosep2 ] ) an operator path of length at most @xmath14 between @xmath2 and @xmath199",
    ". it must be of length exactly @xmath14 by the assumption that @xmath299 are not in the backbone , and so @xmath2 can not intersect @xmath199 with two qubits to make a path of length @xmath16 .",
    "this implies the existence of @xmath181 that acts on @xmath320 , and shares two qubits with @xmath199 .",
    "so if @xmath181 acts on @xmath321 ( as in figure [ fig : ext1 ] ) then @xmath2 and @xmath181 can be appended to @xmath49 to form a @xmath322-length operator path .",
    "+ otherwise , @xmath181 acts on @xmath323 ( as in figure [ fig : ext2 ] ) .",
    "let us examine now @xmath181 and @xmath260 which share qubit @xmath323 .",
    "there exists an open operator path on qubit @xmath323 comprised of the following @xmath0 operators : @xmath324 .",
    "thus by claim ( [ cl : bridge ] ) there exists an operator @xmath325 by removing @xmath326 from @xmath49 , and appending @xmath327 to @xmath49 , we end up with a backbone of size @xmath328 .",
    "+ if @xmath319 then @xmath2 is connected to @xmath199 by some operator @xmath329 , which shares two qubits with @xmath199 .",
    "if @xmath181 acts on @xmath320 we can append @xmath181 to @xmath49 , and increase its length to @xmath328 ( notice that we can not append @xmath2 as well , since @xmath330 share qubit @xmath321 despite their index difference being greater than @xmath16 in the new path , and so this is not a legal operator path ) . otherwise , @xmath181 acts on @xmath323 , as in figure [ fig : ext3 ] . in this case",
    "we can add @xmath2,@xmath181 to @xmath49 , and remove @xmath199 , thereby increasing the length of @xmath49 yet again by @xmath4 .",
    "given a backbone @xmath331 , we now define the combined particles .",
    "* the combined particles @xmath183*[def : qi ] let @xmath332 be a partition of the qubits in @xmath50 , @xmath333 generated by grouping together contiguous sets of @xmath182 qubits in the most natural way , from left to right along the backbone . if the number of qubits in @xmath50 does not divide by @xmath182 ( but is larger than @xmath182 ) , we simply make the last @xmath334 larger ; in any case each @xmath183 contains at most @xmath335 qubits . if @xmath50 contains less than @xmath336 particles , than there is just one particles , @xmath337 containing all of them .",
    "[ cl : bkbn1 ]    * any operator touches the backbone in at least two close qubits *    assume that @xmath56 is connected .",
    "then , for any operator @xmath338 , at least two of the three qubits @xmath339 , must be contained in @xmath340 , and moreover , @xmath341 is contained in two adjacent combined particles @xmath342 with addition modulo @xmath343 ( or in one combined particle ) .",
    "we first show that at least two qubits of @xmath344 are in @xmath340",
    ". it can not be that exactly one of its particles is in @xmath340 since this is in contradiction to lemma ( [ lem : entrap ] ) .",
    "so it is left to rule out the case in which none of its particles are in @xmath340 .",
    "we will show that this case is impossible .",
    "since @xmath56 is connected , claim ( [ connected ] ) applies .",
    "hence , for any qubit of @xmath344 there is an operator path starting from an operator acting on that qubit , to some operator @xmath301 .",
    "let @xmath345 denote the first operator on the path for which @xmath346 intersects @xmath50 .",
    "by lemma ( [ lem : entrap ] ) @xmath345 examines at least two qubits in @xmath50 .",
    "so let us now consider @xmath347 . since @xmath347 intersects @xmath345 by two qubits , at least one of the intersection qubits must be in @xmath340 .",
    "so @xmath347 examines at least one qubit in @xmath340 .",
    "this is a contradiction to the fact that @xmath345 is the first operator on the path that intersects @xmath340 .",
    "now we show that @xmath348 is distributed among two adjacent @xmath183 s .",
    "we divide to two cases : @xmath349 ( note that this does nt mean that @xmath350 is in the backbone ) or only two qubits are in @xmath50 .",
    "we start with the first case .",
    "let @xmath351 .",
    "let @xmath352 .",
    "then there exists some @xmath353 , and some @xmath292 s.t .",
    "@xmath354 by lemma [ lem : entrap ] . by applying this argument",
    "either once or twice we get that for any two qubits in @xmath344 , there are two backbone operators acting on them with indices which are at most @xmath355 apart .",
    "this means that these qubits must be contained in two adjacent @xmath183 s ( or just in one ) .",
    "otherwise , two of the qubits @xmath344 are in @xmath50 . in this case , consider the first qubit of these @xmath16 , which belongs to some operator in the backbone .",
    "it follows from lemma ( [ lem : entrap ] ) that the second qubit belongs to an operator which is at most @xmath0 operators away ; thus , these two qubits belong to two adjacent @xmath183 s ( or just in one ) .",
    "[ cl : bkbn2 ]    * no shortcuts outside of backbone *    let @xmath356 be some qubit outside the backbone",
    ". then there exists @xmath300 such that for all @xmath357 , @xmath358 , with index addition modulo @xmath343 .    given a qubit @xmath26 ,",
    "let @xmath359 be two operators on @xmath26 .",
    "we first show that @xmath360 are grouped into at most two adjacent combined particles @xmath361 for some @xmath300 .",
    "since @xmath26 is not separable , there exists by claim ( [ cl : nosep2 ] ) an operator path on @xmath26 of length at most @xmath14 between @xmath350 and @xmath345 .",
    "so there are two cases : either @xmath362 or there exists an operator @xmath309 that shares two qubits with both @xmath350 and @xmath345 .",
    "we will make the claim first for the second case . since @xmath356 the two other qubits examined by @xmath181 are in @xmath50 by claim ( [ cl : bkbn1 ] ) .",
    "let us consider one of the two qubits in @xmath363 , say @xmath364 , and let @xmath365 act on @xmath364 . by lemma ( [ lem",
    ": entrap ] ) there exists another qubit in @xmath363 , say @xmath366 , and an operator @xmath367 acting on @xmath366 , s.t .",
    ", @xmath368 .",
    "thus the two qubits other than @xmath26 which @xmath181 acts on have backbone operators acting on them which are of distance @xmath0 apart .",
    "the same property holds for the qubits of @xmath369 , and @xmath370 .",
    "thus any pair of qubits in @xmath371 belong to operators of index difference at most @xmath372 .",
    "thus , @xmath360 are grouped into at most two adjacent combined particles @xmath361 for some @xmath300 .",
    "since the above property holds for all pairs of operators on @xmath26 , we have that @xmath373 for some @xmath300 .      by claims ( [ cl :",
    "bkbn1]),([cl : bkbn2 ] ) we realize by now that the input with no separable qubits @xmath53 and a connected interaction graph @xmath56 has , in fact , a very constrained structure . to describe this structure more precisely , we now define a partition of all qubits outside of the backbone into sets denoted by @xmath374 as follows .",
    "* the partition of the outer qubits*[def : vi ] we define the set @xmath375 which is comprised of @xmath343 or @xmath376 ( depending on whether the backbone is closed or open ) disjoint sets of qubits @xmath377 , as follows : @xmath58 is the set of all qubits not in @xmath50 .",
    "the sets @xmath374 are defined iteratively : @xmath378 is defined as the set of all qubits @xmath379 satisfying that : for any operator @xmath380 @xmath381 .",
    "@xmath382 is defined as the set of all qubits @xmath383 , satisfying that : for any operator @xmath380 @xmath384 .",
    "and so on .    note",
    "that the above definition indeed defines a partition of all qubits outside the backbone .",
    "we thus deduce that the picture of interactions is severely restricted :    * almost one dimensional structure:*[def:1ds ] we consider a tuple @xmath385 consisting of a set of distinct qudits @xmath386 , a set of non - intersecting qubit sets @xmath387 ( non intersecting with the @xmath183s as well ) and a set of operators @xmath53 on those particles .",
    "we say that a tuple @xmath385 has an `` almost one dim structure '' if each @xmath388 has @xmath389 for some @xmath59 .",
    "see figure [ fig : step2 ] for a schematic example of such a one dimensional structure . by definition ( [ def : vi ] ) and by claims [ cl : bkbn1 ] and [ cl : bkbn2 ] , we have that the resulting interaction after the partition into @xmath183 is indeed almost one dimensional :    [ cl : structure ] we are given @xmath53 with no separable qubits s.t .",
    "@xmath56 is connected .",
    "consider the backbone @xmath49 on @xmath53 , with @xmath183 as defined in definition [ def : qi ] , and @xmath390 as defined in definition [ def : vi ] .",
    "then the tuple @xmath391 is an almost one dimensional structure , namely , for any interaction @xmath350 in the instance @xmath53 , @xmath392 contained in @xmath393 for some particular @xmath59 .",
    "we can now use this to derive two - locality .",
    "we would now like to discover the two locality by making use of the structure of interactions with the backbone , which was revealed in the previous section .",
    "for this , we prove a lemma which is very similar to lemma ( [ lem : bv ] ) , regarding the existence of a separating decomposition as define in definition ( [ def : algdec ] ) .",
    "[ slicelemma ] let @xmath385 be a tuple which is an almost one dimensional structure , as in definition [ def:1ds ] .",
    "for any @xmath394 , there exists a direct - sum decomposition of @xmath395 preserved by all operators in @xmath53 which is a separating decomposition w.r.t .",
    "any pair of operators @xmath396 where @xmath397 and @xmath398 .",
    "fix a backbone qudit @xmath183 .",
    "denote by @xmath399 the @xmath60-th operator such that @xmath400 and @xmath401 the @xmath1-th operator such that @xmath402 .",
    "denote by @xmath403 the algebra of @xmath404 on @xmath183 and by @xmath405 the algebra of @xmath406 on @xmath183 .",
    "finally , denote by @xmath407 the algebra spanned by @xmath408 and similarly , by @xmath409 the algebra spanned by @xmath410 .",
    "if there is just one qudit @xmath183 the lemma follows trivially from lemma ( [ lem : bv ] ) . otherwise , by definition ( [ def : qi ] )",
    "we have @xmath411 . then @xmath412 w.r.t .",
    "@xmath183 so by fact ( [ fact : algcomm ] ) the algebras @xmath403 and @xmath405 commute for all @xmath413 . as a result @xmath407 and @xmath409 commute , because their generating sets commute .",
    "let us apply fact ( [ cl : algdec ] ) : there exists a separating decomposition of @xmath395 w.r.t @xmath407 and @xmath409 .",
    "in each subspace of this decomposition , the restricted algebras act on separate subsystems .",
    "since @xmath414 for all @xmath60 , then @xmath403 preserves this decomposition , and acts only on the left subsystem inside each subspace .",
    "the same holds true for @xmath405 for all @xmath1 w.r.t . the right subsystem .",
    "hence this decomposition is separating w.r.t .",
    "any pair of local algebras @xmath403 and @xmath405 .",
    "since @xmath404 and @xmath406 share only @xmath183 to begin with , this is a separating decomposition w.r.t .",
    "these operators as well .",
    "[ [ red2lcl ] ] reducing to a @xmath16-local problem + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    merlin sends arthur for each qudit @xmath183 a subspace index @xmath415 which by lemma ( [ slicelemma ] ) partitions all the operators on @xmath183 into two disjoint left and right subsystems in the @xmath415 subspace of @xmath183 . since by lemma ( [ slicelemma ] )",
    "all operators preserve this tensor product subspace , then the tuple @xmath385 is satisfiable if and only if there exists such a tensor product subspace in which the restricted instance is satisfiable .",
    "let @xmath416 denote the projection on the @xmath415 subspace of backbone qudit @xmath183 .",
    "after restricting all operators @xmath388 to the tensor product subspace @xmath417 , each restricted operator @xmath418 acts on @xmath419 for some @xmath59 , and possibly some qubit @xmath420 .",
    "so let us now fuse each pair @xmath421 into a single qudit .",
    "we now regard the tuple @xmath385 as the modified instance where the qudits @xmath183 are the fused qudits , and @xmath53 is the restricted operator set .",
    "it can be easily checked that all @xmath388 are now at most @xmath16-local , acting on a single fused qudit and possibly some @xmath420 .",
    "this problem can then be verified using lemma ( [ lem : bv ] ) .",
    "let @xmath422 denote the projection on the @xmath423 subspace of the fused qudit @xmath419 .",
    "then merlin sends arthur a tensor - product subspace @xmath424 - i.e. a subspace index for each fused qudit .      to summarize our proof of theorem [ thm:2lclreduce ]",
    ", we describe the protocol of the verifier , and recall why it is complete and sound .",
    "the witness that merlin sends arthur is :    * an index @xmath32 of a subspace for each separable qubit . *",
    "a description of constant - size sets @xmath183 and the ( possibly non - constant size ) sets @xmath374 , for all @xmath59 . *",
    "an index @xmath415 for each @xmath183 , as well as the description of the actual subspace @xmath425 , and its tensor product structure , @xmath419 .",
    "the subspaces are provided by providing the basis vectors . note that since the dimension of each @xmath183 is constant , this description is efficient as long as the accuracy required is at most to within inverse exponential in the number of qubits problem , since we are only trying to separate a zero eigenvalue from @xmath4 or more .",
    "in fact , even inverse polynomial accuracy in each such component will suffice , since there are only polynomially many terms contributing to the error .",
    "] * a witness following lemma ( [ lem : bv ] ) for the two - local problem following the merging of on the constant size sets .",
    "the verification procedure is performed as follows : first , arthur restricts all the operators in @xmath53 to the subspaces of the separable qubits , provided by merlin , and derives an instance @xmath193 with supposedly no separable qubits .",
    "arthur then verifies that after unifying some qubits of the system into constant size sets @xmath183 following a recipe by merlin , the instance @xmath193 has an almost @xmath4-dim .",
    "structure @xmath426 .",
    "then , arthur restricts all operators on @xmath395 to the subspace @xmath427 as provided by merlin for each @xmath59 .",
    "this is a tensor product of subspaces , one for each @xmath59 .",
    "he then fuses @xmath428 and @xmath429 remnants of the qudits ( i.e. @xmath430 with @xmath431 for each @xmath59 ) and achieves a @xmath16-local problem .",
    "finally , arthur uses a witness provided by merlin for the @xmath16-local problem as in lemma ( [ lem : bv ] ) .",
    "we now argue for completeness and soundness : by claim ( [ step1 ] ) the first step results in an equivalent instance @xmath193 , which is a positive instance if and only if @xmath53 is a positive instance .",
    "the completeness and soundness of the third step follows exactly the proof of lemma ( [ slicelemma ] ) : i.e. merlin can find a subspace index @xmath32 for each @xmath183 , that separates the interaction on @xmath183 into left - right components , such that the restricted hamiltonian is a positive instance , if and only if the original hamiltonian is a positive instance .",
    "the correctness of the last step of the protocol , namely , for the two local residual problems , follows from the correctness of @xcite .",
    "we end with the following corollary :    * constant depth diagonalizing circuit * for any @xmath166 hamiltonian @xmath2 there exists a quantum circuit of depth @xmath14 , where each gate acts on at most @xmath432 qubits that diagonalizes @xmath2 .",
    "a depth @xmath14 circuit is induced in a straightforward manner from the protocol above .",
    "all separable qubits can be diagonalized separately from all other particles using @xmath4-local qubit gates .",
    "let us now consider just the nonseparable qubits .",
    "we work our way from the end of the protocol in ( [ red2lcl ] ) backwards : the first two layers handle the @xmath16-local star - topology instance , and the third layer embeds this instance into the backbone .",
    "we recall again the following notation : the backbone qudits are denoted by @xmath395 , and restricted to some subspace @xmath32 we have @xmath433 and @xmath434 for each @xmath59 .",
    "then when merlin proves to arthur the satisfiability of the star - topology instance , he provides a subspace @xmath422 for each fused qudit @xmath435 . to write the circuit , we actually go in reverse order as follows :    1 .",
    "* layer 1 : disjoint hamiltonian diagonalization * + a diagonalizing gate for each disjoint hamiltonian interaction @xmath436 where @xmath420 and @xmath66 is some fused qudit @xmath437 restricted to some subspace @xmath438 . each such gate is a @xmath16-local unitary acting on the qubit @xmath26 and some qudit of dimensionality less than the product of dimensions of two @xmath183 s , hence at most a constant .",
    "2 .   * layer 2 : embedding of disjoint hamiltonians into star topology * an isometric embedding @xmath58 of the individual hilbert spaces @xmath66 from the item above ( which may require adding some ancilla qubits ) , into a fused qudit that is now still restricted to some subspace @xmath32 .",
    "we have @xmath439 the isometry @xmath382 acts on possibly numerous individual particles such that the product of their sizes is at most @xmath432 .",
    "* layer 3 : embedding of star topology instance into backbone * an isometric embedding of each pair of adjacent fused subparticles : @xmath440 this may also require adding some ancillary qubits .       * remark * : we remark that in fact , a depth @xmath16 quantum circuit suffices .",
    "we will defer the proof to a later version of the paper .",
    "in this section we extend the result of the previous section for qutrits , presuming the interaction graph can be embedded on the plane in a special way .      for a planar connected interaction graph @xmath56 of a @xmath167 instance @xmath53 , embedded in @xmath441",
    "we define the following :    [ def : op ]    * op / noop faces *    let @xmath442 be some face of @xmath443 .",
    "@xmath442 is said to be an `` op '' face if it has @xmath14 vertices , and there exists an operator @xmath285 that acts on its @xmath14 vertices ( qudits ) .",
    "if there is no operator that acts on its vertices it is called a `` noop '' face . in this respect ,",
    "the face extending from the boundary of @xmath443 to infinity is a `` noop '' face .",
    "we now define a notion of planar @xmath36 :    * planar @xmath36 *    an instance @xmath53 of @xmath52 is said to be `` planar @xmath36 '' if its interaction graph is planar , connected , and moreover , can be associated with an embedding in the plane , such that every operator in @xmath53 is associated with an `` op '' face . in other words , the three vertices corresponding to the particles on which the operator acts , are connected by edges in the graph , such that the area surrounded by those edges does not contain any other vertex .    in figure",
    "[ fig : nonplanar2 ] we provide examples which explain the difference between the mere requirement that the interaction graph is planar , and our definition of planarity .",
    "so far , these are very mild and natural restrictions on top of planarity .",
    "we now add one additional `` natural '' requirement .",
    "for this , let us define another notion :    * nearly - euclidean triangulation of a polygon *    a finite planar graph is said to be a nearly euclidean ( ne ) triangulation of a polygon if every face except the infinite face has three edges , the edges are straight lines , and moreover , the ratio between the shortest and longest edge is bounded from above by some overall constant , and the angle between any two incident edges is bounded from below by some overall constant angle .    notice",
    "that this definition ensures that there can not be areas in which the density of vertices is much higher than in other places , and that the length of a path in the graph is not too far from that of the euclidean distance between the two end points . in short ; propagation along paths in the graph behaves more or less like it would on a periodic lattice , or in euclidean space .",
    "we now define ne @xmath36 instances :    [ def : nedef ] * nearly euclidean @xmath36 *    an instance @xmath53 of planar @xmath52 is said to be nearly euclidean ( ne ) if there exists a ne planar triangulation @xmath444 of a convex polygon in the plane , such that the interaction graph of @xmath53 , @xmath56 , is a subgraph of this triangulation , i.e. @xmath445 and the number of vertices of @xmath444 is at most polynomial in the number of particles ( equivalently , vertices ) in @xmath53 .",
    "our main result in this section is :    [ thm : d3 ] the problem of @xmath167 restricted to ne planar instances is in np .    from our proof",
    ", we also derive the following corollary :    [ cor : circuit ] given an instance of ne @xmath167 , there exists a quantum circuit of depth @xmath14 , involving @xmath16-local gates acting on nearest neighbor qutrits in the interaction graph of the original instance , which diagonalizes the hamiltonian ( and thus generates a basis of eigenstates from a basis of input computational basis states ) .",
    "similar to the proof for qubits , our proof of theorem ( [ thm : d3 ] ) above is along the following strategy : identify `` classically''-behaving qutrits , and eliminate them using input from merlin .",
    "then , show that the residual instance can be coarse - grained into a @xmath150 instance for a constant @xmath12 .",
    "the proof that this coarse graining can be done , however , is entirely different , from the one in the previous chapter .",
    "the first difference is in identifying classically - behaving qutrits ; this is slightly more involved than for qubits .",
    "the larger qudit dimension allows qutrits to interact in certain configurations that generate qubit separability , but do not generate qutrit separability . consider for example the following set of @xmath0 operators : @xmath446 where @xmath447 @xmath448 @xmath449 @xmath450 these operators commute yet do not agree on any single decomposition of @xmath26 , despite the fact that they are all @xmath170 connected .",
    "the fact that @xmath170-connectedness does not imply separability ( i.e. , no equivalent of theorem [ bflychainclaim ] holds ) destroys the basis for most of the geometric structure we managed to prove in the case of qubits .    from an algebraic perspective",
    "the above phenomenon occurs because an operator on a qubit can be written in block - diagonal form w.r.t",
    ". only one basis of that qubit ( see lemma ( [ cl : same ] ) ) .",
    "alternatively stated , any two decompositions of @xmath46 w.r.t .",
    "the qubit @xmath26 preserve each other ( i.e. , the projections on the subspaces in the decomposition preserve the subspaces in the other decomposition ) and are hence identical .",
    "yet for qutrits , this is obviously not the case .",
    "consider for example the following operator : @xmath451 where the first term of each summand acts on a qutrit @xmath26 , and the second term acts on the rest of the system .",
    "if the @xmath14 projections @xmath452 are linearly independent , then any non - trivial direct - sum decomposition of @xmath2 w.r.t .",
    "@xmath26 must preserve the subspaces corresponding to the decomposition above ( @xmath453 ) . if , however , @xmath454 then @xmath2 may also be written as @xmath455 where @xmath456 projects on the vector @xmath457 and @xmath458 projects on the state @xmath459 .",
    "so this decomposition of @xmath2 does not preserve the first decomposition .",
    "nevertheless , notice in the above example that every decomposition must preserve the subspace spanned by @xmath460 , and its orthogonal complement .",
    "we call this one dimensional subspace a * critical subspace*. more formally , a critical subspace is a rank @xmath4 projection in the center of the induced algebra of the operator on the target qutrit . for the above example , if @xmath461 are all linearly independent , @xmath2 has @xmath14 critical subspaces spanned by the states @xmath462 , whereas if @xmath463 @xmath2 s only critical subspace is spanned by @xmath460 .",
    "we show ( facts ( [ fact : reduce ] ) and ( [ fact : bflycrit ] ) ) that a @xmath170 relation between a pair of operators acting non - trivially on a qutrit @xmath26 implies that each of these operators has a critical subspace on @xmath26 , and these subspaces are either identical or orthogonal , and moreover each of the operators preserves each other s critical subspace .",
    "this behavior of critical subspaces is what replaces the notion of unique decomposition in qubits , though it is weaker .",
    "we can prove the following , when restricting the interactions to act on the plane .",
    "consider all operators on a qutrit @xmath26 ; each operator has its own critical subspace in the hilbert space of @xmath26 .",
    "we prove that if the number of operators is large enough , any assignment of critical subspaces to the operators on @xmath26 forces all of the operators to preserve at least one of the assigned critical subspaces , and so the qutrit becomes separable .",
    "this means that there can not be more than a small number of operators acting on @xmath26 ; this is proved in lemma ( [ lemma : cq2 ] ) .",
    "an easy implication of lemma ( [ lemma : cq2 ] ) is that in an instance with no separable qutrits , all vertices in the interaction graph must be of degree at most @xmath33 .",
    "( we state this in corollary ( [ cor : deg ] ) ) .",
    "this is a crucial point .",
    "we show that planar - embedded hamiltonians in which all the vertices are of degree at most @xmath33 , must exhibit an intriguing characteristic , which is in fact entirely geometrical ( see claim ( [ cl : outerbound ] ) ) .",
    "consider a planar embedding of a graph , whose faces are colored black and white .",
    "moreover , only @xmath14-vertex faces can be colored black ( black regions correspond to terms in the hamiltonian ) . then there must be a constant density of white `` holes '' ; i.e. , any point in the plane is within a constant distance ( in terms of number of faces ) from such a white hole - i.e. , a region where no interaction acts .",
    "the proof of this geometric fact uses the euler characteristic but is fairly involved and we delay its overview to subsection ( [ subsec : regspac ] ) where it is proven .",
    "the main point is that the existence of those regularly spaced holes allows us , in the case the interaction graph is ne ( and this is the only place where we use the ne property in the proof ) to coarse grain the set of particles , and by this derive a @xmath16-local instance .",
    "this is done in claim ( [ cl : cutting ] ) : the rough idea is to lay down on the plane a `` net '' that partitions the plane in such a way that in each region , there are only constantly many particles , while making sure that the junctions of the net fall precisely inside those white `` holes '' .",
    "if we combine the particles in each region together , then each term in the hamiltonian acts on at most @xmath16 of the combined particles .",
    "we now proceed to the details .",
    "we begin by defining qutrit separability in exactly the same way as qubit separability :    [ def : qutritsep ] a qutrit @xmath26 is called separable in an instance @xmath53 of @xmath167 if there exists a non - trivial direct - sum decomposition of @xmath27 @xmath464 such that any operator @xmath465 preserves this decomposition , i.e. @xmath466 .",
    "similar to handling @xmath166 the np protocol begins by merlin helping arthur remove all separable qutrits from the system .",
    "let @xmath53 be some instance of a ne @xmath167 , and @xmath26 be some qutrit .",
    "if @xmath26 is separable then following input from merlin , its dimension is reduced to at most @xmath16 , using restriction to some subspace . after the restriction , if the dimension is @xmath4 , the particle essentially `` vanishes '' from the input , so suppose we are left with a @xmath16-dimensional particle , a qubit .",
    "this qubit may now be either separable or non - separable .",
    "if it is separable , by additional input from merlin , it `` vanishes '' from the input .",
    "thus , after all qubit / qutrit separability has been exhausted , we are left with a hamiltonian acting on qutrits and qubits , all of which are non - separable .",
    "we note that the remaining interaction graph is still ne , even though some `` op '' faces may have now turned into `` noop '' faces .",
    "we would now like to develop tools that will allow us to prove geometrical restrictions on the residual problem after removing all separable qudits .",
    "[ def : critsub ]    * critical subspace *    let @xmath46 be an operator acting on @xmath26 . denote by @xmath79 the algebra induced by @xmath2 on @xmath26 . any rank-@xmath4 projection in the center of this algebra @xmath467 , induces a a critical subspace of @xmath2 on @xmath26 , which is the one dimensional subspace which is the image of the rank-@xmath4 projection .",
    "we now prove several useful facts regarding critical subspaces .",
    "the following facts hold for all qudits of dimension @xmath468 .",
    "[ fact : reduce ] let @xmath180 be two operators that act non - trivially on @xmath26 such that @xmath469 . we claim that each of operator has at least one critical subspace on @xmath26 .",
    "also , each critical subspace of @xmath199 is preserved by @xmath200 and vice versa .",
    "let @xmath470 , @xmath471 denote the algebras induced by @xmath180 on the qudit @xmath26 , respectively .",
    "first , we show that both algebras @xmath470 , @xmath471 are reducible .",
    "suppose on the negative that it is not the case , and that say , @xmath472 is irreducible .",
    "by fact ( [ fact1 ] ) it is isomorphic to @xmath473 . since @xmath474 or @xmath475 , then one of the hilbert spaces @xmath476 or @xmath477 is of dimension @xmath4 .",
    "it can not be that @xmath476 is of dimension @xmath4 , since this would imply that the algebra @xmath470 is trivial , and this means that the operator @xmath199 acts trivially on @xmath26 , contrary to our assumption .",
    "thus , it must be that @xmath477 is of dimension @xmath4 . since @xmath478 commute",
    ", this implies that @xmath479 is trivial , and so @xmath172 acts trivially on @xmath26 contrary to our assumption .",
    "thus by fact ( [ fact2 ] ) each of the two algebras can be non - trivially decomposed into a direct - sum of algebras , following an orthogonal decomposition of @xmath27 into a direct - sum of subspaces @xmath168 .",
    "since @xmath468 at least one such subspace is of dimension @xmath4 , so the center of each algebra has a rank @xmath4 projection , and so both operators have a critical subspace on @xmath26 .",
    "we now show that the critical subspaces of one operator are preserved by the other .",
    "let @xmath480 be a critical subspace of @xmath171 .",
    "let @xmath481 be the projection on @xmath482 ; by definition ( [ def : critsub ] ) , @xmath483 and thus it is contained in @xmath470 . since @xmath470 commutes with @xmath471 by fact [ fact : algcomm ] , then @xmath481 commutes with any operator @xmath484 , thus by fact [ fact : trivial2 ] @xmath471 preserves @xmath482 , and thus so does @xmath172 .",
    "[ fact : bflycrit ] let @xmath485 be two operators on @xmath26 .",
    "let @xmath486 be a critical subspace of @xmath171 on @xmath26 .",
    "then any critical subspace of @xmath172 on @xmath26 is either @xmath486 or a subspace orthogonal to it .",
    "let @xmath470 , @xmath471 denote the algebras of @xmath180 on qubit @xmath26 .",
    "the algebra @xmath471 commutes with @xmath470 , and so it commutes with any element in the center of @xmath470 , in particular , the projection on @xmath486 .",
    "by fact [ fact : trivial2 ] any operator in @xmath471 preserves @xmath486 . let @xmath487 be a critical subspace of @xmath172 , and let @xmath488 be the projection on it .",
    "since this projection is contained in @xmath471 , it too preserves @xmath486 .",
    "we have that a projection on a one - dim subspace @xmath487 preserves a one dimensional subspace @xmath486 and so either the two are equal or they are orthogonal .",
    "[ fact : tight ]",
    "let @xmath171 be an operator with a critical subspace on @xmath26 , and suppose that @xmath199 preserves two @xmath4-dim . subspaces of @xmath26 : @xmath489 such that @xmath490 and @xmath491 are neither equal nor orthogonal .",
    "then @xmath492 is a critical subspace of @xmath199 .",
    "since @xmath199 preserves both @xmath490 and @xmath491 , it also preserves their two dimensional span , which we shall denote by @xmath493 , and by fact [ fact : trivial1 ] , it also preserves @xmath494 which we denote by @xmath495 .",
    "let us examine the operator @xmath199 restricted to @xmath493 : @xmath496 .",
    "this operator too preserves @xmath490 and @xmath491 , and so since @xmath490 and @xmath491 are neither equal nor orthogonal , we get that this operator is block - diagonal w.r.t .",
    "two different orthogonal bases : @xmath497 and @xmath498 .",
    "since @xmath493 is a two dimensional subspace , we can proceed in a similar way to the proof of claim ( [ cl : same ] ) , and conclude that @xmath199 restricted to @xmath493 is trivial on @xmath26 , and can be written as @xmath499 where @xmath500 is a projection on the system not including @xmath26 .",
    "all in all we have : @xmath501 where @xmath502 projects on @xmath493 and @xmath503 projects on its orthogonal complement @xmath495 .",
    "it can not be that @xmath500 and @xmath504 are linearly dependent , since this would mean that they are in fact equal , which would imply that @xmath199 is trivial , and thus does not have a critical subspace , contradicting the assumption of the statement .    hence , @xmath500 and @xmath504 are linearly independent , and so by definition [ def : induced ] the algebra induced by @xmath199 on @xmath26 , @xmath470 , is spanned by @xmath505 .",
    "its center thus included exactly one rank-@xmath4 projection , the projection on @xmath495 .",
    "[ fact : neithernor ] let @xmath46 act non - trivially on a qudit @xmath26 , and have an induced algebra @xmath479 on @xmath26 which is reducible . by the notation of definition ( [ def : qutritsep ] ) , denote the subspaces in the decomposition of the algebra by @xmath168 and the corresponding projections @xmath506 .",
    "consider an unrelated one - dimensional subspace of @xmath27 denoted @xmath490 . then if there exists an @xmath32 for which @xmath507 does not preserve @xmath490",
    ", then @xmath46 has a critical subspace on @xmath26 , denoted @xmath508 , and @xmath490 and @xmath509 are neither orthogonal nor equal .",
    "if @xmath507 does not preserve @xmath490 , then this means that also its complement @xmath510 does not preserve @xmath490 . since @xmath511 is trivially closed under complement with @xmath512 , also @xmath513 .",
    "then either @xmath132 or @xmath510 is a rank-@xmath4 projection in @xmath514 not preserving @xmath490 .",
    "the image of this rank-@xmath4 projection is a critical subspace by definition ( [ def : critsub ] ) .",
    "let us denote it by @xmath509",
    ". then @xmath490 and @xmath509 are neither orthogonal nor equal .      using the results of the previous subsection",
    ", we now show that all vertices are of degree at most @xmath33 .",
    "we prove the following claim for that purpose .",
    "[ cl : divide]*left - right partition implies consensus on decomposition * consider a set of operators on a qudit @xmath26 with @xmath468 , which are separated into two non - empty sets , such that any two operators from these two sets , one from each side , share only @xmath26 .",
    "then there is a non - trivial direct - sum decomposition of @xmath26 which is preserved by all those operators on @xmath26 .",
    "for a qubit @xmath26 the lemma is the same as corollary ( [ partitionclaim ] ) , so now we focus on @xmath26 being a qutrit .",
    "let us denote the sides of the division as side @xmath4 and side @xmath16 .",
    "we would like to show that there exists a direct - sum decomposition , preserved by all operators on both sides .",
    "first , for any pair of operators @xmath171 from side @xmath4 and @xmath172 from side @xmath16 we have @xmath201 so by fact ( [ fact : reduce ] ) both @xmath199 and @xmath200 have critical subspaces .",
    "let us take some operator on side @xmath4 , @xmath171 whose critical subspace is @xmath490 .",
    "we consider three possible cases and show that in each case , a `` consensus '' decomposition emerges .    1",
    ".   case @xmath4 : all operators on side @xmath16 have the same critical subspace of @xmath26 , denoted @xmath482 . then all operators on side @xmath4 must preserve this subspace by fact ( [ fact : reduce ] ) , and so @xmath482 is preserved by all operators on @xmath26 .",
    "case @xmath16 : there exists an operator in side @xmath16 which has a critical subspace equal to @xmath490 . in this case on each side of the devision @xmath490 is a critical subspace , so all operators ( on both sides ) must preserve this subspace by fact ( [ fact : reduce ] ) .",
    "case @xmath14 : neither of the two first cases hold .",
    "then there are at least two distinct critical subspaces on side @xmath16 , namely @xmath491 and @xmath495 and none of them is equal to @xmath490 . since @xmath490 is a critical subspace of an operator in side @xmath4 then by fact ( [ fact : bflycrit ] ) @xmath515 are both orthogonal to @xmath490 . since they are not the same , they span the entire orthogonal subspace to @xmath490 .",
    "any operator on side @xmath4 must preserve both @xmath491 and @xmath495 , by fact ( [ fact : reduce ] ) and thus it preserves the span of @xmath491 and @xmath495 , and so must also preserve the orthogonal subspace of this two dimensional subspace , namely @xmath490 . by fact",
    "( [ fact : reduce ] ) , any operator on side @xmath16 is @xmath170 with @xmath199 and thus must preserve @xmath490 too .",
    "[ cor : divide3 ] let @xmath26 be a qubit of dimension @xmath19 . if all operators on @xmath26 can be divided to two non - empty sets , such that any operator from one set intersects any operator in the other set in @xmath26 alone , then @xmath26 is separable .",
    "[ lemma : cq2 ] * no open operator paths of length @xmath516 * let @xmath53 be an instance of planar @xmath167 , and let @xmath26 with @xmath468 be a qudit in that instance .",
    "assume there exists a subset of the operators on @xmath26 that constitute an open operator path on @xmath26 of length at least @xmath33 , then @xmath26 is separable .",
    "let @xmath517 denote a length @xmath33 open operator path on @xmath26 , so @xmath199 and @xmath518 intersect only on @xmath26 .",
    "if @xmath26 is a qubit then by claim ( [ cl : nosep1 ] ) @xmath26 is separable , since two qubits of @xmath199 are not part of the operator crown @xmath519 .",
    "so we now treat the case where @xmath26 is a qutrit .",
    "we first show that all these operators agree on some non - trivial decomposition .",
    "the subset @xmath520 yields a division @xmath521 and @xmath522 such that any pair of operators , one from each set , intersect only on @xmath26 .",
    "thus , by claim ( [ cl : divide ] ) all these @xmath0 operators agree on some non - trivial decomposition of @xmath26 , denoted by @xmath490 and its orthogonal complement @xmath523 .",
    "let @xmath524 be the algebra of @xmath178 on @xmath26 .",
    "let @xmath525 be the direct - sum decomposition of @xmath27 corresponding to the algebra @xmath524 whose existence is promised by ( [ fact2 ] ) .",
    "since @xmath526 , then by fact ( [ fact : reduce ] ) @xmath260 has a reducible algebra on @xmath26 .",
    "so the decomposition @xmath168 is non - trivial .",
    "let us examine the behavior of the projections @xmath132 on the subspaces @xmath168 w.r.t .",
    "if @xmath490 is preserved by @xmath132 for all @xmath32 we are done , since by fact ( [ fact2 ] ) @xmath260 preserves @xmath490 , and so all @xmath33 operators preserve the decomposition @xmath497 .",
    "so suppose this is not the case .",
    "then there exists a subspace @xmath168 whose corresponding projection @xmath527 does not preserve @xmath490 .",
    "we are now in the situation handled by fact [ fact : neithernor ] ; we conclude that either @xmath132 or @xmath510 is a rank-@xmath4 projection in @xmath514 not preserving @xmath490 .",
    "the image of this rank-@xmath4 projection is a critical subspace denoted by @xmath509 .",
    "and @xmath490 and @xmath509 are neither orthogonal nor equal .    since @xmath528 and @xmath529 then by fact ( [ fact :",
    "reduce ] ) @xmath199 and @xmath518 preserve @xmath530 and so by our assumption they preserve both @xmath490 and @xmath530 .",
    "since their algebras on @xmath26 are reducible by fact ( [ fact : reduce ] ) , we conclude by fact ( [ fact : tight ] ) that they must both have the subspace @xmath531 as a critical subspace .",
    "we get that @xmath276 all of which intersect either @xmath199 or @xmath518 only on @xmath26 , must preserve @xmath495 by fact ( [ fact : reduce ] ) .",
    "therefore , all @xmath33 operators preserve @xmath495 .    to complete the proof we now need to show",
    "not only @xmath532 but all operators on @xmath26 can agree on some preserved non - trivial subspace .",
    "we will prove this by induction , `` adding back '' the other operators on @xmath26 one by one .",
    "let @xmath533 be all other operators on @xmath26 .",
    "we will assume that all operators @xmath534 ( for @xmath535 ) agree on a non - trivial decomposition ( namely , preserve its subspaces ) , and in particular , preserve a one dimensional subspace @xmath490 , and prove that @xmath536 must also agree on one such decomposition ( which might be different ) .",
    "we divide to two cases .",
    "either @xmath537 preserves @xmath490 , in which case we are done , or it does nt .",
    "let us therefore assume it does nt .",
    "since @xmath53 is planar , it must be that all operators @xmath533 satisfy @xmath538 , and so @xmath537 has at least one @xmath170 relation .",
    "by fact ( [ fact : reduce ] ) its algebra on @xmath26 @xmath539 is reducible , and so it has a non - trivial decomposition of this algebra ; using the notation of fact ( [ fact2 ] ) we denote the subspaces in the decomposition by @xmath168 .",
    "since @xmath537 does not preserve @xmath490 , this means that there exists a subspace @xmath168 whose corresponding projection does not preserve @xmath490 .",
    "we are now again in the situation of fact ( [ fact : neithernor ] ) and we conclude that the center of @xmath539 has a rank-@xmath4 projection on a one dimensional space which is neither equal nor orthogonal to @xmath490 . this is a critical subspace of @xmath537 denoted by @xmath540 .    by assumption , @xmath276",
    "preserve @xmath490 , and by fact ( [ fact : reduce ] ) @xmath276 preserve @xmath540 .",
    "we can now apply fact ( [ fact : tight ] ) to deduce that the critical subspace of all @xmath14 operators must be orthogonal to the space spanned by @xmath490 and @xmath540 .",
    "let us denote this space by @xmath482 .",
    "all other operators we mentioned have a @xmath170 relation to at least one of these @xmath14 operators , thus by fact ( [ fact : reduce ] ) all operators @xmath541 preserve @xmath482 .",
    "[ cor : deg ] if an instance of planar @xmath167 has no separable qudits , then all the vertices of its interaction graph are of degree at most @xmath33 .",
    "on the negative , let @xmath26 be a nonseparable qudit in an instance @xmath53 of ne planar @xmath167 , with degree is at least @xmath34 .",
    "since @xmath26 is nonseparable then by corollary ( [ cor : divide3 ] ) all operators on @xmath26 are operator - path connected .",
    "since @xmath53 is a planar instance , it means that there exists an operator path on @xmath26 comprised of all operators on @xmath26 .",
    "if the degree of @xmath26 is at least @xmath34 , this means that @xmath26 is acted upon by an open operator path of length at least @xmath33 so by lemma ( [ lemma : cq2 ] ) it is separable , contrary to our assumption .",
    "this subsection is entirely geometrical , and considers tiling of the plane with triangles .",
    "we show that if the tiling avoids vertices of degree @xmath34 and above , it must be that the tiling must contain regularly spaced holes , with constant density .",
    "[ def : dual ]    * dual graph *    given a planar graph @xmath443 , the dual graph of @xmath443 as follows : the set of vertices of @xmath542 are comprised of all faces in @xmath443 .",
    "an edge between vertices of @xmath542 exists , if and only if the respective faces share an edge in @xmath443 .    * tessellation *    given an instance @xmath53 planar @xmath36 , a _",
    "tessellation _ is a subset of operators @xmath543 , whose induced embedding , i.e. , the embedding of @xmath544 in @xmath441 , is a triangulation of a polygon , which contains no `` noop '' faces . for a tessellation @xmath545",
    "we define an external vertex as one which belongs to the infinite face , and otherwise it is an internal vertex .",
    "[ [ average - degree - and - the - euler - characteristic ] ] average degree and the euler characteristic + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    a well known formula connects the average degree of a vertex in a planar graph , with the average number of edges per face . given a tessellation @xmath545 , and its interaction graph @xmath544 with its embedding in @xmath441 , let @xmath7 be the average number of edges per face ( including the infinite face ) , and @xmath8 be the average number of edges incident on a vertex .",
    "let @xmath546 denote the number of faces of @xmath545 ( including the infinite face ) , @xmath58 the number of vertices , and @xmath61 the number of edges .",
    "recall the following definition :    * euler number * the euler number @xmath547 is defined to be @xmath548 .    assuming that @xmath544 is a connected planar graph , then by euler s theorem we have @xmath549 .",
    "one can easily check that the following relations hold : @xmath550 since counting the number of edges of each face ( including the infinite face ) counts twice the number of edges , and similarly , counting the number of edges incident on each vertex also counts twice the number of edges . using these two , together with the expression for @xmath547 yields the following formula :    @xmath551    where we have used the fact that @xmath549 .",
    "we prove the following claim :    [ cl : outerbound ] let @xmath552 be some constant .",
    "we are given a tessellation @xmath545 , such that there exists an operator @xmath553 for which the following holds : a ) any face in @xmath544 which is at @xmath554-distance at most @xmath555 from @xmath252 is an `` op '' face , and b ) all `` op '' faces in @xmath544 are at @xmath554-distance at most @xmath555 from @xmath252 .",
    "then there exists a vertex @xmath26 in @xmath545 whose degree is at least @xmath34 .",
    "we will assume that all vertices in @xmath545 have degree at most @xmath33 , and arrive at a contradiction . to do that",
    ", we will lower bound @xmath8 , the average number of edges incident on a vertex , by a number larger than @xmath33 .",
    "this would imply that there must be a vertex of degree @xmath34 or more .    in order to extract interesting information about @xmath8 ,",
    "we in fact turn to @xmath7 , the average number of edges per face , and prove it is very close to @xmath14 .",
    "in other words , we would like to show that @xmath7 is dominated by the `` internal '' faces which by our assumption are all `` op '' faces ( i.e. , their number of edges is @xmath14 ) , whereas the outside multi - edge face is negligible in determining the average number of edges of a face",
    ". we can then use equation [ eq : qutrit1 ] ; we will be able to deduce that @xmath8 must be strictly larger than @xmath33 , since @xmath556 are large .",
    "our main effort is thus to bound @xmath7 from above . to this end ,    let @xmath557 be the number of edges of the outside face of @xmath545 ( there is only one such face since @xmath545 is a tessellation ) .    and",
    "we can write @xmath558 we will show ( and that s the main effort in the proof ) that @xmath557 is bounded by a small constant , @xmath559 , so when @xmath546 is large enough , we will get an upper bound on @xmath7 which is very close to @xmath14 .",
    "the proof that @xmath557 is bounded by a constant goes as follows .",
    "we devise a procedure that generates a sequence of tessellations , starting from the tessellation @xmath560 , namely the single operator given in the statement of the claim .",
    "the sequence of operator sets is denoted @xmath561 , for @xmath562 , the first one being @xmath252 itself , where for each @xmath59 @xmath563 , and for all @xmath59 , @xmath564 .",
    "each @xmath565 includes at most @xmath0 additional operators from @xmath545 , compared with @xmath566 .",
    "we show that despite the growth in number of faces of the tessellation , the number of external edges can not cross a certain bound .    to this end , the choice of how to construct the tessellation @xmath567 from @xmath565 is of particular importance .",
    "suppose that given a tessellation one would construct the @xmath565 s by adding the operators corresponding to some arbitrary path in the dual graph , one by one .",
    "then the number of edges of @xmath557 will grow proportionally to the number of faces @xmath546 ; that would be a bad choice .",
    "our scheme thus relies on constructing the @xmath565 s in a _",
    "spiral _ fashion , by choosing a `` special '' external vertex of @xmath565 at each step , and then adding all operators acting on it to `` close '' an operator path on that vertex .",
    "we can show that such a process can continue for a large number of steps ( @xmath568 ) without failing , i.e. , a `` special vertex '' is well defined for @xmath569 , and thus the @xmath565 are strictly increasing , while @xmath557 can not increase beyond some constant value .",
    "we now proceed to the details .      as mentioned , we assume by contradiction that all vertices in the tessellation @xmath545 have degree at most @xmath33 .",
    "consider an external vertex @xmath248 in @xmath545 .",
    "we denote by @xmath570 the vertex located @xmath1 vertices away from @xmath248 on the path that traverses the external vertices of @xmath545 in a counterclockwise direction .",
    "the procedure `` tessellate '' is given as input @xmath545 and an operator in @xmath545 , @xmath252 and returns a sequence of tessellations @xmath565 is as follows .",
    "* tessellate(t , w ) *    1 .   init ( @xmath571 ) : set @xmath572 to be @xmath252 .",
    "2 .   ( @xmath573 )",
    "choose arbitrarily an external vertex @xmath574 of @xmath572 ( all vertices are external at this point ) and close an operator path on it , by adding to @xmath572 the necessary operators from @xmath545 that close the operator path on @xmath574 . denote the new set of operators as @xmath575 .",
    "3 .   for @xmath576 ,",
    "set @xmath577 as the vertex @xmath578 that is external in @xmath565 with minimal @xmath1 , i.e. the closest left neighbor of @xmath579 in the external path of @xmath566 , which remained external following the closing of the operator path on @xmath579 . if all external vertices of @xmath566 were closed following the appending of operators during the creation of @xmath565 , then set an arbitrary external vertex in @xmath565 as @xmath577 .",
    "then close an operator path on @xmath577 , again , by adding to @xmath565 the operators from @xmath545 that close an operator path on @xmath577 ( namely , all operators @xmath580 . denote the resulting set as @xmath567 , and so on .",
    "we claim    [ fact : tes1 ] given @xmath545 and @xmath252 , the steps of the procedure `` tessellate '' above are well defined for all @xmath581 $ ] , and the procedure generates strictly increasing tessellations @xmath582 .    we show that at each step @xmath59 for @xmath581 $ ] there exists a closed operator path in @xmath545 on the vertex selected as @xmath577 : by our assumption , all vertices have degree at most @xmath33 .",
    "this means that each @xmath565 contains at most @xmath0 more operators than @xmath566 , and so @xmath565 contains at most @xmath583 operators .",
    "this means that the furthest operator in @xmath565 from @xmath252 ( where distance is measured in number of edges in the dual graph ) is within distance @xmath584 .",
    "therefore , for @xmath585 , all operators are within distance at most @xmath586 from @xmath252 , and thus are all `` op '' operators by assumption , and also are not adjacent to `` noop '' faces .",
    "thus , for any vertex @xmath248 in @xmath565 , for @xmath587 $ ] , the operators @xmath588 form a closed operator path on @xmath248 .",
    "we would now like to show the important property for which the procedure was created .",
    "denote by @xmath589 the number of external edges of @xmath565 , and by @xmath590    [ cl : tes2 ] @xmath591 .",
    "we begin by showing the following properties :    1 .",
    "if @xmath592 , then there exists some @xmath1 such that @xmath593 is external in @xmath567 . + we want to show that if @xmath592 , then closing an operator path on any external vertex of @xmath565 can not close simultaneously an operator path on all other external vertices of @xmath565 .",
    "take some external vertex @xmath26 , and close an operator path on it by appending to @xmath565 at most @xmath0 additional operators from @xmath545 .",
    "each of these operators examines , in addition to @xmath26 , two additional qutrits so at most @xmath355 external qutrits of @xmath565 , aside from @xmath26 , are examined by these operators . therefore ,",
    "closing the operator path on @xmath26 in @xmath565 can close additional operator paths on at most @xmath355 other external qutrits of @xmath565 .",
    "thus , if @xmath594 , then since @xmath589 is equal to the number of external qutrits , there will always be an external vertex of @xmath565 that remains without a closed operator path following the closing of the operator path on @xmath26 .",
    "for each @xmath581 $ ] if @xmath592 then closing the operator path on @xmath577 increases the number of operators acting on @xmath595 by at least @xmath4 : + denote by @xmath596 the path traversing the external vertices of of @xmath565 counterclockwise , starting from @xmath577 .",
    "since @xmath592 , then by item ( @xmath4 ) , @xmath595 is selected by `` tessellate(t , w ) '' as @xmath597 for some @xmath1 . then for all @xmath598 the vertex @xmath599 is an internal qutrit in @xmath567 - i.e. a vertex such that closing the operator path on @xmath577 has also closed its operator path .",
    "specifically , for @xmath600 the operator path on @xmath599 was closed at step @xmath59 . yet ,",
    "prior to closing , @xmath601,@xmath602 are two external neighboring qutrits in @xmath565 , so they share an edge which is part of the external face in @xmath565 , and which must be part of a newly - added operator on @xmath601 .",
    "thus , closing the operator path on @xmath601 must entail adding at least one operator which acts on both @xmath601 and @xmath602 .",
    "thus the operator count on @xmath597 increases by at least @xmath4 at the end of step @xmath59 .",
    "3 .   for each",
    "@xmath603 $ ] if @xmath592 , then the number of operators in @xmath567 acting on the selected vertex @xmath595 , before closing its operator path , is at least @xmath14 : + we close the operator paths on the @xmath14 qudits of the input @xmath252 after at most @xmath14 steps . after that ,",
    "all @xmath577 s , are ones which are added during previous `` closure '' processes .",
    "when a new vertex is added to @xmath565 , it is added as part of a closed path ; hence , when such a @xmath577 was added , it was added together with two operators acting on it . by item ( @xmath16 ) ,",
    "when @xmath592 closing the operator path on @xmath577 increases number of operators acting on @xmath595 by at least @xmath4 .",
    "hence , when @xmath595 is chosen at step @xmath604 , prior to closing its operator path , it is acted upon by at least @xmath14 hamiltonians .",
    "now we are ready to show that @xmath605 .",
    "we will first show that for all steps @xmath59 for which @xmath606 and @xmath607 we have @xmath608 .",
    "recall that we assume that the degree of each vertex in @xmath545 is at most @xmath33 , hence , since the graph is planar , there can be at most @xmath33 operators acting on each vertex . by item ( @xmath14 ) above , before closing the path on @xmath577 for @xmath606 and @xmath607 there were at least @xmath14 operators acting on @xmath577 ; hence , the closing could have added either one or two operators that act on @xmath577 .",
    "let us see how each of the cases affects @xmath589 :    1 .",
    "add one face / operator to act on @xmath577 to close the path on @xmath577 : in this case , in order to close an operator path we must connect existing vertices , and not add any new ones .",
    "therefore , @xmath589 `` looses '' two edges which are replaced by @xmath4 , and decreases overall by @xmath4 .",
    "2 .   add two faces / operators to act on @xmath577 to close the path on @xmath577 : in this case @xmath589 gains at most @xmath16 new edges in exchange for at least @xmath16 previous edges so it does not increase .",
    "thus we have @xmath259 for all steps @xmath59 for which @xmath606 and @xmath607 we have @xmath608 . on the other hand , at each step @xmath59 the value of @xmath589 can increase by at most @xmath16 : exactly two edges are removed from the external path , and at most @xmath0 are added ; the latter case occurs if @xmath0 operators are added together with @xmath16 new vertices .",
    "we now claim that for all @xmath59 , @xmath609 . we know that @xmath610 , and at each one of the first @xmath0 steps , closing the operator path on each qutrit can increase @xmath557 by at most @xmath16 . hence , @xmath611 for @xmath612 .",
    "now , assume by contradiction that @xmath613 for some index @xmath614 .",
    "wlog let @xmath615 be the first such index for which @xmath557 is strictly larger than @xmath559",
    ". then @xmath616 must be either @xmath559 or @xmath372 ; this means that one step before that , @xmath617 must have been @xmath618 , and notice that @xmath619 .",
    "this means that we have an index we have an index @xmath620 , such that @xmath621 and @xmath622 , in contradiction to @xmath259 .",
    "we can now prove claim [ cl : outerbound ] :    consider the tessellation @xmath623 generated by the algorithm tessellate .",
    "it is comprised of at least @xmath624 faces since each step increases the number of operators by at least one , and so @xmath625 . we also have that since @xmath626 and @xmath627 , then @xmath628 , and so @xmath629 . plugging this into equation [ eq : qutrit1 ] we have",
    "that @xmath630 and since @xmath605 , we have @xmath631 by equation [ eq : ahat ] .",
    "this implies that @xmath632 , which means there must be a vertex of degree @xmath633 .",
    "we can now deduce that the interaction graph of a planar @xmath167 instance , with no separable qudits , which is a graph whose vertices are all of degree smaller than @xmath34 , must have constant `` density '' of `` holes '' in it , namely , `` noop '' faces .",
    "[ thm : reghole ] consider the interaction graph @xmath56 of a planar instance @xmath53 of @xmath167 with no separable qudits .",
    "then for any operator @xmath553 there exists a `` noop '' face within distance ( in the dual graph ) at most @xmath555 .",
    "we assume on the negative that there exists a vertex @xmath252 with no `` noop '' faces within distance @xmath555 from @xmath252 .",
    "this means that any face @xmath634 whose distance from face @xmath252 is at most @xmath555 is an `` op '' face .",
    "consider the set of all operators of distance at most @xmath555 to @xmath252 .",
    "this set has no gaps ( otherwise there would be a `` noop '' face of distance less than @xmath555 to @xmath252 , and so it is a tessellation , which we can denote @xmath545 .",
    "the conditions of claim ( [ cl : outerbound ] ) now hold ; therefore there exists a vertex @xmath248 in @xmath545 whose degree is at least @xmath34 contrary to the fact that @xmath53 has no separable qudits .",
    "we thus have a constant density of `` noop '' faces . here",
    "( and only here ) we use the fact that the planar embedding is ne , and devise an np protocol to reduce the @xmath167 instance into a @xmath150 instance for constant @xmath12 .",
    "this is formalized in the following claim :    [ cl : cutting ] for an instance @xmath53 of ne planar @xmath167 with no separable qudits , there exists additional classical input from merlin that allows to reduce @xmath53 into an instance of @xmath150 for constant @xmath12 .",
    "we now shift our attention to the ne planar triangulation of a convex polygon , which contains the interaction graph of @xmath56 as a subgraph .",
    "the existence of such a triangulation is guaranteed by the definition of ne planarity ( definition [ def : nedef ] ) .",
    "the triangles in this triangulation are also associated with `` noop '' or `` op '' faces , which inherent their nature ( `` noop '' or `` op '' ) from the faces they are contained in , in the original embedding of the graph @xmath635 in the plane . from now on , we refer to this triangulation @xmath545 as our graph .",
    "we note that the density of `` noop '' faces in this graph ( namely , claim [ thm : reghole ] ) is still as before , since only `` noop '' faces were partitioned to triangles - `` op '' faces were already triangles .",
    "the basic idea is to partition the polygon to constant size sections , using `` cuts '' along paths in the dual graph , which are non - intersecting , except at `` noop '' faces .",
    "the reader can convince herself that if this can be done , this will ensure that the interactions between the different sets of vertices corresponding to the different sections are two - local , since each interaction term involves only particles from at most two different such areas .",
    "the difficulty in the proof is that due to the lack of regularity of the graph , it is non - trivial to construct explicitly such a net of paths between `` noop '' faces . here is where we use the fact that ne planar triangulations of polygons obey nice characteristics , which resemble those of a periodic lattice .",
    "the ne requirements imply that the noop faces are scattered in a more of less periodic fashion in terms of euclidean distance between the noops .",
    "we note that no periodicity is assumed here regarding @xmath545 , and the ne restriction is significantly more general , and cover , essentially , all `` reasonable '' physical scenarios .",
    "the overall idea is to lay down on the plane a `` brick - wall '' , ( namely , a square lattice in which the even rows are shifted by a half - square w.r.t . the odd rows - see figure [ fig : bwall ] ) , and find near each vertex of the brick wall a noop face , which we know exists due to claim ( [ cl : outerbound ] ) ; we essentially perturb the brick wall junctions so that the junctions fall inside those `` noop '' faces .",
    "a problem arises though from the fact that even if all the junctions of the partition are located at noop faces , locally there may still be qudit triplets that manage to interact across @xmath14 subdivisions , without intersecting the `` noop '' itself ; this can happen since the sizes of the edges are not all the same .",
    "we thus employ a trick - we in fact find two noops close to each vertex of the brick wall , rather than one .",
    "the two noops are required to be not too close to each other .",
    "we use the area between the two noops to create what we call a `` noop zone '' .",
    "the advantage is that this noop - zone is larger in diameter than any edge in the graph , and so it prevents the local problems mentioned before ; more explicitly , no `` op '' face can cross and connect all three bricks adjacent to this junction .    to create the noop - zone",
    ", we consider a path connecting the two noops , and _ contract _ all edges along a path between the two noops , until the two noops intersect in a vertex , which is now larger in dimension but still a constant .",
    "this enables us to apply lemma [ lem : bv ] and decompose the new ( constant size ) vertex to two , using input from merlin . separating these two vertices to two , we create a `` bridge '' between the two noop faces",
    "; this causes the two noops to merge into a larger noop face , which is the `` noop - zone '' .",
    "the junction of the brick wall is moved to a location inside this noop - zone .",
    "the proof is somewhat technical , but the above `` noop - zone '' idea is the only non - trivial idea used in it .",
    "we will now proceed to the details .",
    "let us denote by @xmath636 the sizes of the maximal length and minimal length edges in the planar triangulation .",
    "let us denote by @xmath637 the minimal angle between any two adjacent edges in this embedding . by our assumptions ,",
    "both the ratio between @xmath636 and the value of @xmath637 are constants bounded away from @xmath9 . for a ne clh(3,3 )",
    "instance @xmath53 , set    @xmath638    where @xmath555 is the constant from claim ( [ cl : outerbound ] ) , i.e. , the bound on the distance from any op face to a noop face ( distance is measured in terms of number of edges in the dual graph ) .",
    "we note that @xmath639 upper bounds the _ euclidean _ distance between any face and the closest `` noop '' face to it , since edges in the dual graph ( except those connecting the infinite face ) are of length at most @xmath640 . here",
    ", we define the distance between two faces as the minimal distance of any pair of points contained in each of them .",
    "[ cl : constdense ] given is @xmath545 , a ne planar triangulation of a polygon . consider a rectangle @xmath641 in the plane .",
    "then the number of vertices of @xmath545 that lie inside the rectangle @xmath641 is at most a constant times the area of the rectangle , where the constant depends on @xmath642 and @xmath637 .",
    "let @xmath26 be some vertex of @xmath545 .",
    "let @xmath643 be the polygon induced by the union of faces on @xmath26 , and @xmath644 be the intersection of half - planes generated by the edges of @xmath643 .",
    "let @xmath645 be the largest disk , centered around @xmath26 that is contained in @xmath644 . since @xmath645 then @xmath646 contains a single vertex - @xmath26 at its center :",
    "on the negative , if @xmath646 contains another vertex @xmath364 then it also intersects an edge @xmath647 of some face @xmath648 , and so it intersects both half - planes of the line @xmath649 , contrary to definition .    also , by definition , there exists some edge @xmath650 in a face containing @xmath26 , such that @xmath650 is opposite to @xmath26 , and @xmath646 is tangent to the line containing @xmath650 .",
    "thus the radius of @xmath646 over all @xmath26 is at least @xmath651 where @xmath652 .",
    "since every vertex contained in @xmath641 must have at least @xmath653-th of @xmath646 contained in @xmath641 , then the number of vertices in @xmath641 is constant .",
    "[ cl : pathrect ] let @xmath67 and @xmath49 be two faces in a ne triangulation @xmath444 , which are at least @xmath654 distance apart .",
    "then there exist two vertices , @xmath655 , such that the following holds .",
    "first , there exists a straight line @xmath656 crossing both @xmath67 and @xmath49 , such that @xmath657 are the two vertices whose projections on @xmath656 are the closest among all pairs of points in @xmath67 and @xmath49 .",
    "denote the distance between the projections of those two points by @xmath658 .",
    "there exists a path in @xmath443 between @xmath299 , denoted by @xmath659 , which is fully contained in a rectangle @xmath660 of area @xmath661 , where @xmath662,@xmath663 , and this rectangle contains no other vertex of @xmath67 or @xmath49 .",
    "moreover , the number of vertices in the path is a bounded function of @xmath664 and the ne parameters @xmath665 .",
    "consider a line which crosses both faces @xmath666 .",
    "consider the projections of the vertices of those faces on this line . if there is more than one pair which is the closest , then perturb @xmath656 until @xmath299 are unique and all other projections are further away .",
    "now , define the rectangle @xmath660 to be the rectangle two of whose edges are parallel to @xmath656 , and are of length which is the same as the distance between the projection of @xmath299 on the line ( see figure [ fig : rect ] ) ;    the other two edges of @xmath660 are perpendicular , and are taken to be @xmath667 as defined in the claim . by construction , @xmath660 contains no other vertices of @xmath67 or @xmath49 .",
    "we now construct the path .",
    "wlog , let us assume that @xmath656 is parallel to the @xmath668 axis for ease of presentation .",
    "starting from vertex @xmath7 we find a neighboring vertex to @xmath7 whose @xmath668 coordinate is at least @xmath669 .",
    "we proceed this way until we reach the first vertex @xmath670 whose @xmath668 coordinate is larger than @xmath640",
    ". this will be the first segment of the path ; denote it by @xmath671 .",
    "we claim that this path @xmath671 is fully contained in the rectangle @xmath660 ; this is because the path contains at most @xmath672 vertices , and so in terms of the @xmath673-axis , we are still within the @xmath640 distance from the edge of the rectangle ; in terms of the @xmath668 axis , the largest @xmath668 coordinate is smaller than @xmath674 by construction .",
    "notice that the final point of @xmath671 is more than @xmath640 away from the boundary of the rectangle .",
    "we generate in a similar way a path from @xmath8 , @xmath675 , that is contained in @xmath660 to a vertex @xmath676 with a @xmath668 coordinate at most that of @xmath8 minus @xmath640 .",
    "we notice that if we connect @xmath670 and @xmath676 by a straight line @xmath677 , the line @xmath677 are not only contained inside @xmath660 but every point of it is also at least @xmath640 from the boundary of the rectangle .",
    "we now finish the construction of the path by connecting @xmath678 by a path inside the rectangle , as follows .",
    "consider all faces crossed by this line .",
    "find a simple path @xmath679 between @xmath670 and @xmath676 that uses only edges of these faces - there exists such a path @xmath680 because the graph @xmath444 restricted to the faces crossed by @xmath677 is a connected graph .",
    "also , by @xmath681 restrictions , the path @xmath680 can not visit vertices whose euclidean distance from @xmath677 is more than @xmath640 . hence @xmath680 is contained in @xmath660 .",
    "connecting the paths @xmath682 and removing edges as necessary to derive a simple path , we arrive at the desired simple path @xmath659 .",
    "since by claim ( [ cl : constdense ] ) , @xmath660 contains at most a number of vertices proportional to its area , the length of @xmath659 is a bounded function of @xmath658 and the ne parameters .",
    "we are now ready for the proof of the claim .",
    "( of claim [ cl : cutting ] )    [ [ defining - the - grid ] ] defining the grid + + + + + + + + + + + + + + + + +    we are given an instance @xmath53 of ne @xmath167 with an interaction graph @xmath56 .",
    "let @xmath444 denote the ne triangulation of the convex polygon of which @xmath56 is a subgraph : @xmath445 .",
    "let @xmath683 where @xmath667 is the constant from claim ( [ cl : pathrect ] ) .",
    "let us lay down on the plane a brick - wall @xmath684 with block - size of constant length @xmath685",
    ". with small perturbations ( shifting and rotating ) we can make sure that no edge is parallel to the edges of the planar embedding of @xmath444 , and no vertex of the brick wall lands on an edge or vertex of @xmath443 in this embedding . by claim ( [ cl : constdense ] ) we know that each cell contains a constant number of vertices of @xmath444 , and thus of @xmath56 .",
    "we note that interactions that connect vertices from different cells are obviously two - local ( in terms of number of cells participating in one such interaction ) as long as they are far away from the junctions of the brick - wall .",
    "unfortunately , we can still have three - local interactions among those close to the brick - wall junctions .",
    "we thus make small modifications of the interaction graph close to every brick - wall junction ; we will make sure that those modifications are confined to small disks around those junctions , which do not intersect each other . from now on we focus our attention on one such junction , and explain how to modify the interactions close to it to eliminate the 3-local interactions .",
    "[ [ creating - a - noop - zone - near - a - brick - wall - junction ] ] creating a `` noop - zone '' near a brick - wall junction + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    for each face @xmath686 that contains the @xmath59-th junction of @xmath684 , the point @xmath687 , let us denote by @xmath688 the closest noop operator to the junction .",
    "given @xmath689 , choose a noop @xmath690 within euclidean distance @xmath691 $ ] to it ( euclidean distance between faces is the minimum such distance between any two points in those faces ) .",
    "@xmath692 exists since we can consider a face whose euclidean distance to @xmath689 is @xmath693 $ ] , ( if no such face exists , the problem is of constant size anyway ) and apply claim ( [ cl : outerbound ] ) to find a noop close to this face within euclidean distance @xmath639 . since the distance between @xmath689 and @xmath692 is at least @xmath694 , claim ( [ cl : pathrect ] ) holds , and we can find @xmath695 , and @xmath660 be a rectangle containing a path @xmath659 , as is guaranteed by the claim .",
    "consider the half - infinite line starting from @xmath7 , and going to infinity in a direction normal to the edge of the rectangle containing @xmath7 .",
    "consider also the half - infinite line starting from @xmath8 and going to infinity in the parallel direction , normal to the edge of the rectangle containing @xmath8 .",
    "these half - infinite lines , augmented with the path @xmath659 , partition the plane to two infinite regions , one on each side of @xmath659 ; we call the sides arbitrarily `` left '' and `` right '' ( these names may be completely unrelated to true `` left '' and `` right '' . ) denote @xmath696 as the set of faces containing at least one vertex of @xmath659 , possibly vertices on the left of @xmath659 , but no vertex to its right .",
    "denote @xmath697 to be the set of all other faces containing vertices of @xmath659 ( by definition , those triangles contain at least one vertex to the right of @xmath659 ) .",
    "by the planarity of @xmath444 we have that @xmath698 can not contain any `` left '' vertex : a face @xmath699 supported on both sides of the divide must have an edge that crosses at least one edge of the path @xmath659 or one of the edges of @xmath689 or @xmath692 .",
    "thus any two operators , one from @xmath697 and one from @xmath696 can only share vertices of @xmath659 .",
    "we would now like to modify the interaction graph , and `` merge '' all vertices along the path @xmath659 to one vertex , whose hilbert space is the tensor product of all those particles , creating a large though constant dimensional new particle , such that @xmath696 and @xmath697 intersects only through this single particle .",
    "this is done as follows .",
    "first , we erase all nodes on @xmath659 except @xmath7 .",
    "a new large particle , of the dimensionality which is the tensor of all particles in @xmath659 , is embedded where previously @xmath7 was embedded on the plane . for any vertex @xmath248 that was merged into @xmath7 , and @xmath700 a vertex that was previously connected to @xmath248 by an edge , replace the original edge @xmath701 by a straight edge connecting @xmath700 to @xmath7 .",
    "also , replace each of the interactions that contained a particle on the path , by the corresponding interaction on the appropriate subparticle in the new merged particle @xmath7 .",
    "the remaining particles in that interaction are not changed .",
    "we note that due to the change of geometry , some edges may now cross others , but this non - planarity is confined only to an area close to the path , and as we shall see , will not matter to our argument .    the partition of the operators on the vertices of @xmath659 into the sets @xmath696 and @xmath697 now induces a partition of all the operators on @xmath7 , which only intersect on @xmath7 .",
    "hence , the operators on the merged qudit @xmath7 can be separated , following claim ( [ cl : algdec ] ) , into two qudits , @xmath702 and @xmath703 , using an isometry sent by merlin .",
    "note that this isometry acts on a constant dimensional particle @xmath7 , since the length of @xmath659 is constant following claim ( [ cl : pathrect ] ) .",
    "we embed @xmath702 and @xmath703 at some tiny nonzero distance , each to one side of the previous location of @xmath7 , and slightly modify all edges connected to @xmath7 to fit this small perturbation , keeping them straight for simplicity .",
    "we have arrived at an equivalent instance , except now the two noop faces @xmath689 and @xmath704 are connected into one region ; we denote the unified noop face as @xmath705 and call it the `` noop - zone '' .",
    "we note that if initially , either the left or the right side ( or both ) of the operators on @xmath7 contains no operator - then we can trivially unite @xmath689 and @xmath704 into @xmath705 , by removing edges of @xmath444 , and no merging of particles is required .",
    "let @xmath706 be the middle point on the face not containing @xmath7 of @xmath689 , and @xmath707 the same for @xmath704 respectively .",
    "since we have chosen the distance between @xmath689 and @xmath692 to be at least @xmath639 , and since the edges that contain @xmath706 and @xmath707 are not changed during the merging process , then latexmath:[\\[\\label{eq : abmax }    connecting @xmath706 and @xmath707 .",
    "we explain now that the graph has not changed except for in a constant size disk around the noops .",
    "let @xmath709 denote a disk around a point @xmath66 with radius @xmath32 .",
    "since for all @xmath59 @xmath689 is within distance @xmath639 from @xmath710 by ( [ cl : outerbound ] ) , and since by claim ( [ cl : pathrect ] ) the merging described above of the vertices on the path between @xmath689 and @xmath692 , affect edges which are confined to a radius @xmath711 around @xmath689 , then all edges changed by this merging are contained within @xmath712 for all @xmath59 , so they are decoupled from each other and the disks do not intersect .",
    "[ [ rerouting - the - grid - to - prevent-3-locality ] ] rerouting the grid to prevent @xmath14-locality + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    let us reroute the junction so that the `` horizontal '' line of the @xmath545 junction when restricted to @xmath712 is tilted to the straight line going through @xmath707 that is perpendicular to @xmath713 .",
    "the `` vertical '' line of @xmath545 is tilted so that when restricted to @xmath712 it is the line starting from @xmath707 , going to a point in the middle of the short line connecting @xmath702 and @xmath703 , and then connecting to @xmath706 by a straight line , from which we continue upwards in the same direction as @xmath713 , as in figure [ fig : reroute ] . outside of the disk",
    ", these lines are connected directly to the edges of the brick - wall .",
    "this can be easily achieved using the detours as in figure [ fig : reroute ] .",
    "once again , we make sure using small rotations and shifts of the lines that none of these lines pass through any vertex .",
    "finally , we show that no local term can act on three - bricks : let @xmath714 be an operator in @xmath696 , then it does not act on the brick to the right of the partition line between @xmath706 and @xmath707 .",
    "hence it is at most @xmath16-local .",
    "a similar claim holds for any operator in @xmath697 .",
    "any other operator has edges of length at most @xmath715 that can not cross @xmath705 , since it was not modified by the merging process . since we have that @xmath716 by equation [ eq : abmax ] , no such operator can act on the three bricks .",
    "let us now describe more formally the implications of our results to topological order .",
    "we define a topological order system as follows :    * topological order *    a quantum state @xmath717 is said to exhibit topological order w.r.t . a lattice @xmath235 , ( with one particle on each of its edges ) if there exists another state @xmath718 orthogonal to @xmath717 with the following properties , for any locally confined observable @xmath714 on @xmath235 :    1 .",
    "@xmath719 2 .",
    "@xmath720    in this paper , we will say that a quantum system exhibits to if all states in its groundspace do .",
    "note that this definition can also be extended to ne graphs - since the notion of locality makes sense in those cases too .",
    "it is shown in @xcite that topological order states can not be generated by small depth nearest neighbor circuits :    [ thm : bhv ] let @xmath721 be a quantum circuit which is a product of local unitaries @xmath722 that generates a @xmath723 state @xmath724 from the all - zero state , i.e. @xmath725 on a @xmath726 lattice @xmath235 of @xmath3 qubits . then @xmath727 .    in order to conclude that there exist ne commuting hamiltonians with @xmath728 for which no constant - depth diagonalizing circuit exists , we recall the toric code due to kitaev @xcite .",
    "the toric code is comprised of a finite square @xmath16-dimensional lattice of qubits ( edges ) , such that the top and bottom rows are identified as one , and so are the left and right columns .",
    "the system is stabilized by two types of @xmath0-local operators , one which acts on a `` plaquette '' of @xmath0 edges of the unit square of the grid ( denoted as the set @xmath277 ) , and one which acts on a `` vertex '' of @xmath0 edges at each crossing at the grid ( denote as the set @xmath58 ) .",
    "the `` vertex '' operators are @xmath729 and the `` plaquette '' operators are @xmath730 .",
    "the complete hamiltonian is given by @xmath731 let us now consider grouping together the qubits of the toric code lattice , by grouping together the two top - right qubits ( edges ) of every `` plaquette '' .",
    "it can be easily seen that , up to a global energy - level shift , we arrive at an instance of @xmath20 .",
    "thus , the toric code is a special case of @xmath20 .",
    "since all states in the toric code groundspace are of topological order ( @xcite ) no state in the code can be generated by any constant - depth circuit ; hence , in this case there can not be a constant - depth nearest - neighbor quantum circuit which diagonalizes the toric code hamiltonian , and our conclusion follows .",
    "this conclusion settles an intriguing gap regarding commuting hamiltonian systems on lattices ( more generally , on ne graphs ) . on the one hand for @xmath52 with @xmath732 and @xmath728 , or @xmath21 no constant - depth diagonalization exists , and topological order is possible , whereas for @xmath52 with @xmath733 for all @xmath12 , or @xmath23 and @xmath25 constant - depth diagonalization exists , so topological order is impossible .",
    "thus , the toric code construction is optimal in terms of commuting hamiltonian dimensionality and size of interactions .",
    "this implies theorem [ thm : to ] .",
    "a clarifying remark is in place .",
    "theorems [ mainclaim ] and [ mainclaim2 ] hold for planar instances , whereas the toric codes we have just mentioned are defined on a torus .",
    "how can we compare the two ?",
    "we recall that the toric codes can actually be generalized to a lattice with a boundary embedded on the plane , as was shown by bravyi and kitaev @xcite , and so this proves the tight boundary provided by theorem [ thm : to ] between to and local entanglement , for ne _ planar _ instances .",
    "in fact , theorems [ mainclaim ] and [ mainclaim2 ] can be extended to handle higher genus surfaces , as long as the graphs are `` locally ne planar '' , i.e. , large disks around any vertex are ne planar . from the other side , the proof of theorem [ thm : bhv ] holds for such instances too , since locally ne",
    "planar embeddings support the lieb - robinson bound used in the proof of theorem [ thm : bhv ] ) . hence our implications regarding the tight conditions on to hold for higher genus surfaces too ; we will not provide here the details of this generalization .",
    "we would like to thank sergey bravyi for several important contributions to this paper .",
    "first , for pointing us to that our early results on the complexity of the commuting hamiltonian problem , may have interesting implications on the conditions for the existence of topological order .",
    "second , for showing us the beautiful argument that any circuit generating the toric code groundstate is of non - constant depth , and finally for pointing to us to a mistake in an early draft of this paper .",
    "we also thank zeph landau for useful remarks on an early draft of this paper ."
  ],
  "abstract_text": [
    "<S> the local hamiltonian problem plays the equivalent role of sat in quantum complexity theory . understanding the complexity of the intermediate case in which the constraints are quantum but all local terms in the hamiltonian commute , is of importance for conceptual , physical and computational complexity reasons . </S>",
    "<S> bravyi and vyalyi showed in 2003 @xcite , using clever applications of the representation theory of c*-algebras , that if the terms in the hamiltonian are all two - local , the problem is in np , and the entanglement in the ground states is local . </S>",
    "<S> the general case remained open since then . in this paper </S>",
    "<S> we extend the results of bravyi and vyalyi beyond the two - local case , to the case of three - qubit interactions . </S>",
    "<S> we then extend our results even further , and show that np verification is possible for three - wise interaction between qutrits as well , as long as the interaction graph is embedded on a planar lattice , or more generally , `` nearly euclidean '' ( ne ) . </S>",
    "<S> the proofs imply that in all such systems , the entanglement in the ground states is local . </S>",
    "<S> these extensions imply an intriguing sharp transition phenomenon in commuting hamiltonian systems : 3-local ne systems based on qubits and qutrits can not be used to construct topological order , as their entanglement is local , whereas for higher dimensional qudits , or for interactions of at least @xmath0 qudits , topological order is already possible , via kitaev s toric code construction . </S>",
    "<S> we thus conclude that kitaev s toric code construction is optimal for deriving topological order based on commuting hamiltonians . </S>"
  ]
}