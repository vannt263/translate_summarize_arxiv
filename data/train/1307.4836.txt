{
  "article_text": [
    "helioseismology is the only one method used in solar physics , which allows us to study details of what is going on below the optically thick photosphere .",
    "inverse modelling in local helioseismology became a standard method of solar research in the past few decades .",
    "inversions for local helioseismology were notably successful in investigating the properties of plasma flows in the solar convection zone . despite the effort",
    ", some open questions with regards to convective flows remain .",
    "what is the depth structure and nature of supergranules ?",
    "what are the properties of deep solar convection ?",
    "the reliable knowledge of plasma behavior in the sun is particularly important for solar dynamo , a process which forms all phenomena of solar activity .",
    "the plasma flows in the upper solar convection zone seem to have multi - scale character ( see review by * ? ? ?",
    "two distinct scales however exist : granulation ( reviewed by * ? ? ?",
    "* ) and supergranulation ( reviewed by * ? ? ?",
    "while the granulation is considered well understood in terms of underlying physics , the supergranulation is not",
    ". the surface velocity spectrum @xcite does not indicate presence of distinct either smaller ( termed mesogranules ) or larger ( termed giant cells ) convection modes .",
    "at least the giant cells are , however , a common feature seen in some global models of solar convection zone ( e.g. * ? ? ?",
    "recently , the fundamental problem in understanding the solar convection emerged : the upper limit set by helioseismology on amplitude of convective velocities in the deep solar convection zone @xcite is two orders smaller than what is predicted from global convection simulations .",
    "even lower limits set by dynamical balance to maintain the observed properties of mean plasma flows @xcite do not reconcile with the measurements from helioseismology .",
    "it is believed that only helioseismology may resolve this `` convection crisis '' and this motivates my research .    from all the methods of helioseismology",
    "i focus on time  distance helioseismology @xcite , a method used to to measure and interpret changes in travel times of seismic waves caused by inhomogeneities in the structure of the sun , among which plasma flows play an important role . in recent years ,",
    "time  distance helioseismology has been used to invert for near - surface flows ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) , for flows beneath sunspots ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) , flows in their vicinity @xcite , and many others .",
    "some delicate problems emerged over time .",
    "for instance , some authors question a possibility to measure the deep plasma flows on supergranular scales with the signal - to - noise ratio larger than one .",
    "although there are results published that `` image '' the plasma flows on supergranular scales at depths of 64  mm or so ( e.g. * ? ? ?",
    "* ) , some more recent studies suggest that the noise dominates the signal already at depths of 46  mm ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "the argument that there is a cellular pattern clearly visible in the flow maps from large depths is problematic at least .",
    "the danger of `` seeing '' cells in the flow map and connecting them to the convection was shown by @xcite , who demonstrated that mesogranules have statistical properties of the averaged noise , thus do not necessarily physically exist . to avoid these issues , it is imperative to use helioseismic methods , which provide ( 1 ) the tomographic image of the flows , ( 2 ) all the details of the averaging kernel , describing the localisation in the sun , and ( 3 ) the level of random noise in the results .",
    "the code i have at my disposal fulfills all these requirements .",
    "the time  distance inversion pipeline consists of many consecutive steps .",
    "the first one typically is a filtering of a time series of observations ( most often the series of dopplergrams ) to retain only particular modes of oscillations .",
    "the filtering is usually executed by means of spatio - temporal filter applied in the fourier space .    in practice ,",
    "the observations form a datacube @xmath3 , where @xmath4 is a horizontal position vector and @xmath5 time . for convenience , this datacube is fourier transformed to become @xmath6 , where @xmath7 is a horizontal wave vector and @xmath1 frequency . then",
    ", the fourier data series is multiplied by the filter @xmath8 in order to obtain the new filtered datacube @xmath9 : @xmath10 the filtered datacube is consequently analysed by time  distance techniques .    in time ",
    "distance helioseismology , two approaches are usually taken to construct the filter @xmath11 . the approach considered traditional is to retain only acoustic ( @xmath12 ) modes having the same phase speed @xmath13 .",
    "the _ phase - speed filtering _ was introduced by @xcite to deal with artifacts in dopplergram measurements by michelson doppler imager ( mdi ; * ? ? ?",
    "* ) prohibiting to measure the wave travel times for distances shorter than some 10  mm .",
    "physically , the waves with the same phase speed have ( under the approximation by the geometrical optics ) the same lower turning point , thus roughly travel the same path in the solar interior @xcite .",
    "the phase - speed filters can be computed analytically using the formula @xmath14,\\ ] ] where @xmath15 .",
    "the values of the central phase speed @xmath13 and of the width of the bandpass @xmath16 of eleven filters considered standard in helioseismology are given in table  [ tab : phs_filters ] .",
    "hereafter , these eleven standard phase - speed filters are denoted as td1 to td11 with increasing phase - speed value .",
    "a very different filtering scheme was recently applied in some time  distance studies ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* to name a few not co - authored by the author of this study ) .",
    "the technique of _ ridge filtering _ became common in geoseismology ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ) and employs filters separating the modes of oscillations having the same radial order .",
    "modes having the same radial order form a `` ridge '' in the power spectrum of oscillations .",
    "the ridge filters used in this study are constructed in accordance with the corresponding module of the kernel code ( written by aaron birch ) : for each wave number @xmath0 , the filter gains the following values : @xmath17 where @xmath18 is the peak frequency of the ridge to be retained at the given @xmath0 and @xmath19 and @xmath20 are peak frequencies of the adjacent ridges .",
    "the position of ridges can either be determined from studying the power spectra or from eigenfrequencies of the solar model . for the @xmath21 mode ,",
    "the filter is symmetrical in frequency about @xmath18 by defining @xmath22 . in this study ,",
    "i use surface gravity mode ( the @xmath23mode ) and first four acoustic ridges @xmath24 to @xmath25 .",
    "positions of all filters used in this study are over - plotted the power spectrum of dopplergrams measured by helioseismic and magnetic imager ( hmi ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) in fig .",
    "[ fig : ps_and_filters ] .",
    "additionally , all datacubes are filtered with the high - pass filter with cut - off frequency of 1.5  mhz to suppress the disturbing effects of surface convection .",
    "the wave travel times are measured from the temporal cross - covariance @xmath26 of the filtered signal @xmath27 at two points @xmath28 and @xmath29 at the solar surface , @xmath30 where @xmath31 is the length of observation .",
    "the formalism can be generalized and instead of the point - to - point cross - covariance , other measurement geometries can be introduced .",
    "traditionally , the center - to - annulus geometry is used in time ",
    "distance helioseismology , where the filtered signal at a single point @xmath29 is replaced by @xmath32 averaged over the annulus with radius @xmath33 around the central point @xmath28 .",
    "similarly , the center - to - quadrants geometry is an extension of a center - to - annulus geometry by weighting the surrounding annulus by e.g. cosine and sine of the azimuthal angle .",
    "note that while in the case of ridge filters the user has effectively free choice of annulus radius @xmath33 ( in this study i use the set of distances 7.3  mm to 29.2  mm with a step of 1.46  mm ) , the range of sensible distances in the case of phase - speed filters is set by the central phase speed and the selections of @xmath33 used in this study are given in table  [ tab : phs_filters ] .",
    "the particular combination of the choices in the data analysis ( fourier filter , annulus or quadrant , and the radius of the annulus ) are uniquely combined into an index @xmath34 .    for each geometry",
    "@xmath34 the travel time @xmath35 is measured at every position @xmath4 in the field - of - view as ( full details in * ? ? ?",
    "* ) @xmath36 , \\label{eq : ttdef}\\ ] ] where the weighted ( by weighting functions @xmath37 ) difference between the measured cross - covariance and the reference cross - covariance @xmath38 is integrated over the entire observation time @xmath31 . in this work",
    "i choose the reference cross - covariance to be the symmetric component of the spatial average of the quiet sun cross - covariances .",
    "the travel time @xmath39 has two branches for positive and negative time lags ( indicating the waves travelling from the point to the surrounding annulus or quadrant and the waves travelling from the annulus or quadrant to the central point ) . for the remainder of this study i focus on difference travel time , thus @xmath40    the difference travel times",
    "are particularly sensitive to plasma flows and can be thus used for their inversion .",
    "for simplicity , i focus this study to a small patch near the centre of the solar disc , thus only small error is caused @xcite by approximating the field of view in cartesian coordinate system @xmath41 , where @xmath4 is ( consistently with what was already said earlier ) the horizontal position vector and @xmath42 is the height .",
    "axis @xmath43 points in the solar east  west direction , axis @xmath44 is parallel to the axis of solar rotation .    in forward modelling , the velocity vector @xmath45 translates into travel - time deviations @xmath46 via travel - time sensitivity kernel @xmath47 assuming the linear relationship @xmath48 the sensitivity kernels are computed in born approximation @xcite and they are consistent with the travel - time measurements by employing exactly same @xmath0@xmath1 filters , both observations and sensitivity kernels are processed with the same pixel size , etc .",
    "a particular realisation of the random noise @xmath49 is not known , however its covariance matrix can be measured from the large set of travel - time maps ( for details see * ? ? ?",
    "* ) , which is the approach i took .",
    "the ultimate goal of inverse modelling is to retrieve @xmath45 from ( [ eq : traveltimesdef ] ) when knowing @xmath46 and @xmath50 .",
    "studies have shown that the exact solution is generally not possible and that the inverse problem becomes an optimization problem .",
    "one possible solution to the problem is achieved by means of a subtractive optimally localised averaging ( sola ; * ? ? ?",
    "* ) approach .",
    "it aims to construct a spatially bound averaging kernel by linearly combining the set of sensitivity kernels while keeping the error magnification under control .",
    "the procedure results in a set of inversion weights @xmath51 , which are used to linearly combine the travel - time maps in order to get the estimate for the flow component @xmath52 , where @xmath53 , using @xmath54 where @xmath55 .",
    "the estimate for the flow velocity component is then a combination of a true velocity component smoothed by an averaging kernel @xmath56 ( [ eq : inversion1 ] ) , a crosstalk from other components ( [ eq : inversion2 ] ) , and a random - noise component @xmath57 ( [ eq : inversion3 ] ) , root - mean - square value of which ( @xmath58 ) is to be bound .    in terms of the weights ,",
    "the component @xmath59 of the averaging kernel is expressed by @xmath60    sola algorithm searches for the weights that produce the averaging kernel close to a user - supplied _ target function _ @xmath61 and that are normalised .",
    "the target function is chosen to have a non - trivial component only in the direction of the inversion , thus @xmath62 where @xmath63 is kronecker @xmath64 .",
    "@xmath65 usually has a form of a 3-d gaussian .    to find a numerical solution to the problem ,",
    "a cost function can be constructed , minimising the norm @xmath66 , the level of random error in the resulting estimate and some other terms using free trade - off parameters .",
    "i do not provide the full solution in this paper and rather refer to already published papers containing all mathematical details @xcite .",
    "i would only like to make one final point on user s freedom of selection of target functions .",
    "it is the usual case that the user wants the inversion to result in the flow estimates that are not difficult to interpret .",
    "thus the signal - to - noise ratio in the results should be reasonably higher than unity and the averaging kernel should have as little side - lobes as possible .",
    "the feasibility of the inversion to find an acceptable solution is thus strongly limited by the consistency of the required target function and the set of sensitivity kernels used .",
    "this point concerns especially the depth dependence of the target functions .",
    "it is thus useful to construct horizontal averages of sensitivity kernels used to get a feeling of what might end up with useful results and what must inevitably fail .",
    "such horizontal averages of sensitivity kernels for each @xmath0@xmath1 filter used , averaged additionally over all geometries and distances within the filter and normalised so that the total spatial integral is unity , are displayed in fig .  [ fig:1dkernels ] .",
    "a curious reader may immediately see that , first , all ( ! ) kernels are highly sensitive at the surface , where also the flows are the largest .",
    "thus the travel - time maps measured using these filters have a dominant contribution from the surface layers and it is up to inversion to deconvolve the weak travel - time signal from deeper layers from such measurements . and second , even with the use of highest phase - speed filter ( td11 ) the user can not expect to obtain any meaningful flow inversion from depths deeper than 20  mm . a ray - theory - based estimate for depth of the lower turning point for this phase speed is around 23  mm @xcite . to be on the safe side ,",
    "i limit myself in this study to the depths shallower than 10  mm .",
    "each filtered mode of oscillations comprises a rather independent information about the travelling waves . in the end",
    ", i would like to combine advantages of both filtering approaches to learn about plasma motions in the near - surface layers of the solar convection zone .",
    "to my knowledge , both disjunctive filtering approaches were never combined in one inversion . as a first step , a consistency check must be made .",
    "this study analyses real observations of the sun .",
    "i used travel - time maps measured from full - disc dopplergrams observed by hmi in june 2011 .",
    "the dopplergrams were tracked and remapped to postel projection using standard data processing technique .",
    "only the disc - centre region ( 512@xmath67512 pixels ) was tracked always for 24 hours to conform with the approximation by the cartesian coordinate system with a pixel size of 1.46  mm .",
    "the tracking and mapping was done using the code drms_tracking ( schunker & burston , unpublished ) implemented within german science center for sdo at max - planck - institut fr sonnensystemforschung , katlenburg - lindau , germany . over the two months interval",
    "i restricted only to days with no activity in the field of view : this strong constraint allowed to keep only nine days for a further investigation .",
    "the sensitivity kernels at my disposal were computed for analysis of mdi full disc data , the predecessor of modern hmi .",
    "hmi is a better resolution instrument and thus the power spectra of oscillations of the two are not exactly the same , perhaps due to effect of the different spectral lines used to measure the doppler shifts .",
    "thus , in accordance with @xcite , the power spectrum of each tracked hmi dopplergram datacube is corrected to resemble the power spectrum of full - disc mdi observations .",
    "selected observations underwent consistent processing described in sections [ sect : processing_from ] to [ sect : processing_to ] .",
    "the inversion is performed using an implementation of the multichannel sola @xcite in matlab , in details described by @xcite . for the inversion , i selected a rather difficult test .",
    "the target depth was chosen almost randomly , 2.2  mm , with full - widths - at - half - maximum ( fwhm ) of the gaussian target function to be 2  mm in vertical direction and 15  mm in both horizontal directions .",
    "looking at fig .",
    "[ fig:1dkernels ] , none of the filtered modes peaks at the chosen depth , some of the modes peak around it .",
    "thus from the beginning , it is a difficult task for the inversion to produce meaningful results .",
    "two inversions for horizontal components of the flow with the above described target function were executed , one employing all ridge - filtered sensitivity kernels ( @xmath21 to @xmath25 , together utilising 240 independent measurement geometries @xmath34 ) and another one with all phase - speed - filtered sensitivity kernels ( td1 to td11 , together employing 165 independent measurement geometries @xmath34 ) .",
    "the targeted noise level in the inversion was 35  ms@xmath68 and less for travel times averaged over one day , other requirements put on the inversion were to have spatially confined weights @xmath51 and rather minimised crosstalk components of the averaging kernel ( @xmath59 for @xmath69 ) .",
    "nevertheless , both @xmath0@xmath1 filtering approaches should , in principle , provide us with similar estimates for horizontal flow velocities .",
    "that was confirmed when the inversions were validated by utilising the synthetic data using approach identical to @xcite . the results of inversions applied to real observations are displayed in figs .",
    "[ fig : test1][fig : test3 ] .",
    "the noise levels in the results are 19  ms@xmath68 in the case of inversion combining the ridge - filtered measurements and 33  ms@xmath68 in the second case .",
    "one should notice , e.g. on figs .",
    "[ fig : test1 ] and [ fig : test2 ] ( left panel ) , that the inversion averaging kernels are not free of side - lobes , which always makes the proper interpretation of the results difficult .    despite the side - lobes ,",
    "averaging kernels for both inversions scan similar depths ( although ridge - filtered inversion averages a little more signal from depth 36  mm than the phase - speed - filtered inversion ) , so one should expect the resulting horizontal flow to be highly correlated .",
    "it is also evident , especially from looking at fig .",
    "[ fig : test2 ] left , that one should expect the scaling of inverted flow magnitudes .",
    "the phase - speed - filtered inversion depicts an increased sensitivity towards depths 01  mm and 1.53  mm compared to the ridge - filtered inversion .",
    "this increased sensitivity at the near - surface depths is compensated by a large negative side - lobe at depths 510  mm , so that both averaging kernels are normalised by an explicit constraint incorporated into the inversion : @xmath70 . assuming that the amplitude of the convection speed decreases sharply with depth , as numerical simulations ( e.g. * ? ? ?",
    "* ) suggest , the deep negative side - lobe does not compensate for the increased sensitivity of the phase - speed - filtered inversion in the near - surface layers",
    ". the ratio of total integrals of averaging kernels over the near - surface depths should therefore provide us with an estimate of the expected scaling factor of magnitudes of inverted velocities resulting from both inversions .",
    "this ratio is 1.4 for the depth 03  mm and 1.2 for 04  mm , thus one should expect a magnitude scaling factor in this order .",
    "the inverted flow fields are displayed in the left and middle panels of fig .",
    "[ fig : test3 ] .",
    "already a comparison by eye reveals that the inverted flows are highly correlated and the statistical analysis ( see table  [ tab : test ] ) largely confirms this visual impression .",
    "the scaling factor discussed in the previous paragraph evaluated by means of the least - squares fit to the flow estimates using error levels in both variables @xcite at all points in the field of view takes the value of 1.45 in the case of inversion for @xmath71 and 1.53 for the inversion for @xmath72 , thus consistently with the predictions based on the analysis of averaging kernels discussed above .",
    "this simple test showed that the flow estimates inverted using different @xmath0@xmath1 filtering approaches are very consistent .",
    "the experiment showed some of the difficulties of both filtering approaches ( e.g. a large sharp surface side - lobe in case of the phase - speed filtering ) , possibly complicating the interpretation of the results .",
    "the test performed showed a substantial advantage of using ridge filters at the discussed depth .",
    "the averaging kernel is cleaner in case of the ridge filters and the noise level is simultaneously better , compared to similar inversion using the phase - speed filters . from other tests",
    "performed , this seems to be always the case within very shallow sub - surface layers .",
    "there are two effects possibly explaining this fact .",
    "the ridge - filtered inversion involves more independent measurements ( 240 ) than the phase - speed - filtered inversion ( 165 ) .",
    "this provides more freedom for the inversion to find a better ballance between the terms in the cost function . on the other hand ,",
    "it is evident from fig .",
    "[ fig:1dkernels ] that the overall depth sensitivity of the ridge - filtered kernels is more confined to the shallow sub - surface layers than the sensitivity of phase - speed - filtered kernels . when targeting the shallow layers using ridge filters , the sensitivity at larger depths naturally does not contribute much to the misfit term @xmath66 in the cost function and the algorithm may , in a shortcut , `` focus to find a better fit at the depths of interest '' . in case of phase - speed filters",
    "the larger depths do contribute the misfit term and the cost function minimisation has consequences to both the quality of the averaging kernel at depths of interest and the level of random noise .",
    "perhaps a differently constructed misfit term than using a simple norm might improve this issue .",
    "from the same reasons , the conclusions obtained using different inversion schemes , e.g. multiplicative ola @xcite or regularised least squares @xcite , may be different .",
    "let s try to combine both @xmath0@xmath1 filtering approaches in a one large inversion , thus involving 405 independent measurement geometries ( index @xmath34)200 wave vectors takes around 6 hours on a 2.6-ghz opteron cpu .",
    "i usually cycle over 200 various combinations of trade - off parameters values .",
    "the total memory requirement for such inversion using the code implemented in matlab is in the order of 700  gb . thanks to the multichannel approach @xcite to solve the inverse problem ( under the assumption of homogeneous background , which is a reasonable assumption in the quiet sun regions ) the task is embarrassingly parallelisable in the wave - vector space , which also decreases the memory requirements of individual parallel jobs .",
    "thus , using the sunquake cluster at astronomical institute of academy of sciences of the czech republic ( 32 cpu cores in total and 352 gb ram in total ) a typical inversion run for one target function takes around 60 hours . ] .",
    "the results are plotted in figs .",
    "[ fig : test1][fig : test3 ] for comparison with the previous two methods of @xmath0@xmath1 filtering .",
    "the averaging kernel is better localised around the target depth ( it does not have the very extended surface side - lobe as in the case of ridge filtering and does not have the extended deep negative side - lobe as in the case of phase - speed filtering , see figs .  [",
    "fig : test1 ] and [ fig : test2 ] ) . at the same time , the noise level in the results is lower ( 12  ms@xmath68 compared to 19  ms@xmath68 or 33  ms@xmath68 respectively ) .",
    "not surprisingly , the inverted flow is highly correlated with the flow estimates from both ridge - filtered and phase - speed - filtered flow estimates ( see table  [ tab : test ] ) . in the inversion , most of the modes contribute the results , except for the @xmath25 ridge , which has significantly lower contribution , and phase - speed filters td8 to td11 , which have more than an order of magnitude lesser contribution .",
    "the correlation coefficients suggests that the inversion combining both filtering approaches is largely dominated by the ridge filters .",
    "although a substantial contribution to the main lobe of the averaging kernel comes from the ridge filters , phase - speed filters contribute comparably ( fig .",
    "[ fig : test2 ] right ) .",
    "the lower correlation with the solely phase - speed - filtered inversion is thus a consequency of a larger random - noise level , which is almost twice larger in case of the phase - speed - filtered inversion than in case of the ridge - filtered inversion",
    ". the substantially lower level of the random noise in the combined inversion might be surprising as both sets of measurements overlap over the @xmath0@xmath1 diagram and thus one would not expect both measurements to be largely independent to help the inversion to constrain the noise level .",
    "counter - intuitively to the expectations , the covariance matrices of the travel - time noise of the two measurement sets have values close to zero ( yet , not exactly zero ) indicating that both sets of measurements indeed are almost independent .",
    "obviously , the combination of more independent travel - time measurement geometries is an improvement to what was seen before .",
    "the power of this approach will become clear in the following application .",
    "the ultimate goal of helioseismic inversions for flows is to study the structure of the flows deeper in the convection zone .",
    "however , as pointed out in section  1 , it has been difficult to obtain sensible flow measurements on supergranular scales from depths deeper than around 4  mm .",
    "this is not deep enough to , for instance , answer the questions regarding the vertical structure of supergranulation cells .",
    "let s hope for better when combining more independent travel - time measurements .",
    "as was shown in the previous section , this approach seems feasible .",
    "i ran a set of inversions for horizontal flow at six depths , target functions for whose were constructed on the physical basis .",
    "first , as a reference , i use the @xmath21-mode only inversion , which was validated against direct surface measurements @xcite to represent the estimate of the near - surface horizontal flow .",
    "then i proceed iteratively in depth , starting at depth of 1  mm and move deeper always by one half of pressure scale height .",
    "each third step in this iterative sequence represents one target depth for the inversion , the 1.5-multiple of the pressure scale height at this depth is then used as fwhm of the gaussian target function ( see fig .",
    "[ fig : targets ] ) .",
    "the starting depth of the sequence was chosen because according to @xcite it makes no sense to scan for features extending less than 1  mm in vertical direction .",
    "i do not go deeper than 10  mm .",
    "thus , in the end , there are six depths , target functions for which are sort of independent ( they do not overlap withing their respective fwhms )  surface ( thereafter denoted as 0  mm ) , @xmath73 , @xmath74 , @xmath75 , @xmath76 , and @xmath77  mm .",
    "all these inversions were validated using synthetic data following the approach of @xcite .    a curious reader familiar with all the detail of the cost function of the inverse problem",
    "@xcite may ask a perfectly valid question , how did i select the proper combination of three trade - off parameters ( in section  [ sect : combination ] i already wrote that a typical inversion run contains 200 of combinations of those trade - off parameters ) for the inversions presented further . a correct answer to this question",
    "is that it is based on a trial - and - error approach .",
    "i use a three - step manual down - selection .",
    "the first eliminating step consists of bounding the level of random noise in the results , predicted by the inversion . here",
    "i used the error level to be around 40  ms@xmath68 for all inversions assuming averaging time of 24  hours .",
    "it is my requirement to have all inversions with comparable noise levels this limit was fulfilled for all depths , except for 0  mm ( noise level of 18  ms@xmath68 for the given averaging time ) , where i strictly used the validated surface inversion @xcite , and the depth of 9.2  mm , where i had to relax the noise constraint to value of around 50  ms@xmath68 , otherwise the averaging kernel had too many side - lobes .",
    "the first step eliminates most of 200 trade - off parameter combinations and retains usually around twenty solutions .",
    "the second step involves looking at the inversion weights @xmath51 .",
    "the weights must be strongly localised around the central point in the spatial domain and the experience says that they should have maximal values of the order of @xmath78  kmmm@xmath79s@xmath79 .",
    "values one order larger , which are also often seen , provide usually inversion which is not robust , as the weights oscillate . should any of the set of weights be rather extended in the spatial domain , the solution is rather periodic in spatial domain and strongly limits the useful field of view .",
    "after this step , usually less than five acceptable solutions remain .",
    "the last criterion i evaluate is the look at the resulting averaging kernels . from my experience",
    ", it is vastly more important to have an averaging kernel , which is without side - lobes or have at least side - lobes as minimised as possible ( this is imperative especially for negative lobes ) , than an averaging kernel that is close to the inversion target function .",
    "thus a simple selection based on the misfit @xmath66 does not necessarily provide the best solution . in this step",
    "i also search for an averaging kernel with cross - talk components @xmath80 for @xmath69 minimised .",
    "the parameters of the selected inversions are summarised in table  [ tab : tomography_parameters ] and the resulting averaging kernels displayed in fig .",
    "[ fig : tomography_kernels ] .",
    "the horizontal fwhm of the target functions is always 15  mm and is well reproduced by the averaging kernels .",
    "one should notice that the averaging kernel for depth of 1.9  mm has large positive and negative near - surface side - lobes , making the interpretation of the results somewhat difficult .    with depth , the importance of the phase - speed filters to construct the main lobe of the averaging kernels increases rapidly ( see fig .  [",
    "fig : composition ] ) .",
    "the ridge filters on the other hand help to eliminate the near - surface sidelobe . in a shortcut , for inversions deeper than say 5  mm",
    ", the phase - speed filters form the main lobe of the averaging kernel , while ridge filters help to constraint the shallow layers . for inversions shallower than 5  mm",
    "no such conclusion can be drawn .",
    "an example of the inverted flows for one of nine investigated days is displayed in fig .",
    "[ fig : tomography_example ] .",
    "it is evident that in the near - surface layers , the flow field is dominated by the plasma flows within supergranules , having a typical size of some 30  mm .",
    "the visibility of supergranules drops rapidly in the flow maps inverted at depths of 6.2 and 9.2  mm .",
    "this is a common picture for all nine investigated days",
    ". visual inspection of flow maps in these depths actually does not reveal any clear cellular pattern as the one clearly visible in shallower depths .",
    "there are , however , divergent and convergent centres even at large depths , which do not seem to be separated by some typical distance .",
    "given the predicted error and root - mean - square velocities at these levels ( see table  [ tab : tomography_parameters ] ) , the inverted velocities have signal - to - noise ratio larger than one , so the poor visibility of supergranules deeper than 6  mm does not seem to be caused by signal drowned in random noise .",
    "the mutual correlation coefficients for inverted flows at all investigated depths calculated for all nine sets of flow maps are given in table  [ tab : tomography_correlation ] .",
    "a high correlation between depths of 0  mm , 1.9  mm , 2.9  mm , and 4.3  mm is evident , thus one can conclude that supergranules are coherent structures within these depths .",
    "a slight anti - correlation is seen at larger depths , in agreements with some previous studies ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "the negative correlation was usually interpreted as the detection of the flow reversal within the supergranular cells .",
    "let s look at it at a little more details .",
    "when computing the correlation coefficient and especially when interpreting its large positive or negative values , one assumes that the studied structures remain at the same place and have a similar size in all correlated maps .",
    "even a skewness of the structure in the depth domain will cause the correlation coefficient to drop , as will also the change in the size of the studied structures . to assess the latter issue , i constructed for all investigated depths the velocity spectrum @xmath81 , given by @xmath82 where @xmath83 is the traditional power spectrum in absolute units ( for recipe i refer to * ? ? ?",
    "as discussed by @xcite , the velocity spectrum @xmath81 is a good measure of the velocity amplitude at various scales .",
    "the velocity spectra , averaged over nine investigated 24-hours datacubes , are plotted in fig .",
    "[ fig : tomography_spectra ] .",
    "the velocity spectra obtained at different depths indicate the shift of typical scale of velocity structure from spherical harmonic degree @xmath84 of 120 at the surface and depths down to 4.3  mm to larger scales ( @xmath85 ) at the depth of 9.2  mm .",
    "let s remind again that the horizontal extent of the averaging kernel is the same ( fwhm of 15  mm ) for inversions for all discussed depths , thus this should not have an effect on scales captured by the inversion .",
    "the negative correlation of deeper depths with the surface ( reported also by other authors ) may thus be spurious and only a consequence of loss of the coherence of supergranular cells with depth , together with action of random noise , which plays not negligible role at deeper depths . from the velocity spectrum",
    ", one sees also a hint on a decrease of the typical velocity magnitude with depth . at this stage ,",
    "i remind that only 9 velocity spectrum realisations were averaged , which is not enough to draw any solid conclusion .",
    "this issue is one of the directions that will be taken in the future research .",
    "i demonstrated that the two @xmath0@xmath1 filtering approaches traditionally used in time  distance helioseismology provide within limitations consistent estimates of the near - surface flow field .",
    "the combination of these two filtering approaches in a single inversion provides an improvement to performance of inverse modelling of subsurface flows .",
    "it allowed to obtain tomographic images of horizontal flow on supergranular scale averaged over 24 hours at depths down to @xmath86  mm with signal - to - noise ratio greater than one .",
    "the preliminary analysis using only 9 days of observations without magnetic activity on the surface suggests a systematic shift of dominant scale of subsurface convection towards larger scales with increasing depth .",
    "we plan to investigate this phenomenon in a greater detail in the future by utilising much larger sets of observations .",
    "this work was supported by the czech science foundation ( grant p209/12/p568 ) .",
    "all computations were performed using the sunquake compute cluster at astronomical institute of academy of sciences in ondejov , the tracked and mapped datacubes were obtained from data processing pipelines at max - planck - institut fr sonnensystemforschung ( mps ) , katlengurg - lindau , germany , which is funded by the german aerospace center ( dlr ) .",
    "the solar measurements were kindly provided by the hmi consortium . the hmi project is supported by nasa contract nas5 - 02139 .",
    "the point - to - point travel - time sensitivity kernels were obtained using the code of aaron birch deployed at the mps .",
    "this work was carried out in collaboration with project sfb 963 `` astrophysical flow instabilities and turbulence '' ( project a1 ) .",
    "tato prce vznikla s podporou na dlouhodob koncepn rozvoj vzkumn organizace ( rvo:67985815 ) a vzkumnho zmru msm0021620860 .",
    "last but not least i thank the anonymous referee for valuable comments that helped to improve the message of this paper .                                                                                  , s.  d. 2008 , in astronomical society of the pacific conference series , vol .",
    "383 , subsurface and atmospheric influences on solar activity , ed .",
    "r.  howe , r.  w.  komm , k.  s.  balasubramaniam , & g.  j.  d.  petrie , 43"
  ],
  "abstract_text": [
    "<S> the consistency of time  distance inversions for horizontal components of the plasma flow on supergranular scales in the upper solar convection zone is checked by comparing the results derived using two @xmath0@xmath1 filtering procedures  ridge filtering and phase - speed filtering  commonly used in time  </S>",
    "<S> distance helioseismology . </S>",
    "<S> it is shown that both approaches result in similar flow estimates when finite - frequency sensitivity kernels are used . </S>",
    "<S> it is further demonstrated that the performance of the inversion improves ( in terms of simultaneously better averaging kernel and lower noise level ) when the two approaches are combined together in one inversion . using the combined inversion i invert for horizontal flows in the upper 10  mm of the solar convection zone . </S>",
    "<S> the flows connected with supergranulation seem to be coherent only in the upper @xmath2  mm depth , deeper down there is a hint on change of convection scales towards structures larger than supergranules . </S>"
  ]
}