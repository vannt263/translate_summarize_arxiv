{
  "article_text": [
    "the theory of random graphs was founded by erds and rnyi in the late 1950s .",
    "one of their most striking results concerned the _ phase transition _ of the size of the largest component  adding a few additional edges to a random graph can drastically alter the size of its largest component . in",
    "@xcite they considered the random graph @xmath11 obtained by choosing a graph uniformly at random amongst all graphs on @xmath12 ( labelled ) vertices containing precisely @xmath13 edges and proved the following result : let @xmath14 be any constant . if @xmath15 , then _ with high probability _",
    "( _ whp _ for short , meaning with probability tending to one as @xmath16 ) all components in @xmath17 have size @xmath18 , while if @xmath19 , _ whp _ the largest component is of size @xmath20 , and if @xmath21 , then _ whp _",
    "there is a component of size @xmath22 called the `` giant component '' , and all other components are of size @xmath18 .",
    "bollobs  @xcite investigated this phenomenon further and described in detail the behaviour of @xmath11 when @xmath13 is close to @xmath23 , i.e. @xmath24 for some @xmath25 satisfying @xmath26 as @xmath16 .",
    "his initial results were then improved by uczak  @xcite . in particular ,",
    "if in addition @xmath27 , _ whp _ the largest component in @xmath28 has size @xmath29 , whereas the largest component in @xmath30 contains asymptotically @xmath31 vertices and all other components are of size @xmath32 . for a comprehensive account of the results see  @xcite .    in the meantime many of these results",
    "have been reproved and strengthened using various modern techniques such as martingales  @xcite , partial differential equations  @xcite , and search algorithms  @xcite .",
    "furthermore , more complicated discrete structures like random hypergraphs have been studied  @xcite .    over the last years",
    ", random graphs have proved to have wide - ranging applications in neurobiology , statistical physics , and the modelling of complex networks  @xcite . frequently some properties of real - world networks are already empirically `` known '' and have motivated the definition of more sophisticated random graph models  @xcite . in particular , applicable random graph models should allow for different types of vertices having different degree distributions , i.e.  some level of _",
    "inhomogeneity_. a general theory of inhomogeneous random graphs was developed by bollobs , janson , and riordan  @xcite providing a unified framework for a large number of previously studied random graph models  @xcite .",
    "for example they analysed the degree distribution , the number of paths and cycles , and the phase transition for the giant component .",
    "the behaviour at the _ critical point _",
    "( corresponding to @xmath17 for @xmath19 ) has been studied by van der hofstad in the so - called _ rank one _ case  @xcite .",
    "recently bhamidi , broutin , sen , and wang studied the general inhomogeneous random graph with a bounded number of types inside the _ critical window _",
    "( corresponding to @xmath33 for some @xmath25 satisfying @xmath34 , @xmath35 ) and have described the joint distribution of the largest components using brownian motion  @xcite .    in this paper",
    ", we study an inhomogeneous random graph model in which there are @xmath12 vertices , each vertex has one of two types , and an edge between a pair of vertices of types @xmath36 and @xmath37 is present with probability @xmath38 independently of all other pairs .",
    "the focus lies on the _ weakly _ supercritical regime , i.e.  when the distance to the critical point of phase transition decreases to zero as @xmath16 . in this regime",
    "the behaviour of the random graph depends very sensitively on the parameters and could not be studied using the parametrisation in  @xcite .",
    "we determine the size of the largest component in this regime ( theorem 2.1 ) .    in order to derive the main results , we apply a simple breadth - first search approach to construct a rooted spanning tree of a component and couple it with a multi - type branching process with binomial offspring distributions , which is viewed as a random rooted tree .",
    "in addition , the width and the dual of that random rooted tree play important roles in the second moment analysis .",
    "the results of this paper are indeed not surprising and the techniques used in the paper may look familiar .",
    "the main contribution of this paper is that it shows how a simple branching process approach combined with the concepts of tree width and dual processes can be applied nicely to a multi - type random graph _ all the way through _ the supercritical regime .",
    "in this section we will first define multi - type binomial random graphs and associate them with branching processes .",
    "then we state the main results and afterwards provide an outline of the proof and the methods involved .",
    "we conclude the section by discussing related results on the general inhomogeneous random graph studied in  @xcite .",
    "let @xmath39 be fixed .",
    "every vertex is associated with a _ type _",
    "@xmath40 and we denote by @xmath41 the set of all vertices of type @xmath40 . given an arbitrary vector @xmath42 and a symmetric matrix of probabilities @xmath43^{k\\times k}$ ] we consider the _ @xmath44-type binomial random graph _",
    "@xmath45 on @xmath46 vertices of type @xmath47 , for @xmath48 , with the following edge set : for each pair @xmath3 , where @xmath5 is of type @xmath36 and @xmath49 of type @xmath37 , we include the edge @xmath3 independently of any other pair with probability @xmath38 and exclude it with probability @xmath50 .",
    "we write @xmath51 for the matrix of the expected number of neighbours @xmath52 of type @xmath53 for a vertex of type @xmath40 .",
    "next we associate a binomial branching process in which each individual has a type @xmath54 with the random graph @xmath55 fix a time @xmath56 and let @xmath57 be a set of individuals ( i.e. the population ) at time @xmath58 which we also call the @xmath59-th generation of individuals .",
    "then , with each individual @xmath60 of type @xmath61 , we associate a random vector @xmath62 , where for each @xmath53 the random variable @xmath63 is independent and binomially distributed with parameters @xmath64 and @xmath65 and thus with mean @xmath66 .",
    "then the population @xmath67 at time @xmath68 will be a set containing exactly @xmath69 _ new _ individuals of type @xmath37 , for each @xmath53 .",
    "in other words , the random variable @xmath63 represents the number of children of type @xmath37 that are born from the individual @xmath49 .",
    "a @xmath44-type binomial branching process starting with an initial population @xmath70 is a sequence of random vectors @xmath71 generated by iterating the construction described above , where @xmath72 is the random variable describing the number of individuals of type @xmath37 in the @xmath59-th generation for each @xmath53 and @xmath73 . for @xmath54",
    "we denote by @xmath74 a @xmath44-type binomial branching process starting with a single vertex of type @xmath36 .",
    "we may also use @xmath74 to denote the rooted ( possibly infinite ) tree created by an instance of the branching process .",
    "the context will always clarify the notation .",
    "furthermore , if a statement is independent of the starting type we simply write @xmath75 , for instance , we refer to the matrix @xmath76 as _ offspring expectation matrix _ of the branching process @xmath75 .",
    "observe that for @xmath77 we obtain the classical binomial random graph @xmath78 where @xmath79 and @xmath80 and the corresponding binomial branching process .    throughout the paper we focus on the case @xmath81 and for simplicity we write @xmath82 .",
    "we denote by @xmath83 the total number of vertices in @xmath1 and without loss of generality we assume that @xmath84 .",
    "furthermore , unless specified explicitly , all asymptotic statements are to be understood in terms of @xmath85 and @xmath86 being _ large enough _ yet fixed and we use the notation @xmath87 for this .",
    "note that in general @xmath88 and it is possible that @xmath89 , even though @xmath90    given a graph @xmath91 with components @xmath92 ordered by size such that @xmath93 we denote by @xmath94 the @xmath36-th largest component of @xmath91 and its size by @xmath95 , for any @xmath96 , and set @xmath97 and @xmath98 if @xmath99 moreover , we will use the following standard notation to describe asymptotic statements : for any real functions @xmath100 and @xmath101 we write : @xmath102 if @xmath103 such that @xmath104 for all @xmath105 ; @xmath106 if @xmath107 such that @xmath104 for all @xmath105 ; @xmath108 if @xmath109 ; @xmath110 if @xmath102 and @xmath108 and @xmath111 if @xmath112 .",
    "we show that @xmath1 exhibits a phase transition in the size of the largest component .",
    "in particular , we show that in the _ weakly _ supercritical regime there is a unique largest component containing asymptotically @xmath31 vertices .",
    "in fact , we prove a stronger result .",
    "[ mainresult ] for @xmath113 and @xmath114 with @xmath84 , let @xmath83 and let @xmath115 with @xmath116 furthermore , let @xmath117^{2\\times 2}\\ ] ] be a symmetric matrix of probabilities satisfying the following conditions : @xmath118 @xmath119 where @xmath52 for every pair @xmath120 .",
    "then , whp the following holds for all integers @xmath121 and @xmath122 @xmath123 therefore , in particular , @xmath124    observe that , up to the term @xmath125 , condition   mirrors the condition @xmath126 that is necessary and sufficient for the existence of a unique largest component in @xmath127 .",
    "in @xmath127 the average degree is @xmath128 and therefore it does not influence the asymptotic statement in  . in @xmath1",
    "however , @xmath4 can be such that we are close to criticality but the average number @xmath129 ( respectively @xmath130 ) of neighbours of the opposite type for a given vertex is still @xmath131 . roughly speaking ,",
    "it is reasonable that if @xmath129 is `` very small '' , then the random graph @xmath1 may have two largest components , one of each type , that coexist independently since the probability of adding any edge between them is negligible .",
    "in particular , this would happen in case probability @xmath132 was equal to zero and therefore @xmath133    on the other hand , in the special case @xmath134 the condition in   differs by an additional factor of @xmath135 from that in @xmath127 .",
    "this factor is , for instance , necessary to show that the number of vertices of type @xmath0 in the largest components is concentrated around its mean .",
    "therefore it is not avoidable with this method , even though it might not be optimal .",
    "the symmetry of @xmath4 simply reflects the fact that @xmath1 is an _ undirected _ random graph .",
    "note that the parameter @xmath136 describes the _ distance _ to the critical point for the emergence of the giant component in a sense that we will explain now . roughly speaking",
    ", for some time , the breadth - first exploration process of a component in @xmath1 looks like a @xmath0-type binomial branching process @xmath75 .",
    "this can be described by a coupling of the two processes .",
    "if the branching process dies out its total population should be rather `` small '' .",
    "thus , by the coupling , the explored component is also `` small '' .",
    "it is well - known that for a @xmath0-type binomial branching process the property of survival has a threshold and that the critical point is characterised by the perron - frobenius eigenvalue @xmath137 of its offspring expectation matrix @xmath51 . if @xmath138 the process has a positive probability of survival , while if @xmath139 it dies out with probability @xmath140 .",
    "next , let us compute @xmath141 for the @xmath0-type binomial branching process @xmath75 with parameters as in theorem  [ mainresult ] .",
    "condition   states that for every constant @xmath142 there is an @xmath143 such that we have @xmath144 for @xmath145 and all @xmath146 this implies @xmath147 and similarly @xmath148 therefore we can bound the argument of the square root in   from above by @xmath149 and from below by @xmath150 thus , by   and since @xmath151 was arbitrary , we obtain the following asymptotic estimate for the perron - frobenius eigenvalue @xmath152 in other words , @xmath153 describes how close @xmath141 is to @xmath140 .",
    "our next result concerns the weakly _ subcritical _ regime .",
    "[ mainresult2 ] for @xmath113 and @xmath114 with @xmath84 , let @xmath83 and let @xmath115 with @xmath116 furthermore , let @xmath117^{2\\times 2}\\ ] ] be a symmetric matrix of probabilities satisfying the following conditions : @xmath154 @xmath155 where @xmath52 for every pair @xmath120 .",
    "then we have whp @xmath156    note that analogously to theorem  [ mainresult ] the parameter @xmath136 describes the _ distance _ to the critical point from below .",
    "in other words , by  , we know that the perron - frobenius eigenvalue @xmath141 of the offspring expectation matrix @xmath76 of a @xmath0-type binomial branching process @xmath75 with parameters as in theorem  [ mainresult2 ] satisfies @xmath157    we will dedicate most of this paper to the more sophisticated weakly supercritical regime . a sketch of the proof of theorem  [ mainresult ] is given in subsection  [ sketch ] , properties of supercritical branching processes will be analysed in section  [ branchingsection ] , and the actual proof of theorem  [ mainresult ] is provided in section  [ proof ] .",
    "the weakly subcritical regime follows in section  [ sec : weaklysub ] with the proof of theorem  [ mainresult2 ] . in sections  [ sec : supercritical ]  and",
    "[ sec : subcritical ] we also consider the size of the largest component in the regimes where the distance to the critical value is a _ constant _ ( independent of @xmath85 and @xmath86 ) . in the supercritical regime the largest component will already be a _ giant component _",
    ", i.e.  it is unique and of linear size .",
    "similarly , we also get a stronger upper bound on the size of all components in the subcritical regime .",
    "these results can also be proved using the general framework in  @xcite , however , we give alternative simple proofs .",
    "we extend the method employed by bollobs and riordan  @xcite for the study of the weakly supercritical regime of @xmath78 . to prove theorem  [ mainresult ] we consider the set @xmath158 of vertices in `` large '' components .",
    "the first goal is to show that the size of @xmath158 is concentrated around @xmath31 by applying chebyshev s inequality .",
    "we calculate asymptotically matching upper and lower bounds for the expected size of @xmath158 by coupling the breadth - first component exploration process from below and above with @xmath0-type branching processes .",
    "once this is done , using a more refined version of this idea , we show that the square of this expectation is an upper bound for the second moment of the size of @xmath158 , therefore the variance of the size of @xmath158 is indeed `` small '' compared to the square of the expectation and concentration follows by chebyshev s inequality .",
    "so now we know that @xmath159 the appropriate number of vertices lie in `` large '' components , but there might be several distinct such components all of which may also be much smaller than claimed in theorem  [ mainresult ] .",
    "however , we can construct a random graph via a two - round exposure . in the first round we reduce the probability of including some edges by a tiny bit and",
    "note that the above arguments will still hold in this setting . in the second round",
    "we once again look at each pair not yet connected by an edge and `` sprinkle '' an edge with a tiny probability independently for each such pair . by choosing the magnitude of these probabilities appropriately",
    "we can ensure that the resulting random graph has the same distribution as @xmath1 and thus we can identify both random graphs by a coupling argument . analysing",
    "the probability that `` large '' components are connected by at least one edge and using the union bound we show that @xmath159 almost all vertices from @xmath158 lie in a single component of @xmath1 .",
    "the general inhomogeneous random graph model @xmath160 studied by bollobs , janson , and riordan  @xcite is closely related to the model @xmath1 . for",
    "any @xmath161 consider a random sequence @xmath162 of points from a separable metric space @xmath163 equipped with a borel probability measure @xmath164 and let @xmath165 be the empirical distribution of @xmath166 .",
    "assume that @xmath165 converges in probability to @xmath164 , then the triple @xmath167 is called a _",
    "vertex space_. furthermore let @xmath168 be a sequence of symmetric non - negative @xmath164-measurable functions on @xmath169 , which converges to a limit @xmath170 , and let @xmath171 be a constant . then the random graph @xmath160 is a graph with vertex set @xmath172,$ ] where each pair of vertices @xmath173 is connected by an edge with probability @xmath174 independently of all other pairs .",
    "it is proved that with respect to the parameter @xmath175 there is a phase transition concerning the size of the largest component . in particular , the existence and uniqueness of the giant component in @xmath160 in the supercritical regime are proved using an appropriate multi - type branching process and analysing an integral operator @xmath176 .",
    "the critical point of the phase transition is characterised by @xmath177 : if @xmath178 then the random graph contains only small components , but if @xmath179 then there is a giant component which contains asymptotically @xmath180 vertices , where @xmath181 is independent of @xmath12 and grows linearly in @xmath182    by contrast the focus of our paper lies on the _ weakly _ supercritical regime ( theorem  [ mainresult ] ) , i.e. the distance @xmath183 from the critical point of the phase transition tends to zero as the number of vertices increases .",
    "the analysis in this regime is in general quite sophisticated , in comparison with the supercritical regime , i.e.  when @xmath136 is a constant independent of @xmath184 in general it is not sufficient to only scale the edge probabilities multiplicatively as in @xmath160 , since even if @xmath185 the _ spectral gap _ of the operator @xmath186 is always bounded away from @xmath187 .",
    "in contrast to this , the spectral gap of the offspring expectation matrix in @xmath1 is given by @xmath188 and thus may _ tend to zero arbitrarily quickly_. similarly , if one of the types has significantly fewer vertices than the others , it will not influence the behaviour of @xmath160 ; however we show that in the weakly supercritical regime of @xmath1 these vertices may still be crucial in the evolution of the largest component and ignoring them may even result in a subcritical process .",
    "for @xmath189 such an example is given by @xmath190 @xmath191 and thus @xmath192",
    "later we will study the component sizes of the random graph @xmath1 using @xmath0-type binomial branching processes . in this section",
    "we investigate some of their most important properties .",
    "we start with a simplified version of a key result concerning the survival probability of a general multi - type galton - watson branching processes .",
    "[ harris ] let @xmath75 be a @xmath0-type binomial branching process with parameters @xmath113 and @xmath193 with @xmath194 and @xmath195^{2\\times2}\\ , .\\ ] ] let @xmath196 be the perron - frobenius eigenvalue of its offspring expectation matrix @xmath197 where @xmath52 , and let @xmath198 be the pair of survival probabilities . then the following holds :    * if @xmath199 , we have @xmath200 * if @xmath201 , then @xmath198 is the unique positive solution of @xmath202 where @xmath203    we call a branching process that has a positive survival probability _ supercritical _ and otherwise we call it _",
    "there is a very simple way to see that the survival probabilities must satisfy these equations : we consider the extinction probabilities before and after the _ first _ step of the process and apply the binomial theorem .    because the conditions of theorem  [ mainresult ] imply that the perron - frobenius eigenvalue of the offspring expectation matrix @xmath76 is strictly larger than @xmath140",
    ", the associated branching process will have a positive survival probability that is given implicitly by  .",
    "it is sufficient for us to extract some information about the asymptotic behaviour of the unique positive solution from these equations .",
    "however , even trying to solve these equations only asymptotically we have to be very careful with cancellation and take into account higher order terms : this is a major reason why the weakly supercritical regime is significantly harder to analyse than the other regimes .",
    "[ asympsurvival ] under the conditions as in theorem  [ mainresult ] the survival probabilities of the @xmath0-type binomial branching process @xmath75 satisfy @xmath204    the key idea is to find suitable bounding functions for the @xmath205 s defined in  , for which the asymptotic values of the zeros can be computed easily , and then to observe that these coincide for the upper and lower bound .",
    "first observe the following fact : if @xmath206 , we have @xmath207 and @xmath208 ; analogously , if @xmath209 , then @xmath210 and @xmath211 .",
    "thus , without loss of generality due to the subsubsequence  principle  ( e.g.  @xcite ) , we assume @xmath206 and consider the bounding functions @xmath212 for @xmath145 : @xmath213 by the taylor - expansion of the natural logarithm around @xmath140 . since @xmath214 and @xmath215 by the conditions of theorem  [ mainresult ] and the fact that @xmath216 ( since it is a probability ) , we have @xmath217\\rho_i\\right)\\\\&=1-\\rho_i-\\exp\\left(-(1+\\varepsilon_i)\\rho_i\\right),\\end{aligned}\\ ] ] where @xmath218 , by  and  .",
    "we define @xmath219 and note that solving @xmath220 asymptotically is a well - known problem that turns up when calculating the asymptotic value of the survival probability for a single - type poisson branching process . using the taylor - expansion of the natural logarithm we get @xmath221 since the coefficients in this series are all positive and @xmath222 , this shows that @xmath223 and thus @xmath224 having established the asymptotic behaviour of @xmath225 and @xmath226 it remains to show that @xmath227 and @xmath228 , since this together with @xmath229 and @xmath230 implies @xmath231 .    for this last step ,",
    "assume towards contradiction that @xmath232 and observe that @xmath233 is negative on the interval @xmath234 $ ] .",
    "since @xmath198 is by definition a solution of   we have @xmath235 a contradiction .",
    "analogously , @xmath236 leads to a contradiction since @xmath237 is positive on @xmath238 , completing the proof .      in the proof of theorem  [ mainresult ] we consider the supercritical branching process @xmath75 associated with @xmath1 and we will need a good upper bound on the probability its total number of offspring of type @xmath239 is at least @xmath240 , for carefully chosen real functions @xmath241 and @xmath242",
    ". since this probability is @xmath140 if the process survives , this reduces to analysing the conditional probability given the event @xmath243 that the process dies out .",
    "we call the resulting @xmath0-type binomial branching process the _ dual process _ and we can describe its offspring distributions as follows .",
    "we need to know , for a vertex @xmath49 of type @xmath145 born in generation @xmath57 , for some integer @xmath244 and a potential child @xmath5 of type @xmath245 whether the edge @xmath246 is present in the dual process , i.e.  conditioned on @xmath243 .",
    "let @xmath247 be the event that @xmath5 is a child of @xmath49 in @xmath75 and note that conditioning on @xmath247 will decrease the probability of @xmath248 more precisely , let @xmath249 denote the vector of the number of individuals of each type in generation @xmath67 . since @xmath250 and @xmath251 are independent binomially distributed random variables , calculating @xmath252 and @xmath253 by conditioning on @xmath254 leads to @xmath255 and @xmath256 observe that by definition @xmath257 for all @xmath258 and @xmath259 is independent of @xmath247 and thus @xmath260 therefore we get @xmath261 uniformly for all edges @xmath262 ( with one end point of type @xmath36 and the other of type @xmath37 ) .",
    "an analogous calculation shows that the presence of @xmath262 does not depend on any other edges , i.e.  the dual process is also a @xmath0-type binomial branching process .",
    "hence , we write @xmath263 , @xmath264 , where @xmath265 , and denote the dual process of @xmath75 by @xmath266 .    intuitively it is obvious that the dual process of any supercritical process is subcritical . for completeness",
    "we give a short proof for the processes that we use .",
    "first observe that for each pair @xmath267 we have , by condition  , @xmath268 and thus @xmath269    let @xmath75 be a @xmath0-type binomial branching process satisfying the conditions of theorem  [ mainresult ] .",
    "then the offspring expectation matrix @xmath264 of the dual process @xmath266 satisfies @xmath270 and thus we have @xmath271 for the perron - frobenius eigenvalue @xmath141 of @xmath272 .    by  ,",
    "lemma  [ asympsurvival ] and condition   we get @xmath273 the second statement follows analogously to  .",
    "the benefit of using the _ subcritical _ dual process @xmath266 is that we can bound the expected total number of offspring of each type .",
    "[ dualprocess ] for @xmath145 let @xmath74 be a @xmath0-type binomial branching process satisfying the conditions of theorem  [ mainresult ]",
    ". then the associated dual process @xmath274 satisfies @xmath275 moreover , for any real functions @xmath241 and",
    "@xmath242 , this implies that @xmath276 and in particular @xmath277 if @xmath278 and @xmath279    consider the dual process @xmath266 .",
    "we associate a vertex born in generation @xmath57 , for integer @xmath280 with its `` line of ancestry '' , i.e.  the string @xmath281 which is the finite sequence of types of all its ancestors ( starting with the root of @xmath266 and including itself ) .",
    "set @xmath282 and denote by @xmath283 the set of all finite strings over the alphabet @xmath284 we consider the injective function @xmath285 defined by @xmath286 for @xmath287 .",
    "a string @xmath288 is called _ admissible _ if @xmath289 and we denote the set of admissible strings by @xmath290 .",
    "observe that , for every pair @xmath267 , the function @xmath291 can be seen as a bijection that maps the subset @xmath292 of lines of ancestry starting with @xmath36 and ending in @xmath37 to the subset @xmath293 of admissible strings starting with @xmath294 or @xmath295 and ending with @xmath296 or @xmath297 .",
    "next we define a function @xmath298 that canonically extends to a function @xmath299 and note that the expected number of offspring with a fixed line of ancestry @xmath300 is precisely @xmath301 hence , for @xmath302 we obtain @xmath303 where , for every pair @xmath304 @xmath305 is the four - variate ordinary generating function of @xmath306 ( marking the occurrences of @xmath307 , @xmath308 , @xmath309 , and @xmath310 respectively ) . using the _",
    "symbolic method_(e.g .",
    "@xcite ) we compute the closed forms of these generating functions providing @xmath311 for @xmath302 if the denominator @xmath312 is positive .",
    "we now establish stronger lower bounds , which allow us to prove statement  . by  , for any constant @xmath142 there exists an integer @xmath313 such that for all @xmath314 we have @xmath315 and thus , letting @xmath316 we obtain @xmath317    as mentioned before , conditioning on @xmath318 ( the event that the primal process @xmath74 dies out ) and applying markov s inequality we get @xmath319 completing the proof .",
    "the last tool that we need for the proof is the concept of the width of a rooted tree .",
    "the _ width _ @xmath320 of a rooted tree @xmath321 is defined as the supremum of the sizes of all its generations . in this context",
    "we will interpret any branching process as a potentially infinite random rooted tree .",
    "[ largewidth ] let @xmath75 be a @xmath0-type branching process satisfying the conditions of theorem  [ mainresult ] and denote by @xmath243 the event that this process dies out .",
    "then for any real function @xmath13 such that @xmath322 we have @xmath323    denote @xmath324 and let us construct @xmath75 generation by generation and stop as soon as we see the first generation of size at least @xmath13 if there is one",
    ". then we have @xmath325 vertices of type @xmath140 and @xmath326 vertices of type @xmath0 where @xmath327 .",
    "since each of the vertices of this generation starts an independent copy of @xmath328 ( respectively @xmath329 ) we get for the probability of dying out given that @xmath330 holds @xmath331 where the asymptotic statements hold due to lemma  [ asympsurvival ] and since @xmath332 hence , we obtain @xmath333 and by the law of conditional probability and lemma  [ asympsurvival ] we have @xmath334 proving lemma  [ largewidth ] .",
    "the main idea of the proof is to couple the component exploration process in @xmath1 with instances of the @xmath0-type binomial branching process @xmath75 . given a vertex @xmath49 of type @xmath36 in @xmath1 we denote its component by @xmath335 .",
    "furthermore let @xmath336 be the random spanning - tree rooted at @xmath49 constructed by exploring new neighbours in @xmath335 via a breadth - first search .",
    "again we interpret branching processes as potentially infinite random rooted trees .",
    "[ coupling ] given any vector @xmath337 , any symmetric matrix @xmath338^{2\\times 2},$ ] and any vertex @xmath49 of type @xmath302 the following two statements hold .",
    "a.   there is a coupling of the random rooted trees @xmath336 and @xmath74 such that @xmath339 . in particular , @xmath340 for @xmath341 b.   for any vector @xmath342 satisfying @xmath343 , there is a coupling of the random rooted trees @xmath336 and @xmath344 such that @xmath345 or both trees contain at least @xmath325 vertices of type @xmath140 or @xmath326 vertices of type @xmath0 . in particular , either @xmath346 , for @xmath239 , or",
    "the total number of vertices of type @xmath347 in @xmath335 and @xmath344 is at least @xmath348 for some @xmath349    for the first statement , we generate @xmath336 and @xmath74 simultaneously , restoring the set of potential neighbours in the breadth - first search by adding fictional vertices of the same type to the vertex set of @xmath1 for each vertex already added as a neighbour .",
    "any offspring of a fictional vertex is automatically fictional . in this way , for each type @xmath239 , we always have @xmath350 potential new neighbours of this type each chosen independently with probability @xmath65 according to the type @xmath351 of the current vertex . after removal of all fictional vertices from @xmath74 we obtain @xmath336 .",
    "therefore , we have @xmath352 and since @xmath353 the first statement holds .    for the second statement",
    "we proceed as before with the slight change that in each step we choose for any type @xmath239 exactly @xmath354 neighbours from all possible new neighbours of type @xmath37 and only add those independently with probability @xmath355 where @xmath351 is the type of the current vertex , and ignore all other vertices . until we have encountered a total of at least @xmath356 vertices of type @xmath347 in @xmath344 for some @xmath357",
    "there are always enough vertices of each type to choose from . assuming that this does not happen for any @xmath357 , we thus have @xmath358 and the claim follows .    using lemma  [ dualprocess ] and lemma  [ coupling ] we can now establish the expectation of the number of vertices in `` large '' components . for any type @xmath302",
    "we denote by @xmath359 the set of all vertices of type @xmath36 in components that contain at least @xmath240 vertices of type @xmath360 for some @xmath239 and a properly chosen pair @xmath361 of real functions .",
    "moreover , we denote by @xmath362 the cardinality of this set .",
    "[ expectationupperbound ] let @xmath240 be a real function satisfying @xmath363 for @xmath341 then @xmath364    for @xmath302 by lemma  [ coupling](i ) and linearity of expectation , we have @xmath365 where the last step holds by equation   in lemma  [ dualprocess ] .",
    "[ expectationlowerbound ] let @xmath240 be a real function satisfying @xmath366 for @xmath367 then @xmath368    we apply lemma  [ coupling](ii ) with @xmath369 , since @xmath370 , for @xmath245 and note that the parameters of the coupling branching process satisfy conditions  and  .",
    "hence , for @xmath302 this yields by linearity of expectation @xmath371 where the last step holds due to lemma  [ asympsurvival ] .    in the next lemma we will show that @xmath372 , i.e.  the number of vertices of type @xmath36 in large components , is concentrated around its expectation .",
    "[ concentration ] let @xmath240 be a real function satisfying @xmath373 and @xmath370 , for @xmath341 then whp @xmath374    lemmas  [ expectationupperbound ]  and  [ expectationlowerbound ] show that @xmath375 , hence it is sufficient to derive the upper bound @xmath376 the reason for this is the classical _ second moment method _ ( e.g.  @xcite ) : equation   implies that for the random variable @xmath377 the variance is of smaller order than the square of the expectation , i.e. @xmath378 which provides concentration by chebyshev s inequality .    without loss of generality",
    "fix a type @xmath145 for the rest of the proof .",
    "furthermore , fix a vertex @xmath49 of type @xmath36 in @xmath1 .",
    "once again we explore the component @xmath335 of that vertex in a breadth - first search generating a tree @xmath379 .",
    "however , we will stop the exploration immediately , even midway through revealing the neighbours of one particular vertex , if one of the following two events occurs :    a.   we have already reached a total of @xmath240 vertices of type @xmath37 for some @xmath380 b.   there are @xmath381 vertices that have been reached ( i.e.  children of earlier vertices ) but not yet fully explored ( flipped a coin for each possible neighbour ) .",
    "note that for stopping condition",
    "( ii ) we do not distinguish the types of vertices .",
    "any vertex that has been reached but not fully explored is called _",
    "boundary vertex_. observe that this process will create at most @xmath382 boundary vertices .",
    "furthermore , denote by @xmath383 the event that the process stops due to  ( i )  or  ( ii ) , rather than because it has revealed the whole component @xmath335 .",
    "note that @xmath384 a fact that we will use later on .",
    "now we estimate the probability that @xmath383 holds : by the coupling in lemma  [ coupling](i ) we may assume that @xmath385 and , since we proceed in a breadth - first manner , at every point of time all the boundary vertices are contained in at most two consecutive generations . hence if @xmath383 holds , either @xmath386 for some @xmath245 or the total number of offspring of the process @xmath74 is finite and @xmath387 . as calculated in lemma  [ dualprocess ] the probability that the first case occurs is asymptotically at most @xmath388 while for the second case we calculated in lemma  [ largewidth ] that the probability of having large width but still dying out is @xmath389 , hence @xmath390    we use this to relate the second moment to the expectation on the conditional probability space , where we condition on @xmath383 holding .",
    "we replace @xmath377 by a sum of indicator random variables and from the implication in   we get @xmath391&=\\sum_{v\\in v_i}{\\mathbb{e}}\\left[{\\mathbbm{1}}_{\\left\\{\\left|\\mathcal{c}_v\\cap v_1\\right|\\geq l_1\\vee\\left|\\mathcal{c}_v\\cap v_2\\right|\\geq l_2\\right\\}}s_{i,\\mathbf{l}}\\right ] \\\\&\\leq n_i{\\mathbb{e}}\\left[{\\mathbbm{1}}_{\\mathcal{a}}s_{i,\\mathbf{l}}\\right]\\nonumber \\\\&=n_i{\\mathbb{p}}(\\left.\\mathcal{a}){\\mathbb{e}}\\left[s_{i,\\mathbf{l}}\\right|\\mathcal{a}\\right]\\nonumber \\\\&\\leq ( 2+o(1))\\varepsilon n_i{\\mathbb{e}}\\left[s_{i,\\mathbf{l}}\\left.\\right|\\mathcal{a}\\right].\\end{aligned}\\ ] ]    for the remainder of this proof we will compute an asymptotic upper bound for the conditional expectation @xmath392.$ ] now for any vertex @xmath393 of type @xmath36 we reveal its component as before in a breadth - first manner but ignore any vertices that are in @xmath394 , i.e.  we explore in @xmath395 until we have revealed the whole component in this subgraph . moreover , we couple the generated tree @xmath396 with @xmath74 such that @xmath397 .",
    "we denote by @xmath318 the event that this instance of @xmath74 dies out and note , in particular , that @xmath318 is independent of the event @xmath383 , hence @xmath398 by lemma  [ asympsurvival ] .",
    "let us observe that @xmath399 and furthermore that equality holds unless @xmath1 contains an edge connecting a boundary vertex to a vertex of @xmath396 .",
    "therefore , for any given @xmath400 we have @xmath401 by the union bound , as there are at most @xmath402 boundary vertices .",
    "note that by   we have @xmath403 hence , by the law of total probability , @xmath404}.\\end{aligned}\\ ] ] in order to simplify notation we will write @xmath405 for the event that the component of @xmath5 is large . hence it follows that @xmath406 } \\\\\\leq{\\mathbb{p}}(\\neg\\mathcal{d}_i)&+l_1^{-1}{\\mathbb{e}}{\\left(\\left|\\mathcal{t}_{\\mathbf{n},\\pi}^i\\cap v_1\\right|\\right)}+l_2^{-1}{\\mathbb{e}}{\\left(\\left|\\mathcal{t}_{\\mathbf{n},\\pi}^i\\cap v_2\\right|\\right ) } \\\\&+4\\varepsilon l_2 n_2^{-1}{\\mathbb{e}}\\left(\\left|\\mathcal{t}_{\\mathbf{n},\\pi}^i\\right|\\right),\\end{aligned}\\ ] ] where the last step holds due to markov s inequality .",
    "furthermore , we know that these expectations are all of order @xmath407 by the bound   in lemma  [ dualprocess ] .",
    "additionally , by our assumptions on @xmath408 , the coefficients @xmath409 @xmath410 and @xmath411 are all of order @xmath389 and therefore using   we get @xmath412 thus , since there are at least @xmath413 vertices of type @xmath36 for which we can apply this bound , we get @xmath414\\leq l_i+ ( n_i - l_i){\\mathbb{p}}{\\left(\\mathcal{x}_{u,\\mathbf{l}}\\mid\\mathcal{a}\\right)}\\leq l_i + ( 2+o(1))\\varepsilon n_i=(2+o(1))\\varepsilon n_i.\\ ] ] inserting this into inequality   and then applying chebyshev s inequality completes the proof of lemma  [ concentration ] .",
    "now we can prove theorem  [ mainresult ] .",
    "let us first introduce some further notation .",
    "we write @xmath415 and note that @xmath416 and @xmath417 by the assumptions of theorem  [ mainresult ] .",
    "we set @xmath418 and note that we could replace @xmath419 by any function @xmath420 such that @xmath421 but growing very slowly compared to @xmath422 .",
    "moreover , observe that since @xmath423 we have @xmath424    essentially , we know so far that the random graph @xmath1 satisfying the conditions of theorem  [ mainresult ] , contains the `` right '' number of vertices in large components .",
    "it only remains to show that all these components are connected , and thus form a single component , if we `` sprinkle '' some more edges .",
    "formally this can be done as follows .",
    "we define a symmetric probability matrix @xmath425 by setting @xmath426 and @xmath427 then let @xmath428 be the symmetric probability matrix whose entries satisfy @xmath429 and @xmath430 we construct @xmath431 and @xmath432 independently and couple them in such a way that we have @xmath433    since @xmath434 we have @xmath435 implying that the entries of @xmath428 are all positive for large enough @xmath85 and @xmath436 furthermore , as @xmath437 we have @xmath438 and therefore @xmath431 also meets all requirements of theorem  [ mainresult ] .",
    "moreover , we have calculated in   and   that the further conditions of lemma  [ concentration ] are also satisfied for @xmath439 let us denote by @xmath440 the set of vertices of type @xmath145 in large components of @xmath441 , i.e. components containing at least @xmath240 vertices of type @xmath37 for some @xmath341 then , by lemma  [ concentration ] , we have @xmath159 @xmath442 for some real function @xmath443 we assume that this event holds .",
    "let @xmath444 denote the set of all large components in @xmath441 .",
    "then for any component @xmath445 we say that the type @xmath239 is a _ witness _ for",
    "@xmath446 being large if @xmath447 .",
    "observe that having a witness is a necessary condition for any component to be large , hence each large component @xmath445 has at least one witness , yet it is not a sufficient condition .",
    "for @xmath239 we define the set @xmath448 of large components for that type @xmath37 is a witness and write @xmath449 for some integer @xmath450 .",
    "intuitively , it should not be the case that one of these sets is empty .",
    "we prove this by a counting argument .",
    "[ notstrange ] @xmath451 and @xmath452 are not empty , i.e. @xmath453 and @xmath454    without loss of generality assume towards contradiction that @xmath455 and thus clearly @xmath454 observe that this implies that @xmath456 and @xmath457for @xmath458 counting vertices of both types separately , we therefore get for type @xmath140 @xmath459 and for type @xmath0 @xmath460 this shows @xmath461 a contradiction for large enough @xmath85 and @xmath462 since @xmath463 , for @xmath464 hence claim  [ notstrange ] holds .",
    "we continue the proof of theorem  [ mainresult ] .",
    "observe that by the definition of witnesses we have @xmath465 for @xmath239 and @xmath466 hence , if we estimate the number of vertices of type @xmath37 by only summing over the components in @xmath467 we get @xmath468 and consequently @xmath469 let @xmath470 and @xmath471 be any two large components , i.e.  they satisfy @xmath472 and @xmath473 then the probability that in @xmath474 there is no edge between @xmath475 and @xmath476 is at most @xmath477 taking the union bound for ( up to ) @xmath478 of these events shows that the probability that in @xmath1 all components that were large in @xmath441 are connected is at least @xmath479 thus , @xmath159 there is a component @xmath480 in @xmath481 which contains @xmath482 for @xmath145 .    on the other hand , writing @xmath359 for the set of vertices of type @xmath145 in large components of @xmath1 we get @xmath483 due to the coupling .",
    "hence we have @xmath484 furthermore , applying lemma  [ concentration ] , with the same choice of @xmath485 directly to @xmath1 we obtain @xmath159 @xmath486 for some real function @xmath487 thus the number of vertices of type @xmath36 in the component @xmath480 satisfies @xmath488    moreover , any other large component @xmath446 in @xmath1 may at most contain all the vertices from @xmath489 and @xmath490 and therefore satisfies @xmath491 in particular , summing over both types , we have @xmath492 for large enough @xmath85 and @xmath493 consequently , @xmath480 is already the largest component @xmath494 and satisfies the required asymptotics by  , completing the proof .",
    "most of the work for this regime has already been done in section  [ dualsection ] , since the dual process of a weakly supercritical branching process is weakly subcritical .",
    "therefore we will keep the proof short .",
    "let the conditions be as in theorem  [ mainresult2 ] . then , analogously to the proof of lemma  [ dualprocess ] , we calculate the expected total size of the @xmath0-type binomial branching process @xmath74 , for @xmath145 , and get @xmath495 now let @xmath496 for any fixed constant @xmath497 and write @xmath498 for the set of vertices in components of size at least @xmath499 and @xmath500 . then with the coupling as in lemma  [ coupling](i )",
    "we get , by applying markov s inequality twice and linearity of expectation , @xmath501 since @xmath27 by condition  .",
    "hence , since @xmath497 was arbitrary , @xmath159 all components are of size @xmath29 .",
    "this result can be slightly strengthened : let @xmath502 and replace @xmath499 by @xmath503 for any @xmath504",
    "in the supercritical regime , when the distance from the critical point is a constant , @xmath1 @xmath159 has a giant component .",
    "the proof is essentially the same as in section  [ proof ] except for some of the arguments used for calculating the survival probabilities .",
    "[ mainresult3 ] for @xmath113 and @xmath114 with @xmath84 , let @xmath83 and let @xmath136 be a fixed constant .",
    "furthermore , let @xmath117^{2\\times 2}\\ ] ] be a symmetric matrix of probabilities satisfying the following conditions : @xmath505 @xmath506 where @xmath52 for every pair @xmath120 .",
    "let @xmath507 be the unique positive solution of the equation @xmath508 then , whp the following holds for every integer @xmath121 and @xmath122 @xmath509 therefore , in particular , @xmath510    let the conditions be as in theorem  [ mainresult3 ] .",
    "we will only show the computation for the survival probabilities , which is very similar to the proof of lemma  [ asympsurvival ] . for the @xmath205 s defined in",
    "we use the same bounding functions as before .    as in the proof of lemma  [ asympsurvival ]",
    "we assume without loss of generality that @xmath511 and thus we have @xmath210 and @xmath211 .",
    "fix @xmath464 we consider the bounding functions @xmath512 : @xmath213 by the taylor - expansion of the natural logarithm around @xmath140 . since @xmath513 and @xmath514 by the conditions of theorem  [ mainresult3 ] and the fact that @xmath216 ( since it is a probability ) , we have @xmath217\\rho_i\\right)\\\\&=1-\\rho_i-\\exp\\left(-(1+\\varepsilon_i)\\rho_i\\right),\\end{aligned}\\ ] ] where @xmath218 , by conditions  and  .",
    "we set @xmath515 and a real function @xmath291 on @xmath516 by setting @xmath517 for @xmath518 note that we have @xmath519    it is well - known that @xmath520 has exactly one solution for any fixed @xmath521 furthermore note that the partial derivative with respect to the variable @xmath175 of @xmath291 does not vanish on @xmath516 , therefore we can apply the classical implicit function theorem in @xmath522 we consider @xmath523 and denote by @xmath524 the corresponding solution of @xmath525 hence , there is an open set @xmath526 with @xmath527 and an open set @xmath528 with @xmath529 such that @xmath530 where @xmath531 is a continuous function on @xmath526 with @xmath532 .",
    "let @xmath464 because @xmath533 we know that @xmath534 for large enough @xmath85 and @xmath462 and this implies that @xmath535 since @xmath531 is continuous we have @xmath536 and it is sufficient to show that @xmath537 and @xmath538",
    ".    for this last step , assume towards contradiction that @xmath539 and observe that @xmath540.\\ ] ] since @xmath198 is by definition a solution of   we have @xmath541 a contradiction .",
    "analogously @xmath542 leads to a contradiction since @xmath543 thus we have @xmath544    the remainder of the proof follows the lines of the proof of theorem  [ mainresult ] in sections  [ dualsection ] ,  [ widthsection ]  and  [ proof ] , by replacing @xmath545 with statement  .",
    "in the subcritical regime , where the distance to the critical point is a constant , one can obtain a strong upper bound on the size of all components by a standard application of large deviation inequalities .",
    "[ mainresult4 ] for @xmath113 and @xmath114 with @xmath84 , let @xmath83 and let @xmath546 be a fixed constant .",
    "furthermore , let @xmath117^{2\\times 2}\\ ] ] be a symmetric matrix of probabilities satisfying the following conditions : @xmath547where @xmath52 for every pair @xmath120 .",
    "then we have whp @xmath548    let the conditions be as in theorem  [ mainresult4 ] .",
    "we fix a vertex @xmath49 and explore its component @xmath335 in @xmath1 .",
    "denote the resulting spanning tree by @xmath336 and couple this process with a @xmath0-type branching process @xmath75 as in lemma  [ coupling](i ) such that @xmath549 let @xmath550 be the event that @xmath1 contains a component of size at least @xmath499 for some appropriately chosen real function @xmath551 we want to show that @xmath552    let us denote the ( possibly infinite ) sequence of vertices born in @xmath553 , with respect to the breadth - first exploration , by @xmath554 where @xmath555    for any vertex @xmath556 let @xmath557 be the random variable that counts the number of children of @xmath5 and has a distribution @xmath558 where @xmath239 is the type of @xmath559 then consider the random variables @xmath560 where @xmath561 is an arbitrary sequence of distinct additional vertices .",
    "notice that @xmath562 is a sum of independent bernoulli random variables whose expectation satisfies @xmath563 for some @xmath564 by condition  .",
    "hence , by application of a chernoff bound ( e.g.  @xcite , page 29 ) we get @xmath565 uniformly for all vertices @xmath566 .    in order to complete the proof we observe that the event @xmath567 implies the event @xmath568 and",
    "therefore we get by application of the union bound @xmath569 for any @xmath570 completing the proof .",
    "in the previous sections we showed that the emergence of the giant component in the @xmath0-type random graph @xmath1 is very similar to the behaviour of the binomial random graph @xmath78 , at least when each row of the expectation matrix is scaled similarly . in theory one therefore could study @xmath571 the @xmath44-type version of @xmath572 assuming that each row of the expectation matrix sums up to approximately @xmath573 .",
    "it is to be expected that in this case we would have @xmath574 and thus also a unique largest component of size @xmath575 proving this for all @xmath576 would be cumbersome at best , since for instance in our proof the bound on the total expected number of offspring of the dual process relies on explicitly calculating a set of generating functions .",
    "therefore let us take another perspective : imposing the row - sum conditions ensures that the perron - frobenius eigenvalue of the offspring expectation matrix @xmath76 is roughly @xmath573 , however it also implies that the corresponding normalised left - eigenvector is not necessarily equal but close to @xmath577 . in this spirit",
    "we could consider @xmath45 for offspring expectation matrices @xmath76 whose perron - frobenius eigenvalue is @xmath573 with the corresponding normalised positive left - eigenvalue @xmath578 and study how the survival probabilities behave asymptotically . the perron - frobenius theory ( c.f .",
    "chapter  v.6 in  @xcite ) provides a heuristic for this since the properly rescaled offspring vector of generation @xmath59 of the corresponding branching process converges almost surely to @xmath578 as @xmath579 under the assumption that it survives .",
    "thus it would be interesting to know whether in this case it is true that @xmath580 for some real function @xmath581 .",
    "we would like to thank oliver riordan for helpful discussions and valuable remarks .",
    "we are also very grateful to the referee for her / his useful suggestions ."
  ],
  "abstract_text": [
    "<S> we determine the asymptotic size of the largest component in the @xmath0-type binomial random graph @xmath1 near criticality using a refined branching process approach . in @xmath1 </S>",
    "<S> every vertex has one of two types , the vector @xmath2 describes the number of vertices of each type , and any edge @xmath3 is present independently with a probability that is given by an entry of the probability matrix @xmath4 according to the types of @xmath5 and @xmath6    we prove that in the _ weakly _ supercritical regime , i.e.  if the `` distance '' to the critical point of the phase transition is given by an @xmath7 with probability @xmath8 the largest component in @xmath1 contains asymptotically @xmath9 vertices and all other components are of size @xmath10 </S>"
  ]
}