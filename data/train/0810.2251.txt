{
  "article_text": [
    "the spectrum of cosmic rays extends over more than eleven orders of magnitude , starting at @xmath0 ev up to energies above @xmath1 ev . above @xmath2 ev they are too infrequently to be detected by balloons or spacecraft .",
    "therefore , the detection techniques used in this energy range are based in the properties of the extensive air showers produced by them in the atmosphere .",
    "there are essentially two techniques for shower detection @xcite : ( @xmath3 ) arrays of surface detectors which measure the lateral distribution of the secondary particles that reach the earth surface and ( @xmath4 ) measurements of the fluorescence light emitted by atmospheric nitrogen excited by charged particles of the shower as they traverse the atmosphere .",
    "air shower and detector simulations play a fundamental role in the study of cosmic rays .",
    "in particular , arrays of surface detectors that do not have fluorescence telescopes to calibrate the energy scale , must resort to simulated data in order to estimate the energy of the primary particle .",
    "furthermore , the primary mass is also obtained comparing experimental data with simulations .",
    "there are several monte carlo programs for air shower simulation , the most used in the literature are aires @xcite , corsika @xcite , and conex @xcite , the latter for a fast simulation of the longitudinal shower development .",
    "since the number of particles produced in a shower can be extremely large , e.g. , @xmath5 for a @xmath1 ev proton shower , the computer processing time and disk space needed are also very large , even if unthinning methods @xcite are used . due to this difficulty it is a common practice to reuse the same shower for generating several events ( see for example @xcite ) .",
    "this practice is more common in simulations that includes surface detectors because , for fluorescence telescopes , very fast monte carlo programs like conex , introduced few years ago , have very fast and efficient algorithms for the generation of longitudinal profiles .    in this work",
    "we study the effects of using multiple repetitions of individual showers , applied to the simulation of detectors , on the evaluation of standard estimators of the expected value , variance , and covariance as well as on histograms corresponding to observable parameters .",
    "we study in detail the effects introduced in the kernel density estimators , which are analytical estimates of the underlying distribution function obtained from a finite sample of events . in cosmic rays physics this technique is used mainly in connection with composition analyses @xcite ; however , it is also extensively used in many different areas of knowledge @xcite to which this work can be directly extended .    as a numerical example",
    ", we discuss the effects of repetitions on samples of the @xmath6 parameter , the atmospheric depth at which an air shower reach its maximum development , obtained with the package conex .",
    "as mentioned in the introduction , we want to study the potential distortions introduced by reusing individual showers to maximize the statistics when simulating the response of a detector .",
    "let us start with the optimum case in which each individual shower is used only once and , therefore , best reproduces reality .",
    "let @xmath7 be a @xmath8-dimensional vector composed by physical observables ( e.g. mass sensitive parameters ) distributed as @xmath9 and let @xmath10 be a random vector , distributed as @xmath11 , that takes into account the effects of the detectors and the corresponding reconstruction method such that , after measuring and reconstructing the empirical information , a vector @xmath12 is obtained .",
    "the distribution function of @xmath13 is the convolution of @xmath9 and @xmath11 , @xmath14 suppose that we have a sample of @xmath15 independent events of the distribution @xmath16 @xmath17 the probability of this configuration can be written as , @xmath18 however , as previously noted , if single showers are recycled and used many times to simulate the response of the detectors , non - independent samples are obtained .",
    "if we use each shower of a sample of @xmath19 independent showers @xmath20 times to simulate the detectors response , the following sample of size @xmath21 is obtained , @xmath22 where the notation used henceforth corresponds to @xmath23 , where @xmath3 is the @xmath24 coordinate of vector @xmath25 , @xmath26 indicates the number of independent shower and @xmath27 the number of detector simulation performed using the @xmath26-@xmath28 shower .",
    "the probability of such a configuration is given by @xmath29      let us consider the average of the @xmath24 coordinate of @xmath13 , @xmath30 , for the realistic case in which each shower is used only once to simulate the detector response , @xmath31 by using eq .",
    "( [ dsamp ] ) it is easy to obtain the very well known expressions for the expected value and variance of @xmath32 , @xmath33&=&e[x^i ] \\\\",
    "% \\label{vx } var[\\bar{x}^i ] & = & \\frac{1}{n}\\ var[x^i ] .",
    "% \\end{aligned}\\ ] ] the usual estimator of the covariance between two random variables is given by , @xmath34 for @xmath35 the estimator of the variance of @xmath30 is obtained , @xmath36 . by using eq .",
    "( [ dsamp ] ) it can be shown that both estimators are non - biased , @xmath37&=&cov[x^i , x^j ] , \\\\",
    "% \\label{es } e[s_{i}^2 ] & = & e[\\hat{c}_{ii}]= var[x^i ] .",
    "% \\end{aligned}\\ ] ]    for the case in which each shower is used several times to simulate the response of the detectors the average of @xmath30 is given by , @xmath38    from eqs .",
    "( [ dsamprep],[avrep ] ) it can be shown that , @xmath39 & = & e[x^i ] , \\\\",
    "% \\label{vavxrep } var[\\bar{x}'^i ] & = & \\frac{1}{mm}\\ var[x^i]+\\frac{m-1}{mm}\\ \\int d\\mathbf{y } d\\mathbf{x}_1 d\\mathbf{x}_2%   \\ ( x^i_1-e[x^i])(x^i_2-e[x^i])\\times \\nonumber \\\\ % & & g(\\mathbf{y})\\ h(\\mathbf{x}_1-\\mathbf{y})\\ h(\\mathbf{x}_2-\\mathbf{y } ) , % \\end{aligned}\\ ] ] which means that using samples obtained by reusing individual showers to simulate the detector response does not introduce any bias when calculating the average .",
    "however the fluctuations of @xmath32 are increased by the generation of an additional term proportional to @xmath40 .",
    "if the response of the detectors and the reconstruction methods do not introduce any bias on the physical magnitudes @xmath7 , i.e. , @xmath41 , the variance of @xmath32 can be written as , @xmath42 & = & \\frac{1}{mm}\\ var[x^i]+\\frac{m-1}{mm}\\ var[y^i ] , \\\\",
    "% \\label{eavxrep2 } % var[\\bar{x}'^i ]   & = & \\frac{1}{m}\\ var[y^i]+\\frac{m-1}{mm}\\ var[z^i ] , % \\end{aligned}\\ ] ] where @xmath43=var[y^i]+var[z^i]$ ] is used to obtain the last equation .",
    "the estimator of the covariance , between @xmath30 and @xmath44 , including multiple repetitions of the individual showers takes the form , @xmath45    the expected value of the covariance estimator is obtained from eqs .",
    "( [ dsamprep ] ) and ( [ covrep ] ) , @xmath46 & = & cov[x^i , x^j]-\\frac{m-1}{mm } \\int d\\mathbf{y } d\\mathbf{x}_1 d\\mathbf{x}_2%   \\ ( x^i_1-e[x^i])(x^j_2-e[x^j])\\times \\nonumber \\\\ % & & g(\\mathbf{y})\\ h(\\mathbf{x}_1-\\mathbf{y})\\ h(\\mathbf{x}_2-\\mathbf{y } ) .",
    "% \\end{aligned}\\ ] ] therefore , as expected , the repetition of individual showers introduces a bias in the covariance estimator because the events are not independent .",
    "the bias results proportional to @xmath40 .",
    "as mentioned before , the expected value of the variance estimator is obtained setting @xmath35 in eq .",
    "( [ ecovxrep ] ) , @xmath47 & = & var[x^i]-\\frac{m-1}{mm } \\int d\\mathbf{y } d\\mathbf{x}_1 d\\mathbf{x}_2%   \\ ( x^i_1-e[x^i ] ) ( x^i_2-e[x^i])\\ g(\\mathbf{y})\\times \\nonumber \\\\ % & & h(\\mathbf{x}_1-\\mathbf{y})\\ h(\\mathbf{x}_2-\\mathbf{y } ) , % \\end{aligned}\\ ] ] which shows that also @xmath48 is now a biased estimator of the variance of @xmath30 .    for the case in which the detectors and reconstruction methods do not introduce any bias eqs .",
    "( [ ecovxrep],[evarxrep ] ) become , @xmath49 & = & cov[x^i , x^j]-\\frac{m-1}{mm}\\ cov[y^i , y^j ] , \\\\",
    "% \\label{evarxrep2 } e[{s'}_i^2 ] & = & var[x^i]-\\frac{m-1}{mm}\\ var[y^i ] .",
    "% \\end{aligned}\\ ] ]      the fluctuations in each bin of a histogram are also modified by the repetition of individual showers . for simplicity",
    "let us consider a one - dimensional histogram of @xmath50 bins , such that a given @xmath51 belongs to the @xmath52 bin if @xmath53 $ ] , where @xmath54 is size of the bin .",
    "the fluctuations in the content @xmath55 of the @xmath52-bin of a histogram follows a binomial distribution .",
    "therefore , the expected value and the variance of @xmath55 are given by , @xmath56 & = & n p_k , \\\\",
    "% \\label{varhisn } var[n_k ] & = & n p_k ( 1-p_k ) , % \\end{aligned}\\ ] ] where @xmath57 with @xmath58 .",
    "the random variable @xmath55 corresponding to a sample of @xmath20 repetitions of each individual shower can be written as @xmath59 , % \\label{nk}\\ ] ] where @xmath60 if @xmath61 and @xmath62 otherwise .",
    "written in this way it is easy to calculate the expected value and variance of @xmath55 , @xmath63 & = & m m\\ p_k , \\\\",
    "% var[n'_k ] & = & m m\\ p_k ( 1-p_k ) + m m",
    "( m-1 ) \\left [ \\int dy\\ g(y ) \\left ( \\int_{t_k}^{t_{k+1 } } dx h(x - y ) \\right)^2 \\right .",
    "% \\label{varhisnrep } & & \\left.-\\left ( \\int dy\\ g(y ) \\int_{t_k}^{t_{k+1 } } dx h(x - y ) \\right)^2 \\right ] , % \\end{aligned}\\ ] ] i.e. , the mean value does not change and the variance has an extra term that increases with @xmath20 .    as an example , let us consider that @xmath64 and @xmath65 are two gaussian distributions centered at zero with @xmath66 and @xmath67 , respectively , i.e. , @xmath68 and @xmath69 , where @xmath70 . \\\\ % \\ ] ] the convolution of two gaussian distributions is also a gaussian , therefore , in this example @xmath71 is also a gaussian centered at zero with @xmath72^{1/2}$ ] , i.e. , @xmath73 .",
    "figure [ gaussfig ] shows the three gaussian distributions under consideration .    ,",
    "@xmath64 and @xmath65 used in the example of the artificial fluctuations introduced on histograms as a result of reusing individual showers to simulate the detector response .",
    "@xmath71 ( solid line ) is the result of the convolution between the other two distribution functions , @xmath64 and @xmath65 .",
    "[ gaussfig],width=377 ]    if the bin size of the histogram is sufficiently small , then @xmath74 is a good approximation for any function @xmath75 considered in the example . combining this approximation with eq .",
    "( [ varhisnrep ] ) and using the gaussian functions @xmath71 , @xmath64 and @xmath65 , the following expression for the variance of @xmath76 is obtained @xmath77 & = & m m\\ g(t_k;0,\\sigma_c ) \\delta t\\ ( 1-g(t_k;0,\\sigma_c ) \\delta t)+\\frac{m m ( m-1 ) \\delta",
    "t^2}{2 \\sqrt{\\pi}}%   \\times \\nonumber \\\\ % \\label{varnex } & & \\left [ \\frac{1}{\\sigma_2}\\ g(t_k;0,\\sqrt{\\sigma_1",
    "^ 2+\\sigma_2 ^ 2/2})-\\frac{1}{\\sigma_c }   \\ g(t_k;0,\\sigma_c/\\sqrt{2 } ) \\right ] . % \\end{aligned}\\ ] ] figure [ histfluct ] shows a contour plot of the ratio @xmath78/\\sigma[n_k]=var[n'_k]^{1/2}/var[n_k]^{1/2}$ ] , i.e. , with ( @xmath79 ) and without ( @xmath80 ) the inclusion of shower repetitions , as a function of @xmath20 and @xmath81 , the lower limit of @xmath52 bin .",
    "the number of independent showers is taken as @xmath82 and @xmath83 . from the figure",
    "it can be seen that the larger the number of repetitions the larger the fluctuations compared to the case @xmath80 .",
    "/\\sigma[n_k]$ ] as a function of the lower limit of @xmath52-bin @xmath81 and the number of repetitions @xmath20 .",
    "the number of independent showers and the bin size are @xmath82 and @xmath83 , respectively .",
    "[ histfluct],width=377 ]      the density estimation technique consist in obtaining an estimator of the underlying density function from a given data sample @xcite .",
    "in one of the most widely used variants of that technique , a density estimator is obtained from a superposition of kernel functions centered at each event of the data sample . for @xmath8-dimensional data the kernel density estimator can be written as , @xmath84 where @xmath13 is a @xmath8-dimensional vector ,",
    "@xmath85 is a symmetric , positively defined matrix ( i.e. , the symmetric , positively defined square - root matrix @xmath86 exists ) and @xmath87 is the kernel function .",
    "the matrix @xmath85 gives the covariance between the different pairs of variables and also the degree of smoothing , i.e. , the width of the kernel function .    from eqs .",
    "( [ dsamp ] ) and ( [ dest ] ) the expected value of the density estimator is obtained , @xmath88 = \\frac{1}{\\sqrt{|h|}}\\ \\int d\\mathbf{x } ' \\ k(h^{-1/2 } \\cdot ( \\mathbf{x}-\\mathbf{x}'))\\ f(\\mathbf{x } ' ) , % \\ ] ] which shows that @xmath89 is a biased estimator of @xmath90 .",
    "there are several criteria to measure the goodness of the density estimator .",
    "in particular the mean square error @xmath91 $ ] is a natural criterion pointwise .",
    "globally , @xmath92 can be integrated over @xmath13 to give the integrated mean square error , @xmath93 .",
    "% \\ ] ] it is easy to see that @xmath94+bias^2(\\mathbf{x})$ ] , where @xmath95=e[\\hat{f}(\\mathbf{x})^2]-e[\\hat{f}(\\mathbf{x})]^2 $ ] and @xmath96-f(\\mathbf{x}))^2 $ ] .",
    "then , @xmath97 by using the taylor expansion and retaining the dominant terms an approximated expression for @xmath98 is obtained , @xmath99 ^ 2 + \\frac{1}{n \\sqrt{|h|}}\\ r(k ) , % \\ ] ] where @xmath100_{ij } & = & \\frac{\\partial^2 f}{\\partial x^i \\partial x^j}(\\mathbf{x } ) , \\\\ % \\label{r } r(a ) & = & \\int d\\mathbf{u}\\ a^2(\\mathbf{u } ) .",
    "% \\end{aligned}\\ ] ] if @xmath101 , where @xmath102 is a small parameter that parametrizes the degree of smoothing , the @xmath98 is written as , @xmath103 ^ 2 + \\frac{r(k)}{n\\ h^d\\ \\sqrt{|v|}}. % \\ ] ] minimizing @xmath98 with respect to @xmath102 , the well known expression of @xmath104 is recovered , @xmath105 where the constant of proportionality depends on @xmath90 , the unknown density function that we want to estimate .",
    "there are several methods to estimate the smoothing parameter @xmath102 from the data sample ( see section [ example ] ) .",
    "let us consider the case in which shower repetitions of individual showers are included .",
    "the density estimator in this case is given by , @xmath106 it can be seen from eqs .",
    "( [ dsamprep ] ) and ( [ destrep ] ) , that the bias does not change when the repetitions are introduced",
    ". however , as expected , the variance increases , @xmath107\\ & \\cong & \\frac{1}{m m\\ \\sqrt{|h|}}\\ r(k)\\ f(\\mathbf{x } ) + \\frac{m-1}{m m } \\times \\nonumber \\\\",
    "% \\label{varrep } & & \\left ( \\int d\\mathbf{y}\\ g(\\mathbf{y } ) h^2(\\mathbf{x}-\\mathbf{y})-f^2(\\mathbf{x})\\right ) ,    % \\end{aligned}\\ ] ] where just the leading terms are retained .",
    "consequently , the @xmath98 takes in this particular case the form @xmath108 ^ 2 + \\nonumber \\\\",
    "% \\label{imsevarbiashrep } & & \\frac{r(k)}{m m\\ h^d\\ \\sqrt{|v|}}+ \\frac{m-1}{m m } \\left ( \\int d\\mathbf{x } d\\mathbf{y}\\ g(\\mathbf{y})%   h^2(\\mathbf{x}-\\mathbf{y } ) -r(f ) \\right ) .",
    "% \\end{aligned}\\ ] ] eq .",
    "( [ imsevarbiashrep ] ) shows that the leading term introduced by the repetitions does not depend on @xmath102 and , therefore , the expression for @xmath104 remains equal to the @xmath80 case .",
    "the only effect introduced by the repetitions of the individual showers is to increase the fluctuations of the estimator for each @xmath13 .",
    "in this section a numerical example that shows the predicted effects introduced by the shower repetitions is given .",
    "for that purpose , air showers simulations are performed using the program conex .",
    "a total of @xmath109 proton showers of primary energy @xmath110 ev and zenith angle @xmath111 are generated .",
    "samples of the parameter @xmath6 obtained from the conex simulations are considered .",
    "a gaussian uncertainty of @xmath112=20 $ ] g @xmath113 and @xmath114 is assumed in order to take into account the detector response and the reconstruction method .",
    "therefore , the distribution function of the reconstructed @xmath6 is given by eq .",
    "( [ fdef ] ) with @xmath115 the distribution function corresponding to the physical fluctuations and @xmath116)$ ] ( see eq .",
    "( [ gauss ] ) ) takes into account the response of the detectors and reconstruction methods .",
    "four sets of 100 samples are considered .",
    "each set of samples is noted as @xmath117 where @xmath19 indicates the independent values of @xmath6 ( obtained from conex ) in each sample and @xmath20 the number of repetitions of each shower , i.e. , the number of times that the gaussian distribution @xmath118)$ ] is sampled for each of the @xmath19 independent values @xmath119 in each individual sample .",
    "therefore , @xmath120 , @xmath121 , @xmath122 and @xmath123 are considered , where @xmath120 and @xmath122 just differ in the different values obtained from the gaussian distribution performed to include the detector response and reconstruction method .",
    "the number of events in each sample , belonging to the different sets , is @xmath124 , the same for all kind of samples considered .",
    "figure [ meanrms ] shows the distributions of the estimators of the average , @xmath125 , and the standard deviation , @xmath126 $ ] , for the sets of samples considered . it can be seen that , as expected , when the repetitions are included , the fluctuations increase and when the number of independent showers increases the fluctuations decrease .",
    "figure [ meanrms ] also shows that , although the distributions of @xmath126 $ ] with repetitions have a tail towards larger values of grammage , which is not present in the corresponding without repetitions , the bias is not statistically significative .",
    "this is consistent with eq .",
    "( [ evarxrep2 ] ) which shows that the expected bias introduced by repetitions in the variance is proportional to @xmath127 for @xmath121 .     and @xmath126 $ ] for the different sets of samples considered . shadowed histograms",
    "correspond to samples without multiple repetitions .",
    "[ meanrms],title=\"fig:\",width=257 ]   and @xmath126 $ ] for the different sets of samples considered . shadowed histograms",
    "correspond to samples without multiple repetitions .",
    "[ meanrms],title=\"fig:\",width=257 ]   and @xmath126 $ ] for the different sets of samples considered . shadowed histograms correspond to samples without multiple repetitions .",
    "[ meanrms],title=\"fig:\",width=257 ]    and @xmath126 $ ] for the different sets of samples considered . shadowed",
    "histograms correspond to samples without multiple repetitions .",
    "[ meanrms],title=\"fig:\",width=257 ]    in order to illustrate the effects of repetitions on the density estimators , one - dimensional gaussian kernels are used to estimate the density function of @xmath6 .",
    "an adaptive bandwidth method , introduced by b. silverman @xcite , is used to obtain better estimates of the density function .",
    "the procedure starts by performing a first estimation of the density function , from a given sample , using a gaussian kernel with fixed smoothing parameter , @xmath128 , % \\label{fest0}\\ ] ] where @xmath15 is the size of the sample , @xmath129 is the standard deviation of the data sample and @xmath130 is the smoothing parameter corresponding to gaussian samples which is used very often in the literature because it gives very good estimates even for non gaussian samples .",
    "the following parameters are calculated by using the estimate obtained from eq .",
    "( [ fest0 ] ) , @xmath131^{-1/2 } , % \\label{lamda}\\ ] ] and then , the final density estimate is obtained from , @xmath132 , % \\label{fest}\\ ] ] where @xmath133 .    for each sample belonging to a given set a density estimate is obtained , therefore , 110 density estimates are obtained for each set of samples considered .",
    "figure [ estimates ] shows the mean value and the one sigma region obtained from the density estimates of each set .",
    "it can be seen that the mean values corresponding to samples with or without repetitions are very similar , which is consistent with the result obtained in subsection [ densest ] . also , as expected from eq .",
    "( [ varrep ] ) , the fluctuations corresponding to sets including repetition are larger and comparing the results obtained for @xmath121 and @xmath123 we see that the fluctuations in the latter case are smaller due to the smaller number of repetitions .    , title=\"fig:\",width=257 ] , title=\"fig:\",width=257 ]",
    "in this work we study the effects of recycling individual cosmic ray showers to simulate the detector response , which is a common practice in monte carlo simulations at the highest energies .",
    "we find that the standard estimators of the expected value , variance and covariance are modified .",
    "in particular , the average remains as a non - biased estimator of the expected value but the fluctuations are increased . for the standard estimators of the variance and covariance",
    "a bias proportional to @xmath40 appears when repetitions are included .",
    "besides , as in the case of the average , the fluctuations of both estimators are increased .",
    "we also study the effects of repetitions in histograms , where we find that the mean value of the bin content is unchanged but the fluctuations are in general larger , depending on the bin considered , and increase with the number of repetitions .    finally , we study the effects introduced by repetition in the kernel density estimators obtained from finite samples .",
    "we find again that the expected value of the estimator is unchanged , i.e. , the bias takes the same form .",
    "however , the pointwise fluctuations are increased and become more important as the ratio @xmath40 increases .",
    "the authors acknowledge the support of unam through papiit grant in115707 and conacyt through its research grants and sni programs .",
    "ads is supported by a postdoctoral grant from the unam ."
  ],
  "abstract_text": [
    "<S> the study of high energy cosmic rays requires detailed monte carlo simulations of both , extensive air showers and the detectors involved in their detection . in particular , the energy calibration of several experiments is obtained from simulations . </S>",
    "<S> also , in composition studies simulations play a fundamental role because the primary mass is determined by comparing experimental with simulated data . at the highest energies the detailed simulation of air showers is very costly in processing time and disk space due to the large number of secondary particles generated in interactions with the atmosphere . </S>",
    "<S> therefore , in order to increase the statistics , it is quite common to recycle single showers many times to simulate the detector response . as a result , </S>",
    "<S> the events of the monte carlo samples generated in this way are not fully independent . in this work </S>",
    "<S> we study the artificial effects introduced by the multiple use of single air showers for the detector simulations . in particular , we study in detail the effects introduced by the repetitions in the kernel density estimators which are frequently used in composition studies .    </S>",
    "<S> and    cosmic rays , air showers , detector simulations </S>"
  ]
}