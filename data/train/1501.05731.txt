{
  "article_text": [
    "consider any system of chemical reactions , in which certain molecule types catalyse reactions and where there is a pool of simple molecule types available from the environment ( a ` food source ' ) .",
    "one can then ask whether , within this system , there is a subset of reactions that is both self - sustaining ( each molecule can be constructed starting just from the food source ) and collectively autocatalytic ( every reaction is catalysed by some molecule produced by the system or present in the food set ) @xcite,@xcite .",
    "this notion of ` self - sustaining and collectively autocatalytic ' needs to be carefully formalised ( we do so below ) , and is relevant to some basic questions such as how biochemical metabolism began at the origin of life @xcite , @xcite , @xcite .",
    "a simple mathematical framework for formalising and studying such self - sustaining autocatalytic networks has been developed ",
    "so - called ` raf ( reflexively - autocatalytic and f - generated ) theory ' .",
    "this theory includes an algorithm to determine whether such networks exists within a larger system , and for classifying these networks ; moreover , the theory allows us to calculate the probability of the formation of such systems within networks based on the ligation and cleavage of polymers , and a random pattern of catalysis .",
    "however , this theory relies heavily on the system being closed and finite . in certain settings , it is useful to consider polymers of arbitrary length being formed ( e.g. in generating the membrane for a protocell @xcite ) . in these and other unbounded chemical systems , interesting complications arise for raf theory , particularly where the catalysis of certain reactions is possible only by molecule types that are of greater complexity / length than the reactants or product of the reactions in question . in this paper",
    ", we extend earlier raf theory to deal with unbounded chemical reaction systems . as in some of our earlier work",
    ", our analysis ignores the dynamical aspects , which are dealt with in other frameworks , such as ` chemical organisation theory ' @xcite ; here we concentrate instead on just the pattern of catalysis and the availability of reactants .      in this paper ,",
    "a _ chemical reaction system _ ( crs ) consists of ( i ) a set @xmath0 of molecule types , ( ii ) a set @xmath1 of reactions , ( iii ) a pattern of catalysis @xmath2 that describes which molecule(s ) catalyses which reactions , and ( iv ) a distinguished subset @xmath3 of @xmath0 called the _ food set_.",
    "we will denote a crs as a quadruple @xmath4 , and encode the pattern of catalysis @xmath2 by specifying a subset of @xmath5 so that @xmath6 precisely if molecule type @xmath7 catalyses reaction @xmath8 .",
    "see fig .",
    "[ fig1 ] for a simple example ( from @xcite ) .",
    "and seven reactions .",
    "dashed arrows indicate catalysis ; solid arrows show reactants entering a reaction and products leaving . in this crs",
    "there are exactly four rafs ( defined below ) , namely @xmath9 , @xmath10 , @xmath11 , and @xmath12 . ]    in certain applications , @xmath0 often consist of  or at least contain  a set of polymers ( sequences ) over some finite alphabet @xmath13 ( i.e. chains @xmath14 , @xmath15 , where @xmath16 ) , as in fig .",
    "[ fig1 ] ; such polymer systems are particularly relevant to rna or amino - acid sequence models of early life",
    ". reactions involving such polymers typically involve cleavage and ligation ( i.e. cutting and/or joining polymers ) , or adding or deleting a letter to an existing chain .",
    "notice that if no bound is put on the maximal length of the polymers , then both @xmath0 and @xmath1 are infinite for such networks , even when @xmath17 .",
    "in this paper we do not necessarily assume that @xmath0 consists of polymers , or that the reactions are of any particular type .",
    "thus , a reaction can be viewed formally as an ordered pair @xmath18 consisting of a multi - set @xmath19 of elements from @xmath0 ( the reactants of @xmath8 ) and a multi - set @xmath20 of elements of @xmath0 ( the products of @xmath8 ) ; but we will mostly use the equivalent and more conventional notation of writing a reaction in the form : @xmath21 where the @xmath22 s",
    "( reactants of @xmath8 ) and @xmath23 s ( products of @xmath8 ) are elements of @xmath0 , and @xmath24 ( e.g. @xmath25 and @xmath26 are reactions ) .    in this paper , we extend our earlier analysis of rafs to the general ( finite or infinite ) case and find that certain subtleties arise that are absent in the finite case",
    ". we will mostly assume the following conditions ( a1 ) and ( a2 ) , and sometimes also ( a3 ) .",
    "* @xmath3 is finite ; * each reaction @xmath27 has a finite set of reactants , denoted @xmath28 , and a finite set of products , denoted @xmath29 ; * for any given finite set @xmath30 of molecule types , there are only finitely many reactions @xmath8 with @xmath31 .    given a subset @xmath32 of @xmath1",
    ", we say that a subset @xmath33 of molecule types is _ closed _ relative to @xmath32 if @xmath34 satisfies the property @xmath35 in other words , a set of molecule types is closed relative to @xmath32 if every molecule that can be produced from @xmath34 using reactions in @xmath32 is already present in @xmath34 .",
    "notice that the full set @xmath0 is itself closed .",
    "the _ global closure _ of @xmath3 relative to @xmath32 , denoted here as @xmath36 , is the intersection of all closed sets that contain @xmath3 ( since @xmath0 is closed , this intersection is well defined ) .",
    "thus @xmath36 is the unique minimal set of molecule types containing @xmath3 that is closed relative to @xmath32 .",
    "we can also consider a _ constructive closure _ of @xmath3 relative to @xmath32 , denoted here as @xmath37 , which is union of the set @xmath3 and the set of molecule types @xmath7 that can be obtained from @xmath3 by carrying out any finite sequence of reactions from @xmath32 where , for each reaction @xmath8 in the sequence , each reactant of @xmath8 is either an elements of @xmath3 or a product of a reaction occurring earlier in the sequence , and @xmath7 is a product of the last reaction in the sequence .",
    "note that @xmath36 always contains @xmath37 ( and these two sets coincide when the crs is finite ) but , for an infinite crs , @xmath37 can be a strict subset of @xmath36 , even when ( a1 ) holds . to see this ,",
    "consider the system @xmath38 where @xmath39 , @xmath40 , where @xmath41 is defined as follows : @xmath42 @xmath43 @xmath44 then @xmath45 . in this example , notice that @xmath46 has infinitely many reactants , which violates ( a2 ) .",
    "by contrast , when ( a2 ) holds , we have the following result .",
    "[ lem1 ] suppose that ( a2 ) holds",
    ". then @xmath47 .",
    "moreover , under ( a1 ) and ( a2 ) , if @xmath32 is countable , then this ( common ) closure of @xmath3 relative to @xmath32 is countable also .",
    "suppose the condition of lemma  [ lem1 ] holds but that @xmath37 is not closed ; we will derive a contradiction .",
    "lack of closure means there is a molecule @xmath7 in @xmath48 which is the product of some reaction @xmath49 that has all its reactants in @xmath37 . by ( a2 ) , the set of reactants of @xmath8 is finite , so we may list them as @xmath50 , and , by the definition of @xmath37 , for each @xmath51 , either @xmath52 or there is a finite sequence @xmath53 of reactions from @xmath32 that generates @xmath54 starting from reactants entirely in @xmath3 and using just elements of @xmath3 or products of reactions appearing earlier in the sequence @xmath53 . by concatenating these sequences ( in any order ) and appending @xmath8 at the end , we obtain a finite sequence of reactions that generate @xmath7 from @xmath3 , which contradicts the assumption that @xmath37 is not closed . if follows that @xmath37 is closed relative to @xmath32 , and since it is clearly a minimal set containing @xmath3 that is closed relative to @xmath32 , it follows that @xmath55 . that @xmath37 is countable under ( a1 ) and ( a2 ) follows from the fact that any countable union of finite sets is countable .",
    "@xmath56    in view of lemma  [ lem1 ] ,",
    "whenever ( a2 ) holds , we will henceforth denote the ( common ) closure of @xmath3 relative to @xmath32 as @xmath57 .",
    "* definition [ raf , and related concepts ] * suppose we have a crs @xmath58 , which satisfies condition ( a2 ) .",
    "an raf for @xmath59 is a non - empty subset @xmath32 of @xmath1 for which    * for each @xmath60 , @xmath61 ; and * for each @xmath60 , at least one molecule type in @xmath57 catalyses @xmath8 .",
    "in words , a non - empty set @xmath32 of reactions forms an raf for @xmath59 if , for every reaction @xmath8 in @xmath32 , each reactant of @xmath8 and at least one catalyst of @xmath8 is either present in @xmath3 or able to be constructed from @xmath3 by using just reactions from within the set @xmath32 .",
    "an raf @xmath32 for @xmath59 is said to be a _",
    "finite raf _ or an _ infinite raf _ depending on whether or not @xmath62 is finite or infinite .",
    "the concept of an raf is a formalisation of a ` collectively autocatalytic set ' , pioneered by stuart kauffman @xcite and @xcite .",
    "since the union of any collection of rafs is also an raf , any crs that contains an raf necessarily contains a unique maximal raf .",
    "irrraf _ is an ( infinite or finite ) raf that is minimal ",
    "i.e. it contains no raf as a strict subset .",
    "in contrast to the uniqueness of the maximal raf , a finite crs can have exponentially many irrrafs @xcite .",
    "the raf concept needs to be distinguished from the stronger notion of a _ constructively autocatalytic and f - generated _ ( caf ) set @xcite which requires that @xmath32 can be ordered @xmath63 so that all the reactants and at least one catalyst of @xmath64 are present in @xmath65 for all @xmath66 ( in the initial case where @xmath67 , we take @xmath68 ) .",
    "this condition essentially means that in a caf , a reaction can only proceed if one of its catalysts is already available , whereas an raf could become established by allowing one or more reactions @xmath8 to proceed uncatalysed ( presumably at a much slower rate ) so that later , in some chain of reactions , a catalyst for @xmath8 is generated , allowing the whole system to ` speed up ' .",
    "notice that although the crs in fig .",
    "[ fig1 ] has four rafs it has no caf .    , and @xmath69 are products ) , reactions are hollow squares , and dashed arrows indicate catalysis . ]",
    "the raf concept also needs to be distinguished from the weaker notion of a _ pseudo - raf _",
    "@xcite , which replaces condition ( ii ) with the relaxed condition :    _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ ( ii)@xmath70 : for all @xmath60 , there exists @xmath71 or @xmath72 for some @xmath60 such that @xmath6 . _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _    in other words , a pseudo - raf that fails to be an raf is an autocatalytic system that could continue to persist once it exists , but it can never form from just the food set @xmath3 , since it is not @xmath3-generated .    these two alternatives notions to rafs are illustrated ( in the finite setting ) in fig .",
    "[ fig1b ] .",
    "notice that every caf is an raf and every raf is a pseudo - raf , but these containments are strict , as fig",
    ".  [ fig1b ] shows .    while the notion of a caf may seem reasonable , it is arguably too conservative in comparison to an raf , since a reaction can still proceed if no catalyst is present , albeit it at a much slower rate , allowing the required catalyst to eventually be produced .",
    "however relaxing the raf definition further to a pseudo - raf is problematic ( since a reaction can not proceed at all , unless all its reactants are present , and so such a system can not arise spontaneously just from @xmath3 ) .",
    "this , along with other desirable properties of rafs ( their formation requires only low levels of catalysis in contrast to cafs @xcite ) , suggests that rafs are a reasonable candidate for capturing the minimal necessary condition for self - sustaining autocatalysis , particularly in models of the origin of metabolism .      as in the finite crs setting ,",
    "the union of all rafs is an raf , so any crs that contains an raf has a unique maximal one .",
    "it is easily seen that an infinite crs that contains an raf need not have a maximal finite raf , even under ( a1)(a3 ) , but in this case , the crs would necessarily also contain an infinite raf ( the union of all the finite rafs ) .",
    "a natural question is the following : if an infinite crs contains an infinite raf , does it also contain a finite one ?",
    "it is easily seen that even under conditions ( a1 ) and ( a2 ) , the answer to this last question is ` no ' .",
    "we provide three examples to illustrate different ways in which this can occur .",
    "this is in contrast to cafs , for which exactly the opposite holds : if a crs contains an infinite caf , then it necessarily contains a sequence of finite ones .",
    "moreover , two of the infinite rafs in the following example contain no irrrafs ( in contrast to the finite case , where every raf contains at least one irrraf ) .",
    "* example 1 : * let @xmath73 , @xmath74 and @xmath75 .",
    "let @xmath76 .",
    "we will specify particular crs s by describing @xmath77 , and the pattern of catalysis as follows .",
    "* @xmath78 has a reaction @xmath79 for each @xmath80 and @xmath64 is catalysed by @xmath81 for each @xmath82 .",
    "* @xmath83 has a reaction @xmath84 \\rightarrow x_i)$ ] for each @xmath80 and @xmath64 is catalysed by @xmath81 for each @xmath82 .",
    "* @xmath85 has the same reactions as @xmath83 but @xmath64 is now catalysed by every @xmath86 .",
    "[ figx ] illustrates the three crs s .",
    "each of @xmath87 satisfy ( a1 ) and ( a2 ) , but only @xmath78 satisfies ( a3 ) .",
    "all three crss contain infinite rafs , but no finite raf , and no caf .",
    "more precisely :    * @xmath78 has @xmath1 as its unique raf ( which is therefore an irrraf ) . *",
    "the rafs of @xmath83 consist precisely of all subsets of @xmath88 for some @xmath89 .",
    "thus @xmath83 has a countably infinite number of rafs but no irrraf . *",
    "the rafs of @xmath85 consist precisely of all infinite subsets of @xmath1 .",
    "thus , the set of rafs for @xmath85 in uncountably infinite , and it contains no irrraf .",
    "in this section , we assume that both ( a1 ) and ( a2 ) hold . given a crs @xmath58 , consider the following nested decreasing sequence of reactions : @xmath90 defined by @xmath91 and for each @xmath80 : @xmath92 thus , @xmath93 is obtained from @xmath94 by removing any reaction that fails to have either all its reactants or at least one catalyst in the closure of @xmath3 relative to @xmath94 .",
    "let @xmath95 .",
    "it is easily shown that any raf @xmath32 present in @xmath59 is necessarily a subset of @xmath96 ( since @xmath97 for all @xmath82 by induction on @xmath98 ) .",
    "thus if @xmath99 then @xmath59 does not have an raf . in the finite case",
    "there is a strong converse ",
    "if @xmath100 then @xmath59 has an raf , and @xmath96 is the unique maximal raf for @xmath59 ( this is the basis for the ` raf algorithm ' @xcite and @xcite ) .",
    "however , in contrast , this result can fail for an infinite crs , as we now show with a simple example , which also satisfies ( a1)(a3 ) .",
    "* example 2 : * consider the following infinite crs , @xmath101 , where @xmath74 , and @xmath102 where @xmath103 ( this set can be thought of as all polymers of @xmath104 ) .",
    "the reaction set is @xmath105 , where , for all @xmath106 @xmath107 @xmath108 the pattern of catalysis is defined as follows : @xmath109 catalyses @xmath110 and @xmath111 catalyses @xmath112 , and for all @xmath80 @xmath113 catalyses @xmath64 and @xmath54 catalyses @xmath114 .",
    "this crs is illustrated in fig  [ figy ] .     which has no raf even though @xmath115 is non - empty ( equal to @xmath116 ) .",
    "this crs satisfies ( a1)(a3 ) and ( a5 ) , but not ( a4 ) . ]",
    "notice that @xmath117 satisfies ( a1 ) , ( a2 ) and ( a3 )",
    ". however , if we construct the sequence @xmath94 described above , then as the sole catalyst ( @xmath111 ) of @xmath112 is neither in the food set , nor generated by any other reaction , it follows that @xmath112 will be absent from @xmath118 , and so @xmath119 will also be absent from @xmath120 ( since the only catalyst of @xmath119 is produced by @xmath112 ) . continuing in this way",
    ", we obtain @xmath121 , but this set is not an raf , since the sole catalyst @xmath109 of @xmath110 does not lie lie in the closure of @xmath3 relative to @xmath122  it was produced by the @xmath123 reactions and in these have all disappeared in the limit ; moreover it is clear that no subset of @xmath117 is an raf .",
    "@xmath56    thus , we require slightly stronger hypotheses than just ( a1)(a3 ) in order to ensure that @xmath59 has an raf when @xmath100 .",
    "this , is provided by the following result .",
    "[ infp ] let @xmath58 satisfy ( a1 ) and ( a2 ) .",
    "the following then hold :    * @xmath96 contains every raf for @xmath59 ; in particular , if @xmath99 , then @xmath59 has no raf . *",
    "suppose that @xmath59 satisfies both of the following further conditions : * * @xmath124 , for the sequence @xmath94 defined in ( [ r1eqx ] ) .",
    "* * each reaction @xmath27 is catalysed by only finitely many molecule types .",
    "+ then @xmath59 contains an raf if and only if @xmath96 is non - empty ( in which case , @xmath96 is the maximal raf for @xmath59 ) .    before proving this result",
    ", we pause to make some comments and observations concerning the new conditions ( a4 ) and ( a5 ) .",
    "regarding condition ( a4 ) , containment in the opposite direction is automatic ( by virtue of the fact that @xmath125 for any function @xmath104 and sets @xmath126 ) , so ( a4 ) amounts to saying that the two sets described are equal .",
    "notice also that @xmath117 in example 2 ( fig .",
    "[ figy ] ) satisfies ( a5 ) but it violates ( a4 ) , as it must , since @xmath117 does not have an raf . to see how @xmath117 violates ( a4 ) ,",
    "notice that @xmath127 , while @xmath128 .",
    "condition ( a5 ) is quite strong , but proposition  [ infp ] is no longer true if it is removed . to see why , consider the following modification @xmath129 of @xmath117 in which the only product of @xmath130 ( for @xmath80 ) is @xmath54 , and @xmath54 catalyses @xmath110 for all @xmath80 ( in addition to @xmath114 ) , as shown in fig .",
    "then @xmath131 so ( a4 ) holds ; however @xmath132 which , as before , is not an raf for @xmath129 since there is no catalyst of @xmath110 in @xmath133 .",
    "notice that ( a5 ) fails for @xmath129 since @xmath110 has infinitely many catalysts .",
    "nevertheless , it is possible to obtain a result that dispenses with ( a5 ) at the expense of a strengthening ( a4 ) , which we will do shortly in proposition  [ infpro ] .     which has no raf even though @xmath134 is non - empty ( equal to @xmath116 ) .",
    "this crs satisfies ( a1)(a3 ) and ( a4 ) , but not ( a5 ) , nor ( a4)@xmath70 . ]",
    "_ proof of proposition  [ infp ] : _ suppose @xmath32 is any raf for @xmath59 .",
    "induction on @xmath135 shows that @xmath97 for all @xmath98 , so that @xmath136 ; in particular , if @xmath99 , then @xmath59 has no raf .",
    "the proof of part ( ii ) of proposition  [ infp ] relies on a simple lemma .",
    "[ simlem ] suppose that @xmath137 is any nested decreasing sequence of subsets and @xmath20 is a finite set for which @xmath138 for all @xmath82 .",
    "then some element of @xmath20 is present in every set @xmath139 .",
    "_ proof of lemma : _ suppose , to the contrary , that for every element @xmath140 , there is some set @xmath141 in the sequence that fails to contain @xmath142 ( we will show this is not possible by deriving a contradiction ) .",
    "let @xmath143 . since @xmath20 is a finite set",
    ", @xmath144 is a finite integer , and since the sequence @xmath137 is a nested decreasing sequence , it follows that @xmath145 , a contradiction .",
    "@xmath56    returning to the proof of part ( ii ) , suppose that @xmath100 ; we will show that @xmath96 is an raf for @xmath59 ( and so , by part ( i ) , the unique maximal raf for @xmath59 ) .",
    "for @xmath146 for each @xmath98 ( otherwise @xmath8 would not be an element of @xmath93 and thereby fail to lie in @xmath96 ) .",
    "thus @xmath147 by ( a4 ) .",
    "it remains to show that @xmath8 is catalysed by at least one element of @xmath148 .",
    "let @xmath149 . by ( a5 )",
    ", @xmath150 is finite .",
    "moreover , for each @xmath135 , @xmath151 ( otherwise @xmath8 would fail to be in @xmath93 and thereby not lie in @xmath96 ) . by lemma  [ simlem ] ,",
    "there is a molecule type @xmath152 that lies in @xmath153 and this latter set is contained in @xmath154 by ( a4 ) . in summary",
    ", every reaction in @xmath96 has all its reactants and at least one catalyst present in @xmath148 and so @xmath96 is an raf for @xmath59 , as claimed .",
    "@xmath56    suppose we now remove condition ( a5 ) in proposition  [ infp ] . in this case , by a slight strengthening of ( a4 )",
    ", we obtain a positive result ( proposition  [ infpro ] ) . to describe this",
    ", we first require a further definition . recall that @xmath2 is the set of pairs @xmath155 where molecule type @xmath7 catalyses reaction @xmath8 .",
    "given a subset @xmath156 of @xmath2 , let @xmath157 = \\{r \\in { { \\mathcal r } } : ( x , r ) \\in c ' \\mbox { for some } x\\in x\\}.\\ ] ] define a nested decreasing sequence of subsets @xmath158 by @xmath159 and for each @xmath82 , @xmath160}(f)\\},\\ ] ] and let @xmath161 .    [ infpro ]",
    "let @xmath59 satisfy ( a1 ) and ( a2 ) , as well as the following property : @xmath162}(f ) \\subseteq { \\rm cl}_{r[c_\\infty]}(f ) , \\mbox { for the sequence $ c_i$ defined in ( \\ref{cieqx})}.\\ ] ] then @xmath59 has an raf if and only if @xmath163 , in which case @xmath164 $ ] is a maximal raf for @xmath59 .",
    "suppose that @xmath165 .",
    "then for any @xmath166 $ ] there exists @xmath167 such that @xmath168 .",
    "it follows that @xmath169 for all @xmath98 . by definition",
    ", this means that @xmath170}(f)$ ] for all @xmath98 , and so @xmath171}(f).$ ] now , by ( a4)@xmath70 , this means that @xmath172}(f)$ ] . in summary , every reaction in the non - empty set @xmath164 $ ] has all its reactants and at least one catalyst in the closure of @xmath3 with respect to @xmath164 $ ] and so @xmath164 $ ] forms an raf for @xmath59 .",
    "conversely , suppose that @xmath59 contains an raf @xmath32 ; we will show that @xmath165 . for each @xmath49 ,",
    "select a catalyst @xmath173 for @xmath8 for which @xmath174 .",
    "let @xmath175 .",
    "we use induction on @xmath98 to show that @xmath176 for all @xmath135 .",
    "clearly @xmath177 , so suppose that @xmath176 and select an element @xmath178 .",
    "by definition , @xmath179}(f ) \\subseteq   { \\rm cl}_{{{\\mathcal r}}[c_i]}(f),\\ ] ] which means that @xmath180 , establishing the induction step .",
    "it follows that @xmath181 and so @xmath165 as claimed .",
    "@xmath56    notice that , just as for condition ( a4 ) , the condition ( a4)@xmath70 is equivalent to requiring that the two sets described be identical . notice also that , although condition ( a4 ) applies to the crs @xmath182 , condition ( a4)@xmath70 fails , since @xmath183 and so @xmath184}(f ) = { { \\mathcal f}}= \\{f , ff , fff , \\ldots\\}$ ] , while @xmath185}(f)$ ] for all @xmath82 , and so @xmath186}$ ] is not a subset of @xmath187}(f)$ ] .    in summary ,",
    "a single application of @xmath188 allows us to determine when @xmath59 has an raf , provided the additional condition ( a4)@xmath70 holds .",
    "example 2 showed that some additional assumption of this type is required , however one could also consider other approaches for determining the existence rafs that do not assume a further condition like ( a4)@xmath70 , but instead iterate the map @xmath188 .",
    "in other words , consider the following ` higher level ' sequence of subsets of @xmath1 : @xmath189 where @xmath190 for each @xmath191 .",
    "again , this forms a decreasing nested sequence of subsets of @xmath1 and so we can consider the set : @xmath192    in the example above for @xmath117 where @xmath100 , notice that @xmath193 ( and so @xmath194 ) .",
    "it follows from proposition  [ infp ] that if @xmath195 for any @xmath196 then @xmath59 has no raf .",
    "however , just because @xmath197 , this does not imply that @xmath59 contains an raf as the next example shows .",
    "* example 3 : * consider the infinite crs @xmath198 which is obtained by taking a countably infinite number of ( reaction and molecule disjoint ) copies of @xmath117 ( from example 2 ) and letting the molecule type @xmath109 in the @xmath98-th copy of @xmath117 play the role of the molecule @xmath111 in the @xmath199th copy of @xmath117 .",
    "in addition , let @xmath46 be the reaction @xmath200 ( where @xmath201 is an additional molecule ) catalysed by the @xmath109-products of all the copies of @xmath117 .",
    "now @xmath202 contains all but the first @xmath203 copies of @xmath117 , plus @xmath46 .",
    "consequently , @xmath204 but , as before , this is not an raf .",
    "notice , however that this example violates condition ( a3 ) .",
    "we have seen from the last section that applying @xmath188 , even infinitely often , does not seem to provide a way to determine whether a crs possesses an raf .",
    "however , in most applications , the main interest will generally be in finite rafs . from the earlier theory it is clear that if @xmath202 is finite for some integer @xmath196 then any rafs that may exist for @xmath59 are necessarily finite , and finite in number .",
    "moreover , if @xmath205 and this set is finite , then @xmath202 is the unique ( and necessarily finite ) maximal raf for @xmath59 .",
    "however , it is also quite possible that a crs might contain both finite and infinite rafs , and in this section we describe a characterisation of when an raf contains a finite raf .    given a crs @xmath59 define a sequence @xmath206 of subsets of @xmath1 as follows : @xmath207 @xmath208 in words , @xmath209 is the set of reactions that have all their reactants in @xmath3 , and for @xmath80 @xmath94 is the set of reactions for which each reactant is either an element of @xmath3 or products of some reaction in @xmath210 for @xmath211 .",
    "[ finiteraf ] suppose a crs @xmath59 satisfies ( a1)(a3 ) .",
    "let @xmath212 for all @xmath135 , where @xmath213 is as defined above .",
    "then :    * @xmath214 is a nested increasing sequence of finite sets .",
    "* @xmath59 has a finite raf if and only if @xmath215 for some @xmath135 . *",
    "if @xmath216 for some @xmath98 , then @xmath217 is a finite raf for @xmath59 for all @xmath218 .",
    "* every finite raf for @xmath59 is contained in @xmath219 for some @xmath220 .    by ( a1 ) and ( a3 ) , it follows that @xmath221 is finite , and , by induction , that @xmath213 is finite for all @xmath80 . moreover , if @xmath222 then @xmath223 and so @xmath224 ( i.e. @xmath225 ) and so the sets @xmath226 form an increasing nested sequence .",
    "this establishes ( i ) . for parts ( ii ) and",
    "( iii ) , suppose that @xmath59 contains a finite raf @xmath32 .",
    "since ( a1 ) and ( a2 ) hold , we can apply lemma  [ lem1 ] to deduce that every reaction @xmath49 is an element of @xmath213 for some @xmath98 .",
    "thus , since @xmath32 is finite , and the sequence @xmath213 is a nested increasing sequence of finite sets , it follows that @xmath227 for some fixed @xmath203 , in which case @xmath228 .",
    "conversely , if @xmath216 , then it is clear from the definitions that @xmath229 is an finite raf for @xmath59 ; moreover , so also is @xmath217 for all @xmath230 .",
    "part ( iv ) also follows easily from the definitions , since if @xmath32 is a finite raf for @xmath59 then @xmath231 for some @xmath232 , and since @xmath32 is finite we have @xmath233 and so @xmath234 .",
    "this completes the proof .",
    "@xmath56    theorem  [ finiteraf ] provides an algorithm to search for finite rafs in any infinite crs that satisfies ( a1)(a3 ) .",
    "given @xmath59 , construct @xmath221 and run the ( standard ) raf algorithm @xcite and @xcite on @xmath221 .",
    "if it fails to find an raf , then construct @xmath235 and run the algorithm on this set , and continue in the same manner .",
    "if @xmath59 contains a finite raf , then this process is guaranteed to find it , however , there is no assurance in advance of how long this might take ( if not constraint is placed on the size of the how large the smallest finite raf might be ) .",
    "finally , we show how proposition  [ infpro ] can be reformulated more abstractly in order to makes clear the underlying mathematical principles ; the added generality may also be useful for settings beyond chemical reaction systems .",
    "this uses the notion of `` @xmath236-compatibility '' from @xcite , which we now explain .",
    "suppose we have an arbitrary set @xmath30 and an arbitrary partially ordered set @xmath34 , together with some functions @xmath237 consider the function @xmath238 , where @xmath239 we are interested in the non - empty subsets of @xmath30 fixed points of @xmath240 , particularly , when @xmath104 is _ monotonic _",
    "( i.e. , where @xmath241 ) . a subset @xmath19 of @xmath30 is said to be _",
    "@xmath236-compatible _ if @xmath19 is non - empty and @xmath242 .",
    "the notion of an raf can be captured in this general setting as follows .",
    "given a crs @xmath243 satisfying ( a2 ) , take @xmath244 and @xmath245 ( partially ordered by set inclusion ) , and define @xmath246 as follows : @xmath247}(f ) \\mbox { and } g((x , r ) ) = \\{x\\ } \\cup \\rho(r),\\ ] ] where , as earlier , @xmath248 $ ] is the set of reactions @xmath27 for which there is some @xmath249 with @xmath250 .",
    "notice that @xmath104 is monotonic and when @xmath59 is finite , the set @xmath251 can be computed in polynomial time in the size of @xmath59 .",
    "[ lemcom ] suppose we have a crs @xmath59 satisfying ( a2 ) , and with @xmath104 and @xmath252 defined as in ( [ fgeq ] ) .",
    "if @xmath19 is @xmath236-compatible , then @xmath248 $ ] is an raf for @xmath59 .",
    "conversely , if @xmath32 is an raf for @xmath59 , then a @xmath236-compatible set @xmath19 exists with @xmath248 = { { \\mathcal r}}'$ ] . in particular , @xmath59 has an raf if and only if @xmath30 contains a @xmath236-compatible set .",
    "if @xmath19 is @xmath236-compatible subset of @xmath30 , then for @xmath253 $ ] , each reaction @xmath27 has at least one molecule type @xmath167 for which @xmath254 .",
    "@xmath236-compatibility ensures that @xmath255 , in other words , @xmath256 for some catalyst @xmath7 of @xmath8 .",
    "this holds for every @xmath49 , so @xmath32 is an raf for @xmath59 .",
    "conversely , if @xmath32 is an raf , then for each reaction @xmath49 , we can choose an associated catalyst @xmath173 so that @xmath257",
    ". then @xmath258 is a @xmath236-compatible subset of @xmath30 , with @xmath248 = { { \\mathcal r}}'$ ] . @xmath56    the problem of finding a @xmath236-compatible set ( if one exists ) in a general setting ( arbitrary @xmath30 , and @xmath34 , not necessarily related to chemical reaction networks ) can be solved in general polynomial time when @xmath30 is finite and @xmath104 is monotonic and computable in finite time .",
    "this provides a natural generalization of the classical raf algorithm . in @xcite",
    ", we showed how other problems ( including a toy problem in economics ) could by formulated within this more general framework .",
    "however , if we allow the set @xmath30 to be infinite , then monotonicity of @xmath104 needs to be supplemented with a further condition on @xmath104 . we will consider a condition ( ` @xmath201-continuity ' ) , which generalizes ( a4)@xmath70 , and that applies automatically when @xmath30 is finite",
    "we say that @xmath259 is ( weakly ) @xmath201-continuous if , for any nested descending chain @xmath260 of sets , we have : @xmath261 recall that an element in a partially ordered set need not have a greatest lower bound ( glb ) ; but if it does , it has a unique one . notice that when @xmath30 is finite , this property holds trivially , since then @xmath262 for the last set @xmath263 in the ( finite ) nested chain .    for a subset @xmath19 of @xmath30 and @xmath264 , define @xmath265 to be the result of applying function @xmath240 iteratively @xmath203 times starting with @xmath19 .",
    "thus @xmath266 and for @xmath264 , @xmath267 . taking the particular interpretation of @xmath104 and @xmath252 in ( [ fgeq ] ) ,",
    "the sequence @xmath268 is nothing more than the sequence @xmath269 from ( [ cieqx ] ) .",
    "notice that the sequence @xmath270 is a nested decreasing sequence of subsets of @xmath30 , and so we may define the set : @xmath271 which is a ( possibly empty ) subset of @xmath30 ( in the setting of proposition  [ infpro ] , @xmath272 ) .    given ( finite or infinite ) sets @xmath273 , where @xmath34 is partially ordered , together with functions @xmath274 , it is routine to verify that the following properties hold :    * the @xmath236-compatible subsets of @xmath30 are precisely the non - empty subsets of @xmath30 that are fixed points of @xmath240 ;",
    "* if @xmath104 is monotonic then @xmath275 contains all @xmath236-compatible subsets of @xmath30 ; in particular , if @xmath276 , then there is no @xmath236compatible subset of @xmath30 . *",
    "if @xmath104 is @xmath201-continuous then @xmath275 is @xmath236-compatible , provided it is non - empty ; in particular , if @xmath104 is monotonic and @xmath201-continuous then ( by ( ii ) ) there a @xmath236-compatible subset of @xmath30 exists if and only if @xmath275 is nonempty .",
    "* without the assumption that @xmath104 is weakly @xmath201-continuous in part ( iii ) , it is possible for @xmath275 to fail to be @xmath236-compatible when @xmath30 is infinite , even if @xmath104 is monotone .",
    "the proof of parts ( i)(iii ) proceeds exactly as in @xcite , with the addition of one extra step required to justify part ( iii ) , assuming @xmath201-continuity .",
    "namely , condition ( [ glbeq ] ) ensures that @xmath277 is also @xmath201-continuous in the sense that for any nested descending chain @xmath260 of sets , we have : @xmath278 and so @xmath279 . the proof of ( [ psieq ] ) from ( [ glbeq ] ) is straightforward : firstly , @xmath280 holds for _ any _ function @xmath240 , while if @xmath281 , then , by definition of @xmath240 , @xmath282 for all @xmath98 and @xmath283 for all @xmath82 and so @xmath284 , and @xmath283 for all @xmath82 .",
    "now , since @xmath285 is a glb of @xmath286 , we have @xmath287 for all @xmath98 ( i.e. @xmath288 ) and so @xmath289 .",
    "part ( iv ) follows directly from parts ( ii ) and ( iii ) .    for part ( vi ) , consider the infinite crs @xmath117 in example 2 . as above , take @xmath290 and , for @xmath291 , with @xmath104 and @xmath252 defined as in ( [ fgeq ] ) .",
    "then @xmath292 , where @xmath293 however , @xmath19 is not @xmath236-compatible , since @xmath294 and @xmath295 but this is not a subset of @xmath296}(f ) = { { \\mathcal f}}$ ] since @xmath297 . in this example , @xmath104 fails to be weakly @xmath201-continuous , and the argument is analogous to where we showed earlier that @xmath129 fails to satisfy ( a4)@xmath70 .",
    "more precisely , for each @xmath82 , let @xmath298 , where @xmath94 is defined in ( [ r1eqx ] ) and where , for each reaction @xmath299 , @xmath300 is the unique catalyst of @xmath8 .",
    "then @xmath301 and so @xmath302 .",
    "however , @xmath303 and so @xmath304 , which differs from the glb of @xmath305 , namely @xmath302 .",
    "the examples in this paper are particularly simple  indeed mostly we took the food set to consist of just a single molecule , and reactions often had only one possible catalyst . in reality",
    "more ` realistic ' examples can be constructed , based on polymer models over an alphabet , however the details of those examples tends to obscure the underlying principles so we have kept with our somewhat ` toy ' examples in order that the reader can readily verify certain statements .",
    "section  [ finitesec ] describes a process for determining whether an arbitrary infinite crs ( satisfying ( a1)(a3 ) ) contains a finite raf .",
    "however , from an algorithmic point of view , proposition  [ finiteraf ] is somewhat limited , since the process described is not guaranteed to terminate in any given number of steps . if no further restriction is placed on the ( infinite ) crs , then it would seem difficult to hope for any sort of meaningful algorithm ; however , if the crs has a ` finite description ' ( as do our main examples above ) , then the question of the algorithmic decidability of the existence of an raf or of a finite raf arises .",
    "more precisely , suppose an infinite crs @xmath306 consists of ( i ) a countable set of molecule types @xmath307 , where we may assume ( in line with ( a1 ) ) that @xmath308 , for some finite value @xmath309 , and ( ii ) a countable set @xmath310 of reactions , where @xmath64 has a finite set @xmath311 of reactants , a finite set @xmath312 of products , and a finite or countable set @xmath313 of catalysts , where @xmath314 and @xmath315 are computable ( i.e. partial recursive ) set - valued functions defined on the positive integers . given this setting , a possible question for further investigation",
    "is whether ( and under what conditions ) there exists an algorithm to determine whether or not @xmath59 contains an raf , or more specifically a finite raf ( i.e. when is this question decidable ? ) .",
    "the author thanks the allan wilson centre for funding support , and wim hordijk for some useful comments on an earlier version of this manuscript .",
    "i also thank marco stenico ( personal communication ) for pointing out that @xmath201-consistency is required for part ( iii ) of the @xmath236-compatibility result above when @xmath30 is infinite , and for a reference to a related fixed - point result in domain theory ( theorem 2.3 in @xcite ) , from which this result can also be derived .",
    "p. dittrich , p. speroni di fenizio , chemical organisation theory .",
    "bull . math .",
    "biol . * 69 * , 11991231 ( 2007 ) p. g. higgs , n. lehman , the rna world : molecular cooperation at the origins of life .",
    "genet . * 16*(1 ) , 717 ( 2015 ) w. hordijk , m. steel , autocatalytic sets extended : dynamics , inhibition , and a generalization .",
    ". chem . * 3*:5 ( 2012 ) w. hordijk , m. steel , autocatalytic sets and boundaries . j. syst .",
    "( in press ) ( 2014 ) w. hordijk , m. steel , detecting autocatalyctic , self - sustaining sets in chemical reaction systems . j. theor . biol . * 227*(4 ) , 451461 ( 2004 ) w. hordijk , s. kauffman , m. steel , required levels of catalysis for the emergence of autocatalytic sets in models of chemical reaction systems .",
    "( special issue : origin of life 2011 ) * 12 * , 30853101 ( 2011 ) w. hordijk , m. steel , s. kauffman , the structure of autocatalytic sets : evolvability , enablement , and emergence .",
    "acta biotheor .",
    "* 60 * , 379392 ( 2012 ) s. a. kauffman , autocatalytic sets of proteins .",
    ". biol . * 119 * , 124 ( 1986 ) s. a. kauffman , the origins of order ( oxford university press , oxford 1993 ) e. mossel , m. steel , random biochemical networks and the probability of self - sustaining autocatalysis . j. theor . biol . * 233*(3 ) , 327336 ( 2005 ) j. smith , m. steel , w. hordijk , autocatalytic sets in a partitioned biochemical network",
    ". chem . * 5*:2 ( 2014 ) m. steel , w. hordijk , j. smith , minimal autocatalytic networks .",
    "journal of theoretical biology * 332 * : 96107 ( 2013 ) v. stoltenberg - hansen , i. lindstrm , e. r. griffor , mathematical theory of domains .",
    "cambridge tracts in theoretical computer science 22 ( cambridge university press , cambridge 1994 ) v. vasas , c. fernando , m. santos , s. kauffman , e. szathmry , evolution before genes .",
    ". dir . * 7*:1 ( 2012 ) m. villani , a. filisetti , a. graudenzi , c. damiani , t. carletti , r. serra , growth and division in a dynamic protocell model .",
    "life * 4 * , 837864 ( 2014 )"
  ],
  "abstract_text": [
    "<S> given any finite and closed chemical reaction system , it is possible to efficiently determine whether or not it contains a ` self - sustaining and collectively autocatalytic ' subset of reactions , and to find such subsets when they exist . </S>",
    "<S> however , for systems that are potentially open - ended ( for example , when no prescribed upper bound is placed on the complexity or size / length of molecules types ) , the theory developed for the finite case breaks down . </S>",
    "<S> we investigate a number of subtleties that arise in such systems that are absent in the finite setting , and present several new results . </S>"
  ]
}