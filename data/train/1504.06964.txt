{
  "article_text": [
    "in the medical community , there is a pressing need for personalized predictions of how a disruptive event , such as a treatment or disease , will impact particular bodily function levels .",
    "of particular interest is the extent to which the function is initially perturbed by the event and the ensuing pattern of recovery . in many contexts , such as mental acuity following a stroke or sexual function following prostatectomy",
    ", the post - event trajectory is expected to exhibit what we call a recovery curve shape , characterized by an initial instantaneous drop followed by a monotonic rise towards an asymptotic level not exceeding the original function level . here , we propose a bayesian model that can be used to predict a patient s expected recovery curve , given information about the patient that is available before the event .",
    "we envision our model as a decision aid for patients considering a medical treatment who want to know what adverse side effect the treatment would have on a particular bodily function . in particular",
    ", our model will be used to display to the patient a distribution over post - treatment function trajectories , conveying the uncertainty in predictions that should be considered in decision - making .",
    "we assume that the function level lies in some closed interval , the pre - treatment function level is known , and the adverse effect of the event on the function is a priori known by the medical community to be immediate , but wearing off over time .",
    "if a model is to be widely adopted as a medical decision aid , it is not enough for it to merely produce predictions that are accurate ; it must also give predictions that a healthcare provider or patient can readily understand , particularly when patients and providers have substantial domain knowledge .",
    "in the applications we consider , we will predict time series that are expected to be a recovery curves .",
    "we restrict the space of possible outputs to our model , therefore , to _ only _ include predictions that are recovery curves .",
    "thus , our model outputs a distribution of post - event trajectories each of which is guaranteed to be a recovery curve , so that the function level drops instantaneously downwards at event time , and rises smoothly to approach a asymptotic level lying between the pre - treatment value and value immediately following treatment ( we will use the words `` level '' and `` value '' interchangeably ) . furthermore , our model encourages the posterior predictive distribution over trajectories to have a well defined mode , so that the distribution of curves , when plotted , can visually be interpreted as a single maximum a posteriori prediction along with the uncertainty in that single prediction .",
    "0.48     0.48     we apply our method to data from a study that tracked the quantified sexual function level , expressed as a number between 0 and 1 , of 184 patients both before radical prostatectomy surgery and at a common set of timepoints in the 4 years immediately following surgery .",
    "these numerical measures of sexual function were obtained by administering the prostate cancer index , which is a multiple choice questionaire that evaluates patient function and bother following prostate cancer treatment , and a protocol to convert the answers to a numerical score .",
    "prostate cancer will affect 1 out of 6 men , and low stage patients usually have several viable treatment options , each with different side effects .",
    "radical prostatectomy , like most treatments for localized prostate cancer , is known to adversely affect sexual function .",
    "thus it is important to be able to forecast the pattern of sexual function level should one undergo a prostatectomy .",
    "crucially , sexual function trajectories after prostatectomy are known to follow a recovery curve , both from past studies @xcite ( at least up to 5 years post - treatment , see * ? ? ?",
    "* ) , and from our dataset . to illustrate , in figure [ fig : avg_curve ] we show the dataset - wide averages , for each timepoint , of sexual function level , as well as dataset - wide averages , for each timepoint , of the patients sexual function values scaled by their respective value immediately before prostatectomy .",
    "we also show in figure [ fig : data_plots ] the unscaled sexual function level time series of 12 randomly selected patients , which includes their unscaled sexual function level both post - treatment and right before treatment .",
    "we hypothesize that the function levels reported by individual patients are noisy versions of a latent smooth `` true '' function level . in this context",
    ", we use our method to study whether there are patient covariates that correlate with post - surgery sexual function trajectory .",
    "past work on personalized prediction of sexual function following prostate cancer treatment has attempted to predict a post - operative binary outcome , typically whether one is able to achieve an erection sufficient for sex at some single timepoint following treatment @xcite , or the change in @xcite or absolute level @xcite of some continuous measure of sexual function such as the iief-5 score .",
    "such models have incorporated patient covariates in logistic regression models for binary outcomes , and linear regression models for continuous outcomes .",
    "one obvious shortcoming of binary modeling is that sexual function is not naturally a binary event , and it is not clear how to set a cutoff to binarize continuous measures of sexual function @xcite .",
    "furthermore , a serious deficiency of logistic regression and linear regression is that they are not suitable for modeling longitudinal outcomes , whereas a patient would want to know their entire post - treatment function trajectory , not just that at a single timepoint .",
    "the only longitudinal model we found in the literature was one using linear regression to relate the change in function level between two fixed timepoints after treatment @xcite .",
    "functional data analysis @xcite and growth curve modeling @xcite are rich areas of past study , but existing models from those fields do not guarantee that the predicted time series possesses a recovery curve shape , that it drops instantaneously following the event and then monotonically approaches an asymptotic level no higher than the pre - event value .",
    "parametric functions mentioned in @xcite resemble the functional form we assume of recovery curves .",
    "however , they are modeling growth , not recovery , and assume the initial level of the growth curve to be known , whereas we are trying to predict the entire post - treatment trajectory , which includes the initial post - treatment value .",
    "furthermore , they do not place an upper bound on the asymptotic level of the predicted function .",
    "isotonic regression models @xcite , which enforce the predicted functions to be monotonic , but do not naturally output recovery curves as predictions .",
    "regardless of their applicability , existing models have been applied in contexts where the predicted time series is expected to exhibit a recovery curve shape .",
    "for example , in a medical context , growth curve techniques have been used to model recovery of a bodily function following a disruptive event .",
    "@xcite model recovery of fim - measured function following spinal surgery as being the sum of a linear and a plateauing function .",
    "although the fim - score must lie within a bounded interval , they do not guarantee that the predicted scores lie within that interval .",
    "@xcite model verbal function following chemotherapy using a bayesian latent basis model , but the model lacks incorporation of patient - correlates , and is instead specialized to infer average recovery at only two fixed timepoints .",
    "@xcite model a measure of quality of life - the barthel index - following stroke using a multilevel model where both patient - specific and time - specific contributions are modeled as a linear combination of a fractional polynomial basis .",
    "in all these models , the predicted time series is expected to possess a recovery curve shape , but there is no explicit constraint built into the models to ensure that the predicted trajectory actually does possesses a recovery curve shape .",
    "we first formally define a recovery curve and the specific parameterization of one that we use in our model .",
    "we chose this specific form of the recovery curve based on empirical evidence from the data as well as clinical expertise , which led to insights about the features of the curve that are most important to relay to patients .",
    "a _ recovery curve _ is a function @xmath0 defined on @xmath1 .",
    "we will always define @xmath0 piecewise as @xmath2which is interpreted as the disruptive event occuring right after time 0 , so that @xmath3 is the ( known ) pre - treatment function value , and @xmath4 is the post - treatment trajectory . a recovery curve will satisfy the following : @xmath5 \\label{req:4}.\\end{aligned}\\ ] ]    : the asymptotic drop in scaled function value , @xmath6 : the initial drop in scaled function value in excess of the asymptotic drop , and @xmath7 : the rate of recovery of the scaled function value .",
    "a recovery curve must smoothly approach an asymptotic level not exceeding the pre - treatment function level , and constraining @xmath8 to the unit interval and @xmath7 to be positive achieves that in the corresponding curve . ]",
    "we will parameterize @xmath0 scaled to the pre - treatment function value , instead of @xmath0 itself .",
    "that is , we assume the following parameterization    @xmath9 thus , the actual post - event trajectory is the shape of the post - event trajectory , @xmath10 , scaled to the pre - event function level .",
    "we choose this parameterization because to satisfy requirements of equations [ req:2 ] and [ req:3 ] , we just need to ensure that @xmath11 for @xmath12 . in this work we will refer to the scaled post - event trajectory , denoted @xmath10 , as a _ recovery shape _ , and",
    "will use the term _ scaled function value _ to refer to a patient s function value normalized by their pre - treatment value .",
    "in other words , a patient s recovery shape is a time series over their scaled function values .",
    "we will parameterize recovery shape @xmath10 with 3 parameters : @xmath13 , which represents the asymptotic drop in scaled function level after surgery , @xmath6 , which represents the initial drop in scaled function value in excess of the asymptotic drop , and @xmath7 , which describes the rate of recovery of the scaled function value .",
    "@xmath14 \\label{req:5},\\\\    b & \\in [ 0,1 ] \\label{req:6},\\\\    c & \\geq 0 \\label{req:7}.\\end{aligned}\\ ] ]    figure [ fig : curve ] illustrates the meaning of the parameters .",
    "@xmath15 is a recovery curve if the constraints in equations [ req:1 ] to [ req:4 ] are satisfied , and we will respect those constraints in our model .",
    "we describe the properties we desire of our model , and the building blocks which combine to achieve those properties .",
    "we refer to the @xmath16 patient s covariate vector as @xmath17 which is of dimension @xmath18 , and their observed function value at time @xmath19 by @xmath20 . here , @xmath20 is considered a noisy measurement of their `` underlying '' function value at time @xmath19 , @xmath21 , where @xmath22 is the parameterization of post - treatment function value described in section [ subsec : recovery_param ] .",
    "@xmath23 is a function of the patient s pre - treatment function value @xmath24 and patient - specific random parameters @xmath25 , and will be referred to as @xmath26 where appropriate . throughout this work , we assume @xmath24 to be a known , non - random quantity .",
    "as mentioned in the introduction , our model is designed to exhibit several properties .",
    "we list those properties as well as a description of our proposed solutions below :    0.48     0.48     1 .   [",
    "prop : hierarchical ] * property : * observed within - patient function values should be dependent , and the underlying post - treatment values for patients with similar covariates should be shrunk towards each other .",
    "+ * solution : * we adopt a hierarchical bayesian model . as observations are naturally grouped by patient ,",
    "we let @xmath27 be distributed about + @xmath28 according to the likelihood function we describe in [ subsec : likelihood ] .",
    "shrinkage is accomplished by letting @xmath29 be drawn from a single covariate dependent distribution .",
    "in particular , @xmath29 is modelled using ( a variant of ) a generalized linear model .",
    "an analogous modeling approach is used for @xmath30 and @xmath31 , and we describe these three generalized linear models in more detail in section [ subsec : glm ] .",
    "[ prop : realistic ] * property : * for each patient , their distribution over the underlying post - treatment function value is a recovery curve .",
    "that is , for a given patient @xmath32 has support only over the space of recovery curves , namely those functions satisfying requirements [ req:1 ] - [ req:4 ] .",
    "for example , we do not want to allow a predictive distribution like that in figure [ fig : improved_curve_distribution ] .",
    "this profile is unappealing because the distribution has support over post - treatment values that are higher than the patient s pre - treatment values . for the treatments we consider in our application , it is unrealistic to expect that treatment will _ improve _ a patient s outcome past the pre - treatment level . +",
    "* solution : * we respect the constraints of equations [ req:5 ] , [ req:6 ] , [ req:7 ] in modelling @xmath33 , letting their respective generalized linear models have beta , beta , and gamma response distributions , respectively , as these are canonical distributions with the desired support .",
    "[ prop : unimodal]*property :",
    "* we want the posterior of @xmath26 to be unimodal .",
    "for example , we do not want the predictive distribution to look like that in figure [ fig : bimodal_distribution ] .",
    "the distribution in this figure is bimodal , making it difficult to relate to physicians and patients .",
    "+ * solution : * @xmath29 depends on a shared regression parameter @xmath34 , shared noise parameter @xmath35 , as well as @xmath17 , so that our model parameterizes the distribution @xmath36",
    ". we will constrain this conditional distribution to be unimodal , for all @xmath37 , @xmath34 , and @xmath35 . an analogous modeling approach and constraint",
    "are used to model @xmath30 and @xmath31 . ensuring this unimodality will require special parameterizations of the beta and gamma distributions , which we describe in section [ subsec : unimodal_param ] .",
    "[ prop : likelihood ] * property : * @xmath27 should have support on the _ closed _ unit interval , because we observed that roughly 5% of the time , patients recorded a 0 or 1 response . + * solution : * we let @xmath27 come from a mixture of a beta distribution centered at @xmath26 and a bernoulli distribution .",
    "we elaborate on this in section [ subsec : likelihood ] .",
    "[ prop : prior ] * property : * in the prior , a patient s distribution over recovery shapes should be centered about some `` average '' shape .",
    "this is because in the absence of any data , doctors have a general idea of what will happen to a patient , on average . + * solution : * we assume the `` average '' shape to be parameterized by curve parameters @xmath38 .",
    "the glm modeling @xmath29 depends on the hyperparameter bias term @xmath39 .",
    "@xmath39 will be chosen so that in the prior , @xmath40 is centered at @xmath41 .",
    "we describe the choice of @xmath39 as well as the prior distribution of @xmath42 and @xmath35 in section [ subsec : prior ] .",
    "a diagram of the model is shown in figure [ fig : plate ] .",
    "the following sections give the details of the components of our model , which are , in addition to the recovery curve parameterization , described in section [ subsec : recovery_param ] :    1 .",
    "section [ subsec : glm ] : apriori independent ( variants ) of generalized linear models to model @xmath43 , @xmath44 , @xmath45 , with respective regression coefficient vectors @xmath46 and respective _ shared _ noise parameters @xmath47 .",
    "2 .   section [ subsec : unimodal_param ] : specialized parameterizations of the beta and gamma distributions , by their _ modes _ and a spread parameter , which are needed to satisfy property [ prop : unimodal ] .",
    "section [ subsec : likelihood ] : the likelihood that relates the underlying function value @xmath26 to observed function value @xmath27 .",
    "this likelihood , which satisfies property [ prop : likelihood ] , depends on parameters @xmath48 , as seen in figure [ fig : plate ] .",
    "4 .   section [ subsec : prior ] : a choice of the prior so that property [ prop : prior ] is satisfied .",
    "ccccccc    ;    b ( invispatient_plate ) [ draw , color = white , inner sep=1pt , rectangle , fit=(a_i)(b_i)(c_i)(y_i)(inv ) ] ;    f ( captpatient_plate ) [ below left=0 pt of invispatient_plate.south east , xshift=2pt , yshift=1pt ] ; ( patient_plate ) [ draw , inner sep=1pt , rectangle , fit=(invispatient_plate ) ( captpatient_plate ) , ] ;    ;    b ( invistime_plate ) [ draw , color = white , inner sep=1pt , rectangle , fit=(y_i ) ] ;    f ( capttime_plate ) [ below left=0 pt of invistime_plate.south east , xshift=2pt , yshift=1pt ] ; ( time_plate ) [ draw , inner sep=1pt , rectangle , fit=(invistime_plate ) ( capttime_plate ) , ] ;    ;    ( b_a )  ( a_i ) ; ( phi_a )  ( a_i ) ; ( b_b )  ( b_i ) ; ( phi_b )  ( b_i ) ; ( b_c )  ( c_i ) ; ( phi_c )  ( c_i ) ; ( a_i )  ( f_i ) ; ( b_i )  ( f_i ) ; ( c_i )  ( f_i ) ;    ( f_i )  ( y_i ) ;    ( theta )  ( y_i ) ; ( p )  ( y_i ) ; ( phi_m )  ( y_i ) ;    &      in order to guarantee that @xmath32 only has support over the space of recovery curves ( property [ prop : realistic ] ) , @xmath29 and @xmath30 will have support only on @xmath49 , and @xmath31 will have support only on @xmath50 .",
    "we choose to use model @xmath51 using beta , beta , and gamma distributions , because they are canonical distributions with the desired support .",
    "in particular , we let :    @xmath52    where    * @xmath53 is the specialized parameterization of the beta distribution ( detailed in section [ subsec : unimodal_param ] ) . a @xmath54 distribution has mode @xmath55 and for _ all _ @xmath55 , is unimodal if and only if spread parameter @xmath56 .",
    "examples of such beta distributions are in figure [ fig : beta_dists ] of the appendix . +",
    "* @xmath57 is the specialized parameterization of the gamma distribution ( detailed in section [ subsec : unimodal_param ] ) .",
    "a @xmath58 distribution has mode @xmath55 and for _ all _ @xmath55 , is unimodal if and only if spread parameter @xmath56 .",
    "examples of such gamma distributions are in figure [ fig : gamma_dists ] of the appendix .",
    "+ * @xmath59 are bias terms chosen to satisfy property [ prop : prior ] ( details in section [ subsec : prior ] )",
    ".    the restrictions of equation [ eq : phi_constraint ] , due to the specialized parameterizations we use , ensure the unimodality of the conditional distributions of @xmath25 , satisfying property [ prop : unimodal ] .      here",
    "we describe the @xmath53 and @xmath57 parameterizations of the beta and gamma distributions , respectively , and explain why the traditional parameterizations did not meet our needs .",
    "our @xmath53 parameterization is based on the traditional @xmath60 parameterization .",
    "a @xmath61 distribution is unimodal with mode @xmath62 if and only if @xmath63 .",
    "making the substitution @xmath64 and @xmath65 , we obtain the parameterization @xmath66 .",
    "it can be easily checked that a @xmath67 distribution , for all @xmath55 , is unimodal with mode @xmath55 if and only if @xmath68 .",
    "finally , we make the substitution @xmath69 to obtain the desired @xmath53 parameterization , where a @xmath54 distribution , for all @xmath55 , is unimodal with mode @xmath55 if and only if spread parameter @xmath70 :    @xmath71    our @xmath57 parameterization is based on the traditional @xmath72 parameterization .",
    "a @xmath73 distribution is unimodal with mode @xmath74 if and only if @xmath75 . making the substitution @xmath76 and then the substitution @xmath77",
    ", we obtain the desired @xmath57 parameterization , where a @xmath58 distribution is unimodal with mode @xmath55 if and only if spread parameter @xmath70 :    @xmath78    note that both a @xmath54 and @xmath58 have variance increasing in @xmath79 .",
    "that is why we regard @xmath79 as a spread parameter .",
    "0.48     0.48     the necessity for these specialized parameterizations of the beta and gamma distributions becomes clear if we consider a model that does not use them .",
    "we illustrate the necessity of our beta distribution parameterization ; our gamma distribution parameterization is necessary for analogous reasons .",
    "recall from property [ prop : unimodal ] that for a fixed @xmath80 , we wanted @xmath81 to be unimodal . consider the more traditional @xmath82 parameterization , where a @xmath83 distribution has mean @xmath84 , and @xmath85 is a spread parameter .",
    "suppose we had let @xmath86 .",
    "figure [ fig : bad_beta ] shows the values of @xmath87 for which a @xmath88 distribution is unimodal . given @xmath85",
    ", there is some @xmath84 for which a @xmath83 distribution is not unimodal .",
    "thus given @xmath34 and @xmath35 , there would exist some @xmath17 for which @xmath81 would not be unimodal , which violates property [ prop : unimodal ] .",
    "recall from property [ prop : likelihood ] that @xmath27 should have support on the _ closed _ unit interval .",
    "accordingly , we let @xmath27 , with probability @xmath89 , come from a @xmath90 distribution , and come from a beta distribution centered at @xmath26 otherwise . specifically , we let :    @xmath91    there exist more complicated likelihoods where the proportion of unrealistic responses of 0 or 1 is covariate dependent",
    ". however , our data are noisy and limited , and does not motivate any particular such likelihood .",
    "the posterior likelihood surface for the regression parameters @xmath46 becomes execeedingly flat if the spread parameters @xmath92 are too large .",
    "this is undesirable , as the regression coefficient parameters inform the effect of a patient s covariates on their predicted recovery curve .",
    "thus , we encourage the spread parameters towards 0 , letting    @xmath93    where @xmath94 denotes an exponential distribution with rate parameter @xmath95 truncated on the right at @xmath96 and @xmath97 are hyperparameters .",
    "as mentioned in property [ prop : prior ] , we assume there is some `` average '' recovery shape @xmath98 such that a patient s expected recovery curve in the prior is centered about @xmath99 ( see equation [ eq : shape ] ) .",
    "that is , for each patient , we want the unconditional prior distributions of @xmath25 to be centered about @xmath100 , respectively . in light of equations [ eq :",
    "glm_a ] , [ eq : glm_b ] , [ eq : glm_c ] , we let    @xmath101    where @xmath102 are hyperparameters .    finally , without any prior belief about the parameters @xmath103 governing the likelihood , we let :    @xmath104",
    "0.5     0.5     here , we show the results of two simulation experiments .",
    "first , we examine the ability of our model to recover the model parameters as the amount of data simulated using those parameters grows .",
    "second , we examine the robustness of our model to simulated data that does not fit the underlying model assumptions .    for the first experiment , we chose a single set of shared model parameters and hyperparameters @xmath100 .",
    "then for various values of @xmath105 , we did the following : we simulated 5 datasets , where for each dataset we used that set of parameters to simulate observed function values @xmath106 for @xmath105 samples at times @xmath107 , which are the same times at which data were observed in the prostate cancer dataset . for each dataset , we calculated for each parameter the _ absolute _ error : the _ absolute _ difference between the posterior median of the parameter and the true value used to simulate the dataset .",
    "for each parameter we then calculate the mean _ absolute _ error over the 5 simulated datasets .",
    "we plot in figure [ fig : sim_study_vary_n ] , for each parameter , the mean absolute error over the 5 simulated datasets , as @xmath105 varies .",
    "note that since the mean absolute errors are means of absolute differences , and thus must be positive .",
    "the set of parameters we used was simply one that was not pathological .",
    "we used @xmath108 , and @xmath109 .",
    "we assume only 1 feature , which for each sample is generated from a unit normal distribution . for inference , we set @xmath110 , @xmath111 and @xmath112 . to obtain posterior samples , we used stan @xcite , obtaining 2500 samples from each of 4 chains with no thinning , and using 2500 burn - in steps for each chain . we assessed convergence both by using the gelman statistic @xcite and visual examination of the traces for each parameter .",
    "we checked that in fitting the model to each simulated dataset , the maximum gelman statistic over parameters was less than @xmath113 .",
    "the meaning of errors in the regression parameter is provided by equations [ eq : glm_a]-[eq : glm_c ] , and the meaning of errors in the spread parameters @xmath92 is provided by the plots of beta and gamma distributions in figures [ fig : beta_dists ] and [ fig : gamma_dists ] of the appendix .",
    "0.5     0.5     for second experiment , for various @xmath114 , we did the following : we simulated a single dataset by first simulating observed function values for @xmath115 samples using the same parameters as in the first experiment .",
    "however , then we added to the dataset an additional @xmath114 _ noise _ samples whose observed function values which were _ not _ generated from the model .",
    "instead , for those @xmath114 noise samples , at each time point for which the function value is observed , we drew the observed value uniformly from the unit interval . for inference",
    ", we used the same hyperparameters , sampling method , and convergence diagnostics as before .",
    "we then calculated , for each parameter , the error : the _ signed _ difference between its median posterior distribution and the true value used to simulate ( part of ) the dataset . in figure",
    "[ fig : sim_study_add_noise ] , we plot for each parameter this signed difference as @xmath114 , the number of noise data samples , varies .",
    "as expected , the magnitude of this error is increasing in @xmath114 .",
    "note that for each @xmath114 , we simulate only 1 dataset , and that we calculate for each parameter the error which can be negative , and not absolute error ( as done for the first simulation experiment ) .",
    "also , we display in dotted lines the 25-th and 75-th percentiles of the error for each parameter .",
    "here we describe the dataset we study and perform an exploratory analysis of it to identify potentially useful patient covariates .",
    "having chosen informative covariates , we use our model to uncover the relationship between those covariates and recovery trajectory , and study our model s predictive performance through cross validation .",
    "our data comes from a study @xcite that prospectively tracked the sexual function as measured using the ucla prostate cancer index @xcite of 307 patients who underwent radical prostatectomy to treat clinically localized prostate cancer .",
    "their sexual function levels were collected right before treatment and over a 48-month post - treatment study period .",
    "their sexual function levels were requested via surveys sent to patients at 1,2,4,8,12,18,24,30,36,42 , and 48 months after their respective treatment dates , and missing data was due to lack of survey response .",
    "the prostate cancer index , derived from answers to a series of multiple choice questions , is a numerical measure of a patient s level of sexual function that lies between 0 and 100 , which we scale to the unit interval for convenience .",
    "various patient covariates were collected at time of treatment , including age , cancer grade / stage , physical and mental condition , uninary and bowel function , and comorbidity count .    prior to performing any analysis , we filtered out patients using 4 criteria based on the fourth author s urology training and experience .",
    "the filtered out patients are those that in his judgement , are not realistic and whose responses are not to be trusted . as our ultimate goal is for our model to be used by medical professionals , we opt to defer to their judgement of what constitutes realistic data , instead of attempting to model data they deem unrealistic .",
    "first , we removed 10 patients whose pre - treatment value was less than 0.1 , as the recovery curve of patients whose sexual function is very low before prostatectomy is not meaningful .",
    "then , we filtered out patients who failed at least one of the following three criteria : firstly , we removed patients for whom function level was available at less than 6 timepoints ( 44 patients ) . secondly , we removed patients whose representative curve , obtained by fitting a curve ( under least squares error , where the asymptotic level was not constrained ) to their data points , was , at 48 months post - treatment ( the last time for which data was available ) , higher than their pre - treatment value ( 50 patients ) .",
    "we did so because prostatectomy should not have a positive effect on sexual function .",
    "thirdly , we removed patients who at any point reported 3 or more function values of 0 in a row , as we do not trust the reporting of patients who report too many minimum scores ( 21 patients ) .",
    "doing so reduced the number of patients from 307 to 184 .",
    "( note that some patients failed more than one of the three criteria , so that the sums of the number of patients removed for each criteria does not equal the total number of filtered out patients . )      0.5     0.5     to identify potential correlates of recovery curve shapes , for every patient with a sufficient number of data points , we used curve fitting to find the @xmath116 parameters corresponding to their post - event recovery shapes .",
    "we made scatter plots of each of those parameters against all available covariates to identify ones that correlated with curve parameters , and identified the pre - treatment sexual function level ( referred to as `` init '' in all figures ) and patient age ( at treatment time ) to be the 2 covariates most strongly correlated with curve parameters .",
    "from the scatter plots shown in figure  [ fig : scatters ] , it can be seen the relationship between those 2 covariates and curve parameters is likely nonlinear .",
    "thus we decided to create 1 categorical feature based on whether a patient s age was less than 55 years , between 55 and 65 , or older than 65 , and a second categorical feature based on whether a patient s pre - treatment sexual function level was less than 0.41 , between 0.41 and 0.60 , between 0.60 and 0.80 , or greater than 0.80 .",
    "such subdivisions matches with the fourth author s clinical experience regarding how urologists categorize age and pre - treatment function level , and were able to account for variance in patient recovery trajectories .    [ cols=\"<,<\",options=\"header \" , ]",
    "thus , in our model , patients belong to 1 of 12 classes , depending on into which of the three age groups they fall into , and which of the four intervals their pre - treatment sexual function level lies .",
    "all these features were normalized for all analysis , and we added a bias feature that was not normalized .    to visualize the effect of these 2 covariates on recovery shape from another view , we stratified the patients by age category and pre - treatment sexual function level category , and plotted in figure [ fig : stratified_real_data ] the average shape of the patients in each category .",
    "0.48     0.48       in general there are 2 potential approaches to modeling patients absolute function values - we can do so directly , or instead model their _ scaled _ function value ( absolute function value divided by pre - treatment function value ) , and then scale it by their pre - treatment value .",
    "as we take the latter approach , we examine the dataset to justify doing so , showing that naive models that model scaled function value have superior in - sample performance to their unscaled analogue .",
    "the measure of performance we consider here and throughout the rest of the paper is loss as given by average absolute prediction error .    0.5     0.5",
    "first , we consider a baseline model where at each timepoint , each patient is predicted to possess the average absolute function value ( over the dataset ) at that timepoint ( labeled `` average value '' ) .",
    "we compare its in - sample predictive performance ( fit ) to a model where each patient is predicted to have the average _ scaled _ function value at that timepoint ( labeled `` average scaled value '' ) in figure [ fig : scaled_prior ] .",
    "( these 2 models amount to predicting each patient to have the average curve and average shape , respectively , shown in figure [ fig : avg_curve ] . ) next , we plot in figure [ fig : scaled_regression ] the in - sample predictive performance of two analogous models that use separate generalized linear regression models at each of the 11 common timepoints to model a patient s absolute and scaled function value , respectively , as a function of the features shown in figure [ fig : covs ] .",
    "in other words , one model ( labeled `` regression '' ) regresses the absolute function value at each timepoint against patient features , and the other model ( labeled `` scaled regression '' ) regresses the scaled function value against features , and to obtain a prediction of absolute function value , assumes that a patient s absolute function value is their scaled function value divided by their pre - treatment function value .",
    "the generalized linear regression models employ a logistic inverse link function and assume a normal response distribution .",
    "as can be seen , in both the cases , the models that predict scaled function value have superior predictive performance .",
    "now , we describe how we chose hyperparameters , and the fitting of the model . because we use cross - validation to estimate several parameters , we must first describe how we measure the out - of - sample predictive performance of a model .    0.5     0.5     we use 5-fold cross - validation to assess out - of - sample performance , with the loss function being absolute prediction error : the absolute difference between @xmath106 and a point estimate of , it @xmath117 . with our model , we use the median of the posterior distribution of @xmath118 as a point estimate of @xmath106 . the average loss over time can then be plotted .    to choose @xmath38 , which describe the average recovery shape for the target population ,",
    "we fit a recovery shape using our parametric form to the training fold - wide average scaled function value shown in figure [ fig : avg_curve ] ( labeled `` average shape '' ) . for this analysis because there were not enough data to reliably estimate the variance parameters @xmath47 , we determined those parameters by treating them as hyperparameters .",
    "then , the hyperparameters of the model are @xmath119 .",
    "the out - of - sample predictive performance we report in section [ sec : performance ] is that for the best set of hyperparameters , which we obtained via grid search .",
    "while these hyperparameters could have been chosen via nested cross - validation , we show in figure [ fig : sensitivity ] that out - of - sample performance is not sensitive to the particular choice of those hyperparameters .",
    "the best setting of parameters @xmath47 was @xmath120 and that of the hyperparameters was @xmath121 and @xmath122 .",
    "to fit the model , we used stan @xcite , for each of 4 chains , running 2500 steps with 2500 burn - in steps and no thinning , and assessed convergence using the gelman statistic @xcite ( the maximum value of the gelman statistic over all parameters was 1.11 ) . to assess model fit",
    ", we checked that the observed data were likely under the posterior predictive distribution . to understand the impact of the data on the posterior predictive position",
    ", we illustrate for two patients their prior and posterior distribution over recovery curves in figure [ fig : prior_vs_posterior ] .          as alluded to in section [ sec : apply ] , we performed 5-fold cross - validation , obtaining for each test sample point predictions from our model as previously described , and examined the average , over the test folds , of loss as measured by absolute prediction error .",
    "( the average loss at time @xmath19 for a test fold consisting of patient index set @xmath123 is @xmath124 where @xmath125 is the point prediction of the function level of patient @xmath126 at time @xmath19 . ) in particular , the entire time series for patients in the testing folds are predicted given the entire time series of the patients in the training fold .",
    "data from the early part of one patients time series is not used to predicted the same patient s future values .",
    "we plot , over time , the out - of - sample performance of our model , as well as that of several baseline models in figure [ fig : performance ] . to compare the improvement of our method to the status quo ,",
    "in which a doctor merely tells a patient the population - wide average shape , we plotted the performance of simply predicting a patient to have the average recovery shape .",
    "this is the `` scaled average value '' model described in section [ sec : scaled ] .",
    "we compared the performance of our model to one that , at each of the 11 common timepoints , uses a separate generalized linear regression model to relate the scaled function value at the timepoint to patient features .",
    "this is the `` scaled regression '' model described in section [ sec : scaled ] ; it uses a logistic inverse link function and assumes a normal response distribution . finally ,",
    "because of the high variance in our data , we show for comparison the _ in - sample _ performance of a model that is prone to overfitting .",
    "this model , labelled `` median '' , in order to make a prediction for a patient at a given time , looks at which of the 12 patient classes the patient belongs to and then calculates the median scaled function value , at the given time , of patients who belong to that patient class , over the _ entire _ dataset .",
    "the predicted value for that time is then that median scaled function value multiplied by the patient s own pre - treatment function value .",
    "as can be seen in figure [ fig : performance ] , the out - of - sample performance of our model is roughly equivalent to that of the scaled regression model .",
    "error bars show the variance in our estimates of the expected loss at each time .",
    "our model achieves out - of - sample performance comparable to that of the timewise scaled regression described in section [ sec : scaled ] .",
    "however , our model produces much more believable predictions , outputting a distribution over time series consisting solely of recovery curves , so that they are smoothly increasing monotonically towards an asymptote , and do not exceed the pre - treatment value . on the other hand",
    ", the timewise scaled regression model produces a time series that is not guaranteed to be smooth or monotonically increasing .",
    "because such an output does not look like a realistic recovery curve , these methods would not be able to be used directly in practice , whereas our curves by design would be more useful . to illustrate , in figure [ fig : curve_comparisons ] for several of the 12 classes of patients , we plot the scaled function values produced by scaled timewise regression , the distribution over @xmath127 from our model , and the timewise median of that distribution .",
    "furthermore , we have designed our model so that prediction _ uncertainty _ is easily interpretable when a patient s posterior distribution of curves is plotted . because we encourage the a patient s recovery curve parameter distribution to be unimodal in the posterior , we expect the pointwise distribution of curve values , namely that of @xmath127 , to be unimodal . this is why in figure [ fig : curve_comparisons ] , the distribution of curves appears clustered about the red curve .",
    "it is important that one can visually extract from a plot of posterior distribution of curves a _ single _ most likely curve .",
    "then , such a plot can be interpreted as giving a single curve prediction , along with the uncertainty in that prediction . on the other hand ,",
    "if the posterior distribution of curves were clustered around , say , two curves , there would be no clear interpretation of the results .",
    "such a scenario could certainly occur if we did not explicitly avoid it , because we are making predictions in a closed interval , so that the probability mass in the posterior predictive distribution could accumulate at the boundaries of that interval and produce an unrealistic second peak in the posterior .",
    "0.5     0.5       our analysis teases apart the dependence of recovery shape on age and pre - treatment value . in figure",
    "[ fig : trends ] , we show the predicted recovery shapes of all 12 classes of patients ( the plotted time series are the median of their respective posterior predictive distributions ) .",
    "we stratify those recovery shapes first by pre - treatment level , to show the dependence of recovery shape on age when pre - treatment level is controlled for .",
    "we then stratify those shapes by age , to show the dependence of recovery shape on pre - treatment level when age is controlled for .",
    "we also fit our model using one categorical feature at once to see the dependence of recovery shape on each covariate , separately , without controlling for the other covariate .    in figure [",
    "fig : age_trend ] , we examine the effect of patient age on recovery curve shape .",
    "we find that when pre - treatment level is controlled for , patients younger than 55 years of age have a smaller asymptotic drop in sexual function level , proportional to their pre - treatment level , as can be seen in figure [ fig : age_trend ] .",
    "( to support this , we also performed a one - sided z - test that the scaled function value at 48 months for patients younger than 55 years of age was larger than those older than 55 years of age , and obtained a p - value of @xmath128 . ) however , this effect is diminished for patients with pre - treatment level higher than 0.80 . when pre - treatment level is not controlled for , the asymptotic proportional drop in function level for patients in the 3 different age",
    "ranges we consider are distinct , with a younger age corresponding to a smaller asymptotic proportional drop . in both cases ,",
    "the initial drop in function level , proportional to pre - treatment level , appears to not depend on patient age .    in figure",
    "[ fig : init_trend ] we examine the effect of pre - treatment sexual function level on recovery shape .",
    "we find that when age is controlled for , patients with pre - treatment level higher than 0.80 have a smaller asymptotic drop in sexual function level , proportional to their pre - treatment level .",
    "( to support this , we also performed a one - sided z - test that the scaled function value at 48 months for patients with pre - treatment value above 0.8 was higher than those with pre - treatment value below 0.8 , and obtained a p - value of @xmath1298 . ) however , this effect is diminished for patients younger than 55 years of age . the initial drop in function level , proportional to pre - treatment level , appears to depend very mildly on pre - treatment level .",
    "the rate of recovery shows some dependence on pre - treatment level , though not in any monotonic manner .      unlike past methods , which have mostly focused on modeling a continuous or binary measure of sexual function at a single fixed time ,",
    "our model makes predictions of the entire post - treatment function trajectory .",
    "regardless , we can still compare our findings to them .",
    "past work that modeled a continuous measure of sexual function found that lower age and higher pre - treatment sexual function level are statistically linked to higher _ absolute _ levels of that measure @xcite , and that lower age is linked to a smaller _ change _ in that measure of function level @xcite .",
    "likewise , when a binary indicator of satisfactory sexual function has been logistically regressed against patient covariates , lower age @xcite and higher pre - treatment function level ( @xcite ) have been found to lead to a higher probability of having satisfactory sexual function .",
    "one can conclude from these past statistical analyses , as well as model - free data analyses @xcite , that lower age and higher pre - treatment sexual function level , by any measure , are linked to higher post - treatment sexual function level , which is in agreement with our findings .",
    "we stress that unlike any previous analysis , we model the dependence of the longitudinal sexual function levels _ proportional _ to the pre - treatment level on patient features .",
    "this means , for example , that our findings that the proportional initial drop relative to the pre - treatment level does not depend on the pre - treatment level still means that the _ absolute _ initial drop does depend on pre - treatment level .",
    "furthermore , we also emphasize that the uncertainty associated with our predictions is fairly high .",
    "we see this from the posterior distribution of the recovery shapes shown in figure [ fig : curve_comparisons ] .",
    "however , this alludes one of the strengths of our model - that the uncertainty in predictions can be easily visually interpreted .",
    "we have presented a natural bayesian model that can be used to predict recovery curves , which arise in many medical contexts .",
    "our overarching goal is to facilitate the flow of information from the data to the user , who may not be statistically inclined . towards this end , we impart interpretability to both the model and its output , because we believe our model will be more accepted by medical practitioners if it can be easily explained to the layman , and if its output is believable . in particular ,",
    "our model predicts quantities that are of natural interest , and guarantees that its output is in fact the recovery curve that we assume a domain expert to expect of a prediction .",
    "furthermore , our model is designed for easy visualization of predictions and the uncertainty associated with them , as we encourage the posterior distribution over recovery curves to have a clear mode.    we have used our model to analyze the impact of prostatectomy on a patient s post - treatment sexual function trajectory , and have characterized the extent of that impact on patient age and pre - treatment sexual function level , producing conclusions that both agree with and supplement past findings .",
    "many medical treatments affect some measure of well being , whose quantified post - treatment trajectory is suitable to be modeled as a recovery curve .",
    "we have shown the promise of our model in producing insights in one specific domain , and believe it can produce similar benefits to doctors and patients in the context of other medical treatments .",
    "this work was supported by national science foundation career grant iis-1053407 to c. rudin .",
    "we thank dr .",
    "jim michaelson of massachusetts general hospital for helpful discussions .",
    "we provide a sense in figures [ fig : sensitivity_phi ] and [ fig : sensitivity_sigma ] how out - of - sample performance changes with the values of hyperparameters @xmath130 and the fixed values of parameters @xmath47 .",
    "the joint setting of those parameters and hyperparameter values giving optimal out - of - sample performance was with parameters @xmath120 and hyperparameters . @xmath121 and @xmath122 . in figure [ fig : sensitivity_phi ]",
    ", we tie @xmath131 , and illustrate how out - of - sample performance changes as the tied value of @xmath35 and @xmath132 changes , with the remaining parameters and hyperparameters set to their values at the aforementioned joint optimum . in figure [ fig : sensitivity_sigma ] , we tie @xmath133 and illustrate how out - of - sample performance changes as the tied value of @xmath134 changes , with the remaining parameters and hyperparameters set to their values at the aforementioned joint optimum ."
  ],
  "abstract_text": [
    "<S> we propose a bayesian model that predicts recovery curves based on information available before the disruptive event . a recovery curve of interest is the quantified sexual function of prostate cancer patients after prostatectomy surgery . </S>",
    "<S> we illustrate the utility of our model as a pre - treatment medical decision aid , producing personalized predictions that are both interpretable and accurate . </S>",
    "<S> we uncover covariate relationships that agree with and supplement that in existing medical literature . </S>"
  ]
}