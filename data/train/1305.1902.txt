{
  "article_text": [
    "the development of multi - dimensional computational models of the solar corona is rendered difficult because of the variety of physical processes operating over a wide range of spatial and temporal scales .",
    "of particular importance are the very different requirements for studying the evolution and dissipation of magnetic fields , and the plasma response to any particle heating and acceleration .",
    "the former requires multi - dimensional ( e.g. 3d ) magnetohydrodynamic ( mhd ) models , often with a simple energy equation , while the latter usually involves the solution of the system of one - dimensional ( 1d ) hydrodynamic ( hd ) equations for a prescribed magnetic field geometry , with an energy equation that aims to capture all of the important plasma processes , and also includes detailed spectral modeling for direct comparison with observations .",
    "combining these two aspects into a unified approach is an ongoing challenge ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "despite the apparent simplicity and tractability of the 1d hd approach , it remains a far from trivial computational problem .",
    "the treatment of shocks needs care , but is well understood . despite early recognition of the problems ( e.g. * ? ? ?",
    "* ) , the numerical treatment of thermal conduction , in particular the resolution of steep temperature gradients , remains a serious concern .",
    "this can be seen by considering a static equilibrium loop .",
    "the energetics near the loop apex is roughly a balance between the heating function and a downward heat flux .",
    "relatively shallow temperature gradients are sufficient to carry away the excess energy from the corona because the coefficient of thermal conduction scales as @xmath0 .",
    "for an active region loop of half - length 25 mm and apex temperature 4  mk , the coronal temperature length scale , defined as @xmath1 , is a few thousand km , requiring grid cells of order 1000  km for resolution . here",
    "@xmath2 is the heat flux , @xmath3 a coordinate along the loop and @xmath4 is the thermal conduction coefficient .",
    "below some point in the atmosphere ( defined as the top of the transition region ) , the energy balance is between the downward heat flux and optically thin radiative losses , with the strong radiation requiring a steep temperature gradient ( large heat flux ) for balance . for",
    "the above example , transition region values of @xmath5 may be of order @xmath6  m , which require grid cells of @xmath7  m for resolution .",
    "hotter loops require smaller grid cells and longer loops can be modelled with wider cells .",
    "such resolutions are straightforward in static loop models , either by brute force or especially using thermally structured grids ( e.g. appendix  a of * ? ? ?",
    "* ) .    in a dynamic ,",
    "evolving corona , two major problems arise . when using an explicit numerical scheme to solve the energy equation",
    ", there is the need to ensure stability .",
    "the thermal conduction timescale across a grid cell of width @xmath8 is of order @xmath9 and one requires the timestep ( @xmath10 ) to satisfy @xmath11 , where the minimum is taken across the entire grid , a condition which holds irrespective of the state of the loop .",
    "[ the stability restriction can be removed by use of an implicit code , but the physical timescale implied by , for example , a moving conduction front can not : see section  [ discussion ] . ] for a coronal plasma of density @xmath12  @xmath13 heated to @xmath14  k with a cell width of 200 km , @xmath10 is of order 0.1  s @xcite . for a transition region plasma of density @xmath15  @xmath13 at @xmath16  k and grid 500 m , @xmath10 is of order @xmath17  s. temperatures characteristic of a flare obviously decrease these numbers drastically .",
    "so , to follow an event accurately for the timescales of interest ( minutes or hours ) still requires the resolution of the principle timescales of the physical processes driving the evolution : of order milliseconds or less .",
    "the second problem is that the location of the steepest temperature gradients moves in response to the corona being heated and then cooling . during heating and early cooling phases , a conduction front moves downward in the atmosphere pushing the transition region lower , and during the later cooling the transition region",
    "retreats back into the corona .",
    "so our 500 m cell mentioned above needs to move around .",
    "it is clearly not computatially efficient , or even practical , to use the small - scale grid required by the transition region everywhere in the domain ( @xmath18 in the corona for a 500  m grid cell would be @xmath19  s in the above example ) , so one needs to ensure there is high resolution where it is needed at all times , but not over - resolution elsewhere .",
    "there are two potential solutions to this problem .",
    "the first is to use a fixed but non - uniform grid where the density of grid cells is greatest in regions of the solution that demand the highest resolution",
    ". this can be effective if one can be certain that these regions remain more or less stationary and do not propagate to the lower resolution parts of the grid as the equations are advanced in time .",
    "in the circumstances under which this can not be guaranteed then the solution is to use an evolving  /  adaptive grid in which the density of grid cells increases or decreases in different regions of the solution as required .",
    "one implementation of this technique keeps the total number of cells constant by stretching  /  shrinking the grid cells , whereas other methods allow a variable number of grid cells ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    ".    the question of what constitutes adequate spatial resolution in 1d hd models , and the consequences of not resolving the atmosphere properly , has been of concern for over three decades .",
    "one early argument @xcite was that inadequate resolution would cause the heat flux to become `` bottled up '' in the corona , leading to slower cooling . in this paper",
    "we show that this is not the case and explore the issue of real concern , which is how the numerical resolution impacts the interaction between corona , transition region and upper chromosphere , especially the so - called `` chromospheric evaporation '' that provides the corona with density .",
    "this has never been quantified and is of enormous interest and importance to coronal modeling , especially in 3d codes where it is harder to achieve adequate resolution . in section",
    "[ numerical ] and appendix  [ appa ] the key features of the 1d hd code and the numerical experiments that we carry out are described . in section  [ results ]",
    "we discuss our findings in relation to the response of the solar atmosphere to heating , mass and energy transport , and the conservation laws . in section  [ discussion ]",
    "we discuss a number of implications of the results and in section  [ summary ] we present our conclusions .",
    "the effect of numerical resolution is explored using the 1d hydrad code @xcite , which is discused fully in appendix  [ appa ] , through a series of examples of impulsive coronal heating .",
    "the heating covers several orders of magnitude , ranging from that required to maintain quiet sun conditions to reasonably powerful flares .",
    "short and long loops , and slow and fast heating are considered . the spatial profile of the energy release is uniform along the loop and the temporal profile is triangular , with a linear ramp up to the peak volumetric heating rate followed by a linear decrease to zero over a total period @xmath20 .",
    "to facilitate this investigation we employ the adaptive regridding capabilities of hydrad to study a range of maximum refinement levels .",
    "the condition for refinement is such that cell - to - cell changes in the density and electron energy are kept between 5% and 10% where possible .",
    "the largest grid cell in all of our calculations has a width of @xmath21  cm ( 400  km ) and each refinement splits the cell in two .",
    "so , a grid cell that has been refined once has a width of @xmath22  cm , twice yields a width of @xmath23  cm and @xmath24  times a width of @xmath25 ( where @xmath24 is the refinement level ) .",
    "we employ a maximum of 12 levels of refinement , corresponding to a grid cell width in the most highly resolved regions of @xmath26  cm ( 98  m ) . using the same set of parameter values we repeated each run for @xmath27 $ ]  refinement levels to create a group of runs .",
    "these are summarised in table  [ table1 ] , where we note that : ( 1 ) the total length of the loop ( @xmath28 ) includes a 10  mm chromosphere at each foot - point ; and ( 2 ) the total energy in the loop at @xmath29 ( the initial conditions ) is negligible compared with the energy released into the loop during the heating phase .",
    ".a summary of the parameter space used to conduct the numerical experiments for @xmath27 $ ] .",
    "the columns show , respectively , the group number , the length of the loop ( including a 10 mm chromosphere at either footpoint ) , the peak heating rate , the width of the heating pulse , the maximum averaged temperature and density , and the resolution level needed for density to exceed 90 and 75% of the properly resolved value . [",
    "cols=\"^,^,^,^,^,^,^,^ \" , ]     as discussed fully in appendix  [ appa ] , we solve the 1d hd equations appropriate for a single magnetic strand in the field - aligned direction as documented in @xcite . in summary ,",
    "a multi - species approach is adopted by treating electrons and ions as separate fluids , and coupling them via coulomb collisions .",
    "the electrons are heated preferentially ( @xmath30 ) , with quasi - neutral ( @xmath31 ) and current free ( @xmath32 ) conditions assumed .",
    "the equations solved are formulated to describe the conservation of mass , momentum and energy .",
    "this has the advantage of making it particularly easy to determine how well the numerical methods implemented in hydrad satisfy the conservation conditions and the role that spatial resolution plays .",
    "[ we discuss methods that do not solve the conservative form of the energy equation , such as 3d mhd codes , later . ]",
    "the following physics is included : transport and compression , viscous stress , gravitational acceleration and potential energy , coulomb collisions , thermal conduction , optically - thin radiation , and external energy input ( heating ) .",
    "collisions between like - species are frequent enough that the electron and ion equations of state are given by @xmath33 and @xmath34 , and only the thermal component of the electron energy and the thermal plus kinetic components of the ion energy are considered .",
    "the hydrad code , written exclusively in c++ , is fast , robust and models an entire loop strand ( foot - point to foot - point for any geometry via an analytical equation , or look - up table , for gravity ) .",
    "it is user - friendly and easily configurable via a java - developed graphical user interface .",
    "and @xmath35 .",
    "the various curves represent different values of @xmath24 , which converge as @xmath24 increases .",
    "the evolution is clockwise along the curves in the @xmath36 vs. @xmath35 plots.,title=\"fig:\",scaledwidth=80.0% ]   and @xmath35 .",
    "the various curves represent different values of @xmath24 , which converge as @xmath24 increases .",
    "the evolution is clockwise along the curves in the @xmath36 vs. @xmath35 plots.,title=\"fig:\",scaledwidth=80.0% ]    figure  [ fig1 ] shows the temporal evolution of the spatially averaged density ( @xmath35 ) , electron temperature ( @xmath36 ) , total pressure ( @xmath37 ) and the corresponding @xmath36 vs. @xmath35 phase - space plot for the numerical runs comprising groups  2 ( upper four panels ) and 3 ( lower four panels ) , as described in table  [ table1 ] .",
    "these correspond to roughly an active region nanoflare and a small flare respectively .",
    "the spatial average was calculated over the upper - most 50% of the loop , which is comprised solely of coronal plasma .",
    "each curve corresponds to a different maximum refinement level for the adaptive grid .",
    "taking group  2 as an example , the lowest solid line in the upper - left panel for figure  [ fig1 ] shows the average density for a refinement level of zero ( no refinement , a uniform grid of @xmath21  cm grid cells ) , the dotted line shows the average density for a refinement level of @xmath38 , and so forth .",
    "the curves for refinement levels of 10 ( long dashes ) and 12 ( upper solid line ) are essentially identical , which indicates that a maximum spatial resolution of order 100  m is required for the density solution to converge for this group of runs .",
    "it is striking that the average electron temperatures are only weakly dependent on the resolution and converge at @xmath39 : even coarser grids perform adequately .",
    "the peak temperature is similar for all resolutions , though under - resolved loops cool somewhat more rapidly than the resolved ones .",
    "since the peak temperature is reached when heat input and coronal energy loss by thermal conduction are in balance @xcite , one would expect this to require adequate spatial resolution of the temperature gradients .",
    "however , we are only considering the average coronal temperatures here and even our coarsest grid is sufficient to resolve coronal scales ( of order 1000  km ) , which is all that is needed for thermal conduction to efficiently remove the excess energy deposited in the corona .",
    "this shows that inadequate spatial resolution does not `` bottle up '' the heat flux and thereby slow coronal cooling .    on the other hand",
    "the density shows a major difference between low and high resolution .",
    "for these two cases with small @xmath20 and @xmath40 , the density reaches a peak a few tens of seconds after the temperature and then oscillates as the plasma sloshes to and fro within the loop . for both cases in figure 1",
    ", there is a difference of  80% between the initial peaks for @xmath41 and @xmath42 , and a larger difference in the density decay phase , with the poorly resolved cases also showing little in the way of oscillations .",
    "group  2 has fairly moderate heating with a peak electron temperature at just above 6  mk , and yet at 500  s there is a factor of greater than 3 difference in the density between the coarsest and most refined solutions .",
    "even with 25  km grid cells ( @xmath43 ) the density is about 40% lower than the converged value .",
    "group  3 , for which an order of magnitude more energy was released over the same timescale ( 60  s ) shows greater differences for different values of @xmath24 than group  2 , though the runs for @xmath44 $ ] again demonstrate successful convergence .",
    "indeed , this group of runs demonstrates that as one approaches flare territory the demands made of spatial resolution become more extreme and the need to satisfy them to derive accurate solutions becomes more critical .",
    "it is evident , for example , that grid cells greater than 1  km in width are not sufficient .",
    "the final two columns in table  [ table1 ] show the resolution required for the density to exceed 90 and 75 % of its fully resolved value .",
    "these numbers should be treated as approximate , and are evaluated around the 2nd and 3rd density peaks .",
    "the magnitude of the density oscillations are also diminished for poorer resolution , indicative of faster damping .",
    "these should damp conductively and we find that while the damping time of the resolved cases is broadly consistent with the calculated conductive damping time , the fast damping of the unresolved cases is not .",
    "the conductive timescale scales as @xmath45 , but the lower density in the unresolved cases is compensated by a somewhat smaller temperature so that the conductive timescale changes little .",
    "so it appears that the lack of resolution also enhances the damping , a result of importance for coronal seismologists who may use 1d hd models to interpret their results ( for a further discussion of wave damping in the context of coronal seismology see * ? ? ?",
    "* ) .",
    "figure  [ fig2 ] and table  [ table1 ] show the set of results for the runs comprising group  9 , another very impulsive heating case corresponding to a strong nanoflare in a long ( 180 mm ) loop .",
    "the pattern followed by the density and temperature evolution , and seen in the phase - space plot , is broadly the same as in figure  [ fig1 ] .",
    "however , even though this group is subject to the most extreme volumetric heating rate for the 180  mm runs , the density difference ( e.g. at 1000  s ) between the coarsest and most refined grids is only about a factor of 2 .",
    "the reason for this is that longer loops require shallower temperature gradients and consequently the coarser grids are more equal to the task of providing adequate resolution . for example , @xmath39 does a reasonable job in this case , though one should bear in mind that this still corresponds to a grid cell width of just over 5  km for a loop of 180  mm total length , reaching a peak electron temperature in the region of 12  mk .",
    "[ we note from the phase - space plot that the @xmath46 $ ] curves do not recover the initial equilibrium , but find another nearby in temperature but of about half the density .",
    "the curves for @xmath47 can all be seen to recover the initial equilibrium .",
    "the reason for this is that the initial conditions fed to hydrad are calculated on an extremely high resolution grid with cell widths as small as 1  cm ; these are then interpolated onto the much coarser grid used for the time - dependent calculation , which is then adaptively refined as the calculation proceeds .",
    "the grids of @xmath46 $ ] are not sufficient to resolve even the initial conditions in the case of group  9 and so these runs ultimately return to a different equilibrium state .",
    "the grids of @xmath47 do not have this problem and converge on the initial equilibrium . ]",
    "figures  [ fig3 ] and [ fig4 ] show the moderate and extreme volumetric heating cases for loops of total length 60 ( groups  5 and 6 ) and 180  mm ( groups  11 and 12 ) respectively , with the energy released over an extended period of 600  s , more akin to flaring timescales .",
    "order of magnitude differences between the density curves for @xmath48 $ ] can be seen for group  6 . even at refinement levels of @xmath39 ( @xmath49  km grid cells )",
    "there are differences of 30% ( group  5 ) and",
    "20% ( group  6 ) between the peak densities attained and the fully converged peak densities .",
    "the peak density also shifts to earlier times by a couple of hundred seconds with changing @xmath24 , which is particularly noticeable for group  5 .",
    "the density oscillations seen in the earlier resolved results have also disappeared for groups 5 and 6 due to the short conductive damping timescale .",
    "the differences between the density curves for groups  11 and 12 are less severe , indicating once again that the shallower gradients associated with longer loops , for a given peak temperature , can be satisfactorily handled by coarser grids on the order of at least km resolution ( cell widths of 6  km in the case of group  11 and about 2  km for group  12 ) .",
    "the phase - space plots corresponding to groups  5 and 6 , in particular , provide rather dramatic examples of the need to provide adequate spatial resolution in order to accurately follow the complete coronal heating and cooling cycle .",
    "the density oscillations have re - appeared due to the increase in the conductive damping time in the longer loops and there is a little evidence for the oscillations persisting in the unresolved long loops .    in summary , analysis of groups",
    "@xmath50 shows the following : ( 1 ) shorter loops require greater spatial resolution than longer loops for a given peak temperature ; ( 2 ) the coronal density is far more strongly resolution - dependent than the temperature ; ( 3 ) grid cell widths of less than 1  km are required for fully - converged solutions in the case of 60  mm loops and peak temperatures greater than 6  mk ; ( 4 ) cell widths of no more than 5  km are required for reasonably accurate solutions ( densities within a few percent of converged solutions ) in the case of 180  mm loops and peak temperatures exceeding 6  mk ; ( 5 ) obtaining a physically realistic evolution through the complete coronal heating and cooling cycle demands adequate spatial resolution at all times .    we can thus conclude that ( i ) the mechanism responsible for driving the ablation of material into the corona during heating is strongly inhibited by a lack of spatial resolution , and we will examine the physics and the numerics of this process in greater detail in section  [ transport ]",
    "the phase - space plot tracks the solutions all the way back to the recovery of the initial conditions and reveals significant differences in the evolutionary paths taken by the individual runs .",
    "( ii ) the under - resolved cases have rapid damping of the density oscillations .",
    "an analysis of the density and temperature in the @xmath41 and @xmath42 cases shows that there is little change in the conductive cooling times , the smaller values of @xmath51 and @xmath35 in the unresolved case offsetting each other .",
    "we discuss the reason for this rapid damping in the under - resolved cases in section  [ transport ] .",
    "the first question that needs to be addressed in understanding these results is whether the low coronal density for poorly resolved cases is caused by a lack of energy conservation due to numerical under - resolution .",
    "figures  [ fig1 ] to [ fig4 ] show the temporal evolution of the average total pressure ( electron + ion ) calculated in the same way as the average density and electron temperature .",
    "the total pressure can be considered a proxy for the total thermal energy in the loop , and the amount of energy ultimately transported into the corona as the system evolves , since the kinetic energy component is in general relatively small .",
    "it is clear that the total pressure , and hence the total energy and energy transported , is strongly dependent on the spatial resolution .",
    "the total energy released is the same within each group of runs , so an increasing fraction of this energy does not appear in the corona as the spatial resolution is decreased . to take an extreme example ; the lower four panels in figure  [ fig3 ] , corresponding to group  6 , show differences in the total pressure of a factor of almost 6 between @xmath52 and @xmath53 .",
    "there are also significant differences between intermediate refinement levels .",
    "to assess the ability of the code to conserve energy , we check whether the following condition is satisfied :    @xmath54 ds = 0 , \\label{eqn1}\\ ] ]    where @xmath55 is the sum of the thermal and kinetic energy , @xmath56 and @xmath57 are the volumetric radiation and heating rates , respectively , and @xmath58 is the rate of change of gravitational potential energy .",
    "the other terms involved in the energy equation that determine @xmath59 are flux divergencies ( e.g. enthalpy and thermal conduction ) which spatially integrate to zero over the entire loop due to there being no mass or conductive flux through the lower boundaries .",
    "thus they serve only to redistribute energy within the system . therefore ,",
    "if all of the energy sources , sinks and fluxes are correctly treated and accounted for then the condition described by equation  [ eqn1 ] will be satisfied .",
    "we have calculated the deviation from zero of equation  [ eqn1 ] as a percentage of the total energy stored in the transition region and corona ( @xmath60  mk ) for the most extreme cases , which are groups  [ 3,6,9,12 ] .",
    "we chose to omit the chromospheric part of the loop from the calculation in order that the large energy content of the chromosphere could not mask any significant lack of conservation in the overlying atmosphere .",
    "between @xmath29  s and the time of peak density for each group of runs ( as seen in figures  [ fig1 ] to [ fig4 ] ) we found the maximum percentage deviations from perfect conservation to be : group  3 , 0.36%  ( @xmath52 ) , 0.20%  ( @xmath61 ) ; group  6 , 0.69%  ( @xmath52 ) , 0.09%  ( @xmath61 ) ; group  9 , 0.05%  ( @xmath52 ) , 0.12%  ( @xmath61 ) ; group  12 , 0.31%  ( @xmath52 ) , 0.26%  ( @xmath61 ) .",
    "in addition , the temperature vs. density phase - space diagrams in figures  [ fig1 ] to [ fig4 ] show that following the conclusion of the impulsive heating , when only the background heating used to find the initial hydrostatic conditions remains , the code does a good job of recovering the initial conditions by returning the solution to the starting point in the phase space .",
    "thereafter , the atmosphere is held in hydrostatic equilibrium with only residual background flows having a mach number @xmath62 .",
    "we find that energy is conserved to better than 1% , even for @xmath52 , and so the large discrepancies in the total coronal thermal energy indicated by figures  [ fig1 ] to [ fig4 ] are not due to a lack of spatial resolution directly ( because the code is evidently doing a good job of accounting for all energy sources , sinks and fluxes ) , but the lack of spatial resolution may be driving the solutions into different physical regimes ( e.g. strong vs. weak ablation ) , as we now discuss . whether energy equations implemented in 3d codes that do not use the conservative form do so well is unclear .",
    "( solid ) , @xmath39 ( dotted ) and @xmath61 ( dashed ) are plotted.,title=\"fig:\",scaledwidth=80.0% ]   ( solid ) , @xmath39 ( dotted ) and @xmath61 ( dashed ) are plotted.,title=\"fig:\",scaledwidth=80.0% ]    we now turn to a consideration of the different physical regimes that may dominate the numerical solutions for the range of @xmath24 studied here",
    ". since the major differences between these runs are a consequence of the transition region resolution then it makes sense to focus our investigation on this part of the domain .",
    "furthermore , we demonstrated in our earlier work @xcite that it is the demands of the transition region which dominate the energetics and the dynamics of the loop during all phases of its evolution .",
    "figure  [ fig5 ] shows the average heat flux ( left - hand column ) and the average enthalpy flux ( right - hand column ) through the transition region for groups  3 , 6 , 9 and 12 .",
    "they were calculated by spatially integrating the heat flux from the location of the transition region  /  corona interface down to the foot - point ( the first grid cell in which the temperature reaches or falls below 20,000  k ) and then dividing by the transition region width .",
    "the location of the transition region  /  corona interface can be found in a reasonably straightforward way during this period by identifying the grid cell in which the divergence of the heat flux transitions from positive ( corona ) to negative ( transition region ) , indicating that energy is being removed from the heat flux to power the transition region radiation .",
    "these average quantities were calculated for the right - hand leg of the loop and so positive fluxes are down - flowing ( toward the foot - point ) and negative fluxes are upflowing ( toward the apex ) .",
    "their temporal evolution is shown for the entire heating phase and part of the ablative phase ( coronal cooling by thermal conduction ) . at later times , when the ablated material from opposite legs of the loop collides at the apex and triggers acoustic waves ( the density oscillations already noted , with accompanying localised temperature perturbations ) then this interface becomes far more difficult to locate .",
    "an examination of the left - hand column of figure  [ fig5 ] shows that the ability of the transition region to support a substantial heat flux is almost independent of the spatial resolution , particularly in the case of the groups of runs for the longer loops ( groups  9 and 12 ) where the gradients are shallower .",
    "recall that these results are for the most extreme heating scenarios chosen for our study . even in the case of short loops ( groups  3 and 6 ) the heat fluxes for the @xmath63 $ ] runs",
    "are in very close agreement , given the orders of magnitude difference in the spatial resolution ( a factor of 64 ) .",
    "once again , the discrepancies between the coronal density and the total energy for different values of @xmath24 are not due to any significant heat flux limiting caused by inadequate spatial resolution in the transition region .",
    "the right - hand column of figure  [ fig5 ] reveals a clue to what is actually behind the discrepancies .",
    "the common assumption is that the heat flux drives _ chromospheric _ ablation , where the excess energy carried by the heat flux that is not radiated by the transition region heats the chromosphere ( a poor radiator ) , which then expands upwards and carries with it an enthalpy flux in the opposite direction to the heat flux .",
    "however , the return enthalpy flux is severely diminished at low transition region spatial resolution , which is indicative of an alternative scenario . if it were purely chromospheric ablation then , since most of the heat flux is accounted for even at small @xmath24 , the resulting ablation and enthalpy flux should reflect the agreement between the heat fluxes for different values of @xmath24 . evidently this is not the case and a significant amount of energy is somehow lost before it is converted into enthalpy at low spatial resolution .",
    "the true physics of ablation are as follows . at low spatial resolution , where the transition region is effectively a discontinuity",
    ", the heat flux jumps from the corona to the chromosphere where the incoming energy is strongly radiated ( the chromosphere is an inefficient radiator relative to its density , but it _ is _ dense ) , leaving little left over to heat the plasma and drive ablation . at high spatial resolution the heat flux passes through the transition region in a series of steps and at each step some energy is radiated , some goes into local heating and expansion  /  ablation , and the remainder continues on .",
    "more and more energy is radiated with increasing depth in the transition region since the volumetric loss rate scales as @xmath64 .",
    "ultimately , depending on the magnitude of the initial heat flux , a proportion of the original heat flux will make it to the chromosphere , but a significant contribution to the upward material and enthalpy flux will have been made by transition region plasma .",
    "this contribution is neglected in low resolution runs , with the resultant discrepancies between the coronal density and the total energy .",
    "it may also partially explain why observational evidence of the upflows that must somehow fill the corona has been so difficult to provide ; there is no single , dominant source of plasma and instead the corona is filled in a more piece - meal fashion .",
    "s , when the coronal density is approximately half of its peak value .",
    "upper - left panel : electron temperature profile in the foot - point region for @xmath52 ( solid ) , @xmath39 ( dotted ) and @xmath61 ( dashed ) ; the curves of the stack - plot are offset by 3.0  dex ( @xmath39 ) and 6.0  dex ( @xmath61 ) ; the spacing of the diamond symbols indicates the spatial resolution .",
    "upper - right panel : divergence of the heat flux .",
    "lower - right panel : radiative losses .",
    "lower - left panel : estimate of the net heating ; where this quantity is greater than zero then energy is available to drive an upflow ; for @xmath52 the solid line connected by diamond symbols shows where the net heating is greater than zero and the solid line without diamonds shows where it is less than zero.,scaledwidth=100.0% ]    figure  [ fig6 ] confirms this conclusion .",
    "the upper - left panel shows the electron temperature profile in the foot - point region for the @xmath65 $ ] runs of group  3 , approximately halfway through the ablation phase .",
    "group  3 has been selected for detailed analysis because it imposes very severe constraints on the spatial resolution ( see table  [ table1 ] and figure  [ fig1 ] ) .",
    "the temperature gradient is extremely poorly resolved in the @xmath52 case to the extent that there are no data points for temperatures of o(10@xmath66 )  k. the upper - right panel shows that for @xmath52 a large amount of energy is deposited by the incoming heat flux in the grid cell at @xmath67  cm , corresponding to @xmath68  k , and then it steeply falls away .",
    "the lower - right panel shows strong radiation from the same grid cell and the lower - left panel shows that at this critical grid cell there is no energy left over to drive ablation . for @xmath63 $ ]",
    "it is clear that there is a net heating throughout the region of the steep temperature gradient and so energy is available to ablate the increasingly dense plasma found there , driving it upward and leading to enhanced coronal densities compared with @xmath52 .",
    "the transition region  /  corona interface is properly described as the location where the heat flux transitions from a sink ( the corona ) to a source ( the transition region ) as defined by @xcite .",
    "the upper - right panel of figure  [ fig6 ] shows that this extends beyond @xmath69  cm for the @xmath63 $ ] runs ( actually to @xmath70  cm ) and to about @xmath71  cm for the @xmath52 run .",
    "the steep temperature gradient may then be thought of as the lower transition region and , since the energy deposited by the heat flux in the upper transition region is quite similar for @xmath65 $ ] , then the dominant source of coronal plasma is the lower transition region .",
    "it is also interesting to note that under - resolving the transition region evidently leads to an underestimate of its spatial scale , despite the similarities in the time evolution of the average temperature between the runs at this time .",
    "other groups with severe resolution constraints show the same result .",
    "thus the mechanics of ablation are far more dependent on resolving the lower transition region and treating its radiative properties correctly than being overly concerned with the energetics of the chromosphere .",
    "this is the underlying reason why relatively simple treatments of the chromosphere , particularly in flare modeling , can yield similar results to those that are more sophisticated ; the chromosphere does not make the dominant contribution .",
    "of course , the more sophisticated treatments are necessary for detailed spectral modeling of chromospheric emission .",
    "the nature of the interaction between the corona and the chromosphere , mediated by the transition region , also explains why the density oscillations , caused by ablated material sloshing back and forth in the corona , are rapidly damped in the under - resolved cases .",
    "when there is inadequate spatial resolution the wave energy falls over the transition region cliff to be radiated away by the chromosphere , whereas in the well - resolved cases the effective refractive index of the transition region is greater , leading to more of the wave energy being reflected from the steep density gradient and back into the corona .",
    "the results presented here demonstrate that the principal effect of lack of transition region resolution is on the coronal density . in this section",
    "we explore a number of questions that arise and are of importance to constructing numerical models of the outer solar atmosphere .      we have demonstrated in this paper that one can run 1d hd models using highly refined adaptive grids ( tens of m ) for several hours real ( solar ) time",
    "the situation with multi - dimensional mhd models is more complicated for several reasons :    \\(i ) a limit on resolution is imposed by the scale of the simulation being run .",
    "a contemporary massively parallel code such as bifrost @xcite can run something of the order @xmath72 cells ( depending on available resources ) and the grid can be stretched in one dimension , permitting a fixed concentration of points where any transition region is expected .",
    "[ adaptive grids are more complex to implement in 3d mhd since there are many places that one might require high resolution , such as current sheets , in addition to the transition region . ] as examples of contemporary 3d codes , @xcite have cells of 150  km in the vertical direction , @xcite 230  km , decreased subsequently by @xcite to 75  km .",
    "these correspond to @xmath73 .",
    "all these papers discuss relatively cool loops , with temperatures of order 1 mk , so are closest to our group 1 ( weakest heating for short loops ) where we find @xmath74 is needed ( table  [ table1 ] ) .",
    "this suggests that the resolution is adequate for these particular cases , though even marginally higher temperatures will result in inadequate resolution .",
    "the bifrost code solves for thermal conduction on a sub - grid with the potential for good resolution equivalent to @xmath61 , however at the present time a resolution of up to 25  km is used ( gudiksen , private communication , 2013 ) : we discuss other aspects of their implementation technique below .",
    "\\(ii ) other solutions have been proposed in order to sidestep the need for high resolution , such as an artificial reduction of @xmath4 .",
    "this would appear to permit significantly greater timesteps , but by mitigating the cooling role of conduction , higher coronal temperatures are maintained , which will tend to push the timestep back to shorter values .",
    "@xcite also propose lowering the thermal conduction coefficient , but comment that `` the results must be carefully analysed '' .",
    "@xcite proposed an alternative formalism for @xmath75 :    @xmath76\\ ] ]    where @xmath77\\ ] ]    here @xmath78 is a typical transition region temperature ( 0.2  mk say ) , and above ( below ) this temperature the heat flux approaches the spitzer value ( is decreased ) . for typical active region temperatures ,",
    "solution of the static equilibrium loop equations leads to a decrease of order two in the coronal density , as also noted by @xcite .",
    "subsequently , @xcite argues that if the radiative losses are also diminished such that @xmath79 is unchanged , one can recover proper coronal densities : indeed for static loops , we find the difference is @xmath80 .",
    "however , it is unclear how successfully this formalism translates into dynamic evolution .",
    "the increase in coronal density after heating arises precisely because the transition region is not in equilibrium : the downward heat flux exceeding the radiative losses , leading to an upward enthalpy flux ( see * ? ? ?",
    "* ; * ? ? ?",
    "* ) . in the decay of impulsive events ,",
    "the coronal properties are governed by a downward enthalpy flux responsible for the transition region radiation : conduction plays a minimal role @xcite .",
    "in addition , the physical definition of the transition region is such that the transition region  /  corona interface is located where the supporting flux transitions between a sink and a source @xcite .",
    "the transition region is _ not _ simply anywhere that @xmath81  mk .",
    "the characteristic temperature of the transition region can change dramatically during the heating and cooling cycle ; from several mk in hot ar cores and during flares , to below 1  mk during the later stages of cooling .",
    "it is therefore unclear how one should choose the quantity @xmath78 at each stage of the numerical calculation .",
    "studies are clearly required to validate this approximation : its benefits are considerable in terms of the run time of a 3d code and even a 1d code ( e.g. for flares ) ; its disadvatages are that any transition region spectral line properties are unlikely to be relevant .",
    "\\(iii ) another issue that may arise with 3d mhd codes is the reluctance to use the conservative form of the energy equation .",
    "this arises because in a conservative mhd code , one calculates the plasma pressure by subtracting the magnetic field energy density ( and kinetic energy density ) from the total energy density : for a low @xmath82 plasma , typical of the corona , the pressure is then the difference between two large numbers , leading to a possibility of negative pressure .",
    "there are in fact forms of the energy equation that get around this ( see * ? ? ?",
    "* ) , but these run into difficulties in modeling shocks . in under - resolved non - conservative simulations , it is unclear whether the lack of conservation of energy is a problem .",
    "some benchmarking is required .",
    "\\(iv ) some 3d codes use operator splitting , or time - splitting , in the interests of computational efficiency ( e.g. not solving the mhd equations on a conductive timescale ) .",
    "here the various parts of the energy equation are solved separately .",
    "for example , @xcite solve the conduction and radiation parts of the equation separately , and then feed the new temperature back into the mhd equations .",
    "@xcite solve the conduction equation implicitly on a fine grid , and then generate a smoothed solution to feed into the mhd equations .",
    "it is unclear to us whether such procedures guarantee , for example , the correct interaction between a downward conductive flux , and the response through an upflow .",
    "for the benign problems discussed in @xcite and @xcite there may not be an issue .",
    "but a benchmarking of such procedures seems to be needed .    to close this part of the discussion ,",
    "we recommend that those using 3d mhd codes to study the interaction between corona , transition region and chromosphere carry out a set of `` resolution tests '' as we have done here with more extreme coronal temperatures than those published .",
    "this can be accomplished by reducing the 3d code to a 1d one , while keeping the overall 3d grid structure , with the remaining coordinate aligned along a straight magnetic field .",
    "such a comparison will provide confidence in how the 3d codes address this important aspect of modeling the solar atmosphere .",
    "our numerical experiments have employed a fully explicit 1d hd code , which forces us to resolve the principle physical timescales of the system at each stage of its evolution .",
    "other workers have resorted to implicit solvers for their 3d mhd codes ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "the advantage of , for example , an implicit crank - nicolson scheme is that it is guaranteed to be numerically stable .",
    "some sort of iteration is undertaken in multi - dimensions ( e.g. a successive over - relaxation ( sor ) scheme : * ? ? ?",
    "* ) , with a criteria for convergence being a small discrepency in the temperature ( either averaged , or pointwise ) between iterations .",
    "this can slow down an implicit scheme if the number of iterations is large , or , worse , if convergence never occurs .",
    "such implicit schemes are useful for a slowly - evolving system or one seeking equilibria , where long wavelength behaviour dominates , and one is not concerned with temperature fluctuations over one or two grid points .",
    "however for general applications one must always bear in mind the various physical timescales that are of interest .",
    "the most important one here is the time it takes a conduction front to cross a grid cell , where the cell is narrow enough to resolve any temperature gradient . for a dynamic situation",
    ", one needs a `` courant condition '' for a conduction front : @xmath83 where @xmath84 is the velocity of the conduction front . for an analytic solution such as the zeldovich thermal wave @xmath84",
    "is known . however , in a simulation , one needs to calculate both @xmath8 and @xmath84 in real time .",
    "the former is accomplished through an adaptive grid .",
    "the latter is more challenging . an alternative way to impose",
    "this condition would be to require that the change in temperature in any cell be limited to some reasonably small fraction ( e.g. 20% ) , and adjust the timestep accordingly .",
    "such a secondary iteration ( in addition to the one needed to solve the diffusion equation itself ) would need careful implementation to avoid crippling computational costs .      besides the obvious implications for calculating the response of the lower layers of the atmosphere to heating and the subsequent energy transport , these results are collectively significant for spectral modeling and emission measure calculations .",
    "the differences between the electron temperature curves , though small , may lead to very different predictions for ionisation states and spectral line intensities because the temperature - dependent contribution functions tend to be very sharply peaked .",
    "consequently , small temperature differences matter .",
    "the much greater differences between the density curves are even more problematical .",
    "the emission measure and spectral line intensity scales as @xmath64 , so differences are non - linearly amplified , and time - dependent calculations of the ionisation state are likely to be strongly affected due to the density dependence of the collisional ionisation  /  recombination timescales .",
    "it is not difficult to identify the potential for forward modeling studies , in which numerical predictions are compared with real observational data , to yield misinterpretations and erroneous conclusions .",
    "this paper has addressed the role of numerical resolution in models of impulsive heating in the solar corona . a range of event sizes have been discussed , ranging from nanoflares to microflares to small flares .",
    "the principle effect of lack of numerical resolution is on the coronal density , which is decreased significantly in unresolved cases .",
    "the temperature also decreases , though not by as much .",
    "the implications are very significant for forward modeling , with the intensity of spectral lines being underestimated .",
    "also , the deviations of the temperature will lead to the incorrect prediction of dominant lines due to the sharply peaked contribution functions .    with a proper adaptive grid , we believe that the resolution problem is probably managable today for 1d hd models with a well structured code , and will certainly be managable in the future . for higher - dimension mhd codes ,",
    "present day models deal with a relatively cool corona ( 1  mk ) , and we noted earlier that adequate resolution was probably achieved with a structured ( as opposed to adaptive ) grid .",
    "however , the required resolution scales as a very high power of temperature , leading to ( a ) structured grids ultimately becoming uneconomical and ( b ) the need for adaption is equally pressing with other areas of the physics , such as in current sheet , leading to a huge accounting problem .",
    "some potential solutions to this have been discussed above , including modifying the conduction coefficient and sub - cycling the conductive timestep .    finally , we urge those running 1d hd and especially 3d mhd simulations to undertake a series of tests as we have done here to establish what resolution is really needed .",
    "sjb acknowledges the support of nasa through the supporting research and technology ( sr&t ) program .",
    "pc thanks alan hood for a number of useful discussions .",
    "the early ideas for this work arose from discussions that took place during an international team meeting ( led by sjb and dr .",
    "helen mason ) at the international space science institute ( issi ) in bern .",
    "we thank issi for their support and our team members for their contributions .",
    "we also thank the referee for helpful suggestions that improved the presentation .",
    "the evolution of the hydrad code used in this paper has been described in various publications @xcite . given its now widespread use , it is useful to describe all the developments of hydrad and the current capabilities of the code in one location .",
    "hydrad solves the one - dimensional , multi - fluid hydrodynamic equations for a full loop of arbitrary geometry .",
    "the mass and momentum equations reduce to the following conservative form :        where current and charge neutrality have been imposed , @xmath87 and @xmath3 are time and the field - aligned spatial coordinate , @xmath88 is the ion mass density ( @xmath89 : @xmath90 ) , @xmath91 is the bulk velocity of the flow , and @xmath92 is the field - aligned gravitational acceleration . here",
    "@xmath93 is the average ion mass , and accounts for the fact that while hydrogen is by far the most abundant element the presence of heavy metals has a non - negligible influence on the mass density and the bulk flow .",
    "ion viscosity is included using the classical spitzer viscosity coefficient .",
    "electron viscosity is negligible .",
    "there are separate energy equations for the electrons ( subscipt  e  ) and ions ( subscript  i  ) :      @xmath95 = -\\frac{\\partial f_{ci}}{\\partial s } - v\\frac{\\partial p_e}{\\partial s } + \\frac{k_b n}{\\gamma-1}\\nu_{ie}\\left(t_e - t_i\\right ) + \\frac{\\partial}{\\partial s}\\left(\\frac{4}{3 } mu_i v \\frac{\\partial v}{\\partial s}\\right ) + \\rho v g_{||}. \\label{eqna4}\\ ] ]            where @xmath98 and @xmath36 are the ion and electron temperatures , and @xmath99 is boltzmann s constant .",
    "the first term on the right - hand side of equations  [ eqna3 ] and [ eqna4 ] represents the thermally conducted flux carried by each particle species .",
    "the electron flux is written as :      and the ion flux in an analagous form .",
    "the spitzer coefficient for the electron thermal conduction is @xmath101 and we assume that protons dominate the ion thermal conduction , giving @xmath102 .",
    "a flux - limiter is built into the numerical code to ensure that the free - streaming limit is not exceeded and is discussed below ( see also * ? ? ?",
    "* ; * ? ? ?",
    "* ) . the second term on the right - hand side of equations  [ eqna3 ] and [ eqna4 ] @xmath103 , represents the electric potential ; the energy",
    "given - to  /  removed - from the particle species by the electric field when the separation between them becomes too large  /  small .",
    "the third term represents the thermal equilibration between the particle species via collisions , where @xmath104 is the coulomb collision frequency :      where @xmath106 is the coulomb logarithm .",
    "the gravitational potential energy has been included for the ions and neglected for the electrons .",
    "@xmath107 is the optically - thin radiative emission , which can be calculated using a set of piece - wise power laws , a fit to radiative loss curves calculated by the chianti atomic database for equilibrium ionization or a full non - equilibrium treatment of the radiating ions ( thermal bremmstrahlung is also included in the calculation ) .",
    "@xmath107 can also be calculated for optically - thick conditions in the lower atmosphere using the treatment given by @xcite and in this case the presence of neutral species is accounted for ( e.g. number density of neutrals , ions and electrons , inter - species collisions , thermal conduction of neutral hydrogen ) . however , in the present work the chromosphere is maintained at a uniform temperature ( 20,000  k ) by reducing the optically - thin radiative losses to zero over a specified temperature interval ( 100  k ) above the chromospheric temperature @xcite .",
    "@xmath108 is a parameterized , volumetric heating function , that depends on the field - aligned coordinate and  /  or time .",
    "the transport terms of the hydrodynamic equations are calculated using barton s method for monotonic transport and a staggered leapfrog algorithm to perform the time integration . @xcite",
    "provide a detailed discussion of barton s method , which is a simpler and more rugged version of the method devised by @xcite , and which works well even on highly discontinuous hydrodynamic problems . for a uniform grid ,",
    "the method is 2nd order in space away from the discontinuities and 2nd order in time . at discontinuities",
    "it reduces to first order in space to maintain fidelity to the nature of the solution in that region .",
    "all other ordinary and source  /  sink terms are spatially differenced and time integrated to 2nd order using standard runge - kutta methods @xcite .                for a non - uniform grid ,",
    "the conductive flux @xmath2 is calculated at the edge of cell @xmath109 in such a way as to limit the potential loss of spatial order in the derivatives that is known to arise when there are variations in the widths of adjacent grid cells @xcite .",
    "the temperature @xmath113 is first found by interpolation using a four - point stencil ( @xmath114 , @xmath115 , @xmath109 , @xmath116 ) ; however , if this 3rd order interpolation introduces a new local maximum or minimum then @xmath113 is calculated using a linear interpolation ( @xmath115 , @xmath109 ) . using the same four - point stencil the temperature @xmath117 is found at the position @xmath118 ( again , reduced to a linear interpolation if a new local max . or min .",
    "is introduced ) . the heat flux at the cell boundary is then given by :      this procedure is effectively equivalent to interpolating the temperature onto a locally uniform grid , centered at @xmath120 , where the cell width is @xmath121 .",
    "note that this procedure is used by hydrad to calculate all spatial gradients ( except for the transport terms ) on a non - uniform grid ( e.g. @xmath122 , etc . ) .",
    "an important aspect of hydrad is its adaptive grid , which is flexible enough to increase the numerical resolution wherever needed and so it can resolve as many discontinuities and  /  or steep gradients , for example , as arise in the calculation at any time . restriction ( refinement ) is carried out according to user - defined tolerances ( e.g. greater than 10% ) on cell - to - cell differences between some or all ( again , user - definable ) of the quantities @xmath88 , @xmath123 and @xmath124 .",
    "when hydrad detects that a grid cell needs to be restricted then it is split into two .",
    "the quantities @xmath88 , @xmath125 , @xmath123 and @xmath124 are calculated in the left - most of the two new cells by interpolation from the original cells @xmath114 , @xmath115 , @xmath109 and @xmath116 .",
    "similarly , these same quantities are calculated in the right - most of the two new cells by interpolation from the original cells @xmath115 , @xmath109 , @xmath116 and @xmath126 .",
    "cell @xmath109 is then removed from the linked - list that connects the grid cells and the two new cells are inserted in its place .",
    "the two new cells are also tagged with a unique identifier for each refinement level so that only the same two cells that resulted from the splitting of a single cell can be merged to form a single cell under prolongation .",
    "the user can specify the number of times that a grid cell can be split and this is the maximum refinement level .",
    "when hydrad detects that two grid cells ( @xmath109 and @xmath116 ) with the same unique identifier satisfy the criteria to be merged into a single cell ( e.g. cell - to - cell differences between quantities falls to less than 5% ) then the prolongation operator calculates @xmath88 , @xmath125 , @xmath123 and @xmath124 in the new cell by interpolation from the original cells @xmath115 , @xmath109 , @xmath116 and @xmath126 .",
    "cells @xmath109 and @xmath116 are then deleted from the linked - list and the new cell inserted in their place .",
    "the user can select linear interpolation for the restriction and prolongation operators if they expect that sharp features such as shocks and  /  or steep gradients might arise in their solutions . in this case , just the inner two points of the stencils described above are used .",
    "the four - point polynomial interpolation routine also checks for new local minima or maxima and reduces to a linear interpolation if necessary . the adaptive grid algorithm employed by hydrad limits the variation in the widths of adjacent cells to a single refinement level as a precaution against the loss of order in calculating spatial derivatives on non - uniform grids @xcite .              and finite difference this in the usual 3-point manner .",
    "we have compared these with equations  [ eqna9 ] and [ eqna10 ] by solving the zeldovich problem of a propagating heat front @xcite . for a resolved front",
    ", the solution agrees well with the analytical one for all three methods . for an unresolved heat front ( i.e. a case where the major temperature jump at the leading edge of the front is over one cell ) ,",
    "the three finite difference schemes give heat fluxes at the leading edge that differ by up to a factor two .",
    "while our tests show that this has little effect on the propagation of the conduction front , it is worth bearing in mind when more complex problems are solved .",
    "also , it should be noted that the mathematically most satisfactory formalism of conduction , involving the variable @xmath130 , can not be used in implicit numerical schemes .",
    "heat flux saturation becomes important in many of our experiments , especially at the most energetic extremes of the heating parameter space that we explore .",
    "the flux - saturation ( or free - streaming ) limit describes the maximum conducted heat flux that the plasma is capable of supporting .",
    "a reasonable estimate of this limit can be obtained by assuming that it is reached when all of the particles travel in the same direction at the electron thermal speed .",
    "@xcite give the saturated heat flux as :      where the subscript @xmath132 denotes the particle species ( electrons or ions ) .",
    "more accurate kinetic models ( e.g. fokker - planck calculations ) suggest that equation  [ eqna15 ] should be multiplied by a factor @xmath133 . to ensure a smooth transition between heat flux regimes (",
    "saturated and unsaturated ) in hydrad we use the form :      where @xmath135 is the heat flux calculated in the spitzer - hrm approximation ( e.g. equation  [ eqna9 ] above ) and @xmath136 is evaluated at the cell boundary , assuming that the density @xmath35 remains approximately constant across the grid cell . @xcite found that heat flux saturation does not arise in loops that have reached ( or are close to ) hydrostatic equilibrium , but it does seem essential to include in all dynamic coronal modeling codes ."
  ],
  "abstract_text": [
    "<S> the effect of the numerical spatial resolution in models of the solar corona and corona  /  chromosphere interface is examined for impulsive heating over a range of magnitudes using one dimensional hydrodynamic simulations . </S>",
    "<S> it is demonstrated that the principle effect of inadequate resolution is on the coronal density . </S>",
    "<S> an under - resolved loop typically has a peak density of _ at least _ a factor of two lower than a resolved loop subject to the same heating , with larger discrepencies in the decay phase . </S>",
    "<S> the temperature for under - resolved loops is also lower indicating that lack of resolution does not `` bottle up '' the heat flux in the corona . </S>",
    "<S> energy is conserved in the models to under 1% in all cases , indicating that this is not responsible for the low density . </S>",
    "<S> instead , we argue that in under - resolved loops the heat flux `` jumps across '' the transition region to the dense chromosphere from which it is radiated rather than heating and ablating transition region plasma . </S>",
    "<S> this emphasises the point that the interaction between corona and chromosphere occurs only through the medium of the transition region . </S>",
    "<S> implications for three dimensional magnetohydrodynamic coronal models are discussed . </S>"
  ]
}