{
  "article_text": [
    "this paper introduces a new variational integrator for a spherical pendulum .",
    "the configuration space for this pendulum is a two - dimensional sphere .",
    "calculations in spherical coordinates are not a good option because of unavoidable artificial singularities introduced by these coordinates at the poles . in addition , the topology of a sphere makes it impossible to use global singularity - free intrinsic coordinates .    in order to avoid the issues mentioned above ,",
    "an integrator that utilizes the interpretation of a sphere as a homogeneous space was introduced in @xcite .",
    "this integrator performs very well , but has a somewhat large degree of redundancy .",
    "this paper targets the development of an integrator whose performance is similar to that of the integrator in @xcite and whose redundancy is the minimum possible .    both the present paper and @xcite interpret the pendulum as a rotating rigid body .",
    "the algorithm introduced in @xcite is based on the evaluation of the rotation matrix that represents the attitude for this body .",
    "the key feature of the dynamics utilized in the present paper is that , in order to capture the orientation of a rigid body , it is sufficient to evaluate just one column of that rotation matrix .",
    "the resulting equations of motion are interpreted as hamel s equations written in redundant coordinates .",
    "the general exposition of discrete hamel s formalism will be a subject of a future publication .",
    "here we demonstrate the usefulness of some of this formalism by constructing an integrator for a spherical pendulum that is energy- and momentum - preserving .",
    "the calculations are carried out in the cartesian coordinates of the three - dimensional euclidean space .",
    "this allows one to avoid singularities and/or multiple coordinate charts that are inevitable for calculations on a sphere .",
    "hamel s approach allows one , among other things , to represent the dynamics in such a way that the length constraint becomes unnecessary .",
    "thus , one avoids the well - known difficulty of numerically solving differential - algebraic equations .",
    "the paper is organized as follows .",
    "hamel s formalism and its discretization are briefly discussed in sections [ mech.sec ] and  [ disc_mech.sec ] .",
    "the dynamics of a spherical pendulum is reviewed in section  [ pendulum.sec ] .",
    "the discrete model for the pendulum based on hamel s formalism , its comparison to some other discretization techniques , and simulations are given in sections [ discr_pend.sec ] , [ comparison.sec ] , and [ simulations.sec ] .",
    "a lagrangian mechanical system is specified by a smooth manifold @xmath0 called the _ * configuration space * _ and a function @xmath1 called the _ * lagrangian*_. in many cases , the lagrangian is the kinetic minus potential energy of the system , with the kinetic energy defined by a riemannian metric and the potential energy being a smooth function on the configuration manifold @xmath0 . if necessary , non - conservative forces can be introduced ( e.g. , gyroscopic forces that are represented by terms in @xmath2 that are linear in the velocity ) , but this is not discussed in detail in this paper .",
    "in local coordinates @xmath3 on the configuration space @xmath0 we write @xmath4 .",
    "the dynamics is given by the * _ euler  lagrange equations _",
    "* @xmath5    these equations were originally derived by lagrange @xcite in 1788 by requiring that simple force balance @xmath6 be _ covariant _ , _ i.e. _  expressible in arbitrary generalized coordinates . a variational derivation of the euler ",
    "lagrange equations , namely hamilton s principle ( also called the principle of critical action ) , came later in the work of hamilton @xcite and @xcite in 1834/35 . for more details , see @xcite , @xcite , and theorem  [ equivalence.thm ] below .      in this paragraph",
    "we briefly discuss the hamel equations .",
    "the exposition follows paper @xcite .    in many cases",
    "the lagrangian and the equations of motion have a simpler structure when written using velocity components measured against a frame that is unrelated to system s local configuration coordinates .",
    "an example of such a system is the rigid body .",
    "let @xmath7 be local coordinates on the configuration space @xmath0 and @xmath8 , @xmath9 , be smooth independent _ local _ vector fields defined in the same coordinate neighborhood .",
    "can be chosen to be _ global _ vector fields on @xmath0 . ]",
    "the components of @xmath10 relative to the basis @xmath11 will be denoted @xmath12 ; that is , @xmath13 where @xmath14 and where summation on @xmath15 is understood .",
    "let @xmath16 be the components of the velocity vector @xmath17 relative to the basis @xmath18 , _",
    "i.e. _ , @xmath19 then @xmath20 is the lagrangian of the system written in the local coordinates @xmath21 on the tangent bundle @xmath22 .",
    "the coordinates @xmath21 are lagrangian analogues of non - canonical variables in hamiltonian dynamics .",
    "define the quantities @xmath23 by the equations @xmath24",
    "= c^m_{ij } ( q ) u_m ( q),\\ ] ] @xmath25 .",
    "these quantities vanish if and only if the vector fields @xmath26 , @xmath27 , commute . here and elsewhere , @xmath28 $ ] is the jacobi  lie bracket of vector fields on @xmath0 .",
    "viewing @xmath10 as vector fields on @xmath22 whose fiber components equal @xmath29 ( that is , taking the vertical lift of these vector fields ) , one defines the directional derivatives @xmath30 $ ] for a function @xmath31 by the formula @xmath32 = \\psi_i^j \\frac{\\partial l}{\\partial q^j}.\\ ] ]    the evolution of the variables @xmath33 is governed by the * _ hamel equations _",
    "* @xmath34.\\ ] ] coupled with equations . if @xmath35 , equations become the euler ",
    "lagrange equations  .",
    "equations were introduced in @xcite ( see also @xcite for details and some history ) .",
    "let @xmath36\\to q$ ] be a smooth curve in the configuration space .",
    "a * _ variation _ * of the curve @xmath37 is a smooth map @xmath38 \\times [ - \\varepsilon , \\varepsilon ] \\to q$ ] that satisfies the condition @xmath39 .",
    "this variation defines the vector field @xmath40 along the curve @xmath37 .",
    "[ equivalence.thm ]    for the proof of theorem [ equivalence.thm ] and the early development and history of these equations , as well as other variational structures associated with hamel s equations see @xcite ,  @xcite , @xcite , and @xcite .",
    "a discrete analogue of lagrangian mechanics can be obtained by discretizing hamilton s principle ; this approach underlies the construction of variational integrators . see marsden and west  @xcite , and",
    "references therein , for a more detailed discussion of discrete mechanics .",
    "a key notion is that of the _ * discrete lagrangian * _ , which is a map @xmath41 that approximates the action integral along an exact solution of the euler ",
    "lagrange equations joining the configurations @xmath42 , @xmath43,q ) } \\int_0^h l(q,\\dot q)\\,dt,\\ ] ] where @xmath44,q)$ ] is the space of curves @xmath45\\rightarrow q$ ] with @xmath46 , @xmath47 , and @xmath48 denotes extremum .    in the discrete setting ,",
    "the action integral of lagrangian mechanics is replaced by an action sum @xmath49 where @xmath50 , @xmath51 , is a finite sequence in the configuration space .",
    "the equations are obtained by the _ * discrete hamilton s principle * _ , which extremizes the discrete action given fixed endpoints @xmath52 and @xmath53 .",
    "taking the extremum over @xmath54 gives the _ discrete euler ",
    "lagrange equations _",
    "@xmath55 for @xmath56 .",
    "this implicitly defines the update map @xmath57 , where @xmath58 and @xmath59 replaces the velocity phase space @xmath22 of lagrangian mechanics .    in the case",
    "that @xmath0 is a vector space , it may be convenient to use @xmath60 , where @xmath61 and @xmath62 , as a state of a discrete mechanical system .",
    "in such a representation , the discrete euler ",
    "lagrange equations become @xmath63 these equations are equivalent to the variational principle @xmath64 where the variations @xmath65 and @xmath66 are induced by the variations @xmath67 and are given by the formulae @xmath68      in order to construct the discrete hamel equations for a given mechanical system , one starts by selecting the vector fields @xmath69 and computing the lagrangian @xmath70 given by .",
    "one then discretizes this lagrangian ( we only discuss the mid - point rule here ) and obtains @xmath71 note that the discretization in is carried out _ after _ writing the continuous - time lagrangian as a function of @xmath21 .",
    "one of the challenges of discretizing the hamel equations has been understanding the discrete analogue of the bracket term in . until recently , it was only known how to handle this for systems on lie groups",
    "( see e.g.  @xcite and @xcite ) . in the discrete model of a spherical pendulum discussed below ,",
    "these terms vanish , and we will not discuss the approach to discretize the bracket terms in this paper ( details on this topic can be found in @xcite ) .",
    "the analogue of the variational principle is obtained by setting @xmath72 where @xmath73 is the discrete analogue of the bracket term in .",
    "the discrete hamel equations read @xmath74 where @xmath75 is the directional derivative given by the formula @xmath76 and where @xmath77 is the discrete analogue of the bracket term of the continuous - time hamel equations .",
    "as mentioned above , this term vanishes for the spherical pendulum problem , and is therefore not explicitly shown here ( see @xcite for details ) . equations along with the discrete analogue of equations define the update map @xmath78 .",
    "consider a spherical pendulum whose length is @xmath79 and mass is @xmath80 .",
    "we view the pendulum as a point mass moving on the sphere of radius @xmath79 centered at the origin of @xmath81 .",
    "the development here is based on the representation @xmath82 of the dynamics of a spherical pendulum , where the pendulum is viewed as a rigid body rotating about a fixed point . here",
    "@xmath83 is the angular velocity of the pendulum , @xmath84 is its angular momentum , @xmath85 is the unit vertical vector ( and thus the constraint @xmath86 is imposed ) , and @xmath87 is the torque produced by a force acting on the pendulum , all written relative to the body frame . throughout the paper ,",
    "boldface characters represent three - dimensional vectors .",
    "note that the projection of @xmath87 on  @xmath85 is zero .",
    "we assume here that the force is conservative , with potential energy @xmath88 . for the pendulum , @xmath89 , where @xmath90 is the vector from the origin to the pendulum bob . note that the potential energies for forces like gravity are invariant with respect to rotations about  @xmath85 .",
    "there are two independent components in equation .",
    "we emphasize that this representation , though redundant , eliminates the use of local coordinates on the sphere , such as spherical coordinates .",
    "more details on this appear below .",
    "spherical coordinates , while being a nice theoretical tool , introduce artificial singularities at the north and south poles .",
    "that is , the equations of motion written in spherical coordinates have denominators vanishing at the poles , but this has nothing to do with the physics of the problem and is solely caused by the geometry of the spherical coordinates .",
    "thus , the use of spherical coordinates in calculations is not advisable .",
    "another important remark is that the length of the vector  @xmath91 is a _ conservation law _ of equations and , @xmath92 and thus adding the constraint @xmath86 _ does not _ result in a system of differential - algebraic equations .",
    "the latter are known to be a nontrivial object for numerical integration .",
    "equations and may be interpreted in a number of ways .",
    "for instance , one can view them as the dynamics of a degenerate rigid body . for this interpretation ,",
    "select an orthonormal body frame with the third vector aligned along the direction of the pendulum .",
    "the inertia tensor relative to such a frame is @xmath93 , and the lagrangian reads @xmath94 with this frame selection , the third component of the angular momentum of the body vanishes , @xmath95 and thus there are only two nontrivial equations in .",
    "thus , one needs five equations to capture the pendulum dynamics .",
    "this reflects the fact that rotations about the direction of the pendulum have no influence on the pendulum s motion .",
    "the dynamics then can be simplified by setting @xmath96 .    alternatively , and may be interpreted as the dynamics of the _ suslov problem _ ( see @xcite and @xcite ) for a rigid body with a rotationally - invariant inertia tensor and constraint @xmath97 .",
    "using either interpretation , the dynamics is represented by the system of five first - order differential equations @xmath98    the latter equations are in fact hamel s equations written in the redundant coordinates @xmath99 relative to the frame @xmath100 recall that the length of @xmath85 is the conservation law , so that the constraint @xmath86 does not need to be imposed , but the appropriate level set of the conservation law needs to be selected .",
    "our discretization will be based on this point of view , i.e. , the discrete dynamics will be written in the form of discrete hamel s equations .",
    "the discrete dynamics will posses the discrete version of the conservation law , so that the algorithm should be capable , in theory , of preserving the length of @xmath85 up to machine precision .",
    "the integrator for a spherical pendulum is constructed by discretizing hamel s equations and .",
    "let the positive real constant @xmath101 be the time step . applying the mid - point rule to ,",
    "the discrete lagrangian is computed to be @xmath102 here @xmath103 is the discrete analogue of the angular velocity @xmath104 and @xmath105 .",
    "the discrete dynamics then reads @xmath106 or , in components , @xmath107    the discretization of equation is constructed to be @xmath108-preserving . indeed , using the isomorphism @xmath109 between the spaces of three - dimensional vectors @xmath110 and skew - symmetric matrices @xmath111 equation becomes @xmath112 where @xmath113 it is straightforward to check that the matrix @xmath114 is orthogonal ( it is simply the cayley transform of @xmath115 ) , and therefore @xmath116 .",
    "as expected , the discrete dynamics is momentum - preserving : @xmath117 i.e. , the vertical component of spatial momentum is conserved .",
    "this can be verified either using general symmetry arguments , or by a straightforward calculation .    the discrete dynamics is energy - preserving : @xmath118 + mgr \\gamma_{k+1/2}^3 = \\mathrm{const}.\\ ] ] this is confirmed by multiplying equations and by @xmath119 and @xmath120 , respectively , and adding the result to equation .    to recap , the proposed method preserves the symplectic structure , the length constraint , and the momentum , so by a result due to ge and marsden @xcite , the proposed method recovers the exact trajectory , up to a possible time reparameterization .",
    "the proposed method takes advantage of the homogeneous space structure of @xmath121 , which has a transitive lie group action by @xmath122 .",
    "in particular , the vector @xmath123 is updated by the left action of a rotation matrix , given by the cayley transformation of a skew - symmetric matrix @xmath115 that approximates the angular momentum @xmath124 integrated over a half - timestep .",
    "interestingly , this falls out naturally from discretizing the hamel formulation of the spherical pendulum , and it would be interesting to see what general choices of coordinate frames in the hamel formulation lead to similar methods for more general flows on homogeneous spaces .",
    "we will now discuss some alternative methods of simulating the spherical pendulum equations .",
    "if one were to instead formulate the spherical pendulum problem directly on @xmath121 , it is possible to lift the variational principle on @xmath121 to @xmath122 , by relating the curve @xmath125 with a curve @xmath126 , by the relation @xmath127 , where @xmath128 , except that the resulting variational principle on @xmath122 does not have a unique extremizer , due to the presence of a nontrivial isotropy subgroup . with a suitable choice of connection",
    ", this ambiguity can be eliminated , and the resulting problem ( and similar problems on homogeneous spaces ) can be solved using lie group variational integrator techniques , as described in @xcite .      as mentioned in section [ pendulum.sec ] ,",
    "the spherical pendulum equations can be viewed as a suslov problem , which is an example of a nonholonomic mechanical system with no shape space . in principle",
    ", one could apply a nonholonomic integrator , such as the one described in @xcite and @xcite , but replacing the length constraint with an infinitesimal constraint and a discrete nonholonomic constraint may result in poor numerical preservation of the constraint properties if the discrete nonholonomic constraint is poorly chosen .",
    "an alternative approach to simulating nonholonomic mechanics involves a discretization of the forces of constraint , and a careful choice of force discretization has been shown to yield promising results , see @xcite for details .",
    "given the relatively simple nature of the unit length constraint , it is quite natural to apply the rattle algorithm  @xcite , which is a generalization of the strmer  verlet method for constrained hamiltonian systems that is designed to explicitly preserve holonomic constraints .",
    "this method does require the use of a nonlinear solver on a system of nonlinear equations of dimension equal to the number of constraints .",
    "the cost of the nonlinear solve can increase significantly as the number of copies of the sphere in the configuration space increases .",
    "the proposed discrete hamel integrator can be easily scaled to an arbitrary number of copies of the sphere , possibly chained together in a @xmath129-spherical pendulum .",
    "such multi - body systems however pose significant challenges for differential - algebraic equation solvers , since they are examples of what are referred to as high - index daes , for which the theory and numerical methods are much less developed .",
    "it is possible to perform index reduction on the system of differential - algebraic equations , but this involves significant effort , and the numerical results can be mixed .",
    "since the method is a second - order accurate symplectic method , it is natural to compare it to the strmer  verlet method , as well as the rattle method ( which is a generalization of strmer  verlet for constrained hamiltonian systems ) .    for the strmer  verlet method , we compute hamilton s equations for the spherical pendulum , which is given by @xmath130 and we apply the generalization of the strmer  verlet method for general partitioned problems ( see ( 3.4 ) in @xcite ) , @xmath131",
    "this system of equations is linearly implicit , since the first equation is implicit in @xmath132 , but the rest of the equations are explicit .",
    "the rattle method ( see ( 1.26 ) in @xcite ) can be applied to the particle in a uniform gravitational field problem , @xmath133 subject to the constraint @xmath134 .",
    "we also introduce @xmath135 .",
    "then , the rattle method applied to this problem is given by , @xmath136",
    "in figures [ hvi.fig ] and [ trajectory2.fig ] , we present simulations using our theory developed above , which we compare with simulations using the generalized strmer  verlet method and the rattle method in figures [ sv.fig ] and [ rattle.fig ] , respectively .    for simulations ,",
    "we select the parameters of the system and the initial conditions to be @xmath137 , @xmath138 , @xmath139 , @xmath140 , @xmath141 , @xmath142 , @xmath143 , @xmath144 .",
    "the trajectory of the bob of the pendulum is shown in figure [ trajectory.fig ] .",
    "as expected , it reveals the quasiperiodic nature of pendulum s dynamics .",
    "theoretically , if one solves the nonlinear equations exactly , and in the absence of numerical roundoff error , the hamel variational integrator should exactly preserve the length constraint , and the energy . in practice ,",
    "figure [ norm.fig ] demonstrates that @xmath108 stays to within unit length to about @xmath145 after 10,000 iterations .",
    "figure [ energy.fig ] demonstrates numerical energy conservation , and the energy error is to about @xmath145 after 10,000 iterations as well .",
    "indeed , one notices that the energy error tracks the length error of the simulation , which is presumably due to the relationship between the length of the pendulum and the potential energy of the pendulum .",
    "the drift in both appear to be due to accumulation of numerical roundoff error , and could possibly be reduced through the use of compensated summation techniques .",
    "+   +    figure [ trajectory2.fig ] shows pendulum s trajectory that crosses the equator .",
    "this simulation demonstrates the global nature of the algorithm , and also seems to do a good job of hinting at the geometric conservation properties of the method .",
    "we also simulate the spherical pendulum using the generalized strmer  verlet method and the rattle method described in section [ comparison.sec ] . the generalized strmer ",
    "verlet method exhibits surprisingly good unit length preservation in figure [ sv_norm.fig ] of @xmath146 when applied to index - reduced version of the equations of motion .     +   +    the energy behavior in figure [ sv_energy.fig ] is typical of a symplectic integrator , with the characteristic bounded energy oscillations .",
    "even though the rattle method is intended to explicitly enforce the unit length constraint , it exhibits a unit length preservation in figure [ rattle_norm.fig ] of @xmath147 , which is poorer than both the hamel variational integrator and the generalized strmer  verlet method .",
    "the energy error for rattle in figure [ rattle_energy.fig ] is comparable to that of the generalized strmer ",
    "verlet method , but both pale in comparison to the energy error for the hamel variational integrator .",
    "in this paper , we constructed a variational integrator for the spherical pendulum by discretizing hamel s equations .",
    "we showed the integrator preserves key mechanical quantities and illustrated the work with simulations , and comparisons with the generalized strmer ",
    "verlet method and the rattle method .",
    "future work will include the simulation of linked rigid body systems as well as the control of such systems .",
    "the excellent numerical properties of the proposed hamel variational integrator will serve as an excellent basis for constructing numerical optimal control algorithms , which are heavily dependent on the quality of the numerical discretization of the natural dynamics .",
    "the authors would like to thank the reviewers for valuable comments .",
    "the research of amb was partially supported by nsf grants dms-0806765 , dms-0907949 and dms-1207993 .",
    "the research of ml was partially supported by nsf grants dms-1010687 , cmmi-1029445 , and dms-1065972 .",
    "the research of dvz was partially supported by nsf grants dms-0306017 , dms-0604108 , dms-0908995 , and dms-1211454 .",
    "k.  ball , d.  v. zenkov , and a.  m. bloch , `` variational structures for hamel s equations and stabilization '' , _ proceedings of the 4th ifac workshop on lagrangian and hamiltonian methods for non linear control _ , pp . 178183 , 2012 .",
    "t.  lee , m.  leok , and n.  mcclamroch , `` lagrangian mechanics and variational integrators on two - spheres , '' _ international journal for numerical methods in engineering _ , vol .",
    "79 , no .  9 , pp . 11471174 , 2009 .",
    "c.  lynch and d.  v. zenkov , `` stability of stationary motions of discrete - time nonholonomic systems , '' in v.  v. kozlov , s.  n. vassilyev , a.  v. karapetyan , n.  n. krasovskiy , v.  n. tkhai , and f.  l. chernousko , eds . , _ problems of analytical mechanics and stability theory .",
    "collection of papers dedicated to the memory of academician valentin v. rumyantsev_.1em plus 0.5em minus 0.4emmoscow : fizmatlit , pp . 259271 , 2009 ."
  ],
  "abstract_text": [
    "<S> this paper discusses hamel s formalism and its applications to structure - preserving integration of mechanical systems . </S>",
    "<S> it utilizes redundant coordinates in order to eliminate multiple charts on the configuration space as well as nonphysical artificial singularities induced by local coordinates , while keeping the minimal possible degree of redundancy and avoiding integration of differential - algebraic equations . </S>"
  ]
}