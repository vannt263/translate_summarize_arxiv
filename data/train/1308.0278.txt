{
  "article_text": [
    "experimental evidence has recently been accumulating to suggest that fitness landscape ruggedness is common in a variety of organisms .",
    "rugged landscapes arise from interactions between genetic variants , called epistasis , which can lead to fitness valleys or plateaus .",
    "the time needed to cross such fitness valleys or plateaus exhibits a rich dependence on population size , since stochastic effects have higher importance in small populations , increasing the probability of fixation of neutral or deleterious mutants .",
    "this may lead to an advantage of population subdivision , a possibility which has been strongly debated for nearly one hundred years . in this work ,",
    "we quantitatively determine when , and to what extent , population subdivision accelerates valley and plateau crossing . using the simple model of an asexual population subdivided into identical demes connected by gobal migration",
    ", we derive the conditions under which crossing by a subdivided population is driven by its fastest deme , thus giving rise to the maximal speedup .",
    "our analytical predictions are verified using stochastic simulations .",
    "we investigate the effect of varying the degree of subdivision of a population .",
    "we generalize our results to weakly beneficial intermediates and to different population structures .",
    "we discuss the magnitude and robustness of the effect for realistic parameter values .",
    "natural selection drives populations towards higher fitness ( i.e. reproductive success ) , but crossing fitness valleys or plateaus may facilitate progress up a rugged fitness landscape .",
    "rugged fitness landscapes arise from epistasis , i.e. interactions between genetic variants .",
    "for instance , two mutations together can yield a benefit while each of them alone is detrimental : such reciprocal sign epistasis can give rise to a fitness valley  @xcite .",
    "while the high dimensionality of genotype space makes it challenging to probe the structure of fitness landscapes  @xcite , evidence has been accumulating for frequent landscape ruggedness , especially in recent years  @xcite .",
    "population structure can play an important role in evolution  @xcite .",
    "in particular , the time taken to cross a fitness valley or plateau depends on population size since stochastic effects such as genetic drift have an increased importance in small populations , allowing neutral and deleterious mutations to fix with increased probability  @xcite .",
    "population subdivision into demes can allow the maintenance of larger genetic diversity due to increased genetic drift as well as to the quasi - independent explorations of the fitness landscape that are run in parallel by each deme .",
    "subdivision may thereby facilitate valley or plateau crossing locally and subsequent migration can then spread beneficial mutations throughout the entire subdivided population ( `` metapopulation '' ) .",
    "this idea was first discussed by wright in his shifting balance theory  @xcite and the importance of this effect has been the subject of a long debate  @xcite . in this work ,",
    "we investigate the role of subdivision with global migration alone , without additional effects such as strong dependence of deme size on fitness , including extinction and refounding of demes , which played a crucial role in wright s theory .",
    "our generic and minimal model enables us to quantatively determine the conditions under which population subdivision accelerates fitness valley or plateau crossing .",
    "studying quantitatively the effect of subdivision on evolution may help in inferring fitness landscape structure from evolution experiments  @xcite .",
    "work on structured populations has been used as qualitative proof of landscape ruggedness  @xcite .",
    "current experiments investigating the evolution of subdivided populations at various migration rates have produced mixed results , some demonstrating faster adaptation of subdivided populations  @xcite , and others not  @xcite .",
    "it is therefore important to determine under what conditions subdivision accelerates fitness valley or plateau crossing .",
    "additionally , population subdivision is extremely common in natural systems .",
    "for instance , evidence has recently been found for compartmentalization of hiv in different organs of a single patient  @xcite .    here",
    "we show that subdivision can significantly accelerate fitness valley or plateau crossing over a wide parameter range , both with respect to a non - subdivided population and with respect to a single deme .",
    "intuitively , deleterious or neutral intermediate mutations may fix in individual demes , allowing for the maintenance of a larger proportion of these mutants in a metapopulation than in a well - mixed population .",
    "we first determine the optimal speedup of valley or plateau crossing by subdivision , in the best possible scenario where valley or plateau crossing by the metapopulation is driven by that of its fastest deme .",
    "this enables us to demonstrate that isolated demes must be in the sequential fixation regime for subdivision to significantly accelerate crossing .",
    "we then determine the conditions under which the best possible scenario can be realized . using markov chain theory ,",
    "we obtain analytical expressions for the parameter range where valley or plateau crossing by a metapopulation is as fast as that of its fastest deme .",
    "our analytical predictions are verified using stochastic simulations .",
    "furthermore , we discuss the effect of varying the degree of subdivision of a population , and investigate the trade - off between the magnitude of the optimal speedup and the width of the parameter range over which it occurs .",
    "finally , we extend our work to weakly beneficial mutations and to a population connected to smaller islands , and we discuss the magnitude and robustness of the effect for realistic parameter values .",
    "our results are organized as follows .",
    "first , we specify our model for the evolutionary dynamics of a subdivided population with migration . then , we focus on the ` best possible ' scenario where the metapopulation is driven by its fastest deme .",
    "we calculate the ratio of the valley - crossing time for the metapopulation to the valley - crossing time for an equally - sized well - mixed population under this strong assumption .",
    "this yields the optimal speedup that may be obtained by subdivision , and enables us to demonstrate that sequential fixation in individual demes is necessary to achieve a significant speedup .",
    "then , we determine the range of parameter values for which the best possible scenario is attained , i.e. the valley - crossing time for the metapopulation is indeed dominated by the valley - crossing time of its fastest deme .",
    "qualitatively , migration has to be both rare enough to enable demes to cross the fitness valley or plateau quasi - independently and frequent enough to allow fast spreading of the final beneficial mutation to the whole metapopulation once it has fixed in the fastest deme : these conditions yield an optimal window of migration rates .",
    "finally , we compare our analytical predictions with results from stochastic simulations .",
    "we focus on asexual individuals , characterized by their genotype and associated fitness @xmath0 .",
    "each individual has a division rate proportional to @xmath0 , and a death rate @xmath1 , which is the same for all .",
    "we consider an ensemble of @xmath2 identical demes , each with a constant number @xmath3 of individuals .",
    "the division rate averaged over the individuals of a deme is thus equal to the death rate @xmath1 .",
    "we treat migration as a random exchange of two individuals between two different demes , occurring at rate @xmath4 per individual . in our model ,",
    "exchange between any two demes is equally likely , as in wright s `` island model ''  @xcite .",
    "this constitutes a generic and minimal model of subdivision with migration , without any dependence of migration rate on the average fitness of a deme ( in contrast with models where demes containing beneficial mutants increase significantly in size and migrate more rapidly  @xcite ) , or additional effects of extinction and re - founding of demes  @xcite , specific geographic structure  @xcite , or spatially heterogeneous environments  @xcite , on which previous studies focused .",
    "we consider the simplest fitness valley or plateau , involving three successive genotypes denoted by ` 0 ' , ` 1 ' and ` 2 ' ( see fig .  [ opti]a ) .",
    "the initial genotype is taken as reference for fitness : @xmath5 .",
    "we denote the fitnesses of the subsequent genotypes by @xmath6 and @xmath7 .",
    "the first mutation is assumed to be either neutral ( @xmath8 ) , which yields a fitness plateau , or deleterious ( @xmath9 ) , which corresponds to a fitness valley , while the second mutation is assumed to be beneficial ( @xmath10 ) .",
    "we focus on first mutations that are not too strongly deleterious : @xmath11 .",
    "we only allow forward mutations , and note that including back mutations does not qualitatively affect crossing times  @xcite .",
    "finally , we assume that all mutations have probability @xmath12 per division , but generalization to different mutation probabilities is straightforward .    in this paper ,",
    "we focus on the average time @xmath13 required for the whole metapopulation to cross the fitness valley or plateau , i.e. to fix mutation ` 2 ' in all demes , starting from an initial state where all individuals have genotype ` 0 ' .      for small enough migration rates ,",
    "each deme in the metapopulation performs a quasi - independent trial at crossing the valley or plateau . at best",
    ", the valley or plateau crossing time @xmath13 of the whole metapopulation is dominated by that , @xmath14 , of the `` champion '' deme in the metapopulation , i.e. the deme that crosses the fitness valley or plateau fastest .",
    "we now focus on this best possible scenario , which is illustrated schematically in fig .",
    "[ opti]b : first , the champion deme crosses the valley or plateau by sequential fixation , and then the beneficial mutation rapidly spreads by migration of through the whole metapopulation . once this best possible scenario is characterized , the crucial question will be whether , and under what conditions , it can be attained : this point will be addressed in the following section .",
    "valley or plateau crossing by a non - structured , well - mixed population can occur by two different mechanisms : sequential fixation and tunneling .",
    "the former corresponds to fixation of mutation ` 1 ' in the whole population , and to subsequent fixation of the beneficial mutation ` 2 ' .",
    "conversely , the latter occurs when the beneficial mutation arises in a small fluctuating minority of first - mutants , and fixes directly : tunneling does not involve fixation of the intermediate mutation ` 1 '  @xcite .",
    "for given values of the parameters @xmath15 , @xmath16 , and @xmath12 , sequential fixation is the fastest process for small populations , where genetic drift plays an important part .",
    "tunneling becomes the dominant process of valley or plateau crossing when the number @xmath3 of individuals per deme exceeds a threshold value @xmath17 , which depends on @xmath15 , @xmath16 , and @xmath12 ( see ref .",
    "@xcite for a full discussion of this threshold value ) .",
    "[ opti]c shows simulation results for the valley crossing time @xmath18 of a non - subdivided population versus its size , and illustrates these two different regimes and the transition between them . note that in our simulations ( described in methods , sec .",
    "[ appsim ] ) , we hold fixed the carrying capacity @xmath19 of populations ( or demes ) instead of the number of individuals @xmath3 .",
    "this softer constraint is more realistic and avoids some possible biases in the metapopulation case ( see methods , sec .",
    "[ appsimk ] ) . in practice",
    ", each individual divides at a rate @xmath20 and dies at a constant rate @xmath1 : hence , at steady - state , @xmath21 .",
    "we choose @xmath22 , and fitnesses @xmath0 of order one , thus @xmath23 .",
    "we now consider @xmath24 independent demes with no migration , and we determine the crossing time @xmath14 of the fastest of these @xmath24 demes , both for demes in the sequential fixation regime and for demes in the tunneling regime .    [",
    "[ demes - in - the - sequential - fixation - regime . ] ] demes in the sequential fixation regime .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    let @xmath25 denote the probability of fixation of genotype ` @xmath26 ' , with fitness @xmath27 , starting from a single individual with genotype ` @xmath26 ' in a deme where all other individuals initially have genotype ` @xmath28 ' and fitness @xmath29  @xcite .",
    "if @xmath30 , the probability of fixation of genotype ` @xmath26 ' reads @xmath31 .",
    "valley or plateau crossing by sequential fixation involves two successive steps .",
    "the first step , fixation of the intermediate mutation ` 1 ' , occurs with rate @xmath32 , where @xmath33 is the total mutation rate in the deme .",
    "( recall that the deme size @xmath3 is fixed , and that @xmath1 represents the birth / death rate .",
    "note that the correspondence with ref .",
    "@xcite is obtained by multiplying by @xmath34 all the timescales in this reference , which are expressed in numbers of generations . )",
    "similarly , the second step , fixation of the final beneficial mutation ` 2 ' , has rate @xmath35 . the first step is longer than the second one since mutation",
    "` 1 ' is neutral or deleterious , while mutation ` 2 ' is beneficial .",
    "if the first step dominates , the distribution of crossing times is approximately exponential with rate @xmath36 .",
    "the shortest crossing time among @xmath2 independent demes is then distributed exponentially with rate @xmath37 ( see methods , sec .",
    "[ appb ] ) .",
    "thus , the average crossing time of the champion deme reads @xmath38 . denoting by @xmath39 the average crossing time for an isolated deme",
    ", we obtain @xmath40 hence , the champion deme crosses the valley @xmath2 times faster on average than a single deme .",
    "this simple result holds for @xmath41 . for simplicity , we restrict ourselves to this regime in the main text , but we provide the general method for calculating @xmath14 in methods , sec .  [ appb ] .",
    "we use this general method to calculate numerically the exact value of @xmath14 in our examples below .",
    "[ [ demes - in - the - tunneling - regime . ] ] demes in the tunneling regime .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    assuming that @xmath42 , so that there is no competition between different mutant lineages , valley or plateau crossing by tunneling involves a single event with constant rate , namely the appearance of a `` successful '' ` 1'-mutant , whose lineage includes a ` 2'-mutant that fixes  @xcite .",
    "crossing time is thus exponentially distributed .",
    "therefore , in this case too , the crossing time @xmath14 of the champion deme among @xmath24 isolated demes is @xmath24 times smaller than that of an average isolated deme ( see methods , sec .",
    "[ appb ] ) : eq .",
    "[ dfac ] is valid in the tunneling regime too .      in the best possible scenario , where crossing by the metapopulation is dominated by that of the champion deme , i.e.",
    "@xmath43 , the previous paragraph shows that @xmath44 , both when isolated demes are in the sequential fixation regime and when they are in the tunneling regime .",
    "hence , it is necessary to have @xmath45 where @xmath46 is the average crossing time of the non - subdivided population , for subdivision to speed up valley or plateau crossing in the best scenario ( i.e. for @xmath43 to be smaller than @xmath46 ) .",
    "this necessary condition is general since it holds _ a fortiori _ beyond the best scenario . graphically , in fig .",
    "[ opti]c , which is a logarithmic plot of crossing time versus population size for a non - structured population , the slope of the line joining the isolated deme to the non - subdivided population has to be less negative than -1 in order for speedups to be possible .",
    "recall indeed that the nonsubdivided population is @xmath24 times larger than an isolated deme .",
    "the necessary condition in eq .",
    "[ cn ] leaves the possibility of significant speedups in the non - trivial case where a single isolated deme crosses slower than a non - subdivided population ( @xmath47 ) . fig .",
    "[ opti]d demonstrates a significant speedup by subdivision obtained in this regime where @xmath48 .",
    "let us consider a metapopulation such that isolated demes are in the tunneling regime .",
    "then , the larger non - subdivided population with @xmath49 individuals is also in the tunneling regime  @xcite . assuming that @xmath50 , valley or plateau crossing by this non - subdivided population follows the same laws as crossing by the demes .",
    "since the average crossing time by tunneling is inversely proportional to population size ( see ref .",
    "@xcite and fig .",
    "[ opti]c ) , we obtain @xmath51 , in contradiction with eq .",
    "this implies that , even in the best possible scenario , subdivision can not accelerate crossing if isolated demes are in the tunneling regime ( since here , @xmath52 ) .",
    "thus , having isolated demes in the sequential fixation regime is a necessary condition for subdivision to accelerate crossing .",
    "importantly , however , the non - subdivided population is not required to be in the sequential fixation regime .",
    "for instance , in fig .",
    "[ opti]d , the non - subdivided population is in the tunneling regime .",
    "note that when @xmath53 , the population enters the semi - deterministic regime  @xcite and the average crossing time need not be proportional to @xmath54 .",
    "minor speedups may exist in this regime , but such effects are beyond the scope of this work . in all the following ,",
    "we will focus on the regime @xmath55 .",
    "the speedup gained by subdividing a population of a given total size is directly described by the ratio @xmath56 of the valley crossing time of a metapopulation to that of a non - subdivided population . here",
    ", we discuss the values this ratio can take in the best possible scenario , where valley crossing by the metapopulation is dominated by that of the champion deme , and we determine the valley depth for which the highest speedups are obtained ( i.e. for which this ratio is smallest ) .",
    "let us first focus on the case where both the non - subdivided population and the isolated deme are in the sequential fixation regime .",
    "the average valley crossing time by the champion deme reads @xmath57 ( see our calculation of @xmath14 above ) . in the best possible scenario , @xmath43 .",
    "the average valley crossing time by the non - subdivided population is @xmath58 , where @xmath59 is the fixation probability of an individual with genotype ` 1 ' in a population of @xmath60 individuals where all the others initially have genotype ` 0 ' ( see eq .",
    "[ pij ] ) .",
    "hence , we obtain @xmath61 in the case of a plateau , this reduces to @xmath62 .",
    "these results demonstrate that if both the non - subdivided population and the isolated deme are in the sequential fixation regime , then subdivision significantly accelerates crossing in the best scenario .",
    "the speedup by subdivision becomes larger ( i.e. @xmath56 becomes smaller ) when the number of demes @xmath63 is increased at fixed valley depth @xmath15 and fixed deme size @xmath3 ( or fixed total population size @xmath64 ) .",
    "besides , for @xmath65 , the ratio in eq .",
    "[ spup ] decreases when @xmath15 is increased at fixed @xmath3 and @xmath63 : the highest speedups are obtained for the deepest valleys .",
    "however , as @xmath15 is increased , the non - subdivided population will eventually enter the tunneling regime ( see fig .",
    "[ opti]c ) .",
    "let us now consider the alternative case , where the non - subdivided population is in the tunneling regime , while the isolated demes are in the sequential fixation regime . in this case ,",
    "@xmath66 , where @xmath67 is the fixation probability of a ` 1'-mutant in an isolated deme ( see eq .",
    "[ pij ] ) , while @xmath68 , where @xmath69 is the probability that a ` 1'-mutant is `` successful '' in the tunneling process , i.e. that its lineage includes a ` 2'-mutant that fixes in the non - subdivided population  @xcite .",
    "hence , in the best scenario , where @xmath43 , we obtain @xmath70 since @xmath69 is independent from population size  @xcite , it also represents the probability of successful tunneling _ in an isolated deme_. for isolated demes in the sequential fixation regime , @xmath71 by definition  @xcite .",
    "hence , eq .  [ neweq ] entails @xmath72 .",
    "thus , speedups always exist in the best scenario , provided that the necessary condition that isolated demes cross the plateau by sequential fixation is satisfied . in the case of a fitness plateau , @xmath73  @xcite , while @xmath74 .",
    "hence , eq .  [ neweq ] yields @xmath75 in the other extreme case of a sufficiently deep valley that satisfies @xmath76 , we have @xmath77  @xcite . using the condition @xmath78 , eq .",
    "[ pij ] yields @xmath79 .",
    "hence , eq .  [ neweq ] gives @xmath80 interestingly , these expressions of @xmath56 are independent of @xmath63 at fixed @xmath3 .",
    "this stands into contrast with the regime discussed above where the non - subdivided population is in the sequential fixation regime . at fixed @xmath3 ,",
    "the ratio @xmath56 expressed in eq .",
    "[ unautrelabel ] is minimal for @xmath81 the minimum of @xmath56 , corresponding to the largest speedup by subdivision , is obtained for this value of @xmath15 : @xmath82 the small values of mutation probabilities in nature ensure that the values of @xmath56 in eqs .",
    "[ lemin3 ] and  [ lemin2 ] can be very small .",
    "the previous section was dedicated to the study of the best possible scenario , where the valley or plateau crossing time @xmath13 of the whole metapopulation is dominated by that , @xmath14 , of the champion deme in the metapopulation ( i.e. the one that crosses fastest ) .",
    "we now determine analytically the conditions under which this best possible scenario is attained .",
    "for this , we focus on migration rates much smaller than division / death rates , @xmath83 , such that fixation or extinction of a mutant lineage in a deme is not perturbed by migration .",
    "in addition , we assume that isolated demes are in the sequential fixation regime , since we showed above that it is a necessary condition for subdivision to significantly accelerate crossing , and that it is a sufficient condition for subdivision to accelerate crossing in the best scenario .    in a nutshell",
    ", migration must be rare enough for demes to evolve quasi - independently , but frequent enough to spread the beneficial mutation rapidly .",
    "the analytical results below allow for predicting the range of migration rates such that subdivision maximally accelerates valley or plateau crossing .",
    "migration must be rare enough for demes to remain shielded from migration while they harbor the intermediate mutation .",
    "hence , the average time for a deme of ` 1'-mutants to fix the beneficial mutation ` 2 ' , which reads @xmath84 , must be smaller than the average extinction time , @xmath85 , for a deme of ` 1'-mutants to be wiped out by migration from other demes with genotype ` 0 ' .",
    "the total rate of migration events in the metapopulation is @xmath86 , so @xmath87 , where @xmath88 is the average total number of migration events required for the ` 1'-mutants to go extinct .",
    "the first condition , @xmath89 , thus yields @xmath90    let us now estimate @xmath88 .",
    "if one deme has fixed genotype ` 1 ' while all the others still have genotype ` 0 ' , the probability that a migration event involves the mutant deme is @xmath91 .",
    "following such a  relevant \" migration event , extinction of the mutant ( ` 1 ' ) lineage occurs if the ` 0 ' migrant fixes in the ` 1 ' deme while the ` 1 ' migrant does not fix in the ` 0 ' deme : this occurs with probability @xmath92 .",
    "conversely , the number of mutant demes increases to two with probability @xmath93 , and otherwise remains constant . for @xmath94 , using also @xmath78 , we have @xmath95 ( see eq .",
    "[ pij ] ) .",
    "hence , migration - induced increases in the number of mutant demes can be neglected , and we obtain @xmath96    in methods , sec .",
    "[ appa ] , we derive the general expression of @xmath97 , which does not require @xmath98 , using finite markov chain theory  @xcite . note that this general expression is important because subdivision generically most accelerates valley crossing for @xmath99 ( see eq .",
    "[ lemin ] ) .",
    "migration must be frequent enough for the average spreading time @xmath100 of the final mutation through the whole metapopulation to be shorter than the valley or plateau crossing time @xmath101 by the champion deme .",
    "let @xmath102 be the average number of migration events required for the final beneficial mutants ( with genotype ` 2 ' ) to spread by migration , once the champion deme has fixed genotype ` 2 ' .",
    "then , we can write @xmath103 , and the second condition reads @xmath104    let us now estimate @xmath102 , starting from a state where the champion deme has fixed genotype ` 2 ' , while all others still contain genotype ` 0 ' .",
    "( note that some demes may have genotype ` 1 ' , but this is rare since fixation of mutation ` 1 ' is the slowest step .",
    "moreover , this would not change the spreading time for a plateau and would shorten it for a valley . ) let us focus on the regime where @xmath105 but @xmath106 , such that mutation ` 2 ' is substantially , but not overwhelmingly , beneficial  @xcite . as in the above discussion about @xmath88",
    ", we then obtain @xmath107 .",
    "thus , it is possible to neglect any migration - induced decrease in the number of demes with genotype ` 2 ' , which we denote by @xmath28 . the probability that a migration step exchanges individuals with different genotypes is @xmath108 $ ] , and the probability that such a relevant migration step increases @xmath28 by one is @xmath109 .",
    "hence , we obtain @xmath110 where the last expression is obtained for @xmath65 . in methods ,",
    "[ appa ] , we use finite markov chain theory to derive the general analytical expression for @xmath111 , which does not require @xmath112 .      together ,",
    "[ ts ] and  [ ti ] yield the interval of @xmath113 over which subdivision maximally accelerates valley or plateau crossing .",
    "for @xmath114 we expect the valley or plateau crossing time @xmath13 of the whole metapopulation to be dominated by that of the champion deme : @xmath44 , where @xmath39 is the average crossing time for an isolated deme , and in the best scenario , @xmath115 .    in the regime",
    "where @xmath116 and @xmath117 , we can use the simple expressions of @xmath88 and @xmath102 given in eqs .",
    "[ nd ] and [ ns ] , which yields @xmath118 the ratio , @xmath119 , of the upper to lower bound in eq .  [ intervs ] reads @xmath120 this ratio increases exponentially with @xmath3 ( this dependence on @xmath3 comes from that of @xmath67 ) .",
    "this entails that , in this regime , the interval of @xmath121 where subdivision most accelerates crossing becomes wider as @xmath3 increases .",
    "however , the width of this interval is limited by the fact that isolated demes have to be in the sequential fixation regime ( see discussion ) . while the expressions of the interval bounds in eq .",
    "[ intervs ] are more illuminating and easier to derive than the general ones , the latter , given in methods , sec .",
    "[ appa ] , actually play important roles since the highest speedups of valley crossing gained by subdivision are generically obtained for @xmath122 ( see eq .  [ lemin ] ) .",
    "we have obtained an explicit expression of the interval of @xmath113 over which subdivision maximally accelerates valley crossing in the case of a relatively deep fitness valley where @xmath123 while @xmath11 . in the opposite limit of a fitness plateau ( @xmath8 ) , retaining the assumptions @xmath124 and @xmath125 , eq .  [ interv ] can also be simplified . for this",
    ", we use the expression of @xmath88 obtained in eq .",
    "[ n1n0 ] of methods , sec .",
    "[ appa ] , and the expression of @xmath102 in eq .",
    "[ ns ] , and we note that , since mutation ` 1 ' is neutral , @xmath74 and @xmath126 .",
    ".  [ interv ] then becomes : @xmath127 where we have used @xmath128 and @xmath129 .",
    "the ratio , @xmath119 , of the upper to lower bound in eq .",
    "[ intervsp ] reads @xmath130 this simple expression of @xmath119 demonstrates that the range of @xmath121 over which subdivision maximally accelerates plateau crossing increases as the deme size @xmath3 becomes larger , and that this range is quite wide as long as the number of demes satisfies @xmath131 , which is a realistic condition ( recall that we are in the regime @xmath106 ) .",
    "we now present numerical simulations of the evolutionary dynamics described above , which enable us to test our analytical predictions , and to gain additional insight in the process beyond the optimal scenario .",
    "our simulations are based on a gillespie algorithm  @xcite , and described in detail in methods , sec .",
    "[ appsim ] .",
    "let us first focus on the example presented in fig .",
    "[ opti]d , which shows an example plot of @xmath13 as a function of the ratio of migration to mutation rates , @xmath121 , obtained through our simulations when varying only the migration rate . with the parameter values used in this figure , the interval of eq .",
    "[ interv ] is @xmath132 .",
    "note that here , and in the following examples , we use the general expressions of @xmath102 and @xmath88 given in methods , sec .",
    "[ appa ] , to compute the interval of eq .",
    "[ interv ] .",
    "[ opti]d features a minimum right at the center of this theoretically predicted optimal interval .",
    "moreover , this minimum corresponds to @xmath133 , while @xmath134 : hence , the metapopulation crosses the valley on average 6.54 times faster than an isolated deme .",
    "this is very close to the limit of the best possible scenario , where the metapopulation would cross 7 times faster than an isolated deme ( since @xmath135 here ) .",
    "this example illustrates that speedups tend towards those predicted in the best scenario , when the interval in eq .",
    "[ interv ] is sufficiently wide ( here the ratio between its upper and its lower bound is 359 ) . besides , @xmath136 here : comparing it to the above - mentioned value of @xmath13 yields a 3.47-fold speedup of valley crossing by subdivision .",
    "the simulation results in fig .",
    "[ opti]d also show that significant ( albeit smaller ) speedups exist beyond the optimal parameter window .",
    "[ phasediags ] shows heatmaps of the valley crossing time of a metapopulation as a function of the migration - to - mutation rate ratio , @xmath121 ( varied by varying @xmath137 ) , and of the fitness valley depth , @xmath15 .",
    "[ phasediags]a shows that the optimal interval of eq .",
    "[ interv ] ( solid lines ) describes well the region where the ratio @xmath138 of the crossing time of the metapopulation to that of an isolated deme is smallest and tends to the best - scenario limit @xmath139 . for migration rates lower than those in this interval , the ratio @xmath138 increases when @xmath137 decreases",
    "this can be understood qualitatively by noting that if @xmath140 , @xmath13 is determined by the valley crossing time of the slowest among the independent demes . in the opposite case of migration rates",
    "larger than those in the optimal interval , @xmath13 increases with @xmath137 , and it tends to the non - subdivided case , @xmath46 , at high values of @xmath137 , as expected . above a threshold value of @xmath15 ( dashed line ) , @xmath46 becomes smaller than @xmath141 , in which case large values of @xmath137 , such that @xmath13 tends to @xmath46 , give a low @xmath138 ( see fig .",
    "[ phasediags]a ) .",
    "[ phasediags]b plots the ratio @xmath56 of the crossing time of the metapopulation to that of the non - subdivided population , which directly yields the speedup obtained by subdividing a population .",
    "it shows that , for the parameter values chosen , subdivision accelerates valley crossing over a large range of valley depths and migration rates , extending far beyond the optimal range given by eq .",
    "[ interv ] , and that the metapopulation can cross valleys orders of magnitude faster than a single large population . in addition , above a second , larger threshold value of @xmath15 ( dotted line in fig .",
    "[ phasediags ] ) , isolated demes enter the tunneling regime  @xcite : fig .",
    "[ phasediags]b shows that sufficiently above this threshold , the metapopulation no longer crosses the valley faster than the non - subdivided population , as predicted above . while having isolated demes in the sequential fixation regime",
    "is a necessary condition to obtain significant speedups by subdivision , the non - subdivided population is not required to be in the sequential fixation regime ( see above , and fig .",
    "[ opti]c - d ) .",
    "the value of @xmath15 above which the non - subdivided population enters the tunneling regime is indicated by a dash - dotted line in fig .",
    "[ phasediags ] : significant speedups are obtained both below and above this line . the highest speedups are actually obtained above it , i.e. when the non - subdivided population is in the tunneling regime . with the parameter values used , eq .  [ lemin ] predicts a minimum of @xmath56 for @xmath142 ( solid line in fig .",
    "[ phasediags]b ) , which agrees very well with the results of our numerical simulations .",
    "( note that this value of @xmath15 satisfies @xmath76 , and is such that the non - subdivided population is in the tunneling regime .",
    "these conditions were used in our derivation of eq .",
    "[ lemin ] . )",
    "in the results section , we have shown that having isolated demes in the sequential fixation regime is a necessary condition for subdivision to significantly accelerate crossing .",
    "this requirement limits the interval of the ratio @xmath121 over which the highest speedups by subdivision are obtained .",
    "the extent of this interval can be characterized by the ratio , @xmath119 , of the upper to lower bound in eq .",
    "[ interv ] .",
    "let us express the bound on @xmath119 imposed by the requirement of sequential fixation in isolated demes .",
    "if @xmath143 , the threshold value @xmath17 below which an isolated deme is in the sequential fixation regime satisfies @xmath144  @xcite . let us also assume that @xmath98 , and that @xmath125 while @xmath112 , to be in the domain of validity of eqs .  [ intervs ] and  [ unlabela ] . combining the condition @xmath145 with the expression of @xmath119 in eq .",
    "[ unlabela ] yields @xmath146    for plateaus , isolated demes are in the sequential fixation regime if their size @xmath3 is smaller than @xmath147  @xcite . in the regime of validity of eqs .",
    "[ intervsp ] and  [ unlabel ] ( @xmath125 while @xmath112 , and @xmath128 , @xmath65 ) , this condition can be combined with eq .",
    "[ unlabel ] , which yields @xmath148    both eq .",
    "[ la1 ] and eq .",
    "[ la2 ] show that increasing the number @xmath63 of demes decreases the range where the highest speedup by subdivision is reached .",
    "this is because having more subpopulations makes the spreading of the beneficial mutation slower . in addition",
    ", we find that the bound on @xmath119 is proportional to @xmath149 .",
    "hence , despite this bound , the interval where subdivision most accelerates plateau crossing can span several orders of magnitude , given the small values of the actual mutation probabilities @xmath12 in nature .",
    "an interesting question raised by our results regards the optimal degree of subdivision .",
    "given a certain total metapopulation size , into how many demes should it be subdivided in order to obtain the highest speedup possible ?",
    "we first attack this question using our analytical results , and then we present simulation results , which allow for going beyond the best scenario and its associated parameter window .",
    "let us consider a metapopulation of given total size @xmath64 .",
    "our analytical results show that increasing subdivision , i.e. increasing the number @xmath24 of subpopulations at constant @xmath150 , leads to stronger speedups of valley crossing ( see eqs .",
    "[ spup ] and  [ unautrelabel ] , with @xmath151 )",
    ". however , eqs .",
    "[ unlabela ] and  [ unlabel ] , and the previous paragraph , show that when @xmath63 is increased , the parameter range where the speedup by subdivision tends to the best - scenario value becomes smaller and smaller .",
    "eventually , this parameter range ceases to exist altogether : this occurs when @xmath119 becomes of order 1 and below .",
    "this sheds light on an interesting trade - off in the degree of subdivision @xmath63 , between the magnitude of the optimal speedup gained by subdivision and the width of the parameter range over which the actual speedup is close to this optimal value .",
    "this effect can be observed qualitatively in fig .",
    "[ optisub]a , where the valley crossing time @xmath13 of a metapopulation with fixed total size is shown versus the migration - to - mutation rate ratio , @xmath121 , for different values of @xmath24 : when @xmath24 is increased , the minimum becomes deeper but less broad .",
    "in addition , eqs .  [ intervs ] and  [ intervsp ] show that when @xmath63 is increased , the lower bound of the interval where the speedup by subdivision tends to the best - scenario value decreases , as @xmath152 for plateaus ( eq .  [ intervsp ] ) and even more rapidly for deep valleys ( eq .  [ intervs ] ) .",
    "qualitatively , this is because spreading of the beneficial mutation gets longer when @xmath24 increases .",
    "conversely , the upper bound of this parameter range is independent of @xmath24 for deep valleys ( eq .  [ intervs ] ) , and grows only logarithmically with @xmath24 for plateaus ( eq .  [ intervsp ] ) .",
    "hence , when @xmath24 is increased , the center of the interval where the actual speedup is close to the optimal value shifts towards higher migration rates .",
    "this effect , which can be observed in fig .",
    "[ optisub]a , is studied more precisely in fig .",
    "[ optisub]b : at fixed migration rate @xmath137 , the crossing time @xmath13 of a metapopulation exhibits a minimum at an intermediate value of @xmath24 .",
    "indeed , the crossing time of the metapopulation first decreases when @xmath24 is increased because the minimum crossing time then decreases .",
    "but beyond a certain value of @xmath24 , the migration rate that yields the highest speedup becomes larger than the fixed migration rate @xmath137 , so @xmath13 increases when @xmath24 is increased further .",
    "next , we study the dependence on @xmath24 of the valley crossing time @xmath153 minimized over @xmath137 for each @xmath24 , again for a metapopulation with fixed total size @xmath64 . for values of @xmath24 small enough for the interval in eq .",
    "[ interv ] to be broad , we expect @xmath153 to be close to the optimal scenario value @xmath154 .",
    "but , as discussed above , as @xmath24 increases , this interval will become smaller and then vanish .",
    "in such a regime , our analytical results are no longer sufficient to predict the dependence of @xmath153 on @xmath24 , but our simulations can provide additional insight . fig .  [ optisub]c shows that , while @xmath155 ( left of the dashed line ) , @xmath153 is close to the best - scenario value .",
    "when @xmath24 is increased beyond this point , @xmath153 decreases slower than the best - scenario value .",
    "indeed , the interval in eq .",
    "[ interv ] is no longer wide enough for the best - scenario limit to be approached .",
    "note also that when demes become small enough , verifying @xmath156 ( right of the dotted line in fig .",
    "[ optisub]c ) , mutation ` 1 ' becomes effectively neutral in individual demes , as @xmath67 tends to @xmath54 ( see eq .",
    "[ pij ] ) . for even higher values of @xmath24",
    ", @xmath153 is observed to saturate rather than exhibiting a unique minimum .",
    "interestingly , this occurs for @xmath24 such that the interval in eq .",
    "[ interv ] fully vanishes ( i.e. when @xmath119 passes below 1 , right of the solid line on fig .",
    "[ optisub]c ) .",
    "while we do not have rigorous proof of the generic existence of this saturation , we have explored this point for other parameters , and found similar behavior ( data not shown ) .",
    "importantly , this indicates that there is a whole class of nearly optimal population structures .",
    "our work has focused on fitness valleys ( @xmath9 ) , such that mutation ` 1 ' is deleterious , and on fitness plateaus ( @xmath8 ) , such that mutation ` 1 ' is neutral . for @xmath157 ,",
    "mutation ` 1 ' is effectively neutral , as far as valley crossing is concerned , in a population with @xmath3 individuals  @xcite .",
    "( this condition holds both in the sequential fixation regime and in the tunneling regime . )",
    "this implies that our arguments and our results obtained in the case of the fitness plateau also hold for weakly beneficial intermediates .",
    "this point is illustrated in fig .",
    "[ ext]a .",
    "thus far , we focused on demes of equal size for simplicity , but demes of different sizes are relevant in practice . as a step toward more general populations structures ,",
    "we now consider a population connected by migration to @xmath158 smaller satellite populations of identical size , assumed to be in the sequential fixation regime .",
    "we only allow migration between the large population and each of the smaller islands , and the total migration rate is denoted by @xmath159 .",
    "the small island affected by migration is chosen randomly at each migration event .",
    "it is straightforward to adapt our work to this case ( see methods , sec .  [ appc ] ) .",
    "we obtain an interval of @xmath160 over which the crossing time for the large population is dominated by the crossing time of the champion island .",
    "this is corroborated by our simulations ( see fig .  [",
    "ext]b ) .",
    "let us consider the example of _ escherichia coli _ , for which the mutation probability per base pair per division is @xmath161  @xcite .",
    "in order to gain a speedup of crossing by subdivision , we require demes to be in the sequential fixation regime . for plateaus , this condition reads @xmath162 .",
    "let us consider deme sizes such that this condition is satisfied .",
    "first , let us choose @xmath163 , which is within the smallest range of sizes used in current evolution experiments .",
    "for instance , it is the number of bacteria transferred at each dilution step for small populations in  @xcite . for this value of @xmath3 ,",
    "all plateaus with @xmath164 are in the sequential fixation regime ( from the condition @xmath162 ) .",
    "let us also consider @xmath165 , since 96-well plates are often used in these experiments  @xcite .",
    "this yields a total population size of @xmath166 individuals , which is in the tunneling regime for all plateaus with @xmath167 . for @xmath168 ,",
    "isolated demes are in the sequential fixation regime for @xmath169 .",
    "( subdivision can not significantly accelerate crossing for deeper valleys since isolated demes are then in tunneling , but those valleys take longer to cross than shallow ones and are thus probably less often crossed in practice . )",
    "the ratio @xmath119 of the bounds of the interval in eq .",
    "[ interv ] satisfies @xmath170 throughout this range of valleys , with @xmath171 for the plateau and @xmath172 for the deepest valleys in the range .",
    "thus , actual speedups will approach the best - scenario one , and significant speedups will exist in a wide parameter window .",
    "[ lemin ] predicts that the highest speedup is obtained for @xmath173 , and eq .",
    "[ lemin2 ] then yields a speedup factor by subdivision of @xmath174 .",
    "( using instead the full expression of @xmath14 obtained from eq .",
    "[ pbest ] ( see methods , sec .  [ appb ] ) yields @xmath175 , i.e. a correction of 7% . )",
    "moreover , for all valleys with @xmath176 , the best - scenario speedup ranges from 18 to @xmath175 .",
    "thus , subdivision significantly accelerates crossing for this entire class of valleys .",
    "it should be noted that the timescales obtained in this example are long compared to experimental ones .",
    "for instance , for the plateau , @xmath14 corresponds to @xmath177 divisions while @xmath46 is @xmath178 divisions .",
    "however , @xmath14 can become smaller if the number of subpopulations @xmath63 is increased , as discussed in our previous section .",
    "besides , we have chosen to focus on standard _ escherichia coli _ for simplicity",
    ". organisms with a higher mutation rate , e.g. viruses such as hiv , or mutator strains , would have much shorter timescales , but smaller subpopulations would then be required for demes to be in the sequential fixation regime .",
    "our example thus far focused on a small but realistic deme size , @xmath163 .",
    "experimentally more frequent values of @xmath3 are in the range @xmath179 ",
    "@xmath180  @xcite .",
    "increasing @xmath3 at fixed @xmath12 decreases the range of @xmath16 for which demes are in the sequential fixation regime . for a plateau",
    ", this condition reads @xmath181 . for @xmath182 , this yields @xmath183 , and for @xmath184 ,",
    "this yields @xmath185 .",
    "hence , the range of plateaus ( and similarly , of valleys ) for which subdivision accelerates crossing becomes more restricted when @xmath3 is increased .",
    "nevertheless , if these increasingly stringent conditions on @xmath16 are satisfied , significant speedups by subdivision are still expected .",
    "indeed , eq .  [ lemin2 ] shows that the smallest value of the ratio @xmath186 is proportional to @xmath187 , so if one increases @xmath3 while decreasing @xmath16 as @xmath188 , the maximal speedup by subdivision will remain unchanged .    in this work",
    ", we have considered the crossing of one particular valley or plateau corresponding to a specific pair of two mutations .",
    "given the complexity and high dimensionality of actual fitness landscapes , there may be a large number of parallel valleys or plateaus ,",
    "so that one of these could be crossed quite frequently even though the crossing time for a single valley or plateau remains large .",
    "our work shows that , under specific conditions , subdivision can significantly accelerate crossing for whole classes of valleys and plateaus .",
    "furthermore , in a generic , high - dimensional fitness landscape that contains both valleys and/or plateaus and uphill paths , subdivision can provide an additional effect : it `` shields '' some demes in the metapopulation from adaptation via the uphill paths , leaving them time to explore valley - crossing paths that may be better in the longer term .",
    "while this effect is outside the scope of the present paper , it could lead to additional advantages of subdivision in evolution on rugged fitness landscapes .",
    "our study of a generic and minimal model of population subdivision with migration demonstrates that subdividing a population into demes connected by migration can significantly accelerate the crossing of fitness plateaus and valleys , without the need for additional ingredients .",
    "we have derived quantitative conditions on the various parameters for subdivision to accelerate crossing , and for the resulting speedup to be maximal .",
    "in particular , isolated demes have to be in the sequential fixation regime for a significant speedup to occur .",
    "this condition is quite strong , but provided that it is met , significant speedups can be obtained in a wide range of migration rates , with the fastest deme driving the crossing of the whole metapopulation in the best scenario .",
    "we have derived the interval of migration rates for which this best scenario is reached .",
    "in addition , we have shown that increasing the degree of subdivision of a population enables higher speedups to be reached , but that this effect can saturate .    our quantitative assessment of the conditions under which subdivision significantly speeds up valley or",
    "plateau crossing can aid in optimally designing future experiments , enabling one to choose the sizes and the number of demes , as well as the migration rates , such that subdivision can accelerate valley and plateau crossing .",
    "further directions include investigating the evolution of a metapopulation with a distribution of deme sizes on a more general rugged landscape , as well as assessing the impact of specific geographic structure .",
    "our work could also be extended to sexual populations , where recombination plays an important role in valley or plateau crossing  @xcite .",
    "the interplay between recombination and subdivision , which respectively alleviate and exacerbate clonal interference , would be interesting to study .",
    "our simulations are based on a gillespie algorithm  @xcite that we coded in the c language . here",
    "we will describe our algorithm for the case of a metapopulation of @xmath63 demes of identical size , which is the primary situation discussed in our work . in our simulations ,",
    "each deme has a fixed carrying capacity @xmath19we discuss this choice further in this section .",
    "a number of different events occur in our simulations , each with an independent rate :    * each individual divides at rate @xmath189 , where @xmath190 is the fitness associated with the genotype @xmath191 of the individual , and @xmath192 is the current total number of individuals in the deme @xmath193 $ ] to which the individual belongs .",
    "this corresponds to logistic growth . *",
    "if a dividing cell has @xmath194 , upon division , its offspring ( i.e. , one of the two individuals resulting from the division ) mutates with probability @xmath12 , to have genotype @xmath195 instead of @xmath196 . *",
    "each individual dies at rate @xmath1 . hence , at steady - state , @xmath197 , where @xmath198 is the average fitness of deme @xmath28 . in practice , we choose @xmath22 , and fitnesses of order one , thus @xmath199",
    ". * migration occurs at total rate @xmath200 .",
    "two different demes are chosen at random , an individual is chosen at random from each of these two demes , and the two individuals are exchanged .",
    "there is no geographic structure in our model , i.e. exchange between any two demes is equally likely .    in practice , the number of individuals with each genotype in each deme is stored , as well as the corresponding division rate .",
    "this data fully describes the state of the metapopulation , and allows determination of the rates of all events . for each event in the simulation ,",
    "the following steps are performed :    * a timestep @xmath201 is drawn from an exponential distribution with rate equal to the total rate @xmath202 of events ( i.e. , the sum of all rates ) , and time is increased from its previous value , @xmath203 , to @xmath204 . in other words ,",
    "the next event occurs at time @xmath204 . *",
    "the event that occurs at @xmath204 is chosen randomly , in such a way that the probability of an event with rate @xmath205 is equal to @xmath206 : either a cell divides , or a cell dies , or a migration event occurs . * the event is performed , and the relevant data is updated . since we store the number of individuals with each genotype in each deme , only one or two of these numbers need to be updated at each step .",
    "in addition , the division rates of the affected deme @xmath28 must be updated upon division and death because @xmath192 is modified .",
    "note , however , that this represents only three numbers at most ( one for each genotype ) .",
    "the advantage of the gillespie algorithm is that it is exact , and does not involve any artificial discretization of time .      in our simulations , demes have a fixed carrying capacity , and the number of individuals per deme fluctuates weakly around its equilibrium value .",
    "this approach , also used in e.g.  @xcite , has the advantage of realism .",
    "alternatively , we could impose a constant number of individuals per deme .",
    "+ ( i ) first , we could choose a dividing individual in the whole metapopulation with probability proportional to its fitness , and simultaneously suppress another individual , chosen at random in the same deme .",
    "however , in this case , individuals in demes of higher fitness would exhibit shorter lifespans , which is not realistic and may introduce a bias .",
    "+ ( ii ) a second possibility would be to choose a dividing individual ( according to fitness ) in each of the demes , and to simultaneously suppress another individual , chosen at random , in each deme . however , in this case , unless migration events are far less frequent than these collective division - death events ( i.e. , these @xmath63 division - death events ) , the time interval between them becomes artificially discretized . this introduces biases unless the total migration rate @xmath207 is much smaller than @xmath208 , i.e. unless @xmath209 .",
    "consequently , while imposing a constant number of individuals is a good simulation approach for a non - subdivided population ( see e.g.  @xcite ) , it tends to introduce biases in the study of metapopulations . while we chose to perform simulations with",
    "fixed carrying capacities in order to avoid any of these biases , we checked that , for small enough migration rates , our results are completely consistent with simulation scheme ( ii ) described above .",
    "this consistency check also demonstrates that it is legitimate to compare our simulation results obtained with fixed carrying capacities to our analytical work carried out with constant population size per deme .      in this section ,",
    "we give more details on the calculation of the average valley or plateau crossing time @xmath14 by the champion deme amongst @xmath63 independent ones .",
    "we show in the results section that , in the best scenario , the crossing time of the whole metapopulation is determined by this time .",
    "@xmath14 is the average shortest crossing time of @xmath2 independent demes .",
    "this minimum crossing time , which we denote by @xmath210 , is also called the smallest ( or first ) order statistic of the deme crossing time amongst a sample of size @xmath2  @xcite .",
    "let us denote by @xmath211 the probability density function of valley or plateau crossing time for a single deme , and let us introduce @xmath212 ( it satisfies @xmath213 where @xmath214 is the cumulative distribution function of valley or plateau crossing by a single deme ) .",
    "the probability that @xmath210 is larger than @xmath203 is equal to the probability that the crossing times of each of the @xmath63 independent demes are all larger than @xmath203 : @xmath215^ d$ ] . by differentiating this expression ,",
    "one obtains the probability density function @xmath216 of the crossing time @xmath210 by the champion deme  ( see e.g.  @xcite ) : @xmath217^ { d-1 } p(t_c)\\ , .",
    "\\label{pb}\\ ] ]    we now express @xmath211 explicitly . since demes are assumed to be in the sequential fixation regime , valley or plateau crossing involves two successive steps .",
    "the first step , fixation of a ` 1'-mutant , occurs with rate @xmath36 , and the second step , fixation of a ` 2'-mutant , occurs with rate @xmath218 ( see the results section for expressions of these rates ) .",
    "the total crossing time is thus a sum of two independent exponential random variables , with probability density function given by a two - parameter hypoexponential distribution  @xcite : @xmath219 combining eqs .",
    "[ pb ] and  [ hypo ] , we obtain @xmath220 with @xmath221 given by eq .",
    "@xmath14 can then be determined for any value of the parameters by computing the average value of @xmath210 over this distribution .    since mutation ` 1 ' is deleterious or neutral while mutation ` 2 ' is beneficial",
    ", the first step of valley crossing is much longer than the second one over a broad range of parameter values . in this case",
    ", we can approximate @xmath211 with a simple exponential distribution , @xmath222 eq .",
    "[ pb ] then yields @xmath223 i.e. @xmath210 is distributed exponentially with rate @xmath37 . in this case , we simply have @xmath101 , which can be written as @xmath224 , where @xmath225 is the average crossing time for an isolated deme .",
    "hence , in this case , on which our analytical discussion focus , the champion deme crosses the valley @xmath2 times faster on average than an isolated deme .    for this approximation to be valid",
    ", the second step of valley crossing must be negligible even for the champion deme , i.e. , @xmath41 .",
    "for very large @xmath63 , the value of @xmath14 will not be as small as @xmath226 , since the second step will no longer be negligible ( see  @xcite for a discussion of similar issues ) .",
    "the crossover to this regime can be determined by computing the average of the distribution in eq .",
    "[ pbest ] and comparing it to @xmath226 .      in our results section",
    ", we have derived an interval of the ratio of migration rate to mutation rate over which subdivision most reduces valley or plateau crossing time ( see eq .",
    "[ interv ] ) .",
    "the upper bound involves @xmath88 , the average number of migration events required for the ` 1'-mutants to be wiped out by migration , starting from a state where one deme has fixed genotype ` 1 ' , while all other demes have genotype ` 0 ' .",
    "similarly , the lower bound involves @xmath102 , the average number of migration events required for the ` 2'-mutants to spread by migration to the whole metapopulation , starting from a state where one deme has fixed genotype ` 2 ' , while all other demes have genotype ` 0 ' . in our results section , we have provided intuitive derivations of the simple expressions of @xmath102 and @xmath88 , valid for @xmath112 and @xmath125 , @xmath98 and @xmath78 ( see eq .",
    "[ intervs ] ) . however , it is important to derive more general expressions , especially since subdivision generically most accelerates valley crossing in the intermediate regime where @xmath99 ( see results , eq .",
    "[ lemin ] ) .    here",
    ", we derive general analytical expressions for @xmath88 and @xmath102 , both for fitness plateaus and for fitness valleys .",
    "these more general expressions are those used for numerical calculations of the bounds in our examples . throughout this section",
    ", we consider a metapopulation of @xmath63 demes composed of @xmath3 individuals each , and we assume that individual demes are in the sequential fixation regime ( see results ) .      in order to determine @xmath102 and @xmath88 , we study the evolution of the number @xmath227 $ ] of demes that have fixed the mutant genotype ( ` 1 ' for the calculation of @xmath88 ; ` 2 ' for that of @xmath102 ) , while other demes have genotype ` 0 ' . given that the value of @xmath28 just before a migration step fully determines the probabilities of the outcomes of this migration step , and given that @xmath228 and @xmath229 are absorbing states , the number @xmath28 evolves according to a finite markov chain , each step being a migration event .",
    "we next express the transition matrix of this markov chain .",
    "the only migration events that can affect @xmath28 are those that exchange individuals from two demes with different genotypes .",
    "let us call these migration events `` relevant '' .",
    "the probability @xmath230 of a migration event being relevant corresponds to the probability that this migration affects one of the @xmath28 mutant populations and one of the @xmath231 ` 0 ' populations : @xmath232 $ ] .",
    "we only focus on the final outcome of a migration event , after fixation or extinction of each of the two migrants lineages has occurred .",
    "let @xmath233 denote the probability that the mutant migrant fixes in the ` 0 ' deme , and @xmath234 the probability that the ` 0 ' migrant fixes in the mutant deme . as a result of one such relevant migration event :    * @xmath28 increases by one with probability",
    "@xmath235 , if the migrant mutant fixes in the ` 0 ' deme while ` 0 ' migrant does not fix in the mutant deme .",
    "* @xmath28 decreases by one with probability @xmath236 , in the opposite case . *",
    "otherwise , @xmath28 does not change .",
    "this happens either if both migrants fix ( with probability @xmath237 ) or if no migrant fixes ( with probability @xmath238 ) .",
    "these probabilities , multiplied by the probability @xmath230 that a migration event is relevant , yield the transition matrix of our finite markov chain , which is tri - diagonal ( or continuant ) since each migration step can either leave @xmath28 constant , or increase or decrease it by one : @xmath239 for @xmath240 $ ] , and @xmath241 .",
    "we have denoted by @xmath242 the probability that @xmath28 varies from @xmath26 to @xmath243 as the final outcome of one migration event .    here , we do not account for independent mutations arising and fixing in other demes during the process of spreading ( or extinction ) of the mutant s lineage in the metapopulation .",
    "indeed , our aim is to compare the timescales of migration and mutation processes , so we treat them separately . note",
    "that , in practice , this hypothesis is reasonable if mutations that fix are sufficiently rarer than migration events .",
    "we also consider that the time between two successive migration events is large enough for fixation to occur in the demes affected by migration before the next migration event occurs , which is true in the low - migration rate regime that we study in our work ( @xmath83 , where @xmath4 is the migration rate per individual , while @xmath1 is the death and division rate per individual ) .",
    "@xmath102 and @xmath88 can be directly expressed as the average number of steps of the markov chain necessary to go from the initial state @xmath244 to absorption in a particular absorbing state , either @xmath229 or @xmath228 .",
    "let us present general expressions of these average numbers of steps , before using them to obtain explicit expressions of @xmath102 and @xmath88 .",
    "we are interested in the average number of steps @xmath245 until the system reaches each of the absorbing states @xmath246 , starting from the state @xmath244 : @xmath247 where @xmath248 is the average number of steps that the system spends in the state @xmath249 before absorption , given that it starts in the state @xmath244 and finally absorbs in state @xmath250 .",
    "it can be expressed as  @xcite @xmath251 where @xmath252 is the average number of steps the system spends in state @xmath249 before absorption in either of the two absorbing states , given that it started in state @xmath244 , and @xmath253 is the probability that the system finally absorbs in state @xmath250 if it starts in state @xmath249 .    using the explicit expressions given in  @xcite for @xmath252 and @xmath253 in the case of a tri - diagonal probability matrix , we obtain :",
    "@xmath254 where we have introduced @xmath255      @xmath88 , in fact , corresponds to @xmath256 , where @xmath233 is the probability that a ` 1'-mutant fixes in a deme of ` 0 ' individuals ( i.e. @xmath257 ) and @xmath234 is the probability that a ` 0'-individual fixes in a deme of ` 1'-mutants ( i.e. @xmath258 ) .",
    "hence , it can be expressed explicitly from eqs .",
    "[ n10 ] , [ pincr ] , and [ pdecr ] . since the expressions of @xmath233 and @xmath234 depend whether mutation",
    "` 1 ' is neutral or deleterious , we obtain different expressions for the fitness plateau and for the fitness valley .    [ [ fitness - plateau . ] ] fitness plateau .",
    "+ + + + + + + + + + + + + + + +    for a fitness plateau ( i.e. a neutral intermediate ` 1 ' ) , @xmath259 , where @xmath3 is the number of individuals per deme .",
    "hence , @xmath260 which implies that @xmath261 for all @xmath243 ( see eq .",
    "[ rho ] ) .",
    "thus , eq .  [ n10 ] yields @xmath262 where the last expression holds for @xmath128 and @xmath65 .",
    "[ [ fitness - valley . ] ] fitness valley .",
    "+ + + + + + + + + + + + + + +    eqs .",
    "[ rho ] and  [ pincr ] ,  [ pdecr ] yield @xmath263 , with @xmath264 and eq .  [ n10 ] gives : @xmath265    in these expressions , @xmath266 is the probability of fixation of a deleterious ` 1'-mutant , with fitness @xmath267 , in a deme where all other individuals have genotype ` 0 ' and fitness @xmath268 .",
    "it can be obtained from eq .",
    "[ pij ] , as well as the probability @xmath269 of the opposite process .",
    "@xmath102 corresponds to @xmath270 , where @xmath271 is the probability that a ` 2'-mutant ( with fitness @xmath272 ) fixes in a deme of ` 0 ' individuals ( with fitness 1 ) , and @xmath273 is the probability that a ` 0'-individual fixes in a deme of ` 2'-mutants .",
    "hence , it can be expressed explicitly from eqs .",
    "[ n1n ] , [ pincr ] , and [ pdecr ] , using eq .",
    "[ pij ] to express the fixation probabilities . for @xmath102",
    ", there is no difference between the valley and the plateau , since genotype ` 1 ' is not involved .",
    "as above , eqs .",
    "[ pincr ] , [ pdecr ] and  [ rho ] yield @xmath263 , with @xmath205 defined in eq .",
    ".  [ n1n ] gives @xmath274      in our results section , we have shown that the benefit of subdivision is highest when @xmath121 is situated between a lower bound , @xmath275 and an upper bound , @xmath276 ( see eq .",
    "[ interv ] ) , where @xmath277 denotes the probability of fixation of a single mutant with genotype ` 2 ' in a background of ` 1'-mutants . here",
    "we present simplified expressions for @xmath102 and @xmath88 , and hence of @xmath278 and @xmath279 , in particular parameter regimes .    throughout this section ,",
    "we focus on the regime where @xmath106 but @xmath105 , such that mutation ` 2 ' is substantially , but not overwhelmingly , beneficial  @xcite .",
    "we then have @xmath280 and @xmath109 ( see eq .",
    "[ pij ] ) . to leading ( i.e. zeroth ) order in @xmath281",
    ", we obtain from eq .",
    "[ n1bn ] that @xmath282 where the last expression holds for @xmath65 .",
    "this expression of @xmath102 is identical to eq .",
    "[ ns ] , which was demonstrated more intuitively in the results section by directly assuming @xmath106 and @xmath105 .",
    "we now consider the case of a plateau ( @xmath8 ) and the case of a valley such that @xmath283 but @xmath78 .",
    "we demonstrate that the latter case is consistent with the simplified derivations in our results section .",
    "[ [ fitness - plateau.-1 ] ] fitness plateau .",
    "+ + + + + + + + + + + + + + + +    for a fitness plateau , combining eqs .",
    "[ n1n0 ] and  [ u ] , the upper bound @xmath279 reads @xmath284 where we have used @xmath126 , since mutation ` 1 ' is neutral , and assumed @xmath128 and @xmath129 .",
    "additionally , eqs .",
    "[ nssimpl ] and  [ l ] can be combined to write the lower bound @xmath278 as @xmath285 again to lowest order in @xmath281 . here ,",
    "we have used @xmath74 , since in the case of the plateau , mutation ` 1 ' is neutral .",
    "this expression too holds for @xmath128 and @xmath129 .    combining eqs .",
    "[ up ] and  [ lp ] yields eq .",
    "[ intervsp ] .    [ [ fitness - valley.-1 ] ] fitness valley .",
    "+ + + + + + + + + + + + + + +    next we focus on valleys such that @xmath78 but @xmath94 .",
    "( note that , in the opposite limit @xmath286 , mutation ` 1 ' is effectively neutral , and the above discussion regarding the fitness plateau applies . ) then , @xmath287 ( see eq .  [ pij ] ) .",
    "to lowest ( i.e. zeroth ) order in @xmath67 , eq .",
    "[ n1d0 ] becomes @xmath288 where we have used the approximation @xmath289 , which holds for @xmath78 and @xmath94 .",
    "this expression of @xmath88 coincides with eq .",
    "[ nd ] , which is obtained in the results section through a more intuitive argument that directly assumes @xmath78 and @xmath94 .",
    "hence , from eq .  [ u ] , the upper bound @xmath279 is @xmath290 where we used the conditions @xmath78 , @xmath94 , @xmath105 and @xmath106 to simplify the expression of @xmath277 .",
    "meanwhile , from eq .  [ l ] and  [ nssimpl ] , the lower bound @xmath278 takes the form @xmath291 where , again , we used the conditions @xmath78 , @xmath94 , @xmath105 and @xmath106 to simplify the expressions of @xmath67 and @xmath292 .",
    "combining eqs .",
    "[ lv ] and  [ uv ] yields eq .",
    "[ intervs ] .",
    "let us consider a population of @xmath150 individuals connected by migration to @xmath158 smaller population islands with @xmath293 individuals each .",
    "these islands of identical size are assumed to be in the sequential fixation regime .",
    "for the sake of simplicity , we consider that migration only occurs between the large population and the islands : a migration step is a random exchange of two individuals between the large population and one of the islands ( chosen at random at each migration event ) , and the total migration rate is denoted by @xmath159 . here , we focus on the valley or plateau crossing time of the large population .",
    "we demonstrate that the evolution of a large population can be driven by that of satellite islands .    in the optimal case , the crossing time of the large population",
    "is determined by that of the champion island , i.e. , that which crosses the fitness valley or plateau fastest .",
    "we now determine the conditions under which this optimum is achieved , focusing on migration rates much smaller than division / death rates , @xmath294 , such that fixation or extinction of a mutant lineage in either the large population or an island is not significantly perturbed by migration .",
    "again , migration should be rare enough for islands to remain effectively shielded from migration events while they have fixed the intermediate mutation , until the final beneficial mutation arises .",
    "second , migration should also be frequent enough for the spreading time of the final beneficial mutation from the champion island to the large population to be negligible with respect to the crossing time of the champion island .",
    "these two criteria again provide upper and lower bounds on @xmath160 .    the average time @xmath295 ( with @xmath277 from eq .",
    "[ pij ] ) required for an island of ` 1'-mutants to fix the beneficial mutation ` 2 ' must be smaller than the average time , @xmath85 , for an island of ` 1'-mutants to be wiped out by migration from the large population , which still exhibits genotype ` 0 ' .",
    "the rate of migration events between the island of ` 1'-mutants and the large population is @xmath296 .",
    "hence , @xmath297 , where @xmath298 is the probability of fixation of the lineage of a single migrant with genotype ` 0 ' in an island where all other individuals are ` 1'-mutants : for valleys , it is given by eq .",
    "[ pij ] , while for plateaus , it is equal to @xmath54 .",
    "the first condition , @xmath89 , thus yields @xmath299    the second condition is that the average spreading time , @xmath100 , for the final beneficial mutation to fix in a large population after it has fixed in the champion island , must be smaller than the average valley or plateau crossing time , @xmath14 , of the champion island .",
    "similar to @xmath300 previously , we obtain @xmath301 , where @xmath302 is the probability of fixation of a migrant with genotype ` 2 ' in the large population , which is assumed to exhibit genotype ` 0 ' before migration ( see eq .",
    "[ pij ] ) .",
    "@xmath14 is the average of the minimum crossing time among @xmath158 independent islands .",
    "we again focus , for simplicity , on the limit where the first step of valley or plateau crossing , which occurs at rate @xmath36 , is much longer than the second .",
    "then , we simply have @xmath303 ( see results ) . in this expression , @xmath304 ( with @xmath67 obtained from eq .",
    "[ pij ] ) is the average crossing time for an isolated island .",
    "hence , the champion island crosses the valley @xmath158 times faster on average than a single isolated island .",
    "the second condition , @xmath305 , finally yields @xmath306    together , eqs .",
    "[ tsp ] and  [ tip ] yield the interval of @xmath307 over which we expect subdivision to maximally accelerate crossing : @xmath308 in this range , we expect the valley or plateau crossing time @xmath309 of the large population to be dominated by the crossing time of the champion island , so that @xmath310 .",
    "this prediction is confirmed by our simulations ( see fig .",
    "[ ext]b ) .",
    "we thank ned s. wingreen for stimulating discussions .",
    "afb acknowledges the support of the human frontier science program .",
    "djs was supported by national institutes of health grant k25 gm098875 .",
    "this work was also supported in part by national science foundation grant phy-0957573 and national institutes of health grant r01 gm082938 .",
    "10 [ 1]`#1 ` urlstyle [ 1]doi:#1    [ 1 ] [ 2 ]    _ _ _ _ _ _ _ _ _ _ _ _ _ _ key : # 1 + annotation :  # 2 _ _ _ _ _ _ _ _ _ _ _ _ _ _    dawid a , kiviet dj , kogenaru m , de  vos m , tans sj ( 2010 ) multiple peaks and reciprocal sign epistasis in an empirically determined genotype - phenotype landscape . chaos 20 : 026105 .    draghi ja , plotkin jb ( 2013 ) selection biases the prevalence and type of epistasis along adaptive trajectories",
    ". evolution 67 : 3120 - 3131 .",
    "franke j , klzer a , de  visser jagm , krug j ( 2011 ) evolutionary accessibility of mutational pathways .",
    "plos comput biol 7 : e1002134 .",
    "szendro ig , schenk mf , franke j , krug j , de  visser jagm ( 2013 ) quantitative analyses of empirical fitness landscapes .",
    ": p01005 .",
    "whitlock mc , phillips pc , moore fbg , tonsor sj ( 1995 ) multiple fitness peaks and epistasis .",
    ": 601 - 629 .",
    "schrag sj , perrot v , levin br ( 1997 ) adaptation to the fitness cost of antibiotic resistance in _",
    "e. coli_. proc r soc lond b 264 : 1287 - 1291 .",
    "beerenwinkel n , pachter l , b s , elena sf , lenski re ( 2007 ) analysis of epistatic interactions and fitness landscapes using a new geometric approach .",
    "bmc evolutionary biology 7 : 60 .",
    "trindade s , sousa a , xavier k , dionisio f , ferreira m , et  al .",
    "( 2009 ) positive epistasis drives the acquisition of multidrug resistance .",
    "plos genetics 5 : e1000578 .",
    "andersson di , hughes d ( 2010 ) antibiotic resistance and its cost : is it possible to reverse resistance ?",
    "nat rev microbiol 8 : 260 - 271 .",
    "bloom jd , gong li , baltimore d ( 2010 ) permissive secondary mutations enable the evolution of influenza oseltamivir resistance .",
    "science 328 : 1272 - 1275 .",
    "kryazhimskiy s , dushoff j , bazykin g , plotkin j ( 2011 ) prevalence of epistasis in the evolution of influenza a surface proteins .",
    "plos genetics 7 : e1001301 .",
    "breen m , kemena c , vlasov p , notredame c , kondrashov f ( 2012 ) epistasis as the primary factor in molecular evolution .",
    "nature 490 : 535 - 538 .",
    "gong li , suchard ma , bloom jd ( 2013 ) stability - mediated epistasis constrains the evolution of an influenza protein .",
    "elife 2 : e00631 .",
    "covert aw , lenski re , wilke co , ofria c ( 2013 ) experiments on the role of deleterious mutations as stepping stones in adaptive evolution .",
    "proc natl acad sci usa 110 : e3171-e3178 .",
    "stman b , adami c ( 2014 ) predicting evolution and visualizing high - dimensional fitness landscapes . in : richter h ,",
    "engelbrecht a , editors , recent advances in the theory and application of fitness landscapes , springer , volume  6 of _ emergence , complexity and computation_. pp .",
    "509 - 526 .",
    "korona r , nakatsu ch , forney lj , lenski re ( 1994 ) evidence for multiple adaptive peaks from populations of bacteria evolving in a structured habitat .",
    "proc natl acad sci usa 91 : 9037 - 9041 .",
    "hallatschek o , hersen p , ramanathan s , nelson dr ( 2007 ) genetic drift at expanding frontiers promotes gene segregation .",
    "proc natl acad",
    "sci usa 104 : 19926 - 19930 .",
    "waclaw b , allen rj , evans mr ( 2010 ) dynamical phase transition in a model for evolution with migration .",
    "phys rev lett 105 : 268101 .",
    "martens e , hallatschek o ( 2011 ) interfering waves of adaptation promote spatial mixing .",
    "genetics 189 : 1045 - 1060 .",
    "martens e , kostadinov r , maley c , hallatschek o ( 2011 ) spatial structure increases the waiting time for cancer .",
    "new j phys 189 : 115014 .",
    "otwinowski j , boettcher s ( 2011 ) accumulation of beneficial mutations in one dimension .",
    "phys rev e 84 : 011925 .",
    "zhang q , lambert g , liao d , kim h , robin k , et  al .",
    "( 2011 ) acceleration of emergence of bacterial antibiotic resistance in connected microenvironments .",
    "science 333 : 1764 - 1767 .",
    "greulich p , waclaw b , allen rj ( 2012 ) mutational pathway determines whether drug gradients accelerate evolution of drug - resistant cells .",
    "phys rev lett 109 : 088101 .",
    "hermsen r , deris jb , hwa t ( 2012 ) on the rapidity of antibiotic resistance evolution facilitated by a concentration gradient .",
    "proc natl acad sci usa 109 : 10775 - 10780 .",
    "ewens wj ( 1979 ) mathematical population genetics .",
    "springer - verlag .",
    "weinreich dm , chao l ( 2005 ) rapid evolutionary escape in large populations from local peaks on the wrightian fitness landscape .",
    "evolution 59 : 1175 - 1182 .",
    "rozen de , habets mg , handel a , de  visser jagm ( 2008 ) heterogeneous adaptive trajectories of small populations on complex fitness landscapes .",
    "plos one 3 : e1715 .",
    "weissman db , desai mm , fisher ds , feldman mw ( 2009 ) the rate at which asexual populations cross fitness valleys .",
    "theor pop biol 75 : 286 - 300 .",
    "wright s ( 1931 ) evolution in mendelian populations .",
    "genetics 16 : 97 - 159 .",
    "wright s ( 1932 ) the roles of mutation , inbreeding , crossbreeding and selection in evolution .",
    "proc 6th int congress of genetics 1 : 356 - 366 .",
    "wright s ( 1940 ) breeding structure of populations in relation to speciation . the american naturalist 74 : 232 - 248 .",
    "wright s ( 1982 ) the shifting balance theory and macroevolution .",
    "ann rev genet 16 : 1 - 19 .",
    "lande r ( 1985 ) the fixation of chromosomal rearrangements in a subdivided population with local extinction and colonization .",
    "heredity 54 : 323 - 332 .",
    "slatkin m ( 1989 ) population structure and evolutionary progress .",
    "genome 31 : 196 - 202 .    wade mj , goodnight cj ( 1991 ) wright shifting balance theory - an experimental study . :",
    "1015 - 1018 .",
    "barton nh , rouhani s ( 1993 ) adaptation and the ` shifting balance ' .",
    "genetics research 61 : 57 - 74 .",
    "coyne ja , barton nh , turelli m ( 1997 ) a critique of sewall wright s shifting balance theory of evolution .",
    "evolution 51 : 643 - 671 .",
    "gavrilets s ( 1997 ) evolution and speciation on holey adaptive landscapes . : 307 - 312 .",
    "wade mj , goodnight cj ( 1998 ) perspective : the theories of fisher and wright in the context of metapopulations : when nature does many small experiments .",
    ": 1537 - 1553 .",
    "coyne j , barton n , turelli m ( 2000 ) is wright s shifting balance process important in evolution ? : 306 - 317 .",
    "crow jf ( 2008 ) mid - century controversies in population genetics .",
    ": 1 - 16 .",
    "wade mj ( 2013 ) phase iii of wright s shifting balance process and the variance among demes in migration rate .",
    ": 1591 - 1597 .",
    "desai mm ( 2013 ) statistical questions in experimental evolution . : p01003 .",
    "kerr b ( 2013 ) qcb seminar at princeton university , and private communication .",
    "nahum jr , godfrey-smith p , harding bn , marcus jh , carlson-stevermer j , et  al . (",
    "2014 ) how the tortoise beats the hare : slow and steady adaptation in structured populations suggests a rugged fitness landscape in bacteria .",
    "biorxiv doi : 10.1101/005793 .",
    "kryazhimskiy s , rice dp , desai mm ( 2011 ) population subdivision and adaptation in asexual populations of _ saccharomyces cerevisiae_. evolution 66 : 1931 - 1941 .",
    "van marle g , gill mj , kolodka d , mcmanus l , grant t , et  al .",
    "( 2007 ) compartmentalization of the gut viral reservoir in hiv-1 infected patients .",
    "retrovirology 4 : 87 .",
    "schnell g , price rw , r s , spudich s ( 2010 ) compartmentalization and clonal amplification of hiv-1 variants in the cerebrospinal fluid during primary infection .",
    "j virol 84 : 2395 .",
    "gillespie dt ( 1976 ) a general method for numerically simulating the stochastic time evolution of coupled chemical reactions .",
    "j comput phys 22 : 403 - 434 .",
    "gillespie dt ( 1977 ) exact stochastic simulation of coupled chemical reactions .",
    "j phys chem 81 : 2340 - 2361 .",
    "wielgoss s , barrick je , tenaillon o , cruveiller s , chane - woon - ming b , et  al .",
    "( 2011 ) mutation rate dynamics in a bacterial population reflect tension between adaptation and genetic load .",
    "g3 1 : 183 - 186 .",
    "kerr b , neuhauser c , bohannan bjm , dean am ( 2006 ) local migration promotes competitive restraint in a host - pathogen ` tragedy of the commons ' .",
    "nature 442 : 75 - 78 .",
    "weissman db , feldman mw , fisher ds ( 2010 ) the rate of fitness - valley crossing in sexual populations .",
    "genetics 186 : 1389 - 1410 .",
    "bolch g , greiner s , de  meer h , trivedi ks ( 2006 ) queuing networks and markov chains ( 2nd edition ) .",
    "* population subdivision with migration can accelerate fitness valley crossing . * * a. * fitness valley : fitness @xmath0 versus genotype @xmath196 . * b. * schematic representation of the best possible scenario , for a metapopulation with @xmath135 demes .",
    "each square represents a deme of identical size , and a row represents the metapopulation .",
    "colors represent genotypes , with the color - code defined in a. initially ( top row ) , all demes have genotype ` 0 ' .",
    "the demes explore the fitness landscape described in a quasi - independently , and one of them , the `` champion '' deme ( second from the left here ) , crosses the fitness valley first ( second and third row ) .",
    "individual demes are assumed to be in the sequential fixation regime , so this deme fixes first mutation ` 1 ' and then mutation ` 2 ' . the beneficial mutation ` 2 ' then spreads by migration , which is modeled by random exchange of individuals between demes ( arrow on the fourth row ) , leading to fixation of mutation ` 2 ' in the whole metapopulation ( fifth row ) . * c. * average valley crossing time @xmath18 of a non - structured population , as a function of its carrying capacity @xmath19 , in logarithmic scale .",
    "dots are simulation results , averaged over 1000 runs for each value of @xmath19 ; error bars represent 95% confidence intervals ( ci ) .",
    "theoretical predictions from ref .",
    "@xcite are plotted for the sequential fixation regime ( blue line ) and for the tunneling regime ( red line ) , using @xmath311 ( see text ) to make the correspondence .",
    "the transition between these two regimes is indicated by a dotted line .",
    "the carrying capacities at stake in d are highlighted in green ( @xmath312 : isolated deme ; @xmath313 : non - subdivided population ) .",
    "parameter values : @xmath22 , @xmath314 , @xmath315 and @xmath316 . *",
    "d. * average valley crossing time @xmath13 of a metapopulation composed of @xmath317 demes each with carrying capacity @xmath318 ( total carrying capacity : @xmath319 ) , plotted versus the migration - to - mutation rate ratio @xmath121 , in logarithmic scale .",
    "parameter values are the same as in c , and only the migration rate @xmath137 is varied .",
    "dots represent simulation results averaged over 1000 runs for each value of @xmath137 , and error bars are 95% ci .",
    "black vertical lines represent the limits of the interval of @xmath121 in eq .",
    "[ interv ] .",
    "blue ( resp .",
    "red ) line : valley crossing time for an isolated deme ( @xmath312 ) with @xmath318 ( resp .",
    "a non - subdivided population ( @xmath313 ) with @xmath320 ) for the same parameter values , averaged over 1000 runs ; shaded regions : 95% ci . dashed blue ( resp .",
    "red ) lines : corresponding theoretical predictions from ref .",
    "@xcite ( see c ) . ]",
    "* effect of subdivision on valley crossing time for various migration rates and valley depths.a .",
    "* heatmap of the ratio @xmath138 of the average valley crossing time @xmath13 of a metapopulation with @xmath321 and @xmath322 to that @xmath141 of an isolated deme with @xmath322 , as a function of valley depth @xmath15 and migration - to - mutation rate ratio @xmath121 , in logarithmic scale .",
    "all numerical results are averaged over 100 simulation runs , and the heatmap is interpolated .",
    "solid lines : bounds of the interval in eq .",
    "[ interv ] . dashed line : value of @xmath15 above which a non - subdivided population crosses the valley faster than an isolated deme .",
    "dotted line : value of @xmath15 above which an isolated deme is in the tunneling regime .",
    "dash - dotted line : value of @xmath15 above which the non - subdivided population is in the tunneling regime .",
    "parameter values : @xmath22 , @xmath323 , @xmath315 ; @xmath15 and @xmath137 are varied .",
    "* b. * similar heatmap for the ratio @xmath56 of the average valley crossing time @xmath13 of a metapopulation to that @xmath46 of a non - subdivided population ( with @xmath324 ) .",
    "solid line : predicted value of @xmath15 , from eq .",
    "[ lemin ] , for which the largest speedup by subdivision is expected.,scaledwidth=50.0% ]    * varying the degree of subdivision of a metapopulation . * * a. * valley crossing time @xmath13 of a metapopulation with total carrying capacity @xmath325 , versus migration - to - mutation rate ratio @xmath121 , for four different numbers @xmath24 of demes .",
    "dots are simulation results , averaged over 1000 runs for each value of @xmath121 ( 500 runs for a few points far from the minima ) ; error bars represent 95% ci .",
    "vertical lines represent the limits of the interval of @xmath121 in eq .",
    "[ interv ] in each case , except for @xmath326 , where this interval does not exist .",
    "black horizontal line : plateau crossing time for a non - subdivided population with @xmath320 for the same parameter values , averaged over 1000 runs ; shaded regions : 95% ci . dashed line : corresponding theoretical prediction from ref .",
    "parameter values : @xmath22 , @xmath314 , @xmath315 and @xmath316 ( same as in fig .",
    "[ opti]c - d ) ; @xmath137 is varied .",
    "* b. * valley crossing time @xmath13 of a metapopulation with total carrying capacity @xmath325 , versus the number @xmath24 of demes , for @xmath327 ( i.e. @xmath328 ) .",
    "dots are simulation results , averaged over 1000 runs for each value of @xmath24 ; error bars represent 95% ci .",
    "parameter values : same as in a. * c. * valley crossing time @xmath153 , minimized over @xmath137 for each value of @xmath24 , of a metapopulation with total carrying capacity @xmath325 , versus the number @xmath24 of demes . for each value of @xmath24 ,",
    "the valley crossing time of the metapopulation was computed for several values of @xmath137 , different by factors of @xmath329 or @xmath330 in the vicinity of the minimum ( see a ) : @xmath153 corresponds to the smallest value obtained in this process .",
    "results obtained for the actual metapopulation ( blue ) are compared to the best - scenario limit ( red ) where @xmath331 , calculated using the value of @xmath141 obtained from our simulations .",
    "dots are simulation results , averaged over 1000 runs for each value of @xmath24 ; error bars represent 95% ci . dashed line : value of @xmath24 such that @xmath332 .",
    "dotted line : value of @xmath24 above which the deleterious mutation is effectively neutral in the isolated demes .",
    "solid line : value of @xmath24 such that @xmath333 .",
    "parameter values : same as in a and b. ]    * extension to effectively neutral intermediates and to a large population connected to smaller islands .",
    "* * a. * valley crossing time @xmath13 of a metapopulation composed of @xmath321 demes with @xmath334 , versus migration - to - mutation rate ratio @xmath121 , in logarithmic scale , for three values of @xmath15 in the effectively neutral regime .",
    "dots are simulation results , averaged over 100 runs for each value of @xmath137 ; error bars represent 95% ci .",
    "black vertical lines represent the limits of the interval of @xmath121 in eq .",
    "[ interv ] .",
    "black horizontal line : plateau crossing time for an isolated deme with @xmath334 for the same parameter values , averaged over 100 runs ; shaded regions : 95% ci . dashed line :",
    "corresponding theoretical prediction from ref .",
    "note that the plateau crossing time of the non - subdivided population with @xmath335 is indistinguishable from that of the isolated deme here ( as both are in the sequential fixation regime ) .",
    "parameter values : @xmath22 , @xmath336 , @xmath337 ; @xmath137 is varied .",
    "* b. * valley crossing time @xmath309 of a large population with @xmath324 connected to @xmath158 smaller islands with @xmath338 , versus migration - to - mutation rate ratio @xmath160 , in logarithmic scale .",
    "dots represent simulation results averaged over 100 runs for each value of @xmath159 , and error bars are 95% ci .",
    "vertical lines represent the limits of the interval of @xmath160 in eq .",
    "[ intervp ] .",
    "blue ( resp .",
    "red ) line : valley crossing time for an isolated population with @xmath322 ( resp .",
    "@xmath324 ) for the same parameter values , averaged over 100 runs ; shaded regions : 95% ci . dashed blue ( resp .",
    "red ) lines : corresponding theoretical predictions from ref .  @xcite . for @xmath339 , the observed minimum @xmath309 satisfies @xmath340 ,",
    "where @xmath341 is the average valley crossing time of an isolated island .",
    "for @xmath342 , the observed minimum satisfies @xmath343 .",
    "parameter values : @xmath22 , @xmath344 , @xmath345 and @xmath346 ; @xmath159 is varied.,scaledwidth=50.0% ]"
  ],
  "abstract_text": [
    "<S> natural selection drives populations towards higher fitness , but crossing fitness valleys or plateaus may facilitate progress up a rugged fitness landscape involving epistasis . </S>",
    "<S> we investigate quantitatively the effect of subdividing an asexual population on the time it takes to cross a fitness valley or plateau . </S>",
    "<S> we focus on a generic and minimal model that includes only population subdivision into equivalent demes connected by global migration , and does not require significant size changes of the demes , environmental heterogeneity or specific geographic structure . </S>",
    "<S> we determine the optimal speedup of valley or plateau crossing that can be gained by subdivision , if the process is driven by the deme that crosses fastest . </S>",
    "<S> we show that isolated demes have to be in the sequential fixation regime for subdivision to significantly accelerate crossing . using markov chain theory , </S>",
    "<S> we obtain analytical expressions for the conditions under which optimal speedup is achieved : valley or plateau crossing by the subdivided population is then as fast as that of its fastest deme . </S>",
    "<S> we verify our analytical predictions through stochastic simulations . </S>",
    "<S> we demonstrate that subdivision can substantially accelerate the crossing of fitness valleys and plateaus in a wide range of parameters extending beyond the optimal window . </S>",
    "<S> we study the effect of varying the degree of subdivision of a population , and investigate the trade - off between the magnitude of the optimal speedup and the width of the parameter range over which it occurs . </S>",
    "<S> our results , obtained for fitness valleys and plateaus , also hold for weakly beneficial intermediate mutations . </S>",
    "<S> finally , we extend our work to the case of a population connected by migration to one or several smaller islands . </S>",
    "<S> our results demonstrate that subdivision with migration alone can significantly accelerate the crossing of fitness valleys and plateaus , and shed light onto the quantitative conditions necessary for this to occur . </S>"
  ]
}