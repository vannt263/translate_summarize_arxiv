{
  "article_text": [
    "more than a decade of extensive searches have led to a sample of over 850 confirmed exoplanets and thousands more planet candidates @xcite , almost entirely identified through indirect detection techniques .",
    "such a large number of discoveries allows accurate statistical analyses to address questions related to the distribution of their properties , such as the mass , orbital period and eccentricity @xcite as well as the relevance of the host star characteristics ( mass , metallicity ) on the final frequency and distribution of planetary systems . since the most successful techniques ( radial velocity and transit ) have focused on the inner ( @xmath0 ) environment of main sequence solar - type stars , most of the available information on the frequency of planets concerns this phase space",
    ". radial velocity ( rv ) surveys report that @xmath119% of nearby sun - like stars harbor planets within 20 au @xcite , and recent _ kepler space telescope _",
    "results indicate the frequency of stars with planets to be @xmath130% @xcite .    since both the transit and the radial velocity techniques are biased towards planets in relatively close orbits , orbital separations larger than @xmath15 au are currently not well sampled .",
    "direct imaging surveys , which are typically more sensitive to planets at larger orbital separations can fill this gap . however , to predict the expected planet fractions , the distributions derived from the radial velocity and transit surveys need to be extrapolated .",
    "several tools have been developed in the past few years for the statistical analysis of direct imaging ( di ) planet search surveys , which try to assess at what confidence planet distributions obtained from rv surveys can be extrapolated to estimate the planet distributions to the orbital separations where di is more sensitive .",
    "( hereafter paper 1 ) describes the multi - purpose exoplanet simulation system ( mess ) an idl simulation code specifically designed to perform statistical analysis of direct imaging surveys .",
    "the mess combines the properties of the target stars ( mass , luminosity , distance , age , etc . ) with the assumptions on the planet parameter distributions ( ppd ) , to generate a synthetic planet population ( spp ) and the measured / estimated detection limits of the instrument under scrutiny , to estimate the probability of detecting a companion .",
    "this is then used to validate the original assumption on the ppd , in light of the observed or predicted detection limits .",
    "one can then explore different sets of ppd , the goal being to constrain those that are compatible with the observations . in case of planned observations",
    ", this information can be used to determine which kind of constraints on the ppd the new instrument will be able to provide , and , given a certain ppd , what the expected detection rate would be .    in this paper",
    "we present a novel way to perform statistical analyses of di surveys , called quick - mess , where the standard monte carlo approach is replaced by grid - based sampling of the orbital parameters , which leads to a substantial reduction in the required computational time .",
    "the main features of the code are described in sec .",
    "[ sec : qmess ] . in sec .",
    "[ sec : app ] we present the two main applications of the code , and in sec .",
    "[ sec : summary ] we provide a summary .",
    "the quick - mess ( hereafter qmess ) code presented here does not use a monte - carlo approach as used by most of the statistical tools use so far for the analysis of exoplanet surveys results .",
    "instead it takes a grid - based approach consisting of several steps that allow the determination of the probability of detecting a planet in the considered parameter space , given a set of assumptions on the distribution of the planet orbital parameter and the mass - luminosity function .",
    "the main steps of the code , explained in details in sections [ sec : prjprob ] and [ sec : detprob ] , can be summarized as follows :    1 .",
    "evaluate the distribution of planets with a certain normalised separation , @xmath2 , as a function of the orbital parameters ( as discussed in sec.[sec : prjprob ] ) and integrate and normalise it to get @xmath3 : the distribution of planets as a function of the eccentricity @xmath4 and the normalized separation @xmath2 , where _ s _ is defined as _",
    "s_=r / a with @xmath5 the physical separation and @xmath6 the planet s semi - major axis .",
    "2 .   multiply @xmath3 for the eccentricity distribution @xmath7 3 .   use the planetary evolutionary models to estimate , for each target in the studied sample ,",
    "the minimum detectable planetary mass @xmath8 as a function of the projected separation ( @xmath9 ) , given the contrast limits of the instrument .",
    "4 .   for each value of semi - major axis on an uniform grid , use the distance of the star to convert the normalised separation @xmath2 into the physical projected separation @xmath9 , thus obtaining @xmath10 from @xmath11 . 5 .   for each value of the planetary mass ( @xmath12 ) over an uniform grid",
    "find the range of projected separations where @xmath13 and integrate @xmath10 over this interval to obtain the distribution of detectable planets with a given value of mass and semi - major axis @xmath14 6 .   finally multiply @xmath15 with the required mass and semi - major axis distributions ( @xmath16 and @xmath17 , respectively ) to obtain the detection probability map @xmath18 7 .",
    "in the case of a survey , integrate @xmath19 over the whole range of masses and semi - major axis , in order to obtain @xmath20 the probability of detecting a planet in the considered parameter space",
    ".      the distribution of planets that , given a certain combination of orbital parameters , can be found at a certain position on their projected orbit is assessed by calculating the orbit of the planet in normalized separation @xmath21 , ( where @xmath6 is the semi - major axis of the orbit , and @xmath5 is the radius vector that , together with the true anomaly @xmath22 gives the polar coordinates of the planet on the orbit ) as a function of the orbital phase @xmath23 , over a finely sample grid of @xmath24 and for a range of eccentricities @xmath25 . for a given instant in time @xmath26 , and being @xmath27 the time of periastron passage and @xmath28 the orbital period of the planet , the orbital phase @xmath23 is defined as @xmath29 , which is used to calculate the mean anomaly @xmath30 as in eq .",
    "[ eqn : m_anom ] .",
    "the eccentric anomaly @xmath31 is then calculated using eq .",
    "[ eqn : ecc_an ] where @xmath32 and @xmath33 are introduced as approximations of @xmath31 and @xmath30 and the whole calculation is repeated until the final result is stable ( see * ? ? ?",
    "finally the true anomaly @xmath22 is evaluated using eq .",
    "[ eqn : tr_anom ]    @xmath34    given @xmath22 , we can define the normalised separation @xmath2 : @xmath35    in eq .",
    "[ eqn : rho_fin ] @xmath36 is the argument of periastron , @xmath37 is the longitude of node and the angle @xmath38 together with the projected separation @xmath9 is used to define the coordinates of the planet on the projected orbit . the angle @xmath39 is defined as : @xmath40    where @xmath41 is the inclination of the orbit .    using eqn .",
    "[ eqn : rho_fin ] f(s , e , @xmath36 , @xmath41 ) , the distribution of planets found at a given separation , given @xmath4 , @xmath36 , and @xmath41 , can be calculated . since",
    "@xmath36 and @xmath41 are assumed to be uniformly distributed , they can be integrated over in order to give f(s , e ) : the distribution of planets with a given normalised separation and eccentricity .. , is removed using eqn .",
    "[ eqn : phi ] ]    @xmath42    for qmess , this is done on a fine grid in @xmath36 and @xmath43 , with @xmath44 and @xmath45 and a step sizes of @xmath46=1@xmath47 and @xmath48=0.01 respectively .",
    "this map is computationally intensive but only needs to be calculated once .",
    "the map used for qmess , consists of 1000 steps in @xmath4 and 2000 steps in @xmath2 , is shown in fig .  1 .",
    "note that f(s , e ) is assumed to be uniformly distributed in @xmath4 .",
    "note that altough @xmath3 is , strictly speaking , a probability density function ( representing the fraction of planets with a certain combination of eccentricity @xmath4 and normalised separation @xmath2 . ) , we will for simplicity from now on refer to it as _ projection probability_.    [ fig : orbit ]      the projection probability f(s , e ) obtained in sec .",
    "[ sec : prjprob ] is necessary to evaluate the probability of finding a planet of mass @xmath12 and separation @xmath6 , which is the final goal of qmess .",
    "together with f(s , e ) a set of distributions for the planet eccentricity ( @xmath49 ) , mass ( @xmath50 ) and semi - major axis ( @xmath51 ) is also needed .",
    "we assume that f(e ) , f(m@xmath52 ) and f(a ) are independent .",
    "the implication of this assumption have been discussed by e.g. @xcite and @xcite . in order to account for a non - uniform eccentricity distribution , f(s , e )",
    "is multiplied by f(e ) , although this slightly decreases the flexibility later on , it significantly reduces the memory usage .",
    "the next step consists in converting the instrument detection limit ( expressed in minimum planet / star contrast detectable in the chosen band for a given target , as a function of the projected separation @xmath9 ) into a minimum planet mass ( @xmath8 ) vs projected separation limit . to do this ,",
    "a set of mass - luminosity models are used , assuming that the planet and the star are coeval .",
    "the uncertainties introduced by this approach are discussed in detail in paper 1 .",
    "subsequently , the code generates an uniform grid of masses , @xmath53 , and semi - major axes , @xmath54 , and evaluates the distribution of detectable planets @xmath15 .",
    "first , for each semi - major axis we use the distance @xmath55 of the star to evaluate the projected separation @xmath56 and obtain @xmath10 for each value of a on the grid .",
    "then for each value of @xmath12 the values of @xmath57 and @xmath58 are evaluated from the detection limits , such as @xmath59 for @xmath60 .",
    "note that qmess assumes that the contrast curve is smooth and has only one ( local ) minimum , i.e. that the contrast curve crosses a given level of m@xmath52 no more than two times .",
    "this assumption should hold for most cases , although a local bias from a ( bright ) nearby companion could affect the results .",
    "@xmath15 , defined as the distribution of detectable planets as a function of @xmath12 and @xmath6 , is then calculated as :    @xmath61    the limits on @xmath9 ( @xmath57 and @xmath58 ) are defined by the minimum and maximum separation at which a planet is detectable given the contrast curve .",
    "@xmath62 is then stored for each target .",
    "note that @xmath12 and @xmath6 are uniformly distributed in @xmath62 , although @xmath63 itself is not normalised .",
    "the ( expected ) distribution for semi - major axes @xmath17 and planet mass @xmath16 , all normalised , are then folded into the @xmath62 to provide @xmath64 , a new distribution of detectable planets , now taking into account the observed / predicted distribution of planets .    in a similar way as for @xmath3 , we will refer to @xmath62 and @xmath65 as _ detection probability _ or _ detection map _ although these are also defined as probability density functions .",
    "they in fact represent the fraction of detectable planets with a given mass , @xmath12 , and semi - major axis , @xmath6 , assuming @xmath17 and @xmath16 as the distributions of those parameters .",
    "this approach assumes that the distributions of mass , eccentricity and semi - major axes are not correlated .",
    "the implication of this assumption have been widely addressed by previous works , including @xcite and @xcite .",
    "finally @xmath65 is integrated over the considered range of mass and semi - major axis to obtain the probability of detecting a planet with @xmath66 and @xmath67 as defined by eq .",
    "[ eqn : probam ]    @xmath68    @xmath69 can be also used to evaluate the upper / lower limits on the frequency of planets in the range of mass and semi - major axis explored by the analysed survey as a function of the assumptions made on the mass and semi - major axis distributions .      in order to make the code as fast as possible ,",
    "several optimizations are made .",
    "for contrast curves with a sharp inner working angle ( iwa ) the calculations are performed until @xmath70(iwa ) , after which the probability map will not change .",
    "the limits on @xmath9 , @xmath57 and @xmath58 are defined by the minimum and maximum separation at which the planet is detectable given the contrast curve . at the iwa , the contrast curve increases so rapidly that effectively @xmath57 is no longer dependent on @xmath12 for @xmath71 .",
    "since @xmath57 does not change any more , the detection probability @xmath62 no longer changes compared to that for @xmath70 and thus f(m@xmath72m@xmath73)=f(m@xmath74 , a ) .",
    "if there is also an outer working angle ( owa ) , the code takes it into account as well .      in order to test the consistency of the results , we ran a set of simulations with identical setups , using both mess and qmess .",
    "the sample used for this test is the one observed for the gemini deep planet survey ( gdps * ? ? ?",
    "* ) , consisting of 85 young fgk stars . in both cases",
    "we used a grid of 100 values of the @xmath12 between 1 and 75 @xmath75 and 500 values of @xmath6 between 1 and 500 au .",
    "[ fig : map_compare ]    fig .",
    "2 shows the detection probability @xmath62 , evaluated as in sec .",
    "[ sec : detprob ] , for several values of the companion mass @xmath12 .",
    "the output of the classic mess tool ( open circles ) are overplotted on the ones from qmess ( lines ) .",
    "the same contours are shown for two stars in the gdps sample .",
    "the difference between the two methods is about 5% .",
    "this is consistent with the expected @xmath76 error predicted by poisson statistic over 1000 planets per grid point generated by mess .",
    "[ fig : time ]    fig .",
    "3 shows the fraction of stars with a given computing time for the 85 stars in the gdps sample , in the two test runs .",
    "the total time needed for the full run is 2.6 hours for qmess , as opposed to 4.2 days for the same run performed with the mess .",
    "besides the optimizations used in the qmess code ( which explains the width of the distribution of execution times , see sec .",
    "[ sec : cmp_eff ] ) , the difference in computing time between the two codes is due to the use of the fact that the for qmess the projection probability map is calculated once before the runs described in sec .  [",
    "sec : prjprob ] .",
    "the qmess therefore does not need to evaluate the position on the projected orbit of each generated planets , which is the most time consuming step of mess , given the number of planets involved .",
    "for the run with the gdps sample , mess generates 1000 planets for each step in the mass - semi - major axis grid .",
    "so a total of @xmath77 planets ( @xmath78 per stars ) are generated and need to be projected for the entire mess run .",
    "the two main purposes of the qmess are 1 ) a statistical tool for the analysis of a direct imaging survey ( sec .",
    "[ sec : sam ] ) and 2 ) a predictive tool ( sec .",
    "[ sec : pm ] ) to prepare future surveys .",
    "the main purpose of the qmess is to analyse the ( non-)detection from direct imaging surveys in order to test different assumptions on the planet population and to constrain the maximum occurrence of planets for a given planet population by calculating the expected number of planets and comparing that with the results from a survey with a large target sample .    as an example of this approach , we used the gdps sample described in sec .",
    "[ sec : mess_cmp ] and investigated a variety of different assumptions on the planet parameter distributions .",
    "qmess assumes by default uniform distributions for both planetary mass and semi - major axis ( @xmath16 and @xmath17 ) .",
    "therefore we can easily probe a wide variety of parameter distributions by folding them into the output grid . since the properties of the planets detected via the rv & transit methods seem to be well fitted by simple power laws ( e.g. * ? ? ?",
    "* ) , we explored a grid of distributions , @xmath79 and @xmath80 , by varying @xmath81 and @xmath82 as well as the maximum cut - off for the semi - major axis distribution .",
    "we used a grid of 100 steps between @xmath83 and @xmath84 for @xmath12 and a grid of 1au steps from @xmath85 to the chosen value of the cut - off for the semi - major axis .",
    "the results are shown in fig .",
    "[ fig : abgrid ] .",
    "the left panels show the expected planet fraction ( which is equivalent to the probability @xmath20 evaluated as in eq .",
    "[ eqn : probam ] ) as a function of @xmath81 and @xmath82 , with the semi - major axis cut - off ( @xmath86 ) fixed to 100 , 50 and 10  au ( top to bottom ) .",
    "the star symbol corresponds to the values reported by @xcite : @xmath87 , @xmath88 .",
    "the right panels of the same figure show the impact of varying the semi - major axis cut - off , while keeping the power law for the mass distribution fixed to @xmath81=1.3 , 0 and -1.3 ( top to bottom ) .",
    "no planet was discovered in the gdps survey , but @xcite report a previously known brown dwarf companion around hd 130948 , with an estimated mass in the range @xmath89 and physical separation of @xmath90 .",
    "taking into account this detection , and using the same approach used by @xcite , we estimate a frequency of brown dwarf companions ( @xmath91 ) with separations in the range 25 - 225 au of @xmath92 at 95% confidence level , which is in good agreement with the value of @xmath93 found by @xcite for the same mass and semi - major axis boundaries .    for a semi - major axis cut - off of 10  au no constraints",
    "can be made on the power - law indices . for",
    "larger cut - off values the null detection is only marginally consistent with the @xcite distributions .",
    "in addition to the analysis of a survey , qmess can also be used to assess the performances of , and to select the most suitable targets for new surveys , instruments and/or different observing strategies .    to demonstrate the capabilities of qmess as a predictive tool",
    ", we evaluate the probability @xmath20 for two of the next generation planet finders for 10m - class telescopes that will soon be available to the community , the spectro - polarimetric high - contrast exoplanet research ( sphere , e.g. * ? ? ?",
    "* ) at vlt and the gemini planet finder ( gpi , e.g. * ? ? ?",
    "* ) on gemini south .",
    "both instruments are expected to be available in 2013 and will target young nearby stars looking for planets in wide orbits . to assess the performances we use the estimated detection limits by for sphere , and @xcite for gpi .",
    "whether or not it s correct to use the results of the radial velocity surveys to analyze the results of the direct imaging one it s still open to discussion .",
    "this is due to the lack of a statistically significant sample of planets in wide orbits .",
    "this approach is although the most widely used so far for this kind of analysis , and its caveats and limitations have been discussed by several authors . for this reason , rather than investigating the impact of different distributions for mass and semi - major axis , for which we use the distributions from @xcite ( @xmath94 and @xmath95 ) , we investigate the impact of two different distributions of the eccentricity f(e ) : 1 ) uniform and 2 ) gaussian ( @xmath96 ) .",
    "we also choose to fix the mean of the distribution , @xmath97 , and its variance , @xmath98 , so that @xmath97=0 @xmath99=0.3 , as suggested by @xcite .",
    "the mass range used for the simulations is the same as the one used in sec .",
    "[ sec : sam ] ( @xmath100 , @xmath101 ) and we extrapolated the semi - major axis distribution from @xmath85 up to @xmath102 .    to explore the dependency of the planet detection probability on the characteristics of the targeted stars ( e.g. spectral type , age , and distance ) we generated a set of simulations for five different stellar types ( a0 , f0 , g0 , k0 & m0 ) , and a logarithmic grid in distance and age .",
    "note that this simulation is not intended to represent the stellar population in the solar neighborhood , but rather to investigate the impact of differences in age , distance and stellar type on the probability of finding a planet .",
    "the results , shown in fig .  5 , indicate that the expected planet fraction depends only weakly on the eccentricity distribution .",
    "the expected performances of the two instrument appear to be fairly similar and with a high ( @xmath103  % ) chance of detection for planetary mass companions especially while targeting young , nearby stars .",
    "this is mainly due to the more favorable planet / mass contrast predicted for younger systems , and because closer in targets allow to search for companion with smaller semi - major axis ( which are more likely given the assumed f(a ) ) at a given projected separation .",
    "in this paper we describe the quick - mess ( qmess ) , a fast alternative to the classic monte - carlo tools for the statistical analysis of exoplanet direct imaging surveys .",
    "the use of a grid - based approach reduces substantially the computing times for the analysis , while reducing spurious noise from monte carlo sampling , as shown in sec .",
    "[ sec : mess_cmp ] . in this paper",
    "we demonstrated the two main purposes of the qmess and showed that , as for the mess code , it can be used both as a statistical and predictive tool ( see sec .  [ sec : sam ] and [ sec : pm ] ) .",
    "for the gdps survey we find that their null detection is marginally consistent with the distributions extrapolated from the rv results @xcite .",
    "we have also shown that the eccentricity distribution only has a minor impact on the expected fraction of planet detection for the upcoming surveys , which could have a detection efficiency of up to 20% ( depending on the choice of targets ) provided that the distribution of planet mass and semi - major axis are the same at large ( @xmath104 ) and small ( @xmath105 ) separations .",
    "we thank the anonymous referee for extensive feedback that significantly improved the clarity of the paper .",
    "is supported in part by an ontario postdoctoral fellowship .",
    "this work is supported in large part by grants to r.j . from the natural sciences and engineering research council of canada .          ,",
    "l . , feldt , m. , dohlen , k. , et  al .",
    "2008 , in society of photo - optical instrumentation engineers ( spie ) conference series , vol .",
    "7014 , society of photo - optical instrumentation engineers ( spie ) conference series"
  ],
  "abstract_text": [
    "<S> several tools have been developed in the past few years for the statistical analysis of the exoplanet search surveys , mostly using a combination of monte - carlo simulations or a bayesian approach . </S>",
    "<S> here we present the quick - mess , a grid - based , non - monte carlo tool aimed to perform statistical analyses on results from and help with the planning of direct imaging surveys . </S>",
    "<S> quick - mess uses the ( expected ) contrast curves for direct imaging surveys to assess for each target the probability that a planet of a given mass and semi - major axis can be detected . by using a grid - based approach quick - mess is typically more than an order of magnitude faster than tools based on monte - carlo sampling of the planet distribution . </S>",
    "<S> in addition , quick - mess is extremely flexible , enabling the study of a large range of parameter space for the mass and semi - major axes distributions without the need of re - simulating the planet distribution . in order to show examples of the capabilities of the quick - mess , we present the analysis of the gemini deep planet survey and the predictions for upcoming surveys with extreme - ao instruments . </S>"
  ]
}