{
  "article_text": [
    "the two envelopes paradox is a famous problem of probability which has been extensively discussed in the literature , see for instance @xcite . here",
    "it is presented as a pedagogical exercise .",
    "although the statement of the problem is simple the results are rather counterintuitive and paradoxical at first : an extremely careful treatment of the problem is needed to avoid the pitfalls where many experts on the field have fallen .",
    "it can be used , therefore , as a sharpener of the student intuition on probability theory .",
    "too often statistics and probability theory are taught in the physics degree as a cookbook of recipes where one result has nothing to do with the next .",
    "most of the presumed paradoxical results for this problem are related to uses and abuses of ( i ) the conditional probability and conditional expectation ( ii ) subtleties associated with non normalizable distributions or distributions with no moments ( iii ) the bad use of bayes theorem and of prior probabilities .",
    "in addition , we will show that results existing in the literature for the uniform and the scale invariant prior probabilities are incorrect , due to the lack of a proper normalization of integrals .",
    "we will start by stating the paradox in the two most common situations :    _ ( s0 ) _ a person tells you the following : she will think of a number @xmath0 and write down two checks .",
    "in one she writes down the amount of @xmath0 dollars , in the other she writes down the amount of @xmath1 dollars .",
    "the checks are put into two envelopes and closed .",
    "you can pick out any of the envelopes and keep the amount of that check . once you have decided and chosen one of the two envelopes , but",
    "before opening it , she tells you whether you prefer to change your decision and pick the other envelope .",
    "your goal is to maximize the amount of money you can win .",
    "what should you do ?",
    "this statement is often complemented with the following    _ ( s1 ) _ the same as above .",
    "but you are allowed to open your first picked envelope and read the amount written on the check , say @xmath2 dollars .",
    "again , you are asked whether you prefer to switch to the other envelope or stick with the first one .",
    "the paradox in _ ( s1 ) _ arises as the standard reasoning goes : since i do not know @xmath0 , i assume an uniform probability for @xmath0 .",
    "the check i have chosen ( and has a value of @xmath2 , known to me ) has a probability 1/2 of being @xmath0 and a probability 1/2 of being @xmath3 .",
    "so the other check has a probability 1/2 of being @xmath4 and a probability 1/2 of being @xmath5 .",
    "therefore , the expectation ( the average value ) of the other envelope ( say @xmath6 ) is given by : @xmath7 here , i have added a subscript @xmath2 to the average symbol to clearly state that the expectation is taken with @xmath2 constant ( and known ) .",
    "therefore , independently of the value of @xmath2 , the _ other _ envelope has an expectation value greater than @xmath2 .",
    "this is the paradoxical situation .",
    "the paradox goes on by saying that since the result above gives me an expectation greater than @xmath2 for any value of @xmath2 , then i do not need to open the envelope at all , and therefore in the statement _ ( s0 ) _ i should have @xmath8 , whether or not i have opened the envelope .",
    "but this is really paradoxical since nothing tells me to prefer the first envelope in the first place .",
    "i could have chosen the second envelope first and the reasoning would be the same : no matter which envelope i have chosen _ the other _ appears to have a larger expectation value .",
    "the above arguments are twofold wrong .",
    "first , the statement _ ( s0 ) _ is completely symmetrical in @xmath2 and @xmath6 .",
    "any calculation that give different values to the expectation of @xmath2 and @xmath6 is not justified . and second",
    ", i will argue that the calculation of the expectation of @xmath6 for a given @xmath2 is incorrect .",
    "in particular , a uniform distribution does not produce a conditional expectation @xmath9 .",
    "even such authoritative sources as @xcite give this incorrect result .",
    "the paradox is often enhanced by the introduction of improper ( non normalizable ) prior probabilities , probabilities with infinite mean , and the incorrect treatment of conditional probabilities .",
    "to fix notation , i will always call @xmath0 the number chosen in the first place .",
    "@xmath2 will denote the value written in the first check ( the check of my choice ) , and @xmath6 will denote the value in the other check . evidently , either @xmath10 and @xmath11 or @xmath12 and @xmath13 .",
    "i will call @xmath14 the prior probability of @xmath0 .",
    "we will evaluate the expected values of @xmath6 and @xmath2 for different choices of the prior probability .",
    "will be considered as a random number with a distribution given by @xmath14 . ]    then , the probability of obtaining the three numbers @xmath0 , @xmath2 , @xmath6 , is given by @xmath15 here @xmath16 is the information we have about the problem such as that given by the statement _",
    "( s0 ) _ , complemented by the knowledge of the prior probability , etc .",
    "we use the conventional notation for conditional probabilities , @xmath17 reads as the probability of @xmath18 given that @xmath19 is true .",
    "the two conditions ( either one of the envelope has @xmath0 and the other @xmath20 ) have been included in the equation as a combination of dirac deltas , although one could very well dispose of the use of dirac deltas , it simplifies the notation putting all the cases into a single line .",
    "all the problem consists on calculating marginal probabilities from the eq.([prob ] ) .",
    "notice that the above probability is correctly normalized , if @xmath14 is @xmath21 for any given prior distribution we can calculate the expectation of either @xmath2 or @xmath6 by integrating eq.([prob ] ) , for instance @xmath22 the same result is obtained for @xmath2 so that , @xmath23 independently of the prior distribution @xmath14 .",
    "this answers statement _",
    "( s0 ) _ : if the envelope is not open switching envelopes has no effect on the expectation value .",
    "the problem is completely symmetrical with respect to the two envelopes . using an improper prior",
    "does not invalidate this result .",
    "we can integrate out over @xmath0 in eq.([prob ] ) to give @xmath24 by further integrating with respect to @xmath6 one obtains @xmath25 this is the marginal probability of @xmath2 .",
    "the @xmath26 is at first surprising , but correct .",
    "it is the responsible for the incorrectness of eq.([wuniform ] ) .",
    "the additional 1/2 which appears in eq.([ymargprob ] ) is due to the integration of the @xmath27 which indeed produce an additional factor of 1/2 .",
    "notice that eq.([ymargprob ] ) is correctly normalized to one , since @xmath28 is a probability density , by changing the scale of the variable one needs to rescale also the density .    with this result",
    "we can obtain the conditional probability of @xmath6 given @xmath2 , which is the relevant probability for problem _ ( s1 ) _ , using bayes theorem @xmath29 @xmath30 acts here as a normalizing factor .",
    "the expectation of @xmath6 given that @xmath2 is known is given by @xmath31 obviously , in general , we have @xmath32 .",
    "so the paradox seems to be alive .",
    "as a warm up exercise consider the case where @xmath14 is a well behaved distribution and has finite moments . for the sake of definiteness",
    "we will chose a simple exponential @xmath33 we assume that @xmath34 is known to us . by integrating the above equations we obtain @xmath35",
    "finally we get from eq.([zcond ] ) , after some algebra @xmath36 as expected from the previous section @xmath32 .",
    "are we getting a paradoxical result ?",
    "of course not !",
    "the distribution @xmath37 has an average value of @xmath38 and the peak probability occurs for @xmath39 , so knowing the value of @xmath2 is very relevant to the inference of possible @xmath0 s . if @xmath2 is small ( @xmath40 ) then it is more probable than @xmath41 than the other way around , and switching is the best course of action . indeed from eq.([zf0 ] ) for @xmath2 small we have @xmath42 . on the other hand , larger values of @xmath0",
    "are exponentially suppressed , so that if @xmath2 is large ( @xmath43 ) it is more probable than @xmath0 is the lowest value of the two allowed possibilities ( i.e. @xmath44 ) and therefore switching is out of the question .",
    "indeed , in this case @xmath45 for @xmath2 large . for a frequentists approach ,",
    "a single realization of the experiment is irrelevant .",
    "if we were to repeat this game many times we will have to average over the marginal probability of getting a @xmath2 @xmath46 which of course reduces to our original expectation : if we repeat the experiment many times , always switching from our first choice , the expectation of our profit is completely symmetrical and we win nothing , on average , with respect to not switching .",
    "consider the case where the prior probability of getting the value @xmath0 is known and uniform @xmath47 . since the uniform distribution is not normalizable we will choose a maximum allowed value @xmath48 to make a normalizable distribution , with the hope that , after our calculation is done , we can safely take the limit @xmath49 .",
    "set @xmath50 integrating the expression eq.([prob ] ) over @xmath0 and @xmath6 we obtain the marginal probability for @xmath2 @xmath51 observe that the above equation is correctly normalized and that the average value of @xmath2 is indeed @xmath52 . as before , we can calculate the conditional probability of the other choice knowing @xmath2 @xmath53 notice that for @xmath54 there is only one possibility .",
    "indeed if we know that , @xmath6 must be the @xmath20 and @xmath2 must be @xmath0 .",
    "the conditional expectation is now given by @xmath55 our claim is that this equation is the correct result for an uniform prior probability , instead of the common result eq.([wuniform ] ) .",
    "we can convince ourselves by noting that all the probabilities , total and marginal are correctly normalized and the limits of integration have been carefully taken into account .",
    "failure to do so leads to the incorrect result eq.([wuniform ] ) .",
    "the major source of confusion comes from the failure to recognize that if @xmath14 is a correctly normalized probability distribution , then @xmath56 is not ( for @xmath57 ) .",
    "there is a jacobian involved which our use of delta functions have taken into account .",
    "additionally , one can check that , by averaging over @xmath2 , with the marginal probability eq.([yuniform ] ) , one obtains @xmath58 for any @xmath48 , as it should .",
    "again we see here the same behavior that in the previous example .",
    "there is a `` safe '' region ( here @xmath59 ) where switching is profitable , however there is also an `` unsafe '' region ( @xmath60 ) where switching would lead to lesser your expectations .",
    "the gain and losses of the two regions conspire so that at the end , if we were to repeat the game many times , we would get @xmath61 .",
    "after all this labor , we realize that setting @xmath62 will not work .",
    "one would miss the `` unsafe '' region , needed to satisfy the normalization of the probability and the symmetry argument .",
    "one can check that the total probability that goes into the `` unsafe '' region is constant ( 1/4 ) and independent of @xmath48 .",
    "so by passing to the limit one would , literally , put this region under the rug .",
    "the fact that an uniform distribution extending to infinity can not be normalized has precluded previous work from recognizing it .",
    "in problems where scale invariance is an issue , it is convenient to introduce the jeffreys prior @xmath63 .",
    "the use of this probability density is discussed in @xcite where several examples of usage and properties are included .",
    "it is invariant against changes of variables of the form @xmath64 , and also for changes of scale @xmath65 . in our problem",
    ", there is no reference to any scale , @xmath0 could be millions or could be a penny , so the choice of the jeffreys prior seems appropriate .",
    "unfortunately , it is not normalizable and the probability diverges both for @xmath0 very large and for very small values .",
    "so , we will start with a conveniently normalized prior by setting a minimum @xmath66 and maximum @xmath67 amount of money @xmath68 @xmath19 is the normalization constant . repeating the previous steps we get",
    "@xmath69 @xmath70 is zero outside the given ranges . for the conditional probability @xmath71 and finally @xmath72 as",
    "before the meaning of this equation is clear . if @xmath2 is low ( @xmath73 ) , the best option would be to switch , since we must have @xmath10 .",
    "if @xmath2 is large ( @xmath74 ) then it is sure that @xmath75 and therefore switching is not desirable . for intermediate values",
    "one gets that , on average , switching is the preferred option . in fig.([fig1 ] ) we show the result of a monte carlo run for the jeffreys prior with @xmath76 and @xmath77 .",
    "the lines are not fits to the result of eq.([zjeff ] ) .",
    "again the passage to the limit @xmath78 and @xmath79 is not possible , but for any finite values of the limits , we get that , as before @xmath80 it has become a standard lore that the jeffreys prior gives an even expectation ( i.e. @xmath81 ) @xcite . here",
    "we have shown that this is incorrect , those calculations miss the jacobian in the term having @xmath82 .",
    "in addition , it is rather unfortunate that the `` standard '' result for the uniform prior eq.([wuniform ] ) which is also wrong , reproduces the correct result for the jeffreys prior , in the `` safe '' region ( eq.([zjeff ] ) ) .",
    "[ fig1 ]    we could ask whether any prior which gives the `` naively expected '' result @xmath81 exists . by direct inspection of eq.([zcond ] ) we obtain that @xmath83 would produce the desired result in the `` safe '' region . although this distribution is not normalizable we can take the limit so that one keeps @xmath81 and @xmath23 .",
    "however , i can not think of any physical argument that would lead us to this prior probability .",
    "in the computer age , we could change this game of envelopes and checks by a computer program .",
    "but now we are allowed one further subtlety    _ ( s2 ) _ someone chooses a number @xmath0 .",
    "two options ( 1 ) or ( 2 ) ( one with @xmath0 and the other with @xmath20 , as before ) are presented to you in a computer terminal .",
    "once you choose one option and click into it , say option ( 1 ) , the computer changes the value associated to options ( 1 ) and ( 2 ) as follows . your choice is always set to $ 10 , and shown to you .",
    "the other ( hidden ) option is set either to $ 20 or to $ 5 depending on whether that option had originally being set with @xmath20 or @xmath0 respectively .",
    "you are informed of the whole procedure and again you are asked whether you prefer to change you choice or not .",
    "one must recognize that the game played here is different from the one in _",
    "( s1)_. in fact by changing you election from @xmath2 to $ 10 one nullifies the original choice of @xmath0 and any prior probability we may choose for it is irrelevant .",
    "an elementary calculation shows that now the expected value of the other choice is given by @xmath84 it is interesting to recognize in this equation the original ( and incorrect ) result eq.([wuniform ] ) , for an uniform prior for problem _",
    "( s1)_. apparently the reasoning behind it is something similar to this :  you have chosen some value @xmath0 , since i assume the probability of a given @xmath0 to be uniform , i can safely set it to anything i like , so , i open my envelope and find , say , $ 10 on it the only options is for the other choice to be $ 20 or $ 5 with probabilities of 50% each ...  . as was shown above this kind of reasoning",
    "is incorrect .",
    "now @xmath85 is greater than @xmath2 for any @xmath2 and therefore we are back to the paradox , so it seems .",
    "no matter what choice i made , i would be better off by switching .",
    "but of course , this is the correct , and expected , result : the problem has lost the symmetry between the two choices .",
    "after all the computer is tricking us and in fact it is putting more money , on the average , on the _ other _ choice .",
    "the procedure of changing whatever value of @xmath2 to $ 10 reminds us of a normalization or of a change of scale .",
    "the only scale invariant prior probability is given by jeffreys prior .",
    "it is reassuring that we obtain here the same result as with jeffreys eq.([zjeff ] ) in the `` safe '' region .",
    "this could be expected .",
    "however , for any prior probability we set in the _ ( s1 ) _ game there must exists also an `` unsafe '' region , where switching will lead us to a loss , to recover the symmetry . in short ,",
    "the game played in statement _ ( s2 ) _ can not be cast into a _ ( s1 ) _",
    "game for any choice of prior probabilities .",
    "the closest we can get is by using the scale invariant jeffreys prior .",
    "it is interesting to notice that intuitively one transforms an _ ( s1 ) _ problem with an uniform prior into a scale invariant _ ( s2 ) _ problem in a rather unconsciously way .",
    "this solves the paradox .",
    "improper priors have been severely criticized by @xcite on the basis that they are meaningless , since they are not normalizable .",
    "this is taken as a proof that the bayesian interpretation of probabilities is incorrect .",
    "however , improper priors can be useful and give meaningful results .",
    "the fact that in this problem we get something contrary to our uneducated intuition does not invalidate the use of priors , normalizable or not .",
    "rather , it invalidates our intuition .",
    "arguably , the most used wave function in quantum mechanics is the plane wave , which is an uniform distribution over the whole space .",
    "the fact that it is not normalizable does not deter to a physicist to calculate the cross section of , say , an @xmath86 collision at cern , without worrying much about the probability of finding the electron near the andromeda galaxy . or",
    "again , a charged particle traversing matter suffers from loss of energy by the emission of radiation , the so called bremsstrahlung radiation .",
    "the probability of emission of a photon of frequency @xmath87 is proportional to @xmath88 , which is of the jeffreys type . here",
    "the point is that despite the infinities that may appear ( infinity number of photons emitted at very low frequency ! ) one can calculate the total energy lost , which is well defined and finite ( there is a natural high frequency cut off because the total available energy is finite ) .",
    "the same kind of reasoning goes behind the calculation of probabilites using the anthropic principle or the parton distribution functions .",
    "they have associated probabilities densities which , in some cases , can be improper .",
    "the moral of this is that an improper probability distribution can be safely used by starting with a normalized distribution , doing the calculation and then passing to the limit .",
    "if the passage to the limit gives a sensible result , its use is justified . in our problem",
    ", we have learnt that any hint on the existence of a `` scale '' will give us an advantage over the indifferent choice .",
    "for instance , we may be playing a real game with real money involved , then there is a maximum value @xmath0 can have .",
    "no one will sign a check with , say , the us gdp .",
    "or we may be in a tv show , we know the prize history of the show and we know that this show has never given prizes for more than , say $ 1000 .",
    "any hint will let you take advantage and win , on average .",
    "however , if we have no idea of any scale of the money involved then the problem is not well defined : we have no rational basis for any preferred choice . for a scale free problem , the jeffreys prior should be used , however , as we have seen , it does not give a sensible result in the passage to the infinity limit , since the expectations are infinity . if i were to set the following problem : i think of a number @xmath0 , estimate what is the expectation value of @xmath0 ?",
    "there is no prior which would produce any sensible result .",
    "this is not a fault on the use of improper priors but rather on the ill definition of our problem .",
    "the paradox arises because one , consciously or unconsciously , changes from an _ ( s1 ) _ type problem to an _ ( s2 ) _ problem , making it asymmetric on the two envelopes .",
    "a correct treatment of the prior probabilities reveals the falsity of the argument .",
    "therefore , in the absence of any additional scale , any argument leading to a preferable choice can not be justified .",
    "chalmers , the two envelope paradox : a complete analysis ?",
    "march 1994 .",
    "r. christensen and j. utts , bayesian resolution of the `` exchange paradox '' , am . stat .",
    "46 ( 1992 ) 274 .",
    "j. broome , the two envelope paradox , analysis 55 ( 1995 ) 6 .",
    "streater , lost causes in and beyond physics , springer 2007 .",
    "jaynes , probability theory .",
    "the logic of science , cambridge 2003 .",
    "h. jeffreys , theory of probability , oxford , 1948 ."
  ],
  "abstract_text": [
    "<S> the two envelopes paradox is discussed . by calculating the conditional probability , </S>",
    "<S> we arrive at a conditional expectations which differs from existing results . </S>"
  ]
}