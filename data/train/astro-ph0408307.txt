{
  "article_text": [
    "the rhessi ( lin et al . 2003 ) instrument is designed to explore particle acceleration in solar flares ( e.g. , miller et al . , 1997 ) .",
    "it observes photons at energies from 3 kev to 17 mev with spectral resolution up to @xmath0@xmath1500 . in order to obtain images ,",
    "rhessi is equipped with 9 pairs of x ray shadowing grids ( 9 ` subcollimators ' ) , which are fixed on the rotating spacecraft ( spin period @xmath2@xmath14s ) .",
    "the instantaneous transmission probability of one subcollimator , projected onto the solar disc ( heliocentric cartesian coordinates @xmath3 ) , is called the ` modulation pattern ' ( hurford et al . , 2003a ) .",
    "it has the approximate form ( @xmath4=1 ... 9 ) @xmath5 the wave vectors @xmath6 correspond to periods ( ` angular pitches ' ) of @xmath1@xmath7 asec , and @xmath8 is the imaging ( optical ) axis .",
    "the angle @xmath9 between @xmath6 and the heliocentric @xmath10-axis is given by @xmath11 , where @xmath12 is the roll angle and @xmath13 is the grid orientation on the spacecraft .",
    "the triples @xmath14 are referred to as ` aspect solution ' , and are continuously monitored by the on - board aspect systems ( fivian and zehnder , 2003 ; hurford et al . , 2003b ) .",
    "the coefficients @xmath15 in eq . ( [ modpat ] ) depend on energy and ( weakly ) on @xmath16 ; they describe the x ray transmission of the grids . above 100 kev",
    "the grids become increasingly transparent . in",
    "what follows , the energy band is fixed , and the energy dependence is omitted .    at any time",
    ", the 9 subcollimators respond to 9 different fourier components of the solar brightness distribution . during half a rhessi rotation ,",
    "up to thousand fourier components are collected , from which the spatial brightness distribution can be restored ( hurford et al . , 2003a ) .",
    "the imaging information is thus encoded in the temporal modulation of the observed count rates . in order to track impulsive events ( energy release , acceleration ) on time scales below 2s",
    ", the observed count rates must be demodulated at the expense of spatial information .",
    "the present article reports on further development of the demodulation method of arzner ( 2003 ) , which compared count rates with similar modulation patterns .",
    "this constraint was rather restrictive , since both the roll angle and the grid phase had to agree .",
    "the request for grid phase agreement can in fact be relaxed by the use of visibilities ; this is described in section 2 below . in order to work properly",
    ", this approach requires that the time binning is synchronized with the spacecraft rotation , i.e. , that @xmath17 ( mod @xmath18 ) recurs after an integer number of time bins @xmath19 . on the other hand",
    ", @xmath19 must be an integer multiple of a binary micro second , which is the hardware time resolution .",
    "the improved version choses an optimum compromise between the two conflicting constraints , while keeping the number of counts per bin at a statistically uselful level ( @xmath1 10 ) .",
    "section 3 shows benchmark simulations and the demodulation of real rhessi data .",
    "the goal of the method is to separate spatial and temporal variations of the solar brightness distribution .",
    "the basic observation is that the visibilities at equal grid orientation should be compatible if the brightness distribution did not change with time .",
    "deviations are attributed to time dependence of the source distribution .",
    "technically , this is done by a regularized maximum - likelihood fit with many ( @xmath2010@xmath21 ) parameters describing both spatial and temporal source variability .",
    "( circles ) during @xmath22 = 8 spacecraft revolutions at the flare of august 23 , 2002 , 06:25 ut . the wave vectors ( arrow indicates orientation of @xmath23 at final time ) rigidly co - rotate with @xmath8 .",
    "the average spin axis is marked by a cross .",
    "right : change of modulation phase of subcollimator 3 per @xmath19 at the average spin axis ( @xmath24 ) .",
    "the condition @xmath25 is the basis of eq .",
    "( [ appr]).,width=566 ]    let us start with a brief description of the spacecraft motion , which determines the time - dependent instrumental response ( eq . [ modpat ] ) . during a few ( @xmath22@xmath2610 ) spin periods , the rhessi motion is composed of an approximately uniform rotation and a slow translation ( figure [ aspect ] left ) .",
    "we formalize this by making the following assumptions ( which are checked from the aspect solution ) :",
    "( i ) the spin period @xmath2 is constant to accuracy @xmath19 over the time of interest ( @xmath27 ) ; ( ii ) the wave vectors @xmath6 rotate clockwise with spin period @xmath2 ; ( iii ) the imaging axis @xmath8 , which is generally not aligned with the spin axis denotes the penetration point of the instantaneous rhessi spin axis through the solar disk . ]",
    "@xmath28 , rotates ( clockwise , period @xmath2 ) around @xmath28 .",
    "( iv ) the spin axis and @xmath29@xmath30 vary slowly due to precession ( @xmath31 0.015 hz ) , inertia adjustment , and magnetic torquing ( lin et al . , 2003 ) .",
    "we next set up a model for the solar brightness distribution .",
    "it is assumed that the true brightness can be represented as @xmath32 where @xmath33 are arbitrary non - negative normalized ( @xmath34=1 ) functions and @xmath35 ( ct / s ) is the instantaneous count rate . in principle , eq .",
    "( [ model ] ) describes all possible brightness distributions , but in practice we restrict ourselves to a few source components @xmath36 ; perhaps , a gradual plus an impulsive component with different intrinsic time scales .",
    "impulsive components could be associated with magnetic footpoints .",
    "it should be pointed out that eq .",
    "( [ model ] ) can not account for continuously moving sources , and that non - solar background is neglected .    combining the rhessi response ( eq . [ modpat ] ) with the brightness model ( eq . [ model ] ) one can predict the expected counts in time bins @xmath19 .",
    "as we wish to resolve the source evolution it is assumed that @xmath35 varies slowly during @xmath19 . the expected number of counts in the @xmath4-th subcollimator and @xmath37-th time bin is then given by @xmath38 where the livetime measure @xmath39 accounts for detector dead time ( smith et al . , 2003 ) and data gapsc ) .",
    "they affect some 30% of all data , and are presumably caused by cosmic rays .",
    "the livetime measures @xmath39 are between zero and one .",
    "] , @xmath40 = @xmath41 is the ( discrete ) count rate , and @xmath42 we recall that @xmath3 denotes heliocentric coordinates . while being natural , these coordinates are not well adapted to the observing geometry , and do not allow to separate fast ( rotational ) and slow ( translational ) contributions to modulation .",
    "such a separation is , however , possible if we set @xmath3 = @xmath43 , where @xmath44 is the average spin axis ( figure [ aspect ] left cross ; average over @xmath22 spin periods ) . after expanding the cosine in eq .",
    "( [ modpat ] ) , eq .",
    "( [ x ] ) becomes @xmath45 now , the term in curly brackets is the grid phase at the average spin axis , which is a slowly varying quantity .",
    "if also @xmath46 and @xmath47 are weakly varying , then eq . ( [ x ] ) can be approximated by @xmath48 where @xmath49 is a discrete version of @xmath50 , @xmath51 is the discrete grid phase at average spin axis , and the last line defines the ( @xmath19-integrated ) visibilities @xmath52 and @xmath53 .",
    "the visibilities satisfy @xmath54 @xmath55 @xmath56 , @xmath57 = @xmath58 , and @xmath59 = @xmath60 , where @xmath61 is the ( even ) number of time bins per spin period .",
    "the visibility approach ( eqns .",
    "[ lambda ] and [ appr ] ) is valid if @xmath62 and @xmath63 which must hold during the whole time interval @xmath27 .",
    "a safe threshold for eqns . ( [ cond ] ) is 0.1 , which is checked by the computer code .",
    "this is usually uncritical ( figure [ aspect ] right ) : from typical aspect data , one finds that time bins as large as @xmath19 = 0.3s are admissible even for the finest subcollimator . it should be stressed that this is much larger than the modulation period  the modulation must not be resolved to predict similar ( @xmath19-integrated ) visibilities . of course",
    ", integrating over modulation razes spatial information , but this does not affect the time profiles @xmath40 .    at this point we have completed the forward model ( eqns .",
    "[ lambda],[cs ] ) .",
    "it has parameters @xmath64 , where 1 @xmath55 @xmath65 @xmath55 @xmath66 , 1 @xmath55 @xmath37 @xmath55 @xmath67 , and @xmath4 is out of a subcollimator set satisfying eq .",
    "( [ cond ] ) .",
    "we turn now to the counting statistics .",
    "let the observed light curve of subcolllimator @xmath4 have @xmath68 counts in time bin @xmath37 .",
    "these counts should scatter around the expectation value @xmath69 ( eq . [ lambda ] ) according to poisson statistics .",
    "the agreement between observation and prediction is therefore measured by the poisson log likelihood ratio ( eadie et al . , 1971 )",
    "( ` c - statistic ' ) @xmath70 the likelihood @xmath71 is proportional to the probability that @xmath72 is observed if @xmath73 was true .",
    "log l is negative , and reduces to @xmath74 in the limit of high count rates .",
    "the asterisks in eq .",
    "( [ logl ] ) indicates that the sum is restricted to count rates with livetimes @xmath39 @xmath75 @xmath76 , with @xmath76 typically chosen as 0.5 .",
    "this prevents from pile up and from redundant numerical operations , since 0 @xmath77 @xmath39 @xmath77 @xmath76 is rare but @xmath39 = 0 is frequent ( @xmath78% data gaps ) . the rejection of low livetimes is not expected to affect the result .",
    "since there are more model parameters @xmath64 than observations @xmath79 , and since the model parameters are not independent of each other , the maximum - likelihood problem does not have a unique solution . in order to regularize the problem we assign an a priori probability @xmath80 to the @xmath36-th time profile @xmath40 .",
    "this choice favors smooth time profiles , and allows an explicit trade - off between the smoothness of the demodulation and the likelihood .",
    "it also has the useful feature that it linearly interpolates across data gaps . taking the a priori probability into account , the logarithm of the total ( observational + a priori ) probability @xmath81 becomes , according to bayes rule , @xmath82 the quantity @xmath83 possesses a unique maximum which is found by newton / marquardt type iterations .",
    "the coefficients @xmath84 determine the smoothness of the solutions @xmath85 .",
    "small @xmath84 yield small correlation times @xmath86 of @xmath85 .",
    "while the exact relation between @xmath84 and @xmath86 depends on the actual data set and on the definition of @xmath86 , there exists a useful empirical estimate , @xmath87 in eq .",
    "( [ tau ] ) , @xmath86 is defined via the normalized autocorrelation @xmath88 of @xmath85 by @xmath89 . the accuracy of eq .",
    "( [ tau ] ) is within a factor two .",
    "the adjustment of @xmath84 is done by the user .",
    "the newton / marquardt iterations have the property that two solutions @xmath85 agree if their @xmath84 agree .",
    "= 0.1s ( dotted , shifted for better clarity ) ; d ) similar to c ) including 30% simulated data gaps ; e ) demodulation ( solid ) and average ( dotted , @xmath90=0.1s ) of subcollimators 7 - 9 ( no data gaps ) .",
    "f ) : robustness against violation of eq .",
    "( [ model ] ) - top to bottom curves : true unmodulated light curve of 5 independent components ; two - component demodulation from subcollimators 1 - 9 ; average over subcollimators 1 - 3 and time @xmath90=0.25s .",
    "the middle and bottom curves are shifted for better clarity .",
    "g ) : iterative convergence of eq .",
    "( [ f ] ) : @xmath91 ( boldface ) ; @xmath92 ( solid ) ; gradual ( @xmath36=0 , dotted ) and impulsive ( @xmath36=1 , dashed ) smoothness constraints.,width=359 ]    = 0.1s ( dotted , shifted for better clarity ) ; d ) similar to c ) including 30% simulated data gaps ; e ) demodulation ( solid ) and average ( dotted , @xmath90=0.1s ) of subcollimators 7 - 9 ( no data gaps ) .",
    "f ) : robustness against violation of eq .",
    "( [ model ] ) - top to bottom curves : true unmodulated light curve of 5 independent components ; two - component demodulation from subcollimators 1 - 9 ; average over subcollimators 1 - 3 and time @xmath90=0.25s .",
    "the middle and bottom curves are shifted for better clarity .",
    "g ) : iterative convergence of eq .",
    "( [ f ] ) : @xmath91 ( boldface ) ; @xmath92 ( solid ) ; gradual ( @xmath36=0 , dotted ) and impulsive ( @xmath36=1 , dashed ) smoothness constraints.,title=\"fig:\",width=321 ] + = 0.1s ( dotted , shifted for better clarity ) ; d ) similar to c ) including 30% simulated data gaps ; e ) demodulation ( solid ) and average ( dotted , @xmath90=0.1s ) of subcollimators 7 - 9 ( no data gaps ) .",
    "f ) : robustness against violation of eq .",
    "( [ model ] ) - top to bottom curves : true unmodulated light curve of 5 independent components ; two - component demodulation from subcollimators 1 - 9 ; average over subcollimators 1 - 3 and time @xmath90=0.25s .",
    "the middle and bottom curves are shifted for better clarity .",
    "g ) : iterative convergence of eq .",
    "( [ f ] ) : @xmath91 ( boldface ) ; @xmath92 ( solid ) ; gradual ( @xmath36=0 , dotted ) and impulsive ( @xmath36=1 , dashed ) smoothness constraints.,title=\"fig:\",width=321 ]",
    "as a benchmark , figure [ sim]a - e shows simulations where the model assumption ( eq . [ model ] ) is met .",
    "there are two sources at ( -715,630  ) and ( -650,690  ) , of size 1  and 3  , with impulsive ( figure [ sim]a solid line ) and gradual ( figure [ sim]a dashed ) time profiles .",
    "the small source sizes yield maximal modulation and therefore represent a worst - case test for demodulation and residual modulation .",
    "fig [ sim]b shows a close - up of the true impulsive time profile , which is to be compared with the estimates c)-e ) obtained from simulated ` observations ' with @xmath93 = @xmath94 .",
    "the simulated aspect solution has the form @xmath8 = @xmath95 with @xmath96 = ( 0.8,1.3 ) asec / s the instantaneous precession rate , @xmath97 = @xmath98 the rhessi angular frequency , @xmath99 = 120  the coning radius , and @xmath100 a phase offset .",
    "figure [ sim]c - d shows the demodulation results ( solid line ) and averages over subcollimators 1 - 3 and time ( dotted line ) with similar nominal resolution . in figure",
    "[ sim]c , @xmath19=5ms , and the demodulation @xmath101+@xmath102 ( solid line ) of subcollimators 1 - 9 is compared with a moving average @xmath103 ( dotted ) over subcollimators 1 - 2 and time interval @xmath90=0.1s . the autocorrelation time constant of the impulsive component @xmath102 is @xmath104 = 0.09s , while eq .",
    "( [ tau ] ) gives @xmath104 @xmath1 0.14s .",
    "numerically , the rms deviations from the true time profile are 5% ( average ) and 3% ( demodulation ) , while the statistical error assigned to the @xmath19-binned true light curve would be about 6% . while the benefit from 3% to 5% is rather small and within the statistical error , the situation changes if data gaps are present .",
    "figure [ sim]d is similar to [ sim]c , but includes simulated data gaps with @xmath105=0.7 . simultaneous data gaps in subcollimators 1 - 3 with duration @xmath20@xmath90 can not be interpolated with a moving average ( dotted line ) , and the rms deviation of the moving average from the true time profile is 25% ( whereas it is 4% for the demodulation ) . if one tries to improve the moving average by including coarser subcollimators one encounters the difficulty that their ( at least , slowest ) modulation commensurates with the time scale to be resolved .",
    "the moving average then fails even in the absence of data gaps ( figure [ sim]e dotted ) .",
    "a possible way out is demodulation as described in this paper ( figure [ sim]e solid ) . here , both the demodulation ( solid ) and average ( dotted ) involve subcollimators 7 - 9 .",
    "the rms deviation from the true time profile is 6% ( demodulation ) and 18% ( average ) , respectively .",
    "a test was also made for violation of the model assumption ( [ model ] ) .",
    "figure [ sim]f shows the demodulation of ( simulated ) counts from 5 sources with different time profiles .",
    "the demodulation ( figure [ sim]f middle curve ) uses subcollimators 1 - 9 and is based on the ( wrong ) assumption that @xmath106=@xmath107+@xmath108 .",
    "nevertheless , it has slightly better rms deviation from the true ( spatially integrated ) light curve ( figure [ sim]f top ) than a corresponding average ( figure [ sim]f dotted line ) .",
    "surprisingly , violation of the model assumption ( [ model ] ) does not degrade the result below the quality of a simple average .",
    "the iterative convergence to the maximum-@xmath81 solution is demonstrated in figure [ sim]f , referring to simulation [ sim]c ) .",
    "the total probability ( boldface ) is dominated by the log likelihood ( solid line ) , indicating that the demodulation is primary determined by the agreement with the observation .",
    "= 0.08s ( dotted , shifted for better clarity ) , demodulation @xmath101+@xmath102 ( solid line ) , and gradual component @xmath101 ( smooth curve ) from subcollimators 1,3,4,6,7,8,9 ; b ) close - up of demodulation ( solid ) with errors ( gray , see text ) and moving average ( dotted ) ; c ) example of observed ( crosses ) and predicted ( gray line ) counts for subcollimator 6 .",
    "e ) , d ) : clean images at total , gradual maxima ( axes in heliocentric arc seconds).,width=642 ]    the algorithm is then applied to rhessi observations of solare flares . a flare with rich temporal fine structures occurred on august 23 , 2002 , 06:25 ut ( figure [ demod_result ] )",
    "the energy band under consideration is 6 - 25 kev , and the mean observed count rate is 1700/s / subcollimator .",
    "the time bins are 9.78ms , so that there are @xmath10910 counts per time bin .",
    "the flare center is at ( 920,-160  ) ( figure [ demod_result]d - e ) .",
    "the time scale achievable in the demodulation is in the order of 0.1s , by the order - of - magnitude argument that for each ( temporal+spatial ) degree of freedom there should be some 100 photons . a first estimate on the true light curve is provided by the average @xmath103 over subcollimators 1,3,4 and time @xmath90=0.08s ( figure",
    "[ demod_result]a - b , dotted , shifted for better clarity ) .",
    "the demodulation ( solid line ) is obtained from all subcollimators except # 2 and # 5 , which are excluded because of high background ( # 2 ) ( smith et al . , 2003 ) , and a distinctly inferior likelihood ( # 5 )",
    "which is not fully understood at present .",
    "the decomposition into impulsive and gradual components ( eq . [ model ] ) removes data gaps , and also shows that the gradual component appears delayed ( figure [ demod_result]a , smooth curve ) .",
    "this seems consistent with a spatial change of the brightness distribution ( figure [ demod_result]d - e ) , suggesting the emergence of a gradual ( possibly thermal ) source at @xmath1(924,-155  ) .",
    "figure [ demod_result]c shows an example of observed counts ( crosses ) , together with the predicted poisson parameter ( gray line ) .",
    "the data gaps have zero counts .",
    "the correlation time of @xmath102 derived from the autocorrelation is @xmath104 = 0.163s ; the estimate ( eq . [ tau ] ) gives 0.164s .",
    "an important issue is the reliability of the demodulated fine structures .",
    "this can be tested by locally perturbing the maximum-@xmath81 solution @xmath102 until @xmath110 changes by a given amount ( eadie et al .",
    "1971 ) . adopting the conventional threshold @xmath111 = @xmath112",
    ", one obtains the error bars shown in figure [ demod_result]b .",
    "the average error is 1400 ct / s .",
    "large error bars are characteristic for times with data gaps in several subcollimators .",
    "let us finish this discussion with a last but important point .",
    "although the formalism of eq .",
    "( [ f ] ) allows for arbitrarily small count rates , there is no gain in temporal resolution if @xmath19 is made so small that only few ( or fractions of ) photons are contained in a time bin . at such low count rates , the poisson error is large , and eq .",
    "( [ f ] ) becomes dominated by the smoothness constraint .",
    "higher time resolution can only be achieved at higher count rates , or at the expense of statistical significance ( @xmath113 ) . as a conservative rule - of - thumb ,",
    "a few @xmath114 counts / s are needed to resolve 100 ms structures on the 5% level .",
    "it is not easy to beat this limit , not even for extremely transient and bright events , because their modulation is hard to estimate and dominates the poisson error .",
    "the author thanks g. hurford and r. schwartz for helpful discussions ."
  ],
  "abstract_text": [
    "<S> the reuven ramaty high energy spectroscopic solar imager ( rhessi ) uses the rotational modulation principle ( schnopper et al . , 1968 ) to observe temporally , spatially , and spectrally resolved hard x ray and gamma ray images of solar flares . in order to track the flare evolution on time scales that are commensurate with modulation </S>",
    "<S> , the observed count rates must be demodulated at the expense of spatial information . </S>",
    "<S> the present paper describes improvements of an earlier demodulation algorithm , which decomposes the observed light curves into intrinsic source variability and instrumental modulation . </S>"
  ]
}