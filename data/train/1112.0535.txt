{
  "article_text": [
    "the standard method of weighted least squares ( i.e. minimum @xmath0 , hereafter 2 ) model fitting is only equivalent to maximum likelihood estimation ( mle ) of the model parameters when the data to be fitted are normally ( gaussian ) distributed . as is well known , the distribution of @xmath4 averaged periodogram ordinates ( from a stationary , linear stochastic process ) follows a @xmath5 distribution with @xmath6 degrees of freedom ; as @xmath4 increases , the @xmath5 tends towards a normal distribution @xcite . in x - ray timing",
    "the most commonly used method to reach the so - called gaussian regime is bartlett s method @xcite : segment the original time series into @xmath4 non - overlapping segments , compute a periodogram for each segment , and average over all segments to produce a spectral estimate to be fitted @xcite .",
    "typically , one uses @xmath7 to produce approximately gaussian distributed averages @xcite .",
    "the drawbacks of this method are a loss of frequency resolution by a factor @xmath4 ( reducing the sensitivity for narrow feature detection ) and a suppression of the lowest frequencies .",
    "there is also a major drawback in the case of the analysis of high frequency quasi - periodic oscillations ( qpos ) , because their frequency varies rapidly with time , typically on timescales of seconds @xcite .",
    "since a khz qpo can be a relatively narrow feature ( fwhm @xmath8 hz ) , sub - hz frequency resolution of the pds ( equivalent to a segment duration of a few seconds ) is required to have the qpo profile properly sampled . in order to use 2  fitting",
    "one must average a large number of segments , @xmath4 , which then requires a total integration time exceeding hundreds , even thousands of seconds , depending of the strength of the qpo . on such timescale , the drift of the qpo frequency will smear out the qpo profile , leading to biases in the fitted qpo parameters , in particular the width . methods to minimize the contribution of the frequency drift to the fitted qpo width have been proposed , using for instance the centroid ( without fitting ) of the excess power , as a best guess for the qpo frequency @xcite .",
    "although optimized , those methods suffer from the fact that statistical fluctuations of the noise can be stronger than the qpo signal , hence biasing the qpo frequency determination , especially when @xmath4 is small .    in this paper",
    ", we apply the maximum likelihood method to fit spectral models of high frequency qpos in the non - gaussian regime . to our knowledge , this is the first time such a method is applied to the analysis of _ rxte _ pca data , although it was discussed early on by @xcite for the analysis of continuum pds recorded with _",
    "exosat_. such a method has been used already in a variety of applications , such as the modeling of solar oscillation spectra @xcite or fitting broad band pds from long _ xmm - newton _ observations of variable seyfert 1 galaxies @xcite . in section [ sec2 ] , we describe the maximum likelihood method .",
    "then in section [ sec3 ] , the reliability and robustness of the technique is demonstrated using simulations of synthetic pds .",
    "its superiority over 2  fitting is illustrated in the case of @xmath9 , and a comparison between the mle and the 2  fitting is also presented for typical @xmath4 values used in qpo analysis . in section [ sec4 ] , the method is applied to a small subset of the archival _ rxte _ data of the neutron star x - ray transient u , and the results of the mle are used to infer the intrinsic width of the qpo .",
    "for describing the method , we follow the formalism of @xcite .",
    "the periodogram of any linear stochastic process time series of length @xmath10 , denoted @xmath11 at fourier frequency @xmath12 ( with @xmath13 ) , is exponentially distributed about the true spectral density @xmath14 ( @xmath15 is also the expectation value at @xmath16 ) .",
    "@xmath17 ( see e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) . for simplicity , we assume even @xmath10 . as pointed out by @xcite ,",
    "this is valid only for fourier frequencies @xmath18 , as the power at the nyquist frequency ( @xmath19 ) follows a @xmath20 distribution with one degree of freedom ( unlike powers at the other frequencies which follow the @xmath21 distribution ) .    assuming a model @xmath22 , with parameters @xmath23 , the joint probability density of observing @xmath24 periodogram points @xmath25 , given the model values @xmath26",
    "( @xmath27 , ignoring the nyquist frequency ) is : @xmath28 where @xmath29 is the likelihood , a function of @xmath30 .",
    "this is sometimes known as the _ whittle _ likelihood .",
    "the @xmath31 distribution and hence the whittle likelihood are the asymptotic expressions but are usually extremely good approximations for the range of @xmath10 typically examined in these studies .",
    "maximizing the likelihood @xmath29 is equivalent to minimizing @xmath32 .",
    "@xmath33 is then : @xmath34    the above formula can in fact be generalized to the case of fitting the average of @xmath4 pds , as discussed in appendix a.    finding the model parameters that minimize @xmath33 yields the maximum likelihood estimates ( mles ) of the model parameter , @xmath35 @xcite .",
    "the minimization can be achieved with a standard numerical optimisation algorithm , such as _ powell _ or _",
    "amoeba _ ( e.g. * ? ? ?",
    "it is easy to show that if the spectral model is a constant , @xmath36 , then its mle , @xmath37 , can be found by minimising @xmath38 the solution is found where the derivative of @xmath33 against @xmath39 is null : @xmath40 the mle of the constant is simply the sample mean .",
    "confidence intervals can be computed from the so - called _ fisher matrix ( f ) _ , the expectation value of the hessian ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* and references therein ) .",
    "the error on @xmath41 is then computed as : @xmath42    the _ fisher matrix _ can be evaluated numerically .",
    "the confidence limits on the mles can also be calculated from @xmath43 in the same manner as the popular @xmath44 method @xcite , e.g. @xmath45 corresponds to the @xmath46% confidence limits on one parameter ( see discussion in * ? ? ?",
    "the fisher matrix method is fast but gives reliable confidence intervals only when the likelihood surface is gaussian ; the @xmath47 method is slower but gives reasonable confidence intervals even for non - gaussian likelihoods and can be used to search for local minima .",
    "we have verified through simulations and with real data that the errors computed by the two methods did not differ by more than a few % .",
    "one can also use standard tools of maximum likelihood analysis , such as the likelihood ratio test to test for additional free parameters in the model ( see * ? ? ?",
    "* ; * ? ? ?",
    "* for the conditions of use ) .",
    "unlike the @xmath48 method , the fit statistic used in the maximum likelihood ( i.e. @xmath33 ) does not provide an automatic goodness - of - fit test .",
    "however , as discussed in @xcite , useful diagnostic statistics can be constructed and calibrated using monte carlo simulations that are sensitive to data - model mismatch .",
    "the minimisation process can be made more robust against local minima by ( i ) repeating the optimisation from several ( random ) settings of the initial parameter estimates , and ( ii ) monitoring the @xmath47 values during the confidence interval calculations .",
    "non - negative parameters , like @xmath49 and @xmath50 can also be logarithmically transformed to improve the reliability of the numerical methods @xcite [ equation [ lorentzian ] below must then be rewritten with @xmath51 and @xmath52 . immediately after fitting , @xmath50 and @xmath49 can then be transformed back in linear space for further processing . with idl",
    ", we used the _ powell _ minimization routine , but checked that the downhill simplex method implemented in the _ amoeba _ routine gave exactly similar results .",
    "a completely independent set of codes , from the generation of pds to the mle , was also developed in r ( http://www.r-project.org/ ) on a different platform and yielded very similar and fully consistent results , with the idl ones .",
    "we now wish to test the reliability of the mle with simulated data containing a qpo of known and realistic parameters . for this , we need to define a model for the pds .",
    "this model is the sum of a constant @xmath39 ( to account for the poisson noise , i.e. equal to @xmath53 for leahy normalized pds , @xcite ) , plus a lorentzian with three parameters , the normalization @xmath50 , the width @xmath49 ( fwhm ) and the centroid frequency @xmath54 .",
    "@xmath55 ( where we have denoted the parameters @xmath56 ) .",
    "random time series are generated from the pds model by inverse fourier transforming the randomised data @xcite .",
    "the time series are then processed to produce pds of the required frequency resolution . as with the real data",
    ", the simulated time series should be much longer than the required pds integration time .",
    "this method includes the well known effect of the windowing - induced power leakage , e.g. narrow features are slightly broadened ( see e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ) ( see appendix b ) .",
    "this effect is quite significant for narrow features and short integration times , as shown in figure [ bv11r_f8 ] .",
    "the bias on the width of the qpo caused by leakage ( hereafter ) goes approximately like @xmath57 . beside this bias",
    ", we have checked that our simulations did not generate any biases on the other parameters , @xmath58 and @xmath39 .",
    "this was done by averaging the periodograms from a large number of simulations , as an approximation to the expectation of the periodogram ( appendix b ) , and fitted this ( using 2 or maximum likelihood ) to obtain the parameters of the expected periodogram . within errors ,",
    "the best fit parameters , denoted @xmath59 , @xmath60 and @xmath61 corrected for the leakage bias were consistent with the input values used for the simulations .      in order to test the reliability of the method",
    ", we generated and fitted a large number of random datasets and computed the bias on the mles as the difference between the sample mean of the mle estimates @xmath62 and the best fitted value of the average periodogram , such that for parameter @xmath63 , we have @xmath64 .",
    "alternatively , the bias can be estimated from the true value put in the simulations ( @xmath65 ) , so that we have @xmath66 . in this case",
    ", special care must be taken for computing the bias on @xmath49 , as the measured value must be corrected for the leakage bias ( ) , such that @xmath67 . in this paper , we have used the first method to compute the bias .",
    "the mles are asymptotically unbiased , but when estimated from a finite data set , some may be biased .",
    "this is a reason why the analysis of real data ( especially when attempting to fit low signal to noise ratio features ) should be compared with simulated data sets , as closely representative of the data as possible .",
    "however , as we will show below , some mles are unbiased , and for the biased ones , the bias can be made negligible ( i.e. much smaller than the scatter of the data ) , when the mle is applied to qpos that are reasonably well detected ( see discussion below for detection criteria ) .    as we are primarily interested in qpos of a few hz breadth , that can be detected and fitted on a few tens of seconds , we have generated periodograms with different integration times , corresponding to sub - hz frequency resolutions ( from @xmath68 to @xmath69 seconds , in step of 4 seconds ) . for each @xmath2 , 16384 pds ( 128 sets of 128 pds )",
    "were generated from light curves @xmath70 long , and fitted .",
    "a large number of simulations is required to give precise monte carlo estimates of the bias and variance of the mles .",
    "we have explored a wide range of model parameters , but here we have assumed @xmath71 hz , @xmath72 hz .",
    "@xmath73 corresponds to a qpo rms amplitude of about @xmath74% for a source count rate of @xmath75 counts / s .",
    "those parameters are consistent with the ones derived from the analysis of the u  data presented in section [ sec4 ] .",
    "one example of an mle for one single pds ( t=16 seconds ) is shown in figure [ bv11r_f1 ] . to increase speed , yet to enable a good determination of the poisson level , the fits were performed on a frequency range of @xmath76 hz on each side of the qpo peak . as can be seen , despite a very noisy periodogram , the maximum likelihood fitting picks up the qpo at the right frequency , with a @xmath77 uncertainty of only about 0.4 hz .    the results on the biases are shown in figure [ bv11r_f2 ] . as can be seen ,",
    "the biases on the fitted poisson level and on the qpo frequency are almost zero .",
    "there is a small remaining positive , but _",
    "negligible _ bias on @xmath50 and @xmath49 that decreases with increasing @xmath2 .",
    "the bias on @xmath50 and @xmath49 is much smaller than the typical @xmath77 of the estimates , e.g. by more than a factor of 10 for all @xmath2 , hence can only be measured using a very large number of pds , as is the case in our simulations ( @xmath78 ) .",
    "as expected , the biases on @xmath50 and @xmath49 are more severe when the signal - to - noise ratio of the qpo decreases ( e.g. for pds of a given @xmath2 for a qpo of smaller @xmath50 or for pds of shorter @xmath2 for a qpo at a given @xmath50 , see figure [ bv11r_f2 ] ) .",
    "@xcite considered a significant qpo detection when the ratio between the fitted @xmath50 and its @xmath77 error is larger than 3 or equivalently when the mean significance of the excess power fitted , with @xmath79 the mean of mw powers , @xmath80 is the poisson level ( close to 2 ) , m the number of averaged pds , w the number of frequency bins averaged , see @xcite .",
    "a scanning algorithm maximizes @xmath81 with respect to @xmath82 , allowing @xmath82 to vary within a plausible range , say 2 to 10 hz , for narrow qpos .",
    "] exceeds @xmath83 . in figure",
    "[ bv11r_f2 ] , both criteria are met , even for @xmath84 seconds , for which @xmath85 and @xmath86 .",
    "this means that , provided that @xmath2 is adjusted as to ensure that qpos are reasonably well detected ( i.e. one of the two criteria above is met ) , the mle will not introduce any significant biases on the estimates of the qpo parameters . for lower signal - to - noise ratio qpos , as stressed above , it is recommended to quantify the residual biases through simulations representative of the data set analyzed .",
    "the biases on the mles decrease with increasing @xmath2 , as shown in figure [ bv11r_f2 ] .",
    "we have extended the previous simulations to longer equivalent pds integration times , adopting a different , though consistent , approach .",
    "we have generated @xmath87 simulations of @xmath84 second pds ( @xmath4 varying from 4 to 64 ) .",
    "the range of @xmath4 considered correspond to pds integration times that are typical of the qpo analysis performed so far @xcite .",
    "the 4096 averages of the @xmath4 pds were fitted by maximum likelihood ( 32 different sets of @xmath88 pds ) , following appendix a. the biases were again computed as the difference between the sample mean of the 4096 mles and the sample mean of 32 mles derived from fitting the average @xmath88 pds , as an estimate of the mean qpo parameters over the entire @xmath89 pds simulated .",
    "the residual biases are shown in figure [ bv11r_f3 ] .",
    "first , to illustrate the equivalence of fitting the average of @xmath4 8 second pds and fitting one single pds of @xmath90 second integration time , it can be seen that the biases on @xmath91 ( about 0.2 - 0.3 % ) measured for @xmath9 ( @xmath84 seconds ) are fully consistent with the biases measured for @xmath92 and @xmath93 seconds ( see figure [ bv11r_f2 ] ) .",
    "second , as expected , all the biases converge smoothly to zero as @xmath4 increases .      we have fitted simulated data with the mle and 2  for comparison , using the 8 second pds generated for the bias analysis discussed above . for illustrative purpose ,",
    "the averages of @xmath9 pds were fitted by both techniques ( with the errors on each power @xmath25 set to @xmath94 for 2  fitting ) .",
    "we chose @xmath9 because it corresponds to a timescale ( 32 seconds ) on which the properties of khz qpos have been investigated previously ( e.g. * ? ? ? * for 4u1608 - 522 ) . to ensure a fair comparison of the mle and 2  methods",
    "the same starting values were used for minimisation .",
    "the histograms of the estimates of each of the four model parameters , as derived from the ensemble of fits for the two methods are shown in figure [ bv11r_f4 ] .",
    "the strongest biases in the 2  fitting clearly concern the poisson level and the qpo amplitude .",
    "this is explained by the fact that the 2  distribution is asymmetric , producing more data below than above the expected spectrum , and these low powers , which have smaller errors , drive the fitted parameters down .",
    "by contrast the qpo frequency estimates obtained by 2  fitting are not significantly biased but do show a larger spread ( i.e. larger uncertainty in the estimates ) than the corresponding mles ( the same applies to the qpo width ) .",
    "this shows the power of the mle over 2  when fitting a small number of pds .",
    "as can be seen from figure [ bv11r_f4 ] , there is quite a large bias in @xmath50 with 2  fitting , and this bias is important as @xmath50 gives the rms amplitude of the qpo , one of the qpo parameter that is often reported in the literature .",
    "it is interesting to see how it decreases when @xmath4 increases . in the limit of a large @xmath4",
    ", the results from 2  fitting should be unbiased and consistent with the ones derived from the mle .",
    "@xcite showed that for @xmath95 the powers of the pds are approximately normally distributed , hence 2  fitting can be used . using the same simulated data set",
    "as used to generate fig [ bv11r_f3 ] , i.e. @xmath96 pds , we show how the bias on @xmath50 varies with @xmath4 with the two fitting techniques ( see figure [ bv11r_f5 ] ) .",
    "as expected the bias decreases with increasing @xmath4 with 2  fitting .",
    "it is however interesting to note that for @xmath97 , the 2  fitting leads to a bias of about 2.5% .",
    "this bias is larger than the one derived from the mle when @xmath92 ! ( see figure [ bv11r_f2 ] for @xmath84 seconds ) . with the mle , the bias in the estimate of @xmath50 decreases with @xmath2 , and is negligible for all @xmath4 ( it is always below @xmath98% ) .",
    "this means that whenever , averaging a very large number of pds is not possible or desirable , mle fitting should be preferred against 2  fitting , especially if one is interested to measure the qpo amplitude as accurately as possible .",
    "u  is an x - ray transient and a prototypical high - frequency qpo source .",
    "the parameters of its high frequency qpos have already been reported @xcite .",
    "here we are interested in a subset of the data recorded by the pca onboard _ rxte _ on march 3rd , 1996 ( obsid 10072 - 05 - 01 - 00 ) .",
    "this obsid is split in three intervals . to produce the light curves , we have extracted all events in the detector channel range from 16 to 94 .",
    "the smoothed dynamical pds for the second interval of data is shown in figure [ bv11r_f6 ] .",
    "as can be seen from that figure , both the frequency and amplitude of the qpo do not vary much during those observations .",
    "the mle was applied by fitting one single periodogram of different integration times , down to 8 seconds .",
    "the results are shown in the right panel of figure [ bv11r_f6 ] for an integration time of 8 seconds .",
    "the mean significance of the excess power at the qpo frequency is about @xmath99 , and the mean ratio of @xmath100 , indicating that the mles on @xmath50 and @xmath49 are not biased by more than @xmath101% ( see figure [ bv11r_f2 ] for @xmath84 seconds ) .",
    "the qpo parameters are recovered for the first time on very short timescales , down to @xmath102 seconds from direct fitting .    in the left panel of figure [ bv11r_f7 ]",
    "we show the power spectrum of the frequency variations , using the estimates of the qpo frequency on a timescale of 16 seconds .",
    "a maximum likelihood fit of this power spectrum indicates that the frequency evolution is consistent with a simple random walk , as previously hypothesized @xcite .",
    "this power spectrum is adequately fitted by a simple model comprising a power law of index @xmath103 down to @xmath104 mhz , plus a constant that is consistent with that expected from the uncertainties on the frequency estimates .    under the random walk hypothesis",
    ", we expect the broadening of the qpo due to the variable frequency to increase with @xmath1 .",
    "we have fitted single pds with increasing @xmath2 and fitted the mles ( corrected from the leakage bias ) with a random walk model , assuming that the measured width for a given @xmath2 ( @xmath105 ) includes a contribution from the intrinsic qpo width @xmath106 and a contribution from the drift ( @xmath107 ) , such as @xmath108 , with @xmath109 . as can be seen from figure [ bv11r_f7 ] ,",
    "a good fit is obtained when @xmath2 varies from 8 to 60 seconds .",
    "this enables to recover the intrinsic qpo width ( in the limit of no frequency drift ) : @xmath110 hz . for a mean frequency of 829 hz over the interval",
    ", this corresponds to a quality factor @xmath111 . correcting for a positive residual mle ( @xmath53% ) bias ( see figure [ bv11r_f2 ] )",
    ", this value goes up to @xmath112 , not significantly different .",
    "the mean of the mles of @xmath49 ( @xmath113 hz ) measured for @xmath84 seconds ( see figure [ bv11r_f7 ] ) is in fact already close to the intrinsic qpo width derived with the method above , and could therefore be used to approximate a mean @xmath114 over a continuous observation ( e.g. an obsid in rxte terminology ) . on the other hand",
    ", one should not take the weighted mean of @xmath115 , as it underestimates the true width , due to the fact that smaller @xmath115 have smaller error bars ( see figure [ bv11r_f6 ] ) .",
    "similarly , as discussed in appendix c , shifting - and - adding pds to a reference frequency ( e.g. the mean frequency over an obsid ) , and fitting the resulting averaged and shifted pds leads also to a tiny negative bias on @xmath49 ( @xmath116 hz ) and hence a slight overestimate of @xmath114 .    to conclude , using a simple random walk model and the mle for different pds integration times , we have derived a @xmath114 factor of about 260 , significantly larger than the value of 200 reported previously @xcite .",
    "unless the qpo shows rapid frequency variability below 8 seconds , the above value is likely to be close to the intrinsic qpo width .",
    "the higher quality factor derived , implying a longer the lifetime for the underlying oscillator , puts even even more stringent constraints on qpo models , as discussed in @xcite .",
    "it also shows that the mle , by enabling the unbiased estimation of qpo parameters on the shortest timescales permitted by the statistical quality of the data provides a clear improvement over previous methods .",
    "more data will be analyzed to test the random walk hypothesis , to measure the maximum @xmath114 factor of khz qpos in neutron star systems , and to determine more accurately the dependency of the quality factor with frequency , in particular around the frequency , where @xmath114 drops very rapidly : a feature that has been interpreted as a possible signature of the approach to the innermost stable circular orbit @xcite .",
    "we have demonstrated the application of maximum likelihood fitting to periodogram data showing high frequency qpos . the method is simple to implement and , importantly , remains valid in the non - gaussian regime , e.g. when applied to raw periodogram data .",
    "this means it can be used in situations where averaging many periodograms is not desirable , e.g. when short time series are to be analysed at the highest frequency resolution .",
    "the simulation tests discussed in section @xmath117 show the method gives accurate and unbiased estimates of the qpo parameters , and can be used to probe qpo properties on timescales as short as @xmath102 seconds ( for strong khz qpos ) . by contrast",
    "the standard 2  fitting method gives biased parameters with larger uncertainties when applied to such short sections of data because the spectral estimates are not gaussian distributed .",
    "we have applied the mle to an _ rxte _ observation of the @xmath118 hz qpo of the neutron star low - mass x - ray binary u. for one section of the observation we are able to recover the qpo frequency , width and amplitude on timescales down to @xmath102 seconds .",
    "we have shown that the frequency variations are consistent with a random walk in the observation analyzed , and we have inferred the intrinsic width of the qpo to correspond to a quality factor of @xmath3 at 830 hz : a value significantly higher than previous estimates @xcite .",
    "of course , mle fitting of time - resolved periodograms is not the only approach available for investigating the variability of the khz qpos .",
    "another is to fit time - dependent models directly to the time - frequency data using hierarchical models @xcite .",
    "this is beyond the scope of this paper whose aim is to highlight the improvement ( in e.g. bias and variance of the fitted qpo parameters , and in some cases time resolution ) that can be gained by using whittle mle rather than the @xmath48 method that is currently the standard procedure .",
    "the method described here was applied for the first time to _ rxte _ data . by enabling to measure the qpo parameters on very short timescales with negligible biases",
    ", this technique opens the way for new types of analysis to be performed on _ rxte _ archive , as we have shown in the case of u  for a limited subset of data . in most analysis",
    "so far , the qpo properties have been derived from averaging data sets , hence leading to a potential loss of information .",
    "the mle does not require averaging .",
    "hopefully , this will lead to a better understanding of the high frequency variability observed in accreting compact objects , both neutron stars and black holes .",
    "this is required to fully exploit the potential of this variability as a probe of strong gravity and dense matter @xcite .",
    "the periodogram is scattered around its expectation following a @xmath119 distribution . by averaging @xmath4 periodograms",
    "we find the average follows a @xmath120 distribution . from the properties of the chi - square distribution it is straightforward to derive the log likelihood formula in this more general case ( see also * ? ? ?",
    "* ) : @xmath121 where @xmath122 is the degrees of freedom of the relevant chi - square distribution , and @xmath123 is a constant for fixed @xmath124 ( not a function of @xmath25 or @xmath15 ) . in the case of no averaging ,",
    "i.e. @xmath92 ( @xmath125 ) , the above formula reduces to the usual log likelihood for the periodogram [ since @xmath126 .",
    "the above formula may be used for maximum likelihood fitting of averaged periodograms with any @xmath4 ; in the limit of very large @xmath4 this is equivalent to the usual 2  method .",
    "we have verified that fitting the average of @xmath4 pds gives very similar results compared to fitting simultaneously @xmath4 pds ( minimizing the sum of @xmath33 over @xmath4 ) ( see figures [ bv11r_f2 ] and [ bv11r_f3 ] ) .",
    "it is obviously as easy to implement , but runs much faster by a factor of @xmath127 .",
    "the errors on the mles can be computed the exact same way as in the case of @xmath92 , e.g. directly from the fisher matrix ( see section [ sec2 ] ) .",
    "the expectation value of the periodogram at fourier frequency @xmath16 is @xmath128 = \\int_{-f_n}^{+f_n } f(f_j - f^{\\prime } ) s(f^{\\prime } ) df^{\\prime } = s(f ) - b_i(f)\\ ] ] where @xmath129 is the true spectral density function , @xmath130 is the fejer kernel , and @xmath131 is the nyquist frequency .",
    "the convolution by the fejer kernel distorts the periodogram away from the true spectrum , and results from the finite sampling of the time series ( see e.g. brillinger 1975 , chapter 5 ; priestley 1981 , chapter 6 ) .",
    "the expected difference between the true spectrum and the periodogram is the bias on the periodogram : @xmath132 $ ] .",
    "the fejer kernel depends on the time series duration , @xmath2 , and has a main lobe of width @xmath133 plus oscillatory side - lobes that decay as @xmath134 either side .",
    "it is these side - lobes that cause spectral leakage  the transfer of power between distant fourier frequencies . assuming a lorentzian spectrum @xmath129 , typical of khz qpos",
    ", we can compute the effect of leakage by perfoming the above convolution numerically ( on a fine grid of frequencies , @xmath135 ) . for well - resolved qpos ( i.e. @xmath136 ) the convolved spectrum ,",
    "i.e. the expectation of the periodogram , is very like a lorentzian but with slightly larger width @xmath137 .",
    "the bias on @xmath49 due to leakage , @xmath138 , is itself a function of @xmath2 .",
    "the convolution conserves the total power ( integral under the curve ) and so leakage does not directly bias @xmath50",
    ". however , a very small bias on @xmath50 , almost always negligible , may be introduced by fitting a simple lorentzian model to the distorted qpo profile , which can deviate slightly from a pure lorentzian .",
    "figure [ bv11r_f8 ] shows this broadening effect ,   as a function of time series duration @xmath2 , based on numerical calculation of the fejer convolution . for longer time series",
    "the fejer kernel becomes more concentrated and distorts the spectrum less , leading to smaller . for @xmath139",
    "s the bias is @xmath140 hz , within the precision of some estimates of qpo widths , whereas for @xmath2 longer than @xmath141 s the bias is so small as to be practically insignificant .",
    "the so - called `` shift and add '' technique , as introduced by @xcite , has been used extensively to study the power spectral properties of khz qpos .",
    "the method involves computing pds estimates on short timescales ( e.g. @xmath142s ) , fitting for the qpo frequency , and using the best - fitting frequency to shift the frequency scale of each spectrum to one in which the qpo frequency is constant .",
    "this method can improve sensitivity to qpos with rapidly variable frequencies that would get washed out in a straight average of the short timescale pds estimates .    in the ideal case of the qpo frequency being known with zero error , the averaged spectrum will be broadened slightly by leakage due to the finite length of the time series intervals used to compute the short timescale pds estimates ( as discussed above and in appendix b ) .",
    "but the method of shifting using fitted frequencies introduces another tiny bias to the estimation of qpo width .",
    "the fitted frequencies ( that determine the shifts to be applied ) for each interval are scattered around the true frequency without bias , but are closer to the centre of mass of each randomly sampled qpo spectrum than is the true frequency . on some occasions",
    "there will be more power above or below the true qpo frequency and these will contribute towards the profile of the qpo in the averaged spectrum .",
    "but if the data are shifted to reduce the spread of power around the fitted qpo location , this must result in less power in the tails and more power in the centre of the averaged qpo profile - i.e. a bias towards narrower qpos in the average made using the shift and add technique . to estimate the magnitude of the bias introduced by",
    "the shift - and - add , we used the fitted frequencies of the simulated data set generated above ( i.e. taking 128 sets of 128 pds with an integration time @xmath2 of 16 seconds ) .",
    "for each set , we have fitted the average pds and the shifted - and - added pds using 2  fitting .",
    "the estimates of @xmath50 , @xmath54 and @xmath39 are consistent between the two sets of fits ( straight average and shift - and - average ) , but the qpo width derived from the shifted - and - added pds is significantly smaller than the one derived from the non - shifted averaged pds by about @xmath143 hz .",
    "this is the reason why we should use the sample mean of the estimates of @xmath115 to estimate the mean quality factor ( section [ sec4 ] )",
    ". the shift - and - add bias decreases with @xmath2 because the error on the fitted frequency decreases to zero : the width bias is less than @xmath144 hz for @xmath145 seconds .                                                                , m. 1989 , timing neutron stars : proceedings of the nato advanced study institute on timing neutron stars held april 4 - 15 , 1988 , in cesme , izmir , turkey .",
    "edited by h. ogelman and e. p. j. van den heuvel .",
    "isbn : 0 - 7923 - 0101 - 3 . published by published by kluwer academic / plenum publishers , new york , ny usa , 1989 , p.27 van der klis , m.  2000 , , 38 , 717"
  ],
  "abstract_text": [
    "<S> high frequency quasi - periodic oscillations ( qpos ) from weakly magnetized neutron stars display rapid frequency variability ( second timescales ) and high coherence with quality factors up to at least 200 at frequencies about 800 - 850 hz . </S>",
    "<S> their parameters have been estimated so far from standard 2  fitting techniques , after combining a large number of power density spectra ( pds ) , as to have the powers normally distributed ( the so - called gaussian regime ) . before combining pds , different methods to minimize the effects of the frequency drift to the estimates of the qpo parameters have been proposed , but none of them relied on fitting the individual pds . accounting for the statistical properties of pds , we apply a maximum likelihood method to derive the qpo parameters in the non gaussian regime . </S>",
    "<S> the method presented is general , easy to implement and can be applied to fitting individual pds , several pds simultaneously or their average , and is obviously not specific to the analysis of khz qpo data . </S>",
    "<S> it applies to the analysis of any pds optimized in frequency resolution and for low frequency variability or pds containing features whose parameters vary on short timescales , as is the case for khz qpos . </S>",
    "<S> it is equivalent to the standard @xmath0 minimization fitting when the number of pds fitted is large . </S>",
    "<S> the accuracy , reliability and superiority of the method is demonstrated with simulations of synthetic pds , containing lorentzian qpos of known parameters . </S>",
    "<S> accounting for the broadening of the qpo profile , due to the leakage of power inherent to windowed fourier transforms , the maximum likelihood estimates of the qpo parameters are asymptotically unbiased , and have negligible bias when the qpo is reasonably well detected . by contrast , we show that the standard 2  fitting method gives biased parameters with larger uncertainties .    the maximum likelihood fitting method is applied to a subset of archival rossi x - ray timing explorer ( rxte ) data of the neutron star x - ray binary u , for which , we show that the lower khz qpo parameters can be measured on timescales as short as 8 seconds . as to demonstrate the potential use of the results of the maximum likelihood method , we show that in the observation analyzed the time evolution of the frequency is consistent with a random walk . </S>",
    "<S> we then show that the broadening of the qpo due to the frequency drift scales as @xmath1 , as expected from a random walk ( @xmath2 is the integration time of the pds ) . </S>",
    "<S> this enables us to estimate the intrinsic quality factor of the qpo to be @xmath3 , whereas previous analysis indicated a maximum value around 200 . </S>"
  ]
}