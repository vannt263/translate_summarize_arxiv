{
  "article_text": [
    "stratified and/or rotating fluids are ubiquitous in geophysical and astrophysical hydrodynamics .",
    "such fluids support internal and/or inertial waves which have many common properties due to the similarity of their dispersion relations : typical occurrences of these waves are oblique beams that propagate at an angle with respect to the horizontal controlled by the ratio of the forcing frequency to the natural frequency of the system , the latter being set by the combined balances of restoring ( buoyancy and/or coriolis ) force and inertia .",
    "the anisotropic dispersion relation requires the preservation of the angle of the wave beam to the horizontal upon reflection at a rigid boundary . in the case of a sloping boundary",
    ", this property gives a geometric reason for the strong variation of the beam width ( focussing or defocussing ) upon reflection . in the limit of a vanishingly small beam width",
    ", the wave reflection in confined domains can be studied by ray tracing which shows that focussing prevails . a typical generic case is represented by wave rays converging to a closed loop , the wave attractor .",
    "a detailed analysis shows that a confined domain of a specific geometry has a subset of global resonances ( similar to normal modes ) and a rich variety of wave attractors having different complexity and rates of convergence toward limit cycles  @xcite .",
    "internal wave attractors have been experimentally observed in the seminal paper by  @xcite for a benchmark geometric setting , a trapezoidal domain filled with a uniformly stratified fluid .",
    "the properties of internal wave attractors have been extensively studied  @xcite . in parallel ,",
    "a rich literature describes the properties of inertial wave attractors , considering a rotating spherical annulus as a generic model of homogeneous liquid shells of celestial bodies  @xcite , and also simpler geometrical settings of academic interest  @xcite .",
    "inertia - gravity waves in rotating stratified fluids contained in spherical shells have also been considered  @xcite .",
    "in addition to the above - mentioned two - dimensional ( plane or axisymmetric ) settings , fully three - dimensional geometries have been considered theoretically  @xcite , numerically @xcite and experimentally  @xcite .",
    "the major part of the cited literature is focussed on the theoretical analysis of wave attractors , assuming linearized equations of motion and a simple harmonic time - dependence . in the inviscid limit",
    ", the theory explores the structure of singular and regular solutions of the wave equation ( in spatial coordinates ) in a confined domain , what is known to be generally an ill - posed problem : see e.g.  @xcite .",
    "the inclusion of viscosity regularizes the problem , replacing attractors singularities by shear layers of finite width , which can be computed numerically  @xcite .",
    "the competition between geometric focussing and diffusive viscous broadening provides a physically clear mechanism for setting the final width of the branches of wave attractors , at least in linear problems  @xcite .",
    "other dissipative mechanisms can be involved , which might be modeled by considering a relevant eddy viscosity , triadic resonance instability accompanied with energy flux to waves with shorter length scales , or magnetic damping in the case of conductive fluids  @xcite .",
    "remaining within the realm of the linearized approach , @xcite has shown that the asymptotic dissipation rate in the system ( i.e. the value corresponding to the zero viscosity limit or , equivalently , a vanishingly small ekman number ) is , to the leading order , not sensitive to the replacement of viscous damping by a frictional damping force proportional to the velocity . however ,",
    "if a system is given a sufficiently large forcing , nonlinear effects become important , motivating experiments and direct numerical simulations of the fully nonlinear problem .",
    "the first numerical simulations of the corresponding navier - stokes equation have been performed in  @xcite and a subsequent study has been presented in  @xcite .",
    "it has shown that numerical results successfully reproduce the experimentally observed dynamics of wave beam formation  @xcite in terms of the overall flow pattern , width of the wave beams and shape of the wave number spectra during transient and steady regimes . @xcite",
    "have reported also a good qualitative agreement in terms of measured and computed stream functions , and have concluded that the good quantitative agreement for stable attractors is possible if the forcing in the numerical model is adjusted in such a way that the computed peak velocities coincide with the measured ones ( it relies on a forcing in 2d numerical simulation much lower than in the experiments . ) . regarding the computed non - linear effects ,",
    "@xcite have described the harmonic components corresponding to multiples ( double and triple ) of the forcing frequency .",
    "the presence of the second harmonic has also been experimentally detected in the data from  @xcite , and later re - analyzed in  @xcite .",
    "the stability of attractors for an injected energy of high amplitude remained largely unexplored until the experimental work by  @xcite , which has demonstrated that attractors are prone to triadic resonance instability note that the particular case for which both unstable secondary waves have a frequency equal to half of the forcing frequency is of particular interest in the oceanographic context where viscosity is negligible . in that case , the appropriate name is parametric subharmonic instability and abbreviated as psi . by abuse of language ,",
    "some authors have sometimes extended the use of the name psi to cases for which secondary waves are not corresponding to half of the forcing frequency .",
    "for the sake of terminological consistency , we propose to abbreviate triadic resonance instability in the rest of the paper using the new acronym : tri .",
    "the onset of the instability is similar to the scenario for wave beams in an unbounded domain  @xcite : in reality the finiteness of the beam width matters  @xcite .",
    "direct numerical two - dimensional simulations of inertial wave attractors in linear and nonlinear regimes have been performed in  @xcite for a model geometry represented by a tilted square . in the linear regime , the simulations reported very nicely confirm the linear analysis presented in  @xcite . in the nonlinear regime ,",
    "the instability is shown to transfer energy to short wavelengths where it is more efficiently dissipated by viscosity . owing to this mechanism , the saturation of the overall dissipation in the system occurs faster than in the linear regime .",
    "the scenario of instability observed in these numerical simulations  @xcite for inertial waves is qualitatively similar to the one described in  @xcite for internal waves . in the oceanographic context",
    ", observations have provided strong suggestions of the particular case of parametric subharmonic instability  @xcite .",
    "summing up the literature survey , we note that there are only few studies reporting direct numerical simulations of internal  ( @xcite ; @xcite ) and inertial  @xcite wave attractors . except in @xcite in a more oceanographic context , all these studies were performed in two - dimensional settings .",
    "@xcite use a trapezoidal geometry , with one horizontal boundary representing a free surface , and free - slip conditions at rigid boundaries of the fluid volume , except at the vertical wall , where barotropic forcing is applied in the form of a uniform horizontal flow of small amplitude oscillating at a chosen forcing frequency .",
    "the implementation of free - slip conditions avoid resolving viscous boundary layers .",
    "@xcite use a similar geometrical setup but forced the system via a progressive first - mode internal wave . in both cases ,",
    "@xcite and  @xcite take advantage of the two - dimensional version of mitgcm , the general circulation model developed by  @xcite based on finite volume method .",
    "the prandtl - schmidt number ( the ratio of the fluid viscosity to the salt diffusivity ) was taken equal to 100 in  @xcite and 770 in  @xcite . in their study of inertial waves ,",
    "@xcite use a different geometry : a tilted square .",
    "they carried out direct numerical simulations using a two - dimensional version of the 3d spectral code snoopy  @xcite .",
    "no - slip boundary conditions are imposed via a fictitious absorbing layer outside the fluid domain where the velocity components are forced to vanish , ensuring the global energy conservation with an accuracy of a few per cent .    to our knowledge ,",
    "there have been no attempts of 3d simulations for direct comparison with experimentally generated attractors . in rectangular domains where normal modes are of primary interest",
    ", the dissipation at rigid walls ( boundary friction ) can dominate the dissipation in the bulk by a factor of one hundred @xcite .",
    "the importance of boundary friction for triadic resonance instability in the case of normal modes in a rectangular domain has been already emphasized in  @xcite .",
    "his experimental results of the amplitude threshold for tri of normal modes are indeed in good agreement with theoretical predictions when the sum of a bulk - internal term and a boundary - layer term is taken into account in the calculated energy dissipation .",
    "moreover , he noticed that , on a laboratory scale , internal dissipation becomes comparable with wall dissipation only from a vertical modal number of order 10 . in the case of the normal modes , an analytical expression for the energy dissipation",
    "can be found and reveals that the bulk dissipation depends on the wavelength of the wave while the boundary dissipation is only related to the direction of the wavenumber vector .",
    "in contrast to normal modes , attractors are strongly dissipative structures which adapt their typical wavelength ( and , therefore , shear and associated dissipation rate ) to reach a global balance between the injected and the dissipated energy  @xcite .",
    "thus , the role of the dissipation at rigid boundaries as compared to the dissipation by shearing in the bulk of fluid is less clear for attractors than for normal modes .",
    "it is also not obvious to what extent 3d simulations are necessary to reproduce the experimental results quantitatively .",
    "the present paper aims at addressing these questions about dissipation and 3d effects by performing cross - comparisons of the available experimental data against the results of three - dimensional direct numerical simulations of internal wave attractors using a spectral element method based on the code nek5000  @xcite .",
    "the paper is organized as follows . in section 2",
    ", we describe the experimental and numerical setup . in section 3",
    ", we compare the results of three - dimensional computations with the experimental data in the linear and nonlinear regimes .",
    "in particular , in the nonlinear regime , we apply to numerical results the technique previously employed in  @xcite for analyzing triadic resonances . in section 4",
    ", we describe the wave structure in the transversal direction .",
    "using experiments and numerical simulations , we test the assumption of the bidimensionality of the flow and we examine the mean - flow generated by the wave attractor .",
    "we also estimate the error made in synthetic schlieren measurements due to the bidimensional flow assumption .",
    "finally , in section 5 , we present our conclusions .",
    "in the present work , we use the experimental results presented in  @xcite and also additional experimental data obtained with the experimental setup sketched in figure [ experimentalsetup](a ) .",
    "a cartesian coordinate system is introduced , with the horizontal @xmath0 and vertical @xmath1 axes located in the vertical midplane of the test tank .",
    "the @xmath2 axis is perpendicular to the @xmath3-plane and directed from the observer / camera towards the tank .",
    "the rectangular test tank of size @xmath4@xmath5 is filled with a salt - stratified fluid using the conventional double - bucket technique .",
    "the density distribution as a function of the vertical coordinate @xmath1 is measured prior and after experiments by a conductivity probe driven by a vertical traverse mechanism .",
    "the value of the buoyancy frequency @xmath6^{1/2}$ ] is inferred from the linear fit to the measured density profile .",
    "an example of such a profile is shown on figure  [ experimentalsetup](b ) .",
    "a sliding sloping wall , inclined at the angle @xmath7 , is carefully inserted into the fluid once the filling procedure is over .",
    "the sloping wall delimits a trapezoidal fluid domain of length  @xmath8 ( measured along the bottom ) and depth @xmath9 .",
    "the input forcing is introduced into the system by an internal wave generator  @xcite with the time - dependent vertical profile given by @xmath10 where @xmath11 and @xmath12 are the amplitude and frequency of oscillations , respectively .",
    "the profile is reproduced in discrete form by the motion of a stack of @xmath13 horizontal plates driven by the rotation of a vertical shaft .",
    "the stack of moving plates is confined between lateral walls of a vertical box - like support frame .",
    "each lateral wall of the frame is @xmath14  mm thick .",
    "therefore the inner size of the frame , @xmath15 , which coincides with the width of the moving plates , is @xmath16  mm smaller than the width of the tank @xmath17 .",
    "thus the forcing is applied to the stratified fluid with a width @xmath15 representing @xmath18 of the whole width @xmath17 .",
    "fluid motion is recorded by a computer - controlled video avt ( allied vision technologies ) stingray camera with ccd matrix of @xmath19 pixels or pike camera with ccd matrix of @xmath20 .",
    "the camera is placed at a distance between 1750 to @xmath21   from the test tank . given the relatively small size of the working section ,",
    "no correction for the parallax errors is applied .",
    "two methods are used to measure the parameters of the fluid motion .",
    "the perturbations of the density gradient are measured with synthetic schlieren technique  @xcite from apparent distortions of a background random dot pattern observed through the stratified fluid . in some cases ,",
    "standard piv technique has alternatively been used for velocity measurements .",
    "the fluid is seeded with light - reflecting particles of typical size @xmath22 m and density @xmath23  kg / m@xmath5 .",
    "the sedimentation velocity of particles is found to be sufficiently low .",
    "its effect on the results of velocity measurements is negligibly small .",
    "the test section is illuminated by a vertical laser sheet coming through the transparent side or bottom of the test tank .",
    "the spanwise position of the sheet could be varied to assess three - dimensional effects .",
    "for the synthetic schlieren technique , the camera takes @xmath24 frames per second . for the piv measurements , the camera operates in two - frame burst mode with an interval between the pair of images within a burst set to @xmath25  s and a global burst cycle period of @xmath26  s. conversion of images into velocity fields",
    "is performed using a cross - correlation piv algorithm with subpixel resolution  @xcite .",
    "thus with @xmath24 velocity fields per second , i.e typically around @xmath27 fields per wave period , we can resolve the significant frequency components of the signal . besides , the spatial resolution for the velocity field is about 3 mm in each direction and is found sufficient to resolve fine details of the wave field .",
    "the numerical simulation of wave attractors faces two major challenges .",
    "first , the fluid motion is highly nonlinear , and accounting for nonlinear interactions is crucial for the dynamics , even for weak interactions .",
    "second , the schmidt number ( @xmath28 ) , defined as the ratio of water kinematic viscosity and salt diffusivity , is close to 700 in a salt - stratified fluid .",
    "so the spatial scale of the density perturbations can be much smaller than the scale of the velocity perturbations and more demanding in terms of spatial resolution .",
    "the scale under which no scalar gradient remains because of diffusion effect is very small and smaller than the usual kolmogorov scale @xmath29 used as a mesh criterion for direct simulations where @xmath30 with @xmath8 the integral scale and re the large scale reynolds number . strictly speaking , this small scale where scalar diffusion takes place",
    "can be estimated with the batchelor scale @xmath31  @xcite .    the first numerical simulation of the formation of internal wave attractors  @xcite used finite volume method , one of the most popular state - of - the - art tools in computational fluid dynamics .",
    "however , as noted by these authors , the numerical simulation could only reproduce the dynamics of the attractors for schmidt number less than 100 .",
    "in addition , the discretization of convective terms produces a numerical viscosity , which acts similarly to a real viscosity .",
    "this numerical artefact blurs the fine - scale structures arising due to the high value of the schmidt number and it may also introduce substantial errors in calculations of the long - term dynamics of attractors ( at time scales of tens or hundreds of periods ) .",
    "however , for the current study , the long time intervals are precisely of particular interest to study the growth , saturation and cascades of secondary instabilities .    as an alternative , the galerkin method represents a highly efficient approach to tackle the nonlinear interactions if a full system of basis functions subject to boundary conditions can be used .",
    "a pseudospectral approach offers an efficient realization of the galerkin method . in @xcite",
    ", this approach has been used to study nonlinear interactions in attractors of inertial waves . in the present work",
    "we have chosen the method of spectral elements which combines the accuracy and high resolution of spectral methods with geometric flexibility of finite element methods , and what is particularly suitable for simulation of long - term evolution of fine - scale flows in globally forced geophysical systems  @xcite .",
    "the computational domain is divided into a finite number of quadrilateral ( in 2d ) or hexahedral ( in 3d ) elements and a galerkin approach is applied to each element . for the numerical realization , we use the open code nek5000 , developed by paul fischer and colleagues  @xcite . in each element",
    ", the lagrange polynomial decomposition is used and applied at gauss - lobatto - legendre points for the sake of stability ( to avoid ill - conditioning ) .",
    "the full resulting mesh , consisting of the elements and the gauss - lobatto - legendre points , is highly nonuniform , adding a bit more complexity in post - processing data treatment .",
    "however , the efficiency of the code fully justifies such a nuisance . in other words ,",
    "the approach used weighted residual techniques employing tensor - product polynomial bases . besides other benefits",
    ", it allows  analytical \" computation of the derivatives through matrix - matrix products or matrix - matrix - based evaluation @xmath32 @xmath33 in which @xmath34 represents any of the unknown variables , for instance , velocity components , density , etc .",
    "@xmath35 is a lagrangian interpolant through the gauss - lobatto - legendre points .",
    "the implementation of a high - order filter in nek5000 allows to stabilize the method for convection - dominated flows  @xcite .",
    "the time advancement is based on second - order semi - implicit operator splitting methods and stable backward - difference scheme .",
    "the additive overlapping schwarz method is used as a pre - conditioner  @xcite .",
    "the most difficult regions from a computational viewpoint are located in the vicinity of the rigid walls since , in these regions , intense folding of high - gradient density layers may occur , especially in the case of a high - amplitude wave motion .",
    "for this reason , a nonuniform element mesh in the near - wall regions is preferable for simulations of the nonlinear dynamics of wave attractors .",
    "typically , we have used meshes with up to 0.5 million elements , with eighth to tenth order polynomial decomposition within each element .    the full system of equations",
    "being solved consists of the navier - stokes equation in the boussinesq approximation @xmath36 the continuity equation @xmath37 and the equation for the transport of salt @xmath38 where @xmath39 is the density of solution with the constant minimal reference salinity , @xmath40 the density perturbation in a unit volume due to local salinity ( the full density is @xmath41 ) , @xmath42 the dynamical viscosity and @xmath43 the diffusivity of salt .",
    "dynamical viscosity and diffusivity are assumed to be constant .",
    "we impose no - slip boundary conditions on the rigid surfaces and stress - free condition on the upper surface .",
    "the boundary conditions on @xmath40 are isolation : @xmath44 where @xmath45 is the normal to the wall . forcing is applied at the vertical wall by prescribing the profile of the horizontal velocity which reproduces the motion of the generator  ( [ generator - profile ] ) in the vertical direction and takes into account the difference between the width of the generator @xmath15 and the width of the tank @xmath17 .",
    "the transverse profile of the forcing is prescribed by stepwise or piece - wise linear function . at the central segment of the width @xmath15 ,",
    "the horizontal velocity is uniformly distributed in the transverse direction in both cases . at the side segments of width @xmath46 ,",
    "we prescribe either i ) zero velocity or ii ) a linear decrease of the velocity from the uniform value to zero .",
    "these two versions of transverse profiles of forcing give essentially the same results , with a small quantitative difference in the second version where forcing gives a higher horizontal impulse to the system .",
    "both versions can be implemented in calculations , but the second version of the forcing is found to be much less expensive computationally and the major part of computations was performed with it .",
    "the efficiency of the generator used in experiments is not 100% .",
    "for this reason , the amplitude of forcing in computations with the piecewise linear case is intentionally reduced by 10% compared to the experimental value , thereby providing a good match between numerical and experimental results .",
    "the comparison between numerical and experimental results is typically complicated by the presence of a thin mixed layer close to the free surface of the stratified fluid in the test tank . because of this layer , the internal wave beam is not reflected precisely at the free surface .",
    "instead the wave beam undergoes a complex reflection , partially at the interface between the mixed layer and the linearly stratified fluid and partially at the free surface .",
    "this complex reflection affects the shape of the attractor  @xcite and the shape of envelopes of wave motions in the wave beams . to take this layer into account in the numerical model",
    ", we introduce a model density distribution where the full depth is denoted @xmath9 as in experiments , the thickness of the thin mixed upper layer is @xmath47 , and the depth of the linearly stratified fluid is @xmath48 .",
    "as already mentioned in the introduction , the dynamics of stable attractors has been studied in great detail before , both in stratified and rotating fluids .",
    "it is well established that the typical thickness of the attractor scales as @xmath49 power of the ekman / inverse stokes number in rotating / stratified fluid  @xcite .",
    "the evolution of the spatial wave spectrum during the transient regime after the start - up of the oscillations toward an equilibrium shape is also well - known  @xcite .",
    "this dynamics is well reproduced in our calculations be they 2d or 3d . in addition , we observe a very good quantitative agreement in our 3d simulations once we introduce a small correction for non - perfect efficiency of the wave generator .",
    "typical snapshots of the computed and measured fields of the horizontal density gradient @xmath50 are shown in figure  [ comparisonstablecase ] , emphasizing a very good qualitative and quantitative agreement between the numerical and experimental data .",
    "this good agreement is further confirmed with the time - series of the horizontal density gradient at a point located in the most energetic branch of the attractor as illustrated in figure  [ comparisonstablecase ] .",
    "note that the numerical value of the density gradient is computed at the vertical mid - plane @xmath51 of the test tank . with this comparison",
    ", we tacitly assume that the flow is approximately two - dimensional and the standard schlieren technique is applicable  @xcite .",
    "the effects of three - dimensionality are discussed further in the next section .      as the amplitude of oscillations of the wave generator increases , the attractor becomes unstable . in what follows ,",
    "we describe the comparison of the experimental and numerical results for the onset of the triadic resonance instability .",
    "2d simulations were also performed and found to predict the instability to occur at the forcing amplitudes roughly two times smaller than the experimental ones .",
    "this is due to the absence of lateral walls in the 2d simulations .",
    "these walls introduce a significative dissipation in 3d simulations , as demonstrated in subsection  [ section : dissipation ] . in view of this quantitative discrepancy between 2d and 3d simulations , in what follows we use the results of 3d calculations for comparison with the experiments .",
    "the experimental and numerical snapshots of the horizontal density gradient field are presented in figure  [ comparisonunstablecase ] .",
    "the development of tri is clearly seen in the most energetic branch of the attractor .",
    "a very good quantitative and qualitative agreement is again observed between the experimental and numerical wave fields . the experimental and numerical time - series at a point in the most energetic branch of the attractor show also an excellent correspondence .",
    "let us now focus on the development of the instability in more detail to see if computations reproduce the experimentally observed triads in temporal and spatial domains .",
    "we first consider the evolution of the instability in the temporal domain .",
    "the development of the frequency spectrum of wave motion over time is presented in figure [ timefrequency ] .",
    "the time - frequency diagrams are calculated from numerical and experimental data for points as in @xcite , with the formula @xmath52 where @xmath53 is an hamming window and @xmath54 the component of the velocity field along @xmath0 or @xmath1 , i.e. @xmath55 or @xmath56 .",
    "the calculations are performed with the matlab toolbox described in @xcite .",
    "the appropriate choice of the length of the hamming window allows to tune the resolution in space and time .",
    "the experimental and numerical spectra are averaged over the analyzing area shown in figure  [ comparisonunstablecase ] .",
    "it can be seen that the numerical and experimental spectra agree qualitatively and quantitatively .",
    "the signal is initially entirely dominated by the forcing frequency @xmath57 ( in which @xmath58 is the non - dimensional frequency of oscillation ) : it corresponds precisely to the primary ( carrier ) wave .",
    "then oscillations with frequencies @xmath59 and @xmath60 , which correspond to two secondary waves generated by tri , slowly develop with time . at @xmath61 ,",
    "these frequencies are @xmath62 and @xmath63 .",
    "they satisfy the frequency conditions for the triadic resonance @xmath64 in addition , one can see also two peaks @xmath65 and @xmath66 satisfying differential conditions @xmath67    to verify the fulfillment of the condition for triadic resonance in space , we apply the hilbert transform technique  @xcite to the numerically simulated data in the same way as it is done in experiments  @xcite : the experimental signal is demodulated with the fourier transform , filtered around the three frequencies of interest , @xmath68 , @xmath59 and @xmath60 , and reconstructed back in real space using the inverse fourier transform . as shown in figure  5 of @xcite ,",
    "it is possible to compute amplitude and phase of each component .",
    "the latter appear as patterns of stripes , corresponding to a fixed moment of time .",
    "the wave vectors can be derived by differentiating these phases along the @xmath0 and @xmath1 directions .    to quantify the wave vectors involved into the triadic resonance in the numerical data , we construct probability density functions ( pdf ) for the components of wave vectors . using these pdf for the components of the wave vector corresponding to the primary wave oscillating at @xmath68",
    ", we can estimate @xmath69 @xmath70 .",
    "the same procedure for the secondary wave oscillating at @xmath60 gives @xmath71 @xmath70 .",
    "the phase pattern is slightly more complicated for the component oscillating at @xmath59 as can be noticed in figure  5 of @xcite where lines of equal phase for this frequency are not completely straight and there is a larger error bar on the measurement of the wave vector .",
    "numerically , it is possible to investigate further in the focusing branch of the attractor thanks to the pdf analysis : one realizes that there are two families of collinear wave vectors , which yield multi - peaked pdf of the wave vector components , where the main peak corresponds to @xmath72 @xmath70 .",
    "these values of the wave vector components closely match the spatial condition of the triadic resonance .",
    "the physical interpretation of the other peaks present in the pdf of the wave vector components for the wave field filtered at @xmath59 is unclear .",
    "the triangles of the wave vectors obtained in experiments and simulations are shown in figure  [ triad ] .",
    "again , we observe a good quantitative agreement between the experimental and numerical results .",
    "we now consider the wave attractor in the whole domain and investigate its structure in the transversal direction .",
    "an overall idea of the importance of three - dimensional effects in wave attractors can be indeed drawn from figure  [ threedimensionaleffect ] which represents an isosurface of the norm of the velocity vector for a 3d simulation at the onset of the instability .",
    "we can see the same features as in the vertical @xmath51 plane view in figure [ comparisonunstablecase ] with the loop of the attractor and the secondary perturbations .",
    "however , the iso - surface of the velocity norm is not flat in the transversal direction as the fronts of the perturbations are visibly curved especially on the two top s - shape features in the focusing branch near the slope .",
    "also , close to lateral walls , in particular in corner regions at the intersection of vertical walls , it is possible to see some three - dimensional structures .",
    "the inset of figure  [ threedimensionaleffect ] is a zoom on a region where the 3d - effects are particularly visible .      in @xcite",
    ", the experiments presented have been performed using the synthetic schlieren technique which assumes that the flow is bidimensional .",
    "indeed , in this technique , the image results from the integration of the field along the transverse direction and the ray of light is expected to cross the tank through always the same density perturbation .",
    "this assumption seems to be reasonable because the experimental set - up has been designed on purpose to ensure the two - dimensionality of the flow .",
    "indeed , the tank is narrow in the transverse @xmath2 direction and forcing is applied via the wave - maker through almost all the width of the tank so that the flow is expected to be two - dimensional , except very close to both vertical lateral walls where the viscosity plays an important role .    to check this assumption ,",
    "we use experimental standard piv technique for several vertical sections at different constant @xmath2 positions of the light sheet and thus compare flow properties between the different sections .",
    "experiments have been performed with @xmath8=435  , @xmath9=300 and @xmath74 , a geometry close to experiments performed in @xcite .",
    "different vertical sections in the transverse direction have been illuminated with a vertical laser sheet , coming from the bottom of the tank , which is transparent . a @xmath75 inclined mirror , located below and as long as the tank , transforms a horizontal laser sheet into a vertical one . by simply translating the mirror in the transverse direction",
    ", one can illuminate the different test sections .",
    "three series of experiments have been performed , each one with a different amplitude of the wave maker : @xmath76 , @xmath77 and @xmath78  mm . for each series , between @xmath79 to @xmath80 vertical sections",
    "have been illuminated by simply translating the mirror in the transverse direction .",
    "measurements have been carried out in the stationary state of the attractor .",
    "for the lowest amplitude experiment , there is no instability of the attractor : the wave maker was stopped only at the end of the full series , once all sections have been illuminated . for the two other series ,",
    "the instability takes place after a long transient : consequently , the wave maker has been stopped after performing measurements at each transversal location to avoid mixing effects that would modify the stratification and thus the attractor itself . for all series ,",
    "measurements in the central section of the tank were performed twice , once at the beginning , once at the end .",
    "this gives an estimate of the errors made on these measurements and also gives the possibility to check that , after a whole series , the attractor is really unchanged . to compare the different sections of the same series",
    ", we focused only on the most energetic branch of the attractor ( the one connecting the slope to the free surface ) .",
    "transversal profiles are extracted through this branch , always at the same location .",
    "as the horizontal and vertical velocities are measured , it is possible to calculate the velocity along this branch inclined at the angle @xmath81 using the formula @xmath82 .",
    "the maximum value corresponds to the center of the branch , @xmath83 , where @xmath84 is the coordinate transversal to the branch .    numerically , with 3d simulation , it is possible to get velocity profiles in the transverse @xmath2 direction .",
    "two 3d simulations have been performed , with exactly the same geometrical parameters as in @xcite , and with two different amplitudes of the wave maker : @xmath85 and @xmath86 mm .",
    "velocity profiles in the transverse @xmath2 direction were extracted from the most energetic branch and the velocity @xmath87 along this branch computed as for experiments .",
    "it is important to note that the transverse resolution is much higher in the numerical data ( @xmath88 points for @xmath89  ) than in the piv experimental ones ( between @xmath79 and @xmath80 points for the same @xmath89  ) .",
    "moreover , the different points obtained experimentally come from different individual experiments performed at the same input parameters but not from the same unique experiment .",
    "thus , it is difficult to synchronize the different points and we are limited to look at amplitudes of the filtered signals at @xmath90 , @xmath91 and @xmath92 .",
    "in contrast , various quantities can be examined numerically such as the raw signal , the whole signal filtered around @xmath90 , @xmath91 and @xmath92 and the mean flow generated by the attractor .",
    "different videos , available in the supplementary information , show these different fields .",
    "figure  [ transversalcut](a ) presents the different velocity profiles for the numerical simulation with @xmath85  mm . for this amplitude ,",
    "the attractor is stable .",
    "the raw velocity profiles for @xmath87 are , as expected , very close to the bidimensionality , except into the boundary layers where the velocity goes to zero . moreover",
    ", it appears clearly that the amplitude of the transverse velocity @xmath93 ( represented by a dashed line ) is much smaller than the velocity @xmath87 along the branch .",
    "this is a clear confirmation that the attractor generated by the wave maker is two - dimensional to a good approximation .",
    "the difference between the raw velocity magnitudes measured in positive and negative @xmath94 directions comes from the presence of slow near - wall secondary currents superposed with the fundamental monochromatic wave motion in the wave beams as discussed in more detail in  4.4 .    to extract only the component of the wave field oscillating at the fundamental frequency",
    ", one can do hilbert filtering on the raw profiles around @xmath90 over @xmath95 .",
    "the modulus of the velocity filtered for the numerical simulation with @xmath85  mm is shown with a thick dashed line in figure  [ transversalcut](b ) .",
    "as the raw profiles , it is also very close to bidimensionality . by looking to the real part of the filtered signal , one can be convinced that the profiles for @xmath87 are exactly the same for positive and negative values .",
    "hilbert transform allows us also to investigate the two - dimensionality of the tri . as the numerical simulation with @xmath85",
    "mm is stable , one can use the one with @xmath96  mm , which is unstable .",
    "figure  [ transversalcut](b ) shows the profiles along @xmath2 of the modules of @xmath87 filtered around @xmath90 ( thick solid line ) , @xmath91 ( thin solid line ) and @xmath92 ( thin dashed line ) for this simulation .",
    "these profiles appear to be nearly constant in the @xmath2 direction , except close to the edges .",
    "this ensures that the instability which develops in the tank is also bidimensional .    to compare the numerics and the experiments",
    ", we can superimpose the experimental and numerical @xmath87 profiles after hilbert filtering around @xmath90 for the different amplitudes of the wave maker .",
    "figure  [ transversalcut](c ) shows these different profiles : the solid blue line ( resp .",
    "diamonds ) corresponds to numerical ( resp .",
    "experimental ) data for @xmath85  mm ( resp .",
    "@xmath76  mm ) while the dashed red line ( resp .",
    "squares ) corresponds to numerical ( resp .",
    "experimental ) data for @xmath96  mm ( resp .",
    "@xmath97  mm ) .",
    "experimental points for @xmath98  mm are represented by black circles .",
    "all data are normalized by the velocity in @xmath99   to avoid divergences in amplitude due to the location of the point where is measured the velocity along the branch and small discrepancies in wave maker amplitude .",
    "all data show again a very good two - dimensionality . the loss of amplitude on the edges , before the boundary layers is less than @xmath100 .",
    "moreover , numerical and experimental data for @xmath85 and @xmath76  mm ( dashed blue line and diamonds ) show a good agreement between each other . for higher amplitudes @xmath96 and @xmath97  mm ( red line and squares ) , where the tri is developed ,",
    "the agreement is also very good . even for the experiment with @xmath98  mm , where tri is well developed , the shape of the experimentally measured transverse profile is in reasonable agreement with the simulation at @xmath96 mm .",
    "all numerical and experimental data collapsed in a reasonable way on a curve that ensures that all waves inside the tank are reasonably invariant in the transverse @xmath2-direction .",
    "we previously showed that the velocity field in the transverse direction for the wave attractor confirms the usual 2d approximation as a reasonable one .",
    "nevertheless , it turns out that a closer look on the profiles of @xmath87 reveals a discrepancy between profiles of the maximum ( max @xmath87 ) and the opposite of the minimum ( -min @xmath87 ) of the velocity  @xmath87 as illustrated in figure  [ transversalcut](a ) .",
    "indeed , the raw profiles for the attractor are not totally symmetric : when @xmath87 is positive ( thick solid line ) , even if the profile looks two - dimensional , there are some small peaks close to boundary layers which are not present in the profiles when @xmath87 is negative ( thin solid line ) .",
    "this symmetry breaking suggests the presence of a mean flow , always in the same direction , close to the boundary layers and which modifies the velocity profiles close to boundary layers . to verify this , we analyse now further the data and check for possible mean - flow generated within the tank . to extract this mean - flow from the raw data , we used hilbert filtering around @xmath101  rad / s .",
    "the numerical simulation specially run to thoroughly study the mean - flow has been performed with the same geometrical parameters as the one with the amplitude @xmath85  mm for section  [ profiles ] .",
    "the attractor is stable and is precisely located at the same position in the tank as in figure  [ comparisonstablecase ] . to limit the size of the data saved ,",
    "the three components of the velocities were recorded only for the two horizontal planes , @xmath102   and @xmath103  , with @xmath26  second time - steps . on theses planes , the velocities were saved on a mesh with a good resolution of @xmath104 points .",
    "rad / s applied on numerical data ) generated in the two different horizontal planes @xmath103   ( panel ( a ) ) and @xmath102   ( panel ( b ) ) .",
    "the color represents the vertical velocity component , @xmath105 , while arrows represent the horizontal velocity components , @xmath106 , with the arrow scale displayed at the right of the figure .",
    "the wave maker is located at @xmath107  , on the left of the figure , while the slope is indicated , on the right , by a vertical white line .",
    "the dashed rectangles delimit the regions where the attractor beams intersect with the planes located at @xmath103   ( panel a ) and @xmath102   ( panel b ) .",
    ", scaledwidth=85.0% ]    hilbert filtering at @xmath101  rad / s was applied on time - series of the three velocity components for each point of the @xmath0-@xmath2 plane .",
    "we consider the situation once the attractor reaches the steady state .",
    "figure  [ fig : meanflow ] shows the mean - flow in the two different horizontal planes , @xmath102   and @xmath103  .",
    "the color represents the vertical velocity component  @xmath105 , while arrows represent the horizontal velocity components , @xmath106 .",
    "the wave maker is located at @xmath107  , on the left of the figure .",
    "the slope is indicated , on the right , by a vertical white line .",
    "figure  [ comparisonstablecase ] shows the location of the attractor in the @xmath108  plane . at @xmath102  ,",
    "the attractor is reflecting on the slope while , at @xmath103  , it is reflecting on the wave maker .",
    "these are the two intense regions in figure  [ fig : meanflow ] , close to the slope at @xmath102   and close to the wave - maker at @xmath103  .",
    "as reflections occur in these regions , it can be difficult to extract conclusions for the mean - flow . nevertheless , it is still possible to examine the mean - flow in the regions where the attractor beams intersect with the planes located at @xmath103   and @xmath102  .",
    "these intersection regions are delimited by the dashed rectangles in figure  [ fig : meanflow ] .",
    "the flow in the branches of attractors shows a clear tridimensional behavior , with recirculation zones where the horizontal components of the velocity vectors are forming jet - like currents close to the vertical walls of the tank to compensate the mean flow in the central part of the wave beam .",
    "it is important to emphasize that the magnitude of the mean - flow is much smaller than the velocity of the fluid due to the waves . indeed , for this attractor , the typical amplitude of the velocity oscillations in the most energetic branch at the intersection with the plane @xmath103 is about @xmath109  /s while the typical velocities of the mean - flow are about @xmath110  /s , thus less than @xmath111 of the velocity due to the waves .",
    "( see definition in eq .",
    "[ defdissipationintegree ] ) , normalized by the total dissipation @xmath112 .",
    "panel ( a ) corresponds to the forcing amplitude @xmath85  mm , while panel ( b ) to @xmath113  mm .",
    "the solid blue line corresponds to a region located within the most energetic branch of the attractor , while the dashed black line corresponds to a region close to the center of the tank outside the attractor .",
    "the inset present the locally averaged dissipation @xmath114 ( in @xmath115s@xmath116 ) for both forcing amplitudes within the most energetic branch.,scaledwidth=85.0% ]    to further examine the three dimensionality of the flow , we determine the spatial distribution of the dissipation in the tank .",
    "we first compute the dissipation @xmath117 where @xmath118 is the kinematic viscosity while the strain rate tensor is defined as @xmath119 where @xmath120 and @xmath121 are respectively the components of the velocity field and of the position . then , for a given @xmath2-transversal coordinate , we average on a @xmath122 @xmath123 square to define the locally averaged dissipation @xmath124 which has also been averaged , after 42 periods after the start of the forcing , over three time periods . this quantity is shown as an inset in figure  [ fig : dissipation ] .",
    "however , as for example in @xcite , it is even more explicit to integrate this result horizontally along the transversal @xmath2-coordinate as follows @xmath125 in which @xmath17 is the total width of the tank .",
    "we plot in figure  [ fig : dissipation ] the horizontally integrated dissipation @xmath126 , normalized by the total dissipation @xmath112 within the parallelepiped 20 @xmath127 @xmath128 , in two different locations : one in the most energetic branch after the focusing onto the slope ( with the subscript @xmath11 for attractor ) , the second one around the center of the tank ( with the subscript @xmath129 for center ) and thus far from any branch of the attractor . for a weak forcing @xmath11=1.6 mm which leads to a stable attractor , one gets @xmath130 and @xmath131  @xmath115s@xmath116 . for a larger forcing @xmath113 mm leading to unstable regime , above values are typically multiplied by a factor 2 , since one gets @xmath132 and @xmath133  @xmath115s@xmath116 .    above figure  [ fig : dissipation ] emphasizes that , within the most energetic branch , the spatial distribution of the dissipation is only weakly changed while increasing the amplitude of the forcing , and therefore by passing from a stable to an unstable attractor .",
    "approximately 1/4 of the dissipation is located in the boundary layers , and the three remaining quarters are within the bulk of the flow .",
    "the dissipation outside the attractor is significantly altered by the amplitude of the forcing .",
    "this is presumably because tri has generated secondary waves which propagate , outside the attractor and more precisely toward the center of the tank .",
    "however , it is important not to overestimate this result since the total dissipation in the center of the tank is more than 100 times smaller than its counterpart within the most energetic branch of the attractor .",
    "it was of course expected , since this is where waves , and therefore energy , are trapped .",
    "moreover , figure  [ fig : dissipation ] reveals that , in the most energetic branch of the attractor , approximately 25% of the total dissipation occurs within the boundary layers which occupy less than 10% of the total width .      using the numerically computed density gradients in the transversal direction",
    ", we can provide an estimation of the error made on experimentally measured density gradients by assuming that the flow is bidimensional inside the tank .",
    "we use the simulation for @xmath96  mm as in section  [ profiles ] , by considering the density gradients instead of velocity fields .",
    "these data were available on a point located on the most energetic branch , for all @xmath2 .",
    "figure  [ fig : optic](a ) shows the time history of the horizontal density gradient in @xmath99  .",
    "tri occurs after @xmath134 in this simulation .",
    "@xcite have shown that the angle of deflection of a light ray crossing the tank in the @xmath135-direction is @xmath136 @xmath135 being @xmath0 or @xmath1 . here",
    "@xmath8 is the width of the tank and @xmath45 the optical index of water .",
    "the quantity @xmath137 is essentially constant and equal to @xmath138  kg / m@xmath139 .",
    "equation  ( [ alpha1 ] ) assumes that the flow is bidimensional and that the density gradients do not depend on the @xmath2-direction .",
    "this deflection induces displacement of the dots on the camera ccd from which we can measure the density gradients .    with the numerical simulations",
    ", one can proceed in the inverse way . knowing the density gradients and especially their dependence in @xmath2",
    ", one can compute the displacement that these gradients would have caused on a ccd camera placed at typical experimental distances . for density gradients depending slightly on @xmath2 ,",
    "one has to integrate over the width of the tank to get the deflection @xmath140    this integration assumes that the deflection of the ray is small in @xmath0 and @xmath1 directions , so the ray remains more or less at @xmath3 constant .",
    "that is why one can use only a line profile in @xmath2 for density gradients . in typical experimental conditions ,",
    "the ccd camera is placed at @xmath141  m of the tank and at @xmath142  m of the random dot pattern .",
    "the camera has a lens of @xmath143  mm .",
    "considering these experimental parameters , simple geometrical calculations then allows us to convert the angle deflection @xmath144 into the displacement on the camera @xmath145 .",
    "displacements are indicated on figures  [ fig : optic](b ) and  ( c ) by the red squares , before the onset of tri ( panel b ) and after the onset of tri ( panel c ) .",
    "the order of magnitude of these displacements is of few micrometers , while the pixel size of the two different cameras used are equal to @xmath146 and @xmath147  @xmath42 m .",
    "thus , the displacements are of few pixels and sufficient for data treatment .",
    "interestingly , one can also compute the displacements as if the flow was strictly bidimensional , by assuming that , once given @xmath3 , the density gradients in @xmath99 are the same for all @xmath2 in the tank .",
    "the deflection is thus as in equation  ( [ alpha1 ] ) .",
    "these displacements are indicated on figure  [ fig : optic](b ) and ( c ) by the blue circles , before the onset of tri ( panel b ) and after the onset of tri ( panel  c ) .",
    "the difference between blue circles and red squares is very small in both situations , before and after the onset of tri .",
    "this shows that the bidimensional assumption for the flow is robust and the error using it is very small .",
    "one can see on figure  [ fig : optic](b ) and ( c ) that the displacements of blue circles are a slightly larger than those for red squares .",
    "this shows that the density gradients in the center plane @xmath51 are slightly underestimated in the experimental measurements performed with the synthetic schlieren technique , typically by a factor of @xmath111 without tri and by a factor of @xmath148 with tri .",
    "this combined experimental - numerical check is a nice confirmation of the validity of the synthetic schlieren technique that justifies the comparisons performed in  3.1 and  3.2 of the present paper .     for the numerical simulation with @xmath96  mm .",
    "( b ) displacement of the dots on the ccd camera that the simulation would have caused if the density gradients have been measured using synthetic schlieren technique at @xmath149 , before the onset of tri .",
    "( c ) same as panel b ) after the onset of tri ( @xmath150 ) .",
    "the blue circles indicated the displacement caused if the flow is assumed to be @xmath24d , while the red squares show the displacement caused without this assumption .",
    "the displacements are plotted for two periods of the wave - attractor around the time indicated above the figures.,scaledwidth=80.0% ]",
    "in this paper , we present the comparison of the experimental and numerically simulated internal wave attractors in a trapezoidal domain filled with a linearly stratified fluid .",
    "three - dimensional versions of the spectral element code nek5000  @xcite have been used in the numerical simulations . as expected , in the linear regime",
    ", we recover the dynamics of the wave attractors , which is well described in the literature  @xcite .    in the nonlinear regime ,",
    "three - dimensional numerical simulations correctly reproduce the dynamics of the experimentally observed triadic resonance  @xcite in terms of spatial and temporal parameters of primary and secondary waves ( frequencies , wave numbers ) .",
    "the measurements of the fine parameters of the calculated internal wave patterns are performed by applying exactly the same technique as in experiments  @xcite , with a systematic use of the hilbert transform  @xcite .",
    "this yields very strong quantitative evidence that , both numerically and experimentally , we observe exactly the same scenario of triadic resonance .",
    "recent two - dimensional calculations of the nonlinear instability in rotating fluids  @xcite are qualitatively similar but less conclusive quantitatively due to the lack of comparison with the experimental data .",
    "three - dimensional numerical simulations give access to distribution of wave amplitudes across the test tank and the mean wave - induced currents .",
    "the numerically simulated distribution of wave amplitudes across the tank is in good agreement with the experimental data .",
    "the transversal distribution of the velocity field reveals interesting features : it typically has secondary maxima close to lateral walls of the test tank .",
    "these maxima are due to a mean - flow generated by the wave - attractor .",
    "the mean - flow is strong close to the boundary of the tank but the magnitude of the mean - flow velocity remains small in comparison with the amplitude of velocity oscillation in the wave beams .",
    "moreover , in the most energetic branch of the attractor , we have shown that approximately 25% of the total dissipation occurs within the boundary layers which occupy less than 10% of the total width .",
    "three - dimensional calculations allow us to estimate the error introduced in conventional synthetic schlieren technique which assumes two - dimensionality of the flow and considers spanwise integrated optical distorsions . for numerically generated density fields closely reproducing the experiment ones ,",
    "the error is found to be small , typically about 5% , thus validating the usual bidimensional assumption used in such experiments .",
    "the validation of three - dimensional spectral element code in a present nominally two - dimensional problem represents a necessary step for future exploration of fully 3d problems in the spirit of  @xcite , @xcite and @xcite , which can shed light on the occurrence of attractors in oceanographic problems .",
    "another line of attack for the future research is the exploration of long - term behaviour of internal wave attractors generating turbulence - like regimes , which have many similarities with the regimes observed in rotating systems  @xcite .",
    "finally , the question of energy budget in the system , in the spirit of  @xcite , is to address .",
    "this has to be done with emphasis on quantification of the mixing efficiency in a wide range of forcing ( linear and nonlinear regimes ) and in wide ranges of reynolds and schmidt numbers .",
    "the question of turbulent diffusivity , defined in  @xcite , is also very relevant .",
    "eve gratefully acknowledges his appointment as a marie curie incoming fellow at ens de lyon .",
    "we thank p. flandrin and s. joubaud for helpful discussions . this work has been partially supported by onlitur grant ( anr-2011-bs04 - 006 - 01 ) , by russian ministry of education ( rfmefi60714x0090 ) , rfbr ( 15 - 01 - 06363 ) and cfd web - laboratory unihub.ru .",
    "it has been achieved thanks to the resources of psmn from ens de lyon .",
    "most of numerical simulations were performed on supercomputer  lomonosov \" of moscow state university ."
  ],
  "abstract_text": [
    "<S> in the present paper , we combine numerical and experimental approaches to study the dynamics of stable and unstable internal wave attractors . </S>",
    "<S> the problem is considered in a classic trapezoidal setup filled with a uniformly stratified fluid . </S>",
    "<S> energy is injected into the system at global scale by the small - amplitude motion of a vertical wall . </S>",
    "<S> wave motion in the test tank is measured with the help of conventional synthetic schlieren and piv techniques . </S>",
    "<S> the numerical setup closely reproduces the experimental one in terms of geometry and the operational range of the reynolds and schmidt numbers . </S>",
    "<S> the spectral element method is used as a numerical tool to simulate the nonlinear dynamics of a viscous salt - stratified fluid . </S>",
    "<S> we show that the results of three - dimensional calculations are in excellent qualitative and quantitative agreement with the experimental data , including the spatial and temporal parameters of the secondary waves produced by triadic resonance instability . </S>",
    "<S> further , we explore experimentally and numerically the effect of lateral walls on secondary currents and spanwise distribution of velocity amplitudes in the wave beams . </S>",
    "<S> finally , we test the assumption of a bidimensional flow and estimate the error made in synthetic schlieren measurements due to this assumption . </S>"
  ]
}