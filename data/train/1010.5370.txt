{
  "article_text": [
    "there are many studies using a `` general circulation model '' ( gcm ) to investigate the flow and temperature structure of close - in extrasolar planet atmospheres ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "gcms are advanced numerical models that solve a set of coupled , nonlinear partial differential equations for the large - scale motions of a shallow fluid on a rotating sphere . in these sophisticated models ,",
    "numerous parameters are needed to specify the representation of heating and cooling in the atmosphere and to stabilize the numerical integration .",
    "thus far , not much emphasis has been given to the numerical aspects of simulations in the extrasolar planet literature , in particular their influence on the accuracy of the model results .",
    "in an earlier paper , @xcite has investigated the sensitivity of initial condition on the extrasolar planet atmosphere flows . in this work ,",
    "the focus is on another significant aspect ",
    "the subtle , and not so subtle , interplay between numerical and physical parameters .",
    "it should be noted that , while the discussion is basically numerical , this work is relevant to both theoretical studies and observations of extrasolar planets .",
    "gcms usually solve the hydrostatic primitive equations ( see , e.g. , * ? ? ?",
    "* ) , which filter sound waves so that only two important classes of waves remain  rossby , or planetary , waves ( which evolve on slow time scales ) and gravity waves ( which generally evolve on time scales much shorter than the rossby waves ) .",
    "the spatial scales of the two classes of motions are generally large and small , respectively .",
    "nonlinear advection , which has often been used to define a time scale in extrasolar planet work so far , has roughly the same time scale as the rossby waves .",
    "generally , the amplitude of gravity waves , when averaged over the globe , is very small compared to that of rossby waves , and most of the kinetic energy is contained in the large - scale , slow motions .",
    "a long - standing challenge in gcm theory is finding ways to deal with fast waves accurately and efficiently .",
    "the fast motions not only force small timesteps to be taken ( increasing the `` wall time '' of the simulations ) , they also degrade the fidelity with which the equations are solved .",
    "moreover , the very inaccuracy often causes the calculation to `` blow up '' ( become unstable ) , preventing any solution at all . with certain types of numerical algorithms , such as implicit or semi - implicit time - integration schemes , the timestep size restriction can be alleviated .",
    "but , artificial viscosity and various filters are still required to stabilize the integration in general .",
    "it is well known that , in conjunction with coarse resolution , dissipation and filters can produce results that are seductively misleading  even to the wary modelers . for example , in the classic held - suarez test for the dynamical core of gcms for the earth @xcite , increasing the resolution generally leads to enhanced equatorward shift of wave activity @xcite .",
    "the shift becomes more evident in the simulations with horizontal resolutions @xmath1 t85 resolution ( i.e. , 85 sectoral and 85 total modes ) so that precise jet positions , for example , can not be ascertained at lower resolutions .",
    "this is a relatively mild example , but it is telling : the more extreme forcing condition for extrasolar planets , it can be argued , will lead to larger or more sensitive variations , given that the models have been designed and tested for conditions appropriate for solar system planets . in this backdrop ,",
    "even inter - comparing different gcms for extrasolar planet work becomes non - trivial .",
    "in this paper we present and discuss examples of interesting behavior when a gcm is stressed to its limits , with what may be considered a typical hot , spin - orbit synchronized extrasolar planet condition .",
    "the implications are broad in the sense that the lessons are not just limited to studies using gcms , but also other types of global circulation models .",
    "the issues are present in all of them .",
    "the basic plan of the paper is as follows . in section  [",
    "sec : method ] we describe the gcm model we use and its setup for the simulations described in this work . in section",
    "[ sec : spatial ] we focus on the interaction between artificial viscosity and the thermal relaxation time , which is an important parameter in the representation of thermal forcing commonly used in current studies . in section  [ sec : temporal ] we examine sensitivity of the simulations to the robert - asselin filter , which is used to stabilize the time - marching scheme .",
    "we conclude in section  [ sec : concl ] , summarizing this work and discussing its implications for extrasolar planet circulation modeling .",
    "in this work , we solve the same equations as in @xcite . here",
    "we briefly summarize the relevant aspects for the reader .",
    "the horizontal momentum equations are solved in the vorticity - divergence form : @xmath2 where @xmath3 is the vorticity , @xmath4 is the divergence , @xmath5 is the horizontal velocity , @xmath6 is the vertical unit vector , @xmath7 , @xmath8 is the geopotential , and @xmath9 where @xmath10 is the coriolis parameter , @xmath11 is pressure , @xmath12 is temperature and @xmath13 is the specific gas constant .",
    "the vertical coordinate is a generalized pressure coordinate , @xmath14 , with @xmath15 the bottom surface pressure , and @xmath16 with @xmath17 the material derivative .",
    "hydrostatic equilibrium is assumed : @xmath18 and the ideal gas law , @xmath19 , where @xmath20 is density , is taken as the equation of state .",
    "the mass continuity equation is integrated from the bottom ( @xmath21 = 1 ) to the top surface , @xmath22 , using the boundary conditions @xmath23 = 0 at both the top and the bottom , which yields an evolution equation for @xmath15 : @xmath24 integration of the continuity equation from @xmath22 to @xmath21 yields a diagnostic equation for @xmath23 : @xmath25 the diagnostic equation for @xmath26 is then : @xmath27 finally , the energy equation is @xmath28 where @xmath29 is the specific heat at constant pressure . in the final formulation of the equations , terms involving @xmath5",
    "are represented in terms of the transformed velocity @xmath30 , where @xmath31 is latitude , in order to avoid discontinuities at the poles .",
    "also , the equations are formulated using ln(@xmath15 ) instead of @xmath15 to avoid aliasing problems .",
    "the @xmath32 terms in the vorticity , divergence and energy equations represent horizontal diffusion , discussed in the next subsection .",
    "to solve the equations described in the preceding subsection , we use the community atmosphere model ( cam 3.0 ) , described in @xcite and @xcite .",
    "cam is a well - tested , highly - accurate hydrodynamics model employing the pseudospectral algorithm @xcite .    for problems not involving sharp discontinuities ( e.g. , shocks or , in atmospheric dynamics problems , fronts ) and irregular geometry ,",
    "the pseudospectral method is superior to the standard grid and particle methods ( e.g. , * ? ? ?",
    "* ) . to equal the accuracy of the pseudospectral method for a problem solved with the computational domain decomposed into @xmath33 grid points",
    ", one would need a @xmath34-order finite difference or finite element method with an error of @xmath35 , where @xmath36 is the grid spacing and @xmath37 is the asymptotic order ( e.g. , * ? ? ?",
    "this is because as @xmath33 increases , the pseudospectral method benefits in two ways .",
    "first , @xmath36 becomes smaller , which would cause the error to rapidly decrease even if the order of the method were fixed .",
    "however , unlike finite difference and finite element methods , the order is _ not _ fixed : when @xmath33 is doubled to @xmath38 , the error becomes @xmath39 $ ] in terms of the new , smaller @xmath36 .",
    "since @xmath36 is @xmath40 , the error for the pseudospectral method is @xmath41 $ ] .",
    "significantly , the error decreases faster than any finite power of @xmath33 since the power in the error formula is always increasing as well , giving an `` infinite order '' or `` exponential '' convergence .",
    "this advantage is particularly important when many decimal places of accuracy or high resolution is needed .",
    "note that in the vertical direction cam uses a finite differencing scheme , as in most gcms .    for the spherical geometry , the horizontal representation of an arbitrary scalar quantity @xmath42 consists of a truncated series of spherical harmonics , @xmath43 where @xmath44 is the highest fourier ( sectoral ) wavenumber included in the east - west representation ; @xmath45 , which can be a function of the fourier wavenumber @xmath46 , is the highest degree of the associated legendre functions @xmath47 ; @xmath48 is the longitude ; and , @xmath49 .",
    "the spherical harmonic functions , @xmath50 used in the spectral expansion are the eigenfunctions of the laplacian operator in spherical coordinates : @xmath51\\ , y^m_n,\\end{aligned}\\ ] ] where @xmath52\\ , + \\ ,       \\frac{1}{1 - \\mu^2}\\frac{\\del^2}{\\del\\lambda^2}\\right\\}\\end{aligned}\\ ] ] and @xmath53 is the planetary radius .",
    "the set , @xmath54 , constitutes a complete and orthogonal expansion basis @xcite .    in the navier - stokes equations , the diffusion terms appear as the laplacian of the dynamical variables @xcite . in our case ,",
    "the diffusion is generalized to the following `` hyperdissipation '' form ( e.g. , * ? ? ?",
    "* ) : @xmath55\\,\\chi,\\ ] ] where @xmath56 and @xmath57 is a correction term added to the vorticity and divergence equations to prevent damping of uniform rotations for angular momentum conservation . in the above form , the @xmath58 case is sometimes referred to as _",
    "superdissipation_. hyperdiffusion is added in each layer to prevent accumulation of power on the small , poorly - resolved scales and to stabilize the integration .",
    "@xcite describes the effects of various hyperviscosities ( i.e. , different values of @xmath59 ) . as discussed in that work , a rational procedure for estimating roughly the value of @xmath60",
    "can be obtained in the following way . to damp oscillations at the smallest resolved scale ( set by the truncation wave number , @xmath61 ) , by an @xmath62-folding factor in time @xmath63 ,",
    "one requires that @xmath64^{\\mathfrak{p}}\\right\\}.\\ ] ] thereafter , the optimal value of @xmath60 is obtained by computing the kinetic energy spectrum ( see section  [ sec : results ] ) .",
    "note that the precise value is problem specific , and the procedure just described should be performed for _ each _ problem  as has been done in this work .    in numerical solutions of time - dependent equations , there are two main ways of marching in time .",
    "explicit methods give the solution at the next time level in terms of an explicit expression which can be evaluated by using the solution at the previous timestep .",
    "implicit methods , on the other hand , require solving a boundary value problem at each timestep .",
    "explicit time differencing is a more straightforward numerical approximation to the equations . in our model",
    ", the time - marching is effected using a _",
    "semi_-implicit scheme , a mixture of the two methods commonly used in gcms . in this scheme ,",
    "the equations are split into nonlinear and linear terms , symbolically written : @xmath65 where @xmath66 and @xmath67 denote the nonlinear and linear terms , respectively , and @xmath68 is the state of a variable in @xmath69 .    for the nonlinear terms , an explicit leapfrog scheme is used .",
    "this is a second - order , three - time - level scheme .",
    "because a second - order method is applied to solve a differential equation which is first - order in time , an unphysical computational mode is admitted , in addition to the physical one . in simulations containing nonlinear waves , the computational mode can amplify over time , generating a time splitting instability @xcite .",
    "robert ( 1966 ) and asselin ( 1972 ) designed a filter to suppress the computational mode  hence the time splitting instability .",
    "this filter is applied in the gcm used in the present work .",
    "it is applied at each timestep so that @xmath70 where @xmath71 , an overbar refers to the filtered state , and @xmath72 specifies the strength of the filter .",
    "the filter results in strong damping of the amplitude of the spurious computational mode .",
    "however , it also introduces a second - order error in the amplitude of the physical mode with high values of @xmath72 , as we discuss further in section  [ sec : temporal ] .",
    "some parts of the equations can be solved implicitly with advantage . in particular , the linear parts that produce fast gravity waves",
    "are treated implicitly in many gcms , including the one used in this work .",
    "this treatment allows a larger timestep to be used , as mentioned in section  [ sec : intro ] .",
    "however , it is also at the cost of degraded accuracy ( e.g. , * ? ? ?",
    "as can be seen , time - integration of the primitive equations is not a straightforward matter , even with a relatively simple method like the leapfrog scheme .",
    "the theoretical analysis of the scheme is equally complex .",
    "the stability of the combined , semi - implicit leapfrog scheme has been examined by @xcite , particularly with respect to the basic state temperature profile .",
    "they find the isothermal basic state distribution to be more stable than a spatially - varying distribution , with the stability generally increasing with higher basic temperature . in the present work an isothermal basic state of 1400",
    "k is used .",
    "in addition to tuneable parameters associated with the numerical scheme , such as the ones mentioned in the preceding subsection , the representations of physical processes also require specification of parameters .",
    "many of these are as yet poorly constrained by observations or unobtainable from first principles ( see , e.g. , discussions in @xcite , @xcite , and @xcite ) .",
    "one example is thermal forcing ( i.e. , heating and cooling ) due to the irradiation from the host star and radiative processes in the planetary atmosphere , which is represented in an idealized way currently in all extrasolar planet atmosphere simulations .",
    "many crudely represent the forcing by newtonian relaxation , as in this work ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) .    in this representation , the net heating term in equation  ( [ eq : temp ] )",
    "is represented by @xmath73 where @xmath74 is the `` equilibrium '' temperature distribution and @xmath75 is the thermal relaxation ( drag or `` cooling '' ) time .",
    "the appropriate values to use for this relaxation time ( as well as the equilibrium temperature distribution ) are poorly known and a large range of values has been used in the extrasolar planet literature . in several studies ,",
    "very short relaxation times  even less than an hour  and large @xmath76 gradients have been used ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "this represents a rather `` violent '' forcing on the flow , depending on the initial condition .    in this work , both @xmath75 and @xmath76",
    "are prescribed and barotropic ( i.e. , @xmath77 ) and steady ( i.e. , @xmath78 ) .",
    "as in @xcite , @xmath79 with @xmath80 and @xmath81 , where @xmath82 and @xmath83 are the maximum and minimum temperatures at the day and night sides , respectively .",
    "all the simulations described in this paper have @xmath84  k , @xmath85  k. other physical parameters chosen are based on the close - in extrasolar planet , hd209458b ( see table  [ tab : params ] ) .    llll planetary rotation rate & @xmath86 & 2.1@xmath8710@xmath88 & s@xmath89 + planetary radius & @xmath53 & 10@xmath90 & m + gravity & @xmath91 & 10 & m s@xmath92 + specific heat at constant pressure & @xmath29 & 1.23@xmath8710@xmath93 & j kg@xmath89 k@xmath89 + specific gas constant & @xmath13 & 3.5@xmath8710@xmath94 & j kg@xmath89",
    "k@xmath89 +   + mean equilibrium temperature & @xmath95 & 1400 & k + equilibrium substellar temperature & @xmath82 & 1900 & k + equilibrium antistellar temperature & @xmath83 & 900 & k + initial temperature & @xmath96 & 1400 & k +    the spectral resolutions in the horizontal direction for the runs described in the paper are t85 and t21 .",
    "the number refers to the maximum total wavenumber , @xmath97 , at which expansion  ( [ eqn : expansion ] ) is truncated ( e.g. , t85 @xmath98 ) ; `` t '' means the truncation is such that @xmath99 in equation  ( [ eqn : expansion ] ) , a `` triangular truncation '' in wavenumber space .",
    "a t85 spectral resolution corresponds roughly to 800@xmath87400 grid points in physical space of grid - based methods ( roughly 200@xmath87100 for t21 resolution ) .",
    "the vertical direction is resolved by 26 coupled layers , with the top level of the model located at 3  mbar .",
    "the pressure at the bottom @xmath21 boundary is initially 1  bar , but the value of the pressure changes in time .",
    "the entire domain is initialized with an isothermal temperature distribution , @xmath100  k. the flow field is initialized with a small , random perturbation ; specifically , values of the @xmath5 components are drawn from a gaussian random distribution centered on zero with a standard deviation of 0.05  m  s@xmath89 .",
    "the sensitivity to initial flow is described in detail in @xcite .",
    "table  [ tab : sims - nu ] lists all the runs discussed in this subsection .",
    "simulations are performed with the setup described above , but with varying strength of artificial viscosity ( @xmath101 and @xmath59 ) and the forcing timescale ( @xmath75 ) .",
    "figure  [ fig : diss - tau ] presents the relative vorticity field near the @xmath102  mb level ; this is approximately a quarter of the way down from the top of the computational domain .",
    "the field at @xmath103 is shown in cylindrical equidistant projection , centered at the equator , for ten simulations in which the setup is identical except for the values of @xmath75 and @xmath101 ( @xmath104 , superdissipation ) ; here , @xmath105 is the planetary rotation period .",
    "positive vorticity ( red color ) signifies local rotation in the same direction as the planetary rotation ( counter - clockwise in the northern hemisphere ) , and opposite for the negative vorticity .",
    "the panels on the left column all have the same short value of @xmath106 , while the panels on the right column all have @xmath107 for five different values of @xmath101 .",
    "in all the runs shown , the global kinetic energy time series have reached stationary ( `` equilibrated '' ) state and do not change qualitatively for approximately 300@xmath108 .    for a given value of @xmath75 , simulations with different @xmath101 s",
    "generally share some common features over a range of @xmath101 s .",
    "but , there are clear differences in the character of the flow and temperature fields . the differences , which are both qualitative and quantitative , arise from the strength of dissipation .",
    "moreover , @xmath101 can affect the temporal behavior as well .",
    "for example , temporal variability can be muted with larger @xmath101 . not surprisingly , in the strongest dissipation cases [ panels  ( a ) and ( b ) ] variability in time is essentially completely quenched and the flow structures are quite smooth in appearance .",
    "these are examples of runs which are severely over - dissipated .    at the other extreme , runs can also be severely under - dissipated .",
    "this is shown in panels  ( i ) and ( j ) in figure  [ fig : diss - tau ] .",
    "note that the common @xmath101 value in these runs is four orders of magnitude smaller than that for the runs of panels  ( a ) and ( b ) .",
    "a quick visual check of panels  ( i ) and ( j ) immediately shows the physical fields dominated by small - scale oscillations : this is numerical noise . here , by `` small '' we mean scales near the grid - scale , @xmath109 .",
    "typically , runs like these blow up  or at least they should ( see section  [ sec : temporal ] ) .",
    "simulations often blow up long before the small - scales contain any significant amount of energy compared to the large - scales .",
    "as we discuss more later , this is because the calculation _ correctly _ becomes unstable .",
    "but , sometimes misbehaving simulations can be surprisingly resilient and not crash .",
    "this is usually a signal that bad numerics is at play .",
    "cccc n1a & 1@xmath8710@xmath110 & 2 & .1 + n1b & 1@xmath8710@xmath110 & 2 & 3 + n2a & 1@xmath8710@xmath111 & 2 & .1 + n2b & 1@xmath8710@xmath111 & 2 & 3 + n3a & 1@xmath8710@xmath112 & 2 & .1 + n3b & 1@xmath8710@xmath112 & 2 & 3 + n4a & 1@xmath8710@xmath113 & 2 & .1 + n4b & 1@xmath8710@xmath113 & 2 & 3 + n5a & 1@xmath8710@xmath114 & 2 & .1 + n5b & 1@xmath8710@xmath114 & 2 & 3 + n6a & @xmath1156@xmath8710@xmath116 & 1 & .1 +    as expected , increasing @xmath101 leads to decreasing small - scale oscillations and to increasingly smoother fields .",
    "however , significantly , we note that for a given value of @xmath101 for the two @xmath75 s ( cf .",
    ", panels of the same row in figure  [ fig : diss - tau ] ) shorter @xmath75 in a run admits much more pronounced grid - scale oscillations . for example , with @xmath117  m@xmath93  s@xmath89 [ panels ( e ) and ( f ) ] , the viscosity is clearly _ insufficient _ to suppress small - scale oscillations in the case of @xmath106 , while no small - scale oscillations are present in the calculation with longer @xmath75 . more importantly , a @xmath101 value which appears to be acceptable for the shorter relaxation time [ e.g. , panel  ( a ) ] is clearly over - dissipative for the run with the longer @xmath75 [ e.g. , panel  ( b ) ] : here , the calculation in ( b ) should be compared with that in ( f ) , which is clearly a much less dissipated run than that in ( b ) .",
    "hence , running a simulation at a single @xmath75even if @xmath101 were varied  would not produce trustworthy results since the parameter space is at least two - dimensional .",
    "the implication of this is serious . in many current simulations of hot planet",
    "atmospheric flows , a range of @xmath75 s is specified , spread over the model atmosphere domain , which always contains a region with a short @xmath75 .",
    "this forces those model atmosphere calculations to be excessively noisy _ and _ excessively dissipated , in different atmospheric regions of the computational domain .",
    "once noise appears in the calculation somewhere in the domain , the entire domain becomes quickly contaminated .",
    "note that an inherently smooth field  such as temperature compared to vorticity , for example  would not reveal the noise as well , since it is essentially two integrations ( a smoothing operation ) of the vorticity field .",
    "in other words , temperature possesses a steep ( narrow ) spectrum like the stream function , as opposed to a shallow ( broad ) spectrum like the vorticity . similarly , other averaging ( integrating ) procedures , such as taking zonal ( eastward ) and/or temporal means ,",
    "would obscure , possibly mislead , the analysis of the simulation if unaveraged `` higher - order '' fields like vorticity are not considered concomitantly .    [ cols=\"^,^ \" , ]     , as indicated in the legend .",
    "the blue and black lines are the same as in the left panel of figure  [ fig : spec ] , for which the viscosity is of biharmonic form ( @xmath118 with @xmath104 ) .",
    "but , the red line is for a simulation where the order of the viscosity is lower ( @xmath119 ) , the normal newtonian viscosity .",
    "[ fig : del2],width=340,height=340 ]    we wish to emphasize here that , in contrast to what might be the customary view , numerical noise and blow - ups are useful .",
    "simulations with severe forcing should be _ allowed _ to crash  or at least halted , when near grid - scale oscillations are visible in the flow field .",
    "any phenomena observed thereafter would be seriously compromised in accuracy , and quite possibly entirely artifactual @xcite . in numerical work , it is easy to get lured into believing a calculation by not heeding important telltale signs",
    ".    there is a rational way to diagnose the onset of the small - scale error sources  as well as the excessive dissipation  in a simulation .",
    "this is illustrated in figure  [ fig : spec ] , which contains the kinetic energy spectra of the fields presented in figure  [ fig : diss - tau ] . to the best of our knowledge ,",
    "this is the first time kinetic energy spectra are shown in extrasolar planet atmosphere flow simulations .",
    "they provide an important diagnostic , when used in conjunction with instantaneous fields ( see , e.g. , @xcite and @xcite for a discussion of kinetic energy spectra and horizontal diffusion ) , and can be used to choose an appropriate @xmath101 value .",
    "the left set of spectra in figure  [ fig : spec ] corresponds to runs with the shorter @xmath120 in the left column of figure  [ fig : diss - tau ] , and the right set of spectra in figure  [ fig : spec ] corresponds to runs with the longer @xmath121 in the right column of figure  [ fig : diss - tau ] .",
    "visual inspection of the vorticity fields along the left column of figure  [ fig : diss - tau ] suggests the runs in panels  ( a ) and ( c ) are not much affected by the small - scale oscillations [ if at all in the run of panel  ( a ) ] .",
    "this can be quantified by confirming that the corresponding spectra in figure  [ fig : spec ] ( left panel ) are the blue and black lines ( runs n1a and n3a , respectively ) .",
    "in fact , the blue line clearly reveals a case of over - damping , in which all scales are less energetic than the corresponding scales in the other runs .",
    "in contrast , note the appearance of near - grid - scale waves in physical space , for the run in panel  ( i ) in figure  [ fig : diss - tau ] , indicated by a tendency for the spectrum ( red line in left panel of figure  [ fig : spec ] ) to peel off and curl up near  and considerably to the left ( larger scale ) of  the aliasing limit ; this is @xmath122 which is @xmath123 in our case , since @xmath36 is chosen to be `` alias - free '' up to @xmath61 @xcite .",
    "clearly , our de - aliasing procedure , of inverse transforming onto a physical grid that is @xmath124 around the longitude , is not successful in runs n5a and n4a , as well as in run n3a ( spectrum not shown ) .",
    "this is because increasingly greater resolution is needed as the calculation proceeds , as discussed below . in turbulence simulations ,",
    "this peeling off behavior is known as an `` energy pile - up '' or `` spectral blocking '' ( because direct energy cascade to high wavenumbers in three - dimensional turbulence is blocked ) .",
    "it is not limited to spectral methods .",
    "it is universal to all methods which discretize space .",
    "spectral blocking can cause numerical instability in the time integration of any nonlinear equations .",
    "the instability arises due to the quadratically nonlinear term in the solved equations .",
    "for example , a typical quadratically nonlinear term ( in one - dimensional cartesian geometry for simplicity ) gives : @xmath125 here , @xmath126 is an arbitrary one - dimensional scalar function , which is fourier expanded ; @xmath127 are given by a sum over the products of the @xmath128 ; @xmath129 is the truncation wavenumber , corresponding to @xmath61 in equation  ( [ eqn : dissip ] ) .",
    "note that the nonlinear interaction generates high wavenumbers , @xmath130 , which will be aliased into wavenumbers on the range @xmath131 $ ] .",
    "this induces an unphysical inverse cascade of energy from high wavenumbers to low wavenumbers .",
    "it is important to realize that the above cascade injects artificial energy into _ all _ scales .",
    "the injection is simply more noticeable in the small scales since not much energy is contained there in the absence of blocking .",
    "oscillations of size @xmath109 are a precursor to breakdown of computational fidelity .",
    "these oscillations are insidious because they require higher and higher resolution in the calculation over time . without the increasing resolution , they deteriorate the accuracy of the simulation on all scales as the calculation proceeds , as pointed out in @xcite .",
    "although some blocking is almost inevitable in a long time integration of a nonlinear system ( unless the dissipation is unrealistically large ) , it can be monitored and controlled  albeit better in some methods than in others .",
    "the left and right panels of figure  [ fig : spec ] reveal not only how the appropriate dissipation can be chosen , but also the crucial interplay between the small - scale noise and @xmath75hence , underscoring the importance of using _ both _ the spectra and the physical field in analyzing a calculation .",
    "consider , for example , the `` optimal '' calculation ( i.e. , least affected by too much or too little dissipation ) for the short @xmath75 runs .",
    "the calculation with @xmath132  m@xmath93  s@xmath89 ( black line in the left panel ) is devoid of non - physical build up of energy at the smallest scales while still retaining the same amount of energy in the large scales as in the calculations with smaller @xmath101 . on the other hand ,",
    "the calculation with longer @xmath75 but same @xmath101 ( black line in the right panel ) is clearly over - dissipated , containing less energy compared to the other calculations on essentially all the scales .",
    "hence , if the @xmath101 value were `` tuned '' with the calculations with shorter @xmath75 ( only ) , then a calculation with a different @xmath75 ( say a longer one , as in this example ) would be over - damped .",
    "in other words , a correct @xmath101 value can not be obtained independent of @xmath75 . actually , @xmath133 , where `` @xmath134 '' includes @xmath76 , @xmath53 .",
    "semi - implicitness , etc .",
    "the above behavior is generic .",
    "simulations performed with a greater range of @xmath75 ( down to 0.01@xmath135 ) and @xmath101 and @xmath59 , exhibit the same basic behavior ; and , it is present throughout the model domain ; grid - scale oscillations can appear in the duration of a calculation anywhere in the domain .",
    "these oscillations can be controlled to some degree in mild cases , as outlined above .",
    "however , grid - scale oscillations are dominant near the top of the domain for _ all _ values of @xmath101 considered .",
    "in this situation , it is common in gcm studies to include a  sponge layer \" , where dissipation is artificially enhanced in the topmost layers .",
    "while this can damp unphysical oscillations , it can also have spurious effects .",
    "the effects of  sponges \" as well as other boundary conditions will be described elsewhere .",
    "figure  [ fig : del2 ] shows how the spectrum is affected when the form of the artificial viscosity is of lower order .",
    "the blue and black lines ( runs n1a and n2a , respectively ) are the same as in the left panel of figure figure  [ fig : spec ] .",
    "they can be compared to the red line ( run n6a ) , which shows the spectrum from a simulation that is identical to the other two runs in the figure , except for the value of @xmath101 and the order of the viscosity operator ( here @xmath136 ) . in this case , the energy in the small scales ( high wavenumbers ) is dissipated much more strongly .",
    "more importantly , essentially _ all _ wavenumbers are affected by the lower order viscosity ; and , as discussed in @xcite , the slope of the spectrum becomes steeper  even at wavenumbers well below the truncation scale .",
    "if the solved equations support several types of waves , as with the primitive equations , the maximum stable timestep is limited by the courant number , @xmath137 where @xmath138 is the maximum horizontal wind speed associated with the fastest propagating wave .",
    "some fast waves are of little physical significance , but they enslave @xmath139 to be small .",
    "implicit schemes do permit a larger timestep size to be used than in explicit schemes , often making the former more computationally efficient .",
    "however , for nonlinear equations , implicit schemes have a high cost per timestep because a nonlinear boundary value problem must be solved at each timestep .",
    "as noted , a semi - implicit algorithm is commonly used in gcms . in general , the implicit and explicit parts in the algorithm may be of same or different order . treating some terms explicitly while others implicitly may appear strange , but there are some major advantages . first , because the nonlinear terms are treated explicitly ,",
    "it is only necessary to solve a _ linear _ boundary value problem at each timestep .",
    "second , the hyperdissipation terms , which involve even number of derivatives , impose a much stiffer timestep requirement than the advective terms ; for example , @xmath139 is @xmath140 and @xmath141 , respectively , for the newtonian viscosity ( @xmath119 ) .",
    "hence , the semi - implicit algorithm stabilizes the most unwieldy terms .",
    "third , in general circulation and other fluid dynamics problems , advection is crucial ; therefore , it is important to use a high order time - marching scheme with a short timestep to accurately compute phenonmena or structures such as frontogenesis , advection of storm systems , and turbulent cascades .",
    "there is little advantage in treating the nonlinear terms implicitly because a timestep longer than the explicit advective stability limit would be too inaccurate .",
    "note that , although it is possible to treat the time coordinate spectrally , it is generally more efficient to apply spectral methods to the spatial coordinates only because time marching is usually much cheaper than computing the solution simultaneously over all space - time . in general ,",
    "much less concern is given to the temporal accuracy than the spatial accuracy of gcms  usually with good justification : spatial errors pose greater problems , especially for the short and medium range duration runs typically performed with the models .",
    "this obviously does not apply for long duration runs , particularly if quantitative predictions are sought @xcite .",
    "clcl e1a & 0.001 & .1 & blow - up ( @xmath142 ) + e1b & 0.001 & 3 & blow - up ( @xmath143 ) + e2a & 0.002 & .1 & blow - up ( @xmath142 ) + e2b & 0.002 & 3 & + e3a & 0.006 & .1 & blow - up ( @xmath144 ) + e3b & 0.006 & 3 & + e4a & 0.01 & .1 & + e4b & 0.01 & 3 & + e5a & 0.06 & .1 & + e5b & 0.06 & 3 & + e6a & 0.1 & .1 & + e6b & 0.1 & 3 & +    as already discussed , a computational mode arises in the leapfrog scheme , which is an example of a two - step scheme : @xmath145 where @xmath146 ; recall that @xmath72 is the robert - asselin time filter coefficient .",
    "computational modes arise in all multistep methods . fortunately , in some multistep methods @xmath147 can be chosen to keep the amplitude of the modes from growing . however , the leapfrog scheme is unstable for diffusion , for all @xmath139 . for this reason ,",
    "the diffusion part of the equations is `` time - lagged '' by evaluating the diffusion terms at the time level @xmath148 .",
    "this effectively time - marches the diffusion part by a first - order scheme .",
    "the robert - asselin filtered leapfrog scheme has been analyzed by @xcite for the simple oscillation equation , @xmath149 where @xmath150 is the frequency of oscillation .",
    "that analysis shows that , in the limit @xmath151 , the relative phase - speed error of the physical mode is @xmath152(\\omega\\delta t)^2.\\ ] ] therefore , the phase of the numerical solution leads the actual solution in time , and the error increases with larger @xmath72 .",
    "no analysis exists to guide in choosing @xmath72 .",
    "hence , it is important to assess the sensitivity of the simulations to the filter . in this work ,",
    "we have performed series of simulations in which @xmath72 has been varied while keeping everything else fixed , for different values of relaxation time @xmath75 .",
    "the simulation parameters are summarized in table  [ tab : sims - eps ] .     in each set .",
    "the four runs within each set have different @xmath72 values , setting the strength of the robert - asselin time filter . for clarity each time series in a set",
    "has been offset vertically by 0.1 in the plot ; and , the two sets , as groups , have been offset vertically by 0.5 . the lower set of runs have @xmath75 = 3 @xmath135 , while the upper set of runs have @xmath75 = 0.1 @xmath135 .",
    "for each set the run with @xmath72 = 0.001 is indicated with a blue line , @xmath72 = 0.002 a red line , @xmath72 = 0.006 a green line , and @xmath72 = 0.01 a black line .",
    "[ fig : cour],width=340,height=340 ]    figure  [ fig : cour ] shows the evolution of the courant number @xmath153 for simulations with different @xmath72 , for two sets of runs with different values of @xmath75 in each set .",
    "note that for clarity each time series in a set has been offset vertically by 0.1 in the plot ; and , the two sets , as groups , have been offset vertically by 0.5 . at the t21 resolution of the runs shown , for @xmath107 and @xmath154  m@xmath93  s@xmath89",
    ", it is found that a value of at least @xmath155 is needed to prevent the simulation from succumbing to time - splitting instability .    with shorter relaxation time",
    "( @xmath156 ) , a _ larger _ value of @xmath72 is required for the simulation to proceed without blowing up ; this is perhaps not surprising , in light of the preceding discussion .",
    "but , remarkably , even without explicit numerical viscosity turned on ( i.e. , @xmath101 set to 0 ) , the simulation can proceed without crashing ; and , this is so despite the fact that the physical field is completely swamped with noise !",
    "when @xmath157 , runs do not crash as long as @xmath158 .",
    "however , with @xmath156 , the minimum @xmath72 for not crashing is an order of magnitude greater .",
    "evidently , an @xmath72 value used in earlier studies of earth s atmosphere should be adjusted when adapting an earth gcm for extrasolar planet study . in general , a shorter @xmath75 or lower viscosity requires stronger robert - asselin filtering to prevent blow - up .",
    "longitude and 30@xmath159 latitude , as a function of time for the first 150 planet rotations in two simulations .",
    "the two curves show results of simulations that are identical apart only from the strength of the robert - asselin time filter .",
    "the red curve is from a run with @xmath72 = 0.10 , and the blue curve from a run with @xmath72 = 0.01 .",
    "[ fig : tt],width=340,height=340 ]    note that the courant - friedrichs - lewy ( cfl ) criterion for stability of the leapfrog scheme @xcite , @xmath160 can sometimes be exceeded in the middle of a run , even though the simulation is stable at @xmath161 ( cf .",
    ", run e3a in figure  [ fig : cour ] ) .",
    "this is because the advective time - stepping limit depends on the maximum speed @xmath138 , which can increase during the evolution of a flow .",
    "careful monitoring of the physical fields shows a zone of intense shear between the two vortices generating small - scale oscillations that rapidly amplify until the simulation becomes nonsense .",
    "the culprit is not lack of spatial resolution or a blocked turbulent cascade , in this case , because the calculation can be extended indefinitely by halving the timestep .",
    "figure  [ fig : eps ] illustrates the sensitivity of the evolution to @xmath72 for the range , @xmath162 $ ] .",
    "although the resolution in these calculations is only t21 , they illustrate the point .",
    "snapshots of the flow field are shown at three successive times for three simulations , differing only in the value of @xmath72 .",
    "similar flow patterns emerge in all the simulations : they all exhibit a cyclic behavior with vortices translating around the planet , undergoing large variations in strength and size as they do so , with corresponding changes in the temperature field .",
    "however , _ at a given instant _ the flow and temperature fields look different between the three runs . at @xmath163 , in all the runs there is a warm cyclone pair centered west of the substellar point . and in all the runs , the cyclones move westward and the flow and temperature fields undergo substantial changes before eventually returning to a similar state , 1520 planet rotations later . but at @xmath164 , the run with the largest @xmath72 has already returned to a state similar to that at @xmath163 , while the runs with smaller @xmath72 take longer to complete their cycles .",
    "figure  [ fig : tt ] shows the behavior more clearly .",
    "the temperature at a point on the model planet atmosphere ( 0@xmath159 longitude , 30@xmath159 latitude ) evolves in time for two simulations which have identical parameters , except for @xmath72 .",
    "the two runs match nearly exactly until about 45@xmath108 , when the two runs start to deviate . in the beginning only slightly .",
    "but , at about 70@xmath108 the temperature oscillations in the run with the larger @xmath72 lead in phase , compared to the run with smaller @xmath72 .",
    "this behavior agrees qualitatively with equation  [ eq : phase ] . over long timescales the three simulations exhibit very similar behavior , even if amplitudes , phases , and periodicities of the flow and temperature fields are not exactly the same .",
    "as noted , simulations shown in figures  [ fig : eps ] and [ fig : tt ] are at t21 resolution , but with higher resolution deviations appear even earlier .    in @xcite ,",
    "the mitgcm @xcite is used . in that study ,",
    "the model employs the third - order adams - bashforth method , which has some attractive properties @xcite .",
    "however , the scheme does require an initialization phase in which @xmath165 and @xmath166 are computed from the initial condition @xmath167 by some other procedure , such as the fourth - order runge - kutta or a first- or second - order scheme with several short timesteps .",
    "it should be emphasized that  as _ it is a major point of this paper_the main concern is usually adequate spatial resolution , especially in problems with inherent small - scale phenomena , not the time - integration . a second- or even first - order time - integration scheme can be perfectly adequate for many purposes .",
    "a major aim of this paper has been to shed light on some crucial aspects for numerical modeling of atmospheric circulation on hot extrasolar planets . here",
    "we have shown that , a spectral model offers advantages in accuracy and diagnostics , given that the higher - order field and wavenumbers are what s actually evolved .",
    "however , all numerical models , including spectral models , have limitations in how well they can represent physical reality . moreover , the models can easily be applied outside the realm of `` safe parameters '' and produce results that are nonsensical .",
    "the challenge is to properly test and identify the limits . when numerical artifacts appear , it is important to know how to deal with them and to know when a simulation should be discarded .    in this paper",
    "we have shown that , for hot extrasolar planets simulations with stationary forcing , there is a strong sensitivity to the strength of applied artificial viscosity .",
    "in addition , there is a relation between the thermal relaxation time @xmath75 and the viscosity @xmath101 : small @xmath75 s lead to a large amount of unphysical , grid - scale oscillations in the simulation , which forces the use of excessive amounts of artificial viscosity to quench the oscillations .",
    "hence , using a fixed strength of artificial viscosity in a simulation with a large range of @xmath75 in the model domain ( e.g. , from about an hour to tens of days)as done in many simulations in the literature  inevitably produces flow and temperature fields , which are either dominated by unphysical noise or over - damping .",
    "one may then wish to apply a spatially varying @xmath101 , but clearly this is then motivated by a numerical basis rather than a physical one .",
    "the proper values to use for the relaxation time ( or variables needed for realistic radiative transfer ) are not known .",
    "based on the findings in this work , calculations with extremely short @xmath75 s warrant further scrutiny .",
    "current gcms may not be standing up too well to this stressful test .",
    "if , however , the short @xmath75 are really _ physically _ relevant , then another form of heating / cooling parameterization or setup is needed .",
    "this is not a criticism of the newtonian relaxation scheme , which in fact has been ( and continues to be ) very useful for understanding basic mechanisms .",
    "one solution could be to spatially vary the @xmath101 , as already discussed ; but , this would lead to further complexity .",
    "even if direct radiative transfer is incorporated , one must ensure that the forcing is not too violent or strong ( large amplitude and short timescale ) .",
    "indeed , a comparison of our @xmath101 values , scaled appropriately for the earth , shows that we have had to use @xmath101 values higher than that normally used in earth studies @xcite . as discussed in @xcite , if the radiative processes appear as practically instantaneous from the perspective of the flow , then an adiabatic approach is more appropriate . certainly from a numerical accuracy standpoint , as motivated by the present work , adiabatic and `` gently forced '' calculations are useful as baselines .",
    "else , gradually ramping up heating and/or initializing simulations close to a balanced state is necessary @xcite .",
    "gcms of extrasolar planet atmospheres have great value in helping to guide and interpret observations .",
    "it is then important to critically examine the effects of the numerous parameters that are specified .",
    "this is particularly crucial when applying the models to a `` new regime '' , where the physical conditions differ markedly from a traditional ( e.g. , earth ) one . in this paper",
    "we have shown examples of how a commonly - used forcing can steer gcms to produce misleading results and how numerical expediencies , such as the robert - asselin filter , can produce slewing frequency as well as the well - known damping and phase - errors @xcite .",
    "in addition , we have discussed diagnostics procedures to better assess the quality of a simulation using the vorticity field and energy spectra .",
    "reliance on spatial and temporal averages can effectively conceal telltale signs that a simulation is not trustworthy .",
    "a simulation which is properly resolving the flow should approximately conserve energy for a long time .",
    "this should be so even if this property is not explicitly built into the discretization algorithm as in the scheme of @xcite [ this scheme conserves the domain - integrated energy and enstrophy ( @xmath168 ) in the nonlinear advection term ] . for",
    "only then can we trust that a calculation is not artificially driven to an unphysical region in the solution space .",
    "the ideas and development of this work has had a long gestation period .",
    "the authors would like to thank o. m. umurhan , c. watkins , a. glen , i. polichtchouk , and e. staehling for helpful discussions over the past several years .",
    "the authors also acknowledge the hospitality of the kavli institute for theoretical physics , santa barbara , where some of the work was accomplished .",
    "h ...  is supported by the eu fellowship . j.y",
    "is supported by the stfc grant pp / e001858/1 .",
    "adcroft , a. , campin , j .-",
    "m . , hill , c. and marshall , j. 2004 , mon .",
    ", 132 , 2845 arakawa , a. 1966 , j.  comp .",
    "phys . , 1 , 119 asselin , r.  1972 , mon .",
    ", 100 , 487 batchelor , g. k. 1967 , an introduction to fluid dynamics ( cambridge : cambridge university press ) boyd , j. p. 2000 , chebyshev and fourier spectral methods ( 2nd ed .",
    ", new york , ny : dover ) byron , f. w. and fuller , r. w. 1992 , mathematics of classical and quantum physics ( mineola , ny : dover ) canuto , c. , hussaini , m.y . ,",
    "qarteroni , a. , and zang , t.a .",
    "1988 , spectral methods in fluid dynamics ( new york , ny : springer ) cho , j. y - k . , polvani , l. 1996 , phys .",
    "fluids , 8 , 6 cho , j. y - k . ,",
    "menou , k. , hansen , b. m. s. , and seager , s. 2003 , apj , 587 , l117 cho , j.y - k . ,",
    "menou , k. , hansen , b.m.s . , and seager , s. 2008 , apj , 675 , 817 cho , j.y - k .",
    "2008 , phil .",
    "a , 366 , 4477 collins , w.d .",
    "2004 , ncar / tn-464+str cooper , c.s . and showman , a.p .",
    "2005 , apj , 629 , 45l dobbs - dixon , i. and lin , d.n.c .",
    "2008 , apj , 673 , 513 durran , d. r. 1991 , mon .  wea .  rev . , 119 , 702 durran , d. r. 1999 , numerical methods for wave equations in geophysical fluid dynamics ( new york , n.y . :",
    "springer - verlag ) eliasen , e. , mechenhauer , b. , and rasmussen , e. 1970 , copenhagen univ .",
    "teoretisk meteorologi , tech .",
    "2 held , i. m. and suarez , m. j. 1994 , bull .",
    "soc . , 75 , 1825 koshyk , j. n. , boville , b. a. , hamilton , k. , manzini , e. , and shibata , k. 1999 , j. geophys .",
    "res . , 104 , 27177 .",
    "langton , j. and laughlin , g. 2007 , apj , 657 , 113l leveque , r. j. 2007 , finite difference methods for ordinary and partial differential equations ( philadelphia , pa : siam ) menou , k. and rauscher , e. 2009 , apj , 700 , 887 orszag , a. 1970 , j.  atmos .",
    ", 27 , 890 orszag , a. 1971 , j.  atmos .",
    ", 28 , 1074 nayfeh , a. h. 1973 , perturbation methods ( new york , ny : springer - verlag ) rauscher , e. and menou , k. 2010 , apj , 714 , 1334 robert , a. 1966 , j.  meteorol .",
    "japan , 44 , 237 salby , m. l. 1996 , fundamentals of atmospheric physics ( san diego , ca : academic press ) showman , a. p. and guillot , t. 2002 , , 385 , 166 showman , a.p . ,",
    "cooper , c.s .",
    ", fortney , j.j . , and marley , m.s .",
    "2008 , apj , 682 , 559 showman , a.p . , menou , k. , and cho , j. y - k .",
    "2008 , in asp conf .",
    "398 , extreme solar systems , ed .",
    "d. fischer et al .",
    "( san francisco , ca : asp ) showman , a.p . , fortney , j.j . , lian , y. , marley , m.s . ,",
    "freedman , r. , knutson , h. a. , and charbonneau , d. 2009 , apj , 699 , 564 simmons , a.j .",
    ", hoskins , b.j . , and burridge , d.m .",
    "1978 , mon .",
    "simmons , a.j . , and strufing , r. , ncar technical report no . 28 .",
    "thrastarson , h.th . and cho , j.y - k .",
    "2010 , apj , 716 , 144 wan , h. , giorgetta , m. a. and bonaventura , l. 2008 , mon .",
    ", 136 , 1075 williams , p.d .",
    "2009 , mon .",
    ", 137 , 2538"
  ],
  "abstract_text": [
    "<S> we elucidate the interplay between newtonian thermal relaxation and numerical dissipation , of several different origins , in flow simulations of hot extrasolar planet atmospheres . </S>",
    "<S> currently , a large range of newtonian relaxation , or `` cooling '' , times ( @xmath010 days to @xmath01 hour ) is used among different models and within a single model over the model domain . in this study </S>",
    "<S> we demonstrate that a short relaxation time ( much less than the planetary rotation time ) leads to a large amount of unphysical , grid - scale oscillations that contaminate the flow field . </S>",
    "<S> these oscillations force the use of an excessive amount of artificial viscosity to quench them and prevent the simulation from `` blowing up '' . </S>",
    "<S> even if the blow - up is prevented , such simulations can be highly inaccurate because they are either severely over - dissipated or under - dissipated , and are best discarded in these cases . </S>",
    "<S> other numerical stability and timestep size enhancers ( e.g. , robert - asselin filter or semi - implicit time - marching schemes ) also produce similar , but less excessive , damping . </S>",
    "<S> we present diagnostics procedures to choose the `` optimal '' simulation and discuss implications of our findings for modeling hot extrasolar planet atmospheres . </S>"
  ]
}