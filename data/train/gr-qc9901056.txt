{
  "article_text": [
    "a code based on the characteristic formulation of numerical relativity has been developed for the general 3d problem  @xcite .",
    "the code computes the gravitational field of the full einstein equations for a vacuum spacetime between some inner timelike worldtube @xmath1 and future null infinity .",
    "the code has been tested with the inner worldtube @xmath1 being the ( past ) event horizon of a schwarzschild black hole , with incoming gravitational radiation scattered off the black hole .",
    "the tests have included both the linear and highly nonlinear regimes , and show the robustness of the characteristic formulation in the study of radiative problems .",
    "here we consider whether there are real astrophysical problems to which the characteristic code alone could be applied .",
    "astrophysical problems that can be tackled by the code require the existence of a natural inner worldtube @xmath1 on which boundary data is known .",
    "this would include the ( past ) event horizon of a black hole . in principle",
    "the black hole could be of kerr - newman type , but at present suitable boundary and initial data ( for the characteristic formulation ) are known only in the schwarzschild case , and also in some multi - hole vacuum spacetimes  @xcite .",
    "however , if matter is incorporated into the code , then the range of possible astrophysical applications can be greatly extended .",
    "it would then in principle be possible to compute , in full nonlinear general relativity , the gravitational field and matter flow of a black hole accreting dust and gas , and of a black hole capturing polytropic or more realistic approximations to neutron stars .",
    "this paper does not solve any of these important astrophysical problems , but rather it lays the groundwork for doing so .",
    "the incorporation of matter into a characteristic code has been discussed previously .",
    "an axisymmetric code with matter has been used to consider a problem in cosmology  @xcite ; and a spherically symmetric matter code , that includes cauchy - characteristic matching , has been reported recently  @xcite .",
    "in contrast , the present work has no symmetry requirement .",
    "the paper restricts attention to matter in the form of a perfect fluid , by which we mean that the pressure @xmath2 is a function _ only _ of the density @xmath3 . in section [ s : form ]",
    "we summarize known results , and introduce our notation , for the characteristic formalism and perfect fluid evolution .",
    "next , in section [ s : ntheory ] we derive the fluid evolution equations in our characteristic coordinates ; we also find the additional terms ( compared to the vacuum case ) that appear in the einstein equations .",
    "section [ s : num ] describes details of the numerical implementation of the fluid evolution equations ( the additional terms in the einstein equations are straightforward to code ) .",
    "the resulting matter plus gravity code has been run on a variety of test problems , and the results are described in section [ s : test ] . in all cases , the code is found to be stable and convergent .",
    "we end with a conclusion ( section [ s : conc ] ) , and an appendix that contains expressions from section [ s : ntheory ] that are rather long .",
    "the formalism for the numerical evolution of einstein s equations , in null cone coordinates , is well known  @xcite ( see also  @xcite ) . nevertheless , for the sake of completeness",
    ", we give here a summary of the formalism , including the necessary equations .",
    "we will use the notation and language of  @xcite .",
    "we use coordinates based upon a family of outgoing null hypersurfaces .",
    "we let @xmath4 label these hypersurfaces , @xmath5 @xmath6 , label the null rays and @xmath7 be a surface area coordinate . in the resulting @xmath8 coordinates , the metric takes the bondi - sachs form  @xcite @xmath9 where @xmath10 is related to the more usual bondi - sachs variable @xmath11 by @xmath12 ; and where @xmath13 and @xmath14 , with @xmath15 a unit sphere metric . in analyzing the einstein equations",
    ", we also use the intermediate variable @xmath16    we work in stereographic coordinates @xmath17 for which the unit sphere metric is @xmath18 where @xmath19 we also introduce a complex dyad @xmath20 defined by @xmath21 with @xmath22 . for an arbitrary bondi - sachs metric , @xmath23",
    "can then be represented by its dyad component @xmath24 with the spherically symmetric case characterized by @xmath25 .",
    "the full nonlinear @xmath23 is uniquely determined by @xmath26 , since the determinant condition implies that the remaining dyad component @xmath27 satisfies @xmath28 .",
    "we also introduce spin - weighted fields @xmath29 as well as the ( complex differential ) eth operators @xmath30 and @xmath31 ( see  @xcite for full details ) .    the einstein equations @xmath32 decompose into hypersurface equations , evolution equations and conservation laws .",
    "naturally , the equations will require additional terms to allow for the presence of matter , and the extended equations are given later in section [ sec : matein ] .",
    "here we just note that the hypersurface equations form a hierarchical set for @xmath33 , @xmath34 , @xmath35 and @xmath36 ; and the evolution equation is an expression for @xmath37 .",
    "the remaining independent equations are the conservation conditions , but they will not be needed here .    the null cone problem is normally formulated in the region of spacetime between a timelike or null worldtube @xmath1 and @xmath38 , with initial data @xmath26 given on the null cone @xmath39 in this domain .",
    "boundary data for @xmath40 , @xmath41 , @xmath42 , @xmath10 and @xmath26 is also required on @xmath1 .",
    "the metric variables used remain regular at @xmath38 , and we represent @xmath38 on a finite grid by using a compactified radial coordinate @xmath43 .",
    "the description of a perfect fluid is well understood ( e.g.  @xcite ) . the stress - energy tensor is @xmath44 where @xmath3 is the density , @xmath2 is the pressure , @xmath45 is the 4-velocity and @xmath46 is the metric . in the cases considered here ,",
    "the pressure depends _ only _ on the density , i.e. @xmath47 the matter evolution equations follow from the conservation law @xmath48 , and are @xmath49 which may be rewritten as @xmath50 the numerical implementation of the fluid equations coupled to g.r .",
    "has been investigated primarily within the @xmath51 or cauchy framework . in this formulation",
    ", the spacetime is foliated by a sequence of spacelike surfaces , initial data is given on an initial surface and the evolution equations are used to compute the future .",
    "the numerical investigation of the `` g.r .- hydro '' problem started in the early 70 s by wilson  @xcite and since then it has received considerable attention .",
    "the difficulty of modeling these equations has spurred the development of sophisticated techniques to deal with the diverse idiosyncracies of the problem .",
    "thus , artificial viscosity techniques , total variation diminishing flux limiters , shock - capturing schemes , etc .",
    "are actively employed to aid in the numerical modeling ; refer to  @xcite for a recent review .",
    "another problem one faces when attempting a numerical simulation in the @xmath51 formalism is that an artificial `` outer boundary '' has to be included at some radius in order to deal with a finite grid .",
    "this introduces spurious reflections that spoil long term evolutions . in the characteristic formulation , on the other hand",
    ", one can use penrose s compactification techniques to include infinity in the numerical grid .",
    "additionally , being able to access null infinity allows one to obtain physical quantities , like the radiation given off by the system and the total mass , unambiguously .",
    "there is not as much experience with the g.r .- hydro problem in the characteristic formulation , but the results obtained so far are encouraging , indicating the characteristic formulation of g.r .",
    "might be a valuable tool to study a variety of astrophysical problems .",
    "in order to proceed further we represent the angular part of the 4-velocity by means of the complex quantity @xmath52 where the @xmath53 suffix is introduced to avoid confusion with the bondi - sachs metric variable @xmath11 .",
    "the matter evolution equations are then :    * equation ( [ eq : mev0 ] ) ; * equation ( [ eq : meva ] ) in the form @xmath54    we also introduce the notation @xmath55 and then write @xmath56 the result of doing this is that , in the matter evolution equations , there is no explicit division by @xmath57 ( which could be zero ) . from a numerical point of view , it is possible to write the procedure for computing @xmath58 so as to ensure its good behavior in the low density limit .",
    "the matter evolution equations have been calculated using maple ; they are rather long and are given in the appendix .",
    "the denominators are important in determining whether there may be singular behavior , and here we note that the form of the equations is @xmath59 @xmath60 @xmath61 formally , the equations ( [ eq : rhou ] ) and ( [ eq : v1u ] ) could be singular if @xmath62 were to be 1 ; but this would correspond physically to the velocity of sound being equal to that of light .",
    "we do not concerns ourselves with those cases at the moment and defer its treatment for a later work .",
    "also , the equations ( [ eq : rhou ] ) , ( [ eq : v1u ] ) and ( [ eq : vu ] ) could be singular if @xmath63 were to be zero ; yet , starting from @xmath64 , @xmath65 which can never be satisfied if @xmath66 .",
    "thus , from an analytic point of view , the equations ( [ eq : rhou ] ) , ( [ eq : v1u ] ) and ( [ eq : vu ] ) form a well - behaved set of evolution equations .    finally , again using the condition @xmath67 , we obtain an expression for the remaining velocity component @xmath68 @xmath69      the introduction of matter also amends the einstein equations .",
    "we write the equations as @xmath70 and note that @xmath71 thus the einstein equations for a perfect fluid are @xmath72    in the expressions below , @xmath73 , @xmath74 , @xmath75 , @xmath76 and @xmath77 represent the nonlinear aspherical terms ( in a sense specified in  @xcite ) .",
    "these quantities are quite long and are not repeated here since they have been given explicitly in  @xcite . using maple",
    "we have confirmed that    * @xmath78 in equation ( [ eq : rab ] ) leads to @xmath79 * @xmath80 in equation ( [ eq : rab ] ) leads to @xmath81 * the equation for @xmath42 is a definition so the presence of matter does not change it : @xmath82 * @xmath83 in equation ( [ eq : rab ] ) leads to @xmath84 where @xmath85 * @xmath86 in equation ( [ eq : rab ] ) leads to @xmath87      the data required on the initial null cone is : @xmath88 and these constitute the set of evolution variables .",
    "the auxiliary variables may then be determined on the initial null cone , and they are found in the following order : @xmath2 from the equation of state , @xmath40 from equation ( [ eq : beta ] ) , @xmath41 from equation ( [ eq : q ] ) , @xmath42 from equation ( [ eq : u ] ) , @xmath10 from equation ( [ eq : w ] ) , and @xmath68 from equation ( [ eq : v0 ] ) .",
    "the evolution equations ( [ eq : j ] ) , ( [ eq : rhou ] ) , ( [ eq : v1u ] ) and ( [ eq : vu ] ) may now be used to find @xmath26 , @xmath3 , @xmath63 and @xmath89 ( in that order ) on the `` next '' null cone .    in order to have a properly specified problem ,",
    "we will also need boundary data on the timelike worldtube @xmath1 .",
    "for the gravitational variables this data is @xmath40 , @xmath41 , @xmath42 , @xmath10 and @xmath26 , and for the matter variables we will need @xmath3 , @xmath63 and @xmath89 .",
    "we constructed a set of algorithms to solve equations ( [ eq : beta]-[eq : j ] ) . in discretizing the equations we follow closely the strategy developed for the vacuum case  @xcite .",
    "we introduce a compactified radial coordinate @xmath43 and define the numerical grid with coordinates @xmath90 ( where @xmath91 , and @xmath92 ) . using finite differences to discretize the equations ,",
    "we center the derivatives at @xmath93 .",
    "the evolution equation is treated as in  @xcite where the right hand side is modified to include the matter terms .",
    "thus , the matter variables at @xmath94 are evaluated by taking the average between the values at @xmath95 and @xmath96 , while the radial derivatives are obtained from the average of the corresponding values at @xmath97 and @xmath98 .",
    "next , we proceed to integrate the evolution equation of the matter variables by a simple iterative method which results in a second order in space , second order in time scheme , as follows .",
    "first , note that the matter equations can be schematically written as @xmath99 then , a direct second order discretization is obtained by @xmath100 note that @xmath101 depends on the matter fields , thus without having at hand the value of @xmath102 , @xmath101 can not be directly evaluated at the midpoint .",
    "however , the value of @xmath103 can indeed be obtained by a straightforward iteration . in the first step we set @xmath104 and use it to evaluate the right hand side of ( [ eq : iterat ] ) ; then , the obtained approximation to @xmath102 is used to obtain a better approximation to @xmath105 and so on .",
    "this procedure is repeated a sufficient number of times to ensure second order convergence of the algorithm .",
    "however , care must be taken at the horizon where fields diverge which will spoil the numerical modeling of the problem .",
    "if we had at hand a solution that we could use to evaluate the fields near the horizon , we could just integrate away from it .",
    "unfortunately , this is not the case , and a different strategy must be employed .    in this work , where we mainly investigate the suitability of the characteristic formulation as a mean to simulate matter coupled to g.r . ; we resort to evolving the matter equations from the first point outside the worldtube to null infinity .",
    "hence , the previously described algorithm , where @xmath101 is evaluated at the _ i - th _ point , can not be used since @xmath101 involves radial derivatives .",
    "hence , for the first point we use a different algorithm by employing a _",
    "one sided _",
    "scheme taking backward differences to evaluate @xmath101 .",
    "this scheme is only first order accurate and its resulting discretization error does not match smoothly to the one obtained with the second order scheme ; thus , we do not expect to obtain global second order accuracy in our numerical integration .",
    "several other alternatives are being investigated to obtain global second order accuracy but we defer their implementation to a future work .",
    "finally , the hypersurface equations are discretized as in  @xcite , where the right hand sides now include the matter variables evaluated at @xmath106 ( which is straightforward having the matter fields values at @xmath107 obtained in the previous step ) .",
    "we test the code by considering an initial localized distribution of matter around a schwarzschild black hole with mass taken to be @xmath108 .",
    "the gravitational initial data is taken as @xmath109 for a non - spherical initial distribution of matter , this condition is in a sense unphysical in that it will introduce spurious incoming gravitational radiation  @xcite ; nevertheless it is simple and is suitable for code testing .",
    "the gravitational boundary data on the worldtube @xmath1 , which we take to be the ( past ) event horizon of the black hole at @xmath110 , is  @xcite @xmath111 the initial data for the tests include two different distributions of the matter    * spherical shell that falls radially into the black hole , * localized blob of matter falling radially towards the black hole .",
    "the tests are performed for two different equations of state    * dust ( @xmath112 ) * fluid with @xmath113 .",
    "we assume @xmath114 $ } \\\\                      & \\\\                    0 & \\mbox{otherwise , }                          \\end{array }                          \\right.\\ ] ] if @xmath115 , @xmath3 describes a spherical shell of matter between @xmath116 and @xmath117 , and centered about @xmath118 .",
    "we also consider the case with @xmath119 defined as a localized gaussian - type function @xmath120 which we use to describe an initial `` blob '' of matter . to provide initial data for the velocity field , we set @xmath121 and @xmath122 where @xmath123 is @xmath63 renormalized to be well behaved on the event horizon @xmath110 ( explicitly @xmath124 ) .",
    "@xmath125 represents the energy at infinity of a unit mass particle , in the sense that at infinity @xmath126 ; note that @xmath127 . in the tests described below",
    "we take    * @xmath128 and @xmath129 * @xmath130 varying between @xmath131 and @xmath132 * @xmath115 ( spherical shell ) , or @xmath133 given by eq .",
    "( [ eq : gxa ] ) with @xmath134 ( blob of matter with center at one of the poles whose density goes to zero at about @xmath135 ) * @xmath136    analytically , the matter never reaches @xmath110 , but in practice , due to numerical diffusion , boundary conditions are still needed there ; we impose @xmath137      for dust , the equation of state is @xmath112 .",
    "we also investigate how the code copes with non zero pressure , and set up a test case with the density defined as above ( with @xmath138 ) , and with the equation of state @xmath139 further , in order to keep @xmath58 ( eq .",
    "( [ eq : prho ] ) ) well - behaved for small @xmath3 , we set @xmath112 whenever @xmath140 , where @xmath141 is the maximum value of @xmath3 at @xmath39 .",
    "although the magnitude of this pressure is rather small , it is encouraging to see that the code can handle it even though our implementation of the fluid equations is rather simple .",
    "more realistic equations of state would induce shocks that would recquire a sophisticated treatment of the matter equations .",
    "we defer this to future work .",
    "first , it is necessary to clarify the issue of units .",
    "we are using geometric units in which @xmath142 , and everything is given in terms of a unit of length .",
    "however , this unit is _ not _ metres , but rather it is the distance corresponding to a unit change in the radial coordinate @xmath7 .",
    "we will call the geometric unit of length @xmath143 , and in order to convert to s.i .",
    "units we need to know the value of @xmath143 in metres .",
    "we write @xmath144.}\\ ] ] for example , if we have a @xmath145 black hole with event horizon at @xmath110 , then @xmath146 would be 14766 [ metres ] .",
    "we use the notation that quantities in geometric units will be denoted without suffix , and those in s.i .",
    "units will have the suffix @xmath147 .",
    "then the conversions for speed @xmath148 , mass @xmath149 , density @xmath3 and pressure @xmath2 are : @xmath150 } \\\\",
    "m \\times 1.347 r_0 \\times 10^{27 } & & = m_s \\ ; \\ ; \\mathrm{[kg ] } \\\\",
    "\\rho \\times \\frac{1.347 \\times 10^{27}}{r_0 ^ 2 } & & = \\rho_s \\ ; \\ ; \\mathrm{[kg / m^3 ] } \\\\",
    "p \\times \\frac{1.210 \\times 10^{44}}{r_0 ^ 2 } & & = p_s \\ ; \\ ; \\mathrm{[pa]}\\end{aligned}\\ ] ] note that @xmath151 is @xmath152 , and @xmath153 is @xmath154 in s.i . units .",
    "we now use these conversions to determine , in s.i .",
    "units , the various parameters describing the initial data specified above , when the mass of the black hole is @xmath155 . for the case",
    "@xmath138 we find    * _ spherical shell : _",
    "@xmath156 , @xmath157 , @xmath158 or @xmath159 , @xmath160 ; * _ localized pulse : _",
    "@xmath161 , @xmath157 , @xmath158 or @xmath162 , @xmath163 ;    where @xmath148 is the proper inward radial velocity , and the values of @xmath164 , @xmath165 and @xmath148 are given at the point of maximum density at @xmath39 .",
    "for @xmath166 , @xmath164 and @xmath149 scale linearly in @xmath130 ; @xmath165 scales as @xmath167 ; and @xmath148 is unchanged .",
    "the first test consisted in the collapse of a spherical shell onto a black hole we set the black hole mass @xmath168 , the inner shell @xmath128 and the outer shell @xmath129 .",
    "since the resulting spacetime is spherically symmetric there should be no gravitational waves emitted by the system .",
    "we confirmed this behavior by monitoring the news function for different initial amplitudes @xmath169 ( with @xmath170 ) over time .",
    "the value of each polarization mode converges to zero as the discetrization gets refined .",
    "the matter collapses onto the black hole and the run proceeds smoothly .",
    "figure [ fig : rho_sph ] shows the evolution of @xmath3 for the case with pressure .    in this case",
    "it is fairly straightforward to calculate analytically the bondi mass of the system , and using maple we found that ( for @xmath112 , @xmath171 ) @xmath172 . by increasing the resolution",
    ", we checked that this value is approached , with second order accuracy , by the value computed with the code .",
    "for instance , with a grid of @xmath173 and @xmath174 , the obtained value for the mass is @xmath175 ; which agrees quite well with the expected value .      to study the collision of a dust ball - black hole system we again set the black hole mass @xmath108 and the inner and outer radius of the blob with @xmath128 and @xmath129 ;",
    "finally , the localization on the sphere is set by choosing @xmath176 .",
    "this configuration describes a ball of dust with center at one of the poles that goes to zero at about @xmath135 with compact support in @xmath177 $ ] in the radial direction .",
    "note that in this case , although we initially set @xmath121 , the self gravitational field of the dust ball induces a non zero @xmath89 towards the pole .",
    "figure [ fig : rho_nosph ] displays the evolution of @xmath3 for the case with pressure ( @xmath178 ) . again , the evolution proceeds smoothly as the `` blob '' of matter collapses on to the black hole and the plus polarization mode of the news is obtained at null infinity ( see figure [ fig : news ] ) .",
    "although an analytic solution to this problem is unknown , one can check consistency of the obtained simulation by observing that the _ cross _ polarization mode ( @xmath179 ) must vanish ( since the problem is still axysimmetric ) .",
    "we confirmed this behavior , by increasing the number of grid points and plotting the logarithm of the @xmath180 norm of @xmath179 ( at @xmath181 ) vs. discretization size and observing its convergence to zero .",
    "as shown in figure [ fig : conv ] the slope of @xmath182 is in agreement with second order convergence .",
    "the convergence test was performed with @xmath178 and with non - zero pressure .",
    "we should add , however , that at later times ( @xmath183 ) , the convergence rate is reduce to about @xmath184 .",
    "this is expected because of the non - centered scheme used at the black hole boundary ( see section [ s : num ] ) .",
    "another check made was that the path of the peak density should be a geodesic of the background spacetime .",
    "this was indeed found to be the case .",
    "for example , using maple we found that at @xmath185 @xmath7 should be @xmath186 ; and numerically we found , for the case @xmath187 and non - zero pressure , that @xmath188 ( for a grid with @xmath189 and @xmath174 ) .",
    "in this paper , we have incorporated matter , in the form of a perfect fluid , into the characteristic code for the einstein field equations : we have found explicit forms for the various evolution and field equations , we have shown how these equations are discretized , and we have carried out a number of tests on the resulting code .",
    "the code is stable and convergent , and its validation has included the following tests    * the peak of the matter `` blob '' follows a geodesic of the background spacetime . *",
    "the code is not written with any symmetries , yet symmetric initial data leads to the appropriate part of the gravitational radiation vanishing . * the initial mass of the system , as calculated by the code",
    ", agrees with the initial mass calculated analytically .",
    "this paper has not computed a solution to any real problem in astrophysics .",
    "nevertheless , we have shown that the present code is capable of modeling a variety of situations where matter is captured by a black hole ; although our treatment of the hydrodynamics would need to be amended in order to be able to handle shock waves .",
    "even so , the present code should be able to contribute towards an understanding of a number of problems in black hole astrophysics .",
    "the authors thank philippos papadopoulos , jose font , richard matzner , matthew choptuik and ed seidel for helpful comments .",
    "this work has been supported by nsf phy 9510895 and nsf int 9515257 to the university of pittsburgh , by nsf phy 9800722 and nsf phy 9800725 to the university of texas at austin and by the binary black hole grand challenge alliance , nsf phy / asc 9318152 .",
    "computer time was provided by the pittsburgh supercomputing center and the san diego supercomputer center .",
    "was partially supported by a mellon predoctoral fellowship at the university of pittsburgh .",
    "n.t.b . and m.m .",
    "thank the foundation for research development , south africa , for financial support .",
    "thanks the university of pittsburgh for hospitality .",
    "thanks the universities of south africa and of durban - westville for their hospitality .",
    "the evolution equations for the matter variables are given below .",
    "note that @xmath190 is @xmath191 .",
    "@xmath192 @xmath193 with @xmath194 and @xmath195 given by @xmath196 @xmath197"
  ],
  "abstract_text": [
    "<S> a code that implements einstein equations in the characteristic formulation in @xmath0 has been developed and thoroughly tested for the vacuum case . here , we describe how to incorporate matter , in the form of a perfect fluid , into the code . </S>",
    "<S> the extended code has been written and validated in a number of cases . </S>",
    "<S> it is stable and capable of contributing towards an understanding of a number of problems in black hole astrophysics . </S>"
  ]
}