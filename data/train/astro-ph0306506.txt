{
  "article_text": [
    "in principle , cmb anisotropy data analysis is easy : for at least some subset of theories ( i.e. , inflation ) and some subset of cmb experiments , exact likelihood functions can be written down . in these cases , at least , the rest of the problem is implementation : the numerical calculation of the probability distribution of the interesting parameters given the data .",
    "we model a measurement of the cmb as @xmath1 where @xmath2 is the data at time @xmath3 , @xmath4 is the beam - smeared temperature at pixel @xmath5 ( pointed at by unit vector @xmath6 ) , @xmath7 is the pointing operator such that @xmath8 when pixel @xmath5 is observed at time @xmath9 , and @xmath10 is the noise at time @xmath9 .",
    "the noise is characterised by its distribution , for our purposes assumed to be a gaussian with covariance @xmath11    given the data , then , we first wish to solve for the sky temperature @xmath4 and its posterior distribution , and then use this map to determine the statistical properties of the cmb sky , such as its power spectrum , @xmath12 and its distribution , from which we will finally determine the underlying cosmological parameters .",
    "unfortunately , this implementation is indeed complicated in realistic cases .",
    "it is usually assumed that the error distribution for an experiment is somehow handed down to the theorists and data analysts by the experimenters , themselves with a direct link to some higher being who decides these things .",
    "of course this is not actually the case : instead , the error distribution itself must be estimated from the data along with the signal . in some ( not necessarily realistic ) cases , this is simple .",
    "if it were known _ a priori _ that the noise were gaussian and white , then @xmath13 and we could use the histogram of observations at a given pixel to estimate the noise variance @xmath14 .    in more realistic cases , the noise in the timestream will be correlated and contaminated by systematic problems and glitches such as cosmic rays , making any simple procedure like this infeasible in practice . in this paper we outline a self - consistent bayesian ( likelihood ) method for determining the noise power spectrum along with the cmb map .    given a map and its statistical distribution ( i.e. , the error matrix for gaussian noise ) , determining the power spectrum ( for the case of a gaussian cmb signal , as well ) has been well - studied ; problems remain in the implementation of efficient algorithms , but the ideal solution is known .",
    "in this paper , we also address the question of what to do next : how do we go from an estimate of the cmb fluctuation power spectrum , @xmath12 , to the underlying cosmological parameters ?",
    "because of the complicated ( non - gaussian ) nature of the likelihood function , we will show that simple @xmath15 techniques will necessarily bias the determination of the parameters , but will derive an ansatz for eliminating this bias .",
    "the plan of this paper is as follows .",
    "first , we discuss the cmb data - analysis pipeline from the standpoint of likelihood functions .",
    "then we address the specific problem of simultaneously determining the noise and signal from the timestream .",
    "finally , we address the problem of estimating parameters from the power spectrum .",
    "as has become customary , we start our analysis with bayes theorem @xmath16 where @xmath17 are the parameters we are trying to determine , @xmath18 is the data , and @xmath19 is the `` background information '' describing the problem .",
    "the quantity @xmath20 is thus the likelihood , the probability of the data given a specific set of parameters , @xmath21 is the prior probability for the parameters , and the left - hand side of the equation is the posterior probability for the parameters given the data .    as above and throughout , we will take the data , @xmath22 , as given by a time series of cmb measurements , @xmath23 where @xmath9 labels the time , @xmath24 , @xmath25 and @xmath10 are the experimental noise and sky signal contributions at that time .",
    "the signal is in turn given by the operation of a `` pointing matrix , '' @xmath7 on the sky signal at pixel @xmath5 , @xmath4 ( i.e. , the `` map '' ) ; we take the latter to be already pixelized and smeared by the experimental beam , so @xmath26 is a very sparse matrix with a single `` 1 '' entry for each time corresponding to the observed pixel . in the future we will often rely on the summation convention and write @xmath27 , or occasionally use matrix notation , as in @xmath28 , etc .",
    "we will assume that the observed noise @xmath10 is a realization of a stationary gaussian process with power spectrum @xmath29 .",
    "this means that the correlation matrix of the noise is given by @xmath30 the stationarity of the process requires ( or is defined by ) @xmath31 .",
    "most generally , we will take the parameters to be    * the observed cmb signal on the sky , @xmath4 ; * the power spectrum of the noise , @xmath29 * ( possibly ) any cosmological parameters which describe the distribution of the @xmath4 ( i.e. , the cmb power spectrum , @xmath12 , although we could also use the cosmological paramters such as @xmath32 and @xmath33 directly ) .",
    "sometimes , we will assign a prior distribution for the cmb signal such that the cosmological parameters will be irrelevent ; other times we will marginalize over the cmb signal itself and determine those parameters .    with these parameters and the data , @xmath22 ,",
    "bayes theorem becomes @xmath34 \\propto    p[\\tn|i ] \\ ; p(t_p , c_\\ell",
    "| i ) \\ ;   p[d_i | \\tn(\\omega ) , t_p , i].\\ ] ] here , we have used two pieces of information to simplify slightly . first , the noise power spectrum , @xmath35 does not depend at all on the signal , so we can separate out its prior distribution .",
    "second , given the noise power spectrum and the sky signal , the likelihood does not depend upon the cosmological parameters .",
    "for the gaussian noise we assume , the likelihood is simply @xmath36   \\nonumber\\\\    & = & \\ln \\left| n_{ii ' } \\right| +    \\sum_{ii ' } ( d_i - s_i)n^{-1}_{ii'}(d_{i'}-s_{i ' } ) = \\sum_k \\left [ \\ln \\tn_k +      |\\td_k-\\ts_k|^2/\\tn_k \\right]\\end{aligned}\\ ] ] ( ignoring an additive constant ) ; recall that @xmath37 .",
    "the second equality uses tildes to denote the discrete fourier transform at angular frequency @xmath38 ( see appendix and/or below  )",
    ".    we will now apply these general formulae to various cases .",
    "we will start with the simplest case , where we have complete prior knowledge of the noise power spectrum .",
    "this is the case that has been previously discussed in the literature , but we emphasize that it is very unrealistic !    we assign a delta - function prior distribution to @xmath39 , transforming it in effect from a parameter to part of the prior knowledge .",
    "first , we assume no cosmological information about the distribution of temperatures on the sky : @xmath40 ; with this separation the posterior for @xmath12 is simply the prior  the experiment gives us no new information .",
    "we will also assign a uniform prior to @xmath4 , lacking further information .",
    "now , the posterior distribution for the sky temperature is simply proportional to the likelihood , which can be rewritten by completing the square as @xmath41\\ ] ] with the mean ( also , the likelihood maximum ) given by @xmath42 ( in matrix notation ) , and the noise correlation matrix by @xmath43 occasionally , the inverse of this correlation matrix is referred to as the _ weight matrix_. as is usual for linear gaussian models , the mean is just the multidimensional least - squares solution to @xmath44 with noise correlation @xmath39 .",
    "this is just the mapmaking procedure advocated in refs .",
    "@xcite , cast into the form of a bayesian parameter - estimation problem .    for the case of known noise",
    ", however , this map is more than a just a visual representation of the data .",
    "even if we wish to determine the cosmological parameters , it is an essential quantity .",
    "we can write the prior for both the map and the spectrum as @xmath45 using the laws of probability , and so we can see that our rewriting of the likelihood in the form of eq .",
    "[ eq : maplike ] remains useful .",
    "that is , the full distribution is only a function of the data through the maximum - likelihood map , @xmath46in statistical parlance , @xmath46 is a _",
    "sufficient statistic_. thus for known noise , we can _ always _ start by making a map ( and calculating its noise matrix , @xmath47 ) .      here",
    ", we briefly examine the specific form of the signal prior , @xmath48 , motivated by simple gaussian models .",
    "that is , we take the sky temperature , @xmath4 , to be an actual realization of a gaussian cmb sky , with covariance specified by the power spectrum , @xmath12 , @xmath49 ( note that we include beam - smearing by a symmetric beam with spherical harmonic transform @xmath50 in this definition ) ; @xmath51 gives the cosine of the angle between the pixels . with this covariance ,",
    "the prior becomes @xmath52.\\ ] ] we thus have a posterior distribution for @xmath4 and @xmath12 which is the product of two gaussians . in the usual cosmological likelihood problem",
    ", we do nt care about the actual sky temperature _ per se _ , but are concerned with the @xmath12 ( or the parameters upon which the power spectrum depends ) .",
    "thus , we can marginalize over the @xmath4 , @xmath53\\end{aligned}\\ ] ] where we have incuded a prior for the power spectrum itself , so we can write the gaussian factor as the likelihood for the map given @xmath12 , @xmath54 .",
    "the equation defines the effective likelihood for the map ( @xmath46 , now considered as the data rather than the timestream itself , @xmath55 ) , which is easily computed again by completing the square , giving @xmath56.\\ ] ] this is just the usual cmb likelihood formula : the `` observed map , '' @xmath57 , is just the sum of two quantities ( noise and signal ) distributed as independent gaussians .",
    "note again that the data only enters through the maximum likelihood map , @xmath46 , although that calculation is only implicit in this formula .",
    "further , the power spectrum @xmath12 only enters through the signal correlation matrix , @xmath58 , and in a very nonlinear way .",
    "we can also play a slightly different game with the likelihood .",
    "if we retain the gaussian prior for the cmb temperature but _ fix _ the cmb power spectrum , we can estimate the map with this additional prior knowledge . we will again be able to complete the square in the exponential and see that @xmath4 is distributed as a gaussian : @xmath59\\ ] ] with @xmath60 now , the mean is given by @xmath61 which is just the _ wiener filter _ !",
    "it has correlation matrix given by @xmath62 note that the maximum - likelihood map , @xmath46 still appears in these formulae , but it is no longer the maximum of the _ posterior _ distribution , now given by the wiener filter , @xmath63 .",
    "this subsection has shown how many of the usual cmb data calculations can be seen as different uses of the bayesian formalism :    * the least - squares map ( seeing it as a `` sufficient statistic '' ) , * the cmb cosmological - parameter likelihood function , and * the wiener filter map of the cmb signal .",
    "the differences depend on what quantity is estimated ( the map or the power spectrum ) and what prior information is included .",
    "we now turn to the ( realistic ! ) case where the noise covariance of the experiment are not known prior to receiving the data .",
    "that is , we must use the data itself to estimate the noise properties .",
    "the previous subsection briefly outlined the bayesian approach to cmb statistics , assuming a known noise power spectrum .",
    "now , we will relax this assumption and approach the more realistic case when we must estimate both the experimental noise and the anisotropy of the cmb .",
    "we will take as our model a noise power spectrum of amplitude @xmath64 in bands numbered @xmath65 , with a shape in each band given by a fixed function @xmath66 with a width of @xmath67 ( the number of discrete modes in the band ) ; we will usually take @xmath68 so @xmath69 is piecewise constant .",
    "that is , @xmath70    we again assign a constant prior to the sky map , @xmath4 .",
    "as the prior for the noise we will take @xmath71 with @xmath72 and a single band , this is the usual jeffereys prior advocated for `` scale parameters '' and the units on @xmath73 are irrelevent . with this model and priors , the joint likelihood for the noise and",
    "the map becomes @xmath74 \\nonumber\\\\    & = &   \\prod_\\alpha    { 1\\over\\bn_\\alpha^{\\nu+n_\\alpha/2 } }     \\exp\\left [ -{1\\over2\\bn_\\alpha }      \\sum_{k\\in\\alpha}\\frac{1}{p_k}\\left|\\teps_k\\right|^2\\right]\\end{aligned}\\ ] ] where @xmath75 refers to a sum over modes in band @xmath65 .",
    "we also define the estimate of the noise as @xmath76 for future use",
    ".    we can simultaneously solve for the maximum - probability noise and signal .",
    "carrying out the derivatives gives @xmath77\\nonumber\\\\ & = & ( d - at)^t n^{-1 } a = \\varepsilon^t n^{-1 } a\\end{aligned}\\ ] ] ( switching between indices in fourier space and matrix notation ) and @xmath78\\ ] ] setting these to zero and solving , we then find me must simultaneously satisfy @xmath79 ( using matrix notation for simplicity ) and @xmath80 equation  [ eq : maxlmap ] is just the usual maximum - likelihood map solution ; equation  [ eq : maxlnoise ] is the average `` periodogram '' of the noise over the band @xmath65 , with a slight modification for the prior probability , parameterized by @xmath81 ; for wide bands this is irrelevant . as we will see below",
    ", iteration is actually a very efficient way to solve these simulataneously . for future reference",
    ", we also write down the derivative with respect to the map at the joint maximum ( i.e. , substituting eq .",
    "[ eq : maxlnoise ] into eq .",
    "[ eq : tpderiv ] ) , @xmath82\\ ] ]    if we fix the noise at the joint maximum , then the problem reduces to that of the previous section , a gaussian likelihood in @xmath4 with which the usual tools can be applied .",
    "this is not a rigorous approach to the problem , however due to correlation between noise and signal estimation . to get a handle on this",
    ", we calculate the curvature of the distribution around this joint maximum , which we define as @xmath83 where a subscript @xmath65 or @xmath5 refers to a derivative with respect to @xmath64 or @xmath4 , respectively .",
    "@xmath84 refers to the full matrix ; @xmath85 to the sub - blocks .",
    "explicitly , the parameter derivatives are @xmath86 and @xmath87 with the cross - curvature @xmath88    the distribution about the joint maximum is _ not _ a gaussian in the @xmath64 directions , so there is more information available than this .",
    "nonetheless , if we treat the distribution as if it were gaussian , we can calculate the covariance matrix , given by the inverse of this curvature matrix : @xmath89\\ ] ] in particular , the effective variance of the map is increased from @xmath47 to @xmath90^{-1}\\end{aligned}\\ ] ] which we have evaluated at the simultaneous peak of the distribution to eliminate @xmath64 .    in ref .",
    "@xcite , we examine this correction to @xmath91 ( the weight matrix ) more closely ; for sufficiently wide bands , relative to the number of pixels in the map , the correction is negligeable .      instead of this joint solution , formally ,",
    "at least , we know the appropriate procedure : marginalize over the quantity we do nt care about ( the noise power spectrum ) to obtain the distribution for the quantity we wish to know ( the map , @xmath4 ) . we can actually carry out this integral in this case : @xmath92^{-(n_\\alpha/2+\\nu-1)}\\ ] ] ( this is just student s t distribution in a slightly different form than is usually seen ) .",
    "if we stay in fourier space , the maximum of this distribution can be calculated to be the solution of @xmath93\\ ] ] note that this is _ exactly the same form _ as eq .",
    "[ eq : maxltpderiv ] , the equation for the maximum probability map in the joint estimation case , with the prefactor @xmath94 replaced by @xmath95 .",
    "this is equivalent to changing the exponent of the prior probability from @xmath81 to @xmath96 : the marginalized maximum for @xmath72 ( jefferys prior ) is the same as the joint maximum for @xmath97 ( constant prior ) .",
    "we have also seen that for @xmath98 , the value of @xmath81 is irrelevent , so that these should be nearly equal .",
    "( moreover , the numerical tools to calculate the joint solution , outlined below , can be used in this case , too . ) note also that if @xmath99 , the equation is nt solved for any ( finite ) map . in this case , either our prior information is so unrestrictive or the bands are so narrow that it is impossible to distinguish between noise and signal , and the probability distribution has no maximum when the noise is marginalized .    in principle , any further analysis of the map would have to rely on the full distribution of eq .",
    "[ eq : noisemarg ] . in practice ,",
    "the t - distribution is quite close to a gaussian [ again , for @xmath98is this right ? ] ( although the tails are suppressed by a power - law rather than an exponential ) .",
    "it will thus be an excellent approximation to take the distribution to be a gaussian @xmath100\\ ] ] with noise covariance given by @xmath101\\ ] ] where @xmath46 is the solution to eq .",
    "[ eq : margmax ] and the derivatives are taken with respect to the _ full _ distribution of eq .  [ eq : margmax ] ) .",
    "note that the inverse of @xmath102 ( the weight matrix ) is given again by the sum of two terms .",
    "the first is just the weight matrix that would be assigned given the maximum probability solution for the noise , eq .",
    "[ eq : noisecorr ] ( with the numerically irrelevent change of the prior @xmath103 as noted above ) .",
    "again we find a correction term due to the fact that we are only able to _ estimate _ this noise power spectrum , where the correction has exactly the same form as in the non - marginalized case ( eq .  [ eq : effectivevar ] ) above with a change of the prefactor .    in ref .",
    "@xcite , we show how the simultaneous solution for noise and map can be performed iteratively .",
    "as we have shown , this is also the solution for the case when the noise is marginalized over .",
    "happily , the bottom line of this analysis is that the mapmaking phase of cmb data analysis can proceed as has been discussed by other authors in the past .",
    "we do recommend two slight additions to the pipeline :    * iterative map & noise determination 1 .",
    "start by assuming the data stream is all noise .",
    "2 .   calculate the noise power spectrum via fft .",
    "inverse fft , and use this noise matrix for mapmaking 4 .",
    "subtract the estimated signal contribution from the map , and repeat . *",
    "calculate the correction to the noise matrix ( eq .  [ eq : cneff ] ) ( and either use the correction or make sure it is negligeable ) .",
    "we note that it is only necessary to solve for the map itself during the iterative process , but not to invert the inverse noise matrix , @xmath104 .",
    "the former can , in principle , be accomplished in far fewer operations than a matrix inverse , so the iterative procedure need not add a great amount of computing time to the process .    however , it is conventional wisdom that an ideal observational strategy has signal to noise of unity . in this regime ,",
    "the signal to noise _ in the timestream _ is very low , and a good aproximation to the estimator of the noise power spectrum is the banded periodogram of the data stream itself .",
    "thus one is able to avoid the time - consuming process of performing multiple iterations .",
    "above , we discussed how to make a map of the cmb and estimate its noise properties .",
    "elsewhere , the estimation of the cmb anisotropy power spectrum ( @xmath12 ) from a map and its noise estimate have been described and implemented at least for data sets of moderate size .",
    "but the ultimate goal , of course , is to go from the power spectrum to the cosmological parameters .",
    "various groups @xcite have calculated how well future experiments are expected to perform ; here , we describe what is necessary to begin to achieve such results .",
    "the basic problem is that a plot power spectrum estimates and associated errors do not suffice to describe the likelihood function of the experiment .",
    "usually , we plot @xmath105 and are tempted to do a @xmath15 procedure using those errors and possibly covarinaces between @xmath106 to fit theoretical curves to the estimates . as we have seen above ,",
    "however , the shape of the likelihood as a function of the @xmath12 is not gaussian , implicitly assumed in the use of a @xmath15 procedure .",
    "one solution is simply to use a full likelihood - minimization procedure on the cosmological parameters given the entire dataset .",
    "that is , evaluate eq .",
    "[ eq : maplikelihood ] directly for points throughout the cosmological parameter space ( over which @xmath12 and thereby the correlation matrix @xmath58 will vary ) .",
    "since all calculations of the likelihood function to date require @xmath107 operations in general , this is prohibitive for experiments of even moderate size ( especially if the likelihood must be searched over something like the 11-dimensional space appropriate for inflation - inspired models ) .    instead",
    ", we must find efficient ways to approximate the likelihood function based on minimal information . in the rest of this paper , we discuss approximations motivated by our knowledge of the likelihood function .",
    "each requires only knowledge of the likelihood peak and curvature ( or variance ) as well as a third quantity related to the noise properties of the experiment .",
    "alternately , for already - calculated likelihood functions , each approximation gives a functional form for fitting with a small number of parameters .",
    "we already know enough about the likelihood to see a solution to this problem . for a given multipole @xmath106 , there are two distinct regimes of likelihood . consider a simple all - sky experiment with uniform pixel noise and some symmetric beam .",
    "taking such a map as our data , we write @xmath108 which we transform to spherical harmonics , so the data has contributions from the signal , @xmath109 , and the noise , @xmath110 , and the likelihood is @xmath111\\ ] ] ( up to an irrelevant additive constant ; cf .",
    "[ eq : maplikelihood ] ) , with @xmath112 , where @xmath113 is the noise power spectrum in spherical harmonics , and @xmath114\\ \\sum_m |a_{\\ell m}|^2/(2\\ell+1)$ ] is the power spectrum of the full data ( noise plus beam - smoothed signal ) ; we have written it as a different symbol from above to emphasize the inclusion of noise and again use script lettering to refer to quantities multiplied by @xmath115 .",
    "now , the likelihood is maximized at @xmath116 and the curvature about this maximum is given by @xmath117 so the error ( defined by the variance ) on a @xmath118 is @xmath119    note that in this expression there is once again indication of a bias if we assume gaussianity : upward fluctuations have larger uncertainty than downward fluctuations . but this is not true for @xmath120 where @xmath120 is defined so that @xmath121 .",
    "more precisely , @xmath122 .",
    "since @xmath123 is proportional to a constant , our approximation to the likelihood is to take @xmath120 as normally distributed .",
    "that is , we approximate @xmath124 ( up to a constant ) where @xmath125 where @xmath126 is the covariance matrix of the @xmath118 , usually taken to be the inverse of the curvature matrix .",
    "we refer to eq .",
    "[ eq : gausslike ] as the offset lognormal distribution of @xmath118 .",
    "somewhat more generally we write @xmath127 for some constant @xmath128 , which for the case in hand is @xmath129 .",
    "it is illustrative to derive the quantity @xmath120 in a somewhat more abstract fashion .",
    "we wish to find a change of variables from @xmath118 to @xmath120 such that the curvature matrix is a constant : @xmath130 that is , we want to find a change of variables such that @xmath131 is not a function of @xmath132 .",
    "we immediately know of one such transformation which would seem to do the trick : @xmath133 where the @xmath134 indicates a cholesky decomposition or hermitian square root . in general",
    ", this will be a horrendously overdetermined set of equations , @xmath135 equations in @xmath39 unknowns .",
    "however , we can solve this equation in general if we take the curvature matrix to be given everywhere by the diagonal form for the simplified experiment we have been discussing ( eq .",
    "[ eq : fullcurv ] ) . in this case , the equations decouple and lose their dependence on the data , becoming ( up to a constant factor ) @xmath136 the solution to this differential equation is just what we expected , @xmath137 with correlation matrix @xmath138 where @xmath139 and @xmath140 .",
    "please note that we are calculating a constant correlation matrix ; the @xmath118 in the denominator of this expression should be taken at the peak of the likelihood ( i.e. , the estimated quantities ) .",
    "we emphasize that , even for an all - sky continuously and uniformly sampled experiment ( for which eq .",
    "[ eq : fullcurv ] is exact ) , this gaussian form , eq .",
    "[ eq : gausslike ] , is only an approximation , since the curvature matrix is given by eq .",
    "[ eq : fullcurv ] only at the peak .",
    "nonetheless we expect it to be a better approximation than a naive gaussian in @xmath118 ( which we note is the limit @xmath141 of the offset lognormal ) .",
    "we have also considered another ansatz known as the equal variance approximation which we have found sometimes reproduces the shape of the likelihood better than the offset lognormal form above , especially in the case of upper limits on @xmath12 .      in the above",
    ", we have derived the extra quantity needed in this ansatz , @xmath142 , but this was explicitly done only for the unrealistic case of an experiment looking at the whole sky with uniform noise , with a likelihood function eq .",
    "[ eq : fullskylike ] .",
    "can we generalize this to more complicated experiments , which have the more complicated likelihood function eq .",
    "[ eq : maplikelihood ] , with correlation matrices encoding such effects as    * nonuniform noise ; * correlated noise ; * incomplete sky coverage ; and/or * complicated chopping schemes ?",
    "happily , the answer to this question is that we can , and have succesfully applied the results to experiments as diverse as cobe / dmr and saskatoon .    for a map with noise correlation matrix @xmath47 , and signal correlation matrix @xmath58 , we generalize our definition of @xmath143 to @xmath144 where we use @xmath145 to label bands of @xmath106 rather than individual multipoles , so that @xmath118 has a fixed shape in each band with amplitude @xmath146 and @xmath147 is the derivative of the signal correlation matrix with respect to the power in the band .",
    "the second expression would be appropriate for a full - sky experiment where the signal and noise separate in the traces ; it may be numerically easier to calculate due to zero or negative eigenvalues in @xmath58 that often appear due to approximation .",
    "other expressions that may be more appropriate for particular experimental strategies are given in ref .",
    "@xcite .      because exact likelihoods have been calculated for many different experiments to date",
    ", we can check this ansatz in great detail .",
    "( in the future , this will probably be impossible because the exact calculation of the likelihood is so expensive that other techniques for finding the maximum will be necessary@xcite . )",
    "first , we compare with the likelihood for cobe / dmr at several values of @xmath106 . in fig .",
    "[ fig : dmrlike ] we show the actual likelihood for the cobe quadrupole and other multipoles , along with the gaussian that would be assumed given the curvature matrix calculated from the data .",
    "the figures show another way of understanding the bias introduced by assuming gaussianity : upward deviations from the mean ( which is not actually the mean of the non - gaussian distribution , but the mode ) are overly disfavored by the gaussian distributions while downward ones are overly probable .",
    "for example , the standard - cdm value of @xmath148 is only 0.2 times less likely than the most likely value of @xmath149 but it seems like a 5-sigma excursion ( @xmath150 times less likely ) based on the curvature alone .",
    "although it is extremely pronounced in the case of the quadrupole this is a problem that plagues all cmb data : the actual distribution is skewed to allow larger positive excursions than negative .",
    "the full likelihood `` knows '' about this and in fact takes it into account ; however , if we compress the data to observed @xmath151 ( or even observed @xmath118 and a correlation matrix @xmath152 ) we lose this information about the shape of the likelihood function . because of its relation to the well - known phenomenon of cosmic variance , we choose to call this problem one of _ cosmic bias_.    we emphasize that cosmic bias can be important even in high - s / n experiments with many pixels .",
    "we might expect the central limit theorem to hold in this case and the distributions to become gaussian .",
    "indeed they do , at least near the peak .",
    "however , the central limit theorem does not guarantee that the tails of the distribution will be gaussian and there is the danger that a few seemingly discrepant points are given considerably more weight than they deserve .",
    "cosmic bias has also been noted in previous work @xcite .",
    "putting the problem a bit more formally , we see that even in the limit of infinite signal - to - noise we can not use a simple @xmath15 test on @xmath118 estimates ; such a test implicitly assumes a gaussian likelihood . unlike the distribution discussed here",
    ", a gaussian would have constant curvature ( @xmath153 ) , rather than @xmath154 as illustrated here .",
    "we apply this ansatz to the saskatoon experiment , perhaps the apotheosis of a complicated chopping experiment .",
    "the saskatoon data are reported as complicated chopping patterns ( _ i.e. _ , beam patterns , @xmath155 , above ) in a disk of radius about @xmath156 around the north celestial pole . the data were taken over 1993 - 1995 ( although we only use the 1994 - 1995 data ) at an angular resolution of @xmath157@xmath158 fwhm at approximately 30  ghz and 40  ghz .",
    "more details can be found in refs .",
    "@xcite . the combination of the beam size , chopping pattern , and sky coverage mean that saskatoon is sensitive to the power spectrum over the range @xmath159@xmath160 .",
    "the saskatoon dataset is calibrated by observations of supernova remnant , cassiopeia  a .",
    "leitch and collaborators@xcite have recently measured the flux and find that the remnant is 5% brighter than the previous best determination .",
    "we have renormalized the saskatoon data accordingly .",
    "we calculated @xmath118 for this dataset in @xcite .",
    "we combine these results with the data s noise matrix to calculate the appropriate correlation matrixes ( in this case , the full curvature matrix ) for saskatoon and hence the appropriate @xmath161 ( eq .  [ eq : getxb ] ) and thus our approximations to the full likelihood . in figure",
    "[ fig : sklike ] , we show the full likelihood , the naive gaussian approximation , and our present offset lognormal and equal - variance forms .",
    "again , both approximations reproduce the features of the likelihood function reasonably well , even into the tails of the distribution , certainly better than the gaussian approximation .",
    "they seem to do considerably better in the higher-@xmath106 bands ; even in the lower @xmath106 bands , however , the approximations result in a _ wider _ distribution which is preferable to the narrower gaussian and its resultant strong bias .",
    "moreover , we have found that we are able to reproduce the shape of the true likelihood essentially perfectly down to better than `` three sigma '' if we simply _ fit _ for the @xmath161 ( but of course this can only be done when we have already calculated the full likelihood  precisely what we are trying to avoid ! ) . for existing likelihood calculations",
    ", this method can provide better results without any new calculations ( see @xcite for our recommendations for the reporting of cmb bandpower results for extant , ongoing , and future experiments ) .",
    "we have found that the shape of the power spectrum used with each bin of @xmath106 can have an impact on the likelihood function evaluated using this ansatz .",
    "similarly , a finer binning in @xmath106 will reproduce the full likelihood more accurately .",
    "although the maximum - likelihood amplitude at a fixed shape ( @xmath162 ) does not significantly depend on binning or shape , the shape of the likelihood function along the maximum - likelihood ridge changes with finer binning and with the assumed spectral shape .      as a further example and test of these methods",
    ", we can combine the results from saskatoon and cobe / dmr in order to determine cosmological parameters .",
    "for this example , we use the orthogonal linear combinations as described in the previous section . in figure  [ fig : dmrskcontours ] we show the likelihood contours for standard cdm , varying the scalar slope @xmath162 and amplitude @xmath163 . as before",
    ", we see that the naive @xmath15 procedure is biased toward low amplitudes at fixed shape ( @xmath162 ) , but that our new approximation recovers the peak quite well .",
    "the full likelihood gives a global maximum at @xmath164 , and our approximation at @xmath165 , while the naive @xmath15 finds it at @xmath166 , outside even the three - sigma contours for the full likelihood .",
    "we can also marginalize over either parameter , in which case the full likelihood gives @xmath167 , @xmath168 ; our ansatz gives @xmath169 , @xmath170 ; and the naive @xmath15 gives @xmath171 , @xmath172 .",
    "( note that even with the naive @xmath15 we marginalize by explicit integration , since the shape of the likelihood in parameter space is non - gaussian in all cases . )      above , we have discussed many different approximations to the likelihood @xmath173 . here",
    "we discuss finding the parameters that maximize this likelihood ( minimize the @xmath174 ) .",
    "we then apply our methods to estimating the power in discrete bins of @xmath106 .",
    "this application provides another demonstration of the importance of using a better approximation to the likelihood than a gaussian .",
    "the likelihood functions above depend on @xmath175 which may in turn depend on other parameters , @xmath176 , which are , e.g. , the physical parameters of a theory . if we write the parameters as @xmath177 we can find the correction , @xmath178 , that minimizes @xmath15 by solving @xmath179 where @xmath180 is the curvature matrix for the parameters @xmath176 . if the @xmath15 were quadratic ( i.e. , gaussian @xmath173 ) then eq .",
    "[ eq : quadest ] would be exact . otherwise , in most cases , near enough to its minimum , @xmath15 is approximately quadratic and an iterative application of eq .",
    "[ eq : quadest ] converges quite rapidly .",
    "the covariance matrix for the uncertainty in the parameters is given by @xmath181 .",
    "this is just an approximation to the newton - raphson technique for finding the root of @xmath182 ; a similar techniqe is used in quadratic estimation of @xmath118 @xcite .",
    "as our worked example here , we parameterize the power spectrum by the power in @xmath183 to @xmath184 bins , @xmath146 . within each of the bins , we assume @xmath185 to be independent of @xmath106 .",
    "we have chosen the offset lognormal approximation .",
    "the @xmath15 completely describes the model : @xmath186 where @xmath187 is the weight matrix for the band powers @xmath188 .",
    "we have modeled the signal contribution to the data , @xmath188 , as an average over the power spectrum , @xmath189 , times a calibration parameter , @xmath190 . for simplicity",
    ", we take the prior probability distribution for this parameter to be normally distributed . since the datasets have already been calibrated , the mean of this distribution is at @xmath191 .",
    "the calibration parameter index , @xmath65 is a function of @xmath9 since different power spectrum constraints from the same dataset all share the same calibration uncertainty .",
    "we solve simultaneously for the @xmath192 and @xmath146 ; i.e. , together they form the set of parameters , @xmath176 , in eq .",
    "[ eq : quadest ] . for those experiments reported as band - powers together with the trace of the window function , @xmath193 ,",
    "the filter is taken to be @xmath194 for saskatoon and cobe / dmr , our @xmath188 are themselves estimates of the power in bands . for these cases",
    "the above equation applies , but with @xmath195 set to a constant within the estimated band and zero outside .",
    "the estimated bands have different @xmath106 ranges than the target bands .    instead of the curvature matrix of eq .",
    "[ eq : chi2curv ] we use an approximation to it that ignores a logarithmic term . including",
    "this term can cause the curvature matrix to be non - positive definite as the iteration proceeds .",
    "the approximation has no influence on our determination of the best fit power spectrum , but does affect the error bars .",
    "we expect that the effect is quite small .",
    "we now proceed to find the best - fit power spectrum given different assumptions about the value of @xmath196 , binnings of the power spectrum and editings of the data .",
    "we have determined the @xmath196 only for cobe / dmr , saskatoon , sp89 , ovro7 and suzie . to test the sensitivity to the unknown @xmath196s we found the minimum-@xmath15 power spectrum assuming the two extremes of @xmath197 ( corresponding to lognormal ) and @xmath198 ( corresponding to gaussian ) .",
    "these two power spectra are shown in fig .",
    "[ fig : lnclvscl ] . note that both power spectra were derived using our measured @xmath196 values ; only the unknown @xmath196 values were varied .",
    "the variation in the results would be much greater if we let these @xmath196 values be at their extremes .",
    "in this proceedings , we have discussed the beginning and end of the cmb data - analysis process , and shown how they can be unified in a bayesian likelihood formalism .",
    "we have introduced new techniques and approximations that    * allow simultaneous calculation of the noise properties and underlying sky map . *",
    "approximate the full cosmological likelihood function with minimal information .",
    "crucially , both of these innovations can be calculated in relatively small or comparable amounts of time to the most computationally - challenging aspects of the problem .",
    "hence , they await the same innovations necessary to perform these calculations in the first place for upcoming megapixel datasets@xcite .",
    "ahj would like to thank mike seifert , julian borrill , the combat collaboration , and the saskatoon , maxima and boomerang teams for many helpful conversations during the course of this research .",
    "ahj acknowledges support by nasa grants nag5 - 6552 and nag5 - 3941 and by nsf cooperative agreement ast-9120005 .",
    "wright , e.l , astro - ph/9612105 .",
    "tegmark , m. _ astroph .",
    "jour . _ * 455 * , 1 ( 1996 ) ; tegmark , m. , 4514 ( 1997 ) .",
    "ferreira , p.g . & jaffe , a.h .",
    ", in preparation ( 1999 ) .",
    "see , e.g. , eisenstein , d.j . , hu , w. & tegmark , m. 1998 astro - ph/9807130 ; efstathiou & bond , 1998 , astro - ph/9807103 .",
    "bond , j.r . ,",
    "jaffe , a.h . & knox , l.e .",
    ", _ astrophys .",
    "j. _ , submitted ( 1999 ) .",
    "bond , j.r . ,",
    "crittenden , r.c . ,",
    "jaffe , a.h . & knox , l.e .",
    ", _ computers in science & engineering _ , invited review ( 1999 ) and references therein .",
    "bond , j.r . ,",
    "jaffe , a.h . & knox , l.e .",
    ", , 2117 ( 1998 ) and references therein .",
    "seljak , u.  1997 , astro - ph/9710269 .",
    ", spergel , d.n . , and hinshaw , g.  1998 , astro - ph/9805339 .",
    "netterfield , c.b . ,",
    "devlin , m.j .",
    ", jarosik , n. , page , l. , and wollack , e.j .",
    "1997 , , 474 , 47 .",
    "wollack , e.j . ,",
    "devlin , m.j .",
    ", jarosik , n. , netterfield , c.b . , page , l. , and wilkinson , d.  1997 , , 476 , 440 .",
    "leitch , e.  1998 , caltech phd .  thesis .",
    "tegmark , m.  1997 , , 5895 ; astro - ph/9611174 ."
  ],
  "abstract_text": [
    "<S> although the broad outlines of the appropriate pipeline for cosmological likelihood analysis with cmb data has been known for several years , only recently have we had to contend with the full , large - scale , computationally challenging problem involving both highly - correlated noise and extremely large datasets ( @xmath0 ) . in this </S>",
    "<S> talk we concentrate on the beginning and end of this process . </S>",
    "<S> first , we discuss estimating the noise covariance from the data itself in a rigorous and unbiased way ; this is essentially an iterated minimum - variance mapmaking approach . </S>",
    "<S> we also discuss the unbiased determination of cosmological parameters from estimates of the power spectrum or experimental bandpowers . </S>"
  ]
}