{
  "article_text": [
    "for a number of years , the fast multipole method ( fmm ) @xcite has been the method of choice for applying integral operators to functions in dimensions @xmath3 . on the other hand ,",
    "multiresolution algorithms in wavelet and multiwavelet bases introduced in @xcite for the same purpose were not efficient enough to be practical in more than one dimension .",
    "recently , with the introduction of separated representations @xcite , practical multiresolution algorithms in higher dimensions @xcite became available as well . in this paper",
    "we present a new fast , adaptive algorithm for applying a class of integral operators with radial kernels in dimensions @xmath4 , and we briefly discuss its extension to higher dimensions .    in physics , chemistry and other applied fields , many important problems may be formulated using integral equations , typically involving green s functions as their kernels",
    ". often such formulations are preferable to those via partial differential equations ( pdes ) .",
    "for example , evaluating the integral expressing the solution of the poisson equation in free space ( the convolution of the green s function with the mass or charge density ) avoids issues associated with the high condition number of a pde formulation .",
    "integral operators appear in fields as diverse as electrostatics , quantum chemistry , fluid dynamics and geodesy ; in all such applications fast and accurate methods for evaluating operators on functions are needed .",
    "the fmm and our approach both employ approximate representations of operators to yield fast algorithms .",
    "the main difference lies in the type of approximations that are used .",
    "for example , for the poisson kernel @xmath5 in dimension @xmath6 , the fmm @xcite uses a plane wave approximation starting from the integral @xmath7 where @xmath8 .",
    "the elegant approximation derived from this integral in @xcite is valid within a solid angle , and thus requires splitting the application of an operator into directional regions ; the number of such regions grows exponentially with dimension . for the same kernel ,",
    "our approach starts with the integral @xmath9 and its discretization with finite accuracy @xmath10 yields a spherically symmetric approximation as a weighted sum of gaussians .",
    "other radial kernels can be similarly treated by a suitable choice of integrals .",
    "the result is a separated representation of kernels and , therefore , an immediate reduction in the cost of their application .",
    "this difference in the choice of approximation dictates the differences in the corresponding algorithms . in dimension @xmath3",
    "both approaches are practical and yield comparable performance .",
    "the key advantage of our approach is its straightforward extensibility to higher dimensions @xcite .",
    "given an arbitrary accuracy @xmath10 , we effectively represent kernels by a set of exponents and weights describing the terms of the gaussian approximation of integrals like in ( [ eq : kernel_integral ] ) .",
    "the number of terms in such sum is roughly proportional to @xmath11 , or a low power of @xmath11 , depending on the operator .",
    "since operators are fully described up to an accuracy @xmath10 by the exponents and weights of the sum of gaussians , a single algorithm applies all such operators .",
    "these include operators such as @xmath0 , where @xmath1 and @xmath2 , and certain singular operators such as the projector on divergence - free functions .",
    "since many physically significant operators depend only on the distance between interacting objects , our approach is directly applicable to problems involving a wide class of operators with radial kernels .",
    "we combine separated and multiresolution representations of kernels and use multiwavelet bases @xcite that provide _",
    "inter alia _ a method for discretizing integral equations , as is the case in quantum chemistry @xcite .",
    "this choice of multiresolution bases accommodates integral and differential operators as well as a wide variety of boundary conditions , without degrading the order of the method @xcite .",
    "multiwavelet bases retain the key desired properties of wavelet bases , such as vanishing moments , orthogonality , and compact support . due to the vanishing moments ,",
    "wide classes of integro - differential operators have an _ effectively sparse _ matrix representation ,",
    "i.e. , they differ from a sparse matrix by an operator with small norm .",
    "some of the basis functions of multiwavelet bases are discontinuous , similar to those of the haar basis and in contrast to wavelets with regularity ( see e.g. @xcite ) .",
    "the usual choices of scaling functions for multiwavelet bases are either the scaled legendre or interpolating polynomials .",
    "since these are also used in the discontinuous galerkin and discontinuous spectral elements methods , our approach may also be seen as an adaptive extension of these methods .",
    "the algorithm for applying an operator to a function starts with computing its adaptive representation in a multiwavelet basis , resulting in a @xmath12-tree with blocks of coefficients at the leaves",
    ". then the algorithm adaptively applies the ( modified ) separated non - standard form @xcite of the operator to the function by using only the necessary blocks as dictated by the function s tree representation .",
    "we note that in higher dimensions , @xmath13 , functions need to be in a separated representation as well , since the usual constructions via bases or grids are prohibitive ( see @xcite ) .",
    "we start in section  [ sec : preliminary - considerations ] by recalling the basic notions of multiresolution analysis , non - standard operator form and adaptive representation of functions underlying our development .",
    "we then consider the separated representation for radially symmetric kernels in section  [ sec : separated - repr - kernels ] , and use it to efficiently extend the modified ns - form to multiple spatial dimensions in section  [ sec : modified - ns - form - nd ] .",
    "we pay particular attention to computing the band structure of the operator based on one dimensional information .",
    "we use this construction in section  [ sec : multidim - application - nsform ] to introduce the adaptive algorithm for application of multidimensional operators in the modified ns - form , and illustrate its performance in section  [ sec : numerical - examples ] .",
    "we consider two examples : the poisson equation in free space and the ground state of the hydrogen atom .",
    "we conclude with a brief discussion in section  [ sec : discussion - and - conclusions ] .",
    "this section and appendix are provided for the convenience of the reader in order to keep this paper reasonably self - contained .",
    "we provide background material and introduce necessary notation .",
    "the essence of our approach is to decompose the operator using projectors on a multiresolution analysis ( mra ) , and to efficiently apply its projections using a separated representation .",
    "we use the decomposition of the operator into the ns - form @xcite , but we organize it differently ( thus , _ modified _ ns - form ) to achieve greater efficiency .",
    "this modification becomes important as we extend this algorithm to higher dimensions .    in this section",
    "we introduce notation for mra , describe the adaptive representation of functions and associated data structures , introduce the modified ns - form and an algorithm for its adaptive application in dimension @xmath14 as background material for the multidimensional case .",
    "let us consider the multiresolution analysis as a decomposition of @xmath15^{d})$ ] into a chain of subspaces @xmath16 so that @xmath15^{d})=\\overline{\\cup_{j=0}^{\\infty}\\mathbf{v}_{j}}$ ] .",
    "we note that our indexing of subspaces ( increasing towards finer scales ) follows that in @xcite , and is the reverse of that in @xcite . on each subspace @xmath17",
    ", we use the tensor product basis of scaling functions obtained using the functions @xmath18 @xmath19 which we briefly describe in appendix .",
    "the wavelet subspaces @xmath20 are defined as the orthogonal complements of @xmath17 in @xmath21 , thus @xmath22    introducing the orthogonal projector on @xmath17 , @xmath23^{d})\\to\\mathbf{v}_{j}$ ] and considering an operator @xmath24^{d})\\to l^{2}([0,1]^{d})$ ] , we define its projection @xmath25 as @xmath26 .",
    "we also consider the orthogonal projector @xmath27^{d})\\to\\mathbf{w}_{j}$ ] , defined as @xmath28 .",
    "let us describe an adaptive refinement strategy for construction multiresolution representations of functions @xmath29 , where @xmath30^{d}$ ] .",
    "we proceed by recursive binary subdivision of the box @xmath31 , so the basic structure representing our functions is a @xmath32tree with arrays of coefficients stored at the leaves ( terminal nodes ) and no data stored on internal nodes . on each box",
    "obtained via this subdivision , our basis is a tensor product of orthogonal polynomials of degree @xmath33 in each variable , as described in appendix  [ sec : appendix ] .",
    "therefore , the leaves carry @xmath34-dimensional arrays of @xmath35 coefficients which may be used to approximate function values anywhere in the box corresponding to the spatial region covered by it , via ( [ eq : func_interp_1d ] ) or its equivalent for higher values of @xmath34 . for conciseness",
    ", we will often refer to these @xmath34-dimensional arrays of coefficients stored at tree nodes as _ function blocks_.",
    "this adaptive function decomposition algorithm is similar to that used in @xcite .",
    "such construction formally works in any dimension @xmath34 .",
    "however , since its complexity scales exponentially with @xmath34 , its practical use is restricted to fairly low dimension , e.g. @xmath36 . in higher dimensions ,",
    "alternate representation strategies for functions such as @xcite should be considered . in high dimensions ,",
    "these strategies deal with the exponential growth of complexity by using controlled approximations that have linear cost in @xmath34 .    for simplicity",
    ", we will describe the procedure for the one - dimensional case since the extension to dimensions @xmath37 is straightforward . since we can not afford to construct our representation by starting from a fine scale ( especially in @xmath6 ) , we proceed by successive refinements of an initial coarse sampling .",
    "this approach may result in a situation where the initial sampling is insufficient to resolve a rapid change in a small volume ; however , in practical applications such situations are rare and may be avoided by an appropriate choice of the initial sampling scale .",
    "let @xmath38 $ ] , @xmath39 represent a binary subinterval on scale @xmath40 .",
    "we denote by @xmath41 the vector of values of the function @xmath42 on the gaussian nodes in @xmath43 . from these values",
    "we compute the coefficients @xmath44 ( see ( [ eq : fvals2coefs ] ) in appendix ) and interpolate @xmath45 for any @xmath46 by using ( [ eq : func_interp_1d ] ) .",
    "we then subdivide @xmath43 into two child intervals , @xmath47 and @xmath48 , and evaluate the function @xmath42 on the gaussian nodes in @xmath47 and @xmath48 .",
    "we then interpolate @xmath42 by using the coefficients @xmath44 from their parent interval and denote by @xmath49 and @xmath50 the vectors of interpolated values on the two subintervals . now , if for a given tolerance @xmath10 either @xmath51 or @xmath52 , we repeat the process recursively for both subintervals , @xmath47 and @xmath48 ; otherwise , we keep the coefficients @xmath44 to represent the function on the entire interval @xmath43 .",
    "this interval then becomes a leaf in our tree .    at this stage",
    "we use the @xmath53 norm , thus constructing an approximation @xmath54 to the original function @xmath42 such that @xmath55 , which immediately implies that @xmath56 .",
    "this estimate clearly extends to any dimension .",
    "once the approximation with @xmath53 norm is constructed , the corresponding tree may be pruned if an application only requires the approximation to be valid in the @xmath57 norm .",
    "we start this process on the finest scale and simply remove all blocks whose cumulative contribution is below @xmath10 .",
    "other norms , such as @xmath58 can be accommodated by appropriately weighing the error tolerance with a scale - dependent factor in the initial ( coarse to fine ) decomposition process .",
    "the complete decomposition algorithm proceeds by following the above recipe , starting with an initial coarse scale ( typically @xmath59 ) and continuing recursively until the stopping criterion is met for all subintervals . in practice , we choose a stopping scale @xmath60 , beyond which the algorithm will not attempt to subdivide any further . reaching @xmath60",
    "means that the function has significant variations which are not accurately resolved over an interval of width @xmath61 using a basis of order @xmath62 .",
    "a pseudo - code listing of this process is presented as algorithm [ alg : function - decomposition ] .",
    "start at a coarse scale , typically @xmath59 .",
    "recursively , for all boxes @xmath63 on scale @xmath40 , proceed as follows :    construct the list @xmath64 of @xmath65 child boxes @xmath66 on scale @xmath67 .",
    "compute the values of the function @xmath68 at the @xmath69 gauss - legendre quadrature nodes in @xmath63 .    from @xmath68 , interpolate to the gauss - legendre quadrature nodes in @xmath66 , producing values @xmath70 .",
    "compute the values of @xmath71 at the gauss - legendre nodes of @xmath66 , by direct evaluation .",
    "recursively repeat the entire process for all boxes @xmath72 .",
    "the decomposition algorithm  [ alg : function - decomposition ] naturally leads to a tree data structure to represent functions , with the leaves of the tree corresponding to the spatial intervals over which the multiwavelet basis provides a sufficiently accurate local approximation . by using ( [ eq : func_interp_1d ] ) or its higher - dimensional extensions , the only data needed to approximate @xmath45 anywhere in @xmath31 is the array of basis coefficients on these leaves .",
    "thus we use a tree structure where the leaves store these coefficients and the internal nodes do not contain any data ( and are effectively removed since we use hash tables for storage ) .",
    "we will refer to this structure as an _ adaptive tree .",
    "_ each level in the tree corresponds to a scale in the mra , with the root node corresponding to the coarsest projection @xmath73 .",
    "now , in order to apply the modified non - standard form of an operator to a function , we will show in the next section that we also need the basis coefficients corresponding to internal nodes of the tree .",
    "hence , from the adaptive tree data structure we will compute a similar tree but where we do keep the coefficients of scaling functions on _ all _ nodes ( leaves and internal ) .",
    "the coefficients on the internal nodes are redundant since they are computed from the function blocks stored in the leaves",
    ". we will thus refer to the tree containing coefficients on all nodes as a _",
    "redundant tree_. it is constructed recursively starting from the leaves , by projecting the scaling coefficients from all sibling nodes onto their parent node , using the decomposition ( [ eq : decomp_scaling ] ) .    figure  [ fig : fun_trees ] shows both the adaptive and the redundant trees for a sample function .",
    "this figure displays the coarsest scales at the bottom and progressively finer ones further up , with filled boxes representing nodes where scaling coefficients are stored and empty boxes indicating nodes with no data in them ( these do not need to be actually stored in the implementation ) .      the non - standard form @xcite ( see also @xcite for the version specialized for multiwavelets ) of the operator @xmath74 is the collection of components of the telescopic expansion @xmath75 where @xmath76 , @xmath77 , and @xmath78 .",
    "the main property of this expansion is that the rate of decay of the matrix elements of the operators @xmath79 , @xmath80 and @xmath81 away from the diagonal is controlled by the number of vanishing moments of the basis and , for a finite but arbitrary accuracy @xmath10 , the matrix elements outside a certain band can be set to zero resulting in an error of the norm less than @xmath10 .",
    "such behavior of the matrix elements becomes clear if we observe that the derivatives of kernels of caldern - zygmund and pseudo - differential operators decay faster than the kernel itself .",
    "if we use the taylor expansion of the kernel to estimate the matrix elements away from the diagonal , then the size of these elements is controlled by a high derivative of the kernel since the vanishing moments eliminate the lower order terms @xcite .",
    "we note that for periodic kernels the band is measured as a periodic distance from the diagonal , resulting in filled - in ` corners ' of a matrix representation .",
    "let us introduce notation to show how the telescopic expansion ( [ eq : telescopic ] ) is used when applying an operator to a function .",
    "if we apply the projection of the operator @xmath82 not on its `` natural scale '' @xmath83 but on the finer scale @xmath40 , we denote its upsampled version as @xmath84 in the matrix representation of @xmath82 , this operation results in the doubling of the matrix size in each direction . this upsampling @xmath85 and downsampling @xmath86 notation",
    "will also be used for projections of functions .    with this notation ,",
    "computing @xmath87 via ( [ eq : telescopic ] ) splits across scales,@xmath88f_{1}\\nonumber \\\\",
    "\\hat{g}_{2 } & = & [ \\mathbf{t}_{2}-\\uparrow(\\mathbf{t}_{1})]f_{2}\\label{eq : g_scales}\\\\ \\ldots & \\ldots & \\ldots\\nonumber \\\\ \\hat{g}_{j } & = & [ \\mathbf{t}_{j}-\\uparrow(\\mathbf{t}_{j-1})]f_{j}\\nonumber \\\\ \\ldots & \\ldots & \\ldots\\nonumber \\end{aligned}\\ ] ] where @xmath89 .    as in the application of the usual ns - form in @xcite , to obtain @xmath90 after building the set @xmath91 we have to compute @xmath92 the order of the parentheses in this expression is essential , as it indicates the order of the actual operations which are performed starting on the coarsest subspace @xmath93 for example , if the number of scales @xmath94 then ( [ eq : g_assemble ] ) yields @xmath95 , describing the sequence of necessary operations .",
    "unfortunately , the sparsity of the non - standard form induced by the vanishing moments of bases is not sufficient for fast practical algorithms in dimensions other than @xmath14 . for algorithms in higher dimensions , we need an additional structure for the remaining non - zero coefficients of the representation .",
    "we will use separated representations ( see section  [ sec : separated - repr - kernels ] ) introduced in @xcite and first applied in a multiresolution setting in @xcite . within the retained bands ,",
    "the components of the non - standard form are stored and applied in a separated representation and , as a result , the numerical application of operators becomes efficient in higher dimensions .",
    "let us describe a one - dimensional construction for operators on @xmath15)$ ] to introduce all the features necessary for a multidimensional algorithm .",
    "since we use banded versions of operators , we need to introduce the necessary bookkeeping .",
    "the `` template '' for the band structure on scale @xmath40 comes from the band on the previous scale @xmath96 . for each block on scale",
    "@xmath96 , the upsampling operation @xmath97 creates four blocks ( all combinations of even / odd row and column indices ) .",
    "we insist on maintaining the strict correspondence between these four blocks and those of @xmath98 . for this reason the description of the retained blocks of @xmath98 involves the parity of their row and column indices .",
    "let us denote the blocks in the matrix representing @xmath98 by @xmath99 , where @xmath100 .",
    "individual elements within these blocks are indexed as @xmath101 where @xmath102 , and @xmath62 is the order of the multiwavelet basis . for a given width of the band @xmath103",
    "we keep the operator blocks @xmath99 with indices satisfying @xmath104    we denote the banded operators where we keep only blocks satisfying ( [ eq : fine_scale_band ] ) as @xmath105 and @xmath106 if we downsample the operator @xmath107 back to its original scale @xmath96 , then ( [ eq : fine_scale_band ] ) leads to the band described by the condition @xmath108 where @xmath109 denotes the integer part of @xmath110 we denote the banded operator on scale @xmath96 as @xmath111 , where we retain blocks satisfying ( [ eq : down_band ] ) .    if we now rewrite ( [ eq : g_scales ] ) _ keeping only blocks within the bands _ on each scale , we obtain@xmath112f_{1}=\\mathbf{t}_{1}^{b_{1}}f_{1}-\\uparrow(\\mathbf{t}_{0})^{b_{1}}f_{1}\\nonumber \\\\ \\hat{g}_{2 } & = & [ \\mathbf{t}_{2}^{b_{2}}-\\uparrow(\\mathbf{t}_{1})^{b_{2}}]f_{2}=\\mathbf{t}_{2}^{b_{2}}f_{2}-\\uparrow(\\mathbf{t}_{1})^{b_{2}}f_{2}\\label{eq : g_scales_band}\\\\ \\ldots & \\ldots & \\ldots\\nonumber \\\\ \\hat{g}_{j } & = & [ \\mathbf{t}_{j}^{b_{j}}-\\uparrow(\\mathbf{t}_{j-1})^{b_{j}}]f_{j}=\\mathbf{t}_{j}^{b_{j}}f_{j}-\\uparrow(\\mathbf{t}_{j-1})^{b_{j}}f_{j}\\nonumber \\\\ \\ldots & \\ldots & \\ldots\\nonumber \\end{aligned}\\ ] ]    for any arbitrary but finite accuracy , instead of applying the full @xmath113,$ ] we will only apply its banded approximation .",
    "a simple but important observation is that@xmath114f_{j})=\\mathbf{t}_{j-1}f_{j-1}\\,,\\label{eq : down_up}\\ ] ] which follows from the fact that @xmath115 since these are orthogonal projections .",
    "thus , we observe that @xmath116 so instead of applying @xmath117 on scale @xmath40 , we can obtain the same result using ( [ eq : down_up ] ) , so that @xmath118 .",
    "therefore , we will compute only @xmath119 on scale @xmath96 and combine it with computing @xmath120 . incorporating this into ( [ eq :",
    "g_assemble ] ) , we arrive at@xmath121\\right]\\ldots\\right.\\right]\\right].\\nonumber \\end{aligned}\\ ] ]    using this expression yields an efficient algorithm for applying an operator , as on each scale @xmath40 , @xmath122}$ ] is a sparse object , due to the cancellation which occurs for most of the blocks . in particular , @xmath122}$ ] is missing the blocks near the diagonal , and we will refer to it as an _ outer band matrix_. we will call @xmath105 a _ whole band matrix _ as it contains both the inner and outer bands .    modified non - standard form of the convolution operator in ( [ cotangetkernel ] ) in a multiwavelet basis , with white representing 0 and black representing large values .",
    "the top matrix is the projection of this operator on @xmath123 , resulting in a dense matrix .",
    "the lower half depicts the multiresolution representation in ( [ eq : apply_algo ] ) with only the blocks that are actually retained for a given accuracy .",
    "we will call the leftmost matrix in this series a _ whole band matrix _ and all others _ outer band matrices . _",
    "the two empty outer band matrices on scales @xmath124 are explained in the main text.,scaledwidth=80.0% ]    the structure of these matrices is illustrated in figure  [ fig : oper_bands_1d ] .",
    "the two empty scales @xmath124 arise due to the complete cancellation of blocks on these scales .",
    "we note that the modified non - standard form is constructed adaptively in the number of scales necessary for a given function . for just two scales",
    ", this construction will have the scale @xmath125 non - empty .",
    "given an adaptive decomposition of a function on @xmath126 scales , we precompute the modified non - standard form ( depicted in figure  [ fig : oper_bands_1d ] for five scales ) on all scales @xmath127 . for matrices requiring @xmath128 blocks on the finest scale @xmath126 , we need to keep and apply only @xmath129 blocks , as with the original non - standard form in @xcite .",
    "let us show how to use the multiscale representation in ( [ eq : apply_algo ] ) to apply the operator @xmath130 to a function @xmath42 with controlled accuracy @xmath10 .",
    "we describe an adaptive application of the operator to a function , where we assume ( as is often the case ) that the tree structure of the input is sufficient to adequately describe the output with accuracy @xmath10 .",
    "this assumption will be removed later .",
    "our algorithm uses the structure shown in figure  [ fig : oper_bands_1d ] in an adaptive fashion .",
    "we copy the structure of the redundant tree for the input function , and use that as a template to be filled for the output @xmath131 . for each node of the output tree",
    "we determine whether it is a leaf or an internal node : for leaves , we must apply a whole band _ _ _ _ matrix on the scale of that node , such as the leftmost matrix for @xmath132 in the example shown in figure  [ fig : oper_bands_1d ] . for internal nodes",
    ", we apply an outer band matrix ( for that scale ) .",
    "we note that our construction of the operator produces both whole and outer band matrices for all scales , and we simply choose the appropriate kind for each node of output as needed . upon completion of this process , we apply the projection ( [ eq : g_assemble ] ) to construct the final adaptive tree representing the output .",
    "construct the redundant tree for @xmath42 and copy it as skeleton tree for @xmath131 ( see section  [ sub : redundant - tree - structure ] ) .",
    "read operator blocks @xmath133 from row @xmath134 of _ whole band matrix _ @xmath105 .",
    "read operator blocks @xmath133 from row @xmath134 of _ outer band matrix _",
    "@xmath135}$ ] .    retrieve it .",
    "create it by interpolating from a coarser scale and cache for reuse .",
    "compute the resulting output function block according to @xmath136 , where the operation @xmath137 indicates a regular matrix - vector multiplication .",
    "project resulting output function blocks @xmath138 on all scales into a proper adaptive tree by using eq .",
    "( [ eq : g_assemble ] ) .",
    "discard from the resulting tree unnecessary function blocks at the requested accuracy .",
    "the function @xmath131 represented by its adaptive tree .",
    "algorithm  [ alg : op - apply-1d ] returns an adaptive tree representing the function @xmath131 .",
    "this tree contains sufficient information to evaluate @xmath131 at arbitrary points by interpolation and may be used as an input in further computations .",
    "we note that step  2 in algorithm  [ alg : op - apply-1d ] naturally resolves the problem that is usually addressed by mortar methods , see e.g.  @xcite . since adaptive representations have neighboring blocks of different sizes , they encounter difficulties when applying non - diagonal operators , as they require blocks which do not exist on that scale .",
    "our approach simply constructs these as needed and caches them for reuse , without requiring any additional consideration on the part of the user .",
    "let us briefly illustrate the application of the modified ns - form with an example of a singular convolution on the unit circle , the operator with the kernel @xmath139@xmath140 a periodic analogue of the hilbert transform .",
    "in order to find its representation in multiwavelet bases , we compute    @xmath141    where @xmath142 , @xmath143 are cross - correlation functions described in appendix  [ sub : cross - correlation - functions - of ] and @xmath144 .",
    "we compute @xmath145 using the convergent integrals@xmath146 where @xmath147 is a polynomial described in appendix  [ sub : cross - correlation - functions - of ] . in our numerical experiment",
    ", we apply ( [ cotangetkernel ] ) to the periodic function on @xmath148 $ ] , @xmath149 which yields@xmath150=i\\sqrt{\\frac{\\pi}{a}}\\sum_{n\\in\\mathbb{z}}\\mbox{sign}(n)e^{-n^{2}\\pi^{2}/a}e^{2\\pi iny},\\label{eq : cot_gauss}\\ ] ] where @xmath151 expression ( [ eq : cot_gauss ] ) is obtained by first observing that the hilbert transform of @xmath152 is @xmath153 , and then evaluating the lattice sum , noting that ( see ( * ? ? ?",
    "* formula 4.3.91))@xmath154 table  [ table : cotangent_apply ] summarizes the numerical construction of this solution for @xmath155 , at various requested precisions .",
    "optimal performance is obtained by adjusting the order of the basis @xmath62 as a function of the requested precision , to ensure that the operator remains a banded matrix with small band , and that the adaptive representation of the input function requires a moderate number of scales . the resulting numerical error ( as compared to the exact analytical solution ) ,",
    "measured in the @xmath57 norm , is shown in the last column .",
    "figure  [ fig : cotangent_apply ] shows the input and results for this example , as well as the point - wise error for the case where @xmath156 and @xmath157 ( the last row in the table ) .",
    ".[table : cotangent_apply]results from evaluating ( [ eq : cot_gauss ] ) with our algorithm .",
    "the order of the basis @xmath62 is adjusted as a function of the requested precision @xmath10 .",
    "the second column indicates scales present in the adaptive tree for the input .",
    "the third column shows the total number of blocks of coefficients in this tree .",
    "the last column ( @xmath158 ) shows the actual error of the computed solution in the @xmath57 norm . [ cols=\"^,^,^,^,^\",options=\"header \" , ]     a two - dimensional slice of the three - dimensional subdivision of space by the scaling functions and an illustration of the source term for the poisson equation ( [ poissonequationexample]).,title=\"fig:\",scaledwidth=35.0% ] a two - dimensional slice of the three - dimensional subdivision of space by the scaling functions and an illustration of the source term for the poisson equation ( [ poissonequationexample]).,title=\"fig:\",scaledwidth=60.0% ]      a simple example of computing the ground state of the hydrogen atom illustrates the numerical performance of the algorithms developed in this paper , and their utility for constructing more complex codes .",
    "the eigenfunctions @xmath159 for the hydrogen atom satisfy the time - independent schrdinger equation ( written in atomic units and spherical coordinates),@xmath160 where @xmath161 is the energy eigenvalue . for the ground state , @xmath162 and the ( unnormalized ) wave function is @xmath163 . following @xcite , we write @xmath164 where @xmath165 is the green s function for some @xmath166 and @xmath167 is the nuclear potential . for @xmath168",
    "the solution @xmath169 of ( [ kalos ] ) has @xmath170 and coincides with that of ( [ schrodinger ] ) .",
    "we solve ( [ kalos ] ) by a simple iteration starting from some value @xmath171 and changing @xmath166 to obtain the solution with @xmath170 .",
    "the algorithm proceeds as follows :    1 .",
    "initialize with some value @xmath171 and function @xmath169 .",
    "the number of iterations of the algorithm is only weakly sensitive to these choices .",
    "2 .   compute the product of the potential @xmath172 and the function @xmath169 .",
    "3 .   apply the green s function @xmath173 to the product @xmath174 via the algorithm of this paper to compute @xmath175 4 .",
    "compute the energy for @xmath176,@xmath177 5 .",
    "set @xmath178 , @xmath179 and return to step  2 .",
    "the iteration is terminated as the change in @xmath166 and @xmath180 falls below the desired accuracy .",
    "the progress of the iteration is illustrated in figure  [ fig : hydrogen_energy_error ] .",
    "the computations in steps  2 and 4 use the three dimensional extension of the approach described in @xcite , to compute point - wise multiplications of adaptively represented functions and weak differential operators of the same .",
    "this example illustrates an application of our algorithm to problems in quantum chemistry .",
    "multiresolution quantum chemistry developed in @xcite also uses separated representations .",
    "the main technical difference with @xcite is that we use the modified non - standard form and apply operator blocks on their `` natural '' scale , thus producing a fully adaptive algorithm .",
    "we are currently using this algorithm as part of a new method for solving the multiparticle schrdinger equation and will report the results elsewhere .",
    "convergence of the iteration to obtain the ground state of the hydrogen atom computed via formulation in ( [ kalos ] ) for the non - relativistic schrdinger equation .",
    "the requested accuracy in applying the green s function is set to @xmath181 .",
    ", scaledwidth=60.0% ]",
    "we have shown that a combination of separated and multiresolution representations of operators yields a new multidimensional algorithm for applying a class of integral operators with radial kernels .",
    "we note that the same algorithm is used for all such operators as they are approximated by a weighted sum of gaussians .",
    "this fact makes our approach applicable across multiple fields , where a single implementation of the core algorithm can be reused for different specific problems .",
    "the algorithm is fully adaptive and avoids issues usually addressed by mortar methods .",
    "the method of approximation underlying our approach is distinct from that of the fmm , has similar efficiency and has the advantage of being more readily extendable to higher dimensions .",
    "we also note that semi - analytic approximations via weighted sums of gaussians provide additional advantages in some applications .",
    "although we described the application of kernels in free space , there is a simple extension to problems with radial kernels subject to periodic , dirichlet or neumann boundary conditions on a cube that we will describe separately .",
    "the algorithm may be extended to classes of non - convolution operators , e.g. , the calderon - zygmund operators .",
    "for such extensions the separated representation may not be available in analytic form , as it is for the operators of this paper , and may require a numerical construction .",
    "the separated representation of the kernel permits further generalization of our approach to dimensions @xmath13 for applying operators to functions in separated representation .",
    "a notable remaining challenge is an efficient , high order extension of this technique to the application of operators on domains with complicated geometries and surfaces .",
    "let us briefly describe some properties of the legendre scaling functions @xmath184 , @xmath33 , defined as@xmath185\\\\ 0 , & x\\notin[0,1]\\end{array}\\right.,\\label{scalingfnc}\\ ] ] and forming a basis for @xmath93 the subspace @xmath17 is spanned by @xmath186 functions obtained from @xmath187 by dilation and translation,@xmath188 these functions have support on @xmath189 $ ] and satisfy the orthonormality condition @xmath190 a function @xmath42 , defined on @xmath148 $ ] , is represented in the subspace @xmath17 by its normalized legendre expansion@xmath191 where the coefficients @xmath192 are computed via@xmath193 as long as @xmath45 is smooth enough and is well approximated on @xmath189 $ ] by a polynomial of order up to @xmath194 , we may use gauss - legendre quadratures to calculate the @xmath192 via@xmath195 where @xmath196 are the roots of @xmath197 and @xmath198 are the corresponding quadrature weights .",
    "we use piecewise polynomial functions @xmath200 as an orthonormal basis for @xmath201 @xcite,@xmath202 since @xmath203 , the first @xmath62 moments of all @xmath200 vanish:@xmath204 the space @xmath20 is spanned by @xmath186 functions obtained from @xmath200 by dilation and translation,@xmath205 and supported in the interval @xmath206.$ ] a function @xmath45 defined on @xmath148 $ ] is represented in the multiwavelet basis on @xmath126 scales by@xmath207 with the coefficients @xmath208 computed via@xmath209      the relation between subspaces , @xmath210 , is expressed via the two - scale difference equations,@xmath211 where the coefficients @xmath212 , @xmath213 and @xmath214 , @xmath215 depend on the type of polynomial basis used ( legendre or interpolating ) and its order @xmath62 . the matrices of coefficients @xmath216 are the multiwavelet analogues of the quadrature mirror filters in the usual wavelet construction , e.g. , @xcite .",
    "these matrices satisfy a number of important orthogonality relations and we refer to @xcite for complete details , including the construction of the @xmath217 matrices themselves .",
    "let us only state how these matrices are used to connect the scaling @xmath192 and wavelet @xmath208 coefficients on neighboring scales @xmath40 and @xmath67 .",
    "the _ decomposition procedure _ ( @xmath218 ) is based on @xmath219 the _ reconstruction _ ( @xmath220 ) is based on@xmath221    [ [ subcross - correlation - functions - ofcross - correlation - of - the - scaling - functions ] ] [ sub : cross - correlation - functions - of]cross - correlation of the scaling functions ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    for convolution operators we only need to compute integrals with the cross - correlation functions of the scaling functions , @xmath222 since the support of the scaling functions is restricted to @xmath148 $ ] , the functions @xmath223 are zero outside the interval @xmath183 $ ] and are polynomials on @xmath224 $ ] and @xmath148 $ ] of degree @xmath225 ,          1 .",
    "transposition of indices : @xmath228 , + 2 .",
    "relations between @xmath229and @xmath230 : @xmath231 for @xmath232 , + 3 .",
    "values at zero : @xmath233 if @xmath234 , and @xmath235 for @xmath236 , + 4 .",
    "upper bound : @xmath237}|\\phi_{ii'}(x)|\\leq1 $ ] for @xmath238 , + 5 .",
    "connection with the gegenbauer polynomials : + @xmath239 and @xmath240 , for @xmath241 , where @xmath242 is the gegenbauer polynomial , + 6 .",
    "linear expansion : if @xmath243 then we have@xmath244 where@xmath245 for @xmath246 and @xmath247 .",
    "vanishing moments : we have @xmath248 and @xmath249 for @xmath250 and @xmath251 .      [",
    "[ subseparated - representationsseparated - representations - of - radial - functions ] ] [ sub : separated - representations]separated representations of radial functions ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~      [ pro : trapez]for any @xmath253 , @xmath254 , and @xmath255 , there exist positive numbers @xmath256 and @xmath257 such that@xmath258 with@xmath259,\\label{trapez.01a}\\ ] ] where @xmath260 are constants that only depend on @xmath261 . for fixed power @xmath261 and accuracy @xmath10",
    ", we have @xmath262 .",
    "the proof of proposition  [ pro : trapez ] in @xcite is based on using the trapezoidal rule to discretize an integral representation of @xmath252 .",
    "similar estimates may be obtained for more general radial kernels using their integral representations as in ( [ integralrepr ] ) .        by selecting appropriate @xmath10 and @xmath263 in the separated representations of a radial kernel @xmath264 ( as in proposition  [ pro : trapez ] )",
    ", we obtain a separated approximation for the coefficients@xmath265^{3}}\\ , k(2^{-j}(\\mathbf{x}+{\\bf \\ell}))\\,\\phi_{ii'}(x_{1})\\,\\phi_{jj'}(x_{2})\\,\\phi_{kk'}(x_{3})\\ , d\\mathbf{x}\\,.\\label{arbitrary - kernel}\\ ] ] since the number of terms , @xmath266 , depends logarithmically on @xmath10 and @xmath263 , we achieve any finite accuracy with a very reasonable number of terms . for example , for the poisson kernel @xmath267",
    ", we have the following estimate @xcite ,    [ estimates ] for any @xmath268 and @xmath269 the coefficients @xmath270 in ( [ arbitrary - kernel ] ) have an approximation with a low separation rank , @xmath271 such that if @xmath272 , then @xmath273 and if @xmath274 , then @xmath275 where @xmath10 , @xmath263 , @xmath266 , @xmath256 , @xmath257 , @xmath276 are described in proposition  [ pro : trapez ] for @xmath277 and @xmath278 and @xmath279 are ( small ) constants .",
    "we need to compute integrals in ( [ kernelfactor ] ) , where the cross - correlation functions @xmath223 are given in ( [ crosscor ] ) .",
    "we note that using ( [ expans.00 ] ) , it is sufficient to compute @xmath280 for @xmath281 rather than @xmath282 integrals in ( [ kernelfactor ] ) . using the relation between @xmath230 and @xmath229 in proposition  [ pro : crosscor ] ,",
    "we have@xmath283 so that @xmath284\\phi_{i0}^{+}(x)dx.\\ ] ]        j.  carrier , l.  greengard , v.  rokhlin , a fast adaptive multipole algorithm for particle simulations , siam journal of scientific and statistical computing 9  ( 4 ) , yale university technical report , yaleu / dcs / rr-496 ( 1986 ) .",
    "r.  harrison , g.  fann , t.  yanai , g.  beylkin , multiresolution quantum chemistry in multiwavelet bases , in : p.m.a .",
    "al . ( ed . ) , lecture notes in computer science .",
    "computational science - iccs 2003 , vol .",
    "2660 , springer , 2003 , pp .",
    "103110 .",
    "r.  harrison , g.  fann , t.  yanai , z.  gan , g.  beylkin , multiresolution quantum chemistry : basic theory and initial applications , j. chem .",
    "121  ( 23 ) ( 2004 ) 1158711598 , ` http://amath.colorado.edu/pub/wavelets/papers/mrqc.pdf ` .",
    "g.  beylkin , m.  j. mohlenkamp , algorithms for numerical analysis in high dimensions , appm preprint # 519 , univ .",
    "of colorado , ` http://amath.colorado.edu/pub/wavelets/papers/bey-moh2004p.pdf ` , accepted for publication in _",
    "siam j. sci .",
    "( february 2004 ) .",
    "y.  maday , c.  mavriplis , a.  t. patera , nonconforming mortar element methods : application to spectral discretizations , in : domain decomposition methods ( los angeles , ca , 1988 ) , siam , philadelphia , pa , 1989 , pp .",
    "392418 .",
    "g.  anagnostou , y.  maday , c.  mavriplis , a.  t. patera , on the mortar element method : generalizations and implementation , in : third international symposium on domain decomposition methods for partial differential equations ( houston , tx , 1989 ) , siam , philadelphia , pa , 1990 , pp .",
    "157173 .    c.  bernardi , y.  maday , a.  t. patera , domain decomposition by the mortar element method , in : asymptotic and numerical methods for partial differential equations with critical parameters ( beaune , 1992 ) , vol .",
    "384 of nato adv .",
    "sci . , kluwer acad .",
    "publ . , dordrecht , 1993 , pp .",
    "269286 .    c.  bernardi , y.  maday , a.  t. patera , a new nonconforming approach to domain decomposition : the mortar element method , in : nonlinear partial differential equations and their applications .",
    "collge de france seminar , vol .",
    "xi ( paris , 19891991 ) , vol .",
    "299 of pitman res . notes math .",
    ", longman sci .",
    "tech . , harlow , 1994 , pp . 1351 .",
    "l.  greengard , x.  sun , a new version of the fast gauss transform , in : proceedings of the international congress of mathematicians , vol .",
    "iii ( berlin , 1998 ) , no .",
    "extra vol .",
    "iii , 1998 , pp .",
    "575584 ( electronic ) ."
  ],
  "abstract_text": [
    "<S> we present a fast , adaptive multiresolution algorithm for applying integral operators with a wide class of radially symmetric kernels in dimensions one , two and three . </S>",
    "<S> this algorithm is made efficient by the use of separated representations of the kernel . </S>",
    "<S> we discuss operators of the class @xmath0 , where @xmath1 and @xmath2 , and illustrate the algorithm for the poisson and schrdinger equations in dimension three . </S>",
    "<S> the same algorithm may be used for all operators with radially symmetric kernels approximated as a weighted sum of gaussians , making it applicable across multiple fields by reusing a single implementation .    </S>",
    "<S> this fast algorithm provides controllable accuracy at a reasonable cost , comparable to that of the fast multipole method ( fmm ) . </S>",
    "<S> it differs from the fmm by the type of approximation used to represent kernels and has an advantage of being easily extendable to higher dimensions .        </S>",
    "<S> separated representation ; multiwavelets ; adaptive algorithms ; integral operators . </S>"
  ]
}