{
  "article_text": [
    "first principles ( _ ab initio _ ) quantum mechanical simulations based on density functional theory ( dft )  @xcite are a vital component of research in condensed matter physics and molecular quantum chemistry . using dft , the many - body schrdinger equation for the ground state properties of an interacting system of electrons and nuclei",
    "is reduced to the self - consistent solution of an effective single - particle schrdinger equation , known as the kohn - sham equation : @xmath0\\psi_i(r ) = \\varepsilon_i\\psi_i(r),\\ ] ] where @xmath1 are particle energies ( eigenvalues ) and @xmath2 are the associated wavefunctions ( eigenfunctions ) .",
    "the hamiltonian @xmath3 consists of kinetic energy operator @xmath4 and effective potential operator @xmath5 .",
    "the effective potential @xmath6 depends on the electronic charge density @xmath7 where @xmath8 is the electronic occupation of state @xmath9 and the sum is over all occupied states .",
    "since @xmath2 depends on @xmath6 which depends on @xmath10 which depends again on @xmath2 , the kohn - sham equation is a nonlinear eigenvalue problem .",
    "the importance of _ ab initio _ calculations stems from their underlying quantum - mechanical nature , yielding insights inaccessible to experiment and robust , predictive power unattainable by more approximate empirical approaches .",
    "however , because _ ab initio _ calculations are computationally intensive , a vast range of real materials problems remain inaccessible by such accurate , quantum mechanical means . to address this limitation , there has been substantial effort in recent years to develop _ ab initio _ methods that use efficient , local bases in order to both reduce degrees of freedom and facilitate large - scale parallel implementation : augmented planewave plus local orbital ( apw+lo )  @xcite , atomic - orbital ( ao ) , e.g. ,  @xcite , and real - space methods  @xcite such as finite - difference  @xcite , wavelet  @xcite , finite - element ( fe )  @xcite , partition - of - unity finite element ( pufe )  @xcite , and discontinuous galerkin ( dg )  @xcite methods , among many others , see for example  @xcite .    in the vast majority of _ ab initio _ methods , the dominant computational cost is the iterative diagonalization of the sequence of large linear eigenvalue problems produced by the discretization of equation   in the chosen basis  @xcite .",
    "the linear eigenvalue problems produced by highly efficient physics based apw+lo , ao , and pufe bases , while smaller than those of other bases , present a particular challenge as they are generalized eigenvalue problems with ill - conditioned coefficient matrices , and are much more difficult to precondition than those produced by conventional planewave based methods , due to the lack of diagonal dominance and absence of an efficient representation for the inverse laplacian .    here ,",
    "building on prior work @xcite , we propose a _",
    "hybrid preconditioning scheme _ for rapid iterative diagonalization of the sequence of ill - conditioned generalized hermitian eigenvalue problems produced by modern orbital based electronic structure methods , such as apw+lo , ao , and pufe .",
    "the hybrid preconditioning scheme effectively combines a global shifted - inverse preconditioner as in  @xcite and locally accelerated shifted - inverse preconditioners as in  @xcite that target eigenpairs of interest individually .",
    "the global preconditioner serves as sole preconditioner in early self - consistent iterations and as convergence accelerator for local preconditioners in subsequent iterations .",
    "we have conducted extensive tests of the proposed hybrid preconditioning scheme with the block steepest descent method in pufe pseudopotential density functional calculations on a variety of systems , including the difficult case of triclinic metallic ceal .",
    "this system has deep atomic potentials and 15 electrons per unit cell in valence , thus requiring the computation of many , strongly localized eigenfunctions , which in turn requires the addition of correspondingly many orbital enrichments in the pufe electronic structure method .",
    "our results reveal that in terms of average numbers of inner and outer iterations , the hybrid preconditioner performs markedly better than global or local preconditioners alone , and the resulting solver performs as well on the ill - conditioned generalized eigenvalue problems produced by the pufe _ ab initio _ method as does the locally optimal block preconditioned conjugate - gradient ( lobpcg ) method on well - conditioned _ standard _ eigenvalue problems produced by the planewave method .",
    "the remainder of the paper is organized as follows . in section  [ sec :",
    "scf ] , we outline the self - consistent field ( scf ) procedure and iterative diagonalization process in an algebraic setting , and discuss the ill - conditioned generalized eigenvalue problems produced by the pufe electronic structure method . in section  [ sec : labpsd ] , we describe the hybrid preconditioning scheme and its use in the block steepest descent method .",
    "implementation details are presented in section  [ sec : impl ] .",
    "numerical results are presented in section  [ sec : num ] and we close with final remarks in section  [ sec : conclusion ] .",
    "electronic structure methods such as apw+lo , ao , and pufe methods incorporate information from local atomic solutions to construct efficient bases for molecular or condensed matter calculations . this information is typically incorporated in the form of localized , atomic - like basis functions ( orbitals ) , which generally leads to a nonorthogonal basis .",
    "discretization of the kohn - sham equation in such a basis then leads to a nonlinear algebraic eigenvalue problem @xmath11 where @xmath12 is the discrete ks - hamiltonian matrix and consists of a local part @xmath13 and , when pseudopotentials  @xcite are employed , nonlocal part @xmath14 : @xmath15 @xmath13 is a hermitian matrix which depends on the effective potential @xmath6 , which in turn depends on the electronic density @xmath10 computed from the eigenvectors @xmath16 .",
    "@xmath14 is a low - rank hermitian matrix associated with the non - local part of the pseudopotential .",
    "@xmath17 is the overlap ( gram ) matrix of the basis and is hermitian positive - definite .",
    "the nonlocal matrix @xmath14 and overlap matrix @xmath17 are independent of @xmath6 , and hence do not depend on @xmath10 or @xmath16 . in condensed matter calculations , it is required to sample the brillouin zone  @xcite at a sufficient number of @xmath18-points , making the above matrices complex hermitian rather than real symmetric .",
    "in addition , for methods whose basis functions are localized , such as wavelet , fe , pufe , dg , and ( to a lesser extent ) ao - type methods , the above matrices are sparse : for example , in the case of pufe , having a few hundred nonzero entries per row , independent of problem size .",
    "the nonlinear eigenvalue problem   is solved by fixed - point iteration ( see  @xcite ) : starting with an initial guess for the input charge density @xmath19 and associated effective potential @xmath20 and iterating until the difference between the input and output effective potentials , @xmath21 and @xmath22 , is within a specified tolerance @xmath23 ; i.e. , the process is terminated at the @xmath24-th iteration if @xmath25 this process is known as a _ self - consistent field _ ( scf ) procedure .",
    "a schematic of the scf procedure is shown in figure  [ fig : scf ] .        at the @xmath24-th scf iteration , with an approximate effective potential @xmath26 extrapolated from previous scf iterations  @xcite ,",
    "the nonlinear eigenvalue problem becomes the following linear generalized hermitian eigenvalue problem ( ghep ) : @xmath27 where @xmath28 @xmath29 is a hermitian matrix , @xmath14 is a low - rank hermitian matrix , @xmath17 is hermitian positive definite , and all matrices are sparse when arising from discretization in a localized basis such as pufe .",
    "as the scf iteration proceeds , changes in @xmath26 , and thus @xmath30 , @xmath31 , and @xmath32 become smaller and smaller until convergence to the specified tolerance is achieved .    since in the first few scf iterations @xmath26",
    "is not yet well converged , the ghep   need not be solved to high accuracy .",
    "all that is necessary is that the accuracy be sufficient to allow the outer scf iteration to converge without incurring significant additional iterations relative to exact solution . as the scf iterations proceed and @xmath26 converges , the accuracy requirement for the solution of the ghep   increases .",
    "specifically , from the previous scf iteration , we have an estimate @xmath33 of the lowest @xmath34 eigenpairs with the maximum residual norm @xmath35,\\ ] ] where if @xmath36 and @xmath37 $ ] are approximate eigenpairs , then @xmath38 = \\max_{1\\le i \\le m } \\mbox{res}[\\widehat{\\varepsilon}_i , \\widehat{\\psi}_i],\\ ] ] and @xmath39 $ ] is the relative residual norm for the approximate eigenpair @xmath40 of ghep  : @xmath41    \\equiv \\frac{\\|r_i\\|}{\\|h^{(i_s)}\\widehat{\\psi}_i\\|},\\ ] ] and @xmath42 .",
    "our objective at the @xmath24-th scf iteration is to compute the improved estimate @xmath43 satisfying @xmath44   \\leq \\tau_{{\\rm eig},l}^{(i_s)}\\ ] ] where the tolerance @xmath45 is chosen to achieve a desired reduction relative to @xmath46 and/or @xmath47 . in practice , one or two orders of magnitude reduction is typically sufficient for the scf procedure to converge in a comparable number of iterations to exact solutions ( i.e. , reduction to zero ) . with @xmath48",
    "such that @xmath49 is an exact eigenpair of the matrix pair @xmath50 .",
    "consequently , we have @xmath51 therefore , @xmath39 \\leq tol$ ] implies relative backward error of @xmath40 less than @xmath52 . ]    since during the course of the scf iteration to convergence , a wide range of accuracies are required for the solution of the ghep   and excellent approximations are available for all eigenpairs at each scf iteration after the first few , iterative diagonalization methods such as davidson  @xcite and steepest descent  @xcite can be much more efficient than direct methods , especially as problem sizes increase and memory constraints become a significant concern .",
    "however , while iterative solution methods make much larger computations possible , diagonalization remains the key bottleneck in large - scale _ ab initio _ calculations .",
    "due to the nonorthogonal basis sets employed in electronic structure methods such as apw+lo , ao , and pufe , the resulting numerical eigenvalue problems can be ill - conditioned . in particular , @xmath53 and @xmath17 coefficient matrices can be ill - conditioned and share a large common near - null subspace .",
    "furthermore , there is in general no clear gap between the eigenvalues that are sought ( i.e. , occupied states ) and the rest .",
    "moreover , the ill - conditioning and difficulty of iterative diagonalization become especially pronounced as bases become saturated with orbital functions with long tails in order to attain high accuracy .",
    "table  [ tab : cond ] shows the condition numbers @xmath54 and @xmath55 of coefficient matrices @xmath56 and @xmath17 , respectively , at the first scf iteration of pufe calculations of metallic cual , using hgh pseudopotentials  @xcite .",
    "there are two atoms in the triclinic unit cell , which is subject to bloch - periodic boundary conditions  @xcite .",
    "the brillouin zone is sampled at the @xmath57-point and at @xmath58 .",
    "the lattice vectors for the unit cell are : @xmath59 with lattice parameter @xmath60 bohr .",
    "the cu and al atoms are located at lattice coordinates @xmath61 and @xmath62 , respectively .",
    "total energy calculations with pufe are carried out on a uniform @xmath63 cubic - order finite element mesh , @xmath64 is the enrichment support radius , and @xmath65 is the resulting dimension of the ghep .    .condition numbers of @xmath56 and @xmath17 matrices in pufe calculations of cual as a function of enrichment support radius . [",
    "cols=\"^,^,^,^,^\",options=\"header \" , ]     with triply degenerate value at @xmath66 and doubly degenerate value at @xmath67 , as in the reference planewave calculations ( deviations from exact degeneracy in the final digits are due to the lower symmetry of the basis than the crystal @xcite ) .",
    "as can be seen , the degenerate values pose no particular difficulty for the labpsd solver .",
    "( right).,title=\"fig:\",scaledwidth=48.0% ]   ( right).,title=\"fig:\",scaledwidth=48.0% ]    [ [ ceal-1 ] ] ceal + + + +    for the ceal system , we consider a @xmath68 finite - element mesh with @xmath69 .",
    "the dimension of the ghep is @xmath70 .",
    "the rank of @xmath71 is @xmath72 . in this case ,",
    "@xmath73 eigenpairs are computed to accommodate all valence electrons with specified fermi - dirac occupation .",
    "the left plot of figure  [ fig : ghepveff ] shows the reduction of the maximum relative residual errors @xmath74 $ ] of the sequence of the gheps , where @xmath75 .",
    "the right plot of figure  [ fig : ghepveff ] shows the corresponding difference @xmath76 .",
    "again , the maximum relative residual error of the ghep steadily drops at the rate @xmath77 , along with the input - output potential difference .",
    "if the accuracy of the eigensolves at each scf iteration is further increased , the convergence of the effective potential is not substantially affected .     and @xmath78 ) of gheps in the solution of nlep ( left ) , and the relative difference of effective potentials @xmath6 ( right).,title=\"fig:\",scaledwidth=48.0% ]   and @xmath78 ) of gheps in the solution of nlep ( left ) , and the relative difference of effective potentials @xmath6 ( right).,title=\"fig:\",scaledwidth=48.0% ]      now , let us examine the efficiency of the labpsd in terms of the following two quantities : @xmath79 where @xmath80 is the total number of scf iterations",
    ", @xmath81 is the total number of bpsd iterations , and @xmath82 is the total number of minres iterations .",
    "@xmath83 is the number of @xmath18-points ( @xmath84 in the cual case , @xmath85 in the ceal case ) . by the above definition",
    ", @xmath86 is the average number of outer bpsd iterations per scf iteration for each @xmath18-point .",
    "a small @xmath87-number indicates the efficiency of the hybrid preconditioning technique .",
    "similarly , @xmath88 is the average number of inner minres iterations per outer bpsd iteration for each eigenpair .",
    "a small @xmath88-number indicates the efficiency of applying the locally accelerated preconditioners in the proposed two stages .",
    "[ [ cual-2 ] ] cual + + + +    the left plot of figure  [ fig : cual_ni ] shows the @xmath87- and @xmath88-numbers for labpsd for a sequence of refined fe meshes with @xmath89 fixed .",
    "the right plot is for different enrichment support radii @xmath64 and fixed @xmath90 fe mesh .",
    "this constitutes a severe test of robustness with respect to ill - conditioning since as either the mesh or support radius are increased , the conditioning of the ghep worsens dramatically , as shown in table  [ tab : cond ] . in all cases ,",
    "the rank of @xmath71 is @xmath91 and the number of eigenpairs computed per scf iteration is @xmath92 .",
    "fe meshes ( left ) and enrichment support radii @xmath64 ( right ) .",
    ", title=\"fig:\",scaledwidth=48.0% ]   fe meshes ( left ) and enrichment support radii @xmath64 ( right ) .",
    ", title=\"fig:\",scaledwidth=48.0% ]    [ [ ceal-2 ] ] ceal + + + +    similarly , for the ceal system , the left plot of figure  [ fig : ni ] shows the @xmath87- and @xmath88-numbers with @xmath93 .",
    "the right plot is for different enrichment support radii @xmath64 with the fixed @xmath90 fe mesh .",
    "this constitutes a severe test of robustness with respect to ill - conditioning . in this case , the rank of @xmath71 is @xmath72 and the number of eigenpairs computed per scf iteration is @xmath73 .    for both cual and ceal simulations ,",
    "as the mesh is refined or @xmath64 is increased , the error of the computed pufe total energy decreases to @xmath94 hartree / atom relative to the well - converged planewave reference . significantly , we observe that _ all hp - numbers are between 2 and 6 _ , with only mild dependence on conditioning as it worsens considerably with increasing mesh and support radius .",
    "meanwhile , _ all la - numbers are between 0 and 4 _ , with no apparent dependence on conditioning . as we show below ( section [ sec : globlochyb ] ) , this is in stark contrast to typical global - only or local - only preconditioning schemes , which are highly sensitive to the conditioning of the problem .",
    "furthermore , these hp- and la - numbers are comparable to the typical numbers of inner and outer iterations required by the lobpcg method on the well - conditioned _ standard _ eigenvalue problems produced by the planewave _ ab initio _",
    "method @xcite .",
    "this indicates that labpsd is an efficient method for the rapid iterative diagonalization of ill - conditioned gheps produced by nonorthogonal atomic - orbital based methods such as pufe .",
    "fe meshes ( left ) and enrichment support radii @xmath64 ( right ) .",
    ", title=\"fig:\",scaledwidth=48.0% ]   fe meshes ( left ) and enrichment support radii @xmath64 ( right ) .",
    ", title=\"fig:\",scaledwidth=48.0% ]      we now consider the timing of key steps of labpsd for increasing numbers @xmath34 of eigenpairs . for these purposes ,",
    "we now focus on the more computationally intensive ceal system , where the dimension of the gheps is @xmath95 .",
    "the enrichment support radius is @xmath93 .",
    "the rank of @xmath71 is @xmath72 .",
    "figure  [ fig : timeprofile ] shows the cpu time normalized with respect to the cpu time for computing @xmath96 eigenvalues , and the most time consuming parts for labpsd are shown for a series of pufe calculations with increasing numbers of eigenpairs @xmath97 with @xmath98 .",
    "each calculation takes 23 scf iterations to converge to the required tolerance . as expected , the cpu time is dominated by the preconditioning step 6 at about 60% of the total time in all cases .",
    "the cost of the global preconditioner in step 6(a ) increases as @xmath34 increases , as expected .",
    "however , as a percentage of the total , the cost actually decreases , which is a consequence of the fact that the cost of the sparse factorization   and application of the global preconditioner is _ amortized _ when more eigenpairs are computed .",
    "on the other hand , the cost of the locally accelerated preconditioners in step 6(b ) increases as a percentage of the total as more eigenpairs are computed .",
    "the cost of matrix - vector products in step 7 is proportionally increased with the number of computed eigenpairs ; however , the overall cost is reduced from 20% to about 15% of the total when more eigenpairs are computed .",
    "the costs of all other steps , such as setting up the reduced ghep ( step 8) , updating ( step 11 ) , and solving the reduced eigenvalue problem ( step 9 ) are relatively small at 20% of the total .",
    "as @xmath34 is increased further , the solution of the reduced problem must dominate at some point due to its @xmath99 scaling .",
    "however , at the present system sizes , it remains a small fraction of the total .",
    "overall , when labpsd is used for computing 4 times more eigenpairs , namely from @xmath100 to @xmath101 , the total cpu time is also increased by about a factor of 4 ( 3.73 ) .     in the ceal simulation.,scaledwidth=70.0%",
    "]    we note that the @xmath102 factorization is computed only once at the beginning of the scf cycle .",
    "the cpu time of the factorization is a small percentage of the total .",
    "specifically , the @xmath102 factorizations for the two @xmath18-points take just 3% of the total time when @xmath96 , and 0.7% when @xmath103 .      here",
    "we compare the hybrid preconditioning scheme to current state - of - the - art global preconditioning as in  @xcite and local preconditioning as in  @xcite .",
    "having demonstrated in sections [ eg1 ] and [ sec : iterations ] the robustness of the hybrid preconditioner with respect to both the distribution ( clustered and nonclustered ) and width ( hard and soft potentials ) of the spectrum , we shall restrict focus here to the more computationally intensive ceal system , where the dimension of the gheps is @xmath104 .",
    "the enrichment support radius @xmath93 , the rank of @xmath105 is @xmath72 , and @xmath73 eigenpairs are computed at each scf iteration with @xmath75 .",
    "figure [ fig:3precond ] shows the maximum relative residual norms of the eigenpairs in successive scf iterations when solving the sequence of gheps by bpsd with global , local , and hybrid preconditioners .",
    "if we use the global preconditioner step 6(a ) only ( i.e. , without step 6(b ) ) , the scf convergence stagnates after about 9 scf iterations due to the inability of the eigensolver to reduce residuals sufficiently within the maximum 200 bpsd iterations .",
    "the total cpu time was 11.4 hours , due to the relative ineffectiveness of the global preconditioner and consequent large number of outer ( bpsd ) iterations .",
    "on the other hand , if we apply the local preconditioner step 6(b ) only , without the global preconditioner 6(a ) , the scf convergence stagnates after about 17 scf iterations , again due to the inability of the eigensolver to reduce the residuals sufficiently even with the maximum 100 bpsd and 500 minres iterations . due to the large number of both inner",
    "( minres ) and outer ( bpsd ) iterations , the total cpu time was 138.6 hours .",
    "in stark contrast , the scf iteration converges steadily to the specified tolerance with the hybrid preconditioning scheme .",
    "the @xmath87- and @xmath88-numbers are 3.0 and 2.3 , respectively , while achieving smooth scf convergence at a rate comparable to exact diagonalization at each scf step . due to the small number of both inner and outer iterations , the total cpu time was reduced to just 1.3 hours .",
    "we proposed a block hybrid - preconditioned steepest descent method , labpsd , for the iterative diagonalization of the sequence of ill - conditioned generalized hermitian eigenvalue problems which arise in electronic structure calculations using orbital - based nonorthogonal basis sets .",
    "for such problems , the hybrid scheme overcomes the drawbacks of stagnation of global preconditioners and excessive cost of locally accelerated iterative preconditioners .",
    "pufe pseudopotential density - functional calculations of cual , with soft potentials and degenerate eigenvalues , and ceal , with hard potentials and nondegenerate spectrum , showed hp- and la - numbers comparable to the typical numbers of inner and outer iterations required by the lobpcg method on well - conditioned _ standard _ eigenvalue problems produced by the planewave _ ab initio _ method . given the generality of the method and robustness with respect to spectral structure , it is expected that the labpsd method will provide similar benefits to other orbital - based , nonorthogonal electronic structure methods as well . indeed , it is reasonable to expect benefits not only for pseudopotential based methods , as demonstrated here , but for all - electron methods such as apw+lo @xcite and lmto @xcite also , since these require diagonalization for just valence states as well ( the core states having been solved separately in a spherical approximation ) .",
    "the labpsd algorithm and implementation present many opportunities for future work .",
    "first , similar to @xcite , we expect that the sparse @xmath106 factorization in _ single precision _ or even an incomplete factorization might be sufficient . this will substantially reduce memory and i / o costs for very large systems .",
    "secondly , instead of using minres for the iterative refinement in applying locally accelerated preconditioners , one can use a simple first - order one - step iterative method @xcite : @xmath107\\ ] ] with initial @xmath108 from the global preconditioner , where @xmath109 is chosen to minimize the residual norm of the linear system  .",
    "our preliminary results are very encouraging , which is particularly promising for parallel distributed computing .",
    "in addition , although we have not encountered the rank deficiency of the subspace matrix @xmath110 produced in step 6 of the labpsd method , a rank - revealing re - orthogonalization process would be necessary for a general - purpose implementation , such as in the block steepest descent method implemented in ea19 of hsl  @xcite .",
    "luigi genovese , alexey neelov , stefan goedecker , thierry deutsch , seyed  alireza ghasemi , alexander willand , damien caliste , oded zilberberg , mark rayson , anders bergman , and reinhold schneider . .",
    ", 129(1 ) , 2008 .                                  j.  e. pask and k.  e. andersen .",
    "large - scale eigenproblems in ab initio electronic - structure calculations .",
    "17th international association for mathematics and computers in simulation world congress : scientific computation , applied mathematics and simulation , paris , france , july 2005 .",
    "j.  e. pask , n.  sukumar , m.  guney , and w.  hu .",
    "partition - of - unity finite - element method for large scale quantum molecular dynamics on massively parallel computational platforms .",
    "technical report llnl - tr-470692 , department of energy ldrd 08-erd-052 , march 2011 .",
    "available at ` http://e-reports-ext.llnl.gov/pdf/471660.pdf ` .",
    "y.  saad , j.  r. chelikowsky , and s.  m. shoutz .",
    "numerical methods for electronic structure calculations of materials .",
    "technical report umnsi-2006 - 15 , department of computer science and engineering , university of minnesota , 2006 .",
    "t.  torsti , t.  eirola , j.  enkovaara , t.  hakala , p.  havu , v.  havu , t.  hynlnmaa , j.  ignatius , m.  lyly , i.  makkonen , t.  t. rantala , j.  ruokolainen , k.  ruotsalainen , e.  rsnen , h.  saarikoski , and m.  j. puska .",
    "three real - space discretization techniques in electronic structure calculations . , 243(5):10161053 , 2006 ."
  ],
  "abstract_text": [
    "<S> the iterative diagonalization of a sequence of large ill - conditioned generalized eigenvalue problems is a computational bottleneck in quantum mechanical methods employing a nonorthogonal basis for _ ab initio _ electronic structure calculations . </S>",
    "<S> we propose a hybrid preconditioning scheme to effectively combine global and locally accelerated preconditioners for rapid iterative diagonalization of such eigenvalue problems . in partition - of - unity finite - element ( pufe ) </S>",
    "<S> pseudopotential density - functional calculations , employing a nonorthogonal basis , we show that the hybrid preconditioned block steepest descent method is a cost - effective eigensolver , outperforming current state - of - the - art global preconditioning schemes , and comparably efficient for the ill - conditioned generalized eigenvalue problems produced by pufe as the locally optimal block preconditioned conjugate - gradient method for the well - conditioned standard eigenvalue problems produced by planewave methods . </S>"
  ]
}