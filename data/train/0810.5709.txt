{
  "article_text": [
    "atomic - scale simulation of isolated defects with a computationally tractable number of atoms requires careful choice of boundary conditions .",
    "periodic or fixed boundary conditions introduce fictitious forces when relaxing the geometry of defects ; reducing the error requires increasing the number of atoms .",
    "flexible boundary condition methods avoid these errors by instead using harmonic lattice response for atoms away from the defect .",
    "in particular , the bulk lattice green s function ( lgf ) gives the short- and long - range displacements in response to a point or line force .",
    "sinclair et  al.@xcite introduced flexible boundary conditions for studying defects such as cracks@xcite , dislocations@xcite , vacancies and free surfaces@xcite with classical potentials and isolated screw or edge dislocations with density - functional theory@xcite .",
    "evaluation of the lgf in real space involves the inverse fourier transform of a function with a singularity at the @xmath0-point ( @xmath1 ) , which requires algorithmic approaches to evaluate numerically .",
    "relative displacement method@xcite , elastic green s function ( egf ) correction@xcite and discontinuity correction@xcite are three techniques to numerically evaluating the bulk lgf .",
    "we compare all three methods to determine the most computationally efficient approach .",
    "section  [ sec : background ] defines the harmonic response functions , the relative displacement method , elastic green s function correction and discontinuity correction , and the convergence evaluation methodology .",
    "section  [ sec : results ] follows with the convergence results and discussion .",
    "we find that the discontinuity correction has the fastest convergence rate over the relative displacement and elastic green s function correction and verify our predicted convergence rates with a simple model and density functional theory results for al .",
    "the lattice green s function @xmath2 relates the displacements @xmath3 of atom @xmath4 to the internal forces @xmath5 on another atom @xmath6 of the lattice through @xmath7 conversely , the forces on an atom can be expressed in terms of displacements through the force constant matrix @xmath8 by @xmath9 translational invariance of an infinite lattice makes @xmath10 a function of the relative positions of two atoms .",
    "substituting eqn .",
    "( [ eqn : ddef ] ) into eqn .",
    "( [ eqn : gfdef ] ) gives @xmath11 , where @xmath12 is the kronecker delta function .",
    "a constant shift in the atoms positions does not produce internal forces , giving the sum rule @xmath13 and making @xmath14 the pseudoinverse of @xmath15 in the subspace without uniform displacements or forces .",
    "fourier transform of the lattice functions are defined as @xmath16 for @xmath17 in the brillouin zone ( bz ) .",
    "the integral can be approximated by a discrete sum of @xmath18 points as @xmath19 . in reciprocal space ,",
    "the matrix inverse relation and the sum rule are @xmath20 and @xmath21 respectively . for a single atom crystal basis",
    ", @xmath22 expands as for small @xmath17 as @xmath23\\simeq -\\frac{1}{2}\\sum_{{\\vec{r}}}{({\\vec{k}}\\cdot{\\vec{r}})^{2}}{\\underline{d}}({\\vec{r } } ) , \\label{eqn : dk}\\ ] ] due to the inversion symmetry of @xmath15 . at the @xmath0-point , @xmath22 is of the order @xmath24 , so @xmath25 has a second order pole .",
    "the discrete inverse fourier transform of @xmath25 does not converge due to this singularity .",
    "lattice green s function relative displacement egf correction discontinuity correction +    fig .",
    "[ fig : integrand ] shows the relative displacement method , elastic green s function correction and discontinuity correction which are used to avoid the singularity in lgf .",
    "* relative displacement.*@xcite rigid body translations leave the potential energy of the lattice unchanged , so it is enough to calculate only the relative displacements of atoms .",
    "choosing an arbitrary atom as an undisplaced origin requires calculation of @xmath26 which reduces to @xmath27 due to the sum rule and inversion symmetry . for small @xmath28",
    ", @xmath29 is of the order @xmath24 which cancels out the second order pole in @xmath25 leaving a @xmath17-direction dependent discontinuity at the @xmath0-point . the discretized version of eqn .",
    "( [ eqn : rel ] ) is @xmath30 .",
    "* elastic green s function correction . * following the procedure and notations of [ 12 ] and using eqn .",
    "( [ eqn : dk ] ) , @xmath25 for small @xmath28 expands as @xmath31^{-1 } \\\\      & =   & [ k^{2}\\tilde{\\lambda}^{(2)}(\\hat{k})-k^{4}\\tilde{\\lambda}^{(4)}(\\hat{k})+o(k^{6})]^{-1 } \\\\      & = & k^{-2}[\\tilde{\\lambda}^{(2)}(\\hat{k})]^{-1}+[\\tilde{\\lambda}^{(2)}(\\hat{k})]^{-1}\\tilde{\\lambda}^{(4)}(\\hat{k})[\\tilde{\\lambda}^{(2)}(\\hat{k})]^{-1}+o(k^{-2 } ) \\\\       & = & { \\protect\\utilde{g}^{e}}({\\vec{k}})+{\\protect\\utilde{g}^{dc}}({\\vec{k}})+o(k^{2}),\\end{aligned}\\ ] ] where @xmath32 and @xmath33 are the second and fourth order terms in a small @xmath28 expansion of @xmath22 .",
    "the fourier transform of the elastic green s function @xmath34 is the second order pole and @xmath35 is a @xmath17-direction dependent discontinuity  @xcite .",
    "the lattice green s function can be separated into an elastic part @xmath34 which should be inverse fourier transformed analytically and the rest which no longer has a pole ( it still has a discontinuity ) .",
    "the remaining part of the lgf can be inverse transformed numerically by @xmath36 where @xmath37 is a cutoff function that smoothly vanishes on the brillouin zone edges .",
    "removal of the second order pole by subtraction of a cutoff version of elastic green s function is used in the semicontinuum method of tewary@xcite .",
    "* discontinuity correction . * to further improve convergence , the discontinuity correction treats the @xmath35 part analytically@xcite . in this case , the remaining portion of @xmath25 given by @xmath38 is smooth and can be integrated numerically more efficiently .",
    "we expect the convergence rate of the discontinuity correction method to be consistent with the results for integration of smooth periodic functions , while the convergence of relative displacement and elastic green function correction methods should be dominated by the discontinuity . with @xmath39",
    "denoting the number of partitions in each direction , mid - point rule gives a @xmath40 scale for convergence rate of such integrals in all dimensions@xcite .",
    "the number of @xmath28 points @xmath18 is @xmath41 for dimensionality @xmath42 ; therefore , the convergence rate of the mid point rule scales as @xmath43 .",
    "however the egf correction and relative displacement method should have a poorer convergence compared to discontinuity correction due to the discontinuity that they create at the @xmath0-point . since the integrand is smooth elsewhere",
    ", we expect the error to be dominated by the area / volume around @xmath0-point and therefore be of the order of @xmath44 or @xmath45 .",
    "we check the predictions of convergence for the three methods using ( 1 ) a simple cubic nearest neighbor model and ( 2 ) fcc al .",
    "first , as a simplified case we consider a square ( cubic in 3d ) elastically isotropic lattice with nearest neighbor interactions and lattice constant @xmath46 .",
    "we consider only one component of the full matrix : @xmath47^{-1}$ ] .",
    "the second order pole is given by the elastic green s function @xmath48 which is multiplied by a cutoff function to vanish smoothly at the bz edges .",
    "the discontinuity correction is given by @xmath49 which is also multiplied by the cutoff function . in three dimensions we have @xmath50^{-1}\\\\    g^{e}({k_{x}},{k_{y}},{k_{z } } ) & = & \\frac{4}{\\pi \\left|\\vec{k}\\right|^{2}}\\\\   g^{dc}({k_{x}},{k_{y}},{k_{z } } ) & = & \\frac{{k_{x}}^{4}+{k_{y}}^{4}+{k_{z}}^{4}}{3\\left|\\vec{k}\\right|^{4}}.\\end{aligned}\\ ] ] for our elastically anisotropic al lattice , we obtain the force constant matrix @xmath15 from dft using ultrasoft pseudopotentials with the generalized gradient approximation@xcite . the numerical integration over the bz is done with a uniform mesh evaluating the integrand at the mid points . even and odd values of @xmath39 give meshes that include or avoid the @xmath0-point ",
    "what we call @xmath0 and non-@xmath0 centered meshes respectively . when applying the relative displacement method and egf correction ,",
    "the value of the integrand which is discontinuous at @xmath1 is assigned zero at the @xmath0-point .",
    "we calculate the numerical error as a function of @xmath18 and @xmath39 to compare the efficiency of the three methods .",
    "convergence for discontinuity correction and poorer @xmath44 convergence for egf correction and relative displacement method . using a non-@xmath0 centered mesh ( left ) causes an unusually fast convergence for the relative displacement method in elastically isotropic materials .",
    "the exponents in the power law scalings are not affected by the value of @xmath4 , while prefactors are changed in relative displacement method and are of the same order in egf and discontinuity corrections.,title=\"fig:\",width=3,height=226 ] +   convergence for discontinuity correction and poorer @xmath44 convergence for egf correction and relative displacement method . using a non-@xmath0 centered mesh ( left ) causes an unusually fast convergence for the relative displacement method in elastically isotropic materials .",
    "the exponents in the power law scalings are not affected by the value of @xmath4 , while prefactors are changed in relative displacement method and are of the same order in egf and discontinuity corrections.,title=\"fig:\",width=3,height=226 ]    fig .",
    "[ fig:2dlatt ] shows the convergence rates of relative displacement method , egf correction and discontinuity correction in the square lattice case .",
    "the discontinuity correction and egf correction scale as @xmath51 and @xmath44 respectively as expected .",
    "the value of @xmath52 does not affect the power law scalings of the convergence .",
    "the prefactors on the other hand , are changed in the relative displacement method and are of the same order in egf and discontinuity corrections .",
    "while the @xmath44 convergence for relative displacement method obtained by a @xmath0 centered mesh is in accordance with the analytical predictions , use of a non-@xmath0 centered mesh produces a convergence faster than expected for this method .",
    "this is an artifact of the isotropy of the egf .",
    "the integrand in the relative displacement method is @xmath53 . near the @xmath0-point ,",
    "@xmath25 matches @xmath34 and the leading term in the integrand is @xmath54 for an isotropic egf , @xmath55 is constant , so @xmath56 where @xmath57 is the angle between vectors @xmath58 and @xmath59 .",
    "the value of the integral over a square @xmath60 region around @xmath1 , for small @xmath28 is @xmath61 the midpoint rule integration of the same region with a non-@xmath0 centered mesh uses the k points @xmath62 , @xmath63 , @xmath64 and @xmath65 each contributing area @xmath66 .",
    "the angle between each @xmath67 and @xmath59 , are @xmath68 , @xmath69 , @xmath70 and @xmath71 .",
    "therefore , the numerical approximation for the integral around the @xmath0-point is @xmath72\\\\ & = -\\frac{k_0 ^ 2}{8}{\\protect\\utilde{g}^{e}}r^2\\left[\\cos^{2}\\theta_{1}+\\sin^{2}\\theta_{1}+\\cos^{2}\\theta_{1}+\\sin^{2}\\theta_{1}\\right ] = -\\frac{k_0 ^ 2}{4}{\\protect\\utilde{g}^{e}}r^{2}. \\end{split } \\label{eqn : nongamma}\\ ] ] which is equal to the exact value of the integral around @xmath0-point given by eqn .",
    "( [ eqn : exact ] ) . to avoid the effect of the discontinuity at the origin using a @xmath0 centered mesh , the @xmath0-point contribution to the integral",
    "is considered zero while its actual value is given by eqn .",
    "( [ eqn : exact ] ) .",
    "this is the source of the dominant error in relative displacement method on a @xmath0 centered mesh which according to eqn .",
    "( [ eqn : exact ] ) accounts for the @xmath73 dependence of the error .",
    "the @xmath73 dependence of the error is verified by comparing the ratio of prefactors of the relative displacement convergence laws for different @xmath73 values and the corresponding @xmath74 in fig .",
    "[ fig:2dlatt ] which are both approximately 27 . on the other hand",
    ", the non-@xmath0 centered mesh automatically gives the exact value of the integral around the origin based on eqn .",
    "( [ eqn : nongamma ] ) and thus produces a faster convergence limited only by the convergence of smooth periodic functions .",
    "note that if @xmath55 depends on @xmath58which is the case for anisotropic elastic response  the numerical approximation of the integral around @xmath0 will not be equal to its exact value .",
    "therefore , in general anisotropic problems the non-@xmath0 mesh is not special .     where the dimension @xmath75 is equal to three here .",
    "note that using a non-@xmath0 centered mesh creates a faster convergence for the relative displacement method as observed in the 2d case.,width=3 ]    fig .",
    "[ fig:3dlatt ] shows that the 3d results follow the same trend as the 2d ones in accordance with the expected values .",
    "both @xmath0 centered and non-@xmath0 centered meshes give @xmath43 ( @xmath76 ) and @xmath44 scale for the convergence rate of discontinuity correction and egf correction respectively .",
    "similar to the trend observed in 2d case the @xmath0 centered mesh produces the expected @xmath44 scale for the convergence of relative displacement method and the non-@xmath0 centered mesh produces faster convergence due to the isotropy of the elastic green s function .",
    "component of a 2d lgf in al .",
    "the al lattice constant @xmath77 is 4.04 .",
    "the convergence trend of lgf calculations in a fcc lattice is the same as the one observed in the simplified problem which is also consistent with the expected values .",
    "note that use of the non-@xmath0 centered mesh does not cause a fast convergence for relative displacement method due to the anisotropy of the elastic green s function.,width=3 ]    fig .",
    "[ fig : al ] shows that the convergence trends are not changed for an anisotropic long range interaction ",
    "fcc al  except for relative displacement method .",
    "the convergence rates of the three methods for the two dimensional lgf are shown .",
    "this is a relevant case that occurs in modeling dislocations .",
    "the lattice is periodic in the threading direction @xmath78 $ ] which is appropriate for studying screw dislocations . with a non-@xmath0 centered mesh",
    ", the anisotropy of the elastic green s function eliminates the fast convergence of the relative displacement method .",
    "the convergence trends of the three methods show that these trends are not specific to the simplifying assumptions of isotropy or short range interactions and therefore can be trusted in realistic calculations .",
    ".effect of dimension on the convergence rate with number of k - points and number of divisions for the relative displacement method , egf correction and discontinuity correction .",
    "@xmath39 is proportional to @xmath79 , the inverse grid spacing and @xmath80 .",
    "the discontinuity correction scales as @xmath40 ( or @xmath43 ) while the egf correction and relative displacement method scale as @xmath44 ( or @xmath45 ) . [ cols=\"<,^,^,^,^ \" , ]     table  [ tab : dimen ] summarizes the convergence results for the three methods .",
    "the expected convergence rate for a numerical integral of a smooth periodic function evaluated by mid - point rule is @xmath40 .",
    "when expressed in terms of the number of @xmath28-points used in evaluating the integral @xmath18 , the convergence rate would be proportional to @xmath43 . since the discontinuity correction leaves a smooth periodic part of the integrand",
    ", it follows the above convergence rate .",
    "the egf correction and relative displacement method also converge with the scale of @xmath44 or @xmath45 .",
    "therefore the discontinuity correction method has the fastest convergence rate .",
    "the convergence rates imply that a certain amount of error is achieved with less @xmath18 by discontinuity correction method compared to egf correction or relative displacement method which means that the discontinuity correction requires the least computational effort .",
    "although the egf correction and relative displacement method require comparable computational effort , the @xmath73 dependence of the prefactors suggests that the relative displacement method takes even more @xmath28-points than the egf correction .",
    "also note that there is a trade - off between less computational effort and more complex algorithms .",
    "egf and discontinuity corrections calculate the elastic green s function and discontinuity correction parts of the lgf analytically while relative displacement method does not require additional analytic evaluations .",
    "we find the most efficient method to compute the lattice green s function to be the discontinuity correction .",
    "the relative displacement method , elastic green s function correction and discontinuity correction have all been used in different calculations ; we applied and compared the three methods to calculate lgf for a square nearest neighbor lattice and long range fcc al .",
    "the convergence trends match the analytical values with an unusual exception for lattices with isotropic elastic green s function .",
    "it is shown that the discontinuity correction improves the convergence rate to quadratic convergence for 2d calculations compared to linear convergence for the relative displacement and elastic green s function correction ."
  ],
  "abstract_text": [
    "<S> flexible boundary condition methods couple an isolated defect to bulk through the bulk lattice green s function . </S>",
    "<S> the inversion of the force - constant matrix for the lattice green s function requires fourier techniques to project out the singular subspace , corresponding to uniform displacements and forces for the infinite lattice . </S>",
    "<S> three different techniques  relative displacement , elastic green s function , and discontinuity correction  have different computational complexity for a specified numerical error . </S>",
    "<S> we calculate the convergence rates for elastically isotropic and anisotropic cases and compare them to analytic results . </S>",
    "<S> our results confirm that the discontinuity correction is the most computationally efficient method to compute the lattice green s function . </S>"
  ]
}