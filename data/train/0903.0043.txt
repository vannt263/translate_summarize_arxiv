{
  "article_text": [
    "as the peaks of the matter distribution in the cosmic web of structure formation , clusters hold a special place in cosmology .",
    "the ever - increasing power of computers has made direct hydrodynamic simulation of complex astrophysical systems a reality .",
    "we can now simulate large cosmological boxes that include massive clusters of galaxies and incorporate complex physical phenomena ( such as star formation , the energy input from black holes , metallicity injection from supernovae , to name a few ) .",
    "x - ray observations of clusters have proven to be a rich and powerful tool to study large scale structure .",
    "the launch of the _ chandra x - ray observatory _ in particular has revealed a wealth of new information on cluster dynamics and at the same time , posed a number of new puzzles , such as the question of how clusters maintain their core temperature against catastrophic cooling .",
    "while hydro simulations can address many of these questions , it is vital that the output data from such simulations can be compared with x - ray observations in the most direct and faithful way possible .",
    "generally , galaxy cluster are simple to simulate compared to , for example , galaxies , where complex ism physics and star formation seriously complicate modeling .",
    "for that reason , it is much easier to produce realistic simulations of clusters that can be faithfully compared with observations .",
    "this comparison requires computer codes that can turn the output from a hydro simulation into a virtual observation with a given x - ray telescope  a virtual x - ray observatory .    in this paper",
    ", we present such a virtual telescope , the idl code xim , which is now publically available at the web site + http://www.astro.wisc.edu/@xmath0heinzs/xim    xim is best suited to process output from eulerian ( grid  based ) hydro codes and its direct application is the virtual observation of thermal emission from cosmic gas . while it was written to directly simulate _",
    "chandra _ and the next generation x - ray observatory _ ixo _ , it can be adapted to simulate any arbitrary x - ray telescope for a set of user - supplied response matrix files .",
    "since x - ray telescopes are imaging spectrographs ( each photon is time and energy  tagged , thus allowing a time and energy  resolved image to be constructed ) , the output from a virtual x - ray observation is a spectral imaging cube ( such as would be obtained from an integral field spectrograph in optical spectroscopy , for example ) .",
    "figure [ fig : ixosketch ] demonstrates the operation of xim in calculating such a data volume .",
    "as the astronomical community considers the possibilities presented by _",
    "ixo _ , an ultra  high resolution spectrograph with unprecedented collecting area , it is vital that we construct detailed models of what we can expect in terms of spectral line signatures from complex systems like galaxy clusters and supernova remnants .",
    "hydrodynamic simulations and subsequent virtual observation with _ ixo _",
    "present one of the best ways to explore the incredible wealth of information such data will offer .    given that no observatory with anywhere near as good a spectral resolution , let alone combined with the planned large area nd and high angular resolution , has ever successfully flown , experience from past x - ray missions is clearly limiting our imagination , and more sophisticated tools will be necessary to properly plan for the advent of _ ixo _ .",
    "at the same time , long _ chandra _ observations of diffuse objects can benefit greatly from prior numerical simulation and it is generally recommended that observers perform ray - tracing simulations when proposing long observations .",
    "xim can perform such simulations and presents a powerful tool in constructing mock _ chandra _ observations of possible targets .",
    "this paper is organized as follows : in  [ sec : implementation ] , we will describe the computational details of how xim converts input data into virtual x - ray observations , while  [ sec : discussion ] presents some examples of how xim could be used and a brief discussion of some of the limitations inherent in xim .",
    "section [ sec : conclusions ] presents a brief summary .",
    "in this section , we will describe the x  ray imaging pipeline xim .",
    "xim consistst of a suite of publically available idl programs that automate the creation of simulated x - ray data for a range of satellites , with a particular focus on simulations of _ chandra _ and _ ixo _ observations .",
    "it takes input from hydro simulations of astrophysical objects with a focus on galaxy cluster and cosmological simulations .",
    "combined with a catalog of hydro or mhd simulations , it can thus be easily made into a virtual observatory that can be scripted and operated remotely ( e.g. , via a web interface ) .    in the following we describe in sequence the steps taken by xim towards a virtual x - ray observation .",
    "xim is directly suited for grid - based hydro simulations .",
    "all input must be gridded on rectilinear grids",
    ". adaptive mesh refinement ( amr ) is only possible in the sense of staggered meshes , not yet in the sense of completely independent cell sizes .",
    "the main input variables for xim are the particle density , the gas temperature , and the gas velocity in the form of three dimensional arrays .",
    "additionally , xim can accept arrays of metal abundance ( relative to solar ) and volume filling factor of the emitting gas ( these variables can also be be passed as scalars , in which case they will be applied to the entire simulation ) .",
    "in addition , physical coordinate vectors ( and optional telescope pointing , roll angle , and off - set parameters ) are used to calculate the emitting volume and angular size of each volume element of the input data , given an object red - shift and cosmology . by default",
    ", xim uses concordance cosmological parameters of @xmath1 , @xmath2 , @xmath3 , @xmath4 .",
    "the simulation output is calculated on a user specified energy grid , which can be set to correspond one  to  one to the energy channel mapping of the instrument .",
    "this allows the user to easily create full resolution spectra as well as multi - color images , or low - resolution spectra for reduced computational expense ( high resolution spectra at _ ixo _ resolution can be very costly to run ) .",
    "a uniform turbulent velocity broadening can be applied to the spectrum to simulate sub - grid effects .",
    "a uniform foreground hydrogen column density can be specified for photo - electric absorption .        by default",
    ", xim uses the publically available apec model to calculate spectra from thermal plasma emission ( assuming gas in coronal equilibrium ) for each cell @xcite . apec self  consistently calculates the equilibrium ionization balance for a thermal plasma .",
    "atomic data are taken from the atomdb using aped @xcite and combined with bremsstrahlung continuum for all species .",
    "apec output is provided as a table of spectral models .",
    "given the fact that apec itself provides a table of model spectra , and given that the computational expense of extracting a spectrum from apec is high , the most economical method of calculating a large number of spectra with xim is by creating an oversampled table of model spectra for the entire temperature range spanned by the simulation .",
    "thus , the spectral projection in xim is based on interpolation on a table of model spectra , on a logarithmic temperature and photon energy grid ( see  [ sec : projection ] ) .",
    "the default temperature binning of the table is 66 bins per decade in temperature ( significantly oversampled with respect to the apec model output and sufficient for high - accuracy spectral interpolation , again see  [ sec : projection ] ) .",
    "two sets of spectral tables are created : one for helium and hydrogen , assuming primordial cosmic helium abundance , and one for heavier elements ( with relative abundance of metals fixed to the solar ratios ) .",
    "the metal abundance @xmath5 can be specified for each cell . a model grid at default _ chandra _",
    "resolution is shown in fig .",
    "[ fig : apec ] .",
    "xim is not limited to the implementation of apec described above for spectral modeling .",
    "any user - defined spectral model can be applied ( e.g. , simple powerlaw spectra ) and an arbitrary set of spectral parameters and input data can be passed .",
    "however , because xim is optimized for thermal emission , the spectral model must be such that the emission is proportional to some power of a density variable ( this could be relativistic electron pressure , which enters synchrotron emission as the 7/4 power ) and a temperature variable ( which controls the spectral shape and normalization , e.g. , synchrotron age ) .    the output spectra must be provided in the form of a two - dimensional table in temperature and photon energy with logarithmic spacing on the energy axis      xim allows the specification of the neutral galactic hydrogen column density to calculate photo - electric foreground absorption following the wisconsin absorption model ( wabs * ? ? ?",
    "the spectral projection along the line of sight is performed along an arbitrary viewing angle .",
    "for each cell of the input data , a unique spectrum is calculated for the cell temperature , cell density , and its proper doppler shift , given the line  of  sight velocity of that cell .    to project along an arbitrary line  of  sight ,",
    "the input data arrays are rotated ( using tri - linear interpolation ) onto a new grid that orients the x - axis along the line  of  sight vector .",
    "the input velocity arrays are also projected onto the line  of  sight vector to calculate a line  of  sight velocity for every cell . line ",
    "of - sight integration then simply proceeds along the x - axis of the new array .",
    "the doppler frequency correction from the emitting to the observed frame is @xmath6 if the frequency grid is logarithmically spaced , doppler shift is a simple addition .",
    "this suggests that spectral calculations should be performed on logarithmic grids , which is the model adopted by xim . on a logarithmic energy grid ,",
    "doppler shift is a simple linear shift along the grid , which is computationally trivial .    thus , given an output energy grid ( either user  defined or fixed to the instrument channel map ) , xim creates an over  sampled logarithmically spaced energy grid that is padded on both sides by the maximum doppler shift encountered in the input data and takes into account the energy resolution of the instrument , additionally extending the grid to enclose a minimum of 99% of the energy at the grid edge .",
    "the energy resolution of the logarithmic grid is set to oversample the target output grid by at least a factor of 2 .",
    "since the energy grid used by xim is logarithmic , most of the energy range is oversampled by a larger factor .",
    "doppler shift is performed by linear interpolation between the nearest two integer shifts along the energy axis that straddle the actual doppler shift value of each cell .",
    "this accurately reproduces the mean line centroid energy and leads to a small error in line width that is well below the energy bin width and well below the intstrument resolution .",
    "the accuracy of this procedure is demonstrated in fig .",
    "[ fig : eplot ] , which shows the line centroid energy determined by xspec for a gaussian spectral line with varying doppler shift virtually observed with _ ixo _",
    "( to sufficiently high signal  to  noise to eliminate statistical error ) .",
    "in addition to the doppler shift correction , the line  of  sight integration must interpolate the spectral model for each cell from the table provided by the spectral model calculation described in  [ sec : spectra ] .",
    "this is done by linear interpolation between the two nearest temperature spectra in the model table .",
    "given the default dense sampling of the spectral model grid ( 66 temperature bins per temperature decade ) , this method provides a smoothly varying , accurate description of the spectra as a function of cell temperature .",
    "given both temperature and doppler calculations , the line  of  sight integration is then performed on a cell  by  cell basis . for an input grid of size @xmath7 and a logarithmic energy grid with @xmath8 bins ,",
    "this involves @xmath9 calculations , which can be very time consuming and lends itself to trivial parallelization . a simple implementation of parallelization of this step is included in xim .    the line  of  sight integration is performed _ before _",
    "re - gridding to the instrument pixel scale to preserve the maximum amount of velocity detail from the original hydro simulation .",
    "however , for high - resolution spectra , as encountered with _ ixo _ , memory requirements can become extreme . in some cases",
    ", it is therefore advisable to re - sample the input grid to lower resolution , appropriate for the lower angular resolution of the telescope ( however , this procedure will lead to an under - estimate of the doppler width of the lines ) .    to keep memory requirements at a minimum",
    ", spectra are accumulated on a pixel  by  pixel basis ( i.e. , the line  of  sight integration is performed along the line of sight first , then across the image ) .",
    "thus , only the input data and the spectral cube of dimension @xmath10 have to reside in memory .      the output from the line  of  sight projection encapsulates the object s cosmological red - shift , but it is still instrument  indepent ( though often the energy grid will be chosen to be suitable to a particular instrument to keep computational expense and memory requirements at a reasonable level ; e.g. , for virtual _ chandra _ observations , emphasis should be placed on spatial resolution , while for virtual _ ixo _ obsevations , the energy grid should be at the highest resolution possible ) .    starting from the output file of the line  of  sight inegration ,",
    "virtual observations with different target telescopes and instruments are performed in a number of steps described below .",
    "the line  of  sight integrated spectral cube is convolved with the telescope point spread function ( psf ) .",
    "xim allows user specified psf models .",
    "note that off - axis effects on the psf and vignetting are currently not included in xim , i.e. , it is assumed that the psf is uniform across the field  of  view .",
    "the default psf used for _ ixo _ simulations was extracted from the _ ixo _ simulator simx , which provides a monochromatic psf ( specified at 6kev ) .",
    "the default psf for _ chandra _ simulations was extracted from marx ray  tracing simulations and is interpolated in energy with a native spacing of 0.5 kev .",
    "the low - energy resolution is 0.5 arcseconds ( see _ chandra _ users guide for more information on the energy dependence of the psf ) . more accurate _",
    "chandra _ imaging simulations , including vignetting and off - axis effects , can be achieved using the optional marx interface described in ",
    "[ sec : chandra ]",
    ".      a critical component of realistic x - ray simulations is the incorporation of the effective area of the telescope as a function of photon energy ( encapsulating mirror effective area and detector quantum efficiency , typically encoded in the ancillary response file in x - ray astronomy ) and the redistribution function of photon energy ( reflecting the spectral resolution of the telescope and detector , typcially encoded in the response matrix file ) .",
    "this happens in three steps :    * given a response file ( following the cal / gen/92 - 002 fits specifications ) , xim either re - grids the telescope response to the logarithmic energy bin on the data energy axis and the user - supplied output energy grid on the the detector axis , or , if xim uses native telescope energy channels , the line  of  sight projection is re - gridded from logarithmic onto detector channels .",
    "* next , the line  of - sight projected , psf ",
    "convolved data cube is re - gridded onto physical detector pixels for the specified telescope / detector . *",
    "finally , xim convolves the spectral cube with the instrument response onto the specified output energy grid , resulting in a spectral cube of count rates per energy bin per pixel as detected by the instrument .",
    "xim assumes poisson noise for counting statistics and produces an idl data file that includes the detector count rate ( without statistical error ) and a counts file for the user - specified exposure time that includes poisson errors .",
    "in addition to idl output , xim can produce a fits events file that can be analyzed with standard x - ray astronomy tools like ftools and ds9 .",
    "xim can also produce a single fits spectrum for the entire observation .",
    "post - processing with the spectral generator of xim allows the application of idl mask arrays to select sub - regions of the spectrum ( or select different weighting for different pixels for the combined spectrum ) and produce fits spectra that can be analyzed with xspec , isis , and sherpa .",
    "it is possible to create multiple different spectral files for different regions from the same ximulation ( e.g. , annuli around a cluster center for deprojection analysis ) .",
    "xim adds sky background and instrumental background to the virtual observation . these can be user - specified spectra or standard background estimates included for _ chandra _ and the _ ixo _ calorimeter xms .",
    "sky background is treated like source photons and is folded through the instrument response ( though assumed to be uniform across the field  of  view , so no psf convolution is performed ) . instrument background is added directly to the output counts without convolution with the response .",
    "the default background for _ chandra _ was extracted from the black sky background file for post-2000 data .",
    "the _ ixo _",
    "background estimate is based on the most recent estimates available on the telescope wiki page and will be continually updated as more sophisticated estimates become available .",
    "xim comes with default _ chandra _ observing parameters ( the latest aimpoint response files should be downloaded by the user from the chandra web archive ) .",
    "this alows high - fidelity simulations of objects near the aimpoint .",
    "however , for observations of objects far off - axis , psf effects and vignetting should be taken into account .",
    "thus , for the most realistic virtual _ chandra _ observations , xim uses marx ( the official _",
    "chandra _ simulation software ) to perform ray - tracing simulations of the observation .",
    "the output is again a fully compliant _",
    "_ fits events file that can be analyzed using ciao and the _ chandra _ pipeline like regular _ chandra _ data .",
    "having briefly described the steps taken by xim to convert a grid of data taken from a hydro simulation into a virtual x - ray observation , we will present some examples of possible applications ( the details of which will be presented in a separater paper ) and discuss some of the limitations .        before going into more detail",
    ", we list several examples of possible applications of xim for _ chandra _ :    * a good demonstration of the power of x - ray imaging is the unsharp  masked image of the perseus cluster @xcite that shows a series of concentric ripples ( identified as sound waves and a weak shock ) . while direct one  to  one simulations of a perseus are not possible given the difficulty in reproducing the details in cluster weather that likely lead to the asymmetric appearance of the cluster , it is nonetheless very usefull to examine hydro simulations for whether they can reproduce the observed surface brightness fluctuations induced by these waves .",
    "* x - ray astronomy makes use of object colors for selection effects . for example , @xcite used a color cut on a long _ chandra _ observation of the virgo cluster to detect a weak shock driven into the cluster by the radio galaxy m87 at the center . * as a further example , a cosmological simulation containing multiple galaxy clusters can be examined for the optical set of bands within which to select galaxy clusters , depending on the instrument used .",
    "multi - color imaging is particularly easy and fast using xim , given that only a small number of spectral channels have to be calculated ( apec calculates the integrated photon luminosity for a given energy band , so no interpolation is involved when calculating broad band images ) .",
    "[ fig : chandra_a ] shows the simulated _ chandra _ surface brightness and the unsharp - masked image for a hydro simulation of cygnus a. the details of the hydrodynamical simulation are described in @xcite and we limit this discussion to a very brief summary of the features of this simulation : we used the publically available flash code @xcite to simulate the injection of a super - sonic , powerful jet into a galaxy cluster ( taken from @xcite ) . the jet power ( @xmath11 ) and",
    "the cluster temperature ( @xmath12 ) and central density match the canonical parameters for cygnus a very well ( e.g. , citepwilson:02 ) .",
    "when placing the simulated cluster at the red - shift @xmath13 of cygnus a ( picking a time step that reproduces the observed angular sizes of the x - ray cavities and the shock in cygnus a ) the simulated _ chandra _ surface brightness is in good agreement with the actual _ chandra _ observation ( to within about 10% ) .      using the same hydro simulation described in ",
    "[ sec : chandra_a ] , we used xim to simulate a high  resolution spectrum of a powerful radio galaxy like cygnus a observed with _ ixo _",
    ". a more detailed description of the power of high  resolution spectroscopy for the study of radio galaxies will be published in a companion paper . here",
    "we wish to demonstrate the power of such observations using a simple example .",
    "the high spectral resolution of _ ixo _ will allow detailed kinematic mapping of the expanding cavities of radio galaxies .",
    "figure [ fig : ixo_a ] shows three spectra , one through the cluster center and two through the expanding cavities . the line emission is due to the k-@xmath14 lines from fexxv and fexxvi ( helium and hydrogen  like iron ) , which emit abundantly in hot cluster atmospheres like that of cygnus a.    the two spectra taken through the cavity centers show clear evidence for doppler - shifted line emission from the front and back walls of the cavity and it is possible to simply read off the expansion velocity from the spectrum to be @xmath15 from the separation of the three right - most peaks of the cyan spectrum .",
    "these three peaks are all due to the resonance line of fexxv from the rear wall ( left peak at @xmath16 ) , the front wall ( right peak at @xmath17 ) and the fore and background cluster emission ( middle peak at @xmath18 ) .",
    "the expansion line  of  sight velocity in the simulation is @xmath19 .",
    "more sophisticated model fitting would allow us to determine the emission measure distribution at different velocities , possibly allowing a deconvolution of the internal dynamics of the shell ( which is not moving at uniform velocity ) .",
    "this could be used to , for example , determine the rate at which gas is flowing back along the shell as well as detecting the creating of high entropy gas around shells as direct evidence of heating and feedback .",
    "other obvious examples of using high - resolution x - ray spectroscopy in the context of galaxy clusters include detailed apec model fits to determine the temperature and metallicity distribution of the cluster gas .",
    "demonstrations of the power of this method are beyond the scope of this paper , but the _ xmm - newton _ obervations of galaxy clusters that gave rise to the second cooling flow problem ( ultimately leading to the current paradigm of agn heating of clusters ) provide evidence of the power of this method @xcite even at the lower resolution and throughput of _ xmm - newton _ .",
    "it is also possible to incorporate and test multi - phase models versus observations .",
    "this can be easily achieved by super - imposing multiple xim simulations ( one for each phase ) .",
    "finally , we will briefly discuss some of the current limitations on the software that are not likely to be remedied or implemented in the near future .      based on the projection method",
    ", the code can only handle input data on regular grids that can be described by a single , rectungular three dimensional matrix .",
    "this excludes true amr grids ( though it allows for staggered grids ) and , naturally , lagrangian formulations from direct application . to use xim with amr or sph output data",
    ", they will have to be re - gridded onto a regular grid .",
    "the same is true for non - cartesian grids .",
    "the examples shown above were all calculated with the amr code flash and then re - gridded onto a regular cartesian grid .      direct integration along the coordinate axes is computationally simpler and faster , which is the method employed by xim .",
    "this implies that all input arrays have to be rotated prior to the spectral projection . as with regular projections through a rectangular volume for arbitrary line  of  sight vectors , missing values lead to the appearance of projection effects ( e.g. , the volume is rendered as a projected box .",
    "currently , xim does not allow for period boxes to be rendered without data loss .",
    "it is possible to clip the data , however , to avoid the appearance of projection artifacts from missing values .",
    "as already described , xim incorporates the apec thermal plasma emission code for plasma in coronal equilibrium . the method used to interpolate",
    "spectra assumes that the spectral shape depends only on one parameter ( the temperature or an equivalent variable that can be passed instead of temperature ) and that the emissivity is proportional to the square of the density ( or to some power of an equivalent variable that can be passed instead )    xim allows user - defined spectral models as long as they can be written in such a way that they depend on two parameters ( one that determines the spectral shape , such as temperature and one that affects the normalization through a powerlaw dependences ) .",
    "as long as this is the case , it is straight forward to incorporate other models .",
    "for example , synchrotron emission could be included by having the spectral shape ( index and/or cutoff ) determined by one parameter ( which is passed as the variable t , but could in fact be the spectral age of the plasma ) and the overall normalization is determined by the non - thermal pressure ( which would be passed as the parameter n ) .",
    "spectral shifts would be incorporated through the line  of  sight velocity v.    clearly , this method is somewhat limiting in the way that spectral models can be formulated .",
    "for example , photo - ionized plasmas will be difficult to implement .",
    "as already mentioned above , xim assumes a uniform psf across the field  of  view and neglects vignetting . for _ ixo",
    "_ , these extent of these effects is currently not well known . for _ chandra _",
    ", the best way to incorporate these effects is to use the marx option to pipe the spectral cube through the telescope ray tracing software .",
    "this will produce the most realistic _",
    "chandra _ simulations .",
    "we have presented a description of the public code xim .",
    "the code produces virtual x - ray observation from hydro simulation of astrophysical plasmas .",
    "the code is best suited for the simulation of thermal emission , using the apec model .",
    "xim incorporates detailed telescope parameters and responses for _ chandra _ and _ ixo _ .",
    "examples of the application for xim include multi - color imaging , detailed surface  brightness mapping ( e.g. , using unsharp  masking ) , high - resolution kinematic studies of the dynamics of galaxy clusters , groups , and supernova remnants , and multi - temperature , multi - phase high resolution spectroscopy of space plasmas .",
    "current limitations include the restriction to regular , rectangular grids , spectral models that can be parameterized in a fashion equivalent to thermal emission , and restriction to on - axis imaging performance .                      , r.  k. , brickhouse , n.  s. , liedahl , d.  a. , & raymond , j.  c. 2001 , in astronomical society of the pacific conference series , vol .",
    "247 , spectroscopic challenges of photoionized plasmas , ed .",
    "g.  ferland & d.  w. savin , 161"
  ],
  "abstract_text": [
    "<S> we present a description of the public code xim , a virtual x - ray observatory . </S>",
    "<S> xim can be used to convert hydrodynamic simulations of astrophysical objects , such as large scale structure , galaxy clusters , groups , galaxies , supernova remnants , and similar extended objects , into virtual x - ray observations for direct comparison with observations and for post - processing with standard x - ray analysis tools . by default </S>",
    "<S> , xim simulates _ </S>",
    "<S> chandra _ and the international x - ray observatory _ ixo _ , but can accommodate any user - specified telescope parameters and instrument responses . </S>",
    "<S> examples of xim applications include virtual _ chandra _ imaging of simulated x - ray cavities from agn feedback in galaxy clusters , kinematic mapping of cluster velocity fields ( e.g. , due to mergers or agn feedback ) , as well as detailed spectral modeling of multi - phase , multi - temperature spectra from space plasmas . </S>"
  ]
}