{
  "article_text": [
    "a metric tree is a geodesic metric space in which every triangle is isometric to a ( maybe degenerate ) tripod , i.e. to the union of three segments with a common point which is only common point for any pair of the segments . a metric tree @xmath3 is simplicial if it admits a triangulation .",
    "in this case , we can speak about vertices and edges of @xmath3 .",
    "we always assume that every edge of a simplicial metric tree has length 1 .",
    "the _ valence _ of a vertex is the number of edges adjacent to it .",
    "the _ binary _ metric tree is a simplicial metric tree in which the valence of every vertex equals 3 .",
    "[ thm : main1 ] every gromov hyperbolic group @xmath0 admits a quasi - isometric embedding into the product of @xmath1 copies of the binary metric tree where @xmath2 is the topological dimension of the boundary at infinity .",
    "this result is optimal in the following strong sense : any gromov hyperbolic group @xmath0 with @xmath4 admits no quasi - isometric embedding into the @xmath5-fold product of any metric trees , @xmath2 , even if the product is stabilized by any euclidean factor @xmath6 , @xmath7 .",
    "this is proven in @xcite .    to give appropriate credit",
    "we remark that the proof of the result relies in an essential way on the results and methods of the papers @xcite and @xcite .",
    "actually in this paper we only consider @xmath0 as a metric space and do not use the group structure .",
    "indeed we will show the following :    [ thm : mainthmcapdim ] let @xmath8 be a visual hyperbolic space such that the boundary @xmath9 is a doubling metric space .",
    "then @xmath8 admits a quasi - isometric embedding into the product of @xmath1 copies of the binary metric tree , where @xmath5 is now the capacity dimension of the boundary at infinity .    for the definition of a visual hyperbolic space",
    "see sect .",
    "[ subsect : hypspace ] .",
    "any cayley graph of every hyperbolic group is a visual , cocompact hyperbolic geodesic space and its boundary at infinity is doubling with respect to any visual metric .",
    "thus we obtain theorem  [ thm : main1 ] from theorem  [ thm : mainthmcapdim ] using the following result of @xcite :    [ thm : cdimhypspace ] the capacity dimension of the boundary at infinity of every cocompact , hyperbolic geodesic space @xmath10 coincides with the topological dimension , @xmath11 .",
    "the result should be compared with the bonk - schramm embedding theorem @xcite , which itself uses the assouad embedding result @xcite .",
    "this embedding result can be stated in the following way    [ thm : bosch ] let @xmath8 be a visual gromov hyperbolic space such that the boundary @xmath9 is a doubling metric space .",
    "then there is a number @xmath12 such that @xmath8 admits a rough similar embedding into the standard hyperbolic space @xmath13 .",
    "the advantage of the bonk - schramm embedding is that the target space is ( in contrast to a product of trees ) itself a hyperbolic space and the property of the embedding map ( rough - similarity ) is quite strong .",
    "the dimension @xmath14 of the target space depends however on the doubling constant of @xmath9 .",
    "the advantage of our embedding is that the dimension of the target space is optimal and depends only on the topological ( resp .",
    "capacity ) dimension of @xmath9 and not on the doubling constant of the metric .",
    "this becomes clear in the following examples .",
    "consider the hyperbolic buildings @xmath15 , @xmath16 , @xmath17 , whose apartments are hyperbolic planes with curvature @xmath18 , whose chambers are regular hyperbolic @xmath19-gons with angle @xmath20 and whose link of each vertex is the complete bipartite graph with @xmath21 vertices , studied by bourdon @xcite",
    ". indeed there are infinitely many quasi - isometry classes of these buildings ( distinguished by the conformal dimension of their boundary ) .",
    "however all of them admit cocompact group actions and the topological dimension of its boundary is @xmath22 .",
    "thus by our result , they all allow quasi - isometric embeddings into the product of two binary trees . note that a product of two binary trees is ( the simplest nontrivial ) affine building of rank 2 .    if @xmath10 and @xmath23 are hyperbolic and @xmath24 is a quasiisometric embedding , then the conformal dimensions satisfy @xmath25 ( see ( * ? ? ?",
    "* remarques 1.7 ) ) .",
    "thus the existence of a quasi - isometric embedding of @xmath15 into a hyperbolic space @xmath13 , implies @xmath26 .",
    "the cited paper contains the estimate @xmath27 hence we see that the dimension of the target space @xmath13 has to be arbitrarily large as @xmath28 .",
    "we state some consequence of our result and some possible direction of research : in dimension theory , there is an important notion of a dimensionally full - valued space .",
    "one of equivalent definitions ( due to p.  alexandrov ) says that a compact space @xmath10 is _ dimensionally full - valued _ , if @xmath29 for every compact space @xmath23 .",
    "for example , every 1-dimensional compact space is dimensionally full - valued , while there are 2-dimensional compact spaces , the famous pontryagin surfaces , which are dimensionally nonfull - valued . in the paper @xcite we introduced a dimension invariant , the _ hyperbolic dimension _",
    "@xmath30 of a metric space .",
    "it has the usual properties of a dimension and is related to the asymptotic dimension @xmath31 by @xmath32 .",
    "we have @xmath33 , but @xmath34 .",
    "thus it is a direct consequence of theorem  [ thm : main1 ] that for the hyperbolic dimension of the @xmath5-fold product of the binary tree @xmath3 , we have @xmath35 this raises the question , is it true that the binary tree is dimensionally full - valued for the hyperbolic dimension in the class of all ( proper ) metric spaces , that is , @xmath36 for every ( proper ) metric space @xmath10 ? the same question is seemingly open also for the asymptotic dimension . as far as we know , currently there is no known example of metric spaces @xmath10 , @xmath23 , which violates the equalities @xmath37 or @xmath38 as well as only in rare cases these equalities are known .",
    "in this section we give an outline of the proof of theorem [ thm : mainthmcapdim ] .    * 1 step * _ hyperbolic approximation : _    the hyperbolic space @xmath8 has the ideal boundary @xmath39 . during the proof we will make all constructions and calculations purely in the space @xmath40 .",
    "in particular we will model also the `` interior '' @xmath8 as objects in the boundary @xmath41 .",
    "this realization of the interior in terms of the boundary can be easily demonstrated in the upper half space model of the standard hyperbolic space @xmath42 .",
    "a point @xmath43 in the upper half space @xmath42 can be viewed as the ball @xmath44 in the ideal boundary .    in our situation",
    "the boundary @xmath40 is ( in contrary to the upper half space model of @xmath42 ) compact , but the analogy still works . actually to the metric space @xmath40 we will associate a metric graph @xmath10 whose vertex set @xmath45 consists of a set of balls in @xmath40 .",
    "there is in addition a parameter @xmath46 such that the vertex set @xmath45 decomposes as @xmath47 , and every element in @xmath48 is a metric ball @xmath49 of radius @xmath50 in @xmath40 .",
    "we prove the existence of a quasi - isometric embedding @xmath51 and it holds that @xmath52 .    thus roughly speaking we have represented the space @xmath8 as sets of balls in @xmath40 and the radii of the balls are all of the form @xmath50 for integers @xmath53 .",
    "this first step is carried out in section [ sect : hypap ]    * step 2 : * _ embedding of @xmath10 in a product of infinite valence trees _    also this step can be visualized in the easiest way in the upper half space model of @xmath42 with the euclidean space as its boundary .",
    "consider a family of subsets of euclidean space as depictured in the following figure [ fi:1 ] .",
    "it is easy to see that three of these families cover @xmath54 or in general @xmath55 of these families cover @xmath56 . in this way one obtains a covering of @xmath56 which is colored by @xmath55 colors",
    "such that sets with the same color do not intersect .",
    "using suitable homotheties one can construct such families on each scale @xmath57 , for integers @xmath53 and some parameter @xmath58 in a way such that for two sets of the same color ( and different scales ) either one is contained in the other or the two sets are disjoint . more precisely there are @xmath55 families of subsets @xmath59 of @xmath10 , indexed by @xmath60 , @xmath61 . for fixed @xmath62",
    "the family @xmath59 is a union @xmath63 .",
    "if @xmath64 , @xmath65 , then either @xmath66 or one of the two sets is contained in the other .",
    "the figure  [ fi:2 ] shows for one color @xmath62 ( black in the picture ) two neighboring levels @xmath53 and @xmath67 .",
    "note that some smaller cubes of the level @xmath67 are hidden behind the large black cubes of level @xmath53 .",
    "therefore @xmath59 has combinatorially the structure of a tree ( with infinite valence ) .",
    "a vertex @xmath68 can be considered as a large black cube of level @xmath53 in figure  [ fi:2 ] .",
    "replace this cube by a `` clear window '' . then draw all black cubes of level @xmath67 , @xmath69 which fit into this window .",
    "we then see the well picture of the complement to a sierpinski carpet formed out of many smaller and smaller black cubes .",
    "all these small cubes that we can see ( i.e. which are not hidden by other black cubes ) are the neighbors with level @xmath70 of @xmath64 .",
    "we denote this tree by @xmath71 .",
    "if we on the other hand fix @xmath53 , then @xmath72 is an open covering such that the lebesgue number of this covering as well as the diameter of each of its elements is ( up to fixed multiplicative constants ) of the same size @xmath57 , i.e. of the same size as the radii of the balls @xmath49 for @xmath73 .",
    "it is now possible to define a map @xmath74 .",
    "the map is defined on the set @xmath45 of vertices .",
    "a vertex @xmath75 , which is just the ball @xmath49 , is mapped to the smallest @xmath68 such that @xmath76 .",
    "it turns out that the product map @xmath77 is a quasi - isometry .    for the standard hyperbolic space",
    "this construction is carried out in @xcite . for more general spaces @xmath40 ,",
    "this construction is carried out in @xcite , where then @xmath5 is the capacity dimension of @xmath40 .",
    "we discuss the capacity dimension in section [ sect : capdim ] and the quasi - isometric embedding into the product of trees in section [ sect : trees ] using a simplified version of the construction from @xcite .",
    "a significant simplification is achieved due to replacing the hyperbolic cone construction over @xmath40 used in @xcite by a hyperbolic approximation of @xmath40 which is much more suitable for this and many other purposes .",
    "* step 3 : * _ alice diary _",
    "this part is completely independent from the rest of the paper .",
    "the main ideas of this construction are from @xcite .",
    "we construct a map from a certain infinite valence tree into a finite valence tree .",
    "start with a finite alphabet @xmath78 and consider the set @xmath79 of words in the alphabet @xmath78 .",
    "then @xmath79 is an infinite set and hence the corresponding tree @xmath80 ( see section [ sect : trees ] ) of finite sequences in @xmath79 is of infinite valence .",
    "alice diary is a certain map @xmath81 , where @xmath82 is finite , hence the tree @xmath83 is of bounded valence ( and thus quasi - isometric to the binary tree ) . in this map",
    "the morse - thue sequence plays an important role in order to `` synchronize '' diaries .",
    "this step is contained in the sections [ sect : alice ] and [ sect : mtsequence ] .",
    "* step 4 : * _ labelling of the trees @xmath71 and the proof of the main theorem _",
    "the tree @xmath71 is of infinite valence , i.e. a vertex in the tree has infinite many neighbors .",
    "however the neighbors have different `` levels '' .",
    "let us consider a vertex in the tree @xmath71 .",
    "this vertex is just a set @xmath84 .",
    "a neighbor of level @xmath67 is a set @xmath85 with @xmath86 .",
    "using the fact that the space @xmath40 is doubling , one can see that there is a constant @xmath87 such that @xmath64 has at most @xmath87 neighbors of level @xmath67 and more generally only @xmath88 neighbors of level @xmath89 .",
    "we will more generally show that it is possible to `` label '' the tree @xmath71 by a finite alphabet .",
    "this means that we can isometrically embed the tree @xmath71 in a tree @xmath80 , which is the tree of sentences of a finite alphabet @xmath78 .",
    "this makes it possible to apply the construction of step 3 . by restricting the diary map @xmath81 to the trees @xmath71 for all colors @xmath62",
    ", we obtain the map @xmath90 .",
    "it is important to mention that alice diary map @xmath81 is by no means a quasi - isometry .",
    "however , the composition @xmath91 turns out to be quasi - isometric .",
    "this final step is carried out in section  [ sect : colorhypap ] .",
    "it remains to note that @xmath92 is quasi - isometric to a subtree of the binary tree , see lemma  [ lem : binary ] ( the tree @xmath92 is a simplicial metric tree whose vertices except the root have one and the same finite valence @xmath93 .",
    "it can be isometrically embedded into a homogeneous simplicial metric tree with valence @xmath5 of the vertices . on the other hand ,",
    "it is proven in @xcite that every two homogeneous simplicial metric trees with finite valence @xmath94 are even bilipschitz equivalent to each other ) .",
    "let @xmath10 be a metric space .",
    "given points @xmath95 , @xmath96 we denote by @xmath97 the distance of these points .    a subset @xmath98 in a metric space @xmath23 is called a _ net _ , if the distances of all points @xmath99 to @xmath78 are uniformly bounded .",
    "a map @xmath24 between metric spaces is said to be _ quasi - isometric , _ or a _ quasi - isometric embedding _ if there are @xmath100 , @xmath101 , @xmath102 , such that @xmath103 for all @xmath95 , @xmath104 .",
    "if in addition , the image @xmath105 is a net in @xmath23 , then @xmath106 is called a _ quasi - isometry _ , and the spaces @xmath10 and @xmath23 are called quasi - isometric . in other words ,",
    "a map is quasi - isometric if it is bilipschitz on large scales . if @xmath107 then @xmath106 is called _",
    "rough similar_.    a metric space @xmath40 is _ doubling _ , if there exists a constant @xmath108 , such that every ball of radius @xmath58 in @xmath40 can be covered by at most @xmath109 balls of radius @xmath110 .      for @xmath95 , @xmath111 , @xmath112",
    "we define the _ gromov product _ @xmath113 let @xmath114 .",
    "a triple @xmath115 is called a _ @xmath116-triple _ , if @xmath117 for @xmath118 , where the indices are taken modulo 3 .",
    "the space @xmath10 is called _",
    "@xmath116-hyperbolic _ if for every @xmath119 , @xmath95 , @xmath111 , @xmath112 @xmath120    @xmath10 is called _ hyperbolic _ , if it is @xmath116-hyperbolic for some @xmath114 .",
    "the relation  ( [ eq : de - eq1 ] ) is called the _",
    "@xmath116-inequality _ with respect to the point @xmath121 .",
    "if @xmath10 satisfies the @xmath116-inequality for one individual base point @xmath121 , then it satisfies the @xmath122-inequality for any other base point @xmath123 , see for example @xcite .",
    "thus , to check hyperbolicity , one has to check this inequality only at one point .",
    "let @xmath10 be a hyperbolic space and @xmath121 be a base point .",
    "a sequence of points @xmath124 _ converges to infinity , _ if @xmath125 two sequences @xmath126 , @xmath127 that converge to infinity are _ equivalent _ if @xmath128 using the @xmath116-inequality , one easily sees that this defines an equivalence relation for sequences in @xmath10 converging to infinity .",
    "the _ boundary at infinity _",
    "@xmath129 of @xmath10 is defined as the set of equivalence classes of sequences converging to infinity .    for points",
    "@xmath130 , @xmath131 we define their gromov product by @xmath132 where the infimum is taken over all sequences @xmath133 , @xmath134 .",
    "note that @xmath135 takes values in @xmath136 $ ] and that @xmath137 if and only if @xmath138 .    if @xmath130 , @xmath139 , @xmath140 , then @xmath141 is a @xmath116-triple .",
    "a metric @xmath142 on the boundary at infinity @xmath129 of @xmath10 is said to be _ visual _ , if there are @xmath121 , @xmath143 and positive constants @xmath144 , @xmath145 , such that @xmath146 for all @xmath130 , @xmath131 . in this case",
    ", we say that @xmath142 is the visual metric w.r.t .",
    "the base point @xmath119 and the parameter @xmath147 .",
    "the following is well known , see e.g. @xcite , @xcite .",
    "[ lem : visualmetric ] let @xmath10 be a hyperbolic space . then for any @xmath121",
    ", there is @xmath148 such that for every @xmath149 $ ] there exists a metric @xmath142 on @xmath129 , which is visual w.r.t . @xmath119 and @xmath147 .",
    "a hyperbolic space @xmath23 is said to be _ visual _ , if for some base point @xmath150 there is a positive constant @xmath87 such that for every @xmath99 there is @xmath151 with @xmath152 ( one easily sees that this property is independent of the choice of @xmath119 ) . for hyperbolic geodesic spaces",
    "this property is a rough version of the property that every segment @xmath153 can be extended to a geodesic ray beyond the end point @xmath111 .",
    "let @xmath8 be a hyperbolic space .",
    "then its boundary @xmath41 is a complete metric spaces , since @xmath40 carries a visual metrics with respect to some base point @xmath154 and with respect to some parameter @xmath155 .    in this chapter",
    "we start on the other hand with an arbitrary complete bounded metric space @xmath156 and construct a geodesic hyperbolic space @xmath10 out of @xmath40 , such that @xmath40 can be identified with the boundary at infinity of @xmath10 .",
    "the space @xmath10 is a metric graph and its vertices are balls in @xmath40 .",
    "we call @xmath10 a hyperbolic approximation of @xmath40 .",
    "finally we prove the following .",
    "let @xmath8 be a visual hyperbolic space and let @xmath40 be its boundary at infinity .",
    "let @xmath10 be a hyperbolic approximation of @xmath40 , then @xmath52 and there exists a quasi - isometric embedding @xmath51 .",
    "the construction of a hyperbolic approximation of a metric space @xmath40 is a further development of constructions from @xcite in the case @xmath40 is a compact subspace of an euclidean space and from @xcite for arbitrary compact spaces .",
    "our construction differs from that of @xcite by the definition of radial edges and radii of balls , which provides some technical advantages .",
    "a hyperbolic approximation can be defined and turns out to be useful in many situations for arbitrary metric spaces . for simplicity",
    ", we consider here hyperbolic approximations only of bounded spaces .",
    "theorem  [ thm : approximate ] below is similar to ( * ? ? ?",
    "* proposition 2.1 ) .",
    "a subset @xmath45 of a metric space @xmath40 is called @xmath147-_separated _ , @xmath157 , if the distance @xmath158 for each distinct @xmath75 , @xmath159 .",
    "note that if @xmath45 is maximal with this property , then the union @xmath160 of balls of radius @xmath147 centered at @xmath161 covers @xmath40 .",
    "assume that a metric space @xmath40 is bounded , @xmath162 , and nontrivial , i.e. it contains at least two points .",
    "a _ hyperbolic approximation _ of @xmath40 is a graph @xmath10 which is defined as follows .",
    "we fix a positive @xmath163 which is called the _ parameter _ of @xmath10 . then the largest integer @xmath53 with @xmath164 exists , and we denote it by @xmath165 .",
    "note that if @xmath166 then @xmath167 ( the case @xmath168 ) or @xmath169 ( the case @xmath170 ) .",
    "for every @xmath171 , @xmath172 , let @xmath173 be a maximal @xmath57-separated net .",
    "one associates with every @xmath73 the ball @xmath174 of radius @xmath175 centered at @xmath75 . note that @xmath176 consists of one point .",
    "we call this point the _ root _ of @xmath10 .",
    "we consider the set of balls @xmath49 for @xmath177 , as the vertex set of a graph @xmath10 .",
    "vertices @xmath75 , @xmath159 are connected by an edge if and only if they either belong to the same level , @xmath48 , and the closed balls @xmath178 , @xmath179 intersect , @xmath180 , or they lie on neighboring levels @xmath48 , @xmath181 and the ball of the upper level , @xmath181 , is contained in the ball of the lower level , @xmath48 .",
    "an edge @xmath182 is called _ horizontal , _ if its vertices belong to the same level , @xmath75 , @xmath183 for some @xmath184 .",
    "other edges are called _ radial .",
    "_ we consider the path metric on @xmath10 , for which every edge has length 1 .",
    "we denote by @xmath185 the distance between point @xmath75 , @xmath159 in @xmath10 , and by @xmath186 the distance between them in @xmath40 .",
    "the level function @xmath187 is defined by @xmath188 for any @xmath73 .",
    "we often use the following    [ rem : net ] for every @xmath189 and every @xmath190 , there is a vertex @xmath191 with @xmath192 .",
    "this follows from the fact that @xmath193 is a maximal @xmath194-separated set in @xmath40 .",
    "note that any ( finite or infinite ) sequence @xmath195 , for which @xmath196 is a radial edge for every @xmath53 , and the level function @xmath197 is monotone along @xmath198 , is the vertex sequence of a geodesic in @xmath10 .",
    "such a geodesic is called",
    "_ radial_.",
    "[ lem : radedge ] for every @xmath161 ( except the root vertex ) there is a vertex @xmath199 with @xmath200 connected with any @xmath159 , @xmath201 , @xmath202 , by a radial edge .",
    "furthermore , @xmath203 where @xmath204 .",
    "we call the vertex @xmath205 a _ central ancestor _ of @xmath75 . in general , a central ancestor of @xmath75 may not be unique .",
    "assume @xmath206 . by remark  [ rem :",
    "net ] , there is a vertex @xmath207 , for which the distance in @xmath40 between @xmath75 and @xmath205 is at most @xmath57 , @xmath203 .",
    "thus for every vertex @xmath208 adjacent to @xmath75 in @xmath10 , we have @xmath209 for each @xmath210 we have @xmath211 since @xmath163 .",
    "hence @xmath212 , and @xmath213 is a radial edge .",
    "[ lem : geoconnect ] for every @xmath75 , @xmath159 there exists @xmath199 with @xmath214 such that @xmath75 , @xmath215 can be connected to @xmath205 by radial geodesics . in particular , the space @xmath10 is geodesic .",
    "let @xmath188 and @xmath216 .",
    "choose @xmath217 small enough such that @xmath218 .",
    "applying lemma  [ lem : radedge ] we find radial geodesics @xmath219 and @xmath220 in @xmath10 connecting @xmath221 and @xmath222 respectively with @xmath223-th level .",
    "it follows from the definition of radial edges that @xmath224 , @xmath225 for every vertex @xmath226 , @xmath227 .",
    "then @xmath228 since @xmath163 .",
    "thus @xmath229 , and the vertices @xmath230 , @xmath231 are connected by a horizontal edge .",
    "applying lemma  [ lem : radedge ] once again we find @xmath232 connected with @xmath230 , @xmath231 by radial edges .",
    "therefore , @xmath75 , @xmath215 are connected to @xmath205 by radial geodesics , and @xmath10 is connected .",
    "this implies that @xmath10 is geodesic , because distances between vertices take integer values .",
    "[ lem : horedge ] assume that @xmath202 for vertices @xmath75 , @xmath215 of one and the same level , @xmath233 .",
    "then @xmath234 for any vertices @xmath205 , @xmath235 adjacent to @xmath75 , @xmath215 respectively and sitting one level below .    the balls @xmath236 , @xmath237 intersect since they contain the balls @xmath178 , @xmath179 respectively , which intersect .    any two vertices @xmath75 , @xmath238 can be joined by a geodesic @xmath239 such that @xmath240 for all @xmath241 .",
    "let @xmath242 .",
    "consider a geodesic @xmath239 from @xmath243 to @xmath244 such that @xmath245 is minimal .",
    "we claim that @xmath246 has the desired properties .",
    "let @xmath241 , and let @xmath247 .",
    "consider the sequence @xmath248 .",
    "there are nine combinatorial possibilities for this sequence .",
    "to prove the result it remains to show , that the sequences @xmath249 , @xmath250 , @xmath251 and @xmath252 can not occur .    if the sequence is @xmath249 , then @xmath253 and hence @xmath254 in contradiction to the fact that @xmath246 is a geodesic . in the case @xmath250 lemma  [ lem : radedge ] implies the existence of @xmath255 with @xmath256 and @xmath257 . replacing the string @xmath258 by @xmath259 we obtain a new geodesic @xmath260 between @xmath75 , @xmath215 with @xmath261 in contradiction to the choice of @xmath246 .",
    "the two last cases are symmetric and we consider only the case @xmath251",
    ". choose similar as above @xmath255 with @xmath257 .",
    "then by lemma  [ lem : horedge ] @xmath256 .",
    "again @xmath259 defines a geodesic with smaller @xmath262 .    from this",
    "we easily obtain the following    [ lem : geohorizone ] any vertices @xmath75 , @xmath159 can be connected in @xmath10 by a geodesic which contains at most one horizontal edge .",
    "if there is such an edge , then it lies on the lowest level of the geodesic .",
    "the following corollary is useful in many circumstances .",
    "[ cor : ballsintersect ] assume that for some @xmath75 , @xmath159 the balls @xmath49 , @xmath263 intersect .",
    "then @xmath264 .",
    "we can assume that @xmath265 .",
    "for every vertex @xmath199 of a radial geodesic descending from @xmath75 we have @xmath266 , in particular , if @xmath267 then @xmath268 .",
    "it follows that @xmath215 is the lowest vertex of a geodesic @xmath269 as in lemma  [ lem : geohorizone ] , hence the claim .",
    "the following theorem is a version of ( * ? ? ?",
    "* proposition  2.1 ) adapted to our definition of a hyperbolic approximation , thus we omit the proof .",
    "[ thm : approximate ] given a complete bounded metric space @xmath40 , its hyperbolic approximation @xmath10 is a gromov hyperbolic geodesic space with boundary at infinity @xmath270 , and the metric of @xmath40 is a visual metric on @xmath129 .",
    "the last means that for each @xmath130 , @xmath271 we have @xmath272 where positive constants @xmath144 , @xmath145 depend only on @xmath273 and @xmath274 .      in this section",
    "the following notation is useful .",
    "we write @xmath275 instead of @xmath276 .",
    "sometimes we just write @xmath277 to indicate that @xmath278 is bounded by some ( not specified ) constant @xmath109 .",
    "let us now assume that @xmath8 is some visual gromov hyperbolic space with boundary @xmath41 .",
    "fix a point @xmath154 .",
    "let @xmath142 be a visual metric on @xmath40 with respect to a parameter @xmath155 .",
    "thus there are two positive constants @xmath144 , @xmath145 with @xmath279 for all @xmath280 , @xmath281 .    note that if we scale the metric on @xmath8 by some factor @xmath282 , all expressions of the form @xmath283 are also multiplied by @xmath284 .",
    "thus after a suitable scaling of the metric on @xmath8 , we can assume that @xmath285 in estimates @xmath286 , where @xmath287 is the constant of the construction in section  [ subsect : construction ] above .",
    "note that the scaling of the metric does not change the quasi - isometry class of @xmath8 .",
    "let @xmath10 be a hyperbolic approximation of the metric space @xmath156 as constructed above .",
    "then we can identify @xmath52 .",
    "we write this identification formally as a map @xmath288 .",
    "using estimates @xmath286 with @xmath285 and theorem  [ thm : approximate ] , we obtain @xmath289 for all @xmath280 , @xmath290 and for some constant @xmath109 which depends on @xmath10 , @xmath8 and @xmath58 , but not on the arguments @xmath291 .",
    "a map @xmath292 between metric spaces is said to be _ roughly isometric _ if @xmath293 for some constant @xmath102 and for all @xmath95 , @xmath104 .",
    "[ thm : roughisometric ] let @xmath8 be a visual and @xmath10 a geodesic hyperbolic spaces .",
    "assume that there is a map @xmath294 such that @xmath295 for all @xmath280 , @xmath290 .",
    "then there exists a roughly isometric map @xmath296 .    in the following arguments",
    ", all gromov products are taken with respect to the base points @xmath121 resp .",
    "@xmath154 . to simplify the notation",
    ", we omit the base point and denote @xmath297 , @xmath298 for @xmath299 , @xmath300 respectively .",
    "the idea of the proof is easily explained in the case that every point in @xmath10 resp .",
    "@xmath8 lies on rays emanating from the origin . in this case for @xmath300 let @xmath301 such that @xmath302 .",
    "let @xmath303 and choose a ray @xmath304 . then define @xmath305 to be the point with @xmath306 .",
    "since the equality @xmath307 holds up to a uniformly bounded error , one can check that @xmath308 is roughly isometric .",
    "under the more general assumptions of the theorem one has to modify the argument .",
    "we need the following lemma from ( * ? ? ?",
    "* lemma  5.1 ) .",
    "[ lem : grprvisual ] let @xmath10 be a gromov hyperbolic space satisfying the @xmath116-inequality w.r.t .",
    "the base point @xmath121 .",
    "assume that @xmath309 for some @xmath310 , @xmath311 , @xmath312 , @xmath313 .",
    "then @xmath314 up to an error @xmath315 .    by the assumption",
    "there exists some @xmath316 such that for every point @xmath300 there is a point @xmath317 , with @xmath318 .",
    "choose such @xmath139 and let @xmath319 .",
    "choose a point @xmath320 with @xmath321 , in particular , @xmath322 .",
    "let @xmath323 be a geodesic from @xmath119 to @xmath324 .",
    "then we define @xmath325 to be the point with @xmath306 .",
    "note that @xmath326 .",
    "recall that @xmath327 up to an uniform error @xmath328 for all @xmath329 , @xmath330 .    now given @xmath331",
    "consider @xmath332 , @xmath333 with @xmath334 and @xmath335 , @xmath313 . by lemma  [ lem : grprvisual ]",
    "we have @xmath336 up to an error @xmath337 . since @xmath338",
    ", we obtain @xmath339 then again by lemma  [ lem : grprvisual ] we have @xmath340 up to an error @xmath341 .",
    "this implies @xmath342 and hence @xmath343 up to an error @xmath344 .",
    "this shows that @xmath308 is roughly isometric .",
    "let @xmath40 be a metric space . for @xmath64 , @xmath345",
    "we denote by @xmath346 the distance between @xmath64 and @xmath347 , @xmath348 where @xmath349 is the distance between @xmath350 , @xmath351 . for @xmath352",
    "we denote by @xmath353 the open @xmath58-neighborhood of @xmath64 , @xmath354 , and by @xmath355 the closed @xmath58-neighborhood of @xmath64 , @xmath356 .    given a family @xmath357 of subsets in a metric space @xmath40",
    "we define @xmath358 .",
    "the _ multiplicity _ of @xmath357 , @xmath359 , is the maximal number of members of @xmath357 with nonempty intersection .",
    "we say that a family @xmath357 is _ disjoint _ if @xmath360 .    a family @xmath357 is called a _ covering _ of @xmath40 if @xmath361 .",
    "a covering @xmath357 is said to be _ colored _ if it is the union of @xmath362 disjoint families , @xmath363 , @xmath364 . in this case",
    "we also say that @xmath357 is @xmath223-colored . clearly , the multiplicity of a @xmath223-colored covering is at most @xmath223 .",
    "let @xmath357 be an open covering of a metric space @xmath40 .",
    "given @xmath189 , we let @xmath365 , @xmath366 be the lebesgue number of @xmath357 at @xmath324 ( the auxiliary @xmath367 might be larger than @xmath368 and even infinite as e.g. in the case @xmath369 for some member @xmath370 ) , @xmath371 be the lebesgue number of @xmath357 . we have @xmath372 and for every @xmath189 the open ball @xmath373 of radius @xmath374 centered at @xmath324 is contained in some member of the covering @xmath357 .",
    "there are several equivalent definitions of the capacity dimension . in this paper",
    ", we shall use the following one .",
    "the _ capacity dimension _ of a metric space @xmath40 , @xmath375 , is the minimal integer @xmath7 with the following property : there is a constant @xmath376 such that for every sufficiently small @xmath377 there exists a @xmath378-colored open covering @xmath357 of @xmath40 with @xmath379 and @xmath380 .",
    "[ thm : charseq ] let @xmath40 be a bounded metric space with finite capacity dimension , @xmath381 .",
    "then for every sufficiently small @xmath58 , @xmath382 , there exists a sequence @xmath383 , @xmath384 , of @xmath1-colored ( by a set @xmath109 ) open coverings of @xmath40 such that for any hyperbolic approximation @xmath10 of @xmath40 with parameter @xmath58 the following holds    * @xmath385 for all @xmath60 and @xmath386 for every @xmath387 ; * for every @xmath388 , @xmath384 , there is @xmath389 such that @xmath76 ; * for every @xmath60 and for different members @xmath390 , @xmath391 with @xmath392 the following holds : let @xmath393 ; then either @xmath394 or @xmath395 .    property",
    "( 3 ) is most important and we call it the _ separation property_.    it is proved in ( * ? ? ? * proposition  2.3 ) , that under the condition of the theorem , there are constants @xmath116 , @xmath396 such that for every sufficiently small @xmath352 there exists a sequence @xmath383 , @xmath387 , of @xmath1-colored ( by a set @xmath109 ) open coverings of @xmath40 with the following properties    * @xmath386 and @xmath397 for every @xmath387 ; * for every @xmath60 and for different members @xmath390 , @xmath391 with @xmath392 we have either @xmath398 , or @xmath399 for @xmath400 .",
    "( in @xcite , the first property of ( i ) is formulated as nonstrict inequality ; however , the proof actually yields the strict inequality ) .",
    "choosing @xmath352 sufficiently small , we can assume that @xmath401 .",
    "furthermore , we add to the sequence @xmath383 , @xmath387 , the member @xmath402 which consists of ( copies of ) @xmath40 for every color @xmath60 . then , property ( 1 ) is satisfied .    because @xmath397 , every ball @xmath403 of radius @xmath404 is contained in some member @xmath389 . assuming that @xmath405",
    ", we obtain property ( 2 ) .",
    "finally , assume additionally that @xmath406 .",
    "now , if a color @xmath60 and different members @xmath390 , @xmath391 with @xmath392 are given , we have @xmath407 with @xmath400 by the choice of @xmath58 and the definition of @xmath408 . hence , property ( 3 ) .",
    "recall a poset ( partially ordered set ) @xmath45 is called _ directed _ , if for any @xmath350 , @xmath161 there is @xmath199 with @xmath409 , @xmath410 .    a _ levelled tree _",
    "@xmath3 is a directed poset @xmath45 , called the _",
    "vertex set _ of @xmath3 , together with a _ level _",
    "function @xmath411 , which is strictly monotone in the following sense : if @xmath412 are different elements and @xmath413 , then @xmath414 .    in this case",
    ", @xmath215 is called an _ ancestor _ of @xmath75 , and @xmath75 is a _ descendant _ of @xmath215 .",
    "we require that the following condition is satisfied :    @xmath415 if distinct elements @xmath75 , @xmath159 have a common descendant then one of them is an ancestor of the other .    a collection @xmath416 of two point subsets of @xmath45 called the _ edge set _ of @xmath3 is defined by the condition : a pair of vertices @xmath417 forms an _ edge _",
    ", @xmath418 , if and only if one of its member , say @xmath215 , is an ancestor of the other and the level @xmath419 is maximal with this property .",
    "if there is a vertex , which has no ancestor , then such a vertex is unique by directedness , and it is called the _ root _ of @xmath3 . note that the root is an ancestor of every other vertex .",
    "it follows from @xmath415 that for every vertex @xmath161 ( except the root ) there is exactly one edge @xmath417 , in which @xmath75 is the descendant .",
    "hence , by the uniqueness part , @xmath3 has no circuit . by the existence part ( together with @xmath415 ) , every vertex is connected with any its ancestor by a sequence of edges in @xmath3 .",
    "now , because @xmath45 is directed , every two vertices in @xmath3 are connected by a sequence of edges , i.e. @xmath3 is connected .",
    "therefore , @xmath3 is a simplicial tree .",
    "the members of an edge are called _",
    "neighbors_. so , the number of neighbors of a vertex @xmath75 equals the valence of @xmath75 .    in an obvious way , one can define a distance function on the vertex set of a levelled tree .",
    "the distance @xmath420 between @xmath161 and its ancestor @xmath159 is the number of _ generations _ between them , i.e. @xmath421 , if there is a sequence @xmath422 such that @xmath423 and @xmath424 is the ancestor of @xmath425 for @xmath426 .",
    "in particular , @xmath427 and the inequality might be strong .",
    "in general case , the distance @xmath420 between vertices is the sum of their distances to the youngest common ancestor @xmath428 , @xmath429 .",
    "if @xmath3 is rooted and @xmath430 is the root , we define @xmath431 .",
    "therefore , each levelled tree is a simplicial metric tree with an interior metric with length 1 edges .    with every alphabet @xmath82 , one associates the rooted levelled tree @xmath92 in the following way : its vertex set",
    "@xmath45 is the set of all words in @xmath82 , i.e. the set of all finite sequences with elements in @xmath82 , with the obvious partial order : @xmath432 for words @xmath433 , @xmath434 if and only if @xmath434 is an initial subword of @xmath433 .",
    "this order is obviously directed and condition @xmath415 is satisfied .",
    "the value of the level function @xmath435 is the number of letter in the word @xmath433 .",
    "then two vertices @xmath433 , @xmath436 are connected by an edge in @xmath92 if and only if one of them ( ancestor ) is the initial string of the other ( descendant ) obtained by erasing the last member of the descendant .",
    "the empty sequence defines the root of @xmath92 .",
    "the root has @xmath437 neighbors and every other vertex has @xmath438 neighbors , one ancestor and @xmath437 descendants . here",
    ", @xmath437 denotes the cardinality of @xmath82 .",
    "note that @xmath435 coincides with the length of the word @xmath433 , @xmath439 , in this case .",
    "[ lem : binary ] for every finite alphabet @xmath82 , the tree @xmath92 is roughly homothetic a subset of the binary tree .",
    "we can assume that @xmath440 for some @xmath93 .",
    "every number @xmath441 can be uniquely written as the string of zeros and ones of length @xmath442 + 1 $ ] via the binary representation ( with an appropriate number of zeros in front if necessary ) .",
    "this defines a map @xmath443 , where @xmath444 is the _ rooted _ binary tree , which is obviously isometric to a subtree of the binary tree .",
    "the map @xmath106 is radially homothetic with coefficient @xmath284 , @xmath445 for each pair ( ancestor , descendant ) .",
    "it easily follows from this that in general case , we have @xmath446    for an arbitrarily rooted levelled tree , we have only @xmath447 for its vertices @xmath75 .",
    "moreover , vertices at a fixed distance to the root may have different and even arbitrarily large levels .",
    "important examples of such trees are colored trees associated with sequence of colored coverings as in theorem  [ thm : charseq ] .",
    "let @xmath40 be a bounded metric space with finite capacity dimension , @xmath381 ; @xmath10 be a hyperbolic approximation of @xmath40 with sufficiently small parameter @xmath166 satisfying the condition of theorem  [ thm : charseq ] ; @xmath448 , @xmath384 , be a sequence of @xmath1-colored ( by a set @xmath109 ) open coverings of @xmath40 with parameter @xmath58 as in theorem  [ thm : charseq ] .",
    "then recall @xmath449 or @xmath18 .    for every @xmath60 , we define a rooted levelled tree @xmath71 as follows .",
    "its vertex set @xmath59 is the disjoint union @xmath450 with the root @xmath451 , which is the unique member of @xmath452 .",
    "the partial order of @xmath59 is defined by the inclusion relation , @xmath453 if and only if @xmath454 , and this order is directed due to the existence of the root .",
    "we say that a vertex @xmath390 has level @xmath455 ; this defines the level function .",
    "it follows easily from the separation property ( 3 ) that the level function is strictly monotone .",
    "then a vertex @xmath390 is a descendant of @xmath391 if @xmath456 and @xmath454 .",
    "it follows from the separation property ( 3 ) that @xmath415 is satisfied .",
    "hence , @xmath71 is a rooted levelled tree : a pair of vertices @xmath390 , @xmath391 forms an edge of @xmath71 if and only if it is a pair ( descendant , ancestor ) , and the level @xmath457 of the ancestor @xmath347 is maximal with this property .",
    "typically , vertices of the tree @xmath71 have infinite valence , see e.g. introduction and @xcite .",
    "we use notation @xmath458 for the distance in @xmath71 between its vertices @xmath64 , @xmath347 , and @xmath459 for the distance @xmath460 . note that @xmath461 and @xmath462 if @xmath390 . furthermore , if @xmath391 is an ancestor of @xmath390 , the level difference @xmath463 might be arbitrarily large compared to the distance @xmath458 even if @xmath464 is an edge of @xmath71 .",
    "keeping this in mind is highly useful for understanding of what follows .",
    "we now define a map @xmath465 , @xmath45 is the vertex set of the hyperbolic approximation @xmath10 of @xmath40 , as follows .",
    "the root of @xmath10 is mapped into the root of @xmath71 , @xmath466 for the unique member @xmath467 .",
    "given @xmath191 , @xmath468 , we let @xmath469 be the covering element containing the ball @xmath49 , @xmath76 , and @xmath470 is maximal with this property . by theorem  [ thm : charseq](3 ) ,",
    "@xmath471 is well defined .",
    "[ lem : lipschitz ] for every @xmath60 , the map @xmath465 is lipschitz , @xmath472    since the hyperbolic approximation @xmath10 is geodesic , it suffices to estimate the distance @xmath473 for neighbors , @xmath474 .",
    "assume that the edge @xmath475 is horizontal , i.e. @xmath75 , @xmath476 for some @xmath190 and the balls @xmath49 , @xmath263 intersect .",
    "thus the covering elements @xmath477 , @xmath478 also intersect . by the separation property ( 3 ) , either @xmath479 and so @xmath480 or these elements have different levels and one of them is contained in the other , say @xmath481 , @xmath482 with @xmath483 and @xmath454 .",
    "it follows from the definition of @xmath484 that @xmath485 and from the separation property ( 3 ) that any @xmath486 , @xmath487 , intersecting @xmath64 , also contains @xmath263 .",
    "thus @xmath488 is an edge by the definition of @xmath484 , and @xmath489 in this case .",
    "assume now that the edge @xmath475 is radial , say @xmath388 , @xmath476 .",
    "then @xmath490 and as in the previous case , @xmath491 .",
    "thus we can assume that these elements have different levels , @xmath481 , @xmath482 with @xmath492 , and one of them is contained in the other .",
    "moreover , @xmath483 because @xmath493 , thus @xmath454 .",
    "we have @xmath494 by definition of @xmath484 , and as above , any ancestor @xmath495 , @xmath496 , of @xmath64 separated from @xmath64 by at least one generation , @xmath497 , also contains @xmath263 .",
    "therefore , it follows from the definition of @xmath484 that at most one generation can separate @xmath64 from its ancestor @xmath347 , and @xmath498 .",
    "[ thm : firstqiso ] the map @xmath499 is quasi - isometric .",
    "the map @xmath500 defined by its coordinate maps @xmath501 is lipschitz by lemma  [ lem : lipschitz ] . to prove that @xmath106 is roughly bilipschitz , we begin with the following lemma , which is the main ingredient of the proof .    for @xmath502 ,",
    "we denote by @xmath503 the vertex set of @xmath71 of level @xmath504 .",
    "[ lem : radial ] given @xmath388 , @xmath384 , for every integer @xmath504 , @xmath505 , there is a color @xmath60 such that @xmath506 with @xmath507 .",
    "furthermore , if for @xmath508 a vertex @xmath509 is the lowest level vertex of the segment @xmath510 , then @xmath511 .    consider a radial geodesic @xmath512 with vertices @xmath513 , where @xmath514 .",
    "this means in particular that @xmath515 for every @xmath516 . by theorem  [ thm : charseq](2 ) for every vertex @xmath517 ,",
    "there is a covering element @xmath518 with @xmath519 , @xmath520 .",
    "there is a color @xmath60 such that the set @xmath521 contains @xmath507 members having the color @xmath62 , i.e. every of those @xmath522 . since @xmath523 for every @xmath524",
    ", we have @xmath525 for every @xmath526 having the color @xmath62 by the definition of @xmath484 and the separation property ( 3 ) .    using again the separation property , we obtain that any path in @xmath71 between @xmath471 and the set @xmath527 must contain at least @xmath528 vertices and hence @xmath506 .",
    "finally , let @xmath529 be the set corresponding to the vertex @xmath205 of @xmath71 . by the assumption on @xmath205 ,",
    "the set @xmath79 contains @xmath64 and every set from the list @xmath521 having the color @xmath62 . hence , @xmath511 .",
    "we say that distinct points @xmath191 , @xmath530 , @xmath531 are _ horizontally close _ to each other , if @xmath532 .",
    "this term is motivated by the fact that there is a geodesic segment @xmath182 which is almost radial .",
    "more precisely , we have    [ lem : radclose ] assume that the distinct points @xmath75 , @xmath159 are horizontally close to each other . then their levels are different and the upper level ball is contained in the lower level ball , say @xmath414 , @xmath490 . in particular , @xmath533    we can assume that @xmath191 , @xmath530 , @xmath531 . then @xmath534 because @xmath75 , @xmath215 are distinct and because @xmath535 is @xmath194-separated for every @xmath384",
    "furthermore , @xmath490 because @xmath536 . by corollary  [ cor : ballsintersect ] , we have @xmath537 .",
    "[ pro : estbelowhorclose ] given @xmath75 , @xmath159 horizontally close to each other , we have : @xmath538 is a radial segment for every color @xmath60 , i.e. its lowest level vertex is one of its ends , and there is a color @xmath60 such that @xmath539 where @xmath540 .",
    "we can assume that @xmath75 , @xmath215 are distinct",
    ". then by lemma  [ lem : radclose ] , their levels are different , say @xmath414 , and @xmath490 .",
    "thus @xmath480 or @xmath471 is a descendant of @xmath541 for every color @xmath60 . in any case",
    ", @xmath541 is the lowest level vertex of the segment @xmath538 .    on the other hand , @xmath542 with @xmath543 for all @xmath60 by the definition of @xmath484 . by lemma  [ lem : radial ] , we have @xmath544 with @xmath545 for some color @xmath60 . therefore ,",
    "using again lemma  [ lem : radclose ] , we obtain @xmath546      we say that vertices @xmath75 , @xmath159 are _ horizontally distinct _",
    ", if @xmath547 , @xmath548 and they are not horizontally close to each other , @xmath549 . in this case , there is an integer @xmath550 with @xmath551 we call @xmath550 the _ critical level _ of @xmath75 , @xmath215 . note that @xmath552 and thus @xmath553 , in particular , @xmath554",
    "furthermore , @xmath555 .",
    "[ lem : critleveldist ] let @xmath550 be the critical level of horizontally distinct vertices @xmath75 , @xmath159",
    ". then @xmath556 .",
    "consider central ancestor radial geodesic @xmath557 in @xmath10 between the root of @xmath10 and @xmath75 .",
    "for the vertex @xmath558 of the level @xmath559 , @xmath560 , we have @xmath561 and @xmath562 . thus @xmath563 .",
    "therefore , @xmath564 , the balls @xmath565 , @xmath263 intersect and hence , @xmath566 by corollary  [ cor : ballsintersect ] . we see that @xmath567 .",
    "[ lem : critlevel ] let @xmath550 be the critical level of horizontally distinct @xmath75 , @xmath159 .",
    "assume that @xmath568 , @xmath569 for some elements @xmath64 , @xmath570 and some color @xmath60 .",
    "then , for the lowest level vertex @xmath571 of the segment @xmath572 , we have    * its level @xmath573 ; * there are at most three vertices on each of the segments @xmath574 , @xmath575 ( including @xmath79 ) having the level @xmath576 .",
    "\\(1 ) the set @xmath529 contains both @xmath64 and @xmath347 , and we have by theorem  [ thm : charseq](1 ) @xmath577 it follows @xmath578 and thus @xmath573 .",
    "\\(2 ) assume there are distinct vertices @xmath579 , @xmath580 with levels @xmath581 , @xmath582 , @xmath583 . by the separation property ( 3 ) ,",
    "@xmath584 , where @xmath585 is the union of all balls @xmath565 intersecting @xmath579 with @xmath586 .",
    "since @xmath587 , the radius of every such ball is @xmath588 .",
    "there is @xmath586 with @xmath589 . then , @xmath590 hence @xmath591 .",
    "it follows @xmath592 and thus @xmath593 .",
    "the first part of this lemma will be used in the proof of proposition  [ pro : estbelow ] ; the second one in the proof of proposition  [ pro : crlevelsentences ] .",
    "the following proposition is a key step in the proof of theorem  [ thm : firstqiso ] and theorem  [ thm : compose ] .",
    "note that its condition is asymmetric with respect to the points @xmath75 , @xmath215 .",
    "[ pro : estbelow ] given horizontally distinct @xmath75 , @xmath159 , @xmath265 , there is a color @xmath60 such that the following two facts hold    * @xmath594 ; * @xmath595 ,    where @xmath596 is the critical level of @xmath75 , @xmath215 ; @xmath597 is the lowest level vertex ; @xmath598 .",
    "by lemma  [ lem : critlevel](1 ) for every color @xmath60 , any path in @xmath71 between @xmath471 and @xmath541 passes through a vertex of a level @xmath573 .    by lemma  [ lem : radial ]",
    ", there is a color @xmath60 such that @xmath599 with @xmath600 .",
    "let @xmath509 be the lowest level vertex of the segment @xmath601 .",
    "by lemma  [ lem : radial ] , we have @xmath511 since @xmath602 . because @xmath603 and @xmath604 by the definition of the map @xmath484 , we have @xmath605 hence ( 1 ) . because @xmath265 , we have by lemma  [ lem : critleveldist ] , @xmath606 hence ( 2 ) .",
    "we use also the notation @xmath607 for the distance between @xmath205 , @xmath608 ( on a product of trees we take the @xmath609 product metric ) .",
    "the following proposition completes the proof of theorem  [ thm : firstqiso ] .",
    "[ pro : bilip ] there are constants @xmath610 , @xmath611 depending only on @xmath612 such that @xmath613 for all @xmath75 , @xmath159 .",
    "if vertices @xmath75 , @xmath215 are horizontally close to each other , then the required estimate follows from proposition  [ pro : estbelowhorclose ] .",
    "if they are horizontally distinct , then the required estimate follows from proposition  [ pro : estbelow](2 ) because @xmath614 .",
    "in this section we construct a map from some infinite valence tree into some finite valence tree .",
    "start with a finite set @xmath78 , which we consider as some alphabet .",
    "by @xmath79 , we denote the set of all finite words in @xmath78 . in particular",
    ", the empty word @xmath430 is in @xmath79 .",
    "thus @xmath79 is the vertex set of @xmath615 , where we recall from section  [ subsect : leveltree ] the definition of the tree @xmath83 for some alphabet @xmath82 .",
    "a _ sentence _ @xmath616 in the alphabet @xmath78 is a word in the alphabet @xmath79 .",
    "it is convenient to introduce a special marker @xmath617 called the _",
    "stop sign _ , which terminates words in a sentence .",
    "so , we write @xmath618 for a sentence of @xmath53 words . let @xmath619 be the set of all sentences .",
    "thus @xmath619 is the vertex set of the tree @xmath80 .",
    "certainly , the number of letters from the alphabet @xmath78 in a sentence @xmath616 may be much larger than the number of words .",
    "furthermore , the set @xmath79 considered as the alphabet for sentences is infinite .",
    "now , we want to have a method which allows to encode sentences by a finite alphabet in a way that any encoded sentence would have exactly the same number of letters as the initial one has words . in other words",
    "we want to find a finite alphabet @xmath82 and a map @xmath620 preserving the combinatorial distance to the roots .",
    "this is of course impossible if we would try to retain all of the information contained in every sentence . however",
    ", if we pursue a moderate aim only to retain the information contained in every sentence having a definite positive percentage of stop signs with respect to the number of letters from @xmath78 , the task becomes solvable irrespective of the length of the words in a sentence .",
    "the solution is the alice diary .",
    "consider a sentence @xmath616 as description of a journey of alice who wants to write a diary about her trip .",
    "every letter of @xmath616 represents a day .",
    "there are two types of days during this journey .",
    "the days when the weather is so fine that alice has no time to write her diary .",
    "these are all unmarked days .",
    "then there are the days of rest marked by @xmath617 . in the morning of every @xmath617-day",
    ", alice writes a page describing @xmath621 days of her journey : she starts with yesterday and then the day before yesterday etc .",
    "of course she skips the days which were already described earlier in the diary .",
    "if there is no day left to describe , she marks on the page the symbol @xmath622 and stop to write the diary at this rest day .",
    "more formally , fix @xmath623 called the _ diary constant _ and consider the alphabet @xmath624 , which consists of two types of letters : either @xmath625 is a word in the alphabet @xmath626 having precisely @xmath621 letters , or @xmath627 consists of @xmath628 letters from @xmath629 concluded by the symbol @xmath622 .",
    "we call letters of @xmath624 _ pages_.    now , given a sentence @xmath616 in the alphabet @xmath78 consisting of @xmath53 words , @xmath630 , we define inductively the diary @xmath631 consisting of @xmath53 pages in @xmath624 as follows",
    ". its first page @xmath632 consist of @xmath621 letters of the word @xmath633 written backward starting from the last letter of @xmath633 ; in the case @xmath634 ( i.e. the length of the word is smaller than @xmath621 ) , the page @xmath632 is the word @xmath633 written backward and augmented by the symbol @xmath622 .",
    "next , we delete @xmath632 from @xmath616 , proceed in the same way starting from the last letter of @xmath635 and obtain the second page @xmath636 of @xmath631 .",
    "after @xmath53 steps , the diary @xmath631 is completed .    as an example consider @xmath637 and the sentence @xmath638 ( words are underlined ) .",
    "then @xmath639 , @xmath640 , @xmath641 , @xmath642 , @xmath643 and @xmath644    thus we have constructed a map @xmath645 respecting the distance to the roots in the corresponding trees .      certainly , different sentences in @xmath78 may have one and the same diary .",
    "thus , one can reconstruct a sentence out of its diary only up to this ambiguity . given a diary @xmath646 considered as a word in @xmath624 ,",
    "we let @xmath647 be the set of all sentences in @xmath78 with the diary @xmath646 , i.e. @xmath648 .",
    "note that @xmath647 may be empty .",
    "we first explain the direct reconstruction using the example above , where the last diary entry @xmath649 contains the letter @xmath622 .",
    "the first entry @xmath632 of the diary shows that the subword @xmath633 has the form @xmath650 where the `` @xmath651 '' stand for a sequence of letters of unknown length ( maybe length 0 ) .",
    "the second entry implies that @xmath652 has the form @xmath653 the information @xmath654 then gives that @xmath655 is of the form @xmath656 the entry @xmath657 says that @xmath658 has the form @xmath659 and the last entry implies that @xmath660 has the form @xmath661 thus we have reconstructed the whole sentence ( we can finally add the stop symbol at the end ) .",
    "the reconstructed words appear underlined only at the moment when further steps could not change them .",
    "note that in this direct recovery procedure , it may happen that up to the last step no word would be underlined even if finally the whole sentence is reconstructed .",
    "[ rem : eveningdiary ] there is a subtlety in the definition of the diary .",
    "it is important that alice writes her diary in the morning and not in the evening .",
    "if alice would write the diary in the evening and first describe the rest day , then the reconstruction is not possible : e.g. the following journeys @xmath662 and @xmath663 have the same evening - diary @xmath664 , @xmath665 , @xmath666 .",
    "the above reconstruction procedure motivates the following terminology .",
    "we call an expression @xmath667 , where @xmath205 is a word , a _",
    "slotted word_. a _ slotted sentence _ is an expression of the form @xmath668 , where now every @xmath669 is either a word or a slotted word .",
    "to every slotted sentence @xmath670 , we associate the set @xmath671 of sentences obtained from @xmath670 by putting any words in the place of the slots .    for example , if @xmath672 where the @xmath673 are some words , then @xmath674 consists of all sentences of the form @xmath675 where @xmath676 and @xmath677 are arbitrary words .",
    "clearly @xmath678 in the case that @xmath670 is a honest sentence ( without slots ) , and @xmath674 can be canonically identified with @xmath679 ( @xmath19 factors ) , if @xmath670 has @xmath680 slots .",
    "the @xmath504-th @xmath79 factor corresponds to the word which is put into the @xmath504-th slot . to be more formal ,",
    "let @xmath681 be this identification .",
    "we consider also the map @xmath682 defined by @xmath683 .",
    "let @xmath684 be the composition of these two maps . in the case",
    "that @xmath670 is a honest sentence , let @xmath685 .",
    "in other words , every @xmath686 is obtained from the slotted sentence @xmath670 by filling in its slots by the appropriate words of the sentence @xmath687 .    to formulate the reconstruction lemma",
    ", we recall the algorithm of alice diary . in each step alice",
    "has given a string of letters ( ending with some @xmath617 ) .",
    "in this step , she writes the @xmath621 last ( or @xmath628 letters and @xmath622 ) letters before the final stop sign in her diary .",
    "we call the string which is left ( including the final stop sign ) the _ rest sentence _ of the step . in our example",
    "the rest sentence in the first step is @xmath688 .",
    "if @xmath616 is a sentence , we denote by @xmath689 the rest sentence after writing the whole diary .",
    "note that @xmath689 always contains the final @xmath617 of @xmath616 , and if the last page of the diary @xmath631 is concluded by @xmath622 then whole sentence @xmath616 except the final @xmath617 is on the diary and thus @xmath690 .",
    "[ lem : slot ] for every sentence @xmath691 , there exists a well defined slotted sentence @xmath692 such that @xmath693 for every @xmath694 .    given a sentence @xmath695 , @xmath696 , we let @xmath697 be the diary of @xmath616 , @xmath698 .",
    "we inductively construct the required slotted sentence @xmath692 . on every step @xmath699 , the slotted sentence @xmath700 and the rest sentence @xmath701",
    "are defined using data of the previous step .",
    "we put @xmath702 .",
    "it turns out that @xmath703 for every @xmath699 , and we use notation @xmath701 for this sentence . then @xmath704 and @xmath705 .",
    "we distinguish two cases :    * case 1 * : @xmath633 has @xmath706 letters , @xmath707 , where @xmath708 consists of @xmath621 letters and @xmath709 might be empty .",
    "we put @xmath710 the sentence @xmath711 is obtained from the slotted sentence @xmath712 by putting its initial string @xmath709 into the slot , thus @xmath713 .",
    "we have @xmath714 and we denote this sentence by @xmath715 . in this case , @xmath632 is @xmath708 written in reverse order .",
    "* case 2 * : @xmath633 has less than @xmath621 letters .",
    "we put @xmath716 then @xmath712 is a honest sentence , thus @xmath717 and @xmath713 .",
    "then again @xmath718 in this case , @xmath632 is @xmath633 written in reverse order followed by @xmath622 .",
    "@xmath719-th step .",
    "assume that we have already defined the slotted sentence @xmath700 such that the sentence @xmath702 is in the class @xmath720 , @xmath721 , we also have defined the rest sentence @xmath722 , which coincides with @xmath723 , @xmath724 , and have written the diary pages @xmath725 , @xmath726 , where each page depends only on the slotted sentence of the same step .",
    "we study the sentence @xmath727 , which plays the basic role in the induction step .",
    "we distinguish two cases :    * case 1 * : @xmath728 has at least @xmath621 letters , @xmath729 , where @xmath730 is a word of @xmath621 letters and the word @xmath731 might be empty .",
    "we put @xmath732 then using the induction assumption , we see that @xmath733 , and we define @xmath734 using that @xmath724 , we obviously have @xmath735 and thus @xmath736 . in this case , the page @xmath737 is @xmath730 written in reverse order .",
    "* case 2 * : @xmath728 has less than @xmath621 letters .",
    "we distinguish two subcases .",
    "subcase 2a : @xmath700 is a honest sentence . in particular , @xmath738 and @xmath739 .",
    "thus @xmath740 consists of @xmath741 letters .",
    "we put @xmath742 then @xmath743 is a honest sentence , and we see again that @xmath733 .",
    "now , we define @xmath744 the rest sentence @xmath745 is obtained from the basic sentence @xmath727 by removing the string @xmath746 , thus @xmath747 . in this case , the page @xmath737 is @xmath746 written in reverse order and , in the case @xmath746 consists of less than @xmath621 letters , followed by @xmath622 .",
    "the most complicated is    subcase 2b : the slotted sentence @xmath700 contains at least one slot .",
    "let @xmath746 be the string of the last @xmath621 letters of @xmath748 in the case @xmath748 contains at least @xmath621 letters or otherwise @xmath749 .",
    "using @xmath722 , we see that @xmath750 for some ( may be empty ) words @xmath751 , where @xmath680 does not exceed the number of slots in @xmath700 .",
    "now , we define the slotted sentence @xmath752 by adding the word @xmath753 at the end of @xmath700 , filling in the @xmath455-th slots ( from the end ) of @xmath700 by the corresponding @xmath754 , @xmath755 , i.e. replace the last slot of @xmath700 by @xmath756 etc , and finally filling in the @xmath19-th slot ( from the end ) of @xmath700 by @xmath757 in the case @xmath746 consists of @xmath621 letters or otherwise filling in the @xmath19-th slot by @xmath758 .    by the induction assumption , @xmath722 ,",
    "that is , @xmath759 is obtained from @xmath700 by filling in its slots by the appropriate words of @xmath701 .",
    "thus it immediately follows from the definition of @xmath752 that @xmath733 .",
    "now , we define @xmath760 which is equal to deleting the substring @xmath746 from @xmath727 . by the same operation , the rest sentence @xmath745 is obtained from @xmath727 due to the induction assumption .",
    "hence , @xmath736 .    in this case , the diary page @xmath737 is @xmath746 written in reverse order and , in the case @xmath746 consists of less than @xmath621 letters , followed by @xmath622 .",
    "thus @xmath737 is defined only by a part of @xmath761 present in the slotted sentence @xmath752 .",
    "this completes the induction step and hence the construction of the slotted sentence @xmath692 . by construction ,",
    "@xmath762 , @xmath705 and moreover @xmath763 for every @xmath694 .",
    "conversely , assume that @xmath763 for some sentence @xmath764 , and consider the slotted sentence @xmath765 constructed as described for @xmath766 .",
    "the inspection of writing the diary pages for @xmath767 on every inductive step shows that @xmath768 , thus @xmath694 and @xmath769 .",
    "every page @xmath627 of the diary @xmath631 for some sentence @xmath616 has been written in the corresponding rest day , which we denote by @xmath770 .",
    "the very last case of the proof above tells us that if some page @xmath771 , @xmath699 , of the diary @xmath631 contains @xmath622 as the last symbol , then @xmath700 is a honest sentence and hence @xmath772 .",
    "thus we obtain    [ lem : completerecover ] assume that some page @xmath627 of the diary @xmath631 contains @xmath622 , and let @xmath765 be the slotted sentence from lemma  [ lem : slot ] constructed by the initial subsentence @xmath773 up to the stop sign @xmath770 corresponding to @xmath627 . then @xmath774 is a honest sentence , thus @xmath775 and the sentence @xmath766 is unambiguously reconstructed out of its diary .    from a concrete diary @xmath776 consisting out of @xmath53 pages",
    "we can construct the slotted sentence @xmath692 with @xmath53 words .",
    "we call @xmath692 the reconstruction of the sentence @xmath616 .",
    "if @xmath692 is a honest sentence , then @xmath777 and we say that we have reconstructed the whole word . in general the reconstruction @xmath692 can be obtained from @xmath616 by replacing certain substrings of @xmath616 by a slot @xmath651 and inserting slots in some places .",
    "if the frequency of the stop sign @xmath617 is high in some region of this sentence , then strings decoded in the diary come together and it is possible to reconstruct large substrings of @xmath616 .",
    "we denote by @xmath778 the @xmath223-th stop sign of @xmath616 and by @xmath779 the corresponding page of @xmath631 .",
    "the set of letters between @xmath778 and @xmath780 is denoted by @xmath781 ( neither @xmath778 nor @xmath780 is included ) .",
    "as usual , the sign @xmath782 means cardinality , and @xmath621 the diary constant .",
    "[ lem : stringrecover ] assume that @xmath783 for some sentence @xmath691 and @xmath223 , @xmath784 .",
    "then either all or at least @xmath53 letters of @xmath616 in a row left to @xmath785 are written in its reconstruction @xmath692 as a string without slots inside , where @xmath786 , @xmath787 .",
    "if any of the consecutive pages @xmath788 of the diary @xmath631 contains @xmath622 then the statement follows from lemma  [ lem : completerecover ] .",
    "thus , we assume that no page above contains @xmath622 .",
    "then , they together contain @xmath789 letters of @xmath616 scattered left to @xmath780 .",
    "note that the whole substring of @xmath616 from the leftmost of these scattered letters up to @xmath785 is on the diary and moreover , it is written in @xmath692 without slots inside .",
    "if @xmath783 then @xmath778 is on the diary among other @xmath789 letters . if the page @xmath779 contains @xmath622 , then the proof is completed again by lemma  [ lem : completerecover ] .",
    "otherwise , @xmath790 letters of @xmath616 in a row left to @xmath785 are written in @xmath692 without slots inside .",
    "[ exa : exodus ] the exodus : consider the journey of two brothers , which travel 40 years through the desert until they reach the promised land .",
    "however one of the brothers stays one week longer in the desert .",
    "let @xmath791 represents one week .",
    "now , consider the sentences @xmath792 where there are @xmath5 entries of @xmath617 at the end ( the first @xmath5 days in the promised land ) ; @xmath793 where there are again @xmath5 entries @xmath617 at the end . note that if @xmath794 , then the diaries of two brothers coincide .",
    "this example shows that even if a diary encodes an arbitrarily large string of letters , there is no way in general to recover the place of the string in a sentence , and two different sentences may have the same diary encoding mutually shifted strings .",
    "the problem is that every letter in a sentence @xmath616 has its own level which in general is lost in the diary . to match the letters of @xmath616 by levels and retain this information in the diary",
    "would require again an infinite alphabet .",
    "we rectify this problem introducing so called morse - thue decoration .",
    "the following sequence was introduced and studied by a.  thue @xcite and later independently by m.  morse @xcite .",
    "[ def : mtsequence ] consider the substitution rule @xmath795 and @xmath796 . then start from @xmath797 to perform this substitutions @xmath798 to obtain a nested family of sequences @xmath799 of length @xmath800 in the alphabet @xmath801 .",
    "the resulting limit sequence is called the _ morse - thue _ sequence .",
    "the morse - thue sequence @xmath802 has the following remarkable property ( see e.g. @xcite ) , which is only used in what follows .    [",
    "thm : cubefree ] the morse - thue sequence is cube - free , i.e. it contains no string of type @xmath803 where @xmath205 is any word in @xmath797 and @xmath22 .",
    "let @xmath616 be a sentence in the alphabet @xmath78 .",
    "we define the level of its letters inductively putting @xmath804 for the first letter if it is not the stop sign and @xmath805 otherwise .",
    "now assume that the level of a letter @xmath147 is defined , and @xmath806 is the next letter .",
    "if @xmath807 is not the stop sign then we put @xmath808 , otherwise , @xmath809 .",
    "in other words , the level of each stop sign is the same as the level of the last letter of the word which it terminates , while the level of any other letter is defined in the natural way .",
    "now , we define the morse - thue decoration of a sentence @xmath616 as follows .",
    "this is the sentence obtained from @xmath616 replacing its letter @xmath147 of the level @xmath223 by the letter @xmath810 for all @xmath7 .",
    "the diary @xmath631 of a decorated sentence @xmath616 is defined exactly as above via the decorated stop signs , and lemma  [ lem : stringrecover ] holds for decorated sentences .",
    "decorated pages are now elements of the finite alphabet @xmath811 , and a decorated diary is a string of decorated pages .",
    "the length of a sentence @xmath616 , @xmath812 , is the level of its last letter . in this sense ,",
    "the stop signs are ignored while computing the length .",
    "we also ignore stop signs while saying about length of strings in a sentence unless the opposite is explicitly stated .    given a decorated sentence @xmath616 and a letter @xmath813 , we denote by @xmath814 the _ tail _ of @xmath616 with initial letter @xmath147 , that is all letters of @xmath616 following and including @xmath147 .",
    "[ lem : synchron ] assume that decorated sentences @xmath616 , @xmath766 have identical tails of length @xmath815 and their lengths differ at most by one half of @xmath550 , @xmath816",
    ". then @xmath817 .    comparing the decorations of the identical tails",
    ", we immediately observe a subsequence @xmath803 of the morse - thue sequence unless the lengths of sentences coincide and therefore the tails are not shifted with respect to each other .    combining recovery lemma  [ lem : stringrecover ] and lemma  [ lem : synchron ] , we obtain the following proposition , which plays an important role in the proof of our main theorem .    [",
    "pro : equaldiaries ] assume for some decorated sentences @xmath616 , @xmath766 we know that    * the sentences @xmath616 , @xmath766 both contain no empty word , i.e. there are no two stop signs in a row in @xmath616 , @xmath766 ; * there are letters @xmath818 and @xmath819 with @xmath820 and @xmath821 ; * there are at least @xmath19 stop signs behind @xmath147 , @xmath807 in @xmath616 , @xmath766 respectively and @xmath822 for some @xmath823 and @xmath824 ; * @xmath825 for @xmath621-diaries with @xmath826 .    then @xmath827 .",
    "we can assume that @xmath828 .",
    "first , we check the condition of recovery lemma  [ lem : stringrecover ] for the interval @xmath829 ( this choice is motivated by the estimate @xmath830 ) .",
    "we have @xmath831 thus by lemma  [ lem : stringrecover ] , either all or at least @xmath53 letters in a row left to @xmath832 in @xmath616 are written in its reconstruction @xmath692 as a string without slots inside , and therefore this string can be recovered from @xmath631 , where @xmath833 .",
    "because the diaries coincide , @xmath825 , the reconstruction of @xmath766 is @xmath692 by lemma  [ lem : slot ] and thus again the string of at least @xmath53 letters in a row left to @xmath832 in @xmath766 coincides with the corresponding string of @xmath616 . therefore , the corresponding tails of @xmath834 , @xmath835 coincide , where @xmath834 , @xmath835 are the heads of @xmath616 , @xmath766 respectively consisting of @xmath836 words .",
    "now we check the condition of the synchronization lemma  [ lem : synchron ] .",
    "since there is no empty word in @xmath616 , @xmath766 , the identical recovered tails of @xmath834 , @xmath835 both have length @xmath837 . on the other hand , @xmath838 .",
    "thus the recovered string of @xmath616 contains @xmath147 . because @xmath839 , the @xmath840-th stop sign in @xmath616 is identical with @xmath841-th or with @xmath842-th or with @xmath843-th stop sign in @xmath766 . in any case , the recovered string of @xmath766 contains @xmath807 because also @xmath844 .",
    "it follows from ( 2 ) , @xmath820 , that @xmath845 and we can apply lemma  [ lem : synchron ] . thus @xmath846 and hence , @xmath827 .",
    "now , we assume that our metric space @xmath40 is doubling . then , we can find a finite set @xmath308 with cardinality depending only on the doubling constant of @xmath40 such that for every @xmath190 there is a coloring @xmath847 with @xmath848 for each distinct @xmath75 , @xmath476 with @xmath849 .",
    "let @xmath629 be the set consisting of all nonempty subsets of @xmath308 .",
    "clearly @xmath629 is finite .",
    "the set @xmath850 will serve as an alphabet in a way that edges of every tree @xmath71 , @xmath60 , will be labelled by words in @xmath78 and vertices of @xmath71 by sentences in @xmath78 .",
    "namely , to the edge between two vertices @xmath390 and @xmath391 with @xmath456 , we associate a word in @xmath78 of length @xmath851 .",
    "the word consists of letters @xmath852 for each level @xmath53 with @xmath853 .",
    "we define @xmath854 , where @xmath855 and @xmath856 is the @xmath53-th member of the morse - thue sequence .",
    "every vertex @xmath64 of the tree @xmath71 is connected to the root by a unique sequence of edges and in this way it becomes a sentence @xmath857 in the alphabet @xmath78 ( or a morse - thue decorated sentence in the alphabet @xmath629 ) .",
    "we also insert stop signs @xmath617 in @xmath616 terminating the words .",
    "the stop signs are only needed to define the diary of @xmath616 .",
    "so , they play an auxiliary role , and their levels coincide with levels of the last letters in corresponding words of @xmath858 .",
    "recall that the number of words @xmath223 in @xmath616 does not exceed @xmath859 , where @xmath455 is the level of @xmath64 , and @xmath455 might be arbitrarily large compared with @xmath223 .    in this way ,",
    "the role of every member @xmath860 is threefold .",
    "first , it is a covering element from @xmath59 , in particular , a subset of @xmath40 .",
    "second , it is a vertex of the tree @xmath71 and thus one can speak about its properties as a member of the tree .",
    "finally , it can also be considered as a sentence in the alphabet @xmath78 .",
    "depending of a role , we sometime use different notations for one and the same member of @xmath71 .",
    "[ pro : crlevelsentences ] let @xmath616 , @xmath766 be sentences in the alphabet @xmath78 corresponding to vertices @xmath64 , @xmath570 respectively .",
    "assume that there are horizontally distinct @xmath75 , @xmath159 , for which @xmath568 , @xmath569 ( as points and subsets in @xmath40 ) , @xmath861 , @xmath862 where @xmath596 is the critical level of @xmath75 , @xmath215 .",
    "then for the letters @xmath818 , @xmath819 of the critical level , @xmath863 , we have      the condition @xmath861 , @xmath862 implies that the assumption of the lemma is not void , i.e. the letters @xmath147 , @xmath807 of @xmath616 , @xmath766 respectively , exist .",
    "furthermore , @xmath865 , @xmath866 by theorem  [ thm : charseq](1 ) .",
    "let @xmath867 be the lowest level vertex of the segment @xmath572 , @xmath53 the level of @xmath79 , i.e. @xmath571 .",
    "it follows from lemma  [ lem : critlevel ] , that @xmath573 and that there are at most three vertices ( including @xmath79 ) on each of the segment @xmath574 , @xmath575 having the level @xmath576 .",
    "hence , @xmath821 .    to prove ( 2 )",
    ", we show that there exists @xmath868 such that @xmath869 , @xmath870 and @xmath871 for every @xmath872 with @xmath873 .",
    "then , the color from @xmath308 corresponding to @xmath350 , @xmath874 , which is on the list in @xmath147 , will not appear in the color list of @xmath807 by the property of the coloring @xmath875 , and thus @xmath864 .",
    "we fix a natural @xmath621 , whose value will be specified below , and let @xmath811 be the set of the morse - thue decorated pages associated with sentences in the alphabet @xmath78 , see sect .",
    "[ subsect : diary ] and [ subsect : mtdecor ] .",
    "note that one and the same alphabet @xmath78 has been used for labelling of every tree @xmath71 , @xmath60 .",
    "thus , the _ finite _ alphabet @xmath82 and therefore the tree @xmath92 is independent of colors @xmath60 .",
    "now , for every @xmath60 , the diary writing procedure defines a map @xmath881 called the _ diary _ map .",
    "it follows from the definition that @xmath882 for every sentence @xmath883 , i.e. the map @xmath884 is radially isometric .",
    "consequently , @xmath884 is 1-lipschitz and the product map @xmath885 is also lipschitz ( this map is 1-lipschitz if both products , @xmath886 and @xmath887 , are equipped with the same type of product metrics , either @xmath888 , @xmath889 or @xmath890 , what is natural to consider ) .",
    "certainly , @xmath433 as well as every @xmath884 , @xmath60 , is by no means quasi - isometric . however , we have      we use notations @xmath892 and @xmath893 for every color @xmath60 .",
    "the map @xmath894 is lipschitz because both @xmath106 and @xmath433 are lipschitz . to prove that @xmath894 is roughly bilipschitz , we consider two cases . the easy case is if @xmath75 , @xmath159 are horizontally close to each other . then by proposition",
    "[ pro : estbelowhorclose ] , we have : @xmath538 is a radial segment for every color @xmath60 , and there is a color @xmath60 such that @xmath539 where @xmath540 . because @xmath884 is radially isometric , @xmath895 , and therefore @xmath896          where @xmath597 is the lowest level vertex , @xmath596 is the critical level of @xmath75 , @xmath215 .",
    "we fix this color @xmath62 and consider it in what follows .",
    "furthermore , we use notation @xmath900 , @xmath901 for elements @xmath471 , @xmath902 considered as sentences in the alphabet @xmath78 .",
    "using the terminology of sect .",
    "[ sect : alice ] , @xmath903 is the number of stop signs behind @xmath205 in the sentence @xmath670 . by lemma",
    "[ lem : critlevel](2 ) , only at most two of them are sitting below the critical level @xmath550 . by ( 2 ) , @xmath904 , thus there is the letter @xmath905 of the critical level , @xmath906 . then in notations of sect .",
    "[ sect : alice ] , @xmath907 for some @xmath362 .",
    "hence , there are at least @xmath908 stop signs behind @xmath147 in @xmath670 .        for the tail @xmath915 of @xmath616 with initial letter",
    "@xmath147 , we have @xmath916 and therefore @xmath917 where we have used the estimate @xmath918 .",
    "let @xmath860 be the vertex ( or covering element ) corresponding to the sentence @xmath616 .",
    "by lemma  [ lem : critlevel](2 ) , there are at most three vertices of the segment @xmath919 ( including @xmath205 ) having the level @xmath576 . because @xmath920 , we obtain @xmath921 .        there is no reason for the levels @xmath861 , @xmath932 to coincide .",
    "however , because @xmath933 , we have @xmath862 since there is at most three vertices of the segment @xmath934 below the critical level .    then , the condition of proposition  [ pro : crlevelsentences ] is satisfied for the sentences @xmath935 , @xmath936 of the alphabet @xmath78 because @xmath937 and @xmath938 by the definition of the map @xmath484 and properties of the tree @xmath71 . by this proposition , the letters @xmath907 , @xmath939 of the critical level , @xmath863 , are different , @xmath864 , and @xmath821 .        in this way , we have recovered the symmetry between @xmath616 , @xmath766 needed to apply proposition  [ pro : equaldiaries ] : there are at least @xmath19 stop signs behind @xmath147 , @xmath807 in @xmath616 , @xmath766 respectively and @xmath822 for some @xmath823 and @xmath947 . since the conditions ( 1)(3 ) of that proposition are satisfied and @xmath864 , we conclude that @xmath948 for the diary constant @xmath949 .",
    "this yields the required estimate : because @xmath884 is radially isometric , we have @xmath950 and as above we obtain @xmath951 with @xmath927 and @xmath952 .",
    "this completes the proof of theorem  [ thm : compose ] .",
    "sergei buyalo,11em= viktor schroeder , + st .",
    "petersburg dept . of steklov",
    "institut fr mathematik , universitt + math .",
    "institute ras , fontanka 27 , zrich , winterthurer strasse 190 , + 191023 st .",
    "petersburg , russia ch-8057 zrich , switzerland + sbuyalo@pdmi.ras.ru +"
  ],
  "abstract_text": [
    "<S> we show that every gromov hyperbolic group @xmath0 admits a quasi - isometric embedding into the product of @xmath1 binary trees , where @xmath2 is the topological dimension of the boundary at infinity of @xmath0 . </S>"
  ]
}