{
  "article_text": [
    "magnetic field extrapolation is an important tool to study the three - dimensional ( 3d ) solar coronal magnetic field , which is difficult to measure directly @xcite .",
    "the models being used most popularly for field extrapolation are the potential field model , the linear force - free field model , and the nonlinear force - free field ( nlfff ) model .",
    "these models are all based on the same assumption that the lorentz force is self - balancing in the corona , but adopt different simplifications of the current distribution . among these models ,",
    "the nlfff model is the most precise one for characterizing magnetic field in the low corona , where there is significant and localized electric current , especially in active regions .    regarding the nlfff extrapolation",
    ", it is routine to use the vector magnetograms observed on the photosphere as input , at least in most of the available extrapolation codes ( _ e.g. _ , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "this , however , poses a basic problem ( also a major headache ) to the force - free field modelers , because the magnetic field in the photosphere is forced by the plasma significantly @xcite , which is in conflict with the fundamental assumption of force - freeness . from the photosphere to the corona , the magnetic field passes through a highly stratified and inhomogeneous plasma environment with plasma @xmath0 varying abruptly from @xmath1 to @xmath2 @xcite ; thus the force - free condition can not be fulfilled globally . by a study of the observed chromospheric field in a sampled active region ,",
    "@xcite conclude that the magnetic field is not force - free in the photosphere , but becomes force - free roughly @xmath3  km above the photosphere .",
    "a recent statistical study by @xcite using a large number of magnetograms from huairou solar observing station gives similar conclusions .",
    "this complication leads to the desire to use measurements of the vector field in the force - free upper chromosphere instead .",
    "however , the vector field is not as easily measured in the chromosphere as in the photosphere .",
    "even the chromospheric field is measured , it is still problematic for extrapolation since the surface in which any particular magnetically - sensitive line will form varies in time and space , and in particular the height will be different along different lines of sight .",
    "so one can not assume that the vector field is given on a plane or sphere at the bottom of the extrapolation volume as in the case of the photospheric magnetograms .",
    "the practical use of the chromospheric magnetograms as boundary conditions for extrapolations is still to be explored .    as an alternative way to alleviate the problem",
    ", one can consider to modify the photospheric magnetograms to simulate the force - free chromospheric magnetograms , which is first suggested by @xcite . since the interface between the photosphere and the bottom of the force - free domain is rather thin ( say , about 400  km ) , especially if compared with the spatial scale of the coronal field ( about tens of megameters ) , the basic field structures of the chromosphere should be very similar to those of the photosphere , except that ( i ) there must be some smoothness of the structures due to the fast expansion of field from the high-@xmath0 to low-@xmath0 regions and ( ii ) the very fine magnetic elements are just closed within this interface and thus show no signal in the force - free domain . thanks to these reasons , modifications that need to be made on the photospheric field to mimic the force - free chromospheric field ought to be not significant and can hopefully be made within / around the error margins of the measurement .",
    "the procedure of modifying a raw photospheric magnetogram to a force - free chromospheric one is usually called ` preprocessing ' @xcite . to guide the preprocessing , there are constraints that must be fulfilled by the target magnetogram . on the boundary surface @xmath4 of an ideally force - free field @xmath5 in a volume @xmath6 ,",
    "the field satisfies the following necessary conditions @xmath7 where @xmath8 .",
    "these expressions are derived from the volume integrals of the total magnetic force and torque @xcite @xmath9 where @xmath10 is magnetic stress tensor , @xmath11 and @xmath12 .",
    "generally the surface integration has to be carried out over a closed volume , but in preprocessing magnetograms for extrapolation of a computational cube , the surface integrals of equation  ( [ eq : m11 ] ) is usually restricted within the bottom magnetogram since the contribution from other ( side and top ) boundaries is small and negligible , and in the following @xmath4 will represent only the area of magnetograms . with this assumption ,",
    "equation  ( [ eq : m1 ] ) is the component form of the surface integrals in equation  ( [ eq : m11 ] ) .",
    "so the first task of preprocessing is to drive the raw magnetogram to fulfill the constraints of equation  ( [ eq : m1 ] ) and thus to be closer to an ideally force - free magnetogram .",
    "this task is also dubbed as ` removing force ' in the forced magnetogram .",
    "the second task of preprocessing is to smooth the raw data to mimic the field expansion .",
    "smoothing is also very necessary for the practical computation based on numerical difference with limited resolution , which can not resolve sufficiently small structures in the raw data . besides",
    ", smoothing can remove measurement noise and increase signal - to - noise ratio .",
    "several preprocessing codes @xcite have been developed and they share the basic approach proposed by @xcite . a functional @xmath13 is designed by adding up the @xmath14 deviations from the constraints of equation  ( [ eq : m1 ] ) , the terms that control deviation from the raw data and the smoothness with different weights , _",
    "e.g. _ , @xmath15 where @xmath16 is the weighting factor , @xmath17 , @xmath18 , @xmath19 , and @xmath20 measures the roughness of the data .",
    "then the target magnetogram is searched by minimizing the functional @xmath13 using an optimization method .",
    "different algorithms of smoothing and optimization have been utilized and the results are more or less different , as shown in a comparison study by @xcite .",
    "also the differences can result from different choices of the weighting factors .    under this framework of preprocessing ,",
    "there are two problems not well addressed , namely , to what extent the force is needed to be removed and to what extent the smoothing can be performed ?",
    "we care about these problems from both numerical and physical considerations .",
    "ideally we prefer the map to satisfy the force - free constraints precisely , but this condition need not be satisfied strictly considering that numerical discretization error is unavoidable in the extrapolation with finite resolution .",
    "the smoothing also ought not to be done arbitrarily if we want to mimic the expansion of the field from the photosphere to some specific height above . over - smoothing of the data may smear the basic structures while a too - limited smoothing can not filter the small - scale noise sufficiently .",
    "a careful choice of the weighting factors @xmath16 is required to deal with these problems .",
    "this paper is devoted to handling these problems in the preprocessing .",
    "we use the values of force - freeness and smoothness calculated from numerical potential - field solution at some height above the photosphere as a reference to guide the preprocessing . based on a simple rule that any magnetic field can be split into two parts : a potential field and a non - potential field ,",
    "we develop a new preprocessing code using this splitting of the magnetic field , which is consistent with our extrapolation code cese ",
    "nlfff @xcite .",
    "we show below how the raw magnetogram can be driven to force - free and smooth with the same level as that of the numerical potential field at a height of roughly 400  km above the photosphere , _",
    "i.e. _ , the bottom of the force - free domain .",
    "the remainder of the paper is organized as follows . in section",
    "[ sec : method ] we give the basic method and formulas , and we show how to choose the weighting factors in section  [ sec : mu ] .",
    "we then apply the method to preprocess two sampled magnetograms taken by sdo / hmi and analyze the results in section  [ sec : res ] .",
    "finally discussion and conclusions are given in section  [ sec : con ] .",
    "generally the coronal magnetic field can be split into two parts : a potential field matching the normal component of the bottom magnetogram , and a non - potential part with the normal field vanishing at the bottom .",
    "particularly , of the vector magnetogram , the magnetic field @xmath5 can be written as @xmath21 where @xmath22 are the components of the potential part @xmath23 and @xmath24 the components of the non - potential part @xmath25 .",
    "note that @xmath26 and @xmath27 .",
    "supposing @xmath5 is a force - free magnetogram and since its potential part @xmath23 already fulfills the force - free conditions of equation  ( [ eq : m1 ] ) , we can derive special force - free conditions for its non - potential part @xmath24 , which are expressed as @xmath28 where we denote @xmath29 .",
    "the derivation is straightforward , for example @xmath30 and we have @xmath31 all other expressions in equation  ( [ eq : m3 ] ) can be derived easily in the similar way .",
    "let @xmath32 denote the observed photospheric field , _ i.e. _ , the raw magnetogram , and its splitting form is @xmath33 with @xmath34 and @xmath35 denoting the potential and non - potential parts , respectively . here",
    "@xmath34 is computed based on @xmath36 using the potential field model and then @xmath35 is also obtained .",
    "the computation of a potential field needs only the normal component of the field on the bottom and is now a trivial task , which can be carried out conveniently by using the green s function method @xcite or other much faster scheme @xcite .",
    "generally , @xmath35 does not fulfill the force - free conditions of equation  ( [ eq : m3 ] ) . if without smoothing , we only need to let @xmath37 and reduce the non - potential part @xmath35 to @xmath25 satisfying equation  ( [ eq : m3 ] ) .",
    "for the purpose of smoothing , @xmath23 is obtained by taking the data at a plane just one pixel above the photosphere from the 3d potential field extrapolated from the observed @xmath38 .",
    "this is suitable for the sdo / hmi data which has a pixel size of about 360  km ( _ i.e. _ , 0.5 arcsec ) , an approximate height above which the coronal field becomes force - free according to @xcite . for magnetograms with other sizes of pixel , we need to take the potential field data at a given physical height ( where the force - free assumption becomes valid , _",
    "e.g. _ , 400  km ) and not necessarily one pixel above the photosphere .",
    "@xmath23 obtained in this way can be regarded as the potential part of the chromospheric field , also a preprocessed counterpart of @xmath34 .",
    "of course , if the measurements of chromospheric longitudinal fields are available ( _ e.g. _ , * ? ? ?",
    "* ) , we recommend using those data directly to construct the potential part @xmath23 , which is certainly preferred over that based on the photospheric @xmath38 .    the second task , to reduce @xmath35 to @xmath25 , is carried out using an optimization method similarly to @xcite .",
    "we intend to minimize the total magnetic force and torque which are quantified by @xmath39 where for convenience of presentation we denote @xmath40 here the summation @xmath41 is over all the pixels of the magnetogram , and these summations are the numerical counterparts of the integrals in equation  ( [ eq : m3 ] ) .",
    "the observation term @xmath42 ( to restrict the deviation from the observed data ) and smoothing functional @xmath20 ( to control the smoothness ) are also considered by @xcite @xmath43 ,    \\nonumber\\\\    l_{4 } & = & \\sum_{\\rm p}\\left[(\\delta b_{1x})^{2}+      ( \\delta b_{1y})^{2}\\right]\\end{aligned}\\ ] ] where @xmath44 is a usual five - point 2d - laplace operator , _",
    "i.e. _ , for the pixel @xmath45 @xmath46 this simply states that the smaller @xmath20 gives the smoother data .    additionally , the above functionals @xmath47 ( where @xmath48 ) are normalized by @xmath49 which are given by @xmath50\\end{aligned}\\ ] ] where @xmath51    we use a steepest descent method @xcite to minimize a weighted average of the above functionals @xmath52 where @xmath53 is the weighting factor .",
    "generally , the weighting factors for the magnetic force and torque are simply given by @xmath54 since there is no obvious reason to give bias on any of these two quantities .",
    "the determination of @xmath55 and @xmath56 will be described in the next section , and different combinations of them are tested for two hmi magnetograms to search the optimal choice in section  [ sec : res ] .",
    "since @xmath13 is an explicit functional of the arguments @xmath24 , its gradient @xmath57 can be expressed at each pixel @xmath58 as @xmath59    \\nonumber\\\\    + 2\\frac{\\mu_{2}}{n_{2}}\\left [      l_{21}(2xb_{1x}+2xb_{0x})_{q}+      l_{22}(2yb_{1x}+2yb_{0x})_{q}+      l_{23}(yb_{0z})_{q }    \\right ]    \\nonumber\\\\    + 2\\frac{\\mu_{3}}{n_{3}}(b_{1x}-{\\mathcal{b}}_{1x})_{q }    + 2\\frac{\\mu_{4}}{n_{4}}(\\delta(\\delta b_{1x}))_{q},\\\\      \\frac{\\partial l}{\\partial ( b_{1y})_{q } } =     2\\frac{\\mu_{1}}{n_{1}}\\left [      l_{12}(b_{0z})_{q}+      l_{13}(2b_{1y}+2b_{0y})_{q}\\right ]    \\nonumber\\\\    + 2\\frac{\\mu_{2}}{n_{2}}\\left [      l_{21}(2xb_{1y}+2xb_{0y})_{q}+",
    "l_{22}(2yb_{1y}+2yb_{0y})_{q}+      l_{23}(-xb_{0z})_{q }    \\right ]    \\nonumber\\\\    + 2\\frac{\\mu_{3}}{n_{3}}(b_{1y}-{\\mathcal{b}}_{1y})_{q }    + 2\\frac{\\mu_{4}}{n_{4}}(\\delta(\\delta b_{1y}))_{q}.\\end{aligned}\\ ] ] the procedure of the steepest descent is performed as follows .",
    "we start from an initial guess @xmath60 , _",
    "e.g. _ , the observed data @xmath61 , and march the solution in each iteration @xmath62 along the steepest descent direction ( _ i.e. _ , opposite to the gradient direction ) by @xmath63 it is important to choose a proper step size @xmath64 at each step to maximize the local descent .",
    "this can be determined by a bisection line - search algorithm to solve the one - dimensional optimization problem at every iteration @xmath65 the iteration is terminated if the maximum residual of the field @xmath66_{\\max}$ ] , defined by @xmath67_{\\max } = \\lambda_{k } \\max[\\nabla l ( { { \\mathbf b } } _ { 1}^{k } ) ] , \\ ] ] is smaller than @xmath68  gauss ( g ) for 10 successive steps .",
    "a careful choice of optimal weighting factors @xmath16 is critical for a good performance of preprocessing . using the qualities of force - freeness and smoothness of the numerical potential part @xmath23 as a reference , we guide the optimization of @xmath16 according to the follow constraints :    \\i ) the residual force and torque in the target magnetogram @xmath5",
    "should be reduced to the same order of those in @xmath23 ;    \\ii ) the smoothness of the target magnetogram @xmath5 should reach the same level as that of @xmath23 ( since @xmath69 , it means that the smoothness of @xmath70 and @xmath71 should match that of @xmath72 .",
    "this is reasonable since there is no preference for any component of the vector ) ;    \\iii ) with the constraints i ) and ii ) fulfilled , the deviation between the target magnetogram @xmath5 and the observed data @xmath73 should be minimized . in the constraints the residual magnetic force and torque of the data are quantified by two parameters , @xmath74 and @xmath75 , defined as usual @xmath76 and the smoothness of component @xmath77 ( @xmath78 ) is measured by @xmath79/    \\sum_{\\rm p}\\left[(\\overline{\\delta } b_{m})^{2}\\right].\\ ] ]    beside the above constraints the total iteration steps needed by computation is also considered if the magnetogram s resolution is very high , since the computing time of the preprocessing may be rather long .",
    "g ; the vectors represent the transverse field and only the field stronger than @xmath80  g is plotted .",
    "the length unit is 0.5  arcsec.,title=\"fig:\",scaledwidth=48.0% ]  g ; the vectors represent the transverse field and only the field stronger than @xmath80  g is plotted .",
    "the length unit is 0.5  arcsec.,title=\"fig:\",scaledwidth=48.0% ]     and @xmath56 .",
    "results for different values of @xmath56 are plotted using different colors and line styles as denoted in the top left panel .",
    "the dashed lines in the top right and middle right panels represent the parameter values of the potential part @xmath23 , which is used as the reference to choose the optimal weights .",
    "the optimal weights are chosen such that @xmath81 , @xmath82 , and @xmath83 are close to those of @xmath23 and @xmath84 is minimized . ]     but for ar 11429 . ]",
    ".quality of the magnetograms .",
    "the preprocessed results are produced with the optimal weighting factors @xmath85 and @xmath86 .",
    "the parameter @xmath87 is the total magnetic flux normalized by the total unsigned flux . [",
    "cols=\"<,<,<,<,<,<,<\",options=\"header \" , ]     [ tab : quality ]    , respectively . over the images of @xmath88 , and @xmath72",
    "components are the contour lines of their zero values . ]     but for ar 11429 . ]         ) . ]",
    "in this section we apply the preprocessing code to several magnetograms taken by sdo / hmi , and search the optimal values for the weighting factors . the _ helioseismic and magnetic imager _ ( hmi ) on board the _ solar dynamics observatory _ ( sdo )",
    "provides photospheric vector magnetograms with a high resolution both in space and time .",
    "it observes the full sun with a 4k@xmath894k ccd whose spatial sampling is 0.5 arcsec per pixel .",
    "raw filtergrams are obtained at six different wavelengths and six polarization states in the fe i 6173   absorption line , and are collected and converted to observable quantities ( like dopplergrams , continuum filtergrams , and line - of - sight and vector magnetograms ) on a rapid time cadence . for the vector magnetic data ,",
    "each set of filtergrams takes 135 s to be completed . to obtain vector magnetograms ,",
    "stokes parameters are first derived from filtergrams observed over a 12-min interval and then inverted through the very fast inversion of the stokes vector @xcite . the 180@xmath90 azimuthal ambiguity in the transverse field",
    "is resolved by an improved version of the `` minimum energy '' algorithm @xcite .",
    "regions of interest with strong magnetic field are automatically identified near real time @xcite .",
    "a detailed description on how the vector magnetograms are produced can be found on the website //http://jsoc.stanford.edu",
    "/ jsocwiki / vectorpaper .",
    "the raw magnetograms we use here were downloaded from http://jsoc.stanford.edu/jsocwiki/releasenotes2 , where the hmi vector magnetic field data series ` hmi.b_720s_e15w1332 ` are released for several active regions .",
    "there are two special formats , _",
    "i.e. _ , direct cutouts and remapped images .",
    "we use the remapped format which is more suitable for modeling in local cartesian coordinates , since the images are computed with a lambert cylindrical equal area projection centered on the tracked region . for our test , we select two active regions , ar 11283 and ar 11429 , both of which produced x - class flares and thus were very non - potential .",
    "figure  [ fig : rawmaps ] shows the magnetograms for ar 11283 at 05:36 ut on 8 september 2011 and ar 11429 at 00:00  ut on 7 march 2012 .",
    "the size of the magnetograms are respectively @xmath91 and @xmath92 pixels .    in figures  [ fig : result11283 ] and [ fig : result11429 ] we show the preprocessing results with different sets of @xmath55 and @xmath56 .",
    "since for such large magnetograms it is nontrivial to perform plenty of tests with continuous sets of weighting factors to pick the optimal one , we only compute the results for several groups of @xmath55 and @xmath56 as shown in the figures , _",
    "i.e. _ , @xmath93 and @xmath94 .",
    "for each set of weighting factors , the normalized terms @xmath95 and the smoothness and the force - free quality @xmath74 and @xmath75 are plotted . by comparing the results with fixed @xmath55 but different @xmath56",
    ", we can see that the force - free parameters @xmath96 , and @xmath97 are almost entirely determined by @xmath55 . when decreasing @xmath55 , _",
    "i.e. _ , allowing more freedom of modifying the raw data , @xmath98 and @xmath99 decrease very quickly ( their magnitude decreases quicker than that of @xmath55 ) , but the residual force parameters @xmath74 and @xmath75 reach a minimum and can not be reduced any further .",
    "this is because the potential part @xmath23 has a non - zero value of @xmath100 and @xmath75 ( due to numerical error of finite resolution ) , which is the minimum of @xmath101 that can be reached for the target magnetograms .",
    "the results for both tests show that @xmath85 is small enough which gives @xmath74 and @xmath75 nearly the same as those of @xmath23 , meaning that the force in the non - potential part @xmath25 is decreased near or under the level of numerical error .",
    "even smaller @xmath55 can not improve the quality of force - freeness , but deviates the target magnetograms farther away from the original data .",
    "thus we set the optimal value of @xmath85 . with a given value of @xmath55 , the values of smoothness are controlled by @xmath56 .",
    "obviously @xmath102 is a good choice which gives the values of @xmath82 and @xmath83 very similar to @xmath103 , meaning that the smoothness of the target magnetograms is consistent with their potential part @xmath23 .",
    "we believe the choice of weight for smoothness here is more physics - based than in other methods in which it is given more or less arbitrarily .",
    "the results of preprocessing the two magnetograms with the optimal weighting factors @xmath85 and @xmath86 are summarized in table  [ tab : quality ] .",
    "figures  [ fig : map11238 ] and [ fig : map11429 ] show a comparison of the original and preprocessed magnetograms . here",
    "the color - map is designed to manifest both strong and weak fields .",
    "as shown , the map after preprocessing resamples the feature of the original data while small structures tend to be smoothed out . in the bottom of the figures we plot the results for the vertical current @xmath104 which is calculated by taking finite differences of the transverse field @xmath105 since the numerical differences are very sensitive to noise , random noise in the data",
    "exhibits more clearly in the @xmath104 map , particularly in weak field regions , and they are suppressed effectively by the smoothing .",
    "histograms are plotted in figure  [ fig : dbhistrogram ] to show the distributions of the absolute differences between the raw and preprocessed magnetograms over all the pixels .",
    "apparently different approaches of modifying the data give different distributions , _ i.e. _ , the distribution for the @xmath106-component is distinct from those for the @xmath107 and @xmath108-components .",
    "this is because the modification for @xmath72 is determined solely by the potential model , while modifications for @xmath88 are additionally made by the optimization process .",
    "the change in the vertical field is less than those for the transverse field .",
    "this is consistent with the observation which measures the line - of - sight component much more precisely than the transverse field , and thus we have more freedom to modify the transverse field .",
    "still it should be noted that here the potential - field modeled @xmath72 may not approximate well the real chromospheric @xmath72 , which is preferred to be taken by direct measurements if available .",
    "we finally show in figure  [ fig : iter ] the process of iteration in the optimization method . only the result for ar 11283",
    "is plotted as an example .",
    "as shown , the functional @xmath13 decreased very quickly . by only 200 iteration steps",
    ", it almost reaches its minimum , reduced by about two orders of magnitude from its initial value .",
    "the sub - functionals @xmath98 and @xmath99 have similar evolution , although with small oscillations , and the sub - functional @xmath20 keeps decreasing but very slowly after 200 steps .",
    "in this paper we have developed a new code of preprocessing the photospheric vector magnetograms for nlfff extrapolation .",
    "the method is based on a simple rule that any vector magnetograms can be split into a potential field part and a non - potential part and we deal with two parts separately .",
    "preprocessing of the potential part is simply performed by taking the data sliced at a plane about @xmath3  km above the photosphere from the 3d potential - field numerical solution , which is extrapolated from the observed vertical field .",
    "then the non - potential part is modified by an optimization method to fulfill the constraints of total magnetic force - freeness and torque - freeness . as for practical computation based on numerical discretization , a strict satisfaction of force - free constraints",
    "is apparently not necessary .",
    "also the extent of the smoothing to be applied to the data need to be carefully determined , if we want to mimic the field expansion from the photosphere to some specific height above .",
    "we use the values of force - freeness and smoothness calculated from the preprocessed potential - field part as a reference to guide the preprocessing of the non - potential field part , _ i.e. _ , we require that the target magnetograms have the same level of force - freeness and smoothness as the reference data",
    ". these requirements can restrict well the values of the free parameters , _",
    "i.e. _ , the weighting factors in the optimization functional .",
    "the code is applied to the sdo / hmi data .",
    "preprocessed results show that the method can remove efficiently the force and noise , if we properly choose the weighting factors . for two sampled hmi magnetograms , we find that the optimal weights are @xmath85 and @xmath86 , with which the target magnetgrams can be driven to force - free and smooth with the same level as that of the numerical potential field at the bottom of the force - free domain .",
    "the preprocessing code here is developed as a sub - program for a project of applying our extrapolation code cese ",
    "nlfff @xcite to observed data .",
    "we have applied cese  mhd ",
    "nlfff to sdo / hmi data with both raw and preprocessed magnetograms @xcite . by a careful comparison of the results , we find that the quality of extrapolation is indeed improved using the preprocessed magnetograms , including the force - freeness of the results ( _ e.g. _ , measured by a current - weighted mean angle between the magnetic field @xmath5 and electric current @xmath109 ) and the free energy contents .",
    "for example in the extrapolation of ar 11283 , the mean angle between @xmath5 and @xmath109 for the entire extrapolation box of @xmath110 pixels is reduced from @xmath111 to @xmath112 and the free energy is increased from @xmath113  erg to @xmath114  erg .",
    "this work is jointly supported by the 973 program under grant 2012cb825601 , the chinese academy of sciences ( kzzd - ew-01 - 4 ) , the national natural science foundation of china ( 41204126 , 41274192 , 41031066 , and 41074122 ) , and the specialized research fund for state key laboratories .",
    "data are courtesy of nasa / sdo and the hmi science teams .",
    "the authors thank the anonymous referee for invaluable comments ."
  ],
  "abstract_text": [
    "<S> numerical reconstruction / extrapolation of coronal nonlinear force - free magnetic field ( nlfff ) usually takes the photospheric vector magnetogram as input at the bottom boundary . magnetic field observed at the photosphere </S>",
    "<S> , however , contains force which is in conflict with the fundamental assumption of the force - free model and measurement noise which is unfavorable for practical computation . </S>",
    "<S> preprocessing of the raw magnetogram has been proposed by @xcite to remove the force and noise for providing better input for nlfff modeling . in this paper </S>",
    "<S> we develop a new code of magnetogram preprocessing which is consistent with our extrapolation method cese  mhd  nlfff @xcite . basing on a magnetic - splitting rule that a magnetic field can be split into a potential field part and a non - potential part </S>",
    "<S> , we split the magnetogram and deal with the two parts separately . </S>",
    "<S> preprocessing of the magnetogram s potential part is based on a numerical potential field model , and the non - potential part is preprocessed using the similar optimization method of @xcite . </S>",
    "<S> the code is applied to the sdo / hmi data and results show that the method can remove efficiently the force and noise and improve the quality of extrapolation .    </S>",
    "<S> = 1 </S>"
  ]
}