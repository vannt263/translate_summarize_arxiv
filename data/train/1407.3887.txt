{
  "article_text": [
    "markov chains , in both discrete and continuous time , have found widespread use throughout biology  @xcite .",
    "they are useful as they are amenable to analysis due to the markovian property but still incorporate the aspect of randomness which is vitally important to accurate modeling of many biological processes @xcite . in epidemiology ,",
    "stochastic models are especially important when considering smaller populations such as households , schools , farms and workplaces @xcite .",
    "the use of these types of models for inference is becoming more widespread , thus computational efficiency , as well as accuracy , is a primary concern @xcite . for many models ,",
    "stochastic simulation has been the only way of calculating quantities , but this has the drawback of requiring averaging over many realizations for accuracy .",
    "with increasing computing resources , numerical methods of solution , exact to a given precision , are now an attractive proposition for these type of models @xcite .",
    "+ in epidemiology , one of the most important quantities , for both inference and public health , is the epidemic final size distribution .",
    "the final size is the total number of individuals who have experienced infection over the course of the epidemic . .",
    "calculating is the subject of a wide body of literature : see @xcite for a review . for the classic markovian sir model , bailey s @xcite method and in particular the implementation due to",
    "@xcite has been shown to be superior , being both numerically stable and computationally efficient @xcite .",
    "can be derived in a number of ways , but a physical interpretation has been lacking . that the infectious period is is known to be unrealistic @xcite .",
    "another procedure which allows for more general infectious period distributions is due to @xcite .",
    "unfortunately , this suffers from a number of numerical problems , even for moderate population sizes @xcite .",
    "+ in this paper we present a new method for the computation of final size distributions  which is both exact and numerically stable .",
    "it is also computationally efficient , and physically transparent , allowing us to calculate distributions for a range of more complex models .",
    "our method is based around a particular representation of the stochastic process , know as the _ degree - of - advancement _ representation .",
    "this has been recently used in relation to continuous - time markov chains @xcite .",
    "it is based on counting instead of population numbers and a lexicographical ordering of the state space .",
    "+ the basic idea behind our methodology is intuitively simple .",
    "the epidemic process can be considered as a random walk , ending in an absorbing state which then determines the final size .",
    "the probability of hitting that state is then just the sum of the probabilities of all possible paths of reaching that state .",
    "however , it can be difficult to enumerate all these paths and correctly sum them .",
    "in fact , in his original paper , @xcite considers a suggestion from a colleague for a scheme like this .",
    "he rejects the idea though , because ` the summation may leave some doubt as to whether all relevant terms have been included ' .",
    "we show that adopting the da representation solves this problem and summing over all paths becomes trivial as the jump chain of the process resembles a probability tree .",
    "our method is an advancement on bailey s method  and derivatives of it  as it is more transparent and can be extended to a range of more complex models ; it allows us to calculate final size distributions for models which up until now have been intractable to all but simulation , such as those which include waning immunity . +",
    "the remainder of this paper is as follows .",
    "we begin by illustrating the fundamental idea using the sir model .",
    "we discuss the methodology and algorithms in some detail because the models we consider later are generalizations of this .",
    "in particular we compute the final size distribution for an sir model with a phase - type infectious period distribution and a model with waning immunity where the number of infections is potentially unbounded .",
    "finally we give a discussion of our results and their other uses .",
    "in particular , we highlight the connection to the computation of hitting probabilities @xcite . although we have derived these results by considering models in epidemiology , the basic results are much more general .",
    "stochastic models with a similar structure are now common tools in many areas @xcite and hence this methodology will be potentially useful in a wide range of disciplines .",
    "matlab code for generating all these results is provided in the supplementary material .",
    "we illustrate the basic idea using the well known markovian sir model @xcite .",
    "the state of the process is @xmath0 , the number of susceptible and infectious individuals at time @xmath1 .",
    "the transitions and rates which define the model are given in table [ tab : sir ] .",
    "these transitions are given in terms of the population numbers , @xmath2 and @xmath3 , hence this is known as the population representation . instead of this , we work representation @xcite .",
    "this involves counting the number of of each type instead of the population numbers .",
    "we therefore define @xmath4 and @xmath5 as the number of infection and recovery events respectively , and hence the state of the process at time @xmath1 is @xmath6 .",
    "the random variable @xmath4 also counts the first infection events , which we take to have occurred from an outside source and hence sets the initial condition for the problem .",
    "the difference between these representations is that population numbers can both increase and decrease , whereas the transition counts can only ever increase .",
    "the number of susceptible , infectious and recovered individuals are then given by , @xmath7 respectively , where @xmath8 is the total population size . using these relations",
    "the rates of each type of transition can be calculated in terms of @xmath4 and @xmath5 .",
    "+    .transitions and rates defining the sir model .",
    "@xmath9 , where @xmath8 is the size of the population . [ cols=\"^,^\",options=\"header \" , ]         the size of the vector , @xmath10 , of we need to store to compute the final size distribution is @xmath11 , + the elements to zero , apart from @xmath12 , where @xmath13 is the initial number of infectious individuals .",
    "as before , we iterate through the states of the system in co - lexicographic order +   + for each value of we then calculate the rates of all possible events , @xmath14 , @xmath15 , and their total @xmath16 and update the elements of @xmath10 as follows . for each event type @xmath17 we update + @xmath18 in order , where @xmath19 for the @xmath20 + another way to find @xmath21 is to extract the correct probabilities as the algorithm progresses : if it comes to a state which has zero probability of leaving ( @xmath22 )",
    ", then it is an absorbing state corresponding to a final size , @xmath23 . because of the chosen ordering , the order in which absorbing states are encountered matches that of the final size distribution .",
    "an example of the output is shown in figure 3 for the si(@xmath24)r model and compared with the standard sir model in the inset .",
    "full code for generating this is given in the supplementary materials .",
    "+   + the power of this recursive approach comes from the simplicity of the algorithm , and hence the speed of execution . obviously , this relies on being able to calculate the indexes and @xmath25 analytically , so this information does not need to be stored .",
    "even though the size of the state space for such models can be into the hundreds of millions it can be processed very quickly and numerically it is very stable .",
    "this is in contrast to which , although it uses a much smaller set of equations , requires numbers retaining a high degree of accuracy which is harder for a computer to handle natively @xcite . +    .",
    "the inset shows the difference between the pmfs for the erlang(4 ) model and the basic exponential sir model .",
    "both epidemics start with 1 infectious individual .",
    "other parameters : @xmath26 and @xmath27 . ]",
    "we now use the methodology developed in the previous sections to calculate the total number of infections in a stochastic epidemic model with waning immunity .",
    "the simplest such model is a _",
    "susceptible - infected - recovered - susceptible _ ( sirs ) model @xcite .",
    "the transitions defining this are as in table [ tab : sir ] with the addition of @xmath28 where @xmath29 is the number of recovered individuals .",
    "denote the number of waning immunity events by @xmath30 .",
    "such a model is different to the sir model as there is no upper bound on the total number of infection events .",
    "thus , @xmath31 and the state space is unbounded .",
    "+ one way is to simply truncate the da state space , form the jump chain and solve eq .  .",
    "a much better way is to exploit the ordered structure of the state space to create a recursive method . by ordering the states with respect to the number of @xmath30 events , as in figure [ fig : sirs_ss ]",
    ", we can use eqs .   to derive limits on the possible number of @xmath4 and @xmath5 events , @xmath32",
    "this suggests we make a transformation of variables , @xmath33 and @xmath34 , so the rates of events @xmath4 , @xmath5 and @xmath30 become , @xmath35 respectively .",
    "note , that these rates are now independent of @xmath36 .",
    "+ to recursively compute the final size distribution ( total number of @xmath4 events ) we only need to store probabilities for two slices of the state space .",
    ", both of length @xmath37 .",
    "we truncate the maximum number of @xmath4 events , and hence the largest possible observed final size @xmath38 .",
    "we then define the vector @xmath39 which will hold the final size distribution .",
    "the last element of @xmath21 will be probability of observing more than @xmath38 infection events , which is also computed very naturally using this approach .",
    "we initialize , @xmath40 and @xmath21 by setting all their elements to zero , apart from @xmath12 , where @xmath13 is the initial number of infectious individuals .",
    "the algorithm then proceeds as follows : for each value @xmath41 , we iterate over all possible values of @xmath42 and @xmath43 in co - lexicographic order in exactly the same way as for the basic sir model . + for each state we calculate the rates of the three events from eq .  .",
    "we then update the elements of @xmath10 and @xmath40 as follows : where @xmath44 . in determining the element of @xmath40 to update",
    "we have taken into account the transformation of variables above .",
    "the algorithm then continues by setting @xmath45 , then @xmath46 and looping to the next value of @xmath30 .",
    "once all values of @xmath30 have been iterated over , the probability of more than @xmath38 infection events is simply @xmath47 figure 5 shows the probability mass function of the total number of infections for an sirs model with @xmath48 .",
    ", for the total number of infections in an sirs model with @xmath48",
    ". the maximum number of infections , , is set to 60 .",
    "the bar at 61 is then the probability of @xmath49 .",
    "parameters are : @xmath50 , @xmath27 and @xmath51 . ]",
    "we have presented a new method for computing the final size distribution for a number of epidemic models . using the da representation of the stochastic process",
    "means the jump chain has a particularly simple form resembling a probability tree .",
    "this structure allows the derivation of an iterative method for calculating the final size distribution .",
    "although similar methods have been proposed for the sir model @xcite , ours is both the simplest to implement and understand and is also more efficient computationally and in terms of memory usage .",
    "the biggest advantage of our method is its straightforward applicability to more complex models .",
    "we have demonstrated this by computing final size distributions for the si(@xmath52)r model and the sirs model , where the number of infection events is unbounded .",
    "this opens up these models for use in inference work using final size data @xcite .",
    "+ although we have derived and illustrated these methods using models within epidemiology , they are much more general .",
    "they are applicable to markovian models in which we wish to calculate hitting probabilities @xcite or where probabilities of given paths through a state space are required @xcite . in ecology and epidemiology",
    "we are often interested in offspring distributions .",
    "this is the distribution of the number of secondary entities a single entity gives rise to over a particular lifetime .",
    "@xcite has shown how offspring distributions for a stochastic model can be computed by recursively solving sets of linear equations . with the methodology presented here ,",
    "these quantities could be computed more efficiently in much the same way as presented for the sirs model . +",
    "a limitation on this method is that as more event types are added the size of the state space grows as described by eq .  .",
    "thus although typically we are not limited by memory due to the recursive nature of the solutions , the time to compute a distribution will grown linearly with the size of the state space . as an example of times for computation ,",
    "the si(4)r model shown in figure 3 has @xmath53 and @xmath54 ; computation of the final size distribution is approximately 3.1 seconds using an algorithm programmed in c on a 2.5ghz machine .",
    "the same model with @xmath55 has @xmath56 ; this took 1.8 minutes to process . by normal standards , these are very large state spaces .",
    "one advantage of the ball method is that it can handle any infectious period distribution for which we can write down the laplace transform @xcite , whereas our method is limited to phase - type distributions .",
    "+ for very large values of @xmath52 , the number of stages in the infectious period , ball s method combined with a variable precision arithmetic @xcite might outperform our method , depending on the implementation of the variable precision arithmetic . however , for values of @xmath52 typically of interest , our method is the most efficient . +",
    "fundamentally the algorithm we have presented is a serial process , so there is little possibility of using parallel computational resources to speed up the procedure . one promising direction which could allow even larger models",
    "is the use of an adaptive mechanism which limits the algorithm to the parts of the state space where most probability is concentrated .",
    "the ordering of the state space lends itself to a scheme like this so , especially as the dimensionality of the problem increases , this could provide large savings with little loss of accuracy . for larger values of @xmath8",
    "there is also the possibility of deriving approximate analytic solutions .",
    "+ there are two other areas where this methodology is potentially important .",
    "the da representation was originally conceived as a way of speeding up the integration of the forward equation which describes the temporal dynamics of the system @xcite .",
    "this method becomes slow as the size of the state space increases , thus it would be very beneficial to be able to restrict the state space to a smaller region as in finite - state projection methods @xcite .",
    "our methodology provides a way to calculate which regions of the state space should be kept by solving for the vector @xmath57 which provides information about the most probable paths through the system .",
    "another potentially important use of this methodology is in computing the probability of hitting a _ fixed _ state from a given set of initial states @xcite . we often want to calculate these quantities when working with conditioned markov chains @xcite .",
    "this quantity can be computed in a very similar way to the final size distribution except that the iteration over the states of the system proceeds backwards from the final state .",
    "again the structure of the state space makes this straightforward to implement .",
    "this research was supported under the australian research council s discovery project ( dp110102893 ) and future fellowship ( ft130100254 ) funding schemes .",
    "we would also like to thank the two anonymous referees whose extensive comments and careful reading have improved this paper .",
    "35 natexlab#1#1url # 1`#1`urlprefix                            halloran , m.  e. , ferguson , n.  m. , eubank , s. , longini , i.  m. , cummings , d. t.  a. , lewis , b. , xu , s. , fraser , c. , vullikanti , a. , germann , t.  c. , 2008 . modeling targeted layered containment of an influenza pandemic in the united states .",
    "usa 105 , 46394644 .",
    "house , t. , inglis , n. , ross , j.  v. , wilson , f. , suleman , s. , edeghere , o. , smith , g. , olowokure , b. , keeling , m.  j. , 2012 .",
    "estimation of outbreak severity and transmissibility : influenza a(h1n1)pdm09 in households .",
    "10 , 117 .",
    "neuts , m.  f. , li , j. , 1996 . in : heyde , c.  c. , prohorov , y.  v. , pyke , r. , rachev , s.  t. ( eds . ) , athens conference on applied probability and time series analysis .",
    "springer , new york , ch .",
    "an algorithmic study of s - i - r stochastic epidemic models ."
  ],
  "abstract_text": [
    "<S> we develop a new methodology for the efficient computation of epidemic final size distributions . </S>",
    "<S> we exploit a particular representation of the stochastic epidemic process to derive a method which is both computationally efficient and numerically stable . </S>",
    "<S> the algorithms we present are also physically transparent and so allow us to extend this method from the basic sir model to a model with a phase - type infectious period and another with waning immunity . </S>",
    "<S> the underlying theory is applicable to many markovian models where we wish to efficiently calculate hitting probabilities .    </S>",
    "<S> markov chain , degree - of - advancement , hitting probabilities , waning immunity </S>"
  ]
}