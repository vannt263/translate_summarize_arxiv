{
  "article_text": [
    "first - principles methods represent a powerful tool to predict optical properties of materials with high accuracy . in combination with experimental data ,",
    "they provide insight into the features of the investigated systems . in solid - state physics , many - body perturbation theory ( mbpt ) is the state - of - the - art approach to compute dielectric properties @xcite : electron - electron correlation is included through the @xmath0 approximation @xcite , while excitonic effects are taken into account through the solution of the bethe - salpeter equation ( bse ) @xcite .",
    "implementations of mbpt are now available interfaced to the most popular density - functional theory ( dft ) packages , making these calculations routinely done .",
    "however , comparison with experimental data is often not straightforward .",
    "dielectric tensors computed from _ ab initio _ codes are bulk quantities , relating to the coordinate system of the unit cell .",
    "this hardly fits typical laboratory conditions , where samples are usually thin films , including one or more layers of materials and a dielectric substrate @xcite . in anisotropic materials , where dielectric tensors have non negligible off - diagonal components , some spectral features can be completely missed , if only the diagonal terms are considered .",
    "finally , for a comparison with experimental data , calculations should take into account additional degrees of freedom , such as incidence angle and polarization of the incoming beam , as well as orientation and thickness of the sample .    in this paper",
    ", we present ` layeroptics ` , an efficient computational tool , based on the solution of maxwell s equations for optically anisotropic media @xcite , to compute fresnel coefficients in layered materials .",
    "this formalism is a generalization for anisotropic media of the 2@xmath12 approach , commonly used for isotropic layered systems @xcite . in the current implementation , ` layeroptics ` is a post - processing tool for dielectric tensors obtained with the all - electron code ` exciting ` @xcite . due to its simple and versatile structure , interfacing ` layeroptics ` to other _",
    "ab initio _ codes is straightforward . after introducing the theoretical background and the structure of the implementation",
    ", we present the capabilities of ` layeroptics ` with a selection of examples concerning optical and x - ray absorption properties of molecular materials , such as oligothiophene crystals and azobenzene self - assembled monolayers ( sams ) .",
    "our results indicate the importance of off - diagonal elements of dielectric tensors in calculating optical properties of anisotropic thin films .",
    "significant changes in the fresnel coefficients are observed by varying the angle of incidence of the incoming light as well as its polarization .",
    "we reproduce the spectra of a model organic crystal , including two layers of materials with different orientation of the molecules with respect to the substrate , as expected in experimental growth conditions .",
    "finally , we show how ` layeroptics ` can be used to determine the parameters related to the orientation of the molecules in a sam .",
    "good agreement with experimental data supports the validity of our approach to reproduce optical absorption features in anisotropic layered materials .",
    "the paper is organized as follows : in section [ sec : theory ] we provide the theoretical background for the calculation of the fresnel coefficients . in section [ sec : implement ] we describe the adopted numerical procedure , and finally in section [ sec : results ] we present the application of ` layeroptics ` to selected examples .",
    "each layer of material is characterized by its thickness ( @xmath2 and @xmath3 ) and dielectric tensor ( @xmath4 and @xmath5 ) .",
    "@xmath6 is the wave vector of the incoming light , with incidence angle @xmath7 , defined with respect to the surface normal @xmath8 .",
    "the angle of polarization of the light in the medium ( @xmath9 ) is indicated with respect to the @xmath10 axis . ]",
    "the propagation of electromagnetic waves in an anisotropic material is determined by maxwell s equation in momentum space : @xmath11 where @xmath6 is the wave vector with frequency @xmath12 , @xmath13 the velocity of light in vacuum , @xmath14 the electric field and @xmath15 the frequency - dependent dielectric tensor . in order to obtain non trivial solutions for @xmath14 , the determinant of the homogeneous and linear system of equations ( [ eq1_1 ] ) has to vanish . with fixed components @xmath16 and @xmath17 ,",
    "this condition yields four roots @xmath18 ( @xmath19 ) , for each @xmath12 . in well - behaved cases they correspond to two polarizations in two propagation directions ( @xmath20 ) .",
    "we can write the total electric field in the medium as : @xmath21 , \\ ] ] and the corresponding magnetic - field vector as : @xmath22 transmission and reflection coefficients are obtained by imposing the boundary conditions of the parallel components of the electric ( magnetic ) field @xmath23 and @xmath24 ( @xmath25 and @xmath26 ) at the layer interfaces .",
    "we assume the layered system to be infinitely extended in the @xmath27-plane and stacked along the @xmath8 direction , as sketched in fig .",
    "[ fig1:setup ] . the boundary between the top layer , which is by default a semi - infinite vacuum layer , and the first material layer is set at @xmath28 .",
    "each layer @xmath29 , characterized by a dielectric tensor @xmath30 , has finite thickness @xmath31 , with @xmath32 , where @xmath33 is the total number of layers . a semi - infinite isotropic substrate , @xmath34 ,",
    "is assumed as bottom layer ( see fig .",
    "[ fig1:setup ] ) . by adopting these conventions ,",
    "we can write the total dielectric tensor of the layered system as : @xmath35 at the interface @xmath36 this yields the matrix equation for the electric amplitudes : @xmath37 where @xmath38 and @xmath39 are 4@xmath14 matrices .",
    "the matrix @xmath38 includes the electric and magnetic polarization vectors @xmath40 and @xmath41 : @xmath42 while the matrix @xmath39 is formed directly from the @xmath18-component : @xmath43 these relations between the electric field vectors at each layer boundary can be used to connect the amplitudes of the electric fields in the vacuum layer and in the substrate as follows : @xmath44 denoting the total transfer matrix @xmath45 as the product of the single - layer transfer matrices @xmath46 : @xmath47 we can rewrite eq . [ eq1_7 ] as : @xmath48 the @xmath49 matrix equation ( [ eq1_8 ] ) yields unique solutions @xmath50 and @xmath51 , provided that four boundary conditions are fixed ( see eq .",
    "[ eq : a_boundary ] below ) . in order to obtain the transmission coefficient for the intensity ,",
    "the poynting vector for the substrate has to be calculated . for an isotropic substrate",
    ", the time - averaged poynting vector @xmath52 can be written as : @xmath53 the transmittance in layer @xmath29 is defined as : @xmath54 where @xmath55 is the poynting vector in vacuum . since transmittance is typically measured in the substrate layer @xmath34 , we write this coefficient as : @xmath56 where @xmath57 ( @xmath58 ) is the parallel ( perpendicular ) component .",
    "the _ total _",
    "transmission coefficient is the sum of @xmath57 and @xmath58 components : @xmath59 .",
    "the absorbance @xmath60 is directly related to the transmittance through beer s law : @xmath61 this relation holds for the @xmath57 and @xmath58 components , as well as for the _ total _ coefficient .",
    "finally , parallel and perpendicular components of the reflectance @xmath62 are expressed , respectively , as : @xmath63 and @xmath64 the _ total _ reflection coefficient is @xmath65 .",
    ", as implemented in ` layeroptics ` , for the angles @xmath66 , @xmath67 and @xmath68 around the cartesian axes @xmath8 , @xmath69 , and @xmath8 , respectively",
    ". rotations are shown in the order they are applied : first @xmath68 , then @xmath67 and finally @xmath66 . the rotated ( fixed ) frame",
    "is indicated in blue ( black ) . ]      in this section , we describe the numerical procedure to compute optical coefficients in layered materials with ` layeroptics ` . for this purpose",
    ", a number of preliminary steps needs to be performed .",
    "this is reflected in the structure of ` layeroptics ` : before executing the script , a setup tool has to be run ( see appendix b ) . in the beginning",
    ", we have to define the notation for the four - component vectors @xmath70 , with respect to the directions of light propagation in the birifringent medium . according to the scheme presented in fig .",
    "[ fig1:setup ] , with the interface between the semi - infinite vacuum layer and the top dielectric layer at @xmath8=0 , we consider _ downwards _ motion along the ( @xmath71)-direction , and _ upwards _ motion in ( @xmath72)-direction .",
    "moreover , we define the _ parallel _ polarization of the electric field in the @xmath73-plane , and the _ perpendicular _ one in the @xmath74-plane . in this way",
    ", we can index the four components as follows : @xmath75 full dielectric tensors , including off - diagonal components , represent the main input of ` layeroptics ` . in standard _",
    "ab initio _ codes dielectric tensors are expressed with respect to cartesian axes , which in case of non orthogonal unit cells may not coincide with the lattice vectors . when dealing with anisotropic materials , it is crucial to express the dielectric tensor in terms of a coordinate system that reflects the experimental setup . for this purpose ,",
    "we introduce the rotation matrix @xmath76 , defined by the euler angles @xmath66 , @xmath67 and @xmath68 ( see fig .",
    "[ fig2:euler ] ) . with these three rotations any possible orientation of the sample with respect to the reference coordinate system can be represented .",
    "euler rotations are performed in the following order ( see fig .",
    "[ fig2:euler ] ) : first a rotation @xmath68 around the @xmath8-axis is considered , next a rotation @xmath67 is performed around @xmath69 , and finally rotation @xmath66 with respect to the @xmath8-axis . using the following standard notation : @xmath77 the rotation matrix is expressed as : @xmath78 and the resulting _ transformed _",
    "dielecric tensor @xmath79 is : @xmath80 finally , a number of parameters related to the experimental setup has to be chosen ( see fig .",
    "[ fig1:setup ] ) .",
    "@xmath7 is the angle between the incident beam , assumed in the @xmath73-plane , and the plane of incidence of the sample ( @xmath27 ) .",
    "@xmath9 determines the angle of polarization of the incoming light , with amplitude normed to one : @xmath81 corresponds to light fully polarized in the parallel direction , while @xmath82 indicates incoming light with perpendicular polarization .",
    "in addition to the ( optionally rotated ) full dielectric tensor @xmath83 , the thickness @xmath84 of each layer has to be provided in input .          based on the equations presented in section [ sec : theory ] , optical coefficients are computed by ` layeroptics ` , following the steps indicated in the flowchart of fig .",
    "[ fig : flowchart ] .",
    "first , for each layer @xmath85 , the roots of the characteristic polynomial of eq . [ eq1_1 ] are calculated , yielding the wave - vector components @xmath18 ( @xmath19 ) . from them ,",
    "the corresponding electric and magnetic polarization vectors , @xmath20 and @xmath86 , respectively , are obtained .",
    "these are the main ingredients to determine the transfer matrices @xmath87 ( eq .  [ eq1_8 ] ) , after @xmath88 and @xmath89 are calculated from eqs . [ eq1_5 ] and [ eq1_6 ] .",
    "special treatment is required for vacuum and substrate layers .",
    "the matrices @xmath90 and @xmath91 are needed in order to determine the total transfer matrix @xmath92 of the entire layered system . to compute @xmath92 , eq .",
    "[ eq1_8 ] is solved for @xmath93 and @xmath94 , representing the amplitude of the incoming light set in input , and by fixing @xmath95 , under the physical assumption that no light is emitted from the substrate , at @xmath96 . in the last step ,",
    "fresnel coefficients are calculated , according to eqs .",
    "[ eq1_11]-[eq1_112 ] ( transmittance ) , eq .",
    "[ eq1_12 ] ( absorbance ) and eqs",
    ".  [ eq1_13]-[eq1_14 ] ( reflectance ) .",
    "in this section we present a selection of applications of ` layeroptics ` .",
    "we focus on molecular systems , namely oligothiophene crystals and azobenzene sams , where anisotropy may induce pronounced effects .",
    "we apply ` layeroptics ` to optical and x - ray absorption spectra , at varying incidence and polarization angle of the incoming light beam , as well as the orientation of the organic thin film with respect to the substrate .",
    "dielectric tensors are computed from mbpt , through the solution of the bse , as implemented in the ` exciting ` code @xcite . in all the examples presented below",
    ", the substrate is modeled with the frequency - independent dielectric function of bulk silicon ( @xmath97=11.8 @xcite ) .",
    "since the frequency - independent background is subtracted from the spectra shown in the following , the specific choice of the substrate does not play a role here .          in the first example",
    ", we investigate the dependence of the reflection coefficient of a sextithiophene ( 6 t ) thin film on the angle and polarization of the incoming light . in the so - called high temperature phase ,",
    "6 t is a monoclinic crystal with 2 molecules per unit cell , lattice parameters @xmath98 = 9.14  , @xmath99 = 5.68  , and @xmath13 = 20.67  , and monoclinic angle @xmath67= 97.78@xmath100 between @xmath98 and @xmath13 @xcite ( see fig . [ fig4:polarization]a ) . for this structure , the dielectric tensor has non - zero off - diagonal components @xmath74 .",
    "we consider a sample of thickness @xmath84 = 2 nm .    according to the notation in fig .",
    "[ fig1:setup ] , we analyze 4 configurations by varying the angle of incidence @xmath7 of the incoming light beam .",
    "in addition to @xmath101 , corresponding to normal incidence , we consider @xmath102 , @xmath103 , and @xmath104 .",
    "the deviation of the total reflection coefficient from the frequency - independent background ( @xmath105 ) is shown in fig .",
    "[ fig4:polarization ] . from fig .",
    "[ fig4:polarization]b , we notice that in the visible region ( 2  3 ev ) @xmath106 is very low , almost independently of the value of @xmath7 . at about 2.5 ev , two bound intramolecular excitons",
    "appear , as described in ref .",
    "these excitons have weak oscillator strength : hence , the incidence angle of the incoming beam has an almost negligible effect . on the contrary , at higher energies ( 3.5  5 ev ) , more intense excitations characterize the spectrum , and consequently @xmath105 undergoes larger variations depending on @xmath7 . at normal incidence , @xmath105 is always positive , and peaks are observed at 4 , 4.5 , and 5 ev .",
    "similar features are observed for @xmath102 , where , however , the shoulders turn into dips , with @xmath107 .",
    "a different scenario appears for @xmath103 and @xmath104 . in both cases @xmath105",
    "is characterized by pronounced dips , and , except for the intense feature at about 4 ev , it is constantly negative in the region 3.5  5 ev .",
    "next , we consider the dependence of @xmath105 on the polarization direction of the incoming light . for normal incidence",
    ", we vary the polarization angle @xmath9 ( see fig .",
    "[ fig1:setup ] ) from 0@xmath100 ( parallel to the @xmath10 axis ) to 90@xmath100 ( parallel to the @xmath69 axis ) . the corresponding plot for @xmath105",
    "is shown in fig .",
    "[ fig4:polarization]c . as mentioned above , for @xmath101 @xmath108 is always positive . for parallel light polarization ( @xmath9 = 0@xmath100 )",
    "we observe again an intense peak at 4 ev , with a shoulder at about 4.3 ev .",
    "additional peaks , with lower oscillator strength , appear between 4.5 ev and 5 ev . in case of perpendicular light polarization ( @xmath9 = 90@xmath100 ) , @xmath105 exhibits different features .",
    "the most intense peak is now found at @xmath1093.9 ev , with a shoulder at @xmath1093.8 ev .",
    "also at higher energies , in the region 4.25  4.75 ev , peaks appear for @xmath9 = 90@xmath100 where dips are observed for parallel polarization of the incoming light .",
    "only the peak at 5 ev is present , regardless the value of @xmath9 .",
    "for incoming light with @xmath9=45@xmath100 , @xmath105 shows a combination of the features observed in the previous cases ( @xmath9 = 0@xmath100 and @xmath9 = 90@xmath100 ) .",
    "this is especially evident in the excitation band around 4 ev , where two peaks and two shoulders appear , corresponding to the respective features observed for parallel and perpendicular polarization angles . the same holds also for the peaks between 4.25 and 4.75 ev .",
    "plane of the unit cell at the interface , while in the _ flat _ configuration the unit cell is rotated such that the long molecular axis is parallel to the substrate surface .",
    "c ) parallel and perpendicular components of the absorbance for each setup , ranging from i to v ( see table [ table ] ) . the contribution of the frequency - independent substrate is subtracted . ]    in the second example we consider a layered thin film of a bithiophene ( 2 t ) crystal . like 6 t , also 2 t has a monoclinic unit cell , with lattice parameters @xmath98 = 7.73  , @xmath99 = 5.73  , and @xmath13 = 8.93  and monoclinic angle @xmath67= 106.72@xmath100 between @xmath98 and @xmath13 @xcite , hosting 2 molecules ( see fig . [",
    "fig5:2t]a ) .",
    "we consider a system with total thickness @xmath110 = 20 nm , consisting of two layers of 2 t . each layer is characterized by a different orientation of the molecules with respect to the substrate , as sketched in fig .",
    "[ fig5:2t]b . in the lower layer , at the boundary with the isotropic substrate ,",
    "the molecules lie _ flat _ , with their long axis oriented parallel to the surface .",
    "this is typically the situation of organic thin films grown on a metal substrate ( see e.g. ref .",
    "such configuration is obtained by applying a rotation ( fig . [",
    "fig5:2t]a ) of -52.4@xmath100 around the @xmath10 axis of the unit cell . in the upper layer ,",
    "the 2 t thin film lies in the @xmath111 plane of its unit cell : we refer to this as _ bulk - like _ configuration .",
    "no euler rotation is applied in this case .",
    ".different setups of a layered 2 t thin film , with total thickness of 20 nm .",
    "the thickness @xmath112 ( @xmath113 ) , in nm , is referred to the _ flat _ ( _ bulk - like _ ) orientation of the molecules with respect to the substrate ( see fig . [ fig5:2t]a - b ) . [ cols=\"^,^,^\",options=\"header \" , ]     we consider overall 5 setups , keeping @xmath110 = 20 nm fixed , and varying the thickness of the _ flat _ and _ bulk - like _ layers with steps of 5 nm ( see table [ table ] ) . for each setup",
    ", we compute parallel ( @xmath57 ) and perpendicular ( @xmath58 ) components of the absorbance , shown in fig .",
    "[ fig5:2t]c .",
    "again , we model the substrate using the frequency - independent dielectric constant of bulk silicon , and we subtract the background . by comparing the set of spectra for @xmath57 and @xmath58 polarization",
    ", we immediately notice striking differences .",
    "the parallel component of the absorbance presents a maximum at about 4.75 ev , which appears for each setup with almost the same intensity . at lower energy , at approximately 4.2 and 4.5 ev , respectively , two additional features appear in the @xmath57-polarized spectrum of those configurations incorporating a _ flat _ layer . when all molecules in the thin film are oriented to lie _ flat _ onto the substrate ( setup i ) , these peaks disappear and only an extremely weak shoulder is present just above 4 ev . above 5 ev ,",
    "all the spectra coincide .",
    "conversely , in the @xmath58-polarized component of the absorbance , the maximum is found at about 3.8 ev , and again it is most intense in the pure _ bulk - like _ configuration ( v ) .",
    "the strength of this peak decreases at increasing thickness of the _ flat _ layer , and completely disappears in setup i ( _ flat _ configuration only ) . above 4 ev ,",
    "weaker features are observed .",
    "the shoulder at about 4.25 ev and the weak peak at @xmath1094.8 ev behave similarly to the most intense peak , i.e. , their intensity is maximum ( minimum ) in setup v ( i ) . on the other hand",
    ", the peak at 4.5 ev maintains almost the same intensity going from system i to iv , while it is not present in the pure _ bulk - like _ configuration ( setup v ) .",
    "is defined between the normal ( blue arrow ) of the phenyl rings plane ( shaded rectangle ) and the normal with respect to the substrate ( @xmath114  black arrow ) .",
    "@xmath67 is the angle between @xmath114 and the long molecular axis .",
    "b ) azobenzene molecule considered in the calculation of dielectric tensors : an end group terminates the molecules to simulate the chemical environment of the covalent bond to the sam .",
    "c ) parallel ( @xmath57 ) and perpendicular ( @xmath58 ) components of the absorbance at varying @xmath66 , corresponding to different concentration of azobenzene molecule in the sam .",
    "experimental data are taken from ref .",
    "]    as a final example , we present the application of ` layeroptics ` to x - ray absorption spectra ( xas ) from the nitrogen ( n ) k - edge of azobenzene - functionalized sams . in a recent experiment @xcite , it was shown that the orientation of the azobenzene molecules with respect to the substrate depends on their concentration in the sam .",
    "such behavior can be observed from polarization - resolved xas , where the intensity of the peaks , and in particular of the lowest - energy resonance , varies significantly between parallel and perpendicular components for different azobenzene concentrations .",
    "this resonance corresponds to a transition from n 1@xmath58 to the lumo , which has @xmath115 character and transition dipole moment along the long molecular axis @xcite . for this reason",
    ", its strength is expected to be affected by the orientation of the molecule with respect to the substrate .",
    "this can be determined by estimating the mean tilt angle @xmath116 ( see fig .",
    "[ fig6:azobenzene]a ) , which represents the angle between the normal of the phenyl rings plane ( thick blue arrow ) and the normal to the substrate ( @xmath114 , black arrow ) .",
    "our starting point is the dielectric tensor of the azobenzene molecule , including excitations from n 1@xmath58 core levels to the conduction states .",
    "the molecule has been accommodated in an orthorhombic supercell with lattice parameters oriented according to the coordinate axes in fig .",
    "[ fig6:azobenzene]b ( for additional details , see ref .",
    "@xcite ) . in these calculations",
    ", we have neglected the presence of the alkyl chains , which connect azobenzene to the gold substrate in the experimental sample ( see fig .",
    "[ fig6:azobenzene]a ) , since , for core - level excitations from the n k - edge , they are expected not to play a role .",
    "we represent the sam as a thin film of thickness 4 nm , and we model the substrate using the frequency - independent dielectric function of bulk silicon .",
    "the angle of incidence of incoming light is set to @xmath7=70@xmath100 , as in experiment .",
    "we compute the @xmath57- and @xmath58-components of the absorbance at different values of @xmath116 , corresponding to azobenzene concentration of 100@xmath117 ( @xmath116=73@xmath100 ) and 80@xmath117 ( @xmath116=67@xmath100 ) @xcite , .",
    "different orientations of the molecules with respect to the substrate are represented by rotations of the dielectric tensor . the euler angle @xmath67 , between the normal direction with respect to the substrate @xmath114 and the long molecular axis ( see fig .",
    "[ fig6:azobenzene]a ) , is fixed to 30@xmath100 . under this condition",
    ", @xmath116 is related to the third euler angle @xmath68 by @xmath118 . making use of this relationship and setting the first euler angle @xmath66=0@xmath100",
    ", we can effectively simulate different molecular orientations indicated by the angle @xmath116 , by rotating the dielectric tensor with respect to @xmath68 : @xmath116=73@xmath100 corresponds to @xmath68=55@xmath100 and @xmath116=67@xmath100 to @xmath68=40@xmath100 .",
    "the resulting absorption spectra are shown in fig .",
    "[ fig6:azobenzene]c .",
    "theoretical and experimental data for the absorbance are normalized to the height of the first resonance .",
    "the absorbance in the top panel , corresponding to @xmath116=73@xmath100 , i.e. , full azobenzene coverage in the sam , shows a rather strong polarization - dependence of the intensity of the first resonance , which is at least twice more intense in the @xmath58-component , compared to the parallel one . by decreasing @xmath116 to 67@xmath100 , as predicted in the sam with 80@xmath117 azobenzene concentration , the relative spectral weight of the @xmath57-component increases for the first peak .",
    "although the peak in the @xmath58-component remains stronger , its relative weight with respect to the parallel component is significantly decreased . as shown in fig .",
    "[ fig6:azobenzene]c , the relative height of the peaks is in good agreement with the experimental data in both cases .",
    "also at higher energy , the oscillator strength of the peaks at about 403 ev is matched well by our calculations .    finally , with ` layeroptics",
    "` , we are also able to estimate the so - called _ magic angle _ , corresponding to the polarization angle for which the absorbance is independent of the polarization channel @xmath58 or @xmath57 .",
    "experimentally , it is considered at 54.7@xmath100 @xcite .",
    "we can determine this angle by tuning the polarization angle such that the parallel component of the absorbance ( @xmath119 ) is equivalent to the perpendicular one ( @xmath120 ) .",
    "from our results , this occurs at 59.6@xmath100 . considering that experimentally these angles are given with an error bar of @xmath1215@xmath100 @xcite",
    ", we regard this estimate as satisfactory .",
    "we have presented ` layeroptics ` , an implementation of the 4@xmath14 matrix formalism of maxwell s equations to compute fresnel coefficients in anisotropic layered thin films .",
    "we are able to match the laboratory setup , by taking into account the direction and the polarization of the incoming light , as well as the orientation of each layer with respect to the substrate .",
    "the capabilities of ` layeroptics ` have been demonstrated by two different scenarios , such as optical properties of organic thin films on a substrate , and polarization - dependent x - ray absorption spectra of azobenzene - functionalized sams . with prototypical examples",
    ", we have shown the importance of off - diagonal components of dielectric tensors in anisotropic materials , in order to quantitatively compare the calculated spectra with experiments . incorporating information about orientation and polarization of the light allows for an even more quantitative comparison .",
    "our results confirm the potential of this approach to gain insight into the microscopic mechanisms ruling light absorption in anisotropic thin films . `",
    "layeroptics ` is applied to post - process full dielectric tensors computed with the ` exciting ` code . due to its simple and versatile structure ,",
    "this tool can be easily interfaced to any other _ ab initio _ package .",
    "this work was funded by the german research foundation ( dfg ) , through the collaborative research centers sfb 658 and 951 .",
    "c.c .  acknowledges support from the _ berliner chancengleichheitsprogramm _ ( bcp ) .",
    "we are grateful to juan pablo echeverry enciso for providing the dielectric tensors of the 2 t crystal .",
    "among the four solutions @xmath18 of the maxwell s wave equation ( eq . [ eq1_1 ] ) , it is commonly assumed that two have positive real part ( @xmath122 ) , while for the other two @xmath123 .",
    "this corresponds to the physical situation of electromagnetic waves moving through the medium up- and down - wards , with respect to the incidence direction of the light beam @xcite .",
    "we find , however , that this assumption is not generally fulfilled when the off - diagonal elements of the dielectric tensors @xmath124 are of the same order of magnitude of the diagonal ones .",
    "this can happen in strongly anisotropic materials . in this case",
    ", @xmath125 may have the same sign in all four components of @xmath124 , giving rise , at the same time , to non - zero transmission and reflection coefficients in the layered system .",
    "this occurrence leads to an arbitrariness in the notion of _ parallel _ and _ perpendicular _ components with respect to the plane of incidence of the incoming beam , as well as in the notion of _ upwards _ and _ downwards _ directions of light propagation with respect to the layer . since ` layeroptics ` assumes the electric amplitudes of the vacuum and the substrate layers to be isotropic , the boundary condition that no light is emitted from @xmath96 is fulfilled .",
    "hence , the physical meaning of the computed fresnel coefficients is not affected .",
    "the main input of ` layeroptics ` is given by full dielectric tensors @xmath124 , including diagonal and off - diagonal components , for each computed energy point .",
    "if any component is missing in the input files , the program automatically sets it to zero for each frequency point . `",
    "layeroptics ` is a python script , which in the current version works as post - processing tool of the ` exciting ` code @xcite . through an interactive interface , the script ` lo-setup.py ` allows to label the dielectric tensors for each layer and to transform them using euler rotations .",
    "the user is asked to define the euler angles @xmath66 , @xmath67 and @xmath68 , according to the framework depicted in fig .",
    "[ fig2:euler ] . in the example shown in fig .",
    "[ fig : losetup ] , the dielectric tensor of layer 1 is rotated according to euler angles @xmath66=30@xmath100 , @xmath67=45@xmath100 , and @xmath68=60@xmath100 .",
    "the transformed tensors are renamed as ` n_ij.out ` , where ` n ` indicates the layer index , and ` ij ` the components of @xmath126 .",
    "these files are used by the script ` lo-execute.py ` , which implements the algorithm for calculating fresnel coefficients ( see fig . [",
    "fig : loexec ] ) .",
    "also in this case , an interactive interface allows the user to set the input parameters for the incoming light and the number of layers , excluding vacuum and substrate .",
    "the value of the frequency - independent dielectric function for the substrate only determines the background of the optical coefficients , but has no impact on their spectral shape .",
    "the incidence and polarization angles , @xmath7 and @xmath9 , respectively , can be either set by single values or through a range . in the latter case",
    ", the user has to specify the initial and final value of the interval , as well as the number of intermediate steps .",
    "the user is also asked to set the thickness of each layer .",
    "an example for a 2-layer sample is shown in fig .",
    "[ fig : loexec ] .",
    "the output consists of three files : ` absorbance.out ` , ` reflection.out ` and ` transmission.out ` .",
    "each file contains 4 columns : energy ( in ev ) , parallel ( @xmath57 ) component , perpendicular ( @xmath58 ) component , and total value of the corresponding fresnel coefficient . for calculations performed over a range of @xmath7 or @xmath9 angles , for each point of the interval a separate file",
    "is produced , labeled by a number , starting with zero ( e.g. ` absorbance0.out ` ) .",
    "the angles of azobenzene molecules in a sam with concentration of 80@xmath117 are predicted from experiment to range between 54@xmath127 and 64@xmath127 . in our simulation",
    ", we consider a value of @xmath128=67@xmath127 , which is slightly above the experimental prediction . due to the large uncertainty also in experiment",
    ", we consider this choice fully acceptable .",
    "the slight blue - shift of our results compared to the experimental spectrum are ascribed to the use of the dielectric tensor the the isolated molecule , while the data from ref .",
    "@xcite are taken for the sam .",
    "for an exhaustive analysis and comparison of the xas of azobenzene molecule and sam see ref ."
  ],
  "abstract_text": [
    "<S> theoretical spectroscopy is a powerful tool to describe and predict optical properties of materials . </S>",
    "<S> while nowadays routinely performed , first - principles calculations only provide bulk dielectric tensors in cartesian coordinates . </S>",
    "<S> these outputs are hardly comparable with experimental data , which are typically given by macroscopic quantities , crucially depending on the laboratory setup . </S>",
    "<S> even more serious discrepancies can arise for anisotropic materials , e.g. , organic crystals , where off - diagonal elements of the dielectric tensor can significantly contribute to the spectral features . here , we present ` layeroptics ` , a versatile and user - friendly implementation , based on the solution of the maxwell s equations for anisotropic materials , to compute optical coefficients in anisotropic layered materials . </S>",
    "<S> we apply this tool for post - processing full dielectric tensors of molecular materials , including excitonic effects , as computed from many - body perturbation theory using the ` exciting ` code . for prototypical examples , ranging from optical to x - ray frequencies , </S>",
    "<S> we show the importance of combining accurate _ </S>",
    "<S> ab initio _ methods to obtain dielectric tensors , with the solution of the maxwell s equations to compute optical coefficients accounting for optical anisotropy of layered systems . </S>",
    "<S> good agreement with experimental data supports the potential of our approach , in view of achieving microscopic understanding of spectroscopic properties in complex materials .    </S>",
    "<S> maxwell s equations , fresnel coefficients , theoretical spectroscopy , molecular materials </S>"
  ]
}