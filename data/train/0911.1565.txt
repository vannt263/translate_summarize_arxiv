{
  "article_text": [
    "computer simulations are playing an increasingly important role in nearly every area of science and engineering today . the main drive behind this trend is the rapid increase in the overall performance of computer hardware over the past several decades ( _ moore s law _ ) and its relatively low cost .",
    "it is interesting to note that the overall performance of certain specific computing technologies , such as graphics cards , gaming consoles , etc .",
    "has continued to increase at a rate much higher than that of traditional workstation processors , thus making scientific computing on such devices an intriguing possibility : compute unified device architecture ( cuda )  @xcite is nvidia s general - purpose software development system for graphics processing units ( gpus ) ; cell broadband engine ( cbe )  @xcite is a processor that was designed by a collaboration between sony , toshiba , and ibm and is being used in gaming consoles ( sony s playstation  @xcite ) as well as high - performance computing hardware ( ibm s cell blades  @xcite , lanl roadrunner  @xcite ) .    in this article , we will focus entirely on the cbe and demonstrate its use in the acceleration of scientific computing applications .",
    "in particular , we take a sample application from the numerical relativity ( nr ) community  a teukolsky equation solver  @xcite which is a finite - difference ( 2 + 1)d linear , hyperbolic , homogeneous partial differential equation ( pde ) solver  and implement the low - level parallelism that is offered by the cbe architecture .",
    "we describe the approach taken and its outcome in detail .",
    "this nr application is fairly generic , i.e. it is of a type that is quite common in various fields of science and engineering .",
    "therefore our work would be of interest to a larger community of computational scientists .",
    "it is worth pointing out that various researchers have performed a similar evaluation of the cbe using other finite - difference pde solvers  @xcite with very promising results .",
    "these studies typically involved extensive coding at a level that requires rather specialized and advanced knowledge of the cbe s design .",
    "indeed , such an investment is very necessary if the goal is to extract the maximum amount of performance that the processor can offer .",
    "however , our approach in this article is one in which we will make a considerably smaller investment in the specialized coding and yet obtain strong gains in overall application performance .",
    "our approach makes use of a _ software caching _",
    "mechanism on the cell s synergistic processing elements ( spes ) that was made available recently in ibm s cell sdk  @xcite .",
    "we describe this less - known mechanism and our implementation in detail , later in this article .",
    "several gravitational wave observatories  @xcite are currently being built all over the world : ligo in the united states , geo / virgo in europe and tama in japan .",
    "these observatories will open a new window onto the universe by enabling scientists to make astronomical observations using a completely new medium ",
    "gravitational waves ( gw ) , as opposed to electromagnetic waves ( light ) .",
    "these waves were predicted by einstein s relativity theory , but have not been directly observed because the required experimental sensitivity was simply not advanced enough , until very recently .",
    "numerical relativity is an area of computational science that emphasizes the detailed modeling of strong sources of gws  collisions of compact astrophysical objects , such as neutron stars and black holes .",
    "thus , it plays an extremely important role in the area of gw astronomy and gravitational physics , in general .",
    "moreover , the nr community has also contributed to the broader computational science community by developing an open - source , modular , parallel computing infrastructure called _ cactus _",
    "@xcite .",
    "the specific nr application we have chosen for consideration in this work is one that evolves the perturbations of a rotating ( kerr ) black hole , i.e. solves the teukolsky equation  @xcite in the time - domain .",
    "this equation is essentially a linear wave - equation in kerr space - time geometry .",
    "the next two subsections provide more detailed information on this equation and the associated numerical solver code .",
    "the teukolsky master equation describes scalar , vector and tensor field perturbations in the space - time of kerr black holes  @xcite . in boyer - lindquist coordinates ,",
    "this equation takes the form @xmath0",
    "\\partial_{tt}\\psi -\\frac{4 m a r}{\\delta }           \\partial_{t\\phi}\\psi \\nonumber \\\\ & & - 2s\\left[r-\\frac{m(r^2-a^2)}{\\delta}+ia\\cos\\theta\\right ]           \\partial_t\\psi\\nonumber\\\\    & & + \\,\\delta^{-s}\\partial_r\\left(\\delta^{s+1}\\partial_r\\psi\\right ) + \\frac{1}{\\sin\\theta}\\partial_\\theta \\left(\\sin\\theta\\partial_\\theta\\psi\\right)+\\nonumber\\\\ & & \\left[\\frac{1}{\\sin^2\\theta}-\\frac{a^2}{\\delta}\\right ]   \\partial_{\\phi\\phi}\\psi + \\ , 2s \\left[\\frac{a ( r - m)}{\\delta }   + \\frac{i \\cos\\theta}{\\sin^2\\theta}\\right ] \\partial_\\phi\\psi   \\nonumber\\\\ & & - \\left(s^2 \\cot^2\\theta - s \\right ) \\psi = 0   , \\end{aligned}\\ ] ] where @xmath1 is the mass of the black hole , @xmath2 its angular momentum per unit mass , @xmath3 and @xmath4 is the `` spin weight '' of the field .",
    "the @xmath5 versions of these equations describe the radiative degrees of freedom of the gravitational field , and thus are the equations of interest here . as mentioned previously , this equation is an example of linear , hyperbolic , homogeneous pdes which are quite common in several areas of science and engineering , and can be solved numerically using a variety of finite - difference schemes .      ref .",
    "@xcite demonstrated stable numerical evolution of eq .",
    "( [ teuk0 ] ) for @xmath6 using the well - known lax - wendroff numerical evolution scheme .",
    "our teukolsky code uses the exact same approach , therefore the contents of this section are largely a review of the work presented in the relevant literature  @xcite .",
    "our code uses the tortoise coordinate @xmath7 in the radial direction and azimuthal coordinate @xmath8 .",
    "these coordinates are related to the usual boyer - lindquist coordinates by @xmath9 and @xmath10 following ref .",
    "@xcite , we factor out the azimuthal dependence and use the ansatz , @xmath11 defining @xmath12 and @xmath13 allows the teukolsky equation to be rewritten as @xmath14 where @xmath15 is the solution vector .",
    "the subscripts @xmath16 and @xmath17 refer to the real and imaginary parts respectively ( note that the teukolsky function @xmath18 is a complex valued quantity ) .",
    "explicit forms for the matrices , and can be easily found in the relevant literature  @xcite .",
    "rewriting eq .",
    "( [ eq : evln ] ) as @xmath19 where @xmath20 @xmath21 and using the lax - wendroff iterative scheme , we obtain stable evolutions .",
    "each iteration consists of two steps : in the first step , the solution vector between grid points is obtained from @xmath22 \\ ; .\\nonumber\\end{aligned}\\ ] ] this is used to compute the solution vector at the next time step , @xmath23 \\ , .",
    "\\label{lw2}\\ ] ] the angular subscripts are dropped in the above equation for clarity .",
    "all angular derivatives are computed using second - order , centered finite difference expressions .",
    "following ref .",
    "@xcite , we set @xmath24 and @xmath25 to zero on the inner and outer radial boundaries .",
    "symmetries of the spheroidal harmonics are used to determine the angular boundary conditions : for even @xmath26 modes , we have @xmath27 at @xmath28 while @xmath29 at @xmath28 for modes of odd @xmath26 .    as a sample numerical result",
    ", we take initial data corresponding to a narrow gaussian pulse .",
    "this data perturbs the black hole , causing it to ring down according to its characteristic quasi - normal frequencies .",
    "[ qnm ] shows the results , illustrating the quasi - normal ringing for the @xmath30 , @xmath31 mode of a black hole with spin parameter @xmath32 .    ; the @xmath30 , @xmath31 mode is shown here .",
    "the evolution of the real part of the teukolsky function , extracted at @xmath33 , @xmath34 .",
    "[ qnm],width=302 ]",
    "the cbe is a completely new processor , that was developed collaboratively by sony , ibm and toshiba primarily for multimedia applications .",
    "this processor has a general purpose ( powerpc ) cpu , called the ppe ( that can execute two ( 2 ) software threads simultaneously ) and eight ( 8) special - purpose compute engines , called spes only for numerical computation .",
    "each spe can perform vector operations , which implies that it can compute on multiple data , in a single instruction ( simd ) .",
    "all of these compute elements are connected to each other through a high - speed interconnect bus ( eib ) .",
    "a single 3.2 ghz cbe ( original - 2006/2007 ) has a peak performance of over 200 gflop / s in single - precision floating point computation and 15 gflop / s in double - precision .",
    "the current ( 2008 ) release of the cbe , called the _ powerxcell _ , has design improvements that bring the double - precision performance up to 100 gflop / s .",
    "the main programming challenge introduced by this new design , is that one has to explicitly manage the memory transfer between the ppe and the spes .",
    "the ppe and spes are equipped with a dma engine  a mechanism that enables data transfer to and from main memory and each other .",
    "now , the ppe can access main memory directly , but the spes can only directly access their own , rather limited ( 256 kb ) local - store .",
    "this poses a challenge for many applications , including the nr application that we are considering in this article .",
    "however , the compilers in the most recent release ( 3.1 ) of ibm s cell sdk enable a _ software caching _ mechanism that allows for the use of the spe local - store as a conventional cache , thus negating the need of transferring data manually from main memory .",
    "in essence , this mechanism allows one to write spe programs that can access variables stored in the ppe s address space ( ibm refers this to as _ effective address space _ support ) . from our viewpoint , this feature takes away the main challenge associated to programming the cbe , and thus considerably reduces the amount of specialized code development needed .",
    "therefore , we will take this approach in the development of a cbe optimized version of our nr application .",
    "of course , it is worth pointing out that this approach will not allow the processor to perform at full potential ; thus one should not expect to achieve the maximal performance gain that would be possible otherwise .",
    "another important mechanism that allows communication between the the different elements ( ppe , spes ) of the cbe is the use of mailboxes .",
    "these are special purpose registers that can be used for uni - directional communication .",
    "each spe has three ( 3 ) mailboxes  two ( 2 ) outbound , that can hold only a single entry , and one ( 1 ) inbound , that can hold four ( 4 ) entries .",
    "these are typically used for synchronizing the computation across the spes and the ppe , and that is primarily how we made use of these registers as well .",
    "details on our specific use of these various aspects of the cbe for the nr application appear in the next section of this article .",
    "as mentioned in the previous section , our approach towards running code on the cell s spes involves making use of the _ effective address space _ support . in this manner",
    "we avoid the involved programming associated to explicitly managing the data exchange between the ppe and the spes .",
    "therefore , once we have decided upon the portion of the teukolsky code that would be appropriate to run on the spes , the rest would be straightforward .",
    "since the spes are the main compute engines of the cbe , one would want them to execute the most compute intensive tasks of a code in a data- or task- parallel fashion , and leave the rest ( input / output , synchronization , etc . ) to run on the ppe .",
    "we employ a data - parallel model , which is straightforward to implement in a code like ours  we simply perform a domain decomposition of our finite - difference numerical grid and allocate the different parts of the grid to different spes . in particular , we parallelize along the @xmath7 coordinate dimension , because that typically has two orders - of - magnitude more grid points than the other ( @xmath35 ) dimension .    upon performing a basic profiling of our code using the gnu profiler * gprof * , we learn that the computing the `` right - hand - sides '' of the lax - wendroff steps i.e. the quantities within the square - brackets of eqs .",
    "( [ lw1 ] ) and ( [ lw2 ] ) , take nearly _ 75% _ of the application s overall runtime .",
    "thus , it is natural to consider accelerating this `` right - hand - side ''",
    "computation using data - parallelization on the spes .",
    "we anticipate that this observation is fairly typical for codes of this type .",
    "now , to move this computation to the spes , we simply take the corresponding ppe code and copy it into a skeleton spe code and then add in the appropriate declarations for all the field arrays such that they point to the corresponding quantities in the ppe s address space . to be more explicit , lets say that we have a field array quantity * phi * defined in the ppe portion of the code as follows ,    ....",
    "double phi[m][n ] ; ....    where @xmath1 and @xmath36 are the dimensions of the array in the @xmath35 and @xmath7 directions respectively . to point to this exact same array from the spe code , we simply need to declare it as ,    .... extern _ _ ea double phi[m][n ] ; ....    where the * _ _ ea * type qualifier is a ppe address namespace identifier .",
    "that entirely takes care of the complicated matter of transferring the necessary data back - and - forth between the spes and the ppe .",
    "each spe maintains a cache ( size can be controlled at compile time using the * -mcache - size * flag ) in its local - store , wherein it stores a small fraction of the whole array for immediate use ; therefore its functioning is identical to the traditional hardware caches found in all modern processors .",
    "finally , as far as making use of the simd capabilities of the spes are concerned , we simply enable the auto - vectorizing capabilities of the * spu - gcc * compiler , as opposed to performing those optimizations by hand .",
    "the only other issue remaining , is that of synchronizing the ppe and the spes , which is easily done by using mailboxes as mentioned earlier .",
    "recall that the `` right - hand - side '' computation , that we are coding for parallelized execution on the cell s spes takes nearly 75% of the overall runtime of the application .",
    "this means that at best , we can expect an acceleration of a factor of four ( 4 ) in the application s overall runtime ( _ amdahl s law _ ) . in this section",
    ", we compare our cbe accelerated code s performance relative to this maximum achievable gain .",
    "[ perf ] depicts the total application runtime as a function of the number of spes used , for two ( 2 ) different values of the software cache .",
    "one can clearly see that although the performance gain using this approach is highly dependent on the size of the software cache used , the gains are substantial . for the case of the @xmath37 cache size ,",
    "the maximum acceleration of the application is a factor of @xmath38  this translates to _ over 97% of the maximum theoretical gain _",
    "possible through our parallel approach !",
    "another observation that can be made from the @xmath37 cache data plotted in fig .",
    "[ perf ] is that after six ( 6 ) spes are in use , not much is gained by including additional spes .",
    "the reason for this is simply that even with only six ( 6 ) spes in use , the runtime associated to the `` right - hand - side '' computation becomes negligible as a fraction of the application s overall runtime .",
    "thus , including additional spes to further accelerate that computation yields no benefit . if we wanted to accelerate the application even further , we would need to further port some of the other ppe - based computations onto the spes .",
    ", width=340 ]    it is worth pointing out that these tests were performed on an ibm qs21 blade server that is equipped with the original ( 2006/2007 ) cbe  the one with the rather limited double - precision floating - point performance .",
    "all of our codes were run using double - precision floating - point accuracy because that is the common practice in the nr community and also a necessity for finite - difference based evolutions , especially if a large number of time - steps are involved .",
    "on the current _ powerxcell _ processor , the overall performance of our code is likely to be much better .",
    "we demonstrate that it is possible to obtain a significant performance gain ( upto 97% of theoretical maximum ) on a typical finite - difference pde solver by making use of the spes of the cell processor , via a programming model that is relatively very straightforward to implement .",
    "the approach involves the use of _ software caching _ through the recently made available _ effective address space _ support on the cell s spes .    by making use of this approach",
    "many scientific applications may obtain high accelerations on cbe hardware with minimal investment in detailed and specialized coding .",
    "moreover , it is worth noting that we obtain these very strong results from the the original release of the cell processor ",
    "the one found in the sony ps3  therefore , one can obtain these performance gains using such extremely low - cost hardware .",
    "we thank jens brietbart for several helpful suggestions relating to this work .",
    "gk would like to acknowledge support from the national science foundation ( nsf grant numbers : phy-0831631 , phy-0902026 ) .",
    "g. khanna et al . , inspiralling black holes : the close limit _ phys .",
    "lett . _ * 83*:35813584 , 1999 ; l. burko , g. khanna , radiative falloff in the background of rotating black hole , _ phys .",
    "d _ * 67*:081502 , 2003 ; l. burko , g. khanna , universality of massive scalar field late - time tails in black - hole spacetimes , _ phys .",
    "d _ * 70*:044018 , 2004 ; m. strafuss , g. khanna , massive scalar field instability in kerr spacetime , _ phys",
    "d _ * 71*:024034 , 2005 ; l. burko , g. khanna , late - time kerr tails revisited , _ class .",
    "grav . _ * 26*:015014 , 2009 .",
    "s. williams et al .",
    ", scientific computing kernels on the cell processor , _ international journal of parallel programming _ * 35*:263298 , 2007 ; m. christen et al . , accelerating stencil - based computations by increased temporal locality on modern multi- and many - core architectures , 2008 ."
  ],
  "abstract_text": [
    "<S> hardware accelerators ( such as the cell broadband engine ) have recently received a significant amount of attention from the computational science community because they can provide significant gains in the overall performance of many numerical simulations at a low cost . however </S>",
    "<S> , such accelerators usually employ a rather unfamiliar and specialized programming model that often requires advanced knowledge of their hardware design . in this article </S>",
    "<S> , we demonstrate an alternate and simpler approach towards managing the main complexities in the programming of the cell processor , called _ </S>",
    "<S> software caching_. we apply this technique to a numerical relativity application : a time - domain , finite - difference kerr black hole perturbation evolver , and present the performance results . </S>",
    "<S> we obtain gains in the overall performance of generic simulations that are close to the theoretical maximum that can be obtained through our parallelization approach . </S>"
  ]
}