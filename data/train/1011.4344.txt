{
  "article_text": [
    "the accurate computational solution of the many - body schrdinger equation for fermionic systems is an important and only partially solved problem in modern chemistry .",
    "monte - carlo ( mc ) integration provides one of the most powerful methods available to address this problem , and has been implemented in many different ways@xcite .",
    "all methods take a reformulation of the problem in terms of multi - dimensional integrals , such as a variational principle or propagators , and employ mc methods for the evaluation of the integrals involved .",
    "the strength of mc integration is that it provides superior scaling of accuracy with the number of integrand evaluations .",
    "for example , for @xmath0 evaluations of a smooth integrand the mc error scales as @xmath1 independent of the dimensionality of the system ( @xmath2 ) , whereas for order-@xmath3 polynomial interpolation on an evenly sampled grid the error scales as @xmath4 @xcite .    in this paper",
    "we limit ourselves to the variational quantum monte carlo ( vmc ) method .",
    "expectation values for trial wavefunctions are estimated directly , with a trial wavefunction constructed to explicitly include correlation and for which the dimensionality of integrals can not be reduced analytically . typically a trial wavefunction is expressed in terms of a large number of unknown parameters , and a variational principle invoked to provide the ` best ' possible trial wavefunction .",
    "the optimised quantity is estimated using mc .",
    "higher accuracy quantum monte carlo ( qmc ) methods are available , but vmc itself provides a high level of accuracy , is often the starting point of other qmc methods , and other qmc methods include mc integration in a similar manner .    for mc integration",
    "a key choice is the distribution of random samples used to construct the statistical estimate .",
    "such a choice is not unique , and different choices result in different distributions of the random error inherent in the estimate of the integral . for a mc estimate to be _ useful _",
    "the underlying distribution from which it is drawn must be known both in form and scale via the limit theorems of probability theory .",
    "this is not always possible . within vmc",
    "the characterisation of random errors is further complicated by the physical quantities being quotients of estimated integrals .    in light of this the main body of this paper",
    "is concerned with characterising the statistical properties of estimates that arise from different choice of sampling strategy , and falls into three main sections .",
    "we start by considering estimates of expectation values only , with no optimisation of parameters , and for general sampling . a large class of distributions of random error",
    "are shown to arise , the most desirable being the normal distribution that occurs where the central limit theorem ( clt ) is valid in its bivariate form .",
    "conditions are provided for when this occurs , and estimates are provided for the mean and variance of this normal distribution . requiring a normal random error still allows a wide range of sampling distribution , and alternatives to the usual method used in the vmc literature ( referred to here as ` standard sampling ' ) are discussed .",
    "an optimum sampling distribution is derived that provides a lower bound to the random error possible for a given sample size , and a benchmark for assessing the effectiveness of other sampling strategies .",
    "an efficient sampling distribution is constructed with the aim of significantly reducing the computational resources required to achieve a given random error . for both optimum and efficient sampling errors",
    "are normal .",
    "next we address the issue of trial wavefunction optimisation .",
    "a number of methods exist for achieving an iterative improvement of an initial wavefunction within vmc , which may be interpreted as seeking the minimum ( or zero ) of a multivariate function that is random in the sense that it is drawn from an ensemble of possible random functions .",
    "the methods used to find the optimum of a sample function are of secondary importance , and we focus on the distribution of the position of the minimum of the random function , itself a random variable .",
    "this viewpoint naturally divides the optimisation process into taking a sample random function and numerically optimising to some level of accuracy ( a ` cycle ' of optimisation ) , then taking a new sample random function and optimising again ( repeated ` cycles ' of optimisation ) .",
    "we discuss the distributions of random error in the sample optimum trial wavefunction , how much information limit theorems provide , and the performance of different sampling strategies .",
    "finally , the efficient sampling strategy is used for the optimisation and estimation of the electronic energies of first row isolated atoms and molecules , with the systems chosen for comparison with previously published _",
    "ab initio _ results and accurate approximations for the exact energies .",
    "our aim is to demonstrate the quality of results that can be obtained using new sampling strategies in vmc , complicated trial wavefunctions , and modest computational resources .",
    "sans - serif is used for random variables such as @xmath5 , with a sample value denoted as @xmath6 .",
    "the expectation of a random variable is denoted @xmath7 $ ] , and a random estimates of some quantity @xmath8 ( usually an integral or a quotient of two integrals ) is denoted @xmath9 , and is a sample value of some random variable @xmath10 .",
    "the integration variable of a probability density function ( pdf ) is usually left implicit , but where it is explicit we use @xmath11 , @xmath8 or @xmath12 for scalar , and @xmath13 for vector arguments .",
    "atomic units are used throughout , unless otherwise indicated .",
    "we begin with the expectation value of the total energy , @xmath14 , of an @xmath15 electron system ( a generalisation to different operators and particles in straightforward ) . for a given hamiltonian and trial wavefunction , @xmath16 and @xmath17 ,",
    "this takes the form @xmath18 d\\mathbf{r } /           \\int \\psi^2            d\\mathbf{r } , \\ ] ] where the local energy is defined as @xmath19 = \\psi^{-1 } \\hat{h } \\psi$ ] , and @xmath13 is the @xmath20 dimensional vector composed of the positions of all electrons .    a general sampling approach to vmc",
    "consists of defining a random position vector @xmath21 characterised by some distribution and drawing @xmath0 independent samples of this random variable . writing the distribution as @xmath22 is convenient in what follows , with @xmath23",
    "a general ( positive ) weight function defined in the @xmath20 dimensional space of the integrals .",
    "the normalisation prefactor , @xmath24 , is not required to generate samples using the metropolis algorithm@xcite , and is included in order to clarify that expressions for estimates are invariate with respect to it .",
    "note that it is unrelated to the physical normalisation of the trial wavefunction unless @xmath25 .    estimating both integrals using mc provides an estimates of the total energy as @xmath26 but for this estimate to be useful its distribution must be known .",
    "since this quantity is the quotient of two sample means the clt is not directly applicable .",
    "the sample weights in this equation may be renormalised such that their sum is equal to the number of samples by introducing a new weight , @xmath27 , so reducing the number of random variables by a factor of two and reducing eq .",
    "( [ eq:1 ] ) to the sample mean @xmath28 unfortunately a price is payed for this apparent simplification of the problem . in order for the clt to be valid ( at least in its simplest form )",
    "it is necessary for the samples to be independent and identically distributed . for the reformulation given above neither of these conditions are satisfied since each sample value of @xmath29 is composed of the all of the original samples , @xmath30 .",
    "although a sample mean and sample standard error exist the clt does not relate these to the mean and variance of a normal distribution , or ensure that the distribution is normal .",
    "a more successful approach is to consider the estimate explicitly as a quotient of two sums , hence maintaining the independence and identical distribution of the random variables sampled in each sum , and including the parametric relationship between each sample @xmath31 and @xmath23 .",
    "we begin by obtaining the co - distribution of the numerator and denominator of eq .",
    "( [ eq:1 ] ) , so include all correlation between them .",
    "the bivariate clt informs us that in the large sample size limit @xmath32 is a sample drawn from a bivariate normal distribution@xcite with pdf @xmath33 characterised by a mean , @xmath34 , @xmath35 ,   \\mathbb{e}\\left [   w     \\right ] \\right),\\end{aligned}\\ ] ] a covariance matrix , @xmath36 , with elements @xmath37           , & c_{12}=c_{21}=\\text{cov}\\left [ we_l , w \\right ] , & c_{11}=\\text{var}\\left [ w     \\right ]           ,   \\end{aligned}\\ ] ] and @xmath38 although the elements of each sample @xmath39 are causally related to each other , the only aspect of this that survives in the large sample size limit is the partial linear correlation characterised by @xmath40 .    from this bivariate normal distribution the distribution of the quotient of sums can be expressed using the standard formulae@xcite @xmath41 which , in the large sample size limit , reduces to @xmath42 } \\end{aligned}\\ ] ] for general @xmath43 .",
    "since the weights are necessarily positive , @xmath44 and the large sample size limit further reduces to @xmath45 } , \\ ] ] a normal distribution with mean @xmath46 and variance @xmath47 \\nonumber \\\\              & = & \\frac{1}{r }                  \\frac {    \\int \\psi^2/w d\\mathbf{r }    \\int w \\psi^2 ( e_l - e_{tot})^2 d\\mathbf{r }    }                       {    \\left [ \\int \\psi^2 d\\mathbf{r } \\right]^2   } .",
    "\\label{eq:3}\\end{aligned}\\ ] ]    replacing the means by their unbiased estimates provides the total energy estimate @xmath48 as a sample drawn from a normal distribution with a mean equal to the exact total energy expectation value .",
    "the variance is defined by eq .",
    "( [ eq:3 ] ) , and introducing standard unbiased estimates for the means and covariance matrix elements gives the standard error estimate as @xmath49 the usual interpretation of the accuracy of the estimates in terms of confidence limits and standard errors then follows directly , provided we use these two formulae .",
    "we finish with some comments on the properties and limitations of these estimates .",
    "the estimates can not be derived using the univariate clt , and the standard error is not a sample variance divided by a sample size . for @xmath50 to be a valid pdf it is necessary for @xmath51 to be positive and normalisable . for the bivariate clt to be valid the integral definitions of the mean vector and covariance matrix",
    "must exist , which can not be shown numerically - the situation is analogous to the assumptions of smoothness that are required to provide error limits for numerical integration on a grid .",
    "perhaps most importantly , for an exact trial wavefunction @xmath52 for any number of samples and for any choice of sampling distribution , hence generalised sampling possesses the ` zero variance ' property in that there is no statistical error in the total energy estimate of an eigenfunction of the hamiltonian .",
    "the above equations inform us that estimated expectation values are normal provided that the covariance exists . in the rest of this paper",
    "we repeatedly seek estimates for which this is the case , hence here we summarise why this is desirable and what replaces the normal distribution when the covariance is not defined .",
    "the _ generalised _",
    "clt@xcite states that , in the large @xmath0 limit , the average of independent and identically distributed random variables drawn from a distribution @xmath53 possesses either a normal distribution or a stable distribution .",
    "( throughout this paper we refer to a normal distribution as distinct from a stable distribution .",
    "this is for brevity , and stable distributions are often defined to include the normal distribution as a special case . ) which of these arises depends on the properties of @xmath53 .",
    "for tails of @xmath53 decaying faster than @xmath54 the strongly localised normal distribution occurs which is characterised by a mean and variance that can be estimated . for tails of @xmath53 decaying slower than @xmath54",
    "a weakly localised stable distributions occurs which is characterised by 4 parameters which can not all be estimated . for the normal distribution",
    "the pdf is gaussian and the width of the distribution scales as @xmath55 , whereas for stable distributions the pdf asymptotically approaches a power law and its width scales slower than @xmath55 , is constant , or increases with @xmath0 depending on the tails of @xmath53 .",
    "the stable case is undesirable for two reasons .",
    "estimates are not available for the parameters of the distribution , hence characterising the error via confidence intervals is not straightforward .",
    "furthermore , even if parameters could be estimated , the presence of power law tails causes the size of the confidence interval to increase with the level of confidence considerably faster than the clt case .",
    "an example of this is shown in figure  [ fig0 ] .",
    "the probability that a sample falls outside of a centred region is shown as a function of the size of the region , for a normal distribution and for a stable distribution .",
    "the normal distribution is chosen to have a mean and variance of zero and unity .",
    "the stable distribution shown is symmetric , has @xmath56 tails , has a mean that exists and is equal to zero , and has a ` scale ' parameter ( the analogue of the variance for the normal case ) chosen to be unity .",
    "there is no relationship between the variance and ` scale ' of the two distributions , and they are chosen to be equal in this figure for convenience only .",
    "such a probability asymptotically approaches @xmath57 for the normal case , with outliers remaining persistent for the stable distribution due to the @xmath58 asymptote .",
    "where an estimate is composed of a quotient of sample averages and covariances are not defined a similar situation arises ; a bivariate generalised clt is required , a bivariate stable distribution results@xcite , power law tails arise and estimates of error bars are unavailable .",
    "probability that a sample falls outside of a centralised interval of size @xmath59 for @xmath60 , a normal distribution , and for an example stable distribution , @xmath61@xcite that is symmetric with @xmath62 power law tails and mean @xmath63 ( the mean exists for this stable distribution ) .",
    "this form of stable distribution is typical of the distributions that occur for an invalid clt in standard sampling qmc . ]",
    "the notion of using a sampling distribution such that total energy estimates require weighted averages is inherently part of the re - weighted sampling of optimisation , diffusion monte carlo ( dmc ) , and other qmc methods , but is usually analysed by incorrectly applying the univariate clt to numerically renormalised samples .",
    "explicit generalised sampling in vmc has been used by a few authors@xcite , and coldwell first presented a formula for the variance estimate that differs from eq .",
    "( [ eq:5 ] ) only in that it does not include the prefactor that corrects for bias in the estimated covariance matrix .",
    "similarly , assaraf _ _ et al.__@xcite employ the same expression in the context of dmc , again without the correction prefactor .",
    "the new results provided here are a proof that eq .",
    "( [ eq:4 ] ) is an estimate that is normally distributed provided that the covariance matrix exists , and that if this is so the mean of the distribution is the total energy and eq .",
    "( [ eq:5 ] ) estimates the variance with the appropriate bias correction .",
    "note that requiring the covariance to exist refers to the integral definition , not to sample estimates since the later are always finite .",
    "next we consider particular choices of sampling distribution , @xmath50 .",
    "choosing @xmath25 over all space corresponds to the usual implementation of vmc , sampling the co - ordinate space as @xmath64 which gives the estimate @xmath65 with standard error @xmath66 perhaps the greatest advantage of this choice is the simple algebraic form of the estimates , and that they may be derived using the univariate clt only .",
    "however , the previous consideration of generalised sampling suggests that lower random errors may be possible for other sampling distributions , and that similar random errors may occur for other sampling distributions .",
    "the standard sampling choice also has some further deficiencies , as discussed in a previous paper@xcite , due to the necessary existence of a @xmath67 dimensional nodal hyper - surface where @xmath17 is zero .",
    "such zeroes are usually accompanied by singularities in the sampled local energy on these surfaces ( this is not necessarily the case , indeed is not the case for an exact wavefunction , but is usually unavoidable ) , and the analogous ` local ' quantities averaged to estimate expectation values for other operators .",
    "such singularities are purely an artifact of zeroes in @xmath68 , and cause the distribution of estimates for many physical quantities to be a stable distribution with power law tails . for standard sampling the total energy estimate is somewhat unusual in that clt is valid@xcite . for most other quantities , such as the derivatives used for forces and in wavefunction optimisation ,",
    "this is not so .      for a given trial wavefunction and hamiltonian ,",
    "the random error depends on sample size and the sample distribution characterised by the weight function @xmath23 .",
    "the random error for a given system and number of samples must be greater than or equal to zero , hence a weight function must exist that supplies the smallest possible random error in an estimate .",
    "so , the general standard error defined by eq .",
    "( [ eq:3 ] ) should possess minimum with respect to variations in the weight .",
    "seeking @xmath69 / \\delta w=0 $ ] , gives @xmath70 whose solution ( excluding @xmath71 ) gives the optimum sampling distribution , @xmath72 which is consistent with the optimal sampling distribution for estimating the energy differences between two systems provided by ceperley _",
    "_ et al.__@xcite .",
    "equation  ( [ eq:6 ] ) provides a lower bound to the achievable accuracy in that @xmath73 for all sampling strategies , with @xmath74 a scaled mean - absolute deviation of the local energy .",
    "this is related to the more familiar standard error of standard sampling , @xmath75^{1/2},\\end{aligned}\\ ] ] by @xmath76 ( from jensen s inequality ) .",
    "estimates are readily available for both of these integrals .",
    "this lower limit is analytically correct , but does not provide a satisfactory distribution for the implementation of optimum sampling . for the weight defined in eq .",
    "( [ eq:6 ] ) the covariance matrix is undefined unless @xmath77 for any @xmath13 , a special condition that we can not reasonably expect to be generally satisfied .",
    "consequently the bivariate clt will not be valid for most systems .",
    "@xcite    even worse , evaluating the pdf requires the exact @xmath14 , which is generally not available as it is the quantity whose value is sought by the mc calculation .",
    "a natural approximation is to replace the exact @xmath14 with some previous non - exact estimate .",
    "unfortunately this worsens the statistics considerably , resulting in an ` estimate ' that does not statistically converge to a constant with increasing sample size .",
    "an improved definition of optimum sampling is required .",
    "we take a self consistent approach in order to allow @xmath14 to be unknown , and postpone the large sample size limit as late as possible in the derivation in order to ensure that the covariance matrix exists .",
    "fiellers s theorem@xcite provides a convenient reformulation of the distribution of a quotient of bivariate normal random variables in terms of the confidence intervals , @xmath78 .",
    "these intervals are defined by the concise expression @xmath79 for confidence @xmath80 , for example @xmath81 provides the @xmath82 confidence interval .",
    "as long as @xmath83 such a description is entirely equivalent to the normal distribution specified by eqs .",
    "( [ eq:2],[eq:3 ] ) since in the large @xmath0 limit it defines the interval @xmath84 for confidence @xmath80 .",
    "minimising the size of the confidence interval @xmath85 using @xmath86 provides @xmath87 solving the large @xmath0 limit of this equation reproduces eq .",
    "( [ eq:6 ] ) , but instead we approximate this equation by introducing an _ a priori _ total energy estimate and error that are constant with respect to @xmath0 , that is replace @xmath88 with a @xmath89 .",
    "the large @xmath0 limit then gives @xmath90 and solving for @xmath23 gives @xmath91^{1/2}. \\label{eq:7}\\end{aligned}\\ ] ] this distribution is optimum in the sense that it is the solution of the best available approximation to the equation that defines optimum sampling .    in principle",
    "the estimates could be calculated iteratively by supplying @xmath88 from one calculation as @xmath89 for the next , and proceeding to convergence .",
    "since @xmath89 would not converge to the exact estimate , the covariance matrix remains defined and the bivariate clt is valid . in practical application",
    "we go no further than the first iteration , using relatively inaccurate total energies such as those provided by an optimisation process .",
    "a poor value of @xmath89 does not bias the total energy estimate , which converges to the true value as long as @xmath92 .",
    "similarly , accurate values for @xmath93 are not necessary as long as this is reflected in the accompanying error , @xmath94 , in that for large @xmath94 this sampling strategy becomes equivalent to standard sampling .",
    "however , it should be borne in mind that the random error can be greater than that for standard sampling if @xmath94 underestimates the accuracy of @xmath93 .",
    "as an aside , we note that it is possible to construct a sampling distribution that provides a better value of the total energy than this optimum sampling strategy , but such sampling strategies are not mc estimates .",
    "for example , a @xmath50 for which all the probability is located on the hyper - surface @xmath95 is such a distribution , but neither the mean or the co - variance matrix are defined and the ` estimate ' is entirely made up of bias .",
    "hence the algorithm simply returns the value of @xmath14 supplied at the start .",
    "although the optimum strategy described above does requires some estimate of the total energy ( and indeed its error ) this does not skew the distribution or introduce a systematic bias .",
    "sampling as eq .",
    "( [ eq:7 ] ) is referred to as optimum sampling in what follows , as it provides the best available approximation to the lowest possible random error for a given sample size .",
    "optimum sampling provides a useful lower limit to the statistical error achievable for a given system , and in practise it is possible to get very close to this limit using relatively inaccurate estimates of @xmath89 .",
    "however , optimum sampling will not necessarily be efficient as no account has been taken of the computational cost of generating each of the samples , and we seek a further sampling strategy for which the statistical error available for a given computational cost is low .    for vmc ,",
    "the algorithm usually used to draw samples from a distribution is the generation of a markov chain via the metropolis algorithm .",
    "this is well documented in the literature@xcite and can provide an ordered list of sample vectors drawn from a list of correlated random vectors each distributed as @xmath50 , and for which the degree of correlation between pairs in the list falls exponentially as they become more separate . disregarding enough of these samples results in a new list",
    "for which correlation is negligible , providing ( effectively ) independent and identically distributed random vectors .",
    "this is the set @xmath96 used to construct mc estimates .",
    "consequently , the computational cost of generating a vmc estimate is composed of evaluating @xmath50 at @xmath97 accept / reject steps and evaluating @xmath98 at @xmath0 of these steps .",
    "the total computational cost is @xmath99 where @xmath100 is the computational cost of evaluating @xmath50 , and @xmath101 is the computational cost of evaluating the local energy , suggesting that the available accuracy may be improved by reducing @xmath100 and increasing the total number of samples , @xmath0 @xcite .",
    "our goal is to seek an ` efficient ' sampling strategy for which the pdf is computationally cheap to evaluate , for which the bivariate clt is valid , and for which the standard error for a given number of samples is low . as a pragmatic measure of success we use the statistical accuracy achievable for a fixed computational budget .",
    "a simple , but not generally successful , approach is to approximate standard sampling by choosing a single slater determinant @xmath102 ( such as a hartree fock ( hf ) slater determinant ) and to sample using @xmath103 for the associated estimates to be useful the bivariate clt must be valid , and appendix [ sec : appa ] describes the analysis used to ascertain whether this is so , essentially a more general form of that described in ref .",
    "to summarise , both of @xmath39 possess a singularity at the nodal surface of @xmath104 that cause the covariance of @xmath39 to be undefined .",
    "consequently , each sample mean is itself a sample drawn from a stable distribution with a mean , with @xmath62 power law tails , and with no variance .",
    "although an estimate constructed using eq .",
    "( [ eq:4 ] ) is computationally cheap and does converge to the total energy expectation value in the large sample size limit , no information is available about the distribution of errors .",
    "an important exception occurs if the nodal surfaces of @xmath17 and @xmath104 coincide , for which the bivariate clt is valid , the total energy estimate is normal , and the standard error can be estimated .    in light of this",
    "we seek a sample distribution that does not possess a nodal surface , yet shares many of the properties of the trial wavefunction and is arithmetically simple in comparison with both standard sampling and optimum sampling .",
    "this is not enough to uniquely define a sampling distribution , and we propose the form @xmath105 , \\label{eq:8}\\end{aligned}\\ ] ] where @xmath106 and @xmath107 are slater determinants ( or configuration state functions ) with different nodal surfaces .",
    "a source of such determinants might be the dominant components of a multi - determinant wavefunction , or a ground and excited state supplied by hf .",
    "the distribution of eq .",
    "( [ eq:8 ] ) has the desirable qualities that it is computationally cheap to evaluate relative to many of the trial wavefunctions used in qmc , is not zero on any @xmath67 dimensional nodal surface , is zero on the @xmath108 dimensional coalescence hyper - planes , and it reproduces exponential tails for electrons in bound systems",
    ". a physical interpretation of this expression would be somewhat tenuous , and not particularly useful , and it should be considered solely as a compromise between analytic properties and ease of calculation .",
    "the analysis of appendix [ sec : appa ] informs us that no singularities are present in either of @xmath39 , power law tails do not arise , and both the mean vector and covariance matrix exists .",
    "consequently , this distribution provides a total energy estimate that is normally distributed and whose variance can be estimated .",
    "sampling using eq .",
    "( [ eq:8 ] ) is referred to as efficient sampling in what follows .    to compare the performance of efficient , standard , optimum and sd sampling total energy estimates",
    "were calculated for an isolated all - electron carbon atom in the @xmath109 non - relativistic ground state .",
    "a version of the casino@xcite package was used , with modifications introduced to enable generalised sampling . of the variety of trial wavefunctions available for use in qmc",
    "we employ the form @xmath110 that is made up of a multi - determinant expansion , jastrow prefactor , and backflow transformation , hence allows variation of the nodal surface .",
    "the jastrow factor , @xmath111 includes electron - electron , electron - ion , and electron - electron - ion terms ( see ref .",
    "backflow is included via the non - linear transformation @xmath112 made up of electron - electron , electron - ion , and electron - electron - ion terms ( see ref .",
    "configuration state functions ( csfs ) for the multi - determinant expansion , @xmath113 , are obtained from the multi - configurational hartree - fock ( mchf ) atomic - structure package atsp2k@xcite , and are made up of numerical orbitals and a reduced active space that includes csfs in order of increasing weight .",
    "to summarise , the jastrow factor is characterised by @xmath114 parameters , backflow is characterised by @xmath115 parameters , and the @xmath116 determinant expansion of @xmath117 csfs is characterised by @xmath118 parameters .",
    "this trial wavefunction is of essentially the same form as ref .",
    "@xcite , but with the number of parameters systematically increased .",
    "samples were taken from the metropolis random walk every @xmath119 steps , a value chosen as the lowest power of @xmath120 for which correlation was statistically undetectable .",
    "values for wavefunction parameters were obtained using optimisation as described in the next section .",
    "we ask the reader to bear with this somewhat inverted order , since a valid sampling strategy for estimates is a necessary prerequisite for optimisation even though in application optimisation must be performed first .",
    "evolution of total energy estimates with computational time .",
    "figure ( a ) shows the evolution of confidence intervals for efficient , standard and optimum sampling .",
    "no confidence interval is available for sd sampling , and only the estimated value is shown .",
    "an arbitrary constant offset has been added for each sampling strategy to aid clarity .",
    "figure ( b ) shows the evolution of standard errors for efficient , standard and optimum sampling . for sd sampling",
    "the quantity shown arises from evaluating the standard error estimate when it is incorrect to do so , and is unrelated to confidence intervals . ]    for a fixed sample size there is a modest variation in the standard error ( eq .  ( [ eq:5 ] ) ) .",
    "when compared with standard sampling , efficient sampling increases the error by @xmath121 , optimum sampling reduces the error by @xmath122 , and sd sampling provides no standard error .",
    "however , computational cost does vary significantly .",
    "figure  [ fig1]a shows the evolution of total energy estimates with computational time .",
    "the standard error for a given computational cost is lowest for efficient sampling , and greatest for optimum sampling , with no confidence interval available for sd sampling ( only the estimate is shown ) .",
    "the sd sampling estimate does appear to approach a constant value , but this is likely to be illusory since estimates for different sample sizes are strongly correlated .",
    "figure  [ fig1]b shows the evolution of the estimated error with computational time for all four sampling strategies , with errors obtained from eq .  ( [ eq:5 ] ) .",
    "efficient , standard and optimum sampling show a consistent @xmath123 evolution with a large variation in the prefactor between different sampling strategies .",
    "for sd sampling the result of an incorrect application of eq .",
    "( [ eq:5 ] ) shows no consistent power law behaviour with sporadic discontinuous jumps introduced by outliers , and although confidence intervals do exist for the underlying distribution they are not related to the quantity shown in the figure .",
    "sample sizes and estimates obtained by allocating a fixed computational resource to each sampling strategy are given in table  [ tab:1 ] .",
    "compared to standard sampling , efficient sampling increases the number of samples by @xmath124 , reducing the error by @xmath125 , whereas optimum sampling decreases the number of samples by @xmath126 , increasing the error by @xmath127 .    .",
    "[ tab:1 ] total energy estimates for fixed computational time and optimum , standard , efficient and sd sampling .",
    "no standard error is available for sd sampling and the number of significant figures is unrelated to random error .",
    "[ cols= \" < , > , < \" , ]     table  [ tab:3 ] shows the resulting total energy estimates . for comparison of these results with other methods we focus on the variation in the fraction of total correlation energy recovered for each system , taking rhf energies from numerical calculations using atsp2k and 2dhf , and approximate exact total energies from the sources specified in the table .",
    "the lowest variational total energy estimates for first row isolated atom in the literature appears to be those of brown _ et al .",
    "they employ standard sampling , linear optimisation , and trial wavefunction of the same form as eq .",
    "( [ eq : wf ] ) but with less variational freedom , mostly due to a smaller multi - determinant expansion .",
    "our vmc results consistently fall between the vmc and dmc estimates of this paper , are consistently closer to dmc than vmc estimates of this paper , and provide a small but significant recovery of between 0.1% and 1.5% more correlation energy at vmc level .",
    "toulouse and umrigar@xcite also provide isolated atom energies using both vmc and dmc , based on linear optimisation of trial wavefunction using standard sampling .",
    "their trial wavefunctions were composed of rhf or mcscf orbitals represented using a slater basis set , with orbital relaxation , a jastrow factor , and 1 or 2 csfs .",
    "our vmc energies consistently improve on the estimates in this paper , providing between 0.3% and 12.5% more correlation energy than the vmc estimates , and between 0.0% and 5.6% more correlation than dmc estimates .",
    "the improvement is entirely consistent with the contribution to correlation provided by backflow and multi - determinant expansions discussed in ref .",
    "@xcite .",
    "toulouse and umrigar@xcite also provide vmc and dmc total energies for the first row homonuclear diatomic molecules , with trial wavefunctions constructed in the same manner as the isolated atoms but allowing larger multi - determinant expansions for some of the molecules .",
    "the difference between results is not as consistent as for the isolated atoms .",
    "our vmc results recover between 6.7% less and 5.4% more correlation energy , with a consistent inprovement as electron number is increased and the crossover occuring between b@xmath128 and c@xmath128 .",
    "the same trend occurs when comparing with dmc results , with our vmc energies higher than the dmc results of ref .",
    "@xcite for all molecules except ne@xmath128 .",
    "this is consistent with the isolated atom behaviour and the observation that our multi - determinant expansion is inferior in that it is not obtained from a self - consistent calculation .",
    "this reduction in correlation energy is apparent for the small systems only , with the contribution to correlation energy provided by backflow becoming dominant as electron number increases .",
    "curtiss _ _ et al.__@xcite provide total energies for a large set of molecules arrived at using the gaussian-4 ( g4 ) theory , a state - of - the - art perturbation method .",
    "these provide a useful context for the vmc results presented here , provided we bear in mind that the comparison is less clear cut since g4 errors may be positive or negative due to it being a non - variational method . of the 26 vmc results in this paper",
    "g4 total energies are available for 23 . of these",
    ", our vmc total energies are below ( above ) those of g4 for 17 ( 6 ) of the systems , with the vmc recovering between 25.8% more and 4% less correlation energy than the g4 results .",
    "the isolated atom energies are consistently lower for vmc , but beyond this very little consistent behaviour is evident beyond the general observation that vmc energies are lower more often than not , and where the vmc energy is greater than g4 the difference is small .",
    "finally , we compare the correlation recovered by vmc between the systems considered .",
    "perhaps the most striking feature is the superior performance for isolated atoms when compared with the diatomic molecules .",
    "this can partly be ascribed to the superior determinants used for the isolated atoms when compared with diatomic molecules ( the latter are made up of fewer determinant and are not self - consistent at the multi - determinant level ) , but it seems unlikely that this is enough when we consider the wide variation in the amount of correlation recovered .",
    "a rough observation is that correlation is most effectively described for those systems where the electronic behaviour around a nucleus is most similar to an isolated atom or ion , for example for the ionic hydrides such as lih , or the very weakly bonded molecules such as ne@xmath128 .",
    "this suggests the possibility that ` missing correlation ' may well be due to jastrow and backflow being limited to radial functions , and that it may be useful to replace these with functions that allow more geometric freedom .",
    "this must inevitably involve introducing more parameters , but the combination of efficient sampling , linear optimisation , and parameter averaging employed here appears to be able to handle large parameter sets reliably and efficiently .",
    "fermionic variational quantum monte carlo is almost always implemented by drawing sample values of particle co - ordinates from the distribution @xmath129 , where @xmath17 is the trial wavefunction whose expectation values are sought - the ` standard sampling ' of this paper .",
    "we have shown that this is an _ ad hoc _ choice , that the only special property of this choice is the simplicity of the resulting expressions for estimates , and that it has some undesirable properties .",
    "an analysis of vmc using a general sampling distribution is described .",
    "we provide the conditions that must be satisfied for the resulting vmc estimates to be normally distributed , conditions that are easily violated by sample distributions that unnecessary possesses a nodal surface . for the case where these conditions are satisfied , general estimates",
    "are derived for the parameters of the underlying normal distribution , so providing estimates , confidence limits , and error bars .",
    "when the conditions are not satisfied , the underlying distributions are shown to be of a known but undesirable form that are heavy tailed and that are not characterised by a mean and variance .",
    "obtaining estimates of the parameters of such distributions is considerably more difficult than the normal case , and even if such estimates were available the use of error - bars is less informative than the normal case .",
    "this analysis is extended to vmc optimisation in a less rigorous manner to provide similar conditions that must be satisfied in order that the random fluctuation in optimised parameters is normal , and that the error in a total energy due to the randomness of these parameters possess a mean and variance . applying these conditions to the special case of standard sampling",
    "informs us that although vmc total energy estimates for fixed parameters are normally distributed , almost all of the quantities that appear in optimisation are not .",
    "two new sampling strategies are presented , both of which ensure a normal random error wherever possible .",
    "optimum sampling is obtained by deriving the sample distribution for which the normal random error is a small as possible for a given sample size .",
    "this naturally provides a lower limit to the random error possible for a given system , and an accurate approximation to this distribution is derived .",
    "efficient sampling is designed by attempting to avoid a large part of the the computational cost of providing samples using the metropolis algorithm .",
    "the resulting sample distribution function is computationally cheap to evaluate , has the correct properties for estimates and optimisation functions to be normally distributed , and does not perform significantly worse than standard or optimum sampling for a given samples size .    of the two , efficient",
    "sampling provides the most useful improvement over standard sampling by increasing the number of samples possible for a fixed computational resource by an order of magnitude and significantly decreasing the available random error .",
    "in addition , the analysis of optimum and efficient sampling suggests improved statistical properties for optimisation when compared to standard sampling .",
    "however , no convincing numerical evidence that this is the case for real systems was obtained , mainly due to the greater computational cost of standard sampling , the small random error in optimisation compared to estimation , and that any rigorous test would require a statistically significant number of optimisation calculations to be compared . perhaps the most useful results provided by this analysis is a theoretical justification for averaging sets of optimised parameters in order to reduce the optimisation random error .",
    "variational quantum monte carlo using efficient sampling and optimisation was applied to evaluate the electronic total energy for 26 isolated atoms and molecules , using trial wavefunction with a great deal of variational freedom and a fixed and modest computational budget divided equally amongst calculations . at vmc level",
    "more than 97% of correlation energy was recovered for first row isolated atoms , and more than 90% for a small set of diatomic molecules , results that significantly improve on many previously published vmc results and approaching dmc for some systems .",
    "as systems increase in size the efficient sampling strategy is likely to become less advantageous , but this has not occurred for the systems considered so far .",
    "when this does occur it should be possible to employ further sampling distributions that perform better for these systems such as optimum sampling , or the distribution used by attaccalite and sorella@xcite for a dense extended system .",
    "the authors thank r.j .",
    "needs of the university of cambridge for many useful discussions .",
    "financial support was provided by special coordination funds for promoting science and technology , `` promotion of environmental improvement to enhance young researchers independence , and make use of their abilities '' ( `` development of personnel system for young researchers in nanotechnology and materials science '' ( japan advanced institute of science and technology ) ) and by a grant  in ",
    "aid for scientific research in priority areas `` development of new quantum simulators and quantum design ( no . 17064016 ) '' ( japanese ministry of education , culture , sports , science , and technology ; kakenhi - mext ) .",
    "throughout this paper it is repeatedly stated that in order to characterise the form of the distribution of an estimate all that is required is a knowledge of the behaviour of a sample and its distribution in the region of the nodal surface of the trial wavefunction .",
    "this appendix describes how this is done , and is a summary and generalisation of the method applied to the standard case in a previous publication@xcite .",
    "a mc estimate is constructed by drawing @xmath0 samples from a distribution in @xmath20 dimensional co - ordinate space , @xmath130 , evaluating a functional at each of these samples , @xmath131 , and then taking a sample mean , that is the integral @xmath132 is estimated as a sample value of the random variable @xmath5 given by @xmath133 it is necessary for the central limit theorem to be valid in order to know the distribution of @xmath5 and to characterise the random error in terms of a confidence intervals for a particular value of the estimate .",
    "a valid clt requires the first and second moments of @xmath134 to exist , where @xmath135 is a random variable whose distribution is critically dependant on the presence of singularities in the function @xmath136 .",
    "the distribution of @xmath135 can be obtained from that of @xmath137 using the standard formulae @xmath138 where the integral is taken over all surfaces of constant @xmath139 . here",
    "we consider the case where @xmath140 and @xmath130 possess singularities and/or zeroes on a @xmath67 dimensional hyper - surface , the particular case that repeatedly occurs within qmc due to the existence of the nodal surface in fermionic wavefunctions .",
    "introducing a general curvilinear co - ordinate system in terms of surfaces of constant @xmath140 provides a new co - ordinate system @xmath141 , with @xmath142 a scalar set to zero on the @xmath67 dimensional hyper - surface of interest and @xmath143 an implicit @xmath67 vector contained in the hyperplane tangential to the constant @xmath140 surface at @xmath13 .",
    "expanding the distribution about the hyper - surface of interest ( usually the nodal surface of some trial wavefunction ) in this new co - ordinate system gives @xmath144\\ ] ] and analogously @xmath140 becomes @xmath145\\ ] ] with @xmath146 characterising the zeros and singularities of @xmath53 and @xmath140 .    in terms of @xmath141 the distribution of @xmath11 is given by @xmath147 so in the limit @xmath148 @xmath149 and in the limit @xmath150 @xmath151 the existence of positive and/or negative tails , and their possible equality , is entirely decided by the continuity of @xmath130 at the hyper - surface of interest , and the symmetry of the singularity in @xmath140 .",
    "an example of this analysis arises for the total energy estimate via standard sampling , for which @xmath152 , hence @xmath53 possesses asymptotic tails that decay as @xmath153 , and the clt is valid for the estimate since the second moment exists .    for the generalised sampling",
    "a normally distributed estimate requires a valid bivariate clt , and this is decided by the existence of the covariance matrix .",
    "the random estimate is @xmath154 with each @xmath155 and @xmath156 independent and identically distributed , with variables in the two sets independent for @xmath157 , co - distributed as @xmath158 for @xmath159 .",
    "the validity of the bivariate clt requires the covariance matrix of @xmath158 to exist , and since this matrix is positive definite we only require all diagonal matrix elements to exist - the variance of both @xmath160 and @xmath161 .",
    "consequently , we need only consider the distribution of each random variable independently of the other , given by eq .",
    "( [ eq : b1 ] ) for @xmath161 and the equivalent expression for @xmath160 , and the univariate analysis given above can be applied .",
    "note that @xmath160 and @xmath161 are parametrically related to each other ( via the underlying random spatial variable ) so @xmath158 is non - zero only on a line in two dimensional space , but this does not prevent the existence of the covariance matrix or the continuity of @xmath162 as long as more than @xmath163 sample appears in each sum .    an example arises for optimisation with standard sampling , for which @xmath164 for both of @xmath165 as soon as the nodal surface moves away from its starting position .",
    "so , @xmath158 possesses positive asymptotic tails that decay as @xmath166 and @xmath167 for @xmath165 , neither of the variances are defined , the covariance matrix is not defined , and the estimate @xmath168 is not normal in the large @xmath0 limit .",
    "generally , for @xmath158 decaying slower than either @xmath54 or @xmath169 in the asymptotic limit a bivariate stable distribution results , and although a generalisation of feller s theorem could be constructed it can not provide a normally distributed estimate for the quotient , or estimates of confidence limits .",
    "w. m. c. foulkes , l. mitas , r. j. needs , and g. rajagopal , rev .",
    "* 73 * , 33 ( 2001 ) . j. f. traub and a. g. wershulz , _ complexity and information _ ( cambridge university press , 1998 ) .",
    "d. w. stroock , _ probability theory : an analytic view _",
    "( cambridge university press , 1993 ) .",
    "j. h. curtiss , ann .",
    "math stat .",
    "* 12 * , 409 ( 1941 ) .",
    "m. dewing and d. m. ceperley , in _ recent advances in quantum monte carlo methods ii _",
    "( world scientific singapore , 2002 ) .",
    "coldwell , int .",
    "j.  quantum chem .  *",
    "s11 * , 215 ( 1977 ) . s. a. alexander , r. l. coldwell , h. j. monkhorst , and j. d. morgan iii , j.  chem .",
    "phys .  * 95 * , 6622 ( 1991 ) . c. attaccalite and s.sorella , phys",
    ".  rev .",
    "* 100 * , 114501 ( 2008 ) .",
    "r. assaraf , m. caffarel , and a. khelif , j.  phys .",
    "a : math .  theor .",
    "* 40 * , 1181 ( 2007 ) .",
    "j. r. trail , phys .",
    "e  * 77 * , 016703 ( 2008 ) .",
    "j. r. trail , phys .",
    "e  * 77 * , 016704 ( 2008 ) .",
    "d. ceperley , m. dewing , and c. pierleoni in _ bridging time scales : molecular simulations for the next decade _",
    "( springer - verlag , berlin heidelberg , 2002 ) .",
    "u. von luxburg and v. h. franz , confidence sets for ratios : a purely geometric approach to fieller s theorem .",
    "( 133 ) , max planck institute for biological cybernetics , tbingen , germany ( 2004 ) ; e. fieller , biometrika  * 24 * , 428 ( 1932 ) .",
    "n.d . drummond , m.d .",
    "towler and r.j .",
    "needs , phys .  rev .",
    "b * 70 * , 235119 ( 2004 ) .",
    "p. lpez ros , a. ma , n. d. drummond , m. d. towler and r. j. needs , phys .",
    "e * 74 * , 066701 ( 2006 ) . c. froese fischer , g. tachiev , g. gaigalas and m. r. godefroid comput .",
    "* 176 * , 559 ( 2007 ) .",
    "( http://atoms.vuse.vanderbilt.edu ) .",
    "m. p. nightingale and v. melik - alaverdian , phys .",
    "* 87 * , 043401 ( 2001 ) . m. lax , w. cai , and m. xu , _ random processes in physics and finance _ ( oxford university press , 2006 ) .",
    "j. toulouse and c. j. umrigar , j.  chem .",
    "phys .   * 126 * , 084102 ( 2007 ) .",
    "l. laaksonen , p.pyykko , and d. sundholm , comp .",
    "reports  * 4 * , 313 ( 1986 ) .",
    "m. d. brown , j. r. trail , p. l. rios , and r. j. needs , j.  chem",
    ".  phys .  * 126 * , 224110 ( 2007 ) .",
    "j. toulouse and c. j. umrigar , j.  chem .",
    "* 128 * , 174101 ( 2008 ) .",
    "m. puchalski and k. pachucki , phys .",
    "a * 73 * , 022503 ( 2006 ) .",
    "s. j. chakravorty , s. r. gwaltney , e. r. davidson , f. a. parpia , and c. f. fischer , phys .",
    "a  * 47 * , 3649 ( 1993 ) .",
    "g. samorodnitsky and m. s. taqqu , _ stable non - gaussian random processes _ ( chapman & hall , florida , 1994 ) ; see also http://academic2.american.edu/  jpnolan / stable / stable.html f. ruette , m. sanchez , r. anez , a. bermudez , and a. sierraalta , j.  mol .",
    ":  theochem  * 729 * , 19 ( 2005 ) .",
    "d. p. oneil and p. m. w. gill , mol .",
    "* 103 * , 763 ( 2005 ) .",
    "l. a. curtiss , p. c. redfern , and k. raghavachari , j.  chem .",
    "phys .  * 126 * , 084108 ( 2007 ) .",
    "r. j. needs , m. d. towler , n. d. drummond and p. lpez ros , j.  phys.:condensed matter * 22 * , 023201 ( 2010 ) .",
    "a. badinski , j. r. trail , and r. j. needs , j.  chem .",
    "phys .  * 129 * , 224101 ( 2008 ) .",
    "a. badinski , p. d. haynes , j. r. trail , and r. j. needs , j.  phys.:condensed matter  * 22 * , 074202 ( 2010 ) .",
    "finite @xmath170 for an infinite density matrix may occur by a cancellation of non - integrable singularities in the sum of integrals in eq .",
    "( [ eq:3 ] ) , @xmath171 $ ] . for standard sampling",
    "we replace @xmath50 with @xmath172 , and may replace @xmath173 with @xmath174 .",
    "these are biased estimates .",
    "the bias is small and equal to @xmath175 defined by eq .",
    "( [ eq:5 ] ) , provided the bivariate clt is valid .",
    "we do not use unbiased estimates to define the minimised quantity since they do not change the discussion in this section , but do complicate the equations for general sampling .",
    "this is not entirely obvious since eq .",
    "( [ eq:10 ] ) includes a total energy estimate , hence the averaged variables are neither independent or identically distributed .",
    "however , the bivariate clt remains valid due to the contribution of correlation between samples at different times decaying relative to the contribution of samples at the equal times , as sample size increases .",
    "a derivation is analogous to showing that variance estimates become normal .",
    "the computational budget for each system was 24h of computational time for monitored optimisation ( 12h for optimisation , 12h for sample generation ) followed by 24h for the final accurate estimate , with calculations performed on a modest desktop with 2 quad - core processors ."
  ],
  "abstract_text": [
    "<S> quantum mechanics for many - body systems may be reduced to the evaluation of integrals in 3n dimensions using monte - carlo , providing the quantum monte carlo _ ab initio _ methods .    here </S>",
    "<S> we limit ourselves to expectation values for trial wavefunctions , that is to variational quantum monte carlo . </S>",
    "<S> almost all previous implementations employ samples distributed as the physical probability density of the trial wavefunction , and assume the central limit theorem to be valid . </S>",
    "<S> in this paper we provide an analysis of random error in estimation and optimisation that leads naturally to new sampling strategies with improved computational and statistical properties . a rigorous lower limit to the random error </S>",
    "<S> is derived , and an efficient sampling strategy presented that significantly increases computational efficiency . </S>",
    "<S> in addition the infinite variance heavy tailed random errors of optimum parameters in conventional methods are replaced with a normal random error , strengthening the theoretical basis of optimisation .    </S>",
    "<S> the method is applied to a number of first - row systems , and compared with previously published results . </S>"
  ]
}