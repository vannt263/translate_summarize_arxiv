{
  "article_text": [
    "with the rapid rise of computing power , monte carlo methods @xcite have become an important tool for studying high - dimensional systems such as proteins , polymers and spin - glass models where many questions remain to be answered .",
    "while the metropolis algorithm @xcite , due to its simplicity , remains the most popular choice of method , it faces some severe drawbacks .",
    "firstly , the dynamics are slow for a class of problems that involve rugged energy landscapes with multiple local minima .",
    "secondly , a series of simulation at different temperatures is needed to obtain the temperature dependence of thermodynamic quantities . coupled with slow dynamics",
    ", the computation time can be prohibitive .",
    "thirdly , it is difficult to calculate free energy or entropy using this method .",
    "while the use of histogram method @xcite can alleviate the second problem by reweighting the canonical distribution , the accuracy is limited to a small region in a parameter space .",
    "recent methods based on the direct computation of the density of states are capable of overcoming the abovementioned drawbacks of metropolis algorithm .",
    "the multicanonical method @xcite is the earliest of these .",
    "entropic sampling @xcite is commonly cited as an equivalent but simpler formulation of multicanonical method .",
    "the flat histogram sampling algorithm @xcite is able to generate a flat histogram in energy space similar to multicanonical simulations , but in a simpler and more efficient way .",
    "the transition matrix monte carlo method @xcite can be used to either obtain the density of states directly or construct the canonical distribution for different temperatures .",
    "the method is based upon the definition of a stochastic matrix , the transition matrix @xmath0 .",
    "the flat histogram sampling algorithm is an ideal algorithm for obtaining the transition matrix elements through simulations .",
    "the transition matrix monte carlo method and associated flat histogram sampling algorithm are closely related to the broad histogram method @xcite .",
    "however , when it was first proposed by oliveira _",
    "et al _ in 1996 , the dynamics gave incorrect results in that the method did not generate true microcanonical averages @xcite . when corrected",
    ", the flip rate is identical to flat histogram s but the name remains a historic misnomer .",
    "a central quantity in the broad histogram formulation is @xmath1 , the microcanonical average of the number of potential moves that increase energy by @xmath2 . using this definition together with the requirement that moves must be reversible , a general equation called the broad histogram equation",
    "can be derived @xcite .",
    "although the definition of @xmath1 works well for ising model and can be used to construct the transition matrix @xmath0 , this interpretation is less general and poses a problem for other class of problems , such as polymer system .",
    "we shall define a more general quantity , @xmath3 , the transition matrix at infinite temperature or simply called `` infinite temperature transition matrix '' . the matrix elements of the infinite temperature transition matrix",
    "reduces to @xmath4 for some particular cases .",
    "the density of states @xmath5 , corresponds to the left eigenvector of the infinite temperature transition matrix .",
    "however , it is easier to obtain the density of states through another set of equations , the detailed balance equations ( analogous to the broad histogram equation ) explained later .",
    "our procedure for solving the density of states is also different from what is prescribed by the broad histogram method .    in the following section",
    ", we shall briefly describe our simulation model , the hp model and its connection to protein folding .",
    "the subsequent section is on the transition matrix monte carlo and flat histogram sampling algorithm .",
    "we shall discuss how it can be applied to polymer models .",
    "we give some numerical results in the fourth section and the conclusion in fifth section .",
    "one of the most challenging problems in computational biology is the problem of protein folding .",
    "proteins are heteropolymer consisting of long chains of amino acids . it is observed that proteins generally adopt a single unique `` native '' structure .",
    "the biological function of a protein is often intimately dependent upon the precise geometrical structure of this folded native state .",
    "how does the protein encodes this unique native state in an extremely large conformational space ? understanding this will be a major breakthrough with implications in biochemistry and drug design .",
    "it is believed that the native state lies at the global free energy minimum .",
    "only a small fraction of the total conformational space can be explored using high - resolution force - field methods .",
    "even more computing power is required when solvent effects are included .",
    "hence coarse grained models have been developed to model the folding process .",
    "the hp model @xcite is a commonly used simple lattice model with the basic assumption that it is the hydrophobic forces that determines the native structure of the protein .",
    "the model recognizes only two types of amino acids : hydrophobic ( @xmath6 ) and polar ( @xmath7 ) .",
    "there are some good arguments for supporting this assumption which we shall not elaborate @xcite .",
    "our chief concern is to study the statistical mechanical aspect of the model and the performance of our algorithm . given a sequence of @xmath6 and @xmath7 , each self - avoiding chain on a two - dimensional lattice is counted as one conformation .",
    "only non - bonded neighbouring @xmath8 contributes to the total energy , i.e. @xmath9 and @xmath10 . under such conditions , low - energy conformations are compact with @xmath6 residues residing mainly in the core and @xmath7 residues on the outside .",
    "the principle disadvantage of this model is that it leads to highly degenerate ground states , especially in three dimensions @xcite .",
    "in a monte carlo simulation , it is usual to generate a sequence of states @xmath11 using a markov chain where each state denoted by @xmath12 lies in the phase space of the model .",
    "the markov chain is defined by a transition matrix @xmath13 .",
    "this stochastic matrix must satisfy @xmath14 and @xmath15 .",
    "in addition , we require the detailed balance condition @xmath16 to guarantee an equilibrium probability distribution @xmath17 , i.e. @xmath18    it is useful to view the matrix @xmath19 as composed of two independent parts  selection probability @xmath20 and acceptance rate @xmath21 .",
    "@xmath22 for example , the standard metropolis algorithm @xcite uses @xmath23 with @xmath20 usually set to a constant",
    ". we can easily check that it satisfies the detailed balance condition when the selection probability @xmath24 is symmetric , i.e. @xmath25 .",
    "this symmetry in @xmath24 can be relaxed for general monte carlo simulation @xcite but is needed for the flat histogram sampling algorithm .    by summing up the detailed balance equations for all states",
    "@xmath12 with energy @xmath26 and all states @xmath27 with energy @xmath28 , we have @xmath29 if the configuration probability distribution is a function of energy only , i.e. @xmath30 , and defining the transition matrix in energy as @xmath31 we have @xmath32 the transition matrix @xmath0 is also a stochastic matrix with the histogram @xmath33 being the equilibrium distribution : @xmath34    since the acceptance rate @xmath35 in eq .",
    "( [ eqn : splitw ] ) is the same for configurations with a fixed energy , @xmath0 can also be written as a product of two independent factors  the infinite temperature transition matrix @xmath3 and acceptance rate in energy @xmath36 : @xmath37 where @xmath36 can be any acceptance rate satisfying eq .",
    "( [ eqn : db_eqn ] ) , the detailed balance equation , e.g. metropolis acceptance rate @xmath38 , and @xmath39    when @xmath20 is taken to be a constant , the expression can be simplified .",
    "for example , in spin systems we usually pick a spin randomly to be flipped so that @xmath40 , for @xmath12 and @xmath27 related by a single spin flip and zero otherwise , where @xmath41 is the total number of spins . in this case @xmath42 where @xmath43 and @xmath44 represents the number of spins that changes the energy of the current configuration @xmath12 by @xmath45 when flipped , i.e. @xmath46 .    substituting the eq .",
    "( [ eqn : tna ] ) into eq .",
    "( [ eqn : dbint ] ) , and using the equation @xmath47 which is derived from the detailed balance equation eq .",
    "( [ eqn : db_eqn ] ) and eq .",
    "( [ eqn : splitw ] ) with the requirement that @xmath48 is symmetric , which also implies that moves must be reversible , we obtained a set of equations @xmath49 when @xmath20 is fixed to a constant , we can write @xmath50 this equation , known as broad histogram equation , was first presented by oliveira in @xcite and by berg and hansmann @xcite .",
    "their derivation is based on property that moves between configurations are reversible and is somewhat simpler than our arguments above .",
    "however , the interpretation of @xmath44 can not be applied when the selection probability is not a constant as the definition of @xmath51 limits it to be an integer .",
    "the general definition of @xmath52 that can be applied to any choice of @xmath48 is given by eq .",
    "( [ eqn : defineti ] ) .",
    "( [ eqn : dbeqn ] ) is a general equation with two important assumptions made in our formulation : the probability of every configuration is a function of its energy only and allowable moves between any pair of configurations are selected with the same probability in both directions .",
    "the energy detailed balance equation can thus also be written as @xmath53 if we require that the histogram is constant or flat , i.e. @xmath54 , we choose the acceptance rate @xmath55 this equation was first proposed in @xcite and @xcite . while equivalent to the entropic sampling @xcite acceptance rate @xmath56 , the simulation procedure is different .",
    "we use a cumulative average to construct the acceptance rate during simulation , i.e. @xmath57 where @xmath58 is the cumulative histogram for a given energy , @xmath59 is the total number of samples generated so far , @xmath60 is the configuration at step @xmath61 of the simulation and @xmath62 are the available configurations that can be reached from @xmath60 in one move . whenever data is unavailable to compute the acceptance rate ,",
    "we simply accept the move in order to sample the unexplored states .    to model protein folding by a markov process",
    ", it is necessary to first define the move set .",
    "there are several choices and it has been shown that different move sets can affect kinetic quantities , like the mean first passage time @xcite .",
    "we use a local move set consisting of end , corner and the crankshaft move @xcite .",
    "these are shown in fig .",
    "[ fig : moveset.eps ] .",
    "note that the end moves are restricted to @xmath63 rotations and thus can have one or two possible positions depending on current configuration .",
    "the set of valid moves from current conformation @xmath12 to new conformation @xmath27 is those that can be performed using end , corner or crankshaft move , while preserving the excluded volume constraint .",
    "the choice of the move set used will affect the sampling space of configurations and also the correlation time of our algorithm .",
    "it can be shown that our set of local moves is non - ergodic , meaning that it does not generate all possible self - avoiding chains on the lattice . however , the number of such configurations is probably negligible compared to our sampling error @xcite",
    ". we can also consider the definition of our model to include only those states accessible by the move set specified .",
    "as long as our native state is accessible , there will not be a problem .",
    "the ergodicity problem can be overcome by pivot moves @xcite .",
    "pivot moves are defined by randomly choosing a monomer as a pivot and rotating or reflecting one segment of the chain with the pivot as origin .",
    "however , pivot moves also fills more entry in our transition matrix making it less banded .",
    "moreover , it is also found that pivot moves do not necessary lead to faster dynamics in the simulation @xcite .",
    "although some studies only consider conformations as distinct when they are not related by reflection or rotational symmetry , the choice should not matter since they differ by a factor of 8 in counting the number of states .",
    "for the special configurations on a straight line , the factor is 4 .",
    "however , such configurations have the highest energy and are thus almost negligible .    while the selection probability is commonly taken to be @xmath64 in spin systems , we have some freedom in deciding the specific selection probabilities based on different moves in polymer systems",
    ". we list three possibilities .",
    "* given a configuration , we can construct a list of all possible valid moves satisfying the excluded volume constraint .",
    "each move is selected with a fixed equal probability . in practice ,",
    "we assign moves into a list that can contain up to @xmath65 moves .",
    "since @xmath65 is the upper bound to maximum possible valid moves available to any configuration , the remaining unassigned moves are considered invalid .",
    "a move is picked at random .",
    "if it is valid , we accept the move using the acceptance ratio in eq .",
    "( [ eqn : accept_rate ] ) . in our simulation",
    ", we set @xmath65 equal to @xmath41 , the number of monomers . * given a configuration , we pick a monomer at random .",
    "if it is an end monomer , it is able to rotate to two possible positions . rotations are not allowed .",
    "it is necessary for the number of possible moves of each type be unambiguous for this case . ]",
    "we select one randomly without considering the excluded volume constraint .",
    "if it is not an end monomer , then corner or crankshaft moves are possible .",
    "these two moves are mutually exclusive .",
    "once a move is selected , we check the excluded volume constraint .",
    "if a move results in moving a monomer into an already occupied position , the move is rejected .",
    "otherwise , we accept the move using the acceptance ratio in eq .",
    "( [ eqn : accept_rate ] ) . for cases where no moves are possible for the monomer picked ,",
    "the current configuration is included in the average and the time step is incremented by one .",
    "this method of selecting move is used in ref .",
    "it relies on the fact that in moving to a new configuration using a particular type of move , only the same type of move in reverse can bring it back to the original configuration .",
    "thus , the move set must be chosen with this property to ensure that selection probability is symmetric .",
    "* we can designate end moves and corner moves as _",
    "1-monomer move _ and crankshaft move as _",
    "2-monomer move_. with probability e.g. 0.2 , we choose to perform 1-monomer move ; if an end monomer is picked , end moves are selected and corner moves otherwise , in the same manner as above ( see footnote ) . with remaining probability 0.8 ,",
    "pick a monomer from 1 to @xmath66 , a 2-monomer move is selected if monomers from @xmath61 to @xmath67 forms a crankshaft otherwise a move is unsuccessful .",
    "this method is used in ref .",
    "@xcite .",
    "for compact configurations , the rejection rate for the second method would be very high .",
    "we use the first method , although a large @xmath65 can also make the method inefficient for compact ( thus low - energy ) configurations since the number of possible moves is low compared to the value of @xmath65 .",
    "however , this can be overcome if an n - fold way simulation @xcite is done .",
    "a move is always accepted in the n - fold way and the average lifetime of a configuration is taken into account when averaging .",
    "the first method also has the advantage of saving some computations .",
    "since the selection probability is a constant , we can just add a constant ( equivalent to counting moves ) when calculating @xmath3 in eq .",
    "( [ eqn : defineti ] ) .",
    "the list of moves can also be used in constructing an n - fold way simulation . for other choices of selection probability",
    ", we will have to calculate @xmath20 explicitly for each move before adding .",
    "once @xmath3 is sampled , we solve eq .",
    "( [ eqn : dbeqn ] ) .",
    "since @xmath5 varies by a huge order of magnitude , we solved for @xmath68 instead .",
    "broad histogram method uses a forward difference scheme of integration .",
    "we solve it instead using a least squares method .",
    "when multiple simulations are performed , we can view it as an optimization problem taking the variance of sampling data into account @xcite .",
    "we present results on a sequence with 14 monomers with the sequence @xmath69 . through enumeration",
    ", we found that this sequence have a unique ground state ( i.e. 8 possible configurations in our counting ) of energy @xmath70 .",
    "the full density of states is given in table  [ tbl : dos ] .",
    ".density of states for the sequence @xmath69 .",
    "@xmath71 is monte carlo results using flat histogram sampling algorithm and @xmath5 is through enumeration . [ cols= \" > ,",
    "> , > , > \" , ]     we fit the times to find the minimum energy ( native ) states and the tunnelling times for the four sequences to a power law . the time to find native state follows approximately @xmath72 .",
    "the `` up '' and `` down '' tunnelling time gives the fitted parameter @xmath73 and @xmath74 respectively .",
    "this suggests that the algorithm takes increasingly longer time to reach the lowest energy states but moves easily towards the upper energy levels .",
    "it reflects our observation that the flat histogram sampling algorithm does not scale very well for longer chains especially when the density of states increase sharply with energy .",
    "this also implies that the performance is not ideal for sequences with a unique native ground state .",
    "we note that our simulation is non - markovian and thus the convergence is difficult to analyze .",
    "this can lead to detailed balance violation @xcite .",
    "however , this problem can be alleviated by a two pass simulation .",
    "the first pass is the same as before .",
    "the second pass uses a fixed flip rate , @xmath75 , obtained from the first pass .",
    "we have shown that the flat histogram sampling algorithm , which was first proposed and implemented for spin systems , can be used for the simulation of lattice polymer systems .",
    "we give some measures of its accuracy and also efficiency in terms of thermodynamics properties , native state time and tunnelling times .",
    "the current implementation is useful for up to about 20 monomer hp chain .",
    "however , we would like to emphasize that the flat histogram sampling algorithm is still vastly superior to metropolis algorithm , especially in terms of accuracy for low temperature properties .",
    "the simulation time is modest as there is no need for simulation at each temperature point .",
    "it also has the advantage of easily obtaining the density of states for free energy or entropy calculations .",
    "while the algorithm is rather basic , there are improvements to be made such as the extensions and modifications proposed in ref ."
  ],
  "abstract_text": [
    "<S> we demonstrate the use of a new algorithm called the flat histogram sampling algorithm for the simulation of lattice polymer systems . </S>",
    "<S> thermodynamics properties , such as average energy or entropy and other physical quantities such as end - to - end distance or radius of gyration can be easily calculated using this method . </S>",
    "<S> ground - state energy can also be determined . </S>",
    "<S> we also explore the accuracy and limitations of this method . </S>"
  ]
}