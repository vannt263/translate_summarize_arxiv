{
  "article_text": [
    "voids form a prominent aspect of the distribution of galaxies and matter on megaparsec scales .",
    "they are enormous regions with sizes in the range of @xmath0 mpc that are practically devoid of any galaxy and usually roundish in shape .",
    "forming an essential ingredient of the _ cosmic web _",
    "@xcite , they are surrounded by elongated filaments , sheetlike walls and dense compact clusters .",
    "together they define the salient weblike pattern of galaxies and matter which pervades the observable universe .",
    "voids have been known as a feature of galaxy surveys since the first surveys were compiled @xcite . following the discovery by @xcite of the most dramatic specimen , the botes void , a hint of their central position within a weblike arrangement came with the first cfa redshift slice @xcite .",
    "this view has recently been expanded dramatically as maps of the spatial distribution of hundreds of thousands of galaxies in the 2dfgrs @xcite and sdss @xcite have become available",
    ".    voids are a manifestation of the cosmic structure formation process as it reaches a non - linear stage of evolution .",
    "structure forms by gravitational instability from a primordial gaussian field of small amplitude density perturbations , where voids emerge out of the depressions ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "they mark the transition scale at which perturbations have decoupled from the hubble flow and organized themselves into recognizable structural features .",
    "early theoretical models of void formation @xcite were followed and generalized by the first numerical simulations of void centered universes @xcite .    in recent years",
    "the huge increase in computational resources has enabled n - body simulations to resolve in detail the intricate substructure of voids within the context of hierarchical cosmological structure formation scenarios @xcite .",
    "they confirm the theoretical expectation of voids having a rich substructure as a result of their hierarchical buildup .",
    "theoretically this evolution has been succesfully embedded in the extended press - schechter description @xcite .",
    "@xcite showed how this can be described by a two - barrier excursion set formalism ( also see * ? ? ?",
    "the two barriers refer to the two processes dictating the evolution of voids : their merging into ever larger voids as well as the collapse and disappearance of small ones embedded in overdense regions ( see * ? ? ?",
    "besides representing a key constituent of the cosmic matter distribution voids are interesting and important for a variety of reasons .",
    "first , they are a prominent feature of the megaparsec universe .",
    "a proper and full understanding of the formation and dynamics of the cosmic web is not possible without understanding the structure and evolution of voids @xcite .",
    "secondly , they are a probe of cosmological parameters .",
    "the outflow from the voids depends on the matter density parameter @xmath1 , the hubble parameter @xmath2 and possibly on the cosmological constant @xmath3 ( see e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    ". these parameters also dictate their redshift space distortions @xcite while their intrinsic structure and shape is sensitive to various aspects of the power spectrum of density fluctuations @xcite . a third point of interest concerns the galaxies in voids .",
    "voids provide a unique and still largely pristine environment for studying the evolution of galaxies @xcite .",
    "the recent interest in environmental influences on galaxy formation has stimulated substantial activity in this direction @xcite .    despite the considerable interest in voids",
    "a fairly basic yet highly significant issue remains : identifying voids and tracing their outline within the complex spatial geometry of the cosmic web .",
    "there is not an unequivocal definition of what a void is and as a result there is considerable disagreement on the precise outline of such a region ( see e.g. * ? ? ?",
    "because of the vague and diverse definitions , and the diverse interests in voids , there is a plethora of void identification procedures @xcite .",
    "the `` sphere - based '' voidfinder algorithm of @xcite has been at the basis of most voidfinding methods",
    ". however , this succesful approach will not be able to analyze complex spatial configurations in which voids may have arbitrary shapes and contain a range and variety of substructures . a somewhat related and tessellation based voidfinding technique that still is under development is zobov @xcite .",
    "it is the voidfinder equivalent to the voboz halofinder method @xcite .",
    "here we introduce and test a new and objective voidfinding formalism that has been specifically designed to dissect the multiscale character of the void network and the weblike features marking its boundaries .",
    "our _ watershed void finder _ ( wvf ) is based on the watershed algorithm @xcite .",
    "it stems from the field of mathematical morphology and image analysis .",
    "the wvf is defined with respect to the dtfe density field of a discrete point distribution @xcite .",
    "this assures an optimal sensitivity to the morphology of spatial structures and yields an unbiased probe of substructure in the mass distribution ( see e.g * ? ? ?",
    "* ; * ? ? ?",
    "because the wvf void finder does not impose a priori constraints on the size , morphology and shape of a voids it provides a basis for analyzing the intricacies of an evolving void hierarchy .",
    "indeed , this has been a major incentive towards its development .",
    "this study is the first in a series . here",
    "we will define and describe the watershed void finder and investigate its performance with respect to a test model of spatial weblike distributions , voronoi kinematic models .",
    "having assured the success of wvf to trace and measure the spatial characteristics of these models the follow - up study will address the application of wvf on a number of gif n - body simulations of structure formation @xcite . amongst others ,",
    "wvf will be directed towards characterizing the hierarchical structure of the megaparsec void population @xcite . for a comparison of the wvf with other void finder methods we refer to the extensive study of @xcite .    in the following sections we will first describe how",
    "the fundamental concepts of mathematical morphology have been translated into a tool for the analysis of cosmological density fields inferred from a discrete n - body simulation or galaxy redshift survey point distribution ( sect . 2 & 3 ) . to test our method",
    "we have applied it to a set of heuristic and flexible models of a cellular spatial distribution of points , voronoi clustering models .",
    "these are described in section 4 . in section 5",
    "we present the quantitative analysis of our test results and a comparison with the known intrinsic properties of the test models . in section 6",
    "we evaluate our findings and discuss the prospects for the analysis of cosmological n - body simulations .",
    "the new void finding algorithm which we introduce here is based on the _ watershed transform _ of @xcite and @xcite .",
    "a more extensive and technical description of the basic concepts of mathematical morphology and the basic watershed algorithm in terms of homotopy transformations on lattices @xcite is provided in appendix  [ app : mathmorph ] and  [ app : wshedimpl ] .",
    "the watershed transform is used for segmenting images into distinct regions and objects .",
    "the watershed transform ( wst ) is a concept defined within the context of mathematical morphology , and was first introduced by @xcite . the basic idea behind the wst finds its origin in geophysics .",
    "the wst delineates the boundaries of the separate domains , i.e. the _ basins _ , into which yields of , for example , rainfall will collect .    the word _ watershed",
    "_ refers to the analogy of a landscape being flooded by a rising level of water .",
    "suppose we have a surface in the shape of a landscape ( first image of fig .",
    "[ fig : proc ] ) .",
    "the surface is pierced at the location of each of the minima . as the water - level rises a growing fraction of the landscape",
    "will be flooded by the water in the expanding basins .",
    "ultimately basins will meet at the ridges corresponding to saddle - points in the density field .",
    "this intermediate step is plotted in the second image of fig .",
    "[ fig : proc ] .",
    "the ridges define the boundaries of the basins , enforced by means of a sufficiently high dam .",
    "the final result ( see last in fig .  [ fig : proc ] ) of the completely immersed landscape is a division of the landscape into individual cells , separated by the _ ridge dams_. in the remainder of this study we will use the word _",
    "`` segment '' _ to describe the watershed s cells .",
    "the watershed algorithm holds several advantages with respect to other voidfinders :    * within an ideal smooth density field ( i.e. without noise ) it will identify voids in a parameter free way .",
    "no predefined values have to be introduced . in less ideal , and realistic , circumstances a few parameters have to be set for filtering out discreteness noise .",
    "their values are guided by the properties of the data .",
    "* the watershed works directly on the topology of the field and does not reply on a predefined geometry / shape . by implication",
    "the identified voids may have any shape . *",
    "the watershed naturally places the _ divide lines _ on the crests of a field .",
    "the void boundary will be detected even when its boundary is distorted . *",
    "the transform naturally produces closed contours . as long as minima",
    "are well chosen the watershed transform will not be sensitive to local protrusions between two adjacent voids .",
    "obviously we can only extract structural information to the extent that the point distribution reflects the underlying structure .",
    "undersampling and shotnoise always conspire to obfiscate the results , but we believe the present methodology provides an excellent way of handling this .",
    "the watershed void finder ( wvf ) is an implementation of the watershed transform within a cosmological context .",
    "the watershed method is perfectly suited to study the holes and boundaries in the distribution of galaxies , and holds the specific promise of being able to recognize the void hierarchy that has been the incentive for our study .",
    "the analogy of the wst with the cosmological context is straightforward : _ voids _ are to be identified with the _ basins _ , while the _ filaments _ and _ walls _ of the cosmic web are the ridges separating the voids from each other .",
    "an outline of the steps of the watershed procedure within its cosmological context is as follows :    * * dtfe * : given a point distribution ( n - body , redshift survey ) , the delaunay tessellation field estimator ( dtfe , * ? ? ?",
    "* ) is used to define a continuous density field throughout the sample volume .",
    "this guarantees a density field which retains the morphological character of the underlying point distribution , i.e. the hierarchical nature , the web - like morphology dominated by filaments and walls , and the presence voids is warranted . + * * grid sampling * : for practical processing purposes the dtfe field is sampled on a grid .",
    "the optimal grid size has to assure the resolution of all morphological structures while minimizing the number of needed gridcells .",
    "this criterion suggests a grid with gridcells whose size is in the order of the interparticle separation .",
    "+ * * rank - ordered filtering * : the dtfe density field is adaptively smoothed by means of _ natural neighbour maxmin and median _ filtering .",
    "this involves the computation of the median , minimum or maximum of densities within the _ contiguous voronoi cell _ , the region defined by a point and its _ natural neighbours _ .",
    "+ * * contour levels * : the image is transformed into a discrete set of density levels .",
    "the levels are defined by a uniform partitioning of the cumulative density distribution . + * * pixel noise * : with an opening and closing ( operation to be defined in appendix .",
    "[ app : mathmorph ] ) of 2 pixel radius we further reduce pixel by pixel fluctuations . + * * field minima * : the minima in the smoothed density field are identified as the pixels ( grid cells ) which are exclusively surrounded by neighbouring grid - cells with a higher density value . + * * flooding * : the _ flooding procedure _ starts at the location of the minima . at successively increasing flood levels the surrounding region with a density lower than the corresponding density threshold",
    "is added to the _ basin _ of a particular minimum .",
    "the flooding is illustrated in fig .",
    "[ fig : proc ] . + * * segmentation * : once a pixel is reached by two distinct basins it is identified as belonging to their segmentation boundary . by continuing this procedure up to the maximum density level the whole region has been segmented into distinct _",
    "void patches_. + * * hierarchy correction * : a correction is necessary to deal with effects related to the intrinsic hierarchical nature of the void distribution .",
    "the correction involves the removal of segmentation boundaries whose density is lower than some density threshold",
    ". the natural threshold value would be the typical void underdensity @xmath4 ( see sect .",
    "[ sec : threshold ] ) . alternatively",
    ", dependent on the application , one may chose to take a user - defined value .",
    "+        0.4truecm          a direct impression of the watershed voidfinding method is most readily obtained via the illustration of a representative example . in fig .",
    "[ fig : wvf ] the watershed procedure has been applied to the cosmological gif2 simulation @xcite .    the n - body particle distribution ( lefthand fig .",
    "[ fig : wvf ] ) is translated into a density field using the dtfe method .",
    "the application of the dtfe method is described in section  [ sec : dtfe ] , the details of the dtfe procedure are specified in appendix  [ app : dtfe ] .",
    "the dtfe density field is sampled and interpolated on a @xmath5 grid , the result of which is shown in the top righthand frame of fig .",
    "[ fig : wvf ] .",
    "the gray - scales are fixed by uniformly sampling the cumulative density distribution , ensuring that all grayscale values have the same amount of volume .",
    "the dtfe density field is smoothed by means of the adaptive _ natural neighbour median _",
    "filtering described in sect .",
    "[ sec : natnghb ] .",
    "this procedure determines the filtered density values at the location of the particles .",
    "subsequently , these are interpolated onto a grid .",
    "this field is translated into a grayscale image following the same procedure as that for the raw dtfe image ( bottom lefthand panel ) .",
    "the minima in the smoothed density field are identified and marked as the flooding centres for the watershed transform .",
    "the resulting wvf segmentation is shown in the bottom righthand frame of fig .",
    "[ fig : wvf ] .    the correspondence between the cosmic web , its voids and the watershed segmentation is striking .",
    "there is an almost perfect one - to - one correspondence between the segmentation and the void regions in the underlying density field .",
    "the wvf method does not depend on any predefined shape . as a result",
    ", the recovered voids do follow their natural shape .",
    "a qualitative assessment of the whole simulation cube reveals that voids are very elongated and have a preferential orientation within the cosmic web , perhaps dictated by the megaparsec tidal force field ( see e.g. * ? ? ?",
    "clearly , the watershed void finder is able to extract substructure at any level present in the density distribution . while this is an advantage with respect to tracing the presence of substructure within voids it does turn into a disadvantage when seeking to trace the outline of large scale voids or when dealing with noise in the dataset . while the noise - induced artificial segments are suppresed by means of the full machinery of markers ( sect .",
    "[ sec : marker ] ) , void patch merging ( sect .",
    "[ sec : merging ] ) and natural neighbour rank filtering ( sect .  [ sec : natnghb ] ) , it are the latter two which may deal with intrinsic void hierarchy .",
    "the follow - up study @xcite will involve a detailed quantitative analyze of volume and shapes of the voids in the gif2 mass distribution for a sequence of timesteps .",
    "in order to appreciate the various steps of the watershed void finder outlined in the previous section we need to describe a few of the essential steps in more detail .    to process a point sample into a spatial density field we use dtfe . to detect voids of a particular scale",
    "it is necessary to remove statistically insignificant voids generated by the shotnoise of the discrete point sample as well as physically significant subvoids . in order to retain only the statistically significicant voids we introduce and apply natural neighbour rank - order filtering .",
    "hierarchy merging is used for the removal of subvoids which one would wish to exclude from a specific void study .",
    "the input samples for our analysis are mostly samples of galaxy positions obtained by galaxy redshift surveys or the positions of a large number of particles produced by n - body simulations of cosmic structure formation . in order to define a proper continuous field from a discrete distribution of points  computer particles or galaxies  we translate the spatial point sample into a continuous density field by means of the delaunay tessellation field estimator ( dtfe , * ? ? ?",
    "the dtfe technique @xcite recovers fully volume - covering and volume - weighted continuous fields from a discrete set of sampled field values .",
    "the method has been developed by @xcite and forms an elaboration of the velocity interpolation scheme introduced by @xcite .",
    "it is based upon the use of the voronoi and delaunay tessellations of a given spatial point distribution to form the basis of a natural , fully self - adaptive filter in which the delaunay tessellations are used as multidimensional interpolation intervals .",
    "a typical example of a dtfe processed field is the one shown in the top row of fig .",
    "[ fig : wvf ] : the particles of a gif n - body simulation @xcite are translated into the continuous density field in the righthand frame .        the primary ingredient of the dtfe method is the delaunay tessellation of the particle distribution .",
    "the delaunay tessellation of a point set is the uniquely defined and volume - covering tessellation of mutually disjunct delaunay tetrahedra ( triangles in 2d ) .",
    "each is defined by the set of four points whose circumscribing sphere does not contain any of the other points in the generating set @xcite .",
    "the delaunay tessellation and the voronoi tessellation of the point set are each others _ dual_. the voronoi tessellation is the division of space into mutually disjunct polyhedra , each polyhedron consisting of the part of space closer to the defining point than any of the other points @xcite    dtfe exploits three properties of voronoi and delaunay tessellations @xcite .",
    "the tessellations are very sensitive to the local point density .",
    "dtfe uses this to define a local estimate of the density on the basis of the inverse of the volume of the tessellation cells .",
    "equally important is their sensitivity to the local geometry of the point distribution .",
    "this allows them to trace anisotropic features such as encountered in the cosmic web .",
    "finally , dtfe exploits the adaptive and minimum triangulation properties of delaunay tessellations in using them as adaptive spatial interpolation intervals for irregular point distributions . in this way it is the first order version of the _ natural neighbour method _ @xcite .    within the cosmological context a major  and crucial ",
    "characteristic of a processed dtfe density field is that it is capable of delineating three fundamental characteristics of the spatial structure of the megaparsec cosmic matter distribution .",
    "it outlines the full hierarchy of substructures present in the sampling point distribution , relating to the standard view of structure in the universe having arisen through the gradual hierarchical buildup of matter concentrations .",
    "dtfe also reproduces any anisotropic patterns in the density distribution without diluting their intrinsic geometrical properties .",
    "this is particularly important when analyzing the the prominent filamentary and planar features marking the cosmic web .",
    "a third important aspect of dtfe is that it outlines the presence and shape of voidlike regions . because of the interpolation definition of the dtfe field reconstruction voids",
    "are rendered as regions of slowly varying and moderately low density values .",
    "a more detailed outline of the dtfe reconstruction procedure can be found in appendix  [ app : dtfe ] .",
    "dtfe involves the estimate of a continuous field throughout the complete sample volume . to process the dtfe field through the wvf machinery we sample the field on a grid",
    "it is important to choose a grid which is optimally suited for the void finding purpose of the wvf method . on the one hand , the grid values should represent all physically significant structural features ( voids ) in the sample volume . on the other hand",
    ", the grid needs to be as coarse as possible in order to suppress the detection of spurious and insignificant features .",
    "the latter is also beneficial from a viewpoint of computational efficiency .",
    "this is achieved by adopting a gridsize in the order of the mean interparticle distance .",
    "( a )   ( b )    the dtfe grid sampling is accomplished through monte carlo sampling within each grid cell . within each gridcell",
    "the dtfe density value is measured at 10 randomly distributed sample points .",
    "the grid value is taken to be their average .",
    "a major and novel ingredient of our wvf method intended to eliminate shot noise in the dtfe density field reconstructions is that of a natural non - linear filtering extension : the _ natural neighbour rank - ordered filtering _",
    "we invoke two kinds of non - linear adaptive smoothing techniques , _ median filtering _ and _ max / min filtering _ , the latter originating in mathematical morphology ( mm ) .",
    "both filters are rank order filters , and both have well known behaviour .",
    "they have a few important properties relevant for our purposes .",
    "median filtering is very effective in removing shot noise while preserving the locations of edges .",
    "the max / min filters are designed to remove morphological features arising from shot noise ( see appendix  [ app : mathmorph ] ) .",
    "the filters are defined over neighbourhoods .",
    "these are often named connectivity or , alternatively , structure elements .",
    "image analysis usually deals with regular two - dimensional image grids .",
    "the most common situation for such grids are straightforward 4-connectivities or 8-connectivities ( see fig .",
    "[ fig : connect ] ) .",
    "when a more arbitrary shape is used one usually refers to it as a structure element .    in the situation of our interest we deal with",
    "irregularly spaced data , rendering it impossible to use any of the above neighbourhoods .",
    "it is the delaunay triangulation which defines a natural neighbourhood for these situations . for any point it consists of its",
    "_ natural neighbours _ , i.e. all points to which it is connected via an edge of the delaunay triangulation ( see fig .",
    "[ fig : natnbrs ] ) .",
    "this may be extended to any higher order natural neighbourhood : e.g. a second order neighbourhood would include the natural neighbours of the ( first order ) natural neighbours .",
    "the advantages of following this approach are the same as those for the dtfe procedure : the natural neighbour filtering ",
    "shortly named nn-_median filtering _ or nn-_min / max filtering _",
    " forms a natural extension to our dtfe based formalism .",
    "it shares in the major advantage of being an entirely natural and self - adaptive procedure .",
    "the smoothing kernel is compact in regions of high point concentrations , while it is extended in regions of low density .",
    "implementing the min / max and median natural neighbour filters within the dtfe method is straightforward .",
    "the procedure starts with the dtfe density value at each of the ( original ) sample points",
    ". these may be the particles in an n - body simulation or the galaxies in a redshift survey .",
    "for each point in the sample the next step consists of the determination of the median , maximum or minimum value over the set of density values made up by that of the point itself and those of its natural neighbours .",
    "the new `` filtered '' density values are assigned to the points as the first - order filter value .",
    "this process is continued for a number of iterative steps , each step yielding a higher order filtering step .",
    "the number of iterative steps of the natural neighbour smoothing is dependent on the size of the structure to be resolved and the sampling density within its realm .",
    "testing has shown that a reasonable order of magnitude estimate is the mean number of sample points along the diameter of the structure . as an illustration of this criterion",
    "one may want to consult the low noise and high noise voronoi models in fig .",
    "[ fig : segorg ] .",
    "while the void cells of the low noise models contain on average 6 points per cell diameter , the void cells of the high noise model contain around 16 .",
    "fifth - order filtering sufficed for the low noise model , 20-th order for the high noise model ( fig .",
    "[ fig : vor11 ] and fig .",
    "[ fig : vor15 ] )    in the final step , following the specified order of the filtering process , the filtered density values  determined at the particle positions  are interpolated onto a regular grid for practical processing purposes ( see sec .",
    "[ sec : dtfegrid ] ) .    [ cols=\"^,^,^,^,^,^,^,^,^,^ \" , ]     [ tab : void ]    a direct application of the watershed",
    "transform results in a starkly oversegmented tessellation ( fig .",
    "[ fig : vor11 ] and fig .",
    "[ fig : vor15 ] ) . amongst the overabundance of mostly artificial , noise - related , segments we may also discern real significant watersheds .",
    "their boundary ridges ( divide lines ) are defined by filaments , walls and clusters surrounding the voids .",
    "many of these genuine voids are divided into small patches .",
    "they are the result of oversegmentation induced by the noisy poisson point distribution within the cells .",
    "the local minima within this background noise will act as individual watershed flood centres marking corresponding , superfluous , watershed segments .",
    "while for a general cosmological distribution it may be challenging to separate genuine physical subvoids from artificial noise - generated ones , the voronoi kinematic models have the unique advantage of having no intrinsic substructure .",
    "any detected substructure has to be artificial , rendering it straightforward to assess the action of the various steps intent on removing the noise contributions .",
    "the first step in the removal of insignificant minima consists of the application of the iterative natural neighbour median filtering process .",
    "this procedure , described in sect .",
    "[ sec : natnghb ] , removes some of the shot noise in the low density regions . at the same time it is edge preserving .",
    "the result of five nn - median filtering iterations on the high noise version of the voronoi kinematic clustering model is shown in fig .",
    "[ fig : vor11 ] . with the exception of a few artificial edges the resulting watershed segmentation",
    "almost perfectly matches the intrinsic voronoi tessellation .",
    "figure  [ fig : vor15 ] shows the result for the high noise version of the same voronoi kinematic clustering model . in this case pure nn - median filtering is not sufficient .",
    "a much more acceptable result is achieved following the application of the watershed hierarchy segment merging operation and the removal of ridges with a density contrast lower than the 0.8 contrast threshold .",
    "for both the low - noise and high - noise realizations we find that the intrinsic and prominent edges of the voronoi pattern remain in place .",
    "nonetheless , a few shot noise induced artificial divisions survive the filtering and noise removal operations .",
    "they mark prominent coherent but fully artificial features in the noise . given their rare occurrence we accept these oversegmentations as inescapable yet insignificant contaminations .",
    "the watershed segmentation retrieved by the watershed voidfinder is compared with the intrinsic ( geometric ) voronoi tessellation .",
    "the first test assesses the number of false and correct wvf detections . a second test concerns the volume distribution of the voronoi cells and the corresponding watershed void segments .      for our performance study we have three basic models : the intrinsic ( geometric ) voronoi tessellation , and the low noise and high noise voronoi clustering models ( table  [ tab : vorkinmpar ] ) .",
    "the voronoi clustering models are processed by wvf . in order to assess the various steps in the wvf procedure",
    "the models are subjected to different versions of the wvf .",
    "the second column of table  [ tab : void ] lists the differently wvf processed datasets .",
    "these are :    1 .   _",
    "original _ : the pure dtfe density field , without any smoothing or boundary removal , subjected to the watershed transform .",
    "minmax _ : only the nn-_min / max _ filtering is applied to the dtfe density field before watershed segmentation .",
    "med@xmath6 _ : @xmath6 iteratations of median natural - neighbour filtering is applied to the dtfe density field . in all situations",
    "this includes max / min filtering afterwards .",
    "_ hierarch _ : following the watershed transform , on the pure non - filtered dtfe density , a density threshold is applied .",
    "the applied hierarchy threshold level is @xmath7 : all segment boundaries with a density lower than @xmath8 are removed as physically insignificant .",
    "med@xmath6hr _ : mixed process involving an @xmath6 times iterated median filtered dtfe density field , followed by the watershed transform , after which the segment boundaries below the hierarchy threshold @xmath8 are removed .",
    "note that the physically natural threshold of @xmath4 is not really applicable to the heuristic voronoi models . on the basis of the model specifications",
    "the threshold level has been set to @xmath9 .",
    "each of the resulting segmentations is subjected to a range of detection assessments .",
    "these are listed in the 3rd to 7th column of table  [ tab : void ] .",
    "the columns of the table contain respectively the number of wvf void detections , the amount of false splits , the amount of false mergers , the number of correctly identified voids , and the correctness measure .",
    "while the top block contains information on the intrinsic ( geometric ) voronoi tessellation , the subsequent two blocks contain the detection evaluations for the _ low noise _ and _ high noise _ models .",
    "the false detections are split into two cases .",
    "the first case we name _ false splits _ : a break up of a genuine cell into two or more watershed voids .",
    "the second class is that of the _ false mergers _ : the spurious merging of two voronoi cells into one watershed void .",
    "the splits , mergers and correct voids are computed by comparing the overlap between the volume of the voronoi cell and that of the retrieved watershed void .",
    "a split is identified if the overlap percentage w.r.t .",
    "the voronoi volume is lower than a threshold of 85 percent of the overlapping volume . along the same line",
    ", a merger concerns an overlap deficiency with respect to the watershed void volume .",
    "when both measures agree for at least 85 percent a void is considered to be correct .",
    "the correctness of a certain segmentation is the percentage of correctly identified voids with respect the 180 intrinsic voronoi cells",
    ".      judging by the number of voids in the low noise model , it is clear that smoothing or any other selection criterion remain necessary to reduce the number of minima from 850 to a number close to the intrinsic value 180 .",
    "the second row shows the results for the case when just the maxmin filter is applied .",
    "this step already reduces the number of insignificant minima by already 60 percent .",
    "it is an indication for the local character of the shot noise component .",
    "the next three rows list the results for various iterations of the median filtering . with just 2 iterations almost 90 percent of the voids",
    "are retrieved .",
    "most of the splits are removed at 2 iterations .",
    "this result does not improve with more median filtering , even up to 20 iterations this just increases the number of mergers as more walls are smoothed away .",
    "the number of splits also increases as minima begin to merge .      in general the same conclusion",
    "can be drawn for the high noise model .",
    "rank - ordered nn - median and nn - min / max filters manage to reduce the number of insignificant minima by a factor of 80 percent ( cf . the number of voids in the second and third row ) .",
    "these models attain a correctness of approximately fifty percent .",
    "mere rank - ordered filtering is evidently insufficient .",
    "we also ran a _",
    "model which did not include median filtering .",
    "instead only insignificant boundaries were removed .",
    "it achieved a recovery of fifty percent .",
    "combining both methods ( _ med5hr _ and _ med20hr _ ) recovers 80 till 90 percent of the voids .",
    "the succes rate may be understood by the complementarity of both methods : while the median filtering recovers the coherent structures , the thresholding will remove those coherent walls that are far underdense .",
    "the translation to a cosmological density field is straightforward .",
    "the rank - ordered filtering ensures that insignificant minima are removed and that the watershed will pick up only coherent boundaries .",
    "thresholding is able to order these walls by significance and to remove the very underdense and insignificant walls .      in fig .",
    "[ fig : voiddis ] we compare the distribution of the void volumes .",
    "the histogram shows the distribution of equivalent radii for the segment cells , @xmath10 the solid line histogram shows the ( geometric ) volume distribution for the intrinsic voronoi tessellations . on top of this",
    "we show the distributions for the various ( parameterized ) watershed segmentation models listed in table  [ tab : void ] .",
    "not surprisingly the best segmentations have nearly equivalent volume - distributions .",
    "for the lownoise models this is _ med2 _",
    "( lefthand ) , for the highnoise models _",
    "med20hr _ ( righthand ) .",
    "this conclusion is in line with the detection rates listed in table  [ tab : void ] .",
    "the visual comparison of the intrinsic geometric voronoi tessellations and the two best segmentations - _ med2 _ for the lownoise model and _ med20hr _ for the highnoise version  confirms that also the visual impression between these watershed renderings and the original voronoi model is very much alike .",
    "we have also assessed the cell - by - cell correspondence between the watershed segmentations and the voronoi model . identifying each watershed segment with its original voronoi cell",
    "we have plotted the volume of all watershed cells against the corresponding voronoi cell volumes .",
    "the scatter plots in fig .",
    "[ fig : voidvol ] form a convincing confirmation of the almost perfect one - to - one relation between the volumes derived by the wvf procedure and the original volumes .",
    "the only deviations concern a few outliers .",
    "these are the _ hierarchy merger _ segments for which the watershed volumes are too large , resulting in a displacement to the right .      while the volumes occupied by the watershed segments in fig .",
    "[ fig : best ] do overlap almost perfectly with that of the original voronoi cells , their surfaces have a more noisy and erratic appearance .",
    "this is mostly a consequence of the shot noise in the ( dtfe ) density field , induced by the noise in the underlying point process .",
    "the crests in the density field are highly sensitive to any noise ,    in addition to assess the impact of the noise on the surfaces of the watershed segments we compared the watershed segement surface areas with the voronoi cell surface areas .",
    "the results are shown in fig .",
    "[ fig : voidsurf ] .",
    "we tested the lownoise _",
    "med2 _ and the highnoise _",
    "med20hr_. in both cases we find a linear relationship between the watershed surface and the genuine voronoi surface area .",
    "both cases involve considerably more scatter than that for the volumes of the cells .",
    "in addition to an increased level of scatter we also find a small be it significant offset from the 1 - 1 relation .",
    "the slope of the lownoise model is only slightly less than unity , the highnoise model slope deviates considerably more . these offsets do reflect the systematically larger surface areas of the watershed segments , a manifestation of their irregular surfaces .",
    "it is evident that the level of irregularity is more substantial for the highnoise than for the lownoise reconstructions ( cf .",
    "[ fig : best ] ) .",
    "the scatter plots do also reveal several cells with huge deviations in surface area . unlike expected there is no systematic trend for smaller cells to show larger deviations .",
    "some of the small deviating cells can be recognized in fig .",
    "[ fig : best ] as highly irregular patches .",
    "the large deviant cells correspond to watershed segments which as a result of noisy boundaries got wrongly merged .    while the irregularity of the surface areas forms a good illustration of the noise characteristics of the watershed patches , for the purpose of void identification it does not pose a serious problem .",
    "smoother contours may always be obtained by applying the flooding process on a properly smoothed field . some suggestions for this",
    "may be achieved follows in the discussion .",
    "the wvf void finder technique is based on the watershed transform known from the field of image processing .",
    "voids are identified with the basins of the cosmological mass distribution , the filaments and walls of the cosmic web with the ridges separating the voids from each other . stemming from the field of mathematical morphology ,",
    "watershed cells are considered as patches locally minimizing the `` topographic distance '' .",
    "the wvf operates on a continuous density field .",
    "because the cosmological matter distribution is nearly always sampled by a discrete distribution of galaxies or n - body particles , the first step of the wvf is to translate this into a density field by means of the delaunay tessellation field estimator ( dtfe ) . because the wvf involves an intrinsically morphological and topological operation , the capability of dtfe to retain the shape and morphology of the cosmic web is essential .",
    "it guarantees that within this cosmological application the intrinsic property of the watershed transform to act independent of scale , shape , and structure of a segment is retained . as a result , voids of any scale , shape and structure may be detected by wvf .",
    "in addition to the regular watershed transform the wvf needs to invoke various operations to suppress ( discreteness ) sampling noise .",
    "in addition , we extend the watershed formalism such that the wvf will be capable of analyzing the hierarchy of voids in a matter distribution , i.e. identify how and which small scale voids are embedded within a void on larger scales @xcite . markers indicating significant void centers , false segment removal by hierarchy merging and natural neighbour filtering all affect an efficient noise removal . hierarchy merging manages to eliminate boundaries between subvoids .",
    "natural neighbour median filtering , for various orders , is an essential new ingredient for highlighting the hierarchical embedding of the void population .",
    "it allows a natural selection of voids , unbiased with respect to the scale and shape of these structures .",
    "the voids that persist over a range of scales are expected to relate to the voids that presently dominate the cosmic matter distribution . in other words ,",
    "wvf preserves the void hierarchy @xcite .",
    "the present work includes a meticulous qualitative and quantitative assessment of the watershed transform on the basis of a set of voronoi kinematic models .",
    "these heuristic models of spatial weblike or cellular galaxy or particle distributions facilitate the comparison between the void detection of the wvf and that of the characteristics of the cells in the original and intrinsically known voronoi tessellation .",
    "it is found that wvf is not only succesfull in reproducing the qualititative cellular appearance of the voronoi models but also in reproducing quantitative aspects like an almost perfect 1 - 1 match of cell size with wvf segment volume and the corresponding void size distribution .",
    "we foresee various possible improvements of the wvf .",
    "these concern in particular the identification of significant edges .",
    "one possibility is that extension proposed by @xcite , in which not only the `` topographic costs '' but also the lengths of the contours should be minimized .",
    "the length minimization will result in smoother boundaries .",
    "additional improvements may be found in better filtering procedures in order to facilitate studies of hierarchically structured patterns .",
    "we expect considerable improvements by anisotropic diffusion techniques @xcite and are currently implementing these in the wvf code .",
    "given the results of our study , we are confident for applying wvf to more elaborate and realistic simulations of cosmic structure formation and on large galaxy redshift surveys . the analysis of a set of gif cosmological simulations will be presented in an upcoming paper .",
    "we wish to thank miguel aragn - calvo for permission to use fig .  [",
    "fig : vorkinmschm ] .",
    "we are grateful to the referee , mark neyrinck , for the incisive , detailed and useful comments and recommendations for improvements .",
    "we particularly thank the participants of the knaw colloquium `` cosmic voids '' in amsterdam , dec .",
    "2006 , for the many useful discussions and encouraging remarks .",
    "99 k. , et al .",
    "( the sdss collaboration ) , 2003 , aj , 126 , 2081 j. , mhnen p.,1998 , apj , 497 , 534 s. , mller v.,2002 , mnras , 332 , 205 a.j . , hoyle f. , fernando t , vogeley m.s . , 2003 , mnras , 340 , 160 f. , van de weygaert r. , 1996 , mnras , 279 , 693 e. , 1985 , apjs , 58 , 1 s. , lantuejoul c. , 1979 , in proceedings international workshop on image processing , ccett / irisa , rennes , france s. , meyer f. , 1993 , mathematical morphology in image processing , ed .",
    "m. dekker , new york , ch .",
    "12 , 433 m.j .",
    ", marimont d.h . , 1998 , ieee image processing , 7 , 421 j.r . , cole s. , efstathiou g. , kaiser n. , 1991 , apj , 379 , 440 j.r .",
    ", kofman l. , pogosyan d. , 1996 , nature , 380 , 603 g.r.,da costa l.n . ,",
    "goldwirth d.s .",
    ", piran t. , 1992 , apj , 388 , 234 j. , sambridge m. , 1995 , nature , 376 , 655 l. , padilla n.d . , valotto c. , lambas d.g , 2006 , mnras , 373 , 1440 g. , rood h.j . , 1975 , nature , 257 , 294 j.m . , sheth r.k .",
    ", diaferio a. , gao l. , yoshida n. , 2005 , mnras , 360 , 216 j.m . , pearce f. , brunino r. , foster c. , platen e. , basilakos s. , fairall a. , feldman h. , gottlber s. , hahn o. , hoyle f. , mller v. , nelson l. , neyrinck m. , plionis m. , porciani c. , shandarin s. , vogeley m. , van de weygaert r. , 1999 , mnras , subm . m. , et al . , ( the 2dfgrs team ) , 2003 , vizier online data catalog , 7226 a. , rees m.j . , 1994 , apj , 433 , l1 v. , geller m. , huchra j.p . , 1986 , apj , 302 , l1 b.  n. , 1934 , bull . acad . sci .",
    "clase sci .",
    ", 7 , 793 j. , da costa l.n . , goldwirth d.s . , lecar m. , piran t. , 1993 , apj . , 410 , 458 j.,joeveer m. , saar e , 1980 , mnras , 193 , 353 h. , piran t. , 1997 , apj , 491 , 421 h.h . , triay r. , 2006 , gr - qc/0607090 s.r . , piran t. , 2006 , mnras , 366 , 467 y. , piran t. , 2001 , apj , 548 , 1 d.m .",
    ", vogeley m.s . , 2004 , apj , 605 , 1 s. , okas e.l .",
    ", klypin a. , hoffman y. , 2003 , mnras , 344 , 715 l.a . ,",
    "thompson s.a . , 1978 ,",
    "apj , 222 , 748 n.a .",
    ", geller m.j . , 1999 , aas , 195 , 1384 o. , porciani c. , carollo m. , dekel a. , 2007 , mnras , 375 , 489 h.j.a.m .. , 1994 , morphological image operators , academic press m. , yepes g. , gottlber s. , springel w.,2006 , mnras , 371 , 401 y. , shaham j. , 1982 , apj , 262 , l23 y. , silk j. , wyse r.f.g . , 1992 , apj , 388 , l13 f. , vogeley m. , 2002 , apj , 566 , 641 , v. , 1984 , mnras , 206 , 1 g. , fairall a.p . , 1991 , mnras , 248 , 313 g. , colberg j.m .",
    ", diaferio a. , white s.d.m . , 1999 ,",
    "mnras , 303 , 188 r.p . ,",
    "oemler a. , schechter p.l .",
    ", shectman s.a . , 1981 ,",
    "apj , 248 , 57 r.p . , oemler a. , schechter p.l . ,",
    "shectman s.a . , 1987 , apj , 314 , 493 r. , 1998 , in mathematical morphology and its applications to image and signal processing , eds . h.j.a.m .",
    "heijmans , j.b.t.m .",
    "roerdink , p. 35 - 42",
    ", kluwer j. , park d. , 2006 , apj , 652 , 1 b. , weinberg d.h . , 1994 ,",
    "mnras , 267 , 605 h. , wasserman i. , 1990 , apj , 348,1 g. , 1975 , random sets and integral geometry , wiley h. , white s.d.m . , 2002 , mnras , 337 , 1193 f. , 1994 , signal processing , 38 , 113 f. , beucher s. , 1990 , j. visual comm .",
    "image rep .",
    ", 1 , 21 m.  c. , gnedin n.  y. , hamilton a.  j.  s. , 2005 , mnras , 356 , 1222 m. , 2007 , in cosmic voids , proc .",
    "knaw colloquium , knaw d. , colombi s. , dore o. , 2006 , mnras , 366 , 1201 t.n . , worring m. , van den boomgaard r. , 2003 , ieee transactions on pattern analysis and machine intelligence , vol . 25 , no . 3 , 330 a. , boots b. , sugihara k. , chiu s.n . , 2000 , 2nd ed .",
    ", wiley n.d . , ceccarelli l. , lambas d.g . ,",
    "mnras , 363 , 977 s.g .",
    ", betancort - rijo j.e .",
    ", prada f. , klypin a. , gottlber s. , mnras , 369 , 335 s.g .",
    ", prada f. , holtzman j. , klypin a. , betancort - rijo j.e . , mnras , 372 , 1710 p.j.e . , 2001 ,",
    "apj , 557 , 495 e. , van de weygaert r. , jones b.j.t .",
    ", 2007 , mnras , in prep .",
    "m. , basilakos s. , 2002 , mnras , 330 , 399 w.h . , schechter p. , 1974 ,",
    "apj , 187 , 425 e. , geller m.j .",
    ", 1991,apj , 373 , 14 j. , meijster a. , 2000 , fundamenta informaticae , vol .",
    "41 , 187 r.r .",
    ", vogeley m.s . , hoyle f. , brinkmann j. , 2005 , apj , 624 , 571 b.s . , melott a.l . , 1996 ,",
    "apj , 470 , 160 w. , 2007 , the delaunay tessellation field estimator , ph.d .",
    "thesis , university of groningen w. , van de weygaert r. , 2000 , a&a , 363 , l29 w. , van de weygaert r. , 2007 , a&a , to be subm .",
    "ryden b.s . ,",
    "melott a.l . , 2001 , apj , 546 , 609 j. , 1983 , image analysis and mathematical morphology , academic press s. , feldman h.a . , heitmann k. , habib s. , 2006 , mnras , 376 , 1629 r.k . , 1998 , mnras , 300 , 1057 r.k . , van de weygaert r. , 2004 , mnras , 350 , 517 n. , 1998 , the natural element method in solid mechanics . ph.d .",
    "thesis , theoretical and applied mechanics , northwestern university , evanston , il , usa a. , van gorkom j.h . , greg m.d .",
    ", strauss m.a . , 1996 ,",
    "aj , 111 , 2150 r. , 1991 , voids and the geometry of large scale structure , ph.d .",
    "thesis , leiden university r. , 1994 , a&a , 283 , 361 r. , 2002 , in modern theoretical and observational cosmology , proc .",
    "2nd hellenic cosmology meeting , ed .",
    "m. plionis , s. cotsakis , assl 276 , p. 119 - 272 , kluwer r. , 2007 , a&a , to be subm .",
    "r. , icke v. , 1989 , a&a , 213 , 1 r. , van kampen e. , 1993 , mnras , 263 , 481 r. , sheth r. , platen e. , 2004 , iau colloq .",
    "195 : outskirts of galaxy clusters : intense life in the suburbs , 58 l. , soille p. , 1991",
    ", ieee transactions on pattern analysis and machine intelligence , vol .",
    "13 , no . 6 , pp .",
    "583 g. f. , 1908 , j. reine angew .",
    "134 , 198 d.f . , 1992 ,",
    "contouring : a guide to the analysis and display of spatial data , pergamon press",
    "0.3 cm         appendix  [ app : mathmorph ] and  [ app : wshedimpl ] provide some formal concepts and notations necessary for appreciating the watershed transform .",
    "the wvf formalism introduced in this study is largely based upon concepts and techniques stemming from the field of image analysis .",
    "although they are used within the context of the morphological analysis of spatial patterns in cosmological density fields the presentation is in terms of the original image analysis nomenclature . in this",
    "we remind the cosmology reader to translate `` image '' into `` density field '' , `` basin '' into `` void interior '' , etc .",
    "mathematical morphology ( mm ) is the field of image analysis which aims at characterizing an image on the basis of its geometrical structure .",
    "it provides techniques for extracting image components which are useful for representation and description and was originally developed by g. matheron and j. serra . for more details",
    "we refer to @xcite , also see @xcite .",
    "it involves a set - theoretic method of image analysis and incorporates concepts from algebra ( set theory , lattice theory ) as well as from geometry ( translation , distance , convexity ) .",
    "applications of mathematical morphology may be found in a large variety of scientific disciplines , including material science , medical imaging and pattern recognition .",
    "a cosmological density field @xmath11 may be mapped onto an image @xmath12 , @xmath13 the image @xmath12 is a function in @xmath6-dimensional lattice space ( usually @xmath14 or @xmath15 ) @xmath16 , @xmath17 although in principle images may be continuous , in practice they usually attain a finite number of discrete values .",
    "two important classes are :    * _ binary image _ :   +  image with only 2 intensity values ( fig .",
    "[ fig : mm_oper ] , top lefthand ) , @xmath18 we follow the convention to identify the binary image by the set @xmath19 for which @xmath20 . *",
    "_ grayscale image _",
    ":   +  image with a discrete number @xmath21 of values ( fig .",
    "[ fig : mm_oper ] , bottom lefthand ) , @xmath22    mathematical morphology was originally developed for binary images , and was later extended to grayscale images .",
    "the two basic operators of mathematical morphology are _ erosion _ and _ dilation _ of a binary image @xmath23 . in order to define these operators we need to invoke the _ translation _ and _ reflection _ of a set @xmath24 , @xmath25 the dilation or erosion of a binary image @xmath23 by a structuring element @xmath24 identifies",
    "whether the translated set @xmath26 has an overlap with or is contained in a certain part of @xmath23 , @xmath27 in other words , dilation consists of the minkowski addition ( @xmath28 ) of the binary image @xmath23 with a structuring element @xmath24 while erosion is the minkowski substraction ( @xmath29 ) with @xmath24 .",
    "a structuring element may be any object in @xmath16 .",
    "an example is the circle which functioned as a structuring element in fig .",
    "[ fig : mm_oper ] . erosion and dilation",
    "have a number of properties :    * translation invariance * global scaling invariance * addition : @xmath30 * complementarity : * erosion of a set is dilation of complement * ( and vice versa ) * adjunction relationship : @xmath31    the complementarity and adjunction relationship are two aspects of the existing duality between erosion and dilation . in general erosion and dilation induce a loss of information .",
    "erosion followed by dilation , or vice versa , will only result in a restoration of the original image if the sets @xmath23 , @xmath32 and @xmath33 are convex .",
    "in fact , various combinations of the erosion and dilation operators do result in new operators .",
    "the most straightforward combination of dilation and erosion is that of the consecutive application of an erosion and a dilation .",
    "this introduces two new operators , the _ opening _ and _ closing _ operators . on a binary image they have the effects shown in fig .",
    "[ fig : mm_oper ] ( top centre , top righthand ) .",
    "opening amends caps , removes small islands and opens isthmuses .",
    "closing , on the other hand , closes channels , fills small lakes and ( partly ) the gulfs .",
    "an additional combination of erosion and dilation is subtraction of the first from the latter , called a _",
    "morphological gradient_.    formally , an opening is an erosion followed by a dilation , a closing a dilation followed by erosion . @xmath34",
    "\\\\ \\textrm{closing : } & & \\phi_{b } & \\,\\equiv\\,&[(x \\oplus b)\\ominus b ] \\\\ \\ \\\\ \\end{array}\\ ] ] characteristics of the opening and closing operators are :    * increasing * idempotent : * applying the operator twice yields the same output * opening is anti - extensive : @xmath35 * closing is extensive : @xmath36    note that the extensivity and/or anti - extensivity of operators define the prime conditions for a _",
    "morphological operator_.      the morphological operators which we discussed above can be generalized to grayscale images .",
    "a grayscale image is composed of subsets @xmath37 , @xmath38 with @xmath39 and @xmath40 the support of the full image .",
    "the erosion and dilation of a grayscale image involves their application to each individual subset @xmath37 .",
    "extension of the binary image definitions ( eqn .",
    "[ eqn : bintrref ] ) implies the following definition wrt . a grayscale image , @xmath41 the effect of erosion on a grayscale image is the shrinking of the bright regions .",
    "bright spots smaller than the structuring element @xmath24 disappear completely while valleys ( dark ) expand .",
    "dilation has the opposite effect : dark regions shrink while bright regions expand .",
    "it illustrates the duality between erosion and dilation .    for our purposes",
    ", this formal definition translates into the following practical implementation for 2-d grayscale images . given a grayscale image @xmath42 with grid elements @xmath43 , @xmath44\\,+\\,{\\hat b}[i , j]\\}\\\\ & & & \\forall [ r , s ] \\in a\\\\ { \\mathcal f}\\ominus b & \\,=\\,&{\\min_{(i , j ) \\in b}}\\ \\{a[r+i , s+j]\\,+\\,b[i , j]\\}\\\\ & & & \\forall [ r , s ] \\in a\\\\",
    "\\ \\\\ \\end{array}\\ ] ]    as in the case of binary images new operators may be defined through combinations of erosions and dilations .",
    "the closing and opening operators are defined in exactly the same way as that for the binary images .",
    "their effect is shown in the lower column of fig .",
    "[ fig : mm_oper ] .",
    "the morphological gradient @xmath45 is a dilation minus erosion operation .",
    "the gradient operator is often used in object detection because an object is usually associated with a change in grayscale with respect to the background .",
    "a variety of additional operators involving openings and closings may be defined .",
    "interesting ones are the _ granulometries _ , a sequence of erosions with increasing scale , and _ distance transforms_.",
    "the segmentation of images is defined on the basis of a distance criterion , referring to the concept of _ distance _ between subsections of an image .      for appreciating the concept of watershed segmentation we consider two distance concepts , the _ geodesic _ and _ topographic _ distance .",
    "geodesic distances are used in the case of binary images while topographic distances form the basis for the segmentation of grayscale images .",
    "let @xmath46 be a set and x and y two points in an @xmath6-dimensional lattice space @xmath16 .",
    "we may define      the geodesic distance @xmath47 is the length of the shortest ( geometric ) path in @xmath23 connecting @xmath48 and @xmath49 ( see lefthand frame , fig .",
    "[ fig : skiz ] ) .",
    "accordingly , the distance between two subsets @xmath33 and @xmath24 in @xmath23 may be defined as follows .",
    "considering the set of all paths between any of the elements of @xmath33 and those of @xmath24 , the distance @xmath50 between @xmath33 and @xmath24 is defined to be the minimum length of any of these paths .",
    "based upon the concept of @xmath50 one may formulate a distance function of a set @xmath51 . for each point @xmath52 ,",
    "the distance @xmath53 to its complement @xmath54 is computed .",
    "the distance function @xmath55 is the resulting map of distance values @xmath56 .",
    "regions whose distance @xmath56 is at least @xmath57 can be identified and equated by erosion of @xmath32 with a disk of radius @xmath57 ( defining a set @xmath58 ) . each of these regions forms a section @xmath59 ( see sec .  [",
    "app : grayscale ] ) , @xmath60 in which @xmath61 is the disk of radius @xmath57 .",
    "the map @xmath62 may be regarded as a stack of these sections . for illustration",
    "the distance transform of the the binary image fig .",
    "[ fig : mm_oper ] is depicted in the central frame of fig  [ fig : skiz ] .",
    "the topographic distance @xmath63 between two points in @xmath16 is defined with respect to the image map @xmath64 . taking the limit of a continuous map @xmath12 , the topographic distance from @xmath48 to @xmath49 is the path which attains the minimum length through the `` image landscape '' , @xmath65 in this definition , the integral denotes the _ image pathlength _",
    "@xmath66 along all paths @xmath67 in the set of all possible paths , @xmath68 .",
    "this concept of distance is related to the geodesics of the surface @xmath12 : the path of steepest descent , specifing the track a droplet of water would follow as it flows down a mountain surface .      based on the specific definition of distance , we may segment a binary image @xmath12 through the identification of the zones of influence of well - defined subsets of @xmath12 .",
    "in general the binary image @xmath12 contains @xmath6 connected subsets @xmath69 ( @xmath70 ) ( the black regions of fig .",
    "[ fig : mm_oper ] ) and a set x ( white region ) which contains all points @xmath48 which do not belong to any of the subsets @xmath69 , i.e. @xmath71      the geodesic zone of influence @xmath72 of a subset @xmath73 is the set of all the points @xmath74 that are stricktly closer to @xmath69 than to any other subset @xmath75 , @xmath76    the _ zone of influence _",
    "@xmath77 of @xmath78 is the union of all influence zones of @xmath79 , @xmath80      the boundary set in @xmath23 consists of those points which do belong to @xmath23 yet are not contained in any of the zones of influence @xmath72 .",
    "these boundary points define the geodesic _ skeleton _ @xmath81 of @xmath78 , @xmath82 in fig .",
    "[ fig : skiz ] ( righthand frame ) the skeleton in set @xmath23 is outlined by white lines .",
    "the skeleton is superimposed on its defining distance function landscape , its values indicated by a red colour gradient scheme ( the corresponding landscape profile is depicted in the central frame ) .",
    "we should point out that here we follow the definition of mathematical morphology although the name of _ skeleton _ of the large scale cosmic matter distribution has been used for different be it related concepts ( see e.g. * ? ? ?",
    "* ; * ? ? ?",
    "it is interesting to note that if we restrict the subsets @xmath69 to single points the skeleton naturally evolves into a _ ( first - order ) voronoi tessellation_. it is the definition of the concept of skeleton @xmath81 within the specific context of grayscale images which brings us to the definition of the _ watershed transform _",
    "( see next section ) .",
    "grayscale images consist of a finite number of discrete levels .",
    "this results in a slightly more complicated situation for its segmentation . in the case of a binary image",
    "an image is segmented on the basis of a _ geodesic distance_. for the segmentation of grayscale images the distance concept needs to be generalized to that of _ topographic distance_.    * definition : * each _ watershed basin _ is the collection of points which are closer in topographic distance to the defining minimum then to any other minimum .",
    "the literature is replete with algorithms for the construction of the _ watershed transform _ of an image into its constituting _ watershed segments_. they may be divided into two classes .",
    "one class simulates the _ watershed basin _ immersion process .",
    "the second aims at detecting the watershed skeleton on the basis of the distance .",
    "_ watershed by immersion _ was introduced and defined by @xcite .",
    "the first step of the procedure concerns the identification of the minima .",
    "formally , a minimum is a plateau at altitude @xmath83 from which it is impossible to reach a point of lower height .",
    "starting with the lowest grayscale level @xmath84 and recursively proceeding to the highest level @xmath85 the algorithm allocates the zone of influence of each minimum by gradually filling up the surrounding catchment basin .    at a particular grayscale level @xmath86 , with altitude @xmath87 ,",
    "the algorithm has hypothetically inundated a landscape region with an altitude @xmath88 .",
    "the total of inundated area , @xmath89 is the complement of the section @xmath90 . having arrived at level @xmath86 and proceeding to level @xmath91 the algorithm has three possibilities ,    * encounter a new minimum ( at level @xmath91 ) *",
    "add new points to existing catchment basins ( condition : points connected to only one existing basin ) .",
    "* encounter new points that belong to several basins    situation ( 1 ) signals the event that a new minimum becomes active in the image .",
    "the second option concerns the extension of an existing basin by an additional collection of points .",
    "these are points identified at level @xmath92 which find themselves within the realm of a single basin existent at level @xmath86 .",
    "they belong to the zone of influence of @xmath93 and find themselves embedded in its extended counterpart @xmath94 at level @xmath92 . in situation",
    "( 3 ) more than one basin may be connected to the stack @xmath94 .",
    "its correct subdivision is determined by computing the influence zones of all connected basins . defining @xmath95 to be the union of all catchment basins at level @xmath86 the union of catchment basins at level @xmath92 becomes @xmath96 the watershed procedure",
    "may be viewed as iteratively computing the zone of influence at each new grey scale level .    following the rationale above the final `` immersion '' definition for the watershed @xmath97 of the image @xmath12 within a domain @xmath23 is @xmath98 on completion of the procedure the union of points attached to every minimum @xmath99 in @xmath23 is equal to the union of catchment basins , @xmath100 .",
    "the skeleton remains as the watershed segmentation .",
    "the alternative strategy for determining the watershed transform is that of following the strict definition of segmentation by minimum topographic distance . @xcite",
    "give a summary of the most notable schemes .",
    "these algorithms seek to find all points ( pixels ) whose topographic distance to a particular marker - ie .",
    "a significant minimum in the density field  is the shortest amongst that to all other markers in the image .",
    "the formalism bears some resemblance to dijkstra s graph theoretical problem of tracing the shortest path forest in a point distribution .",
    "based on this similarity an image is seen as a connected ( di)graph in which the pixels of the image function as the nodes of the graph . each point @xmath101 is reachable from each other point @xmath102 via the graph s edges .",
    "the latter usually define a network on the basis of @xmath103connectivities or @xmath104-connectivities .",
    "the shortest path between two points ( nodes ) @xmath101 and @xmath102 is found by traversing the graph and keeping track of the walking cost .",
    "critical for the procedure is the assignment of a proper measure of cost to each path . by definition",
    "it should be a non - negative increasing function and be related to the definition of topographic distance ( eq .  [ eq : topdist ] ) .",
    "this suggests the use of the quantity @xmath105 the maximum slope linking the two pixels @xmath101 and @xmath102 .",
    "this leads to the following _ cost function _ for the link between two neighbouring pixel @xmath101 and pixel @xmath102 , @xmath106 @xmath107 the total cost @xmath108 for a path @xmath109 connecting any two points @xmath110 and @xmath111 via the points @xmath112 will then simply be the sum @xmath113 the topographic distance @xmath114 is the infimum of @xmath115 over all paths connecting @xmath110 and @xmath111 .",
    "@xmath116 given this definition for the topographic distance within a grayscale image we can pursue the segmentation process described in section  [ app : segment ] , ultimately yielding the watershed segmentation .",
    "we follow the watershed transform algorithm by @xcite .",
    "their method implicitly incorporates the concept of markers .",
    "these markers are the minima used as sources of the watershed flooding procedure . as such they form a select subgroup amongst all minima of an image @xmath12 .",
    "the code for the watershed proceudre involves the following steps :    * * initialization *  all pixels of the cube are initialized and tagged to indicate they have not yet been processed .",
    "each grayscale level is allocated a queue and all pixels are attached to the queue corresponding to their level . * * minima *  each minimum plateau is tagged by a unique `` minimum tag '' .",
    "the pixels corresponding to a minimum are inserted into the corresponding queue .",
    "* * flooding *  all pixels in the grayscale level queues are processed , starting at the lowest grayscale level .",
    "unless a pixel is surrounded by a complex of unprocessed neighbours it will be assigned to the queue of the corresponding minimum .",
    "pixels which also border another minimum obtain a boundary tag .",
    "* * final stage *  for any grayscale level the flooding stops when the queue has emptied .",
    "the procedure continues with processing the pixels in the queue for the next grayscale level .",
    "the process is finished once all level queues have been emptied .",
    "voronoi clustering models are a class of heuristic models for cellular distributions of matter @xcite .",
    "they use the voronoi tessellation as the skeleton of the cosmic matter distribution , identifying the structural frame around which matter will gradually assemble during the emergence of cosmic structure .",
    "the interior of voronoi cells correspond to voids and the voronoi planes with sheets of galaxies .",
    "the edges delineating the rim of each wall are identified with the filaments in the galaxy distribution .",
    "the most outstanding structural elements are the vertices , corresponding to the very dense compact nodes within the cosmic web , the rich clusters of galaxies .",
    "we distinguish two different yet complementary approaches .",
    "one is the fully heuristic approach of voronoi element models .",
    "they are particularly apt for studying systematic properties of spatial galaxy distributions confined to one or more structural elements of nontrivial geometric spatial patterns .",
    "the second , supplementary , approach is that of the voronoi kinematic models , which attempts to `` simulate '' foamlike galaxy distributions on the basis of simplified models of the evolution of the megaparsec scale distribution .",
    "the voronoi kinematic model is based upon the notion that voids play a key organizational role in the development of structure and make the universe resemble a soapsud of expanding bubbles @xcite .",
    "it forms an idealized and asymptotic description of the outcome of the cosmic structure formation process within gravitational instability scenarios with voids forming around a dip in the primordial density field .",
    "for plausible structure formation scenarios , most notably the concordance @xmath3cdm cosmology , this evolution will proceed hierarchically . a detailed assessment of the resulting void hierarchy by @xcite demonstrated that this leads to a selfsimilarly evolving peaked void size distribution .",
    "by implication , most voids have comparable sizes and excess expansion rates .",
    "the geometrically interesting implication is that the asymptotic limit of the `` peaked '' void distribution degenerating into one of only one characteristic void size .",
    "it yields a cosmic matter distribution consisting of _ equally sized _ and expanding spherical voids , a geometrical configuration which is precisely that of a voronoi tessellation .",
    "this is translated into a scheme for the displacement of initially randomly distributed galaxies within the voronoi skeleton ( see sect .",
    "[ app : vorclustform ] for a detailed specification ) . within a void ,",
    "the mean distance between galaxies increases uniformly in the course of time .",
    "when a galaxy tries to enter an adjacent cell , the velocity component perpendicular to the cell wall disappears .",
    "thereafter , the galaxy continues to move within the wall , until it tries to enter the next cell ; it then loses its velocity component towards that cell , so that the galaxy continues along a filament .",
    "finally , it comes to rest in a node , as soon as it tries to enter a fourth neighbouring void .",
    "0.5truecm 0.2 cm      the initial conditions for the voronoi galaxy distribution are :    * distribution of @xmath117 nuclei , _ expansion centres _",
    ", within the simulation volume @xmath118 .",
    "the location of nucleus @xmath99 is @xmath119 . *",
    "generate @xmath21 model galaxies whose initial locations , @xmath120 @xmath121 , are randomly distributed throughout the sample volume @xmath118 .",
    "* of each model galaxy @xmath6 determine the voronoi cell @xmath122 in which it is located , ie .",
    "determine the closest nucleus @xmath123 .",
    "all different voronoi models are based upon the displacement of a sample of @xmath21 `` model galaxies '' .",
    "the initial spatial distribution of these @xmath21 galaxies within the sample volume @xmath118 is purely random , their initial locations @xmath120 ( @xmath124 defined by a homogeneous poisson process .",
    "a set of @xmath117 nuclei within the volume @xmath118 corresponds to the cell centres , or _",
    "expansion centres _ driving the evolving matter distribution .",
    "the nuclei have locations @xmath119 @xmath125 .    following the specification of the initial positions of all galaxies , the second stage of the procedure consists of the calculation of the complete voronoi track for each galaxy @xmath126 ( sec .",
    "[ sec : vortrack ] ) .",
    "once the voronoi track has been determined , for any cosmic epoch @xmath127 one may determine the displacement @xmath128 that each galaxy has traversed along its path in the voronoi tessellation ( sec .",
    "[ sec : vortrack ] ) .",
    "the first step of the formalism is the determination for each galaxy @xmath6 the voronoi cell @xmath122 in which it is initially located , ie . finding the nucleus @xmath123 which is closest to the galaxies initial position @xmath120 .    in the second step",
    "the galaxy @xmath6 is moved from its initial position @xmath120 along the radial path emanating form its expansion centre @xmath129 , ie . along the direction defined by the unity vector @xmath130 .",
    "dependent on how far the galaxy is moved away from its initial location @xmath120 - set by the _ radius of expansion _",
    "@xmath131 to be specified later  the galaxies path @xmath128 ( see fig .  [",
    "fig : vorkinmschm ] ) may be codified as @xmath132 in which the four different components are :    1 .",
    "@xmath130 :  unity vector path within voronoi cell @xmath122 2 .",
    "@xmath133 :  unity vector path within voronoi wall @xmath134 3 .",
    "@xmath135 :  unity vector path along voronoi edge @xmath136 4 .",
    "vertex @xmath137    the identity of the neighbouring nuclei @xmath123 , @xmath138 , @xmath139 and @xmath140 , and therefore the identity of the cell @xmath122 , the wall @xmath134 , the edge @xmath136 and the vertex @xmath137 , depends on the initial location @xmath120 of the galaxy , the position @xmath141 of its closest nucleus and the definition of the galaxies path within the voronoi skeleton .",
    "the cosmic matter distribution at a particular cosmic epoch is obtained by calculating the individual displacement factors @xmath142 for each model galaxy .",
    "these are to be derived from the global `` void '' expansion factor @xmath143 .",
    "this factor parameterizes the cosmic epoch and specifies the ( virtual ) radial path of the galaxy from its expansion centre @xmath123 .    at first , while still within the cell s interior , the galaxy proceeds according to @xmath144 as a result within a void the mean distance between galaxies increases uniformly in the course of time .",
    "once the galaxy tries to enter an adjacent cell @xmath138 and reaches a voronoi wall , i.e. when @xmath145 , the galaxy s motion will be constrained to the radial path s component within the wall @xmath134 .",
    "the galaxy moves along the wall until the displacement supersedes the extent of the path within the wall and it tries to enter a third cell @xmath139 , i.e. when @xmath146 .",
    "subsequently , it moves along @xmath136 until it comes to rest at the node @xmath137 as soon as it tries to enter a fourth neighbouring void @xmath140 when @xmath147 .",
    "a finite thickness is assigned to all voronoi structural elements .",
    "the walls , filaments and vertices are assumed to have a gaussian radial density distribution specified by the widths @xmath148 of the walls , @xmath149 of the filaments and @xmath150 of the vertices .",
    "voronoi wall galaxies are displaced according to the specified gaussian density profile in the direction perpendicular to their wall .",
    "a similar procedure is followed for the voronoi filament galaxies and the voronoi vertex galaxies . as a result",
    "the vertices stand out as three - dimensional gaussian peaks .",
    "for a detailed specification of the dtfe density field procedure we refer to @xcite . in summary ,",
    "the dtfe procedure for density field reconstruction from a discrete set of points consists of the following steps :    1 .",
    "* point sample * + given that the point sample is supposed to represent an unbiased reflection of the underlying density field , it needs to be a general poisson process of the ( supposed ) underlying density field .",
    "* boundary conditions * + the boundary conditions will determine the delaunay and voronoi cells that overlap the boundary of the sample volume .",
    "dependent on the sample at hand , a variety of options exists : 1 .",
    "_ empty boundary conditions : _ + outside the sample volume there are no points",
    "_ periodic boundary conditions : _ + the point sample is supposed to be repeated periodically in boundary boxes , defining a toroidal topology for the sample volume .",
    "_ buffered boundary conditions : _ + the sample volume box is surrounded by a bufferzone filled with a synthetic point sample .",
    "* delaunay tessellation * + construction of the delaunay tessellation from the point sample . while we also still use the voronoi - delaunay code of @xcite , at present",
    "there is a number of efficient library routines available .",
    "particularly noteworthy is the ` cgal `  initiative , a large library of computational geometry routines + 4 .",
    "* field values point sample * + the estimate of the density at each sample point is the normalized inverse of the volume of its contiguous voronoi cell @xmath151 of each point @xmath86 .",
    "the _ contiguous voronoi cell _ of a point @xmath86 is the union of all delaunay tetrahedra of which point @xmath86 forms one of the four vertices .",
    "we recognize two applicable situations : + : + the point sample is an unbiased sample of the underlying density field .",
    "typical example is that of @xmath21-body simulation particles . for @xmath152-dimensional space",
    "the density estimate is , @xmath153 with @xmath154 the weight of sample point @xmath86 , usually we assume the same `` mass '' for each point . + : + sampling density according to specified selection process . the non - uniform sampling process is quantified by an a priori known selection function @xmath155",
    "this situation is typical for galaxy surveys , @xmath155 may encapsulate differences in sampling density @xmath156 as function of sky position @xmath157 , as well as the radial redshift selection function @xmath158 for magnitude- or flux - limited surveys . for @xmath152-dimensional space",
    "the density estimate is , @xmath159 5 .",
    "* field gradient * + calculation of the field gradient estimate @xmath160 in each @xmath152-dimensional delaunay simplex @xmath99 ( @xmath161 : tetrahedron ; @xmath162 : triangle ) by solving the set of linear equations for the field values @xmath163 at the positions @xmath164 of the @xmath165 tetrahedron vertices , + @xmath166 evidently , linear interpolation for a field @xmath167 is only meaningful when the field does not fluctuate strongly .",
    "6 .   * interpolation*. + the final basic step of the dtfe procedure is the field interpolation .",
    "the processing and postprocessing steps involve numerous interpolation calculations , for each of the involved locations @xmath168 . given a location @xmath168 , the delaunay tetrahedron @xmath99 in which it is embedded is determined . on the basis of the field gradient @xmath160 the field value is computed by ( linear ) interpolation , @xmath169 in principle , higher - order interpolation procedures are also possible .",
    "two relevant procedures are : + for nn - interpolation see @xcite and @xcite .",
    "implementation of natural neighbour interpolations is presently in progress .",
    "* processing*. + though basically of the same character , for practical purposes we make a distinction between straightforward processing steps concerning the production of images and simple smoothing filtering operations and more complex postprocessing .",
    "the latter are treated in the next item .",
    "basic to the processing steps is the determination of field values following the interpolation procedure(s ) outlined above .",
    "straightforward `` first line '' field operations are _ image reconstruction _ and _ smoothing / filtering_. 1 .",
    "* image reconstruction*. + for a set of image points , usually grid points , determine the image value . formally the average field value within the corresponding gridcell . in practice",
    "a few different strategies may be followed + the choice of strategy is mainly dictated by accuracy requirements .",
    "for wvf we use the monte carlo approach in which the grid density value is the average of the dtfe field values at a number of randomly sampled points within the grid cell .",
    "smoothing * and * filtering * : + a range of filtering operations is conceivable .",
    "two of relevance to wvf are : of the field @xmath170 + convolution of the field @xmath170 with a filter function @xmath171 , usually user - specified , @xmath172 + ( see sec .  [ sec : natnghb ] ) .",
    "8 .   * post - processing*. + the real potential of dtfe fields may be found in sophisticated applications , tuned towards uncovering characteristics of the reconstructed fields .",
    "an important aspect of this involves the analysis of structures in the density field .",
    "the wvf formalism developed in this study is an obvious example ."
  ],
  "abstract_text": [
    "<S> on megaparsec scales the universe is permeated by an intricate filigree of clusters , filaments , sheets and voids , the cosmic web . for the understanding of its dynamical and hierarchical history it is crucial to identify objectively its complex morphological components . </S>",
    "<S> one of the most characteristic aspects is that of the dominant underdense voids , the product of a hierarchical process driven by the collapse of minor voids in addition to the merging of large ones .    </S>",
    "<S> in this study we present an objective void finder technique which involves a minimum of assumptions about the scale , structure and shape of voids . </S>",
    "<S> our void finding method , the watershed void finder ( wvf ) , is based upon the watershed transform , a well - known technique for the segmentation of images . </S>",
    "<S> importantly , the technique has the potential to trace the existing manifestations of a void hierarchy . </S>",
    "<S> the basic watershed transform is augmented by a variety of correction procedures to remove spurious structure resulting from sampling noise .    </S>",
    "<S> this study contains a detailed description of the wvf . </S>",
    "<S> we demonstrate how it is able to trace and identify , relatively parameter free , voids and their surrounding ( filamentary and planar ) boundaries . </S>",
    "<S> we test the technique on a set of kinematic voronoi models , heuristic spatial models for a cellular distribution of matter . </S>",
    "<S> comparison of the wvf segmentations of low noise and high noise voronoi models with the quantitatively known spatial characteristics of the intrinsic voronoi tessellation shows that the size and shape of the voids are succesfully retrieved . </S>",
    "<S> wvf manages to even reproduce the full void size distribution function .    </S>",
    "<S> [ firstpage ]    cosmology : theory  large - scale structure of universe  methods : data analysis  </S>"
  ]
}