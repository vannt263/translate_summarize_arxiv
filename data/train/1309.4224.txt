{
  "article_text": [
    "astronomical images taken with image sensors are nowadays one of the most important tools of the modern astronomy @xcite .",
    "the most popular are ccd and cmos sensors which consist of a matrix of pixels , where the light flux can be measured thanks to the photovoltaic effect @xcite . unfortunately , not every pixel can be used effectively .",
    "it is due to the possible imperfections located within the pixel .",
    "the most commonly encountered problems are : high dark current , rate saturating the pixel s potential well ; nonlinear dark current dependencies @xcite ; transient events of the dark current due to the irradiation ( especially important for flight missions ) @xcite , pixel nonlinear light response and ccd fabrication defects @xcite . in professional ccd systems",
    "there are several methods developed for investigation of the so - called bad pixels @xcite .",
    "the bad pixel masks are created to help during the image reduction .",
    "this calibration is usually repeated periodically because new bad pixels can appear .",
    "one way to reduce bad pixels impact on the image quality is to take many images with slight shifts .",
    "such a set of dithered pictures is shifted back and averaged , ignoring the pixels from the mask @xcite .",
    "unfortunately , it is not possible if there is only a single image and in such cases an interpolation over bad pixels is necessary .",
    "the most popular method is a linear interpolation which is a standard procedure in the most widespread astronomical software package : _ image reduction and analysis facility _ ( iraf ) @xcite . in this paper",
    ", we propose a new method of bad pixel interpolation for astronomical images . in chapter  [ sec:2 ]",
    "we present the data which was chosen for the methods comparison .",
    "next , in chapter  [ sec:3.1 ] , we describe most popular interpolation methods and we also introduce biharmonic interpolation algorithm as a new alternative for bad pixel correction . in chapter  [ sec:3.2 ]",
    "we summarize the methodology of our tests and discuss the results .",
    "in chapter  [ sec:4.1 ] we present our new method which is a modification of the biharmonic interpolation .",
    "the modification is dedicated especially for astronomical pictures calibration .",
    "we suggest some further enhancements which improve its effectiveness and precision .",
    "the result of our modified method compared to the original biharmonic interpolation are presented in chapter  [ sec:4.2 ] .",
    "we conclude in section  [ sec:5 ] .",
    "the verification data set made use of the astronomical images obtained by the sloan digital sky survey ( sdss ) data release 7 @xcite .",
    "the sdss uses 2.5 m ritchey - chretien telescope located at apache point observatory in new mexico .",
    "the imaging camera consists of an array of 30 ccd with total field of view of 3 degrees and operating in drift - scan imaging mode .",
    "sdss science archive server _",
    "( sas ) to download 1000 astronomical images .",
    "the images were previously calibrated by standard sdss pipeline reduction procedures .",
    "we chose sdss @xmath0 filter images located at random positions on the sky ( randomized ra and dec coordinates ) .",
    "we present exemplary image in fig",
    "five interpolation algorithms were compared with respect to pixel brightness estimation in the astronomical images : the median of the surrounding pixels , the nearest neighbor interpolation , the linear interpolation , the cubic spline interpolation and the biharmonic interpolation . the first and also the simplest method among the presented methods is the nearest neighbors interpolation .",
    "the brightness of the pixel in such a case is simply replaced by the brightness of an adjacent pixel .",
    "it is to be chosen which of four adjacent pixels to select .",
    "although the selection is arbitrary , it does not influence the overall estimation quality .",
    "the second method uses the median of surrounding pixels . in our tests , for this method , we chose the median of all 8 surrounding pixels brightness . the next method is the most popular for bad pixel interpolation in astronomical images - the linear interpolation .",
    "it is implemented in widespread astronomical software package iraf in the _ fixpix _ procedure @xcite .",
    "the interpolation is based on the linear interpolation along columns or rows of the image .",
    "in such a case simple mean value of the pixels adjacent to the bad pixel ( in a row or in a column ) is computed .",
    "again , the decision of choosing row or column interpolation does not change the mean estimation error .",
    "the spline interpolation algorithm uses piecewise polynomials , called splines , to interpolate over the bad pixel along columns or rows .",
    "it finds the smoothest curve that passes through data points @xcite . in our experiments we used cubic spline interpolation which means that we chose the third order polynomials .",
    "the last method is the biharmonic interpolation .",
    "this method has not been used for the bad pixel interpolation yet .",
    "it is based on the linear combination of green functions centered at each data point .",
    "originally , the idea was applied for geos-3 and seasat altimeter data in 1987 @xcite .      as we mentioned , we used 1000 calibrated astronomical images from sdss data server . from every single image ,",
    "two hundreds of 7x7 pixel fragments were extracted .",
    "the fragments , containing whole or only parts of astronomical objects ( e.g. stars , galaxies ) , were selected with use of a threshold - based algorithm .",
    "it prevented from choosing fragments with the image background .",
    "the objects were not centered in each fragment .",
    "we did not use any special algorithm for object classification , so both point - like and extended objects were included in our tests .",
    "the center pixel of every fragment was chosen as an unknown and its brightness was estimated using previously mentioned interpolation methods .",
    "the brightness estimation was compared with the true value to calculate an error .",
    "the error absolute and relative value histograms for given interpolation methods are presented in fig . 3 and 4 .",
    "additionally , a mean error ( _ e _ ) was computed to enable a quick comparison of the methods effectiveness .",
    "the following averaging formula was used :    @xmath1    where : @xmath2 label mean error , @xmath3  @xmath4-th estimation error ( absolute or relative ) and n  total number of estimations .",
    "we also present point - plots ( fig .",
    "5 ) to visualize dependency between the estimation error and the brightness of interpolated pixel for all tested methods .",
    "[ fig:2 ]    there is a clear difference in effectiveness between the used methods .",
    "the best results were obtained with the biharmonic interpolation with a mean error equal to 465 [ adu ] ( adu stands for analog - digital units and is a measure of signal from a ccd / cmos pixel ) and 0.063 relative , while the typically used method  linear interpolation  has an error far greater ( 872 [ adu ] and 0.125 relative ) .",
    "the basis and an implementation of the most accurate interpolation are quite simple . according to @xcite the biharmonic interpolation",
    "is based on computation of @xmath5 coefficients . for given values of the intermediate points ,",
    "the system of equations can be easily solved as it is a linear one .",
    "the biharmonic interpolation as the most accurate method was used as a starting point for further enhancement .",
    "it should be also noticed that there is no evidence of applying such an interpolation for astronomical images reduction .",
    "@xmath6    where : @xmath7  value of the interpolated function for @xmath8 coordinates , @xmath9  number of intermediate points .",
    "[ fig:3 ]    [ fig:4 ]    [ fig:5 ]",
    "the idea of the modified interpolation is based on the similarity between the objects ( both point sources like stars or extended objects like galaxies ) encountered in the astronomical pictures . according to @xcite a light from a star , as a point source ,",
    "is affected by the atmosphere ( so - called `` seeing '' ) and is blurred so that it is registered in the image not as a point but as a point - spread - function ( psf ) .",
    "the psf can be modeled by the gaussian surface @xcite .",
    "usually each star in a high quality telescope system and for more than several seconds exposure shows very similar psf",
    ". however , sometimes psf can be different due to the seeing variations during the exposure or due to the optical aberrations .",
    "our modified interpolation idea can be applied whether the psf is stable or not .",
    "we construct the database of 7x7 pixel fragments from the parts of collected images not affected by the bad pixels . because of the fact that most of the image is usually the background ,",
    "a special threshold - based selection algorithm is used again to choose as many fragments with the objects as it is possible . additionally , every fragment is rotated three times ( 90@xmath10 , 180@xmath10 , 270@xmath10 ) to extend the database and to provide for different orientation of extended objects . after the fragments acquisition , the biharmonic interpolation in every fragment is proceeded over the pixels except for the central pixel .",
    "the brightness estimation of the central pixel is compared with the true ( already known ) value and the estimation error ( @xmath11 ) is computed .",
    "the biharmonic interpolation coefficients @xmath12 and the corresponding estimation error ( @xmath11 ) are stored in the database as a single reference pair .",
    "the principle of supporting the interpolation with the database is to compare computed interpolation coefficients with the references from the database and to find the reference which is best suited .",
    "the mean square fitting error between the reference and current coefficients is used during the search .",
    "@xmath13    where : @xmath14  mean square fitting error between @xmath15-th reference and current coefficients , @xmath16  @xmath4-th coefficient of @xmath15-th reference in the database , @xmath17  @xmath4-th coefficient of the interpolation of current fragment and @xmath15  the number of the most suitable reference .",
    "after finding the best reference , the corresponding estimation error is basically subtracted from current estimation . in sum",
    ": the method uses the biharmonic interpolation and is based on a properly created database of known fragments of the image containing astronomical objects . during the interpolation , the database is searched to find the most suitable reference and to apply the corresponding correction to current brightness estimation . to improve the efficiency of the method , it is desired to find not one but a few ( in the experiments the number of 5 fragments was used ) of the most suitable references and to subtract a weighted average of the corresponding estimation errors .",
    "@xmath18    where : @xmath19  averaged estimation error , @xmath20  mean square fitting error between @xmath4-th best fitted reference and current coefficients , @xmath21 - estimation error of @xmath4-th best fitted reference .",
    "another additional improvement is to normalize every fragment before any interpolation - during the database creation and during a bad pixel correction .",
    "the normalization enables to compare fragments of very bright objects with dimmer ones .",
    "the bad pixel estimated brightness in such a solution has to be followed by a simple renormalization .",
    "@xmath22    @xmath23    where : @xmath24  normalized pixel brightness ; @xmath25  real pixel brightness ; @xmath26 , @xmath27  minimal and maximal real brightness among the pixels in a fragment .",
    "the database was created using fragments from the first 10 pictures from the previously mentioned sdss image set .",
    "other images ( 990 pictures ) were used as a verification set .",
    "the results are presented for three modified interpolation types ( without averaging and normalization , with averaging and with averaging and normalization ) and for the original biharmonic interpolation without modification ( fig .",
    "and 7 ) . in another test",
    ", it was examined if the modified interpolation can be useful for a single image correction .",
    "it means that the database had to be created from the parts of an image that were not affected by faulty pixels .",
    "six randomly chosen images from the sdss survey were used .",
    "80% of the 7x7 pixel fragments were used as a database and the remaining 20% were the test set .",
    "the results are resented in fig .",
    "additionally we compared the effectiveness of the method for the individual frame correction using database constructed from the same frame ( minimal database ) and from other 20 frames ( large database ) .",
    "we analyzed 50 images for this test .",
    "the results are presented in fig .",
    "9 . and 10 .",
    "the mean error for the test with a large database showed about 50% decrease after using the modified interpolation idea . according to the histograms ( fig . 6 and 7 )",
    "the number of small errors rose and the number of large errors decreased as the modified interpolation was used .",
    "the proposed enhancements improved also the results of the method .",
    "it was shown that both enhancements reduced the mean error by about the same value ( 20 [ adu ] ) . however , in terms of relative error , the normalization improved the precision only slightly ( form 0.044 to 0.042 ) in comparison to the weighting improvement ( from 0.042 to 0.032 ) .",
    "[ fig:6 ]    [ fig:7 ]    [ fig:8 ]    [ fig:9 ]    [ fig:10 ]    the modified interpolation seems to work well also as a single image correction , where the database has to be created from fragments of the same image .",
    "however , with such a minimal database , the estimation improvement will be strongly dependent on the image and the positions of bad pixels ( fig .",
    "8) . for our set of 50 images ,",
    "the use of larger database improved the estimation error noticeably ( fig .",
    "9 and 10 ) .",
    "however it is to be mentioned , that for the images affected by strong psf variation ( e. g. due to the seeing problems ) , the results would be different .",
    "in the article a comparison of some interpolation methods of bad - pixels correction in astronomical images was presented .",
    "the images from the sloan digital sky survey were used as an examination set .",
    "the biharmonic interpolation as the most accurate method was enhanced with the idea of supporting it with a database of known astronomical image fragments .",
    "the test with a large database and a minimal database proved the effectiveness of the method as a pixel s brightness estimator and its superiority over other interpolation methods examined in our tests .",
    "moreover , the biharmonic interpolation has not been used for the astronomical images interpolation yet . with the supporting idea applied , its accuracy was about 4 times higher than for the linear interpolation , which is typically used for the astronomical image calibration .",
    "it should be added that the modified interpolation idea is flexible and it could be applied to any current or future interpolation method .      we want to thank dr .",
    "agnieszka pollo ( astronomical observatory of jagielonian university ) for numerous useful advises .",
    "we also thank anonymous referee for useful and constructive comments which allowed to improve the manuscript significantly .",
    "funding for the sdss and sdss - ii has been provided by the alfred p. sloan foundation , the participating institutions , the national science foundation , the u.s .",
    "department of energy , the national aeronautics and space administration , the japanese monbukagakusho , the max planck society , and the higher education funding council for england .",
    "s. k. saha , `` detectors for the astronomical applications '' , international conference on emerging trends in electronic and photonic devices & systems , bangalore , india , dec .",
    "22 - 24 , 2009 , pp .",
    "442 - 445 i. s. mclen , `` electronic imaging in astronomy : detectors and instrumentation '' , springer - praxis publishing , chichester , uk , 2008 d. litwiller , `` ccd vs cmos : facts and fiction '' , photonics spectra , no .",
    "154 - 158 , 2001 j. r. janesick , `` scientific charge coupled devices '' , spie press monograph , vol .",
    "pm83 , 2001 g. s. hobson , `` charge - transfer devices '' , john wiley and sons inc . , new york , 1978 r. widenhorn , j.c .",
    "dunlap , e. bodegom , `` exposure time dependence of dark current in ccd imagers '' , ieee transactions on electron devices , vol .",
    "3 , pp . 581 - 587 , 2010 j. c. dunlap , m.m .",
    "blouke , e. bodegom , r. widenhorn , `` modeling nonlinear dark current behaviour in ccds '' , ieee transactions on electron devices , vol .",
    "4 , pp . 1114 - 1122 , 2012 a. popowicz , `` ccd dark current analysis '' , przeglad elektrotechniczny ( electrical review ) , vol .",
    "4 , pp . 260 - 263 , 2011 a. popowicz , `` a correction algorithm for dark current in ccds '' , przeglad elektrotechniczny ( electrical review ) , vol .",
    "318 - 320 , 2011 g. r. hopkinson , v. goiffon , a. mohammedzadeh , `` random telegraph signals in proton irradiated ccds and aps '' , ieee transactions on nuclear science , vol .",
    "2197 - 2204 , 2008 g. r. hopkinson , c.j .",
    "dale , marshall p.w .",
    ", `` proton effects in charge - coupled devices '' , ieee transactions on nuclear science , vol .",
    "614 - 627 , 1996 b. hilbert , `` wfc3/ir cycle 19 bad pixel table update '' , instrument science report wfc3 2012 - 10 `` , space telescope science institute , jun . 08 , 2012 b. hilbert , l. petro , ' ' wfc3/ir dark current stability , instrument science report wfc3 2012 - 11 `` , space telescope science institute , jun . 11 , 2012 a. s. fruchter , r.n",
    ". hook , ' ' drizzle : a method for the linear reconstruction of undersampled images `` , , vol .",
    "144 - 152 , 2002 p. massey , ' ' a user s guide to ccd reductions with iraf `` , instruction manual for iraf software package , 1997 d. g york .",
    "et al . , ' ' the sloan digital sky survey : technical summary `` , , vol .",
    "1579 - 1587 , 2000 a. s. szalay , ' ' the sloan digital sky survey `` , computing in science & engineering , vol . 1 , no .",
    "54 - 62 , 1999 j. h. ahlberg , e.n .",
    "nilson , j.l .",
    "walsh , ' ' the theory of splines and their applications `` academic press , new york , 1967 d. t. sandwell , ' ' biharmonic spline interpolation of geos-3 and seasat altimeter data `` , geophysical research letters , vol .",
    "139 - 142 , 1987 j. pan , c. zhang , ' ' an efficient object detection method for large ccd astronomical images \" , congress on image and signal processing , jinan , china , oct .",
    "17 - 19 , 2009 , pp.1 - 4"
  ],
  "abstract_text": [
    "<S> we present a new method of interpolation for the pixel brightness estimation in astronomical images . </S>",
    "<S> our new method is simple and easily implementable . </S>",
    "<S> we show the comparison of this method with the widely used linear interpolation and other interpolation algorithms using one thousand astronomical images obtained from the sloan digital sky survey . </S>",
    "<S> the comparison shows that our method improves bad pixels brightness estimation with four times lower mean error than the presently most popular linear interpolation and has a better performance than any other examined method . </S>",
    "<S> the presented idea is flexible and can be also applied to presently used and future interpolation methods . </S>",
    "<S> the proposed method is especially useful for large sky surveys image reduction but can be also applied to single image correction . </S>"
  ]
}