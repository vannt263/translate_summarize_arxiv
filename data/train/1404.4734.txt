{
  "article_text": [
    "a hamilton cycle of a graph @xmath8 is a cycle which passes through every vertex of @xmath8 exactly once .",
    "a graph is said to be _ hamiltonian _ if it admits a hamilton cycle .",
    "hamiltonicity is one of the most central notions in graph theory , and has been intensively studied by numerous researchers for many years .",
    "the problem of deciding whether a graph is hamiltonian or not is one of the np - complete problems that karp listed in his seminal paper  @xcite , and , accordingly , one can not hope for a simple classification of such graphs .",
    "it is thus important to find generally applicable sufficient conditions for graphs to be hamiltonian and in the last 60 years many interesting results were obtained in this direction .",
    "one of the first results of this type is the celebrated theorem of dirac  @xcite , asserting that every graph on @xmath9 vertices with minimum degree at least @xmath1 ( such graphs are called dirac graphs ) is hamiltonian .",
    "dirac s theorem provides a natural and easy to check sufficient condition for the hamiltonicity of graphs with very high minimum degree . on the other hand ,",
    "there are of course hamiltonian graphs with minimum degree 2 .",
    "therefore , while dirac s theorem is sharp in general , one would like to have sufficient conditions for the hamiltonicity of sparser graphs .",
    "when looking for such sufficient conditions , it is natural to consider random graphs with an appropriate edge probability .",
    "erds and rnyi  @xcite raised the question of what the threshold probability of hamiltonicity in random graphs is .",
    "after a series of efforts by various researchers , including korshunov  @xcite and psa  @xcite , the problem was finally solved by komls and szemerdi  @xcite and independently by bollobs  @xcite , who proved that if @xmath10 , where @xmath11 tends to infinity with @xmath0 arbitrarily slowly , then @xmath12 is asymptotically almost surely ( or a.a.s . for brevity ) hamiltonian .",
    "note that this is best possible since for @xmath13 a.a.s .",
    "there are vertices of degree at most one in @xmath12 ( see , e.g.  @xcite ) .",
    "an even stronger result was obtained by bollobs  @xcite .",
    "he proved that for the random graph process , the hitting time for hamiltonicity is exactly the same as the hitting time for having minimum degree 2 , that is , a.a.s . the very edge which increases the minimum degree to 2",
    "also makes the graph hamiltonian .    in recent years",
    "there has been a lot of interest in proving that certain families of graphs , like dirac graphs or random graphs , are hamiltonian in some robust sense .",
    "results in this direction include showing that such graphs admit not only one hamilton cycle but many ( see , e.g.  @xcite ) , that they admit many pairwise edge - disjoint hamilton cycles ( see , e.g.  @xcite ) , that a player can claim all edges of a hamilton cycle of these graphs , even when facing an optimal adversary ( see , e.g.  @xcite ) , and many more .",
    "the measure of how robust a graph is with respect to hamiltonicity that we use in this paper is via the notion of _ local resilience _ , which was introduced by vu and the third author in  @xcite .",
    "let @xmath8 be a simple graph and let @xmath14 be a monotone increasing graph property .",
    "the _ local resilience _ of @xmath8 with respect to @xmath14 , denoted by @xmath15 , is the smallest non - negative integer @xmath16 such that one can obtain a graph which does not satisfy @xmath14 by deleting at most @xmath16 edges at every vertex of @xmath8 .",
    "namely ,    @xmath17    let @xmath18 denote the graph property of being hamiltonian . using the notion of local resilience",
    ", one can restate the aforementioned results of dirac  @xcite as @xmath19 . following a series of results ( see  @xcite ) ,",
    "it was proved by lee and sudakov  @xcite that a.a.s .",
    "@xmath20 for every @xmath21 .",
    "this is a far reaching generalization of dirac s theorem , since a complete graph is also a random graph @xmath12 with @xmath22 .    in this paper",
    "we aim to prove analogous results for directed graphs ( or digraphs for brevity ) .",
    "similarly to the case of undirected graphs , we define the local resilience of a digraph @xmath23 with respect to a monotone increasing digraph property @xmath14 to be the smallest non - negative integer @xmath16 such that one can obtain a digraph which does not satisfy @xmath14 by deleting at most @xmath16 out - going arcs and at most @xmath16 in - going arcs at every vertex of @xmath23 .",
    "namely , @xmath24    for a positive integer @xmath0 and @xmath25 , let @xmath2 denote the probability space of random labeled _ directed _ graphs with vertex set @xmath26 : = \\{1,2 , \\ldots , n\\}$ ] .",
    "that is , for every ordered pair @xmath3 with @xmath27 we flip a coin , all coin flips being mutually independent . with probability @xmath4",
    "we include the arc @xmath3 in our digraph and with probability @xmath28 we do not . by abuse of notation",
    "we sometimes use @xmath2 to denote a single element of the space @xmath2 .",
    "we also use @xmath18 to denote the _ digraph _ property of being hamiltonian , that is , a digraph @xmath23 satisfies @xmath29",
    "if and only if @xmath23 admits a directed hamilton cycle .    similarly to the aforementioned results of komls and szemerdi and of bollobs regarding the hamiltonicity of random undirected graphs , results of mcdiarmid  @xcite and frieze  @xcite imply that a.a.s .",
    "@xmath30 is hamiltonian for every @xmath31 but admits no hamilton cycles when @xmath32 .",
    "moreover , a classical analog of dirac s theorem for directed graphs was proved in 1960 by ghouila - houri  @xcite .",
    "it asserts that every directed graph on @xmath0 vertices with minimum out - degree and in - degree at least @xmath1 contains a directed hamilton cycle . stating this result in terms of local resilience we have that @xmath33 .",
    "hence it is natural to ask whether one can generalize the theorem of ghouila - houri to sparse random directed graphs , similar to the generalization of dirac s theorem proved by lee and sudakov in  @xcite . in this paper",
    "we obtain such a result for every @xmath4 which is not too small .",
    "[ directedham ] for every fixed @xmath34 , if the arc probability of the random digraph @xmath2 satisfies @xmath35 , then a.a.s .",
    "@xmath36      for the sake of simplicity and clarity of presentation , we do not make a particular effort to optimize some of the constants obtained in our proofs .",
    "we also omit floor and ceiling signs whenever these are not crucial .",
    "most of our results are asymptotic in nature and whenever necessary we assume that @xmath0 is sufficiently large . throughout the paper",
    ", @xmath37 stands for the natural logarithm , unless explicitly stated otherwise .",
    "we say that a graph property @xmath14 holds _ asymptotically almost surely _ , or a.a.s . for brevity ,",
    "if the probability of satisfying @xmath14 tends to 1 as the number of vertices @xmath0 tends to infinity . our graph - theoretic notation is standard and follows that of  @xcite . in particular , we use the following .    for a directed graph ( or _",
    "digraph _ for brevity ) @xmath23 , let @xmath38 and @xmath39 denote its sets of vertices and arcs respectively , and let @xmath40 and @xmath41",
    ". for a set @xmath42 , let @xmath43 denote the set of arcs of @xmath23 with both endpoints in @xmath44 , and let @xmath45 .",
    "for disjoint sets @xmath46 , let @xmath47 denote the set of arcs of @xmath23 which are oriented from some vertex of @xmath44 towards some vertex of @xmath48 , and let @xmath49 .",
    "let @xmath50 denote the _ directed density _ of the ordered pair @xmath51 in @xmath23 . for a vertex @xmath52 and a set @xmath53",
    "let @xmath54 denote the set of _ out - neighbors _ of @xmath55 in @xmath56 , and let @xmath57 denote the set of _ in - neighbors _ of @xmath55 in @xmath56 , and let @xmath58 .",
    "let @xmath59 .",
    "we abbreviate @xmath60 to @xmath61 , @xmath62 to @xmath63 , and @xmath64 to @xmath65 .",
    "moreover , @xmath61 is referred to as the out - degree of @xmath55 , @xmath63 is referred to as the in - degree of @xmath55 , and @xmath65 is referred to as the degree of @xmath55 .",
    "let @xmath66 and @xmath67 denote the minimum out - degree of @xmath23 , the minimum in - degree of @xmath23 , and the minimum degree of @xmath23 , respectively .",
    "similarly , let @xmath68 and @xmath69 denote the maximum out - degree of @xmath23 , the maximum in - degree of @xmath23 , and the maximum degree of @xmath23 , respectively .",
    "for disjoint sets @xmath70 , let @xmath71 , and similarly let @xmath72 .",
    "sometimes , if there is no risk of confusion , we discard the subscript @xmath23 in the above notation .    throughout the paper",
    "we will make use of the following well - known bounds on the lower and upper tails of the binomial distribution due to chernoff ( see e.g.  @xcite ) .",
    "[ th::chernoff ] let @xmath73 , let @xmath74 and let @xmath75 . then    ( i ) : :    @xmath76 . (",
    "ii ) : :    @xmath77 .",
    "( iii ) : :    @xmath78 .",
    "( iv ) : :    @xmath79 .",
    "the rest of this paper is organized as follows . in section  [ sec::outline ]",
    "we briefly outline some of the main ideas of our proof of theorem  [ directedham ] . in section  [ sec::directregularity ]",
    "we discuss some tools that will be used in the proof of theorem  [ directedham ] , most notably , the sparse diregularity lemma . in section  [ sec::randomdigraphs ]",
    "we prove various properties of random directed graphs that will be used in the proof of theorem  [ directedham ] . in section  [ sec::proofmain ]",
    "we prove theorem  [ directedham ] .",
    "finally , in section  [ sec::openprob ] we present some open problems .",
    "since our proof of the lower bound in theorem  [ directedham ] is quite involved , we first sketch very briefly some of its main ideas . some of the concepts and tools we use ,",
    "will only be stated precisely and proved in the following sections .",
    "we start by considering the case of constant @xmath4 and then describe some of the additional difficulties which arise if one allows @xmath80 .",
    "let @xmath81 and let @xmath82 be a digraph obtained from @xmath23 by deleting at each vertex @xmath52 at most @xmath83 out - going arcs and at most @xmath84 in - going arcs .",
    "note that both the out - degree and the in - degree in @xmath23 of every vertex @xmath85 is a.a.s .",
    "roughly @xmath86 and therefore both the out - degree and the in - degree in @xmath87 of every vertex @xmath85 is a.a.s .",
    "at least @xmath88 .",
    "apply the directed regularity lemma ( see section  [ sec::directregularity ] for more details ) to @xmath82 with appropriate parameters .",
    "let @xmath89 be the corresponding @xmath90-regular partition .",
    "for some appropriately chosen @xmath91 let @xmath92 be the corresponding regularity digraph ; that is , the directed graph with vertex set @xmath93 such that for every @xmath94 , @xmath95 is an arc of @xmath96 if and only if @xmath97 is @xmath90-regular with directed density at least @xmath98 .",
    "we claim that @xmath96 contains a subgraph @xmath99 on at least @xmath100 vertices and with minimum out - degree and in - degree at least @xmath101 . indeed , suppose not .",
    "then by recursively deleting vertices whose out - degree or in - degree is strictly smaller than half the number of vertices , we would delete at least @xmath102 vertices . by symmetry",
    "we may assume that half of them have too small an in - degree . by assuming that @xmath90 is sufficiently small compared to @xmath103 we see that the majority of these missing arcs correspond to @xmath90-regular pairs and thus have to have density less than  @xmath98 .",
    "if we now assume that @xmath103 is sufficiently small compared to @xmath104 , one can check that it follows that in order to obtain @xmath87 from @xmath23 we have deleted strictly more than @xmath105 in - going arcs at some vertex @xmath52 , contrary to our assumption . by ghouila - houri s theorem  @xcite ( see theorem  [ th::corofgh ] ) the subgraph @xmath99 is hamiltonian .",
    "equivalently , there exists an almost spanning cycle @xmath106 of @xmath96 .",
    "this corresponds to a directed `` cycle '' @xmath107 of @xmath87 .",
    "note that , by the definition of @xmath96 , the pair @xmath108 is @xmath90-regular with positive directed density for every @xmath109 .    in order to build a directed hamilton cycle of @xmath87",
    ", we will first build an almost spanning cycle @xmath110 and then absorb all the remaining vertices . in order to add some vertex @xmath55 to @xmath110 we will find an arc @xmath111 such that @xmath112 and @xmath113 and",
    "will then remove @xmath114 from @xmath110 and add to it @xmath115 and @xmath116 . in order for this to work , when building @xmath110 we will have to ensure that there exists a pairing ( in the sense suggested above ) of all vertices of @xmath117 with certain arcs of @xmath110 ; we refer to this as our _ main task_. from now on we focus on building @xmath110 .",
    "we build @xmath110 by continuously moving around @xmath118 until we nearly exhaust all of the sets @xmath119 .",
    "we always choose only _ nice _ vertices , that is , vertices that have roughly the right number of out - neighbors in the next set along @xmath118 .",
    "thinking ahead to the moment at which we will want to close the directed path we are building into a directed cycle , we start building @xmath110 at a vertex @xmath120 which , in addition to being nice , is also _ backwards nice _ , that is , it has roughly the right number of in - neighbors in @xmath121 . we refrain from touching some predetermined subset of those in - neighbors until we attempt to close the directed path we built into a directed cycle .    in the digraph @xmath23 a _ typical _ vertex @xmath55 has roughly @xmath122 in - neighbors and roughly @xmath122 out - neighbors in @xmath119 for every @xmath109 .",
    "a simple calculation shows that a.a.s .",
    "there is only a very small number of atypical vertices .",
    "our first task is to build a directed path which includes all of these atypical vertices .",
    "let @xmath55 be an arbitrary atypical vertex which we wish to add to the path we have built thus far .",
    "it follows by the aforementioned lower bounds on the minimum in - degree and the minimum out - degree of @xmath87 that there must exist indices @xmath123 such that @xmath55 has many in - neighbors in @xmath124 and many out - neighbors in @xmath125 .",
    "we walk along @xmath118 ( always choosing nice vertices as described above ) until we reach @xmath124 . using regularity",
    "we can ensure that we enter @xmath124 in an in - neighbor of @xmath55 .",
    "we can thus add @xmath55 to the path and proceed to a nice vertex of @xmath125 . once all atypical vertices are included in the path we focus on our main task .",
    "we continue moving along @xmath118 as before except that , at every step , the new vertex we add to the path is chosen uniformly at random from all nice vertices . using this randomness",
    "we wish to show that for every vertex @xmath55 which will not be included in @xmath110 , there will be many times in which we claim an in - neighbor of @xmath55 followed by an out - neighbor of @xmath55 ; each such time is referred to as a _",
    "successful trial_. in our analysis we use known bounds on the tail of the binomial distribution .",
    "hence , in order to ensure the independence of trials which is needed for the binomial distribution and in order to bound from below the probability that a single trial is successful , we will only consider arcs of @xmath110 which are far from each other , as trials for each specific vertex @xmath126 .    once the path we built is sufficiently long , we close it into a cycle . in order to do",
    "so we simply walk along the cycle @xmath118 until we reach @xmath127 . using regularity",
    "we can now extend the path by two more arcs such that the second arc touches some @xmath128 which is an in - neighbor of @xmath129 . claiming @xmath130 completes the cycle @xmath110 .",
    "our random procedure for building ( the main part of ) the directed path ( see above ) ensures that a.a.s .",
    "there will be strictly more than @xmath131 successful trials for every vertex @xmath126 .",
    "we can therefore greedily add all the vertices of @xmath117 to our directed cycle .    when @xmath80 we use a sparse version of the directed regularity lemma ( see lemma  [ diregularity ] ) .",
    "the main difficulty in applying this lemma is that now @xmath132 .",
    "hence , we have to ensure regularity of very small sets .",
    "this is done in proposition  [ regularsmallsets ] and corollary  [ cor::regularityofsmallpairs ] .",
    "however we can not ensure regularity of all small sets .",
    "this leads to the introduction of more atypical vertices ( see the definitions of bad vertices of type i and ii in section  [ sec::randomdigraphs ] ) .",
    "we will include some of these vertices in the initial segment of our directed path while intentionally avoiding others until the final stage of absorbing all remaining vertices .",
    "since there are now many atypical vertices and , on the other hand , the size of a neighborhood of a vertex is very small , we might end up exhausting the neighborhood of some vertex already at an early stage .",
    "if such a vertex is not included in @xmath110 we might not be able to add it to the cycle . in order to avert this danger",
    "we will include all such vertices in the initial segment of our directed path as well .",
    "while our main task remains essentially the same , our success in fulfilling it will be much more limited .",
    "in particular , the number of successful trials per vertex of @xmath117 will be strictly smaller than @xmath131 .",
    "hence , in order to obtain the required pairing of all vertices of @xmath117 with certain arcs of @xmath110 , we will use hall s theorem and the fact that @xmath87 is a subdigraph of a random directed graph .",
    "the sparse diregularity lemma , due to kohayakawa  @xcite , is a version of szemerdi s regularity lemma ( see  @xcite ) for sparse directed graphs . before stating the lemma",
    ", we introduce the relevant terminology .",
    "let @xmath133 be a directed bipartite graph with bipartition @xmath134 , let @xmath135 and let @xmath136 .",
    "we say that the _ ordered _ pair @xmath51 is _",
    "@xmath137-regular _ if @xmath138 holds for every @xmath139 and every @xmath140 such that @xmath141 and @xmath142 .",
    "if @xmath51 is @xmath143-regular , where @xmath144 , then we say that @xmath51 is @xmath145-regular .",
    "the following two observations follow directly from the definition of @xmath137-regularity .",
    "[ obs::regularity1 ] let @xmath146 and @xmath147 . if @xmath51 is @xmath148-regular , then it is also @xmath149-regular .",
    "[ obs::regularity2 ] if @xmath51 is @xmath137-regular and @xmath150 is a real number ( which might depend on @xmath44 and @xmath48 ) , then @xmath51 is also @xmath151-regular .",
    "let @xmath152 be a digraph .",
    "a partition @xmath89 of @xmath153 in which the , possibly empty , set @xmath154 has been singled out as an exceptional set , is called an @xmath137-_regular partition _ if it satisfies the following conditions :    @xmath155 : :    @xmath156 ; @xmath157 : :    @xmath158 ; @xmath159 : :    all but at most @xmath160 of the pairs    @xmath97 , where @xmath94 ,    are @xmath137-regular .    [ fewlowdegvertices ] it follows from property @xmath159 above that , if @xmath89 is an @xmath137-_regular partition _ , then there are at most @xmath161 indices @xmath162 for which there are at least @xmath161 indices @xmath163 such that @xmath164 is not @xmath137-regular . similarly , there are at most @xmath161 indices @xmath162 for which there are at least @xmath161 indices @xmath163 such that @xmath165 is not @xmath137-regular .",
    "let @xmath166 and @xmath167 be real numbers .",
    "a digraph @xmath152 is said to be",
    "_ @xmath168-bounded _ if @xmath169 holds for every pair of disjoint sets @xmath170 such that @xmath171 .",
    "[ @xmath172isbounded ] let @xmath0 be a positive integer and let @xmath173 .",
    "it is easy to see that @xmath2 is a.a.s .",
    "@xmath168-bounded for any fixed @xmath174 and @xmath167 .",
    "[ sparse diregularity lemma ] [ diregularity ] for every positive integer @xmath175 , and every real numbers @xmath136 and @xmath167 , there exist integers @xmath176 and @xmath177 and a real number @xmath178 , such that for every @xmath135 , every @xmath168-bounded digraph of order @xmath179 admits an @xmath137-regular partition @xmath89 , where @xmath180 .",
    "let @xmath152 be a directed graph and let @xmath91 be a parameter .",
    "given an @xmath137-regular partition @xmath89 of @xmath153 , we define the _ regularity digraph _",
    "@xmath181 to be the directed graph with vertex set @xmath93 such that for every @xmath94 , @xmath95 is an arc of @xmath96 if and only if @xmath97 is @xmath137-regular with directed density at least @xmath98 .",
    "note that two ordered @xmath137-regular pairs @xmath182 and @xmath183 in the partition might have different directed densities .",
    "while this is not really a problem , it would be convenient to assume that all ordered regular pairs with positive density have the same directed density .",
    "this can be done by applying the following lemma from  @xcite .",
    "[ lem::gs ] for every @xmath184 there exists a constant @xmath185 such that any @xmath145-regular graph @xmath186 contains a @xmath187-regular subgraph @xmath188 with @xmath189 edges for all @xmath175 satisfying @xmath190 .",
    "the following proposition asserts that most small subsets of regular pairs are also regular .",
    "[ regularsmallsets ] for every @xmath191 , there exist @xmath192 and @xmath193 such that , for any @xmath194 , the following holds .",
    "suppose that @xmath195 is a bipartite digraph such that @xmath196 is @xmath145-regular with directed density @xmath197 , and suppose that @xmath198 is an integer .",
    "then the number of sets @xmath199 of size @xmath200 that contain a set @xmath201 of size at least @xmath202 for which @xmath203 is @xmath204-regular with directed density @xmath205 satisfying @xmath206 is at least @xmath207 .",
    "similarly , the number of sets @xmath208 of size @xmath200 that contain a set @xmath201 of size at least @xmath202 for which @xmath209 is @xmath204-regular with directed density @xmath205 satisfying @xmath206 is at least @xmath210 .",
    "the analogous statement for undirected graphs was proved in  @xcite .",
    "since we only care about the arcs of @xmath23 oriented from @xmath211 to @xmath212 , proposition  [ regularsmallsets ] is equivalent to theorem 3.7 from  @xcite .    in section  [ sec::randomdigraphs ]",
    "we will need the following corollary of proposition  [ regularsmallsets ] .",
    "[ cor::regularityofsmallpairs ] for every @xmath191 , there exist @xmath192 and @xmath213 such that , for any @xmath194 , the following holds .",
    "suppose that @xmath195 is a bipartite digraph such that @xmath196 is @xmath145-regular with directed density @xmath197 , and suppose that @xmath214 are integers .",
    "then the number of pairs @xmath215 such that    ( i ) : :    @xmath216 ,    @xmath217 and ( ii ) : :    there exist @xmath218 of size at least    @xmath219 and    @xmath220 of size at least    @xmath221 such that the pair    @xmath222 is    @xmath204-regular with directed density    @xmath223 satisfying    @xmath224    is at least @xmath225 .",
    "let @xmath226 and @xmath227 be the constants whose existence follows from proposition  [ regularsmallsets ] and let @xmath228 .",
    "let @xmath229 and @xmath230 be the constants whose existence follows from proposition  [ regularsmallsets ] .",
    "let @xmath231 , let @xmath232 and fix some @xmath194 .",
    "let @xmath233 denote the family of all sets @xmath234 of size @xmath235 for which there exists a set @xmath236 of size at least @xmath237 such that the pair @xmath238 is @xmath239-regular with directed density @xmath205 for some @xmath206 .",
    "clearly @xmath240 .",
    "let @xmath241 .",
    "since @xmath242 , it follows by proposition  [ regularsmallsets ] that @xmath243 .",
    "hence there are at most @xmath244 pairs @xmath245 which do not satisfy condition ( ii ) of corollary  [ cor::regularityofsmallpairs ] .",
    "fix some arbitrary @xmath246 .",
    "let @xmath236 be a set of size at least @xmath237 such that the pair @xmath238 is @xmath239-regular with directed density @xmath205 for some @xmath206 .",
    "note that @xmath247 since @xmath248 .",
    "since @xmath249 , it follows by proposition  [ regularsmallsets ] that the number of sets @xmath250 such that for every @xmath251 of size at least @xmath252 the pair @xmath253 is not @xmath204-regular with directed density @xmath223 for any @xmath254 is at most @xmath255 . since @xmath256 and @xmath206 it follows that the number of sets @xmath250 such that for every @xmath251 of size at least @xmath252 the pair @xmath253 is not @xmath204-regular with directed density @xmath223 for any @xmath224 is also at most @xmath255 .",
    "multiplying this bound by the size of @xmath233 , it follows that there are at most @xmath257 pairs @xmath258 which do not satisfy condition ( ii ) of corollary  [ cor::regularityofsmallpairs ] .",
    "we conclude that the number of pairs @xmath215 such that @xmath259 is of size @xmath260 and @xmath261 is of size @xmath235 which do not satisfy condition ( ii ) of corollary  [ cor::regularityofsmallpairs ] is at most @xmath262    the following simple lemma is an immediate corollary of the definition of @xmath137-regularity .",
    "[ smalldegreevertices ] let @xmath51 be an @xmath145-regular pair with directed density @xmath263 .",
    "let @xmath139 and @xmath140 be sets of size @xmath141 and @xmath142 .",
    "then @xmath264 for all but at most @xmath265 vertices @xmath266 and @xmath267 for all but at most @xmath265 vertices @xmath266 . similarly , @xmath268 for all but at most @xmath269 vertices @xmath270 and @xmath271 for all but at most @xmath269 vertices @xmath270 .",
    "a ( straightforward ) proof for the analogous statement for undirected graphs can be found e.g.  in  @xcite .",
    "since we only care about the arcs oriented from @xmath44 to @xmath48 , lemma  [ smalldegreevertices ] is essentially equivalent to lemma 4.1 from  @xcite .",
    "in this section we collect several results about random directed graphs which we will need later in the proof of our main theorem .",
    "[ badset ] let @xmath0 be a positive integer and let @xmath272 .",
    "let @xmath136 be arbitrarily small , let @xmath273 be a constant , and let @xmath274 . for a set @xmath275 , let @xmath276 denote the set of all vertices @xmath277 for which @xmath278 or @xmath279 .",
    "let @xmath280 , then a.a.s . @xmath281 .",
    "let @xmath85 be any vertex and let @xmath282 be any set of size at least @xmath283 .",
    "note that @xmath284 and similarly @xmath285 .",
    "thus @xmath286 .",
    "it follows by theorem  [ th::chernoff ] ( iii ) that @xmath287 is bounded from above by @xmath288 , where @xmath289 is an appropriate constant , and the same holds for @xmath290 as well .",
    "hence , @xmath291    [ lem::degreetoohigh ] let @xmath292 be a constant , let @xmath0 be a positive integer , let @xmath35 and let @xmath274 .",
    "let @xmath293 be an integer satisfying @xmath294 . then a.a.s .",
    "( i ) : :    for every @xmath295 of size    @xmath296 we have    @xmath297 . ( ii ) : :    for every @xmath295 of size    @xmath298 we have    @xmath299 .    starting with ( i ) ,",
    "let @xmath300 be an arbitrary set of size @xmath301 .",
    "clearly @xmath302 and thus @xmath303 .",
    "it follows by theorem  [ th::chernoff ] ( ii ) that @xmath304 .",
    "we conclude that the probability that there exists a set @xmath44 of size @xmath296 and a disjoint set @xmath305 of size @xmath301 such that @xmath306 for every @xmath307 is at most @xmath308 where the last equality follows by our assumption that @xmath294 .",
    "similarly for ( ii ) , let @xmath300 be an arbitrary set of size @xmath309 .",
    "clearly @xmath302 and thus @xmath310 .",
    "it follows by theorem  [ th::chernoff ] ( iv ) that @xmath311 .",
    "we conclude that the probability that there exists a set @xmath44 of size @xmath298 and a disjoint set @xmath305 of size @xmath309 such that @xmath312 for every @xmath307 is at most @xmath313 where the second inequality holds since @xmath314 and the last equality follows by our assumption that @xmath294 .",
    "the following two lemmas will be useful in stage 4 of the proof of the main result , where we will want to extend a long cycle to a hamilton cycle .",
    "[ lem::edgedistribution ] let @xmath104 and @xmath103 be positive real numbers satisfying @xmath315 .",
    "let @xmath0 be a positive integer , let @xmath316 and let @xmath81 . then a.a.s .",
    "the following holds for every @xmath317 $ ] of size @xmath318 and every set @xmath319 of @xmath320 arcs with both endpoints in @xmath26 \\setminus s$ ] which span a digraph with maximum out - degree one and maximum in - degree one : there are less than @xmath321 pairs @xmath322 such that @xmath323 and @xmath324 .",
    "fix sets @xmath325 and @xmath319 as in the statement of the lemma . given a vertex @xmath326 and an arc @xmath327 , let @xmath328 denote the event : `` @xmath323 and @xmath324 '' .",
    "note that    1 .",
    "@xmath329 holds for every @xmath326 and every arc @xmath330 .",
    "2 .   if @xmath331 are vertices in @xmath325 and @xmath332 are not necessarily distinct arcs in @xmath319 , then the events @xmath333 and @xmath334 are independent .",
    "3 .   if @xmath326 and @xmath335 are two disjoint or anti - parallel arcs , then the events @xmath328 and @xmath336 are independent .",
    "4 .   if @xmath326 and @xmath335 share one vertex @xmath337 , then @xmath338 is a directed path of length 2 ( otherwise @xmath337 will have out - degree or in - degree at least 2 ) .",
    "hence , the events @xmath328 and @xmath336 are independent .",
    "it readily follows from the above four properties that for every @xmath339 , the events of @xmath340 are mutually independent and thus @xmath341 .",
    "we thus conclude that the probability that there exist sets @xmath325 and @xmath319 as in the assertion of the lemma for which there are at least @xmath321 pairs @xmath322 such that @xmath323 and @xmath324 is at most @xmath342^s = o(1 ) \\,,\\end{aligned}\\ ] ] where the second inequality follows since @xmath343 and the last equality follows by the assumed lower bound on @xmath4 .    [ lem::matchingstage4 ]",
    "let @xmath344 be a bipartite graph on @xmath345 vertices , where @xmath346 , and let @xmath347 be a positive integer . if @xmath8 satisfies the following two properties    ( i ) : :    @xmath348 holds for every    @xmath266 ; ( ii ) : :    @xmath349 holds for every    @xmath139 and every @xmath140 such    that @xmath350 ;    then there exists a matching of @xmath8 which saturates @xmath44 .    in order to prove the existence of such a matching",
    ", we will use hall s theorem ( see e.g.  @xcite ) , that is , we will prove that @xmath351 holds for every @xmath352 , where @xmath353 .",
    "suppose for a contradiction that there exists a set @xmath352 of size @xmath320 such that @xmath354 ; clearly @xmath355 .",
    "let @xmath356 be a set of size @xmath320 .",
    "since @xmath348 holds for every @xmath266 by property ( i ) above , it follows that @xmath357 . on the other hand @xmath358 holds by property ( ii ) above . clearly , this is a contradiction .",
    "a central part of our proof of the lower bound in theorem  [ directedham ] will consist of building a long directed path with certain properties .",
    "the use of the sparse diregularity lemma will result in certain problematic vertices .",
    "in the course of building this path we will try to avoid some of these problematic vertices while making sure we include others . in what follows",
    "we describe two kinds of problematic vertices we will have to deal with .",
    "since we apply the sparse diregularity lemma to a subdigraph of @xmath2 , we expect to encounter a relatively small number of problematic vertices",
    ". this will be made precise in lemmas  [ badconfigurationsi ] and  [ badconfigurationsii ] .",
    "let @xmath359 be positive real numbers .",
    "let @xmath152 be a digraph on @xmath0 vertices , let @xmath360 , @xmath361 and @xmath362 be positive integers , and let @xmath363 .",
    "let @xmath364 and @xmath56 be disjoint subsets of @xmath153 of size @xmath365 each , such that the pair @xmath366 is @xmath145-regular with directed density @xmath263 .",
    "a vertex @xmath85 is called _ bad of type i _ ( with respect to @xmath23 , @xmath365 , @xmath364 , @xmath56 , @xmath90 , @xmath367 , @xmath263 , @xmath260 , and @xmath235 ) if @xmath368 and at least one of the following conditions holds    ( i.1 ) : :    there exists a set @xmath369 of size    @xmath370 such that for every    @xmath371 of size at least    @xmath372 the pair    @xmath373 is _ not _    @xmath204-regular with directed density    @xmath205 for any    @xmath206 . ( i.2 ) : :    there exists a set @xmath374 of size    @xmath370 such that for every    @xmath371 of size at least    @xmath372 the pair    @xmath375 is _ not _",
    "@xmath204-regular with directed density    @xmath205 for any    @xmath206 .",
    "given sets @xmath364 and @xmath56 as above , let @xmath376 denote a set of bad vertices of type i ( with respect to these specific @xmath364 and @xmath56 ) .",
    "the digraph @xmath23 , the sets @xmath377 and the set @xmath378 are said to form a _",
    "@xmath379 bad configuration of type i_. we will prove that a.a.s .",
    "no subdigraph of @xmath2 contains such a configuration with a large set @xmath378 .",
    "[ badconfigurationsi ] let @xmath0 be a positive integer , @xmath380 , and @xmath381 .",
    "let @xmath382 be constants and let @xmath383 .",
    "then , there exists @xmath384 such that , for every positive integer @xmath385 satisfying @xmath386 , a.a.s .",
    "there are no @xmath387 bad configurations of type i in any subdigraph of @xmath23 .",
    "since @xmath388 are positive constants , by choosing @xmath389 to be sufficiently small we can guarantee that @xmath390 .",
    "let @xmath391 and @xmath193 be the constants whose existence follows from proposition  [ regularsmallsets ] and let @xmath392 .",
    "we would like to bound from above the expected number of large bad configurations of type i in any subdigraph of @xmath23 .",
    "fix two disjoint sets @xmath393 $ ] of size @xmath365 each , and a set @xmath394 \\setminus ( x \\cup y)$ ] of size @xmath395 for some @xmath396 such that @xmath386 .",
    "the number of choices of @xmath377 and @xmath378 is at most @xmath397 .",
    "choose also @xmath398 arcs directed from @xmath364 to @xmath56 .",
    "the number of ways to choose these arcs is @xmath399 and each such arc set appears in a subdigraph of our random digraph @xmath23 with probability at most @xmath400 .    since @xmath118 and @xmath401 are constants , @xmath386 and @xmath402 we have that @xmath403 .",
    "therefore , if the pair @xmath366 is @xmath145-regular , then from proposition  [ regularsmallsets ] it follows that the number of sets @xmath404 of size @xmath200 for some fixed @xmath405 such that for every @xmath371 of size at least @xmath202 the pair @xmath373 is _ not _ @xmath204-regular with directed density @xmath205 for any @xmath206 is at most @xmath406 .",
    "let @xmath407 be an arbitrary vertex .",
    "expose all arcs of @xmath23 with one endpoint in @xmath408 and the other in @xmath409 .",
    "for any subdigraph @xmath87 of @xmath23 and every @xmath404 , the probability that @xmath410 is bounded from above by the probability that @xmath369 which is @xmath411 .",
    "it follows by a union bound argument that the probability that ( i.1 ) holds for @xmath55 is at most @xmath412 ( note that if @xmath413 , then the probability that ( i.1 ) holds for @xmath55 is 0 ) .",
    "an analogous argument shows that exactly the same bound applies to the probability that ( i.2 ) holds for @xmath55 .",
    "hence , the probability that @xmath55 is bad of type i with respect to these @xmath365 , @xmath364 and @xmath56 is at most @xmath414 . since for distinct @xmath415 ,",
    "the validity of ( i.1 ) ( and similarly ( i.2 ) ) involves disjoint sets of edges , it follows that the events `` @xmath55 is bad of type i '' and `` @xmath416 is bad of type i '' are independent ( all events are with respect to the fixed @xmath364 and @xmath56 and given the arcs between @xmath364 and @xmath56 ) .",
    "hence , the probability that for given @xmath364 , @xmath56 and arcs between them , all the vertices of @xmath378 are bad of type i is at most    @xmath417    where the second inequality follows since @xmath418 is maximized by the smallest value of @xmath200 in the given range and in the last inequality we used the bounds @xmath419 which hold since @xmath420 and @xmath421 .",
    "summing over all appropriate choices of @xmath422 and @xmath398 arcs , directed from @xmath364 to @xmath56 , and using the estimate  , by linearity of expectation , we conclude that the expected number of @xmath387 bad configurations of type i in some subdigraph of @xmath23 is at most    @xmath423    where the first equality follows since @xmath383 , the second inequality holds by our choice of @xmath103 and the last equality holds since @xmath424 .",
    "hence , by markov s inequality there are a.a.s .",
    "no @xmath387 bad configurations of type i in any subdigraph of @xmath23 .",
    "let @xmath359 be positive real numbers .",
    "let @xmath152 be a digraph on @xmath0 vertices , let @xmath360 , @xmath361 , @xmath362 and @xmath425 be positive integers , and let @xmath363 .",
    "let @xmath426 be pairwise disjoint subsets of @xmath153 , of size @xmath365 each , such that , for every @xmath109 , the pair @xmath427 is @xmath145-regular with directed density @xmath263 ( throughout this section @xmath428 should be read as @xmath211 ) .    for @xmath109 , a vertex @xmath85 is called _ @xmath429-bad of type ii _ ( with respect to @xmath23 , @xmath365 , @xmath426 , @xmath90 , @xmath367 , @xmath263 , @xmath260 , and @xmath235 ) if at least one of the following conditions holds    @xmath155 : :    @xmath55 is bad of type i with respect to @xmath23 ,    @xmath365 , @xmath430 , @xmath119 ,    @xmath90 , @xmath367 ,    @xmath263 , @xmath260 , and @xmath235 .",
    "@xmath157 : :    @xmath55 is bad of type i with respect to @xmath23 ,    @xmath365 , @xmath119 , @xmath431 ,    @xmath90 , @xmath367 ,    @xmath263 , @xmath260 , and @xmath235 .",
    "@xmath159 : :    @xmath55 is bad of type i with respect to @xmath23 ,    @xmath365 , @xmath431 , @xmath432 ,    @xmath90 , @xmath367 ,    @xmath263 , @xmath260 , and @xmath235 .",
    "@xmath433 : :    @xmath434 and there exist sets    @xmath435 and    @xmath436 of sizes    @xmath437 such that , for every    @xmath438 and every    @xmath439 such that    @xmath440 and    @xmath441 , the    pair @xmath442 is _ not _",
    "@xmath204-regular with directed density    @xmath223 for any    @xmath224 .",
    "let @xmath34 be a constant .",
    "a vertex @xmath85 is called _ bad of type ii _ ( with respect to @xmath23 , @xmath365 , @xmath426 , @xmath104 , @xmath90 , @xmath367 , @xmath263 , @xmath260 , and @xmath235 ) if there exists a set @xmath443 $ ] of size @xmath444 such that , @xmath55 is @xmath429-bad of type ii for every @xmath445 .    given sets @xmath426 as above , let @xmath446 denote the set of bad vertices of type ii ( with respect to these specific @xmath426 ) .",
    "the digraph @xmath23 , the sets @xmath426 , and the set @xmath447 are said to form a _",
    "@xmath448 bad configuration of type ii_. we will prove that a.a.s .",
    "no subdigraph of @xmath2 contains such a configuration with a large set @xmath447 .",
    "[ badconfigurationsii ] let @xmath449 be an integer , let @xmath0 be a positive integer , @xmath380 , and @xmath81 .",
    "let @xmath450 be constants and let @xmath383 .",
    "then , there exists @xmath384 such that , for every positive integer @xmath451 satisfying @xmath386 , a.a.s .",
    "there are no @xmath452 bad configurations of type ii in any subdigraph of @xmath23 .",
    "since @xmath388 are positive constants , by choosing @xmath389 to be sufficiently small we can guarantee that @xmath453 .",
    "let @xmath454 be the constant whose existence follows from lemma  [ badconfigurationsi ] .",
    "let @xmath455 and @xmath213 be the constants whose existence follows from corollary  [ cor::regularityofsmallpairs ] .",
    "let @xmath456 .",
    "we would like to bound from above the expected number of large bad configurations of type ii in any subdigraph of @xmath23 .",
    "assume then that @xmath457 and @xmath447 form a @xmath452 bad configuration of type ii .",
    "note that by definition , for every vertex @xmath458 one of the conditions @xmath459 holds for at least @xmath460 indices .",
    "this implies that @xmath447 contains a subset @xmath325 of size at least @xmath461 such that for all vertices in @xmath325 the same condition holds for at least @xmath462 indices .",
    "given a subdigraph @xmath87 of @xmath23 , assume first that there exists a set @xmath463 of size @xmath464 such that for every @xmath465 , condition @xmath155 holds for at least @xmath462 indices @xmath466 ( with respect to these @xmath426 ) .",
    "it follows by averaging that there must exist some @xmath467 and a set @xmath468 of size @xmath469 such that condition @xmath155 holds for @xmath470 and for every @xmath471 .",
    "therefore , the digraph @xmath87 , the sets @xmath472 and the set @xmath473 form an @xmath474 bad configuration of type i. however , by our choice of @xmath90 and by lemma  [ badconfigurationsi ] the probability of this happening is @xmath475 .",
    "using an analogous argument for conditions @xmath157 and @xmath159 , we conclude that it suffices to prove that the probability that there exists a set @xmath463 of size @xmath464 such that for every @xmath465 , condition @xmath433 holds for at least @xmath462 indices @xmath466 is @xmath475 .",
    "let @xmath325 be such a set .",
    "it again follows by averaging that there must exist some @xmath467 and a set @xmath468 of size @xmath469 such that condition @xmath433 holds for @xmath470 and for every @xmath471 .",
    "it thus suffices to prove that the probability that there exist pairwise disjoint vertex sets @xmath476 and @xmath48 , where @xmath477 and @xmath478 such that the pair @xmath366 is @xmath145-regular with directed density @xmath263 and condition @xmath433 holds for every @xmath479 with respect to @xmath364 and @xmath56 is @xmath475 .",
    "as shown below , this can be done similarly to the proof of lemma  [ badconfigurationsi ] .",
    "there are at most @xmath480 ways to choose @xmath476 and @xmath48 .",
    "the number of ways to choose @xmath398 arcs , directed from @xmath364 to @xmath56 , is @xmath399 and each such arc set appears in a subdigraph of @xmath23 with probability at most @xmath400 .    since @xmath118 and @xmath401 are constants , @xmath386 and @xmath402 we have that @xmath403",
    ". therefore , if the pair @xmath366 is @xmath145-regular , then from corollary  [ cor::regularityofsmallpairs ] it follows that , for any fixed integers @xmath481 , there are at most @xmath482 pairs @xmath483 such that @xmath484 is of size @xmath485 and @xmath486 is of size @xmath487 and , moreover , for every @xmath488 and every @xmath489 such that @xmath490 and @xmath491 , the pair @xmath492 is _ not _ @xmath204-regular with directed density @xmath223 for any @xmath224 .",
    "let @xmath479 be an arbitrary vertex .",
    "expose all arcs of @xmath23 with one endpoint in @xmath408 and the other in @xmath409 . for any subdigraph @xmath87 of @xmath23 and every @xmath484 and @xmath486 , the probability that @xmath493 and @xmath494 is at most @xmath495 .",
    "hence , the probability that condition @xmath433 holds for @xmath55 with respect to @xmath364 and @xmath56 is at most @xmath496 where the first inequality holds since @xmath497 is decreasing in the range @xmath405 as @xmath498 , the second inequality holds since @xmath499 is increasing in the range @xmath500 and in the last inequality we used the bound @xmath501 which holds since @xmath421 .",
    "let @xmath502 be any two vertices .",
    "since @xmath48 is disjoint from @xmath409 , the validity of @xmath433 for @xmath55 and for @xmath416 ( both with respect to @xmath364 and @xmath56 and given the arcs between @xmath364 and @xmath56 ) involves disjoint sets of edges .",
    "hence , the events `` @xmath433 holds for @xmath55 with respect to @xmath364 and @xmath56 '' and `` @xmath433 holds for @xmath416 with respect to @xmath364 and @xmath56 '' are independent . thus , using   we conclude that the probability that condition @xmath433 holds for every @xmath503 is at most @xmath504    summing over all appropriate choices of @xmath505 and @xmath398 arcs , directed from @xmath364 to @xmath56 , and using estimate  , by linearity of expectation , we conclude that the expected number of @xmath452 bad configurations of type ii in some subdigraph of @xmath23 is at most    @xmath506    where the first equality follows since @xmath383 , the second inequality holds by our choice of @xmath103 and in the last equality we used the assumed lower bound on @xmath4 .",
    "hence , by markov s inequality there are a.a.s .",
    "no @xmath452 bad configurations of type ii in any subdigraph of @xmath23",
    ".    the following lemma will be useful in the next section when we will show how to build a long cycle which can be used to absorb the remaining vertices so as to create a hamilton cycle .",
    "[ lem::manygoodpairs ] let @xmath34 be a constant , let @xmath0 be a positive integer and let @xmath507 .",
    "let @xmath508 be a digraph obtained from @xmath81 by deleting at most @xmath509 out - going arcs and at most @xmath105 in - going arcs at every vertex @xmath52 .",
    "let @xmath365 , @xmath426 , @xmath90 , @xmath367 , @xmath263 , @xmath260 , and @xmath235 be as in the definition of bad vertices of type ii and assume further that @xmath510 .",
    "let @xmath511 denote the set of all vertices @xmath85 which satisfy the following two properties :    ( a ) : :    @xmath55 is not bad of type ii ( with respect to    @xmath87 , @xmath365 , @xmath426 ,    @xmath90 , @xmath367 ,    @xmath263 , @xmath260 , and @xmath235 ) .",
    "( b ) : :    @xmath512 and    @xmath513 for every    @xmath109",
    ".    then a.a.s .",
    "for every @xmath514 there exists a set @xmath443 $ ] such that all of the following properties hold :    ( i ) : :    @xmath444 . (",
    "ii ) : :    @xmath515 .",
    "( iii ) : :    @xmath516 and    @xmath517 for every    @xmath445 .",
    "( iv ) : :    @xmath518 and    @xmath519 for every    @xmath520 .",
    "( v ) : :    @xmath55 is not @xmath429-bad of type ii for any    @xmath445",
    "( with respect to @xmath87 ,    @xmath365 , @xmath426 ,    @xmath90 , @xmath367 ,    @xmath263 , @xmath260 , and @xmath235 ) .",
    "asymptotically almost surely @xmath521 and @xmath522 hold for every @xmath85",
    ". we will thus assume this throughout the proof .",
    "the remainder of the proof is deterministic .",
    "fix an arbitrary vertex @xmath514 .",
    "let @xmath523 ; clearly @xmath524 .",
    "let @xmath525 denote the set of indices of @xmath526 which satisfy property ( iii ) above ; we claim that @xmath527 . indeed , suppose for a contradiction that @xmath528 .",
    "fix some @xmath529 for which property ( iii ) is not satisfied .",
    "since @xmath514 , it follows by property ( b ) above that @xmath530 or @xmath531 .",
    "hence , in order to obtain @xmath87 from @xmath23 , one has to delete at least @xmath532 arcs which are incident with @xmath55 , contrary to our assumption .    by linearly ordering the elements of @xmath525 ( in the natural way ) , and keeping every fifth element we clearly end up with a set @xmath533 of size @xmath534 which satisfies properties ( ii ) , ( iii ) and ( iv ) above .",
    "finally , it follows by property ( a ) above that there are less than @xmath535 indices @xmath109 for which @xmath55 is @xmath429-bad .",
    "in particular , it follows that there exists a set @xmath536 of size @xmath537 which satisfies properties ( ii ) , ( iii ) , ( iv ) and ( v ) above .",
    "we are now ready to describe the different types of steps we will use to build a long path in the next section .",
    "each such step will consist of an arc @xmath114 where both @xmath538 and @xmath539 exhibit certain desirable properties .",
    "we thus start by describing such vertices .",
    "[ def::nicevertex ] let @xmath359 be positive real numbers .",
    "let @xmath152 be a digraph on @xmath0 vertices , let @xmath360 , @xmath361 , @xmath362 and @xmath425 be positive integers , and let @xmath363 .",
    "let @xmath426 be pairwise disjoint subsets of @xmath153 , of size @xmath365 each , such that , for every @xmath109 , the pair @xmath427 is @xmath145-regular with directed density @xmath263 .",
    "let @xmath540 be some set and let @xmath541 .",
    "a vertex @xmath542 is called    ( i ) : :    nice with respect to @xmath364 ( and @xmath23 ,    @xmath365 , @xmath426 ,    @xmath90 , @xmath367 ,    @xmath263 , @xmath260 and @xmath235 ) if    @xmath543 .",
    "( ii ) : :    backwards nice with respect to @xmath364 if    @xmath544 .",
    "( iii ) : :    very nice with respect to @xmath364 if it is both nice and    backwards nice .",
    "the purpose of the set @xmath364 in the above definition ( and in the next few definitions and lemmas ) is to make this definition more flexible",
    ". this will be useful in the next section , where we will want to use certain properties of nice vertices with respect to a set @xmath364 which will constantly change .",
    "we will make use of the following three types of basic steps .",
    "[ def::steptypes ] let @xmath23 , @xmath365 , @xmath426 , @xmath90 , @xmath367 , @xmath263 , @xmath260 , @xmath235 , @xmath364 , @xmath320 and @xmath538 be as in definition  [ def::nicevertex ] .",
    "( i ) : :    a standard forward step from @xmath538 with respect to    @xmath364 is an arc @xmath545 such that    @xmath546 is nice . (",
    "ii ) : :    a random forward step from @xmath538 with respect to    @xmath364 is an arc @xmath545 such that    @xmath539 is chosen uniformly at random among all nice vertices    of @xmath547 .",
    "( iii ) : :    a standard backward step from @xmath538 with respect to    @xmath364 is an arc @xmath548 such that    @xmath549 is backwards nice .",
    "next , we describe sufficient conditions for such steps to exist .",
    "[ lem::stepsexist ] let @xmath23 , @xmath365 , @xmath426 , @xmath90 , @xmath367 , @xmath263 , @xmath260 , @xmath235 , @xmath364 , @xmath320 and @xmath538 be as in definition  [ def::nicevertex ] .",
    "assume further that @xmath550 , that @xmath551 holds for every @xmath109 and that @xmath552 holds for every @xmath553 and every @xmath109 .",
    "if @xmath542 is a nice vertex and @xmath538 is not bad of type i with respect to @xmath554 , then there exists a nice vertex @xmath555 , that is , there exists a standard forward step from @xmath538 .",
    "similarly , if @xmath538 is a backwards nice vertex and @xmath538 is not bad of type i with respect to @xmath556 , then there exists a nice vertex @xmath557 , that is , there exist a standard backward step from @xmath538",
    ".    we will prove the existence of a standard forward step ; the existence of a standard backward step can be proved analogously .",
    "let @xmath558 .",
    "since @xmath538 is nice , it follows that @xmath559 .",
    "since , moreover , @xmath538 is not bad of type i with respect to @xmath554 and the pair @xmath560 is @xmath145-regular with directed density @xmath263 , it follows that there exists a set @xmath561 such that @xmath562 and the pair @xmath563 is @xmath204-regular with directed density @xmath205 for some @xmath564 .",
    "since @xmath565 , it follows by lemma  [ smalldegreevertices ] that there exists a vertex @xmath566 such that @xmath567 .",
    "since @xmath568 , it follows from our assumption that @xmath569 and thus @xmath539 is nice .",
    "we will also make use of the following composite steps which consist of several simple ones .",
    "the first of these consists of six arcs and is used to absorb a specific vertex into a path .",
    "[ def::bigstep ] let @xmath23 , @xmath365 , @xmath426 , @xmath90 , @xmath367 , @xmath263 , @xmath260 , @xmath235 , @xmath364 , @xmath320 and @xmath538 be as in definition  [ def::nicevertex ] and let @xmath570 be a vertex .",
    "a big step from @xmath538 via @xmath337 with respect to @xmath364 consists of six arcs @xmath571 , @xmath572 and @xmath573 of @xmath39 such that @xmath574 and @xmath575 is nice .",
    "[ lem::bigstepexists ] let @xmath23 , @xmath365 , @xmath426 , @xmath90 , @xmath367 , @xmath263 , @xmath260 , @xmath235 , @xmath364 , @xmath320 , @xmath538 and @xmath337 be as in definition  [ def::bigstep ] .",
    "let @xmath576 , @xmath577 , @xmath578 and @xmath579 .",
    "assume that @xmath580 and that there exists @xmath467 such that @xmath581 .",
    "assume further that @xmath550 , that @xmath582 , that @xmath583 holds for every @xmath109 , and that @xmath584 holds for every @xmath585 and every @xmath109 .",
    "if @xmath542 is a nice vertex and @xmath538 is not bad of type i with respect to @xmath554 , then there exists a big step from @xmath538 via @xmath337 .",
    "let @xmath558 .",
    "since @xmath538 is nice , it follows that @xmath559 , where the last inequality holds since @xmath550 and @xmath586 .",
    "since , moreover , @xmath538 is not bad of type i with respect to @xmath554 and the pair @xmath560 is @xmath145-regular with directed density @xmath263 , it follows that there exists a set @xmath561 such that @xmath562 and the pair @xmath563 is @xmath204-regular with directed density @xmath205 for some @xmath564 .",
    "since @xmath587 and @xmath580 , it follows that @xmath588 .",
    "it thus follows by lemma  [ smalldegreevertices ] that there exists a vertex @xmath589 such that @xmath590 .",
    "in particular , there exists a vertex @xmath591 . by definition of @xmath592 and @xmath593 there exists a vertex @xmath594 . since @xmath595 , we have @xmath596 . since @xmath597 and @xmath581 , it follows that @xmath598 .",
    "since , moreover , @xmath599 is @xmath145-regular with directed density @xmath263 , it follows by lemma  [ smalldegreevertices ] that there exists a vertex @xmath600 such that @xmath601 , where the last inequality holds since @xmath550 and @xmath602 .",
    "since @xmath603 , it follows that @xmath604 and thus @xmath575 is nice .",
    "finally , by the definition of @xmath605 and @xmath606 , there exists @xmath607 .",
    "[ fig1 ]     via @xmath337 ; note that @xmath337 , @xmath593 and @xmath605 appear in the center of the cycle to stress that we make no assumptions regarding their location.,width=739,height=739 ]    the second composite step we consider consists of four arcs and is used to close a path into a cycle .",
    "[ def::closingstep ] let @xmath23 , @xmath365 , @xmath426 , @xmath90 , @xmath367 , @xmath263 , @xmath260 , @xmath235 , @xmath364 , @xmath320 and @xmath538 be as in definition  [ def::nicevertex ] and let @xmath608 be a vertex .",
    "a closing step from @xmath538 to @xmath609 with respect to @xmath364 consists of four arcs @xmath571 and @xmath610 of @xmath39 such that @xmath611 for every @xmath612 .",
    "[ lem::closingstep ] let @xmath23 , @xmath365 , @xmath426 , @xmath90 , @xmath367 , @xmath263 , @xmath260 , @xmath235 , @xmath364 , @xmath320 , @xmath538 and @xmath609 be as in definition  [ def::closingstep ] .",
    "assume that @xmath538 is a nice vertex and is not bad of type i with respect to @xmath554 .",
    "assume further that @xmath609 is not bad of type i with respect to @xmath613 and @xmath614 .",
    "finally , assume that @xmath550 and that @xmath615 holds for every @xmath109 .",
    "then there exists a closing step from @xmath538 to @xmath609 with respect to @xmath364 .",
    "let @xmath616 .",
    "since @xmath538 is nice , it follows that @xmath617 , where the last inequality holds since @xmath550 and @xmath618 .",
    "since , moreover , @xmath538 is not bad of type i with respect to @xmath554 and the pair @xmath560 is @xmath145-regular with directed density @xmath263 , it follows that there exists a set @xmath619 such that @xmath620 and the pair @xmath621 is @xmath204-regular with directed density @xmath205 for some @xmath564 .",
    "similarly , since @xmath614 , since @xmath609 is not bad of type i with respect to @xmath613 and since the pair @xmath622 is @xmath145-regular with directed density @xmath263 , it follows that there exists a set @xmath623 such that @xmath624 and the pair @xmath625 is @xmath204-regular with directed density @xmath205 for some @xmath564 . since @xmath626 and the pair @xmath621 is @xmath204-regular with positive density",
    ", it follows that @xmath627 .",
    "similarly , @xmath628 as well and thus @xmath629 .",
    "choosing any vertices @xmath630 , @xmath631 and @xmath632 completes the proof .",
    "we end this section by proving some properties of random forward steps .",
    "more precisely , we show that regularity and the fact that we are working with a subdigraph of a random digraph , imply that the probabilities that vertices of a sequences of two ( or more ) consecutive random forward steps , starting at a nice vertex , belong to predefined sets is essentially uniformly distributed ( up to constant factors ) .",
    "[ lem::twosteps ] let @xmath23 , @xmath365 , @xmath426 , @xmath90 , @xmath367 , @xmath263 , @xmath260 , @xmath235 , @xmath364 and @xmath320 be as in definition  [ def::nicevertex ] and let @xmath542 be a nice vertex which is not bad of type i with respect to @xmath554 .",
    "assume further that @xmath633 , that @xmath550 , that @xmath551 holds for every @xmath109 and that @xmath552 holds for every @xmath553 and every @xmath109 .",
    "let @xmath634 be an arbitrary set of size @xmath635 .",
    "let @xmath114 and @xmath636 be two consecutive random forward steps",
    ". then @xmath637 .",
    "let @xmath638 .",
    "since the pair @xmath622 is @xmath145-regular with directed density @xmath263 , @xmath550 and @xmath639 , it follows by lemma  [ smalldegreevertices ] that @xmath640 .",
    "let @xmath558 .",
    "since @xmath538 is nice , it follows that @xmath559 , where the last inequality holds since @xmath550 and @xmath641 .",
    "since , moreover , @xmath538 is not bad of type i with respect to @xmath554 and the pair @xmath560 is @xmath145-regular with directed density @xmath263 , it follows that there exists a set @xmath642 such that @xmath643 and the pair @xmath644 is @xmath204-regular with directed density @xmath205 for some @xmath645 .",
    "let @xmath646 , let @xmath647 , let @xmath648 and let @xmath649 .",
    "since the pair @xmath644 is @xmath204-regular with directed density @xmath564 , @xmath550 and @xmath565 , it follows by lemma  [ smalldegreevertices ] that @xmath650 .",
    "similarly , since the pair @xmath644 is @xmath204-regular with directed density @xmath651 and @xmath565 , it follows by lemma  [ smalldegreevertices ] that @xmath652 . finally , since the pair @xmath644 is @xmath204-regular with directed density @xmath564 and @xmath653 , it follows by lemma  [ smalldegreevertices ] that @xmath654 .",
    "therefore , @xmath655 .",
    "we conclude that @xmath656    [ lem::threesteps ] let @xmath23 , @xmath365 , @xmath426 , @xmath90 , @xmath367 , @xmath263 , @xmath260 , @xmath235 , @xmath364 and @xmath320 be as in definition  [ def::nicevertex ] and let @xmath542 be a nice vertex which is not bad of type i with respect to @xmath554 .",
    "assume further that @xmath633 , that @xmath550 , that @xmath657 holds for every @xmath109 and that @xmath552 holds for every @xmath553 and every @xmath109 .",
    "let @xmath658 be a set which satisfies all of the following properties :    ( a ) : :    @xmath659 .",
    "( b ) : :    the pair @xmath660 is    @xmath204-regular with directed density    @xmath661 .",
    "( c ) : :    the pair @xmath662 is    @xmath204-regular with directed density    @xmath663 .",
    "let @xmath664 and @xmath665 be three consecutive random forward steps",
    ". then @xmath666 .",
    "let @xmath638 .",
    "since the pair @xmath662 is @xmath204-regular with directed density @xmath663 , @xmath550 and @xmath667 , it follows by lemma  [ smalldegreevertices ] that @xmath668 .",
    "let @xmath669 .",
    "since the pair @xmath622 is @xmath145-regular with directed density @xmath263 and @xmath639 , it follows by lemma  [ smalldegreevertices ] that @xmath670 .",
    "let @xmath671 .",
    "since the pair @xmath660 is @xmath204-regular with directed density @xmath661 and @xmath672 , it follows by lemma  [ smalldegreevertices ] that @xmath673 .",
    "let @xmath674 , then @xmath675 .",
    "it follows by lemma  [ lem::twosteps ] that @xmath676 , where the last inequality holds since @xmath677 and @xmath678 .",
    "we conclude that @xmath679    [ lem::foursteps ] let @xmath23 , @xmath365 , @xmath426 , @xmath90 , @xmath367 , @xmath263 , @xmath260 , @xmath235 , @xmath364 and @xmath320 be as in definition  [ def::nicevertex ] and let @xmath542 be a nice vertex which is not bad of type i with respect to @xmath554 .",
    "assume further that @xmath633 , that @xmath550 , that @xmath657 holds for every @xmath109 and that @xmath552 holds for every @xmath553 and every @xmath109 . let @xmath680 and @xmath681 be sets which satisfy all of the following properties :    ( i ) : :    @xmath682 .",
    "( ii ) : :    the pair @xmath683 is    @xmath204-regular with directed density    @xmath684 .",
    "( iii ) : :    the pair @xmath685 is    @xmath204-regular with directed density    @xmath686 .",
    "( iv ) : :    the pair @xmath687 is    @xmath204-regular with directed density    @xmath688 .",
    "( v ) : :    the pair @xmath689 is    @xmath204-regular with directed density    @xmath690 .",
    "let @xmath691 and @xmath692 be four consecutive random forward steps",
    ". then @xmath693    let @xmath694 .",
    "since the pair @xmath687 is @xmath204-regular with directed density @xmath688 , @xmath550 and @xmath695 , it follows by lemma  [ smalldegreevertices ] that @xmath696 .",
    "let @xmath697 .",
    "since the pair @xmath685 is @xmath204-regular with directed density @xmath698 and @xmath667 , it follows by lemma  [ smalldegreevertices ] that @xmath699 .",
    "let @xmath700 .",
    "since the pair @xmath689 is @xmath204-regular with directed density @xmath690 and @xmath701 , it follows by lemma  [ smalldegreevertices ] that @xmath702 .",
    "let @xmath703 , then @xmath704 .",
    "it follows by properties ( i ) , ( ii ) and ( iii ) that the conditions of lemma  [ lem::threesteps ] are satisfied and thus @xmath705 .",
    "we conclude that @xmath706    [ lem::twostepsupperbound ] let @xmath0 be a positive integer , let @xmath35 , let @xmath81 and let @xmath508 be a spanning subdigraph of @xmath23 .",
    "let @xmath365 , @xmath426 , @xmath90 , @xmath367 , @xmath263 , @xmath260 , @xmath235 , @xmath364 and @xmath320 be as in definition  [ def::nicevertex ] ( with respect to @xmath87 ) and let @xmath542 be a nice vertex which is not bad of type i with respect to @xmath554 . assume further that @xmath633 , that @xmath383 for some @xmath707 , that @xmath550 , that @xmath708 holds for every @xmath109 and that @xmath552 holds for every @xmath553 and every @xmath109 .",
    "let @xmath709 be arbitrary fixed sets of size @xmath710 and @xmath711 .",
    "let @xmath114 and @xmath636 be two consecutive random forward steps . then    (",
    "a ) : :    @xmath712 .",
    "( b ) : :    @xmath713 .",
    "let @xmath714 .",
    "since @xmath538 is nice , it follows that @xmath559 , where the last inequality holds since @xmath550 and @xmath641 .",
    "since , moreover , @xmath538 is not bad of type i with respect to @xmath554 and the pair @xmath560 is @xmath145-regular with directed density @xmath263 , it follows that there exists a set @xmath642 such that @xmath643 and the pair @xmath644 is @xmath204-regular with directed density @xmath205 for some @xmath645 .",
    "let @xmath715 .",
    "since the pair @xmath644 is @xmath204-regular with directed density @xmath564 , @xmath550 and @xmath565 , it follows by lemma  [ smalldegreevertices ] that latexmath:[\\[\\label{eq::manynicevertices }     by the definition of a random forward step , @xmath539 is a nice vertex and thus @xmath717    let @xmath718 .",
    "since the pair @xmath622 is @xmath145-regular with directed density @xmath263 , @xmath719 and @xmath720 , it follows by lemma  [ smalldegreevertices ] and by   that @xmath721 .",
    "it follows by lemma  [ lem::degreetoohigh ] ( ii ) that @xmath722 .",
    "hence @xmath723 where the first inequality holds by   and the definition of @xmath724 and the second inequality holds by  .",
    "this proves ( a ) .    for ( b )",
    ", let @xmath725 .",
    "it follows by lemma  [ lem::degreetoohigh ] ( ii ) that @xmath726 .",
    "hence @xmath727 where the first inequality holds by   and the definition of @xmath728 and the second inequality holds by  .",
    "[ lem::threestepsupperbound ] let @xmath0 be a positive integer , let @xmath35 , let @xmath81 and let @xmath508 be a spanning subdigraph of @xmath23 .",
    "let @xmath365 , @xmath426 , @xmath90 , @xmath367 , @xmath263 , @xmath260 , @xmath235 , @xmath364 and @xmath320 be as in definition  [ def::nicevertex ] ( with respect to @xmath87 ) and let @xmath542 be a nice vertex which is not bad of type i with respect to @xmath554 . assume further that @xmath633 , that @xmath383 for some @xmath707 , that @xmath550 , that @xmath708 holds for every @xmath109 and that @xmath552 holds for every @xmath553 and every @xmath109 .",
    "let @xmath658 be an arbitrary fixed set of size @xmath729 .",
    "let @xmath664 and @xmath665 be three consecutive random forward steps",
    ". then @xmath730 .",
    "let @xmath731 and let @xmath732 ; clearly @xmath733 .",
    "it follows by lemma  [ lem::degreetoohigh ] ( ii ) that @xmath722 and by lemma  [ lem::degreetoohigh ] ( i ) that @xmath734 .",
    "moreover , it follows by lemma  [ lem::twostepsupperbound ] that @xmath735 and that @xmath736 . finally , by the definition of a random forward step , @xmath737 is a nice vertex and thus @xmath738    let @xmath739 .",
    "since the pair @xmath740 is @xmath145-regular with directed density @xmath263 , @xmath719 and @xmath741 , it follows by lemma  [ smalldegreevertices ] and by   that @xmath742",
    "we start with the upper bound in theorem  [ directedham ] ; we will in fact prove the following stronger result .",
    "let @xmath81 , where @xmath21",
    ". then a.a.s .",
    "one can delete at most @xmath743 of the out - going arcs and at most @xmath744 of the in - going arcs at every vertex @xmath52 so that the resulting digraph is non - hamiltonian ; note that @xmath745 for @xmath21 .",
    "* proof of theorem  [ directedham ] ( upper bound ) : * let @xmath746 be an arbitrary partition of @xmath26 $ ] into two parts of equal size ( that is , @xmath747 ) .",
    "let @xmath748,e ) \\in { \\mathcal d}(n , p)$ ] .",
    "it follows by theorem  [ th::chernoff ] ( iii ) and union bound , that a.a.s .",
    "every @xmath749 $ ] satisfies @xmath750 and @xmath751 .",
    "let @xmath752 be an arbitrary vertex , then clearly @xmath753 .",
    "in particular , @xmath754 .",
    "since a.a.s .",
    "@xmath755 , it follows by theorem  [ th::chernoff ] ( ii ) that @xmath756    taking the union bound over all vertices of @xmath211 , we conclude that a.a.s . for every @xmath752 we have @xmath757 .",
    "an analogous argument shows that a.a.s .",
    "@xmath758 for every @xmath759 .",
    "our claim now follows since one can obtain a non - hamiltonian digraph by deleting all arcs of @xmath23 that are oriented from @xmath211 to @xmath212 . in particular , @xmath760 a.a.s .",
    "@xmath761 +    the remainder of this section is devoted to the proof of the lower bound .",
    "namely , we will prove that a.a.s . even if an adversary deletes at most @xmath762 of the out - going arcs and at most @xmath763 of the in - going arcs at every vertex @xmath52 , where @xmath34 is an arbitrarily small constant",
    ", there is still a hamilton cycle in the resulting digraph .",
    "let @xmath764 and @xmath765 be positive real numbers and let @xmath175 be a positive integer such that @xmath766 and moreover @xmath767 and @xmath768 , where for positive real numbers @xmath769 the notation @xmath770 means that @xmath771 is a sufficiently small real number .",
    "let @xmath772 , let @xmath773 be the real number whose existence follows from lemma  [ badconfigurationsi ] , let @xmath774 be the real number whose existence follows from lemma  [ badconfigurationsii ] and let @xmath775 .",
    "note that @xmath776 .",
    "let @xmath81 .",
    "note that a.a.s .",
    "@xmath777 and @xmath778 hold for every vertex @xmath52 .",
    "hence , we will assume throughout the proof that @xmath23 satisfies these properties .",
    "fix some @xmath167 and let @xmath779 be the constant whose existence is guaranteed by lemma  [ diregularity ] . since , by remark  [ @xmath172isbounded ] , @xmath23 is a.a.s .",
    "@xmath168-bounded , we assume throughout the proof that it is .",
    "let @xmath82 be a digraph obtained from @xmath23 by deleting at most @xmath762 of the out - going arcs and at most @xmath763 of the in - going arcs at every vertex @xmath52 .",
    "note that @xmath87 is @xmath168-bounded as well .",
    "apply lemma  [ diregularity ] to @xmath82 with parameters @xmath780 , @xmath781 and @xmath175 .",
    "let @xmath89 be the corresponding @xmath782-regular partition , and let @xmath92 be the corresponding regularity digraph .",
    "it follows by the definition of @xmath96 that the ordered pair @xmath97 is @xmath782-regular with directed density at least @xmath98 whenever @xmath783 .",
    "note that if @xmath784 , then , by observation  [ obs::regularity1 ] , the pair @xmath97 is @xmath785-regular .",
    "if on the other hand @xmath786 , then , since @xmath787 , it follows by observations  [ obs::regularity2 ] and  [ obs::regularity1 ] that the pair @xmath97 is @xmath785-regular .",
    "it thus follows by lemma  [ lem::gs ] that we can assume that @xmath97 is @xmath145-regular with directed density @xmath98 for every @xmath94 such that @xmath783 .",
    "let @xmath365 denote the common size of @xmath788 ; note that @xmath789 .",
    "we first show that @xmath96 contains an almost spanning cycle ; our proof will use the following immediate corollary of a classical theorem of ghouila - houri  @xcite .",
    "[ th::corofgh ] let @xmath23 be a digraph on @xmath0 vertices .",
    "if @xmath790 and @xmath791 , then @xmath23 admits a directed hamilton cycle .",
    "[ lem::longcycle ] conditioned on the properties of @xmath2 mentioned above , @xmath96 contains a directed cycle of length @xmath792 .",
    "let @xmath162 be an index for which there are at most @xmath161 indices @xmath163 such that @xmath164 is not @xmath145-regular ( recall that by remark  [ fewlowdegvertices ] , at least @xmath793 indices @xmath162 have this property ) .",
    "let @xmath163 be such that @xmath164 is an @xmath145-regular pair but @xmath794 . since @xmath795 , we can use theorem  [ th::chernoff ] ( i ) and union bound to show that a.a.s .",
    "since @xmath794 even though @xmath164 is @xmath145-regular , it must hold that @xmath797 . hence , recalling that @xmath772 , we conclude that at least @xmath798 arcs of @xmath799 were deleted from @xmath23 in order to obtain @xmath87 .",
    "recall that @xmath800 . if @xmath801 , then at least @xmath802 arcs of @xmath803 \\setminus v_i)$ ] were deleted from @xmath23 to obtain @xmath87 .",
    "since a.a.s .",
    "the maximum out - degree of @xmath23 is at most @xmath804 , it follows that there exists some vertex @xmath805 such that strictly more than @xmath762 out - going arcs which are incident with @xmath55 in @xmath23 were deleted to obtain @xmath87 , contrary to our assumption . therefore @xmath806 .",
    "since the same argument applies to every @xmath162 for which there are at most @xmath161 indices @xmath163 such that @xmath164 is not @xmath145-regular , it follows by remark  [ fewlowdegvertices ] that at least @xmath793 vertices of @xmath96 have out - degree at least @xmath807 each .",
    "an analogous argument shows that at least @xmath793 vertices of @xmath96 have in - degree at least @xmath807 each .",
    "let @xmath99 be the graph obtained from @xmath96 by successively deleting vertices whose out - degree or in - degree is strictly smaller than @xmath808 .",
    "it follows by the previous paragraph that @xmath809 .",
    "moreover , @xmath810 holds by the definition of @xmath99 . applying theorem  [ th::corofgh ] to @xmath99 completes the proof of the lemma .",
    "assume without loss of generality that @xmath106 is a cycle of @xmath96 of length @xmath811 .",
    "note that it follows from the definition of @xmath96 that the pair @xmath108 is @xmath145-regular with directed density @xmath98 , for every @xmath109 .",
    "for the sake of simplicity of presentation we will discard the `` mod @xmath16 '' in the rest of the proof .",
    "hence @xmath431 will mean @xmath211 in case @xmath812 and @xmath430 will mean @xmath121 in case @xmath813 .",
    "we now show how one can find a hamilton cycle of @xmath87 .",
    "this is done in four stages . in the first stage",
    "we build a path @xmath814 of @xmath87 that includes certain `` problematic '' vertices ( while certain other `` problematic '' vertices are intentionally avoided and their inclusion is postponed to the fourth stage ) . in the second stage",
    "we extend the path that was built in the first stage to an `` almost spanning '' path @xmath815 such that , for every @xmath816 , there are `` many '' arcs @xmath817 for which @xmath112 and @xmath818 . in the third stage we close the path that was built in the second stage into a cycle .",
    "finally , in the fourth stage we extend this cycle to a hamilton cycle by adding all remaining vertices .      in this subsection",
    "we build a directed path @xmath814 of @xmath508 which includes certain problematic vertices ( by abuse of notation , @xmath814 will denote the path we build at any point during stage 1 ; moreover , we will use @xmath814 to denote the path as well as its vertex set ) .",
    "we begin by describing the different types of problematic vertices we will deal with .",
    "let @xmath48 denote the set of vertices @xmath85 for which there exists an index @xmath109 such that @xmath819 or @xmath820 .",
    "it follows by lemma  [ badset ] that a.a.s . @xmath821 .",
    "let @xmath446 denote the set of bad vertices of type ii ( with respect to @xmath87 , @xmath426 , @xmath822 , @xmath823 , and @xmath824 ) .",
    "it follows by lemma  [ badconfigurationsii ] that a.a.s .",
    "@xmath825 . in particular",
    ", @xmath826 holds for every @xmath109 .",
    "the vertices of @xmath827 are the so - called _ problematic _ vertices we wish to include in @xmath814 in stage 1 .",
    "when building @xmath814 we will use some of the steps which were defined in the previous section ( see definitions  [ def::steptypes ] and  [ def::bigstep ] ) .",
    "we thus need to avoid bad vertices of type i with respect to appropriate pairs of sets . for every @xmath109 ,",
    "let @xmath828 denote the set of vertices of @xmath119 which are bad of type i with respect to @xmath87 , @xmath365 , @xmath431 , @xmath432 , @xmath90 , @xmath367 , @xmath98 , @xmath823 , and @xmath824 .",
    "similarly , for every @xmath109 , let @xmath829 denote the set of vertices of @xmath119 which are bad of type i with respect to @xmath87 , @xmath365 , @xmath830 , @xmath430 , @xmath90 , @xmath367 , @xmath98 , @xmath823 , and @xmath824 . by lemma  [ badconfigurationsi ] we can assume that @xmath831 and @xmath832 hold for every @xmath109",
    "let @xmath833 .",
    "it follows that @xmath834 holds for every @xmath109 .    while building @xmath814 , we might include in this path many of the neighbors of some vertex @xmath835 , thus making it hard to include @xmath55 in the hamilton cycle we aim to build . in order to avert this problem ,",
    "as soon as @xmath814 includes too many neighbors of some vertex @xmath835 , we will declare @xmath55 to be dangerous and will try to add it to @xmath814 .",
    "this notion of _ dangerous vertices _ is made precise by the following definition .",
    "[ def::dangerousvertex ] a vertex @xmath836 is called dangerous if @xmath837 or there exists some @xmath109 such that @xmath838 .    at any point during stage 1 , let @xmath839 and let @xmath840 denote the set of dangerous vertices .",
    "note that latexmath:[\\[\\label{eq::smalll1 }    @xmath109 throughout stage 1 .    moreover , since @xmath842 , it follows that latexmath:[\\[\\label{eq::totall1 }     we are now ready to describe our algorithm for building @xmath814 . for every vertex @xmath844",
    "we denote by @xmath845 the unique index @xmath109 such that @xmath805 .",
    "@xmath846 arbitrary very nice vertex of @xmath211 with respect to @xmath847 @xmath848 @xmath849 arbitrary subset of @xmath850 of size @xmath823 @xmath851 arbitrary element of @xmath852 @xmath851 arbitrary element of @xmath853 @xmath854    @xmath846 standard backward step from @xmath129 with respect to @xmath847 @xmath849 arbitrary subset of @xmath855 of size @xmath823 @xmath856 @xmath857 arbitrary element of @xmath858 $ ] such that @xmath859 @xmath860 @xmath861 arbitrary element of @xmath858 $ ] such that @xmath862 @xmath863 standard forward step from @xmath538 with respect to @xmath864 @xmath863 big step from @xmath538 via @xmath337 with respect to @xmath864 @xmath865    it remains to prove that algorithm 1 works .",
    "except for the subroutine add , the only non - trivial part of algorithm 1 is the existence of a very nice vertex @xmath129 ( from which the existence of the set @xmath866 will readily follow ) .",
    "let @xmath867 and let @xmath868 ; it suffices to prove that @xmath869 .",
    "since the pair @xmath196 is @xmath145-regular with directed density @xmath98 , it follows by   and by lemma  [ smalldegreevertices ] that @xmath870 holds for all but at most @xmath871 vertices of @xmath872 .",
    "since @xmath873 , it follows that @xmath874 holds for every vertex @xmath875 .",
    "we conclude that @xmath876 .",
    "a similar argument shows that @xmath877 holds as well and thus @xmath869 as claimed .",
    "note that @xmath878 and thus @xmath129 is not bad of type i with respect to @xmath879 and is not bad of type i with respect to @xmath880 .",
    "our next goal is to prove that the subroutine add works as well .",
    "we will do so under additional assumptions and will then prove that these assumptions hold throughout stage 1 .",
    "we first prove that the indices @xmath881 and @xmath882 mentioned in lines 6 and 8 of the subroutine add exist .    [ lem::outneighbours ] let @xmath883 , @xmath884 , @xmath885 and @xmath886 . if @xmath887 and @xmath888 , then there exist indices @xmath123 , such that @xmath889 and @xmath890 .",
    "we will prove the existence of @xmath882 ; the existence of @xmath881 can be proved by a similar argument . since @xmath891 , it follows by the definition of @xmath87 that @xmath892 .",
    "moreover , since @xmath893 , it follows that @xmath894 .",
    "we claim that @xmath895 . indeed , suppose for a contradiction that @xmath896 is of size at least @xmath897 where we used   in the first inequality .",
    "it follows by theorem  [ th::chernoff ] ( i ) and union bound that @xmath898 where @xmath899 and @xmath900 are appropriate constants and the last equality holds by the assumed lower bound on @xmath4 .",
    "it follows that a.a.s .",
    "there exists a vertex @xmath901 such that @xmath902 . since @xmath903",
    ", it follows that , in order to obtain @xmath87 from @xmath23 , we have deleted more than @xmath904 edges incident with @xmath55 .",
    "this is clearly a contradiction .",
    "since @xmath905 , it follows that @xmath906 .",
    "we thus conclude that there exists an index @xmath907 , such that @xmath890 as claimed .",
    "next we remark that , since @xmath908 , since @xmath909 , since @xmath129 is nice , and since we end every standard forward step at a nice vertex , the existence of a standard forward step ( line 10 ) follows from lemma  [ lem::stepsexist ] provided that @xmath910 holds for every @xmath109 . similarly , since @xmath129 is backwards nice , and since we end every standard backward step at a backwards nice vertex , the existence of a standard backward step ( line 2 ) follows from lemma  [ lem::stepsexist ] under the same conditions . finally , the existence of a big step ( line 12 ) follows from lemma  [ lem::bigstepexists ] provided that @xmath911 holds for every @xmath109 and that the conditions of lemma  [ lem::outneighbours ] are satisfied .",
    "therefore , in order to complete the proof of correctness of the subroutine add , it suffices to prove that all the conditions mentioned in the previous paragraph hold throughout stage 1 .",
    "[ lem::additionalconditions ] as long as @xmath912 or @xmath913 the following three conditions hold .",
    "( a ) : :    @xmath914 for every    @xmath541 ; ( b ) : :    @xmath915 for    every @xmath835 and every    @xmath541 ; ( c ) : :    @xmath916    for every @xmath835 .",
    "before we prove lemma  [ lem::additionalconditions ] , we remark that it suffices to complete the proof of correctness of the subroutine add .",
    "indeed , it follows by condition ( a ) and   that @xmath917 holds for every @xmath109 .",
    "moreover , since @xmath918 holds by lemma  [ lem::longcycle ] , it follows by condition ( a ) that @xmath887 .",
    "finally , it follows by conditions ( b ) and ( c ) that for every @xmath835 @xmath919 so both conditions of lemma  [ lem::outneighbours ] are met .",
    "* proof of lemma  [ lem::additionalconditions ] * suppose for a contradiction that at least one of ( a ) , ( b ) and ( c ) is violated at some point during stage 1 , that is , while @xmath912 or @xmath913 still holds .",
    "consider the first moment in which this occurs .",
    "we will distinguish between three cases according to which condition is violated first . before doing so",
    ", we will prove that whenever we run the subroutine add , we add to @xmath814 only a few vertices from each @xmath119 .",
    "[ cl::atmost8 ] for every @xmath109 , each single call to the subroutine add enlarges @xmath920 by at most 8 and @xmath921 by at most 3 .",
    "consider running @xmath922 once .",
    "first , note that by the proof of lemma  [ lem::bigstepexists ] , the only vertices of @xmath923 we might add to @xmath814 are @xmath337 itself , @xmath595 and @xmath924 .",
    "next , fix some @xmath109",
    ". we might add 1 vertex of @xmath119 to @xmath814 if we start with a standard backward step from @xmath431 ( this is the new @xmath129 ) .",
    "then , starting at @xmath925 , we make a series of standard forward steps until we reach @xmath926 .",
    "this adds to @xmath814 at most one additional vertex of @xmath119 .",
    "once we reach @xmath926 we make a big step consisting of the arcs @xmath927 and @xmath573 .",
    "the claim now follows since clearly @xmath928 .",
    "we can now return to the main part of the proof .",
    "we will make use of the following notation and terminology .",
    "a vertex @xmath929 is called _ post dangerous _ if it was dangerous before it was added to @xmath814 .",
    "note that since we do not remove any vertices from @xmath847 when building @xmath814 , after adding @xmath930 to @xmath814 , it is still true that @xmath931 or there exists some @xmath109 such that @xmath932 .",
    "a vertex @xmath929 is called _ special _ if it was added to @xmath814 when the subroutine add was called with @xmath933 . at any point during stage 1 , we denote by @xmath934 the set of post dangerous vertices and by @xmath935 the set of special vertices .",
    "note that at any point during stage 1 , @xmath936 and @xmath937 as , by definition  [ def::dangerousvertex ] , once a vertex is added to @xmath814 , it is no longer dangerous .",
    "moreover @xmath938 .",
    "similarly , it follows from claim  [ cl::atmost8 ] and the aforementioned bounds on @xmath939 and @xmath940 that @xmath941 that , at this point , @xmath942 holds for some @xmath541 and @xmath943 holds for every @xmath109 .",
    "it follows by   that @xmath944 and thus @xmath945 by  . for every @xmath946",
    ", it follows by the definitions of @xmath852 and @xmath947 that @xmath931 or there is some @xmath467 for which @xmath948 .",
    "assume first that there exists a set @xmath949 of size @xmath950 such that @xmath931 holds for every @xmath951 .",
    "it follows by theorem  [ th::chernoff ] ( ii ) that a.a.s . @xmath952 and",
    "the number of arcs of @xmath87 with one endpoint in @xmath953 and the other in @xmath954 is at most @xmath955 on the other hand , it follows by   and the definition of @xmath953 that the number of arcs of @xmath87 with one endpoint in @xmath953 and the other in @xmath954 is at least latexmath:[\\[\\label{eq::arcsf1large }    contrary to  .",
    "assume then that no such set @xmath953 exists .",
    "it follows that there exist some @xmath467 and a set @xmath957 of size @xmath958 such that @xmath948 holds for every @xmath959 .",
    "it follows by theorem  [ th::chernoff ] ( ii ) that a.a.s . @xmath960 and the number of arcs of @xmath87 with one endpoint in @xmath961 and the other in @xmath962 is at most @xmath963 where the inequality in   holds by   and since we consider the moment in which condition ( a ) is violated for the first time",
    ".    on the other hand , it follows by   and the definition of @xmath961 that the number of arcs of @xmath87 with one endpoint in @xmath961 and the other in @xmath962 is at least latexmath:[\\[\\label{eq::arcsf2large }    contrary to  .",
    "next , assume that condition ( b ) is the first to be violated ; let @xmath835 and @xmath109 be such that @xmath965 .",
    "consider the moment at which @xmath966 was first satisfied , that is , the moment in which @xmath55 first became dangerous . since we did not add @xmath55 to @xmath814 even though it became dangerous",
    ", it follows that from this moment until the time @xmath965 first occurred we added to @xmath814 only special vertices ( see lines 5 - 6 of algorithm 1 ) .",
    "in particular , we added at least @xmath967 special vertices to @xmath968 . since , @xmath969 by  , it follows that @xmath970 .",
    "assume first that there exists a set @xmath971 of size @xmath972 such that @xmath931 holds for every @xmath973 .",
    "similar calculations to the ones in  ,   and   show that a.a.s .",
    "the number of arcs of @xmath87 with one endpoint in @xmath974 and the other in @xmath975 is on the one hand at most @xmath976 and on the other hand strictly larger than @xmath976 .",
    "this is clearly a contradiction .",
    "assume then that no such set @xmath974 exists .",
    "it follows that there exist some @xmath467 and a set @xmath977 of size @xmath978 such that @xmath948 holds for every @xmath979 .",
    "similar calculations to the ones in  ,   and   show that a.a.s . the number of arcs of @xmath87 with one endpoint in @xmath974 and the other in @xmath980 is on the one hand at most @xmath981 and on the other hand strictly larger than @xmath981 .",
    "this is clearly a contradiction .",
    "the proof that condition ( c ) is not violated as long as @xmath912 or @xmath913 is essentially the same as the proof for ( b ) ; we omit the straightforward details .",
    "@xmath761 +    while building @xmath814 we may have performed several backward steps . since it would be convenient later on to assume that @xmath814 starts at @xmath211 , at the end of stage 1 we cyclically shift the labels of @xmath426 such that @xmath120 holds again .",
    "we conclude this subsection with a summary of what we have proved ; this will be convenient in the next subsection .",
    "[ prop::summary ] by the end of stage 1 we have built a directed path @xmath814 from @xmath120 to @xmath982 for some @xmath541 which satisfies all of the following properties :    1 .",
    "there exists a set @xmath984 of size @xmath823 .",
    "3 .   @xmath985 for every @xmath109 .",
    "4 .   @xmath986 for every @xmath835 and every @xmath109 .",
    "5 .   @xmath916 for every @xmath835",
    "@xmath538 is nice with respect to @xmath864 .      in this subsection",
    "we extend @xmath814 to an almost spanning path of @xmath87 which satisfies certain desirable properties . throughout this stage",
    "we denote the current path by @xmath815 and let @xmath987 .",
    "initially @xmath988 .",
    "@xmath863 last vertex added to @xmath814 in stage 1 @xmath863 random forward step from @xmath538 with respect to @xmath989    the correctness of algorithm 3 follows immediately from lemma  [ lem::stepsexist ] and since the last vertex added to @xmath814 in stage 1 was nice and was not in @xmath378 .",
    "the remainder of this subsection is dedicated to the proof of the following lemma which will play a crucial role in stage 4 .",
    "[ goodarcs ] asymptotically almost surely , at the end of stage 2 , @xmath990 holds for every @xmath816 .",
    "fix some @xmath816 and let @xmath443 $ ] be a set satisfying all of the following properties :    ( i ) : :    @xmath991 .",
    "( ii ) : :    @xmath515 .",
    "( iii ) : :    at the beginning of stage 2 ,    @xmath992    and    @xmath993    hold for every @xmath445 .",
    "( iv ) : :    @xmath518 and    @xmath519 for every    @xmath520 .",
    "( v ) : :    @xmath55 is not @xmath429-bad of type ii for any    @xmath445 .",
    "the existence of such a set follows from lemma  [ lem::manygoodpairs ] and from parts 1 and 4 of proposition  [ prop::summary ] .",
    "note that , while properties ( i ) , ( ii ) , ( iv ) and ( v ) hold throughout stage 2 , property ( iii ) might be violated during the construction of @xmath815 .",
    "hence , we first prove that a.a.s .",
    ", at the moment @xmath994 first occurs , @xmath995 satisfies a weaker version of this property .",
    "[ cl::largeremainingneighbourhood ] with probability at least @xmath996 , at the moment @xmath994 first occurs , @xmath997 and @xmath998 hold for every @xmath445 .",
    "fix an arbitrary @xmath445 and let @xmath999 be an arbitrary set of size @xmath824 ; such a set exists since @xmath1000 and so @xmath1001 .",
    "it follows by lemma  [ lem::threestepsupperbound ] that whenever we perform 3 consecutive random forward steps @xmath664 and @xmath665 , where @xmath1002 , we have @xmath1003 . since we only consider the first @xmath1004 random forward steps made in stage 2 , we consider at most @xmath1005 vertices of @xmath1006",
    "let @xmath1007 , then @xmath1008 .",
    "we claim that , at the moment @xmath994 first occurs , @xmath1009 is dominated by @xmath1010 , that is , @xmath1011 holds for every @xmath1012 .",
    "indeed , whenever we add to @xmath815 an arc @xmath3 , where @xmath1013 and @xmath1014 , we can imagine that a coin is tossed with the probability of _ success _ , that is , the probability that @xmath1015 , being at most @xmath1016 .",
    "it thus follows by theorem  [ th::chernoff ] ( iv ) that at the moment @xmath994 first occurs @xmath1017 an analogous argument shows that @xmath1018 holds as well .",
    "a union bound over the @xmath535 elements of @xmath995 shows that the probability that there exists some @xmath445 for which @xmath1019 or @xmath1020 is @xmath1021 .",
    "it follows by property ( iii ) that with probability at least @xmath996 we have @xmath1022 and @xmath998 for every @xmath445 .",
    "consider the path @xmath815 at the moment @xmath994 first occurs and assume that @xmath997 and @xmath998 hold at this point for every @xmath445 . at this point ,",
    "let @xmath1023 , that is , @xmath1024 is a random variable which counts some of the arcs of @xmath815 which can absorb @xmath55 . in order to complete the proof of lemma  [ goodarcs ]",
    ", it suffices to prove that @xmath1025 .",
    "let @xmath445 be an arbitrary index .",
    "let @xmath1026 and @xmath1027 be four consecutive arcs of @xmath1028 , where @xmath1029 for every @xmath1030 .",
    "assume that @xmath1031 was still true immediately after the random forward step @xmath1027 was made .",
    "it follows by the description of algorithm 3 , by   and by parts 2 and 3 of proposition  [ prop::summary ] that @xmath1032 holds at this point for every @xmath109 .",
    "it follows by properties ( ii ) and ( v ) above and by claim  [ cl::largeremainingneighbourhood ] that there exist sets @xmath1033 of size @xmath1034 and @xmath1035 of size @xmath1036 for which all the conditions of lemma  [ lem::foursteps ] are satisfied ( with @xmath1037 , @xmath1038 , @xmath1039 , @xmath1040 and @xmath1041 ) .",
    "therefore @xmath1042    let @xmath1043 be independent random variables , where @xmath1044 for every @xmath1045 .",
    "let @xmath1046 , then @xmath1047 . we claim that @xmath1024 dominates @xmath1048 , that is , that @xmath1049 for every @xmath1012 .",
    "indeed , note that the inequality   holds regardless of the choice of @xmath1050 ( as long as it is a nice vertex , it is not bad of type i with respect to @xmath1051 and @xmath445 ) .",
    "therefore , whenever we add to @xmath815 an arc @xmath114 , where @xmath1052 and @xmath1053 for some @xmath1045 , we can imagine that a coin is tossed with the probability of _ success _ , that is , the probability that @xmath1054 and @xmath1055 , being at least @xmath1056 .",
    "moreover , for every @xmath1045 , we consider all arcs @xmath1057 , added to @xmath815 during stage 2 until @xmath994 first occurred .",
    "hence we consider at least @xmath1058 arcs @xmath114 such that @xmath1052 and @xmath1053 , that is , there are at least @xmath1059 trials . hence , it follows by theorem  [ th::chernoff ] ( i ) that @xmath1060    since @xmath816 was arbitrary , it follows by a union bound argument that a.a.s .",
    "claim  [ cl::largeremainingneighbourhood ] , and thus also @xmath1061 , hold for every @xmath816 .",
    "this subsection consists of two parts , namely stage 3 and stage 4 . in stage 3",
    "we will close the path @xmath815 which was built in stage 2 into a cycle . in stage 4",
    "we will use lemma  [ goodarcs ] and lemma  [ lem::matchingstage4 ] to absorb all of the remaining vertices into @xmath118 thus creating a hamilton cycle .    * stage 3 : * in this stage we close @xmath815 into a directed cycle @xmath118 , by adding a few more arcs . throughout this stage",
    ", we denote the current path by @xmath1062 and let @xmath1063 . initially @xmath1064 .",
    "@xmath863 last vertex added to @xmath815 in stage 2 @xmath863 standard forward step from @xmath538 with respect to @xmath1065 make closing step from @xmath538 to @xmath129 with respect to @xmath1066 .",
    "it is evident that , if it works , this algorithm returns a cycle @xmath118 of @xmath87 .",
    "it thus remains to prove the correctness of the algorithm .",
    "the existence of the required standard forward steps follows from lemma  [ lem::stepsexist ] since the last vertex added to @xmath815 in stage 2 was nice , @xmath1067 and @xmath1068 holds for every @xmath109 throughout this stage . since , moreover , @xmath1069 is of size @xmath823 , the conditions of lemma  [ lem::closingstep ] are met as well ; this proves the existence of the required closing step .    * stage 4 : * in this final stage , we extend the directed cycle @xmath118 , built in stage 3 , to a hamilton cycle of @xmath87 by absorbing all remaining vertices .",
    "let @xmath1070 and let @xmath133 denote the bipartite graph with bipartition @xmath1071 in which a vertex @xmath1072 is connected by an edge of @xmath133 to an arc @xmath1073 if and only if @xmath112 and @xmath113 .",
    "@xmath1074 a matching of @xmath133 @xmath1075    it is evident that , if it works , this algorithm returns a hamilton cycle of @xmath87 .",
    "thus , in order to complete the proof of theorem  [ directedham ] it remains to prove that @xmath133 admits a matching of size @xmath1076 .",
    "it follows by the description of stage 2 that @xmath1077 holds for every @xmath1078 .",
    "hence , at the end of stage 2 we have @xmath1079 for every @xmath541 , where the last inequality holds by part 3 of proposition  [ prop::summary ] and since @xmath1080",
    ". therefore @xmath1081 where the last inequality holds since @xmath768 .",
    "since every non - empty subset of @xmath1082 spans a digraph with maximum out - degree 1 and maximum in - degree 1 , it follows by   and by lemma  [ lem::edgedistribution ] ( with @xmath1083 and @xmath1084 ) that a.a.s .",
    "@xmath1085 for every @xmath1086 and @xmath1087 such that @xmath350 .",
    "moreover , it follows by lemma  [ goodarcs ] that a.a.s .",
    "@xmath1088 holds for every @xmath1072 .",
    "we conclude that a.a.s .",
    "@xmath133 satisfies the conditions of lemma  [ lem::matchingstage4 ] ( with @xmath1089 , @xmath1090 and @xmath1091 ) and thus a.a.s .",
    "there exists a matching of @xmath133 which saturates @xmath1092 .",
    "we have proved that a.a.s .",
    "@xmath1093 , where @xmath34 is an arbitrarily small constant , provided that @xmath1094 . for _",
    "undirected _ random graphs it was proved in  @xcite that @xmath20 holds a.a.s . for every @xmath21",
    "this is essentially tight since for @xmath1095 a.a.s .",
    "@xmath12 contains no hamilton cycle . since it is also known ( see  @xcite and  @xcite ) that for @xmath1096 directed random graphs are a.a.s .",
    "hamiltonian , it is natural to ask the following question .",
    "recall that our proof of the upper bound in theorem  [ directedham ] does hold for every @xmath21 . on the other hand ,",
    "since our proof method for the lower bound relies on the existence of linearly many pairwise arc disjoint triangles in @xmath2 , each sharing one arc with a given cycle ( recall stage 4 ) , it can not be used when @xmath1097 , and hence some new ideas are required ."
  ],
  "abstract_text": [
    "<S> a classical theorem of ghouila - houri from 1960 asserts that every directed graph on @xmath0 vertices with minimum out - degree and in - degree at least @xmath1 contains a directed hamilton cycle . in this paper </S>",
    "<S> we extend this theorem to a random directed graph @xmath2 , that is , a directed graph in which every ordered pair @xmath3 becomes an arc with probability @xmath4 independently of all other pairs . motivated by the study of resilience of properties of random graphs , we prove that if @xmath5 , then a.a.s . </S>",
    "<S> every subdigraph of @xmath2 with minimum out - degree and in - degree at least @xmath6 contains a directed hamilton cycle . </S>",
    "<S> the constant @xmath7 is asymptotically best possible . </S>",
    "<S> our result also strengthens classical results about the existence of directed hamilton cycles in random directed graphs . </S>"
  ]
}