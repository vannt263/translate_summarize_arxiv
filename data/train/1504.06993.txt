{
  "article_text": [
    "-0.1 cm    -0.1 cm [ fig : introduction ]    -0.5 cm    lossy compression (  jpeg , webp and hevc - msp ) is one class of data encoding methods that uses inexact approximations for representing the encoded content . in this age of information explosion ,",
    "lossy compression is indispensable and inevitable for companies (  _ twitter _ and  _ facebook _ ) to save bandwidth and storage space .",
    "however , compression in its nature will introduce undesired complex artifacts , which will severely reduce the user experience (  figure  [ fig : introduction ] ) .",
    "all these artifacts not only decrease perceptual visual quality , but also adversely affect various low - level image processing routines that take compressed images as input ,  contrast enhancement  @xcite , super - resolution  @xcite , and edge detection  @xcite . however , under such a huge demand , effective compression artifacts reduction remains an open problem .",
    "we take jpeg compression as an example to explain compression artifacts .",
    "jpeg compression scheme divides an image into 8@xmath08 pixel blocks and applies block discrete cosine transformation ( dct ) on each block individually .",
    "quantization is then applied on the dct coefficients to save storage space .",
    "this step will cause a complex combination of different artifacts , as depicted in figure  [ fig : introductiona ] . _ blocking artifacts _ arise when each block is encoded without considering the correlation with the adjacent blocks , resulting in discontinuities at the 8@xmath08 borders . _ ringing effects _ along the edges occur due to the coarse quantization of the high - frequency components ( also known as gibbs phenomenon  @xcite ) .",
    "_ blurring _ happens due to the loss of high - frequency components . to cope with the various compression artifacts ,",
    "different approaches have been proposed , some of which can only deal with certain types of artifacts .",
    "for instance , deblocking oriented approaches  @xcite perform filtering along the block boundaries to reduce only blocking artifacts .",
    "liew  @xcite and foi  @xcite use thresholding by wavelet transform and shape - adaptive dct transform , respectively .",
    "these approaches are good at removing blocking and ringing artifacts , but tend to produce blurred output .",
    "jung  @xcite propose restoration method based on sparse representation .",
    "they produce sharpened images but accompanied with noisy edges and unnatural smooth regions .",
    "to date , deep learning has shown impressive results on both high - level and low - level vision problems .",
    "in particular , the srcnn proposed by dong  @xcite shows the great potential of an end - to - end dcn in image super - resolution .",
    "the study also points out that conventional sparse - coding - based image restoration model can be equally seen as a deep model .",
    "however , we find that the three - layer network is not well suited in restoring the compressed images , especially in dealing with blocking artifacts and handling smooth regions . as various artifacts are coupled together , features extracted by the first layer is noisy , causing undesirable noisy patterns in reconstruction .    to eliminate the undesired artifacts , we improve the srcnn by embedding one or more `` feature enhancement '' layers after the first layer to clean the noisy features .",
    "experiments show that the improved model , namely `` artifacts reduction convolutional neural networks ( ar - cnn ) '' , is exceptionally effective in suppressing blocking artifacts while retaining edge patterns and sharp details ( see figure  [ fig : introduction ] ) . however , we are met with training difficulties in training a deeper dcn .",
    "`` deeper is better '' is widely observed in high - level vision problems , but not in low - level vision tasks .",
    "specifically , `` deeper is not better '' has been pointed out in super - resolution  @xcite , where training a five - layer network becomes a bottleneck .",
    "the difficulty of training is partially due to the sub - optimal initialization settings .",
    "the aforementioned difficulty motivates us to investigate a better way to train a deeper model for low - level vision problems .",
    "we find that this can be effectively solved by transferring the features learned in a shallow network to a deeper one and fine - tuning simultaneously .",
    "this strategy has also been proven successful in learning a deeper cnn for image classification  @xcite . following a similar general intuitive idea , _ easy to hard _",
    ", we discover other interesting transfer settings in this low - level vision task : ( 1 ) we transfer the features learned in a high - quality compression model ( easier ) to a low - quality one ( harder ) , and find that it converges faster than random initialization .",
    "( 2 ) in the real use case , companies tend to apply different compression strategies ( including re - scaling ) according to their purposes (  figure  [ fig : introductionb ] ) .",
    "we transfer the features learned in a standard compression model ( easier ) to a real use case ( harder ) , and find that it performs better than learning from scratch .",
    "the contributions of this study are three - fold : ( 1 ) we formulate a new deep convolutional network for efficient reduction of various compression artifacts .",
    "extensive experiments , including that on real use cases , demonstrate the effectiveness of our method over state - of - the - art methods  @xcite both perceptually and quantitatively .",
    "( 2 ) we verify that reusing the features in shallow networks is helpful in learning a deeper model for compression artifact reduction . under the same intuitive idea",
    " _ easy to hard _ , we reveal a number of interesting and practical transfer settings .",
    "our study is the first attempt to show the effectiveness of feature transfer in a low - level vision problem .",
    "( 3 ) we show the effectiveness of ar - cnn in facilitating other low - level vision routines (  super - resolution and contrast enhancement ) , when they take jpeg images as input .",
    "existing algorithms can be classified into deblocking oriented and restoration oriented methods .",
    "the deblocking oriented methods focus on removing blocking and ringing artifacts . in the spatial domain ,",
    "different kinds of filters  @xcite have been proposed to adaptively deal with blocking artifacts in specific regions ( ,  edge , texture , and smooth regions ) . in the frequency domain ,",
    "liew  @xcite utilize wavelet transform and derive thresholds at different wavelet scales for denoising .",
    "the most successful deblocking oriented method is perhaps the pointwise shape - adaptive dct ( sa - dct )  @xcite , which is widely acknowledged as the state - of - the - art approach  @xcite .",
    "however , as most deblocking oriented methods , sa - dct could not reproduce sharp edges , and tend to overly smooth texture regions .",
    "the restoration oriented methods regard the compression operation as distortion and propose restoration algorithms .",
    "they include projection on convex sets based method ( pocs )  @xcite , solving an map problem ( foe )  @xcite , sparse - coding - based method  @xcite and the regression tree fields based method ( rtf )  @xcite , which is the new state - of - the art method .",
    "the rtf takes the results of sa - dct  @xcite as bases and produces globally consistent image reconstructions with a regression tree field model .",
    "it could also be optimized for any differentiable loss functions (  ssim ) , but often at the cost of other evaluation metrics .    super - resolution convolutional neural network ( srcnn )",
    "@xcite is closely related to our work . in the study ,",
    "independent steps in the sparse - coding - based method are formulated as different convolutional layers and optimized in a unified network .",
    "it shows the potential of deep model in low - level vision problems like super - resolution .",
    "however , the model of compression is different from super - resolution in that it consists of different kinds of artifacts .",
    "designing a deep model for compression restoration requires a deep understanding into the different artifacts .",
    "we show that directly applying the srcnn architecture for compression restoration will result in undesired noisy patterns in the reconstructed image .",
    "transfer learning in deep neural networks becomes popular since the success of deep learning in image classification  @xcite .",
    "the features learned from the imagenet show good generalization ability  @xcite and become a powerful tool for several high - level vision problems , such as pascal voc image classification  @xcite and object detection  @xcite .",
    "yosinski  @xcite have also tried to quantify the degree to which a particular layer is general or specific .",
    "overall , transfer learning has been systematically investigated in high - level vision problems , but not in low - level vision tasks . in this study , we explore several transfer settings on compression artifacts reduction and show the effectiveness of transfer learning in low - level vision problems .",
    "our proposed approach is based on the current successful low - level vision model  srcnn  @xcite . to have a better understanding of our work",
    ", we first give a brief overview of srcnn .",
    "then we explain the insights that lead to a deeper network and present our new model .",
    "subsequently , we explore three types of transfer learning strategies that help in training a deeper and better network .",
    "the srcnn aims at learning an end - to - end mapping , which takes the low - resolution image @xmath1 ( after interpolation ) as input and directly outputs the high - resolution one @xmath2 .",
    "the network contains three convolutional layers , each of which is responsible for a specific task .",
    "specifically , the first layer performs * patch extraction and representation * , which extracts overlapping patches from the input image and represents each patch as a high - dimensional vector",
    ". then the * non - linear mapping * layer maps each high - dimensional vector of the first layer to another high - dimensional vector , which is conceptually the representation of a high - resolution patch . at last , the * reconstruction * layer aggregates the patch - wise representations to generate the final output .",
    "the network can be expressed as : @xmath3 where @xmath4 and @xmath5 represent the filters and biases of the @xmath6th layer respectively , @xmath7 is the output feature maps and @xmath8 denotes the convolution operation .",
    "the @xmath4 contains @xmath9 filters of support @xmath10 , where @xmath11 is the spatial support of a filter , @xmath9 is the number of filters , and @xmath12 is the number of channels in the input image . note that there is no pooling or full - connected layers in srcnn , so the final output @xmath2 is of the same size as the input image .",
    "rectified linear unit ( relu , @xmath13 )  @xcite is applied on the filter responses .",
    "these three steps are analogous to the basic operations in the sparse - coding - based super - resolution methods  @xcite , and this close relationship lays theoretical foundation for its successful application in super - resolution .",
    "details can be found in the paper  @xcite .",
    "* insights . * in sparse - coding - based methods and srcnn , the first step  feature extraction  determines what should be emphasized and restored in the following stages .",
    "however , as various compression artifacts are coupled together , the extracted features are usually noisy and ambiguous for accurate mapping . in the experiments of reducing jpeg compression artifacts ( see section  [ sec : exp_srcnn ] ) , we find that some quantization noises coupled with high frequency details are further enhanced , bringing unexpected noisy patterns around sharp edges .",
    "moreover , blocking artifacts in flat areas are misrecognized as normal edges , causing abrupt intensity changes in smooth regions .",
    "inspired by the feature enhancement step in super - resolution  @xcite , we introduce a feature enhancement layer after the feature extraction layer in srcnn to form a new and deeper network  ar - cnn .",
    "this layer maps the `` noisy '' features to a relatively `` cleaner '' feature space , which is equivalent to denoising the feature maps .    *",
    "* the overview of the new network ar - cnn is shown in figure  [ fig : framework ] .",
    "the three layers of srcnn remain unchanged in the new model .",
    "we also use the same annotations as in section  [ sec : srcnn ] . to conduct feature enhancement",
    ", we extract new features from the @xmath14 feature maps of the first layer , and combine them to form another set of feature maps .",
    "this operation @xmath15 can also be formulated as a convolutional layer : @xmath16 where @xmath17 corresponds to @xmath18 filters with size @xmath19 .",
    "@xmath20 is an @xmath18-dimensional bias vector , and the output @xmath21 consists of @xmath18 feature maps .",
    "overall , the ar - cnn consists of four layers , namely the feature extraction , feature enhancement , mapping and reconstruction layer .",
    "it is worth noticing that ar - cnn is not equal to a deeper srcnn that contains more than one non - linear mapping layers . rather than imposing more non - linearity in the mapping stage",
    ", ar - cnn improves the mapping accuracy by enhancing the extracted low - level features .",
    "experimental results of ar - cnn , srcnn and deeper srcnn will be shown in section  [ sec : exp_srcnn ]      given a set of ground truth images @xmath22 and their corresponding compressed images @xmath23 , we use mean squared error ( mse ) as the loss function : @xmath24 where @xmath25 , @xmath26 is the number of training samples .",
    "the loss is minimized using stochastic gradient descent with the standard backpropagation .",
    "we adopt a batch - mode learning method with a batch size of 128 .",
    "second row : the 5-layer ar - cnn targeted at _ dataa_-@xmath27 .",
    "third row : the ar - cnn targeted at _ dataa_-@xmath28 .",
    "fourth row : the ar - cnn targeted at _ twitter _ data .",
    "green boxes indicate the transferred features from the base network , and gray boxes represent random initialization .",
    "the ellipsoidal bars between weight vectors represent the activation functions.,title=\"fig : \" ] -3.9 cm    transfer learning in deep models provides an effective way of initialization .",
    "in fact , conventional initialization strategies (  randomly drawn from gaussian distributions with fixed standard deviations  @xcite ) are found not suitable for training a very deep model , as reported in  @xcite . to address this issue",
    ", he  @xcite derive a robust initialization method for rectifier nonlinearities , simonyan  @xcite propose to use the pre - trained features on a shallow network for initialization .    in low - level vision problems (  super resolution )",
    ", it is observed that training a network beyond 4 layers would encounter the problem of convergence , even that a large number of training images (  imagenet ) are provided  @xcite .",
    "we are also met with this difficulty during the training process of ar - cnn . to this end",
    ", we systematically investigate several transfer settings in training a low - level vision network following an intuitive idea of `` easy - hard transfer '' .",
    "specifically , we attempt to reuse the features learned in a relatively easier task to initialize a deeper or harder network .",
    "interestingly , the concept `` easy - hard transfer '' has already been pointed out in neuro - computation study  @xcite , where the prior training on an easy discrimination can help learn a second harder one .",
    "formally , we define the base ( or source ) task as _ a _ and the target tasks as _ @xmath29 _ , @xmath30 .",
    "as shown in figure  [ fig : easy - hard1 ] , the base network _",
    "basea _ is a four - layer ar - cnn trained on a large dataset _",
    "of which images are compressed using a standard compression scheme with the compression quality _ qa_. all layers in _ basea _ are randomly initialized from a gaussian distribution .",
    "we will transfer one or two layers of _ basea _ to different target tasks ( see figure  [ fig : easy - hard1 ] ) .",
    "such transfers can be described as follows .",
    "* transfer shallow to deeper model . * as indicated by  @xcite , a five - layer network is sensitive to the initialization parameters and learning rate .",
    "thus we transfer the first two layers of _ basea _ to a five - layer network _",
    "target@xmath31_. then we randomly initialize its remaining layers _ , and _",
    "@xmath32_. ] and train all layers toward the same dataset _",
    "dataa_. this is conceptually similar to that applied in image classification  @xcite , but this approach has never been validated in low - level vision problems .",
    "* transfer high to low quality .",
    "* images of low compression quality contain more complex artifacts .",
    "here we use the features learned from high compression quality images as a starting point to help learn more complicated features in the dcn .",
    "specifically , the first layer of _",
    "target@xmath33 _ are copied from _",
    "basea _ and trained on images that are compressed with a lower compression quality _",
    "* transfer standard to real use case .",
    "* we then explore whether the features learned under a standard compression scheme can be generalized to other real use cases , which often contain more complex artifacts due to different levels of re - scaling and compression .",
    "we transfer the first layer of _ basea _ to the network _",
    "target@xmath32 _ , and train all layers on the new dataset .    * discussion .",
    "* why the features learned from relatively easy tasks are helpful ?",
    "first , the features from a well - trained network can provide a good starting point .",
    "then the rest of a deeper model can be regarded as shallow one , which is easier to converge .",
    "second , features learned in different tasks always have a lot in common .",
    "for instance , figure  [ fig : features ] shows the features learned under different jpeg compression qualities .",
    "obviously , filters @xmath34 of high quality are very similar to filters @xmath35 of low quality .",
    "this kind of features can be reused or improved during fine - tuning , making the convergence faster and more stable .",
    "furthermore , a deep network for a hard problem can be seen as an insufficiently biased learner with overly large hypothesis space to search , and therefore is prone to overfitting .",
    "these few transfer settings we investigate introduce good bias to enable the learner to acquire a concept with greater generality .",
    "experimental results in section  [ sec : transfer ] validate the above analysis .",
    "-0.2 cm -0.16 cm [ fig : features ]    -0.4 cm",
    "we use the bsds500 database  @xcite as our base training set .",
    "specifically , its disjoint training set ( 200 images ) and test set ( 200 images ) are all used for training , and its validation set ( 100 images ) is used for validation . as in other compression artifacts reduction methods (  rtf  @xcite ) ,",
    "we apply the standard jpeg compression scheme , and use the jpeg quality settings @xmath36  ( mid quality ) and @xmath37  ( low quality ) in matlab jpeg encoder .",
    "we only focus on the restoration of the luminance channel ( in ycrcb space ) in this paper .",
    "the training image pairs @xmath38 are prepared as follows  images in the training set are decomposed into @xmath39 sub - images @xmath40 . then the compressed samples @xmath41 are generated from the training samples with matlab jpeg encoder  @xcite .",
    "the sub - images are extracted from the ground truth images with a stride of 10 .",
    "thus the 400 training images could provide 537,600 training samples . to avoid the border effects caused by convolution , ar - cnn produces a @xmath42 output given a @xmath43 input @xmath44 . hence , the loss ( eqn .",
    "( [ eqn : loss ] ) ) was computed by comparing against the center @xmath42 pixels of the ground truth sub - image @xmath45 . in the training phase ,",
    "we follow  @xcite and use a smaller learning rate ( @xmath46 ) in the last layer and a comparably larger one ( @xmath47 ) in the remaining layers .",
    "we use the live1 dataset  @xcite ( 29 images ) as test set to evaluate both the quantitative and qualitative performance .",
    "the live1 dataset contains images with diverse properties .",
    "it is widely used in image quality assessment  @xcite as well as in super - resolution  @xcite . to have a comprehensive qualitative evaluation",
    ", we apply the psnr , structural similarity ( ssim )  @xcite windows as in  @xcite .",
    "] , and psnr - b  @xcite for quality assessment .",
    "we want to emphasize the use of psnr - b .",
    "it is designed specifically to assess blocky and deblocked images , thus is more sensitive to blocking artifacts than the perceptual - aware ssim index .",
    "the network settings are @xmath48 , @xmath49 , @xmath50 , @xmath51 , @xmath52 , @xmath53 , @xmath54 and @xmath55 , denoted as ar - cnn ( 9 - 7 - 1 - 5 ) or simply ar - cnn .",
    "a specific network is trained for each jpeg quality .",
    "parameters are randomly initialized from a gaussian distribution with a standard deviation of 0.001 .",
    ".the average results of psnr ( db ) , ssim , psnr - b ( db ) on the live1 dataset . [ cols=\"^,^,^,^,^\",options=\"header \" , ]       -0.15 cm    in table  [ tab : transfer ] , we denote a deeper ( five - layer ) ar - cnn as `` 9 - 7 - 3 - 1 - 5 '' , which contains another feature enhancement layer ( @xmath56 and @xmath57 ) . results in figure  [ fig : transfer1 ] show that the transferred features from a four - layer network enable us to train a five - layer network successfully .",
    "note that directly training a five - layer network using conventional initialization ways is unreliable .",
    "specifically , we have exhaustively tried different groups of learning rates , but still have not observed convergence .",
    "furthermore , the `` transfer deeper '' converges faster and achieves better performance than using he  s method  @xcite , which is also very effective in training a deep model .",
    "we have also conducted comparative experiments with the structure `` 9 - 7 - 1 - 1 - 5 '' and observed the same trend .       -0.15 cm",
    "-0.15 cm    results are shown in figure  [ fig : transfer2 ] .",
    "obviously , the two networks with transferred features converge faster than that training from scratch .",
    "for example , to reach an average psnr of 27.77db , the `` transfer 1 layer '' takes only @xmath58 backprops , which are roughly a half of that for `` base - q10 '' .",
    "moreover , the `` transfer 1 layer '' also outperforms the ` base - q10' by a slight margin throughout the training phase .",
    "one reason for this is that only initializing the first layer provides the network with more flexibility in adapting to a new dataset .",
    "this also indicates that a good starting point could help train a better network with higher convergence speed .",
    "online social media like _ twitter _ are popular platforms for message posting .",
    "however , _ twitter _ will compress the uploaded images on the server - side .",
    "for instance , a typical 8 mega - pixel ( mp ) image ( @xmath59 ) will result in a compressed and re - scaled version with a fixed resolution of @xmath60 .",
    "such re - scaling and compression will introduce very complex artifacts , making restoration difficult for existing deblocking algorithms (  sa - dct ) .",
    "however , ar - cnn can fit to the new data easily .",
    "further , we want to show that features learned under standard compression schemes could also facilitate training on a completely different dataset .",
    "we use 40 photos of resolution @xmath59 taken by mobile phones ( totally 335,209 training subimages ) and their _ twitter_-compressed version to train three networks with initialization settings listed in table  [ tab : transfer ] .    -0.2 cm     [ fig : last - fig ]    -1.3 cm    from figure  [ fig : transfer3 ]",
    ", we observe that the `` transfer @xmath61 '' and `` transfer @xmath62 '' networks converge much faster than the `` base - twitter '' trained from scratch .",
    "specifically , the `` transfer @xmath61 '' takes @xmath63 backprops to achieve 25.1db , while the `` base - twitter '' uses @xmath64 backprops . despite of fast convergence ,",
    "transferred features also lead to higher psnr values compared with `` base - twitter '' .",
    "this observation suggests that features learned under standard compression schemes are also transferrable to tackle real use case problems .",
    "some restoration results are shown in figure  .",
    "we could see that both networks achieve satisfactory quality improvements over the compressed version .",
    "in the real application , many image processing routines are affected when they take jpeg images as input .",
    "blocking artifacts could be either super - resolved or enhanced , causing significant performance decrease . in this section ,",
    "we show the potential of ar - cnn in facilitating other low - level vision studies ,   super - resolution and contrast enhancement . to illustrate this , we use srcnn  @xcite for super - resolution and tone - curve adjustment  @xcite for contrast enhancement  @xcite , and show example results when the input is a jpeg image , sa - dct deblocked image , and ar - cnn restored image . from results shown in figure  [ fig : application ]",
    ", we could see that jpeg compression artifacts have greatly distorted the visual quality in super - resolution and contrast enhancement .",
    "nevertheless , with the help of ar - cnn , these effects have been largely eliminated . moreover",
    ", ar - cnn achieves much better results than sa - dct .",
    "the differences between them are more evident after these low - level vision processing .",
    "applying deep model on low - level vision problems requires deep understanding of the problem itself . in this paper",
    ", we carefully study the compression process and propose a four - layer convolutional network , ar - cnn , which is extremely effective in dealing with various compression artifacts .",
    "we further systematically investigate several _ easy - to - hard _ transfer settings that could facilitate training a deeper or better network , and verify the effectiveness of transfer learning in low - level vision problems . as discussed in srcnn  @xcite",
    ", we find that larger filter sizes also help improve the performance .",
    "we will leave them to further work ."
  ],
  "abstract_text": [
    "<S> lossy compression introduces complex compression artifacts , particularly the blocking artifacts , ringing effects and blurring . </S>",
    "<S> existing algorithms either focus on removing blocking artifacts and produce blurred output , or restores sharpened images that are accompanied with ringing effects . </S>",
    "<S> inspired by the deep convolutional networks ( dcn ) on super - resolution  @xcite , we formulate a compact and efficient network for seamless attenuation of different compression artifacts . </S>",
    "<S> we also demonstrate that a deeper model can be effectively trained with the features learned in a shallow network . following a similar `` easy to hard '' idea </S>",
    "<S> , we systematically investigate several practical transfer settings and show the effectiveness of transfer learning in low - level vision problems . </S>",
    "<S> our method shows superior performance than the state - of - the - arts both on the benchmark datasets and the real - world use case (  _ twitter _ ) . </S>",
    "<S> in addition , we show that our method can be applied as pre - processing to facilitate other low - level vision routines when they take compressed images as input . </S>"
  ]
}