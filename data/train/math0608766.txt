{
  "article_text": [
    "we give some heuristics for counting elliptic curves with certain properties . in particular , we re - derive the brumer - mcguinness heuristic for the number of curves with positive / negative discriminant up to  @xmath0 , which is an application of lattice - point counting .",
    "we then introduce heuristics ( with refinements from random matrix theory ) that allow us to predict how often we expect an elliptic curve  @xmath1 with even parity to have @xmath2 .",
    "it turns out that we roughly expect that a curve with even parity has @xmath2 with probability proportional to the square root of its real period , and , since the real period is very roughly  @xmath6 , this leads us to the prediction that almost all curves with even parity should have  @xmath7 . by the conjecture of birch and swinnerton - dyer",
    ", this says that almost all such curves have rank  0 .",
    "we then make similar heuristics when enumerating by conductor .",
    "the first task here is simply to count curves with conductor up to  @xmath0 , and for this we use heuristics involving how often large powers of primes divide the discriminant . upon making this estimate , we are then able to imitate the argument we made previously , and thus derive an asymptotic for the number of curves with even parity and @xmath2 under the ordering by conductor .",
    "we again get the heuristic that almost all curves with even parity should have  @xmath7 .",
    "we then make a few remarks regarding how often curves should have nontrivial isogenies and/or torsion under different orderings , and then present some data regarding average ranks .",
    "we conclude by giving data for mordell - weil lattice distribution for rank 2 curves , and speculating about symmetric power @xmath8-functions .",
    "first we re - derive the brumer - mcguinness heuristic  @xcite for the number of elliptic curves whose absolute discriminant is less than a given bound  @xmath0 ; the technique here is essentially lattice - point counting , and we derive our estimates via the assumption that these counts are well - approximated by the areas of the given regions .",
    "[ conj : bmcg][brumer - mcguinness ] the number @xmath9 of rational elliptic curves with a global minimal model ( including at @xmath10 ) and positive or negative discriminant whose absolute value is less than  @xmath0 is asymptotically @xmath11 , where @xmath12 .",
    "as indicated by brumer and mcguinness , the identity @xmath13 was already known to legendre , and is related to complex multiplication .",
    "these constants can be expressed in terms of beta integrals @xmath14 as @xmath15 and @xmath16 .",
    "recall that every rational elliptic curve has a unique integral minimal model @xmath17 with @xmath18 and @xmath19 .",
    "fix one of the 12 choices of  @xmath20 . since these are all bounded by  1",
    "the discriminant is thus approximately  @xmath21 .",
    "so we wish to count the number of @xmath22-lattice - points with  @xmath23 , noting that brumer and mcguinness divide the curves according to the sign of the discriminant .",
    "the lattice - point count for @xmath24 is given by @xmath25 we estimate this lattice - point count by the integral @xmath26 for the region @xmath27 given by @xmath28 .",
    "after splitting into two parts based upon the sign of the discriminant and performing the @xmath29-integration , we get @xmath30\\ , du_6+\\\\ & + { 2\\over ( 64)^{1/3 } } \\int_0^\\infty \\bigl[(x-432u_6 ^ 2)^{1/3}-(-432u_6 ^ 2)^{1/3}\\bigr]\\ , du_6,\\end{aligned}\\ ] ] where the factor of @xmath31 comes from the sign of  @xmath32 . changing variables @xmath33 and multiplying by  12 for the number of @xmath20-choices we get @xmath34\\ , dw+\\\\ & + { 24\\over ( 64)^{1/3}}{x^{5/6}\\over \\sqrt{432 } } \\int_0^\\infty \\bigl[(w^2)^{1/3}-(w^2 - 1)^{1/3}\\bigr]\\ , dw.\\end{aligned}\\ ] ] these integrals",
    "are probably known , but i am unable to find a reference .",
    "the first integral simplifies\\ , dt$ ] , differentiate under the integral sign , then substitute  @xmath35 , and finally re - integrate to obtain  @xmath36 . ] to @xmath37 , while the second becomes @xmath38 .",
    "this counts all models of curves ; if we eliminate non - minimal models , for which we have @xmath39 and  @xmath40 for some prime  @xmath41 , we expect to accrue an extra factor necessarily have odd discriminant , but the other choices compensate to give the proper euler factors at 2 ( and 3 ) . ] of  @xmath42 . from this , we get the conjecture of brumer and mcguinness as stated above .",
    "see @xcite for definitions of the conductor @xmath43 and @xmath8-function @xmath44 of an elliptic curve  @xmath1 .",
    "since rational elliptic curves are modular , we have that the completed @xmath8-function @xmath45 satisfies @xmath46 .",
    "when the plus sign occurs , we say that @xmath1 has even parity .",
    "we now try to count elliptic curves @xmath1 with even parity for which  @xmath2 . throughout this section",
    ", @xmath1 shall be a curve with even parity , and we shall order curves by discriminant . via the conjectural parity principle , we expect that , under any reasonable ordering , half of the elliptic curves should have even parity ; in particular , we predict that there are asymptotically @xmath47 curves with even parity and positive / negative discriminant up to  @xmath0 .",
    "our main tool shall be random matrix theory , which gives a heuristic for predicting how often @xmath48 is small .",
    "we could alternatively derive a cruder heuristic by assuming the the order of the shafarevich - tate group is a random square integer in a given interval , but random matrix theory has the advantage of being able to predict a more explicit asymptotic .",
    "our principal heuristic is the following :    [ conj : rank2disc ] the number @xmath49 of rational elliptic curves @xmath1 with even parity and @xmath2 and absolute discriminant less than  @xmath0 is given asymptotically by @xmath50 for some computable constant  @xmath51 .    in particular , note that we get the prediction that almost all curves with even parity have @xmath7 under this ordering .      originally developed in mathematical statistics by wishart @xcite in the 1920s and then in mathematical physics ( especially the spectra of highly excited nuclei ) by wigner @xcite , dyson ,",
    "mehta , and others ( particularly  @xcite ) , random matrix theory @xcite has now found some applications in number theory , the earliest being the oft - told story of dyson s remark to montgomery regarding the pair - correlation of zeros of the riemann @xmath52-function .",
    "based on substantial numerical evidence , random matrix theory appears to give reasonable models for the distribution of @xmath8-values in families , though the issue of what constitutes a proper family is a delicate one ( see particularly @xcite , where the notion of family comes from the ability to calculate moments of @xmath8-functions rather than from algebraic geometry ) .",
    "the family of quadratic twists of a given elliptic curve @xmath53 is given by @xmath54 for squarefree  @xmath55 .",
    "the work ( most significantly a monodromy computation ) of katz and sarnak @xcite regarding families of curves over function fields implies that when we restrict to quadratic twists with even parity , we should expect that the @xmath8-functions are modelled by random matrices with even orthogonal symmetry .",
    "though we have no function field analogue in our case , we brazenly assume ( largely from looking at the sign in the functional equation ) that the symmetry type is again orthogonal with even parity .",
    "what this means is that we want to model properties of the @xmath8-function via random matrices taken from @xmath56 with respect to haar measure . here",
    "we wish the mean density of zeros of the to match the mean density of eigenvalues of our matrices , and so , as in  @xcite , we should take @xmath57 .",
    "we suspect that the @xmath8-value distribution is approximately given by the distribution of the evaluations at  @xmath58 of the characteristic polynomials of our random matrices . in the large , this distribution",
    "is determined entirely by the symmetry type , while finer considerations are distinguished via arithmetic considerations .    with this assumption ,",
    "via the moment conjectures of @xcite and then using mellin inversion , as @xmath59 we have ( see ( 21 ) of @xcite ) that @xmath60\\sim \\alpha(e ) t^{1/2}m^{3/8}.\\ ] ] this heuristic is stated for fixed @xmath61 , but we shall also allow @xmath62 .",
    "it is not easy to understand this probability , as both the constant @xmath63 and the matrix - size @xmath64 depend on  @xmath1 .",
    "we can take curves with @xmath65 to mollify the impact of the conductor , but in order to average over a set of curves , we need to understand how @xmath63 varies .",
    "one idea is that @xmath63 separates into two parts , one of which depends on local structure ( frobenius traces ) of the curve , and the other of which depends only upon the size of the conductor  @xmath43 .",
    "letting @xmath66 be the barnes @xmath66-function ( such that @xmath67 with @xmath68 ) and @xmath69 we have that @xmath70 @xmath71 and @xmath72 where @xmath73 when @xmath74 and @xmath75 otherwise ; see ( 10 ) of @xcite evaluated at  @xmath76 , though that equation is wrong at primes that divide the discriminant  see ( 20 ) of  @xcite , where @xmath77 should be taken to be  1 .",
    "note that the sato - tate conjecture @xcite implies that @xmath78 is @xmath41 on average , and this implies that the above euler product converges .      for precise definitions of the tamagawa numbers , torsion group , periods , and shafarevich - tate group ,",
    "see  @xcite , though below we give a brief description of some of these .",
    "we let @xmath79 be the tamagawa number of  @xmath1 at the ( possibly infinite ) prime  @xmath41 , and write @xmath80 for the tamagawa product and @xmath81 for the size of the torsion group .",
    "we also write @xmath82 for the real period and @xmath83 for the size of the shafarevich - tate group when @xmath7 , with @xmath84 when @xmath2 .",
    "we wish to assert that sufficiently small values of  @xmath48 actually correspond to  @xmath2 .",
    "we do this via the conjectural formula of birch and swinnerton - dyer  @xcite , which asserts that @xmath85 our discretisation will be that @xmath86 note that we are only using that @xmath87 takes on integral values , and do not use the ( conjectural ) fact that it is square .",
    "using , we estimate the number of curves with positive ( for simplicity ) discriminant less than  @xmath0 and even parity and @xmath2 via the lattice - point sum @xmath88 we need to introduce congruence conditions on @xmath89 and @xmath90 to make sure that they correspond to a minimal model of an elliptic curve .",
    "the paper @xcite uses the work of connell @xcite in a different context to get that there are 288 classes of @xmath91 that can give minimal models , and so we get a factor of  @xmath92 , assuming that each congruence class has the same impact on all the entities in the sum .",
    "indeed , this independence ( on average ) of various quantities with respect to @xmath89 and @xmath90 is critical in our estimation of  @xmath93 .",
    "there is also the question of non - minimal models , , non - minimality occurs when @xmath94 and @xmath95 satisfy the congruences . ] from which we get a factor of  @xmath96 .",
    "[ guess ] the lattice - point sum @xmath93 can be approximated as @xmath97 by @xmath98 here @xmath99 is the limit @xmath100 of @xmath101 as @xmath62 , while @xmath102 is a suitable average of the arithmetic factors @xmath103 , and @xmath104 is the average of the square root of the tamagawa product .",
    "we have also approximated @xmath105 and assumed the torsion is trivial ; below we will give these heuristic justification  ( on average ) .",
    "note that everything left in the integral is a smooth function of @xmath29 and @xmath32 .",
    "we shall first evaluate the integral in @xmath106 given these suppositions , and then try to justify the various assumptions that are inherent in this guess .",
    "write @xmath1 as @xmath107 , and put @xmath108 for the roots of the cubic polynomial on the right side .",
    "we have @xmath109 we also have that @xmath110 from the formula for the discriminant .",
    "we next write @xmath111 and @xmath112 so that we have @xmath113 , while @xmath114 , @xmath115 , and @xmath116 .",
    "thus we get @xmath117 and @xmath118 changing variables in the @xmath119-integral gives a jacobian of @xmath120 so that @xmath121 where @xmath122 .",
    "thus the variables are nicely separated , and since the @xmath123-integral converges , we do indeed get @xmath124 .",
    "a similar argument can be given for curves with negative discriminant .",
    "this concludes our derivation of heuristic  [ conj : rank2disc ] , and now we turn to giving some reasons for our expectation that the arithmetic factors can be mollified by taking their averages .      in the next section we shall explain ( among other things )",
    "why we expect that @xmath125 for almost all curves , and in section  [ section : torsion ] , we shall recall the classical parametrisations of @xmath126 due to fricke to indicate why we expect the torsion size is 1 on average . here",
    "we show how to compute the various averages ( with respect to ordering by discriminant ) of the square root of the tamagawa product and the arithmetic factors  @xmath103 .    for both heuristics",
    ", we shall make the assumption that curves satisfying the discriminant bound @xmath127 behave essentially the same as those that satisfy @xmath128 and @xmath129 .",
    "that is , we approximate our region by a big box . we write @xmath130 for the absolute value of  @xmath131 .",
    "first we consider the tamagawa product .",
    "we wish to know how often a prime divides the discriminant to a high power .",
    "fix a prime  @xmath132 with @xmath41 a lot smaller than  @xmath133 .",
    "we can estimate the probability that  @xmath134 by considering all @xmath135 choices of @xmath89 and @xmath90 modulo  @xmath136 , that is , by counting the number of solutions @xmath137 to @xmath138 ( mod  @xmath136 ) .",
    "this auxiliary curve @xmath139 is singular at @xmath140 over  @xmath141 , and has @xmath142 non - singular @xmath141-solutions which lift to @xmath143 points modulo  @xmath136 .    for @xmath136 sufficiently small ,",
    "our @xmath144-region is so large that we can show that the probability that @xmath134 is  @xmath145 .",
    "we assume that big primes act ( on average ) in the same manner , while a similar heuristic can be given for  @xmath146 .",
    "curves with @xmath39 and @xmath147 will not be given by their minimal model ; indeed , we want to exclude these curves , and thus will multiply our probabilities by @xmath148 to make them conditional on this criterion .",
    "for instance , the above counting of points says that there is a probability of @xmath149 that  @xmath150 , and so upon conditioning upon minimal models we get @xmath151 for this probability .    what is the probability @xmath152 that a curve given by a minimal model has multiplicative reduction at @xmath132 and @xmath153 for some  @xmath154 ? in terms of kodaira symbols , this is the case of i@xmath155 . for multiplicative reduction",
    "we need that @xmath156 .",
    "these events are independent and each has a probability @xmath157 of occurring .",
    "upon assuming these conditions and working modulo  @xmath136 , there are @xmath158 such choices for each , and of the resulting @xmath144 pairs we noted above that @xmath143 of them have  @xmath159 .",
    "so , given a curve with  @xmath156 , we have a probability of @xmath160 that  @xmath159 , which gives @xmath161 for the probability that  @xmath153 . in symbols",
    ", we have that ( for  @xmath132 and @xmath162 ) @xmath163=1/p^k.\\ ] ] including the conditional probability for minimal models , we get @xmath164 note that summing this over @xmath162 gives @xmath165 for the probability for an elliptic curve to have multiplicative reduction at  @xmath41 .    what is the probability @xmath166 that a curve given by a minimal model has additive reduction at @xmath132 and @xmath153 for some  @xmath154 ?",
    "we shall temporarily ignore the factor of @xmath148 from non - minimal models and include it at the end .",
    "we must have that @xmath167 , and thus get that  @xmath168 . for @xmath169 , which correspond to kodaira symbols ii , iii , and iv respectively ,",
    "the computation is not too bad : we get that @xmath170 exactly when @xmath171 and  @xmath172 , so that the probability is @xmath173 ; for @xmath174 we need @xmath175 and @xmath176 and thus get @xmath177 for the probability ; and for @xmath178 we need @xmath179 and @xmath180 and so get @xmath181 for the probability .",
    "note that the case @xmath182 can not occur .",
    "thus we have ( for  @xmath132 ) the formula @xmath183 for @xmath169 .",
    "more complications occur for @xmath184 , where now we split into two cases depending upon whether additive reduction persists upon taking the quadratic twist by  @xmath41 .",
    "this occurs when @xmath185 and @xmath186 , and we denote by @xmath187 the probability that @xmath153 in this subcase .",
    "just as above , we get that @xmath188 for @xmath189 .",
    "these are respectively the cases of kodaira symbols iv@xmath190 , iii@xmath190 , and  ii@xmath190 .",
    "for @xmath191 we have  @xmath192 , while for @xmath193 our condition of minimality implies that we should take  @xmath192 .",
    "we denote by @xmath194 the probability that @xmath195 with either @xmath196 or @xmath197 .",
    "first we consider curves for which @xmath198 , and these have multiplicative reduction at  @xmath41 upon twisting .",
    "in particular , these curves have @xmath196 and @xmath197 , and the probability of this is @xmath199 .",
    "consider @xmath200 .",
    "we then take @xmath201 and @xmath202 both modulo @xmath203 , and get that @xmath204 with probability @xmath205 in analogy with the above .",
    "so we get that @xmath206 for  @xmath200 .",
    "this corresponds to the case of i@xmath207 .",
    "finally , for @xmath208 ( which is the case i@xmath209 ) we get a probability of @xmath210 for the chance that @xmath179 and @xmath211 , and ( since there are @xmath41 points mod  @xmath41 on the auxiliary curve @xmath212 ) a conditional probability of @xmath149 that  @xmath208 .",
    "so we get that @xmath213 .",
    "we now impose our current notation on the previous paragraphs , and naturally let @xmath214 and @xmath215 for  @xmath216 .",
    "our final result is that @xmath217 @xmath218 with @xmath187 and @xmath194 equal to zero for other  @xmath219 .",
    "we conclude by defining @xmath220 to be zero for @xmath154 and to be the probability @xmath221 that @xmath150 for  @xmath222 . we can easily check that we really do have the required probability relation @xmath223=1 $ ] , as : the cases of multiplicative reduction give @xmath165 ; the cases of kodaira symbols ii , iii , and  iv give @xmath224 ; the cases of kodaira symbols iv@xmath190 , iii@xmath190 , and  ii@xmath190 give @xmath225 ; the cases of i@xmath226 summed for  @xmath162 give @xmath227 ; the case of i@xmath228 gives @xmath229 ; and the sum of these with @xmath230 does indeed give us  1 .",
    "we could do a similar ( more tedious ) analysis for @xmath146 , but this would obscure our argument .",
    "given a curve of discriminant  @xmath130 , we can now compute the expectation for its tamagawa number .",
    "we consider primes  @xmath231 with @xmath132 , and compute the local tamagawa number  @xmath232 .",
    "when @xmath1 has multiplicative reduction at  @xmath41 and  @xmath153 , then @xmath233 if @xmath234 is square mod  @xmath41 , and else @xmath235 depending upon whether @xmath219 is odd or even .",
    "so the average of @xmath236 for this case is @xmath237 for @xmath219 odd / even respectively .    when @xmath1 has potentially multiplicative reduction at  @xmath41 with  @xmath153 , for @xmath219 odd we have @xmath238 depending on whether @xmath239 is square mod  @xmath41 , and for @xmath219 even we have @xmath238 depending on whether @xmath240 is square mod  @xmath41 .",
    "in both cases the average of @xmath236 is  @xmath241 . in the case of i@xmath209 reduction where we have  @xmath208",
    ", we have that @xmath242 corresponding to whether the cubic @xmath243 has @xmath244 roots modulo  @xmath41 .",
    "so the average of @xmath236 is @xmath245 in this case .",
    "for the remaining cases , when @xmath170 or @xmath246 we have  @xmath247 , while when @xmath174 or @xmath248 we have  @xmath249 . finally , when @xmath178 we have @xmath250 depending on whether @xmath251 is square mod  @xmath41 , and similarly when @xmath252 we have @xmath250 depending on whether @xmath253 is square mod  @xmath41 , so that the average of @xmath236 in both cases is  @xmath254 .",
    "we get that @xmath255 for @xmath256 , while @xmath257 with @xmath258 and @xmath259 equal to zero for other  @xmath219 .",
    "we define the expected square root of the tamagawa number @xmath260 at  @xmath41 by @xmath261\\ ] ] and the expected global has negative discriminant and else is 2 , the former occurring approximately @xmath262 of the time . ]",
    "tamagawa number to be  @xmath263 .",
    "the convergence of this product follows from an analysis of the dominant @xmath264 terms of  , which gives a behaviour of  @xmath265 .",
    "so we get that the tamagawa product is a constant on average , which we do not bother to compute explicitly ( we would need to consider @xmath146 more carefully to get a precise value ) .    to compute the average value of @xmath266 in   we similarly assume that each prime acts independently ; we then compute the average value for each prime by calculating the distribution of @xmath267 when considering all the curves modulo  @xmath41 ( including those with singular reduction , and again making the slight adjustment for non - minimal models ) .",
    "this gives some constant for the average @xmath102 of  @xmath103 , which we do not compute explicitly .",
    "note that @xmath268 converges if we assume the sato - tate conjecture @xcite since in this case we have that @xmath78 is @xmath41 on average .",
    "we now give heuristics for how often we expect the ratio between the absolute discriminant and the conductor to be large . the main heuristic we derive is :    [ conj : conductor ] the number @xmath269 of rational elliptic curves whose conductor is less than  @xmath0 satisfies @xmath270 for an explicit constant  @xmath51 .    to derive this heuristic , we estimate the proportion of curves with a given ratio of ( absolute ) discriminant to conductor . since the conductor is often the squarefree kernel of the discriminant , by way of explanation we first consider the behaviour of @xmath271 . the probability that @xmath272 is given by the probability that @xmath273 is squarefree , which is classically known to be @xmath274 . given a prime power  @xmath275 , to have @xmath276 says that @xmath277 where @xmath278 is squarefree and coprime to  @xmath41 .",
    "the probability that @xmath279 is @xmath280 , and given this , the conditional probability that @xmath281 is squarefree is @xmath282 . extending this multiplicatively beyond prime powers , we get that @xmath283= { 6\\over\\pi^2}\\prod_{p^m\\|q } { 1/p^{(m+1)}\\over ( 1 + 1/p)}= { 6\\over\\pi^2}{1\\over q}\\prod_{p|q } { 1\\over p+1}.\\ ] ] in particular , the average of @xmath284 exists for  @xmath285 ; in our elliptic curve analogue , we will require such an average for  @xmath286 .",
    "we note that it appears to be an interesting open question to prove an asymptotic for  @xmath287 .",
    "we keep the notation @xmath288 and wish to compute the probability that @xmath289 for a fixed positive integer  @xmath290 . for a prime power  @xmath291 with @xmath132 , the probability that @xmath292 is given by : the probability that @xmath1 has multiplicative reduction at  @xmath41 and  @xmath293 , that is  @xmath294 ; plus the probability that @xmath1 has additive reduction at  @xmath41 and  @xmath295 , that is  @xmath296 ; and",
    "the contribution from  @xmath297 , which is zero for @xmath298 and for @xmath299 is the probability that @xmath41 does not divide  @xmath130 .",
    "so , writing @xmath300 , we get that ( with a similar modified formula for  @xmath146 ) @xmath301= \\prod_p e_p(v_p(q))=\\prod_p\\bigl[p_m(p,1+v)+p_a(p,2+v)+p_0(p , v)\\bigr].\\ ] ] it should be emphasised that this probability is with respect to ( as in the previous section ) the ordering of the curves by discriminant .",
    "we have @xmath302 \\sim\\sum_{q=1}^\\infty\\alpha ( qx)^{5/6}\\cdot{\\rm prob}\\bigl[d / n = q\\bigr],\\ ] ] where @xmath303 from the brumer - mcguinness heuristic  [ conj : bmcg ] .",
    "if this last sum converges , then we get heuristic  [ conj : conductor ] .    to show the last sum in   does indeed converge , we upper - bound the probability in  .",
    "we have that @xmath304 and  @xmath305 , which implies @xmath306= \\prod_p e_p(v_p(q))\\le { 1\\over q}\\prod_{p|q } { 3\\over p}.\\ ] ] we then estimate @xmath307 and the last product is convergent upon comparison to  @xmath308 . thus we shown that the last sum in   converges , so that heuristic  [ conj : conductor ] follows .",
    "we can note that fouvry , nair , and tenenbaum @xcite have shown that the number of minimal models with @xmath309 is at least @xmath5 , and that the number of curves with @xmath309 with szpiro ratio @xmath310 is no more than @xmath311 for every  @xmath312 .",
    "we expect that @xmath313 should be independent of the real period , but the tamagawa product and @xmath313 should be somewhat related . , but in the next section we argue that curves with nontrivial torsion are sufficiently sparse so as to be ignored . ]",
    "we compute the expected square root of the tamagawa product when  @xmath289 . as with   and using the @xmath314 defined in  , we find that this is given by @xmath315 \\over \\bigl[p_m(p , v_1)+p_a(p , v_2)+p_0(p , v)\\bigr]},\\ ] ] where @xmath316 and @xmath317 and @xmath300 .",
    "we now want to compare @xmath318 with  @xmath319 , and explicate the replacement therein in guess  [ guess ] . in order to bound the effect of curves with large  @xmath313",
    ", we note that @xmath320=\\sum_{q\\ge y } \\hat f(q ) \\le\\sum_{q\\ge y } { 1\\over q}\\prod_{p|q}{3\\over p},\\ ] ] and use rankin s trick , so that for any @xmath321 we have ( using @xmath322 ) @xmath323 & \\le\\sum_{q=1}^\\infty \\biggl({q\\over y}\\biggr)^{1-\\alpha}\\cdot { 1\\over q}\\prod_{p|q}{3\\over p } = { y^\\alpha\\over y}\\prod_p\\biggl(1+{3\\over p^{1+\\alpha}}+ { 3\\over p^{1 + 2\\alpha}}+\\cdots\\biggr)\\\\ & = { y^\\alpha\\over y}\\prod_p\\biggl(1+{3/p\\over p^\\alpha-1}\\biggr ) \\ll{y^\\alpha\\over y}\\exp\\biggl(\\sum_p{\\hat c / p\\over \\alpha\\log p}\\biggr ) \\ll { e^{c\\sqrt{\\log y}}\\over y}\\end{aligned}\\ ] ] for some constants  @xmath324 , by taking @xmath325 ( this result is stronger than needed )",
    ".    however , a more pedantic derivation of guess [ guess ] does not simply allow replacing @xmath319 by  @xmath318 , but requires analysis ( assuming @xmath82 to be independent of  @xmath290 ) of @xmath326\\biggr]\\ , du_4\\,du_6.\\ ] ] the above estimate on the tail of the probability and a simple bound on @xmath327 in terms of the divisor function shows that we can truncate the @xmath290-sum at  @xmath328 with an error of  @xmath329 , and choosing ( say ) @xmath330 gives us that  @xmath331 ( note that we restricted to  @xmath332 ) .",
    "so the bracketed term becomes the desired @xmath333\\sim \\beta_\\tau(\\log\\delta)^{3/8},\\ ] ] upon noting that the @xmath290-part of the sum converges to  @xmath104 as  @xmath334 .",
    "we now estimate the number of elliptic curves  @xmath1 with even parity and @xmath2 when ordered by conductor .",
    "[ conj : rank2cond ] let @xmath335 be the number of elliptic curves  @xmath1 with even parity and conductor less than  @xmath0 and  @xmath2 .",
    "then @xmath336 for some explicit constant  @xmath51 .    from",
    "guess  [ guess ] we get that the number of even parity curves with @xmath337 and @xmath289 and @xmath2 is given by @xmath338,\\ ] ] and we sum this over all  @xmath290 . as we argued above",
    ", the tail of the sum does not affect the asymptotic ( and so we can take  @xmath339 in  @xmath119 ) , and again we get that the @xmath290-sum converges .",
    "this then gives the desired asymptotic for the number of even parity curves with conductor less than @xmath0 and vanishing central @xmath8-value ( upon arguing similarly for curves with negative discriminant ) .",
    "we can also count curves that have a given torsion group or isogeny structure .",
    "for instance , an elliptic curve with a 2-torsion point can be written as an integral model in the form @xmath340 where @xmath341 ; thus , by lattice - point counting , we estimate about @xmath342 curves with absolute discriminant less than  @xmath0 . the effect on the conductor",
    "can perhaps more easily be seen by using the fricke parametrisation @xmath343 and @xmath344 of curves with a rational and then substituting @xmath345 and @xmath346 to get @xmath347 and @xmath348 so that @xmath349 .",
    "the summation over the twisting parameter  @xmath350 just multiplies our estimate by a constant , while abc - estimates imply that there should be no more than @xmath351 coprime pairs @xmath352 with the squarefree kernel of @xmath353 smaller than @xmath0 in absolute value .",
    "so we get the heuristic that almost all curves have no @xmath31-torsion , even under ordering by conductor . indeed , the exceptional set is so sparse that we can ignore it in our calculations .",
    "a similar argument applies for other isogenies , and more generally for splitting of division polynomials .",
    "also , the results of duke  @xcite for exceptional primes are applicable here , albeit with a different ordering .",
    "we wish to provide some experimental data for the above heuristics .",
    "in particular , the two large datasets of brumer - mcguinness @xcite and stein - watkins @xcite for curves of prime conductor up to @xmath354 and @xmath355 show little drop in the observed average ( analytic ) rank .",
    "brumer and mcguinness considered about 310700 curves with prime conductor less than @xmath354 and found an average rank of about @xmath356 , while stein and watkins extended this to over 11 million curves with prime conductor up to @xmath355 and found an average rank of about  @xmath357 .",
    "both datasets are expected to be nearly exhaustive with few exceptions . ] amongst curves with prime conductor up to the given limit .",
    "these results led some to speculate that the average rank might be constant . to test this , we chose a selection of curves with prime conductor of size  @xmath358 .",
    "it is non - trivial to get a good dataset , since we must account for congruence conditions on the elliptic curve coefficients and the variation of the size of the real period .      as in  @xcite , we divided the @xmath144 pairs into 288 congruence classes with @xmath359 .",
    "many of these classes force the prime 2 to divide the discriminant , and thus do not produce any curves of prime conductor . for each class @xmath360",
    ", we took the 10000 parameter selections @xmath361\\times [ 1 .. 1000],\\ ] ] and then of these 2880000 curves , took the 89913 models that had prime discriminant ( note that all the discriminants are positive ) .",
    "this gives us good distribution across congruence classes , and while the real period does not vary as much as possible , below we will attempt to understand how this affects the average rank .",
    "it then took a few months to compute the ( suspected ) analytic ranks for these curves .",
    "we got about @xmath362 for the average rank .",
    "we then did a similar experiment for curves with negative discriminant given by @xmath363\\times [ 1 .. 1000],\\ ] ] took the subset of 89749 curves with prime conductor , and found the average rank to be about  @xmath364 .",
    "this discrepancy between positive and negative discriminant is also in the brumer - mcguinness and stein - watkins datasets , and indeed was noted in @xcite .",
    "we do not average the results from positive and negative discriminant ; the brumer - mcguinness conjecture [ conj : bmcg ] implies that the split is not  50 - 50 .    in any case , our results show a substantial drop in the average rank , which , at the very least , indicates that the average rank is not constant .",
    "the alternative statistic of frequency of positive rank for curves with even parity also showed a significant drop . for prime positive discriminant curves it was 44.1% for brumer - mcguinness and 41.7% for stein - watkins , but only 36.0% for our dataset  for negative discriminant curves , these numbers are 37.7% , 36.4% , and 31.3%",
    ".      our random sampling of curves with prime conductor of size @xmath358 must account for various properties of the curves if our results are to possess legitimacy .",
    "above we speculated that the real period plays the most significant rle , and so we wish to understand how our choice has affected it .",
    "to judge the effect that variation of the real period might have , we did some comparisons with the stein - watkins database .",
    "first consider curves of positive prime discriminant , and write @xmath1 as @xmath365 and @xmath108 for the real roots of the cubic .",
    "we looked at curves with even parity and considered the frequency of positive rank as a function of the root quotient @xmath366 , noting that with a maximum just below @xmath367 . ]",
    "the curves we considered all had @xmath369 .",
    "however , similar to when we considered curves ordered by conductor , before counting curves with extra rank , we should first simply count curves .",
    "figure  [ fig : posdisc - rootquotient ] indicates the distribution of root quotient @xmath370 for the curves of prime ( positive ) discriminant and even parity from the stein - watkins database ( more than 2 million curves meet the criteria ) .",
    "the @xmath371-axis is divided up into bins of size @xmath372 ; there are more than 100 times as many curves with @xmath373 as there with @xmath374 , with the most extremal dots not even appearing on the graph .    -12pt",
    "-12pt    next we plot the frequency of @xmath2 as a function of the root quotient in figure  [ fig : posdisc - rankfreq ] .",
    "since there are only about 1000 curves in some of our bins , we do not get such a nice graph .",
    "note that the left - most and especially the rightmost dots are much below their nearest neighbors , the graph slopes down in general , and drops more at the end .",
    "we see no evidence that our results should be overly biased . in particular ,",
    "the frequency of @xmath2 is 41.7% amongst all even parity curves of prime discriminant in the stein - watkins database , and is 42.8% for the 12324 such curves with @xmath369 .",
    "the function plotted ( labelled on the right axis ) in figure  [ fig : posdisc - rankfreq ] is of @xmath368 as a function of  @xmath370 , and note that this goes to 0 as @xmath375 ; there is nothing canonical about the choice of our @xmath370-parameter , and we chose it more for convenience than anything else .",
    "similar computations can be made in the case of negative discriminant , which we briefly discuss for completeness ( again restricting to curves with even parity where appropriate ) .",
    "let @xmath376 be the real root of the cubic polynomial @xmath377 , and @xmath378 the imaginary part of the conjugate pair of nonreal roots .",
    "letting @xmath379 and @xmath380 we then have , with the maximum a bit less than @xmath381 . ]",
    "-2pt@xmath382 we renormalise via taking  @xmath383 , and graph the distribution of curves versus  @xmath384 in figure  [ fig : negdisc - rootquotient ] .",
    "the symmetry small ( in particular  @xmath385 ) tend to have @xmath384 in these ranges ( for our discriminant range ) , and this causes instability in the counting function .",
    "] of the graph might indicate that the coordinate transform is reasonable .",
    "all our curves have  @xmath386 .    -8pt    -18pt",
    "-6pt    next we plot the frequency of @xmath2 as a function of the root quotient in figure  [ fig : negdisc - rankfreq ] .",
    "again we also graph the function @xmath387 on the right axis . here",
    "the drop - off is more pronounced than with the curves of positive discriminant . note the floating dot around @xmath388 . indeed",
    "the 100 closest curves with @xmath389 all have positive rank ; this breaks down when crossing the @xmath390-barrier .",
    "this is not particularly a mystery ; these curves have @xmath391 and/or @xmath392 , and thus have an obvious rational point . recall that @xmath388 corresponds to @xmath393 .    -12pt",
    "-6pt    we again see no evidence that our results should be biased . in particular",
    ", the frequency of @xmath2 is 36.4% amongst all even parity curves of negative prime discriminant in the stein - watkins database , and is 37.0% for the 4695 such curves with @xmath386 .",
    "the idea that the `` probability '' that an even parity curve possesses positive rank should be proportional to @xmath394 is perhaps overly simplistic  in particular , it is not borne out too precisely by the stein - watkins dataset .",
    "we consider positive prime discriminant curves with even parity ; for those with @xmath395 we have 78784 curves of which 45.9% have positive rank , while of the 9872 with @xmath396 we have 36.0% with positive rank , for a ratio of 1.28 , which is not too close to  @xmath397 .",
    "one consideration here is that we have placed a discriminant limit on our curves , and there are curves with larger discriminant and @xmath396 that we have not considered .",
    "this , however , is extra - particular to the idea that only the real period should be of import .",
    "one possibility is that curves with small discriminant and/or large real period have _ smaller _ probability of @xmath2 that our estimate of @xmath398 would suggest  indeed , it might be argued ( maybe due to arithmetic considerations , or perhaps explicit formulae for the zeros of @xmath8-functions ) that curves with such small discriminant can not realise their nominal expected frequency of positive rank .",
    "unfortunately , we can not do much to quantify these musings , as the effect would likely be in a secondary term , making it difficult to detect experimentally .",
    "note also that a relative depression of rank for small discriminant curves would give a reason for the near - constant average rank observed by brumer - mcguinness and stein - watkins .",
    "we have other evidence that curves of small discriminant might not behave quite as expected .",
    "we undertook to compute generators for the mordell - weil group for all 2143079 curves of ( analytic ) rank 2 of prime conductor less than @xmath355 in the stein - watkins database .",
    "j. e. cremona ran his ` mwrank ` programme @xcite on all these curves , and it was successful in provably finding the mordell - weil group for 2114188 of these . for about 2500 curves ,",
    "the search region was too big to find the 2-covering quartics via invariant methods , while around 8500 curves had a generator of large height that could not be found , and over 18000 had 2-selmer rank greater than  2 .",
    "we then used the ` fourdescent ` machinery of magma @xcite which reduced the number of problematic curves to 54 .",
    "of these , 19 have analytic  of 16.0 and we expect that either 3-descent or 8-descent @xcite will complete ( assuming grh to compute the class group ) the mordell - weil group verification ; for the 35 other curves , there is likely a generator of height more than 225 which we did not attempt to find.$ ] appears to have a generator of height more than 600 , and thus other methods will likely be needed to try to find it .",
    "t.  a. fisher has recently used 6-descent to find some of the missing points . ]",
    "we then looked at the distribution of the mordell - weil lattices obtained from the induced inner product from the height pairing ; since all of our curves have rank 2 , we get 2-dimensional lattices . we are not so interested in the size of the obtained lattices , but more so in their shape . via the use of lattice reduction ( which reduces to continued fractions in this case ) ,",
    "given any two generators we can find the point @xmath399 of smallest positive height on the curve . by normalising @xmath399 to be the unit vector , we then get a vector in the upper - half - plane corresponding to another generator  @xmath77 . via the standard reduction algorithm",
    ", we can translate @xmath77 so that it corresponds to a point in the fundamental domain for the action of  @xmath400 . finally , by replacing @xmath77 by @xmath401 if necessary",
    ", we can ensure that this point is in the right half of the fundamental domain ( in other words , we must choose an embedding for our mordell - weil lattice ) .",
    "in this manner , for each rank 2 curve we associate a unique point @xmath402 in the upper - half - plane with @xmath403 and @xmath404 .    with no other guidance",
    ", we might expect that the obtained distribution for the @xmath405 is given by - dimensional lattices of determinant  @xmath58 . ]",
    "the haar measure @xmath406 .",
    "we find , however , that this is not borne out too well by experiment .",
    "in particular , we should expect that @xmath407 of the curves should have @xmath408 , while the experimental result is about  93.5% .",
    "furthermore , we should expect that the proportion of curves with @xmath409 should die off like @xmath410 as @xmath411 ; however , we get that 35.4% of the curves have @xmath412 , only 9.4% have @xmath413 , while 1.7% have @xmath414 and 0.2% have @xmath415 . the validity of the vertical distribution data might be arguable based upon concerns regarding the discriminant cutoff of our dataset , but the horizontal distribution is also skewed .",
    "if we consider only curves with  @xmath408 , then we should get uniform distribution in the @xmath371-aspect ; however , table  [ table : xdist ] shows that we do not have such uniformity .    * 4|@c@|@xmath416&9.0%&@xmath417&10.0% + @xmath418&9.6%&@xmath419&10.2% + @xmath420&9.8%&@xmath421&10.5% + @xmath422&9.9%&@xmath423&10.6% + @xmath424&10.0%&@xmath425&10.5%",
    "+    we can not say whether these unexpected results from the experimental data are artifacts of choosing curves with small discriminant ; it is just as probable that our haar - measure hypothesis concerning the lattice distribution is simply incorrect .",
    "similar to questions about the vanishing of @xmath44 , we can ask about the vanishing of the symmetric power @xmath8-functions @xmath426 .",
    "we refer the reader to @xcite for more details about this , but mention that , due to conjectures of deligne and more generally bloch and belinson @xcite , we expect that we should have a formula similar to that of birch and swinnerton - dyer , stating that @xmath427 should be rational with small denominator . here , for @xmath219 odd , @xmath428 is the real period and @xmath429 the imaginary period , with this reversed for @xmath219 even . ignoring the contribution from the conductor , and crudely estimating that @xmath430 , an application of discretisation as before gives that the probability that @xmath426 has even parity and @xmath431 is bounded above ( cf .  the ignoring of  @xmath43 ) by @xmath432 .",
    "again following the analogy of above , we can then upper - bound the number of curves with conductor less than  @xmath0 with even - signed symmetric @xmath433st power and @xmath431 by @xmath434 for every @xmath312 .",
    "it could be argued that we should order curves according to the conductor of the symmetric power @xmath8-function rather than that of the curve , but we do not think such concerns are that relevant to our imprecise discussion . in particular , the above estimate predicts that there are finitely many curves with extra vanishing when  @xmath435 .",
    "it should be said that this heuristic will likely mislead us about curves with complex multiplication , for which the symmetric power @xmath8-function factors ( it is imprimitive in the sense of the selberg class ) , with each factor having a 50% chance of having odd parity .",
    "however , even ignoring cm curves , the data of @xcite find a handful of curves for which the 9th , 11th and even the 13th symmetric powers appear ( to 12 digits of precision ) to have a central zero of order  2 .",
    "we find this surprising , and casts some doubt about the validity of our methodology of modelling of vanishings .",
    "the techniques we used earlier in this paper have also been used to model vanishings in quadratic twist families , and we can extend the analyses to symmetric powers .",
    "we fix a non - cm curve  @xmath1 and let @xmath436 be its @xmath55th quadratic twist , taking @xmath55 to be a fundamental discriminant . from an analogue of the birch  swinnerton - dyer conjecture we expect to get a small - denominator rational from the quotient should not appear in the final expression . ] @xmath437 .",
    "we have that @xmath438 and so we expect the number of fundamental discriminants @xmath439 such that @xmath440 has even parity with @xmath441 to be given crudely ( up to log - factors ) by @xmath442 .",
    "so we expect about @xmath443 quadratic twists with double zeros for the 3rd symmetric power ; generalising predicts finitely many extra vanishings for higher ( odd ) powers .",
    ".fundamental @xmath55 with @xmath444[tbl : ed ] [ cols= \" > , < \" , ]      for the twist computations for the symmetric powers , we can go much further ( about 20 times as far ) in the cm case because the conductors do not grow as rapidly .",
    "for the 3rd symmetric power , the crude prediction is that we should have ( asymptotically ) many more extra vanishings for twists in the cm case than in the non - cm case , but this is not borne out by the data .",
    "additionally , we have no triple zeros in the cm case ( where the dataset is almost 100 times as large ) , while we already have six for the non - cm curves .",
    "this is directly antithetical to our suspicion that there should be more extra vanishings in the cm case .",
    "as before , this might cast some doubt on our methodology of modelling of vanishings .",
    "the author was partially supported by engineering and physical sciences research council ( epsrc ) grant gr / t00658/01 ( united kingdom ) .",
    "he thanks n.  d.  elkies , h.  a.  helfgott , and a.  venkatesh for useful comments , and n.  p.  jones for the reference  @xcite .",
    "w. bosma , j. cannon , c. playoust , _ the magma algebra system .",
    "i. the user language .",
    "_ in _ computational algebra and number theory _",
    "proceedings of the 1st magma conference held at queen mary and westfield college , london , august 2327 , 1993 . edited by j. cannon and d. holt , elsevier science b.v . ,",
    "amsterdam ( 1997 ) , 235265 .",
    "cross - referenced as j.  symbolic comput .",
    "* 24 * ( 1997 ) , no . 3 - 4 , 235265 .",
    "online at ` magma.maths.usyd.edu.au `            j. b. conrey , j. p. keating , m. o. rubinstein , n. c. snaith , _ on the frequency of vanishing of quadratic twists of modular @xmath8-functions .",
    "_ number theory for the millennium , i ( urbana , il , 2000 ) , 301315 , a k peters , natick , ma , 2002 .",
    "see ` arxiv.org/math/0012043 `    j.  b.  conrey , a.  pokharel , m.  o.  rubinstein , and m.  watkins , _ secondary terms in the number of vanishings of quadratic twists of elliptic curve @xmath8-functions _",
    "( 2005 ) , to appear in proceedings of the issac newton institute workshop on elliptic curve and random matrix theory , arxiv.org/math/0509059              d. goldfeld , _ conjectures on elliptic curves over quadratic fields .",
    "_ in _ number theory , carbondale 1979 _ ( proc .",
    "southern illinois conf . , southern illinois univ . , carbondale , ill . , 1979 ) ,",
    "m.  b.  nathanson , ed .",
    "notes in math . * 751 * , springer - verlag , berlin ( 1979 ) , 108118 ,              c. liu , l. xu , _ the vanishing order of certain hecke @xmath8-functions of imaginary quadratic fields .",
    "_ j. number theory * 108 * ( 2004 ) , no .  1 , 7689 .",
    "preliminary version online at ` arxiv.org/math/0210313 `    v. a. marenko , l. a. pastur , _ distribution of eigenvalues in certain sets of random matrices .",
    "_ ( russian )",
    "( n.s . ) * 72 * , no .  114 , ( 1967 ) , 507536 .",
    "english translation appears in : v.  a.  marchenko , l.  a.  pastur , _ distribution of eigenvalues for some sets of random matrices , _ math .",
    "ussr - sb .",
    "* 1 * ( 1967 ) , 457483 .    p. martin , m. watkins , _ symmetric powers of elliptic curve @xmath8-functions .",
    "_ in _ algorithmic number theory _ , proceedings of the 7th international symposium , ants - vii , berlin , germany , july 2006 , edited by f. hess , s. pauli , and m. pohst , springer lecture notes in computer science , * 4076 * ( 2006 ) , 377392 .",
    "see ` arxiv.org/math/0604095 `        f. rodriguez villegas , d. zagier , _ square roots of central values of hecke @xmath8-series .",
    "_ in _ advances in number theory _ , proceedings of the third conference of the canadian number theory association held at queen s university , kingston , ontario , august 1824 , 1991",
    ". edited by f. q. gouva and n. yui , oxford sci .",
    ", oxford univ . press , new york ( 1993 ) , 8199 .",
    "d. e. rohrlich , _ the nonvanishing of certain hecke @xmath8-functions at the center of the critical strip , _ duke math . j. * 47 *  ( 1980 ) , no .  1 , 223232 , and _ on the @xmath8-functions of canonical hecke characters of imaginary quadratic fields .",
    ", _ duke math . j.",
    "* 47 *  ( 1980 ) , no .  3 , 547557 , * 49 *  ( 1982 ) , no .  4 , 937942 ( with h. l. montgomery )",
    ".        s. k. m. stamminger , _ explicit 8-descent on elliptic curves .",
    "_ doctoral thesis , international university bremen , under m. stoll , 2005 .",
    "see ` www.iu-bremen.de/research/dissertations ` or possibly directly from ` www.iu-bremen.de/phd/files/1135329284.pdf `    w. a. stein , m. watkins , _ a database of elliptic curves  first report .",
    "_ in _ algorithmic number theory _ , ants - v ( sydney 2002 ) , edited by c. fieker and d. r. kohel , springer lecture notes in computer science , * 2369 * ( 2002 ) , 267275 .",
    "j. t. tate , _ algebraic cycles and poles of zeta functions .",
    "_ in _ arithmetical algebraic geometry .",
    "_ proceedings of a conference at purdue univ . 1963 . edited by o. f. g. schilling .",
    "harper & row , new york ( 1965 ) , 93110 ."
  ],
  "abstract_text": [
    "<S> we give some heuristics for counting elliptic curves with certain properties . in particular , we re - derive the brumer - mcguinness heuristic for the number of curves with positive / negative discriminant up to  @xmath0 , which is an application of lattice - point counting . </S>",
    "<S> we then introduce heuristics ( with refinements from random matrix theory ) that allow us to predict how often we expect an elliptic curve  @xmath1 with even parity to have @xmath2 . </S>",
    "<S> we find that we expect there to be about @xmath3 curves with @xmath4 with even parity and positive ( analytic ) rank ; since brumer and mcguinness predict @xmath5 total curves , this implies that asymptotically almost all even parity curves have rank  0 . </S>",
    "<S> we then derive similar estimates for ordering by conductor , and conclude by giving various data regarding our heuristics and related questions .    </S>",
    "<S> 0 - 48pt0 </S>"
  ]
}