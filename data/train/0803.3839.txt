{
  "article_text": [
    "time - distance helioseismology @xcite has been used to measure wave travel times in and around magnetic active regions and sunspots to estimate subsurface flows and wave - speed perturbations ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "a challenging problem is to estimate the subsurface magnetic field from travel times . in order to do so",
    ", one must understand the dependence of the travel times on the magnetic field .",
    "as discussed by e.g.  @xcite the interaction of acoustic waves with sunspot magnetic fields is strong in the near surface layers . as a result",
    ", the effect of the magnetic field on the travel times is not expected to be small near the surface .",
    "deeper inside the sun , however , the ratio of the magnetic pressure to the gas pressure becomes small , and it is tempting to treat the effects of the magnetic field on the waves using perturbation theory .",
    "the hope is to eventually develop a linear inversion to estimate the subsurface magnetic field from travel times measured between surface locations that are free of magnetic field .",
    "of particular interest is the search for a magnetic field at the bottom of the convection zone .",
    "such a linear inversion scheme has been proposed by @xcite for time - distance helioseismology using the ray approximation , but it needs to be extended to finite wavelengths .    as a first step , in this paper , we consider the scattering of small amplitude acoustic plane waves by a magnetic cylinder embedded in a uniform medium .",
    "this simple problem has a known exact solution for arbitrary magnetic field strengths @xcite .",
    "the first - order born and rytov approximations have proved useful in the context of time - distance helioseismology to model the effects of small local perturbations in sound speed and flows ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "here we use the born approximation to compute the scattering of a wave by a weak magnetic field .",
    "the validity of the born approximation is not a priori obvious in this case , since the magnetic field allows additional wave modes .",
    "because we have an exact solution , however , we can study the validity of the linearization of travel times on the square of the magnetic field .",
    "we note that the problem of the scattering of waves by a non - magnetic cylinder with a sound speed that differs from the surrounding medium was investigated by @xcite .",
    "the outline of the paper is as follows . in section  [ sec.the_problem ]",
    "we specify the problem and write the equations of motion for small amplitude waves .",
    "in section  [ sec.exact_solution ] we review the exact solution to the scattering problem . in section  [ sec.born ]",
    "we apply the first born approximation to obtain the complex scattering amplitudes . in section  [ sec.compare ]",
    "we show that the born approximation is an asymptote of the exact solution in the limit of infinitesimal magnetic field strength . in section  [ sec.travel_times ]",
    "we compare travel times computed exactly , in the born approximation , and in the ray approximation . in section  [ sec.discussion ]",
    "we provide a brief summary of our results and also discuss the limit when the magnetic tube radius tends to zero .",
    "we start with the ideal equations of magnetohydrodynamics .",
    "the equations of continuity , momentum , magnetic induction , and gauss law for the magnetic field are : @xmath0 where @xmath1 is the material derivative , @xmath2 the density , @xmath3 the velocity , @xmath4 the pressure , and @xmath5 the magnetic field . for the sake of simplicity , we use the simple energy equation @xmath6 where @xmath7 is the temperature , @xmath8 the uniform specific heat at constant volume , @xmath9 the gas constant , and @xmath10 the ratio of specific heats .",
    "this equation neglects all forms of heat losses .",
    "in addition we use the ideal gas equation of state @xmath11      we consider a magnetic cylinder with radius @xmath9 and uniform magnetic field strength @xmath12 embedded in an infinite , otherwise uniform , gravity free medium with constant density @xmath13 , gas pressure @xmath14 , and temperature @xmath15 . we use a cylindrical coordinate system @xmath16 where @xmath17 is the radial coordinate , @xmath18 is the azimuthal angle , and @xmath19 is the vertical coordinate in the direction of the cylinder axis .",
    "we denote the corresponding unit vectors by @xmath20 , @xmath21 , and @xmath22 .",
    "all steady physical quantities are denoted with an overbar . in particular , we have @xmath23 where the heaviside step function is defined by @xmath24 if @xmath25 and @xmath26 if @xmath27 .",
    "the density and pressure inside the tube are @xmath28 and @xmath29 respectively .",
    "we assume that there is no mean flow in this problem , i.e.  @xmath30 .",
    "we choose to study the case where the background temperature is the same inside and outside the magnetized region , i.e. @xmath31 . as a result , the sound speed , @xmath32 , is constant everywhere .",
    "this choice is motivated by our desire to restrict ourselves , as much as possible , to the study of the effect of the lorentz force on waves , rather than the effect of a sound speed variation .",
    "pressure balance across the magnetic tube boundary implies @xmath33 where @xmath29 is the background gas pressure inside the tube .",
    "the density inside the tube is given by @xmath34 , as the temperature is the same inside and outside the tube .",
    "we want to study the propagation of linear waves on the steady background state defined above . toward this end , we expand each physical quantity that appears in equations  ( [ eq.first])-([eq.last ] ) into a time - varying component , denoted by a prime , and the steady component , denoted with an overbar .",
    "for example , we write @xmath35 . after subtraction of the steady state , we obtain : @xmath36 ,   \\label{mom }   \\\\ \\partial_t { \\mbox{\\boldmath$b$ } } ' & = &    { \\mbox{\\boldmath$\\nabla$ } } { \\mbox{\\boldmath$\\times$ } } \\left ( { \\mbox{\\boldmath$v$ } } ' { \\mbox{\\boldmath$\\times$ } } \\overline { { \\mbox{\\boldmath$b$ } } } \\right ) , \\\\ { \\mbox{\\boldmath$\\nabla$ } } \\cdot { \\mbox{\\boldmath$b$ } } ' & = & 0 .     \\end{aligned}\\ ] ] the linearized energy equation , in combination with equation  ( [ cont ] ) and the linearized equation of state , may be simplified to @xmath37 which describes adiabatic wave motion .",
    "as we study linear waves on a steady background , we can consider one temporal fourier mode at a time .",
    "the magnetic field @xmath38 and all other background quantities do not depend on @xmath19 .",
    "thus , a wave with a @xmath19 dependence of the form @xmath39 will have the same @xmath19 dependence after interacting with the magnetic cylinder . as a result , we study solutions where the pressure fluctuations are of the form @xmath40 where @xmath41 is a position vector perpendicular to the tube axis .",
    "all the other wave variables , @xmath42 , @xmath43 , and @xmath44 are written in the same form as equation  ( [ eq.expand ] ) .",
    "quantities with a tilde only depend on @xmath45 .",
    "for the sake of completeness , we briefly review an exact solution obtained by @xcite to equations  ( [ cont])-([temp ] ) .",
    "we consider a plane wave incident on the magnetic tube , with pressure fluctuations of the form @xmath46 where @xmath47 is an amplitude and @xmath48 is the component of the wave vector perpendicular to the tube axis . in order for the incident wave to be a solution to the non - magnetic problem",
    ", the horizontal wavenumber @xmath49 must satisfy @xmath50 in the rest of this paper , unless otherwise stated , we will use @xmath51 to denote @xmath52 . in cylindrical coordinates",
    ", this plane wave can be expanded as a sum over azimuthal components ( index @xmath53 ) according to ( e.g. * ? ? ?",
    "* ) : @xmath54 where @xmath55 denotes the bessel function of order @xmath53 and @xmath56 is the angle between @xmath48 and @xmath45 .    the total wave pressure , hydrodynamic plus magnetic , and the radial velocity must be continuous across the tube boundary . applying these boundary conditions",
    ", @xcite showed that the total pressure wave field is @xmath57 where @xmath58 is the hankel function of the first kind of order @xmath53 .",
    "the quantity @xmath59 is the horizontal wavenumber inside the tube , given by @xmath60^{1/2 } \\label{modified }   , \\ ] ] where @xmath61 is the alfvn wave speed and @xmath62 is the tube velocity .",
    "the coefficients @xmath63 and @xmath64 are given in appendix  [ app.exact ] .",
    "this exact solution is valid for arbitrarily large values of @xmath12 and @xmath9 .",
    "we note that the gas pressure fluctuations are discontinuous at the tube boundary",
    ".    not all azimuthal components @xmath53 contribute at the same level .",
    "figure  [ fig.exact_and_born ] shows the amplitudes of the @xmath63 as a function of @xmath53 for two different values of the tube radius , @xmath9 . in this particular example , @xmath65  cgs , @xmath66  km / s , and @xmath67  kg are fixed . for @xmath68  mm , which is less than the wavelength ( @xmath69 ) , only the @xmath70 azimuthal components contribute . for tubes with larger radii",
    "the higher order components have larger amplitudes , as can be seen in the case @xmath71  mm ( @xmath72 ) .",
    "magnetic effects cause perturbations to both the steady background state and the wavefield . in this section",
    "we use the born approximation to derive an approximate solution to equations  ( [ cont])-([temp ] ) based on the assumption that magnetic effects are small ( see e.g. * ? ? ?",
    "the lorentz force is quadratic in the magnetic field . as a result",
    "we introduce a small parameter that is second order in the magnetic field .",
    "we choose to expand all quantities in powers of the small dimensionless parameter @xmath73 in this expansion framework the magnetic field appears at order @xmath74 . in particular , we write the steady background magnetic field as @xmath75    the magnetic field causes a shift , @xmath76 , in the steady component of the density inside the tube relative to the steady component of the density outside the tube , @xmath13 : @xmath77 likewise , we write the steady component of pressure as @xmath78 these changes are related to the magnetic field through equation  ( [ eq.pressure_bal ] ) and the equation of state : @xmath79    we expand each of the wave - field variables into an incident component ( subscript `` inc '' ) and a scattered component ( subscript `` sc '' ) : @xmath80 by inserting the above expansions into equations  ( [ cont])-([temp ] ) and retaining the terms of order @xmath81 we obtain @xmath82 the terms on the right - hand side of the above equations act as sources for the scattered waves : this is the born approximation .",
    "writing all wave variables in the form of equation  ( [ eq.expand ] ) and using the fact that the magnetic field is solenoidal , the above equations reduce to a forced helmholtz equation for the @xmath83 fourier component of the scattered pressure field , @xmath84 : @xmath85 where @xmath86 is the two - dimensional laplacian with respect to @xmath45 and the source function @xmath87 is given by @xmath88   \\nonumber \\\\   & & -   \\frac{c^2}{2\\omega^2 } ( \\delta_{{\\mbox{\\boldmath$r$}}}- 3 k_z^2 ) \\left [   \\delta(r - r ) \\partial_r \\tilde{p}_{\\rm inc } ( { { \\mbox{\\boldmath$r$ } } } ) \\right ] .",
    "\\label{source } \\end{aligned}\\ ] ] the first term in @xmath89 is due to the density jump at the tube boundary and the other two terms are due to the direct effect of the lorentz force on the wave . for the incoming wave , @xmath90 , we take the same plane wave as in the exact solution ( eq .  [ [ eq.definc ] ] ) .",
    "the solution to the inhomogeneous helmholtz equation  ( [ diffeqn ] ) is @xmath91 where @xmath92 is the green s function defined by @xmath93 and explicitly given by ( e.g. * ? ? ?",
    "* ) @xmath94 where @xmath41 , @xmath95 , and @xmath96 and @xmath97 .",
    "we insert this expression for @xmath98 into equation  ( [ master ] ) and use integration by parts as appropriate .",
    "the solution can be written in terms of integrals over bilinear combinations of bessel and hankel functions .",
    "these integrals can be evaluated using equations  ( [ eq.appendix1 ] ) and  ( [ eq.appendix2 ] ) . upon simplification",
    ", we find that the pressure of the scattered wave is @xmath99 where the coefficients @xmath100 and @xmath101 are given in appendix  [ app.born ] .",
    "figure  [ fig.real_imag ] shows the real and imaginary parts of the born approximation for the scattered pressure field , @xmath102 , for the case @xmath103 , i.e. when @xmath104 and @xmath105 . in this example , @xmath106 . on the same figure",
    ", we also show the exact calculation of the scattered pressure field obtained by subtracting @xmath90 from the complete exact pressure field , @xmath107 , computed as in section  [ sec.exact_solution ] .",
    "the amplitude of the scattered wave is of order @xmath81 of the amplitude of the incoming wave , as expected .",
    "the born approximation is everywhere accurate to about 10% . for a direct comparison with the exact solution ( eq .",
    "[ [ eq.exact_solution ] ] ) , we remind the reader that the total pressure wave field in the born approximation is given by @xmath108 , according to equation  ( [ eq.totalp ] ) .",
    "in this section we show that to first order in @xmath81 , the exact solution ( sec .  [ sec.exact_solution ] ) and the born solution ( sec .",
    "[ sec.born ] ) are identical .",
    "we expand the exact solution ( eqs.[[eq.exact_solution ] ] , [ [ exact_out ] ] , and [ [ exact_in ] ] ) in a taylor series up to first order in @xmath81 . to do this",
    ", we use @xmath110 which , together with equation  ( [ modified ] ) , gives the first - order perturbation to the wavenumber inside the tube , @xmath111 let us first consider the exact scattering coefficient @xmath63 outside the tube ( @xmath112 ) given by equation  ( [ exact_out ] ) . denoting the numerator and denominator of @xmath63 by @xmath113 and @xmath114 respectively and performing a taylor expansion , we obtain @xmath115 + { \\rm o}(\\epsilon^2 ) \\label{second}\\end{aligned}\\ ] ] and @xmath116 hence , the exact and born coefficients outside the tube match to first order in @xmath81 : @xmath117 similarly , it can be demonstrated that the coefficient @xmath64 that gives the exact total wave field inside the tube ( @xmath118 ) is @xmath119 the minus one on the left - hand side comes from the fact that the @xmath64 coefficient relates to the full wavefield , whereas @xmath101 is for the scattered wavefield only .",
    "together , equations  ( [ eq.limit_out ] ) and  ( [ eq.limit_in ] ) imply that the born approximation is identical to the exact solution outside and inside the magnetic tube , to first order in @xmath81 .",
    "figure  [ fig.vary_epsilon ] shows the fractional error @xmath120 as a function of @xmath81 for @xmath104 , @xmath121 , and @xmath122 .",
    "we see that the fractional error of the born approximation tends to zero as @xmath81 tends to zero .",
    "in this section , we study the interaction of solar - like wave packets with the magnetic cylinder .",
    "the aim is to compare seismic travel - time shifts computed in the born approximation and from the exact solution . for the sake of simplicity ,",
    "we fix @xmath123 .",
    "using cartesian coordinates @xmath124 for the horizontal plane , we choose an incoming gaussian wavepacket propagating in the @xmath125 horizontal direction : @xmath126   \\ ,   d\\omega   .\\ ] ] where @xmath127  mhz is the dominant frequency of solar oscillations and @xmath128  mhz is the dispersion .",
    "since we chose @xmath123 , we have @xmath129 . the wavepacket is centered on the magnetic tube at time @xmath130 .",
    "the scattered wave packet can be calculated , exactly or in the born approximation , from the previous sections .",
    "the three panels in figure  [ fig.frames ] show snapshots of the incoming and scattered pressure fields at time @xmath131  min .",
    "the parameters of the steady background at infinity are @xmath65  cgs and @xmath66  km / s , which are roughly the conditions at a depth of @xmath132  km below the solar photosphere .",
    "the incident wavepacket is shown in figure  [ fig.frames]a .",
    "figure  [ fig.frames]b shows the scattered wave which results from a @xmath133-kg magnetic flux tube with radius @xmath134  mm .",
    "the smaller tube produces relatively more back scattering than the large tube in comparison with the forward scattering .",
    "the amplitude of the scattered wave is roughly three orders of magnitude smaller than the incoming wave .",
    "figure  [ fig.frames]c shows the scattered wave for a larger tube radius of @xmath135  mm ; the scattering is dominantly in the forward direction and has an amplitude only an order of magnitude smaller than the incident wave .",
    "we now define the travel - time shifts that are caused by the magnetic cylinder . by definition ,",
    "the travel - time shift at location @xmath45 is the time @xmath136 which minimizes the function @xmath137 ^ 2    , \\label{eq.def_tt}\\ ] ] where @xmath138 is the full wavefield that includes both the incident wavepacket and the scattered wave packet caused by the magnetic field .",
    "the travel - time shifts can be computed in this way for either the exact solution or the born - approximation .",
    "in addition , it is also interesting to compare with the ray approximation as given by equation  ( 14 ) from @xcite . in our case , where @xmath139 and the magnetic field strength is constant inside the tube , the ray approximation becomes @xmath140 where @xmath141 is the path length through the tube along the ray which goes from coordinates @xmath142 to @xmath124 .",
    "figure  [ fig.travel_times ] shows travel - time shifts resulting from a flux tube of radius 2  mm and field strength of 1  kg ( @xmath106 ) .",
    "figure  [ fig.travel_times]a shows the exact , born- , and ray - approximation travel times as a function of @xmath143 at fixed @xmath144 . inside the flux tube , both the born- and ray - approximation travel times reproduce the exact travel times at a good level of accuracy . as @xmath143 increases to the right of the tube , wavefront healing ( e.g. * ? ? ?",
    "* ) is seen in the exact and born approximation travel times .",
    "wavefront healing , however , is not seen in the ray approximation travel times .",
    "figure  [ fig.travel_times]b shows the travel times as a function of @xmath144 at fixed @xmath145  mm .",
    "the born approximation reproduces the exact travel times to within 20% .",
    "the ray approximation does not capture finite wavelength effects and does not capture the basic behavior of the travel times ; it can be inaccurate by many orders of magnitude for @xmath146 .",
    "we note that , in figure  [ fig.travel_times ] , the contribution of the density jump ( first term in eq .  [ [ source ] ] ) to the travel - time shifts is negligible compared to the contribution from the lorentz force .",
    "we have computed , in the first born approximation , the scattering of acoustic waves from a magnetic cylinder embedded in a homogeneous background medium .",
    "we showed that in the limit of weak magnetic field , the born approximation to the scattered wavefield is correct to first order in the parameter @xmath147 . for typical values of the solar magnetic flux",
    ", the born approximation should be good at depths larger than a few hundred km below the photosphere .",
    "the condition @xmath148 is satisfied for a 1-kg magnetic fibril at a depth of 250  km ( @xmath149 ) and for a @xmath150  g magnetic flux tube at the base of the convection zone ( @xmath151 ) .",
    "since the errors introduced by the rytov and born approximations are very similar ( e.g. * ? ? ?",
    "* ) , we suspect that a travel - time shift computed in the rytov approximation would also tend to the exact solution as @xmath81 tends to zero .    near the photosphere , @xmath81 is not small .",
    "it has been suggested by many authors ( e.g. * ? ? ?",
    "* ) that in this case the born approximation will fail .",
    "an exception is the claim by @xcite that the born approximation will remain valid for kg magnetic fibrils in the limit where the radius of the magnetic element is much smaller than the wavelength .",
    "we wish to test this last statement in our simple problem .",
    "assuming @xmath123 for the sake of simplicity and taking the limit @xmath152 , we find that for all @xmath81 we have @xmath153 this shows that the born approximation is not valid in the limit of small tube radius .",
    "figure  [ fig.ratio_of_a ] shows the ratio @xmath154 , for @xmath155 , as a function of @xmath9 when @xmath156 and @xmath157  mm@xmath158 .",
    "we see that , in the limit of small @xmath159 , the fractional error in the born approximation is of order @xmath81 ( the absolute error is of order @xmath160 ) .",
    "the born approximation applied to completely evacuated solar magnetic fibrils in the photosphere is likely to be invalid by roughly a factor of two .",
    "note that the sign of the relative error in @xmath161 is different for @xmath104 and @xmath162 .",
    "the sensitivity of travel times to local perturbations in internal solar properties can be described through linear sensitivity functions , also called travel - time kernels .",
    "@xcite gave a general recipe for computing such travel - time kernels using the born approximation , which has been applied to the case of sound - speed perturbations by @xcite .",
    "the present work suggests that travel - time kernels for the subsurface magnetic field will be useful for probing depths greater than a few hundred km beneath the photosphere , at least in the case when the travel times are measured between surface points that are not in magnetic regions .",
    "one should be careful , however , not to draw definitive conclusions from the simple model we have studied , given the complexity of the real solar problem .",
    "a.c.b . was supported by nasa contract nnh04cc05c and thanks the max - planck - institut fr sonnensystemforschung for its hospitality .",
    "birch , a.  c. , & felder , g. 2004 , , 616 , 1261    birch , a.  c. , kosovichev , a.  g. , & duvall , t.  l. 2004 , , 608 , 580    , a.  c. , kosovichev , a.  g. , price , g.  h. , & schlottmann , r.  b. 2001 , , 561 , l229    bogdan , t.  j. 1989 , , 345 , 1042    , p.  s. 2005 , , 358 , 353    , t.  l. , dsilva , s. , jefferies , s.  m. , harvey , j.  w. , & schou , j. 1996 , , 379 , 235    , t.  l. , jefferies , s.  m. , harvey , j.  w. , & pomerantz , m.  a. 1993 , , 362 , 430    , y. , braun , d.  c. , & chou , d .- y . , 1995 , , 451 , 877    , l. , & birch , a.  c. 2002 , , 571 , 966    , j.  m. , & pijpers , f.  p. 2003",
    ", , 412 , 257    , a.  g. , & duvall , t.  l. 1997 , in assl vol . 225 : solar convection and oscillations and their relationship , 241    , a.  g. , duvall , t.  l. , & scherrer , p.  h. 2000 , , 192 , 159    , c. , & braun , d.  c. 2004 , , 155 , 209    morse , p.  m. , & ingard , k.  u. 1986 , theoretical acoustics ( princeton , nj : princeton university press )    , g. , & dahlen , f.  a. 2000 , , 105 , 19043    , c.  s. 1995 , , 438 , 434    watson , b.  n. 1944 , a treatise on the theory of bessel functions , 2nd ed .",
    "( new york : cambridge university press )    , p.  r. 1980 , , 237 , 1008    , m.  j. 1989 , ph.d .",
    "dissertation , stanford university",
    "the coefficients @xmath63 and @xmath64 are @xmath163 and @xmath164^{-1 } \\label{exact_in }   .\\ ] ] in equations  ( [ exact_out ] ) and ( [ exact_in ] ) , the functions @xmath165 and @xmath166 denote the first derivative of @xmath55 and @xmath58 respectively .",
    "in order to compute scattering amplitudes in the born approximation , we used @xcite @xmath167   \\label{eq.appendix1}\\ ] ] and @xmath168   .",
    "\\label{eq.appendix2}\\ ] ]",
    "the coefficients @xmath161 and @xmath101 for the born solution are @xmath169     \\label{born_out}\\ ] ] and @xmath170 .",
    "\\label{born_in}\\end{aligned}\\ ] ]"
  ],
  "abstract_text": [
    "<S> with the aim of studying magnetic effects in time - distance helioseismology , we use the first - order born approximation to compute the scattering of acoustic plane waves by a magnetic cylinder embedded in a uniform medium . </S>",
    "<S> we show , by comparison with the exact solution , that the travel - time shifts computed in the born approximation are everywhere valid to first order in the ratio of the magnetic to the gas pressures . </S>",
    "<S> we also show that , for arbitrary magnetic field strength , the born approximation is not valid in the limit where the radius of the magnetic cylinder tends to zero . </S>"
  ]
}