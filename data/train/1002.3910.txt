{
  "article_text": [
    "the decision problem of whether a graph contains a hamilton cycle is one of the most famous np - complete problems , and so it is unlikely that there exists a good characterization of all hamiltonian graphs .",
    "for this reason , it is natural to ask for sufficient conditions which ensure hamiltonicity .",
    "the most basic result of this kind is dirac s theorem  @xcite , which states that every graph of order @xmath10 and minimum degree at least @xmath11 is hamiltonian .",
    "dirac s theorem was followed by a series of results by various authors giving even weaker conditions which still guarantee hamiltonicity .",
    "an appealing example is a theorem of  @xcite which implies that every graph of order @xmath10 whose degree sequence @xmath12 satisfies @xmath13 for all @xmath14 is hamiltonian .",
    "finally ,  @xcite showed that if the degree sequence of a graph  @xmath1 satisfies @xmath13 or @xmath15 whenever @xmath16 , then @xmath1 is hamiltonian .",
    "s condition is best possible in the sense that for every sequence not satisfying this condition , there is a non - hamiltonian graph whose degree sequence majorises the given sequence .",
    "it is natural to seek analogues of these theorems for digraphs . for basic terminology on digraphs",
    ", we refer the reader to the monograph of bang - jensen and gutin  .",
    "ghouila - houri  @xcite proved that every digraph of order @xmath2 and minimum indegree and outdegree at least @xmath11 is hamiltonian , thus providing such an analogue of dirac s theorem for digraphs .",
    "thomassen  @xcite asked the corresponding question for oriented graphs ( digraphs with no @xmath17-cycles ) .",
    "one might expect that a weaker minimum semidegree ( i.e.  indegree and outdegree ) condition would suffice in this case .",
    "@xcite gave a construction showing that a minimum semidegree of @xmath18 is necessary and conjectured that it is also sufficient to guarantee a hamilton cycle in any oriented graph of order @xmath2 .",
    "this conjecture was recently proved in , following an asymptotic solution in .",
    "in we gave an nc algorithm for finding hamilton cycles in digraphs with a certain robust expansion property which captures several previously known criteria for finding hamilton cycles .",
    "these and other results are also discussed in the recent survey  @xcite .",
    "however , no digraph analogue of s theorem is known . for a digraph @xmath1 of order @xmath2 ,",
    "let us write @xmath19 for its outdegree sequence , and @xmath20 for its indegree sequence .",
    "we will usually write @xmath21 and @xmath22 instead of @xmath23 and @xmath24 if this is unambiguous .",
    "the following conjecture of nash - williams  @xcite would provide such an analogue .",
    "[ nash - williams conjecture - chvatal ]",
    "let @xmath1 be a strongly connected digraph of order @xmath10 and suppose that for all @xmath16    * @xmath25 or @xmath26 ; * @xmath27 or @xmath28 .",
    "then @xmath1 contains a hamilton cycle .",
    "nash - williams also highlighted the following conjectural analogue of s theorem , which would follow from conjecture  [ nash - williams conjecture - chvatal ] .",
    "[ nash - williams conjecture - posa ] let @xmath1 be a digraph of order @xmath10 such that @xmath29 for all @xmath30 and @xmath31 . then @xmath1 contains a hamilton cycle .    note",
    "that in conjecture  [ nash - williams conjecture - posa ] the degree condition implies that @xmath1 is strongly connected .",
    "it is not even known whether the above conditions guarantee the existence of a cycle though any given pair of vertices ( see @xcite ) .",
    "we will prove the following semi - exact form of conjecture  [ nash - williams conjecture - posa ] .",
    "it is ` semi - exact ' in the sense that for half of the vertex degrees , we obtain the conjectured bound , whereas for the other half , we need an additional error term .    [ ckko - approximate posa ] for every @xmath0 there exists an integer @xmath32 such that the following holds .",
    "suppose @xmath1 is a digraph on @xmath33 vertices such that @xmath34 whenever @xmath16 .",
    "then @xmath1 contains a hamilton cycle .",
    "recently , the following approximate version of conjecture  [ nash - williams conjecture - chvatal ] for large digraphs was proved by , osthus and treglown  .",
    "[ kuhn - osthus - treglown ] for every @xmath0 there exists an integer @xmath32 such that the following holds .",
    "suppose @xmath1 is a digraph on @xmath33 vertices such that for all @xmath16    * @xmath35 or @xmath36 ; * @xmath37 or @xmath38 .",
    "then @xmath1 contains a hamilton cycle .",
    "we will extend this to the following theorem , which implies theorem  [ ckko - approximate posa ] .",
    "[ ckko - approximate chvatal ] for every @xmath0 there exists an integer @xmath32 such that the following holds .",
    "suppose @xmath1 is a digraph on @xmath33 vertices such that for all @xmath16    * @xmath39 or @xmath36 ; * @xmath40 or @xmath38",
    ".    then @xmath1 contains a hamilton cycle .",
    "( for the purposes of our arguments it turns out that there is no significant difference in the use of the assumptions , so for simplicity the reader could just read our proof as it applies to theorem  [ ckko - approximate posa ] . )",
    "the improvement in the degree condition may at first appear minor , so we should stress that capping the degrees at @xmath11 makes the problem substantially more difficult , and we need to develop several new techniques in our solution .",
    "this point can not be fully explained until we have given several definitions , but for the expert reader we make the following comment .",
    "speaking very roughly , the general idea used in is to apply szemerdi s regularity lemma , cover most of the reduced digraph by directed cycles , and then use the expansion property guaranteed by the degree conditions on  @xmath1 to link these cycles up into a hamilton cycle while absorbing any exceptional vertices .",
    "when the degrees are capped at @xmath11 two additional difficulties arise : ( i ) the expansion property is no longer sufficient to link up the cycles , and ( ii ) failure of a previously used technique for reducing the size of the exceptional set .",
    "our techniques for circumventing these difficulties seem instructive and potentially useful in attacking conjectures  [ nash - williams conjecture - chvatal ] and  [ nash - williams conjecture - posa ] in full generality .",
    "our paper is organized as follows .",
    "the next section contains some notation and section 3 some preliminary observations and examples .",
    "our proof will use the machinery of szemerdi s regularity lemma , which we describe in section  4 .",
    "( unlike  , we do not require the blow - up lemma . )",
    "section  5 contains an overview of the proof in a special case that illustrates the new methods that we introduce in this paper .",
    "the cycle covering result is proved in section  6 and the proof of the special case completed in section  7 . in section  8",
    "we describe the structures that arise in the general case .",
    "we establish some bounds for these structures in section  9 .",
    "our main theorem is proved in section  10 .",
    "the final section contains a concluding remark .",
    "given two vertices @xmath41 and @xmath42 of a digraph @xmath1 , we write @xmath43 for the edge directed from @xmath41 to  @xmath42 .",
    "the _ order _ @xmath44 of @xmath1 is the number of its vertices .",
    "we write @xmath45 and @xmath46 for the outneighbourhood and inneighbourhood of @xmath41 and @xmath47 and @xmath48 for its outdegree and indegree .",
    "the _ degree _ of @xmath41 is @xmath49 .",
    "we usually drop the subscript @xmath1 if this is unambiguous .",
    "the _ minimum degree _ and _ maximum degree _ of @xmath1 are defined to be @xmath50 and @xmath51 respectively .",
    "we define the _ minimum indegree _ @xmath52 and _ minimum outdegree _",
    "@xmath53 similarly .",
    "the _ minimum semidegree _ is @xmath54 .",
    "given @xmath55 we write @xmath56 for the outdegree of @xmath41 in the set @xmath57 .",
    "we define @xmath58 and @xmath59 similarly .",
    "given a set @xmath60 of vertices of @xmath1 , we write @xmath61 for the set of all outneighbours of vertices of @xmath60 , i.e.  for the union of @xmath45 over all @xmath62 .",
    "we define @xmath63 analogously .",
    "given vertex sets @xmath60 and @xmath64 in a graph or digraph @xmath1 , we write @xmath65 for the set of all edges @xmath66 with @xmath67 and @xmath68 and put @xmath69 . as usual , we drop the subscripts when this is unambiguous . if @xmath70 we write @xmath71 for the bipartite subgraph of @xmath1 with vertex classes @xmath60 and @xmath64 whose set of edges is @xmath65 .",
    "the restriction @xmath72 $ ] of @xmath1 to @xmath60 is the digraph with vertex set @xmath60 and edge set all those edges of @xmath1 with both endpoints in @xmath60 .",
    "we also write @xmath73 for the digraph obtained by deleting @xmath60 and all edges incident to it , i.e.  @xmath74 $ ] .    cycles and paths will always be understood as directed cycles and directed paths , even if this is not explicitly stated . given two vertices @xmath41 and @xmath42 on a directed cycle @xmath75 we write @xmath76 for the subpath of @xmath75 from @xmath41 to @xmath42 .",
    "similarly , given two vertices @xmath41 and @xmath42 on a directed path @xmath77 such that @xmath41 precedes @xmath42 , we write @xmath78 for the subpath of @xmath77 from @xmath41 to @xmath42 .",
    "a _ walk of length @xmath79 _ in a digraph @xmath1 is a sequence @xmath80 of vertices of @xmath1 such that @xmath81 for all @xmath82 .",
    "the walk is _ closed _ if @xmath83 .",
    "a _ 1-factor _ of @xmath1 is a collection of disjoint cycles which cover all vertices of @xmath1 .",
    "given a 1-factor @xmath84 of @xmath1 and a vertex @xmath41 of @xmath1 , we write @xmath85 and @xmath86 for the successor and predecessor of @xmath41 on the cycle in @xmath84 containing @xmath41 .",
    "we usually drop the subscript @xmath84 if this is unambiguous .",
    "we say that @xmath41 and @xmath42 are at _ distance _",
    "@xmath87 on @xmath84 if they belong to the same directed cycle @xmath75 in @xmath84 and the distance from  @xmath41 to  @xmath42 or from @xmath42 to @xmath41 on  @xmath75 is  @xmath87 . note in particular",
    "that with this definition , @xmath41 and @xmath42 could be at distance @xmath87 and @xmath88 on @xmath84 with @xmath89 .",
    "a digraph @xmath1 is _ strongly connected _ if for any ordered pair of vertices @xmath90 there is a directed walk from @xmath41 to @xmath42 .",
    "a _ separator _ of @xmath1 is a set @xmath57 of vertices such that @xmath91 is not strongly connected .",
    "we say @xmath1 is _",
    "strongly @xmath92-connected _ if @xmath93 and if it has no separator of size less than @xmath92 . by menger",
    "s theorem , this is equivalent to the property that for any ordered pair of vertices @xmath90 there are @xmath92 internally disjoint paths from @xmath41 to @xmath42 .",
    "we write @xmath94 to mean that the real numbers @xmath95 satisfy @xmath96 .",
    "we sometimes also write an expression such as @xmath97 to mean @xmath98 and @xmath99 . the use of the @xmath100 sign will be clear from the context .    to avoid unnecessarily complicated calculations we will sometimes omit floor and ceiling signs and treat large numbers as if they were integers .",
    "in this section we record some simple consequences of our degree assumptions and describe the examples showing that conjectures  [ nash - williams conjecture - chvatal ] and  [ nash - williams conjecture - posa ] would be best possible .",
    "we also recall two results on graph matchings and a standard large deviation inequality ( the chernoff bound ) .",
    "our degree assumptions are that for all @xmath16 we have    * @xmath39 or @xmath36 ; * @xmath40 or @xmath38 .",
    "we claim that @xmath101 . for",
    "if this were false our assumptions would give @xmath102 , i.e.  @xmath1 contains at least @xmath103 vertices of indegree @xmath104 .",
    "but a vertex of indegree @xmath104 is an outneighbour of all other vertices , so this also implies that @xmath105 .",
    "similarly we have @xmath106 .    to avoid complications with boundary cases it will be convenient to drop the condition @xmath14 .",
    "we note that this does not change our assumptions . for",
    "if @xmath107 we can apply our assumption ( i ) to @xmath108 and get @xmath109 or @xmath110 , i.e.  @xmath111 or @xmath112 , which implies assumption ( ii ) for @xmath113 .",
    "similarly assumption ( ii ) for @xmath114 implies assumption ( i ) for @xmath113 .",
    "the assumptions do not make sense for @xmath115 , but if we consider any statement about @xmath116 with @xmath117 $ ] as being vacuous ( i.e.  always true ) , then we do not have to impose any conditions when @xmath115",
    ".    for an extremal example for conjectures  [ nash - williams conjecture - chvatal ] and  [ nash - williams conjecture - posa ] , consider a digraph @xmath1 on @xmath2 vertices constructed as follows .",
    "the vertex set is partitioned as @xmath118 with @xmath119 and @xmath120 .",
    "we make @xmath121 independent and @xmath122 complete .",
    "then we pick a set @xmath123 of @xmath92 vertices of @xmath122 and add all possible edges in both directions between @xmath121 and @xmath123 .",
    "this gives a strongly connected non - hamiltonian digraph  @xmath1 in which both the indegree and outdegree sequence are @xmath124 @xmath1 fails conditions  ( i ) and  ( ii ) in conjecture  [ nash - williams conjecture - chvatal ] for @xmath125 and also one of the conditions in conjecture  [ nash - williams conjecture - posa ] .",
    "in fact , a more complicated example is given in where only one condition in conjecture  [ nash - williams conjecture - chvatal ] fails .",
    "so , if true , conjecture  [ nash - williams conjecture - chvatal ] would be best possible in the same sense as chvtal s theorem .",
    "a _ matching _ in a graph or digraph @xmath1 is a set of pairwise disjoint edges .",
    "cover _ is a set @xmath75 of vertices such that every edge of @xmath1 is incident to at least one vertex in @xmath75 . for bipartite graphs",
    "these concepts are related by the following classical result of knig .",
    "[ konig ] in any bipartite graph , a maximum matching and a minimum cover have equal size .",
    "the following result , known as the ` defect hall theorem ' , may be easily deduced from proposition  [ konig ] , using the observation that if @xmath75 is a cover then @xmath126 .",
    "[ dhall ] suppose @xmath1 is a bipartite graph with vertex classes @xmath60 and @xmath64 and there is some number @xmath127 such that for any @xmath128 we have @xmath129",
    ". then @xmath1 contains a matching of size at least @xmath130 .",
    "we will also need the following well - known fact .",
    "[ 1-factor ] suppose that @xmath131 is a digraph such that @xmath132 for every @xmath133",
    ". then @xmath131 has a @xmath134-factor .",
    "the result follows immediately by applying proposition  [ dhall ] ( with @xmath135 ) to the following bipartite graph  @xmath136 : both vertex classes @xmath137 of  @xmath136 are copies of the vertex set of the original digraph @xmath131 and we connect a vertex @xmath67 to @xmath68 in  @xmath136 if there is a directed edge from @xmath138 to @xmath139 in  @xmath131 .",
    "a perfect matching in  @xmath136 corresponds to a 1-factor in  @xmath131 .",
    "we conclude by recording the chernoff bounds for binomial and hypergeometric distributions ( see e.g.  ) .",
    "recall that the binomial random variable with parameters @xmath140 is the sum of @xmath2 independent bernoulli variables , each taking value @xmath134 with probability @xmath141 or @xmath142 with probability @xmath143 .",
    "the hypergeometric random variable @xmath123 with parameters @xmath144 is defined as follows .",
    "we let @xmath145 be a set of size @xmath2 , fix @xmath146 of size @xmath147 , pick a uniformly random @xmath148 of size @xmath149 , then define @xmath150 .",
    "note that @xmath151 .",
    "[ chernoff ] suppose @xmath123 has binomial or hypergeometric distribution and @xmath152",
    ". then @xmath153 .",
    "the proof of theorem  [ ckko - approximate chvatal ] will use the directed version of s regularity lemma . in this section ,",
    "we state a digraph form of this lemma and establish some additional useful properties . for surveys on the regularity lemma and its applications",
    "we refer the reader to  .      the _ density _ of a bipartite graph @xmath154 with vertex classes @xmath60 and @xmath64 is defined to be @xmath155 .",
    "we often write @xmath156",
    "if this is unambiguous . given @xmath157 , we say that @xmath1 is @xmath158-_regular _ if for all subsets @xmath159 and @xmath160 with @xmath161 and @xmath162 we have that @xmath163 . given @xmath164 $ ] , we say that @xmath1 is @xmath165-_regular _ if it is @xmath158-regular of density at least @xmath87 .",
    "we also say that @xmath1 is @xmath165-_super - regular _ if it is @xmath158-regular and furthermore @xmath166 for all @xmath67 and @xmath167 for all @xmath68 .    given a digraph @xmath1 , and disjoint subsets @xmath137 of @xmath168",
    ", we say that the ordered pair @xmath71 is @xmath158-regular , if the corresponding undirected bipartite graph induced by the edges of @xmath1 from @xmath60 to @xmath64 is @xmath158-regular .",
    "we use a similar convention for super - regularity .",
    "the diregularity lemma is a version of the regularity lemma for digraphs due to alon and shapira  .",
    "we will use the degree form of the diregularity lemma , which can be easily derived from the standard version , in exactly the same manner as the undirected degree form .",
    "( see e.g.   for a sketch proof . )",
    "[ diregularity ] for every @xmath169 and each positive integer @xmath170 , there are positive integers @xmath171 and @xmath172 such that if @xmath1 is a digraph on @xmath33 vertices , @xmath164 $ ] is any real number , then there is a partition of the vertices of @xmath1 into @xmath173 and a spanning subdigraph @xmath174 of @xmath1 with the following properties :    * @xmath175 ; * @xmath176 and @xmath177 $ ] is empty for all @xmath178 ; * @xmath179 and @xmath180 for all @xmath181 ; * all pairs @xmath182 with @xmath183 and @xmath184 are @xmath158-regular with density either 0 or at least @xmath87 .",
    "note that we do not require the densities of @xmath182 and @xmath185 to be the same .",
    "we call @xmath186 the _ clusters _ of the partition , @xmath187 the _ exceptional set _ and the vertices of @xmath1 in @xmath187 the _ exceptional vertices_. the _ reduced digraph _ @xmath188 of @xmath1 with parameters @xmath189 ( with respect to the above partition ) is the digraph whose vertices are the clusters @xmath186 and in which @xmath190 is an edge precisely when @xmath182 has density at least @xmath87 . in various stages of our proof of theorem  [ ckko - approximate chvatal ] , we will want to make some pairs of clusters super - regular , while retaining the regularity of all other pairs .",
    "this can be achieved by the following folklore lemma . here and later on",
    "we write @xmath191 to mean that we can choose the constants @xmath192 and @xmath193 from right to left .",
    "more precisely , there is an increasing function @xmath194 such that , given @xmath192 , whenever we choose some @xmath195 all calculations in the proof of lemma  [ super - regular ] are valid .",
    "hierarchies with more constants are to be understood in a similar way .",
    "[ super - regular ] let @xmath196 and let @xmath197 be a reduced digraph of @xmath1 as given by lemma  [ diregularity ] .",
    "let @xmath198 be a subdigraph of @xmath197 of maximum degree @xmath199 .",
    "then , we can move exactly @xmath200 vertices from each cluster @xmath201 into @xmath187 such that each pair of clusters corresponding to an edge of @xmath198 becomes @xmath202-super - regular , while each pair of clusters corresponding to an edge of @xmath197 becomes @xmath203-regular .    for each cluster @xmath204 , let @xmath205 the definition of regularity implies that @xmath206 . remove from each cluster",
    "@xmath207 a set of size exactly @xmath200 containing @xmath208 .",
    "since @xmath209 , it follows easily that all pairs corresponding to edges of @xmath197 become @xmath203-regular . moreover , the minimum degree of each pair corresponding to an edge of @xmath198 is at least @xmath210 , as required .",
    "next we note the easy fact that regular pairs have nearly perfect matchings and super - regular pairs have perfect matchings .",
    "[ regmatch ] suppose @xmath157 and @xmath211 is an @xmath212-regular pair with @xmath213 .",
    "then @xmath1 contains a matching of size at least @xmath214 .",
    "furthermore , if @xmath1 is @xmath212-super - regular then @xmath1 has a perfect matching .    for the first statement",
    "we verify the conditions of the defect hall theorem ( proposition  [ dhall ] ) with @xmath215 .",
    "we need to show that @xmath129 for @xmath128 .",
    "we can assume that @xmath216 . then by @xmath158-regularity , all but at most @xmath217 vertices in @xmath64 have at least @xmath218 neighbours in @xmath57 .",
    "therefore @xmath219 , as required .",
    "for the second statement we need to show that @xmath220 for @xmath128 . for any @xmath221 we have @xmath222 by super - regularity ,",
    "so we can assume that @xmath223 .",
    "then as before we have @xmath224 , so we can assume that @xmath225 .",
    "but we also have @xmath226 for any @xmath227 , so @xmath228 , i.e. @xmath229 and @xmath230 .",
    "we will also need the following regularity criterion for finding a hamilton cycle in a non - bipartite digraph .",
    "we say that a general digraph @xmath1 on @xmath2 vertices is _",
    "@xmath158-regular _ of density @xmath87 if @xmath231 for all ( not necessarily disjoint ) subsets @xmath232 of @xmath168 of size at least @xmath217 , and @xmath165-_super - regular _ if it is @xmath158-regular and @xmath233 .",
    "[ fk ] suppose @xmath234 , @xmath2 is sufficiently large and @xmath1 is an @xmath165-super - regular digraph on @xmath2 vertices .",
    "then @xmath1 is hamiltonian .",
    "in fact , frieze and krivelevich ( * ? ? ? * theorem 4 ) proved that an @xmath165-super - regular digraph has @xmath235 edge - disjoint hamilton cycles , which is a substantial strengthening of lemma  [ fk ] .",
    "lemma  [ fk ] can also be deduced from lemma 10 in .",
    "next we need a construction that we will use to preserve super - regularity of a pair when certain specified vertices are excluded .",
    "[ tw ] suppose @xmath234 , @xmath211 is an @xmath165-super - regular pair with @xmath213 sufficiently large and @xmath159 with @xmath236 .",
    "then there is a set @xmath160 with @xmath237 such that @xmath238 is @xmath239-super - regular .    if @xmath240 then we choose @xmath241 arbitrarily with @xmath237 .",
    "next suppose that @xmath242 .",
    "we let @xmath243 be the set of vertices in @xmath64 that have less than @xmath244 neighbours in @xmath245",
    ". then @xmath246 by @xmath158-regularity of @xmath1 .",
    "consider choosing @xmath247 of size @xmath248 uniformly at random . for any @xmath41 in @xmath60 its degree in @xmath249",
    "is @xmath250 , which has hypergeometric distribution with parameters @xmath251 .",
    "super - regularity gives @xmath252= d_{b { \\setminus}b_1}(x)|b_2|/|b { \\setminus}b_1| > { \\varepsilon}dn/2 $ ] , and the chernoff bound ( proposition  [ chernoff ] ) applied with @xmath253 gives @xmath254 . by a union bound ,",
    "there is some choice of @xmath249 so that every @xmath41 in @xmath60 has @xmath255 ( say ) .",
    "let @xmath256 .",
    "then @xmath238 is @xmath257-regular , by @xmath158-regularity of @xmath1 .",
    "furthermore , every @xmath258 has @xmath259 by definition of @xmath243 , and every @xmath41 in @xmath260 has @xmath261 .",
    "finally , given an @xmath165-super - regular pair @xmath211 , we will often need to isolate a small subpair that maintains super - regularity in any subpair that contains it .",
    "for @xmath262 and @xmath263 we say that @xmath264 is an _",
    "@xmath265-ideal for @xmath266 _ if for any @xmath267 and @xmath268 the pair @xmath269 is @xmath265-super - regular .",
    "the following lemma shows that ideals exist , and moreover randomly chosen sets @xmath270 and @xmath271 form an ideal with high probability .",
    "[ ideal ] suppose @xmath272 , @xmath2 is sufficiently large and @xmath211 is @xmath165-super - regular with @xmath273 .",
    "let @xmath262 and @xmath263 be independent uniformly random subsets of size @xmath274 . then with high probability @xmath264 is an @xmath275-ideal for @xmath266 .",
    "first we note that @xmath158-regularity of @xmath1 implies that @xmath269 is @xmath276-regular for any @xmath277 and @xmath278 with @xmath279 . for each @xmath280 , the degree of @xmath41 in @xmath271 is @xmath281 , which has hypergeometric distribution with parameters @xmath282 and expectation @xmath283 { \\geqslant}\\theta d_g(x)$ ] . by super - regularity",
    "we have @xmath284 , so by the chernoff bound ( proposition  [ chernoff ] ) applied with @xmath285{\\geqslant}d/4 $ ] , we have @xmath286 . by a union bound",
    ", there is some choice of @xmath271 so that every @xmath62 has at least @xmath287 neighbours in @xmath271 , and so at least @xmath288 neighbours in @xmath289 for any @xmath268 .",
    "arguing similarly for @xmath270 gives the result .",
    "we will first prove a special case of theorem  [ ckko - approximate chvatal ] . although it would be possible to give a single argument that covers all cases , we believe it is instructive to understand the methods in a simplified setting before introducing additional complications .",
    "this section gives an overview of our techniques .",
    "we begin by defining additional constants such that @xmath290 note that this hierarchy of parameters will be used throughout the paper . by applying the diregularity lemma to @xmath1 with parameters @xmath291 and @xmath292",
    ", we obtain a reduced digraph @xmath293 on @xmath92 clusters of size @xmath294 and an exceptional set @xmath187 .",
    "we will see that the degree sequences of @xmath293 inherit many of the properties of the degree sequences of @xmath1 .",
    "then it will follow that @xmath293 contains a union of cycles @xmath84 which covers all but at most @xmath295 of the clusters of @xmath293 .",
    "we move the vertices of all clusters not covered by @xmath84 into @xmath187 . by moving some further vertices into @xmath187",
    "we can assume that all edges of @xmath84 correspond to super - regular pairs .",
    "let @xmath296 be the digraph obtained from @xmath293 by adding the set @xmath187 of exceptional vertices and for each @xmath297 and each @xmath298 adding the edge @xmath299 if @xmath41 has an outneighbour in @xmath207 and the edge @xmath300 if @xmath41 has an inneighbour in @xmath207 .",
    "we would like to find a closed walk @xmath301 in @xmath296 such that    * for each cycle @xmath75 of @xmath84 , @xmath301 visits every cluster of @xmath75 the same number of times , say @xmath302 ; * we have @xmath303 , i.e.@xmath301 visits every cluster at least once but not too many times ; * @xmath301 visits every vertex of @xmath187 exactly once ; * for each @xmath304 we can choose an inneighbour @xmath305 in the cluster preceding @xmath306 on @xmath301 and an outneighbour @xmath307 in the cluster following @xmath306 on @xmath301 , so that as @xmath306 ranges over @xmath187 all vertices @xmath307 , @xmath305 are distinct .",
    "if we could find such a walk @xmath301 then by properties ( a ) and ( b ) we can arrange that @xmath308 for each cycle @xmath75 of @xmath84 by going round @xmath75 an extra @xmath309 times on one particular visit of @xmath301 to @xmath75 .",
    "then we could apply properties ( c ) and ( d ) to choose inneighbours and outneighbours for every vertex of @xmath187 such that all choices are distinct .",
    "finally , we could apply a powerful tool known as the blow - up lemma ( see ) to find a hamilton cycle @xmath310 in @xmath1 corresponding to @xmath301 , where @xmath310 has the property that whenever @xmath301 visits a vertex of @xmath187 , @xmath310 visits the same vertex , and whenever @xmath301 visits a cluster @xmath201 of @xmath293 , then @xmath310 visits a vertex @xmath311 .",
    "( we will not discuss the blow - up lemma further , as in fact we will take a different approach that does not need it . )    to achieve property ( a ) , we will build up @xmath301 from certain ` shifted ' walks , each of them satisfying property ( a ) .",
    "suppose @xmath197 is a digraph , @xmath312 is a subdigraph of @xmath197 , @xmath84 is a @xmath134-factor in @xmath197 and @xmath313 are vertices .",
    "a _ shifted walk _ ( with respect to @xmath312 and @xmath84 ) from @xmath138 to @xmath139 is a walk @xmath314 of the form @xmath315 where @xmath316 , @xmath317 , @xmath318 is the cycle of @xmath84 containing @xmath319 , and for each @xmath320 , @xmath321 is the predecessor of @xmath319 on @xmath318 and the edge @xmath322 belongs to @xmath312 .",
    "we say that @xmath314 _ traverses the cycles @xmath323_. note that even if the cycles @xmath323 are not distinct we say that @xmath301 traverses @xmath324 cycles .",
    "note also that , for every cycle @xmath75 of @xmath84 , the walk @xmath325 visits the vertices of @xmath75 an equal number of times .    given a shifted walk @xmath326 as above we say that @xmath301 _ uses _",
    "@xmath123 if @xmath123 appears in the list @xmath327 .",
    "more generally , we say that @xmath123 is _ used @xmath328 times _ by @xmath301 if it appears @xmath328 times in the above list ( counting multiplicities ) .",
    "thus @xmath301 uses @xmath329 clusters , counting multiplicities .",
    "we say that @xmath301 _ internally uses _",
    "@xmath123 if @xmath330 ( i.e.  we do not count the uses of @xmath331 or @xmath332 ) . we also refer to the uses of @xmath333 as _ entrance uses _ and @xmath334 as _ exit uses_. if @xmath123 is used as both @xmath319 and @xmath335 for some @xmath336 then we can obtain a shorter shifted walk from @xmath138 to @xmath139 by deleting the segment of @xmath301 between @xmath319 and @xmath335 ( retaining one of them ) .",
    "similarly , we can obtain a shorter shifted walk if @xmath123 is used as both @xmath337 and @xmath338 for some @xmath339 .",
    "thus we can always choose shifted walks so that any cluster is used at most once as an entrance and at most once as an exit , and so is used at most twice in total .",
    "we say that a cluster @xmath207 is _",
    "entered @xmath138 times _ by @xmath301 if @xmath301 contains @xmath138 edges whose final vertex is @xmath207 and which do not lie in  @xmath84 ( where the edges of @xmath301 are counted with multiplicities ) .",
    "we have a similar definition for _ exiting @xmath207 @xmath138 times_. next we define an auxiliary digraph @xmath198 that plays a crucial role in our argument .",
    "let @xmath340 be the spanning subdigraph of @xmath293 obtained by deleting all those edges corresponding to a pair of clusters whose density is less than @xmath88 .",
    "let @xmath84 be the @xmath134-factor of @xmath293 mentioned above .",
    "the vertices of @xmath198 are the clusters of @xmath340 .",
    "we have an edge from @xmath138 to @xmath139 in @xmath198 if there is a shifted walk with respect to @xmath340 and @xmath84 from @xmath138 to @xmath139 which traverses exactly one cycle .",
    "one can view @xmath198 as a ` shifted version ' of @xmath340 .",
    "for now we will only consider the special case in which @xmath198 is highly connected .",
    "even then , the fact that the exceptional set @xmath187 can be much bigger than the cluster sizes creates a difficulty in ensuring property ( b ) , that @xmath301 does not visit a cluster too many times . a natural attempt to overcome",
    "this difficulty is the technique from  . in that paper",
    "we split each cluster @xmath201 of @xmath293 into two equal pieces @xmath341 and @xmath342 .",
    "if the splitting is done at random , then with high probability , the super - regularity between pairs of clusters corresponding to the edges of @xmath84 is preserved .",
    "we then applied the diregularity lemma to the subdigraph of @xmath1 induced by @xmath343 with parameters @xmath344 and @xmath345 to obtain a reduced graph @xmath346 and an exceptional set @xmath347 .",
    "the advantage gained is that by choosing @xmath348 the exceptional set @xmath347 becomes much smaller than the original cluster sizes and there is no difficulty with property ( b ) above .",
    "however , the catch is that in our present case the degrees are capped at @xmath11 , and in the course of constructing the union of cycles in @xmath346 we would have to enlarge @xmath347 to such an extent that this approach breaks down .",
    "our solution is to replace condition ( b ) by the following property for @xmath301 :    * @xmath301 visits every cluster of @xmath293 at least once but does not _ use _ any cluster of @xmath293 too many times .",
    "this condition can be guaranteed by the high connectivity property of @xmath198 .",
    "however , we now have to deal with the fact that @xmath301 may ` wind around ' each cycle of @xmath84 too many times .",
    "this will be addressed by a shortcutting technique , where for each cycle @xmath75 in @xmath84 we consider the required uses of @xmath75 en masse and reassign routes so as not to overload any part of @xmath75 .",
    "a side - effect of this procedure is that we may obtain a union of cycles , rather than a single hamilton cycle .",
    "however , using a judicious choice of @xmath301 and a switching procedure for matchings , we will be able to arrange that these shortcuts do produce a single hamilton cycle .",
    "in particular , this approach does not rely on the blow - up lemma .",
    "we start the proof by applying the diregularity lemma ( lemma  [ diregularity ] ) to @xmath1 with parameters @xmath291 and @xmath292 , obtaining a reduced digraph @xmath293 on @xmath92 clusters of size @xmath294 and an exceptional set @xmath187 .",
    "initially we have @xmath349 , although we will add vertices to @xmath187 during the argument .",
    "note also that @xmath350 .",
    "our main aim in this section is to show that @xmath293 contains an almost @xmath134-factor @xmath84 , more specifically , a disjoint union of directed cycles covering all but at most @xmath351 vertices of @xmath293 . to begin with ,",
    "we show that the degree sequences of @xmath293 have similar properties to the degree sequences of @xmath1 .",
    "[ degree sequence of r_g ] @xmath352    * @xmath353 ; * @xmath354 ; * @xmath355 ; * @xmath356 ; * @xmath357 or @xmath358 ; * @xmath359 or @xmath360",
    ".    we will only prove parts ( i),(iii ) and ( v ) .",
    "parts ( ii ) , ( iv ) and ( vi ) can be obtained in exactly the same way as parts ( i ) , ( iii ) and ( v ) respectively , by interchanging @xmath361 and @xmath362 signs .",
    "consider @xmath113 clusters with outdegrees at most @xmath363 in @xmath293 .",
    "these clusters contain @xmath364 vertices of @xmath1 , so must include a vertex  @xmath41 of outdegree at least @xmath365 .",
    "lemma  [ diregularity ] implies that the cluster  @xmath207 containing  @xmath41 satisfies @xmath366 therefore @xmath367 which proves ( i ) .",
    "next , ( iii ) follows from ( i ) , since @xmath105 . to prove ( v ) , suppose that @xmath368 .",
    "it follows from ( i ) that @xmath369 using our degree assumptions gives @xmath370 . then by ( ii ) we have @xmath371 as required .",
    "unfortunately , @xmath293 need not satisfy the hypothesis of proposition  [ 1-factor ] , so we can not use it to deduce the existence of a 1-factor in @xmath293 .",
    "the next lemma shows that a problem can only occur for subsets @xmath57 of @xmath372 of size close to @xmath373 .",
    "[ outexpansion of r_g ] let @xmath57 be a subset of @xmath372 such that either @xmath374 or @xmath375",
    ". then @xmath376 .",
    "suppose firstly that @xmath374 but @xmath377 . by the minimum outdegree condition of @xmath293 ( lemma  [ degree sequence of r_g ]  ( iii ) ) we must have @xmath378 .",
    "also @xmath379 , so lemma  [ degree sequence of r_g ]  ( v ) gives @xmath380 .",
    "thus there are at least @xmath381 vertices of indegree at least @xmath382 . now",
    "if @xmath41 has indegree at least @xmath383 then @xmath384 intersects @xmath57 , so @xmath41 belongs to @xmath385 .",
    "we deduce that @xmath132 .",
    "a similar argument shows that @xmath386 as well .",
    "now suppose that @xmath375 but @xmath377 , and consider @xmath387 . since @xmath388 , we have @xmath389 , and so @xmath390 by the first case .",
    "but now we can consider a subset @xmath391 of @xmath392 of size @xmath393 to see that @xmath394 , and so @xmath395 , a contradiction .",
    "the claim for @xmath396 follows by a similar argument .    applying hall s theorem as in proposition  [ 1-factor ]",
    ", one can use lemma  [ outexpansion of r_g ] to partition the vertex set of @xmath293 into a union of cycles and at most @xmath397 paths .",
    "however , for our approach we need to find a disjoint union of cycles covering almost all the vertices .",
    "the first step towards this goal will be to arrange that for each path its initial vertex has large indegree and its final vertex has large outdegree . to prepare the ground ,",
    "we show in the next lemma that if @xmath293 does not have a @xmath134-factor , then it has many vertices of large outdegree and many vertices of large indegree .",
    "[ no 1-factor in r_g = = > many vertices of large degree ] if @xmath293 does not have a @xmath134-factor , then it contains more than @xmath398 vertices of outdegree at least @xmath399 and more than @xmath398 vertices of indegree at least @xmath399 .    since @xmath293",
    "does not have a @xmath134-factor , by proposition  [ 1-factor ] it contains a set @xmath57 with @xmath377 .",
    "then by lemma  [ degree sequence of r_g ] ( i ) we have @xmath400 and so @xmath401 moreover , @xmath402 by lemma  [ outexpansion of r_g ] .",
    "so if it were also the case that @xmath403 , then @xmath404 and so by lemma  [ degree sequence of r_g ] ( ii ) we would have @xmath405 then @xmath293 contains at least @xmath406 vertices of indegree at least @xmath382 , and these must all belong to @xmath385 , a contradiction .",
    "it follows that @xmath407 .",
    "so lemma  [ degree sequence of r_g ] ( i ) gives @xmath408 i.e.  @xmath293 contains at least @xmath409 vertices of outdegree at least @xmath399 , which proves the first part of the lemma .",
    "the second part can be proved in exactly the same way .",
    "now we can show how to arrange the degree property for the paths .",
    "[ r_g is a union of cycles and not too many paths ] the vertex set of @xmath293 can be partitioned into a union of cycles and at most @xmath397 paths such that the initial vertices of the paths each have indegree at least @xmath399 and the final vertices of the paths each have outdegree at least @xmath399 .",
    "we may assume that @xmath293 does not have a @xmath134-factor and so the consequences of lemma  [ no 1-factor in r_g = = > many vertices of large degree ] hold .",
    "we define an auxiliary digraph @xmath410 by adding @xmath397 new vertices @xmath411 to @xmath293 , adding all possible edges between these vertices ( in both directions ) , adding all edges of the form @xmath412 , where @xmath413 and @xmath414 is a vertex of @xmath293 of outdegree at least @xmath399 and finally adding all edges of the form @xmath415 where @xmath413 and @xmath414 is a vertex of @xmath293 of indegree at least @xmath399 .",
    "then any vertex that previously had indegree at least @xmath416 now has indegree at least @xmath417 , and similarly for outdegree .",
    "also , lemma  [ no 1-factor in r_g = = > many vertices of large degree ] implies that every new vertex @xmath418 has indegree and outdegree more than @xmath398 .",
    "we claim that @xmath410 has a @xmath134-factor .",
    "having proved this , the result will follow by removing @xmath419 from the cycles in the 1-factor . to prove the claim ,",
    "let us take @xmath420 .",
    "by proposition  [ 1-factor ] we need to show that @xmath132 .",
    "we consider cases according to the size of @xmath57 . if @xmath374 , then either @xmath421 , in which case @xmath132 by lemma  [ outexpansion of r_g ] , or @xmath57 contains some new vertex @xmath418 , in which case @xmath422 .",
    "next suppose that @xmath423 .",
    "as before , if @xmath57 contains a new vertex @xmath418 we have @xmath422 , so we can assume @xmath421",
    ". now by lemma  [ no 1-factor in r_g = = > many vertices of large degree ] each new vertex @xmath418 has at least @xmath424 inneighbours in @xmath372 and so @xmath418 has an inneighbour in  @xmath57 , i.e.  @xmath425 .",
    "also , @xmath57 has at least @xmath399 outneighbours in @xmath293 by lemma  [ outexpansion of r_g ] , so in @xmath410 we have @xmath426 .",
    "finally suppose that @xmath375 .",
    "let @xmath427 .",
    "considering a subset @xmath428 of size @xmath417 shows that @xmath429 .",
    "however , @xmath430 is disjoint from @xmath57 , so if @xmath377 we have @xmath431 .",
    "now similar arguments to before give @xmath432 , a contradiction .",
    "we now come to the main result of this section .",
    "[ existence of f ] @xmath293 contains a disjoint union @xmath84 of cycles covering all but at most @xmath351 of its vertices .",
    "we implement the following algorithm . at each stage ,",
    "the vertex set of @xmath293 will be partitioned into some cycles and paths and a waste set @xmath301 . in every path",
    "the initial vertex will have indegree at least @xmath399 and the final vertex will have outdegree at least @xmath399 .",
    "one of the paths will be designated as the ` active path ' .    in the initial step ,",
    "we begin with the partition guaranteed by lemma  [ r_g is a union of cycles and not too many paths ] .",
    "we have @xmath433 and choose an arbitrary path to be active .",
    "in each iterative step we have some active path @xmath77 .",
    "let @xmath434 be the initial vertex of @xmath77 and @xmath414 its final vertex .",
    "let @xmath57 be the sum of the numbers of vertices in all the paths .",
    "if at any point @xmath435 , then we move the vertices of all these paths into @xmath301 and stop .",
    "otherwise we define @xmath436 and for each path @xmath437 , we let @xmath438 .",
    "note that the parameters @xmath57 , @xmath439 and @xmath440 are recalculated at each step . by our assumption on @xmath57",
    "we have @xmath441 .",
    "also @xmath442 .    for each cycle @xmath443 and @xmath444 we write @xmath445 for the set of successors of vertices of @xmath123 .",
    "for each path @xmath446 , @xmath447 and @xmath448 we let @xmath449 . also , for each path @xmath450 which contains at least one outneighbour of @xmath414 we let @xmath451 be minimal such that @xmath452 .",
    "similarly , for each path @xmath450 which contains at least one inneighbour of @xmath434 we let @xmath453 be minimal such that @xmath454 .",
    "we claim that at least one of the following conditions holds :    * there is a @xmath455 such that @xmath456 .",
    "* there is a cycle @xmath457 such that @xmath458 .",
    "* there is a path @xmath446 and @xmath339 with @xmath459 such that @xmath460 .",
    "* there is a path @xmath446 with @xmath461 or @xmath462 .    to see this ,",
    "suppose to the contrary that all these conditions fail .",
    "since ( 1 ) fails , then @xmath463 and so    * @xmath464 .    since ( 2 ) fails , then for each cycle @xmath75 we have @xmath465 and so    * @xmath466 for each @xmath75 .",
    "since ( 4 ) fails then for each path @xmath437 we have @xmath467 and @xmath468 .",
    "in particular    * for each path @xmath437 , if @xmath437 does not meet both @xmath469 and @xmath470 then @xmath471 .    on the other hand if a path @xmath437 meets both @xmath469 and @xmath470 then , since ( 3 ) fails we have @xmath472 .",
    "moreover , since @xmath473 and since also ( 4 ) fails , we also have that @xmath474 .",
    "altogether this gives that    * for each path @xmath437 , if @xmath437 meets both @xmath469 and @xmath470 then @xmath471 .",
    "summing these inequalities gives @xmath475",
    "but we also have @xmath442 and @xmath476 by the degree property of the paths .",
    "this contradiction shows that at least one of the conditions ( 1)(4 ) holds .",
    "according to the above conditions we take one of the following actions .",
    "* suppose there is a @xmath455 such that @xmath456 .",
    "then we replace the path @xmath77 by the cycle @xmath477 , replace @xmath301 by @xmath478 , choose a new active path , and repeat .",
    "* suppose there is a cycle @xmath457 such that @xmath458 .",
    "then we replace the path @xmath77 and the cycle @xmath75 by the cycle @xmath479 , choose a new active path , and repeat .",
    "* suppose there is a path @xmath446 and @xmath339 with @xmath459 such that @xmath480 .",
    "+ \\(i ) if @xmath481 then we replace the paths @xmath77 and @xmath437 with the path @xmath482 , replace @xmath301 with @xmath483 , make @xmath484 the new active path , and repeat .",
    "+ \\(ii ) if @xmath485 ( so @xmath486 and @xmath487 ) then we replace @xmath77 with the cycles @xmath488 and @xmath489 , replace @xmath301 with @xmath490 , choose a new active path , and repeat .",
    "* suppose there is a path @xmath446 with @xmath461 or @xmath462 .",
    "+ \\(i ) if @xmath481 and @xmath461 then we replace the paths @xmath77 and @xmath437 with the path @xmath491 , replace @xmath301 with @xmath492 , make @xmath493 the new active path , and repeat .",
    "+ \\(ii ) if @xmath481 and @xmath462 then we replace the paths @xmath77 and @xmath437 with the path @xmath494 , replace @xmath301 with @xmath495 , make @xmath493 the new active path , and repeat .",
    "+ \\(iii ) if @xmath485 ( so @xmath486 and @xmath487 ) and @xmath461 then we replace @xmath77 with the cycle @xmath496 , replace @xmath301 with @xmath497 , choose a new active path , and repeat .",
    "+ \\(iv ) if @xmath485 and @xmath498 then we replace @xmath77 with the cycle @xmath499 , replace @xmath301 with @xmath500 , choose a new active path , and repeat .    at each step",
    "the number of paths is reduced by at least  1 , so the algorithm will terminate .",
    "it remains to show that @xmath501 .",
    "recall that at every step we have @xmath502 for each path @xmath437 . for every vertex @xmath503 added to @xmath301 we charge its contribution to the path that @xmath503 _ initially _ belonged to . to calculate the total contribution we break it down by the above cases and by initial paths .",
    "cases ( 1 ) and ( 2 ) do not increase the size of @xmath301 . in case  3(i ) , every initial path @xmath437 is merged with an active path @xmath77 at most once , and then its remaining vertices stay in the active path until a new active path is chosen , so this gives a contribution to  @xmath301 of at most @xmath504 from @xmath437 . in case  3(ii ) , the vertices of the active path @xmath485 are contained in a union @xmath505 of some subset of the initial paths ( excluding some vertices already moved into @xmath301 ) .",
    "these paths collectively contribute at most latexmath:[$\\alpha    merged at most once into such a path @xmath77 . in cases  4(i ) and  4(ii ) , as in case 3(i ) , an initial path @xmath437 contributes at most @xmath507 . in cases 4(iii ) and 4(iv ) , as in case 3(ii ) , the vertices of the active path @xmath485 are contained in a union @xmath505 of some subset of the initial paths and contribute at most @xmath508 .",
    "so each initial path contributes to @xmath301 at most twice : once when it is merged into the active path ( in cases  3(i ) , 4(i ) or 4(ii ) ) and once when this active path is turned into one or two cycles ( in cases 3(ii ) , 4(iii ) or 4(iv ) ) .",
    "therefore we get a total contribution from the paths of at most @xmath509 to  @xmath301 .",
    "finally , there is another contribution of at most @xmath510 if at any step we have @xmath435 . in total",
    "we have @xmath501 .",
    "now we have an almost @xmath134-factor @xmath84 in @xmath293 , i.e.  a disjoint union of cycles covering all but at most @xmath351 clusters of @xmath293 .",
    "we move all vertices of these uncovered clusters into @xmath187 , which now has size at most @xmath511 . during the proof of theorem  [ ckko - approximate chvatal ] it will be helpful to arrange that each cycle of @xmath84 has length at least  4 ( say ) and moreover , all pairs of clusters corresponding to edges of @xmath84 correspond to super - regular pairs .",
    "( this assumption on the lengths is not actually necessary but does make some of the arguments in the final section more transparent . )",
    "we will now show that we may assume this .",
    "indeed , if @xmath84 contains cycles of lengths less than 4 , we arbitrarily partition each cluster of @xmath293 into  2 parts of equal size .",
    "( if the sizes of the clusters are not divisible by 2 , then before the partitioning we move at most 1 vertex from each cluster into @xmath187 in order to achieve this . )",
    "consider the digraph @xmath512 whose vertices correspond to the parts and where two vertices are joined by an edge if the corresponding bipartite subdigraph of @xmath174 is @xmath513-regular .",
    "it is easy to check that this digraph contains the @xmath17-fold ` blowup ' of @xmath293 , i.e.  each original vertex is replaced by an independent set of @xmath17 new vertices and there is an edge from a new vertex @xmath41 to a new vertex @xmath42 if there was such an edge between the original vertices .",
    "each cycle of length @xmath79 of @xmath84 induces an @xmath17-fold blowup of @xmath514 in @xmath512 , which contains a cycle of length @xmath515 .",
    "so @xmath512 contains a @xmath134-factor @xmath516 all of whose cycles have length at least  4 .",
    "note that the size of @xmath187 is now at most @xmath517 .    secondly , we apply lemma  [ super - regular ] to make the pairs of clusters corresponding to edges of @xmath516 @xmath518-super - regular by moving exactly @xmath519 vertices from each cluster @xmath201 into @xmath187 and thus increasing the size of @xmath187 to at most @xmath520 . for convenience ,",
    "having made these alterations , we will still denote the reduced digraph by @xmath293 , the order of @xmath293 by @xmath92 , its vertices ( the clusters ) by @xmath521 and their sizes by @xmath294 .",
    "we also rename @xmath516 as @xmath84 .",
    "we sometimes refer to the cycles in  @xmath84 as _",
    "@xmath84-cycles_.      let @xmath340 be the spanning subdigraph obtained from @xmath293 by deleting all those edges which correspond to pairs of density at most @xmath88 .",
    "recalling that @xmath522 , we note that the density of pairs corresponding to edges in @xmath340 is much larger than the proportion @xmath523 of vertices lying in @xmath187 .",
    "the purpose of @xmath293 was to construct @xmath84 so that this property would hold .",
    "now we have no further use for @xmath293 and will work only with @xmath340 .",
    "( actually , we could use either @xmath340 or @xmath293 for the special case in the next section , but we need to work with @xmath340 in general . )    let @xmath524 be the digraph obtained from @xmath174 obtained by deleting all edges belonging to pairs @xmath525 of clusters so that @xmath526 has density at most @xmath88 .",
    "we say that a vertex @xmath527 is _ typical _ if    * @xmath528 ; * there are at most @xmath529 clusters @xmath241 such that @xmath41 does not have @xmath530 outneighbours in @xmath241 , where @xmath531 denotes the density of the pair @xmath532 .",
    "the analogous statement also holds for the inneighbourhood of @xmath41 .",
    "[ degree sequence of r_g - modified ] by moving exactly @xmath533 vertices from each cluster into @xmath187 , we can arrange that each vertex in each cluster of @xmath340 is typical .",
    "we still denote the cluster sizes by @xmath294",
    ". then we have    * @xmath534 ; * @xmath535 ; * @xmath536 ; * @xmath537 ; * @xmath538 or @xmath539 ; * @xmath540 or @xmath541 .",
    "suppose that we are given clusters @xmath232 such that @xmath542 is an edge of @xmath293 .",
    "write @xmath531 for the density of @xmath526 .",
    "we say that @xmath527 is _ out - typical for @xmath241 _ if ( in @xmath174 ) @xmath41 has @xmath543 outneighbours in @xmath241 .",
    "since the pair @xmath526 is @xmath544-regular , it follows that at most @xmath545 vertices of @xmath123 are not out - typical for @xmath241 .",
    "then on average , a vertex of @xmath123 is not out - typical for at most @xmath546 clusters .",
    "it follows that there are at most @xmath547 vertices @xmath41 in @xmath123 for which there are more than @xmath529 clusters @xmath241 such that @xmath41 is not out - typical for @xmath241 .",
    "therefore we can remove a set of exactly @xmath548 vertices from each cluster so that all of the remaining vertices are out - typical for at least @xmath549 clusters .",
    "we proceed similarly for the inneighbourhood of each cluster .",
    "altogether , we have removed exactly @xmath550 vertices from each cluster .",
    "these vertices are added to @xmath187 , which now has size @xmath551 .",
    "now consider some cluster @xmath123 and a vertex @xmath527 .",
    "since @xmath41 is out - typical for all but at most @xmath529 clusters , it sends at most @xmath552 edges into clusters @xmath241 such that @xmath526 has density at most @xmath88 .",
    "then the following estimate shows that @xmath41 is typical : @xmath553    for ( i)(vi ) , we proceed similarly as in the proof of lemma  [ degree sequence of r_g ] . for ( i ) , consider @xmath113 clusters with outdegrees at most @xmath554 in @xmath340 .",
    "these clusters contain @xmath364 vertices of @xmath1 , so must include a typical vertex  @xmath41 of outdegree at least @xmath365 . as in the previous estimate , the cluster  @xmath207 containing  @xmath41 satisfies",
    "@xmath555 therefore @xmath556 which proves ( i ) .",
    "next , ( iii ) follows from ( i ) , since @xmath105 .",
    "the proof of ( v ) is the same as that of ( v ) in lemma  [ degree sequence of r_g ] , with @xmath557 replaced by @xmath558 .",
    "the proofs of the other three assertions are similar .    by removing at most one extra vertex from each cluster",
    "we may assume that the size of each cluster is even .",
    "we continue to denote the sizes of the modified clusters by @xmath294 and the set of exceptional vertices by @xmath187 .",
    "the large - scale structure of our decomposition will not undergo any significant further changes : there will be no further changes to the cluster sizes , although in some subsequent cases we may add a small number of clusters to @xmath187 in their entirety . for future reference",
    "we note the following properties :    * @xmath559 , * all edges of @xmath340 correspond to @xmath560-regular pairs ( the deletion of atypical vertices may have reduced the densities slightly ) , * all edges of @xmath84 correspond to @xmath561-super - regular pairs .",
    "in this section we illustrate our methods by proving theorem  [ ckko - approximate chvatal ] in the case when the auxiliary graph @xmath198 is strongly @xmath562-connected .",
    "we recall that @xmath563 , and that @xmath198 was defined in section  [ techniques ] as a ` shifted version ' of @xmath340 , i.e.  there is an edge in @xmath198 from a cluster @xmath201 to a cluster @xmath564 if there is a shifted walk ( with respect to @xmath340 and @xmath84 ) from @xmath201 to @xmath564 which traverses exactly one cycle .",
    "we refer to that section for the definitions of when a cluster is ` used ' or ` internally used ' by a shifted walk , and recall that we can assume that any cluster is used at most once as an entrance and at most once as an exit .",
    "[ disjointpaths ] suppose @xmath198 is strongly @xmath565-connected for some @xmath566 and @xmath313 are vertices of @xmath198 ( i.e. clusters ) . then there is a collection of at least @xmath567 shifted walks ( with respect to @xmath340 and @xmath84 ) from @xmath138 to @xmath139 such that each walk traverses at most @xmath568 cycles and each cluster is internally used by at most one of the walks .",
    "since @xmath198 is strongly @xmath569-connected we can find @xmath569 internally disjoint paths @xmath570 from @xmath138 to @xmath139 .",
    "there can not be @xmath571 of these paths each having at least @xmath568 internal vertices , as @xmath198 has @xmath92 vertices .",
    "therefore @xmath198 contains at least @xmath572 internally disjoint paths @xmath573 ( say , after relabelling ) from @xmath138 to @xmath139 which have length at most @xmath568 .",
    "note that each of these corresponds to a shifted walk from @xmath138 to @xmath139 which traverses at most @xmath568 cycles .",
    "let @xmath574 denote these shifted walks .",
    "since the @xmath575 are internally disjoint , each cluster @xmath41 is internally used by at most 2 of the shifted walks @xmath576 ( either as an entrance or as an exit ) . each shifted walk @xmath577 internally uses at most @xmath578 clusters , so there are at most @xmath579 other shifted walks @xmath576 which internally use a cluster that @xmath577 also uses internally .",
    "thus we can greedily choose a subset of the walks @xmath574 having the required properties .    given any cluster @xmath123 , recall that we write @xmath580 for the successor of @xmath123 on @xmath84 and @xmath581 for its predecessor .",
    "for every @xmath123 , we apply lemma  [ ideal ] with @xmath582 to the @xmath561-super - regular pair @xmath583 to obtain an @xmath584-ideal @xmath585 .",
    "set @xmath586 ( where @xmath587 is the ideal chosen for @xmath588 ) .",
    "then , by lemma  [ ideal ] , we have @xmath589 and for any @xmath590 and @xmath591 the pair @xmath592 is @xmath584-super - regular .    first we construct the walk @xmath301 described in the overview .",
    "list the elements of the exceptional set as @xmath593 .",
    "we go through the list sequentially , and for each @xmath306 we pick clusters @xmath319 and @xmath594 of @xmath293 and vertices @xmath595 and @xmath596 such that @xmath597 are distinct and moreover no cluster of  @xmath340 appears more than @xmath598 times as a cluster of the form @xmath599 ( and thus no cluster appears more than @xmath600 times as a cluster of the form @xmath601 ) . to see that this is possible , recall that @xmath602 and @xmath589 for all @xmath123 . at most @xmath603 vertices belong to @xmath187 or to the set @xmath604 , and at most @xmath605 belong to clusters that appear at least @xmath598 times as @xmath335 or @xmath606 for @xmath607 with @xmath608 . therefore at most @xmath609 vertices are unavailable at stage @xmath113 , so we can choose @xmath305 and @xmath319 as required .",
    "a similar argument applies for @xmath307 and @xmath594 . note that by construction each cluster contains at most @xmath600 of the vertices @xmath610 .",
    "next we sequentially define shifted walks @xmath611 with respect to @xmath340 and @xmath84 from @xmath594 to @xmath612 for @xmath613 .",
    "we want each @xmath611 to traverse at most @xmath614 cycles and each cluster to be internally used at most @xmath615 times by the collection of all the walks @xmath611 . to see that this is possible , suppose we are about to find @xmath611 and let @xmath60 be the set of clusters internally used at least @xmath616 times by the walks @xmath617 with @xmath608 .",
    "since each of our walks internally uses at most @xmath618 clusters ( although it visits many more ) we have @xmath619 ( since @xmath620 ) . now lemma  [ disjointpaths ] implies that we can find a shifted walk @xmath611 from @xmath594 to @xmath612 that traverses at most @xmath614 cycles and does not internally use any cluster in @xmath60 .",
    "we may assume that @xmath611 uses each cluster at most once as an entrance and at most once as an exit , and then no cluster is internally used more than @xmath621 times by the collection of all the walks @xmath617 for all @xmath622 , as required .",
    "we conclude this step by choosing a shifted walk @xmath623 from @xmath624 to @xmath625 .",
    "since there may be clusters in @xmath340 that we have not yet used , we construct this walk as a sequence of at most @xmath92 shifted walks each traversing at most @xmath614 cycles , in such a way that every cluster is used at least once by @xmath623 .",
    "this leads us to define a closed walk @xmath301 with vertex set @xmath626 as follows .",
    "let @xmath627 be the walk from @xmath594 to @xmath628 which is obtained from @xmath611 by adding the path from @xmath612 to @xmath628 in  @xmath84 .",
    "we now define @xmath629 using the choice of the clusters @xmath319 and @xmath594 it is easy to see that @xmath301 uses every cluster of  @xmath340 at most @xmath630 times .",
    "thus @xmath301 has the properties mentioned in the overview , namely :    * for each cycle @xmath75 of @xmath84 , @xmath301 visits every vertex of @xmath75 the same number of times ; * @xmath301 visits every cluster of @xmath340 at least once and uses every cluster of @xmath340 at most @xmath631 times ; * @xmath301 visits every vertex of @xmath187 exactly once ; * for each @xmath304 we have chosen an inneighbour @xmath305 in the cluster @xmath319 preceding @xmath306 on @xmath301 and an outneighbour @xmath307 in the cluster @xmath594 following @xmath306 on @xmath301 , so that as @xmath306 ranges over @xmath187 all the vertices @xmath307 , @xmath305 are distinct .",
    "now we fix edges in @xmath1 corresponding to all edges of @xmath301 that do not lie within a cycle of @xmath84 .",
    "we have already fixed the edges incident to vertices of @xmath187 ( properties ( c ) and ( d ) ) .",
    "then we note that the remaining edges of @xmath301 not in @xmath632 are precisely those of the form @xmath633 where @xmath60 is used as an exit by @xmath301 and @xmath64 is used as an entrance by @xmath301 . to see this , note that we can not have @xmath634 , as then @xmath64 would be used twice as an entrance in one of the shifted walks constructed above , which is contrary to our assumption .",
    "next we proceed through the clusters @xmath521 sequentially choosing edges as follows .",
    "when we come to @xmath201 , we consider each @xmath608 in turn .",
    "if @xmath635 we let @xmath636 be the number of times that @xmath301 uses @xmath190 .",
    "similarly , if @xmath637 we let @xmath638 be the number of times that @xmath301 uses @xmath639 .",
    "we aim to choose a matching in @xmath1 that avoids all previously chosen vertices and uses @xmath636 edges from @xmath640 to @xmath641 and @xmath638 edges from @xmath641 to @xmath640 .",
    "this can be achieved greedily as follows .",
    "suppose for example that @xmath642 and that when we come to @xmath564 the available vertices are @xmath643 and @xmath644 . since every cluster is used at most @xmath631 times we have @xmath645 , and we have @xmath646 ( say , taking account of at most @xmath631 uses , @xmath600 vertices @xmath610 and @xmath647 vertices in @xmath648 or @xmath649 ) . then @xmath650 induces a @xmath651-regular pair , so by lemma  [ regmatch ] has a matching of size at least @xmath652 .",
    "the same argument can be used if we also have @xmath653 . after considering all such pairs @xmath654 we have found edges in @xmath1 corresponding to all edges of @xmath301 that do not lie within a cycle of @xmath84 .",
    "now let @xmath655 denote the set of all those vertices which do not lie in the exceptional set and which are the final vertex of an edge of @xmath1 that we have fixed ( i.e.  the edges incident to the vertices in @xmath187 and the edges chosen in the previous paragraph ) . similarly , let @xmath656 denote the set of all those vertices which do not lie in the exceptional set and which are the initial vertex of an edge of @xmath1 that we have fixed .",
    "note that @xmath657 .    for every cluster @xmath658 ,",
    "let @xmath659 and @xmath660 .",
    "since @xmath301 was built up by shifted walks , it follows that @xmath661 .",
    "moreover , since we chose @xmath655 and @xmath656 to avoid @xmath662 , we know that @xmath663 is @xmath584-super - regular , so contains a perfect matching by lemma  [ regmatch ] . now the edges of these perfect matchings together with the edges of @xmath301 that we fixed in the previous step form a @xmath134-factor @xmath664 of @xmath1 .",
    "it remains to modify @xmath664 into a hamilton cycle of @xmath1 .",
    "the following statement provides us with the tool we need . for any cluster @xmath658 ,",
    "let @xmath665 and let old@xmath666 be the perfect matching in  @xmath667 which is contained in @xmath664 .    for any cluster @xmath658 , we can find a perfect matching new@xmath666 in @xmath667 so that if we replace old@xmath666 in @xmath664 with new@xmath666 , then all vertices of @xmath667 will lie on a common cycle in the new @xmath134-factor  @xmath664 .",
    "in particular , all vertices in @xmath668 will lie on a common cycle @xmath669 in  @xmath664 and moreover any pair of vertices of @xmath1 that were formerly on a common cycle are still on a common cycle after we replace old@xmath666 by new@xmath666 . &",
    "( )    to prove this statement we proceed as follows . for every @xmath670 , we move along the cycle @xmath671 of @xmath664 containing @xmath434 ( starting at @xmath434 ) and let @xmath672 be the first vertex on @xmath671 in @xmath673 .",
    "define an auxiliary digraph @xmath131 on @xmath674 such that @xmath675 .",
    "so @xmath131 is obtained by identifying each pair @xmath676 into one vertex with an edge from @xmath676 to @xmath677 if @xmath667 has an edge from @xmath672 to @xmath414 .",
    "now @xmath667 is @xmath584-super - regular by the definition of the sets @xmath662 , so @xmath131 is also @xmath584-super - regular ( according to the definition for non - bipartite digraphs ) . by lemma  [ fk ] , @xmath131 has a hamilton cycle , which clearly corresponds to a perfect matching new@xmath666 in  @xmath174 with the desired property .",
    "now we apply ( @xmath678 ) to every cluster @xmath658 sequentially .",
    "we continue to denote the resulting @xmath134-factor by @xmath664 and we write @xmath669 for the cycle that now contains all vertices in @xmath668 .",
    "since @xmath679 and @xmath680 have size at most @xmath681 ( say ) for any @xmath658 , we have @xmath682 , so @xmath683 . then @xmath684 , and since @xmath685 , we deduce that @xmath669 actually contains all vertices of @xmath658 .",
    "then @xmath686 implies that @xmath669 contains all vertices lying in clusters belonging to the cycle of @xmath84 containing @xmath658 .",
    "we now claim that @xmath664 is in fact a hamilton cycle . for this , recall that @xmath623 used every cluster .",
    "write @xmath687 , where each cluster appears at least once in @xmath688 .",
    "let @xmath689 be the edge that we have chosen for the edge @xmath690 on  @xmath623 .",
    "note that for each @xmath691 the vertices @xmath692 and @xmath693 lie on a common cycle of  @xmath664 , as this holds by construction of @xmath664 , whatever matchings we use to create @xmath664 .",
    "since @xmath694 also lie on a common cycle , this means that all of @xmath695 ( and thus also @xmath696 ) lie on the same cycle @xmath75 of  @xmath664 , which completes the proof .",
    "having illustrated our techniques in the case when @xmath198 is strongly @xmath562-connected , we now turn to the case when this does not hold . in this section",
    "we impose further structure on @xmath1 by introducing ` shifted components ' of @xmath198 and various matchings linking these components and the vertices of the exceptional set  @xmath187 . in the first subsection",
    "we construct the shifted components .",
    "we describe some of their properties in the second subsection .",
    "the third subsection describes a process by which our shifted walk @xmath301 will make transitions between the shifted components . in the fourth subsection we partition @xmath187 into @xmath697 parts according to the existence of certain matchings between @xmath187 and the remainder of the digraph .",
    "then we complete the description of the transitions in the fifth subsection . since we need to introduce a large amount of notation in this section , we conclude with a summary of the important points .",
    "we recall that @xmath698 and @xmath699 .",
    "note that the in- and outdegrees of @xmath198 are obtained by permuting those of @xmath340 , so @xmath198 has the same in- and outdegree sequences as @xmath340 , and the bounds in lemma  [ degree sequence of r_g - modified ] also apply to @xmath198 .",
    "we start by establishing an expansion property for subsets of @xmath700 .",
    "[ boundexpand ] if @xmath701 with @xmath702 then @xmath703    the argument is similar to that for lemma  [ outexpansion of r_g ] . by symmetry",
    "it suffices to obtain the bound for @xmath704 .",
    "suppose for a contradiction that @xmath705 . by lemma  [ degree sequence of r_g - modified](iii )",
    "we have @xmath706 .",
    "also @xmath707 , so by lemma  [ degree sequence of r_g - modified](v ) we have @xmath708",
    ". then @xmath198 contains at least @xmath709 vertices of indegree at least @xmath710 , and these all belong to @xmath711 , a contradiction .",
    "we are assuming that @xmath198 is not strongly @xmath562-connected , so we can choose a separator @xmath57 of @xmath198 of size @xmath712 .",
    "thus we have a partition of the vertices of @xmath198 into sets @xmath57 , @xmath75 , and @xmath127 such that @xmath713 does not contain an edge from @xmath75 to @xmath127 ( although it might contain edges from @xmath127 to @xmath75 ) .",
    "[ cdsize ] @xmath714    suppose for a contradiction that @xmath715 .",
    "if the stronger inequality @xmath716 holds then lemma  [ boundexpand ] implies that @xmath717 , a contradiction .",
    "so we may assume that @xmath718 .",
    "let @xmath719 be a subset of @xmath127 of size @xmath720 .",
    "now the first inequality of lemma  [ boundexpand ] implies that @xmath721 a contradiction .",
    "the bound @xmath722 is obtained in a similar way , which proves the lemma .",
    "let @xmath723 be the set of vertices in @xmath75 which ( in the digraph @xmath198 ) have at most @xmath724 inneighbours in @xmath75 .",
    "let @xmath725 be the set of vertices in @xmath127 which ( in the digraph @xmath198 ) have at most @xmath724 outneighbours in @xmath127 .",
    "[ small ] @xmath726 .",
    "let @xmath727 be the set of vertices in @xmath75 which have at least @xmath728 outneighbours in @xmath198 .",
    "we claim that @xmath729 .",
    "to see this , first note that lemma  [ cdsize ] and the fact that there are no edges from @xmath75 to @xmath127 imply that @xmath127 contains no vertex of indegree greater than @xmath730 .",
    "so again by lemma  [ cdsize ] , the number of vertices of indegree greater than @xmath731 in @xmath198 is at most @xmath731 , which gives @xmath732 .",
    "now lemma  [ degree sequence of r_g - modified](v ) with @xmath733 says that @xmath734 or @xmath735 .",
    "the latter option can not hold , as it would contradict our previous inequality for @xmath736 , so the former option holds , and @xmath198 has at least @xmath737 vertices of outdegree at least @xmath738 . by lemma  [ cdsize ] , @xmath75 has to contain at least @xmath739 of these vertices of high outdegree , which proves the claim .    now note that yet another application of lemma  [ cdsize ] shows that every vertex in @xmath727 has at least @xmath740 outneighbours in @xmath741 $ ] .",
    "suppose that @xmath742 .",
    "then every vertex in @xmath727 has more than half of the vertices of @xmath723 as outneighbours .",
    "this in turn implies that there is a vertex in @xmath723 with more than half the vertices in @xmath727 as inneighbours .",
    "in particular , it has more than @xmath724 inneighbours in @xmath75 .",
    "this contradicts the definition of @xmath723 , so in fact @xmath743 .",
    "the argument for @xmath725 is similar .",
    "let @xmath744 and @xmath745 .",
    "[ cdconnectivity ] @xmath746 $ ] and @xmath747 $ ] are strongly @xmath748-connected .    by symmetry",
    "it suffices to consider @xmath746 $ ] .",
    "the definition of @xmath723 and lemma  [ small ] give @xmath749 )   { \\geqslant}\\beta k/10-|c_{\\rm small}| { \\geqslant}\\beta k/11 $ ] .",
    "suppose that @xmath746 $ ] is not strongly @xmath748-connected .",
    "then there is a separator @xmath392 of size at most @xmath748 and a partition @xmath658 , @xmath301 of @xmath750 such that @xmath746{\\setminus}t$ ] contains no edge from @xmath658 to @xmath301 .",
    "note that @xmath751)-|t| { \\geqslant}\\beta k/12 $ ] .",
    "so @xmath752 holds then lemma  [ boundexpand ] implies that @xmath753 , a contradiction .",
    "so we may assume that @xmath754 .",
    "let @xmath755 be a subset of @xmath658 of size @xmath720 .",
    "now the first inequality in lemma  [ boundexpand ] implies that @xmath756 a contradiction again .",
    "let @xmath757 be the set obtained from @xmath57 by adding @xmath723 and @xmath725 .",
    "so @xmath758 and @xmath757 , @xmath759 , @xmath719 is a vertex partition of @xmath198 .",
    "now let @xmath760 ( for ` left ' ) be the set obtained from @xmath759 by adding all those vertices @xmath414 from @xmath757 which satisfy @xmath761 and @xmath762 .",
    "next , let @xmath197 ( for ` right ' ) be the set obtained from @xmath719 by adding all those remaining vertices @xmath414 from @xmath757 which satisfy @xmath763 and @xmath764",
    ". then @xmath765 $ ] and @xmath766 $ ] are both still @xmath748-connected .",
    "we write @xmath767 ( for ` vertical middle ' ) for the remaining vertices in @xmath757 ( i.e.  those which were not added to @xmath759 or @xmath719 )",
    ". then @xmath768 .",
    "moreover , @xmath760 , @xmath767 and @xmath197 partition the vertex set of @xmath340 .",
    "we also define another partition of @xmath769 into three sets which we call @xmath770 and @xmath64 ( for ` top ' , ` horizontal middle ' , and ` bottom ' ) as follows :    * a cluster belongs to @xmath392 if and only if its successor in @xmath84 belongs to @xmath760 ; * a cluster belongs to @xmath771 if and only if its successor in @xmath84 belongs to @xmath767 ; * a cluster belongs to @xmath64 if and only if its successor in @xmath84 belongs to @xmath197 .",
    "the general picture ( including a partition of @xmath187 defined below ) is illustrated in figure  1 .",
    "for each of the above subsets of @xmath772 we use a ` tilde ' notation to denote the subset of @xmath168 consisting of the union of the corresponding clusters , thus @xmath773 , etc .",
    "note that @xmath774     we need to remove certain cycles from @xmath84 that would create difficulties later on .",
    "let @xmath775 .",
    "we say that a cycle @xmath75 of @xmath84 _ significantly intersects @xmath171 _ if @xmath776 .",
    "if we have @xmath777 then we remove all cycles that significantly intersect @xmath171 from @xmath84 and add all vertices in their clusters to the exceptional set .",
    "since @xmath778 we still have the inequality @xmath779 .",
    ". moreover , no cycle of @xmath84 significantly intersects @xmath171 . *",
    "@xmath780 .",
    "( the proof would be considerably simpler if we could remove all the cycles which significantly intersect / lie in @xmath171 in the case ( @xmath781 ) , but this would make @xmath782 too large . )",
    "since any cycle in @xmath84 has equal intersection sizes with @xmath771 and @xmath767 we still have @xmath783 of size at most @xmath784 . we still denote the remaining subset of @xmath197 by @xmath197 , and similarly for all the other sets @xmath785 etc .",
    "we start by justifying the name ` shifted components ' .",
    "the following lemma shows that we have decomposed most of the digraph into two pieces of roughly equal size , where in each piece we have the high connectivity that enabled us to establish the result in the previous section .",
    "[ proprl ] @xmath352    1 .",
    "@xmath765 $ ] and @xmath766 $ ] are strongly @xmath786-connected .",
    "2 .   @xmath787 .    to prove ( i ) , recall that before the removal of the cycles we knew that @xmath765 $ ] and @xmath766 $ ] were strongly @xmath748-connected . by  ( [ boundv0 ] ) ,",
    "the number of clusters removed in case ( @xmath788 ) is at most @xmath789 .",
    "since we only removed entire @xmath84-cycles , we did not delete any edges from @xmath198 other than those incident to the clusters that were deleted .",
    "thus for each cluster removed the connectivity only decreases by at most one .    for (",
    "ii ) , we recall that @xmath790 ( lemma  [ cdsize ] ) and @xmath760 was obtained from @xmath75 by removing @xmath743 clusters , adding at most @xmath791 clusters and removing at most @xmath792 clusters . the argument for @xmath197 is the same .",
    "the other two bounds follow since @xmath793 and @xmath794 .",
    "next we define a partition of @xmath767 into @xmath795 and @xmath796 as follows .",
    "a cluster @xmath797 belongs to @xmath795 if @xmath798 and @xmath799 .",
    "a cluster @xmath797 belongs to @xmath796 if @xmath800 and @xmath801 .",
    "the definition of @xmath760 and @xmath197 and the fact that @xmath198 has minimum semidegree at least @xmath802 imply that this is indeed a partition of @xmath767 . since @xmath803 and @xmath804 we have the following properties .",
    "[ lrandrlmiddle ] @xmath352    * all @xmath805 satisfy @xmath806 and @xmath807 . *",
    "all @xmath808 satisfy @xmath809 and @xmath810 .",
    "let @xmath811 the set of clusters whose successor in @xmath84 belongs to @xmath795 and define @xmath812 similarly .",
    "note that this yields a partition of @xmath771 .",
    "it will be helpful later to note that if @xmath813 then we can use clusters in @xmath795 to obtain shifted walks from @xmath760 to @xmath197 .",
    "similarly , any clusters in @xmath796 can be used to obtain shifted walks from @xmath197 to @xmath760 .",
    "this will use the following lemma .",
    "[ middleedges ] @xmath814    1 .   for all @xmath815",
    ", we have @xmath816 and @xmath817 . also , at most @xmath818 vertices in @xmath819 have more than @xmath820 inneighbours in @xmath821 .",
    "2 .   for all @xmath822",
    ", we have @xmath823 and @xmath824 .",
    "also , at most @xmath818 vertices in @xmath825 have more than @xmath826 outneighbours in @xmath827 .",
    "3 .   for all @xmath828",
    ", we have @xmath829 and @xmath830 . also , at most @xmath818 vertices in @xmath831 have more than @xmath832 inneighbours in @xmath833 .",
    "4 .   for all @xmath834 , we have @xmath835 and @xmath836 . also , at most @xmath818 vertices in @xmath837 have more than @xmath838 outneighbours in @xmath839 .    for ( i ) , suppose @xmath815 satisfies @xmath840 .",
    "note that lemma  [ degree sequence of r_g - modified ] implies that @xmath41 is typical .",
    "using the definition of ` typical ' and accounting for vertices added to @xmath187 we still have @xmath841 . then the cluster @xmath658 containing @xmath41 must have ( in @xmath340 ) at least @xmath842 outneighbours in @xmath760 .",
    "the definition of @xmath811 implies that the successor @xmath843 of @xmath658 lies in @xmath795 .",
    "then @xmath844 , contradicting lemma  [ lrandrlmiddle](i ) .",
    "we deduce that @xmath816 .",
    "it follows that there are at most @xmath845 edges from @xmath846 to @xmath819 , so the final assertion of ( i ) holds . for the second bound in ( i ) , we note that @xmath847 for ( ii ) , suppose @xmath822 satisfies @xmath848 .",
    "then the cluster @xmath849 containing @xmath41 must have ( in @xmath340 ) at least @xmath842 inneighbours in @xmath64 .",
    "thus in @xmath198 it has at least @xmath842 inneighbours in @xmath197 , contradicting lemma  [ lrandrlmiddle](i ) .",
    "the remainder of ( ii ) follows as for ( i ) .",
    "the proof of ( iii ) is very similar to that of ( i ) and the proof of ( iv ) to that of ( ii ) .    if @xmath123 and @xmath241 are clusters in @xmath760 , then there are many shifted walks ( with respect to  @xmath340 and",
    "@xmath84 ) from @xmath123 to @xmath241 .",
    "later we will need that paths corresponding to such walks can be found in @xmath1 , even if a large number of vertices in clusters lying on these paths have already been used for other purposes .",
    "this will follow from the following lemma .",
    "[ twinnbs ] suppose @xmath658 is a cluster , @xmath850 and write @xmath851 .    * if @xmath852 then there are clusters @xmath853 such that @xmath854 and @xmath434 has at least @xmath855 inneighbours in @xmath201 for @xmath856 .",
    "* if @xmath857 then there are clusters @xmath858 such that @xmath859 and @xmath434 has at least @xmath855 outneighbours in @xmath201 for @xmath856 . * if @xmath860 then there are clusters @xmath861 such that @xmath854 and @xmath434 has at least @xmath855 inneighbours in @xmath201 for @xmath856 .",
    "* if @xmath862 then there are clusters @xmath863 such that @xmath859 and @xmath434 has at least @xmath855 outneighbours in @xmath201 for @xmath856 .    to prove",
    "( i ) recall from lemma  [ proprl ] that @xmath766 $ ] is strongly @xmath786-connected , and so has minimum indegree at least @xmath786 .",
    "thus any @xmath864 has inneighbours @xmath865 in @xmath340 such that @xmath866 .",
    "this also holds for @xmath867 by lemma  [ lrandrlmiddle](ii ) , since @xmath868 . in both cases",
    "we remove all the  @xmath201 for which @xmath434 does not have at least @xmath855 inneighbours in @xmath201 .",
    "then , since @xmath434 is typical ( this was defined before lemma  [ degree sequence of r_g - modified ] ) , we are left with @xmath869 clusters where @xmath434 has at least @xmath855 inneighbours .",
    "statements  ( ii)(iv ) are proved similarly .",
    "as in the highly connected case , our general strategy is to find a suitable shifted walk @xmath301 and transform it into a hamilton cycle . we will be able to move easily within @xmath819 , and also within @xmath831 , using the same arguments as in the highly connected case .",
    "however , we need other methods to move between @xmath819 and @xmath831 , which we will now discuss . to avoid excessive notation",
    "we will just describe how to move from @xmath831 to @xmath819 , as our arguments will be symmetric under the exchange @xmath870 ( and so @xmath871 ) . to move from @xmath831 to @xmath819",
    "we use two types of ` transitions ' from @xmath825 to @xmath819 .",
    "the first of these is a set of edges @xmath872 from @xmath825 to @xmath819 , which will ` almost ' be a matching , and will have certain desirable properties defined as follows .    given matchings @xmath873 and @xmath874 in @xmath1 from @xmath825 to @xmath819 , we call a cluster @xmath207 _ full _ ( with respect to  @xmath875 ) if it contains at least @xmath876 endvertices of edges in @xmath875 .",
    "given a number @xmath79 , we say @xmath207 is _ @xmath79-fair _ ( with respect to  @xmath875 ) if no cluster with distance at most  @xmath79 from  @xmath207 in  @xmath84 is full .",
    "a cluster @xmath207 is _",
    "@xmath79-excellent _ if it is @xmath79-fair and no cluster with distance at most  @xmath79 from  @xmath207 in  @xmath84 lies in  @xmath877 ( the ` middle ' ) .",
    "we call @xmath875 a _ pseudo - matching from @xmath825 to @xmath819 _ if the following properties are satisfied :    * @xmath875 is a vertex - disjoint union of ` components ' , each of which is either a single edge or a directed path of length 2 . *",
    "every single edge component has at least one endvertex in a @xmath697-excellent cluster , and every directed path of length 2 has both endvertices in @xmath697-excellent clusters .    given matchings @xmath873 and @xmath874 from @xmath837 to @xmath831 , we say that @xmath875 is a _ pseudo - matching from  @xmath837 to  @xmath831 _ if it satisfies the analogous properties .",
    "as we shall see later , each edge of a pseudo - matching from @xmath825 to @xmath819 allows us to move from @xmath831 to @xmath819 .",
    "note that this applies even to the two edges in any directed paths of length 2 : these will enable us to move twice from @xmath831 to @xmath819 , using the rerouting procedure described later .",
    "similarly , each edge of a pseudo - matching from @xmath837 to @xmath831 allows us to move from @xmath819 to @xmath831 .",
    "we consider pseudo - matchings rather than matchings because in general @xmath878 , so the largest matching we can guarantee is only half as large as the largest pseudo - matching .",
    "this would not provide all the edges we need to move from @xmath831 to @xmath819 .",
    "we now choose pseudo - matchings @xmath872 from @xmath825 to @xmath819 and @xmath879 from @xmath837 to @xmath831 , each of which is maximal subject to the condition    * @xmath880 .",
    "( here @xmath881 denotes the number of edges in  @xmath872 . ) note that @xmath872 and @xmath879 may have common vertices . recalling that @xmath882 by  ( [ eq : middle ] ) , at most @xmath883 clusters",
    "are full with respect to  @xmath872 , and at most @xmath884 clusters are not @xmath885-excellent with respect to  @xmath872 .",
    "a similar statement holds for  @xmath879 . &",
    "( )    from now on , whenever we refer to a fair or excellent cluster it will be with respect to the pseudomatching @xmath872 .",
    "as in the highly connected case , we will identify ` entries ' and ` exits ' for edges of the cycle that do not lie in a pair corresponding to an edge of @xmath84 . for @xmath872 ,",
    "the _ exits _ is the set @xmath886 of all initial vertices of edges in  @xmath872 , and the _ entries _ is the set @xmath887 of all final vertices of edges in  @xmath872 .",
    "( we will define further exits and entries in due course . )    at this stage , we do not know how many of the matching edges we actually will need in @xmath301 , as this depends on a partition of the exceptional set @xmath187 to be defined in the next subsection .",
    "so , given a cluster @xmath207 , we want to ensure if e.g.  we only use some of the vertices in @xmath888 , then the unused remainder of @xmath207 and @xmath889 still forms a super - regular pair",
    ". we may not be able to achieve this for any @xmath207 , but if @xmath207 is @xmath17-fair , we know that none of @xmath890 , @xmath207 , @xmath889 is full , which gives us the flexibility we need .",
    "we say that a cluster @xmath207 is _",
    "nearly @xmath17-fair _ if @xmath207 is either @xmath17-fair or at distance 1 on @xmath84 from a @xmath17-fair cluster . in the following lemma",
    "we choose partitions of the nearly @xmath17-fair clusters which allow us to avoid any ` interference ' between exits / entries and the exceptional set .",
    "figure  2 illustrates these partitions , and also some additional sets that will be defined in subsection  [ twins ] ( ` twins ' of exits / entries and an ideal to preserve super - regularity ) .",
    "[ fig : split ] .,title=\"fig : \" ]    we define our partitions of the nearly @xmath17-fair clusters as follows . for every @xmath17-fair cluster @xmath207 with @xmath891",
    "we will choose a partition @xmath892 of @xmath207 and a partition @xmath893 of @xmath889 . also , for every @xmath17-fair cluster @xmath207 with @xmath894 we choose a partition @xmath895 of @xmath207 and a partition @xmath896 of @xmath890 .",
    "there is no conflict in our notation , i.e.  we will not e.g.  define @xmath897 twice , since when @xmath891 we must have @xmath898 , whereas when @xmath899 we must have @xmath900 , so @xmath901 , and these can not occur simultaneously . we also define the analogous partitions with respect to @xmath879 , although for simplicity we will not explicitly introduce notation for them , as we will mainly focus on the case when only @xmath872 is needed for the argument .",
    "so for each cluster @xmath207 we will choose at most  @xmath697 partitions .",
    "we let @xmath902 be the intersection of all the second parts of the at most 4 partitions defined for  @xmath207 .",
    "( so if all 4 partitions are defined , then @xmath903 is the intersection of the sets @xmath904 defined with respect to @xmath872 and the 2 analogous sets defined with respect to @xmath879 . if only 3 partitions are defined for @xmath207 , then @xmath903 is the intersection of only  3 sets etc . if no partition is defined for @xmath207 , then @xmath905 . )",
    "we let @xmath906 be the union of @xmath903 over all clusters  @xmath207 .",
    "we choose these partitions to satisfy the following lemma .",
    "[ split ] the partitions @xmath907 and @xmath908 can be chosen with the following properties ( when they are defined ) .    *",
    "@xmath909 , @xmath910 . * for any @xmath17-fair cluster @xmath207 with @xmath891 we have @xmath911 .",
    "moreover , there is a set @xmath912 of size at most @xmath913 such that : * * each vertex in @xmath914 has at least @xmath915 inneighbours in @xmath916 .",
    "* * each vertex in @xmath917 has at least @xmath918 inneighbours in @xmath897 . * * each vertex in @xmath207 has at least @xmath919 outneighbours in @xmath920 .",
    "* for any @xmath17-fair cluster @xmath207 with @xmath894 we have @xmath921 .",
    "moreover , there is a set @xmath922 of size at most @xmath913 such that : * * each vertex in @xmath923 has at least @xmath915 outneighbours in @xmath924 .",
    "* * each vertex in @xmath925 has at least @xmath918 outneighbours in @xmath926 .",
    "* * each vertex in @xmath207 has at least @xmath919 inneighbours in @xmath927 .",
    "also , the analogues of statements ( i)(iii ) for @xmath879 hold .",
    "moreover ,    * every vertex in  @xmath187 has at least @xmath928 inneighbours and at least @xmath928 outneighbours in @xmath906 . * if @xmath929 then there are sets @xmath930 and @xmath931 such that @xmath932 and such that every vertex in @xmath933 has outdegree at least @xmath11 in  @xmath1 . *",
    "if @xmath934 then there are sets @xmath935 and @xmath936 such that @xmath937 and such that every vertex in @xmath938 has indegree at least @xmath11 in  @xmath1 .    consider a @xmath17-fair cluster @xmath207 with @xmath891 . if @xmath939 we set @xmath940 . otherwise , if @xmath941 we define @xmath917 to be the set of vertices in @xmath889 that have less than @xmath942 inneighbours in @xmath943 .",
    "recall that @xmath944 is @xmath561-super - regular . since @xmath207 is @xmath17-fair",
    "we deduce that @xmath945 .",
    "now consider constructing a partition of @xmath207 into @xmath897 and @xmath946 as follows",
    ". include @xmath947 into @xmath897 and distribute the remaining vertices of @xmath207 between @xmath897 and @xmath946 so that @xmath909 ( recall that @xmath294 is even ) , choosing uniformly at random between all possibilities .",
    "note that since @xmath207 is @xmath17-fair the probability that a vertex of @xmath948 is included in @xmath897 is at least @xmath949",
    ". then by the chernoff bound for the hypergeometric distribution ( proposition  [ chernoff ] ) , with high probability each vertex in @xmath914 has at least @xmath950 inneighbours in @xmath916 .",
    "also , by definition of @xmath951 and super - regularity , each vertex in @xmath917 has at least @xmath952 inneighbours in @xmath897 .",
    "next , consider similarly constructing a partition of @xmath889 into @xmath953 and @xmath954 as follows",
    ". include @xmath951 into @xmath953 and distribute the remaining vertices of @xmath889 uniformly at random between @xmath953 and @xmath954 so that @xmath955 .",
    "note that any vertex in @xmath207 has outdegree at least @xmath956 in @xmath957 .",
    "again , the probability that a given vertex from @xmath957 is included in @xmath953 is at least @xmath949 , so with high probability each vertex in @xmath207 has at least @xmath958 outneighbours in @xmath920 .",
    "this shows the existence of the partitions required for ( ii ) .",
    "the existence of partitions satisfying ( iii ) is proven in the same way .    for each vertex @xmath414 in a cluster @xmath207 which does not lie in @xmath959 or the analogous set defined with respect to @xmath879 ,",
    "the probability that it lies in the second part of each of the ( up to ) 4 partitions defined on @xmath207 ( and thus lies in @xmath906 ) is at least @xmath960 . since @xmath961 , a chernoff bound ( proposition  [ chernoff ] ) implies that we can also choose the partitions to satisfy ( iv ) .",
    "now suppose that @xmath929 .",
    "then @xmath1 contains at least @xmath962 vertices of outdegree at least @xmath11 .",
    "so lemma  [ proprl](ii ) implies that @xmath825 contains a set @xmath963 of at least @xmath964 vertices whose outdegree in @xmath1 is at least @xmath11 .",
    "@xmath963 in turn contains a set @xmath965 of at least @xmath966 vertices which do not lie in @xmath959 ( for any cluster  @xmath207 ) or in the analogous set defined with respect to @xmath879 .",
    "similarly as for ( iv ) , with high probability we have @xmath967 .",
    "similar arguments applied to @xmath837 , @xmath819 and @xmath831 show that we can choose the partitions to satisfy ( v ) and ( vi ) .",
    "next we will assign each vertex @xmath41 in the exceptional set @xmath187 an _ in - type _ which is one of @xmath392 or @xmath64 and an _ out - type _ which is one of @xmath760 or @xmath197 .",
    "combining these two types together we will say each vertex of @xmath187 gets a type of the form @xmath968 or @xmath969 .",
    "we will also abuse notion and think of @xmath970 as the set of all vertices of @xmath187 of in - type @xmath392 and out - type @xmath760 , etc .",
    "we write @xmath971 for the set of all those vertices which belong to the set @xmath906 defined in the previous subsection as well as to clusters of @xmath392 which are @xmath885-excellent with respect to both @xmath872 and  @xmath879 .",
    "the other sets @xmath972 etc .  are defined similarly .",
    "[ excvs ] we can assign each vertex @xmath973 an in- and an out - type such that the following conditions are satisfied .",
    "* there is a matching @xmath974 from @xmath971 to the set of vertices of in - type @xmath392 .",
    "* there is a matching @xmath975 from @xmath972 to the set of vertices of in - type @xmath64 .",
    "* there is a matching @xmath976 from the set of vertices of out - type @xmath760 to @xmath977 .",
    "* there is a matching @xmath978 from the set of vertices of out - type @xmath197 to @xmath979 . *",
    "the endvertices of the matchings @xmath974 , @xmath975 , @xmath976 , @xmath978 in @xmath980 are all distinct .",
    "let @xmath981 denote the set of all these endvertices . *",
    "no cluster of @xmath293 contains more than @xmath876 vertices of @xmath982 . *",
    "subject to the above conditions , @xmath983 is minimal .    to show that such a choice is possible",
    ", we claim that we can proceed sequentially through the vertices of @xmath187 , assigning in - types and out - types and greedily extending the appropriate matchings .",
    "since @xmath984 by  ( [ boundv0 ] ) , at any stage in this process we have constructed at most @xmath985 edges of the matchings @xmath974 , @xmath975 , @xmath976 , @xmath978 , and so there are at most @xmath986 vertices belonging to clusters which contain at least @xmath876 endpoints of the matchings .",
    "in addition , we have to avoid all the at most @xmath987 vertices lying in clusters which are not @xmath885-excellent with respect to both @xmath872 and @xmath879 .",
    "so in total we have to avoid at most @xmath988 vertices in each step .",
    "but by lemma  [ split](iv ) each exceptional vertex has in- and outdegree at least @xmath928 in  @xmath906 , so lemma  [ proprl](ii ) implies that any vertex has at least @xmath989 inneighbours in @xmath990 or at least @xmath989 inneighbours in @xmath991 .",
    "a similar statement holds for outneighbours in @xmath992 or @xmath993 , thus a greedy procedure can satisfy conditions ( i)(vi ) , and then we can choose an assignment to satisfy  ( vii ) .    note",
    "that one advantage of choosing @xmath982 in @xmath906 is that @xmath982 will be disjoint from the sets @xmath994 etc .",
    "the strategy of the remaining proof depends on the value of @xmath995 .",
    "we will only consider the case @xmath996 , as the argument for @xmath997 is identical , under the symmetry @xmath998 , @xmath999 .",
    "when @xmath1000 only @xmath872 is needed for the argument .",
    "when @xmath1001 we do not need either pseudo - matching , although the case @xmath1002 has additional complications .      when @xmath1000 , we obtain one type of transitions from @xmath825 to @xmath819 by fixing a pseudo - matching @xmath1003 .",
    "the other type of transitions uses a set @xmath1004 , as explained below .",
    "we define exits @xmath1005 and entries @xmath1006 of @xmath1007 as for @xmath872 .",
    "lemma  [ mbl2cor](i ) below implies that @xmath1008 thus we can fix sets @xmath1007 and @xmath1009 to satisfy @xmath1010    for each edge @xmath1011 we will choose ` twins ' @xmath1012 and @xmath1013 of its endpoints . to use the edge @xmath43 in our shifted walk @xmath301 , we will enter the cycle of @xmath84 containing @xmath41 at @xmath1012 , wind around the cycle to @xmath41 , use the edge @xmath43 , wind around the cycle containing @xmath42 , and then leave it at @xmath1013 .",
    "a vertex that is the midpoint of a directed path of length 2 in @xmath1007 will actually have two twins , but we will not complicate the notation to reflect this , as it will be clear from the context which twin is intended .",
    "thus we obtain two ` twin maps ' @xmath1014 and @xmath1015 .",
    "we also use the notation @xmath1016 when @xmath57 is a set of vertices .",
    "the twin maps will be injective on @xmath1017 and on @xmath994 , in that @xmath1018 , @xmath1019 , and moreover @xmath1020 , @xmath1021 .",
    "our choice of @xmath1012 depends on whether the cluster @xmath207 containing @xmath41 is @xmath17-fair with respect to @xmath872 .",
    "if @xmath207 is not @xmath17-fair then we fix arbitrary perfect matchings in @xmath174 from @xmath890 to @xmath207 and from @xmath207 to @xmath889 ( using lemma  [ regmatch ] ) .",
    "then for every @xmath1022 we let @xmath1012 be the vertex @xmath41 is matched to in @xmath889 and for every @xmath1023 we let @xmath1012 be the vertex in @xmath890 matched to @xmath41 .    on the other hand ,",
    "if @xmath207 is @xmath17-fair then we make use of the partitions defined in lemma  [ split ] .",
    "if @xmath1024 then we choose twins for vertices in @xmath1025 within @xmath1026 , arbitrarily subject to the condition that if @xmath1027 then @xmath1028 contains @xmath917 .",
    "( recall that @xmath981 was defined in lemma  [ excvs](v ) . )",
    "if @xmath207 is @xmath17-fair , we will also choose some ideal of @xmath1029 to create flexibility when selecting further sets while preserving super - regularity . to do this , recall that @xmath944 was @xmath561-super - regular .",
    "together with lemma  [ split](i),(ii ) this implies that @xmath1030 is @xmath1031-super - regular .",
    "next we randomly choose sets @xmath1032 and @xmath1033 of size @xmath1034 .",
    "lemma  [ ideal ] ( applied with @xmath1035 and @xmath1036 ) implies that with high probability @xmath1037 is an @xmath584-ideal for @xmath1030 .",
    "moreover , lemma  [ split](ii ) and the chernoff bound ( proposition  [ chernoff ] ) together imply that with high probability every vertex in @xmath946 has at least @xmath1038 outneighbours in @xmath1039 while every vertex in @xmath1040 has at least @xmath1038 inneighbours in @xmath1041 .",
    "altogether this shows that we can choose @xmath1037 to be a @xmath584-ideal for @xmath1029 .",
    "similarly , if @xmath1042 then we choose twins for vertices in @xmath1043 in @xmath1044 , arbitrarily subject to the condition that if @xmath1045 then @xmath1046 contains @xmath925 .",
    "we also choose a @xmath584-ideal @xmath1047 for @xmath1048 .",
    "then we define @xmath1049 to be the union of the sets @xmath1041 and @xmath1050 defined using @xmath1007 over all nearly 2-fair clusters  @xmath207 .",
    "note that these sets will play a similar role to the sets @xmath1051 used in the highly connected case , in that they preserve super - regularity even if when some vertices are deleted .",
    "we let @xmath1052 note that @xmath1053 .",
    "define @xmath1054 and @xmath1055 similarly using the matching @xmath1056 .",
    "we will also choose twins for vertices in @xmath1009 such that if @xmath1057 then @xmath1058 .",
    "lemma  [ middleedges](iii),(iv ) implies that each @xmath1059 has many inneighbours in  @xmath825 while  @xmath1012 has many outneighbours in  @xmath819 .",
    "writing @xmath75 for the cycle of @xmath84 containing the cluster containing @xmath41 , we get a transition from  @xmath825 to @xmath819 by entering @xmath75 at @xmath41 from an inneighbour in  @xmath825 , traversing @xmath75 , then exiting @xmath75 at @xmath1012 to an outneighbour in  @xmath819 .",
    "now we describe how to choose twins for @xmath1009 , and also some ideals to create flexibility while preserving super - regularity . call a cluster  @xmath207 _ @xmath1060-full _ if it contains at least @xmath876 vertices in @xmath1009 .",
    "say @xmath207 is _",
    "( with respect to @xmath872 and @xmath1009 ) if @xmath207 is @xmath79-fair with respect to  @xmath872 and no cluster with distance at most  @xmath79 from  @xmath207 on @xmath84 is @xmath1060-full . since @xmath1061 the number of @xmath1060-full clusters is at most @xmath1062",
    "recalling that by  ( @xmath1063 ) at most @xmath1064 clusters are full , at most @xmath1065 clusters are not @xmath697-good . &",
    "( )    consider a cluster @xmath1066 with @xmath1067 .",
    "if @xmath207 is not @xmath17-good then we choose a perfect matching in  @xmath174 from @xmath890 to @xmath207 ( using lemma  [ regmatch ] ) , and for each @xmath1068 let @xmath1012 be the vertex in @xmath890 that is matched to @xmath41 .",
    "now suppose that @xmath207 is @xmath17-good .",
    "then none of @xmath890 , @xmath207 and @xmath889 is full with respect to @xmath872 or @xmath1060-full .",
    "since @xmath1069 is @xmath561-super - regular and @xmath1070 we can apply lemma  [ tw ] to obtain a set @xmath1071 with @xmath1072 such that @xmath1073 is @xmath1074-super - regular .",
    "then we let the twin map be an arbitrary bijection from @xmath1075 to @xmath241 .",
    "next we apply lemma  [ ideal ] with @xmath1076 to obtain a @xmath584-ideal for @xmath1077 , which we will call @xmath1047 .",
    "( similarly to the earlier argument and the one in the next paragraph , the partitions of @xmath980 into @xmath819 , @xmath831 and @xmath1078 and into @xmath837 , @xmath825 and @xmath1079 guarantee that there is no conflict with our previous notation . )",
    "now we define @xmath1080 @xmath1081 then @xmath1082 and @xmath1083 .",
    "( the latter follows since the vertices in @xmath981 lie in 5-excellent clusters and so @xmath1084 . )",
    "we also define @xmath1085 @xmath1086 note that @xmath1087 , @xmath1088 and @xmath1004 . since @xmath819 , @xmath831 and @xmath1078 partition @xmath980 , any vertex will be used at most once to enter a cluster . in particular , @xmath1089 similarly , @xmath1090 , @xmath1091 and @xmath1092 . since @xmath837 , @xmath825 and @xmath1079 also partition @xmath980 , any vertex will be used at most once to exit a cluster and @xmath1093 some vertices may be used for both exits and entrances , and they will have two twins .",
    "we summarise the properties of twins with the following lemma .",
    "[ twinprops ] suppose that @xmath1000",
    ". then    * @xmath1094 .",
    "* every cluster intersects at most one of @xmath994 , @xmath1095 , @xmath1009 . similarly , every cluster intersects at most one of @xmath1017 , @xmath1096 , @xmath1097 .",
    "* there exists a perfect matching from @xmath1098 to @xmath1099 .",
    "* suppose @xmath207 is @xmath1100-good with respect to @xmath872 and @xmath1009 .",
    "then * * for all sets @xmath1101 and @xmath1102 with @xmath1103 and @xmath1104 the pair @xmath1105 is @xmath584-super - regular . * * for all sets @xmath1101 and @xmath1102 with @xmath1106 and @xmath1107 the pair @xmath1108 is @xmath584-super - regular .",
    "as discussed at the beginning of the subsection , lemma  [ mbl2cor](i ) will allow us to choose @xmath1007 and @xmath1009 of the size required in ( i ) .",
    "property ( ii ) was discussed above .",
    "we will just consider the first point of property ( iv ) , as the second is similar .",
    "suppose @xmath207 is @xmath1100-good and consider sets @xmath1101 and @xmath1102 as in the statement .",
    "we need to show that @xmath1105 is @xmath584-super - regular . if @xmath1109 this holds by definition of @xmath1110 since @xmath1111 and @xmath1112 by  ( ii ) ( and so @xmath1113 and @xmath1114 ) , and since @xmath889 is @xmath17-good . if @xmath1115 this holds by definition of @xmath1116 , since @xmath207 is @xmath17-fair , and similarly , if @xmath1117 this holds again by definition of @xmath1116 , since @xmath889 is @xmath17-fair .",
    "it remains to prove property ( iii ) .",
    "suppose first that @xmath1118 .",
    "if @xmath889 is not @xmath17-good then the required matching exists by the way we defined twins for @xmath1009 in this case . on the other hand ,",
    "if @xmath889 is @xmath17-good then we can apply the super - regularity property ( iv ) just established ( which only used the fact that @xmath889 is @xmath17-good ) and lemma  [ regmatch ] .",
    "next suppose that @xmath898",
    ". then @xmath1119 and @xmath1120 .",
    "thus if @xmath207 is not @xmath17-fair then the required matching exists by the way we defined twins for @xmath1007 in this case . on the other hand ,",
    "if @xmath207 is @xmath17-fair then we can apply the first point of property ( iv ) , which only used the fact that @xmath207 is @xmath17-fair .",
    "similarly , when @xmath901 , then @xmath1121 and @xmath1122 . if @xmath889 is not @xmath17-fair the required matching exists by the construction in this case , whereas if @xmath889 is @xmath17-fair then we can apply the second point of property ( iv ) with @xmath1123 playing the role of @xmath1124 , which only uses the fact that @xmath889 ( playing the role of @xmath207 in the second point ) is @xmath17-fair .",
    "the auxiliary graph @xmath198 is decomposed into shifted components @xmath760 ` left ' and @xmath197 ` right ' of size @xmath1125 and a set @xmath767 of size @xmath1126 .",
    "this corresponds to a partition of @xmath1127 .",
    "the @xmath134-factor @xmath84 defines a partition @xmath1128 , where a cluster @xmath207 belongs to @xmath1129 if and only if its successor @xmath889 belongs to @xmath1130 respectively .",
    "the shifted walk @xmath301 will use two types of transitions from @xmath825 to @xmath819 .",
    "one type is a pseudo - matching @xmath1007 from @xmath825 to @xmath819 , matching @xmath1017 to @xmath994 .",
    "the other type is a set @xmath1009 of vertices in @xmath1131 , with the property that if @xmath1066 then any @xmath1068 has many inneighbours in @xmath825 and any @xmath1132 has many outneighbours in @xmath819 .",
    "we did not discuss transitions from @xmath837 to @xmath831 , but these are obtained similarly under the transformation @xmath998 , @xmath871 , etc .",
    "each vertex in these sets has a twin ( or possibly two twins ) that will be used when @xmath301 traverses the cycle of @xmath84 containing it .",
    "for any cluster @xmath207 , the set of exit points from @xmath207 is @xmath1133 and the set of entry points to @xmath207 is @xmath1134 .",
    "there exists a perfect matching from @xmath1135 to @xmath1136 .",
    "the exceptional set @xmath187 is decomposed into @xmath697 parts @xmath1137 , @xmath970 , @xmath1138 and @xmath969 , where the first letter gives the in - type of a vertex and the second letter the out - type : there is a matching @xmath974 from @xmath971 to vertices of in - type @xmath392 ( and so on ) .",
    "technical complications are created by the possibility that a cluster may be full ( contain at least @xmath876 endpoints of @xmath872 ) or @xmath1060-full ( contain at least @xmath876 endpoints of @xmath1009 ) .",
    "a cluster @xmath207 is @xmath79-fair if no cluster at distance at most @xmath79 from @xmath207 is full , @xmath79-excellent if no cluster at distance at most @xmath79 from @xmath207 is full or in @xmath877 , and @xmath79-good if no cluster at distance at most @xmath79 from @xmath207 is full or @xmath1060-full .",
    "we have a set @xmath1139 such that whenever @xmath207 is @xmath1100-good , we have flexibility to use any vertices avoiding these sets in @xmath890 , @xmath207 and @xmath889 ( as well as avoiding the exits and entries already chosen ) , while preserving super - regularity of the corresponding pairs in @xmath84 .",
    "finally , the set @xmath981 of endpoints in @xmath980 of the matchings @xmath974 etc . only uses @xmath885-excellent clusters and avoids @xmath1140 .",
    "our aim in this section is to prove the following lower bound on the size of our pseudo - matchings @xmath872 and @xmath879 .",
    "[ mbl2cor]@xmath352    * @xmath1141",
    ". moreover , if @xmath1000 then @xmath1142 . *",
    ". moreover , if @xmath1144 then @xmath1145 .    to prove this",
    "we first show that there are large sets @xmath1146 with many outneighbours in @xmath819 and @xmath1147 with many inneighbours in @xmath825 .",
    "note that part ( v ) in the following lemma is not used in the proof of lemma  [ mbl2cor ] but will be needed in the final section of the paper .",
    "[ mbl1]@xmath352    * if @xmath1000 there is @xmath1146 with @xmath1148 , such that every @xmath1149 satisfies @xmath1150 furthermore , in any case , @xmath825 contains a set @xmath1151 of size @xmath1152 , such that every @xmath1153 satisfies @xmath1154 . *",
    "if @xmath1000 there is @xmath1147 with @xmath1155 , such that every @xmath1156 satisfies @xmath1157 furthermore , in any case , @xmath819 contains a set @xmath1158 of size @xmath1159 , such that every @xmath1160 satisfies @xmath1161 . * if @xmath1144 there is @xmath1162 with @xmath1163 , such that every @xmath1164 satisfies @xmath1165 furthermore , in any case , @xmath837 contains a set @xmath1166 of size @xmath1167 , such that every @xmath1168 satisfies @xmath1169 .",
    "* if @xmath1144 there is @xmath1170 with @xmath1171 , such that every @xmath1172 satisfies @xmath1173 furthermore , in any case , @xmath831 contains a set @xmath1174 of size @xmath1175 , such that every @xmath1176 satisfies @xmath1177 .",
    "* finally , suppose that @xmath796 , @xmath1137 and @xmath969 are all empty .",
    "* * if @xmath1178 , then @xmath825 contains a set @xmath1179 of at least @xmath1180 vertices , each having at least @xmath1181 outneighbours in @xmath1182 . * * if @xmath1183 , then @xmath819 contains a set @xmath1184 of at least @xmath1180 vertices , each having at least @xmath1181 inneighbours in @xmath1185 .",
    "suppose that @xmath1000 . to prove ( i )",
    ", we first consider the case when @xmath1186 .",
    "let @xmath1187 be as defined in lemma  [ split](v ) .",
    "let @xmath1179 be the set obtained from @xmath1187 by deleting the following vertices .",
    "* the set @xmath982 of @xmath1188 endvertices in @xmath980 of edges in @xmath974 , @xmath975 , @xmath976 , @xmath978 . * all the at most @xmath987 vertices which lie in clusters that are not @xmath885-excellent with respect to  @xmath872 or  @xmath879 .",
    "* all the at most @xmath1189 vertices which lie in clusters containing at least @xmath1190 vertices of @xmath982 .",
    "* all the at most @xmath818 vertices in @xmath825 having more than @xmath826 outneighbours in @xmath827 ( see lemma  [ middleedges](ii ) ) .    thus @xmath1191 .",
    "now we make the following key use of the minimality of @xmath1192 .",
    "we claim that any vertex @xmath1193 has outdegree at most @xmath1194 in @xmath187 .",
    "otherwise , there would be some edge @xmath43 with @xmath1195 .",
    "but then we can change the in - type of @xmath42 to @xmath64 by deleting the edge in @xmath974 incident to @xmath42 and adding the edge @xmath43 to @xmath975 .",
    "conditions ( v ) and ( vi ) in lemma  [ excvs ] will still hold , since @xmath1179 is disjoint from @xmath982 and only contains vertices in clusters containing at most @xmath1190 vertices of @xmath982 .",
    "condition ( ii ) holds since @xmath1196 by definition of @xmath1179 .",
    "this reduces @xmath1197 , which contradicts the minimality condition in lemma  [ excvs](vii ) .",
    "therefore the claim holds .",
    "now recall that @xmath1198 is a partition of @xmath168 .",
    "any @xmath1149 has at least @xmath11 outneighbours , of which at most @xmath1199 belong to @xmath1200 , at most @xmath826 belong to @xmath827 and at most @xmath1194 belong to @xmath187 .",
    "this shows that @xmath1179 is a set as required in  ( i ) .",
    "now consider the case when @xmath1201 , and so @xmath1202 by our degree assumptions .",
    "then @xmath1 has at least @xmath1203 vertices of indegree at least @xmath1204 , and by lemma  [ proprl ] at least @xmath1205 of these belong to @xmath819 .",
    "let @xmath1206 be a set of @xmath964 vertices with indegree at least @xmath1204 .",
    "note that every vertex in @xmath60 has indegree at least @xmath1207 in @xmath825 .",
    "then we must have a set @xmath1179 of at least @xmath1180 vertices in @xmath825 , each having outdegree at least @xmath1208 in @xmath60 , or we would have @xmath1209 , a contradiction .",
    "then every vertex in @xmath1179 has at least @xmath1210 outneighbours in @xmath1211 , as required .",
    "this completes the proof of  ( i ) when @xmath1000 .    the argument for ( i ) when we do not have @xmath1000 is the same ,",
    "except that we no longer have the minimality argument for @xmath1197 , so vertices in  @xmath1151 may have all of  @xmath187 as outneighbours .",
    "the arguments for  ( ii)(iv ) are analogous , so we omit them .",
    "finally , suppose that @xmath796 , @xmath1137 and @xmath969 are all empty , so that @xmath1212 is a partition of @xmath168 .",
    "for the first point in ( v ) , suppose that @xmath1178 . since @xmath1213 , every vertex @xmath41 in @xmath1179 ( defined as above ) has at least @xmath1214 outneighbours in @xmath1182 . by assumption , we have @xmath1215 , so the number of outneighbours of @xmath41 in @xmath1182 is at least @xmath1181 , as required .",
    "the second point follows in the same way .",
    "_ proof of lemma  [ mbl2cor ] .",
    "_ observe that all stated lower bounds are at most @xmath1216 , so it is enough to prove the existence of pseudo - matchings satisfying these bounds .",
    "we will suppose that @xmath1000 and prove the ` moreover ' statement of  ( i ) ; the arguments for the other assertions are similar .",
    "define an auxiliary bipartite graph whose vertex classes are @xmath825 and @xmath819 by joining a vertex @xmath1217 to a vertex @xmath1218 if @xmath43 is an edge of  @xmath1 .",
    "let  @xmath131 be the graph obtained from this bipartite graph by deleting all the edges whose endvertices both lie in clusters having distance at most  4 in @xmath84 from  @xmath171 .",
    "let @xmath1219 be the largest matching in  @xmath131 .",
    "* case  1 .",
    "* @xmath1220 .",
    "let  @xmath1221 be a matching obtained from @xmath1219 by deleting as few edges as possible so as to ensure that every vertex of  @xmath1 belongs to at most one edge from  @xmath1221 .",
    "note that every vertex of @xmath1 has indegree at most @xmath134 and outdegree at most @xmath134 in @xmath1219 , so @xmath1219 considered as a subdigraph of @xmath1 is a vertex - disjoint union of directed paths and cycles .",
    "thus we can retain at least @xmath949 of the edges of @xmath1219 in @xmath1221 ( with equality for a disjoint union of directed triangles ) . by deleting further edges",
    "if necessary we may assume that @xmath1222 .",
    "we claim that there is a submatching @xmath1223 of @xmath1221 of size at least @xmath1224 such that no cluster is full with respect to  @xmath1223 ( i.e.  every cluster contains at most @xmath876 endvertices of @xmath1223 ) .",
    "to see that such a @xmath1223 exists , consider the submatching @xmath1223 obtained from  @xmath1221 by retaining every edge of  @xmath1221 with probability @xmath1225 in @xmath1223 , independently of all other edges of  @xmath1221 .",
    "then for any cluster @xmath207 , the expected number of endvertices of @xmath1223 in @xmath207 is at most @xmath1190 , and the expected size of @xmath1223 is @xmath1226 . by chernoff bounds we see that with high probability @xmath1223 has the claimed properties .",
    "note that @xmath1223 is a pseudo - matching from  @xmath825 to @xmath819 , as by construction it is a matching , and by definition of @xmath131 every edge in @xmath1223 has an endvertex in a @xmath697-excellent cluster .",
    "also , since @xmath984 we have @xmath1227 , as required .",
    "* case  2 . * @xmath1228 .",
    "let @xmath60 be a minimum vertex cover of  @xmath131",
    ". then @xmath1229 by knig s theorem ( proposition  [ konig ] ) .",
    "write @xmath1230 and @xmath1231 .",
    "we say that a cluster  @xmath207 is _",
    "@xmath60-full _ if it contains at least @xmath1232 vertices from  @xmath60 .",
    "we say that @xmath207 is _ @xmath60-excellent _ if no cluster of distance at most  4 from  @xmath207 on  @xmath84 is @xmath60-full or lies in  @xmath171 .",
    "note that at most @xmath1233 clusters are @xmath60-full and thus by  ( [ eq : middle ] ) all but at most @xmath1234 vertices lie in @xmath60-excellent clusters .",
    "since @xmath1000 we can construct the sets  @xmath1179 and @xmath1184 given by lemma  [ mbl1](i ) and  ( ii ) .",
    "let @xmath1187 be the set of all those vertices in  @xmath1235 which lie in @xmath60-excellent clusters .",
    "thus @xmath1236 .",
    "moreover , @xmath1237 , since none of the edges deleted in the construction of @xmath131 were incident to @xmath1187 .",
    "now we greedily choose a matching @xmath1238 from @xmath1187 to @xmath1239 of size @xmath1240 ( defined in lemma  [ mbl1](i ) ) in such a way that every cluster contains at most @xmath1232 vertices on the @xmath825-side of @xmath131 . to see that this is possible , note that at any stage in the process we have excluded at most @xmath1241 vertices in @xmath1187 , so we can always pick a suitable vertex @xmath41 in @xmath1187 .",
    "then , since we have chosen less than @xmath1240 vertices in @xmath1242 , we can choose an unused outneighbour of @xmath41 in @xmath819 ( which lies in the cover @xmath60 , so in @xmath1242 ) .",
    "let @xmath1243 be the set of all those vertices in  @xmath1244 which lie in @xmath60-excellent clusters and are not endvertices of edges in  @xmath1238 . then @xmath1245 and @xmath1246 .",
    "as before , we can greedily choose a matching @xmath1247 from @xmath1248 to @xmath1243 of size @xmath1249 in such a way that every cluster contains at most @xmath1232 vertices on the @xmath819-side of @xmath131 .",
    "note that every @xmath60-excellent cluster is @xmath697-excellent with respect to @xmath1250 , as it contains at most @xmath876 endvertices of edges from  @xmath1250 ( it is not @xmath60-full ) , and so is not full with respect to @xmath1250 . also , any edge @xmath1251 in @xmath1250 has one endvertex in  @xmath60 and one endvertex outside  @xmath60 .",
    "the endvertex outside @xmath60 is that in @xmath1187 ( if @xmath1252 ) or @xmath1243 ( if @xmath1253 ) .",
    "so the endvertex outside @xmath60 is not an endvertex of another edge from @xmath1250 and lies in a cluster which is @xmath697-excellent with respect to @xmath1250 .",
    "we deduce that @xmath1250 is a disjoint union of edges and directed paths of length @xmath17 satisfying the definition of a pseudo - matching from @xmath825 to  @xmath819 .",
    "moreover , since @xmath1254 and @xmath1255 , we have @xmath1256 as required .",
    "the proof of the first statement of ( i ) is the same , except that we use the ` furthermore ' statements of lemma  [ mbl1](i ) and  ( ii ) in the final calculation instead of working with @xmath1240 and @xmath1249 .",
    "in this section we use the matchings and sets constructed in section  [ structure2 ] to prove theorem  [ ckko - approximate chvatal ] .",
    "we will assume that @xmath198 is not strongly @xmath562-connected , as we have already covered this case in section  [ highconnect ] ( although it could also be deduced from the arguments in this section ) .",
    "our strategy will depend on the value of @xmath1257 , and also on the size of middle , as described by the cases @xmath1258 or @xmath1259 above .",
    "we divide the proof into three subsections : the first covers the case when @xmath1260 and  @xmath1258 holds , the second when @xmath1259 holds , and the third when @xmath1001 and  @xmath1258 holds",
    ".      we will just give the argument for the case when @xmath1000 , as the other case is similar .",
    "we recall that @xmath1258 is the case when @xmath777 and @xmath1261 for every cycle @xmath75 of @xmath84 . in this case",
    "we will use the pseudo - matching  @xmath1007 as well as the additional transitions from  @xmath825 to @xmath819 which we get from @xmath1262 .",
    "we want to construct a walk @xmath301 with the same properties as in the proof of the case when @xmath198 is highly connected .",
    "recall that both @xmath765 $ ] and @xmath766 $ ] are strongly @xmath1263-connected ( see lemma  [ proprl ] ) .",
    "then by arguing as in the proof of lemma  [ disjointpaths ] for the graph @xmath765 $ ] instead of @xmath198 we deduce that for any two clusters @xmath1264 we can find @xmath1265 shifted walks ( with respect to  @xmath340 and  @xmath84 ) from @xmath207 to @xmath1266 such that each walk traverses at most @xmath1267 cycles from  @xmath84 and every cluster is internally used by at most one of these walks .",
    "a similar statement holds for any two clusters in  @xmath197 . for any two clusters @xmath207 and  @xmath1266 , we call a shifted walk ( with respect to  @xmath340 and  @xmath84 ) from @xmath207 to  @xmath1266 _ useful _ if it traverses at most @xmath1267 cycles from  @xmath84 and if every cluster which is internally used by the walk is @xmath697-excellent ( note that @xmath697-excellence is defined with respect to pseudo - matching  @xmath1007 in this case , and the pseudo - matching @xmath879 is irrelevant ) . since all but at most @xmath1268 clusters are @xmath697-excellent ( by ( @xmath1063 ) ) we have the following property . whenever @xmath1269 is a set of at most @xmath1270 clusters and @xmath1264 there exists a useful shifted walk from @xmath207 to @xmath1266 that does not internally use clusters in @xmath1269",
    ". a similar statement holds for any two clusters in  @xmath197 . &",
    "( )    we incorporate the vertices of the exceptional set @xmath187 using whichever edges in the matchings @xmath974 , @xmath975 , @xmath976 , @xmath978 correspond to their in - types and out - types .",
    "suppose for example that we have just visited a vertex @xmath41 of out - type @xmath760 , arriving via some edge in @xmath974 or @xmath975 ( depending on the in - type of @xmath41 ) and leaving to its outneighbour @xmath1271 in the matching @xmath976 .",
    "then @xmath1271 belongs to some cluster @xmath658 in @xmath760 . since @xmath765 $ ]",
    "is highly connected we can proceed to incorporate any vertex @xmath42 of in - type @xmath392 as follows . let @xmath1272 be the inneighbour of @xmath42 in @xmath974",
    ". then @xmath1272 belongs to some cluster @xmath207 of @xmath392 , and so by definition of @xmath392 the successor @xmath889 of @xmath207 on @xmath84 is a cluster of @xmath760 . let @xmath1273 be a useful shifted walk with @xmath1274 and @xmath1275 .",
    "let @xmath1276 be the cycle of @xmath84 containing @xmath1277 and form @xmath1278 by appending the path in @xmath1276 from @xmath889 to @xmath207 .",
    "so for any cycle @xmath75 of @xmath84 the clusters of @xmath75 are visited equally often by @xmath1278 .",
    "then in the construction of @xmath301 we can use the walk @xmath1278 to move from @xmath41 to @xmath42 . note that since we chose @xmath974 , @xmath975 , @xmath976 , @xmath978 to use at most @xmath876 vertices from any cluster and since @xmath1279 , ( @xmath1280 ) implies that we can avoid using any cluster more than @xmath1281 times ( although we may visit a cluster more often ) .",
    "thus we see that the structure of @xmath198 allows us to follow any vertex of out - type @xmath760 with any vertex of in - type @xmath392 , and similarly we can follow any vertex of out - type @xmath197 with any vertex of in - type @xmath64 . in particular , we can incorporate all vertices of type @xmath970 sequentially , all vertices of type @xmath1138 sequentially , and vertices of type @xmath969 or @xmath1137 can be incorporated in an alternating sequence , while there remain vertices of both types .",
    "this explains the purpose of condition ( vii ) in lemma  [ excvs ] : choosing @xmath983 to be minimal .",
    "we order the vertices of @xmath187 as follows .",
    "first , we list all vertices of type @xmath970 ( if any exist ) . these will be followed by an arbitrary vertex of type @xmath1137 ( which must exist as @xmath1282 ) .",
    "then list all vertices of type @xmath1138 ( if any exist ) .",
    "then we alternately list vertices of type @xmath969 and @xmath1137 until all vertices of type @xmath969 are exhausted . finally , we list all vertices of type @xmath1137 ( if any remain ) .",
    "so the list by type has the form : @xmath1283 we can follow the procedure described above to incorporate all vertices in the list apart from the final block of @xmath1284 vertices of type @xmath1137 . at this point",
    "the above procedure would require a shifted walk from @xmath197 to @xmath760 , which need not exist .",
    "for these remaining vertices we will use the @xmath1257 transitions from @xmath825 to @xmath819 formed by the matching @xmath1007 and the vertices in @xmath1262 .",
    "( we need @xmath1257 transitions rather than @xmath1284 since we need to close the walk  @xmath301 after incorporating the last exceptional vertex . )",
    "suppose we have just visited an exceptional vertex @xmath138 of type @xmath1137 , leaving to its outneighbour @xmath1285 in the matching @xmath978 , and we want to visit another vertex @xmath139 of type @xmath1137 , with inneighbour @xmath1286 in the matching @xmath974 .",
    "let @xmath658 be the cluster of @xmath197 containing @xmath1285 and @xmath207 the cluster of @xmath392 containing @xmath1286 .",
    "we pick an unused edge @xmath43 of @xmath1007 , where @xmath41 belongs to a cluster @xmath123 of @xmath64 and @xmath42 to a cluster @xmath241 of @xmath760 .",
    "recall from subsection  [ transitions ] that @xmath1287 and @xmath1288 have twins @xmath1289 and @xmath1290 . by lemma  [ twinnbs ]",
    "there are @xmath1291 and @xmath1292 such that @xmath1012 has at least @xmath1293 inneighbours in  @xmath1101 , whereas @xmath1013 has at least @xmath855 outneighbours in  @xmath1102 .",
    "we can also choose @xmath1101 and @xmath1102 to be @xmath697-excellent , since by lemma  [ twinnbs ] there are at least @xmath1294 choices for both @xmath1101 and @xmath1102 , and at most @xmath1295 clusters are not @xmath697-excellent ( by ( @xmath1063 ) ) . choose a useful shifted walk @xmath1296 from @xmath658 to the @xmath84-successor @xmath1297 of  @xmath1101 and a useful shifted walk @xmath1298 from @xmath1102 to the @xmath84-successor @xmath889 of @xmath207 .",
    "@xmath1296 and @xmath1298 exist by  ( @xmath1280 ) , since @xmath1299 as @xmath1291 and @xmath1300 as @xmath1301 .",
    "thus , as illustrated in figure  3 , we can form a segment of the walk @xmath301 linking @xmath138 to @xmath139 by first following @xmath1296 to @xmath1297 , then the path in @xmath84 from @xmath1297 to @xmath1101 , then the edge @xmath1302 , then the path in @xmath84 from @xmath580 to @xmath123 , then the edge @xmath43 , then the path in @xmath84 from @xmath241 to @xmath1303 , then the edge @xmath1304 , then @xmath1298 to  @xmath889 , and finally the path in @xmath84 from @xmath889 to @xmath207 .",
    "when we are transforming our walk @xmath301 into a hamilton cycle we will replace @xmath1302 with an edge of  @xmath1 from some vertex in  @xmath1101 to  @xmath1012 and replace @xmath1304 with an edge from  @xmath1013 to some vertex in  @xmath1102 .",
    "so we say that @xmath1012 is a _ prescribed endvertex _ for this particular occurrence of @xmath1302 on  @xmath301 and that @xmath1013 is a _ prescribed endvertex _ for this particular occurrence of @xmath1304 on  @xmath301 .",
    "the vertices @xmath41 and @xmath42 will be _ prescribed endvertices _ for the edge @xmath43 on  @xmath301 .",
    "( we will also define other prescribed endvertices on @xmath301 , and if they are not endpoints of @xmath1007 then they will always be such that they have at least @xmath1293 inneighbours in the previous cluster on @xmath301 or at least @xmath1293 outneighbours in the next cluster on @xmath301 .",
    "note our eventual hamilton cycle may not follow the route connecting @xmath1012 , @xmath41 , @xmath42 and @xmath1013 used here since we will use a rerouting procedure which is similar to that in the case when @xmath198 is highly connected . )",
    "[ transition ] , title=\"fig : \" ]    we use different matching edges from  @xmath1007 for different vertices of type @xmath1137 . after having used all of  @xmath1007",
    ", we use the @xmath1305 transitions from  @xmath825 to  @xmath819 which we get from @xmath1262 instead .",
    "if @xmath1306 is the cluster containing @xmath1059 and so @xmath1307 is the cluster containing its twin @xmath1308 , then , using lemma  [ twinnbs ] again , we can choose @xmath697-excellent clusters @xmath1291 and @xmath1309 such that @xmath41 has at least @xmath1293 inneighbours in  @xmath1101 whereas @xmath1012 has at least @xmath855 outneighbours in  @xmath1310 .",
    "we then take  @xmath1296 to be a useful walk from  @xmath658 to the @xmath84-successor @xmath1297 of @xmath1101 and  @xmath1298 to be a useful walk from @xmath1310 to  @xmath889 .",
    "then when we are transforming @xmath301 into a hamilton cycle we will replace @xmath1311 with an edge of  @xmath1 from some vertex in  @xmath1101 to @xmath41 and replace @xmath1312 with an edge from  @xmath1012 to some vertex in  @xmath1310 .",
    "so we say that @xmath41 is a _ prescribed endvertex _ for this particular occurrence of @xmath1311 on  @xmath301 and that @xmath1012 is a _ prescribed endvertex _ for this particular occurrence of @xmath1312 on  @xmath301 .",
    "at the moment we have constructed a walk  @xmath301 which starts in the cluster  @xmath1313 containing the inneighbour of the first exceptional vertex in our list , then goes into that vertex and then joins up all the exceptional vertices .",
    "after visiting the last exceptional vertex of type @xmath1137 , @xmath301 follows our last transition from  @xmath825 to  @xmath819 and ends in some @xmath697-excellent cluster @xmath1314 .",
    "( using the same notation as above , if this last transition was a matching edge @xmath1315 then @xmath1316 , and if it was a transition formed by a vertex @xmath1059 and its twin  @xmath1012 then @xmath1317 . ) say that a cluster @xmath207 is _ nearly @xmath697-good _ if @xmath207 is either @xmath697-good or at distance @xmath134 on @xmath84 from a @xmath697-good cluster .",
    "( a nearly @xmath697-good cluster is @xmath1100-good , but not conversely . )",
    "note that since all walks above were useful , the walk @xmath301 constructed only _ uses _ nearly @xmath697-good clusters , except when it uses a prescribed endvertex .",
    "using @xmath1318 , it is easy to check that we can choose  @xmath301 in such a way that every nearly @xmath697-good cluster is used at most @xmath1319 times .    before closing up the walk  @xmath301",
    ", we have to enlarge it by some special walks @xmath1320 , @xmath1321 , @xmath1322 and @xmath1323 which will ensure that we can actually transform  @xmath301 into a hamilton cycle of  @xmath1 ( rather than a 1-factor ) .",
    "we start by defining @xmath1321 .",
    "list the @xmath697-good clusters in @xmath760 as @xmath1324 , for some @xmath328 , where @xmath1325 .",
    "choose useful shifted walks @xmath577 from @xmath201 to @xmath1326 , for @xmath1327 , where @xmath1328 .",
    "let @xmath1329 .",
    "then @xmath1330 is a shifted walk from  @xmath1051 to itself , which uses every @xmath697-good cluster in  @xmath760 at least once , and which only uses nearly @xmath697-good clusters .",
    "call a cycle in  @xmath84 _ bad _ if it does not contain a @xmath697-good cluster lying in  @xmath1331 . for every bad cycle we pick a cluster",
    "whose distance from  @xmath171 on  @xmath84 is at least  @xmath17 .",
    "( this is possible since we are in case @xmath1258 , when no @xmath84-cycle significantly intersects  @xmath171 . )",
    "we let @xmath1332 and @xmath1333 be the sets of clusters in  @xmath760 and @xmath197 thus obtained .",
    "then no cluster @xmath1334 is nearly @xmath697-good , since @xmath1335 has distance at least  2 from  @xmath171 on  @xmath84 , and so the neighbours of  @xmath1335 on  @xmath84 can not be @xmath697-good by definition of ` bad ' . in particular , no cluster in @xmath1336 is @xmath697-good , so @xmath1337 by @xmath1338 .",
    "the purpose of the walk @xmath1320 is to ` fill up ' each cluster in  @xmath1332 : @xmath1320 will ensure that @xmath301 enters each such cluster precisely @xmath294 times .",
    "( recall that this notion was defined in section  [ techniques ] . ) list the clusters in  @xmath1332 that are not already entered @xmath294 times as @xmath1339 , and let @xmath1340 , where @xmath1341 is as defined before the statement of lemma  [ twinprops ] .",
    "( recall that @xmath1342 is not nearly @xmath697-good and so  @xmath301 only enters @xmath1342 in vertices which are prescribed . )",
    "let @xmath1343 be the @xmath84-predecessor of  @xmath1342 .",
    "let @xmath1344 be the vertices in @xmath1345 and @xmath1346 be the vertices in @xmath1347 .",
    "( lemma  [ twinprops](iii ) implies that @xmath1348 . )",
    "apply lemma  [ twinnbs ] to choose @xmath697-excellent clusters @xmath1349 and @xmath1350 such that @xmath1351 has at least @xmath1293 inneighbours in @xmath1352 and such that @xmath1353 has at least @xmath855 outneighbours in @xmath1354 .",
    "we now find the following shifted walks :    * for each @xmath1355 and each @xmath1356 choose a useful walk @xmath1357 from @xmath1354 to the @xmath84-successor @xmath1358 of @xmath1359 . *",
    "choose a useful walk @xmath1360 from @xmath1051 to the @xmath84-successor @xmath1361 of @xmath1362 .",
    "* for each @xmath1363 choose a useful walk @xmath1364 from @xmath1365 to the @xmath84-successor @xmath1366 of @xmath1367 .",
    "* choose a useful walk @xmath1368 from @xmath1369 to  @xmath1051 .",
    "* define the shifted walks @xmath1370 for each @xmath1355 and each @xmath1371 , where @xmath1372 is the @xmath84-cycle containing @xmath1352 and where @xmath1373 is the @xmath84-cycle containing  @xmath1342 .    then",
    ", as illustrated in figure  4 , we define @xmath1374 so @xmath1320 is a shifted walk from  @xmath1051 to itself .",
    "when transforming our walk  @xmath301 into a hamilton cycle of  @xmath1 , for each @xmath1375 we will replace the edge @xmath1376 on @xmath1377 by an edge of  @xmath1 entering @xmath1351 and the edge @xmath1378 on @xmath1377 by an edge leaving @xmath1353 .",
    "so we say that @xmath1351 , @xmath1353 are _ prescribed endvertices _ for these particular occurrences of @xmath1376 , @xmath1378 .",
    "[ bad ]     note that @xmath1320 is composed of @xmath1379 walks , each using at most @xmath1380 clusters ( by definition of useful walks ) . also @xmath1321 is composed of at most @xmath1381 further such walks . using ( @xmath1280 )",
    ", we can choose @xmath1330 and @xmath1320 such that the number of times they use every cluster outside @xmath1382 is at most @xmath1383 ( say ) . here",
    "@xmath1384 is the set of predecessors of @xmath1332 on @xmath84 .",
    "let @xmath1385 be the cluster which contains the neighbour in @xmath978 of the first exceptional vertex of type @xmath1137 in our list ( this exists , since @xmath1000 ) .",
    "then @xmath1386 is @xmath697-excellent by lemma  [ excvs ] .",
    "define walks @xmath1323 and @xmath1322 similarly to @xmath1321 and @xmath1320 , where @xmath1386 now plays the role of  @xmath1051 .",
    "( so both @xmath1323 and @xmath1322 are walks from  @xmath1386 to itself . )",
    "now we construct our final walk , which we will also call @xmath301 , as follows .",
    "we start with our previous walk @xmath301 joining  @xmath662 to  @xmath1051 , then we add @xmath1387 and replace the occurrence of  @xmath1386 mentioned above with @xmath1388 .",
    "we close up  @xmath301 by adding a useful walk from  @xmath1051 to  @xmath1389 , and then following the path in  @xmath84 from  @xmath1389 to  @xmath662 .",
    "our final walk @xmath301 has the properties listed below .    * for each cycle @xmath75 of @xmath84",
    ", @xmath301 visits every cluster of @xmath75 the same number of times , say @xmath302 . * * * @xmath301 enters every cluster of @xmath340 at most @xmath294 times , and thus @xmath301 exits every cluster at most  @xmath294 times . * * if @xmath1390 , then @xmath301 enters  @xmath207 precisely @xmath294 times and all the vertices of  @xmath207 are prescribed endvertices for these  @xmath294 entering edges of  @xmath301 . if @xmath1391 , then @xmath301 exits  @xmath207 precisely @xmath294 times and all the vertices of  @xmath207 are prescribed endvertices for these  @xmath294 exiting edges of  @xmath301 . * * if @xmath1392 is not nearly @xmath697-good then @xmath301 enters  @xmath207 precisely @xmath1393 times and the set @xmath1134 is the set of prescribed endvertices for all these @xmath1393 entering edges of  @xmath301 . similarly ,",
    "if @xmath1394 is not nearly @xmath697-good then @xmath301 exits  @xmath207 precisely @xmath1395 times and the set @xmath1133 is the set of prescribed endvertices for all these @xmath1395 exiting edges of  @xmath301 . * * if @xmath207 is nearly @xmath697-good then @xmath301 enters  @xmath207 between @xmath1393 and @xmath1396 times , the set @xmath1134 is the set of prescribed endvertices for @xmath1393 of these entering edges of  @xmath84 and no vertex in  @xmath207 is a prescribed endvertex for the other entering edges of  @xmath301 .",
    "the analogue holds for the exits of  @xmath301 at  @xmath207 .",
    "* @xmath301 visits every vertex of @xmath187 exactly once . * for each @xmath304 we can choose an inneighbour @xmath305 in the cluster preceding @xmath306 on @xmath301 and an outneighbour @xmath307 in the cluster following @xmath306 on @xmath301 , so that as @xmath306 ranges over @xmath187 all vertices @xmath307 , @xmath305 are distinct .",
    "recall that @xmath982 denotes the set of all endvertices of the matching edges in @xmath1397 outside of  @xmath187 .",
    "our aim now is to transform  @xmath301 into a hamilton cycle of  @xmath1 .",
    "we start by fixing edges in  @xmath1 corresponding to all those edges of  @xmath301 that lie in  @xmath340 but not in  @xmath84 .",
    "we first do this for all those occurrences @xmath1398 of edges on  @xmath301 for which there is no prescribed endvertex .",
    "note that the second and third conditions in ( b@xmath1399 ) together imply that in this case both @xmath207 and @xmath658 must be nearly @xmath697-good .",
    "then , applying lemma  [ regmatch ] as in section  [ highconnect ] , we can replace each such occurrence @xmath1400 by an edge from @xmath1401 to @xmath1402 in  @xmath1 , so that all the edges of @xmath1 obtained in this way are disjoint .",
    "we denote the set of edges obtained by @xmath1403 .",
    "next we choose the edge in  @xmath1 for all those occurrences @xmath1398 of edges on  @xmath301 which have a prescribed endvertex .",
    "this can be achieved by the following greedy procedure .",
    "suppose that we have assigned the endvertex @xmath1404 to @xmath1400 . then @xmath207 will be @xmath697-excellent , so by the last condition in  ( b@xmath1399 ) we have chosen at most @xmath1405 endvertices in  @xmath207 for edges constructed in previous steps . but",
    "@xmath434 has at least @xmath855 inneighbours in @xmath207 , where @xmath1406 , and @xmath1407 , so we can replace @xmath1400 by @xmath1408 for some @xmath1409 which is distinct from all the vertices chosen before .",
    "( this is the point where we need to work with @xmath340 instead of @xmath293  we have @xmath778 , and so the above argument would fail for @xmath293 . )",
    "we denote the set of edges obtained by @xmath1410 .",
    "let @xmath1411 , where @xmath1412 and @xmath1413 .",
    "( note that @xmath301 used each edge in @xmath1414 precisely once . ) for each cluster @xmath207 let @xmath1415 be the subset of all initial vertices of edges in  @xmath1416 and let @xmath1417 be the subset of all final vertices of edges in  @xmath1416 . then @xmath1418 and @xmath1419 .",
    "the following lemma provides useful properties of these fixed edges .",
    "[ exitentry]@xmath352    * @xmath1416 is a vertex - disjoint union of directed paths , each having at least one endvertex in a @xmath697-excellent cluster .",
    "moreover , every cluster @xmath207 satisfies the following .",
    "* @xmath1420 . *",
    "if @xmath207 is nearly @xmath697-good then @xmath1421 , @xmath1422 and @xmath1423 .",
    "moreover , @xmath1424 . *",
    "if @xmath207 is nearly @xmath697-good then the pairs @xmath1425 and @xmath1426 are @xmath584-super - regular .",
    "* there is a perfect matching from @xmath1427 to @xmath1428 .    by construction",
    "every vertex is the initial vertex of at most one edge in @xmath1416 and the final vertex of at most one edge in @xmath1416 , so @xmath1416 is a disjoint union of directed paths and cycles . to prove statement ( i ) , we note that @xmath1403 forms an independent set of edges in  @xmath1416 and each edge in @xmath1403 has both endvertices in @xmath697-excellent clusters .",
    "moreover , every edge in  @xmath1410 has a prescribed endvertex , and if @xmath850 was prescribed for an edge @xmath1400 or @xmath1429 in @xmath301 , then @xmath207 is a @xmath697-excellent cluster and we chose @xmath1430 so that @xmath1431 is the only edge of @xmath1416 containing @xmath414 .",
    "thus any component of @xmath1416 containing an edge from @xmath1432 is a directed path having at least one endvertex in a @xmath697-excellent cluster .",
    "also , @xmath1433 and @xmath1434 are vertex - disjoint , so any component of @xmath1416 not containing an edge from @xmath1432 is either a component of @xmath1433 , which has the required property by definition of ` pseudo - matching ' , or a directed path consisting of two edges of @xmath1434 , which has the required property by lemma  [ excvs ] . thus statement ( i ) holds .",
    "condition  ( ii ) follows immediately from our construction of  @xmath301 .",
    "the first part of  ( iii ) follows from the last part of  ( b@xmath1399 ) and the definition of @xmath697-good clusters . to check the remainder of  ( iii ) , note that the last part of  ( b@xmath1399 ) implies that the vertices in @xmath1435 and in @xmath1436 are endvertices of edges in @xmath1437 or non - prescribed endvertices of edges in  @xmath1410 .",
    "we chose the endvertices of edges in  @xmath1403 and the non - prescribed endvertices of edges in @xmath1410 to be disjoint from each other and from @xmath1438 .",
    "also , @xmath1439 by definition of  @xmath1140 in  ( [ xstar ] )  see subsection  [ twins ] .",
    "altogether , this implies the remainder of  ( iii ) .    to prove the first part of",
    "( iv ) , note that  ( iii ) and lemma  [ twinprops](iv ) applied with @xmath1440 and @xmath1441 together imply that @xmath1425 is @xmath584-super - regular .",
    "the second part of  ( iv ) can be proved similarly .",
    "it remains to prove  ( v ) .",
    "if @xmath207 is nearly @xmath697-good then  ( v ) follows from  ( ii ) and  ( iv ) and lemma  [ regmatch ] . if @xmath1391 then  ( v ) is trivial since @xmath1442 and @xmath1443 by the second condition in  ( b@xmath1399 ) . in all other cases",
    "the third condition of  ( b@xmath1399 ) implies that @xmath1444 and so @xmath1445 by  ( ii ) and the fact that @xmath1446 by lemma  [ twinprops](iii ) .",
    "thus in these cases  ( v ) follows from lemma  [ twinprops](iii ) .",
    "let @xmath664 denote a spanning subdigraph of  @xmath1 whose edge set consists of  @xmath1416 together with a perfect matching from @xmath1427 to @xmath1428 for every cluster  @xmath207 .",
    "then @xmath664 is a 1-factor of  @xmath1 .",
    "we will show that by choosing a different perfect matching from @xmath1427 to @xmath1428 for some clusters  @xmath207 if necessary , we can ensure that @xmath664 consists of only one cycle , i.e.  that @xmath664 is a hamilton cycle of  @xmath1 .",
    "first we show that if @xmath658 is @xmath697-good then we can merge most vertices of @xmath1447 , @xmath658 and @xmath843 into a single cycle of  @xmath664 .",
    "[ 4goodcycles ] we can choose the perfect matchings from @xmath1427 to @xmath1428 ( for all clusters  @xmath207 ) so that the following holds for every cluster  @xmath658 .",
    "* if @xmath658 is nearly @xmath697-good then all vertices in @xmath1448 lie on a common cycle @xmath669 of  @xmath664 .",
    "* if @xmath658 is @xmath697-good then @xmath684 .",
    "recall that if @xmath658 is nearly @xmath697-good then @xmath1449 by lemma  [ exitentry](iii ) .",
    "then it is clear that ( i ) implies ( ii ) , so it suffices to prove  ( i ) .",
    "we will consider each nearly @xmath697-good cluster  @xmath658 in turn and show that we can change the perfect matchings from @xmath1450 to @xmath674 and from @xmath1451 to @xmath1452 to ensure that @xmath658 satisfies the conclusions of the lemma , and moreover , every @xmath207 satisfying the conclusions continues to satisfy them .",
    "first we choose the perfect matching from @xmath1450 to @xmath674 to achieve the following .    1 .",
    "all vertices which were on a common cycle in  @xmath664 are still on a common cycle .",
    "all vertices in @xmath1453 lie on a common cycle in  @xmath664 .    since @xmath1454 is @xmath584-super - regular by lemma  [ exitentry](iv ) ,",
    "this can be achieved by the same argument used to prove statement ( @xmath678 ) at the end of section  [ highconnect ] .",
    "next we apply the same argument to merge all the cycles in ( the new )  @xmath664 meeting @xmath1452 into a single cycle , which then also contains all the vertices in @xmath1451 .",
    "since @xmath1449 by lemma  [ exitentry](iii ) , we have that @xmath1455 .",
    "thus the 1-factor  @xmath664 obtained in this way satisfies  ( 1 ) and  ( i ) for the cluster  @xmath658 . continuing in this way for all @xmath697-good clusters and their @xmath84-neighbours",
    "yields a 1-factor  @xmath664 as required in  ( i ) .",
    "we will now show that any 1-factor  @xmath664 as in lemma  [ 4goodcycles ] must consist of a single cycle ( and thus must be a hamilton cycle of  @xmath1 ) .",
    "[ singlecycle ] every @xmath134-factor  @xmath664 of  @xmath1 as in lemma  [ 4goodcycles ] satisfies the following conditions .",
    "* for every cycle @xmath75 of  @xmath664 there exists a @xmath697-good cluster @xmath1456 such that @xmath1457 , i.e. @xmath75 contains all vertices in @xmath1448 .",
    "* there is one cycle @xmath1458 in @xmath664 which contains @xmath1448 for every @xmath697-good cluster @xmath1459 . similarly , there is some cycle @xmath1460 in @xmath664 which contains @xmath1448 for every @xmath697-good cluster @xmath864 . *",
    "@xmath1461 ( and thus @xmath664 is a hamilton cycle of  @xmath1 ) .    first consider the case when @xmath75 contains at least one edge in  @xmath1416 , and let @xmath77 be the longest subpath of  @xmath75 which only consists of edges in  @xmath1416",
    ". by lemma  [ exitentry](i ) @xmath77 has an endvertex @xmath41 lying in a @xmath697-excellent ( and so @xmath697-good ) cluster  @xmath658 .",
    "but @xmath41 can not lie in both @xmath680 and @xmath679 by the maximality of the path .",
    "therefore @xmath1462 , and so @xmath1457 .",
    "now suppose that @xmath75 does not contain any edges of  @xmath1416 .",
    "this means that there is some cycle @xmath1463 such that @xmath75 ` winds around '  @xmath759 , i.e. it only uses clusters in @xmath759 and in each step moves from @xmath207 to @xmath889 for some @xmath1464 .",
    "we claim that @xmath759 can not be bad .",
    "otherwise , it would contain a cluster  @xmath1390 .",
    "but then the second part of ( b@xmath1399 ) implies that @xmath1465 , so @xmath75 can not ` wind around '  @xmath759 .",
    "( the purpose of the walks @xmath1320 and @xmath1322 was to exclude this possibility . )",
    "thus @xmath759 is not bad , so contains a @xmath697-good cluster  @xmath1456 , which @xmath75 must meet in at least one vertex , @xmath434 say .",
    "but @xmath1466 ( otherwise one edge at @xmath434 on @xmath75 would lie in  @xmath1416 ) .",
    "now lemma  [ 4goodcycles](i ) implies that @xmath75 contains all vertices in @xmath1448 , as required .    to prove the first part of  ( ii ) ,",
    "consider the walk @xmath1321 which connected all @xmath697-good clusters in  @xmath760 .",
    "let @xmath1467 , where @xmath1468 .",
    "then each @xmath697-good cluster in  @xmath760 appears at least once in @xmath1469 , and @xmath1321 only uses nearly @xmath697-good clusters .",
    "let @xmath1470 be the edge in  @xmath1416 that we have chosen for the edge @xmath1471 on  @xmath1321 . as neither @xmath1472 nor @xmath1473 was a prescribed endvertex for @xmath1471 , we have @xmath1474 and @xmath1475",
    ". thus @xmath1476 and @xmath1477 by lemma  [ exitentry](iii ) .",
    "so lemma  [ 4goodcycles](ii ) implies that for each @xmath1478 the vertices @xmath1472 and @xmath1479 lie on the same cycle of  @xmath664 .",
    "trivially , @xmath305 and @xmath1473 also lie on the same cycle for each @xmath691 .",
    "this means that all of @xmath1480 lie on the same cycle of  @xmath664 , which we will call @xmath1458 .",
    "this in turn implies that  @xmath1458 contains @xmath1448 for every @xmath697-good cluster @xmath1459 .",
    "indeed , @xmath1481 for some @xmath1482 and @xmath1483 .",
    "as @xmath1484 , lemma  [ 4goodcycles](i ) implies that @xmath1458 contains all vertices in @xmath1448 .",
    "a similar argument for @xmath1323 establishes the existence of  @xmath1460 .    to verify  ( iii ) , consider an exceptional vertex @xmath41 of type @xmath1137 ( which exists since we are assuming that @xmath1000 ) .",
    "let @xmath1485 and @xmath1271 be the neighbours of @xmath41 on the cycle @xmath1486 which contains @xmath41 .",
    "let @xmath123 be the cluster containing @xmath1485 and @xmath1101 be the cluster containing @xmath1271 .",
    "by lemma  [ excvs ] , @xmath1487 , @xmath1488 and both @xmath123 and @xmath1101 are @xmath885-excellent ( and thus @xmath697-good ) .",
    "since @xmath1489 and so @xmath1490 by lemma  [ exitentry](iii ) , we must have @xmath1491 .",
    "but on the other hand , @xmath1492 and @xmath1493 is @xmath697-good ( since @xmath123 is @xmath885-excellent ) .",
    "together with lemma  [ 4goodcycles](ii ) this implies that @xmath75 contains @xmath1494 , i.e.  @xmath1495 .",
    "together with  ( i ) this now implies that @xmath1496 , as required .",
    "recall that @xmath1259 is the case when @xmath1497 .",
    "we only consider the case when @xmath1498 , as the argument for the other case is similar .",
    "let @xmath1499 denote the set of all those cycles in  @xmath84 which avoid all the clusters in  @xmath1331 and contain more clusters from @xmath796 than from @xmath795 .",
    "let @xmath1500 denote the set of all other cycles in  @xmath84 which avoid all the clusters in  @xmath1331 .",
    "we divide the argument in this subsection into two cases .",
    "the main case is when @xmath1501 .",
    "we start by showing that we have at least @xmath1502 transitions from  @xmath825 to  @xmath819 .",
    "note that @xmath1503 . if @xmath1504 then , since @xmath1505 , we can use vertices in @xmath1506 as in subsection  [ twins ] to obtain the required transitions . on the other hand , if @xmath1507 then @xmath1508 .",
    "applying lemma  [ mbl2cor](i ) and recalling @xmath1509 we obtain @xmath1510 thus the pseudo - matching @xmath872 and the vertices in @xmath1506 together give at least @xmath1502 transitions from  @xmath825 to  @xmath819 .",
    "we claim we can choose a sub - pseudo - matching  @xmath1007 of @xmath872 and a set @xmath1511 with the following properties .",
    "* @xmath1512 , * no cluster contains more than @xmath1190 endpoints of @xmath1007 or more than @xmath1190 vertices in @xmath1009 . *",
    "every cycle in @xmath1499 contains at least one vertex of @xmath1009 .    to see this ,",
    "we first choose a vertex in @xmath796 on every cycle in @xmath1499 to include in @xmath1009 , which is possible since @xmath1513 .",
    "next we arbitrarily discard one edge from each @xmath17-edge path in @xmath872 to obtain a matching , and then consider a random submatching in which every edge is retained with probability @xmath1514 . as in case  1 of the proof of lemma  [ mbl2cor ] , with high probability",
    "we obtain a submatching of size at least @xmath1515 with at most @xmath1190 endpoints in any cluster .",
    "we also arbitrarily choose @xmath1190 vertices in each cluster of @xmath796 .",
    "then we still have at least @xmath1516 transitions . since @xmath1517 , we can arbitrarily choose some of these transitions so that @xmath1512 .",
    "note that there are no clusters which are @xmath1060-full or full with respect to  @xmath1007 .",
    "in particular , every cluster is @xmath697-good .",
    "next we choose twins as in subsection  [ twins ] so that the properties in lemma  [ twinprops](ii)(iv ) hold .",
    "thus we obtain sets @xmath1017 , @xmath994 , @xmath1095 , @xmath1096 , @xmath1009 , @xmath1097 as before .",
    "we now proceed similarly as in subsection  [ subsec : blstar ] , forming a walk @xmath301 that incorporates all the exceptional vertices and uses @xmath1257 transitions , ending in some @xmath697-excellent cluster @xmath1314 . since all clusters are @xmath697-good , the bad cycles are precisely those in  @xmath1518 .",
    "now we can not construct the walks @xmath1320 and @xmath1322 as before , since the bad cycles avoid @xmath1331 .",
    "instead , we enlarge @xmath301 by including a walk @xmath1519 which ` connects ' all the cycles in  @xmath1500 .",
    "suppose that @xmath1520 are the cycles in  @xmath1500 and choose a cluster @xmath1521 on each  @xmath318 .",
    "lemma  [ lrandrlmiddle](i ) implies that , in  @xmath340 , each @xmath1522 has many ( at least @xmath1523 ) @xmath697-excellent inneighbours in  @xmath392 , while each @xmath201 has many @xmath697-excellent outneighbours in  @xmath197 .",
    "we pick @xmath697-excellent inneighbours @xmath1524 of @xmath1522 and @xmath697-excellent outneighbours @xmath1525 of @xmath201 for each  @xmath113 .",
    "now we construct @xmath1519 as follows .",
    "we start at @xmath1314 , follow a useful shifted walk to @xmath1526 , then the path in  @xmath84 from  @xmath1527 to  @xmath1528 and then use the edge @xmath1529 .",
    "next we wind around @xmath1530 to @xmath1531 , use the edge @xmath1532 and follow a useful shifted walk from @xmath1533 to one of the @xmath1534 transitions from  @xmath825 to  @xmath819 that we have not yet used to move back to  @xmath760 .",
    "we continue in this way until we have ` connected ' all the  @xmath318 . finally , we close @xmath1519 by following a useful shifted walk back to  @xmath1051 .    as in subsection  [ subsec : blstar ]",
    ", we fix the edges @xmath1416 and choose matchings from @xmath1535 to @xmath1536 for each cluster @xmath207 to obtain a @xmath134-factor @xmath664 .",
    "note that by construction every vertex outside of @xmath187 is incident to at most one edge of @xmath1416 , so @xmath1537 for each cluster  @xmath207",
    ". lemmas  [ exitentry ] and  [ 4goodcycles ] still hold , but instead of lemma  [ singlecycle](i ) we now only have that for every cycle @xmath75 of  @xmath664 there exists a cluster @xmath658 ( which is automatically @xmath697-good ) such that @xmath75 contains all the vertices in @xmath658 .",
    "we then deduce that @xmath664 has a cycle @xmath1458 containing all vertices in clusters of @xmath760 and a cycle @xmath1460 containing all vertices in clusters of @xmath197 . moreover , since we use at least one transition from @xmath825 to @xmath819 we have @xmath1538 .",
    "lemma  [ 4goodcycles ] now implies that for every cycle @xmath127 in  @xmath84 there is a cycle @xmath75 in  @xmath664 such that @xmath75 contains all vertices belonging to clusters in  @xmath127 . in particular , @xmath1539 contains all vertices belonging to clusters which lie on an @xmath84-cycle that intersects  @xmath1331 .",
    "moreover , if @xmath1540 is another cycle in  @xmath664 , then there must be a cycle @xmath127 in @xmath84 such that @xmath127 only consists of clusters from  @xmath767 and such that @xmath75 contains all vertices in @xmath658 for all clusters @xmath658 on  @xmath127 .",
    "if @xmath1541 then our choice of @xmath1009 implies that some such cluster  @xmath658 on  @xmath127 contains a vertex @xmath1542 .",
    "the inneighbour  @xmath42 of  @xmath41 in  @xmath664 lies in some cluster @xmath1543 and so @xmath1544 in @xmath197 . but @xmath1539 contains all vertices belonging to clusters that lie on an @xmath84-cycle which intersects @xmath197 .",
    "so @xmath1539 contains all vertices in @xmath241 , and thus contains  @xmath41 .",
    "this shows that @xmath1539 contains all those vertices which belong to clusters lying on cycles from  @xmath1499 . on the other hand ,",
    "the walk @xmath1519 ensures that @xmath1539 also contains all those vertices which belong to clusters lying on cycles from  @xmath1500 .",
    "altogether this shows that @xmath1545 is a hamilton cycle , as required .",
    "it remains to consider the case when @xmath1546 .",
    "we claim that there are at least @xmath681 transitions from @xmath837 to @xmath831 and at least @xmath681 transitions from @xmath825 to @xmath819 .",
    "if @xmath1547 , then we can use the vertices in @xmath1506 to get at least @xmath294 transitions from @xmath825 to  @xmath819 . on the other hand , if @xmath1548 then @xmath1549 by @xmath1259 , so lemma  [ mbl2cor](i ) implies the existence of a pseudo - matching from  @xmath825 to  @xmath819 of size at least @xmath1550 . similarly ,",
    "if @xmath813 then the vertices in @xmath1551 give at least @xmath294 transitions from @xmath837 to  @xmath831 .",
    "on the other hand , if @xmath1552 then lemma  [ mbl2cor](ii ) implies the existence of a pseudo - matching from  @xmath837 to  @xmath831 of size at least @xmath681 .",
    "thus in all cases , we have at least @xmath681 transitions in both directions .",
    "we can use these transitions to argue similarly as in the first case when @xmath1553 , but this time we also include a walk @xmath1554 into  @xmath301 which ` connects ' all the cycles in @xmath1499 . since @xmath1555",
    "there are more than enough transitions .",
    "moreover , if @xmath1556 , then we also make sure that @xmath301 follows at least one transition from @xmath825 to @xmath819 ( and thus at least one transition from @xmath837 to  @xmath831 ) .",
    "then we find a hamilton cycle by the same argument as above .",
    "if @xmath1557 then we can use the same procedure as in subsection  [ subsec : blstar ] , with no need to use any edges from @xmath872 or @xmath879 . for the remainder of the proof we consider the case",
    "when @xmath1002 . in this case , our list of the vertices of @xmath187 has all vertices of type @xmath970 followed by all vertices of type @xmath1138 , so we will need to make a transition from incorporating vertices of type @xmath970 to type @xmath1138 and then another transition back from type @xmath1138 to type @xmath970 , i.e.  we need one transition from  @xmath837 to  @xmath831 and another one from @xmath825 to  @xmath819 . if @xmath795 and @xmath796 are both non - empty , then a similar argument as in the second case of the previous subsection implies that there are at least @xmath681 transitions from  @xmath825 to  @xmath819 and at least @xmath681 transitions from  @xmath837 to  @xmath831 .",
    "thus we may suppose that at least one of @xmath1558 is empty .",
    "we only consider the case when @xmath1559 ( and @xmath795 could be empty or non - empty ) , as the other case is similar .",
    "let @xmath1560 and @xmath1561 be the first and last vertices of the @xmath970 list and @xmath1562 and @xmath1563 the first and last vertices of the @xmath1138 list .",
    "let @xmath1564 be the cluster containing the outneighbour of @xmath1561 in @xmath976 , @xmath1565 the cluster containing the inneighbour of @xmath1562 in @xmath975 , @xmath1566 the cluster containing the outneighbour of @xmath1563 in @xmath978 , and @xmath1567 the cluster containing the inneighbour of @xmath1560 in @xmath974 .",
    "we need to construct portions of our walk @xmath301 that link @xmath1568 to @xmath1533 and @xmath1569 to @xmath1570 .",
    "( if for instance the @xmath970 list is empty , we take @xmath1570 to be an arbitrary cluster in @xmath392 . )",
    "we consider two subcases according to whether there is a cycle of @xmath84 that contains both a cluster of @xmath760 and a cluster of @xmath197 .    * case  1 . *",
    "_ there is a cycle @xmath75 of @xmath84 containing a cluster @xmath1571 and a cluster @xmath1572 . _    in this case we can reroute along @xmath75 to construct the required transitions .",
    "let @xmath1296 be a shifted walk from @xmath1569 to @xmath1573 .",
    "this exists since @xmath1574 .",
    "also , since @xmath75 contains @xmath1572 we can choose the walk @xmath1296 to go via @xmath241 , and @xmath75 will be one of the cycles traversed . similarly we can choose a shifted walk @xmath1298 from @xmath1568 to @xmath625 , and we can choose @xmath1298 to go via @xmath123 , so it also traverses @xmath75 .",
    "now we construct the portions of the walk @xmath301 joining @xmath1561 to @xmath1562 and @xmath1563 to @xmath1560 as follows . to join @xmath1561 to @xmath1562",
    "we start at @xmath1568 , follow @xmath1298 until it reaches @xmath123 , then follow @xmath75 round to @xmath1303 , and then switch to @xmath1296 , which takes us to @xmath1573 , and we end by traversing a cycle of @xmath84 to reach @xmath1533 .",
    "this is balanced with respect to all cycles of @xmath84 except for @xmath75 , where we have only used the portion from @xmath123 to @xmath1303 . to join @xmath1563 to @xmath1560",
    "we start at @xmath1569 , follow @xmath1296 until it reaches @xmath241 , then follow @xmath75 round to @xmath581 , and then switch to @xmath1298 , which we follow to @xmath625 , then traverse a cycle of @xmath84 to reach @xmath1570 .",
    "this is balanced with respect to all cycles of @xmath84 except for @xmath75 , where it only uses the portion from @xmath241 to @xmath581 .",
    "but this is exactly the missing portion from the first transition , so in combination they are balanced with respect to all cycles of @xmath84 .",
    "this scenario is illustrated in figure  5 .",
    "[ reroute ]     * case  2 . * _ no cycle of @xmath84 contains clusters from both @xmath760 and @xmath197 . _    first we observe that in this case we have @xmath1575 and @xmath1576 .",
    "to see the first inclusion , note that if @xmath1577 then @xmath1578 , so we can not have @xmath1579 by our assumption for this case .",
    "the second inclusion is similar . since @xmath1580 by lemma  [ proprl ] and since @xmath1581 , every vertex in  @xmath187 has either at least @xmath964 inneighbours in  @xmath837 or at least @xmath964 inneighbours in  @xmath825 ( and similarly for outneighbours in  @xmath819 and @xmath831 ) .",
    "so by swapping the types of the exceptional vertices between @xmath970 and @xmath1138 if necessary , we may assume that each @xmath1582 has either at least @xmath964 inneighbours in  @xmath837 or at least @xmath964 outneighbours in  @xmath819 ( or both ) , and similarly for the exceptional vertices of type  @xmath1138 .",
    "recall that @xmath796 is empty .",
    "we consider two further subcases according to whether or not @xmath795 is also empty .",
    "* case  2.1 * @xmath813 .",
    "we start by choosing an edge @xmath1583 from @xmath1584 to @xmath1585 such that @xmath1586 or @xmath1587 ( or both ) .",
    "such an edge exists by lemma  [ mbl1](v ) , since @xmath1588 .",
    "if both @xmath1586 and @xmath1587 , then we can use @xmath1583 for the transition from  @xmath825 to @xmath819 . together with suitable useful shifted walks in @xmath760 and in",
    "@xmath197 this will achieve the transition from  @xmath1563 to  @xmath1560 .",
    "for the transition from  @xmath837 to @xmath831 we use one vertex in @xmath795 , together with a twin of this vertex in @xmath811 .",
    "now we may suppose that @xmath1589 or @xmath1590 .",
    "we only consider the case when the former holds , as the other case is similar .",
    "we will still aim to use @xmath1583 for the transition from  @xmath825 to @xmath819 , although we need to make the following adjustments according to various cases for @xmath42 .",
    "if @xmath1591 then we relabel the @xmath1138 list so that @xmath1592 .",
    "we can then use the edge @xmath1583 ( together with a suitable useful shifted walk in @xmath760 ) to obtain a transition from  @xmath1563 to  @xmath1560 .",
    "suppose next that some edge in @xmath978 joins an exceptional vertex @xmath1593 to  @xmath42 .",
    "if @xmath434 has an outneighbour @xmath1594 , then we replace the edge @xmath1595 by @xmath1431 and can now use @xmath1583 to obtain a transition from  @xmath825 to @xmath819 .",
    "if @xmath434 has no such outneighbour , then @xmath434 must have at least @xmath964 inneighbours in @xmath825 ( by our assumption on the exceptional vertices at the beginning of case  2 ) as well as at least @xmath964 outneighbours in @xmath819 .",
    "pick such an inneighbour @xmath1596 and such an outneighbour @xmath1597 .",
    "we can now use the path @xmath1598 to obtain a transition from  @xmath825 to @xmath819 .",
    "finally , suppose that some edge in @xmath975 joins  @xmath42 to an exceptional vertex @xmath1593 .",
    "if @xmath434 has an inneighbour @xmath1599 , then we replace the edge @xmath1600 by @xmath1408 and can now use @xmath1583 to obtain a transition from  @xmath825 to @xmath819 .",
    "if @xmath434 has no such inneighbour , then @xmath434 must have at least @xmath964 inneighbours in @xmath837 .",
    "pick such an inneighbour @xmath1601 and let @xmath1602 be the outneighbour of  @xmath434 in the matching @xmath978 .",
    "we now use @xmath1583 to obtain a transition from  @xmath825 to @xmath819 and the path @xmath1598 to obtain a transition from  @xmath837 to @xmath831 .",
    "( note that @xmath42 can not be an endvertex of some edge in @xmath974 or @xmath976 outside  @xmath187 , since @xmath1603 and @xmath1604 . )    * case  2.2 * @xmath1605 .",
    "in this case we have @xmath1606 .",
    "thus @xmath1607 , and since @xmath793 we have @xmath1608 .",
    "similarly @xmath1609 .",
    "next suppose that there are exceptional vertices @xmath1610 such that @xmath1611 has least @xmath964 inneighbours in @xmath837 and at least @xmath964 outneighbours in @xmath831 .",
    "& ( v_1 )    @xmath1612 has least @xmath964 inneighbours in @xmath825 and at least @xmath964 outneighbours in @xmath819 . &",
    "( v_2 )    then we use @xmath1611 to get a transition from  @xmath837 to @xmath831 , and use @xmath1612 to get a transition from  @xmath825 to @xmath819 .",
    "now we may suppose that we can not find @xmath1611 and @xmath1612 as above",
    ". it may even be that we can find neither @xmath1611 nor @xmath1612 as above , in which case the following holds .",
    "every vertex of type @xmath970 has at least @xmath964 inneighbours in  @xmath837 and at least @xmath964 outneighbours in @xmath819 .",
    "every vertex of type @xmath1138 has at least @xmath964 inneighbours  @xmath825 and at least @xmath964 outneighbours in @xmath831 . &",
    "( )    for the remainder of the proof we suppose that either @xmath1613 or @xmath1614 holds , as the case @xmath1615 is similar to @xmath1613 .",
    "we consider the partition @xmath1616 where @xmath1617 and @xmath1618 .",
    "when @xmath1613 holds we add @xmath1611 to either @xmath1619 or @xmath312 such that the sets obtained in this way have different size .",
    "we still denote these sets by @xmath1619 and @xmath312 .",
    "the following lemma will supply the required transitions .",
    "[ final ] @xmath352    * when @xmath1613 holds there is an edge @xmath1583 from @xmath1620 to @xmath1621 having at least one endvertex in @xmath1622 .",
    "* when @xmath1614 holds there are two disjoint edges @xmath1623 and @xmath1583 with @xmath1624 , @xmath1625 such that both edges have at least one endpoint in @xmath1626 .",
    "suppose first that we have @xmath1627 .",
    "then we have at least @xmath962 vertices of outdegree at least @xmath962 . since @xmath1580 ( by lemma  [ proprl ] ) and @xmath1628 , we can choose vertices @xmath1629 and @xmath1630 with outdegree at least @xmath962 , and then outneighbours @xmath1631 in @xmath1632 of @xmath41 and @xmath1633 in @xmath1634 of @xmath42 .",
    "then @xmath1623 and @xmath1583 are the edges required in  ( ii ) and @xmath1583 is the edge required in  ( i ) .",
    "a similar argument applies if @xmath1635 .",
    "therefore we can assume that @xmath1636 and @xmath1637 .",
    "now our degree assumptions give @xmath1638 and @xmath1639 , so there are at least @xmath962 vertices of outdegree at least @xmath11 and at least @xmath962 vertices of indegree at least @xmath11 .",
    "we consider cases according to the size of  @xmath1619 and  @xmath312 .",
    "if @xmath1640 then we have sets @xmath1641 with @xmath1642 such that every vertex in @xmath123 has at least @xmath17 outneighbours in @xmath312 and every vertex in @xmath241 has at least @xmath17 inneighbours in @xmath312 .",
    "then we can obtain the required edges greedily : if @xmath1614 holds , choose any @xmath1643 , an outneighbour @xmath1644 of @xmath41 , any @xmath1645 with @xmath1633 and any inneighbour @xmath1646 of @xmath1647 with @xmath1648 ; if @xmath1613 holds , then we choose @xmath1649 and an outneighbour @xmath1650 .",
    "a similar argument applies when @xmath1651 .",
    "finally we have the case @xmath1652 , in which case @xmath1614 holds by definition of @xmath1619 and @xmath312",
    ". then we have sets @xmath1653 and @xmath1654 of vertices with outdegree at least @xmath11 , with @xmath1642 .",
    "note that each @xmath527 has at least one outneighbour in @xmath312 and each @xmath1655 has at least one outneighbour in @xmath1619 .",
    "choose some @xmath1656 and an outneighbour @xmath1657 of @xmath1658 . if there is any @xmath1655 , @xmath1659 with an outneighbour @xmath1660 in  @xmath1619 then @xmath1661 and @xmath1583 are our required edges .",
    "otherwise , we have the edge @xmath1662 for every @xmath1655 with @xmath1659 .",
    "so we choose some other @xmath527 with @xmath1663 , an outneighbour @xmath1644 of @xmath41 and a vertex @xmath1664 , and our required edges are @xmath1623 and @xmath1662 .",
    "now suppose that @xmath1613 holds .",
    "let @xmath1583 be the edge provided by lemma  [ final](i ) .",
    "if @xmath1665 and @xmath1587 , then we can use @xmath1583 for the transition from  @xmath1666 to @xmath819 . for the transition from  @xmath1667 to @xmath831 we use a path @xmath1668 such that @xmath1669 and @xmath1670 .",
    "( such a path exists since @xmath1611 has many inneighbours in  @xmath819 and many outneighbours in  @xmath831 . )",
    "now we may suppose that either @xmath1671 or @xmath1590 .",
    "we only consider the case when the former holds , as the other case is similar .",
    "we still aim to use @xmath1583 for the transition from  @xmath825 to @xmath819 , although we need to make adjustments as in case  2.1 .",
    "for example , consider the case when some edge in @xmath975 joins  @xmath42 to an exceptional vertex @xmath1593 . if @xmath434 has an inneighbour @xmath1599",
    ", then we replace the edge @xmath1600 by @xmath1408 and can now use @xmath1583 to obtain a transition from  @xmath825 to @xmath819 .",
    "if @xmath434 has no such inneighbour , then @xmath434 must have at least @xmath964 inneighbours in @xmath1667 .",
    "choose such an inneighbour @xmath1672 and let @xmath1673 be the outneighbour of @xmath434 in @xmath978 .",
    "add @xmath1611 to the set @xmath970 , @xmath1138 which contained it previously .",
    "we can now use @xmath1583 to obtain a transition from  @xmath825 to @xmath819 and the path @xmath1598 to obtain a transition from  @xmath837 to @xmath831 .",
    "the other cases are similar to those in case 2.1 .",
    "finally , suppose that @xmath1614 holds .",
    "let @xmath1623 , @xmath1583 be the edges provided by lemma  [ final](ii ) . then by changing the edges in @xmath1674 if necessary we can ensure that @xmath1675 .",
    "now we can use @xmath1623 for the transition from  @xmath837 to  @xmath831 and @xmath1583 for the transition from  @xmath825 to @xmath819 .",
    "this is clear if none of @xmath1676 lies in @xmath187 .",
    "but if we have @xmath973 ( for example ) , then @xmath1677 , and relabelling the @xmath970 list so that @xmath1678 we can use @xmath1623 for the transition from  @xmath1561 to  @xmath1562",
    ". the other cases are similar .    in all of the above cases for @xmath1002",
    "we obtain a transition from @xmath825 to @xmath819 and a transition from  @xmath837 to @xmath831 .",
    "now we can complete the proof as in subsection  [ subsec : blstar ] . here",
    "no cluster is full , and so every cluster is @xmath697-good .",
    "moreover , every vertex outside  @xmath187 is an endvertex of at most one edge in  @xmath1416 .",
    "thus as in lemma  [ singlecycle ] one can show that there are cycles @xmath1679 such that @xmath1458 contains all vertices belonging to clusters in  @xmath760 , @xmath1460 contains all vertices belonging to clusters in  @xmath197 and every exceptional vertex lies in  @xmath1458 or @xmath1460 .",
    "moreover , since every cluster is @xmath697-good and every vertex outside  @xmath187 is an endvertex of at most one edge in  @xmath1416 , lemma  [ 4goodcycles ] now implies that for every cycle @xmath127 in  @xmath84 there is a cycle @xmath759 in  @xmath664 such that @xmath759 contains all vertices belonging to clusters in  @xmath127 .",
    "now considering the transition from @xmath825 to @xmath819 ( say ) we see that @xmath1680 .",
    "since @xmath1258 implies that every cycle of  @xmath84 contains at least one cluster from @xmath1331 , we also have that all vertices in @xmath1681 are contained in @xmath1680 .",
    "thus @xmath1461 is a hamilton cycle of  @xmath1 .",
    "this completes the proof of theorem  [ ckko - approximate chvatal ] .",
    "the following example demonstrates that the degree properties used in our main theorem can not be substantially improved using our current method .",
    "let @xmath1 be a digraph with @xmath1682 such that @xmath1683 for every @xmath1684 and also for every @xmath1685 and @xmath1686 , for some @xmath1687 .",
    "then @xmath1 has minimum semidegree @xmath1688 and satisfies @xmath1689 for all @xmath1690 , so if we apply the regularity lemma it is ` indistinguishable ' from a digraph satisfying the hypotheses of conjecture  [ nash - williams conjecture - posa ] .",
    "however , any disjoint union of cycles in @xmath1 covers at most @xmath1691 vertices , so the argument used in section 6 breaks down .",
    "we remark that our argument may well still be useful in combination with a separate method for treating the case when the reduced digraph can not be nearly covered by disjoint cycles .",
    "j. komls  and  m. simonovits , szemerdi s regularity lemma and its applications in graph theory , in _",
    "combinatorics , paul erds is eighty , vol .  2 _ , bolyai soc .",
    "* 2 * , jnos bolyai math .",
    "soc . , budapest ( 1996 ) , 295352 .",
    "d. and  d. osthus , embedding large subgraphs into dense graphs , _ surveys in combinatorics _ ( editors s. huczynka ,",
    "j. mitchell , c. roney - dougal ) , london math .",
    "lecture notes 365 , cambridge university press , 2009 , 137 - 167 ."
  ],
  "abstract_text": [
    "<S> we show that for each @xmath0 , every digraph @xmath1 of sufficiently large order @xmath2 whose outdegree and indegree sequences @xmath3 and @xmath4 satisfy @xmath5 is hamiltonian . in fact , we can weaken these assumptions to    * @xmath6 or @xmath7 ; * @xmath8 or @xmath9 ;    and still deduce that @xmath1 is hamiltonian . </S>",
    "<S> this provides an approximate version of a conjecture of nash - williams from 1975 and improves a previous result of , osthus and treglown . </S>"
  ]
}