{
  "article_text": [
    "interferometers have proven themselves to be valuable tools in observing anisotropies in the cosmic microwave background ( cmb ) .",
    "they are inherently insensitive to anisotropies in atmospheric emission on scales larger than the beam and to ground spillover , and the fact that they sample fourier space directly make interferometers ideal instruments for measuring the cmb power spectrum .    a method for calculating the maximum - likelihood cmb power spectrum directly from the complex visibility data produced by an interferometer",
    "was first discussed by hobson , lasenby & jones ( 1995 ) ( hereafter hlj95 ) .",
    "the method was illustrated by assuming the cmb anisotropies to be described by a gaussian autocorrelation function , but the technique is easily modified so that the cmb power spectrum is parameterised in terms of flat band - powers in separate bins in @xmath0-space . indeed , the modified hlj95 algorithm was used to calculate flat band - power estimates of the cmb power spectrum in two spectral bins at @xmath1 and @xmath2 ( with bin - width @xmath3 ) for the cosmic anisotropy telescope ( cat ) , which is a 3-element interferometer ( scott et al .",
    "1996 ; baker et al .",
    "1999 )    following the early success of the cat , a new generation of cmb interferometers have been built , and have recently made high - sensitivity observations of the cmb .",
    "these experiments include the very small array ( vsa ) ( jones 1997 ; jones & scott 1998 ) , the degree angular scale interferometer ( dasi ) ( leitch et al . 2001 ; halverson et al . 2001 ) and the cosmic background imager ( cbi ) ( pearson et al . 2000 ; padin et al .",
    "although the detailed design of these experiments is different in each case , the basic principles underlying their operation are the same .",
    "in particular , these instruments have a larger number of antennas than the cat ( for example , the vsa has 14 horns ) and more sensitive detectors .",
    "these specifications enable the accurate measurement of the cmb power spectrum over a wide range of angular scales .",
    "for example , the vsa in its ` compact ' configuration ( see section  [ application ] ) measures the cmb power spectrum in 10 independent bins of width @xmath3 from @xmath4 .",
    "some discussion of how to obtain flat band - power estimates of the cmb power spectrum from this new generation of interferometer experiments has been presented by white et al .",
    "( 1999a ) and white et al .",
    "( 1999b ) , mainly in connection with the analysis of dasi data .",
    "indeed , the techniques outlined by these authors have been applied to the analysis of dasi and cbi observations . in particular , the dasi experiment has recently produced an accurate determination of the cmb power spectrum in 9 spectral bins of width @xmath5 in the range @xmath6 ( halverson et al .",
    "2001 ) , whereas the cbi has measured flat band - power estimates of the cmb power spectrum in two spectral bins at @xmath7 and @xmath8 , with a spectral resolution of @xmath9 ( padin et al .",
    "2001 ) .",
    "the increase in both the amount of visibility data and the number of independent spectral bins means that the computational burden of performing a likelihood analysis of the new generation of interferometer experiments is considerable .",
    "it is therefore of interest to investigate fast methods of calculating the likelihood function for interferometer observations of the cmb . in this paper",
    ", we extend the discussion given by hjl95 and white et al .",
    "( 1999a , 1999b ) and present a complete description of a maximum - likelihood technique for calculating flat band - power estimates of the cmb power spectrum from interferometer data .",
    "following hjl95 , the technique allows for contributions to the visibilities from galactic foreground emission , which can be separated out if multifrequency data are available . in terms of the computational algorithm",
    ", we also present some straightforward devices for speeding up the calculation of the likelihood function , which take advantage of certain useful properties of interferometer data . given the facility of fast evaluation of the likelihood function",
    ", we then investigate the relative merits of obtaining the maximum - likelihood flat band - power estimates , and their corresponding confidence intervals , either by direct evaluation the likelihood distribution , or by using traditional numerical maximisation techniques .",
    "our formalism makes no special assumptions specific to a particular experiment , and so can be applied to data from any cmb interferometer , including observations of mosaiced fields , and proper account is taken of non - coplanar baselines .",
    "the method is illustrated by applying it to simulated data from the very small array ( vsa ) .",
    "the application of the technique to real vsa observations will be presented in a forthcoming paper .",
    "we note , in passing , that a maximum - entropy map - making method for interferometer observations , which can simultaneously deconvolve the interferometer beam and separate cmb and galactic foreground emission , is discussed by maisinger , hobson & lasenby ( 1997 ) .",
    "let us consider how an interferometer performs an observation of the cmb .",
    "we begin by discussing the likely contribution to the visibility data due to emission from different physical components at microwave wavelengths .",
    "the total sky intensity @xmath10 at a frequency @xmath11 in a direction @xmath12 will , in general , contain contributions from the cmb and several foreground components , such as galactic free - free and synchrotron emission , as well as emission from extragalactic radio point sources . as we discuss in section  [ sec : baddatapointsources ] , contamination by point source emission is usually addressed by making simultaneous high - resolution observations of the sources , which may then be used to subtract the point source contribution from the data .",
    "we will therefore assume that point emission has been subtracted in this way , so that the remaining contamination of the cmb signal is due to diffuse galactic emission .",
    "we may express the fluctuations in the sky intensity as a sum over those due to each of these diffuse components @xmath13 where @xmath14 is the number of distinct physical components contributing to the total sky emission .",
    "for the cmb component , it is more usual to work in terms of equivalent thermodynamic temperature fluctuations @xmath15 , which is related to the intensity fluctuations by @xmath16 where @xmath17 is the planck function and @xmath18 k is the mean temperature of the cmb ( mather et al . 1994 ) .",
    "the conversion factor can be approximated by @xmath19 where @xmath20 . for simplicity",
    "we define the brightness temperature fluctuations for the foreground components in a similar way .",
    "thus , for the @xmath21th physical component of emission , we define @xmath22 we note that , in general , the ` temperature ' fluctuations of the foreground components will be frequency dependent , unlike those of the cmb",
    ".    temperature fluctuations on the sky are usually described by an expansion in spherical harmonics , so for each component we have @xmath23 from which we define the ensemble - average power spectrum of the @xmath21th component at some reference frequency @xmath24 by @xmath25 since the power spectrum of the cmb is usually quoted in terms of the power per unit logarithmic interval in @xmath0 , it is also useful to define the quantities @xmath26 for observations of small patches of sky , however , the spherical harmonic expansion is awkward to apply , and it is more convenient to use fourier analysis , so that @xmath27 where @xmath28 is the fourier transform of the temperature fluctuations in the @xmath21th physical component at an observing frequency @xmath11 . the reason for including the factor of @xmath29 in the exponent will become clear shortly , when we consider how an interferometer observes the sky .",
    "the two - dimensional transform variable @xmath30 is measured in wavelengths , and for later convenience we use @xmath31 to denote radial distances from the origin in the fourier domain . for small fields ,",
    "@xmath32 is related to the multipole @xmath0 in the spherical harmonic expansion by @xmath33 ; the exact relationship is @xmath34 ( see , for example , hobson & magueijo 1996 ) . since fourier transformation is a linear operation , we may simply sum over the fourier modes for each component to obtain an expression analogous to ( [ eqn1 ] ) for the fourier transform of the total sky fluctuations @xmath35 it is convenient to separate the dependence of the fourier modes on frequency @xmath11 and on position in the fourier domain @xmath30 .",
    "we are thus assuming that the spectral index of any galactic emission does is not spatially varying over the observed field .",
    "for the compact vsa , for example , the extent of a single field is @xmath36 degrees , and so this assumption is not too severe .",
    "for mosaiced observations ( see section  [ sec : mosaicing ] ) of larger areas of sky , however , this assumption may be questionable .",
    "we describe the frequency variation of each component through the functions @xmath37 @xmath38 . in this paper , we take the reference frequency @xmath39 ghz and normalise the frequency dependencies so that @xmath40 for all physical components .",
    "if the emission in each component is statistically isotropic over the observed field and no correlations exist between the components , then the fourier modes have mean zero and their covariance properties are given by @xmath41^ * \\rangle   = \\ ] ] @xmath42 where @xmath31 and @xmath43 is the ensemble - average power spectrum of the @xmath21th physical component at the reference frequency @xmath24 . since the sky is real",
    ", the fourier modes also obey @xmath44^*=a^{(p)}(-\\bmath{u},\\nu)$ ] .",
    "we note that the assumption of rotational invariance means that the ensemble - average power spectrum for each component is azimuthally symmetric in the fourier domain and hence a function of @xmath32 . for @xmath45 , we make contact with the spherical harmonic expansion by making the approximation @xmath46 which is accurate to within one per cent .",
    "if we define the quantity @xmath47 , then in a similar way we find @xmath48      expressing the temperature fluctuations of each component in terms of the fourier modes @xmath49 is particularly useful when discussing interferometer observations . assuming a small field size , and ignoring instrumental noise for the moment , an interferometer measures samples from the complex _ visibility plane _",
    "@xmath50 arising from the sky signal . after converting to temperature units ,",
    "this is given by @xmath51 where @xmath52 is the position relative to the phase centre , @xmath53 is the ( power ) primary beam of the antennas at the observing frequency @xmath11 ( normalised to unity at its peak ) , and @xmath30 is a baseline vector in units of wavelength . in the following discussion ,",
    "we assume the primary beam of a single antenna is circular symmetric and so does not vary with parallactic angle . from ( [ visdef ] ) , we see that @xmath54 is the fourier transform of the product of the sky temperature fluctuations and the primary beam , which is equivalent to the convolution of the underlying fourier modes @xmath55 with the fourier transform of the primary beam @xmath56 , @xmath57 the positions in the @xmath58-plane at which this function is sampled by the interferometer are determined by the physical positions of its antennas and the direction of the field on the sky .",
    "the samples @xmath59 lie on a series of curves ( or @xmath58-tracks ) , which we may denote by the function @xmath60 that equals unity where the fourier domain ( or @xmath58-plane ) is sampled and equals zero elsewhere",
    ". the function @xmath60 may be inverse fourier transformed to give the _ synthesised beam _",
    "@xmath61 of the interferometer at an observing frequency @xmath11 . for a realistic interferometer",
    ", the sample values will also contain a contribution due to instrumental noise .",
    "thus , at an observing frequency @xmath11 , the @xmath62th baseline @xmath59 of an interferometer ( measured in wavelengths ) measures the complex _ visibility _",
    "@xmath63 where @xmath64 is the instrumental noise on the @xmath62th visibility .",
    "the effects of the convolution of the underlying fourier modes with the aperture function and subsequent sampling are illustrated in fig .",
    "[ fig1 ] , for the case when only cmb emission is present ( and neglecting instrumental noise ) .",
    "( c ) the @xmath58-coverage for a simulated 5-h observation with a 14-element interferometer ; each point corresponds to a sample with an integration time of 64-s.,width=253 ]    in panel ( a ) , we plot the modulus - squared of the underlying fourier modes for a realisation of an inflationary cdm model with a hubble parameter @xmath65  65  km  s@xmath66 mpc@xmath66 and a fractional baryon density @xmath67 .",
    "the model is spatially flat with @xmath68 and @xmath69 , a primordial scalar spectral index @xmath70 , and no tensor modes .",
    "the spectrum is normalised to cobe .",
    "we note the presence of acoustic ` rings ' in this two - dimensional power spectrum .",
    "we also see that the different fourier modes are uncorrelated . in panel",
    "( b ) , we plot the same realisation but after convolution with an aperture function corresponding to an interferometer with a gaussian primary beam of 4.6@xmath71 fwhm .",
    "we see that the fourier modes are no longer all independent , but appear correlated on lengths scales corresponding to the width of aperture function .",
    "the @xmath72 diameter of this function is plotted as the solid disc bottom left - hand corner of the figure . in panel ( c )",
    "we overlay a typical 5-h @xmath58-coverage for a compact vsa observation of a single field at a declination of 30@xmath71 .",
    "this instrument consists of 14 antennas with physical separations lying between 20  cm and 1.50  m ( see section  [ application ] ) .",
    "each point corresponds to a sample with an integration time of 64 s.      from  ( [ eqn : aconvol ] ) , we see that in order to obtain a high resolution in fourier space and thus in @xmath0-space , the fourier transform of the primary beam needs to be narrow , implying large primary beams and small antennas . on the other hand ,",
    "high sensitivity demands a large collecting area for each antenna . clearly , some compromise has to be established between sensitivity and @xmath0-resolution , and the current generation of cmb interferometers differ in their respective priorities .",
    "however , the problem can be circumvented by a technique called mosaicing ( ekers & rots 1979 , cornwell 1988 , cornwell et al .",
    "1993 , holdaway 1999 ) .",
    "mosaicing consists of multiple observations of adjacent , overlapping fields on the sky .",
    "this increases the effective beam size of the telescope and thus the @xmath0-resolution .    mosaicing exploits that a telescope samples along each baseline a whole superposition of visibilities",
    "this is due to the finite extent of the the antenna aperture , which means that effectively all baselines corresponding to any two points on the two antennas that make up the baseline are sampled .",
    "observations with different pointing centres probe different superpositions and can thus help to disentangle the individual contributions ( ekers & rots 1979 , cornwell 1988 ) .",
    "unfortunately , observations of overlapping fields also require that we take into account the correlations between the fields . in appendix",
    "[ sec : appndx : mosaicing ] we show that the effect of mosaicing may be be included by defining an _ effective _ primary beam @xmath73 that replaces @xmath53 in ( [ visdef ] ) .      for telescopes with a large primary beam @xmath75 ,",
    "the two - dimensional approximation  ( [ visdef ] ) becomes inaccurate .",
    "radiation incident away from the telescopes pointing centres suffers from phase errors if the @xmath74-components of the telescope baselines ( i.e. the component in the direction of the source ) do not vanish , or if the baselines are not coplanar .",
    "this is a geometric effect and is usually referred to as @xmath74-distortion or as non - coplanar baselines ( see e.g. cornwell & perley 1993 ; perley 1999 ) .    in order to obtain a good resolution in fourier space ,",
    "the vsa has a comparatively large primary beam .",
    "while the antennas are all mounted on the same steerable table , they still track the source individually .",
    "this delay ",
    "tracking helps to identify foregrounds or other systematic errors by their different fringe rates .",
    "however , in the course of a longer observation , the projection of the source onto the telescope table changes and the array is effectively no longer coplanar .",
    "this topic is discussed in detail in appendix  [ sec : appndx : wcorrections ] , where we show that , similarly to mosaicing , again the effects of the non  coplanar baselines may be included by defining an appropriate _ effective _ primary beam @xmath73 that replaces @xmath53 in ( [ visdef ] ) .",
    "thus , the following discussion can be straightforwardly generalised to large fields .",
    "as discussed in hlj95 , before one can perform any meaningful statistical analysis , it is necessary to remove as many unwanted contributions as possible from the visibilities .",
    "it is also useful to compress the data sufficiently , such that the computational burden of the subsequent likelihood analysis is somewhat reduced .",
    "preliminary analysis of the time - ordered visibility data consists of the removal of periods of bad data due to poor weather conditions and system failures , and the subtraction of the contribution to the sky signal from identified discrete radio sources above some confusion limit .",
    "for example , osullivan et al . (",
    "1995 ) discuss how this preliminary data analysis was carried out for cmb observations with the cat interferometer , using the ryle telescope ( jones 1990 ) to perform the radio source subtraction . for vsa observations , the systematic removal of periods of bad data",
    "are performed in an analogous manner to that used for the cat .",
    "the subtraction of point sources from vsa data again relies on ryle telescope observations to identify and determine the fluxes of all sources above some flux limit in the observed field .",
    "this process is also assisted by the use of two source - subtraction antennas situated adjacent to the main vsa instrument .",
    "the details of the point source identification and subtraction techniques used for vsa observations is discussed in taylor ( 2000 ) and taylor et al .",
    "( 2001 ) .",
    "after periods of bad data and point source emission have been removed , the remaining non - cosmological contributions to the visibilities will then be from unsubtracted point sources below the flux limit of the observations , and from fluctuations in the galactic free - free , synchrotron and dust emission .",
    "these foregrounds are usually identified by their spectral differences from the cmb , using multifrequency observations .      for the new generation of cmb interferometers ,",
    "the total number of visibilities at each frequency is very large .",
    "for example , the total number of 64-s samples in a typical 5-h observation with a 14-element interferometer is approximately 25,000 , and any given field is observed for at least several days .",
    "it is therefore necessary to compress these data in some way , as discussed in hlj95 .",
    "this is analogous to the ` map - making ' step in the analysis of single - dish cmb experiments , in which time - ordered data is binned into pixels on the sky ( see , for example , borrill 1999 ) . for an interferometer",
    ", however , the visibilities at each observing frequency are binned into cells in the @xmath58-plane .",
    "since we are not interested in making accurate cmb maps from the binned data , but are more concerned with estimating the cmb power spectrum correctly , the @xmath58-plane is simply divided into equal - area square cells ( or pixels ) of side @xmath76 , within each of which @xmath50 is assumed to be constant .",
    "clearly , only a small number @xmath77 of these cells will contain observed visibility samples .",
    "we assemble the ( complex ) values in each observed pixel into the ( complex ) vector @xmath78 of length @xmath77 .",
    "we then calculate the maximum - likelihood solution for these @xmath77 values as follows .",
    "suppose that the total number of visibility samples at the observing frequency @xmath11 is @xmath79 , and that the @xmath62th visibility is measured at a point @xmath59 in the @xmath58-plane .",
    "let us assemble these visibilities into the ( complex ) data vector @xmath80 of length @xmath79 , and also define the @xmath81 pointing matrix with elements @xmath82 in this way , we may write the data vector as @xmath83 where @xmath84 is the ( complex ) noise vector of length @xmath79 , whose @xmath62th element is simply @xmath64 . assuming that the instrumental noise on the real and imaginary parts of the visibilities are independent and gaussian , it is described by the complex multivariate gaussian probability distribution ( see eaton 1983 ) @xmath85 where @xmath86 is the instrumental noise covariance matrix . substituting ( [ eqn : mm1 ] ) into ( [ eqn : mm2 ] )",
    ", we find that the likelihood of obtaining the observed visibility data given a particular signal vector @xmath78 is given by @xmath87.\\ ] ] maximising over @xmath78 then yields the maximum - likelihood solution , which we will denote by @xmath88 ( instead of the more usual @xmath89 ) .",
    "we find that this vector of _ binned _ visibility data ( of length @xmath77 ) is given in terms of the original visibility data vector @xmath80 ( of length @xmath79 ) by @xmath90 moreover , if we substitute ( [ eqn : mm1 ] ) back into ( [ eqn : mm3 ] ) , we find that the vector of binned visibilities can be written as @xmath91 where @xmath92 this shows that the binned visibility data @xmath88 is the sum of the pixelised signal @xmath78 and some residual pixelised noise @xmath93 with covariance matrix @xmath94 it is instructive to consider the special case in which the original instrumental noise covariance matrix @xmath95 is diagonal , so that the instrumental noise on each original visibility is uncorrelated .",
    "in fact , this is usually the case for interferometer data , and we may write @xmath96 , where @xmath97 is the variance of the instrumental noise on the @xmath62th original visibility . in this case , it is straightforward to show that the maximum - likelihood solution ( [ eqn : mm3 ] ) reduces to simple cell - averaging .",
    "thus , the value @xmath98 of the binned visibility in the @xmath99th cell is given by @xmath100 where @xmath101 is the number of original visibilities lying in that cell .",
    "similarly , from ( [ eqn : mm4 ] ) , we find that the residual pixelisation noise has the covariance matrix @xmath102 , where @xmath103 at each observing frequency @xmath11 , it is the binned visibility vector @xmath88 and pixelised noise vector @xmath93 that constitute the basic data which are analysed in the estimation of the cmb power spectrum .",
    "it is usual to associate the @xmath99th binned visibility @xmath98 and noise @xmath104 with the the position @xmath105 that corresponds to the centre of the @xmath99th cell in the @xmath58-plane .",
    "this is , however , not necessary .",
    "indeed , one may preserve more information regarding the distribution of samples in the @xmath58-plane by instead choosing @xmath105 to be the ` centre - of - mass ' of the positions of the visibility samples within the @xmath99th cell .",
    "it only remains to choose the size of the cells @xmath76 in the @xmath58-plane .",
    "since the speed with which the likelihood function can be calculated is strongly dependent on the number of binned visibility points that are analysed , we must make a compromise between how accurately the binned data represent the original visibilities , and the desire to use fewer data points in order to speed up the calculation .",
    "in fact , two natural limits exist for @xmath76 .    a minimum size for the @xmath58 cells is given by the requirement that each binned point on the grid represents an independent estimate of the underlying visibility .",
    "if the typical sample time per visibility is @xmath106 sec , then for samples at a distance from the @xmath58-origin of @xmath107 , time - smearing will correlate visibilities separated along a @xmath58-track by less than approximately @xmath108 for @xmath109 sec and @xmath58-coverage which extends out to @xmath110 wavelengths , then @xmath111 wavelengths .",
    "a maximum size for the @xmath58 cells is derived by considering the fact the measured visibilities are obtained by a convolution of the underlying fourier modes with the interferometer aperture function .",
    "for example , the vsa in its compact configuration , this function is a gaussian a fwhm of approximately 12 wavelength .",
    "hence , as discussed by hlj95 , from the sampling theorem we require @xmath112 wavelengths . nevertheless , finer binning is still useful since it provides better approximation for the position of the visibilities in the @xmath58-plane .",
    "thus , we find that the @xmath58 cell size is reasonably well determined by our two limiting cases and for the simulations considered here we use @xmath113 wavelengths .    as an illustration , in fig .",
    "[ fig2 ] we plot the positions of the binned visibilities corresponding to the samples shown in fig .",
    "[ fig1](c ) .",
    "each dot shows the position @xmath105 of the ` centre - of - mass ' of each cell , with which the binned visibility @xmath98 is associated . in this case",
    ", the number of non - zero binned visibilities is approximately 2500 .",
    "provided the geometry of the interferometer is not varied , each period of observation of a given field will produce visibility samples lying in the same set of cells in the @xmath58-plane .",
    "thus , after binning the _ total _ number of complex data points at each observing frequency that are used to estimate the cmb power spectrum is about 2500 .",
    "after binning , the data consist of the binned visibility data vector @xmath114 @xmath115 at each of the @xmath116 observing frequencies , together with the corresponding noise vector @xmath117 at each frequency .",
    "to keep our notation simple , we combine _ all _ the binned visibilities into the _ single _ data vector @xmath88 , and all the noise vectors into a single vector @xmath93 .",
    "let us assume that the @xmath62th binned visibility is measured at a point @xmath59 in the @xmath58-plane and at an observing frequency @xmath118 .",
    "from this point onwards , we shall denote the @xmath62th _ binned _ visibility by @xmath119 .",
    "similarly , we shall denote the noise on the @xmath62th binned visibility by @xmath120 and the contribution from the sky signal by @xmath121 . with a view to a practical implementation",
    ", it is easier to pursue the analysis in terms of the real and imaginary parts of each visibility , which we write as @xmath122 we may also divide the signal and noise contributions @xmath123 and @xmath124 into their real and imaginary parts in the same way . thus ,",
    "if the interferometer observation ( including all observing frequencies ) consists of total number @xmath125 of complex binned visibilities , we adopt the convention that the data vector @xmath88 is of length @xmath126 , consisting of first the real parts and then the imaginary parts of the visibilities , i.e. @xmath127 it is also useful to write @xmath128 , where the signal vector @xmath78 and noise vector @xmath93 are defined in a similar way .",
    "assuming there are no correlations between the contributions to visibilities from the sky signal and the instrumental noise , the covariance matrix of the interferometer data is given by @xmath129 where @xmath130 and @xmath131 are respectively the covariance matrices of the contributions from the sky signal and noise . to an excellent approximation , @xmath131 make be taken as diagonal , whereas the signal covariance matrix @xmath130 has the structure @xmath132 where @xmath133 etc .",
    "as shown in appendix  [ sec : appndx : covariance ] , for an observation of a single field in the flat - sky approximation , the elements of @xmath130 may be conveniently written in terms of the complex correlators @xmath134 where @xmath135 is the aperture function of the interferometer horns and @xmath136 is the _ generalised power spectrum _ , which is defined by @xmath137 we note that , if the primary beam of the interferometer horns is is symmetric with respect to inversion through the origin , i.e. @xmath138 , then the aperture function @xmath139 is real . in this case ,",
    "@xmath140 and @xmath141 vanish , and so @xmath130 in ( [ eqn : smatdef ] ) is block - diagonal .    by introducing polar",
    "coordinates @xmath142 into the @xmath58-plane , such that @xmath143 , we can also write @xmath144 and @xmath145 formally as the one - dimensional integrals @xmath146 where the _ window functions _ @xmath147 and @xmath148 are defined respectively by @xmath149 the advantage of writing @xmath144 and @xmath150 in this way is that it provides a natural separation between the influence on @xmath130 of instrumental effects and the underlying power spectrum of the sky .",
    "in particular , for an interferometer with a given geometry , the window functions @xmath147 and @xmath147 are fixed , independent of the underlying sky power spectrum .",
    "thus , for a given array geometry , these quantities need only be calculated once .    as discussed in appendices  [ sec : appndx : mosaicing ] and [ sec : appndx : wcorrections ] , if one performs mosaiced observations or includes the effects of non - coplanar baselines , the correlators @xmath151 and @xmath152 may still be written in the above forms , but with @xmath135 replaced by an appropriate _ effective _ aperture function @xmath153 .",
    "the relevant expressions for @xmath154 are given in ( [ eqn : effapermos2 ] ) and ( [ eqn : effaperw ] ) .",
    "in general , @xmath154 is not a real function , and so the signal covariance matrix ( [ eqn : smatdef ] ) is not , in general , block - diagonal .",
    "the expressions ( [ eqn : ss * ] ) and ( [ eqn : ss ] ) provide general formulae for calculating the element @xmath155 of the signal covariance matrix .",
    "so far we have assumed that all these elements must be calculated .",
    "if , for example , the number of binned complex visibilities is about @xmath156 , the real data vector @xmath88 has about @xmath157 elements .",
    "thus , in general , the construction of the ( symmetric ) covariance matrix @xmath130 requires the evaluation of approximately @xmath158 elements for any given generalised power spectrum @xmath136 .",
    "it is , however , straightforward to show that the signal covariance matrix @xmath130 is in fact very sparse and hence the computational requirements are somewhat reduced .     for interferometer observations.,width=245 ]",
    "the reason for the sparse nature of the signal covariance matrix is illustrated in fig .  [ fig3 ] , and is peculiar to observations of the cmb made with interferometers . for simplicity",
    "let us consider a single - field observation with no non - coplanar baselines , and focus particularly on two measured visibilities at positions @xmath159 and @xmath59 respectively in the @xmath58-plane . from  ( [ eqn : aconvol ] ) , these visibilities",
    "are obtained simply by convolving the underlying independent fourier modes by the aperture function of the interferometer , which is illustrated by the solid shaded circles in the figure .    since the extent of the antenna function is determined simply by the physical size of the interferometer horns , it is identically zero outside some critical radius @xmath160 .",
    "hence one would expect that , if the separation @xmath161 of the two visibility samples were greater than @xmath162 , then the corresponding element @xmath155 of the signal covariance matrix should be _ identically zero_. an additional subtlety remains , however , because the sky is real , and so @xmath163 .",
    "consequently , correlations exist between areas of the fourier domain that lie on diametrically opposite sides of the origin of the @xmath58-plane ; this is illustrated in fig .",
    "thus , the element @xmath155 of the signal covariance matrix will be identically zero provided @xmath159 and @xmath59 satisfy _ both _ the conditions @xmath164 , this occurs when no two shaded discs overlap .",
    "we may obtain a simple estimate for the sparsity fraction of the matrix @xmath130 as follows .",
    "suppose the interferometer samples the @xmath58-plane with roughly uniform two - dimensional coverage in the range @xmath165 to @xmath166 .",
    "thus , given the position of the sample @xmath159 , a second sample @xmath59 may lie anywhere in region between the two concentric circles @xmath167 and @xmath168 shown in fig .",
    "[ fig3 ] , which is of area @xmath169 . in order for @xmath155 to be non - zero , however",
    ", @xmath59 must lie within a distance @xmath162 of the point @xmath159 or @xmath170 , which corresponds to an available area @xmath171 of the @xmath58-plane .",
    "thus , an estimate of the sparsity fraction @xmath172 is given by the ratio of the areas , which reads @xmath173 for example , the vsa in compact configuration has @xmath174 , @xmath175 and @xmath176 wavelengths and so the sparsity fraction in this case is @xmath177 , i.e. only about 2 per cent of the elements are non - zero .",
    "in fact , the fraction of elements @xmath155 that need be calculated in practice is somewhat smaller than @xmath172 . as stated above",
    ", the element @xmath155 is identically zero if @xmath159 and @xmath59 satisfy the constraints , with @xmath160 equalling the full extent of the aperture function . for most interferometers",
    ", however , the aperture function falls close to zero some way before @xmath160 .",
    "thus , to a very good approximation , @xmath178 if @xmath179 may be taken to be somewhat less than unity",
    ". the resulting sparsity fraction @xmath172 is then lowered by a factor @xmath180 .",
    "in particular , as we describe below , many interferometers have an aperture function that are well described by a ( truncated ) two - dimensional gaussian . in this case",
    ", we find empirically that an excellent approximation to @xmath130 is obtained by assuming to be zero all those elements @xmath155 for which ( [ eqn : sp1 ] ) and ( [ eqn : sp2 ] ) are satisfied , where @xmath181 is chosen so that @xmath182 corresponds to the radius at which the gaussian aperture function drops to @xmath72 of its peak central value .",
    "this leaves only a very small percentage of matrix elements that must be calculated by evaluating the integrals ( [ eqn : ss * ] ) and ( [ eqn : ss ] ) . on using this approximation for @xmath130 in the subsequent maximum - likelihood estimation of the cmb power spectrum ,",
    "discussed later in section  [ application ] , we find that the flat band - power estimates obtained in each @xmath0-bin alter by less than 1 per cent , as compared to the case in which we set @xmath183 .",
    "it has become standard practice to parameterise the cmb power spectrum in terms of _ flat band - powers _ as follows .",
    "the range of @xmath184 separate bins .",
    "these bins correspond to separate annuli in the @xmath58-plane , centred on the origin .",
    "one then assumes that the quantity @xmath185 for each physical component @xmath38 is constant within any given spectral bin .",
    "we denote the constant value of @xmath186 in the @xmath187th bin by @xmath188 , and these quantities are the parameters whose values are to be determined from the likelihood analysis described in section  [ sec : likeanalysis ] . clearly , the total number of parameters is @xmath189 .",
    "this parameterisation of the component power spectra has the advantage that , once the elements of signal covariance matrix have been calculated for one set of band - power values @xmath188 , it may be evaluated for any other set at almost no extra computational cost .",
    "this is easily demonstrated by first introducing the top - hat function @xmath190 , which equals unity in the range @xmath191 and is zero elsewhere .",
    "we may then write @xmath186 in terms of our model parameters @xmath192 as @xmath193 where @xmath194 the lower limit of the @xmath187th bin .",
    "therefore , the generalised power spectrum @xmath136 in ( [ eqn : defgenps ] ) is now given by @xmath195 hence the expressions ( [ eqn : ss * ] ) and ( [ eqn : ss ] ) can be written as @xmath196 where the sets of integrals @xmath197 ( for @xmath198 ) are given by @xmath199    as stated earlier , for a given array geometry , the window functions @xmath200 @xmath201 are fixed .",
    "thus the integrals @xmath197 need only be evaluated once , at the start of the calculation . then for any values of the parameters @xmath188 , we may use ( [ eqn : ss*2 ] ) and ( [ eqn : ss2 ] ) to evaluate the elements of the signal covariance matrix @xmath130 .",
    "we may choose the width of the bins arbitrarily , but an obvious choice is the characteristic width of the aperture function of the interferometer ( for example , the @xmath72 width ) .",
    "since this width is the typical correlation length in the convolved fourier domain , the errors on the derived values of the flat band - powers in different bins will be quasi - uncorrelated .",
    "the compact vsa , for example , samples the range @xmath202 20150 wavelengths and the aperture function for a single field observation has a @xmath72 width of about @xmath203 wavelengths .",
    "thus , the total number of spectral bins is @xmath204 .",
    "so far we have not assumed a specific form for the primary beam @xmath53 of the interferometer horns .",
    "nevertheless , for many interferometers , the primary beam may be modelled to a good approximation as a two - dimensional gaussian .",
    "thus , the primary beam at the @xmath205th observing frequency @xmath206 by @xmath207 where @xmath208 is the dispersion of the primary beam at this frequency . the aperture function is simply the fourier transform of the primary beam , and is given by @xmath209    as we show in appendix  [ sec : appndx : gaussian ] , this assumption allows us to obtain analytical expressions for the window functions @xmath200 @xmath201 , even for mosaiced observations and including non - coplanar baselines .",
    "thus the integrals @xmath210 in ( [ eqn : integrals ] ) can be evaluated quickly and straightforwardly using standard numerical quadrature techniques . for a compact vsa observation of a single field ,",
    "the calculation of the integrals corresponding to non - zero elements of the signal covariance matrix @xmath130 require about 2 mins of cpu time .",
    "as discussed in the start of section  [ sec : binning ] , the basic data consist of the ( real ) binned visibility data vector @xmath88 of length @xmath211 , and the associated ( real ) residuals covariance matrix @xmath212 .",
    "assuming that the underlying fourier modes of the sky and the instrumental noise are both gaussian - distributed with zero mean , the likelihood of obtaining the data , given some particular set of model parameter values @xmath213 , is @xmath214\\ ] ] where @xmath215 is the sum of the signal and noise covariance matrices . in our case ,",
    "the vector of model parameters @xmath213 contains the @xmath216 flat band - powers @xmath188 in each spectral bin for each physical component of sky emission and the structure of the corresponding signal covariance matrix @xmath217 is discussed in the previous section . in fact , in order to avoid numerical instabilities , we adopt the standard technique of working instead with the log - likelihood function @xmath218 .",
    "\\label{likedef2}\\ ] ] the aim of any likelihood analysis is to find the parameter values @xmath219 that maximise the log - likelihood function , and also obtain an estimate of the accuracy with which these parameters have been determined .",
    "there exist several different strategies for achieving these goals , which we now discuss , with particular emphasis on the computational cost of each approach when applied to interferometer data .",
    "ideally , one would like to evaluate the full ( log-)likelihood function over some hypercube in the space of parameters @xmath213 . in this way ,",
    "the location of the ( global ) maximum is obtained immediately , and the presence of multiple subsidiary maxima is readily observed .",
    "also , if one is interested only in ( say ) the cmb power spectrum , one can integrate out ( or marginalise ) the parameters describing the power spectrum of galactic emission in a straightforward manner .",
    "moreover , marginalised distributions for individual parameters can be calculated trivially , in order to obtain confidence limits .",
    "unfortunately , evaluation of the full likelihood function on a hypercube in parameter space is numerically unfeasible when the number of parameters is large . in our case",
    ", the parameter space has @xmath189 dimensions .",
    "thus , if the likelihood function were evaluated at @xmath220 points along each parameter axis , the total number of evaluations of the log - likelihood function ( [ likedef2 ] ) is @xmath221 . even if one assumes that the cmb is the only physical component of emission ( i.e. @xmath222 ) , the dimensionality of the parameter space is equal to the number of spectral bins in which one wishes to estimate the cmb power spectrum . for the latest generation of cmb interferometers @xmath223 , and",
    "so the parameter space has a high dimensionality .",
    "if , in this case , the likelihood function were calculated at only @xmath224 points on each ` axis ' , this requires @xmath225 evaluations of the function ( [ likedef2 ] ) .    nevertheless , we note in passing that , with the advent of faster computers and efficient algorithms , it has recently become possible to sample directly from a multidimensional likelihood function using markov - chain monte - carlo ( mcmc ) techniques ( see e.g. christensen et al .",
    "2001 ) . even in a space of large dimensionality , these algorithms allow one to construct accurate one - dimensional marginalised distributions for each parameter , using relatively few evaluations of the likelihood function ( typically @xmath226 ) .",
    "the application of mcmc techniques to the estimation of the cmb power spectrum from interferometer data will be presented in a forthcoming paper .      despite the difficulties associated with the direct calculation of the full likelihood over a hypercube in parameter space ,",
    "it is necessary for our later discussion to consider the computational task associated with evaluating the log - likelihood function ( [ likedef2 ] ) for a given set of parameter values @xmath213 .",
    "first , one must calculate the corresponding covariance matrix @xmath215 . since @xmath131 is constant",
    ", one needs only to calculate the signal covariance matrix @xmath217 . as discussed in section  [ flatbps ] , after evaluating the integrals ( [ eqn : integrals ] ) once , at the start of the calculation , the signal covariance matrix @xmath217 , for a given set of parameter values @xmath213 , may be calculated very quickly using ( [ eqn : ss*2 ] ) and ( [ eqn : ss2 ] ) . since , for most interferometers , @xmath131 is diagonal to a very accurate approximation , @xmath227 inherits the sparse structure of @xmath217 described in section  [ sparsestructure ] .",
    "once @xmath228 has been calculated , one proceeds to evaluate the log - likelihood function ( [ likedef2 ] ) , which requires the evaluation of the quadratic form @xmath229 and the determinant @xmath230 .",
    "the standard procedure is first to perform the cholesky decomposition @xmath231 where @xmath232 is a lower triangular matrix .",
    "the determinant @xmath230 is then given by latexmath:[\\[|\\bmath{c}| =     @xmath232 is lower triangular , @xmath234 is simply the product of its diagonal elements . to evaluate the quadratic form ,",
    "one then solves for @xmath52 the lower triangular system @xmath235 which is computationally straightforward .",
    "finally , one forms the scalar product of @xmath52 with itself to obtain @xmath236 by far the most computationally intensive step in the calculation is the cholesky decomposition ( [ eqn : cholesky ] ) . for a compact vsa observation of a single field , for example ,",
    "the ( real ) binned visibility data vector @xmath88 contains about @xmath237 elements , so that @xmath228 has dimensions @xmath238 . using a standard lapack subroutine ( anderson et al .",
    "1999 ) to perform the decomposition requires about 5 mins of cpu time .",
    "the subsequent solution of the lower - triangular system ( [ eqn : ltriang ] ) is much faster , requiring only 0.25 secs of cpu time .",
    "hence , the total time required to evaluate the log - likelihood function ( [ likedef2 ] ) for a given set of parameters @xmath213 is around 5 mins .",
    "we therefore see that the evaluation of the full likelihood function over some hypercube in parameter space is computationally unfeasible .",
    "we note , in passing , that the lapack library uses the highly - optimised basic linear algebra subroutines ( blas ) for simple operations . in practice",
    ", this combination provides the fastest readily - available dense matrix computational subroutines . as a comparison , performing the same calculation of the log - likelihood using simple unoptimised routines , such as those presented in press et al .",
    "( 1994 ) , required approximately 20 times the cpu time on an equivalent processor .      as stated earlier , the covariance matrix @xmath228 is very sparse for interferometer data",
    ". therefore , using standard dense matrix subroutines , such as those in the lapack library , is wasteful both computationally and in terms of memory usage .",
    "one should instead employ sparse matrix algorithms , which take advantage of the sparse structure of @xmath228 and require only the storage of its non - zero elements ( plus an integer array to store their positions in the matrix ) .",
    "it was found that the most computationally efficient approach was to solve the linear system @xmath239 with a preconditioned conjugate - gradient algorithm that performed its internal matrix and vector operations using sparse matrix routines . in particular , the preconditioner was chosen to be the sparse incomplete cholesky decomposition of @xmath228 .",
    "this matrix has the form @xmath240 where @xmath241 is a diagonal matrix , and @xmath232 is lower triangular with unit diagonal elements and which has the same sparse structure as the lower triangle of @xmath228 ( which is symmetric ) . since one imposes this sparse structure on @xmath232 , the matrix @xmath242 is only an approximation to @xmath228 ( see greenbaum 1997 ) .",
    "nevertheless , the approximation is sufficiently accurate to provide an extremely effective preconditioner , which allows the conjugate - gradient algorithm to converge to the solution @xmath52 in a just a few iterations .",
    "moreover , it was found that the preconditioner @xmath242 was a sufficiently accurate approximation to @xmath228 that the determinant @xmath243 differed by less than 0.01 per cent from the true determinant @xmath230 .",
    "since @xmath241 is diagonal , its determinant is trivially evaluated .",
    "thus , the sparse matrix preconditioned conjugate - gradient algorithm provides an efficient method of calculating the complete log - likelihood function ( [ likedef2 ] ) .    as in the dense matrix approach ,",
    "the most computationally demanding step of the calculation is the construction of the incomplete cholesky preconditioner ( [ eqn : icholesky ] ) . as an example , for the @xmath244 covariance corresponding to a compact vsa observation of a single field , the calculation requires about 30 sec of cpu time .",
    "the subsequent preconditioned conjugate - gradient solution of the linear system ( [ eqn : clinear ] ) then requires only about 0.5 sec of cpu time .",
    "thus , we see that , in this case , the evaluation of the log - likelihood function by this method is approximately 10 times faster than the standard dense matrix approach using lapack subroutines . for larger problems , the lapack routines scale as @xmath245 , where @xmath211 is the size of the data vector , whereas the sparse matrix algorithm scales as @xmath246 , where @xmath172 is the sparsity fraction of the covariance matrix @xmath228 .",
    "unfortunately , the speed - up provided by the sparse matrix approach is still insufficient to enable the calculation of the full likelihood distribution over some hypercube in parameter space .",
    "when it is unfeasible to calculate the full likelihood function directly over the parameter space , one usually resorts to numerical maximisation .",
    "the main disadvantage of this approach is that most standard methods will converge to the nearest _",
    "maximum , which need not be the global maximum .",
    "one would hope , however , that the likelihood function is sufficiently structureless that this is not a problem for a reasonable starting guess for the cmb power spectrum .",
    "standard numerical maximisation ( minimisation ) algorithms use differing amounts of gradient and/or curvature information in order to arrive at the maximum point . for example , methods such as the downhill simplex or powell s direction - set algorithm use no gradient information , requiring only function evaluations ( see press et al .",
    "other methods , such as the variable metric technique , use only gradient information , whereas the standard newton ",
    "raphson algorithm requires both gradient and curvature information .",
    "in particular , newton ",
    "raphson technique and powell s direction - set algorithm were investigated as methods of numerically maximising the likelihood function .",
    "the newton ",
    "raphson method ( or variations thereon ) is the standard numerical minimisation technique used in maximum - likelihood estimation of the cmb power spectrum ( e.g. borrill 1999 ) . starting from some initial",
    "guess @xmath247 for the flat band - powers , one performs the iteration @xmath248 where the correction @xmath249 is given by @xmath250_{\\bmath{a}=\\bmath{a}_n},\\ ] ] in which @xmath251 is the gradient vector and @xmath252 is the curvature ( or hessian ) matrix .",
    "the iteration ( [ eqn : iteration ] ) is continued until the algorithm has converged to the required accuracy .",
    "the elements of the gradient vector and curvature matrix of the log - likelihood function ( [ likedef2 ] ) are easily shown to be given respectively by @xmath253 , \\label{eqn : loggrad}\\\\ \\spd{\\ln{\\cal l}}{a_k}{a_k ' } & = & -\\bmath{v}^{\\rm t } \\bmath{c}^{-1}\\pd{\\bmath{s}}{a_k } \\bmath{c}^{-1}\\pd{\\bmath{s}}{a_{k ' } } \\bmath{c}^{-1}\\bmath{v } \\nonumber \\\\ & &   \\qquad\\qquad   + \\tfrac{1}{2}\\mbox{tr}\\left(\\bmath{c}^{-1}\\pd{\\bmath{s}}{a_k } \\bmath{c}^{-1}\\pd{\\bmath{s}}{a_{k'}}\\right),\\label{eqn : logcurv}\\end{aligned}\\ ] ] where @xmath254 denotes the trace of a matrix .    the implementation of the newton ",
    "raphson algorithm can be divided neatly into a series of computational steps ( see borrill 1999 ) . for the analysis of interferometer data , each iteration of the algorithm consists of the following steps .",
    "1 .   calculation of the signal covariance derivative matrices @xmath255 @xmath256 , where @xmath257 is the total number of parameters . in the flat band - power parameterisation of the power spectra , we see from ( [ eqn : ss*2 ] ) and ( [ eqn : ss2 ] ) that @xmath130 is linear in the parameters @xmath213 . thus , the derivative matrices are simply appropriate linear combinations of the integrals @xmath258 in ( [ eqn : integrals ] ) , which are evaluated once at the start of the calculation .",
    "2 .   construction of the ( sparse ) covariance matrix @xmath259 calculation of its ( incomplete ) cholesky decomposition and solution of the linear system @xmath260 .",
    "solution of the linear systems @xmath261 where @xmath262 is a matrix of the same dimensions as @xmath228 .",
    "each column of @xmath262 is solved for using the ( incomplete ) cholesky decomposition obtained in step ( ii ) .",
    "assemble the elements of the gradient vector @xmath263.\\ ] ] 5 .",
    "assemble the elements of the curvature matrix @xmath264 6 .",
    "calculate the correction vector @xmath265 .    although it is not necessary for the newton",
    " raphson algorithm , we note that in step ( ii ) one performs all the necessary calculations to evaluate the log - likelihood function @xmath266 itself . this can be useful for checking that its value is , in fact , decreasing with each iteration . typically , the newton ",
    "raphson algorithm converges to the maximum - likelihood solution in approximately 5 iterations .",
    "the computationally most demanding calculations in each iteration are steps ( ii ) and ( iii ) above , which may be performed using either the dense or sparse matrix techniques discussed in the previous section .",
    "as mentioned in section  [ evalmulti ] , for a visibility data vector @xmath88 of length 5000 , the calculation in step ( ii ) of the ( incomplete ) cholesky decomposition requires approximately 5 min of cpu time for the dense matrix lapack routines and about 30 sec for the sparse matrix algorithm .",
    "the subsequent solution of the linear system @xmath260 then requires about 0.25 sec or 0.5 sec respectively .",
    "thus , it would clearly be faster to use the sparse matrix technique in step ( ii ) .    in step ( iii ) , however",
    ", one must solve a large number of linear systems , namely one for each column of @xmath262 for @xmath267 , using the ( incomplete ) cholesky decomposition calculated in step ( ii ) . even assuming the sky emission is due only to the cmb , the total number of linear systems is @xmath268 , where @xmath211 is the length of the data vector @xmath88 and @xmath269 is the number of spectral bins in which one wishes to calculate the cmb power spectrum . for a compact vsa observation of a single field , @xmath270 and @xmath204 , and",
    "so one must solve @xmath271 linear systems .",
    "solving each system requires around 0.5 sec of cpu time using the sparse conjugate - gradient algorithm , but only 0.25 secs using the lapack dense matrix routines . taking step ( ii ) and step ( iii ) together",
    ", it is therefore faster to use the lapack routines , which require a total of about 3.5 hrs cpu time to complete these steps .",
    "the remaining steps ( iv )  ( vi ) require only around 0.5 hr of cpu time , so that a full newton  raphson iteration takes around 4 hrs .",
    "since 5 iterations of the newton ",
    "raphson algorithm are typically required for convergence , the total cpu to calculate the maximum - likelihood solution is around 20 hrs .",
    "we note that bond , jaffe & knox ( 1998 , 2000 ) propose a variant of the newton ",
    "raphson algorithm , in which steps ( v ) and ( vi ) are different .",
    "in particular , the correction vector in step ( vi ) is replaced by @xmath272 where the _ fisher matrix _",
    "@xmath273 is the expectation value of the curvature matrix . from ( [ eqn : logcurv ] ) , the fisher matrix has the elements @xmath274 thus , step ( v ) above is replaced by @xmath275 comparing the expressions for @xmath276 and @xmath277 we see that some saving is made by using the latter . from ( [ eqn : fisher ] ) , however , we note that the calculation of the fisher matrix still requires knowledge of the matrices @xmath262 @xmath256 calculated in step ( iii ) , which is the computationally most demanding part of the calculation .",
    "hence , the use of the fisher matrix , rather than the full curvature matrix , leads to a reduction of only around 20 mins in the cpu time required for each newton  raphson iteration .      clearly , the newton ",
    "raphson algorithm described above is computationally intensive .",
    "moreover , most time is spent is computing quantities necessary for calculating the gradient and/or curvature of the log - likelihood function . as discussed in section  [ sparsecg ] , however , the log - likelihood function itself can be calculated using the sparse preconditioned conjugate - gradient method in about one - tenth of the cpu time required by the standard lapack dense matrix routines .",
    "these observations suggest that it might be more computationally efficient to maximise the log - likelihood function using an algorithm that requires only function calls , rather than gradient and curvature information .",
    "a particularly efficient and robust estimator of this type is powell s direction - set method , which is described in detail by press et al .",
    "( 1994 ) . at each iteration",
    ", the algorithm determines a set of ` conjugate ' directions at the corresponding point @xmath213 in the parameter space , and minimises the function along each direction in turn .",
    "the method can be shown to be quadratically convergent , so that an exact quadratic form would be minimised in @xmath278 line - minimisation , where @xmath257 is the dimensionality of the parameter space .",
    "typically , each line - minimisation requires 2 or 3 function calls .",
    "thus , one would expect between @xmath279 and @xmath280 functions calls would be required to minimise an exact quadratic form .",
    "since the algorithm requires only function evaluations , one may straightforwardly employ the sparse matrix technique discussed in section  [ sparsecg ] for evaluating the log - likelihood function . assuming the sky emission to be due solely to the cmb , the dimensionality of the parameter space is simply the number of spectral bins in which one wishes to estimate the cmb power spectrum , i.e. @xmath281 . for a compact vsa observation of a single field , @xmath204 and it was found that the algorithm converged to the maximum - likelihood solution after @xmath282 evaluations of the likelihood function .",
    "this is in broad agreement with the anticipated number of function evaluations quoted above , although the presence of the term @xmath283 in the log - likelihood function ( [ likedef2 ] ) means that it is not a simple quadratic form .",
    "thus , since each function evaluation requires 30 sec of cpu time , the maximum - likelihood cmb power spectrum may be obtained in about 2.5 hrs of cpu time , which is considerably faster than the newton  raphson algorithm .",
    "we note , in passing , that the downhill - simplex minimisation algorithm ( see press et al .",
    "1994 ) was also investigated .",
    "this again uses only function calls , but it was found to converge too slowly . nevertheless , a robust technique for obtaining a accurate minimum in a reasonable amount of cpu time is first to employ powell s direction - set algorithm until it converges to some point @xmath219 in parameter space , and then to restart the minimisation process from this point using a downhill simplex .",
    "the final simplex step is then very fast and provides a robust estimate of the minimum point .",
    "this algorithm is implemented as the program maxlike in the microwave anisotropy dataset computational software ( madcow ) package ( see section  [ sec : madcow ] ) .",
    "a major disadvantage of numerically maximising the likelihood is that one remains ignorant of the global shape of the distribution .",
    "therefore , one can not calculate marginalised distributions for each parameter , in order to obtain proper confidence limits .",
    "nevertheless , one would hope that the shape of the likelihood function @xmath284 near its peak @xmath219 should be well - approximated by a gaussian , so that @xmath285 where @xmath286 is the curvature ( or hessian ) matrix given in ( [ eqn : logcurv ] ) , and the gradient term in the taylor expansion vanishes since @xmath219 is a maximum .",
    "exponentiating ( [ eqn : gausslog ] ) , we immediately recognise that covariance matrix of our errors is given simply by the inverse of the curvature matrix at the peak , @xmath287 the curvature matrix @xmath288 may be calculated directly by performing steps ( ii ) , ( iii ) and ( v ) in the newton ",
    "raphson algorithm at the maximum point @xmath219 . from section  [ nrmethod ] ,",
    "we note that , for a compact vsa observation of a single field with 10 spectral bins , this requires about 4 hrs of cpu time .",
    "however , we find that a computationally more efficient procedure is to calculate the curvature matrix numerically by performing second differences along each parameter direction",
    ". an appropriate step size is easily chosen , and the algorithm requires @xmath289 function evaluations .",
    "thus , for 10 spectral bins , one must evaluate the log - likelihood function around 70 times .",
    "using the sparse preconditioned conjugate - gradient algorithm , this requires only about 30 mins of cpu time . comparing the resulting curvature matrix with that obtained directly from ( [ eqn : logcurv ] ) , we find that each element is agrees to within 0.1 per cent",
    ". the numerical calculation of the curvature matrix and its inversion to produce the errors covariance matrix is implemented in the routine errors in the madcow package .",
    "the powell direction - set minimiser , together with the sparse preconditioned conjugate - gradient algorithm for evaluating the log - likelihood function , provides a method of obtaining the maximum - likelihood power spectrum and the errors covariance matrix in a reasonable amount of cpu time . nevertheless , by taking full advantage of the sparse nature of the visibilities covariance matrix @xmath228 and of the flat band - power parameterisation of the power spectrum , it is possible to calculate the maximum - likelihood solution in considerably less computing time .    in the flat band - power parameterisation ,",
    "one divides the observed @xmath32-range into spectral bins of width @xmath290 .",
    "this corresponds to dividing the @xmath58-plane into a set of concentric annuli in each of which the power spectrum @xmath291 of each physical component in assumed constant , and its amplitude is the parameter to be determined .",
    "a typical annulus is illustrated by the solid circles in fig .",
    "[ fig4 ] , which are overlayed on the visibilities samples shown in fig .",
    "the extent of the aperture function for a compact vsa observation of a single field is plotted as the solid disc in the figure .",
    "-plane , with which the power spectrum is assumed constant ( solid circles ) .",
    "this is overlayed on the binned visibility samples shown in fig .",
    "the aperture function is plotted as a solid disc . only visibilities lying in the region between the two dashed circles are sensitive to the level of the power spectrum in the annulus.,width=264 ]    as discussed in section  [ visdata ] , an interferometer visibility measurement is only sensitive to the underlying sky fourier modes that lie within the aperture function at that point in the @xmath58-plane .",
    "thus , only a fraction of the total number of measured visibilities are sensitive to the amplitude of the power spectrum ( of either the cmb or some foreground component ) in a particular annulus .",
    "this is illustrated in fig .",
    "[ fig4 ] , where only the visibilities lying in the region between the two dashed circles are sensitive to the level of the power spectrum in our typical annulus .",
    "thus , provided one is calculating the log - likelihood function along the ` axes ' in parameter space , so that only one parameter value is changing at any one time , the effective size of the dataset is much smaller than the total number of data points .",
    "thus , if the parameters @xmath292 are fixed , @xmath293 where @xmath294 is the _ reduced _ data vector consisting of only those visibilities sensitive to the flat band - power @xmath295 . given the geometry illustrated in fig .",
    "[ fig4 ] , the length of the reduced data vector will , in general , depend on the radius of the corresponding @xmath58-annulus , the extent of the aperture function and the positions of the measured visibilities in the @xmath58-plane . for a compact vsa observation of a single field , using @xmath296 spectral bins ( or @xmath58-annuli ) , the reduced data vector typically contains around 310 times fewer data points than the full data vector .",
    "the smaller size of the reduced data vector , as compared to the full data vector , leads to a significant increase in the speed with which the log - likelihood function can be calculated along the axes in parameter space . for the standard lapack dense matrix routines , the cost of evaluating the log - likelihood function scales as @xmath245 , where @xmath211 is the length of the data vector .",
    "thus , by using the reduced data vector , the computation time for evaluating the log - likelihood function is reduced by a factor between 30 and 1000 , depending on the annulus in question .",
    "unfortunately , the same speed - up factor is not obtained for the sparse preconditioned conjugate - gradient algorithm .",
    "this reason for this is clear from fig .",
    "since the reduced data vector contains only visibilities lying in the region between the two dashed circles , the corresponding sparsity fraction @xmath172 , will increase significantly .",
    "since the sparse matrix algorithm scales as @xmath246 , the log - likelihood evaluation is speed up only by a factor between 460 , depending on the annulus .",
    "nevertheless , for a compact vsa observation of a single field , the sparse matrix approach is still about a factor of 3 times faster in evaluating the log - likelihood function than the lapack dense matrix algorithm , when timings are averaged over the 10 spectral bins .",
    "the speed - up outlined above is only possible when one varies only a single parameter @xmath295 , while keeping the others fixed .",
    "thus , one can not use a general minimisation algorithm such as the newton ",
    "raphson or powell direction - set method , since these perform iterations of the form @xmath297 where @xmath249 may be in some general direction in parameter space .",
    "a straightforward solution is provided , however , simply by using a restricted version the powell direction - set algorithm in which the ` conjugate ' directions are forced to remain along the parameter axes . starting with some initial",
    "guess @xmath247 for the solution , this procedure is equivalent to performing , in turn , independent line - minimisations along each parameter axis , while keeping the other parameters fixed at their initial values .",
    "one then updates the whole solution vector and repeats the process until convergence is obtained .",
    "it was found that the likelihood function was sufficiently structureless that this restricted ` powell ' algorithm still converged in around @xmath280 functions evaluations , where @xmath257 is the number of parameters @xmath213 .",
    "for a compact vsa observation of a single field , with 10 spectral bins , the maximum - likelihood power spectrum is obtained in about 10 mins of cpu time using the sparse matrix evaluation of the log - likelihood function , or about 45 mins using standard lapack dense matrix routines . in both cases , this is clearly faster than either of the methods discussed in section  [ nummax ] , and is hence our method of choice for determining the maximum - likelihood power spectrum from the current generation of cmb interferometers .",
    "the sparse and dense matrix versions of the algorithm are implemented respectively in the programs spfastlike and lafastlike in the madcow package .",
    "once the maximum - likelihood solution @xmath219 has been obtained , it still remains to calculate the errors on our estimated flat band - powers .",
    "one can , of course , simply calculate the curvature matrix @xmath298 numerically , in the manner discussed in section  [ esterrors ] , which requires about 30 mins of cpu time for a compact vsa observation of a single field , with 10 spectral bins .",
    "this approach does , however , assume that the likelihood function is well - approximated by a gaussian near its peak , and leads to symmetric error bars on our estimated parameter values .",
    "this may not , in fact , be a valid approximation , especially for poorly constrained parameters .",
    "an alternative approach is to make use of the fact that it is usual to choose the width @xmath290 of the spectral bins to correspond to the characteristic width of the aperture function in the @xmath58-plane .",
    "let us suppose that the sky emission is due only to the cmb . in this case ,",
    "all the flat band - power estimates @xmath219 will be close to uncorrelated .",
    "this is equivalent to the eigenvectors of @xmath298 lying close to the directions of the axes in parameter space , and the off - diagonal elements being very small as compared with those on the leading diagonal . in this case ,",
    "a better representation of the errors on our estimates is obtained by evaluating the log - likelihood function along each parameter direction in turn , through the point @xmath219 .",
    "thus is illustrated in fig .",
    "[ fig5 ] . in the ideal case , where the parameters @xmath295 @xmath256 are independent",
    ", the resulting curves would be the marginal distributions of each parameter .",
    ".,width=245 ]    in order to obtain accurate confidence intervals on each parameter , it is best to calculate the log - likelihood function at a large number of points along each parameter direction .",
    "although , using the reduced data vector approach discussed above , it is relatively cheap to evaluate the log - likelihood function along each parameter direction ( while keeping the other parameters fixed ) , if one desires more than around 100 points along each direction , a more efficient procedure is to rotate to the signal - to - noise eigenbasis for each parameter @xmath295 in turn , as discussed in appendix  [ sec : appndx : eigen ] .",
    "once this rotation has been performed for a given parameter @xmath295 , the log - likelihood function can be calculated at a large number of points along this parameter direction at virtually no additional computational cost .",
    "rotating to the signal - to - noise eigenbasis requires the solution of a generalised eigenproblem of dimension equal to the length of the reduced data vector @xmath294 for each parameter . in the absence of a stable sparse matrix implementation of this algorithm ,",
    "a standard lapack subroutine was used to perform the calculation . for a compact vsa observation of a single field , with 10 spectral bins",
    ", the entire calculation requires about 30 mins of cpu time .",
    "this approach is implemented as the routine eigenlike in the madcow package .",
    "in fact , the routine eigenlike may be used in isolation to obtain both the maximum - likelihood solution @xmath219 , and the likelihood functions along each parameter direction passing through the maximum . starting with some initial",
    "guess @xmath247 one performs a single ` iteration ' by calculating the likelihood functions along the parameter directions through @xmath247 .",
    "the peak position of the likelihood in each direction is then used to update the solution vector and the process is repeated until it converges . for observations of a single field convergence",
    "is usually achieved after only 3 iterations .",
    "thus , for a compact vsa observation of a single field , with 10 spectral bins , the full calculation requires about 1.5 hrs of cpu time .",
    "this is clearly slower than using spfastlike or lafastlike , but provides a useful cross check of one s results , since it uses entirely different computational subroutines .      for illustration",
    ", we assumed above that the sky emission was due solely to cmb fluctuations , without any contaminating galactic foreground emission .",
    "let us now suppose instead that there is , in fact , substantial foreground emission coming from ( say ) a single galactic component .",
    "if multifrequency observations are available , one may calculate the maximum - likelihood solution @xmath219 for the cmb and galactic flat band - powers in each spectral bin , using any of the techniques outlined above .",
    "suppose the parameters @xmath295 and @xmath299 correspond respectively to the cmb and galactic flat band - powers in the @xmath99th spectral bin .",
    "if the bin width corresponds to the extent of the aperture function , these two parameters will be quasi - uncorrelated with the remaining ones , but the parameters @xmath295 and @xmath299 themselves will be strongly correlated since they refer to the same spectral bin . nevertheless , the routine eigenlike provides a natural method for marginalising over the flat band - power of the galactic ( or cmb ) component in each bin . keeping the parameters",
    "@xmath300 ( @xmath301 and @xmath302 ) fixed , one can calculate the log - likelihood function in the two - dimensional @xmath303-space by performing a signal - to - noise eigenmode rotation at each required value of @xmath299 ( say ) , and calculating the variation with respect to @xmath304 at almost no extra computational cost .",
    "one can then perform a numerical integration over @xmath295 or @xmath299 , thereby obtaining a marginalised likelihood function for the other parameter .",
    "the microwave anisotropy dataset computational software ( madcow ) package consists of the 5 programs maxlike , errors , spfastlike , lafastlike and eigenlike , which are discussed above .",
    "the first three programs are based on the sparse matrix conjugate - gradient algorithm for calculating the log - likelihood function , discussed in section  [ sparsecg ] , whereas the last two programs calculate the log - likelihood function using lapack subroutines .",
    "all the above programs have been parallelised using mpi , in order that they may be run on distributed - memory parallel machines .",
    "the parallelisation of the routines lafastlike and eigenlike makes use of the scalapack parallel version of the lapack library .",
    "the speed of both routines is found to scale linearly with the number of processors up to the maximum of 8 cpus available on the linux beowulf cluster at our disposal .",
    "the parallelisation of the spare matrix programs maxlike.c , errors.c and spfastlike.c is less straightforward , since existing parallel versions of the relevant routines are not available .",
    "some parallelisation of the algortihms has been performed , but the resulting programs do not scale as effectively as those using lapack routines . a method of achieving linear scaling of the sparse matrix algorithm is currently under investigation .",
    "a @xmath305-test version of the madcow package may be downloaded from http://www.mrao.cam.ac.uk / software / madcow/.",
    "as an illustration of our maximum - likelihood methods , in this section we apply them to simulated vsa observations .",
    "the vsa is a 14-element radio interferometer , which is capable of operating at frequencies between 26 and 36  ghz .",
    "the vsa is currently observing at a frequency of 34.1  ghz .",
    "its observing bandwidth is 1.5  ghz , and the system temperature about 25 - 35  k. the telescope can observe in two different configurations : the compact array uses corrugated horn - reflector antennas of 14.3  cm diameter and baselines up to 1.5  m , and the extended array consists of 32.2-cm horns with baselines up to about 3  m. we base our simulations on the compact array with the actual antenna arrangement as of june  2001 , as shown in fig .",
    "[ fig : table ] .",
    "the primary ( power ) beam has a fwhm of 4.6 degrees at 34.1  ghz and can be well approximated by a gaussian ( fig .",
    "[ fig : beam ] ) .",
    "we simulate vsa observations of three fields centred on @xmath306 , @xmath307 , @xmath308 , @xmath309 and @xmath310 , @xmath311 ( the vsa1 , vsa1a and vsa1b fields respectively ) .",
    "real vsa observations of these fields ( and others ) have been completed and are currently being analysed .",
    "the @xmath58-coverage for a 5  h - observation of the vsa1 field was shown in fig .",
    "[ fig1](c ) .",
    "the antenna arrangement yields a reasonably uniform sampling in the multipole region @xmath312 .    in order to simulate an observation of cmb fluctuations ,",
    "we first create a @xmath313 array of fourier modes , the real and imaginary parts of which are drawn from a gaussian distribution with a variance given by a theoretical power spectrum corresponding to a standard inflationary cdm model with a hubble parameter @xmath314  65  km  s@xmath66 mpc@xmath66 and a fractional baryon density @xmath67 .",
    "the model is spatially - flat with @xmath68 and @xmath315 , a primordial scalar spectral index @xmath316 and no tensor modes .",
    "the spectrum is normalised such that @xmath317k .",
    "the theoretical @xmath318 spectrum is plotted in fig .  [ fig : trueps ] , and the actual realisation of the cmb fourier modes were plotted in fig .",
    "[ fig1](a ) .    these fourier modes are inverse fourier - transformed to obtain the corresponding cmb anisotropies on the sky .",
    "this array is then multiplied by the telescope primary beam and fourier transformed to give a regular array in the visibility plane ( see fig .  [ fig1](b ) ) . a vsa observation is then simulated by sampling the regular array at the required points in the @xmath58-plane using a bilinear interpolation . the @xmath58-positions at which the visibilities are sampled correspond to a 64-s integration per visibility ( see fig .  [",
    "fig1](c ) ) .",
    "instrumental noise on the data is simulated by adding to each visibility a random complex number for which the real and imaginary parts are drawn from a gaussian distribution with an _ rms _ of 3.5  jy . since the measured vsa noise level of about 240  jy/@xmath319/baseline , this corresponds to @xmath320 70 days of 5-h observations .",
    "this is the time typically spent on each vsa field during the first year of vsa observations between september  2000 and august  2001 .",
    "these simulated vsa data typically contain @xmath321 64-s visibility samples per day of observation .",
    "these visibilities are binned as discussed in section  [ sec : binning ] , with a bin size of @xmath322  wavelengths .",
    "it was checked that gridding with cell sizes @xmath323 did not significantly affect the final derived cmb power spectrum . the binned data",
    "are then analysed using the maximum - likelihood techniques described in section  [ sec : likeanalysis ] .",
    "the results presented below were obtained using the program eigenlike in the madcow package .",
    "we note that , for illustration , in these simulations we have restricted ourselves to the case in which the sky emission is due solely to cmb fluctuations , without any contaminating foreground emission .",
    "neglecting foregrounds provides a convenient way of illustrating the general method , since only one observing frequency is required , and one need not include the flat band - powers of the galactic power spectrum as parameters in our analysis .",
    "also , in practice , at the observing frequency of the vsa galactic contribution can be largely ignored , because the emission coming from galactic dust and free - free radiation is minimal .",
    "moreover , vsa fields are chosen to lie in regions of low galactic emission .",
    "nevertheless , as presented in section  [ sec : likeanalysis ] , the maximum - likelihood methods implemented in the madcow package can easily accommodate the presence of diffuse galactic foregrounds .",
    "indeed , when multifrequency data are available , one may obtain estimates of the power spectra of both the cmb and the galactic foreground emission .",
    "we first consider the case where the power spectrum is estimated from only the simulated observations of the single field vsa1 .",
    "the flat band - powers have been estimated in 10 spectral bins of width @xmath324 between @xmath325 and @xmath326 .",
    "the resulting likelihood function evaluated along the parameter directions through the maximum point @xmath219 are plotted as the greyscale bands in fig .",
    "[ fig : likevsa1 ] .",
    "dark areas indicate high likelihoods .",
    "the extension of the shaded areas reflects the uncertainty in the estimated parameters .",
    "as expected , the uncertainty is larger in the poorly sampled lower and higher @xmath0bins , where the telescope sensitivity is low . on the other hand ,",
    "the fairly well sampled multipoles around @xmath327 can be determined more accurately .",
    "all reconstructed band powers are consistent with the theoretical input power spectrum .",
    "the bin width was chosen to be equal to the @xmath72-diameter of the fourier transform of the primary beam .",
    "thus , adjacent bins are only mildly correlated .",
    "indeed , on calculating the curvature matrix @xmath298 one finds that adjacent bins are anti - correlated at only the 15 per cent level .    on repeating the likelihood analysis for different realisations of the simulated noise",
    ", it is found that results are always consistent with the input spectrum and with one another .",
    "it was further verified that approximating the primary beam by a gaussian of the same fwhm does not distort the resulting power spectrum .",
    "moreover , the results were unaffected by ignoring the finite bandwidth of the receivers and assuming a single observing frequency in the centre of the band .",
    "we now turn to the simultaneous analysis of observations of the three fields vsa1 , vsa1a and vsa1b .",
    "since these fields overlap on the sky , the corresponding visibilities are thus correlated . the resulting likelihood function evaluated along the parameter directions through the maximum point @xmath219",
    "are plotted as the greyscale bands in fig .",
    "[ fig : likevsa1ab ] .",
    "although mosaicing is often used to improve the instrumental resolution in @xmath0-space , we have chosen to compute the power spectrum in the same bins as for the single field reconstruction , in order to facilitate a direct comparison . moreover , owing to the relatively small size of the compact vsa horns , the the aperture function is already sufficiently narrow to provide the @xmath0-resolution necessary to resolve the expected acoustic peak structure in the cmb power spectrum .",
    "as expected , the uncertainty on the flat band - powers has been significantly reduced , particularly in the poorly sampled multipole regions . moreover ,",
    "the anti - correlation between adjacent bins has reduced to around the 10 per cent level .",
    "in this paper , we have investigated maximum - likelihood methods for estimating the power spectrum of the cosmic microwave background ( cmb ) from interferometer observations . in particular , we have considered the computational efficiency of several techniques for obtaining flat - band power estimates in a number of spectral bins , together with confidence limits on the power in each bin . for multifrequency data , one may also estimate the flat band - powers of galactic foreground emission in each spectral bin .",
    "the methods developed may be applied to single - field or mosaiced observations , and take proper account of non - coplanar baselines .",
    "the sparse nature of the covariance matrix for visibility data allows the use of sparse matrix techniques which significantly reduce the computational burden of evaluating the likelihood function , as compared with standard dense matrix routines .",
    "this enables the maximum - likelihood solution to be obtained more efficiently by numerically maximising the likelihood using only function values , as opposed to more traditional techniques , such as the newton  raphson algorithm , which rely on gradient and curvature information .",
    "we also find the covariance matrix of the errors on the parameters is most efficiently calculated using a numerical second - differencing approach , rather than direct calculation of the analytic expression for the curvature matrix .",
    "the speed with which the likelihood function is calculated may be further increased by making use of the fact that only a small fraction of the total number of observed visibilities are sensitive to the flat band - power in any one spectral bin . using",
    "this reduced data - set for each parameter enables very fast evaluation of the likelihood function along the ` axes ' in parameter space .",
    "indeed , we find that performing independent line - maximisations of the likelihood function along these parameter directions , and iterating until convergence , provides the computationally most efficient way of obtaining the maximum - likelihood solution .    if the spectral bins are chosen to be sufficiently wide that the flat band - powers are quasi - uncorrelated parameters , one may dispense with the gaussian approximation to the likelihood function near its peak , and obtain ( generally asymmetric ) confidence intervals on each parameter by calculating the likelihood function along each parameter direction through the maximum likelihood point .",
    "this is best achieved by performing a single - to - noise eigenmode rotation for each parameter .",
    "indeed , this method can itself be used to arrive at the maximum - likelihood solution .",
    "this is illustrated by application to simulated observations by the very small array in its ` compact ' configuration .",
    "if multifrequency data are available , this technique may also be used to marginalise over the flat band - power of foreground galactic emission in each spectral bin .",
    "km acknowledges support from an eu marie curie fellowship .",
    "anderson e. et al . , 1999 ,",
    "lapack users guide , 3rd ed .",
    "siam , philadelphia baker j.c .",
    ", 1999 , mnras , 308 , 1173 bond j.r . , 1995 , phys .",
    "lett . , 74 , 4369 bond j.r . ,",
    "jaffe a.h .",
    ", knox l. , 1998 , phys .",
    "d , 57 , 2117 bond j.r . , jaffe a.h . , knox l. , 2000 , apj , 2000 , 533 , 19 borrill j. , 1999 , proceedings of the 5th european sgi / cray mpp workshop , astro - ph/9911389 cornwell t.j . , 1988 , a&a , 202 , 316 cornwell t.j . , perley r.a .",
    ", 1992 , a&a , 261 , 353 cornwell t.j . ,",
    "holdaway m.a .",
    ", uson j.m . , 1993 ,",
    "a&a , 271 , 697 christensen n. , meyer r. , knox l. , luey b. , 2001 , classical and quantum gravity , 18 , 2677 eaton m.l . , 1983 , multivariate statistics .",
    "wiley , new york ekers r.d .",
    ", rots a.h . , 1979 , in van schooneveld c. , ed .",
    ", assl vol .",
    "76 : iau colloq .",
    "49 : image formation from coherence functions in astronomy .",
    "reidel publishing co. , p.  61",
    "gradstheyn i.s . ,",
    "ryzhik i.m . , 1994 , table of integrals , series and products , 5th edition , alan jeffrey ed .",
    "academic press greenbaum a. , 1997 , iterative methods for solving linear systems .",
    "siam , philadelphia halverson n.w .",
    "et al . , 2001 ,",
    "astro - ph/0104489 hobson m.p . ,",
    "lasenby a.n . ,",
    "jones m.e . , 1995 , mnras , 275 , 863 hobson m.p . , magueijo j. , 1996 , mnras , 283 , 1133 holdaway m.a . , 1999 , in asp conf .",
    "180 : synthesis imaging in radio astronomy ii , p.  401",
    "jones m.e .",
    ", 1990 , ph.d .",
    "thesis , university of cambridge jones m.e .",
    ", 1997 , in bouchet f.r .",
    ", gispert r. et al , eds . ,",
    "microwave background anisotropies , xvith moriond astrophysics meeting .",
    "editions frontieres , p.  161",
    "jones m.e . ,",
    "scott p.f . , 1998 , in trn thanh vn j. et al . , eds . , proceedings of xxxiiird rencontres de moriond , fundamental parameters in cosmology , editions frontieres , p.  233",
    "leitch e.m .",
    "et al . , 2001 , astro - ph/0104488 maisinger k. , hobson m. p. , lasenby a. n. , 1997 , mnras , 290 , 313 mather j.c .",
    ", 1994 , apj , 420 , 439 osullivan c. et al . , 1995 , mnras , 274 , 861 padin s. et al . , 2001 ,",
    "apj , 549 , l1 pearson t.j .",
    "et al . , 2000 , iau symposium 201 , e2 perley r.a . , 1999 , in _",
    "synthesis imaging in radio astronomy ii _ , eds . taylor g. b. et al . , asp conference series , vol .",
    "180 , p.  383",
    "press w.h .",
    ", teukolsky s.a . , vetterling w.t .",
    ", flannery b.p . , 1994 ,",
    "numerical recipies in fortran 77 , cup , cambridge rusholme b. , 2001 , ph.d .",
    "thesis , university of cambridge scott p.f .",
    "et al . , 1996 ,",
    "apj , 461 , l1 smoot g. et al . , 1992 ,",
    "apj , 396 , l1 taylor a.c . , 2000 , iau symposium 201 , e5 taylor a.c .",
    ", grainge k. , jones m.e .",
    ", pooley g.g . , saunders r. , waldram e.m .",
    ", 2001 , mnras , 327 , l1 tegmark m. , taylor a.n . , heavens a.f . , 1997 , apj , 480 , 22 thompson a. r. , moran j. m. , swenson g. w. , 1994 , interferometry and synthesis in radio astronomy .",
    "krieger publishing company , new york white m. , carlstrom j.e . , dragovan m. , holzapfel w.l . , 1999 ,",
    "apj , 514 , 12 white m. , carlstrom j. , dragovan m. , holzapfel s.w.l . , 1999 , astro - ph/9912422",
    "the contribution @xmath50 of the sky signal to the measured visibility @xmath328 is given simply by the convolution of the underlying fourier modes @xmath55 with the aperture function @xmath135 , which is itself the fourier transform of the primary beam @xmath53 of a single antenna .",
    "assuming that the @xmath62th visibility is measured at the position @xmath59 in the @xmath58-plane and at a frequency @xmath118 , we may therefore write @xmath329 if we write the functions @xmath135 and @xmath55 in terms of their real and imaginary parts , @xmath330 we quickly find that the real and imaginary parts of @xmath121 are given by @xmath331 , \\nonumber\\\\ { \\cal s}^{(i)}_j & = &   \\int\\!\\!\\!\\int\\!{\\rm d}^2\\bmath{u}\\ , \\left [ \\tilde{a}_r(\\bmath{u}_j-\\bmath{u},\\nu_j)a_i(\\bmath{u},\\nu_j ) + \\tilde{a}_i(\\bmath{u}_j-\\bmath{u},\\nu_j)a_r(\\bmath{u},\\nu_j ) \\right ] .",
    "\\label{eqn : sigvisri}\\end{aligned}\\ ] ] we note that if the antenna function @xmath139 is real , then @xmath332 depends only on the real parts @xmath333 of the underlying fourier modes of the sky , and similarly @xmath334 depends only on @xmath335 . if the primary beam @xmath53 is real and even , then @xmath139 is also real and even",
    ".    the elements of the constituent submatrices of the signal covariance matrix @xmath130 , introduced in equation  ( [ eqn : smatdef ] ) , are most conveniently written as @xmath336,\\nonumber\\\\ s_{ij}^{(i , i ) }   \\equiv   \\phantom{s}\\langle { \\cal s}^{(i)}_i{\\cal s}^{i)}_j \\rangle   & = &   \\tfrac{1}{2 } [ \\re(\\langle { \\cal s}_i { \\cal s}_j^\\ast \\rangle ) -    \\re ( \\langle { \\cal s}_i { \\cal s}_j\\rangle ) ] , \\nonumber\\\\ s_{ij}^{(r , i ) }   \\equiv   \\phantom{s}\\langle { \\cal s}^{(r)}_i{\\cal s}^{i)}_j \\rangle   & = &   \\tfrac{1}{2 } [ -\\im(\\langle { \\cal s}_i { \\cal s}_j^\\ast \\rangle ) +    \\im ( \\langle { \\cal s}_i { \\cal s}_j\\rangle ) ] , \\nonumber\\\\ s_{ij}^{(i , r ) }   \\equiv   \\phantom{s}\\langle { \\cal s}^{(i)}_i{\\cal s}^{r)}_j \\rangle   & = &   \\tfrac{1}{2 } [ \\im(\\langle { \\cal s}_i { \\cal s}_j^\\ast \\rangle ) +    \\im ( \\langle { \\cal s}_i { \\cal s}_j\\rangle ) ] , \\label{eqn : sigcovelem}\\end{aligned}\\ ] ] where @xmath337 and @xmath338 denote the real and imaginary parts of the , in general , complex quantities @xmath339 and @xmath340 , which are given by @xmath341 by definition , the matrix @xmath144 is hermitian and @xmath150 is symmetric .",
    "similarly , each of the constituent submatrices @xmath342 and @xmath343 is , by definition symmetric .",
    "it is also straightforward to show that @xmath344 , so that , as expected , the full covariance matrix @xmath130 is symmetric .",
    "moreover , from  ( [ eqn : sigvisri ] ) , we see that , if the aperture function @xmath135 is real , and the real and imaginary parts of the underlying fourier modes @xmath55 are uncorrelated , the elements of the off - diagonal submatrices @xmath345 and @xmath346 are all zero . thus , in this case , the full covariance @xmath130 becomes block diagonal .",
    "if the sky emission is due to @xmath14 physical components , then @xmath35 moreover , if we assume the spectral index of each component does not vary across the observed field , then we can describe the frequency variation of each component through the functions @xmath37 @xmath38 . in this paper , we take the reference frequency @xmath39 ghz and normalise the frequency dependencies so that @xmath40 for all physical components .",
    "if the emission from each physical component is statistically isotropic over the observed field and no correlations exist between the components , and using that fact that the sky is real , the fourier modes have mean zero and their covariance properties are given by @xmath347^\\ast \\rangle    & = & c^{(p)}(\\rho,\\nu_0)f_p(\\nu)f_{p'}(\\nu ' ) \\delta_{pp ' } \\delta(\\bmath{u}-\\bmath{u}'),\\nonumber \\\\",
    "\\langle a^{(p)}(\\bmath{u},\\nu ) a^{(p')}(\\bmath{u}',\\nu ' ) \\rangle    & = & c^{(p)}(\\rho,\\nu_0)f_p(\\nu)f_{p'}(\\nu ' ) \\delta_{pp ' } \\delta(\\bmath{u}+\\bmath{u } ' ) , \\label{eqn : fouriercov}\\end{aligned}\\ ] ] where @xmath31 and @xmath43 is the ensemble - average power spectrum of the @xmath21th physical component at the reference frequency @xmath24 .",
    "if correlations are known _ a priori _ to exist between physical components , then the expressions ( [ eqn : fouriercov ] ) can be straightforwardly generalised to include them .",
    "assuming no correlations exist , however , we find that the covariance structure of the fourier modes of the total sky emission is given by @xmath348 where we have introduced the _ generalised power spectrum _",
    "@xmath136 , which is defined by @xmath349 we note , in particular , that if the aperture function satisfies @xmath350 , which corresponds to a real primary beam @xmath53 , then @xmath351 thus , in this case , one need only evaluate @xmath352 and use the result  ( [ eqn : equivcov ] ) in order to construct the full signal covariance matrix @xmath130 , whose elements are defined in  ( [ eqn : sigcovelem ] ) .",
    "if we introduce polar coordinates @xmath142 into the @xmath58-plane , we can write  ( [ eqn : sigcorr1 ] ) and  ( [ eqn : sigcorr2 ] ) formally as the one - dimensional integrals @xmath353 where the _ window functions _ @xmath147 and @xmath148 are defined respectively by @xmath354 and @xmath143 . in the case where @xmath355 , one need only evaluate @xmath147 and use ( [ eqn : equivcov ] ) and  ( [ eqn : sigcovelem ] ) to construct @xmath130 .",
    "for mosaiced observations , the pointing centres of individual observations are not identical with the global phase  tracking centre . this can be accommodated by shifting the primary beam response pattern @xmath75 to the corresponding pointing centre .",
    "thus , let us assume that the @xmath62th visibility is measured at the position @xmath59 in the @xmath58-plane , at an observing frequency @xmath118 , and is referred to the pointing centre @xmath356 . in this case , the expression corresponding to  ( [ visdef ] ) becomes @xmath357 where the second equality follows from the fourier shift theorem .",
    "this illustrates that the effect of mosaicing is simply to introduce a phase shift , so that the _ effective _ aperture function for the @xmath62th field becomes @xmath358 which is , in general , complex .",
    "the covariance properties of the visibilities may then be obtained straightforwardly from the expressions given in appendix  [ sec : appndx : covariance ] , by replacing @xmath135 with @xmath153 given in  ( [ eqn : effapermos ] ) . in this case , however , the corresponding window functions  ( [ eqn : winfcn1 ] ) and  ( [ eqn : winfcn2 ] ) will also be functions of @xmath359 and @xmath356 .",
    "in particular , we find @xmath360 we note that , if the primary beam @xmath361 is real , then the effective aperture function  ( [ eqn : effapermos ] ) still satisfies @xmath362 . thus , ( [ eqn : equivcov ] ) remains valid and one need only evaluate @xmath339 ( and hence @xmath147 ) to construct @xmath130 .    although the above description of mosaicing is straightforward , additional subtleties exist in practice , since interferometers such as the vsa do not refer the phases of all visibilities to the same constant phase - tracking centre . instead , the phases of visibilities are referred to the pointing centre of the corresponding field . in this case , the visibilities are given by @xmath363 we note that ( [ eqn : visconvshifted ] ) and  ( [ eqn : visconvshifted2 ] ) differ only by a phase shift @xmath364 $ ] .",
    "however , the vectors @xmath59 are given in different coordinate systems , referring in each case to the corresponding phase ",
    "tracking centre . from  ( [ eqn : visconvshifted2 ] ) , we see that we may obtain the covariance properties of the corresponding visibilities from the equations given in appendix  [ sec : appndx : covariance ] , provided we replace @xmath365 by the new _ effective _ aperture function for the @xmath62th field , which is given by @xmath366 and similarly for the @xmath205 term .",
    "hence , in this case , the window functions are given by @xmath367 we note that , for a real primary beam , the relation ( [ eqn : equivcov ] ) again holds , so that only @xmath368 ( and hence @xmath147 ) need be calculated in order to construct @xmath130 .",
    "in appendices  [ sec : appndx : covariance ] and [ sec : appndx : mosaicing ] , we have assumed that the field of view of the telescope is small enough that the @xmath74-distortions discussed in section  [ sec : wcorrections ] can be neglected . without the assumption of a small field size or vanishing @xmath74-components of the baselines ,",
    "the contribution of the sky signal to a measured visibility is given by ( e.g. thompson et al .",
    "1994 ) @xmath369 where @xmath370 is the component of the baseline in the direction of the phase  tracking centre . for convenience ,",
    "we assume that pointing and phase - tracking centres are identical .",
    "the factor @xmath371 is small ( for example , @xmath372 at an angle of @xmath373 ) .",
    "we can thus either omit the factor @xmath374 or absorb it into the definition of the primary beam @xmath53 .",
    "we obtain @xmath375 defining an effective beam @xmath376 the visibilities are @xmath377 where the fourier transform of @xmath378 is given by a convolution @xmath379 the covariance structure of the visibilities can then by found by using this expression in place of @xmath135 in the results of appendix  [ sec : appndx : covariance ] .",
    "in particular , we note that if @xmath380 , we find @xmath381 thus , in this case , the full signal covariance @xmath130 can be obtained from  ( [ eqn : sigcorr1 ] ) and  ( [ eqn : sigcovelem ] ) .",
    "let us denote the primary beam at the @xmath205th observing frequency @xmath206 by @xmath382 , where @xmath208 is the dispersion of the primary beam at this frequency .",
    "the aperture function is simply the fourier transform of the primary beam , and is given by @xmath383 . as we now show , in this case it is possible to obtain analytical formulae for the window functions @xmath147 and @xmath148 .",
    "we begin by considering the general case of mosaiced observations , but in the approximation that the visibilities can be obtained by a two - dimensional fourier transformation of the sky brightness distribution and the primary beam . in that case , from  ( [ eqn : covvsa ] ) , we have @xmath384 where all visibilities are referred to the pointing centre of the corresponding field as in  ( [ eqn : covvsa ] ) . if we introduce the vectors @xmath385 and use @xmath386 to denote the angle between @xmath387 and the position vector @xmath30 in the fourier plane , and @xmath388 the angle between @xmath52 and @xmath387 , we find that the window function can be written as @xmath389 \\exp[-2\\pi^2(\\sigma_i^2+\\sigma_j^2)\\rho^2 ] \\int_0^{2\\pi}\\!{\\rm d}\\theta\\ , \\exp[4\\pi^2|\\bmath{q}|\\rho\\cos\\theta ] \\exp[2\\pi i |\\bmath{x}| \\rho \\cos(\\theta+\\phi)].\\ ] ] the integral on @xmath386 can be written as @xmath390 \\exp[2\\pi i|\\bmath{x}| \\rho ( \\cos\\theta\\cos\\phi-\\sin\\theta\\sin\\phi ) ] = \\int_0^{2\\pi}\\!{\\rm d}\\theta\\ , \\exp[p \\cos\\theta ] \\exp[i a \\cos\\theta+i b \\sin\\theta ] , \\label{eqn : inttheta}\\ ] ] where @xmath391 , @xmath392 and @xmath393 ( compare gradshteyn & ryzhik , integrals 3.937 ) .",
    "substituting @xmath394 , @xmath395 , @xmath396 and @xmath397 , we find @xmath398 =   \\oint_{\\cal c}\\!{\\rm d}z\\,\\frac{1}{iz}\\exp\\left [ ( p + b + ia )    \\frac{z}{2 } + ( p - b + ia ) \\frac{z^{-1}}{2}\\right],\\ ] ] where the curve @xmath399 is the unit circle in the complex plane . defining @xmath400 $ ] , where @xmath401 and @xmath402 , we obtain @xmath403 where @xmath404 denotes the residue of @xmath405 around the essential singularity @xmath406 .",
    "the laurent series of @xmath407 about this point has the form @xmath408 and is given by @xmath409 = \\frac{1}{z } \\sum_{m=0}^\\infty \\frac{(az+bz^{-1})^m}{m!}\\\\ & = & \\frac{1}{z } \\sum_{m=0}^\\infty\\sum_{n=0}^m \\frac{1}{m ! } { ^m}c_n a^n",
    "b^{m - n } z^{2n - m } = \\sum_{m=0}^\\infty\\sum_{n=0}^m",
    "\\frac{1}{n!(m - n ) ! }   a^n",
    "b^{m - n } z^{2n - m-1 } , \\end{aligned}\\ ] ] from which we can read off @xmath410 where @xmath411 is the modified bessel function of the first kind and order zero for a complex argument  @xmath412 . substituting all the abbreviations , we have @xmath413 .",
    "\\label{eqn : besselarg}\\ ] ] thus , the window function is given by the ( complex ) analytical expression @xmath414 \\exp[-2\\pi^2(\\sigma_i^2+\\sigma_j^2)\\rho^2 ] i_0(2\\pi \\sqrt{k } \\rho ) , \\label{eqn : winfcnmos}\\ ] ] where @xmath415 the full signal covariance matrix @xmath130 can then be derived using  ( [ eqn : corrwin ] ) and  ( [ eqn : sigcovelem ] ) .    a useful check of our result  ( [ eqn : winfcnmos ] )",
    "is provided by the special case of a single field , for which @xmath416 , and so @xmath417 .",
    "thus , @xmath418 is given by the real integral @xmath419 = \\int_0^{2\\pi}\\!{\\rm d}\\theta\\ , \\exp[4\\pi^2|\\bmath{q}|\\rho\\sin\\theta ] = 2\\pi i_0(4\\pi^2|\\bmath{q}|\\rho).\\ ] ] therefore , in this case , the elements of the window function are given by the real expression @xmath420 \\exp[-2\\pi^2(\\sigma_i^2+\\sigma_j^2)\\rho^2 ] i_0(4\\pi^2|\\sigma_i^2\\bmath{u}_i+\\sigma_j^2\\bmath{u}_j|\\rho),\\ ] ] which is identical to setting @xmath421 in  ( [ eqn : besselarg2 ] ) .",
    "comparison with  ( [ eqn : sigcovelem ] ) shows that the offdiagonal blocks @xmath422 and @xmath423 of the signal covariance matrix vanish and real and imaginary parts of the visibilities can be treated independently .",
    "we now consider the effects of non - vanishing @xmath74-components on our expression  ( [ eqn : winfcnmos ] ) for the window function @xmath424 . from",
    "( [ eqn : effbeamw ] ) , for a gaussian primary beam of width @xmath425 , the effective primary beam is given by @xmath426 .",
    "on fourier transforming , we obtain the effective aperture function @xmath427 where @xmath428 and @xmath429 .",
    "we see that the effect of the @xmath74distortion can be considered as turning the primary beam into a complex gaussian , whose fourier transform is again a complex gaussian .",
    "this can easily be taken into account in the analysis from section  [ sec : appndx : gaussian2d ] by replacing @xmath430 in ( [ eqn : winfcnmosinit ] ) .",
    "for the angular integration ( [ eqn : inttheta ] ) , we then have to use the vectors @xmath431 instead of ( [ eqn : defwx ] ) .",
    "the final expression for the window function @xmath147 is @xmath432 where now @xmath433 as in  ( [ eqn : besselarg2 ] ) , but with @xmath387 and @xmath52 defined in ( [ eqn : newdefwx ] ) , and @xmath434 with @xmath435 .",
    "furthermore , we note that , @xmath436 , and so  ( [ eqn : equivcovw ] ) is satisfied .",
    "thus , the full signal covariance @xmath130 can be obtained from  ( [ eqn : equivcovw ] ) and  ( [ eqn : sigcovelem ] ) .",
    "as discussed in section  [ esterror2 ] , it is useful to calculate the log - likelihood function along each coordinate direction in parameter space . in other words ,",
    "one wishes to calculate the log - likelihood as a function of a single parameter @xmath295 , while the remaining parameters are kept fixed ; we denote this by @xmath437 .",
    "in fact , as shown in section  [ evalaxes ] , for interferometer data one may replace the full data vector , @xmath88 , with a reduced data vector @xmath294 that contains only those visibilities sensitive to changes in the flat band - power @xmath295 .",
    "hence , for various values of @xmath295 , one must evaluate @xmath438.\\ ] ] this calculation is neatly performed by using the method of signal - to - noise eigenmodes , which are a special case of karhunen - loeve modes , where the parameter dependence is linear ( affine ) ( bond 1995 ; bond , jaffe & knox 1998 ; tegmark , taylor & heavens 1997 ) .",
    "the covariance matrix @xmath215 contains contributions from the sky signal and the noise .",
    "since the parameters are flat band - powers in spectral bins , we can write the signal contribution as @xmath439 where @xmath440 denotes collectively the fixed parameters @xmath299 @xmath441 . hence , @xmath442 depends only on the parameter of interest and @xmath443 depends only on the ( fixed ) values of the other parameters , and is hence a fixed matrix .",
    "moreover , the matrix @xmath442 is linear in @xmath295 , since it is simply a flat band - power , and so we may write @xmath444 , where the fixed matrix @xmath445 . thus the total covariance matrix can be written as @xmath446 where @xmath447 is the fixed ` unit signal ' covariance matrix and @xmath448 is the fixed ` generalised noise ' matrix .",
    "since @xmath447 and @xmath448 are both real symmetric matrices , they can be diagonalised simultaneously by a single similarity transformation .",
    "this is most easily achieved by solving the generalised eigenproblem @xmath449 let us denote the corresponding eigenvalues by @xmath450 and the eigenvectors by @xmath451 , which are normalised such that @xmath452 . if we now define a new set of ` rotated ' data by @xmath453 , then it is straightforward to show that these new variables are uncorrelated for _ any _ value of the parameter @xmath295 , and have a covariance matrix with elements @xmath454 the @xmath455 called the signal - to - noise eigenmodes , and each is a linear combination of the original data items .",
    "modes corresponding to a large eigenvalue are expected to be well - determined , while modes with small eigenvalues are poorly - determined and do not contribute significantly to the value of the likelihood function .    from ( [ eqn :",
    "uncorrl ] ) , we see that the log - likelihood , as a function of the parameter @xmath295 ( with the others held fixed ) is given simply by @xmath456.\\ ] ] this is trivial to evaluate and so the log - likelihood function can be calculated at a large number of points along in @xmath295-direction at virtually no extra computational cost ."
  ],
  "abstract_text": [
    "<S> a maximum - likelihood method is presented for estimating the power spectrum of anisotropies in the cosmic microwave background ( cmb ) from interferometer observations . </S>",
    "<S> the method calculates flat band - power estimates in separate bins in @xmath0-space , together with confidence intervals on the power in each bin . for multifrequency data , the power spectrum of the other foreground components </S>",
    "<S> may also be recovered . </S>",
    "<S> advantage is taken of several characteristic properties of interferometer data , which together allow the fast calculation of the likelihood function . </S>",
    "<S> the method may be applied to single - field or mosaiced observations , and proper account can be taken of non - coplanar baselines . </S>",
    "<S> the method is illustrated by application to simulated data from the very small array .    </S>",
    "<S> = = = = = = = =    # 1 # 1 # 1 # 1 @mathgroup@group @mathgroup@normal@groupeurmn @mathgroup@bold@groupeurbn @mathgroup@group @mathgroup@normal@groupmsamn @mathgroup@bold@groupmsamn = `` 019 = ' ' 016 = `` 040 = ' ' 336 = \" 33e = = = = = = = =    # 1 # 1 # 1 # 1 = = = = = = = =    # 1#2#1 # 2 # 1#2#3 ^ 2 # 1 # 2 # 3 # 1#2 ^ 2 # 1 # 2 ^ 2 # 1#2    [ firstpage ]    cosmic microwave background  methods : data analysis  methods : statistical . </S>"
  ]
}