{
  "article_text": [
    "the numerical simulation of photonic crystals ( pcs ) has become a very active field over the past twenty years , and this interest has only grown with the emergence of the related field of metamaterials . a common problem in electromagnetic simulations of pcs and pc waveguides is the termination of a domain inside the crystal .",
    "this requires a boundary condition that can absorb the bloch eigenmodes of the particular pc or pc waveguide .",
    "one attempt to reduce the reflections from the boundaries of pc waveguides involves terminating the domain with a distributed bragg reflector waveguide  @xcite ( basically a bragg reflector pc waveguide with a wavenumber that matches the original pc waveguide ) .",
    "there have been several other attempts to solve this problem using perfectly matched layers  @xcite ( pmls ) of different varieties to absorb crystal eigenmodes .",
    "these methods must be distinguished between those that use a simple pml for absorption  @xcite and those that apply a pml to the same pc structure that they are attempting to terminate  @xcite , known as a pcpml .",
    "although sophisticated applications of a pcpml can terminate boundaries with reflections of @xmath0 , adding the pcpml to the simulation domain increases the size of the total domain , adding to the computational expense of the simulation .    for electromagnetic eigenmodes that evolve harmonically in the direction of propagation ( plane waves , simple waveguides )",
    "there is already a well known method for terminating the domain .",
    "it involves imposing a mixed boundary condition relating the derivative of the field in the direction normal to the boundary to the amplitude of the field , @xmath1 , where @xmath2 is the field and @xmath3 is the wavenumber of the plane wave or waveguide mode .",
    "this boundary condition can be generalized to absorb multiple eigenmodes of the system  @xcite .",
    "unfortunately , the requirement that the eigenmode evolve harmonically in the direction normal to the boundary makes this boundary condition inappropriate for a pc , pc waveguide or a metamaterial . in this paper",
    "we generalize the boundary condition in ref .",
    "@xcite to absorb multiple bloch eigenmodes . in sec .",
    "[ sec_2 ] we derive this bloch mode absorbing boundary condition ( bloch - abc ) for the frequency domain and show how to impose it in a finite element simulation . in sec .",
    "[ sec_3 ] we use the bloch - abc to calculate the scattering from an interface between vacuum and a 2d pc . in sec .",
    "[ sec_4 ] we use the bloch - abc to terminate a 2d pc waveguide .",
    "finally , the bloch - abc presented in this paper requires an orthogonality relation for bloch eigenmodes that we derive in appendix  [ solution ] .",
    "when solving for the electric field @xmath4 of an electromagnetic wave , the wave equation is    @xmath5    here we have assumed that @xmath6 and @xmath7 are isotropic , though it is simple to generalize this argument to more complicated materials .",
    "we intend solve the wave equation with a finite element simulation . for a review of the finite element method used in electromagnetic simulations",
    "see ref .",
    "the weak expression for this wave equation is    @xmath8    here @xmath9 is a test function . integrating the weak expression over the simulation domain @xmath10 gives us    @xmath11   & \\displaystyle\\int_{\\omega } d^3x \\ \\",
    "\\textbf{v}\\cdot \\left [ \\epsilon\\displaystyle\\frac{\\omega^2}{c^2}\\textbf{e } -\\nabla\\times\\left(\\frac{1}{\\mu}\\nabla\\times\\textbf{e}\\right ) \\right ] \\\\[15pt ] & + \\displaystyle\\oint_{\\partial\\omega } da\\ \\",
    "\\textbf{v}\\cdot\\left[\\hat{\\textbf{n}}\\times\\left(\\displaystyle\\frac{1}{\\mu}\\nabla\\times\\textbf{e}\\right)\\right ] , \\end{array}\\ ] ]    an integral of the wave equation over the simulation domain @xmath10 , and a boundary integral over the domain boundary @xmath12 . using the maxwell equations , the integrand of the boundary integral can be interpreted as @xmath13 . setting the integral of the weak expression to zero",
    "enforces the wave equation and also imposes a boundary condition through the boundary integral .",
    "specifically it forces the components of @xmath14 tangential to the boundary to equal zero .",
    "boundary condition is the natural boundary condition of the weak expression in eq .",
    "( [ weak_e ] ) and is known as a _ perfect magnetic conductor _ boundary condition .",
    "our objective is to modify this boundary condition on a segment of the simulation boundary so that it becomes a _ mixed",
    "_ boundary condition that absorbs bloch eigenmodes of the pc .",
    "we do this by borrowing from the previously established boundary condition for absorbing waveguide eigenmodes  @xcite .",
    "this requires an orthogonality relation for the bloch eigenmodes of a pc .",
    "the orthogonality relation that we use is a generalization ( see appendix  [ solution ] for the derivation ) of that presented in refs .",
    "@xcite , generalized to work with lossy pcs    @xmath15 = s_i\\delta_{ij}.\\ ] ]    here @xmath16 is a normalization factor which in general is a complex number , and @xmath17 is an surface integral over a domain boundary with @xmath18 an infinitesimal area vector normal to the boundary . @xmath19 and @xmath20 are the electric and magnetic fields of eigenmodes of a pc where the eigenvalue is the complex valued wavenumber  @xcite . @xmath21 and @xmath22 are complementary eigenmodes obtained by solving the complementary eigenvalue problem , this being the original eigenvalue problem with loss replaced with the equivalent amount of gain . the complex valued wavenumber eigenvalues of the complementary eigenmodes are the complex conjugates of the eigenvalues of the normal eigenmodes ( see appendix  [ solution ] ) .",
    "the use of the complementary eigenmodes allows the orthogonality relation to work not only with both lossy and active crystals , but to also with evanescent eigenmodes .",
    "it should be noted that the normalization of the eigenmodes @xmath19 and @xmath20 and their complementary eigenmodes @xmath21 and @xmath22 are arbitrary . one can multiply @xmath19 and @xmath20 by an arbitrary factor and divide @xmath21 and @xmath22 by the same arbitrary factor and @xmath16 remains unchanged .",
    "we modify the natural boundary condition of the weak expression by specifying the values of the magnetic field tangent to the boundary .",
    "we want the magnetic field at the boundary to be equal to the sum of magnetic fields of bloch eigenmodes excited at the boundary ( modes entering the simulation domain ) as well as eigenmodes incident upon the boundary that we require to be absorbed by the boundary ( modes exiting the simulation domain ) .",
    "we set the integrand in the surface integral of eq .",
    "( [ weak_integration ] ) to    @xmath23,\\ ] ]    where @xmath24 is a sum over eigenmodes that carry energy into the domain ( excited at the boundary ) and @xmath25 is a sum over eigenmodes that carry energy out of the domain ( reflected from within the domain ) .",
    "the amplitudes for the incident eigenmodes @xmath26 are controlled parameters of the simulation while the amplitudes for the reflected eigenmodes @xmath27 are unknown .",
    "using the orthogonality relation in eq .",
    "( [ orth ] ) , we represent the unknown reflected eigenmode amplitudes as a functional of the electromagnetic field ,    @xmath28}{\\int_\\mathrm{b}da\\   \\left [ \\tilde{\\textbf{e}}_n^*\\times\\textbf{h}_n+\\textbf{e}_n\\times\\tilde{\\textbf{h}}_n^*\\right]}.\\ ] ]    here the index @xmath29 only includes eigenmodes carrying energy out of the domain . combining eqs .",
    "( [ bound1 ] ) and ( [ bound2 ] ) , we derive the weak contribution to the boundary    @xmath30 & + \\displaystyle\\left .",
    "\\sum_{n-}\\textbf{h}_n \\frac{\\int_\\mathrm{b}da\\   \\left [ \\tilde{\\textbf{e}}_n^*\\times\\textbf{h}+\\textbf{e}\\times\\tilde{\\textbf{h}}_n^*\\right]}{\\int_\\mathrm{b}da\\   \\left [ \\tilde{\\textbf{e}}_n^*\\times\\textbf{h}_n+\\textbf{e}_n\\times\\tilde{\\textbf{h}}_n^*\\right ] } \\right ] .",
    "\\end{array}\\ ] ]    this weak expression must be added to the particular boundary intended to absorb the bloch eigenmodes of the pc .",
    "we note that although this derivation was for a finite element simulation solving for the electric field @xmath4 , it is simple to adapt it to a simulation solving for the magnetic field @xmath14 . throughout this paper all numerical simulations , both those demonstrating the bloch - abc as well as any eigenvalue simulations ,",
    "were performed using comsol multiphysics 3.5a .",
    "we end this section by noting that the bloch - abc is numerically exact , with unwanted reflections due only to the finite level of discretization , and to a much lesser extent the finite numerical precision of computers .",
    "as an initial example , we consider a simple 2d pc shown in fig.[fig_1](a ) . the cylinder in the center of the crystal unit cell has a radius of @xmath31 where @xmath32 is the lattice constant of the unit cell .",
    "this cylinder consists of vacuum with permittivity @xmath33 , and the surrounding area is a dielectric with permittivity @xmath34 . using the wave convention @xmath35 , the negative imaginary part of @xmath6 implies loss .",
    "our first test of the bloch - abc is to excite a p - polarized ( @xmath36 ) eigenmode of the pc at one boundary , allow the wave to propagate in the @xmath37 direction as a bloch mode through a length of pc 5 unit cells long , and then absorb the eigenmode at the terminating boundary .",
    "the crystal is periodic in the @xmath38 direction .",
    "we can measure the reflection from the terminating boundary using a version of the orthogonality relation in eq .",
    "( [ orth ] )    @xmath39}{\\left(\\frac{1}{2}\\int_\\mathrm{b}da\\   \\left [ \\tilde{\\textbf{e}}_n^*\\times\\textbf{h}_n+\\textbf{e}_n\\times\\tilde{\\textbf{h}}_n^*\\right]\\right)^{1/2}}.\\ ] ]    the amplitude @xmath40 has units of power@xmath41 , and for propagating modes in lossless crystals , @xmath42 can be interpreted as the power flux of the eigenmode through the boundary integrated over in eq .",
    "( [ refl ] ) .     of a @xmath43 ,",
    "@xmath44 eigenmode propagating through five unit cells of the pc .",
    "the cylinder in the center of the unit cell is vacuum with permittivity @xmath33 .",
    "the surrounding area is a dielectric with permittivity @xmath45 .",
    "the eigenmode is excited at the left boundary and absorbed at the right boundary .",
    "the negligible reflection can be seen visually from the absence of interference in the field profile .",
    "( b ) power reflection from the right boundary normalized to the incident power for three different values of @xmath46 . both incident and reflected powers were calculated using eq .",
    "( [ refl ] ) . ]    ) and normalized to the incident ampitudes to define the scattering amplitudes of the interface .",
    "( b ) diagram of the simulation of reflection and transmission of plane waves through a five layered pc slab .",
    "( c ) real and ( d ) imaginary parts of @xmath47 calculated from a complex wavenumber eigenvalue simulation  @xcite .",
    "( e ) absolute value and ( f ) argument ( phase ) of the transmision and reflection amplitudes returned by the five layer pc slab simulation diagramed in fig .",
    "[ fig_2](b ) ( solid lines ) and calculated using the interface scattering amplitudes ( dotted lines ) . ]",
    "the results of this test are shown in fig .",
    "[ fig_1](b ) .",
    "we quantify the efficiency of the bloch - abc by calculating the reflection at the bloch - abc boundary . in fig .",
    "[ fig_1](b ) we plot the power reflected from the bloch - abc boundary normalized to the incident power , vs. the normalized frequency @xmath48 with @xmath49 for three different angles , @xmath50 .",
    "we see that in all cases , the reflection is less than @xmath51 , and we note that this reflection can be further reduced by using a finer mesh .    one application of the bloch - abc as well as the orthogonality relation is to calculate the scattering from an interface between a homogeneous medium ( vacuum for example ) and a periodic crystal . as a second test of the bloch - abc",
    ", we have calculated the scattering amplitudes at the interface between vacuum and the pc shown in fig .",
    "[ fig_1](a ) , and then used these amplitudes to calculate the total transmission and reflection from a pc slab five unit cells thick , surrounded on both sides by vacuum .",
    "as can be seen from fig .",
    "[ fig_2 ] , the scattering amplitudes of the vacuum - pc interface accurately reproduce the reflection and transmission amplitudes of a five layered pc slab",
    ".    we note that in the simulation calculating the scattering amplitudes at the interface between vacuum and the pc , the bloch - abc was configured to absorb three bloch eigenmodes simultaneously .",
    "for most frequencies one eigenmode was propagating and the remaining two were evanescent , though the dispersion curves in fig  [ fig_2 ] show multiple propagating modes for frequencies near @xmath52 . because the bloch - abc was absorbing the most prominent evanescent bloch eigenmodes ( the evanescent eigenmodes with the smallest @xmath53 ) , only a single pc unit cell was required in the simulation domain .",
    "turn in the pc waveguide .",
    "( b ) band diagram of a @xmath54 eigenmode of the pc .",
    "the bandgap is indicated by the shaded area .",
    "( c ) complex wavenumber dispersion curve  @xcite of the pc wavguide eigenmode .",
    "the bandgap of the pc is again indicated by the shaded area .",
    "note that inside the bandgap there is a cutoff frequency for the pc waveguide mode .",
    "also , at the high frequency end of the bandgap the pc waveguide mode remains confined to the waveguide even as the frequency exits the bandgap . at frequencies above the bandgap , there is an additional non - evanescent leaky mode in the pc waveguide that is not shown here . ]",
    "our second demonstration of the bloch - abc involves a pc waveguide .",
    "fig  [ fig_3](a ) shows a digram of the simulation domain of the pc waveguide .",
    "the pc consists of cylinders with permittivity @xmath55 and radius @xmath56 where @xmath32 is the lattice constant of the square unit cell .",
    "the dielectric cylinders are surrounded by vacuum with @xmath33 . as can be seen from the band diagram plotted in fig  [ fig_3](b ) , this pc has a bandgap for the frequencies @xmath57 .",
    "a pc waveguide is formed by removing a series of individual cylinders along a line .",
    "this waveguide supports an @xmath54 waveguide mode , the dispersion relation of which is plotted in fig .",
    "[ fig_3](c ) .",
    "we will now use the bloch - abc to calculate the the reflection of a @xmath58 turn in the pc waveguide , a problem previously used to demonstrate pcpml schemes  @xcite .     for the pc waveguide bend simulation at frequency @xmath59 .",
    "the waveguide eigenmode is excited at the left boundary of the domain and absorbed at both the left and top boundaries .",
    "note the interference in the horizontal branch of the waveguide due to the reflection at the @xmath58 bend and the lack of interference in the vertical branch of the pc waveguide due to negligible reflection at the bloch - abc boundary .",
    "( b ) power reflection from the top bloch - abc boundary normalized to power incident upon that boundary .",
    "( c ) power reflection from the @xmath58 bend in the pc waveguide normalized to power incident upon the @xmath60 bend .",
    "the shaded area indicates the pc bandgap shown in fig  [ fig_3](b ) . ]    using the field profile returned from a complex wavenumber eigenvalue simulation  @xcite for the single propagating mode inside the pc waveguide , we can impose a bloch - abc on the left and top boundaries of the simulation domain shown in fig .",
    "[ fig_3](a ) .",
    "in addition to absorbing the pc waveguide mode we can use the bloch - abc to excite the same mode at the left boundary of the domain .",
    "we then use eq .",
    "( [ refl ] ) to calculate the power reflected from the top boundary , quantifying the efficiency of the bloch - abc . in a similar way",
    "we calculate the power reflection from the @xmath58 bend in the pc waveguide , ostensibly the objective of this exercise .",
    "these reflections are plotted in fig .",
    "[ fig_4 ] .    from fig  [ fig_4 ]",
    "we see excellent absorption at the bloch - abc .",
    "the reflection from the top bloch - abc is always less than @xmath61 , and could be further reduced with a finer mesh . in the field profile in fig  [ fig_4](a )",
    "we see no interference in the vertical branch of the pc waveguide due to essentially no reflection from the top bloch - abc .",
    "this is in contrast to the clear interference in the horizontal branch of the pc waveguide due to reflection from the @xmath58 bend . finally , we note that in the simulation shown in fig  [ fig_4](a ) , the bloch - abc was configured to absorb only the single propagating waveguide eigenmode .",
    "we end this section by contrasting the bloch - abc method of terminating the simulation domain with the use of pcpmls .",
    "first , the reflection from the bloch - abc boundary ( @xmath62 ) is significantly smaller than that from a pcpml  @xcite .",
    "second , the employment of a pcpml requires an additional domain for the pcpml , increasing the overall size of the simulation .",
    "third , the pcpml is an approximate method for absorbing bloch eigenmodes while the bloch - abc is numerically exact .",
    "the one advantage of a pcpml is that it can be used in a time domain simulation , whereas the bloch - abc presented here is limited to the frequency domain .",
    "we have derived an absorbing boundary condition for the bloch eigenmodes of periodic structures for use in frequency domain simulations .",
    "we have tested the bloch - abc on a pc as well as a pc waveguide , showing that reflection from the bloch - abc is negligibly small .",
    "in fact , the bloch - abc is numerically exact .",
    "unwanted reflections can in principle be reduced by refining the mesh .",
    "the bloch - abc relies on a orthogonality relation for bloch eigenmodes  @xcite that we have generalized ( in appendix[solution ] ) for a wider variety of periodic media , including lossy media .",
    "this work was supported by the ic postdoctoral research fellowship program .",
    "i would also like to acknowledge the influence of peng zhang , whose own work required the bloch - abc , and therefore served as the impetus for its development .",
    "a necessary requirement for the bloch - abc is an orthogonality relation between different bloch eigenmodes of a pc , pc waveguide or metamaterial .",
    "an orthognality relation for bloch eigenmodes has previously been presented in several papers  @xcite . here",
    "we generalize this orthogonality relation to work with eigenmodes of lossy ( and active ) crystals , as well as crystals made up of anisotropic and bianisotropic materials .",
    "this generalized orthogonality relation also works with evanescent eigenmodes . aside from this generalization",
    ", our derivation of the orthogonality relation closely follows that of ref .",
    "@xcite .",
    "the electric and magnetic fields of a crystal bloch eigenmode are represented as    @xmath63    where @xmath64 and @xmath65 are periodic vectors    @xmath66    where @xmath67 is the set of lattice vectors for the unit cell of the pc , and @xmath68 is a vector of integers .",
    "the bloch wavevector @xmath69 can be divided into a constant part @xmath70 and a variable part @xmath71 , both parts potentially being complex valued . here",
    "@xmath72 is a unit vector and @xmath73 is the eigenvalue we will use to prove the orthogonality relation .    using these periodic vector functions we can represent the maxwell equations as two separate eigenvalue problems    @xmath74    here @xmath75 is the @xmath76 operator projected onto a plane tangent to the unit vector @xmath72 while @xmath77 is the @xmath76 operator projected onto the unit vector @xmath72 .",
    "@xmath78 are the bloch eigenmodes and @xmath79 are the complementary bloch eigenmodes , both with the bloch phase factor divided off .",
    "the complementary eigenmodes are the modes that would result from replacing the loss in a pc with an equivalent amount of gain . @xmath80 and",
    "@xmath78 are sometimes called the left and right generalized eigenfunctions of the pair of operators @xmath81 and @xmath82 .",
    "appendix  [ lr_eigen ] contains a short primer on the orthogonality of left and right generalized eigenvectors .",
    "note that the sets of eigenvalues for the normal and complementary eigenvalue problems are complex conjugates of each other .",
    "also , @xmath82 is always hermitian . in the case of a lossless pc ,",
    "if @xmath70 is restricted to be real valued , @xmath81 is hermitian , making the operator @xmath83 hermitian . in this lossless case ,",
    "the eigenvalues @xmath84 are either real valued ( propagating modes ) or they come in complex conjugate pairs ( evanescent modes ) .",
    "we define the following inner product    @xmath85 \\textbf{h}_i \\end{array}\\!\\!\\!\\right)^\\dagger\\cdot \\hat{o}\\cdot \\left(\\!\\!\\!\\begin{array}{c } \\textbf{e}_j \\\\[3pt ] \\textbf{h}_j \\end{array}\\!\\!\\!\\right),\\ ] ]    where @xmath86 is an arbitrary operator and the integral is over a plane of the unit cell perpendicular to the unit vector @xmath72 .",
    "borrowing from the orthogonality proof in ref .",
    "@xcite , by partial integration we can show that    @xmath87 & -\\mathrm{i}\\displaystyle\\frac{\\partial}{\\partial n } \\langle \\tilde{\\psi}_i | \\hat{b } | \\psi_j\\rangle , \\end{array}\\ ] ]    implying    @xmath88    the solution to this simple differential equation is @xmath89 , where @xmath29 is a displacement in the direction of @xmath72 .",
    "however , since @xmath79 and @xmath90 are bloch eigenmodes divided by the bloch phase factor , @xmath91 , implying    @xmath92 = s_i\\delta_{ij},\\ ] ]    where @xmath93 is a normalization factor which in general is a complex number . since the integral in eq .",
    "( [ inner_prod_1 ] ) is over dimensions perpendicular to @xmath94 we can simplify the orthogonality relation by using the full field values    @xmath95 = s_i\\delta_{ij},\\ ] ]    where again @xmath16 is a complex valued normalization factor .",
    "when considering the eigenfunctions and complementary eigenfunctions used in the derivation of the orthogonality relation derived in appendix  [ solution ] , it may help to make an analogy to linear algebra , replacing eigenfunctions with eigenvectors and replacing differential operators with matrices .",
    "consider the generalized eigenvalue problem      here @xmath81 and @xmath82 are @xmath97 matrices and @xmath98 is a @xmath99 vector .",
    "@xmath98 is called a right generalized eigenvector of the pair of matrices @xmath81 and @xmath82 .",
    "the left generalized eigenvalue problem      defines the left generalized eigenvector @xmath101 .",
    "it is important to note that both generalized eigenvalue problems have the same set of eigenvalues @xmath102 .",
    "it is easy to see that this is true by considering that both the left and right generalized eigenvalue problems have the same characteristic polynomial @xmath103 , the zeros of which are the set of eigenvalues @xmath102 .",
    "if @xmath105 , then eq .  ( [ vec_orth ] ) implies @xmath106 . if @xmath107 , then @xmath108 can be nonzero .",
    "we are ignoring the possibility of degenerate eigenvalues , which if encountered can be handled in the usual way by manually orthogonalizing the associated left and right eigenvectors .",
    "the final result is                        y.  tsuji and m.  koshiba , `` finite element method using port truncation by perfectly matched layer boundary conditions for optical waveguide discontinuity problems , '' j. lightwave technol . *",
    "20 * , 463468 ( 2002 ) .",
    "e.  p. kosmidou , t.  i. kosmanis , and t.  d. tsiboukis , `` a comparative fdtd study of various pml configurations for the termination of nonlinear photonic bandgap waveguide stuctures , '' ieee trans . magn .",
    "* 39 * , 11911193 ( 2003 ) .",
    "s.  g. johnson , m.  ibanescu , m.  skorobogatiy , o.  weisberg , t.  d. engeness , m.  soljaci , s.  a. jacobs , j.  d. joannopoulos , and y.  fink , `` low - loss asymptotically single - mode propagation in large - core omniguide fibers , '' opt .",
    "express * 9 * , 748779 ( 2001 ) .",
    "s.  g. johnson , p.  bienstman , m.  a. skorobogatiy , m.  ibanescu , e.  lidorikis , and j.  d. joannoppoulos , `` adiabatic theorem and continuous coupled - mode theory for efficient taper transitions in photonic crystals , '' phys .",
    "e * 66 * , 066608 ( 2002 ) .",
    "m.  skorobogatiy , m.  ibanescu , s.  g. johnson , o.  weisberg , t.  d. engeness , m.  soljaci , s.  a. jacobs , and y.  fink , `` analysis of general geometric scaling perturbations in a transmitting waveguide : fundamental connection between polarization - mode dispersion and group - velocity dispersion , '' j. opt .",
    "b * 19 * , 28672875 ( 2002 ) .",
    "d.  michaelis , u.  peschel , c.  waechter , and a.  braeuer , `` coupling coefficients of photonic crystal waveguides , '' in `` proc .",
    "spie 4987 , integrated optics : devices , materials , and technologies vii , '' ( spie , 2003 ) ."
  ],
  "abstract_text": [
    "<S> we present an absorbing boundary condition for electromagnetic frequency domain simulations of photonic crystals and metamaterials . </S>",
    "<S> this boundary condition can simultaneously absorb multiple bloch - floquet eigenmodes of a periodic crystal , including both propagating and evanescent modes . </S>",
    "<S> the photonic crystal or metamaterial in question can include lossy , active , anisotropic and even bi - anisotropic inclusions . </S>",
    "<S> the absorbing boundary condition is dependent on an orthogonality condition for bloch - floquet eigenmodes , a generalized version of which is presented here . </S>",
    "<S> we test this absorbing boundary condition numerically and present the results . </S>"
  ]
}