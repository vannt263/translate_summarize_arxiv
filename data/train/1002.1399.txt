{
  "article_text": [
    "welschinger invariants play a role of real analogue of genus zero gromov - witten invariants . as introduced in @xcite",
    ", they count , with certain signs , the real rational pseudo - holomorphic curves which pass through given real configurations of points on a given real rational symplectic four - fold ( and on certain six - folds ) . tropical geometry together with the open gromov - witten theory @xcite and symplectic field theory @xcite provides powerful tools for the study of welschinger invariants .    in the case of del pezzo surfaces , which is treated in the present article ,",
    "the welschinger count is equivalent to enumeration of real rational algebraic curves .",
    "here we restrict ourselves to configurations of real points , and thus speak of _ purely real _ welschinger invariants .",
    "we use the tropical geometry techniques and produce a recursive formula for purely real welschinger invariants @xmath3 of the following real del pezzo surfaces @xmath4 ( see theorem [ tn12 ] in section [ sec5 ] ) :    * @xmath5 , the real plane blown up at a generic collection of @xmath0 real points and @xmath6 pairs of conjugate imaginary points , where @xmath7 , @xmath8 , @xmath2 , * the real quadric surface with a nonempty real part blown up at @xmath9 pairs of conjugate imaginary points .",
    "we show that together with certain explicit initial data , this formula recursively determines all purely real welschinger invariants of the above surfaces ( see theorem [ tn12 ] in section [ sec5 ] ) .",
    "the formula we obtain here can be seen as a real version of vakil s recursive formula for gromov - witten invariants of these surfaces @xcite , and generalizes our earlier recursive formula for the real toric del pezzo surfaces @xcite in a similar manner as vakil s formula generalizes the caporaso - harris formula @xcite .    as application",
    ", we derive a number of properties of the invariants under consideration .",
    "in particular , we prove that for each surface @xmath4 as above and for any real nef and big divisor @xmath10 on @xmath4 , the invariant @xmath3 is positive , and @xmath11 where @xmath12 is the genus zero gromov - witten invariant ( see theorem [ tn5 ] in section [ sec - pa ] ) .",
    "the geometric meaning of this result is that through any generic configuration of @xmath13 distinct real points of @xmath4 , one can trace a real rational curve @xmath14 and , furthermore , in the logarithmic scale the number of such real rational curves is close to the number of all complex rational curves @xmath14 through the given configuration .",
    "in addition , we observe a congruence between purely real welschinger and genus zero gromov - witten invariants and show the monotone behavior of @xmath3 with respect to the variable @xmath10 ( see theorems [ tn6 ] and [ tn7 ] in sections [ sec - con ] and [ sec - mon ] , respectively ) .",
    "the aforementioned positivity , asymptotic and monotonicity properties extend our results for real toric surfaces with standard and nonstandard real structures obtained in @xcite .",
    "the novelty of the present work consists first of all in application of the tropical tools to _ non - toric _ del pezzo surfaces , namely , to @xmath15 , @xmath16 , @xmath17 , @xmath18 ( we call them _ small non - toric _ , since they are closer to toric surfaces than other del pezzo surfaces @xmath5 , @xmath19 ) . the tools of tropical geometry , as they are developed in @xcite and @xcite , and explored in @xcite , are essentially restricted to the toric case .",
    "so , having a non - toric surface , we blow down some exceptional divisors .",
    "thus , we come to a toric surface , but as a price to pay , the curves we are interested in unavoidably acquire some fixed multiple points with prescribed multiplicities .",
    "it is a serious problem , since for curves with fixed multiple points , correspondence theorems similar to @xcite are not known in general .",
    "one of the obstacles is the fact that in this case a direct tropical approach leads to tropical moduli spaces of wrong dimension .",
    "we overcome this difficulty restricting our attention to very specific configurations of points serving as constraints in our enumerative problem ( @xmath20-configurations defined in section [ ch - config ] ) .",
    "we introduce a special class of tropical curves matching @xmath20-configurations ( see section [ sec4 ] ) which , on one hand , suit well for the patchworking of algebraic curves with fixed multiple points ( cf .",
    "@xcite ) and , on the other hand , are adjusted to the _ cutting procedure _ and the proof of the _ tropical recursive formula _ ( see sections [ cutting ] and [ sec42 ] , [ sec43 ] ) . then , we observe that the complex tropical recursive formula , involving the numbers of complex curves obtained by patchworking quantization of these specific tropical curves , and vakil s recursive formula , involving _ all _ complex algebraic curves in count , coincide ( see section [ adaptation ] ) .",
    "this allows us to get the key ingredient , a complex correspondence theorem ( section [ corresp - thm ] ) .",
    "after that , we derive a _ real tropical recursive formula _",
    "( section [ sec43 ] ) which involves suitable tropical welschinger multiplicities ( cf .",
    "@xcite ) , and , using the complex correspondence theorem , convert the tropical formula into a recursive formula for welschinger invariants .",
    "it is natural to compare our formulas with j.  solomon s recursive formulas for welschin- ger invariants .",
    "the latter formulas are encoded in a real version of wdvv equations which was proposed by j.  solomon @xcite .",
    "one of the differences is that solomon s formulas involve not only purely real welschinger invariants but also invariants associated with collections of real and conjugated imaginary points , whereas our formulas contain only purely real welschinger invariants mixed with certain auxilliary tropical numbers .",
    "another feature is that the coefficients in solomon s formulas have alternating signs , whereas in our formulas all the coefficients are _",
    "positive_. the latter circumstance appears to be crucial in the proofs of the positivity , asymptotic grows formula , and monotonicity of purely real welschinger invariants .",
    "the text is organized as follows .",
    "section  [ tropical_curves ] contains a description of the class of tropical curves used in the paper . in section  [ algebraic - formulas ]",
    "we present an adapted version of vakil s recursive formula . in section  [ tropical - formulas ]",
    "we prove tropical recursive formulas , and in section  [ corresp - thm ] we establish a correspondence between the tropical and algebraic curves in count . in section [ wel ]",
    "we derive the recursive formula for the purely real welschinger invariants of the surfaces under consideration , and in section [ properties ] we use the formula to prove the aforementioned properties of welschinger invariants .",
    "for the reader convenience , we recall here basic definitions and facts concerning tropical curves . the details can be found in @xcite , @xcite .",
    "let @xmath21 be a finite graph which has neither bivalent , nor isolated vertices .",
    "denote by @xmath22 the set of univalent vertices of @xmath21 , and put @xmath23 .",
    "denote by @xmath24 the set of edges of @xmath21 .",
    "an edge  @xmath25 of  @xmath21 is called an _ end _ if  @xmath25 is incident to a univalent vertex , and is called a _ bounded edge _ otherwise .",
    "we say that @xmath21 is an _ abstract tropical curve _",
    "if @xmath26 is equipped with a metric such that each bounded edge of @xmath21 is isometric to an open bounded interval in @xmath27 , each end of @xmath21 incident to exactly one univalent vertex is isometric to an open ray in @xmath27 , and each end of @xmath21 incident to two univalent vertices is isometric to @xmath27 .",
    "a _ plane parameterized tropical curve _ is a pair @xmath28 , where @xmath21 is an abstract tropical curve and @xmath29 is a continuous map , such that    * for any edge @xmath30 the restriction of  @xmath31 to @xmath25 is a non - zero affine map , and @xmath32 is contained in a line with rational slope , * for any edge @xmath30 , any vertex  @xmath33 incident to  @xmath25 , and any point @xmath34 , one has @xmath35 , where @xmath36 is a positive integer number , @xmath37 is the unit tangent vector to @xmath25 at @xmath38 such that @xmath37 points away from  @xmath33 , and @xmath39 is a _ primitive integer vector _ ( _ i.e. _ , a vector whose coordinates are integer and mutually prime ) , * for each vertex  @xmath33 of  @xmath26 , the following _ balancing condition _ is satisfied : @xmath40    for any edge  @xmath25 of a parameterized plane tropical curve @xmath28 , the number @xmath36 is called the _ weight _ of  @xmath25 .",
    "the multi - set of vectors @xmath41 is called the _ degree _ of a parameterized plane tropical curve @xmath28 and is denoted by @xmath42 . for any parameterized plane tropical curve @xmath28 , the sum of the vectors in @xmath42 is equal to  @xmath43 .",
    "let @xmath28 be a parameterized plane tropical curve , and  @xmath44 a point of  @xmath26 .",
    "we will construct a new parameterized plane tropical curve @xmath45 out of @xmath28 and  @xmath44 .",
    "if  @xmath44 belongs to an edge  @xmath25 of @xmath28 , denote by @xmath46 and @xmath47 the vertices incident to  @xmath25 .",
    "consider a graph @xmath48 obtained from @xmath21 by removing  @xmath25 , introducing two new vertices @xmath49 and @xmath50 ( called _ added vertices _ ) , and introducing two new edges @xmath51 and @xmath52 ( called _ added edges _ ) such that @xmath53 is incident to @xmath54 and @xmath55 , @xmath56 .",
    "we say that the edges  @xmath51 and  @xmath52 _ match _ each other .",
    "the edge  @xmath25 is called the _ predecessor _ of @xmath49 , @xmath50 , @xmath51 , and @xmath52 .",
    "extend the metric on @xmath57 to a metric on @xmath58 in such a way that @xmath53 , @xmath56 , is isometric to a ray of @xmath27 if @xmath54 is not univalent , and @xmath53 is isometric to @xmath27 otherwise .",
    "this turns @xmath48 into an abstract tropical curve ( see figure  [ new - picture1 ] )",
    ". denote by @xmath59 the complement in @xmath48 of the univalent vertices , and consider a map @xmath60 such that    * @xmath61 , * @xmath45 is a parameterized plane tropical curve , * the vector @xmath62 , @xmath56 , of the curve @xmath45 coincides with the vector @xmath63 of the curve @xmath28 , * the weight @xmath64 , @xmath56 , of the edge @xmath53 of the curve @xmath45 coincides with the weight @xmath36 of the edge  @xmath25 of the curve @xmath28 .",
    "( note that if the valencies of  @xmath46 and  @xmath47 are both greater than  @xmath65 , then the last two conditions in the definition of  @xmath66 follow from the first two conditions . )",
    "( 14,9)(0,0 ) ( 0.5,7)(2,1)1(1.5,7.5)(-1,2)0.5 ( 1.5,7.5)(1,0)1.91(3.6,7.5)(1,0)1.4 ( 5,7.5)(2,1)1(5,7.5)(1,-2 ) 0.5 ( 0.5,2.5)(2,1)1(1.5,3)(-1,2)0.5 ( 1.5,3)(1,0)2(3.5,1)(1,0)1.5(5,1)(1,-2)0.5 ( 5,1)(2,1)1 ( 9,6.5)(1,1)1(10,7.5)(-1,1)1(10,7.5)(1,0)3 ( 13,7.5)(1,1)1 ( 13,7.5)(1,-1)1(8.5,2)(1,0)5.5(10,2)(-1,1)1 ( 9,1)(1,1)1(13,2)(1,-1)1(13,2)(1,1)1 ( 7,7.3)@xmath67(7.2,7.6)@xmath31(11.4,7.35)@xmath68 ( 3.4,2.84)@xmath69(3.4,0.83)@xmath70(1.4,7)@xmath46 ( 1.4,2.5)@xmath46(3.4,7.1)@xmath44 ( 11.2,7)@xmath71(4.6,7)@xmath47(4.6,0.5)@xmath47 ( 3.7,2.9)@xmath72(2.8,0.8)@xmath73(8.6,7.4)@xmath74(13.3 , 7.4)@xmath75(3.4,7.36)@xmath76 ( 7,1.8)@xmath67(7.2,2.1)@xmath66(10,2.2)@xmath77 ( 12,1.5)@xmath78(3,7.8)@xmath25(2.3,3.3)@xmath79(4.1,1.3 ) @xmath80 ( 3,5)@xmath81(3.5,5)cutting    if the point  @xmath44 coincides with a vertex  @xmath33 of @xmath26 , denote by @xmath82 , @xmath83 , @xmath84 the edges incident to  @xmath33 , and denote by @xmath54 , @xmath85 , @xmath83 , @xmath86 , the vertex incident to  @xmath87 and different from  @xmath33 . in this case , consider a graph @xmath48 obtained from @xmath21 by removing  @xmath33 , @xmath82 , @xmath83 , @xmath84 , introducing new vertices @xmath49 , @xmath83 , @xmath88 ( called _ added vertices _ ) , and introducing new edges @xmath51 , @xmath83 , @xmath89 ( called _ added edges _ ) such that @xmath53 is incident to @xmath54 and @xmath55 , @xmath85 , @xmath83 , @xmath86 . for each @xmath85 , @xmath83 , @xmath86 , both elements @xmath33 and @xmath87 of the graph @xmath21 are called _ predecessors _ of @xmath55 and @xmath53 .",
    "extend the metric on @xmath90 to a metric on @xmath91 in such a way that @xmath53 , @xmath85 , @xmath83 , @xmath86 , is isometric to a ray of @xmath27 if @xmath54 is not univalent , and @xmath53 is isometric to @xmath27 otherwise .",
    "this turns @xmath48 into an abstract tropical curve ( see figure  [ new - picture2 ] )",
    ". denote by @xmath59 the complement in @xmath48 of the univalent vertices , and consider a map @xmath60 such that    * @xmath92 , * @xmath45 is a parameterized plane tropical curve , * the vector @xmath62 , @xmath85 , @xmath83 , @xmath86 , of the curve @xmath45 coincides with the vector @xmath93 of the curve @xmath28 , * the weight @xmath64 , @xmath85 , @xmath83 , @xmath86 , of the edge @xmath53 of the curve @xmath45 coincides with the weight @xmath94 of the edge  @xmath87 of the curve @xmath28 .",
    "( again , if all vertices @xmath46 , @xmath83 , @xmath95 have valencies greater than  @xmath65 , then the last two conditions in the definition of  @xmath66 follow from the first two conditions . )    ( 11,10)(-1.5,0 ) ( 2.45,8.55)(-1,1)0.95(2.55,8.52)(2,1)0.95 ( 3.5,9)(1,0)1(3.5,9)(0,1)0.5(2.5,6.5)(0,1)1.95 ( 2.5,7)(-1,-1)0.5(2.5,7)(1,-1)0.5(2,3)(-1,1 ) 1(3,3)(2,1)1 ( 4,3.5)(1,0)1(4,3.5)(0,1)0.5(2.5,0)(0,1)2 ( 2.5,0.5)(-1,-1)0.5(2.5,0.5)(1,-1)0.5(8.45,0 ) ( 0,1)4 ( 8.57,0.5)(-1,-1)0.5(8.57,0.5)(1,-1)0.5(7,3.5 ) ( 1,-1)3 ( 7,1.25)(2,1)3(10,2.75)(1,0)1(10,2.75)(0,1 ) 0.5 ( 8.5,8.5)(-1,1)1(8.5,8.5)(2,1)1 ( 9.5,9)(1,0)1(9.5,9)(0,1)0.5(8.5,6.5)(0,1)2 ( 8.5,7)(-1,-1)0.5(8.5,7)(1,-1)0.5    ( 1.4,9.4)@xmath68 ( 2.41,8.4)@xmath76 ( 8.46,8.35)@xmath68(0.9,3.87)@xmath68 ( 1.92,2.88)@xmath68(2.92,2.84)@xmath68 ( 2.44,1.87)@xmath68    ( 6,7.9)@xmath67(6,2.4)@xmath67(6.2,8.2)@xmath31 ( 6.1,2.7)@xmath66(0.9,9.4)@xmath46(2,8.2)@xmath33(3,9.1)@xmath47 ( 2,7.05)@xmath95(2.1,9)@xmath82(2.9,8.3)@xmath96(2.6,7.6)@xmath84 ( 3.5,7.5)@xmath97(8.6,8.1)@xmath98(0.5,3.9)@xmath46(1.5,2.6 ) @xmath72 ( 3.1,2.6)@xmath73(4,3)@xmath47(1.9,1.9)@xmath99(1.9,0.5)@xmath95 ( 1.5,3.7)@xmath79(3.1,3.5)@xmath80(2.6,1)@xmath100 ( 2.3,5.1)@xmath81(2.7,5.2)cutting ( 3.5,1.5)@xmath97    in the both cases considered above , the parameterized plane tropical curve @xmath45 is called a _ cut _ of @xmath28 at  @xmath44 .      put @xmath102 and @xmath103 .",
    "let @xmath28 be a parameterized plane tropical curve , and @xmath104 a subset of @xmath22 .",
    "put @xmath105 .",
    "we say that @xmath106 is an _ @xmath101-curve _ if    * for any univalent vertex  @xmath33 of @xmath107 one has @xmath108 , where @xmath25 is the end incident to  @xmath33 , * for any univalent vertex  @xmath109 one has @xmath110 , where  @xmath25 is the end incident to  @xmath111 .",
    "if @xmath112 is an @xmath101-curve , then @xmath31 naturally extends to a map @xmath113 , and the image under @xmath114 of any univalent vertex of @xmath107 belongs to @xmath115 .",
    "the ends of  @xmath21 which are incident to univalent vertices of  @xmath107 are called _ left_.    the _ degree _ @xmath116 of an @xmath101-curve @xmath112 is the degree @xmath42 of the parameterized plane tropical curve @xmath28 . an @xmath101-curve @xmath112 is _ irreducible _ , if the graph @xmath21 is connected .",
    "the _ genus _ of an irreducible @xmath101-curve @xmath117 is the first betti number @xmath118 of  @xmath21 .",
    "the irreducible @xmath101-curves of genus  @xmath43 are called _ rational_.    let @xmath112 be an @xmath101-curve , and @xmath119 , @xmath83 , @xmath120 the connected components of  @xmath21 . for any integer @xmath121 , @xmath83 , @xmath122 , put @xmath123 and denote by @xmath124 the vertices belonging simultaneously to @xmath125 and @xmath126 .",
    "the @xmath101-curves @xmath127 are called _",
    "irreducible components _ of @xmath112 .",
    "an edge of an @xmath101-curve @xmath112 is said to be _ horizontal _ , if the image of this edge under  @xmath31 is contained in a horizontal line .",
    "an @xmath101-curve @xmath106 is _ horizontal _ , if @xmath21 is a segment and @xmath128 is a horizontal line in @xmath129 .",
    "an irreducible @xmath101-curve @xmath112 is called _ one - sheeted _ if among the vectors of its degree @xmath130 there are exactly two vectors with non - zero second coordinate , and each of these two vectors is of the form @xmath131 , where  @xmath132 is an integer number .",
    "an @xmath101-curve @xmath112 is _ non - degenerate _ , if for any non - univalent vertex  @xmath33 of  @xmath107 the vectors @xmath133 , @xmath83 , @xmath134 ( where @xmath82 , @xmath83 , @xmath84 are the edges incident to  @xmath33 ) span @xmath129 .",
    "a non - degenerate @xmath101-curve @xmath112 is called _ simple _ if any non - univalent vertex of  @xmath107 has valency  @xmath135 , and is called _ pseudo - simple _ , if for any non - univalent vertex  @xmath33 of  @xmath107    * there are exactly three distinct vectors among the vectors @xmath133 , @xmath83 , @xmath134 , where @xmath82 , @xmath83 , @xmath84 are the edges incident to  @xmath33 , * an equality @xmath136 , where @xmath137 and @xmath138 are distinct elements of the set @xmath139 , implies that @xmath140 .    if @xmath112 is an @xmath101-curve , and  @xmath44 a point of @xmath26 , then a cut @xmath45 of @xmath141 at  @xmath44 gives rise to an @xmath101-curve @xmath142 , where @xmath143 , and @xmath144 is the set formed by the added vertices  @xmath55 of @xmath48 such that for the unique edge  @xmath53 incident to  @xmath55 one has @xmath145 .",
    "the @xmath101-curve @xmath146 is also called a cut of @xmath112 at  @xmath44 .    a _ marked @xmath101-curve _",
    "@xmath147 is an @xmath101-curve @xmath112 equipped with a @xmath148-tuple @xmath149 of disjoint finite sequences of distinct points in  @xmath107 such that    * each point in @xmath150 is a univalent vertex of @xmath107 , * each point in @xmath151 , @xmath152 , and @xmath153 is not a vertex of @xmath107 , * each point in @xmath154 is a non - univalent vertex of @xmath107 , * the connected components of the complement in @xmath21 of the union of the sequences @xmath150 , @xmath151 , @xmath152 , @xmath153 , and @xmath154 do not have loops , and each of these components contains exactly one univalent vertex .",
    "the elements of the union of @xmath150 , @xmath151 , @xmath152 , @xmath153 , and @xmath154 are called _ marked points _ , and to shorten the notation , we write @xmath155 .",
    "a left end  @xmath25 of a marked @xmath101-curve @xmath156 is said to be of _ @xmath157-type _ , if it is incident to a univalent vertex coinciding with a point in @xmath150 .",
    "we say that an end  @xmath25 of a marked @xmath101-curve @xmath158 is _ rigid _ , if either  @xmath25 contains a marked point , or  @xmath25 is left and of @xmath157-type .",
    "for any rigid end  @xmath25 of @xmath147 , a marked point certifying the rigidity of  @xmath25 is unique and is called the _ rigidity point _ of  @xmath25 .    a rational marked @xmath101-curve is called _ end - marked _ , if each marked point of this curve either coincides with a univalent vertex , or belongs to an end .",
    "if the graph @xmath21 of such a curve @xmath159 is not a segment , then @xmath159 has exactly one non - rigid end .",
    "let @xmath159 be a marked @xmath101-curve , and @xmath160 a non - marked point . among the connected components of @xmath161 which are incident to  @xmath44 ,",
    "there is exactly one component containing a univalent vertex .",
    "this component is called the _ free component _ associated with  @xmath44 .",
    "if @xmath147 is a marked @xmath101-curve , and  @xmath44 an arbitrary point of  @xmath26 , then the cut @xmath146 of @xmath117 at  @xmath44 produces a marked @xmath101-curve @xmath162 in the following way .",
    "( 13,7.5)(-1,0 ) ( 0,6)(2,1)1(0.5,7.5)(1,-2)0.5 ( 1,6.5)(1,0)0.9(2.09,6.5)(1,0)1.91 ( 4,6.5)(2,1)1(4,6.5)(1,-2)0.5 ( 2,2)(1,0)2(4,2)(2,1)1 ( 4,2)(1,-2)0.5 ( 7.5,5.5)(1,1)1(7.5,7.5)(1,-1)1(8.5,6.5)(1 , 0)3(11.5,6.5)(1,1)1 ( 11.5,6.5)(1,-1)1 ( 7.6,2)(1,0)3.9(11.5,2)(1,1)1(11.5,2)(1,-1 ) 1 ( 7.5,0.5)(0,1)1.4(7.5,2.05)(0,1)1.4    ( 1.9,6.36)@xmath76(7.9,6.9)@xmath163(7.87,6 ) @xmath163 ( 11.9,5.9)@xmath163(11.9,1.4)@xmath163(1.9,1.85)@xmath164 ( 7.4,1.88)@xmath163(9.47,6.33)@xmath68(0.4,6.15)@xmath165(0.67 , 6.9)@xmath165 ( 4.15,5.9)@xmath165(4.15,1.4)@xmath165 ( 1.9,6)@xmath44(9.3,6)@xmath71(3.7,6.7)@xmath54(10.6,6.7)@xmath166 ( 1.8,1.5)@xmath167(3.7,2.2)@xmath54(2.8,2.2)@xmath168 ( 7.6,0.5)@xmath115(6,6.4)@xmath67(6,1.9 ) @xmath67 ( 6.1,6.7)@xmath31(6.1,2.2)@xmath66(2.8,4)@xmath81(3.2,4.1 ) cutting    * for any @xmath169 and any common element  @xmath170 ( vertex or edge ) of @xmath48 and @xmath21 , the intersections @xmath171 and @xmath172 coincide .",
    "* the union of any added edge  @xmath53 of @xmath48 and the added vertex @xmath55 incident to @xmath53 contains at most one marked point . *",
    "an added vertex @xmath55 of @xmath48 coincides with a marked point if and only if the following holds : 1 .",
    "@xmath173 , where @xmath53 is the edge incident to @xmath55 , 2 .",
    "the union of predecessors of @xmath55 and @xmath53 does not contain a marked point ( notice that the union of predecessors can contain at most one marked point ) , 3 .",
    "the vertex @xmath54 incident to @xmath53 and different from @xmath55 belongs to the free component associated with  @xmath44 ( see figure  [ new - picture3 ] ) . *",
    "an added edge @xmath53 of @xmath48 contains a marked point if and only if 1 .",
    "either the union @xmath174 of predecessors of @xmath55 and @xmath53 contains a marked point , where @xmath55 is the added vertex incident to @xmath53 ( see figure  [ new - picture4b ] ) ; 2 .   or",
    "@xmath174 does not contain a marked point , the vertex @xmath54 incident to @xmath53 and different from @xmath55 belongs to the free component associated with  @xmath44 , and @xmath145 ( see figure  [ new - picture4a ] ) ; + moreover , if the union of the predecessors of @xmath55 and @xmath53 contains a point of @xmath151 ( respectively , @xmath152 , @xmath153 , @xmath154 ) , then the marked point of @xmath53 belongs to @xmath175 ( respectively , @xmath176 , @xmath177 , @xmath176 ) . * if an added edge @xmath53 of @xmath48 contains a marked point and is incident to a non - univalent vertex @xmath54 ( such a vertex is necessarily a common vertex of @xmath48 and @xmath21 ) , then the distance ( in @xmath48 ) between @xmath54 and the marked point belonging to @xmath53 is equal to the distance ( in @xmath21 ) between @xmath54 and  @xmath44 .",
    "( 10,15.5)(-2,0 ) ( 0.5,1)(2,1)2(2.5,2)(2,-1)1 ( 2.5,2)(1,2)0.5(2.15,5)(-2,3)0.6 ( 1.65,4.5)(1,1)0.5 ( 2.2,5)(1,0)0.5 ( 1.4,6)(-1,0)1(1.55,6.02)(2,1)0.95(2.5,6.5)(2,-1)1 ( 2.5,6.5)(1,2)0.5(6,1)(2,1)2 ( 8,2)(1,0)1 ( 8,2)(0,1)1(8,5)(0,1)1(7.5,4.5)(1,1)0.5 ( 8.5,4.5)(-1,1)0.5(8,6)(-1,1)1(8,6)(2,1)1 ( 9,6.5)(0,1)1(9,6.5)(1,0)1    ( 7.92,4.9)@xmath163 ( 1.4,5.88)@xmath76(8.3,6.1)@xmath163(8.76,6.9 ) @xmath163 ( 6.55,1.2)@xmath163(7.92,2.4)@xmath163(0.42,0.82)@xmath70(7.96,5.84)@xmath68 ( 2.05,4.9)@xmath164(1.8,6.1)@xmath164(2.65,6.9)@xmath164(1.05,1.25 ) @xmath164 ( 2.66,2.4)@xmath164    ( 1.2,5.7)@xmath44(2.3,6)@xmath54(7.1,5.7)@xmath71(8.9,6)@xmath166 ( 2.3,1.5)@xmath54(0.4,0.5)@xmath167(1.4,1.9)@xmath168 ( 4.5,5.8)@xmath67(4.5,1.5)@xmath67 ( 4.7,6.1)@xmath31(4.7,1.9)@xmath66(2,3.5)@xmath81 ( 2.4,3.6)cutting(4.5,0)(b )    ( 0.5,9)(2,1)2(2.5,10)(2,-1)1 ( 2.5,10)(1,2)0.5(2.15,13)(-2,3)0.6 ( 1.65,12.5)(1,1)0.5 ( 2.15,13)(1,0)0.5 ( 1.5,14)(-1,0)1(1.5,14)(2,1)1(2.5,14.5)(2 , -1)1 ( 2.5,14.5)(1,2)0.5(6,9)(2,1)2 ( 8,10)(1,0)1 ( 8,10)(0,1)1(8,13)(0,1)1(7.5,12.5)(1,1 ) 0.5 ( 8.5,12.5)(-1,1)0.5(8,14)(-1,1)1(8,14)(2,1 ) 1 ( 9,14.5)(0,1)1(9,14.5)(1,0)1    ( 7.7,12.7)@xmath163 ( 1.42,13.88)@xmath164(1.41,13.88)@xmath76(7.9,13.9)@xmath163(8.76,14.9 ) @xmath163 ( 6.55,9.2)@xmath163(7.92,10.4)@xmath163(0.42,8.82)@xmath70 ( 1.85,12.7)@xmath164 ( 2.65,14.9)@xmath164(1.05 , 9.2)@xmath164 ( 2.66,10.4)@xmath164    ( 1.2,13.7)@xmath44(2.3,14)@xmath54(7.1,13.7)@xmath71(8.9,14 ) @xmath166 ( 2.3,9.5)@xmath54(0.4,8.5)@xmath167(1.4,9.9)@xmath168 ( 4.5,13.8)@xmath67(4.5,9.5)@xmath67 ( 4.7,14.1)@xmath31(4.7,9.9)@xmath66(2,11.5)@xmath81 ( 2.4,11.6)cutting(4.5,8)(a )    the marked @xmath101-curve obtained via this procedure is called a _ marked cut _ of @xmath147 at  @xmath44 .",
    "let @xmath147 be a marked @xmath101-curve , and @xmath178 , @xmath83 , @xmath179 a finite sequence of pairwise distinct points of @xmath26 .",
    "we say that the set @xmath180 is _ sparse _ , if no two distinct points of @xmath181 belong to the same edge of  @xmath26 or to incident elements of  @xmath26 .",
    "if @xmath181 is sparse , define inductively a marked cut of @xmath147 at @xmath178 , @xmath83 , @xmath179 by applying the cutting procedure successively at @xmath178 , @xmath83 , @xmath179 .",
    "the marked @xmath101-curve obtained is also a marked cut of @xmath147 at @xmath182 , @xmath83 , @xmath183 , where @xmath184 is an arbitrary permutation of the set @xmath185 .",
    "the resulting curve is called a marked cut of @xmath147 at the set @xmath186 and is denoted by @xmath187 . notice that any marked cut of a non - degenerate marked @xmath101-curve is non - degenerate , and any marked cut of a pseudo - simple marked @xmath101-curve is pseudo - simple .",
    "( 10,7.5)(-2,0 ) ( 0.5,1)(2,1)2(2.5,2)(2,-1)1 ( 2.5,2)(1,2)0.5(2.15,5)(-2,3)0.6 ( 1.65,4.5)(1,1)0.5 ( 2.2,5)(1,0)0.5 ( 1.4,6)(-1,0)1(1.55,6.02)(2,1)0.95(2.5,6.5)(2,-1)1 ( 2.5,6.5)(1,2)0.5(6,1)(2,1)2 ( 8,2)(1,0)1 ( 8,2)(0,1)1(8,5)(0,1)1(7.5,4.5)(1,1)0.5 ( 8.5,4.5)(-1,1)0.5(8,6)(-1,1)1(8,6)(2,1)1 ( 9,6.5)(0,1)1(9,6.5)(1,0)1    ( 7.92,4.9)@xmath163 ( 1.4,5.86)@xmath76(7.4,6.4)@xmath163(8.76,6.9 ) @xmath163(7.96,5.85)@xmath68 (",
    "6.55,1.2)@xmath163(7.92,2.4)@xmath163(0.42,0.82)@xmath70 ( 2.05,4.9)@xmath164(0.92,5.88)@xmath164(2.65,6.9)@xmath164(1.05 , 1.2)@xmath164 ( 2.66,2.4)@xmath164    ( 1.2,5.7)@xmath44(2.3,6)@xmath54(8.1,5.7)@xmath71(8.9,6)@xmath166 ( 2.3,1.5)@xmath54(0.4,0.5)@xmath167(1.4,1.9)@xmath168 ( 4.5,5.8)@xmath67(4.5,1.5)@xmath67 ( 4.7,6.1)@xmath31(4.7,1.9)@xmath66(2,3.5)@xmath81 ( 2.4,3.6)cutting      we say that two marked @xmath101-curves @xmath156 and @xmath188 have the same _ combinatorial type _ , if there is a homeomorphism @xmath189 such that    * @xmath190 bijectively takes @xmath191 onto @xmath192 , respecting their ordered @xmath148-tuple structures , * for any @xmath193 and any edge  @xmath25 incident to  @xmath33 , the vectors @xmath39 and @xmath194 coincide , * @xmath195 for any edge @xmath196 .    if , in addition , @xmath197 , then @xmath190 is called an _ isomorphism _ and the curves @xmath159 and @xmath198 are said to be _",
    "isomorphic_. note that , in this case , @xmath190 defines an isometry of @xmath26 and @xmath199 .",
    "let  @xmath200 be a finite multi - set of vectors in @xmath201 such that the sum of all vectors in  @xmath200 is equal to  @xmath43 , and let @xmath202 , @xmath203 , @xmath204 , @xmath205 , and @xmath206 be non - negative integers such that @xmath207",
    ". denote by @xmath208 the set of isomorphism classes of non - degenerate irreducible marked @xmath101-curves @xmath147 of degree  @xmath200 and genus  @xmath204 such that    * the number of points in @xmath191 is equal to @xmath209 , * the number of points in @xmath150 is equal to  @xmath205 , * the number of points in @xmath210 is equal to @xmath211 , * the number of points in @xmath212 is equal to @xmath203 .    let @xmath213 be the set of all possible combinatorial types of marked @xmath101-curves whose isomorphism class belongs to @xmath208 .",
    "the set @xmath213 is clearly finite ( _ cf_. , for example , ( * ? ? ?",
    "* proposition 3.7 ) and @xcite ) . for a given combinatorial type  @xmath214 , denote by @xmath215 the subset of @xmath216 @xmath208 formed by the isomorphism classes of curves of type  @xmath217 .",
    "there is a natural evaluation map @xmath218 which associates to any isomorphism class @xmath219 \\in { \\cal m}({{\\delta } } , k_1 , k_2 , g , l , r)$ ] the sequence @xmath220 . for a given combinatorial type @xmath221 , denote by @xmath222 the restriction of @xmath223 on @xmath215 .",
    "one can encode the elements @xmath224 $ ] of @xmath215 by    * the lengths of all bounded edges of @xmath26 , * the image @xmath225 of some point @xmath226 , * the coordinates of the points of @xmath227 on @xmath115 , * the distances between  @xmath38 and @xmath228 , where  @xmath38 runs over all points in @xmath229 , and @xmath228 is one of the vertices of the edge containing  @xmath38 .",
    "this gives an identification of @xmath230 with the relative interior of a convex polyhedron in an affine space , and , under this identification , the map @xmath222 becomes affine .",
    "[ finiteness ] for any element @xmath231 in @xmath232 , the inverse image @xmath216 is finite .",
    "since the set @xmath213 is finite , it is enough to show that , for any @xmath221 and any element @xmath231 in @xmath233 , the inverse image @xmath216 @xmath234 is a finite set .",
    "furthermore , since we can replace any marked @xmath101-curve @xmath147 by the collection of the irreducible components of a marked cut of @xmath147 at @xmath235 ( notice that the set @xmath236 is sparse ) , it is sufficient to prove the statement in the situation , where @xmath217 is a combinatorial type of rational non - degenerate end - marked @xmath101-curves .",
    "for such a combinatorial type  @xmath217 the statement is easily proved by induction .",
    "namely , let @xmath156 be a marked @xmath101-curve of combinatorial type  @xmath217 , and assume that  @xmath21 has at least two non - univalent vertices ( the other cases are evident ) . since the curve @xmath237 is rational , the graph @xmath21 contains a non - univalent vertex  @xmath33 incident to exactly one bounded edge and not incident to the non - rigid end",
    ". denote by @xmath82 , @xmath83 , @xmath84 the ( rigid ) ends incident to  @xmath33 . since the curve @xmath237 is non - degenerate , among the ends @xmath82 , @xmath83 , @xmath84 , we can find two ends @xmath87 and @xmath238 such that @xmath239 .",
    "thus , the images under @xmath114 of the rigidity points of @xmath87 and @xmath238 allow one to reconstruct the image of @xmath33 under @xmath114 .",
    "modify the sequence @xmath191 removing from it the rigidity points of @xmath82 , @xmath83 , @xmath84 and adding to @xmath154 a marked point  @xmath38 at  @xmath33 ( as the last term of @xmath154 ) .",
    "denote the new sequence of marked points by @xmath192 .",
    "the graph of a marked cut of @xmath240 at  @xmath38 has fewer non - univalent vertices than @xmath21 , and one can apply the induction hypothesis .",
    "let @xmath242 be a marked @xmath241-curve .",
    "a homeomorphism @xmath243 is called an _ involution _",
    ", if    * @xmath244 is the identity , * the restriction of @xmath245 on @xmath26 is an isometry , * @xmath246 , * @xmath245 is identical on @xmath247 , and takes @xmath152 bijectively onto @xmath153 .",
    "a marked @xmath101-curve @xmath242 equipped with an involution @xmath248 is called _",
    "symmetric_. a symmetric marked @xmath241-curve is said to be _",
    "irreducible _ if it does not decompose into proper symmetric marked @xmath241-subcurves .",
    "the _ genus _ of an irreducible symmetric marked @xmath241-curve @xmath249 is defined to be @xmath250 .",
    "we define a _ combinatorial type _ and an _ isomorphism _ of symmetric marked @xmath241-curves in the same way as in section [ moduli - spaces ] with an extra requirement that @xmath190 commutes with the involutions . given data @xmath251 as in section  [ moduli - spaces ]",
    ", we similarly introduce the set @xmath252 of isomorphism classes of irreducible symmetric marked @xmath253-curves of genus @xmath204 , and consider the evaluation map @xmath254 . clearly , @xmath255 is nonempty only if @xmath256 .",
    "the following statement can be deduced from proposition  [ finiteness ] .",
    "[ sym ] ( 1 ) the set of combinatorial types of symmetric marked @xmath253-curves whose isomorphism classes belong to @xmath257 is finite .",
    "\\(2 ) for any element @xmath231 in @xmath232 , the inverse image of @xmath231 under the evaluation map @xmath258 is finite .",
    "here , we establish some properties of generic points of `` generalized severi varieties '' .",
    "these auxiliary results are close to similar statements in @xcite used in the proof of the recursive formulas , but our setting is slightly different and we need a more detailed information on generic elements of the severi varieties considered .    let @xmath259 be the complex projective plane blown up at @xmath260 generic points , @xmath87 , @xmath261 , the exceptional curves of the blow up , @xmath262 the pull - back of a line in @xmath263 , and @xmath25 a smooth rational curve linearly equivalent to @xmath264 denote by @xmath265 and @xmath266 the semigroups generated by effective irreducible divisors @xmath267 such that @xmath268 or @xmath269 , respectively .    following ( * ? ? ? * section 2 ) , for a given effective divisor @xmath267 and nonnegative integers @xmath270 , we denote by @xmath271 the moduli space of triples @xmath272 , where @xmath273 is a genus  @xmath204 connected nodal curve , @xmath274 is a collection of @xmath122 marked points of @xmath273 , and @xmath275 is a stable map such that @xmath276 . the triples with a smooth curve @xmath273 form an open dense subset in @xmath271 .",
    "let @xmath277 be the direct sum of countably many additive semigroups .",
    "denote by @xmath278 the generator of the @xmath86-th summand , @xmath279 . for @xmath280",
    "put @xmath281 let a divisor @xmath282 , an integer @xmath204 , and two elements @xmath283 satisfy @xmath284 given a sequence @xmath285 of @xmath286 distinct points of @xmath25 , define @xmath287 to be the closure of the set of elements @xmath288 subject to the following restrictions :    * @xmath273 is smooth , @xmath289 , @xmath290 for all @xmath291 , * the divisor @xmath292 is of the form @xmath293 where @xmath294 is a sequence of @xmath295 distinct points of @xmath296 .",
    "put @xmath297 for a component @xmath33 of @xmath298 , define the _ intersection dimension _",
    "@xmath299 to be the dimension of the image of @xmath33 in the linear system @xmath300 .",
    "denote by @xmath301 the maximum of intersection dimensions if the components .",
    "[ ln1 ] consider the surface @xmath302 , the smooth rational curve @xmath25 linearly equivalent to @xmath303 , and an irreducible curve @xmath304 different from @xmath25 .",
    "let @xmath305 , an integer  @xmath204 , and @xmath283 satisfy ( [ en1 ] ) , and let @xmath306 be a generic sequence of points of @xmath25 .",
    "if @xmath307 , then @xmath308 and each component @xmath33 of @xmath216 @xmath309 satisfies @xmath310 if ( [ enov1 ] ) turns into equality and @xmath10 is not of the form @xmath311 , where @xmath312 and @xmath313 , or @xmath314 , @xmath315 , then for a generic element @xmath316 the map  @xmath317 is an immersion birational onto @xmath318 , where @xmath319 is a nodal curve nonsingular along @xmath25 .",
    "furthermore , if in addition @xmath320 , then the family @xmath33 has no base points outside @xmath321 , and @xmath319 crosses @xmath322 transversally .",
    "first , we prove the lemma under an additional assumption that for a generic element @xmath323 of the component @xmath324 , the curve @xmath273 is mapped by @xmath317 birationally to its image @xmath318 .",
    "the relation ( [ enov1 ] ) is evident if @xmath10 is a @xmath325-curve as well as if @xmath326 with @xmath327 or with @xmath328 for some @xmath137 .",
    "so , we assume that @xmath326 with @xmath329 , @xmath330 .",
    "due to generic position of @xmath321 , one has @xmath331 for at least one of the components @xmath332 of @xmath333 . hence , to prove ( [ enov1 ] ) , it is sufficient to assume that @xmath334 and @xmath335 , and to check that the intersection dimension of any component of @xmath336 is at most @xmath337 . to shorten the notation",
    ", we write ( within the present proof ) @xmath338 for @xmath336 .",
    "the remaining part of the proof of ( [ enov1 ] ) literally follows the lines of @xcite and is based on the following numerical observations .    1 .",
    "the conclusion of ( * ? ? ? * corollary 2.4 ) reads in our situation as @xmath339 and it holds since the hypothesis of ( * ? ? ?",
    "* corollary 2.4 ) , which is equivalent to @xmath340 , is true for any effective divisor @xmath267 .",
    "2 .   the inequality @xmath341 in ( * ? ? ?",
    "* page 363 ) ( @xmath342 is defined by ( [ ediv ] ) ) reads in our situation as @xmath343 , and it holds true since @xmath344 under our assumptions . 3 .   the inequality @xmath345 in ( * ? ? ?",
    "* the last paragraph in page 363 ) ( @xmath346 is the normal sheaf on @xmath273 and @xmath347 is the dualizing bundle ) reads in our setting as @xmath348 and it holds true since @xmath349 ( the latter inequality follows from bzout s bound applied to the intersection of @xmath318 with an appropriate curve from the linear system @xmath350 ) .    as in the end of the proof of ( * ? ? ?",
    "* proposition 2.1 ) , it implies that the intersection dimension of any component of @xmath351 does not exceed @xmath352 which completes the proof of ( [ enov1 ] ) .    a stronger inequality @xmath353 , which is indeed established in ( e3 ) , implies that @xmath354 is an immersion away from @xmath355 ( see ( * ? ? ?",
    "* first paragraph of the proof of proposition 2.2 ) ) .",
    "similarly , @xmath317 is an immersion at @xmath355 as soon as @xmath356 , or , equivalently , @xmath357 on the other hand , assuming that @xmath318 has a singular local branch centered at a point @xmath358 , have @xmath359 and @xmath360 , where the latter inequality follows from bzout s bound applied to the intersection of @xmath319 with a curve belonging to @xmath350 and passing through @xmath361 and another point of @xmath319 .    from now , on",
    "we suppose that @xmath317 is an immersion . to show that @xmath319 is nonsingular along @xmath25 and nodal",
    ", we may assume that @xmath362 , _",
    "i.e. _ , @xmath359",
    ". indeed , otherwise , we either replace @xmath25 by another @xmath325-curve , or , if @xmath319 does not meet any @xmath325-curve , we blow them down and reduce the problem to the planar case .    to check the remaining statements , we argue by contradiction .",
    "namely , assuming that one of them fails , we derive that necessarily @xmath363 .",
    "suppose that @xmath317 takes the points @xmath364 ( @xmath365 ) of the divisor @xmath342 to the same point @xmath358 .",
    "fixing the position of @xmath361 in @xmath25 , we obtain a subvariety @xmath366 of dimension @xmath367 . on the other hand , the same argument as in the proof of ( * ? ? ?",
    "* proposition 2.1 ) gives @xmath368 where @xmath369 .",
    "verifying that @xmath370 is positive on @xmath273 and applying ( * ? ? ?",
    "* observation 2.5 ) , we get ( cf .",
    "* page 364 ) ) @xmath371 @xmath372 @xmath373 the above positivity is equivalent to @xmath374 and it holds due to @xmath359 and @xmath375 , where the latter inequality follows from bzout s bound applied to the intersection of @xmath319 with a curve belonging to and passing through @xmath361 and another point of @xmath319 .",
    "suppose that for some point @xmath376 the set @xmath377 consists of @xmath378 points .",
    "fixing the position of the point @xmath361 , we obtain a subvariety @xmath379 of dimension @xmath380 . on the other hand , by the same arguments as above we have again the inequality ( [ ejan6_4 ] ) and an upper bound @xmath381 where @xmath382 .",
    "due to ( [ ejan6_4 ] ) , the bundle @xmath383 is positive on @xmath273 , and thus applying ( * ? ? ?",
    "* observation 2.5 ) we get @xmath384 @xmath385 @xmath386    suppose that @xmath387 , @xmath388 for some point @xmath376 , and the two local branches of @xmath318 at @xmath361 are tangent .",
    "fixing the position of @xmath361 and the direction of the tangent , we obtain a subvariety @xmath379 of dimension @xmath389 . as in the two preceding computations",
    ", we have @xmath390 where @xmath391 .",
    "the inequality @xmath392 which we derive from @xmath359 and bzout s bound applied to the intersection of @xmath319 with a curve belonging to @xmath350 , passing through @xmath361 and tangent to @xmath319 , results in @xmath393 @xmath394 @xmath395    assuming that @xmath320 and @xmath309 has a base point @xmath396 , we obtain @xmath397 where @xmath382 .",
    "the positivity of the bundle @xmath370 on @xmath273 reduces to the inequality @xmath398 which holds by bzout s bound .",
    "it allows us to conclude that @xmath399 @xmath400 @xmath401    finally , if @xmath320 then according to the same arguments as above the existence of a tangency point @xmath361 with @xmath322 would lead to the following computation : @xmath402 @xmath403 @xmath404 where @xmath382 .",
    "thus , the proof of lemma [ ln1 ] is completed under the assumption that @xmath317 is birational on its image .",
    "hence , to end the proof it remains to assume instead that for a generic element @xmath405 of @xmath298 the map @xmath317 is an @xmath406-fold covering to its image , @xmath407 .",
    "but , in such a case , we would have @xmath408 , @xmath409 , where @xmath410 is the geometric genus of @xmath318 , @xmath206 is the total ramification multiplicity of the covering , and @xmath411 .",
    "therefore , using ( [ enov1 ] ) for the case of birational @xmath317 , we get ( cf .",
    "* page 62 ) ) @xmath412 @xmath413 the latter inequality coming from the nef property of @xmath414 .",
    "the case of equality @xmath415 leaves the only possibility @xmath416 .",
    "the latter equality holds only for @xmath417 or @xmath418 .",
    "[ ltn2 ] consider the surface @xmath302 and the smooth rational curve @xmath25 linearly equivalent to @xmath303 .",
    "let @xmath419 , an integer  @xmath204 , and @xmath283 satisfy ( [ en1 ] ) , and let @xmath306 be a generic sequence of points of @xmath25 .",
    "assume that @xmath420 , and @xmath10 is represented by a reduced irreducible curve .",
    "then , @xmath309 consists of one element for the following quadruples @xmath421 :    1 .",
    "@xmath422 for @xmath423 , 2 .",
    "@xmath424 for @xmath425 , @xmath426 , 3 .",
    "@xmath427 for @xmath428 , 4 .",
    "@xmath429 for @xmath423 , 5 .",
    "@xmath430 as long as @xmath431 ,    and @xmath432 in all the other cases .    clearly , @xmath298 consists of one element in the cases ( i)-(v ) . assuming that @xmath433 and @xmath420",
    ", we will derive that @xmath421 necessarily belongs to the list ( i)-(v ) .",
    "let @xmath10 be equal to @xmath434 , where @xmath435 are integers and @xmath436 .",
    "suppose that @xmath437 .",
    "since @xmath438 , we obtain @xmath439 , @xmath423 ; this is the case ( i ) .    if @xmath440 then @xmath330 .",
    "thus , if @xmath441 , then @xmath442 yields @xmath443 .",
    "taking additionally into account that @xmath444 we derive that @xmath445 . on the other hand ,",
    "the bzout upper bound applied to the intersection of a curve @xmath318 as @xmath446 with an irreducible curve belonging to @xmath447 implies @xmath448 .",
    "hence , for @xmath449 , @xmath425 , @xmath426 , we necessarily obtain @xmath334 , @xmath450 , @xmath451 ; this is the case ( ii ) . similarly , for @xmath452 , @xmath428 , we necessarily obtain @xmath453 , @xmath451 , and @xmath454 ; this is the case ( iii ) .",
    "assume now that @xmath455 .",
    "in view of the relations @xmath456 and the irreducibility of @xmath10 , we obtain @xmath457 coming to the cases ( iv ) and ( v ) .",
    "finally , if @xmath458 , then intersecting @xmath10 with the lines from @xmath459 , we derive that @xmath460 , which implies @xmath461    [ lnov1 ] consider the surface @xmath302 and the smooth rational curve @xmath25 linearly equivalent to @xmath303 .",
    "let @xmath462 , an integer @xmath204 , and @xmath283 satisfy ( [ en1 ] ) and @xmath320 , and let @xmath306 be a generic sequence of points of @xmath25 .",
    "let @xmath33 be a component of @xmath298 of intersection dimension @xmath337 , and let @xmath463 be a generic one - parameter family such that @xmath464 is smooth connected as @xmath465 , and @xmath466",
    ".    then @xmath467 , where    1 .",
    "@xmath468 takes @xmath469 isomorphically onto @xmath25 , takes each component @xmath470 , @xmath471 , to a curve different from @xmath25 and crossing @xmath25 , and contracts the components of @xmath472 to points , 2 .",
    "@xmath468 takes @xmath473 birationally onto its image @xmath474 which is a reduced nodal curve , nonsingular along its intersection with @xmath25 , 3 .   for each @xmath475 , the map @xmath476 represents a generic element in a component of some @xmath477 of dimension @xmath478 such that 1 .",
    "@xmath479 , 2 .",
    "@xmath480 , @xmath475 , are disjoint subsets of @xmath321 , 3 .",
    "@xmath481 , 4 .",
    "each quadruple @xmath482 with @xmath483 appears in the list @xmath216 @xmath482 , @xmath475 , at most once .",
    "the central element @xmath484 must belong to a substratum of intersection dimension @xmath485 .",
    "therefore , the fact that there is only one component of @xmath486 taken to @xmath25 and the corresponding map is an isomorphism can be proven as in ( * ? ? ?",
    "* proof of theorem 5.1 , case ii ) , where the argument is based on the inequality ( [ enov1 ] ) and the equality @xmath487 .    in the further steps we argue as in ( * ? ? ?",
    "* section 3 ) .",
    "namely , we replace the given family @xmath488 by a family with the same generic fibres and a semi - stable central fibre so that ( cf . conditions ( a ) , ( b ) , ( c ) , ( d ) in ( * ? ? ?",
    "* section 3.1 ) , and assumptions ( b ) , ( c ) in ( * ? ? ? * section 3.2 ) ) :    * the family is represented by a smooth surface @xmath489 and two morphisms @xmath490 , @xmath491 , and for each @xmath492 , @xmath493 is isomorphic to @xmath488 , * the central fibre @xmath494 is a connected nodal curve splitting into the union of the following parts : the component @xmath469 isomorphically mapped by @xmath495 onto @xmath25 , the components @xmath496 , ... , @xmath497 mapped by @xmath495 to curves , and @xmath498 , the union of the components contracted by @xmath495 to points , * the components of @xmath472 are rational and form disjoint chains joining @xmath469 and @xmath499 , * the sections @xmath500 , @xmath501 , and @xmath502 , @xmath503 , defined by ( cf .",
    "( [ ediv ] ) ) @xmath504 @xmath505 close up at @xmath506 into disjoint global sections avoiding singularities of @xmath494 and the components of @xmath472 , and such that @xmath507 for all @xmath508 , * for each @xmath475 , the triple @xmath509 with @xmath510 represents a generic element of some @xmath477 , where @xmath511 , the sequences @xmath480 , @xmath475 , are disjoint subsequences of @xmath321 , and @xmath512    the proof literally follows the argument of ( * ? ? ?",
    "* section 3 ) , whose main ingredient is the inequality ( [ enov1 ] ) .",
    "blow down all the components of @xmath472 and obverse now that ( [ edim ] ) can be rewritten in the form @xmath513 since at least @xmath514 intersection points of @xmath515 with @xmath473 smooth up when deforming @xmath516 ( the blown - down @xmath494 ) to @xmath517 , @xmath492 , we derive that they are the only smoothed up intersection points .",
    "in particular , each component @xmath470 of @xmath518 intersects with @xmath469 .",
    "it follows from lemmas [ ln1 ] and [ ltn2 ] that if @xmath495 maps @xmath470 multiply onto its image , or if @xmath495 maps @xmath519 onto the same curve , then this image curve must be a @xmath325-curve crossing @xmath25 at one point .",
    "we can assume that this image curve is @xmath520 .",
    "let @xmath520 have multiplicity @xmath365 in @xmath521 , and let @xmath522 be all the components of @xmath494 mapped onto @xmath520 .",
    "since @xmath320 , we have @xmath326 , @xmath523 , @xmath330 .",
    "thus , latexmath:[$c'=(\\pi_{{\\sigma}})_*(c^{(1)}\\cup ...",
    "\\cup c^{(k)})\\in    @xmath322 crosses @xmath525 with multiplicity @xmath526 , and as explained above these intersection points persist in the deformation @xmath527 , @xmath465 .",
    "hence , @xmath528 must cross @xmath520 with multiplicity @xmath529 , which gives a contradiction .",
    "so , the map @xmath530 is birational on its image .",
    "furthermore , the genericity of @xmath531 in @xmath477 implies that the above image @xmath319 is a nodal curve , nonsingular along @xmath25 .      for any variety @xmath298 ,",
    "denote by @xmath532 the union of the components of dimension @xmath337 of the natural image of @xmath298 in the linear system @xmath300 on @xmath4 .",
    "introduce the numbers @xmath533 these numbers do not depend on the choice of @xmath321 and are enumerative : they count the irreducible nodal curves in @xmath300 which pass through @xmath534 generic points in @xmath535 and belong to @xmath536 ( cf .",
    "* section 2.4.2 ) ) .    to formulate a recursive formula for the numbers @xmath537 , we use the following conventions and notation :    * the relation @xmath538 means that @xmath539 , * @xmath540 , * if @xmath541 , then @xmath542    let us introduce also the semigroup @xmath543 with the operation @xmath544 @xmath545 notice that a quadruple @xmath546 in @xmath547 may have negative @xmath204 . put @xmath548 whenever @xmath549 .",
    ".[tn1 ] consider a divisor @xmath550 , an integer @xmath204 , and two elements @xmath283 such that @xmath551 then , @xmath552 @xmath553 where @xmath554 and the second sum in  ( [ en5 ] ) is taken    * over all splittings @xmath555 in @xmath547 of all possible collections @xmath556 such that 1 .",
    "@xmath557 , 2 .",
    "each summand @xmath482 with @xmath483 appears in  ( [ en4 ] ) at most once , * over all splittings @xmath558 satisfying the restriction @xmath559 ,    and factorized by simultaneous permutations in the both splittings ( [ en4 ] ) and ( [ en96 ] ) .",
    "[ rn1 ]    1 .",
    "the second sum in the right - hand side of ( [ en5 ] ) becomes empty if @xmath560 is not effective .",
    "notice also that , under the hypotheses of theorem  [ tn1 ] , one has @xmath561 . indeed , with our choice of @xmath4 and @xmath25",
    ", the inequalities @xmath562 and @xmath563 may occur only in the case @xmath564 , @xmath565 , and @xmath566 , but then @xmath567 since @xmath568 .",
    "2 .   the divisors @xmath569 , @xmath475 , in ( [ en5 ] ) satisfy @xmath570 .    *",
    "proof of theorem 1*. the cases @xmath259 , @xmath571 , can be reduced to the case of @xmath302 by means of blowing up @xmath572 at appropriately chosen @xmath573 points .",
    "indeed , let @xmath574 be the blow - up under consideration , @xmath575 the strict transform of @xmath25 , and @xmath82 , @xmath83 , @xmath576 the exceptional divisors of  @xmath577 whose images belong to  @xmath25 .",
    "according to the pull - back formula @xmath578 and due to the fact that the numbers @xmath537 are enumerative , the map which sends a decomposition @xmath579 to the decomposition @xmath580 gives rise to a 1-to-1 correspondence between the summands in the right - hand side of formula ( [ en5 ] ) for @xmath4 and @xmath581 .",
    "the proof of formula ( [ en5 ] ) for @xmath302 follows the scheme of @xcite .",
    "lemma [ ln1 ] provides the ( expected ) upper bound to the dimension of the considered families of curves and ensures required properties of generic elements in the families of expected dimension .",
    "the fact that multiple components do not appear in degenerations follows from lemmas [ ln1 ] and [ lnov1 ] . finally , the condition that each summand @xmath482 with @xmath483 may appear in ( [ en4 ] ) at most once follows from lemmas [ ltn2 ] and [ lnov1 ] and from the fact that the second sum in the right - hand side of ( [ en4 ] ) corresponds to the degenerations described in lemma [ lnov1 ] ( cf . ,",
    "* section 3 ) and ( * ? ? ? * section 5 ) ) .",
    "@xmath582      [ tn2 ] all the numbers @xmath537 with @xmath583 are determined recursively by formula ( [ en5 ] ) and the following list of initial values .",
    "\\(1 ) in the cases @xmath259 , @xmath584 , one has    1 .",
    "@xmath585 as long as @xmath586 , 2 .",
    "if @xmath587 , then @xmath588 for each @xmath261 , 3 .   if @xmath589 , then @xmath590 .",
    "\\(2 ) in the case @xmath591 one has    1 .",
    "@xmath592 , 2 .",
    "@xmath588 for @xmath593 , 3 .",
    "@xmath594 .",
    "\\(3 ) in the case @xmath595 one has    1 .",
    "@xmath596 for @xmath423 , 2 .",
    "@xmath588 for @xmath593 , 3 .",
    "@xmath594 .",
    "\\(4 ) in the case @xmath302 one has    1 .",
    "@xmath596 for @xmath423 , 2 .",
    "@xmath597 for @xmath425 , @xmath426 , 3 .",
    "@xmath588 for @xmath428 , 4 .",
    "@xmath598 for @xmath423 , 5 .",
    "@xmath599 as long as @xmath431 .",
    "\\(5 ) @xmath600 for all other tuples @xmath601 such that either @xmath602 , or @xmath603 .",
    "straightforward from lemmas [ ln1 ] and [ ltn2 ] .      for further purposes , we switch the ground field  @xmath604 to the ( algebraically closed ) field of complex locally convergent puiseux",
    "series @xmath605 ; this does not affect the enumerative invariants under consideration .",
    "in addition , we rewrite vakil s recursive formula  ( [ en5 ] ) in a slightly different way .",
    "we specialize the formula to the case @xmath302  and @xmath606 ; the other cases can be reduced to this one in the same way as in the proof of theorem  [ tn1 ] .",
    "define the sub - semigroup @xmath607 by @xmath608 notice that the condition @xmath609 , @xmath610 , in the definition of @xmath611 means that @xmath520 and @xmath612 are excluded from the semigroup generators .",
    "[ tn3 ] ( 1 ) if @xmath613 and @xmath614 , then @xmath615 @xmath616 where @xmath617 and the second sum in  ( [ en8 ] ) is taken    * over all elements  @xmath618 such that @xmath619 , * over all splittings @xmath620 of all possible collections @xmath621 such that 1 .",
    "@xmath557 , 2 .",
    "each summand @xmath482 with @xmath483 appears in ( [ en9 ] ) at most once , * over all splittings @xmath622 satisfying the restriction @xmath559 ,    and factorized by simultaneous permutations in the both splittings ( [ en9 ] ) and ( [ en98 ] ) .",
    "\\(2 ) formula ( [ en8 ] ) recursively determines all the numbers @xmath537 , @xmath613 , from the data listed in theorem [ tn2 ] ( 4(ii)- 4(v),5 )",
    ".    * proof . * due to condition  ( b ) in theorem [ tn1 ] , each splitting  ( [ en4 ] ) contains at most one summand with @xmath623 and at most one summand with @xmath624 .",
    "the second sum in the right - hand side of formula ( [ en8 ] ) is obtained by subdividing the second sum of the right - hand side of ( [ en5 ] ) in four sums according to the presence of summands with @xmath625 and @xmath624 in  ( [ en4 ] ) .",
    "the list of initial conditions is obtained from the list given in theorem  [ tn2](4 , 5 ) by removing the cases @xmath626 and @xmath627 .",
    "let  @xmath205 and  @xmath206 be non - negative integers such that @xmath207 . introduce the space @xmath629 formed by the ( ordered ) _ configurations _ of @xmath209 points in @xmath630 such that    * @xmath631 is a sequence of @xmath205 points on @xmath115 , * @xmath632 is a sequence of @xmath633 points in @xmath129 , * @xmath634 is a point in @xmath129 , * for any indices @xmath137 and @xmath138 such that @xmath635 , the first coordinate of @xmath636 is less than the first coordinate of @xmath637 , * for any index @xmath137 such that @xmath638 , the second coordinate of @xmath639 is less than the second coordinate of @xmath636 .",
    "consider a finite multi - set  @xmath200 of vectors in @xmath201 , two non - negative integers @xmath211 and @xmath203 , an integer  @xmath204 , and two elements @xmath157 and @xmath640 in @xmath641 .",
    "we say that the collection @xmath642 is _",
    "@xmath643-admissible _ if    * @xmath644 and @xmath645 , where @xmath646 is the number of vectors in the multi - set  @xmath200 , * the sum of the vectors in  @xmath200 is equal to  @xmath43 , and each vector in  @xmath200 belongs to the list @xmath647 , @xmath648 , @xmath649 , @xmath650 , @xmath651 , @xmath652 , * the number of vectors @xmath652 in  @xmath200 is non - zero and equal to @xmath653 , * @xmath654 , where @xmath655 is the number of vectors in  @xmath200 which have non - negative coordinates , @xmath656 is the number of vectors @xmath657 in  @xmath200 , and @xmath658 is the number of vectors @xmath650 in  @xmath200 .",
    "* @xmath659 , where @xmath660 is the number of vectors @xmath651 in  @xmath200 .",
    "since the sum of the vectors in  @xmath200 is equal to  @xmath43 , there exists a convex lattice polygon @xmath661 , possibly reduced to a vertical segment , such that    * each vector in @xmath200 is an outgoing normal vector of a certain side of @xmath661 , * for each side  @xmath662 of @xmath661 , the integer length of  @xmath662 ( _ i.e. _ , its number of integer points diminished by  @xmath65 ) is equal to the multiplicity of the outgoing normal vector of  @xmath662 in @xmath200 .",
    "such a polygon @xmath661 is unique up to translation by a vector with integer coordinates .",
    "the geometric meaning of the number  @xmath655 appearing in the definition of an @xmath663-admissible collection is as follows : @xmath655 is the smallest positive integer such that @xmath661 can be shifted into the triangle with vertices @xmath664 , @xmath665 , @xmath666 .",
    "the multi - set of vectors @xmath667 , where @xmath668 runs over all couples of points of @xmath661 which have integer coordinates , is denoted by @xmath669 .",
    "we say that a finite multi - set @xmath670 of vectors in @xmath201 _ dominates _",
    "@xmath200 , if @xmath671 ( since @xmath669 is finite , there always exists a finite multi - set  @xmath670 which dominates  @xmath200 ) .    [ finite ] for any integers @xmath672 and any finite multi - set @xmath670 of vectors in @xmath201 , the set of @xmath663-admissible collections @xmath673 such that @xmath670 dominates @xmath200 is finite",
    ".    straightforward .    for any @xmath674 and any @xmath663-admissible collection @xmath673 ,",
    "the points of @xmath675 are naturally divided into groups : the first group consists of the first @xmath676 points of @xmath675 , the second group consists of the next @xmath677 points of @xmath675 , and so on .    for",
    "any @xmath674 and any @xmath663-admissible collection @xmath673 , introduce the set @xmath678 ( respectively , @xmath679 ) of isomorphism classes of irreducible marked pseudo - simple @xmath101-curves  @xmath680 ( respectively , irreducible symmetric marked pseudo - simple @xmath241-curves @xmath681 ) satisfying the following conditions :    * @xmath682 is of genus  @xmath204 and degree @xmath683 , where @xmath683 is obtained from @xmath200 by replacing @xmath684 vectors @xmath652 with @xmath685 vectors @xmath686 for each positive integer  @xmath137 ; * @xmath687 , @xmath688 ; * if @xmath689 , then @xmath690 ; * the number of points in @xmath691 is equal to @xmath692 , @xmath693 , * any point @xmath694 is contained in the image of a left end of @xmath682 of weight @xmath695 .",
    "[ rem - sym ] ( 1 ) the set @xmath696 is nonempty only if @xmath256 .",
    "\\(2 ) if @xmath697 or @xmath698 , then any symmetric marked @xmath241-curve @xmath699 whose isomorphism class belongs to @xmath700 has a connected graph @xmath21 , _",
    "i.e. _ , the marked @xmath241-curve @xmath147 is irreducible .",
    "\\(3 ) assume that @xmath701 and the isomorphism class of an irreducible symmetric marked @xmath101-curve @xmath702 with disconnected graph @xmath21 belongs to @xmath703 @xmath704 .",
    "then , @xmath705 , all the points of @xmath191 are mapped to @xmath706 , and as it follows from the last condition in the definition of marked @xmath101-curves and the last condition in the definition of @xmath707-admissible collections ,    * @xmath708 , @xmath334 , @xmath709 , @xmath710 , @xmath711 , * @xmath26 consists of two edges interchanged by  @xmath245 and mapped by  @xmath31 onto the horizontal straight line passing through @xmath706 ( see figure [ lines ] ) .",
    "( 11,2)(-3,0 ) ( 0,1)(1,0)4(3,0.87)@xmath163 ( 5,0.9)@xmath712(2.9,0.5)@xmath706 ( 1.4,1.1)@xmath713(3.5,1.1)@xmath713    the collection @xmath714 is denoted by @xmath715 , and the isomorphism class described is denoted by @xmath716 .",
    "if @xmath717 , there is a well - defined forgetful map @xmath718 @xmath719= [ ( \\overline{{\\gamma}},{\\cal v},h,{{\\boldsymbol p}})]\\ .\\ ] ]    let @xmath670 be a finite multi - set of vectors in @xmath201 .",
    "a configuration @xmath674 is called a _ weak @xmath720-configuration of type @xmath663 _ if there exist a positive real number  @xmath721 and real numbers @xmath722 such that    * for each integer @xmath723 , @xmath83 , @xmath209 , the point @xmath636 belongs to the rectangle @xmath724 , * for any @xmath663-admissible collection @xmath673 having @xmath725 and dominated by @xmath670 , and for each marked @xmath101-curve @xmath726 whose isomorphism class belongs to @xmath727 , the following properties hold : 1 .",
    "the image under  @xmath31 of any vertex of @xmath21 has the first coordinate different from @xmath728 , @xmath729 , @xmath83 , @xmath209 .",
    "any edge  @xmath25 of @xmath21 such that the image @xmath32 of  @xmath25 intersects one of the vertical segments @xmath730 with endpoints @xmath731 and @xmath732 , @xmath729 , @xmath83 , @xmath209 , is horizontal , 3 .   for each integer @xmath733 and each irreducible component @xmath703 @xmath734 of a marked cut of @xmath735 at @xmath736 ( where @xmath737 is the inverse image under  @xmath31 of the segment @xmath730 , the curve @xmath738 is a marked cut of @xmath159 at @xmath739 , and @xmath740 ; notice that @xmath739 and @xmath741 are sparse ) , non - emptiness of @xmath742 implies that @xmath743 is either horizontal or one - sheeted ( see figure  [ new - picture5 ] ) , 4 .   for each irreducible component @xmath744 of a marked cut of @xmath147 at @xmath745 ,",
    "the non - emptiness of @xmath746 implies that @xmath747 is horizontal .",
    "let @xmath674 be a weak @xmath720-configuration .",
    "numbers @xmath721 , @xmath748 , @xmath83 , @xmath749 certifying that @xmath231 is a weak @xmath720-configuration are said to be _ parameters _ of  @xmath231 ( of course , these parameters are far from being unique ) .",
    "the parameter  @xmath721 is called _ vertical _ , and the parameters @xmath748 , @xmath83 , @xmath749 are called _",
    "horizontal_. pick a marked @xmath101-curve @xmath147 whose isomorphism class belongs to @xmath678 . for any integer @xmath733 , put @xmath750 , where @xmath730 is defined in  ( 2 ) above , and consider a marked cut @xmath751 of @xmath159 at  @xmath737 . an irreducible component @xmath752 of @xmath751",
    "is called _ left _",
    "( respectively , _ right _ ) if @xmath753 ( respectively , @xmath754 ) .    ( 15,7)(-1,0 ) ( 0.5,3)(1,0)3(0.5,4)(1,0)5.5(0.5,5.5)(1,0)3 ( 4,2.5)(1,0)2(6.5,2)(1,0)2.5(3.5,3)(1,-1)0.5 ( 6,2.5)(1,-1)0.5 ( 3.5,3)(0,1)2.5(4,0.5)(0,1)2(6,2.5)(0,1)1.5 ( 6.5,0.5)(0,1)1.5(9,0.5)(0,1)1.5 ( 3.5,5.5)(1,1)1(6,4)(1,1)2.5(9,2)(1,1)4.5 ( 0.5,0.5)(0,1)6.5(0.5,1)(14.5,1)(0.5,6)(14.5,6 ) ( 1,1)(1,6)(2.2,1)(2.2,6)(3,1)(3,6 ) ( 4.5,1)(4.5,6)(5.4,1)(5.4,6)(8.5,1)(8.5,6 ) ( 13.5,1)(13.5,6 ) ( 0.4,5.35)@xmath163(1.5,3.85)@xmath163(2.5,2.85)@xmath163 ( 3.65,2.65)@xmath163(4.8,2.35)@xmath163(5.93,3.2)@xmath163 ( 8.9,1.85)@xmath163 ( 0.2,0.9)@xmath755(-0.1,5.9)@xmath756(0.6,6.6)@xmath115 ( 0.9,0.5)@xmath757(1.3,4.25)@xmath758(6.2,3.2)@xmath759(8.4,0.5)@xmath760(9.2,1.8)@xmath761 ( 13.3,0.5)@xmath762    for any configuration @xmath674 and any integer number @xmath763 , the configuration , which belongs to @xmath764 and is obtained from  @xmath231 by removing the points @xmath765 , @xmath83 , @xmath766 from @xmath767 and inserting their horizontal projections to @xmath115 into @xmath675 at arbitrary places , is called the _ @xmath768-projection _ of  @xmath231 .",
    "a configuration @xmath674 is called a _",
    "@xmath720-configuration of type @xmath663 _ if there exist a positive real number  @xmath721 and real numbers @xmath748 , @xmath83 , @xmath749 such that    * for any non - negative integers  @xmath769 and  @xmath770 satisfying the inequalities @xmath771 and @xmath772 , any subconfiguration @xmath773 such that @xmath774 is a weak @xmath720-configuration of type @xmath775 and has parameters @xmath721 , @xmath776 , @xmath83 , @xmath777 , @xmath749 , where @xmath778 ; * for any integer number @xmath763 , any @xmath768-projection of  @xmath231 is a weak @xmath720-configuration of type @xmath779 having @xmath721 , @xmath780 , @xmath83 , @xmath781 , @xmath749 as parameters .",
    "[ ch - existence ] let  @xmath205 and  @xmath206 be non - negative integer numbers such that @xmath782 , and @xmath670 a finite multi - set of vectors in @xmath201 . then , the set of @xmath720-configurations in @xmath783 contains a non - empty subset which is open in @xmath783 .",
    "the proof of proposition  [ ch - existence ] is based on the following lemmas .",
    "[ splitting ] .",
    "let  @xmath205 and  @xmath206 be non - negative integer numbers such that @xmath207 , and let @xmath784 be an @xmath663-admissible collection such that @xmath725 .",
    "fix a positive real number  @xmath721 and two real numbers @xmath785 and @xmath786 such that @xmath787 .",
    "consider a configuration @xmath674 such that    * the second coordinates of all points in  @xmath231 belong to the interval @xmath788 , * no first coordinate of a point in @xmath789 belongs to the interval @xmath790 $ ] .",
    "then , for each marked @xmath101-curve @xmath156 whose isomorphism class belongs to @xmath216 @xmath727 , the second coordinate of the image under  @xmath31 of any vertex of @xmath26 belongs to the interval @xmath788 .",
    "furthermore , if the length of the interval @xmath790 $ ] is sufficiently large with respect to  @xmath721 , then there exist real numbers  @xmath791 and  @xmath792 such that @xmath793 and satisfying the following condition : for each marked @xmath101-curve @xmath147 whose isomorphism class belongs to @xmath794 , the intersection of  @xmath128 with the rectangle @xmath795 consists of horizontal segments .",
    "the proof is completely similar to the proof of lemma  28 in  @xcite , but since our present setting is slightly different from the one in  @xcite , we repeat the proof here .    consider a marked pseudo - simple @xmath101-curve @xmath726 whose isomorphism class belongs to @xmath727 . among the non - univalent vertices of  @xmath21 ,",
    "choose a vertex  @xmath33 whose image @xmath796 has the maximal second coordinate .",
    "the curve @xmath216 @xmath147 has an end  @xmath25 such that  @xmath25 is incident to  @xmath33 and the second coordinate of the vector @xmath39 is positive .",
    "this end is of weight  @xmath65 and @xmath39 is equal either to @xmath657 , or to @xmath649 .",
    "hence , @xmath156 should have another edge  @xmath797 such that  @xmath797 is incident to  @xmath33 and the second coordinate of the vector @xmath798 is non - negative . if @xmath799 , the connected component of @xmath800 containing @xmath33 has at least two non - rigid ends , which is impossible by the definition of marked @xmath241-curves .",
    "in the same way one shows that @xmath21 has no non - univalent vertex whose image under  @xmath31 is below the line @xmath801 .",
    "this proves the first statement of the lemma .",
    "denote by  @xmath802 the rectangle @xmath803 .",
    "it follows from the first statement of the lemma , that the image under  @xmath31 of any path  @xmath804 does not intersect at least one of the two horizontal edges of  @xmath802 .",
    "let  @xmath805 be a point such that @xmath806 belongs to the interior of  @xmath802 , and  @xmath361 belongs to a non - horizontal edge of @xmath21 .",
    "then , there exists a path @xmath807 having  @xmath361 as an extreme point and such that @xmath808 is the graph of a strictly monotone function  @xmath809 defined either on the interval @xmath810 $ ] , or on the interval @xmath811 $ ] . since there are only finitely many slopes that can be realized by the images of edges of a parameterized plane tropical curve of degree  @xmath683 , the length of the definition interval of  @xmath809 is bounded from above by a constant depending only on  @xmath200 and  @xmath721 .",
    "this proves the second statement of the lemma .",
    "[ floors ] let  @xmath205 and  @xmath206 be non - negative integer numbers such that @xmath782 , and let @xmath673 be an @xmath643-admissible collection such that @xmath725 . fix a positive real number  @xmath721 and two real numbers @xmath812 and @xmath813 such that @xmath814 . consider a configuration @xmath674 such that    * the second coordinates of all points in  @xmath231 belong to the interval @xmath788 , * there exists a point in @xmath767 such that the first coordinate of this point belongs to the interval @xmath815 , and no other point in @xmath789 has the first coordinate in the interval @xmath816 $ ] .",
    "pick an irreducible marked pseudo - simple @xmath101-curve @xmath147 satisfying the following properties : its isomorphism class belongs to @xmath817 , and each edge  @xmath25 of @xmath21 such that the image @xmath32 of  @xmath25 intersects one of the two vertical segments @xmath818 with endpoints @xmath819 and @xmath820 , @xmath56 , is horizontal . consider a marked cut @xmath821 of @xmath147 at @xmath822 . then , any irreducible component @xmath823 @xmath824 of a marked cut of @xmath821 at @xmath825 such that @xmath826 is either horizontal or one - sheeted .",
    "assume that an irreducible component @xmath827 is neither horizontal , nor one - sheeted .",
    "then , @xmath828 has at least four non - horizontal ends @xmath82 , @xmath96 , @xmath829 , and @xmath830 .",
    "lemma  [ splitting ] implies that the images under  @xmath831 of all non - univalent vertices of @xmath832 belong to the rectangle @xmath833 and at least three of the ends @xmath82 , @xmath96 , @xmath829 , and @xmath830 are non - rigid .",
    "this contradicts the fact that @xmath834 has at most two connected components whose images under  @xmath835 intersect the strip @xmath836 .",
    "* proof of proposition  [ ch - existence]*. the statement follows from lemmas  [ splitting ] ,  [ floors ] , and the fact that the number of @xmath775-admissible collections @xmath837 such that @xmath772 , and  @xmath670 dominates  @xmath200 , is finite .",
    "let  @xmath205 and  @xmath206 be non - negative integer numbers such that @xmath782 , and @xmath670 a finite multi - set of vectors in @xmath201 .",
    "a configuration @xmath674 is called _ @xmath670-generic _",
    ", if the following condition is satisfied : for any end - marked rational marked @xmath101-curve @xmath838 such that its degree is contained in  @xmath670 and @xmath839 , the image under  @xmath31 of the non - rigid end of @xmath159 does not contain any point of  @xmath231 .",
    "let @xmath840 be the subset formed by the @xmath670-generic configurations .",
    "the following lemma is an immediate consequence of  ( * ? ? ?",
    "* lemma 2 ) .",
    "[ genericity ] let  @xmath205 and  @xmath206 be non - negative integer numbers such that @xmath782 , and @xmath670 a finite multi - set of vectors in @xmath201 . then , the subset @xmath841 is dense in @xmath842.@xmath582      introduce the set @xmath843 of the admissible @xmath844-tuples @xmath784 , each @xmath844-tuple @xmath629 @xmath784 being @xmath663-admissible for certain non - negative integer numbers  @xmath205 and  @xmath206 such that @xmath207 ( recall that by the definition of @xmath707-admissibility , @xmath845 and @xmath846 ) .",
    "define in @xmath843 the following operation : @xmath847    let  @xmath205 and  @xmath206 be non - negative integer numbers such that @xmath782 .",
    "fix an @xmath663-admissible collection @xmath848 , choose a multi - set @xmath670 dominating @xmath200 , and consider a @xmath720-configuration  @xmath231 of type @xmath663 .",
    "let @xmath721 , @xmath748 , @xmath83 , @xmath749 be parameters of  @xmath231 . for",
    "any @xmath729 , @xmath83 , @xmath206 , denote by @xmath730 the vertical segment with the endpoints @xmath731 and @xmath732 .",
    "denote by @xmath849 the set formed by the isomorphism classes of irreducible marked pseudo - simple @xmath101-curves @xmath147 such that    1 .   for any integer @xmath850 and any irreducible component @xmath851 of a marked cut of @xmath147 at @xmath852 ,",
    "no two right irreducible components of a marked cut of @xmath853 at @xmath854 are isomorphic , 2 .",
    "any right irreducible component @xmath855 of a marked cut of @xmath216 @xmath147 at @xmath856 has one of the combinatorial types presented in figure  [ fn2 ] ( the collection @xmath857 is empty , and the symbol  @xmath163 which does not coincide with a univalent vertex represents the only element in @xmath858 ; this symbol  @xmath163 is equipped with an index  @xmath137 if and only if the corresponding point belongs to @xmath859 , @xmath860 ) .",
    "( 11,14)(-1,-1 ) ( 0,2)(1,0)3(3,2)(0,-1)1 ( 3,2)(1,1)1(0,6)(1,0)3 ( 3,6)(0,-1)1(3,6)(1,1)0.5(0,9)(1,0)4 ( 0,12.5)(1,0)4 ( 5.5,2)(1,0)2(5.5,2.5)(1,0)2(7.5,2)(0,11 ) 0.5 ( 7.5,2.5)(1,1)0.5(7.5,2)(1,-1)0.5(8,1.5)(0 , -1)0.5 ( 8,1.5)(1,0)2(5.5,6)(1,0)2(7.5,6)(1,1)0.5 ( 7.5,6)(1,-1)0.5(8,5.5)(0,-1)0.5(8,5.5)(1,0 ) 2 ( 5.5,9.5)(1,0)2(8,9)(0,-1)0.5(7.5,9.5)(1,-1 ) 0.5 ( 8,9)(1,0)2(7.5,9.5)(0,1)0.5(5.5,13)(1,0 ) 2.5 ( 8,13)(1,1)0.5(8,13)(0,-1)0.5(8,12.5)(-1,-1 ) 0.5 ( 8,12.5)(1,0)2(2.91,5.37)@xmath163 ( 2.9,1.89)@xmath163(2.9,8.89)@xmath163 ( 7.9,1.38)@xmath163(7.9,5.4)@xmath163(7.9,8.87)@xmath163 ( 7.9,12.37)@xmath163 ( -0.16,5.88)@xmath163(-0.16,12.38)@xmath163(5.35,1.89)@xmath163 ( 5.35,2.38)@xmath163 ( 5.35,5.88)@xmath163(5.35,9.38)@xmath163(5.35,12.87)@xmath163 ( 0,0)@xmath861(5.5,0)@xmath862(0,4)@xmath863(5.5,4)@xmath864(0,7.5)@xmath865(5.5,7.5)@xmath866(0,11)@xmath867(5.5,11)@xmath868(3.2,5.4)@xmath137(3,9.2)@xmath137(6.5,6.1)@xmath713 ( -0.5,-1)@xmath869    notice that the set @xmath870 does not depend on the choice of parameters @xmath721 , @xmath748 , @xmath83 , @xmath749 , of  @xmath231 .    for each @xmath871 \\in{\\cal t}^c({{\\delta } } ,",
    "k_1 , k_2 , g , { { \\alpha } } , { { \\beta } } , { { \\boldsymbol p}})$ ] , define the _ complex multiplicity _ @xmath872 as @xmath873 , where  @xmath132 is the product of weights of all left ends of @xmath21 which are not of @xmath157-type , and  @xmath874 is the product of squares of weights of all bounded edges of @xmath21 . put @xmath875    [ rn56 ] the complex multiplicity @xmath876 defined above coincides with the complex weight @xmath877 introduced in ( * ? ? ?",
    "* section 2.6 ) .",
    "this can easily be checked applying ( * ? ? ?",
    "* formula ( 7 ) ) to the classes @xmath878 .",
    "assume that  @xmath200 has a subset  @xmath879 formed by two vectors : one with a positive second coordinate and the other with a negative second coordinate .",
    "the sum of the vectors of @xmath879 is either @xmath43 , or @xmath880 , or @xmath881 . in the first case ,",
    "put @xmath882 to be the multi - set  @xmath883 , and , in the two other cases obtain @xmath882 from  @xmath883 by adding or removing vector @xmath652 in such a way that the sum of the vectors in @xmath882 becomes  @xmath43 .",
    "[ inv1 ] let  @xmath207 be non - negative integer numbers . fix an @xmath643-admissible collection @xmath673 and choose a multi - set  @xmath670 dominating  @xmath200 .",
    "let  @xmath231 be a @xmath670-generic @xmath720-configuration of type @xmath663 . then",
    ", the number @xmath884 does not depend on the choices of  @xmath670 and  @xmath231 .",
    "such an independence allows us to write simply @xmath885 for @xmath629 @xmath886 as soon as @xmath673 and  @xmath231 are as in proposition  [ inv1 ] .",
    "notice that according to our definitions , @xmath887 whenever @xmath549 .",
    "the proof of proposition  [ inv1 ] is given below , simultaneously with the proof of the following theorem .",
    "[ chtrop - for ] let  @xmath888 be non - negative integer numbers . if @xmath837 is an @xmath663-admissible collection , then @xmath889 @xmath890 @xmath891 where @xmath892 @xmath893 and the second sum in  ( [ en21 ] ) is taken    * over all subsets @xmath879 of  @xmath200 which are formed by two vectors , one with a positive second coordinate and the other with a negative second coordinate , and such that the multi - set @xmath882 contains at least one vector @xmath894 , * over all splittings @xmath895 in @xmath843 of all possible collections @xmath896 with @xmath897 such that each summand @xmath898 with @xmath899 appears in ( [ en25 ] ) at most once , * over all splittings @xmath900 satisfying the restriction @xmath559 ,    and factorized by simultaneous permutations in the both splittings ( [ en25 ] ) and ( [ en - beta ] ) .",
    "* proof of proposition  [ inv1 ] and theorem  [ chtrop - for ] * ( cf .",
    "@xcite and  @xcite ) . in the case",
    "@xmath901 , the statement of proposition  [ inv1 ] immediately follows from the property  ( 4 ) in the definition of weak @xmath720-configurations and the property  ( ii ) of the set @xmath902 .",
    "consider now non - negative integers @xmath888 , fix an @xmath643-admissible collection @xmath216 @xmath903 , and choose a multi - set  @xmath670 dominating  @xmath200 .",
    "assume that for any non - negative integer numbers @xmath904 and @xmath905 satisfying the inequalities @xmath906 and @xmath907 , the fact that the numbers @xmath908 , where @xmath909 is an @xmath910-admissible collection , and @xmath670 dominates @xmath911 , do not depend on the choice of a @xmath720-configuration  @xmath912 of type @xmath910 is already established .",
    "pick a @xmath670-generic @xmath720-configuration  @xmath231 of type @xmath663 and assume that there exists an irreducible marked @xmath101-curve @xmath147 whose isomorphism class belongs to @xmath216 @xmath902 .",
    "suppose , first , that the point  @xmath913 belongs to a left end  @xmath25 of  @xmath21 .",
    "denote by  @xmath138 the weight of  @xmath25 , and by  @xmath33 the unique univalent vertex incident to  @xmath25 .",
    "consider the @xmath720-configuration @xmath914 which is a @xmath65-projection of @xmath231 such that the horizontal projection of @xmath915 is inserted in the @xmath138-th group of points in @xmath675 .",
    "consider also an @xmath916-admissible collection @xmath917 , and a marked @xmath101-curve @xmath240 such that @xmath918 , @xmath919 , and @xmath920 for any @xmath921 .",
    "the isomorphism class of the curve @xmath922 belongs to @xmath923 , and @xmath924 the described procedure establishes a bijection between and those isomorphisms classes in that are realized by curves @xmath147 such that @xmath925 belongs to a left end of @xmath21 of weight  @xmath138 .",
    "thus , by the induction assumption , the contribution to @xmath926 of the latter isomorphism classes is equal to @xmath927    suppose now that @xmath925 does not belong to any left end of @xmath21 .",
    "let @xmath721 , @xmath748 , @xmath83 , @xmath928 be parameters of the @xmath720-configuration @xmath231 . consider a marked cut @xmath929 of @xmath147 at @xmath930 , where @xmath931 is the vertical segment with endpoints @xmath932 and @xmath933 .",
    "let @xmath934 , @xmath85 , @xmath83 , @xmath406 , be the right irreducible components of @xmath935 .",
    "for each @xmath85 , @xmath83 @xmath406 , introduce the following numbers :    * @xmath936 is the number of points in @xmath937 , and @xmath938 is the number of points in @xmath939 , * @xmath940 ( respectively , @xmath941 ) , @xmath942 being a positive integer , is the number of those left ends of weight  @xmath942 in @xmath943 which are of @xmath157-type ( respectively , not of @xmath157-type ) , * @xmath944 is the genus of @xmath945 , * @xmath946 ( respectively , @xmath947 ) is the number of points in @xmath948 ( respectively , @xmath949 ) .",
    "let @xmath950 be a configuration in @xmath951 such that @xmath952 and the @xmath953-th point of @xmath950 coincides with the @xmath954-th point @xmath634 of  @xmath231 . for each @xmath475 ,",
    "the collection @xmath955 is @xmath956-admissible , and @xmath957 \\in { \\cal t}^c({{\\delta}}^{(i ) } , k^{(i)}_1 , k^{(i)}_2 , g^{(i ) } , { { \\alpha}}^{(i ) } , \\beta^{(i ) } , { { \\boldsymbol p}}_{j_i})\\ .\\ ] ]    since @xmath925 does not belong to any left end of @xmath21 , among the left irreducible components of @xmath821 there is one ( and exactly one ) which is one - sheeted .",
    "denote this component by @xmath958 .",
    "the point @xmath925 belongs to @xmath959 and lies on a non - horizontal edge .",
    "any left end of @xmath959 is of @xmath157-type .",
    "the degree of @xmath960 contains two vectors having non - zero second coordinate .",
    "let  @xmath879 be the set formed by these two vectors .",
    "the sum @xmath961 taken in @xmath962 , gives a collection @xmath963 with certain @xmath964 .",
    "for each right irreducible component @xmath965 , any left end of @xmath157-type of this component matches the edge of a horizontal left irreducible component , and the edge - predecessor of the two edges in question is of @xmath157-type .",
    "thus , @xmath966 .",
    "since any left end of @xmath959 is of @xmath157-type , we obtain @xmath967 . for",
    "each @xmath85 , @xmath83 , @xmath406 , let the sequence @xmath968 encode the weights of the left ends of @xmath969 which match edges of @xmath970 .",
    "notice that @xmath971 for any @xmath85 , @xmath83 , @xmath406",
    ". furthermore , @xmath972 .",
    "finally , the fact that each summand @xmath973 with @xmath974 can not not appear twice in the sum  ( [ en21-new ] ) follows from the property  ( i ) of the set @xmath975 . thus , each marked @xmath101-curve whose isomorphism class belongs to @xmath976 gives rise to a subset @xmath977 and a pair of splittings  ( [ en25 ] ) and  ( [ en - beta ] ) satisfying all the conditions mentioned in the theorem .",
    "assume now that we are given a subset @xmath977 , a collection @xmath978 , and a pair of splittings  ( [ en25 ] ) and  ( [ en - beta ] ) such that all these data obey the restrictions listed in the theorem .",
    "put @xmath892 @xmath979    choose  @xmath406 pairwise disjoint subsequences @xmath980 , @xmath83 , @xmath981 of @xmath675 such that , for each @xmath982 , @xmath83 , @xmath406 , and each positive integer number @xmath942 , the number of points in @xmath983 which belong to the @xmath942-th group of @xmath675 is equal to @xmath940 ( the number of possible choices is equal to @xmath984 ) .",
    "choose  @xmath406 pairwise disjoint subsequences @xmath985 , @xmath83 , @xmath986 of @xmath987 such that , for each @xmath85 , @xmath83 , @xmath406 , the number of points in @xmath988 is equal to @xmath989 ( the number of possible choices is equal to @xmath990 ) . for each @xmath85 , @xmath83 , @xmath406 , denote by @xmath991 the sequence of points formed by the sequence @xmath983 , the sequence @xmath992 , and the point @xmath639 .",
    "each of these  @xmath406 sequences is a @xmath670-generic @xmath720-configuration .",
    "if all the sets @xmath993 are non - empty , then , for each @xmath85 , @xmath83 , @xmath406 , pick a marked @xmath101-curve @xmath994 whose isomorphism class belongs to @xmath995 . for each @xmath85 , @xmath83 , @xmath406 , and each positive integer number  @xmath942 , choose @xmath996 left ends of @xmath997 which are of weight  @xmath942 and are not of @xmath157-type ( the number of possible choices is equal to @xmath998 ) .",
    "there exists a unique isomorphism class @xmath999 \\in { \\cal t}^c({{\\delta } } , k_1 , k_2 , g , { { \\alpha } } , \\beta , { { \\boldsymbol p}})\\ ] ] such that the point @xmath925 does not belong to a left end of @xmath21 and the curves @xmath1000 , @xmath85 , @xmath83 , @xmath406 , are the right irreducible components of a marked cut @xmath1001 of @xmath159 at @xmath1002 .",
    "indeed , the isomorphism class of a unique left one - sheeted irreducible component @xmath1003 of @xmath1004 is given , up to composition of  @xmath31 with a horizontal shift , by the degree of this component ( the degree is the two vectors of @xmath879 completed by @xmath1005 vectors @xmath686 and @xmath1006 vectors @xmath1007 for any positive integer  @xmath137 ) , the points in @xmath1008 ( together with the distribution of these points by groups ) , and the heights and the weights of the chosen left ends of @xmath994 , @xmath85 , @xmath83 , @xmath406 ( see ( * ? ? ? * lemma 29 ) ) .",
    "the horizontal shift is uniquely determined by the position of the point @xmath915 , since this point should belong to the image of a non - horizontal edge of @xmath1009 due to the assumption that  @xmath231 is a @xmath670-generic configuration .",
    "furthermore , @xmath1010 thus , the contribution to @xmath1011 of the sets @xmath1012 @xmath1013 , @xmath85 , @xmath83 , @xmath406 , is equal to @xmath1014 @xmath1015 this implies that the number @xmath1016 depends neither on the choice of @xmath670 , nor on the choice of a @xmath670-generic @xmath720-configuration  @xmath231 of type @xmath663 , and proves the formula  ( [ en21 ] ) .",
    "@xmath582    [ initial - conditions ] all the numbers @xmath1017 , where @xmath1018 , are recursively determined by formula ( [ en21 ] ) of theorem  [ chtrop - for ] and the following initial values : for any non - negative integer  @xmath206 and any @xmath1019-admissible collection @xmath673 , the number @xmath885 is equal to  @xmath43 or  @xmath65 , and this number is equal to  @xmath65 if and only if the collection @xmath837 is of one of the combinatorial types presented on figure  [ fn2 ] , _ i.e. _ @xmath673 coincides with one of the following collections :    * @xmath1020 , * @xmath1021 , * @xmath1022 , * @xmath1023 , * @xmath1024 , * @xmath1025 , * @xmath1026 , * @xmath1027 , * @xmath1028 , * @xmath1029 ,    the description of the numbers @xmath885 , where @xmath673 is an @xmath1019-admissible collection and  @xmath206 a non - negative integer , follows from the property  ( 4 ) in the definition of weak @xmath720-configurations and the property  ( ii ) of sets @xmath216 @xmath870 .",
    "all the other numbers @xmath1017 , where @xmath629 @xmath1018 , can be expressed as linear combinations of these values by successive use of formula  ( [ en21 ] ) .",
    "denote by @xmath1030 the sub - semigroup of @xmath277 formed by the sequences  @xmath157 such that @xmath1031 for any positive integer  @xmath137 , and denote by @xmath1032 the sub - semigroup of @xmath962 formed by the @xmath844-tuples @xmath673 such that @xmath1033 .",
    "denote by @xmath1034 the sub - semigroup of @xmath1035 formed by the @xmath844-tuples @xmath1036 such that @xmath256 .",
    "let  @xmath205 and  @xmath206 be non - negative integer numbers such that @xmath782 .",
    "choose an @xmath663-admissible collection @xmath1037 , a finite multi - set @xmath670 dominating @xmath200 , and a @xmath670-generic @xmath720-configuration @xmath231 .",
    "for each isomorphism class @xmath1038\\in { \\cal t}^c({{\\delta } } , k_1 , k_2 , g , { { \\alpha } } , { { \\beta } } , { { \\boldsymbol p}})$ ] , define the _ welschinger multiplicity _ @xmath1039 to be equal to  @xmath65 if all the edges of @xmath21 have odd weight , and  @xmath43 otherwise",
    ". put @xmath1040 for any element @xmath1041 different from @xmath715 ( see section  [ ch - config ] ) , a finite multi - set @xmath670 dominating @xmath200 , and a @xmath670-generic @xmath720-configuration @xmath231 , introduce a subset @xmath1042 defined by @xmath1043 where @xmath1044 is the forgetful map ( [ esym1 ] ) .",
    "in addition , for any point @xmath1045 , we put @xmath1046 where @xmath1047 is as in section  [ ch - config ] .",
    "we consider the following welschinger multiplicities :    * @xmath1048 for all @xmath1049 with @xmath629 @xmath1050 , * @xmath1051 for any point @xmath1045 ,    and then put @xmath1052    [ inv1r ] let  @xmath207 be non - negative integer numbers . fix an @xmath643-admissible collection @xmath1053 ( respectively , @xmath1054 ) , and choose a multi - set  @xmath670 dominating  @xmath200 . let  @xmath231 be a @xmath670-generic @xmath720-configuration of type @xmath663 .",
    "then , the number @xmath1055 ( respectively , @xmath1056 ) does not depend on the choices of  @xmath670 and  @xmath231 .",
    "if @xmath1057 , the proof is completely similar to the proof of proposition  [ inv1 ] .",
    "furthermore , @xmath1058 for any point @xmath1045 .",
    "such an independence allows us to write simply @xmath1059 for @xmath629 @xmath1060 as soon as @xmath673 and  @xmath231 are as in proposition  [ inv1r ] .",
    "the latter requirement on @xmath673 and  @xmath231 is similar to the requirement on the constraints related to the enumerative invariants which appear in the recursive formula presented in  @xcite .",
    "the proof of the following proposition  [ chtrop - for - real ] is completely similar to the proof of theorem  [ chtrop - for ] .",
    "the only additional observation consists of the fact that , in the case of symmetric marked @xmath241-curves , the sets @xmath1061 are invariant with respect to the involution , and each cut inherits a uniquely defined involution .",
    "[ chtrop - for - real ] let  @xmath888 be non - negative integer numbers . fix an @xmath643-admissible collection @xmath1062 , where @xmath1063 stands either for @xmath1032 , or for @xmath1064",
    ". then @xmath1065 @xmath1066 @xmath1067 where @xmath1068 stands for @xmath1069 ( respectively , @xmath1070 ) if @xmath1071 ( respectively , @xmath1072 ) , and @xmath892 @xmath893 and the second sum in  ( [ en26 ] ) is taken    * over all subsets @xmath879 of  @xmath200 which are formed by two vectors , one with positive second coordinate and one with negative second coordinate , and such that the multi - set @xmath882 contains at least one vector @xmath652 , * over all splittings @xmath1073 in @xmath1063 of all possible collections @xmath1074 , such that @xmath897 and each summand @xmath1075 with @xmath1076 appears in ( [ en27 ] ) at most once , * over all splittings @xmath1077 satisfying the restriction @xmath1078 ,    and factorized by simultaneous permutations in the both splittings ( [ en27 ] ) and ( [ en97]).@xmath582    the proof of the next statement coincides with the proof of proposition [ initial - conditions ] .    [ initial - conditionsr ] all the numbers @xmath1079 , where @xmath1080 , and @xmath1063 stands either for @xmath1035 , or for @xmath1081 , are recursively determined by formula ( [ en26 ] ) of proposition  [ chtrop - for - real ] and the following initial values . for any non - negative integer  @xmath206 and any @xmath1019-admissible collection @xmath1082 , the number @xmath1083 is equal either to  @xmath43 , or to  @xmath65 .",
    "furthermore ,    1 .   if @xmath1084 , then @xmath1085 if and only if the collection @xmath216 @xmath673 coincides with one in the list presented in proposition  [ initial - conditions ] , 2 .",
    "if @xmath1086 , then @xmath1087 if and only if @xmath673 coincides with one of the following collections ( corresponding curves are shown in figures  [ fn2](a , d - h ) and  [ lines ] ) : * @xmath1020 , * @xmath1088 , * @xmath1089 , * @xmath1090 , * @xmath1091 , * @xmath1092 , * @xmath1093 . @xmath582",
    "let @xmath207 be non - negative integers , and @xmath670 a finite multi - set of vectors in @xmath201 .",
    "a configuration  @xmath1094 is called _ @xmath670-proper _ , if    * @xmath231 is a @xmath670-generic @xmath720-configuration , * for any integers @xmath1095 and @xmath1096 , any disjoint sub - configurations @xmath1097 and @xmath1098 of  @xmath231 such that @xmath774 and @xmath1099 , any @xmath775-admissible collection @xmath1100 and any @xmath1101-admissible collection @xmath1102 such that  @xmath670 dominates  @xmath1103 and @xmath1104 , one has the following property : 1 .   for any elements @xmath1105\\in{\\cal t}^c ( { { \\delta } } ' , k'_1 , k'_2 , g ' , { { \\alpha } } ' , { { \\beta } } ' , { { \\boldsymbol p}}')\\ , \\ ] ] @xmath1106\\in{\\cal t}^c ( { { \\delta } } '' , k''_1 , k''_2 , g '' , { { \\alpha } } '' , { { \\beta } } '' , { { \\boldsymbol p}}'')\\ , \\ ] ] the map @xmath1107 is injective .    [ ln10 ] for any non - negative integers @xmath888 and any finite multi - set  @xmath670 of vectors in @xmath201 , there exists a @xmath670-proper configuration @xmath674 .    * proof . *",
    "pick a configuration @xmath1108 in the interior of the set of @xmath670-generic @xmath720-configurations of type @xmath643 such that , for any integers @xmath1095 , any @xmath1109-admissible collection @xmath1110 , and any sub - configuration @xmath1111 of type @xmath775 , one has the following property :    1 .",
    "@xmath1112 does not belong to the image of any affine map @xmath1113 , where @xmath1114 is of dimension @xmath1115 .",
    "notice that the conditions imposed on @xmath1108 are open .",
    "a point @xmath1116 is called _ bad _ for @xmath1108 , if there exist integers @xmath1117 , an @xmath1109-admissible collection @xmath1118 , a sub - configuration @xmath1111 , a marked @xmath101-curve @xmath198 whose isomorphism class belongs to @xmath1119 , and a vertex @xmath1120 such that    * @xmath1121 , * in the case @xmath1122 and @xmath1123 , there exist integers @xmath1124 , an @xmath1101-admissible collection @xmath1125 , a sub - configuration @xmath1126 disjoint from @xmath1112 , a marked @xmath101-curve @xmath1127 whose isomorphism class belongs to @xmath1128 , and a vertex @xmath1129 such that @xmath1130 .",
    "lemma  [ finite ] and proposition  [ finiteness ] imply that the set @xmath1131 of bad points for @xmath1108 is finite .",
    "choose integers @xmath1117 , an @xmath775-admissible collection @xmath1110 , and a subconfiguration @xmath1112 of  @xmath1108 of type @xmath1109 .",
    "let @xmath1132 be a combinatorial type such that @xmath1133 ( see section  [ moduli - spaces ] for notation ) .",
    "if @xmath1134 , then @xmath217 is one of the combinatorial types presented in figure  [ fn2 ] .",
    "assume that @xmath1122 .",
    "due to the property  ( * ) above , the map @xmath222 is injective .",
    "thus , there exists a unique isomorphism class @xmath1135 \\in{\\cal t}^c({{\\delta } } ' , k'_1 , k'_2 , g ' , { { \\alpha } } ' , \\beta ' , \\widetilde{{\\boldsymbol p}}')$ ] such that @xmath198 is of combinatorial type  @xmath217 , and any small variation of @xmath1112 uniquely lifts to a variation of @xmath1135 $ ] inside @xmath1114 .",
    "the map @xmath1136 is injective on @xmath1137 by the definition of marked @xmath101-curves .",
    "let  @xmath33 be a point in @xmath1138 , and @xmath1139 be the connected component containing  @xmath33 .",
    "the component @xmath1140 does not contain any other univalent vertex of @xmath1141 ( see section  [ sec4 ] ) .",
    "this fact together with the property  ( ii ) in the definition of @xmath1142 implies that the boundary of @xmath1140 contains a point @xmath1143 .",
    "then , @xmath1144 . let  @xmath1145 be the edge incident to  @xmath38 . move slightly the point  @xmath1146 in the direction orthogonal to @xmath1147 keeping all the points of @xmath1148 fixed . due to",
    "* formula ( 4 ) ) , the corresponding variation of @xmath1149 $ ] in @xmath1150 changes the position of @xmath1151 in @xmath115 .",
    "this proves that the image of @xmath1152 under @xmath1136 can be made disjoint from any point in @xmath1153 .",
    "assume now that @xmath1154 for two distinct points @xmath1155 .",
    "the connected components @xmath1156 containing @xmath46 and @xmath47 , respectively , do not coincide . since @xmath1157 \\in{\\cal t}^c({{\\delta } } ' , k'_1 , k'_2 , g ' , { { \\alpha } } ' , \\beta ' , \\widetilde{{\\boldsymbol p}}')$ ] , the boundary of @xmath1158 , @xmath56 , contains a point in @xmath1159 .",
    "suppose that the second coordinate of @xmath1154 does not exceed the second coordinate of @xmath1160 . among the points in @xmath1159 which belong to the boundary of @xmath1161",
    ", choose a point @xmath1162 whose image has the minimal second coordinate .",
    "the point  @xmath1162 belongs to the boundary of exactly one component @xmath1158 , and moving the point @xmath1163 as above , we break the equality @xmath1154 .    repeating the described procedure for all @xmath1164 , we transform @xmath1112 to a certain configuration @xmath1165 and modify accordingly the configuration  @xmath1108 . due to lemma  [ finite ] , we can iterate similar procedures for all integers @xmath1095 , all @xmath775-admissible collections @xmath1118 , and all sub - configurations @xmath1111 of type @xmath775 in order to transform @xmath1108 to a @xmath670-proper configuration  @xmath674 . @xmath582",
    "[ new - corollary ] let @xmath888 be non - negative integers , @xmath903 an @xmath663-admissible collection , and @xmath670 a finite multi - set of vectors in @xmath201 such that  @xmath670 dominates @xmath200 .",
    "pick a @xmath670-proper configuration  @xmath231 of type @xmath663 and a class @xmath224 \\in { \\cal t}^c({{\\delta } } , k_1 , k_2 , g , { { \\alpha } } , { { \\beta } } , { { \\boldsymbol p}})$ ] . then , for any vertex  @xmath33 of @xmath21 such that the valency of  @xmath33 is greater than  @xmath135 , the following statements hold :    1 .",
    "all the edges adjacent to  @xmath33 are of weight  @xmath65 ; 2 .",
    "any irreducible component @xmath1166 of a marked cut of @xmath147 at @xmath33 has one of the combinatorial types presented in figure  [ fn2](b , d ) provided that @xmath1167 for certain added vertex @xmath1168 of @xmath1169 and the added edge @xmath1170 adjacent to @xmath1168 .",
    "if  @xmath25 is an edge adjacent to  @xmath33 such that @xmath32 is not horizontal , then  @xmath25 is of weight  @xmath65 due to the definition of @xmath720-configurations and the second condition in the definition of @xmath663-admissible collections .",
    "let  @xmath25 be a horizontal edge adjacent to  @xmath33 . in this case , one has @xmath108 . consider the irreducible component @xmath1166 of a marked cut of @xmath147 at @xmath33 such that  @xmath25 is the predecessor of an added edge @xmath1170 of @xmath1169 .",
    "since @xmath231 is @xmath670-proper , the combinatorial type of @xmath1171 belongs to the list presented in figure  [ fn2 ] .",
    "moreover , the added vertex @xmath1168 adjacent to @xmath1170 does not belong to @xmath1172 ( _ cf_. the proof of theorem  [ chtrop - for ] ) .",
    "thus , the combinatorial type of @xmath1166 is presented in figure  [ fn2](b , d ) , and @xmath25 is of weight  @xmath65 .      let @xmath1173 be non - negative integers , and @xmath837 an @xmath663-admissible collection as defined in section [ ch - config ] .",
    "assume that the vectors of @xmath200 , clockwise rotated by @xmath1174 , determine the boundary of a non - degenerate convex lattice polygon @xmath1175 having one of the shapes depicted in figure [ fn3 ] ( with slopes @xmath43 , @xmath1176 , or @xmath1177 ) .",
    "the field @xmath1178 of complex locally convergent puiseux series is equipped with the non - archimedean valuation @xmath1179 and the conjugation involution @xmath1180 .",
    "let @xmath1181 be the toric surface over @xmath1178 associated with @xmath1175 , and let be the blow - up of @xmath1182 at two generic points @xmath1183 such that @xmath1184 , where @xmath1185 is defined by @xmath1186 .",
    "denote by @xmath1187 the first chern class of the line bundle on @xmath1182 , generated by the global sections @xmath1188 , @xmath1189 , and introduce the divisor class @xmath1190 , where @xmath82 and @xmath96 are exceptional divisors of  @xmath577 , and @xmath211 , @xmath203 are non - negative integers .",
    "denote also by @xmath1191 the strict transform of the toric divisor in @xmath1182 associated with the left - most vertical side of @xmath1175 ( cf .",
    "figure [ fn3 ] ) , and denote by @xmath1192 the union of the strict transforms of the remaining toric divisors of @xmath1182 .",
    "we have a well - defined valuation map @xmath1193 which takes @xmath1194 to @xmath115 .",
    "we say that the @xmath148-tuple @xmath1195 is _ generated _ by the collection @xmath673 .",
    "let @xmath670 be a multi - set dominating @xmath200 , and @xmath231 a @xmath670-generic @xmath720-configuration of type @xmath663 such that @xmath1196 , @xmath593 .",
    "an ordered configuration @xmath1197 of @xmath206 distinct points of @xmath1198 is called an _ algebraic @xmath20-configuration over _",
    "@xmath231 if    * the map @xmath1199 takes @xmath1200 bijectively onto @xmath1201 , * the configuration @xmath1202 is generic among the configurations satisfying the preceding condition .",
    "if @xmath1202 is an algebraic @xmath628-configuration over  @xmath231 , denote by @xmath1203 the subset in @xmath300 represented by reduced irreducible curves @xmath14 of genus @xmath204 subject to the following restrictions :    * @xmath1204 , * @xmath319 is nodal and nonsingular along @xmath25 , * @xmath1205 consists of @xmath1206 distinct points and includes @xmath321 , * the intersection multiplicity @xmath1207 equals @xmath1208 for precisely @xmath1209 points @xmath1210 , * @xmath1211 .",
    "the set @xmath1212 is finite and the number of its elements is equal to @xmath1213 ( see lemma [ ln1 ] and section  [ general ] for a discussion of the corresponding complex enumerative problem and the definition of @xmath1213 ) .    [ tn11-new ] let @xmath673 , @xmath231 , @xmath4 , and @xmath10 be as above .",
    "then , for any algebraic @xmath628-configuration  @xmath1202 over  @xmath231 , there exists a multi - valued map @xmath1214 such that    * for each @xmath1215 , the set @xmath1216 consists of @xmath876 elements , * the sets @xmath1217 and @xmath1218 are disjoint if @xmath1219 .    in particular , for any algebraic @xmath628-configuration  @xmath1202 over  @xmath231 , one has @xmath1220",
    "let  @xmath1202 be an algebraic @xmath628-configuration over  @xmath231 , and  @xmath1221 an element of @xmath629 @xmath1222 .",
    "then , the set @xmath1216 is constructed using the patchworking procedure described in  @xcite .",
    "notice that  @xmath1221 and  @xmath1223 satisfy the hypotheses of ( * ? ? ?",
    "* theorem 2 ) .",
    "indeed ,    * the condition ( t1 ) in ( * ? ? ?",
    "* section 2.6 ) immediately follows from the definition of marked pseudo - simple @xmath241-curves ; * the condition  ( t2 ) in  ( * ? ? ?",
    "* section 3.1 ) follows from the definition of the set @xmath216 @xmath1224 ; * the @xmath1175-genericity of the configuration @xmath231 ( condition ( t3 ) in ( * ? ? ?",
    "* section 2.6 ) ) follows from the definition of @xmath670-generic @xmath1225-configurations ; * the condition  ( t4 ) in  ( * ? ? ?",
    "* section 3.1 ) follows from the statement  ( 1 ) in lemma  [ new - corollary ] ; * the condition  ( t5 ) in  ( * ? ? ?",
    "* section 3.1 ) follows from the statement  ( 2 ) in lemma  [ new - corollary ] ; * the condition  ( t6 ) in ( * ? ? ?",
    "* section 3.1 ) follows from lemma  [ new - corollary ] and the condition ( i ) in the definition of the set @xmath902 ; * the condition ( t7 ) in ( * ? ? ?",
    "* section 3.1 ) follows from the fact that , for any class @xmath1038 \\in { \\cal t}^c({{\\delta } } , k_1 , k_2 , g , { { \\alpha } } , { { \\beta } } , { { \\boldsymbol p}})$ ] , the first coordinate of @xmath98 for any vertex @xmath33 of @xmath26 does not exceed the first coordinate of @xmath761 ( cf .",
    "section [ sec42 ] ) .",
    "in addition , @xmath1223 matches restrictions ( a1)-(a4 ) in ( * ? ? ?",
    "* section 3.1 ) by construction , and meets condition ( a5 ) in ( * ? ? ?",
    "* section 3.1 ) by ( * ? ? ?",
    "* lemma 8) .",
    "thus , the required statement follows from ( * ? ? ?",
    "* theorem 2 ) .      to compare formulas ( [ en21 ] ) and ( [ en8 ] )",
    ", we construct a map @xmath1226 .",
    "any element @xmath1227 satisfies with @xmath330 and @xmath1228 due to @xmath562 , @xmath1229 ( @xmath1230 ) , and @xmath1231 .",
    "these data give rise to the numbers @xmath1232 and @xmath1233 , and the multi - set of vectors  @xmath200 formed by    * @xmath656 vectors @xmath657 , * @xmath1234 vectors @xmath648 , * @xmath1235 vectors @xmath649 , * @xmath658 vectors @xmath650 , * @xmath660 vectors @xmath651 , * @xmath1236 vectors @xmath652 .    ( 5,5.5)(-4,0 ) ( 1,1)(1,0)5(1,1)(0,1)4.5 ( 1,5)(3,3)(4,2)(5,1 ) ( 2,1)(-1,1)1(1,2)(0,1)1 ( 1,3)(1,0)2(3,3)(1,-1)1(2,1)(1,0 ) 2",
    "( 4,1)(0,1)1 ( 1.8,0.5)@xmath658(3.5,0.5)@xmath1237(5.1,1.1)@xmath655(0.5,1.9)@xmath658 ( -0.2,2.9)@xmath1238(0.7,4.9)@xmath655    the collection @xmath673 is @xmath643-admissible , and @xmath1195 is generated by @xmath673 ; _ cf_. section  [ sec6 ] ( the polygon @xmath1175 obtained from @xmath200 is shown in figure  [ fn7 ] ) . put @xmath1239 .",
    "[ ln4 ] the map @xmath1226 is an injective homomorphism of semi - groups which establishes a bijection between the initial conditions of ( [ en21 ] ) ( which are listed in proposition [ initial - conditions ] ) and the initial conditions of ( [ en8 ] ) ( which are indicated in proposition [ tn3](2 ) ) . in particular , @xmath1240 for any @xmath1241 and @xmath1242 .",
    "the fact that @xmath1243 is an injective homomorphism is straightforward .",
    "furthermore , @xmath1243 allows one to identify each splitting  ( [ en9 ] ) in the recursive formula  ( [ en8 ] ) with a splitting  ( [ en25 ] ) in the recursive formula  ( [ en21 ] ) .",
    "thus , the inequalities @xmath1244 follow from non - negativity of the coefficients of the aforementioned recursive formulas .",
    "the following statement is an immediate consequence of propositions  [ tn11-new ] and  [ ln4 ] .",
    "[ tn11 ] let @xmath207 be non - negative integers , @xmath903 an @xmath663-admissible collection , and @xmath670 a finite multi - set of vectors in @xmath201 such that  @xmath670 dominates @xmath200 .",
    "pick a @xmath670-proper configuration @xmath674 and an algebraic @xmath628-configuration  @xmath1202 over  @xmath231 .",
    "then , @xmath1245 where @xmath1195 is generated by @xmath1246 .",
    "from now on , we switch back the ground field to  @xmath604 .",
    "let @xmath4 be a real _ unnodal _ ( _ i.e. _ , not containing any rational @xmath1247-curve , @xmath1248 ) del pezzo surface with a connected real part @xmath1249 , and let @xmath1250 be a real effective divisor . consider a generic set  @xmath1202 of @xmath1251 real points of @xmath4 .",
    "the set @xmath1252 of real rational curves @xmath14 passing through the points of  @xmath1202 is finite , and all these curves are nodal and irreducible . due to the welschinger theorem  @xcite ( and the genericity of the complex structure on @xmath4 ) , the number @xmath1253 where @xmath1254 is the number of _ solitary nodes _ of @xmath319 ( _ i.e. _ , real points , where a local equation of the curve can be written over @xmath27 in the form @xmath1255 ) , does not depend on the choice of a generic set  @xmath1202 .",
    "we denote this welschinger invariant by @xmath3 .      put @xmath1256 , where @xmath1257 , @xmath9 ; see introduction .",
    "denote by  @xmath1258 the pull - back of a line in @xmath263 , and by @xmath1259 the exceptional curves of the blow up . in the case",
    "@xmath1260 , assume that @xmath82 and @xmath96 are conjugate imaginary .",
    "fix a smooth real rational curve @xmath25 linearly equivalent to ( cf .",
    "section [ initial ] )    * @xmath1258 for @xmath1261 , * @xmath1262 for @xmath1263 , * @xmath303 for @xmath1264 .",
    "denote by @xmath1265 the subset of @xmath1266 formed by the divisors representable by a real reduced irreducible over @xmath604 curve .",
    "[ l6n2 ] the set @xmath1265 consists of the following divisors :    * the divisors represented by real @xmath325-curves which cross  @xmath25 , * the divisors @xmath1267 satisfying @xmath1268 in the case @xmath1269 , and the divisors @xmath1270 satisfying @xmath1271 in the case @xmath1272 .",
    "the inequalities on the numbers @xmath1273 follow from the bzout theorem .",
    "real reduced irreducible curves representing the described divisors can be found , for example , in  @xcite .",
    "introduce the set @xmath1274 which consists of the triples @xmath1275 such that @xmath1276 and @xmath1277 . in the case @xmath1278 , include in @xmath1279 also the element @xmath1280 .",
    "the following statement is straightforward .",
    "[ l6n3 ] ( 1 ) for each element @xmath1281 different from @xmath1282 the quadruple @xmath1283 belongs to @xmath1284 , where @xmath1063 stands for @xmath1035 ( respectively , @xmath1285 ) if @xmath1286 ( respectively , @xmath1287 ) .",
    "\\(2 ) if @xmath1269 , each triple @xmath1288 presented in figure [ fn2 ] and relevant to the surface @xmath4 belongs to @xmath1274 .",
    "if @xmath1272 , each triple @xmath1288 presented in figure [ fn2](a , d - h ) and relevant to the surface @xmath4 belongs to @xmath1289 .",
    "@xmath582    consider the function @xmath1290 defined as follows :    * @xmath1291 if @xmath1292 , * @xmath1293 if @xmath1264 , * @xmath1294 if @xmath1295 ; * for any @xmath1281 different from those mentioned above , put @xmath1296 , where @xmath1297 ( see lemma  [ l6n3 ] ) and @xmath1068 stands for @xmath1069 or @xmath1070 according to @xmath1286 or @xmath65",
    ".    [ tn12 ] ( 1 ) for any divisor @xmath1298 , one has @xmath1299",
    "\\(2 ) for any element @xmath1281 such that @xmath1300 and @xmath1301 , the following formula holds @xmath1302 @xmath1303 where @xmath1304 , the number @xmath1305 is equal to @xmath1306 and the second sum in  ( [ en60 ] ) is taken    * over all sequences @xmath1307 of elements of @xmath1274 such that 1 .",
    "@xmath479 , 2 .   @xmath1308 and @xmath1309 , where @xmath1310 and @xmath1311 , 3 .",
    "each triple @xmath1312 with @xmath483 appears in ( [ en70 ] ) at most once , * over all splittings in @xmath1313 @xmath1314 satisfying the restriction @xmath1315 and @xmath1316 for all @xmath475 ,    and the second sum in ( [ en60 ] ) is factorized by simultaneous permutations in the sequence ( [ en70 ] ) and in the splitting ( [ en99 ] ) .",
    "\\(3 ) all the numbers @xmath1317 , where @xmath1318 , @xmath1298 , and @xmath1319 , are recursively determined by the formula ( [ en60 ] ) , the value @xmath1320 and the values @xmath1317 for the elements @xmath1318 with @xmath1321 .",
    "the latter initial values are equal to @xmath65 in the cases listed in figure  [ fn2 ] for @xmath1286 , the cases listed in figure  [ fn2](a , d - h ) for @xmath1260 , and vanish in all the remaining cases .",
    "* proof . *",
    "to prove the first statement of the theorem , put @xmath1322 and @xmath1323 where @xmath231 is an appropriate configuration of points .",
    "formula ( [ en47 ] ) follows from theorem [ tn11 ] and  ( * ? ? ?",
    "* theorem 3 ) .",
    "the latter theorem states that , for any @xmath703 @xmath1324 and the set @xmath1216 constructed in  @xcite for an algebraic @xmath628-configuration  @xmath1202 over  @xmath231 ( _ cf_. proposition  [ tn11-new ] ) , the sum of the welschinger signs @xmath1325 of the real rational curves  @xmath319 in @xmath1216 is equal to the welschinger multiplicity @xmath1326 of  @xmath1221 .",
    "( the number @xmath1326 appears in ( * ? ? ?",
    "* section 2.6 ) under the name of _ real weight _ ; our definition of @xmath1326 is a specialization of the definition of the real weight given there . )    to prove the second statement of the theorem , it is sufficient to establish formula ( [ en60 ] ) for @xmath1327 or @xmath18 ( _ cf_. proof of theorem [ tn1 ] ) .",
    "observe that by lemma [ l6n3 ] , one has @xmath1328 and the collection @xmath1329 belongs to @xmath1063 .",
    "this collection is @xmath707-admissible , where @xmath1330 and @xmath1331 . applying formula ( [ en26 ] ) to @xmath1332 in the left - hand side ( @xmath1068 stands for @xmath1069 or @xmath1333 according to @xmath1286 or @xmath65 ) ,",
    "we intend to equate the right - hand sides of ( [ en26 ] ) and ( [ en60 ] ) . clearly , the first sum in the right - hand side of ( [ en26 ] ) coincides with the first sum in the right - hand side of ( [ en60 ] ) .",
    "so , it remains to compare the second sums in the right - hand side of ( [ en26 ] ) and ( [ en60 ] ) . in view of remark [ rem - sym ] ,",
    "a non - zero value @xmath1334 with @xmath1335 is possible only if @xmath1278 and @xmath1336 .",
    "hence , the restrictions @xmath1337 for the second sum in the right - hand side of ( [ en26 ] ) yield that each factor @xmath703 @xmath1338 in a non - zero summand either coincides with @xmath1339 ( in this case @xmath1340 and @xmath1341 ; such a situation can occur only if @xmath1278 ) , or satisfy @xmath1342 and @xmath1343 .",
    "moreover , by theorem [ tn11 ] and ( * ? ? ?",
    "* theorem 3 ) , if @xmath1344 then @xmath1345 for some @xmath1346 , @xmath1347 .",
    "we complete the comparison of formulas  ( [ en26 ] ) and  ( [ en60 ] ) noticing that the summation over @xmath879 in  ( [ en26 ] ) is equivalent to the subdivision of the second sum of the right - hand side of  ( [ en60 ] ) in four sums according to the presence of sequences @xmath1348 and @xmath1349 in  ( [ en70 ] ) ( _ cf_. lemma  [ l6n3](1 ) and the proof of proposition  [ tn3 ] ) ) .",
    "the last statement of the theorem immediately follows from proposition [ initial - conditionsr ] and lemma [ l6n3](2 ) .",
    "@xmath582    theorem  [ tn12 ] gives a possibility to calculate welschinger invariants of the surfaces @xmath5 with @xmath1350 , @xmath1351 , @xmath1352 , and their blow - downs . here",
    "are some of the values .    * the case @xmath1353 , @xmath1354 or @xmath1355 , where @xmath1356 : @xmath1357 * the case @xmath1358 , @xmath1354 or @xmath1355 , where @xmath1356 : @xmath1359 * the case @xmath1360 , @xmath1354 or @xmath1355 , where @xmath1361 : @xmath1362 * the case @xmath1363 , @xmath1354 or @xmath1355 , where @xmath1361 : @xmath1364 * the case @xmath1365 : @xmath1366 * the case @xmath1367 ( the divisors @xmath82 , @xmath96 are imaginary , and the divisor @xmath520 is real ) : @xmath1368 * the case @xmath1369 , the real structure on @xmath4 is standard , that is , given by @xmath1370 , and @xmath10 is a curve of bi - degree @xmath649 : @xmath1371 * the case @xmath1372 ( we denote by @xmath1373 the real surface considered in the previous item and blown up at a generic collection of @xmath0 real points and @xmath6 pairs of conjugate imaginary points ) : @xmath1374 * the case @xmath1369 , the real structure on @xmath4 is given by @xmath1375 , and @xmath10 is a curve of bi - degree @xmath649 : @xmath1376 * the case @xmath1377 ( we denote by @xmath1378 the real surface considered in the previous item and blown up at a generic collection of @xmath0 real points and @xmath6 pairs of conjugate imaginary points ) : @xmath1379 * the case @xmath1380 : @xmath1381",
    "as is usual , we call a divisor @xmath10 on a surface @xmath4 _ nef _ if @xmath10 non - negatively intersects any algebraic curve on @xmath4 . when @xmath4 is an unnodal del pezzo surface , @xmath10 is nef if and only if its intersection with any @xmath325-curve is non - negative .",
    "a nef divisor @xmath10 is called _ big _ if @xmath1382 .    [ tn5 ] let @xmath1383 or @xmath5 , @xmath1384 , @xmath1385 .",
    "then , for any real nef and big divisor @xmath10 on @xmath4 , the invariant @xmath3 is positive , and the following asymptotic relation holds : @xmath1386 in particular , @xmath1387    [ rn2 ] ( 1 ) the positivity and asymptotic behavior as in theorem [ tn5 ] were established before for all real toric unnodal del pezzo surfaces with a nonempty real part , except for @xmath1388 ( see @xcite ) .",
    "\\(2 ) if @xmath10 is not nef or not big , then @xmath1389 or @xmath43 depending on whether the linear system @xmath300 contains an irreducible curve or not ( for the existence of rational irreducible representatives see , for instance , @xcite ) .",
    "\\(3 ) the gromov - witten and welschinger invariants do not depend on variation of tamed almost complex structures ; hence theorem [ tn5 ] is valid for blow - ups at arbitrary ( not necessarily generic ) configurations of points and for any homology class @xmath1390 with @xmath1382 which non - negatively intersects each class @xmath1391 such that @xmath1392 .    *",
    "proof of theorem  [ tn5]*. since the coefficients in the recursive formula ( [ en60 ] ) are positive , and its initial values are nonnegative ( see theorem [ tn12](3 ) ) , to prove the positivity it is enough to find at least one tropical curve which matches a given configuration of fixed points and has a positive welschinger multiplicity . due to the upper bound @xmath1393 and the asymptotics ( see  @xcite ) , to prove the asymptotic relation  ( [ en12 ] ) it is enough to find tropical curves with sufficiently large total welschinger multiplicity .",
    "[ cremona ] if @xmath1327 and @xmath10 is a nef and big divisor on @xmath4 , then there exists a collection @xmath1394 of disjoint real smooth rational curves on @xmath4 such that @xmath1395 , @xmath1396 , and @xmath1397 if @xmath1278 and @xmath10 is a real nef and big divisor on @xmath4 , then there exist a collection @xmath1398 of real smooth rational curves and a pair @xmath1399 of conjugate imaginary smooth rational curves on @xmath4 which all are pairwise disjoint and such that @xmath1400 , @xmath326 , and @xmath1401    ( cf .",
    "@xcite or ( * ? ? ?",
    "* section 5 ) ) the last inequalities in ( [ en13 ] ) and ( [ en14 ] ) can be achieved by means of finitely many basis changes ( standard quadratic cremona transformations ) @xmath1402 where @xmath1403 either are real , or two of them are conjugate imaginary .",
    "such a transformation diminishes @xmath1404 as soon as @xmath1405 .",
    "let @xmath25 be the real smooth rational @xmath325-curve linearly equivalent to @xmath303 .",
    "define a multi - set @xmath200 of vectors in @xmath201 by relation @xmath1407 pick a sequence of finite multi - sets @xmath1408 dominating @xmath1409 , @xmath1410 . put @xmath1411 and , for any @xmath1410 , pick a configuration @xmath1412 of @xmath1413 points in the strip @xmath1414 such that @xmath1415 is a @xmath1408-generic @xmath1416-configuration of type @xmath1417 and vertical parameter @xmath755 .",
    "denote by @xmath1418 horizontal parameters of @xmath1415 .    *",
    "( 1 ) * assume that @xmath1419 .",
    "consider the divisor @xmath1420 on the real toric surface @xmath1421 .",
    "the divisor @xmath1187 is nef in view of ( [ en13 ] ) , ( [ en14 ] ) and the relations @xmath1422 @xmath1423 @xmath1424 ( as is well - known , the divisors @xmath1425 , @xmath1426 , @xmath1427 , generate the effective cone of @xmath1182 ) . the linear system @xmath1428 is naturally associated with the convex lattice polygon @xmath1429 depicted in figure [ fn1](a ) .",
    "though some sides may collapse , the polygon is always nondegenerate , which means , in particular , that @xmath10 is big .",
    "notice also that .",
    "denote by @xmath1430 the multi - set of the primitive integral exterior normal vectors to @xmath1431 , where the multiplicity of each normal equals the lattice length of the corresponding side . the subset @xmath1432 formed by the isomorphism classes  @xmath1221 such that @xmath1433 is non - empty ( see , for instance , @xcite ) .",
    "furthermore , by ( * ? ? ?",
    "* theorem 3 ) , @xmath1434 any tropical curve @xmath159 representing a class @xmath1435 has @xmath1436 ends directed by vector @xmath881 .",
    "lemma  [ splitting ] implies that each of these ends crosses the segment @xmath1437 . among these ends ,",
    "select @xmath1438 ends and consider a marked tropical @xmath101-curve @xmath198 such that @xmath1439 \\in { \\cal t}^c(n{{\\delta } } , nk_1 , nk_2 , 0 , 0 , n(d - k_3 - k_4)\\theta_1 , ( { { \\boldsymbol p}}_n , p)),\\ ] ] @xmath1440 , and a marked cut of this curve at @xmath1441 satisfies the following properties :    * the only left component of the cut is isomorphic to @xmath159 , * the number of right components is @xmath1442 , * exactly @xmath1443 right components are isomorphic to those shown on figure  [ fn1](b ) and match @xmath1443 selected ends of @xmath159 , * exactly @xmath1444 right components are isomorphic to those shown on figure  [ fn1](c ) and match @xmath1444 selected ends of @xmath159 , * the remaining right components are horizontal .    if @xmath1278 , we define an involution @xmath1445 on @xmath1141 and thus obtain a class in @xmath216 @xmath1446 .",
    "finally , notice that @xmath1447 , which completes the proof in the case under consideration .",
    "( 1,3)(1,0)3(1,3)(0,1)2 ( 1,5)(1,0)2(3,5)(1,-1)1(4,3)(0,1)1 ( 2,9)(-1,1)1(1,10)(0,1)2(2,9)(1,0)2(1 , 12)(1,0)2 ( 3,12)(1,-1)1(4,9)(0,1)2(2,16)(-1,1)1 ( 1,17)(0,1)2(1,19)(1,0)2(2,16)(1,0)2 ( 3,19)(1,-1)1(4,16)(0,1)2(6.5,1.5)(0,1)3.5 ( 7.5,8)(0,1)4(9,4)(1,0)1(10,4)(1,-1)1 ( 10,4)(0,1)1(11,3)(1,0)1(11,1.5)(0,1)1.5 ( 12,1.5)(0,1)1.5(12,3)(1,1)1(9.5,9.5)(1,1 ) 0.5 ( 10,10)(0,1)2(10,10)(1,0)1(11,8)(0,1)2 ( 11,10)(1,1)1(6.5,16)(1,0)1(7.5,15)(0,1)1 ( 7.5,16)(1,1)1(10.5,15)(0,1)1(10.5,16)(-1,1 ) 0.5 ( 10,16.5)(0,1)0.5(10,16.5)(-1,0)0.5(6.5,19 ) ( 1,0)2 ( 9.5,19)(1,0)2(10.5,16)(1,0)1                * ( 2 )",
    "* assume that @xmath1460 , which is relevant only to the case @xmath1278 , @xmath256 .",
    "consider the divisor @xmath1461 on the real toric surface @xmath1421 .",
    "it is nef in view of our assumption , inequalities ( [ en14 ] ) and the relations @xmath1462 @xmath1463 @xmath1464 thus , the linear system @xmath1428 is naturally associated with a nondegenerate convex lattice polygon @xmath1429 ( see figure [ fn1](d ) ) , which implies that @xmath1187 is big .    as in the preceding step ,",
    "we notice that @xmath1465 and denote by @xmath1430 the multi - set of the primitive integral exterior normal vectors to @xmath1431 , where the multiplicity of each normal equals the lattice length of the corresponding side .",
    "the subset @xmath1432 formed by the isomorphism classes  @xmath1221 such that @xmath1433 is non - empty and @xmath1466 ( see  @xcite and  ( * ? ? ?",
    "* theorem 3 ) ) .",
    "any tropical curve @xmath1467 representing a class @xmath1468 has @xmath1469 ends directed by vector @xmath881 .",
    "lemma  [ splitting ] implies that each of these ends crosses the segment @xmath1470 .",
    "denote by @xmath1471 the multi - set obtained from @xmath1472 by removing @xmath1473 vectors @xmath650 and @xmath1473 vectors @xmath649 .",
    "consider a marked tropical @xmath101-curve @xmath198 such that @xmath1439 \\in { \\cal t}^c(n{{\\delta } } '' , nk_5 , nk_5 , 0 , 0 , n(d - k_3 - k_4)\\theta_1 , ( { { \\boldsymbol p}}_n , p))],\\ ] ] and a marked cut of this curve at @xmath1474 satisfies the following properties :      the tropical curve @xmath198 has @xmath1475 ends directed by the vector @xmath648 .",
    "lemma  [ splitting ] implies that @xmath1476 of these ends cross the half - line @xmath1477 , where @xmath1478 is a sufficiently small positive number .",
    "consider a marked tropical @xmath101-curve @xmath1479 such that @xmath1480 \\in { \\cal t}^c(n{{\\delta } } , nk_1 , nk_2 , 0 , 0 , n(d - k_3 - k_4)\\theta_1 , ( { { \\boldsymbol p}}_n , p))],\\ ] ] and a marked cut of this curve at @xmath1481 has @xmath1482 irreducible components :    * one component isomorphic to @xmath198 , * @xmath1483 components isomorphic to those shown on figure  [ fn1](e ) , * @xmath1484 components whose images are vertical lines , * @xmath1485 components whose images are straight lines of slope  @xmath65 .      *",
    "( 3 ) * assume that @xmath1489 which again is relevant only in the case @xmath1278 , @xmath256 .",
    "impose an additional condition on each configuration @xmath1412 , @xmath1490 , namely suppose that it can be subdivided into two parts @xmath1491 such that      consider the divisor @xmath1501 on the real toric surface @xmath1502 .",
    "this divisor is nef due to @xmath1503 @xmath1504 and is big , since it is associated with a nondegenerate convex lattice polygon @xmath1429 shown in figure [ fn1](f ) .",
    "notice that @xmath1505",
    ".    as before , denote by @xmath1430 the multi - set of the primitive integral exterior normal vectors to @xmath1431 , where the multiplicity of each normal equals the lattice length of the corresponding side .",
    "the subset @xmath1506 formed by the isomorphism classes  @xmath1221 such that @xmath1433 is non - empty and @xmath1507 ( see  @xcite and  ( * ? ? ? * theorem 3 ) ) .",
    "denote by @xmath1471 the multi - set obtained from @xmath1472 by removing @xmath1508 vectors @xmath648 , then @xmath1509 vectors ( -1 , 0 ) , and finally @xmath1509 vectors @xmath649 .",
    "any tropical curve @xmath159 representing a class @xmath1510 has @xmath1469 ends directed by the vector @xmath651 and @xmath1511 ends directed by the vector @xmath648 . applying a procedure similar to the one described in the previous step , we obtain a marked tropical @xmath101-curve @xmath1512 such that @xmath1513 \\in { \\cal t}^c(n{{\\delta } } '' , n(k_4 + k_5 ) , n(k_4 + k_5 ) , 0 , 0 , n(d - k_1 - k_3 + k_5)\\theta_1 , ( { { \\boldsymbol p}}'_n , p))$ ] and @xmath1514 .",
    "the curve @xmath1479 has @xmath1515 ends directed by the vector @xmath648 ; choose among them @xmath1497 ends not adjacent to  @xmath1516 .",
    "there are @xmath1517 possibilities to fix a one - to - one correspondence between the chosen ends and the points of @xmath1496 .",
    "thus , there exist @xmath1517 marked tropical @xmath101-curves @xmath1518 such that    * @xmath1519 \\in { \\cal t}^c(n{{\\delta } } , nk_1 , nk_2 , 0 , 0 , n(d - k_3 - k_4)\\theta_1 , ( { { \\boldsymbol p}}_n , p))$ ] , * @xmath1520 , * @xmath1518 has a marked cut whose irreducible components are as follows : one of them is isomorphic to @xmath1479 , the other @xmath1509 components are as shown on figure  [ fn1](g ) .    equipping each of these curves with the identity involution , we obtain representatives of @xmath1517 classes in @xmath1521 , and the welschinger multiplicity of all these classes is equal to @xmath1326 .",
    "this immediately implies the positivity of @xmath3 as well as the required asymptotics , since from ( [ en15 ] ) and our construction we obtain @xmath1522 @xmath1523 @xmath582              [ ln2 ] let @xmath1531 be nef and big divisors on @xmath1532 .",
    "if @xmath1533 is effective , then @xmath1533 can be decomposed into a sum @xmath1534 of smooth rational @xmath325-curves such that each of @xmath1535 is nef and big , and satisfies @xmath1536 , @xmath1537 .    as any effective divisor on @xmath1532 ,",
    "the divisor @xmath1538 has a splitting @xmath1539 into the sum of smooth rational @xmath325-curves .",
    "it remains to show that an appropriate reordering of @xmath1540 ensures the properties asserted in the lemma .",
    "suppose that @xmath569 is nef and big for some @xmath1537 .",
    "show , first , that there is @xmath1543 $ ] with @xmath1544 .",
    "indeed , if @xmath1545 then @xmath1546 is nef , and hence @xmath1547 if @xmath1548 , and @xmath1549 are all orthogonal to @xmath569 , then they can not be all pairwise orthogonal , since otherwise one would have @xmath1550 , @xmath1551 .",
    "thus , there exist @xmath1552 with @xmath1553 and @xmath1554 .",
    "therefore , our assumption @xmath1555 leads by hodge index theorem to @xmath1556 contrary to the bigness of @xmath569 .",
    "hence there is @xmath1557 with @xmath1544 .",
    "[ rn3 ] theorem [ tn7 ] implies the similar inequalities for divisors on @xmath1524 , @xmath1526 , @xmath1564 , and @xmath1525 .",
    "in particular , it strengthens the monotonicity result for the surfaces @xmath263 , @xmath1526 , @xmath1530 , and @xmath1525 from ( * ? ? ?",
    "* corollary 4 ) .          indeed ,",
    "then @xmath1569 let us blow down the divisor @xmath82 .",
    "choosing a generic configuration @xmath1202 of @xmath1570 real points in @xmath4 , we obtain a bijection between @xmath1571 and @xmath1572 , where @xmath1573 is a generic configuration of @xmath1574 real points in @xmath1575 .",
    "hence @xmath1576 .",
    "\\(2 ) assume that @xmath1577 .",
    "performing a suitable real automorphism of @xmath1578 , we can make @xmath1579 and apply formula ( [ en60 ] ) to @xmath1580 in the left - hand side .",
    "then , among the summands of the right - hand side , one has @xmath1581 thus , we are done , since all other summands in the formula are non - negative .",
    "@xmath582    _ acknowledgments . _ a considerable part of the work on this text was done during our stays at _ centre interfacultaire bernoulli _ , _ cole polytechnique fdrale de lausanne _ in 2008 , at _ mathematisches forschungsinstitut oberwolfach _ in 2009 , and at the mathematical sciences research institute , berkeley in 2009 , as well as during the visits of the first author to tel aviv university and the visits of the third author to _ universit de strasbourg_. we thank these institutions for the support and excellent working conditions .",
    "we are grateful to the referee for the careful reading of the first version of the paper and many useful comments .",
    "the first two authors were partially funded by the anr-05 - 0053 - 01 and anr-09-blan-0039 - 01 grants of _ agence nationale de la recherche _ , and are members of frg collaborative research `` mirror symmetry & tropical geometry '' ( award no .",
    "@xmath1582 ) .",
    "the third author was supported by the israeli science foundation grant no .",
    "448/09 and by the hermann - minkowski - minerva center for geometry at tel aviv university .",
    "mikhalkin ,  g. : tropical geometry and its applications . in : sanz - sol ,",
    "marta ( ed . ) et al .",
    ", proceedings of the icm , madrid , spain , august 22 - 30 , 2006 .",
    "volume ii : invited lectures .",
    "zrich , european math . soc . , 827852 ( 2006 )"
  ],
  "abstract_text": [
    "<S> we give a recursive formula for purely real welschinger invariants of the following real del pezzo surfaces : the projective plane blown up at  @xmath0 real and @xmath1 pairs of conjugate imaginary points , where @xmath2 , and the real quadric blown up at @xmath1 pairs of conjugate imaginary points and having non - empty real part . </S>",
    "<S> the formula is similar to vakil s recursive formula @xcite for gromov - witten invariants of these surfaces and generalizes our recursive formula  @xcite for purely real welschinger invariants of real toric del pezzo surfaces . as a consequence </S>",
    "<S> , we prove the positivity of the welschinger invariants under consideration and their logarithmic asymptotic equivalence to genus zero gromov - witten invariants .    3.25 in     _ wall painting _    </S>",
    "<S> -5pt     _ tomb of khnumhotep iii _    </S>",
    "<S> -5pt     _ beni hasan , egypt , middle kingdom _ </S>"
  ]
}