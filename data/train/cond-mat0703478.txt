{
  "article_text": [
    "the distinguishing feature of statistical mechanics as a theory of many - body physics is that it has probabilistic notions at its core . at equilibrium ,",
    "the principle of equal _ a priori _ probabilities is invoked as a means to identify the typical behaviour of a system as a whole . out of equilibrium , the evolution of a system is usually couched in terms of stochastic dynamics , as a glance at many articles in this journal will confirm .",
    "the procedure of stochastic modelling is not , of course , restricted to physics . in particular , stochastic models have played a pivotal role in understanding the dynamics of evolutionary systems and as such one sees many similarities in the approaches and methods that have been used to those employed by statistical physicists . the most well - established discipline for which this is the case is population genetics , i.e. , the study of gene frequencies among a population of reproducing individuals .",
    "more recently , models very similar to those that arise in the population genetics arena have also been applied in ecology ( where the frequencies of particular species in an ecosystem are of interest ) and language change ( where now the focus is on frequencies of linguistic variants used by a community of speakers ) . in this article",
    ", it is our aim to introduce key concepts and results from these fields to practitioners in statistical mechanics in order to further cross - fertilisation between them .",
    "mostly , we will concentrate on the application to population genetics : due to this discipline s age , most of the mathematical literature describing the stochastic models of interest are couched in terms of the language of population genetics .",
    "we shall therefore begin by introducing the relevant terminology . in the simplified mathematical models we shall be describing , a _ gene _",
    "is taken to mean a variable unit that codes for a specific trait ( such as eye colour ) , and different variants of the gene ( coding in this example for different eye colours ) are called _",
    "alleles_. changes in allele frequency can occur as a consequence of three processes .",
    "first , there is reproduction , in which offspring organisms acquire copies of alleles from their parents .",
    "secondly , in the copying process , random mutations can occur which may change one allele to another , or create a completely new allele .",
    "finally , for whatever reason , organisms carrying one allele may end up having more offspring than another : this is selection .",
    "the simplest stochastic model of an evolving population dates from the 1930 s and was introduced independently by ronald fisher @xcite and sewall wright @xcite . in this model , the number of organisms is taken to be constant from one generation to the next , and each instance of a gene in one generation is an exact copy of one randomly chosen with replacement from the previous generation .",
    "such a process could be realised in a number of ways .",
    "let us consider first of all _ haploid _ organisms which carry only one instance of each gene and ( possibly ) reproduce asexually . a new generation could then be formed by each of the organisms producing an infinite number of _ gametes _ ( e.g. , seeds ) before dying ; then , a random fixed - size sample of these gametes survive to become offspring organisms . more often , geneticists focus on _ diploid _ organisms which carry two copies of each gene and reproduce sexually . now , each organism produces two infinite sets of gametes , one for each allele carried by the parent .",
    "then , after dying , the next generation is formed by combining the requisite number of randomly - chosen gamete pairs .",
    "either way , the mean number of offspring that any individual has in the following generation is one , and so there is no selection : this is a _",
    "neutral _ model .",
    "furthermore the fact that the allele instances present in one generation are a random sample of those present in the previous generation means that allele frequencies fluctuate through sampling effects alone .",
    "these fluctuations are called _ genetic drift _ and  in the absence of any mutations  over time cause permanent extinction of one or more alleles : the steady state of such a model is one in which only a single allele remains : this allele is then said to have _ fixed _ in the population .",
    "a haploid , or randomly - mating diploid population evolving in this way is often referred to as an _ ideal _ population . in reality , individuals do not mate at random , and there is often a preference , or requirement , for mating to occur between or within different _ classes _ of individuals .",
    "most obviously , in sexually reproducing organisms , females can mate only with males ; other factors , such as individuals geographical locations and age ( when one has overlapping generations ) may also lead to deviations from non - ideal behaviour .",
    "nevertheless , in some cases it is found that the predictions of the ideal model are relevant if one replaces the actual size of the population with an effective size , which can be thought of as a number of breeding individuals .",
    "we will discuss this procedure in more detail later in this article .",
    "neutral theories in population genetics ( as well as in the ecological and linguistic applications  see below ) seem to have a far greater realm of validity that might naively be expected . the idea that many genetic mutations are effectively neutral , that is do not significantly affect the fitness of the carrier , was pioneered by motoo kimura  @xcite .",
    "thus changes in their frequency are due to chance , rather than selection .",
    "this is not to deny that natural selection has an important role in the development of morphological and behavioural characteristics , only that random genetic drift has a more significant effect that had hitherto been envisaged .",
    "the relationship of the neutral theory to selection was explored further with the introduction of the concept of `` near - neutrality''@xcite , in which the extent to which genes are affected by drift and selection is a function of the effective size of a breeding population .    in ecology",
    "the concept of neutrality is more recent , and is frequently associated with stephen hubbell , who has developed and popularised the concept during the last decade  @xcite .",
    "the idea of neutrality in ecology can be explained by imagining a set of similar species in a local community , trees in a forest , for example . when a particular tree dies , it is replaced by an `` offspring '' of one of the other trees in the forest  picked at random .",
    "this is similar to the wright - fisher model , except that now individuals ( trees ) are the fundamental entities , not genes , and they come in different species , rather than as different alleles . as in the genetic case ,",
    "successive random events will eventually lead to the extinction of one species by chance , and then another , until eventually only one will remain . that this does not happen",
    "is postulated to be due to new individuals occasionally being introduced from outside the local community by immigration .",
    "the distribution of species abundances calculated from neutral theory gives a remarkably good fit to data  @xcite , however the extreme simplicity of the model has made it very controversial .",
    "some ecologists see it as a good `` zeroth - order approximation '' on which to build a more complete description  @xcite , while others believe some other kind of starting point is required  @xcite .",
    "the analogies to a model of language change  @xcite are a little more abstract . here",
    ", there is a retained memory of usages of a particular variant of a linguistic variable ( such as a vowel sound or grammatical structure ) ; when a variant is reproduced , its retention in a speaker s memory displaces a record of an earlier utterance .",
    "thus a speaker s perception of the frequency with which a particular variant is used  which in the quantitative version of the model which has been developed  @xcite , is taken as the frequency with which that same speaker produces that variant  also exhibits genetic - drift - like fluctuations over time .",
    "the imitation of linguistic variables according to usage frequencies experienced by individual speakers falls within a paradigm referred to as the _ usage - based model _ in linguistics @xcite ( this to it distinguish from theories in which aspects of the grammar come `` pre - programmed '' ) .",
    "investigations of the model of language change introduced in @xcite have only just begun , but it is already clear that the structure of the network of speakers , shaped by both geography and social interactions , is important in determining the time needed for a particular variant to become fixed . in some cases , such as in new dialect formation @xcite , fixation of linguistic variants",
    "has been seen to occur on the timescale of a human generation : it is apparently possible that this may occur entirely through random effects , without the need to invoke any selection mechanism  @xcite .    in the next section of this article",
    ", we present a precise definition of the model of neutral genetic drift in an ideal population , along with the non - ideal generalisation of a subdivided populations .",
    "we also demonstrate concretely the relationship to the ecological and linguistic models just described .",
    "then , in sections  [ master ] and [ coalescent ] we describe two complementary analytical approaches .",
    "the first starts with a master equation and leads to a diffusion approximation for allele frequencies ; this type of approximation was popular in the 1950s , largely through kimura s efforts .",
    "although implicitly used previously , the 1980s saw the formalisation of an approach called the coalescent , in which the statistical properties of the ancestry of a present - day population yield additional insights into the population dynamics .",
    "finally , in sections  [ nonideal ] and [ selection ] we review some of the special features of non - ideal and non - neutral evolution respectively , before making general remarks in the conclusion , section  [ conclusion ] .",
    "the simplest , and most widely known  @xcite , model of random genetic drift is the wright - fisher model  @xcite .",
    "suppose we have a population of individuals in generation @xmath0 who mate randomly to produce the new generation @xmath1 .",
    "we focus on one particular gene which may be in one of two states ( alleles ) which we call @xmath2 and @xmath3 .",
    "the wright - fisher model is based on the idea of the gene pool of the @xmath0 generation individuals being sampled to give the genetic structure of the @xmath1 generation . in reality , as discussed in section [ intro ] individuals are diploid , but for convenience we assume that individuals are haploid , that is , there is one - to - one correspondence between individuals and genes .",
    "the process of constructing the new generation from the current one is analogous to sampling coloured balls  representing different alleles ( types of gene)from a bag or urn .",
    "the steps in the process are illustrated in fig .",
    "[ fig - beanbag ] .",
    "wright - fisher ` beanbag ' population genetics .",
    "the population in generation @xmath1 is constructed from generation @xmath0 by ( i ) selecting a gene from the current generation at random ; ( ii ) copying this gene ; ( iii ) placing the copy in the next generation ; ( iv ) returning the original to the parent population .",
    "these steps are repeated until generation @xmath1 has the same sized population as generation @xmath0 . ]",
    "suppose that in generation @xmath0 there are @xmath4 @xmath2 alleles and @xmath5 @xmath3 alleles .",
    "we wish to sample this gene pool @xmath6 times ( with replacement ) in order to create the new generation @xmath1 .",
    "the probability that in @xmath6 trials of sampling the pool will get @xmath7 @xmath2 alleles is simply given by the binomial distribution : @xmath8 where @xmath9 is the probability of picking an @xmath2 ( @xmath10 ) and @xmath11 is the probability of picking a @xmath3 ( @xmath12 ) .",
    "so the probability that there is a transition from the original state ( characterised by @xmath4 @xmath2 alleles ) to the new state ( characterised by @xmath7 @xmath2 alleles ) is given by @xmath13 it should be noted that many mathematicians will write @xmath14 when they are referring to the transition probability from the state @xmath4 to the state @xmath7 , whereas we follow the usual convention in physics and denote this by @xmath15 .",
    "this makes much of the matrix algebra more natural  involving post - multiplication of vectors , rather than pre - multiplication .",
    "what we wish to calculate is the probability of finding @xmath7 @xmath2 alleles in generation @xmath0 , given that there were @xmath16 initially .",
    "we denote this probability by @xmath17 , which we will frequently abbreviate to @xmath18 , taking the initial condition as given .",
    "since the construction of the gene pool at generation @xmath1 only depends on the state of the gene pool in generation @xmath0 , and not on its state in earlier generations , the process is markov .",
    "theoretical biologists , like mathematicians , prefer to model such processes in terms of markov chains .",
    "thus they define firstly , a probability vector @xmath19 and secondly a transition matrix @xmath20 the evolution of the system is then given by the matrix equation @xmath21 note that the sum of the components of the probability vector must add up to 1 , and the sum of the entries in any one column of the transition matrix must add up to 1 ( since @xmath22 and @xmath23 ) .",
    "matrices whose column entries add up to 1 are known as _ stochastic matrices _ , although the convention of writing the initial state as the index on the left means that in the literature the statement is usually that the row entries add up to unity .",
    "it is now straightforward to formally express the state of the system in generation @xmath0 in terms of this initial state : @xmath24 clearly the large @xmath0 behaviour will be dominated by the largest ( in magnitude ) eigenvalues of @xmath25 and their corresponding eigenvectors .",
    "the eigenvalues of the wright - fisher model are known  @xcite , and are given by @xmath26    some simple deductions may be made from the wright - fisher model formulated as a markov chain .",
    "for instance , we may ask what the system looks like after a large number of generations . if it tends to a stationary state , and if we call this stationary probability vector @xmath27 , it follows that @xmath28 .",
    "that is , @xmath27 is a right eigenvector of @xmath25 with eigenvalue 1 .",
    "intuitively it seems clear that the final state is either all @xmath2 ( the @xmath2 allele has become _ fixed _ ) or all @xmath3 ( the @xmath3 allele is fixed ) .",
    "this would correspond to a stationary state given by @xmath29 here @xmath30 is the probability that allele @xmath2 will eventually become fixed . if we calculate @xmath31 using the above expression , we find that it is indeed equal to @xmath27 , confirming that @xmath27 is of this form .",
    "another simple deduction is that the expected number of @xmath2 alleles does not change from one generation to the next : @xmath32 since @xmath33 .",
    "in particular , @xmath34 .",
    "we can use this result to determine @xmath30 in eq .",
    "( [ wf_stationary ] ) . to do this",
    "we note from eq .",
    "( [ wf_stationary ] ) that as @xmath35 only two states are possible : @xmath36 ( with probability @xmath30 ) and @xmath37 ( with probability @xmath38 ) .",
    "therefore @xmath39 this gives the explicit form for @xmath27 and also tells us that the probability that eventual fixation of @xmath2 will occur is @xmath40 .",
    "statistical physicists are not used to formulating stochastic processes in the way described above for the wright - fisher model ; they usually use continuous time master equations and define transitions for a single stochastic step rather than for @xmath6 bundled together  @xcite .",
    "a variant of the wright - fisher model , which is closer in spirit to stochastic processes considered by statistical physicists , was introduced by moran  @xcite .",
    "this model does not have a fixed `` previous generation '' from which @xmath6 genes are sampled ( with replacement ) to form the next generation .",
    "instead , genes are chosen to die one at a time , and replaced by new ones which are @xmath2 with probability @xmath41 and @xmath3 with probability @xmath42 .",
    "these probabilities are calculated from the state of the system prior to the death of the chosen individual : @xmath43 and @xmath44 , where @xmath7 is the number of @xmath2 alleles just before the combined birth - death event .",
    "the moran model does not have non - overlapping generations , as in the wright - fisher model : after @xmath6 sampling events in the moran model , each gene need not have been replaced , and several might not have survived very long at all .",
    "it is therefore said to have overlapping generations .",
    "due to the impossibility of unambiguously identifying a `` generation '' in this case , a generation in the moran model is frequently defined as the period over which a single sampling event takes place .",
    "this is a confusing use of the word `` generation '' , but at least it is well defined .",
    "so , in one generation the population of @xmath2 may go up by one ( if a @xmath3 is chosen to die , and an @xmath2 is chosen to be born ) or down by one ( if an @xmath2 is chosen to die , and a @xmath3 is chosen to be born ) .",
    "the number of @xmath2 alleles will remain unchanged if both an @xmath2 is chosen to die and to be born , and also if a @xmath3 is chosen to die and to be born .",
    "this gives the transition matrix to be @xmath45 from which it follows that @xmath46 .",
    "the explicit expressions for the non - zero elements of the transition matrix of the moran model are therefore @xmath47    the transition matrix ( [ m_p ] ) for the moran model is much simpler than for the wright - fisher model , being tri - diagonal .",
    "therefore it is not surprising that the eigenvalues of the transition matrix ( [ m_p ] ) can , as for the wright - fisher model , found exactly  @xcite : @xmath48 but , unlike the wright - fisher model , the corresponding eigenvectors are also known  @xcite .",
    "the two largest eigenvalues are both unity ; they have left eigenvectors @xmath49 and @xmath50 and corresponding right eigenvectors @xmath51 and @xmath52 .",
    "clearly the last two column vectors correspond to the loss and fixation of the @xmath2 allele .",
    "the third largest eigenvalue , @xmath53 has the left eigenvector @xmath54 and right eigenvector @xmath55  @xcite .",
    "this column vector governs the behaviour , after a large number of generations , of the non - fixed states .",
    "in particular , we have , once @xmath0 is sufficiently large , @xmath56 where @xmath16 is the initial number of @xmath2 alleles .",
    "we see that the unfixed states are equally populated except at the boundaries , in agreement with graphical representations of the pdf displayed in , e.g. ,  @xcite , which show it to be essentially flat away from the boundaries after many generations .",
    "so far we have been considering situations where the change in composition of the population is caused by pure genetic drift ",
    "randomness with no underlying deterministic behaviour .",
    "we now include the effects of mutation : an @xmath2 allele may mutate with a probability of @xmath57 to a @xmath3 allele , and a @xmath3 allele may mutate with a probability of @xmath58 to an @xmath2 allele .",
    "these are probabilities per generation , so once again these quantities in the wright - fisher model will differ from those in the moran model by a factor of @xmath6 .    to include mutation , one chooses an allele from the current population to die , and replaces it with one of a type chosen also with a probability proportional to the current population sizes .",
    "this is as in the original models .",
    "the mutational stage is inserted at the end of the process , so the chosen successor is allowed to mutate before being introduced into the system to define the new population .",
    "in other words , when we pick an allele to be the `` parent '' of a `` child '' in the next generation , the offspring can mutate with the probabilities @xmath57 or @xmath58 .",
    "for instance , if an @xmath2 allele is chosen , there is a probability of @xmath59 that the replacement allele is also an @xmath2 and of @xmath57 that it is a @xmath3 .",
    "so , with mutation added , @xmath60 and @xmath61 the transition matrices for the wright - fisher and moran models are again found from eqs .",
    "( [ wf_binomial ] ) and ( [ m_p ] ) , but using @xmath41 and @xmath42 given by eqs .",
    "( [ mut_p1 ] ) and ( [ mut_p2 ] ) .",
    "so for instance , the non - zero elements of the transition matrix for the moran model are @xmath62    allowing for the possibility of mutation means that the expected number of @xmath2 alleles is no longer conserved .",
    "for the wright - fisher model this can be calculated as in eq .",
    "( [ wf_mean ] ) , but now @xmath63 and so @xmath64 for the moran model we calculate @xmath65 directly from eq .",
    "( [ m_p_nonzero_mut ] ) and find that @xmath66 which is of the same form as eq .",
    "( [ wf_mut_deter ] ) , apart from the factors of @xmath6 dividing the mutation probabilities .",
    "( [ wf_mut_deter ] ) and ( [ m_mut_deter ] ) give the number of @xmath2 alleles in an infinite population , where no fluctuations are present .",
    "written in terms of allele frequencies , @xmath67 and @xmath68 , eq .",
    "( [ wf_mut_deter ] ) is nothing else but the deterministic equation for mutational change , @xmath69 , found in many textbooks on population genetics  @xcite .",
    "this difference equation for @xmath70 may be easily solved by writing @xmath71 , so that @xmath72 . the equation for @xmath73",
    "can be solved iteratively to give @xmath74 , which yields @xmath75 \\nonumber \\\\ & = & \\frac{v}{u+v } \\left [ 1 - \\left ( 1 - u - v \\right)^{t } \\right ] +   a_{0}\\left ( 1-u - v \\right)^{t}\\ , .",
    "\\label{soln_a_t}\\end{aligned}\\ ] ] since @xmath76 , @xmath77 as @xmath35 .",
    "the addition of mutations also means that neither the @xmath2 nor the @xmath3 allele can become fixed  there is always the possibility of an allele being created by mutation , even if there are currently none present in the population .",
    "thus the behaviour of both the wright - fisher and moran models with mutation , after a large number of generations , is more complicated to obtain .",
    "nevertheless , the eigenvalues of the transition matrices are known . for the wright - fisher model  @xcite : @xmath78 and for the moran model  @xcite @xmath79 the moran model with mutation can be solved analytically  @xcite .",
    "in addition , approximate methods exist , such as the diffusion approximation discussed in section [ master ] , which describe these models well .",
    "finally , all of the models can be generalised to the cases with two sexes and diploid individuals  @xcite .",
    "these models are more complicated , but do not in our view make the underlying ideas or the connection between different approaches any clearer . for all these developments we refer the reader to the literature on the subject  @xcite ; meanwhile , in section  [ nonideal ] we shall examine how sexual reproduction and diploidy are handled in models that are more easily studied analytically .      in the models of genetic drift considered so far ,",
    "new individuals were produced from their `` parents '' randomly .",
    "if the organisms had been diploid , we would have said that the mating was random .",
    "this randomness assumption may model some situations , for example , if sperm is released into a pond or lake by a group of male fish in order to fertilise eggs laid by females nearby . however , there are many instances where mating is not random .",
    "one of the most interesting is when groups of individuals are geographically separated .",
    "then , if there is little migration between the populations , so that they are effectively isolated , stochastic effects mean that they will develop in different ways .",
    "for instance , some alleles may be lost in some of the populations , but not in others .",
    "models which describe the population genetics of subdivided populations which are partly isolated from each other are called `` island models '' and were first investigated by wright  @xcite .",
    "the island populations themselves are referred to as _ demes_. in early models , migration between demes was essentially independent of the distance between the islands which contained them , that is , each deme interchanged genes equally with every other deme .",
    "more elaborate models soon followed , such as stepping stone models , where the rate of migration between demes is a function of the distance between the islands  @xcite .",
    "these models can be generalised by defining a migration matrix , @xmath80 , which specifies the probability that , if an individual in deme @xmath81 has had an offspring , the later immediately migrates to deme @xmath82 ( so that it has arrived at the start of the next generation ) .",
    "the inclusion of migration into the models so far considered in this section is in principle straightforward , but in some cases the matrix of transition probabilities becomes cumbersome to write down .",
    "there are also potentially several different models which can be constructed depending on the order in which the various processes of birth , mutation and migration take place , how many migrants are permitted into and out of each deme , and so on .",
    "the introduction of migration into moran - type models is , as expected , easier to formulate and seems more natural to statistical physicists . in the usual spirit of this approach",
    ", migrations will be considered as single events , for instance , a migration of a gene from deme @xmath81 to deme @xmath82 .",
    "this is in contrast to many other approaches to stochastic models of migration , including one introduced by moran  @xcite , where a fixed number of individuals are chosen to migrate from one deme to another",
    ". we shall consider the class of models for which migration can be characterised through the matrix @xmath80 defined above : this class includes the simple cases considered by early workers , such as uniform migration rate between all demes or stepping stone models .",
    "the number of demes will be taken to be @xmath83 and we will assume that they will each consist of @xmath6 genes . for simplicity we will assume that the mutation rates will be the same on each island . in other words , each island will be an exact copy of the systems considered previously in this section , but coupled together by migration processes .    to illustrate the basic idea ,",
    "suppose that there are only two islands , not @xmath83 as assumed above .",
    "since each island contains exactly @xmath6 genes , only two integers are required to specify the state of the system : @xmath84 and @xmath85 , where @xmath86 is the number of @xmath2 alleles in deme @xmath82 , where @xmath87 .",
    "we begin with the basic moran model of section [ moran ] where only the birth / death process is considered . when migration is added , a `` death '' is not necessarily followed by a `` birth''it can be followed by a migration event .",
    "the algorithm we use is as follows .",
    "first , we randomly pick a `` parent '' , or gene to be copied , from deme @xmath82 with probability @xmath88 .",
    "suppose this parent is on island @xmath89 .",
    "then with probability @xmath90 a migration event takes place , which entails a death on island 1 , and the copied gene from island 2 occupying the space that was left behind . with probability @xmath91",
    "we assume that no migration event takes place and a death takes place on island 2 , with the copied gene from island 2 replacing it .",
    "note that the total probability per generation that an individual migrates from deme @xmath82 to deme @xmath81 per generation is @xmath92 .    since @xmath6 is fixed for each deme , if @xmath3 increases by @xmath93 on island @xmath82 , this is equivalent to @xmath2 decreasing by @xmath93 on island @xmath82 .",
    "so the four independent transition probabilities are given by @xmath94 with @xmath95    we can obtain the deterministic equation , valid in the limit @xmath96 , describing the effect of migration on the number of @xmath2 alleles on one island , by using the same method as was used to find eq .",
    "( [ m_mut_deter ] ) , describing the effects of mutation . in this case",
    "we calculate @xmath97 from eqs .",
    "( [ m_mig_probs ] ) and ( [ m_mig_probs_last ] ) to find that @xmath98 \\ , , \\label{m_mig_deter}\\ ] ] which is of the same form as eq .",
    "( [ m_mut_deter ] ) for mutations .",
    "the corresponding expression for the expected number of @xmath2 alleles on island @xmath89 , @xmath99 is obtained by exchanging all @xmath93 and @xmath89 indices . using these expressions",
    "one can show that the weighted mean @xmath100 is conserved , i.e. , @xmath101 , whilst the difference @xmath102 decays geometrically since @xmath103 \\delta n ( t ) \\;.\\ ] ] in other words , migration results in a convergence of the mean allele frequencies on the two islands to a common value which in turn eventually reaches a stationary value @xmath104 that can be worked out from equation ( [ barn ] ) once the initial values @xmath105 and @xmath106 are known : @xmath107      in section [ intro ] we have already discussed the analogies that can be drawn between models of population genetics , individual based models ( ibms ) in ecology and models of the evolution of language .",
    "the mathematical formalism we have introduced in the current section allows us to make these analogies more concrete , and to define mappings between models in these three distinct areas .",
    "the genetic models which we have described have been of a gene at a single position ( locus ) on a chromosome , involved only one chromosome , and has not included sex : new genes were `` born '' from a single parent . in this very simplified genetics , we can directly identify a gene with an individual and vice - versa . in this case",
    "different alleles can be thought of as different species .",
    "therefore in the context in which we have been working , the mappings [ genes @xmath108 individuals ] and [ alleles @xmath108 species ] is very natural .",
    "the idea of an island is common to both population genetics and population ecology , where it is called a patch , and we have the further correspondence [ deme @xmath108 local community ] .    to extend these mappings to the evolutionary model of language change  @xcite described briefly in section [ intro ] , we begin by noting that the central idea of this approach is to make an analogy between `` different ways of saying the same thing''called _ variants _ of a word or set of words , and alleles . the specific `` word or set of words '' under consideration is called the _",
    "lingueme_. thus the first analogy is [ variants @xmath108 alleles ] . in the model  @xcite , each speaker s utterances may contain different variants of a lingume . in the case of two variants , the speaker s grammar can be modelled as being made up of @xmath6 _ tokens _ , of which @xmath7 are of one variant and @xmath109 of the other .",
    "an utterance by speaker @xmath82 will then produce tokens which modifies his own grammar ( death and birth of tokens belonging to speaker @xmath82 ) and which may modify the grammar of speaker @xmath81 ( migration of tokens from speaker @xmath82 to speaker @xmath81 ) .",
    "this gives the further analogies [ tokens @xmath108 genes ] and [ speakers @xmath108 islands ] .",
    "table [ mappings ] summarises the mappings between these different areas .",
    ".the correspondences between constituents , concepts and processes in population genetics , population ecology and language evolution.[mappings ] [ cols=\"^,^,^\",options=\"header \" , ]     while we have so far assumed that there are only two alleles , @xmath2 and @xmath3 , in the case of population genetics , the analogies with population ecology and evolutionary linguistics make it clear that we will frequently be interested in having more than two species or variants in our models . therefore in the next section will generalise the models so that there are @xmath110 possible types of gene / individual / token .    the interpretation of `` genetic drift '' , mutation and migration in population ecology and evolving linguistics is interesting .",
    "the species being considered in the analogy are not to be thought of as predators and prey , but rather as species of a similar type ( `` trophically similar species '' ) competing for a common resource , such as space or light .",
    "the fact that when a death of an individual occurs , it is immediately replaced by another ( either through a birth or by immigration ) means that there is intense competition ; as soon as a `` vacancy '' occurs , it is immediately filled .",
    "this coupling of the death rate to the birth / immigration rate so that the overall population remains fixed , is called the `` zero - sum rule '' in biology .",
    "models where trophically similar species ( for example , forests of trees ) change their population sizes through purely random dynamics analogous to pure genetic drift , are called neutral models  @xcite . they are , at present , quite controversial  @xcite , mainly because measurable `` physical '' quantities such as the species abundance distribution arise as a result of random effects . in the context of neutral theories",
    "a mutation corresponds to speciation , where a single individual of a species changes into an individual of a different species .",
    "this is , of course , a very coarse - grained description of a very complex process .",
    "immigration has the same interpretation as migration in the genetic case .    in the linguistics application",
    ", we think of different linguistic variants competing for use by members of the speech community . here , the analogue of `` trophically similar species '' would be functionally equivalent variants , or `` two ways of saying the same thing '' . for true neutrality , one would further require that no speakers ascribe any social value ( `` prestige '' ) to a variant , which might cause them to reproduce it more ( or , indeed , less ) often they have heard it used thus far .",
    "there are many ways in which new variants might be created , a process referred to as _ innovation _",
    "@xcite . basically , most of these arise from speakers needing to communicate something that they have not communicated before ; other forces behind innovation include articulatory constraints which may involve speakers producing one variant , even if they aim to produce another .",
    "this latter case , in particular , could be modelled by mutation rates between variants , as we have described for the genetics application .",
    "migration corresponds to the process whereby tokens from the grammar of one speaker are incorporated into the grammar of another speaker with whom the first is conversing .",
    "two factors contribute to the overall rate at which tokens migrate from one grammar to another : first , the is the frequency with which two speakers converse ; secondly , speakers may give higher or lower weights to the utterances of other speakers based , for example , on the listener s perception of how similar the interlocutor is to themselves , or whether they wish to acquire social status by imitating variants associated with a prestigious group .",
    "such sociolinguistic effects are discussed in more detail in @xcite .",
    "meanwhile , it has been proposed @xcite that when dialects are brought into contact , as happened for example when people from britain and ireland migrated to new zealand , a truly neutral theory ( i.e. , one in which these social factors are claimed to be unimportant ) should describe observed effects , such as convergence to a relatively homogeneous dialect among a large community of speakers on a timescale of order of a human lifetime . whether a genetic drift - like process actually allows for such behaviour is another matter of debate and is under current investigation .    in this section",
    "we have introduced the simplest stochastic models of population genetics and brought out analogies with similar models in population ecology and evolutionary linguistics . in the next section",
    "we will write these models in a form more familiar to statistical physicists , generalise them , and also show that when the number of genes / individuals / tokens for an island / patch / speaker is large , they may be replaced by models based on fokker - planck equations , rather than on master equations .",
    "as we have seen in section [ ideal ] , the wright - fisher model is quite difficult to analyse , especially when mutation and migration are allowed for , and so very early on workers resorted to the _ diffusion approximation _  @xcite .",
    "this is a description of the process , valid when @xmath6 is large , where ( a ) the ( rational ) allele frequencies @xmath111 are replaced by real numbers @xmath112 , @xmath113 , and ( b ) the generational label , @xmath0 , is rescaled by a factor of @xmath114 .",
    "specifically , @xmath0 now measures units of @xmath6 generations , so that one generation becomes only @xmath114 units of @xmath0 .",
    "the governing equation is now a fokker - planck equation for @xmath115 which for pure genetic drift has the form @xmath116\\ , , \\label{diffusion}\\ ] ] where @xmath117 .",
    "in essence , this is a mesoscopic description , whereas the wright - fisher equation was a microscopic , or gene - based description .",
    "it is possible to add terms to eq .",
    "( [ diffusion ] ) which account for mutations and migrations .    in the last section we also described how the moran model , while similar to the wright - fisher model , was in many ways easier to write down and generalise .",
    "therefore in this section we will formulate the basic stochastic processes that interest us in terms of moran - type models , rather than wright - fisher models .",
    "an advantage is that moran - type models may be formulated as master equations , a step that is not typically followed in the mathematical biology literature .",
    "the advantage of formulating a stochastic process in this way , is that there there then exist systematic methods to approximate the master equation for large @xmath6 as a fokker - planck equation  @xcite .",
    "it will turn out that the fokker - planck equation corresponding to the large @xmath6 limit of the moran model has the same form as eq .",
    "( [ diffusion ] ) , that is , has the same limit as the wright - fisher model .",
    "we will begin by discussing the reformulation of the markov chain based description of population genetics given in section [ ideal ] to the master equation description which we will use in the rest of the section .",
    "we begin by rewriting the standard dynamical relation for a markov chain , @xmath118 as @xmath119 using @xmath46 .",
    "now the terms in the sums with @xmath120 may be omitted  since they cancel between the two terms on the right - hand side  and so only the terms involving an _ actual transition _ , that is , terms with @xmath121 , appear in the equation .",
    "up until this point , we have been careful not to refer to @xmath0 as a `` time''it has simply been an integer labelling generations .",
    "however now we interpret @xmath0 as time divided into intervals @xmath122 taken to be sufficiently small that at most one sampling event occurs during it .",
    "dividing eq .",
    "( [ markov ] ) by @xmath122 , and omitting the terms with @xmath120 , yields @xmath123 we now adopt a different view of the stochastic process . instead of assuming that one exactly one sampling event happens per generation",
    "( including @xmath124 , where no transition actually occurs ) , we now have sampling events occur at unit rate so that _ on average _ one event takes place per generation .",
    "once @xmath0 is sufficiently large , by far the most likely number of sampling events that will have taken place will be equal to @xmath0 .",
    "therefore one expects the properties of the continuous and discrete time processes to concur at large times .",
    "additionally , we replace the transition probability from state @xmath4 to @xmath7 per generation @xmath125 with the transition rate per unit time @xmath126 .",
    "these two quantities are related via the expression @xmath127 where the terms of order @xmath128 and higher represent the probability of two or more events happening in time @xmath122 . substituting ( [ p_to_t ] ) into eq .",
    "( [ markov_master ] ) , and letting @xmath129 , gives @xmath130 which is the usual master equation used by statistical physicists  @xcite .",
    "typically , the transition rates @xmath126 are assumed given ( this specifies the model ) and we wish to determine the @xmath18 .",
    "the initial condition is that the system is in state @xmath16 at @xmath131 .",
    "boundary conditions may also have to be given .",
    "to illustrate these ideas we will look at three examples , all of which were introduced in section [ ideal ] .",
    "we begin with the moran model for pure genetic drift , which has non - zero elements of the transition matrix given by eq .",
    "( [ m_p_nonzero ] ) . in the continuous time formulation ,",
    "the population evolves by two individuals being sampled uniformly with replacement from the population as a poisson process with the mean time between events taken to be unity .",
    "one of the sampled individuals is designated the parent which is copied to create an offspring ; the other sampled individual is sacrificed to make way for the new offspring . to obtain the transition rates in the master equation ( [ master_usual ] )",
    ", we need not consider the matrix element @xmath132 , since this does not involve an actual transition .",
    "we find therefore @xmath133    we now turn to the moran model with mutation , which has non - zero elements given by eq .",
    "( [ m_p_nonzero_mut ] ) .",
    "we will contrast two ways one might construct a continuous - time process to mirror the discrete time process as defined in section  [ wf_m_mut ] . the most obvious is to follow the prescription given earlier : that is , to have poisson sampling events as described in the previous paragraph , and to mutate the copy of the parent to allele @xmath3 with probability @xmath57 if the chosen parent was an @xmath2 or with probability @xmath58 in the opposite direction . the transition rates @xmath134 and @xmath135 are then given by the expressions for @xmath136 and @xmath137 appearing in eq .",
    "( [ m_p_nonzero_mut ] ) , i.e. , @xmath138    the second approach we shall take differs in that the mutation process will is divorced from the death / birth process  the two are considered to take place independently with mutations occurring spontaneously , rather than between a death and a birth . specifically , we shall sample on average once per unit time a parent  offspring pair , as previously described .",
    "with probability @xmath139 , we replace the offspring with a copy of the parent without mutation .",
    "the rest of the time , i.e. , with probability @xmath140 , we switch the offspring individual to allele state @xmath3 with probability @xmath141 if it is in state @xmath2 ; otherwise we switch to state @xmath2 from @xmath3 with probability @xmath142 .",
    "this leads to transition rates of the form @xmath143 to make contact with the discrete - time moran process , we shall insist that , at any given time , the probability that the _ next _ event to occur in the continuous - time process is equal to that for the discrete - time process , given the same starting configuration . to do this , we rewrite @xmath136 and @xmath137 in ( [ m_p_nonzero_mut ] ) as @xmath144 correspondence is obtained if we put @xmath145 that is , if a fraction @xmath57 of the time , @xmath2 alleles spontaneously change state to @xmath3 alleles , and a fraction @xmath58 of the time , @xmath3 alleles change to @xmath2 .",
    "note this leads only to positive transition rates if the mutation probabilities satisfy @xmath146 .",
    "therefore , not all moran processes in which birth , death and mutation are intertwined can be represented by a continuous - time model in which mutation occurs independently of birth and death .",
    "nevertheless , a model with transitions rates of this form was introduced by maruyama ( model i in the appendix of @xcite ) and it has been remarked  @xcite that the results obtained by this model and the moran model seem to be essentially identical . our derivation of the former starting from the latter shows why this is the case .",
    "we now turn to the the moran model with migration between two islands , discussed in section [ wf_m_mig ] . in this case",
    "the state of the system is specified by two integers : @xmath147 .",
    "the considerations leading to the master equation ( [ master_usual ] ) , where the state is specified by a single variable , generalise in a straightforward way to the case where the state is specified by a set of integers : @xmath148 where in the case under consideration here @xmath149 .",
    "the transition probabilities are given by eq .",
    "( [ m_mig_probs ] ) . to construct the corresponding continuous - time process",
    ", we take the rate at which a parent is chosen in deme @xmath81 , the offspring of which displaces an individual in deme @xmath82 , to be @xmath150 where we recall that @xmath151 is the probability the parent is in deme @xmath81 , and @xmath80 the probability that the offspring lands in deme @xmath82 , conditioned on the parent being in deme @xmath81 . since @xmath152 and @xmath153 for any @xmath81 , the total rate at which pairs of individuals are sampled is @xmath154 as required , even though the sampling is now non - uniform .",
    "the transition probabilities for this model then follow as @xmath155 note that the diagonal matrix elements @xmath156 give the rates at which an individuals are chosen to reproduce without their offspring subsequently migrating . from the master equation ( [ master_many ] ) and",
    "the transition rates ( [ m_mig_rates ] ) , we can obtain the deterministic equation , valid in the limit @xmath96 , describing the effect of migration on the number of @xmath2 alleles on one island , by calculating @xmath157 . focusing on island 1 , we multiply eq .  ( [ master_many ] ) by @xmath158 and sum over all @xmath84 and @xmath85 . by shifting the quantities being summed over by @xmath159 in some of the sums over @xmath84 , one finds that @xmath160 substituting for the transitions rates using eq .  ( [ m_mig_rates ] )",
    "yields @xmath161 which is in agreement with eq .",
    "( [ m_mig_deter ] ) as one would expect .",
    "having obtained the transition rates ( [ m_rates ] ) , ( [ m_mut_rates_b ] ) and ( [ m_mig_rates ] ) for pure genetic drift involving two alleles , together with mutation and migration between two islands , we can now investigate the form that the governing equations take in the limit where @xmath6 is large .",
    "it will turn out that these processes can be described by fokker - planck equations in this limit .",
    "this will allow more complex situations , for example involving @xmath83 islands or @xmath110 alleles , to be formulated in a rather straightforward way .",
    "we again begin with the moran model for pure genetic drift .",
    "when formulated as a master equation , it has the form ( [ master_usual ] ) with transition rates ( [ m_rates ] ) .",
    "such an equation is of `` the diffusion type '' , since there is no macroscopic equation and the large @xmath6 approximation results in a non - linear fokker - planck equation  @xcite . in this case , the large @xmath6 limit can be obtained in a straightforward fashion by substituting @xmath162 , and expanding out any remaining terms in @xmath6 in a @xmath114 expansion .",
    "we find @xmath163 after a little algebra , this reduces to @xmath164   + { \\cal o } ( 1/n^3)\\ , .",
    "\\label{m_2_largen2}\\ ] ] so if we define a scaled time @xmath165 , then taking @xmath166 we obtain @xmath167\\ , , \\label{diffusion_2_1}\\ ] ] which is the diffusion equation ( [ diffusion ] ) .",
    "this shows that two different gene - based models  the wright - fisher and moran models  give the same mesoscopic fokker - planck equation . this is a familiar situation in statistical physics :",
    "microscopic models describing the same `` physics '' , but formulated in slightly different ways , typically will give rise to the same mesoscopic equation . the only difference between the wright - fisher and the moran model is that , as usual , the time - scales differ .",
    "the redefinition of a generation in the wright - fisher model leads to @xmath117 , whereas the scaling of time in the moran model gives @xmath168 .",
    "in other words , a generation in the wright - fisher model is @xmath169 times as long as in the moran model in this mesoscopic description .",
    "when the diffusion approximation is applied to the moran model which includes mutational and migrational effects , the rates of migration and mutation have to be rescaled by a factor of @xmath6 .",
    "if this were not so , the large @xmath6 limit of the master equation would not be a fokker - planck equation of the diffusion type , but a linear fokker - planck equation which would describe fluctuations about the deterministic equation ( [ wf_mut_deter ] )  @xcite . in the backward - time formulation",
    "discussed later ( see section  [ coalescent ] ) , we will also see that this scaling corresponds to a regime in which all relevant processes affecting the ancestry of the population occur on the same timescale .",
    "let us first consider the models with mutation .",
    "the scaled mutation rates , with the factor of @xmath6 mentioned above and a factor of 2 to be explained below , are defined by @xmath170 in section [ continuous_time ] we discussed two ways of introducing mutation into the moran model .",
    "the first resulting in transition rates given by eq .",
    "( [ m_mut_rates_a ] ) and the second in transition rates given by eq .",
    "( [ m_mut_rates_b ] ) , with @xmath171 and @xmath142 given by eq .",
    "( [ connection_1 ] ) .",
    "there is no need to carry out the @xmath114 expansion for each model in turn , since the transitions rates for both are identical ( although one has the restriction @xmath146 ) , and which using the scaled forms ( [ scaled_m_rates ] ) read @xmath172 since the term ( [ m_2_largen2 ] ) is already of order @xmath173 , the terms involving @xmath174 and @xmath175 which multiply it give terms of order @xmath176 , which do not contribute to the fokker - planck equation . therefore the only additional terms due to mutation are the second terms on the right - hand side of the transitions probabilities ( [ m_mut_rates_c ] ) , which are @xmath177   p(x , t ) + { \\cal o } ( 1/n^3)\\ , , \\label{m_2_mut1 }   \\end{aligned}\\ ] ] which on simplification yields @xmath178 +   { \\cal o } ( 1/n^3)\\ , .",
    "\\label{m_2_mut2}\\ ] ] adding this additional term to eq .",
    "( [ m_2_largen2 ] ) , and using rescaled time units @xmath179 , we find on letting @xmath96 that the additional mutation processes present in either model give rise to the fokker - planck equation @xmath180 + \\frac{1}{2 } \\frac{\\partial^{2}}{\\partial x^2 } \\left [ x(1-x ) p \\right]\\ , .",
    "\\label{diffusion_2_1_mut}\\ ] ] the restriction @xmath146 , which applied to one of the models , takes the form @xmath181 , when expressed in terms of the scaled mutation rates . since in most applications @xmath182 and @xmath183",
    "are numerically small , and in any case we are taking the limit @xmath96 , this condition will always hold .",
    "furthermore , fokker - planck equation ( [ diffusion_2_1_mut ] ) agrees with that found by applying the diffusion approximation to the wright - fisher model with mutation  @xcite .",
    "the additional factors of 2 introduced in eq .",
    "( [ scaled_m_rates ] ) were included to conform with the conventions used in the wright - fisher case .",
    "the introduction of two islands or speakers has been discussed in section [ wf_m_mig ] and the transition rates given in eq .",
    "( [ m_mig_rates ] ) . to derive the fokker - planck equation from the master equation in this case",
    ", we note that the first terms on the right - hand sides of these transition rates are exactly as for pure drift , up to the inclusion of prefactors @xmath184 or @xmath185 .",
    "therefore , the contribution from events which do not involve actual migration is @xmath186 + { \\cal o } ( 1/n^3)\\ , .",
    "\\label{m_2_largen_2_1}\\ ] ] the second terms on the right - hand side of the transition rates in eq .",
    "( [ m_mig_rates ] ) , for migration from island @xmath81 to island @xmath82 are : @xmath187 p(\\underline{x},t )   + { \\cal o } \\left ( \\frac{1}{n^2}\\right ) \\nonumber \\\\ & = & g_{i j } \\frac{1}{n}\\,\\frac{\\partial } { \\partial x_{i } } \\left [ \\left ( x_{i } - x_{j } \\right ) p \\right ]   + { \\cal o } \\left ( \\frac{1}{n^2}\\right)\\ , .",
    "\\label{m_2_largen_2_2}\\end{aligned}\\ ] ] in order for the fokker - planck equation to be of the diffusion type , the rates of migration between demes , i.e. , @xmath188 for @xmath189 , have to be scaled by a factor of @xmath6 , just as the mutation rates were .",
    "let us now parametrise these off - diagonal matrix elements as @xmath190 where @xmath191 is of order unity .",
    "then , @xmath192 , and so the fokker - planck equation becomes @xmath193 \\nonumber \\\\ & & { } + \\frac{2}{n^2 } \\left ( { \\cal g}_{1 2 } \\frac{\\partial } { \\partial x_{1 } } -   { \\cal g}_{2 1 } \\frac{\\partial } { \\partial x_{2 } } \\right )   \\left [ \\left ( x_{1 } - x_{2 } \\right ) p \\right ] +   { \\cal o } \\left ( \\frac{1}{n^3}\\right)\\ , .",
    "\\label{m_2_largen_2_3}\\end{aligned}\\ ] ] introducing @xmath194 , as before , we can let @xmath96 and obtain the fokker - planck equation for migration between two islands : @xmath195 \\nonumber \\\\   & + & \\left ( { \\cal g}_{1 2 } \\frac{\\partial } { \\partial x_{1 } } - { \\cal g}_{2 1 }   \\frac{\\partial } { \\partial x_{2 } } \\right ) \\left [ \\left ( x_{1 } - x_{2 } \\right )   p \\right]\\ , .   \\label{diffusion_2_2_mut}\\end{aligned}\\ ] ] in this mesoscopic formulation all trace of the individual genes has disappeared , and we are left only with a description in terms of the fractions of genes on island @xmath82 which are of type @xmath2 .",
    "we have so far , for simplicity , mainly restricted ourselves to considering two islands and two alleles .",
    "however the formalism we have discussed carries over with little modification to the cases of an arbitrary number of island and alleles . in order to avoid introducing too many complicating looking expressions in this section ,",
    "we have relegated some of the details to an appendix .",
    "we assume that on each island we have a deme labelled by @xmath82 , with @xmath196 being the number of @xmath2 alleles and @xmath197 the number of @xmath3 alleles .",
    "a parent is chosen from island @xmath81 with probability @xmath151 and subsequently leaves an offspring on island @xmath82 with probability @xmath80 , where the sum rule @xmath198 must be satisfied . then proceeding as in section [ wf_m_mig ] , the transition probabilities analogous to those in eq .",
    "( [ m_mig_probs ] ) are : @xmath199 and @xmath200 to go over to a master equation description , we introduce the set of migration rates via eq .",
    "( [ migrates ] ) .",
    "the transition rates for the master equation ( [ master_many ] ) now follow : @xmath201 to obtain the fokker - planck equation , valid when @xmath6 is large , is now very simple , since the required calculations are as in the @xmath202 case .",
    "for example , eq .  ( [ m_2_largen_2_1 ] ) is unchanged , except that the sum is now from @xmath203 to @xmath204 , and the contribution ( [ m_2_largen_2_2 ] ) holds for all pairs @xmath82 and @xmath81 with @xmath205 .",
    "introducing as before @xmath206 for @xmath189 , rescaling time as @xmath207 , letting @xmath96 and noting that @xmath208 in this limit , we obtain the fokker - planck equation for migration between @xmath83 islands : @xmath209   \\nonumber \\\\ & + & \\sum_{\\langle i j \\rangle } \\left ( { \\cal g}_{i j } \\frac{\\partial } { \\partial x_{i } } - { \\cal g}_{j i } \\frac{\\partial } { \\partial x_{j } } \\right )   \\left [ \\left ( x_{i } - x_{j } \\right ) p \\right]\\ , .",
    "\\label{diffusion_2_l_mut}\\end{aligned}\\ ] ] here the notation @xmath210 means `` sum over all distinct pairs @xmath82 and @xmath81 '' .",
    "fokker - planck equations may be written as continuity equations  @xcite ; in the case of interest here it takes the form @xmath211 , where @xmath212   - \\sum_{j \\neq i } { \\cal g}_{i j } \\left [ \\left ( x_{i } - x_{j } \\right )   p ( \\underline{x } , t ) \\right]\\ , ,   \\label{current}\\end{aligned}\\ ] ] is the probability current .",
    "multiplying the equation of continuity by @xmath213 and integrating over all @xmath214 ( @xmath215 ) gives @xmath216 since the probability current vanishes on the boundaries  @xcite . from eqs .",
    "( [ current ] ) and ( [ av_xk_1 ] ) we have @xmath217 to make contact with previous results for finite @xmath6 , we reintroduce @xmath218 , @xmath206 and @xmath219 , so that eq .",
    "( [ averages_2_l ] ) becomes @xmath220 this is in agreement with eq .",
    "( [ av_mig2 ] ) found directly from the master equation in the case @xmath202 .",
    "let us briefly consider under what conditions the mean of the frequency of @xmath2 alleles across all islands is conserved .",
    "for this we require @xmath221 for this to hold for any set of allele frequencies @xmath222 , we require @xmath223 since the total mean @xmath2 allele frequency is conserved by migration ( and rigorously conserved in the absence of drift , not just on average ) models for which the migration rates satisfy this equality are called _",
    "conservative_. we will see in section  [ nonideal ] that a number of exact results are known for models with conservative migration .      so far in this article",
    "we have restricted ourselves to situations where each gene has only two alleles : @xmath2 and @xmath3 .",
    "there is no reason , other than grounds of simplicity , to do so , and it is possible to generalise the treatment to the situation where there are @xmath110 possible types of alleles , @xmath224 , where @xmath225 .",
    "if one is considering a single island , the possible states are labelled by the number of @xmath224 alleles denoted by @xmath226 , where @xmath227 . clearly , since @xmath228",
    ", @xmath229 is not an independent variable .",
    "if there are @xmath83 islands , then there are @xmath230 independent variables : @xmath231 with @xmath215 and @xmath227 .",
    "we begin by assuming that there is no mutation or migration ( that is , @xmath232 ) .",
    "the basic transition probability associated with an @xmath233 allele being replaced by an @xmath224 allele is @xmath234 where @xmath235 , @xmath236 . clearly if the transition involves the @xmath110th allele the expression has to be modified , since the number of alleles of type @xmath110 is not an independent variable .",
    "the transition rates which appear in the master equation are obtained as before through consideration of a continuous - time process in which pairs of individuals , one of which reproduces and whose offspring displaces the others , are sampled on average once per unit time .",
    "this leads to @xmath237 where @xmath235 and neither is equal to @xmath110 , and @xmath238 if either allele @xmath239 increases at the expense of allele @xmath110 or allele @xmath110 increases at the expense of allele @xmath239 , respectively .",
    "we can now carry out a large @xmath6 expansion on the master equation with the transition rates ( [ rates_m_1_1 ] ) and ( [ rates_m_1_2 ] ) , just as we did in eq .",
    "( [ m_2_largen1 ] ) .",
    "the algebraic details are a little more messy for general @xmath110 , and so we have given them in the appendix . rescaling the time as before",
    ", one finds the fokker - planck equation @xmath240 - \\sum^{m-1}_{\\alpha=1 }   \\sum^{m-1}_{\\beta \\neq \\alpha } \\frac{\\partial^{2 } } { \\partial x_{\\alpha }   \\partial x_{\\beta } } \\left [ x_{\\alpha } x_{\\beta } p \\right ] \\right\\}\\ , , \\label{diffusion_m_1}\\ ] ] in the limit @xmath96 .",
    "this the usual multi - allelic diffusion equation  @xcite    if we now add the possibility of mutations occurring , @xmath241 mutation probabilities have to be defined to describe mutations from allele @xmath242 to allele @xmath243 .",
    "we will denote this probability by @xmath244 . to see how this matrix enters the formalism ,",
    "let us return to the the case of two alleles and rewrite eqs .",
    "( [ mut_p1 ] ) and ( [ mut_p2 ] ) as @xmath245 where we have written @xmath2 and @xmath3 as @xmath246 and @xmath247 respectively , @xmath248 , and where the _ mutation matrix _ is given by @xmath249\\ , .",
    "\\end{aligned}\\ ] ] notice that the condition that the columns of the matrix @xmath250 add up to 1 ensures that @xmath251 , since @xmath252 . for the case of @xmath110 different alleles",
    "@xmath250 has entries @xmath253 if @xmath235 , and @xmath254 for the diagonal entry @xmath255 . therefore to deduce the form of the transition probabilities in the moran model with @xmath110 alleles and mutation",
    ", we may follow the same arguments which led to eq .",
    "( [ m_p_nonzero_mut ] ) in the case of two alleles .",
    "for instance , if an @xmath242 allele is replaced by an @xmath243 allele , then @xmath256 this will hold for all @xmath257 and @xmath258 , with @xmath235 , as long as we interpret @xmath259 as @xmath260 .",
    "the change in the mean value of @xmath226 with time can be calculated in an analogous way to eq .",
    "( [ m_mut_deter ] ) and one finds that @xmath261    as in section  [ continuous_time ] , we shall follow two approaches to mutation in the continuous time formulation . first , we shall have pairs of individuals sampled on average once per unit time , and the offspring of the parent changed to allele @xmath257 with probability @xmath253 given that the sampled parent carried allele @xmath258 .",
    "transition rates for this model are then given by @xmath262 for @xmath263 and it is understood that @xmath259 is always implicitly given by @xmath264 . in the appendix",
    "we derive the fokker - plank equation for this system , valid when @xmath6 is large .",
    "again , it is necessary to rescale the rates of mutation between different alleles , i.e. , @xmath265 the fokker - planck equation reads @xmath266 + \\frac{1}{2 } \\sum^{m-1}_{\\alpha=1 } \\sum^{m-1}_{\\beta=1 } \\frac{\\partial^{2 } } { \\partial x_{\\alpha } \\partial x_{\\beta } }   \\left [ { \\cal d}_{\\alpha \\beta}(\\underline{x } ) p \\right ] \\ , , \\label{diffusion_m_mut_1}\\ ] ] where @xmath267 and @xmath268 are given by @xmath269 and @xmath270 note that the term in the sum with @xmath271 in ( [ a_m_1 ] ) is zero , so it is not necessary to define the diagonal rescaled mutation matrix elements @xmath272    it is worth , briefly , considering the variant of the continuous - time mutation model in which mutation events are separated from the birth - death events . as in section  [ continuous_time ] , we shall sample pairs of individuals on average once per generation , and a fraction @xmath139 of the time replace one of the pair with a copy of the other ; the remaining fraction @xmath140 of the time , one of the pair shall be mutated to allele @xmath257 with probability @xmath273 , given that it carries allele @xmath258 .",
    "the transition rates for this model are @xmath274 + ( 1-\\gamma ) \\left [ u_{\\alpha \\beta } \\frac{n_{\\beta}}{n } \\right ] \\;.\\ ] ] compare now with ( [ muta ] ) which can be written as @xmath275 since no allele frequencies @xmath276 with @xmath277 appear in ( [ mutb ] ) , the only way the two can be made equal is if we take @xmath278 .",
    "then , the sum over @xmath276 gives @xmath279 , since all allele frequencies add up to unity .",
    "this results in @xmath280 correspondence with ( [ mutb ] ) is then obtained as long as @xmath281 where we have taken @xmath282 for all @xmath283 .",
    "we see that , in common with the case @xmath284 discussed in section  [ continuous_time ] , the sum of mutation rates @xmath285 must be less than one in order for the simplified model ( in which mutation is a spontaneous process ) to have the same dynamics as the full model in which mutation , birth and death are combined .",
    "we remark that this condition is satisfied in the limit @xmath286 when mutation rates are scaled with @xmath6 as above .",
    "the fokker - planck equation ( [ diffusion_m_mut_1 ] ) results , albeit with a simplified deterministic ( potential ) term @xmath287 on account of the mutation rates depending only on the end product of the mutation .",
    "note that this time , the term @xmath288 is included in the summation .",
    "even with this simplification , the fokker - planck equation is a nonlinear partial differential in @xmath289 variables , and one therefore does not expect it to be readily solved .",
    "the stationary solution has long been known @xcite to be @xmath290 in which @xmath291 is the usual gamma function . in this steady state ,",
    "the probability current vanishes everywhere , i.e. , detailed balance is satisfied . for a general set of mutation rates ,",
    "i.e. , one for which the mutation rates depend on both initial and final allele states , the stationary solution of the fokker - planck equation has not been found .",
    "one therefore speculates that detailed balance is not satisfied for these more general models , which may be related to the fact that one can not represent these mutation rates in models where birth / death and mutation are independent .",
    "meanwhile , a remarkable feature of the fokker - planck equation under the restriction @xmath292 is that the full time dependence can be found , not just the steady state .",
    "there are at least two ways to achieve this ; either one can explicitly construct the set of polynomials orthogonal to the weight function given by ( [ multipast ] ) to obtain the eigenfunctions of the operator appearing in ( [ diffusion_m_mut_1 ] ) @xcite .",
    "alternatively , one can make the change of variables @xmath293 under which the equation becomes separable  @xcite .",
    "essentially this is possible because of the simple way that the @xmath110-allele problem is `` nested '' in the @xmath294-allele problem .",
    "this is also responsible for most of the simplifications in the calculations of many other quantities of interest , such as mean times to fixation , the probability of a particular sequence of extinctions , and so on  @xcite . in this approach",
    ", it is also learnt that the eigenfunctions of the fokker - planck equation are jacobi polynomials .      the final case to consider is when there are @xmath110 alleles and @xmath83 islands .",
    "the analysis is a combination of the @xmath284 , general @xmath83 case considered in section [ m_alleles ] and the @xmath232 , general @xmath110 case just considered .",
    "so , for example , not including mutation for the moment , the terms in the transition probability which do not involve migration are exactly as in eq .",
    "( [ rates_m_1_1 ] ) with indices @xmath82 added to the @xmath226 or @xmath295 , as well as an extra factor of @xmath296 .",
    "alternatively , the transition probabilities are exactly as in eqs .",
    "( [ m_mig_probs_l+ ] ) and ( [ m_mig_probs_l- ] ) with indices @xmath257 and @xmath258 added : @xmath297 here we have removed an @xmath233 allele from island @xmath82 and replaced it with an @xmath224 allele , also from island @xmath82 ( first term ) or with a migrant from island @xmath81 ( second term ) .",
    "we assume that mutation occurs at the point that a parent is copied to make the new offspring , no matter whether that offspring remains on its parent s island or emigrates .",
    "furthermore , the probability that a parent with allele @xmath258 gives birth to an offspring with allele @xmath257 does not depend on either the source or target islands , i.e. , the mutation occurs with probability @xmath253 as before . including this mutation process",
    ", the transition probability becomes @xmath298 as before , @xmath235 and it is understood that @xmath299 should be replaced by @xmath300 .",
    "the transition rates follow as before .",
    "starting from the master equation ( [ master_many ] ) it is straightforward to obtain the fokker - planck equation using these transition rates , the algebraic steps simply being a combination of those which need to be carried out for the cases considered in sections [ l_islands ] and [ m_alleles ] .",
    "the details are given in the appendix , where it is shown that the resulting fokker - planck equation is given by @xmath301 \\nonumber \\\\",
    "& + & \\sum_{\\langle i j \\rangle } \\sum^{m-1}_{\\alpha=1 }   \\left ( { \\cal g}_{i j } \\frac{\\partial } { \\partial x_{i \\alpha } } -   { \\cal g}_{j i}\\frac{\\partial } { \\partial x_{j \\alpha } } \\right )   \\left [ \\left ( x_{i \\alpha } - x_{j \\alpha } \\right ) p \\right ] \\nonumber \\\\ & + & \\frac{1}{2 } \\sum^{l}_{i=1 } f_{i } \\sum^{m-1}_{\\alpha=1 } \\sum^{m-1}_{\\beta=1 } \\frac{\\partial^{2 } } { \\partial x_{i \\alpha } \\partial x_{i \\beta } }   \\left [ { \\cal d}_{\\alpha \\beta}(\\underline{x_i } ) p \\right ] \\ , , \\label{diffusion_m_mut_l}\\end{aligned}\\ ] ] where @xmath267 and @xmath302 are given by eqs .",
    "( [ a_m_1 ] ) and ( [ d_m_1 ] ) respectively .",
    "an equation of a very similar form to eq .",
    "( [ diffusion_m_mut_l ] ) has been obtained in connection with the model of language evolution previously discussed  @xcite . in that case",
    "the equation was derived through purely mesoscopic reasoning  there were no `` islands '' of @xmath6 tokens , only fractions , @xmath112 , of different variants in a speaker s grammar . in this case in order to derive the fokker - planck equation , the mutation and migration rates also had to be scaled , now not by @xmath6 , but by @xmath303 , the weight given to new tokens .",
    "the generational time had also to be scaled , this time by @xmath304 .",
    "thus the scalings required to derive the fokker - planck equation are identical in both cases .",
    "in section  [ ideal ] we described the wright - fisher model as a forward - time process , i.e. , one specifies the probability of having a certain number of alleles in a subsequent generation _ given _ the number present in the current generation .",
    "it is perfectly legitimate instead to ask for the probability that a certain number of individuals in the current generation are all descended from a set of individuals from the _ previous _ generation . as we describe in this section",
    ", one can reconstruct the ancestry of the present - day population given that it has evolved under the dynamics defined in section  [ ideal ] .",
    "we shall also show below that this can be used to recover any desired property of the population going forward in time from a known initial condition .",
    "thus these forward- and backward - time approaches are entirely equivalent",
    ".      to describe the backward - time approach in detail , we return to the ideal wright - fisher population of @xmath6 haploid individuals described in section  [ ideal ] .",
    "each of these individuals must have a parent from the previous generation ; some of them may share a parent , in which case there are individuals in the previous generation that did not have any offspring .",
    "hence , as one looks back in time the number of ancestors of the present - day population must decrease until a single ancestor of the entire population is found .",
    "let us assume that at @xmath0 generations in the past ( note that in this section , increasing @xmath0 means going back further in time ) there are @xmath7 ancestors of the present - day population .",
    "the probability that any pair of these ancestors have the same parent is @xmath114 .",
    "this can be understood from the fact that when going forward in time , a new generation can be constructed by assigning to each of the @xmath6 offspring a parent chosen at random from one of the @xmath6 individuals in the previous generation .",
    "the probability that out of any pair of offspring , the second receives the same parent as the first is then clearly @xmath114 as claimed .",
    "if the number of ancestors is much smaller than the total population size , @xmath305 , the probability that three or more individuals are siblings , or that that there is more than one pair of siblings among the subpopulation of @xmath7 ancestors , is of order @xmath306 and can thus be neglected in the limit @xmath286 .",
    "as one steps back a single generation , therefore , the number of ancestors decreases by one with probability @xmath307 since there are @xmath308 pairs that could find a common parent ; otherwise the number of ancestors stays the same .",
    "graphical representation of the coalescent process .",
    "each vertical line corresponds to a lineage leading to the final ( present - day ) population .",
    "two lineages merge whenever the ancestors they correspond to find a common parent .",
    "since this coalescent rate is proportional to @xmath309 , where @xmath7 is the number of lineages remaining and is much smaller than the total population size @xmath6 , the expected time between coalescence events considerably lengthens as one goes back in time . ]",
    "it is customary to represent this decrease in the number of ancestors in the form of a tree with the vertical direction representing time ( going upwards corresponds to going backward in time ) .",
    "each branch represents an ancestor of the present day population and two branches coalesce when the corresponding ancestors find a common parent ",
    "see fig .",
    "[ coalesce - ideal ] .",
    "for this reason this backward - time process was called `` the coalescent '' when formalised mathematically by kingman in the 1980 s @xcite , although the underlying ideas had previously been employed by population geneticists prior to this point ( some discussion of this earlier work can be found in @xcite ) .    another way to picture this process , which may be more appealing for physicists ,",
    "is as a particle reaction system .",
    "let there be a lattice ( or , to be more technically correct , a graph ) with @xmath6 sites ( nodes ) , @xmath7 of which are occupied by a particle .",
    "in each timestep , each particle either remains where it is , or hops with some probability to one of its neighbours .",
    "should two particles ever occupy the same site simultaneously , they immediately coalesce  see fig .  [ completegraph ] .",
    "one can verify that the backward - time formulation of the ideal wright - fisher model corresponds to this reaction - diffusion process on the complete graph ( i.e. , a network in which each site is connected to every other  also sometimes called a mean - field geometry ) .",
    "interpretation of the ancestral dynamics as a reaction - diffusion process on the complete graph .",
    "each particle represents a lineage , and each particle hops to a neighbour , or stays where it is , with equal probability in each time step .",
    "should two particles ever coincide on the same site , they react immediately , leaving only a single particle . ]    from @xmath310 one can calculate statistics of the length of time that elapses between a state with @xmath7 ancestors to a state with @xmath311 ancestors ( as long as both @xmath7 and @xmath312 are much smaller than @xmath6 ) .",
    "this is because @xmath310 is constant until a coalescence occurs , and hence the time spent in a state with @xmath7 ancestors has a geometric distribution @xmath313^{t-1 } p_c(n ) \\;.\\ ] ] the mean of this distribution is thus @xmath314 , and since successive coalescence events are uncorrelated , the time from @xmath7 to @xmath312 ancestors is @xmath315 this result shows that the ancestry of a present - day population is dominated by an era in which the number of ancestors is small : the mean time in which there are two ancestors @xmath316 is more than half the time @xmath317 to a single common ancestor from any number @xmath318 ancestors .",
    "in fact , it can further be shown that if one starts with a sample comprising the entire population @xmath319 , in the limit of an infinite population @xmath286 , after any finite rescaled time @xmath320 , the number of ancestors remaining is finite ( i.e. , a vanishing fraction of the initial population ) @xcite .",
    "this is significant because it means that the condition for only pairwise coalescences with nonzero probability , i.e. , that @xmath305 , is satisfied at any finite rescaled time @xmath321 in the past .",
    "this backward - time description of wright - fisher population dynamics has a number of practical benefits .",
    "firstly , the data that geneticists have to hand comes from some present - day sample of individuals , and thus it is sensible to condition the outcome of the evolutionary dynamics on this known outcome .",
    "indeed , geneticists are often interested in the information obtained by reconstructing the ancestry of sampled genes , and a number of sophisticated methods based on ensembles of ancestral trees have been developed with this aim in mind @xcite .",
    "secondly , it is very much more efficient to simulate the backward - time process : to construct a genealogical tree for @xmath7 present - day individuals with the desired rate involves generating @xmath322 waiting times from the appropriate geometric distributions ( [ gd ] ) .",
    "furthermore , having constructed this tree , one can superimpose various of models of mutation ( such as that described above ) since selectively neutral mutations ( i.e. , those that do not cause individuals carrying a particular allele to have more offspring than others ) by definition do not affect the population dynamics .",
    "finally , as we will discuss in section  [ nonideal ] below , the backward - time method generalises more readily to non - ideally mating populations ( although one is restricted to selectively neutral alleles ) .",
    "lines of ascent / descent connecting two sets of individuals , one in the initial condition and one in the final condition .",
    "note here that shading does not refer to the allelic state of any individual , rather whether it is considered to be within or outside the set of interest at the early or late time .",
    "the heavy lines show the lines of descent from the early - time set that contribute to the late - time set . ]    clearly , it should be possible to use the backward - time formulation to calculate properties of the forward - time evolution from a fixed initial condition . the way to do",
    "this is to note that the process of assigning mutant alleles to individuals in the initial condition is an example of a ( one - off ) mutation process that has no effect on the statistics of the line of descent .",
    "consider now fig .",
    "[ twosets ] .",
    "it shows the lines of descent from some initial condition : we can take the individuals shown shaded at the earlier time ( top ) to be mutants , and the remainder to carry the wild - type allele . at the later time",
    ", we can select some other set of individuals ( e.g. , that formed by the dark - shaded individuals ) and ask for the probability that all are mutants .",
    "clearly for them all to be mutants , they must all be descended from the mutants in the initial condition ( if no mutation events take place in the interim ) .",
    "however , there may also be other mutants present at the later time outside the set of interest ( there are two such mutants in fig .",
    "[ twosets ] ) .",
    "therefore , to construct the probability @xmath323 that all @xmath324 sampled individuals at late time are descended from one , more or all of the @xmath325 mutants at the initial time from @xmath326 , the probability that there are _ precisely _ @xmath327 mutants @xmath0 generations after the initial condition , one needs to sum the latter , weighted by the probability that the chosen set falls within the late - time mutant set . given that there are @xmath327 mutants in the population , there are @xmath328 ways to choose @xmath324 individuals in such a way that all are mutants .",
    "since there are in total @xmath329 possible ways in which @xmath324 individuals could have been chosen , we have that @xmath330    we can ask the same question using the backward - time language . let @xmath331 be the probability that the late - time chosen set of @xmath324 individuals has coalesced into @xmath332 ancestors @xmath0 generations previously . for all @xmath324 late - time individuals all to be mutants , their @xmath332 ancestors must all be drawn from the initial mutant set . using the same kind of counting argument as previously one finds that @xmath333 equating these two expressions gives an implicit duality relation between the forward- and backward - time distributions @xmath334 and @xmath335 ; this can be found for example in @xcite . using the identity",
    "@xmath336 one can write this duality relation to give @xmath334 explicitly in terms of @xmath335 @xcite .",
    "one finds @xmath337 since it is usually the case that backward - time quantities are more easily obtained than their forward - time counterparts ( e.g. , by monte carlo sampling of the ancestral dynamics , or the equivalent reaction - diffusion process ) , this formula provides one means for efficient computation of the evolution from a fixed initial condition .",
    "for example , if one wants to know the probability that a mutant allele has become fixed by time @xmath0 , one puts @xmath338 in the foregoing to find @xmath339 actually , in this case @xmath340 is known analytically @xcite , as indeed is @xmath341 , at least in the limit @xmath286 and after rescaling allele frequency @xmath342 and time @xmath343 @xcite .",
    "nevertheless , this approach has recently found utility in applications to fixation times subdivided populations in which neither of these distributions can be calculated exactly ( see @xcite and section  [ nonideal ] below ) .      in section  [ master ]",
    "we saw that the characteristic timescale of evolution grew linearly with population size for the wright - fisher model , and quadratically in the moran model .",
    "one sees these same scaling relations in the coalescent formulation .",
    "recall that above we argued that the probability that two lineages coalesce in one generation undergoing wright - fisher evolution is @xmath344 . under the moran model ,",
    "the probability that a pair of lineages coalesces is equal to the probability that one of them was chosen to be the parent individual , and the other the offspring .",
    "this is @xmath345 or @xmath346 if the sampling is done with or without replacement , respectively .",
    "the factor of @xmath89 appears here because there are two ways in which a ( parent , offspring ) permutation can be assigned to a pair of individuals .    in both cases ,",
    "the total rate of coalescence if there are @xmath7 lineages present is @xmath347 as long as @xmath348 . therefore in the limit @xmath286 the ancestries of both wright - fisher and moran populations have the same dynamics as long as time as rescaled as @xmath343 in the former and @xmath179 in the latter",
    "this is precisely the scaling that was previously used to obtain the same fokker - planck equation for the two models .",
    "in fact , very many neutral population dynamical processes have the same ancestral dynamics as the wright - fisher and moran models in the limit @xmath286 under the appropriate rescaling of time .",
    "for example , if one has a model in which the distribution of offspring number for each individual is invariant under exchanges of the individuals , and one can further define a timescale on which the probability of ternary coalescences is vanishingly small",
    "compared to binary coalescences , then ( subject to other rather formal requirements ) , the ancestral dynamics converges in the limit @xmath286 to that of the wright - fisher process ( see , e.g. , @xcite for the full mathematical details ) .",
    "population geneticists refer to this property as the _ robustness _ of the coalescent ; physicists will recognise this lack of sensitivity of the late - time behaviour to details of the dynamics in large populations as a kind of universality .",
    "furthermore , one can also understand the need to rescale migration and mutation rates with the population size @xmath6 from the backward - time formulation .",
    "consider the moran model with two alleles as defined in section  [ wf_m_mut ] .",
    "the probability that a particular ancestor was chosen as the offspring in the previous generation is @xmath114 , and further that the allele mutated after the parent was sampled is either @xmath57 or @xmath58 ( depending on the allele in question ) . for coalescence and mutation probabilities to be of the same order in @xmath6 ,",
    "we therefore require @xmath57 and @xmath58 both to be of order @xmath114 .",
    "we have thus far mostly restricted our discussion to ideal populations , i.e. , those in which the individual(s ) displaced through the production of new offspring are chosen from a uniform distribution .",
    "we now turn to the contrasting case of non - ideal populations , where the individuals to displace are chosen non - uniformly and investigate the various ways in which population subdivision has been handled by population geneticists .",
    "non - ideal populations are most easily handled within the backward - time formulation , and therefore it is most convenient to describe the migration events in terms of the set of probabilities @xmath349 that any given individual randomly sampled from subpopulation ( or deme ) @xmath82 is the offspring of a parent individual from the previous generation in deme @xmath81 . for the case",
    "@xmath189 , this is given simply as the joint probability for a parent to be in deme @xmath81 and an offspring in deme @xmath82 , which in our earlier notation is @xmath350 on the other hand , the probability that an individual in deme @xmath82 is not an immigrant is obtained from the fact that @xmath351 , viz , @xmath352    it is worth at this stage to explore these migration parameters a little further .",
    "first , if subpopulation @xmath82 comprises @xmath353 individuals , the expected number of immigrants per generation is @xmath354 meanwhile , the expected number of emigrants from deme @xmath82 ( defined as the number of offspring of individuals that end up in a deme @xmath355 ) is @xmath356 migration is called _ conservative _ if the expected number of individuals entering and leaving every deme per generation is the same , i.e. , if @xmath357 , or equivalently , if @xmath358 note that this corresponds with the definition of conservative migration previously given ( [ consg ] ) when all deme sizes are equal , @xmath359 .",
    "now , let us briefly consider the common ancestor of a subdivided population .",
    "the single lineage that remains as @xmath360 will hop from between subpopulations at a rate @xmath349 from deme @xmath82 to deme @xmath81 .",
    "therefore , the stationary distribution of the common ancestor ( assumed unique ) is given by the solution of the set of equations @xmath361 we see that if migration is conservative , i.e. , if ( [ cons ] ) holds , the probability that the common ancestor is in subpopulation @xmath82 in the steady state is proportional to its size , @xmath362 where @xmath83 is the number of subpopulations and @xmath363 is their mean size .",
    "clearly , one can construct models of varying complexity and intricacy by suitable choices of the migration probabilities @xmath349 and subpopulation sizes @xmath353 , although some cases are still excluded from this description .",
    "consider the following classical examples .",
    "[ [ symmetric - island - model ] ] symmetric island model + + + + + + + + + + + + + + + + + + + + + +    the simplest model of subdivision has @xmath83 equal - sized subpopulations ( islands ) of equal size @xmath359 from which a uniform fraction @xmath364 of the individuals on each island are replaced by offspring chosen at random from the other islands : @xmath365 for all pairs @xmath366 .",
    "the version of this model that has an infinite number of islands was introduced by wright @xcite ; the finite island model is often attributed to maruyama @xcite and latter @xcite .",
    "[ [ randomly - mating - diploid - population - with - two - sexes ] ] randomly - mating diploid population with two sexes + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    recall that a diploid population is one that carries two instances of each gene which may or may not be the same allele .",
    "a diploid population of @xmath83 individuals can be thought of as a set of @xmath83 subpopulations , each of size @xmath89 .",
    "one gene from in each subpopulation is sampled randomly from the @xmath367 males in the populations ; the other from the @xmath368 females . to represent this model via the migration parameters @xmath349 ,",
    "however , it is necessary to have @xmath369 subpopulations each of size @xmath93 .",
    "we then take @xmath370 if subpopulation @xmath82 is a gene that is inherited from a male and @xmath81 is one of the @xmath371 genes carried by a male in the previous generation ; and @xmath372 is the corresponding quantity for females .    [ [ randomly - mating - asexual - diploid - population - with - hermaphrodism ] ] randomly - mating asexual diploid population with hermaphrodism + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    as an alternative to sexual reproduction , the two genes carried by a diploid individual could be inherited from the same parent ( through a process called _ selfing _ ) with probability @xmath373 , or from two different parents with probability @xmath374 ( by _ outcrossing _ ) .",
    "this model can not be reproduced using the @xmath349 parameters because the parental distribution is not independent for the two genes carried by a single individual .",
    "it is also possible for populations to be subdivided by age group , for example , if only individuals within some age class are fertile . given that considerable complexity is possible within even the simple general model of population subdivision outlined here , it is unsurprising that geneticists have sought a small number of parameters with which to characterise and differentiate the various specific cases that can be constructed .",
    "two quantities that appear prominently throughout the population genetics literature are _ inbreeding coefficients _ and _ effective population size_. both of these concepts are commonly said to have been introduced by wright @xcite .",
    "geneticists are often most interested in diploid organisms , and there an important question is whether the two instances of a gene at a specified locus are the same or not . in the absence of mutation , the two genes are the same only if they share a common ancestor ( a situation described as being _",
    "identical by descent _ ) .",
    "since this is the case if some _ inbreeding _ has occurred , the probability @xmath375 that two genes are identical by descent is sometimes called an _ inbreeding coefficient_.    given a sample of some individuals taken from a population , @xmath375 can be estimated by examining specific _ genetic markers_. for example , one can look for different enzymes that can catalyse a particular chemical reaction , or look directly at dna sequences ( see e.g. , @xcite for a description of various methods in the context of subdivided populations ) .",
    "of particular interest is the way in which population structure manifests itself in observed identity probabilities : typically , one expects there to be a greater chance for genes sampled from a subpopulation to be identical , than those from the wider ( meta)population .",
    "a quantity that encodes this information and that has become ubiquitous in analyses of population structure is denoted @xmath376 , variously called an inbreeding coefficient , fixation index or @xmath375-statistic , and was introduced by wright @xcite .",
    "a number of subtly different , sometimes ambiguous , definitions of this quantity can be found dotted around the literature  one senses a slight air of frustration arising from this state of affairs in the introduction of @xcite for example .",
    "following the approach of @xcite ( and others ) , we avoid getting too heavily into the distinctions between different expressions for @xmath376 , and simply adopt a particular definition , namely that provided by nei @xcite which reads @xmath377 here @xmath378 is the probability that two genes drawn at random from the same subpopulation are identical by descent , and @xmath379 is the corresponding quantity for a pair of genes sampled randomly from the entire population .",
    "nevertheless this definition leaves open the question of whether these samples should be weighted according to the subpopulation sizes or not ; in practice , this depends on how @xmath376 has been determined from an actual sample at hand .    despite its ubiquity and utility , there are various aspects of this quantity that are confusing at a first encounter .",
    "first there is the ( rarely elucidated ) notation : @xmath373 and @xmath380 simply stand for subpopulation and total population respectively .",
    "with reference to diploid populations , one can also define analogous quantities @xmath381 and @xmath382 which measure how much more ( or less ) closely related the pair of genes contained within an individual are than a pair sampled from the population at large .",
    "next , one often finds a single expression of @xmath376 quoted for a given model of subpopulation , even though identity probabilities in general change with time .",
    "wright s infinite island model ( defined above ) provides one example of a case where @xmath376 is time independent .",
    "since the total population size is infinite , the number of individuals across the whole population that carry a particular allele does not change with time . however ,",
    "if one takes a subsample of this population of size @xmath6 , there will be variation in the number of alleles of a particular type , and so one finds @xmath383 which leads to a nontrivial @xmath376 .",
    "wright @xcite obtained an expression for @xmath376 by taking the case of two alleles with a fraction @xmath214 of the individuals in subpopulation @xmath82 carrying one of them ( say , the wild type ) .",
    "in such a case , one can show that @xmath384 = 2 \\overline{x^2 } - 2 \\bar{x } + 1 \\\\ \\bar{f } & = & \\frac{1}{l^2 } \\sum_{i , j } \\left [ x_i x_j + ( 1-x_i)(1-x_j )   \\right ] =    2 \\bar{x}^2 - 2 \\bar{x } + 1\\end{aligned}\\ ] ] where @xmath385 .",
    "hence , @xmath386 we remark that in the limit of infinite subpopulations ( where there is no distinction between sampling with and without replacement ) , one has @xmath387 , the lower and upper bounds relating to extremes of homogeneous and heterogeneous spatial distributions of alleles respectively .",
    "these bounds one can see by noting first that the numerator of ( [ fstvar ] ) is positive , since it is a variance , and second that since all @xmath388 it follows that @xmath389 and further that @xmath390 .",
    "when subpopulations are finite , it is possible for @xmath376 to be slightly negative as a consequence of the effects of sampling without replacement : having removed one gene from a subpopulation , the probability of finding an identical gene in another subpopulation could be of order @xmath114 _ more _ likely than in the same subpopulation .",
    "therefore , if one uses ( [ fstvar ] ) as a general definition of @xmath376 rather than ( [ fst ] ) , as is done for example in @xcite , the results obtained will not necessarily agree in situations where subpopulations are finite .    using ( [ fstvar ] ) , wright @xcite showed by an explicit calculation of the variance in the allele frequencies that for the island model @xmath391 a quick way to obtain this result is to focus on a single subpopulation and assume that any immigrants that arrive from the wider population do not have a common ancestor ( and are hence unrelated ) .",
    "this assumption can be justified by switching to the coalescent picture outlined in section  [ coalescent ] , suitably extended to cater for population subdivision .",
    "if two lineages are situated within a single subpopulation , they coalesce at a rate @xmath114 , whereas two lineages in different subpopulations will coalesce at a rate proportional to @xmath392 .",
    "if the subpopulation size @xmath6 is held fixed whilst @xmath393 , a separation of timescales occurs and the probability that two lineages in different subpopulations coalesce effectively vanishes .",
    "hence , @xmath379 is effectively zero ( since the chance of two randomly - chosen individuals are from the same subpopulation is also of order @xmath394 ) , and @xmath395 .",
    "using now the fact that @xmath378 does not change with time , one can establish that @xmath396\\ ] ] since the right - hand side of this equation gives the value of @xmath378 after one generation of the wright - fisher process ( as defined in section  [ ideal ] ) .",
    "this comes about because the probability that the members of any pair are both descended from individuals from the subpopulation of interest is @xmath397 ; the probability that both are offspring of the same parent is @xmath114 ; and if they are offspring of different parents , those parents were themselves related with probability @xmath378 . rearranging this equation yields ( [ wimfst ] ) .",
    "note that within this picture , @xmath376 can be interpreted as the probability that two lineages in the same subpopulation coalesce before one of them migrates away ( looking backward in time ) .",
    "it is worth looking more closely at how @xmath376 behaves in the various limits that have previously been established .",
    "first , if the migration probability @xmath364 remains finite as the subpopulation size @xmath286 , @xmath398 which indicates an absence of spatial structure in gene frequencies  precisely what one would expect in the strong migration limit . on the other hand ,",
    "if the combination @xmath399 is finite as @xmath286 , one has @xmath400 to leading order in @xmath114 . as a consequence of this relationship , a value of @xmath376 estimated by sampling from a population is often used as a means to obtain the mean _ number _ of migrants @xmath401 arriving in a subpopulation in each generation , this being considered an easier task practically than tracking the movement of individuals between subpopulations .",
    "we also remark that ( [ wimfst ] ) is not restricted to the special case where the migration rate between every pair of islands is the same , since it has only been assumed that @xmath378 is stationary , and that all immigrants into the subpopulation of interest are unrelated . in practice",
    "this means one requires an infinite total population that is at equilibrium , or has stationary mean allele frequencies as a consequence of conservative migration",
    ". nevertheless , these are still quite restrictive assumptions and it turns out that estimating @xmath401 in this indirect way is fraught with difficulties @xcite .",
    "there is therefore much interest in exploring how @xmath376 behaves under more general conditions , and in particular under models of population subdivision in which migration is not conservative , or the number of subpopulations is finite . in these models ,",
    "allele frequencies vary with time , and typically therefore the focus is on the value of @xmath376 that is approached as equilibrium is reached . in a model with a finite total population ,",
    "the equilibrium state is one of fixation , as previously discussed in section  [ ideal ] .",
    "hence all identity probabilities tend to unity .",
    "however , the ratio that appears in ( [ fst ] ) approaches a nontrivial finite value , and thus contains some information about population structure that can be related to gene diversity .    a popular way to calculate",
    "this limiting value is to exploit a trick due to slatkin @xcite .",
    "let us trace the ancestry of a pair of genes sampled from the present day population . from the discussion of section  [ coalescent ]",
    "we know that eventually a common ancestor of these genes are found ; let us suppose that this happens at time @xmath0 with probability @xmath402 .",
    "let us also introduce a poisson mutation process that occurs with probability @xmath403 per generation .",
    "then , the probability that the two genes are _ identical in state _",
    "( i.e. , share a common ancestor _ and _ have not been subject to any mutations since the time of coalescence ) is @xmath404 in the limit @xmath405 , the concepts of identity by descent and identity in state become equivalent , and so asymptotically , @xmath406 where @xmath407 and @xmath408 are the mean times for two genes randomly sampled from within or between subpopulations respectively to find a common ancestor . in essence , therefore , the task is to calculate the mean first passage time for a pair of random walkers which hop between sites of a network at rates controlled by the migration parameters @xmath349 .",
    "this is achieved by solving the set of linear equations @xmath409 where @xmath410 is the mean time for two lineages , one in subpopulation @xmath82 and one in subpopulation @xmath81 to coalesce .",
    "this equation arises because if one has two distinct lineages , one needs to wait at least one generation for a change of state to occur .",
    "the joint probability that the lineages in @xmath82 and @xmath81 hop to @xmath411 and @xmath412 is @xmath413 .",
    "if they arrive in different subpopulations , we must then further wait a mean time @xmath414 for coalescence to occur .",
    "on the other hand , if they land in the same place @xmath411 , there is a probability @xmath415 for coalescence to occur immediately ( i.e. , a mean waiting time of zero ) , otherwise we need to wait @xmath416 on average . as with @xmath376 ,",
    "the question arises as to how to form the averages @xmath407 and @xmath408 appearing in ( [ fstt ] ) .",
    "for example , one could take @xmath417 for a specific subpopulation of interest .",
    "alternatively , one could average over all subpopulations , possibly weighted according to their size .",
    "it is not uncommon to see both size - weighted and unweighted versions of @xmath408 in the literature , presumably because the correct form depends on whether subpopulation sizes are known experimentally or not ( some further discussion is given in @xcite ) .    for arbitrary migration rates ( [ teqs ] ) can be rather cumbersome to solve , even for simple models of population subdivision .",
    "simplifications occur in the limit of slow migration , where @xmath418 where @xmath419 is the mean subpopulation size and is taken to infinity .",
    "recall from section  [ ideal ] that this is the regime in which both drift and migration operate on the same timescale in the limit of an infinite population size ; meanwhile , in the backward - time formulation , this scaling has migration events occurring on the same timescale as coalescence ( see , e.g. , @xcite ) . in this limit , terms which have both lineages hopping simultaneously",
    "do not enter into ( [ teqs ] ) .",
    "furthermore , it has been shown @xcite that , if migration is conservative , the mean time for coalescence of lineages located in the same subpopulation @xmath82 is independent of @xmath82 and given by @xmath420 .",
    "this fact considerably simplifies calculation of @xmath376 for conservative models .",
    "for example , slatkin @xcite showed that for the symmetric island model with a finite number @xmath83 of islands undergoing a slow migration process , @xmath421\\ ] ] which agrees with the result previously obtained by other methods ( such as that used by @xcite ; see also @xcite ) .",
    "we observe the the finite - size corrections to the infinite island result , ( [ wimfst ] ) , are of order @xmath394 which perhaps sheds some light on the ubiquity of the expression ( [ wimfst ] ) in analyses of population structure .",
    "this procedure for calculating the fixation index @xmath376 has been followed for a range of models of population subdivision , such as a hierarchical island model @xcite ( which has one finite island model nested inside another ) , a model with two subpopulations of different sizes @xcite and a continental - island model , where migration does not take place directly between the islands but only via a central continent @xcite .",
    "these models are tractable because of some symmetry or regularity in the migration structure that can be exploited .",
    "it is also possible to make progress in cases where the number of subpopulations tend to infinity @xcite .",
    "however , we will not discuss these models further here .      as we described in the previous section ,",
    "the motivation behind studying @xmath376 is that it is a statistic of a population that can be estimated by examining appropriate data .",
    "a second characteristic of biological populations that has also received considerable attention is its _ effective size _ , @xmath422 .",
    "like @xmath376 , this notion can also be attributed to wright @xcite , although it is also understood that crow and coworkers also made significant contributions to its development ( see , e.g. , the classic text @xcite ) .",
    "the basic idea here is that an ideal population is entirely characterised by the number of individuals @xmath6 that are randomly mating . in a real population ,",
    "one suspects that fluctuations ( like those associated with genetic drift ) might be due to some special `` breeding '' individuals that form a subset of the full population .",
    "there are as many ways to define @xmath422 as there are properties of a population that one might be interested in ; furthermore , these different definitions will not generally give the same value for a given model of population subdivision .",
    "nevertheless , for the concept to be useful , one hopes that the effective size determined by examining one quantity is indicative of how the population as a whole will behave .",
    "it is not appropriate here to get too involved in all the various definitions and their pros and cons ; instead we will highlight two particularly prominent definitions and give a flavour of how they depend on certain aspects of the population structure . for more extension discussions we refer the reader to @xcite .",
    "one of the most natural definitions of effective size arises from the forward - time prescriptions of the population dynamics given in section  [ ideal ] . recall that under the wright - fisher dynamics , if the allele frequency in one generation is known to be @xmath423 , in the next it is a random variable @xmath112 that has variance @xmath424 .",
    "this connection between the variance of an allele frequency and population size can be exploited to define an effective population size in a more general context .",
    "let @xmath425 be some measure of an allele frequency across a subdivided population , e.g. , the arithmetic mean @xmath426 , and @xmath427 the variance in this quantity after one generation of the underlying population dynamics .",
    "an effective size @xmath422 of this subdivided population can then be given as @xmath428 to distinguish it from other effective sizes than can be defined , this one is called the _ variance effective size_. note that in this expression the variance is over the distribution of allele frequencies @xmath429 generated by the population dynamics , and _ not _ the variance over subpopulations appearing in ( [ fstvar ] ) .",
    "a drawback of this definition of @xmath422 is that it is likely to depend on the frequency @xmath429 , and possibly other statistical quantities  such as the variance of allele frequencies over subpopulations .",
    "therefore , if one seeks a description of the dynamics that is closed in a small set of random variables , it will typically have to be an approximate description ( see , e.g. , @xcite ) .",
    "a definition of effective population size that avoids these difficulties makes use of the fact that when tracing lineages of an ideally mating population backward in time , pairs coalesce at a rate @xmath114 . the mean rate of coalescence between pairs of lineages in a subdivided population can then be taken to define the reciprocal of an effective population size .",
    "as with the fixation index @xmath376 , this rate will typically vary with time ; in those cases , one can adopt the coalescence rate that is approached as one looks infinitely far back in time .",
    "the effective size that results is then often referred to as an _ asymptotic effective size_. in fact , the same limit has been shown to be approached by a range of different definitions of effective size @xcite .",
    "this fact can traced to all definitions being governed asymptotically by the decay rate of the longest - lived nonstationary eigenstate of the underlying population dynamics .",
    "furthermore , this feature makes the asymptotic effective population size an appealing quantity to devote some effort to calculating .    as with @xmath376 , there are a few cases where the mean coalescence rate does not change with time and can be easily be calculated exactly .",
    "the first two such cases were introduced at the start of this section .",
    "[ [ randomly - mating - diploid - population - with - two - sexes-1 ] ] randomly - mating diploid population with two sexes + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    if there are two distinct lineages in a diploid population , they must both be inherited from the same parent ( and furthermore be the same gene from that parent ) if they are to coalesce ",
    "see fig .",
    "[ coalesce - mf ] . taking two genes from the population at random ( with replacement for simplicity ) , the probability that both were inherited from a male , or both from a female , is @xmath430 . within these classes ,",
    "the same gene is chosen with probability @xmath431 and @xmath432 for male and female parents respectively .",
    "hence one finds a total coalescence probability per generation of @xmath433 where we have identified the coalescence rate with an inverse population size as described above .",
    "this result was first given by wright @xcite .",
    "notice that @xmath434 , that is , if there is any imbalance in the number of males and females , the effective number of gene instances in the population is less than their actual number .     sexually reproducing diploid population .",
    "each individual carries one gene inherited from a female ( shown solid ) and one from a female ( shown shaded ) .",
    "two ways in which two distinct genes may coalesce are shown . in both cases ,",
    "the two offspring must have been inherited from an individual of the same sex . ]    [ [ randomly - mating - asexual - diploid - population - with - hermaphrodism-1 ] ] randomly - mating asexual diploid population with hermaphrodism + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    in this model , the effective size can be calculated as a consequence of a separation of timescales .",
    "a classical calculation can be found in @xcite ; here we follow the coalescent - based approach introduced in @xcite , also outlined in @xcite . as we have already remarked , this model is subtly different to that described in section  [ ideal ] , in that the parents of two lineages are not chosen independently . instead , should two lineages find themselves within the same individual there is a selfing probability @xmath373 that both are descended from genes contained within a single parent individual , and @xmath374 that they are each descended from different individuals . at the time of arrival into a single individual",
    ", these two lineages have a probability @xmath435 of immediately coalescing ; otherwise , going back a further generation there is a probability @xmath436 that they are both still in the same individual , uncoalesced , or @xmath436 of coalescing , or @xmath374 for the two lineages to return to a state at which they are located in different individuals . using the properties of the geometric distribution",
    ", it can be shown that two lineages arriving at the same individual have a total coalescence probability of @xmath437 , and the mean time to do so is @xmath438 ; on the other hand , escape occurs with probability @xmath439 and takes on average @xmath440 generations @xcite .",
    "meanwhile , when two lineages are in different individuals , the mean time for them to arrive in the same individual is @xmath83 , the number of individuals ( since the arrival probability per generation is @xmath394 ) .",
    "thus , once @xmath83 is taken sufficiently large at any fixed @xmath373 , the rate of coalescence upon arrival is very much faster than the rate of arrival ",
    "see fig .",
    "[ coalesce - herm ] .",
    "then , one can approximate the coalescence rate as the product of the arrival rate and the subsequent probability of coalescence , i.e. , @xmath441 again , the effective ( haploid ) population size @xmath442 is less than twice the actual population size , unless there is no selfing ( @xmath443 ) , when the effective and actual sizes are equal .",
    "separation of timescales in a hermaphrodite diploid population .",
    "the typical timescale @xmath444 for two lineages to migrate into the same individual is very much longer than the typical time to coalescence @xmath445 due to selfing , or to escape to different individuals @xmath446 due to outcrossing . ]",
    "[ [ population - subdivision - in - the - strong - migration - limit ] ] population subdivision in the strong migration limit + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the coupling of a large ratio of coalescence to migration rates and small subpopulation sizes is crucial in admitting the computation of effective size of a hermaphrodite population . in the opposite limit ,",
    "where migration is very fast compared to coalescence and subpopulation sizes are large , a simple , expressions valid for general models of population subdivision can also be obtained .",
    "the key is to realise that between coalescence events , all lineages are independently distributed according to the stationary distribution generated by the backward - time migration dynamics .",
    "that is , we assume that the probability for two lineages to be present in subpopulation @xmath82 is @xmath447 where @xmath448 is the stationary distribution for the single common ancestor of the whole population given by the migration balance equations ( [ migbal ] ) . given that the rate of coalescence for two lineages in subpopulation @xmath82 is @xmath449 it then follows that under this approximation that the mean coalescence rate is @xmath450 this formula has been shown to exact ( to leading order in @xmath114 ) if the migration probabilities @xmath349 obey @xmath451 where @xmath419 is the mean subpopulation size @xcite .",
    "this equation defines a strong migration limit , within which it is seen that the effective population size is always less than or equal to the total population size @xmath452 .",
    "equality is reached only if the stationary probabilities @xmath448 are in proportion to the subpopulation size , i.e. , if @xmath453 . if the stationary distribution is unique , this is the case only if migration is conservative .",
    "since ancestral lineages are well - mixed , one does not see any variation between subpopulations , and so the approximation of the entire population as an ideal population with a possibly reduced effective size would appear to be a good one .    for more general models of subdivision , where migration probabilities are typically of order @xmath454 ,",
    "fewer exact results are available .",
    "nevertheless , a formula for the effective population size in terms of the asymptotic changes in identity probabilities has been given @xcite as @xmath455 where @xmath456 is the probability that two individuals , one sampled from subpopulation @xmath82 and one from subpopulation @xmath81 , are identical by descent after @xmath0 generations , as defined in the previous subsection .",
    "this formula takes a particularly simple form in models when migration is conservative .",
    "then , as shown at the start of this section , the probability @xmath448 that the single remaining ancestor is in deme @xmath82 in the steady state is proportional to @xmath353 , the size of deme @xmath82 . then , reduces to @xmath457 where @xmath378 and @xmath379 here are _",
    "deme - size - weighted _ probabilities of identity for pairs of genes sampled from within demes and from the whole population respectively , that is @xmath458 defining a size - weighted @xmath376 through ( [ fst ] ) and the formul  for @xmath378 and @xmath379 given here , we find that for conservative models @xmath422 and @xmath376 can be related through @xmath459    when the assumption of conservative migration is relaxed , one does not find a simple relation between effective population size and inbreeding coefficients .",
    "furthermore , it is not clear that a single parameter ( such as @xmath422 of @xmath376 ) should satisfactorily characterise all aspects of the evolutionary dynamics .",
    "for example , when migration is weak , it has been argued that the ancestral dynamics can only be fully expressed in terms of takes `` structured coalescent '' @xcite that takes into account the numbers of lineages present in a particular subpopulation at finite times rather than the weighted late - time average implied by ( [ ne ] ) @xcite . in such cases , it is therefore necessary to examine specific models .",
    "for example , the variation of fixation times in structured populations undergoing weak migration has been investigated in an exact approached based on the duality relation given in section  [ coalescent ] for an ideal population @xcite .",
    "this allows for a comparison with the fixation time that would be seen in an ideal population with an effective size given by ( [ ne ] ) . in a range of models considered",
    ", it was found that the effective size gives an extremely good prediction for the fixation time , except in a particular case where special properties of the network structure admitted fixation to occur in a finite time in an infinite population .",
    "this finite - time effect has also been seen in voter models on heterogeneous ( scale - free ) graphs @xcite , which in fact is a special case of the general model of population subdivision outlined here with all subpopulation sizes @xmath460 .",
    "so far we have considered only neutral models of evolution , that is , those for which there is no preference for a particular allele . despite being apparently a reasonable model for some aspects of genetic , ecological or linguistic behaviour ( as we have previously discussed )",
    "geneticists in particular have been interested in the fate of alleles that are selected for or against .",
    "the relationship between the genetic make - up of an individual and its survival is of course very complicated .",
    "however , one can explore the effects of selection by simply introducing parameters that determine how many offspring an individual carrying a particular allele ( or combination of alleles when diploid organisms are being considered ) has on average . in this section",
    "we offer a small taste of some evolutionary models that encompass selection .",
    "let us return to the model that has a randomly - mating haploid population of @xmath6 individuals with two alleles , denoted @xmath2 and @xmath3 . in the neutral model , the parent of each individual in an offspring generation",
    "is chosen uniformly from all possible parents .",
    "when selection is active , it is supposed that an individual with allele @xmath2 ( @xmath3 ) is chosen to be a parent with a weight @xmath461 ( @xmath462 ) .",
    "that is , if there are @xmath4 @xmath2 alleles in the parent generation , each offspring has a probability @xmath463 of carrying allele @xmath2 ( at least , if no mutations occur ) .",
    "since each individual is assigned a parent independently , we have that the probability for there to be @xmath7 @xmath2 alleles in the next generation is @xmath464 w_a \\right)^n \\left ( \\left [ 1 - \\frac{n'}{n }    \\right ] w_b \\right)^{n - n }   \\label{sel_trans_prob}\\end{aligned}\\ ] ] where in the second line we have simplified the notation by introducing the mean _ fitness _ of a population with @xmath4 @xmath2 alleles @xmath465 w_b \\right ) \\;.\\ ] ] note that when the two alleles have equal fitness , i.e. , @xmath466 , ( [ sel_trans_prob ] ) reduces to ( [ wf_trans_probs ] ) for a neutral population .",
    "it is usual to take a pre - existing ` wild - type ' allele ( we ll take this to be @xmath3 ) to have fitness @xmath467 , and the ` mutant ' ( @xmath2 ) to have fitness @xmath468 .",
    "then , the mean change in the number of mutants in one generation , given that there are @xmath469 mutants in generation @xmath0 , is @xmath470 denoting the frequency of mutant @xmath2 alleles as @xmath112 , the fokker - planck equation can be shown ( e.g. , via a kramers - moyal expansion or a large-@xmath6 expansion ) to be @xmath471 when the relative fitness of the mutant @xmath472 is small . in this instance , small means @xmath473 , and not relative to @xmath114 .",
    "hence , if at some fixed @xmath472 one has the ( effective ) population size @xmath474 , the effects of drift can typically be neglected .",
    "then the mean allele frequency satisfies the deterministic equation @xmath475 and one finds a logistic growth in the number of mutants @xmath476 \\rme^{-st } } \\;.\\ ] ]    typically it is assumed that the stochastic effects of drift are important only when one of the allele frequencies is small , and so the logistic growth is taken to be representative of the change in frequency of a beneficial mutation in a randomly mating population once its frequency has reached some threshold ( see e.g. , @xcite ) .",
    "this period of rapid growth is often referred to as a _",
    "selective sweep_. of course , a mutant allele is present only in small numbers when it first appears , and here one can work out the probability that a mutant allele will be lost due to genetic drift . to do",
    "this one needs to solve the stationary _ backward _ fokker - planck equation corresponding to ( [ fpes ] ) @xmath477\\ ] ] subject to the boundary conditions @xmath478 and @xmath479 , since @xmath480 is the probability that a mutant allele becomes fixed given that its initial frequency is @xmath112 .",
    "integrating once gives @xmath481 and again gives @xmath482 where @xmath2 and @xmath3 are to be fixed by the boundary conditions .",
    "this yields @xcite @xmath483 in particular , if there is initially only a single mutant , @xmath484 , in the limit of an infinite population one has @xmath485 where we recall that to obtain ( [ fpes ] ) it was assumed that @xmath472 is small . from the backward fokker - planck equation ( [ bfpes ] )",
    "one can also find the mean number of generations @xmath321 until fixation of a selectively advantageous allele .",
    "it is given approximately as @xmath486 when the combination @xmath487 is large ( e.g. , @xmath472 some fixed value and @xmath286 ) @xcite",
    ".    one may ask how selection affects the backward - time formulation of the population dynamics that is couched in terms of genealogies .",
    "it turns out that the complexity of the calculations increases considerably , because as one goes back in time one needs to keep track of the number of alleles of each type present in the population .",
    "one can sometimes find situations in which there is an equilibrium in these frequencies , for example , when a selectively disadvantageous allele ( @xmath488 ) is maintained in a population due to recurrent mutations generating it @xcite .",
    "when there is a selective sweep , it can be shown that the relevant genealogies are those that have _ multiple _ lineages coalescing simultaneously @xcite  compare with the case of neutral evolution when the probability of a triple merger is suppressed by a factor of @xmath114 compared to that of a pairwise coalescence .",
    "this is consistent with the fact that for fixation to be achieved on a timescale sublinear in @xmath6 ( [ taus ] ) : recall , that in a state of fixation _ all _ @xmath6 individuals share a common ancestor .",
    "one way to formulate the genealogical process with selection is through the `` @xmath489-coalescent '' @xcite ; meanwhile , certain aspects have recently been elucidated by considering the properties of noisy travelling waves @xcite .    given the discussion of section  [ nonideal ] ,",
    "one may also be interested in determining how effects of selection and population subdivision combine . in a number of ways",
    "the situation is rather similar to the neutral case , at least if the selective advantage @xmath472 ( or disadvantage , if negative ) is not spatially dependent .",
    "for example , when migration is strong one expects fixation probabilities and times to be given ( [ qs ] ) and ( [ taus ] ) but with @xmath6 being an effective population size of the order of the total population size @xcite . in the slow migration limit , the mean time for a lineage to hop between subpopulations @xmath490 is much longer than the duration of a selective sweep @xmath491 and so typically each subpopulation is taken to be fixed in either the wild - type or mutant state .",
    "one thus calculates fixation probabilities and times by having wild - type subpopulations invaded by their mutant neighbours ( and vice versa ) on the migration timescale , and a flip from the wild - type to mutant state occurring with the probability given by @xmath492 , and in the other direction with the same expression but with @xmath472 replaced by @xmath493 .",
    "when conservative migration is in force , it can be shown that the probability a mutant allele fixes is independent of the location of the initial mutation @xcite : a similar situation occurred in the neutral case ( although the fixation probability is different ) . to see deviations from this behaviour",
    ", one needs either to introduce additional processes ( such as extinction and recolonisation of subpopulations @xcite ) or relax the assumption of conservative migration @xcite . in the latter case one",
    "finds that the network structure connecting the subpopulations strongly influences whether selection or drift is the dominant process .",
    "for example , star - like structures amplify the effects of selection and can be constructed such that an advantageous mutation appearing almost anywhere is guaranteed to fix . on the other hand , it is also possible to contrive networks in which fixation occurs whenever the mutation occurs within a particular subpopulation , and never if it appears elsewhere .",
    "this latter type of behaviour does not , in fact , depend on the mutation having a selective advantage : even neutral mutations appearing in `` well - connected '' parts of a system can fix with high probability when migration is a non - conservative process @xcite .",
    "shifting focus from networks to continuous space , one can write down an equation for the advance of an advantageous mutation .",
    "recall that in the absence of drift , one has the deterministic equation ( [ logistic ] ) for the mutant gene frequency @xmath112 in a subpopulation .",
    "with isotropic migration in one dimension with a coordinate @xmath57 one would augment this equation with a diffusion term @xmath494 \\;.\\ ] ] this is known as the fisher or kpp ( kolmogorov - petrovksy - piskunov ) equation @xcite and admits travelling wave solutions of the form @xmath495 where @xmath58 is the wave velocity . if one anticipates that the leading edge of the wave has an exponential decay @xmath496 , one finds a range of velocities @xmath497 are possible .",
    "it turns out that in such an equation , if the interface between the stable and unstable phases ( here , regions of high and low mutant frequencies ) is sufficiently sharp , the front velocity selected is the smallest allowed @xcite . if genetic drift is reintroduced , e.g. , by adding a white noise to ( [ fkpp ] ) with zero mean and variance @xmath498 ( cf .",
    "( [ fpes ] ) , but note the usual problems that arise from introducing multiplicative noise in such an _ ad - hoc _ way ) , one expects strong fluctuations in the leading edge of the travelling wave as a consequence of the possibility that a newly introduced mutant may go extinct .",
    "this causes a very small shift in the velocity of the front and a more diffuse profile than in the deterministic case @xcite .",
    "one can also consider models with spatially varying fitnesses .",
    "a simple example would be if a mutant had fitness advantage @xmath499 at position @xmath500 and disadvantage @xmath493 at @xmath501 ( @xmath472 here is taken to be a positive number ) @xcite . at @xmath502",
    "one anticipates that the mutant allele would be fixed ( @xmath503 ) , whilst at @xmath504 only the wild type would be found ( @xmath505 ) . using ( [ fkpp ] )",
    "the steady state can be found by solving the nonlinear equation @xmath506\\ ] ] where the positive sign is taken for @xmath501 and the negative sign for @xmath500 .",
    "the symmetry of the problem implies that @xmath507 , and in particular that @xmath508 .",
    "however , one finds the step in the fitness landscape at @xmath509 induces a discontinuity in the gradient of @xmath510 at that point . to see this",
    ", one must solve this differential equation which is achieved by multiplying both sides by @xmath511 and integrating twice .",
    "this procedure leads to @xcite @xmath512 & u<0 \\\\",
    "\\frac{3}{2 } \\tanh^2 \\left ( \\frac{1}{2 } \\sqrt{\\frac{s}{d } }    u + \\kappa",
    "\\right ) - \\frac{1}{2 } & u>0 \\end{array } \\right.\\ ] ] where @xmath513 this function is plotted in fig .",
    "[ cline ] .",
    "the spatial variation of allele frequencies due to a balance between migration and a changing fitness landscape has been called a _",
    "@xcite .",
    "variation of mutant allele frequency with position in a steady state where selection is balanced by migration .",
    "the mutant allele has a selective advantage @xmath472 at positions @xmath500 , a disadvantage @xmath493 at positions @xmath501 .",
    "migration is characterised by a diffusion constant @xmath514 .",
    "although hard to discern on the plot , there is a discontinuity in the gradient of the allele frequencies at @xmath509 . ]",
    "finally one can consider variation in fitness not in real space , but in the space of genotypes ( i.e. , possible allele combinations ) .",
    "let us return to a randomly - mating diploid population , in which a fraction @xmath214 of all genes are of allele @xmath515 , @xmath516 .",
    "it is fairly straightforward to show @xcite that , in the absence of drift , the change in allele frequency per generation is @xmath517 where the mean fitness of the population is @xmath518 and @xmath519 is the fitness of an individual carrying the pair of alleles @xmath520 .",
    "one can therefore view the function @xmath521 as a kind of free energy defined over the space of allele frequencies which the evolutionary dynamics seeks to minimise .",
    "if we now extend the discussion to multiple gene _ loci _",
    "( i.e. , genes coding for different traits ) with interactions between them , it is possible for an extremely rugged fitness landscape in the space of all possible allele frequencies to emerge @xcite .",
    "one can then find a transition between two distinct regimes induced by a change in mutation rate : if the total number of mutants appearing per generation across the whole population ( which is governed by the population size @xmath6 multiplied by the mutation rate @xmath57 ) is small , fixation of a selectively advantageous allele is likely to occur before the onset of the next mutation ( see e.g , @xcite ) .",
    "thus , all individuals in the population are then likely to have the same genotype , and one which tends towards a local fitness maximum . on the other hand , if the number of mutants appearing per generation is large , and one is likely to see many different genotypes in the population , each corresponding to a different fitness maximum . in the latter case",
    "the individuals are said to form a _ quasi - species _",
    "this article has been a review of the ideas and formalism used to model stochastic processes in fields that statistical physicists are not typically acquainted with , specifically population genetics , ecology and linguistics . as a consequence ,",
    "some parts of the discussion will seem familiar , other parts will not",
    ". we have tried , and we hope that we have succeeded , to explain the background ideas and motivation , since this will be the greatest obstacle to understanding among a readership of statistical physicists . on the other hand the degree of mathematical sophistication that has been assumed is greater than would be typical outside physics or mathematical biology .",
    "this makes review quite different to others in the same area , and while we expect the readership to be mainly statistical physicists , we hope that some of those working particularly in ecology and linguistics will find our approach to their subject interesting and stimulating .    in our discussions of the mathematical models ,",
    "we have mostly used the language of population genetics , but through of the mappings discussed in section  [ pg_e_l ] the results obtained are more widely relevant . as the evolutionary paradigm becomes",
    "even more widely applied , there may be other areas in which analogies can be drawn .",
    "it is interesting how neutral processes turn out to have greater importance in all three areas we discussed ; at the very least neutral theories can be thought of a null models , against which data and other models can be compared .",
    "most textbooks in population genetics begin their discussion of genetic drift with the wright - fisher model , although for physicists the use of non - overlapping generations and a `` time '' measured in number of generations will not appear so natural .",
    "the moran model , which has exactly the same limit when the number of genes become large , is far more familiar , resembling a birth / death processes where a death is immediately followed by a birth .",
    "in addition , the continuous time limit may easily be taken , leading to a master equation of a kind well - known in statistical physics .",
    "we spent some time explaining the relationship between the discrete - time approach , based on transition probabilities , and the continuous - time master equation approach , based on processes occurring independently at a given rate .",
    "the use of master equations is apparently rare in the population genetics literature , which is one of the reasons why we have gone into this approach in such detail .",
    "furthermore , this latter formalism usually turns out to be more efficient .",
    "for example , in his book hubbell  @xcite formulated his model by analogy with the corresponding discrete - time genetic models , and had to perform simulations to generate the stationary probability distribution .",
    "however , if the model is formulated as a master equation , the stationary probability distribution can be obtained analytically  @xcite .",
    "however , the relationship between the discrete- and continuous - time formulations is not necessarily straightforward .",
    "for example , in section  [ continuous_time ] we outlined two ways in which mutation can be included in a continuous - time formulation .",
    "one is to have combined birth , death and mutation events , with on average one occurring per unit time .",
    "the other is to have mutation as a spontaneous poisson process ( like radioactive decay ) .",
    "we showed that whilst all discrete - time ( moran ) processes with mutation could be realised using the former approach , restrictions were imposed on the latter .",
    "another aspect of the article , which to our knowledge has not been elucidated elsewhere in the context of these problems , is the emphasis we have put on starting with individual ( or gene or token ) based models and deriving the corresponding mesoscopic model , where the limit of the number of individuals , @xmath6 , tends to infinity .",
    "simulations are frequently carried out using individuals , and moreover , as is well - known , an infinity of individual based models will give the same mesoscopic model in the large @xmath6 limit .",
    "for example , the language evolution model which we have alluded to , was first discussed in a mesoscopic context  @xcite , but this analysis was restricted to quite simple situations , for instance where all speakers spoke equally with each other . when more complex situations are analysed , such as allowing for a non - trivial network topology for links between speakers  @xcite , the individual - based picture becomes far more useful . in particular ,",
    "the backwards - time or coalescent approach is a far more efficient way of performing simulations . in some cases , such as understanding trends in how fixation time changes with network structure , which require simulations of quite large networks ,",
    "the coalescent formulation is indispensable .    in genetics , ecology or language , just as in physics , reality",
    "can not be described by ideal models ; there will be a multitude of ways in which real systems deviate from the ideal models created by scientists when they first enter a field .",
    "one of the methods that has been devised by population geneticists to deal with this will be very familiar to physicists .",
    "this is to characterise a non - ideal system by a few parameters , which will hopefully , if chosen correctly , capture the essence of the system . it may be that a simple model can then be utilised , but with these parameters built in .",
    "an example is the effective population size , @xmath422 , discussed in section [ effective_pop ] , which reflects how the non - ideal nature of the system changes the effective value of @xmath6 : the effective size of the real population being the number of individuals in the ideal population which gives the same magnitude for the quantity of interest .",
    "the effective population size and inbreeding coefficient , discussed in section [ inbreeding_coeff ] , are extremely widely used , but unfortunately not in a very systematic way .",
    "we have attempted to illustrate their use , and to draw attention to some of the confusion which exists in the literature , but it is still the case that those using these useful concepts will need to be vigilant when reading the literature on them .",
    "this last observation opens up some questions that may be worth of further study .",
    "first one can ask whether inbreeding coefficients and the effective population size really adequately characterise the evolution of a non - ideal population .",
    "are there other approximation schemes that might allow deviation from ideal behaviour to be described in a systematic and controlled way ?",
    "secondly , the backward - time description of neutral evolution will be recognised by nonequilibrium statistical physicists as the reaction - diffusion process @xmath522 .",
    "although exact solutions for this process exist for certain mathematically convenient geometries ( such as continuous real space @xcite and , as we have seen , the complete graph ) there is interest in extending the analysis to heterogeneous graphs , which thus far have been treated only using approximate methods @xcite .",
    "such solutions would be useful as they would obtain more detail about the evolution of the system , for example , the manner in which an innovation propagates through the system _ en route _ to fixation .",
    "there are many other questions which would benefit from a systematic study of the type that statistical physicists are well - placed to carry out .",
    "we hope that this article has stimulated some readers to find out more about these fascinating applications of stochastic methods and to contribute to the development of the field .",
    "we wish to thank david alonso and alan bray for useful discussions .",
    "rab holds a personal research fellowship awarded by the royal society of edinburgh .",
    "in this appendix we give details of carrying out the large @xmath6 expansion beginning from the master equations involving @xmath523 alleles , considered in sections [ m_alleles ] and [ l_and_m ] .",
    "we begin by expanding out the terms containing the transitions rates ( [ rates_m_1_2])which are those involving the type @xmath110 allele  letting @xmath524 , and expanding all other terms in powers of @xmath114 .",
    "this is the procedure used to obtain eq .",
    "( [ m_2_largen1 ] ) , and the analogous expression in this case @xmath525 @xmath526\\ ] ] @xmath527 @xmath526 = \\frac{1}{n^2 } \\sum^{m-1}_{\\alpha=1 } \\left [ x_{\\alpha } \\left ( 1 -   \\sum^{m-1}_{\\beta=1 } x_{\\beta } \\right ) \\frac{\\partial^{2 } p } { \\partial x^{2}_{\\alpha } } \\right.\\ ] ] @xmath528\\ , , \\label{first_m_1}\\ ] ] neglecting terms of order @xmath529 and higher . carrying out the same procedure for the terms containing the transition rates ( [ rates_m_1_1 ] )",
    "gives an expression @xmath530 \\nonumber \\\\ & = & \\frac{1}{n^2 } \\sum_{\\alpha=1 } \\sum^{m-1}_{\\beta \\neq \\alpha }   \\left [ x_{\\alpha } x_{\\beta } \\frac{\\partial^{2 } p}{\\partial x_{\\alpha}^{2 } }   - x_{\\alpha } x_{\\beta } \\frac{\\partial^{2 } p}{\\partial x_{\\alpha }   \\partial x_{\\beta } } + 2 x_{\\alpha } \\frac{\\partial p}{\\partial x_{\\beta } }   - 2 x_{\\alpha } \\frac{\\partial p}{\\partial x_{\\alpha } } - p \\right ] \\label{second_m_1}\\end{aligned}\\ ] ] again neglecting terms of order @xmath529 and higher .",
    "adding eqs .",
    "( [ first_m_1 ] ) and ( [ second_m_1 ] ) gives for the master equation @xmath531 + { \\cal o } \\left ( \\frac{1}{n^3 } \\right ) \\nonumber \\\\ & = & \\frac{1}{n^2 } \\left\\ { \\sum^{m-1}_{\\alpha=1 } \\frac{\\partial^{2 } } { \\partial x_{\\alpha}^{2 } } \\left [ x_{\\alpha } \\left ( 1 - x_{\\alpha } \\right )   p \\right ] - \\sum^{m-1}_{\\alpha=1 } \\sum^{m-1}_{\\beta \\neq \\alpha }   \\frac{\\partial^{2 } } { \\partial x_{\\alpha } \\partial x_{\\beta } }   \\left [ x_{\\alpha } x_{\\beta } p \\right ] \\right\\}\\ , , \\label{third_m_1 } \\end{aligned}\\ ] ] up to terms of order @xmath529 and higher .",
    "as in previous cases , if we define a new time @xmath532 , and take @xmath96 , then we find the result eq .",
    "( [ diffusion_m_1 ] ) .    in the main text we discussed two different ways of including mutations . in the first type of model , mutation rates were given by eq .",
    "( [ muta ] ) . this equation may be written as @xmath533 where @xmath534 suppose that we first look at the case where @xmath535 in the transition rate ( [ muta_app ] ) .",
    "this gives the following contribution to the right - hand side of the fokker - planck equation : @xmath536 \\left [ x_{\\beta } + \\frac{1}{n } \\right ] \\left ( p + \\frac{1}{n } \\frac{\\partial p } { \\partial x_{\\beta } } - \\frac{1}{n } \\frac{\\partial p } { \\partial x_{\\alpha } } \\right)\\ ] ] @xmath537 x_{\\beta } p + { \\cal o } \\left ( \\frac{1}{n^2 } \\right)\\,.\\ ] ] the terms involving only the mutation rates are @xmath538 p\\ ] ] @xmath539 \\left\\ { \\frac{\\partial p}{\\partial x_{\\beta } }   - \\frac{\\partial p}{\\partial x_{\\alpha } } \\right\\ } + { \\cal o }   \\left ( \\frac{1}{n^2 } \\right ) .   \\label{first_m_1_mut}\\ ] ] the analogous expression when @xmath540 and @xmath541 is : @xmath542   \\left [ 1 - \\sum^{m-1}_{\\gamma = 1 } x_{\\gamma } + \\frac{1}{n } \\right ]   \\left ( p - \\frac{1}{n } \\frac{\\partial p}{\\partial x_{\\alpha } } \\right)\\ ] ] @xmath543 \\left [ 1 - \\sum^{m-1}_{\\gamma=1 }   x_{\\gamma } \\right ] p + { \\cal o } \\left ( \\frac{1}{n^2 } \\right)\\,,\\ ] ] and when @xmath544 and @xmath545 is : @xmath546 \\left [ x_{\\beta } + \\frac{1}{n } \\right ]   \\left ( p + \\frac{1}{n } \\frac{\\partial p}{\\partial x_{\\beta } } \\right)\\ ] ] @xmath547 which lead to the analogous expressions to eq .",
    "( [ first_m_1_mut ] ) : @xmath548 p\\ ] ] @xmath549   \\frac{\\partial p}{\\partial x_{\\alpha } } + { \\cal o }   \\left ( \\frac{1}{n^2 } \\right ) .",
    "\\label{second_m_1_mut}\\ ] ] and @xmath550 p\\ ] ] @xmath551 x_{\\beta } \\frac{\\partial p } { \\partial x_{\\beta } } + { \\cal o } \\left ( \\frac{1}{n^2 } \\right)\\ , .",
    "\\label{third_m_1_mut}\\ ] ] from the expressions ( [ first_m_1_mut])-([third_m_1_mut ] ) , the term involving mutations in the fokker - planck equation can be found .",
    "for example , let us focus on the mutation rates involving @xmath243 and @xmath242 with @xmath535 and @xmath235 .",
    "after some straightforward algebra , the terms from eqs .",
    "( [ first_m_1_mut ] ) and ( [ second_m_1_mut ] ) which involve @xmath334 , but not derivatives of @xmath334 are @xmath552",
    "p   = \\frac{1}{n } \\sum^{m-1}_{\\alpha=1 } \\sum_{\\gamma \\neq \\alpha } u_{\\gamma \\alpha } p\\ , , \\label{fourth_m_1_mut}\\ ] ] using eq .",
    "( [ r_and_s ] ) .",
    "the terms from eqs .",
    "( [ first_m_1_mut ] ) and ( [ second_m_1_mut ] ) which involve derivatives of @xmath334 are more complicated , but eventually yield @xmath553 \\frac{\\partial p}{\\partial x_\\alpha}\\ ] ] @xmath554 \\frac{\\partial p}{\\partial x_\\alpha}\\ , .",
    "\\label{fifth_m_1_mut}\\ ] ] we may combine eqs .",
    "( [ fourth_m_1_mut ] ) and ( [ fifth_m_1_mut ] ) to give @xmath555 p + { \\cal o }   \\left ( \\frac{1}{n^2 } \\right)\\ , .",
    "\\label{sixth_m_1_mut}\\ ] ] introducing the scaled mutation rates defined in eq .",
    "( [ scaled_rates_general ] ) , this expression equals @xmath556 p   + { \\cal o } \\left ( \\frac{1}{n^3 } \\right)\\ , .",
    "\\label{seventh_m_1_mut}\\ ] ] using the rescaled time @xmath207 and letting @xmath96 , we see that we obtain the mutation terms displayed in eqs .",
    "( [ diffusion_m_mut_1 ] ) and eqs .",
    "( [ a_m_1 ] ) , at least in the sector where @xmath535 . in a similar way , the mutation terms where the allele @xmath557 is involved may be derived from eqs .",
    "( [ second_m_1_mut ] ) and ( [ third_m_1_mut ] ) .",
    "one again finds the result given by eqs .",
    "( [ diffusion_m_mut_1 ] ) and eqs .",
    "( [ a_m_1 ] ) .",
    "the form of the mutation terms in the fokker - planck equation in the second scheme we investigated , defined by the transition rates ( [ mut_second ] ) , follows from the results obtained above for the first scheme .",
    "this is because if one takes @xmath558 for all @xmath559 , then the transition rates of the two approaches are identical , although in the second case there is the restriction that @xmath560 .",
    "we therefore find the same fokker - planck equation ( [ diffusion_m_mut_1 ] ) , but now with eq .",
    "( [ a_m_1 ] ) taking the form @xmath561 which is eq .",
    "( [ cal_a_mod ] ) .",
    "when written out in terms of the scaled mutation rates , the condition on the @xmath562 in the second case reads @xmath563 which , since the rescaled rates are numerically small and we have taken the limit @xmath96 , is always satisfied .    finally , we consider the most general case where there are @xmath83 islands and @xmath110 alleles . as we remarked in the main text ,",
    "this involves only minor modifications of calculations which have been carried out previously .",
    "this is because , since both the mutation and migration rates are scaled by a factor of @xmath6 , any product of these rates will give a term of order @xmath176 , and so will not contribute to the fokker - planck equation .",
    "therefore we may consider mutation and migration separately , and simply need to insert appropriate indices on the contributions already calculated .",
    "first let , us consider eq .",
    "( [ m_m_mig_probs_l ] ) , which does not include mutation .",
    "if we begin by ignoring the migration terms @xmath564 with @xmath565 , then we see that the transition rates will be of the form given in eqs .",
    "( [ rates_m_1_1 ] ) and ( [ rates_m_1_2 ] ) , but multiplied by @xmath88 and with an index @xmath82 included .",
    "thus the result of a @xmath114 expansion is as in eq .",
    "( [ third_m_1 ] ) , but with an index @xmath82 and @xmath88 included : @xmath566 - \\sum^{m-1}_{\\alpha=1 } \\sum^{m-1}_{\\beta \\neq \\alpha } \\frac{\\partial^{2 } } { \\partial x_{i \\alpha }   \\partial x_{i \\beta } } \\left [ x_{i \\alpha } x_{i \\beta } p \\right ] \\right\\}\\ , , \\label{first_m_l}\\ ] ] up to terms of order @xmath176 and higher .",
    "this has to be summed over all @xmath82 .",
    "returning to eq .",
    "( [ m_m_mig_probs_l ] ) , the transition rates which involve migration can be found by analogy with the discussion in section [ l_islands ] , and in particular eq .",
    "( [ m_mig_rates_l ] ) , with @xmath257 and @xmath258 indices for the allele labels .",
    "these appear as in eqs .",
    "( [ first_m_1 ] ) and ( [ second_m_1 ] ) .",
    "the result is : @xmath567 + g_{i j } \\sum^{m-1}_{\\alpha=1 }   \\left [ \\left ( 1 - \\sum^{m-1}_{\\gamma=1 } x_{i \\gamma } + \\frac{1}{n } \\right )   x_{j \\alpha } \\left\\ { p - \\frac{1}{n } \\frac{\\partial p } { \\partial x_{i \\alpha } } \\right\\ } \\right . \\nonumber \\\\",
    "\\left . - \\left ( 1 - \\sum^{m-1}_{\\gamma=1 } x_{i \\gamma } \\right ) x_{j \\alpha }   p \\right ] + g_{i j } \\sum^{m-1}_{\\beta=1 } \\left [ \\left ( x_{i\\beta } +   \\frac{1}{n } \\right ) \\left ( 1 - \\sum^{m-1}_{\\gamma=1 } x_{j \\gamma } \\right )   \\right .",
    "\\nonumber \\\\ \\left .",
    "\\times \\left\\ { p + \\frac{1}{n } \\frac{\\partial p }   { \\partial x_{i \\beta } } \\right\\ } - x_{i \\beta }   \\left ( 1 - \\sum^{m-1}_{\\gamma=1 } x_{j \\gamma } \\right ) p \\right ] + { \\cal o } \\left ( \\frac{1}{n^2}\\right ) \\nonumber \\\\ = g_{i j } \\frac{1}{n } \\left [ \\left ( m-1 \\right ) p +   \\sum^{m-1}_{\\alpha=1 } \\left ( x_{i \\alpha } - x_{j \\alpha } \\right )   \\frac{\\partial p}{\\partial x_{i \\alpha } } \\right ]   + { \\cal o } \\left ( \\frac{1}{n^2}\\right ) \\nonumber \\\\",
    "= g_{i j } \\frac{1}{n}\\,\\sum^{m-1}_{\\alpha=1 } \\frac{\\partial } { \\partial x_{i \\alpha } } \\left [ \\left ( x_{i \\alpha } - x_{j \\alpha } \\right )   p \\right ] + { \\cal o } \\left ( \\frac{1}{n^2}\\right)\\ , .",
    "\\label{second_m_l}\\end{aligned}\\ ] ] scaling the migration rate by introducing @xmath568 , adding an analogous term which represents migration from island @xmath82 to island @xmath81 , and summing over all pairs of islands @xmath210 gives @xmath569 + { \\cal o } \\left ( \\frac{1}{n^3}\\right)\\ , .",
    "\\label{third_m_l}\\ ] ] the third and final term is found from eq .",
    "( [ m_m_mut_mig_probs_l ] ) ignoring the migration terms @xmath564 with @xmath565 .",
    "this is as in eq .",
    "( [ muta ] ) , but multiplied by @xmath88 and with an index @xmath82 added to the @xmath570 and @xmath571 . from the discussion leading to eq .",
    "( [ seventh_m_1_mut ] ) we find that the contribution for the first type of mutation is @xmath572   + { \\cal o } \\left ( \\frac{1}{n^3 } \\right)\\ , , \\label{fourth_m_l}\\ ] ] this has to be summed over all @xmath82 .",
    "the second type of mutation gives the same result , but with @xmath573 defined as in eq .",
    "( [ cal_a_mod ] ) .",
    "putting eqs .",
    "( [ first_m_l ] ) , ( [ third_m_l ] ) and ( [ fourth_m_l ] ) together gives equation ( [ diffusion_m_mut_l ] ) , a general fokker - planck equation describing a population of genes , of @xmath110 possible types , subdivided between @xmath83 different islands .",
    "100 url # 1`#1`urlprefix                                                                                        crow j  f and kimura m 1956 some genetic problems in natural populations in _ proceedings of the third berkeley symposium on mathematical statistics and probability _ , ed j  neyman ( university of california press , berkeley ) pp .",
    "122                                                        roze d and rousset r 2003 selection and drift in subdivived populations : a straightforward method for deriving diffusion approximations and applications involving dominance , selfing and local extinctions _ genetics _ * 165 * 21532166                  nordborg m and krone s  m 2002 separation of time scales and convergence to the coalescent in structured populations in _ modern developments in theoretical population genetics : the legacy of gustave malcot _ , ed m  slatkin and m  veuille ( oxford university press ) pp .",
    "194232                              kolmogorov a  n , petrovsky i  g and piskunov n  s 1937 a study of the diffusion equation with increase in the amount of substance , and its application to a biological problem _ bull .",
    "moscow univ . , math .",
    "mech _ * 1 * 126"
  ],
  "abstract_text": [
    "<S> we give a overview of stochastic models of evolution that have found applications in genetics , ecology and linguistics for an audience of nonspecialists , especially statistical physicists . </S>",
    "<S> in particular , we focus mostly on neutral models in which no intrinsic advantage is ascribed to a particular type of the variable unit , for example a gene , appearing in the theory . in many cases these models are exactly solvable and furthermore go some way to describing observed features of genetic , ecological and linguistic systems . </S>"
  ]
}