{
  "article_text": [
    "a fundamental theoretical and computational challenge in materials modeling is that of simultaneously capturing dynamics occurring over a wide range of length and time scales , under processing conditions .",
    "a classic example of such a multiscale problem is dendritic growth , a phenomenon seen in the solidification of undercooled melts , which involves the capillary length @xmath0 m , the scale of the pattern @xmath1 m , and the diffusion length @xmath2 m , which together span length scales over five orders of magnitude , and heat / solute transport through diffusion which occurs on time scales of @xmath3s . only recently , after considerable advances in computing technology , and through the use of sophisticated computational techniques @xcite , has this problem become tractable in three dimensions .",
    "although a number of computational approaches@xcite including quasi - continuum methods@xcite , the heterogeneous multiscale method@xcite , multi - scale molecular dynamics@xcite , multigrid variants@xcite and extensions of the phase field model@xcite have been proposed , they all appear to have significant limitations . developing a `` handshake '' algorithm , to seamlessly integrate the transition between scales , is a common problem . also , most models appear to be capable of handling only a limited number of crystallographic orientations , with a few isolated defects .",
    "elder _ et al .",
    "_ @xcite recently proposed a continuum , non - linear partial differential equation , which they called the phase field crystal ( pfc ) model , for realistically describing materials processing phenomena in polycrystalline materials .",
    "the pfc equation describes the evolution of the time averaged density field in the material , subjected to the essential constraint of mass conservation . while averaging the density makes it possible for the model to capture phenomena over diffusive time scales ( not possible with molecular dynamics ) , the spatially periodic variations , with a wavelength on the order of the inter - atomic spacing , allow it to incorporate lattice defects such as vacancies .",
    "these rapid spatial variations , however , are also the bane of the model , as they necessitate the use of a uniformly fine computational mesh whose grid spacing approaches the interatomic separation .",
    "thus the pfc model is computationally expensive for mesoscale problems ( such as dendritic growth ) , although still considerably better than a molecular dynamics calculation .",
    "we have recently described a theoretical approach to this difficulty @xcite , presenting a heuristic renormalization group ( rg ) @xcite method to coarse - grain the pfc equation and obtain equations of motion for the amplitude and phase of the periodic density field . using these variables , it is possible to reconstruct the original field to a certain order of approximation .",
    "the main advantage of such a description is that the amplitude and phase of the density field vary on length scales much larger in comparison to those of the field itself , which enables us to use a coarser mesh to speed up calculations ( see @xcite for details on accuracy and speedup ) .",
    "furthermore , the relative uniformity of these variables permits solution of the equations governing them on an adaptive grid which , we anticipate , will further improve computational efficiency .",
    "we emphasise that the rg procedure is more than a naive coarse - graining in real space of the density , because it uses the dynamics inherent in the underlying equation to project out the long - wavelength , small - frequency behavior .",
    "the essential effect of this distinction is that valuable aspects of the phase field crystal model , such as its native inclusion of elasticity , are preserved . in @xcite",
    "we verified explicitly , by numerical calculation , how the rg equations are able to accomplish this , and thus are suitable for dealing with polycrystalline systems .",
    "the main purpose of the present article is to present full details of the systematic calculation to derive such coarse - grained equations from the pfc equation .",
    "a secondary goal is to compare and contrast the variety of techniques that are available to derive coarse - grained equations of motion .",
    "a rather surprising finding of our work was that when we followed naively the cookbook recipe \" for each method , our results were not identical , with the rg methods yielding a form of the amplitude equation , slightly different from that derived by the classical method of multiple scales .",
    "the pfc equation obeys a local conservation law , and while this by itself can lead to a variety of interesting features@xcite , it also brings to the fore an ambiguity with the usual implementation of the renormalization procedure , something that is not unique to conservation laws .",
    "this ambiguity is essentially an operator ordering one , and can be remedied in a straightforward way .",
    "once done , all methods yield the same amplitude equation , even though the technical details are quite distinct in the different methods . as a pedagogical exercise",
    ", we present the analysis for the van der pol oscillator in the appendix , once again obtaining consistent results from all methods when using the approach described herein .",
    "our main conclusion is that the renormalization group method is still considerably easier to implement than competing approaches , and in particular requires no knowledge of the scaling relationship between space and time while achieving full rotational covariance at lowest order in perturbation theory .    in the remainder of this introduction , we review the main conceptual developments leading up to the techniques described in this paper .",
    "it is now relatively standard in non - linear pattern formation problems to use amplitude equations to uncover universal features of pattern forming systems .",
    "the formalism , first introduced by newell , whitehead , and segel ( nws ) @xcite to describe periodic patterns in rayleigh - bnard convection , offers a way to extract the spatio - temporal envelope of these patterns , which then allows one to predict the dynamics qualitatively with very little information about microscopic details . unfortunately however , the nws equation , as originally constructed , can only describe the dynamics of patterns oriented along the same fixed direction , everywhere in space , whereas physical systems often produce complex mosaics of patterns with no particular orientational preference .",
    "such mosaics arise in real systems which are invariant under rotations , and hence any equation which is used to study them must also have the crucial property of rotational covariance , something that is lacking in the nws equation .",
    "equations with an orientational bias can be very difficult to implement numerically , especially on systems with arbitrarily oriented patterns .",
    "nevertheless , the nws equation embodies the important notion of coarse - graining , which has played a significant role in shaping the modern day theory of pattern formation @xcite , and also forms the basis of our approach to multiscale modeling with the pfc equation .",
    "gunaratne _ et al . _",
    "@xcite first derived a rotationally covariant form of the nws equation using the method of multiple scales @xcite , where they assumed isotropic scaling of the spatial variables .",
    "they showed that the spatial operator in the nws equation could be _ symmetrized _ , by systematically extending the calculation to higher orders in the perturbation parameter @xmath4 , the reduced rayleigh number .",
    "they explained that the finite truncation of the perturbation series destroyed the rotational symmetry of the operator , which could however be recovered at a higher order .",
    "another important conclusion of their work was that the qualitative behavior of pattern formation remained unchanged if one ignored higher order corrections , provided the equation itself was rotationally covariant .",
    "a drawback of their calculation , however , was ( as with any application of the method of multiple scales ) , the need to guess _ a priori _ , the correct scaling of space - time variables .",
    "in addition , their calculation required gradual accumulation of operators and terms up to @xmath5 , before a rotationally covariant equation emerged .",
    "a more systematic approach emerged shortly after : chen _ et al .",
    "_ showed how to perform reductive perturbation theory using rg methods@xcite , and obtained the nws equation for the swift - hohenberg equation@xcite by renormalizing the leading secular divergences at each order .",
    "graham@xcite subsequently showed that , in fact , this method gave the fully rotational covariant equations , if all secular terms are renormalized and a careful choice of operator splitting is used .",
    "calculations involving the rg typically produce elegant and accurate uniformly valid approximations for ordinary differential equations ( odes ) , starting from simple perturbation series where no knowledge of the scaling present in the system is exercised@xcite . for partial differential equations ( pdes ) ,",
    "the same approach is successful , but generates a tedious number of perturbation terms at higher orders .",
    "this difficulty arises from the need to explicitly construct secular solutions of the highest possible order , at every order in @xmath4 , and from a practical standpoint equals ( if not outweighs ) the advantage of requiring no prior insight into the problem . for this reason ,",
    "calculations employing this method for pdes have rarely gone beyond @xmath6 .",
    "the key advantage of the rg method , however , is that when carefully performed , the calculation yields a rotationally covariant amplitude equation at a much lower order in @xmath4 compared to the method of multiple scales , as was shown by graham @xcite .",
    "nozaki _ et al . _",
    "@xcite , have developed a more abstract version of the perturbative rg for weakly non - linear pdes , called the `` proto - rg '' scheme .",
    "they argue that if one is willing to sacrifice some of the purely mechanical aspects of the conventional rg by taking cognizance of the system s properties , such as those exhibited by the governing differential equation , one can obtain a rotationally covariant amplitude equation to @xmath6 without having to construct any secular solutions . by computing minimal particular solutions , usually obtained by a straight - forward inspection",
    ", one can even obtain @xmath7 corrections with only a little more algebra .",
    "they illustrated the relative simplicity of this method by deriving the rotationally covariant form of the nws equation to @xmath7 , as previously derived by gunaratne _",
    "shiwa @xcite further demonstrated the efficacy of this scheme by obtaining the well - known cross - newell phase equation @xcite , which describes phase dynamics of patterns generated by the swift - hohenberg equation .",
    "a drawback of this approach is in the selection of the so called `` proto - rg '' operator , which turns out to be non - unique in general .",
    "show , however , that the operator _ is _ uniquely specified , provided we insist on the lowest order differential operator possible .",
    "as the reader will have no doubt realized from this synopsis , several methods and variants exist for deriving envelope equations from order parameter equations ( opes ) that produce predominantly periodic patterns .",
    "although one may argue that some of these methods are essentially variants of perturbative rg theory for pdes , they are structurally very different .",
    "it is thus a very instructive exercise to compare the defining properties of each of these methods in the context of a single microscopic ope .",
    "we present such a detailed study in this paper using the pfc equation , which unlike the swift - hohenberg model , has not been extensively studied .",
    "the article is organized as follows . to set the context for our work",
    ", we briefly introduce the pfc model in section [ pfc ] . in section",
    "[ qd ] we present a detailed derivation of an amplitude equation from the pfc model using a heuristic approach . in section [ prg ] ,",
    "we use the proto - rg method to derive the amplitude equation more systematically .",
    "we attempt to verify these calculations independently in section [ ms ] using the method of multiple scales .",
    "a 1-d derivation via the conventional rg method is presented for completeness in section [ rg ] .",
    "we find that while the proto - rg and rg results are consistent , they do not agree with the other calculations , due to an operator ordering ambiguity not previously noticed .",
    "we remedy this in [ modi ] , and conclude with some remarks in section [ conc ] .",
    "the phase field crystal model proposes a sixth order non - linear partial differential equation for describing the space - time evolution of the time - averaged , conserved density variable @xmath8 , of a material .",
    "as has been shown @xcite , this equation has the potential to accurately model a variety of key materials processing phenomena , including heterogeneous nucleation and grain growth , liquid phase epitaxial growth , ductile fracture mechanics , dislocation mechanics @xcite , and plasticity . an important feature which differentiates it from another popular continuum material model , the phase field model @xcite , is its incorporation of elasticity in the free energy functional through terms that guarantee gradients in the equilibrium density field , for certain values of the control parameters .",
    "crucial to the construction of this free energy , is the observation that elasticity is a natural property of a system which is characterized by periodic fields .",
    "we refer the reader to the exhaustive article by elder and grant @xcite for a detailed description of the model and its applications .    from the point of view of pattern formation theory ,",
    "the pfc equation is the conserved analog of the simplest form of the swift - hohenberg equation ( with only the cubic non - linearity ) , and is written as @xmath9+\\zeta.\\ ] ] here , @xmath4 is the scaled undercooling , a parameter akin to the modified rayleigh number , controlling the stability of the uniform phase @xmath10 ( liquid ) to the appearance of either a periodic striped phase or a periodic hexagonal phase ( both crystalline solids ) , and @xmath11 is the conserved gaussian noise which accounts for thermal fluctuations in the system . a phase - diagram illustrating the phase boundaries and coexistence curves in @xmath12 space is given in @xcite .    for present purposes we will concern ourselves only with the uniform to hexagonal phase transition ( but are not in any way restricted to it ) , and will disregard @xmath11 in view of its relative unimportance in describing phase transition kinetics . in a single mode approximation ,",
    "a hexagonal pattern is described by @xmath13 where @xmath14 , @xmath15 and @xmath16 are the reciprocal lattice vectors , @xmath17 is the wavenumber of the pattern , @xmath18 and @xmath19 are unit vectors in the @xmath20- and @xmath21-directions , @xmath22 are the complex amplitude functions , and c.  c.  denotes complex conjugate .",
    "we point out that a striped pattern , with the stripes parallel to the @xmath20 axis , can be represented by the same equation above with @xmath23 and @xmath24 . as shown in fig .",
    "[ fig : pfc ] however , the pfc equation describes the evolution of several such hexagonally patterned crystals of arbitrary orientation , that collide to form grain boundaries . while the pattern remains periodic within each crystal , there is a break in the periodicity across the boundaries .",
    "equation ( [ eqn:1mode ] ) can be made to describe such a system by allowing the @xmath22 to be spatially varying , i.  e.  @xmath25 .",
    "our goal is then to derive evolution equations for @xmath25 , which along with eq .",
    "( [ eqn:1mode ] ) can be used to reconstruct @xmath8 in a one - mode approximation .",
    "note that @xmath25 now contains information about both the envelope function ( amplitude modulus ) , as well as the orientation ( phase angle ) of each grain , but varies on a much larger length scale .    in order to proceed with our analysis ,",
    "which is essentially perturbative , we identify @xmath4 as a small parameter , in powers of which we shall expand @xmath26 about the steady state solution .",
    "we point out that the pfc model stipulates no such restrictions on the value of @xmath4 , other than @xmath27 , whereas it is natural to expect our treatment to restrict the validity of the amplitude equations so derived to small values of @xmath28 .",
    "we now present a derivation of the amplitude equation from eq .",
    "( [ eqn : pfc ] ) using linear stability analysis and a shortcut motivated by experience .",
    "an idea along these lines was previously implemented by bestehorn and haken @xcite to derive an ope ( similar to the swift - hohenberg equation ) for modeling traveling waves and pulses in two - dimensional systems , but not for deriving amplitude equations .",
    "we pose eq .",
    "( [ eqn : pfc ] ) in a more convenient form by scaling @xmath26 by @xmath29 , and calling this new variable @xmath26 . in this manner , eq . ( [ eqn : pfc ] ) becomes @xmath30 let us now consider the stability of the uniform phase solution @xmath10 to the formation of the hexagonal pattern by adding to it a small perturbation @xmath31 , so that @xmath32 . substituting in eq .",
    "( [ eqn : pfc_scaled ] ) and linearizing about @xmath10 we obtain @xmath33\\widetilde{\\psi}\\ ] ] if @xmath31 is a hexagonal instability in the form given by the spatially dependent part of eq .",
    "( [ eqn:1mode ] ) , then using @xmath34 , where @xmath35 are complex constants , and substituting in eq .",
    "( [ eqn : pfc_linearized ] ) , we obtain the discrete dispersion relation @xmath36,\\ ] ] after applying orthogonality conditions . here",
    "@xmath37 predicts the growth or decay rate of a hexagonal instability in the spatially uniform system .",
    "note that for real values of @xmath10 , @xmath37 is always real .",
    "thus , a necessary condition for the instability to grow , i.  e.  for @xmath37 to take on positive values , is @xmath38 , or equivalently @xmath39 in original variables .",
    "the most dangerous wave - number is the locus @xmath40 .",
    "we now consider spatial modulations in the amplitude about this preferred wave - number , i.  e. @xmath41 where @xmath42 is a perturbation vector , and @xmath43 is the renormalized amplitude , whose implication will be clarified in a following paragraph .",
    "consistent with eq .",
    "( [ eqn : ddr ] ) , we can now write the exponent controlling growth rate along each lattice vector as @xmath44.\\ ] ] we now replace the fourier space variables in the above equation by their real space counterparts so that , @xmath45 thus obtaining , @xmath46 ) and ( [ eqn : ddr_oper ] ) , the space - time amplitude variations along each lattice vector is given by the sixth order linear partial differential equation @xmath47    we also need nonlinear terms , which play a vital role in pattern dynamics near onset of the instability , to complement the above set of equations .",
    "there are a couple of different ways to obtain these terms .",
    "one can directly look for the nonlinear part in the normal form equations @xcite for the dynamics of @xmath22 in a hexagonal basis @xcite .",
    "these equations have been widely used to study the dynamics and stability of _ exactly _ periodic rolls and hexagonal patterns originating from the static conducting state in rayleigh - bnard convection .",
    "alternatively , one can derive these terms to a particular order in @xmath4 through a renormalization group ( or multiple scales ) analysis of the governing differential equation . here , we choose the latter approach , starting from eq .",
    "( [ eqn : pfc_scaled ] ) , but only going far enough in the rg analysis to identify the correct form of the terms .",
    "we start with a perturbation series in @xmath4 @xmath48 where @xmath49 is a steady state solution and @xmath50 are the higher order corrections .",
    "as we are interested in amplitude variations in the hexagonal pattern , we pick @xmath49 to be the steady _ hexagonal _ solution , i.  e.  eq .",
    "( [ eqn:1mode ] ) with @xmath51 replaced by @xmath52 . substituting in eq .",
    "( [ eqn : pfc_scaled ] ) , we obtain the following equation at @xmath6 : @xmath53\\psi_1 = \\left(\\partial_t - \\mathcal{l_p}\\right)\\psi_1 = \\nabla^2(\\psi_0 ^ 3- \\psi_0),\\ ] ] where @xmath54 the superscript ` * ' denotes complex conjugation . to this order ,",
    "the `` other terms '' are functions of complex exponentials that do not lie in the null space of the linear differential operator in eq .",
    "( [ eqn : prg1 ] ) , i.  e.  they are non - resonant terms .",
    "therefore , they do not contribute to unbounded growth in @xmath55 .",
    "the terms listed in eq .",
    "( [ eqn : secterms ] ) are , however , resonant with the operator , and their coefficients need to be renormalized in order to bound the solution obtained by truncating the perturbation series at @xmath6 .",
    "the renormalization procedure allows the amplitude @xmath56 , previously constant , to now have space - time variations that absorb secular divergences .",
    "we assert that the nonlinear terms in the amplitude equation to @xmath6 must be the _",
    "renormalized _ coefficients of the exponential terms in resonance with the differential operator .",
    "for example , the terms complementing the space - time operator along basis vector @xmath57 must be @xmath58 where the @xmath43 are the renormalized amplitude functions ( no longer constants ) . note that these terms are completely identical to those predicted by normal form theory for a hexagonal basis @xcite . combining eqs .",
    "( [ eqn : s - t_oper ] ) and ( [ eqn : nlnrterms ] ) we write the amplitude equation as @xmath59 for lattice vector @xmath57 , and permutations thereof for @xmath60 and @xmath61 , where we have replaced the variables @xmath43 by @xmath22 .",
    "we observe that the leading term in eq .",
    "( [ eqn : nlnrterms ] ) is consistent with the right hand side of eq .",
    "( [ eqn : s - t_oper ] ) , thereby providing a natural overlapping link about which to match the linear stability and perturbation results . in a more abstract sense",
    ", we draw a parallel between this method and the technique of matched asymptotic expansions in singular perturbation theory , where inner and outer asymptotic solutions are matched over a common region of validity in the solution space , to obtain a globally valid solution .",
    "this completes our derivation of the amplitude equation via a heuristic or `` quick and dirty '' approach . for future reference",
    ", we will call eq .",
    "( [ eqn : qdamp1 ] ) , the qdrg ( quick and dirty rg ) equation , and the method used to obtain it as the qdrg ( or heuristic ) method . as we have already demonstrated the remarkable accuracy with which the qdrg equation mimics the pfc equation in a previous article @xcite , we will refrain from presenting any new evidence to that effect here .    to summarize the procedure , we first conducted a linear stability analysis of the scaled pfc equation about the uniform state to obtain a linear differential operator controlling the space - time evolution of the complex amplitude @xmath22 of the hexagonal pattern .",
    "we superimposed on this dispersion relation periodic modulations of the amplitude , and from the dispersion relation in terms of these latter modulations , identified the gradient terms in the amplitude equation .",
    "we then carried out the first step in a conventional rg analysis to obtain the form of the nonlinear terms that should accompany this differential operator , and combining the two results , we wrote down the amplitude equation for the hexagonal pattern . in this respect ,",
    "our approach lacks the full mathematical rigor of a conventional rg reduction or a multiple scales derivation , which gives it a somewhat `` dirty '' appearance .",
    "however , we made no assumptions about the scaling of the space - time variables in the system , nor did we have to construct any secular solutions so far .",
    "we will comment on extending this method systematically to higher orders in @xmath4 in the following section .",
    "with the proto - rg method , our starting point is eq .",
    "( [ eqn : pfc_scaled ] ) with the perturbation series eq .  ( [ eqn : pseries ] ) . thus ,",
    "to @xmath6 we obtain eq .",
    "( [ eqn : prg1 ] ) , whereas to @xmath7 we get @xmath62 the structure of eq .",
    "( [ eqn : prg1 ] ) allows us to infer that its simplest particular solution will take the form @xmath63 where @xmath64 @xmath65 @xmath66 @xmath67 are non - resonant modes generated by the cubic term . note that we have explicitly denoted the space - time dependence of the secular coefficients @xmath68 , which are polynomials in @xmath20 , @xmath21 and @xmath69 , whereas by inspection ,",
    "the other coefficients @xmath70 , @xmath71 , @xmath72 , @xmath73 , @xmath74 and @xmath75 _ can _ be complex constants .",
    "specifically , @xmath76 satisfies @xmath77 @xmath78 where @xmath79 is the `` proto - rg '' operator for lattice vector @xmath80 . from the above equation it is quite obvious that @xmath76 can not be constant for any non - trivial solutions , and likewise for @xmath81 and @xmath82 .    as @xmath83 are secular , we now renormalize @xcite @xmath26 about arbitrary regularization points @xmath84 and @xmath85 , as in the conventional rg method , to get @xmath86 where @xmath43 is now the renormalized amplitude that absorbs secular divergences .",
    "since @xmath26 must be independent of these regularization points , we have @xmath87 after applying orthogonality conditions .",
    "this is the general form of the proto - rg equation for weakly nonlinear oscillators @xcite .",
    "@xmath88 is the proto - rg operator @xmath89 in eq .",
    "( [ eqn : part_prg_eps ] ) , with variables @xmath90 and @xmath69 replaced by @xmath84 and @xmath85 respectively . changing back from @xmath91 and @xmath92 , and using eqs .",
    "( [ eqn : part_prg_eps ] ) and ( [ eqn : prg_eps ] ) , we can write the amplitude equation along lattice vector @xmath57 to @xmath6 explicitly as @xmath93 with appropriate permutations for @xmath94 and @xmath95 . note that in using eq .",
    "( [ eqn : part_prg_eps ] ) , we have replaced @xmath56 by their renormalized counterparts @xmath43 as is consistent with the proto - rg procedure , before reverting to the former notation for amplitude . upon comparing the two amplitude equations obtained so far , eqs .",
    "( [ eqn : qdamp1 ] ) and ( [ eqn : full_prg_eps ] ) , we note that the qdrg derived equation carries the extra term @xmath96 .",
    "evidently , the qdrg and the proto - rg methods produce different amplitude equations when applied to the pfc equation , the extent of this difference controlled by the parameter @xmath97 .    as mentioned earlier , the principal advantage of using the proto - rg method is the relative ease with which one can progress to higher order calculations .",
    "let us now extend this calculation to @xmath7 .",
    "we need @xmath55 in order to evaluate the right hand side of eq .",
    "( [ eqn : prg2 ] ) , which means that we additionally need to evaluate @xmath70 , @xmath71 , @xmath72 , @xmath73 , @xmath74 and @xmath75 .",
    "the constant values of these terms can be determined by inspection .",
    "for example , by analogy with @xmath76 , we see that @xmath98 must satisfy @xmath99 @xmath100 unlike eq .",
    "( [ eqn : part_prg_eps ] ) however , we see that eq .",
    "( [ eqn : q1solve ] ) permits a constant solution for @xmath98 , which in turn is determined to be @xmath101 similarly , constant solutions for the other coefficients are @xmath102 we know that the particular solution to eq .",
    "( [ eqn : prg2 ] ) has the form @xmath103 where we have shown only the resonant part of the solution .",
    "the terms on the right hand side of eq .",
    "( [ eqn : prg2 ] ) , resonant with lattice vector @xmath57 , evaluate to @xmath104e^{i\\mathbf{k}_1\\cdot\\mathbf{x}}.\\end{aligned}\\ ] ] thus @xmath105 satisfies @xmath106 the non - constant terms in @xmath107 ( terms containing @xmath83 ) are now ignored @xcite while the remaining terms are determined from their constant solutions , eqs .",
    "( [ eqn : q1soln ] ) and ( [ eqn : allsolns ] ) . thus , using eq .",
    "( [ eqn : prg_eps ] ) we can write the amplitude equation along lattice vector @xmath57 to @xmath7 as @xmath108 with cyclic permutations for lattice vectors @xmath60 and @xmath61 .    we can in principle extend the qdrg method also to higher orders by performing the same steps above , until the point where we identify the resonant terms on the right hand side of eq .",
    "( [ eqn : prg2 ] ) , i.e.  @xmath107 . combining this result with eqs .",
    "( [ eqn : s - t_oper ] ) and ( [ eqn : nlnrterms ] ) we can then obtain the amplitude equation eq.([eqn : full_prg_eps2 ] ) , but with an extra term @xmath96 .    in summary",
    ", both the proto - rg and the qdrg can be calculated including terms of @xmath109 , and the results differ by a small but non - zero term . which , if any , of these calculations is correct ?",
    "and what is the origin of the discrepancy between the two methods ? is the qdrg result not to be trusted , being derived heuristically ? faced with two seemingly incompatible , although very similar results , it is natural to attempt an independent test of the analysis , which we did using the standard method of multiple scales .",
    "this calculation is presented below , but owing to technical complications arising from the interference of modes and the need to go to sixth order of perturbation theory , we found it only feasible to perform the calculation for the case of one dimension .",
    "nevertheless , we will see that , in fact , the qdrg result , eq .",
    "( [ eqn : qdamp1 ] ) , is _ more _ correct .",
    "the small discrepancy between this result and the proto - rg result is finally resolved in section [ modi ] .",
    "we now re - derive the amplitude equation using the traditional method of multiple scales .",
    "as the primary purpose of this derivation is to verify the previous calculations via an independent method , we stick to a one dimensional analysis here that considerably simplifies the algebra . for convenience",
    "we use @xmath110 , and write eq .",
    "( [ eqn : pfc_scaled ] ) in 1-d as @xmath111\\psi = \\delta^2\\partial_x^2(\\psi^3- \\psi).\\ ] ] the basic premise of the multiple scales analysis is that while the pattern itself varies on the scale of its wavelength ( @xmath112 ) , its amplitude varies on much larger length and time scales .",
    "it is then appropriate to introduce _ slowly _ varying arguments @xmath113 for the envelope function @xmath114 .",
    "this scaling was previously applied by gunaratne _",
    "@xcite to the swift - hohenberg equation with success ( based on the form of the discrete dispersion relation ) , and as the pfc equation is essentially a conserved analog of the swift - hohenberg equation we anticipate that the same scaling holds here .",
    "derivatives scale as follows @xmath115 whereas the operator @xmath116 such that @xmath117 we now expand @xmath26 in a perturbation series in @xmath118 to get @xmath119 using eq .",
    "( [ eqn : msdxdt ] ) and the above series , the @xmath118 expansion of the nonlinear term in eq .",
    "( [ eqn : pfc_scaled_1d ] ) can be written as @xmath120\\nonumber\\\\ & & + \\delta^2[\\partial_x^2(3\\psi_0\\psi_1 ^ 2 + 3\\psi_0 ^ 2\\psi_2-\\psi_2)\\nonumber\\\\ & & + 2\\partial_x\\partial_x(3\\psi_0 ^ 2\\psi_1-\\psi_1)+\\partial_x^2(\\psi_0 ^ 3-\\psi_0)]\\nonumber\\\\ & & + \\delta^3[\\partial_x^2(\\psi_1 ^ 2 + 6\\psi_0\\psi_1\\psi_2 + 3\\psi_0 ^ 2\\psi_3-\\psi_3)\\nonumber\\\\ & & + 2\\partial_x\\partial_x(3\\psi_0\\psi_1 ^ 2 + 3\\psi_0 ^ 2\\psi_2-\\psi_2)\\nonumber\\\\ & & + \\partial_x^2(3\\psi_0 ^",
    "2\\psi_1-\\psi_1)]+\\delta^4[\\partial_x^2(3\\psi_1 ^ 2\\psi_2\\nonumber\\\\ & & + 3\\psi_0\\psi_2 ^ 2 + 6\\psi_0\\psi_1\\psi_3 + 3\\psi_0 ^ 2\\psi_4-\\psi_4)\\nonumber\\\\ & & + 2\\partial_x\\partial_x(\\psi_1 ^ 2 + 6\\psi_0\\psi_1\\psi_2 + 3\\psi_0 ^ 2\\psi_3-\\psi_3)\\nonumber\\\\ & & + \\partial_x^2(3\\psi_0\\psi_1 ^ 2 + 3\\psi_0 ^ 2\\psi_2-\\psi_2)]\\nonumber\\\\ & & + \\mathcal{o}(\\delta^5).\\end{aligned}\\ ] ] substituting eq .",
    "( [ eqn : mspseries ] ) in eq .",
    "( [ eqn : pfc_scaled_1d ] ) , and using the scaled operators in eqs .",
    "( [ eqn : msdxdt]-[eqn : msoper2 ] ) , we can write equations satisfied by the @xmath121 at each @xmath122 . at @xmath123",
    "we obtain , @xmath124 where @xmath125 is the complex amplitude of mode @xmath126 at @xmath122 . at @xmath127",
    "we get @xmath128 where ( and henceforth ) we neglect the constant term in view of its inclusion in eq .",
    "( [ eqn : ms1 ] ) . at the next order",
    "we have @xmath129 for @xmath130 to remain bounded we have to guarantee that the right hand side of eq .",
    "( [ eqn : ms3 ] ) does not have a projection in the null space of @xmath131 , which yields a solvability condition @xcite ( also known as the fredholm alternative ) . applying the alternative",
    "imposes the following condition on the amplitude at @xmath132 : @xmath133 thus , @xmath134 where @xmath135 , and @xmath136 .    at subsequent orders ,",
    "the following equations are obtained for @xmath121 : @xmath137\\nonumber\\\\ \\mathcal{o}(\\delta^4 ) : \\mathcal{l}_0\\psi_4 & = & \\partial_t\\psi_2-\\mathcal{l}_1\\psi_3- \\mathcal{l}_2\\psi_2-\\mathcal{l}_3\\psi_1-\\mathcal{l}_4\\psi_0\\nonumber\\\\ & & -[\\partial_x^2(3\\psi_0\\psi_1 ^ 2 + 3\\psi_0 ^ 2\\psi_2-\\psi_2)\\nonumber\\\\ & & + 2\\partial_x\\partial_x(3\\psi_0 ^ 2\\psi_1-\\psi_1)+\\partial_x^2(\\psi_0 ^ 3-\\psi_0)]\\nonumber\\\\ \\mathcal{o}(\\delta^5 ) : \\mathcal{l}_0\\psi_5 & = & \\partial_t\\psi_3-\\mathcal{l}_1\\psi_4- \\mathcal{l}_2\\psi_3-\\mathcal{l}_3\\psi_2-\\mathcal{l}_4\\psi_1\\nonumber\\\\ & & -\\mathcal{l}_5\\psi_0-[\\partial_x^2(\\psi_1 ^ 2 + 6\\psi_0\\psi_1\\psi_2 + 3\\psi_0 ^ 2\\psi_3\\nonumber\\\\ & & -\\psi_3)+2\\partial_x\\partial_x(3\\psi_0\\psi_1 ^ 2 + 3\\psi_0 ^ 2\\psi_2-\\psi_2)\\nonumber\\\\ & & + \\partial_x^2(3\\psi_0 ^ 2\\psi_1-\\psi_1)]\\nonumber\\\\ \\mathcal{o}(\\delta^6 ) : \\mathcal{l}_0\\psi_6 & = & \\partial_t\\psi_4-\\mathcal{l}_1\\psi_5- \\mathcal{l}_2\\psi_4-\\mathcal{l}_3\\psi_3-\\mathcal{l}_4\\psi_2\\nonumber\\\\ & & -\\mathcal{l}_5\\psi_1-\\mathcal{l}_6\\psi_0-[\\partial_x^2(3\\psi_1 ^ 2\\psi_2 + 3\\psi_0\\psi_2 ^ 2\\nonumber\\\\ & & + 6\\psi_0\\psi_1\\psi_3 + 3\\psi_0 ^ 2\\psi_4-\\psi_4)+2\\partial_x\\partial_x(\\psi_1 ^ 2\\nonumber\\\\ & & + 6\\psi_0\\psi_1\\psi_2 + 3\\psi_0 ^ 2\\psi_3-\\psi_3)+\\partial_x^2(3\\psi_0\\psi_1 ^ 2\\nonumber\\\\ & & + 3\\psi_0 ^ 2\\psi_2-\\psi_2)],\\end{aligned}\\ ] ] and successive applications of the fredholm alternative yield the following amplitude equations at those respective orders , @xmath138 here , `` @xmath139 '' refers to higher order terms that are functions of @xmath140 and its derivatives .",
    "the amplitude function for the pattern ( @xmath141 ) can be written as @xmath142 using eqs .",
    "( [ eqn : msamp3 ] ) , ( [ eqn : msamp4to7 ] ) , and ( [ eqn : msamppseries ] ) , and scaling back to original variables , i.e.  @xmath143 and @xmath144 , the amplitude equation to @xmath145 can be written as @xmath146-\\delta^4(\\frac{3}{64}a|a|^4\\nonumber\\\\ & & + 2\\bar{\\psi}^2a|a|^2)+\\mathcal{o}(\\delta^6)\\end{aligned}\\ ] ] or more compactly , after replacing @xmath147 , to @xmath7 @xmath148 where @xmath149 .",
    "let us now compare eq .",
    "( [ eqn : ms1damp ] ) with the one dimensional equivalents of the @xmath6 amplitude equations that we have previously derived for hexagonal patterns , i.e.  eqs .",
    "( [ eqn : qdamp1 ] ) and ( [ eqn : full_prg_eps ] ) .",
    "without re - deriving , the one dimensional equivalents are readily obtained by setting @xmath150 in those equations .",
    "we observe that eq .",
    "( [ eqn : ms1damp ] ) ( also truncated to @xmath6 ) contains at least one term which is not present in either of the equations previously derived .",
    "we note that the qdrg result of eq .",
    "( [ eqn : qdamp1 ] ) is closer to the multiple scales result compared to the proto - rg result ( and the rg result in section [ rg ] ) , in that it fails to capture only the nonlinear derivative term at @xmath151 , which is actually a higher order correction to @xmath152 .",
    "this is clearly because the spatial operator in the qdrg method is an outcome of a _ linear _ stability analysis , whereas one would have to perform a nonlinear stability analysis to obtain nonlinear spatial derivative terms .",
    "the clear advantage of the qdrg calculation however is that it was done with significantly less effort , and in a rotationally - covariant manner ; perturbation theory to @xmath151 was all that was required .",
    "the multiple scales analysis , on the other hand , required a sixth order perturbation theory treatment , and in order to simplify the algebra , we only worked in one dimension . in higher dimensions , the interference between the modes would have created a huge increase in the complexity at each successively higher order in perturbation theory .",
    "the qdrg calculation is only heuristic , but as we will show below , can be justified from a full calculation , albeit with a minor technical modification of the previously - published recipe , to take into account the special feature of the conservation law in the pfc model .",
    "we conclude therefore that although the qdrg result of eq .",
    "( [ eqn : qdamp1 ] ) and the multiple scales method to @xmath151 still do not yield consistent results , the qdrg method is still an improvement over the proto - rg method . in order to track down the source of the discrepancy",
    ", we next attempted a full rg calculation without any shortcuts , i.e. systematically calculating explicitly and renormalizing all the divergent terms to @xmath151 .",
    "in this section , we present a derivation of the amplitude equation using the conventional rg method , in one dimension for pedagogical simplicity ( just as done for the method of multiple scales ) .",
    "the calculation is complicated because of the need to obtain explicit formulae for the secular divergences@xcite , but this is possible at the order to which we worked .    starting from eq .",
    "( [ eqn : pfc_scaled_1d ] ) ( with @xmath153 replaced by @xmath4 ) and a naive perturbation series in @xmath4 as in eq .",
    "( [ eqn : pseries ] ) the zeroth and first order solutions can be written as @xmath154 the difficulty in the conventional rg method comes from the need to explicitly determine the form of the secular coefficient @xmath155 . while this is a routine task for odes",
    ", it is far from trivial for pdes .",
    "a further complication is that the solution for @xmath155 must be the highest order polynomial that satisfies the pde , to be able to eliminate _ all _ secular divergences .",
    "it turns out that this is critical to obtaining the rotationally covariant operator at a lower order in @xmath4 . using the method of undetermined coefficients we find such a solution to be @xmath156 where @xmath157 and the constants @xmath158",
    "satisfy @xmath159 .",
    "the rg method proceeds as follows : ( 1 ) dummy variables @xmath160 and @xmath85 are introduced , ( 2 ) the divergent terms in @xmath83 of the form @xmath161 are split to read @xmath162 , ( 3 ) the constant amplitude a is redefined using an @xmath4 expansion @xmath163 , where @xmath164 is now the renormalized amplitude , and @xmath165 are the renormalization constants which are chosen order by order in @xmath4 to absorb the @xmath166 terms , and ( 4 ) since the solution @xmath26 is independent of @xmath160 and @xmath85 , all derivatives of @xmath26 with respect @xmath160 , @xmath85 , or a combination thereof must be zero .",
    "this last condition yields the following rg equations at @xmath6 , @xmath167 further , using @xmath159 and replacing @xmath168 , @xmath169 , and @xmath170 , the above equations can be combined to read @xmath171 which is also the 1-d proto - rg equation .",
    "we close this section with some interesting observations .",
    "( i ) the equations in ( [ eqn : rgeqns ] ) do not form a unique set of solvability conditions .",
    "other equations are possible , e.g. @xmath172 the choice of eqn .",
    "( [ eqn : rgeqns ] ) is motivated by the observation that it yields a rotationally covariant amplitude equation , and other physical considerations such as the microscopic equation being only first order in time .",
    "( ii ) the list of possible terms @xmath83 does not include the leading polynomial term @xmath173 , where @xmath174 is an arbitrary constant , as this term is annihilated by the kernel of the pde .",
    "thus no constraint is available to fix @xmath174 .",
    "it turns out that unless this term is also renormalized , all secular divergences are not removed .",
    "this may explain the absence of certain terms in eq .",
    "( [ eqn : rg1d ] ) that however show up in the multiple scales analysis . to be certain",
    ", the calculation needs to be carried out to higher orders ; but we do not attempt this here .",
    "in this section , we resolve the discrepancy between the answers generated by the qdrg method , the rg methods , and the method of multiple scales .",
    "curiously , no such discrepancy was observed in the treatment of the swift - hohenberg equation , a non - conservative ope , by rg methods @xcite and multiple scales techniques @xcite .",
    "in fact , it can also be readily ascertained that the qdrg method will produce the same result as the other methods for this equation , which we leave as a simple exercise for the reader .",
    "why then does a discrepancy arise in the pfc equation ?",
    "clearly , the role played by the extra laplacian , a consequence of the conservation law in this case , must be non - trivial !",
    "note that this laplacian operator carries over to the right hand side of both eq .",
    "( [ eqn : prg1 ] ) , the @xmath6 equation for the rg methods , and eq .",
    "( [ eqn : ms3 ] ) , the @xmath6 equation for multiple scales . however also note that , in the method of multiple scales , in addition to the non - linear terms , this operator is also subjected to an @xmath4 expansion .",
    "there is no provision in _ any _ of the rg methods to allow the same to happen to the laplacian . in other words ,",
    "the operator may very well have not existed on the right hand side at @xmath6 , and we would have obtained exactly the same result as before !    a clue to the subtlety is to look at the way in which the secular terms are renormalized . the naive way , as followed here , would be to evaluate the right hand side first , look for secular terms later , and then renormalize these divergent coefficients .",
    "however , this will not eliminate secular terms generated by the differential operator . in order to eliminate _ all _ secular terms",
    ", the amplitude must be renormalized _ before _ differentiation , for the simple reason that renormalization and differentiation are non - commutable operations . in other words , there is an operator ordering ambiguity in the implementation of the renormalization group method , exposed in this problem by the conservation law .",
    "performing the calculation with the operations of renormalization and differentiation reversed is equivalent to performing an @xmath4 expansion in the differential operator .",
    "we find that by following this procedure , additional terms in the coefficients of the resonant modes are automatically generated .",
    "specifically , when we evaluate the right hand side of eq .",
    "( [ eqn : prg1 ] ) after assuming the amplitudes of @xmath49 to have a space - time dependence , the renormalized coefficients of the resonant @xmath175 forcing term work out to be @xmath176,\\end{aligned}\\ ] ] which when specialized for the 1-d case becomes @xmath177\\nonumber\\\\ & = & \\epsilon[(1 - 3\\bar{\\psi}^2)a-3a|a|^2-(1 - 3\\bar{\\psi}^2)\\mathcal{l}_{1d}a\\nonumber\\\\ & & + 3\\mathcal{l}_{1d}(a|a|^2)].\\end{aligned}\\ ] ] we note that the above terms are identical to the @xmath6 terms on the right hand side of eq .",
    "( [ eqn : ms1damp ] ) .",
    "therefore the correct amplitude equation to @xmath6 should contain all the terms in eq .",
    "( [ eqn : nlnrcorr ] ) . in order to illustrate the generality of this approach",
    ", we apply this idea again in the appendix to the van der pol oscillator , another equation for which the previously reported implementation of the rg method , and the method of multiple scales produce different answers .",
    "we wish to point out that the assumption of a constant amplitude in the @xmath49 solution makes it possible for the coefficients of the non - resonant terms in @xmath55 to assume constant values , a fact that is favorably used in extending the proto - rg calculation to the next order .",
    "however , with our modification to the proto - rg procedure , it is clear that for the pfc equation at least , non - resonant coefficients can not have constant values . thus computing higher order corrections to the amplitude equations ,",
    "will require explicit construction of particular solutions , which may limit progress beyond @xmath6 by purely analytical methods .",
    "we have presented a detailed illustration of various perturbative techniques to derive amplitude equations from order parameter equations that produce periodic patterns .",
    "amplitude equations serve as powerful analytical tools with which to investigate pattern stability and defect interactions , as well as accurate coarse - grained descriptions of pattern forming systems , and this calls for practical and reliable mathematical methods for deriving them .    although our benchmark for accuracy is the widely - accepted method of multiple scales , it is critical to note that this method is not failsafe , because it requires _ a priori _ identification of the way in which space and time scale with the small parameter @xmath4 .",
    "there are many instances where surprising scales emerge that would not easily be identified _ a priori _ ( e.g. see the analysis of the mathieu equation in @xcite ) .",
    "the method of multiple scales typically involves a very lengthy calculation before a rotationally covariant operator ensues , and involves computation of various higher order terms which ultimately do not improve the overall result significantly . in the example presented here , a sixth order calculation was required to get the lowest order amplitude equation .",
    "the reader should bear in mind that the fairly involved calculation shown in this article was only one dimensional .    on the other hand ,",
    "the practicality of rg based methods , where the amplitude equation was obtained very quickly at @xmath6 itself , is self - evident .",
    "no guesswork was required to determine the scaling of the variables and all calculations started with naive perturbation expansions in @xmath4 .",
    "in particular , our so called `` quick and dirty '' ( qdrg ) method and the proto - rg method are attractive techniques , because there is virtually no need to construct explicit solutions .",
    "both methods use only information available from the differential equation and in that sense , are very general ways of building a controlled coarse - grained approximation to the order parameter equation being studied .",
    "furthermore , the qdrg method gives the correct result quickly , apart from a small non - linear rotationally covariant gradient term which is not captured by the linear stability argument .    at @xmath6 , we have shown that the qdrg method produces a more accurate amplitude equation compared to the proto - rg method , by capturing certain extra terms that are revealed in the multiple scales analysis .",
    "however , with our corrected order of operators in the way in which the rg is implemented , we find that all methods converge identically at this order .",
    "in conclusion , we have presented a detailed calculation of the coarse - graining of the phase field crystal equation , for small @xmath4 .",
    "elsewhere @xcite , we have demonstrated the utility of the coarse - grained equation in performing large - scale simulations of materials processing phenomena in two dimensions .",
    "further developments of these techniques are underway , implementing adaptive mesh refinement to solve the amplitude equations obtained here in two and three dimensions , and going beyond the single mode approximation which has formed the basis of our work and that of elder and collaborators .",
    "we hope to report on these developments at a future date .",
    "this work was partially supported by the national science foundation through grant number nsf - dmr-01 - 21695 .",
    "the authors would like to thank prof .",
    "sasha golovin for useful discussions and bringing reference @xcite to our attention .",
    "in this appendix , we explore the commuting of differentiation and renormalization with a simple ordinary differential equation example : the van der pol oscillator . note that this yet another case in which a differential operator is multiplied by a small parameter ( see right hand side of eq.([eqn : vpol ] ) ) .",
    "the autonomous ode is given by @xmath178 where @xmath179 denotes differentiation with respect to the variable @xmath69 .",
    "as there is a derivative on the right hand side of this equation we anticipate that the proto - rg amplitude equation will fail to capture certain terms that turn out in the multiple scales analysis .",
    "it is known that the scaling @xmath180 works for this problem @xcite .",
    "hence , @xmath181 where the subscripts denote partial differentiation .",
    "expanding @xmath21 in a perturbation series @xmath182 we obtain @xmath183 from this we find @xmath184 application of the fredholm alternative at @xmath6 and @xmath7 yields the following amplitude equations @xmath185 which can be combined after scaling back to original variables to get @xmath186 + \\mathcal{o}(\\epsilon^2).\\ ] ]    nozaki and oono @xcite on the other hand have obtained the following equation using the proto - rg method @xmath187 note that the missing term @xmath188 can be captured by differentiating the lower order result , i.  e. @xmath189 but this does not seem a very general approach . in particular , it is not obvious how this can be extended to pdes .",
    "the @xmath6 equation using the proto - rg method reads @xmath190 where @xmath191 where @xmath192 can be a constant while @xmath193 can not .",
    "thus , the proto - rg operator turns out to be @xmath194 and the proto - rg equation reads @xmath195 where a is now the renormalized amplitude . when evaluating @xmath196 however , we allow for the possibility that @xmath192 , which appears on the right hand side of the equation can also be a function of @xmath69 , or equivalently renormalize @xmath192 on the right hand side before differentiating @xmath197 , which gives us @xmath198.\\ ] ] therefore the true amplitude equation should read ( using eq .  [",
    "eqn : app_prg ] ) @xmath199 + \\mathcal{o}(\\epsilon^2),\\ ] ] which is identical to the multiple scales result of eq .",
    "( [ eqn : appms ] ) ."
  ],
  "abstract_text": [
    "<S> we derive a set of rotationally covariant amplitude equations for use in multiscale simulation of the two dimensional phase field crystal ( pfc ) model by a variety of renormalization group ( rg ) methods . </S>",
    "<S> we show that the presence of a conservation law introduces an ambiguity in operator ordering in the rg procedure , which we show how to resolve . </S>",
    "<S> we compare our analysis with standard multiple scales techniques , where identical results can be obtained with greater labor , by going to sixth order in perturbation theory , and by assuming the correct scaling of space and time . </S>"
  ]
}