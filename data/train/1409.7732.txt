{
  "article_text": [
    "quantum mechanical systems can give rise to measurement correlations that local realistic ( lr ) systems are unable to produce .",
    "physical theories that satisfy the principle of local realism ( lr ) posit a set of hidden variables associated with the physical systems .",
    "the hidden variables can not be influenced by spacelike - separated events .",
    "they are not observable , but they determine the outcomes of all measurements .",
    "the existence of hidden variables constrains the probability distributions that can describe lr systems . in 1964 bell",
    "constructed an inequality that is satisfied by all correlations accessible by lr and showed that correlations between spacelike - separated measurements on two quantum systems can violate this inequality  @xcite .",
    "the realization that quantum mechanics allows more general probability distributions than lr has motivated many experimental tests that have shown bell - inequality violations ( see ref .",
    "@xcite for a review ) .",
    "in addition to the fundamental importance of tests of lr , systems violating lr can be used for quantum information tasks such as quantum key distribution  @xcite and secure randomness generation  @xcite . for these cryptographic applications",
    ", one must demonstrate violation of lr with high statistical significance in the presence of adversarial effects , such as a hacker who has tampered with the system in an attempt to learn a secret key .",
    "so far , all tests of lr have invoked additional assumptions about the types of lr theories governing their experiments .",
    "examples include the assumption that photon detection probabilities are not correlated with the measurement choices or photon polarizations ( the `` fair sampling '' assumption ) , the assumption that measurement choices at one location can not influence events at another location even when they are not spacelike separated , and the assumption that the sequence of measurement choices and outcomes in an experiment are independent and identically distributed ( i.i.d . ) . for a review see @xcite .",
    "various experiments have been able to relax some of these assumptions , but no single experiment has been able to reject the most general lr theories . due to recent advances in entangled photon generation and photon detection , we anticipate that an optical experiment that is free of additional assumptions will be accomplished in the near future .    to test a bell inequality in an experiment , one repeats the preparation and joint measurement of spatially separated systems some finite number @xmath0 times .",
    "we call each such repetition a `` trial '' of the experiment . during a trial , entangled systems",
    "are sent to two or more measurement locations . at each location ,",
    "a random choice is made that determines which property will be measured . ideally , each trial is clearly identifiable so that measurement choices and outcomes at the various locations can be matched with one another .",
    "however , in many experiments this trial identification can not be achieved with perfect certainty .",
    "a popular experiment design involves the continuous pumping of a nonlinear crystal that produces photon pairs through spontaneous parametric down - conversion . in these experiments",
    ", the entangled pairs are produced randomly in time .",
    "furthermore , the detectors used at the two measurement locations ( `` alice '' and `` bob '' ) have nonzero timing jitter .",
    "these effects can create confusion about which events at alice correspond to which events at bob .    to resolve this confusion",
    "one typically defines a `` coincidence window '' in time , so that if the period of time between photon detections at alice and bob is less than the coincidence window width , the two events are considered to be part of the same trial .",
    "if alice or bob observe multiple detections within one coincidence window , more sophisticated algorithms can be used to attempt to match alice s and bob s detections .",
    "the choice of the coincidence window width depends on balancing the expected inter - arrival time between entangled pair creations and the detector timing jitter , so that the probability for a trial to contain multiple photon pairs is small , and the probability for a photon to be lost by falling outside of the coincidence window is also small .",
    "unfortunately , local realistic theories or hackers can use this uncertainty about trial identification to produce apparent violation of bell inequalities .",
    "the photons being measured could have correlations between their measurement outcomes and arrival times .",
    "correlations could also exist between multiple photon pairs detected during the same coincidence window .",
    "previous tests of lr that use continuously pumped spontaneous parametric down - conversion have ( often implicitly ) assumed that such correlations do not exist .",
    "therefore these experiments do not reject the most general lr theories ; they only reject lr theories that do not allow timing or cross - pair correlations .",
    "experiments requiring these assumptions are said to suffer from the `` coincidence loophole '' .",
    "larsson and gill described local realistic theories that exploit the coincidence loophole and methods to defeat them in  @xcite .",
    "their closure of this loophole requires a bound on the probability that a true coincidence is missed .",
    "this bound can not be measured without additional assumptions and must be trusted .    in this paper",
    "we describe a different method for closing the coincidence loophole that does not require additional assumptions about the systems being measured . instead , we define a `` trial '' as all events occurring within a predetermined time interval .",
    "the data produced by the trial are the measurement choices at alice and bob and the lists of times at which alice and bob detected photons ( the `` timetags '' ) .",
    "the trial may be many times longer than the expected time between photon pair creations , and alice and bob may observe many photon detection events during one trial .",
    "( in practice the length of a trial will be constrained if one desires to achieve spacelike separation between measurement choices on one side and detections on the other . )    to test lr with such trial data , we develop distance - based bell inequalities . signed , directed distances between trial outcomes that measure the dissimilarity between alice s and bob s lists of timetags are defined such that they obey a directed triangle inequality .",
    "these distances are closely related to edit distances used to compare words in spell checking or to align dna sequences in computational biology . using lr to compute the expectation value of sums of these distances yields an inequality satisfied by all lr theories .",
    "these distance - based bell inequalities provide a rigorous analysis of tests of lr based on continuously emitting sources ; they enable the rejection of a larger class of lr theories than previously known methods .",
    "also , the triangle inequality can be a powerful tool for finding new bell inequalities in other contexts .",
    "for example , see the works of dzhafarov and kujala  @xcite and of kurzynski and kaslikowsi  @xcite .    in sect .",
    "[ sec : preliminaries ] we introduce basic notions and define relevant mathematical notation . in sect .",
    "[ sec : tt_bell_tests ] we explain the experimental setup of `` timetag bell tests '' in more detail and describe a simple lr model that exploits the coincidence loophole for an apparent violation of a bell inequality . in sect .",
    "[ sec : distance ] we define `` distance '' functions between measurement outcomes that obey the directed triangle inequality .",
    "we then use the triangle inequality to derive bell inequalities satisfied by any lr theory regardless of the choice of distance function . in sect .",
    "[ sec : belltimetagseq ] we describe functions for computing the distance between timetag sequences and obtain the associated bell inequalities . in sect .",
    "[ sec : nosigadj ] we introduce non - signaling equalities that constrain all theories that prohibit alice from sending information to bob by use of her measurement choice ( and vice - versa ) .",
    "although both quantum and lr theories obey the non - signaling equalities , these equalities can be used to transform bell inequalities and improve the signal - to - noise ratio ( snr ) of the inequalities violation in an experiment . in sect .",
    "[ sec : analysis_protocol ] we provide a protocol that sets aside an initial segment of the data as a training set to determine a good distance function . in sect .",
    "[ sec : pbr ] we discuss the relationship between the snr for the violation of a bell inequality and @xmath1-value bounds for rejecting lr .",
    "bounds on @xmath1-values can be computed with gill s martingale - based protocol  @xcite or the prediction - based ratio ( pbr ) protocol  @xcite .",
    "the main result of this section is a method for truncating distance functions to enable application of these protocols .",
    "the technique is general and can be used on any bell function derived from a triangle inequality . here",
    ", a useful step is to balance the violation between the measurement settings by means of the non - signaling equalities . in sect .  [",
    "sec : sim ] we apply timetag bell inequalities to simulated data .",
    "we discuss the effects of detector inefficiency and detector jitter on the violation of timetag bell inequalities and on the @xmath1-value bounds computed with the pbr protocol .",
    "we quantify the violation and @xmath1-value bounds as functions of the jitter distribution s width and quote lower bounds on the maximum jitter width at which violation can be observed for photon detection efficiencies ranging from @xmath2 to @xmath3 .",
    "the simulations include an lr model that exploits the coincidence loophole while closely mimicking the measurement statistics of a poisson source of entangled photons measured with jittery detectors . in the appendix",
    "we describe numerical methods to optimize parameters of the distance functions to give high inequality violation , to compute distances for timetag bell inequalities , and to compute the snr of the violation of an inequality .",
    "the appendix also contains further details of the coincidence - loophole - exploiting lr model .",
    "we consider experiments to test lr , where an experiment consists of a sequence of trials .",
    "the trials measurement outcomes need not be independent from one trial to the next , but before the next trial , there is a probabilistic description of the next trial s outcome , where the probabilities may depend on the past and current conditions .",
    "the class of lr models of interest is defined by specifying constraints on these probabilities .",
    "we consider the case where a trial consists of observations by two parties , @xmath4 and @xmath5 , each of whom can choose one of two measurement settings for their observation .",
    "we leave extensions to more parties and settings for future work .",
    "the full trial outcome includes the settings chosen as well as the measurement outcomes . in many cases ,",
    "the measurement outcomes are two - valued .",
    "for example , the outcome may indicate whether a photodetector `` clicked '' or not .",
    "here we consider arbitrary outcome spaces , but focus on the case where a party s measurement outcome is an ordered sequence of timetags of events , for example detection events .",
    "thus , there is no bound on the size of the outcome space    we denote the random variable for a trial s outcome including the settings by @xmath6 .",
    "this random variable is a tuple of four random variables @xmath7 where @xmath8 is @xmath9 s measurement outcome and @xmath10 is @xmath9 s chosen setting .",
    "the two possible settings are denoted by @xmath11 and @xmath12 .",
    "we also use the notation @xmath13 .",
    "we follow the notational convention that random variables ( @xmath14 ) are denoted by roman upper case letters .",
    "this is also true of party labels , but the distinction should be clear from context .",
    "the range of random variable @xmath15 is denoted by @xmath16 . observed values of random variables",
    "are denoted by their corresponding lower - case letters ; for example , @xmath17 denotes an observed value of @xmath15 .",
    "superscripts and subscripts serve to identify members of a family of conceptually related random variables or to select out parts of tuple - valued random variables . formally , the random variables for a trial are functions on an underlying probability space that includes any `` hidden '' variables that may play a role , but we do not need to explicitly refer to this space here .    a deterministic lr model must , before a trial and independent of the settings , commit to a specific measurement outcome @xmath18 for each party @xmath19 and each setting @xmath20 . a general lr model is a probabilistic mixture of deterministic models .",
    "( one can imagine that a hidden random variable selects which deterministic model controls a trial s measurement outcomes . )",
    "thus , an lr model is described by a random variable @xmath21 , where @xmath6 relates to @xmath22 according to @xmath23 . although the parties can not simultaneously measure both settings",
    "@xmath24 and @xmath25 in a single trial , the lr model allows for that possibility by pre - assigning measurement outcomes to both settings . that such a pre - assignment exists is the essential claim of realism .",
    "quantum theory does not pre - assign outcomes and disallows the possibility that the two settings can be measured simultaneously .",
    "quantum theory can thereby achieve a larger set of trial probability distributions .    in an idealized test of lr ,",
    "the settings choices are made randomly and independently of @xmath22 according to a probability distribution that is under experimenter control . in this case ,",
    "lr models satisfy that @xmath26 is independent of @xmath27 , and the probability distribution of @xmath28 is known before the trial .",
    "this defines lr models satisfying the free choice assumption . for the remainder of the paper , lr models",
    "are assumed to satisfy free choice , and by default the settings distribution is uniform .    from a mathematical and statistical point of view , a successful test of lr shows that probabilistic lr models are statistically inconsistent with the data .",
    "interpretation of the inconsistency requires additional analysis and can depend on the experimental context .",
    "in fact such interpretations could attribute the inconsistency to the presence of so - called `` loopholes '' rather than to the falsity of lr .",
    "an experimental goal is to convincingly exclude the presence of such loopholes .",
    "a common method for performing bell tests is to use a source that continuously emits pairs of polarization entangled photons .",
    "the photons are delivered to two measurement setups .",
    "a trial consists of choosing the settings and then recording photodetection events for a fixed observation window .",
    "we focus on the simplest case , where the measurement setups involve polarizers whose angles determine the settings .",
    "each setup has one photodetector that records photons that passed through the polarizer .",
    "thus , the record of a trial includes two timetag sequences recording the times at which photons were detected .",
    "the experiments reported in  @xcite used this setup .    one way to think about such an experiment is that fundamentally , each photon pair s emission and detection constitutes a trial . in this case , the first step in an analysis is to identify the detection pattern for each emitted pair .",
    "the record does not identify when neither photon was detected , but the bell inequalities used can be chosen so that the total bell - inequality violation is insensitive to the number of photon - pair trials where neither photon was detected .",
    "thus , the analysis requires identifying coincidences , that is , pairs of detections that are due to one photon pair .",
    "identifying coincidences is complicated by the fact that the recorded timetags have `` jitter '' , that is , the difference between the timetag @xmath29 and the `` true '' time of arrival of a photon @xmath30 is a random variable with non - negligible width @xmath31 ( to be defined in sect .",
    "[ sec : sim ] for specific jitter distributions ) .",
    "furthermore , since photon pairs are continuously emitted , their creation times and their times of arrival are also random .",
    "pair emission can usually be modeled as a poisson process .",
    "denote the mean inter - arrival time between successive photon pairs as @xmath32 .",
    "it is necessary to determine which pairs of close timetags @xmath29 and @xmath17 of @xmath4 and @xmath5 are due to the same photon pair .",
    "this can not be done without error , as there is always the possibility that photons detected by @xmath4 and @xmath5 around the same time are from two different photon pairs that were created with small time separation .",
    "the probability of this event grows with @xmath33 .",
    "given that coincidences can not be identified exactly , it is necessary to determine how this affects the interpretation of a bell - inequality violation . in cases where the nominal mean violation per photon pair is small and @xmath33 is relatively large , the evidence against lr may be weakened substantially .",
    "an example of this situation is the experiment reported in ref .",
    "@xcite , which aimed to close the fair sampling loophole with photons .",
    "the violation was limited by the overall detection efficiency realized in the experiment . to interpret the violation",
    ", one can analyze the effects of coincidence identification error by making the assumptions that the source is idealized poisson , the jitter is settings independent , the photon pairs states are identical and independent , and the method for recording detections is memoryless .",
    "parts of such an analysis are in  @xcite .",
    "but these are highly idealizing assumptions unlikely to be satisfied in a real experiment . relying on them",
    "precludes making strong claims on having demonstrated non - lr effects .",
    "of particular concern is that the presence of jitter in combination with a conventional coincidence analysis requires a fair coincidence sampling assumption  @xcite . for conventional analyses ,",
    "this assumption can be avoided by using `` pulsed '' trials , which can significantly reduce the rate of detections .",
    "such an experiment was reported in ref .",
    "@xcite .",
    "unfair coincidence sampling can arise from local , settings - dependent properties of the detectors , including the associated settings - related apparatus such as polarization filters . a simple lr model that exploits unfair coincidence sampling to show violation of a bell inequality is illustrated in fig .  [ fig : coincidence_loophole ] .",
    "suppose that for @xmath4 , the difference @xmath34 between the recorded timetag and the photon arrival time is @xmath35 on setting @xmath24 and @xmath36 on setting @xmath25 .",
    "for @xmath5 , suppose that the difference is @xmath35 on setting @xmath24 and @xmath37 on setting @xmath25 . to identify coincidences , one can choose a coincidence window width @xmath38 and declare that timetags of @xmath4 and @xmath5 whose separation is less than @xmath38 are coincident .",
    "it is necessary to have a method for resolving coincidence conflicts such as when a timetag of @xmath4 is within @xmath38 of more than one timetag of @xmath5 .",
    "here we just assume that @xmath33 is small enough for this not to be considered an issue .",
    "suppose that the coincidence window width is chosen to be @xmath39 . if the lr model for the photon pair is to `` detect '' no matter what the setting is , then @xmath4 and @xmath5 record coincidences on all settings except @xmath40 , where the two detections are inferred as being non - coincidence detections .",
    "this lr model strongly violates commonly used bell inequalities , such as the one introduced in sect .",
    "[ sec : distance ] , eq .",
    ", whose violation is increased by anticorrelation between @xmath4 s and @xmath5 s detections on the @xmath40 setting .",
    "the choice of @xmath38 may seem arbitrary , but a natural way to choose @xmath38 is to optimize the violation on a training set or on preliminary data . in this case",
    ", @xmath39 is an optimal choice .",
    "note that locality assumptions and the assumption that settings - choices are uniformly random and independent of hidden variables affecting the measurement outcomes are satisfied in this example .",
    "illustration of an lr model that uses setting dependent detection times to violate a bell inequality .",
    "detection time @xmath34 proceeds along the horizontal axis .",
    "each row above the time axis corresponds to one measurement setting combination used by @xmath4 and @xmath5 .",
    "photons are detected by @xmath4 and @xmath5 at the times labeled `` a '' and `` b '' .",
    "( at the @xmath41 setting , both @xmath4 and @xmath5 detect their respective photons near @xmath35 . )",
    "the shaded regions indicate coincidence windows of width @xmath42 . at the @xmath40 setting ,",
    "the photons detection times are separated by @xmath43 , so @xmath4 and @xmath5 can never observe coincidences with @xmath40.,width=288 ]    a detailed theoretical treatment of unfair coincidence sampling is given in ref .",
    "@xcite , including a more sophisticated example that can respond to the continuous angular settings choices available when measuring photons .",
    "given the assumptions in ref .",
    "@xcite , there are valid adjustments to a bell inequality based on knowledge of the probability of missing a coincidence .",
    "our approach based on timetag bell inequalities does not require such additional knowledge .",
    "it may seem like the presence of unfair coincidence sampling due to a dependence of detector timing on settings can be excluded by checking that there is no widening of the time - separation distribution of the nearest timetags of @xmath4 and @xmath5 for the @xmath40 settings compared to the others .",
    "further , one can attempt to choose @xmath38 after studying this distribution to ensure that the fraction of missed coincidences for the @xmath40 setting is sufficiently small .",
    "any such attempt would require an hypothesis test ( or some other way to quantify evidence ) for the claim that no unfair coincidence sampling is present in the experiment .",
    "depending on how the data for these tests is acquired , additional assumptions on consistency of detector behavior may be needed . in pursuing this approach ,",
    "one must then decide at what significance level one wishes to exclude excessive unfair coincidence sampling .",
    "this significance level should be similar to the claimed significance of the violation .",
    "this may not be feasible in an experiment without greatly weakening the significance of the result .",
    "coincidence sampling effects can also be exploited directly by an lr source .",
    "the simplest example just simulates the detector timing issue .",
    "there are two operationally different versions of this example . in the first",
    ", the local hidden variable of a photon also identifies the time at which the detector records it in a setting - dependent way .",
    "one could imagine that once the photon arrives at the detector and senses the setting , it `` pauses '' a variable amount of time .",
    "it now suffices to emit photon pairs where photon @xmath4 s local variable assigns `` detect '' at time @xmath29 on setting @xmath24 and `` detect '' at time @xmath44 on setting @xmath25 , whereas photon @xmath5 s variable assigns `` detect '' at time @xmath29 on setting @xmath24 and `` detect '' at time @xmath45 on setting @xmath25 .",
    "such photons seem impossible to realize , but the following version of the example may be realizable .",
    "the source sends a photon to @xmath5 at time @xmath45 , a pair to @xmath4 and @xmath5 at time @xmath29 , and another to @xmath4 at time @xmath44 .",
    "the first photon is prepared so as to be detected by @xmath5 only on setting @xmath25 .",
    "the two middle photons are detected only on setting @xmath24 .",
    "the last photon is prepared so as to be detected by @xmath4 only on setting @xmath25 .",
    "when @xmath4 and @xmath5 compare their timetags and use @xmath39 for their coincidence analysis , they again see coincidences on all settings except for @xmath40 .",
    "an lr source that wishes to hide having manipulated emission times can intersperse a small number of photons with the emission pattern above with regular lr pairs of photons that ensure equality for the bell inequality of interest . other opportunities to hide the presence of unfair coincidence sampling from the experimenters exist . the lr source can systematically introduce lr photons with varying timing features , and it can conditionally omit `` normal '' photon pairs to make it more difficult to see excess numbers of close detections outside the coincidence window .",
    "while these possibilities may seem physically unrealistic , they are of concern in cryptographic applications of experimental configurations for violating bell inequalities . to show that these concerns are justified , in sect .",
    "[ sec : sim ] we show simulation results for an lr source whose statistics would be difficult to distinguish from a quantum source in an experimental setting .",
    "the conventional coincidence analysis shows a false violation of a bell inequality for this source .",
    "distance - based bell functions and associated bell inequalities generalize the conventional two - party , two - setting bell inequalities such as the chsh  @xcite and ch inequalities  @xcite ( the abbreviations stand for the authors initials ) .",
    "consider two parties @xmath4 and @xmath5 , where each can choose from two settings labeled @xmath11 and @xmath12 and the physical meaning of the setting labels depends on the party .",
    "suppose that the measurement outcomes at a given setting are @xmath46 or @xmath47 .",
    "let @xmath8 and @xmath10 be the measurement outcome and setting of party @xmath9 , respectively .",
    "one of the chsh inequalities for this configuration is @xmath48 where @xmath49 denotes the expectation of @xmath50 .",
    "this inequality is satisfied by all lr models .",
    "let @xmath51 . since @xmath52 , eq .   can be rewritten as @xmath53 a deterministic lr model assigns a specific value @xmath54 for the measurement outcome of each party @xmath9 and setting @xmath55 before the experiment . in this case , the left - hand side of eq .",
    "is given by @xmath56 .",
    "this is at least @xmath35 because @xmath57 satisfies the triangle inequality as illustrated in fig .",
    "[ fig : iterated_triangle ] . the inequality of eq .",
    "follows because general lr models are probabilistic mixtures of deterministic ones .",
    "we have switched the @xmath4 and @xmath5 arguments of @xmath57 in the contribution for the @xmath41 setting in preparation for applying asymmetric functions @xmath57 .",
    "illustration of the twice - iterated triangle inequality .",
    "each node represents one of the four potential measurement outcomes in @xmath58 , and each directed edge represents one of the lengths @xmath57 in eq .",
    "[ eq : iterated_triangle ] .",
    "the edges on the path correspond to `` compatible '' measurements pairs that are experimentally measured .",
    "the locations of the nodes are arbitrary in this illustration.,width=288 ]    the bell inequalities of eq .   and   are expressed in terms of quantities that are conditional on settings . since measurement settings need to be chosen randomly , experimentally estimating these quantities requires dividing by the actual number of times",
    "the relevant settings are chosen .",
    "this complicates the estimation of experimental uncertainty . to avoid this complication ,",
    "recall that the probability distribution of the settings is known beforehand and is independent of the lr model .",
    "let @xmath59 be the probability that @xmath4 and @xmath5 choose settings @xmath60 and @xmath61 , respectively . then the left - hand side of eq .",
    "is equal to @xmath62}l(o^a , o^b)/p_{s^as^b}\\right\\rangle , \\label{eq : function_chsh2}\\ ] ] where the expression @xmath63 $ ] in the exponent of @xmath46 evaluates to @xmath47 when the logical formula @xmath64 is true and to @xmath35 when it is false .",
    "eq .   is the expectation of a function of the settings and measurement outcomes .",
    "this function is the bell function for the inequality of eq .  .",
    "for our default assumption of a uniform settings probability distribution , @xmath65 .    in general , we define a bell function to be a function of trial outcomes whose expectation with respect to every lr model is non - negative , where the probability distribution of the settings is fixed .",
    "we now obtain such bell functions from functions @xmath66 that satisfy the twice - iterated triangle inequality @xmath67 , where @xmath68 is a common measurement outcome space for all parties and settings . unlike a true distance , we do not require @xmath57 to be non - negative or symmetric . consider a deterministic lr model given as above by its outcome assignments @xmath69 .",
    "the elements of @xmath58 obey the inequality @xmath70 obtained by arranging the twice - iterated triangle inequality as illustrated in fig .",
    "[ fig : iterated_triangle ] .",
    "the reversal of the parties in the term @xmath71 ( the middle edge of the indirect path ) requires argument reversals in the expressions below .",
    "we can define a bell function based on @xmath57 as follows : @xmath72 where @xmath73 is a trial outcome .",
    "the factor of @xmath74 originates as the inverse of the probability @xmath75 of each of the settings .",
    "consider an lr model with measurement outcome random variables @xmath76 . in the trial outcome random variable @xmath6 , @xmath77 and @xmath78 .",
    "because the settings are independent of the @xmath76 , the expectation of @xmath79 can be computed as @xmath80 where the factors of @xmath74 were canceled by the probabilities of the settings .",
    "the inequality can be checked directly for deterministic lr models , by replacing the random variable @xmath76 with the constant @xmath54 . for general lr models both sides",
    "can be integrated with respect to the appropriate distributions over deterministic lr models .",
    "for a general settings distribution , the values of @xmath57 in eq .",
    "are multiplied by the inverse of the applicable settings probability so that the expression for the expectation in eq .",
    "is unchanged .",
    "eq .   is the bell inequality associated with the bell function @xmath79 . to test it in an experiment involving a sequence @xmath81 of trial outcomes ,",
    "one computes the values @xmath82 on the actual trial outcomes @xmath83 .",
    "the sum @xmath84 is then an estimate of @xmath85 , that can be compared to @xmath35 .",
    "the test is considered successful if @xmath86 , and the difference betwen @xmath87 and @xmath35 is statistically significant . according to the conventional approach ,",
    "this involves determining an uncertainty for @xmath87 .",
    "see appendix .",
    "[ sect : nomsnr ] for an effective method for obtaining such an uncertainty that takes into account the known probability distribution of the settings .",
    "while this prescription is seemingly straightforward , care must be taken when interpreting the results for trials that may not be identical and independent  @xcite .",
    "statements on the strength of evidence against lr require additional analysis based on statistical hypothesis testing , see sect .",
    "[ sec : pbr ] .    for our applications to timetag sequences , we further generalize the bell functions by allowing @xmath57 to depend on the settings . consider functions @xmath88 of two measurement outcomes that satisfy the following version of the iterated triangle inequality : @xmath89 we call such an @xmath57 a @xmath90 function .",
    "for the first and shorter expression in the next definition , we use the notation @xmath91 and @xmath92 for @xmath93 .",
    "a bell function @xmath79 can now be defined by generalizing eq .   according to @xmath94 }",
    "\\tilde l_{s^{a}s^{b}}(o^{a},o^{b})\\nonumber\\\\\\nonumber\\\\   & = & \\left\\ {    \\begin{array}{ll }       4l_{s^as^b}(o^b , o^a ) & \\mbox{if $ s^a=\\bar 1 $ and $ s^b=\\bar",
    "1$,}\\\\       4l_{s^as^b}(o^a , o^b ) & \\mbox{if",
    "$ s^a\\not = s^b$,}\\\\       -4l_{s^as^b}(o^a , o^b ) & \\mbox{if $ s^a=\\bar 2 $ and $ s^b=\\bar 2$. }    \\end{array}\\right .",
    "\\label{eq : chbelldef2}\\end{aligned}\\ ] ] we call @xmath79 a @xmath90 bell function .",
    "it satisfies eq .   after adding the appropriate indices to the occurrences of @xmath57",
    "we remark that every bell function for a two - party , two - settings configuration can be put in the form of a @xmath90 bell function for some choice of @xmath90 function @xmath57 .",
    "thus many of the techniques discussed in the remainder of the paper are generally applicable .",
    "consider an arbitrary bell function @xmath95 standardized as above so that @xmath96 for the settings probability distribution @xmath59 .",
    "we can define @xmath97 since there are no constraints on the measurement outcomes in deterministic @xmath98 models , the bell inequality implies the iterated triangle inequality of eq .  . to show this ,",
    "fix the lr model so that it is deterministic according to @xmath58 , where @xmath58 is arbitrary",
    ". then @xmath99",
    "for our construction of @xmath90 functions for general timetag sequences , we require functions @xmath88 whose domains are two lists of real numbers representing the timetag sequences at settings @xmath100 , whose ranges are the real numbers , and that satisfy the iterated triangle inequality . our general strategy is to construct @xmath88 so that it computes a quantity similar to an edit distance , which quantifies the degree of dissimilarity between the timetag sequences obtained by @xmath4 and @xmath5 .",
    "( however our @xmath90 functions may be negative and are not symmetric in their arguments , so they are not strictly distances . )",
    "our implementation matches timetags of @xmath4 with timetags of @xmath5 and assigns a cost to the difference between the matched timetags and a cost to unmatched timetags .    to compute the cost for matched timetags we use function - tuples @xmath101 , where the @xmath102 satisfy that for all @xmath103 , @xmath104 .",
    "we denote the set of such function - tuples by @xmath105 .",
    "the goal is to compare timetags @xmath17 and @xmath29 obtained at settings @xmath100 by computing @xmath106 . to construct a function - tuple in @xmath107 from",
    "any given @xmath108 , @xmath109 and @xmath110 , we can choose @xmath111 such that @xmath112 , provided the expression on the right - hand side is bounded from below .",
    "this condition is satisfied if the given @xmath113 are lower bounded .",
    "three immediate examples of members of @xmath105 are the linear tuples with @xmath114 , the constant tuples with @xmath115 where @xmath116 ( an _ exact _ and _ constant _ function - tuple ) , and @xmath117 $ ] . here",
    ", we again used the convention that for a logical formula @xmath64 , @xmath63=1 $ ] if @xmath64 is true and @xmath35 otherwise . to construct other members of @xmath105",
    "it helps to apply closure properties of @xmath105 .",
    "the set of function - tuples @xmath105 is closed under the following operations .    * component - wise addition and multiplication by a positive real number ( @xmath105 is a convex cone ) . * the reflection defined by @xmath118 . * component - wise maximum of two function - tuples . * for real numbers @xmath119 satisfying @xmath120 , the shift transforming the components according to @xmath121 . * for non - negative function - tuples and @xmath122 , the transformation defined by @xmath123 . *",
    "let @xmath124 and @xmath125 be function - tuples with @xmath126 monotone non - decreasing . then the function - tuple defined by @xmath127 is a function - tuple . if @xmath111 is also monotone non - decreasing then so is @xmath128 .",
    "[ thm : ftuple_closure ]    [ [ proof . ] ] proof .",
    "+ + + + + +",
    "\\(a ) can be checked by direct application of the definitions .",
    "( c ) follows from the observation that the maximum is monotone in each argument and the maximum of two matched sums is at most the sum of the maximums of the terms .",
    "( b ) and ( d ) follow from invariance of the defining inequalities under reflection and under the shift specified in ( d ) . to check ( e ) note that @xmath129 .",
    "if a term on the right - hand side is greater than @xmath55 , non - negativity implies that the right - hand side is at least @xmath55 , an upper bound on the left - hand side by definition of @xmath126 . if not , the right - hand side is equal to @xmath130 .",
    "the following inequalities show ( f ) : @xmath131 and the composition of monotone non - decreasing functions is monotone non - decreasing .    ' '' ''    here are a few more examples of function - tuples in @xmath105 .",
    "* @xmath132 . in this case , the condition is just the twice - iterated triangle inequality for the reals .",
    "* one - sided threshold functions .",
    "let real numbers @xmath133 satisfy @xmath134 and define @xmath135 $ ] .",
    "note that this is an application of the shift in thm .",
    "[ thm : ftuple_closure ] ( d ) with parameters @xmath136 to the function - tuple @xmath137 $ ] .",
    "* half - linear functions . for @xmath119 as in ( 2 ) , a positive slope @xmath138 and an exact constant function - tuple @xmath139 , define @xmath140 . that this tuple is in @xmath105 follows from the closure properties applied to the generating examples given above . * linear - edge window functions .",
    "choose thresholds @xmath141 such that for @xmath142 and for @xmath143 , @xmath144 , and positive slopes @xmath145 and @xmath146 .",
    "define @xmath147 as illustrated in fig .",
    "[ fig : linear - edge_window ] , these functions are @xmath35 between @xmath148 and @xmath149 , and rise linearly away from these thresholds up to a value of @xmath47 . that they form tuples in @xmath105 follows from the closure properties .    in our applications ,",
    "we use the linear - edge window functions . in spot checks using linear programming , they appear to optimize the sought for violations among non - negative tuples in @xmath105 that are @xmath47 outside a fixed interval .    illustration of the linear - edge window functions . see the text for the definitions . ]",
    "we now construct a @xmath90 function @xmath150 for pairs of timetag sequences from an arbitrary function - tuple @xmath151 in @xmath105 .",
    "let @xmath152 be two ordered timetag sequences , @xmath153 and @xmath154 .",
    "let @xmath155 be the family of partial , non - crossing matchings between @xmath156 and @xmath157 . such matchings @xmath158 can be identified with one - to - one , partial , monotone functions @xmath159\\mapsto m(k)\\in[n]$ ] .",
    "monotonicity implies that if @xmath160 and @xmath161 , then @xmath162 .",
    "( we use the notation @xmath163=\\{1,\\ldots , j\\}$ ] . )",
    "let @xmath164 be the minimum over all @xmath165 of the `` cost '' @xmath166 one way to think of this is as the minimum total cost of editing @xmath156 into @xmath157 by deleting timetags in @xmath156 at a cost of @xmath47 ( assessed by @xmath167 ) , deleting timetags of @xmath157 at no cost , and by shifting the remaining timetags of @xmath156 by @xmath168 at a cost of @xmath169 ( assessed by the sum over @xmath170 ) , where each timetag can be shifted at most once and the final time ordering is the same as the initial one .",
    "we can also view this as a maximum weighted bipartite non - crossing matching problem , where the matching is between indices of @xmath156 and indices of @xmath157 with the weight of @xmath171 being @xmath172 .",
    "the cost is then given by @xmath138 minus the weight of the maximum - weight matching .",
    "suppose that the measurement outcome space @xmath68 consists of timetag sequences .",
    "let @xmath124 be a function - tuple in @xmath105 .",
    "then @xmath173 ( as defined before eq .  ) is a @xmath90 function .",
    "[ thm : ftuple ]    [ [ proof.-1 ] ] proof .",
    "+ + + + + +    consider deterministic lr outcomes @xmath54 as introduced previously , but with outcomes consisting of timetag sequences .",
    "let @xmath174 be the cost - minimizing matchings for which @xmath175 if @xmath93 , and @xmath176 .",
    "we can construct a matching @xmath177 from @xmath178 to @xmath179 by composing @xmath180 , with domain consisting of those indices for which the composition is defined .",
    "then @xmath177 is monotone and @xmath181 .",
    "therefore , it suffices to show that @xmath182 the composition of functions defining @xmath177 terminates at the first step where the mapped - to index fails to be in the domain of the next matching .",
    "this allows us to associate with each index not in the domain of @xmath177 a unique index along the way that is `` deleted '' in the next step .",
    "indices in the domain pass through each matching and accumulate separate distances that bound the corresponding distance in @xmath177 .",
    "to formalize this idea , for each index @xmath183 of @xmath178 , we define @xmath184 as a pair consisting of an index and a party / setting label as follows : if @xmath185 , then let @xmath186 .",
    "else , if @xmath187 , then let @xmath188 .",
    "else , if @xmath189 , then let @xmath190 . if none of these conditions apply , @xmath183 is in the domain of @xmath177 and we let @xmath191 .",
    "the definition implies that @xmath0 is one - to - one , @xmath192 iff the second component of @xmath184 is @xmath193 , and if @xmath194 , then the first component of @xmath184 is not in the domain of one of @xmath195 , @xmath196 or @xmath197 .",
    "this ensures that all members of @xmath178 deleted according to @xmath177 are matched to deleted members of one of the timetag sequences in the composition .",
    "in particular , the deletion cost on the left - hand side of eq .",
    "is at most that on the right - hand side .",
    "we now focus on the shift costs contributing to eq .  .",
    "let @xmath198 be the @xmath183th timetag of @xmath54 .",
    "it remains to be shown that @xmath199 because all shift costs are positive , it suffices to show that @xmath200,\\end{aligned}\\ ] ] in which terms on the right - hand side that are not included in the composed matchings have been neglected . for each @xmath201 ,",
    "@xmath202 according to the defining inequality of function - tuples .",
    "these summands are separate contributions ( for distinct @xmath192 ) to the right - hand side of eq .",
    ", completing the proof .    ' '' ''",
    "an algorithm to compute the minimum costs @xmath164 is described in appendix  [ sec : dyn ] .",
    "the non - signaling conditions are a set of equalities that constrain probability distributions describing @xmath4 s and @xmath5 s measurement outcomes .",
    "they ensure that each party s outcome distribution is independent of the other party s setting .",
    "otherwise , one party could signal their setting to the other party .",
    "formally , given non - signaling and any real - valued function @xmath203 on @xmath68 , @xmath204 and similarly for reversing the roles of @xmath4 and @xmath5 .",
    "although both quantum and lr theories obey the non - signaling equalities , using these equalities to transform bell inequalities can increase the signal - to - noise ratio ( snr ) of a bell - inequality violation observed in an experimental test of lr .",
    "consider the general iterated triangle inequality for a @xmath90 function @xmath57 .",
    "we can modify @xmath57 by defining @xmath205 where @xmath206 and @xmath207 are arbitrary real - valued functions .",
    "replacing @xmath57 by @xmath208 leaves the right - hand side of eq .",
    "unchanged , so @xmath208 is also a @xmath90 function .",
    "furthermore , we have @xmath209 for any model satisfying the non - signaling conditions .",
    "we call @xmath208 a non - signaling adjustment of @xmath57 . note that the functions @xmath210 and @xmath211 are @xmath90 functions , and @xmath212 .",
    "non - signaling adjustments can be used to improve the snr of the empirical estimate of a bell function @xmath79 obtained from a sequence of trials . as a simple example with a two - point outcome space , consider @xmath0 trials to test a version of the inequality of eq .  .",
    "the experiment is configured so that each trial involves emission of exactly one photon pair with some probability ( and emission of nothing otherwise ) , and the measurement outcomes @xmath47 and @xmath35 correspond to whether a photon was detected or not .",
    "we start with @xmath213 , which is a @xmath90 function .",
    "let @xmath214 be the probability that @xmath9 detects a photon at setting @xmath55 in a trial .",
    "let @xmath139 be the probability of coincident detections when the parties use settings @xmath100 .",
    "the expected value of the bell function of eq .",
    "is then @xmath215 l_{\\bar2\\bar1}(o^{a},o^{b})\\rangle\\\\        { } + \\langle 4 [ s^{a}=\\bar1 \\ & s^{b}=\\bar1 ] l_{\\bar1\\bar1}(o^{b},o^{a})\\rangle\\\\        { } + \\langle 4 [ s^{a}=\\bar1 \\ & s^{b}=\\bar2 ] l_{\\bar1\\bar2}(o^{a},o^{b})\\rangle\\\\        { } -\\langle 4 [ s^{a}=\\bar2 \\ & s^{b}=\\bar2 ] l_{\\bar2\\bar2}(o^{a},o^{b})\\rangle      \\end{array}\\right\\ } & = &    \\left\\{\\begin{array}{l }        \\langle 4 [ s^{a}=\\bar2 \\ & s^{b}=\\bar1 ] [ o^{a}=1\\&o^{b}=0]\\rangle\\\\        { } + \\langle 4 [ s^{a}=\\bar1 \\ & s^{b}=\\bar1 ] [ o^{b}=1\\&o^{a}=0]\\rangle\\\\        { } + \\langle 4 [ s^{a}=\\bar1 \\ & s^{b}=\\bar2 ] [ o^{a}=1\\&o^{b}=0]\\rangle\\\\        { } -\\langle 4 [ s^{a}=\\bar2 \\ & s^{b}=\\bar2 ] [ o^{a}=1\\&o^{b}=0]\\rangle      \\end{array}\\right.\\nonumber\\\\    & = &    \\left\\ {      \\begin{array}{l }        p^a_{\\bar2}-c_{\\bar2\\bar1}\\\\        { } + p^b_{\\bar1}-c_{\\bar1\\bar1}\\\\        { } + p^a_{\\bar1}-c_{\\bar1\\bar2}\\\\        { } -(p^a_{\\bar2}-c_{\\bar2\\bar2 } ) .",
    "\\end{array }    \\right . \\end{aligned}\\ ] ] note that the terms @xmath216 cancel in this expression .",
    "however , when estimating the expectation by evaluating the bell function on the trials , the two @xmath216s are contributed by values at different settings , namely @xmath217 and @xmath40 .",
    "consequently , two sources of counting statistics variability associated with detections of @xmath4 at setting @xmath25 affect the the snr of the bell function .",
    "we can eliminate this problem by defining @xmath218 in eq .  .",
    "( here , @xmath219 and @xmath220 are set to zero if not explicitly assigned . ) by the non - signaling constraints and construction , the modified bell function has the same expectation as the original bell function .",
    "this bell function was used to show a bell - inequality violation in the experiment reported in ref .",
    ". a further improvement of the snr is obtained by `` distributing '' the terms whose expectations are @xmath221 and @xmath222 over the different settings .",
    "it is equivalent to averaging them over the other party s setting choices and involves setting @xmath223 and @xmath224 in eq .",
    ", in addition to setting @xmath218 .",
    "this modification was introduced for the explicit purpose of improving the snr of the violation in ref .",
    "when analyzing a set of timetag - sequence pairs from trial measurement outcomes , it is necessary to choose a bell function @xmath79 that , before the experiment , can be expected to show good results .",
    "it may not be feasible to make a good choice of @xmath79 on purely theoretical grounds .",
    "one can instead acquire a statistically useful training set consisting of the outcomes from the first @xmath225 trials and set aside the remainder in the analysis set .",
    "the notion of `` statistically useful '' is not formalized here .",
    "the training set is used to choose the parameters required for analyzing the rest of the data .",
    "the training set is excluded from the final analysis .",
    "the main task is to determine a function - tuple in @xmath105 and non - signaling adjustments to use for defining @xmath79 . in principle",
    ", one can optimize the function - tuple on the training set .",
    "that is , one can compute @xmath79 for all such function - tuples and pick the one that minimizes the empirically computed value of @xmath79 .",
    "this optimization is difficult , but one can use non - linear optimization on the @xmath226 independent parameters of the linear - edge window functions .",
    "we note that on spot checks , this subset of @xmath105 appears to contain the optimal solution among function - tuples of @xmath107 whose members are constrained to be @xmath47 outside a fixed interval @xmath227 $ ] . in the simulations below , the number of independent parameters was reduced to @xmath228 by taking advantage of symmetries .",
    "the suggested non - linear optimization can still be too resource intensive . in our simulations",
    "we used an effective approximation ; see appendix  [ app : optimizing_tuples ] .",
    "we do not discuss methods for optimizing the non - signaling adjustments here . in the simulations , we just use the ones described in the last paragraph of sect .  [",
    "sec : nosigadj ] .",
    "an even more ambitious optimization could seek to optimize the snr or the statistical significance of the violation of the inequality rather than the expected value of @xmath79 .",
    "consider @xmath0 trials whose trial outcomes are @xmath83 and a bell function @xmath5 .",
    "a direct way to analyze the trial outcomes is to compute @xmath229 , let @xmath230 , and determine the sample standard error for @xmath124 as @xmath231 .",
    "the violation can then be quantified by the `` number of standard deviations of violation '' , @xmath232 , which is the snr of the total violating signal .",
    "this number needs to be interpreted with care , particularly if it is very large  a desirable outcome of an experiment . if the trials are i.i.d .",
    ", then @xmath233 is an approximate 68 @xmath234 confidence interval for the expectation of @xmath5 .",
    "( a better method that takes advantage of the fact that the settings probability distribution is known is given in appendix  [ sect : nomsnr ] .",
    ") however , even in the case of i.i.d .",
    "trials , @xmath235 does not quantify how strongly the experiment `` rejects '' lr models .",
    "this is because the central limit theorem can not be reliably used to estimate extreme tail probabilities .",
    "furthermore , the assumption that the trials are identical rarely holds to high precision , and independence can not be assumed in applications to cryptographic protocols . for more details on these issues , see  @xcite .    to determine the statistical significance of a bell - inequality violation",
    ", one can compute a bound on the largest probability with which any lr model could produce a violation at least as large as that observed .",
    "this upper bounds a @xmath1-value according to the theory of statistical hypothesis testing with respect to the composite null hypothesis consisting of all possible lr models .",
    "typical bell inequality experiments thus aim for extremely small @xmath1-values . given a @xmath1-value bound @xmath1 , it is convenient to quantify the violation in terms of the ( negative ) @xmath236-value bound , formally defined as @xmath237 .",
    "in many cases , for example when reporting a discovery in particle physics , @xmath1-values are converted to equivalent standard deviations with respect to the one - sided tail probabilities of the standard normal distribution . for comparison ,",
    "the @xmath236-values corresponding to @xmath238 and @xmath239 standard deviations are @xmath240 and @xmath241 .",
    "the first rigorous method for computing such a bound was given by gill  @xcite and is based on martingale theory .",
    "this `` martingale - based protocol '' does not require that trials be independent from one trial to the next , or that they have identically distributed measurement outcomes , an important feature for its application to quantum randomness expansion  @xcite .",
    "the bound obtained by the martingale - based protocol is suboptimal , but there is a protocol , the pbr protocol  @xcite , that is optimal in an asymptotic sense . like the martingale - based protocol",
    ", the pbr protocol also does not require independent or identical outcomes .",
    "the pbr protocol has the advantage that it does not require a predetermined bell inequality . nor",
    "does it require that the number of trials be decided in advance : it gives valid @xmath1-value bounds for any stopping rule ( see the last paragraph of this section ) .",
    "the full pbr protocol is computationally infeasible when the measurement outcome spaces or the number of settings are large , but there is a simplified and efficient version of the protocol that still outperforms the martingale - based protocol  @xcite while retaining the advantages of the full protocol .    the pbr protocol is based on the following observation .",
    "suppose that before the @xmath183th trial , we can determine a `` test factor '' @xmath242 on the space of possible trial outcomes such that @xmath243 and for all lr models , @xmath244 , where the bound holds regardless of what happened before the @xmath183th trial in the experiment",
    ". then @xmath245 .",
    "thus , given lr , according to the markov inequality , the probability that @xmath246 is bounded above by @xmath1 , and therefore @xmath247 is a @xmath1-value bound . in general , candidate test factors @xmath15 can be obtained from bell functions @xmath5 bounded above by @xmath248 according to @xmath249 .",
    "more generally , given a collection of candidate test factors @xmath250 satisfying @xmath251 , any convex combination of the @xmath252 can be used as @xmath242 .",
    "( the collection may depend on @xmath183 . )",
    "the simplified pbr protocol takes as input such a collection @xmath253 and chooses @xmath242 before the @xmath183th trial by optimizing the convex combination on the outcomes of the previous trials .",
    "( @xmath254 is always chosen to be the `` trivial '' test factor @xmath47 . )",
    "specifically , it maximizes the empirical estimate of the @xmath236-value increase per trial given by @xmath255 . for more details , see ref .",
    "the possibility of adjusting the test factors for the upcoming trial after each trial makes it possible to avoid making predetermined choices for the bell function parameters .    in practice",
    ", there is little gained by re - optimizing the test factors before every trial , and instead the factor is reused until sufficiently many new trials have been obtained . in principle , the number of trials before @xmath242 can be productively updated may be determined from statistical considerations .",
    "( our implementations so far are largely based on heuristic considerations . )",
    "the simplest method is to determine the optimal test factor from the training set and use it uniformly on the analysis trials .",
    "for example , the starting bell functions can include multiple choices of parameters .",
    "the optimal convex combination of the corresponding test factors can then be determined empirically on the training set and can be directly applied to the trials in the analysis set .    to apply the pbr protocol to timetag data",
    ", we make two modifications to the @xmath90 bell functions .",
    "the first modification ensures that we have a set of bell functions that are bounded from above as required by the simplified pbr protocol .",
    "finite bounds are normally not available for the timetag - sequence bell functions discussed so far , or the bounds are too high to be useful , so we describe a truncation strategy below .",
    "our second modification increases the expected @xmath236-value bound produced by the pbr protocol by shifting the @xmath90 functions so that the contributions to the violation of the @xmath90 bell inequality are equalized across measurement settings .",
    "consider a @xmath90 function @xmath57 . to obtain a bounded @xmath90 bell function",
    ", it suffices to modify @xmath57 by composition with a function - tuple @xmath113 in @xmath105 for which @xmath111 is monotone non - decreasing and the @xmath113 are bounded .",
    "we call such an @xmath113 a monotone and bounded function - tuple . to see that this preserves the desired inequalities , consider eq .   and define @xmath256 . because of monotonicity of @xmath111 , thm .",
    "[ thm : ftuple_closure ] ( f ) ensures that @xmath208 satisfies the inequality in eq .",
    ", thus @xmath208 is also a @xmath90 function .",
    "a convenient family of monotone and bounded function - tuples in @xmath107 is provided by @xmath257 where @xmath258 and @xmath259 are exact constant tuples in @xmath105 and @xmath122 . that @xmath260 is a function - tuple follows from the closure properties of @xmath107 ( thm .",
    "[ thm : ftuple_closure ] ) .",
    "if @xmath57 is modified to @xmath208 by means of a function - tuple of the form @xmath261 , the bell function @xmath262 is guaranteed to be bounded above by the maximum of @xmath263 .",
    "the following is a method for systematically choosing the truncation parameters .",
    "consider a collection of training trials .",
    "let @xmath264 consist of the observed values of @xmath265 for the trials where @xmath266 and @xmath267 .",
    "let @xmath268 .",
    "the bounds @xmath258 can be chosen as a compromise between having small bounds on the bell function and preserving the variation in the values of @xmath269 .",
    "the violating signal is reduced if we truncate the values of @xmath270 so that the maximum value is too close to the mean @xmath271 .",
    "this truncation point is determined by solving @xmath272 , that is @xmath273 .",
    "( the upper or lower truncation point is the value of @xmath168 for which @xmath261 reaches its upper or lower bound . )",
    "similarly , we should not truncate the other @xmath88 so that their minimum values are too close to their means @xmath274 .",
    "these truncation points are at @xmath275 .",
    "let @xmath276 be a `` safe '' separation between the truncation points and @xmath274 , to be determined from the distributions of the @xmath269 ( see the end of the next paragraph ) . for @xmath277",
    ", we can set @xmath258 by solving @xmath278 .",
    "this determines @xmath279 .",
    "we can then choose @xmath55 so that @xmath280 .",
    "the next step is to choose @xmath259 so as to ensure that the contributions to the violation conditional on the settings are equalized .",
    "this is done to improve the expectation of the @xmath236-value bound by exploiting the concavity of the logarithm .",
    "let @xmath281 with @xmath61 and @xmath55 as obtained so far .",
    "define @xmath282 accordingly .",
    "we choose @xmath259 so as to balance the average violation for the different settings .",
    "this is accomplished by defining @xmath283}(\\bar l'_{\\bar1\\bar1}+\\bar l'_{\\bar1\\bar2}+\\bar l'_{\\bar2\\bar1}-\\bar l'_{\\bar2\\bar2})/4,\\ ] ] if we then use @xmath261 as defined in eq .   and modify @xmath57 as described there with @xmath284 , this ensures that each trial contributes the same estimated violation @xmath285 on average . if this violation is not negative , then this truncation is not helpful for use in the pbr protocol .",
    "assuming there is an empirical violation according to the original @xmath274 , the separations @xmath276 need to be increased until a violation remains visible in the @xmath282 . in this case , if the violation persists in future trials , the pbr protocol can take advantage of the truncation . in our implementation , rather than attempting to find the optimal choice for @xmath276 , we consider a small set of good candidates , obtain the associated bell functions and convert them to the non - trivial test factors @xmath286 that are then convexly combined with the trivial test factor by the simplified pbr protocol as described above .",
    "we found that the convex combination chosen by the protocol normally involved more than one choice of @xmath276 , suggesting that a single choice is not optimal .",
    "we remark that the shift @xmath259 can be expressed as trivial non - signaling adjustments by constant functions .",
    "in addition to increasing the snr overall , a goal of non - signaling adjustments might be to equalize the snr conditional on the settings , but we did not attempt to achieve this .    the truncation and shifting strategy above results in factors @xmath287 ( and candidate test factors",
    "@xmath252 ) whose predicted expectations are upper bounded by @xmath288 , according to the training set . to see this",
    "we show that the upper bound @xmath248 of the modified bell function that determines a candidate test factor is at least @xmath289 , while by construction , the predicted expectation is @xmath290 . here , @xmath87 depends on the training data and choice of @xmath276 for this test factor . since the test factor is given by @xmath291 , we find that the predicted expectation of @xmath15 is at most @xmath292 .",
    "the upper bound is given by @xmath293}g_{ab}(x;b_{ab},u_{ab},c)$ ] .",
    "the expression for @xmath261 shows that @xmath294 and @xmath295 .",
    "consider @xmath296 , which is the sum of the other @xmath259 ( by definition of exact constant tuples and by construction ) .",
    "for @xmath277 , the lower bound on @xmath297 is @xmath298 .",
    "but the sample mean at setting @xmath100 of the truncated bell function is @xmath290 , which requires that its lower bound satisfies @xmath299 .",
    "it follows that @xmath300 , which completes the argument .",
    "a consequence of this observation is that the expected increase in the @xmath236-value per trial is bounded by @xmath301 , and it is not possible to take advantage of seemingly strong violating signals per trial .",
    "to some extent , this is unavoidable : we are making no assumptions on the probability distribution of the timetag sequences , and an extremely adversarial lr model could take advantage of this in future trials given our choice of parameters for the pbr protocol .",
    "for the purpose of making the most of the pbr protocol , it is therefore advantageous to design the individual trials to have statistically small violating signals . in particular",
    ", it is favorable to have the one - trial snr be well below @xmath47 . a simple way to accomplish this and get a better overall",
    "@xmath236-value bound is to shorten the durations of the trials and increase the number of trials proportionally .",
    "we finish this section by explaining our comment that the pbr protocol can be used with any stopping rule , such as one according to which one collects trials until a desired @xmath1-value bound is observed . to see this ,",
    "virtually replace the experiment with the stopping rule by one that performs a fixed , large number of trials , larger than the maximum number of trials that could be performed by the original experiment .",
    "when the original experiment s stopping rule says `` stop '' , the new experiment sets all future test factors to @xmath47 .",
    "this is justified because , the experimenter s choice of the test factors for trial @xmath183 is only constrained by @xmath243 and @xmath302 , which are satisfied by @xmath303 .",
    "the two experiments have the same statistics for the @xmath1-value bounds obtained and the virtual experiment s @xmath1-value bounds are valid according to the theory of the pbr protocol .",
    "we remark that the pbr protocol can be viewed as an application of the theory of test - supermartingales as reviewed in ref .  @xcite .",
    "to illustrate timetag - sequence analysis we simulated experiments intended to test inequalities such as eq .   and its non - signaling variations .",
    "the situation is as described in sect .",
    "[ sec : tt_bell_tests ] with a poisson source of polarization - entangled photon pairs and high overall efficiency .",
    "we assume that both arms of the experiment have identical efficiency @xmath304 . in principle",
    ", such tests can succeed if @xmath305  @xcite .",
    "we explored the effects of uniform jitter ( defined in the next paragraph ) on the performance of such experiments at an efficiency of @xmath306 .",
    "we also found lower bounds on the maximum uniform and exponential jitter ( defined in the next paragraph ) for which our techniques can show lr violation for @xmath307 .",
    "for each efficiency being considered , we first optimized the violation of the chsh inequality in eq .   by varying the settings choices and the parameter @xmath308 in the family of unbalanced bell states defined by @xmath309 .",
    "given the efficiency , an optimal state and settings , we computed the probabilities of the measurement outcomes conditional on the settings .",
    "we considered two families of timetag jitter distributions for the difference between the recorded timetag and the true arrival time of a photon .",
    "the first is the uniform distribution on an interval of width @xmath310 .",
    "that is , given the true arrival time @xmath29 , the recorded timetag @xmath311 is uniformly distributed in the interval @xmath312 $ ] .",
    "the second family is an exponential distribution with density @xmath313 for @xmath314 .",
    "the two families of distributions were chosen for ease of calculation and to illustrate the effect of no tail versus long tail behavior , with long tails leading to greater loss of violating signal .",
    "the procedures for simulating and analyzing an experiment were automated .",
    "we generated simulated photon pairs at a normalized rate of @xmath47 per ( arbitrary ) unit of time .",
    "thus the numerical value of @xmath32 ( the mean photon - pair inter - arrival time ) is @xmath47 in these units . from here on , time quantities such as @xmath315 are given as numerical values with respect to these units .",
    "the procedure is based on a choice of observation window @xmath6 for the timetag sequences , number of training trials @xmath225 and number of analysis trials @xmath316 . in principle",
    "these can be chosen before the simulation is started to ensure sufficient data for determining the needed analysis parameters from the training set .",
    "we recall that for the pbr analysis to take full advantage of the snr , it is a good idea to choose @xmath6 so that the snr for one trial is below @xmath47 . on the other hand ,",
    "if @xmath6 is too small , loss of coincidences near the boundary due to jitter leads to an additional reduction of the violating signal . to reflect the conditions of experiments with always - on pump lasers , we start generating photon pairs @xmath228 units of time before the beginning of the observation window . the data presented below uses @xmath317 , @xmath318 , @xmath319 . with these parameters and given the jitter distribution , the procedure for generating and analyzing data is as follows :    * generate the trials for the training and analysis sets . for each trial , first produce the sequence of times at which photon - pairs arrive at the detectors according to a poisson process of rate @xmath47 as described above . the jitter distribution is used to delay the recorded time of detection independently for the two parties .",
    "the timetags inside the observation window are saved to the parties timetag sequences . *",
    "determine the analysis parameters from the training set .",
    "three studies are performed , each of which requires optimized parameters .",
    "the first is a conventional coincidence analysis , for which the coincidence window width is determined by optimizing the resulting violation on the training set .",
    "the second computes the timetag - sequence distances based on the linear - edge window function - tuples .",
    "the function - tuple parameters are optimized on the training set .",
    "the tuples are restricted to be reflection symmetric around @xmath35 , and the thresholds for the settings other than @xmath40 are taken to be identical .",
    "thus only two parameters need to be optimized .",
    "( the optimization algorithm is described in appendix  [ app : optimizing_tuples ] ) .",
    "the third is the pbr analysis on the truncated bell function .",
    "the truncation method and optimization of the anticipated @xmath236-value increase per trial described in sect .",
    "[ sec : pbr ] are used . *",
    "perform the three analyses on the analysis set using the parameters determined from the training set .",
    "the conventional coincidence analysis used in this procedure is equivalent to using identical window functions with infinite edge - slopes to compute the distances between each pair of timetag sequences according to the prescription for using function - tuples . because the function - tuple effectively used is not in @xmath105",
    ", there is no guarantee that the targeted bell inequality is strictly satisfied by lr models .",
    "the coincidence loophole examples demonstrate that such an inequality requires additional assumptions on the nature of the detection events .",
    "we remark that the analysis described in @xcite is related to using window functions with infinite edge - slopes , but the width of the window function for setting @xmath320 is three times the width of that used for the other settings .",
    "this set of window functions is a function - tuple in @xmath105 and produces an analysis free of the coincidence loophole .",
    "we simulated experiments where the jitter has a uniform distribution on the interval @xmath322 $ ] , where @xmath323 $ ] .",
    "this covers most of the range for which the conventional coincidence analysis shows a violating signal .",
    "[ fig : plot80a ] shows the nominal snrs for the conventional and the timetag analyses .",
    "the nominal snr is the ratio of the violating signal to the sample standard deviation .",
    "positive values are violating , negative ones are non - violating .",
    "we refer to this snr as `` nominal '' because it can not be interpreted in terms of gaussian tail distributions .",
    "see  @xcite for a discussion of this issue .",
    "our method for determining the snrs is given in appendix  [ sect : nomsnr ] .",
    "the figure also shows the @xmath236-value bounds from the pbr analysis on a matched scale .",
    "the @xmath236-value bound and the timetag analysis snr both drop to zero around @xmath324 .",
    "comparison of methods for simulated timetag data from a quantum source and detectors with efficiency @xmath306 and uniform jitter .",
    "the nominal snrs for the standard and the timetag analyses are shown on the right axis .",
    "negative snrs mean that the signal is positive and therefore not violating .",
    "the @xmath236-value bound for the pbr analysis is shown on the left axis .",
    "the horizontal axis shows the relative jitter width @xmath325 . to match the two vertical axes with one another",
    ", we converted @xmath236-values to equivalent gaussian snrs by computing the value for which the one - sided tail probability for the standard normal distribution matches the @xmath1-value bound .",
    "the computed @xmath236-value bounds are @xmath35 for @xmath315 above approximately @xmath326 and not shown on the plot.,title=\"fig:\",width=672 ]    we next considered the question : for what @xmath310 does there exist an lr source that has the same statistics as our simulated source ?",
    "we do not have a definite answer to this question .",
    "we constructed an lr source whose one- and two - point statistics closely match those of the ideal poisson source of quantum photon pairs for @xmath327 .",
    "more generally , we tweaked the lr source so that for all positive values of @xmath310 it looks like the poisson source that we simulated for the data in fig .",
    "[ fig : plot80a ] , except that it may have more coincidences at the @xmath40 setting depending on the jitter .",
    "further details are in appendix  [ app : lr_source ] . fig .",
    "[ fig : plot80b ] shows the results from applying the conventional and timetag analysis methods to data generated by a simulation of the lr source .",
    "as expected , the timetag analysis shows no violation .",
    "but the conventional analysis falsely shows violation .",
    "for @xmath328 the violation is similar if somewhat lower than that for the corresponding quantum photon pairs in fig .",
    "[ fig : plot80a ] .",
    "comparison of methods on lr - generated timetag data .",
    "the conventional coincidence analysis shows a false violation over almost the entire range .",
    "the timetag analysis shows no violation .",
    "the @xmath236-value bounds from the pbr analysis are @xmath35 everywhere and are not shown .",
    "the snr of the poisson quantum source whose one- and two - point statistics are approximated by the lr source for jitter larger than @xmath329 is also shown.,title=\"fig:\",width=672 ]      the simulations discussed above show that when there is too much jitter , a nominally violating source of entangled photon pairs produces timetag data that becomes indistinguishable from that produced by an lr model .",
    "while we can not determine the minimum jitter at which this happens , it is possible to lower bound the maximum jitter at which the timetag analysis methods can see lr violation .",
    "we simulated the photon - pair source and measurement configuration introduced above at various efficiencies and varied the jitter distribution .",
    "we considered the uniform jitter model and the exponential jitter model and determined the maximum jitter widths at which the timetag analysis found violation .",
    "the results are shown in tbl .",
    "[ table : thresholds ] in terms of the median of the jitter delay of the recorded timetags .",
    ".lower bounds on maximum jitter at which the timetag analysis can still detect violation of lr .",
    "the rows give the maximum median jitter at which our simulations showed a violation as determined by the @xmath236-value being strictly positive .",
    "the simulation parameters other than jitter are the same as for the other simulations .",
    "the jitter bounds are shown for the uniform and for the exponential distribution .",
    "for ease of comparison , they are parametrized in terms of the median delays of the recorded timetags . for low violation , unfeasibly large training and analysis sets",
    "are required to make the violation apparent in a simulation .",
    "thus , the entries in the table are lower bounds on the maximum jitter at which the timetag analysis can still detect violation .",
    "the missing entry was not computed due to excessive computational resource requirements for our implementation . [ cols=\"^,^,^ \" , ]",
    "we thank yi - kai liu and krister shalm for their help in revising this paper .",
    "this work is a contribution of the national institute of standards and technology and is not subject to u.s .",
    "the trials of an experiment result in a sequence of bell function values @xmath331 , one for each trial .",
    "let @xmath332 be the settings of trial @xmath333 and @xmath334 the number of trials at settings @xmath100 .",
    "a standard approach to estimating the violation is to compute the sample mean @xmath335 and define the estimated total violation as @xmath336 .",
    "the variance of this value can then be estimated to first order with respect to the variance of @xmath334 from the sample variances of the subsequences @xmath337 . instead of this procedure ,",
    "we used a method that makes no first - order approximations and can be meaningfully applied even if the trials bell function values @xmath338 are not independent .",
    "we consider this method better motivated , and it gives results that are statistically close to those obtained by the standard approach . here",
    "we describe the method for the case of i.i.d .",
    "trials .    the goal is to estimate the expectation of the sum of the trials bell function values and obtain a nearly tight bound on the variance of the estimate .",
    "the method is adaptive and applied to the analysis data given some initial training data .",
    "( calibration data or theoretical predictions can be used instead . )",
    "the desired expectation is @xmath339 .",
    "( since we are considering i.i.d .",
    "trials , the distribution of @xmath340 is the same for all @xmath333 . ) before considering the @xmath333th trial , we use the previous trials and the training set to obtain four unbiased estimates @xmath341 of @xmath342 , where @xmath343 is the settings random variable for the @xmath333th trial .",
    "this estimate can be obtained by any means desired .",
    "we used the formula for @xmath344 given above and applied it to the training set and the first @xmath345 trials . for the @xmath333th trial , we then define the random variables @xmath346 and @xmath347 . because the settings probability distribution is known ,",
    "so is the expectation of @xmath348 : @xmath349 .",
    "we then record @xmath350 for the @xmath333th trial and continue .",
    "note that @xmath351 we can therefore empirically estimate @xmath352 as @xmath353 , which ensures that @xmath354 .",
    "we are considering the case of i.i.d .",
    "trials only , so @xmath355 is an estimate of the variance of @xmath356 that is biased high .",
    "this is because the variance of a random variable @xmath357 is the minimum of @xmath358 over @xmath60 .",
    "since @xmath359 is designed to asymptotically converge to a zero - mean random variable , the variance estimate is asymptotically unbiased .",
    "the snrs for the conventional coincidence analysis and the timetag - sequence analysis shown in figs .",
    "[ fig : plot80a ] and  [ fig : plot80b ] are defined as @xmath360 multiplied by the sign of the violation .",
    "for general timetag - sequence pairs , computing a @xmath90 function @xmath173 ( see eq .  ) can be accomplished by dynamic programming .",
    "the simplest implementation of this technique has a quadratic time cost . for sequences such as those produced by our simulations , which are associated with detections and coincidences generated uniformly randomly in time ,",
    "this cost can be reduced to average linear time .",
    "let @xmath361 and @xmath362 be timetag sequences .",
    "we wish to determine the distance @xmath363 . for this purpose ,",
    "let @xmath364 and @xmath365 be their initial segments .",
    "let @xmath366 .",
    "we can determine @xmath367 inductively .",
    "we have @xmath368 and @xmath369 .",
    "suppose we have determined @xmath370 for @xmath371 and @xmath372 .",
    "let @xmath373 be the ( not - yet - known ) matching minimizing @xmath374 .",
    "there are two possibilities to consider .",
    "either @xmath375 , in which case @xmath376 ; or @xmath377 , in which case @xmath378 .",
    "this reduction works because @xmath373 is monotone .",
    "thus @xmath367 can be determined as the minimum of these possibilities . in an algorithm , one can store the @xmath367 in an @xmath379 matrix and fill its entries in the order suggested by this inductive construction .",
    "it is possible to reduce memory requirements by filling the matrix row by row and discarding the rows no longer needed .",
    "however , if it is desirable to extract the cost - minimizing matching after @xmath380 has been determined , it helps to keep the full matrix , and work backward from the @xmath381 entry to determine which of the cases above was used when the entry encountered was computed .",
    "the next entry as we work backwards is determined by the case used , and the relationships in the matchings arise from the encountered entries where the second case was used .",
    "the construction as given above can be too resource intensive for long timetag sequences . for pairs of sequences with sufficiently low rates of timetags ,",
    "a simple way to speed up the algorithm is to break up the sequences at sufficiently large gaps and apply the algorithm to each resulting pair of subsequences .",
    "the subsequence costs are added .",
    "to formalize this idea , let @xmath382 be such that for all @xmath383 $ ] and for all @xmath100 , @xmath384 . in this case , no pair of indices @xmath385 with @xmath386 needs to be considered for matching .",
    "break up the two sequences into pairs of subsequences @xmath387 and @xmath388 such that @xmath389 for every @xmath333 for which both sides of the inequality are defined .",
    "( the maximum of a collection of sequences given as arguments to @xmath390 is defined as the maximum of the set of all timetags occurring in the arguments , and similarly for @xmath391 . )",
    "the algorithm is then applied to each corresponding pair of subsequences and the costs computed are added to determine the cost of the original sequence .",
    "when performing the timetag - sequence analysis on simulated data , we optimized the parameters of the linear - edge window function - tuple using a set of training data . to simplify the optimization",
    ", we restricted the linear - edge window functions in eq .   to be reflection symmetric around 0 , so that @xmath392 and @xmath393 .",
    "we also fixed @xmath394 . by definition of the linear - edge window function - tuple , @xmath395 ,",
    "so only the slope @xmath138 and truncation point @xmath29 remain to be optimized . instead of direct optimization",
    ", we used a simpler approximate optimization strategy based on compressing the relevant information in the timetag sequences .",
    "this is accomplished as follows : for each pair of training - set timetag sequences @xmath156 and @xmath157 at setting @xmath100 contributing to @xmath79 , we first determine the optimum matching @xmath158 for the `` compression '' function - tuple @xmath396 . in the simulations , @xmath397 . in general , @xmath398 needs to be chosen so that the timetag differences @xmath36 for which the analysis function - tuple may be less than @xmath47 satisfy @xmath399 .",
    "our choice of @xmath398 is given by the photon - pair creation rate .",
    "but it should suffice to choose @xmath398 so that few entangled photon pairs have recorded timetags that are separated by more than @xmath400 . for each index @xmath183 of @xmath156 in the domain of @xmath158 ,",
    "we determine the differences @xmath401 , where the notation for timetags of @xmath156 and @xmath157 is as before .",
    "we then collect all such timetag differences for all pairs @xmath156 and @xmath157 at setting @xmath100 in a single sequence @xmath402 . for the optimization",
    ", we assume that the matchings @xmath158 obtained in the construction of @xmath402 are close in cost to the optimal matchings on the training set that would be obtained according to function - tuples with the parameters we are optimizing .",
    "since we are working on the training , not the analysis set , our computations can be approximate . given this assumption , we can use @xmath402 to compute an approximation of the @xmath100 contribution to the bell function @xmath403 for a given function - tuple @xmath260 .",
    "let @xmath404 be the maximum number of deletions that can contribute to the @xmath100-cost .",
    "this is given by the sum over all timetag - sequence pairs at settings @xmath100 in the training set of the number of timetags in the first ( when @xmath93 ) or second ( when @xmath405 ) timetag sequence in each pair of sequences .",
    "then the estimated difference between the @xmath100-cost and @xmath406 is given by the sum of the values of @xmath261 applied to the timetag differences in @xmath402 .",
    "( here , @xmath407 is the number of timetag differences in @xmath402 . )",
    "these sums can be computed much faster than one can compute the exact minimum @xmath100-cost for @xmath261 .",
    "the approximate costs are used to optimize @xmath260 , and the resulting @xmath260 is subsequently used for the timetag analysis of the analysis set .",
    "we note that the objective function in the optimization has irregularities that can result in high sensitivity of the parameters of @xmath260 to statistical noise .",
    "in this section we describe the lr source whose false violation of a bell inequality under a standard coincidence window analysis is shown in fig .  [",
    "fig : plot80b ] .",
    "this lr source can closely mimic the one- and two - point statistics of a poisson source of entangled photon pairs detected by detectors with uniform jitter distribution of width @xmath408 .",
    "an lr source generates four timetag sequences @xmath409 , where @xmath410 and @xmath411 , for each trial .",
    "these sequences are the sequences that may be recorded by @xmath4 and @xmath5 depending on their settings . after the experiment , only the two sequences corresponding to the actually chosen settings are visible to the parties .",
    "the goal is to match the visible statistics of the lr source to those of a poisson source of quantum photon pairs with jitter .",
    "we consider the uniform jitter distribution of width @xmath310 and a poisson source whose detection statistics are determined by the single - pair settings - conditional outcome probabilities @xmath412 and the uniform distribution for settings .",
    "we ensure that the lr source exhibits the same marginal detection rates @xmath413 .",
    "but since we are interested in how readily the conventional coincidence analysis can be deceived , we allow the lr source to adjust the apparent coincidence rates . note that the inferred coincidence rates depend on the method used to determine coincidences .",
    "the construction of the lr source uses probabilities @xmath414 as a template in an attempt to deceive the experimenter into believing @xmath415 .",
    "the template satisfies @xmath416 .",
    "the apparent coincidence rates are the same except at the @xmath40 setting , where we set @xmath417 , @xmath418 , @xmath419 , @xmath420 , and @xmath421 otherwise .",
    "the coincidence rate adjustment @xmath422 is chosen to maximize the rate at which the lr source can successfully introduce an apparent violating signal . for @xmath423",
    ", we found that it is possible to match the coincidence rates ( @xmath424 ) .    for successful deception",
    ", the lr source s timetag - sequence statistics should match that of a poisson source with template frequencies given by @xmath415 .",
    "( these frequencies account for the photon states , source statistics and the jitter distribution . )",
    "we aimed for matching detection rates and correlation functions .",
    "while our source does not match the correlation functions exactly ( see below ) , the residual correlation mismatches are sufficiently small to either escape detection or to be hidden by the typically much larger correlation artifacts of the same order as the jitter introduced by the detection apparatus .",
    "we also note that in an experiment , the source and jitter distributions are not known beforehand , making a statistical test for correlation artifacts introduced by the lr source difficult .",
    "comparisons of the correlation functions for @xmath425 are in fig .",
    "[ fig : plot80c ] .",
    "note that the mean time separation between @xmath40 coincidences seems to match that for other settings .",
    "that is , there is no tell - tale broadening that might be expected from the earlier coincidence - loophole examples in sect .",
    "[ sec : tt_bell_tests ] .    here is a sketch of the lr source construction . to generate lr timetag sequences according to @xmath415 and @xmath310 ,",
    "we first decompose @xmath426 , where @xmath427 is maximized subject to @xmath428 being an lr probability distribution and @xmath429 a popescu - rohrlich ( pr ) box s  @xcite probability distribution . here , the pr box is perfectly correlated on all settings except at @xmath40 , where it is perfectly anti - correlated . to create an apparent pr box signal , we proceed as follows .",
    "let @xmath430 be the distribution of the time separation @xmath168 between pairs of initially coincident timetags both of which are jittered uniformly with width @xmath310 . the density @xmath431 has a triangle shape centered at @xmath35 , supported on @xmath432 $ ] , with @xmath433 .",
    "let @xmath434 be the detection rate of @xmath9 at setting @xmath55 .",
    "we begin by generating timetags for @xmath4 at setting @xmath435 at a uniform rate @xmath216 .",
    "this gives the timetag sequence @xmath436 .",
    "for each timetag @xmath29 thus generated , with probability @xmath437 , we wish to generate a corresponding timetag of @xmath438 that is generally far enough from @xmath29 to be missed as a coincidence by the conventional analysis and is indistinguishable from background . the trick is to do this while preserving the ability to generate @xmath5 s detections at setting @xmath435 according to a uniform process of rate @xmath439 .",
    "a first attempt is to generate timetags for @xmath440 so that the rate of detections at @xmath441 is @xmath442 ( three times the apparent jitter width ) . for fixed @xmath29 , the probability of at least one detection for @xmath438 thus generated",
    "is @xmath443 .",
    "if there is at least one such detection , we allocate it to a `` hidden '' coincidence for purposes of keeping track of the detection statistics .",
    "the hidden coincidence will be attributed to a pr - like anticorrelation if this detection is not recognized as a coincidence .",
    "note that detections generated at a uniform rate @xmath17 can be realized by independently generating detections according to rate distributions @xmath444 where @xmath445 .",
    "thus , if @xmath446 , we can generate further detections to get the desired marginal statistics for @xmath5 at setting @xmath12 . actually , we need to exclude the rate of coincidences , @xmath447 from @xmath439 in this inequality , because these `` original '' coincidences are to be added separately later . in addition , to ensure that @xmath448 is below the corrected bound @xmath449 , we have to deal with the problem that for nearby timetags of @xmath450 , the distributions @xmath451 overlap . for this purpose we made @xmath452 depend on the timetag @xmath29 and used a linear programming technique to maximize @xmath453 subject to the bound .",
    "the actual rate of apparent pr boxes is affected by the result .",
    "these rates were determined by a monte carlo method as a function of the jitter and matched to @xmath437 by adjusting @xmath422 as needed .",
    "the pr boxes inserted into the timetags at setting @xmath40 by hiding coincidences need to be extended to recognizable coincidences at the other settings .",
    "we first fill in these coincidences by spreading them across the @xmath217 , @xmath41 and @xmath454 settings at the regular jitter width @xmath315 by dividing the hidden coincidences @xmath40 separations equally into the separations involving the timetags at the non-@xmath25 settings .",
    "extra coincidences with normal jitter width are then added to get the desired coincidence rates at the non-@xmath40 settings .",
    "the resulting marginal detection rates are subtracted from the uniform rates @xmath455 and extra detections are then filled in accordingly .",
    "while our implementation required substantial elaboration of the above outline , the success of the strategy is witnessed by the false violation discovered by the conventional coincidence analysis visible in fig .",
    "[ fig : plot80b ] and the empirical auto- and cross - correlation functions shown in fig .",
    "[ fig : plot80c ] .",
    "the figure shows the correlation functions for an lr source that simulates the quantum sources used for the analyses shown in fig .",
    "[ fig : plot80a ] with @xmath456 . in this case , the lr source s apparent coincidence rate at the @xmath40 setting matches the corresponding quantum source s rate .",
    "small deviations from the quantum source s correlation functions are visible in the plots . in practice ,",
    "such deviations are common and therefore hard to distinguish from normal experimental artifacts .",
    "thus , we expect that it would be difficult to find true lr violation in the quantum data , even if its statistics can not be exactly simulated by an lr source . for comparison",
    ", the maximum jitter for which the timetag analysis finds a violation is about @xmath457 .",
    "the estimated correlation functions shown in fig .  [ fig : plot80c ] are determined from binned data as follows : let @xmath156 and @xmath157 be two timetag sequences and @xmath458 a bin width .",
    "let @xmath6 be the total observation period of the timetag sequences and assume that the initial time is @xmath35 .",
    "we construct functions @xmath459 for @xmath460 and @xmath461 by defining @xmath462 to be the number of timetags @xmath441 in @xmath463 with @xmath464 .",
    "the estimated correlation function for @xmath156 and @xmath157 is defined by @xmath465 .",
    "( note that we do not normalize the correlation function . )",
    "the empirical values shown in the figure are the sample means of the @xmath466 over the appropriate pairs of timetag sequences from @xmath467 trials .",
    "note that the autocorrelation functions are of the form @xmath468 and are symmetric about @xmath469 , so only the half with @xmath470 is shown .",
    "we end with a brief note on how an adversary might realize the @xmath98 model of this section .",
    "suppose that the adversary can surreptitiously manipulate the measurement instruments of each party so that the polarization angles of the two settings are approximately orthogonal .",
    "also suppose that the true jitter of the detectors is small but the experimenter does not realize this . in this case",
    ", for each trial , the adversary can randomly generate four timetag sequences according to the @xmath98 model and , for each event in the timetag sequences , send a photon at the event s time to the appropriate party with the polarization that ensures it is only detected at the intended setting . because of the way that the @xmath98 model s timetag sequences are generated , the detections will appear to be detections from photon - pairs with detector jitter .",
    "the manufacturer of the measurement instruments can build - in the features that the adversary needs to exploit in this scenario .",
    "it is therefore unlikely that a protocol relying on a conventional coincidence analysis can achieve device - independent security .",
    "we leave open the question of whether an lr model based on our techniques can be realized by an adversary who can control only the source , when the characteristics of the measurement instruments are fixed and known to the experimenter ."
  ],
  "abstract_text": [
    "<S> a common experimental strategy for demonstrating non - classical correlations is to show violation of a bell inequality by measuring a continuously emitted stream of entangled photon pairs . </S>",
    "<S> the measurements involve the detection of photons by two spatially separated parties . </S>",
    "<S> the detection times are recorded and compared to quantify the violation . </S>",
    "<S> the violation critically depends on determining which detections are coincident . because the recorded detection times have `` jitter '' , coincidences can not be inferred perfectly . in the presence of settings - dependent </S>",
    "<S> timing errors , this can allow a local - realistic system to show apparent violation  the so - called `` coincidence loophole '' .    here </S>",
    "<S> we introduce a family of bell inequalities based on signed , directed distances between the parties sequences of recorded timetags . </S>",
    "<S> given that the timetags are recorded for synchronized , fixed observation periods and that the settings choices are random and independent of the source , violation of these inequalities unambiguously shows non - classical correlations violating local realism . </S>",
    "<S> distance - based bell inequalities are generally useful for two - party configurations where the effective size of the measurement outcome space is large or infinite . </S>",
    "<S> we show how to systematically modify the underlying bell functions to improve the signal to noise ratio and to quantify the significance of the violation . </S>"
  ]
}