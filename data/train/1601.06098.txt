{
  "article_text": [
    "[ [ an - intriguing - discrepancy . ] ] an intriguing discrepancy .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + +    there is an intriguing and longrunning discrepancy in categorical logic between the way conjunction is coupled to implication in cartesian closed categories , and the way existential quantification is coupled to universal quantification in hyperdoctrines . in a cartesian closed category  @xmath1 , every object  @xmath2 induces an adjunction @xmath3 where the implication functor @xmath4 is right adjoint to the conjunction functor @xmath5 this categorical situation should be compared with the way quantification is handled in a hyperdoctrine .",
    "recall that a hyperdoctrine in the sense of lawvere is first of all a ( pseudo ) functor @xmath6 from a base category  @xmath7 to the category @xmath8 of small categories and functors .",
    "the intuition behind this definition is that every object  @xmath2 of the category  @xmath7 is assigned a `` category of predicates '' noted  @xmath9 , and every morphism @xmath10 of @xmath7 induces a functor @xmath11 called `` substitution '' along  @xmath12 .",
    "the leading example of a hyperdoctrine is the `` subset hyperdoctrine '' with basis the category @xmath13 of sets and functions , equipped with the powerset functor  @xmath14 which transports every set @xmath2 to the set  @xmath15 of subsets of  @xmath2 ordered by inclusion .",
    "note that the ordered set @xmath9 is seen here as the ordered category where two subsets @xmath16 are related by a morphism @xmath17 precisely when @xmath18 .",
    "the substitution functor along a function @xmath10 is defined by transporting every subset @xmath19 to its inverse image @xmath20 the definition of a hyperdoctrine then additionally asks for a pair of functors @xmath21 called `` existential quantification '' and `` universal quantification '' along @xmath12 , which are respectively left and right adjoint to the substitution functor : @xmath22 in the case of the subset hyperdoctrine , the functors @xmath23 and @xmath24 transport a subset  @xmath25 to the following subsets of  @xmath26 : @xmath27 the difference between ( [ equation / ccc - adjunction ] ) and ( [ equation / hyperdoctrine - adjunction ] ) is especially notable if one thinks of dependent type theory , where existential quantification provides a dependent form of conjunction , and universal quantification a dependent form of implication .",
    "it is thus puzzling to see conjunction and implication directly coupled by an adjunction in  ( [ equation / ccc - adjunction ] ) while they form in  ( [ equation / hyperdoctrine - adjunction ] ) a `` mnage  trois '' with the substitution functor  @xmath28 as intermediate .    in the present introduction ,",
    "we explain how to reconcile the two points of view in the specific subset hyperdoctrine on @xmath13 .",
    "the choice of this hyperdoctrine is mainly pedagogical : we find clarifying to explain some of our ideas in this familiar example .",
    "however , as we will see , the ideas developed in this introduction lift very smoothly to the more sophisticated situation when one replaces @xmath13 by the cartesian closed category @xmath29 of small categories and functors , and where the `` category of predicates '' @xmath9 over a small category  @xmath2 is defined as the contravariant presheaf category @xmath30.\\ ] ] lawvere introduced this example in his original article on hyperdoctrines @xcite , and also considered its restriction to presheaves over groupoids ( @xmath31 ) in his article describing a treatment of equality in hyperdoctrines , which relied on a `` frobenius reciprocity '' condition and certain beck - chevalley conditions @xcite .",
    "the presheaf hyperdoctrine is an important example despite the fact that it does not in general satisfy these conditions , and indeed , lawvere even writes that this fact < < should not be taken as indicative of a lack of vitality [ ... ] or even of a lack of a satisfactory theory of equality > > for the presheaf hyperdoctrine , but rather < < that we have probably been too naive in defining equality in a manner too closely suggested by the classical conception > > @xcite .",
    "we will come back to this important point later in the introduction .",
    "[ [ from - functions - to - relations . ] ] from functions to relations .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + +    our procedure to reconcile ( [ equation / ccc - adjunction ] ) and ( [ equation / hyperdoctrine - adjunction ] ) is inspired by linear logic and the shift from the cartesian closed category  @xmath32 to the symmetric monoidal closed ( and in fact , compact closed ) category  @xmath33 which underlies its discovery by girard  @xcite . in particular , we will make a great usage of the two `` embedding '' functors @xmath34 which transport a set  @xmath2 to itself , and a function  @xmath10 to the binary relations @xmath35 where @xmath36 notation : we write @xmath37 for a binary relation @xmath38 which defines a morphism @xmath39 in the category  @xmath33 .",
    "these two faithful ( but not full ) functors @xmath40 and @xmath41 transport the category  @xmath32 and its opposite category  @xmath42 in the same category  @xmath33 .",
    "[ [ bifibrations . ] ] bifibrations .",
    "+ + + + + + + + + + + + +    another important ingredient and source of inspiration for our work is the notion of _ bifibration _ which we like to see as a particular instance of _ type refinement system _ in the terminology of  @xcite .",
    "a bifibration may be defined as a functor @xmath43 which is at the same time a fibration and an opfibration .",
    "following the principles and notations of type refinement systems , an object @xmath44 of @xmath45 is said to `` refine '' an object @xmath2 of @xmath7 ( written @xmath46 ) if @xmath47 , while a `` derivation '' of a typing judgment @xmath48 ( where @xmath49 , @xmath46 , and @xmath50 ) is defined as a morphism @xmath51 in the category  @xmath45 whose image by the functor  @xmath52 is the morphism  @xmath12 .",
    "the definition of a bifibration then asserts that the functor ( or `` refinement system '' ) @xmath52 is equipped with operations for pushing or pulling an object of @xmath45 along a morphism of @xmath7 @xmath53 such that there is a one - to - one correspondence of derivations , @xmath54 written here as invertible inference rules in the proof - theoretic style of refinement systems ( see @xcite for details ) .",
    "notably , this structure is sufficient to derive inference rules @xmath55 as well as isomorphisms @xmath56 @xmath57 and a three - way correspondence of derivations : @xmath58 this argument establishes that any ( cloven ) bifibration @xmath59 determines a pair of ( pseudo ) functors @xmath60 as well as a family of adjunctions @xmath61 relating the corresponding functors between the `` fibre '' categories @xmath62 and @xmath63 ( defined as subcategories of @xmath45 containing only those morphisms that project by @xmath52 to identity morphisms in @xmath7 ) .    [ [ a - subset - bifibration - over - sets - and - relations . ] ] a subset bifibration over sets and relations .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    putting these two sources of inspiration together : linear logic and bifibrations , we construct a `` subset bifibration '' @xmath64 where the category @xmath65 has objects the pairs @xmath66 consisting of a set  @xmath2 together with a subset  @xmath25 ; and morphisms @xmath67 defined as the binary relations @xmath37 satisfying the property @xmath68 the functor  @xmath52 transports every object  @xmath66 to the first component  @xmath2 , and every morphism  @xmath69 to the underlying relation @xmath37 .",
    "the category @xmath65 may be seen as a category of `` pointed objects '' in @xmath33 , since an object  @xmath66 is the same thing as a relation @xmath70 , with morphisms defined using the 2-categorical structure of @xmath33 provided by inclusion of binary relations .",
    "the fiber or category of predicates  @xmath71 associated to a set  @xmath2 by the functor  @xmath52 is simply the set @xmath72 of subsets of  @xmath2 ordered by inclusion .",
    "an important point is that the functor  @xmath52 just defined is a bifibration . given a binary relation @xmath73 the two functors @xmath74 are defined in the following way : @xmath75 for all subsets @xmath25 and @xmath19 .",
    "an easy computation shows that @xmath76 and @xmath77 define a pair of adjoint functors @xmath78 because @xmath79 is equivalent to @xmath80 for every @xmath25 and @xmath19 . from this",
    ", we conclude that    the functor @xmath81 is a bifibration .",
    "the associated fibre functor @xmath82 transports every set  @xmath2 to the set @xmath72 of subsets of  @xmath2 ordered by inclusion .    [ [ one - hyperdoctrine - decomposed - into - two - bifibrations . ] ] one hyperdoctrine decomposed into two bifibrations .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the construction of the subset bifibration  @xmath81 on sets and relations leads us to a new way to think about existential and universal quantification in the subset hyperdoctrine  @xmath14 on the category @xmath13 . indeed , given a hyperdoctrine @xmath6",
    "it is always possible to `` decorrelate '' the pair of adjunctions  ( [ equation / hyperdoctrine - adjunction ] ) by defining a pair of ( pseudo ) functors @xmath83 where @xmath84 and where @xmath85 transports every object  @xmath86 to the category @xmath9 and every morphism  @xmath10 to the functor @xmath87",
    "the key observation here is that the left - hand side adjunction @xmath88 of the hyperdoctrine  @xmath52 ensures that @xmath89 determines a bifibration with basis the category  @xmath7 , while the right - hand side adjunction @xmath90 ensures that @xmath85 determines a bifibration with basis the opposite category  @xmath91 . in the case of the subset hyperdoctrine on @xmath13 ,",
    "one obtains in this way two ( pseudo ) functors @xmath92 which provide an alternative and equivalent formulation of the original subset hyperdoctrine  @xmath14 on the category  @xmath32 .",
    "in particular , @xmath89 and @xmath85 determine a pair of bifibrations @xmath93 where the categories @xmath94 and @xmath95 have the same objects defined as pairs @xmath66 consisting of a set  @xmath2 and of a subset  @xmath25 , while the morphisms @xmath96 are defined as the functions @xmath10 satisfying the property @xmath97 in the case of @xmath94 and as the functions @xmath98 satisfying the property @xmath99 in the case of @xmath95 .",
    "note the change of orientation in the definition of the morphisms of @xmath94 and of @xmath95 .",
    "as expected , the functors  @xmath100 and @xmath101 transport every such morphism  @xmath102 to the underlying morphism @xmath10 in the category @xmath32 for the functor  @xmath100 and in the category @xmath42 for the functor  @xmath101 .",
    "[ [ putting - everything - back - together . ] ] putting everything back together .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    a quite extraordinary and instructive phenomenon appears at this point : the two bifibrations  @xmath100 and @xmath101 and thus the hyperdoctrine  @xmath14 on @xmath32 may be recovered from the bifibration  @xmath81 and the two embedding functors : @xmath103 the reason is that , for every function @xmath10 , the following equations hold : @xmath104 for all @xmath25 . from this",
    "follows that @xmath105 by uniqueness of a left or of a right adjoint , these two equations together with ( [ equation / hyperdoctrine - adjunction ] ) and ( [ equation / rel - adjunction ] ) imply the series of equalities : @xmath106 the resulting picture reconciles ( [ equation / ccc - adjunction ] ) and ( [ equation / hyperdoctrine - adjunction ] ) since the original series of adjunctions of a hyperdoctrine  ( [ equation / hyperdoctrine - adjunction ] ) is replaced by a pair of adjunctions @xmath107 living in two different bifibrations @xmath100 and @xmath101 , together with an equality between the two functors @xmath108 and @xmath109",
    ". an interesting outcome of our decomposition of the subset hyperdoctrine  @xmath14 over @xmath32 is that the existential quantification is entirely handled by the bifibration  @xmath100 while the universal quantification is entirely handled by the bifibration  @xmath101 .",
    "the decomposition reveals moreover that the substitution functor @xmath28 of the subset hyperdoctrine is not primitive , since it is the `` superposition '' of the two equal functors @xmath108 and @xmath109 .",
    "formally speaking , recall that every bifibration @xmath110 may be `` pulled back '' along a functor @xmath111 in order to define a bifibration @xmath112 on the category  @xmath1 : @xmath113^ { } \\ar[dddd]_-{q } \\ar@{}[ddddrrrrrrrrrr]|-{pullback } & & & & & & & & & & { \\mathscr{e}}\\ar[dddd]^{p } \\\\ \\\\ & & & & & & & & & & \\\\ \\\\",
    "{ \\mathscr{c}}\\ar[rrrrrrrrrr]^{f } & & & & & & & & & & { \\mathscr{b}}}\\ ] ] whose fibre functor  @xmath114 is simply obtained by precomposing the fibre functor  @xmath14 of the bifibration  @xmath52 with the functor  @xmath115 : @xmath116 in other words , the category of predicates  @xmath117 associated to an object  @xmath2 of the category  @xmath1 coincides with the category of predicates  @xmath118 of its image by the functor  @xmath119 . in the discussion above , we have just established that    [ thm / reconstruction ] the two bifibrations @xmath120 are equal to the bifibration @xmath64 pulled back along the embedding functors @xmath121 and @xmath122 .",
    "this means that there exists a pair of pullback diagrams @xmath123 \\ar[dddd]_-{{{p}^{\\oplus } } } \\ar@{}[ddddrrrrrr]|-{pullback } & & & & & &   { { \\mathbf{rel}_{\\bullet } } } \\ar@{}[ddddrrrrrr]|-{pullback } \\ar[dddd]^{p } & & & & & & { { { { \\mathbf{subset } } } } ^{\\ominus } } \\ar[llllll ] \\ar[dddd]^-{{{p}^{\\ominus } } } \\\\ \\\\ & & & & & & & & & & & & \\\\ \\\\ { { \\mathbf{set } } } \\ar[rrrrrr]^-{{{{\\mathrm{emb}}}^{\\oplus } } }   & & & & & & { { \\mathbf{rel } } } & & & & & & { { \\mathbf{set } } } ^{\\,op }   \\ar[llllll]_-{{{{\\mathrm{emb}}}^{\\ominus } } }   } \\ ] ] which enable us to derive the two bifibrations  @xmath100 and  @xmath101 and thus the subset hyperdoctrine  @xmath14 on the category  @xmath32 of sets and functions , from the subset bifibration  @xmath52 on the category  @xmath33 of sets and relations .    [ [ a - monoidal - closed - refinement - system . ] ] a monoidal closed refinement system .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    now that we have given theoretical precedence to the subset bifibration @xmath81 over the hyperdoctrine @xmath14 on @xmath32 , there remains to study the properties of this bifibration  @xmath52 more closely . in our work on refinement systems , we have advocated the fundamental role played by the interaction between the adjunctions of a monoidal closed refinement system which would be a bifibration at the same time : @xmath124 where @xmath44 is a refinement and @xmath10 a morphism of the basis category . recall that by `` ( symmetric ) monoidal closed refinement system '' , we simply mean a functor @xmath110 where the categories  @xmath45 and @xmath7 are ( symmetric ) monoidal closed and where the functor  @xmath52 preserves the ( symmetric ) monoidal closed structure of  @xmath45 up to coherent isomorphisms .",
    "a primary observation is that    the refinement system @xmath125 is symmetric monoidal closed with tensor product and implication of the category  @xmath65 defined as @xmath126 where the subsets @xmath127 and @xmath128 of @xmath129 are defined as @xmath130    note that the implication @xmath131 in @xmath65 is transported by the functor  @xmath52 to the set @xmath132 which plays the role of internal hom @xmath133 in the compact closed category @xmath134 .",
    "it is very instructive to study how the adjunctions @xmath135 coming from the bifibrational and monoidal closed structure of  @xmath52 interact , for @xmath136 an object of  @xmath65 and @xmath137 a morphism of  @xmath33 .",
    "for instance , one has the equality @xmath138 for all subsets  @xmath25 and @xmath19 and relations @xmath139 , @xmath140 . on the other hand ,",
    "the canonical inclusion @xmath141 is not an equality in general , for subsets  @xmath25 and @xmath19 and relations @xmath142 , @xmath143 .",
    "consider for instance the case where @xmath144 , where the two subsets @xmath145 are not equal for general subsets @xmath146 and @xmath147 .",
    "[ [ monoidal - closed - categories - as - chiralities . ] ] monoidal closed categories as chiralities .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the observation that @xmath65 is a symmetric monoidal closed category leads us to the idea of reformulating it as a `` symmetric monoidal closed chirality '' in the sense of  @xcite .",
    "recall that :    a symmetric monoidal closed chirality @xmath148 is a pair of symmetric monoidal categories @xmath149 equipped with a symmetric monoidal equivalence @xmath150 ^ -{(-)^{\\ast } } & & & & & & & & \\ar@<.5ex>[llllllll]^-{^{\\ast}(- ) } & ( { \\mathscr{b}},{\\varovee},{\\mathbf{false}})^{\\,op(0,1)}}\\ ] ] where the exponent @xmath151 means that the orientation of the tensor product  @xmath152 ( of dimension  0 ) and of the morphisms ( of dimension  1 ) have been reversed ; together with two ( pseudo)actions @xmath153 together with two natural bijections : @xmath154 for @xmath155 and @xmath156 , satisfying moreover two coherence diagram , see @xcite for details .",
    "every symmetric monoidal closed category @xmath157 may be equivalently formulated as the symmetric monoidal closed chirality defined by the pair of opposite categories : @xmath158 the advantage of this formulation is that the intuitionistic implication of the monoidal closed category @xmath159 may be `` decomposed '' in just the same way as in classical logic or in linear logic : @xmath160 where the operation @xmath161 implements an involutive negation , and where the notation @xmath152 reflects the fact that the tensor product of  @xmath7 should be understood as a disjunction .    [",
    "[ bifibrations - as - chiralities . ] ] bifibrations as chiralities .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + +    one main contribution of the paper is to observe that the notion of `` chirality '' may be very elegantly adapted to the notion of bifibration .",
    "a bifibration chirality  @xmath162 is a pair of opfibrations  @xmath52 and  @xmath163 @xmath164 together with a pair of equivalences @xmath165 ^ -{(-)^{\\ast } } & & & & & & \\ar@<.5ex>[llllll]^-{^{\\ast}(- ) } & { \\mathscr{f}}^{{\\,op } } } \\quad\\quad\\quad \\xymatrix @-1.9pc { { \\mathscr{b}}&\\ar@<.5ex>[rrrrrr]^-{(-)^{\\ast } } & & & & & & \\ar@<.5ex>[llllll]^-{^{\\ast}(- ) } & { \\mathscr{c}}^{{\\,op}}}\\ ] ] inducing an equivalence of refinement systems : @xmath166_-{p } \\ar@<.5ex>[rrrrrrrr]^-{(-)^{\\ast } } & & & & & & & & \\ar@<.5ex>[llllllll]^-{^{\\ast}(- ) } { \\mathscr{f}}^{{\\,op}}\\ar[ddddd]^-{q^{\\,op } } \\\\ \\\\ \\\\ \\\\ \\\\ { \\mathscr{b}}\\ar@<.5ex>[rrrrrrrr]^-{(-)^{\\ast } } & & & & & & & & \\ar@<.5ex>[llllllll]^-{^{\\ast}(- ) } { \\mathscr{c}}^{{\\,op}}}\\ ] ]    in a bifibration chirality  @xmath162 , the opfibration @xmath52 is automatically a fibration , where the pullback @xmath167 can be computed as @xmath168 equation ( [ equation / notpushnot - intro ] ) follows from the fact that the pushforward @xmath169 in the opfibration @xmath163 is a pullback in the fibration @xmath170 , and that equivalences of refinement systems preserve pullbacks",
    ". we can also derive it more explicitly in proof - theoretic style , from the invertible inferences @xmath171 the subset bifibration @xmath172 can be formulated as a bifibration chirality  @xmath162 as follows . define @xmath173 to be the category whose objects are subsets @xmath25 , @xmath19 and whose morphisms @xmath174 are binary relations",
    "@xmath175 satisfying the property @xmath176 the category @xmath173 comes equipped with an evident forgetful functor  @xmath177 which defines an opfibration .",
    "we obtain in this way the bifibration chirality : @xmath178_-{p } \\ar@<.5ex>[rrrrrrrr]^-{(-)^{\\ast } } & & & & & & & & \\ar@<.5ex>[llllllll]^-{^{\\ast}(- ) } { { \\mathbf{rel}_{\\circ}^{\\,op } } } \\ar[ddddd]^-{q^{\\,op } } \\\\ \\\\ \\\\ \\\\ \\\\ { { \\mathbf{rel } } } \\ar@<.5ex>[rrrrrrrr]^-{(-)^{\\ast } } & & & & & & & & \\ar@<.5ex>[llllllll]^-{^{\\ast}(- ) } { { \\mathbf{rel } } } ^{{\\,op}}}\\ ] ] where the functor @xmath161 transports a set  @xmath2 and a subset @xmath25 to themselves , and reverses a binary relation  @xmath37 in the expected way : @xmath179 and similarly for @xmath180 .",
    "one obtains the equations    @xmath181    where @xmath37 in both equations and @xmath182 in @xmath52 for equation  ( [ eqn : a ] ) , while @xmath182 in @xmath163 for equation  ( [ eqn : b ] ) .",
    "note that the universal quantifier  @xmath77 of equation  ( [ eqn : a ] ) is computed in  @xmath52 while the universal quantifier  @xmath77 of equation  ( [ eqn : b ] ) is computed in  @xmath163 .    not only that , the category @xmath173 defines together with @xmath65 a symmetric monoidal chirality @xmath183 putting together the bifibration chirality @xmath162 with the symmetric monoidal closed chirality  @xmath148 , we may for instance rewrite equation  ( [ equation / exists - vs - tensor ] ) as the following pair of dual equations :    @xmath184    where @xmath139 , @xmath140 and @xmath185 , @xmath182 in @xmath52 for equation  ( [ eqn : c ] ) while @xmath142 , @xmath143 and @xmath185 , @xmath182 in @xmath163 for equation  ( [ eqn : d ] ) .",
    "this pair of dual formulas is fundamental : in particular , it has the remarkable property of unifying equation  ( [ equation / exists - vs - tensor ] ) with the other equation @xmath186 valid in  @xmath81 and more generally in any bifibration @xmath110 which is at the same time a symmetric monoidal closed refinement system ( see prop  2.4 in @xcite ) . to that purpose , one needs to replace the tensor product  @xmath187 in formula  ( [ eqn : d ] ) by the action of @xmath163 on @xmath52 written ( on purpose ) with the same notation @xmath188 .",
    "understood in this alternative way , the formula  ( [ eqn : d ] ) is not equivalent anymore to equation  ( [ equation / exists - vs - tensor ] ) but to equation  ( [ equation / forall - vs - multimap ] ) where the refinement @xmath128 and change - of - basis morphism  @xmath189 @xmath190 are decomposed in the same way as we did in  ( [ equation / chiral - decomposition ] ) for the implication formula , using the formalism of monoidal closed chiralities : @xmath191 where @xmath139 and @xmath143 and @xmath185 in  @xmath163 , @xmath182 in  @xmath52 . on the other hand ,",
    "we have seen in  ( [ equation / inclusion - not - equality ] ) that we have two canonical morphisms which are not invertible in general :    @xmath192    where @xmath142 , @xmath143 , @xmath185 , @xmath182 in @xmath52 in equation  ( [ eqn : e ] ) and where @xmath139 , @xmath140 , @xmath185 , @xmath182 in @xmath163 in equation  ( [ eqn : f ] )",
    ". one main achievement of our approach is to recover the dualities of linear logic in categorical situations such as the subset hyperdoctrine on  @xmath32 or the presheaf hyperdoctrine on  @xmath8 , which are traditionally seen as intuitionistic .",
    "we will see in particular (  [ section / comparison - with - linear - logic ] ) that the formulas  ( [ eqn : a])([eqn : f ] ) are bifibrational generalisations of familiar distributivity laws of linear logic .",
    "[ [ the - identity - predicate - in - the - subset - bifibration . ] ] the identity predicate in the subset bifibration .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    as defined by lawvere , a hyperdoctrine is a pseudofunctor @xmath193 from a cartesian closed category  @xmath7 whose fibers @xmath9 are themselves cartesian closed categories , and such that every substitution functor @xmath28 has a left adjoint @xmath23 and a right adjoint  @xmath24 . given such a hyperdoctrine @xmath193 , lawvere suggested to define the identity predicate @xmath194 associated to an object  @xmath86 as the terminal object  @xmath195 existentially quantified along the diagonal map @xmath196 , as follows : @xmath197 in the case of the subset hyperdoctrine  @xmath14 , another construction of the identity predicate is possible , starting this time from the subset bifibration  @xmath81 on sets and relations . consider the binary relation @xmath198 obtained by currying the identity relation  @xmath199 , where @xmath200 is the singleton set .",
    "then , define the identity predicate @xmath201 as the singleton subset @xmath202 existentially quantified along  @xmath203 : @xmath204 the identity predicates @xmath205 and @xmath201 coincide in the case of the subset hyperdoctrine , but we will see (  [ section / identity - type ] ) that they differ in the case of the presheaf hyperdoctrine , and that @xmath201 appears to be the appropriate definition in that case .    [ [ plan - of - the - paper . ] ] plan of the paper .",
    "+ + + + + + + + + + + + + + + + + +    after this long and detailed introduction , we explain in  [ section / presheaf - bifibration ] how to adapt smoothly all the results established here for the subset hyperdoctrine on  @xmath32 to the presheaf hyperdoctrine on  @xmath8 .",
    "we then come back to the question of identity in  [ section / identity - type ] , explaining how the definition @xmath201 lifts naturally to the presheaf hyperdoctrine and more generally to any monoidal closed bifibration . in ",
    "[ section / string - diagrams ] we introduce a string diagram notation for presheaves ( highly reminiscent of c.  s.  peirce s `` existential graphs '' for predicate logic ) which is derived from the decomposition of monoidal closed bifibrations as monoidal closed bifibration chiralities .",
    "finally , in  [ section / comparison - with - linear - logic ] we explain in what sense the formulas ( [ eqn : a])([eqn : f ] ) extend to bifibrations some familiar distributivity principles of linear logic .",
    "[ [ related - works . ] ] related works .",
    "+ + + + + + + + + + + + + +    the literature contains several different answers to the question of what exactly it means to combine `` linear logic with bifibrations '' .",
    "the approach that we develop here as well as in prior work @xcite is to consider a functor which is both ( symmetric ) monoidal closed and a bifibration , with these two structures provided independently ( but generating a rich interaction ) .",
    "the same approach is taken in hasegawa s work @xcite on logical predicates for models of linear logic , as well as in katsumata s work on logical predicates for computational effects @xcite .",
    "both build on hermida s thesis @xcite which considered a notion of `` fibred - ccc '' , although a subtle difference with hermida s work is that the latter is phrased in terms of _ fibred adjunctions _",
    "@xcite , meaning that the functors associated to the cartesian closed structure are explicitly required to preserve cartesian morphisms .",
    "that idea can also be seen as the background for birkedal , mgelberg , and petersen s work on linear abadi - plotkin logic @xcite , as well as shulman s definition @xcite of `` monoidal bifibration '' that asks for the tensor product operation @xmath206 of the total category to preserve both cartesian and opcartesian morphisms .",
    "our perspective is that when such preservation properties hold , they should rather be seen as a consequence of an underlying adjunction between refinement systems ( * ? ? ?",
    "most importantly , the requirement that the tensor product operation preserves cartesian morphisms is violated for the key models introduced in this paper , and in general we only have the non - invertible principle ( [ eqn : e ] ) .",
    "in this section , we explain how to adapt to the presheaf hyperdoctrine  @xmath14 on  @xmath8 everything which was established in the introduction for the subset hyperdoctrine  @xmath14 on  @xmath32 .",
    "the first step is to replace the category  @xmath33 by the bicategory @xmath207 ( introduced by bnabou @xcite ) whose objects are small categories @xmath208 , 1-cells @xmath175 are _ distributors _ defined as functors @xmath209 and 2-cells are natural transformations between distributors .",
    "the identity 1-cell @xmath210 is defined as the hom functor @xmath211 , which we denote @xmath212 , and the composition of two distributors @xmath175 and @xmath213 is defined using the coend formula @xmath214 the category  @xmath65 is then replaced by the category  @xmath215 whose objects are the distributors @xmath216 , @xmath217 ( i.e. , contravariant presheaves ) , and whose morphisms @xmath174 are pairs @xmath218 consisting of a distributor @xmath175 and of a natural transformation @xmath219 , which may be depicted as @xmath220_r\\ar[dr]^s & \\\\ a \\ar[rr]_m & \\utwocell<\\omit>{\\alpha } & b}}\\parbox{\\wd0}{\\box0}\\endgroup}}\\ ] ] similarly , the category  @xmath173 is replaced by the category  @xmath221 whose objects are the distributors @xmath222 , @xmath223 ( i.e. , covariant presheaves ) , and whose morphisms @xmath174 are pairs @xmath218 consisting of a distributor @xmath175 together with a natural transformation @xmath224 , which may be depicted as @xmath225^{s } & \\utwocell<\\omit>{\\alpha } & a\\ar[ul]_{r}\\ar[ll]^{m}}}\\parbox{\\wd0}{\\box0}\\endgroup}}\\ ] ] note that @xmath215 and @xmath221 are bicategories just like @xmath207 , but we prefer to consider them as categories for simplicity .",
    "the two obvious functors @xmath226 are opfibrations , and they define together a bifibration chirality , @xmath227_-{p } \\ar@<.5ex>[rrrrrrrr]^-{(-)^{\\ast } } & & & & & & & & \\ar@<.5ex>[llllllll]^-{^{\\ast}(- ) } { { \\mathbf{dist}}_\\circ } ^{{\\,op}}\\ar[ddddd]^-{q^{\\,op } } \\\\ \\\\ \\\\ \\\\ \\\\ { \\mathbf{dist}}\\ar@<.5ex>[rrrrrrrr]^-{(-)^{\\ast } } & & & & & & & & \\ar@<.5ex>[llllllll]^-{^{\\ast}(- ) } { \\mathbf{dist}}^{{\\,op}}}\\ ] ] where the equivalence between @xmath215 and @xmath228 transports every small category  @xmath2 to its opposite category  @xmath229 , every distributor @xmath37 to the opposite distributor @xmath230 defined as the functor @xmath231 and every contravariant presheaf  @xmath70 to the covariant presheaf @xmath232 .",
    "the equivalence between the refinement systems  @xmath52 and @xmath170 follows from the bijective correspondence of 2-cells in  @xmath207 : @xmath220_r\\ar[dr]^s & \\\\ a \\ar[rr]_m & \\utwocell<\\omit > { } & b}}\\parbox{\\wd0}{\\box0}\\endgroup } } \\quad\\leftrightarrow\\quad \\scalebox{1}{{\\begingroup\\setbox0=\\hbox{\\xymatrix{&1 & \\\\ a^{{\\,op}}\\ar[ur]^{r^ * } & \\utwocell<\\omit > { } & b^{{\\,op}}\\ar[ul]_{s^*}\\ar[ll]^{m^*}}}\\parbox{\\wd0}{\\box0}\\endgroup}}\\ ] ] the induced bifibrational structure on @xmath233 may be explicitly defined using coends and ends , as categorical analogues of the corresponding formulas for @xmath234 : @xmath235 the following property is fundamental :    the refinement system @xmath236 is symmetric monoidal closed with tensor product and implication of the category  @xmath215 defined as @xmath237 where @xmath70 and @xmath238 are contravariant presheaves .",
    "note that the implication @xmath128 in @xmath215 is transported by @xmath52 to the implication @xmath133 defined as @xmath239 in the compact closed bicategory  @xmath207 . from this follows that the category @xmath221 together with the category @xmath215 defines a symmetric monoidal closed chirality @xmath240 which thus satisfies formulas  ( [ eqn : a])([eqn : f ] ) stated in the introduction .",
    "now , let us recall that in lawvere s presheaf hyperdoctrine @xmath241\\ ] ] the substitution operation @xmath242 \\quad { \\stackrel{}{\\longrightarrow } } \\quad   [ a^{{\\,op } } , { { \\mathbf{set } } } ] \\ ] ] along a functor @xmath243 is defined by precomposition @xmath244 while the quantifiers",
    "@xmath245 \\quad { \\stackrel{}{\\longrightarrow } } \\quad   [ b^{{\\,op } } , { { \\mathbf{set } } } ] \\ ] ] may be defined as coends / ends : @xmath246 in essentially the same way as we saw earlier for the subset hyperdoctrine over sets , the presheaf hyperdoctrine can be decomposed into a pair of bifibrations @xmath247 where :    * @xmath248 has as objects pairs @xmath66 consisting of a category @xmath2 together with contravariant presheaf @xmath249 , and morphisms @xmath250 consisting of a pair of a functor @xmath243 together with a natural transformation @xmath251 ; * @xmath252 has as objects pairs @xmath66 consisting of a category @xmath2 together with a covariant presheaf @xmath253 , and morphisms @xmath250 consisting of a pair of a functor @xmath254 together with a natural transformation @xmath255 ; * @xmath100 and @xmath101 are the evident projections .",
    "moreover , there are a pair of embedding functors @xmath256 acting as the identity on objects and sending a functor @xmath243 to the respective distributors @xmath257 with the property that    [ thm / reconstruction - presheaves ] the bifibrations @xmath258 and @xmath259 are pullbacks of @xmath260 along the functors @xmath40 and @xmath41 , respectively .",
    "once again , this theorem implies that the triple adjunction @xmath261 of the presheaf hyperdoctrine may be reduced to a pair of adjunctions @xmath262 of the bifibration @xmath260 .",
    "the other important logical ingredient in lawvere s original definition of a hyperdoctrine is the cartesian closed structure of each category of predicates @xmath9 . here",
    "we note that the well - known ccc structure on presheaf categories may be further decomposed using the monoidal closed structure of the presheaf bifibration on distributors , beginning with the following elementary observation ( recalled from @xcite ) :    [ prop : dayconstruction ] if @xmath263 is a monoidal closed refinement system which is also a bifibration , then every monoid @xmath264 in the basis determines a monoidal closed structure on the fiber @xmath62 , where the tensor and implication are defined for all @xmath265 by @xmath266 and the tensor unit is defined by @xmath267 .",
    "every category is a comonoid @xmath268 in @xmath8 , and is hence transported by the functor @xmath41 to a monoid : @xmath269 the fiber of @xmath2 in @xmath260 is thus automatically endowed with a monoidal closed structure by , @xmath270 @xmath271 and it is straightforward to verify using equations ( [ equation/(co)end - formulas ] ) and ( [ equation / pshsmc ] ) that this monoidal closed structure @xmath272 is isomorphic to the usual ccc structure on the presheaf category @xmath273 $ ] .",
    "we now turn to lawvere s abstract definition of the identity predicate @xmath274 in an arbitrary hyperdoctrine @xcite . in the presheaf hyperdoctrine",
    "this definition yields @xmath275 which does not seem to give an appropriate notion of identity ( any pair of objects are `` equated '' so long as they can be completed to a cospan ) , even in the case when the category @xmath2 is a groupoid . lawvere remarked that a more natural choice of generalized `` identity predicate '' on a category @xmath2 within the presheaf hyperdoctrine is the functor @xmath276 .",
    "our first observation is that this version of the identity predicate may be easily defined as a pushforward in the symmetric monoidal closed refinement system @xmath260 by @xmath277 and that more generally we can recover the presheaf associated to a distributor @xmath175 by the formula @xmath278 indeed , this abstract recipe allows us to define the `` graph '' of a morphism @xmath49 in a monoidal closed category @xmath7 with respect to any monoidal closed bifibration @xmath110 @xmath279 where @xmath280 is the monoidal unit of  @xmath45 .",
    "we then have    [ thm : pushpull - canonical ] let @xmath281 be a monoidal closed refinement system which is also a bifibration , and suppose given refinements @xmath46 and @xmath50 in @xmath45 and a morphism @xmath49 in @xmath7 . then there are isomorphisms @xmath282 where @xmath283 is the left evaluation map , and where @xmath284 is the right currying of @xmath285 .",
    "_ both formulas follow easily from distributivity properties discussed in the introduction together with the axioms of monoidal closed categories : @xmath286 equation ( [ equation / push - canonical ] ) may be compared with lawvere s equation @xcite @xmath287 where @xmath288 and @xmath289 are the projection maps and where the graph @xmath290 is defined by substitution along @xmath291 into @xmath292 .",
    "lawvere proved that this equation holds for any hyperdoctrine satisfying frobenius reciprocity and a beck - chevalley condition , but he also explicitly observed that those conditions are violated by the presheaf hyperdoctrine .",
    "on the other hand , equation ( [ equation / pull - canonical ] ) may be thought of as an abstract generalization of yoneda s lemma .",
    "indeed , one can consider the formula in the bifibration @xmath293 , which is also a cartesian closed refinement system @xcite .",
    "taking @xmath294 to be an object of the category @xmath2 , the two sides of ( [ equation / pull - canonical ] ) expand to @xmath295 which is the precise statement of the yoneda lemma .",
    "the prolific american logician charles sanders peirce developed during the late 19th and early 20th centuries a system for representing logical deductions as certain topological surgeries on diagrams he called `` existential graphs . '' a key element of peirce s graphical calculus was the idea of identifying the subject of two predicates by joining them with an arc .",
    "for example , the diagram    expresses that there is something which is both black and a bird ( such as a crow ) .",
    "a second key element of existential graphs was the use of an enclosing curve ( which peirce called a `` cut '' or `` sep '' ) to negate a proposition . thus the diagram    expresses that there does not exist a man who is not mortal , i.e. , that every man is mortal .",
    "similarly , the diagram    expresses that there is some particular bird that every woman s daughter loves ( the most popular bird at the park ) .",
    "geraldine brady and todd trimble gave a categorical interpretation of existential graphs @xcite within joyal and street s framework of _ string diagrams _ for monoidal categories @xcite .",
    "their analysis began with a categorical axiomatization of classical first - order logic in terms of _ boolean hyperdoctrines _ ,",
    "that is , hyperdoctrines with boolean algebra fibers and satisfying the beck - chevalley condition .",
    "they then went on to describe how to interpret the predicates of any such hyperdoctrine as 1-cells in an appropriate compact closed bicategory of boolean - valued relations .    in this part of the paper",
    "we reveal a surprising development of brady and trimble s work , by explaining how the logical structure of the refinement system @xmath260 in combination with its chiral opposite @xmath296 leads in a relatively straightforward way to a string diagram calculus for presheaves that is remarkably reminiscent of peirce s existential graphs  this despite the fact that our `` predicates '' and `` relations '' are by no means boolean - valued !",
    "we will assume that the reader already has some familiarity with string diagrams for monoidal categories in general , and with the standard conventions for compact closed categories ( otherwise , the reader is encouraged to read @xcite for a quick introduction ) .",
    "for example , following those conventions , the diagram @xmath297 represents the distributor @xmath298 obtained by composing distributors @xmath175 , @xmath299 , and @xmath300 in the indicated way .",
    "observe that here we read the diagram from top - to - bottom and left - to - right , while we place labels indicating the underlying categories to the left - hand side of each oriented wire .",
    "more abstractly , in topological terms these conventions can be said to rely on the assumption that the surface in which the diagram of the distributor is embedded ( in this case , the page ) is equipped with an orientation .",
    "to represent a contravariant presheaf @xmath249 seen as a refinement @xmath46 in @xmath260 , we lay it out just as one would an ordinary distributor @xmath216 , but framed by a light blue background to indicate that we view it as an object of @xmath215 .",
    "therefore , the operations of taking the tensor product of presheaves or the pushforward along a distributor , @xmath301 which can be defined respectively in terms of horizontal and vertical composition of 1-cells in @xmath207 , are displayed like so : @xmath302 let us note here that there is a topological interpretation of the refinement relation , in the sense that _ a diagram embedded in a surface refines its boundary .",
    "_ as for implication between presheaves or the pullback along a distributor , @xmath303 we base our conventions on the equations @xmath304 and draw the following diagrams : @xmath305 here the dualization operation @xmath306 and its inverse @xmath307 are being represented as `` functorial boxes '' @xcite , which take the mirror image of the boundary wires across the box from a blue region to a red region and vice versa , while the action @xmath308 is represented by gluing a blue diagram inside a dark red region .",
    "one subtlety is that since the dualization operations reverse the orientation of the tensor product , we must therefore read horizontal juxtaposition in the red region ( corresponding to the action @xmath309 ) running right - to - left rather than left - to - right .",
    "also , it is worth noting that these conventions ensure that inside any red region there is always exactly one boxed ( i.e. , negated ) blue region , which can be seen as a sort of intuitionistic restriction on peirce s system .    we next deduce some equations on the diagrams that are implied by the axioms of a monoidal closed bifibration chirality .",
    "equations between purely positive formulas such as @xmath310 are geometrically manifest using these conventions , just as the axioms of monoidal categories are geometrically manifest using ordinary string diagrams . on the other hand ,",
    "since dualization is an involutive operation , it is also always possible to add or remove an annulus around the diagram of a contravariant or covariant presheaf without changing its meaning : @xmath311 seen in this way , the important distributivity law @xmath312 simply removes an annulus , pushes one component ( @xmath137 ) outside the blue region , and places the annulus back in another location : @xmath313 finally , the two formulas ( [ equation / push - canonical ] ) and ( [ equation / pull - canonical ] ) derived for the identity predicates defined in ",
    "[ section / identity - type ] have the following geometric interpretation : @xmath314 @xmath315 besides capturing isomorphism , one can also express natural transformations between presheaves as certain diagrammatic moves or `` surgeries '' .",
    "the unit and counit of the two families of adjunctions @xmath316 yield directed versions of rule ( [ equation / doublesep ] ) , @xmath317 @xmath318 where rule ( [ equation / evalcoeval ] ) reduces to ( [ equation / doublesep ] ) in the case that @xmath319 , and ( [ equation / unitcounit ] ) to ( [ equation / doublesep ] ) in the case that @xmath320 .",
    "one main benefit of our approach based on chiralities is that it enables us to recover the dualities of classical logic in categorical situations like the subset hyperdoctrine  @xmath14 on  @xmath32 , or the presheaf hyperdoctrine  @xmath14 on  @xmath8 , which are traditionally seen as intuitionistic .",
    "we thus find instructive to explain in what sense the six principles  ( [ eqn : a])([eqn : f ] ) asserted for the monoidal closed bifibration chirality @xmath321 generalise well - known principles of linear logic . to that purpose , we consider a @xmath322-autonomous category @xmath323 with finite products and coproducts and we construct two categories  @xmath324 and  @xmath325 whose objects  @xmath208 are the finite sets seen as discrete categories ; and whose morphisms @xmath37 are @xmath323-valued matrices defined as functors @xmath326 .",
    "composition of @xmath37 and @xmath327 in @xmath324 is defined as @xmath328 whereas composition of @xmath37 and @xmath327 in @xmath325 is defined as @xmath329 @xmath330 is the category whose objects are the @xmath323-valued matrices @xmath70 , @xmath238 , which may be alternatively seen as families @xmath331 or @xmath332 of objects of  @xmath323 ; and whose morphisms @xmath17 are the pairs @xmath218 consisting of a matrix @xmath37 and of a natural transformation @xmath333 , which may be alternatively seen as a family of morphisms living in the category  @xmath323 @xmath334 indexed by the pairs @xmath335 .",
    "similarly , @xmath336 is the category whose objects are matrices @xmath222 , @xmath223  ; and whose morphisms @xmath174 are the pairs @xmath218 consisting of a matrix @xmath175 together with a natural transformation @xmath337 , which may be alternatively seen as families of morphisms living in the category  @xmath323 @xmath338 indexed by the pairs @xmath335 .",
    "the forgetful functors @xmath339 and @xmath340 define a bifibration chirality @xmath341_-{p } \\ar@<.5ex>[rrrrrrrr]^-{(-)^{\\ast } } & & & & & & & & \\ar@<.5ex>[llllllll]^-{^{\\ast}(- ) } { { \\mathbf{mat}_{\\circ } } } ( { \\mathscr{v}})^{\\,op}\\ar[ddddd]^-{q^{\\,op } } \\\\ \\\\ \\\\ \\\\ \\\\ { { \\mathbf{mat}_{\\oplus } } } ( { \\mathscr{v } } ) \\ar@<.5ex>[rrrrrrrr]^-{(-)^{\\ast } } & & & & & & & & \\ar@<.5ex>[llllllll]^-{^{\\ast}(- ) } { { \\mathbf{mat}_{\\ominus } } } ( { \\mathscr{v}})^{\\,op } } \\ ] ] where a finite set  @xmath2 in @xmath330 is transported by @xmath342 to itself : @xmath343 ; where a morphism @xmath37 of @xmath344 is transported to the morphism @xmath345 in @xmath346 obtained by flipping the inputs @xmath2 and @xmath26 and by applying pointwise negation in @xmath323 : @xmath347 and where the object @xmath348 in @xmath349 is defined by pointwise negation in @xmath323 : @xmath350 the fact that @xmath162 define a bifibration chirality follows from the existence of the natural bijection @xmath351 in the @xmath322-autonomous category  @xmath323 .",
    "given a @xmath323-valued matrix @xmath37 , the existential quantification of @xmath70 along  @xmath137 and the universal quantification of @xmath352 along @xmath37 in the bifibration @xmath52 are given by the formulas @xmath353 @xmath354 the bifibration chirality @xmath162 is also monoidal closed , with conjunction and disjunction defined pointwise : @xmath355 where @xmath185 and @xmath182 . in this specific monoidal",
    "closed bifibration chirality  @xmath162 , the formulas ( [ eqn : a])([eqn : f ] ) enable us to recover familiar principles of linear logic :          jean bnabou .",
    "distributors at work .",
    "notes from a course at tu darmstadt in june 2000 , taken by thomas streicher .",
    "lars birkedal , rasmus e. mgelberg , rasmus l. petersen . category - theoretic models of linear abadi & plotkin logic . _",
    "theory and applications of categories _ , 20:7 , 2008 , 116151 .",
    "geraldine brady and todd h. trimble . a string diagram calculus for predicate logic and c. s. peirce s system beta .",
    "1998 november 8 ; revised 2000 june 22 .",
    "unpublished manuscript .",
    "masahito hasegawa .",
    "categorical glueing and logical predicates for models of linear logic .",
    "technical report rims-1223 , research institute for mathematical sciences , kyoto university , 1999 .",
    "paul - andr mellis and noam zeilberger .",
    "functors are type refinement systems .",
    "popl 2015 .",
    "paul - andr mellis and noam zeilberger .",
    "an isbell duality theorem for type refinement systems .",
    "july 31 , 2015 ."
  ],
  "abstract_text": [
    "<S> combining insights from the study of type refinement systems and of monoidal closed chiralities , we show how to reconstruct lawvere s hyperdoctrine of presheaves using a full and faithful embedding into a monoidal closed bifibration living now over the compact closed category of small categories and distributors . </S>",
    "<S> besides revealing dualities which are not immediately apparent in the traditional presentation of the presheaf hyperdoctrine , this reconstruction leads us to an axiomatic treatment of directed equality predicates ( modelled by @xmath0 presheaves ) , realizing a vision initially set out by lawvere ( 1970 ) . </S>",
    "<S> it also leads to a simple calculus of string diagrams ( representing presheaves ) that is highly reminiscent of c.  s.  peirce s existential graphs for predicate logic , refining an earlier interpretation of existential graphs in terms of boolean hyperdoctrines by brady and trimble . </S>",
    "<S> finally , we illustrate how this work extends to a bifibrational setting a number of fundamental ideas of linear logic . </S>"
  ]
}