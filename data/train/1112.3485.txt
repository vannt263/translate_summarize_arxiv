{
  "article_text": [
    "uncertainty relations can be established in any physical theory involving random conjugated variables characterized by probability distribution functions . the present paper deals with uncertainty relations in statistical mechanics .",
    "statistical mechanics combines equilibrium thermodynamics with a probability postulate @xcite . following the standard gibbs ensemble theory , in the microcanonical ensemble it is assumed that all mechanical variables are constrained to a fixed value ( or are allowed to vary within a fixed small range ) , while their entropy - conjugated variables are free to fluctuate .",
    "other ensembles ( canonical , grand - canonical , ... ) are introduced by relaxing the constraint on one or more mechanical variables .",
    "this is done by assuming that these mechanical variables can be exchanged with a reservoir , which is defined as a macroscopic body of dimensions much larger than those of the system .",
    "the exchange is supposed to be controlled by parameters ( which are characteristic of the reservoir ) that are identified as intensive variables .",
    "formally , the change of variables when passing from the microcanonical to other ensembles is undertaken via legendre transforms . in the spirit of equilibrium thermodynamics ,",
    "the intensive variables are assumed to have the same value both in the reservoir and in the system and are usually treated as non - fluctuating variables .",
    "therefore , within this basic framework , uncertainty relations are not expected to apply @xcite .",
    "while it seems reasonable that intensive variables of a very large reservoir ( a system characterized by large amounts of mechanical variables ) are treated as non - fluctuating variables , there is no reason for such an assumption when dealing with intensive variables corresponding to a small reservoir or system .",
    "therefore , we will adopt the point of view that , in general , for a system in contact with a reservoir ( regardless of size ) fluctuations of intensive variables should occur in the system induced by the fluctuations of the corresponding conjugated mechanical variables . from this point of view , uncertainty relations are expected to play an important role for a correct understanding of the behaviour of equilibrium fluctuations of thermodynamic variables , with consequences in the experimental measurements of these variables .",
    "actually this simple picture has received some experimental support @xcite and thus it is reasonable to ask whether or not uncertainty relations can be formulated and what their applicability limits are .",
    "the problem was already discussed by bohr and heisenberg as soon as heisenberg proposed the _ uncertainty principle _ in quantum mechanics @xcite .",
    "therefore , during the last century a number of papers were published dealing with this problem .",
    "an interesting article where these issues have been reviewed is the paper by uffink and van lith @xcite .",
    "more recently , velzquez and curilef @xcite revisited the problem within the framework discussed some years before by mandelbrot @xcite , gilmore @xcite and others .",
    "the vast majority of these works have been formulated from a purely theoretical point of view , and applications to particular examples ( analytical or numerical ) are scarce . the aim of the present paper is to numerically analyze the validity of uncertainty relations in two simple lattice models and shed some light on controversial interpretations @xcite    the paper is organized as follows . in section [ sec : relations ] we summarize a derivation of the uncertainty relations in statistical mechanics . in section [ sec : examples ] we numerically analyze two examples corresponding to an ising paramagnet and an ising ferromagnet .",
    "finally , in section [ sec : conclusions ] we discuss the relevance of the results in relation to temperature measurements in small thermodynamic systems and draw some conclusions .",
    "following the mathematical treatment proposed in ref .",
    ", let us consider a continuous probability distribution , @xmath0 , defined within the domain @xmath1 , which is assumed to vanish at the boundary @xmath2 .",
    "the average value of the derivative of any analytical function @xmath3 with respect to one of the components of @xmath4 , can be expressed as :    @xmath5    where we have defined the affinities : @xmath6 two interesting particular cases of the result in ( [ eq : result1 ] ) can be obtained by choosing @xmath7 and @xmath8 . in the first case one gets @xmath9 and in the second case @xmath10 let us now define the differences : @xmath11 @xmath12 the variances @xmath13 and the covariances @xmath14 of arbitrary differences @xmath15 and @xmath16 can be interpreted as a scalar products in a vectorial space where the metric is given by the probability distribution . in particular ,",
    "the square root of the variance @xmath17 of a random variable @xmath18 ( which we will denote as the fluctuation of @xmath18 ) is the norm of the vector @xmath15 in this metric .",
    "therefore , in our case , taking into account the schwartz inequality , we can write : @xmath19 from ( [ eq : term1 ] ) and ( [ eq : term2 ] ) , the right - hand - side term can be expressed as : @xmath20 thus , we obtain an inequality relating the variances of the variable @xmath21 and the affinity @xmath22 : @xmath23 it is worth noting that other authors have used different mathematical approaches @xcite to treat this problem .      in this subsection",
    "we will discuss how to apply the results obtained above in order to establish uncertainty relations in statistical mechanics .",
    "actually , the key point will be to find a convenient definition of the set @xmath24 , the probabilities @xmath25 and the affinities @xmath26 .",
    "we proceed by dividing an isolated universe into two interacting parts that can exchange one or more mechanical variables .",
    "one part ( usually the smallest one , which we wish to study ) will be called the `` system '' , while the other part will be the `` reservoir '' . for the closed universe we assume boltzmann equiprobability and therefore its entropy will be given by : @xmath27 where @xmath28 is the total number of microstates of the universe and @xmath29 is the boltzmann constant .",
    "let us consider the set @xmath24 of mechanical variables describing the system @xmath30 .",
    "the corresponding variables for the universe @xmath31 are constant ( closed ) .",
    "therefore , for the reservoir we have @xmath32 .",
    "from knowledge of the number of microstates of the universe @xmath33 for which the system variables take values within @xmath34 we can determine the probability density : @xmath35 where @xmath36 is an elementary volume in @xmath24 that will be irrelevant for further developments .",
    "it is introduced here in order to have consistent units . assuming that this probability density @xmath37 is a finite function , eq .",
    "( [ eq : distribution ] ) can be written in terms of a _ universe dimensionless entropy _ which depends on the system variables : @xmath38\\ ] ] therefore we have @xmath39 which is none other than einstein s formula for fluctuations @xcite . at this point , without making any assumptions about the separability of the function @xmath40 , we can define the affinities between the system and reservoir as the partial derivative : @xmath41 note that @xmath26 has units inverse of those of @xmath42 since @xmath43 is dimensionless . in some cases",
    ", it can be assumed that @xmath40 can be split into a part related to the entropy of the studied system , @xmath44 , and a part related to the reservoir , @xmath45 , so that @xmath46 since functions @xmath44 and @xmath45 only depend on the internal structure of the corresponding parts , it then seems natural to define intensive variables for the system and reservoir in analogy with thermodynamics : @xmath47 therefore , assuming separability , the affinity can be expressed as : @xmath48    the results derived in subsection [ subsec : math ] can now be written in terms of the preceding definitions . without assuming separability , from eq .",
    "( [ eq : term1 ] ) we get : @xmath49 and from the inequality relation in ( [ eq : resultatbo ] ) , we can write : @xmath50 when separability holds , equations ( [ eq : equilibri ] ) and ( [ eq : resultatest])become @xmath51 and @xmath52 respectively .",
    "these are the main results that we will numerically test in the examples in section [ sec : examples ] .",
    "note that for the particular case of choosing energy as a mechanical variable , in the separable case , the above two equations read : @xmath53 and @xmath54 where we have used the more common symbols @xmath55 and @xmath56 to represent the intensive variables conjugated for the energy of the system and reservoir .",
    "equations ( [ eq : equilibri ] ) , ( [ eq : equilibri2 ] ) or ( [ eq : betes ] ) are essentially probabilistic versions of the zero - th principle of thermodynamics @xcite . because of the fluctuations of the system and reservoir , the equilibrium conditions are not an absolute equality , but only apply to statistical averages of the intensive variables .",
    "it is important to note that with the separability assumption the conjugated variables of a system appear as functions of extensive variables of the same system ( as in thermodynamics ) and that the same happens when the roles of the system and reservoir are interchanged .",
    "equations ( [ eq : resultatest ] ) , ( [ eq : resultatest2 ] ) or ( [ eq : energ ] ) state that fluctuations in conjugated thermodynamic variables are related in a form which is similar to the uncertainty relations in quantum mechanics .",
    "these results are usually referred to as uncertainty relations in statistical physics and , even though their interpretation in quantum mechanics is different , they both come from the same mathematical base , as noted in ref .   .",
    "at this point it is convenient to point out that the previous results were obtained after neglecting the contribution from the boundary @xmath2 in eq .",
    "( [ eq : result1 ] ) and after considering a continuous character for the variables @xmath42 describing the system .",
    "therefore , the uncertainty relation ( [ eq : resultatest ] ) and the equilibrium condition ( [ eq : equilibri ] ) may not hold if states with extreme values of the variables @xmath42 ( at the boundary @xmath57 ) are likely to occur .",
    "such states will be called boundary states and in the following examples , that have a discrete character , it will be important to evaluate their probability and check under which circumstances they become too high .",
    "let us consider a universe in which the dimensionless entropy @xmath43 can be separated between the system and reservoir and we focus only on the energy of the system @xmath58 as a mechanical variable .",
    "let us assume that @xmath43 or equivalently , the continuous probability density @xmath59 , is centred about a maximum at @xmath60 .",
    "we also require that the function @xmath43 has no other maxima , which is a typical situation in statistical mechanics , far from phase transition points .",
    "exactly at the maximum we have @xmath61 ( otherwise it would not be extremal )",
    ". fluctuations of @xmath62 about zero are related to how much the system fluctuates near the point @xmath60 .",
    "[ fig1 ] shows a schematic representation of this situation .",
    "the plot above shows the probability of the energy fluctuations .",
    "the entropies of the system , the reservoir and the universe are shown in the middle diagram . at the bottom",
    "we show the derivatives of the entropies corresponding to @xmath55 , @xmath56 and @xmath63 .",
    "the arrows indicate the width of the fluctuations of the energy and the inverse temperatures .",
    "if the probability density becomes narrower , energy fluctuations will decrease , but @xmath43 will have a more pronounced maximum .",
    "this means that the slope of @xmath64 ( blue line in the bottom diagram ) increases and consequently the affinity will have larger fluctuations .",
    "if energy fluctuations are small enough we can expand the function @xmath65 about the point @xmath60 .",
    "a first - order approximation gives : @xmath66 where we have taken into account the fact that @xmath67 is fixed and we have defined : @xmath68 which plays the role of an inverse joint heat capacity .",
    "indeed the plots shown in fig .",
    "[ fig1 ] correspond to such a first - order approximation , where the probability is gaussian , the entropy densities are parabolas and the inverse temperatures and affinity behave linearly .    note that within this first - order approximation , condition ( [ eq : betes ] ) yields @xmath69 .",
    "besides , the fact that @xmath70 makes ( [ eq : energ ] ) an equalty ( it is indeed a property of the schwartz inequality ) .",
    "thus , replacing ( [ eq : linealitz ] ) into ( [ eq : energ ] ) , we find @xmath71 hence @xmath72^{-1}\\ ] ]    if we define the system heat capacity @xmath73 and the reservoir heat capacity @xmath74 as @xmath75 @xmath76 where @xmath77 stands for the equilibrium temperature , we get : @xmath78 which is essentially the same result obtained by lindhart , as discussed in ref .  , but seen from within a different framework . at the same order of approximation we can compute : @xmath79 @xmath80 @xmath81 @xmath82    from the previous equations , for an infinite reservoir ( @xmath83 ) we obtain the expected results @xmath84 @xmath85 @xmath86 @xmath87 @xmath88      even though many macroscopic systems can be studied as continuous , their nature is usually discrete , and , therefore , equations ( [ eq : equilibri ] ) and ( [ eq : resultatest ] ) should be seen as approximations .",
    "we will now discuss how to deal with discrete systems .",
    "the main difficulty in the application of equation ( [ eq : resultatest ] ) to discrete systems , is how derivatives should be taken in the definition of intensive variables .",
    "we must consider , not only the problem of finding whether defining forward , backward or central derivatives can affect the result , but we must also take into account the fact that @xmath89 and @xmath90 have different corresponding discrete expressions .",
    "let us discuss two possible definitions .",
    "if we consider the second part of eq .",
    "( [ eq : theaffinity ] ) a possible ( centred ) definition of @xmath62 is @xmath91 which is separable if the probability @xmath92 factorizes .",
    "nevertheless this prescription also raises some problems : since the logarithm goes to minus infinity as probability goes to zero , one must be really careful at the edges of the domain and change the centred prescription to backwards and forward prescriptions .",
    "an alternative definition of @xmath93 is the one suggested from the first part of eq .",
    "( [ eq : theaffinity ] ) : @xmath94 this definition is not separable as a product of terms for the system and the reservoir , not even when the probability factorizes . as a consequence",
    ", the concept of intensive variables can not be thought of as a property of a single system . instead , in this case , we shall deal with affinities that are a property of each pair of systems in equilibrium . in the first example in the next section [ sec : examples ] we will compare the results obtained with the two prescriptions in order to evaluate",
    "how much the choice can affect the results for small systems .",
    "in order to discuss the applicability of the above expressions , we will test them in two numerically treatable examples : a non - interacting lattice system ( paramagnetic ising system ) and an interacting lattice system ( ferromagnetic ising system ) .",
    "we will focus on the validity of expressions ( [ eq : equilibri ] ) and ( [ eq : resultatest ] ) for various universe sizes , various system sizes within each universe and different values for the extensive fixed variables of the universe .",
    "our aim is to deepen our understanding of the validity of these equations .",
    "let us firstly analyze the validity of the formalism developed above for a model without interaction .",
    "we shall consider a universe consisting of @xmath95 non - interacting spins @xmath96 that can take two values @xmath97 , depending on whether they are parallel or antiparallel to an external field @xmath98 ( which is a fixed parameter of the model ) .",
    "the hamiltonian is given by @xmath99 .",
    "since the universe is isolated ( constant energy ) the number of spins @xmath100 in the @xmath101 state and the number of spins @xmath102 in the @xmath103 state ( fulfilling @xmath104 ) are fixed .",
    "therefore , the number of possible configurations of the universe is given by : @xmath105 we now consider a partition of the whole universe into the two sets : the system and the reservoir so that @xmath106 .",
    "we will choose the number of spins @xmath107 in the @xmath101 state in the system as the internal variable of interest in this example ( this choice gives simpler expressions than choosing the energy ) .",
    "its probability function will be given by : @xmath108 where @xmath95 , @xmath100 and @xmath109 are parameters .",
    "note that the variable @xmath107 ranges between the extremes corresponding to its minimum value given by @xmath110 and its maximum value given by @xmath111 . using the probability function ( [ probparamagnet ] ) we can explicitly compute the average value @xmath112 and its variance as @xmath113    for illustrative purposes , in this first example we compute the probability for the system to reach boundary states @xmath114 .",
    "[ fig2 ] shows the value of this probability for two universes of sizes @xmath115 and @xmath116 as a function of @xmath100 and for different values of the system size @xmath109 .",
    "this result shows that the probability of the boundary states departs from zero when the system or reservoir are too small and when the value of @xmath117 is too close to its extremes and this fact constrains the number of available states in the system .",
    "so far there has been no need to take one of the prescriptions described in section [ subsec : discrete ] .",
    "however , in order to perform the study of the conjugated intensive variables we must now choose one of the prescriptions .",
    "the first proposed option , according to eq .",
    "( [ eq : afinitatlog ] ) , enables us to benefit from the separation of the entropy density .",
    "as the spins are non - interacting , when we define the entropy using the logarithm and neglect irrelevant constants , it can be trivially separated as : @xmath118 with @xmath119 and @xmath120    to estimate the intensive variables of the system ( @xmath121 ) and reservoir ( @xmath122 ) we approximate the derivatives of @xmath44 and @xmath123 by a finite difference scheme .",
    "since the variable @xmath107 is bounded , we will use central differences everywhere except at the extremes , where we will use forward or backwards differences .",
    "thus : @xmath124 and @xmath125 fig .",
    "[ fig3 ] shows the difference @xmath126 as a function of @xmath100 , for universes of sizes @xmath127 ( left panel ) and @xmath128 ( right panel ) and different system sizes @xmath109 ( ranging from @xmath129 to @xmath130 ) .",
    "notice that the roles of the system and reservoir are , in this case , symmetric .",
    "as can be seen , the difference @xmath131 vanishes when @xmath132 ( which determines the available energy ) is not close to its upper or lower extremes .",
    "it is clearly observed that the range of validity of the result in eq .",
    "( [ eq : equilibri2 ] ) increases when the system size @xmath109 approaches half the universe size @xmath130 , since we have more available states and therefore the importance of the boundary states on the computed averages decreases .",
    "[ fig4 ] shows the test of the uncertainty relation ( [ eq : resultatest2 ] ) as a function of the total number of up spins @xmath100 . for @xmath115 and @xmath116 , and different values of @xmath109 .",
    "similar conclusions to those observed in fig .",
    "[ fig3 ] can be deduced : when @xmath109 and @xmath100 are far from their boundary values , the uncertainty relation is fulfilled .",
    "only when the fluctuating variable @xmath107 is strongly constrained to a tiny number of states by the system size @xmath109 or the available fixed universe energy @xmath100 , do the surface terms neglected in the derivation of the uncertainty relation play a role and the bound is broken .",
    "alternatively , we can study the second method proposed for discrete systems and define the joint affinity @xmath62 as in eq .",
    "( [ eq : afinitatdisc ] ) . in this case , however , it is not possible to separate @xmath62 into two terms , one corresponding to the system and another one corresponding to the reservoir . numerical computation for the same cases studied before allows us to plot the results shown in figs .",
    "[ fig5 ] and [ fig6 ] . the same qualitative results concerning the validity of ( [ eq : equilibri ] ) and ( [ eq : resultatest ] ) can be concluded .",
    "note that the values of @xmath133 in fig .",
    "[ fig5 ] are smaller than those in fig .",
    "therefore , for discrete systems , the choice of the approximation method discussed in section [ subsec : discrete ] may affect the results from a quantitative point of view , even in such a simple case .      in this second example we study the case of a discrete system with interactions . since interaction can induce correlations ,",
    "in this case we should not assume that the entropy density @xmath43 is separable and thus we should restrict ourselves to only testing the validity for equations ( [ eq : equilibri ] ) and ( [ eq : resultatest ] ) .",
    "let us consider a universe consisting of an ising model on a two- dimensional square lattice with size @xmath134 , with nearest - neighbour interactions and periodic boundary conditions .",
    "the system of interest will be a rectangular subset of spins with size @xmath135 . even though a general treatment requires the simultaneous analysis of energy and magnetization fluctuations , in the absence of an external field",
    ", it is enough to analyse only the energy .",
    "the hamiltonian of the universe reads @xmath136 where @xmath137 are the spin variables and the sum extends over all the @xmath138 nearest - neighbour pairs of the universe .",
    "note that the energy of the universe will be discretized in steps @xmath139 and ranges from @xmath140 to @xmath138 for any given configuration , the evaluation of the energy of the system will be done by considering that the energy associated with the bonds along the boundary of the system is equally divided between the system and reservoir .",
    "therefore , the energy of the system is discretized in steps @xmath141 .    in order to perform a microcanonical analysis of the averages at constant @xmath67",
    "we have used the following procedure .",
    "we have randomly generated spin configurations and classified them according to the universe energy .",
    "inside the set corresponding to the same value of @xmath67 we have computed the fraction of configurations that correspond to every possible value of the energy @xmath58 of the system and performed a statistical estimation of its probability @xmath142 .",
    "it is important to note that , because of the finite size of the random sample of states that we have generated ( @xmath143 configurations ) , we do not obtain states with an _ a priori _ small but non - zero probability .",
    "this means that there is a certain number of possible values of @xmath58 for which we wrongly estimate zero probability . as the logarithmic prescription ( [ eq : afinitatlog ] )",
    "discussed in [ subsec : discrete ] would give problems with infinities at the neighbouring values , we have only used the second prescription given by eq .",
    "( [ eq : afinitatdisc ] ) . even in this second case , in order to avoid problems with the computation of the variance of @xmath62 ( for which a @xmath144 survives in the denominator ) , the states with an estimated zero probability have been excluded : it is as if they could not be reached by the system .",
    "figures [ fig7 ] and [ fig8 ] show the results obtained for simulations of a @xmath145 and a @xmath146 universe , for various sizes of the system .",
    "these are qualitatively compatible with those obtained for the system without interactions in sec .",
    "[ subsec : example1 ] .",
    "the uncertainty relations are fulfilled except in the very extreme case in which the number of available states of the system and/or reservoir is so small that the boundary effects are dominant .",
    "we have shown that uncertainty relations can be established in statistical mechanics when considering a universe ( isolated from the outer world ) separated into two parts , called the system and reservoir , which are in thermodynamic equilibrium and interact by exchanging `` mechanical properties '' such as energy , volume , particles , ... if @xmath42 is one of these properties corresponding to the system , we have found that the following inequality must be satisfied , @xmath147 . here , @xmath26 is an affinity conjugated to the variable @xmath42 which determines the departure from strict equilibrium of actual microscopic configurations of the two interacting systems and which satisfies @xmath148 .",
    "furthermore , when the entropy satisfies separability , these affinities simply reduce to the difference @xmath149 of the intensive variable conjugated to @xmath42 , in the reservoir and the system .    assuming that the intensive variable of the reservoir does not fluctuate as expected for very large reservoirs",
    ", the proposed inequality reduces to the more standard uncertainty relation involving only system variables @xmath150 furthermore , assuming that the fluctuations in the system are small , by expanding to first order , the uncertainty relation leads to the following equality : @xmath151 it is interesting to point out , than within this first - order approximation , when the relevant conjugated variables are the energy and the inverse temperature , combining eqs .",
    "( [ eq : lindhart ] ) and ( [ eq : lindhart4 ] ) , one gets : @xmath152 where @xmath73 and @xmath74 are the heat capacities of the system and reservoir . therefore , in this last case fluctuations of inverse temperature are not , in general , expected to be proportional to energy fluctuations @xcite . only in the limit",
    "@xmath153 is the standard result @xmath154 recovered .",
    "the derivation of the above results has required the assumption that the probability for the boundary states ( on the boundary of the set of mechanical variables @xmath24 ) vanishes .",
    "this assumption , which is reasonable for universes described by continuum variables , might be incorrect for the discrete case , when universes are small or too constrained .",
    "we have numerically studied the validity of the above results in two different mechano - statistical lattice systems : the ising paramagnet and the ising ferromagnet .",
    "we have found that the uncertainty relations hold except in the case in which the boundary states have a high probability of occurring . in particular , from the examples in section [ sec : examples ] , we can numerically evaluate a bound for this probability .",
    "[ fig9 ] shows the uncertainty product @xmath155 against the probability of the boundary states for the ising paramagnet ( with the two possible definitions of the affinities for discrete systems given by eqs .",
    "( [ eq : afinitatlog ] ) and ( [ eq : afinitatdisc ] ) ) and the ising ferromagnet .",
    "the figure clearly shows that the breakdown of the uncertainity relation may occur only when the probability of the boundary states is above 0.01 . in all the other cases ,",
    "the uncertainty product is larger than one and , in fact , tends to 1 from above when the size of the universe increases , as can be seen in the inset of fig.[fig9 ] .",
    "these results are relevant from an experimental point of view .",
    "focusing on the case of the energy @xmath58 and the inverse of temperature @xmath55 as conjugated variables , we can identify the reservoir with a given body and the system with the thermometer used to measure its temperature .",
    "commonly , the thermometer is chosen so that it has a heat capacity much smaller than the heat capacity of the body . however , for small bodies , when the heat capacity of the thermometer and the body are comparable , the results derived here must be taken into account : ( i ) the inverse temperature @xmath156 measured by the thermometer con strongly fluctuate , but still its average value must be identified with the average of the inverse temperature of the body @xmath157 ; and ( ii ) the fluctuations of the difference",
    "@xmath64 should be related to the energy fluctuations through the proposed uncertainty relation .    future extensions of this work will deal with the analysis of systems described by continuous variables , where direct counting of states is not straightforward .",
    "the results will be presented elsewhere .",
    "this work has received financial support from the spanish ministry of innovation and science ( project mat2010 - 15114 ) .",
    "g.t . acknowledges a grant from the university of barcelona .",
    "we thank a.saxena for a critical reading of the manuscript ."
  ],
  "abstract_text": [
    "<S> we have analyzed the validity of uncertainty relations between the fluctuations of thermodynamically conjugated extensive and intensive variables within the field of statistical mechanics . </S>",
    "<S> analysis is presented for two particular examples of small lattice systems that are in contact with reservoirs of comparable sizes : an ising paramagnet and an ising ferromagnet . </S>",
    "<S> the numerical results enable determination of the range of applicablity of the proposed relations . due to the fact that the examples correspond to systems described by discrete variables , the uncertainty relations are not valid if the probability of boundary states is too high . </S>"
  ]
}