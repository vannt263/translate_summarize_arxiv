{
  "article_text": [
    "there are important questions which could be addressed through simulated maps of the microwave sky .",
    "how well can we recover the angular power spectrum of the cosmic microwave background ( cmb ) and the cosmological parameters from maps of a given experiment , which can have holes and regions with non - uniform sampling ?",
    "how well can we subtract foregrounds from a multifrequency map ?",
    "an important issue for small angular scale simulations is their great computational cost .",
    "it is important to have fast and accurate methods to do simulations .",
    "this paper is concerned with the comparison of two of these methods .",
    "large - scale simulations of the microwave sky are based on the expansion of the temperature contrast in spherical harmonics , ( , ) = _",
    "l=1^l_max_m =- l^m=+l a_lmy_lm ( , ) . typically @xmath5 in cobe - like maps , since the number of coefficients , @xmath6 , to be calculated is @xmath7 , and there are questions of numerical accuracy in high order calculations . in order to make high resolution maps  resolutions @xmath8 @xmath9 must be of order @xmath10 so that the number of coefficients to be calculated is of order @xmath11 ; moreover , the @xmath11 spherical harmonics must be evaluated accurately in roughly @xmath11 locations in a full - sky map ( @xmath12 locations in a @xmath13 field ) .",
    "thus , for high angular resolution , the spherical harmonic expansion becomes difficult even with modern computing power .",
    "although simulations based on spherical harmonics are feasible ( hinshaw , bennett & kogut 1995 ; kogut , hinshaw & bennett 1995 ; jungman et al .",
    "1995 ) , the fast fourier transform ( fft ) is shown to be useful in order to make simulations efficiently on small angular scales .",
    "hereafter , simulations using spherical harmonics are called `` sh simulations '' , while those based on plane waves are called `` fft simulations '' .",
    "the main goal of this paper is the comparison of the accuracies and the cpu costs corresponding to sh and fft simulations .",
    "both approaches use the @xmath14 quantities corresponding to the model described in sec .  2 .",
    "the method used to extract the angular power spectra from the simulated maps is described in sec .",
    "fft simulations are described in sec .  4 , while sh simulations are presented in sec .  5 .",
    "comparisons between fft and sh simulations are given in sec .",
    "6 and , finally , sec .",
    "7 contains the main results and a general discussion .",
    "all the simulations presented in this paper are based on a single cold dark matter ( cdm ) model for large scale structure formation . in this simple cdm model ,",
    "no reionization modifies the cmb anisotropies , the background is flat ( @xmath15 ) , the cosmological constant vanishes , scalar fluctuations are gaussian , their spectrum is scale - invariant , and tensor fluctuations are absent .",
    "this model is hereafter called the minimal cdm model .",
    "the free parameters of this model are : the amplitude of the angular power spectrum of the cmb , the density parameter of the baryonic matter @xmath16 and the reduced hubble constant @xmath17 .",
    "the parameters @xmath16 and @xmath17 are involved in the transfer function ; their values are assumed to be @xmath18 and @xmath19 , respectively .    in the above model",
    ", the normalization of the angular power spectrum is fixed by to rms quadrupole of the cmb anisotropy generated by scalar modes by using the estimator @xmath20 found by fitting the observed temperature fluctuations assuming a scale - invariant primordial density power spectrum . in the absence of tensor modes , experiments measuring at large angular scales , such as cobe ( smoot et al .",
    "1992 , bennett et al .",
    "1992 , wright et al . 1992 ) and tenerife ( hancock et al . 1994 ) , provide estimations of @xmath20 .",
    "the @xmath21 coefficients have been taken from sugiyama ( 1995 ) and renormalized according to the four - year cobe data ( @xmath22 , gorski et al .",
    "all the simulations performed in this paper are based on these @xmath21 coefficients .",
    "in this section , we describe the method used in order to extract the angular power spectrum from a given map .",
    "let us give some useful definitions .",
    "the autocorrelation function can be defined as @xmath23 , where c_()= ( ) _ ( _ 1 ) ( ) _ ( _ 2 )  .",
    "the angle between the unit vectors @xmath24 and @xmath25 is @xmath26 .",
    "the angular brackets stand for the mean over many full realizations of the cmb sky .",
    "the quantity @xmath27 is the temperature contrast in the direction @xmath28 after smoothing with a gaussian beam described by @xmath29 .",
    "function @xmath30 can be expanded in the following form : c_()= _ = 2^ ( 2 + 1)c _ p _ ( ) e^(- + 0.5)^2 ^2 . where the @xmath21 quantities define the power spectrum of the cmb .",
    "these quantities have been calculated in many theoretical models of structure formation .    from eq .",
    "( 3 ) one easily obtains the relation : c _ ( ) = e^(- + 0.5)^2 ^2 c _ = _ 0^ c _ ( ) p _ ( ) d  .    given a simulated map , the function @xmath30 is obtained by using eq .",
    "( 2 ) . for each value of @xmath26 , many pairs of direction vectors ( @xmath24 , @xmath25)forming a fixed angle @xmath26are randomly chosen . to be more precise",
    ", the direction vector @xmath24 is chosen to point at a random node of the map  where the temperature is known  while the direction @xmath25 is randomly placed on a cone centered on the node corresponding to @xmath24 .",
    "the half - width of this cone is @xmath26 .",
    "the temperature corresponding to the direction @xmath25 is obtained by interpolating between neighboring nodes . as discussed below",
    ", mathematical interpolation introduces only a small error in the resulting spectrum for values of @xmath26 lying in the interval ( @xmath31 , @xmath32 ) , where @xmath31 is the angle separating two neighboring nodes and @xmath32 is an angle to be experimentally obtained .",
    "this angle must be : ( a ) smaller than the size of the simulated region in order to allow us to place a great number of pairs ( @xmath24 , @xmath25 ) inside it , and ( b ) large enough to include as many scales as possible .",
    "since we know the values of the function @xmath30 only interval ( @xmath31 , @xmath32 ) , we can not compute @xmath33 .",
    "instead , we have calculated the quantities d _ ( ) = _ _ min^_max c _ ( ) p _ ( ) d  .",
    "these quantities are to be compared with the corresponding theoretical ones , which can be obtained as follows : first , from sugiyama s @xmath21 coefficients of the minimal cdm model and from eq .",
    "( 3 ) ( with the sum extended from @xmath34 to @xmath35 ) , the autocorrelation function is estimated in the interval ( @xmath31 , @xmath32 ) .",
    "this theoretical autocorrelation function plus eq .",
    "( 5 ) then allows us to compute the theoretical values of @xmath36 .",
    "it is hereafter said that the quantities @xmath36 define the _ modified power spectrum _ , which is different from the true angular power spectrum given by the coefficients @xmath37 .    in all the simulations we are considering in this paper ,",
    "the following values have been selected : @xmath38 , @xmath39 and @xmath40 .",
    "these values are similar to those of modern projects for the detection of small angular scale anisotropies .    a very accurate estimation of the mean involved in eq .",
    "( 2 ) requires multiple realizations of the microwave sky . in the case of a single full realization ,",
    "a certain error in this mean  producing an error in @xmath30is unavoidable .",
    "this error is usually measured by the cosmic sample variance",
    ". the smaller the sky coverage , the greater the errors in the resulting autocorrelation functions and spectra ( scott , srednicki & white , 1994 ) .",
    "as shown below , the spectra resulting from a small @xmath41 coverage are rather different than the theoretical ones .",
    "although coverages greater than @xmath41 can not be achieved by using fft simulations , we can use multiple disconnected @xmath41 regions in order to improve on the estimate of the mean involved in eq .",
    "( 2 ) , for values of @xmath26 smaller than @xmath32 . in other words ,",
    "fft simulations become useful as a result of the fact that various independent small coverages of the sky can be used in order to obtain a good estimate of the autocorrelation function for small angular scales ; however , neither a @xmath41 map nor an ensemble of them has good information about angular correlations larger than @xmath32 .",
    "our fft simulations are based on the use of the standard @xmath21 coefficients , which have already been calculated for many cases . as pointed out by bond and efstathiou ( 1987 ) ,",
    "a fft simulation is only possible in the case of anisotropies corresponding to large @xmath42-values and small regions of the sky .",
    "a quantitative study of the validity and usefulness of this type of simulation has not previously been presented . in order to do this study",
    ", we compare results from fft simulations with results from sh simulations .",
    "the temperature contrast in the simulated region can be obtained from the following formula : ( , ) = _",
    "s_1,s_2=-n^n d(_1,_2 ) e^-i(_1 + _ 2 ) where @xmath43 and @xmath44 , @xmath45 being the angular size of the elemental square .",
    "the distribution of the quantities @xmath46 is assumed to be gaussian , with zero mean and with variance @xmath47 , where @xmath48 .",
    "the quantities @xmath46 satisfy the relation @xmath49 .",
    "the use of plane waves requires negligible spatial curvature in the simulated regions .",
    "this restricts our simulations to small parts of the microwave sky . in this paper",
    ", it is verified that a region of @xmath41 ( @xmath50 1% of the total sky ) can be successfully mapped by using the fft .",
    "the value @xmath51 is marginally compatible with the size of this region ( many pairs ( @xmath24 , @xmath25 ) forming an angle of @xmath52 can be located inside it ) .",
    "an angular scale of @xmath52 corresponds to @xmath53 and , consequently , the spectra obtained from @xmath41 fft simulations is only estimated for @xmath54 . in practice , the accuracy in the estimation of the power spectrum from these simulations seems to be good for @xmath55 ( see sec .",
    "6 ) .    in a @xmath41 region ,",
    "the assumption of flatness produces a deformation of the true maps , but this deformation is not expected to hide their main features .",
    "we remind the reader that only correlations at scales smaller than @xmath52 are being estimated and , on these scales , the curvature is clearly negligible .    since the ft involves periodic boundary conditions , our simulations are not physically significant at all points of the elemental square .",
    "only the simulation of the central region is physically admissible . on account of this fact ,",
    "fourier transforms are performed in a large @xmath56 square ( @xmath57 ) and the resulting simulation is truncated to the central @xmath58 region",
    ". the curvature could be important if we wanted to get a physically significant mapping of the large square ; however , the large square is only an auxiliary element without any physical significance .",
    "the number of points on each edge of the large square is taken to be 2n=512 .",
    "this choice corresponds to @xmath59 .",
    "simulations using an @xmath60 square with 1024 points per edge yield similar results ; hence , the use of more than 512 points per edge is not necessary .    on an ibm 30 - 9021 vf ,",
    "the cpu cost of our fortran code is @xmath61 minutes per simulation .",
    "figure ( 1 ) shows a fft simulation of a @xmath58 region .",
    "no unusual features are apparent near the edges .",
    "the numbers appearing in this figure are the minimum and maximum values of the temperature contrast in our simulation . only a few points of the simulation approach these values .",
    "our sh simulations are based on eq .",
    "( 1 ) with @xmath62 and @xmath63 .",
    "the @xmath64 coefficients have been generated as statistically independent random numbers with variance @xmath65 and zero mean .",
    "the spherical harmonics have been carefully calculated .",
    "these simulations include scales smaller than those considered in previous simulations ( see hinshaw , bennett & kogut 1995 ; kogut , hinshaw & bennett 1995 ; jungman et al .",
    "the small values of @xmath31 and @xmath66 considered in our simulations require the use of large values of @xmath42 giving information about small angular scales .    in this paper ,",
    "sh simulations are performed only for comparison with fft simulations ; for this reason , some features of our numerical sh simulations are identical to those of the fft simulations of sec .",
    "in particular , our sh simulations are extended to @xmath41 regions of the sky .",
    "these regions are assumed to be uniformly covered and the number of points per edge is 256 ( @xmath59 ) .",
    "a smoothing corresponding to @xmath67 has been performed , and the angle @xmath51 has been assumed .",
    "simulations of the two kinds defined up to now have been obtained for the minimal cdm model .",
    "the @xmath21 coefficients have been obtained and normalized as detailed in sec .  2 .    on an ibm 30 - 9021 vf ,",
    "the cpu cost of our fortran code is @xmath68 minutes per simulation .",
    "this cost is about ten times greater than that of the fft simulations described in sec .",
    "sh simulations of @xmath58 regions look like the fft simulation of fig .",
    "1 . differences between sh and fft simulations can be noticed only by comparing the spectra obtained from them .",
    "these comparisons are discussed in the next section .",
    "let us now compare the theoretical @xmath36 quantities with those obtained from fft and sh simulations .    in all the panels of fig .",
    "( 2 ) , the solid lines correspond to the modified theoretical spectrum and the dashed lines show the modified spectrum obtained from simulations .",
    "the left ( right ) panels of this figure show the modified spectra extracted from fft ( sh ) simulations .",
    "the top , intermediate , and bottom panels exhibit the modified spectra obtained from 1 , 13 , and 52 small simulations of @xmath41 regions , respectively .",
    "the total area covered by the 1 , 13 , and 52 small simulations is 400 , 5400 , and 21600 ( @xmath69 of the full sky area ) squared degrees , respectively .",
    "hereafter , @xmath70 stands for the number of @xmath41 simulations .    in order to measure the deviations between the theoretical and simulated spectra in each case ,",
    "the following quantities have been calculated and presented in table 1 : the mean , @xmath71 , of the quantities @xmath72 ( column 3 ) ; the mean , @xmath73 , of the differences between the theoretical and simulated values of these quantities ( column 4 ) ; the typical deviation , @xmath74 , of the same ( column 5 ) ; and the mean , @xmath75 , of the absolute value of these differences ( column 6 ) .",
    "these quantities are estimated in appropriate @xmath42 intervals ( column 7 ) .    as can be seen from the top panel of fig .  2 and from entries 1 and 2 of table 1 ( see @xmath75 and @xmath74 )",
    ", a single @xmath41 map leads to a poor estimation of the angular spectrum in both fft and sh simulations .",
    "a greater sky coverage is necessary .",
    "the intermediate panels of fig .  2 and entries 3 and 4 of table 1 prove that the use of thirteen @xmath41 maps strongly improves on the resulting spectra ( see @xmath75 and @xmath74 ) .",
    "the quantities @xmath75 and @xmath74 decrease as @xmath70 increases .",
    "the total decrease undergone by ma and @xmath74 as @xmath70 goes from 1 to 13 ( see the top and intermediate panels of fig . 2 and entries 14 of table 1 ) is larger than that appearing as @xmath70 increases from 13 to 52 ( see the intermediate and bottom panels of fig . 2 and entries 36 of table 1 ) . the quantity @xmath73 is of order @xmath76 whatever the value of @xmath70 may be .",
    "the absolute value of @xmath73 is always much smaller than that of @xmath75 ; this means that the deviations between the theoretical and the simulated spectra are essentially oscillatory .",
    "this fact strongly supports the idea that moderate coverages could give good spectra after removing oscillations .",
    "the above results can be independently obtained from both sh and fft simulations .",
    "for @xmath77 and the @xmath42-interval ( @xmath78 ) , the quantities @xmath79 , @xmath75 , and @xmath74 corresponding to fft simulations are greater than those of sh simulations ( compare entries 7 and 8 of table 1 ) .",
    "this means that , for @xmath80 , sh simulations are preferable ( in spite of their large cpu cost ) .",
    "the above results have been verified in other realizations of fft and sh simulations corresponding to the @xmath70 values 1 , 13 and 52 ; however , only one set of realizations is presented ( fig .",
    "2 ) for the sake of brevity .",
    "although this paper is devoted primarily to the comparison of fft and sh simulations in the absence of noise , the effect of uncorrelated noise at the level of @xmath81 in a @xmath41 region has been estimated . in order to do this ,",
    "a @xmath41 simulation involving only uncorrelated noise has been made .",
    "the spectrum has been obtained from the resulting map following the prescriptions of sec .",
    "the quantities @xmath72 appear to be smaller than @xmath76 for all @xmath42 .",
    "these values are negligible compared to those corresponding to the fluctuations of the microwave background ( see fig .",
    "( 2 ) ; @xmath82 ) .",
    "this proves that the effect of uncorrelated noise in our @xmath41 maps can be neglected .",
    "this fact has been verified by superimposing the above white noise map upon a sh map .",
    "the spectra obtained from the resulting map is practically the same as in the absence of noise .",
    "small scale simulations of the microwave background are expected to be very useful in order to analyze observational data from both current and future experiments . for scales",
    "smaller ( greater ) than @xmath83 ( @xmath84 ) , the accuracy of the fft simulations appears to be comparable to ( worse than ) that of the sh simulations .",
    "the cpu cost of the sh simulations is about ten times greater than that of the fft simulations .",
    "these conclusions strongly support the use of fft simulations as a fast and accurate tool leading to very good spectra in the case of small angular scales ( @xmath85 ) .",
    "there are various sources of the deviations between the theoretical spectrum and the spectrum extracted from fft simulations .",
    "significant contributions to these deviations are expected from partial coverage , boundary conditions in fft maps , and the use of mathematical interpolation in order to assign a temperature contrast to the direction @xmath25 ( see sec .",
    "such interpolation introduces non - physical information even for the most sophisticated interpolation methods . an error in the resulting spectrum associated with this fact seems to be unavoidable .",
    "fortunately , this error appears to be small from @xmath31 to @xmath32 .",
    "boundary effects associated with the fft have been minimized by simulating the core of an auxiliary @xmath86 region .",
    "numerical computations were carried out at both the lawrence berkeley laboratory and the computational center of valencia university .",
    "d.s . wishes to thank p. andreu for useful discussions and the conselleria de cultura educacio i ciencia de la generalitat valenciana for a grant .",
    "this work was partially supported by the project gv-2207/94 .",
    "* references * + bennett , c.l .",
    "et al . , 1992 ,",
    "apj , 396 , l7 + bond , j.r . & efstathiou , g. , 1987 , mnras , 226 , 655 + grski et al , 1996 , astro - ph/9601063 , submitted to apj .",
    "letters + hancock , s. , et al .",
    ", 1994 , nature , 367 , 333 + hinshaw , g. , bennett , c.l .",
    ", & kogut , a. , 1995 , apj , 441 , l1 + jungman , g. , kamionkowski , m. , kosowsky , a. & spergel , d.n . , 1995 , astro - ph/9512139 + kogut , a. , hinshaw , g. & bennett , c.l . , 1995 , apj , 441 , l5 + scott , d. , srednicki , m. & white , m. , 1994 , apj , 421 , l5 + smoot , g.f .",
    "et al . , 1992 , apj , 396 , l1 + sugiyama , n. , 1995 , apj supplement , 100 , 281 + wright , e.l .",
    "et al . , 1992 ,",
    "apj , 396 , l13 +      ccccccc + type of & & & & & & + simulations & @xmath70 & @xmath71 & @xmath73 & @xmath74 & @xmath75 & @xmath42-interval + fft & 1 & @xmath87 & @xmath88 & @xmath89 & @xmath90 & @xmath91 + sh & 1 & @xmath87 & @xmath92 & @xmath93 & @xmath94 & @xmath91 + fft & 13 & @xmath87 & @xmath95 & @xmath96 & @xmath97 & @xmath91 + sh & 13 & @xmath87 & @xmath98 & @xmath99 & @xmath100 & @xmath91 + fft & 52 & @xmath87 & @xmath101 & @xmath102 & @xmath103 & @xmath91 + sh & 52 & @xmath87 & @xmath104 & @xmath105 & @xmath106 & @xmath91 + fft & 52 & @xmath107 & @xmath108 & @xmath109 & @xmath110 & @xmath111 + sh & 52 & @xmath107 & @xmath112 & @xmath113 & @xmath114 & @xmath111 +   +      * fig",
    "fft simulation of a @xmath41 region of the microwave sky .",
    "numbers correspond to the minimum and maximum values of the temperature contrast .",
    "0.5 cm * fig .",
    "* each panel shows the quantity @xmath115 as a function of log(@xmath42 ) in various cases .",
    "in all the panels , the solid line shows the theoretical modified power spectrum and the dashed line shows the modified spectrum extracted from simulations .",
    "all the modified spectra have been obtained for @xmath116 , @xmath38 , and @xmath117 .",
    "top , intermediate , and bottom panels correspond to the @xmath70 values 1 , 13 , and 52 , respectively .",
    "left ( right ) panels show modified spectra obtained from fft ( sh ) simulations . 0.5 cm"
  ],
  "abstract_text": [
    "<S> we describe and compare two types of microwave sky simulations which are good for small angular scales . </S>",
    "<S> the first type uses expansions in spherical harmonics , and the second one is based on plane waves and the fast fourier transform . </S>",
    "<S> the angular power spectrum is extracted from maps corresponding to both types of simulations , and the resulting spectra are appropriately compared . in this way , the features and usefulness of fourier simulations are pointed out . for @xmath0 , all the simulations lead to similar accuracies ; however , the cpu cost of fourier simulations is @xmath1 times smaller than that for spherical harmonic simulations . for @xmath2 , </S>",
    "<S> the simulations based on spherical harmonics seem to be preferable .    </S>",
    "<S> -.5 in 0.0 in 0.0 in 8.5 in 0.5 in    = 25pt    * small angular scale simulations * * of the microwave sky *    @xmath3 departamento de astronoma y astrofsica , universidad de valencia , burjassot , valencia , spain + @xmath4 lawrence berkeley laboratory , space science laboratory , cfpa , bldg 50 - 204 , university of california , berkeley ca 94720 .    </S>",
    "<S> e - mail : diego.saez@uv.es +    _ subject headings : _ cosmic microwave background  cosmology : theory  large - scale structure of the universe </S>"
  ]
}