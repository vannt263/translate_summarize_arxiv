{
  "article_text": [
    "a well - mixed chemically reacting system in a container of volume @xmath0 is described , at time @xmath1 , by its @xmath2-dimensional state vector @xmath3 , \\label{statevector}\\ ] ] where @xmath2 is the number of chemical species in the system and @xmath4 , @xmath5 , is the number of molecules of the @xmath6-th chemical species at time @xmath1 . assuming that the chemical system is subject to @xmath7 chemical reactions @xmath8 the time evolution of the state vector @xmath9 can be simulated by the gillespie ssa  @xcite which is described in table [ ssatable ] . here ,",
    "@xmath10 and @xmath11 are stoichiometric coefficients and @xmath12 step [ * 1 * ] of the algorithm in table [ ssatable ] requires to specify propensity functions which are , for mass - action reaction kinetics , given by @xmath13   \\prod_{i=1}^n   ( \\nu_{j , i}^- ) !",
    "\\binom{x_i}{\\nu_{j , i}^- } , \\quad j=1,2,\\dots , m . \\label{propensityfunctions}\\ ] ]    given the values of the propensity functions , the waiting time to the next reaction is given by : @xmath14 and @xmath15)$ ] .",
    "the gillespie ssa in table [ ssatable ] is an exact method , in that the trajectories simulated using this algorithm evolve exactly as described by the corresponding chemical master equation ( cme ) .",
    "equivalent and more efficient formulations of the gillespie ssa have been developed in the literature  @xcite . however , in certain circumstances they can still be very computationally intensive . for instance , if the system that is being simulated has some reactions which are likely to occur many times on a timescale for which others are unlikely to happen at all , then a lot of computational effort is spent on simulating the fast reactions , when a modeller may well be more interested in the results of the slow reactions  @xcite . in this paper , we will focus on approximate algorithms for such fast - slow systems .",
    "we refer to reactions which have high average propensities , and whose reactions may occur many times on a time scale for which others are unlikely to happen at all , as fast reactions .",
    "slow reactions are those reactions which are not fast reactions . in reality , there may be several different timescales present in the reactions of a particular system , but for simplicity we assume there is a simple dichotomy  @xcite",
    ". we may be interested in analysing the dynamics of the `` slow variable(s ) '' , which are chemical species ( or linear combinations of the species ) which are invariant to the fast reactions , and therefore are changing on a slower timescale  @xcite .",
    "efforts have been made to accelerate the gillespie ssa for multiscale systems .",
    "the nested stochastic simulation algorithm ( nssa ) is such a method  @xcite .",
    "the reactions are split into `` fast '' and `` slow '' reactions .",
    "the idea of the nssa is to approximate the effective propensities of the slow reactions in order to compute trajectories only on the slow state space .",
    "this is done by using short bursts of stochastic simulation of the fast reaction subsystem .",
    "the slow - scale stochastic simulation algorithm ( ssssa )  @xcite comes from a similar philosophy . instead of using stochastic simulations to estimate the effective propensities of the slow reactions , they are instead found by solving the cme for the fast reactions ( whilst ignoring the slow reactions ) .",
    "this has the advantage that it does not require any monte carlo integration , however it is limited to those systems for which the cme can be solved or well approximated for the fast subsystem , which may not be applicable to some complex biologically relevant systems .",
    "both of these methods use a quasi - steady state approximation ( qssa ) in order to speed up the simulation of a trajectory on the slow state space  @xcite .",
    "another approach is to approximate the dynamics of the slow variable by a stochastic differential equation ( sde ) .",
    "one can either use short bursts of the gillespie ssa on a range of points on the slow state space to approximate the effective drift and diffusion of the slow variable  @xcite or the constrained multiscale algorithm ( cma )  @xcite which utilises a modified ssa that constrains the trajectories it computes to a particular point on the slow state space .",
    "these algorithms can be further extended to automatic detection of slow variables  @xcite , but , in this paper , we assume that the division of state space into slow and fast variables is a priori known and fixed during the whole simulation .",
    "the advantage of the sde approximation methods  @xcite , is that the estimation of the drift and diffusion terms can be easily parallelised , giving each process a subset of the grid points on the slow state space .",
    "this means that if a user has access to high performance computing facilities , then the analysis of a given system can be computed relatively quickly .",
    "this is not the case for trajectory - based methods .",
    "one could run many trajectories in parallel  @xcite , however if the aim is to analyse slow behaviours such as rare switches between stable regions , each trajectory will still have to be simulated for a long time before such a switch is possible , regardless of the number of trajectories being computed simultaneously .    in this paper , we take the approach that we would like to approximate the dynamics of the slow variable @xmath16 by a continuous sde , in the same vein as other previous works  @xcite .",
    "we wish to estimate the effective drift @xmath17 and diffusion matrix @xmath18 of the slow variable , resulting in approximate dynamics given by : @xmath19 here @xmath20 denotes standard canonical brownian motion in @xmath2 dimensions . in this paper",
    "we will focus on examples where the slow variable is one dimensional , although these results can be extended to higher dimensions  @xcite .",
    "the one - dimensional fokker - planck equation ( fpe ) corresponding to sde ( [ eq : sde ] ) is given by : @xmath21 - v(s)p(s , t ) \\right ) .\\label{eq : fpe}\\ ] ]    in section [ sec : exist ] we introduce five methods for simulation of multiscale stochastic chemical systems , including two novel approaches : the nested multiscale algorithm ( nma ) in section [ sec : nma ] and the quasi - steady state multiscale algorithm ( qssma ) in section [ sec : qssma ] . in section [ sec : lin ] we compare the efficiency and accuracy of the cma , nma and qssma for a simple linear system , for which we have an analytical solution for the cme .",
    "then in section [ bistsection ] we apply cma , nma and qssma to a bimodal example .",
    "finally , we discuss the relative accuracy and efficiency of these methods against others proposed in the literature and summarise our conclusions in section [ sec : conc ] .",
    "we review three algorithms ( cma , nssa and ssssa ) previously studied in the literature in sections [ sec : cma]-[sec : ssssa ] . in section [ sec : nma ] we introduce the nma , which combines ideas from the cma and the nssa .",
    "the qssma is then introduced in section [ sec : qssma ] .",
    "the cma is a numerical method for the approximation of the slow dynamics of a well - mixed chemical system by a sde , of the form which is for a one - dimensional slow variable @xmath22 written as follows : @xmath23    the effective drift @xmath0 and effective diffusion @xmath18 at a given point @xmath24 on the slow manifold are estimated using a short stochastic simulation .",
    "this simulation ( called the constrained ssa , cssa ) is similar to that seen in the gillespie ssa for the full system , although it is constrained to a particular value of the slow variable @xmath22 .",
    "the cssa is given in table [ cssa table ] where @xmath25 is the vector of fast variables and @xmath22 is the slow variable .    to estimate the effective drift and diffusion ,",
    "statistics are collected about the type and frequency of the changes @xmath26 of the slow variable which is reset in step * [ 4 ] * of the cssa . for a simulation of length @xmath27 ,",
    "the estimations are given by @xmath28 where @xmath29 is the change in @xmath22 due to the @xmath30-th iteration of the cssa before the reset is made in step [ * 4 * ] , @xmath27 is the chosen length of cssa simulation , and @xmath31 is the number of iterations of the cssa that are made up to time @xmath27 .    by computing these quantities over a range of values of the slow variable , approximations can then be found , using standard methods , to the solution of the steady - state fokker planck equation for the sde with drift @xmath0 and diffusion @xmath18 .",
    "the nssa  @xcite is a method for the reduction of computational complexity of simulating the slow dynamics of a multiscale chemical system .",
    "the reactions in the system are partitioned into fast reactions @xmath32 and slow reactions @xmath33 , where @xmath34 is the total number of different reactions .",
    "we are interested in the occurrences of the slow reactions , but the computational effort is dominated by the simulation of the fast reactions in the standard ssa given in table [ ssatable ] . however , some / all of the slow reactions are dependent on the value of the fast variables . in the nssa , the effective propensities of the slow reactions are estimated by using short simulations of only the fast reactions . using these effective propensities ,",
    "the gillespie algorithm can be applied to just the slow reactions . in systems for which the qssa is reasonable ,",
    "this algorithm can simulate trajectories of the slow variables at a fraction of the computational cost of the full gillespie ssa .",
    "it effectively reduces the system to a lower dimensional chemical system where all of the reactions are `` slow '' , with reaction rates estimated ( where required ) using relatively short bursts of stochastic simulation of the fast reactions from the full system .",
    "the ssssa  @xcite similarly aims to reduce the full system to a system which contains only the slow reactions . in this algorithm ,",
    "the effective propensities are calculated not by stochastic simulation , as in the nssa , but through application of the qssa .",
    "for some classes of fast sub - systems , the effective propensity can be explicitly calculated . for others",
    ", the value can be approximated using formulae given in  @xcite . since there is no requirement to simulate the fast sub - system as in the nssa , the speed - up in simulation of trajectories as compared with the gillespie algorithm is very large . in some cases non - linear equations",
    "may need to be solved to find the first or second moments of the value of the fast quantities , using newton s method , but even in the worst case scenario the overall computational cost is far less than monte carlo sampling .      the nma is a new method , which allows for efficient approximation of multiscale systems by a sde . as in the cma ,",
    "our aim is to approximate values for the effective drift and diffusion of the slow variables within the system on a set of grid points . at each grid point",
    ", we simulate the fast sub - system , which allows us to approximate the effective propensities for the slow reaction . the drift and diffusion terms are then given by the chemical fpe  @xcite for the system with only the slow reactions present , with the values for the effective propensities substituted in .",
    "for example , say we have @xmath35 slow reactions , with effective propensities @xmath36 , and with stoichiometric vectors @xmath37 . here",
    "@xmath37 is the change in the slow variable due to the reaction @xmath38 . in the case",
    "that the slow variable is the @xmath39th chemical species , then @xmath40 , but it may be more complex if the slow variable depends on several chemical species . then , for a 1-dimensional slow variable , the drift @xmath0 and diffusion @xmath18 are given by : @xmath41    the nma has the advantage over the cma that it converges on the timescale of the fast variables , whereas the cma converges on the timescale of the slow variables .",
    "the qssma follows a similar theme as the nma , except this time we use the methodology of  @xcite to approximate the effective propensity functions .",
    "a qssa is used to derive the value of these functions , as in the slow - scale ssa ( as detailed in section [ sec : ssssa ] ) .",
    "once the effective propensities have been calculated , the formulae ( [ effdrift])([effdiff ] ) for the drift @xmath0 and diffusion @xmath18 can once again be used to approximate the dynamics of the slow variable by a sde of the form ( [ eq : sde1d ] ) .",
    "the qssma does not require any stochastic simulation in order to estimate the effective drift and diffusion functions , and thus we see remarkable speed - ups when compared with the cma .",
    "however , as with the nma , other errors come into play that are not present in the approximations arising from the cma .",
    "in this section , we aim to test the efficiency and accuracy of the three schemes ( the cma , and the newly proposed nma and ssma ) . to test the algorithms ,",
    "we choose a simple multiscale system of two chemical species @xmath42 and @xmath43 in a reactor of volume @xmath0 undergoing the following four reactions : @xmath44 we will study this system for large values of parameter @xmath45 then reactions @xmath46 and @xmath47 , occur many times on a timescale for which reactions @xmath48 and @xmath49 are unlikely to happen at all . in such a regime , one might consider using multiscale methods to reduce the computational cost of analysing the system .",
    "the slow quantity in this system is @xmath50 .",
    "note that this quantity is invariant with respect to the fast reactions , and so only changes when either of slow reactions ( @xmath48 or @xmath49 ) occur .",
    "the analytical solution of the steady state cme is given by the following multivariate poisson distribution  @xcite : @xmath51,\\ ] ] where @xmath52 and @xmath53 let @xmath54 be the poisson distribution with rate @xmath55 which is defined by its probability mass function @xmath56 using ( [ eq : poisson ] ) , we obtain that the exact distribution of the slow variable @xmath50 is @xmath57 in the rest of this section , we use ( [ eq : slow ] ) to compare the accuracy and efficiency of the cma , nma and ssma .",
    "each of the three algorithms gives us a different method to approximate the effective drift and diffusion of the slow variable at a given point on the slow manifold . for each method",
    "there are several sources of error , and in this section we aim to identify the effect of each , for each method .",
    "the nma and qssma both assume that the reactions can be partitioned into fast and slow reactions .",
    "both of these methods rely on the assumption that the fast reactions enter equilibrium on a much faster ( or even instantaneous ) timescale in comparison with the slow reactions .",
    "this assumption leads to the approximation that the dynamics of the slow variables can be described well by a system consisting only of the slow reactions .",
    "for example , we assume that the variable @xmath58 in the system can be well approximated by the system : @xmath59 the two methods ( nma and qssma ) differ in their calculation of the effective reaction rates , @xmath60 and @xmath61 .",
    "we denote the effective propensities for these two reactions @xmath62 and @xmath63 respectively .",
    "we will now isolate the error that is incurred by approximation of the full system by the reduced system written in terms of the slow variables .",
    "slow reaction @xmath48 does not depend on the value of the fast variables .",
    "consequently , we have @xmath64 the second effective rate @xmath61 in ( [ eq : eff ] ) has to be calculated , because reaction @xmath49 includes fast variables .",
    "the average values of @xmath42 and @xmath43 for the fast system ( reactions @xmath46 and @xmath47 in ) , for a given value of @xmath65 , is  @xcite @xmath66 therefore , we have @xmath67 the probability density of @xmath22 is then given by the poisson distribution @xmath68 we define the error incurred by the qssa by @xmath69 comparing ( [ eq : slow ] ) and ( [ eq : slowapprox ] ) , we have @xmath70 therefore error ( [ eq : err ] ) can be approximated for large @xmath71 by @xmath72 figure [ figure1](a ) shows error ( [ eq : err ] ) a function of @xmath73 .",
    "this plot confirms that this error decays like @xmath74 as @xmath73 increases ( gradient of linear part of plot is equal to @xmath75 ) .",
    "4.685 cm -5.6 mm 4.685 cm -5.6 mm    the limitations of the stochastic quasi - steady - state approximation are looked at in detail in  @xcite .",
    "one of the sources of the error , common across all of three methods ( cma , nma , qssma ) , is that we are approximating a markov jump process which has a discrete state space ( the non - negative integers ) , by a sde with a continuous state space ( the positive real numbers ) . to see the effect of this ,",
    "let us consider the simple birth - death chemical system ( [ eq : eff ] ) .",
    "the steady state solution to the cme for this system is given by the poisson distribution ( [ eq : slowapprox ] ) .",
    "the closest approximation that we can get to this process with an sde , is the chemical langevin equation  @xcite .",
    "the corresponding stationary fpe for this system is @xmath76 it can be explicitly solved to get  @xcite .",
    "@xmath77 where @xmath78 is determined by normalisation @xmath79 here the integral is assumed to be taken over @xmath80 ( if we want to interpret @xmath81 as concentration ) or @xmath82 ( if we do not want to impose artificial boundary conditions at @xmath83 ) . considering more complicated systems , it is more natural to assume that the domain of the chemical langevin equation is a complex plane  @xcite .",
    "suppose we now wish to quantify the difference between probability distributions ( [ eq : slowapprox ] ) and ( [ eq : density ] ) as a function of @xmath84 .",
    "the first issue that we come across is that the solution of the steady - state cme is a probability mass function , and the solution to the steady - state fpe is a probability density function .",
    "however , we can simply integrate the probability density function over an interval of size one centered on each integer , to project this distribution onto a discrete state space with mass function @xmath85 so that the two distributions can be compared : @xmath86 another issue is to specify the treatment of negative values of @xmath81 . in our case",
    "we truncate the distribution for @xmath80 .",
    "we can then exactly calculate @xmath85 to get @xmath87 where @xmath88 denotes the lower incomplete gamma function and @xmath89 is the gamma function .",
    "then we can consider the @xmath90 difference between these two distributions for a given value of @xmath84 , @xmath91 \\right)^2 } .",
    "\\label{errorfpe}\\ ] ] figure [ figure1](b ) shows how @xmath92 decays as @xmath84 increases .",
    "the slightly odd sickle shaped error curve for small @xmath84 is due to the probability mass of @xmath93 being peaked close to ( or at ) zero . in this region",
    "the diffusion approximation is very poor . to illustrate this ,",
    "the value of @xmath93 at @xmath83 , i.e. @xmath94 $ ] , is also plotted in figure [ figure1](b ) ( red curve ) .",
    "once the peak of the probability mass has moved far enough away from zero , then the error is no longer dominated by being too close to zero , and decays inversely proportional to @xmath84 ( gradient of log - log plot is @xmath95 ) .    in the 2000 paper by gillespie  @xcite on the chemical langevin equation ,",
    "a condition is put on the types of system which are well approximated by a diffusion .",
    "the probability of the system entering a state where the copy numbers of one or more of the chemical species in the state vector are close to zero must be small .",
    "otherwise the approximation becomes poor . in the case of diffusion approximations of the slow variable(s ) of a system",
    ", the trajectories must likewise stay away from regions of the state - space with low values of the slow variable(s ) .",
    "further discussions and results regarding the accuracy of the chemical langevin and fokker - planck equations can be found in  @xcite .",
    "the cma and nma both employ bursts of stochastic simulations to estimate the effective drift and diffusion of the slow variable .",
    "the main advantage of the qssma is that no such computation is required .    in the case of the cma , as described in section [ sec : cma ] , the full system is simulated , including fast and slow reactions .",
    "the computed trajectory is constrained to a particular value of the slow variables , and so whenever a slow reaction occurs , the trajectory is projected back onto the same point on the slow manifold . the effective drift and diffusion at that point on the slow manifold are functions of statistics about the relative frequency of these slow reactions .",
    "as such , as given by the central limit theorem , the error in these estimations are mean zero and normally distributed , with variance proportional to @xmath96 , where @xmath97 is the number of slow reactions simulated during the estimation . since it is necessary to simulate all of the fast and slow reactions in the system , depending on the difference in timescales this can be very costly .",
    "since the ratio of occurrences of fast reactions to slow reactions is proportional to @xmath73 , the cost of the estimation is @xmath98 .    in comparison ,",
    "the nma , as described in section [ sec : nma ] , is only concerned with finding the average value of the fast variables through a gillespie ssa simulation of only the fast variables .",
    "therefore , the monte carlo error is again mean zero and normally distributed , with variance @xmath99 , where @xmath100 is the number of fast reactions simulated .",
    "since we only simulate the fast reactions , the cost of the estimation is @xmath101 .",
    "therefore , the cost of estimation for the cma is approximately @xmath73-times that of the nma for the same degree of accuracy .",
    "all three of the algorithms ( cma , nma , qssma ) also incur error through discretisation errors in the approximation of the solution to the steady - state fpe .",
    "the error of such an approximation is dependent on the method used , such as the adaptive finite element method used for three - dimensional chemical systems in  @xcite . in this paper",
    "we are mainly interested in the accuracy of the various methods for estimating the effective drift and diffusion functions , and as such we aim to simplify the methods for solving this pde as much as possible . therefore we will only consider systems with one - dimensional slow variables .",
    "the steady state equation corresponding to fpe is then effectively an ordinary differential equation , and one which can be solved directly  @xcite to obtain @xmath102 where @xmath78 is the normalisation constant . with approximations of @xmath0 and @xmath18 over a range of values of @xmath81 ( through implementation of the cma , nma or qssma ) , the integral in this expression can be evaluated using a standard quadrature routine ( for instance the trapezoidal rule ) .",
    "the errors incurred here will be proportional to the grid size to some power , depending on the approximation method used .",
    "._table to summarise the sources of error of the three algorithms.[tab : errors ] _ [ cols=\"^,^,^,^\",options=\"header \" , ]     table [ tab : errors ] summarises the analysis of the errors of the various methods that we have looked at in this section .",
    "each method has advantages and disadvantages , depending on the type of system which a modeller wishes to apply the methods to .",
    "all of the methods use diffusion approximations , and as such , if the slow variables of the system of interest can not be well approximated by a diffusion , then none of the proposed methods are suitable . if the qssa does not hold for the system , then the cma is the best choice .",
    "if it does hold , and the analytical solution for the effective propensities is available to us , then the qssma is the best choice , since it does not incur monte carlo , and is the least expensive of the three algorithms . finally , if no such analytical solution is available , but the qssa still holds , then the nma is the best choice of algorithm , since it converges faster than the cma .",
    "next , we apply the three methods to three different parameter regimes of the system given by . in each of the experiments , we set @xmath103 and @xmath104 and we vary @xmath73 .",
    "we use @xmath105 , @xmath106 and @xmath107 . in each case , the cma , nma and the qssma are all applied to the system over the range of values @xmath108 $ ] .",
    "this range is chosen since the invariant distribution of the slow variable ( [ eq : slow ] ) is the poisson random variable with intensity @xmath109 , and therefore the vast majority of the invariant density is contained with this region for all three parameter regimes .",
    "furthermore , we implemented these algorithms on a computer with four cores , and to optimise the efficiency of parallelisation it was simplest to choose a domain with the number of states divisible by 4 , hence the region starting at 101 as opposed to 100 . for the cma and the nma ,",
    "a range of different numbers of reactions were used in order to estimate the drift and diffusion parameters at each point , @xmath110 .",
    "each code was implemented in c , and optimised to the best of the authors ability , although faster codes are bound to be possible .",
    "the number of cpu cycles used was counted using the c time library .",
    "the cpu cycles used over all 4 cores were collated into a single number for each experiment .",
    "4.685 cm -5.6 mm 4.685 cm -5.6 mm    the results of these experiments are shown in figure [ figure2 ] .",
    "note that the results of the qssma and nma are unaffected by a change in the value of @xmath73 . in the case of the nma ,",
    "a change in the value of this variable simply scales time in computation of the fast subsystem , but does not affect the result .",
    "as such , only one run was necessary for these methods for the three different parameter regimes .",
    "the three plots for the nma use the same simulations , but since the true distribution of the slow variable is affected by the change in @xmath73 , the error plots differ across the three parameter regimes . in figure [ figure2 ]",
    "we plot the total relative error @xmath111 where @xmath112 is the steady state distribution of the slow variable obtained by the corresponding method and @xmath113 is the exact solution given by ( [ eq : slow ] ) .",
    "figure [ figure2](a ) , with @xmath114 , denotes a parameter regime in which the qssa produces a great deal of error .",
    "the nma error quickly converges to the level seen in the qssma , but neither method can improve beyond this .",
    "the error seen from the cma improves on both of these methods with relatively little computational effort .",
    "one might argue that the system is not actually a `` true '' multiscale system in this parameter regime , but the cma still represents a good method for analysis of the dynamics of such a system , since its implementation can be parallelised in a way which scales linearly with the number of cores used .",
    "figure [ figure2](c ) shows a parameter regime which is highly multiscale . in this regime , the qssa is far more reasonable , and as such we see vastly better performance from the nma and qssma methods .",
    "however , eventually the cma still has a higher accuracy than these two other approaches , although at not inconsiderable computational cost . in this case",
    ", the error incurred by the qssa may be considered small enough that a modeller may be satisfied enough to use the qssma , whose costs are negligible . for more complex systems , the cme for the fast subsystem may not be exactly solvable , or even easily approximated , and in these cases the nma would be an appropriate choice . if a more accurate approximation is required , once again the cma could be used . in summary , even for simple system ( [ eq : lin ] ) , with different parameter regimes , different methods could be considered to be preferable .",
    "in this section , we will compare the presented methods for a multiscale chemical system which is bimodal , with trajectories switching between two highly favourable regions  @xcite : @xmath115 one example of the parameter values for which this system is bistable for is given by : @xmath116 in this regime , reactions @xmath117 and @xmath118 ( with rates @xmath119 and @xmath120 respectively ) are occurring on a much faster time scale than the others .",
    "this can be seen in figure [ figure3 ] , which shows the cumulative number of occurrences of each reaction in this system , simulated using the gillespie ssa , given in table [ ssatable ] .",
    "both the species @xmath42 and @xmath43 are fast variables , since neither is invariant to the fast reactions . as in  @xcite , we pick a slow variable which is invariant to reactions @xmath117 and @xmath118 , @xmath121 .",
    "we now aim to compare the efficiency and accuracy of the cma , nma and qssma in approximating the stationary distribution in two different parameter regimes , with different spectral gaps between the fast and slow variables .",
    "this can be done by altering the values of rates @xmath119 and @xmath120 .",
    "[ figure3],scaledwidth=60.0% ]    one issue with using such a system , is that we can not compute the analytical expression for the invariant density .",
    "therefore , we compare with an accurate approximation of the invariant density .      for the nma and the qssma , we assume that reactions @xmath117 and @xmath118 are occurring on a very fast time scale",
    ". therefore we may assume that between reactions of other types ( the slow reactions @xmath48-@xmath47 ) , the subsystem involving only the fast reactions enters statistical equilibrium .",
    "in this case , we can reformulate such that it is effectively a set of reactions which change the slow variable ( reactions @xmath117 and @xmath118 are of course omitted as the slow variable @xmath122 is invariant with respect to these reactions ) : @xmath123 next , we design the qssma by analytically computing the rates @xmath124 , @xmath125 , @xmath126 and @xmath127",
    ".    to estimate the rates in ( [ eq : qssbis ] ) we must compute the average values of @xmath42 and @xmath43 for fixed value of @xmath24 in the fast subsystem : @xmath128 as in  @xcite , we approximate the mean values @xmath129 and @xmath130 of @xmath42 and @xmath43 , respectively , by the solutions of the deterministic reaction rates equations .",
    "the authors showed that such an approximation is reasonably accurate for this particular fast subsystem ( a reversible dimerisation reaction ) .",
    "therefore , we need to solve the following system : @xmath131 the nonnegative unique solution is given by : @xmath132 then the effective propensity function of the slow reaction can be written as  @xcite : @xmath133 more computational effort is required for this problem , since we need to compute @xmath130 for each value of @xmath24 on the mesh . however , the computational effort is still negligible in comparison with the cma or nma .",
    "the biggest drawback with the qssma is the increase in mathematical complexity as the fast and slow systems themselves become more complicated .",
    "the more complexity there is , the more approximations need to be made in order to find the values of the effective propensities .",
    "the nma simulations of the fast subsystem in order to approximate the effective propensities , which are then fed into the fokker - planck equation for the slow sub - system . for the cma simulations , we let @xmath121 be the slow variable , and we let @xmath43 be the fast variable . for further details on how to apply the cma to this system , see  @xcite .      in general , systems which have second ( or through modelling assumptions , higher ) order reactions can not be solved exactly , although there are some special cases which can be tackled  @xcite . system ( [ eq : bis ] ) has second order reactions and hence we assume that the invariant distribution for the system can not be solved analytically . as such , we are not able to compare the approximations arising from the three methods considered ( cma , qssma , nma ) to an exact solution . however , we can approximate the solution to the cme for this system , as we did in  @xcite , by solving it on a truncated domain , assuming that the invariant distribution has zero probability mass everywhere outside this domain .    for the numerics that follow , we solve the cme on a truncated domain @xmath134 \\times [ 0,1.5 \\times 10 ^ 3]$ ] .",
    "the cme on this domain gives us a sparse linear system , whose null space is exactly one dimensional .",
    "the corresponding null vector gives us , up to a constant of proportionality , our approximation of the solution of the cme .",
    "we normalise this vector , and then sum the invariant probability mass over states with the same value of the slow variable @xmath22 .",
    "this procedure gives us the approximation of the invariant density of the slow variable which is plotted in figure [ figure4](a ) .",
    "although this is only an approximation , it is a very accurate one . to demonstrate this",
    ", we compared the approximation of the solution @xmath135 of the steady - state cme on our chosen domain @xmath134 \\times [ 0,1.5 \\times 10 ^ 3]$ ] with an approximation @xmath136 over a smaller domain , @xmath137 \\times [ 0,1.25 \\times 10 ^ 3]$ ] .",
    "the relative @xmath90 difference between these two approximations was @xmath138 , indicating that any error in the approximation @xmath135 is highly unlikely to be of the order of magnitude of the errors seen in figure [ figure4](b ) , where we have used @xmath135 to approximate the error of multiscale methods .",
    "4.685 cm -5.6 mm 4.685 cm -5.6 mm    figure [ figure4](b ) shows the error plots for the three methods for the system , using the approximation of the solution of the cme as the `` exact '' solution .",
    "the computational effort here is measured in terms of the numbers of simulated reactions . since the computational cost for the two methods which use monte carlo simulations are dominated by the cost of producing two pseudo - random numbers for each iteration , this is a good estimate .",
    "unlike in the previous example , the distribution of the fast variables for a fixed value of the slow variables is not known analytically , and as such an approximation has been made , as was outlined in section [ sec : new ] . as such",
    ", we no longer expect the nma approximation to converge to the qssma approximation as in the last example .",
    "this can be seen in the error plot in figure [ figure4](b ) , where the error in the qssma approximation , which again had negligible cost to compute , is relatively high , with the nma and cma quickly outperforming it .",
    "the nma slightly outperform the cma at first , but appears to be unable to improve past a relative error of around @xmath139 .",
    "note that this is 9 orders of magnitude bigger than the relative @xmath90 difference between @xmath135 and @xmath136 , and so is highly unlikely to be an artefact of the method we have used to approximate this error . as in the previous example , and as seen in  @xcite , although the cost of the cma is in general higher than the other methods , if a high precision solution is required , it is arguably the method of choice , as the error continues to decrease monotonically @xmath140 .",
    "in this paper we have introduced two new methods for approximating the dynamics of slow variables in multiscale stochastic chemical networks , the nma and qssma .",
    "these new methods combine ideas from the cma  @xcite , with ideas used in existing methods for speeding up the gillespie ssa for multiscale systems  @xcite .",
    "we then undertook a detailed numerical study of the different sources of error that these methods incur , for a simple chemical system for which we have an exact solution of the cme .",
    "error is incurred due to the approximation of the dynamics by a diffusion process , monte carlo error in the approximation of the effective drift and diffusion terms , error due to application of the qssa , and numerical error in approximation of the steady - state fokker planck equation , in various combinations .",
    "we then conducted another numerical study for a bistable chemical system , approximating the error by using an approximation of the solution to the cme for the system .",
    "what we may surmise from this work , is that different methods , utilising different types of approximations , are appropriate for different types of system , or even in different parts of the parameter space of the same system .",
    "the methods in this paper differ from many others for stochastic fast / slow systems mainly in the approach of approximating the slow variables by a sde .",
    "the majority of the other methods proposed in the literature use different ways of speeding up the gillespie ssa for multiscale systems  @xcite . in each ,",
    "the full simulation of the fast species is replaced by some sort of approximation , so that an ssa - type algorithm , just for the slow species , may be implemented .",
    "many other approaches in the literature rely on a qssa , including that taken by rao and arkin  @xcite , haseltine and rawlings  @xcite , e , liu and vanden - eijnden  @xcite and cao , gillespie and petzold  @xcite .",
    "all of these methods will incur the error that is seen in figure [ figure1](a ) .",
    "this error will be negligible for some systems , and significant for others , as we saw in section [ sec : qssa ] , and in the difference between panels in figure [ figure2 ] .",
    "one advantage of these methods over those that we have presented in this paper , is that they do not incur the continuous approximation error that we see in figure [ figure1](b ) and discussed in section [ sec : diff ] .",
    "diffusion approximation methods would not be appropriate if one wanted to analyse the dynamics of a slowly changing variable which has a low average copy number .",
    "for instance , in some gene regulatory network models , there are often two species , whose number sum to 1 in total , which represent whether a particular gene is `` switched on '' or `` switched off '' .",
    "such a variable is clearly not a candidate for diffusion approximation .",
    "however , diffusion approximations have been used successfully for other variables in such systems  @xcite .",
    "the dynamics of that gene can not themselves be approximated by a diffusion , but may be inferred from the state of other variables , which may be good candidates for such an approximation .",
    "one big advantage of the diffusion approximation methods , is the ease with which the computational effort can be efficiently parallelised .",
    "this is a different approach to parallelisation than in the case of methods which calculate ssa trajectories .",
    "several trajectories can be computed on different processors , but in order for the computed invariant distribution to be converged , either the initial positions of all of the trajectories must be sampled from the invariant distribution ( which is unknown ) , or the trajectories must be run for enough time that each one is converged in distribution . on the other hand ,",
    "the diffusion approximation approaches are almost embarrassingly parallelisable , with a subset of the states for which we wish to estimate the effective drift and diffusion being given to each processor .",
    "the solution of the fokker - planck equation is similarly parallelisable .",
    "this means that given enough computational resources , these algorithms can give us answers in a very short amount of time .",
    "moreover , these approaches also allow us to consider adaptive mesh regimes  @xcite , meaning that one can minimise the number of sites at which we are required to estimate the effective drift and diffusion values , while also controlling the global error incurred .",
    "this flexibility is not available in an ssa - type approach .                                                              height 2pt depth -1.6pt width 23pt , _ the slow - scale linear noise approximation : an accurate , reduced stochastic description of biochemical networks under timescale separation conditions _ , bmc systems biology , 6 ( 2012 ) , p.  39"
  ],
  "abstract_text": [
    "<S> several different methods exist for efficient approximation of paths in multiscale stochastic chemical systems . </S>",
    "<S> another approach is to use bursts of stochastic simulation to estimate the parameters of a stochastic differential equation approximation of the paths . in this paper , </S>",
    "<S> multiscale methods for approximating paths are used to formulate different strategies for estimating the dynamics by diffusion processes . </S>",
    "<S> we then analyse how efficient and accurate these methods are in a range of different scenarios , and compare their respective advantages and disadvantages to other methods proposed to analyse multiscale chemical networks . </S>"
  ]
}