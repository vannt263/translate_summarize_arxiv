{
  "article_text": [
    "nonparametric density estimation using bayesian models with a mixture prior distribution has been used extensively in practice due to their flexibility and available computational techniques using mcmc . in some cases their theoretical properties have been studied , and in particular the asymptotic behaviour of the associated posterior distribution .",
    "posterior weak consistency has been studied quite systematically in particular by @xcite , but posterior concentration rates have been derived only for a small number of kernels . in the case of density estimation on [ 0,1 ] ( or any compact interval of @xmath0 )",
    "@xcite has studied mixtures of beta densities , and @xcite have considered mixtures of triangular densities , gaussian location mixtures have been considered by @xcite and , more generally , power exponential kernels by @xcite .",
    "location scale mixtures have been considered also by @xcite .",
    "apart from the latter paper , the posterior concentration rates have been obtained by the above authors are equal to the minimax estimation rate ( up to a @xmath1 term ) over some collections of functional classes , showing that nonparametric mixture models are not only flexible prior models , but they also lead to optimal procedures , in the frequentist sense .",
    "the above results do not cover however models for densities on @xmath2 and the posterior concentration rates have been obtained only under the condition that the densities are uniformly bounded .    in this paper",
    "we propose to estimate a possibly unbounded density supported on the positive semiline via a bayesian approach using a dirichlet process mixture of gamma densities as a prior distribution .",
    "the proposed prior distribution does not depend on regularity properties of the unknown density ( such as the hlder exponent ) so the resulting posterior estimates are adaptive .",
    "bayesian gamma mixtures are widely used in practice , for instance , for pattern recognition @xcite and for modelling the signal - to - noise ratio in wireless channels @xcite .",
    "an algorithm for implementing a gamma mixture with unknown number of components as well as aspects of the practical application of this model is given in @xcite .",
    "the main purpose of the paper is to derive the conditions on the gamma mixture prior and on the hyperpriors so that the posterior distribution asymptotically concentrates at the optimal rate ( up to a log factor ) around the true density over smooth classes of densities .",
    "we derive the concentration rate of the posterior distribution when the unknown density belongs to a local hlder class on @xmath3 ( see the formal definition below ) adapting the techniques applied in @xcite , @xcite and @xcite to the proposed mixture of gamma densities .",
    "in particular , we will show that this mixture provides a good approximation for such functions .",
    "secondly , we investigate the concentration rate of this posterior distribution for an unknown density on @xmath3 that can be unbounded at 0 , namely for a density @xmath4 for @xmath5 in a neighbourhood of 0 and for function @xmath6 belonging to a locally hlder class on @xmath3 .",
    "a typical example of such behaviour is a gamma density with the shape parameter between 0 and 1 . for a bounded density ,",
    "we use the lower bound on the rate of convergence for estimators of densities from the local hlder class @xmath7 which is @xmath8 @xcite .",
    "the paper is organised as follows . in section  [ sec : mainresult ] we define the prior distribution and study the concentration rate of the corresponding posterior distribution over an extension of the local hlder class to possibly unbounded densities .",
    "we also discuss the choice of the base measure of the dirichlet process prior as well as the hyperprior measure on the shape parameter of the gamma distribution that lead to consistent estimation with the posterior concentration rate equal to the minimax optimal rate of convergence up to a log factor .",
    "numerical performance of the estimator is studied on simulated data for bounded and unbounded densities and on real data , with the results presented in section  [ sec : applications ] .",
    "the proof of the main result is given in section  [ sec : proofs ] , and the proofs of the auxiliary results are deferred to the appendix .      throughout the paper",
    "we assume that @xmath9 is an @xmath10-sample from a distribution with density @xmath11 on @xmath12 with respect to lebesgue measure .",
    "we denote by @xmath13 with @xmath14 denoting the set of measurable and integrable functions on @xmath15 .",
    "the aim is to estimate the unknown density @xmath16 which we do using a bayesian approach .",
    "we construct a prior probability on @xmath17 , by modelling @xmath11 as a mixture of gamma densities , see below .",
    "the associated posterior distribution is denoted by @xmath18 .",
    "let @xmath19 be the true density of the @xmath20 s and we are interested in determining the posterior concentration rate @xmath21 defined by @xmath22 where @xmath23 is the @xmath24 norm .",
    "we denote by @xmath25 the kullback - leibler divergence between @xmath26 and @xmath27 and by @xmath28 the variance of log - densities ratio : @xmath29 ^ 2 f_1(x)dx - { { \\mathcal kl}}(f_1 ,",
    "f_2)^2   \\end{aligned}\\ ] ] and the square of the hellinger distance by @xmath30    throughout the paper @xmath31 ( resp .",
    "@xmath32 ) means that there exists a positive constant @xmath33 such that @xmath34 ( resp . @xmath35 and @xmath36 means that @xmath37 .    in the following section we present the main results of the paper .",
    "we start with description of the mixture of gamma distributions which underpins the construction of our prior model on @xmath17 .",
    "we consider the following gamma mixture types of models : @xmath38 we consider @xmath39 , where @xmath40 is a probability on the set of discrete distributions over @xmath15 an @xmath41 is a probability distribution on @xmath42 .",
    "we also denote @xmath430 , + \\infty ) $ ] .",
    "hence the densities are represented by _ location _ gamma mixtures , since in the above parametrization @xmath44 is the mean of the gamma distribution with parameters @xmath45 .",
    "this particular parametrization leads to the variance equal to @xmath46 , and as @xmath47 goes to infinity , the gamma distribution @xmath45 can be approximated by a gaussian random variable with mean @xmath44 and variance @xmath46 .",
    "this allows for precise approximation near 0 and more loose approximation in the tail .",
    "this parametrization has also been used in @xcite .",
    "the key to good approximation properties of a continuous density @xmath11 by the gamma mixtures defined above is @xmath48 where operator @xmath49 is defined by @xmath50 we explain in more details in section [ sec : approx : dens ] , why mixtures of gamma distributions as proposed here are flexible models for estimating smooth densities on @xmath51 .",
    "the general idea is that , as in the case of mixtures of beta distributions in @xcite or mixtures of gaussian distributions in @xcite , under regularity conditions with @xmath11 verifying some hlder - type condition with regularity @xmath52 , one can construct a probability density @xmath26 on @xmath51 such that @xmath53 the continuous mixture @xmath54 can then be approximated by a discrete mixture with @xmath55 components .",
    "we consider discrete priors on @xmath56 and priors on @xmath47 that satisfy the following condition :    * condition @xmath57 * : the prior on @xmath47 , @xmath41 satisfies : for some constants @xmath58 and @xmath59 , @xmath60 ) & \\gtrsim e^{-c \\sqrt{x } ( \\log x)^{\\rho_z } } , \\quad \\pi_z ( [ x , + \\infty ) ] \\leq e^{-c ' \\sqrt{x } ( \\log x)^{\\rho_z } } \\quad   \\mbox { as } x\\rightarrow + \\infty , \\\\   \\pi_z ( [ 0,x ] ) & \\lesssim x^{c_0 } \\quad \\text { for } x \\rightarrow   0 , \\end{split } \\label{eq : priorz}\\ ] ]    we consider either of these two types of prior on @xmath56 :    * * dirichlet prior * of @xmath56 : @xmath61 where @xmath62 denotes the dirichlet process with mass @xmath63 and base probability measure @xmath64 having positive and continuous density @xmath65 on @xmath66 satisfying : @xmath67 for some @xmath68 and @xmath69 . *",
    "* finite mixture * : @xmath70 @xmath71 with @xmath64 satisfying , @xmath72 and there exists @xmath73 such that @xmath74    condition @xmath57 is quite mild .",
    "it is satisfied for instance for @xmath75 following a @xmath76 distribution , in which case @xmath77 .",
    "the prior condition on the base measure imposes fat tails on @xmath64 .",
    "it is satisfied for instance if @xmath78 with @xmath79 .",
    "note that , it appears from the proofs that if @xmath80 then posterior concentration rates would remain unchanged over the functional class described below , assuming that the true density @xmath11 also has exponential type tails .",
    "hence , when estimating such densities , @xmath64 could be chosen a gamma random variable , but the inverse gamma does not satisfy these conditions and posterior concentration rates are not derived in this case .      in this paper",
    "we are interested in estimating densities that are possibly unbounded at 0 . to construct a class of such functions over which posterior concentration rates",
    "are derived , first we need a class of bounded functions .",
    "let @xmath81 , @xmath82 , @xmath83 be the set of such functions @xmath84 which are @xmath85 times continuously differentiable with @xmath86 and which satisfy for all @xmath87 and @xmath88 : @xmath89 and @xmath90 , @xmath91 defining @xmath92 for @xmath93 and @xmath94 if @xmath95 , @xmath96 for some @xmath97 .",
    "we also consider classes of densities unbounded around zero that are defined as follows .",
    "let @xmath98 , @xmath99 $ ] , @xmath82 , @xmath83 , be the set of such functions @xmath100 such that function @xmath101 satisfies the following conditions :    * function @xmath6 is @xmath85 times continuously differentiable with @xmath86 and such that for all @xmath102 , @xmath89 and @xmath90 , @xmath103 * for some @xmath97 , @xmath104 where @xmath92 for @xmath93 and @xmath94 if @xmath95 .",
    "note that in the case @xmath105 , we recover the first functional class , namely @xmath106    the rationale behind the functional class @xmath107 comes from the following lemma .",
    "[ lem : representation ] for any @xmath108 and @xmath102 , @xmath109 where @xmath110 , @xmath111 and @xmath112 for large @xmath47 .",
    "lemma [ lem : representation ] is a consequence of lemma  [ lem : approxalpha ] which is given in appendix  [ sec : proofsadjalpha ] .",
    "[ rk : functionalclass ]    1 .   note that in the above functional class @xmath81 , @xmath11 is bounded from above but is allowed converge to 0 as @xmath113 goes to 0 .",
    "interestingly if @xmath114 for any @xmath115 and @xmath6 satisfies then condition is satisfied by @xmath11 .",
    "if @xmath116 is also bounded from below , then condition can be interpreted as @xmath117 being locally hlder ( possibly with a constant function @xmath118 ) with the corresponding integral conditions .",
    "similarly , the same holds for @xmath119 bounded from below if @xmath120 .",
    "the moment condition is satisfied for a number of densities on the positive semiline ( see appendix  [ sec : verifcond ] for details ) : 1 .   for the weibull distribution with density @xmath121 , @xmath122 , with @xmath123 for @xmath124 $ ] ; for @xmath125 , @xmath117 is hlder with exponent @xmath126",
    "; 2 .   for folded student t distribution @xmath127 with @xmath128",
    "; 3 .   for a frechet - type distribution with density @xmath129 , @xmath130 . in this case , @xmath131 so we can take @xmath132 , and e.g. for @xmath133 we can take @xmath134 and @xmath135 .",
    "similarly to location mixtures of gaussian densities , mixtures of gamma densities provide a flexible tool to approximate smooth densities on @xmath15 , and using the representation of lemma [ lem : representation ] , to approximate smooth but possibly unbounded densities .",
    "the posterior concentration rates are presented in the following theorem .",
    "[ th : rate ] consider the prior defined in section [ sec : prior ] and assume that @xmath136 is a sample of independent observations distributed according to a probability @xmath137 on @xmath15 having density @xmath19 with respect to lebesgue measure .",
    "assume that there exists @xmath99 $ ] such that @xmath138 and that @xmath19 satisfies the following tail condition for some @xmath139 : @xmath140 then , there exists @xmath141 depending only on @xmath142 such that @xmath143 } \\sup_{\\beta \\in [ \\beta_0,\\beta_1 ] } \\sup_{f_0 \\in    \\mathcal p_{\\alpha } ( . . . ) } e_0\\left [ \\pi\\left ( \\| f - f_0\\|_1 > m n^{-\\beta/(2\\beta+1)}(\\log n)^{q}| \\mathbf{x}^n \\right ) \\right ] = o(1)\\ ] ] with @xmath144 if @xmath145 and @xmath146 if @xmath147 .",
    "theorem [ th : rate ] is proved in section [ sec : pr : thrate ] .",
    "note that in , @xmath19 is supposed to satisfy so that the supremum in @xmath19 is taken over the intersection of @xmath148 and of the set of function satisfying , @xmath149 and @xmath150 being fixed .",
    "note also that the tail assumption is much weaker than the tail condition considered for mixtures of gaussians as in @xcite or @xcite where exponential decay in the form @xmath151 is assumed for some @xmath152 . because the posterior concentration rates obtained in @xcite or @xcite are upper bounds , it is not clear that the exponential tail condition was necessary .",
    "it seems however that because gamma densities have fatter tails than gaussian densities , they allow for approximations of densities with fatter tails .    the theorem is proved following the approach of @xcite , so that first we construct an approximation of the true density @xmath19 by a continuous mixture of gammas in the form @xmath153 for some density @xmath26 close to @xmath19 and then approximate the continuous mixture by a discrete and finite mixture .",
    "this allows us to control the prior mass of kullback - leibler neighbourhoods .",
    "the tail condition is used in this second step , similarly as the exponential tail condition used with gaussian mixtures in @xcite or @xcite .",
    "it is to be noted however that local hlder condition involved in the definition of the functional classes @xmath154 implicitly also induce some tail behaviour on @xmath19 .",
    "although is a rather mild condition , it excludes fat tail distributions such as the folded cauchy density whose density at infinity behaves like @xmath155 .",
    "if one is interested in estimating fat tail densities at infinity , then a simple transformation allows to do it using mixtures of gamma densities .",
    "consider the class of densities @xmath156 , i.e. the density of @xmath157 for @xmath158 where @xmath159 .",
    "let @xmath160 with @xmath161 for small @xmath113 and some @xmath162 and @xmath163 for some @xmath164 when @xmath113 goes to infinity .",
    "then @xmath165 when @xmath88 goes to infinity and @xmath166 when @xmath88 goes to 0 .",
    "hence @xmath167 satisfies the tail conditions both at 0 and infinity assumed in theorem  [ th : rate ] . since @xmath168 , theorem  [ th : rate ] implies that density @xmath169 can be estimated using the appropriately adapted prior , such that the corresponding prior on @xmath11 satisfies the conditions stated in the theorem , with the same rate of convergence .",
    "the prior for estimating @xmath156 is a mixture of inverse gammas : @xmath170 where @xmath171 which is the density of an inverse gamma distribution .",
    "* condition * @xmath172 :    the hyperprior is @xmath173 , where @xmath41 is a probability distribution on @xmath174 satisfying condition and @xmath175 is a probability on the set of discrete distributions over @xmath15 satisfying either of these two types of prior on @xmath56 :    * * dirichlet prior * of @xmath176 : @xmath177 where @xmath178 denotes the dirichlet process with mass @xmath63 and base probability measure @xmath179 having positive and continuous density @xmath180 on @xmath66 satisfying : @xmath181 for some @xmath182 and @xmath183 ( note that this corresponds to the density @xmath184 satisfying conditions with @xmath185 and @xmath186 ) . * * finite mixture * : @xmath187 @xmath71 with @xmath179 satisfying , @xmath72 and there exists @xmath188 such that @xmath189    in particular , we have similar approximation properties for @xmath190 in the following class : @xmath191 since for all @xmath102 , as @xmath192 , @xmath193    we summarize the result in the following corollary .",
    "[ th : rateig ] consider the prior defined by that satisfies condition @xmath194 , and assume that @xmath136 is a sample of independent observations distributed according to a probability @xmath137 on @xmath15 having density @xmath167 with respect to lebesgue measure .",
    "assume that there exists @xmath99 $ ] such that @xmath195 and that @xmath167 satisfies the following condition for some @xmath139 : @xmath196 then , there exists @xmath141 such that @xmath197 = o(1)\\ ] ] with @xmath144 if @xmath145 and @xmath146 if @xmath147 .",
    "note that the folded cauchy density satisfies the conditions for @xmath198 required in the corollary .      as in @xcite ,",
    "one of the key elements in the proof of theorem [ th : rate ] is the approximation of a smooth density @xmath11 by a continuous gamma mixture of the form @xmath199 where @xmath26 is a smooth function close to @xmath11 which is of independent interest .",
    "similarly to @xcite , @xmath26 is constructed iteratively to be able to adapt to the smoothness of @xmath19 .",
    "the general idea is that @xmath200 is a good approximation of @xmath19 if @xmath19 has smoothness @xmath201 , as in the gaussian case , because the gamma density @xmath202 behaves like a gaussian density when @xmath47 goes to infinity . to approximate @xmath19 with the correct order @xmath203 for @xmath93",
    ", we need to correct for the error @xmath204 and replace @xmath205 by @xmath54 where construction of @xmath26 takes into account @xmath204 .",
    "thus , we iterate until the approximation error @xmath206 is of the required order , @xmath203 .",
    "the above approximation scheme is described in the following proposition :    [ lem : approx:1 ] for all @xmath207 , for all @xmath208 , there exist @xmath209 , @xmath210 such that the function @xmath211 with @xmath212 and @xmath213^{(j ) } , \\quad d_j(z ) = d_j + o(1/z),\\ ] ] satisfies @xmath214 where @xmath215 depends on @xmath216 only . moreover , the probability density @xmath217 with @xmath218 for all @xmath219 , satisfies @xmath220 where @xmath221 depends only on @xmath216 .",
    "note that in the approximations and , when @xmath222 $ ] with @xmath223 , then @xmath215 and @xmath221 can be chosen depending on @xmath224 and not @xmath225 . proposition [ lem : approx:1 ] is proved in section [ sec : proof : approx1 ] .",
    "in the following sections we will fit a bayesian model to the data with following dirichlet process prior : @xmath226 ,",
    "\\quad a>1,\\\\ h(x ) : & & \\sqrt{z } \\sim \\gamma(b , c ) , \\quad b , c>0 . \\notag\\end{aligned}\\ ] ] it is easy to check that condition @xmath57 holds for this prior .",
    "we use default choices of free parameters @xmath227 , @xmath228 and @xmath229 , however we check sensitivity with respect to these parameters .    to sample from the posterior we use the slice sampling algorithm of @xcite .",
    "introducing the auxiliary variables @xmath230 the uniform random truncation variables and @xmath231 the allocation variables so that the full likelihood is written as @xmath232 allows to use a gibbs sampler algorithm based on the following full conditional distributions    * @xmath233 \\stackrel{ind}{\\sim } g(\\epsilon_j ) e^{-z s_j/\\epsilon_j } \\epsilon_j^{-z n_j }   , \\quad s_j = \\sum_{c_i = j}x_i , \\quad n_j = \\sum_{i=1}^n{\\mathbb{i}}_{c_i = j}\\ ] ] * @xmath234   \\stackrel{ind}{\\sim } \\mbox{beta } ( n_j+1 , \\sum_{l > j}n_l + m)\\ ] ] * @xmath235   \\stackrel{ind}{\\sim } \\mathcal u(0,p_{c_i})\\ ] ] * @xmath236 \\propto { \\mathbb{i}}_{u_i\\leq p_{j}}g_z(x_i|\\epsilon_j)\\ ] ] * @xmath237 \\propto \\frac{h(z ) z^{nz } } { \\gamma(z)^n}e^ { -z \\sum_j s_j/\\epsilon_j}\\ ] ]    where the full conditional on @xmath47 is sampled using a metropolis - hasting step with proposal @xmath238      we simulate @xmath239 observations from the true density @xmath19 , and fit a bayesian model with prior .",
    "we considered the following true densities .    1",
    ".   exponential : @xmath240 , @xmath102 ( figure [ fig : expcauchy ] ) .",
    "2 .   folded cauchy : @xmath241 , @xmath102 ( figure [ fig : expcauchy ] ) .",
    "unbounded : @xmath242 is @xmath243 ( figure [ fig : gammaunbounded ] ) .",
    "4 .   mixture with different @xmath47 : @xmath242 is @xmath244 ( figure [ fig : mixturediffz ] ) .    even though the folded cauchy density does not satisfy the conditions of the theorem , we show that the proposed gamma mixture still provides a reasonably concentrating posterior distribution .",
    "1250 thinned samples from the posterior distribution are plotted for each true density after at least 50000 burn in iterations , with the red line representing the mean of the posterior distribution and the green line representing the true density .",
    "improvement of the concentration of the posterior distribution with increasing sample size is presented for the two component mixture .",
    "for all considered true densities , including the unbounded one and the folded cauchy density , the proposed gamma mixture model performs well .",
    "however , the value of the folded cauchy density around 0 has high uncertainty .",
    "sensitivity with respect to the choice of the free parameters was investigated for all densities , all leading to good performance ( presented for the unbounded density @xmath245 ) .              in this section",
    "we consider the data of the intervals between arrival times of emails modelled in @xcite which consists of the interarrival times ( minutes ) of 203 e - mail messages ( we are grateful to fabrizio ruggeri , one of the authors , who kindly provided us with the data ) .",
    "the proposed location gamma mixture with the default choice of the free parameters was fitted to the data .",
    "the histogram of the data with superimposed posterior mean and the samples from the posterior distribution are shown in figure  [ fig : emaildata ] ) .",
    "the histogram shows that the fit of the location mixture is similar to the fit of the location - scale mixture presented in @xcite .",
    "the plot of the samples with the posterior indicates uncertainty about the values of the density around 0 as well as high uncertainty about the possible second mode around 3 .",
    "we also present a zoom in into the neighbourhood of 0 which confirms the findings that the density is small around 0 and that the distribution of the email arrival times differs from exponential .",
    "the proof consists in verifying the assumptions of theorem 2.1 of @xcite . the first assumption , on the prior mass of kullback - leibler neighbourhood of the true density , is verified in lemma  [ lem : discrapproxboundary ] . in lemma",
    "[ prop : entropy ] we control the @xmath24 ( and hellinger ) entropy of the sieves which are defined below .",
    "fix an arbitrary @xmath246 to be defined later , and take a sieve @xmath247 as defined by in lemma  [ prop : entropy ] with @xmath248^{(5\\beta+1)/(4\\beta+2 ) } ,   \\quad   j_n = j_0 ( n/(\\log n)^3 ) ^{1/(2\\beta+1)},\\\\   a_n = \\exp(- c(n(\\log n)^{5\\beta+1})^ { 1/(2\\beta+1 ) } ) , \\quad   b_n =   \\exp ( c(n(\\log n)^{5\\beta+1})^ { 1/(2\\beta+1 ) } ) ,   \\\\    \\underline z =   \\exp(- z_0(n(\\log n)^{5\\beta+1})^ { 1/(2\\beta+1 ) } ) , \\quad \\bar z =   z_0 n^{2/(2\\beta+1 ) } ( \\log n)^{2(q - \\rho_z)}\\end{gathered}\\ ] ] for some constants @xmath249 and @xmath250 large enough and @xmath251 as defined in the theorem .",
    "lemma [ prop : entropy ] implies that we need to verify whether these constants satisfy the following conditions : @xmath252 for any @xmath253 with @xmath254 by choosing @xmath255 large enough . the second inequality in holds",
    "if @xmath256 ) & \\lesssim & e^{-c n \\varepsilon_n^2},\\\\ \\left ( \\frac{e m}{j_n } \\log(1/\\varepsilon_n ) \\right)^{j_n } & \\lesssim & e^{-c n \\varepsilon_n^2}.\\end{aligned}\\ ] ] in our case , @xmath257 with @xmath258 and @xmath259 .",
    "the last condition holds if @xmath260^{2t},\\ ] ] e.g. if @xmath261^{2t-1 } = c n^{1/(2\\beta+1 ) } [ \\log n]^{3\\beta/(2\\beta+1)}$ ] .",
    "[ def of @xmath262 is slightly different ]    the first inequality in holds if @xmath263 + \\log\\log(\\bar{z}_n/\\underline{z}_n ) \\lesssim   n \\varepsilon_n^2 = n^{1 - 2\\gamma } [ \\log n]^{2t}\\ ] ] that is , if @xmath264 for some @xmath265 , @xmath266 for some @xmath267 , @xmath268^{2t-1 }",
    "\\left\\ {   \\log n + \\log\\log n    + c\\right\\ } + \\log n \\leq   c   n^{1 - 2\\gamma } [ \\log n]^{2t}\\ ] ] which holds for large enough constant @xmath33 , and if @xmath269^{2t}$ ] . in our case , @xmath270 with any @xmath271 , and @xmath266 with any @xmath272",
    ".    choosing @xmath273 small enough completes the proof of , and hence the proof of theorem [ th : rate ] .",
    "we extend the definition of @xmath49 in the following way : for any distribution @xmath56 , define @xmath274 if @xmath56 has lebesgue density @xmath11 , then @xmath275 .",
    "[ lem : discrapproxboundary ] assume that the probability density @xmath276 and that there exist @xmath277 and @xmath139 such that @xmath278 then , for any @xmath279 , there exist @xmath280 such that @xmath281 for any prior satisfying condition @xmath57 and @xmath282 where @xmath283 , with @xmath251 defined in theorem [ th : rate ] .",
    "the constants @xmath284 and @xmath285 depend on @xmath286 , @xmath255 and on the constants defining the functional class .",
    "lemma [ lem : discrapproxboundary ] is proved in section [ sec : pr : klneigh ] .    as in @xcite",
    ", we control the entropy of the following approximating sets .",
    "[ prop : entropy ] fix @xmath287 , @xmath288 , @xmath289 , @xmath290 and introduce the following class of densities : @xmath291 , \\\\    & \\epsilon_j \\in [ a , a+b ] \\ , \\text { for } \\ ,",
    "j=1,\\ldots , j \\end{array }   \\right\\}.\\end{aligned}\\ ] ]    then , for @xmath292 , @xmath293    + \\log \\log\\left(\\frac { \\bar{z}}{\\underline{z}}\\right)-\\log \\varepsilon,\\\\ \\pi(q^c ) & \\leq &   \\left ( \\frac{e m}{j } \\log(1/\\varepsilon ) \\right)^j + j ( 1 -g([a , a+b ] ) ) + 1 - \\pi_z([\\underline{z } , \\bar{z}]),\\end{aligned}\\ ] ] where @xmath286 is a prior satisfying condition @xmath294 .",
    "the proof of lemma [ prop : entropy ] is given in section [ sec : pr : propent ] . in the next section we prove lemma [ lem : discrapproxboundary ] .",
    "consider @xmath295 the discrete distribution constructed in lemma [ lem : kl : pn ] , which we write as @xmath296 , with @xmath297 , @xmath298 $ ] , @xmath299 , @xmath300 and @xmath301 for some @xmath302 and with @xmath303 and @xmath304 , with @xmath305 defined as in lemma [ lem : kl : pn ]",
    ".    set @xmath306 $ ] , with @xmath307 and @xmath308 , @xmath309 and define for @xmath310 @xmath311 note that for all @xmath312 , @xmath313 .",
    "let @xmath314 with @xmath315 if @xmath145 and @xmath316 if @xmath147 and set @xmath317 .",
    "then for all @xmath318 and all @xmath319 , lemma [ lem : kl : discrete2 ] implies that @xmath320 if @xmath302 is large enough ( depending on @xmath321 ) .    to prove lemma [ lem : discrapproxboundary ]",
    ", we thus need to bound from below @xmath322 .",
    "denote @xmath323 , @xmath324 with @xmath325 in the @xmath326 type prior case .",
    "note that for large @xmath327 , @xmath328^{1-a_1}\\\\ & = & c z^{b(1-a_1 ) } ,    \\end{aligned}\\ ] ] and similarly @xmath329 . for small @xmath330 , @xmath331^{a_0'+1 }   =    c z^{-a(a_0'+1)},\\ ] ] and similarly @xmath332 .",
    "hence we have @xmath333 with @xmath334 .    in particular , we have that @xmath335 for the dp prior , and @xmath336 also , we have that @xmath337    note that for @xmath338 $ ] , @xmath339 , and for @xmath340 , @xmath341 .",
    "adapting lemma 6.1 of @xcite to the case of hyperparameters @xmath342 of the dirichlet distribution possibly greater than @xmath343 , we obtain : @xmath344 using condition @xmath345 on @xmath41 we have that @xmath346 , replacing @xmath347 by its expression terminates the proof of lemma  [ lem : discrapproxboundary ] for the dp prior .    for the mixture",
    "prior satisfying @xmath345 , we have @xmath348 which terminates the proof .",
    "take any @xmath349 , that is , @xmath350 such that @xmath351 , @xmath352 $ ] and @xmath353 $ ] for @xmath354 .",
    "fix @xmath355 for the constant @xmath33 to be defined below , and @xmath356 .",
    "let @xmath357 be the following set @xmath358 with @xmath359 , and @xmath360 with @xmath361 .",
    "in particular , for any @xmath362 for some @xmath363 , @xmath364 .",
    "let @xmath365 be an @xmath366-net for @xmath367 .",
    "define @xmath368 \\end{array }   \\right\\}.\\end{aligned}\\ ] ]    now we show that @xmath369 is a @xmath370-net of @xmath371 : @xmath372 the second term is less than @xmath366 by the definition of @xmath371 .",
    "the last term is bounded in the same way as in @xcite by @xmath373 .    to bound the third term , we first bound the @xmath24 distance between the two gamma densities using lemma [ l1:geps ] : @xmath374 by the definition of @xmath375 .",
    "to bound the first term , we bound the kullback - leibler distance between the corresponding probability distributions : @xmath376 \\\\ & = & 0.5 ( \\hat{z}-z)^2 [ -z_c^{-1 } + \\psi_1(z_c)]\\end{aligned}\\ ] ] for some @xmath377 between @xmath47 and @xmath378 where @xmath379 is the trigamma function .",
    "it is known that as @xmath380 , @xmath381 , and as @xmath192 , @xmath382 which implies that for both @xmath47 large and small , @xmath383 which implies that we can bound the kullback - leibler distance as @xmath384\\leq c ( \\hat{z}/z-1)^2 \\leq c \\delta_2 ^ 2\\end{aligned}\\ ] ] for an appropriate constant @xmath33 .",
    "therefore , the first term is bounded by @xmath385 by the definition of @xmath386 .    now we study cardinality of set @xmath357 .",
    "for each @xmath352 $ ] , @xmath387 for large @xmath388 to due to @xmath389 for @xmath390 and assuming that @xmath292 .",
    "cardinality of @xmath365 is @xmath391 ( * ? ? ?",
    "* proof of proposition 2 ) .",
    "then , for @xmath292 , the cardinality of @xmath369 is bounded by @xmath392^{j } \\lesssim   \\left[\\frac{\\log(b / a)\\sqrt{\\bar{z}}}{\\varepsilon^2 } \\right]^{j } \\frac{\\log(\\bar{z}/\\underline{z } ) } { \\varepsilon}\\end{aligned}\\ ] ] due to @xmath393 and by the definition of @xmath394 .    therefore , combining all the inequalities together , we obtain that latexmath:[\\ ] ] the first integral is finite .",
    "the second integral is finite if @xmath891 for @xmath228 and for @xmath858 , i.e. for @xmath892 and @xmath893 .",
    "the authors are grateful to the royal society for financial support for mutual visits ( international exchange grant ie140183 ) , and to oleg lepski for fruitful discussions about the functional classes ."
  ],
  "abstract_text": [
    "<S> we consider the problem of bayesian density estimation on the positive semiline for possibly unbounded densities . </S>",
    "<S> we propose a hierarchical bayesian estimator based on the gamma mixture prior which can be viewed as a location mixture . </S>",
    "<S> we study convergence rates of bayesian density estimators based on such mixtures . </S>",
    "<S> we construct approximations of the local hlder densities , and of their extension to unbounded densities , to be continuous mixtures of gamma distributions , leading to approximations of such densities by finite mixtures . </S>",
    "<S> these results are then used to derive posterior concentration rates , with priors based on these mixture models . </S>",
    "<S> the rates are minimax ( up to a log n term ) and since the priors are independent of the smoothness the rates are adaptive to the smoothness . </S>"
  ]
}