{
  "article_text": [
    "suppose that people are asked to select items which are classified into categories or groups and there are some restrictions on combinations of choices . for example , when a consumer buys a car , he or she can choose various options , such as a color , a grade of air conditioning , a brand of audio equipment , etc . due to space restrictions for example , some combinations of options may not be available .",
    "the problem we consider in this paper is testing independence of people s preferences in group - wise selections in the presence of restrictions .",
    "we assume that observations are the counts of people choosing various combinations in group - wise selections , i.e. , the data are given in a form of a multiway contingency table with some structural zeros corresponding to the restrictions .",
    "if there are @xmath0 groups of items and a consumer freely chooses just one item from each group , then the combination of choices is simply a cell of an @xmath0-way contingency table",
    ". then the hypothesis of independence reduces to the complete independence model of an @xmath0-way contingency table . the problem becomes harder if there are some additional conditions in a group - wise selection .",
    "a consumer may be asked to choose up to two items from a group or there may be a restriction on the total number of items .",
    "groups may be nested , so that there are further restrictions on the number of items from subgroups .",
    "some restrictions may concern several groups or subgroups .",
    "therefore the restrictions on combinations may be complicated .    as a concrete example we consider restrictions on choosing subjects in the _ national center test _",
    "( nct hereafter ) for university entrance examinations in japan .",
    "due to time constraints of the schedule of the test , the pattern of restrictions is rather complicated .",
    "however we will show that restrictions of nct can be described in terms of a segre - veronese configuration .",
    "another important application of this paper is a generalization of the hardy - weinberg model in population genetics .",
    "we are interested in testing various hypotheses of independence involving genotypes at more than one locus and haplotypes of combination of alleles on the same chromosome .",
    "although this problem seems to be different from the above introductory motivation on consumer choices , we can imagine that each offspring is required to choose two alleles for each gene ( locus ) from a pool of alleles for the gene .",
    "he or she can choose the same allele twice ( homozygote ) or different alleles ( heterozygote ) . in the hardy - weinberg model",
    "two choices are assumed to be independently and identically distributed .",
    "a natural generalization of the hardy - weinberg model for a single locus is to consider independence of genotypes of more than one locus . in many epidemiological studies ,",
    "the primary interest is the correlation between a certain disease and the genotype of a single gene ( or the genotypes at more than one locus , or the haplotypes involving alleles on the same chromosome ) .",
    "further complication might arise if certain homozygotes are fatal and can not be observed , thus becoming a structural zero .",
    "in this paper we consider conditional tests of independence hypotheses in the above two important problems from the viewpoint of markov bases and grbner bases .",
    "evaluation of @xmath1-values by markov chain monte carlo ( mcmc ) method using markov bases and grbner bases was initiated in diaconis and sturmfels ( 1998 ) .",
    "see also sturmfels ( 1995 ) .",
    "since then , this approach attracted much attention from statisticians as well as algebraists .",
    "contributions of the present authors are found , for example , in aoki and takemura ( 2005 , 2007 ) , ohsugi and hibi ( 2005 , 2006 , 2007 ) , and takemura and aoki ( 2004 ) .",
    "methods of algebraic statistics are currently actively applied to problems in computational biology ( pachter and sturmfels , 2005 ) . in algebraic statistics , results in commutative algebra may find somewhat unexpected applications in statistics . at the same time statistical problems may present new problems to commutative algebra .",
    "a recent example is a conjunctive bayesian network proposed in beerenwinkel _",
    "( 2006 ) , where a result of hibi ( 1987 ) is successfully used . in this paper we present application of results on segre - veronese configuration to testing independence in nct and hardy - weinberg models .",
    "in fact , these statistical considerations have prompted further theoretical developments of grbner bases for segre - veronese type configurations and we will present these theoretical results in our subsequent paper ( aoki et al . , 2007 ) .    even in two - way tables , if the positions of the structural zeros are arbitrary , then markov bases may contain moves of high degrees ( aoki and takemura , 2005 ) .",
    "see also huber _ et al . _",
    "( 2006 ) and rapallo ( 2006 ) for markov bases of the problems with the structural zeros .",
    "however if the restrictions on the combinations can be described in terms of a segre - veronese configuration , then an explicit form of a grbner basis consisting of binomials of degree two with a squarefree initial term is readily available for running a markov chain for performing conditional tests of various hypotheses of independence .",
    "therefore models which can be described by a segre - veronese configuration are very useful for statistical analysis .",
    "the organization of this paper is as follows . in section 2 ,",
    "we introduce two examples of group - wise selection . in section 3",
    ", we give a formalization of conditional tests and mcmc procedures and consider various hypotheses of independence for nct data and the allele frequency data . in section 4 , we define segre - veronese configuration .",
    "we give an explicit expression of a reduced grbner basis for the configuration and describe a simple procedure for running mcmc using the basis for conditional tests . in section 5",
    "we present numerical results on nct data and diplotype frequencies data .",
    "we end the paper by some discussions in section 6 .",
    "in this section , we introduce two examples of group - wise selection . in section 2.1 , we take a close look at patterns of selections of subjects in nct . in section 2.2 , we illustrate an important problem of population genetics from the viewpoint of group - wise selection .      one important example of group - wise selection is the entrance examination for universities in japan . in japan , as the common first - stage screening process , most students applying for universities take the national center test for university entrance examinations administered by national center for university entrance examinations ( ncuee ) .",
    "basic information in english on nct in 2006 is available from the booklet published by ncuee ( [ 12 ] in the references ) . after obtaining the score of nct",
    ", students apply to departments of individual universities and take second - stage examinations administered by the universities . due to time constraints of the schedule of nct , there are rather complicated restrictions on possible combination of subjects .",
    "furthermore each department of each university can impose different additional requirement on the combinations of subjects of nct to students applying to the department .    in nct examinees can choose subjects in mathematics , social studies and science .",
    "these three major subjects are divided into subcategories .",
    "for example mathematics is divided into mathematics 1 and mathematics 2 and these are then composed of individual subjects . in",
    "the test carried out in 2006 , examinees could select two mathematics subjects , two social studies subjects and three science subjects at most as shown below .",
    "the details of the subjects can be found in web pages and publications of ncuee . in this paper , we omit mathematics for simplicity , and only consider selections in social studies and science . in parentheses",
    "we show our abbreviations for the subjects in this paper .    * social studies : * * geography and history :  one subject from \\{world history a ( wha ) ,  world history b ( whb ) ,  japanese history a ( jha ) ,   japanese history b ( jhb ) ,  geography a ( geoa ) ,   geography b ( geob ) } * * civics :  one subject from \\{contemporary society ( contsoc ) ,  ethics , politics and economics ( p&e ) } * science : * * science @xmath2 :  one subject from \\{comprehensive science b ( cscib ) , biology i ( bioi ) ,  integrated science ( integs ) , biology ia ( bioia ) } * * science @xmath3 :  one subject from \\{comprehensive science a ( cscia ) , chemistry i ( chemi ) ,  chemistry ia ( chemia ) } * * science @xmath4 :  one subject from \\{physics i ( physi ) , earth science i ( earthi ) ,  physics ia ( physia ) ,  earth science ia ( earthia ) }    frequencies of the examinees selecting each combination of subjects in 2006 are given in the website of ncuee . we reproduce part of them in tables [ tbl : data - soc] [ tbl : data - sci3 ] at the end of the paper .",
    "as seen in these tables , examinees may select or not select these subjects .",
    "for example , one examinee may select two subjects from social studies and three subjects from science , while another examinee may select only one subject from science and none from social studies .",
    "hence each examinee is categorized into one of the @xmath5 combinations of individual subjects . here 1 is added for not choosing from the subcategory . as mentioned above",
    ", individual departments of universities impose different additional requirements on the choices of subjects of nct .",
    "for example , many science or engineering departments of national universities ask the students to take two subjects from science and one subject from social studies .",
    "let us observe some tendencies of the selections by the examinees to illustrate what kind of statistical questions one might ask concerning the data in tables [ tbl : data - soc][tbl : data - sci3 ] .",
    "* the most frequent triple of science subjects is \\{bioi , chemi , physi } in table [ tbl : data - sci3 ] , which seems to be consistent with table [ tbl : data - sci ] since these three subjects are the most frequently selected subjects in science 1 , science 2 and science 3 , respectively .",
    "however in table [ tbl : data - sci2 ] , while the pairs \\{bioi , chemi } and \\{chemi , physi } are the most frequently selected pairs in \\{science 1 , science2 } and \\{science 2 , science 3 } , respectively , the pair \\{bioi , physi } is not the first choice in \\{science 1 , science 3}. this fact indicates differences in the selection of science subjects between the examinees selecting two subjects and those selecting three subjects . * in table [ tbl : data - soc2 ] the most frequent pair is \\{geob , contsoc}. however the most frequent single subject from geography and history is jhb both in table [ tbl : data - soc ] and [ tbl : data - soc2 ] .",
    "this fact indicates the interaction effect in selecting pairs of social studies .",
    "these observations lead to many interesting statistical questions .",
    "however tables [ tbl : data - soc][tbl : data - sci3 ] only give frequencies of choices separately for social studies and science , i.e. , they are the marginal tables for these two major subjects . in this paper",
    "we are interested in independence across these two subjects , such as `` are the selections on social studies and science related or not ? ''",
    "we give various models for nct data in section 3.2 and numerical analysis in section 5.1 .",
    "we also consider problems of population genetics in this paper .",
    "this is another important application of the methodology of this paper .",
    "the allele frequency data are usually given as the genotype frequency .",
    "for multi - allele locus with alleles @xmath6 , the probability of the genotype @xmath7 in an individual from a random breeding population is @xmath8 @xmath9 or @xmath10 @xmath11 , where @xmath12 is the proportion of the allele @xmath13 .",
    "these are known as the hardy - weinberg equilibrium probabilities .",
    "since the hardy - weinberg law plays an important role in the field of population genetics and often serves as a basis for genetic inference , much attention has been paid to tests of the hypothesis that a population being sampled is in the hardy - weinberg equilibrium against the hypothesis that disturbing forces cause some deviation from the hardy - weinberg ratio .",
    "see crow ( 1988 ) and guo and thompson ( 1992 ) for example .",
    "though guo and thompson ( 1992 ) consider the exact test of the hardy weinberg equilibrium for multiple loci , exact procedure becomes infeasible if the data size or the number of alleles is moderately large .",
    "therefore mcmc is also useful for this problem .",
    "takemura and aoki ( 2004 ) considers conditional tests of hardy - weinberg model by using mcmc and the technique of markov bases .    due to the rapid progress of sequencing technology ,",
    "more and more information is available on the combination of alleles on the same chromosome .",
    "a combination of alleles at more than one locus on the same chromosome is called a haplotype and data on haplotype counts are called haplotype frequency data .",
    "the haplotype analysis has gained an increasing attention in the mapping of complex - disease genes , because of the limited power of conventional single - locus analyses .",
    "haplotype data may come with or without pairing information on homologous chromosomes .",
    "it is technically more difficult to determine pairs of haplotypes of the corresponding loci on a pair of homologous chromosomes .",
    "a pair of haplotypes on homologous chromosomes is called a diplotype . in this paper",
    "we are interested in diplotype frequency data , because haplotype frequency data on individual chromosomes without pairing information are standard contingency table data and can be analyzed by statistical methods for usual contingency tables . for the diplotype frequency data , the null model we want to consider is the independence model that the probability for each diplotype is expressed by the product of probabilities for each genotype .",
    "we consider the models for genotype frequency data in section 3.3.1 and then consider the models for diplotype frequency data in section 3.3.2 .",
    "note that the availability of haplotype data or diplotype data requires a separate treatment in our arguments .",
    "finally we give numerical examples of the analysis of diplotype frequencies data in section 5.2 .",
    "first we give a brief review on performing mcmc for conducting conditional tests based on the theory of markov basis .",
    "markov basis was introduced by diaconis and sturmfels ( 1998 ) and there are now many references on the definition and the use of markov basis ( e.g. aoki and takemura , 2006 ) .",
    "we denote the space of possible selections as @xmath14 .",
    "each element @xmath15 in @xmath14 represents a combination of choices . following the terminology of contingency tables , each @xmath16",
    "is called a _",
    "cell_. it should be noted that unlike the case of standard multiway contingency tables , our index set @xmath14 can not be written as a direct product in general .",
    "we show the structures of @xmath14 for nct data and allele frequency data in section 3.2 and section 3.3 , respectively .",
    "let @xmath17 denote the probability of selecting the combination @xmath15 ( or the probability of cell @xmath15 ) and write @xmath18 . in this paper",
    ", we do not necessarily assume that @xmath19 is normalized .",
    "in fact , in the models we consider in this paper , we only give an unnormalized functional specification of @xmath20 .",
    "note that we need not calculate the normalizing constant @xmath21 for performing a mcmc procedure .",
    "denote the result of the selections by @xmath22 individuals as @xmath23 , where @xmath24 is the frequency of the cell @xmath15 .",
    "we call @xmath25 a frequency vector .    in the models considered in this paper , the cell probability @xmath17 is written as some product of functions , which correspond to various marginal probabilities .",
    "let @xmath26 denote the index set of the marginals .",
    "then our models can be written as @xmath27 where @xmath28 is a known function and @xmath29 s are the parameters .",
    "an important point here is that the sufficient statistic @xmath30 is written in a matrix form as @xmath31 where @xmath32 is @xmath33 matrix of non - negative integers and @xmath34 , @xmath35 .",
    "we call @xmath32 a _ configuration _ in connection with the theory of toric ideals in section 4 .    by the standard theory of conditional tests ( lehmann and romano , 2005 , for example ) , we can perform conditional test of the model ( [ eq : general - model ] ) based on the conditional distribution given the sufficient statistic @xmath36 .",
    "the conditional sample space given @xmath36 , called the @xmath36-fiber , is @xmath37 where @xmath38 .",
    "if we can sample from the conditional distribution over @xmath39 , we can evaluate @xmath1-values of any test statistic .",
    "one of the advantages of mcmc method of sampling is that it can be run without evaluating the normalizing constant .",
    "also once a connected markov chain over the conditional sample space is constructed , then the chain can be modified to give a connected and aperiodic markov chain with the stationary distribution by the metropolis - hastings procedure ( e.g. hastings , 1970 ) .",
    "therefore it is essential to construct a connected chain and the solution to this problem is given by the notion of _ markov basis _ ( diaconis and sturmfels , 1998 ) .",
    "the fundamental contribution of diaconis and sturmfels ( 1998 ) is to show that a markov basis is given as a binomial generator of the well - specified polynomial ideal ( toric ideal ) and it can be given as a grbner basis . in section 4 , we show that our problem considered in section 3.2 and 3.3 corresponds to a well - known toric ideal and give an explicit form of the reduced grbner basis .      following the general formalization in section 3.1 , we formulate data types and their statistical models in view of nct .",
    "suppose that there are @xmath40 different groups ( or categories ) and @xmath41 different subgroups in group @xmath42 for @xmath43 .",
    "there are @xmath44 different _ items _ in subgroup @xmath45 of group @xmath42 ( @xmath46 , @xmath43 ) . in nct , @xmath47 , @xmath48 and similarly @xmath49 .",
    "the sizes of subgroups are @xmath50 and similarly @xmath51 , @xmath52 , @xmath53 , @xmath54 .",
    "each individual selects @xmath55 items from the subgroup @xmath45 of group @xmath42 .",
    "we assume that the total number @xmath56 of items chosen is fixed and common for all individuals .",
    "in nct @xmath55 is either 0 or 1 .",
    "for example if an examinee is required to take two science subjects in nct , then @xmath57 is @xmath58 , @xmath59 or @xmath60 . for the analysis of genotypes in section [ sec : hw ] ,",
    "@xmath61 although there is no nesting of subgroups , and the same item ( allele ) can be selected more than once ( selection `` with replacement '' ) .",
    "we now set up our notation for indexing a combination of choices somewhat carefully . in nct , if an examinee chooses wha from `` geography and history '' of social studies and physi from science 3 of science , we denote the combination of these two choices as ( 111)(231 ) . in this notation ,",
    "the selection of @xmath55 items from the subgroup @xmath45 of group @xmath42 are indexed as @xmath62 here @xmath63 is regarded as a string .",
    "if nothing is selected from the subgroup , we define @xmath63 to be an empty string .",
    "now by concatenation of strings , the set @xmath64 of combinations is written as @xmath65 for example the choice of ( p&e , bioi , chemi ) in nct is denoted by @xmath66 . in the following we denote @xmath67 if @xmath68 appears as a substring of @xmath15 .",
    "now we consider some statistical models for @xmath19 .",
    "for nct data , we consider three simple statistical models , namely , _ complete independence model _",
    ", _ subgroup - wise independence model _ and _ group - wise independence model_. the complete independence model is defined as @xmath69 for some parameters @xmath70 .",
    "note that if @xmath71 we need a multinomial coefficient in ( [ eq : complete - independece ] ) .",
    "the complete independence model means that each @xmath17 , the inclination of the combination @xmath15 , is explained by the set of inclinations @xmath72 of each item . here",
    "@xmath73 corresponds to the marginal probability of the item @xmath74 .",
    "however we do not necessarily normalize them as @xmath75 , because the normalization for @xmath19 is not trivial anyway .",
    "the same comment applies to other models below .",
    "similarly , the subgroup - wise independence model is defined as @xmath76 for some parameters @xmath77 , and the group - wise independence model is defined as @xmath78 for some parameters @xmath79 .    in this paper",
    ", we treat these models as the _ null models _ and give testing procedures to assess their fitting to observed data following the general theory in section 3.1 .",
    "we assume that there are @xmath40 distinct loci . in the locus @xmath42",
    ", there are @xmath80 distinct alleles , @xmath81 . in this case",
    ", we can imagine that each individual selects two alleles for each locus _ with replacement_. therefore the set of the combinations is written as @xmath82    for the genotype frequency data , we consider two models of hierarchical structure , namely , _ genotype - wise independence model _ @xmath83 and the hardy - weinberg model @xmath84 where @xmath85 note that for both cases the sufficient statistic @xmath36 can be written as @xmath86 for an appropriate matrix @xmath32 as shown in section [ subsec : diplo - data ] .      in order to illustrate the difference between genotype data and diplotype data , consider a simple case of @xmath87 and suppose that genotypes of @xmath88 individuals are given as @xmath89 in this genotype data , for an individual who has homozygote genotype on at least one loci , the diplotypes are uniquely determined .",
    "however , for the fourth individual who has the genotype @xmath90 , there are two possible diplotypes as @xmath91 and @xmath92 .",
    "now suppose that information on diplotypes are available .",
    "the set of combinations for the diplotype data is given as @xmath93 in order to determine the order of @xmath94 and @xmath95 uniquely , we assume that these two are lexicographically ordered , i.e. , there exists some @xmath42 such that @xmath96 unless @xmath97 .    for the parameter @xmath98 where @xmath17 is the probability for the diplotype @xmath15",
    ", we can consider the same models as for the genotype case .",
    "corresponding to the null hypothesis that diplotype data do not contain more information than the genotype data , we can consider the genotype - wise independence model ( [ eq : genotype - indepedent ] ) and the hardy - weinberg model ( [ eq : genetype - hw ] ) .",
    "the sufficient statistics for these models are the same as in the previous subsection .    if these models are rejected , we can further test independence in diplotype data .",
    "for example we can consider a haplotype - wise hardy - weinberg model . @xmath99",
    "the sufficient statistic for this model is given by the set of frequencies of each haplotype and the conditional test can be performed as in the case of hardy - weinberg model for a single gene by formally identifying each haplotype as an allele .",
    "in this section , we introduce toric ideals of algebras of segre - veronese type ( ohsugi and hibi , 2000 ) with a generalization to fit statistical applications in the present paper .    first we define toric ideals .",
    "a _ configuration _ in @xmath100 is a finite set @xmath101 .",
    "@xmath32 can be regarded as a @xmath33 matrix and corresponds to the matrix connecting the frequency vector to the sufficient statistic as in ( [ eq : t = ax ] ) .",
    "let @xmath102 be a field and @xmath103=k[q_1 , \\dots , q_{d}]$ ] the polynomial ring in @xmath104 variables over @xmath102 .",
    "we associate a configuration @xmath105 with the semigroup ring @xmath106 = k[\\qb^{\\ab_1 } , \\ldots , \\qb^{\\ab_{\\nu}}]$ ] where @xmath107 if @xmath108 .",
    "note that @xmath34 and @xmath109 corresponds to to the term @xmath110 on the right - hand side of ( [ eq : general - model ] ) .",
    "let @xmath111 = k[w_1,\\ldots , w_{\\nu}]$ ] be the polynomial ring in @xmath112 variables over @xmath102 . here",
    "@xmath35 and the variables @xmath113 correspond to the cells of @xmath14 .",
    "the _ toric ideal _",
    "@xmath114 of @xmath115 is the kernel of the surjective homomorphism @xmath116 \\to k[\\ac]$ ] defined by setting @xmath117 for all @xmath118 .",
    "it is known that the toric ideal @xmath114 is generated by the binomials @xmath119 , where @xmath120 and @xmath121 are monomials of @xmath111 $ ] , with @xmath122 .",
    "more precisely , @xmath114 is written as @xmath123 where @xmath124 with @xmath125 .",
    "we call an integer vector @xmath126 a _ move _ if @xmath127 .    the _ initial ideal _ of @xmath128 with respect to a monomial order is the ideal of @xmath111 $ ] generated by all initial monomials of nonzero elements of @xmath128",
    ". a finite set @xmath129 of @xmath128 is called a _ grbner basis _ of @xmath128 with respect to a monomial order @xmath130 if the initial ideal of @xmath128 with respect to @xmath130 is generated by the initial monomials of the polynomials in @xmath129 .",
    "a grbner basis @xmath129 is called _ reduced _ if , for each @xmath131 , none of the monomials in @xmath132 is divisible by the initial monomials of @xmath133 for some @xmath134 . it is known that if @xmath129 is a grbner basis of @xmath128 , then @xmath128 is generated by @xmath129 . in general , the reduced grbner basis of a toric ideal consists of binomials .",
    "see chapter 4 of sturmfels ( 1995 ) for the details of toric ideals and grbner bases .    the following proposition associates markov bases with toric ideals .    a set of moves @xmath135 is a markov basis if and only if @xmath128 is generated by binomials @xmath136 , @xmath137 , @xmath138 .",
    "we now introduce the notion of algebras of segre - veronese type .",
    "fix integers @xmath139 , @xmath140 and sets of integers @xmath141 , @xmath142 , @xmath143 and @xmath144 such that    1 .",
    "@xmath145 for all @xmath146 ; 2 .",
    "@xmath147 for all @xmath146 .",
    "let @xmath148 denote the configuration consisting of all nonnegative integer vectors @xmath149 such that    1 .",
    "@xmath151 for all @xmath146 .",
    "let @xmath152 $ ] denote the affine semigroup ring generated by all monomials @xmath153 over @xmath102 and call it an _ algebra of segre - veronese type_. note that the present definition generalizes the definition in ohsugi and hibi ( 2000 ) .",
    "several popular classes of semigroup rings are algebras of segre - veronese type . if @xmath154 , @xmath155 , @xmath156 , @xmath157 , @xmath158 and @xmath159 , then the affine semigroup ring @xmath152 $ ] is the segre product of polynomial rings @xmath160 $ ] and @xmath161 $ ] . on the other hand , if @xmath162 , @xmath163 , @xmath164 and @xmath165 for all @xmath146 , then the affine semigroup ring @xmath152 $ ] is the classical @xmath56th veronese subring of the polynomial ring @xmath166 $ ] . moreover , if @xmath162 , @xmath163 , @xmath167 and @xmath165 for all @xmath146 , then the affine semigroup ring @xmath152 $ ] is the @xmath56th squarefree veronese subring of the polynomial ring @xmath166 $ ] . in addition",
    ", algebras of veronese type ( i.e. , @xmath162 , @xmath163 and @xmath165 for all @xmath146 ) are studied in de negri and hibi ( 1997 ) and sturmfels ( 1995 ) .",
    "let @xmath168 $ ] denote the polynomial ring with the set of variables @xmath169 where @xmath152=k[\\qb^{\\ab_1 } , \\ldots , \\qb^{\\ab_{\\nu}}]$ ] .",
    "the toric ideal @xmath170 is the kernel of the surjective homomorphism @xmath171 \\longrightarrow   k[\\aaa ] $ ] defined by @xmath172 .",
    "a monomial @xmath173 is called _ sorted _ if @xmath174 let @xmath175 denote the operator which takes any string over the alphabet @xmath176 and sorts it into weakly increasing order .",
    "then the quadratic grbner basis of toric ideal @xmath177 is given as follows .",
    "[ thm : gb ] work with the same notation as above .",
    "then there exists a monomial order on @xmath168 $ ] such that the set of all binomials @xmath178 is the reduced grbner basis of the toric ideal @xmath177 .",
    "the initial ideal is generated by squarefree quadratic ( nonsorted ) monomials .",
    "in particular , the set of all integer vectors corresponding to the above binomials is a markov basis .",
    "furthermore the set is minimal as a markov basis .",
    "_ the basic idea of the proof appears in theorem 14.2 in sturmfels ( 1995 ) .",
    "let @xmath129 be the above set of binomials .",
    "first we show that @xmath179 .",
    "suppose that @xmath180 is not sorted and let @xmath181 then , @xmath0 is squarefree since the monomial @xmath182 is sorted . since the binomial @xmath183 $ ] belongs to @xmath170 if and only if @xmath184 , it is sufficient to show that both @xmath185 and @xmath186 are variables of @xmath168 $ ] . for @xmath187",
    ", let @xmath188 and @xmath189 .",
    "since @xmath190 , @xmath191 and @xmath192 are either equal or they differ by one for each @xmath193 . if @xmath194 , then @xmath195 .",
    "since @xmath196 , we have @xmath197 and @xmath198 . thus @xmath199 . if @xmath200 , then @xmath201 . since @xmath196 , we have @xmath202 and @xmath203 . thus @xmath204",
    ". hence @xmath185 and @xmath186 are variables of @xmath168 $ ] .    by virtue of relation between the reduction of a monomial by @xmath129 and sorting of the indices of a monomial",
    ", it follows that there exists a monomial order such that , for any binomial in @xmath129 , the first monomial is the initial monomial .",
    "see also theorem 3.12 in sturmfels ( 1995 ) .",
    "suppose that @xmath129 is not a grbner basis .",
    "thanks to macaulay s theorem , there exists a binomial @xmath205 such that both monomials in @xmath206 are sorted .",
    "this means that @xmath207 and @xmath206 is not a binomial .",
    "hence @xmath129 is a grbner basis of @xmath170 .",
    "it is easy to see that the grbner basis @xmath129 is reduced and a minimal set of generators of @xmath177 .",
    "finally we describe how to run a markov chain using the grbner basis given in theorem [ thm : gb ] .",
    "first , given a configuration @xmath32 in ( [ eq : t = ax ] ) , we check that ( with appropriate reordering of rows ) that @xmath32 is indeed a configuration of segre - veronese type .",
    "it is easy to check that our models in sections [ sec : nct - models ] and [ sec : hw ] are of segre - veronese type , because the restrictions on choices are imposed separately for each group or each subgroup .",
    "recall that each column of @xmath32 consists of non - negative integers whose sum @xmath56 is common .",
    "we now associate to each column @xmath208 of @xmath32 a set of indices indicating the rows with positive elements @xmath209 and a particular index @xmath210 is repeated @xmath211 times .",
    "for example if @xmath212 and @xmath213 , then row 1 appears once and row 3 appears twice in @xmath208 .",
    "therefore we associate the index @xmath214 to @xmath208 .",
    "we can consider the set of indices as @xmath215 matrix @xmath216 .",
    "note that @xmath217 and @xmath32 carry the same information .",
    "given @xmath216 , we can choose a random element of the reduced grbner basis of theorem [ thm : gb ] as follows .",
    "choose two columns ( i.e.  choose two cells from @xmath64 ) of @xmath216 and sort @xmath218 elements of these two columns .",
    "from the sorted elements , pick alternate elements and form two new sets of indices .",
    "for example if @xmath219 and the two chosen columns of @xmath216 are @xmath214 and @xmath220 , then by sorting these 6 elements we obtain @xmath221 . picking alternate elements",
    "produces @xmath222 and @xmath223 .",
    "these new sets of indices correspond to ( a possibly overlapping ) two columns of @xmath216 , hence to two cells of @xmath64 .",
    "now the difference of the two original columns and the two sorted columns of @xmath216 correspond to a random binomial in ( [ eq : binomial ] ) .",
    "it should be noted that when the sorted columns coincide with the original columns , then we discard these columns and choose other two columns .",
    "the rest of the procedure for running a markov chain is described in diaconis and sturmfels ( 1998 ) .",
    "see also aoki and takemura ( 2006 ) .",
    "in this section we present numerical experiments on nct data and a diplotype frequency data .",
    "first we consider the analysis of nct data concerning selections in social studies and science . because ncuee currently do not provide cross tabulations of frequencies of choices across the major subjects",
    ", we can not evaluate the @xmath1-value of the actual data .",
    "however for the models in section [ sec : nct - models ] , the sufficient statistics ( the marginal frequencies ) can be obtained from tables @xmath224 [ tbl : data - sci3 ] .",
    "therefore in this section we evaluate the conditional null distribution of the pearson s @xmath225 statistic by mcmc and compare it to the asymptotic @xmath225 distribution .    in section [ sec : nct - models ] , we consider three models , complete independence model , subgroup - wise independence model and group - wise independence model , for the setting of group - wise selection problems .",
    "note that , however , the subgroup - wise independence model coincides with the group - wise independence model for nct data , since @xmath226 for all @xmath42 and @xmath45 .",
    "therefore we consider fitting of the complete independence model and the group - wise independence model for nct data .",
    "as we have seen in section 2.1 , there are many kinds of choices for each examinee .",
    "however , it may be natural to treat some similar subjects as one subject .",
    "for example , wha and whb may well be treated as wh , chemi and chem ia may well be treated as chem , and so on . as a result , we consider the following aggregation of subjects .    * in social studies : wh = \\{wha , whb } , jh = \\{jha , jhb } , geo = \\{geoa , geob } * in science : csib = \\{csib , isci } , bio = \\{bioi , bioia } , chem = \\{chemi , chemia } , phys = \\{physi , physia } , earth = \\{earthi , earthia }    in our analysis , we take a look at examinees selecting two subjects for social studies and two subjects for science . therefore @xmath227 the number of possible combination is then @xmath228 .",
    "accordingly our sample size is @xmath229 , which is the number of examinees selecting two subjects on science from table [ tbl : data - sci ] .",
    "our data set is shown in table  [ tbl : data - nct - imaginary ] ."
  ],
  "abstract_text": [
    "<S> we consider testing independence in group - wise selections with some restrictions on combinations of choices . </S>",
    "<S> we present models for frequency data of selections for which it is easy to perform conditional tests by markov chain monte carlo ( mcmc ) methods . when the restrictions on the combinations can be described in terms of a segre - veronese configuration , an explicit form of a grbner basis consisting of binomials of degree two is readily available for performing a markov chain . </S>",
    "<S> we illustrate our setting with the national center test for university entrance examinations in japan . </S>",
    "<S> we also apply our method to testing independence hypotheses involving genotypes at more than one locus or haplotypes of alleles on the same chromosome . </S>"
  ]
}