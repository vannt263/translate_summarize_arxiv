{
  "article_text": [
    "the aim of this section is to present numerical results obtained with the wkb - coupling scheme introduced in section [ sec2 ] and to compare these results with the error analysis established in section [ sec34 ] . in particular , we present the results for 3 zones ( oscillating - evanescent - oscillating , cf .  [ sec22 ] ) corresponding to the passage or flow of electrons through a tunnelling structure ( see fig .",
    "[ fig:4.1 ] ) , with a piecewise linear and , respectively , piecewise quadratic potential @xmath22 , chosen such that the phase @xmath352 is explicitly calculable .",
    "the reason for such a choice is to avoid having to care about the @xmath406 error term in ( [ error_z_2ord ] ) , yielding hence an asymptotically correct scheme for fixed @xmath407 and @xmath198 .    .",
    "red curve : piecewise linear potential @xmath22 with applied bias ( since @xmath408 ) .",
    "it is discontinuous at @xmath409 and @xmath410 .",
    "blue curve : @xmath411 , real part of the wave function that is partly transmitted , but mainly reflected in this example ; @xmath412 .",
    "green line : energy of the injected plane wave with @xmath413 .",
    "( colours only online ) ]    we start with the piecewise linear potential graphed in fig .",
    "[ fig:4.1 ] .",
    "note the small applied bias with @xmath414 , @xmath415 .    in fig .",
    "[ err_inf ] we plotted the numerical errors of the coupling method associated to the wave function @xmath5 ( left figure ) and to its derivative @xmath416 ( right figure ) , as functions of the mesh size @xmath10 ( in @xmath417 scale ) and for three different @xmath19-values . in the oscillating regions we chose the second order method ( [ marching - scheme])-([transfo_zu ] ) and in the evanescent region the fem ( [ vf_ev_h ] ) .",
    "the plotted errors are the @xmath51-errors between the numerical solution on the whole interval @xmath28 $ ] and a reference solution , computed with the same scheme but on a finer grid of @xmath418 points .",
    "it can be observed that the slopes in these two plots are approximatively one ( for @xmath419 ) and improving to @xmath420 for smaller values of @xmath10 . for @xmath421 the slope of the @xmath5error",
    "even improves up to 2 for the smallest values of @xmath10 .",
    "this behaviour is in accordance with our numerical analysis in theorem [ th : hybrid - conv](c ! ) .",
    "the @xmath19-dependence seems to be like @xmath422 ( for large values of @xmath19 ) , improving to @xmath423 ( for small values of @xmath19 ) , and even @xmath424 ( for small values of @xmath19 and large @xmath10 ) .",
    "summarizing , the error of @xmath5 shows to be of order @xmath425 , which corresponds exactly to the estimates given in theorem [ th : hybrid - conv](c ) .",
    "the error of @xmath426 shows to be of order @xmath427 , which is even slightly better than the estimate from theorem [ th : hybrid - conv](c ) ( in the sense of including also an @xmath428behaviour )",
    ".     absolute error ( in the @xmath51-norm and @xmath417 scale ) between the computed solution and a reference solution ( obtained with @xmath429 ) , for the piecewise linear potential from fig .",
    "[ fig:4.1 ] . left : @xmath430 .",
    "right : @xmath431.,title=\"fig:\",width=226 ] absolute error ( in the @xmath51-norm and @xmath417 scale ) between the computed solution and a reference solution ( obtained with @xmath429 ) , for the piecewise linear potential from fig .",
    "[ fig:4.1 ] . left : @xmath430 .",
    "right : @xmath431.,title=\"fig:\",width=226 ]    we mention that the obtained numerical errors are mainly those introduced by the wkb - fem of the evanescent region . indeed , in this evanescent region",
    ", the numerical error of the wkb - fem is larger than the one obtained from the second order wkb marching method of the oscillating region ( compare the estimates in the theorems [ ev_conv ] and [ thm_princ ] ) .",
    "+ next we consider a piecewise quadratic potential given by @xmath432 \\cup [ x_d,1]\\ , ; \\quad a(x):=-c_1 ( x + c_2)^2\\,,\\quad \\forall x \\in ( x_c , x_d)\\,,\\ ] ] with @xmath409 , @xmath433 and @xmath434    before turning to the error plots we consider the condition number associated to solving the discrete variational problem ( [ vf_ev_h ] ) in the ( intermediate ) evanescent region . in fig .",
    "[ cond - number ] we plot this condition number as a function of @xmath10 , for three different values of @xmath19 . for @xmath435 it grows like @xmath436",
    "when @xmath437 , and for @xmath438 it grows like @xmath439 ( on the shown interval of @xmath10-values ) .",
    "we remark that this behaviour is not a problem in practice : for large @xmath19 , the solution @xmath383 is _ not _ highly oscillatory and hence does not need a high spatial resolution . for small values of @xmath19 , even a fine resolution would only lead to moderate condition numbers .",
    "indeed , one observes a decrease of the condition number when @xmath19 gets smaller .",
    "this important feature is somehow related to the _ asymptotic - preserving _ property of the scheme .",
    "condition number for the discrete bvp in example 2 , as a function of @xmath10 , for three values of @xmath19.,width=226 ]    large condition numbers signify that the errors of numerical experiments also include significant contributions stemming from round - of errors and their accumulation .",
    "while the method - error ( as estimated in theorem [ th : hybrid - conv](c ) ) decreases with decreasing @xmath10 , the round - of errors could then increase in some situations , due to the increasing condition number .",
    "these arguments may lead to the idea that one can not trust too much the reference solution in fig .",
    "[ err_inf ] , computed with @xmath418 points . in order to verify this suspicion , we decided to plot in the case of a piecewise quadratic potential two types of error curves .    to be more precise , in fig .",
    "[ vq_err_inf ] we show the numerical errors of the wave function @xmath5 ( left figure ) and its derivative @xmath416 ( right figure ) , as functions of the mesh size @xmath10 ( in @xmath417 scale ) and for four different @xmath19-values .",
    "the dashed lines correspond ( as in example 1 ) to the @xmath51-error between the numerical solution on the whole interval @xmath28 $ ] and a reference solution , computed with the same scheme but on a finer grid ( here @xmath440 ) whereas the solid lines correspond to the _ incremental error _ when iteratively doubling the grid size , i.e. @xmath441 with @xmath442 . for a first order method ,",
    "the former error is about twice as large as the latter ( incremental ) error .",
    "this can be understood from the geometric series of the incremental errors , since the summands then differ by a factor of about 2 . in fig .",
    "[ vq_err_inf ] this difference is clearly visible for the solid red curves , pertainin !",
    "g to @xmath443 , and the corresponding dashed error curves ( for large @xmath10 ) . the minimum of the incremental error ( as a function of @xmath10 ) indicates the onset of significant round - of errors when reducing @xmath10 . in fig .",
    "[ vq_err_inf ] this is best visible for the solid blue and red curves , pertaining to @xmath435 .",
    "furthermore remark that for @xmath444 and @xmath419 , the error slopes are approximately one  just like in example 1 . for smaller values of @xmath10",
    "the error then gets polluted by round - of errors . for @xmath445",
    "the shown errors seem to be mostly due to round - of errors .",
    "they again increase for @xmath446",
    ".     absolute error ( in the @xmath51-norm and @xmath417 scale ) between the computed solution and a reference solution , for a piecewise quadratic potential . left : @xmath430 .",
    "right : @xmath431 . for the dashed curves ,",
    "@xmath447 is computed with @xmath440 .",
    "the solid curves show the _ incremental error _ when refining the mesh by a factor two .",
    "left : @xmath441 . right : @xmath448.,title=\"fig:\",width=226 ] absolute error ( in the @xmath51-norm and @xmath417 scale ) between the computed solution and a reference solution , for a piecewise quadratic potential .",
    "left : @xmath430 .",
    "right : @xmath431 . for the dashed curves ,",
    "@xmath447 is computed with @xmath440 .",
    "the solid curves show the _ incremental error _ when refining the mesh by a factor two .",
    "left : @xmath441 .",
    "right : @xmath448.,title=\"fig:\",width=226 ]",
    "a _ turning point _ of the schrdinger equation ( [ eq_ref ] ) is defined as a zero of the given coefficient function @xmath1 .",
    "accordingly one also speaks about the _ order of a turning point_. we first remark that both error analyses , in  [ sec32 ] for the wkb - fem and in @xcite for the wkb - marching method are _ not _",
    "valid for turning points .",
    "therefore , we assumed in hypothesis a and b that @xmath1 is bounded away from zero . furthermore , in the convergence theorems [ ev_conv ] and [ thm_princ ] we did not keep track how the leading constant @xmath229 grows with @xmath449 .",
    "however , the failure of both wkb methods when approaching turning points also appeared in our numerical experiments ( not included here ) .",
    "the paper @xcite considers a matrix generalization of our equation ( [ eq_ref ] ) , but only for the oscillatory case .",
    "their coefficient matrix @xmath450 ( generalizing our @xmath1 ) is there assumed to be symmetric positive definite , satisfying the uniform lower bound @xmath451 .",
    "the proof of their theorem 6.1 shows that their @xmath51error bounds would grow like @xmath452 ) .",
    "this numerical failure can be understood easily : the wkb - ansatz ( [ wkb])-([evwkb - fct ] ) is not valid at turning points .",
    "in fact , close to a turning point of first order , solutions to ( [ eq_ref ] ) are neither exponential nor oscillatory , but in a transition layer of thickness @xmath453 they behave rather like airy functions : indeed , for @xmath454 , a solution basis for ( [ eq_ref ] ) is given by ai@xmath455 , bi@xmath455 , where ai and bi denote the airy functions of first and second kinds .    at a turning point",
    "the solution to ( [ eq_ref ] ) clearly satisfies @xmath456 .",
    "this motivated to use linear fem - ansatz functions in the numerical cell containing a turning point ( cf .",
    " 3.2.2 in @xcite ) .",
    "the quest for an appropriate replacement of the wkb - ansatz close to turning points has a long history in asymptotic analysis , starting with langer @xcite : for general coefficients @xmath1 with a zero , he found an asymptotic approximation for the solution of ( [ eq_ref ] ) that is valid uniformly in @xmath43 , including the turning point . for a first order turning point",
    "his approximation is a composite function involving airy functions and the phase function ( like @xmath457 defined in ( [ notz ] ) ) . for details on first order turning points we refer to  4.3 in @xcite , and to  7.3 in @xcite for higher order turning points .",
    "the above mentioned approximation formulas of langer have also been used for numerical computations , mostly for schrdinger eigenvalue problems @xcite . in the physics literature , this strategy is frequently called _ modified airy function _ ( maf ) technique .",
    "it relies on evaluating the explicit formulas of approximate solutions , but it has not been the starting point of constructing a ( convergent ) numerical method . in a follow - up paper",
    "we shall use langer s approximation functions as ansatz - functions for an @xmath19uniform numerical method that should also cover turning points .",
    "this paper is concerned with a 1d schrdinger scattering problem in the semi - classical limit , with the inflow given by plane waves .",
    "the injection energy and potential are given such that the problem involves both oscillatory and evanescent regions .",
    "for the continuous boundary value problem we presented a new , non - overlapping domain decomposition method that separates the oscillatory and evanescent subproblems .",
    "the former are treated as ivps , and the latter as bvps .",
    "key issues of this approach are the appropriate interface conditions and the final scaling of the solution function .",
    "we proved that the domain decomposition method yields the exact solution in a single sweep , performed in the opposite direction of the wave injection .",
    "the hybrid numerical discretization is based on wkb - methods in both types of regions : a wkb - fem for evanescent regions @xcite , and a wkb - marching method for oscillatory regions @xcite .",
    "the objective of these wkb - methods is to provide an accurate solution  even on coarse grids and independently of @xmath458 .",
    "hence , they are _",
    "asymptotic preserving_. for the first time we present an error analysis for the wkb - fem method .",
    "together with the analysis of the wkb - marching method from @xcite , this constitutes the key ingredient for our complete convergence analysis of the hybrid wkb - method . finally , these error bounds are illustrated and verified in numerical experiments .",
    "+ the bvp ( [ schbvp ] ) is equivalent to the schrdinger equation ( [ eq_ref ] ) on the real line with constant potentials in the leads , and with an incoming plane wave at @xmath31 . using the right bc from ( [ schbvp ] ) ,",
    "its solution in the right lead @xmath459 hence reads @xmath460 to estimate the reflection coefficient @xmath461 , we consider the current defined in ( [ current ] ) . at @xmath31",
    "it reads @xmath462      = \\eps \\sqrt{\\alpha(1 ) } \\,(|r|^2 - 1 ) \\ , . \\ ] ] but using the left bc from ( [ schbvp ] ) yields @xmath463 = 0\\,.\\ ] ] since the current in a stationary quantum model is constant in @xmath43 , this implies @xmath464 .",
    "then ( [ lead - sol ] ) implies @xmath465 with this bound for the initial condition at @xmath31 we now consider the ivp ( [ eq_ref ] ) on @xmath275 $ ] .",
    "then , theorem 2.2 from @xcite yields the asserted estimate ( [ 2-zone - bound ] ) on the oscillatory region .",
    "+ for the evanescent region @xmath185 $ ] we consider the scaled , real valued solution @xmath81 of the bvp ( [ region1_ev ] ) . with an elementary argument we first show that @xmath81 has no zero in @xmath185 $ ] : + assuming the opposite , let @xmath466 , which implies @xmath467 ( as otherwise @xmath468 )",
    ". then @xmath81 is convex on one side of @xmath469 and concave on the other side , with @xmath470 due to @xmath471 .",
    "but then @xmath472 and @xmath473 would have opposite signs , contradicting the left bc in ( [ region1_ev ] ) .",
    "so we conclude that @xmath81 does not change signs in @xmath185 $ ] . + assume now that @xmath474 which implies @xmath475 by the left bc in ( [ region1_ev ] ) .",
    "since then @xmath476 on @xmath384 we conclude @xmath477 , contradicting the right bc in ( [ region1_ev ] ) .",
    "+ this implies that @xmath478 , and we finally obtain @xmath479 after scaling this auxiliary function , we find that also @xmath480 and @xmath481 are increasing on @xmath185 $ ] . therefore the uniform bound ( [ 2-zone - bound ] ) carries over from @xmath69 to the evanescent region @xmath185 $ ] .",
    "the first author was supported by the fwf - doctoral school `` dissipation and dispersion in non - linear partial differential equations '' , the ad - amadeus project `` quantum transport models for semiconductors and bose - einstein condensates '' , universit de toulouse , and by _ clear sky ventures_. he also thanks kirian dpfner for illustrating simulations for  5 . the second author would like to acknowledge support from the anr project moonrise ( models , oscillations and numerical schemes , 2015 - 2019 ) .",
    "9 a. arnold , _ mathematical properties of quantum evolution equations _ , in quantum transport - modelling , analysis and asymptotics , lecture notes in mathematics 1946 , g. allaire , a. arnold , p. degond , th.y .",
    "hou , springer , berlin , 2008 .",
    "a. arnold , n. ben abdallah , c. negulescu , _ wkb - based schemes for the oscillatory 1d schrdinger equation in the semi - classical limit _",
    ", siam j. numer .",
    "49 ( 2011 ) , no .",
    ". n. ben abdallah , p. degond , p. a. markowich , _ on a one - dimensional schrdinger - poisson scattering model _",
    ", zamp 48 ( 1997 ) , pp .",
    ". n. ben abdallah , o. pinaud , _ multiscale simulation of transport in an open quantum system : resonances and wkb interpolation _",
    ", j. comput .",
    "phys . , 213 ( 2006 ) , no .",
    "1 , pp . 288310 .",
    "ghatak , r.l .",
    "gallawa , i.c .",
    "goyal , _ modified airy function and wkb solutions to the wave equation _ , nist monograph 176 , 1991 .",
    "ghatak , r.l .",
    "gallawa , i.c .",
    "goyal , _ accurate solutions to schrdinger s equation using modified airy functions _ , ieee j. of quantum electr . , 28 ( 1992 ) , no .",
    "2 , pp . 400403 .",
    "holmes , _ introduction to perturbation methods _",
    ", springer - verlag , new york , 1995 .",
    "f. ihlenburg , i. babuka , _ finite element solution of the helmholtz equation with high wave number .",
    "i. the @xmath10-version of the fem _ ,",
    "appl . , 30 ( 1995 ) , no .",
    "9 , pp . 937 .",
    "f. ihlenburg , i. babuka , _ finite element solution of the helmholtz equation with high wave number .",
    "ii . the @xmath10-@xmath482 version of the fem _ , siam j. numer . anal .",
    ", 34 ( 1997 ) , no .",
    "1 , pp . 315358",
    ". t. jahnke , c. lubich , _ numerical integrators for quantum dynamics close to the adiabatic limit _ ,",
    "numerische mathematik , 94 ( 2003 ) , pp .",
    "landau , e.m .",
    "lifschitz , _ quantenmechanik _ , akademie - verlag , berlin , 1985 .",
    "langer , _ on the asymptotic solutions of ordinary differential equations , with an application to the bessel functions of large order _ , transact .",
    "ams , 33 ( 1931 ) , no .",
    "1 , pp . 2364 . c. s. lent ,",
    "d. j. kirkner , _ the quantum transmitting boundary method _ , j. appl .",
    "phys . , 67 ( 1990 ) , pp .",
    ". k. lorenz , t. jahnke , c. lubich , _ adiabatic integrators for highly oscillatory second - order linear differential equations with time - varying eigendecomposition _ , bit , 45 ( 2005 ) , no .",
    "1 , pp . 91115 .",
    "nayfeh , _ perturbation methods _ , wiley , new york , 1973 . c. negulescu , _ asymptotic models and numerical schemes for quantum systems _",
    ", phd - thesis at universit paul sabatier , toulouse , 2005 .",
    "c. negulescu , _ numerical analysis of a multiscale finite element scheme for the resolution of the stationary schroedinger equation _ , numerische mathematik , 108 ( 2008 ) , no .",
    "4 , pp . 625652 . c. negulescu , n. ben abdallah , m. mouis , _ an accelerated algorithm for 2d simulations of the quantum ballistic transport in nanoscale mosfets _ , journal of computational physics , 225 ( 2007 ) , no .",
    "1 , pp . 7499 .",
    "smith , a.r .",
    "baghai - wadji , _ a numerical technique for solving schrdingers equation in molecular electronic applications _ ; in : _ smart structures , devices , and systems iv _ , ( s.f .",
    "al - sarawi , v.k .",
    "varadan , n. weste , k. kalantar - zadeh , eds . ) , proc . of spie vol . 7268 , 2008 ."
  ],
  "abstract_text": [
    "<S> this paper is concerned with a 1d schrdinger scattering problem involving both oscillatory and evanescent regimes , separated by jump discontinuities in the potential function , to avoid `` turning points '' . </S>",
    "<S> we derive a non - overlapping domain decomposition method to split the original problem into sub - problems on these regions , both for the continuous and afterwards for the discrete problem . further </S>",
    "<S> , a hybrid wkb - based numerical method is designed for its efficient and accurate solution in the semi - classical limit : a wkb - marching method for the oscillatory regions and a fem with wkb - basis functions in the evanescent regions . </S>",
    "<S> we provide a complete error analysis of this hybrid method and illustrate our convergence results by numerical tests .    </S>",
    "<S> schrdinger equation , highly oscillating wave functions , evanescent wave functions , higher order wkb - approximation , domain decomposition method , numerical analysis , stiffness - independent error estimates , asymptotic analysis , tunnelling structures .    </S>",
    "<S> [ sec1 ] this paper deals with the design , error analysis , and numerical study of an asymptotically correct scheme for the numerical solution of the stationary schrdinger equation in one dimensional scattering situations : [ eq_ref ] ^2  ( x ) + a(x ) ( x ) = 0 , x , where @xmath0 is a very small parameter and @xmath1 a piecewise ( sufficiently ) smooth , real function . on the one hand , for @xmath2 , </S>",
    "<S> the solution is highly oscillatory , with the small ( local ) wave length @xmath3 . on the other hand , for @xmath4 , </S>",
    "<S> the wave function @xmath5 is ( essentially ) exponentially de / increasing , typically exhibiting a thin boundary layer with thickness of the order @xmath6 . </S>",
    "<S> a key aspect of this paper is that @xmath1 takes both signs . </S>",
    "<S> hence , we have to cope with a classical multi - scale problem , combining different types of arduousnesses and multi - scale behaviours . numerically , we aim at recovering these fine structures of the solution , however _ without _ using a fine spatial grid . to this end </S>",
    "<S> we shall develop a ( non - overlapping ) domain decomposition method ( ddm ) to separate the oscillatory and evanescent regions , as they require very different numerical approaches . </S>",
    "<S> this ddm allows to recover at the continuous level the exact analytical solution in a single sweep ( ag ! ainst the direction of the incoming plane wave ) with appropriate interface conditions and a final scaling . </S>",
    "<S> + the study of such multi - scale problems is very challenging from a theoretical as well as numerical point of view . in both situations ( or regions ) a classical discretization ( like in @xcite ) requires a very fine mesh in order to accurately resolve the oscillations and boundary layers . </S>",
    "<S> however , with a step size requirement of @xmath7 , standard numerical methods would be very costly and inefficient here .    </S>",
    "<S> concerning the _ oscillatory case _ , several wkb - based numerical schemes ( named after the physicists wentzel , kramers , and brillouin ) have been developed and analysed in the last decade . </S>",
    "<S> their goal is to use a coarse spatial grid with step size @xmath8 ( see figure [ onde ] ) , reducing the limitation to at least @xmath9 . for marching schemes we refer to @xcite , whereas a finite element method ( fem ) using oscillatory wkb - basis functions was introduced in  2 of @xcite and in @xcite . </S>",
    "<S> this fem approach has the disadvantage that it requires a non - resonance condition between the mesh - size @xmath10 and the wave length @xmath11 of the solution . </S>",
    "<S> by contrast , this restriction is not necessary in the above mentioned marching schemes </S>",
    "<S> .     in standard numerical methods highly oscillating solutions require a very fine mesh to capture the oscillations . </S>",
    "<S> however , with the analytic pre - processing of our wkb - marching method an accurate solution can be obtained on a coarse grid ( dots ) . </S>",
    "<S> plotted is the solution @xmath12 of ( [ eq_ref ] ) with @xmath13 and @xmath14.,width=226 ]    numerical approaches for the _ evanescent regime _ ( as @xmath15 ) have been considered much less , so far . </S>",
    "<S> we refer to  3 in @xcite for the formulation of a wkb - based multiscale fem - scheme , including its numerical coupling to the oscillatory region ( also based on a fem ) . but a numerical analysis has , to our knowledge , not been carried out yet . </S>",
    "<S> this paper also aims at closing this gap . in this evanescent regime </S>",
    "<S> the problem ( [ eq_ref ] ) is elliptic , and for the example of @xmath16 , a solution is given by a linear combination of the basis - functions @xmath17 . </S>",
    "<S> hence this region must be considered as a boundary value problem ( bvp ) and solved e.g.  by a finite difference or a fem method . a reformulation as an initial value problem ( ivp ) and the use of a marching scheme would be inherently unstable , due to the unbounded growth of @xmath18 ( in @xmath19 ) . </S>",
    "<S> this contrasts with the oscillatory regime , where a basis of the solution would be given by the bounded functions @xmath20 . </S>",
    "<S> consequently , we are faced with coupling two different approaches for solving ( [ eq_ref ] ) in the semi - classical limit : an ivp for @xmath2 and a bvp for @xmath4 . </S>",
    "<S> + the goal of this paper is to analyse the numerical coupling of oscillatory and evanescent regimes , using wkb - ansatz functions for both situations . in the oscillatory regime </S>",
    "<S> we shall use the marching scheme from @xcite , and in the evanescent regime a fem like in  3 of @xcite . in the first case , </S>",
    "<S> the key idea is to eliminate analytically the dominant oscillations of the solution to ( [ eq_ref ] ) . </S>",
    "<S> the transformed problem then has a much smoother solution , in the sense that the amplitude of the residual oscillations is much smaller than in the original problem  often by many orders of magnitude ( in fact by the order @xmath21 , cf . </S>",
    "<S> propositions 2.1 , 2.2 in @xcite ) . </S>",
    "<S> hence , the new problem can be solved numerically on a coarse grid , still yielding a very accurate approximation . in the evanescent regime , </S>",
    "<S> the key idea of the wkb - fem method is to use wkb - ansatz functions ( of exponential type ) , rather than the standard polynomials . </S>",
    "<S> finally the strategy is the same as in the oscillatory region : to filter out the boundary layer via well - chosen basis functions . </S>",
    "<S> since wkb - basis functions are asymptotic solutions to ( [ eq_ref ] ) ( as @xmath15 ) , this method is again very accurate on a coarse grid . in this paper </S>",
    "<S> we shall provide first the numerical analysis of the wkb - fem method for the evanescent regime ( from scratch ) , and then the error analysis of the hybrid ddm  </S>",
    "<S> building on the convergence results in @xcite for the wkb - marching method . </S>",
    "<S> + problems similar to ( [ eq_ref ] ) or in general that require the numerical integration of highly oscillatory equations play an essential role in a wide range of physical phenomena : e.g. electromagnetic and acoustic scattering ( maxwell and helmholtz equations in the high frequency regime ) , wave evolution problems in quantum and plasma physics ( schrdinger equation in the semi - classical regime ) , and stiff mechanical systems . </S>",
    "<S> the application we are interested in here , stems from the electron transport in nanoscale semiconductor devices , like quantum wave - guides @xcite , resonant tunnelling diodes ( rtds ) @xcite , mosfets @xcite , etc . in a 1d model </S>",
    "<S> setting , which is appropriate for rtds or for the longitudinal dynamics in each transversal mode in mosfets , the governing equation is the stationary schrdinger equation . in an idealized model </S>",
    "<S> we assume that the given electrostatic potential @xmath22 is constant in the left lead @xmath23 $ ] , with value @xmath24 , and equally in the right lead @xmath25 , with value @xmath26 . </S>",
    "<S> hence the schrdinger equation can be complemented with open boundary conditions at both ends : [ schbvp ] \\ {    l - ^2  ( x ) + v(x ) ( x)=e ( x ) , x ( 0,1 ) , + (0)+i ( 0 ) = 0 , a(0)>0 , + (0)- ( 0 ) = 0 , a(0)<0 , + (1 ) -i ( 1 ) = -2 i .    . </S>",
    "<S> a(x):=e - v(x ) , this equation describes the state of an electron that is injected with the prescribed energy @xmath27 from the right boundary ( or lead ) into an electronic device ( diode , e.g. ) , modelled on the interval @xmath28 $ ] . </S>",
    "<S> the corresponding ( complex valued ) wave function is denoted by @xmath29 , where @xmath30 is related to the spatial probability density of the electron . due to the continuous injection of a plane wave function at @xmath31 </S>",
    "<S> , we can not expect @xmath32 to be normalised here ( in @xmath33 ) . </S>",
    "<S> when considering the equivalent problem on @xmath34 , @xmath5 rather describes a scattering state with @xmath35 . </S>",
    "<S> the small parameter @xmath36 is the re - scaled planck constant . to make the link with ( [ eq_ref ] ) , the coefficient function @xmath1 is given by @xmath37 </S>",
    "<S> to allow for an injection at @xmath31 , we have to require that @xmath38 , cf .  </S>",
    "<S> figure [ injection ] . </S>",
    "<S> in fact , @xmath39 characterises the oscillatory , classically allowed regime , whereas @xmath40 characterises the evanescent , classically forbidden regime . </S>",
    "<S> fig .  </S>",
    "<S> [ injection ] sketches a tunnelling structure including both regimes , which are rather different . </S>",
    "<S> the boundary conditions in ( [ schbvp ] ) are the so called open or _ transparent boundary conditions _ , permitting an electron wave to enter or leave the device without reflections @xcite . due to the injected plane wave of electrons , </S>",
    "<S> the boundary condition at @xmath31 is inhomogeneous . </S>",
    "<S> but at @xmath41 it is homogeneous , due to the free outflow of the electron wave .    in the present work we shall not discuss ( in detail ) situations with _ turning points _ , i.e.  zeros of @xmath42 , but rather concentrate on devices with abrupt jumps at the interfaces between oscillatory and evanescent regions . </S>",
    "<S> this first step is simpler to treat and will be extended in a subsequent work . in section [ sec5 ] </S>",
    "<S> we shall comment on situations incorporating turning points .    </S>",
    "<S> ( -4,-2)(23,15 ) ( -3,0)(21,0 ) ( 0,0)(0,11 ) ( 21.7,0)@xmath43 ( 0,11.7)@xmath22 ( 0,8)(18,8 ) ( 18.7,8)(20,8 ) ( 20.5,8)@xmath44 ( 0,6.5)(1.5,6.3)(3,6.0)(4.5,5.6)(6,5 ) ( 6,5)(6,10.6 ) ( 6,10.6)(7.5,10.4)(9,10.1)(10.5,9.7)(12,9.1 ) ( 12,9.1)(12,3.6 ) ( 12,3.6)(13.5,3.4)(15,3.1)(16.5,2.7)(18,2.1 ) ( 18,0)(18,10 ) ( 6,-0.2)(6,0.2 ) ( 6,0.2)(6,5 ) ( 12,-0.2)(12,0.2 ) ( 12,0.2)(12,3.6 ) ( 2.9,-0.7)@xmath2 ( 8.9,-0.7)@xmath4 ( 14.9,-0.7)@xmath2 ( 0,-0.5)0 ( 5.8,-0.5)@xmath45 ( 11.8,-0.5)@xmath46 ( 17.8,-0.5)@xmath47    for the solvability of this model , the following simple result holds :    [ prop1.1 ] let @xmath48 with @xmath49 and @xmath38 . and @xmath50 are not meant as the point values of the function @xmath42 ( which would not be defined for an @xmath51function ) , but rather as the constant potential in the left and , resp . </S>",
    "<S> , right leads . ] </S>",
    "<S> then the boundary value problem ( [ schbvp ] ) has a unique solution @xmath52 $ ] .    for the case of an oscillatory outflow , i.e. @xmath53 , the proof was provided in proposition 2.3 of @xcite . </S>",
    "<S> for an evanescent outflow , i.e. @xmath54 , the proof is analogous ( multiplying the schrdinger equation by @xmath55 , integrating by parts , and taking the imaginary part ) .    </S>",
    "<S> * wkb - technique . * + both parts of the hybrid numerical method studied in  [ sec3 ] will be based on wkb functions . </S>",
    "<S> hence , let us first review the well - known wkb - approximation ( cf .  </S>",
    "<S> @xcite ) for the singularly perturbed ode ( [ eq_ref ] ) . in the standard approach , for the oscillatory regime ( i.e.  @xmath56 ) </S>",
    "<S> , the wkb - ansatz @xmath57 is inserted in ( [ eq_ref ] ) and after comparison of the @xmath58-terms , leads to @xmath59 truncating the ansatz ( [ wkb ] ) after @xmath60 or 2 , yields the asymptotic approximation @xmath61 , with the following _ oscillatory wkb - functions _ ( of the three lowest orders in @xmath19 ) : @xmath62{a(x)}}\\,,\\\\    \\varphi_2^{os}(x)&=&\\frac{\\exp\\left(\\pm\\frac{\\i}{\\eps}\\int_0^x\\big[\\sqrt{a(y)}-\\eps^2\\beta(y)\\big]\\,dy   \\right)}{\\sqrt[4]{a(x)}}\\,.\\nonumber\\end{aligned}\\ ] ]    proceeding analogously for the evanescent regime ( i.e.  @xmath63 ) yields the following _ evanescent wkb - functions _ ( of the three lowest orders in @xmath19 ) : @xmath64{|a(x)|}}\\,,\\\\    \\varphi_2^{ev}(x)&=&\\frac{\\exp\\left(\\pm\\frac{1}{\\eps}\\int_0^x\\big[\\sqrt{|a(y)|}+\\eps^2\\beta(y)\\big]\\,dy   \\right)}{\\sqrt[4]{|a(x)|}}\\,.\\nonumber\\end{aligned}\\ ] ]    in the hybrid numerical method analysed in  [ sec3 ] </S>",
    "<S> we shall use the first order wkb ansatz functions @xmath65 for the fem in the evanescent region . and in the oscillatory region we shall use the second order wkb functions @xmath66 to transform ( [ eq_ref ] ) into a smoother problem that can be solved accurately and efficiently on a coarse grid . since we shall use two different numerical approaches in the two regimes , </S>",
    "<S> also the corresponding error orders will be rather different ( both with respect to @xmath19 and to the grid size @xmath10 ) . </S>",
    "<S> hence there is , a - priori , no obvious natural choice for the orders of the two wkb - methods . </S>",
    "<S> we choose a first order wkb - method in the evanescent region to keep the complexity of the numerical scheme and the technicalities of its convergence analysis low . </S>",
    "<S> furthermore we choose a second order wkb - method in the oscillatory region such that we can use the results from @xcite ( without having to redo a first order wkb - analysis ) . </S>",
    "<S> anyhow , our hybrid method is second order with respect to @xmath10 . </S>",
    "<S> + this paper is organised as follows . in section [ sec2 ] </S>",
    "<S> we present and analyse the ( non - overlapping ) domain decomposition method for the singularly perturbed ode ( [ eq_ref ] ) on the continuous level . </S>",
    "<S> propositions [ prop2.2 ] and [ prop2.5 ] establish that this ddm yields the analytical solution in one sweep for cases consisting of two and , resp . </S>",
    "<S> , three distinct regions . in  [ sec3 ] </S>",
    "<S> we first review the two different numerical wkb - methods for the two distinct regions and establish convergence of the wkb - fem . </S>",
    "<S> then we prove convergence of the overall hybrid wkb - method ( wkb - fem in the evanescent regime coupled to a wkb - marching scheme for the oscillatory region ) , with theorem [ th : hybrid - conv ] as the main result . in  </S>",
    "<S> [ sec4 ] we illustrate our convergence results on some numerical examples treated with our scheme , including an example with a tunnelling structure . and finally , in  [ sec5 ] we briefly discuss extensions of our wkb method to coefficient functions with turning points .    </S>",
    "<S> [ sec2 ] in this section we shall consider the schrdinger bvp ( [ schbvp ] ) with given coefficient functions @xmath67 corresponding to two different scenarios  first two coupled regions , then three regions . </S>",
    "<S> we confine ourselves here to these examples only for practical reasons : this setup already shows all the interesting features of the bvp , and it can be generalised easily to more regions .      </S>",
    "<S> we start with the situation illustrated in figure [ 2regions ] : it consists of two regimes , an evanescent region with @xmath68 ( adjacent to the left boundary ) and an oscillatory region with @xmath56 ( adjacent to the right boundary ) . </S>",
    "<S> since we exclude turning points here , the function @xmath42 is assumed to have a jump discontinuity ( and a sign change ) at the interface @xmath69 . </S>",
    "<S> moreover , for this section we shall assume : + * hypothesis a2 * _ let @xmath48 with @xmath70 , @xmath71 , @xmath54 , and @xmath38 . _ +    ( -4,-2)(23,15 ) ( -3,0)(21,0 ) ( 0,0)(0,12 ) ( 21.7,0)@xmath43 ( 0,12.7)@xmath22 ( 0,8)(18,8 ) ( 18.7,8)(20,8 ) ( 20.5,8)@xmath44 ( 0,10)(2,10.6)(4,10.4)(6,9.7)(8,9.5)(10,9.1 ) ( 10,9.1)(10,3.6 ) ( 10,3.6)(12,3.5)(13.5,3.4)(15,3.1)(16.5,2.7)(18,2.1 ) ( 18,0)(18,10 ) ( -1,9)(1.5,9 ) ( 12.75,9)(15.25,9 ) ( 1.5,9.8)@xmath72 ( 10,-0.2)(10,0.2 ) ( 10,0.2)(10,3.6 ) ( 4.9,-0.7)@xmath4 ( 13.9,-0.7)@xmath2 ( 0,-0.5)0 ( 9.9,-0.5)@xmath46 ( 17.9,-0.5)@xmath47 ( 5,0.7)0.25 ( 5.0,0.7)@xmath47 ( 14,0.7)0.25 ( 14.0,0.7)@xmath73 ( 5,7)@xmath74 ( 14,7)@xmath75    following the basic idea from @xcite we shall solve the bvp ( [ schbvp ] ) as two consecutive sub - problems : we start with the evanescent region @xmath76 , where a bvp is solved ( for stability reasons , as mentioned in  [ sec1 ] ) . </S>",
    "<S> this is followed by an ivp on the oscillatory region @xmath77 . </S>",
    "<S> so we shall proceed in the opposite direction of the injection direction ( see figure [ 2regions ] ) . due to proposition [ prop1.1 ] , </S>",
    "<S> the solution to ( [ schbvp ] ) is in @xmath78 $ ] . </S>",
    "<S> hence the solutions on these two sub - regions are matched by continuity of @xmath5 and @xmath79 at @xmath69 . </S>",
    "<S> + for the bvp on @xmath76 , the original problem ( [ schbvp ] ) provides only one homogeneous robin boundary condition ( bc ) at @xmath41 . </S>",
    "<S> hence , we supply the bvp with an auxiliary , artificial bc at @xmath69 . here </S>",
    "<S> , both an inhomogeneous dirichlet or neumann bc would work from an algorithmic point of view . in order to simplify the numerical analysis in  </S>",
    "<S> [ sec311 ] below , we shall use at this point @xmath80 for the auxiliary wave function @xmath81 . while this auxiliary value has the correct @xmath19order ( cf . </S>",
    "<S> proposition [ prop2.2a ] and lemma [ u - estimate ] below ) , it will in general not be the correct derivative of the global solution @xmath5 . </S>",
    "<S> its correct value will finally be obtained by scaling the auxiliary functions using the remaining inhomogeneous robin bc at @xmath31 ( cf . </S>",
    "<S> ( [ schbvp ] ) ) . </S>",
    "<S> this leads to the following domain decomposition and problem coupling for the auxiliary wave functions @xmath82 : + [ region1_ev ] \\ {    l ^2  ( x ) + a(x ) ( x)=0 , x ( 0,x_d ) , a(x)= e -v(x ) < 0 , + (0 ) - ( 0)=0 , + (x_d ) = 1 .    .    </S>",
    "<S> [ region2_ev ] \\ {    l ^2  ( x ) + a(x ) ( x)=0 , x ( x_d,1 ) , a(x)= e -v(x)>0 , + ( x_d ) = ( x_d ) , + (x_d ) = (x_d)=1 .    .    </S>",
    "<S> [ psi - scaling_ev ] ( x):=\\ {    l ( x ) , x ( 0,x_d ) , + ( x ) , x ( x_d,1 ) ,    . with the scaling parameter </S>",
    "<S> @xmath83 defined via [ alpha - eq_ev ] = ( ( 1),(1))= , . </S>",
    "<S> we note that the denominator in this expression for @xmath84 is non - zero : on the one hand @xmath81 and @xmath85 are both real valued , and on the other hand @xmath86 and @xmath87 can not vanish simultaneously ( as otherwise @xmath88 would contradict the neumann bc in ( [ region1_ev ] ) ) .    in this whole section </S>",
    "<S> we shall only require that @xmath48 . </S>",
    "<S> as in proposition [ prop1.1 ] , @xmath89 and @xmath50 are hence not meant as the point values of the function @xmath42 , but rather as the constant potential in the left and right leads . </S>",
    "<S> + next we address the solvability of the algorithm ( [ region1_ev])-([alpha - eq_ev ] ) .    </S>",
    "<S> [ pb-2zones ] let hypothesis a2 be satisfied . </S>",
    "<S> then :    1 .   </S>",
    "<S> the bvp ( [ region1_ev ] ) has @xmath90 a unique solution @xmath91 $ ] . </S>",
    "<S> 2 .   </S>",
    "<S> the ivp ( [ region2_ev ] ) has @xmath90 a unique solution @xmath92 $ ] .    </S>",
    "<S> both functions @xmath81 and @xmath85 are real functions and the parameter @xmath93 given by ( [ alpha - eq_ev ] ) is well - defined .     +    the above lemma , whose proof is very easy , shows that the _ domain decomposition algorithm _ ( [ region1_ev])-([alpha - eq_ev ] ) yields a unique function @xmath5 that is piecewise in @xmath94 and piecewise ( on the two regions ) a solution to the schrdinger equation ( [ schbvp ] ) . </S>",
    "<S> in fact , this ddm yields the unique solution of ( [ schbvp ] ) as stated in the following proposition : [ prop2.2 ] let hypothesis a2 be satisfied </S>",
    "<S> . then the function @xmath5 obtained from ( [ region1_ev])-([alpha - eq_ev ] ) belongs to @xmath95 and is the unique solution of ( [ schbvp ] ) ( as guaranteed by proposition [ prop1.1 ] ) .    </S>",
    "<S> the initial conditions in ( [ region2_ev ] ) imply @xmath96continuity of @xmath5 at @xmath46 . hence , @xmath97 $ ] , and this proves the claim .    </S>",
    "<S> the following result provides the uniform - in-@xmath19 boundedness of this solution @xmath5 . </S>",
    "<S> it generalizes theorem 2.2 from @xcite , which holds only for one purely oscillatory region : [ prop2.2a ] let hypothesis a2 hold . </S>",
    "<S> moreover , let the potential in the oscillatory region satisfy @xmath98 and @xmath99 @xmath100 . </S>",
    "<S> then , the solution of ( [ schbvp ] ) satisfies @xmath101 independently of @xmath102 .    the simple , but lengthy proof is deferred to the appendix .      in this subsection </S>",
    "<S> we consider the schrdinger bvp ( [ schbvp ] ) with a given coefficient function @xmath1 as illustrated in figure [ 3regions ] : it consists of three regimes , two oscillatory regions at the interval boundaries and an evanescent region in the middle . since we exclude turning points here , @xmath42 is assumed to have jump discontinuities ( and sign changes ) at the interfaces @xmath103 and @xmath69 . </S>",
    "<S> the solution @xmath5 to the bvp ( [ schbvp ] ) for such an example is illustrated in fig .   </S>",
    "<S> [ fig:4.1 ] below . </S>",
    "<S> moreover , for this section we shall assume on @xmath1 : + * hypothesis a3 * _ let @xmath48 with @xmath104 , @xmath105 , @xmath53 , and @xmath38 . _ +    ( -4,-2)(23,15 ) ( -3,0)(21,0 ) ( 0,0)(0,11 ) ( 21.7,0)@xmath43 ( 0,11.7)@xmath22 ( 0,8)(18,8 ) ( 18.7,8)(20,8 ) ( 20.5,8)@xmath44 ( 0,6.5)(1.5,6.3)(3,6.0)(4.5,5.6)(6,5 ) ( 6,5)(6,10.6 ) ( 6,10.6)(7.5,10.4)(9,10.1)(10.5,9.7)(12,9.1 ) ( 12,9.1)(12,3.6 ) ( 12,3.6)(13.5,3.4)(15,3.1)(16.5,2.7)(18,2.1 ) ( 18,0)(18,10 ) ( -1,9)(1.5,9 ) ( 13.75,9)(16.25,9 ) ( 1.5,9.8)@xmath72 ( 6,-0.2)(6,0.2 ) ( 6,0.2)(6,5 ) ( 12,-0.2)(12,0.2 ) ( 12,0.2)(12,3.6 ) ( 2.9,-0.7)@xmath2 ( 8.9,-0.7)@xmath4 ( 14.9,-0.7)@xmath2 ( 0,-0.5)0 ( 5.8,-0.5)@xmath45 ( 11.8,-0.5)@xmath46 ( 17.8,-0.5)@xmath47 ( 3,0.7)0.25 ( 3.0,0.7)@xmath47 ( 9,0.7)0.25 ( 9.0,0.7)@xmath73 ( 15,0.7)0.25 ( 15.0,0.7)@xmath106 ( 3,7)@xmath107 ( 9,7)@xmath74 ( 15,7)@xmath75    following the basic idea from @xcite we shall solve the bvp ( [ schbvp ] ) as an ivp - bvp - ivp problem in the opposite direction of the injection direction , i.e.  starting at @xmath41 ( see figure [ 3regions ] ) . in ( [ schbvp ] ) </S>",
    "<S> , the robin boundary condition ( bc ) at @xmath41 only fixes the ratio @xmath108 , hence an auxiliary dirichlet ( or neumann ) boundary value has to be invoked here . </S>",
    "<S> its correct value will then be obtained by scaling the final equation using the inhomogeneous robin bc at @xmath31 . </S>",
    "<S> in contrast to @xcite , ( [ schbvp ] ) includes the evanescent region ( 2 ) , cf .  fig .  [ 3regions ] , which still has to be formulated as a bvp ( for stability reasons ) . </S>",
    "<S> this leads to the following domain decomposition and problem coupling for the auxiliary wave functions @xmath109 : + [ region1 ] \\ {    l ^2  ( x ) + a(x ) ( x)=0 , x ( 0,x_c ) , + ( 0 ) = 1 , + (0 ) = -i .    .    [ region2 ] \\ {    l ^2  ( x ) + a(x ) ( x)=0 , x ( x_c , x_d ) , + (x_c)(x_c ) - ( x_c)(x_c)=0 , + (x_d ) = 1 .    .    </S>",
    "<S> [ region3 ] \\ {    l ^2  ( x ) + a(x ) ( x)=0 , x ( x_d,1 ) , + ( x_d ) = ( x_d ) , + (x_d ) = (x_d ) .    .    </S>",
    "<S> [ psi - scaling ] ( x):=\\ {    l ( x ) , x ( 0,x_c ) , + ( x ) , x ( x_c , x_d ) , + ( x ) , x ( x_d,1 ) ,    . with the scaling parameters </S>",
    "<S> @xmath110 still to be defined .    </S>",
    "<S> this procedure can be explained as follows : first we note that the bcs of ( [ region1 ] ) imply @xmath111 , just as in the left bc of the bvp ( [ schbvp ] ) . </S>",
    "<S> hence , the ivp ( [ region1 ] ) coincides on region ( 1 ) with the bvp ( [ schbvp ] ) , except for the auxiliary dirichlet bc @xmath112 . </S>",
    "<S> the true solution of ( [ schbvp ] ) satisfies instead @xmath113 with some a - priori unknown @xmath114 . </S>",
    "<S> hence , the auxiliary wave function @xmath115 is related to @xmath5 by the scaling @xmath116}=\\beta\\zeta$ ] , as postulated in the first line of ( [ psi - scaling ] ) . clearly , this implies @xmath117 on @xmath118 $ ] . in the above step 2 </S>",
    "<S> , the robin bc allows to carry over this relation to region ( 2 ) : @xmath119 , and the auxiliary wave function @xmath81 is related to @xmath5 by the scaling @xmath120}=\\alpha\\chi$ ] , with some @xmath83 to be determined . </S>",
    "<S> the initial conditions for the auxiliary wave function @xmath85 in step 3 imply @xmath96continuity of @xmath5 when using again the scaling @xmath121}=\\alpha\\varphi$ ] .    </S>",
    "<S> so far , the wave function @xmath5 defined in ( [ psi - scaling ] ) neither satisfies continuity at @xmath45 nor the right bc from ( [ schbvp ] ) . therefore we define the scaling parameters @xmath110 via @xmath122=-2i \\sqrt{a(1 ) } \\,,\\qquad \\mbox{(due to the right bc in { ( \\ref{schbvp } ) } ) }    \\label{alpha - eq}\\\\    & & \\qquad \\beta\\,\\zeta(x_c)=\\alpha\\,\\chi(x_c ) \\,.\\qquad\\qquad\\qquad\\qquad\\qquad\\:\\:\\ : \\mbox{(implies continuity of $ \\psi$ at $ x_c$ ) }    \\label{beta - eq}\\end{aligned}\\ ] ]    [ rem2.1 ] the key aspect of the above algorithm is to prescribe in the bvp ( [ region2 ] ) the continuity of @xmath123 to @xmath124 at @xmath45 . </S>",
    "<S> note that this continuity is invariant under the scaling ( [ psi - scaling ] ) . </S>",
    "<S> hence it is inherited by @xmath125 , implying ( with the continuity of @xmath5 ) the required @xmath96continuity of @xmath5 . the simpler alternative to prescribe in ( [ region2 ] ) continuity of @xmath115 to @xmath81 </S>",
    "<S> would typically be paired with a discontinuity of @xmath126 to @xmath127 at @xmath103 ( as a result of solving the bvp ) . </S>",
    "<S> then , the scaling of ( [ psi - scaling ] ) would lead to an unwanted discontinuity of @xmath79 at @xmath103 .    </S>",
    "<S> [ bvp-3zones ] let hypothesis a3 be satisfied . </S>",
    "<S> then :    1 .   the ivps ( [ region1 ] ) , resp . </S>",
    "<S> ( [ region3 ] ) admit @xmath90 unique solutions @xmath128 $ ] , resp . </S>",
    "<S> @xmath129 $ ] . </S>",
    "<S> 2 .   </S>",
    "<S> the bvp ( [ region2 ] ) has @xmath90 a unique solution @xmath130 $ ] . </S>",
    "<S> 3 .   the scaling parameters @xmath131 are well - defined by ( [ alpha - eq ] ) , ( [ beta - eq ] ) .    part ( i ) is straightforward . for ( ii ) , </S>",
    "<S> let us first consider the ivp ( [ region1 ] ) . </S>",
    "<S> its unique solution @xmath115 has the property : the values @xmath132 and @xmath133 are linearly independent over the field @xmath34 . </S>",
    "<S> otherwise , the backward ivp ( starting at @xmath45 ) would yield `` final values '' @xmath134 and @xmath135 that are linearly dependent over @xmath34 , which is in contradiction with the initial condition in ( [ region1 ] ) .    to solve the bvp ( [ region2 ] ) , let @xmath136 , @xmath137 be a ( real valued ) basis of solutions for that schrdinger equation on @xmath138 , with @xmath139 setting @xmath140 with some @xmath141 , the bcs of ( [ region2 ] ) give rise to the following linear equation : @xmath142 the determinant of this system satisfies @xmath143\\ne0 $ ] , since @xmath144 @xmath145 , but @xmath132 and @xmath133 are linearly independent over @xmath34 . </S>",
    "<S> hence , ( [ chi - coefficients ] ) is uniquely solvable for @xmath146 , thus providing the unique solution to ( [ region2 ] ) . </S>",
    "<S> + for part ( iii ) we shall first argue that ( [ alpha - eq ] ) yields a well - defined @xmath147 . to this end we shall prove that @xmath148 , using the quantum mechanical current of the model ( [ schbvp ] ) : @xmath149\\,.\\ ] ] assume now that @xmath150 . then , ( [ psi - scaling ] ) implies on the one hand @xmath151    </S>",
    "<S> = |\\alpha|^2 \\,\\sqrt{a(1)}\\,|\\varphi(1)|^2\\ge0\\,.\\ ] ] but , on the other hand , ( [ region1 ] ) yields @xmath152    = -|\\beta|^2 \\sqrt{a(0)}\\,|\\zeta(0)|^2\\le0\\,.\\ ] ] since the current in a stationary quantum model is constant in @xmath43 , this implies @xmath153 . </S>",
    "<S> since @xmath38 and @xmath154 ( otherwise @xmath155 would contradict the bc at @xmath31 in ( [ schbvp ] ) ) , ( [ current1 ] ) shows that @xmath156 , and hence by our assumption @xmath157 . but </S>",
    "<S> this leads to a contradiction in the bc at @xmath31 in ( [ schbvp ] ) . </S>",
    "<S> hence , ( [ alpha - eq ] ) yields indeed a unique @xmath147 .    </S>",
    "<S> finally , ( [ beta - eq ] ) yields a well - defined @xmath114 since @xmath132 and @xmath133 are linearly independent over @xmath34 ( as shown in part ( i ) above ) . </S>",
    "<S> moreover , @xmath158 since @xmath159 ( otherwise the first line of ( [ chi - coefficients ] ) would also yield @xmath160 ) .    </S>",
    "<S> the above lemma shows that the _ domain decomposition algorithm _ ( [ region1])-([beta - eq ] ) yields a unique function @xmath5 that is piecewise in @xmath94 and piecewise ( on the three regions ) a solution to the schrdinger equation ( [ schbvp ] ) . </S>",
    "<S> moreover , one has the proposition : [ prop2.5 ] let hypothesis a3 be satisfied . </S>",
    "<S> then the function @xmath5 obtained from ( [ region1])-([beta - eq ] ) belongs to @xmath95 and is the unique solution of ( [ schbvp ] ) ( as guaranteed by proposition [ prop1.1 ] ) . </S>",
    "<S> +    the matching conditions in ( [ region2 ] ) and ( [ beta - eq ] ) imply @xmath96continuity of @xmath5 at @xmath45 , and the initial conditions in ( [ region3 ] ) imply @xmath96continuity of @xmath5 at @xmath46 . hence , @xmath161 $ ] , and this proves the claim .    [ sec3 ] to keep the presentation simple we shall consider here only the two - zone model of  [ sec2.1 ] . it has a coefficient function @xmath1 that corresponds to figure [ 2regions ] . in the following subsections we shall thus study step by step the numerical errors obtained when solving the bvp ( [ region1_ev ] ) in the evanescent region with a multiscale wkb - fem and the ivp ( [ region2_ev ] ) in the oscillatory region with the marching method introduced in @xcite . </S>",
    "<S> we shall always assume that the phase function @xmath162 in the wkb - functions ( [ oswkb - fct ] ) , ( [ evwkb - fct ] ) can be computed exactly , e.g. , this holds for piecewise linear @xmath1 . </S>",
    "<S> otherwise , an additional quadrature error of the phase would need to be included in our subsequent analysis .      </S>",
    "<S> let us introduce in this section the variational formulation of the evanescent region problem ( [ region1_ev ] ) and study the well - posedness of the problem . </S>",
    "<S> as pointed out previously , we consider in the current paper situations with an abrupt potential jump , avoiding turning points , such that we shall suppose : + * hypothesis a * _ let @xmath163 and @xmath27 satisfy the bounds @xmath164 furthermore let in the following @xmath165 be arbitrary . _ </S>",
    "<S> + we are now searching for a weak solution of ( [ region1_ev ] ) in the hilbert space    @xmath166 this @xmath19dependent norm gives rise to the following weighted sobolev embedding , where the gagliardo - nirenberg inequality for bounded domains is used in the first estimate : [ sobolev - emb ]    ccc _ c[0,x_d]^2 & & c _ </S>",
    "<S> l^2(0,x_d)(_l^2(0,x_d))+c ^2_l^2(0,x_d ) + & & c ( _ l^2(0,x_d)^2 + ^2_l^2(0,x_d)^2 ) = c ^2_v .    </S>",
    "<S> the variational formulation reads : find @xmath167 , solution of [ vf_ev ] b(,)=l ( ) , , with the sesquilinear form @xmath168 and the antilinear form @xmath169 defined as [ bl_ev ]    lll b(,)&:= & ^2 _ 0^x_d (x ) (x ) dx -_0^x_d a(x ) ( x ) ( x ) dx + ( 0)(0 ) , , + l()&:= & ( x_d ) , .    </S>",
    "<S> the bvp ( [ region1_ev ] ) is a standard elliptic problem , meaning that the forms @xmath170 and @xmath171 are continuous and @xmath170 is coercive , _ i.e. _ there exists a constant @xmath172 independent of @xmath19 , such that for all @xmath173 one has @xmath174 the lax - milgram theorem implies then for each @xmath175 the existence and uniqueness of a weak solution @xmath176 of ( [ vf_ev ] ) . </S>",
    "<S> we have moreover the following lemma : +    [ lem3.1 ] let hypothesis a be satisfied </S>",
    "<S> . then the weak solution @xmath177 of ( [ vf_ev ] ) or ( [ region1_ev ] ) belongs even to @xmath178 $ ] and satisfies the following estimates , with a constant @xmath172 independent on @xmath19 [ chi1 ] _ </S>",
    "<S> l^2(0,x_d)^2 c , ^2 _l^2(0,x_d)^2 c , as well as [ chi2 ] _ </S>",
    "<S> c[0,x_d ] c , _c[0,x_d ] c.    the lax - milgram theorem yields immediately @xmath179 which implies ( [ chi1 ] ) and , with ( [ sobolev - emb ] ) , the first inequality of ( [ chi2 ] ) .    to show the second estimate of ( [ chi2 ] ) , we observe that @xmath180\\ , dy\\\\[3 mm ] & = & \\ds |a(0)|\\ , |\\chi(0)|^2 - 2 \\int_0^x a(y ) \\chi'(y)\\ , \\chi(y)\\ , dy\\\\[3 mm ] & \\le & \\ds c+c\\|\\chi'\\|_{l^2}\\ , \\|\\chi\\|_{l^2 } \\le c+c\\eps \\|\\chi'\\|_{l^2}^2+{c \\over \\eps}\\ , \\|\\chi\\|^2_{l^2}\\le c\\ , , \\end{array}\\ ] ] where we used the other , just proved estimates .      </S>",
    "<S> the multi - scale wkb - fem method we shall use for an efficient resolution of the evanescent region problem ( [ region1_ev ] ) is based on a specific choice of wkb - basis functions from ( [ evwkb - fct ] ) . in more detail </S>",
    "<S> , the hilbert space @xmath181 will be approximated by an appropriate finite - dimensional hilbert space @xmath182 , spanned by well chosen basis functions , and the continuous problem ( [ vf_ev ] ) will be approximated by the following discrete problem : find @xmath183 , solution of [ vf_ev_h ] b(_h,_h)=l(_h ) , _ h _ h. to introduce the finite - dimensional space @xmath184 , let us partition the interval @xmath185 $ ] into @xmath186 and denote the mesh size by @xmath187 as well as @xmath188 . </S>",
    "<S> the appropriate hilbert space @xmath184 is then defined as @xmath189 with the wkb - hat functions defined as [ hat ] _ </S>",
    "<S> n(x):= \\ {    ll v_n-1(x ) , & x , + w_n(x ) , & x , + 0 , & .    .    </S>",
    "<S> here we used the notation [ notz ]    lll w_n(x):= _ n(x ) q_n(x)&;&v_n(x):= _ n(x ) q_n+1(x ) , + _ </S>",
    "<S> n(x):=- _ n+1(x ) _ n & ; & _ n(x):= _ n(x ) _ n , + _ n(x):= 1 _ x_n^x dy&;&_n:= 1 _ x_n^x_n+1 dy , + q_n(x):= .    assuming hypothesis a , @xmath190 is piecewise in @xmath191 @xmath192 and globally in @xmath193 $ ] . </S>",
    "<S> note that both components @xmath194 and @xmath195 of these ( non - standard ) hat functions are linear combinations of the evanescent wkb - functions of first order , i.e. @xmath65 given in ( [ evwkb - fct ] ) . hence these hat functions are solutions of our schrdinger equation up to an error of order @xmath196 , _ </S>",
    "<S> i.e. _ @xmath197\\ , \\zeta_n(x)\\ , , & & \\\\ \\forall x \\in ( x_{n-1},x_n)\\cup ( x_n , x_{n+1})\\,.&&\\end{aligned}\\ ] ] this peculiarity signifies that the hat functions incorporate already some essential information about the solutions we are searching for , leading to a scheme which will be asymptotically correct in the limit @xmath198 , as will be seen later on . + for later purposes let us introduce here the differential operator @xmath199 with the function @xmath200 for each @xmath201 one has @xmath202 in every interval @xmath203 . </S>",
    "<S> but we note that @xmath204 can not be applied globally on @xmath76 , as functions in @xmath205 typically have discontinuous derivatives at the grid points @xmath206 . </S>",
    "<S> + we also remark that , due to lax - milgram s theorem , the discrete problem ( [ vf_ev_h ] ) admits @xmath90 also a unique solution @xmath207 . </S>",
    "<S> + the aim is now to investigate the error between the exact solution of ( [ vf_ev ] ) , denoted by @xmath208 , and the solution of the discrete problem ( [ vf_ev_h ] ) , denoted by @xmath209 . </S>",
    "<S> we denote by @xmath210 the interpolant of the exact solution in the finite dimensional hilbert space @xmath184 , _ </S>",
    "<S> i.e. _ [ projection ] _ </S>",
    "<S> _ ex ( x ) : = _ n=1^n _ ex(x_n ) _ </S>",
    "<S> n(x ) , x . </S>",
    "<S> then , the numerical error can be split as follows @xmath211 where @xmath212 corresponds to the interpolation error ( consistency ) and @xmath213 is the stability error . </S>",
    "<S> these two error parts shall be now estimated separately .      </S>",
    "<S> the goal of this section is to estimate the interpolation error @xmath214 in the @xmath181-norm . </S>",
    "<S> + to this end , note that the equation satisfied by @xmath212 in @xmath215 is @xmath216 \\ds e_h^1(x_n)=e_h^1(x_{n+1})=0\\ , . </S>",
    "<S> \\end{array } \\right.\\ ] ] the variation of constants method , i.e.  writing @xmath217 in @xmath215 leads after some lengthy but straightforward computations ( see @xcite for the oscillatory case ) to the following explicit expressions for the error function [ cap3err ] e_h^1(x)=_1(x)+_2(x ) , x i_n , with @xmath218 \\ds\\mathcal{e}_2(x)&\\!\\!\\ ! </S>",
    "<S> = & \\!\\!\\ ! \\ds   \\frac{\\varepsilon}{(v(x)-e)^{1/4 } } \\ , \\frac{\\sinh \\sigma_n(x)}{\\sinh \\gamma_n } \\ , \\int_{x_{n+1}}^{x } \\!\\ ! </S>",
    "<S> \\frac{r(y)\\ , \\chi_{ex}(y)}{(v(y)-e)^{1/4 } } \\sinh \\sigma_{n+1}(y)\\ , dy\\ , . </S>",
    "<S> \\end{array}\\ ] ] differentiating the interpolation error function yields [ cap3derr ] ( e_h^1)(x)=_1(x)+_2(x)+_3(x)+_4(x ) = _ 2(x)+_4(x ) , with @xmath219 \\ds \\mathcal{d}_2(x)&\\!\\!\\!=&\\!\\!\\ ! </S>",
    "<S> \\ds - { \\eps \\over \\sinh \\gamma_n } \\ , \\left [ { ( v(x)-e)^{1/4 } \\over \\eps } \\cosh \\sigma_{n+1}(x ) - { v'(x)\\ , \\sinh \\sigma_{n+1}(x ) \\over 4\\ , ( v(y)-e)^{5/4 } } \\right ]   \\\\[5 mm ] & & \\times </S>",
    "<S> \\,\\ds\\int_{x_n}^x \\frac{r(y ) \\ , \\chi_{ex}(y)\\ , \\sinh \\sigma_n(y)}{(v(y)-e)^{1/4 } } \\ , dy\\ , , \\\\[5 mm ] \\ds \\mathcal{d}_4(x)&\\!\\!\\ ! = & \\!\\!\\ ! \\ds   { \\eps \\over \\sinh \\gamma_n } \\ , \\left [ { ( v(x)-e)^{1/4 } \\over \\eps } \\cosh \\sigma_{n}(x ) - { v'(x)\\ , \\sinh \\sigma_{n}(x ) \\over 4\\ , ( v(y)-e)^{5/4 } } \\right ]   \\\\[5 mm ] & & \\times\\,\\ds \\int_{x_{n+1}}^x \\frac{r(y ) \\ , </S>",
    "<S> \\chi_{ex}(y)\\ , \\sinh \\sigma_{n+1}(y)}{(v(y)-e)^{1/4 } } \\ , dy\\ , . </S>",
    "<S> \\end{array}\\ ] ] in order to estimate the interpolation error in the @xmath181-norm , we shall investigate each of these terms separately . in this study , </S>",
    "<S> the behaviour of the following functions is very important : @xmath220 @xmath221 next we shall use @xmath222 and the fact that @xmath223 and @xmath224 are both non - negative on @xmath215 and , respectively , increasing and decreasing </S>",
    "<S> . then one can show for @xmath225 : @xmath226 and @xmath227 @xmath228 in the above estimates , the constant @xmath229 depends only on our data @xmath1 and @xmath230 , but not on @xmath19 and @xmath208 . using @xmath231 </S>",
    "<S> we easily find @xmath232 @xmath233 @xmath234 with the asymptotic behaviour @xmath235 we obtain ( using @xmath236 ) @xmath237 with lemma [ lem3.1 ] this permits to prove the following lemma : +    [ th : e1-est ] let hypothesis a be satisfied . then the following estimates hold for the interpolation error @xmath238 $ ] of the exact solution @xmath239 of ( [ vf_ev ] ) : @xmath240 @xmath241 } \\le c \\,\\sqrt{h}\\ , \\min \\ { \\eps^{3/2},h^{3/2}\\}\\ , , \\quad \\eps   \\|(e_h^1)'\\|_{l^{\\infty}(0,x_d)}\\le c \\eps\\ , \\sqrt{h}\\,\\min \\ { \\sqrt{\\eps},\\sqrt{h}\\ } \\,.\\ ] ]      let us now come to the @xmath242-estimates of the stability error @xmath243 for this study , we remark that @xmath244 implying with the choice @xmath245 that [ err1 ] b(e_h^2,e_h^2)=b(_h^ _ ex-_h , e_h^2)=b(_h^ _ ex-_ex , e_h^2)=-b(e_h^1,e_h^2 ) . </S>",
    "<S> using now the coercivity and the boundedness of the sesquilinear form @xmath246 , yields with a constant @xmath172 independent of @xmath19 , that @xmath247 but this estimate can be further improved for @xmath0 . </S>",
    "<S> for this , let us study the right hand side of ( [ err1 ] ) in more detail . </S>",
    "<S> as @xmath248 we have that @xmath249 on every interval @xmath215 , implying thus @xmath250 were we used @xmath251 for the integration by parts . </S>",
    "<S> thus one obtains from ( [ bl_ev ] ) , ( [ err1 ] ) : @xmath252 and in particular @xmath253 . using also the sobolev embedding ( [ sobolev - emb ] ) , this implies @xmath254 } & \\le & c \\eps^4 \\|e_h^1\\|_{l^2(0,x_d)}^2\\ , \\nonumber\\\\ & \\le & c\\eps^5 h^2 \\min\\{\\eps^2,h^2\\}\\ , . \\ ] ]    finally we shall now derive an @xmath51bound on @xmath255 , using the bound on @xmath256}$ ] : since @xmath257 , we have @xmath258\\,.\\ ] ] to bound @xmath259 , one refers to ( [ notz ] ) and observes that @xmath260 as well as @xmath261 and analogous estimates hold for @xmath262 . from ( [ e2-est ] ) </S>",
    "<S> we then obtain [ e2-est2 ] ( e_h^2)_l^(0,x_d)c e_h^2_c[0,x_d](1 + 1h ) c ^3 h .      </S>",
    "<S> to summarize , we shall put together both error contributions ( from lemma [ th : e1-est ] and from the stability estimates ( [ e2-est ] ) , ( [ e2-est2 ] ) ) in the following theorem . </S>",
    "<S> it turns out that the consistency error is dominant here : +    [ ev_conv ] * ( convergence wkb - fem ) * let hypothesis a be satisfied . then the following estimates hold for the numerical error between the exact solution @xmath239 of ( [ vf_ev ] ) and the numerical solution @xmath207 of ( [ vf_ev_h ] ) : e_h_l^2(0,x_d ) & & c h \\ { , h } , e_h_l^2(0,x_d ) c ^3/2 h , + e_h_c[0,x_d ] & & c \\ { ^3/2,h^3/2},e_h_l^(0,x_d)c \\ { , } </S>",
    "<S> .      in this subsection we shall first investigate the ivp ( [ region2_ev ] ) on the continuous level , on the interval @xmath77 . </S>",
    "<S> following @xcite , we shall rewrite ( [ region2_ev ] ) in vectorial form , done via a non - standard transformation that is appropriate for the numerical wkb - marching method . </S>",
    "<S> for the subsequent analysis let us make the following assumptions on the potential :    * hypothesis b * _ let @xmath263 $ ] and @xmath27 satisfy the bounds @xmath264\\,.\\ ] ] moreover let @xmath265 be arbitrary , with some @xmath266 such that @xmath267 \\right\\}.\\ ] ] _   </S>",
    "<S> +    in this definition , @xmath268 denotes the non - negative part of @xmath269 . </S>",
    "<S> hence @xmath270 may take the value @xmath271 . </S>",
    "<S> we note that the above restriction on @xmath19 guarantees that the phase function of @xmath272 ( cf . </S>",
    "<S> ( [ oswkb - fct ] ) ) is strictly increasing . </S>",
    "<S> moreover , the resulting positivity of the function @xmath273 will be crucial for the wkb - marching method in  [ sec331 ] . </S>",
    "<S> + following @xcite it is convenient to pass from the second - order differential equation to a system of first - order , introducing the following vector notation for the wave function @xmath274 on @xmath275 $ ] : [ def - u ] u(x)= (    c u_1 + u_2    ) : = (    c a^1/4(x ) +    ) = (    c a^1/4(x ) + ( 14 a^-5/4 a + a^-1/4)(x )    ) . </S>",
    "<S> the norm of @xmath276 is equivalent to the norm of the vector @xmath277 . </S>",
    "<S> indeed , the transformation matrix between these two vectors reads [ transfo ] a(x):= (    cc a^1/4(x)&0 + a^-5/4(x)a(x ) & a^-1/4(x )    ) u(x)=a(x ) (    c +     ) , where the matrix @xmath278 and its inverse are bounded , uniformly w.r.t .  </S>",
    "<S> @xmath43 and @xmath19 , due to hypothesis b. +    let @xmath279 be the exact solution of ( [ region2_ev ] ) as guaranteed by lemma [ pb-2zones ] . in the above vector notation </S>",
    "<S> it will be denoted by @xmath280 or simply @xmath281 , and is solution to the system @xmath282 u(x)\\,,\\quad x_d < x<1\\ , , \\\\[3 mm ] \\ds u(x_d)=a(x_d+)\\ , ( \\chi_{ex}(x_d ) , 1)^\\top\\ , , \\end{array } \\right.\\ ] ] with the two matrices @xmath283 here , @xmath284 which was already defined in ( [ wkb - fct ] ) , and the matrix element @xmath285 of @xmath286 denotes the right - sided limit of @xmath42 at the jump discontinuity @xmath46 . </S>",
    "<S> we also use the analogous notation for @xmath287 .    in the sequel </S>",
    "<S> we shall need an a - priori estimate on this solution . </S>",
    "<S> the upper bound was already given in  2.1 of @xcite . </S>",
    "<S> but for the scaling step 3 we shall also need an @xmath19-uniform lower bound on the solution :    [ u - estimate ] let hypothesis b hold . then , the ode ( [ equ ] ) admits a unique solution @xmath288 , which satisfies [ u - est ] u(x_d ) u(x ) u(x_d ) , x_dx1 . </S>",
    "<S> thus , there exist constants @xmath289 independent on @xmath19 such that [ uex - bound ] c_3u_c[x_d,1 ] c_4,0<_0 .     </S>",
    "<S> +    for the norm @xmath290 we compute for ( [ equ ] ) : @xmath291 this implies ( [ u - est ] ) . </S>",
    "<S> the estimate ( [ uex - bound ] ) is now a simple consequence of ( [ u - est ] ) , presupposing that one proves some @xmath19-independent bounds on the initial condition @xmath292 , or equivalently @xmath293 . </S>",
    "<S> the latter norm is clearly bounded below by 1 , and it is also bounded above due to the a - priori estimate on @xmath294}$ ] from lemma [ lem3.1 ] . hence there exist constants @xmath295 , independent of @xmath296 , such that [ ic - bound ] c_1u_ex(x_d ) c_2,0<_0 , leading to ( [ uex - bound ] ) .      </S>",
    "<S> in this subsection we shall first review the wkb - marching method for solving the ivp ( [ region2_ev ] ) ( or , equivalently , ( [ equ ] ) ) . </S>",
    "<S> then we recall its error estimates from @xcite .    </S>",
    "<S> following @xcite this method consists of two parts , first an analytic transformation of ( [ region2_ev ] ) or ( [ equ ] ) into a less oscillatory problem , and second the discretization of the smooth problem on a coarse grid in an @xmath19-uniform manner . </S>",
    "<S> as shown in @xcite , the analytic wkb - transformation reviewed here is related to using oscillatory wkb - functions of second order , @xmath272 . </S>",
    "<S> + the starting point is the vectorial ivp ( [ equ ] ) .    </S>",
    "<S> the vector function @xmath297 is then transformed to the new unknown @xmath298 by @xmath299 \\ds z_2 \\end{array } \\right )   : = \\exp \\left(-{i\\over \\eps } \\phi^\\eps(x ) \\right ) p\\,u(x)\\ , , \\quad \\forall x \\in [ x_d,1]\\,,\\ ] ] with the matrices @xmath300 and the ( real valued ) phase function @xmath301 this change of unknown leads to the smooth ode - system @xmath302 \\ds z(x_d):=p\\,u_{ex}(x_d)\\ , . </S>",
    "<S> \\end{array } \\right.\\ ] ] here , the @xmath303matrix function @xmath304 is bounded independently of @xmath19 . it is off - diagonal , with the entries @xmath305 n^_2,1 ( x)= ( x ) e^ ^(x ) . </S>",
    "<S> @xmath306 this finishes the analytical transformation , and the goal of the second part is to provide an @xmath19-uniform discretization of ( [ eqz ] ) that is second order w.r.t .  the mesh size . </S>",
    "<S> + first we partition the interval @xmath275 $ ] into @xmath307 . as in  [ sec32 ] we denote the mesh size by @xmath187 as well as @xmath308 .    with the initial condition </S>",
    "<S> @xmath309 and @xmath310 given , the marching scheme reads as follows ( see @xcite ) : [ marching - scheme ] z_n+1 = ( i + a_n^1 + a_n^2 ) z_n , n </S>",
    "<S> = n, ... ,m-1 , with the @xmath303matrices @xmath311 & & \\hspace{-20 mm } - i \\eps^2 \\!\\!\\left(\\!\\ ! \\begin{array}{cc } 0&\\hspace{-8 mm } \\beta_0(x_{n})e^{-{2i \\over \\eps } \\phi(x_{n } ) } -\\beta_0(x_{n+1})e^{-{2i \\over \\eps } \\phi(x_{n+1})}\\\\[3 mm ] \\beta_0(x_{n+1 } ) e^{{2i \\over \\eps } \\phi(x_{n+1 } ) } -\\beta_0(x_{n})e^{{2i \\over \\eps } \\phi(x_{n } ) } & \\hspace{-8 mm } 0 \\end{array } \\!\\!\\!\\right)\\\\[6 mm ] & & \\hspace{-20 mm } \\ds + \\eps^3 \\!\\!\\left(\\!\\ ! </S>",
    "<S> \\begin{array}{cc } 0&\\hspace{-8 mm } \\beta_1(x_{n+1})e^{-{2i </S>",
    "<S> \\over \\eps } \\phi(x_{n+1 } ) } -\\beta_1(x_{n})e^{-{2i \\over \\eps } \\phi(x_{n})}\\\\[3 mm ] \\beta_1(x_{n+1 } ) e^{{2i \\over \\eps } \\phi(x_{n+1 } ) } -\\beta_1(x_{n})e^{{2i \\over \\eps } \\phi(x_{n } ) } & \\hspace{-8 mm } 0 \\end{array } \\!\\!\\right)\\\\[6 mm ] & & \\hspace{-20 mm } \\ds + i \\eps^4 \\beta_2(x_{n+1 } )   \\left ( \\begin{array}{cc } 0 & -e^{-{2i \\over \\eps } \\phi(x_{n } ) } h_1(-{2 \\over \\eps } s_{n})\\\\[3 mm ] e^{{2i \\over \\eps } \\phi(x_{n } ) } h_1({2 \\over \\eps } s_{n})&0 \\end{array } \\ ! \\right)\\\\[6 mm ] & & \\hspace{-20 mm } \\ds -   \\eps^5 \\beta_3(x_{n+1 } )   \\left ( \\begin{array}{cc } 0 & e^{-{2i \\over \\eps } \\phi(x_{n } ) } h_2(-{2 \\over \\eps } s_{n})\\\\[3 mm ] e^{{2i \\over \\eps } \\phi(x_{n } ) } h_2({2 \\over \\eps } s_{n})&0 \\end{array } \\ ! \\right)\\ , , \\end{array } \\ ] ] @xmath312 & & \\ds - \\eps^4 \\beta_0(x_{n } ) \\beta_0(x_{n+1 } )   \\left ( \\begin{array}{cc } \\ds h_1(-{2\\over \\eps}s_{n})&0\\\\[5 mm ] \\ds 0 & \\ds   h_1({2\\over \\eps}s_{n } ) \\end{array } \\right)\\\\[7 mm ] & & \\ds + i   \\eps^5\\beta_1(x_{n+1 } )   [ \\beta_0(x_{n})-\\beta_0(x_{n+1 } ) ] \\left (   \\begin{array}{cc } \\ds h_2(-{2\\over \\eps}s_{n } ) & \\ds 0\\\\[4 mm ] \\ds 0 & \\ds -h_2({2\\over \\eps}s_{n } ) \\end{array } \\right)\\ , . </S>",
    "<S> \\end{array } \\ ] ] here we used the notation @xmath313 @xmath314 and the discrete phase increments @xmath315 remark that for notational reasons we omitted in the aforementioned description of the scheme the @xmath19-index . </S>",
    "<S> furthermore we assumed that the two functions @xmath316 and @xmath269 ( the latter involving the derivatives @xmath317 , @xmath318 ) are explicitly `` available '' . </S>",
    "<S> alternatively , @xmath316 , @xmath317 and @xmath318 could be approximated numerically . </S>",
    "<S> but , for simplicity , we shall not include such errors in the subsequent error analysis .    </S>",
    "<S> finally we have to transform back to the @xmath276-solution vector via [ transfo_zu ] u_n = p^-1 e^i ^ ( x_n ) z_n , n = n+1, ... ,m , which concludes the review of the wkb - marching algorithm .    </S>",
    "<S> the following lemma is the discrete analogue of lemma [ u - estimate ] .    </S>",
    "<S> [ lem : real - preservation ] let hypothesis b hold and let the initial condition @xmath319 . then the iteration ( [ marching - scheme])-([transfo_zu ] ) determines a well - defined sequence satisfying @xmath320 @xmath321 . furthermore @xmath322 $ ] such that [ un - stability ] c_5u_n c_6 , n = n, ... ,m , with some positive constants @xmath323 that are independent of @xmath324 and the numerical grid on @xmath275 $ ] .     </S>",
    "<S> +    let us start by analysing the propagation matrix @xmath325 of the vector @xmath326 as defined in ( [ marching - scheme ] ) . </S>",
    "<S> a straightforward computation reveals its symmetry ( which was also used in the proof of proposition 3.3 , @xcite ) : @xmath327 this symmetry carries over to the matrix @xmath328 \\bar b_2 & \\bar b_1 \\end{array } \\right ) : = e^{{i \\over \\eps } \\phi^{\\eps } ( x_{n+1})}\\,b_n\\,e^{-{i \\over \\eps } \\phi^{\\eps } ( x_n ) } \\,.\\ ] ] with this notation , the propagation matrix for the vector @xmath329 reads ( cf . </S>",
    "<S> ( [ marching - scheme ] ) , ( [ transfo_zu ] ) ) : @xmath330 -\\im b_1 + \\re b_2 & \\re b_1 - \\im b_2 \\end{array } \\right)\\in\\rr^{2\\times2}\\,,\\ ] ] where we used @xmath331 this shows that @xmath332 . </S>",
    "<S> + coming now to the bounds of @xmath329 , a simple taylor expansion for the matrices in ( [ marching - scheme ] ) yields @xmath333 , @xmath334 , and hence with some constant @xmath335 : @xmath336 where we used @xmath337 and the estimate ( [ ic - bound ] ) in the last step . </S>",
    "<S> next we consider the transformation matrices in ( [ transfo_zu ] ) : @xmath338 is independent of @xmath19 and @xmath10 , and @xmath339 is unitary . </S>",
    "<S> this implies the upper bound in ( [ un - stability ] ) .    for the lower </S>",
    "<S> bound we choose @xmath340 such that @xmath341 with the elementary estimate @xmath342 for @xmath343 $ ] we then obtain @xmath344 this allows to estimate the backwards propagation @xmath345 as @xmath346 and the lower bound on @xmath347 follows as before . </S>",
    "<S> + due to the above lemma we have to restrict the range of admissible @xmath19values : + * hypothesis b * _ let the assumptions of hypothesis b hold , but with @xmath266 replaced by @xmath348 from lemma [ lem : real - preservation ] . _      in this subsection we recall the main theorem 3.1 of @xcite , providing error bounds for the marching method ( [ marching - scheme])-([transfo_zu ] ) , used for solving the ivp ( [ region2_ev ] ) or , equivalently , ( [ equ ] ) . </S>",
    "<S> +    [ thm_princ ] * ( convergence wkb - ivp ) * let hypothesis b be satisfied and let @xmath280 denote the exact solution to the ivp ( [ equ ] ) . </S>",
    "<S> then the global error of the second order scheme ( [ marching - scheme])-([transfo_zu ] ) satisfies [ error_z_2ord ] u_ex(x_n)-u_n _ c h^ + c ^3 h^2 , nnm , with @xmath229 independent of @xmath349 , @xmath10 , and @xmath19 . here </S>",
    "<S> , @xmath350 is the order of the chosen numerical integration method for computing the phase integral [ ph ] ^(x)= _ x_d^x ( -^2 ( y ) ) dy (    cc 1&0 + 0&-1    ) for the back - transformation ( [ transfo_zu ] ) .     </S>",
    "<S> +    we remark that the term @xmath351 of ( [ error_z_2ord ] ) may or may not be present in real computations , depending on the chosen coefficient function @xmath1 . if @xmath1 is piecewise linear or piecewise quadratic , e.g. , the phase integral @xmath352 can be computed analytically . </S>",
    "<S> hence , this term would not appear in such cases . in the numerical tests performed in  [ sec4 ] below , we shall only consider such examples of exactly computable phase functions and shall hence not include this error term in the error analysis of  [ sec34 ] .      </S>",
    "<S> in this section we shall combine the error analysis of the previous two sections and adapt it to the algorithm for coupling two regions . to this end </S>",
    "<S> we have to fix the numerical analogues of the continuous coupling conditions in ( [ region2_ev ] ) . </S>",
    "<S> first we shall ( of course ) use @xmath353 . but for the initial condition of the derivative there are two options , namely @xmath354 or @xmath355 ( taken from the exact value in ( [ region1_ev ] ) ) . </S>",
    "<S> we shall use the second option for the following reasons : on the one hand it avoids the numerical error of @xmath356 , where we recall that @xmath357 is discontinuous ( and hence less accurate ) at the grid points . and on the other hand , this choice will facilitate the a - priori estimate needed for the scaling in step 3 .    since the numerically used initial data @xmath358 deviates from its exact value @xmath359 , this gives rise to an additional error component to be considered : let thus @xmath360 denote the exact solution to the ode ( [ equ ] ) , but with the following perturbed initial condition : [ numic ] u_ex(x_d):= a(x_d+ ) (    c _ </S>",
    "<S> h(x_d ) + 1    ) . using the a - priori estimate ( [ u - est ] ) leads to the error [ error1 ] & & u_ex - u_ex_c[x_d,1 ] a(x_d+)(e_h(x_d),0)^ + & & = ^1/2 |e_h(x_d)| , where we used the notation @xmath361 . </S>",
    "<S> + the following convergence analysis of the hybrid method uses several different solution functions ( exact , numerical , etc . ) . to keep the notation straight we summarize it in the following table , both for the evanescent and oscillatory regions . </S>",
    "<S> the superscript @xmath362 signifies that we refer to both the function and its first derivative .    </S>",
    "<S> @xmath363\\ , ; \\ ; [ x_d,1]$ ) } \\\\ </S>",
    "<S> \\tilde u_{ex}(x ) \\mbox { on } [ x_d,1 ] & \\hbox{\\rm exact solution vector after scaling in step 3 , with exact ic } \\\\ </S>",
    "<S> \\tilde u_n   \\mbox { on } [ x_d,1 ] & \\hbox{\\rm numerical solution vector after scaling in step 3 , with numerical ic } \\\\ </S>",
    "<S> \\hline \\end{array}\\ ] ]    for clarity , we summarize here also the numerical analogue of the three steps in ( [ region1_ev])-([alpha - eq_ev ] ) , referring to the two regions in fig .  </S>",
    "<S> [ 2regions ] : + find @xmath364 solving [ fem - region1 ] b(_h,_h ) = l(_h ) , _ hv_h . this yields @xmath365 with an error @xmath366 ( see thm . [ ev_conv ] ) .    as initial condition for the marching scheme we use @xmath367 given by ( [ un - stability ] ) . applying the scheme ( [ marching - scheme])([transfo_zu ] ) iteratively </S>",
    "<S> we compute the vectors @xmath368 .    </S>",
    "<S> [ psi - scaling_num ] _ </S>",
    "<S> h(x):=\\ {    </S>",
    "<S> l _ </S>",
    "<S> h(x ) , x [ 0,x_d ) , + _ </S>",
    "<S> h , n = u_n^1a(x_n)^-1/4 , x\\{x_n, ... ,x_m } ,    . </S>",
    "<S> @xmath369 \\ds \\tilde\\alpha\\,\\varphi_{h , </S>",
    "<S> n}'=\\tilde\\alpha \\big[\\frac{u_n^2}{\\eps}\\,a(x_n)^{1/4 } -\\frac{a'(x_n)}{4}\\ , a(x_n)^{-5/4}\\,u_n^1\\big]\\ , , \\quad x\\in\\{x_n, ... ,x_m\\ } \\ , , \\end{array } \\right.\\ ] ] with the scaling parameter @xmath370 defined in analogy to ( [ alpha - eq_ev ] ) : [ alpha - scaling ] = ( u_m^1,u_m^2 ) : = . </S>",
    "<S> the statement ( [ psi - scaling_num ] ) reveals that our final numerical solution @xmath371 is continuous in the evanescent region , but discrete in the oscillatory region . </S>",
    "<S> note also that the relation between @xmath372 and @xmath373 , given by ( [ transfo ] ) , provides a connection between the two scaling functions @xmath84 and @xmath374 , _ </S>",
    "<S> i.e. _ @xmath375 let us finally also recall that the solution @xmath209 as well as the vector @xmath376 of step 2 are real valued . </S>",
    "<S> the final ( numerical ) solution @xmath371 only becomes complex valued due to the multiplication by @xmath374 in step 3 . </S>",
    "<S> note that the denominator of ( [ alpha - scaling ] ) can not vanish for @xmath377 , which makes the scaling well defined . </S>",
    "<S> this map @xmath374 satisfies moreover the following simple properties :    [ lem : lipschitz ] for each fixed @xmath378 , the ( @xmath19-dependent ) map @xmath379 is lipschitz continuous with some constant @xmath380 and bounded by some constant @xmath381 . </S>",
    "<S> both constants can be chosen uniformly w.r.t .  </S>",
    "<S> @xmath296 and are dependent on @xmath382 .    the following error analysis of the hybrid scheme is the main result of this paper . </S>",
    "<S> +    [ th : hybrid - conv ] * ( convergence wkb - hybrid ) * let hypotheses a and b be satisfied </S>",
    "<S> . then @xmath371 , the numerical solution to the hybrid scheme ( [ fem - region1])-([alpha - scaling ] ) , satisfies the following error estimates , compared to the exact solution @xmath383 of the algorithm ( [ region1_ev])-([alpha - eq_ev ] ) :    1 .   in the evanescent region @xmath384 we have [ hybrid - evan ] e_h_l^2(0,x_d ) & & c h \\ { , h } , e_h_l^2(0,x_d ) c ^3/2 h , + e_h_c[0,x_d ] & & c \\ { ^3/2,h^3/2 } , e_h_l^(0,x_d)c \\ { , } , + & & with the notation @xmath385 . </S>",
    "<S> 2 .   in the oscillatory region </S>",
    "<S> @xmath275 $ ] we have [ hybrid - oscil ] |e_h , n| + |e_h , n| c \\ { ^3/2,h^3/2 } ; n = n, ... ,m , with the notation @xmath386 and @xmath387 . </S>",
    "<S> 3 .   for the overall hybrid method </S>",
    "<S> one has then , over @xmath28 $ ] , the estimates @xmath388 with the notation @xmath389 .    note that the error of @xmath371 is globally of the order @xmath390 . </S>",
    "<S> the derivative @xmath391 is also correct to order @xmath390 in the oscillatory region , but only @xmath392 in the evanescent region . </S>",
    "<S> this can be explained as follows : the @xmath392error of @xmath357 is not propagated to the oscillatory region , as we use the exact value of the derivative in the matching condition ( [ numic ] ) . </S>",
    "<S> moreover , the scaling step does not change the error orders in the evanescent region . </S>",
    "<S> + statement a ) is a consequence of thm . </S>",
    "<S> [ ev_conv ] . </S>",
    "<S> let us then continue by estimating the error of the numerical solution @xmath329 compared to the exact solution @xmath280 , i.e. prior to the scaling step 3 : using ( [ error1 ] ) , ( [ error_z_2ord ] ) and theorem [ ev_conv ] we obtain [ error2 ] u_ex(x_n)-u_n & & u_ex(x_n)-u_ex(x_n ) + u_ex(x_n)-u_n + & & c|e_h(x_d)| + c^3h^2 + & & ch \\{^3/2,h^3/2 } ; n = n, ... ,m.we continue with estimating the error propagation due to the non - linear scaling in step 3 . due to lemma [ lem : lipschitz ] , the map @xmath393 is lipschitz continuous with some constant @xmath380 and bounded by some constant @xmath381 . both of these constants can be chosen independent of @xmath296 , as the choice @xmath394 for the domain of @xmath374 uses the lower bounds on @xmath395 from ( [ uex - bound ] ) and on @xmath329 from lemma [ lem : real - preservation ] . </S>",
    "<S> here it is crucial that both the exact solution vector @xmath396 and the numerical solution vector @xmath397 have real components . </S>",
    "<S> then , lemma [ lem : lipschitz ] shows that @xmath374 is lipschitz and bounded on @xmath398 . </S>",
    "<S> + for the evanescent region @xmath384 we estimate the difference between the exact solution and the numerical solution ( both after scaling ) @xmath399 this yields |_ex(x ) - _ h(x)| & & |(u_ex(1))-(u_m)||_ex(x)| + |(u_m)||_ex(x)-_h(x)| + & & lu_ex(1)- u_m|_ex(x)| + c_8 |e_h(x)| + & & ch \\{^3/2,h^3/2}|_ex(x)| + c_8 |e_h(x)| , where we used ( [ error2 ] ) in the last step . </S>",
    "<S> using now lemma [ lem3.1 ] to estimate @xmath400 and theorem [ ev_conv ] for @xmath401 yields the four error estimates of ( [ hybrid - evan ] ) . </S>",
    "<S> + for the oscillatory region @xmath275 $ ] we estimate the difference between the exact solution and the numerical solution ( both after scaling ) @xmath402 at the grid points @xmath403 . here </S>",
    "<S> it is again more convenient to use the vector notation from ( [ def - u ] ) , where we introduce the notations @xmath404 and @xmath405 for the exact and , respectively , numerical solution after scaling in step 3 : u_ex(x_n ) - u_n & = & ( u_ex(1 ) ) u_ex(x_n ) - ( u_m)u_n + & & |(u_ex(1))-(u_m)|u_ex(x_n ) + |(u_m)|u_ex(x_n)- u_n + & & lu_ex(1)- u_mc_4 + c_8 u_ex(x_n)- u_n + & & ch \\{^3/2,h^3/2 } , where we used ( [ uex - bound ] ) in the penultimate line , and ( [ error2 ] ) twice in the last line . using the norm equivalence then yields the error estimate ( [ hybrid - oscil ] ) . </S>",
    "<S> + is just a combination of the previous two parts . </S>"
  ]
}