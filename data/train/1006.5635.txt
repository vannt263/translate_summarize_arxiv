{
  "article_text": [
    "the problems of image simulation and reconstruction in solar radioastronomy require computation of multiple ray trajectories .",
    "a typical image of the sun consists of thousands to millions pixels , and the brightness of each of the pixels is obtained as an integral over an individual ray trajectory . due to non - uniform distribution of the index of refraction in heliospheric plasmas at lower frequencies ( up to a few ghz )",
    "the ray trajectories can not be treated as straight lines .",
    "the ray - tracing problems require significant amount of computations , and , hence , time .",
    "it is possible to considerably reduce the computation time through the use of efficient ray - tracing algorithms .    in this work",
    "a ray tracing algorithm is presented .",
    "it allows one to calculate trajectories of electromagnetic rays in space plasmas with specified density distributions . in most applications",
    "the radio rays are traced to calculate certain physical quantities , such as intensity or black body brightness temperature , through path integration over the ray trajectories . in its software implementation",
    "the algorithm performs the integration and the ray trajectory calculation simultaneously .",
    "we start with a brief review of the facts from the physics of electromagnetic wave propagation in plasmas pertinent to the ray tracing .",
    "we show the relationship between the plasma density , the dielectric permittivity , and the index of refraction as well as between their gradients . in the next section",
    "we derive the ray equations from the fermat s principle .",
    "we transform the set of ray equations so that their solution is a naturally parameterized curve .",
    "this representation reveals the mathematical analogy of the ray equations and the equations for a particle motion in magnetic field . using this analogy",
    ", we derive a @xcite second - order difference scheme using the @xcite approach . in the boris scheme",
    "the particle energy , or the squared velocity , is conserved .",
    "for the naturally parameterized curve like that we use here the first derivative of the vector to be solved from the equation is not velocity ( as present in the equation of the particle motion ) , but the unity - length direction cosine vector .",
    "our scheme conserves the squared direction vector at unity . to achieve this",
    ", we employ the ideas which are often used while simulating the particle motion and which are known to conserve the velocity vector length in the magnetic field .",
    "the difference scheme coding is quite straightforward , so in the section devoted to the numerical implementation of the algorithm we focus on discussing the ways to secure the algorithm robustness for the media with non - linear plasma density changing in space by presumably decades of orders of magnitude .",
    "this is shown to be the case for the heliosphere .",
    "we describe the methods we used to adaptively decrease and increase the integration step and the techniques used to avoid the ray penetration into the regions with the density above the critical .",
    "these methods are intended to reverse the ray direction and use parabolic and linear approximations of the trajectory .    in the testing and validation section",
    "we show the algorithm demonstrates excellent precision in the medium with one - dimensional linear plasma density gradient . in the example application section",
    "we verify the algorithm through solving a ray - tracing problem in the corona and chromosphere with realistic model density distributions , those by @xcite and @xcite .",
    "our algorithm implementation shows good results , demonstrated in a few plots of the ray beams refracting near the sun .",
    "we treat the electromagnetic ray trajectory as a curve with radius vector @xmath0 in the three - dimensional space . for any starting point , @xmath1 , and",
    "any given vector of initial direction , @xmath2 , the whole shape of the ray trajectory may be unamnigously determined , as long as the distribution of the index of refraction , @xmath3 , is known for a given angular frequency @xmath4 .    for the natural parameterization of the curve , @xmath5 , where @xmath6 is its arc length ,",
    "the direction vector @xmath7 is defined as the first derivative of position vector , or @xmath8 .",
    "the components of @xmath7 are direction cosines , and @xmath9 at any point of the curve . here",
    "we show that the plasma density distribution , @xmath10 , suffices to determine the index of refraction @xmath11 at a given wave frequency . in the gaussian units , @xmath12 is the square root of plasma dielectric permittivity , @xmath13 . for isotropic plasmas @xmath14 where the plasma frequency is @xmath15 , @xmath16 being the electron charge , @xmath17 and @xmath18 the electron mass and number density in the gaussian ( cgs ) units . under the quasineutrality condition",
    "the hydrogen plasma density is @xmath19 , where @xmath20 is the proton mass , so the dielectric permittivity is expressed as @xmath21    here @xmath22 is the critical plasma density , at which the permittivity and , hence , the refraction index for the given frequency are zero : @xmath23 electromagnetic rays of the frequency @xmath4 can not travel in the regions with @xmath24 , i.e. with @xmath25 where the index of refraction takes imaginary values . the boundary between the region where @xmath26 and the region with @xmath25 is called the critical surface .",
    "the rays near the critical surfaces undergo strong refraction bending them away from the surface . in limit cases",
    "this effect is similar to the reflection .",
    "the algorithm described further uses the relative gradient of refractive index , @xmath27 . since the permittivity gradient can be expressed from eq .",
    "as @xmath28 , the relative gradient of @xmath12 is @xmath29 thus , if we know the critical density , the relative gradient of refractive index is totally determined by the plasma density and the density gradient .",
    "to derive the equation for the ray trajectory we use the fermat s principle .",
    "it states that a ray joining two points @xmath30 and @xmath31 will choose the path over which the integral of the refraction index , @xmath12 , reaches its minimum , so that the variation of the integral about this path is zero : @xmath32 notice that the integration in occurs along a path , while in the hamiltonian principle of least action the integration is with respect to the time .",
    "transform the integrand of into the form of the lagrangian by changing @xmath6 for a time - like independent variable @xmath33 . if @xmath34 , then @xmath35 , where @xmath36 .",
    "substitution of @xmath37 into , @xmath38 turns the integrand into the lagrangian @xmath39 .",
    "we apply the euler method to to find the vector differential equation of the curve satisfying the fermat s principle .",
    "the euler s equation is @xmath40 the lagrangian derivatives with respect to @xmath41 and @xmath0 are @xmath42 and @xmath43 therefore , the euler s equation for our problem takes the form @xmath44 which , after multiplying both parts by @xmath45 , yields the ray equation : @xmath46 with the use of the vector identities , eq .",
    "can be represented in the format with explicit first and second derivatives of @xmath0 as @xmath47 this is a system of three second - order equations . by introducing the direction vector @xmath48 the system is transformed into the set of six first - order equations @xmath49 the set of equations is numerically solved by the proposed ray - tracing algorithm .",
    "note that the independent variable @xmath6 is the ray arc length so the solution to is a naturally parameterized curve @xmath50 .",
    "this infers the `` conservation law '' for @xmath8 , @xmath51 at any point of the curve .",
    "the algorithm of ray tracing described in section  [ sec_alg_descr ] is based on a scheme that conserves this property .",
    "it is intrersting to observe that equation is a particular case of a more general set of ray equations derived by @xcite : @xmath52 in eqs .",
    "@xmath53 is the dispersion relation of the medium , @xmath54 is time , @xmath55 is the group velocity of the wave packet , @xmath4 is the angular frequency , @xmath56 is the wave vector , and @xmath57 is the differentiation operator with respect to the @xmath56 components . system is a modification of the @xcite equations .",
    "its solutions are trajectories of rays of virtually any nature , not just electromagnetic , as long as the waves are plane and linear , varying in space and time as @xmath58 $ ] .",
    "let us show that equation is equivalent to system for the waves traveling through a collisionless isotropic plasma with the dispersion relation @xmath59 which is easily found from equation and the relation between the index of refraction and the magnitude @xmath60 of the wave vector , @xmath61 hereafter @xmath62 denotes the speed of light in the vacuum . in equations we change variables , time @xmath54 for arc length @xmath6 . for a curve @xmath63 , where @xmath54 is a parameter",
    ", the element of arc length @xmath64 differentiation of with respect to @xmath56 gives the first equation of system : @xmath65 and therefore the group velocity and its absolute value are @xmath66 then , according to , @xmath67 is rendered as follows : @xmath68 substitution of @xmath67 in equation yields @xmath69 the second equation of is obtained in a similar way by applying @xmath70 to the dispersion relation , @xmath71 and using to change @xmath67 for @xmath72 : @xmath73 we reduce equation to a form similar to that of . multiply both sides by @xmath74 and use : @xmath75 differentiate both sides with respect to @xmath72 : @xmath76 substitution of in the right - hand - side yields @xmath77 the left - hand - side of is the same as the first term in , while its right - hand - side is @xmath78 .",
    "this can be verified by applying @xmath70 operator to equation and using the dispersion relation .",
    "thus we have shown that equation derived directly from the fermat s principle in the previous section is equivalent to the general ray equations constrained by the conditions of plasma isotropy and absence of losses .",
    "the integration of system is based on an original algorithm developed as a modification of the boris implementation of the explicit @xcite scheme for the calculation of a charged particle motion in magnetic field @xcite .",
    "the @xcite cylrad algorithm secures the energy conservation , which is equivalent to conservation of the particle s squared velocity @xmath79 .",
    "the ray trajectory calculations require a different ( though similar ) conservation law to be observed .",
    "below is shown a brief derivation of the second - order difference scheme for the system .",
    "we introduce a vector quantity @xmath80 as @xmath81 substitute into to render the ray equations in the form @xmath82 formally , this set of equations is the same as ( 4 - 90 ) in the book by @xcite .",
    "however , in the ray trajectory equations the independent variable @xmath6 , the ray arc length , replaces the time @xmath54 , introducing the natural ray parameterization . the ray direction @xmath8 is used instead of the particle velocity @xmath83 , and the vector @xmath84 is used instead of the cyclotron frequency @xmath85 .",
    "analogously , the square of direction vector @xmath86 must also be conserved in the course of numerical integration , because @xmath87 for any regular point of a naturally parameterized curve .",
    "it is easy to show that @xmath80 is a vector whose length equals the ray curvature , defined as @xmath88 for naturally parameterized curves .",
    "render the second equation in as @xmath89 .",
    "multiply both sides of it by @xmath90 on the left : @xmath91 expanding the right - hand - side with the use of the vector identity and keeping in mind that @xmath92 and @xmath93 , we get @xmath94 but for the natural parameterization @xmath95 , hence , @xmath96    the numerical solution is sought at the nodes of one - dimensional grid marked on the ray trajectory . consider a grid whose nodes with respect to some @xmath97-th position are numbered as ... @xmath98 , @xmath99 , @xmath100 , @xmath101 , @xmath102 , ... and so forth .",
    "we subscript a variable with 0 if its value is taken at @xmath97-th point , with @xmath103 for @xmath101-th point , and with 1 for @xmath102-th point .",
    "a `` leapfrog '' difference scheme is used , where the half - step points are used in calculations .",
    "suppose a ray at a particular moment has its end position @xmath1 and direction @xmath2 .",
    "the ray tracing scheme provides formulae to calculate its successive position @xmath104 and direction @xmath105 after the step @xmath72 along the ray arc length .",
    "the variables subscripted with @xmath106 are intermediate and they are related to the middle of the step .",
    "note that the density and its gradient are provided only once for each step at the step middle point so the @xmath107 ratio is ascribed to the grid point @xmath101 .",
    "the second differential equation in can be approximated by the differences as @xmath108 approximation of @xmath109 as @xmath110 yields the implicit @xcite scheme @xmath111 this scheme has the benefit of unconditional stability .",
    "multiply both sides of scalarly by @xmath112 to get the property : @xmath113 which will be used later . to convert scheme into the explicit one , express @xmath105 from as @xmath114 and substitute it in the right - hand - side of for itself .",
    "it yields @xmath115 using the identity @xmath116 , vector identities , property , and rearranging the terms , we arrive at the explicit difference scheme known as the boris cylrad algorithm @xcite : @xmath117 the vector @xmath112 requires extrapolation : as seen from , the first multiplier , @xmath118 , is obtained at the intermediate point and therefore has the @xmath103 subscript , while the second , @xmath119 , is only available for the starting point subscripted with 0 .",
    "we denote this cross - product as @xmath120 , @xmath121 and use it as an initial value for @xmath80 extrapolation up to @xmath112 . the half - step difference scheme for the second equation in",
    "is @xmath122 substitution of @xmath109 into yields the extrapolated @xmath80 : @xmath123 in order to make the algorithm faster we reduce the number of multiplications .",
    "note that all the occurrences of @xmath80 in and have the multiplier @xmath124 , so it is expedient to include it in the expressions for @xmath80 in and .",
    "finally , we put together the formulae , , and and add the position vector @xmath0 adjustments at the start and the end to form the ray tracing algorithm .",
    "the algorithm presented below converts the initial ray position and direction @xmath125 into the new ones @xmath126 along the ray path in five steps :    [ alg ] @xmath127    the first step provides the @xmath0 half - step - ahead approximation @xmath128 .",
    "next two steps and calculate the half - step - ahead approximation for @xmath80 .",
    "the fourth step estimates the new ray direction , @xmath105 , based on the previous direction , @xmath2 , and @xmath112 .",
    "step five , , produces the new ray position , @xmath129 , through the half - step from the intermediate point @xmath128 along the new direction @xmath105 .",
    "the optical properties of the media where tracing the electromagnetic rays is of interest are often extremely nonuniform . for example , the electron number density @xmath130 within the chromosphere alone falls off with the height by more than 10 orders of magnitude . inside the solar corona",
    "@xmath130 decays with the solar distance also by decades of magnitude orders .",
    "the index of refraction , as the square root of proportional to @xmath130 dielectric permittivity , can change by many orders of magnitude within the region of study .",
    "the non - linear dependence of the refractive index on the wavelength poses other issues . for different wavelengths the ray geometry can be very different because the regions with the density greater than critical form different configurations in space .",
    "the numerical implementation of algorithm therefore must include the mechanisms for adaptive step size @xmath72 adjustment not only to ensure the specified precision but also to prevent the ray from penetration into the region with @xmath25 . in some cases",
    "@xmath1 appears so close to the region with the critical density that the step @xmath72 must be shorter than the absolute minimum step specified . for this condition",
    "a special method of replacing the ray trajectory by a segment of parabola or even straight line is used .",
    "all these techniques are described in this section .    in our implementation of the ray tracing algorithm , aimed at obtaining multi - pixel images ,",
    "many rays are processed simultaneously . over a single integration step each of the rays",
    "is tested for precision and correctness , and only those that passed the tests are submitted to the boris s algorithm to calculate new positions and directions .",
    "the rays for which the absolute minimum step leads to penetration to the region with @xmath25 are switched to the opposite parabola branches or just reflected from the critical surface .",
    "the rest are the rays whose step sizes are too large to secure the specified precision .",
    "the step size for them is shortened by applying formula .",
    "the rays with reduced step sizes are processed at the next integration step . if a ray is leaving the dense region , its step size @xmath72 is increased over the series of subsequent integration steps .",
    "the plasma density , @xmath131 , and its gradient , @xmath132 , are calculated through calls to the specialized subroutine once per each algorithm step .",
    "it is assumed that these plasma parameters are obtained through an mhd simulation and they are available at the nodes of a three - dimensional grid with variable grid step .",
    "the same subroutine provides the estimate for the maximum ray step size consistent with the mhd grid size for each ray .",
    "the desired precision of the ray trajectory is specified with the variable @xmath133 .",
    "it has the meaning of inverse number of the steps @xmath134 per a radian of the ray arc length .",
    "for example , @xmath135 means that at least 10 steps per one radian of ray arc length is required . at each algorithmic",
    "step the real precision is calculated and compared with @xmath133 , and if it exceeds @xmath133 , the step @xmath72 is decreased .    the curvature @xmath136 is defined as the inverse of instant curvature radius as @xmath137 .",
    "the actual ray curvature is available at each algorithm step as @xmath138 due to . instead of the real precision",
    "it is convenient to use the quantity @xmath139 , which is actually a halved real precision : @xmath140 the algorithm step requires calculation of @xmath139 anyway , so using it saves time .",
    "it is @xmath139 that is compared with @xmath141 to make decision on the @xmath72 reduction .",
    "comparing the halved real precision with the desired precision @xmath133 makes the step ajustment less frequent as the specified precision is secured over most of the ray trajectory portions . to reduce the number of floating - point calculations",
    ", the @xmath139 approximation uses the condition @xmath142 in the identity @xmath143 .",
    "the index of refraction @xmath12 in is replaced by the dielectric permittivity as defined in , so @xmath144 which with the use of the identity yields @xmath145\\ ] ] the step must be @xmath146 to have exactly @xmath147 points per radian of the ray , so due to it is corrected as : @xmath148    the subroutine that provides the plasma density and density gradient at each call also provides the desired new step size @xmath149 for each ray .",
    "after the positions and directions for the rays have been advanced with the current step sizes , the algorithm attempts to increase the steps towards @xmath149 .",
    "however , @xmath149 can be greater than the current @xmath72 by orders of magnitude , and near the critical surface a simple assignment @xmath150 would almost inevitably lead to the ray penetration past the critical surface",
    ". therefore the algorithm uses a special method for gradual increase of the step size .",
    "it is based on running a non - linear difference scheme which outputs the increased @xmath151 from the current @xmath72 and the desired @xmath149 .",
    "consider a difference equation associating two variables , the input x and the output y , specified at the points ...",
    "( i-1 ) , ( i ) , ( i+1 ) , ( i+2 ) ... and so on : @xmath152 for constant input @xmath153 the solution to eq .",
    "is stable for any initial condition on the output variable @xmath154 between 0 and @xmath155 .",
    "the solution to eq . always converges to the value @xmath155 .",
    "the useful property of eq .",
    "is that for a small ( compared to @xmath155 ) initial condition @xmath154 the solution behaves similar to growing exponential function @xmath156 , while for large values of @xmath154 , i.e. those closer to the x , it grows slower and slower similar to the decaying exponent @xmath157 , eventually converging to @xmath155 .",
    "this behavior is illustrated in fig .",
    "[ nlinstepincr_f1 ] .",
    "notice that reasonably large initial values for @xmath154 ensure fast convergence within 1% of the range @xmath158 $ ] : 10 steps for @xmath159 , and even 3 steps for @xmath160 .    in our algorithm implementation",
    "the step @xmath72 is incremented using the eq . as the algorithm @xmath161 when @xmath72 is small compared to @xmath149 , each next value of @xmath151 is almost @xmath162",
    ", so @xmath72 grows in a geometrical progression .",
    "however , as ds approaches@xmath149 , its growth rate becomes slower .",
    "these features ensure fast and yet smooth adjustment of @xmath72 in several steps up to the specified @xmath149 value .",
    "correctness of the ray path computation is violated if at some step the ray penetrates the critical surface .",
    "this condition can arise for very steep rays , almost normally incident on the critical surface . to prevent a ray from trespassing the critical surface",
    "the algorithm makes a linear prediction on the next value of dielectric permittivity @xmath163 .",
    "if the predicted @xmath163 is negative , the ray is approximated by a parabola and it is then switched to the symmetrical point on the opposite branch of the parabola .",
    "this is similar to the reflection at the critical surface , after which the ray starts traveling away from it .",
    "however , the linear @xmath163 prediction may fail due to highly non - linear plasma density distribution and then the ray trespasses the critical surface .",
    "this unphysical condition is corrected by returning the ray its previous position and direction , numerical calculation of the distance to critical surface along this direction , and linear reflection of the ray at the critical surface .    when the current ray state is @xmath125 and",
    "the algorithm is calculating its next position and direction @xmath126 , the mid - step values of the plasma density @xmath164 and its gradient @xmath165 are obtained from the subroutine , so the dielectric permittivity @xmath166 and its gradient @xmath167 are available from and , respectively",
    ". if the ray at next step occasionally trespasses the critical surface , the next value of permittivity , @xmath168 , will be negative .",
    "therefore , predicting the sign of @xmath168 helps the algorithm to make decision whether to use the boris scheme or take measures to avoid the penetration past the critical surface .",
    "the prediction is based on testing the condition @xmath169    replace both numerator and denominator in by the linear portions of their taylor series : @xmath170 where @xmath171 is the permittivity value at the point @xmath1 . after rearranging the terms and dividing both parts by @xmath171 we arrive at the correctness criterion : @xmath172 since the plasma density subroutine provides only the half - step value , @xmath164 and , hence , only the half - step permittivity value , @xmath173 , can be directly calculated , @xmath171 is obtained as its back approximation using the linear terms of its taylor series : @xmath174 if inequality is true , the next step is supposed to be safe .",
    "if not , the ray is so close to the critical surface and so steep that it will penetrate the critical surface at the current step @xmath72 . in this case",
    "the next position and direction are calculated through parabolic approximation .",
    "this method is used when the correctness criterion fails and the ray is about to trespass the critical surface .",
    "if the step @xmath72 is small enough , the dielectric permittivity gradient @xmath175 can be considered constant over the ray path . in the medium with @xmath176 the electromagnetic rays have parabolic trajectories , which will be shown further .",
    "knowing the parameters of the parabola ( see fig .",
    "[ rayparabl_f2 ] ) , the algorithm calculates the position and direction vectors @xmath126 of the ray at the symmetric point of the opposite branch of the parabola .",
    "the ray is switched to the opposite parabolic trajectory branch so that instead of approaching the critical surface it starts departing it . in order to find the new position and direction after the parabola switching we solve the ray eq . in two dimensions in the @xmath177-plane containing the vectors @xmath178 and @xmath2 , the @xmath155 axis collinear with @xmath179 .",
    "consider a simple 2-dimensional case of a ray traveling within the @xmath177-plane , where the dielectric permittivity changes linearly from @xmath180 at the origin of coordinates down to @xmath181 at some distance @xmath182 along the @xmath155 axis , so that @xmath183 the case schematic is shown in fig .",
    "[ rayparabl_f2 ] .",
    "we shall derive the equation for the ray trajectory passing through an arbitrary point @xmath184 .",
    "the equation set for the ray trajectory in the two - dimensional geometry consists of two equations for @xmath185 and @xmath186 .",
    "the dielectric permittivity @xmath163 changes in the @xmath155 direction only , so does the index of refraction @xmath12 , therefore its gradient component along the @xmath187 axis , @xmath188 , is zero , and the equation for @xmath186 takes the form @xmath189 which immediately implies @xmath190 refer to the schematic in fig .",
    "[ parrayprm_f3 ] .",
    "denote the values of @xmath12 and @xmath163 at the point @xmath184 as @xmath191 , where @xmath171 is calculated as in . the direction vector component @xmath192 , where @xmath193 is the angle between the ray direction @xmath2 and @xmath178 , which is the @xmath155 axis here .",
    "therefore , the constant in can be presumed in the form @xmath194 , so @xmath195 using the relationship @xmath196 and excluding @xmath72 , we arrive at the differential equation @xmath197    since @xmath163 is a linear function , @xmath198 , where @xmath199 , so eq . can be integrated as @xmath200 to yield the solution in the form @xmath201 : @xmath202 this second order parabola equation describes the electromagnetic ray trajectory for linearly distributed @xmath163 .",
    "its vertex point @xmath203 coordinates are    [ parvert ] @xmath204    we intend to avoid tracing the points lying on the parabola . assume the ray has already traveled from the point @xmath184 all the way to the axially symmetric point @xmath205 at the opposite branch . in three - dimensional",
    "case its position and direction have changed to @xmath126 .",
    "we need to find the increment @xmath206 such that @xmath207 note that @xmath208 and @xmath209 because @xmath210 in the considered vicinity .",
    "using yields the length of the increment : @xmath211 in the chosen @xmath177 coordinates @xmath206 points in the @xmath187 direction .",
    "decompose @xmath2 into its @xmath155 and @xmath187 components @xmath212 and @xmath213 , @xmath214 here @xmath215 , @xmath216 , and @xmath217 .",
    "we can state that the vector increment @xmath206 should be made in the @xmath187 , i.e. @xmath213 , direction , so @xmath218 since @xmath193 is the angle between @xmath178 and @xmath2 , @xmath219 whence the vector increment from @xmath1 to @xmath104 at the opposite branch of the parabola is @xmath220    from the ( hypothetical ) distance to the critical surface is @xmath221 . with @xmath222 from ,",
    "we introduce a useful expression @xmath223 using which the increment can be written as @xmath224 the new ray direction @xmath105 is calculated from the geometrical considerations shown in fig .",
    "[ reflraydir_f4 ] as @xmath225    to obtain the vector @xmath212 , we multiply its absolute value @xmath226 from by the unity vector along the @xmath155 axis , which is @xmath227 , to get the result : @xmath228 or , using the notation , @xmath229 thus , after the parabola switching , the new ray position and direction are    [ parabl_r1v1 ] @xmath230    for the purposes of path integration in line with the trajectory calculation , the integrand is multiplied by the length of every step @xmath72 . in case of the parabola switching the integrand",
    "is multiplied by the length of the parabola segment , @xmath231 , from @xmath1 to @xmath104 . assuming this length is small enough it can be replaced by the length of two straight line segments connecting the points ( in @xmath177 coordinates ) @xmath184 , the parabola vertex @xmath203 , and @xmath205 , as shown in fig .",
    "[ parlenapprox_f5 ] .",
    "denote as @xmath232 the distance from @xmath184 to @xmath203 along the @xmath155 axis or , which is the same , along the vector @xmath233 ( see also fig .",
    "[ parrayprm_f3 ] ) .",
    "then the parabola length approximation is @xmath234 we already know that @xmath235 . from and using we can find : @xmath236      the criterion is based on the linear forward approximation of @xmath163 , and sometimes it works incorrectly if the plasma density distribution near the critical surface is highly nonlinear ( for example , exponential , as in the chromosphere ) . under these conditions",
    "the calculated new point of the ray , @xmath104 , appears in the region with @xmath25 , which is impossible in the physical reality . to fix his condition the algorithm stores in memory the previous ray position and direction @xmath237 .",
    "when the penetration is detected , the algorithm restores the ray state to one step back : @xmath238 the parabola switching mechanism in this situation can not be relied upon because the linear taylor series approximations similar to have already failed and the parabola parameters would be calculated incorrectly .",
    "the algorithm uses the newton s method to find the length of step @xmath72 along the direction @xmath239 such that the next ray point , @xmath129 , lies on the critical surface with some small clearance @xmath240 .",
    "then the algorithm performs linear reflection according to the snell law .",
    "since this conditions only occur at high frequencies when the rays are close to straight lines , this procedure does not deteriorate the algorithm s precision .",
    "the newton s algorithm is based on stepwise approximation : @xmath241 where @xmath242 is the directional derivative of @xmath243 along the vector @xmath2 , so the calculations are performed according to the scheme @xmath244 the process stops when @xmath245 .",
    "the ray direction is then corrected according to the snell s law .",
    "its geometry is the same as for the parabola switching shown in fig .",
    "[ reflraydir_f4 ] , so @xmath225 where @xmath212 is calculated as in , and the next algorithmic step is performed with the last @xmath72 value immediately from the critical surface .",
    "the software implementation of the ray tracing algorithm comprises computer programs in the fortran 90 and c languages . as an example of the algorithm validation , the ray trajectories in a hypothetical medium with the linear dielectric permittivity @xmath163 distribution",
    "have been obtained numerically using the algorithm and compared with the exact solutions .",
    "the results are shown in fig .",
    "[ numvsexact_f6 ] .",
    "the permittivity @xmath163 linearly falls off along the x axis starting from 1 at @xmath246 down to 0 at some distance @xmath182 , as given by eq . .",
    "the ray trajectories in this medium have been shown to be parabolas described by eq . .",
    "we chose the distance @xmath247 of conditional units ( they might be solar radii , for example ) , and set the starting point @xmath1 at the coordinate origin @xmath248 . here",
    "the ray equation takes the form @xmath249 where @xmath193 is the angle of incidence on the critical surface at @xmath250 .",
    "the results of comparison are presented in panel * a * of fig .",
    "[ numvsexact_f6 ] .",
    "four angles @xmath193 were selected : @xmath251 , and @xmath252 .",
    "the exact solutions calculated by are plotted in thin solid lines ; the ray traces created by the algorithm are plotted over them as thicker dashed lines .",
    "the dashed curves cover the solid ones , so one can conclude the numerical solutions are essentially precise . in panel",
    "* b * of fig .",
    "[ numvsexact_f6 ] the differences between the numerical and exact solutions are more discernible because only a short piece of the trajectory in the vicinity of the parabola vertex is shown .",
    "the algorithm has been applied for solar studies and shown good results .",
    "a series of numerical experiments was conducted to simulate the brightness temperature distribution , @xmath253 , across the solar disk as seen from the earth , in the wide frequency range from 10 mhz to 3 ghz .",
    "the calculation of @xmath253 requires the ray tracing .",
    "we used different electron density distributions , @xmath130 ( @xmath254 ) , for the corona and the chromosphere .",
    "the coronal @xmath130 was approximated by the @xcite model : @xmath255 where @xmath256 is distance in solar radii , @xmath257 , from the sun center and @xmath258 is the heliographic colatitude . in the chromosphere ,",
    "up to 9,000 km from the photosphere , we used the @xcite model : @xmath259 and in the layer between the chromosphere and corona , for the altitudes from 9,000 km to 11,000 km , a smooth polynomial patch function was used .    in fig .",
    "[ raybunch_f7 ] is shown a bunch of the computed ray trajectories at 80 mhz , refracting in the coronal and chromospheric plasmas .",
    "the @xmath260 evenly spaced rays comprise a beam converging to a point at the earth distance ( here 215 @xmath261 ) , where the rays can be displayed as a @xmath262-pixel raster image .",
    "note that in our experiments with the ray - tracing algorithm the typical raster sizes were from @xmath263 to @xmath264 and more ; the beam in fig .",
    "[ raybunch_f7 ] is shown for illustrative purposes only .",
    "as seen , the rays arriving at the earth to form an image at 80 mhz can carry information from very different heliospheric regions due to differences in refraction across the image plane",
    "[ refrac200mhz_f8 ] shows the results of ray tracing at 200 mhz in the @xmath265 plane of the the @xmath266 @xcite coordinate system ( the @xmath155 points from the sun center at the earth ) .",
    "the rays make up an envelope outlining the critical surface , which is at approximately @xmath267 from the sun center .    the higher the frequency , the deeper the electromagnetic rays penetrate into the solar vicinity .",
    "[ refracfreq_f9 ] helps estimate the solar distances where the rays at different frequencies start to significantly change the direction .",
    "the two thin beams of rays are directed parallel to the @xmath266 @xmath155 axis at the @xmath268 distances of @xmath269 and @xmath270 , respectively .",
    "each beam includes rays at the frequencies 10 , 18 , 40 , 80 , 200 mhz , and 3 ghz .",
    "[ refracfreq_f9 ] can be also viewed as the `` spectral decomposition '' .",
    "one can notice that at 3 ghz the rays are virtually straight lines .",
    "the proposed algorithm is intended for efficient computation of electromagnetic ray traces in the heliospheric plasmas in parallel with integration over the ray paths . to be fast ,",
    "it is based on a difference scheme of the second order of precision , but it has a property of conserving the direction cosine vector length of the computed trajectory . with this benefit ,",
    "the algorithm maintains sufficient precision .",
    "the difference scheme is only a part of the algorithm : besides , it incorporates several mechanisms for adaptive estimation of the optimal step and prevention of occasional ray penetrations into the regions where the plasma frequencies are higher than the own ray frequency",
    ".    the algorithm has been tested on problems of the solar disk image simulation , and it demonstrated good speed , precision , and robustness .",
    "we presented here some results pertaining to the ray traces calculation only ; the main results will be published in a separate paper .",
    "however , we can conclude that , as seen from fig .",
    "[ refracfreq_f9 ] , observations at different frequencies are dominated by different layers of the corona and chromosphere the broad band observations could help reveal the large scale structures in these domains , which can be likened to peeling the layers of an onion bulb .",
    "the new high - resolution radiotelescope mwa with its frequency range from 80 to 300 mhz therefore will be an effective instrument in the solar studies .",
    "the algorithm and software described in this paper were intended for use as the analysis tool for the mwa solar images .",
    "however we should specially point out that the algorithm applications are in no way confined to the mwa project only .",
    "the algorithm can be used for virtually any radioastronomical study because of its very wide frequency range .    among possible future improvements to the algorithm we could mention the plans on employment of the multi - core , hyperthreading , and multi - channel - memory powers of the modern computers .",
    "the problem of simultaneous computation of many ray trajectories can be effectively decomposed into several threads , each running on a separate cpu , because the rays in a beam are calculated independently .",
    "this work was supported by a nsf grant to the mit haystack observatory .",
    "mwa is a large international collaboration , the partner institutions for which are listed below .",
    "the us part of the mwa collaboration is funded by the nsf astronomy and atmospheric sciences divisions .",
    "boris , j. , relativistic plasma simulation - optimization of a hybrid code , _ proc .",
    "4th conf . on the numer .",
    "simulation of plasmas _ , office of naval research , arlington , va .",
    "3 - 67 , 1970 cillie , g. g. , and menzel , d. h. , _ harv .",
    "* 410 * , 1935 .",
    "crank , j. and p. nicolson , a practical method for numerical evaluation of solutions of partial differential equations of the heat conduction type , _ proc .",
    "soc . _ * 43 * : 5067 , doi 10.1007/bf02127704 , 1947 .",
    "frnz , m. and harper , d. , heliospheric coordinate systems , _ planetary and space science _ , vol . * 50 * , issue 2 , pp .",
    "217 - 233 , 2002 haselgrove , j. , ray theory and a new method for ray tracing , _ the physics of the ionosphere _ ,",
    "london , physical society , pp . 355 - 364 , 1955 .",
    "hockney , r. w. and j. w. eastwood , computer simulation using particles , _ mcgraw - hill _ , 1988 saito , k. , a non - spherical axisymmetric model of the solar k corona of the minimum type , _ ann .",
    "tokyo astron .",
    "_ , second ser",
    "* 12 * , pp .",
    "53 - 120 , 1970 walker , a.d.m .",
    ", ray tracing in the magnetosphere , _ radio science bulletin _ , * 327 * , pp . 26 - 38 , 2008"
  ],
  "abstract_text": [
    "<S> in this paper a new efficient algorithm for computation of radio wave ray trajectories in isotropic media is described . </S>",
    "<S> the algorithm is based on an original second - order difference scheme with a specific `` length - conservation '' property , which allows to resolve the ray shape even in the regions where its curvature is high . </S>",
    "<S> besides the scheme , the algorithm includes a number of mechanisms securing its correctness and stability . </S>",
    "<S> the algorithm is intended for obtaining multi - pixel solar images in wide range of radio frequencies , and it is designed to be used in studies of the solar environment with modern high - resolution radiointerferometers and radiotelescopes such as the murchison widefield array ( mwa ) . </S>"
  ]
}