{
  "article_text": [
    "sequential programs can naturally be modeled with kleene automata , or equivalently with rational expressions , finite monoids , or monadic second - order ( mso ) logic .",
    "the algebraic approach of automata provides an huge toolbox for the study of properties of programs , and has been widely used as a base for a lot of algorithms that manipulate logic formulas .",
    "the links between kleene automata , rational expressions , finite monoids and mso have important consequences in a lot of domains of computer science and mathematics , some of them are concretely applied as for example in program verification , others are more theoretical as for example in set theory .",
    "introducing commutativity allows access to models of programs with permutation of instructions , or to concurrent programming . among the formal tools for the study of commutativity in programs ,",
    "let us mention for example mazurkiewicz s traces , integer vector automata or commutative monoids .",
    "in this paper we focus on the notion of _ branching automata",
    "_ introduced by lodaya and weil  @xcite .",
    "branching automata are an extension of kleene automata with particular transitions that naturally model parallelism .",
    "traces of paths in branching automata are not ( totally ordered ) words as in kleene automata , but partially ordered sets ( posets ) of letters , which are structured as traces of programs using the fork - join primitive for concurrency .",
    "those particular posets , called _ n - free _ , are widely used in the study of concurrency .",
    "the fork - join primitive splits an execution flow @xmath0 into @xmath1 concurrent execution flows and joins @xmath1 before it continues . divide - and - conquer concurrent programming naturally uses this fork - join principle .",
    "lodaya and weil generalized several important results of the theory of kleene automata to branching automata , for example , a notion of rational expression with the same expressivity as branching automata .",
    "they also investigated the question of the algebraic counterpart of branching automata : the sp - algebras are sets equipped with two different associative products , one of them being also commutative .",
    "contrary to the theory of kleene automata , branching automata do not coincide any more with finite sp - algebras .",
    "an interesting particular case is the bounded - width rational languages  @xcite , where the cardinality of the antichains of the posets of languages are bounded by an integer @xmath2 .",
    "they correspond to fork - join models of concurrent programs with @xmath2 as the upper bound of the number of execution flows ( @xmath2 is the number of physical processors ) .",
    "bounded - width rational languages have a natural characterization in rational expressions , branching automata , and sp - algebras .",
    "taking into account those characterizations , the expressiveness of branching automata corresponds exactly to the finite sp - algebras .",
    "furthermore , kuske  @xcite proved that in this case , branching automata coincide also with monadic second - order logic , as it is the case for the rational languages of finite words .",
    "as in the general case monadic - second order logic is less expressive than branching automata , the question of an equivalent logic was left open .    in this paper",
    "we investigate the question of defining a logic equivalent to branching automata in the general case .",
    "this paper contains two results regarding branching automata :    * we prove that the class of languages defined by branching automata is closed under complementation ; * we define a logic , named _",
    "p - mso _ as it is basically monadic second - order logic enriched with presburger arithmetic , that is exactly as expressive as branching automata .",
    "the ( effective ) proof of the first result essentially relies on the closure under complementation of rational languages of a finitely generated commutative monoid ( theorem  [ th : schutz ] , by schtzenberger and eilenberg ) .",
    "the proof of the second result relies on effective constructions from one formalism to the other . as a consequence , the p - mso theory of the class of finite n - free posets is decidable .",
    "the paper is organized as follows .",
    "section  [ sec : not ] recalls basic definitions on posets .",
    "section  [ sec : languages ] is devoted to branching automata , rational expressions and sp - algebras .",
    "the complementation of rational languages is discussed in section  [ sec : complementation ] .",
    "section  [ sec : pmso ] is devoted to the logical approach of branching automata .",
    "finally , we present an alternative definition for branching automata in section  [ sec : pbranching ] .",
    "let @xmath3 be a set .",
    "we denote by @xmath4 , @xmath5 and @xmath6 respectively the set of subsets of @xmath3 , the set of non - empty subsets of @xmath3 and the set of multi - subsets of @xmath3 with at least two elements . for any integer @xmath2",
    ", the set @xmath7 is denoted @xmath8 $ ] and the group of permutations of @xmath8 $ ] by @xmath9 .",
    "the cardinality of @xmath3 is denoted by @xmath10 .",
    "we use the same notation for sets and multi - sets .",
    "we sometimes denote by @xmath11 the multiplicity @xmath12 of an element @xmath13 of a multi - set .    a _ poset _ @xmath14 is composed of a set @xmath15 equipped with a partial ordering @xmath16 . in this paper",
    "we consider only finite posets . for simplicity , by _ poset",
    "_ we always mean _ finite _ poset .",
    "a _ chain _ of length @xmath2 in @xmath15 is a sequence @xmath17 of elements of @xmath15 .",
    "an _ antichain _",
    "@xmath3 in @xmath15 is a set of elements of @xmath15 mutually incomparable for @xmath16 .",
    "the _ width _ of @xmath15 is the size of a maximal antichain of @xmath15 . an _ alphabet _ is a nonempty finite set whose elements are called _",
    "letters_. a poset @xmath18 _ labeled _ by @xmath19 is composed of a poset @xmath14 and a map @xmath20 which associates a letter @xmath19 with any element of @xmath15 .",
    "observe that the posets of width 1 labeled by @xmath19 correspond precisely to the usual finite words : finite totally ordered sequences of letters . throughout this paper , we use labeled posets as a generalization of words . in order to lighten the notation we write @xmath15 for @xmath18 when no confusion is possible .",
    "the unique empty poset is denoted by @xmath21 .",
    "let @xmath22 and @xmath23 be two disjoint posets labeled respectively by the alphabets @xmath19 and @xmath24 .",
    "parallel product _ of @xmath15 and @xmath25 , denoted @xmath26 , is the set @xmath27 equipped with the orderings on @xmath15 and @xmath25 such that the elements of @xmath15 and @xmath25 are incomparable , and labeled by @xmath28 by preservation of the labels from @xmath15 and @xmath25 .",
    "it is defined as @xmath29 where @xmath30 if and only if :    * @xmath31 and @xmath32 or * @xmath33 and @xmath34    and @xmath35 if @xmath36 , @xmath37 if @xmath38 .    the _ sequential product _ of @xmath15 and @xmath25 , denoted by @xmath39 or @xmath40 for simplicity , is the poset @xmath29 labeled by @xmath28 , such that @xmath41 if and only if one of the following conditions is true :    * @xmath36 , @xmath42 and @xmath32 ; * @xmath38 , @xmath43 and @xmath34 ; * @xmath36 and @xmath43    and @xmath35 if @xmath36 , @xmath37 if @xmath38 .",
    "observe that the parallel product is an associative and commutative operation on posets , whereas the sequential product does not commute ( but is associative ) .",
    "the parallel and sequential products can be generalized to finite sequences of posets .",
    "let @xmath44 be a sequence of posets .",
    "we denote by @xmath45 and @xmath46 .",
    "the class of _ series - parallel _ posets , denoted @xmath47 , is defined as the smallest set containing the posets with zero and one element and closed under finite parallel and sequential product .",
    "it is well known that this class corresponds precisely to the class of n - free posets  @xcite , in which the exact ordering relation between any four elements @xmath48 can not be @xmath49 , @xmath50 and @xmath51 . the class of series - parallel posets labeled by an alphabet @xmath19 is denoted @xmath52 .",
    "we write @xmath53 for @xmath54 and @xmath55 for @xmath56 .",
    "a poset @xmath15 has a _ sequential ( resp .",
    "parallel ) factorization _ if @xmath57 ( resp .",
    "@xmath58 ) for some nonempty posets @xmath59 and @xmath60 . a sequential factorization @xmath61 is _ maximal _ if each @xmath62 , @xmath63 $ ] , has no sequential factorization .",
    "the definition of the notion of _ maximal parallel factorization _ is similar .",
    "posets having a parallel factorization are called _ parallel posets_. the _ sequential posets _ are those of cardinality 1 and those having a sequential factorization .",
    "a _ language _ of a set @xmath64 is a subset of @xmath64 .",
    "let @xmath19 be an alphabet .",
    "the sequential and parallel product of labeled posets can naturally be extended to languages of @xmath52 . if @xmath65 , then @xmath66 and @xmath67 .",
    "let @xmath19 and @xmath68 be two alphabets and let @xmath69 , @xmath70 and @xmath71 .",
    "we define the language @xmath72 by substituting non - uniformly in @xmath15 each element labeled by @xmath73 by a labeled poset of @xmath74 .",
    "this substitution @xmath75 is the homomorphism from @xmath76 into the power - set algebra @xmath77 with @xmath78 for all @xmath79 , @xmath80 , and @xmath81 .",
    "it can be easily extended from labeled posets to languages of posets . using this ,",
    "we define the substitution and the iterated substitution on languages . by the way the usual kleene rational operations  @xcite are recalled .",
    "let @xmath74 and @xmath82 be languages of @xmath52 : @xmath83 a language @xmath84 is _ rational _ if it is empty , or obtained from the letters of the alphabet  @xmath19 using usual rational operators  : finite union @xmath85 , finite concatenation @xmath86 , and finite iteration @xmath87 , and using also the finite parallel product @xmath88 , substitution @xmath89 and iterated substitution @xmath90 , provided that in @xmath91 any element labeled by @xmath73 in a labeled poset @xmath92 is incomparable with another element of @xmath15 .",
    "this latter condition excludes from the rational languages those of the form @xmath93 , for example , which are known to be not kleene rational .",
    "observe also that the usual kleene rational languages are a particular case of the rational languages defined above , in which the operators @xmath88 , @xmath89 and @xmath90 are not allowed .",
    "[ ex : abc ] let @xmath94 and @xmath95 .",
    "then @xmath74 is the smallest language containing @xmath96 and such that if @xmath97 , then @xmath98 : @xmath99    let @xmath74 be a language where the letter @xmath73 is not used . in order to lighten the notation we use the following abbreviation : @xmath100 @xmath101 and @xmath102 are the sequential iterations of @xmath74 whereas @xmath103 and @xmath104 are its parallel iterations .",
    "branching automata are a generalization of usual kleene automata .",
    "they were introduced by lodaya and weil  @xcite .",
    "a _ branching automaton _ ( or just _ automaton _ for short ) is a tuple @xmath105 where @xmath25 is a finite set of states , @xmath19 is an alphabet , @xmath106 is the set of _ initial states _ ,",
    "@xmath107 the set of _ final states _ , and @xmath3 is the set of _ transitions _ of @xmath108 .",
    "the set of transitions of @xmath3 is partitioned into @xmath109 , according to the different kinds of transitions :    * @xmath110 contains the _ sequential _ transitions , which are usual transitions of kleene automata ; * @xmath111 and @xmath112 are respectively the sets of _ fork _ and _ join _ transitions .",
    "sequential transitions @xmath113 are sometimes denoted by @xmath114 .",
    "arity _ of a fork ( resp .",
    "join ) transition @xmath115 ( resp .",
    "@xmath116 ) is @xmath117 .",
    "we now turn to the definition of paths in automata .",
    "the definition we use in this paper is different , but equivalent to , the one of lodaya and weil  @xcite .",
    "paths in automata are posets labeled by transitions .",
    "@xmath118 from a state @xmath119 to a state @xmath120 is either the empty poset ( in this case @xmath121 ) , or a non - empty poset labeled by transitions , with a unique minimum and a unique maximum element .",
    "the minimum element of @xmath118 is mapped either to a sequential transition of the form @xmath122 for some @xmath79 and @xmath123 or to a fork transition of the form @xmath124 for some @xmath125 .",
    "symmetrically , the maximum element of @xmath118 is mapped either to a sequential transition of the form @xmath126 for some @xmath79 and @xmath127 or to a join transition of the form @xmath128 for some @xmath129 .",
    "the states @xmath119 and @xmath120 are respectively called _ source _ ( or _ origin _ ) and _ destination _ of @xmath118 . two paths @xmath118 and @xmath130 are _ consecutive _ if the destination of @xmath118 is also the source of @xmath130 .",
    "formally , the paths @xmath118 labeled by @xmath131 in @xmath132 are defined by induction on the structure of  @xmath15 :    * for any transition @xmath133 , then @xmath134 is a path from @xmath119 to @xmath120 , labeled by @xmath135 ; * for any finite set of paths @xmath136 ( @xmath137 ) respectively labeled by @xmath138 , from @xmath139 to @xmath140 , if @xmath141 is a fork transition and @xmath142 a join transition , then @xmath143 is a path from @xmath119 to @xmath120 and labeled by @xmath144 ; * for any non - empty finite sequence @xmath145 of consecutive paths respectively labeled by @xmath146 , then @xmath147 is a path labeled by @xmath148 from the source of @xmath149 to the destination of @xmath150 ;    observe that non - empty paths are labeled posets of two different forms : @xmath134 or @xmath151 for some transitions @xmath152 and some labeled poset @xmath15 . in an automaton @xmath132 , the existence of a path @xmath118 from @xmath119 to @xmath120 labeled by @xmath69 is denoted by @xmath153 .",
    "a state @xmath154 is a _ sink _ if @xmath154 is the destination of any path originating in  @xmath154 .",
    "a labeled poset is _ accepted _ by an automaton if it is the nonempty label of a path , called _ successful _ , leading from an initial state to a final state .",
    "the language @xmath155 is the set of labeled posets accepted by the automaton @xmath132 .",
    "a language @xmath74 is _ regular _ if there exists an automaton @xmath132 such that @xmath156 .",
    "[ ex : oneaatleast ] figure  [ fig : ontaatleast ] represents an automaton on the alphabet @xmath157 that accepts @xmath131 iff @xmath15 contains at least one @xmath135 .",
    "it has one initial state @xmath158 and one final state @xmath159 , two sequential transitions labeled by @xmath135 from @xmath158 to @xmath159 and from @xmath159 to @xmath159 , two sequential transitions labeled by @xmath160 from @xmath158 to @xmath158 and from @xmath159 to @xmath159 , two fork transitions @xmath161 and @xmath162 , and three join transitions @xmath163 ,",
    "@xmath164 and @xmath165 .",
    "( 1)(0,0)@xmath158(1 ) ( 2)(16,0)@xmath159(2 ) ( 1,2)@xmath135 ( 1)@xmath160 ( 2)@xmath166    \\(1 ) ( 1 ) ( -4,1.5)(-5,0)(-4,-2 )    ( -8,3)(-11,6)(-8,0 ) ( -8,-3)(-11,-6)(-8,0 ) ( -8,0)(-7,0)(-6,0 ) ( -9,1.5)(-10,0)(-9,-2 )    ( 23,3)(26,6)(23,0 ) ( 23,-3)(26,-6)(23,0 ) ( 23,0)(22,0)(21,0 ) ( 24,1.5)(25,0)(24,-2 )    ( 27,0)(30,6)(27,3 ) ( 27,0)(30,-6)(27,-3 ) ( 28,1.5)(29,0)(28,-2 )     ( 2 ) ( 2.5,-2.5)(12,-6)(14.3,-4 ) ( 12,-6)(13,-7)(14,-6 )    [ th : kleenebranching ] let @xmath19 be an alphabet , and @xmath167 .",
    "then @xmath74 is regular if and only if it is rational .",
    "[ ex : anbnauto ] on its left side , figure  [ fig : autoab ] represents the automaton @xmath168 where the set of sequential transitions is @xmath169 , the set of fork transitions is @xmath170 and finally the set of join transitions is @xmath171 .",
    "on the right side of the figure is pictured an accepting path labeled by @xmath172 .",
    "actually , @xmath173 .",
    "( 1)(-10,-12)@xmath158(1 ) ( 2)(0,-8)@xmath159 ( 3)(0,-16)@xmath174 ( 4)(10,-8)@xmath175 ( 5)(10,-16)@xmath176 ( 6)(20,-12)@xmath177(6 ) ( 2,4)@xmath135 ( 3,5)@xmath160 ( 1,2 ) ( 1,3 ) ( 1 ) ( 1 ) ( -6,-10.3)(-5,-12)(-6,-13.7 ) ( -14,-10.5)(-15,-12)(-14,-14 ) ( 4,6 ) ( 5,6 ) ( 6 ) ( 6 ) ( 24,-10.3)(25,-12)(24,-13.7 ) ( 16,-10.5)(15,-12)(16,-14 ) ( 7)(50,-12.5)@xmath158 ( 8)(60,-7.5)@xmath158 ( 9)(70,-5)@xmath159 ( 10)(60,-17.5)@xmath158 ( 7,8 ) ( 7,10 ) ( 11)(70,-10)@xmath174 ( 12)(70,-15)@xmath159 ( 13)(70,-20)@xmath174 ( 10,12 ) ( 10,13 ) ( 14)(90,-10)@xmath176 ( 15)(90,-15)@xmath175 ( 16)(90,-20)@xmath176 ( 17)(100,-17.5)@xmath177 ( 15,17 ) ( 16,17 ) ( 18)(100,-7.5)@xmath177 ( 19)(90,-5)@xmath175 ( 20)(110,-12.5)@xmath177 ( 17,20 ) ( 18,20 ) ( 19,18 ) ( 14,18 ) ( 8,9 ) ( 8,11 ) ( 9,19)@xmath135 ( 13,16)@xmath160 ( 11,14)@xmath160 ( 12,15)@xmath135    [ ex : abcauto ] let @xmath94 and @xmath178 be the language of examples  [ ex : abc ] and  [ ex : abcalgebra ] . figure  [ fig : autoaxib ] represents an automaton @xmath132 such that @xmath179 .",
    "( 2)(0,-8)@xmath158 ( 3)(0,-16)@xmath159 ( 4)(10,-8)@xmath174 ( 5)(20,-8)@xmath175 ( 6)(10,-16)@xmath176 ( 2,4)@xmath160 ( 4,5)@xmath96(4)(5 ) ( 3,6)@xmath135 ( 4,2 ) ( 4,3 ) ( 6,-9.3)(5.5,-10)(6,-10.9 )    ( 6,5 ) ( 5 ) ( 15,-12)(16,-12.5)(17,-12 )    [ prop : union ] let @xmath19 be an alphabet . the class of regular languages of @xmath55 is closed under finite union .",
    "furthermore , if @xmath68 is an alphabet , @xmath180 a morphism of free sp - algebras , and @xmath74 a regular language of @xmath55 , then @xmath181 is a regular language of @xmath182 .",
    "the closure under finite union is a direct consequence of the generalization of the notion of cartesian product of automata to branching automata .",
    "the closure under direct image by @xmath183 is also an easy generalization of the construction for kleene rational languages .",
    "[ prop : findpath ] let @xmath119 and @xmath120 be two states of a branching automaton @xmath132 .",
    "it is decidable , in polynomial time , if there is a path from @xmath119 to @xmath120 in @xmath132 .",
    "an automaton is _ sequentially separated _ if , for all pairs @xmath184 of states , all labels of paths from @xmath119 to @xmath120 are parallel posets , or all labels of paths from @xmath119 to @xmath120 are sequential posets .",
    "the following proposition will be used later in the paper .",
    "[ prop : seqsepauto ] for every automaton @xmath132 there is a sequentially separated automaton @xmath185 such that @xmath186 .",
    "let @xmath187 .",
    "the states of @xmath185 are the elements of @xmath188 . in @xmath185",
    ", there is    * a sequential transition @xmath189 iff @xmath190 , * a fork transition @xmath191 iff @xmath192 , * a join transition @xmath193 iff @xmath194 .    the initial ( resp .",
    "final states ) of @xmath185 are those of the form @xmath195 with @xmath196 ( resp .",
    "@xmath197 ) . clearly @xmath186 and @xmath185 is sequentially separated .",
    "a subset @xmath74 of @xmath198 is _ linear _ if it has the form @xmath199 where the @xmath200 and @xmath201 are elements of @xmath19 and @xmath202 is a finite set .",
    "it is _ semi - linear _ if it is a finite union of linear sets .    the class of _",
    "@xmath88-rational _ languages of @xmath198 is the smallest containing the empty set , @xmath21 , and closed under finite union , parallel product @xmath88 , and finite parallel iteration @xmath203 .",
    "we refer to  @xcite for a proof of the following result :    [ th : ratsemlin ] let @xmath19 be an alphabet and @xmath204",
    ". then @xmath74 is @xmath88-rational if and only if it is semi - linear .",
    "furthermore , the construction from one formalism to the other is effective .    [ prop : parallelrational ] let @xmath19 be an alphabet and @xmath74 be a rational language of @xmath55 .",
    "then @xmath204 if and only if @xmath74 is @xmath88-rational .",
    "the inclusion from right to left follows immediately from the definition .",
    "let us turn to the inclusion from left to right .",
    "there exists an automaton @xmath187 such that @xmath156 . for each pair @xmath184 of states of @xmath132 define @xmath205 as the set of posets labeling paths from @xmath119 to @xmath120 . as @xmath206 for",
    "all @xmath207 we can assume that @xmath208 for all @xmath207 and @xmath209 .",
    "then @xmath210 the set of all such equalities forms a finite system of equations , which can immediately be re - written as a context - free grammar @xmath211 where the usual concatenation is replaced by @xmath88 , which commutes . by parikh s theorem",
    "( see  @xcite , theorem  2 ) , each @xmath205 is a semi - linear set of @xmath198 with @xmath212 , which can be effectively be computed from @xmath211 . as @xmath213 , and",
    "the class of semi - linear sets is closed under finite union , then @xmath74 is also semi - linear , hence @xmath88-rational by theorem  [ th : ratsemlin ] .",
    "the definitions of linearity , semi - linearity , rationality and @xmath88-rationality , which are given above over free algebras , can naturally be generalized over ( non - free ) algebras .",
    "the first result of this paper is stated by the following theorem which claims , together with proposition  [ prop : union ] , that the class of rational languages of n - free posets is closed under boolean operations .",
    "[ th : complement ] let @xmath19 be an alphabet . the class of rational languages of @xmath55 is effectively closed under complement .    the proof of theorem  [ th : complement ] relies on the closure under complementation of the class of @xmath88-rational languages of commutative monoids ( theorem  [ th : schutz ] ) .",
    "[ th : schutz ] if @xmath64 and @xmath214 are @xmath88-rational subsets of a commutative monoid @xmath215 , then @xmath216 and @xmath217 are also @xmath88-rational subsets of  @xmath215 .    as emphasized in  @xcite ,",
    "if @xmath215 is finitely generated then theorem  [ th : schutz ] is effective .",
    "theorem  [ th : schutz ] was first proved by ginsburg and spanier  @xcite in the case of finitely generated free commutative monoids .",
    "the following proposition is a corollary of theorem  [ th : schutz ] :    [ prop : morphinv ] if @xmath218 is a morphism of commutative monoids , @xmath219 is finitely generated and @xmath64 is a @xmath88-rational subset of @xmath215 , then @xmath220 is a @xmath88-rational subset of  @xmath219 .    before going into the details we need to introduce the necessary notions on algebras for languages of n - free posets . for the basic notions on algebra we refer to  @xcite .",
    "sp - algebra _ @xmath221 consists of a set @xmath222 equipped with two operations @xmath86 and @xmath88 , respectively called _ sequential _ and _ parallel product _ , such that @xmath223 is a semigroup ( @xmath86 is associative ) and @xmath224 is a commutative semigroup . observe that the notion of an sp - algebra equipped with a _",
    "neutral element _ 1 ( verifying @xmath225 for any element @xmath226 of the sp - algebra ) corresponds to bimonoid in  @xcite . for each alphabet",
    "@xmath19 there exists a free sp - algebra which is isomorphic to @xmath52 ( and which is also denoted by @xmath52 ) . for simplicity",
    "we often denote an sp - algebra @xmath221 by @xmath222 .",
    "a morphism @xmath227 between two sp - algebras _ recognizes _",
    "@xmath228 if @xmath229 for some @xmath230 .",
    "sometimes the reference to @xmath231 is omitted and we say that @xmath232 recognizes @xmath64 .",
    "the following propositions are easy generalizations of well - known results on semigroups ( see  ( * ? ? ?",
    "1.8 and 1.9 ) for the semigroup versions ) .",
    "if @xmath233 is a map from an alphabet @xmath19 to an sp - algebra @xmath222 , there exists a unique morphism @xmath234 such that @xmath235 for all @xmath79 .",
    "furthermore , @xmath236 is surjective iff @xmath237 is a generator of @xmath222 .",
    "let @xmath19 be an alphabet , @xmath238 and @xmath239 two morphisms of sp - algebras , with @xmath240 surjective .",
    "there exists a morphism @xmath241 such that @xmath242 .",
    "furthermore , @xmath243 recognizes any @xmath167 recognized by @xmath231 .",
    "a subset @xmath64 of an sp - algebra @xmath222 is _ recognizable _ if there exists a _",
    "finite _ sp - algebra @xmath232 and a morphism @xmath227 such that @xmath231 recognizes @xmath64 .",
    "a _ congruence _",
    "@xmath244 of sp - algebras is an equivalence relation compatible with the operations , ie .",
    "@xmath245 implies that @xmath246 and @xmath247 for all @xmath248 . actually , as the parallel product commutes in sp - algebras , the condition  ( 2 ) is equivalent to @xmath249 for all @xmath250 . an equivalence relation has _ finite index _ if it has a finite number of equivalence classes .",
    "it is well - known that the map @xmath251 which associates to any element of @xmath222 its equivalence class in the quotient sp - algebra @xmath252 can be extended in a unique way into a morphism of sp - algebras .",
    "let @xmath64 be a set whose elements are called _ variables _ and @xmath222 be an sp - algebra .",
    "a _ term _ on @xmath222 is a full binary tree whose leafs are either variables or elements of @xmath222 , and nodes are a sequential or a parallel product . formally , the set @xmath253 of terms on @xmath222 is defined inductively by @xmath254 , each element of @xmath222 is in @xmath253 and , for all @xmath255 , @xmath256 and @xmath257 .",
    "observe that a n - free poset labeled by @xmath19 can be thought of as a term of @xmath19 ( which may not be unique ) without variables , and reciprocally ( note that a term corresponds to a unique n - free poset ) .",
    "a value can be associated to any term @xmath134 whose leaves are all elements of @xmath222 by the partial function @xmath258 inductively defined by @xmath259 for all @xmath260 , @xmath261 and @xmath262 .",
    "let @xmath263 .",
    "the _ syntactic congruence _",
    "@xmath264 of @xmath74 on @xmath222 is defined by : for all @xmath265 , @xmath266 if , for any term @xmath267 on @xmath222 and any @xmath268 , @xmath269 it is well - known that the quotient sp - algebra @xmath270 recognizes @xmath74 .",
    "furthermore , the following property holds on @xmath270 :    [ prop : synt ] let @xmath222 and @xmath232 be two sp - algebras , @xmath263 and @xmath227 be an onto morphism",
    ". then @xmath271 if and only if , for any @xmath265 , @xmath272 implies @xmath266 .",
    "[ ex : abcalgebra ] let @xmath94 and @xmath95 be the language of example  [ ex : abc ] .",
    "let @xmath221 be the sp - algebra defined by @xmath273 , @xmath274 , @xmath275 , @xmath158 is the neutral element for both sequential and parallel products , and all other products are mapped to @xmath276",
    ". then @xmath222 recognizes @xmath74 .",
    "indeed , let @xmath277 be the morphism defined by @xmath278 , @xmath279 and @xmath280 . then @xmath281 and @xmath282 .",
    "furthermore @xmath283 .",
    "lodaya and weil have proved the following connection between recognizable and rational languages :    [ th : recrat ] recognizable languages are rational .",
    "however , the following example ( from  @xcite ) shows that in general , rational languages are not recognizable .",
    "[ ex : anbnalgebra ] let @xmath157 and @xmath284 .",
    "let @xmath285 the morphism defined by @xmath286 , @xmath287 , @xmath288 for all @xmath289 .",
    "then @xmath290 , and thus @xmath231 recognizes @xmath74 .",
    "furthermore , @xmath291 is isomorphic to @xmath292 , thus @xmath74 is not recognizable as a consequence of proposition  [ prop : synt ] .",
    "example  [ ex : anbnauto ] gives an automaton @xmath132 with @xmath179 .",
    "let us return to the proof of theorem  [ th : complement ] .",
    "the first step is the construction of an algebra from an automaton .",
    "we need to introduce some new definitions , which are applied in example  [ ex : complement ] at the end of this section .",
    "let @xmath167 and @xmath187 be an automaton such that @xmath179 .    for every pair @xmath184 of states , define @xmath293 to be the set of multi - sets of pair of states as follows : @xmath294\\ } $ $ \\end{gathered}\\ ] ]",
    "define also @xmath295 to be the smallest set of multi - sets of pairs of states as follows .",
    "let @xmath296 and @xmath297 , k_j>0 , x\\in k_{(p_j , q_j ) } \\}\\end{gathered}\\ ] ] now let @xmath298 .",
    "observe that @xmath299 . if @xmath300 is a n - free poset",
    "such that there exists a path @xmath301 which is the parallel composition of @xmath302 paths @xmath303 , for some @xmath304 , @xmath305 , @xmath63 $ ] , observe that by construction the multi - set @xmath306 belongs to @xmath295 .",
    "reciprocally , if @xmath307 , there exist paths @xmath308 for some @xmath305 for all @xmath63 $ ] , that can be composed to build a path @xmath309 .",
    "let @xmath3 , @xmath202 be sets , @xmath310 and @xmath214 be respectively a set of multi - sets of elements of @xmath3 and a multi - set of elements of @xmath3 .",
    "set @xmath311    when @xmath131 , define @xmath312\\ } : \\\\ p = p_1\\parallel\\dots\\parallel p_n , p_i\\in sp^+(a)\\text { for all } i\\in[n]\\}\\end{gathered}\\ ] ] thus @xmath313 is the set of all finite multi - sets @xmath306 over @xmath314 such that @xmath300 and , for all @xmath63 $ ] , @xmath305 and @xmath315 .",
    "let @xmath316 be the relation defined on @xmath55 by @xmath317 if and only if , for all @xmath209 , @xmath318 equivalently , @xmath317 if and only if , for all multi - sets @xmath215 over @xmath314 , there is some @xmath319 such that @xmath320 if and only if there is some @xmath321 such that @xmath322 .",
    "obviously , @xmath316 is an equivalence relation .",
    "also , for all @xmath209 , @xmath131 , we have @xmath323 if and only if @xmath324 . immediately ,    [ lem : congchemin ] if @xmath325 then @xmath324 iff @xmath326 for all @xmath209 .    the following lemma shows in particular that @xmath327 is equipped with a structure of sp - algebra .",
    "[ lem : cong ] @xmath316 is a congruence of sp - algebra .",
    "first we prove that if @xmath317 then @xmath328 for all @xmath329 .",
    "let @xmath330 . if @xmath331 the conclusion is trivially reached",
    ". otherwise , @xmath332 is a sequential poset of @xmath55 .",
    "assume @xmath333 .",
    "by definition of @xmath334 , there exists a path @xmath335 such that @xmath336 . by definition of @xmath295",
    "there exists a path @xmath337 for some @xmath338 and for all @xmath339 $ ] , and the paths @xmath340}$ ] and @xmath335 can be used to compose a path @xmath341 .",
    "the path @xmath335 can be decomposed into @xmath342 for some @xmath343 . as @xmath317 by lemma  [ lem : congchemin ] we also have @xmath344 , thus there exists @xmath345 , which can be used in parallel with the paths @xmath340}$ ] to build a path @xmath346 .",
    "thus , @xmath347 .",
    "we now show that if @xmath317 then @xmath348 for all @xmath349 .",
    "the case @xmath350 is a triviality , so we assume that @xmath351 .",
    "let @xmath352 .",
    "there exist a decomposition @xmath353 of @xmath354 , @xmath355}$ ] , @xmath338 for all @xmath339 $ ] , paths @xmath356}$ ] and @xmath357}$ ] , that can be composed to form a path @xmath358 .",
    "if @xmath359 is not a maximal parallel factorization of @xmath354 then the paths @xmath356}$ ] can be replaced by @xmath360}$ ] where @xmath361 is a maximal parallel factorization of @xmath354 , such that the paths @xmath360}$ ] and the paths @xmath357}$ ] can be composed to form a path @xmath362 . since @xmath361 is a maximal parallel factorization of @xmath354 there exists a partition @xmath363 of @xmath364 $ ] such that @xmath365 and @xmath366 .",
    "as @xmath317 we have @xmath367\\}\\in ( { \\ensuremath{\\mathcal{f}_{p , q}\\backslash\\kern-3pt\\backslash\\{(p'_i , q'_i):i\\in i\\}}})\\cap ( { \\ensuremath{\\mathcal{f}_{p , q}\\backslash\\kern-3pt\\backslashx}})\\ ] ] for some @xmath368 , so @xmath369 , ie .",
    "@xmath370 with @xmath371 .",
    "so @xmath316 is a congruence of sp - algebra .",
    "let @xmath372 the morphism which associates to each poset @xmath131 its equivalence class in @xmath327 .",
    "then @xmath373 recognized @xmath74 , since @xmath374 where @xmath375 observe that @xmath64 may be infinite .",
    "let @xmath132 be the automaton of example  [ ex : abcauto ] .",
    "then @xmath376 is isomorphic to @xmath377 ( see example  [ ex : abcalgebra ] for @xmath377 ) .    observe that @xmath316 may have an infinite index ( take , for example , any automaton of language @xmath378 - see example  [ ex : anbnauto ] ) .",
    "[ lem : finiteindex ] the number of equivalence classes for @xmath316 containing a sequential poset ( of @xmath55 ) is finite .    by contradiction , assume that there exists an infinite sequence @xmath379 of sequential posets such that for all @xmath380 , if @xmath381 then @xmath382 . to each equivalence class @xmath383_{\\sim_\\mathcal{a}}$ ] we associate the set @xmath384 .",
    "clearly there exist a finite number of such sets , so there exist @xmath385 , with @xmath381 such that @xmath386 . for all @xmath209 , @xmath387 , let @xmath388 . as @xmath382 there exist @xmath209 and wlog .",
    "@xmath389 . as @xmath390 there exist paths @xmath337 for some @xmath338 and for all @xmath63 $ ] , and @xmath391 , such that the paths @xmath392}$ ] and @xmath118 can be used to compose a path @xmath393 . in @xmath394 ,",
    "@xmath118 can be replaced by @xmath395 to form a path @xmath396 .",
    "thus @xmath397 , which is a contradiction .",
    "let @xmath398 .",
    "we denote the set of _ sequential posets _ of @xmath64 by @xmath399 denote also by @xmath205 the set of non - empty labels of paths from state @xmath119 to state @xmath120 in @xmath132 .",
    "we are now going to prove that @xmath400 is a @xmath88-rational language of @xmath401 .",
    "if @xmath316 has a finite index this is a triviality , so assume that it has an infinite number of equivalence classes , and recall that @xmath402 is finite by lemma  [ lem : finiteindex ] .",
    "we have @xmath403 so , it suffices to show that @xmath295 is a @xmath88-rational set of @xmath404 in order to prove that @xmath405 is a @xmath88-rational set of elements of @xmath406 , and thus so is @xmath407 .",
    "[ lem : fqpparallelrat ] @xmath295 is a @xmath88-rational set of @xmath404 .",
    "first observe that @xmath299 .",
    "build an automaton @xmath185 whose alphabet is @xmath408 as follows . take two copies @xmath409 and @xmath410 of the states of @xmath132 .",
    "for each fork transition @xmath411 of @xmath132 , add the same fork transition in @xmath412 .",
    "for each join transition @xmath413 of @xmath132 , add the same join transition in @xmath414 .",
    "for each pair of states @xmath415 such that there is a non - empty path from @xmath334 to @xmath154 in @xmath132 , add a sequential transition from @xmath334 in @xmath412 to @xmath154 in @xmath414 , labeled by @xmath415 .",
    "the initial state is @xmath119 in @xmath412 and the final state is @xmath120 in @xmath414 .",
    "the language of @xmath185 is @xmath295 .",
    "there is no path in @xmath185 with a sequential transition or a join transition followed by a sequential transition or by a fork transition . as a consequence of theorem  [ th : kleenebranching ] and proposition  [ prop : parallelrational ]",
    ", @xmath416 is @xmath88-rational .",
    "observe that the construction given in the proof of lemma  [ lem : fqpparallelrat ] is effective as a consequence of proposition  [ prop : findpath ] .",
    "define the equivalence relation @xmath417 over the elements of @xmath55 by @xmath418 iff @xmath419 , or equivalently @xmath418 iff @xmath420 .",
    "note that @xmath417 has finite index , since @xmath314 is finite .",
    "when @xmath421 , denote by @xmath422 .",
    "[ lem : equivemptyreclpq ] let @xmath238 be a morphism of sp - algebras .",
    "the following conditions are equivalent :    1 .",
    "@xmath418 for all @xmath423 , @xmath260 ; 2 .",
    "@xmath231 recognizes @xmath205 for all @xmath424 .",
    "if  ( 1 ) is true then @xmath231 recognizes @xmath205 for all @xmath424 since @xmath425 conversely assume  ( 2 ) and , by contradiction , that  ( 1 ) is false , ie .",
    "there exist @xmath260 , @xmath423 such that @xmath426 , @xmath427 with @xmath428",
    ". then @xmath231 can not recognize @xmath205 with @xmath429 and @xmath430 , or the converse .",
    "let @xmath238 be a morphism of sp - algebras such that @xmath418 for all @xmath423 , @xmath260 .",
    "we define the equivalence relation @xmath431 over the elements of @xmath222 by @xmath432 iff there exist @xmath433 , @xmath434 such that @xmath418 .",
    "we have @xmath418 iff @xmath435 .",
    "if @xmath231 is surjective then @xmath436 has finite index , and each equivalence class of @xmath437 can be denoted @xmath438 for some @xmath421 . furthermore , @xmath439 and @xmath440 .",
    "[ lem : simemptyparallelrational ] let @xmath238 be a surjective morphism of sp - algebras such that    * @xmath231 recognizes @xmath205 for all @xmath424 , * @xmath441 is a @xmath88-rational of @xmath222 for all @xmath424 .",
    "each equivalence class @xmath442 of @xmath437 is a @xmath88-rational set of @xmath222 .",
    "we have @xmath443 ; as @xmath441 is @xmath88-rational and @xmath231 recognizes @xmath205 for all @xmath424 , and as by theorem  [ th : schutz ] the class of @xmath88-rational sets is closed under finite boolean operations , @xmath444 is @xmath88-rational .",
    "it is clear that the morphism of sp - algebras @xmath372 verifies the conditions of lemma  [ lem : simemptyparallelrational ] .",
    "when @xmath222 is an sp - algebra , define also the equivalence relation @xmath445 on the elements of @xmath222 by @xmath446 iff @xmath447 and @xmath448 for all @xmath449 .",
    "the relation between @xmath450 and @xmath451 is given by the following lemma :    [ lem : simemptyimpliquesimseq ] if @xmath452 then @xmath453 .",
    "let @xmath454 and @xmath455 .",
    "we have @xmath418 , then @xmath456 iff @xmath457 for all @xmath209 , thus @xmath458 iff @xmath459 , for all @xmath460 , @xmath209 .",
    "it follows that @xmath461 , and thus @xmath462 , ie .",
    "@xmath463 for all @xmath460 . as @xmath464 is surjective",
    ", it follows that @xmath465 ( and , using symmetrical arguments , @xmath466 ) for all @xmath449 , thus @xmath467 .",
    "[ lem : equivseq ] @xmath468 has finite index , and each of its equivalence classes is a @xmath88-rational set of @xmath376 .    as @xmath417 has finite index , then",
    "so is @xmath469 , and thus @xmath451 as a consequence of lemma  [ lem : simemptyimpliquesimseq ] .",
    "each equivalence class of @xmath451 is a finite union of equivalence classes of @xmath469 .",
    "as the class of @xmath88-rational sets is closed under finite union , it follows from lemma  [ lem : simemptyparallelrational ] that each equivalence class of @xmath451 is @xmath88-rational .",
    "we have @xmath470 .",
    "since the class of rational sets of @xmath55 is closed under finite union , it suffices to show that @xmath471 is a rational set of @xmath55 for each @xmath421 in order to show that @xmath472 is a rational set of @xmath55 .",
    "this will be achieved by lemma  [ lem : revimagevarphiclasse ] below .",
    "we need to introduce the notion of _ @xmath88-quotient _ of a language .",
    "let @xmath473 .",
    "the _ @xmath88-quotient _ of @xmath82 by @xmath74 is @xmath474    [ lem : quotientsemilinear ] let @xmath19 be an alphabet , and @xmath64 , @xmath214 be two @xmath88-rational languages of @xmath198 .",
    "then @xmath475 is @xmath88-rational .    by theorem",
    "[ th : ratsemlin ] , @xmath64 and @xmath214 are semi - linear . by theorem",
    "[ th : presburgersemilinear ] , @xmath64 and @xmath214 are also presburger sets of some formul  @xmath476 and @xmath477 . up to a change in variables names we can assume that the free variables of both formul  are disjoint .",
    "then @xmath475 is the presburger set of @xmath478}z_i+x_i = y_i\\ ] ] using theorems  [ th : presburgersemilinear ] and  [ th : ratsemlin ] again , @xmath475 is @xmath88-rational .",
    "[ lem : revimagerateltfinite ] let @xmath277 be a morphism of sp - algebras . if @xmath222 is finite , then @xmath479 is a regular set of @xmath55 , for all @xmath260 .",
    "we build an automaton @xmath480 such that @xmath481 .",
    "the construction is a generalization of the well - know construction from finite semigroups to automata for finite words .",
    "consider all the elements of @xmath222 as the states of @xmath480 , with one new state @xmath158 .",
    "the unique initial state is @xmath158 , the unique final state is @xmath154 .",
    "furthermore , in the following , @xmath158 is considered as a neutral element for both sequential and parallel product regarding the definition of transitions the sequential transitions are as usual : for each state @xmath134 and letter @xmath135 , add a sequential transition from @xmath154 to @xmath482 .",
    "let us deal now with the parallel product . for each @xmath483",
    ", add two new states @xmath484 and @xmath485 , a new letter @xmath486 in the alphabet of @xmath480 , and a sequential transition @xmath487 .",
    "we name the states of the form @xmath484 and @xmath485 _ special states _ , and the new letters of the form @xmath486 _ special letters_. for each @xmath483 , add a fork transition @xmath488 . for each @xmath489 , add a join transition @xmath490 .",
    "let @xmath68 be the set of special letters . consider the projection @xmath491 which removes special letters from posets .",
    "we have @xmath492 .",
    "we now have to show that @xmath493 is rational ( note that in general , projection does not preserve rationality ) .",
    "this is achieved by replacing , in the system of equations in the mcnaughton - yamada - like construction of a rational expression from an automaton ( see  ( * ? ? ?",
    "* section  4.2 ) ) , the equations of the form @xmath494 , whose solution is @xmath205 , by @xmath495 : those replacements do not affect the form of the system , whose solution remains rational .",
    "lemma  [ lem : revimagerateltfinite ] proves that @xmath496 is regular , for all @xmath497 , when @xmath327 is finite .",
    "we are now going to prove that @xmath471 is regular for every equivalence class @xmath498 of @xmath450 , even when @xmath327 is not finite .",
    "the idea is to build an automaton @xmath499 as in the proof of lemma  [ lem : revimagerateltfinite ] , by showing that a finite subset of @xmath327 can be used for the states of @xmath499 .",
    "actually we prove this by translating the problem into an sp - algebra @xmath500 with more properties than @xmath327 .",
    "very informally speaking , denote by @xmath501 the set of equivalence classes of @xmath502 containing a sequential poset of @xmath55 ( which is finite by lemma  [ lem : finiteindex ] ) .",
    "for every @xmath131 whose maximal parallel factorization is @xmath300 , the morphism @xmath503 enables the count of @xmath504 , @xmath63 $ ] , such that @xmath505 , for every @xmath506 $ ] .",
    "also , every language recognized by @xmath327 is recognized by @xmath500 .",
    "let @xmath507 .",
    "then @xmath211 is a ( finite , by lemma  [ lem : finiteindex ] ) generator of @xmath508 .",
    "we may suppose , by proposition  [ prop : seqsepauto ] , that @xmath132 is sequentially separated .",
    "thus that the elements of @xmath211 are indecomposable with respect to the parallel product , that is to say , each @xmath509 can not be written @xmath510 with @xmath511 .",
    "denote by @xmath512 the commutative semigroup whose elements are @xmath12-tuples of non - negative integers , without @xmath513 .",
    "it is generated by the @xmath12-tuples with all components set to 0 , except one which is set to 1 .",
    "for short we denote by @xmath514 the element of the generator of @xmath500 with the @xmath515 component set to  1 .",
    "the parallel product @xmath516 of @xmath512 is the sum componentwise .",
    "we define a morphism of commutative semigroups @xmath517 by @xmath518 for all @xmath339 $ ] .",
    "note that @xmath240 is surjective , and that @xmath519 for all @xmath339 $ ] . as",
    "a consequence @xmath520 is a singleton for all @xmath521 .",
    "now we equip @xmath512 with a sequential product , by setting , for all @xmath522 , @xmath523 .",
    "this sequential product equips @xmath500 with a structure of semigroup since @xmath524 , considering @xmath525 for all @xmath526 $ ] .",
    "thus , @xmath500 equipped with its parallel and sequential products is an sp - algebra .",
    "observe that @xmath527 .",
    "now , we define a morphism of sp - algebras @xmath528 by @xmath529 for all @xmath79 .",
    "the diagram of figure  [ fig : diagram ] sums up the situation .",
    "sp^+(a ) & ^_~ _ & sp^+(a)/~ _ + ^ & ^ & + ^k * & &    [ lem : phimupsi ] for all @xmath497 , @xmath530 .",
    "we show by induction on @xmath131 that if @xmath15 belongs to one side of the equality then it also belongs to the other .",
    "let @xmath531 . if @xmath532 ( thus @xmath533 ) , by definition @xmath534 . if @xmath535 then @xmath536 .",
    "assume now that @xmath15 has the form @xmath58 for some @xmath537 . if @xmath532 then @xmath538 .",
    "denote by @xmath539 , @xmath540 $ ] . by induction hypothesis @xmath541 .",
    "thus @xmath542 . on the other side ,",
    "if @xmath543 , it follows from the induction hypothesis that @xmath544 , @xmath540 $ ] . as @xmath545 , we have @xmath546 , thus @xmath547 and thus @xmath532 .",
    "finally assume that @xmath15 has the form @xmath548 for some @xmath537 . if @xmath532 we proceed as in the case @xmath58 , observing that @xmath549 if @xmath550 : if @xmath551 , @xmath540 $ ] , then by definition @xmath552 . on the other side ,",
    "if @xmath543 , it follows from the induction hypothesis that @xmath544 , @xmath540 $ ] .",
    "we have @xmath553 , so @xmath550 . as @xmath554 .",
    "[ lem : musurj ] @xmath243 is a surjective morphism of sp - algebras .",
    "let @xmath555 . if @xmath556 for some @xmath339 $ ] then @xmath557 .",
    "as @xmath558 is surjective there exists @xmath559 , thus @xmath560 .",
    "otherwise , @xmath561 for some @xmath562 and @xmath563 $ ] .",
    "as for all @xmath564 $ ] , @xmath565 , there is some @xmath566 , and @xmath567 .",
    "[ lem : muok ] @xmath243 verifies the conditions of lemma  [ lem : simemptyparallelrational ] .",
    "first , @xmath243 is surjective by lemma  [ lem : musurj ] .",
    "that @xmath243 recognizes @xmath205 for all @xmath424 is a consequence of lemma  [ lem : phimupsi ] . because @xmath568 , and as @xmath569 is finite , then @xmath570 is a @xmath88-rational set of @xmath500 .",
    "it follows from lemmas  [ lem : phimupsi ] and  [ lem : equivemptyreclpq ] that the equivalence relation @xmath571 can be defined over the elements of @xmath500 .",
    "furthermore , recall that @xmath243 is surjective by lemma  [ lem : musurj ] . as a consequence of lemmas  [ lem : phimupsi ] , [ lem : muok ] and  [ lem : simemptyparallelrational ] ,",
    "each of the equivalence class @xmath572 of @xmath571 is a @xmath88-rational of @xmath500 , and thus , by theorem  [ th : ratsemlin ] , has the form @xmath573 for some finite set @xmath574 , @xmath575 , @xmath576 some finite part of @xmath500 . for all @xmath577 set @xmath578 .",
    "we may assume that all the @xmath579 are pairwise disjoint  ( * ? ? ?",
    "* theorem  iv ) .",
    "note that the decomposition of @xmath572 into @xmath580 is not unique .",
    "this decomposition may influence the constructions below , but not the main result ( lemma  [ lem : revimagevarphiclasse ] ) .",
    "the following lemma links the equivalence classes of @xmath450 and @xmath571 .    for all @xmath522 , @xmath581 iff @xmath582 .",
    "assume first there exist @xmath583 , @xmath584 with @xmath585 . as a consequence of lemma  [ lem : phimupsi ] we have @xmath586 for all",
    "@xmath540 $ ] , thus @xmath587 .",
    "assume now , for the inclusion from right to left , that there exist @xmath588 for all @xmath540 $ ] , with @xmath585 , but @xmath589 for all @xmath590 , @xmath591 .",
    "as a consequence of lemma  [ lem : phimupsi ] we have , for all @xmath540 $ ] , @xmath592 , thus @xmath593 and thus @xmath594 . as @xmath595",
    "we have @xmath596 , which is a contradiction .",
    "[ lem : pdtseqeq ] for all @xmath597 , if @xmath598 then @xmath599 .",
    "we first show @xmath600 and @xmath601 .",
    "indeed , let @xmath602 such that @xmath603 , @xmath604 and @xmath605 .",
    "if @xmath606 then for all @xmath424 , @xmath15 is the label of a path from @xmath119 to @xmath120 in @xmath132 iff so is @xmath607 . as a consequence , for all @xmath424 , @xmath608 is the label of a path from @xmath119 to @xmath120 in @xmath132 iff so is @xmath609 .",
    "thus @xmath610 .",
    "this implies @xmath611 , thus @xmath600 .",
    "now , by definition @xmath612 , thus @xmath613 for some @xmath509 , thus @xmath614 . we show that @xmath615 using symmetrical arguments .",
    "[ lem : revimagemuratelt ] for all @xmath555 , @xmath616 is a regular set of @xmath55 .",
    "the construction given in the proof of lemma  [ lem : revimagemuratelt ] below is illustrated by example  [ ex : complement ] located at the end of this section .",
    "the lemma is achieved by constructing an automaton @xmath617 from @xmath500 .",
    "take @xmath618 an element of @xmath500 which is greater than @xmath2 and all @xmath619 , for all @xmath620 , @xmath577 , @xmath421 .",
    "the finite set @xmath222 of states of @xmath617 consists in    * @xmath621 ; * for each @xmath622 , a new state @xmath623 ( set @xmath624 ) ; * for each element @xmath625 , two additional special states @xmath626 and @xmath627 ( set @xmath628 , x\\in s_1\\cup s_2\\}$ ] ) and a new letter @xmath629 .    for uniformity with the construction given in the proof of lemma  [ lem : revimagerateltfinite ] , we denote by @xmath630 .",
    "we have @xmath631 . for all @xmath632 , @xmath633 , @xmath634 , define @xmath635 such that @xmath158 is a neutral element for @xmath636 , @xmath637 , @xmath638 , @xmath639 .",
    "note that @xmath640 iff one of @xmath641 belongs to @xmath642 and the other is  @xmath158 .",
    "it is just verification to check that @xmath636 is associative , as a consequence of the associativity of  @xmath86 .",
    "the sequential and fork transitions whose source belongs to @xmath643 are defined as in the construction in the proof of lemma  [ lem : revimagerateltfinite ] , by replacing the sequential product of @xmath327 by @xmath636 . for all @xmath644 ,",
    "add a sequential transition @xmath645 .",
    "define also @xmath646 where @xmath647 is given by , for all @xmath648 , @xmath649 the join transitions are defined as follows . for",
    "each @xmath650 , @xmath651 , add a join transition @xmath652 if @xmath653 is defined .",
    "the unique initial state of @xmath617 is @xmath158 , and its unique final state is @xmath2 .",
    "from now we slightly change our notation for simplicity : we denote by @xmath654 the existence of a poset @xmath655 such that @xmath656 ( @xmath119 is defined as in the proof of lemma  [ lem : revimagerateltfinite ] ) and of path in @xmath617 from @xmath657 to @xmath226 labeled by @xmath607 .",
    "we claim that , for all @xmath131 , @xmath658 , @xmath654 iff @xmath659 .",
    "first , the implication from left to right .",
    "we proceed by induction on @xmath15 . if @xmath531 then necessarily @xmath660 . by construction",
    "there is a sequential transition labeled by @xmath135 from @xmath657 to @xmath226 iff @xmath661 .",
    "assume now @xmath548 for some @xmath537 .",
    "a path @xmath662 can be decomposed into @xmath663 , and by induction hypothesis we have @xmath664 , thus @xmath665 with the help of the associativity of @xmath636 . as a consequence of lemma  [ lem : pdtseqeq ] and by definition of @xmath394 , we have @xmath666 for all @xmath667 , thus @xmath668 since @xmath669 because @xmath670 has the form @xmath514 for some @xmath339 $ ] .",
    "finally assume @xmath58 for some @xmath537 . if there is a path @xmath662 , then by construction and with the help of the induction hypothesis it has the form @xmath671 where @xmath672 for all @xmath540 $ ] , and for some @xmath673 such that @xmath674 , and @xmath675 is the path consisting of the sequential transition @xmath676 . by definition of the join transitions we have @xmath677 .",
    "thus @xmath678 is defined and we have three cases . in the first case @xmath679 and we have @xmath680 . up to a symmetry , the second and third cases are similar , so assume wlog .",
    "we are in the second case : @xmath681 with @xmath682 and @xmath683 .",
    "necessarily @xmath684 for some @xmath685 , @xmath686 for all @xmath564 $ ] , and @xmath687 for some @xmath688 .",
    "thus @xmath689 and @xmath690 .",
    "let us turn now to the implication from right to left .",
    "the cases @xmath691 and @xmath548 for some @xmath537 are as above , so assume @xmath58 . up to a parallel refactorization of @xmath15",
    "we may assume , if @xmath690 for some @xmath623 , that @xmath692 for some @xmath685 , @xmath686 for all @xmath564 $ ] , and @xmath693 for some @xmath688 .",
    "so assume first @xmath690 : either @xmath694 , or @xmath695 and @xmath696 .",
    "in the first case , for all @xmath540 $ ] , @xmath697 , and by induction hypothesis there is a path @xmath698 . by construction",
    "there is a fork transition @xmath699 , a sequential transition @xmath700 and a join transition @xmath701 with @xmath702 , thus @xmath703 forms a path @xmath704 . in the second case , by induction hypothesis there",
    "exist a path @xmath705 and a path @xmath706 . by construction",
    "there is a fork transition @xmath699 , a sequential transition @xmath700 and a join transition @xmath707 that can be used to form a path @xmath704 because @xmath708 .",
    "finally the case @xmath709 is identical to the case @xmath690 with @xmath694 .",
    "[ lem : revimagemuratdelta ] for all @xmath421 , @xmath577 , @xmath710 is a regular set of @xmath55 .",
    "the construction is almost the same as in the proof of lemma  [ lem : revimagemuratelt ] .",
    "we only change @xmath618 to be greater than all @xmath619 , for all @xmath620 , @xmath577 , @xmath421 , without considering @xmath2 , and the final states are @xmath623 , and all states belonging to @xmath711 .",
    "[ lem : revimagevarphiclasse ] for all @xmath421 , @xmath471 is a regular set of @xmath55 .",
    "similarly , for each equivalence class @xmath96 of @xmath451 , @xmath712 is a regular set of @xmath55 .    by lemmas  [ lem : muok ] and  [ lem : equivemptyreclpq ] , @xmath713 .",
    "because @xmath714 , with @xmath574 finite , and regular sets are closed under finite union , it follows from lemma  [ lem : revimagemuratdelta ] that @xmath471 is a regular set of @xmath55 . as by lemma  [ lem : simemptyimpliquesimseq ]",
    "an equivalence class @xmath96 of @xmath451 is a finite union of equivalence classes of @xmath450 , @xmath712 is also a regular set of @xmath55 .",
    "we now give an example illustrating the construction given in the proof of lemma  [ lem : revimagemuratelt ] .",
    "[ ex : complement ] we consider the rational language @xmath715 of @xmath55 with @xmath716 , and the automaton @xmath132 pictured in figure  [ fig : excomplement ] which verifies @xmath179 .",
    "( 1)(-10,-12)@xmath158(1 ) ( 2)(0,-8)@xmath159 ( 3)(0,-16)@xmath174 ( 4)(20,-8)@xmath176 ( 5)(20,-16)@xmath177 ( 6)(10,-8)@xmath175 ( 7)(30,-12)@xmath717 ( 9)(38,-12 ) ( 8)(50,-12)@xmath718(8 ) ( 2,6)@xmath135 ( 6,4)@xmath135 ( 3,5)@xmath135 ( 1,2 ) ( 1,3 ) ( 9,8)@xmath135 ( 1 ) ( 1 ) ( -6,-10.3)(-5,-12)(-6,-13.7 ) ( -14,-10.5)(-15,-12)(-14,-14 ) ( 4,7 ) ( 5,7 ) ( 7 ) ( 7 ) ( 34,-10.3)(35,-12)(34,-13.7 ) ( 26,-10.5)(25,-12)(26,-14 )    we have @xmath719 as stated in lemma  [ lem : fqpparallelrat ] , @xmath720 is a @xmath88-rational set of @xmath404 , with @xmath25 the set of states of @xmath132 , for all @xmath721 .",
    "for example , @xmath722 .",
    "we now compute @xmath723 .",
    "first observe that ( @xmath724 in the equalities below ) : @xmath725 with @xmath726\\\\      \\mathcal{r}((aa)^{\\parallel k})=&\\{\\{(2,5)^k\\}\\}\\\\      \\mathcal{r}((a\\parallel ( aa))^{\\parallel k})=&\\{\\{(1,7)^k\\}\\ }    \\end{aligned}\\ ] ] as @xmath727 ( take @xmath728 ) then @xmath729 for all @xmath724 . on the other side , as @xmath730 ( resp .",
    "@xmath731 ) , then for all @xmath724 , not @xmath732 for all @xmath724 ( resp . not @xmath733 ) . as @xmath734 and @xmath735 for all @xmath736 with @xmath737 , then @xmath723 has not finite index .",
    "actually @xmath723 is composed of the following equivalence classes ( recall that @xmath372 is the morphism which associates to each poset @xmath131 its equivalence class in @xmath327 ) :    * for all @xmath724 , one class denoted by @xmath738 , such that @xmath739 ; * for all @xmath724 , one class denoted by @xmath740 , such that @xmath741 ; * one class denoted by @xmath742 , such that @xmath743 for all @xmath724 ; * one class denoted by @xmath744 , such that @xmath745 for all @xmath724 ; * one class denoted by @xmath276 , such that @xmath746 for all @xmath131 which are not mentioned above .",
    "the sp - algebra @xmath327 is equipped with the parallel product @xmath88 verifying @xmath747    2    * @xmath748 ; * @xmath749 ; * @xmath750 ; * @xmath751 .    with @xmath742 idempotent , and",
    "the sequential product @xmath86 verifying    2    * @xmath752 ; * @xmath753 .    such that @xmath276 is a zero for both products , and all products undefined above are mapped to @xmath276 .",
    "it recognizes @xmath74 since @xmath754 .",
    "we have @xmath755 , whose cardinality is 4 .",
    "consider @xmath756 , and define the morphism of commutative semigroups @xmath757 by    2    * @xmath758 ; * @xmath759 ; * @xmath760 ; * @xmath761 .",
    "equip @xmath756 with its sequential product .",
    "we have @xmath762 for all @xmath763 , @xmath764 and all other sequential products are mapped to @xmath765 .",
    "define also the morphism of sp - algebras @xmath766 by @xmath767 for all @xmath79 .",
    "note that @xmath768 and @xmath769 with @xmath770 a @xmath88-rational language of @xmath756 , since @xmath771 where @xmath772 .    set    2    * @xmath773 ; * @xmath774 ; * @xmath775 ; * @xmath776 .",
    "we have    2    * @xmath777 ; * @xmath778 ; * @xmath779 ; * @xmath780 ; * @xmath781 for all @xmath782 ; * @xmath783}\\delta_{d_i}^{\\mathbb{n}^{k*}})$ ] .",
    "now , from any element @xmath784 , say for example @xmath785 , we construct on automaton @xmath786 such that @xmath787 , following the construction of the proof of lemma  [ lem : revimagemuratelt ] .",
    "note that @xmath788 .",
    "the first step of the construction consists in writing all the sets @xmath572 , @xmath421 , as a union of disjoint linear sets of @xmath756 .",
    "this is trivial when @xmath789 is one of @xmath790 , or @xmath782 . for @xmath791",
    ", we have @xmath792 .",
    "this could also easily be done for @xmath793 , but it can be avoided .",
    "indeed , assume that @xmath793 is partitioned into finitely many linear sets : @xmath794 with @xmath795 a finite set .",
    "assume also that @xmath786 has one state @xmath796 for each @xmath797 .",
    "take one of those states @xmath796 .",
    "following the construction of @xmath786 , it can be easily checked that if a path uses one of the states @xmath796 or @xmath765 then it continues either in @xmath796 or in @xmath765 : the final state @xmath154 of @xmath786 is unreachable .",
    "let us then return to the construction of @xmath786 .",
    "choosing @xmath618 as small as possible using the remark above , we have @xmath798 , then @xmath799 , and we can reduce @xmath642 to @xmath800 .",
    "the initial and final states are respectively @xmath158 and @xmath154 .",
    "the ( useful ) sequential transitions are    2    * @xmath801 , * @xmath802 , * @xmath803 for all @xmath804 , * @xmath805 .",
    "the fork transitions are from all state @xmath134 to @xmath806 .",
    "finally , the join transitions are    * @xmath807 when @xmath808 and @xmath809 , * @xmath810 when @xmath811 , * @xmath812 .",
    "figure  [ fig : pathas ] represents a successful path in @xmath786 labeled by @xmath813 .",
    "( 30)(70,20)@xmath158 ( 31)(115,20)@xmath814 ( 30,31)@xmath135 ( 51)(50,-10)@xmath158 ( 52)(60,12.5)@xmath158 ( 53)(70,15)@xmath158 ( 54)(60,2.5)@xmath158 ( 55)(70,10)@xmath158 ( 56)(70,5)@xmath158 ( 57)(70,0)@xmath158 ( 54,56 ) ( 54,57 ) ( 58)(90,10)@xmath814 ( 60)(90,0)@xmath814 ( 61)(130,2.5)@xmath815 ( 62)(130,12.5)@xmath816 ( 63)(90,15)@xmath814 ( 64)(145,-10)@xmath817 ( 65)(115,10)@xmath818 ( 66)(115,5)@xmath814 ( 67)(115,0)@xmath818 ( 68)(115,15)@xmath818 ( 52,53 ) ( 52,55 ) ( 53,63)@xmath135 ( 57,60)@xmath135 ( 55,58)@xmath135 ( 56,66)@xmath135 ( 58,65)@xmath135 ( 60,67)@xmath135 ( 63,68)@xmath135 ( 65,62 ) ( 68,62 ) ( 66,61 ) ( 67,61 ) ( 7)(52.5,-2.5)@xmath158 ( 8)(60,-7.5)@xmath158 ( 9)(70,-5)@xmath158 ( 10)(60,-17.5)@xmath158 ( 7,8 ) ( 7,54 ) ( 11)(70,-10)@xmath158 ( 12)(70,-15)@xmath158 ( 13)(70,-20)@xmath158 ( 10,12 ) ( 10,13 ) ( 15)(90,-15)@xmath814 ( 17)(130,-17.5)@xmath815 ( 18)(130,-7.5)@xmath815 ( 19)(90,-5)@xmath814 ( 20)(140,-2.5)@xmath819 ( 25)(115,-10)@xmath814 ( 26)(115,-15)@xmath818 ( 27)(115,-20)@xmath814 ( 28)(115,-5)@xmath818 ( 18,20 ) ( 8,9 ) ( 8,11 ) ( 9,19)@xmath135 ( 13,27)@xmath135 ( 11,25)@xmath135 ( 12,15)@xmath135 ( 15,26)@xmath135 ( 19,28)@xmath135 ( 25,18 ) ( 28,18 ) ( 26,17 ) ( 27,17 ) ( 51,7 ) ( 51,10 ) ( 71)(45,1.25)@xmath158 ( 71,52 ) ( 71,51 ) ( 72)(40,10)@xmath158 ( 72,30 ) ( 72,71 ) ( 61,20 ) ( 20,64 ) ( 17,64 ) ( 73)(160,-10)@xmath820 ( 64,73)@xmath135 ( 74)(170,1.25)@xmath821 ( 73,74 ) ( 62,74 ) ( 75)(180,10)@xmath154 ( 74,75 ) ( 31,75 )",
    "in this section we define a logical formalism called p - mso , which is a mix between presburger  @xcite and monadic second - order logic , and that has exactly the same expressivity as branching automata .",
    "as all the constructions involved in the proof are effective , then the p - mso theory of the class of finite n - free posets is decidable .",
    "let us recall useful elements of monadic second - order logic , and settle some notation .",
    "for more details about mso logic we refer e.g. to thomas survey paper  @xcite . the monadic second - order ( mso ) logic is classical in set theory , and",
    "was first set up by bchi - elgot - trakhtenbrot for words  @xcite . in our case , the domain of interpretation is the class of finite n - free posets .",
    "monadic second - order logic is an extension of first - order logic that allows to quantify over elements as well as subsets of the domain of the structure .",
    "given a signature @xmath822 , one can define the set of _ mso - formul _",
    "over @xmath823 as well - formed formul  that can use first - order variable symbols @xmath824 interpreted as elements of the domain of the structure , monadic second - order variable symbols @xmath825 interpreted as subsets of the domain , symbols from @xmath823 , and a new unary predicate @xmath826 , also denoted @xmath827 for readability , interpreted as `` the interpretation of @xmath226 belongs to the interpretation of @xmath64 '' .",
    "we call _ sentence _ any formula without free variable . as usual",
    ", we will often confuse logical symbols with their interpretation .",
    "given a signature @xmath823 and an @xmath828structure @xmath215 with domain @xmath789 , we say that a relation @xmath829 is _ mso - definable _ in @xmath215 if and only if there exists an mso - formula over @xmath823 , say @xmath830 , which is true in @xmath215 if and only if @xmath831 is interpreted by an @xmath832-tuple of @xmath833 .    given a finite alphabet @xmath19 , let us consider the signature @xmath834 where @xmath835 is a binary relation symbol and the @xmath836 s are unary predicates ( over first - order variables ) .",
    "one can associate to every poset @xmath837 labeled over @xmath19 the @xmath838structure @xmath839 where @xmath835 is interpreted as the ordering over @xmath15 , and @xmath840 holds if and only if @xmath841 . in order to take into account the case @xmath842 , which leads to the structure @xmath843 which has an empty domain",
    ", we will allow structures to be empty .",
    "given an mso sentence @xmath240 over the signature @xmath844 , we define the language @xmath845 as the class of posets @xmath837 labeled over @xmath19 that satisfy @xmath240 , or , using formal notation , such that @xmath846 .",
    "two formul  @xmath240 and @xmath847 are ( logically ) _ equivalent _ , denoted by @xmath848 , if @xmath849 .",
    "we will say that a language @xmath167 is _ definable in mso logic _ ( or _ mso - definable _ ) if and only if there exists an mso - sentence @xmath240 over the signature @xmath844 such that @xmath850 .    in order to enhance readability of formul",
    "we use several notations and abbreviations for properties expressible in mso .",
    "the shortcut @xmath851 is used instead of @xmath840 .",
    "the following are usual and self - understanding : @xmath852 , @xmath853 , @xmath854 .",
    "an existential ( resp .",
    "universal ) quantification @xmath855 ( resp .",
    "@xmath856 ) is _ relative to @xmath64 _ if @xmath857 ( resp .",
    "@xmath858 ) . relative existential ( resp .",
    "universal ) quantification of @xmath226 over @xmath64 is denoted @xmath859 ( resp .",
    "@xmath860 ) .",
    "the notion of relative quantification naturally extends to second - order variables .",
    "mso logic is strictly less expressive than automata .",
    "there is no mso - formula that defines the language @xmath378 . on the contrary",
    ", mso - definability implies rationality .    in order to capture the expressiveness of automata with logic we need to add presburger expressivity to mso .",
    "presburger logic is the first - order logic over the structure @xmath861 where @xmath862 .",
    "a language @xmath863 is a _",
    "presburger set _ of @xmath864 if @xmath865 for some presburger formula @xmath866 .",
    "if @xmath866 is given then @xmath74 is called the _",
    "presburger set _ of @xmath866 ( or of @xmath231 for short ) .",
    "presburger logic provides tools to manipulate semi - linear sets of @xmath198 with formul .",
    "indeed , let @xmath867 be an alphabet . as a word @xmath250 of @xmath198",
    "can be thought of as a @xmath2-tuple @xmath868 of non - negative integers , where @xmath869 denotes the number of occurrences of letter @xmath135 in @xmath250 , then @xmath198 is isomorphic to @xmath864 .",
    "[ ex : pres1 ] let @xmath94 and @xmath870",
    ". then @xmath74 is isomorphic to @xmath871 , and thus the presburger set of @xmath872    semi - linear sets and presburger sets are connected by the following theorem :    [ th : presburgersemilinear ] let @xmath867 be an alphabet and @xmath204 . then @xmath74 is semi - linear if and only if it is the presburger set of some presburger formula @xmath866 .",
    "furthermore , the construction of one description from the other is effective .",
    "the _ p - mso logic _ is a melt of presburger and mso logics . from the syntactic point of view",
    ", p - mso logic contains mso logic , and in addition formul  of the form @xmath873 where @xmath64 is the name of a new second - order variable , @xmath874 is the name of a ( free ) second - order variable , @xmath875 ( for each @xmath63 $ ] ) a p - mso formula having no free first - order variables , and only quantifications relative to @xmath64 , and @xmath866 a presburger formula with @xmath2 free variables @xmath876 .",
    "as the variable @xmath64 is for the internal use of @xmath877 , then it is bounded by @xmath877 : it is a free variable of all the @xmath875 , @xmath63 $ ] , but it is not a free variable of @xmath878 .",
    "similarly , @xmath876 are free variables of @xmath866 , but they must not be considered as free in @xmath879 .",
    "as in monadic second - order logic , the class of syntactically correct p - mso formul  is closed under boolean operations , and existential and universal quantification over first and second - order variables of a p - mso formula that are interpreted over elements or sets of elements of the domain of the structure",
    ". semantics of p - mso formul  is defined by extension of semantics of presburger and mso logics .",
    "the notions of a language and definability naturally extend from mso to p - mso .",
    "let us turn to the semantics of @xmath873 a _ block _ @xmath68 of a poset @xmath880 is a nonempty subset of @xmath15 such that , if @xmath881 such that @xmath882 , then for all elements of @xmath883 , if @xmath884 then @xmath885 . a subset @xmath211 of @xmath15 is _ good _ if , for all @xmath883 , if @xmath119 is comparable to an element of @xmath211 and incomparable to another , then @xmath886 . a _ connected block _",
    "@xmath887 of a block @xmath64 of a poset is a block such that , for any different and incomparable @xmath888 there exists @xmath889 such that @xmath890 or @xmath891 .    before continuing with formal definitions ,",
    "let us give some intuition on the meaning of @xmath892 .",
    "let @xmath214 be an interpretation of a second - order variable @xmath874 in @xmath15 , such that @xmath214 is a good block of @xmath15 .",
    "that means , @xmath214 is the poset associated with a sub - term of a term on @xmath19 describing @xmath15 , and is the parallel composition of @xmath893 connected blocks : @xmath894 .",
    "take @xmath2 different colors @xmath895 . to each @xmath896",
    "we associate a color @xmath897 with the condition that @xmath896 satisfies @xmath898 .",
    "observe that this coloring may not be unique , and may not exist .",
    "denote by @xmath899 the number of uses of @xmath897 in the coloring of @xmath214 . then @xmath900 if there exists such a coloring with @xmath876 satisfying the presburger condition @xmath866 .",
    "more formally , let @xmath131 , @xmath892 be a p - mso formula , @xmath901 be an interpretation of @xmath874 in @xmath15 such that @xmath214 is a good block of @xmath15 .",
    "then @xmath900 if there exist non negative integers @xmath902 and a partition @xmath903 of @xmath214 into connected blocks @xmath904 such that    * @xmath905 belongs to the presburger set of @xmath866 , * @xmath906 , @xmath907 implies that @xmath908 and @xmath909 are incomparable , for all possible @xmath910 and @xmath911 with @xmath912 , * @xmath913 for all @xmath63 $ ] and @xmath914 $ ] .",
    "[ ex : pmso1 ] let @xmath74 be the language of example  [ ex : pres1 ] , and @xmath915 be the presburger formula of example  [ ex : pres1 ] . for all @xmath916 , set @xmath917 , where @xmath918 is a mso formula ( thus a p - mso formula ) which is true if and only if the interpretation of @xmath64 has cardinality 1 .",
    "then @xmath74 is the language of the following p - mso sentence : @xmath919    [ th : pmsorat ] let @xmath19 be an alphabet , and @xmath167 .",
    "then @xmath74 is rational if and only if is p - mso definable .",
    "furthermore the construction from one formalism to the other is effective .",
    "the remainder of this section is devoted to the proof of theorem  [ th : pmsorat ] .",
    "the inclusion from left to right of theorem  [ th : pmsorat ] relies on the ideas of bchi on words : the encoding of accepting paths of a branching automaton @xmath132 into a p - mso formula .",
    "more precisely , for words this part of the proof consists in mapping each letter of the word to a state of the automaton , consistently with the transitions . in our case",
    ", each letter of the poset is mapped to a sequential transition of @xmath132 , and each part of the poset of the form @xmath920 ( @xmath921 , as great as possible relatively to inclusion and such that each @xmath62 is a connected block of @xmath15 , is mapped to a pair @xmath184 of states ; informally speaking , @xmath119 and @xmath120 are the states that are supposed to respectively begin and finish the part of the path labeled by @xmath15 .",
    "the formula guarantees that pairs of states and sequential transitions are chosen consistently with the transitions of @xmath132 , and that , if @xmath920 as above and @xmath315 for all @xmath63 $ ] , then there exists a combination of fork transitions that connects @xmath119 to @xmath922 , a sequence of join transitions that connects @xmath923 to @xmath120 , such that a path @xmath456 in @xmath132 is formed .",
    "let us give this construction more formally .",
    "given two second - order variables representing sets , the properties @xmath924 , @xmath853 , @xmath925 are clearly definable in mso .",
    "the equality @xmath854 of two elements is clearly expressible with a mso formula , that states for example that @xmath926 .",
    "we denote `` there exists an unique @xmath226 '' by @xmath927 , `` @xmath226 and @xmath908 are different and not comparable '' by @xmath928 , `` there exists a non - empty set @xmath64 '' by @xmath929 , `` set @xmath64 has cardinality @xmath930 '' by @xmath931 , where @xmath930 is any integer , `` set @xmath64 has cardinality @xmath932 '' by @xmath933 , where @xmath930 is any integer , `` there exists ( resp . for all ) @xmath226 in @xmath64 '' by @xmath859 ( resp .",
    "@xmath860 ) , `` @xmath64 contains all the elements '' by @xmath934 .",
    "all those properties are definable in mso . in",
    "the further we will use the following shortcuts : @xmath935    the formal definitions of a block , a good block and a connected block can be directly translated into mso formul  as follows : @xmath936    let @xmath19 be an alphabet and @xmath74 be a rational language of @xmath55 given by an automaton @xmath187 and @xmath131 .",
    "following bchi s ideas  @xcite , this section is devoted to the construction of a p - mso sentence @xmath937 such that @xmath938 for some @xmath939 , @xmath940 , if and only if @xmath941 .    informally speaking , the sentence annotates @xmath15 using second - order variables that encode the transitions of @xmath132 , consistently with the notion of a path .",
    "to each transition @xmath942 we attach a second - order variable @xmath943 , and use the following formula @xmath944 in order to express that each element of @xmath15 labeled by @xmath135 is the label of a unique transition @xmath942 in a path . in order to express that if @xmath942 and @xmath945 are two consecutive transitions in a path then @xmath946 , we use the following formula @xmath947 we now turn to a more technical part of the construction of @xmath937 : expressing that each part of @xmath15 of the form @xmath948 , @xmath949 , is the label of path from a state @xmath154 to a state @xmath134 that uses fork and join transitions consistently to the definition of a path in @xmath132 . second - order variables @xmath950 and @xmath951",
    "are used to express that the part of the path labeled by @xmath833 starts in @xmath154 and finishes in @xmath134 . the sets @xmath950 and @xmath951",
    "are composed of particular elements of @xmath15 which are named _",
    "witnesses _ of @xmath833 , and are attached unambiguously to @xmath833",
    ".    a _ good maximal parallel block _ of @xmath952 is a good block @xmath833 of @xmath64 such that @xmath953 for some nonempty @xmath59 and @xmath60 , and maximal relatively to parallel decomposition , ie .",
    "there is no good block @xmath954 of @xmath64 such that @xmath955 for some nonempty @xmath956 .",
    "the property `` @xmath833 is a good maximal parallel block of @xmath64 '' can easily be translated into a formula @xmath957",
    ". @xmath958    [ ex : gmpb ] figure  [ fig : gmbp ] represents a n - free poset @xmath15 and its good maximal parallel blocks @xmath959 , @xmath960 , @xmath961 and @xmath962 .",
    "-6 cm    -6.7 cm -3 cm    the good maximal parallel block @xmath959 can be decomposed into @xmath963 where @xmath964 and @xmath965 are two connected blocks . the good maximal parallel block @xmath962 has two connected blocks : @xmath966 and @xmath967 .",
    "any n - free poset @xmath15 can be represented by a labeled tree , as in the figure , where internal nodes are labeled by sequential or parallel products , and leaves by elements of @xmath15 , and such that no internal node has the same label as one of its sons .",
    "formally , these trees are not terms as we defined them because of the arity of internal nodes .",
    "good maximal parallel blocks of @xmath15 correspond to the sub - trees whose root is a node labeled by @xmath88 .    the following lemma holds .",
    "[ lem : compgmpb ] let @xmath15 be a n - free poset , @xmath952 , and @xmath968 be two good maximal parallel blocks of @xmath64 .",
    "then either @xmath969 or @xmath970 or @xmath971 or @xmath972 or @xmath973 .",
    "first assume @xmath974 .",
    "let @xmath975 be such that @xmath976 and @xmath977 .",
    "assume that there exist @xmath978 , @xmath979 such that @xmath334 and @xmath980 are comparable .",
    "wlog suppose @xmath981 . as @xmath833 is a good block , then @xmath982 for all @xmath983 .",
    "it follows easily that @xmath969",
    ". if all the elements of @xmath833 and @xmath954 are incomparable then @xmath971 .",
    "assume now that there exists @xmath984 .",
    "assume that one is not included into the other .",
    "thus there exist @xmath985 and @xmath986 .",
    "assume that @xmath226 and @xmath334 are comparable , say wlog .",
    "@xmath987 . if @xmath334 and @xmath980 are incomparable then @xmath988 because @xmath954 is a good block .",
    "so necessarily @xmath981 otherwise @xmath954 would not be a good block . if @xmath226 and @xmath980 are incomparable then @xmath833 is not a good block , so @xmath226 and @xmath980 are comparable and necessarily @xmath982 otherwise @xmath833 would not be a block .",
    "now , as @xmath833 and @xmath954 are both parallel blocks , there exist @xmath989 and @xmath990 such that @xmath135 is incomparable to @xmath334 and @xmath226 , and @xmath160 is incomparable to @xmath980 and @xmath226 . as @xmath833 and @xmath954",
    "are good blocks then @xmath991 and @xmath992 . because @xmath15 is n - free then @xmath993 .",
    "thus @xmath994 forms an n , which is a contradiction .",
    "so @xmath334 ( and @xmath980 ) is uncomparable to @xmath226 . as a consequence @xmath334 and @xmath980",
    "are also incomparable , otherwise @xmath833 and @xmath954 would not be good blocks . as @xmath334 is incomparable to @xmath226",
    ", we also have that if @xmath995 is a decomposition of @xmath833 and @xmath996 for some @xmath63 $ ] then @xmath997 . also , decomposing @xmath954 into @xmath998 , if @xmath999 , then the elements of @xmath1000 are incomparable to those of @xmath1001 .",
    "thus , consider @xmath1002 : it is a parallel block .",
    "assume it is not good .",
    "there exist @xmath1003 , @xmath1004 such that @xmath226 is comparable to @xmath135 and incomparable to @xmath160 . if @xmath1005 ( resp .",
    "@xmath1006 ) then @xmath833 ( resp .",
    "@xmath954 ) is not a good block .",
    "so assume @xmath1007 and @xmath1008 .",
    "necessarily @xmath334 is comparable to all the elements of @xmath833 and incomparable to those of @xmath954 .",
    "thus @xmath974 , which is a contradiction . as a conclusion ,",
    "@xmath1002 is a good parallel block , @xmath1009 , so @xmath833 and @xmath954 are not maximal : the intersection of two good maximal parallel blocks is necessarily empty .",
    "the following lemma shows that the set of minimum ( or maximum ) elements of a good maximal parallel block @xmath211 characterizes @xmath211 :    [ lem : unicitygmpbmin ] two different good maximal parallel blocks of @xmath15 can not have the same set of minimum ( resp .",
    "maximum ) elements .",
    "assume by contradiction that @xmath211 and @xmath1010 have the same set @xmath215 of minimum elements ( the proof is the same if @xmath215 is the set of maximum elements ) .",
    "according to lemma  [ lem : compgmpb ] , @xmath1011 or @xmath1012 , say wlog .",
    "there exists @xmath1013 . necessarily",
    "@xmath1014 , thus there exists @xmath1015 such that @xmath1016 .",
    "observe that @xmath226 is necessarily greater than all the elements of @xmath215 , otherwise @xmath1010 would not be a good part of @xmath15 . but",
    "this implies that @xmath1010 can not be decomposed into @xmath1017 , so @xmath1010 is not a good maximal parallel block , in contradiction with the hypothesis .",
    "let @xmath211 be a good maximal parallel block of a n - free poset p. the set of _ witnesses _ of @xmath211 is the union of the set of _ left witnesses _ of @xmath211 and the set of _ right witnesses _ of @xmath211 , respectively denoted @xmath1018 and @xmath1019 and defined by : @xmath1020 or equivalently : @xmath1021    in example  [ ex : gmpb ] ,    2    * @xmath1022 and @xmath1023 , * @xmath1024 and @xmath1025 , * @xmath1026 and @xmath1027 , * @xmath1028 and @xmath1029 .",
    "figure  [ fig : gmbp2 ] represents a n - free poset @xmath15 and its good maximal parallel blocks @xmath959 , @xmath960 , @xmath961 and @xmath962 .",
    "-6 cm    -6.7 cm -3 cm    we have    2    * @xmath1022 and @xmath1023 , * @xmath1024 and @xmath1030 , * @xmath1026 and @xmath1031 , * @xmath1032 and @xmath1033 .",
    "observe that @xmath0 is both a right witness of @xmath961 and a left witness of @xmath962 .",
    "observe also that @xmath930 is not a right witness of @xmath962 .",
    "let us denote @xmath1034 , @xmath1035 and @xmath1036 .",
    "[ lem : wit1 ] either @xmath1037 or @xmath1038 or @xmath1039 is the set of witnesses of @xmath211 .",
    "observe that @xmath1040 and @xmath1041 , thus the witnesses of @xmath211 are a subset of @xmath1039 .",
    "observe also that if @xmath1042 ( resp .",
    "@xmath1038 ) is a witness of @xmath211 , then all the elements of @xmath1037 ( resp .",
    "@xmath1038 ) are witnesses of @xmath211 .",
    "indeed , let @xmath1043 with @xmath949 and @xmath1042 such that @xmath226 is a witness of @xmath211 .",
    "then @xmath226 is a predecessor of a minimum of @xmath211 .",
    "as @xmath211 is a good block , then @xmath226 is also less than all the minimums of @xmath211 , and @xmath226 is necessarily a predecessor of all those minimums . as in a n - free poset",
    "all the predecessors of an element have the same successors it follows that if @xmath226 is a witness of @xmath211 then @xmath1037 contains only witnesses of @xmath211 .",
    "we argue similarly with the elements of @xmath1038 .",
    "now let @xmath1044 .",
    ", assume that @xmath1045 .",
    "assume that @xmath1046 is not a witness of @xmath211 : there exists @xmath334 such that @xmath1047 and @xmath1048 .",
    "let @xmath1049 be the smallest block of elements @xmath1050 such that    * @xmath1051 and * if @xmath980 is comparable to some @xmath1052 and @xmath1053 then @xmath1054    observe that @xmath1055 is a good block for all @xmath334 such that @xmath1047 . indeed , assume that it is not : there exist @xmath1056 , @xmath1057 and @xmath1058 such that @xmath134 is comparable to @xmath1059 and @xmath980 and incomparable to @xmath1060 , and it is just verification to check that @xmath15 is not n - free .",
    "assume there exists @xmath1061 such that @xmath1046 is incomparable with @xmath980 .",
    "if @xmath1062 then @xmath1063 form an n for any @xmath1057 . if @xmath980 and @xmath334 are incomparable then there exists @xmath1064 such that either @xmath1065 or @xmath1066 , otherwise @xmath833 would not be as small as possible . if @xmath1065 then @xmath1067 is an n for any @xmath1057 .",
    "the case @xmath1066 is similar .",
    "thus @xmath1068 .",
    "as @xmath1069 is not a good parallel block , but @xmath211 and @xmath833 are , there exists @xmath1070 such that @xmath1071 is comparable to all the elements of @xmath211 and incomparable to all the elements of @xmath833 , or @xmath1071 is incomparable to all the elements of @xmath211 and comparable to all the elements of @xmath833 . as this latter case",
    "would imply that @xmath1072 , then only the first case is possible . if @xmath1073 and @xmath1074 then @xmath1071 and @xmath1046 are different , and @xmath1075 is impossible , otherwise there would be an n formed by @xmath1076 and any element of @xmath211 .",
    "it is impossible that @xmath1077 because it implies @xmath1078 .",
    "it is also impossible that @xmath1079 .",
    "now take @xmath1071 as small as possible such that @xmath1080 and @xmath1074 . by contradiction , assume that @xmath1071 is not a witness of @xmath211 ; there exists @xmath1081 such that @xmath1082 and @xmath1083 .",
    "let @xmath1084 .",
    "then @xmath25 is a good block , @xmath1085 , @xmath1086 and @xmath1087 . as @xmath1088 can not be a good parallel block ( otherwise @xmath211 would not be a maximal good parallel block ) , then exists @xmath1089 such that either    * @xmath134 is comparable to an element of @xmath25 and incomparable to an element of @xmath211 , and so to all the element of @xmath211 because @xmath211 is a good block ; this implies @xmath1090 which is in contradiction ; * or @xmath134 is incomparable to an element of @xmath25 ( and thus to all the elements of @xmath25 ) and comparable to an element of @xmath211 ( and thus to all the elements of @xmath211 ) .",
    "they are two cases . if @xmath1091 then @xmath134 is necessarily incomparable and different to @xmath1046 , thus for all @xmath1057 , @xmath1092 form an n , which is a contradiction . otherwise , if @xmath1093 , then necessarily @xmath1094 and @xmath1095 , and thus @xmath1071 is not as small as possible such that @xmath1080 and @xmath1074 , which is also a contradiction .",
    "thus @xmath1071 is a witness of @xmath211 , and @xmath1096 .",
    "we use similar arguments to show that if @xmath1097 is not a witness of @xmath211 then @xmath1037 is the set of witnesses of @xmath211 .",
    "every good maximal parallel block @xmath211 of @xmath15 which is not @xmath15 itself has a witness .",
    "if @xmath1039 is empty then there is no @xmath1098 which is comparable to an element of @xmath211 .",
    "thus @xmath1099 is a good block , and @xmath1100 a good parallel block , which contradict the maximality of @xmath211 . if @xmath1037 is not empty but has no witnesses of @xmath211 , then using the same arguments as in proof of lemma  [ lem : wit1 ] the witnesses of @xmath211 are the elements of @xmath1038 which is not empty .",
    "similarly , if @xmath1038 is not empty but has no witnesses of @xmath211 then the witnesses of @xmath211 are the elements of @xmath1037 which is not empty .",
    "[ lem : succ1 ] let @xmath15 be a n - free poset , and @xmath1101 such that @xmath135 is a predecessor of @xmath160 , @xmath96 a predecessor of @xmath1102 , @xmath1103 and @xmath1104 . then @xmath135 is a predecessor of @xmath1102 and @xmath96 a predecessor of @xmath160 .    necessarily @xmath1105 and @xmath1106 . by contradiction",
    "assume that the statement of the lemma is false , for example that @xmath135 is not a predecessor of @xmath1102",
    ". then , there exists @xmath226 successor of @xmath135 such that @xmath1107 .",
    "then @xmath226 is incomparable with @xmath160 and to @xmath96 , thus @xmath1108 is an n.    [ lem : wit2 ] every @xmath36 is a left ( resp .",
    "right ) witness of at most one good maximal parallel block of @xmath15 .",
    "assume that @xmath226 is a left witness of two different good maximal parallel blocks @xmath959 and @xmath960 .",
    "then @xmath1109 , and thus there exists @xmath1110 , @xmath1111 such that @xmath226 is a predecessor of both @xmath1112 and @xmath1113 .",
    "a consequence of the definition of left witness is that @xmath1114 ( and thus @xmath1115 ) and @xmath1116 ( and thus @xmath1117 ) .",
    "now , let @xmath1118 .",
    "there exists @xmath1119 such that @xmath908 is a predecessor of @xmath1120 . according to lemma  [ lem : wit1 ] @xmath908 is a left witness of @xmath959 , and thus @xmath1121 and @xmath1122 . as a consequence of lemma  [ lem : succ1 ] @xmath641 are both predecessors of @xmath1123 .",
    "it follows that @xmath1124 , and as a consequence @xmath1125 .",
    "assume that @xmath1126 , and wlog .",
    "that there exists @xmath1127 such that @xmath1128 .",
    "then @xmath1113 is comparable to a minimum @xmath618 of @xmath960 , which is also a minimum of @xmath959 , and , because @xmath960 can be decomposed into @xmath1129 , @xmath1113 is incomparable to another minimum @xmath1130 of @xmath960 , which is also a minimum of @xmath959 .",
    "thus , because @xmath959 is good , we should have @xmath1116 , which is a contradiction .",
    "being a left witness of a good maximal parallel block @xmath211 can easily be encoded into a mso - formula : @xmath1131 a similar formula @xmath1132 can be written for right witnesses .",
    "we now come back to the definition of a p - mso formula that expresses that the ( strict ) part of @xmath15 identified by @xmath64 is the label of a path in @xmath132 . to each good maximal parallel block @xmath211 of @xmath64 we attach a unique couple of states @xmath721 using the witnesses of @xmath211 , with the help of a two second - order variables , @xmath1133 for left witnesses and @xmath1134 for right witnesses : @xmath1135 and we check that    * for every block of @xmath15 of the form @xmath1136 with @xmath211 a good maximal parallel block of @xmath15 and @xmath79 , if @xmath1137 and @xmath1138 then @xmath1139 ( and symmetrically for blocks of @xmath15 of the form @xmath1140 ) ; * for every block of @xmath15 of the form @xmath1141 with @xmath1142 good maximal parallel blocks of @xmath15 , if @xmath1137 and @xmath1143 then @xmath1139 .",
    "the check is done with the formula @xmath1144 below . for convenience , we start by defining a formula @xmath1145 for every @xmath1146 such that @xmath1147 if and only if @xmath211 is the good maximal parallel block of @xmath64 whose set of minimum elements is @xmath215 ( the uniqueness of @xmath211 is guaranteed by lemma  [ lem : unicitygmpbmin ] ) and the part of the path labeled by @xmath211 starts with @xmath120 .",
    "@xmath1148 formul  @xmath1149 , @xmath1150 and @xmath1151 could similarly be written in order to define the good maximal parallel block @xmath211 according to its set of minimal / maximal elements , and to express that the part of the path labeled by @xmath211 starts / ends with @xmath120 .",
    "returning to the definition of @xmath1144 : @xmath1152    now we define @xmath1153 that tests if the connected block @xmath64 begins in @xmath119 and ends in @xmath120 .",
    "@xmath1154 observe that in @xmath1153 all quantifications can be assumed relative to @xmath64 .",
    "actually , the formula @xmath1155 ensures that @xmath1156 , and , as @xmath64 is a connected block and @xmath1157 , the witnesses of @xmath1010 are necessarily in @xmath64 .",
    "let @xmath1158 .",
    "for every @xmath721 we define a p - mso formula @xmath1159 such that , for any good maximal parallel block @xmath211 of @xmath15 , @xmath1160 if and only if @xmath211 can be decomposed into @xmath1161 such that @xmath1162 for every @xmath63 $ ] and @xmath1163 $ ] , and @xmath1164 . in other words , @xmath1165 if and only if there is a path @xmath1137 .    as a consequence of lemma  [ lem : fqpparallelrat ] and theorems  [",
    "th : ratsemlin ] and  [ th : presburgersemilinear ] , @xmath295 is the presburger set ( over the alphabet @xmath408 ) of some presburger formula @xmath1166 , from which we deduce directly @xmath1159 .",
    "we now write a formula @xmath1167 that applies the adequate @xmath1168 to all good maximal parallel blocks of @xmath15 ( except @xmath15 itself if it is a good maximal parallel block ) .",
    "@xmath1169    we are ready to define a p - mso sentence @xmath937 that defines @xmath74 . set @xmath1170 .",
    "observe that for any nonempty n - free poset , either @xmath58 for some nonempty @xmath1171 , in which case @xmath15 is a maximal good parallel block of itself , or @xmath15 is a connected block . assuming @xmath157 , define @xmath1172 then @xmath941 if and only if there is a path @xmath938 for some @xmath939 , @xmath940 .",
    "let @xmath19 be an alphabet and @xmath1173 be a p - mso formula which has a set @xmath1174 of free first - order variables interpreted over elements of posets ( we do not consider here the variables that are interpreted over non - negative integers ) and a set @xmath1175 of free second - order variables .",
    "a _ @xmath1176-poset _ labeled by @xmath19 is a n - free poset @xmath837 labeled by @xmath1177 such that for all @xmath63 $ ] there exists exactly one @xmath883 such that @xmath1178 , where @xmath1179 ( @xmath1180 $ ] ) is the projection of a tuple on its @xmath1181 component .",
    "observe that a poset labeled by @xmath19 can be viewed as a @xmath1182-poset labeled by @xmath19 .",
    "observe also that an interpretation of the variables @xmath1183 in @xmath15 induces a unique @xmath1176-poset @xmath1184 , and reciprocally .",
    "this allows us to use indifferently one representation or the other in order to lighten the notation .",
    "the @xmath1176-posets are a generalization from words to n - free posets of an idea of  @xcite .",
    "this section is devoted to the construction of an automaton @xmath1185 on the alphabet @xmath1177 such that @xmath1186 if and only if @xmath1187 for any @xmath131 . if @xmath240 is a sentence , then @xmath1188 if and only if @xmath1189 . the construction of @xmath1185 is by induction on the structure of @xmath240 , and is a generalization of the well - known construction of a kleene automaton from a mso - formula when mso is interpreted over words ( see for example  @xcite for a clear presentation of this case ) .",
    "it is easy to build an automaton @xmath1190 that tests if a poset @xmath131 labeled by @xmath1177 is a @xmath1176-poset for some @xmath1191 .",
    "it suffices to test in @xmath15 , for each @xmath1192 , if @xmath657 appears exactly once into the sets that appear as second components of the letters .",
    "example  [ ex : oneaatleast ] exhibits an automaton that tests if a particular letter @xmath135 appears at least once : it can easily be transformed in order to test if @xmath135 appears exactly once , from which we deduce @xmath1190 .    as a consequence of proposition  [ prop : union ] and theorem  [ th : complement ] ,",
    "from now we consider that inputs of branching automata are @xmath1176-posets .    the construction of an automaton @xmath1193 that tests if @xmath1194 for some first - order variables in the input @xmath1176-poset has @xmath1195 as set of states with @xmath1196 a sink state .",
    "the state @xmath1197 is the only initial state and all states @xmath1198 such that @xmath1199 are final .",
    "the sequential transition from state @xmath1198 labeled by @xmath1200 goes to    * @xmath1196 if @xmath1201 and @xmath1202 , or @xmath1203 ; * @xmath1204 otherwise .",
    "each state @xmath154 which is not @xmath1196 is the source of a fork transition @xmath1205 , and for every pair of states @xmath1206 there is a join transition @xmath1207 .    as the test automata for the atomic formul  @xmath1208 and @xmath1209 use the same principle we only give the construction of an automaton @xmath1210 that tests the latter .",
    "it has @xmath1211 as set of states with @xmath1196 as unique initial state and @xmath1212 as unique final state .",
    "the only sequential transitions from @xmath1196 to @xmath1212 are labeled by @xmath1200 such that @xmath1202 and @xmath1213 .",
    "all other sequential transitions are from @xmath154 to @xmath154 for all states @xmath154 .",
    "the fork transitions are @xmath1205 for all states , and the join transitions are @xmath1214 where @xmath1215 if at least one of @xmath1216 is @xmath1212 , @xmath1217 otherwise .",
    "constructions of automata for the boolean connectors @xmath1218 , @xmath1219 and @xmath1220 are a consequence of proposition  [ prop : union ] and theorem  [ th : complement ] .",
    "assume now that @xmath1173 is a p - mso formula with free first - order variables @xmath1174 and free second - order variables @xmath1175 .",
    "assume that by induction hypothesis an automaton @xmath1221 can effectively be constructed from @xmath1173 , and let @xmath63 $ ] .",
    "we use @xmath1222 in order to build an automaton @xmath1223 such that @xmath1224 if and only if @xmath1225 , for any @xmath131 .",
    "there is a sequential transition @xmath1226 if and only if @xmath1227 and @xmath1228 , and a sequential transition @xmath1229 is and only if @xmath1227 and @xmath1230 .",
    "there is a fork transition @xmath1231 if and only if @xmath1232 , and a join transition @xmath1233 if and only if @xmath1234 .",
    "the construction for quantification over a second - order variable is similar to the one of first - order variable .",
    "[ rem : msoauto ] we have proved by all the constructions above that for any mso - sentence @xmath240 there exists an automaton @xmath1185 such that @xmath1188 if and only if @xmath1189 .",
    "we finally turn to the last case where @xmath240 has the form @xmath873 recall here that @xmath876 are variables that are interpreted over non - negative integers , and that each @xmath1235 , @xmath63 $ ] , has one free variable @xmath64 , which is second - order , all quantifications relative to @xmath64 and no free first - order variables . by induction hypothesis",
    ", there is an automaton @xmath1236 such that @xmath1237 if and only if @xmath1238 . according to the semantics of @xmath892 , the only interpretations of @xmath833 in @xmath15 verify ( 1 ) @xmath1239 and ( 2 ) @xmath15 is a connected block .",
    "the conjunction of ( 1 ) and ( 2 ) is a mso - definable property of @xmath833 , and thus according to remark  [ rem : msoauto ] above it can be checked by an automaton @xmath185 . as a consequence of proposition  [ prop : union ] and theorem  [ th : complement ] there exists an automaton @xmath1240",
    "such that @xmath1241 .",
    "now , let @xmath1242 be a new alphabet disjoint from @xmath19 . as a consequence of theorems  [ th : presburgersemilinear ] , [ th : ratsemlin ] and  [ th : kleenebranching ] there is an automaton @xmath1243 over the alphabet @xmath68 such that @xmath1244 is the presburger set of @xmath866 over @xmath68 .",
    "then @xmath1245 thus @xmath74 is regular according to theorem  [ th : kleenebranching ] .",
    "let @xmath157 and @xmath167 be the language composed of the nonempty posets of the form @xmath61 , where each @xmath62 , @xmath63 $ ] , has the form @xmath1246 with each @xmath1247 a totally ordered nonempty poset ( that is to say , a nonempty word ) , and such that for each @xmath63 $ ] the number of @xmath1247 that starts with an @xmath135 is @xmath1248 .",
    "set @xmath1249 and @xmath1250 .",
    "then @xmath74 is the language of the rational expression @xmath1251 .",
    "we define @xmath74 by a p - mso sentence as follows .",
    "given two elements of the poset denoted by first order variables @xmath226 and @xmath908 , one can easily write a mso formula @xmath1252 ( resp .",
    "@xmath1253 ) that is true if and only if @xmath226 is a successor ( resp .",
    "predecessor ) of @xmath908 . set @xmath1254",
    "then @xmath74 is the language of the following p - mso sentence @xmath1255 with @xmath1256 . in the formula above , @xmath1257 and @xmath1258 respectively",
    "express with mso formul  that @xmath1259 partitions @xmath64 , and that @xmath250 and @xmath657 are different and not comparable .",
    "the mso formula @xmath1260 express that @xmath1261 is a block of @xmath64 , maximal relatively to inclusion .",
    "in this section we introduce another notion of automata for languages of @xmath55 , which is actually equivalent , in expressiveness , to branching automata .",
    "denote by @xmath1262 the class of presburger formul  @xmath866 with @xmath2 free variables .",
    "a _ presburger - branching automaton _ ( or _ p - branching automaton _ for short ) is a tuple @xmath105 where @xmath1263 is a finite set of states , @xmath19 is an alphabet , @xmath106 is the set of _ initial states _ , @xmath107 the set of _ final states _ , and @xmath109 is the set of _ transitions _ of @xmath108 , which are of three kinds :    * @xmath110 contains the _ sequential _ transitions , which are usual transitions of kleene automata ; * @xmath1264 and @xmath1265 , respectively the _ fork _ and _ join _ transitions , are finite subsets of @xmath1266 .",
    "let @xmath1267 be a multi - set of elements of @xmath25 .",
    "by @xmath1268 we denote the parikh s image of @xmath1267 , ie . the element @xmath905 of @xmath864 such that @xmath1267 is the multi - set with @xmath1269 occurrences of @xmath1270 , for all @xmath63 $ ] .",
    "paths in p - branching automata are defined as in branching automata , except for the parallel case : for any finite set of paths @xmath136 ( with @xmath137 ) respectively labeled by @xmath138 , from @xmath1271 to @xmath1272 , if @xmath1273 is a fork transition , @xmath1274 a join transition , then @xmath143 is a path from @xmath119 to @xmath120 and labeled by @xmath144 if @xmath1275 and @xmath1276 are respectively in the presburger set of @xmath231 and of @xmath1277 , and @xmath1278}v_i$ ] , @xmath1278}v'_i>1 $ ] .",
    "the notions of accepting paths and languages of a p - branching automaton are defined as in branching automata .",
    "a language @xmath167 is _ p - regular _ if there exists a p - branching automaton @xmath132 such that @xmath156 .",
    "let @xmath19 be an alphabet and @xmath167 .",
    "then @xmath74 is regular if and only if it is p - regular .",
    "it is immediate that regularity implies p - regularity , since a fork transition ( the same applies for join transitions ) @xmath1279 of a branching automaton can be interpreted as a fork transition @xmath1280 of a p - branching automaton , with @xmath1281 the unique element of the presburger set of @xmath866 .",
    "the converse needs more attention since the presburger set of a formula @xmath231 may be infinite .",
    "assume that @xmath132 is a p - branching automaton with @xmath1263 as set of states .",
    "we replace one by one all of its fork transitions @xmath1280 by fork transitions of branching automata , by the following construction that add new states to @xmath132 .",
    "denote by @xmath1282 .",
    "each element of @xmath1283 can equivalently be represented as an element of @xmath1284 .",
    "we first build a branching automaton @xmath1285 on the alphabet @xmath25 such that @xmath1286 .",
    "it has exactly one initial state , which is not the destination of any transition , and one final state which is not the source of any transition . by theorem",
    "[ th : presburgersemilinear ] , @xmath1283 is a semi - linear set of @xmath1284 : @xmath1287 for some finite set @xmath202 , disjoint finite sets @xmath1288 , @xmath939 , with @xmath1289 $ ] for all @xmath1290 , @xmath1291 $ ] , @xmath1292 $ ] .",
    "we may assume that each multi - set of @xmath1283 has at least two elements , so @xmath1293 for all @xmath939 . then @xmath1285 is composed of one initial state @xmath158 , one final state @xmath0 , two states @xmath1294 and @xmath1295 and one sequential transition @xmath1296 for all @xmath939 , @xmath1291 $ ] , two states @xmath1297 and @xmath1298 and one sequential transition @xmath1299 for all @xmath939 , @xmath1300 , @xmath1301 $ ] . for each @xmath939",
    ", there is one fork transition from @xmath158 to all the @xmath1294 , @xmath1291 $ ] , and symmetrically , one join transition from all the @xmath1295 , @xmath1291 $ ] , to @xmath0 . for each @xmath939 , add also two states @xmath1302 and @xmath1303 , a fork transition @xmath1304 , a join transition @xmath1305 , and , for all @xmath1300 , a fork transition @xmath1306 and a join transition @xmath1307 if @xmath1308 , a sequential transition @xmath1309 if @xmath1310 . for each @xmath939 , add a fork transition @xmath1311 and a join transition @xmath1312 .",
    "we have @xmath1286 .",
    "now , remove all sequential transitions , all join transitions , @xmath0 and all states of the form @xmath1313 from @xmath1285 and name @xmath1314 the new automaton .",
    "consider the disjoint union of @xmath132 and @xmath1314 .",
    "remove @xmath1280 .",
    "replace @xmath158 by @xmath119 and all states of the form @xmath1315 , @xmath1146 , by @xmath120 .",
    "join transitions @xmath1280 are removed with a similar mechanism .",
    "the effectiveness of the constructions involved in the proof of theorem  [ th : pmsorat ] have several consequences .",
    "p - mso theory @xmath222 of @xmath55 _ consists of all sentences @xmath183 of p - mso such that @xmath1316 for every @xmath131 .",
    "the p - mso theory of @xmath55 is _ decidable _ if there exists a decision procedure that tests if @xmath1317 .",
    "because emptiness is decidable for languages of branching automata ( see proposition  [ prop : findpath ] ) , we have :    [ th : pmsodecidable ] let @xmath19 be an alphabet .",
    "the p - mso theory of @xmath55 is decidable .    in  @xcite , lodaya and",
    "weil asked for logical characterizations of several classes of rational languages . as it is equivalent to branching automata ,",
    "p - mso is the natural logic to investigate such questions , that are still open .    extending the work of lodaya and weil , and those of kleene - schtzenberger , kuske and meinecke  @xcite proposed to attach costs to paths in branching automata .",
    "they defined and studied branching automata with costs , and extended to this case the machinery from the theory of weighted automata .",
    "they provided in particular a kleene - like theorem for branching automata with costs , in the particular case of bounded - width languages .    among the works connected to ours ,",
    "let us mention sik and nmeth  @xcite , which itself has been influenced by the work of hoogeboom and ten pas  @xcite on text languages .",
    "they study languages of bi - posets from an algebraic , automata and regular expressions based point of view , and the connections with mso .",
    "a bi - poset is a set equipped with two partial orderings ; thus , n - free posets are a generalization of n - free bi - posets , where commutation is allowed in the parallel composition .",
    "mso and presburger logic were also mixed in other works , but for languages of trees instead of n - free posets .",
    "motivated by reasoning about xml documents , dal zilio and lugiez  @xcite , and independently seidl , schwentick and muscholl  @xcite , defined a notion of tree automata which combines regularity and presburger arithmetic .",
    "in particular in  @xcite , mso is enriched with presburger conditions on the children of nodes in order to select xml documents , and proved equivalent to unranked tree automata .",
    "observe that unranked trees are a particular case of n - free posets .",
    "the author would like to thank the referees of this paper , whose comments helped in improving its quality . among many remarks ,",
    "the content of section  [ sec : pbranching ] was suggested by one of them .",
    "zoltn sik and z.l .",
    "automata on series - parallel biposets . in w.",
    "kuich , g.  rozenberg , and a.  salomaa , editors , _ dlt2001 _ ,",
    "volume 2295 of _ lect",
    ". notes in comput .",
    "_ , pages 217227 .",
    "springer - verlag , 2002 .",
    "stephen  c. kleene .",
    "representation of events in nerve nets and finite automata . in shannon and mccarthy , editors ,",
    "_ automata studies _ , pages 342 , princeton , new jersey , 1956 .",
    "princeton university press .",
    "kamal lodaya and pascal weil .",
    "series - parallel posets : algebra , automata and languages . in m.",
    "morvan , ch .",
    "meinel , and d.  krob , editors , _ stacs98 _ , volume 1373 of _ lect .",
    "notes in comput .",
    "_ , pages 555565 .",
    "springer - verlag , 1998 .",
    "mojzesz presburger .",
    "ber die vollstandigkeit eines gewissen systems der arithmetic ganzer zahlen , in welchem die addition als einzige operation hervortritt . in _ proc .",
    "sprawozdaniez i kongresu matematykow krajow slowianskich , warsaw _ , pages 92101 , 1930 .",
    "english translation : on the completeness of certain system of arithmetic of whole numbers in which addition occurs as the only operation .",
    "_ hist . philos . logic _",
    ", 12:92101 , 1991 .",
    "helmut seidl , thomas schwentick , and anca muscholl .",
    "counting in trees . in jrg",
    "flum , erich grdel , and thomas wilke , editors , _ logic and automata _ , volume  2 of _ texts in logic and games _ , pages 575612 .",
    "amsterdam university press , 2008 ."
  ],
  "abstract_text": [
    "<S> in this paper we study the logical aspects of _ branching automata _ , as defined by lodaya and weil . </S>",
    "<S> we first prove that the class of languages of finite n - free posets recognized by branching automata is closed under complementation . </S>",
    "<S> then we define a logic , named p - mso as it is a extension of monadic second - order logic with presburger arithmetic , and show that it is precisely as expressive as branching automata . as a consequence of the effectiveness of the construction of one formalism from the other , </S>",
    "<S> the p - mso theory of the class of all finite n - free posets is decidable . </S>"
  ]
}