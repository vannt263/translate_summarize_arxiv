{
  "article_text": [
    "a _ @xmath0 quasi - isometry _ @xmath1 between metric spaces @xmath2 and @xmath3 is a map @xmath4 satisfying @xmath5 with the additional property that there is a number @xmath6 such that @xmath3 is the @xmath6 neighborhood of @xmath7 .",
    "two quasi - isometries @xmath8 are considered to be equivalent if there is a number @xmath9 such that @xmath10 for all @xmath11 .    from @xcite , any solvable lie group @xmath12 has the form    @xmath13    where @xmath14 largest connected normal nilpotent subgroup of @xmath12 , called its _ nilradical _ , and @xmath15 is the abelianization of its cartan subgroup .    in a group @xmath16 , an element @xmath17",
    "is called _ exponentially distorted _ if there are numbers @xmath18 such that for all @xmath19 , @xmath20 where @xmath21 is the distance between the identity and @xmath22 in @xmath16 .    in the case of a connected , simply connected solvable lie group @xmath16",
    ", osin showed in @xcite that the set of exponentially distorted elements forms a normal subgroup @xmath23 inside of the nilradical of @xmath16 .",
    "motivated by the gromov program of classifying groups up to quasi - isometries , we consider , in this two - part paper , quasi - isometries between connected , simply - connected unimodular solvable lie group @xmath16 whose exponential radical coincides with its nilradical and is a semidirect product between its abelian cartan subgroup and its abelian nilradical that is irreducible in some sense .",
    "( for example , is not a direct product with abelian factors ) . by applying the techniques introduced by eskin - fisher - whyte in @xcite , @xcite , and @xcite",
    ", we are able to show that    _ ( theorem [ andre - behaviors of phi ] in @xcite(abridged ) ) _ _ let @xmath16 , @xmath24 be non - degenerate , unimodular , split abelian - by - abelian solvable lie groups , and @xmath25 a @xmath26 quasi - isometry .",
    "then @xmath27 is bounded distance from a composition of a left translation and a standard map .",
    "_    here a standard map is one that respect the factors in the semidirect product and their group structures .",
    "( see definition [ standard map ] ) .    consequently , we are able to see that _ ( corollary [ andre - qigroup ] in @xcite ) _",
    "@xmath28 } bilip(v_{[\\alpha ] } ) \\right ) \\rtimes \\mbox{sym}(g)\\ ] ]    here @xmath29}$ ] s are subspaces of the nilradical , and @xmath30 is a finite group , analogous to the weyl group in reductive lie groups .",
    "it reflects the symmetries of @xmath16 .",
    "( see section [ geometry of g ] )    writing a non - degenerate , unimodular , split abelian - by - abelian solvable group as @xmath31 , where @xmath32 is the abelian nilradical and @xmath33 an abelian cartan subgroup . we can also distinguish groups depending on whether the action of the cartan subgroup on the nilradical ( via @xmath34 ) is diaonalizable or not .    _",
    "( corollary [ andre - diagornot ] in @xcite ) _ _ let @xmath16 , @xmath24 be non - degenerate , unimodular , split abelian - by - abelian solvable lie groups where actions of their cartan subgroups on the nilradicals are @xmath34 and @xmath35 respectively . if @xmath34 is diagonalizable and @xmath35 is nt , then there is no quasi - isometry between them .",
    "_    when @xmath34 is diagonalizable , as an application the work by dymarz @xcite on quasi - conformal maps on the boundary of @xmath16 , and a theorem of mostow that says polycyclic groups are virtually lattices in a connected , simply connected solvable lie group , we have    _ ( corollary [ andre - showing polycyclic ] , [ andre - showing lattice in almost me ] in @xcite ) _ _ in the case that @xmath34 is diagonalizable , if @xmath36 is a finitely generated group quasi - isometric to @xmath31 , then @xmath36 is virtually polycyclic , and is virtually a lattice in a unimodular semidirect product of @xmath32 and @xmath33 .",
    "_    note that in the statement above we are not able to determine if the target semidirect product of @xmath32 and @xmath33 is actually @xmath16 because the latter is a semidirect product of the same factors with some additional conditions , which we are not able to detect at this stage .",
    "+ all the argument in this paper are local in nature and below is a description of the main result .",
    "+ let @xmath37 , @xmath38 be connected , simply connected non - degenerate unimodular split solvable groups ( see section [ geometry of g ] for definitions ) .",
    "we say a map from @xmath16 to @xmath24 is _ standard _ , if it splits as a product map that respects @xmath34 and @xmath35 ( see definition [ standard map ] ) .",
    "a compact convex set @xmath39 determines a bounded set @xmath40 in @xmath16 ( see section 2.2 ) .",
    "writing @xmath41 for the compact convex set obtained by scaling @xmath42 by @xmath43 from the barycenter of @xmath42 , we show in this paper that    [ exisence of standard maps in small boxes ] let @xmath16 , @xmath24 be non - degenerate , unimodular , split abelian - by - abelian lie groups , and @xmath44 be a @xmath0 quasi - isometry . given @xmath45 ,",
    "there exist numbers @xmath46 , @xmath47 , @xmath48 depending on @xmath49 , @xmath50 , @xmath51 and @xmath26 with the following properties :    if @xmath52 is a product of intervals of equal size at least @xmath53 , then a tiling of @xmath40 by isometric copies of @xmath54    @xmath55    contains a subset @xmath56 of @xmath57 with relative measure at least @xmath58 such that    1 .   for every @xmath59",
    ", there is a subset @xmath60 of @xmath61 of relative measure at least @xmath62 2 .",
    "the restriction @xmath63 is within @xmath64 hausdorff neighborhood of a standard map @xmath65 .    here",
    ", @xmath66 , @xmath67 and @xmath68 all approach zero as @xmath51 , @xmath49 go to zero .",
    "the measure of set @xmath69 is at most @xmath70 proportion of measure of @xmath40 , where @xmath70 depends on @xmath49 and goes to zero as the latter approaches zero .",
    "the idea of the proof is as follows .",
    "we employ the technique of ` coarse differentiation ' to images of a particular family of geodesics ( which fills up the set @xmath40 ) in @xmath40 to obtain the scale @xmath43 on which those quasi - geodesics behave like certain simple geodesics .",
    "we are also able to obtain a tiling because the group @xmath16 is unimodular and @xmath40 have small boundary area compared to its volume .",
    "we then use the properties of the groups being non - degenerate , unimodular and split abelian - by - abelian to reach the conclusion on those smaller tiles .",
    "* acknowledgement * i would like to thank alex eskin for his patience and guidance .",
    "i also owe much to david fisher for his help and support .",
    "in this section , we first describe the geometry of the subclass of unimodular solvable lie group mentioned in introduction , followed by a list of notations that will be used in the remaining of this paper .      * non - degenerate , split abelian - by - abelian solvable lie groups * let @xmath71 be a ( real ) solvable lie algebra , and @xmath72 be a cartan subalgebra",
    ". then there are finitely many non - zero linear functionals @xmath73 called _ roots _ , such that    @xmath74    where @xmath75 , @xmath76 is the identity map on @xmath71 , and @xmath77 is the adjoint representation .",
    "we say @xmath71 is _ split abelian - by - abelian _",
    "if @xmath71 is a semidirect product of @xmath72 and @xmath78 , and both are abelian lie algebras ; _ unimodular _ if the the roots sum up to zero ; and _ non - degenerate _ if the roots span @xmath79 .",
    "in particular , non - degenerate means that each @xmath80 is real - valued , and the number of roots is at least the dimension of @xmath72 .",
    "being unimodular is the same as saying that for every @xmath81 , the trace of @xmath82 is zero .",
    "we extend these definitions to a lie group if its lie algebra has these properties .",
    "therefore a connected , simply connected solvable lie group @xmath16 that is non - degenerate , split abelian - by - abelian necessary takes the form @xmath37 such that    1 .",
    "both @xmath33 and @xmath32 are abelian lie groups . 2 .",
    "the homomorphism @xmath83 is injective 3 .",
    "there are finitely many @xmath84 which together span @xmath85 , and a decomposition of @xmath86 4 .",
    "there is a basis @xmath87 of @xmath32 whose intersection with each of @xmath88 constitute a basis of @xmath88 , such that for each @xmath89 , @xmath90 with respect to @xmath87 is a matrix consists of blocks , one for each @xmath88 , of the form @xmath91 , where @xmath92 is an upper triangular with 1 s on the diagonal and whose off - diagonal entries are polynomials of @xmath93 . if in addition , @xmath16 is unimodular , then @xmath90 has determinant 1 for all @xmath89 .",
    "the _ rank _ of a non - degenerate , split abelian - by - abelian group @xmath16 is defined to be the dimension of @xmath33 , and by a result of cornulier @xcite , if two such groups are quasi - isometric , then they have the same rank .",
    "let @xmath94 denotes the roots of @xmath16 . for each @xmath95",
    ", choose a basis @xmath96 in @xmath97 such that @xmath98 is upper triangular for all @xmath89 . also fix a basis @xmath99 in @xmath33 ( for example , the duals of a subset of roots ) , and for each @xmath89 , write @xmath100 for its @xmath101 coordinate .",
    "we coordinatize a point @xmath102 by the @xmath103-tuple of numbers @xmath104 , where @xmath105 . in this coordinate system , a left invariant riemannian metric at @xmath106",
    "is    @xmath107    where @xmath108 is a polynomial with no constant term .",
    "we see that the above riemannian metric is bilipschitz to the following finsler metric :    @xmath109 |d x_{i,\\alpha}|\\ ] ]    where @xmath110 means @xmath111 , and @xmath112 is sum of absolute values of polynomials with no constant terms .",
    "since we defined our metric to be left - invariant , left multiplication by an element of @xmath16 is an isometry . on the other hand ,",
    "right multiplication typically distorts distance .",
    "for example , for points @xmath113 , @xmath89 , @xmath114 , but @xmath115 usually is some exponential - polynomial multiple of @xmath116 .",
    "let @xmath117 be a non - unimodular solvable lie group such that with respect to bases @xmath118 , @xmath119 of @xmath15 and @xmath120 respectively , we have @xmath121 , for all @xmath122 . here",
    "@xmath123 and @xmath124 is unipotent matrix ( upper triangular with 1 s on the diagonal ) with polynomial entries . by giving a point",
    "@xmath125 the coordinate of @xmath126 , and argue as above we see that a left - invariant finsler metric bilipschitz to a left - invariant riemannian metric can be given as @xmath127 |dx_{i}|\\ ] ]    where @xmath128 is the sum of absolute values of polynomials with no constant terms .",
    "the following consequence is immediate .",
    "[ qi embedding ] if @xmath16 is non - degenerate , split abelian - by - abelian , then it can be qi embedded into @xmath129 .",
    "when @xmath130 is diagonal , @xmath131 is just the usual hyperbolic space .",
    "because of the following relation    @xmath132 |d x_{i,\\alpha}| \\right ) \\leq    [ 1 + q_{i,\\alpha}(\\alpha(-\\mathbf{t } ) ) ] |d x_{i,\\alpha}| \\\\ & \\leq & \\sum_{\\alpha \\in \\triangle } \\left (   |d \\alpha(\\mathbf{t})| + e^{-\\alpha(\\mathbf{t } ) } \\sum_{i=1}^{n_{\\alpha } }   [ 1 + q_{i,\\alpha}(\\alpha(-\\mathbf{t } ) ) ] |d x_{i,\\alpha}| \\right)\\end{aligned}\\ ] ]    to understand the geometry of @xmath131 better , we can assume without loss of generality that @xmath133 , and note that the finsler metric in equation ( [ rank1 finsler ] ) is quasi - isometric to one given by @xmath134 for some polynomial @xmath135 . since exponential grows faster than polynomials , for any large positive number @xmath136 , there is a @xmath137 such that @xmath138 for all @xmath139 , and we see that a function q.i . to the metric on @xmath131 is the following @xmath140 where @xmath141 satisfies @xmath142    furthermore , the following relation @xmath143    and the fact that both @xmath144 and @xmath145 are decreasing functions when @xmath146 becomes big enough means that we have the following inequalities for their inverses : @xmath147    for some constant @xmath148 depends only on the polynomial @xmath149 .    back to the description of @xmath16",
    ", we declare two roots equivalent if they are positive multiples of each other , and write @xmath150 $ ] for the equivalence class containing @xmath151 .",
    "a left translate of @xmath152}=\\oplus_{\\sigma \\in [ \\xi ] } v_{\\sigma}$ ] will be called a _ horocycle of root class @xmath150$]_.    a left translate of @xmath32 , or a subset of it , is called a _",
    "flat_. for two points @xmath153 with coordinates @xmath154 and @xmath155 , we compute subsets of @xmath156 and @xmath157 that are within distance 1 of each other according to the embedded metric in lemma [ qi embedding ] , as the @xmath158 and @xmath159 translate of the subset of @xmath33 : @xmath160\\ ] ]    as the roots sum up to zero in a non - degenerate , unimodular , split abelian - by - abelian group , the set where two flats come together can be empty , i.e. the two flats have no intersection .",
    "if it is not empty , then the equation above says that it is an unbounded convex subset of @xmath33 bounded by hyperplanes parallel to root kernels .",
    "[ standard map ] let @xmath16 , @xmath24 be non - degenerate , split abelian - by - abelian lie groups .",
    "a map from @xmath16 to @xmath24 or a subset of them , is called _ standard _ if it takes the form @xmath161 , where @xmath162 sends foliation by root class horocycles of @xmath16 to that of @xmath24 , and @xmath163 sends foliations by root kernels of @xmath16 to that of @xmath24 .    note",
    "that when @xmath16 has at least @xmath164 many root kernels , the condition on @xmath1 means that @xmath1 is affine , and when @xmath16 is rank 1 , the condition on @xmath1 is empty .        *",
    "division of a curve * the word scale shall mean a number @xmath165 $ ] .",
    "we will often examine a quasi - geodesic on different scales , and see if the quasi - geodesic on that scale satisfies certain properties .",
    "this roughly means that we subdivide the quasi - geodesic into subsegments whose lengths are @xmath43 times the length of the original one , and see if each one of them satisfies certain properties . in practice , however , instead of dealing with length , we use distance between end points of a curve .",
    "more precisely , let @xmath166 \\rightarrow y$ ] be rectifiable curve .",
    "* given @xmath167 , we can divide @xmath168 into subsegments whose end points are @xmath169 apart .",
    "more precisely , @xmath170 , is the set of the dividing points on @xmath168 , where @xmath171 , @xmath172 , and @xmath173 * given two points @xmath174 , we write @xmath175}$ ] for the part of @xmath168 between @xmath158 and @xmath159",
    ". define @xmath176 } \\}$ ] , to be the set of subsegments after division .",
    "* let @xmath177 be a statement .",
    "define @xmath178 to be those subsegments satisfying statement @xmath177 .",
    "* we write @xmath179 for the distance between end points of @xmath168 , and @xmath180 denotes for the length of @xmath168 .",
    "* neighborhoods of a set * we write @xmath181 for the ball centered at @xmath158 of radius @xmath169 , and @xmath182 for the @xmath183 neighborhood of the set @xmath184 .",
    "we also write @xmath185 for the hausdorff distance between two sets @xmath184 and @xmath186 .",
    "if @xmath187 is a bounded compact set , and @xmath188 , we write @xmath189 for the bounded compact set that is scaled from @xmath42 with respect to the barycenter of @xmath42 .",
    "given a set @xmath2 , a point @xmath190 , the _ @xmath191 linear neighborhood of @xmath2 with respect to @xmath192 _ is the set @xmath193 .",
    "equivalently it is the set @xmath194 .",
    "by @xmath191 linear neighborhood of a set @xmath2 , we mean the @xmath191 linear neighborhood of @xmath2 with respect to some @xmath195 .",
    "if a quasi - geodesic @xmath196 is within @xmath191 linear ( or just @xmath50-linear ) neighborhood of a geodesic segment @xmath197 , where @xmath198 and @xmath199 , then we say that @xmath196 _ admits a geodesic approximation _ by @xmath197 .",
    "let @xmath200 stands for a non - degenerate , split abelian - by - abelian group , and @xmath94 denotes for its roots .",
    "fix a point @xmath201 .",
    "we define the following :    * for @xmath95 a root , we write @xmath202 for the dual of @xmath80 of norm 1 with respect to the usual euclidean metric .",
    "( this is really a function on root classes . ) * given @xmath203 , we define @xmath204 * let @xmath205 , we define @xmath206 , @xmath207 , @xmath208 , as @xmath209 , @xmath210 , @xmath211 respectively , where @xmath212 is the dual of @xmath213 . * by _ the walls based at p _ , we mean the set @xmath214 .",
    "* by a _ geodesic segment through p _",
    ", we mean a set @xmath215 , where @xmath216 is a directed line segment in @xmath33 . by direction of a directed line segment in euclidean space , we mean a unit vector with respect to the usual euclidean metric , and by direction of @xmath215 we mean the direction of @xmath216 .",
    "* for @xmath217 , by _",
    "@xmath218-hyperplane through p _",
    ", we mean a set @xmath219 , where @xmath220 is an @xmath218-dimensional linear subspace or an intersection between an @xmath218-dimensional linear subspace with a convex set . * let @xmath221 be the projection onto the @xmath33 factor as @xmath222 * for each root @xmath80 , define @xmath223 as @xmath224 .",
    "we refer to negatively curved spaces @xmath225 or @xmath29 } \\rtimes \\langle \\vec{v}_{\\alpha } \\rangle$ ] as weight ( or root ) hyperbolic spaces .",
    "now assume in addition that @xmath16 is unimodular .",
    "fix a net @xmath226 in @xmath16 . for @xmath95 ,",
    "let @xmath227 be maximal product of intervals of size @xmath169 , @xmath228^{\\mbox{dim}(v_{\\alpha})}$ ] , and since @xmath32 is the direct sum of those @xmath97 s , we write @xmath229 for the product of those @xmath230 s as @xmath231 ranging over all roots .",
    "in other words , @xmath232 is just product of intervals in @xmath32 where interval length is @xmath233 in @xmath97 .",
    "let @xmath52 be a convex compact set with non - empty interior , e.g. a product of intervals or a convex polyhedra . without loss of generality assume its barycenter is the identity of @xmath33 .",
    "we define the _ box associated to @xmath42 _ , @xmath40 , as the set @xmath234 .",
    "a box @xmath40 as defined above is just a union of left translates of @xmath52 by a subset of @xmath32 ( product of intervals ) whose size is determined by @xmath42 .",
    "the size of the intervals were chosen so that a large proportion of points in the box @xmath40 lie on a quadrilateral ( see definition [ quadrilateral ] ) . in the definition above we have defined this subset of @xmath32 as a product of intervals , but this is just a choice of convenience so that it is simple to describe the size of this subset in @xmath32 in terms of @xmath42 .",
    "associate to the box @xmath40 , we use the following notations :    * @xmath235 $ ] ( or @xmath236 $ ] ) for the set of geodesics in @xmath40 whose @xmath237 images begin and end at points of @xmath238 such that the ratio between its length and the diameter of @xmath42 lies in the interval @xmath239 $ ] . * for @xmath240 ,",
    "write @xmath241 $ ] ( or @xmath242 $ ] ) for the set of @xmath218 dimensional hyperplanes in @xmath40 such that the ratio between its diameter and the diameter of @xmath42 lies in the interval @xmath243 $ ] . * @xmath244 ( or @xmath245 ) for the set of points in @xmath40 . * let @xmath246 be an element of @xmath247 .",
    "we write @xmath248 , @xmath249 for subset of @xmath250 , @xmath251 contained or containing @xmath246 , and @xmath252 for the subset of @xmath244 contained in @xmath246 .",
    "as we are interested in a given quasi - isometry @xmath25 which implicitly implies particular choices of nets @xmath253 , @xmath254 , we will primarily consider @xmath27 as a map from @xmath255 to @xmath256 .",
    "let @xmath257 that assigns @xmath17 , a closest net point .",
    "in this way we tend to think of a set @xmath258 not so much as a subset of the lie group @xmath16 , but as a subset of @xmath255 via the identification of @xmath259 and @xmath260 .",
    "in particular , the set of hyperplanes and points associated to a box as defined above would be considered finite sets for us .",
    "we now use boxes to produce a sequence of flner sets .",
    "[ boxes are folner ] let @xmath200 be a non - degenerate , unimodular , split abelian - by - abelian lie group .",
    "let @xmath52 be compact convex with non - empty interior .",
    "then , @xmath261 , @xmath262 is a flner sequence .",
    "the volume ratio between @xmath263 and @xmath261 is @xmath264 .    for each root @xmath265",
    ", write @xmath266 $ ] . since the sum of roots is zero ,",
    "the volume element is @xmath267 .",
    "therefore vol@xmath268 . on the other hand ,",
    "the area of the boundary is @xmath269 ( r \\omega ) \\right ) \\right| = \\underbrace { \\left| \\partial \\left ( \\prod_{j}[0,e^{ra_{j } } ] \\right ) ( r \\omega ) \\right| } _ { ( 1 ) } + \\underbrace { \\left| \\left ( \\prod_{j}[0,e^{ra_{j } } ] \\right ) \\partial \\left ( r \\omega \\right ) \\right|}_{(2)}\\ ] ] we estimate the size of each term : @xmath270 \\right ) \\partial \\left ( r \\omega \\right ) \\right| = \\left ( \\prod_{j } e^{ra_{j } } \\right ) r^{n-1 } \\left| \\partial \\omega \\right|\\ ] ]    @xmath271 \\right ) ( r \\omega ) \\right| & = & 2 \\sum_{j }   \\int_{\\mathbf{t } \\in r\\omega } \\underbrace { \\int _ { \\mathbf{x}_{1 } \\in b(e^{ra_{1 } } ) , \\cdots \\mathbf{x}_{i } \\in b^{e^{ra_{i } } } } e^{-\\alpha_{1}(\\mathbf{t } ) } d \\mathbf{x}_{1 } \\cdots e^{-\\alpha_{i}(\\mathbf{t } ) } d \\mathbf{x}_{i } \\cdots } _ { i \\not= j }   d \\mathbf{t } \\\\ & = & 2 \\sum_{j }   \\left ( \\prod_{i \\not= j } e^{ra_{i } } \\int_{\\mathbf{t } \\in r\\omega } e^{\\alpha_{j}(\\mathbf{t } ) } d\\mathbf{t } \\right )   \\\\ & \\leq &   2 \\sum_{j }   \\left ( \\prod_{i \\not= j } e^{ra_{i } } ( e^{ra_{j } } - e^{rb_{j } } ) \\left| proj_{ker(\\alpha_{j})}(r \\omega ) \\right| \\right ) \\\\ & = & 2 \\left ( \\prod_{i } e^{ra_{i } } \\right ) r^{n-1 } \\left ( \\sum_{j}\\left| proj_{ker(\\alpha_{j } ) } ( \\omega ) \\right| ( 1-e^{-(ra_{j}-rb_{j } ) } ) \\right)\\\\ & \\leq & 2 |\\triangle| \\left ( \\prod_{i } e^{ra_{i } } \\right ) r^{n-1 } \\max_{j } \\left| proj_{ker(\\alpha_{j})}(\\omega ) \\right| \\end{aligned}\\ ] ]    [ general folner ] the same calculation as above shows that for any set @xmath272 of the form @xmath273 , where @xmath274 , @xmath52 , the ratio of volumes of @xmath275 and that of @xmath272 is @xmath276 .",
    "the purpose of this section is to prove    [ existence of good boxes ] let @xmath277 be non - degenerate , unimodular , split abelian - by - abelian lie groups , and @xmath25 a @xmath0 quasi - isometry . given @xmath278 , there are numbers @xmath46 , @xmath279 and @xmath280 depending on @xmath281 , @xmath26 with the following properties :    if @xmath52 is a product of intervals of equal size at least @xmath53 , then a tiling of @xmath40 by isometric copies of @xmath282 @xmath283    contains a subset @xmath284 whose measure is at least @xmath285 times that of @xmath286 such that :    1 .   for all @xmath287 ,",
    "there is a subset @xmath288 $ ] , whose measure is at least @xmath289 times that of @xmath290 2 .   if @xmath291 , then @xmath292 is within @xmath50-linear neighborhood of a geodesic segment which makes an angle at least @xmath293 with root kernels .",
    "here @xmath294 , @xmath295 approach zero as @xmath296 .",
    "the measure of set @xmath69 is at most @xmath70 proportion of measure of @xmath40 , where @xmath70 depends on @xmath49 and goes to zero as the latter approaches zero .      in this subsection",
    ", @xmath16 denotes for a non - degenerate , split abelian - by - abelian group . by lemma [ qi embedding ]",
    ", we can use the embedded metric on @xmath16 .",
    "we will use the metric property of those @xmath297 spaces to obtain the following proposition , which basically says that if a quasi - geodesic in @xmath16 is long , then its projection in @xmath33 has to be long as well .",
    "[ ca nt move far in r2r3 ] let @xmath298 \\rightarrow g$ ] be a @xmath0 quasi - geodesic segment .",
    "suppose @xmath299 lies in a ball of diameter @xmath300 .",
    "then for any @xmath301 , @xmath302 , where @xmath303 is a constant that depends only on the number of roots .",
    "[ ca nt move far](assumptions as in proposition [ ca nt move far in r2r3 ] ) if there are two points @xmath304 on @xmath168 such that @xmath305 , then there must be a point @xmath306 $ ] such that @xmath307 .    to prove proposition [ ca nt move far in r2r3 ] , we need the following two lemmas whose verifications can be found in the appendix . + in @xmath308 , we write @xmath309 for the projection onto the @xmath120 factor .",
    "[ ca nt move far in h2 ] let @xmath310 \\rightarrow \\mathit{h}_{n'+1}$ ] be a continuous path such that    * the image of @xmath311 is contained in an interval of length no bigger than @xmath300 , where @xmath312 . here",
    "@xmath313 is a constant depending only on @xmath314 ( as in equation ( [ property of u ] ) ) .",
    "* whenever @xmath315 $ ] , @xmath316    then , for any two points @xmath317)$ ] , @xmath318 , where @xmath319 depends only on @xmath313 .",
    "see appendix    [ mixing ] let @xmath320 , @xmath321 .",
    "suppose @xmath322 , with @xmath323 .",
    "suppose @xmath324 , then @xmath325 .",
    "see appendix    _ of proposition _ [ ca nt move far in r2r3 ]    we proceed by induction on the number of roots .",
    "the base step where there is just one root is lemma [ ca nt move far in h2 ] . since @xmath168 is a @xmath326 quasi - geodesic , for any @xmath327 $ ]",
    ", we must have @xmath328    we recall from lemma [ qi embedding ] that @xmath329 , and proceed to simplify equation([weak efficient ] ) by writing @xmath330 as @xmath331 , and @xmath332 as @xmath333 .    now equation ( [ weak efficient ] )",
    "becomes    @xmath334    * suppose for some weight , let s say @xmath335 , we have + @xmath336 + with @xmath337 , and @xmath324 .",
    "therefore * * @xmath338 .",
    "since equation ( [ alpha big ] ) is bounded above by @xmath339 , we now have an upper bound for the first term : + @xmath340 + that is , @xmath341 are points whose heights in the @xmath231 weight hyperbolic space lie in an interval of width no bigger than @xmath300 ( because @xmath342 lies in a ball of diameter @xmath300 ) , and @xmath343 + by lemma [ ca nt move far in h2 ] , @xmath344 * * since @xmath324 , lemma [ mixing ] says @xmath345 , which makes @xmath346 * if the first possibility does nt occur , then for every weight @xmath347 , we must have @xmath348 + with @xmath349 , @xmath350 , but @xmath351 .",
    "we fix such an @xmath352 . then * *",
    "@xmath353 . since the equation ( [ beta is big ] )",
    "is bounded above by @xmath339 , we obtain an upper bound for the second term on the right hand side : @xmath354 + by inductive hypothesis , @xmath355 * * finally , since @xmath351 , lemma [ mixing ] says @xmath356 which means @xmath357      this subsection is based on definition 4.5 and lemma 4.6 in @xcite , where @xmath358-efficiency was defined . here",
    "we note the consequence of an efficient segment in a non - degenerate , split abelian - by - abelian group .    _",
    "( @xmath358-efficient at scale @xmath359 ) _ let @xmath3 be a metric space , and @xmath360 \\rightarrow y$ ] a rectifiable curve .",
    "we say that @xmath196 is @xmath358-efficient at scale @xmath359 , @xmath361 if @xmath362    note that being efficient at scale @xmath169 does necessarily not imply efficient at all sales @xmath363 .",
    "efficiency provides with us the closest description of being ` straight ' in @xmath364 , whose meaning is made precise by the following lemma .",
    "[ efficient in rn ] if @xmath365 \\rightarrow \\mathbb{r}^{n}$ ] is @xmath358-efficient at scale @xmath169 , then @xmath366    let @xmath367 , and @xmath368 so that @xmath369 .",
    "let @xmath370 be the orthogonal projection of @xmath196 onto @xmath371 , @xmath372 , so @xmath373 .",
    "since @xmath374 , @xmath375 , @xmath376 , and lemma [ triangle in rn ] in the appendix gives that @xmath377 .",
    "so if @xmath378 , let @xmath379 be the closest point in @xmath380 , we then have @xmath381 . similarly for @xmath382 , there is a @xmath383 such that @xmath384 , with @xmath385 , then @xmath386 .",
    "the purpose of this subsection is to prove the following lemma which roughly says that given a @xmath358 , if a path is sufficiently long , then it is @xmath358-efficient on some scale .",
    "[ efficiency scale ] let @xmath16 be a non - degenerate , split abelian - by - abelian group . take any @xmath387 , @xmath388 , @xmath389 .",
    "if @xmath390 \\rightarrow g$ ] is @xmath0 quasi - geodesic satisfying has to be sufficiently big with respect to given @xmath391 , @xmath358 and @xmath392 . ]",
    "@xmath393 then there is a scale @xmath394 such that @xmath395 where @xmath396 , and @xmath397 .",
    "the idea of the proof is as follows : if a segment is not efficient , then by subdividing and adding up the distance between consecutive pairs of points in the subdivision , the sum exceeds the distance between end points of the original segment by a fixed proportion .",
    "in other words , lack of efficiency increases length .",
    "however this can not happen at every scale ( bigger than @xmath398 , where @xmath148 is the additive constant of the quasi - geodesics ) , because to every subdivision , the sum of distance between successive pairs of points is bounded above by the length of the curve .",
    "we now proceed with the proof .",
    "first note that the condition on @xmath399 in relation to @xmath358 , @xmath399 and @xmath392 is the same as    @xmath400    if @xmath196 @xmath358-efficient at scale @xmath401 , we can take @xmath402 , @xmath403 and we are done .",
    "otherwise , let @xmath404 be an increasing sets of points on @xmath405 such that    1 .",
    "@xmath406 , @xmath407 , @xmath408 2 .",
    "@xmath409 , where @xmath410    we note here that for each @xmath411 between @xmath412 and @xmath6 , @xmath413}$ ] lies in a ball of diameter @xmath414 , we must have @xmath415 by proposition [ ca nt move far in r2r3 ] .",
    "therefore    @xmath416    and    @xmath417 \\ } \\right| \\geq \\frac{l } { ( \\hbar r_{b})(2\\kappa)}\\ ] ]    thus if we denote @xmath418 by @xmath419 ,    @xmath420    which we note is a lower bound that depends only on @xmath421 and the group @xmath16 .",
    "let @xmath422 be an integer between @xmath412 and @xmath6 . by construction , for any @xmath423 , @xmath424 , there are @xmath425 , @xmath426 such that @xmath427 , @xmath428 .",
    "then @xmath429    if however the segment of @xmath430}$ ] is not @xmath358-efficient on scale @xmath431 , then @xmath432 this means @xmath433 where @xmath434 are those integer",
    "@xmath383 between @xmath412 and @xmath435 such that @xmath430}$ ] is not @xmath358-efficient on scale @xmath431 .",
    "denote @xmath436 by @xmath437 the above says @xmath438    hence @xmath439    dividing both sides by @xmath440 , and let @xmath441 be the proportion of elements in @xmath442 that are not @xmath358-efficient at scale @xmath443 , we have by equation ( [ lower bound ] ) @xmath444    since we stop at @xmath408 , @xmath445    where we used equations ( [ lstop ] ) and ( [ lower bound ] ) in the last inequality .",
    "the right hand side of ( [ efficient scale sum ] ) has at least @xmath446 terms , so for some @xmath447 , @xmath448 , which means the proportion of segments in @xmath449 that are not @xmath358-efficient at scale @xmath450 is at most @xmath451 .",
    "the desired @xmath452    [ efficiency scale multiple ] let @xmath16 be a non - degenerate , split abelian - by - abelian group . take any @xmath453 , @xmath388 , @xmath389 , and let @xmath454 be a finite set of @xmath0 quasi - geodesics . if every element of @xmath455 , @xmath456 \\rightarrow g$ ] satisfies @xmath457 then there is a scale @xmath394 and a subset @xmath458 such that    1 .",
    "@xmath459 2 .   for every @xmath460 , @xmath461 where @xmath462 , and @xmath463 .",
    "we apply lemma [ efficiency scale ] to each element of @xmath455 and stop at equation ( [ efficient scale sum ] ) .",
    "that is , for every @xmath464 , we have @xmath465 therefore @xmath466    for the same reason as in lemma [ efficiency scale ] , the right hand side of equation ( [ efficien scale sum multiple ] ) has at least @xmath446 terms , so for some @xmath467    @xmath468 let @xmath469 be those @xmath470 whose @xmath471 value is more than @xmath472 . applying chebyshev inequality",
    "we see that @xmath473    the claim is obtained by setting @xmath458 as the complement of @xmath469 .",
    "the following lemma says that given an efficient segment , most subsegments of length sufficiently larger than the efficient scale are efficient .    [ lots of efficient segments ] let @xmath196 be a rectifiable curve in a metric space y whose end points are @xmath399 apart .",
    "suppose @xmath196 is @xmath358-efficient at scale @xmath450 .",
    "let @xmath474 be a subdivision of @xmath196 such that for some @xmath475 $ ] , the distance between successive subdivision points satisfies @xmath476 .",
    "then provided @xmath477 , at least @xmath478 proportion of the subsegments @xmath479 } \\}$ ] are @xmath480 efficient at scale @xmath450 .",
    "let @xmath481},\\frac{1}{2}\\epsilon^{1/4}d(q_{i},q_{i+1}))$ ] . then @xmath482 .",
    "write @xmath483 , @xmath484 , @xmath485 etc . with this notation",
    "we can write    @xmath486    for each @xmath383 , write @xmath487 , @xmath488 . then * either * @xmath489 * or * @xmath490 in which case we denote the set of all such @xmath491 s as @xmath87 .",
    "note that the cardinality of the coarser division points @xmath492 .",
    "@xmath196 being efficient means @xmath493 hence    @xmath494    therefore @xmath495 , giving us a bound on @xmath496 , the proportion of @xmath87 , as @xmath497      _",
    "( @xmath49-monotone ) _ let @xmath16 be a split abelian - by - abelian group , and @xmath298 \\rightarrow g$ ] a @xmath498 quasi - geodesic segment such that there exists a line segment @xmath499 satisfying @xmath500 , for some @xmath501 .",
    "let @xmath502 be the map that sends every point of @xmath503 to the closest point on @xmath216 by orthogonal projection .",
    "we say that @xmath168 is    * @xmath49-monotone , if @xmath504 and @xmath505 * @xmath506 weakly monotone if for @xmath507 , @xmath508 @xmath509 + note that the definition of weakly monotone is not symmetrical to both end points : it s biased towards the starting point @xmath510 .",
    "the following says that in the case of a non - degenerate group , a monotone quasi - geodesic is close to a geodesic segment .",
    "[ close to being straight ] let @xmath16 be a non - degenerate , split abelian - by - abelian group , and @xmath360 \\rightarrow g$ ] a @xmath0 quasi - geodesic whose @xmath237 image is @xmath358-efficient .",
    "suppose that with respect to @xmath511 , @xmath196 lies outside of the @xmath512-linear @xmath513 neighborhood of the set of walls based at @xmath511",
    ". then    1 .",
    "@xmath196 is within @xmath514 here can be taken as latexmath:[$2    hausdorff neighborhood of a straight geodesic segment when @xmath196 is @xmath49 monotone .",
    "@xmath196 is in @xmath516-linear @xmath517 can be taken as @xmath518 neighborhood of a straight geodesic when @xmath196 is @xmath519 weakly monotone .",
    "recall that @xmath94 is the set of roots of @xmath16 .",
    "note that a monotone path is efficient by definition .",
    "so being close to a geodesic segment is the same as asking that the movement of the path along @xmath32 direction is not too big",
    ". we will prove proposition [ close to being straight ] by using the observation that for a monotone path in @xmath16 , admitting a geodesic approximation is the same as saying that for any root @xmath95 , its @xmath520 image admits a ( vertical ) geodesic approximations .",
    "the next lemma sets out one scenario where we have ( vertical ) geodesic approximation in @xmath521 recall that @xmath130 is @xmath522 , where @xmath124 is a nilpotent matrix with polynomial entries .",
    "we coordinatize points in @xmath523 as @xmath524 , where @xmath525 , and @xmath526 .",
    "let @xmath309 denotes for the projection @xmath527 .",
    "[ lemma a1 - 2 ] let @xmath528 , where @xmath529 , be points in @xmath523 such that for some @xmath530 , @xmath531 , @xmath532 . for @xmath533 , let @xmath534 denote the distance between @xmath535 and the vertical geodesic passing through @xmath536 ; for @xmath537 , let @xmath534 denote for the distance between @xmath535 and the vertical geodesic passing @xmath538 .    1 .",
    "if for all @xmath383 , @xmath539 , and @xmath540 , then there is a geodesic @xmath541 such that @xmath542 , for all @xmath383 .",
    "2 .   if for all @xmath383 , @xmath543 , where @xmath198 and @xmath544 , then there is a geodesic @xmath541 such that @xmath545 .",
    "we first produce geodesic @xmath546 and @xmath547 that stay close to @xmath548 and @xmath549 respectively .",
    "then we show that @xmath546 and @xmath547 meet at some @xmath379 , @xmath550 and set @xmath541 to be the union between @xmath551 and @xmath552 .",
    ". we can assume without the loss of generality that @xmath554 .",
    "note that the distance between a point @xmath555 and the vertical geodesic passing through @xmath556 is @xmath557 by equation ( [ distance ] ) .",
    "* then , by equation ( [ property of u ] ) , for @xmath558 , @xmath559 hence for all @xmath560 , @xmath561 + let @xmath546 be the geodesic passing through @xmath562 .",
    "then for @xmath560 , @xmath563 * for @xmath564 , again by equation ( [ property of u ] ) @xmath565 hence @xmath566 note that under the assumptions of ( i ) or ( ii ) , @xmath567 exists .",
    "so for all @xmath568 , @xmath569 let @xmath547 be the vertical geodesic passing through @xmath570 . then for @xmath571 , @xmath572    1 .   in this case ,",
    "@xmath573 for all @xmath574 ; @xmath575 for all @xmath576 .",
    "in particular , @xmath577 . since @xmath578 ,",
    "the height at which @xmath546 and @xmath547 come together is at most @xmath579 by assumption , therefore @xmath541 as defined above satisfies the required condition .",
    "2 .   in this case ,",
    "@xmath580 for @xmath560 ; @xmath581 for @xmath582 .",
    "in particular , @xmath583 , so the height at which @xmath546 and @xmath547 come together occurs no higher than @xmath584 .",
    "since @xmath585 , @xmath541 therefore satisfies the required condition .",
    "we now proceed to prove proposition [ close to being straight ] by showing that if a path is monotone , then for any root @xmath231 , its @xmath520 image satisfies the hypothesis of lemma [ lemma a1 - 2 ] .",
    "_ of proposition [ close to being straight ] _    set    * @xmath586 * @xmath587 * @xmath588   \\mbox {      } | \\mbox {    } h_{\\overline{ab } } \\circ \\pi_{a } \\circ \\lambda(t ) = js\\}$ ]    therefore for @xmath589 $ ] , we must have @xmath590 $ ] .",
    "since @xmath591 , the set @xmath592 \\}$ ] lies in a ball of diameter at most @xmath593 , which means @xmath594 by proposition [ ca nt move far in r2r3 ] .    1 .   in the case that @xmath196 is @xmath49 monotone , @xmath595 2 .",
    "if @xmath196 is @xmath596 weakly monotone @xmath597    therefore @xmath598    where @xmath599 when @xmath196 is @xmath49-monotone ; and @xmath600 when @xmath196 is @xmath596 weakly monotone .    by assumption , @xmath196 lies outside of @xmath601-linear @xmath513 neighborhood of the set of walls based at @xmath511 . since @xmath602 for any root @xmath603 .",
    "the claims now follow from application of lemma [ lemma a1 - 2 ] to @xmath604 in the @xmath603 weight hyperbolic space for each root @xmath603 .",
    "we now prove the main lemma in this subsection which roughly says that given @xmath605 , a sufficiently long quasi - geodesics whose @xmath237 image is @xmath358-efficient , is @xmath49-monotone at some scale .    [ monotone scale ]",
    "let @xmath16 be a non - degenerate , split abelian - by - abelian group .",
    "for any @xmath387 , @xmath606 , @xmath607 , and @xmath608 , if @xmath298 \\rightarrow g$ ] is a @xmath498 quasi - geodesic satisfying    1 .",
    "@xmath609 is @xmath358-efficient at scale @xmath610 , where @xmath611 2 .",
    "is sufficiently big with respect to given data . ]",
    "@xmath612    then there are scales @xmath613 such that for @xmath614 , @xmath615    where @xmath177 is the statement either not @xmath49-monotone , or is monotone but of opposite direction to the @xmath49-monotone segment in @xmath616 to which it is a subset of .",
    "the idea of the proof is similar to that of lemma [ efficiency scale ] .",
    "suppose the @xmath237 image of a segment is efficient but the segment itself fails to be @xmath49 monotone .",
    "then we can find two points whose @xmath237 images are close to each other , but the distance between the two points is very large . by proposition",
    "[ ca nt move far in r2r3 ] , this means there must be some point in between those two points whose @xmath237 image is far away from the @xmath237 images of those two points .",
    "this means that after a subdivision to the @xmath237 of the segment , the sum of the distance between consecutive points exceeds the distance of its end points by some pre - determined amount . in other words ,",
    "not monotone gains length .",
    "but the length of the @xmath237 image is bounded , a quasi - geodesic can not fail to be monotone at smaller and smaller scales .",
    "+ first we note that the conditions on @xmath399 in relation to @xmath617 , @xmath358 , @xmath49 and @xmath392 is the same as    @xmath618    the conditions on @xmath358 means that we have    1 .",
    "@xmath619 2 .",
    "@xmath620 3 .",
    "@xmath621    write @xmath622 .",
    "if @xmath298 \\rightarrow g$ ] itself is @xmath49 monotone , we are done .",
    "otherwise let @xmath623 be an increasing sets of points on @xmath168 such that    1 .",
    "@xmath624 , @xmath625 2 .   for @xmath626 , @xmath627 , where @xmath628 .",
    "note @xmath629 .",
    "3 .   @xmath630    let @xmath631 .",
    "@xmath632 is a subdivision of @xmath503 .",
    "the distance between consecutive points satisfies @xmath633 .",
    "we also have @xmath634 $ ] .",
    "therefore by lemma [ lots of efficient segments ] , there is a subset @xmath635 } \\}$ ] , with @xmath636 } \\}|$ ] , such that whenever @xmath637 }   \\in \\mathcal{g}_{i}$ ] , it is @xmath480 efficient at scale @xmath431 .",
    "we define the following :    * @xmath638 } \\in \\mathcal{g}_{i } \\}$ ] is the set of subsegments produced by @xmath639 whose @xmath237 images are @xmath480 efficient at scale @xmath450 . *",
    "@xmath640 , is those subsegments whose @xmath237 images are not @xmath480 efficient at scale @xmath450 .",
    "note @xmath641 * @xmath642 } \\mbox { \\textit{is not } } \\delta \\mbox { \\textit{monotone } } \\ } $ ] is those segments whose @xmath237 images are @xmath480 efficient at scale @xmath450 but fails to be @xmath49 monotone .",
    "* @xmath643 be the proportion of subsegments that are @xmath480-efficient at scale @xmath443 but fails to be @xmath49 monotone .",
    "* for @xmath644 , @xmath645 } \\subset \\zeta_{[p_{j}^{i},p_{j+1}^{i}]},\\newline \\mbox { \\textit{but those two have opposite orientations } } \\}$ ] are basically those subsegments produced by @xmath646 that are @xmath49 monotone and belong to a @xmath49 monotone subsegment produced by @xmath647 but their orientations do not agree .",
    "* @xmath648 * @xmath649 be the proportion of subsegments that are @xmath480-efficient at scale @xmath443 and @xmath49 monotone but of wrong orientation . *",
    "write @xmath650 and note that @xmath651    since @xmath168 is not @xmath49-monotone , there are two points @xmath652 $ ] such that    1 .",
    "this means @xmath654 because @xmath609 is @xmath358-efficient on scale @xmath450 , which means the hausdorff distance between @xmath609 and @xmath655 is at most @xmath656 .",
    "+ and 2 .   @xmath657 . by proposition",
    "[ ca nt move far in r2r3 ] , this means @xmath658 $ ] such that @xmath659 for @xmath660 in light of([a ] )    equations ( [ a ] ) and([b ] ) together means",
    "@xmath661    i.e. @xmath662    where we used property ( i ) for the last inequality and recalled that @xmath663 .",
    "now for each @xmath664 , @xmath665 ,    * either @xmath666 . in this case @xmath667}$ ] is @xmath480 efficient at scale @xmath450 but not @xmath49-monotone . +",
    "then there are two points @xmath668 $ ] such that 1 .",
    "@xmath669 + this means that @xmath670 by lemma [ efficient in rn ] . + therefore by property ( ii ) in the hypothesis + @xmath671 + and 2 .   @xmath672 . by proposition",
    "[ ca nt move far in r2r3 ] , this means @xmath658 $ ] such that @xmath673 for @xmath660 in light of ( [ aa ] ) + say @xmath674 , @xmath675 , then ( [ aa ] ) together with [ bb ] imply that @xmath676 where we have set constants @xmath677 to satisfy + @xmath678 + summing over all @xmath666 we have + @xmath679 + that is , @xmath680 * or @xmath681 . in this case @xmath682}$ ] is @xmath49-monotone .",
    "write @xmath674 , @xmath683 , then + @xmath684 + summing over all @xmath681 we have + @xmath685 + that is , @xmath686 * or @xmath687 .",
    "write @xmath674 , @xmath683 , then + @xmath688 + summing over all @xmath687 we have + @xmath689    putting ( [ those in c ] ) , ( [ those in c - b ] ) and ( [ those in nc ] ) together , we have @xmath690    by equation ( [ property of hi ] ) , @xmath691 satisfies @xmath692 by property ( iii ) in the hypothesis on @xmath358 and @xmath49 , @xmath693 , so we can take @xmath694 , hence    @xmath695     + write @xmath696 , and using ( [ gaining length ] ) we have    @xmath697    divide both sides by @xmath698    @xmath699    since @xmath628 for @xmath626 , @xmath700 , @xmath701 .",
    "the condition on @xmath702 means @xmath703    by equation([larret ] ) , we have @xmath704 .",
    "so equation ( [ sum of scales for monotone ] ) implies that for some @xmath705 we must have @xmath706 recall that @xmath707 is the proportion of efficient subsegments produced by @xmath708 that are not monotone , and @xmath709 is the proportion that are monotone but of the wrong orientation .",
    "the desired @xmath710 , @xmath711    [ monotone scale multiple ] let @xmath16 be a non - degenerate , split abelian - by - abelian group . take any @xmath712 , @xmath713 , @xmath607 , and @xmath608 , and let @xmath714 be a finite set of @xmath0 quasi - geodesics . if every element of @xmath455 , @xmath715 \\rightarrow g$ ] satisfies the following :    1 .",
    "@xmath716 is @xmath358-efficient at scale @xmath610 , where @xmath611 2 .",
    "@xmath717    then there are scales @xmath613 , and a subset @xmath718 such that    1 .",
    "@xmath719 2 .   for every @xmath720 , and @xmath614 , @xmath615 + where @xmath177 is the statement either not @xmath49-monotone , or is monotone but of opposite direction to the @xmath49-monotone segment in @xmath616 to which it is a subset of .",
    "we apply lemma [ monotone scale ] to each element of @xmath721 since its elements are all @xmath0 quasi - geodesics .",
    "we arrive at equation ( [ sum of scales for monotone ] ) for each element of @xmath455 .",
    "that is ,    @xmath722    therefore    @xmath723    counting the number of terms on the right hand side means that for some @xmath724 , @xmath725    let @xmath469 consist of those @xmath168 whose @xmath726 or @xmath727 values is more than @xmath472 .",
    "the desired claim is obtained after applying chebyshev inequality and setting @xmath458 as the complement of @xmath469 , and @xmath728 , @xmath729 .      in the previous subsection we showed the existence of a @xmath49-monotone scale . in this subsection , we write @xmath16 for a non - degenerate , split abelian - by - abelian group , and we will see that by chaining a lot of @xmath49-monotone segments together , we end up with a path that is weakly monotone .",
    "[ uniform set ] let @xmath16 be a non - degenerate , split abelian - by - abelian group .",
    "let @xmath298 \\rightarrow g$ ] be a @xmath498 quasi - geodesic segment that is @xmath49-monotone .",
    "suppose for some @xmath730 , @xmath731    where @xmath177 is the statement `` not @xmath49 monotone , or is @xmath49 monotone but with opposite orientation from @xmath168 '' .",
    "for a point @xmath732 , define @xmath733    we say @xmath136 is ( m ) _ uniform along @xmath168 _ if for all @xmath734 , @xmath735 where @xmath736 satisfies @xmath737 .",
    "the main lemma of this subsection is :    [ how to show weakly monotone ] let @xmath168 be a @xmath49-monotone @xmath0 quasi - geodesic in @xmath16 .",
    "suppose @xmath732 is a uniform point , with @xmath738 , @xmath739 .",
    "then @xmath168 consider as a @xmath498 quasi - geodesic leaving @xmath136 at @xmath740 is @xmath741 weakly monotone .",
    "let @xmath309 denote the projection of @xmath503 onto the straight line joining the end points of @xmath503 .",
    "then up to time @xmath742 , provided @xmath743 , at most @xmath66 proportion of segments in @xmath744 belong to @xmath745 , and at least @xmath58 proportion are @xmath49 monotone .",
    "therefore @xmath746 so @xmath503 moves at a linear rate .    for any @xmath747 , let @xmath748 be the smallest and largest number @xmath146 such that @xmath749 .",
    "let @xmath411 denotes the proportion of @xmath750 in between @xmath751 and @xmath752 that belongs to @xmath753 .",
    "either @xmath754 , in which case @xmath755 ; or @xmath756 , in which case we have @xmath757 which means @xmath758 . on the other hand , we also know that @xmath759 , therefore @xmath760    that is , whenever @xmath761 , we must have @xmath762 .",
    "the following lemma provides us with abundant supply of uniform points .",
    "[ big uniform set ] let @xmath168 be a @xmath49-monotone @xmath0 quasi - geodesic in @xmath16 .",
    "then the proportion of non-@xmath736 uniform points in @xmath763 is at most @xmath764 .    write @xmath765 as the union of all segments in @xmath766 , @xmath392 as the measure of the union of all the segments in @xmath767 , and @xmath768 , such that @xmath769    then the collection of all such interval @xmath770 forms a cover for the set of non - uniform points .",
    "choose a subcover so that @xmath771",
    ". then @xmath772 now divide both sides by @xmath392 .",
    "[ general uniform ] let @xmath168 be a quasi - geodesic segment that lies within @xmath773-linear neighborhood of a geodesic segment , where @xmath774 . in light of lemma",
    "[ how to show weakly monotone ] , we may call a point @xmath775 as a @xmath66-uniform point if the subsegments of @xmath168 of length @xmath776 , viewed as quasi - geodesics starting from @xmath158 , lies in @xmath777-linear neighborhood of geodesic segments for some @xmath778 .    by abuse of notation , from now on , when we say a point @xmath158 is @xmath736 uniform with respect to a quasi - geodesic segment for some @xmath779 , we mean definition",
    "[ uniform set ] ; if we say @xmath158 is @xmath66 uniform , where @xmath780 , we mean remark [ general uniform ] .",
    "so far our results from previous sections only require the group to be non - degenerate and split abelian - by - abelian . from now on",
    ", we will require all our groups to be unimodular .",
    "[ finite number of qigeodesics close to geodesics ] let @xmath277 be non - degenerate , unimodular , split abelian - by - abelian lie groups , and @xmath25 be a @xmath0 quasi - isometry .",
    "then , to any @xmath278 , there are numbers @xmath46 , @xmath781 , and @xmath782 depending on @xmath281 , and @xmath26 , with the following properties :    if @xmath52 is a product of intervals of equal size at least @xmath53 , by writing    * @xmath783 as the @xmath27 images of points in @xmath40 , * @xmath784 ) } \\mathcal{s}(\\zeta , \\hbar \\rho_{s } \\rho_{b } |\\zeta|)$ ] as the union of subsegments obtained by dividing each @xmath785 $ ] at scale @xmath786 .    then ,    1 .",
    "there is a subset @xmath787 , with @xmath788 , 2 .",
    "there is also a subset @xmath789 , with @xmath790    such that for every @xmath791 , amongst all elements in @xmath792 containing @xmath158 , at least @xmath793 proportion of them belong to @xmath794 , and of those , a further @xmath795 proportion admit geodesic approximation .",
    "that is , if @xmath197 is in this set , then it is within @xmath796-linear neighborhood of a geodesic segment that makes an angle of at least @xmath293 with root kernel directions .",
    "here @xmath51 , @xmath797 , @xmath798 as @xmath50 , @xmath49 , @xmath51 approach zero .",
    "recall that @xmath200 , @xmath799 , where @xmath800 , @xmath32 , @xmath801 , @xmath33 are all are abelian , and @xmath802 is the set of roots of @xmath24 .",
    "first , we choose the following constants :    * @xmath803 such that @xmath804 , * @xmath805 * @xmath806 * @xmath807 * @xmath391 such that @xmath808 * @xmath46 such that @xmath809 * @xmath810 .",
    "let @xmath52 be a product of intervals of equal size at least @xmath811 .",
    "we will build @xmath812 from the @xmath27 images of @xmath813 } \\mathcal{p}(\\zeta)$ ] .",
    "let @xmath814)$ ] , and apply lemma [ efficien scale sum multiple ] to @xmath455 and @xmath815 to obtain a scale @xmath816 and subset @xmath458 such that @xmath817    write @xmath818 for the union of @xmath819 as @xmath168 ranges over @xmath455 , and @xmath820 for the subset of @xmath818 that are @xmath358-efficient at scale @xmath443 .",
    "the above equation says @xmath821 .",
    "each element of @xmath820 is the @xmath237 image of a subsegment of @xmath822)$ ] .",
    "let @xmath823 be the @xmath237 pre - images of @xmath820 .",
    "that is , @xmath824 means @xmath825 .",
    "we now apply lemma [ monotone scale multiple ] to @xmath823 , and again taking @xmath815 , to obtain scales @xmath826 , @xmath827 and a subset @xmath828 such that    @xmath829    in other words , setting @xmath792 as the union of @xmath830 where @xmath168 ranges over all @xmath455 , we have obtained a subset @xmath831 whose measure is at least @xmath832 that of @xmath792 , and each element in @xmath831 is @xmath49 monotone .",
    "recall that @xmath833 , and for those @xmath834 such that @xmath835 , the intersection between the union of elements in @xmath455 and @xmath836 has full measure .",
    "since @xmath40 has small boundary area compared to its volume , and the ratio of @xmath617 to @xmath46 is a function of @xmath49 that goes to zero as @xmath49 approaches zero , we have a subset @xmath837 with relative measure at least @xmath285 whose elements make an angle at least @xmath293 with root kernels . here",
    "@xmath294 goes to zero as @xmath51 and @xmath49 approach zero .",
    "let @xmath838 be those images coming form a point in @xmath244 at least @xmath839 away from @xmath840 .",
    "we will extract those points of @xmath841 that are @xmath736 uniform with respect to at least @xmath300 proportion of those elements in @xmath794 that contain it .",
    "we will then choose @xmath300 appropriately so that the relative proportion of @xmath842 is small and depends on our input data .    to begin , we note that the incident relation between @xmath841 and @xmath794 is symmetrical .",
    "moreover we know that for any two points in @xmath841 , the ratio of numbers of elements in @xmath794 containing each of them is bounded by @xmath843 .",
    "for any two elements of @xmath792 , the ratio of numbers of points in @xmath841 lying on each of them is bounded by @xmath844 .    for @xmath845 ( resp .",
    "@xmath846 ) write @xmath847 ( resp .",
    "@xmath848 ) for the set of elements in @xmath794 ( resp .",
    "@xmath841 ) incident with @xmath158 ( resp .",
    "@xmath168 ) . let @xmath849 consisting of points that fails to be @xmath736-uniform with respect to at least @xmath300 proportion of elements in @xmath847 .",
    "we know that for @xmath846 , the proportion of non @xmath736-uniform points is at most @xmath764 .",
    "let @xmath850 denote for the characteristic function of the subset of @xmath851 consisting of pairs @xmath852 such that @xmath158 fails to be @xmath736-uniform of @xmath168 . then , starting from @xmath853    we have    @xmath854 and    @xmath855    therefore @xmath856 . by choosing @xmath857",
    ", we have @xmath858 . setting @xmath859 as @xmath860 .",
    "the desired claim now follows after lemma [ how to show weakly monotone ]",
    ".    we can now prove theorem [ existence of good boxes ] .",
    "_ theorem [ existence of good boxes ] _ we apply proposition [ finite number of qigeodesics close to geodesics ] to @xmath250 to obtain two scales : @xmath861 , @xmath862 , and a subset @xmath863 , such that if @xmath864 , then @xmath168 is within @xmath865-linear neighborhood of a geodesic segment that makes an angle of at least @xmath866 with root kernel directions .    for each @xmath867 , the pre - images of @xmath868 under @xmath27 are subsegments @xmath869 whose union is @xmath197 , whose lengths lie between @xmath870 and @xmath871 . furthermore , the subset @xmath872 has large measure .",
    "if for some @xmath873 , an element @xmath874 satisfies @xmath875 , then @xmath292 is within @xmath876-linear neighborhood of another geodesic segment . since @xmath877 , the subset @xmath878 has relative measure of at least @xmath879 , where @xmath880 as @xmath881 .",
    "we now tile @xmath40 by @xmath882 : @xmath883    where @xmath884 .",
    "note that the union of @xmath885 with the subset of @xmath250 consists of elements lying in @xmath69 is @xmath250 .",
    "set @xmath886 .",
    "the ` favourable ' boxes are going to be those tiling boxes that have most of their geodesics belonging to @xmath887 .",
    "that is , we set @xmath888 hence @xmath889",
    "in this section we explore the consequences of having geodesic approximations to a large percentage of geodesic segments in a box , and extend theorem [ existence of good boxes ] to the following :    * theorem [ exisence of standard maps in small boxes ] * _ let @xmath16 , @xmath24 be non - degenerate , unimodular , split abelian - by - abelian lie groups , and @xmath44 be a @xmath0 quasi - isometry . given @xmath45 , there exist numbers @xmath46 , @xmath47 , @xmath48 depending on @xmath49 , @xmath50 , @xmath51 and @xmath26 with the following properties : _    _ if @xmath52 is a product of intervals of equal size at least @xmath53 , then a tiling of @xmath40 by isometric copies of @xmath890 _",
    "@xmath55    _ contains a subset @xmath56 of @xmath57 with relative measure at least @xmath58 such that _    1 .",
    "_ for every @xmath59 , there is a subset @xmath891 of relative measure at least @xmath62 _ 2 .   _",
    "the restriction @xmath63 is within @xmath64 hausdorff neighborhood of a standard map @xmath65 . _",
    "_ here , @xmath66 , @xmath67 and @xmath68 all approach zero as @xmath51 , @xmath49 go to zero . _",
    "we now observe those geometric properties of non - degenerate , unimodular , split abelian - by - abelian groups relevant to theorem [ exisence of standard maps in small boxes ] .",
    "specifically , this subsection explores some implications of our knowledge that a large percentage of geodesics in a box admit geodesic approximations to its @xmath27 images .    [ how to tell they are on the same flat ] let @xmath16 be a non - degenerate , split abelian - by - abelian group , and @xmath197 , @xmath168 are geodesic segments in @xmath16 making an angle of at least @xmath293 with root kernels such that for some @xmath892 , @xmath893 proportion of their lengths .    if not , then there is a root @xmath231 such that @xmath894 and @xmath895 disagrees for more than @xmath896 of their length . but",
    "this means that @xmath897    which is a contradiction because @xmath898 .",
    "let @xmath16 be a non - degenerate , split abelian - by - abelian lie group .",
    "we define the following objects in @xmath16 .    1",
    ".   a * 2-simplex * @xmath765 is a set of three geodesic segments that intersect pair - wisely .",
    "this includes the degenerate case of a geodesic segment and two subsegments of it .",
    "elements of @xmath765 are called * edges * of @xmath765 .",
    "a * filled 2-simplex * @xmath899 is a set of 2-simplicies @xmath900 such that for every @xmath218 , every two edges of @xmath901 are subsegments of two edges of @xmath765 .",
    "the edges of @xmath765 are called * faces * or * edges * of @xmath899 .",
    "+    + for @xmath902 , we define 3 .",
    "a * i - simplex * @xmath765 as a set of @xmath903 many filled @xmath904-simplicies such that they intersect pair - wisely at their at their @xmath905 faces .",
    "this includes the degenerate case of a set of @xmath903 many @xmath904-simplicies .",
    "elements of @xmath765 are called * * ( @xmath904)-face**s of @xmath765 .",
    "4 .   a * filled i - simplex * @xmath899 is a collection of @xmath906-simplicies @xmath907 such that for every @xmath218 , @xmath906 many faces of @xmath901 are subsets of @xmath906 many faces of @xmath765 . *",
    "faces of @xmath899 * refers to faces of @xmath765 .",
    "+     if the faces of a simplex behaves well under the quasi - isometry @xmath27 , that is , if @xmath27 images of those faces admit approximations by hyperplanes of appropriate dimensions , then we can approximate @xmath27 image of the simplex .",
    "this is the content of the next lemma , which deals with one instance where simplex approximations of a quasi - simplex ( image of a simplex under a quasi - isometry ) is possible .",
    "[ simplicies made out of good lines ] let @xmath16 be a non - degenerate , split abelian - by - abelian lie group and @xmath87 a family of geodesic segments such that    * @xmath908 * for @xmath909 , @xmath292 is within @xmath910 hausdorff neighborhood of another geodesic segment @xmath911 .",
    "we call @xmath911 a geodesic approximation of @xmath292 . * for some @xmath912 ,",
    "the direction of any two geodesic approximation makes an angle of at most @xmath866 , and their angles each makes an angle at least @xmath913 root kernels . * if @xmath914 , @xmath915 , and let @xmath911 , @xmath916 be geodesic approximations of @xmath292 and @xmath917 .",
    "then there is a subsegment @xmath918 such that @xmath919 .",
    "then for @xmath920 , the @xmath27 images of any @xmath906-simplex or filled @xmath906-simplex made out of elements of @xmath87 is within @xmath921 hausdorff neighborhood of another simplex or filled simplex of the same dimension lying on a flat .",
    "we prove the claims by induction on @xmath906 , starting with a 2-simplex , then filled 2-simplex followed by 3-simplex , filled 3-simplex etc .",
    "* 2-simplex * fix three geodesic approximations for @xmath27 images of edges of @xmath765 , and for each weight @xmath603 , look at the images of those geodesic approximations under @xmath922 .",
    "there are six possible configurations shown in figure  [ fig:6config ] below . to specify a 2-simplex on a flat that is close to these three geodesics",
    ", it is enough to specify the root space coordinates of this flat , and this is given by the root space coordinate of the dotted line in each configuration .    .",
    "the dotted line is the image of a 2-simplex close to the quasi-2-simplex . ]    * filled 2-simplex .",
    "* let @xmath923 , and @xmath924 , @xmath925 s denote for the 2-simplex approximation of @xmath926 , @xmath927 s , as given by * 2-simplex * case above .",
    "then for every two edges of @xmath925 , there are subsegments of two edges of @xmath924 such that each pair satisfy the hypothesis of lemma [ how to tell they are on the same flat ] .",
    "this means the flats housing @xmath924 and @xmath925 must come together ( because the conclusion of lemma [ how to tell they are on the same flat ] says that they lie on a common flat ) . since the the set where two flats come together is convex , we conclude therefore that there is a 2-simplex @xmath928 lying on the flat that houses @xmath924 such that @xmath929 , and two edges of @xmath928 are subsegments of two edges of @xmath924",
    ". then @xmath930 has the desired property .    *",
    "@xmath906-simplex * let @xmath931 where each @xmath932 is a filled @xmath904-simplex , and @xmath933 be their filled @xmath904 simplex approximations as yielded by the inductive hypothesis .",
    "then we know for each weight @xmath603 , @xmath934 is a vertical geodesic segment , and for any @xmath935 , @xmath934 , @xmath936 come together at some subsegment .",
    "if modulo @xmath896 proportion of the ends , @xmath937 s do not lie on a common vertical geodesic segment , then the relationship between @xmath934 , @xmath936 is that of a forking @xmath3 , see figure  [ fig : fork ] below .",
    "-simplex case in the proof of lemma [ simplicies made out of good lines ] : the solid and dotted lines represent @xmath934 and @xmath936 . ]    but this contradicts the existence of another @xmath938 that shares a face with @xmath933 and another face with @xmath939 .",
    "so modulo the @xmath896 proportion of their ends , @xmath934 , @xmath936 must lie on a common vertical geodesic .",
    "the same argument applied to every other weights means that we can translate each @xmath933 to @xmath928 so that @xmath928 , @xmath940 share a common face .",
    "the collection of all @xmath928 s forms our desired @xmath924 @xmath906-simplex .",
    ", which has diameter compatible to that of the diameter of the @xmath906-simplicies of concern , whereas in the 2-simplex case , the pair - wise intersection of edges consist of just one point for each pair , so the same forking argument would nt work there . ]    * filled @xmath906-simplex * let @xmath941 where each of @xmath765 and @xmath901 is a @xmath906-simplex , and let @xmath924 and @xmath925 s denote for @xmath906-simplex approximations of @xmath926 and @xmath927 s as yielded above .",
    "then for every @xmath906 faces of @xmath925 there are @xmath906 many corresponding faces of @xmath924 to which they are a subset of , and this means the corresponding subsegments of edges of faces of @xmath924 and the edges of faces of @xmath925 satisfy the hypothesis of lemma [ how to tell they are on the same flat ] , so they lie on a common flat .",
    "this means the flats housing @xmath924 and @xmath925 respectively must come together and since the set where two flats come together is a convex set , we conclude therefore that there is a @xmath906-simplex @xmath928 in the flat containing @xmath924 such that @xmath942 , and @xmath943 share @xmath906 of its faces with faces of @xmath924",
    ". then @xmath944 has the desired property .",
    "[ quadrilateral ] let @xmath945 .",
    "a @xmath50 * quadrilateral * @xmath946 in @xmath16 is a set of 4 oriented geodesic segments @xmath947 s satisfying the following :    1 .",
    "@xmath948 for which @xmath949 such that the directions of @xmath947 s are all parallel to @xmath950 2 .",
    "@xmath951 , latexmath:[$|\\mathbf{t}_{i}| > 2 \\eta \\sum_{j=0}^{3 }    3 .   for all @xmath218 ,",
    "* @xmath953 , * @xmath954 + where @xmath955 are the beginning and end points of @xmath947",
    ".    we will often refer to @xmath947 s as edges of @xmath149 , and write diam@xmath956 for the maximum length of its edges .",
    "* example * suppose the rank of @xmath16 is 1 .",
    "let @xmath957 denote for the two root class horocycles based at the identity element .",
    "let @xmath958 , @xmath959 , and the word @xmath960 represents a loop in @xmath961 .",
    "if we replace @xmath136 by @xmath962 , and @xmath963 by @xmath964 for some small @xmath965 and @xmath966 , we obtain a loop representing a quadrilateral .",
    "note that the same construction works if @xmath16 is rank 1 and non - unimodular , as long as there are two root classes .",
    "the first requirement of a quadrilateral means a quadrilateral exists in the subgroup @xmath967 ( or a left translate of it ) . since @xmath950 does not act trivially on any proper subspace , quadrilaterals exist when rank of @xmath16 is 2 or higher for the same reason that they exist rank @xmath968 spaces as illustrated by the previous example .",
    "[ orientation of a quadrilateral ] let @xmath969 be a @xmath50 quadrilateral .",
    "then the direction of @xmath947 and @xmath970 are positive multiple of each other , and that of @xmath947 and @xmath971 are negative multiple of each other .",
    "there are 16 possibilities to the relationship among directions of all the @xmath947 s ( being positive or negative multiples of each other ) .",
    "one checks that only the combination stated above is allowed .",
    "an argument is given in the appendix .",
    "let @xmath972 be a 1-parameter matrix consisting of blocks of the form @xmath973 where @xmath974 , @xmath124 a nilpotent matrix with polynomial entries , and @xmath975 be a semidirect product for which @xmath188 acts on @xmath976 by linear map @xmath977 .",
    "write an element of @xmath975 as @xmath978 , where @xmath188 , @xmath979 , and @xmath980 ( resp .",
    "@xmath981 ) for the direct sum of positive ( resp . negative ) eigenspaces of @xmath184 .",
    "[ quadrilateral word in rank 1 ] in @xmath975 , suppose for some @xmath198 , we have @xmath982 , @xmath983 , @xmath984 satisfying    * @xmath985 , @xmath532 * @xmath986 , @xmath532 * the word @xmath987 is trivial",
    ".    then @xmath988 .",
    "in particular this implies that the sizes of @xmath989 s are equal up to an error of at most @xmath990 .",
    "see appendix    [ structure of a quadrilateral ] let @xmath969 be a @xmath50 quadrilateral . then    1 .",
    "@xmath991 , @xmath992 2 .",
    "@xmath951 , @xmath993 3 .",
    "@xmath994 are within @xmath995 neighborhood of a coset of @xmath996 ( or @xmath997 ) if @xmath998(mod 2 ) , and of a coset of @xmath997 ( or @xmath996 ) otherwise .    modifying @xmath947 s by an amount of at most @xmath999 for all @xmath218 .",
    "furthermore , the divergent assumption between @xmath1000 and @xmath1001 means that @xmath1002 ( resp .",
    "@xmath997 ) if the direction of @xmath947 is positive ( resp .",
    "negative ) multiples of @xmath950 .",
    "the result now follows from lemma [ quadrilateral word in rank 1 ] .",
    "a schematic illustration for a quadrilateral with the correct orientation and lengths for its edges is given in figure  [ fig : quadrilateral ] below .",
    "[ close to a quadrilateral ] let @xmath1003 be a @xmath412-quadrilateral in @xmath16 , such that each @xmath1004 is properly contained in a geodesic segment @xmath1005 , whose @xmath27 image is within @xmath1006 with @xmath1007 .",
    "suppose further that each @xmath1008 .",
    "then , there is a @xmath68@xmath1009-quadrilateral @xmath1010 satisfying @xmath1011 .    for each @xmath383 ,",
    "let @xmath1012 be an geodesic approximation of @xmath1013 . since @xmath149 is a @xmath412-quadrilateral",
    ", @xmath1014 is a geodesic segment with positive length , therefore @xmath1015 , and @xmath1016 . by moving each @xmath1012 by an amount at most latexmath:[$\\sum_{\\iota }",
    "@xmath1012 s are all parallel to some @xmath950 with @xmath1018 , and @xmath1019 is a geodesic segment of positive length .",
    "let @xmath1020 be the subsegment closest to @xmath1021 .",
    "then @xmath1022 is a @xmath68-quadrilateral .      in this subsection",
    ", we put together some of the observations in the last two subsections to show that if a large percentage of geodesic segments in a box admit geodesic approximations to their @xmath27 images , then for @xmath1023 , a large percentage of @xmath218-hyperplanes in the box also admit @xmath218-hyperplane approximations to their @xmath27 images . in particular",
    ", there is a large subset of flats in the box whose @xmath27 images are close flats .",
    "+ the following averaging lemma that will be used repeatedly for the remaining of this section .",
    "[ ping - pong averaging ] let @xmath1024,@xmath1025 be two finite measure space , and @xmath1026 is a symmetric relation between them .",
    "for @xmath1027 , write @xmath1028 as the subset of @xmath186 consisted of elements related to @xmath1029 , and @xmath1030 , for @xmath1031 , as the subset of elements of @xmath184 related to @xmath411 .",
    "suppose @xmath1032 for any @xmath1033 , and @xmath1034 for any @xmath1035 .",
    "if for some @xmath1036 , @xmath1037 with @xmath1038 , then the subset @xmath1039 , satisfies @xmath1040 .",
    "see appendix .",
    "[ comment on ping - pong ] lemma [ ping - pong averaging ] will often be used to show that for subset @xmath1041 of relative large measure , the subset of @xmath186 consisting of elements @xmath1031 such that the measure of @xmath1042 is large relative to that of @xmath1030 , is large .",
    "[ lines of big angle ] let @xmath1043 be a @xmath1044-invariant measure on @xmath1045 .",
    "let @xmath1046 be an orthonormal basis of @xmath1047 and @xmath1048 be linear span of @xmath1049 , @xmath1050 as the common value of @xmath1051 in @xmath1052 .",
    "suppose for some @xmath1053 , @xmath42 is a subset with @xmath1054",
    ". then we can find @xmath1055 points @xmath1056 such that @xmath1057 , where @xmath1058 as @xmath1059 .",
    "equip @xmath1060 with the product measure @xmath1061 .",
    "then the relative measure of @xmath1062 is at least @xmath1063 .",
    "if the claim was not true , then @xmath42 is contained in a ball of radius @xmath1050 , and this would create a contradiction to the measure of @xmath1062 when @xmath1064 is sufficiently small .    [ bare minimum for flats to flats ]",
    "let @xmath200 , @xmath1065 be non - degenerate , unimodular , split abelian - by - abelian lie groups , and @xmath25 be a @xmath0 quasi - isometry .",
    "let @xmath52 be a product of intervals of equal size .",
    "inside of the box @xmath1066 , suppose for some @xmath945 there is a subset @xmath1067 $ ] , where @xmath1068 as @xmath881 , and @xmath1069|$ ] , where @xmath1070 is a function of @xmath50 and approaches zero as @xmath881 , such that for every @xmath1071 ,    1 .",
    "@xmath1072 is within @xmath1073 hausdorff neighborhood of a geodesic segment that makes an angle at least @xmath293 with root kernel directions . here",
    "@xmath51 depends on @xmath50 and approaches zero as @xmath881 .",
    "2 .   for each @xmath1071 ,",
    "the proportion of @xmath50 uniform points is at least @xmath1074 .",
    "then , for @xmath1075 , there are subsets @xmath1076 $ ] and functions @xmath1077 , together with a subset @xmath1078 and a function @xmath1079 that satisfy the the following properties .    1",
    ".   @xmath1077 s and @xmath1079 are functions of @xmath50 and approach zero as @xmath881 .",
    "2 .   if @xmath1080 , then @xmath1081 is within @xmath1082 hausdorff neighborhood of a @xmath218-dimensional hyperplane .",
    "3 .   for every @xmath1083 , @xmath1084 \\cap \\mathcal{l}^{0 } \\right|",
    "\\geq   ( 1-f_{1})^{2 } \\left| l(p ) \\cap \\mathcal{l}(\\omega)[m ] \\right|\\ ] ] and @xmath1085 , @xmath1086 \\cap \\mathcal{l } \\right| \\geq ( 1-f_{i})^{2 } \\left| l_{i}(p ) \\cap \\mathcal{l}_{i}(\\omega)[m ] \\right|\\ ] ] 4 .   the relative measure of @xmath1087 and @xmath1088 in @xmath1089 $ ] and @xmath244 are at least @xmath1090 and @xmath1091 respectively .",
    "more precisely , we prove the following claims :    for @xmath1075 , there are subsets @xmath1092 $ ] , @xmath1093 of @xmath244 , all of relative large measure such that    1",
    ".   elements of @xmath1094 admit @xmath1095 hyperplane approximations .",
    "@xmath1096 is defined to be @xmath1097 .",
    "2 .   if @xmath1098 , @xmath1099 , @xmath1100 , then a large proportion of elements in @xmath1101 lies in @xmath1094 . here",
    ", ` large ' means closer to @xmath968 as @xmath881 .",
    "elements of @xmath1102 admit @xmath218-hyperplane approximations .",
    "the proof proceeds in two steps .",
    "first , we construct @xmath1103 and subsets @xmath1104 by induction",
    ". then we use @xmath1105 to show that elements of @xmath1087 satisfies the desired properties .",
    "the set @xmath1088 will be the intersection of those @xmath1105 from the first step .",
    "we start with the base case when @xmath1106 .",
    "the incidence relation between @xmath235 $ ] and @xmath1107 $ ] is symmetrical .",
    "therefore , by lemma [ ping - pong averaging ] we can choose @xmath1108 appropriately so that the set    @xmath1109 : \\left|   l_{1}(s ) \\cap \\mathcal{l}(\\omega)[m ] \\cap \\mathcal{l}^{0 } \\right| \\geq ( 1-s_{2 } ) \\left| l_{1}(s ) \\cap \\mathcal{l}(\\omega)[m ] \\right| \\}\\ ] ]    satisfies    @xmath1110 \\right|\\ ] ]    fix a @xmath1111 .",
    "let @xmath1112 consisting of those points @xmath158 such that @xmath158 fails to be uniform with respect to at least @xmath1113 proportion of elements in @xmath1114 $ ] .",
    "note that this means if @xmath168 is not an element of @xmath1115 , then @xmath158 is not uniform with respect to @xmath168 .",
    "we obtain a bound on the relative size of @xmath1116 as follows .",
    "let @xmath850 be the characteristic function of the subset of @xmath1117 , p \\in \\zeta \\}$ ] consisting of pairs @xmath852 such that either @xmath1118 or @xmath1119 but @xmath158 fails to be a uniform point on it .",
    "then , starting from    @xmath1120 } \\chi =    \\sum_{\\gamma \\in l_(s ) \\cap \\mathcal{l}(\\omega)[m ] } \\mbox {       } \\sum_{p \\in p(\\gamma ) } \\chi\\ ] ]    we have @xmath1121 } \\chi & \\geq & \\sum_{x \\in p(s)^{bad } } s_{b } \\left| l(x ) \\cap l(s ) \\cap \\mathcal{l}(\\omega)[m ] \\right| \\\\ & \\geq & s_{b } \\left| p(s)^{bad } \\right| \\mbox {     } \\left| l(x ) \\cap l(s ) \\cap \\mathcal{l}(\\omega)[m ] \\right|_{\\min , x \\in s }   \\end{aligned}\\ ] ]    and @xmath1122 } \\mbox {           } \\sum_{p \\in \\gamma } \\chi & = & \\sum_{\\gamma \\in l(s ) \\cap \\left(\\mathcal{l}(\\omega)[m]-\\mathcal{l}^{0 } \\right ) } \\mbox {           } \\sum_{p \\in \\gamma } \\chi + \\sum_{\\gamma \\in l(s ) \\cap \\mathcal{l}^{0 } } \\mbox {      } \\sum_{p \\in \\gamma } \\chi \\\\ & \\leq & \\sum_{\\zeta \\in l(s ) \\cap \\mathcal{l}(\\omega)[m ] } f_{1 } \\left| p(\\zeta ) \\right| + \\sum_{\\gamma \\in l(s ) \\cap \\mathcal{l}^{0 } } f_{1 } \\left| p(\\gamma ) \\right| \\\\ & \\leq & \\sum_{\\zeta \\in l(s ) \\cap \\mathcal{l}(\\omega)[m ] } f_{1 } \\left| p(\\zeta ) \\right| + \\sum_{\\gamma \\in l(s ) \\cap \\mathcal{l}(\\omega)[m ] } f_{1 } \\left| p(\\gamma ) \\right| \\\\ & \\leq & 2f_{1 } \\sum_{\\zeta \\in l(s ) \\cap \\mathcal{l}(\\omega)[m ] } \\left| p(\\zeta ) \\right| \\\\ & \\leq &   2f_{1 } \\left| l(s ) \\cap \\mathcal{l}(\\omega)[m ] \\right| \\mbox {   } \\left| p(\\zeta ) \\cap p(s ) \\right|_{\\max , \\zeta \\in \\mathcal{l}(\\omega)[m ] } \\end{aligned}\\ ] ]    which yields @xmath1123 where @xmath1124 depends only on @xmath16 . by choosing @xmath1125",
    ", we have the measure of @xmath1116 is at least @xmath1126 times that of @xmath252 .",
    "we now apply lemma [ ping - pong averaging ] to @xmath252 , @xmath1127 $ ] , and @xmath1116 to conclude that for some @xmath1128 , the subset    @xmath1129 : \\left| p(\\zeta ) \\cap p(s)^{bad } \\right| \\geq \\nu_{2 } \\left| p(\\zeta ) \\right| \\}\\ ] ] satisfies    @xmath1130 for some @xmath1131 .",
    "now apply lemma [ ping - pong averaging ] again to @xmath252 , @xmath1127 $ ] , and @xmath1132 to conclude that for some @xmath1133 , the subset    @xmath1134 \\cap l(s)^{good }   \\right| \\leq ( 1-\\hat{\\nu}_{2 } ) \\left| l(p ) \\cap \\mathcal{l}(\\omega)[m ] \\right| \\}\\ ] ] satisfies    @xmath1135 for some @xmath1136 .",
    "now set @xmath1137 as @xmath1138 , and let @xmath1139 as the union of @xmath1137 as @xmath246 ranges over @xmath1140 .",
    "now run the same argument for @xmath1141 , replacing ` uniform points ' of an element of @xmath1097 by @xmath1137 , where @xmath1111 .",
    "repeat this procedure inductively , to arrive at subsets @xmath1102 , and @xmath1142 for every @xmath1098 , all of relative large measure .    for a @xmath1143",
    ", we now show that @xmath1144 is close to a @xmath1145-dimensional hyperplane .",
    "we will do this by induction .",
    "the hypothesis furnishes the base step .",
    "take @xmath1146 . by construction , for @xmath1147 , the @xmath27 images of at least @xmath1148 proportion of elements in @xmath1149 and @xmath1150 have the properties that 1 ) spend at least @xmath1151 proportion of their area / measure in @xmath1152 , and 2 ) belong to @xmath1087 , so admit @xmath218-hyperplane approximations by inductive hypothesis .",
    "there are two cases to consider .",
    "* case i. * at least one of @xmath304 is at least @xmath1153 away from @xmath840 , in which case we can do one of the followings : ( see also figure  [ fig : case1 ] below . )    * find @xmath218 many points @xmath1154 , @xmath1155 and @xmath1156 , @xmath1157 such that they intersect to form a @xmath1145-simplex @xmath765 with @xmath304 and @xmath1158 s lying on its faces . * or pick an element @xmath1156 . since @xmath1159 has codimension 1 in @xmath246 , most elements of @xmath1160 will intersect it and we can find @xmath218 many elements @xmath1161 , @xmath1162 such that they intersect @xmath1159 to make a @xmath1145-simplex @xmath765 with @xmath159 being one of its vertices and @xmath158 lying on the face opposite to @xmath159 .",
    "we now apply lemma [ simplicies made out of good lines ] to conclude that the @xmath27 images of @xmath765 are within @xmath1163 neighborhood of another @xmath1145-simplex on a @xmath1145-dimensional hyperplane .",
    "* case ii . * both @xmath158 and @xmath159 within @xmath1153 of @xmath840 .    in this case",
    "we make a @xmath1145-simplex with @xmath158 as one of its vertex as follows .",
    "( see also figure  [ fig : case2 ] below ) apply lemma [ lines of big angle ] to subsets @xmath1164 , which allows us to pick out @xmath1145 elements @xmath1165 that are almost equally spaced apart ( up to an error of @xmath1166 by lemma [ lines of big angle ] ) .",
    "since each @xmath1167 spends at least @xmath1151 proportion of its measure in the set @xmath1152 , we can certainly find @xmath1168 .",
    "furthermore we can assume @xmath136 is at most @xmath1169 away from @xmath840 .",
    "the subset of @xmath1170 that intersect all of @xmath1167 s , for @xmath1162 has large positive measure because elements of @xmath1170 has codimension 1 in @xmath246 .",
    "so we can find @xmath1171 that intersects all of @xmath1167 s , thus making a @xmath1145-simplex @xmath765 . by choice ,",
    "faces of @xmath765 : @xmath1172 , when considered as points in @xmath1173 , have pair - wise distance at least @xmath1174 , which means the volume of the set bounded by @xmath765 is at least @xmath1175 proportion of the volume of @xmath246 .    let @xmath1176 be a point that lies in the interior of the set bounded by @xmath765 . then most elements of @xmath1177 are going to intersect @xmath1145 faces of @xmath765 thus making a smaller @xmath1145-simplicies , @xmath218 of its faces are subsets of faces of @xmath765 .",
    "we construct such @xmath1145-simplicies @xmath901 for all points in @xmath1152 , and the collection of them together with @xmath765 gives us @xmath1178 a filled @xmath1145-simplex .    by lemma [ simplicies made out of good lines ] ,",
    "@xmath27 image @xmath899 is within @xmath1082 hausdorff neighborhood from another filled @xmath1145-simplex @xmath1179 on @xmath1145 hyperplane , we are done if in addition , @xmath1180 .",
    "if not , then we can find two elements @xmath1181 such that they both have no empty intersection with @xmath899 , because the area of the set bounded by @xmath765 to that of @xmath246 is at least @xmath1182 .",
    "let @xmath1183 , @xmath1184 be @xmath218-hyperplane approximations to @xmath1185 and @xmath1186 .",
    "then for any root @xmath603 , @xmath922 images of @xmath1183 and @xmath1184 on the ends away from @xmath1187 lie on a common vertical geodesic segment because they both intersect @xmath1179 which lie on a @xmath1145-hyperplane , and on the @xmath1187 end , the vertical geodesic segment containing them come together because both @xmath1188 s contain @xmath159 .",
    "since any two geodesic segments in a hyperbolic space come together at most one end , this means @xmath1189 and @xmath1190 lie on a common vertical geodesic segment .",
    "as @xmath603 ranges over all roots , this means that @xmath1183 and @xmath1184 lie on the same flat as @xmath1179 .",
    "lastly , as @xmath1179 lie on a @xmath1145-hyperplane and each of @xmath1191 s is a @xmath218-hyperplane , this gives us @xmath1192 lie on a common @xmath1145-hyperplane within a flat .",
    "_ of theorem [ exisence of standard maps in small boxes ] _    apply theorem [ existence of good boxes ] to @xmath40 .",
    "take a @xmath1193 , @xmath287 and apply lemma [ bare minimum for flats to flats ] to obtain subsets @xmath1194 $ ] , @xmath1195 $ ] for @xmath1196 , and @xmath1197 , all with relative measures approaching 1 as @xmath50 , @xmath49 approach zero , such that if @xmath1119 , then @xmath292 is within @xmath1198 hausdorff neighborhood of a geodesic segment that makes an angle at most @xmath293 with root angles .",
    "while when @xmath246 is an element of @xmath1199 for some @xmath1200 , @xmath27 images of the subset of @xmath1088 lying in @xmath246 are within @xmath1201 of a hyperplane of appropriate dimension .",
    "this means that the restriction of @xmath1202 to the subset @xmath1088 sends left cosets of @xmath33 to left cosets of @xmath801 up to an error of @xmath1201 .    from now on we",
    "drop the subscript @xmath383 .",
    "let @xmath1203 and tile @xmath40 by @xmath1204 : @xmath1205 by lemma [ boxes are folner ] , we can assume each of the tiles @xmath61 is at least @xmath1206 away from the boundary of @xmath40 , and the measure of @xmath69 is at most @xmath1207 times that of @xmath40 .    by chebyshev inequality and lemma [ ping - pong averaging ] we can obtain a subset @xmath1208 with @xmath1209 such that for every @xmath59 , there are subsets @xmath1210 , @xmath1211 and @xmath60 of @xmath1212 , @xmath1213 , and @xmath1214 , all of relative measure at least @xmath1215 whose elements are restriction of @xmath1097 , @xmath1216 and @xmath1088 to @xmath61 . here ,",
    "@xmath1217 and @xmath1064 both go to zero as @xmath296 .",
    "take a @xmath61 , @xmath59 .",
    "then the restriction of @xmath1218 to @xmath60 sends flats to within @xmath1219 hausdorff distance of a flat . note that @xmath1220 , so @xmath1221 and approaches zero",
    "when @xmath296 .",
    "since two flats come together at a convex set whose boundary is a union of hyperplanes parallel to root kernels .    to obtain a product structure on @xmath1088",
    ", we proceed to show that @xmath1222 and @xmath1223 for @xmath1224 are identical up to a translational error of @xmath1201 . in the process of doing so",
    ", we will also show that left cosets of @xmath32 are sent to left cosets of @xmath800 up to an error of the same order .",
    "first we show that the claim is true for two flats @xmath1225 that are at least @xmath1226 units apart and contains points @xmath1227 , @xmath1228 such that @xmath1229 lie on a common root class horocycle .    since @xmath1230 , we can find geodesic segments @xmath1231 containing @xmath158 , @xmath1232 containing @xmath159 such that for some subsegments @xmath1233 , @xmath1234 , @xmath1235 , @xmath1236 is a @xmath412 quadrilateral .",
    "as @xmath1237 , by lemma [ close to a quadrilateral ] , there is a @xmath50 quadrilateral @xmath1010 within @xmath1201 ( i.e.@xmath1219 ) hausdorff distance away from @xmath1238 . applying lemma [ structure of a quadrilateral ] to @xmath1010",
    ", we see that @xmath1239 and @xmath1240 are within @xmath1219 neighborhood of a left translate of @xmath996 or @xmath997 where @xmath950 is the direction of edges of @xmath1010 . since @xmath1241",
    ", we can build quadrilaterals @xmath1242 for @xmath1243 , the edges of each are elements of @xmath1244 such that their respective approximating quadrilaterals @xmath1245 , with edge directions @xmath1246 satisfies @xmath1247 with @xmath1248 , is @xmath29}$ ] for some root class @xmath1249 $ ] .",
    "argue as before , we see that @xmath1239 and @xmath1250 lie within @xmath1219 hausdorff neighborhood of a translate @xmath1251 for @xmath1252 , therefore @xmath1239 and @xmath1250 lie within @xmath1219 hausdorff neighborhood of a translate of @xmath29}$ ] .    by using more quadrilaterals",
    ", the argument above also shows that @xmath1253 are the same as @xmath1254 up to an error of @xmath1219 .    in general , for two arbitrary points @xmath1255 in",
    "the same left coset of @xmath32 , we can find at most @xmath1256 number of points @xmath1257 , such that each pair of successive points lie on a common root class horocycle .",
    "the quadrilateral argument above then shows that @xmath1239 are @xmath1250 within @xmath1258 hausdorff neighborhood of a translate of @xmath800",
    ".    9999999    l. auslander .",
    "an exposition of the structure of solvmanifolds , bull .",
    "soc ( 1973 ) , 227 - 285    m. bridson , a. haefliger .",
    "metric spaces of non - positive curvature .",
    "springer - verlag berlin heidelberg 1999    y. de cornulier .",
    "dimension of asymptotic cones of lie groups .",
    "t. dymarz .",
    "large scale geometry of certain solvable groups .",
    "preprint .",
    "a. eskin , d. fisher , k. whyte .",
    "quasi - isometries and rigidity of solvable groups .",
    "q.    a. eskin , d. fisher , k. whyte .",
    "coarse differentiation of quasi - isometries i : spaces not quasi - isometric to cayley graphs .",
    "a. eskin , d. fisher , k. whyte .",
    "coarse differentiation of quasi - isometries ii : rigidity for sol and lamplighter groups , preprint    a.w.knapp .",
    "lie groups beyond an introduction .",
    "birkhauser .",
    "exponential radicals of solvalbe lie groups , j. algebra 248 ( 2002 ) , 790 - 805 .    i. peng . coarse differentiation and quasi - isometries of a class of solvable lie groups ii . preprint .",
    "_ of lemma [ ca nt move far in h2 ] _ we will use the notations from equation ( [ distance ] ) . write @xmath1259 , @xmath1260 . by assumption ,",
    "if @xmath1262 , then assume @xmath1263 @xmath1264 and we are done .",
    "finally suppose @xmath1268 , and @xmath1269 . since @xmath50 is continuous , we can find @xmath1270 $ ] and therefore points @xmath1271 such that @xmath1272 , @xmath1273 , and @xmath1274 , for all @xmath383 except maybe the last one , where @xmath1275 .",
    "* suppose @xmath1283 .",
    "writing @xmath1284 , @xmath1285 , we have @xmath1286 so if @xmath1287 , then @xmath1288 , and this gives us @xmath1289 , which means @xmath1290 .",
    "multiplying both sides by @xmath1291 this means @xmath1292 , contradiction .",
    "so @xmath325 . *",
    "now suppose @xmath1292 .",
    "then again , that @xmath1291 is closer to @xmath1293 then @xmath1294 means @xmath1295 if @xmath1296 , then @xmath1297 , and this gives us @xmath1298 , which means @xmath1299 . multiplying by @xmath1291 this says @xmath1283 , contradiction .",
    "so @xmath325 .",
    "* @xmath1310 .",
    "+ in this case , @xmath1311 , so @xmath1312 , leaving @xmath1313 giving @xmath1314 hence @xmath1315 + or * @xmath1316 . by sine rule , this is the same thing as @xmath1317 + divide top and bottom by @xmath1318 ( if @xmath1319 then we are done , so assume one of them is not zero ) so @xmath1320 yields @xmath1321 . since @xmath1322 , @xmath1323 .",
    "so @xmath1324 . since @xmath1325 , wlog @xmath1326 , @xmath1327 so @xmath1328 .",
    "therefore @xmath1329 hence @xmath1330 _ the quadrilateral is the same as the loop below .",
    "so it can not be the case that all the @xmath1338 s are of the same sign .",
    "wlog we can assume @xmath1339 , and @xmath1340 .",
    "furthermore , regardless of the signs of the remaining @xmath1338 s , there must be another pair of adjacent @xmath1338 s of opposite signs , and either this pair involves one of @xmath1341 , or that it does nt . in the latter case , @xmath1342 and @xmath1343 , and the projection of this quadrilateral into @xmath1344 is a quadrilateral with two consecutive upward and two consecutive downward edges , and such a quadrilaterals does nt exist .",
    "so either @xmath1345 or @xmath1346 is involved in a pair of oppositely signed edges .",
    "wlog , we assume @xmath1347 .",
    "then by ( iv ) in the definition of a quadrilateral , we have that @xmath1348 , because @xmath1347 and @xmath1349 ; and @xmath1350 , because @xmath1351 and @xmath1340 , where @xmath1352 , @xmath1353 is the usual projection from @xmath976 to @xmath1354 .",
    "@xmath1355 is defined similarly .",
    "we see that only in the first bracket do we have a coordinate of size @xmath1358 .",
    "so @xmath1359 , and again by ( iv ) in the definition of quadrilateral , we conclude that for @xmath1360 , @xmath1361 , @xmath1362 .",
    "_ of lemma [ quadrilateral word in rank 1 ] _ summing the @xmath120 coordinates we see that @xmath1363",
    ". the identity word can be written as @xmath1364 we see that @xmath1365 , and @xmath1366 by comparing the @xmath980 and @xmath981 coordinates .    similarly by looking at the word starting from @xmath1367 we have @xmath1368 which gives us that @xmath1369 , and @xmath1370 .",
    "we obtain the desired claim by writing the word starting at @xmath1371 and @xmath1372 and argue similarly as above .",
    "equip the set @xmath1373 with the product measure @xmath1374 .",
    "the measure of the set @xmath1375 is therefore @xmath1376 . hence @xmath1377 let @xmath850 be the characteristic function of the set @xmath1378",
    ". then @xmath1379 @xmath1380"
  ],
  "abstract_text": [
    "<S> this is the first of two papers ( the other one being @xcite ) which aim to understand quasi - isometries of a subclass of unimodular split solvable lie groups . in the present paper , </S>",
    "<S> we show that locally ( in a coarse sense ) , a quasi - isometry between two groups in this subclass is close to a map that respects their group structures . </S>"
  ]
}