{
  "article_text": [
    "in this paper , we consider a finite - volume method for the following problem : @xmath0 , \\quad \\mathbf{x}\\in\\mathbb{r}^d,\\ t>0,\\\\ & \\rho(\\mathbf{x},0)=\\rho_0(\\mathbf{x } ) , \\end{aligned}\\right . \\label{1.1}\\ ] ] where @xmath1 is the unknown probability measure , @xmath2 is an interaction potential , which is assumed to be symmetric , @xmath3 is a density of internal energy , and @xmath4 is a confinement potential .",
    "equations such as appear in various contexts .",
    "if @xmath5 and @xmath6 vanishes , and @xmath7 or @xmath8 , it is the classical heat equation or porous medium / fast diffusion equation @xcite .",
    "if mass - conserving , self - similar solutions of these equations are sought , the quadratic term @xmath9 is added , leading to new equations in similarity variables .",
    "more generally , @xmath6 usually appears as a confining potential in fokker - planck type equations @xcite .",
    "finally , @xmath5 is related to the interaction energy , and can be as singular as the newtonian potential in chemotaxis system  @xcite or as smooth as @xmath10 with @xmath11 in granular flow  @xcite .",
    "the free energy associated to equation is given by ( see @xcite ) : @xmath12 this energy functional is the sum of internal energy , potential energy and interaction energy , corresponding to the three terms on the right - hand side of , respectively .",
    "a simple computation shows that , at least for classical solutions , the time - derivative of @xmath13 along solutions of   is @xmath14 where @xmath15 the functional @xmath16 will henceforth be referred to as the entropy dissipation functional .",
    "the equation   and its associated energy @xmath13 are the subjects of intensive study during the past fifteen years , see e.g. @xcite and the references therein .",
    "the general properties of   are investigated in the context of interacting gases  @xcite , and are common to a wide variety of models , including granular flows @xcite , porous medium flows @xcite , and collective behavior in biology @xcite .",
    "the gradient flow structure , in the sense of  , is generalized from smooth solutions to measure - valued solutions @xcite .",
    "certain entropy - entropy dissipation inequalities between @xmath13 and @xmath17 are also recognized to characterize the fine details of the convergence to steady states @xcite .    the steady state of  , if it exists , usually verifies the form @xmath18 where the constant @xmath19 could be different on different connected components of @xmath20 . in many cases , especially in the presence of the interaction potential @xmath5 , there are multiple steady states , whose explicit forms are available only for particular @xmath5 .",
    "most of studies of these steady states are based on certain assumptions on the support and the characterizing equation .    in this work ,",
    "we propose a positivity preserving finite - volume method to treat the general nonlocal nonlinear pde .",
    "moreover , we show the existence of a discrete free energy that is dissipated for the semi - discrete scheme ( discrete in space only ) .",
    "a related method was already proposed in @xcite for the case of nonlinear degenerate diffusions in any dimension .",
    "we generalize this method to cover the nonlocal terms for both 1d and 2d cases in section [ sec2 ] .",
    "in fact , the first order scheme generalizes easily to cover unstructured meshes .",
    "however , it is an open problem how to obtain entropy decreasing higher order schemes in this setting in 2d .",
    "let us remark that other numerical methods based on finite element approximations have been proposed in the literature which are positivity preserving and entropy decreasing at the expense of constructing them by an implicit discretization in time but continuous in space , see @xcite .",
    "section [ sec3 ] is devoted to numerical experiments , in which the performance of the developed numerical approach is tested . in section  [ sec31 ] , we conduct the convergence study of stationary states , where the order of accuracy depends on the regularity at free boundaries .",
    "we then showcase the performance of this method for finding stable stationary states with nonlocal terms and their equilibration rate in time for different nonlocal models . in section [ sec33 ] , we emphasize how this method is useful to explore different open problems in the analysis of these nonlocal nonlinear models such as the keller - segel model for chemotaxis in its different versions .",
    "we continue in section [ sec : attrep ] with aggregation equations with repulsive - attractive kernels and address the issue of singular kernels and discontinuous steady states .",
    "finally , in section [ sec34 ] , we demonstrate the performance of the scheme in a number of 2-d experiments showcasing numerical difficulties and interesting asymptotics .",
    "in this section , we describe both one- ( 1-d ) and two - dimensional ( 2-d ) finite - volume schemes for and prove their positivity preserving and entropy dissipation properties . we also establish error estimates and convergence results for the proposed methods .",
    "we start in  [ sec21 ] with the 1-d case and then generalize it to the 2-d case in  [ sec22 ] , both on uniform meshes .",
    "the extension to higher dimensions and non - uniform structured meshes is straightforward .",
    "we begin with the derivation of the 1-d second - order finite - volume method for equation . for simplicity , we divide the computational domain into finite - volume cells @xmath21 $ ] of a uniform size @xmath22 with @xmath23 , @xmath24 , and denote by @xmath25 the computed cell averages of the solution @xmath26 , which we assume to be known or approximated at time @xmath27 .",
    "a semi - discrete finite - volume scheme is obtained by integrating equation over each cell @xmath28 and is given by the following system of odes for @xmath29 : @xmath30 where the numerical flux @xmath31 approximate the continuous flux @xmath32 at cell interface @xmath33 and is constructed next . for simplicity , we will omit the dependence of the computed quantities on @xmath27 in the rest . as in the case of degenerate diffusion equations treated in @xcite",
    ", we use the upwind numerical fluxes . to this end , we first construct piecewise linear polynomials in each cell @xmath28 , @xmath34 and compute the right ( `` east '' ) , @xmath35 , and left ( `` west '' ) , @xmath36 , point values at the cell interfaces @xmath37 and @xmath33 , respectively : @xmath38 these values will be second - order accurate provided the numerical derivatives @xmath39 are at least first - order accurate approximations of @xmath40 . to ensure that the point values are both second - order and nonnegative , the slopes @xmath39 in are calculated according to the following adaptive procedure .",
    "first , the centered - difference approximations @xmath41 is used for all @xmath42 . then ,",
    "if the reconstructed point values in some cell @xmath28 become negative ( i.e. , either @xmath43 or @xmath44 ) , we recalculate the corresponding slope @xmath39 using a slope limiter , which guarantees that the reconstructed point values are nonnegative as long as the cell averages @xmath45 are nonnegative . in our numerical experiments , we have used a generalized minmod limiter @xcite : @xmath46 where @xmath47 and the parameter @xmath48 can be used to control the amount of numerical viscosity present in the resulting scheme . in all the numerical examples below ,",
    "@xmath49 is used .",
    "equipped with the piecewise linear reconstruction @xmath50 and point values @xmath51 , the upwind fluxes in are computed as @xmath52 where the discrete values @xmath53 of the velocities are obtained using the centered - difference approach , @xmath54 and the positive and negative parts of @xmath53 are denoted by @xmath55 the discrete velocity field @xmath56 is calculated by discretizing : @xmath57 where @xmath58 and @xmath59 . the formula is a second - order approximation of @xmath60 indeed , the reconstruction yields @xmath61 and @xmath62 here @xmath63 can be any approximation of the local integral @xmath64 with error @xmath65 . if @xmath5 has a bounded second order derivative near @xmath66 , @xmath63 can be chosen to be @xmath67 ( the middle point rule ) or @xmath68 ( the trapezoidal rule ) .",
    "the integral @xmath69 in the second summation is of @xmath70 because of the anti - symmetric factor @xmath71 , leading to overall error @xmath65 .",
    "the case with non - smooth or singular interaction potential @xmath5 has to be treated more carefully .",
    "first , the last integral @xmath69 in the above formula vanishes as soon as @xmath72 due to the symmetry of @xmath5 independently of any possible singularity at @xmath73 .",
    "if @xmath5 has a locally integrable singularity ( usually at the origin ) , @xmath74 can still be approximated by a higher order quadrature scheme with an error @xmath65 or smaller .",
    "actually , in the particular case of powers or logarithm kernels , it can be explicitly computed .",
    "however , the second sum above may have a slightly larger error .",
    "for instance , if @xmath75 for @xmath76 , then @xmath77 by direct computation when @xmath78 is close to zero .",
    "finally , the semi - discrete scheme is a system of odes , which has to be integrated numerically using a stable and accurate ode solver . in all numerical examples reported in next section ,",
    "the third - order strong preserving runge - kutta ( ssp - rk ) ode solver @xcite is used .",
    "[ rmk1 ] the computational bottleneck is the discrete convolution in  .",
    "this is a classical problem in scientific computing that can be effectively evaluated using fast convolution algorithms , mainly based fast fourier transforms  @xcite .",
    "[ rmk2 ] the second - order finite - volume scheme ,  , reduces to the first - order one if the piecewise constant reconstruction is used instead of , in which case one has @xmath79    [ [ positivity - preserving . ] ] positivity preserving .",
    "+ + + + + + + + + + + + + + + + + + + + + +    the resulting scheme preserves positivity of the computed cell averages @xmath29 as stated in the following theorem . the proof is based on the forward euler integration of the ode system , but will remain equally valid if the forward euler method were replaced by a higher - order ssp ode solver  @xcite , whose time step can be expressed as a convex combination of several forward euler steps .",
    "[ pos1 ] consider the system with initial data @xmath80 and the semi - discrete finite - volume scheme ,  with a positivity preserving piecewise linear reconstruction for @xmath26 .",
    "assume that the system of odes is discretized by the forward euler method .",
    "then , the computed cell averages @xmath81 , provided that the following cfl condition is satisfied : @xmath82 with @xmath83 and @xmath84 defined in .",
    "assume that at a given time @xmath85 the computed solution is known and positive : @xmath86 .",
    "then the new cell averages are obtained from the forward euler discretization of equation : @xmath87 , \\label{euler}\\ ] ] where @xmath88 .",
    "as above , the dependence of all terms on the rhs of on @xmath85 is suppressed in the following to simplify the notation . using and the fact that @xmath89 ( see ) , we obtain @xmath90\\\\ & = \\lambda u_{j-\\frac{1}{2}}^+\\rho_{j-1}^{\\rm e}+\\left(\\frac{1}{2}-\\lambda u_{j+\\frac{1}{2}}^+\\right)\\rho_{j}^{\\rm e } + \\left(\\frac{1}{2}+\\lambda u_{j-\\frac{1}{2}}^-\\right)\\rho_{j}^{\\rm w}-\\lambda u_{j+\\frac{1}{2}}^-\\rho_{j+1}^{\\rm w}. \\end{aligned } \\label{euler1}\\ ] ] it follows from that the new cell averages @xmath91 are linear combinations of the nonnegative reconstructed point values @xmath92 and @xmath93 . since @xmath94 and @xmath95",
    ", we conclude that @xmath96 , provided that the cfl condition is satisfied .",
    "similar result holds for the first - order finite - volume scheme with the cfl condition reduced to @xmath97    [ [ discrete - entropy - dissipation . ] ] discrete entropy dissipation .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + +    a discrete version of the entropy @xmath98 defined in is given by @xmath99 .",
    "\\label{dfe}\\ ] ] we also introduce the discrete version of the entropy dissipation @xmath100 in the following theorem , we prove that the time derivative of @xmath101 is less or equal than the negative of @xmath102 , mimicking the corresponding property of the continuous relation .",
    "[ dd1 ] consider the system with no flux boundary conditions on @xmath103 $ ] with @xmath104 and with initial data @xmath80 .",
    "given the semi - discrete finite - volume scheme with @xmath105 ,  with a positivity preserving piecewise linear reconstruction for @xmath26 and discrete boundary conditions @xmath106 .",
    "then , @xmath107    we start by differentiating with respect to time to obtain : @xmath108\\\\ & = \\delta x\\sum\\limits_j\\left[\\delta x\\sum\\limits_i w_{j - i}\\overline{\\rho}_i+h'(\\overline\\rho_j)+ { v}_j\\right]\\frac{d\\overline{\\rho}_j}{dt}. \\end{aligned } \\ ] ] using the definition and the numerical scheme , we have @xmath109 a discrete integration by parts using the no flux discrete boundary conditions along with yields @xmath110 finally , using the definition of the upwind fluxes and formulas and , we conclude @xmath111 \\le-\\delta x\\sum\\limits_j(u_{j+\\frac{1}{2}})^2\\min\\limits_j(\\rho_j^{\\rm e},\\rho_{j+1}^{\\rm w})=-i_\\delta(t).\\ ] ]      in this subsection , we quickly describe a semi - discrete second - order finite - volume method for the 2-d equation .",
    "we explain the main ideas in 2d for the sake of the reader .",
    "as already mentioned , the first order scheme generalizes easily to unstructured meshes . however , higher order schemes with the desired entropy decreasing property are harder to obtain in this setting for higher dimensions .",
    "we introduce a cartesian mesh consisting of the cells @xmath112\\times[y_{k-\\frac{1}{2}},y_{k+\\frac{1}{2}}]$ ] , which for the sake of simplicity are assumed to be of the uniform size @xmath113 , that is , @xmath114 , and @xmath115 .",
    "a general semi - discrete finite - volume scheme for equation can be written in the following form : @xmath116 here , we define @xmath117 as the cell averages of the computed solution and @xmath118 and @xmath119 are upwind numerical fluxes in the @xmath120 and @xmath121 directions , respectively .    as in the 1-d case , to obtain formulae for numerical fluxes , we first compute @xmath122 and @xmath123 , which are one - sided point values of the piecewise linear reconstruction @xmath124 at the cell interfaces @xmath125 , @xmath126 , @xmath127 , @xmath128 , respectively .",
    "namely , @xmath129 & \\rho_{j , k}^{\\rm n}:=\\widetilde\\rho(x_{j},y_{k+\\frac{1}{2}}-0)=\\overline\\rho_{j , k}+\\frac{\\delta y}{2}(\\rho_y)_{j , k},\\quad \\rho_{j , k}^{\\rm s}:=\\widetilde\\rho(x_{j},y_{k-\\frac{1}{2}}+0)=\\overline\\rho_{j , k}-\\frac{\\delta y}{2}(\\rho_y)_{j , k}. \\end{aligned } \\label{pv2}\\ ] ] to ensure the point values in are both second - order and nonnegative , the slopes in are calculated according to the adaptive procedure similarly to the 1-d case .",
    "first , the centered - difference approximations , @xmath130 are used for all @xmath131 . then ,",
    "if the reconstructed point values in some cell @xmath132 become negative , we recalculate the corresponding slopes @xmath133 or @xmath134 using a monotone nonlinear limiter , which guarantees that the reconstructed point values are nonnegative as long as the cell averages of @xmath135 are nonnegative for all @xmath131 . in our numerical experiments ,",
    "we have used the one - parameter family of the generalized minmod limiters with @xmath136 $ ] : @xmath137    given the polynomial reconstruction and its point values , the upwind numerical fluxes in are defined as @xmath138 where @xmath139 the values of @xmath140 and @xmath141 are defined according to , and @xmath142 here , @xmath143 and @xmath144 .",
    "similarly to the 1-d case , the formula for @xmath145 is obtained by using the reconstruction formula and applying the midpoint quadrature rule to the first integral in @xmath146 as in the 1-d case , the ode system is to be integrated numerically by a stable and sufficiently accurate ode solver such as the third - order ssp - rk ode solver @xcite .",
    "[ rmk23 ] as in the 1-d case , the first - order finite - volume method is obtained by taking @xmath147    [ [ positivity - preserving.-1 ] ] positivity preserving .",
    "+ + + + + + + + + + + + + + + + + + + + + +    the resulting 2-d finite - volume scheme will preserve positivity of the computed cell averages @xmath148 , as long as an ssp ode solver , whose time steps are convex combinations of forward euler steps , is used for time integration .",
    "we omit the proof of the positivity property of the scheme as it follows exactly the lines of theorem [ pos1 ] .",
    "the only difference is that in the 2-d case @xmath149 , which leads to a slightly modified cfl condition .",
    "we thus have the following theorem .    [ pos2 ] consider the system with initial data @xmath80 and the semi - discrete finite - volume scheme ,  with a positivity preserving piecewise linear reconstruction for @xmath26 .",
    "assume that the system of odes is discretized by the forward euler ( or a strong stability preserving runge - kutta ) method .",
    "then , the computed cell averages @xmath150 , provided the following cfl condition is satisfied : @xmath151 where @xmath140 and @xmath141 are defined according to .",
    "[ [ discrete - entropy - dissipation.-1 ] ] discrete entropy dissipation .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we define the discrete entropy @xmath152 , \\ ] ] and discrete entropy dissipation @xmath153\\min\\limits_{j , k } \\left(\\rho_{j , k}^{\\rm e},\\rho_{j+1,k}^{\\rm w},\\rho_{j ,",
    "k}^{\\rm n},\\rho_{j , k+1}^{\\rm s}\\right ) . \\ ] ] similarly to the 1-d case , we can show the following dissipative property of the scheme .",
    "[ dd2 ] consider the system with no flux boundary conditions in the domain @xmath103 ^ 2 $ ] with @xmath104 and with initial data @xmath80 .",
    "given the semi - discrete finite - volume scheme ,  with a positivity preserving piecewise linear reconstruction for @xmath26 , with @xmath105 , and with discrete no - flux boundary conditions @xmath154 .",
    "then , @xmath107",
    "in this section , we present several numerical examples , focusing mainly on the steady states or long time behaviors of the solutions to the general equation @xmath155 , \\quad \\mathbf{x}\\in\\mathbb{r}^d,\\ t>0.\\ ] ] a previous detailed study in @xcite for the degenerate parabolic and drift - diffusion equations demonstrated the good performance of the method ( with small variants ) in dealing with exponential rates of convergence toward compactly supported barenblatt solutions . here",
    "we will concentrate mostly on cases with the interaction potential @xmath5 , and show that key properties like non - negativity and entropy dissipation are preserved .",
    "we will first start our discussion by using some test cases to validate the order of convergence of the scheme in space and its relation to the regularity of the steady states .",
    "if the solution @xmath26 is smooth , the spatial discretization given in section  [ sec2 ] is shown to be of second order . however , in practice , the steady states of   are usually compactly supported , with discontinuities in the derivatives or even in the solutions themselves near the boundaries .",
    "this loss of regularity of the steady states usually leads to degeneracy in the order of convergence , as shown in examples [ ex31][ex34 ] .",
    "then , we will illustrate with several examples that the presented finite - volume scheme can be used for a numerical study of many challenging questions in which theoretical analysis has not yet been fully developed .",
    "[ ex31 ] we first consider equation in 1-d with only the interaction kernel @xmath156 ( i.e. , @xmath157 ) .",
    "the corresponding unit - mass steady state is given by ( see @xcite ) : @xmath158 and is hlder continuous with exponent @xmath159 .",
    "this steady state is the unique global minimizer of the free energy   and it approached by the solutions of   with an exponential convergence rate as shown in  @xcite .",
    "we compute @xmath160 by numerically solving at large time , with the initial condition @xmath161 . in figure",
    "[ fig : quadlog_prof]*(a ) * , we plot the numerical steady state obtained on a very coarse grid with @xmath162 .",
    "as one can see , even on such a coarse grid , the numerical steady state is in good agreement with the exact one , except near the boundary @xmath163 .",
    "the spatial convergence error of the steady states in @xmath164 norm and @xmath165 norm is shown in figure  [ fig : quadlog_prof]*(b)*. as a general rule , the practical convergence error of the numerical steady state is @xmath166 in @xmath165 norm and @xmath167 in @xmath164 norm , if the exact steady state is @xmath168-hlder continuous .    ,",
    "compared with the exact one . *",
    "( b ) * the convergence of error in @xmath164 and @xmath165 norms . here",
    "the @xmath164 norm is computed by taking the numerical steady state piecewise constant inside each cell and @xmath165 norm is evaluated only at the cell centers.,title=\"fig : \" ] @xmath169 , compared with the exact one . * ( b ) * the convergence of error in @xmath164 and @xmath165 norms . here",
    "the @xmath164 norm is computed by taking the numerical steady state piecewise constant inside each cell and @xmath165 norm is evaluated only at the cell centers.,title=\"fig : \" ]    [ ex32 ] next , we consider the equation in 1-d with @xmath170 , @xmath171 and @xmath172 , where @xmath173 and @xmath174 is an increasing function on @xmath175 , i.e. , @xmath176 this equation arises in some physical and biological modelling with competing nonlinear diffusion and nonlocal attraction , see @xcite for instance . the attraction represented by convolution @xmath177 is relatively weak ( compared to that in the keller - segel model discussed below ) , and the solution does not blow up with bounded initial data , while the long time behavior of the solution is characterized by an extensive study of the steady states in  @xcite .",
    "when @xmath178 , the attraction dominates the nonlinear diffusion , leading to a compactly supported steady state .",
    "when @xmath179 , the behavior depends on the diffusion coefficient @xmath180 : there is a local steady state for small @xmath180 with localized initial data and the solution always decays to zero for large @xmath180 .",
    "the borderline case @xmath181 is investigated in  @xcite for non - compactly supported kernels , where the evolution depends on the coefficient @xmath180 , the total conserved mass , and @xmath182 .",
    "we begin by numerically calculating the solutions to the 1-d equation with nonlinear diffusion and @xmath183 , for some constants @xmath184 .",
    "the corresponding steady states can also be obtained by implementing an iterative procedure proposed in  @xcite . here",
    ", we compute the steady state solutions @xmath160 by the time evolution of subject to gaussian - type initial data @xmath185.\\ ] ] the simulations are run on the computational domain @xmath186 $ ] with the mesh size @xmath187 for large time until stabilization and the results are plotted in figure [ fig : aggdiff1d_prof]*(a ) * for different values of @xmath188 .",
    "as one can observe , the boundary behavior of the compactly supported steady states has a similar dependence on @xmath188 as the barenblatt solutions of the classical porous medium equation @xmath189 , that is , only hlder continuous with exponent @xmath190 . using the steady states of   computed by the iterative scheme proposed in  @xcite",
    ", we can check the spatial convergence error of our scheme on different grid sizes @xmath22 .",
    "as shown in figure  [ fig : aggdiff1d_prof]*(b ) * , the spatial convergence error of the steady states is @xmath191 in @xmath164 norm and is @xmath192 in @xmath165 norm .",
    "have hlder exponent @xmath190 and @xmath193 , where @xmath180 is chosen such that the corresponding @xmath160 is supported on @xmath194 $ ] . *",
    "( b ) * the convergence of the steady states @xmath160 on different grid size @xmath22 , which is @xmath191 in @xmath164 norm and is @xmath192 in @xmath165 norm.,title=\"fig : \" ] @xmath169   have hlder exponent @xmath190 and @xmath193 , where @xmath180 is chosen such that the corresponding @xmath160 is supported on @xmath194 $ ] . *",
    "( b ) * the convergence of the steady states @xmath160 on different grid size @xmath22 , which is @xmath191 in @xmath164 norm and is @xmath192 in @xmath165 norm.,title=\"fig : \" ]    now let us turn our attention to the time evolution and the stabilization in time toward equilibria and show that the convergence in time toward equilibration can be arbitrarily slow .",
    "this is due to the fact that the effect of attraction is very small for large distances .",
    "actually , different bumps at large distances will slowly diffuse and take very long time to attract each other .",
    "however , once they reach certain distance , the convexity of the gaussian well will lead to equilibration exponentially fast in time .",
    "these two different time scales can be observed in figure [ fig : aggdiff1d_prof2 ] , where the time energy decay and density evolution are plotted to the solution corresponding to @xmath195 , and @xmath196 ( see also figure [ fig : aggdiff1d_prof ] ) .",
    "[ ex33 ] the dynamics of the solution of the 1-d equation with characteristic functions as initial data is shown in figure  [ fig : nldiff ] , for the compactly supported interaction kernel @xmath197 . for @xmath198}(x)$ ] , the solution forms two bumps and then merges to a single one , which is the global minimizer of the energy .",
    "when @xmath199}(x)$ ] , the solution converges to three non - interacting bumps ( in the sense that @xmath200 ) , each of which is a steady state .",
    "the decay of the energy for these two cases is shown in figure  [ fig : aggdiffentropy]*(a)*. after the initial transient disappears , the energy decreases significantly at later times only when the topology changes , i.e. the merge of disconnected components .",
    "although there is a steady state with one single component with all the mass , the three - bump solutions with @xmath203}$ ] seems to be the correct final stable steady state .",
    "this can be confirmed from figure  [ fig : aggdiffentropy]*(b ) * , as @xmath204 is a constant on each connected component of the support .",
    "this example shows a very interesting effect in this equation , which is the appearance in the long time asymptotics of steady states with disconnected support .",
    "it should be observed that each bump is at distance larger than 1 from the other bumps , and thus the interaction force exerted between them is zero .",
    "this together with the finite speed of propagation of the degenerate diffusion are the reasons why the steady state with the total mass and connected support is not achieved in the long time asymptotics .",
    "this fact is related to the existence of local minimizers of the functional in certain weak topologies , infinity wasserstein distance , not allowing for large perturbations of the support , see ( * ? ? ?",
    "* section 5 ) and @xcite for related questions .    }",
    "$ ] and @xmath199}$ ] . after an initial transient behavior",
    ", there is a significant decrease in the entropy only when the topology of the solution changes . *",
    "( b ) * the final steady state of   with initial data @xmath199}$ ] and the corresponding @xmath204 .",
    "here @xmath204 assumes different constant values on different connected components of the support.,title=\"fig : \" ] @xmath169 } $ ] and @xmath199}$ ] . after an initial transient behavior",
    ", there is a significant decrease in the entropy only when the topology of the solution changes . *",
    "( b ) * the final steady state of   with initial data @xmath199}$ ] and the corresponding @xmath204 .",
    "here @xmath204 assumes different constant values on different connected components of the support.,title=\"fig : \" ]    for other non - compactly supported kernels like @xmath205 or the gaussian as in example [ ex32 ] , there is a unique steady state with one single connected component in its support , though it exhibits the same slow - fast behavior in its convergence in time as shown in figure [ fig : aggdiff1d_prof2 ] .",
    "this metastability and other decaying solutions when @xmath179 are discussed in more details in  @xcite .",
    "[ ex34 ] in this example , we elaborate more on stationary states which are not global minimizers of the total energy .",
    "more precisely , we consider nonlinear diffusion equation for particles under an external double - well potential of the form @xmath206 actually , the steady states of are of the form @xmath207 with @xmath208 piecewise constant possibly different in each connected component of the support .",
    "we run the computation with @xmath209 , @xmath181 and initial data of the form @xmath210 corresponding to the symmetric ( @xmath211 ) and asymmetric ( @xmath212 ) cases , respectively .",
    "it is obvious that for small mass , we can get infinitely many stationary states with two connected components in its support by perturbing the value of @xmath19 defining a symmetric steady state .",
    "actually , each of them has a non zero basin of attraction depending on the distribution of mass initially as shown in figure [ fig : doublewell]*(b)*. while the global minimizer of the free energy is the symmetric steady state , the non symmetric ones are local minimizers in the infinity wassertein distance or informally for small perturbations in the sense of its support .",
    "it is interesting to observe that even if the long time asymptotics is different for each initial data , the rate of convergence to stabilization seems uniformly 2 , see figure [ fig : doublewell]*(a)*.    ) and asymmetric ( @xmath212 ) cases , respectively .",
    "a uniform rate of convergence of order 2 is observed towards the stationary states . * ( b ) * the evolution of the asymmetric initial data ( @xmath212 ) towards the corresponding asymmetric stationary state.,title=\"fig : \" ] @xmath169 ) and asymmetric ( @xmath212 ) cases , respectively",
    ". a uniform rate of convergence of order 2 is observed towards the stationary states . * ( b ) * the evolution of the asymmetric initial data ( @xmath212 ) towards the corresponding asymmetric stationary state.,title=\"fig : \" ]      another related diffusion equation with nonlocal attraction is the generalized keller - segel model , @xmath213 with the kernel @xmath214 with @xmath215 or the convention @xmath216 for @xmath217 .",
    "the bound from below in @xmath166 due to local integrability of the kernel @xmath5 . when @xmath218 , @xmath5 is the newtonian potential in @xmath219 , and the equation reduces to the keller - segel model for chemotaxis with nonlinear diffusion : @xmath220 compared with example [ ex32 ] where the interaction potential @xmath5 is integrable , the long tail for @xmath214 has non - trivial consequences . in certain parameter regimes ,",
    "the solution can even blow up in finite time with smooth initial data . to clarify the different regimes , we can easily evaluate the balance between the attraction due to the nonlocal kernel @xmath5 and the repulsion due to diffusion by scaling arguments .",
    "in fact , taking the corresponding energy functional and checking the scaling under dilations of each term , we can find three different regimes :    * diffusion - dominated regime : @xmath221 . here , the intuition is that solutions exist globally in time and the aggregation effect only shows in the long - time behavior where we observe nontrivial compactly supported stationary states .",
    "* balanced regime : @xmath222 . here",
    "the mass of the system is the critical quantity .",
    "there is a critical mass , separating the diffusive behavior from the blow - up behavior .",
    "* aggregation - dominated regime : @xmath223 .",
    "blow - up and diffusive behavior coexist for all values of the mass depending on the initial concentration .",
    "when @xmath224 , @xmath209 for different exponents @xmath188 .",
    "* ( b ) * the blowing up solution for @xmath225 , @xmath226 and @xmath209 with initial data @xmath227 , where the total mass @xmath228 . * ( c ) * the decaying solution for @xmath225 , @xmath226 and @xmath209 with initial data @xmath229 , where @xmath230.,title=\"fig:\"]@xmath231   when @xmath224 , @xmath209 for different exponents @xmath188 . * ( b ) * the blowing up solution for @xmath225 , @xmath226 and @xmath209 with initial data @xmath227 , where the total mass @xmath228 . * ( c ) * the decaying solution for @xmath225 , @xmath226 and @xmath209 with initial data @xmath229 , where @xmath230.,title=\"fig : \" ]   when @xmath224 , @xmath209 for different exponents @xmath188 . * ( b ) * the blowing up solution for @xmath225 , @xmath226 and @xmath209 with initial data @xmath227 , where the total mass @xmath228 . * ( c ) * the decaying solution for @xmath225 , @xmath226 and @xmath209 with initial data @xmath229 , where @xmath230.,title=\"fig : \" ]    the classical 2-d keller - segel system corresponds to @xmath232 , @xmath217 , see @xcite and the references therein for the different behaviors . the nonlinear diffusion model for the balanced case with the newtonian potential in @xmath233 was studied in detail in  @xcite .",
    "finite time blow - up solutions for general kernel @xmath214 in the aggregation - dominated regime were also investigated , combined with numerical simulations  @xcite .",
    "[ ex35 ] let us start with the 1-d example when @xmath224 corresponding to the balanced case . here , the behavior of the dynamics depends on the total conserved mass .",
    "the solutions blow up if the mass is greater than the threshold @xmath234 and otherwise the solutions decay to zero .",
    "this threshold mass can be determined by solving the equation with different initial conditions and is shown in figure  [ fig : critmass]*(a ) * for different values of @xmath188 . for example , when @xmath225 and @xmath235 , the threshold mass @xmath234 is about @xmath236 . if the initial data has a larger mass as in figure  [ fig : critmass]*(b ) * , the solution blows up .",
    "since the numerical method is conservative , the density concentrates inside one cell instead of being infinity .",
    "otherwise , if the initial data has a smaller mass as in figure  [ fig : critmass]*(c ) * , the solution decays to zero .",
    "we have also checked the self - similar behavior for subcritical mass cases @xmath237 in the sense of solving with @xmath238 .",
    "that is in the similarity variables , the solution of @xmath239 converges to the self - similar profile .",
    "the decay rate in time is computed for several subcritical masses and is shown in figure  [ fig : subcritmass]*(a ) * , illustrating that this rate is independent of the mass and is exactly @xmath240 as proven in the classical 2-d keller - segel model in @xcite .",
    "we also observe in figure  [ fig : subcritmass]*(b ) * how the self - similar profiles become concentrated as a dirac delta at the origin as @xmath241 .",
    ", @xmath226 , @xmath209 for different values of the mass @xmath242 . *",
    "( b ) * the equilibrium profiles for different @xmath242.,title=\"fig : \" ] @xmath231 , @xmath226 , @xmath209 for different values of the mass @xmath242 . * ( b ) * the equilibrium profiles for different @xmath242.,title=\"fig : \" ]    [ ex36 ] the general behaviors of solutions to the 1-d version of   in other parameter regimes are also known to some extent .",
    "when @xmath243 corresponding to the diffusion - dominated regime , a compact steady state is always expected , which is the global minimizer of the energy   as in @xcite . if the nonlinearity of the diffusion is increased to be @xmath244 with the same total mass @xmath245 and the exponent @xmath226 , the solution converges to a steady state as in figure  [ fig : kssupexp ] instead of blowing up as in figure  [ fig : critmass]*(b)*. when @xmath246 corresponding to the aggregation - dominated regime , the small initial data decays to zero while large initial data blows up in finite time ( see figure  [ fig : kssubexp ] ) .",
    "the size of the initial data determining the distinct behaviors is usually measured in a norm different from @xmath164 ( the conserved mass ) , and no critical value in this norm as in the case @xmath224 is expected .",
    ", @xmath247 ) with @xmath248 .",
    "the initial condition @xmath227 ( @xmath249 ) is the same as that in figure  [ fig : critmass ] * ( b)*.,title=\"fig : \" ] @xmath231 , @xmath247 ) with @xmath248 .",
    "the initial condition @xmath227 ( @xmath249 ) is the same as that in figure  [ fig : critmass ] * ( b)*.,title=\"fig : \" ]    , @xmath247 ) with @xmath248 .",
    "the initial condition is @xmath227 , with @xmath250 for decaying solution in * ( a ) * and @xmath251 for blowup solutions in * ( b)*.,title=\"fig : \" ] @xmath231 , @xmath247 ) with @xmath248 .",
    "the initial condition is @xmath227 , with @xmath250 for decaying solution in * ( a ) * and @xmath251 for blowup solutions in * ( b)*.,title=\"fig : \" ]      in the absence of diffusion from @xmath3 or confinement from @xmath6 , steady states of the general equation   are still expected when the kernel @xmath5 incorporates both short range repulsion and long range attraction .",
    "this type of kernels arises in the continuum formulation of moving flocks of self - propelled particles  @xcite , and the popular ones are the morse potential @xmath252 and the power - law type @xmath253 with the convention that @xmath254 below .",
    "[ ex37 ] the regularity of the solution depends on the singularity of the repulsion force .",
    "if this force is small at short distance ( or equivalently @xmath255 is relatively large ) , the solution can concentrate at a lower dimension subset , while more singular forces lead to smooth steady states except possible discontinuities near the boundary  @xcite .",
    "the case @xmath256 and @xmath257 is shown in example [ ex31 ] , whose steady state is a semi - circle  @xcite , while the case @xmath256 and @xmath258 leads to a steady state which is a constant supported on an interval  @xcite .",
    "we remind that the discrete convolution for the velocity field in is discretized using the coefficients @xmath63 , chosen as approximations of the local integral @xmath259 in the case of smooth kernels @xmath260 , we can either use the mid - point rule or a direct computation of the integral if available .",
    "we show the numerically computed stationary state with both options in figure  [ fig : quadnewton ] * ( a ) * and * ( b ) * respectively . as one can observe , the first choice is oscillation free while the second choice with exact integrals shows an overshoot of the density near the boundary of the support .",
    "the difference between the two cases can be explained by carefully writing down the characterization of the discrete stationary states based on the discrete entropy inequality in theorem [ dd1 ] .",
    "the mid - point rule performs better due to its symmetry that induces some numerical diffusion .      in case we would be dealing with singular kernels",
    ", we can not use simple quadrature formulas like middle - point rule but rather we need to implement either quadrature formulas for singular integrals or perform exact evaluations of the integrals in . to avoid the oscillations as in figure  [ fig : quadnewton]*(b )",
    "* , we added a small nonlinear diffusion term , i.e. , @xmath261 .",
    "here quadratic nonlinear diffusion is used , respecting the same nonlinearity and scaling as in the original equation @xmath262 .",
    "numerical experiments as in figure  [ fig : quadnewton]*(c ) * indicate that @xmath263 is close to optimal , in the sense that @xmath264 is just large enough to prevent the overshoot .",
    "this near optimal diffusion coefficient has been further confirmed by numerical experiments with different @xmath22 .      for the sake of clarity ,",
    "we show in figure  [ fig : optimaldx]*(a)*-*(b ) * the steady - state solutions computed on a finer mesh for the same cases as in figure  [ fig : quadnewton]*(a)*-*(b ) * along with the @xmath265 decay of @xmath164 errors for different grid sizes @xmath22 in figure  [ fig : optimaldx]*(c)*. the @xmath165 errors is almost constant and not decaying with mesh refinement .",
    "they clearly indicate that the overshoot amplitude seen in figures [ fig : quadnewton]*(b ) * and [ fig : optimaldx]*(b ) * is not reduced by mesh refinement and it needs the fix of small diffusion regularization . this will be further discussed in 2-d simulations below .            for the equation with @xmath272 , @xmath273 and @xmath274 ,",
    "the dynamics is similar to that in 1-d , being the result of the competition between the nonlinear diffusion @xmath275 and the nonlocal attraction @xmath276 .",
    "the evolution starting from the rescaled characteristic function supported on the square @xmath277\\times [ -3,3]$ ] is shown in figure  [ fig:2daggdiff ] . because the interaction represented by the kernel @xmath2 is nonzero for any @xmath278 , the final steady state consists of one single component ; however , four clumps are formed in the evolution , as the attraction dominates the relatively weak diffusion .",
    "[ ex310 ] similarly , overshoots may appear near the boundary of discontinuous solutions of @xmath279 with repulsive - attractive kernels @xmath5 .",
    "these overshoots can not be eliminated as easily as in one dimension , either by a careful choice of grid to align with the boundary or by a special numerical quadrature for @xmath280 .",
    "however , stable solutions can be obtained by adding small nonlinear diffusion as in example  [ ex37 ] .",
    "therefore , we consider the equation @xmath281 for quadratic attractive and newtonian repulsive kernel @xmath282 , the steady states are shown in figure  [ fig : quadlog2d ] , without @xmath283 or with the diffusion . the near optimal coefficient @xmath264 is numerically shown to be close to @xmath284 , exhibiting a similar mesh dependence as in example  [ ex37 ] . since @xmath5 is singular in this ( and next ) example ,",
    "@xmath285 is computed using gaussian quadrature with four points in each dimension , to avoid the evaluation of @xmath5 at the origin .",
    "[ ex311 ] another common pattern observed for the self - propelled particle systems with an attractive - repulsive kernel in 2-d is the rotating mill  @xcite , and the steady pattern can be obtained from the equation @xmath286 with some positive constants @xmath166 and @xmath287 . for the kernel @xmath288 ,",
    "the steady state is still a constant @xmath289 on an annulus , whose inner and outer radius are given by @xmath290 with the total conserved mass @xmath291 . for other more realistic kernels like the morse type  @xcite or quasi - morse type  @xcite ,",
    "the radial density is in general more concentrated near the inner radius , but the explicit form of @xmath160 can not be obtained in general .",
    "numerical diffusion , in the form of @xmath292 , is still needed to prevent the overshoot and the resulting steady states with @xmath293 are shown in figure  [ fig : mill ] for two different potentials .",
    "jac acknowledges support from projects mtm2011 - 27739-c04 - 02 , 2009-sgr-345 from agncia de gesti dajuts universitaris i de recerca - generalitat de catalunya , and the royal society through a wolfson research merit award .",
    "jac and yh were supported by engineering and physical sciences research council ( uk ) grant number ep / k008404/1 .",
    "the work of ac was supported in part by the nsf grant dms-1115682 .",
    "the authors also acknowledge the support by nsf rnms grant dms-1107444 .                                                                    , _ logarithmic potentials with external fields _ , vol .",
    "316 of grundlehren der mathematischen wissenschaften [ fundamental principles of mathematical sciences ] , springer - verlag , berlin , 1997 .",
    "appendix b by thomas bloom ."
  ],
  "abstract_text": [
    "<S> we propose a positivity preserving entropy decreasing finite volume scheme for nonlinear nonlocal equations with a gradient flow structure . </S>",
    "<S> these properties allow for accurate computations of stationary states and long - time asymptotics demonstrated by suitably chosen test cases in which these features of the scheme are essential . </S>",
    "<S> the proposed scheme is able to cope with non - smooth stationary states , different time scales including metastability , as well as concentrations and self - similar behavior induced by singular nonlocal kernels . </S>",
    "<S> we use the scheme to explore properties of these equations beyond their present theoretical knowledge . </S>"
  ]
}