{
  "article_text": [
    "almost all our information about astrophysical objects have been obtained by analyzing their radiation . therefore , radiative transfer ( rt ) modeling of spectra and images is a standard technique of astrophysical research .",
    "moreover , radiation transport is an important physical process to transport energy and momentum , often controlling the energy balance of the object , or altering its appearance by radiation pressure ( see , e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "given those two major applications of radiative transfer , it could be expected that radiative transfer modeling is a well - advanced and elaborated astrophysical tool being established for many years already . on the contrary ,",
    "the solution of 3d radiative transfer problems is still one of the outstanding challenges in computational astrophysics .",
    "this is due to the high dimensionality of the radiation field ( coordinates for the location in space , for the direction , the wavelength , and the time ) , the many orders of magnitude in the change of density and spatial scale that may have to be covered , the integro - differential character of the transport equation , and the nonlinear coupling of the different energies ranges through the local energy balance .",
    "together with the many free parameters entering complex structures , this also has prohibited modeling of images with inverse radiative transfer , aside from very simple cases where semi - analytical solutions can be found @xcite .",
    "the currently proposed methods to solve the continuum rt problem are based on the monte - carlo approach , finite differencing schemes on ( adaptive ) grids , moment approaches , and solving the radiative transfer equation along rays ( ray - tracing ) , often with a mixture of techniques implemented into one program .",
    "a common problem of most rt codes is the treatment of the densest regions of astrophysical objects like molecular cloud cores , accretion disks , or dust tori around active galactic nuclei , where the optical depths can reach high values like @xmath0 depending on the wavelengths of the considered radiation ( see tab .  1 for typical peak values ) .",
    "applied to these objects , monte carlo simulations have to calculate many interactions of the photons ( for an improvement see * ? ? ?",
    "* ) , adaptive grid techniques refine the regions into many cells @xcite , and ray - tracer are forced to do small tracing steps .",
    "moment methods are well - posed to treat the optically thick regime . however , in parts of the computational domain where the optical depth is at the order of or smaller than unity , the radiation field can become strongly varying with direction , and many orders of momenta are required to describe the radiation field correctly .",
    "moreover , errors in calculating the optically thick regions correctly have little influence on the energy balance within the computational domain , but will alter the appearance of the object strongly as the outgoing radiation of the optically thick regions defines the inner boundary for the layer of the object where the optical depth is of the order of unity .    ray - tracing solvers",
    "have the advantage that the numerical error can be controlled precisely .",
    "general purpose schemes to solve ordinary differential equations along rays are available in high - order accuracy and with adaptive step size control , like the advanced 5th - order runge - kutta solver proposed in @xcite .",
    "the drawback of such solvers , however , is that the known functions of the transport equations have to be evaluated very often in order to cancel all low - order error terms . aside from this",
    ", they are not making explicit use of the fact that the radiation field becomes very simple when the optically thick case is reached .",
    "the ray - tracing follows the transport of the radiation often given on an underlying grid . in the short characteristics approach ,",
    "the change of the intensity is interpolated onto the local grid ( see , e.g. , * ? ? ?",
    "* ) , while in long characteristics approaches , radiation is transported between two points .",
    "lcc environment & @xmath1 + low - mass molecular cloud core & 100 + massive molecular cloud core & @xmath2 + circumstellar disk around a young star & @xmath3 + dust torus around an active galactic nucleus & 100 +    for the case of the spectral energy distribution of a circumstellar disk around a low - mass star , different numerical rt techniques have been compared in to establish a benchmark for 2d continuum rt .",
    "a somewhat unrealistically flat radial profile with a power law index of -1 for the density distribution and a large inner radius was assumed to reduce the optical depth in the disk and therefore the numerical effort .",
    "steepening the radial profile towards more realistic values around -2 and assuming inner disk radii around a few stellar radii up to 10 stellar radii will increase the optical depth in the midplane to values around @xmath3 .",
    "the next step , therefore , is to develop numerical schemes that are able to perform accurate calculation even in region where the optical depth is larger than 100 . in this paper",
    ", we suggest a scheme for ray - tracing to overcome this problem .",
    "we propose to transform the ray equation into a form that is more appropriate for high - order ray - tracers applied to high - opacity structures . in sect .  2",
    ", we define the radiation transport equation and the intensity transformation as well as the modified transport equation .",
    "we discuss the advantages of the transformation in terms of limited machine precision and applicability of approximative tracing in the optically thick regions .",
    "we apply the solver to the test case of radiation crossing a medium with large density and temperature gradients in sect .  3 and compare the results to the solution obtained with common ray - tracing . in sect .  4 , we use the density structure from a recently performed multi - wavelength modeling of a complex dense molecular cloud core , rescaled to higher masses , to investigate the thermal influence of a nearby illuminating star .",
    "the findings are summarized in sect .",
    "while the scheme proposed in this paper is applicable to both line and continuum rt , we will introduce and demonstrate its capabilities by concentrating on continuum radiation .",
    "we consider a configuration of gas and dust being exposed to radiation from internal or external sources ( for astrophysical applications , these might be stars , nearby gas and dust etc . ) .",
    "the radiation may interact with the dust particles in form of absorption or scattering , and the dust particles are treated like black body emitters with the temperature @xmath4 .",
    "the stationary specific intensity @xmath5 of the radiation field is a function of the location @xmath6 , the direction @xmath7 , and the wavelength @xmath8 .",
    "the corresponding rt equation reads @xmath9 i_\\lambda(\\lambda,\\vec x,\\vec n ) + \\kappa^{abs}(\\lambda,\\vec x ) b_\\lambda[\\lambda , t(\\vec x)]\\cr & & \\frac{\\kappa^{sca}(\\lambda,\\vec x)}{4\\pi } \\int\\limits_\\omega   d\\omega'\\ p(\\lambda,\\vec n,\\vec n ' ) i_\\lambda(\\lambda,\\vec x,\\vec n')\\end{aligned}\\ ] ] with the phase function @xmath10 describing the probability to scatter radiation from direction @xmath11 into @xmath7 and the specific planck function @xmath12 at temperature @xmath4 .",
    "the absorption and scattering coefficients @xmath13 and @xmath14 are defined by the product of the number density at the location @xmath6 and the cross section for absorption and scattering , respectively .",
    "scattering of radiation at dust particles is important for short wavelengths and depends on the size , shape and chemical composition of the dust particles .",
    "the scattering integral in ( [ rte ] ) makes the application of an explicit ray - tracing scheme impossible , and iterative schemes are commonly used by fixing the intensity to a known start value @xmath15 , calculating the scattering integral , and solving ( [ rte ] ) for an updated @xmath16 until convergence is reached .",
    "another way is to split the intensity into an unprocessed , a scattered , and re - emitted component and to treat these components with different solvers .",
    "we will assume in this paper that the scattered part of the radiation is treated separately and will concentrate on the unprocessed and re - emitted radiation causing difficulties when regions of high optical depth are encountered .",
    "we trace the radiation along a ray with a given initial value @xmath17 at the point @xmath18 where @xmath19 is the coordinate along the ray .",
    "the solution of ( [ rte ] ) in the direction @xmath7 of the ray for vanishing scattering is @xmath20 + \\int\\limits_{0}^{x}dx'\\ \\kappa^{abs}(\\lambda , x ' ) b_\\lambda[\\lambda , t(x ' ) ] \\exp\\left[-\\tau(\\lambda , x',x)\\right]\\ ] ] with the optical depth @xmath21 introducing a typical length scale @xmath22 for changes in the intensity or density structure to be considered , we define a region within the computational domain to have a high optical depth if @xmath23 . for the case of local thermal equilibrium , eq .",
    "( [ solution ] ) approaches the limiting case @xmath24 $ ] as the local thermal emission dominates the intensity due to the strong damping of emission at preceding locations along the ray .",
    "although the differential equation is of simple structure and the solution incorporates only an integration over a known function , the numerical evaluation of ( [ solution ] ) is not straightforward .",
    "the reasons are the two exponential functions entering the radiation equation .",
    "first , the exponential containing the optical depth has to be calculated precisely along the ray . given a limited computational range of the computer , an optical depth of 1000 usually exceeds these limits and makes it necessary to renormalize the intensity .",
    "second , the planck function @xmath25 rises sharply with @xmath8 for temperatures in the wien part @xmath26 , with @xmath27 and @xmath28 .    a substitution of the intensity transforming the quantities into a range where numerical limits of the computer are not encountered and the exponential terms of the equation can be controlled is therefore desired .",
    "another requirement for the ray - tracing is speed . to model complex density structures , a parameter number of several hundreds is usually required .",
    "given a certain parameter set describing the density structure , the temperature within the object is determined and used to calculate theoretical images at different wavelengths .",
    "these images are compared with the observed images and a minimization tool like simulated annealing is used to optimize the model parameters .",
    "assuming several thousand pixels to be fitted simultaneously , and a minimum of @xmath3 steps of the optimization tool , the total number of rays often exceeds @xmath29 . to perform the calculation within a reasonable time",
    ", the ray - tracer should be optimized with respect to speed .",
    "an advanced ray - tracer with 5th - order accuracy has been proposed by @xcite , based on the runge - kutta scheme .",
    "it is coupled with an adaptive step size control using an embedded form of the 4th - order runge - kutta formula . as parameters for the error truncation ,",
    "values determined by @xcite are used .",
    "the disadvantage of this tracer is that the density and the temperature function are called six times each in every tracer step .",
    "each of the called functions contains several hundred parameters for a complex 3d structure making an evaluation expensive . on the other side ,",
    "the tracer steps are chosen adaptively and with full error control .",
    "the tracer is therefore the first choice for astrophysical problems with moderate optical depths variations .",
    "a major numerical difficulty arises for regions with high optical depth @xmath30 .",
    "neglecting scattering , the change in the intensity expressed in the right - hand side of ( [ rte ] ) is proportional to @xmath31 .",
    "having calculated the intensity at a point @xmath6 , the difference @xmath32 is small as the local thermal emission dominates the radiation field in the optically thick regime .",
    "a small change in the intensity suggests that the solver is able to perform large spatial steps .",
    "however , the difference @xmath32 is multiplied with the large absorption term @xmath31 amplifying any change in the source term that is arising from the spatial variation in the temperature . to meet the accuracy requirements",
    ", the tracer therefore performs small steps although the change in the intensity is known in the optically thick limit and the local source term has no strong gradients .",
    "a modification of the tracer , therefore , would be desirable in order to both crossing the regions of high optical depths quickly without introducing large errors and to keep the solution away from the floating point limits .    in order to develop a ray - tracer meeting those requirements and being acceptable in terms of computational effort",
    ", we introduce the relative intensity @xmath33 for a vanishing source function , it approaches unity , and for the optically thick part with @xmath34 , @xmath35 has a value close to @xmath36 .",
    "inserted into ( [ rte ] ) and neglecting scattering , we obtain the differential equation @xmath37 \\left ( \\kappa^{abs}(\\lambda , x)\\left[1 - 2d_\\lambda(\\lambda , x)\\right]- \\frac{d_\\lambda(\\lambda , x)}{b_\\lambda(\\lambda , x ) } \\frac{db_\\lambda(\\lambda , x)}{dx } \\right).\\ ] ] the relative intensity is chosen in a way that the source function in the differential equation with the exponential dominating the wien approximation regime is transformed to the function @xmath38 the denominator @xmath39 $ ] has a value close to 1 for @xmath40 so that the exponential terms no longer cause numerical problems .",
    "another question is if the used rational function transformation amplifies numerical errors .",
    "however , no strong solution error amplification is introduced by transforming to the relative intensity , as the relative error in @xmath35 @xmath41 is at most only about a factor 2 larger than the error in the intensity if @xmath42 .    to obtain a criterion for the use of an approximate solver in the optically thick region @xmath43",
    ", we introduce a positive limit @xmath44 for the relative difference of intensity and planck function with @xmath45 using 1st - order finite differencing for ( [ rte ] ) for two neighboring points @xmath46 and @xmath47 and neglecting scattering , the limiting case of condition ( [ epsi ] ) reads @xmath48 with @xmath49 and @xmath50 .",
    "the sign in front of @xmath44 refers to the sign of @xmath51 .",
    "the condition is fulfilled either due to small relative changes in the source term @xmath52 or a large local optical depth @xmath53 . in a pre - calculation along the ray , the regions where the condition is fulfilled can be identified .",
    "then , a fast solution can be obtained for these region by performing large steps while assuming @xmath54 . as the limit for validity",
    ", we have used @xmath55 in this paper .",
    "to test the proposed ray - tracer , we choose a configuration with variations in the local optical depth covering six orders of magnitude .",
    "the temperature profile is chosen so that it includes both external heating and a deeply embedded radiation source . such a configuration is often found , e.g. , in star formation regions where young stars illuminate clouds where others embedded star are currently forming .",
    "as density profile , a sum over two gaussian distributions is used for the number density of the absorbing material ( representing , e.g. , two molecular clouds containing gas and dust ) @xmath57 + n_2\\exp\\left[-\\left(\\frac{z - z_2}{w_2}\\right)^2\\right]\\ ] ] with the two optical depths ( @xmath58 ) @xmath59 having the values @xmath0 and @xmath3 , respectively , the absorption cross section @xmath60 , and introducing the dimensionless spatial variable @xmath61 .",
    "the widths of the gaussians are chosen as @xmath62 and @xmath63 .",
    "we will calculate the intensity along a representative ray that crosses both density maxima and encounters strong variations in the source term . in a real application , of course",
    ", all rays will be calculated ( see sect .  4 ) .    without calculating the correct temperature reached in local thermal equilibrium for this test case ,",
    "we assume a temperature distribution close to what can be expected for the density distribution defined in ( [ ndens ] ) @xmath64 + t_4\\exp\\left[-\\left(\\frac{z - z_4}{w_4}\\right)^2\\right ] + t_{bg}.\\ ] ] the first term represents a temperature profile arising from an external heating by a distant radiation source ( e.g. a star ) located in an optically thin region at large negative @xmath65 ( @xmath66 k , @xmath67 ) .",
    "numerically , this corresponds to an exponential drop of the intensity that would quickly reach the machine precision limit without a source term .",
    "therefore , the source term contribution , although being low , is determining the intensity in the center of the clump and saves the solver from failing due to precision problems .",
    "an intermediate region is reached between the two clumps where external radiation can illuminate the material from other directions .",
    "therefore , we have chosen the temperature to have a broad gaussian profile with @xmath68 k , @xmath69 , and @xmath70 , peaking where the density has a minimum .",
    "the second clump is less dense , but hosts an embedded source of heat represented by the second compact gaussian profile in ( [ temp ] ) with @xmath71 k , @xmath72 , and @xmath73 . in this case , the tracer enters a region where the source distribution rises sharply and dominates the radiation field again .",
    "a constant background radiation field in the far - infrared wavelength region will heat up the matter slightly , represented in our test case by the constant background temperature @xmath74 k.    we have chosen a wavelength of @xmath75 m for this test case because the thermal emission defined by the temperature profile defined in ( [ temp ] ) gives a substantial contribution to the radiation field .",
    "note that in common star formation regions , the local optical depth will reach @xmath0 only in the densest regions at this wavelength .",
    "[ fig:1 ] gives an overview over the test case and the numerical solution of the corresponding radiative transfer equation .",
    "the upper left panel shows the local optical depth @xmath76 as a function of @xmath65 with the two gaussian profiles establishing a density change of up to six orders of magnitude . in the lower left panel ,",
    "the temperature variation along the ray is given , with a slow decrease in the outer parts of the first density clump , a local maximum between the clumps , and a strong bump in the center of the second density maximum .",
    "applying the runge - kutta scheme with an solution accuracy of @xmath77 and @xmath78213000 main tracing steps to the entire region , we show in the upper right panel the numerical solution of the radiative transport equation @xmath79 along the ray .",
    "the normalized intensity decreases exponentially from the start value 1 , entering a region where the thermal emission dominates the solution at @xmath80 .",
    "the shape of the intensity reproduces the temperature side maximum at @xmath81 . at @xmath82 ,",
    "the planck function rises quickly due to the thermal peak centered at @xmath83 .",
    "the gaussian shape in the intensity is broader than the corresponding temperature profile as the optical depth is @xmath84 so that a small contribution of preceding radiation is added to the local thermal emission in the source integral of ( [ solution ] ) . an additional factor for the broadening",
    "is that for low temperatures @xmath85 , the planck function rises as @xmath86 $ ] , while around the peak at @xmath83 with @xmath87t(z ) it is turning to follow the @xmath88-dependence for the large temperatures .",
    "the solution of the transport equation using the proposed tracer for the relative intensity @xmath89 , transformed back to an intensity @xmath90 using ( [ relint ] ) , is overlayed in the upper right panel and can not be distinguished from @xmath91 .",
    "the absolute value of the difference between the full solution and the relative solution @xmath92 is shown in the lower right panel , normalized to the start intensity ( thin line ) .",
    "the dotted vertical lines at @xmath93 and @xmath94 indicate where the relative tracer has switched to an accelerated crossing of the optically region and back to full tracing , respectively .    before discussing the solution error ,",
    "it should be considered that calculating the difference of the solutions requires to interpolate one solution onto the other , as they have been obtained using different adaptive step sizes .",
    "this introduces a new interpolation error into the difference that has to be distinguished from the error related to the solution process . to estimate the order of magnitude interpolation error",
    ", we have overplotted in the lower right panel the absolute value of the error of a linear interpolation of the full normalized intensity onto the z - values of the relative intensity values as a thick line .",
    "the second derivative of @xmath95 can not be used , as the full solution is only known at discrete values , so that calculating the second derivative would introduce new interpolation errors into the error analysis .",
    "we therefore estimate the error in the optically thick regions with @xmath96 to be @xmath97 with the second derivative of the planck function being @xmath98.\\ ] ] the interpolation error shown as a thick line in the lower right panel starts at a high value of @xmath99 as the step size of the full tracer is large in the region where the density is low and the thermal contributions are small .",
    "the error becomes very small in the region of high optical depth as the full tracer is enforced to use small steps entering the interpolation error quadratically .",
    "the interpolation error has roots wherever the temperature has extrema as @xmath100 .    for small @xmath65 ,",
    "the plotted solution difference is of the order of the interpolation error , and the real difference is likely to be much smaller as both solutions are obtained by the 5th - order runge - kutta scheme in this region . in the optically thick region between the first two dotted lines ,",
    "the interpolation error is below @xmath101 , and the thin curve shows the difference between the full scheme and the rapid cross stepping used by the relative solver .",
    "still , this error is small and reveals the real benefit of the accelerated tracer . while the full solver spends 209000 grid points to trace the thick region , the relative solver uses 240 steps only with a difference in the solution that is of the order of @xmath102 to @xmath77 .",
    "a second pair of dotted lines appears at @xmath103 , but the interval is so small that it appears as one line .",
    "the reason that the relative solver is not switching to larger steps although the local optical depth is @xmath3 for the second density maximum is related to the large gradient in the source function . only in the maximum of the source term ,",
    "the change in the source function becomes small enough so that the change in the relative intensity allows large stepping for a small range .",
    "the difference in the two full solutions is up to an order of magnitude larger than the @xmath77-accuracy limit of the 5th - order runge - kutta scheme , as the error in d is twice the error in i , and interpolation errors and tracer errors are added up in the thin line .    to summarize the findings for this particular test case , the relative tracer can reproduce the solution achieved by the full tracer with an accuracy of about @xmath104 while it crosses the optically very thick regions 870 times faster than the full tracer .",
    "the relative tracer is sensitive to changes in the source function to achieve this accuracy even in cases where strong intensity changes are caused by a varying source function within optically thick regions .",
    "the concrete gain in performance when using the relative tracer will depend on the extent and optical depth value of the dense regions to be crossed as well as on the occurrence of complications like embedded sources .",
    "we have performed 1000 test runs with varying total optical depth , density gradient , and source function gradient to explore the overall influence of the dominant ingredients on the run time and the error maximum .",
    "the resulting dependencies are shown in fig .",
    "[ fig:2 ] .",
    "the top right panel shows the relation between the total optical depth for a ray crossing the considered region and the run time normalized to the test case discussed in this section .",
    "they are directly proportional , as the adaptive steps of the runge - kutta solver scale inversely with the optical depth . for higher optical depth ,",
    "the approximation of the relative tracer is better fulfilled , decreasing the maximal error for higher total optical depth .",
    "therefore , the maximal error decreases inversely with the run time , as shown in the top left panel . the dependence on the density gradient is depicted in the lower left panel . for small run times , the run time rises linearly with maximal density gradient .",
    "this rise gets weaker for larger run times , as most of the run time is taken by the overall high optical depth .",
    "the lower right panel shows that there is no dependency of the run time on the gradient in the source function as the large optical depth dominates the run time in the region where the relative intensity solver is used .",
    "to demonstrate the capabilities of the new ray - tracing scheme , we apply the scheme to a more realistic astrophysical problem , incorporating a large number of ray - tracing calculations through a high - opacity massive molecular cloud core .",
    "these cores are of particular interest as they are thought to be the progenitors of young stars .",
    "characterizing their physical conditions will lead to a better understanding of how stars are forming in molecular clouds .",
    "the detailed understanding of images of cores crucially relies on the knowledge of the 3d structure , as projection effects limit the reliability of simple 1d modeling ( e.g. , * ? ? ?",
    "* ) . in , we have fitted images of the cloud core @xmath105 oph d in the star formation region rho ophiuchi that have been obtained at mid - infrared ( mir ) and mm - wavelengths .",
    "the complex elongated structure was modeled using a series of 30 3d gaussian distributions , determining both the density and temperature structure by inverse multi - wavelength 3d continuum radiative transfer .",
    "the density structure deviates significantly from spherical symmetry and has several local maxima .",
    "hence , it is well - suited to serve both as a realistic test application for the ray - tracing scheme and as a representative shape of a dense core .",
    "the total core mass of 2.3 solar masses , however , is not sufficient to reach substantial optical depth ( @xmath10610 ) at mir wavelengths .",
    "we therefore increase the core density uniformly by a factor of 100 until the optical depth ranges from 0.1 to 1000 , placing the core among the most massive dense cores .",
    "the temperature structure for the high mass core is very different from the distribution determined for moderate optical depths and an outer radiation field of a low - mass star formation site like rho ophiuchi .",
    "it depends on the radiation field produced by nearby stars , which is most likely dominated by the massive stars in the considered star - forming region .",
    "the strong pressure of their emitted radiation and the stellar wind alter the structure of the parental molecular cloud substantially by opening up gaps and compressing the cloud material .    in this section",
    ", we assume that the cloud core is still surrounded by a diffuse molecular cloud with an optical depth of 1 at @xmath107 nm , and that a nearby b6 star at a distance of 1 pc is illuminating the core",
    ". the strong uv radiation of the star can not penetrate the parent cloud and is absorbed by gas , dust particles , and polyaromatic hydrocarbons ( pahs ) in a layer called a photon dominated region ( pdr ) .",
    "the chemical and radiative processes along with the gas dynamics are complex and definitely beyond the scope of this paper . here",
    ", we want to adopt a very simple model for such a pdr region and concentrate on the treatment of the continuum radiation . assuming that all kinematic effects of the radiation and of a possible wind are influencing only the outer layers of the parent cloud , still the long - wavelength part of the radiation is able to reach the dense core deep in the cloud and",
    "the gas atoms , molecules , and dust particles convert the uv radiation to radiation at longer wavelength which propagates deeper into the cloud and the dense core before being absorbed and re - emitted at far - infrared wavelengths . for this test application",
    ", we will neglect the possible influence of a shock front that is formed by the radiation ram pressure and serves as an additional source of energy .",
    "we also neglect heating from molecular lines other than pah emission .",
    "the density and temperature of the dense core is discretized on a 3d grid with @xmath108 grid cells . to calculate the incoming energy density of the stellar radiation , @xmath109 traces have to be performed to derive the column density from the star to the cell . then",
    ", in each cell , the stellar intensity of the cells can be determined for all wavelengths .",
    "the pdr is discretized by a layer with @xmath110 cells at a distance of 0.5 pc covering a cloud surface of 0.25 pc@xmath111 .",
    "the emission of dust particles can be treated as black body radiation for particles with a size of @xmath112 m , making it possible to calculate the energy balance for the dust particles in each cell quickly .",
    "smaller dust particles and pahs absorb and re - emit the radiation time - dependently , substantially increasing a numerical treatment . for the purpose of this test calculation",
    ", we will therefore assume that the conversion factor of stellar energy from the uv to optical wavelengths by the pdr is a known value @xmath113 and parameterize the pdr spectrum by a power - law in wavelength of the form @xmath114 between 5 @xmath115 m and 18 @xmath115 m . to calculate the density of the radiative energy absorbed in the cells , @xmath116 traces have to be performed ( we have chosen @xmath117 ) .",
    "the interstellar radiation field will mainly contribute to the heating in the far - infrared ( fir ) .",
    "assuming it to illuminate the configuration isotropically , we have to perform traces covering all directions .",
    "as direction grid on the unit sphere , we use an equally - spaced distribution of @xmath118 points optimized for integration purposes using simulated annealing @xcite . the spectrum proposed by was used for the interstellar radiation field . in total , @xmath119 traces have to be performed to determine the heating by the interstellar radiation field .",
    "the density at any location was calculated from the grid using 1st - order interpolation .    finally , to obtain a self - consistent temperature distribution",
    ", the cell - cell illumination has to be considered incorporating @xmath120 traces for the column density between the cells , where @xmath121 is the number of iteration to reach convergence of the cell temperatures . for cores ,",
    "the self - heating is restricted to the fir- and mm - wavelengths range as the dust particles have low temperatures around 20 k. this contribution to the cell temperature is low , though , since the absorption and re - emission coefficient @xmath122 decreases as @xmath123 in this region .",
    "thus , the temperature converges to a solution after only a few iterations .",
    "the total amount of traces for this example adds up to @xmath124 encountering integrated optical depth up to @xmath3 .",
    "we have used the optical dust properties of silicate particles of size 0.1 @xmath115 m proposed in @xcite in this calculation .",
    "[ fig:3 ] shows the optical depth @xmath125m@xmath126 for rays crossing the core parallel to the x - axis ( y and z are given in arbitrary coordinates in the plane of sky ) .",
    "the optical depth reaches values around 500 in the densest parts .",
    "the resulting temperature structure is visualized in fig .",
    "[ fig:4 ] for the case of external heating by the interstellar radiation field .",
    "the contour plot shows a cut through the temperature cube in a plane parallel to the plane of sky including the point with the temperature minimum . in massive star formation regions ,",
    "this is the case only when no massive star has formed in the vicinity yet .",
    "[ fig:5 ] gives the temperature in the same plane when a nearby b6 star and the corresponding pdr is present .",
    "while the isotropic interstellar illumination yields a temperature structure that is similar to the density structure , the beamed illumination by the star and the pdr causes shadowing effects with low temperature behind density maxima .",
    "this effect will be important for the collapse of the core due to self - gravity as the local instability criterion depends on the temperature .",
    "the influence of external heating by nearby stars will be investigated further in a forthcoming paper .",
    "there is a variety of astrophysical applications requiring the calculation of the radiation field in complex structures with regions of high optical depth .",
    "current radiative transfer codes suffer from the high computational cost to determine the radiation field for such cases as the existing solution algorithms are often not suited for high optical depths . in this publication , we have suggested a ray - tracing scheme designed for the analysis of complex and dense structures based on 3d radiative transfer .",
    "analyzing accuracy , numerical effort , and stepsize for the example of continuum radiation , we have found it to be well - suited for applications including regions of arbitrary high optical depth and a vast number of required ray - traces . for the test case being investigated , the tracer was about 870 times faster than the full 5th - order runge - kutta tracer with a loss of only one order of magnitude in accuracy .",
    "we have applied the scheme to a massive molecular cloud core illuminated by a nearby massive star . using a simple model for a photon - dominated region at the surface of the parent molecular cloud ,",
    "we have compared the 3d temperature structure within the core for two cases : ( i ) an illumination by the interstellar radiation field and ( ii ) an illumination by a nearby massive star and a corresponding photon - dominated region .",
    "stellar illumination produces shadowed regions of colder gas and dust which will influence the evolution of the core possibly forming stars .",
    "bacmann , a. , andr ' e , p. , puget , j .- l . , abergel , a. , bontemps , s. , & ward - thompson , d.2000 , , 361 , 555 cash , j.  r. , karp , a.h .  1990 , acm transactions on mathematical software , 16 , 201 draine , b.  t. , & lee , h.  m.  1984 , , 285 , 89 henning , th .",
    "2001 , asp conference series , 2001 .",
    "hubeny , i.  1978 , springer , 1978 .",
    "mihalas , d.  1978 , san francisco , w.  h.  freeman and co. , 1978 .",
    "mellema , g. , iliev , i.  t. , alvarez , m.  a. , & shapiro , p.  r.  2006 , new astronomy , 11 , 374 kudritzki , r.  p. , & hummer , d.  g.  1990 , , 28 , 303 liseau , r. , et al .   1999 , , 344 , 342 pascucci , i. , wolf , s. , steinacker , j. , dullemond , c.  p. , henning , t. , niccolini , g. , woitke , p. , & lopez , b.  2004 , , 417 , 793 press , w.h . , teukolsky , s.a . ,",
    "vetterling , w.t . ,",
    "flannery , b.p .",
    "1978 , cambridge university press , 1998 .",
    "p. , & lopez , b.  2004 , , 417 , 793 richling , s. , & yorke , h.  w.  2000 , , 539 , 258 steinacker , j. , thamm , e. , & maier , u.  1996 , journal of quantitative spectroscopy and radiative transfer , 56 , 97 steinacker , j. , bacmann , a. , & henning , t.  2002 , journal of quantitative spectroscopy and radiative transfer , 75 , 765 steinacker , j. , michel , b. , & bacmann , a.  2002 , journal of quantitative spectroscopy and radiative transfer , 74 , 183 steinacker , j. , henning , t. , bacmann , a. , & semenov , d.  2003 , , 401 , 405 steinacker , j. , lang , b. , burkert , a. , bacmann , a. , & henning , t.  2004 , , 615 , l157 steinacker , j. , bacmann , a. , henning , t. , klessen , r. , & stickel , m.  2005 , , 434 , 167 van der werf , p.  p. , stutzki , j. , sternberg , a. , & krabbe , a.  1996 , , 313 , 633 watabe , y. , & umemura , m.  2005 , , 618 , 649 wolf , s.  2003 , computer physics communications , 150 , 99 wu , y. , zhu , m. , wei , y. , xu , d. , zhang , q. , & fiege , j.  d.  2005 , , 628 , l57 yorke , h.  w. , & sonnhalter , c.  2002 , , 569 , 846 zucconi , a. , walmsley , c.  m. , & galli , d.  2001 , , 376 , 650                . the core is heated by a nearby b6 star , a corresponding pdr , and the interstellar radiation field .",
    "the numbers give the temperature in k with a 1 k stepping in the contours .",
    "the local plane - of - sky - coordinates are arbitrary . in this orientation ,",
    "the star and pdr are located above the picture .",
    ", width=566 ]"
  ],
  "abstract_text": [
    "<S> we present a ray - tracing technique for radiative transfer modeling of complex three - dimensional ( 3d ) structures which include dense regions of high optical depth like in dense molecular clouds , circumstellar disks , envelopes of evolved stars , and dust tori around active galactic nuclei . </S>",
    "<S> the corresponding continuum radiative transfer problem is described and the numerical requirements for inverse 3d density and temperature modeling are defined . </S>",
    "<S> we introduce a relative intensity and transform the radiative transfer equation along the rays to solve machine precision problems and to relax strong gradients in the source term . for the optically thick regions where common ray - tracers are forced to perform small trace steps , we give two criteria for making use of a simple approximative solver crossing the optically thick region quickly . using an example of a density structure with optical depth changes of 6 orders of magnitude and sharp temperature variations , </S>",
    "<S> we demonstrate the accuracy of the proposed scheme using a common 5th - order runge - kutta ray - tracer with adaptive step size control . in our test case , </S>",
    "<S> the gain in computational speed is about a factor of 870 . </S>",
    "<S> the method is applied to calculate the temperature distribution within a massive molecular cloud core for different boundary conditions for the radiation field . </S>"
  ]
}