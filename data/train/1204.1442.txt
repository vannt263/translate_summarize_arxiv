{
  "article_text": [
    "various stochastic partial differential equations ( spdes ) have emerged over the last two decades in different areas of mathematical finance .",
    "a classical example is the heath - jarrow - morton interest rate model @xcite of the form @xmath0 where @xmath1 is the forward rate of tenor @xmath2 at time @xmath3 and @xmath4 its instantaneous volatility . in @xcite ,",
    "a similar equation has been proposed more recently to model electricity forwards .",
    "most of the spdes studied share with ( [ hjm ] ) the property that the derivatives of the solution only appear in the drift term ; in the case of ( [ hjm ] ) the volatility of the brownian driver does not depend on the solution @xmath5 at all .",
    "numerical methods for hyperbolic spdes of the type ( [ hjm ] ) have been studied , for example , in @xcite .",
    "this article , in contrast , considers the parabolic spde @xmath6 where @xmath7 is a standard brownian motion , and @xmath8 and @xmath9 are real - valued parameters .",
    "it is clear that the behaviour of this equation is fundamentally different from those with additive or multiplicative noise .",
    "the significance of ( [ spde ] ) for the following applications is that it describes the limiting density of a large system of exchangeable particles .",
    "specifically , if we consider the system of sdes @xmath10 for @xmath11 , with @xmath12 and @xmath13 , where @xmath14 are assumed i.i.d .  with finite second moment , the empirical measure @xmath15 has a limit @xmath16 for @xmath17 ,",
    "whose density @xmath18 satisfies ( [ spde ] ) in a weak sense . for a derivation of this result in the more general context of quasi - linear pdes",
    "see @xcite .",
    "while the motivation in @xcite is to use a large particle system ( [ sdesys ] ) to approximate the solution to the spde ( [ spde ] ) , our view point is to use ( [ spde ] ) as an approximate model for a large particle system , and we will argue later the ( computational ) advantages of this approach in situations when the number of particles is large .    as a first possible application , one may consider @xmath19 as the log price processes of a basket of equities , which have idiosyncratic components @xmath20 and share a common driver @xmath7 ( the `` market '' ) . if the size of the basket is large enough , the solution to the spde can be used to find the values of basket derivatives . in this paper , we study an application of a similar model to basket credit derivatives .",
    "we mention in passing that equations of the form ( [ spde ] ) arise also in stochastic filtering .",
    "to be precise , ( [ spde ] ) is the zakai equation for the distribution of a signal @xmath21 given observation of @xmath7 , see e.g.  @xcite .",
    "it is interesting to note that the solution to the spde ( [ spde ] ) without boundary conditions can be written as the solution of the pde @xmath22 shifted by the current value of the brownian driver , @xmath23 in particular , if @xmath24 , then @xmath25    the intuitive interpretation of this result is that the independent brownian motions @xmath20 have averaged into a deterministic diffusion in the infinite particle limit , whereas the common factor @xmath7 , which moves all processes in parallel , shifts the whole profile ( and also adds to the diffusion , via the it term ) .    in @xcite , the analysis of the large particle system",
    "is extended to cases with absorption at the boundary ( @xmath26 ) , @xmath27 it is shown that there is still a limit measure @xmath16 , which may now be decomposed as @xmath28 where @xmath29 is the proportion of absorbed particles ( the `` loss function '' ) , and the density @xmath18 of @xmath30 satisfies ( [ spde ] ) in @xmath31 with absorbing boundary condition @xmath32    @xcite consider applications to basket credit derivatives . for the market pricing examples ,",
    "they consider a simplified model , where defaults are monitored only at a discrete set of dates . between these times , the default barrier is inactive and ( [ spde ] ) is solved on the real line by using ( [ pde ] ) and ( [ shift ] ) .    for the initial - boundary value problem ( [ spde ] ) , ( [ bc ] ) ,",
    "however , such a semi - analytic solution strategy is no longer possible and an efficient numerical method is needed .",
    "moreover , there is a loss of regularity at the boundary in this case , such that @xmath33 but not @xmath34 , as is documented in @xcite .",
    "recent papers on the numerical solution of spdes deal with cases relevant to ours , yet structurally crucially different .",
    "a comprehensive analysis of finite difference and finite element discretisations of the stochastic heat equation with multiplicative white noise and non - linear driving term is given in @xcite and @xcite , respectively .",
    "@xcite shows a lax equivalence theorem for the sde @xmath35 in a hilbert space , driven by a process @xmath7 from a class including brownian motion , where @xmath36 is a suitable ( e.g.  elliptic differential ) operator and @xmath37 a lipschitz function .    in this paper",
    ", we propose a milstein finite difference discretisation for ( [ spde ] ) and analyse its stability and convergence in the mean - square sense by fourier analysis .",
    "a main consideration of this paper is the computational complexity of the proposed methods , and we will demonstrate that a multilevel approach achieves a cost for the spde simulation no larger than that of direct monte carlo sampling from a known univariate distribution , @xmath38 for r.m.s .",
    "accuracy @xmath39 , and is in that sense optimal .",
    "multilevel monte carlo path simulation , first introduced in @xcite , is an efficient technique for computing expected values of path - dependent payoffs arising from the solution of sdes .",
    "it is based on a multilevel decomposition of brownian paths , similar to a brownian bridge construction .",
    "the complexity gain can be explained by the observation that the variance of high - level corrections  involving a large number of timesteps  is typically small , and consequently only a relatively small number monte carlo samples is required to estimate these contributions to an acceptable accuracy .",
    "overall , for sdes , if a r.m.s .",
    "accuracy of @xmath40 is required , the standard monte carlo method requires @xmath41 operations , whereas the multilevel method based on the milstein discretisation @xcite requires @xmath38 operations .",
    "the first extension of the multilevel approach to spdes was for parabolic pdes with a multiplicative noise term @xcite .",
    "there have also been recent extensions to elliptic pdes with random coefficients @xcite .",
    "our approach , for a rather different parabolic spde , is similar to the previous work on sdes and spdes in that the solution is decomposed into a hierarchy with increasing resolution in both time and space",
    ". provided the variance of the multilevel corrections decreases at a sufficiently high rate as one moves to higher levels of refinement , the number of fine grid monte carlo simulations which is required is greatly reduced .",
    "indeed , the total cost is only @xmath38 to achieve a r.m.s",
    ".  accuracy of @xmath40 compared to an @xmath42 cost for the standard approach which combines a finite difference discretisation of the spatial derivative terms and a milstein discretisation of the stochastic integrals .",
    "the rest of the paper is structured as follows .",
    "section [ sec : finite - difference ] outlines the finite difference scheme used , and analyses its accuracy and stability in the standard monte carlo approach .",
    "section [ sec : multilevel ] presents the modification to multilevel path simulation of functionals of the solution .",
    "numerical experiments for a cdo tranche pricing application are given in section [ sec : results ] , providing empirical support for the postulated properties of the scheme and demonstrating the computational gains achieved .",
    "section [ sec : conclusions ] discusses the benefits over standard monte carlo simulation of particle systems and outlines extensions .",
    "integrating ( [ spde ] ) over the time interval @xmath43 $ ] gives @xmath44 making the approximation @xmath45 for @xmath46 in the first integral and @xmath47 in the second , and noting the standard it calculus result that @xmath48 where @xmath49 with @xmath50 , @xcite , leads to the milstein semi - discrete approximation @xmath51 using a spatial grid with uniform spacing @xmath52 , standard central difference approximations to the spatial derivatives @xcite then give the finite difference equation @xmath53 in which @xmath54 is an approximation to @xmath55 .",
    "the spatial domain is truncated by introducing an upper boundary at @xmath56 and using the boundary condition @xmath57 .",
    "since the initial distribution will be assumed localised , both the localisation error for a given path @xmath7 , and the expected error of functionals of the solution , can be made as small as needed by a large enough choice @xmath58 .",
    "the system of sdes can then be written in matrix - vector form @xmath59 where @xmath60 is the vector with elements @xmath61 and @xmath62 and @xmath63 are the matrices corresponding to first and second central differences as explicitly given in appendix [ sec : matanal ] .",
    "[ remark - mol ] an alternative discretisation arises if the spatial derivatives are discretised first , and the milstein scheme is applied to the resulting system of sdes .",
    "the practical implication is that the it term then contains a second finite difference with twice the step size , @xmath64 instead of @xmath63 , resulting in pentadiagonal discretisation matrices instead of tridiagonal ones , specifically @xmath65 the accuracy and stability of the two schemes are similar , hence we will not go into details .    to approximate the initial condition on the grid , we apply the initial measure @xmath66 to a basis of ` hat functions ' @xmath67 , where @xmath68 giving @xmath69 for the corresponding pde ( @xmath70 ) , this is known to result in @xmath71 convergence provided",
    "@xmath72 satisfies a certain stability limit , even when the initial data are not smooth @xcite .",
    "we will see that an extension of this analysis holds for spdes .",
    "finite difference fourier stability analysis ignores the boundary conditions and considers fourier modes of the form @xmath73 which satisfy ( [ discrete ] ) provided @xmath74 where @xmath75 b(\\theta ) & = & -\\ , \\frac{i \\sqrt{\\rho\\ , k}}{h}\\ , \\sin \\theta , \\\\[0.05 in ] c(\\theta ) & = & -\\ , \\frac{2\\ , \\rho\\ , k}{h^2 } \\sin^2 { { \\textstyle \\frac{\\theta}{2 } } } .\\end{aligned}\\ ] ] following the approach of mean - square stability analysis from @xcite , we obtain @xmath76   & = & { \\mathbb{e}}\\left [ ( a + b\\ , z_n + c\\ , z_n^2)(a^ * + b^ * z_n + c^ * z_n^2)\\   |g_n|^2 \\right ] \\\\[0.1 in ] & = & \\left ( \\ , |a\\!+\\!c|^2 + |b|^2 + 2 |c|^2 \\,\\right)\\ { \\mathbb{e}}\\left[\\ , |g_n|^2 \\right],\\end{aligned}\\ ] ] where @xmath77 denotes the complex conjugate of @xmath78 . mean - square stability therefore requires @xmath79 and enforcing this for all @xmath80 leads to the two conditions summarised in the following theorem .",
    "the milstein finite difference scheme ( [ discrete - sys ] ) is stable in the mean - square sense provided @xmath81    the analysis in appendix [ sec : matanal ] combines mean - square and matrix stability analysis to prove that in the limit @xmath82 the condition @xmath83 is also a sufficient condition for mean - square stability of the initial - boundary value problem with the boundary conditions at @xmath84 and @xmath85 .",
    "fourier analysis can also be used to examine the accuracy of the finite difference approximation in the absence of boundary conditions .",
    "considering a fourier mode of the form @xmath86 the pde ( [ pde ] ) reveals that @xmath87 and therefore @xmath88 where @xmath89 .",
    "fourier analysis of the discretisation gives @xmath90 where @xmath91 , @xmath92 , @xmath93 are as defined before .",
    "writing @xmath94 we obtain , after performing lengthy expansions using matlab s symbolic toolbox , @xmath95 where , for all @xmath96 , @xmath97 \\le c(\\kappa , p ) \\left(k^2 + k h^2\\right)^p.\\ ] ] when summing over @xmath98 timesteps , @xmath99 and @xmath100 are both @xmath101 since they have zero expectation and @xmath102 variance .",
    "hence , it follows that @xmath103\\right)^{1/2}= o(k , h^2),\\ ] ] so the rms error in the fourier mode over the full simulation interval is @xmath104 .    following the method of analysis in @xcite",
    ", it can be deduced from this that the rms @xmath105 and @xmath106 errors for @xmath60 are both @xmath107 .",
    "this is consistent with the usual @xmath107 accuracy of the forward - time central space discretisation of a parabolic pde @xcite , and the @xmath108 strong accuracy of the milstein discretisation of an sde , see e.g.@xcite .",
    "we now test the accuracy and stability of the scheme numerically .",
    "the chosen parameters for ( [ spde ] ) are @xmath109 , @xmath110 , @xmath111 , @xmath112 , @xmath113 with @xmath114 .",
    "these values are typical for the applications later on .",
    "the upper boundary for the computation is @xmath115 , and chosen to ensure that the use of zero dirichlet data has negligible influence on the solution .",
    "we approximate the initial value problem without boundary conditions on @xmath116 $ ] ( note @xmath117 is roughly in the centre ) , and also the initial - boundary value problem with zero dirichlet conditions on @xmath118 $ ] .",
    "figure [ fig : solns ] plots several solutions to the latter problem at @xmath119 , each corresponding to a different brownian path @xmath120 .     for different driving brownian motions @xmath121 .",
    "]    it can be seen that for those realisations for which @xmath120 has been largely positive , the boundary at @xmath122 has had negligible influence and so the solution is approximately equal to the displaced normal distribution given by ( [ eq : gaussian ] ) .",
    "for the unbounded case , we approximate the mean - square @xmath105-error by @xmath123 \\\\ & \\approx & \\frac{1}{m } \\sum_{m=1}^m \\sum_{j=0}^j ( v_j^n(\\omega_m)-v(n k , j h;\\omega_m))^2 \\ , h , \\label{errex}\\end{aligned}\\ ] ] where @xmath124 is the number of grid intervals , @xmath125 the number of timesteps , and the expectation is taken over brownian paths @xmath126 , of which @xmath127 are @xmath7 samples .    to study the convergence , we introduce decreasing grid sizes @xmath128 and timesteps @xmath129 , motivated by the second order convergence in @xmath52 and first order convergence in @xmath72 as well as the stability limit for the explicit scheme , and denote @xmath130 the mean - square @xmath105-error at level @xmath131 .    for the initial - boundary value problem ,",
    "no analytical solution is known , but we can compute error indicators via the difference between a fine grid solution @xmath132 with mesh parameters @xmath72 and @xmath52 , and a coarse solution @xmath133 with mesh parameters @xmath134 and @xmath135 , @xmath136   \\\\ & \\approx & \\frac{1}{m } \\sum_{m=1}^m \\sum_{j=0}^{j/2 } ( f_{2j}^n(\\omega_m)-c_j^{n/4}(\\omega_m))^2 \\ , h , \\label{errest}\\end{aligned}\\ ] ] and define @xmath137 .    on the coarsest level , @xmath138 , @xmath139 , such that @xmath140 does not coincide with a grid point .",
    "[ fig : unbddandbddplots ] shows both the computed values of @xmath141 and @xmath142 for the unbounded case , and @xmath142 for the bounded case .",
    "difference between true and numerical solution , @xmath143 as in ( [ errex ] ) , and coarse and fine grid solutions , @xmath144 as in ( [ errest ] ) ; for the bounded case , difference between coarse and fine grid solutions @xmath144 . ]",
    "the results confirm the theoretical @xmath107 convergence in the unbounded case , and support the conjecture that the convergence order is unchanged in the bounded case .",
    "we now formalise this conjecture about the error due to the spde discretisation .",
    "denote @xmath145 the solution to the initial boundary value problem at time @xmath146 for a given brownian path and @xmath147 its numerical approximation with grid size @xmath52 and timestep @xmath148 .",
    "[ conj ] the error in the solution at time @xmath146 satisfies the strong error estimate in the @xmath105 norm @xmath149 @xmath150 } = o(h^{2}).\\ ] ]    a lipschitz payoff function @xmath151 has a similar strong error bound @xmath152 } = o(h^{2}).\\ ] ]    we know conjecture [ conj ] to be true for the initial value problem on @xmath153 , and it conjectures that the introduction of the boundary condition at @xmath122 does not affect the ( weak and ) strong error , which is supported by the numerical results .",
    "the conjecture assumes @xmath154 ; in practice , a finite value for @xmath155 will introduce an additional truncation error which will decay exponentially in @xmath155 .    numerical tests with different parameters , not reproduced here ,",
    "indicate that the error in the bounded case increases for values of @xmath140 close to 0 , in which case more paths contribute solutions with large higher derivatives close to the zero boundary , even if the asymptotic convergence order is still @xmath107 .",
    "we analyse this loss of regularity further in appendix [ subsec : regularity ] .",
    "we now consider estimating the expectation of a scalar functional of the spde solution , an expected `` payoff '' @xmath156 in a computational finance context .    defining @xmath157 to be the payoff arising from a single spde approximation , the standard monte carlo approach is to average the payoff from @xmath125 independent spde simulations , each one using an independent vector of @xmath158 normal variables @xmath159 .",
    "thus the estimator for the expected value is @xmath160 the mean square error for this estimator can be expressed as the sum of two contributions , one due to the variance of the estimator and the other due to the error in its expectation , @xmath161 \\right)^2 \\right ]   = n^{-1 } { \\mathbb{v}}[{\\widehat{p } } ] + \\left ( { \\mathbb{e}}[{\\widehat{p } } ] \\!-\\ ! { \\mathbb{e}}[p ] \\right)^2.\\ ] ] to achieve a r.m.s .",
    "error of @xmath40 requires that both of these terms are @xmath162 .",
    "this in turn requires that @xmath163 , @xmath164 and @xmath165 , based on the conjecture that the weak error @xmath166 \\!-\\ !",
    "{ \\mathbb{e}}[p]$ ] is @xmath107 .",
    "since the computational cost is proportional to @xmath167 this implies an overall cost which is @xmath42 .",
    "the aim of the multilevel monte carlo simulation is to reduce this complexity to @xmath38 .",
    "consider monte carlo simulations with different levels of refinement , @xmath168 , with @xmath169 being the coarsest level , ( i.e.  the largest values for @xmath72 and @xmath52 ) and level @xmath170 being the finest level corresponding to that used by the standard monte carlo method .",
    "let @xmath171 denote an approximation to payoff @xmath156 using a numerical discretisation with parameters @xmath172 and @xmath173 .",
    "because of the linearity of the expectation operator , it is clearly true that @xmath174 = { \\mathbb{e}}[{\\widehat{p}}_0 ] + \\sum_{l=1}^l { \\mathbb{e}}[{\\widehat{p}}_l \\!-\\ ! { \\widehat{p}}_{l-1 } ] .",
    "\\label{eq : identity}\\ ] ] this expresses the expectation on the finest level as being equal to the expectation on the coarsest level plus a sum of corrections which give the difference in expectation between simulations using different numbers of timesteps . the multilevel idea is to independently estimate each of the expectations on the right - hand side in a way which minimises the overall variance for a given computational cost .",
    "let @xmath175 be an estimator for @xmath176 $ ] using @xmath177 samples , and let @xmath178 for @xmath179 be an estimator for @xmath180 $ ] using @xmath181 samples .",
    "each estimator is an average of @xmath181 independent samples , which for @xmath179 is @xmath182 the key point here is that the quantity @xmath183 comes from two discrete approximations using the same brownian path .",
    "the variance of this simple estimator is @xmath184 = n_l^{-1 } v_l $ ] where @xmath185 is the variance of a single sample . combining this with independent estimators for each of the other levels ,",
    "the variance of the combined estimator @xmath186 is @xmath187 the corresponding computational cost is @xmath188 where @xmath189 represents the cost of a single sample on level @xmath131 . treating the @xmath181 as continuous variables , the variance is minimised for a fixed computational cost by choosing @xmath181 to be proportional to @xmath190 , with the constant of proportionality chosen so that the overall variance is @xmath38 .",
    "the total cost on level @xmath131 is proportional to @xmath191 .",
    "if the variance @xmath185 decays more rapidly with level than the cost @xmath189 increases , the dominant cost is on level @xmath192 .",
    "the number of samples on that level will be @xmath38 and the cost savings compared to standard monte carlo will be approximately @xmath193 , reflecting the different costs of samples on level @xmath192 compared to level @xmath170 .",
    "on the other hand , if the variance @xmath185 decays more slowly than the cost @xmath189 increases , the dominant cost will be on the finest level @xmath170 , and the cost savings compared to standard monte carlo will be approximately @xmath194 , reflecting the difference between the variance of the finest grid correction compared to the variance of the standard monte carlo estimator , which is similar to @xmath195 .    this outline analysis is made more precise in the following theorem :    [ ml - theorem ] let @xmath156 denote a functional of the solution of an spde for a given brownian path @xmath120 , and let @xmath171 denote the corresponding level @xmath131 numerical approximation .    if there exist independent estimators @xmath178 based on @xmath181 monte carlo samples , and positive constants @xmath196 such that @xmath197 and    1",
    ".   @xmath198 \\right| \\leq c_1\\ , 2^{-\\alpha\\ , l } $ ] 2 .",
    "@xmath199 = \\left\\ { \\begin{array}{ll } { \\mathbb{e}}[{\\widehat{p}}_0 ] , & l=0 \\\\[0.1 in ] { \\mathbb{e}}[{\\widehat{p}}_l \\!-\\ ! { \\widehat{p}}_{l-1 } ] , & l>0 \\end{array}\\right .",
    "[ ml - iii ] @xmath184 \\leq c_2\\ , n_l^{-1 } 2^{-\\beta\\ , l } $ ] 4 .",
    "[ ml - iv ] @xmath200 where @xmath189 is the computational complexity of @xmath178    then there exists a positive constant @xmath201 such that for any @xmath202 there are values @xmath170 and @xmath181 for which the multilevel estimator @xmath203 has a mean - square - error with bound @xmath204\\right)^2\\right ] < { \\varepsilon}^2\\ ] ] with a computational complexity @xmath205 with bound @xmath206 c_4\\ , { \\varepsilon}^{-2 } ( \\log { \\varepsilon})^2 ,     & \\beta=\\gamma , \\\\[0.1 in ] c_4\\ , { \\varepsilon}^{-2-(\\gamma\\!-\\!\\beta)/\\alpha } , & 0<\\beta<\\gamma .",
    "\\end{array}\\right.\\ ] ]    the proof is a slight generalisation of the proof in @xcite .    in our application , we choose @xmath207 and @xmath208 so that the ratio @xmath209 is held fixed to satisfy the finite difference stability condition .",
    "the computational cost increases by factor 8 in moving from level @xmath131 to @xmath210 , so @xmath211 .",
    "given that the payoff is a lipschitz function of the loss approximations at various dates , conjecture [ conj ] implies that the weak error is also @xmath71 and so @xmath212 .",
    "also , due to the triangle inequality @xmath213 }   & \\leq &   \\sqrt{{\\mathbb{v } } [ { \\widehat{p}}_l \\!-\\ ! p ] } + \\sqrt{{\\mathbb{v } } [ { \\widehat{p}}_{l-1 } \\!-\\ ! p ] }   \\\\ & \\leq &   \\sqrt{{\\mathbb{e } } [ ( { \\widehat{p}}_l \\!-\\ !",
    "p)^2 ] } + \\sqrt{{\\mathbb{e } } [ ( { \\widehat{p}}_{l-1 } \\!-\\ !",
    "p)^2 ] } , \\end{aligned}\\ ] ] conjecture [ conj ] and its corollary give @xmath214 .",
    "consequently , the computational cost to achieve a r.m.s .",
    "error of @xmath40 is @xmath38 .",
    "in this section we study the numerical performance of the algorithms presented earlier on the example of cdo tranche pricing in a large basket limit .",
    "basket credit derivatives provide protection against the default of a certain segment ( ` tranche ' ) of a basket of firms .",
    "a typical example is that of a _",
    "collateralized debt obligation _ where the protection buyer receives a notional amount , minus some recovery proportion @xmath215 , if firms in a specified tranche of the basket default , and in return pays a regular spread until the default event occurs .",
    "the arbitrage - free spread depends crucially on the ( risk - neutral , when hedged with defaultable bonds ) probability of joint defaults . for a tranche with attachment point @xmath216 and detachment point @xmath217 , the outstanding tranche",
    "notional @xmath218 where the loss variable @xmath219 is the proportion of losses in the basket up to time @xmath3 , determines the spread and default payments related to that tranche .",
    "the risk - neutral value of the tranche spread can be derived as @xmath220 } { \\delta \\sum_{i=1}^{n } { \\ , { \\rm e}}^{-r t_i } \\mathbb{e}^{\\mathbb{q}}[p(l_{t_{i}})]},\\ ] ] see , e.g. , @xcite . here",
    ", @xmath221 is the maximum number of spread payments , @xmath146 the expiry , @xmath222 the payment dates for @xmath223 , @xmath224 the interval between payments .",
    "spreads are quoted as an annual payment , as a ratio of the notional , but assumed to be paid quarterly .    for an extensive survey of credit derivatives and pricing models",
    "we refer the reader to @xcite , and note only that they typically fall in one of two classes : so - called reduced - form models , which model default times of firms directly as ( dependent ) random variables ; structural models , which capture the evolution of the firms values , and model default events as the first passage of a lower default barrier .",
    "we will consider the latter here .    in a structural model in the spirit of the classical works of @xcite and @xcite ,",
    "as extended to multiple firms e.g.  in the work of @xcite , a company @xmath225 s firm value , @xmath226 , is assumed to follow a model of the type @xmath227 where @xmath228 is a correlation parameter , @xmath5 is the risk - free interest rate , @xmath229 the volatility , and @xmath7 , @xmath20 are standard brownian motions .    here",
    ", the individual firms are correlated through a common ` market ' factor @xmath7 , but independent conditionally on @xmath7 .",
    "we make in the following the assumption that the firms are _ exchangeable _ in the sense that their dynamics is governed by the same set of parameters , specifically @xmath230 , @xmath231 .",
    "their initial values @xmath232 are not necessarily identical which allows for different default probabilities for individual firms , consistent with their cds spreads .    in this framework ,",
    "the default time @xmath233 of the @xmath225-th firm is modelled as the first hitting time of a default barrier @xmath234 , for simplicity constant , and the _ distance - to - default _ @xmath235 evolves according to ( [ sdesys ] ) , where @xmath236 , @xmath237 .",
    "@xmath238 as in ( [ defaulttime ] ) is precisely the default time .    in the majority of applications ,",
    "monte carlo simulation of the firm value processes is used for the estimation of tranche spreads , see e.g.  @xcite or @xcite .",
    "this is largely enforced by the size of @xmath125 , for instance in the case of index tranches @xmath239 .",
    "this , however , puts the model precisely in the realm of the large basket approximation ( [ spde ] ) .",
    "see @xcite for a numerical study of this large basket approximation .",
    "the loss functional is thereby approximated by @xmath240 in terms of the numerical spde solution @xmath241 at time @xmath222 , which feeds into the estimator for the outstanding tranche notional ( [ tranche - notional ] ) and subsequently the tranche spreads ( [ tranche - spreads ] ) .",
    "all following results are for a representative set of parameter values , taken from a calibration performed in @xcite to 2007 market data , @xmath109 , @xmath110 , @xmath111 , @xmath112 .",
    "while the initial distribution used in @xcite is somewhat spread out to match individual cds spreads of obligors , most of the mass is around @xmath114 and for simplicity we centre all firms there for the numerical tests , @xmath113 .",
    "the upper boundary is chosen as @xmath115 .",
    "we consider a maturity @xmath119 and tranches @xmath242 = [ 0,0.03]$ ] , @xmath243 $ ] , @xmath244 $ ] , @xmath245 $ ] , @xmath246 $ ] , @xmath247 $ ] .",
    "figure [ fig : spde_results ] shows the multilevel results for the expected protection payment from the first tranche , @xmath248,\\ ] ] expressed as a fraction of the initial tranche notional .    we pick mesh sizes @xmath249 and @xmath250 for @xmath251 and @xmath252 , @xmath139 .",
    "this is motivated by the second and first order consistency in @xmath52 and @xmath72 respectively , and within the stability limit ( [ expl - stab - lim ] ) .",
    "the top - left plot shows the convergence of the variance @xmath253 $ ] as well as the variance of the standard single level estimate , while the top - right plot shows the convergence of the expectation @xmath180 $ ] .",
    "the bottom - left plot shows results for different multilevel calculations , each with a different user - specified accuracy requirement . for each value of the accuracy @xmath40 ,",
    "the multilevel algorithm determines ( by formula ( 12 ) from @xcite ) the numbers of levels of refinement which are needed to ensure that the contribution to the mean square error ( mse ) due to the weak error on the finest grid is less than @xmath254 , and it determines ( by formula ( 10 ) from @xcite ) the optimal number of samples on each level so that the combined variance of the multilevel estimate is also less than @xmath254 , and hence the mse is less than @xmath255 .    treating a single finite difference calculation on the coarsest level as having a unit cost ,",
    "the bottom - right plot compares the total cost of the standard and multilevel algorithms . since the objective is to achieve a computational cost which is approximately proportional to @xmath256 , it is the cost @xmath205 multiplied by @xmath255 which is plotted versus @xmath40 .",
    "the results confirm that @xmath257 does not vary much as @xmath258 for the multilevel method , in line with the prediction that @xmath259 , whereas it grows significantly for the standard method since @xmath260 , where @xmath170 is the index of the finest level .",
    "hence , there is a big jump in the cost of the standard method each time it is necessary to switch to a finer level to ensure the weak error is less than @xmath261 , whereas the jump is minimal for the multilevel method .    in practice",
    ", default is not monitored continuously but only at a discrete set of times , and for pricing often the simplifying assumption is made that default is only determined at the spread payment dates @xmath262 .",
    "this can be incorporated as follows . in the time intervals @xmath263",
    ", we solve ( [ spde ] ) on a sufficiently large domain ( e.g.  @xmath264 $ ] ) , and apply the following interface conditions at @xmath262 : @xmath265    to maintain quadratic grid convergence in spite of the discontinuity introduced by ( [ discont ] ) , we choose the mesh such that a grid point coincides with the 0 boundary ( e.g.  by setting @xmath266 in the above example ) , and set the numerical solution after default monitoring to 0 for grid coordinates below 0 and to @xmath267 its previous value at 0 , see e.g.  @xcite .",
    "it is seen in fig .",
    "[ fig : spde_results_discr ] that convergence is very similar to the previous case .",
    "here we discuss the computational complexity of the multilevel solution of the spde compared with the alternative use of the multilevel method for solving the sdes which arise from directly simulating a large number of sdes .",
    "we have already explained that to achieve a r.m.s .",
    "accuracy of @xmath40 requires @xmath42 work when solving the spde by the standard monte carlo method , but the cost is @xmath38 using the multilevel method , provided conjecture [ conj ] is correct .",
    "consider now the alternative of using a finite number of particles ( firms ) , @xmath7 , to estimate the tranche loss in the limit of an infinite number of particles ( firms ) . in this case",
    ", empirical results suggest that there is an additional @xmath268 error ( see also @xcite ) , and the proof of this convergence order is the subject of current research . taking this to be the case , the optimal choice of @xmath7 to minimise the computational complexity to achieve an r.m.s .",
    "error of @xmath40 is @xmath269 . using the standard monte carlo method ,",
    "the optimal timestep is @xmath270 , and the optimal number of paths is @xmath38 , so the overall cost is @xmath271 .",
    "using the multilevel method for the sdes reduces the cost per company to @xmath38 , so the total cost is @xmath41 .",
    "this complexity information is summarised in table [ table : comparison ] .",
    "there is also a practical implementation aspect to note .",
    "the computational cost per grid point in the finite difference approximation of the spde is minimal , requiring just three floating point multiply - add operations if equation ( [ discrete ] ) is re - cast as @xmath272 with the coefficients @xmath273 computed once per timestep , for all @xmath274 .    if we let @xmath205 be the cost of generating all of the gaussian random numbers @xmath275 for a single spde simulation , then the cost of the rest of the finite difference calculation with 20 points in @xmath2 ( as used on the coarsest level of our multilevel calculations ) is probably similar , giving a total cost of @xmath276 for each spde . on the other hand",
    ", each sde needs its own gaussian random numbers for the idiosyncratic risk , and so the cost of simulating _ each _ sde is approximately @xmath205 , roughly half of the cost of the spdes on the coarsest level of approximation , giving a total cost of @xmath277 .        ' '' ''    method / model & sde & spde +    ' '' ''    standard mc & @xmath271 & @xmath42 +    ' '' ''    multilevel mc & @xmath41 & @xmath38 +      we have shown that stochastic finite differences combined with a multilevel simulation approach achieve optimal complexity for the computation of expected payoffs of an spde model . in the case of an absorbing boundary , the complexity estimate is a conjecture in so far it relies on the convergence order of the finite difference scheme , which does not follow from the fourier analysis of the unbounded case .",
    "the matrix stability analysis in appendix [ sec : matanal ] could form part of a rigorous analysis if a lax equivalence theorem could be proved . in the case of multiplicative white noise",
    "this is shown in @xcite .",
    "one difficulty in the present case of an spde with stochastic drift is the loss of regularity towards the boundary , which may be accounted for by weighted sobolev norms of the solution , but even then it is not clear that convergence of the functionals of interest follows .",
    "there are several possible extensions of the present basic model as discussed in @xcite , ranging from stochastic volatility and jump - diffusion to contagion models .",
    "the methods developed in this paper should be of use there also , building for example on multilevel versions of jump - adapted discretisations for jump - diffusion sdes @xcite .",
    "bain , a. & crisan , d. _ fundamentals of stochastic filtering _ , springer , 2009 .",
    "barth , a. , schwab , c. , & zollinger , n. multi - level monte carlo finite element method for elliptic pdes with stochastic coefficients , _ num .",
    "_ , 119(1):123 - 161 , 2010 .",
    "benth , f.e . & koekebakker , s. stochastic modeling of financial electricity contracts , _ energy economics _ , 30(3):11161157 , 2008 .",
    "black , f. and cox , j. valuing corporate securities : some effects of bond indenture provision , _ j. finance _",
    ", 31:351367 , 1976 .",
    "bruti - liberati , n. & platen , e. _ numerical solution of stochastic differential equations with jumps in finance _ ,",
    "springer , 2010 .",
    "buckwar , e. & sickenberger , t. a comparative linear mean - square stability analysis of maruyama- and milstein - type methods , _ math . comp .",
    "_ , 81:11101127 , 2011 .",
    "bujok , k. & reisinger , c. numerical valuation of basket credit derivatives in structural jump - diffusion models , _ j. comp .",
    "_ , to appear",
    ".    bush , n. , hambly , b. , haworth , h. , jin , l. , & reisinger , c. stochastic evolution equations in portfolio credit modelling , _ siam fin .",
    "_ , 2(1):627664 , 2011 .",
    "carmona , r. , fouque , j .- p . ,",
    "& vestal , d , interacting particle systems for the computation of rare credit portfolio losses , _ fin .",
    "_ , 13(4):613633 , 2009 .",
    "carter , r. & giles , m.b .",
    "sharp error estimates for discretisations of the 1d convection / diffusion equation with dirac initial data , _",
    "i m a j.  num .",
    "_ , 27(2):406425 , 2007 .",
    "cliffe , k.a .",
    ", giles , m.b . , scheichl , r. , & teckentrup , a.l .",
    "multilevel monte carlo methods and applications to elliptic pdes with random coefficients , _ computing and visualization in science _",
    ", 14(1):315 , 2011 .",
    "fouque , j. , wignall b. , & zhou , x. modeling correlated defaults : first passage model under stochastic volatility .",
    "_ j. comp .",
    "_ , 11(3 ) : 4378 , 2008 .",
    "giles , m.b .",
    "multi - level monte carlo path simulation , _ operations research _",
    ", 56(3):981986 , 2008 .",
    "giles , m.b . improved multilevel monte carlo convergence using the milstein scheme , pp .",
    "343358 in _ monte carlo and quasi - monte carlo methods 2006 _ , editors keller , a. , heinrich , s. , & niederreiter , h. , springer - verlag , 2008 .",
    "glasserman , p. _ monte carlo methods in financial engineering _ , springer , 2004 .",
    "graubner , s. multi - level monte carlo methoden fr stochastische partielle differentialgleichungen .",
    "diplomarbeit , tu darmstadt , 2008 .",
    "gyngy , i. lattice approximations for stochastic quasi - linear parabolic partial differential equations driven by space - time white noise ii , _ potential anal .",
    "_ , 11:137 , 1999 .",
    "gyngy , i. & nualart , d. implicit schemes for stochastic quasi - linear parabolic partial differential equations driven by space - time white noise , _ potential anal .",
    "_ , 7:725757 , 1997 .",
    "heath , d. , jarrow , r. , & morton , a. bond pricing and the term structure of interest rates : a new methodology for contingent claims valuation , _ econometrica _ , 60(1):77105 , 1992 .",
    "higham , d.j .",
    "mean - square and asymptotic stability of the stochastic theta method , _ siam j.  num .",
    "_ , 38(3):753769 , 2000 .",
    "hull , j. , predescu , m. , & white , a. the valuation of correlation - dependent credit derivatives using a structural model , _",
    "j. credit risk _",
    ", 6(3):99132 , 2005 .    kloeden , p.e . &",
    "platen , e. _ numerical solution of stochastic differential equations _ , springer , 1992 .",
    "krylov , n.v .",
    "a @xmath278-theory of the dirichlet problem for spdes in general smooth domains , _ probab .",
    "theory relat . fields _ , 98:389421 , 1994 .",
    "kurtz , t.g .",
    "& xiong , j. particle representations for a class of nonlinear spdes , _ stoch .",
    "_ , 83:103126 , 1999 .",
    "lang , a. a lax equivalence theorem for stochastic differential equations , _ j. comp .",
    "_ , 234(12):33873396 , 2010 .",
    "merton , r. , on the pricing of corporate debt : the risk structure of interest rates , _ j.  fin .",
    "_ , 29:449470 , 1974 .",
    "pooley , d.m . ,",
    "vetzal , k.r . , & forsyth , p.a .",
    "remedies for non - smooth payoffs in option pricing , _ j.  comp .  fin .",
    "_ , 6:2540 , 2003 .",
    "richtmyer , r.d .",
    "& morton , k.w .",
    "_ difference methods for initial - value problems _ , wiley - interscience , 1967 .",
    "roth , c. difference methods for stochastic partial differential equations , _ z. angew",
    "_ , 82(1112):821830 , 2002 .",
    "roth , c. a combination of finite difference and wong - zakai methods for hyperbolic stochastic partial differential equations , _ stoch .",
    "_ , 24(1):221240 , 2006 .",
    "saito , y. & mitsui , t. stability analysis of numerical schemes for stochastic differential equations , _",
    "siam j.  num .",
    "_ , 33(6):22542267 , 1996 .",
    "schnbucher , p.j .",
    "_ credit derivatives pricing models _ , wiley , 2003 .",
    "walsh , j.b .",
    "finite element methods for parabolic stochastic pdes , _ potential anal .",
    "_ , 23:143 , 2005 .",
    "xia , y. & giles , m.b .",
    "multilevel path simulation for jump - diffusion sdes , in _",
    "monte carlo and quasi - monte carlo methods 2010 _ , editors wozniakowski , h. & plaskota , l. , springer - verlag , 2012 .",
    "zhou , c. , an analysis of default correlations and multiple defaults , _ the review of financial studies _",
    ", 14:555576 , 2001 .",
    "if @xmath60 is the vector with elements @xmath61 then the finite difference equation can be expressed as @xmath279 a & = & i - \\frac{\\mu\\ , k}{2h}\\ , d_1 + \\frac{(1\\!-\\!\\rho)\\ , k}{2h^2}\\ , d_2 , \\\\[0.05 in ] b & = & -\\ , \\frac{\\sqrt{\\rho\\ , k}}{2h}\\ , d_1 , \\\\[0.05 in ] c & = &      \\frac{\\rho\\ , k}{2h^2}\\ , d_2,\\end{aligned}\\ ] ] where @xmath280 is the identity matrix and @xmath62 and @xmath63 are the matrices corresponding to central first and second differences , which for @xmath281 are @xmath282    from the recurrence relation we get @xmath283   & = & { \\mathbb{e}}\\left [ v_n^t ( a^t + b^t\\ , z_n + c^t\\ , z_n^2)(a + b\\ , z_n + c\\ , z_n^2)\\   v_n \\right ] \\\\[0.1 in ] & = & { \\mathbb{e}}\\left [ v_n^t \\left ( ( a\\!+\\!c)^t ( a\\!+\\!c ) + b^t b + 2\\ ,",
    "c^t c \\,\\right ) v_n \\right].\\end{aligned}\\ ] ]    noting that @xmath62 is anti - symmetric and @xmath63 is symmetric , and that @xmath284 where @xmath285 corresponds to a central second difference with twice the usual span , @xmath286 ( with the end values of @xmath287 being chosen to correspond to @xmath288 and @xmath289 ) , and @xmath290 and @xmath291 are each entirely zero apart from one corner element , @xmath292 then after some lengthy algebra we get @xmath293 } \\\\ & = & { \\mathbb{e}}\\left [ v_n^t m v_n \\right ]   - \\left ( e_1 + e_2 \\right ) { \\mathbb{e}}[(v_1^n)^2 ]   - \\left ( e_1 - e_2 \\right ) { \\mathbb{e}}[(v_{j-1}^n)^2],\\end{aligned}\\ ] ] where @xmath294 and @xmath295    it can be verified that the @xmath296 eigenvector of @xmath7 has elements @xmath297 for @xmath298 , and the associated eigenvalue is @xmath299 where @xmath300 are the same functions as defined in the mean - square fourier analysis . in addition , in the limit @xmath301 , @xmath302 , and therefore in this limit the fourier stability condition @xmath303 is also a sufficient condition for mean - square matrix stability .",
    "figure [ fig : conv ] shows the convergence behaviour as the computational grid is refined .",
    "level 0 has @xmath304 ; @xmath52 is reduced by factor 2 and @xmath72 by factor @xmath305 in moving to finer levels .",
    "the top - left plot shows the convergence of @xmath306 $ ] , with notation as in sections [ sec : multilevel ] and [ subsec : pricing ] ; the top - right plot shows the convergence of @xmath307 $ ] .",
    "the bottom two plots show the behaviour of @xmath308 , which is estimated on each grid level using the standard second difference @xmath309 the left plot indicates that the mean of this quantity is well behaved , but the right plot indicates a singular behaviour of its variance , with the value increasing rapidly with increased grid resolution ."
  ],
  "abstract_text": [
    "<S> in this article , we propose a milstein finite difference scheme for a stochastic partial differential equation ( spde ) describing a large particle system . </S>",
    "<S> we show , by means of fourier analysis , that the discretisation on an unbounded domain is convergent of first order in the timestep and second order in the spatial grid size , and that the discretisation is stable with respect to boundary data . </S>",
    "<S> numerical experiments clearly indicate that the same convergence order also holds for boundary - value problems . </S>",
    "<S> multilevel path simulation , previously used for sdes , is shown to give substantial complexity gains compared to a standard discretisation of the spde or direct simulation of the particle system . </S>",
    "<S> we derive complexity bounds and illustrate the results by an application to basket credit derivatives . </S>"
  ]
}