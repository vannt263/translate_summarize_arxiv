{
  "article_text": [
    "more than 20 years of successful applications have established hedin s @xmath1 approach @xcite and its numerical implementations @xcite as the state - of - the - art and most widely used theoretical method for _ ab - initio _ bandstructure calculations including self - energy effects .",
    "efficient algorithms have been devised to encompass the major numerical bottlenecks in such calculations , e.g. by avoiding * k*-space convolutions by a space - time method @xcite , or avoiding summations over empty states in the evaluation of the polarizability @xcite , or using localized basis functions @xcite , and/or model screening functions @xcite .",
    "several computer codes have been devised for ab - initio @xmath1 calculations , and are presently available , often under public domain @xcite .",
    "however , systems with metallic screening present an additional , numerically challenging , difficulty : in the evaluation of the * k*-space integrals for the intraband contribution to the electron screening , the contribution of the fermi surface can dramatically slow down the convergence with respect to the * k*-space sampling . as a consequence , the possibility to perform such _ ab - initio _ @xmath1 calculations in gapless systems with a large unit cell",
    "is hindered .",
    "even worse , when calculations are performed with standard computer codes , unconverged * k*-point sampling gives rise to a spurious gap at the fermi level .",
    "the gap vanishes only in the limit of infinitely dense sampling , and is shown to close very slowly as the number of * k*-points increases .",
    "solutions based on explicit fermi surface integration @xcite are effective but result in cumbersome coding and substantial increase of computation time .",
    "in this paper we present a numerically stable and efficient method , based on a taylor expansion of the polarizability matrix in the small-*q * region , which includes intraband contributions and avoids explicit fermi - surface calculations .",
    "the method has been implemented successfully into the ` abinit ` @xcite package , and is shown to remove the spurious gap at the fermi level already with a limited number of * k*-points .",
    "results are presented for the homogeneous electron gas ( heg ) as well as for real metals such as na and al .",
    "this paper is organized as follows : in sec .",
    "[ sec : theory ] we briefly review the standard @xmath1 scheme and describe the difficulties that arise when it is applied to metals naively . in sec .  [ sec : met ] we analyze the origin of the problem , and propose our solution in sec .",
    "[ sec : fit ] . in sec .",
    "[ sec : res ] we test the method on different metallic systems , and we discuss the results in sec .",
    "[ sec : conc ] .",
    "the present work deals with the many - body problem in the standard hedin s scheme based on the following set of self - consistent equations @xcite : @xmath2 @xmath3 and @xmath4 are the exact and hartree s green functions for the electron , @xmath5 is the bare coulomb interaction , @xmath6 is the screened potential , @xmath7 is the electric polarizability , @xmath8 is the self energy , and @xmath9 is the vertex function .",
    "an argument such as `` @xmath10 '' stands for the set of position , time and spin variables @xmath11 .",
    "equations ( [ eq:1hedin]-[eq:5hedin ] ) constitute a formally closed set of equations for the five correlators .",
    "the functional derivative in eq .",
    "( [ eq:2hedin ] ) provides the vertex corrections and is a formidable computational difficulty .",
    "the most important approximation that is usually made is to neglect the vertex entirely and put @xmath12 in the remaining four equations .",
    "this explains the name @xmath1 , since eq .",
    "( [ eq:5hedin ] ) now simplifies to the product @xmath13    a @xmath1 calculation proceeds as follows .",
    "one assumes initially @xmath14 , @xmath15 in eq .",
    "( [ eq:1hedin ] ) .",
    "next , one determines @xmath16 through eq .",
    "( [ eq:3hedin ] ) with @xmath17 , and computes @xmath6 from eq .",
    "( [ eq:4hedin ] ) . the first estimate of @xmath8 is obtained in eq .",
    "( [ sigmagw ] ) , and can be used to update @xmath3 and the other correlators .",
    "this procedure can be iterated until self - consistency is reached . however , several non - selfconsistent @xmath1 approaches are possible @xcite . in the present work ,",
    "we choose to perform calculations within the so - called @xmath18 approximation @xcite , which stops the iteration without updating @xmath3 and @xmath6 .",
    "one first evaluates the independent - particle polarizability @xmath19 and the dielectric function @xmath20 which provides the solution of eq .  , @xmath21 , and the self energy @xmath22 .",
    "this approximation is usually a successful one , while self - consistent @xmath1 has been shown to lead to a worse treatment of electron correlations in prototypical systems such as the heg ( where it gives a bandwidth larger than the dft one @xcite ) and solid silicon ( where the band gap turns out even larger than experiment @xcite ) .",
    "the simpler @xmath18 approach leads typically to a 10% bandwidth reduction with respect to dft , in better agreement with experiment , thus suggesting a partial cancellation of errors due to lack of self - consistency and of vertex corrections in @xcite .    in the @xmath18 approximation",
    ", one can start from a dft - lda electronic - structure calculation .",
    "the quasiparticle energies @xmath23 are hence evaluated as first order corrections to the kohn - sham ( ks ) eigenvalues @xmath24 , with respect to the perturbation @xmath25 , and by linearizing the energy dependence of @xmath8 @xcite : @xmath26 expectation values are taken on the corresponding ks state @xmath27 ; the denominator is the quasiparticle weight .",
    "one of the heaviest parts of the @xmath18 computation is the inversion of the symmetrized dielectric matrix , which in reciprocal space reads : @xmath28 the inversion must be performed on a mesh of frequencies spanning a range significantly wider than the range of interest for the bandstructure .",
    "the inverse dielectric matrix leads immediately to the effective screened potential : @xmath29 a great simplification can be achieved by introducing an additional plasmon - pole approximation , where the frequency dependence of each @xmath30,@xmath31 matrix element is parameterized by : @xmath32 the parameters @xmath33 and @xmath34 are determined by evaluating the polarizability @xmath35 only at two values of the frequency , usually at @xmath36 and at a purely imaginary frequency of the magnitude of the plasma frequency @xmath37 . in the following we adopt this plasmon - pole model , since the difficulties related to the small wave - vector screening would occur identically if the detailed @xmath38 dependence of @xmath39 were considered .    the polarizability @xmath40 is given by the standard expression @xcite @xmath41 } \\nonumber \\\\ & & \\langle{\\bf k},j|e^{-i({\\bf q}+{\\bf g})\\cdot{\\bf \\hat r } }    \\langle{\\bf k}+{\\bf q},j'|e^{i({\\bf q}+{\\bf g}')\\cdot{\\bf \\hat r } }    \\,,\\end{aligned}\\ ] ] where @xmath42 are fermi occupation numbers at a small smearing temperature , @xmath43 are the ks states , and the factor @xmath44 accounts for spin .",
    "complex conjugation gives @xmath45 , hence also @xmath46 is a hermitian matrix for purely imaginary frequencies .",
    "for @xmath47 , @xmath48 and @xmath49 or @xmath50 equal to @xmath51 , this expression vanishes exactly because of orthogonality ( @xmath52 terms ) or equality of fermi numbers ( @xmath53 ) .",
    "the rate at which @xmath40 vanishes as @xmath54 is relevant for contrasting the coulomb singularity that appears in the dielectric matrix . to take care of interband terms ( @xmath52 ) , a standard solution is to expand the matrix elements of eq .",
    "( [ eq : chi ] ) by means of the formula @xcite : @xmath55    \\,,\\end{aligned}\\ ] ] where @xmath56 is the non local part of the pseudopotential . by substituting this expansion into eq .",
    "( [ eq : chi ] ) one gets a small @xmath0 expansion of the polarizability , which can be used to evaluate the @xmath57 limit of @xmath58 appearing in eq .   when @xmath59 .",
    "intraband terms @xmath60 are put to zero .",
    "while this method is satisfactory for semiconductors , it gives rise to substantial difficulties for metals , where _ intraband _ terms are also important .",
    "this leads to an incorrect evaluation of the @xmath40 contributions in the @xmath0-space region closest to the origin , i.e. at one out of @xmath61 points of the mesh of @xmath0 points . at first sight ,",
    "as @xmath40 enters the calculation of @xmath8 through a @xmath61-discretized @xmath0-convolution in reciprocal space , one might think that this single incorrect value should affect the energy corrections @xmath62 , with an error of order @xmath63 .",
    "however , the singular behavior of the coulomb repulsion @xmath5 near @xmath64 requires an explicit integration around the singular point , which makes the final outcome sensitive to the incorrect @xmath65 with an error of order @xmath66 .",
    "( color online ) @xmath18 band structure of na ( 110 direction ) , showing the appearance of an unphysical gap , and its dependence on different numerical convergence parameters .",
    "panel ( a ) shows the dependence with respect to the number of empty states in eq .",
    "( [ eq : chi ] ) ; ( b ) with respect to the smearing temperature ; ( c ) with respect to the @xmath67-point mesh .",
    "panel ( d ) shows the dependence of the unphysical gap on the inverse number of @xmath67-points in each direction ; the dashed line is a fitted @xmath68 .",
    ", width=302 ]    the incorrect small-@xmath0 values of @xmath40 induce the opening of an unphysical gap at the fermi energy in the @xmath18 band dispersion of simple metals ( such as the heg and sodium ) , as shown in fig .  [",
    "fig : conv_na ] .",
    "the figure also shows the convergence properties of the width of this unphysical gap , computed by extrapolation from the two sides .",
    "the only significant dependency is on the number @xmath61 of sample points in the @xmath67-space mesh : fig .",
    "[ fig : conv_na ] shows that the unphysical gap does tend to close for increasing mesh size , but only extremely slowly , as @xmath69 , for the reasons discussed at the end of sec .",
    "[ sec : theory ] .",
    "therefore , it is practically impossible to close the gap by brute - force mesh refinement , especially because the computation time of the dielectric matrix grows as @xmath70 .",
    "the spurious gap is essentially independent of most numerical convergence parameters , such as the number of empty states and the smearing temperature , as shown in fig .",
    "[ fig : conv_na](a , b ) . a larger smearing temperature for electronic occupancy would reduce this unphysical gap , but it is a mere technical device , and convergence should be checked in the limit of vanishingly small smearing , where the actual metallic state is recovered .",
    "( color online ) bandstructure for the heg ( @xmath71 ) computed with the standard implementation of the @xmath18 method ( dashed line ) .",
    "the spurious gap , caused by the lack of the intraband term in the screening , is removed when the computed polarizability is replaced by the lindhard one ( dot - dashed line ) .",
    "the ks band is also displayed for reference ( dotted line ) . , width=302 ]     ( color online ) numerically computed heg screening function @xmath72 ( @xmath71 ) , for @xmath73 and @xmath74 , compared to the lindhard function . for @xmath75 the discontinuously incorrect points pointed at by arrows appear , due to the lack of the intraband term .",
    "the differences at large @xmath0 are due to the finite number of empty states included in the sums of eq .",
    "( [ eq : chi ] ) . ,",
    "width=302 ]    the origin of the unphysical gap is the incorrect @xmath48 value of the screening function as demonstrated in fig .",
    "[ fig : bande1 ] , where the gap is shown to disappear when the numerical dielectric matrix is replaced by the lindhard function @xcite . in metals ,",
    "the dielectric function @xmath76 is expected to diverge when both @xmath77 and @xmath57 ( by contrast , it goes to its finite static limit in semiconductors and insulators ) .",
    "for example for the heg , interband transitions do not contribute to the sum in eq .",
    "( [ eq : chi ] ) . at the same time , expression ( [ eq : exp ] ) can not yield correct intraband ( @xmath53 ) contributions for @xmath48 , and in practice standard codes do not evaluate such terms due to the equality of the occupancy factors . the resulting incorrect null value of @xmath78 yields @xmath79 , rather than the correct @xmath80 , as shown in fig .",
    "[ fig : jel_eps ] where numerical results are compared with the lindhard function .",
    "a similar discontinuity in @xmath18 corrections occurs for real metals such as na and al . differently from the heg",
    ", we find @xmath81 , due to the nonzero interband contributions @xcite . in particular we obtain @xmath82 , similar to the incorrect heg value , and @xmath83 .",
    "the latter nears the proper drude value , due to a substantial part of the aluminum fermi surface being very close to a brillouin - zone boundary , thus putting many of the metallic contributions of eq .",
    "( [ eq : chi ] ) effectively into inter- rather than intra - band terms . for this reason , in the case of al ,",
    "the error induced by neglecting the intraband term is so small that the unphysical gap is almost invisible .",
    "the solution we propose in this paper is devised to avoid the explicit ( numerically expensive ) integration over the fermi surface that would be required for a straightforward inclusion of the intraband term .",
    "we propose to compute the small @xmath0 polarizability by a fit of the expected asymptotics .",
    "the time - reversal invariance implies the following symmetry of the matrix polarization : @xmath85 therefore , the small-@xmath0 expansion of @xmath86 includes only even powers .",
    "the expansion of the intraband term @xmath60 in eq.([eq : chi ] ) is @xmath87 the diagonal matrix element in eq .",
    "is purely imaginary , therefore the last factor is 1 plus a @xmath0-quadratic contribution . for @xmath88",
    "the intraband term is then a constant proportional to the density of states at the fermi energy , plus quadratic corrections . for @xmath47",
    "the term linear in @xmath0 cancels because @xmath89 is odd and the integral vanishes : the expansion begins with quadratic terms .",
    "the expansion of the interband @xmath52 term is easily seen to be no less than quadratic . to sum up , we use the following expression : @xmath90 where @xmath91",
    ", @xmath92 are real adjustable parameters , and @xmath93 for @xmath37 .",
    "the matrices @xmath94 are symmetric , and may have further symmetries depending on the crystal geometry .    the off - diagonal elements @xmath95 @xmath96 of @xmath40 ( the so - called `` wings '' of the matrix ) are affected by a similar error , since they also contain the contributions of eq .",
    "( [ eq : exp ] ) .",
    "we also fit the intraband contribution to @xmath97 where @xmath98 , @xmath99 are complex adjustable parameters , and @xmath100 for @xmath37 .",
    "we determine the parameters @xmath91 , @xmath92 , @xmath101 , and @xmath99 in eqs .   and by a standard linear regression on values @xmath102 and @xmath103 computed for nonzero @xmath104-points inside a sphere of radius @xmath105 centered in @xmath9 .",
    "we implement this procedure within the ` abinit ` @xcite package . to test the effectiveness of the method",
    ", we apply it to the heg in a simple cubic cell geometry , and to bulk sodium and aluminum in their experimental crystal structures ( bcc @xmath106 , and fcc @xmath107 , respectively ) .",
    "figure [ fig : conv ] displays the fitting of the computed polarizability @xmath40 of the heg . panels ( a ) and ( b ) compare the computed @xmath40 and its small-@xmath0 fitted parabolic expansion , for two different cut - off radii @xmath105 .",
    "panels ( c)-(f ) display the resulting extrapolated small-@xmath0 values of the polarizability as functions of the main parameters involved in the simulations and the fit . in these fits , the cut - off radius @xmath105 can not be chosen too small , or else the number of @xmath0-points becomes insufficient to perform a reliable fit , especially at @xmath36 , where the computed @xmath40 is affected by significant numerical noise .",
    "likewise , if @xmath105 is increased so much that it becomes comparable with the fermi momentum @xmath108 , the outer points introduce a systematic error due to the non - parabolic @xmath0-dependency of @xmath40 .",
    "an intermediate reasonably selected @xmath105 must then be adopted .",
    "this is slightly more important for @xmath37 , where the fit is comparably more sensitive to the value of @xmath105 , as shown in fig  [ fig : conv](d , f ) .",
    "comparison to the lindhard function show that this procedure provides a fairly accurate small-@xmath84 @xmath40 value , within few percent .",
    "small smearing temperature is beneficial to a better accuracy in the determination of the asymptotic small-@xmath84 behavior , but increase the numerical noise in the computed @xmath40 .    as fig .",
    "[ fig : fitted ] shows , the corrected screening successfully closes the unphysical gap .",
    "of course in aluminum , where the fictitious gap is almost invisible , we see no significant difference in the @xmath18 corrections computed with and without the fit .",
    "the resulting curves are not very sensitive to the fit details , such as the value of @xmath105 , or @xmath61 . for the heg we can compare the obtained bands with those computed _ via _ the lindhard screening :",
    "the tiny almost uniform shift is due to the truncation in the number of empty states included in the summations of eq.([eq : chi ] ) , which makes screening different in the large-@xmath0 region , as illustrated in fig .",
    "[ fig : jel_eps ] .",
    ".[tab : bw ] occupied bandwidth for the metals studied in this paper .",
    "the present results are compared to similar calculations and experimental data .",
    "for the heg , the dft - lda result coincides with the free - electron model fermi energy @xmath109 .",
    "all energies are in ev .",
    "[ cols=\"<,^,^,^,^,^ \" , ]     table  [ tab : bw ] reports the occupied bandwidths of the metals studied in this work compared to previous calculations and experimental values .",
    "the comparison with the dft - lda values shows the well - known bandwidth reduction .",
    "the results for the heg are close to hedin s computations @xcite , while in the case of na and al the numerical value are comparable with data in the literature @xcite and approach the experimental values .",
    "in this work we have shown that the standard @xmath18 implementation of calculation of quasiparticle - corrected bandstructures , a basic tool to account for weak correlations in semiconductors and insulators , describes metals correctly only in exceptional cases , like al , where a substantial part of the fermi surface falls very close to a brillouin zone boundary , hence interband contributions make up for the missing intraband screening .",
    "in general ( like in the heg and na ) , the incorrect intraband contribution to the small-@xmath0 screening induces the opening of an unphysical gap at the fermi energy .",
    "the proposed solution recovers the correct @xmath75 polarizability by fitting a few small-@xmath0 computed values , and solves this difficulty : the gap disappears , and the electron effective mass shows the expected few percent increase .",
    "this method requires a negligible computational cost , contrary to other solutions based on fermi - surface mapping .",
    "an entirely different solution can be devised , which avoids the limitations of the expansion ( [ eq : exp ] ) , and requires no fit altogether . since the small-@xmath0 polarizability needs to be computed at a @xmath110 much smaller than those generated by any practical @xmath111-sampling , it is possible to solve the ks equations on _ two _ @xmath67-point meshes shifted from one another by @xmath112 , and then apply directly eq .",
    "( [ eq : chi ] ) .",
    "we tried this method for na and for the heg , and find that the typical accuracies practically achievable in ks eigenvalues and wavefunctions allow us to compute @xmath40 only for moderately large @xmath113 , of the order of few percent of the @xmath114-mesh spacing .",
    "the use of such a not - so - small @xmath115 as a representative of the @xmath116 limit would induce systematic errors in the calculation of the @xmath18 corrections .",
    "the fit method is therefore practically preferable .",
    "the authors acknowledge s. caravati for providing the routines for simulating the heg within ` abinit ` .",
    "they also thank g.  p.  brivio , r.  del sole , p.  garcia - gonzales , m.  gatti , r.  w.  godby , v.  olevano , l.  reining , f.  sottile , and m.  verstraete for useful discussion .",
    "this work was funded in part by the eu s 6th framework programme through the nanoquanta network of excellence nmp4-ct-2004 - 500198 ."
  ],
  "abstract_text": [
    "<S> the calculation of self - energy corrections to the electron bands of a metal requires the evaluation of the intraband contribution to the polarizability in the small-@xmath0 limit . </S>",
    "<S> when neglected , as in standard @xmath1 codes for semiconductors and insulators , a spurious gap opens at the fermi energy . </S>",
    "<S> systematic methods to include intraband contributions to the polarizability exist , but require a computationally intensive fermi - surface integration . </S>",
    "<S> we propose a numerically cheap and stable method , based on a fit of the power expansion of the polarizability in the small-@xmath0 region . </S>",
    "<S> we test it on the homogeneous electron gas and on real metals such as sodium and aluminum . </S>"
  ]
}