{
  "article_text": [
    "it has been an underlying assumption behind most of the machine learning algorithms that training and test instances should be sampled from a similar distribution . but this assumption is often violated in a real world scenario , i.e. there is high probability that train and test instances can arise from different distributions .",
    "this problem is well known as the domain shift problem in research community .",
    "the problem of domain shift is visible in various fields including language processing , speech processing as well as in computer vision tasks .",
    "various factors can cause this problem in computer vision .",
    "for example , if somebody has trained the object classifiers on images being taken from a high quality dslr camera and the test instances are taken from images being taken from a vga camera then the performance of the classifiers is not supposed to be good at all . apart from the difference in resolution , difference in view points , clutter and background can also cause the problem of domain shift . indeed , the problem is particularly pertinent to the computer vision community due to our reliance on ` standard ' challenging datasets .",
    "each dataset has its own bias and the results of one dataset do not easily transfer to other datasets as has been shown by torralba and efros in an important work @xcite . due to these factors",
    ", domain adaptation task is becoming of higher importance in computer vision .",
    "however most of the work in this field revolves around adapting a classifier for the task of object recognition or classification and not much effort has been put to adapt an object detector .    through this paper , a contribution we make is to analyse the object detection performance between two challenging standard object detection datasets viz , pascal voc and microsoft coco using the state of the art rcnn object detection technique . while",
    ", one would assume that the use of convolutional neural networks that have been trained with all the examples from the imagenet dataset would result in the detector working well across datasets , we show that such is not the case .",
    "to adapt the object detection in the unsupervised setting is challenging .",
    "if we had observations from the other dataset , then we could use fine - tuning to adapt the convolutional neural network itself . without having access to supervision",
    ", we consider a recent domain adaptation technique based on subspace alignment to adapt the feature subspaces between source and target subspaces for localized object detection bounding boxes .",
    "we further analyse our method by considering the principal angles between the subspaces .",
    "our evaluation demonstrates that it is possible to obtain localized subspace adaptation for object detection and that this adaptation results in improved performance for off - the - shelf improved object detection .",
    "rest of the paper is organized as follows . in the next section",
    "we discuss the related work , and in section [ bacgrnd ] the main concepts of subspace learning and detection are developed . in section [ our_appr ]",
    "the proposed method has been discussed in detail .",
    "experimental evaluation is presented in section [ expts ] and it includes the performance evaluation and detailed analysis .",
    "we finally conclude in section [ concl ] .",
    "the task of visual domain adaptation for object classification has been studied in unsupervised and semi - supervised settings . in this section",
    "we briefly survey only the domain adaptation techniques that are related to the present work . a recent extended report @xcite by gopalan _",
    "_ surveys domain adaptation techniques for visual recognition .",
    "subspace based methods are commonly used for learning new feature representations that are domain - invariant .",
    "they thus enable the transfer of classifiers from a source to a specific target domain .",
    "a common approach behind these subspace based methods is to first determine separate subspaces for source and target data .",
    "the data is then projected onto a set of intermediate sampled subspaces along the geodesic path between source and target subspace with the aim of making the feature point domain invariant @xcite .",
    "this approach has been further continued in terms of geodesic flow kernel @xcite , source and target subspace alignment @xcite and manifold alignment based approach @xcite .",
    "different from subspace based techniques , in @xcite , it is shown that the image representation learned by convolutional neural networks on imagenet dataset can be transferred for other tasks with relatively smaller dataset by using fine tuning the deep network .",
    "however , these require annotations for the target dataset . in very recent",
    "work a more sophisticated technique has been proposed by zhang _",
    "et al _ @xcite where a deep transfer network is learned that learns a shared feature subspace that matches conditional distributions . however , this is not applicable for detecting objects .",
    "the above mentioned works are applicable for object classification .",
    "the problem of domain adaptation for object detection has been studied to a lesser extent .",
    "one such work applicable to object detection has been the adaptation of deformable part models for object detection @xcite .",
    "the adaptation of objects through transfer component analysis @xcite has been proposed by mirrashed _",
    "@xcite specifically for the case of vehicles . in recent work",
    "there has been a method proposed to adapt a fine tuned convolutional neural network for detection by considering it as a domain adaptation technique @xcite .",
    "this technique has shown interesting performance for large scale detection . however , they heavily rely on the presence of a large number of pre - trained fine - tuned detectors ( 200 categories ) .",
    "we do not make such assumptions for our method .",
    "finally , our work is also motivated by the idea of hierarchical and iterative domain adaptation . in @xcite , it has been proposed to adapt the hierarchy of features to exploit the visual information . in @xcite ,",
    "anant _ et al .",
    "_ propose an iterative hierarchical subspace based domain adaptation method to exploit the availability of additional structure in the label space i.e.  hierarchy .",
    "however , these techniques are not applicable for detection .",
    "the proposed approach builds upon the previously proposed subspace alignment based method @xcite for visual domain adaptation to adapt the rcnn detector @xcite .",
    "subspace alignment based domain adaptation method consists of learning a transformation matrix @xmath0 that maps the source subspace to the target one @xcite .",
    "suppose , we have labelled source data s and unlabelled",
    "target data t. we normalize the data vectors and take separate pca of the source data vectors and target data vectors .",
    "the @xmath1 eigenvectors for each domain are selected corresponding to the @xmath1 largest eigenvalues .",
    "we consider these eigenvectors as bases for source and target subspaces separately .",
    "they are denoted by @xmath2 for source subspace and @xmath3 for target subspace .",
    "we use a transformation matrix @xmath0 to align the source subspace @xmath2 to target subspace @xmath3 . the mathematical formulation to this problem",
    "is given by @xmath4 @xmath2 and @xmath3 are matrices containing the @xmath1 most important eigenvectors for source and target respectively and @xmath5 is the _ frobenius norm_. the solution of eqn .",
    "[ equ1 ] is @xmath6 and hence for the target aligned source coordinate system we get @xmath7 .",
    "once we get target aligned source co - ordinate system , we project our source data and train the classifier in this frame . while testing , target data is projected on the target subspace and classifier score is calculated .",
    "convolutional neural nets ( cnn ) and other deep learning based approaches have improved the object classification accuracy by a large margin .",
    "rcnn @xcite uses the cnn framework and bridges the gap between object classification and object detection task .",
    "the idea of this work is to see how well the result of convolutional neural network on imagenet task generalizes for the task of object detection on pascal dataset .",
    "rcnn consists of three modules .",
    "the first module generates selective search windows @xcite in an image which is category independent .",
    "second module extracts mid level convolutional neural network features for each proposed region which has been trained earlier on imagenet dataset . in the third module ,",
    "svm classifier is trained by considering all those windows whose overlap with the ground truth bounding box are less then a threshold @xmath8 as negative examples .",
    "hard negative examples are mined from these negative examples during the training . in testing phase , again 2000 selective search windows are generated per image in fast mode .",
    "each proposal is warped and propagated forward through pre - trained cnn to compute features .",
    "then , for each class , the learned svm class specific classifier is applied to those extracted features and a score is obtained corresponding to each proposal .",
    "once we get the scores , we decide a threshold and the regions with scores greater than the decided threshold are our possible candidates for a particular object category . in the last step greedy non maximum suppression is applied to obtain desired , accurate and specific bounding box for that object category .",
    "in this section we describe our approach to adapt the class specific rcnn -detector . on the basis of background provided in the previous section , we use subspace alignment based domain adaptation over the initial rcnn - detector . instead of using single subspace for the full source and target data , we postulate that using class - specific different subspaces for different classes to adapt from source to target domain improves the object detection accuracy .    @xmath9 @xmath10 @xmath11 @xmath12 @xmath10 @xmath13 @xmath14 @xmath10 @xmath15    @xmath16 = ( ) and @xmath17 = ( ) @xmath18 = @xmath19 for source images @xmath16 = stack(@xmath16,@xmath20 for source images @xmath21 = @xmath22 for target images",
    "@xmath17 = stack(@xmath17,@xmath23 for target images    @xmath24 @xmath10 @xmath25 @xmath26 @xmath10 @xmath27    @xmath28 @xmath10 @xmath29    @xmath30 @xmath10 @xmath31 @xmath32 @xmath10 @xmath33 @xmath34 @xmath10 @xmath35 * return * @xmath34    indeed the more specific subspace for each object category is expected to span the full space in which a particular object category lies , more accurately .",
    "since we are dealing with the unsupervised setting hence we do nt have access to bounding boxes of the target domain data .",
    "source subspace can easily be found using the bounding boxes available for the source data .",
    "an important point to note here is that considering only the ground truth bounding boxes for getting the class specific subspace in source domain data results in overfitting and the subspace obtained by this way does nt truly represent the space of the specific class but represent a smaller and specific space which is subset of the original space . to avoid this problem",
    ", we consider all those bounding boxes whose overlap with the ground truth bounding box is above a particular threshold @xmath36 while obtaining the class specific source domain subspaces .",
    "@xmath36 is chosen by using cross validation on the source data .",
    "once we obtain the class specific source subspaces , we also need to get the class specific target subspaces to apply subspace alignment method for domain adaptation .",
    "the problem here is that we do nt have bounding boxes available for the target data and hence we direcly can not get the search windows and their overlap with the actual bounding boxes . to deal with this problem",
    "we run the rcnn - detector on target dataset which was initially trained on source dataset . running the rcnn - detector",
    "gives the score for every search windows on the images of target dataset .",
    "we consider all the search windows of a specific class as positives samples for subspace generation whose score is greater than a certain threshold @xmath37 . again",
    "this sigma is chosen by using cross validation on source dataset .",
    "once we have positive samples for target subspace , we generate class specific target subspaces and apply subspace alignment approach on each class separately .",
    "the detector is trained separately for each class on target aligned source co - ordinate system . during the test",
    ", target data is projected on target subspace and classified using the detector trained on target aligned source co - ordinate system . in the last step ,",
    "greedy non maximum suppression is applied to predict the most accurate window .",
    "hence , the full algorithm is a two step process , as summarized in the algorithm [ alg : euclid ] .",
    "in this section we describe our experimental setup , dataset and then we evaluate the performance of our method .",
    "we analyze the performance of our added components and discuss its significance with the help of similarity in the principle angles of subspaces . as caffe features @xcite have recently resulted in state of the art for classification , we use caffe features for evaluating our method .",
    "the initial set of positive examples for coco dataset are obtained by running r - cnn detector on the validation set of coco .",
    "this r - cnn detector was trained on pascal voc 2012 . here ,",
    "pascal voc 2012 train+val dataset is the source and validation dataset of coco dataset is the target .",
    "the validation dataset of microsoft coco dataset contains around 40,000 images and provides a challenging substantial dataset for comparison .",
    "while pascal dataset mostly consists of iconic view of the object , coco dataset is more challenging and contains clutter , background , occlusion and multiple side views .",
    "these factors cause significant domain shift in the above mentioned two datasets and make these two dataset a suitable choice to evaluate our algorithm .",
    "more details about the differences between pascal voc 2012 and coco dataset has been discussed in @xcite in great detail .",
    "we provide here in figure [ fig : animals ] , some images from both the dataset to visualize the differences between them .",
    "it can be observed from the figure [ fig : animals ] that while most of the images in pascal dataset contains single instance of object and less background clutter , images in coco datset have generally more than one instance and also contain more background clutter .",
    "0.15    0.15    0.15       0.15    0.15    0.15      pascal dataset is simpler than coco and also smaller hence it has been considered as source dataset and coco is considered as target dataset . for target dataset(coco ) subspace generation , the examples having a classifier score greater than a threshold of 0.4 are considered positive examples for the target subspace .",
    "non maximum supression is removed from the process for consistency in the number of samples for subspace generation .",
    "for source dataset(pascal ) , we evaluate the overlap of each object proposal region with the ground truth bounding box and consider the bounding boxes with threshold greater than 0.7 with the ground truth bounding box as candidates for our source subspace generation .",
    "the dimensionality of subspace for both the source and target dataset is kept fixed at 100 .",
    "subspace alignment is done between source and target subspaces and source data set is projected on the target aligned source subspace for further training .",
    "once the new detectors are trained on the transformed feature the same procedure is applied as rcnn for detection on projected target image features .",
    "here in this section we provide evidence to show the performance of our method , compare our results to other baselines and analyse the results .",
    "first we consider the statistical difference between the pascal voc 2012 and coco validation set data .",
    "we run rcnn detector on both source and target data .",
    "we plot the histograms of score obtained for both the dataset .",
    "it can be observed from their histogram in image [ fig : histogram ] that there exists statistical dissimilarity between both these datasets .",
    "therefore , there is a need for domain adaptation .",
    "the histogram evaluation has been done in two setting , first in a category wise setting and second as a full dataset jointly .",
    "the findings of both these settings is similar and demonstrates the statistical dissimilarity between these two datasets .    0.4        0.4",
    "now we evaluate our method on these two datasets . first baseline to compare with our method",
    "is a simple rcnn detector trained on pascal voc 2012 .",
    "we evaluate the performance of rcnn detector for all the 20 categories which are there in the pascal datasets .",
    "the mean average precision for this baseline comes to 23.60% without applying bounding box regression .",
    "second baseline to compare with our method is rcnn - full image transform .",
    "rcnn - full image transform here indicates that while aligning the subspaces for source and target data , we do nt consider class specific subspace alignment .",
    "we take the full target and source data at once , learn separate subspaces for source and target data , apply the transformation on source domain subspace to align with the target domain subspace and in the last step we train the detector with projected features in target aligned source co - ordinate system .",
    "this baseline is similar to the work done for unsupervised domain adaptation of object classifier using subspace alignment @xcite as discussed in section [ sa ] .",
    "the mean average precision using rcnn - full image transform is 22.70% .",
    "we also compare our result with the result obtained on the coco validation set using deformable part model trained on pascal voc 2012 @xcite as reported in @xcite .",
    "the mean average precision for deformable part model is reported as 16.9% .",
    "we got consistent improvement over all the baselines using our proposed approach .",
    "the proposed approach , rcnn - local class specific transform , gives the mean average precision of * 25.43% * which is almost 1.8% better than the traditional rcnn detector and 8.5% higher than the deformable part model based object detector .",
    "the complete result with category wise performance is given in table [ the_table ] .",
    "we also show here some of the accurate detections obtained using our method and visually compare the detection by traditional rcnn object detector on the same images . in figure",
    "[ good ] we show some detections obtained using our proposed method . figure [ compare ] is used to illustrate the cases when our proposed method works but rcnn fails .",
    "figure [ bad ] contains some images both the detectors failed to perform . in the next subsection [ paa ]",
    ", we discuss the intuition behind our performance and explain it with the principal angle analysis of source and target subspaces .",
    ".domain adaption detection result on validation set of coco dataset .",
    "no transform column represent running the simple rcnn detector on coco dataset which has been trained on pascal voc 2012 .",
    "rcnn- full transform denotes the result obtained by retraining the detector while considering the full source images and target images for aligning the subspace of source and target dataset .",
    "rcnn- local transform means the category specific subspace alignment method ( proposed method ) for adapting the detector and dpm5-p denotes the result from deformable part model on coco dataset , trained on pascal voc 2012 as reported in @xcite . [",
    "cols=\"<,<,^,^,^,^ \" , ]     0.15    0.15    0.15       0.15    0.15    0.15    0.15    0.15    0.15    0.15    0.15    0.15       0.15      as is evident from the table [ the_table ] , the proposed method outperforms the baselines for almost all of the classes except for a few categories .",
    "we also analyse category wise similarity between the source subspaces and target subspaces to explain this phenomena .",
    "the similarity between    r0.6        [ colormap ]    two subspaces is calculated by first finding the principal angles between two subspaces and then taking the 2-norm of cosines of vectors of principal angles between them .",
    "@xmath38 = @xmath39 , where @xmath40 is the vector of principal angles between subspaces @xmath2 and @xmath3    in the results we observe that our method is either improving very little or not improving at all for which the traditional rcnn detector itself is not performing well .",
    "our method relies on the initial detection obtained by the rcnn . when the initial detection is better , then",
    ", we learn a better subspace and hence we obtain a better subspace alignment . for classes",
    "where initial detections are not good then no meaningful subspace can be learned for such categories .",
    "this can be observed for class no .",
    "@xmath41(boat ) , @xmath42(bottle ) and @xmath43(chair ) from figure [ colormap ] that similarity between source subspace of those classes and target subspace of the corresponding classes are very low . hence , the performance of our method on these classes are not good .",
    "but for the rest of the classes , as can be seen from the diagonal blocks of the figure [ colormap ] , the target subspaces are quite discriminative and inter class subspaces are not very similar .",
    "this gives improvement in the result .",
    "one more interesting thing to discuss here is that for class no .",
    "@xmath44 , though the similarity between source subspace for class no .",
    "@xmath44 and target subspace for same class is good but this subspace is also very similar to the subspaces of other categories as a few numbers of yellow blocks are available there in the row and column corresponding to class @xmath44 . in that region",
    ", full image transformation is expected to perform better for this class and our experimental results also demonstrate this point .",
    "in this paper , we have presented a method for adapting the state - of - the - art rcnn object detector for unsupervised domain adaptation from source to target dataset .",
    "the main challenge addressed in this paper is to obtain localized domain adaptation for adapting object detectors .",
    "the adaptation has been achieved by using approach based on subspace alignment that efficiently projects the source subspace to the target subspace .",
    "the proposed method results in improved object detection .",
    "thus , one can use rcnn for instance to detect persons in novel settings with improved detection accuracy .",
    "the main limitation of this approach is that the present method does not work well for classes where the rcnn results are weak .",
    "this limitation can be addressed by partially relying on supervision for classes where the source detection result is itself quite weak .",
    "further , once there is some supervision available , it would be interesting to jointly consider learning domain adaptation at both feature and subspace level simultaneously .",
    "the authors would like to acknowledge funding support received from the erc starting grant cognimund and the research - i foundation at the computer science department at iit kanpur        gopalan , raghuraman , ruonan li , and rama chellappa .",
    "`` domain adaptation for object recognition : an unsupervised approach . '' in computer vision ( iccv ) , 2011 ieee international conference on , pp .",
    "999 - 1006 .",
    "ieee , 2011 .",
    "gong , boqing , yuan shi , fei sha , and kristen grauman .",
    "`` geodesic flow kernel for unsupervised domain adaptation . '' in computer vision and pattern recognition ( cvpr ) , 2012 ieee conference on , pp .",
    "2066 - 2073 .",
    "ieee , 2012 .",
    "0 fernando , basura , amaury habrard , marc sebban , and tinne tuytelaars",
    ". `` unsupervised visual domain adaptation using subspace alignment . '' in computer vision ( iccv ) , 2013 ieee international conference on , pp .",
    "2960 - 2967 .",
    "ieee , 2013      mirrashed , f. , morariu , v. i. , siddiquie , b. , feris , r. s. , & davis , l. s. ( 2013 , january ) . domain adaptive object detection . in applications of computer vision ( wacv ) , 2013 ieee workshop on ( pp .",
    "323 - 330 ) .",
    "ieee .",
    "hoffman , judy , sergio guadarrama , eric s. tzeng , ronghang hu , jeff donahue , ross girshick , trevor darrell , and kate saenko .",
    "`` lsda : large scale detection through adaptation . '' in advances in neural information processing systems , pp .",
    "3536 - 3544 . 2014 .",
    "girshick , r. , donahue , j. , darrell , t. , & malik , j. ( 2014 , june ) .",
    "rich feature hierarchies for accurate object detection and semantic segmentation . in computer vision and pattern recognition ( cvpr ) , 2014 ieee conference on ( pp .",
    "580 - 587 ) .",
    "ieee .",
    "oquab , m. , bottou , l. , laptev , i. , & sivic , j. ( 2014 , june ) . learning and transferring mid - level image representations using convolutional neural networks . in computer vision and pattern recognition ( cvpr ) , 2014 ieee conference on ( pp .",
    "1717 - 1724 ) .",
    "hoffman , j. , guadarrama , s. , tzeng , e. , hu , r. , donahue , j. , girshick , r. , darrell , t. , and saenko , k. `` lsda : large scale detection through adaptation . '' in advances in neural information processing systems , pp .",
    "3536 - 3544 . 2014 .",
    "lin , t. y. , maire , m. , belongie , s. , hays , j. , perona , p. , ramanan , d. , ... & zitnick , c. l. ( 2014 ) .",
    "microsoft coco : common objects in context . in computer vision ",
    "eccv 2014 ( pp .",
    "740 - 755 ) .",
    "springer international publishing .",
    "jia , y. , shelhamer , e. , donahue , j. , karayev , s. , long , j. , girshick , r. , ... & darrell , t. ( 2014 , november ) .",
    "caffe : convolutional architecture for fast feature embedding . in proceedings of the acm international conference on multimedia ( pp .",
    "675 - 678 ) ."
  ],
  "abstract_text": [
    "<S> in this paper , we propose subspace alignment based domain adaptation of the state of the art rcnn based object detector @xcite . </S>",
    "<S> the aim is to be able to achieve high quality object detection in novel , real world target scenarios without requiring labels from the target domain . </S>",
    "<S> while , unsupervised domain adaptation has been studied in the case of object classification , for object detection it has been relatively unexplored . in subspace based domain adaptation for objects , we need access to source and target subspaces for the bounding box features . </S>",
    "<S> the absence of supervision ( labels and bounding boxes are absent ) makes the task challenging . in this paper </S>",
    "<S> , we show that we can still adapt subspaces that are localized to the object by obtaining detections from the rcnn detector trained on source and applied on target . </S>",
    "<S> then we form localized subspaces from the detections and show that subspace alignment based adaptation between these subspaces yields improved object detection . </S>",
    "<S> this evaluation is done by considering challenging real world datasets of pascal voc as source and validation set of microsoft coco dataset as target for various categories . </S>"
  ]
}