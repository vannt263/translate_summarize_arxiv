{
  "article_text": [
    "quantitative analysis of brain vasculature is used in a variety of fields , including vascular development @xcite and physiology @xcite , neurovascular coupling @xcite , and blood - brain barrier studies @xcite .",
    "distinguishing blood vessels from the surrounding tissue ( vessel segmentation ) is often a necessary preliminary step that enables more accurate and efficient analyses of the vascular network .",
    "for example , characteristics of vasculature morphology such as tortuosity , length , and diameter , can be obtained without confounding factors from the extravascular space , such as dendrites .",
    "in addition to characterizing the vasculature itself , vessel segmentation also facilitates analyses of other dynamic factors , including cortical blood flow and angiogenesis .",
    "clinically , quantitative analysis of vessels will assist in making diagnoses and planning surgeries @xcite .",
    "for example , retinal vasculature imaging @xcite allows inexpensive and fast screening of several eye - related and systematic pathologies such as glaucoma , age - related macular degeneration , diabetic retinopathy , hypertension , arteriosclerosis and alzheimer s disease @xcite . differentiating blood vessels from the surrounding tissue",
    "also allows more accurate analyses of extravascular structures , such as tumor volume quantification @xcite and pulmonary lobes structural analysis @xcite .",
    "given that vascular diseases , such as coronary heart disease , are among the largest public health problems in developed countries @xcite , accurate and efficient image analysis will only become more relevant . @xcite .",
    "thus , the segmentation of vascular structures from surrounding tissue is useful for both basic research and clinical applications .",
    "there have been various approaches for vessel segmentation ( for reviews see @xcite ) , but to date , no single method have been able to successfully segment vessels from every imaging modality and every organ @xcite .",
    "our group uses vessel segmentation for two purposes : 1 ) to analyze changes in vascular morphology after focused ultrasound mediated blood - brain barrier opening @xcite , and 2 ) to observe tumor pathophysiology and drug kinetics following application of focused ultrasound stimulated microbubbles ( unpublished ) .",
    "both of these projects use the two - photon microscope for acquiring high - resolution images .",
    "we were motivated to improve our vessel segmentation pipelines from previous custom - written semi - automatic matlab scripts @xcite , and labor - intensive manual approaches using commercial imaris ( bitplane ag , zurich , switzerland ) platform and open - source imagej / fiji platform @xcite , to be more automatic and robust .",
    "delineating blood vessels from the extravascular space enables quantification of the rate and duration of dye leakage , which can be correlated with kinetics and characteristics of blood - brain barrier integrity @xcite .",
    "other groups have used vessel segmentation as an image processing tool to analyze other factors from two - photon datasets , including neurovascular coupling @xcite , neuronal calcium imaging @xcite , and low - intensity focused ultrasound brain modulation paradigms @xcite .",
    "two - photon microscopy , or more generally , multiphoton microscopy , has become the workhorse of neuronal imaging @xcite .",
    "multiphoton microscopy allows better optical sectioning and reduced photobleaching outside of the imaging plane compared to the traditional confocal techniques due to the nonlinear nature of the two - photon excitation fluorescence .",
    "traditional two - photon microscopy operates on scanning point - by - point compared to whole - field approach of confocal microscopy , limiting also the maximum frame rates achieved by scanning two - photon microscopy .",
    "two - photon light - sheet imaging operates on a line or a plane basis instead of a point , speeding the volumetric imaging by one or two orders of magnitude if faster faster rates are needed @xcite .",
    "additionally two - photon fluorescence imaging can be combined with other nonlinear processes such as with third - harmonic generation ( thg ) for label - free vascular imaging @xcite , and other microscopy techniques such as electron microscopy for more detailed analysis @xcite .",
    "@xcite for example integrate _ in vivo _ two - photon microscopy with _",
    "ex vivo _ light sheet microscopy and use the major blood vessels as landmark points for registration .    compared to the literature focused on clinical angiography with various modalities and anatomical applications , there exists very little literature devoted on processing multiphoton vasculature images .",
    "likewise , not much work has been done on open - source software and/or code for multiphoton vasculature analysis .",
    "the work by santamaria - pang _ et al . _",
    "@xcite on tubular 3d neuronal structures representing one of the few examples for `` morphological '' multiphoton microscopy analysis , and python - based vmtk ( @xcite , http://www.vmtk.org/ ) for open - source vessel analysis .",
    "this is in stark contrast to work devoted on calcium imaging analysis with various freely available toolboxes ( e.g. @xcite ) .",
    "traditionally vessel segmentation have been done on some combination of vascular models , image features and extraction schemes often relying on prior knowledge about the tubularity of vessels @xcite . typically in computer vision / image analysis field , algorithms and pipelines",
    "are developed using reference dataset as benchmarks for performance . in biomedical image analysis ,",
    "almost all open image segmentation challenges are listed in   http://grand-challenge.org/ [ http://grand-challenge.org/ ] with only challenge ( vessel12 , @xcite ) devoted to vessel segmentation .",
    "it is common that many fields suffer from lack of annotated datasets @xcite as they are expensive to generate such as is the case for example in high content screening ( hcs ) technologies labeled at cell level @xcite , and in electron microscopy @xcite .",
    "additional standardized datasets can be found for evaluating coronary artery centerline extraction algorithms @xcite , and for evaluating coronary artery stenosis detection , stenosis quantification and lumen segmentation algorithms in computed tomography angiography @xcite .",
    "thus , despite the numerous papers on vessel segmentation there has been very little effort for creating standardized three - dimensional vascular datasets .",
    "the the most similar datasets can be found for example for two - dimension retinal vessels in drive dataset @xcite , and three - dimension tubular fibers in diadem challenge @xcite . among the 23 submitted methods to the vessel12 challenge ,",
    "only two submission were machine - learning based with the other one of them ending up providing the best overall performance in terms of segmentation accuracy . similarly with natural images , research teams compete against each other trying to improve the performance of the classifier .",
    "one example of such challenge is the imagenet large scale visual recognition challenge ( ilsvrc ) challenge that is taking place annually with the same database of images @xcite .    during past few years",
    ", data - driven machine learning algorithms have replaced `` hand - crafted '' filter pipelines on many fields of image processing .",
    "majority of the emerged approaches have relied on deep learning networks @xcite opposed to `` traditional '' shallow networks @xcite . * * _ _ * * from different deep learning architectures , convolutional neural networks ( cnn or convnet ) have been the mostly used in image classification and image segmentation . while convnets have been around for decades ( e.g. @xcite ) , the recent success had been due to the combination of bigger annotated datasets , more powerful hardware , new ideas , algorithms and improved network architectures enabling this sort of `` paradigm shift '' in machine learning .",
    "since 2011 , graphical processing unit ( gpu)-based convnets have dominated classification ( @xcite ) , and segmentation contests ( @xcite ) .",
    "convnets are loosely inspired of biological networks ( e.g. @xcite ) allowing hierarchical feature learning starting from low - level features such as edges into higher - level features such as faces for example .",
    "convnets possess two key properties that make them useful in image analysis : spatially shared weights and spatial pooling ( @xcite ) .",
    "this allows feature learning that is shift - invariant , i.e. filter that is useful across the entire image as image statistics are stationary @xcite .",
    "typical convolutional networks are composed of multiple stages ( ) , and the output of each stage is made of two or three dimensional arrays depending on the training data , called feature maps . each feature map is the output of one convolutional filter ( or pooling ) applied over the full image .",
    "this is typically followed by non - linear activation function such as sigmoid , rectifying linear unit ( relu ) or hyperbolic tangent ( _ @xmath0 _ ) .",
    "after the final pooling layer of the network , there might be one or more fully - connected ( fc ) layers that aim to perform high - level reasoning .",
    "they take all neurons from the previous layer and connect them to every single neuron of current layer ( i.e. fully - connected ) .",
    "no spatial information is preserved in typical fully - connected layer configurations . in the end of the networks there",
    "is typically a terminal ( `` output '' ) classification layer that based on the number of classes produces real - valued or binary scalar for each image in image classification dataset , or for the each pixel in each image image segmentation dataset . * * the most typical output layer uses a _ softmax _",
    "regression that generates probability distribution of the outputs @xcite .",
    "the shortcoming of softmax is that does not capture model uncertainty and often it is interpreted erroneously as model confidence @xcite .",
    "if model uncertainty is needed , there have been effort to cast deep learning models as bayesian models@xcite .",
    "the networks are typically regularized to mitigate over - fitting either using technique called dropout @xcite in which each neuron has a probability of 0.5 to be reset with 0-value , typically only used in last fully - connected layers . alternatively one can regularize the network by injecting noise for example just before the nonlinear activation function @xcite .",
    "convnets are typically trained using stochastic gradient descent ( sdg ) optimization method with _ mini - batches _ so that the gradient on each training iteration is computed using more than one training example ( i.e. patch of image / volume ) resulting in smoother convergence , and more efficient use of vectorization libraries , thus faster computation times .",
    "convnets can be roughly divided to two basic types @xcite : feedforward networks which are organized in layers with unidirectional connections ( e.g. the proposed approach here from lee _ et al . _",
    "@xcite ) , and recurrent network in which feedback connectivity is dominant ( e.g. used by pinheiro _",
    "@xcite for semantic segmentation ) .",
    "feedforward networks are typically used for image classification and segmentation , whereas recurrent networks are used for sequential data such as language , and sound processing .",
    "surprisingly even though the convnets have been highly successful , the success of the convnets are not well understood even by the people designing new algorithms and architectures ( e.g. @xcite ) .",
    "the ultimate goal of artificial intelligence ( ai ) including image segmentation would be to build machines that understand the world around us , i.e. disentangle the factors and causes it involves ( @xcite ) , or in more practical terms , to have an image segmentation system that would have an `` understanding '' of the vesselness . in our case eventually exceeding the human expertise in determining which part of the image is part of the vessel .",
    "this human - level concept learning was recently demonstrated for written character recognition by lake _",
    "@xcite from very limited training samples starting from just one examples . for `` brute - force approaches '' ,",
    "there have been convnets that have surpassed human - level performance on image classification @xcite .",
    "we aim to improve the accuracy of the vessel segmentation for multiphoton microscopy by training a deep learning framework based on convolutional networks ( convnets ) in supervised manner with no free parameters for the user to adjust .",
    "we have implemented our three - dimension vessel segmentation using open - source cpu - accelerated znn framework @xcite previously used for three - dimensional electron microscope segmentation .",
    "our main motivation for this proof - of - concept work is to inspire more researchers to work on biomedical segmentation problems by providing public available annotated dataset of two - photon fluorescence microscopy vasculature stacks with the code needed to easily fine - tune the network using your own training data and improve our model .",
    "our work tries to integrate the fields of machine learning , biomedical image analysis , and neuroscience _ _ and motivating applications .",
    "two - photon microscopy is capable of providing beautiful high - resolution images of biological processes _ in vivo_. by creating an open source , reproducible method of vascular segmentation , quantitative results can be more readily attained and compared .",
    "we hope to decrease the time overhead required for image processing by the average microscope user and accelerate the educational translation of new information to the scientific community .    _ _",
    "typical simplified schematic of vasculature segmentation pipeline used to process two - photon microscope stacks is shown in .",
    "the image stacks suffer mainly from photon noise following a poisson distribution @xcite ( i.e. the noise intensity depends on the underlying signal ) with some gaussian noise component added , which can be denoised directly with methods developed for poisson noise ( e.g. pure - let @xcite ) .",
    "alternatively the signal - dependency of the poisson noise can be removed with a suitable transform such as anscombe transform @xcite that allows one to use denoising methods developed for gaussian noise ( e.g. bm3d / bm4d @xcite ) .",
    "deconvolution is not done as commonly for multiphoton microscopy as compared to confocal microscopy @xcite , but if it is been done in can be done jointly with other image restoration operations @xcite or as its independent step @xcite .",
    "this part can be seen as the image restoration part with an attempt to recover the `` original image '' as well as possible corrupted by the imaging process .    * *    in some cases the restored image is further simplified using some edge - aware smoothing operator such as anisotropic diffusion @xcite , or as done by persch _",
    "@xcite who jointly apply the anisotropic diffusion inpainting ( operation that attempts to replace lost or corrupted parts of the image data ) with deconvolution and interpolation .",
    "this step is followed by some `` vesselness filter '' or `` vesselness enhancement '' filter that is designed to enhance tubular structures such as vessels in the image .",
    "the best known filter of those is the frangi s filter @xcite that has become outdated as it can not properly handle crossings nor bifurcation methods , and several filters @xcite have been proposed to correct the shortcomings of frangi s filter with none of them reaching a _ de facto _ standard status .    in our proposed deep learning - based network",
    "we are trying to replace the vessel enhancement and segmentation steps , and keep still using `` traditional '' filters with the image restoration part ( see discussion on how to get upgrade them as well in [ sub : training - everywhere ] ) .",
    "there have been various `` traditional '' segmentation algorithms for vessel segmentations ( for reviews see @xcite ) , and only the most relevant ones are analyzed here below .    in the schematic ( ) @xmath1-interpolation is placed after the segmentation , but it might have been placed as well before the segmentation algorithm @xcite , or jointly with other image restoration operators @xcite .",
    "the exact placing of the interpolation depends on the computation before and after it , but in our case we placed in the end to emphasize the gains of @xmath1-direction interpolation to mesh reconstruction as all our stacks used in this work are anisotropic ( see ) .",
    "reconstructing meshes from non - interpolated anisotropic stacks with traditional marching cubes algorithm @xcite typically leads to `` staircasing effect '' of the mesh while interpolation gives smoother reconstruction .",
    "advanced mesh reconstruction methods are beyond the scope of this algorithm , but there have been efforts to improve biomedical mesh reconstruction @xcite mitigating the problems of triangulation based such as marching cubes . with the reconstructed vasculature mesh ,",
    "it is then possible to for example do morphological analysis @xcite , calculate hemodynamic parameters @xcite , or analyze the functional diameter changes in response to external stimulus @xcite .    to the knowledge of the authors ,",
    "deep learning frameworks including convnets have not yet been applied to segmentation of three - dimensional volumetric vasculature images . despite the limited use of machine learning techniques in vessel12 challenge for lung vessels",
    "@xcite , there have been some work using machine learning techniques for vessel segmentation .",
    "@xcite for example used an unsupervised dictionary learning @xcite approach that learned optimal separable convolutional filter banks for 2d vasculature segmentation ( drive dataset @xcite ) , and for 3d olfactory projection fibers ( diadem challenge @xcite ) .",
    "the filter banks were then used with the popular random forests classifier @xcite continuing the previous work from the same lab @xcite .",
    "the authors used their separable filter banks with convnets for image classification task but did not discuss about the possibility of using convnets with the image segmentation task . very recently",
    "maji et al .",
    "@xcite applied convnets for the two - dimensional vasculature drive database with promising performance .",
    "santamaria - pang _ et al . _",
    "@xcite similarly used a dictionary learning approach to learn linear filters for detection of tubular - like structures from multiphoton microscopy stacks .",
    "the learned filters were fed to a support vector machine ( svm , @xcite ) which was shown to provide a better segmentation accuracy compared to the vesselness filter introduced by sato _",
    "recently , schneider _",
    "@xcite used random forests for classification with multivariate hough forests to infer probabilistic votes about the vessel center , jointly segmenting vasculature and extracting vessel centerline .",
    "the features were learned using steerable filter templates ( @xcite ) at multiple scales instead of the dictionary learning approach .",
    "they showed that their learning - based approach outperformed both oriented optimal flow ( oof , @xcite ) and frangi s filter @xcite for vessel segmentation .",
    "sironi _ et al . _",
    "@xcite take a different approach in their paper inspired by recent work on structured learning - based edge detectors ( @xcite ) .",
    "they combine structured learning with nearest neighbor - based output refinement step designed for situations where edges or thin objects are hard to detect explicitly by the neural network ( @xcite ) .",
    "they were able to reduce spatial discontinuities , isolated erroneous responses and topological errors of initial score maps from outputs of other algorithms , and when directly trained to segment two - dimensional blood vessels ( drive dataset @xcite ) .",
    "there is relatively more work devoted on natural image processing compared to biomedical image analysis . in natural image processing literature ,",
    "the corresponding application to our biomedical image segmentation is semantic segmentation @xcite , also referred as scene parsing @xcite or scene labeling @xcite .",
    "semantic segmentation with natural images tries to answer to the question `` what is where in your image ? ''",
    "for example segmenting the `` driver view '' in autonomous driving to road , lanes and other vehicles @xcite . in typical semantic segmentation tasks",
    "there are a lot more possible labels than in our two - label segmentation of vessels and non - vessel voxels , further complicating the segmentation .",
    "most existing biomedical segmentation pipelines start with slice - by - slice two - dimensional processing for volumetric stacks , and only later transition to three - dimensional processing due to high computational cost of fully three - dimensional pipelines @xcite .",
    "convnets with 3d filters had been used for example with block face em images before @xcite , most of the 3d filter use being employed in video processing @xcite where the 2d image with the time can be viewed as an anisotropic 3d image . due to ever - increasing computational performance in local gpu clusters , and cloud - based services such as amazon aws , ibm softlayer , microsoft",
    "azure and google cloud platform we expect to see more purely three - dimensional approaches such as the one proposed by kamnitsas _",
    "@xcite for _ _ brain lesion segmentation from mri images .    deep learning based approaches",
    "have been extensively used for volumetric electron microscopy ( em ) segmentation @xcite .",
    "other biomedical image segmentation tasks with deep learning frameworks include for example brain segmentation @xcite , prediction of alzheimer s disease from magnetic resonance imaging ( mri ) scans @xcite , microscopic cell segmentation @xcite , glaucoma detection @xcite , computational mammography @xcite , pancreas segmentation @xcite , bi - ventrical volume estimation @xcite , and carotid artery bifurcation detection @xcite    the use of deep learning neural networks is not limited to image analysis , and it can employed in various fields that can benefit from data - driven analysis in exploratory or predictive fashion . in neuroscience ,",
    "in general the datasets are getting increasingly larger and more complex requiring more sophisticated data analysis tools @xcite .",
    "there have been systems capable of constructing theories automatically in data - driven fashion @xcite .",
    "artificial neural networks lend themselves well for modeling complex brain function that emerge from activation of ensembles of neurons in which the studying of single neuron at a time is not sufficient @xcite .",
    "for example , the circuit architecture of the mammalian hippocampus have been modeled to consist of series of sequential feedforward and recurrent neural networks @xcite .",
    "@xcite used two - photon imaging to measure the calcium activity of mouse making behavioral choices in virtual maze .",
    "the temporal trajectory of neuron populations was shown to be predictive of the behavioral choice , thus being suitable for the use of recurrent neural networks to model the behavior .",
    "in addition to basic neuroscience , deep learning `` expert systems '' have been extended to clinical settings @xcite for example for predicting clinical outcomes of radiation therapy @xcite , electroencephalographic ( eeg ) recording analysis @xcite , and future disease diagnosis and medicine prescription in routine clinical practice @xcite .",
    "the vessel dataset described here were acquired from mouse cortex , and from gfp - labelled human squamous cell carcinoma tumors , xenografted onto the dorsal skin of mice with implanted dorsal window chambers ( fadu - gfp , anticancer inc . ) , tumors summarized in ( see the maximum - intensity projections of stacks in [ fig : training - dataset - visualized ] ) . fluorescent dextran ( 70 kda texas red , dissolved in pbs , invitrogen ) was used to visualize the vasculature in mouse cortex by @xcite , and fluorescent dextran ( 2mda fitc , dissolved in pbs , invitrogen ) to label the tumor vasculature .",
    "imaging was performed using the fv1000 mpe two - photon laser scanning microscope ( olympus ) with tunable mode - locked ti : sapphire laser using several excitation wavelengths and water - immersion objective lenses__. _ _    the auxiliary matlab code for our implementation of znn is provided in https://github.com/petteriteikari/vesselnn , with the annotated dataset available from https://github.com/petteriteikari/vesselnn_dataset .    * ]      we used the java - based bio - formats library ( ome - the open microscopy environment , https://www.openmicroscopy.org/ , @xcite ) with matlab@xcite to open the oib files from olympus fluoview 2-photon microsopy setup .",
    "we selected representative substacks from each original stack to reduce the time needed for manual annotation by us researchers .",
    "the substacks were converted to 16-bit ome - tiff image files containing all the original metadata .",
    "the ground truth for the vessels were manually annotated slice - by - slice using custom - written matlab code to produce a `` seed binary '' image containing the strongest edges which then had to be refined manually using the pencil tool of gimp ( http://www.gimp.org ) .",
    "we used more conservative criteria for labeling vasculature than the traditional `` 50% of the voxel '' to account the partial volume effect @xcite , and we tried to include all the vessel - like structures to the label mask .      after converting the substacks to ome - tiff files , we denoised the microscopy stacks using the state - of - the art denoising algorithm bm4d ( @xcite ) implemented in matlab .",
    "bm4d is a volumetric extension of the commonly used bm3d denoising algorithm @xcite for 2d images , which was for example used to denoise two - photon microscope images by danielyan _",
    "they also demonstrated that the two - photon microscopy noise can be modeled well using the models developed for digital cameras .",
    "bm3d / bm4d were designed for denoising images degraded by gaussian noise , thus we applied first anscombe transform to reduce the signal - dependency of the noise as done with bm4d for denoising of magnetic resonance imaging ( mri ) images @xcite .",
    "after the bm4d denoising , an inverse anscombe transform was applied to convert the stacks back to original intensity domain .",
    "two of the stacks ( ` burgess2014 bbbdisruption ` , and ` burgess2014 noisysparsevessels ` ) were degraded by horizontal periodic `` banding '' caused by improperly balanced microscope stage , and the degradation was mitigated using spatial notch filters in frequency domain applying fast fourier transform ( fft ) in matlab .",
    "noise components were manually identified and then removed before denoising those images .",
    "we did not apply any blind deconvolution ( e.g. @xcite ) for our microscope stacks to improve the image quality .",
    "there was no significant spectral crosstalk in any of the stacks , thus no spectral unmixing or blind image separation ( e.g. @xcite ) was done for the image stacks .",
    "likewise , no motion compensation algorithms ( e.g. @xcite ) was needed for the dataset .      to analyze the segmentation quality of our proposed architecture we used average hausdorff distance ( avd ) as the error metric .",
    "the avd between the ground truth and output of the proposed architecture was computed using the ` evaluatesegmentation ` package ( http://github.com/codalab/evaluatesegmentation ) published by taha _",
    "avd was chosen as the metric as it is well suited for evaluating complex boundary delimitation .",
    "disadvantage of the avd is that it is based on calculating the distances between all pairs of voxels , making it computationally intensive and not feasible to be integrated to network training for example .    *",
    "*      we trained our 3d vessel segmentation deep convnet using znn framework @xcite , that uses multicore cpu parallelism for speed instead of typical gpu - accelerated frameworks such as theano for example @xcite . at the time of our training ,",
    "there were not many frameworks available that would take the 3d context into account .",
    "commonly used library caffe @xcite had only 2d networks available , while deeplab built on top of caffe would have had gpu - accelerated 3d networks implemented .",
    "our approach for vessel segmentation is inspired by the success of znn in segmenting three - dimensional electron microscope ( em ) image stacks @xcite , and we chose to start with the networks described for em segmentation .",
    "znn produces a dense output with pixel - by - pixel segmentation maps in contrast to image - level labels in object recognition .",
    "convnets have excelled in object recognition which typically only require single output value for an entire input image _ [ i.e .",
    "is there a dog in the image ? yes ( 1 ) , or no ( 0)]_. znn employs max - filtering which slides a window across image and applies the maximum operation to that window retaining original image resolution . traditionally ,",
    "in semantic segmentation ( @xcite ) and biomedical image segmentation ( @xcite ) pipelines , max - pooling is used instead of max - filtering which reduces the dimensions of the output map requiring either post - processing using for example some graphical model ( @xcite ) , or upsampling back to the original resolution ( @xcite)_. _ the max - filtering employed by znn can be thought as the dense variant of max - pooling filter as it keeps image dimensions intact while making all filtering operation sparse both via convolution and max - filtering .",
    "this approach is also called `` skip - kernels '' _ _ ( @xcite ) or `` filter rarefaction '' ( @xcite ) , and is equivalent in its results to `` max - fragmentation - pooling '' ( @xcite ) . in practice with znn",
    "we can control the sparseness of filters independent of max - filtering .",
    "we adopted the recursive architecture from lee _ et al . _",
    "@xcite used to segment electron microscopy ( em ) stacks .    ]",
    "[ [ vd2d ] ] vd2d + + + +    the chosen recursive architecture first involved a two - dimensional vd2d ( `` very deep 2d '' ) `` pre - training '' stage that is shown in and in .",
    "all convolutions filters have sizes of 3@xmath23@xmath21 , except that ` conv1c ` uses a 2@xmath22@xmath21 filter to make the `` receptive field '' for a single output pixel to have an odd - numbered size , and thus centerable around the output pixel__. _ _ some convolution layers are employing hyperbolic tangent ( @xmath0 ) nonlinearities rather than traditionally used rectifying linear units ( relus ) as the authors argued that this might suppress variations in the feature maps due to image quality variations .",
    "this was left however untested in their original paper .",
    "[ [ vd2d3d ] ] vd2d3d + + + + + +    the two - dimensional convolutional layers of the following second stage named vd2d3d ( `` very deep 2d-3d '' , see and ) are initialized with the trained weights of the vd2d without enforcing weight sharing as done by some recurrent convnets ( @xcite ) .",
    "the main idea behind having initial 2d layers in the vd2d3d is to make the network faster to run and train , while the 3d filters in the layers enable the network to use 3d context in vessel segmentation providing more accurate predictions .    in theory",
    "the accuracy could be further improved by transforming all the layers to 3d but this would in practice come with increased computational cost and memory requirements .",
    "the vd2d3d could be used directly for the denoised input images without the initial vd2d training , but lee _ et al . _",
    "@xcite showed that providing the output of vd2d recursively as the input to the vd2d3d produced a significant improvement in performance .",
    "the layers ` conv1a ` , ` conv1b ` , and ` conv1c ` are used to process the recursive inputs along with the denoised input images , which then are combined together after ` conv1c ` .",
    "this parallel processing stream should allow more complex , highly nonlinear interaction between low - level features and contextual information in the recursive input .",
    "the increase of trainable parameters due to switch from 2d filters to 3d filters were compensated by trimming the size of later layer feature map from 200 ( ` conv5 ` of vd2d ) to 100 ( ` conv4c ` of vd2d3d )    [ [ vd2d3d_v2 ] ] vd2d3d_v2 + + + + + + + + +    we changed the last two - dimensional layer ( ` conv3 ` into three - dimensional layer ( see vd2d3d_v2 in ) keeping the vd2d3d otherwise the same .",
    "[ [ vd2d3d_v3 ] ] vd2d3d_v3 + + + + + + + + +    .we wanted to see what would be the effect of changing the first layer into three - dimensional .",
    "this in practice would correspond to the low - level features and should improve the detection of three - dimensional structures rather over two - dimensional filters that could confuse `` feature - like '' two - dimensional noise to `` real '' three - dimensional vasculature .",
    "the network training procedure was similar to the one described by lee _",
    "we trained our network using backpropagation with the cross - entropy loss function .",
    "the vd2d was first trained for 60k updates using 100@xmath2100@xmath21 output patches .",
    "the initial learning rate was set to 0.01 , the momentum of 0.9 , and an annealing factor of 0.999 which was applied every 6 updates giving us a learning rate of 0.000000452 at the end of vd2d training .",
    "each update took around 2.9 seconds in our intel dual intel xeon e5650 * * quad cpu * * ( 16 hyperthreads , 24 gb ram ) workstation on ubuntu 14.04 , with all the 16 threads in use giving us a total of 2 days for the vd2d training .",
    "after completing vd2d training , we continued with the training of vd2d3d for 90,000 updates as in the original paper by lee _",
    "_ @xcite with an initial learning rate of 0.01 , the momentum of 0.9 and with the same annealing factor of 0.999 which was applied on every update for 15k updates , after which the learning rate was set 0.0001 with the same annealing factor that was this time applied on every 10th update .",
    "each update took around 23 seconds , giving us a total of 24 days for the training of vd2d3d with the same 90k updates .",
    "for the modified architectures with extended 3d support ( v2 and v3 ) higher memory were required , and fully 3d pipeline was not possible with the current implementation of znn with just 24 gb of ram .",
    "each update with v2 took around 27.2 seconds ( 90,000 updates took slightly over 28 days ) , and with v3 each update took around 24.4 /seconds ( 90,000 updates took slightly over 25 hours ) .",
    "like lee _ et al . _",
    "@xcite , we rebalanced the classes ( vessels / non - vessels ) by differentially weighing the per - pixel loss to deal with the imbalance between vessels and non - vessel pixels which was however lower than the imbalance seen in electron microscope images between boundary and non - boundary pixels .",
    "we also augmented the data by randomly rotating and flipping 2d image patches as implemented in znn .",
    "additionally we could have introduced photometric distortions ( @xcite ) to further counteract the possible overfitting due to limited training data , but they were seen unnecessary at the time of the training",
    ".    we also used dropout ( @xcite ) to further avoid overfitting that was implemented in znn .",
    "dropout was applied to the ` conv4c ` layer with a probability of 0.5 to be reset with a 0-valued activation .",
    "our proposed segmentation pipeline is based on the znn framework that is freely available online at https://github.com/seung-lab/znn-release by the original authors @xcite .",
    "we have develop some helper function for that using matlab , and all those files are available from our github repository at https://github.com/petteriteikari/vesselnn . in the spirit of reproducible research @xcite we release also our annotated dataset for other research teams to be used .",
    "the dataset is available from https://github.com/petteriteikari/vesselnn .",
    "see the summary of results of the training in which basically shows that vd2d3d is better than vd2d as expected , and that stack 10 ruins the statistics as it was not segmented that well .",
    "otherwise the average hausdorff distance might be a a bit abstract , but smaller distance the better , and it was recommended for complex boundaries such as vessels and neurons in the review by taha and hanbury @xcite .    the more detailed results of vd2d and vd2d3d architecture with thresholding and dense crf post - processing can be seen in , quantified using hausdorff average distance ( avd ) . the difference in performance between different variants of the vd2d3d and vd2d is shown in , quantified using the same avd metric .",
    "comparison of different metrics for the baseline vd2d3d is shown in to provide better interpretability compared to other studies as avd is not the most typically used metric .",
    "rand index and area under the curve ( auc ) was chosen as metrics as they are typically used as error metrics in medical segmentation studies @xcite . .",
    "mutual information quantifies recall ( i.e. the segmentation should have all the regions marked in the ground truth , while not penalizing the added regions too much ) on cost of precision .",
    "hausdorff distance and mahalanobis distance are spatial distance based metrics closely related to our method of choice average hausdorff distance ( avd ) that is basically a more robust version of hausdorff distance handling outliers better .",
    "mahalanobis distance would be preferred in segmentation where general shape and alignment are important .",
    "2@>b0.15>b0.2|>b0.05>b0.05 > b0.05>b0.05 > b0.05>b0.05 > b0.05>b0.05",
    "> b0.05>b0.05 > b0.05>b0.05|>b0.05>b0.05 * network * & & * 1 * & * 2 * & * 3 * & * 4 * & * 5 * & * 6 * & * 7 * & * 8 * & * 9 * & * 10 * & * 11 * & & * mean * & * sd * & densecrf 2d & 1.44 & 0.19 & 0.23 & 0.29 & 0.67 & 0.67 & 0.48 & 0.49 & 0.18 & 0.98 & 0.98 & 0.31 & 0.57 & 0.38 & thresholding & 2.36 & 0.46 & 0.49 & 0.35 & 1.03 & 1.05 & 1.19 & 1.18 & 0.35 & 1.66 & 1.79 & 0.62 & 1.04 & 0.61 & densecrf 2d & 1.75 & 0.20 & 0.25 & 0.25 & 0.78 & 0.83 & 0.87 & 0.63 & 0.20 & 1.08 & 1.11 & 0.34 & 0.69 & 0.46 & thresholding & 2.58 & 0.53 & 1.30 & 0.43 & 1.32 & 1.31 & 1.44 & 1.41 & 0.47 & 1.80 & 1.98 & 0.73 & 1.28 & 0.63    2@>b0.15>b0.2|>b0.05>b0.05 > b0.05>b0.05 > b0.05>b0.05 > b0.05>b0.05 > b0.05>b0.05 >",
    "b0.05>b0.05|>b0.05>b0.05 * network * & & * 1 * & * 2 * & * 3 * & * 4 * & * 5 * & * 6 * & * 7 * & * 8 * & * 9 * & * 10 * & * 11 * & & * mean * & * sd * & densecrf 2d & 1.75 & 0.20 & 0.25 & 0.25 & 0.78 & 0.83 & 0.87 & 0.63 & 0.20 & 1.08 & 1.11 & 0.34 & 0.69 & 0.46 & densecrf 2d & 1.44 & 0.19 & 0.23 & 0.29 & * 0.67 * & 0.67 & 0.48 & 0.49 & * * 0.18 * * & 0.98 & 0.98 & 0.31 & 0.57 & 0.38 & densecrf 2d & * 1.17 * & 0.20 & 0.24 & 0.30 & 0.70 & * 0.65 * & * 0.39 * & 0.48 & 0.21 & 0.95 & * 0.90 * & 0.35 & 0.47 & * 0.33 * & densecrf 2d & 1.22 & * * 0.18 * * & * 0.21 * & * 0.25 * & 0.68 & 0.69 & 0.48 & * * 0.43 * * & * 0.18 * & * 0.94 * & 0.96 & * * 0.29 * * & * 0.46 * & 0.36    2@>p0.2|>b0.05>b0.05 > b0.05>b0.05 >",
    "b0.05>b0.05 > b0.05>b0.05 > b0.05>b0.05 >",
    "b0.05>b0.05|>b0.05>b0.05 * metric * & * 1 * & * 2 * & * 3 * & * 4 * & * 5 * & * 6 * & * 7 * & * 8 * & * 9 * & * 10 * & * 11 * & * 12 * & * mean * & * sd * & 0.92 & 0.93 & 0.92 & 0.89 & 0.95 & 0.96 & 0.94 & 0.95 & 0.91 & 0.94 & 0.89 & 0.94 & 0.93 & 0.02 & 0.55 & 0.76 & 0.74 & 0.64 & 0.45 & 0.50 & 0.69 & 0.68 & 0.73 & 0.58 & 0.54 & 0.70 & 0.54 & 0.19 & 0.28 & 0.56 & 0.62 & 0.48 & 0.11 & 0.13 & 0.27 & 0.27 & 0.55 & 0.29 & 0.38 & 0.36 & 0.31 & 0.18 & 47.05 & 33.38 & 82.76 & 24.72 & 35.37 & 62.51 & 26.87 & 29.46 & 23.45 & 59.92 & 73.12 & 27.66 & 37.59 & 22.35 * * avgdist * * & * 1.44 * & * 0.19 * & * 0.23 * & * 0.29 * & * 0.67 * & * 0.67 * & * 0.48 * & * 0.49 * & * 0.18 * & * 0.98 * & * 0.98 * & * 0.31 * & * 0.49 * & * 0.39 * & 0.28 & 0.06 & 0.07 & 0.15 & 0.18 & 0.13 & 0.16 & 0.03 & 0.08 & 0.03 & 0.17 & 0.08 & 0.10 & 0.07     +    the segmentation results are visualized for the best slice for each stack in , and for the worst slice for each stack in . for each stack",
    "there are four columns : 1 ) the first column shows the denoised input slice , 2 ) label that corresponds to the manually annotated vessels , 3 ) the real - valued znn output from the proposed architecture , 4 ) the mask that is a binary mask obtained with dense two - dimensional crf .",
    "it should be noted that the ground truth labels are not optimally defined , as can be seen for example in the worst case scenario of stack # 3 ( ) with high avd value , but visually the segmentation seems quite good .",
    "the high value of avd value simply comes from the difference between the suboptimal manual label and the `` real '' vasculature labels that could have been drawn better .    visualized segmentation results and the performance metrics for other vd2d3d variants are shown in the wiki of our github repository at https://github.com/petteriteikari/vesselnn/wiki .",
    "visualization of the behavior of the network training for vd2d ( ) and for vd2d3d ( ) show that for our datasets the training error ( accuracy ) and the test error ( if too high with low training error , the system is overfitting the training data ) converged well before the hard - coded limits taken from the study of lee _ et al . _",
    "@xcite for electron microscopy stacks .    * ]    ]",
    "our proposed networks based on the znn framework @xcite for vasculature segmentation from volumetric two - photon microscope stacks provided promising results of segmentation quality .",
    "there is still room for many improvements and optimizations to our proof - of - concept approach which are discussed in more detail below .",
    "[ [ sub : refinements - to - networks ] ] refinements to network + + + + + + + + + + + + + + + + + + + + + +    in this work , we chose to use the `` vanilla '' network architecture from lee _ et al .",
    "_ @xcite termed vd2d3d ( `` very deep 2d-3d '' ) with 2d layers in the initial layers , and 3d layers at higher abstraction layers to make the network faster to run and train .",
    "the vd2d3d employed commonly used components of convnets with mixed nonlinear activation functions of hyperbolic tangent ( @xmath0 ) and rectified linear units ( relu ) , and maximum filtering variant of max pooling that kept the resolution the same throughout the architecture without any need for upsampling as needed for some architectures ( e.g. ronneberger _ et al . _",
    "@xcite for biomedical image segmentation ) .",
    "the whole field of deep learning and convnets is rapidly advancing ( see for example a recent review by gu _",
    "@xcite ) . we can thus expect that with future optimization and testing , the `` vanilla '' network can be improved for our application and for volumetric biomedical segmentation in general .",
    "for example the convolutional layers used now can be regarded as a generalized linear model ( glm ) for the the underlying local image patch , and the nonlinear learning is introduced to the network via nonlinear activation function such as rectified linear units ( relu ) .",
    "it has been proposed that the convolutional filter itself could be made nonlinear with `` network in network '' ( nin ) model of lin _ et al .",
    "_ @xcite or with the inception module by szegedy _",
    "_ et al.__@xcite .",
    "these modifications enhance the abstraction ability of the local model compared to the current glm convolution model .",
    "very recently there has been interesting work of replacing convolutional filter with bilateral filter @xcite that is very commonly used edge - preserving smoothing filter @xcite .",
    "the convolutional filters were replaced both from earlier layers @xcite , as well as from later fully - connected layers @xcite offering faster runtime especially for higher - dimensional signals .",
    "@xcite replaced the inception modules with `` bilateral inception '' superpixels yielding better segmentation results than strictly pixel - wise implementations .",
    "bilateral inception allowed long - range edge - preserving inference directly removing the need for dense crf as post - processing step according to the authors @xcite .",
    "in contrast , jampani _",
    "@xcite trained the bilateral filter to be used within the dense crf inference , demonstrating better segmentation performance compared to traditional dense crf .",
    "in general , introducing bilateral filter or some other image - adaptive kernel at the convolutional layer level should allow better edge - preserving properties of the network that is very useful when we are interested in segmenting the vessel boundaries .",
    "there have been many attempts to improve the max - pooling @xcite of which the maximum filtering used here is a dense variant that retains original volume resolution .",
    "pooling in general is used to lower the computation burden by reducing connections between successive layers . from the recent efforts , especially spectral pooling",
    "seems like an interesting upgrade @xcite as it can be implemented with little computational cost for fast fourier transform ( fft ) based convolution networks such as the vd2d3d used here . in contrast to max - pooling",
    ", the information is reduced in frequency domain in linear low - pass filter fashion that will retain more information for the same output dimensionality .",
    "the use of spectral pooling provided the best classification performance on cifar ( 10 and 100 ) image classification dataset @xcite compared to other state - of - the - art methods such as stochastic pooling@xcite , maxout @xcite , `` network in network '' ( nin ) @xcite , and deeply - supervised nets @xcite .",
    "similarly , the traditional nonlinear activation functions such as sigmoid , @xmath0 _ _ , _ _ and relus could be improved .",
    "relus are probably the most commonly used activation function in convnets @xcite , with their main disadvantage being that it has zero gradient when the unit is not active .",
    "this in practice may cause that the units are not initially active never will become active during the gradient - based optimization ( stochastic gradient descent , sdg ) . to alleviate this problem , clevert _ et al .",
    "_ @xcite recently proposed exponential linear units ( elus ) which also employ negative values unlike relu , and according to the authors the use of elus lead not only to faster learning , but also give better generalization performance especially when the networks have at least 5 layers .",
    "on cifar-100 dataset , the elus yielded the best published result .",
    "the use of elus would be in theory complimentary to spectral pooling and they could also be used together with the nonlinear modifications of convolution layer ( e.g. nin and inception ) . it should be noted that at the moment there is no nonlinear activation function for frequency domain @xcite , thus there is a computational bottleneck with the inverse fft and fft transforms needed before and after the activation function .",
    "we employed dropout @xcite for regularization of our network by applying it before the output layer .",
    "recently , poole _",
    "@xcite showed that injecting gaussian noise instead of applying dropout led to improved performance , and rasmus _ et al .",
    "_ @xcite found no practical difference between dropout and gaussian noise injection .",
    "interestingly for dropout , gal and ghahramani @xcite ; and kingma _ et al . _ @xcite demonstrated how deep learning network with dropout can be cast as a bayesian model .",
    "this in practice allows the estimation uncertainty based on bayesian statistics @xcite .",
    "the estimate of uncertainty is currently lacking in most of the deep learning frameworks .",
    "the advantage of the dropout - based bayesian estimation is that one can turn existing dropout networks to include model uncertainty , rather than having to re - define the whole architecture .",
    "this dropout - based estimation was used by kendall _",
    "@xcite for semantic segmentation showing comparable performance to state - of the - art architectures by applying dropout in the central layers of their encoder - decoder architecture . in analysis pipelines where a quantitative analysis of morphological vessel behavior ( e.g. @xcite ) follows the image processing , it is useful to propagate the uncertainties involved in the image processing pipeline to the final statistical analysis",
    ".    the most obvious improvement for the used vd2d3d architecture here would be the conversion of all the convolutional layers to be three - dimensional . however , this is not computationally that feasible using current znn implementation with most commonly available hardware around .",
    "in the future with increased computational power , and speed optimization this should become feasible either by using intel xeon coprocessor @xcite , supercomputing clusters @xcite , or gpu - accelerated frameworks such as theano @xcite . in our current implementation",
    "we chose to do the dense crf in slice - by - slice manner due to the available implementation of it . in the future , we could upgrade the used dense crf to three dimension as done for example by kundu _",
    "_ @xcite .    in the architecture employed here ,",
    "multi - scale representation is not explicitly included .",
    "we have tried to provide stacks with different magnifications in our dataset to help the network learn different scales like done by lee _",
    "typically in semantic segmentation networks , multi - scale representation is implemented in two main ways @xcite , either by using so called _ skip - net _ that combine features from the intermediate layers of network @xcite , or via _ share - net _ that are fed input resized to different scales @xcite .",
    "the discussed bilateral filter modification would be able to encode scale invariance defined on continuous range of image scales without the typically used finite number of subsampled inputs simplifying the network architecture @xcite .",
    "in addition to concentrating on the individual components of the convnets , there have been alternative approaches to improve computational efficiency @xcite .",
    "our vessel segmentation network took over 20 days ( see [ sub : training - procedure ] ) to train on a typical multicore desktop computer , which emphasizes the utility of faster computation .",
    "batch normalization technique by ioffe _",
    "@xcite has received a lot of attention as the authors showed that the same classification accuracy can be obtained with 14 times fewer training steps while exceeding accuracy of human raters with an ensemble of batch - normalized networks . by normalizing for each training mini - batch",
    ", higher learning rates could be used with the training being less sensitive to initialization as well .",
    "another typically used speedup scheme is to use superpixels @xcite with two - dimensional images , or supervoxels @xcite with volumetric three - dimensional images to reduce the dimensionality of the input . within the superpixel / supervoxel pixels / voxels carry similarities in color , texture , intensity , etc .",
    ", generally aligning with region edges , and their shapes being generally circular / spherical rather than rectangular patches . the main downside of superpixels / supervoxels are that they introduce a quantization error @xcite whenever pixels / voxels within one segment have different ground truth label assignments ( i.e. in our case supervoxel would have both non - vessel and vessel labels ) .",
    "one of the main bottlenecks currently in deep learning networks , is the lack of efficient algorithms and libraries for sparse data , as majority of the libraries are optimized for dense data @xcite .",
    "the already discussed introduction of bilateral filters , and their computation using permutohedral lattices @xcite is a one way to speedup the computation of sparse data .",
    "in addition to permutohedral lattice , ghesu _ et al . _",
    "@xcite introduced a marginal space deep learning ( msdl ) framework for segmenting volumetric medical images by replacing the standard , pre - determined feature sampling pattern with a sparse , adaptive , self - learned pattern showing increased runtime efficiency .",
    "[ [ improved - annotationsubimproved - annotation ] ] improved annotation[sub : improved - annotation ] + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we manually annotated our ground truths using matlab - created seeds and gimp ( gnu image manipulation program ) .",
    "this was extremely time - consuming and required a person familiar with the two - photon microscopy vasculature images .",
    "recently mosinska _ et al .",
    "_ @xcite extended the active learning ( al ) approach ( @xcite ) for delineation of curvilinear structures including blood vessels .",
    "active learning is designed to reduce the effort of the manual annotator by selecting from non - annotated dataset , the image stacks for manual annotation that would the most beneficial for improving the performance of the network .",
    "surprisingly and counter - intuitively , recent work on electron microscope image segmentation @xcite found that the classifier performance of their implementation was better using only a subset of the training data instead of using the whole available training data .",
    "this phenomenon had been reported before by @xcite , suggesting that a well chosen subset of training data can produce better generalization than the complete set .    [ [ crowdsourcing ] ] crowdsourcing + + + + + + + + + + + + +    kim _ et al .",
    "_ demonstrate an interesting approach for acquiring annotations for electron microscopy datasets by developing a game called eyewire ( http://eyewire.org/ ) for non - experts where they can solve spatial puzzles made out from neuronal boundaries .",
    "this crowdsourcing have been traditionally used in tasks that does not require expert - level knowledge such as teaching autonomous cars to drive , but have been thought to be impractical for tasks that require expertise such as medical segmentation .",
    "the innovative approach used in their game is able to transform the biomedical `` expert '' annotation problem to the masses .    additionally to the `` gamification '' of segmentation efforts ,",
    "one could create a segmentation challenge of our dataset to popular machine learning sites such as kaggle ( https://www.kaggle.com/ ) and grand challenges in biomedical analysis ( http://grand-challenge.org/ ) to bring up the volumetric vascular segmentation in par with the rest of biomedical image analysis domains with existing datasets .",
    "another way to reduce the labor - intensive ground truth annotation required for our supervised approach , would be to initialize our supervised network using unsupervised pre - training from non - annotated dataset ( @xcite ) . in practice",
    ", we would feed the unsupervised learning network all our existing vascular image stacks without any annotation labels , and the network would learn the most representative features of that dataset that could be then fed into the first layer of our supervised network ( ` conv1a ` of ) .",
    "_ @xcite have suggested that this pre - training initialization serves as a kind of regularization mechanism that is retained even during the supervised part with the classification performance not deteriorating with the additional supervised training",
    ". we could for example use the dictionary learning approach with sparsity priors for 2d vessel images and 3d neuron dendrites proposed by @xcite as the pre - processing step , or alternatively use some stacked autoencoder variant used for medical image segmentation @xcite .",
    "more elegant alternative for unsupervised pre - training is to simultaneously apply both unsupervised and supervised learning , instead of having unsupervised pre - training and supervised training as separate steps @xcite .",
    "@xcite proposed a modified ladder network @xcite which demonstrate how by adding their unsupervised ladder network to existing supervised learning methods including convolutional networks improved significantly classification performance in handwriting classification ( mnist database @xcite ) , and in image classification ( cifar-10 database @xcite ) compared to previous state - of - the - art approaches .",
    "their approach excelled when the amount of labels were small , and especially when number of free parameters was large compared to the number of available samples , showing that the model was able to use the unsupervised learning part efficiently .",
    "particularly attractive detail of their publicly available approach , is that it can be added relatively easy on a network originally developed for supervised learning such as ours , allowing hopefully a better use of our limited annotated dataset .      in our work ,",
    "we have only focused on replacing the vessel enhancement step ( see ) with automated data - driven convnet assisted by various parametrized filters requiring some degree of user interaction .",
    "ideally we would like to all relevant steps starting from image restoration to post - processing of the volumetric convnet output , all the way to the mesh generation to be automated using training data to increase the robustness and minimize user interaction .",
    "work has already been done for each individual components that could be simply stacked together as separate units , or one could jointly train all components in end - to - end fashion . for example",
    "recent work by vemulapalli _",
    "@xcite showed that their deep learning network based on a gaussian conditional random field ( gcrf ) model outperformed existing methods in two - dimensional image denoising including the two - dimensional variant bm3d @xcite of the bm4d algorithm @xcite that we used to denoise our vessel stacks .",
    "for other image restoration task such as blind deconvolution @xcite for sharpening the stacks , blind inpainting @xcite for filling possibly broken vessels , vibration - artifacts , or other image quality artifacts , and motion - blur correction @xcite deep learning based solutions have been proposed with promising results .",
    "recent work by xu _",
    "_ @xcite demonstrate a deep convolutional networks designed to learn blindly the output of any deterministic filter or a combination of different filters .",
    "authors demonstrated this by learning two different edge - preserving smoothing filters bilateral filter ( @xcite ) , and @xmath3 gradient minimization smoothing ( @xcite ) jointly without needing to know anything about the implementations of such filters given that input and output images can be accessed .",
    "this edge - aware smoothing could be used as a refining step for our image denoising / deconvolution output to further suppress irrelevant structure for the vessel segmentation .",
    "alternatively , the same framework could be potentially to learn the behavior of commercial software as demonstrated by the authors with _ `` copycat filter scheme '' _ using photoshop^^ filters @xcite .",
    "one could generate training data for deconvolution for example using some commonly used software package such as imaris ( bitplane ag , zurich , switzerland ) or autoquant ( autoquant imaging / media cybernetics ) , and integrating that `` knowledge '' to the same deep learning framework without having to jump between different software packages during the analysis of microscopy stacks .",
    "lee _ et al . _",
    "@xcite argue that the recursive input from vd2d can be viewed as modulatory gate that the feature activations for structures of interest are enhanced while suppressing activations unrelated to structures of interest .",
    "based on that assumption , it would be interesting to try to replace the vd2d altogether for example with data - driven edge detection network such as the n^4 ^ -fields @xcite or holistically - nested edge detection @xcite .",
    "n^4 ^ -fields @xcite was shown to segment two - dimension retinal vasculature from the drive dataset @xcite better than the structured edge detector @xcite while the performance was not compared to traditional vessel enhancement filters .",
    "alternatively one could try to integrate recent vessel enhancement filters as structured layers @xcite within the convnet architecture to try to incorporate some domain knowledge without having to resort to totally hand - crafted features .",
    "recent vesselness filters of interest include the scale - invariant enhancement filter by moreno _",
    "@xcite , and the nearest neighbor - inspired detection of elongated structures by sironi _",
    "_ @xcite .",
    "the deep learning can be seen as a `` brute force '' method for vessel segmentation as it does not explicitly model the geometrical relationships that exist between neighboring `` vessel pixels '' as pointed out by sironi _",
    "the probability maps can have isolated erroneous responses , discontinuities and topological errors that are typically mitigated using post - processing techniques such as conditional random fields ( crf , @xcite ) , narrow - band level sets @xcite , learned graph - cut segmentation @xcite or auto - context @xcite among others .",
    "authors of the znn framework @xcite chose to refine their segmentation of electron microscope stacks using a watershed - based algorithm developed by themselves @xcite , whereas recent work by almasi _",
    "@xcite reconstructed microvascular networks from the output of active contours @xcite , and sironi _ et al .",
    "_ @xcite train an algorithm inspired by nearest neighbor fields @xcite to induce global consistency for the probability maps .",
    "both those recent works @xcite can be seen complimentary and refining post - processing steps to our approach .    at the moment we are only training individual stacks at the time , but it is common in biomedical microscopy to image the same stack over multiple time points .",
    "we could extend our model to exploit the temporal dependency among multiple time points , as it is done in 2d video processing where the time can be regarded as the third dimension .",
    "@xcite for example employ a recurrent neural network ( rnn ) for modeling temporal context in a video sequence for multi - frame super - resolution reconstruction .",
    "this potentially can improve the vessel segmentation as the vessels are not typically deformed heavily between successive stacks when using typical acquisition intervals .",
    "the time - extended super - resolution approach should in theory improve the quality of the interpolation in @xmath1- dimension when isotropic voxels are wanted , compared to deep learning based single - frame super - resolution @xcite , and traditional b - spline interpolation @xcite .    to the knowledge of the authors ,",
    "there has been no attempt to improve the mesh reconstruction step using deep learning framework .",
    "closest example to deep learning in surface reconstruction were demonstrated by xiong _",
    "@xcite , who used a dictionary learning for surface reconstruction from a point cloud , which outperformed state - of - the art methods in terms of accuracy , robustness to noise and outliers , and geometric feature preservation among other criteria .",
    "_ @xcite demonstrated how they could learn optimal bilateral filter parameters for three - dimensional mesh denoising that could be thus used as a post - processing step for surface reconstruction .",
    "this is an improvement of the bilateral filter mesh denoising algorithm implemented in computational geometry algorithms library ( cgal , http://www.cgal.org/ ) that requires user - set parameters .",
    "the simplified schematic of the components for joint optimization is shown in . in our proposed approach we have only focused on the segmentation part whereas in optimal case we would like to have training data of all the different phases of the image processing pipeline .",
    "the schematic does not show any more sophisticated layers that could be embedded inside of more generalistic convolutional networks .",
    "for example ionescu _",
    "_ @xcite demonstrated how to backpropagate global structured matrix computation such as normalized cuts or higher - order pooling .",
    "the training of normalized cuts within deep learning framework is similar to the approach taken bu turaga _ et al . _",
    "@xcite _ _ for optimizing a rand index with simple connected component labeling ( malis , which is to be implemented in the znn framework used by us ) .",
    "inclusion of such global layers was shown to increase the segmentation performance compared to more generalized deep networks .",
    "currently there are not many publicly available software for dense image segmentation for volumetric 3d data , so we were constrained in our choice between gpu - accelerated theano @xcite and the cpu - accelerated znn @xcite .",
    "we chose to use the znn framework for our vessel segmentation pipeline . _",
    "_ the caffe - derived deeplab @xcite with both cpu and gpu acceleration options was not supporting efficient 3d convnets as it were the case with caffe itself @xcite as benchmarked by jampani _",
    "@xcite for example .",
    "the cpu - accelerated znn was shown to have efficient computational performance compared to gpu - accelerated theano @xcite , and considering the recent price drop of intel xeon phi^tm^ knights corner generation of cpu accelerator cards , and introduction of supposedly more user - friendly knights landing generation , our choice of implementation seems relatively easy to accelerate in the future .",
    "recently published python library keras ( http://keras.io/ ) functions as a high level abstraction library for either theano and for tensorflow @xcite so that the researcher can focus on the ideas and change flexibly the underlying backend between theano and tensorflow as one wishes .",
    "our vessel segmentation pipeline essentially replaces the previously used handcrafted vesselness filters ( e.g. @xcite ) still requiring a refining segmentation algorithm for the znn output as the output is not a binary - valued mask , but rather a real - valued probability map .",
    "@xcite used connected component clustering ( ` bwlabeln ` of matlab , union - find algorithm , @xcite ) with morphological filters to refine the znn output for retinal ganglion cell ( rgc ) arbor , while the most recent paper with znn @xcite compared clustering to more sophisticated watershed - based segmentation @xcite for segmenting neuronal boundaries from em stacks .",
    "our work can be seen also as a pre - processing step for morphological reconstruction of vessel networks in mesh domain .",
    "the output from our pipeline could be for example used as an input for the mesh reconstruction pipeline of python - based open source vessel modeling toolkit ( vmtk , http://www.vmtk.org/ ) , and its inexpensive graphical front - end vmtklab ( http://vmtklab.orobix.com/ ) .",
    "this would be more robust segmentation pre - processing step compared to the ones provided by vmtk .",
    "vmtk provided the following four vesselness enhancing filters : 1 ) frangi s method @xcite , 2 ) sato s method @xcite , 3 ) vessel enhancing diffusion filter @xcite , and 4 ) vessel enhancing diffusion @xcite , with the frangi s method being the default option .",
    "vessel enhancing filter works as a pre - processing step in vmtk pipeline for the level set based vessel segmentation of vmtk before running the marching cubes algorithm derivative @xcite for mesh reconstruction .    for researchers who are the most comfortable using graphical tools such as imaris ( bitplane ag , zurich , switzerland ) , or open - source imagej / fiji platform @xcite ,",
    "the proposed approach can be seen as automatic pre - processing step improving the performance of the following manual processing steps .",
    "for example the two - class ( vessels , and non - vessels ) vessel segmentation in imaris by @xcite , required many user - supplied intensity thresholds which could have been automatized with our convnet - based approach , and the remaining steps for graph reconstruction could have done with existing pipeline .",
    "* _ _ *      in addition to optimizing our algorithm , image parameters should also be carefully chosen to facilitate vessel segmentation .",
    "we are interested in quantifying the degree of blood - brain barrier opening ( bbbo ) following focused ultrasound stimulation @xcite .",
    "experimentally , this is achieved by injecting a fluorescent dextran into the systemic vasculature , and then measuring the difference in fluorescence intensity between the vessels ( foreground ) and the surrounding tissue during bbbo @xcite .",
    "thus , by the nature of the experiment , we are making the task harder for the segmentation network as the edges between the vessels and the background will become progressively blurred .    one way to improve such a loss of contrast is to quantify the bbbo by using two vascular dyes simultaneously , one which readily leaks out from vessels upon bbbd , and another one with a high molecular weight that leaks out less .",
    "an alternative to using high - molecular weight dextrans is to use quantum dots that have narrower emission spectra for reduced dye crosstalk @xcite , and less leakage from vessels .",
    "quantum dots have already been used to study the tumor vasculature @xcite .",
    "another option is to use alexa fluor 633 dye , which selectively labels the walls of arteries that are greater than 15-@xmath4 m in diameter@xcite .",
    "this would make vessel segmentation easier as the leakage channel ( with the dextran ) and vessel channel ( with the labeled vessel walls ) can be analyzed separately .",
    "recently , multiphoton fluorescent dyes with longer emission and excitation wavelengths @xcite have been gaining popularity due to their better transmission through biological tissue yielding improved penetration depths and signal - to - noise ratios ( snrs ) @xcite .",
    "another promising , yet not commonly employed , technique is to increase excitation laser wavelengths up to 1,700 nm @xcite , and switch to three - photon excitation .",
    "this also improves depth penetration , but also allows better optical sectioning due to higher non - linearity due to the @xmath5 attenuation from the focal plane instead of @xmath6 attenuation in two - photon regime , where @xmath1 is the distance @xcite .",
    "this reduces noise from out - of - planes and tissue autofluorescence @xcite . in terms of our future versions of deep learning framework",
    ", we would like to simultaneously dyes for both two - photon and three - photon process so that the crosstalk in @xmath1-dimension would be minimized for three - photon process dye allowing that to be used as the ground truth for the super - resolution training ( see ) for two - photon process dyes . likewise",
    "the improved snr either with longer - wavelength dye and/or three - photon microscopy could be used as the ground truth for the denoising block for denoising shorter - wavelength fluorescent dyes .",
    "another way to improve snr is to correct the optical aberrations caused by brain tissue in real - time by using adaptive optics @xcite . the use of adaptive optics originated from astronomy @xcite , where the correction of aberrations caused by atmospheric was able to give better image quality to astronomers .",
    "_ @xcite demonstrated the increase in snr for _ in vivo _ calcium imaging was especially significant atgreater depths .",
    "the better image quality with adaptive optics could be used as the ground truth for the deconvolution block ( see ) and the stack without adaptive optics as the training data .",
    "ideally , one could combine all the above methods for optimized imaging quality .      in the proposed architecture here",
    ", we did not explicitly try to further refine the segmented vasculature to subclasses , but rather simply differentiated vessel and non - vessel voxels .",
    "there have been some work devoted to separating arteries from veins either using computational techniques @xcite , or using specific fluorescent labels that specifically label arteries such as alexa fluor 633 used by shen _ et al .",
    "_ @xcite . in the future",
    ", we would like extend our network to differentiate arteries from veins by acquiring training data using such an artery - specific dye concurrently with a fluorescent dextran that would label the entire vascular network .      in our `` vanilla network ''",
    "( see [ sub : refinements - to - networks ] ) we did not have any vasculature specific optimization , and we decided to leverage on the ability of deep learning network to learn the relevant features itself of relying on handcrafted features .",
    "thus , the same network proposed initially for electron microscope image segmentation @xcite can be extended to other applications as demonstrated here for volumetric two - photon vasculature image segmentation . to extend the framework for other application ,",
    "annotated training data is needed for training the network for the given task . to be used with vasculature datasets such as the vessel12 @xcite",
    ", it would be sufficient to use our pre - trained network and fine - tune the model , training with small learning rate , rather having to learn from scratch as typically done in specific image classification tasks exploiting some pre - trained network with broader dataset @xcite .",
    "this is known as transfer learning or domain adaptation depending on the marginal data distribution @xcite .    in practice with vascular segmentation ,",
    "transfer learning approach correspond to a situation when a network trained for tubular dataset such as diadem @xcite is used as a basis , and fine - tuning that network using limited samples of multiphoton microscopy data .",
    "domain adaptation would correspond to a situation where we would have trained our network to segment vasculature using some other imaging modality than multiphoton microscopy in which the vasculature ( foreground ) itself might have similar appearance to multiphoton microscopy , but the background from which we try to segment the vasculature would be different .",
    "@xcite combined convnet with a traditional dictionary - learning approach for domain adaptation that was able to exploit the local discriminative and structural information more efficiently than just using a convnet .",
    "this is of a relevance for us , as we could use the unsupervised dictionary - based learning approach for vessel stacks proposed by sironi _",
    "@xcite , and combine that to our convnet - based approach to exploit the large number of unlabeled vessel stacks . * *    in medical applications , there have been some effort of going around the high annotation cost by exploiting auxiliary data such as textual reports @xcite ( i.e. whether the whole stack / slice image contains a vessel or not ) . this type of learning is known as weakly - supervised segmentation , and can not understandingly reach the segmentation performance as full pixel - level `` strong '' annotated supervised learning .",
    "_ @xcite recently demonstrated that the gap between fully supervised and weakly - supervised can be reduced compared to previous approaches by exploiting pre - trained imagenet model for transfer learning with weak labels . in multiphoton microscopy",
    ", it is not typically possible to use whole - image labels as the vasculature is typically so dense that there are not a lot of empty slices with no vessel labels .. sometimes in practice , the dye loading is unsuccessful or there are technical glitches , and these empty acquired empty stacks could be used to characterize the noise characteristics of non - vessel areas .",
    "we share our annotated two - photon vasculature dataset to the scientific community to address the lack of standardized datasets for multiphoton microscopy .",
    "we believe that part of the reason for lack of published work on volumetric vessel segmentation is due to lack of suitable training data , most of the biomedical image segmentation efforts being directed to fields such as electron microscopy , and various clinical applications as the training data is readily available .",
    "we want to be part of creating a cultural shift from independent efforts of research groups toward an open source and collaborative neuroscience as datasets get larger and more complex @xcite , as well as ensuring that our framework can be easily reproduced and developed further @xcite . in the future",
    ", we would like to move away from proprietary matlab environment to totally open - source code in python as well .",
    "we have a proposed a deep learning based framework for two - class segmentation ( vessel , and non - vessel ) of vascular networks obtained via two - photon microscopy from mouse cortex and human squamous cell carcinoma tumors .",
    "_ _ we have made the matlab code available based on the open - source znn framework @xcite .",
    "in contrast to gpu - accelerated frameworks such as theano @xcite , the znn is optimized to run on cpu while reaching relatively similar performance compared gpu - accelerated approaches @xcite .",
    "we have already made our training set freely available to address the lack of annotated reference dataset for multiphoton microscopy vasculature segmentation .",
    "we are hoping that this will both inspire other research groups sharing their vasculature datasets , as well as improving our proposed framework .",
    "our future work will focus on enhancing the computational performance and accuracy of the network for multiphoton microscopy vessel segmentation ."
  ],
  "abstract_text": [
    "<S> recently there has been an increasing trend to use deep learning frameworks for both 2d consumer images and for 3d medical images . </S>",
    "<S> however , there has been little effort to use deep frameworks for volumetric vascular segmentation . </S>",
    "<S> we wanted to address this by providing a freely available dataset of 12 annotated two - photon vasculature microscopy stacks . </S>",
    "<S> we demonstrated the use of deep learning framework consisting both 2d and 3d convolutional filters ( convnet ) . </S>",
    "<S> our hybrid 2d-3d architecture produced promising segmentation result . </S>",
    "<S> we derived the architectures from lee _ et al . _ who used the znn framework initially designed for electron microscope image segmentation . </S>",
    "<S> we hope that by sharing our volumetric vasculature datasets , we will inspire other researchers to experiment with vasculature dataset and improve the used network architectures . </S>"
  ]
}