{
  "article_text": [
    "clusters of galaxies  the most massive virialized systems known  provide powerful tools in the study of cosmology : from tracing the large - scale structure of the universe ( @xcite , @xcite , @xcite , @xcite , @xcite and references therein ) to determining the amount of dark matter on mpc scales ( @xcite , @xcite , @xcite , @xcite , @xcite , @xcite ) to studying the evolution of cluster abundance and its cosmological implications ( @xcite , @xcite , @xcite , @xcite , @xcite , @xcite , @xcite ) .",
    "the above studies place some of the strongest constraints yet on cosmological parameters , including the mass - density parameter of the universe , the amplitude of mass fluctuations at a scale of 8  @xmath5 and the baryon fraction .",
    "the availability of complete and accurate cluster catalogs needed for such studies is limited .",
    "one of the most used catalogs , the abell catalog of rich clusters ( @xcite , and its southern counterpart @xcite ) , has been extremely useful over the past four decades .",
    "this catalog , which contains @xmath34000 rich clusters to @xmath6 over the entire high latitude sky , with estimated redshifts and richnesses for all clusters , was constructed by visual selection from the palomar sky survey plates , using well - defined selection criteria .",
    "the zwicky cluster catalog ( @xcite ) was similarly constructed by visual inspection .    the need for new , objective , and accurate large - area cluster catalogs to various depths is growing , following the important use of clusters in cosmology .",
    "large area sky surveys using ccd imaging in one or several colors , as well as redshift surveys , are currently planned or underway , including , among others , the sloan digital sky survey ( sdss ) .",
    "such surveys will provide the data needed for constructing accurate cluster catalogs that will be selected in an objective and automated manner . in order to identify clusters in the new galaxy surveys ,",
    "a robust and automated cluster selection algorithm is needed .",
    "we propose such a method here .",
    "cluster identification algorithms have typically been targeted at specific surveys , and new algorithms have been created as each survey is completed .",
    "@xcite was the first to develop a well - defined method for cluster selection , even though the identification was carried out by visual inspection ( see , e.g. , @xcite for a analysis of this method ) .",
    "other algorithms have been created for the apm survey ( @xcite , @xcite ; see @xcite for a variant of this method ) , the edinburgh - durham survey ( ed ; @xcite ) , and the palomar distant cluster survey ( pdcs ; @xcite ; see also @xcite for a variant of this method ; and @xcite for an application this method to finding dwarf spheroidals ) .",
    "all the above methods were designed for and applied to two - dimensional imaging surveys .    in this paper",
    "we present a well defined , quantitative method , based on a matched filter technique that expands on some of the previous methods and provides a general algorithm that can be used to identify clusters in any type of survey .",
    "it can be applied to 2d imaging surveys , 2@xmath0d surveys ( multi - band imaging with photometric redshift estimates of any accuracy ) , 3d redshift surveys , as well as combinations of the above ( i.e. some galaxies with photometric redshifts and some with spectral redshifts ) .",
    "in addition , this adaptive matched filter ( amf ) method can be applied to identify clusters in cosmological simulations .",
    "the amf identifies clusters by finding the peaks in a cluster likelihood map generated by convolving a galaxy survey ( 2d , 2@xmath0d or 3d ) with a filter which models the cluster and field galaxy distribution .",
    "the peaks in the likelihood map correspond to locations where the match between the survey and the filter is maximized .",
    "in addition , the location and value of each peak also gives the best fit redshift and richness for each cluster .",
    "the filter is composed of several sub - filters that select different components of the survey : a surface density profile acting on the position data , a luminosity profile acting on the apparent magnitudes , and , in the 2@xmath0d and 3d cases , a redshift cut acting on the estimated redshifts .",
    "the amf is adaptive in three ways .",
    "first , the amf adapts to the errors in the observed redshifts ( from no redshift information ( 2d ) , to approximate ( 2@xmath0d ) or measured redshifts ( 3d ) ) .",
    "second , the amf uses the location of the galaxies as a `` naturally '' adaptive grid to ensure sufficient spatial resolution at even the highest redshifts .",
    "third , the amf uses a two step approach that first applies a coarse filter to find the clusters and then a fine filter to provide more precise estimates of the redshift and richness of each cluster .",
    "we describe the theory of the amf in  2 and its implementation in  3 .",
    "we generate a synthetic galaxy catalog to test the amf in  4 and present the results in  5 .",
    "we summarize our conclusions in  6 .",
    "the idea behind the amf is the matching of the data with a filter based on a model of the distribution of galaxies .",
    "the model describes the distribution in surface density , apparent magnitude , and redshift of cluster and field galaxies . convolving the data with the filter",
    "produces a cluster probability map whose peaks correspond to the location of the clusters .",
    "here we describe the theory behind the amf .",
    "we present the underlying model in  2.1 , the concept of the cluster overdensity in  2.2 , two likelihood functions derived under different assumptions about the galaxy distribution in  2.3 , and the extension of the likelihood functions to include estimated redshifts in  2.4 .",
    "the foundation of the amf is the model of the total number density of galaxies per solid angle ( @xmath7 ) per apparent luminosity ( @xmath8 ) around a cluster at redshift @xmath9 with richness @xmath10 n_(,l;z_c ) ddl = [ n_f(l ) + n_c(,l;z_c ) ] ddl   , where @xmath11 is the angular distance from the center of the cluster , and @xmath12 and @xmath13 are the number densities due to the field and the cluster .",
    "the field number density is taken directly from the global `` number  magnitude '' per square degree relation .",
    "the cluster number density is the product of a projected density profile ( see appendix a ) and a luminosity profile , both shifted to the redshift of the cluster and transformed from physical radius and absolute luminosity to angular radius and apparent luminosity ( i.e. flux ) n_c(,l;z_c ) = _ c(r ) ( ) ^2 _ c(l ) ( ) where the projected radius @xmath14 and absolute luminosity @xmath15 at the cluster redshift are given by r(,z_c ) & = &   , + l(l , z_c , ) & = & 4 d^2(z_c , ) l   . here",
    "@xmath16 is the angular size distance corresponding to @xmath9 , and @xmath17 is the luminosity distance ( with k correction ) of a galaxy of spectral type @xmath18 ( e.g. elliptical , spiral or irregular ) ( see appendix b ) .",
    "the factor of @xmath19 in the radius relation converts from comoving to physical units ( the cluster profile can be defined with either comoving or physical units ) . for the cluster luminosity profile a schechter function is adopted _",
    "c(l ) dl ( l / l^*)^- e^-l / l^ * d(l / l^ * ) , where @xmath20 ( @xcite , @xcite , @xcite ) .    the model is completed by choosing a normalization for the radial profile @xmath21 and the luminosity profile @xmath22 .",
    "the choice of normalization is arbitrary , but has the effect of determining the units of the richness @xmath10 .",
    "we choose to normalize so that the total luminosity of the cluster is equal to l_c ( < r _ ) & = & l^ * + & = & l(l , z_c ) n_c(,l;z_c ) ddl + & = & _ 0^r _ _ c(r ) 2 r dr _",
    "0^_c(l ) l dl   .",
    "the richness parameter @xmath10 thus describes the total cluster luminosity ( in units of @xmath23 ) within @xmath24 . for @xmath25",
    ", the richness @xmath26 relates to abell s richness @xmath27 ( within 1.5 @xmath5 ) as @xmath28 .",
    "for example , abell richness class @xmath29 clusters ( @xmath30 ) correspond to @xmath31 ( @xcite ) . multiplying by @xmath15 in equation ( 5 ) allows @xmath22 to be integrated down to zero luminosity , thus insuring that the total luminosity is equal to @xmath32 regardless of the the apparent luminosity limit of the survey @xmath33 .",
    "the above constraint can be implemented by simply multiplying @xmath21 and @xmath22 by any appropriate constants ( e.g. , normalizing the first integral to one and setting the second integral equal to @xmath23 ) .",
    "clusters , by definition , are density enhancements above the field . to quantify this we introduce the cluster overdensity @xmath34 , which is the sum of the individual overdensities of the galaxies @xmath35 .",
    "@xmath36 and @xmath37 are defined subsequently .    for a given cluster location on the sky",
    "let @xmath38 and @xmath39 be the angular separation from the cluster center and the apparent luminosity of the @xmath40th galaxy , respectively . for a specific cluster redshift @xmath9 we only need consider galaxies inside the maximum selected cluster radius ( appendix a ) _ ( z_c ) =  .",
    "the apparent local overdensity at the location of the @xmath40th galaxy is given by @xmath41 , where _ i = =   .",
    "the apparent overdensity of the cluster as measured from the data is _ = _ i _ i   , where the sum is carried out over all galaxies within @xmath42 . the cluster overdensity can also be calculated from the model _",
    "= ^_l _ ^__0 ( , l;z_c ) n_c(,l;z_c ) ddl   . equating @xmath43 with @xmath44",
    "it is possible to solve for @xmath10 =   .",
    "the term in the denominator is simply the model cluster overdensity when @xmath45 .",
    "as we shall see in the subsequent sections , the positions of clusters , both in angle and in redshift , correspond to the locations of maxima in the cluster overdensity .",
    "having defined the model we now discuss how to find clusters in a galaxy catalog and determine the best fit redshift and richness @xmath9 and @xmath10 for each cluster .",
    "the basic scheme is to define a function @xmath46 , which is the likelihood that a cluster exists , and to find the parameters that maximize @xmath46 at a given position over the range of possible values of @xmath9 and @xmath10 .",
    "this procedure is carried out over the entire survey area and generates a likelihood map .",
    "the clusters are found by locating the peaks in the likelihood map .",
    "the map grid can be chosen by various means , such as a uniform grid or by using the galaxy positions themselves .",
    "a variety of likelihood functions can be derived , depending on the assumptions that are made about the distribution of the galaxies .",
    "the amf uses two likelihood functions whose derivations are given in appendix c. a cluster is identified , and its redshift and richness , @xmath9 and @xmath10 , are found by maximizing @xmath46 .",
    "typically this is accomplished by first taking the derivative of @xmath46 with respect to @xmath10 and setting the result equal to zero = 0   .",
    "one can compute @xmath10 from the above equation either directly or numerically .",
    "the resulting value of @xmath10 can be inserted back into the expression for @xmath46 to obtain a value for @xmath46 at the specified redshift . repeating this procedure for different values of @xmath9",
    "it is possible to find the maximum likelihood and the associated best value of the cluster redshift , as well as the best cluster richness at this redshift .",
    "the first likelihood , which we call the coarse likelihood , assumes that if we bin the galaxy catalog , then there will be enough galaxies in each bin that the distribution can be approximated as a gaussian .",
    "this assumption , while not accurate , provides a coarse likelihood function @xmath47 which is linear , easy to compute and corresponds to the apparent overdensity _ = _ _",
    "i _ i  , where _ = ( see appendix c ) .",
    "the second likelihood , which we call the fine likelihood , assumes that the galaxy count in a bin can be modeled with a poisson distribution ",
    "an assumption which is nearly always correct .",
    "the resulting likelihood function @xmath48 is non - linear and requires more computations to evaluate , but should provide a more accurate estimate of the cluster redshift and richness .",
    "the formula for @xmath48 is _ = - _",
    "n_c + _ i   , where @xmath49 is computed by solving n_c = _ i   , and @xmath50 is the number of galaxies one would expect to see in a cluster with @xmath45 ( see appendix c ) .",
    "so far we have considered cluster selection in purely 2d imaging surveys with no estimated redshift information . the inclusion of estimated galaxy redshifts , as in 2@xmath0d or 3d surveys , should improve the accuracy of the resulting cluster redshifts .",
    "in addition , estimated redshifts can separate background galaxies ( noise ) from cluster galaxies ( signal ) more easily , allowing the detection of considerably poorer clusters than if estimated redshifts were not used .",
    "galaxy redshift information can be obtained , for example , from multi - color photometric surveys ( via photometric redshifts estimates ) or from direct spectroscopic determination of galaxy redshifts .",
    "we now discuss how to extend the amf described above to include such redshifts .",
    "the galaxy redshifts that we use _ within a given survey _ can range from very precise measured redshifts , to only approximate photometric redshifts ( with varied accuracy ) , to no redshift information  all in the same analysis ( i.e. adapting to different redshift information for each galaxy in the survey ) .",
    "the available redshifts provide essentially a third filter , in addition to the spatial and luminosity filters used in the 2d case . in practice , we use the estimated redshift information of each galaxy to narrow the window of the amf search following the same basic method described above .",
    "one of the benefits of laying down the theoretical framework for the amf is the easy means by which estimated redshifts can now be included .",
    "let @xmath51 and @xmath52 be the estimated redshift and redshift error of the @xmath40th galaxy , and let the factor @xmath53 determine how wide a region we select around each @xmath9 for the likelihood analysis .",
    "inclusion of the additional redshift information is accomplished by simply limiting the sums in @xmath47 and @xmath48 to those galaxies that also satisfy @xmath54 .",
    "note that this procedure allows the usage of redshift information with variable accuracy in the same survey  i.e .",
    ", some galaxies with measured redshifts , some with estimated redshifts and some with no redshifts at all .    the richness @xmath55 is dominated by the cluster galaxies ; as long as @xmath53 is sufficiently large ( e.g. @xmath56 ) then the resulting richnesses will be unbiased .",
    "however , if the redshift errors are large ( i.e. , a large fraction of the depth of the galaxy catalog ) , it may be desirable to use a smaller value of @xmath57 . in this case",
    "a small correction needs to be applied to the richness to account for the small fraction of cluster galaxies that are eliminated by the redshift cut .",
    "if the redshift errors are gaussian , the desired correction can be obtained by multiplying the predicted cluster overdensity by the standard error function ^w_0 e^- t^2 dt   .",
    "a similar issue arises with @xmath58 when the field galaxies are eliminated by using estimated redshifts . to obtain the correct value of @xmath58 requires modeling the contribution of the eliminated field galaxies to equation ( 15 ) , which can be done either analytically or numerically via monte carlo methods .",
    "the likelihood functions derived in the previous section represent the core of the amf cluster detection scheme .",
    "both likelihood functions begin with picking a grid of locations over the survey area for which @xmath46 and @xmath10 are computed over a range of redshifts .",
    "figures  [ fig : likelihood : a ] and  [ fig : likelihood : b ] show the functions @xmath59 and @xmath60 for a position on the sky located at the center of a @xmath61 cluster ( @xmath62 the richness or luminosity of coma ) at @xmath63 ( the details of the test data are given in the next section ) .",
    "figure  [ fig : likelihood : a ] shows the results when no redshift estimate exists ( i.e. , @xmath64 ) , and figure  [ fig : likelihood : b ] shows what happens when using estimated redshifts with @xmath65 .",
    "figures  [ fig : likelihood : a ] and  [ fig : likelihood : b ] illustrate three of the basic properties of these likelihood functions , which were discussed in the previous section : 1 .",
    "the dramatic effect of including estimated redshifts on sharpening the peak in @xmath46 , which makes finding clusters much easier ; 2 . the qualitative difference in the form of @xmath66 and @xmath67 in figure  [ fig : likelihood : b ] that arises from the fact that @xmath68 is a simple function of @xmath47 while @xmath49 is a complicated function of @xmath48 ; 3 .",
    "the shortward bias in the cluster redshift as computed from @xmath47 in 2d ( figure  [ fig : likelihood : a ] ) , which is a general bias in the 2d coarse likelihood function ( for a discussion of how to correct for this bias see @xcite ) . in the 3d case",
    ", the coarse likelihood of rich clusters has comparable accuracy to the fine likelihood . for poorer clusters ( @xmath69 ) , the coarse likelihood yields higher richness estimates than the true values ;",
    "this is a result of the gaussian assumption used for deriving the coarse likelihood which worsens for poorer clusters .",
    "implementation of the amf cluster selection consists of five steps : ( 1 ) reading the galaxy catalog , ( 2 ) defining and verifying the model , ( 3 ) computing @xmath47 over the entire galaxy survey over a range of redshifts , ( 4 ) finding clusters by identifying peaks in the @xmath47 map , and ( 5 ) evaluating @xmath48 and obtaining a more precise determination of each cluster s redshift and richness .",
    "the first step of the amf is reading the galaxy catalog over a specified region of the sky .",
    "the galaxy catalog consists of four to six quantities for each galaxy , @xmath40 : the position on the sky ra@xmath70 and dec@xmath70 , the apparent luminosity ( i.e. flux ) in specific band @xmath39 , the hubble type used for determining the k correction @xmath71 ( e.g. , e , sa or sc ) , the estimated redshift @xmath51 and estimated error @xmath52 . in the case of a single band survey , where no photometric redshifts are possible , @xmath51 and @xmath52 will not exist .",
    "in addition to these local quantities , the following global quantities are computed from the catalog : the apparent luminosity limit @xmath33 , the mean estimated error @xmath72 . finally , it is necessary to set the minimum and maximum cluster redshifts for the cluster search @xmath73 and @xmath74 .",
    "the primary model components which need to be specified are : the cluster radial profile @xmath75 , the cluster luminosity profile @xmath76 , a normalization convention for the cluster that sets the units of richness @xmath10 , and the field number density versus apparent luminosity distribution @xmath77 .",
    "in addition , a specific cosmological model needs to be chosen along with k corrections for each hubble type , from which the angular distance @xmath78 and luminosity distance @xmath79 can be computed .",
    "the observed galaxy catalog needs to be tested for its consistency with the model parameters ( such as @xmath77 ) . while this is unnecessary for the simulated galaxy catalog used below ( where the model used to find clusters",
    "is the same as the one used to generate the catalog ) , we show some of the consistency checks for illustration purposes ( see appendix d ) .      mapping out the coarse likelihood function begins with picking a grid covering the survey area .",
    "the most straightforward choice is a uniform grid over the area covered , which is conceptually simple and makes finding peaks in the likelihood easy .",
    "however , a uniform grid needs to be exceedingly fine in order to ensure adequate resolution at the highest redshifts , and leads to unacceptable computer memory requirements .",
    "another choice for the grid locations is to use the positions of the galaxies themselves .",
    "the galaxy positions are a `` naturally '' adaptive grid that guarantees sufficient resolution at any redshift while also eliminating unnecessary points in sparse regions .",
    "for this reason we choose to use the galaxy positions as the grid locations .    at each grid location",
    "( i.e. each galaxy position ) @xmath47 is evaluated over a range of redshifts from @xmath73 to @xmath74 .",
    "the number of redshift points is set so there is adequate coverage for the given value of @xmath72 .",
    "finding the maximum of the likelihood sets the values of the likelihood , redshift and richness at this point : @xmath80 , @xmath81 , and @xmath82 .",
    "when this process has been completed for all the galaxies , the result is an irregularly gridded map @xmath83 . the peaks in this map correspond to the locations of the clusters .",
    "finding peaks in 3d regularly gridded data is straightforward .",
    "finding the peaks in the irregularly gridded function @xmath83 is more difficult .",
    "there are several possible approaches .",
    "we present a simple method which is sufficient for selecting rich clusters .",
    "more sophisticated methods will be necessary in order to find poor clusters that are close to rich clusters .    as a first step we eliminate all low likelihood points @xmath84 , where @xmath85 is the nominal detection limit , which is independent of richness or redshift .",
    "@xmath85 can be estimated from the distribution of the @xmath80 values ( figure  [ fig : outputclusters : h ] ) .",
    "the peak in the distribution corresponds to the background while the long tail corresponds to the clusters . assuming the background is a gaussian whose mean can be estimated from the location of the peak and whose standard deviation is 0.43 times the full - width - half - maximum ( fwhm )",
    ", then a given value of @xmath85 will lie @xmath86 standard deviations from the peak n_~   .",
    "the values of @xmath85 shown in figure  [ fig : outputclusters : h ] were chosen so that @xmath87 , which was sufficiently high that no false detections occurred . to first order , @xmath88 , where @xmath89 is the average depth of the survey and is a function of @xmath33 .",
    "step two consists of finding the largest value of @xmath80 , which is by definition the first and most overdense cluster .",
    "the third step is to eliminate all points that are within a certain radius and redshift of the cluster .",
    "repeating steps two and three until there are no points left results in a complete cluster identification ( above @xmath85 ) , with a position , redshift and richness ( @xmath90 total luminosity ) estimate for each cluster .",
    "the angular position , redshift and richness of the clusters determined by the @xmath47 selection are adequate , but can be complemented by determining the redshift and richness from @xmath48 .",
    "recall that @xmath48 requires 10 to 100 times as many operations to evaluate as compared with @xmath47 , and applying it to every single galaxy position can be prohibitive . evaluating @xmath48 on just the clusters found with @xmath47 is trivial and worth doing as it should provide more accurate estimates of the cluster redshift and richness because of the better underlying assumptions that went into its derivation .",
    "thus , the final step in our amf implementation is to compute @xmath91 and @xmath92 using @xmath48 on each of the cluster positions obtained with @xmath47 .",
    "we summarize the above implementation in the following step - by - step list .",
    "read galaxy catalog    read in ra@xmath70 , dec@xmath70 , @xmath39 , @xmath51 , @xmath52 and @xmath71 for each galaxy .",
    "pick @xmath33 ( survey limit ) , @xmath73 and @xmath74 ( cluster search limits ) , and compute average distance error @xmath72 .",
    "model definition    choose @xmath21 , @xmath22 , @xmath12 , @xmath93 and @xmath79 .",
    "normalize @xmath21 and @xmath22 .",
    "verify galaxy distributions in @xmath94 and @xmath95 with those predicted by model .",
    "@xmath47 mapping    for each galaxy location ( ra@xmath70 , dec@xmath70 ) choose a range of redshifts within @xmath73 and @xmath74 with a step size no larger that one half @xmath72 .",
    "compute @xmath47 ( eq .",
    "12 ) and @xmath68 ( eq .",
    "13 ) for each redshift .",
    "set @xmath80 , @xmath82 and @xmath81 equal to the values at the maximum of @xmath47 .",
    "find peaks in the @xmath47 map    compute @xmath85 from the @xmath80 distribution ( e.g. 5-@xmath96 cut ) .",
    "find all local maxima in @xmath83 where @xmath97 ; these are the clusters .",
    "refine cluster redshift and richness estimates with @xmath48    at the ra and dec of each cluster found with @xmath47 evaluate @xmath48 over the same range of redshifts within @xmath73 and @xmath74 .",
    "compute @xmath48 ( eq .",
    "14 ) and @xmath49 ( eq .",
    "15 ) for each redshift .",
    "set @xmath98 , @xmath92 and @xmath91 equal to the values at the maximum of @xmath48 .",
    "these provide the best estimates for the cluster richness and redshift .    in the next section",
    "we describe a simulated galaxy catalog used to test the above amf implementation .",
    "our test data consists of 72 simulated clusters with different richnesses and redshifts placed in a simulated field of randomly distributed galaxies ( for a non - random distribution of field galaxies see section 5 ) .",
    "the clusters range from groups to rich clusters with total luminosities from 10 @xmath23 to 300 @xmath23 ( corresponding to abell richness counts of approximately 7 to 200 , or richness classes @xmath990 to @xmath34 ) and are distributed in redshift from 0.1 to 0.5 .",
    "the luminosity profile is a schechter function with @xmath100 .",
    "the radial profile is a plummer law given in appendix a with @xmath25 and @xmath101 .",
    "the number and absolute luminosity of the field galaxies were generated from a schechter function , using the field normalization @xmath102 ( @xcite ) .",
    "three different hubble types were used , e , sa and sc , with k corrections taken from @xcite . each galaxy in a cluster was randomly assigned a hubble type so that 60% were e , 30% were sa , and 10% were sc ; each galaxy in the field is randomly assigned a hubble type so that 40% were e , 30% were sa , and 30% were sc .",
    "knowing the redshift of each galaxy , its absolute luminosity and hubble type , we can compute the apparent luminosity . all galaxies with apparent luminosity below @xmath1 ( the anticipated limit of the sdss )",
    "were eliminated .",
    "this limit resulted in a field number density of @xmath35000 galaxies per square degree .    to facilitate the subsequent analysis and interpretation of the results ,",
    "the clusters were placed on an 8 by 9 grid .",
    "the cluster centers were separated by 0.4 degrees , which results in the test data having dimensions of 3.2 by 3.6 degrees .",
    "the distribution of the cluster galaxies in ra and dec is shown in figure  [ fig : inputclusters : a ] , where each column has the same richness while each row of clusters is at the same redshift ( see figure  [ fig : inputclusters : c ] ) . from left to right the richnesses are @xmath103 10 , 20 , 30 , 40 , 50 , 100 , 200 , and 300 . from bottom",
    "to top the redshifts are @xmath104 0.1 , 0.15 , 0.2 , 0.25 , 0.3 , 0.35 , 0.4 , 0.45 , and 0.5 . in all , the clusters contained some 30,000 galaxies , over half of which lie in the richness 200 and 300 clusters .",
    "the randomly generated field contained approximately 50,000 galaxies .",
    "the distribution of all the galaxies in ra and dec is shown in figure  [ fig : inputclusters : b ] .",
    "so far , the redshifts for the galaxies are exact . if we assume that redshift errors are gaussian , then we can easily generate offsets to the true positions if we know the standard deviation of the distribution @xmath105 .",
    "not all the galaxies will have the same estimated redshift error @xmath52 , and , in the case of photometric redshifts , these values can be expected to vary by about a factor of two ( @xcite ; @xcite ) .",
    "we model this effect by first randomly generating the estimated redshift errors from a uniform distribution over a specified range ( e.g. , @xmath106 ) .",
    "the offsets from the true redshifts are then randomly generated from gaussian distributions with standard deviations corresponding to @xmath52 values .",
    "the estimated redshifts are computed by adding the offsets to the true redshift .",
    "thus , a dataset with @xmath107 refers to @xmath106 .",
    "to test our amf implementation we ran it on the above simulated galaxy catalog for three different error regimes : @xmath108 , @xmath109 and @xmath110 . a contour plot computed from the maximum likelihood points @xmath80",
    "is shown in figure  [ fig : outputclusters : i ] , which indicates that the coarse filter does a good job of finding the angular positions of the clusters with no false detections .",
    "the resulting cluster centers have an accuracy that is within one core radius of the true cluster center .",
    "the redshifts and richnesses obtained by applying @xmath48 to the clusters found with @xmath47 are shown in figures  [ fig : outputclusters : b ] , [ fig : outputclusters : c ] , and [ fig : outputclusters : d ] .",
    "the boxes denote the true redshift and richness values of the input clusters .",
    "the short lines connect the inputs with the outputs ( i.e. the values obtained with @xmath48 ) .",
    "smaller lines indicate more accurate redshift and richness determinations .",
    "the long curve indicates the expected detection limit for the value of @xmath85 used . as expected , the number of clusters detected and their accuracy decrease as @xmath72 increases .",
    "however , nearly all the clusters with @xmath111 ( corresponding roughly to abell richness class @xmath112 ) are detected out to redshifts of 0.5 which is the effective limit of the survey . in a deeper survey",
    "it will be possible to detect clusters at higher redshifts .",
    "the errors in the redshift and richness estimates of all detected clusters is presented in figures  [ fig : outputclusters : f ] and [ fig : outputclusters : g ] .",
    "a summary of these results is shown in table  1 .",
    "in general , the amf finds clusters with an accuracy of @xmath113 in redshift and @xmath310% in richness . including distance information lowers the background and results in a substantial improvement in the detection of poorer clusters .",
    "thus , many more clusters are detected when @xmath114 as compared to @xmath115 .",
    "these additional clusters are all poorer and thus have higher errors , which explains why the average errors do not significantly change with @xmath72 .",
    "table 1 : summary of amf tests on simulated data +   +    [ cols=\"^,^,^,^,^,^ \" , ]     the cpu and memory requirements of the amf are dominated by the @xmath47 evaluation .",
    "the amf required around 100 mbytes of memory and took from a few minutes ( @xmath108 ) to a little under two hours ( @xmath110 ) using one cpu ( 198mhz mips r10000 ) of an sgi origin200 .",
    "for example , the sdss will be composed of approximately 1000 fields similar in size to our test catalog . since finding clusters in one field",
    "is independent of all the others , it is simple to run the amf on a massively parallel computer ; it will be possible to run the amf on the entire sdss catalog in one day .",
    "we have presented the adaptive matched filter method for the automatic selection of clusters of galaxies in a wide variety of galaxy catalogs .",
    "the amf can find clusters in most types of galaxy surveys : from two - dimensional ( 2d ) imaging surveys , to multi - band imaging surveys with photometric redshifts of any accuracy ( 2@xmath0d ) , to three - dimensional ( 3d ) redshift surveys .",
    "the method can also be utilized in the selection of clusters in cosmological n - body simulations .",
    "the amf is based on matching the galaxy catalog with a cluster filter that models the overall galaxy distribution .",
    "the model describes the surface density , apparent magnitude , and redshift of cluster and field galaxies . convolving the data with the filter",
    "produces a cluster probability map whose peaks correspond to the location of the clusters .",
    "the probability peaks also yield the best fit redshift and richness of each cluster .",
    "the heart of the amf is the apparent overdensity @xmath37 which is evaluated at each galaxy position and has a higher value for galaxies in clusters than galaxies in the field .",
    "the apparent overdensity distills the entire description of the galaxy catalog into a single function .",
    "two likelihood functions are derived , @xmath47 and @xmath48 , using different underlying model assumptions .",
    "the theoretical framework of the amf allows estimated redshifts to be included via a simple redshift filter , which effectively limits the sums in @xmath47 and @xmath48 to those galaxies within a window around @xmath9 .",
    "the maxima in the likelihood functions are used to identify cluster positions as well as their redshifts and richnesses .",
    "the amf is adaptive in three ways .",
    "first , it adapts to the errors in the estimated redshifts .",
    "second , it uses the locations of the galaxies as `` naturally '' adaptive grid to ensure sufficient resolution at even the highest redshifts .",
    "third , it uses a two step approach that applies a coarse filter to initially find the clusters and a fine filter to more precisely estimate the redshift and richness of each cluster .",
    "we tested the amf on a set of simulated clusters with different richnesses and redshifts  ranging from groups to rich clusters at redshifts 0.1 to 0.5 ; the clusters were placed in a simulated field of randomly distributed galaxies as well as in a non - random distribution produced by n - body cosmological simulations .",
    "we find that the amf detects clusters with an accuracy of @xmath1160.02 in redshift and @xmath310% in richness to @xmath4 ( for a simulated galaxy survey to @xmath1 ) .",
    "in addition , robustness tests provide a strong indication that the amf will perform well on observational data sets .",
    "detecting clusters at even higher redshifts will be possible in deeper surveys .",
    "we wish to thank guohong xu for providing the n - body simulations used in this paper .",
    "in addition david weinberg , andy connolly , marc postman , lori lubin , and chris finger provided helpful suggestions .",
    "we would also like to thank dr .",
    "micheal kurtz for his helpful comments .",
    "this work was supported in part by the doe computational science fellowship program , the princeton observatory advisory council , and nsf grants ast  93 - 15368 and ger  93 - 54937 .",
    "the projected cluster profile is derived from spherical modified plummer law profile : _",
    "c(r ) = \\ {    c@,c - & r r _ + 0 & r > r _    . where @xmath117 and the constant @xmath118 is used to normalize the profile .",
    "the projected profile is computed by integrating along the line of sight : _",
    "c(r ) = 2 _ r^ , which for the modified plummer profile gives _",
    "c(r ) = \\ {    c@,c - & r r _ + 0 & r > r _    . where @xmath119 is a constants set by the normalization .",
    "the transformation between absolute and apparent luminosities in band @xmath120 l__0 = 4 d^2(z ; ) l__0 , where @xmath18 is the galaxy type ( e.g. elliptical , spiral , irregular , ... ) and @xmath17 is the luminosity distance at a redshift @xmath95 and is related to the angular size distance @xmath121 by d^2(z ; ) =   , where @xmath122 and @xmath123 are the``k '' and evolutionary corrections . for no evolution models @xmath124 .",
    "the angular - size distance for @xmath125 cosmologies is given by d(z ) = _ 0^z",
    "various likelihood functions can be derived .",
    "the differences are due to the additional assumptions that are made about the distribution of the observations .",
    "this appendix gives the mathematical derivation of the two likelihood functions used in the amf : @xmath47 and @xmath48 .",
    "both derivations are conceptually based on virtually binning the data , but make different assumptions about the distribution of galaxies in the virtual bins .",
    "imagine dividing up the angular and apparent luminosity domain around a cluster into bins .",
    "we assign to each bin a unique index @xmath126 .",
    "the expected number of galaxies in bin @xmath126 is denoted @xmath127 . the number of galaxies actually found in bin @xmath126 is @xmath128 . in general ,",
    "the probability of finding @xmath128 galaxies in cell @xmath126 is given by a poisson distribution p_j = the likelihood of the data given the model is computed from the sum of the logs of the individual probabilities = _ j p_j .",
    "if the virtual bins are made big enough that there are many galaxies in each bin , then the probability distribution can be approximated by a gaussian p_j = \\ { - }   .",
    "furthermore , if the field contribution is approximately uniform and large enough to dominate the noise then p_j = \\ { - }   . where @xmath129 .",
    "summing the logs of these probabilities results in the following expression for the coarse likelihood _ & = & _ j p_j + & = & - _ j 2 n_f^j - _ j the first term does not affect the value of @xmath10 which minimizes @xmath47 and can be dropped .",
    "in addition , if the bins can also be made sufficiently small , then the sum over all the bins can be replaced by an integral _ = - ddl   , where @xmath130 is a sum of dirac delta functions corresponding to the locations of the galaxies .",
    "expanding the squared term and replacing @xmath131 with @xmath132 yields _ = - ddl   .",
    "the above expression can be simplified by setting @xmath133 , dropping all expressions that are independent of @xmath10 , and noting that @xmath134 is small compared to the other terms , which leaves _",
    "= 2 _ i _ i - ^2 ( , l ) n_c(,l ) ddl taking the derivative of @xmath47 with respect to @xmath10 and setting the result equal to zero , we can solve for @xmath55 directly _ = . where the denominator terms of @xmath22 , @xmath21 and @xmath12 is ( , l )",
    "n_c(,l ) ddl & = & ddl + & = &   . finally , inserting the above value of @xmath55 back into the expression for @xmath47 results in _",
    "= _ i _ i  , which is @xmath43 .",
    "thus , maximizing the measured cluster overdensity will give the correct richness and location of the cluster .",
    "if the virtual bins are chosen to be sufficiently small that no bin contains more that one galaxy , then the calculation of @xmath46 can be significantly simplified because there are only two probabilities that need to be computed .",
    "the probability of the empty bins p_= e^-n_^j and the probability of the filled bins p_= n_^j e^-n_^j .",
    "the sum of the log of the probabilities is then _ &",
    "= & _ p _ + _ p _ + & = & - _ n_^j - _ n_^j + _ n_^j [ eq : finesum ]    by definition summing over all the empty bins and all the filled bins is the same as summing over all the bins .",
    "thus , the first two terms in equation ( [ eq : finesum ] ) are just the total number of galaxies predicted by the model _ all  bins n_^j & = & ^_l _ ^__0 n_(,l;z_c ) d dl + & = & n_f + n_c where @xmath135 is the apparent luminosity limit of the survey . @xmath136 and",
    "@xmath137 are the total number of field and cluster galaxies one expects to see inside @xmath42 ; they can be computed by integrating @xmath12 and @xmath138 n_f(z_c ) & = & _ ^2(z_c ) ^_l _",
    "n_f(l ) dl   , + n_c(z_c ) & = & ^_l _",
    "^__0 n_c(,l;z_c ) d dl + & = & _ c(l(l_,z_c ) ) ^r__0 _ c(r ) 2 r dr where @xmath139 .",
    "because we retain complete freedom to locate the bins wherever we like , we can center all the filled bins on the galaxies , in which case the third term in equation ( [ eq : finesum ] ) becomes _ n_^j _ i   , and the sum is now carried out over all the galaxies instead of all the filled bins .",
    "combining these results we can now write the likelihood in terms that are readily computable from the model and the galaxy catalog _ = - n_f - n_c + _ i   .    the simplest way to find",
    "the richness is to take the derivative of the above equation with respect to @xmath10 and setting it equal to zero yields n_c = _",
    "i   , where we have substituted @xmath37 for @xmath140 .",
    "unfortunately , it is not possible to solve for @xmath58 explicitly , but a numerical solution can be found by standard methods .",
    "the resulting value of @xmath58 is then inserted into the following equation for @xmath48 to obtain the maximized value of the likelihood _ = - _ n_c + _ i   .",
    "finally , it is worth mentioning again that while @xmath68 can be obtained directly from @xmath47 , @xmath49 can only be found by numerically finding the zero point of equation ( c19 ) .",
    "furthermore , equation ( c19 ) does not lend itself to standard derivative based solvers ( e.g. , newton - raphson ) that produce accurate solutions in only a few iterations .",
    "fortunately , the solution can usually be bracketed in the range @xmath141 , thus obtaining a solution with an accuracy @xmath142 takes @xmath143 iterations using a bisection method .",
    "the first consistency check can be made with @xmath77 , or its cumulative probability @xmath144 , which can be fit directly to the galaxy catalog . in the case",
    "where a simulated catalog is used the luminosity distribution is taken from the underlying field luminosity function @xmath145 and it is possible to compute @xmath146 for each hubble type directly n_f(l ) = _ 0^_f ( l(l , z , ) ) d(z)^2 dz   , where @xmath147 .",
    "the second consistency check can be made with the distribution in redshift ( if estimated redshifts exist ) , where the number of galaxies at each redshift should satisfy the following convolution with the mean estimated error ( z ) = _ -^ \\ { - } _ f ( l(l_,z , ) ) dz   .",
    "abell , g. 1958 , , 3 , 211 abell , g. , corwin , h. & olowin , r. 1989 , , 70 , 1 bahcall , n. 1988 , , 26 , 631 bahcall , n. & cen , r. 1992 , , 398 , l81 bahcall , n. & cen , r. 1993 , , 408 , l77 bahcall , n. , fan , x. & cen , r. 1997 , , 485 , l53 bahcall , n. , lubin , l. & dorman , v. 1995 , , 447 , l81 bertschinger , e. & gelb , j. 1991 , computers in physics , 5 , 164 binggeli , b. , sandage , a. & tammann , g. 1988 , 26 , 509 carlberg , r. , yee , h. , ellingson , e. , abraham , r. , gravel , p. , morris , s. & pricthet , c. 1996 , 462 , 32 carlberg , r. , morris , s. , yee , h. & ellingson , e. 1997 , 478 , l19 connolly , a. , szalay , a. , bershady , m. , kinney , a. & calzetti , d. 1995 , , 110 , 2655 dalton , g. , maddox , s. & sutherland , w. 1997 , , 289 , 263 dalton , g. , efstathiou , g. , maddox , s. & sutherland , w. 1994 , , 269 , 15 efstathiou , g. , frenk , c.s . , white , s.d.m . & davis , m. 1988 , , 235 , 715 eke , v. , cole , s. & frenk , c. 1996 , , 282 , 263 evrard , a. 1989 , , 341 , l71 gelb , j. & bertschinger , j. 1994 , , 436 , 467 gott , j.r .",
    "1997 , personal communication henry , j. et al 1992 , , 386 , 408 huchra , j. geller , m. , henry , p. & postman , m. 1990 , , 365 , 66 kawaski , w. , shimasaku , k. , doi , m. & okamura , s. 1997 astro - ph/9705112 , accepted a&as kaiser , n. & squires , g. 1993 , , 404 , 441 kleyna , j.t . ,",
    "geller , m.j . ,",
    "kenyon , s.j . & kurtz , m.j .",
    "1996 , , 113 , 624 loveday , j. , peterson , b. , efstathiou , g. & maddox , s. 1992 , 390 , 338 lubin , l. , & postman , m. 1996 , , 111 , 1795 lubin , l. , & postman , m. 1996 , , 112 , 23 lumsden , s. , nichol , r. , collins , c. & guzzo , l. 1992 , , 258 , 1 mcgill , c. & couchman , h. 1990 , , 364 , 426 oukbir , j. & blanchard , a. 1997 , a&a , 317 , 1 peacock , p.j.e . & dodds , s. 1994 , 267 , 1020 peebles , p.j.e . , daly , r. & juszkiewicz , r. 1989 , 347 , 563 peebles , p.j.e .",
    "1993 principles of physical cosmology poggianti , b. 1997 a&as , 122 , 399 postman , m. , huchra , j. & geller , m. 1992 , , 384 , 404 postman , m. et al 1996 , , 111 , 615 schechter , p. 1976",
    ", , 203 , 297 schuecker , p. & bohringer , h. 1998 , astro - ph/9809396 , to appear in a&a suto , y. , cen , r. & ostriker , j.p .",
    "1992 , , 395 , 1 tyson , j.a . , valdes , f. & wenk , r.a .",
    "1990 , , 349 , l1 xu , g. , 1995 , ph.d .",
    "thesis , princeton university yee , h.k . to appear in the proceedings of the xth recontres de blois : birth of galaxies , blois , france , july 1998 zwicky , f. 1957 , morphological astronomy , springer - verlag zwicky , f. , herzog , e. , wild , p. , karpowicz , m. & kowal , c. 1961 - 68 , catalog of galaxies and clusters of galxies , vol",
    ". 1 - 6 , caltech"
  ],
  "abstract_text": [
    "<S> we describe an automated method for detecting clusters of galaxies in imaging and redshift galaxy surveys . the adaptive matched filter ( amf ) method utilizes galaxy positions , magnitudes , and  when available  photometric or spectroscopic redshifts to find clusters and determine their redshift and richness . </S>",
    "<S> the amf can be applied to most types of galaxy surveys : from two - dimensional ( 2d ) imaging surveys , to multi - band imaging surveys with photometric redshifts of any accuracy ( 2@xmath0d ) , to three - dimensional ( 3d ) redshift surveys . </S>",
    "<S> the amf can also be utilized in the selection of clusters in cosmological n - body simulations . </S>",
    "<S> the amf identifies clusters by finding the peaks in a cluster likelihood map generated by convolving a galaxy survey with a filter based on a model of the cluster and field galaxy distributions . in tests on simulated 2d and 2@xmath0d data with a magnitude limit of @xmath1 </S>",
    "<S> , clusters are detected with an accuracy of @xmath2 in redshift and @xmath310% in richness to @xmath4 . </S>",
    "<S> detecting clusters at higher redshifts is possible with deeper surveys . in this paper </S>",
    "<S> we present the theory behind the amf and describe test results on synthetic galaxy catalogs . </S>"
  ]
}