{
  "article_text": [
    "computational fluid dynamic ( cfd ) has been widely used to simulate turbulent flows .",
    "although the rapidly increasing availability of computational resource enables high - fidelity simulations , e.g. , large eddy simulation ( les ) and direct numerical simulation ( dns ) , it is not yet computationally feasible to routinely apply them for complex , industrial flows .",
    "therefore , reynolds - averaged navier - stokes ( rans ) models , where empirical closures are used to model the reynolds stresses , are still the dominant tools for practical engineering problems .",
    "however , rans predictions are known to be unreliable for flows with strong pressure gradients , curvature , or separation  @xcite .",
    "this is because some assumptions ( e.g. , the boussinesq assumption ) made in the closure models are not universally valid , and thus model - form errors are potentially introduced in predicting the regime - dependent , physics - rich phenomena of turbulent flows .",
    "these assumptions are typically in the form of functional dependency between mean flow properties and turbulent quantities .",
    "they have been traditionally formulated by using intuition , physical observations , and theoretical constraints .",
    "although advanced rans models  ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ) have been developed in the past decades , a universally applicable one is still lacking .",
    "the traditional process of rans model development solely based on physical understanding and reasoning seems to be insufficient to significantly improve the predictive capability .",
    "recently , the increasing availability of high - fidelity data sets from both dns and experiments makes it possible to use the data - driven approach as a complement to the physics - based approach to improve the predictive capability of rans models .",
    "the past several years have witnessed a few efforts to develop data - driven turbulence modeling approaches by using machine learning algorithms  ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "generally , machine learning refers to a process of using data to build explicit or implicit functions of responses with respect to input variables ( features ) .",
    "the trained functions can be evaluated to predict cases where data are not available . in the context of turbulence modeling ,",
    "different machine learning approaches aim to achieve a similar overarching goal , i.e. , improving the predictive capability of turbulence models .",
    "however , so far there is no consensus yet on the choices of learning responses and input features to better achieve this goal .",
    "dow and wang  @xcite chose the discrepancy field @xmath0 in turbulent viscosity as the response , while duraisamy and co - workers  @xcite introduced a full - field multiplicative discrepancy factor  @xmath1 into the production term of the transport equation as the learning target .",
    "although both the inferred @xmath2 and @xmath1 are demonstrated to be able to extrapolate to certain extents , they are still modeled quantities and have less physical interpretations .",
    "xiao et al .",
    "@xcite directly inferred the discrepancies in rans simulated reynolds stresses by using sparse velocity measurements .",
    "wu et al .",
    "@xcite further demonstrated these inferred reynolds stress discrepancies can be extrapolated to closely related flows .",
    "although the response chosen in  @xcite is a physical quantity , an intrinsic limitation lies on their choice of input features ( i.e. , physic coordinates @xmath3 ) . as a result",
    ", the prediction can only be applied to the flows in the same geometry at the same location .",
    "duraisamy and co - workers  @xcite used non - dimensional flow and model variables to construct the input feature space for calibrations of low - fidelity models .",
    "however , their input feature space was constructed with a very small number ( three ) of features and the invariant property was not fully considered .",
    "ling et al .",
    "@xcite pointed out the merits of embedding the invariance properties into machine learning process .",
    "they explored several machine learning models for classifying the regions where rans assumptions would fail  @xcite .",
    "most recently , they also attempted to directly predict the anisotropy tensors of the reynolds stresses by using random forests  @xcite and deep neural networks  @xcite .    by comprehensively considering the physical interpretability of learning targets and the invariance property of input features , wang et al .",
    "@xcite proposed a physics - informed machine learning ( piml ) approach to learn the functional forms of reynolds stress discrepancy on its six physically meaningful components ( i.e. , magnitude , shape , and orientation of reynolds stress tensor ) with respect to a group of ten invariant mean flow features .",
    "they successfully demonstrated that the trained discrepancy model can be used to improve the rans - modeled reynolds stresses in flows with different configurations .",
    "however , this work is still _ a priori _ investigation , since the improvements are demonstrated only in reynolds stresses but not in their propagated velocities .",
    "there are a number of challenges associated with propagating forward the corrected reynolds stresses through rans equations to obtain the mean velocity and pressure fields .",
    "for example , the high - fidelity data themselves used for training must be highly accurate to obtain a precise mean velocity field after propagation . moreover , the machine learning model should improve predictions of the mean flow variables , which requires not only the pointwise reynolds stress predictions but also their derivatives to be improved , since it is the divergence of reynolds stress that appears in the rans momentum equations .",
    "the objective of this work is to introduce the procedures toward a complete piml framework and demonstrate its capability of improving both the reynolds stresses and their propagated mean velocities in a relatively less challenging scenario with reliable training data . to improve the predictive accuracy of the machine learning model , the input feature space adopted in  @xcite",
    "is expanded by constructing an integrity basis of invariants of mean flow variables .",
    "the systematic approach of invariant feature construction proposed in  @xcite is employed to expand the input space for given raw tensorial mean flow variables .",
    "the fully developed turbulent flow in a square duct is used to demonstrate the merits of the proposed method .",
    "the discrepancy model is trained on duct flows from several reynolds numbers and evaluated on a duct flow at a reynolds number higher than any of the training cases .",
    "the predicted reynolds stresses are propagated to the mean velocity field through the rans equations , and the accuracy of the propagated mean velocities are investigated and the difficulties associated with the propagation are discussed . although current work is developed in the context of turbulence modeling , it has potential implications in many other fields in which the governing equations are well understood but empirical closure models are used for the unresolved physical process .",
    "the rest of the paper is organized as follows .",
    "section  [ sec : meth ] introduces building blocks of the physics - informed machine learning ( piml ) framework , including the construction of input feature space , representation of reynolds stress discrepancy as the response , construction of regression function of the discrepancy with respect to input features , and propagation of corrected reynolds stresses to mean velocity field .",
    "section  [ sec : result ] presents the numerical results to demonstrate the prediction performance of the proposed framework and merits of systematical expansion of input space .",
    "the concept of `` physics - informed machine learning '' and future perspectives of the current framework are discussed in section  [ sec : discussion ] .",
    "finally , section  [ sec : conclusion ] concludes the paper .",
    "in this section , the physics - informed machine learning ( piml ) framework for predictive turbulence modeling is summarized .",
    "its key procedures and components , including construction of the input feature set , choice of output responses , and building of regression functions , are discussed .",
    "the aim of the present work is to introduce and demonstrate the piml framework for predictive turbulence modeling . specifically , given high - fidelity data",
    "( e.g. , reynolds stresses from dns simulations ) from a set of training flows , the framework aims to improve the standard rans prediction for different flows for which dns data are not available . here , _ training flow",
    "_ refers to the flow with high - fidelity data , which are used to train the machine learning model .",
    "accordingly , _ test flow _",
    "( prediction flow ) is the flow to be predicted .",
    "generally , training flows should share similar flow physics with the test flow , so that the model does not have to extrapolate .",
    "this scenario is typical in the engineering design process , where data are available for some flows and predictions are required for different flows with slightly changed configurations ( e.g. , different reynolds numbers or slightly changed geometries ) but without data .     as the input and reynolds stress discrepancies @xmath4 as the output ) .",
    "the training data are then used to train the random forest models of discrepancy functions . to perform the prediction ,",
    "rans simulations are conducted for the test flow to obtain the mean flow features , which can be used to query the trained discrepancy functions and then correct the corresponding rans - modeled reynolds stresses .",
    "the corrected reynolds stresses are propagated through rans equations to the qois ( e.g. mean velocity field),scaledwidth=90.0% ]    in rans simulations model - form uncertainties stem from the rans - modeled reynolds stresses . therefore , the aim of the machine learning is to extract the functional form of discrepancies in rans - modeled reynolds stresses from data .",
    "figure  [ fig : piml ] shows a schematic of the piml framework .",
    "the overall procedure can be summarized as follows :    1 .",
    "perform baseline rans simulations on both the training flows and the test flow .",
    "2 .   compute the input feature field @xmath5 based on the local rans flow variables .",
    "3 .   compute the discrepancies field @xmath6 in the rans - modeled reynolds stresses for the training flows based on the high - fidelity data .",
    "4 .   construct regression functions @xmath7 for the discrepancies based on the training data prepared in step 3 , using machine learning algorithms .",
    "compute the reynolds stress discrepancies for the test flow by querying the regression functions .",
    "the reynolds stresses can subsequently be obtained by correcting the baseline rans predictions with the evaluated discrepancies .",
    "propagate the corrected reynolds stresses to the mean velocity field by solving the rans equations with the corrected reynolds stress field .",
    "there are four essential components in the piml framework : ( 1 ) construction of the input feature set , ( 2 ) representation of the reynolds stress discrepancy as the response , ( 3 ) construction of the regression function of the discrepancy with respect to input features , and ( 4 ) propagation of corrected reynolds stresses to mean velocities .",
    "the details of the framework are introduced below , and the procedures to systematically construct and expand the input features are highlighted .",
    "constructing a reasonable input feature space is of pivotal importance to the performance of machine learning models .",
    "first , the input features should be rich enough to differentiate data points in the feature space and better describe the functional relation between inputs and responses .",
    "moreover , it is more desirable to embed known invariance properties into the construction process to achieve improved generalization .",
    "wang et al .",
    "@xcite employed a set of ten invariant features to build random forest regressors .",
    "formulation of these invariant features heavily relied on physical understanding and reasoning .",
    "however , these ten features are not necessarily rich enough to represent all possible polynomial invariants of the local mean flow variables .",
    "therefore , a systematic methodology of constructing a complete invariant input set from a group of given tensorial variables as suggested by ling et al .",
    "@xcite is employed in the current work .",
    "specifically , given a finite collection of raw mean flow variables ( i.e. , tensors or vectors ) , a finite integrity basis of invariants can be constructed .",
    "any scalar invariant function of the raw inputs can be formulated as a function of the corresponding invariant basis .",
    "the first step is to identify the raw tensors and vectors . when choosing these raw input materials , they should be able to represent physical characteristics of the mean flow",
    "generally , these raw variables can be chosen in the same way as the traditional turbulence modeler does for developing advanced turbulence models .",
    "on the basis of the components used in the conventional turbulence modeling , a set of four raw inputs are identified as @xmath8 where @xmath9 and @xmath10 are strain rate and rotation rate tensors , respectively ; @xmath11 and @xmath12 are the gradients of pressure and turbulence kinetic energy ( tke ) , respectively .",
    "the four raw tensors and vectors above are assumed to represent the important physical characteristics of the mean flow , which are also widely used as crucial gradients in traditional turbulence modeling .",
    "for example , the combinations of @xmath9 and @xmath10 were used to construct nonlinear eddy viscosity models  @xcite .",
    "p2.5 cm | p3 cm p3.0 cm p5.0 cm normalized raw input @xmath13 & description & raw input @xmath14 & normalization factor @xmath1 + @xmath15 & strain rate tensor & @xmath9 & @xmath16 + @xmath17 & rotation rate tensor & @xmath10 & @xmath18 + @xmath19 & pressure gradient & @xmath11 & @xmath20 + @xmath21 & gradient of tke & @xmath12 & @xmath22 +    to ensure non - dimensionality of the raw inputs , the normalization scheme used in  @xcite is adopted .",
    "each element @xmath14 in the raw input set  @xmath23 is normalized by a corresponding normalization factor @xmath1 as @xmath24 .",
    "table  [ tab : featureraw ] shows all normalization factors of the raw input variables .",
    "based on hilbert basis theorem  @xcite , a finite integrity basis of invariants for this set @xmath25 of normalized raw inputs can be constructed .",
    "c|c2.5cm|c9.5 cm @xmath26 & feature index & invariant bases@xmath27 + ( 1 , 0 ) & 12 & @xmath28 , @xmath29 + ( 0 , 1 ) & 35 & @xmath30 , @xmath31 , @xmath32 + & & @xmath33 , @xmath34 , @xmath35 ; + & & @xmath36 , @xmath37 , @xmath38 ; + & & @xmath39 , @xmath40 , @xmath41 ; + ( 0 , 2 ) & 1517 & @xmath42 , @xmath43 , @xmath44 + & & @xmath45 , @xmath46 , @xmath47 * , @xmath48 * , @xmath49 * ; + & & @xmath50 , @xmath51 , @xmath52 * , @xmath53 * , @xmath54 * ; + & & @xmath55 , @xmath56 , @xmath57 * , @xmath58 * , @xmath59 * ; + ( 0 , 3 ) & 42 & @xmath60 + ( 1 , 3 ) & 4347 & @xmath61 , @xmath62 , @xmath63 , @xmath64 , @xmath65 +    table  [ tab : basis ] shows the minimal integrity bases for rotational invariance with given raw input set @xmath25  @xcite . note that the vectors @xmath11 and @xmath12 should be first mapped to antisymmetric tensors as follows ,    [ eq : vector2anti ] @xmath66    where @xmath67 is the second order identity tensor , and @xmath68 denotes tensor cross product .",
    "note that the asterisk ( @xmath69 ) on a term means to include all terms formed by cyclic permutation of anti - symmetric tensor labels ( e.g. , @xmath47 * is short for @xmath47 and @xmath70 ) . as a result , a set of 47 invariant features",
    "is constructed to represent the information of the mean flow feature set @xmath23 .",
    "this construction procedure of input features ensures completeness of rotational invariants with respect to the given set of raw tensor and vector inputs . to further enrich the input features ,",
    "this basis of 47 features from vector and tensor local flow variables is supplemented by an additional ten features from wang et al .",
    "@xcite , which also utilizes scalar rans flow variables .",
    "for example , wall distance based reynolds number @xmath71 is an important indicator to distinguish the boundary layer from shear flows . although some features in  @xcite may be redundant ,",
    "since they are invariant functions of the constructed invariant basis , the performance of random forest regressor is robust in the presence of the redundant inputs .",
    "finally , an input feature space of 57 invariants ( collectively denoted as @xmath72 ) is constructed for machine learning .      as discussed in section  [ sec : intro ] , it is preferable to choose physical variables as the responses ( target results ) of machine learning model .",
    "since a major source of model - form errors in rans simulation comes from the modeled reynolds stresses , a natural choice would be to directly learn the reynolds stresses from the data .",
    "however , this choice would totally abandon rans model and solely rely on data instead .",
    "although potential model - form errors may exist , the rans model predictions are still valuable in most circumstances , and machine learning should play the role as a complement instead of a replacement of rans modeling .",
    "therefore , the discrepancies of rans - modeled reynolds stresses are suitable candidate for the responses .",
    "nevertheless , the discrepancies can not be simply represented by the difference of each tensor component , since it is frame dependent and difficult to impose physical constraints . following the work of iaccarino and co - worker  @xcite , the discrepancies are formulated in the six physically interpretable dimensions ( i.e. , magnitude , shape , and orientation ) of reynolds stress tensor based on eigen - decomposition , @xmath73 where @xmath74 is the turbulent kinetic energy , which indicates the magnitude of @xmath75 ;",
    "@xmath67 is the second order identity tensor ; @xmath76 is the deviatoric part of @xmath75 ; @xmath77 $ ] and @xmath78 $ ] with @xmath79 are the orthonormal eigenvectors and eigenvalues of @xmath76 , respectively , indicating its shape and orientation .    to impose the realizability constrain of reynolds stress , the eigenvalues @xmath80 , @xmath81 , and @xmath82",
    "are transformed to barycentric coordinates @xmath83 , @xmath84 , and @xmath85 as follows  @xcite :    [ eq : lambda2c ] @xmath86    with @xmath87 .",
    "the barycentric coordinates can be plotted as a triangle and @xmath83 , @xmath84 , and @xmath85 indicate the portion of areas of the three sub - triangles in a cartesian coordinate @xmath88 .",
    "any point within the triangle is a convex combination of three vertices , i.e. , @xmath89 where @xmath90 , @xmath91 , and @xmath92 denote coordinates of the three vertices of the triangle . after the above mapping",
    ", the coordinate @xmath93 uniquely identifies the shape of the anisotropy tensor .",
    "similar to the lumley triangle  @xcite , the reynolds stresses falling in the interior of the barycentric triangle are realizable .",
    "representation of the discrepancy in the orientation ( eigenvectors ) of reynolds stress tensor is more challenging than that for eigenvalues .",
    "moreover , there are no explicit physical constraints on eigenvector systems .",
    "less attention has been given to the quantification and reduction of discrepancies in eigenvector systems .",
    "wang et al .",
    "@xcite proposed a method to perturb eigenvectors by using the euler angle .",
    "wang et al .",
    "@xcite predicted the discrepancies in eigenvectors parameterized by the euler angle based on dns data . in this work ,",
    "the euler angle is also employed to represent the discrepancies in eigenvectors of rans - modeled reynolds stresses .",
    "the euler angle system used follows the @xmath94@xmath95@xmath96 convention in rigid body dynamics  @xcite .",
    "that is , if a local coordinate system @xmath97@xmath98@xmath94 spanned by the three eigenvectors was initially aligned with the global coordinate system ( @xmath99@xmath100@xmath101 ) , the current configuration could be obtained by the following three consecutive intrinsic rotations about the axes of the local coordinate system : ( 1 ) a rotation about the @xmath94 axis by angle @xmath102 , ( 2 ) a rotation about the @xmath97 axis by @xmath103 , and ( 3 ) another rotation about its @xmath94 axis by @xmath104 .",
    "the local coordinate axes usually change orientations after each rotation .",
    "finally , the reynolds stress tensor is projected to six physically meaningful parameters representing its magnitude ( @xmath74 ) , shape ( @xmath105 , @xmath106 ) , and orientation ( @xmath102 , @xmath103 , @xmath104 ) .",
    "the discrepancies ( @xmath107 , @xmath108 , @xmath109 , @xmath110 , @xmath111 , @xmath112 , collectively denoted as @xmath113 ) of reynolds stress can be represented in these six projections .",
    "note that the tke discrepancy @xmath114 is the logarithm of the ratio of the dns - predicted tke ( @xmath115 ) to the rans - predicted tke ( @xmath116 ) , i.e. , @xmath117 therefore , these discrepancies are dimensionless quantities .",
    "moreover , they are also demonstrated to have similar characteristics among closely related flows  @xcite , and thus are chosen as the learning targets .      after identifying the input feature set @xmath72 and output responses @xmath4",
    ", a machine learning algorithm needs to be chosen to build the functional relation between input features and responses .",
    "there are various choices of supervised learning algorithms , e.g. , k - nearest neighbors  @xcite , linear regression  @xcite , gaussian processes  @xcite , tree - based methods ( e.g. , decision trees , random forest , and bagging )  @xcite , and neural networks  @xcite .",
    "as discussed in  @xcite , a major consideration is the capability to deal with the high dimensionality of the feature space .",
    "this consideration becomes more important in the current work since the input space is expanded to one with 57 features , the dimension of which is much higher than that in  @xcite .",
    "therefore , the random forest regressor  @xcite , known to be suitable for high dimensional regression problems , is employed to build the regression function of reynolds stress discrepancies with respect to the mean flow features .",
    "random forest regression is an ensemble learning technique that aggregates predictions from a number of decision trees .",
    "the decision tree model stratifies the input space by a series of decision rules , and those rules can be learned from the training data . by stratification of input space in a tree - like manner ,",
    "the decision tree is able to handle high - dimensional problems and is computationally efficient , as well .",
    "however , one major disadvantage of the single decision tree is that it tends to overfit the data , which often leads to poor predictions .",
    "this disadvantage can be overcome and prediction performance can be significantly improved by aggregating a large number of trees , which is the essence of the random forest algorithm . in the random forest model , the ensemble of decision trees",
    "is built with bootstrap aggregation samples ( i.e. , sampling with replacement ) drawn from the training data  @xcite .",
    "moreover , only a subset of randomly selected features is used when determining the splits of each tree .",
    "this reduces the correlation among trees in the ensemble and thus decreases the bias of the ensemble prediction .",
    "the fully developed turbulent flow in a square duct is considered to demonstrate the proposed framework .",
    "although this flow has a simple geometry , it features the in - plane secondary flow induced by reynolds stresses .",
    "all rans turbulence models under linear eddy viscosity hypothesis fail to predict the secondary mean motion , and even the reynolds - stress transport model ( rstm ) can not predict it well  @xcite .",
    "the errors stem from the modeled reynolds stresses .",
    "therefore , we aim to improve the rans - predicted reynolds stresses by learning from the data of similar flows . the geometry of the duct flow is presented in fig .",
    "[ fig : domain_duct ] .",
    "the reynolds number @xmath118 is based on the edge length @xmath119 of the square and bulk velocity .",
    "all lengths presented below are normalized by the height @xmath120 of the computational domain , which is half of the edge length .",
    "coordinate represents the streamwise direction .",
    "secondary flows induced by reynolds stress imbalance exist in the @xmath98@xmath94 plane .",
    "panel ( b ) shows that the computational domain covers a quarter of the cross - section of the physical domain .",
    "this is due to the symmetry of the mean flow in both @xmath98 and @xmath94 directions as shown in panel ( c).,scaledwidth=80.0% ]    the reynolds stress discrepancy function is trained on the data from flows at reynolds numbers @xmath121 to predict the flow at a higher reynolds number @xmath122 .",
    "all flows have the same geometry .",
    "the data of training flows are obtained from direct numerical simulations ( dns )  @xcite .",
    "note that the dns data of the flow to be predicted ( @xmath122 ) are reserved for comparison and are not used for training .",
    "the mean flow patterns among these flows are similar . in the cross - plane of the duct",
    ", there is a counter - rotating pair located at each of the four corners ( fig .",
    "[ fig : domain_duct](c ) ) .",
    "however , the recirculation bubble moves closer to the wall and its size decreases as the reynolds number increases .",
    "baseline rans simulation is conducted for each flow to obtain mean flow features and training data of the reynolds stress discrepancies . since linear eddy viscosity models are not able to predict the mean flow features of the secondary motions , the launder - gibson rstm is adopted to perform the baseline simulation . as indicated in fig .",
    "[ fig : domain_duct ] , only one quadrant of the physical domain is simulated due to the symmetry of the mean flow with respect to the centerlines along @xmath98- and @xmath94-axes .",
    "no - slip boundary conditions are applied at the walls , and symmetry boundary conditions are applied on the symmetry planes .",
    "the dns reynolds stresses are interpolated onto the mesh of the rans simulation to calculate the discrepancy .",
    "the rans simulations are performed in an open - source cfd platform , openfoam , using a built - in incompressible flow solver  ` simplefoam `  @xcite .",
    "mesh convergence studies have been performed .",
    "the random forest regressor is constructed with decision trees , each of which is built to its maximum depth by successive splitting of nodes until each leaf is left with one training data point . to control the prediction performance of a random forest model",
    ", there are two important free parameters , i.e. , number of trees and number of randomly selected features on which each split on each tree is determined .",
    "generally , a higher number of trees leads to a better performance . based on our testing ,",
    "an ensemble of @xmath123 trees is large enough to have a robust prediction .",
    "the number of features randomly selected is commonly smaller than the total number of input features .",
    "the reason for embedding the randomness is to enhance the diversity of the trees . therefore , the random forest prediction can be more robust and unlikely to over - fit the data . the size of the randomly selected subset of features is commonly chosen as the square root of the total number of input features  @xcite . in the current test case , the prediction results were shown to be insensitive to the number of features over which each split was determined .",
    "the aim of the piml framework is to reduce the discrepancies in the rans - modeled reynolds stresses . with",
    "the improved reynolds stresses , one should be able to obtain an accurate prediction of the velocity field . however , the outcome of velocity propagation depends on the quality of training data , i.e. , dns reynolds stresses .",
    "although the reynolds stresses from dns simulations are assumed to be more accurate than the rans predictions , it is not guaranteed that they can be propagated to a better mean velocity field due to potential statistical convergence errors .",
    "thompson et al .",
    "@xcite recently demonstrated that , even for channel flows , the reynolds stresses of different dns databases in literature lead to significant discrepancies in the propagated velocity fields .",
    "to better evaluate the performance of machine learning predictions of propagated velocities , it is useful to check the velocity field obtained by directly propagating the dns reynolds stresses via rans equations .     and",
    "( b ) @xmath124 obtained by propagating the dns reynolds stresses @xmath125 via rans equations at reynolds number @xmath122 .",
    "the dns results are also plotted for comparison.,title=\"fig:\",scaledwidth=35.0% ] +    the dns data of reynolds stresses at @xmath122 are used to solve the rans equations , and the corresponding mean velocity field is obtained .",
    "the propagated mean field of in - plane velocity is compared to that provided by the dns space - time averaging , which is shown in fig .",
    "[ fig : u_dns ] . the in - plane velocity components @xmath126 and @xmath124 on the four cross - sections ( @xmath127 and @xmath128 , as indicated in fig .",
    "[ fig : domain_duct](b ) ) are presented , but only the profiles in the region below the diagonal are shown due to the diagonal symmetry . it can be seen that the propagated results agree well with the dns profiles along all four cross sections for both @xmath126 and @xmath124 . however , in the regions away from the corner ( e.g. , @xmath129 or @xmath130 ) , the propagated velocity profiles slightly deviate from the dns results . especially for @xmath124 , notable discrepancies can be observed in the profile at @xmath131 .",
    "these discrepancies might come from small errors in reynolds stresses ( e.g. , error introduced in interpolations to rans mesh ) , since the secondary flow is sensitive to the reynolds stress components . as the magnitude of secondary velocity decreases away from the corner ,",
    "the discrepancies are even more pronounced .",
    "nevertheless , the overall data quality of reynolds stresses are considered satisfactory to obtain an improved velocity field .",
    "the discrepancy functions in six physical projections are learned from the training flows , and predictions are made for the test flow .",
    "we first investigate the prediction performance of the shape of the reynolds stress anisotropy tensor , which can be visualized in a barycentric triangle .",
    "the prediction results on two typical cross - sections ( @xmath132 and @xmath133 ) are plotted in the barycentric triangle in figs .",
    "[ fig : bayre]a and  [ fig : bayre]b , respectively .",
    "the reynolds stresses on the cross - section at @xmath132 from the wall to the outer layer start from two - component limit states ( bottom edge ) towards three - component anisotropic states ( middle area of the triangle ) . for the cross - section at @xmath133 ,",
    "the spatial variation of turbulence states is similar .",
    "the baseline rstm results capture this trend to some extent , especially in the regions away from the wall .",
    "this does much better than the linear eddy viscosity models ( results are not shown ) , predictions of which have an opposite trend against the truth .",
    "although the rstm predictions away from the wall are satisfactory , discrepancies are still pronounced , especially in the near wall region . for example",
    ", it can be seen in fig .",
    "[ fig : bayre]a that the dns reynolds stress anisotropy on the wall is at the two component state , since the velocity fluctuations in the wall normal direction are suppressed by the blocking of the bottom wall . as away from the wall",
    ", it moves towards the one - component state and then towards the three - component anisotropic states .",
    "in contrast , rstm - predicted anisotropy on the wall is closer to the two - component axi - symmetric state , while it approaches directly towards the generic turbulent states as away from the wall . by correcting the baseline rans - modeled reynolds stresses with the trained discrepancy function",
    ", the piml - predicted anisotropy is significantly improved . in both figs  [ fig : bayre]a and  [ fig : bayre]b , the piml - predicted anisotropies ( circles ) show much better agreement with the dns results ( squares ) than the rstm prediction does , especially in the near wall regions .     of predicted reynolds stress from the baseline for the test flow ( re = 3500 ) .",
    "the profiles are shown at four streamwise locations @xmath134 and @xmath135 .",
    "corresponding dns and baseline ( reference lines ) results are also plotted for comparison.,scaledwidth=50.0% ]    the barycentric coordinates of anisotropy tensor are shown to be considerably improved in the machine learning prediction process .",
    "however , the improvement of eigenvalues alone may not necessarily lead to a better prediction of anisotropy tensor .",
    "when the eigenvectors of rans - predicted anisotropy markedly deviate from the dns results , the reconstructed reynolds stress even with the dns eigenvalues but the rans eigenvectors may lead to even larger discrepancies in its tensor components .",
    "therefore , corrections are required for both the shape and orientation of the anisotropy tensor .",
    "figure  [ fig : angle ] presents the discrepancy profiles of rans - predicted reynolds stresses in orientations , i.e. , the rotation angles of dns anisotropies from the baseline rstm results .",
    "note that only the angle discrepancies @xmath136 are presented , and the results for @xmath137 and @xmath138 are omitted due to their qualitative similarities .",
    "the angle is presented in radian .",
    "notable discrepancies between the eigenvector systems of the dns and baseline anisotropy tensors can be observed . especially , in the near wall regions ( @xmath139 ) , the rotation angles @xmath140 are more than 0.2 rad ( @xmath141 degrees ) .",
    "it can be seen that these angle discrepancies are well predicted by the trained regression function over the entire domain , and their spatial variations are also well captured .",
    "however , slight wiggles can be found in the predicted @xmath136 on the lower part of the profile at @xmath142 .",
    "this non - smoothness originates from the pointwise estimation of the random forest model in the feature space , which can not guarantee spatial smoothness in the physical domain .    , and @xmath143 ) .",
    "the profiles are shown at four streamwise locations @xmath134 and @xmath135 .",
    "corresponding dns and baseline ( rstm ) results are also plotted for comparison.,scaledwidth=50.0% ]    the tke is also not well predicted by the baseline rans model , which can be seen in fig .",
    "[ fig : tke ] . the rstm tends to overestimate the magnitudes of reynolds stresses , which are almost the twice those of the dns results in most regions .",
    "the discrepancies of the rstm modeled tke exist in the entire flow domain and are especially large close to the corner .",
    "similar to the anisotropy prediction , the tke field corrected by the trained random forest model is significantly improved over the baseline results .",
    "[ fig : tke ] shows that the tke profiles of corrected reynolds stresses are nearly identical to the dns profiles .     and",
    "@xmath144 for baseline ( a , d ) , dns ( b , e ) and machine - learning - predicted ( c , f ) results.,title=\"fig:\",scaledwidth=50.0% ] +   +     and ( b ) shear component @xmath145 of corrected reynolds stress with the discrepancy model trained on 57 features .",
    "the profiles are shown at four streamwise locations @xmath134 and @xmath135 .",
    "corresponding dns and baseline ( rstm ) results are also plotted for comparison.,title=\"fig:\",scaledwidth=40.0% ] +    the results shown above demonstrate that all the physical projections of the rans - predicted reynolds stresses are significantly improved by the random forest discrepancy model .",
    "therefore , it is expected that the tensor components should also be improved over the corresponding baselines .",
    "figure  [ fig : tau_cont ] shows the contour plot comparisons of the baseline , dns , and piml - predicted results on the turbulent normal stress components @xmath146 and @xmath144 .",
    "these two normal components of reynolds stress tensor are known to be important to the velocity propagation in the duct flow since the imbalance of them ( @xmath147 ) is the main driving force of the secondary flow .",
    "both @xmath146 and @xmath144 are markedly overestimated by the rstm over the entire domain , which is due to its overestimation of the tke ( see fig .  [",
    "fig : tke ] ) .",
    "moreover , the spatial variation patterns of rstm predictions are significantly different from those of dns results , especially in the near - corner region .",
    "as expected , the machine learning predictions are considerably improved over the rstm baseline .",
    "most of the magnitudes , features , and patterns of dns results are captured well in the piml predictions for both @xmath146 and @xmath144 . in fig .",
    "[ fig : tau]a and  [ fig : tau]b , we also compare the profiles of normal stress imbalance @xmath147 and turbulent shear stress @xmath145 on four cross sections to more clearly demonstrate the improvement in the machine - learning predictions .",
    "it can be seen that rstm captures the spatial pattern of the normal stress imbalance , which is positive near the wall and becomes negative away from the wall .",
    "however , the magnitude @xmath148 of imbalance term is significantly overestimated .",
    "moreover , the rstm underestimates the turbulent shear stress @xmath145 .",
    "the discrepancies of rstm - modeled shear component @xmath145 are more notable on the cross - section at @xmath132 , which is close to the left lower corner .",
    "as expected , the piml - corrected results shows pronounced improvements over the rstm baselines .",
    "the piml predictions nearly coincide with the dns results for both @xmath147 and @xmath145 profiles .",
    "this demonstrates that the discrepancies in all reynolds stress tensor components that are relevant to the mean motion predictions are well predicted by the trained discrepancy functions .",
    "the improvement of reynolds stresses enabled by the piml framework , the success of which has been demonstrated above , is an important step toward data - driven , predictive turbulence modeling .",
    "however , the ultimate goal is to obtain more accurate quantities of interest ( qoi ) after propagating the corrected reynolds stress through rans equations . to investigate the performance on the improvement of the propagated mean velocity field",
    ", we substitute the reynolds stress field of rans momentum equations with the corrected one and propagate them by solving the equations .     and ( b ) @xmath124 obtained by propagating the piml predicted reynolds stresses via rans equations at reynolds number @xmath122 . the baseline ( rstm ) and dns results are also plotted for comparison .",
    "the discrepancy functions of reynolds stresses are trained on 57 features .",
    ", title=\"fig:\",scaledwidth=40.0% ] +    the mean secondary velocity profiles for @xmath126 and @xmath124 obtained by propagating the piml - predicted reynolds stress field are shown in figs .  [",
    "fig : u_f57]a and  [ fig : u_f57]b , respectively . to facilitate comparisons , the rstm baseline and dns results",
    "are also plotted in the same figures .",
    "the spatial variation of the rstm simulated velocity basically captures the trend of the truth , but its magnitude is not predicted well .",
    "notable deviations from the dns results can be observed . especially in the near - corner region , where the secondary motion is strong , the discrepancies are large in both rstm simulated @xmath126 and @xmath124 .",
    "in contrast , the piml - predicted results show much better agreements with the dns results .",
    "the improvements are even more pronounced in the regions where secondary flow is strong ( e.g. , @xmath149 and @xmath150 ) .",
    "this can be seen clearly in the contour plot of the secondary flow by zooming in the near - corner region ( figure  [ fig : u_cont ] ) . in this region",
    "the mean flow pattern simulated by rstm is notably different from the dns results . for the rstm",
    "modeled mean secondary motion ( fig .",
    "[ fig : u_cont](a ) ) , the flow approaches to the corner along the diagonal , and its velocity only decreases very close to the corner ( @xmath151 and @xmath152 ) .    ) .,title=\"fig:\",scaledwidth=30.0% ] +    however , the dns data show a different flow pattern , where the magnitude of the flow velocity towards the corner decreases earlier .",
    "the secondary velocity is significantly reduced after @xmath153 and @xmath154 .",
    "its magnitude decreases to almost zero as @xmath155 and @xmath156 . comparing figs .",
    "[ fig : u_cont]b and  [ fig : u_cont]c , the propagated flow field from piml prediction excellently captures the general pattern of the dns results in the near - corner region .",
    "it shows a significant improvement over the baseline results , suggesting that piml - predicted reynolds stresses are superior and can provide a better in - plane velocity field , especially in the region with a strong secondary flow .",
    "slight discrepancies still exist in the region with a mild secondary flow .",
    "for example , piml - predicted @xmath124 profile at @xmath131 deviates from the dns results ( fig .",
    "[ fig : u_f57]b ) .",
    "a possible reason is that the training data may contain small errors introduced in the interpolation process , which can cause notable velocity discrepancies in regions where the secondary flow is weak .",
    "similar discrepancies can be found in the velocity profiles propagated with the dns reynolds stresses , which are shown in fig .",
    "[ fig : u_dns]b .",
    "one of the novelties in this work lies in applying an integrity invariant basis on the construction of input feature space in the piml learning - prediction process .",
    "compared to the set of ten input features used in  @xcite , the current feature space is markedly expanded .",
    "a pertinent question is what benefits the expanded feature space offers ? or in other words , would it be possible to achieve a similar success by using an incomplete invariant basis as the input space , e.g. , the ten features used in  @xcite .     and",
    "( b ) @xmath124 obtained by propagating the piml - predicted reynolds stresses via rans equations at reynolds number @xmath122 .",
    "the baseline ( rstm ) and dns results are also plotted for comparison .",
    "the discrepancy functions of reynolds stresses are trained on ten features used in  @xcite.,title=\"fig:\",scaledwidth=40.0% ] +    to investigate this issue , we perform the same training , prediction , and propagation steps for the same test case shown above , but with the input set of ten features used in @xcite instead of current 57 features .",
    "the propagated mean secondary velocity profiles @xmath126 and @xmath124 from the corrected reynolds stress field are shown in figs .",
    "[ fig : u_f10]a and  [ fig : u_f10]b , respectively .",
    "the profiles of piml - predicted velocity are improved over the baseline rstm results in regions close to the corner ( @xmath149 ) for both components @xmath126 and @xmath124 . however , in the regions away from the corner ( @xmath157 to @xmath158 ) , the profiles of machine - learning predictions largely deviate from the dns results and become even worse than the baseline predictions .",
    "unphysical wiggling of the velocity profiles can be observed in both figures .",
    "compared to the mean velocity with the expanded feature space shown in fig .",
    "[ fig : u_f57 ] , the accuracy of propagated mean motion with the input set of ten features significantly deteriorates .     and ( b ) shear component @xmath145 of corrected reynolds with the discrepancy model trained on 10 features used in  @xcite .",
    "the profiles are shown at four streamwise locations @xmath134 and @xmath135 .",
    "corresponding dns and baseline ( rstm ) results are also plotted for comparison.,title=\"fig:\",scaledwidth=40.0% ] +    the deterioration of the mean flow prediction indicates that the piml - corrected reynolds stresses are not satisfactory to propagate to an improved mean velocity field .",
    "figures  [ fig : tau_10]a and  [ fig : tau_10]b show profiles of the normal stress imbalance term ( @xmath147 ) and shear stress component @xmath145 of the corrected reynolds stresses with the input space of ten features .",
    "it can be seen that the machine learning predictions are significantly improved over the baseline rstm results since the profiles of both terms have a better agreement with the dns results .",
    "the norms of discrepancies between the prediction and the truth are significantly reduced compared to those of the rstm results . however , a notable difference from the machine learning predictions with 57 features ( fig .",
    "[ fig : tau ] ) is that the profiles of the predicted reynolds stress with ten input features wiggle at the lower part of the duct . especially for the shear component  @xmath145",
    ", several bumps can be clearly found on the profiles at @xmath157 and @xmath158 .",
    "although the overall reynolds stress predictions are improved ( i.e. , discrepancies in tensor components are reduced ) , the derivative of the turbulent shear stress field becomes even worse than the baseline in these regions with wiggles and bumps .",
    "these unphysical wiggles can pollute the propagated velocity field since it is the divergence of reynolds stress appearing in the momentum equation and determining the velocity propagation .",
    "this explains the significant deterioration of the velocity prediction in fig .",
    "[ fig : u_f10]a .",
    "the expanded input space based on an integrity invariant basis used in this work significantly improves the learning and prediction performances of reynolds stress discrepancies , and thus improved mean velocity predictions can be obtained through the rans propagation .",
    "the merits of applying the expanded input set to construct the random forest model are twofold .",
    "first , the predicted field from the random forest model tends to be non - smooth due to its pointwise estimation .",
    "the level of non - smoothness increases when the dimension of the input space is lower than the truth .",
    "in other words , if the features are not rich enough to differentiate different response points in feature space , the prediction tends to be more non - smooth due to projecting onto an incomplete basis . using a set of complete invariant bases significantly increases the `` resolution '' of input space .",
    "thus , the prediction performance with expanded features ( fig .  [ fig : tau ] ) is markedly superior over that with the previous input set of ten features ( fig .",
    "[ fig : tau_10 ] ) .",
    "note that the increase in resolution of input space is more important for learning discrepancies in the orientation of the reynolds stress tensor , since eigenvectors contain more information than the eigenvalues do , and thus more features are needed to explain them .",
    "second , the current 57 input features also include rotational invariants other than full invariants , which also can improve the learning performance of angle discrepancies , since the euler angles are not reflection invariant . to improve the capability of generalization",
    ", one possible approach would be to expand the training data to include reflected states of the system and then to teach the model to be fully invariant on this expanded training set  @xcite .",
    "on the other hand , we can try to explore better parameterizations of eigenvector system instead of using euler angles . to improve the representation of discrepancies in the eigenvectors",
    "is an ongoing research , which is out of the scope of the current work .",
    "it is worth noting that using the expanded feature basis increases the risk of overfitting because it introduces more free parameters into the model . in this study ,",
    "the model performance was evaluated on a single flow configuration at multiple reynolds numbers .",
    "it is very likely that performance on other flow configurations would be unreliable due to overfitting .",
    "further validation is necessary to assess the generalization of these models .",
    "nevertheless , it is already useful to have a model that is specific to a given flow configuration because it is very common in industry to run many simulations of closely related flows .",
    "the concept of `` physics - informed machine learning '' claimed in this work is to emphasize the attempt to consider and embed physical domain knowledge into every stage of the machine learning process , including the construction of the input feature space , choice of output responses , and learning - prediction process . for most physical problems ,",
    "data are not rich enough to conduct the traditional machine learning , since most of existing algorithms have been developed for business applications and have rarely been used for physical systems .",
    "ling et al .",
    "@xcite demonstrated the merits of embedding physical truth ( e.g. , invariance properties ) into the machine learning process .",
    "arguably , we believe that the state - of - the - art machine learning techniques have difficulties in learning the hard constraints in a physical system ( e.g. , conservation law , realizability ) from any reasonable amount of data . therefore , in the proposed method the machine learning is employed to correct the rans model instead of replacing it",
    ". moreover , physical hard constraints ( e.g. , realizability of reynolds stress ) and domain knowledge ( e.g. , reasoning for choosing raw features ) are incorporated .",
    "we emphasize the concept of physics - informed machine learning to draw attentions from the audiences in both physical modeling and machine learning communities .",
    "we try to demonstrate that data - driven modeling is a promising compensate for traditional physical modeling . at the same time , we have incorporated as much turbulence domain knowledge as possible instead of entirely depending on data .",
    "although it has been demonstrated that the current piml framework is a promising way to improve predictive turbulence modeling , there are a few of challenges associated with the propagation of corrected reynolds stresses to the mean velocity field , which need improvement in future work . here",
    "we briefly discuss these challenges . in both  @xcite and current work ,",
    "the rans - modeled reynolds stresses are shown to be significantly improved .",
    "however , to propagate the success in reynolds stress predictions to qois ( e.g. , mean velocity field ) is still challenging .",
    "first , we should acknowledge that the improvements in reynolds stresses are from the point view of pointwise estimation .",
    "it is possible that the predictions are close to the truth but are not smooth ( i.e. , slightly wiggling around the truth ) , which might pollute the propagated velocity field .",
    "this is because the currently used machine learning algorithm , i.e. , random forest , may not necessarily improve the spatial derivative of reynolds stress field due to the pointwise statistics .",
    "second , the numerical stability could be another issue that affects a robust propagation .",
    "the second issue is relatively trivial and can be solved by using some numerical tricks , e.g. , adding artificial diffusion terms .",
    "the first issue on the non - smoothness of machine learning predictions is the main roadblock for velocity propagation .",
    "how to effectively use the information of the spatial correlation of the reynolds stress field from the data is crucial to further improve the current framework .",
    "one possible method would be to assume a non - stationary spatial correlation structure , whose hyper - parameters can be determined based on data and physical prior knowledge .",
    "the pointwise machine learning predictions could be regulated by this correlation structure to ensure the smoothness physically .",
    "finally , it is worth noting that in this paper we have yet to demonstrate the ability to generalize the predictive performance more broadly for a wide range of flows , since only one flow configuration at multiple reynolds numbers is considered . to generalize the predictive capability by using more comprehensive databases with various flow physics",
    "will be the subject of future study .",
    "recently , the growing availability of high - fidelity data sets has led to increased interest in using data - driven approaches to improve the predictive capability of rans models .",
    "wang et al .",
    "@xcite demonstrated that the rans - modeled reynolds stresses can be improved by learning the functional form of the reynolds stress discrepancy from available data .",
    "however , it is still an _ a priori _ study , since whether these improved reynolds stresses can be propagated to obtain a better velocity field remains unclear . in this work ,",
    "we introduce and demonstrate the procedures toward a complete physics - informed machine learning ( piml ) framework for predictive turbulence modeling , including learning the reynolds stress discrepancy function , predicting reynolds stresses in different flows , and propagating the predicted reynolds stresses to the mean flow field . to improve the learning - prediction performance ,",
    "the input features are expanded by constructing an integrity invariants basis of given raw mean flow variables .",
    "the predictive accuracy of the velocity field by propagating the piml - corrected reynolds stresses is investigated .",
    "the fully developed turbulent flow in a square duct is used as the test case .",
    "the discrepancy functions are trained in the flows at low reynolds numbers and used to predict a different flow at a high reynolds number .",
    "the numerical results show excellent predictive performances in both reynolds stresses and their propagated velocity field , demonstrating the merits of the proposed piml approach in predictive turbulence modeling .",
    "sandia national laboratories is a multi - mission laboratory managed and operated by sandia corporation , a wholly owned subsidiary of lockheed martin corporation , for the u.s .",
    "department of energy s national nuclear security administration under contract de - ac04 - 94al85000 .",
    "sand2017 - 0664 j",
    "conflict of interest : the authors declare that they have no conflict of interest .",
    "e.  dow , q.  wang , quantification of structural uncertainties in the @xmath74@xmath159 turbulence model , in : 52nd aiaa / asme / asce / ahs / asc structures , structural dynamics and materials conference , aiaa , denver , colorado , 2011 , pp .",
    "20111762 .",
    "b.  tracey , k.  duraisamy , j.  alonso , application of supervised learning to quantify uncertainties in turbulence and combustion modeling , in : 51st aiaa aerospace sciences meeting including the new horizons forum and aerospace exposition , vol .",
    "259 , aiaa , berlin , germany , 2013 , pp . 118 .",
    "h.  xiao , j .- l .",
    "wu , j .- x .",
    "wang , r.  sun , c.  roy , quantifying and reducing model - form uncertainties in reynolds - averaged navier ",
    "stokes simulations : a data - driven , physics - informed bayesian approach , journal of computational physics 324 ( 2016 ) 115136 .",
    "wang , j.  wu , h.  xiao , using data to improve reynolds stresses in rans simulations : a physics - informed machine learning approach , submitted .",
    "available at https://128.84.21.199/abs/1606.07987 ( 2016 ) .",
    "wang , r.  sun , h.  xiao , quantification of uncertainties in turbulence modeling : a comparison of physics - based and random matrix theoretic approaches , international journal of heat and fluid flow 62  ( b ) ( 2016 ) 577592 .",
    "f.  billard , development of a robust elliptic - blending turbulence model for near - wall , separated and buoyant flows . ,",
    "thesis , school of mechanical aerospace and civil engineering , the university of manchester . ,",
    "manchester , uk ( 2011 ) .",
    "v.  svetnik , a.  liaw , c.  tong , j.  c. culberson , r.  p. sheridan , b.  p. feuston , random forest : a classification and regression tool for compound classification and qsar modeling , journal of chemical information and computer sciences 43  ( 6 ) ( 2003 ) 19471958 ."
  ],
  "abstract_text": [
    "<S> although an increased availability of computational resources has enabled high - fidelity simulations ( e.g. , large eddy simulations and direct numerical simulation ) of turbulent flows , the reynolds - averaged navier  stokes ( rans ) models are still the dominant tools for industrial applications . </S>",
    "<S> however , the predictive capabilities of rans models are limited by potential inaccuracy driven by hypotheses in the reynolds stress closure . recently , a physics - informed machine learning ( piml ) approach has been proposed to learn the functional form of reynolds stress discrepancy in rans simulations based on available data . </S>",
    "<S> it has been demonstrated that the learned discrepancy function can be used to improve reynolds stresses in different flows where data are not available . </S>",
    "<S> however , owing to a number of challenges , the improvements have been demonstrated only in the reynolds stress prediction but not in the corresponding propagated quantities of interest ( e.g. , velocity field ) , which is still an _ a priori _ study . in this work , </S>",
    "<S> we introduce and demonstrate the procedures toward a complete piml framework for predictive turbulence modeling , including learning reynolds stress discrepancy function , predicting reynolds stresses in different flows , and propagating the predicted reynolds stresses to mean flow fields . </S>",
    "<S> the process of reynolds stress propagation and predictive accuracy of the propagated velocity field are investigated . to improve the learning - prediction performance , </S>",
    "<S> the input features are enriched based on an integrity basis of invariants . </S>",
    "<S> the fully developed turbulent flow in a square duct is used as the test case . </S>",
    "<S> the discrepancy model is trained on flow fields obtained from several reynolds numbers and evaluated on a duct flow at a reynolds number higher than any of the training cases . </S>",
    "<S> the predicted reynolds stresses are propagated to velocity field through rans equations . </S>",
    "<S> numerical results show excellent predictive performances in both reynolds stresses and their propagated velocities , demonstrating the merits of the piml approach in predictive turbulence modeling .    </S>",
    "<S> machine learning , turbulence modeling , reynolds - averaged navier - stokes equations , data - driven approach </S>"
  ]
}