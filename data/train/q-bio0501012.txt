{
  "article_text": [
    "the multiple sequence alignment ( msa ) problem constitutes one of the fundamental research areas in bioinformatics . while at first sight it may seem a simple extension of the two - string alignment problem _ two strings good , four strings better _",
    ", for biologists , the multiple alignment of proteins or dna is crucial in deducing their common properties @xcite . quoting arthur lensk @xcite : _ one or two homologous sequences whisper ... a full multiple alignment shouts out loud_.    in general , the sequences consist of a linear array of symbols from an alphabet of @xmath3-letters ( @xmath4 for dna and @xmath5 for proteins ) . given @xmath0 sequences to determine a good multiple sequence alignment is a relative task .",
    "usually one defines a score function that depends on the distances between the letters of the alphabet , and assumes that the better alignment is the one that minimizes this score function .",
    "it is a common use to define the msa score in terms of the scores of the pairwise global alignments of the sequences ( sum of pairs score)@xcite . given two sequences @xmath6 and @xmath7 let @xmath8 be a cost of the mutation of @xmath9 into @xmath10 and @xmath11 the cost of inserting or deleting of the letter . extending @xmath8 so that @xmath12 and @xmath13 and considering that a null ( - ) symbol isolated from others ( - ) pays an extra cost @xmath14 @xcite we may define the score of a pairwise alignment @xmath15 for sequences @xmath16 and @xmath17 of size @xmath18 as :    @xmath19    where @xmath20 is the number of isolated ( - ) .",
    "then , the score for the multiple alignment is given by :    @xmath21    the multiple sequence alignment has at least three important applications in biology : classification of protein families and superfamilies , the identification and representation of conserved sequences features of both dna or proteins that correlate structure and/or function and the deduction of the evolutionary history of the sequences studied @xcite .",
    "unfortunately the problem is known to be _ np - complete _ and no complete algorithm exist to solve real or random instances .",
    "therefore , many heuristic algorithms have been proposed to solve this problem .",
    "the algorithm of carrillo - lipman @xcite ( which is complete ) , is a dynamic programming algorithm able to find the multiple alignment of 3 sequences , and with some heuristic added , to find the alignments , in reasonable time , of up to 6 sequences @xcite .",
    "however , its computational cost scales very fast with the number of sequences and is of little utility for more ambitious tasks . in the first 90 s",
    "the problem was approached using ideas coming from physics , j. kim and collaborators @xcite and m. ishikawa and collaborators @xcite used different version of the simulated annealing @xcite technique with some success , but their algorithms were unable to change the number of gaps in the alignment .",
    "this means that once they started with a given initial configuration ( usually taken from some heuristics ) , any motion of segments in the sequences conserved the number of gaps . to extend these programs allowing the number of gaps to change",
    "will cause the appearance of global moves in the algorithm that are very expensive from the computational point of view .",
    "probably the must successful attempt to solve this problem has been the clustal project @xcite , a progressive algorithm that first organizes the sequences according to their distances and then aligns the sequences in a progressive way , starting with the most related ones .",
    "moreover , it uses a lot of biological information , some motifs of residues rarely accept gaps , sub - sequences of residues associated with structural sub - units are preferred to stay together during the alignment , etc .",
    "these features , and a platform easy to use and integrated with other standard bioinformatic tools , have made clustal the favorite multiple sequence alignment program for biologists and people doing bionformatics in general @xcite .",
    "however , it also has important drawbacks .",
    "once the first @xmath3 sequences are aligned , the inclusion of a new sequence would not change the previous alignment , the gap penalties are the same independently on how many sequences have been already aligned or their properties , and being a progressive method the global minimum obtained is strongly biased by those sequences which are more similar@xcite .",
    "another , recent and also successful approach uses the concepts of hidden markov models @xcite . while some of the previous drawback associated to clustal disappear , because for example , the sequences do not need to be organized a priori , one most start assuming a known model of protein ( or dna ) organization , which is usually obtained after training the program in a subset of sequences . then",
    ", one must be aware that the results usually depend on the training set , specially if it is not too large .",
    "moreover , if we are dealing with sequences of unknown family , or difficult to be characterized this approach does not guarantee good alignments .",
    "therefore we decided to propose a new simulated annealing ( sa ) algorithm that avoids the main difficulty of the previous attempts @xcite .",
    "our algorithm allows for the insertion and deletion of gaps in a dynamic way using only local moves .",
    "it makes use of the mathematical mapping between the multiple sequence alignment and a directed polymer in a random media ( dprm ) pointed out some years ago by hwa et al @xcite .",
    "in such a way , it should be also possible to extrapolate all the computer facilities and techniques , developed in the field of polymers to this biological problem .",
    "the rest of the paper is organized in the following way . in the next section",
    "we make a short review of the theoretical foundations of our algorithm .",
    "then in section [ sec : alg ] we explain the implementation details to discuss the results in section [ sec : res ] .",
    "finally the conclusions are presented including and outlook for future improvements of this program .",
    "usually , multiple sequence alignments are studied and visualized writing one sequence on the top of the other , miming a table , ( see figure [ fig : usual_alignment ] ) and all the probabilistic algorithms devised so far use the simplicity of this representation to generate the moves .    instead of that , we will use the well known fact @xcite that the alignment of @xmath0 sequences may be represented in a @xmath0 dimensional lattice ( see figure [ fig : square ] for @xmath22 ) .",
    "the cells of the @xmath0-dimensional lattice are labeled by the @xmath0 indexes @xmath23 .",
    "the bonds encode the adjacency of letters : a diagonal bond in a @xmath0 dimensional space represents the @xmath0-pairing @xmath24 .",
    "the insertion of gaps are represented by bonds without components in the sequences where the gaps were inserted .",
    "for example , a @xmath0-pairing @xmath25 is represented by a bond whose projection on the third sequence is zero , and the @xmath0-pairing @xmath26 is represented by a bond whose projection on the second and third sequences are zero .",
    "then , any alignment maps onto a lattice path that is directed along the diagonal of the @xmath0-dimensional hypercube .",
    "this lattice path may be interpreted as a directed polymer and the random media in the problem is provided by the structure of the sequences to be aligned and by the distance between the residues in the different sequences .",
    "this mapping was already fruitfully used by hwa and co.@xcite to prove that the similarities between two sequences can be detected only if their amount exceeds a threshold value and for proposing a dynamic way to determine the optimal parameters for a good alignment of two sequences .    here , our main focus will be to optimize the directed polymer ( lattice path ) under the constraints imposed by the sequences and their interactions in dimensions larger than 2 . to use a simulated annealing algorithm we extend the usual representation of computer science of determining the ground state of the problem to a finite temperature description .",
    "then , a finite - temperature alignment is a probability distribution    @xmath27    over all possible conformations @xmath28 of the polymer and where @xmath29 is given by equation [ eq : cost_function ] , and @xmath30 is the partition function of the alignment @xcite .",
    "the temperature ( @xmath31 ) controls the relative weight of alignments with different scores ( different conformations of the polymer ) while @xmath8 the length of the polymer and the frequency of the gaps . in physical terms",
    ", @xmath32 defines and ensemble at temperature @xmath31 with line tension @xmath11 and chemical potential @xmath8.@xcite",
    "the simulated annealing ( sa ) was introduced many years ago by kirkpatrick et al @xcite to find a global minimum of a function in combinatorial optimization problems .",
    "sa is a probabilistic approach , that in general needs a state space ( the different configurations of the directed path ) and a cost or energy function ( [ eq : cost_function ] ) to be minimize ( eq . [ eq : cost_function ] ) .",
    "simulated annealing generates new alignments from a current alignment by applying transition rules of acceptance . the criteria for acceptance",
    "are the following :    * if @xmath33 , accept the new alignment * if @xmath34 accept it with probability @xmath35    the parameter @xmath36 controls the probability to accept a new configuration .",
    "initially , one starts at low values of @xmath36 ( high temperatures ) and then increases it applying an annealing schedule .",
    "if the temperature is lowered slowly enough , it can be proved that the system reaches a global minimum @xcite .",
    "unfortunately it will require infinitely computational time and one usually selects the best scheduling that is possible to afford with the computational facilities at hand .",
    "then sa is run over many initial conditions , and one assumes that the output of minimum energy is ( or is close ) to the global minimum .    in the multiple sequence alignment",
    "this is also the case , but differently to what happens in other combinatorial optimization problems , here the average solution , i.e. that obtained after averaging over all the local minima s may be interesting by itself .",
    "in fact , researchers are often interested not in the particular details of the alignment , but in its robust properties , and comparing all the outputs of the sa is a way to get this information .    from the technical point of view",
    ", once a cost function is defined , one needs to select the moves to be associated to the transition rates . our description of the multiple sequence alignment problem as a directed polymer in a random media allows us to define three types of moves , insertion , deletion and motion of gaps .",
    "all these moves are represented in figure ( [ fig : local_moves ] ) in a two - dimensional grid .",
    "the extension to @xmath0-dimensional systems is straightforward .        in this way",
    "we get an algorithm that allows for the creation of gaps , which means a search space larger than the usually proved by similar methods . at the same time the algorithm is quadratic in the number of sequences .",
    "in fact , the computational cost of any move is limited by the square of the number of sequences to be aligned .    in this work",
    ", we did not follow any heuristic strategy of optimization .",
    "our intention was to prove the potentiality of this strategy and we kept things as simple as possible .",
    "for example , if we start too far from the global minimum , the selection of local moves alone will make the algorithm to converge very slowly to it .",
    "this drawback may be overcome using very different initial conditions or trying , every some time steps , global moves that change radically the conformation of the polymer .",
    "we did not take care of this . during the simulation",
    "the three moves were chosen with probability @xmath37 .",
    "the only biological information inserted was given by the cost matrix used to align the protein sequences .",
    "we avoid the use of important and well know biological information , fixed residues , phylogenetic tree of the sequences , etc , and the program was designed without the use programming optimization tricks .",
    "all the results presented in this section reflects the alignments of proteins from the kinase family , but qualitatively similar results were obtained for the gpcrs ( g protein - coupled receptors ) and crp ( camp receptor protein ) families .",
    "the simulations started with @xmath38 and every @xmath39 montecarlo steps @xmath36 was increased by a multiplicative factor of 1.01 until @xmath40 .",
    "we took care and in all cases the system reached the equilibrium .",
    "the different initial conditions were chosen inserting gaps randomly in all the sequences but the larger one , such that considering these gaps at @xmath41 , all the sequences were of equal length . to define the distance between the letters of the alphabet we use the pam matrix @xcite .    in figure",
    "[ fig : relax3d ] are shown the approach to equilibrium of the multiple sequence alignment of 3 sequences averaged over 100 initial conditions for @xmath42 and @xmath43 . comparing with the result of the carrillo - lipman algorithm it is evident that for @xmath44 the algorithm is very close to the global minimum .",
    "however , one should take care that differently to what is usually obtained in other algorithms for the multiple sequence alignment problem , these figures reflects averages values of the multiple sequence alignment .    in fact , one is often interested , rather than on the average , in the minimum of all the alignments . in figure",
    "[ fig : hist0 - 3d-123 ] we represent an histogram in energy for the alignment , over 1000 initial conditions for different values of @xmath39 , of the same three proteins of the kinase family presented in figure [ fig : relax3d ] .",
    "note again that for @xmath45 we obtain exactly the carillo - lipman result with probability larger than 0 .",
    "moreover , looking to the structure of the histogram for @xmath45 , one can also conjecture that if the average multiple sequence alignment were calculated only with those alignments concentrated in the peak of lower energies , the result presented in figure [ fig : relax3d ] will be closer to the one of the carrillo - lipman algorithm .",
    "another symptom suggesting that the average over the realization must be taken with care comes from the analysis of figure [ fig : hist-3d-1 - 9 ] .",
    "there we present again histograms for @xmath45 but using three different samples of the kinase family .",
    "note that while sample 1 and sample 3 are very well behaved and the results compare very well with the carillo - lipman method , the situation for sample 2 is different . to get good results in this case , it is clearly necessary to go beyond 1000 montecarlo steps .    in the same spirit of figure [ fig : relax3d ] ,",
    "figures [ fig : relax9d ] and [ fig : relax18d ] reflect results suggesting that also for higher dimensions , if @xmath39 is large enough the algorithm should produce good alignments .",
    "in fact , also in these cases the energy decreases linearly with @xmath39 .    if the number of sequences is higher , the correlations between the sequences increases , and the algorithm should find better results .",
    "this fact may be clearly seen in figure [ fig : equilibritation - e - time ] where the equilibration time of the algorithm ( in m.c.s ) is shown as a function of the number of sequences .",
    "the equilibration time , measured as the time necessary to reduce the energy by a factor @xmath46 , decreases linearly with the number of sequences to be aligned . of course the results may change if very different sequences are aligned , but in this case all other known algorithms fail to predict good alignments .",
    "then , we may say that for the most common cases , of correlated sequences , we present an algorithm whose convergence time decreases with @xmath0 , and whose moves , only increase quadratically with @xmath0 .    with these results at hand , we follow to study the structure of the space of the solutions as a function of the number of aligned sequences .",
    "we define a distance ( @xmath47 ) between two alignments @xmath48 , and @xmath49 in the following way .",
    "given two solutions , @xmath50 and @xmath51 ( where the index @xmath52 stands for the sequence and @xmath53 for the position of the symbol in the sequence ) we , aligned one by one of the @xmath0 sequences of each solution using a dynamic programming algorithm reminiscent of the needleman - wunsh algorithm with the following score function :    @xmath54    and express @xmath55 as :    @xmath56    in this way identical alignments will be at distance @xmath57 from each other , and the insertion of gaps to obtain good alignments is penalized , such that the original alignments are altered minimally during the calculation of @xmath55 .",
    "we calculated @xmath47 with @xmath58 and @xmath59 and the results were the same ( apart a constant shift in @xmath47 ) .",
    "below we present figures for @xmath58 .",
    "we study how different are , from the solution of minimum score , the other solutions obtained aligning @xmath0 sequences . for every value of @xmath0 we use 1000 initial conditions and a @xmath45 .",
    "note that the sequences used were always the same .",
    "this mean , we first aligned three sequences from the kinase family .",
    "then , to align 4 sequences we just add a new one to the previous three and started the alignment from scratch",
    ". the procedure was repeated for every new value of @xmath0 .",
    "the results appear in figures [ fig : clustering - result - down ] and [ fig : clustering - result - up ] where @xmath60 is plotted as a function of @xmath47 . from the figures it becomes evident that the space of solution strongly depends on the number of sequences aligned .",
    "for example , while for three sequences the distance between the alignments is correlated with the difference in score , for more than 4 sequences it is not true anymore .",
    "moreover , while for @xmath61 the distance between the solutions decreases , it increases for @xmath62 and remains constant for @xmath63 .",
    "surely , these results reflect the correlation between the proteins aligned .",
    "for example , we may speculate that for @xmath64 , any new protein added contributed to find more similar alignments , i.e. added relevant information to the system .",
    "however , for @xmath62 the sequences contributed with new and uncorrelated information that produce more distant alignments and for @xmath63 to add new proteins that belong to the kinase family will not change the relevant characteristics of the alignment .",
    "these results are relevant , considering the limitations of progressive algorithms to change the previous alignment when new sequences are added .",
    "figures [ fig : clustering - result - down ] and [ fig : clustering - result - up ] , clearly suggest that the inclusion of one single sequence may dramatically change the character of the solutions .",
    "in this work we presented a new probabilistic algorithm , to perform the multiple alignment of proteins .",
    "the algorithm is based on the mapping between the dprm and the multiple sequence alignment problem . at variance with other probabilistic algorithms",
    "our algorithm permits the variation of the number of gaps in the alignment without the necessity of expensive global moves .",
    "it is proved that for small number of sequences it reproduces the results of a complete algorithm .",
    "moreover , we show that for practical purposes the equilibration time is almost independent on the number of sequences aligned @xmath0 and in the worst case , it scale linearly with @xmath0 . finally , we study the space of solutions for different number of aligned sequences , and find a very rich structure that indicates the importance of just one sequence in the multiple alignment .",
    "of course the algorithm is still far from being competitive with other approaches like hmm and clustal .",
    "we are already working in implementing a similar work but using parallel tempering instead of simulated annealing .",
    "it is know that parallel tempering is more useful that s.a . when dealing with very hard problems , like spin glasses .",
    "moreover , it is very suitable to parallelization . also a direction of current work is the introduction of biological information relevant for the alignment .",
    "this may impose important constraints in the possible alignments , that may in turn strongly reduce the space of possible solutions . and",
    "last , but not least , important programing optimization are necessary to make competitive this program from the computing time point of view .",
    "d. gunsfield , _ algorithms on strings , trees and sequences _ ( 1999 ) cambridge university press .",
    "t. j. p. hubbard , a. m. lensk and a. tramontano , nature structural biology * 4 * , 313 ( 1996 ) m.s .",
    "waterman , _ introduction to computational biology _ ( 200 ) , chapm & hall .",
    "p. pevzner , _ computational molecular biology _ ( 2000 ) mit press . h.",
    "carrillo and d. lipman , siam j. appl .",
    "math , * 48 * , 1073 , ( 1988 ) j. kim , s. pramanik and m. j. chung , cabios * 10 * 419 ( 1994 ) m. ishikawa , t. toya , m. hoshida , k. nitta , a. ogiwara and m. kanehisa , cabios * 9 * 267 , ( 1993 ) s. kirkpatrick , c.d .",
    "gelatt and m. p. vecchi , science * 220 * , 671 ( 1983 ) j. d. thompson , d. g. higgings and t. j. gibson , nucleid acids res . * 22 * , 4673 ( 1994 ) we are not aware of any statistical study proving this , but we believe that this statment is well accepted within the colleagues we contacted .",
    "r. durbin , s. r. eddy , a. krogh and g. mitchison , _ biological sequence analysis _",
    "( 1998 ) cambridge university press .",
    "t. hwa and michael lassig , phys .",
    "* 76 * , 2591 ( 1996 ) m. q. zhang and t. g. marr , j. theor",
    ". biol . * 174 * , 119 ( 1995 ) m. kschischo and m. l@xmath65ssig , preprint s. geman , s. geman , ieee transictions on pattern analysis and machine inteligence , * 6*,721 ( 1984 ) s.b . needleman and c. d. wunsch , j. mol",
    "48 * , 444 ( 1981 )"
  ],
  "abstract_text": [
    "<S> we proposed a probabilistic algorithm to solve the multiple sequence alignment problem . </S>",
    "<S> the algorithm is a simulated annealing ( sa ) that exploits the representation of the multiple alignment between @xmath0 sequences as a directed polymer in @xmath0 dimensions . within this representation </S>",
    "<S> we can easily track the evolution in the configuration space of the alignment through local moves of low computational cost . at variance with other probabilistic algorithms </S>",
    "<S> proposed to solve this problem , our approach allows for the creation and deletion of gaps without extra computational cost . </S>",
    "<S> the algorithm was tested aligning proteins from the kinases family . when @xmath1 the results are consistent with those obtained using a complete algorithm . </S>",
    "<S> for @xmath2 where the complete algorithm fails , we show that our algorithm still converges to reasonable alignments . </S>",
    "<S> moreover , we study the space of solutions obtained and show that depending on the number of sequences aligned the solutions are organized in different ways , suggesting a possible source of errors for progressive algorithms . </S>"
  ]
}