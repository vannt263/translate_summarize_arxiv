{
  "article_text": [
    "leverage scores are scalar quantities associated with the column space of a matrix , and can be computed from the rows of _ any _ orthonormal basis for this space .",
    "we restrict our discussion here to leverage scores of full column rank matrices .",
    "[ d_lev ] let @xmath0 be a real @xmath4 matrix with @xmath5 .",
    "if @xmath6 is any @xmath7 matrix whose columns form an orthonormal basis for @xmath1 , then the leverage scores of @xmath0 are @xmath8 here @xmath9 denotes the @xmath10th column of the @xmath11 identity matrix , and @xmath12 denotes the @xmath10th row of @xmath6 .",
    "note that leverage scores are independent of the orthonormal basis , since @xmath13 and @xmath14 is the unique orthogonal projector onto @xmath1 .",
    "the basic properties of leverage scores are @xmath15 hoaglin and welsch introduced statistical leverage scores in 1978 to detect outliers in regression problems ( * ? ? ?",
    "* section 2 ) , ( * ? ? ?",
    "* section 5.1 ) , ( * ? ? ? * section 2.2 ) .",
    "about thirty years later , mahoney , drineas and their coauthors started to advocate the use of leverage scores in randomized matrix algorithms @xcite .",
    "more specifically , leverage scores are the basis for importance sampling strategies , in the context of low rank approximations @xcite , cur decompositions @xcite , subset selection @xcite , nystrm approximations @xcite , least squares problems @xcite , and matrix completion @xcite , to name just a few .",
    "leverage scores also play a crucial role in the analysis of randomized algorithms @xcite , and fast algorithms have been developed for their approximation @xcite .",
    "since leverage scores depend only on the column space , and are not tied to any particular orthonormal basis , the question is how to compute them .",
    "many existing papers , among them the survey monograph ( * ? ? ?",
    "* definition 1 ) , define leverage scores as row norms of a thin left singular vector matrix .",
    "however , the sensitivity of singular vectors is determined by the corresponding singular value gaps .",
    "this , and the fact that qr decompositions , when implemented via householder transformations or givens rotations , are numerically stable ( * ? ? ?",
    "* sections 19.119.7 ) , motivated us to investigate qr decompositions for the computation of leverage scores . in this paper , we derive bounds on the difference between the leverage scores of a matrix @xmath0 and a perturbation @xmath2 , when the leverage scores are computed from a qr decomposition . note that we do not assume a particular implementation of the qr decomposition and assume that quantities are computed in exact arithmetic .",
    "we consider our results to be a first step towards determining whether computing leverage scores with a qr decomposition is numerically stable .",
    "since most of our bounds do not exploit the zero structure of the upper triangular factor , they can be readily extended to polar decompositions .",
    "we present a short overview of the contents of the paper and the main results . for brevity",
    ", we display only the first order terms in the bounds , and omit the technical assumptions .",
    "the @xmath11 identity matrix is @xmath16 , with columns @xmath9 and rows @xmath17 , @xmath18 .    for a real @xmath7 matrix @xmath0 with @xmath19 ,",
    "the two - norm condition number with respect to left inversion is @xmath20 , where @xmath21 is the moore - penrose inverse .",
    "the stable rank is @xmath22 , where @xmath23 .",
    "we denote the leverage scores of a perturbed matrix @xmath2 by @xmath24 and refer to the quantities @xmath25 and @xmath26 as the the absolute leverage score difference and relative leverage score difference , respectively .",
    "we assume , tacitly , that relative leverage score difference bounds @xmath26 apply only for @xmath27 .      before even thinking about computation , we need to determine the conditioning of individual leverage scores . to this end , let @xmath0 and @xmath2 be real @xmath7 matrices with @xmath28 , and leverage scores @xmath29 and @xmath24 , @xmath18 , respectively .",
    "we show ( corollary  [ c_1 ] ) that the relative sensitivity of individual leverage scores to subspace rotations is determined by their magnitude .",
    "that is , if @xmath30 is the largest principal angle between @xmath1 and @xmath31 , then @xmath32 thus , large leverage scores tend to be better conditioned , in the relative sense , to subspace rotations than small leverage scores .",
    "the same holds for general perturbations in the two - norm ( theorem  [ t_2 ] ) .",
    "if @xmath33 is the two - norm of the perturbation , then @xmath34 therefore , all leverage scores are ill - conditioned under general norm - wise perturbations , if @xmath0 is ill - conditioned with respect to inversion ; in addition , larger leverage scores are better conditioned than smaller ones .",
    "a bound similar to the one above holds also for projected perturbations @xmath35 , where @xmath36 is the orthogonal projector onto the orthogonal complement of @xmath1 .",
    "the projected perturbations remove the contribution of @xmath3 that lies in @xmath1 .",
    "this is important when @xmath37 is large , but @xmath3 has only a small contribution in @xmath38 .",
    "note that @xmath3 does not change the leverage scores if @xmath39 .      with the conditioning of individual leverage scores now established , we present perturbation bounds that represent the first step in assessing the numerical stability of the qr decomposition for computing leverage scores .    [ [ sections_norm ] ] section  [ s_norm ] +",
    "+ + + + + + + + + + + + + + +    our first result is a bound derived from existing qr perturbation results that make no reference to a particular implementation .",
    "if @xmath40 is the total mass of the perturbation , then the leverage scores @xmath24 computed from a qr decomposition of @xmath2 satisfy @xmath41 therefore , if @xmath3 is a general matrix perturbation , then leverage scores , computed from a qr decomposition of @xmath2 are well - conditioned in the norm - wise sense , provided they have large magnitude and @xmath0 is well - conditioned .",
    "[ [ sections_row ] ] section  [ s_row ] + + + + + + + + + + + + + + +    the next bound is derived from scratch and does not rely on existing qr perturbation results .",
    "again , it makes no assumptions on the matrix perturbation @xmath3 , but is able to recognize norm - wise row - scaling in @xmath3 . if @xmath42 , @xmath18 , are norm - wise perturbations of the rows of  @xmath0 , then the leverage scores @xmath24 computed from a qr decomposition of @xmath43 satisfy @xmath44 the perturbation @xmath45 represents the _ local _ effect of @xmath3 , because it indicates how the @xmath10th relative leverage score difference depends on the perturbation in row @xmath10 of  @xmath0 .",
    "in contrast , @xmath46 , containing the total mass of the perturbation , represents the _ global _ effect on all leverage scores .    a similar bound holds for projected perturbations @xmath47 and @xmath48 , @xmath18 .",
    "[ [ sections_comp ] ] section  [ s_comp ] + + + + + + + + + + + + + + + +    the natural follow up question is : what if @xmath3 does indeed represent a row - scaling of @xmath0 ?",
    "can we get tighter bounds ?",
    "the answer is yes . if @xmath49 , @xmath18 , with @xmath50 , are component - wise row - scaled perturbations , then the leverage scores @xmath24 computed from a qr decomposition of @xmath2 satisfy @xmath51 thus , under component - wise row - scaled perturbations , leverage scores computed with a qr decomposition have relative leverage score differences that depend , to first order , neither on the condition number nor on the magnitudes of the leverage scores .      after each of the bounds presented in sections  [ s_angles ] and [ s_qrpert ] , we perform numerical experiments that illustrate that the bounds correctly capture the relative leverage score differences under different types of perturbations .",
    "we summarize the results in this paper and describe a few directions for future research .",
    "we present the proofs for all results in sections [ s_angles ] and  [ s_qrpert ] .",
    "we determine the absolute and relative sensitivity of leverage scores to rotations of the column space ( section  [ s_a1 ] ) , and to general matrix perturbations in the two - norm ( section  [ s_a2 ] ) .",
    "we show that the leverage scores of two matrices are close in the absolute sense , if the all angles between their column spaces are small ( theorem  [ t_1 ] ) .",
    "larger leverage scores tend to better conditioned in the relative sense ( corollary  [ c_1 ] ) .",
    "principal angles between two subspaces quantify the distance between the spaces in `` every dimension . ''",
    "[ d_angles ] let @xmath0 and @xmath3 be real @xmath4 matrices with @xmath52 , and let @xmath6 and @xmath53 be orthonormal bases for @xmath1 and @xmath31 , respectively .",
    "let @xmath54 be a svd , where @xmath55 and @xmath56 are @xmath57 orthogonal matrices , and @xmath58 is a @xmath59 diagonal matrix with @xmath60 .",
    "then , @xmath61 are the _ principal angles _ between the column spaces of @xmath1 and @xmath62 .    below we bound the absolute leverage score difference in terms of the largest and smallest principal angles .",
    "[ t_1 ] let @xmath0 and @xmath3 be real @xmath4 matrices , with @xmath28 .",
    "then , @xmath63 if , in addition @xmath64 , then also @xmath65    see section [ s_t1proof ] .",
    "theorem [ t_1 ] implies that the leverage scores of @xmath0 and @xmath43 are close in the absolute sense , if the principal angles between their column spaces are small .",
    "theorem  [ t_1 ] holds with equality if @xmath0 and @xmath43 have the same column space , because then the smallest angle @xmath30 is zero , and so is the bound .    in the special case @xmath64 , better bounds are possible because @xmath1 and its orthogonal complement @xmath38 have the same dimension .",
    "in addition to implying @xmath66 for @xmath67 , theorem  [ t_1 ] also implies @xmath68 for @xmath69 , @xmath18 .    next is a bound for the relative leverage score difference in terms of principal angles .",
    "[ c_1 ] under the conditions of theorem  [ t_1 ] , @xmath70    corollary  [ c_1 ] implies that the relative sensitivity of leverage scores to rotations of @xmath1 depends on the magnitude of the leverage scores .",
    "in particular , larger leverage scores tend to be better conditioned .",
    "we illustrate the effect of subspace rotations on the relative leverage score differences @xmath26 .",
    "we compute the leverage scores of a matrix @xmath0 and a perturbation @xmath2 .",
    "the matrix @xmath0 has dimension @xmath71 , @xmath72 , and leverage scores that increase in four steps , from @xmath73 to about  @xmath74 , see figure  [ f_fig1](a ) .",
    "it is generated with the matlab commands @xmath75   [ a,\\sim ] & = & \\mathsf{qr}(a1,0 ) .",
    "\\nonumber   \\end{aligned}\\ ] ] the leverage scores of the perturbed matrix @xmath2 are computed with the matlab qr decomposition @xmath76 .",
    "the perturbations in the following sections are chosen so that they are large enough to dominate the round off errors .     for matrices in ( [ e_a1 ] ) ;",
    "( b)(d ) relative leverage score differences @xmath26 ( blue stars ) and bound for corollary  [ c_1 ] ( red line above the stars ) vs index  @xmath10 for @xmath77 ( b ) , @xmath78 ( c ) , and @xmath79 ( d ) .",
    ", width=528 ]    figure  [ f_fig1](b)(d ) shows the relative sensitivities and the bound from corollary  [ c_1 ] , for perturbations due to increasing principal angles @xmath80 .",
    "the relative leverage score differences decrease with the same step size with which the leverage score magnitude increases .    in figure  [ f_fig1](b ) , where @xmath81 , the relative leverage score differences decrease from @xmath82 for the smallest leverage scores to about @xmath83 for the largest leverage scores .",
    "the differences are larger by a factor of 100 in figure  [ f_fig1](c ) , and again in figure  [ f_fig1](d ) , where the 250 smallest leverage scores have lost all accuracy because they are dominated by the perturbation @xmath84 .",
    "thus , the relative changes in leverage scores are proportional to @xmath84 .",
    "corollary  [ c_1 ] shows the same qualitative behavior as the leverage score differences .",
    "the bound decreases with the leverage score magnitude , and overestimates the worst case differences by a factor of about 100 .",
    "thus , corollary  [ c_1 ] represents a realistic estimate for the relative conditioning of the leverage scores to changes in principal angles .      from the bounds for principal angles in section  [ s_a1 ]",
    ", we derive bounds for the relative leverage score differences in terms of general perturbations in the two - norm , @xmath85 the second perturbation removes the contribution of @xmath3 that lies in @xmath1 .",
    "this is important when @xmath37 is large , but @xmath3 has only a small contribution in @xmath1 .",
    "note that @xmath3 does not change the leverage scores if @xmath39 .",
    "[ t_2 ] let @xmath0 and @xmath3 be real @xmath4 matrices , with @xmath19 and @xmath86 .",
    "then @xmath87 and @xmath88    see section [ s_t2proof ] .",
    "theorem [ t_2 ] implies that relative leverage score differences are bounded by the condition number @xmath89 , a norm wise perturbation , and a function that depends on the size of the leverage scores .",
    "thus , an individual leverage score is well conditioned , if it has large magnitude and if @xmath0 is well - conditioned with respect to left inversion .",
    "the first bound in theorem  [ t_2 ] recognizes , through the use of the projected perturbation @xmath90 , when the column spaces of @xmath0 and @xmath2 are close .",
    "in particular , @xmath91 for @xmath67 . the second bound does not do this , but has the advantage of being simpler .",
    "although the first bound contains a smaller perturbation , @xmath92 , it also has an additional factor of  2 .",
    "therefore it is not clear that , in general , the first bound is tighter than the second one .",
    "we demonstrate that both bounds capture the qualitative behavior of the leverage score sensitivities , but that the first bound appears more accurate when the perturbation has a substantial contribution in @xmath1 .     in [ e_a1 ] and @xmath93 in  [ e_b ] , ( c)(f ) relative leverage score differences @xmath26 ( blue stars ) and bounds from theorem  [ t_2 ] ( red line above the stars ) vs index  @xmath10 , for perturbations",
    "@xmath94 in ( c ) and ( d ) , and @xmath95 in ( e ) and ( f ) . , width=480,height=336 ]    figure  [ f_fig2 ] shows the relative leverage score sensitivities and the bounds from theorem  [ t_2 ] , for perturbations @xmath96 and their projections @xmath97 .",
    "panels ( a ) and ( b ) in figure  [ f_fig2 ] show the leverage scores for perfectly conditioned matrices @xmath0 constructed as in ( [ e_a1 ] ) , and for matrices @xmath93 with @xmath98 and leverage scores like those of @xmath0 , @xmath99 , 10 ^ 6 , 3)}.\\quad   \\end{aligned}\\ ] ] panels ( c)(f ) in figure  [ f_fig2 ] show the relative leverage score differences for @xmath0 and @xmath93 under two - norm perturbations @xmath100 .",
    "panels ( c ) and ( e ) show that the relative leverage score differences from the well - conditioned matrix @xmath0 reflect the leverage score distribution .",
    "that is , the smallest leverage scores have relative differences of about @xmath73 , while the largest leverage scores have relative differences that are several magnitude lower .",
    "the relative leverage score differences of the worse conditioned matrix @xmath93 in panels ( d ) and ( f ) can be as high as @xmath101 , and do not follow the leverage distribution quite as clearly .",
    "therefore , the relative leverage score differences from norm wise perturbations increase with the condition number of the matrix .",
    "panels ( c ) and ( d ) show the bound with @xmath37 in theorem  [ t_2 ] , while ( e ) and ( f ) show the bound for the projected perturbation @xmath102 for both matrices .",
    "note that , as explained above , the bounds with the projected perturbations are not _ guaranteed _ to be tighter , although in this case they are several orders of magnitude more accurate .",
    "we derive bounds for relative leverage score differences for leverage scores that are computed with a qr decomposition .",
    "the bounds assume exact arithmetic and are based on perturbation results for qr decompositions ; they make no reference to particular qr implementations .",
    "specifically , our bounds include : norm - wise bounds for general matrix perturbations ( section  [ s_norm ] ) , bounds for general perturbations that recognize row - scaling in the perturbations ( section  [ s_row ] ) , and bounds for component - wise row - scaled perturbations ( section  [ s_comp ] ) . since the bounds do not exploit the zero structure of the triangular factor in the qr decomposition , they can be readily extended to the polar decomposition as well .",
    "the first bound is derived from a normwise perturbation result for qr decompositions ( * ? ? ?",
    "* theorem 1.6 ) . among the existing and sometimes tighter qr perturbation bounds @xcite , we chose ( * ? ? ?",
    "* theorem 1.6 ) because it is simple and has the required key ingredients .",
    "[ t_4sun ] let @xmath0 and @xmath2 be real @xmath4 matrices with @xmath19 and @xmath103 .",
    "the leverage scores @xmath24 computed from a qr decomposition of @xmath2 satisfy @xmath104    see section [ s_t4sunproof ] .",
    "the perturbation bound in theorem  [ t_4sun ] sends the message that : if @xmath3 is a general perturbation , then leverage scores computed from a qr decomposition of @xmath2 , are well - conditioned in the norm - wise relative sense , if they have large magnitude and if @xmath0 is well - conditioned .",
    "we demonstrate that this conclusion is valid in the following experiment .      for matrices",
    "@xmath0 in ( [ e_a1 ] ) , figure  [ f_fig3 ] shows the relative leverage score differences @xmath26 from norm - wise perturbations @xmath40 and the bound from theorem  [ t_4sun ] , for two different perturbations : @xmath105 and @xmath106 .",
    "( blue stars ) and bound from theorem  [ t_4sun ] ( red line above the stars ) vs index  @xmath10 for @xmath105 ( a ) and @xmath106 ( b ) .",
    ", width=480,height=336 ]    figure  [ f_fig3 ] illustrates that the relative leverage score differences decrease with the same step size with which the leverage score magnitude increases . in particular , for @xmath105 in panel ( a )",
    ", the relative leverage score differences decrease from @xmath82 for the smallest leverage scores to about @xmath83 for the largest leverage scores .",
    "the differences for @xmath106 in panel ( b ) are larger by a factor of 1000 ; the 250 smallest leverage scores have lost all accuracy because they are smaller than the perturbation @xmath46 .",
    "the bound in theorem  [ t_4sun ] differs from the actual differences by several orders of magnitude , but reflects the qualitative behavior of the relative leverage score differences .",
    "the two first - order bounds presented here are based on a perturbation of the qr decomposition .",
    "although the bounds make no assumptions on the perturbations @xmath3 , they are able to recognize row - scaling in @xmath3 of the form @xmath107    [ t_5 ] let @xmath0 and @xmath2 be real @xmath4 matrices with @xmath19 and @xmath108 .",
    "the leverage scores @xmath24 computed from a qr decomposition of @xmath43 satisfy @xmath44    see section  [ s_t5proof ] .",
    "the relative leverage score difference bound for the @xmath10th leverage score in theorem  [ t_5 ] contains three main ingredients :    1 .",
    "the two - norm condition number of @xmath0 with respect to left inversion , @xmath89 .",
    "+ it indicates leverage scores computed from matrices with smaller condition numbers have smaller relative leverage score differences .",
    "2 .   the relative normwise perturbation in the @xmath10th row of @xmath0 , @xmath45 . +",
    "this perturbation represents the _ local _ effect of @xmath3 , because it shows how the @xmath10th relative leverage score difference depends on the perturbation in row @xmath10 of  @xmath0 .",
    "3 .   the total normwise perturbation @xmath46 . +",
    "this is the total relative mass of the perturbation , since @xmath109 represents the _ global _ effect of @xmath3 .",
    "we illustrate that the local effect described above is real by examining the effect of row scaled perturbations on the relative accuracy of leverage scores computed with a qr decomposition .",
    "( blue stars ) and bound from theorem  [ t_5 ] ( red line above the stars ) vs index  @xmath10 for row - wise scaled perturbations with @xmath105 . in",
    "( a ) only rows 501750 of @xmath0 are perturbed , while in ( b ) the perturbation has the same row scaling as  @xmath0.,width=480,height=336 ]    figure  [ f_fig4 ] shows the relative leverage score difference @xmath26 from norm wise perturbations @xmath110 and the bound from theorem  [ t_5 ] . in panel",
    "( a ) , only rows 501750 of @xmath0 are perturbed , while in panel  ( b ) the perturbation has the same row scaling as @xmath0 , that is , @xmath111 , where @xmath112 is of the form ( [ e_a1 ] ) .    in panel",
    "( a ) , the leverage scores corresponding to rows 1500 and 751 - 1000 have relative leverage score differences between @xmath113 and  @xmath73 , which illustrates that the local perturbation in rows 501750 has a global effect on all leverage scores",
    ". however , the leverage scores corresponding to the perturbed rows 501750 have larger relative differences of @xmath114 or more , which illustrates the strong effect of local perturbations .",
    "the bound from theorem  [ t_5 ] hovers around @xmath101 , but is slightly larger for the leverage scores corresponding to the perturbed rows .",
    "thus , theorem  [ t_5 ] is able to detect strongly local row scaling in norm wise perturbations .    in panel",
    "( b ) , almost all leverage scores have relative differences between @xmath73 and @xmath83 , and the bound from theorem  [ t_5 ] is flat at  @xmath101 . thus , the relative leverage scores differences tend to be more uniform when the norm wise perturbations have the same row scaling as the matrix .",
    "this effect is recognized by theorem  [ t_5 ] .",
    "therefore , although theorem  [ t_5 ] makes no assumptions about the perturbations @xmath3 , it is able to detect row scaling in norm wise perturbations , and correctly predicts the qualitative behavior of relative leverage score differences .      the following bound is a refinement of theorem [ t_5 ] that projects out the part of the perturbation that lies in @xmath1 and does not contribute to a change in leverage scores , @xmath115    [ t_6 ] let @xmath0 and @xmath2 be real @xmath4 matrices with @xmath19 and @xmath86 .",
    "the leverage scores @xmath24 computed from a qr decomposition of @xmath2 satisfy @xmath116    see section [ s_t6proof ] .",
    "it is not clear that theorem  [ t_6 ] is tighter than theorem  [ t_5 ] .",
    "first , theorem  [ t_6 ] contains an additional factor of  2 in the bound .",
    "second , although the total projected perturbation is smaller , i.e. @xmath117 , this is not necessarily true for @xmath118 and @xmath45 .",
    "for instance , if @xmath119 then @xmath120 here we have @xmath121 and @xmath122 , so that @xmath123 .      motivated by section  [ s_row ] , where bounds for general perturbations @xmath3 can recognize row scaling in @xmath3 . , we ask the natural follow - up question : what if @xmath3 does indeed represent a row scaling of @xmath0 ?",
    "can we get tighter bounds ?",
    "to this end , we consider componentwise row perturbations of the form @xmath49 , where @xmath124 , @xmath18 , and model them as @xmath125 where @xmath126 are uniform random variables in @xmath127 $ ] , @xmath18 .",
    "we show that , under component wise row - scaled perturbations ( [ e_pertrow ] ) , leverage scores computed with a qr decomposition have relative differences that do not depend , to first order , on the condition number or the magnitudes of the leverage scores .",
    "[ t_8 ] let @xmath0 be a real @xmath7 matrix with @xmath19 , and let the perturbations @xmath3 be of the form ( [ e_pertrow ] ) with @xmath128 .",
    "the leverage scores @xmath24 computed from a qr decomposition of @xmath2 satisfy @xmath129    see section  [ s_t8proof ] .",
    "the quantities @xmath130 represent the local effects of the individual row - wise perturbations , while the factor @xmath131 represents the global effect of all perturbations .",
    "in contrast to our previous results , the bound does not depend on either the condition number or the leverage score magnitude .",
    "we illustrate the effect of component - wise row - scaled perturbations on the relative accuracy of leverage scores that are computed with a qr decomposition .",
    "( blue stars ) and the bound from theorem  [ t_6 ] ( red line above the stars ) vs index  @xmath10 for component wise row - wise scaled perturbations with @xmath132 , @xmath18.,width=480,height=336 ]    figure  [ f_fig5 ] shows the relative leverage score differences from a well - conditioned matrix @xmath0 with @xmath72 in ( a ) , and from a worse conditioned matrix @xmath93 in ( [ e_b ] ) with @xmath133 in ( b ) .",
    "the component - wise row - scaled perturbations from ( [ e_pertrow ] ) are @xmath134 for @xmath18 .",
    "the leverage scores for these types of matrices are shown in figure  [ f_fig2 ] .",
    "figure  [ f_fig5 ] shows that the relative leverage score differences for both matrices look almost the same , hovering around @xmath114 , except for a few outliers .",
    "thus , the relative accuracy of most leverage scores does not depend on the condition number , but a few small leverage scores do show a slight effect . note that theorem  [ t_6 ] is based only on a perturbation analysis , not a round off error analysis of the qr decomposition , and that we did not take into errors arising in the computation of the two norm .",
    "furthermore , figure  [ f_fig5 ] shows that the relative leverage score differences do not depend on the leverage score magnitude .",
    "hence theorem  [ t_6 ] captures the relative leverage score accuracy under component - wise row - scaled perturbations .",
    "we analyzed the conditioning of individual leverage scores ( section  [ s_angles ] ) and took the first steps in assessing the numerical stability of qr decompositions for computing leverage scores ( section  [ s_qrpert ] ) . to this end",
    ", we derived several bounds for the relative accuracy of individual leverage scores .",
    "the bounds are expressed in terms of principal angles between column spaces , and three classes of matrix perturbations : general norm - wise , norm - wise row - scaled , and component - wise row - scaled .",
    "since most of the bounds in section  [ s_qrpert ] do not exploit the zero structure of the upper triangular factor , they are readily extended to polar decompositions as well .",
    "the next step is to extend the results in section  [ s_comp ] to component - wise perturbations @xmath135 , @xmath18 , @xmath136 .",
    "numerical experiments strongly suggest that leverage scores computed from qr decompositions of such perturbed matrices have relative leverage score differences that do not depend on the magnitude of the leverage scores .",
    "the most popular method for computing leverage scores is the singular value decomposition .",
    "the numerical stability of the svd in this context needs to be investigated , and whether the sensitivity of the singular vectors to singular value gaps matters for leverage score computations .",
    "another issue is the numerically stable computation of `` @xmath137-leverage scores '' .",
    "these are leverage scores of the best rank  @xmath137 approximation to @xmath0 in the two - norm .",
    "determining leverage scores from a truncated svd is necessary when @xmath0 is ( numerically ) rank deficient , or when noisy data are well represented , as in the case of pca , by only a few dominant singular vectors .",
    "we present proofs for the results in sections [ s_angles ] and  [ s_qrpert ] .",
    "[ [ expressing - the - perturbed - leverage - scores - in - terms - of - the - exact - ones ] ] 1 . expressing the perturbed leverage scores in terms of the exact ones",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    consider any orthonormal basis for the column spaces : let @xmath139 , where @xmath140 is nonsingular and @xmath141 .",
    "similarly , let @xmath142 , where @xmath143 is nonsingular and @xmath144 .",
    "the leverage scores are @xmath145 and @xmath146 , @xmath18 .    with definition  [ d_angles ] ,",
    "rotate to the basis of principal vectors @xmath147 and @xmath148 , which satisfy @xmath149 .",
    "since the leverage scores are basis independent we can write @xmath150 and @xmath151 , @xmath18 .    the goal is to express @xmath152 in terms of @xmath153 . to this end",
    "choose @xmath154 so that @xmath155 is a @xmath11 orthogonal matrix .",
    "then @xmath156 implies @xmath157 write @xmath158 this gives the desired expressions @xmath159 and @xmath160 from @xmath161 having orthonormal columns follows @xmath162 and @xmath163 at last , we can express the perturbed leverage scores in terms of the exact ones , @xmath164      applying ( [ e_t1a ] ) and ( [ e_t1b ] ) in ( [ e_t1c ] ) gives @xmath165 subtracting @xmath29 on both sides , and omitting the summand with the negative sign gives @xmath166 if @xmath64 , write ( [ e_t1d ] ) as @xmath167              we express @xmath84 in terms of orthogonal projectors onto the column spaces .",
    "let @xmath177 be the orthogonal projector onto @xmath1 , and @xmath178 the orthogonal projector onto @xmath31 .",
    "then ( * ? ? ?",
    "* theorem 5.5 ) , ( * ? ? ? * ( 5.6 ) ) implies @xmath179 from @xmath180 and @xmath181 follows @xmath182 it remains to express @xmath183 in terms of @xmath184 .",
    "the well - conditioning of singular values ( * ? ? ?",
    "* corollary 8.6.2 ) implies @xmath185 where the last inequality is due to the assumption @xmath186 . substituting this into the bound for @xmath84 yields @xmath187 . in turn now , inserting this into corollary  [ c_1 ] , and bounding @xmath188 gives the first bound in theorem  [ t_2 ] .",
    "the second one follows more easily from @xmath189 , see ( * ? ? ?",
    "* ( 4.4 ) ) .",
    "we start with a special case of theorem  [ t_2 ] applied to @xmath7 matrices @xmath6 and @xmath190 with orthonormal columns and leverage scores @xmath145 and @xmath191 .",
    "since @xmath192 , we obtain @xmath193            we start with a simplified version of theorem  [ t_2 ] .",
    "let @xmath6 and @xmath190 be @xmath7 matrices with orthonormal columns , and @xmath145 and @xmath191 , @xmath18 , their leverage scores . multiplying out the inner product in @xmath24 and using triangle and submultiplicative inequalities",
    "gives @xmath199 next we derive bounds for @xmath200 in terms of @xmath3 . to this end",
    "we represent the perturbed matrix by a function @xmath201 , with a smooth decomposition @xmath202 .",
    "this is a very common approach , see for instance ( * ? ? ?",
    "* section 3 ) , ( * ? ? ?",
    "* section 4 ) , ( * ? ? ?",
    "* section 3 ) , ( * ? ? ?",
    "* section 5 ) , ( * ? ? ?",
    "* section 2.1 ) ( * ? ? ?",
    "* section 2.4 ) , ( * ? ? ?",
    "* section 3 ) , ( * ? ? ?",
    "* section 2 ) , ( * ? ? ?",
    "* section 4 ) , ( * ? ? ?",
    "* section 5 ) , and ( * ? ? ? * section ) .",
    "the existence of two derivatives allows us to take a taylor expansion of @xmath218 around @xmath221 , and get @xmath222 .",
    "evaluating at @xmath223 gives @xmath224 to get an expression for @xmath225 , differentiate @xmath204 , @xmath226 and evaluate at @xmath221 , @xmath227 inserting the above into ( [ e_t7a ] ) gives the expression for @xmath220 in theorem  [ t_5 ] .",
    "differentiating @xmath229 gives @xmath230 and evaluating at @xmath221 yields @xmath231 multiplying by @xmath232 on the left and by @xmath233 on the right gives @xmath234 now we take advantage of the fact that @xmath235 is upper triangular , and define a function that extracts the upper triangular part of a square matrix @xmath171 via @xmath236 applying the function to ( [ e_t7c ] ) gives @xmath237 taking norms yields ( * ? ? ?",
    "* equation ( 3.5 ) ) @xmath238    now we are ready to derive a bound for the row norms of @xmath220 . combining the two bounds from theorem  [ t_7 ] , that is , inserting @xmath214 into @xmath239 gives @xmath240 into the first summand substitute @xmath241 and",
    "obtain @xmath242 inserting the above into ( [ e_pertq ] ) and focussing on the first order terms in @xmath46 gives theorem  [ t_5 ] .      to remove the contribution of @xmath3 in @xmath1 , let @xmath243 be the orthogonal projector onto @xmath1 , and",
    "@xmath244 the orthogonal projector onto @xmath38 .",
    "extracting the contribution in @xmath1 gives @xmath245 where @xmath246 and @xmath247 .      here",
    "@xmath248 , because @xmath177 is an orthogonal projector , so that @xmath249 .",
    "with @xmath250 this implies @xmath251 .",
    "furthermore @xmath252 .",
    "thus @xmath253 and @xmath254 have thin qr decompositions @xmath255 and @xmath256 , and have the same leverage scores @xmath29 and @xmath24 , respectively , as @xmath0 and @xmath2 .",
    "ultimately , we want to apply theorem  [ t_5 ] to @xmath253 and @xmath254 , but the perturbation @xmath257 is to be related to @xmath0 rather than to @xmath253 , and the bound is to be expressed in terms of @xmath89 rather than @xmath258 .          combining ( [ e_t7e ] ) and",
    "( [ e_t7f ] ) gives @xmath263 from @xmath264 follows @xmath265 it remains to express @xmath266 in terms of @xmath184 .",
    "the well - conditioning of singular values ( * ? ? ?",
    "* corollary 8.6.2 ) applied to @xmath267 , where @xmath268 , implies @xmath269 where the last inequality is due to the assumption @xmath270 . inserting this bound for @xmath266 into ( [ e_t7 g ] ) yields @xmath271 at last ,",
    "substituting the above into ( [ e_pertq ] ) and focussing on the first order terms in @xmath272 gives theorem  [ t_6 ] .",
    "as in the proof of theorem  [ t_5 ] , we start with ( [ e_pertq ] ) . to derive bounds for @xmath200 in terms of @xmath130 and @xmath278 , represent the perturbed matrix by @xmath279 let @xmath204 be a thin qr decomposition , where @xmath205 , @xmath206 , @xmath280 and @xmath281 .",
    "the derivative of @xmath209 with respect to @xmath210 is @xmath211 .",
    "theorem  [ t_7 ] implies @xmath282 with @xmath283 this gives @xmath284 taking norms gives @xmath285 from ( [ e_rr ] ) follows @xmath286 combining this with ( [ e_pertq3 ] ) yields @xmath287 inserting the above into ( [ e_pertq ] ) and focussing on the first order terms in @xmath278 gives theorem  [ t_8 ] .",
    "height 2pt depth -1.6pt width 23pt , _ subspace sampling and relative - error matrix approximation : column - based methods _",
    ", in approximation , randomization and combinatorial optimization , vol .",
    "4110 of lecture notes in comput .",
    "sci . , springer , berlin , 2006 , pp .",
    "316326 .                                        height 2pt depth -1.6pt width 23pt , _ on angles between subspaces of a finite dimensional inner product space _ , in matrix pencils , b.  kgstrm and a.  ruhe , eds .",
    "973 of lecture notes in mathematics , springer , berlin , 1983 , pp ."
  ],
  "abstract_text": [
    "<S> the leverage scores of a full - column rank matrix @xmath0 are the squared row norms of any orthonormal basis for @xmath1 . </S>",
    "<S> we show that corresponding leverage scores of two matrices @xmath0 and @xmath2 are close in the relative sense , if they have large magnitude and if all principal angles between the column spaces of @xmath0 and @xmath2 are small .    </S>",
    "<S> we also show three classes of bounds that are based on perturbation results of qr decompositions . </S>",
    "<S> they demonstrate that relative differences between individual leverage scores strongly depend on the particular type of perturbation @xmath3 . </S>",
    "<S> the bounds imply that the relative accuracy of an individual leverage score depends on : its magnitude and the two - norm condition of @xmath0 , if @xmath3 is a general perturbation ; the two - norm condition number of @xmath0 , if @xmath3 is a perturbation with the same norm - wise row - scaling as @xmath0 ; ( to first order ) neither condition number nor leverage score magnitude , if @xmath3 is a component - wise row - scaled perturbation . </S>",
    "<S> numerical experiments confirm the qualitative and quantitative accuracy of our bounds .    </S>",
    "<S> principal angles , stable rank , condition number , row - scaling , component - wise perturbations    65f25 , 65f35 , 62j20 , 68w20 , 15a12 , 15a23 </S>"
  ]
}