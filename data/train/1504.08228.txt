{
  "article_text": [
    "signal generation is half the world of electronics , the electronic oscillator is ubiquitous , it has a part in all consumer , professional and scientific appliances and most often the quality of the generated signal is crucial to the overall performances .",
    "after the problems of accuracy , stability , adjustability and resolution , one of the main concern in today signal generation is spectral purity , either harmonic content or non - harmonic wide and narrow band noise .    the fact that a sinusoidal signal at the output of an oscillator never is truly _",
    "monochromatic _ in the mathematical sense , but has a _ line - width _ and noise side bands , has important implications .",
    "for example , it reduces the possibility for a radio receiver to discriminate a week signal close to a strong one ( @xcite ) .    the first paper on this subject i am aware of is chapter 15 in edson s `` vacuum tube oscillators '' @xcite .",
    "in this work edson assumed that an electronic oscillator could be considered an almost linear system whose nonlinearities gave a negligible contribution to the spectral composition of the signal .",
    "edson s model for an oscillator was a sort of enhanced q - multiplier brought to the limit of hugely amplifying and filtering the thermal noise always present in any real circuit . in this model the gain of the positive feedback loop was smaller than unity by an infinitesimal amount , to accomodate for the noise power at the amplifier input .",
    "the equivalent @xmath1 of the circuit resulted very very high , but not infinite , and its selectivity accounted for the lorentzian shape of the generated signal spectrum , in agreement with experimental observations .",
    "this model could account for the presence of the narrow noise skirt on sides of the generated signal ( the carrier ) and for the 20 db intensity decay per decade of frequency moving away from the carrier .",
    "this work did receive little attention and was little quoted in the literature in the years following .",
    "the author himself declared that he `` was never fully satisfied with the results from this approach ... '' @xcite , to the point that , a few years after the book , he published a completely new paper on the same argument @xcite .",
    "moreover , experimental studies soon demonstrated the presence of a @xmath2 noise component in the frequency region nearest to the carrier , that edson s model could not explain , not even including some amount of non linearity .",
    "yet , edson s model had the great virtue of being very clear to understand and of directly connecting noise characteristics with electrical circuit parameters .",
    "other works followed shortly after . in @xcite leeson approached the problem from an heuristic point of view , presenting an equation that described the commonly observed spectrum of feedback oscillators .",
    "this paper , though very popular in the following works , did not face the problem of connecting the observed noise spectrum properties with the electrical circuit characteristics .",
    "little later lax laid the basis for approaching the problem through statistics and interest into the argument was paralleled by an analogous interest for the line width of a laser generated light beam @xcite .",
    "recently interest into oscillator noise has greatly increased because of its relevance in the performance of telecommunication networks , both digital and analog , wired and wireless , as documented by the large number of recent contributions to the literature .",
    "see , e.g. , @xcite and references therein .",
    "these works , as well as lax s one , greatly deepened the theoretical analysis of the stochastic processes behind the phase noise origin .",
    "they make large use of concepts and arguments from the world of statistics , at the expense , though , of somewhat missing a clearcut connection with the physical circuit , its parameters and its behaviour .    in @xcite , e.g. , the analogy has been used between the oscillator signal phase fluctuations and the process of molecular diffusion . as suggestive and appropriate as it can be by principle such a connection ,",
    "its application to the study of phase noise in oscillators can help only from a qualitative point of view .",
    "otherwise , a double effort would be required first to correlate circuit equations with molecular processes and then to bring results from molecular behaviour back into the circuits realm .",
    "a consequence of this state of affairs from a didactic point of view is that the subject is often relegated to books and courses of electronics at the highest specialization level or is proposed through an heuristic and qualitative only approach , following leeson s approach ( see , e.g. , @xcite ) .    in this paper",
    "i will try to approach the problem making profit of the large and good amount of work already available , through a simple but rigorous enough way , making use mostly of those concepts familiar to the world of electronics like johnson s noise , modulation , frequency conversion and vectorial ( de)composition .",
    "clearly , some mathematical extras to this menu are unavoidable , not to remain at the qualitative and descriptive level only .",
    "they are the central limit and the wiener - khinchin theorems and some properties of gaussian distributions .",
    "luckily enough , currently they are well established and widely known theorems , also at the student level .",
    "the path i shall propose in this paper easily lends itself to the implementation of numerical experiments , very useful from a didactic point of view to illustrate the theoretical concepts and enhance confidence into the results obtained through equations .",
    "it is a common practice in a linear system to group all noise sources into a single one , conveniently placed and with an equivalent effect on the output signal .    in this paper",
    "i have chosen not to follow this way for the sake of the simmetry both in the circuit and in the equations that will be written .",
    "the cost of this choice will be that most equations will contain the sum of two equivalent terms , one for current , one for voltage , with no further increase in complexity .",
    "the advantage will be a clearer splitting of noise into amplitude and phase components and the possibility to introduce into the circuit some non linear behaviour without having to deal with the violation of the primary hypothesis `` in a linear system '' intrinsic to the common practice . in the last ,",
    "as expected , it will be clear that the total noise power is the unique meaningful quantity in evaluating phase noise .    in an electronic oscillator , like in every harmonic oscillator , unavoidable sources of noise are the dissipative elements associated with the two energy storing components of the resonator , most often an inductance @xmath3 and its series resistance @xmath4 and a capacitance @xmath5 and its parallel conductance @xmath6 ( fig .  1 ) .",
    "the dissipative elements @xmath4 and @xmath6 are responsible both for the introduction of thermal noise into the circuit , a random voltage @xmath7 and current @xmath8 associated with resistance @xmath4 and conductance @xmath6 , and for the resonator damping .     a typical resonator in an electronic oscillator is composed by an inductance @xmath3 and a capacitance @xmath5 , together with their resistance @xmath4 and conductance @xmath6 , that account for losses .",
    "the two generators @xmath9 and @xmath10 are the noise sources inseparably linked to the dissipative elements . ]    actually , in a stationary oscillator values of damping and noise generation are disjoined from the physical values of @xmath4 and @xmath6 , because of circuits and devices that provide the positive ( regenerative ) feedback indispensable to add a negative damp that cancels out the natural ( positive ) damp of the resonator and allows a persistent oscillation to be sustained .",
    "these circuits and devices introduce their own noise contributions that add to @xmath9 and/or @xmath10 .    as a consequence",
    ", the value of @xmath4 and @xmath10 and of @xmath6 and @xmath9 can be considered uncorrelated , only with the constraint that the spectral density @xmath11 and @xmath12 of @xmath7 and @xmath8 can not be lower than what due respectively to the @xmath4 and @xmath6 of the physical circuit , namely @xmath13 where @xmath14 is boltzmann s constant and @xmath15 absolute temperature .",
    "so , it is possible to consider the practical case where damping is kept to zero by regeneration , i.e. @xmath4 and @xmath6 are nulled by equivalent negative terms , but some noise , both @xmath10 and @xmath9 , is present in the circuit . after putting some energy @xmath16 into @xmath3 and @xmath5",
    "there will be a persistent stationary oscillation .",
    "for the sake of simplicity , let s consider the initial conditions @xmath17 and @xmath18 at @xmath19 so that , in the absence of noise , oscillation would be @xmath20 with , as usual , @xmath21 and @xmath22    in the state space described by the @xmath23 circuit variables in absence of noise the representative point @xmath24 of the system describes , as well known , a circle with constant angular velocity @xmath25 . in the presence of noise both the trajectory and angular velocity of the point",
    "are perturbed , as described in fig .",
    "2 .     decomposition of independent noise contributions @xmath26 and @xmath27 into the radial @xmath28 and tangential @xmath29 parts .",
    "normalization of the @xmath30 , @xmath31 , @xmath32 and @xmath33 variables over @xmath34 and @xmath35 as expressed by eq .",
    "( [ eq : psq ] ) is not shown to avoid cluttering the figure and should be implicitly assumed . ]      by effect of noise current @xmath9 and voltage @xmath10 , in a time @xmath36 charge upon capacitor @xmath5 and current through inductor @xmath3 change by an amount ( with effective @xmath37 and @xmath38 ) @xmath39    as @xmath10 and @xmath9 are statistically independent random variables , so are @xmath33 and @xmath32 .",
    "whatever their instantaneous values , @xmath33 and @xmath32 can always be decomposed into a tangential @xmath29 and a radial @xmath28 part as shown in fig .",
    "2 , with : @xmath40    the effects of @xmath29 and @xmath28 over the motion of point @xmath24 are independent each other : @xmath28 changes the oscillation amplitude @xmath41 , @xmath29 its phase @xmath42 by the amount @xmath43 .",
    "there is only a small link left between phase and amplitude fluctuations .",
    "if the noise generators @xmath9 and @xmath10 are stationary , as usual , their _ rms _ amplitudes remain constant .",
    "hence , the same amount of noise from @xmath9 and @xmath10 yields a different effect on @xmath43 , depending upon the instantaneous value of amplitude @xmath41 . but",
    "this effect is vanishingly small indeed . in a real system the standard deviation of the @xmath41 fluctuations",
    "is many orders of magnitude smaller than the @xmath41 average value : nobody would be concerned in a change of one part per million of a noise source relative intensity .    by standard analytical geometry relations , the transformation @xmath44 holds .",
    "thereafter , by transforming a couple of values @xmath45 by eqs .",
    "( [ eq : dp]-[eq : dt ] ) , zeroing alternatively the @xmath28 or @xmath29 part and transforming back with the inverse of ( [ eq : dp]-[eq : dt ] ) , two couples of components @xmath46 and @xmath47 are obtained that sum up to give the original @xmath45 values , but yield each one only a @xmath29 or @xmath28 perturbation : @xmath48 with @xmath49 .    using these equations",
    "it is possible to decouple the @xmath29 and @xmath28 components of the random motion of the representative point @xmath24 in the state space and go on studying their effect independently each other .    clearly , in a completely linear circuit as in fig .  1",
    ", such a decomposition is only a mathematical formalism .",
    "actual voltage and current will be given only by the sum of the two components and will be the linear response of the _ lrcg _ network under the action of the @xmath10 , @xmath9 generators .",
    "but , when the circuit will be modified in order to suppress one of the two noise components , namely the amplitude fluctuations , and this can be obtained only through the unavoidable introduction of a suitable non linear behaviour , then the remaining tangential component ( the phase fluctuations ) will describe the true physical current and voltage .      by definition of angular frequency and using eq .",
    "( [ eq : dt ] ) @xmath50 this equation expresses how noise voltage and current from the @xmath10 and @xmath9 sources induce fluctuations in the phase @xmath42 of the oscillator signal . the two quantities @xmath51 and @xmath52 represent the amplitude of the oscillation ( the envelope ) and its evolution over time . in any real oscillator of practical interest ,",
    "the amplitude is controlled by some kind of stabilization mechanism , as described in the next section ; hence in eq .",
    "( [ eq : d_phi ] ) amplitude drift can be neglected and @xmath41 does not move from the initial value @xmath53 .",
    "this yields @xmath54 the effect of the phase fluctuations is clearly the introduction of a frequency modulation over @xmath25 . in the conditions that are common in real ( and useful ) oscillators this effect is very very small indeed , hence it is safe to write @xmath55 and @xmath56 ( but in the numerical experiments the differential equations of the circuit will be integrated without using such an approximation ) .",
    "if @xmath9 and @xmath10 are statistically independent sources of white noise , as it is the case for johnson s noise in resistors , they have a uniform spectral density .",
    "hence , the product of their components with the @xmath57 and @xmath58 oscillations at frequency @xmath25 has the effect of folding their constant spectral density over itself , yielding again a constant spectral density . under such conditions ,",
    "the spectral density as a function of frequency @xmath59 of the resulting oscillation around frequency @xmath60 is the lorentzian curve ( normalized to unitary power over the full frequency range ) @xmath61 where @xmath62 is the _ line - width _ of the generated signal .",
    "the path from eq .",
    "( [ eq : omega - n ] ) to ( [ eq : lorentzian ] ) contains all the mathematical difficulties , so widely described in the literature .",
    "it is possible to travel this path in three steps , making use of two widely known theorems ( central limit and wiener - khinchin theorem ) and an established property of gaussian distributions .",
    "all of this will be used here without any demonstration , that is left to appropriate textbooks .",
    "the starting point is the requirement that @xmath9 and @xmath10 be white noise sources .",
    "it is not necessary they have a gaussian distribution .",
    "usually , @xmath63 will not have a gaussian distribution , apart some very special conditions , because the product of @xmath9 and @xmath10 with the @xmath57 and @xmath58 functions in eq .",
    "( [ eq : omega - n ] ) would alter their original gaussian distribution , if any . in any case",
    ", @xmath64 _ will have _ a gaussian distribution , as stated by the central limit theorem , because @xmath64 results from the sum of infinitely many independent random contributions , as seen in eq .",
    "( [ eq : phi(t ) ] ) .",
    "the second step is to obtain the time autocorrelation function @xmath65 for the signal at the output of the oscillator , namely for the @xmath66 $ ] or the @xmath67 $ ] function .    following @xcite , using the complex notation ,",
    "this can be written as @xmath68 } \\right >",
    "\\right\\ } \\nonumber\\end{aligned}\\ ] ] where @xmath69 is the oscillation amplitude and the @xmath70 brackets are a short for the @xmath71 computation .    here",
    "the properties of the gaussian distribution play their part . using the gaussian moment theorem , it is possible to write @xmath72 } \\right > = e^{- { 1 \\over 2 } \\left",
    "< \\left [ \\varphi_n(t ) - \\varphi_n(t + \\tau ) \\right]^2 \\right > \\label{eq : m_theorem } } \\ ] ]    a short but clear demonstration for this can be found in @xcite and references therein .",
    "evaluation of the exponent in the right hand side of eq .",
    "( [ eq : m_theorem ] ) is easier if it is made in a discrete time framework , like in the numerical integration of the circuit differential equations in the numerical experiments .",
    "it has been supposed that noise generators are stationary , hence time average can be replaced by variance ( indicated by the overline ) : @xmath73 ^ 2 \\right > = \\overline { \\left [ \\varphi_n(0 ) -",
    "\\varphi_n(\\tau ) \\right]^2 } = \\overline{\\varphi_n^2(\\tau)}\\ ] ]    at every @xmath74 time step , @xmath64 increases by the amount @xmath75 .",
    "increments are random and uncorrelated , hence sum quadratically .",
    "after @xmath76 time steps @xmath77    it is to be recognized that @xmath78 is the spectral density of @xmath63 ( this will be made clear in the description of the numerical experiments ) : @xmath79 where @xmath80 has dimensions of @xmath81 .",
    "the final form of the autocorrelation function is @xmath82    the third and last step is the application of wiener - khinchin theorem that states that the spectral distribution @xmath83 of a stationary random sequence is linked to the fourier transform of its autocorrelation function : @xmath84 applying the theorem to function ( [ eq : s(tau ) ] ) @xmath85 +       \\cos[(\\omega_0 + \\omega ) \\tau ] \\right\\ } d\\tau \\nonumber\\end{aligned}\\ ] ] the rapidly oscillating term with frequency @xmath86 gives a negligible contribution to the integral and can be dropped ( the integral goes rapidly to zero when @xmath87 moves away from @xmath25 ) . developing the integral of the remaining term , the lorentzian of eq .",
    "( [ eq : lorentzian ] ) is obtained , with @xmath88    this result is illustrated in the numerical experiments paragraph , in the first numerical experiment , where only the components ( @xmath89 , @xmath90 ) from the full noise sources ( @xmath10 , @xmath9 ) will be applied to the resonant circuit .",
    "the oscillation amplitude will remain constant and the well known lorentzian noise distribution will appear on sides of @xmath25 .      as anticipated above , every oscillator of practical interest has some kind of regulation mechanism that controls the oscillation amplitude .",
    "there is a twofold requirement for this .",
    "first , the condition for persistent oscillation is that the damping given by @xmath4 and @xmath6 be canceled out ( it does not make a great difference if each one separately , as considered in this work , or together as a whole ) .",
    "this is accomplished , as well known , using a positive feedback , that introduces into the circuit a negative @xmath91 and/or @xmath92 that _ exactly _ compensates the @xmath4 and @xmath6 damping effect .    the word _",
    "exactly _ is a term out of the realm of physics or engineering ; however accurate a compensation is made , it will not be _ exact _ but for a short instant , thereafter a drift of one kind or another will make damping move away from zero and make the oscillation rise or decay .",
    "only a negative feedback regulation mechanism can continuously compare actual oscillation amplitude with a reference value and adjust the negative damping to contrast any drift .",
    "indeed , in a matematical sense damping can be made exactly null .",
    "this has been assumed in all the numerical experiments , not inserting into the oscillator circuit either @xmath4 or @xmath6 .",
    "but in the second numerical experiment the two noise sources @xmath9 and @xmath10 will exchange energy with the @xmath93 resonator and make the oscillation amplitude fluctuate in a random way .    the current generator @xmath9 , for example , will induce a disturbance in the voltage across condenser @xmath5 whose spectral amplitude will be @xmath94 at the resonance frequency @xmath95 expression ( [ eq : vcn ] ) diverges , and indeed this is what would happen , given an infinitely long time .",
    "but the presence of the regulation mechanism , that can not be avoided for the reasons explained above , keeps under control and limits the amplitude fluctuations also . and",
    "this is the second reason the regulation mechanism is needed .",
    "one of the simplest conceivable regulation mechanism is a first order control loop described by the equation @xmath96 that has a stationary asynthotic solution @xmath97 and a transient behaviour given by an exponential relaxation with time constant @xmath98 .",
    "the dynamical behaviour of the solution of this equation is analogous to the oscillation amplitude decay in a resonant circuit with resonance frequency @xmath25 and figure of merit @xmath0 : @xmath99 with @xmath100 similar equations hold for @xmath101 .",
    "hence the behaviour we should expect for the noise induced amplitude fluctuations is the excitation of a resonance around frequency @xmath25 with a bandpass @xmath102 .",
    "this process is akin to the _ virtual damping _ in @xcite and will be illustrated in the second numerical experiment .",
    "the scenario outlined up to now is completely consistent if it is recognized that considering only the ( @xmath89 , @xmath90 ) couple of components of the ( @xmath10 , @xmath9 ) noise in the circuit while discarding the ( @xmath103 , @xmath104 ) components is fully equivalent to suppressing such fluctuations through a very efficient amplitude regulation mechanism , as expressed by eq .",
    "( [ eq : dpdt ] ) .      from eqs .",
    "( [ eq : omega]-[eq : omega - n ] ) it is clear that if @xmath9 and @xmath10 are _ coloured _ noise sources , also the resulting spectrum for @xmath63 will be coloured , hence the main mathematical assumption in derivation of result ( [ eq : lorentzian ] ) will no more hold and the spectrum of the generated signal mostly will not be a lorentzian curve .",
    "it is out of the purpose of this paper to analyze in any detail the implications of eqs .",
    "( [ eq : omega]-[eq : omega - n ] ) with non - white @xmath10 and @xmath9 noise sources . for a deeper analysis see , e.g. , @xcite .",
    "only an attempt has been made to illustrate the point , with the third numerical experiment where coloured noise sources have been used for @xmath10 and @xmath9 .",
    "numerical experiments have been carried out using the circuit of fig .  1 and numerically integrating the circuit differential equations in the presence of the two noise generators @xmath9 and @xmath10 .",
    "the computational engine of the spice program @xcite is a very well optimized computer application to perform this task . in this work",
    "all computations have been made using version 24 of _ ngspice _",
    "@xcite , an actively maintained open source variety of spice , and the _ fftw _ library @xcite to compute by fast fourier transform ( fft ) frequency spectra from temporal sequences ( this library also available as open source ) .",
    "all computations that will be described can be afforded using a medium - high range pc , but their repetition to improve results quality by averaging noise spectra can be very time consuming . hence , most of the repetitive work has been performed using an hp proliant dl560 gen8 machine equipped with 64 processors and @xmath105 ram .",
    "the basic machinery used for the first numerical experiment can be seen in the following spice list :    .... * * * experiment 1 * * *    l1    0   2    159.154943092e-6 ic=1 c1    1   0    159.154943092e-6 ic=0 vnv   3   0    dc 0 trnoise(100 m 10u 0 0 0 0 0 ) vni   4   0    dc 0 trnoise(100 m 10u 0 0 0 0 0 ) bwn   5   0    v = v(1)*v(3)-i(bvg)*v(4 ) bvg   2   1    v = v(1)*v(5 ) big   1   0    i =- i(bvg)*v(5 )    .control set nobreak set numdgt=12 tran 10u   10000 m   0 m   0.1u   uic linearize print v(1 ) i(l1 ) > data.out quit .endc ....",
    "values for @xmath3 and @xmath5 ( ` l1 ` and ` c1 ` ) have been chosen to give a resonance frequency @xmath60 as close as possible to @xmath106 to reduce the noise generated by truncation during fft ( in the experiments when phase is not affected ) and have been set numerically equal to avoid unneeded computational overheads .",
    "this way equal amplitudes on ` vnv ` and ` vni ` give equal contribution to overall noise power .",
    "there should be no loss of generality in this choice .",
    "the two generators ` vnv ` and ` vni ` are white noise voltage sources that yield random sequences of values with a gaussian amplitude distribution and _ rms _ value @xmath107 .",
    "the cadence of the computed signals has been set to @xmath108 , hence nyquist s frequency is @xmath109 and the resulting noise spectral density is @xmath110 ( @xmath111 in a @xmath112 bandwidth ) .    in a similar way the random variable @xmath63 of eq .",
    "[ eq : omega - n ] with variance @xmath113 has spectral density @xmath114 as given in eq .",
    "[ eq : omega - n2 ] .",
    "generator ` bwn ` is a convenience to obtain an intermediate result and can be used to draw distributions of @xmath63 , as in fig .  5 below .    two further controlled generators ( ` bvg ` and ` big ` ) transform the independent voltages from ` vnv ` and",
    "` vni ` into the pair of values @xmath89 , @xmath90 given by equations ( [ eq : vnt]-[eq : int ] ) and play the role of @xmath10 and @xmath9 in the circuit .    because the numerical values of @xmath3 and @xmath5 have been chosen to be equal , if the amplitude of the oscillation remains constant and equal to @xmath115 ( both @xmath116 and @xmath117 ) , with the given initial conditions @xmath118 and @xmath119 can be written simply as @xmath120 namely , @xmath121 and @xmath122 .",
    "first of all , the computational engine has been tested _ idle _ , i.e. performing computations with the amplitude of ` vnv ` and ` vni ` generators set to zero , for a time length of @xmath123 .",
    "plot of @xmath30 vs.  @xmath31 without noise ( _ a _ , left ) and with a noise of @xmath124 ( _ b _ , right ) .",
    "computational length : @xmath123 ( 1000 cycles ) .",
    ", title=\"fig : \" ]   plot of @xmath30 vs.  @xmath31 without noise ( _ a _ , left ) and with a noise of @xmath124 ( _ b _ , right ) .",
    "computational length : @xmath123 ( 1000 cycles ) . ,",
    "title=\"fig : \" ]    the results are shown in fig .",
    "3__a _ _ , where values in the data file ` data.out ` have been plotted as @xmath30 vs.  @xmath31 , i.e. , ` i(l1 ) ` vs. ` v(1 ) ` .",
    "the plot covers @xmath125 cycles , each cycle containing @xmath126 equally spaced samples and confirms phase coherence and amplitude stability of the computational engine over such a time length ( indeed , a more accurate analysis shows a decay in amplitude of @xmath127 ) .",
    "the noise floor due to the overall arithmetic accuracy is about @xmath128 ( or @xmath129 ) in a @xmath112 bandwidth .",
    "the computations described above have been repeated activating the noise generators ` vnv ` and ` vni ` at levels of @xmath130 , @xmath131 and @xmath132 over a time length up to @xmath133 , in order to obtain a frequency resolution of @xmath134 . the plot in fig .",
    "3__a _ _ changes , in that points do not repeat with the periodical cadence of @xmath135 , rather scatter continuously all over the circumference .",
    "neverthless the radius remains unitary , thanks to the behaviour of the ` bvg ` and ` big ` generators that suppress the @xmath28 component from each couple of @xmath10 , @xmath9 values , leaving only the @xmath29 component ( fig .",
    "3__b _ _ ) .",
    "spectral amplitude in a @xmath112 bandwidth of the @xmath31 signal across the @xmath5 capacitor in the presence of the @xmath89 and @xmath90 components only of the @xmath10 and @xmath9 noise generators .",
    "noise generators intensity : @xmath136 , @xmath126 and @xmath137 .",
    "results from the numerical experiment ( dots ) are plotted in comparison with lorentz s function ( solid lines ) .",
    "the @xmath62 parameter computed from eq .",
    "( [ eq : omega - n2 ] ) and ( [ eq : sigma ] ) is @xmath138 , @xmath139 and @xmath140 respectively from the lower to the upper curve ) .",
    "no time windowing has been applied with fft , because the noise contribution due to truncation is @xmath141-@xmath142 below the curves shown in the plot and becomes visible only for noise generators amplitude of @xmath143 or smaller .",
    "each curve obtained averaging results from 15 repetitions of the experiment , with a time length of @xmath133 . ]    the spectral amplitude of the generated @xmath31 signal across capacitor @xmath5 is shown in fig .  4 , together with the computed lorentzian distributions , with the @xmath62 values obtained from eq .  ( [ eq : omega - n2 ] ) and ( [ eq : sigma ] ) . the spectra for current @xmath30 through inductance @xmath3",
    "are identical and are not shown .",
    "the computations have been repeated again using for ` vnv ` and ` vni ` two generators with a uniform values distribution instead of a gaussian one , with _",
    "rms _ amplitude @xmath137 ( interval @xmath144 ) :    .... vnv   3   0   dc 0 trrandom ( 1 10u 0 346.4 m ) vni   4   0   dc 0 trrandom ( 1 10u 0 346.4 m ) ....    and once more with a single gaussian generator , either ` vnv ` or ` vni ` , with an _ rms _ amplitude @xmath145 .",
    "the distributions of the @xmath75 values given by eq .",
    "( [ eq : omega - n ] ) for the three cases are shown in fig",
    ".  5 , on the left . only the special case of the first computation exhibits a gaussian distribution .",
    "nevertheless , the other two cases also yield the same identical lorentzian spectral amplitudes , as shown in the bode plots on the right . in all cases , the gaussian form of the @xmath64 distribution",
    "is granted by effect of the central limit theorem and can be seen examining the sum of a few consecutive values of @xmath75 .      in order to apply amplitude only fluctuations to the circuit , without affecting the phase , generators ` bvg ` and ` big ` are to be modified according to eq .",
    "( [ eq : vnp]-[eq : inp ] ) . in this case",
    "@xmath41 can not be considered any more a constant , so that @xmath146 thanks to the numerical equivalence of @xmath3 and @xmath5 the work can be done substituting the ` bwn ` , ` bvg ` and ` big ` generators in the spice list of the first numerical experiment with    .... bpq    20   0    v = v(1)*v(1)+i(bvg)*i(bvg ) bpp    21   0    v=(v(4)*v(1)+v(3)*i(bvg))/v(20 ) bvg     2   1    v = i(bvg)*v(21 ) big     1   0",
    "i = v(1)*v(21 ) ....    here also , generators ` bpq ` and ` bpp ` are only a convenience , to avoid the repetition of a relatively long computation common to both ` bvg ` and ` big ` .",
    "6 shows the results obtained with such a machinery with the @xmath147 plot ( right ) and the @xmath30 vs.  @xmath31 plot ( left ) . from the figure it is clear that now the phase proceeds at the constant angular speed of @xmath148 per step ( i.e. , @xmath149 ) without any disturbances , while amplitude fluctuates by effect of energy exchange with the @xmath10 and @xmath9 generators . in the long time",
    "the oscillation amplitude would fluctuate without a limit , as usual also for the phase , unless a phase lock mechanism to some time reference is used .",
    "amplitude fluctuations in the oscillation amplitude during @xmath123 with amplitude of vnv and vni noise generators set to @xmath150 . ]    in any case , an amplitude regulation mechanism is necessary for the reasons already explained .",
    "even the purely computational approach of spice applied to an ideal circuit is not completely free from drift , as quoted in the introduction to the numerical experiments .    the amplitude control expressed by eq .",
    "( [ eq : dpdt ] ) has been implemented computing the instantaneous deviation of energy in the circuit with respect to the reference value @xmath16 @xmath151 and using this quantity as an error signal to actuate the radial only correction @xmath152 this can be split into the @xmath33 and @xmath32 components : @xmath153 combining these expressions with equation ( [ eq : dv - di ] ) and ( [ eq : error ] ) , the correction current and voltage @xmath154 and @xmath155 result : @xmath156 these corrections can be applied to the circuit adding their values to generators bvg and big , e.g. through generator bpp , modifying its definition into    ....",
    "bpp   21 0   v=(v(4)*v(1)+v(3)*i(bvg))/v(20)+ +                        ( sqrt(v(20))-1)*k ....    and adding the command `` .param k= ... '' to set the appropriate value for the k constant .",
    "computations have been performed with an amplitude of @xmath157 for the vnv and vni generators and values of k from @xmath158 to 1 .",
    "results are shown in fig .  7 , together with the expected resonance curves .",
    "the value of @xmath0 for each value of @xmath159 has been computed according to eq .",
    "( [ eq : k ] ) , taking into account that the @xmath5 and @xmath3 factors in eqs .",
    "( [ eq : dvic ] ) and ( [ eq : divc ] ) actually are contained in the computational value of k : @xmath160     spectral amplitudes in a @xmath112 bandwidth of the @xmath31 signal in the presence of the @xmath103 and @xmath104 components only of the @xmath10 and @xmath9 noise generators .",
    "the noisy curves have been obtained with values of the k constant in the amplitude regulation mechanism of @xmath115 , @xmath131 , @xmath161 and @xmath162 , from the lower to the upper curve ( each one is the average of 25 repetitions of the numerical experiment , with a time length of @xmath123 ) .",
    "the smooth lines over the noisy ones are the resonance curves computed with the @xmath0 values given by eq .",
    "( [ eq : q0 ] ) . ]    the frequency spectra clearly show the presence of a really monochromatic oscillation of amplitude @xmath163 , as set by the initial conditions , and the response of a resonator with different values of @xmath0 , excited by the noise signals of @xmath10 and @xmath9 .    as already pointed out by most authors ,",
    "an efficient amplitude regulation mechanism can reduce the contribution of the amplitude fluctuations to the overall noise to a level negligible in front of the phase fluctuations contribution .",
    "however , it is not correct to conclude that half the overall noise injected by @xmath10 and @xmath9 into the circuit can be suppressed by the regulation mechanism . this happens only in this very particular and abstract example in which the regulation mechanism uses two synchronized generators for voltage and current , that act only over the amplitude , avoiding any interference with the phase .",
    "while it is not impossible by principle to implement practically such a machinery , it is not that easy .",
    "a possible way , as suggested in @xcite is to make the regulating network , usually behaving as a voltage _ or _ a current generator , to interact with the resonator only when the oscillation phase is at an appropriate point and the correction would require _ only _ a voltage _ or _ a current injection .",
    "most often it happens that the regulating injected signal contains a @xmath29 component over the @xmath28 one and this makes the noise contribution suppressed as an amplitude fluctuation to appear again as a phase fluctuation .",
    "numerical experiments have been performed to verify this point ( results not shown ) . applying both the @xmath29 and @xmath28 noise components to the resonator with the amplitude control active ( with @xmath164 ) , noise spectra identical to fig .",
    "4 are obtained .",
    "thereafter , suppressing the regulating action of one of the bvg or big generators , correction is no more only radial and phase noise spectrum shows the resulting tangential increment .",
    "this is the common behaviour of real oscillators , where the splitting of the regulation signal into a @xmath29 and a @xmath28 components is not usually feasible .",
    "experiments in this section have been performed in the conditions of both experiment 1 and 2 , i.e. with no amplitude control , applying only the @xmath29 noise component , and with the amplitude control active ( with @xmath164 ) , applying both the @xmath29 and @xmath28 components to the resonator .",
    "this last condition has been implemented using the following definitions for the b .. generators :    .... bpq   20   0   v = v(1)*v(1)+i(bvg)*i(bvg ) bpp   21   0   v=(sqrt(v(20))-1)*k bvg    2   1   v = i(bvg)*v(21)+v(3 ) big    1   0",
    "i = v(1)*v(21)+v(4 ) ....    identical results have been obtained with both implementations of the experiment ( apart a different level of the noise floor due to the arithmetics ) , because in both cases the @xmath28 perturbation component was effectively removed .",
    "first , the oscillator behaviour has been studied under the application of a @xmath157 low frequency sinusoidal signal with frequency @xmath165 , @xmath166 , @xmath115 , @xmath167 , @xmath168 , @xmath169 in place of the vnv and vni noise generators . with @xmath170",
    "the generators were    ....",
    "vnv   3   0   dc 0 sin(0 10 m 1 0 0 )       vni   3   0   dc 0 sin(0 10 m 1 0 0 ) ....    and the results are shown in fig .",
    "power spectral density of the @xmath31 ( and @xmath30 ) oscillator variable in the presence of a sinusoidal perturbation at frequency @xmath171 and amplitude @xmath172 for @xmath10 and @xmath9 .",
    "the computation has been extended over a time length of @xmath173 .",
    "a blackmann - harris window has been applied with fft in order to reduce truncation effects .",
    "this spectrum has been obtained applying ony the @xmath29 perturbation component .",
    "the spectrum obtained the other way , i.e. with the amplitude control active , shows identical peaks and a noise floor @xmath142 higher . ]      thereafter , two _ coloured _ noise sources have been used for the @xmath10 and @xmath9 generators , obtained summing the usual white gaussian noise with a @xmath174 noise component :    .... vnvg   3   30   dc 0 trnoise ( 0.1 10u 0 0 0 0 0 ) vnvf   30   0   dc 0 trnoise ( 0 10u 1.9 1 m 0 0 0 ) vnig   4   40   dc 0 trnoise ( 0.1 10u 0 0 0 0 0 ) vnif   40   0   dc 0 trnoise ( 0 10u 1.9 1 m 0 0 0 ) ....     power spectral density of the @xmath31 ( and @xmath30 ) oscillator variable in the presence of _ coloured _ noise sources in the role of the @xmath10 and @xmath9 generators .",
    "the plot inside the inset reports the spectral density of the noise generators ( averages from 34 computations @xmath133 long ) . ]",
    "a value close to 2 has been used for the @xmath175 exponent in the @xmath174 distribution to improve the separation among the excess noise region and the oscillation frequency @xmath60 , while keeping an high enough excess noise amplitude .",
    "results from this computations are shown in fig .",
    "9 , together with the lorentzian curve associated with the white gaussian - only noise source .",
    "an analysis of results in fig .  8 and 9 will be given in the discussion .",
    "results shown in fig .  4 and 7 are well known .",
    "7 shows that the fluctuations in the oscillation amplitude can be deeply reduced , to the level of being negligible , by a suitable circuit regulation mechanism .",
    "when the regulation is tight enough ( @xmath176 ) only a flat noise floor is left , whose level decreases by @xmath142 for each tenfold increase in @xmath159 .",
    "the phase component of the noise induced signal fluctuations , instead , in the case of white noise sources , impresses to the generated signal spectral distribution the shape of a lorentzian curve ( fig .",
    "the most relevant and new aspect of this part of the work is the neat and direct mathematical path that starts from the splitting of the noise into the @xmath28 and @xmath29 components and leads to equations ( [ eq : lorentzian ] ) , ( [ eq : sigma ] ) and ( [ eq : k ] ) .",
    "these express both the functional form of the noise distribution and the values of the constants it depends on , directly expressed in terms of the unique two relevant circuit characteristics : the energy @xmath16 of the oscillation in the resonator and the rate of energy exchange ( _ power _ ) of the noise source(s ) @xmath177 .",
    "remaining with the simple case considered in the first numerical experiment , in which @xmath178 eq .",
    "( [ eq : omega - n2 ] ) becomes , e.g. , @xmath179 substituting this last expression into eq .",
    "[ eq : sigma ] , @xmath180    if the noise sources were only due to the losses in the resonator by effect of the parallel conductance @xmath6 ( or serial resistance @xmath4 , or both ) , one should have @xmath181 and , by common formulas , @xmath182 .    combining this expressions into eq .",
    "( [ eq : sigma - disc ] ) : @xmath183    this result is identical to analogous results reported in the literature , e.g. , eq .",
    "( 25 ) in @xcite and eq .",
    "( 70 ) in @xcite ; but in the form of eq .",
    "( [ eq : sigma - disc ] ) it is more pregnant and far - reaching . in a more general case , it is possible through eq .",
    "( [ eq : omega - n ] ) to sum up into the @xmath9 and @xmath10 generators all noise contributions that exist in a circuit , then compute @xmath184 and the resulting line - width @xmath62 . from the details of the amplitude regulation mechanism , through eq .",
    "( [ eq : dp]-[eq : inp ] ) , it is possible to compute how much of the amplitude noise component is converted into phase noise , to be added to the native phase noise component .",
    "it is worth noting that the figure of merit @xmath0 of the resonator does not appear in eq .",
    "( [ eq : sigma - disc ] ) , while it appears when passing to eq .",
    "( [ eq : sigma - q0 ] )",
    ". it has always been believed , and verified experimentally , that an high value for @xmath0 is beneficial to reduce phase noise .",
    "equations ( [ eq : sigma - disc ] ) and ( [ eq : sigma - q0 ] ) tell this is true , but only when the losses in the resonator are the main contribution as noise sources ; otherwise , in passing from eq .",
    "( [ eq : sigma - disc ] ) to ( [ eq : sigma - q0 ] ) @xmath185 can not be replaced by @xmath186 , but should become @xmath187 where @xmath188 stands for all other sources of noise current different from the parallel @xmath6 of the resonator .",
    "this equation expresses the same concept as the @xmath189 in @xcite .",
    "also in @xcite it had been observed that an increase in @xmath0 by any means , that also increase the noise , is vain .",
    "as already observed , what is truly relevant for the spectral purity is the noise _ power _ to signal energy ratio as expressed by eq .",
    "( [ eq : sigma - disc ] ) .    about the third experiment ,",
    "the application of a small low frequency perturbation to the circuit , as made in experiment @xmath190 , reveals the deeply non - linear behaviour induced by any efficient amplitude regulation mechanism .",
    "either the radial component @xmath28 of the perturbation be removed _ a priori _ , as in experiment 1 , or be suppressed by the amplitude regulation , the identical result is the appearance of the same side - band components around the frequency of oscillation .",
    "the very interesting aspect to be observed is that this is not a simple effect of amplitude modulation ( am ) : the plot in fig .",
    "9 clearly shows that lateral components are at frequency @xmath191 , @xmath192 and @xmath193 , hence at an offset frequency twice the @xmath112 frequency of the perturbation signal ( and higher order harmonics ) .",
    "true am sidebands can be obtained , instead , adding the modulating signal to the expression sqrt(20)-1 in the bpp generator definition ( results not shown ) .",
    "a close analysis of the data in fig .",
    "9 clearly shows that the central peak is no more exactly at @xmath106 , as it sistematically was in all previous computations ; rather , it is slightly moved to the left by a small amount that can be appreciated also in the plot .",
    "as a fact , the data.out file obtained from this experiment does contain a signal with average frequency of @xmath194 instead of 1000.00 .",
    "this offset in the oscillator frequency depends upon the amplitude of the perturbing signal but does not depend upon its frequency .",
    "all frequencies from @xmath195 to @xmath169 gave exactly the same offset ; varying the amplitude in the @xmath196 range a dependance of the offset with the square of the amplitude was observed .",
    "reducing the value of the @xmath159 constant while performing the third experiment in the condition of experiment 2 , the sidebands and the frequency offset progressively reduce and vanish with @xmath197 .",
    "this makes sense , because with @xmath197 every nonlinear behaviour is removed from the circuit and only a linear resonator is left , excited by a voltage / current at frequency @xmath198 . in the signal spectrum only @xmath60 and @xmath198 can be found , with no mixing effect at all .",
    "the frequency doubling can not be an artifact due to the particular amplitude regulation algorithm adopted ; it appears identical with no regulation mechanism at all , only by effect of noise splitting and @xmath28 component suppression .",
    "these findings are to be kept in mind when observing the behaviour of an oscillator in the presence of a _ coloured _ noise source , as it is the case for @xmath2 noise components .",
    "results in fig .  9 ( the noisy line ) show the behaviour in such a condition , compared to the white noise behaviour of fig .",
    "it is not a simple process of upconversion and appearance of an upper and lower band on side of @xmath60 ; rather , it is a deformation and a shift to the left of the distribution and its peak due to a process of frequency pulling as described in @xcite .    in view of these results",
    ", it is doubtful that this process can be considered the source ( or the unique source ) of @xmath2 components observed in oscillators on side of the carrier .",
    "other effects should be considered ; for example , the direct modulation of the generated signal in passing through a component with equilibrium value affected by @xmath2 fluctuations @xcite . but this is argument for a new investigation and is out of the purposes of this paper .",
    "the florence section of infn ( istituto nazionale di fisica nucleare ) and prof .",
    "maurizio bini are gratefully acknowledged for granting the access to the 64-core computing machine used in most of the described computations ."
  ],
  "abstract_text": [
    "<S> the mechanism at the base of phase noise generation in electrical oscillators is reexamined from first principles . </S>",
    "<S> the well known lorentzian spectral power distribution is obtained , together with a clearcut expression for the line - width parameter . </S>",
    "<S> the mechanism of suppression of the amplitude fluctuations and its effects are discussed and the true role of the figure of merit @xmath0 of the resonator is restated . the up conversion of low frequency components from a non - white noise source is also considered . a number of simple numerical experiments is presented to illustrate and clarify the mathematical results . </S>"
  ]
}