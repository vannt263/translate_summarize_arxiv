{
  "article_text": [
    "weak gravitational lensing , the shearing of galaxy images by gravitational bending of light , is an effective tool to probe the large - scale matter distribution of the universe .",
    "it is also a means to measure the cosmological parameters by comparing observation to numerical simulations of large scale structure growth  @xcite .",
    "there are many weak lensing ( wl ) surveys underway to obtain the cosmological parameters to higher precision , and in particular to probe the evolution of the dark energy by observing its effects on the evolution of matter distribution ( dls , cfhtls ) .",
    "the wl signal is very subtle , however ; it is necessary to measure these small distortions ( typical shear @xmath6 ) in the presence of optical distortions and the asymmetric point - spread - function ( psf ) of real - life imaging .",
    "the level of systematic error in the wl measurement methods are currently above the statistical accuracy expected from future wide and deep wl surveys ( pan - starrs , snap , lsst , ska ) .",
    "because there are no `` standard shear '' lenses on the sky , shear - measurement techniques are tested by applying them to artificial galaxy images and seeing if one can correctly extract a shear applied to the simulation . in most cases ,",
    "the recovered shear can be written as @xmath7 .",
    "departures from the ideal @xmath8 we will term `` calibration '' or `` multiplicative '' errors and quote as percentages .",
    "deviations from the ideal @xmath9 can result from uncorrected asymmetries in the psf and optics , and will be termed `` additive errors '' or `` incomplete psf suppression . ''",
    "such tests of the most widely applied analysis method @xcite[ksb ] , find @xmath100.80.9 , but this coefficient is implementation dependent  @xcite , and depends upon the characteristics of the simulated galaxies .",
    "hirata & seljak ( 2003 ) [ @xcite ] demonstrate that various psf - correction methods can produce shear measurements miscalibrated by a few % to 20% or more .",
    "heymans et al .",
    "( 2005 ) [ shear testing programme , ( @xcite ) ] present testing of many existing shear - measurement pipelines using a common ensemble of sheared simulated images .",
    "these methods show a median calibration error of 7% , although some ( the bj02 rounding kernel method , an implementation of a ksb method , as well as the one described in this paper ) show no calibration error , to within the @xmath11 noise level of the first step tests .",
    "although the statistical accuracy in past surveys was comparable to the 7% systematics , it is expected to be well below 1% in future surveys .",
    "hence , understanding and eliminating the wl systematic errors require the most urgent attention today .    in this paper",
    ", we implement the elliptical gauss - laguerre ( egl ) deconvolution method as described in bj02 , and subject it to a series of tests designed to be more stringent than any previous test of wl measurements .",
    "the deconvolution method is distinct from the @xcite method , also described bj02 , in which the anisotropic psf effects are removed using a `` rounding kernel '' instead .",
    "wl testing regimes are of two types : in end - to - end tests ( _ e.g. _ step ) , one produces simulated sky images with a full population of stars and galaxies , analyzes them with the same pipeline as one would real data , then checks the output shear for veracity .",
    "we perform here more of a dissection , in which we analyze the performance of the method one galaxy type at a time , and vary the parameters of the galaxy and psf images to determine which , if any , conditions cause the measurement to fail . while lacking the realism of an end - to - end test , this allows us to isolate and fix weaknesses . if we can demonstrate that the method succeeds under a set of conditions that will circumscribe those found on the real sky , then we can have confidence that our method is reliable , whereas end - to - end testing is reliable only to the extent that the simulated sky reproduces the characteristics of the real sky .",
    "we investigate here the performance of our egl method across the range of noise levels , degree of resolution by the psf , pixel sampling rates , galaxy ellipticity , and psf ellipticity , using both highly symmetric and asymmetric galaxy shapes .",
    "we test not only the accuracy of shear recovery , but also the accuracy of the shear uncertainty estimates .",
    "the egl method is further elaborated in  2 , while the implementation , , is detailed in  3 .",
    "the shear accuracy test procedure is described in  4 .",
    "the conditions under which the shape measurement succeeds , and the accuracy of its estimates of shear , are presented in  5 .",
    "previous dissection tests include @xcite and @xcite .",
    "the former studies the performance of several methodologies on varied galaxy and psf shapes / sizes in the absence of noise .",
    "the latter study verified its `` polar shapelet '' method to better than 1% calibration accuracy . in  6 and  7",
    "we conclude with comparisons to other shape - measurement methodologies and tests , and draw inferences for future surveys .",
    "the task of this weak lensing methodology is to assign some _ shape _ @xmath12 to observed galaxy @xmath13 , then to derive from the ensemble @xmath14 an estimate of the applied lensing _ shear _ .",
    "more precisely , a shape analysis can only determine the _ reduced shear _",
    "@xmath15 , where @xmath16 is the lens convergence .",
    "following bj02 , we use distortion  to describe the shear , where @xmath17 ( @xmath18 for @xmath19 ) . in this paper , both the shear and the shapes are expressed as distortions ; while in other wl literatures , shear is usually expressed as @xmath20 .",
    "following bj02 , we will quantify the lensing by decomposing its magnification matrix @xmath21 into a diagonal dilation matrix @xmath22 and a unit - determinant symmetric shear matrix @xmath23 : @xmath24 where @xmath25 is the direction of the shear axis , and @xmath26 is a measure of shear .",
    "the `` conformal shear '' @xmath26 can be reparameterized as the distortion @xmath27 or the reduced shear @xmath28 .",
    "the shape must be assigned to an image of a galaxy with some surface - brightness distribution @xmath29 .",
    "initially we will ignore the effects of psf convolution on the observed image .",
    "the bj02 definition of shape is to specify roundness criteria or `` circularity tests , '' @xmath30 and @xmath31 , that operate on @xmath32 to yield one scalar for each component of the shear  typically these are quadrupole moments .",
    "the object is deemed circular ( @xmath33 ) if @xmath34 .",
    "if the object is not circular , then we assign to the object the shape  which yields the solutions @xmath35 =   m_\\times[i({\\bf s}_{\\boldeta}\\boldtheta ) ] = 0,\\ ] ] _ i.e. _ we find the shear  that , when applied to the coordinate system , makes the image appear circular in that coordinate system , and declare the galaxy shape to be this shear .",
    "any circularity test will do , as long as has a unique solution ; in particular the matrix @xmath36 must be non - singular .",
    "the shape  is defined by @xmath37 , keeping the position angle @xmath25 .",
    "defining shape in this way with a suitable circularity test has the virtue that the effect of a lensing distortion  upon the galaxy shape  is completely defined by the multiplication of shear matrices .",
    "in particular , the component - wise formulae for transformation of a shape under a shear must take the form given by @xcite :    [ emap ] @xmath38   ( e_\\times\\delta_+ - e_+\\delta_\\times ) } \\over { 1 + \\bolde \\cdot \\bolddelta } } ; \\ ] ] @xmath39   ( e_+\\delta_\\times - e_\\times\\delta_+ ) } \\over { 1 + \\bolde \\cdot \\bolddelta } } .\\ ] ]    we can take the limit of a weak shear @xmath40 , @xmath41 :    [ weakmap ] @xmath42    bj02 describe (  5 ) a scheme for optimally weighting and combining an ensemble of shapes to produce an accurate estimate of the distortion . this scheme is predicated on the assignment of shapes that transform under shear according to . hence to test the accuracy of our methodology in recovering weak lensing shear , _ we need only test that assigned shapes transform under shear as in equations  ( [ weakmap ] ) .",
    "_ furthermore , the isotropy of the universe guarantees that the @xmath12 of an unlensed population will be uniformly distributed in @xmath25 , hence we need only verify that equations  ( [ weakmap ] ) hold when averaged over an ensemble of galaxies with fixed unlensed @xmath43 but random orientations :    [ avgweakmap ] @xmath44    here the brackets refer to averaging over the pre - lensing orientation @xmath25",
    ". the second order term in @xmath45 vanishes , so these equations are valid to @xmath46 .",
    "we refer to this as the _ ring test _",
    "[ fig : ringtest ] ) , since we construct an ensemble of test galaxies which form a ring in the  plane , then shear them , measure their shapes , and take the mean .",
    "we also note that as a special case , we should obtain @xmath47 when there is _ no _ applied shear .",
    "when there is no psf or the psf is symmetric under 90  rotation , then this result holds for any measurement scheme that is symmetric under inversion or exchange of the @xmath48 and @xmath49 axes of images .",
    "but for an asymmetric psf , this is a stringent test of the ability of the shape - measurement technique to remove the effects of the psf from the galaxy shapes .",
    "the circularity test described in bj02 involves decomposing the pre - convolution surface brightness distribution of the galaxy , @xmath29 , into the gauss - laguerre set of orthonormal basis functions in the plane .",
    "we consider here a general set of two dimensional functions @xmath50 that are complete ( though not necessarily orthogonal ) over the plane .",
    "any set of complete functions can be transformed to a new complete set @xmath51 via @xmath52 here @xmath53 is any remapping of the sky plane that compounds a displacement @xmath54 , a shear @xmath55 , and a dilation @xmath56 .",
    "we refer to @xmath53 as the _ basis ellipse _ of the function set : if the unit circle is an isophote of @xmath57 , then @xmath58 describe the center , size , and shape of an ellipse that traces the same isophote for @xmath59",
    ". we will also use @xmath53 to refer to this set of 5 parameters that defines an ellipse ; it will be clear from context whether we are referring to the parameter vector or the coordinate transform . for any * e * we must have @xmath60 for ( at least ) one vector  of coefficients . for the function set to be complete , the vectors must be infinite - dimensional , but a real measurement will model @xmath32 with a finite subset of the basis functions",
    ". the model must be fit to the observed image plane which we denote with coordinates .",
    "the action of the atmosphere , optics , and detector will operate on @xmath29 to produce an observed surface - brightness distribution @xmath61 on the detector plane .",
    "this observation operator @xmath62 likely includes convolution by the psf and perhaps some distortion by the optics .",
    "we will assume that this operation is known and that it is linear over surface brightness , so that @xmath63 , where @xmath64 and @xmath65 are any two scalars .",
    "in this case , must also imply that @xmath66.\\end{aligned}\\ ] ]    the observed - plane brightness is sampled at the centers of the pixels @xmath67 yielding measurements @xmath68 with uncertainties @xmath69 , assumed henceforth to be gaussian . the model which maximizes the likelihood of the decompositions ( [ ibpsi ] ) and ( [ ibphi ] ) , given",
    "the data is that which minimizes @xmath70 ^ 2 \\over \\sigma_p^2}\\ ] ] we call this a `` forward fit '' to the galaxy image , because we are positing a distribution @xmath71 of flux on the sky , then propagating this to the detector plane , where we compare the model to the observations .",
    "our task will be to find the @xmath53 for which the @xmath72-minimizing vector  satisfies the circularity constraints . if the  is always constrained to be circular .",
    "we do not yet understand the significance , if any , of this distinction . ]    for fixed @xmath53 , the @xmath72 minimization is a linear least - squares problem over  with the usual analytic solution @xmath73 if the @xmath57 are orthogonal _ and _ the noise is stationary and white _ and _ the sampling approaches the continuum limit _ and _ the psf approaches a delta - function , then  will be diagonal ( modulo some complex conjugation operations ) and the solution is very simple .",
    "these conditions are not , however , typically met by real data  in particular the sampling and psf conditions  so it is not safe to use orthogonality to decompose the observed data @xcite .    for finite data ,",
    "the solution must be done over some truncated basis set .",
    "we will assume that @xmath74 of the basis functions are being used , so that , , and  have dimension @xmath74 .",
    "the @xmath72-minimizing  is uniquely defined , regardless of whether the @xmath57 are complete or orthogonal , as long as @xmath75 is not singular .    to follow the bj02 prescription we must define circularity tests and iterate the shear in @xmath53 until the two circularity components vanish . at the same time",
    ", we may wish to define null tests for the centroid @xmath54 and/or size @xmath56 of the galaxy , so there will be some number @xmath76 such statistics ( @xmath77 when there is a null test for each of the parameters of @xmath53 ) .",
    "any test which is linear over the true intensity @xmath29 may be expressed as a linear operation on .",
    "hence the task of the fitter is to adjust @xmath78 components of the @xmath53 parameters until the @xmath72-minimizing  satisfies @xmath79 @xmath21 is a @xmath80 matrix that defines our tests for matching the basis ellipse to the center , size , and shape of the pre - convolution galaxy .    once is satisfied for a chosen set of basis functions @xmath57 and any choice of the circularity - test matrix @xmath21 , we obtain a well - defined measurement of the shape   ( or more generally the defining ellipse * e * ) of the pre - convolution galaxy image .",
    "since these shapes are defined by shear operations on the @xmath81 plane , they should transform according to and be amenable to all the weighting and responsivity schemes of bj02 .    before describing how we solve for @xmath53 , we summarize the conceptual and practical advantages of combining a transformation - based definition of shape with forward fitting of a pre - convolution model to the observed pixels .",
    "note the fitting approach has been advocated by several authors @xcite .    *",
    "the  values determined in this way transform in a well - known way under lensing shear .",
    "the response of a galaxy population to lensing shear can be calculated without recourse to empirical calibration factors beyond the distribution of the  values themselves . *",
    "the forward - fitting procedure can in principle work with any sort of psf , even those  such as the airy function  that have divergent second moments . *",
    "the forward - fitting procedure properly handles pixelization and sampling by the detector .",
    "furthermore any aliasing ambiguities will properly propagate into the covariance matrix for , and as described below can be propagated into uncertainties in @xmath53 .",
    "* pixels rendered useless by defects or cosmic rays are easily omitted from the measurement . *",
    "the method is easily extended to simultaneous fitting of multiple images with distinct psfs .",
    "the sum over pixels in is run over all pixels in all exposures of the galaxy .",
    "all exposures share the same , , and @xmath53 vectors , but have distinct observation operators @xmath62 and hence different @xmath82 .",
    "information available in the best - seeing images is properly exploited . *",
    "the method is easily adapted to the analysis of @xmath83-plane interferometric data rather than image - plane data .      the desired ellipse parameters @xmath84 enter the least - squares fit non - linearly , hence some iterative scheme ( or markov chain , _ cf .",
    "_ @xcite ) is required to determine the values that meet the constraint ( [ mb0 ] ) . for a chosen @xmath53 ,",
    "the determination of  has the rapid solution ( [ sumpix ] ) .",
    "if the current estimate @xmath85 yields a @xmath86 that does not meet the circularity condition , the newton - raphson iteration would be @xmath87 the derivative @xmath88 follows from noting the effect of a small change @xmath89 to the basis of : @xmath90 here @xmath91 is the _ generator _ for the transformation indicated by @xmath92th parameter of @xmath53either translation , dilation , or shear .",
    "these matrices are fixed by the choice of basis functions @xmath93 .",
    "these alterations to the basis - function values can be propagated through the solution ( [ sumpix ] ) to give the perturbation to : @xmath94.\\end{aligned}\\ ] ] the matrix @xmath88 is apparent from this last equation .",
    "here we have taken the generator matrices @xmath91 to each be @xmath95 ; the vector @xmath96 now must be , in general , augmented to infinite dimension , and we also take @xmath97 to be @xmath98 .",
    "note that the parenthesized portion of the solution ( [ dbde1 ] ) would vanish if not for the distinction between the truncated and infinite - dimensional versions of  and , since the first @xmath74 elements of @xmath99 are zero .",
    "likewise we could set the initial @xmath100 of the final term to identity if not for the truncation , in which case the transformation would become the very simple @xmath101 ( with some abuse of notation here ) .",
    "since we are using @xmath102 only to help us iterate the solution for @xmath53 , we could use this simple approximation , or extend to some order beyond @xmath74 using .",
    "we use the gauss - laguerre decomposition in our shape measurements .",
    "these are the eigenfunctions of the 2-dimensional quantum harmonic oscillator , and are most compactly expressed as complex functions indexed by two integers @xmath103 : @xmath104 the elliptical - basis versions are taken to be @xmath105 note we have tweaked the normalizations so that the flux is @xmath106 rather than making the functions orthonormal .",
    "the gauss - laguerre ( gl ) functions are still , however , a complete and orthogonal set over the plane .",
    "the functions are equivalent to the `` polar shapelets '' of @xcite .",
    "the advantages of the gl functions as our basis are :    * the @xmath57 are rapidly calculable via recursion relations .",
    "* decompositions of typical ground - based psfs and exponential - disk galaxies are reasonably compact .",
    "* there are obvious choices for the circularity tests : the centroiding condition is @xmath107 ; the circularity condition is @xmath108 ; and a size - matching condition is @xmath109 .",
    "the matrix @xmath21 is very simple , _",
    "i.e. _ it just restricts  to five relevant ( real - valued ) elements .",
    "* the generator matrices @xmath91 are sparse and simple . in particular ,",
    "if the truncated  extends to @xmath110 , then @xmath111 vanishes for @xmath112 .",
    "this means that the augmented  and  in can be calculated exactly simply by extending the sums in to order @xmath113 ( in @xmath114 ) , just slightly beyond the order @xmath74 needed to calculate .",
    "* matrices for finite transformations are calculable with fast recursion relations .",
    "* convolution by a psf is also expressible as a matrix operation over the  vector , if we also express the psf as a gl decomposition @xmath115 in some basis ellipse @xmath116 .",
    "this means that the @xmath82 corresponding to a chosen psf are rapidly calculable .",
    "bj02 contains details on many of these properties , and gives the generators (  6.3.2 ) , the forms for the finite - transformation matrices ( appendix a ) , and the convolution matrices ( appendix b ) .",
    "we emphasize that other basis sets may be chosen which yield valid shape measurements , but we choose the gl decomposition for its efficiency and clarity .",
    "similarly , one need not execute the operation @xmath117 using the gl matrices ; this is just a computational convenience in our case .",
    "we follow bj02 in using @xmath108 as our definition of a circular object .",
    "it is possible that other gl coefficients carry shape information that could be used to produce lower - noise shape estimates @xcite .",
    "in fact with the formalism used below (  [ errors ] ) to estimate shape uncertainties , one can derive for each object a linear circularity test @xmath118 that is optimally sensitive to shear .",
    "we have implemented a scheme whereby such an optimally weighted combination of all the quadrupole coefficients @xmath119 is derived for each galaxy .",
    "our testing has not yet demonstrated any significant advantage to this scheme , however , so we have not pursued it further for fear that such custom estimators might produce subtle noise - rectification biases .",
    "we may produce uncertainties on the ellipse parameters @xmath120 by propagating the pixel flux uncertainties .",
    "the covariance matrix for the  vector takes the usual form @xmath121 .",
    "the covariance matrix for the ellipse parameters then follows : @xmath122^t\\ ] ]    we may also assign a detection significance to the object . in the simplest case , where there is no psf to consider , the signal - to - noise ratio @xmath123 for detection by the optimally - sized elliptical gaussian filter is given by @xmath124 the maximization of this quantity with respect to the size , shape , and center of the elliptical - gaussian filter generates conditions that are identical to our default circularity tests .",
    "we define a significance in the more general case  such as when the psf is non - trivial  to be @xmath125 the variance on the flux can be obtained by contracting @xmath126 .",
    "this estimate of the significance corresponds to the signal - to - noise on the galaxy detection that would be obtained by applying a filter to the _ deconvolved _ image that is matched to the shape , location , and radial profile of the galaxy .",
    "the maximum order of the sum in ( [ nu2 ] ) determines the allowable complexity of the filter .",
    "is the c++ implementation of the methods described in the previous section .",
    "the code includes classes to represent the vectors , transformations , and covariance matrices over quantities indexed by the integer pairs @xmath127 . to fit to a single galaxy , the code requires as input :    * image - format data for both the surface brightness @xmath68 and the weight @xmath128 ( _ cf .",
    "_ eq .  ( [ chisq ] ) ) .",
    "the latter image should be set to zero at saturated , defective , or contaminated pixels .",
    "data / weight image pairs from multiple exposures may be submitted for simultaneous fitting of a single object .",
    "it is assumed that each image has been flat - fielded so that a source of uniform surface brightness has equal value in all pixels . * for each exposure",
    ", a map @xmath129 from the pixel coordinate system into the world coordinate system .",
    "this is typically either the distortion map into the local tangent plane to the celestial sphere , or an identity map . * for each exposure , the local sky brightness and a photometric gain factor . * if we are executing a _ deconvolution fit _",
    ", whereby we measure the shape of the galaxy before psf convolution , then we require , for each exposure , a vector @xmath115 and basis ellipse @xmath116 describing the estimated psf at the location of the galaxy .",
    "if we are executing a _ native fit _ , whereby we are trying to measure the _ observed _ shape of the galaxy , then no psf information is required . * a choice for the initial order @xmath74 @xmath130 of the gl decomposition of the galaxy model . * lastly an initial estimate of the size , location , and shape of the galaxy , _",
    "e.g. _ the values generated by detection software such as sextractor @xcite .",
    "if we are executing a deconvolution fit , we need to know both the size @xmath131 of the object as observed , and the size @xmath132 of the psf in which the object is observed .",
    "these are by default subtracted in quadrature to estimate the size @xmath133 of the intrinsic ( pre - seeing ) galaxy .",
    "the procedure for shape determination has the following steps :    1 .",
    "if we are executing a deconvolution fit , we choose the size of the `` source basis '' @xmath134 which is the basis ellipse for the @xmath59 that will be used to model the pre - convolution image .",
    "we select @xmath135 where @xmath136 and @xmath137 are the sizes of the pre - seeing galaxy image and the psf , respectively , and @xmath138 is a prefactor chosen by default to be 1.2 .",
    "if there are multiple exposures , we take @xmath132 to be the harmonic mean of all the exposures psf sizes . as discussed in bj02  6.2 , we expect a choice of gaussian basis @xmath139 that is larger than both the intrinsic galaxy and the psf to offer the most sensitive measure of pre - convolution quadrupole moments . during a deconvolution fit , @xmath140 is held fixed during all iterations and there is no constraint on size in the circularity test @xmath21 .",
    "the initial guess for @xmath134 is mapped from the world coordinate system into each exposure s pixel system .",
    "an elliptical mask is created for each exposure , defined by the @xmath141 contour of the elliptical gaussian .",
    "typically we select @xmath142 .",
    "pixels outside the mask are not included in the fit .",
    "larger masks reduce the possibility of degeneracy or non - positive models for high - order fits , but increase the chance of contamination by neighboring objects .",
    "if any of the exposures do not fully contain the fitting mask , the edge flag is set .",
    "if the initial centroid falls outside _ all _ the exposures , then the outofbounds flag is set and the fit is terminated .",
    "the basis ellipse @xmath116 of the psf is changed to have the same shape ( not size ) as the current estimate of the galaxy shape , by applying a finite shear transformation matrix to @xmath115 .",
    "the convolution by the psf is now expressed as a matrix operation , so we have an observed - plane image model @xmath143 c_{ij } b_j .\\ ] ] the observed - plane basis ellipse @xmath144 has second moments that are the sum of the second moments of the chosen source - plane basis @xmath134 and the psf basis ellipse . the convolution matrix elements @xmath145 can be computed as in appendix b of bj02 .",
    "we now have a model for the observed data which is linear over the expansion coefficients .",
    "[ psfstep ] 5 .",
    "the linear solution for  is executed by summing over all valid pixels within the masks on all exposures . if a singular value decomposition of the  matrix indicates that there are poorly constrained combinations of  elements , the order of the gl decomposition is reduced by one ( to a minimum of @xmath146 ) , the reducedorder flag is set , and the solution is attempted again .",
    "the matrix @xmath88 is calculated from the augmented  and  ( which in fact were calculated in the previous step ) as per . 7 .",
    "if the circularity test applied to  is _ not _ zero within a specified tolerance , then an iteration increment @xmath147 is calculated according to .",
    "if a singular - value decomposition of @xmath88 indicates a nearly - degenerate matrix , we know that there is no sensible estimate for the next step . in other words ,",
    "at least one of our circularity tests is currently ill - defined , for example no small change of basis makes the object appear more circular .",
    "this should , for example , be the case for a point source , but also arises for some very irregular or noisy galaxies .",
    "the behavior of the next step depends upon the fit type : in a native fit , we set the frozedilation flag , set @xmath56 back to its initial value , and restart the fitting process , this time holding @xmath56 fixed .",
    "if we are executing a deconvolution fit , we increment @xmath138 by 0.5 , set the raisedmu flag , and restart the fitting process , since fits to a larger basis tend to be more stable ( but less sensitive ) .",
    "if frozedilation has been set ( for a native fit ) or @xmath148 already ( for a deconvolution fit ) , and @xmath88 is still near - degenerate , then our last resort is to set the frozeshear flag , reset  to its starting value , and restart the fit process while holding the shape fixed .",
    "the next iteration of the fitting process continues at step  [ psfstep ] .",
    "if the circularity test is not satisfied within a chosen number of iterations , the didnotconverge flag is set and the fit is terminated . if any other matrix singularities are encountered , or if there are too few pixels to conduct the fit , the singularity flag is set , and the fit terminates . 9 .",
    "once the circularity tests are satisfied within a desired tolerance , the resultant @xmath53 and  for the galaxy are available for the user .",
    "the  matrix provides the covariance matrix for .",
    "the errors on the centroid , size , and ellipticity ( or whichever of these were free to vary ) are calculated using , and a detection significance can be reported using .    in most cases",
    "the solution for @xmath53 is executed twice : first , a coarse fit at order @xmath146 is attempted .",
    "if this fails , the coarsefailure flag is set .",
    "if it succeeds , the coarse solution is used as the starting point for a fit to the full requested @xmath74 .",
    "another subtlety is that the pixel mask is not changed between iterations  the mask maintains the shape and size specified by the initial guess ( or the result of the coarse fit ) .",
    "this should not bias the fit toward the initial guess , however , because we are fitting to the data within the mask rather than executing a sum of moments over pixels within the mask .",
    "if the size @xmath56 of the object changes dramatically during the coarse fit ( _ e.g. _ due to a very poor initial estimate from sextractor ) , then we do resize the masks and start over .",
    "if at any time the mask on an image grows to encompass too large a number of pixels , we set the toolarge flag and quit .",
    "this prevents the program from getting hung up calculating pixel sums for nonsensically large objects .",
    "the algorithm is considered to have converged to a valid shape measurement if it completes without setting of the flags frozeshear , didnotconverge , singularity , outofbounds , toolarge , or coarsefailure .",
    "in our tests , postage - stamp images are created of individual galaxies , as convolved with a known psf , pixelized , and given noise .",
    "we then extract shape and shear measurements from ensembles of such postage - stamp tests . in the real sky and in end - to - end tests which draw ( pre - lensing ) galaxy shapes at random ,",
    "the uncertainties in the output shear are usually dominated by the finite variance of the mean pre - shearing shape ( shape noise ) .",
    "we construct our ensembles with zero mean shape to eliminate shape noise , leaving our testing precision dominated by the shot noise in the images .",
    "because we provide the shape - measurement algorithms with an approximate location for every simulated galaxy , our tests do not include the effects of possible selection biases @xcite .",
    "similarly the psf is always presumed to be known exactly , so we do not test for errors that would result from psf measurement or interpolation errors @xcite .",
    "effects of galaxy crowding or overlap , detector nonlinearities , intrinsic galaxy - shape correlations , or redshift determination errors @xcite are not examined here .",
    "instead we concentrate on the sources of systematic error that arise specifically from ( 1 ) the shape measurement , ( 2 ) removal of the psf effects , and ( 3 ) the shear estimation , in images with finite noise and sampling .      in order to test our wl analysis methodology , we need to find the conditions under which  works , and then test for any biasing in the shape measurement or shear estimation method .",
    "the following is the list of the test conditions or choices made :    * native fit or deconvolution fit .",
    "all measurements are tested for cases without ( native fit ) and with ( deconvolution fit ) the presence of a psf . in a wl analysis of real sky data ,",
    "native fits are used in ( 1 ) characterizing the psf from stellar images , and ( 2 ) measuring the shape of the psf - smeared galaxy , whose value is used to produce an initial estimate of the intrinsic galaxy shape . *",
    "galaxy size with respect to pixel or psf .",
    "as the pixel sampling rate decreases , it becomes harder to obtain shape information about the galaxy from the pixelized image , or for the  to converge .",
    "for the native fits , the galaxy size is defined with respect to the pixel ; for the deconvolution fits , to the psf . * galaxy detection significance @xmath149 , or equivalently @xmath123 .",
    "if the background noise dominates the signal from the galaxy ,  is also unlikely to converge . * galaxy shape @xmath150 .",
    "the galaxies are sheared to various shapes , ranging from @xmath151 to @xmath152 ( @xmath153 axis ratio @xmath154 ) . in some cases , the major axis orientation ( parallel or diagonal to the pixel axis )",
    "is also examined .",
    "* galaxy type .",
    "we choose a `` symmetric '' or `` asymmetric '' galaxy model , with the latter being a more stringent test of the methodology .",
    "the galaxy models are described further in  [ imagemodel ] , and the shear accuracy is examined by the ring test , described in  [ ringtest ] .",
    "for the deconvolution fit , we have the following additional choices for the psf :    * psf type .",
    "we choose an airy disk psf as the worst possible case for a psf .",
    "an airy disk offers particular difficulties for shape - measurement algorithms , such as its non - trivial morphology and divergent second moments .",
    "* psf shape .",
    "the airy disk is either circular or elliptical ( sheared at @xmath155 ) . we look for any leakage of the psf shape into the galaxy shape measurement or the shear estimate .    in this paper ,",
    "the psf is always known ; we do not test for errors due to incomplete knowledge of the psf .",
    "two types of galaxies , symmetric and asymmetric , are used to test the shape measurement and shear recovery .",
    "the galaxy models , along with any shear , rotation , and dilation , are described as an analytic function over the pixel coordinates .",
    "the `` symmetric '' galaxies have either a gaussian or exponential circularly symmetric radial profile that is then sheared .",
    "all isophotes are similar ellipses , so these galaxies have unambiguous shapes , which allows direct comparison between the input and measured shape .",
    "the elliptical symmetry of these galaxies could be masking errors in the shape - measurement methodology by causing fortuitous cancellations of errors .",
    "in other words , all of their egl expansion coefficients with @xmath156 are exactly zero , so any biases that couple to these coefficients will not be tested by the symmetric galaxies .",
    "the `` asymmetric '' galaxies are designed so that they have no inversion symmetry , and their isophotal shape varies with radius ; i.e. , there is no unambiguously defined shape .",
    "the ring test is therefore needed to see if input shear is accurately recovered .",
    "these are constructed as a combination of exponential and devaucouleur ellipses , each with different flux , size , and shape , as well as a slight offset between the two centroids .",
    "the asymmetric galaxies offer a more stringent test of shear measurement , since we have broken any symmetries that could mask errors in the shape measurement .",
    "a pixelized postage stamp image is created from the analytic functions that describe the galaxy and psf models at the intended sampling rate .",
    "the centroid of the analytic functions is randomized within the pixel over multiple image realizations ( pixel phase randomization ) .",
    "the psf convolution is done either analytically if possible , or via fft of noiseless pixelized images .",
    "the poisson photon noise is then added to produce the final image to produce the desired @xmath123 for the object .",
    "we then run  for shape measurement with starting parameters randomly displaced from the true values .",
    "the ring test evaluates the mean shape  the weighted average of the galaxy shape components  with a simplified galaxy shape distribution , as seen in figure  [ fig : ringtest ] . when a shear  is uniformly applied to the ensemble , the mean shape @xmath157 should equal @xmath158 , where @xmath159 ( eq .  ( [ avgweakmap ] ) )",
    "is called the responsivity .",
    "this relation then gives an estimate of the shear from the mean shape .",
    "the value of the ring test is two - fold : the expected signal is known , and the shape noise is absent .",
    "the shape noise in wl is the statistical noise due to the random distribution of shapes with finite magnitudes ; the uniform distribution of shapes in the ring test eliminates this noise .",
    "the lack of shape noise and the known expected value then allow systematic errors to be quantified .",
    "we run  on objects with different size and detection significance to understand the conditions under which  converges reliably , which we define to be @xmath3 rate of successful shape measurement .",
    "shear estimate accuracy tests are subsequently performed only in @xmath3 convergence conditions , to preclude any selection biases that could be generated by the non - convergence of .",
    "figure  [ fig : native - contour ] shows the @xmath160 convergence contour for native fits on exponential - profile symmetric galaxies of various ellipticities .",
    "the upper right hand region delineated by the contour indicates where the fit has @xmath3 convergence .",
    "the horizontal axis indicates the sampling rate , and is expressed in terms of the `` minor axis width '' ( maw ) , defined below .",
    "the vertical axis incidates the detection significance @xmath149 of the object .",
    "we define the minor axis width for a gaussian object as its full width at half maximum ( fwhm ) along the minor axis direction . for non - gaussian objects ,",
    "the `` gaussian size '' @xmath139 is defined from the size - matching condition @xmath161 (  [ gldecomposition ] ) ; an exponential profile @xmath162 has a gaussian size @xmath163 .",
    "the gaussian size along the minor axis is @xmath164 , where @xmath26 is the conformal shear (  [ shape - as - shear ] ) , so the minor axis width is @xmath165 .",
    "figure  [ fig : native - contour](a ) clearly shows that for a native fit to converge reliably , @xmath123 must be @xmath166 and its minor axis width be @xmath167 pixels .",
    "the convergence contour for gaussian radial profiles is found to be identical to the exponential - profile contour .",
    "the fact that the minor axis dimension is the limiting factor for convergence implies a shear - dependent selection , since @xmath168 does not remain constant under a shear operation .",
    "the required sampling rate depends , however , on the orientation of the minor axis .",
    "figure  [ fig : native - contour](a ) shows the convergence contour when the ellipse is elongated along the pixel axis , where figure  [ fig : native - contour](b ) shows the case when the elongation is along the pixel diagonal . in the second case",
    ", the required sampling rate appears to decrease with increasing @xmath150 , until it settles at 2.0 pixel for @xmath169 .",
    "figure  [ fig : diag - sampling ] illustrates that for objects elongated along the pixel diagonal , the effective sampling rate along the minor axis becomes @xmath170 of the pixel spacing .",
    "the gl decomposition of the psf is determined via a native fit .",
    "hence , the images must sample the psf minor axis width by more than 2.8 pixels for the  to be applied successfully to individual stars .",
    "note that it is possible to increase the sampling rate by dithering for a ccd of any pixel size .      for the deconvolution test ,",
    "we convolve the model galaxies with a circular airy - function psf , whose characteristic width is @xmath171 .",
    "the model galaxies in this test are symmetric elliptical objects of exponential radial profile with minor axis gaussian width @xmath168 before psf convolution .",
    "the pixel size is irrelevant to the convergence rate , as long as @xmath172  pixels ( _ cf . _  [ nativeconvergence ] ) .",
    "we find that the convergence rate of  is independent of the orientation of the major axis under these conditions .",
    "figure  [ fig : deconv - contour ] shows the 99% convergence contour for deconvolution fits .",
    "the horizontal axis is the minor - axis resolution @xmath173 we find that high-@xmath150 galaxies are less likely to converge at low resolution than more circular galaxies .    in analyses of the real sky ,",
    "the dimmest and smallest galaxies are most numerous , so we draw our attention to the lower left corner of the contour in figure  [ fig : deconv - contour ]",
    ".  will converge reliably for objects with @xmath174 down to @xmath175 . to obtain a reliable shape measurement of marginally resolved objects ( @xmath176 ) at all shapes @xmath150",
    ", the significance must be @xmath177 .",
    "having determined where  is consistently successful in measuring a shape , we now examine the accuracy of the shape measurement and error estimate that result .",
    "when an elliptical object is used as an input , the input shape is well defined , and hence so is the measurement error . in this section",
    "we use symmetric elliptical galaxies with exponential radial profile that have an unambiguous shape @xmath178 .",
    "the shape measurement error is expressed as a conformal shear @xmath179 , where @xmath180 is the shear addition operator , equivalent to shear matrix multiplication : @xmath181 where @xmath182 is the unique rotation matrix that allows @xmath183 to be symmetric ( bj02  2.2 ) .",
    "the quantity @xmath184 is the amount of shear required to bring the input shape to the measured shape , hence describes a shear bias regardless of the intrinsic object shape .",
    "each data point is an average over @xmath185 measurements of independent realizations of pixel phase and photon noise .",
    "we then plot the averaged error components @xmath186 or @xmath187 as the measurement accuracy .",
    "the uncertainty in the mean @xmath188 component is then @xmath189",
    ".    produces error estimates @xmath190 , @xmath191 for every shape measurement from the covariance matrix @xmath192 (  [ errors ] ) .",
    "we test for the accuracy of this estimation by examining the averaged ratios @xmath193 and @xmath194 , where the average is over shape measurement trials .",
    "each panel in figure  [ fig : nativeshapeerror ] show the average error @xmath195 ( @xmath196 ) as a function of the input shape @xmath150 of the symmetric exponential galaxies .",
    "we first examine the accuracy of native fits to galaxies with no psf convolution .",
    "the panels correspond the sampling rates and detection significances marked by the points inside the 99% convergence contour in figure  [ fig : native - contour ] .",
    "those that are well into the @xmath3 convergence region ( the inner three panels ) show no systematic bias in the shape measurement within the uncertainty @xmath197 . for those on the @xmath160 convergence contour ( left - most and bottom panels ) , shape measurements show some systematic errors , but",
    "the worst systematic is still within @xmath198 .",
    "the shear error @xmath199 ( @xmath200 if @xmath9 ) that would result from such measurement error is @xmath201 assuming @xmath202 , where @xmath203 ( 1-\\langle e^2\\rangle)\\ ] ] for a constant @xmath204 .",
    "the function @xmath205 is always @xmath206 , and rapidly decreases to zero for @xmath207 .",
    "hence a shape measurement systematic of @xmath198 approximately corresponds to a shear calibration error of @xmath208 .",
    "figure  [ fig : nativeerrorestimate ] shows the root - mean - square ( rms ) of the actual to estimated error ratios , @xmath209 , where @xmath210 is the error estimate in the @xmath13th component as calculated by .",
    "overall , we see that the error estimate does fairly well .",
    "there is a slight tendency to overestimate the error as @xmath149 becomes low ; the @xmath210 bias has no dependence on the pixel sampling .",
    "the @xmath149 dependence is approximately @xmath211 @xmath212 .",
    "figure  [ fig : dcvlshapeerror100 ] shows the accuracy of a deconvolution fit when a symmetric , exponential galaxy is convolved with an airy psf .",
    "we first discuss a high-@xmath123 case , @xmath213 .",
    "the measurements were done at various minor axis resolutions , where @xmath214 , 1 , 2 , and 5 each correspond to the columns from left to right .",
    "the panels in the top two rows show the shape error @xmath195 as a function of the input galaxy ellipticity . in the top row , the airy psf is circular ( @xmath215 ) , while in the middle row the airy psf is anisotropic , with an ellipticity of @xmath155 .",
    "the psf and galaxy ellipticity both are elongated along @xmath216 ; we find that the results do not change even if we add a non - zero @xmath217 component to either the psf or the galaxy .",
    "the major axis orientation with respect to the pixel axis is irrelevant for deconvolution fits ( _ cf . _  [ deconvconvergence ] ) .",
    "the bottom row plots the difference in average measured shape between @xmath155 and @xmath215 .",
    "if the psf anisotropy is fully suppressed in the deconvolved galaxy - shape measurement , this difference should be zero .    in general",
    ", figure  [ fig : dcvlshapeerror100 ] shows the following two systematic shape measurement errors : ( 1 ) regardless of the psf anisotropy , the measurement error exhibit a slight systematic when the resolution is low ( @xmath218 ) . there is a constant positive slope in @xmath186 between @xmath219 .",
    "( 2 ) for @xmath220 , the slope turns around , eventually underestimating the shear at @xmath221 . in the region described by ( 1 ) ,",
    "the shear measurement errors are approximately @xmath222 , corresponding to @xmath223 .",
    "the well - resolved galaxies ( @xmath224 ) exhibit biases in shape measurement , which are a consequence of a peculiarity of the airy function psf .",
    "we will explain this below , and describe a remedy which yields the improved performance of the points marked `` blur . ''    despite these measurement systematics , however , the difference between the @xmath155 and @xmath225 measurements are less than a shear of 0.001 , equivalent to @xmath226 of the psf anisotropy , except for the poorly resolved ( @xmath214 ) and highly elliptical galaxies .",
    "hence our  implementation has a psf anisotropy bias suppression of @xmath3 at @xmath213 , except for the poorly - resolved case .",
    "we now examine deconvolution fits with galaxies of lower @xmath123 , using the combinations of resolution and significance marked by the circles sampling the @xmath3 convergence region in figure  [ fig : deconv - contour ] .",
    "figure [ fig : dcvlshapeerror ] shows the measurement error @xmath186 for a circular psf , and figure  [ fig : dcvlshapebias ] shows the shape bias induced by a psf ellipticity of @xmath155 .",
    "the content of these figures are similar to those on the top and bottom row of figure  [ fig : dcvlshapeerror100 ] , respectively .",
    "evaluated at input @xmath227 , the initial slope in @xmath186 and the value of the psf bias increase as @xmath228 as @xmath149 decreases . in both cases , there is a turn - around in the magnitude of the systematic , with a zero crossing in the region @xmath229 .",
    "a rough estimate for the shear error @xmath199 due to these shape errors ( assuming a flat @xmath150 distribution ) is 12% .",
    "figure  [ fig : dcvlerrorestimate ] plots the rms error ratio of the actual to the estimated @xmath230 for deconvolution fits , and is analogous to figure  [ fig : nativeerrorestimate ] . for the deconvolution ,",
    "the error estimate @xmath190 does fairly well for @xmath231 , while @xmath230 @xmath232 when @xmath233 .",
    "the open - circle points in the rightmost column of panels in figure  [ fig : dcvlshapeerror100 ] mark a tendency for the deconvolution procedure to underestimate the ellipticity of large objects .",
    "this can be traced to the fact that the airy function is rather poorly described by a gauss - laguerre expansion . in our default procedure , the size of the basis set of the egl expansion of the psf is made similar to the size of the psf itself ; in this case the airy function is poorly modelled at radii @xmath234 .",
    "for example the airy function has divergent second radial moment , while any egl expansion at finite order has a finite second radial moment , indicating that the egl expansion has failed to capture the large-@xmath235 behavior of the airy function .",
    "it takes gl order @xmath236 and @xmath237 to describe the first and second airy ring , respectively ; our simulations use gl order 12 to describe the psf .",
    "an equivalent statement is that , in the fourier domain , an egl expansion fails to properly describe the small-@xmath92 behavior of the airy function .",
    "this is not surprising since the airy function has a cusp at @xmath238 ( which is equivalent to having infinite second moment in real space ) .",
    "the cusp in turn results from the sharp edge of the illumination function of an unapodized circular mirror .",
    "the poor description of the airy function at large @xmath235 or small @xmath92 becomes important when trying to deconvolve images of well - resolved galaxies , because the shape information for large galaxies is carried at large @xmath235 and small @xmath92 relative to the psf .",
    "the finite egl expansion of the airy psf underestimates its circularizing effect on large galaxies , hence the deconvolved shapes are too round for large galaxies .",
    "marginally - resolved galaxies do nt have this difficulty because they carry their ellipticity information in the part of @xmath92-space where the egl expansion is a good match to the airy function .",
    "we see that this `` airy failure '' is not an intrinsic difficulty of the shape - measurement methodology , but rather stems from a poor model of the psf .",
    "this leads us to consider several possible solutions :    * describe the psf using a more appropriate function set than the gauss - laguerre expansion , if one expects nearly diffraction - limited images .",
    "this would complicate numerical calculation of the operator @xmath62 from  [ fits ] , but should fully restore the numerical accuracy for any psf .",
    "* when fitting well - resolved galaxies , choose a basis for the egl expansion of the psf which matches the size of the galaxy rather than the size of the psf .",
    "this puts the fitting freedom of the egl expansion in the range of @xmath92-space that is more important for the problem at hand ; the core of the airy function will be poorly fit but the wings will be better . *",
    "change the psf .    in these tests",
    "we implement the last of these three options , by blurring the postage - stamp and psf images with a gaussian that is a @xmath239 of the size of the galaxy , and then apply  deconvolution using the smeared image pair .",
    "the blurring decreases the size mismatch between the psf and galaxy gl bases , which improves the accuracy of the gl expansion at the size scale relevant to the large galaxy .",
    "the blurring very slightly increases the scatter of the shape measurement , but greatly reduces the bias , as seen in the figure .    to summarize , the cusp at @xmath238 in the airy psf is not well fit by our default psf characterization , leading to biases in the shape measurements .",
    "this can be remedied in a number of ways without invalidating our general approach .",
    "the previous section discussed shape measurement accuracies with a well defined input shape and high degree of symmetry .",
    "however , real galaxy images do not have an unambiguous shape nor a perfect exponential radial profile .    in this section",
    ", we measure the shapes of asymmetric galaxy images that have irregular isophotes (  [ imagemodel ] ) , for which there are no unambiguous definition of shape .",
    "however , in weak lensing , it is not the accuracy of the individual shape measurement , but rather the ability to recover the shear from an ensemble of shapes , that is well - defined and needs to be accurate . in this sense , the ring test provides a measure of accuracy for assigning a shape for these irregular galaxies .    in the ring test , the shape @xmath150 is determined by  measurements ; the same image , before pixelization , is rotated by a series of angles equally spaced between @xmath240 . each rotated image",
    "is then sheared by @xmath241 , @xmath242 or @xmath243 , then pixelized for the ring test . with @xmath244 different orientations and @xmath245 ( or more ) realizations each , the uncertainty in the mean shape is @xmath246 , where @xmath247 is the scatter in the @xmath216 measurements due to photon statistics .",
    "the ring test has no intrinsic - shape noise .",
    "we test both the native and deconvolution fit cases at a series of different significance @xmath149 , resolution @xmath248 , and galaxy ellipticity @xmath150 .",
    "the asymmetric galaxies of different shape @xmath150 are distinct combinations of exponential - disk and devaucouleur profiles ; they are not sheared versions of the same underlying shape .    additionally , the shear calibration factor @xmath249 and additive bias @xmath250 can be measured with the ring test .",
    "the additive bias is the non - zero offset of the average shape when setting @xmath251 in the ring test , and is typically present when @xmath252 .",
    "the calibration factor @xmath249 is then obtained by repeating the ring test with @xmath253 .      figure  [ fig : nativeshear ] shows the mean shape @xmath254 as a function of the galaxy ellipticity @xmath150 for native fits .",
    "the mean shape is expected to follow the curve @xmath255 .",
    "the approximation @xmath256 , valid to @xmath257 , is more than adequate here . for the various significance ( @xmath258 , @xmath259 , or @xmath260 ) , the mean shape follows the expected curve very well . in particular",
    ", we see that there is no significant additive bias @xmath250 seen in the @xmath241 data points , to an uncertainty of @xmath261 .    figure  [ fig : nativeshearnorm ] plots the calibration factor @xmath249 by normalizing @xmath254 for the @xmath262 cases to the expected signal @xmath255 , @xmath263 .",
    "the calibration is well within 1% of unity at @xmath264 , but at lower detection significance , there is a systematic underestimation of the order @xmath265 .",
    "the ring test with asymmetric galaxies is similarly performed with deconvolution fits , with a circular airy psf of @xmath266 and an elliptical psf with @xmath155 .",
    "figure  [ fig : dcvlshear ] shows the additive bias @xmath250 in the shape average @xmath267 when @xmath241 and @xmath155 , while figure  [ fig : dcvlshearnorm ] show the calibration factor @xmath249 for @xmath268 .",
    "both figures show various cases of @xmath269 pairs , which traces the @xmath160 convergence contour from figure  [ fig : deconv - contour ] .    figure  [ fig : dcvlshear ]  ( a ) shows @xmath250 as a function of @xmath150 at various @xmath269 pairs .",
    "there is an @xmath150 dependence to the additive bias , which increases in magnitude with decreasing @xmath149 . comparing with figure  [ fig : dcvlshapebias ]",
    ", we see that the additive bias is essentially identical to the psf bias found in symmetric galaxies , indicating that the psf bias is independent of the galaxy symmetry , or the orientation of the galaxy shape over the ensemble average .",
    "figure  [ fig : dcvlshear ]  ( b ) shows that for a given @xmath269 , the additive bias @xmath250 scales linearly with @xmath270 for reasonable @xmath270 values .",
    "figure  [ fig : dcvlshearnorm ] shows the calibration factor @xmath249 for @xmath266 , @xmath268 . at @xmath213 and better , the measured shear is within @xmath271 of the input shear signal . as the significance decreases ( @xmath272 ) , there is a multiplicative bias for galaxy shapes over @xmath273 , whose magnitude is about @xmath274 at @xmath275 ( axis ratio @xmath276 ) .",
    "similar results are found for @xmath249 for the case @xmath252 , where @xmath277 , but with increased error bars due to the additional uncertainty in @xmath250 .",
    "there are limitations to  with implications for wl surveys .",
    "if  is to be used for shape analysis , the sampling rate must be such that the psf minor - axis fwhm is sampled by @xmath278 pixels ; otherwise ,  fails to converge to a unique shape (  [ nativeconvergence ] ) .",
    "similarly , the psf - smeared objects which produce useful shapes must have a minimum resolution that depends on the significance ( or vice - versa ) in order to converge to a measurement of the pre - seeing galaxy shape .",
    "if we require shape measurements of all values of @xmath150 to be successful , then @xmath279 is required at @xmath280 , or @xmath281 at @xmath282 (  [ deconvconvergence ] ) .",
    "this implies that improvements in wl statistical accuracy are rapidly limited by the resolution of the galaxies : although going deep in the exposure increases the @xmath123 of the detected objects and reduces the scatter and systematic in the shear estimate , the required @xmath123 grows very rapidly for poorly resolved images , and it becomes difficult to produce additional useful wl data for poorly resolved galaxies .",
    "we have also found that larger , well resolved galaxies ( @xmath283 ) exhibit a problem with the deconvolution method when the psf is an airy function , due to the poor approximation of the airy - functions wings by the gl expansion .",
    "a simple remedy is available : smooth the psf and galaxy images before measuring both .",
    "another solution is to choose an alternative to gauss - laguerre as the psf decomposition basis functions , one that is better suited to describe an airy function .",
    "however , a non - gl decomposition will make the deconvolution process excessively complex ; another solution is to apodize the telescope to suppress the airy wings .",
    "@xcite offers an excellent description of the difference between various wl techniques ; we refer the reader to this paper for the difference between , for example , the ksb method and kuijken s method , which is applicable to the difference bewteen ksb method and the egl method .",
    "our egl method is similar to kuijken s polar shapelet method @xcite .",
    "what the methods have in common are : the deconvolution of the psf , which in principle allows for any psf effects to be removed ; forward fitting , which allows error propagation , and hence an error estimate to the measured shape ; and the definition of shape as shear , which has a well - defined shear transformation .",
    "all of these features contribute to a better shear accuracy .",
    "the differences between egl and kuijken s methods are subtle .",
    "the first difference is that kuijken method works the deconvolution and shearing in shapelet - coefficient space .",
    "our egl method determines the shape - as - shear by iteratively fitting within the pixel space .",
    "secondly , kuijken s method obtains the shape using a shear transformation valid to first - order in @xmath150 , which can be off by up to 10% at @xmath284 ( @xmath285 ) .",
    "our method uses basis functions that are elliptical , _ i.e. _ the shear transformation is valid to all orders , which allows for the shape to be measured accurately for any @xmath150 .",
    "the third difference is that , in kuijken s method , only the @xmath286 terms are used to describe the galaxy .",
    "this allows for less coefficients needed , and hence is efficient . in comparison , our method obtains the full set of coefficients to the specified order , which theoretically is more accurate under shearing or deconvolution .",
    "another difference is in the choice of scale radius .",
    "kuijken s method uses 1.3 times the best - fit gaussian @xmath139 for the basis function scale radius , which apparently is optimal for the first - order method ; egl uses the best - fit elliptical gaussian size , which gives the optimal sensitivity to small shear ( bj02  3.1 ) .    unlike the ksb method , our egl deconvolution method ,",
    "the @xcite polar shapelet and the @xcite methods do not rely on the approximation that the psf is circular up to a small linear `` smear . ''",
    "these methods are expected to do well on theoretical grounds ; their differences ( at least with * ? ? ?",
    "* ) seem to matter at the 1% level .      as mentioned earlier",
    ", the main difference between this paper and previous end - to - end tests @xcite is that we test the individual steps of the analysis .",
    "the difference is mainly in the distribution of galaxies : these end - to - end tests mimic the distribution to an actual wl field image , while we test at specific s / n and galaxy size ( resolution ) sets . by controlling the exact distribution of galaxy shapes , we also eliminate shape noise in the shear estimate , and are able to quantify the effect that noise or resolution / sampling has on the shear .    the main differences from other `` dissection '' methods @xcite are the inclusion of and quantifying noise effects , testing with asymmetric galaxies , and determining the limits of shape - measurement convergence .",
    "@xcite demonstrates the calibration errors for a variety of psfs ( gaussian , seeing - limited , diffraction - limited ) , while we only test for airy psfs as the worst - case scenario . in @xcite , the galaxy types were varied as well ( gaussian , exponential , devaucouleurs ) , but they are symmetric , which can mask potential problems in shape measurements .",
    "their simulation focuses on the calibration accuracy , but does not quantify the additive error or include noise effects .",
    "@xcite includes an analysis with noise , but does not quantify them ; a variety of sersic indices ( for galaxies ) are tested , but are symmetric .",
    "their psfs do not test the diffraction - limited ( airy ) case , although asymmetric psfs , which are not considered in this paper , are tested .      with the egl method ,",
    "the systematic due to the shape measurement method is well under the 0.1% level under ideal native - fit conditions , where the galaxy is symmetric and psf is absent , as long as the minimum sampling and s / n criteria ( minor axis width @xmath287 pixels , @xmath288 ) are met .",
    "the deviation from this high accuracy comes from real - life complications . in native fits , when the galaxies are not elliptically symmetric ,",
    "the shear calibration factor degrades by @xmath289 as s / n is decreased .",
    "the presence of a psf further complicates the matter ; deconvolution with psfs of truncated coefficients becomes a source of error for well - resolved objects with an airy psf ( up to 0.5% ) , but solutions to this poor approximation of the psf are straightforward .",
    "more generally , the circularly - symmetric airy psf itself introduces an @xmath150 dependent systematic in the calibration factor , at worst @xmath290 at @xmath291",
    ". a non - circular psf adds a shear additive error that is proportional to the shape of the psf , which also increases with decreasing s / n ( up to @xmath292 of @xmath270 at @xmath280 ) . for the deconvolution",
    "fits , the sign and magnitude of the calibration and additive error is approximately the same for both the symmetric and asymmetric galaxies .",
    "the systematics are typically inversely proportional to the s / n . at high s / n ( @xmath293 ) , we have calibration error @xmath294 , and the psf anisotropy is @xmath3 suppressed .",
    "these errors become @xmath4 problems as @xmath295 .",
    "the systematics are a function of the galaxy shape itself as well , with the systematic at low @xmath150 having the reverse sign of that at high @xmath150 .    to attain 0.1% accuracy that is desired in future wl surveys , it is obvious that this shape measurement method itself needs to be refined .",
    "in addition , the whole pipeline needs to be rid of any systematics that are unrelated to the shape measurement , such as crowding or selection effects .",
    "the elliptical gauss - laguerre decomposition is one of the most stringently tested methods to characterize shapes of galaxies . with the egl decomposition",
    ", shapes are measured without the need for empirical shear / smear polarizabilities , and psfs are removed by deconvolution .",
    "the shear , obtained from averaging an isotropic ensemble of galaxy shapes , is highly accurate due to the definition of shape as shear .",
    "we have demonstrated that the egl method allows shear recovery of unprecedented accuracy , and quantified its degradation due to psf , truncation of the egl decomposition , image noise , and sampling  rate / resolution .",
    "however , the current work is limited to the extraction of shapes ; further work , including the full pipeline analysis , is required for attaining 0.1% accuracy in shear estimation .",
    "we would like to thank david rusin and mike jarvis for much assistance and consultation .",
    "this work is supported by grants ast-0236702 from the national science foundation , department of energy grant doe - de - fg02 - 95er40893 and nasa befs-04 - 0014 - 0018 .",
    "bridle , s. , kneib , j .-",
    "p . , bardeau , s. , & gull , s.  2002 , the shapes of galaxies and their dark halos , proceedings of the yale cosmology workshop `` the shapes of galaxies and their dark matter halos '' , new haven , connecticut , usa , 28 - 30 may 2001 .   edited by priyamvada natarajan .",
    "singapore : world scientific , 2002 , isbn 9810248482 , p.38 , 38"
  ],
  "abstract_text": [
    "<S> we implement the elliptical gauss - laguerre ( egl ) galaxy - shape measurement method proposed by bernstein & jarvis ( 2002 ) [ @xcite ] and quantify the shear recovery accuracy in weak lensing analysis . </S>",
    "<S> this method uses a deconvolution fitting scheme to remove the effects of the point - spread function ( psf ) . </S>",
    "<S> the test simulates @xmath0 noisy galaxy images convolved with anisotropic psfs , and attempts to recover an input shear . </S>",
    "<S> the tests are designed to be immune to shape noise , selection biases , and crowding . </S>",
    "<S> the systematic error in shear recovery is divided into two classes , calibration ( multiplicative ) and additive , with the latter arising from psf anisotropy . at s </S>",
    "<S> / n @xmath1 , the deconvolution method measures the galaxy shape and input shear to @xmath2 multiplicative accuracy , and suppresses @xmath3 of the psf anisotropy . </S>",
    "<S> these systematic errors increase to @xmath4 for the worst conditions , with poorly resolved galaxies at s / n @xmath5 . </S>",
    "<S> the egl weak lensing analysis has the best demonstrated accuracy to date , sufficient for the next generation of weak lensing surveys . </S>"
  ]
}