{
  "article_text": [
    "kinetic simulations of plasmas and gases follow the trajectories of individual particles as they evolve from an initial state , often one for which the velocities are random variates drawn from a specified distribution function . for systems with negligible relativistic and quantum effects ,",
    "that distribution is often the maxwell - boltzmann ( maxwellian ) .",
    "generating initial particle velocities is then straightforward since a non - relativistic maxwellian separates , with each coordinate governed by a gaussian ( normal ) distribution for which quick and simple methods of generating variates are known @xcite . drifting distributions ( those with non - zero average velocities )",
    "are only slightly more complicated since galilean transformations apply in the non - relativistic limit .    special relativity ,",
    "however , does not permit velocities greater than the speed of light @xmath0 and is thus incompatible with a maxwellian distribution that predicts a non - zero probability for every velocity .",
    "jttner @xcite introduced the first relativistic generalization of the maxwellian , basing the derivation on boltzmann s expression for the probability of finding a system in a state with energy @xmath1 , @xmath2 here @xmath3 , @xmath4 , @xmath5 , and @xmath6 are the distribution function , boltzmann s constant , the temperature , and the partition function , respectively .",
    "in special relativity the total energy for a particle with rest mass @xmath7 is @xmath8 , although it is often more useful to consider the kinetic energy @xmath9 , which only differs by a factor that can be absorbed into the normalization . defining @xmath10 and henceforth writing velocities , momenta , and energies in dimensionless units",
    " @xmath11 , @xmath12 , and @xmath13  gives the distribution @xmath14 perhaps surprisingly , the correct form of @xmath15 is still being debated @xcite , but , fortunately for the purposes of variate generation , it only contributes a multiplicative factor that , crucially , does not depend on the momentum .",
    "hence , for any variate - generating algorithm in which only ratios of @xmath3 appear , @xmath15 ( and , in fact , any multiplicative pre - factors that do not depend on the momentum ) can be dropped .    neither jttner s distribution nor equation [ boltz ] , from which it can be derived , are lorentz - covariant ( i.e. , expressed solely in terms of scalars , 4-vectors , etc . ) .",
    "synge @xcite was perhaps the first to suggest a covariant form , the only features of which that matter for variate generation are : ( 1 ) @xmath1 changes between reference frames via a lorentz transformation , and ( 2 ) the form of the variation in @xmath5 between reference frames is known .",
    "this work assumes @xmath5 is an invariant , but the formalism directly carries over to the case @xmath16 , where @xmath17 is the reference frame velocity .    both the isotropic and drifting relativistic maxwellians are special cases of a class known as generalized hyperbolic distributions that was first used by barndorff - nielsen to describe measurements of aeolian sand grains @xcite .",
    "although the original work considered univariate ( i.e. , one - dimensional ) distributions , multivariate versions quickly followed @xcite , as did algorithms for generating random hyperbolic variates via a mixture of normally - distributed variates and variates of the generalized inverse gaussian distribution @xcite .",
    "the semi - heavy tails of generalized hyperbolic distributions make them useful for modelers of financial markets and has spurred the development of several numerical packages for generating variates",
    ". however they tend to work efficiently only for a narrow range of temperatures and drift speeds .",
    "pozdnyakov et al .",
    "@xcite describe an algorithm specific to the relativistic maxwellian distribution , albeit restricted to the isotropic case , that separately considers the large and small @xmath18 limits .",
    "its efficiency ( defined as how often the procedure generates an acceptable variate ) , varies from nearly @xmath19 for @xmath20 to @xmath21 for @xmath22 .",
    "the algorithm presented here is slightly more complicated but also more general , as it works efficiently ( @xmath23 for all @xmath18 in the isotropic case ) for nearly arbitrary drift speeds and temperatures    sections [ statmax ] and [ movemax ] address the generation of variates for stationary and drifting maxwellians , respectively .",
    "both use an algorithm originally due to devroye @xcite that has been adapted for this work and is described in the appendix .",
    "using the rest - frame relationship between energy and momentum , equation [ boltz ] becomes @xmath24 @xmath15 has been dropped since , as discussed in section [ intro ] , it does not affect the generation of variates .",
    "this distribution function is isotropic and can be re - written more conveniently in terms of @xmath25 by moving to spherical coordinates , integrating over the angle variables , and dropping the constant pre - factors : @xmath26 by keeping the seemingly extraneous @xmath27 term , @xmath3 can be written in an equivalent form @xmath28 that avoids numerical problems in the exponent for small @xmath29 .",
    "once a @xmath29 has been generated from this distribution , it can be uniformly distributed over the surface of a sphere ( see , e.g. , knop@xcite ) to give individual cartesian components .    since @xmath3 is log - concave , i.e. , @xmath30 for all @xmath29 , the algorithm described in the appendix",
    "can be used to generate random variates .",
    "the only additional information needed is the mode @xmath31 figure [ isofig ] demonstrates the results for @xmath32 ( roughly typical of water vapor at room temperature ) , @xmath33 ( kev protons ) , @xmath34 ( mev electrons ) , and @xmath35 ( tev electrons ) .",
    "the top portion of each panel compares the expected @xmath3 from equation [ isomax_stable ] to a histogram of the generated variates .",
    "the two curves , each normalized to unit area , are nearly indistinguishable and so the bottom portion of each panel plots the ratio of the histogram to the expected value on a logarithmic scale ranging from @xmath36 to @xmath37 . because the variate - generating algorithm is based on the rejection method , not every generation attempt succeeds . for each panel",
    "@xmath33 attempts were made , with the success rate varying only slightly with @xmath18 , from @xmath38 for @xmath39 to @xmath40 for @xmath41 .",
    "although the algorithm produces excellent results for all @xmath18 , note that in systems with @xmath42 pair production can occur and any distribution that assumes a constant particle number , such as the @xmath3 of equation [ isomax ] , can not be completely accurate .",
    "comparison between the theoretical distribution of @xmath29 from equation [ isomax_stable ] and the generated random variates for isotropic relativistic maxwellians with different values of @xmath18 .",
    "the top plot in each of the four panels shows the theoretical distribution in black with the computed distribution over - plotted in red .",
    "the bottom plot shows the ratio of the computed to theoretical distributions on a log scale ranging from @xmath36 to @xmath37 .",
    "note the different axis scales for each panel . ]    in the non - relativistic limit the exponential term in equation [ isomax ] reduces to @xmath43 , which implies that varying @xmath18 and @xmath44 by the same factor will produce similar distributions .",
    "this effect can be observed in panels ( a ) and ( b ) which , aside from the axis scales , are nearly identical .",
    "panels ( c ) and ( d ) cover the relativistic limit in which the exponential term reduces to @xmath45 so that jointly scaling @xmath18 and @xmath46 produces the same effect .",
    "in a frame moving with velocity @xmath47 with respect to the rest frame the lorentz - transformed energy of a particle is @xmath48 where @xmath49 . equation [ boltz ] then becomes @xmath50 to proceed , define a coordinate system with axes parallel and perpendicular to the drift velocity , @xmath51 ) .",
    "the anisotropic , non - separable form of @xmath3 means that the perpendicular momenta must be generated conditional on the value of @xmath52 . moving to cylindrical coordinates and",
    "integrating over the perpendicular coordinates gives the distribution for @xmath52 @xmath53 ignoring , as usual , multiplicative scaling coefficients leaves @xmath54 and it is again useful to express the exponent in a numerically stable form , @xmath55 where @xmath56 and @xmath57 .",
    "this distribution is log - concave with mode @xmath58 and the algorithm of the appendix will generate variates of @xmath52 .    given a @xmath52 variate , a @xmath59 variate conditional on it can be found .",
    "writing @xmath60 the conditional distribution is @xmath61 which is equivalent to @xmath62 /(\\gamma_{\\parallel}\\gamma_u\\gamma_s+p_{\\parallel}p_u+1)}\\ ] ] the mode of @xmath3 , which is again log - concave , is @xmath63    with this background , the procedure for generating the variates of a drifting relativistic maxwellian is : ( 1 ) generate a variate for @xmath52 using the distribution of equation [ ppar ] ; ( 2 ) for each @xmath52 variate , attempt to generate a @xmath64 variate from the distribution of equation [ pperp ] ( if the attempt fails , discard @xmath52 and return to step 1 ) ; ( 3 ) with @xmath65 and a variate @xmath66 uniformly distributed on @xmath67 $ ] , generate the individual perpendicular variates via @xmath68 and @xmath69 ; ( 4 ) if necessary , transform from parallel / perpendicular coordinates to the desired coordinate system .    in order to check this procedure ,",
    "it is useful to establish a one - dimensional version of the distribution of equation [ driftmax ] .",
    "to do so , express @xmath70 in spherical coordinates , integrate over solid angle , and drop unnecessary scaling factors : @xmath71 the result , @xmath72 reduces , as it must , to equation [ isomax ] when @xmath73 .",
    "figure [ shiftfig ] compares the generation of variates from distributions with four combinations of @xmath18 and @xmath17 with the theoretical form given by equation [ shiftcomp ] . for each combination , @xmath33 attempts were made to generate @xmath52 and , if successful , @xmath74 .",
    "the resulting total efficiency of @xmath75 depends only weakly on the parameters with small @xmath18 ( as in the stationary case ) and small @xmath17 yielding slightly higher values , reflecting the slightly better fits of the rejection method s bounding functions in those cases . in panels ( a ) and ( c ) the momentum corresponding to the drift , @xmath76 , is larger than the typical thermal momentum and , as a consequence ,",
    "the particle momenta are distributed nearly symmetrically about @xmath77 .",
    "panels ( b ) and ( d ) , in contrast , display cases where the drift has minimal effect and the curves more resemble those of figure [ isofig ] .",
    "comparison , in the same format as figure [ isofig ] , between the theoretical distribution of @xmath29 from equation [ shiftcomp ] and the generated random variates for drifting relativistic maxwellians with different values of @xmath18 and @xmath17 . in panel ( a ) , @xmath78 .",
    "note the different axis scales for each panel . ]",
    "the procedure outlined in this section still works when @xmath73 , albeit more slowly and less efficiently than that of section [ statmax ] because it requires a second , nested call of the variate - generating algorithm .",
    "interestingly , there exists an analytic expression that , given a single uniformly distributed variate , always returns a variate of @xmath79 from the @xmath3 of equation [ pperp ] .",
    "such a formula can be found whenever the inverse function of the integral of @xmath3 is known ; in this case it can be written in terms of the lambert @xmath80 function , for which the defining equation is @xmath81 $ ] ( i.e. , @xmath82 is the inverse function of @xmath83 ) .",
    "the solution is @xmath84\\right)\\ ] ] where @xmath85 is a uniformly distributed variate on @xmath86 $ ] .",
    "@xmath82 is multi - valued and @xmath87 refers to the lower branch which , for real @xmath88 , is only defined on the interval @xmath89 with @xmath90 and @xmath91 . equation [ lambert ] can be further simplified by noting that @xmath92 , but even in that form remains ill - suited for numerical work in the large @xmath18 limit .",
    "the algorithm below , originally described in devroye @xcite and reproduced here in a slightly altered and simpler form , generates random variates for a log - concave distribution function @xmath3 ( one satisfying @xmath93 ) by applying the rejection method @xcite to a piecewise - continuous upper bound constructed of three functions : a constant intersecting the mode of @xmath3 and two exponential tails .",
    "preliminary calculations are necessary to find the points @xmath94 and @xmath95 at which the three bounding curves meet ; it can be shown that the optimal choices satisfy @xmath96 , where @xmath97 is the distribution s mode .",
    "every @xmath3 considered in this work is a well - behaved uni - modal function and standard root - finding methods ( applied , for computational ease , to the equations @xmath98",
    "+ 1=0 $ ] ) quickly converge to @xmath99 .",
    "note that because @xmath3 only appears in ratios , even during the preliminary root - finding , its normalization is irrelevant .",
    "although the algorithm is not guaranteed to generate a variate on each iteration , its efficiency for an arbitrary @xmath3 can be shown to lie between @xmath100 and @xmath19 .",
    "generation of @xmath33 variates takes @xmath101 seconds in unoptimized fortran . for additional algorithmic details , derivations ,",
    "a discussion of efficiency , and alternative methods , see devroye@xcite .",
    "@xmath97 is the mode of @xmath3 + @xmath95 and @xmath94 satisfy @xmath96 + @xmath102 , @xmath103 + @xmath104 , @xmath105 , @xmath106 generate @xmath85 and @xmath107 , uniform variates on @xmath86 $ ] @xmath108 @xmath109 done @xmath110 @xmath111 done @xmath112 @xmath113 done @xmath114    15ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ] ",
    "+ 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty @noop * * ,   ( ) link:\\doibase",
    "10.1002/andp.19113390503 [ * * ,   ( ) ] link:\\doibase 10.1063/1.2165771 [ * * ( ) ,  10.1063/1.2165771 ] link:\\doibase 10.1103/physreve.81.021126 [ * * ,   ( ) , 10.1103/physreve.81.021126 ] link:\\doibase 10.5194/angeo-29 - 1259 - 2011",
    "[ * * ,   ( ) ] @noop _ _ ( ,  ) @noop * * , ( ) @noop * * ,   ( ) `` , ''  in  @noop _ _ ,  , vol .",
    "( ,  )  pp .   @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) `` , ''  ( ,  )  chap .  , pp .  , @noop * * ,   ( ) `` , ''  ( ,  )  chap .  , pp ."
  ],
  "abstract_text": [
    "<S> a procedure for generating random variates from a relativistic maxwellian distribution with arbitrary temperature and drift velocity is presented . </S>",
    "<S> the algorithm is based on the rejection method and can be used to initialize particle velocities in kinetic simulations of plasmas and gases . </S>"
  ]
}