{
  "article_text": [
    "density functions , i.e. borel measurable , positive functions on a support @xmath2 with a unit integral constraint , can be considered as a special case of functional data @xcite .",
    "nowadays , they frequently occur in practice due to large - scale database systems , where the individual observations are summarized by distributions to preserve their intrinsic variability and enable to analyze statistically groups of individuals in meaningful way @xcite , i.e. to form distribution - valued variables .",
    "nevertheless , for density functions the usual @xmath0 metric seems to be not appropriate .",
    "not just because of the unit - integral constraint ( that forms rather a proper representation due to probability conventions than an inherent feature of densities themselves ) , in addition , density functions also contain information on relative contributions of borel sets of real line to the overall probability on the ( possibly infinite ) support of the corresponding random variables . as a way out",
    ", bayes spaces with separable hilbert space properties were proposed for geometric representation of density functions @xcite . in order to enable standard statistical analysis of density functions , an isomorphic mapping from the bayes space to the standard @xmath0 space",
    "is needed .",
    "considering the finite interval support case ( specially @xmath3 $ ] for real @xmath4 ) , where lebesgue measure as reference measure can be used @xcite , the simplest such isomorphism is represented by the _ centred logratio ( clr ) transformation _ , defined for a density function @xmath5 as @xmath6=f_c(x)=\\ln f(x)-\\frac{1}{\\eta}\\int_i\\ln f(x)\\,\\mbox{d}x,\\ ] ] where @xmath7 stands for length of the interval @xmath2 , in particular @xmath8 . because clr transformation forms a one - to - one mapping",
    ", the inverse clr transformation is obtained as @xmath9=\\frac{\\exp(f_c(x))}{\\int_i\\exp(f_c(x))\\,\\mbox{d}x};\\ ] ] the denominator is used just to achieve the unit integral constraint representation of the resulting density ( without loss of relative information , carried by the density function ) .",
    "equations ( [ fclr ] ) and ( [ fclrinv ] ) come as a functional version of the popular centred logratio transformation of compositional data , multivariate observations that carry relative information , see @xcite for details .",
    "nevertheless , because obviously @xmath10\\,\\mbox{d}x=0,\\ ] ] this additional condition needs to be taken into account for computation and analysis of clr transformed density functions .",
    "although the clr transformation may lead to computational problems for some of statistical methods due to constraint ( [ fcond ] ) , it is still well acceptable for distance - based methods or functional principal component analysis , similarly as for the case of compositional data , and could thus extend the currently existing analytical tools @xcite .",
    "however , density functions ( as well as functional data in general ) occur in the practice rarely in their continuous form .",
    "for example , the aggregation of individual observations in case of the distribution - valued variables leads naturally to discretized form of histogram data that need to be approximated ( smoothed ) by an appropriate function .",
    "no wonder that approximation of nonparametric distributions is one of basic problems of functional data analysis @xcite and a number of publications are devoted to cope with this issue @xcite . for the purpose of functional data analysis , smoothing @xmath1-splines turned out to be the most appropriate approximative tool as the resulting coefficients of basis functions can be directly used for further statistical analysis @xcite .",
    "nevertheless , taking the inherent features of densities into account , the possibility of obtaining smoothing splines ( and even @xmath1-splines ) in case of density functions gets quite a complex problem @xcite . in @xcite logarithmic transformation",
    "is proposed to simplify the estimation process and properties of the resulting splines , nevertheless , without any deeper methodological background .",
    "although the methodology of bayes spaces was successfully applied to theoretical problems related with bayesian approach to statistical analysis @xcite , its application to statistical processing of density functions is still limited due to absence of a reasonable approximation tool that would enable to proceed from functional data to smooth functions .",
    "neither smoothing the original discretised densities @xcite nor using of bernstein polynomials , that is proposed in @xcite , is coherent with the bayes space methodology .",
    "a natural and logical step to perform smoothing of density functions using @xmath1-splines is to express the data in the @xmath0 space of clr transformed densities and to perform the computations there .",
    "consequently , it is guaranteed that all theoretical properties of smoothing @xmath1-splines hold and no additional reasoning is necessary .",
    "nevertheless , the condition ( [ fcond ] ) needs to be taken into account for estimation of spline coefficients .",
    "the aim of the paper is to provide a concise solution of this problem from the point of view of numerical mathematics .",
    "the paper is organized as follows .",
    "the next section is devoted to general theory of @xmath1-spline representation , followed by the optimal smoothing problem , representing a trade - off between interpolation and the least squares approximation , in section 3 . in this section also a solution for the conditional smoothing is proposed .",
    "section 4 continues with concrete example , based on a real - world data set ; finally , section 5 concludes .",
    "in this section we recall some basics concerning the @xmath1-spline representation of splines , see for example @xcite .",
    "let the sequence of knots @xmath11 be given . in the following ,",
    "@xmath12 $ ] denotes the vector space of polynomial splines of degree @xmath13 , defined on a finite interval @xmath14 $ ] with the sequence of knots @xmath15 .",
    "it is known that @xmath16\\right)=g+k+1 $ ] .",
    "then every spline @xmath17 $ ] has a unique representation @xmath18 vector @xmath19 is _ vector of @xmath1-spline coefficients _ of  @xmath20 , functions @xmath21 , @xmath22 are _ @xmath1-splines of degree @xmath23 _ and form basis in @xmath12 $ ] .",
    "let @xmath24 be given and let @xmath25 be _ b_-spline basis of  @xmath12 $ ] .",
    "then @xmath26 is called _ the collocation matrix_.    consequently , every spline from @xmath12 $ ] can be written in matrix notation as @xmath27    now let @xmath28 .",
    "it is known that derivative of order @xmath29 of the spline @xmath17 $ ] is a spline @xmath30 $ ] with the same knots . using properties of @xmath1-splines",
    "the spline derivatives can be written in matrix notation as @xmath31 where @xmath32 is given by @xmath33 and @xmath34 .",
    "upper triangular matrix @xmath35 has full row rank ; hereat @xmath36 is diagonal matrix such that @xmath37 with @xmath38 and @xmath39",
    "the optimal smoothing problem represents a compromise between the interpolation problem and the least squares approximation .",
    "let data @xmath40 , @xmath41 , weights @xmath42 , @xmath43 , @xmath44 and parameter @xmath45 are given . for @xmath28",
    "the task is to find a spline @xmath17 $ ] , which minimizes functional @xmath46^{2}\\,\\mbox{d}x+\\alpha\\sum\\limits_{i=1}^{n}w_{i}\\left[y_{i}-s_{k}(x_{i})\\right]^{2}.\\ ] ] this spline is called _ the smoothing spline . _",
    "further we denote @xmath47 , @xmath48 , @xmath49 and @xmath50 .",
    "the functional @xmath51 can be written in a matrix form as @xmath52^{\\top}{\\bf w}[{\\bf y}-{\\bf c}_{k+1}({\\bf x}){\\bf b}\\right].\\ ] ] matrix @xmath53 is positive semidefinite , where @xmath54 and @xmath55 stands for scalar product of @xmath1-splines in @xmath56)$ ] space .",
    "matrix @xmath57 is positive definite , because @xmath58 , @xmath59 are basis functions .",
    "our aim is to find a spline @xmath17 $ ] , which minimizes functional @xmath51 , in other words , we want to find a minimum of function @xmath60 . from the necessary and sufficient condition for",
    "a minimum of this function , i.e. @xmath61 we get a system of linear equations @xmath62{\\bf b}={\\bf c}_{k+1}^{\\top}({\\bf x}){\\bf wy}.\\ ] ] solution of this system exists if and only if this system is consistent , i.e. @xmath63 and it is given by @xmath64^{-}{\\bf c}_{k+1}^{\\top}({\\bf x}){\\bf wy}.\\ ] ] here @xmath65 denotes the range of matrix @xmath66 .",
    "matrix @xmath67 is a generalized inverse of @xmath66 , i.e. a matrix such that @xmath68 , see @xcite for details . if matrix @xmath66 is regular , then @xmath69 .    accordingly ,",
    "if the matrix of the system ( [ sm ] ) is regular , then there exists a unique solution of ( [ sm ] ) , i.e. there exists a unique smoothing spline .",
    "if matrix of ( [ sm ] ) is singular and the system ( [ sm ] ) is consistent , then there exists a class of solutions . in this case",
    "we can find _ a minimum norm solution _ of ( [ sm ] ) , i.e. a solution which has the smallest norm among all solutions .",
    "such solution is unique and is given by @xmath70^{-}_{m}{\\bf c}_{k+1}^{\\top}({\\bf x}){\\bf wy};\\ ] ] then we refer to a unique _ optimal smoothing spline_. the symbol @xmath71 denotes _ a minimum norm generalized inverse _ ,",
    "i.e. a matrix such that @xmath72    consequently , the required smoothing spline or optimal smoothing spline are obtained by formula @xmath73 where the vector @xmath74 is given in ( [ b * * ] ) and ( [ bm * * ] ) , respectively .    in the case",
    "of smoothed clr transformed density functions an additional condition @xmath75 needs to be fulfilled . from @xmath1-spline representation of splines",
    "it is known that the spline @xmath76 is a derivative of spline @xmath77 if @xmath78    now let s consider a spline @xmath17 $ ] such that condition ( [ p ] ) holds , i.e. @xmath79_{a}^{b}=s_{k+1}(\\lambda_{g+1})-s_{k+1}(\\lambda_{0}),\\ ] ] because @xmath80 , @xmath81 .",
    "with respect to the definition , properties of @xmath1-splines and the mentioned additional knots we get @xmath82 so that @xmath83 now we find a relationship between the vector @xmath19 of @xmath1-spline coefficients of @xmath20 and the vector @xmath84 of @xmath85 , @xmath86 . using ( [ cc ] ) we can write @xmath87 where @xmath88 , @xmath89 and @xmath90 note that both matrices @xmath91 and @xmath92 are regular . the goal is to find a vector @xmath93 , which minimizes function @xmath60 given in ( [ jb ] ) and satisfies condition ( [ bc1 ] ) simultaneously . using both relationships",
    "we can rewrite function @xmath60 as @xmath94^{\\top}{\\bf w}\\left[{\\bf y}-{\\bf c}_{k+1}({\\bf x})\\mathbf{dk\\bar{c}}\\right].\\ ] ] minimum of @xmath95 is a solution of the following system , @xmath96{\\bf      \\bar{c}}=\\left({\\bf c}_{k+1}({\\bf x})\\mathbf{dk}\\right)^{\\top}{\\bf wy}.\\ ] ]    for this system of linear equations we can perform similar considerations as ( [ sm ] )",
    ". concretely , if the system ( [ sc ] ) is consistent and its matrix is not regular , then a solution of ( [ sc ] ) exists , @xmath97^{-}\\mathbf{k}^{\\top}\\mathbf{d}^{\\top}{\\bf c}_{k+1}^{\\top}({\\bf x}){\\bf wy}.\\ ] ] the minimum norm solution among all solutions of ( [ sc ] ) is given by @xmath97^{-}_{m}\\mathbf{k}^{\\top}\\mathbf{d}^{\\top}{\\bf c}_{k+1}^{\\top}({\\bf x}){\\bf wy}.\\ ] ] finally , the vector of @xmath1-spline coefficients is obtained as @xmath98    it is important to note that the resulting @xmath1-spline coefficients fulfill the condition of zero sum , known from discrete version of the clr transformation .",
    "this is important for further theoretical reasoning , when functional counterparts to multivariate statistical methods for compositional data ( like principal component analysis @xcite ) are introduced .",
    "the resulting splines can be used either to back - transform them to the original bayes space of density functions ( in order to provide their smoothed counterparts for visualization and interpretation purposes ) , or for their further statistical analysis in the clr space . in the next section",
    "the smoothing step is performed for real data from an italian household survey .",
    "in the following , the above theoretical considerations are applied to a real - world data set from official statistics .",
    "we employ data from italian survey of household income and wealth ( shiw ) , collected by the bank of italy @xcite . for the purpose of our study , from the sampled records of about 8,000 households annual income distributions in all 20 italian regions",
    "were aggregated into form of distribution - valued variables . in order to exclude outlying observations that would destroy the smoothing process , from non - zero income values in the whole data set those above 99% quantile were omitted .",
    "consequently , for values from single regions the optimal number of classes was computed ( according to the well - known sturges rule ) , resulting in mean value @xmath99 , i.e. nine equidistant income classes in the range @xmath100 $ ] were constructed .",
    "data @xmath101 thus correspond to midpoints of income intervals , relative frequencies ( proportions of income classes on the overall income distribution in single regions ) stand for @xmath102 values . because of count character of values in income classes ,",
    "also some zero values occurred that would make further processing using centred logratio transformation not possible .",
    "for this reason , their imputation using a model - based procedure was performed @xcite ; the resulting complete data are collected in table [ propor ] . moreover , for subsequent interpretation purposes , the employed italian regions were divided into three parts according to their geographical location ( @xmath103 , @xmath104 , @xmath105 ) , following the national statistical institute ( istat ) classification .",
    "[ propor ]    furthermore , we perform the discrete version of clr transformation @xcite , defined as @xmath106 , where @xmath107 denotes geometric mean of the argument values ; as expected , a condition @xmath108 holds .",
    "the obtained values for all employed regions are displayed in table [ clrincome ] .",
    "[ clrincome ]    now we can finally proceed to approximate the clr transformed proportions in the @xmath0 space with optimal smoothing splines from section 3 .",
    "let @xmath109 denotes the vector of interval midpoints and @xmath110 for @xmath111 .",
    "for the purpose of our study , the parameter @xmath112 was set simply to @xmath113 , other options are discussed in @xcite .",
    "furthermore , we set @xmath114 , @xmath115 ( i.e. , cubic splines are employed ) and we will consider knots @xmath116 for our optimal smoothing problem .",
    "the corresponding spline coefficients are collected in table [ clrcoef ] ; note that the zero sum constraint is fulfilled as well .",
    "the resulting optimal smoothing splines can be also back - transformed to the original bayes space of density functions , see figure [ f1 ] .",
    "it is easy to see from the up plot that the @xmath1-spline functions nicely follow the clr - transformed proportions .",
    "this is due to both the proper underlying geometry for the approximation procedure , provided by the @xmath0 space , but also the choice of knots that avoids nuisance variability of densities .",
    "moreover , regional effects of income distribution are nice visible , in particular different distributions for northern and middle italian regions comparing to the southern ones .",
    "[ clrcoef ]        finally , we compare the presented approach with an alternative concept of using cubic smoothing splines for the original proportional data ( table [ propor ] ) as proposed in @xcite , where the knots correspond to data points @xmath117 , @xmath111 ; furthermore , parameters @xmath114 and @xmath115 were set as before . from figure [ f2 ] with the resulting smoothed densities several features can be easily derived .",
    "in addition to choppy right tails as a consequence of inappropriate choice of knots ( a typical situation is shown in figure [ f3 ] , up , for the case of liguria region ) also negative values are reached on the left tail of curves , and for some of regions even on the right tail of densities as well .",
    "although numerically this undesired effect ( that was automatically avoided before ) could be overcome by the logarithmic transformation of the original density functions and subsequent maximum - likelihood estimation of the @xmath1-spline coefficients as proposed in @xcite , this approach would still ignore the inherent geometrical features of densities , captured by the bayes space methodology .",
    "moreover , as a consequence of the relative scale property of density functions , captured by smoothing in the clr space , also data structure itself seems to be quite different for both approaches .",
    "for example , valle daosta with the highest maximum among income distributions of northern regions ( see figure [ f1 ] , down ) shows an exceptional behaviour , when the estimation is performed in the clr space .",
    "this could be easily explained by the fact that in this region there is indeed a lot of wealth with respect to the rest of italy and the local population gains also from a low - tax policy due to the special autonomous status of the valle daosta region . on the other hand , this particular behaviour is rather not visible , when approximating the original proportions .",
    "with modern monitoring tools that enable to produce huge amounts of data , statistical analysis of density functions become more and more important .",
    "although the theoretical background for their meaningful statistical treatment , provided by bayes spaces , is already available , for its practical applicability a wide spectrum of mathematical problems needs to be solved .",
    "this paper handled one of them , smoothing of clr transformed density functions .",
    "we have shown that @xmath1-splines represent an easy - to - handle tool for this purpose , moreover , the special case of smoothing splines provides a trade - off between the interpolation problem and the least squares approximation .",
    "for the real - world data example , where income distributions in 20 italian regions were analyzed , the advantages of the bayes space approach were clearly demonstrated by comparison with approximation of the original densities using cubic smoothing splines as proposed in @xcite .",
    "in addition to the above advances also `` dimention reduction '' of the discrete input data , provided by the @xmath1-spline coefficients , should be mentioned that enables to analyze statistically also high - dimensional functional data ( resulting , e.g. , from metabolomical experiments ) .",
    "we avoided to compare the results with the case of approximation of density functions with bernain polynomials , proposed in @xcite , as they represent a completely different concept of representation of densities ; nevertheless , also here similar effects , resulting from ignoring the relative character of density functions , could be observed .",
    "of course , this paper can not be considered as a final solution , it rather opens a further variety of challenges concerning smoothing of density functions using bayes spaces ( concerning choice of basis functions , optimal choice of knots etc . ) .",
    "on the other hand , we are convinced that it provides a concise approach and set a clear direction for future research developments in the field .",
    "egozcue , v. pawlowsky - glahn , r. tolosana - delgado , m.i .",
    "ortego , k.g .",
    "van den boogaart , _ bayes spaces : use of improper distributions and exponential families _ , revista de la real academia de ciencias exactas , fisicas y naturales .",
    "serie a. matematicas , doi 10.1007/s13398 - 012 - 0082 - 6 .",
    "mchler , _ estimating distributions with a fixed number of modes _ , in h. rieder , ed . , robust statistics , data analysis , and computer intensive methods workshop in honor of peter j. huber , on his 60th birthday , vol . 109 of lecture notes in statistics , springer , berlin , pp . 267276 .",
    "a. menafoglio , a. guadaglini , p. secchi , _ a kriging approach based on aitchison geometry for the characterization of particle - size curves in heterogeneous aquifers _ , stochastic environmental research and risk assessment , 2014 , doi 10.1007/s00477 - 014 - 0849 - 8 ."
  ],
  "abstract_text": [
    "<S> with large - scale database systems , statistical analysis of data , formed by probability distributions , become an important task in explorative data analysis . nevertheless , due to specific properties of density functions , </S>",
    "<S> their proper statistical treatment still represents a challenging task in functional data analysis . </S>",
    "<S> namely , the usual @xmath0 metric does not fully accounts for the relative character of information , carried by density functions ; instead , their geometrical features are followed by bayes spaces of measures . </S>",
    "<S> the easiest possibility of expressing density functions in @xmath0 space is to use centred logratio transformation , nevertheless , it results in functional data with a constant integral constraint that needs to be taken into account for further analysis . </S>",
    "<S> while theoretical background for reasonable analysis of density functions is already provided comprehensively by bayes spaces themselves , preprocessing issues still need to be developed . </S>",
    "<S> the aim of this paper is to introduce optimal smoothing splines for centred logratio transformed density functions that take all their specific features into account and provide a concise methodology for reasonable preprocessing of raw ( discretized ) distributional observations . </S>",
    "<S> theoretical developments are illustrated with a real - world data set from official statistics .    </S>",
    "<S> bayes spaces , centred logratio transformation , @xmath1-spline representation , smoothing spline    _ classification codes _ : 62h99 , 65d07 , 65d10 </S>"
  ]
}