{
  "article_text": [
    "hamiltonian systems still offer a wide range of yet unexplored territories and interests for the study of nonlinear dynamics and chaos .",
    "this is evident from the recent progress , e.g. , in the study of transmission , escape rates , and survival probabilities of open systems and recurrences in closed systems  @xcite , stickiness and marginally unstable periodic orbits  @xcite , and detailed analysis of the graphene - like lorentz gas and related systems  @xcite , and this list barely scratches the surface . as pointed out by bunimovich and vela - arevalo ,",
    "`` chaos theory is very much alive ''  @xcite .    two - dimensional ( 2d )",
    "hamiltonian systems ( i.e. , with two coordinate dimensions ) , such as dynamical billiards , have the advantage of being simple , but not too simple .",
    "that is , they are easy to study and visualize , but even a single - particle system can display a large variety of complex phenomena of hamiltonian chaos .",
    "many of these systems can also be realized as semiconductor nanostructures @xcite . while governed by quantum mechanics , these nanostructures have ballistic regions where a classical treatment applies to some extent @xcite .",
    "2d billiards ( including soft potentials ) with point - like particles can be simulated either using the exact solution , the exact poincar map , or by solving hamilton s or newton s equations of motion .",
    "the exact solution is often unknown , apart from single - particle systems with simple geometries .",
    "therefore , one often resorts to numerical solution of the classical equations of motion .    in this paper",
    "we introduce bill2d , a code for generic , classical 2d systems with a focus on the study of chaos and nonlinear dynamics .",
    "the code can handle single or many particles , hard - wall boundaries ( as in traditional billiards ) , particle - particle interactions , external potentials , periodic systems , a magnetic field , etc .",
    "written in modern c@xmath0 , bill2d is modular and easy to extend without sacrificing speed or ease - of - use .",
    "the paper is organized as follows : in sec .",
    "[ sec : systems ] we describe the class of systems to which bill2d can be applied . in sec . [ sec : algorithms ] we briefly discuss the numerical propagation algorithms and in sec .",
    "[ sec : implementation ] implementation and structure of the code . in sec .",
    "[ sec : examples ] we give a few numerical examples of what can be simulated with bill2d . in sec .",
    "[ sec : summary ] we finish with a brief summary of the paper .",
    "bill2d is designed for classical dynamics of interacting particles in two - dimensions .",
    "the program can deal with both traditional billiards with hard - wall boundaries as well as with soft external potentials including also periodic systems .",
    "single- and multiparticle systems with a generic form for the particle - particle interaction can be simulated , and an external magnetic field can be included .",
    "transport calculations are supported by allowing the creation and removal of particles during the simulation .    when treating systems _ without _ a magnetic field , we propagate the particles via hamilton s equations of motion using symplectic algorithms . systems _ with _ a magnetic field are propagated using newton s equations of motion .",
    "the program is written using cartesian coordinates and atomic units , i.e. , we set masses , charges , and the coulomb constant to unity .",
    "all the particles are point - like and with equal masses and charges ( as , e.g. , electrons in semiconductors ) , although the equal mass and charge requirement can be lifted with minor modifications to the code .    to clarify ,",
    "systems without an external magnetic field are described by the @xmath1-particle hamiltonian ( @xmath2 ) @xmath3 where @xmath4 and @xmath5 are the position and momentum of the @xmath6th particle , @xmath7 is the total external single - particle potential , and @xmath8 the interparticle potential . in principle , potentials @xmath9 and @xmath10 can be arbitrary , but in the case of attracting singularities , new propagation algorithms should be implemented .    when the system includes a magnetic field , we use the newtonian formulation instead of hamiltonian formulation .",
    "the equations of motion are @xmath11 where @xmath12 is the @xmath13 or @xmath14  coordinate of the position of the @xmath6th particle and @xmath15 the corresponding unit vector . the first term in eq .",
    "is the force due to the external potential , the second term the interparticle interaction , and the third term the lorentz force with the magnetic flux density @xmath16 perpendicular to the two - dimensional plane .",
    "the systems can also include hard - wall billiard boundaries .",
    "the ( fully elastic ) collision of the @xmath6th particle with the billiard boundary is described by the transformation @xmath17\\ , \\mathbf{n}(\\mathbf{r}_i ) , \\end{aligned}\\ ] ] where @xmath18 is a unit vector perpendicular to the corresponding boundary at position @xmath4 .",
    "when describing coulomb - interacting systems , we introduce the _ interaction strength _ parameter @xmath19 . essentially the coulomb - potential is given by @xmath20 by fixing the total energy and length scale ( i.e. , the size of the billiard table ) of the system , we can actually study all length and energy scales of all geometrically similar systems just by varying @xmath19 .",
    "naturally this trick works only if the system does not have external potentials ( apart from a hard - wall boundary ) or a magnetic field . in case of a magnetic field and/or external potentials ,",
    "also those have to be adjusted .",
    "for detailed derivation of the corresponding scale transformations and demonstration of the idea , we refer the reader to appendix b of ref .",
    "the propagator , for hamiltonian systems with the hamiltonian @xmath21 , is @xmath22 where @xmath23 is the poisson bracket operator .",
    "the systems we are interested in are described by hamiltonians [ eq . ] that can be split to two parts as @xmath24 , where all the momentum dependence is in @xmath25 , and all the coordinate dependence is in @xmath26 .",
    "as the hamiltonian is separable , there are plentiful of _ explicit _ algorithms for the time propagation .",
    "this is in contrast to general hamiltonian systems where the symplectic integrators are typically implicit and hence computationally more demanding .",
    "the algorithms we have implemented are based on _ split operator schemes _ , where the propagator , @xmath27 is approximated by some product of @xmath28 and @xmath29 .",
    "the operation of these latter exponentials can be carried out exactly  to numerical accuracy  allowing for an easy implementation of split operator schemes .",
    "for example , the velocity verlet scheme  @xcite can be expressed as @xmath30    we have implemented symplectic algorithms of orders 26 for systems without a magnetic field . the algorithms ( from refs .",
    "@xcite ) are specified in .      in a magnetic field ,",
    "the systems are propagated via newton s equations of motion [ eq . ] as we are unaware of any efficient symplectic algorithms for this class of systems .",
    "we have implemented two algorithms : ( i ) the second order taylor expansion scheme developed by spreiter and walter  @xcite and ( ii ) the fourth order algorithm developed by y. he _ et _ al . in ref .",
    "@xcite .    the algorithm by spreiter and walter has been later shown to be an energy conserving split - operator scheme  @xcite , and the fourth order algorithm is volume preserving ( and also preserves the total energy extremely well )  @xcite .",
    "these schemes explicitly incorporate the effects of the magnetic field into the propagation formulas , and allow  in principle  an arbitrarily strong magnetic field without the need for a smaller time step .",
    "bill2d is designed as a modular , object - oriented package , and is written in standards - compliant c@xmath0 following the ` international standard iso / iec 14882:2014(e ) programming language c++ ` ( aka c@xmath014 )  @xcite .",
    "the package contains three binaries : ` bill2d ` for single simulation of a ( many - body ) trajectory , ` bill2d_escape ` for the calculation of escape rates in open billiards , and ` bill2d_diffusion_coefficient ` for the calculation of diffusion coefficients in periodic systems .",
    "all the binaries obey similar inputs ; more details are given in .",
    "the binaries make use of the ` libbill2d ` library , which is created during the compilation process .",
    "most of the classes and methods of the library are enclosed in the namespace ` bill2d ` .",
    "this library can be used for easy implementation of additional binaries . a tutorial for developing new binaries and features",
    "can be found in ` docs / developer_manual.pdf ` , which also describes the implementation in detail .      the class ` parser `",
    "handles parsing of the input either from command line , configuration file , or a combination of these .",
    "the option parsing is implemented with the help of ` boost::program_options ` library .",
    "the input defines the system ( number of particles , magnetic field , potentials , periodicity , etc . ) and simulation parameters ( algorithm , time step , simulation time , etc . ) .",
    "the initial positions and velocities of the particles can either be supplied manually , or bill2d can randomize them .",
    "the default random initial conditions are calculated as follows : first the initial positions of the particles are randomized either within a given hard - wall billiard table , a unit cell , or a user - supplied rectangular area .",
    "next , the kinetic energy is distributed evenly among the particles , and the directions of the velocities are randomized .",
    "note also that implementation of new randomization procedures for the initial conditions is easy .",
    "the package consists of several classes each designed usually for a single purpose : ` table ` handles collisions with hard - wall boundaries , ` datafile ` handles saving of data , etc .",
    "the easiest way for a developer to create instances of all the necessary classes is to use the ` parser ` to get all the input parameters bundled in an instance of ` parameterlist ` , which can then be passed on to ` billiardfactory ` .",
    "this factory class can be used to create instances of ` billiard ` , which bundles all the other necessary objects together .",
    "furthermore , instances of the ` billiard ` class save data automatically during simulation and upon destruction . in all simplicity ,",
    "a minimal working example could be as follows .",
    ".... # include \" bill2d / parser.hpp \" # include \" bill2d / billiard_factory.hpp \"    using namespace bill2d ;    int main ( int argc , char * argv [ ] ) {       @parser@ parser ( argc , argv ) ;       auto params =            parser.getparameterlist ( ) ;       @billiardfactory@ factory ( params ) ;       auto billiard = factory.get_bill ( ) ;       // set initial condition     billiard->prepare(3.0 / * energy * / ) ;       //",
    "get reference to time .     //",
    "this variable is kept up to date .",
    "const auto & time =            billiard->get_time ( ) ;       while ( time < 5.0 )            billiard->propagate ( ) ;    } // saving data upon    // destruction of billiard ....    for more complex examples , see files , , and , and the developer manual      the program saves its data ( trajectories , energies , etc . ) to a hdf5-file .",
    "the datafile can be accessed afterwards for analysis with several tools including , e.g. , the ready made scripts included in the bill2d package , different programming languages ( at least python , c , c@xmath0 , fortran , and java ) and programs such as matlab and mathematica .",
    "the describes in more detail how to access the hdf5-files .",
    "the software is bundled with comprehensive unit tests , which currently cover most of the program .",
    "additional tests can be run with the python script , which requires the user to download reference data from the url specified in .",
    "a fundamental concept in classical point - particle mechanics is a trajectory , i.e. , the curve that the particle draws in the coordinate space . in fig .",
    "[ fig : mushroom ] we show a single - particle trajectory in the bunimovich mushroom billiards  @xcite calculated with the ` bill2d ` binary .",
    "the trajectory has been drawn with the ` draw_trajectories ` script , which is bundled with the software package .",
    "similarly , one can consider trajectories of a many - particle system , as in fig .",
    "[ fig : circle ] , which shows 15 coulomb - interacting particles inside a circular billiard table . here",
    "several different trajectories share the same color .",
    "single - particle billiards in a bunimovich mushroom . ]",
    "circular billiards with 15 coulomb - interacting particles . ]",
    "the phase space can be studied by selecting a two - dimensional subspace of the full phase space , and visualizing all crossings of a phase space trajectory ( or trajectories ) with the chosen subspace , which is called the poincar section .    in fig .  [",
    "fig : ellipse_bmap ] we show the poincar section of a single - particle elliptic billiards in a magnetic field calculated with the ` bill2d ` binary ; several initial positions are considered in this figure . here",
    "the poincar section shows the collisions with the billiard table , parametrized by the arc length @xmath31 and the tangential velocity @xmath32 .",
    "the poincar section consists of several elliptic and parabolic kam islands ( after kolmogorov , arnold , and moser  @xcite ) that correspond to regular motion , as well as a chaotic sea indicated by irregularly distributed points .",
    "this system has previously been studied in , e.g. , ref .",
    "@xcite .     poincar section of an elliptic billiard with semi - major and -minor axes 1 and @xmath33 in a magnetic field with larmor radius @xmath34 . ]",
    "open billiards have one or many holes in the billiard boundary through which the particle(s ) can escape the system .",
    "the object of interest here is the survival probability or the escape rate .",
    "the survival probability @xmath35 gives the probability that the particle has not exited the system before time @xmath36 , and the escape rate @xmath37 gives the probability density of escape within a narrow time interval around @xmath36 .",
    "these two are naturally related by @xmath38    in fig .",
    "[ fig : escape ] we show the escape rate for a single particle square billiards in a magnetic field , as calculated with the ` bill2d_escape ` binary ( blue line ) .",
    "the square has side length of unity , with a hole of length  @xmath39 , and the magnetic field is such that the larmor radius is @xmath40 . as a reference",
    ", we have calculated the escape rate using an analytical mapping between boundary collisions ( red line ) , which is available for such a simple system .",
    "the results are nearly identical all the way to very small escape rates ( i.e. , very rare trajectories ) .",
    "note that trajectories that can never escape the system are not included in the data .",
    "after a brief initial period , the escape - rate curve is found to be a combination of exponential and algebraic functions , which is typical for systems with a mixed phase space in the corresponding closed system  @xcite . in this system the mixed phase space ( studied , e.g. , in ref .",
    "@xcite ) is evident from , e.g. , the regular characteristics of the example trajectory in the inset of fig .  [ fig : escape ] .     escape rate for a single - particle in square billiards in a magnetic field with larmor radius @xmath40 .",
    "the result demonstrates a combination of algebraic and exponential behavior as a function of time .",
    "the escape rate computed from an ensemble of trajectories using ` bill2d_escape ` is shown as a blue line , and a reference curve computed with an analytical collision map is shown as a red line . ]",
    "when studying planar billiards in periodic structures , it is of interest to see how the particle diffuses  on the average  in the system .",
    "the diffusion coefficient is defined as @xmath41 where @xmath42 is the average over all possible initial configurations .",
    "let us consider a hexagonal antidot lattice of scatterers with lattice constant unity ( see the inset of fig .",
    "[ fig : diffusion ] ) .",
    "each scatterer produces a repulsive potential of the form @xmath43\\right)^{-1}$ ] .",
    "this is defined by three parameters : scatterer position @xmath44 , radius @xmath45 , and the softness of the potential @xmath46 .",
    "the system thus corresponds to a lorentz gas  an extensively studied system in chaos theory  with soft boundaries  @xcite .",
    "the mean squared displacement ( msd ) @xmath47 of a particle in the antidot lattice is shown in fig .",
    "[ fig : diffusion ] as a function of time . in this example",
    "the total energy @xmath48 , scatterer radius @xmath49 , and scatterer softness @xmath50 .",
    "the msd has a power law behavior @xmath51 with @xmath52 , which means that the system is superdiffusive , and the diffusion coefficient diverges .",
    "this behavior is due to large number of trajectories demonstrating lev walk characteristics or even purely ballistic behaviour .",
    "in this example we have simulated an ensemble of @xmath53 trajectories , which results in approx .",
    "2.5 % relative standard error of the mean for the msd at @xmath54 .",
    "the calculation was done with the binary _",
    "bill2d_diffusion_coefficient_.     mean squared displacement for a soft lorentz gas with scatterer radius @xmath49 , softness @xmath50 , energy @xmath48 behaves as a power law in time ( @xmath55 ) with exponent @xmath52 .",
    "the inset shows a single trajectory in the system . ]",
    "the software package bill2d is a versatile and efficient tool to simulate classical two - dimensional systems .",
    "it supports , e.g. , single and many - body simulations including varying particle number , interparticle interactions , different external potentials , a magnetic field , periodic boundaries , and hard - wall billiard tables .",
    "in addition to the versatility , the main strengths of bill2d are its modular , object - oriented design , which allows easy implementation of new features , and a clear and extensively documented source code .",
    "bill2d has already been used in several studies including , e.g. , chaotic properties of many - body billiards  @xcite , nonlinear dynamics of wigner molecules  @xcite , and diffusion in periodic lattices  @xcite .",
    "the package can also be readily applied to , e.g. , classical studies of transport properties in two - dimensional structures .",
    "we are grateful for stack overflow user rob@xmath56 for his help with ` boost::program_options ` , trond norbye for his blog post on python scripts and automake , david corvoysier for his blog post on googletest and cmake , ryan pavlik for his ` getgitrevisiondescription ` cmake - module , mark moll for his post on cmake mailing list about cmake and python , and visa nummelin for initial development of the reference code for single - particle magnetic rectangular billiards .",
    "we also thank johannes nokelainen , sol gil gallegos , and rainer klages for useful discussions .",
    "likewise , we thank all our users for bug reports . this work was supported by the academy of finland and the finnish cultural foundation .",
    "we also acknowledge csc  the finnish it center for science for computational resources .",
    "j.  solanp , http://www.solanpaa.fi/documents/solanpaa_msc_thesis.pdf[nonlinear dynamics and chaos in classical coulomb - interacting many - body billiards ] , master s thesis , university of jyvskyl ( 2013 ) . http://www.solanpaa.fi/documents/solanpaa_msc_thesis.pdf                  s.  tsugawa , y.  aizawa , stagnant motion in hamiltonian dynamics mushroom billiard case with smooth outermost kam tori , j. phys .",
    "jpn . , 83 ( 2014 ) 024002 . http://dx.doi.org/10.7566/jpsj.83.024002 [ ] .",
    "t.  gilbert , h.  c. nguyen , d.  p. sanders , diffusive properties of persistent walks on cubic lattices with application to periodic lorentz gases , journal of physics a : mathematical and theoretical 44 ( 2011 ) 065001 .",
    "g.  cristadoro , t.  gilbert , m.  lenci , d.  p. sanders , measuring logarithmic corrections to normal diffusion in infinite - horizon billiards , phys . rev .",
    "e 90 ( 2014 ) 022106 .",
    "http://dx.doi.org/10.1103/physreve.90.022106 [ ] .",
    "m.  khoury , a.  m. lacasta , j.  m. sancho , a.  h. romero , k.  lindenberg , charged particle transport in antidot lattices in the presence of magnetic and electric fields : langevin approach , phys .",
    "b 78 ( 2008 ) 155433 . http://dx.doi.org/10.1103/physrevb.78.155433 [ ] .",
    "j.  yang , h.  zhao , anomalous diffusion among two - dimensional scatterers , journal of statistical mechanics : theory and experiment 2010 ( 2010 ) l12001 . http://dx.doi.org/10.1088/1742-5468/2010/12/l12001 [ ] .",
    "a.  p. micolich , a.  m. see , b.  c. scannell , c.  a. marlow , t.  p. martin , i.  pilgrim , a.  r. hamilton , h.  linke , r.  p. taylor , is it the boundaries or disorder that dominates electron transport in semiconductor ` billiards ' ?",
    ", fortschr .",
    "physik 61 ( 2013 ) 332  347 . http://dx.doi.org/10.1002/prop.201200081 [ ] .",
    "q.  spreiter , m.  walter , classical molecular dynamics simulation with the velocity verlet algorithm at strong external magnetic fields , j. comp .",
    "( 1999 ) 102  119 . http://dx.doi.org/10.1006/jcph.1999.6237 [ ] .",
    "v.  i. arnold , proof of a theorem of a. n. kolmogorov on the preservation of conditionally periodic motions under a small perturbation of the hamiltonian , uspehi mat .",
    "nauk 18 ( 1963 ) 12  40 , in russian .",
    "j.  solanp , p.  j.  j. luukko , e.  rsnen , many - particle dynamics and intershell effects in wigner molecules , j. phys .",
    "matter 23 ( 2011 ) 395602 .",
    "http://dx.doi.org/10.1088/0953-8984/23/39/395602 [ ] .",
    "t.  hmlinen , http://urn.fi/urn:nbn:fi:tty-201405231225[diffusion calculations in the lorentz gas ( english abstract ) ] , master s thesis , tampere university of technology , finland ( 2014 ) . http://urn.fi/urn:nbn:fi:tty-201405231225"
  ],
  "abstract_text": [
    "<S> we present bill2d , a modern and efficient c@xmath0 package for classical simulations of two - dimensional hamiltonian systems . </S>",
    "<S> bill2d can be used for various billiard and diffusion problems with one or more charged particles with interactions , different external potentials , an external magnetic field , periodic and open boundaries , etc . </S>",
    "<S> the software package can also calculate many key quantities in complex systems such as poincar sections , survival probabilities , and diffusion coefficients . </S>",
    "<S> while aiming at a large class of applicable systems , the code also strives for ease - of - use , efficiency , and modularity for the implementation of additional features . </S>",
    "<S> the package comes along with a user guide , a developer s manual , and a documentation of the application program interface ( api ) .    </S>",
    "<S> classical mechanics ; billiards ; nonlinear dynamics ; chaos ; transport ; diffusion ; numerical simulations ; molecular dynamics + this is the final preprint of the article published in http://dx.doi.org/10.1016/j.cpc.2015.10.006[comp . </S>",
    "<S> . comm . * 199 * , 133 - 138 ( 2016 ) ] .     </S>",
    "<S> +    _ program title : _ bill2d + _ journal reference : _ </S>",
    "<S> + _ catalogue identifier : _ + _ licensing provisions : _ gnu general public license version 3 + _ programming language : _ </S>",
    "<S> c@xmath0(14 ) + _ computer : _ tested on x86 and x86_64 architectures . </S>",
    "<S> + _ operating system : _ tested on linux , and os x versions 10.9 - 10.11 . </S>",
    "<S> + _ compilers : _ c@xmath014 compliant compiler . tested compilers : clang 3.7 , gcc 4.9 - 5.2 , and intel c@xmath0 compiler 15 . </S>",
    "<S> + _ ram : _ simulation dependent : kilobytes to gigabytes + _ parallelization : _ shared memory parallelization when simulating ensembles of systems . </S>",
    "<S> + _ keywords : _ classical mechanics ; billiards ; nonlinear dynamics ; chaos ; transport ; diffusion ; numerical simulations ; molecular dynamics + _ classification : _ 4.3 differential equations , 7.8 structure and lattice dynamics , 7.9 transport properties , 7.10 collisions in solids , 16.9 classical methods + _ external routines / libraries : _ + boost , cmake , gsl , hdf5 ; and optionally googlemock , googletest , and doxygen + _ nature of problem : _ + numerical propagation of classical two - dimensional single and many - body systems , possibly in a magnetic field , and calculation of relevant quantities such as poincar sections , survival probabilities , diffusion coefficients , etc . </S>",
    "<S> + _ solution method : _ + symplectic numerical integration of hamilton s equations of motion in cartesian coordinates , or solution of newton s equations of motion if in a magnetic field . </S>",
    "<S> the program implements several well - established algorithms . </S>",
    "<S> + _ restrictions : _ + pointlike particles with equal masses and charges , although the latter restrictions are easy to lift . </S>",
    "<S> + _ unusual features : _ </S>",
    "<S> + program is efficient , extremely modular and easy to extend , and allows arbitrary particle - particle interactions . </S>",
    "<S> + _ additional comments : _ + the source code is also available at https://bitbucket.org/solanpaa/bill2d . </S>",
    "<S> see for locations of user guide , developer manual , and api docs . + _ running time : _ + from milliseconds to days , depends on type of simulation . </S>"
  ]
}