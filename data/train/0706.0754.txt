{
  "article_text": [
    "the first luminous objects in the universe formed from primordial gas , comprised solely of h and he , with only trace amounts of d an li . the relatively simple chemistry of metal - free gas , combined with tighly constrained cosmological parameters @xcite , has allowed the formation of the first stars to be simulated with extremely high precision , from the hierarchical growth of their host dark matter halos through to the point where the dense proto - stellar cores becomes optically thick @xcite . with the deaths of these stars came the creation of the first heavy elements .",
    "core - collapse and pair - instability supernovae created metals in copious amounts @xcite and ejected them into the igm @xcite .",
    "the presence of metals alters the dynamics of collapsing gas - clouds by increasing the number of available atomic and molecular transitions , allowing the gas to lose its internal energy more quickly than in case of no metals @xcite .",
    "the introduction of metals adds a new level of complexity to the problem of simulating the formation and evolution of cosmic structure .",
    "@xcite identified a minimal set of 21 chemical reactions necessary for accurately following the non - equilibrium evolution of a gas consisting solely of species of h and he , including h@xmath7",
    ". showed that 33 total reactions were required when including d and li species to the gas .",
    "@xcite performed one of the first numerical studies of collapsing gas - clouds to consider the contribution of metals .",
    "their chemical network of h , he , c , and o included 50 atomic and molecular species and 478 reactions . while theirs was not a minimal model , the above examples illustrate the great expense associated with the expansion of chemical networks to include additional elements .",
    "other works have studied the effect of metals on star - forming gas using similar methodologies to that of @xcite , e.g. , @xcite .",
    "the complexity of the chemical networks used in these studies limited their treatment of gas evolution to one - zone , semi - analytical models . in the earliest work to incorporate metal cooling into three - dimensional hydrodynamic simulations to study metal - enriched star formation ,",
    "@xcite used a small set of the most dominant atomic transitions of c , n , o , fe , si , and s , as decribed by @xcite .",
    "their method also ignored the cooling from h@xmath7 , which was justified within their study by the assumption of a very large photo - dissociating uv background , but is otherwise an extremely important coolant in low - metallicity environments .",
    "for high temperature gases , @xcite computed metal cooling functions that included 14 heavy elements over a range of metallicities , with solar abundance patterns .",
    "these cooling functions are useful for simulating the igm and other hot , ionized environments , but a minimum temperature of 10@xmath8 k makes them inapplicable to studies of the cold , neutral gas associated with star - formation .",
    "these cooling functions assume collisional equilibrium of the species and as such can not capture the important role of uv and x - ray radiation .",
    "we introduce a new method for including the cooling from heavy elements in large - scale hydrodynamic simulations that is valid over a wide range of physical conditions , covers a great number of elemental species , and is fast enough to be used in large - scale numerical simulations .",
    "we have utilized the established photoionization software , cloudy @xcite to construct large grids of metal cooling data .",
    "we have developed a method to include both the cooling from heavy elements and the non - equilibrium cooling from h@xmath7 in hydrodynamic simulations .",
    "this method has been used successfully in the numerical simulations of star formation performed by @xcite . in  [ sec : method ] , we describe our method for creating the metal cooling data , including a new code to expedite the process .",
    "we , then , present two implementations of the cooling method in the amr , hydrodynamic / n - body code , enzo @xcite . in  [ sec : metals ] , we focus on the application of metals to low - temperature environments , identifying the dominant cooling mechanisms , and studying the possibility of fragmentation and thermal instability in metal - enriched gas .",
    "finally , we end with a discussion in  [ sec : discussion ] of the role played by the heavy elements in the formation of structure in the early universe .",
    "at the current time , it is still too computationally expensive and memory intensive to follow the non - equilibrium chemistry for a large set of heavy elements in a three - dimensional hydrodynamic simulation .",
    "the exact mass of the first massive stars is not known @xcite . also unknown are the exact yields of early supernovae @xcite .",
    "similarly , in many astrophysical systems one might want to model computationally the exact metal distributions .",
    "consequently , it is not clear a priori what level of sophistication of cooling model is needed to adequately capture the hydro and thermodynamic evolution of the gas under consideration .",
    "note that uncertain grain physics also increases the potentially important parameter space . in our approach ,",
    "we assume ionization equilibrium , which allows us to calculate , in advance , the cooling rate for a parcel of gas with a given density and temperature , with incident radiation of known spectral shape and intensity . for this problem , we find the photoionization code , cloudy @xcite , especially apt .",
    "cloudy is conventionally used to model the transmitted spectrum from a cloud of gas with a given chemical composition , being irradiated by a specified source .",
    "the code must calculate an equilibrium solution by balancing the incident heating with the radiative cooling from a full complement of atomic and molecular transitions , as well as continuum emission from dust .",
    "the chemical network of cloudy covers all atomic species from h to zn , as well as a multitude of molecular species .",
    "each elemental abundance can be specified individually , giving us the ability to model the cooling from a gas with any composition . since cloudy permits the use of virtually any input spectrum",
    ", we are able to create cooling data that is suitable for any radiation environment . instead of allowing the code to cycle through temperatures",
    "until converging on a thermodynamic equilibrium solution , we use the ` constant temperature ` command to fix the temperature externally , allowing us to utilize cloudy s sophisticated machinery to calculate cooling rates out of thermal equilibrium . in this manner",
    ", we create a grid of heating and cooling values as a function of temperature , gas density , chemical composition , and incident spectrum .",
    "the cooling rates presented in this work were created using version 07.02.01 of the cloudy software .    to automate the process of data production and organization , we have created a code , called roco ( recursively organized cloudy output . )",
    "roco uses a recursive algorithm to process user - specified loop parameters , making it possible to create data - grids of any dimension .",
    "commands that are to be issued to cloudy are given to the roco code in either one of two formats - loop commands with a set of parameters through which the code will iterate , and constant commands that are to be issued with the same value during each iteration over the loop commands .",
    "since most uses of cloudy involve the creation of large grids of models constructed by looping over a set of input parameters , the capabilities of roco give it the potential to be useful to a broader community of cloudy users than just those who would use it to create the cooling tables discussed here . to this end",
    ", roco is structured in such a way that the post - cloudy data analysis routines can be easily interchanged to suit the needs of different users .",
    "the code features an extra running mode that simply runs cloudy over the specified parameter - space with no further processing of the data , as well as a template designed to help users create new running modes suited to their specific needs .",
    "roco also has the ability to run multiple instances of cloudy simultaneously , greatly reducing runtime .",
    "the parallel feature works well on individual machines with multiple processors , as well as beowulf clusters using the mpi ( message passing interface ) framework .",
    "a copy of the roco code will be made available upon request to the authors .    in figure",
    "[ fig : cooling1 ] , we display the resulting cooling function for gas with n@xmath9 = 1 @xmath3 at metallicities , from z = 0 ( metal - free ) to 10 z@xmath4 , over the temperature range , 50 @xmath0 t @xmath0 10@xmath1 k. for these cooling rates , we use the ` coronal equilibrium ` command in cloudy to simulate an environment free of radiation , where all ionization is collisional .",
    "we also neglect the cooling from h@xmath7 , so as to better illustrate the cooling contribution from metals at temperatures less than 10@xmath8 k. we accomplish this by issuing the cloudy command , ` no h2 molecule ` .",
    "we implement our metal cooling method in the eulerian adaptive mesh refinement hydrodynamic / n - body code , enzo@xcite .",
    "when a simulation is initialized , enzo reads in the cloudy / roco data - grid , storing the heating and cooling values as functions of temperature , h number density , and any other parameters , such as spectral intensity , depending on the nature of the simulation .",
    "the heating , @xmath10 , and cooling , @xmath11 , are stored with code units corresponding to [ ergs s@xmath12 @xmath13 . during the simulation , enzo stores the mass density and internal energy for each grid cell in the box . at each hydrodynamic time - step ,",
    "the radiative cooling solver cools the gas by lowering the internal energy via a simple euler update , @xmath14 where @xmath15 denotes the internal energy of the grid cell with ( x , y , z ) coordinates , ( i , j , k ) , at the ( n+1)th time - step , @xmath16 is the cooling rate in code units corresponding to [ ergs s@xmath12 ] , and @xmath18 is the adopted time - step . for every hydrodynamic time - step , the code subcycles through equation [ eqn : cool ] , selecting from three possible time - steps , until one full hydrodynamic time - step has been completed .",
    "the time - step , @xmath18 , in equation [ eqn : cool ] , adopts the minimum of the following three values : ( 1 ) half of the hydrodynamic time - step , ( 2 ) 10% of the cooling time , ( u/@xmath16 ) , or ( 3 ) the time remaining to have integrated over one full hydrodynamic time - step .",
    "the euler update is the standard method used for updating the internal energy in all of the established cooling routines in the enzo code .",
    "since the cooling rate is such a nonmonotonic function of temperature , this approach of using substeps with an explicit integration method has been found to yield the best combination of accuracy and speed @xcite . the internal energy and mass density for each grid cell",
    "are converted to temperature and number density and the heating and cooling values are calculated by linearly interpolating over the cloudy / roco data - grid .",
    "the change in internal energy from the cloudy / roco cooling rates is expressed as @xmath19 where n@xmath9 is the h number density .",
    "we implement two distinct versions of the method described above . in the first and simplest version",
    ", the cooling is calculated solely from the cloudy / roco data , as in equation [ eqn : dudt ] .",
    "the total change in internal energy is @xmath20 when converting the internal energy to temperature , it is necessary to know the value of the mean molecular weight , @xmath21 . in this implementation ,",
    "we assume @xmath21 to be a constant with the value 1.22 . for high temperatures , t @xmath22 10@xmath8 k",
    ", this method is sufficient for providing accurate gas cooling within hydrodynamic simulations .",
    "this implementation is not suitable , however , when t @xmath23 10@xmath8 k and the formation of h@xmath7 becomes important . disregarding formation on grain surfaces and three - body formation , h@xmath7 primarily forms through the following channels : + the h@xmath24 channel , @xmath25 and the h@xmath26 channel , @xmath27 when a significant electron fraction exists , these reactions proceed to form h@xmath7 very quickly , with the h@xmath24 channel typically dominating , except in the very high redshift universe ( z @xmath28 100 ) , where h@xmath24 is readily destroyed by the cmb @xcite .",
    "recently , @xcite have suggested that formation of h@xmath26 via @xmath29 is responsible for more h@xmath7 than the h@xmath26 channel in equation [ eqn : h2plus ] . if , however , the ionization fraction is low , h@xmath7 forms very slowly , with equilibrium timescales that can exceed the current age of the universe .",
    "the consequence is that h@xmath7 formation is so sensitive to the thermal history of the gas that h@xmath7 fractions can not be known without explicitly following the non - equilibrium chemistry during the simulation .",
    "we find this to be the case when using cloudy to compute the cooling rate from h@xmath7",
    ". in searching for ionization equilibrium , cloudy integrates over timescales that are unphysically long , leading to an overcalculation of the h@xmath7 fraction , producing cooling rates that are too high .",
    "we solve this problem in our second implementation by first removing the h@xmath7 molecule from cloudy s chemical network with the ` no h2 molecule ` command .",
    "we , then , run two cloudy / roco data - grids : one with the full set of elements and the other with h and he only .",
    "we obtain a metals - only data - grid by subtracting the metal - free data - grid from the complete data - grid . using the established h / he network in enzo @xcite , we follow the non - quilibrium fractions of h , h@xmath30 , h@xmath24 , h@xmath7 , h@xmath26 , he , he@xmath30 , he@xmath31 , and e@xmath24 , and directly calculate the associated atomic @xcite and molecular cooling rates .",
    "we provide the option to use the h@xmath7 cooling rates of @xcite , which are obsolete , but allow a means of comparison to older simulations .",
    "we also include the cooling , or heating , from electrons scattering off the cmb as @xmath32 where t@xmath33 = 2.7 ( 1 + z ) k @xcite .",
    "we prevent the metals from cooling the gas below the cmb temperature by subtracting the metal cooling rate at t = t@xmath33 , as in @xcite .",
    "including the cmb explicitly in cosmological simulations would require adding an extra dimension in the cloudy / roco data - grid to account for the evolution of the cmb with redshift . while this is certainly possible",
    ", interpolating over an extra dimension to calculate the cooling during the simulation would be significantly slower than the approximation described above . to test the validity of this approximation of the cmb temperature - floor ,",
    "we create a cloudy / roco metals - only data - grid , explicitly including the cmb . at low densities",
    "( n @xmath34 1 @xmath3 ) , the values of ( @xmath11 - @xmath10 ) from the data with the cmb included differ from the values of ( @xmath11 - @xmath35 ) from the data without the cmb by a factor of roughly 2 near t@xmath33 . at higher temperatures and densities ,",
    "the two values are nearly identical .",
    "the total rate of energy loss applied to the simulation gas in the second implementation is @xmath36 where @xmath37 is the total atomic and molecular cooling from the h / he network , and @xmath38 is the metals - only cooling rate taken from the cloudy / roco data in the manner described above .",
    "the value of @xmath21 is calculated directly from the h / he species fractions , neglecting any addition from the metals . in low - metallicity gases ,",
    "this approach is reasonable , as the increase in @xmath21 from the metals only reaches @xmath3410@xmath6 for z = 10@xmath39 z@xmath4 .",
    "since the cloudy / roco data - grids also store the values of @xmath21 for each point , this can be added to the value calculated without the heavy elements when the metallicity is very high .    in figure",
    "[ fig : cooling2 ] , we display low - temperature cooling functions for gases with varying density and metallicity , constructed with the third implementation of the metal cooling method . to produce the data for figure [ fig : cooling2 ] , we set up an unphysical , two - dimensional grid in enzo that varies smoothly over density and temperature .",
    "we iterate the reaction network for a time equivalent to that between z = 99 and 20 ( @xmath34160 myr ) , with hydrodynamics disabled , then compute the cooling with the third implementation of our metal cooling method , using the h@xmath7 cooling rates of . since the first stars are predicted to form at the centers of @xmath3410@xmath40 m@xmath4 dark matter halos at z @xmath34 20 @xcite , integrating the rate equations over this time interval places each of the species in the relative abundances in which they would be found during the epoch of first - star formation .",
    "hence , figure [ fig : cooling2 ] provides a direct comparison of the cooling rate of the gas that formed the first and successive generations of stars .",
    "the h@xmath7 fractions used to create the cooling rates for figure [ fig : cooling2 ] result from integrating the h / he chemical network for the period of time between z = 99 and 20 . as such ,",
    "figure [ fig : cooling2 ] should not be used as a general cooling function , except in the context mentioned above .",
    "however , figures [ fig : cocooln3_z-2][fig : cool_dust ] do not include the cooling from h@xmath7 and may , therefore , be used as general purpose cooling functions when the cooling from h@xmath7 is not needed .",
    "much attention has been given recently to the role of the first heavy elements in transitioning from the singular , high - mass mode of star formation of the first stars to the mode producing stars with a salpeter initial mass function ( imf ) .",
    "analytical studies by @xcite and @xcite have focused on the contributions of individual elements toward triggering fragmentation in star - forming clouds . @xcite",
    "suggest c and o to be the dominant coolants in low - metallicity gas , in the presence of an h@xmath7 dissociating uv background created by the first stars @xcite . by calculating the cooling rate necessary to equate the cooling time to the free - fall time at n = 10@xmath8 @xmath3 and t = 200 k , the point where h@xmath7 cooling becomes inefficient @xcite , @xcite predict individual critical abundances of c and o to be [ c / h]@xmath41 @xmath42 -3.5 and [ o / h]@xmath41 @xmath42 -3.05 , where [ a / h ] = log@xmath43(n@xmath44/n@xmath9 ) - log@xmath43(n@xmath44/n@xmath9)@xmath4 .",
    "@xcite consider the cooling from fe and si , in addition to c and o , and take into account the density dependence of metal cooling .",
    "in doing so , they find that the critical abundance of each element varies with density , reaching a minimum at a critical density that is different in each case .",
    "they also note that different elements dominate different density and temperature regimes .    in figs .",
    "[ fig : cocooln3_z-2][fig : fessicooln3_z0 ] , we plot the individual cooling contributions for number density , n@xmath9 = 10@xmath45 @xmath3 and metallicities , z = 10@xmath39 z@xmath4 and 1 z@xmath4 . in each case",
    ", we create a set of cooling data with the full complement of elemental species , from h through zn , neglecting h@xmath7 .",
    "we plot only the coolants whose contributions reach , at least , 10@xmath46 of the total cooling within the temperature range , 10 k @xmath0 t @xmath0 5000 k. since the cooling data were made assuming no incident ionizing radiation , as described in  [ sec : cloudy ] , we observe the dominant c transitions to be from ci , instead of cii , as in @xcite and @xcite . for z = 10@xmath39 z@xmath4 ,",
    "the most important coolants are the fine structure transtions at 369.7 @xmath21 m and 609.2 @xmath21 m from ci and at 63.2 @xmath21 m from oi . at higher temperatures ( t @xmath5 100 k ) , the siii transition at 34.8 @xmath21 m becomes important as well . at higher metallicities",
    ", co replaces atomic c ( fig .",
    "[ fig : cocooln3_z0 ] ) and emission from sii at 129.6 @xmath21 m becomes dominant ( fig .",
    "[ fig : fessicooln3_z0 ] ) .",
    "fe cooling is relatively unimportant up to n@xmath9 = 10@xmath47 @xmath3 , but is completely dominant for t @xmath5 200 k by n@xmath9 = 10@xmath48 @xmath3 , with oi strongest slightly below that temperature , and co the most important below 50 k ( fig .",
    "[ fig : cooln9_z0 ] ) .",
    "in addition to the elements covered by @xcite , we note that cooling from neutral s reaches roughly the 10% level at n@xmath9 = 10@xmath45 @xmath3 .",
    "the [ si ] 25.2 @xmath21 m transition peaks at 40% of the total cooling at n@xmath9 = 10@xmath49 @xmath3 and t @xmath34 1000 k. the only other coolant that contributes at the level of at least 10@xmath46 of the total cooling is the 60.6 @xmath21 m transition of [ pii ] at n@xmath9 = 10@xmath47 @xmath3 .",
    "the number of coolants that reach 10@xmath46 of the total grows quickly with density .",
    "we observe 23 distinct coolants contributing at that level at n@xmath9 = 10@xmath40 @xmath3 , and 32 by 10@xmath48 @xmath3 .",
    "if we lower the threshhold to 10@xmath50 , there are a total of 84 coolants at n@xmath9 = 10@xmath48 @xmath3 , illustrating the strength of cloudy and our cooling method .",
    "recently , studies have suggested that dust cooling at high densities can trigger fragmentation for metallicities as low as 10@xmath50 @xmath51 @xcite .",
    "@xcite have claimed that between 15 and 30% of the mass of the progenitor of a pair - instability supernova is converted in dust .",
    "however , observations of the crab nebula @xcite and the cassiopeia a supernova remnant @xcite have returned little or no signs of dust , suggesting that type ii supernova may not actually be large dust producers . given the controversy surrounding the existence of dust grains in the formation environments of second - generation stars , we do not include the cooling from dust in the analysis , but leave it for a separate work .",
    "to provide an example of the effect of dust on the cooling rate , we run a simple model including dust in cloudy .",
    "we use a model designed to simulate the dust within the ism , using the cloudy command , ` grains ism ` .",
    "the dust physics used in cloudy is described in detail by @xcite .",
    "the ism dust model in cloudy consists of both graphite and silicates with sizes ranging from 5 @xmath52 10@xmath46 @xmath21 m to 0.25 @xmath21 m and a power - law size - distribution with a power - law index of -3.5 . for solar metallicity ,",
    "the total grain abundances per h are 10@xmath53 for graphite and 10@xmath54 for silicates . in fig .",
    "[ fig : cool_dust ] , we plot the cooling rate from metals at n@xmath9 = 10@xmath48 @xmath3 , with and without dust grains , for metallicities , z = 10@xmath50 z@xmath4 , 10@xmath6 z@xmath4 , and 10@xmath39 z@xmath4 . since it is inappropriate to think of the dust and gas - phase metal abundances as independent , we directly scale the dust abundances with the gas - phase metal abundancs . for number densities",
    "lower than 10@xmath48 @xmath3 , the additional cooling from dust is almost negligible . at higher densities , dust becomes more important .",
    "if dust is , in fact , produced in the supernovae of the first stars , it is likely to be as important as previous studies have claimed .      in order to study the ability of a collapsing gas - cloud to fragment , we first identify the regions of density and temperature where the classical fragmentation criterion , t@xmath55 @xmath56 t@xmath57 @xcite , is met , with the dynamical time expressed as @xmath58 we limit this analysis to solar abundance patterns .",
    "this represents the first step of an incremental approach to studying the general criteria that lead to fragmentation in collapsing clouds .",
    "the use of solar abundance patterns will allow us to begin to quantify the chemical abundance required for fragmentation . in a following paper",
    ", we will study nonsolar abundance patterns motivated by predicted yields of primordial supernovae . in this future work",
    ", we will vary the abundances of individual elements , which will require the exploration of a much larger parameter - space .",
    "we create a cloudy / roco data - grid with the following parameters : 50 k @xmath0 t @xmath0 1000 k with @xmath59log(t ) @xmath42 0.012 ( 100 points ) , 1 @xmath3 @xmath0 n@xmath9 @xmath0 10@xmath2 @xmath3 with @xmath59log(n@xmath9 ) = 0.1 , and 10@xmath50 z@xmath4 @xmath0 z @xmath0 10@xmath39 z@xmath4 with @xmath59log(z ) = 1 .",
    "we , then , follow the same procedure used to produce fig .",
    "[ fig : cooling2 ] , as described in ",
    "[ sec : enzo ] . in this section",
    ", we omit the decrease in the cooling rate caused by compton heating on the cmb . in fig . [",
    "fig : tdtc ] , we plot the log of the ratio of the dynamical time to the cooling time for each of the metallicities in the data - grid and for the metal - free case .",
    "a cloud is able to fragment when log@xmath43(t@xmath57/t@xmath55 ) @xmath28 0 . as expected , there is no density at which metal - free gas can fragment for t @xmath56 200 k. as the metallicity increases , the value of log@xmath43(t@xmath57/t@xmath55 ) slowly increases , first in the low - temperature regime , where h@xmath7 cooling is inefficient , so even a small amount of metals has an effect . for gas with n@xmath9 = 10@xmath8 @xmath3 at t",
    "= 200 k , the fragmentation criterion is nearly met by z = 10@xmath60 z@xmath4 and well satisfied one order of magnitude higher in metallicity .",
    "once the metallicity reaches 10@xmath39 z@xmath4 , the entire parameter - space is fragmentable . at high densities , however , fragmentation will be curtailed as the cloud becomes optically thick to its own radiation @xcite . as was also reported by @xcite , the efficiency of the metal cooling peaks at n@xmath9 @xmath34 10@xmath40 @xmath3 , significantly lowering the critical metallicity required for fragmentation .",
    "the addition of metals to a gas also has the potential to trigger thermal instabilities during cloud - collapse . as in @xcite @xcite",
    ", we define a parcel of gas losing energy at a rate , l , to be thermally unstable if @xmath61 where l is expressed in terms of the cooling rate , @xmath11 , as @xmath62 the cooling rate , @xmath11 , can be locally approximated by a power - law in both temperature and density as @xmath63 the partial derivatives of eqn .",
    "[ eqn : thermal ] become @xmath64 and @xmath65 the thermal instability criterion simplifies to @xmath66 in fig . [",
    "fig : ctstability ] we plot the value of the instability parameter , ( @xmath67 - @xmath68 ) , for the same cooling data used for fig .",
    "[ fig : tdtc ] . for metal - free gas ( fig .",
    "[ fig : ctstability ] , top - left ) , the instability parameter is greater than 3 over nearly the entire parameter space , and always greater than 4 at high densities . @xcite and @xcite both arrive at the same conclusion using this analysis for metal - free gas , with the added assumption that the cooling function is independent of density . as the metallicity increases , a region of thermal instability forms at low density and temperature . when the metallicity reaches 10@xmath6 z@xmath4 ( fig .",
    "[ fig : ctstability ] , middle - right ) , a second unstable region exists for 10@xmath45 @xmath3 @xmath23 n@xmath9 @xmath23 10@xmath40 @xmath3 , at a temperature of a few hundred k. the second unstable region coincides with the increase in cooling efficiency to its maximum value , illustrated in fig .",
    "[ fig : tdtc ] .",
    "fragmentation is more likely to occur when the gas is both thermally unstable , and can cool faster than the dynamical time .",
    "we indicate the regions where both the fragmentation and thermal instability criteria are met in white in fig .",
    "[ fig : doublestability ] . no doubly unstable realm exists for metallicities , z @xmath0 10@xmath60 z@xmath4 .",
    "the cmb creates a temperature floor , below which gas can not cool radiatively .",
    "we study the influence of the cmb on the evolution of star - forming gas by applying a cmb floor at z = 20 in the manner described in  [ sec : enzo ] to the cooling data - grid used in ",
    "[ sec : thermal ] .",
    "the cmb affects the cooling properties of the gas in two ways .",
    "the first is by increasing the cooling time at temperatures near the cmb temperature to greater than the dynamical time so that the fragmentation criterion is no longer satisfied .",
    "the second is by increasing the value of @xmath67 , from equation [ eqn : thermal2 ] , at low temperatures , making the gas thermally stable . in fig .",
    "[ fig : doublestabilitycmb ] , we illustrate the influence of the cmb on the doubly unstable regions , shown previously .",
    "the unstable region that existed in the low - density , low - temperature regime is completely eliminated .",
    "there remains , however , a small area of instability for metallicities as low as 10@xmath6 z@xmath4 .",
    "we have introduced a new method for including the radiative cooling from metals in large , three - dimensional hydrodynamic simulations .",
    "in addition to its implementation in the amr code , enzo , this method has also been used by @xcite in numerical simulations with the smoothed particle hydrodynamics ( sph ) code , gadget @xcite .",
    "our technique takes advantage of the extremely complex chemical reaction network of the preexisting radiative transfer code , cloudy , which includes a full elemental coverage from h to zn , along with a variety of molecular species and dust . with the singular assumption of ionization equilibrium for the heavy elements , we are able to precalculate cooling rates for gases with any chemical abundance in all manners of radiation environments over a temperature range of 10 to 10@xmath1 k. with cooling rates computed in advance , we eliminate the barrier that has classically prevented large chemical models from being incorporated into three - dimensional numerical simulations .",
    "because our cooling scheme is valid over such a large range of density and temperature , and features so many coolants , it can be applied to a huge variety of astrophysical problems , such as the evolution of the ism and igm , normal star formation , planetary nebulae , accretion disks , and protoplanetary disks .",
    "one advantage of the large chemical network of cloudy is that we are able to determine the dominant coolants from a complete sample of atomic species up to an atomic number of 30 .",
    "fine - structure transitions of c and o are the greatest contributors to the cooling up to number densities of about 10@xmath40 @xmath3 , where fe cooling becomes significant and c is marginalized .",
    "the importance of these three elements , along with si , in triggering the formation of the first low - mass stars has been studied in great detail by @xcite .",
    "the cooling models we have constructed using solar abundance patterns reveal s cooling to be important for 10@xmath45 @xmath3 @xmath23 n@xmath9 @xmath23 10@xmath48 @xmath3 .",
    "s is produced only slightly less than si in type ii @xcite and pair - instability supernovae @xcite , and should be taken into account when considering the metals responsible for the transition from population iii to population ii star formation .",
    "the ability to specify individual abundances in our cooling method makes it straightforward to simulate the evolution of gas with non - solar abundance patterns .",
    "in addition to elevating the cooling rate of a gas to satisfy the classical fragmentation criterion , metals also increase the potential for fragmentation by creating thermal instabilities .",
    "we have identified regions in temperature and density in which both the classical fragmentation and thermal instability criteria are met to be the physical conditions most likely to see fragmentation occur .",
    "we observe these doubly unstable regions to exist for metallicities as low as 10@xmath6 z@xmath4 .",
    "if fragmentation can not occur outside these regions , then the fate of a star - forming gas - cloud will be determined by the path taken through density - temperature space as it collapses . if we consider the doubly unstable regions in fig .",
    "[ fig : doublestability ] , appropriate for star - formation in current epoch , there will almost certainly be a period of double instability when z @xmath5 10@xmath46 z@xmath4 .",
    "interestingly , the density - temperature tracks shown in fig . 1 of @xcite indicate that gas with z = 10@xmath6 z@xmath4 will pass right through the stable region that separates two instabilities .",
    "@xcite also find that star formation at that metallicity only produces high - mass fragments . at high redshift ,",
    "the cmb significantly reduces the size of the doubly unstable regions .",
    "thermal instabilities , though , are extremely sensitive to the slope of the cooling rate as a function of density and temperature .",
    "every element has distinct cooling properties , and will , therefore , produce different thermal instabilities . as such , the key to uncovering the nature of the first population ii stars will be in the determination of the mass function of their precursors .",
    "in papers to follow , we will extend our study to gases with non - solar abundance patterns .",
    "we will explore thermal and double instabilities created by individual elements , as well as abundance patterns produced in population iii supernovae .",
    "future studies will also investigate the effects of background radiation on the evolution of star - forming gas .",
    "the final word , however , will only come from three - dimensional , numerical simulations .",
    "the simulations by @xcite , employing the methods described here with solar abundance patterns , have confirmed that fragmentation occurs for metallicities , z @xmath5 10@xmath46 z@xmath4 .",
    "we intend to pair all future predictions made from analysis of thermal instabilities with full numerical simulations .",
    "although dust physics has been implemented in cloudy , we currently treat only metals in the gas - phase in our analysis . in the future",
    ", we will study the effects of dust cooling in more detail .",
    "we will also couple the dust chemistry to the h / he chemical network in enzo , so as to properly model the formation of h@xmath7 on grain surfaces .",
    "a great strength of this method is the use of the ever - expanding chemical network of cloudy .",
    "as more physical processes are incorporated into the cloudy software , the utility of this method will increase as well .",
    "one major constraint of this work , however , is that its validity is confined to the optically thin limit .",
    "the approximations made here break down at opacities of order unity . for higher opacities",
    ", our method provides a core module for flux - limited diffusion schemes .",
    "complex geometries introduce problems of self - heating and shadowing , which will require full , three - dimensional radiative transfer .",
    "based on observations made with the nasa / esa hubble space telescope , obtained from the data archive at the space telescope institute .",
    "stsci is operated by the association of universities for research in astronomy , inc . under the nasa contract",
    "nas 5 - 26555 .",
    "this research was supported by hubble space telescope theory grant hst - ar-10978.01 , a grant from nasa s atp nng04gu99 g , and nsf career award ast-0239709 from the national science foundation .",
    "we are grateful to an anonymous referee for sharing many insightful comments and suggestions .",
    "we also thank brian oshea and mike norman for useful discussions and support .",
    "ss also thanks kipac and stanford university for their hospitality .",
    "t. , smith b.  d. , eracleous m. , sigurdsson s. , 2006 , in laser interferometer space antenna : 6th international lisa symposium vol .",
    "873 of american institute of physics conference series , electromagnetic signatures of massive black hole binaries .",
    "pp 257263              g. , norman m.  l. , 1997 , in chrisochoides n. , ed . , workshop on structured adaptive mech refinement grid methods i m a volumes in mathematics no .",
    "117 , a hybrid amr application for cosmology and astrophysics .",
    "springer - verlag                              a. , meynet g. , hirschi r. , 2005 , in barnes iii t.  g. , bash f.  n. , eds , cosmic abundances as records of stellar evolution and nucleosynthesis vol .  336 of astronomical society of the pacific conference series , chemical abundances and yields from massive stars .",
    "pp 79+          b.  w. , g. b. , bordner j. , norman m.  l. , abel t. , harknes r. , kritsuk a. , 2004 , in plewa t. , linde t. , weirs v.  g. , eds , adaptive mesh refinement - theory and applications vol .  41 of lecture notes in computational science and engineering , proceedings of the chicago workshop on adaptive mesh refinement"
  ],
  "abstract_text": [
    "<S> the addition of metals to any gas can significantly alter its evolution by increasing the rate of radiative cooling . in star - forming environments , enhanced cooling can potentially lead to fragmentation and the formation of low - mass stars , where metal - free gas - clouds have been shown not to fragment . adding metal cooling to numerical simulations has traditionally required a choice between speed and accuracy . </S>",
    "<S> we introduce a method that uses the sophisticated chemical network of the photoionization software , cloudy , to include radiative cooling from a complete set of metals up to atomic number 30 ( zn ) that can be used with large - scale three - dimensional hydrodynamic simulations . </S>",
    "<S> our method is valid over an extremely large temperature range ( 10 k @xmath0 t @xmath0 10@xmath1 k ) , up to hydrogen number densities of 10@xmath2 @xmath3 . at this density </S>",
    "<S> , a sphere of 1 m@xmath4 has a radius of roughly 40 au . </S>",
    "<S> we implement our method in the adaptive mesh refinement ( amr ) hydrodynamic / n - body code , enzo . using cooling rates generated with this method , we study the physical conditions that led to the transition from population iii to population ii star formation . while c , o , fe , and si have been previously shown to make the strongest contribution to the cooling in low - metallicity gas , we find that up to 40% of the metal cooling comes from fine - structure emission by s , when solar abundance patterns are present . at metallicities , z @xmath5 10@xmath6 z@xmath4 , </S>",
    "<S> regions of density and temperature exist where gas is both thermally unstable and has a cooling time less than its dynamical time . </S>",
    "<S> we identify these doubly unstable regions as the most inducive to fragmentation . at high redshifts , </S>",
    "<S> the cosmic microwave background inhibits efficient cooling at low temperatures and , thus , reduces the size of the doubly unstable regions , making fragmentation more difficult .    </S>",
    "<S> [ firstpage ]    stars : formation methods : numerical </S>"
  ]
}