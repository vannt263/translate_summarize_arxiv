{
  "article_text": [
    "as the number of extrasolar planets discovered increases continuously , there is a growing volume of models of planet population synthesis , in which one evolves a collection of planets in a model of protoplanetary disk , so as to compare the statistics of real planetary systems to those of the model outcomes @xcite . one key feature of models of planetary population synthesis is the tidal torque that exists between a planet and its parent protoplanetary disk , and which drives a radial migration of the planet . since this torque is large , planets migrate a substantial fraction of their initial semi major axis over the disk lifetime , and a model s outcome strongly depends on the underlying torque expression .",
    "the tidal torque has two components :    * the differential lindblad torque , exerted by a wake excited by the planet in the neighboring flow , where the latter becomes supersonic with respect to the planet , owing to the strong keplerian shear . * the corotation torque , which corresponds to an exchange of angular momentum between the planet and the coorbital material .",
    "early efforts have intensively focused on the differential lindblad torque , which is now known in great detail in power law disks .",
    "the well known standard formula of @xcite has proved to account for the torque measured in numerical simulations with remarkable accuracy .",
    "more recently , the corotation torque has received a detailed attention , and was shown to have two components : one related to the vortensity gradient across the orbit , and another one related to the entropy gradient across the orbit @xcite .",
    "the corotation torque , moreover , depends on the dissipative processes at work in the disk . @xcite",
    "have provided general corotation torque formulae that may be applied to planets embedded in disks with arbitrary vortensity and entropy profiles , and with arbitrary values of the viscosity and thermal diffusivity .",
    "the domain of validity of the formulae for the corotation torque now supersedes that of the lindblad torque : the corotation torque formulae apply to arbitrary profiles , and only requires the evaluation of radial derivatives at the orbit , whereas the lindblad torque standard formula exclusively applies to disks where the surface density and temperature profiles are power laws of the radius .",
    "when this is not the case , one has to resort to basics and evaluate the torque individually at each lindblad resonance .",
    "this was the approach undertaken by @xcite , who stressed the high sensitivity of the torque to the resonance location .",
    "their key result was that the lindblad torque can be substantially reduced at locations , in the disk , where the local profiles of surface density and/or temperature can not be approximated by power laws , namely at opacity transitions .",
    "this approach , nonetheless , would be very costly in planetary population synthesis models , as it would require the evaluation of a series at each time step , for each planet .",
    "to the best of our knowledge , all the planetary population synthesis models performed thus far have made use , in different flavors , of standard torque formulae for type  i migrating objects , in some case including a uniform , _ ad hoc _ reduction factor so as to moderate the drastic effects of standard type  i migration .",
    "the present work is an attempt to provide a simple generalization of the standard lindblad torque formula , that can be applied in arbitrary disk models ( _ i .",
    "e. _ where the profiles of surface density and temperature are not power laws of radius ) .",
    "the reader may glimpse at eq .",
    "( [ eq:79 ] ) , which constitutes our main result , and compare it with eq .",
    "( [ eq:10 ] ) , which is the standard expression in power law disks .",
    "as can be seen , there is very little additional complexity in evaluating eq .",
    "( [ eq:79 ] ) , which can be readily implemented in models of planetary population synthesis .",
    "we firstly define the notation in section  [ sec : notation].we then discuss in some detail the relevance of numerical simulations in the low - mass regime in assessing the linear torques in section  [ sec : relev - numer - simul ] , and we present standard torque expressions in section  [ sec : stand - lindbl - torq ] . in particular , we need to calibrate the corotation torque in order to properly subtract it from our runs , so that we get exclusively the lindblad torque .",
    "we present our method in section  [ sec : assumptions - set - up ] .",
    "we then derive the effects of higher order derivatives of the surface density or temperature on the lindblad torque in section  [ sec : indiv - effects - high ] .",
    "as we shall see , the end result is particularly simple , as it turns out that only the third derivative of the temperature has a significant impact on the lindblad torque .",
    "we then apply this formula to a disk model aimed at representing an opacity transition in section  [ sec : torque - behavior - at ] , where we present the generalized torque expression in definitive form . in that section",
    "we also estimate the corotation torque .",
    "we find that at the transition the corotation torque also features a term proportional to the third derivative of the temperature , with a sign opposite to that of the lindblad torque .",
    "we discuss our results in section  [ sec : discussion ] and draw our conclusions in section  [ sec : conclusions ] .",
    "we consider a planet of mass @xmath0 orbiting a star of mass @xmath1 on a circular orbit of radius @xmath2 , with orbital frequency @xmath3 .",
    "the planet is embedded in a gaseous disk with surface density @xmath4 and temperature @xmath5 .",
    "the vertical scale height @xmath6 of the disk is related to the gas sound speed @xmath7 and to the local keplerian frequency @xmath8 by : @xmath9 we oftentimes use the disk aspect ratio or relative thickness defined as @xmath10 , and the planet to star mass ratio @xmath11 .",
    "we denote @xmath12 the vertical component of the flow s vorticity : @xmath13    we define hereafter notation specific to non power law disks .",
    "we denote with @xmath14 a quantity related to the @xmath15 derivative of the surface density : @xmath16 we thus have : @xmath17 @xmath18 @xmath19 in a power law disk , all @xmath14 with @xmath20 cancel out and we have @xmath21 .",
    "our value of @xmath22 coincides with the standard notation @xmath23 of @xcite .",
    "the factor @xmath24 in eq .",
    "( [ eq:3 ] ) is exclusively meant to conserve the minus sign for the first derivative , so as to save the standard practice .",
    "in contrast , higher order derivatives do not feature this minus sign . in a similar fashion",
    "we denote with @xmath25 a quantity related to the @xmath15 derivative of the temperature : @xmath26 our @xmath27 therefore coincides with the value of @xmath28 of @xcite , or with the value of @xmath29 of @xcite , but it is twice the value of @xmath29 of @xcite , where @xmath29 is the slope of the sound speed rather than the temperature .",
    "we work out how the differential lindblad torque behaves in a disk in which some of the @xmath14 and/or @xmath25 ( @xmath30 ) do not cancel out .",
    "we limit ourselves to @xmath31 .",
    "as we shall see in section  [ sec : torque - behavior - at ] , there is no need to push the expansion further .",
    "we entertain separately the role of the @xmath14 and @xmath25 ( @xmath32 ) , assuming that the resonance shift is sufficiently small that the global effect is obtained by adding up individual contributions of higher derivatives of surface density and temperature .",
    "we shall often refer to the residue of the surface density profile with respect to the power law surface density with same @xmath22 as a perturbation ( the same holds for perturbations of temperature ) .",
    "it should be noted however that this perturbation is not related to the planet .",
    "it is axisymmetric , and the `` perturbed '' disk is in rotational equilibrium .",
    "since full hydrodynamical simulations are non - linear in nature , it is questionable whether the torques obtained in simulations in the low - mass regime can be regarded as estimates of the linear torque value . as a prerequisite",
    ", it is therefore necessary to confront the torque thus obtained to the torque obtained independently by a linear analysis .",
    "this is the work of @xcite .",
    "part of their findings ( the ones that we shall need in this work ) are as follows :    1 .   for low - mass planets ,",
    "non - linear effects are found at all masses , and identified with the onset of the horseshoe drag regime , provided the disk s viscosity is sufficiently low . in that case , the linear corotation torque exists only temporarily upon insertion of the planet .",
    "the timescale for the onset of non - linear effects scales with @xmath33 .",
    "2 .   in the inviscid case , the ( non - linear ) corotation torque saturates at larger time , leaving only the linear lindblad torque .",
    "3 .   at early time or at any time for large viscosity",
    ", the total torque acting on the planet is found to be in excellent agreement with the total linear torque .",
    "@xcite established these results in disks with a locally isothermal equation of state , that is disks in which the sound speed or temperature is an arbitrary function of @xmath34 , constant in time .",
    "admittedly , they obtained these results by considering various temperature and surface density profiles which are exclusively power laws of the radius .",
    "we shall use the result  2 above in the very same framework ( see appendix  [ sec : calibr - lindbl - torq ] ) , _",
    "i. e. _ for power law disks , in order to establish an expression for the lindblad torque in these disks , that is valid for our particular setup ( two dimensional disks and a planetary potential softened over a given length . ) in regard to the above we shall consider that expression as a good approximation of the linear lindblad torque .",
    "we shall use the result  3 also in power law disks ( see appendix  [ sec : calibr - lindbl - torq ] ) , so as to get an expression for the total torque , which , again , we regard as a good approximation of the total linear torque for the reasons listed above .",
    "this enables us to get an expression of the corotation torque at early times ( by subtracting the lindblad torque ) , as a function of the gradients of vortensity and temperature .",
    "this step is needed to enable us to subtract the corotation torque from the runs in which the disk profiles are not power laws of radius , so as to get the lindblad torque .",
    "finally , we shall measure the total torque at early time in calculations where the surface density or temperature profiles are not power laws of the radius .",
    "although , strictly speaking , this is not contemplated in the framework of @xcite , it is reasonable to consider that the torque acting on the planet has a linear value at this stage .",
    "regardless of the profiles , the response of a disk to a planet of low mass ( @xmath35 ) should be linear over a time interval that can be made arbitrarily large by decreasing the planetary mass .",
    "we further comment that in our case , we have @xmath36 , almost an order of magnitude smaller than that of the fiducial calculation of @xcite , which is @xmath37 .    we conclude that numerical simulations , albeit non - linear in essence , can be used to assess with a good accuracy the linear torques acting on a low - mass planet .",
    "the degree of accuracy can be estimated either by comparing our data to the expression of @xcite for power law profiles , or by evaluating the fitting error of our data ( see appendix  [ sec : calibr - lindbl - torq ] ) . from both methods",
    "one can infer a degree of accuracy of a few percents , which is far enough for our purpose .",
    "standard lindblad torque formulae , be they two or three dimensional , all share the same form : @xmath38 where @xmath39 , @xmath40 and @xmath41 are numerical constants of order unity , and where @xmath42 is the torque normalization factor given by : @xmath43 we refer to lindblad torque formulae having the form of eq .",
    "( [ eq:8 ] ) as _ standard _ to express that they exclusively involve a linear combination of the surface density and temperature first derivatives at the position of the orbit .",
    "strictly speaking , standard lindblad torque formulae are valid only in disks in which both surface density and temperature are power laws of the radius .",
    "the expression of the lindblad torques alone are not explicitly given by @xcite , but they can be inferred from their tab .  1 and  2 ( see * ? ? ?",
    "this yields @xmath44 in the two dimensional case without softening , and @xmath45 in the three dimensional case .",
    "note that @xmath41 was left unexplored in this original work , as the authors restricted themselves to globally isothermal disks ( _ i.e. _ without a temperature gradient ) .    in the present work we shall deal with two dimensional disks and a softened planetary potential ( we chose a softening length of the potential @xmath46 ) . for our purpose",
    ", we therefore have to firstly establish the standard lindblad torque formulae in those disks .",
    "this is the purpose of appendix  [ sec : calibr - lindbl - torq ] , in which we evaluate simultaneously the standard torque expressions for the lindblad torque and for the total torque .",
    "these expressions are respectively @xmath47 and @xmath48 where the superscript ( which stands for numerical , linear ) conveys the method by which the expressions have been obtained , that is by means of numerical calculations , as an approximation to the linear value , along the lines of what has been exposed in section  [ sec : relev - numer - simul ] .",
    "we note that eq .",
    "( [ eq:10 ] ) is in good agreement with eq .",
    "( 14 ) of @xcite .",
    "it is of interest to confront eq .",
    "( [ eq:10 ] ) to a fully analytic torque estimate ( see appendix  [ sec : fully - analyt - torq ] for details ) , which yields : @xmath49 this estimate differs significantly from eq .",
    "( [ eq:10 ] ) , which is also very close to the estimate obtained by solving numerically the linear equations @xcite .",
    "similar discrepancy between fully analytic results and results obtained by other methods have already been noticed by @xcite .",
    "still , it broadly captures some of the salient features of the torque : it is negative for reasonable values of the surface density or temperature gradient , a faster decay outwards of the temperature ( larger @xmath27 ) shifts the resonances inwards and renders the torque more negative ( i.e. , the coefficient of @xmath27 is negative ) , and for similar surface density gradients and temperature gradients ( which shift the resonances in almost exactly the same amount ) , there is , in the case of a surface density gradient , an additional weighting by the local surface density which tends to counteract the resonance shift ( i.e. , the coefficient of @xmath22 is larger than that of @xmath27 ) .",
    "however , whereas eq .",
    "( [ eq:10 ] ) shows that both effects nearly cancel each other , as the coefficient of @xmath22 almost vanishes [ an effect known as the pressure buffer , shown by @xcite ] , it is not quite the case of eq .",
    "( [ eq:12 ] ) .",
    "a near cancellation is found , in fully analytic torque estimates , only for very low values of the smoothing length , and the coefficients of @xmath22 and @xmath27 are found to depend heavily on the smoothing length ( see also * ? ? ?",
    "the discrepancy between a fully analytic estimate and the true linear torque value ( given either by the numerical solution of the linear equations or estimated by means of adequate numerical simulations ) likely arises from the approximation of the torque cut - off in fully analytical estimates .",
    "this cut - off is given by the eq .",
    "( [ eq:91 ] ) , which , together with the expression for @xmath50 , the location of the resonance , determines how the lindblad torque behaves for higher order resonances .",
    "the denominator of eq .",
    "( [ eq:91 ] ) , in particular , is only approximate @xcite .",
    "the expression of the corotation torque , given by : @xmath51 must be recast for our needs to : @xmath52 where @xmath53 is referred to for brevity as the vortensity gradient .",
    "( [ eq:13 ] ) and  ( [ eq:14 ] ) are equivalent in power law disks .",
    "however , it is the form of eq .",
    "( [ eq:14 ] ) that must be used for arbitrary profiles , as the vortensity gradient @xmath54 can differ significantly from @xmath55 , as we shall see in section  [ sec : corotation - torque - at ] .",
    "we shall come back to this substitution in section  [ sec : case - non - vanishing ] , where we compare the effect of higher order derivatives on the torque obtained either by a fully analytic approach or by numerical simulations .",
    "we shall see that these effects , which affect preferentially lower order resonances , are not plagued by the inaccuracies due to the torque cut - off .",
    "this allows a direct comparison of analytics and simulations , which give essentially the same results , thereby validating eq .",
    "( [ eq:14 ] ) .",
    "it is instructive to note that the coefficients of @xmath22 and @xmath27 in eq .",
    "( [ eq:14 ] ) are approximately equal .",
    "one can notice that eq .",
    "( 11 ) of @xcite is suggestive of this result . getting rid of all terms of this equation that involve derivatives in @xmath56 , which do not exist in a two - dimensional disk",
    ", one sees that the pole at corotation for @xmath57 consists of two contributions : one in the vortensity gradient , and another one that scales with @xmath58 ( remember that tanaka et al s @xmath29 is half our @xmath27 ) . eq .",
    "( [ eq:14 ] ) will be used from now on to subtract the corotation torque ( again considered here as a good approximation to the linear corotation torque ) , from the total torque at early times in calculations where the disk profiles are not power laws , so as to get the lindblad torque .",
    "in disks in which the surface density profile or the temperature profile is not a power law of the radius , the locations of lindblad resonances differ from their locations in a power law disk with same value of @xmath22 and @xmath27 .",
    "the lindblad torques , which sensitively depend on the resonance location , can therefore undergo large changes , not captured by a standard torque expression .",
    "our approach is threefold : we give an analytical order of magnitude of the effect , we check our predictions by means of dedicated numerical simulations , and by means of a completely analytic estimate given by summing the contribution of all lindblad resonances ( see appendix [ sec : fully - analyt - torq ] . )",
    "although this last method yields results more accurate than our order of magnitude estimate , it does not provide much insight into the relationship between the local properties of the density and temperature profiles on one hand , and the lindblad torque properties on the other hand .",
    "for this reason we find it relevant to get an estimate of magnitude of the effects of higher order terms as follows : we focus on the resonances that most contribute to the torque , which correspond to azimuthal wave numbers @xmath59 . for such values of @xmath60 , we evaluate the resonance shift , which we improperly call the wake shift . in order to translate this wake shift into a torque variation , we firstly calibrate the one - sided torque dependence on the wake shift by a series of dedicated calculations , in which we evaluate how the ( one - sided ) lindblad torque changes as a resonance is shifted , by tuning the orbital frequency of the planet that remains on a circular orbit of fixed radius .",
    "this is exposed in appendix  [ sec : calibr - one - sided ] . from the standard torque formula at a given resonance , given at eq .",
    "( [ eq:90 ] ) , we see that under a perturbation of the disk profiles the torque can change either as a result of the forcing potential ( hence a shift , in our case ) or as a result of a change of the `` width '' of the resonance , given by the denominator in @xmath61 .",
    "the latter effect is negligible in our case , and most of the torque change is accounted for by the resonance shift .",
    "we note that our simplified method of evaluating the `` wake shift '' presents an obvious flaw : the major contribution to the lindblad torque change may not arise from the resonances that most contribute to the lindblad torque .",
    "this method gives nevertheless a reasonable order of magnitude of the torque variation , and , more importantly , it suggests a functional form for the torque variation due to higher order derivatives .",
    "once this form has been obtained , one can resort to numerical simulations to adjust numerical coefficients .",
    "we comment that even though we can obtain the linear lindblad torque by a linear analysis , which is self - contained and does not feature free parameters , the result is not strictly amenable to a simple form such as the one we are aiming to .",
    "an obvious reason for that is that the higher order derivatives of the disk profiles at the location of each lindblad resonance feature in the result .",
    "the reduction of the lindblad torque to a simple approximate expression still involves the identification of a physically grounded , simple functional form , and the subsequent adjustment of free parameters .",
    "our final expression should therefore be regarded as an empirical estimate , even though its functional dependence is motivated by considerations on the wake shift .",
    "we undertake in the following two kinds of numerical experiments :    1 .   in sections  [ sec : case - non - vanishing ] and",
    "[ sec : case - non - vanishing-1 ] we check the dependence of the lindblad torque on a given higher order derivative of the temperature ( section  [ sec : case - non - vanishing ] ) or surface density ( section  [ sec : case - non - vanishing-1 ] ) .",
    "2 .   in section [ sec : torque - behavior - at ] we examine the lindblad torque behavior at an opacity transition .    for the first series of numerical experiments , we adopt disk profiles that are power laws of radius , except on the annulus @xmath62 . over this annulus ,",
    "the value of @xmath25 or @xmath14 of interest is constant .",
    "the disk profiles outside of the annulus are extrapolated so that @xmath22 and @xmath27 are continuous over the whole computational domain .",
    "we chose @xmath63 or @xmath64 , in order to cover the domain over which the exchange of angular momentum between the disk and the planet takes place .",
    "all numerical simulations were performed with the fargo code @xcite , in its locally isothermal version . in all cases",
    "we evaluate the linear total torque by a time average from  @xmath65 to  @xmath66 orbital periods , then we subtract the linear corotation torque expression given by eq .",
    "( [ eq:14 ] ) .",
    "an implicit assumption underlying this procedure is that the linear corotation torque does not depend upon higher order derivatives of the temperature or vortensity .",
    "this is a reasonable assumption , as this torque is associated to a singularity at corotation , whereas the lindblad torque owes its sensitivity to higher order derivatives to its non - local character .",
    "note however that the corotation torque must be cast in terms of the gradient of vortensity and gradient of temperature .",
    "the former , in particular , can bear a dependency on higher order derivatives of the surface density or temperature .",
    "the calculations of sections  [ sec : case - non - vanishing ] and  [ sec : case - non - vanishing-1 ] were performed with a planet of mass @xmath67 , embedded in a disk with aspect ratio @xmath68 at the planetary orbit .",
    "the mesh extends from @xmath69 to @xmath70 , and has resolution @xmath71 and @xmath72 .",
    "non - reflecting boundary conditions were used , but those should have no impact on the results , since during the early stage in which we evaluate the torque the wake has hardly reached the mesh boundaries .",
    "more details about the setup of section  [ sec : torque - behavior - at ] will be given therein .",
    "the `` effective '' location @xmath50 ( e.g. * ? ? ? * ) of a lindblad resonance associated to the component of the planetary potential with @xmath60-fold symmetry is given by : @xmath73 where @xmath74 the effect of a perturbation of the sound speed or surface density profile is to induce a variation @xmath75 of @xmath76 , which shifts the resonance location by the amount : @xmath77 the rotational equilibrium of the disk reads @xmath78 while the expression of the epicyclic frequency is @xmath79 using eqs .",
    "( [ eq:18 ] ) and ( [ eq:19 ] ) we infer : @xmath80 which can be recast , in a power law disk , as : @xmath81.\\ ] ] deriving @xmath76 with respect to @xmath34 , we get : @xmath82 where henceforth the upper ( lower ) sign is for the outer ( inner ) lindblad resonance , and where we have retained terms in @xmath83 but not those in @xmath84 . since the components that most contribute to the lindblad torque have @xmath85 , we can simplify , for our purpose , eq .",
    "( [ eq:22 ] ) as follows : @xmath86 from which we infer @xmath87 we contemplate below two distinct cases : ( i ) the case for which the rotation profile is altered by a perturbation of temperature , the surface density remaining constant , and ( ii ) the opposite case , in which the profile of temperature remains unchanged , but a perturbation of surface density is introduced .",
    "the variation of @xmath76 under an axisymmetric perturbation of sound speed ( or temperature ) is : @xmath88 where @xmath89 is the perturbation of angular velocity which can be related to the pressure perturbation by means of eq .",
    "( [ eq:18 ] ) : @xmath90 using eq .",
    "( [ eq:26 ] ) , eq .",
    "( [ eq:25 ] ) can be recast as : @xmath91 where we retain only the highest order terms in @xmath60 .",
    "the radial shift of the resonance is thus : @xmath92    we now specialize to the case of a non - vanishing @xmath93 . exploiting the fact that @xmath93 is non - negligible whenever @xmath27 varies over a length scale much shorter than @xmath34 , we can transform eq .",
    "( [ eq:5 ] ) into : @xmath94 denoting with @xmath95 , where @xmath96 is the corotation radius , we can write : @xmath97 we denote @xmath98 the value of the azimuthal wavenumber for which the torque is maximal . since @xmath99 is of order @xmath100 , we substitute the location of the resonance @xmath101 with @xmath102 , where we introduce @xmath103 as a free parameter .",
    "this yields : @xmath104,\\ ] ] where @xmath105 , and where @xmath106 is the distance of the wake to the orbit .",
    "we can further transform this expression using the value of @xmath107 inferred for instance from fig .  5 of @xcite , which gives @xmath108 .",
    "similarly we take @xmath109 @xcite .",
    "this leads to : @xmath110    we now turn to the case of a non - vanishing @xmath111 .",
    "we can write : @xmath112 hence for a given resonance",
    "we have : @xmath113 from which we infer an approximate expression of the relative shift of the wake : @xmath114 we can evaluate the impact of those shifts on the differential lindblad torque using the calibration presented in appendix  [ sec : calibr - one - sided ] .",
    "we use the approximation that : @xmath115 with @xmath116 , where @xmath117 is the one - sided lindblad torque exerted at outer ( inner ) lindblad resonances , and where @xmath118 is the distance of the outer ( inner ) wake to corotation .",
    "we eventually write the outer and inner torques respectively as @xmath119 where @xmath120 is the one - sided lindblad torque ( average of the absolute value of the inner and outer torques ) , and where @xmath121 is a dimensionless parameter that quantifies the degree of asymmetry between the inner and outer torque .",
    "we have the following expression for the one - sided lindblad torque : @xmath122 where the numerical coefficient is easily obtained from numerical simulations . both two dimensional runs with a softening parameter @xmath46 and three dimensional runs with a very small softening parameter yield the same coefficient of order @xmath123 .",
    "we make the following comments :    * the coefficient @xmath121 depends on whether the disk considered is two or three dimensional , and in the former case it also depends on the softening length of the potential . in our set of calculations , it turns out to be of order @xmath124 , but this value is highly specific to our case . as we explain below , nevertheless , this does not have any impact on the final result .",
    "* as @xmath93 varies the outer and inner wakes both recede ( or approach ) corotation , as can be seen from eq .",
    "( [ eq:31 ] ) .",
    "we therefore expect a minute effect of those shifts on the differential lindblad torque .",
    "* on the contrary , terms arising from @xmath111 yield shifts of outer and inner torques that have same sign , thus giving a much stronger ( cumulative ) effect on the differential lindblad torque .",
    "the effect in that case will essentially scale with the one - sided lindblad torque , and the asymmetry term @xmath125 does not feature at lowest order .",
    "using eq .",
    "( [ eq:36 ] ) , we have : @xmath126 we consider separately the case of terms of even order , which have @xmath127 , and the case of terms of odd order , for which @xmath128 . in the first case",
    "we find @xmath129 whereas in the second case we get : @xmath130 in this last case , using eq .",
    "( [ eq:35 ] ) , we are left with : @xmath131 which can be recast as : @xmath132    ) .",
    "the curve with diamonds stands for a reference calculation ( @xmath133 and @xmath63 ) .",
    "the curve with triangles has @xmath134 and @xmath63 , whereas the curve with squares corresponds to @xmath133 and @xmath64 .",
    "the dashed lines show the dependency of the differential lindblad torque on the second derivative of temperature ( @xmath93 ) : the line with diamonds represents the results of numerical simulations , whereas the plain dashed line represents the expectation of eq .",
    "( [ eq:48 ] ) .",
    "some runs with high values of @xmath135 or @xmath136 , which have extremely high or extremely low sound speed near the boundaries , happen to have crashed in the very first time steps , which explains why some points are missing in this plot .",
    "the dot - dashed line shows the linear dependence on @xmath111 of the fully analytic torque estimate , extrapolated to larger values of @xmath111 , for the case @xmath133 and @xmath64 ( see main text for details . ) ]    the numerical calculations presented in fig .",
    "[ fig : ld3 t ] exhibit a dependency in broad agreement with the estimate of eq .",
    "( [ eq:45 ] ) , as a linear regression fit on this data yields : @xmath137 where the actual value of @xmath138 , comprised between @xmath139 and @xmath140 , depends on the details of the setup , and essentially on the value of @xmath141 ( see fig .  [",
    "fig : ld3 t ] ) .",
    "this figure also shows the dependency on @xmath111 of the analytic torque estimate ( see appendix [ sec : fully - analyt - torq ] for details ) .",
    "we note that our fully analytical estimates do not cover the whole range of @xmath111 , as in our simple implementation the algorithm that seeks the location of a resonance fails for very distorted profiles .",
    "rather , we find that the lindblad torque value has a linear dependence on @xmath111 for low values of @xmath111 ( @xmath142 ) , and that its slope coincides quite remarkably with that obtained in numerical simulations ( we find a slope @xmath138 of the analytic estimate of @xmath143 for @xmath63 , and of @xmath144 for @xmath64 ) .",
    "it is surprising , at first , that such a good agreement is obtained between numerics and analytics , whereas the analytic estimate performs poorly for power law disk profiles ( see section  [ sec : stand - lindbl - torq ] ) .",
    "we note , however , that the further a resonance lies from the orbit , the larger its shift , so that most of the torque change is due to resonances of order lower than those which predominantly contribute to the torque .",
    "this corroborates the fact that the inaccuracy of the fully analytic torque expressions likely comes from highest order resonances , as a consequence of the approximate form of the torque cut - off .",
    "the good agreement that we find also justifies , indirectly , our substitution from eq .",
    "( [ eq:13 ] ) to eq .",
    "( [ eq:14 ] ) .",
    "it is also noteworthy that this comparison between numerics and analytics completely fails if one does not include the factor @xmath145 in eq .",
    "( [ eq:91 ] ) . in that case one finds a nearly flat dependence of the torque on @xmath111 .",
    "we now work out the torque change due to @xmath93 . using eqs .",
    "( [ eq:31 ] ) and ( [ eq:42 ] ) , we are led to : @xmath146 using the fact that , in our case , we turn out to have @xmath147 ( the actual coefficient depends on the @xmath14 s and @xmath25 s ) , we eventually write : @xmath148 the dependency on @xmath93 , as expected , is much weaker than the dependency on @xmath111 , so we shall neglect it . figure  [ fig : ld3 t ] shows that the actual dependence of the lindblad torque on @xmath93 is even weaker .",
    "we now turn to the dependency of the differential lindblad torque on the higher order derivatives of the surface density , assuming that the temperature profile remains a power law of radius . for this purpose we recast eq .",
    "( [ eq:20 ] ) as : @xmath149 in a similar fashion , we transform eq .",
    "( [ eq:18 ] ) as : @xmath150 so we can write : @xmath151 considering as previously that terms that contribute significantly to the torque have @xmath152 , eq .",
    "( [ eq:17 ] ) leads us to : @xmath153 as in the case of perturbations of the sound speed profile , we entertain separately the cases @xmath154 and @xmath155 .    in the first case",
    ", we have : @xmath156 hence @xmath157\\approx 0.76h\\alpha_2\\ ] ] this dependency is almost the same as the one predicted by eq .",
    "( [ eq:31 ] ) on @xmath93 , and the torque has nearly same dependence on @xmath158 , namely : @xmath159 in addition to the effect of the resonance shifts there is an additional torque variation arising from the change of surface density itself .",
    "the perturbed surface density corresponding to @xmath158 being even in @xmath160 , its impact on the differential lindblad torque is very small and is not contemplated here .",
    "we now evaluate the torque variation due to the third derivative of surface density .",
    "we firstly work out the resonance shift , and then evaluate the additional effect arising from the torque weighting by surface density .",
    "we write : @xmath161 and @xmath162 hence eq .",
    "( [ eq:52 ] ) gives : @xmath163 so that : @xmath164 a calculation similar to that of eqs .",
    "( [ eq:44 ] ) to  ( [ eq:45 ] ) yields : @xmath165 in addition to the resonance shift , the change of surface density also impacts the differential lindblad torque .",
    "one can easily see that the surface density contribution tends to compensate the wake shift .",
    "assume that @xmath166 is positive . the resonance shift given by eq .",
    "( [ eq:59 ] ) shows that the wake is shifted outward , which yields an increase of the inner torque and an increase of the outer torque ( decrease in absolute value ) , hence an increase of the differential lindblad torque , as seen previously in the case of a non - vanishing @xmath111 .",
    "however , there is now also a larger surface density at the outer wake , and a lower surface density at the inner wake .",
    "the contribution of this surface density change is opposite to that of the resonance shift , hence we expect the dependence of the differential lindblad torque on @xmath166 to be weaker than that on @xmath111 .",
    "we show hereafter that the contribution of the surface density change is of same order than that due to resonance shift ( albeit with the opposite sign ) , and then we resort to numerical calculations to assess the actual dependence .    in order to evaluate separately the impact of the surface density change on the one - sided ( then differential ) lindblad",
    ", we use the torque expression of eq .",
    "( [ eq:90 ] ) , so that we can write the relative torque change as : @xmath167 using eq .",
    "( [ eq:6 ] ) , we recast eq .",
    "( [ eq:61 ] ) as : @xmath168 where @xmath169 in eq .",
    "( [ eq:62 ] ) , whenever a value of @xmath170 is larger than @xmath171 , the half size of the region over which @xmath166 is constant and non - vanishing , we clamp it to @xmath172 .",
    "this happens for the smallest values of @xmath60 and is meant to adhere strictly to the set up of numerical simulations .",
    "the evaluation of eq .",
    "( [ eq:62 ] ) yields @xmath173 we deduce that the surface density impact on the differential lindblad torque is , using eq .",
    "( [ eq:39 ] ) : @xmath174 the net effect of the surface density change , which combines the effect of the resonance shifts , given by eq .",
    "( [ eq:60 ] ) , and the change of the background density itself , given by eq .",
    "( [ eq:65 ] ) , amounts to : @xmath175 we see therefore that the effect of the third order derivative of the surface density should be weaker than that of the third order derivative of the temperature .",
    "numerical calculations presented in fig .  [ fig : dlta3 ] show that the net dependence is actually much weaker , which shows that the two effects described respectively in eqs .",
    "( [ eq:60 ] ) and ( [ eq:65 ] ) approximately cancel out . as a consequence , for our purpose we can consider that the differential lindblad torque does not depend on @xmath166 ( as stressed in section [ sec : wake - shift ] ,",
    "the analytic estimate of the shift of resonances that most contribute to the torque is used as a guideline and the actual dependency found in numerical calculations is favored for the reasons exposed in that section . ) fig .",
    "[ fig : dlta3 ] also shows the dependency of the full analytic torque estimate ( see appendix  [ sec : fully - analyt - torq ] for details ) on @xmath166 .",
    "the dependence has opposite sign that the one inferred from the simple calculation based on the wake shift .",
    "the surface density weighting again overshoots the effect of the resonance shifts .",
    "this observation is reminiscent of the results for power law profiles given in section  [ sec : stand - lindbl - torq ] , where the coefficient of @xmath22 of the fully analytic torque estimate was found to have a sign opposite than that of @xmath27 .",
    "( solid lines ) compared to the dependence on @xmath111 ( dashed line , which corresponds to the reference calculation of fig .",
    "[ fig : ld3 t ] ) .",
    "the differential lindblad torque turns out to be essentially insensitive to @xmath166 .",
    "besides , its weak dependence on @xmath166 is not a simple linear relationship , and its shape depends ( slightly ) on the value of @xmath22 ( @xmath134 for the curve with squares , whereas @xmath133 for the curve with triangles ) .",
    "the dot - dashed line shows the dependency on @xmath166 of the full analytic estimate of the torque , extrapolated from lower values of @xmath166 ( @xmath176 , see section  [ sec : case - non - vanishing ] ) . ]",
    "we have seen that the only non - negligible contribution to the differential lindblad torque from higher order derivatives of the density or temperature is the term that stems from the third order derivative of the temperature .",
    "we can now propose a tentative generalized differential lindblad torque expression in non power - law disks , for the two dimensional disks with softening length @xmath46 .",
    "out of the four dependencies that we have worked out ( on @xmath93 , @xmath111 , @xmath158 and @xmath166 ) , the dependency on @xmath111 , given at eqs .",
    "( [ eq:45])-([eq:46 ] ) , is much larger than the other ones , given by eqs .",
    "( [ eq:48 ] ) , ( [ eq:55 ] ) and  ( [ eq:66 ] ) .",
    "it is therefore the only contribution that we shall retain to evaluate the lindblad torque at locations where the disk profiles are not power laws , so that our tentative generalized differential lindblad torque reads : @xmath177 which should be put in contrast with eq .",
    "( [ eq:10 ] ) .",
    "( [ eq:67 ] ) raises the question of whether one should push the expansion further so as to include higher order derivatives .",
    "this question can be circumvented in a manner that is exposed in the next section .",
    "we now consider a disk model in which the surface density is a power law of radius ( @xmath178 ) , but the sound speed ( hence the temperature ) exhibits a more complex radial dependence given by : @xmath179\\omega_k(r)r,\\ ] ] where @xmath180 , the width of the transition , is given by : @xmath181 and where the disk aspect ratios beyond and prior to the transition are respectively : @xmath182 in eqs .",
    "( [ eq:69 ] ) and  ( [ eq:70 ] ) the fiducial aspect ratio @xmath183 was chosen to be @xmath184 .",
    "the parameters above determine a sound speed jump of @xmath185  % over a scale length @xmath186 , corresponding to a temperature jump of @xmath187  % .",
    "we note that the dust rosseland opacity @xmath188 can exhibit discontinuities of as much as a factor of two as a function of temperature .",
    "since the mid plane temperature ( which matters for torque calculations ) scales with @xmath189 , where @xmath190 is the effective disk temperature , which has a smooth profile imposed by the accretion rate @xcite , we can expect jumps of the mid plane temperature of as much as @xmath191 .",
    "we therefore regard our simplified disk model as a _",
    "bona fide _ representation of disk properties at an opacity transition , albeit somehow extreme .",
    "figure  [ fig : ot1 ] shows the results of numerical simulations , in which we sample the transition opacity with 51 different runs .",
    "the run number @xmath192 ( @xmath193 $ ] ) considers a planet of mass @xmath67 , orbiting on a fixed circular orbit of radius @xmath194r_t$ ] .    ) and the dash - dotted line shows the results of eq .",
    "( [ eq:67 ] ) .",
    "the dotted line shows the result of eq .",
    "( [ eq:79 ] ) ]    we note on this figure that the lindblad torque displays a negative peak at the opacity transition , whereas the prediction of the standard formula for power law disks exhibits a positive peak ( as a straightforward consequence of the decrease of @xmath27 at the transition ) . finally , eq .  ( [ eq:67 ] )",
    "does reproduce a negative peak , as expected , but with an exaggerated amplitude .",
    "the origin of the discrepancy can be traced back to the conditions under which eq .",
    "( [ eq:67 ] ) apply .",
    "when deriving this equation we assume that the third derivative of the temperature profile is constant over the whole region of tidal interaction between the planet and the disk , that is at least over @xmath195 $ ] .",
    "this is not the case of the present model , in which the transition occurs on a short spatial scale of order @xmath196 .",
    "it is therefore more accurate to keep the local values of the first and second order derivatives at the outer and inner wake , in eq .",
    "( [ eq:28 ] ) , which is therefore recast as : @xmath197,\\ ] ] where @xmath198 denotes the sound speed at the orbit , and where the superscript @xmath199 means that the value must be taken either at the outer wake ( @xmath200 ) or at the inner wake ( @xmath201 ) , and where the @xmath202 superscript means that the value must be taken at the planetary orbit .",
    "we have made use in eq .",
    "( [ eq:71 ] ) of the approximate equalities : @xmath203    as previously , we leave the exact location at which these values are to be evaluated as a function of a free dimensionless parameter @xmath76 , so that variables relative to the outer ( inner ) wake are to be taken at @xmath204 ( @xmath205 ) .    using eq .",
    "( [ eq:36 ] ) , we have : @xmath206 where the shift of the outer wake @xmath207 and that of the inner wake @xmath208 , using eq .",
    "( [ eq:71 ] ) , are given respectively by : @xmath209\\\\    \\label{eq:75 }    \\delta x_i&=&-\\frac{h^2}{3r}\\left[\\frac{\\beta_2 ^ -}{u}+(\\beta_1 ^ --\\beta_1^c)\\right],\\end{aligned}\\ ] ] so that the total variation of the lindblad torque amounts to : @xmath210.\\ ] ] we note that both terms in the bracket of eq .",
    "( [ eq:76 ] ) stand for finite difference approximations of the third derivative of the temperature , as : @xmath211 performing this substitution , we would be led to an equation similar to eq .",
    "( [ eq:45 ] ) .",
    "as pointed out above , however , we prefer to keep the actual values on either side of the orbit , for @xmath111 itself may vary significantly over the region of excitation of the wake .",
    "we note that the coefficient of @xmath212 , not surprisingly , is of the order of magnitude of the negative of the coefficient of @xmath27 in the standard torque formula .",
    "the last term of eq .",
    "( [ eq:76 ] ) therefore amounts to substituting , in the standard torque formula , the value of @xmath212 by the average of @xmath213 and @xmath214 .",
    "this is rather intuitive , as it is the pressure gradient at these locations that shifts the resonances . in a power law disk ,",
    "these three values are equal and the standard formula applies , but if there is a non vanishing third derivative of the temperature , @xmath215 may differ from @xmath212 .",
    "this effect , nonetheless , has only the consequence that it smears slightly the positive peak of fig .",
    "[ fig : ot1 ] .",
    "most of the effect is actually due to the first term in the bracket of eq .",
    "( [ eq:76 ] ) , which comes from the second order derivative of the pressure , that contributes to change the epicyclic frequency and yields most of the resonance shift .",
    "since the third derivative of the temperature is not constant over the torqued region , the relative shift of the resonances with different values of @xmath60 differs from the case of section  [ sec : case - non - vanishing ] , with the consequence that the coefficient of the dependence on the values of @xmath216 may differ , so that we leave it as a free parameter in our final fit .    incorporating these two changes into eq .",
    "( [ eq:10 ] ) , we eventually obtain the following lindblad torque expression : @xmath217\\gamma_{\\rm ref},\\ ] ] where we remind that a quantity with a @xmath200 ( @xmath201 ) exponent must be evaluated at @xmath218 ( @xmath219 ) , and where @xmath76 is a free dimensionless coefficient that we adjusted to get the best agreement with numerical simulations .",
    "we find that we get the best agreement for @xmath220 , and in that case the coefficient of @xmath221 must be @xmath222 .",
    "we remind that @xmath93 is defined in eq .",
    "( [ eq:7 ] ) .",
    "the results of eq .",
    "( [ eq:79 ] ) are displayed in fig .",
    "[ fig : ot1 ] .",
    "they show a good agreement with the lindblad torque inferred from the numerical simulations .",
    "some comments are in order about the relevance of the fit given at eq .",
    "( [ eq:79 ] ) :    * in the case in which the third order derivative of the temperature ( @xmath111 ) vanishes over the torqued region , and therefore in particular in power law disks , eq .",
    "( [ eq:79 ] ) reduces to the standard formula of eq .",
    "( [ eq:10 ] ) , since in that case @xmath223 , and @xmath224 .",
    "( [ eq:79 ] ) can therefore be used everywhere in the disk . * as the planet moves radially and samples different locations of the opacity transition , the relative shift of the resonances with different values of @xmath60 varies , so that a relationship such as the one proposed can only be approximate .",
    "we therefore seek agreement where the effect is strongest , that is at the nominal position @xmath225 of the transition , where the peak of the lindblad torque is observed .",
    "* we shall see in section  [ sec : total - torque - at ] that the expression proposed satisfactorily accounts for the torque measured for transitions of different widths , and that the strength of the effect scales the inverse cube of the width .",
    "transitions significantly more narrow than those contemplated here are rayleigh unstable @xcite , whereas the effect will be negligible in transitions significantly wider .",
    "( [ eq:79 ] ) constitutes therefore an acceptable description of the effect for all situations in which it is measurable .",
    "* contrary to what has been done with the temperature slopes , the surface density slope coefficient is left unchanged .",
    "there are several reasons for this : ( i ) the coefficient of @xmath22 is small , hence no measurable change is expected if one replaces its value with the average of its values at the outer and inner wake ; ( ii ) we have seen in section  [ sec : case - non - vanishing-1 ] that the additional effect of surface density weighting of the torque tends to cancel out the effect of the resonance shifts , hence we do not write a term in @xmath226 , similar to that in @xmath227 , since that term would have a small coefficient , and ( iii ) at an opacity transition , no significant effect is expected for the surface density , counter to the temperature . *",
    "the changes with respect to the standard formula consists in : ( i ) an evaluation of the shift of the resonances using the slope at the wake location itself , rather than at the orbit ( this corresponds to the term in @xmath228 and it is a small effect ) , and ( ii ) an evaluation of the change of the epicyclic frequency itself , the value of which defines the location of lindblad resonances ( this corresponds to the term in @xmath221 , and it is the most important effect ) . from eq .",
    "( [ eq:20 ] ) , we see that the derivative of the temperature to second order suffices to evaluate the change in the epicyclic frequency , and no further expansion is needed , provided the derivatives are evaluated at a location intermediate between the orbit and the wake , rather than at the orbit .      ) .",
    "we recover the behavior found from numerical simulations at fig .",
    "[ fig : ot1 ] , namely that the actual profile is wider , and displays a reversed peak at the top .",
    "the dashed line of the main plot is essentially the difference between these two curves . ]",
    "we show in fig .",
    "[ fig : compcav ] the difference between the actual torque value and the value inferred from standard torque estimates , both numerical simulations and for fully analytic estimates . differently said ,",
    "this differences assesses the magnitude of the effect of higher order terms of the temperature profile .",
    "although the global shape of the curve of the fully analytic expression is broadly similar to that obtained from simulations , it displays a larger amplitude , which is consistent with the fact that the standard torque expression obtained by summing torque estimates on all resonances , given by eq .",
    "( [ eq:12 ] ) , has a larger coefficient for @xmath27 than the standard torque expression given by numerical calculations , given at eq .",
    "( [ eq:10 ] ) .",
    "we had noted in section  [ sec : case - non - vanishing ] the excellent agreement between the linear estimate and numerical simulations for the dependence of the torque on @xmath111 .",
    "our tentative explanation was that the effect was primarily due to relatively low order resonances , which had larger shifts . here ,",
    "the resonances that are most shifted are the ones which lie the closest to the orbit , _ i.e. _ those of higher order .",
    "we now contemplate the other torque component , namely the corotation torque , which has been thus far omitted .",
    "we examine here the vortensity related corotation torque , in the linear limit .",
    "we therefore focus on the indirect effects of the temperature profile : it alters the rotation profile and therefore the vorticity profile , hence the vortensity gradient .",
    "we wish to evaluate the dimensionless coefficient @xmath229 since the profile of @xmath230 is a power law , we focus on the part related to the vorticity @xmath12 , given by eq .",
    "( [ eq:2 ] ) .",
    "we use eq .",
    "( [ eq:18 ] ) , and we keep only the derivatives of the sound speed , which varies over the length scale @xmath231 , whereas other quantities vary over @xmath34 .",
    "this yields : @xmath232 considering that @xmath233 everywhere in the disk , we are led to : @xmath234 eq .",
    "( [ eq:82 ] ) is an approximate relationship that holds wherever there is a significant peak of @xmath111 in the disk . in the power law parts of the disk",
    ", we have @xmath235 .",
    "we can deduce the corotation torque at the transition using eqs .",
    "( [ eq:14 ] ) and  ( [ eq:82 ] ) .",
    "this gives : @xmath236 notwithstanding its standard dependency in @xmath27 , the corotation torque should therefore display a boost opposite to that of the lindblad torque at an opacity transition , as we can see by comparing eqs .",
    "( [ eq:83 ] ) and  ( [ eq:46 ] ) .",
    "although it may seem at first glance that the balance is in favor of the lindblad torque , such is not the case for the following reasons :    * the previous section has shown that the peak of lindblad torque observed at the transition was less than that predicted by eq .",
    "( [ eq:46 ] ) .",
    "this was understood as being due to the fact that the third derivative is not uniform over the torqued region . * in contrast , it is the third derivative of the temperature _ at the orbit _ that gives the corotation torque . * in addition to this , we remind that the torque value in these two dimensional calculations is very smoothing dependent . the value of the smoothing adopted here ( @xmath237 ) is adapted to the lindblad torque , in the sense that it provides a one - sided lindblad torque of the order of that in a three - dimensional disk @xcite",
    ". however , this value of the smoothing tends to underestimate the corotation torque , for which a smoothing length of @xmath238 should rather be used ( casoli & masset , in prep . ) * finally , the corotation torque , depending on the planet mass , on the disk thickness and on the amount of viscous diffusion , eventually remains linear at all times , or settles into the so - called horseshoe regime .",
    "the horseshoe drag bears same dependencies on the disk parameters as the linear corotation torque , but it has a larger value @xcite . only for very small values of the disk s effective viscosity does the horseshoe drag enter a so - called saturated regime , so that the total torque essentially amounts to the differential lindblad torque @xcite .",
    "we present the total torque at the opacity transition in fig .",
    "[ fig : totq14 ] . results are presented for two transitions : the same as the one contemplated in previous paragraphs , defined by eqs .",
    "( [ eq:68 ] ) to  ( [ eq:70 ] ) , which has a width @xmath239 , and a more narrow one ( @xmath240 ) , which is nevertheless still largely rayleigh stable @xcite .",
    "the solid curves with diamonds show the results directly obtained from numerical simulations ( each diamond stands for a different run ) .",
    "the dotted lines show the expectations of the standard total linear torque expression of eq .",
    "( [ eq:11 ] ) , and the dot - dashed lines show the sum of eqs .",
    "( [ eq:10 ] ) and ( [ eq:14 ] ) , that is the standard total torque expression , except that we use the proper value of @xmath54 instead of @xmath55 . finally , the dashed lines show the sum of eqs .",
    "( [ eq:14 ] ) and  ( [ eq:79 ] ) .",
    "we see that the standard torque formula fails at reproducing the strong peak of the total torque . even in the narrow case",
    ", it does not predict the observed torque reversal . on the contrary , the mere addition of eqs .",
    "( [ eq:10 ] ) and ( [ eq:14 ] ) overshoots the real torque , essentially because it disregards the lindblad torque sensitivity on higher order derivatives of the temperature .",
    "finally , the dashed lines , that corresponds to the sum of the proper expressions of the lindblad and corotation torque , are in excellent agreement with the torque measurements .",
    "they correctly predict the occurrence of torque reversal , and the magnitude of the peak at the transition .",
    "we also note the steep dependence of the peak on the transition width @xmath241 .",
    "the peak value scales indeed with @xmath111 , which is proportional to @xmath242 .",
    "we have seen that both the lindblad torque and the corotation torque have a dependency on the third derivative of the temperature , with opposite signs .",
    "the balance is in favor of the corotation torque , which , even in the linear regime , could be enough to stall migration at opacity transition , provided the transition is sufficiently narrow ( we comment that our calculations , which exhibit such stalling , are conservative in the sense that they underestimate the corotation torque by the use of a large softening of the potential ) . early work on this kind of traps ( see * ? ? ? * at section 5 ) did not evidence this possibility of stalling , essentially because the transition was too large ( @xmath243 ) and the potential softening value even larger ( @xmath244 ) .    in the general case , one should take proper care of the value of the corotation torque by incorporating possible non - linear effects , namely the horseshoe drag regime and its partially saturated state .",
    "details about this kind of procedure can be found in @xcite .",
    "a result similar to the one presented above is expected to hold for three dimensional disks .",
    "namely , the two effects exhibited in section  [ sec : torque - behavior - at ] should be introduced in the same manner as for two dimensional disks :    * the temperature gradient at the orbit should be replaced by its average at the outer and inner wakes . * a term in @xmath221 should be added .",
    "we remarked in section  [ sec : case - non - vanishing ] that the one sided lindblad torque has same value for three dimensional disks and for the two dimensional disks that we considered . since the effect arising from the change of epicyclic frequency is a cumulative effect ( it has same sign for the inner and outer torques ) that scales with the one - sided lindblad torque , we expect the coefficient of this term to be the same as in our two dimensional disks , that is to say @xmath245 .",
    "still , a standard lindblad torque formula in three dimensional disks has not been worked out yet .",
    "the work of @xcite is limited exclusively to globally isothermal disks .",
    "the calibration exposed in appendix  [ sec : calibr - lindbl - torq ] is hardly achievable in three dimensional calculations . in particular",
    ", one can not resort to nested meshes centered on the planet , as the low resolution in the parts of the horseshoe region that lie far from the planet would act as a source of diffusion , which would impede a full saturation of the corotation torque .",
    "the tentative lindblad torque formula given by @xcite at eq .",
    "( 160 ) was based upon three dimensional calculations in the linear regime for which the total torque exhibited a dependency in @xmath246 , and the same dependency was assumed for the lindblad torque by ignoring a possible dependency of the linear corotation torque on @xmath27 .",
    "the present work stresses that the linear corotation torque has a dependency far from negligible on the temperature gradient .",
    "work is in progress to assess this dependence in three dimensional disks ( casoli & masset , in prep . ) .",
    "it is likely that the lindblad torque has also in that case a steep dependence on @xmath27 @xcite .",
    "we stress that our additional term is given in order of magnitude only , but it is straightforward to apply , and it yields a value quite close to that obtained from numerics in the regions of the disk where the profiles can not be approximated by power laws .      in their analysis of the migration of low - mass protoplanets near opacity transitions",
    ", @xcite found a very strong slowing down of migration , corresponding almost to a cancellation of the lindblad torque at some locations in the disk . on the contrary , we find here a relatively mild effect on the lindblad torque , even though we have considered a rather extreme opacity transition , both in terms of narrowness and temperature jump , and even though we consider a smaller softening length of the potential than @xcite . in order to understand the reason for this discrepancy , we have tried to reproduce the results of @xcite for power law profiles and with a softening length of the potential equal to @xmath231 .",
    "these results were subsequently recast by @xcite , in their eq .",
    "( 8) , as : @xmath247 the most striking feature of this expression is the small value of its constant coefficient ( @xmath248 ) .",
    "this makes the torque value prone to cancellation even for moderate values of @xmath22 or @xmath27 . using our analytic approach detailed in appendix  [ sec : fully - analyt - torq ]",
    ", we obtain @xmath249 which differs substantially from eq .",
    "( [ eq:84 ] ) .",
    "there are some differences in the approach of @xcite which may account for this difference :    * they use a softening length equal to the disk thickness at the location of the resonance , rather than at the location of the planet . *",
    "they use the adiabatic sound speed in all terms related to non - axisymmetric disturbances ( it is however unclear whether they do use it : their figure  2 shows a virtually perfect agreement with the results of @xcite , when they normalize the torque to the same quantity , related to the isothermal sound speed   their equations  ( 15 ) and  ( 20 )   ; one would expect the torque value to be reduced by a factor of @xmath250   the ratio of the specific heats   if the adiabatic sound speed were used ) .",
    "if we incorporate these changes into our analytic approach , we are left with the following torque expression : @xmath251 we have tried other combinations ( e.g. , using a radially varying smoothing length and using the isothermal sound speed ) , but none of them has yielded results close to eq .",
    "( [ eq:84 ] ) . in all cases",
    "the constant term remains of order @xmath252 .",
    "the reasons for this discrepancy are unknown .",
    "their approach differs in that they use a continuous torque density , which may have a lower accuracy for the relatively thick disk ( @xmath253 ) that they consider , and for the large value of the potential softening length , as only relatively low order resonances contribute to the torque in that case . in the same vein",
    ", the transformation of the laplace coefficients to modified bessel functions of the second kind may further degrade the accuracy , but none of these explanation sounds plausible at accounting for the large difference between eq .",
    "( [ eq:84 ] ) and eq .",
    "( [ eq:86 ] ) .",
    "we believe that the huge effects that they get at opacity transitions are linked to the smallness of the constant coefficient in eq .",
    "( [ eq:84 ] ) .",
    "our results , both from numerical simulations and from analytic estimates , are quite different : we find that the effects of opacity transitions ( even extreme ones ) on the lindblad torque can not reduce it by more than a factor of about @xmath252 .",
    "however , the total torque can still be reverted at these locations , not by the lindblad torque but by the corotation torque that can undergo a boost originating from the strong departure from keplerianity of the flow at the transition .",
    "we have obtained an expression for lindblad torques , given at eq .",
    "( [ eq:79 ] ) , that generalizes the standard expression of eq .",
    "( [ eq:10 ] ) wherever the disk profiles are not power laws , in particular at opacity transitions .",
    "essentially one additional term plays a role , at locations where the third radial derivative of temperature does not vanish .",
    "the main effect comes from the alteration of the epicyclic frequency , which depends on the flow s vorticity .",
    "the latter differs significantly from its nearly keplerian value wherever the pressure gradient varies over a short length scale .",
    "the resulting variation of the epicyclic frequency shifts the planetary wake and yields a substantial change of the lindblad torque .",
    "our expression has been obtained for locally isothermal disks . in disks",
    "for which an adiabatic expression is better suited for the lindblad torque , the value found here can simply be divided by @xmath250 @xcite , whereas the value of @xmath76 should be multiplied by @xmath254 . the transition from the isothermal value to the smaller adiabatic value , as a function of the thermal diffusivity , is described by @xcite at eqs .",
    "( 154)-(156 ) , by @xcite at eq .",
    "( 10 ) , or by @xcite at eqs .",
    "( 45)-(47 ) .",
    "these three procedures are in broad agreement .",
    "there are side results to this analysis .",
    "firstly , we find evidence from numerical simulations that the linear corotation torque in a locally isothermal disk includes a term that scales with the temperature gradient , and that the dependence is as steep as the dependence on the vortensity gradient , which is an important fact _ per se _ but which has received little attention so far .",
    "secondly , we find that the corotation torque , explicitly neglected in the analysis of @xcite , displays a boost at an opacity transition , because there the vortensity gradient significantly differs from its keplerian value @xmath55 . this boost may be sufficient to halt migration at opacity transitions .",
    "an extremum of vortensity is nonetheless unstable to a rossby wave instability @xcite , and viscous diffusion , either laminar or turbulent , acts at spreading radially narrow vortensity features . as this",
    "was not our primary goal , these effects and their interplay with migration have been disregarded in this work .",
    "the present analysis also disregards any adiabatic effects on the corotation torque .",
    "should the flow behave nearly adiabatically on the time scale of horse shoe u - turns , the additional entropy related corotation torque should be taken into account .",
    "i thank steven lubow for pointing me out that the linear corotation torque could depend on the temperature gradient .",
    "for the lindblad torque calibration we perform long term inviscid calculations in which we let the horseshoe drag saturate , so that the asymptotic torque value is considered as a good approximation to the linear lindblad torque ( see section  [ sec : relev - numer - simul ] ) . in order to obtain the coefficients",
    "@xmath39 to @xmath41 of eq .",
    "( [ eq:8 ] ) for our disks , and similar coefficient @xmath255 to @xmath256 for the total torque we have run four different calculations , in power law disks .",
    "three calculations should be sufficient , but we have run a fourth one as a control to get some confidence that the lindblad torque can indeed take the form given by eq .",
    "( [ eq:8 ] ) .",
    "our calculations were carried out for a disk with @xmath257 and a planetary mass @xmath67 .",
    "the mesh extends from @xmath258 to @xmath259 , while its resolution is @xmath260 and @xmath261 .",
    "this resolution is meant to give the same cell size as in the calculations of section  [ sec : indiv - effects - high ] , but with mesh boundaries which lie further from the orbit .",
    "the horseshoe zone is therefore covered by approximately @xmath262 cells radially .",
    "the dimensionless parameter that controls the non - linearity of the flow is @xmath263 .",
    "in addition , a time average from  @xmath264 to  @xmath66 orbital periods only of the total torque gives an estimate of the linear torque value in each case .",
    "we comment that over this time frame the torque can still be considered as linear .",
    "indeed , the characteristic timescale for the onset of non - linear effects is the horseshoe libration time , multiplied by twice the disk aspect ratio @xcite , which can be cast as : @xmath265 a timescale which can be identified with the time it takes to execute a horseshoe u - turn @xcite .",
    "@xcite mention that the linear results are valid at very early time ( about two orbits ) for their fiducial calculation with @xmath37 . for our value of @xmath266 , it should be valid over approximately up to @xmath267  orbits , while the establishment of the horse shoe drag regime takes about @xmath268  orbits in our case .",
    "the results of one of the runs are represented in fig .",
    "[ fig : lctcalib ] , in which one sees the three stages of the torque : ( i ) linear stage , at very early times , up to a few orbits , ( ii ) unsaturated horseshoe drag , reached after around 30 orbits , and maintained up to about 120 orbits , and ( iii ) the saturation phase , in which the torque oscillates about the linear lindblad torque , which constitutes its asymptotic value at time larger than @xmath269 orbits .",
    "-axis ) , and over a short time scale to expose the transition ( see * ? ? ?",
    "* ) from the linear corotation torque to the non - linear , horseshoe drag regime ( grey curve , upper @xmath270-axis ) .",
    "the light grey stripe on the left corresponds to the temporal window @xmath271  orbits , over which the torque is averaged , and which yields an estimate of the lindblad torque plus linear corotation torque , represented by the dotted line . ]",
    "the torque values , normalized to the reference value of eq .",
    "( [ eq:9 ] ) , are presented in tab .",
    "[ tab : sdkfj ]",
    ".    .normalized lindblad torque ( at larger time ) and total linear torque ( averaged between @xmath65 and @xmath66  orbital periods ) for the four calibration runs.[tab : sdkfj ] [ cols=\"^,^,^,^\",options=\"header \" , ]     this data yields an over - constrained system of six unknowns ( @xmath272 , @xmath273 , @xmath274 , @xmath275 , @xmath276 , @xmath277 ) and eight relations .",
    "we add a constraint , namely @xmath278 , to ensure that the corotation torque scales exactly with @xmath279 in power law disks ( while we leave its dependence on the temperature gradient as a free parameter ) , as we need to recast it in terms of the vortensity gradient , which differs substantially from @xmath279 when higher order derivatives of the surface density or temperature do not vanish .",
    "we note that the linear corotation torque , obtained from the semi - analytic work of @xcite , scales indeed exactly as @xmath279 in power law , two dimensional disks . from this data",
    "we infer the linear regressions given in eqs .",
    "( [ eq:10 ] ) and ( [ eq:11 ] ) .",
    "we note that if we do not impose the constraint given above , we are led respectively to : @xmath280 and @xmath281 in stead of eqs .",
    "( [ eq:10 ] ) and  ( [ eq:11 ] ) .",
    "the comparison gives an idea of the fitting error , as does the first line of tab .",
    "[ tab : sdkfj ] .",
    "since there is no vortensity gradient and the disk is globally isothermal , both torque values in this row should coincide .",
    "sources of inaccuracies may include :    1 .",
    "the narrowness of the time frame over which we average the torque to get the total linear torque ( but taking a larger time frame would raise the issue of the corotation torque beginning to be non - linear in the presence of a vortensity or temperature gradient ) ; 2 .",
    "numerical diffusion of the vortensity within the horseshoe region , which may act as a physical viscosity and may leave a tiny corotation torque at larger time ( almost fully saturated , but not quite ) ; 3 .",
    "partial reflection of the wake on the mesh boundaries , which is present at larger time , but not at earlier time when the linear total torque is evaluated .",
    "as non - reflecting boundary conditions are implemented in fargo , the amount of reflection should be small .",
    "our method for estimating the lindblad torque for each azimuthal component of the planetary forcing potential is essentially based upon that of @xcite , with two amendments described below .",
    "the lindblad torque at a lindblad resonance of @xmath60th order is given by @xmath282 where @xmath50 and @xmath283 are defined respectively at eqs .",
    "( [ eq:15 ] ) and  ( [ eq:16 ] ) , and where @xmath284 with @xmath285 , where the epicyclic frequency @xmath286 is defined at eq .",
    "( [ eq:19 ] ) , and where @xmath287/\\omega(r)$ ] . unlike @xcite , and following @xcite , we have incorporated to eq .",
    "( [ eq:91 ] ) the ratio @xmath145 .",
    "the latter turns out to be unimportant in disks with power law profiles , but it is crucial to include it in disks with abrupt changes , where the epicyclic frequency may significantly differ from its nearly keplerian value .",
    "our second modification with respect to ward s formulation is that we include the potential softening length in the evaluation of the amplitude of the @xmath60th order fourier component of the disturbing function : @xmath288 where @xmath289 the form of eq .",
    "( [ eq:91 ] ) , together with the definition of @xmath50 and the definition of the forcing function of eq .",
    "( [ eq:93 ] ) , determines how the torque behaves in the limit of high order resonances , and therefore incorporates the torque cut - off . in the particular case of power law disks , using our fiducial smoothing length @xmath46 , we find @xmath290 for larger @xmath60 . in eq .",
    "( [ eq:93 ] ) , the value of the softening length @xmath291 is fixed , and it is thus the same for all lindblad resonances .",
    "this is consistent with the formulation of @xcite and @xcite ( see in particular eq .",
    "( 3 ) of the former ) .",
    "this also corresponds to the standard implementation of the fargo code , in which the material in each zone of the computational domain is acted upon by the planetary potential , which has a given smoothing length , and reacts back on the latter through a potential which has the same smoothing length , so as to approximately ensure the fulfillment of the action and reaction law .",
    "this is in contrast with the formulation of @xcite , who adopt a smoothing length that vary with @xmath34 ( more precisely their smoothing length is the vertical scale height of the disk at the location of the resonance ) .",
    "we further comment that we do not reduce the expression of the laplace coefficients ( modified by the presence of the smoothing ) to expressions involving modified bessel functions of the second kind , as is a standard practice .",
    "we rather evaluate directly the integral of eq .",
    "( [ eq:93 ] ) at each resonance , as well as its radial derivative .",
    "also , we do not use the convenient device consisting in working out a torque density , which converts a discrete problem into a continuous one ( e.g. * ? ? ?",
    "rather , we evaluate @xmath292 at each resonance , the location of which is formerly determined using a newton - ralphson method .    in fig .",
    "[ fig : comp ] we present our results for disks with power law profiles already studied in the literature in order to assess the correctness of our implementation .",
    "we also display on these graphs the differential lindblad torque that we obtain with our fiducial smoothing length .",
    "-axis , the torque is normalized to @xmath293 , whereas on the right @xmath294-axis it is normalized to the reference value given by eq .",
    "( [ eq:9 ] ) .",
    "both values differ by a factor @xmath295 .",
    "the latter normalization is to be preferred , for it renders the differential lindblad torque independent of the disk aspect ratio , if the disk is sufficiently thin .",
    "these plots should be compared to those of @xcite ( fig .",
    "3 ) or those of @xcite ( fig .",
    "2 ) . the dotted line shows the differential lindblad torque for a smoothing length @xmath46 . ]",
    "we evaluate here how the one - sided torque varies as the wake recedes or approaches the planet .",
    "we do this by means of numerical simulations in which we maintain the planet on a fixed , uniform and circular orbit , but we vary its orbital frequency from run to run . doing so shifts the wake in a known amount",
    "we measure independently the inner and outer lindblad torques , and we translate the planet s frequency offset @xmath296 into a wake shift @xmath297 .",
    "the results are presented in fig .",
    "[ fig : ost_dist ] . not surprisingly , the dependence is essentially similar for inner and outer torques .",
    "we infer from these calculations that : @xmath298 from the slopes measured in @xmath299 .",
    "the distance to the wake @xmath300 is assumed to be @xmath231 ( see _ e.g. _ the torque density distribution in * ? ? ?",
    "* ) .",
    "fs ( 2000 ) fargo : a fast eulerian transport algorithm for differentially rotating disks . in : garzn g , eiroa c , de winter d , mahoney tj ( eds ) disks , planetesimals , and planets , astronomical society of the pacific conference series , vol 219 , pp 75+"
  ],
  "abstract_text": [
    "<S> we give an expression for the lindblad torque acting on a low - mass planet embedded in a protoplanetary disk that is valid even at locations where the surface density or temperature profile can not be approximated by a power law , such as an opacity transition . at such locations , </S>",
    "<S> the lindblad torque is known to suffer strong deviation from its standard value , with potentially important implications for type  i migration , but the full treatment of the tidal interaction is cumbersome and not well suited to models of planetary population synthesis . the expression that we propose retains the simplicity of the standard lindblad torque formula and gives results that accurately reproduce those of numerical simulations , even at locations where the disk temperature undergoes abrupt changes . </S>",
    "<S> our study is conducted by means of customized numerical simulations in the low - mass regime , in locally isothermal disks , and compared to linear torque estimates obtained by summing fully analytic torque estimates at each lindblad resonance . </S>",
    "<S> the functional dependence of our modified lindblad torque expression is suggested by an estimate of the shift of the lindblad resonances that mostly contribute to the torque , in a disk with sharp gradients of temperature or surface density , while the numerical coefficients of the new terms are adjusted to seek agreement with numerics . as side results </S>",
    "<S> , we find that the vortensity related corotation torque undergoes a boost at an opacity transition that can counteract migration , and we find evidence from numerical simulations that the linear corotation torque has a non - negligible dependency upon the temperature gradient , in a locally isothermal disk . </S>"
  ]
}