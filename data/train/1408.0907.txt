{
  "article_text": [
    "epidemic compartment models provide a simple and useful mathematical description of the mechanisms behind disease transmission between individuals , in which only the most prominent ingredients are included @xcite .",
    "one of the most celebrated of these models , susceptible - infected - recovered ( sir)@xcite , describes diseases in which the person contracting the disease becomes immune to future infections after recovery , such as measles , rubella , chicken pox and generic influenza .",
    "the same model can be applied to lethal diseases , such as hiv or ebola , provided that the recovered state is replaced by a removed state .",
    "being simple and mathematically appealing , models such as sir can be employed to study under which conditions and with which consequences large epidemic outbreaks can occur . for most examples of infective diseases",
    ", contagion runs over a network of effective contacts between individuals .",
    "these contact networks have been inaccessible for decades , but thanks to recent advances in technology miniaturization ( e.g. by means of rfid - endowed badges to signal the proximity between individuals ) and the popularization of the internet ( e.g. for the construction of databases of self - reported interactions ) , at least in simple and controlled scenarios the interaction patterns of individual contacts can be almost entirely reconstructed @xcite .",
    "modern computational epidemiology can thus rely on accurate data and on powerful computers to run large - scale simulations of stochastic compartment models on real contact networks @xcite .",
    "in addition to epidemic forecast and control , a problem that has gained attention in recent years is the one of reconstructing the history of an epidemic outbreak @xcite , as e.g. the path of contagion to a specific infected individual . in particular",
    ", identifying the origin ( or the set of _ seeds _ or _ sources _ ) of an epidemic outbreak in the general case is an open problem , even assuming simple discrete - time stochastic epidemic models , such as the si and sir model .",
    "the reason becomes clear when the inference is formulated as a maximum likelihood estimation problem .",
    "estimating the maximum of a properly defined likelihood function corresponds to solve a ( generally non - convex ) optimization problem in the space of all possible epidemic propagations that are compatible with the data . for propagations with a unique source on regular trees ,",
    "a maximum likelihood estimator was proposed by shah and zaman @xcite under the name of rumor centrality ( see also @xcite ) and extended to probabilistic observations in ref .",
    "@xcite . for a specific continuous - time epidemic process",
    ", an optimal estimator on general trees was put forward by pinto et al .",
    "@xcite . on general graphs",
    ", the number of propagation paths grows exponentially with the number of nodes making the exact inference unfeasible in practice .",
    "instead of evaluating the likelihood function , zhu and ying put forward a method to select the path that most likely leads to the observed snapshot @xcite . for general graphs ,",
    "other heuristic inference methods are based on centrality measures @xcite , on the distance between observed data and typical outcome of propagations for given initial conditions @xcite or on the assumption that the epidemic propagation follows a breadth - first search tree @xcite .",
    "even fewer results exist for epidemic inference with multiple sources @xcite .",
    "a message - passing approach for the computation of epidemic dynamics was first introduced by karrer and newman @xcite and applied to source detection in ref .",
    "@xcite , with a further mean - field approximation of the likelihood function .",
    "recently , a belief propagation ( bp ) approach was proposed for the bayesian inference of the origin of an epidemics @xcite .",
    "the main idea is that of exploiting a graphical model representation of the stochastic dynamics of the si and sir models to devise an efficient message - passing algorithm for the evaluation of the posterior distribution of the epidemic sources .",
    "the bp approach is exact on trees and it works very well also on general graphs , outperforming other methods on many graph topologies , in the presence of one or more sources , and also when observations are by large extent incomplete . in this work , we build on the bp approach by studying a harder variant of the inference problem in which either ( a ) it is not possible to distinguish between recovered or susceptible individuals or ( b ) the observation is noisy , i.e. there is a non - zero probability of making an error in the observation of each individual .",
    "the first case was already described in ref .",
    "@xcite using the most likely infection path method on trees and similar heuristics on general graphs .",
    "the second case was not directly faced in the literature , although the problem of determining the causative network of epidemiological data in the presence of false negatives and positives has recently attracted some attention @xcite .",
    "we will show that the bp approach allows for more complete inference , as e.g. ( a ) to infer the epidemic parameters i.e. the probability of transmission in each contact and the distribution of recovery times ; and ( b ) to infer missing data in a partial observation , e.g. correcting errors or finding which of the two states s , r in the confused state setup .    the work is organized as follows .",
    "section 2 provides a detailed description of the graphical model representation of the stochastic epidemic dynamics .",
    "the bp equations of the model and the details of their efficient implementation are discussed in section 3 ( plus appendices ) .",
    "the results of the bayesian inference under different observation models are reported in section 4 . in section 5 ,",
    "we present an efficient on - line method for the inference of the epidemic parameters by maximization of the log - likelihood by gradient ascent in the bethe approximation .",
    "we consider a discrete - time version of the _ susceptible - infected - recovered _",
    "( sir ) model @xcite on a graph @xmath0 that represents the contact network of a set @xmath1 of individuals .",
    "a node @xmath2 can be in one of three possible states : susceptible @xmath3 , infected @xmath4 , and recovered / removed @xmath5 .",
    "the state of node @xmath2 at time @xmath6 is represented by a variable @xmath7 . at each time step",
    "( e.g. a day ) of the stochastic dynamics , an infected node @xmath2 can first spread the disease to each susceptible neighbor @xmath8 with given probability @xmath9 , then recover with probability @xmath10 .",
    "once recovered , individuals do not get sick anymore .",
    "this process is markovian , and satisfies @xmath11 where @xmath12 \\prod_{j\\in\\partial i } ( 1-\\lambda_{ji } \\mathbb{i}[x_j^t = i])\\\\ p(x_i^{t+1}=i|\\mathbf { x}^t ) & = & ( 1-\\mu_i)\\mathbb{i}[x_i^t = i ] + \\mathbb{i}[x_i^t = s ] ( 1-\\prod_{j\\in\\partial i } ( 1-\\lambda_{ji } \\mathbb{i}[x_j^t = i]))\\\\ p(x_i^{t+1}=r|\\mathbf { x}^t ) & = & \\mu_i \\mathbb{i}[x_i^t = i ] + \\mathbb{i}[x_i^t = r].\\end{aligned}\\ ] ]    a realization of the stochastic dynamics is fully specified by knowing for each individual @xmath2 , her _ infection time _ @xmath13 and her _ recovery time _ @xmath14 .",
    "it is easy to show that , for a given initial configuration @xmath15 , a realization of the stochastic process can be generated by drawing randomly the recovery time @xmath16 of each node @xmath2 and an infection _ transmission delay _",
    "@xmath17 from node @xmath2 to node @xmath8 , for all pairs @xmath18 .",
    "the recovery times @xmath19 are independent random variables extracted from geometric distributions @xmath20 , while the delays @xmath21 are also independent random variables distributed according to a truncated geometric distribution , @xmath22 in which for convenience we concentrate in the value @xmath23 the mass of the distribution beyond the hard cut - off @xmath16 imposed by the recovery time .",
    "infection times are related by the deterministic equation @xmath24 which is a constraint encoding the infection dynamics of the sir model .",
    "then individual @xmath2 recovers at time @xmath25 .",
    "the exact mapping from realizations of the epidemic process to realizations of the transmission delays and recovery times can be exploited to provide a graphical model representation of the stochastic dynamics of the sir model on a graph . for a given initial condition ,",
    "the joint probability distribution of infection and recovery times conditioned on the initial state is @xmath26 where @xmath27(\\min_{k\\in\\partial i}(t_{k}+s_{ki})+1))\\ ] ] is a characteristic function which imposes on each node @xmath2 the dynamical constraint .    in the following",
    "we derive a method to reconstruct information about the origin of the epidemics given some observation at later times .",
    "we first need to compute the posterior probability of the initial configuration given an observation at time @xmath28 .",
    "this is done by assuming to have a probabilistic prior on the initially infected nodes and by applying bayes formula ,    @xmath29    where @xmath30 is a factorized prior on the initial infection and where we exploited the fact that the state @xmath31 is a deterministic function of the set of infection and recovery times @xmath32 given by    @xmath33    with    @xmath34 + \\mathbb{i}\\left[x_{i}^{t}=i , t_{i}\\leq t < t_{i}+g_{i}\\right]+\\mathbb{i}\\left[x_{i}^{t}=r , t_{i}+g_{i}\\leq t\\right].\\ ] ]    the above formula can be generalized to the case in which the parameters @xmath35 and @xmath36 have an explicit dependence on @xmath37 .",
    "the problem of computing the marginals from is in general intractable ( np - hard ) and we need to resort to an efficient approximation . here",
    "we choose to implement the bp approximation which preserves some non trivial correlations between variables and is exact in the limit cases in which correlation decay holds .",
    "is not considered.,width=453 ]    we proceed by introducing a factor graph representation of , namely a bipartite graph composed of factor nodes and variable nodes . in the standard definition ,",
    "each variable appearing in the problem is identified by a variable node , while each factorized term of the probability weight in is represented by a factor node .",
    "a factor node is connected to the set of variable nodes appearing in the corresponding factorized term . however , with this definition the factor graph of has a loopy structure both at local and global scale , and this could compromise the accuracy of the bp approximation . the existence of short loops can be easily verified even focusing only on the expression of the dynamical constraint : a pair of variable nodes corresponding to the infection times @xmath38 and @xmath39 of neighboring individuals are indeed involved in the two factors @xmath40 and @xmath41 , inducing a short loop in the factor graph ( see fig.[fg0]a ) .",
    "we would like to use a factor graph representation that maintains the same topological properties of the original graph of contacts , in order to guarantee that bp is exact when the original graph of contacts is a tree . following an approach proposed in @xcite",
    ", the factor graph can be disentangled by grouping pairs of infection times @xmath42 in the same variable node as in fig.[fg0]b . for convenience",
    ", we will keep all variable nodes @xmath43 but we will also introduce for each edge @xmath44 emerging from a node @xmath2 a set of copies @xmath45 of the infection time @xmath38 , that will be forced to take the common value @xmath38 ( see fig.[fg0]c ) by including the constraint @xmath46 in the factor @xmath40 .",
    "we also observe that the factors @xmath47 depend on infection times and transmission delays just through the sums @xmath48 .",
    "it is thus more convenient to introduce the variables @xmath49 and express the dependencies through the pairs @xmath50 .",
    "finally it is convenient to group the variable @xmath51 with the corresponding infection times @xmath38 in the same variable node , replace @xmath51 and @xmath52 by their copies @xmath53 and @xmath54 in the edge constraints @xmath55 and @xmath56 and impose the identity @xmath57 for each node @xmath2 .",
    "we can now define the new factors    @xmath58    and    @xmath59(\\min_{j\\in\\partial i}(t_{ji}+1)))\\prod_{j\\in\\partial i}\\delta(t_{i}^{(j)},t_{i})\\text{\\ensuremath{\\delta}}(g_{i}^{(j)},g_{i } ) \\\\ & = \\phi_{i}(t_{i},\\{{t}_{ji}\\}_{j\\in\\partial i})\\prod_{j\\in\\partial i}\\delta(t_{i}^{(j)},t_{i})\\text{\\ensuremath{\\delta}}(g_{i}^{(j)},g_{i}).\\end{aligned}\\ ] ]        the posterior distribution can be written as    @xmath60    where    @xmath61    figure  [ fg1 ] shows the factor graph representation of the distribution .",
    "the factor node grouping @xmath62 and @xmath63 has in fact a more complex structure that is described in detail in fig.[fg2]a : the function @xmath64 , defined in , connects the infection time @xmath38 with the state @xmath65 of the node at time @xmath6 , @xmath66 is the prior on the initial state , while @xmath67 is the recovery time distribution .",
    "having built a factor graph with the same topology of the original graph , we can now compute the exact posterior marginals for the sir model with bp in the case of tree graphs and obtain a good approximation of it even on graphs that are not trees if the correlation decay assumption is correct .     in fig.[fg1 ] .",
    "( b ) the modified factor graph used to include the observation models discussed in section  [ section - observation].,width=453 ]",
    "belief propagation consists in a set of equations for single - site probability distributions labeled by directed graph edges .",
    "these equations are solved by iteration , and on a fixed point give an approximation for single - site marginals and other quantities of interest like the partition function @xmath68 .",
    "we recall the general form of the bp equations in the following . for a factorized probability measure on @xmath69 , @xmath70 where @xmath71 is",
    "the subvector of variables that @xmath72 depends on , the general form of the equations is @xmath73 where @xmath74 is a _ factor _",
    "( i.e. @xmath75 , @xmath76 , @xmath77 , @xmath78 , @xmath79 or @xmath80 in our case ) , @xmath81 is a variable ( i.e. @xmath82 , @xmath83 , @xmath84 or @xmath85 in our case ) , @xmath86 is the subset of indices of variables in factor @xmath72 and @xmath87 is the subset of factors that depend on @xmath88 .",
    "the terms @xmath89 and @xmath90 are normalization factors that can be calculated once the rest of the right - hand side is computed . while equations - can be always computed efficiently in general , the computation of the trace in may need a time which is exponential in the number of participating variables . the update equations for factors @xmath76 , @xmath77 , @xmath78 , @xmath79 and @xmath80 can be computed in a straightforward way because they involve a very small ( constant ) number of variables each . in appendix  [ appbp ]",
    "we show the derivation of an efficient version of equation for factor @xmath75 that can be computed in linear time in the degree of vertex @xmath2 , and we provide a change of variables that simplifies the messages and further reduces the computation time of the update .",
    "in the inference of the origin of epidemic propagations it is often assumed that the state of every node is known at the observation time @xmath28 with no uncertainty .",
    "this is also the case studied in ref.@xcite , where the bp approach for this problem was first introduced . in practice ,",
    "every clinical test for determining the state of an individual is affected by some amount of error , and this possibility has to be taken into account in the inference problem .",
    "therefore , it is realistic to assume that each observation carries some level of noise . we introduce a general concept of _ observation model _ for the inference problem , that allows dealing with several different cases of incomplete and noisy data using a common notation .",
    "we will assume that the noise level is known ( as it is the case for the majority of clinical tests ) , and introduce a new variable @xmath91 for the observed state of node @xmath2 and an additional evidence term that reflects the probability @xmath92 of the observed state @xmath93 given the true state @xmath94 . in the factor graph , the observed - state variables @xmath93",
    "are fixed to their value given by the experimental observation ( by means of a delta function representing an infinite external field ) , while the true - state variables @xmath95 are traced over in the compatibility function @xmath96 .",
    "more explicitly , the modified factor graph shown in fig .",
    "[ fg2]b , contains a @xmath96 factor node attached to the true - state variable @xmath95 , which is linked to the observed state @xmath93 ( which is a constant ) through the node @xmath97 .",
    "the posterior distribution now takes the form :    @xmath98    where    @xmath99    in what follows , we introduce for convenience a map  @xmath100 from indices @xmath101 into configurations of the @xmath102 variables , such that  @xmath103 , and then define the _ observational transition matrix _ ( _ otm _ ) @xmath104 whose elements are the transition probabilities :    @xmath105    the case in which observations are complete and noiseless corresponds to an identity matrix @xmath106 . in the following sections , we will cover some interesting examples of applications of this scheme to confused and noisy observations .",
    "note that , in this generalized scheme , we can also take into account the case of partial observations , by assuming a totally uniform _ otm _",
    "@xmath107 for unobserved nodes .      in some situations",
    ", it could be hard to distinguish between nodes that already recovered from a disease and nodes that did not contract it at all . to take into account this fact , we follow the approach of ref.@xcite and explore the efficiency of our inference machinery in a setting in which observations on susceptible and recovered nodes are confused .",
    "more specifically , we allow only two types of observed states @xmath108 , where @xmath109 stands for not - infected .",
    "this situation corresponds to choose the following _ otm _ :    @xmath110    we verified the performances of the bp algorithm on a completely uniform setting provided by random regular graphs with identical infection parameters @xmath111 for all nodes and links .",
    "all epidemic propagations were initiated from a unique seed ( the zero patient ) . for each node , the bp algorithm provides an estimate of the posterior probability that the node got infected at a certain time , and thus also the probability that the node was the origin of the epidemics .",
    "we can thus rank the nodes in decreasing order with respect of the estimated probability of being the origin of the observed epidemics : the position of the true origin in the ranking provided by the algorithm is a good measure of the efficacy of the method . in what follows ,",
    "we indicate with @xmath112 the ranking of the true origin of the epidemics , and with @xmath113 the number of nodes in the graph @xmath114 .",
    "an important by - product of the algorithm is the ability to infer the true state of a node from the marginal of the infection time , providing in this way a method to `` correct '' observations .",
    "more precisely , in the present example we consider the problem of discriminating between susceptible and recovered nodes .",
    "an effective method for quantifying the accuracy of such binary classification problem is the _ receiver operating characteristic _ ( _ roc _ ) curve , namely a plot of the  true positive rate \" against the  false positive rate \" .",
    "constructing the _ roc _ curve in the present case is very easy : we select the @xmath109 nodes and rank them on the base of their marginal @xmath115 , we then take one step upward in the _ roc _ whenever a true positive case is encountered ( @xmath116 ) or one step rightward in case of a false positive ( @xmath117 ) .",
    "we performed this discrimination analysis for each sample and then computed the average value of the area under the _ roc _ curve , that gives indication of the fraction of correctly classified nodes .",
    "it turns out that the proposed algorithm can be effectively used as an ex - post - facto tool for discriminating susceptible against recovered individuals .",
    "figure [ fig : rr10_t10_g1_l06_mu1_china ] displays the average rank of the true infected site @xmath112 , normalized to the network size @xmath113 , for a set of @xmath118 simulated epidemic propagations with @xmath119 and @xmath120 on random regular graphs of size @xmath121 and degree @xmath122 ( @xmath123 ) .",
    "the quantities of interest are plot as functions of the normalized epidemic size @xmath124 ( i.e. the fraction of infected or recovered sites ) , whose values are discretized with intervals of width equal to @xmath125 . note that in all the figures we show in the paper , we discarded the rare cases with very low epidemic size ( @xmath126 in fig . 5 , @xmath127 elsewhere ) where the number of infected is extremely low and the inference is practically unfeasible .    for each set of data ,",
    "the symbols report the mean value obtained averaging over the samples belonging to that interval and the error bars indicate the corresponding standard deviation .",
    "the average fraction of infected nodes and the fraction of samples in each bin are reported as a reference .",
    "the normalized average rank of the true origin is very low for all values of the normalized epidemic size , meaning that the algorithm is very effective in identifying the zero - patient .",
    "we also show the average _ roc _ area , which reveals that the inference algorithm allows a very good discrimination between @xmath128 and @xmath129 nodes .",
    "the same analysis for a random graph with power - law degree distribution , obtained using the barabasi - albert model @xcite , is reported in fig.[fig : barab10_t7_g7_l06_mu05_china ] . when the observation time @xmath28 is sufficiently small ( @xmath130 in fig.[fig : barab10_t7_g7_l06_mu05_china ] ) , the performance of the algorithm is high .",
    "when longer observation times are considered , epidemics tend to cover the whole network and convergence issues emerge . in this regime , most of the infected nodes have already recovered at the observation time @xmath28 ( and thus they can not be distinguished anymore from the susceptible ones ) .",
    "this causes a rapid decay of the available information content that explains the performance degradation .",
    "a similar effect arises also on random regular graphs , but at longer times , as we will see in section  [ section - noisy ] .    in summary ,",
    "even when supplied with confused observations , bp shows striking ability to discriminate between recovered and susceptible nodes , provided that there is enough information at the chosen observation time @xmath28 .",
    "average normalized rank of the true zero - patient ( blue solid line ) , average roc area ( red dashed line ) and average fraction of infected nodes @xmath131 ( green dotted line ) as a function of the rescaled epidemic size @xmath132 . the fraction of the @xmath133 samples belonging to each bin of the rescaled epidemic size is also indicated .",
    "the realization of the epidemic process is propagated for @xmath123 steps with @xmath119 and @xmath120 .",
    "observations are confused , i.e. @xmath134 .",
    "simulations were run over @xmath118 samples of random regular graphs with @xmath121 nodes and degree @xmath122 . ]",
    "average normalized rank of the true zero patient ( blue solid line ) , average roc area ( red dashed line ) and average fraction of infected nodes @xmath131 ( green dotted line ) as a function of the rescaled epidemic size @xmath132 . the fraction of the @xmath133 samples belonging to each bin of the rescaled epidemic size is also indicated .",
    "the realization of the epidemic process is propagated up to the time step @xmath130 with @xmath119 and @xmath135 .",
    "observations are confused , i.e. @xmath136 .",
    "simulations were run over @xmath118 samples of barabasi - albert graphs with @xmath121 nodes and average degree @xmath137 . ]",
    "let us now consider a simple type of observational noise .",
    "suppose that a node on state @xmath102 , has probability @xmath138 of being correctly observed in state @xmath102 , and probability @xmath139 of being observed incorrectly in one of the two remaining states , distributed uniformly among the two .",
    "for example , node @xmath2 could be @xmath140 ( infected ) at the observation time @xmath28 , and , for a given noise level @xmath139 , there will be an equal probability @xmath141 for node @xmath2 to be observed in the @xmath129 ( recovered ) or @xmath128 ( susceptible ) state .",
    "this setting corresponds to the following _ otm _ : @xmath142    we simulated a set of @xmath118 single - source epidemic propagations with @xmath119 and @xmath120 on random regular graphs with @xmath121 nodes and degree @xmath122 . in fig .",
    "[ fig : rr_t10_lambda06_g10_mu06_noise ] we show the average rank of the true origin of the epidemics for various levels of the observational noise up to @xmath143 .",
    "the low values of the average rank obtained demonstrate that the bp algorithm is able to perform extremely well up to very high levels of noise .",
    "the corresponding roc curves are plotted in fig .",
    "[ fig : roc_rr_t10_lambda06_g10_mu06_noise ] .",
    "average normalized rank of the true zero patient as a function of epidemic size @xmath132 for various levels of noise @xmath139 in the observation ( the error - bars indicate the standard deviation computed on the sub - sample corresponding to a given epidemic size ) .",
    "each curve refers to @xmath118 samples of random regular graphs with @xmath121 nodes and degree @xmath122 .",
    "epidemics is propagated until @xmath123 with @xmath119 and @xmath120 . ]",
    "average area of the roc curve as a function of epidemic size @xmath132 for various levels of noise @xmath139 in the observation ( the error - bars indicate the standard deviation computed on the sub - sample corresponding to a given epidemic size ) .",
    "each curve refers to @xmath118 samples of random regular graphs with @xmath121 nodes and degree @xmath122 .",
    "epidemics is propagated until @xmath123 with @xmath119 and @xmath120 . ]",
    "we investigated the role of observation time @xmath28 in relation to the amount of information needed for inferring the zero patient : simulations were run for given realizations of the epidemic process and observation time was systematically varied . in fig .",
    "[ fig : on_time_rr_l06_d1 ] we show a representative situation in random graphs ( the picture is similar in scale - free graphs , as we argued in section[section - confused ] ) .",
    "it turns out that the ratio of infected nodes to epidemic size is critical for inference : when observation time is too long so that the majority of infected individuals have recovered , it is much more difficult to find the zero - patient in the noisy and confused case . as it can be seen in the figure , this sharp change of behaviour ( manifested at @xmath144 ) is present even in single instances .",
    "normalized rank of the true zero - patient ( solid lines ) , fraction of infected nodes @xmath131 ( green dotted line ) and rescaled epidemic size @xmath132 ( dotted purple line ) as a function of observation time @xmath28 for a single realization of the epidemic process , propagated with @xmath119 and @xmath120 , on a random regular graph with @xmath121 nodes and degree @xmath122 .",
    "observations are complete ( black solid line , superimposed to x axes ) , confused ( blue solid line ) , and with noise @xmath145 noise level ( red solid line ) .",
    "values of the normalized rank greater than @xmath146 are meaningless : they are the realization of a random variable with average close to 0.5 , and they are evidence that for large @xmath28 the inference algorithm is unable to identify the zero - patient with better precision than pure chance . ]",
    "we have shown that if the parameters of the epidemics are known in advance , our inference method can effectively detect the zero patient .",
    "it is reasonable to assume that , for certain types of diseases , clinical information could dictate some plausible range for the average rates of infection and recovery . in the simplified case in which the infection parameters are uniform among the population",
    ", the bp method can be generalized in a way to infer both the zero patient and the epidemic parameters at the same time .    from our bayesian approach ,",
    "@xmath147 is the log - likelihood of the epidemic parameters for the observation @xmath31 .",
    "indeed , the log  likelihood of the parameters @xmath148 equals @xmath149 and the latter can be computed as @xmath150 in ref .",
    "@xcite , this observation was used to infer the epidemic parameters through an exaustive search in the space of parameters .",
    "this computation can be costly , wasting resources on noninteresting regions of the parameter space .",
    "moreover , this type of experiments shows that the log - likelihood landscape with the bethe approximation is generally very simple , presenting in most cases a single local maximum .",
    "here we describe a different method to infer the parameters together with the source of the epidemic outbreak .",
    "the idea is to perform an on - line log - likelihood maximization through gradient ascent in the bethe approximation of the log - likelihood , by means of the following updates : @xmath151 with @xmath152 a free convergence parameter .",
    "the free energy of the system can be approximated with the bethe free energy , which in turn can be expressed as a sum of local terms depending on bp messages .",
    "a detailed derivation of the expression of the derivatives @xmath153 and @xmath154 of the bethe free energy is reported in appendix  [ appga ] . in principle , the expressions obtained using the bethe free energy are valid only at the bp fixed point , and one should let bp updates converge before making a step of gradient ascent . in practice , we found that it is sufficient to interleave bp and gradient ascent updates in order to obtain equivalent results .",
    "a fixed point of the interleaved updates is both a critical point of the bethe log - likelihood and a bp approximation for the marginals .",
    "we performed extensive simulations with a wide range of parameters and found that , for reasonable fraction of infected nodes at the observation time , the inference can simultaneously identify the zero patient perfectly and find good estimates of the epidemic parameters .",
    "some examples of inferred parameters are shown in fig .",
    "[ fig : rr_t10_g10_inference ] for six different configurations of @xmath111 parameters , with each pair of box plots referring to @xmath118 samples .",
    "the method can be extended to treat the non - uniform case , at the expense of a higher computational effort , that would amount in computing local derivatives of the free - energy function for each edge in the graph with respect to edge - specific parameter .",
    "it should be clear that the number of parameters in the non - uniform case should not grow excessively for inference purposes : we could , nevertheless , account for age or gender - dependent differences in the probability to contract the disease or in the recovery rate with the introduction of additional information , attached to nodes and edges in the network .",
    "notice that , even in this case , an exhaustive search in the parameter space could be computationally too expensive .",
    "the inference of parameters can be performed also in the presence of observational noise . in fig .",
    "[ fig : rr_t10_g10_inference_noise ] we show an example of inference for increasing levels of noise in the observation , as defined in the preceeding section .",
    "also in this case the zero patient is detected with probability @xmath155 and the inferred parameters are good estimators of the true values even up to a significant fraction of noise .    inferred epidemic parameters for six different configurations of true @xmath111 parameters",
    ". forward epidemic is simulated until observation time @xmath123 .",
    "each pair of boxes refers to @xmath118 instances of random regular graphs with @xmath121 nodes and degree @xmath156 .",
    "box edges signal the @xmath157th and @xmath158th percentiles , the central red lines is the median .",
    "whiskers extend to cover @xmath159 of the data for a gaussian distribution .",
    "outliers are marked as red points outside the whiskers . ]    inferred epidemic parameters for different observational noise rates @xmath139 .",
    "forward epidemic is simulated until observation time @xmath123 .",
    "each box refers to @xmath118 instances of random regular graphs with @xmath121 nodes and degree @xmath156 .",
    "box edges signal the @xmath157th and @xmath158th percentiles , the central red lines is the median .",
    "whiskers extend up to cover @xmath159 of the data for a gaussian distribution .",
    "outliers are marked as red points outside the whiskers . ]",
    "we compared the ability of bp to infer the epidemic parameters with a simpler ( though computationally expensive ) procedure that does not require ( nor provide ) the simultaneous inference of the origin .",
    "the idea is to compare the statistical properties of the observation with the one of typical epidemics with given parameters @xmath160 , and choose those @xmath160 that give properties that are closest ( in a sense to be defined ) to the ones observed .",
    "more precisely , for each @xmath161 and @xmath162 , we generate 1000 random epidemics and compute the mean of the number of infected @xmath163 and recovered @xmath164 individuals .",
    "afterwards , given an observation with @xmath140 infected and @xmath129 recovered individuals , we find    @xmath165    we also repeated the procedure using the @xmath166 instead of the mean ( and computing thus @xmath167 and @xmath168 ) . in fig .",
    "[ fig : naive ] we show the distributions of @xmath169 and @xmath170 found by the above procedure based on 200 epidemic realizations with @xmath119 and @xmath135 , along by the same distribution as found by the interleaved bp gradient ascent of the likelihood function .",
    "the results show that the bp - based procedure is able to infer the correct parameter @xmath119 and @xmath171 with much higher accuracy .",
    "comparison of inference of epidemic parameters for @xmath172 random realizations with @xmath119 , @xmath135 between bp and the naive method consisting in finding the couple @xmath173 which is closest in terms of mean ( resp .",
    "median ) number of infected and recovered individuals in euclidean distance .",
    "the distributions for the inference with bp correspond to the fifth example reported in fig.[fig : rr_t10_g10_inference ] and the first in fig.[fig : rr_t10_g10_inference_noise].,title=\"fig : \" ] comparison of inference of epidemic parameters for @xmath172 random realizations with @xmath119 , @xmath135 between bp and the naive method consisting in finding the couple @xmath173 which is closest in terms of mean ( resp .",
    "median ) number of infected and recovered individuals in euclidean distance .",
    "the distributions for the inference with bp correspond to the fifth example reported in fig.[fig : rr_t10_g10_inference ] and the first in fig.[fig : rr_t10_g10_inference_noise].,title=\"fig : \" ]",
    "bp was recently proposed as an efficient tool for the inference of the origins of an epidemic propagation on graphs from a snapshot of the system at a later time . in the present work",
    ", we generalized the analysis to more realistic cases in which observations are imperfect .",
    "experimental results show that bp performs well even in the presence of strong sources of uncertainty , such as observational noise , inability to distinguish between observed states , and uncertainty on the intrinsic model parameter .",
    "we provided an exact solution on acyclic graphs for the first two problems , and a variational solution to compute the gradient of the likelihood of the parameters .",
    "the latter can be employed to find local maxima of the likelihood function .",
    "we also characterized , by means of simulations , the amount of information that can be extracted on random graphs of various types , both on the past origin of the epidemics and on the missing bits on the present - time observation . besides giving an excellent algorithmic answer to these questions , related to the past and the present of an observed epidemics",
    ", the scheme can be easily generalized to give accurate predictions about the future evolution of an outbreak from which only a partial observation ( noisy and/or incomplete ) of the current state is available .",
    "work is in progress in this direction .",
    "an efficient form for the update equations of the  @xmath75 factor nodes is the following : @xmath174\\nonumber \\\\   & \\propto & \\delta\\left(t_{i}^{\\left(j\\right)},0\\right)m_{i\\to\\psi_{i}}\\left(0,g_{i}^{\\left(j\\right)}\\right)\\prod_{k\\in\\partial i\\setminus j}\\sum_{t_{ki}}m_{k\\to\\psi_{i}}\\left(0,t_{ki},g_{i}^{\\left(j\\right)}\\right)+\\label{eq : pass}\\\\   &   & + \\ ; m_{i\\to\\psi_{i}}\\left(t_{i}^{\\left(j\\right)},g_{i}^{\\left(j\\right)}\\right)\\i\\left(t_{i}^{\\left(j\\right)}\\leq t_{ji}+1\\right)\\prod_{k\\in\\partial i\\setminus j}\\sum_{t_{ki}\\geq t_{i}^{\\left(j\\right)}-1}m_{k\\to\\psi_{i}}\\left(t_{i}^{\\left(j\\right)},t_{ki},g_{i}^{\\left(j\\right)}\\right)\\nonumber \\\\   &   & -\\ ; m_{i\\to\\psi_{i}}\\left(t_{i}^{\\left(j\\right)},g_{i}^{\\left(j\\right)}\\right)\\i\\left(t_{i}^{\\left(j\\right)}<t_{ji}+1\\right)\\prod_{k\\in\\partial i\\setminus j}\\sum_{t_{ki}>t_{i}^{\\left(j\\right)}-1}m_{k\\to\\psi_{i}}\\left(t_{i}^{\\left(j\\right)},t_{ki},g_{i}^{\\left(j\\right)}\\right)\\nonumber \\end{aligned}\\ ] ] where in we use the fact that @xmath175    it is also possibile to use a simpler representation for the messages , in which we just retain information on the relative timing of infection time  @xmath176 for a node  @xmath2 and infection propagation time  @xmath177 on its link with node  @xmath8 , introducing the variables @xmath178 .",
    "in equation   we can easily group the sums over different configurations of  @xmath179 and write : @xmath180 similarly , the outgoing message to the  @xmath2 variable node is : @xmath181 in the simplified  @xmath182 representation for the messages , the update equation for the  @xmath76 nodes can be written in an easy way : @xmath183 where : @xmath184 and @xmath185 note that it is possible to exploit the symmetry in @xmath2 and @xmath8 between the rows 1 - 2 and rows 3 - 4 in the definition   for  @xmath186 : when one loops over the variables  @xmath187 in order to fill in the output message @xmath188 , this consists in looping over the variables @xmath187 of the input message @xmath189 , just with a switch in indices . in the implementation , this amounts in a significant reduction of a factor  @xmath114 in the computational complexity for updates involving the factor node  @xmath76 .",
    "the free energy of the system can be approximated with the bethe free energy that can be expressed as a sum of local terms depending on the bp messages .",
    "@xmath190 where @xmath191 the computation of the gradient of the free energy deserves some special attention : being @xmath192 a function of all the bp messages , one would argue that this messages depend on the model parameters too , at every step in the bp algorithm .",
    "actually , there is no need to consider this implicit @xmath193 dependence if bp has reached its fixed point , that is when bp equations are satisfied and the messages are nothing else but lagrange multipliers with respect to the constraint minimization of the bethe free energy functional @xcite . in our scheme ,",
    "the only explicit dependence of free energy on epidemic parameters is in the factor node terms @xmath194 s involving compatibility functions @xmath195 and @xmath20 , and the gradient can be computed very easily . for the @xmath76 nodes we have : @xmath196 where @xmath197 in the simplified  @xmath182 representation for the messages , equation   takes the form : @xmath198 where : @xmath199 for the @xmath80 nodes we have : @xmath200 where @xmath201    26ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ] ",
    "+ 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty @noop _",
    "( ,  ,  ) @noop * * ,   ( ) link:\\doibase 10.1016/j.jtbi.2010.11.033 [ * * ,   ( ) ] link:\\doibase 10.1073/pnas.0914080107 [ * * ,   ( ) ] ,   @noop * * ( ) link:\\doibase 10.1145/2483852.2483871 [ * * ,   ( ) ] @noop * * ,   ( ) link:\\doibase 10.1103/physreve.84.056105 [ * * ,   ( ) ] @noop * * ,   ( ) @noop ( ) link:\\doibase    10.1103/physrevlett.109.068702 [ * * ,   ( ) ] http://arxiv.org/abs/1304.0018[__ ] ,  ( ) in  link:\\doibase 10.1109/isit.2013.6620711 [ _ _ ]  ( )  pp .",
    "http://arxiv.org/abs/1303.5315[__ ] ,  ( ) link:\\doibase 10.1109/tsp.2013.2256902 [ * * ,   ( ) ] in  link:\\doibase    10.1109/ita.2013.6502991",
    "[ _ _ ]  ( )  pp . in  link:\\doibase    10.1109/isit.2013.6620613 [ _ _ ]  ( )  pp .",
    "link:\\doibase 10.1103/physrevlett.112.118701 [ * * ,   ( ) ] link:\\doibase    10.1103/physreve.82.016101 [ * * ,   ( ) ] in  @noop _ _",
    "( ,  )  pp . @noop ( ) @noop * * ,   ( ) link:\\doibase    10.1103/physreve.87.062115 [ * * ,   ( ) ] link:\\doibase 10.1088/1742 - 5468/2013/09/p09011 [ * * ,   ( ) ] link:\\doibase 10.1126/science.286.5439.509 [ * * ,   ( ) ] ,   @noop * * ( )"
  ],
  "abstract_text": [
    "<S> a belief propagation approach has been recently proposed for the zero - patient problem in a sir epidemics . </S>",
    "<S> the zero - patient problem consists in finding the initial source of an epidemic outbreak given observations at a later time . in this work , </S>",
    "<S> we study a harder but related inference problem , in which observations are noisy and there is confusion between observed states . </S>",
    "<S> in addition to studying the zero - patient problem , we also tackle the problem of completing and correcting the observations possibly finding undiscovered infected individuals and false test results .    moreover </S>",
    "<S> , we devise a set of equations , based on the variational expression of the bethe free energy , to find the zero patient along with maximum - likelihood epidemic parameters . </S>",
    "<S> we show , by means of simulated epidemics , how this method is able to infer details on the past history of an epidemic outbreak based solely on the topology of the contact network and a single snapshot of partial and noisy observations . </S>"
  ]
}