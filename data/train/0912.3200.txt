{
  "article_text": [
    "it is well known , see e.g. @xcite , @xcite and references therein , how to formulate critical embedding of a finite graph in a closed riemann surface in such a way that one can read off from the collection of angles of the embedding , termed discrete conformal structure , the critical values of independent variables ( i.e. the edge weights or coupling constants in the physical terminology ) attached to the edges of the dimer and the ising problems on @xmath6 .",
    "it is rather attractive task to study whether some of the properties associated to the notion of criticality in statistical physics may also be derived from the collection of data attached to critical embeddings .",
    "the main theme of this paper is the formulation of certain discrete analog of the claim made by alvarez - gaume et all , see @xcite , that the partition function of free fermion on a closed riemann surface of genus @xmath0 is a linear combination of @xmath1 pfaffians of dirac operators .",
    "the theory of free fermion is generally accepted to be closely related to the criticality of both the dimer and the ising problems on graphs .",
    "quite recently the dimer problem and its determinant type solution received considerable interest , see e.g. @xcite , @xcite .",
    "the authors of @xcite study the critical ising model by reducing it via the determinant type method to the dimer model .",
    "the case of planar graphs is well - understood in this setting , @xcite . however , as proved in @xcite , if one wants to obtain a discrete analog of the claim of @xcite for the dimer model in a surface of a positive genus , one has to take into account global restrictions on the graph embedded in the surface .    for the sake of completeness",
    ", we review in the appendix the combinatorial approach used to describe determinant type reduction of the critical dimer model on riemann surfaces of positive genus . the obstruction emerging in this description",
    "is centered around the notion of _ kasteleyn flatness_.    in this paper we propose to overcome the previously mentioned limitations and obstacles for the determinant - type reasoning by replacing the determinants by so called ihara - selberg functions of the graph @xmath6 .",
    "this in turn allows to rewrite the generating function of the even sets of edges of @xmath6 ( the ising model partition function associated to the graph @xmath6 ) as a linear combination of @xmath1 square roots of ihara - selberg functions which we call feynman functions .",
    "we build the feynman functions in a combinatorial way in order to capture the emergence of the rotations @xmath9 for spin structures @xmath17 in the analysis of the ising partition function , and realization of @xmath9 via the quadratic forms on @xmath18 .",
    "this approach makes use of the original treatment of the ising partition function via ihara - selberg functions by sherman , see @xcite , @xcite .",
    "our basic notion of a @xmath19graph @xmath20 allows convenient treatment of a planar model for the embedding of the graph @xmath6 in a closed riemann surface of genus @xmath0 .",
    "the @xmath19graphs have been successfully used recently in @xcite in a related situation . moreover",
    ", the planar model may improve the insight into the analysis of the limiting process , which has not been done yet .",
    "the rotations are treated in a different ( and perhaps more elegant ) way by johnson @xcite .",
    "finally , we show that the discrete dirac operators appear very naturally in the context of the feynman functions and comment on the relationship with continuous counterpart called analytic torsion , see @xcite,@xcite .      for the material reviewed in this subsection , see e.g. @xcite and references therein .",
    "let us consider a triple @xmath21 , where @xmath3 is a closed riemann surface , @xmath2 a graph and @xmath22 an embedding .",
    "the image of @xmath23 defines a cw decomposition of @xmath3 and @xmath24 is a disjoint union of open faces .    the metric realization of @xmath3 , compatible with an atlas @xmath25 covering @xmath3 , looks as follows . for a finite set of points @xmath26 on @xmath3 there exists a flat metric with conical singularities at @xmath26 such that the cone angles @xmath27 fulfill the gauss - bonnet formula @xmath28 , and there is no other restriction on them . because the euler characteristic @xmath29 is even",
    ", one can choose @xmath27 to be odd multiples of @xmath30 for each @xmath31 , for example .",
    "recall that the local model for a neighborhood of a conical singularity in @xmath32 is the standard cone @xmath33 with the metric @xmath34 .",
    "an embedding of a graph @xmath6 in a surface @xmath3 induces the dual graph @xmath35 of the embedding .",
    "we regard @xmath35 as an abstract graph with natural embedding into @xmath3 , so that each vertex of @xmath35 lies on the face of the embedding of @xmath6 it represents .",
    "the central notion related to the couple @xmath36 is of diamond graph - for simultaneous embedding of @xmath6 and @xmath35 , the diamond graph @xmath37 has the vertex set equal to @xmath38 and the edges connecting the end - vertices of each dual pair of edges @xmath39 into a facial cycle @xmath40 of @xmath37 , which is a @xmath41gon called a diamond ( see figure [ fig.diamond ] ) .",
    "diamond.pstex_t    we say that an embedding of @xmath6 is critical if it is isoradial , i.e. , in any local trivialization realized by complex plane is each face of @xmath6 a cyclic polygon ( the face is possible to inscribe into a circle . )",
    "moreover , the circumcenters of the facial polygons are contained in the closures of faces and all the facial polygons have the same radius .",
    "an equivalent description based on diamond graph @xmath37 looks as follows .",
    "the embedding @xmath23 of @xmath37 is critical if each of its faces @xmath42 , is a rhombus , i.e. , the following conditions hold true ( for all @xmath43 ) with respect to the induced conformal class of metrics on @xmath44 :    1",
    ".   the diagonals of each rhombus ( in @xmath45 ) are perpendicular , 2 .",
    "the lengths of sides of all rhombi ( in @xmath45 ) are the same .",
    "in particular , the first property is independent of the choice of trivialization , i.e. of the index @xmath43 together with @xmath45 , because the transition maps @xmath46 are conformal and so angle preserving .",
    "the second condition already depends on the choice of a metric in a given conformal class of metrics .",
    "we associate an independent variable @xmath4 with each edge @xmath47 of @xmath6 .",
    "a subset @xmath48 of edges is called perfect matching or dimer arrangement , if the induced graph @xmath49 has each vertex of degree one .",
    "let @xmath50 denote the set of the perfect matchings of @xmath6 .",
    "we define the dimer partition function of @xmath6 by @xmath51 where @xmath52 is the vector of edge weights .",
    "a subset @xmath48 of edges is called even if the induced graph @xmath49 has each vertex of even degree .",
    "we denote by @xmath53 the set of even subsets of edges of @xmath6 .",
    "the generating function of the even sets of edges of @xmath6 is defined by @xmath54 it is well known ( see e.g. @xcite ) that @xmath55 is equivalent to the ising partition function on @xmath6 defined by @xmath56 where @xmath57 @xmath58 are the weights ( coupling constants ) associated with edges of the graph @xmath6 and @xmath59 the scale ( inverse temperature ) , and @xmath60      we denote by @xmath8 the set of spin structures on riemann surface @xmath3 . following the articles @xcite , @xcite , @xcite , we associate the rotation to each spin structure .",
    "this enables us to define @xmath10 matrices @xmath11 , @xmath12 in a way that each @xmath11 is the matrix of the transitions between the oriented edges determined by the rotation @xmath9 corresponding to the spin structure @xmath17 . the main result of the article is    [ thm.main ] let @xmath6 be a graph embedded in a closed riemann surface @xmath3 of genus @xmath0 and let @xmath8 be the set of spin structures on @xmath3 .",
    "let us denote for each @xmath12 by @xmath11 the matrix introduced in definition [ def.dd ] .",
    "let @xmath61 be the feynman function defined in definition [ def.ff ] as the square root of the ihara - selberg function @xmath13 .",
    "then @xmath55 is a linear combination of @xmath1 functions @xmath62 .",
    "moreover , each @xmath61 is computable in a polynomial time .",
    "furthermore , let @xmath6 be a bipartite graph critically embedded in the riemann surface @xmath3 of genus @xmath0 equipped with a flat metric with conical singularities in such a way that no conical singularity is located at a vertex of the graph @xmath6 .",
    "then for each spin structure @xmath12 the matrix @xmath63 introduced in definition [ def.dada ] is related to the discrete dirac operator associated to @xmath17 ( see @xcite for its definition ) in a way described in corollary [ c.ddo ] .",
    "* acknowledgements . *",
    "the authors would like to thank david cimasoni for extensive discussions about discrete dirac operators and gregor masbaum for extensive discussions and suggestions about rotations and spin structures .",
    "in this section we assume the graph @xmath6 is embedded in a closed riemann surface @xmath3 of genus @xmath0 .",
    "we suggest to consider the ising partition function @xmath55 instead of the dimer partition function @xmath64 , and the square root of certain ihara - selberg functions on the graph @xmath6 ( which we call the feynman functions ) instead of the determinant . similar but much less advanced structure can be found e.g. in @xcite under the notion of ising preholomorphic observable .",
    "let @xmath2 be a graph . for @xmath47",
    "we denote by @xmath65 an orientation of @xmath5 , and @xmath66 the reversed directed edge to @xmath65 . as above , let @xmath67 be the formal variables associated with edges of @xmath6 .",
    "if @xmath68 is any orientation of the edge @xmath5 , we associate the new variable @xmath69 with it and always let @xmath70 .",
    "we consider an equivalence relation on the set of finite - length sequences @xmath71 satisfying @xmath72 : each such sequence is equivalent with each of its cyclic shifts .",
    "the equivalence classes will be called _",
    "circular sequences_.    a circular sequence @xmath73 with @xmath74 is called a _ prime reduced cycle _ if the following conditions are satisfied : @xmath75 , @xmath76 and @xmath77 for some sequence @xmath78 and a natural number @xmath79 .",
    "we say that the ordered pair @xmath80 is a transition of @xmath81 at @xmath82 , and @xmath83 is a transition of @xmath81 at @xmath84 .",
    "we denote by @xmath85 the prime reduced cycle which is the inverse of @xmath81 .",
    "[ def.z ] let @xmath2 be a graph and assume that the vertex set @xmath86 is linearly ordered .",
    "let @xmath87 be @xmath88 matrix with entries @xmath89 , @xmath90 , where we think of @xmath89 as the weight of _ transition _ between directed edges @xmath91 of @xmath6 .",
    "if @xmath81 is a prime reduced cycle then we let @xmath92 .",
    "we denote the set of prime reduced cycles of @xmath6 by @xmath93 .",
    "the ihara - selberg function associated to @xmath6 is @xmath94 where the infinite product is defined by the formal power series : @xmath95 and the sum is over all finite subsets @xmath96 of @xmath93 .",
    "a theorem of foata , zeilberger ( see @xcite ) , generalizing the seminal theorem of bass ( see @xcite ) , states :    [ thm.fz ] @xmath97 where @xmath98 is the matrix obtained from @xmath87 by letting @xmath99 if @xmath100 and @xmath101 otherwise .      in this section",
    "we restrict ourselves to the following standard representation of closed riemann surface @xmath3 of genus @xmath0 : we regard @xmath3 as a regular @xmath102gon @xmath103 ( called the base polygon ) in the plane with sides denoted anti - clockwise by @xmath104 , and the pairs of sides @xmath105 and @xmath106 , @xmath107 , identified .",
    "this defines a flat metric on @xmath3 with one conical singularity of angle @xmath108 .",
    "we only consider embeddings of graphs on @xmath3 which meet the boundary of @xmath103 transversally .",
    "moreover , to simplify the arguments , we only consider embeddings of graphs where each edge is represented by a straight line on @xmath3 .",
    "the general embeddings may be treated analogously .",
    "we now describe how an embedding of a graph in a riemann surface can be used to make its planar drawing of a special kind .",
    "we follow @xcite , @xcite .",
    "[ def.highway ] the _ highway surface _ @xmath109 consists of the base polygon @xmath103 and the bridges @xmath110 , where    * each odd bridge @xmath111 is a rectangle with vertices @xmath112 numbered anti - clockwise . the bridge is glued to @xmath103 so that its edge @xmath113 $ ] is identified with the edge @xmath114 $ ] and the edge @xmath115 $ ] is identified with the edge @xmath116 $ ] .",
    "* each even bridge @xmath117 is a rectangle with vertices @xmath118 numbered anti - clockwise .",
    "it is glued with @xmath103 so that its edge @xmath119 $ ] is identified with the edge @xmath120 $ ] and the edge @xmath121 $ ] is identified with the edge @xmath122 $ ] ( the indexes are always considered modulo @xmath123 . )    there is an orientation - preserving immersion @xmath124 of @xmath109 into the plane which is injective except that for each @xmath125 , the images of the bridges @xmath117 and @xmath111 intersect in a square ( see figure [ fig.torus ] ) .",
    "now assume the graph @xmath6 is straight - lines - embedded into a closed riemann surface @xmath3 of genus @xmath0 .",
    "we realize @xmath3 as the union of @xmath109 and an additional disk @xmath126 glued to the boundary of @xmath109 . by an isotopy of the embedding",
    "we may assume that @xmath6 does not meet the disk @xmath126 and moreover , all vertices of @xmath6 lie in the interior of @xmath103 .",
    "we may also assume that the intersection of @xmath6 with any of the rectangular bridges @xmath127 consists of disjoint straight lines connecting the two sides of @xmath127 glued to the base polygon @xmath103 .",
    "the composition of the embedding of @xmath6 into @xmath109 with the immersion @xmath124 yields a drawing @xmath23 of @xmath6 in the plane , where each edge of @xmath6 is represented by a piece - wise linear curve ( see figure [ fig.torus ] ) . a planar drawing of @xmath6 obtained in this way will be called _ @xmath19graph _ and denoted by @xmath20 .",
    "observe that double points of a @xmath19graph can only come from the intersection of the images of bridges under the immersion @xmath124 of @xmath109 into the plane .",
    "thus every double point of a special drawing lies in one of the squares @xmath128 .",
    "[ def.rrr ] let @xmath6 be embedded in @xmath109 and let @xmath5 be an edge of @xmath6 . by definition , the embedding of @xmath5 intersects each bridge @xmath127 in disjoint straight lines . the number of these lines is denoted by @xmath129 . for a set @xmath130 of edges of @xmath6 we let @xmath131 be the vector of length @xmath132 defined by @xmath133 .    [ def.nnn ]",
    "if @xmath81 is a prime reduced cycle of @xmath6 then we denote by @xmath134 the image of @xmath81 in @xmath20 .",
    "clearly , @xmath135 gives bijective correspondence between the prime reduced cycles of @xmath6 and the prime reduced cycles of @xmath20 .",
    "torus.pstex_t      let @xmath6 be a graph embedded in a closed riemann surface @xmath3 of genus @xmath0 and let @xmath20 be its @xmath19graph .",
    "we recall that each edge of @xmath6 in @xmath20 is represented by a piecewise linear curve .",
    "let @xmath81 be a prime reduced cycle of @xmath6 and let @xmath134 the corresponding prime reduced cycle of @xmath20 .",
    "we will introduce @xmath136 _ rotations _ of @xmath134 .",
    "first of all , we denote by @xmath16 the @xmath137vector of length @xmath132 and in analogy with the usual definition of the rotation of a regular closed curve in the plane we define @xmath138 by setting @xmath139 , where we sum over all the transitions of the linear parts of @xmath134 . if the transition @xmath140 consists in passing from directed segment @xmath5 to directed segment @xmath141 then @xmath142 , where @xmath143 is the angle of the transition .",
    "the angle @xmath143 is negative if the transition is clockwise , and @xmath143 is positive if the transition is anti - clockwise ( see figure [ fig.tra ] ) .",
    "consequently , for each arithmetic vector @xmath144 ( @xmath145 is the field with two elements ) we let @xmath146 and @xmath147 .",
    "here @xmath148 denotes the scalar product of vectors @xmath17 , @xmath149 .",
    "observe that for each @xmath17 , @xmath150 .",
    "[ def.new ] we introduce the equivalence relation on the set of prime reduced cycles of @xmath6 : we say that @xmath151 is equivalent to @xmath152 if @xmath153 . the set of equivalence classes of this equivalence relation",
    "is denoted by @xmath154 $ ] .",
    "analogously , we introduce the equivalence relation on the set of prime reduced cycles of @xmath20 : we say that @xmath155 is equivalent to @xmath156 if @xmath157 . the set of equivalence classes of this equivalence relation",
    "is denoted by @xmath154^g$ ] .",
    "tra.pstex_t    the previous considerations allow to introduce the feynman functions : @xmath158^g}(-1)^{|[\\f]^g|}\\prod_{[\\gamma ] \\in [ \\f]^g}(-1)^{rot_s(\\gamma)}\\prod_{e\\in \\gamma}x_e,\\end{aligned}\\ ] ] where the sum is over all finite subsets @xmath159^g$ ] of @xmath154^g$ ] .",
    "the following theorem appears in @xcite .",
    "we assign to @xmath144 the sign according to @xmath160 .",
    "[ thm.three ] let @xmath6 be a graph with each vertex of degree equal to @xmath161 or @xmath162 , embedded into a closed riemann surface @xmath3 of genus @xmath0 .",
    "then @xmath163    theorem [ thm.three ] can easily be extended to general graphs .",
    "[ thm.four ] let @xmath6 be a graph embedded into a closed riemann surface @xmath3 of genus @xmath0 .",
    "then @xmath164    we will construct a graph @xmath165 along with its embedding into @xmath3 so that the degree of each vertex of @xmath165 is equal to @xmath161 or @xmath162 , such that there are two subsets @xmath166 of @xmath167 and a bijection @xmath168 inducing @xmath169 and , for each @xmath144 , @xmath170 theorem [ thm.four ] then follows from theorem [ thm.three ] .",
    "we construct graph @xmath165 in two steps .",
    "let @xmath171 denote the set of the vertices of @xmath6 of an odd degree .",
    "we start with @xmath172 .    * step 1 . *",
    "if @xmath173 then it is a standard observation of the graph theory that @xmath6 has a set of edge - disjoint paths so that each vertex of @xmath171 is an end - vertex of exactly one of the paths , and all the end - vertices of the paths are among the elements of @xmath171 . in particular , @xmath174 is even .",
    "let @xmath175 denote the set of the edges of these paths .",
    "we construct graph @xmath176 from @xmath6 by adding , for each edge @xmath177 , a path of length @xmath178 with end - vertices @xmath179 ( see figure [ fig.zero ] ) .",
    "we further let @xmath78 be the set of all the edges of @xmath180 .",
    "note that @xmath176 has all degrees even .",
    "zero.pstex_t    * step 2 . *",
    "if @xmath181 is a vertex of @xmath176 of an even degree bigger than @xmath162 then we modify @xmath176 by splitting the degree of @xmath181 by introducing the new splitting edge ; the operation can be read off the figure [ fig.one ] .",
    "we repeat this step until the resulting graph @xmath182 has all degrees equal to @xmath161 or @xmath162 .",
    "finally we let @xmath183 be the tautological injection of @xmath86 into @xmath184 .",
    "one.pstex_t    it is straightforward to realize that all assumptions of the construction are satisfied after application of finite number of these steps .    in order to associate rotations to quadratic forms ,",
    "we first need to study self - intersections of the prime reduced cycles which traverse each edge of the graph at most once .",
    "let @xmath81 be a prime reduced cycle of @xmath6 which traverses each edge of @xmath6 at most once . for each vertex @xmath181 of @xmath6 ,",
    "let @xmath185 denote the set of the directed edges of @xmath81 incident with @xmath181 , and let @xmath186 denote the partition of @xmath185 into pairs which correspond to the _ transitions _ of @xmath81 at @xmath181 .",
    "if a prime reduced cycle @xmath81 traverses each edge of @xmath6 at most once then the transitions of @xmath81 at @xmath181 are well described by the directed chord diagram @xmath187 ( see figure [ fig.crossing ] ) :    [ def.chord ] let @xmath81 be a prime reduced cycle of @xmath6 which traverses each edge of @xmath6 at most once . the directed chord diagram @xmath187",
    "is obtained by taking the cyclic ordering of the edges of @xmath6 incident with @xmath181 and induced from the embedding of @xmath6 in @xmath3 , and by introducing the directed chord @xmath188 for each class of @xmath186 consisting of an orientation of @xmath5 followed by an orientation of @xmath141 .",
    "we define the number of _ self - intersections _ of @xmath81 as the number of the pairs of intersecting chords of @xmath187 , @xmath189 .",
    "crossing.pstex_t      a subset of edges @xmath48 of a graph @xmath6 embedded in a closed riemann surface of genus @xmath0 is called even if each degree of the graph @xmath49 is even .",
    "the set of even subsets of @xmath6 is denoted by @xmath53 .",
    "let @xmath190 be the first homology group of @xmath3 with coefficients in the field @xmath145 .",
    "we observe that two even subsets of edges @xmath191 belong to the same homology class in @xmath192 if and only if @xmath193 ( see definition [ def.rrr ] for the definition of @xmath149 ) .",
    "we have a basis @xmath194 of @xmath192 , where @xmath195 correspond to the even subsets @xmath196 satisfying @xmath197 and @xmath198 otherwise , and @xmath199 and @xmath200 otherwise .",
    "recall that @xmath192 carries a non - degenerate skew - symmetric bilinear form called @xmath201 _ intersection form _ , denoted by @xmath202. in the basis chosen above , it is given by @xmath203 and @xmath204 for all @xmath205 .",
    "[ def.q ] a quadratic form on @xmath206 associated to the bilinear form @xmath202 is a function @xmath207 fulfilling @xmath208 for all @xmath209 .",
    "we denote the set of quadratic forms on @xmath192 over @xmath145 by @xmath210 .",
    "the cardinality of @xmath210 is @xmath136 .",
    "let @xmath211 be an even subset of edges of @xmath6 . for each vertex @xmath181 ,",
    "let @xmath212 denote the subset of edges of @xmath184 incident with @xmath181 , and given the embedding of @xmath6 in @xmath3 , let @xmath213 denote a partition of @xmath212 into pairs which correspond to the non - crossing undirected transitions at @xmath181 on @xmath3 ( see figure [ fig.noncro ] ) .",
    "notice that @xmath213 need not be unique .",
    "we say that a prime reduced cycle @xmath81 of @xmath6 is consistent with @xmath214 if each transition of @xmath81 is a directed transition of an element of @xmath214 .",
    "noncro.pstex_t    let us recall definition [ def.new ] of the equivalence on the set of prime reduced cycles of @xmath6 .",
    "[ o.decc ] the set of all transitions @xmath214 uniquely determines the set @xmath215,\\ldots , [ p_k]\\}$ ] of equivalence classes of edge - disjoint prime reduced cycles which are consistent with @xmath214 , and @xmath216 .",
    "moreover , for each @xmath43 we have @xmath217 the number of the self - intersections of @xmath218 ( see definition [ def.chord ] ) .",
    "the first part is straightforward .",
    "the second part is clear since no edge is traversed more than once by any of the @xmath219 s .",
    "we recall that @xmath53 denotes the set of the even subsets of edges of graph @xmath6 .",
    "let @xmath220 denote the subgroup consisting of the homology classes realized by elements of @xmath53 .",
    "[ def.top ] for each @xmath144 , we define a function @xmath221 by @xmath222 where @xmath134 is the realization of @xmath81 in the @xmath19graph @xmath20 ( see definition [ def.nnn ] ) .",
    "[ thm.top ] for each @xmath144 , the function @xmath223 induces a function @xmath224 by @xmath225)= q'_s(e').\\end{aligned}\\ ] ] moreover , each @xmath226 is a quadratic form restricted to @xmath227 .",
    "we first show that @xmath228 is a quadratic form .",
    "let @xmath215,\\ldots , [ p_k]\\}$ ] be as in observation [ o.decc ] .",
    "we have , for each @xmath43 , @xmath217 the number of the self - intersections of @xmath218 ( observation [ o.decc ] ) .",
    "moreover , by the choice of @xmath214 , the self - intersections of each @xmath218 as well as the crossings of @xmath218 with @xmath229 , @xmath230 , lie outside of the base polygon @xmath103 .",
    "we also recall that two closed curves in the plane have always an even number of crossings .    hence , @xmath231 .",
    "this means that , by definition [ def.q ] , @xmath228 coincides on @xmath220 with the quadratic form on @xmath192 whose value on each of the basis vectors @xmath232 and @xmath233 is zero .",
    "furthermore , @xmath234 and thus @xmath235 .",
    "hence each @xmath226 is well - defined and coincides on @xmath220 with a quadratic form .",
    "we recall that there is a natural bijection between the set @xmath8 of the spin structures of @xmath3 and the quadratic forms on the @xmath236valued first homology classes of @xmath3 ( see @xcite ) .",
    "hence theorem [ thm.top ] associates a spin structure to each @xmath9 , @xmath144 , and this map is bijective . from now on we will consider the rotations @xmath9 indexed by spin structures on @xmath3 .",
    "however , we still have @xmath9 determined by the derived drawing of @xmath6 realized by the @xmath19graph @xmath20 .",
    "the usefulness of quadratic forms in studying rotations @xmath9 was suggested to us by g. masbaum , who also suggested theorem [ thm.gr ] below .",
    "[ thm.gr ] let @xmath81 be a prime reduced cycle of @xmath6 so that each edge of @xmath6 is traversed at most once in @xmath81 , and let @xmath12 .",
    "then @xmath201 @xmath237 where @xmath134 is the realization of @xmath81 in the @xmath19graph @xmath20 .    by the definition of @xmath9 it suffices to prove the statement for @xmath238 .",
    "we have @xmath201 @xmath239 @xmath240 @xmath241      [ def.dd ] let @xmath6 be a graph embedded in a closed riemann surface @xmath3 of genus @xmath0 .",
    "let @xmath242 , hence @xmath243 . to each spin structure",
    "@xmath12 we associate @xmath11 , the @xmath244-matrix with entries @xmath245 , where    1 .",
    "@xmath246 if @xmath68 is contained in the interior of @xmath103 , 2 .",
    "@xmath247 if the segment of the embedding of @xmath68 outside @xmath103 in @xmath20 is oriented oppositely to the anti - clockwise orientation of the boundary of @xmath103 ( as directed edge @xmath248 in figure [ fig.torus ] ) , 3 .",
    "@xmath249 if the segment of the embedding of @xmath68 outside @xmath103 in @xmath20 is oriented in agreement with the anti - clockwise orientation of the boundary of @xmath103 ( as directed edge @xmath248 in figure [ fig.torus ] ) .",
    "we further define @xmath15 by declaring @xmath250 if @xmath100 and @xmath251 otherwise in @xmath11 .",
    "we are going to introduce the _ feynman functions _ , see definition [ def.ff ] below . as its first ingredient we need to extend definition [ def.chord ] to the number of self - intersections of general prime reduced cycles , i.e. , the prime reduced cycles that can go through an edge more than once .",
    "this can be done for instance in the following way .",
    "we define the infinite graph @xmath252 by replacing each edge @xmath5 by an infinite sequence of edges @xmath253 with the same end - vertex as @xmath5 .",
    "we embed @xmath252 in @xmath3 so that we thicken the embedding of each edge @xmath5 of @xmath6 , and embed the edges @xmath253 to this thickened part of @xmath5 so that they are piece - wise linear and internally disjoint .",
    "next , for each prime reduced cycle @xmath81 of @xmath6 whose circular sequence of directed edges is @xmath254 , @xmath255 being an orientation of edge @xmath256 of @xmath6 ( possibly @xmath257 for @xmath258 ) , we define prime reduced cycle @xmath259 in @xmath252 by replacing each @xmath255 by the same orientation of @xmath260 .",
    "it is important that the prime reduced cycle @xmath259 uses each edge of @xmath252 at most once .",
    "we thus define the number of the self - intersections of a prime reduced cycle @xmath81 of @xmath6 as the number of the self - intersections of the prime reduced cycle @xmath259 of @xmath252 ( see definition [ def.chord ] ) .",
    "the number of the self - intersections of a prime reduced cycle @xmath134 of @xmath20 is defined analogously .",
    "we note that for the prime reduced cycles of @xmath6 containing each edge of @xmath6 at most once this is consistent with definition [ def.chord ] .",
    "we also note that the following basic property is satisfied .",
    "[ o.inf ] let @xmath81 be a prime reduced cycle of @xmath6 .",
    "then we have @xmath201 @xmath261    [ def.ff ] let @xmath12 be a spin structure .",
    "we define @xmath262}\\prod_{[\\gamma ] \\in [ \\f]}(-1)^{q_s(\\gamma)+\\text { the number of self - intersections of } \\gamma}\\prod_{e\\in \\gamma}x_e.\\end{aligned}\\ ] ]    ( * of the first part of theorem [ thm.main ] * )    we note that @xmath263}(-1)^{|[\\f]|}\\prod_{[\\gamma ] \\in [ \\f]}(-1)^{1+q_s(\\gamma)+\\text { the number of the self - intersections of } \\gamma}\\prod_{e\\in \\gamma}x_e= \\nonumber \\\\ \\nonumber & & = \\sum_{[\\f]}(-1)^{|[\\f]|}\\prod_{[\\gamma ]",
    "\\in [ \\f]}(-1)^{rot_s(\\gamma^g)}\\prod_{e\\in \\gamma}x_e.\\end{aligned}\\ ] ]    hence @xmath61 is the square root of @xmath13 . by theorem [ thm.fz ] , @xmath264 and",
    "each @xmath61 is computable in polynomial time .",
    "the first part of theorem [ thm.main ] is now a corollary of theorem [ thm.four ] .",
    "the linear combination appearing in theorem [ thm.main ] may be understood as the arf - invariant formula @xmath265 this formula was suggested by g. masbaum and independently by d. cimasoni , @xcite .",
    "a proof following @xcite , @xcite is work in progress ( see @xcite ) .",
    "we only indicate here the emergence of @xmath266 in the right - hand - side of the formula above .",
    "we know by theorem [ thm.top ] that for each even set @xmath211 and for each @xmath12 , @xmath267 next , the basic result about the arf invariant ( see e.g. lemma 2.10 of @xcite ) states that @xmath268 hence , for each @xmath211 , @xmath269 appears in the expansion of the right - hand - side of the arf - invariant formula .",
    "it is needed to show that the remaining terms in the expansion are equal to zero .",
    "so far we considered an arbitrary embedding of a graph @xmath6 in a riemann surface @xmath3 .",
    "now , let @xmath270 be bipartite and the embedding critical .",
    "the vertices of @xmath271 are called _ white _ and the vertices of @xmath272 are called _",
    "black_. we also assume in this subsection that the conical singularities are not located at the vertices of @xmath6 .",
    "we recall the notation @xmath242 .",
    "let @xmath273 be the subset of @xmath274 consisting of the edges directed from its black vertices to its white vertices .",
    "analogously , let @xmath275 be the set of edges directed from its white vertex to its black vertex .",
    "the key construction has the following structure :    [ def.t ] let @xmath276 be the _ directed transition graph _ of the orientations of edges of @xmath6 , i.e. @xmath277 and @xmath278 if the head of @xmath68 is the tail of @xmath279 .",
    "[ o.kk1 ] the graph @xmath276 is a directed bipartite graph , @xmath280 , and the matrix @xmath11 is a weighted adjacency matrix of @xmath276 .",
    "the next observation follows directly from definition [ def.dd ] .",
    "[ o.uhel ] let @xmath281 be an orientation of the edge @xmath5 entering the vertex @xmath282 .",
    "let @xmath283 be a directed edge leaving @xmath284 and entering vertex @xmath285 .",
    "then the entry @xmath286 equals @xmath287 , where @xmath288 is half of the angle of the transition from @xmath289 to @xmath283 ; @xmath290 equals a complex number depending only on @xmath17 and @xmath289 .",
    "let @xmath291 denote the length of the dual edge @xmath292 of an edge @xmath5 of @xmath6 .",
    "[ def.dada ] we denote by @xmath63 the matrix obtained by taking the square of each entry of @xmath11 and substituting the vector of the lengths of the dual edges for the squares of the variables : @xmath293 .",
    "( of observation [ o.uhel ] ) [ c.dva ] if @xmath294 are two directed edges of @xmath274 entering the same vertex then the row of @xmath63 indexed by @xmath295 is a complex multiple of the row of @xmath63 indexed by @xmath296 .",
    "the discrete dirac operator @xmath297 of a bipartite graph @xmath298 , @xmath299 , corresponding to a spin structure @xmath12 , is defined as the weighted adjacency @xmath300matrix ; @xcite contains the definition for the planar graphs and @xcite defines half of ( or , the chiral part of ) @xmath297 , which uniquely determines @xmath297 .",
    "we observe in this subsection that the matrix @xmath63 is closely related to @xmath297 .    to that aim",
    "we fix the coordinate chart on the riemann surface such that a black vertex @xmath301 lies at @xmath302 in this local chart .",
    "the directed edges emanating from a white vertex and terminating at @xmath181 are denoted @xmath303 .",
    "similarly , we fix an edge @xmath304 emanating from @xmath181 and terminating at some white vertex @xmath282",
    ". the @xmath305-matrix element of the dirac operator is @xmath306 , where @xmath307 is the angle between the edge @xmath304 and the real axis of the local coordinate chart .",
    "note that the change in local coordinate chart does not preserve the real axis , but does preserve the angle @xmath307 .",
    "on the other hand the @xmath308-entry of our matrix @xmath63 is equal to @xmath309 , where @xmath310 is the angle between @xmath311 measured anticlockwise , see figure [ fig.tra ] .",
    "in particular , in the local coordinate chart in which the edge @xmath312 lies on the real axis , we have @xmath313 .",
    "equivalently , the matrix coefficients in a given row of our matrix @xmath63 indexed by directed edge @xmath5 are ( constant ) multiples of the row in the dirac matrix corresponding to the terminal vertex of @xmath5 .",
    "the same applies when one starts with the white vertex instead of the black one .",
    "the basic observation about the matrices @xmath63 and @xmath297 can be formulated in the following way .",
    "[ c.tri ] let @xmath281 be an orientation of the edge @xmath5 entering the vertex @xmath282 .",
    "let @xmath283 be a directed edge leaving @xmath284 and entering vetex @xmath285 .",
    "then @xmath314 , where @xmath315 is a complex number depending only on @xmath289 .    the last part of theorem [ thm.main ] is contained in the next corollary",
    ".    [ c.ddo ] each matrix @xmath63 , @xmath316 a spin structure , may be obtained from the discrete dirac operator @xmath297 , whose chiral part is defined in @xcite , by finite number of operations :    1 .",
    "adding identical copy of a row , 2 .   multiplying a row by a complex number , 3 .",
    "adding @xmath317 zero - entries to each row .",
    "[ r.conc ] the properties that graph @xmath6 is bipartite and critically embedded , and the condition that the conic singularities of the metric are not located at the vertices of @xmath6 , are needed in @xcite to show that constant functions belong to the kernel of the discrete dirac operators .      in the last part of the paper we rewrite each feynman function as the alternating sum of the traces of the skew - symmetric powers of matrices @xmath15 .",
    "the skew - symmetric powers are closely related to the analytic torsion on riemann surfaces .",
    "these considerations may lead to a realization of the analytic torsion as a continuous limit of the feynman functions .",
    "let @xmath318 be the directed graph obtained from @xmath276 by deleting all directed edges of the type @xmath319 , where @xmath68 is an orientation of an edge of @xmath6 . clearly , @xmath15 is the weighted adjacency matrix of the directed graph @xmath318 .",
    "we recall that each feynman function @xmath61 is the square root @xmath320 ( theorem [ thm.fz ] ) .",
    "we first describe the directed graph @xmath318 in terms of the graph @xmath6 .",
    "the set of the vertices of @xmath318 is @xmath321 .",
    "let @xmath322 be an edge of @xmath6 between black vertex @xmath323 and white vertex @xmath284 .",
    "the edge @xmath5 gives rise to two vertices of @xmath318 , namely @xmath324 and @xmath325 .",
    "if the graph @xmath6 is critically embedded in a closed riemann surface @xmath3 , the vertex @xmath326 of @xmath318 is represented by a point on the embedding of @xmath5 near the vertex @xmath323 , and the vertex @xmath327 of @xmath318 is represented by a point on the embedding of @xmath5 near the vertex @xmath284 .",
    "( see figure [ fig.lap ] ) .",
    "let @xmath328 be the white vertices incident to @xmath323 in @xmath6 and different from @xmath284 , and let @xmath329 .",
    "then @xmath318 contains all the directed edges @xmath330 .",
    "analogously , let @xmath331 be the black vertices incident to @xmath284 in @xmath6 and different from @xmath323 , and let @xmath332",
    ". then @xmath318 contains all the directed edges @xmath333 ( see figure [ fig.lap ] ) .    lap.pstex_t    let us get back now to the expression of the feynman function @xmath61 as the square root @xmath320 .",
    "for example , one can apply the following formula ( called fermionic expansion ) :    [ l.w ] let @xmath334 be a linear operator acting on finite dimensional ( complex ) vector space @xmath335 , @xmath336 .",
    "let @xmath337 be the induced operator acting on @xmath338 , the @xmath43-th skew symmetric power of @xmath335 .",
    "then @xmath339    the functions @xmath340 do not depend on the representative in the conjugacy class @xmath341 , so it is sufficient to consider the basis of @xmath335 in which @xmath130 has jordan block structure .",
    "we shall stick to the generic case of semi - simple conjugacy class , i.e. all jordan blocks have size @xmath342 .",
    "the proof in the presence of a non - trivial jordan block follows from the generic case by continuity .",
    "let @xmath343 .",
    "the left hand side of ( [ identity ] ) reduces to @xmath344 where @xmath345 is the homogeneity @xmath43 symmetric function in variables @xmath346 .",
    "the right hand side of ( [ identity ] ) is evaluated as follows .",
    "let @xmath347 be the basis of @xmath335 consisting of eigenvectors of @xmath130 subordinate to the eigenvalues @xmath348 .",
    "the matrix @xmath349 acts on the basis element @xmath350 , @xmath351 , by @xmath352 the trace of @xmath349 , computed in the basis @xmath353 of @xmath354 , results in @xmath355 ( note that @xmath356 ) and the alternating sum of @xmath357 over @xmath358 is equal to the left hand side .",
    "the proof follows .",
    "let us mention a more general motivating geometrical and homological context for the fermionic formula , see @xcite,@xcite .",
    "let @xmath359 be a compact riemannian manifold and @xmath360 a vector bundle on @xmath87 .",
    "we can associate to the spectrum of laplace operator acting on @xmath43-forms twisted by @xmath86 , @xmath361 its spectral zeta function @xmath362 defined by analytic continuation of the right hand side convergent for @xmath363 to the whole complex plane @xmath364 . here",
    ". the zeta function regularized determinant of @xmath366 is defined by @xmath367 then the analytic torsion @xmath368 is @xmath369 the logarithm of analytic torsion is then half of the weighted sum of functional determinants for laplace operators . in particular , observe that in the case of analytic torsion on a riemann surface @xmath370 we have @xmath371 where @xmath372 is the laplace operator acting on @xmath373-forms of @xmath370 , @xcite .",
    "the discrete analogue of @xmath342-forms was considered by mercat in @xcite , see also lovasz @xcite .",
    "a @xmath342-form is a function on the set of directed edges of an embedded graph .",
    "this parallels to our matrix @xmath15 , which is being indexed by the directed edges of the critically embedded graph @xmath6 .",
    "it is clear that the previous zeta function regularization boils down to the determinant computation in the case of an operator @xmath374 acting on a finite dimensional vector space .",
    "let @xmath375 be the subspace of non - zero eigenvalues of @xmath374 .",
    "its spectral zeta function is @xmath376 and so @xmath377 in conclusion , @xmath378 is equal to the regularized determinant @xmath379 of @xmath374 .",
    "this paper studies a question whether one can define , using the geometric data provided by a critical embedding of a graph @xmath6 in a riemann surface , weights of the edges of @xmath6 in a way that the matrix of these weights captures the basic properties of discrete dirac operator and the partition function of the dimer or ising models with these weights may be explicitly evaluated .",
    "the first step in this theory is the reduction of @xmath55 to @xmath380 , where @xmath381 is obtained from @xmath6 by local changes which do not affect genus of the riemann surface @xmath3 in which @xmath6 is embedded .",
    "this construction ( see e.g. @xcite ) is not relevant here , so we omit it and concentrate on the dimer partition function @xmath64 .",
    "assume the vertices of @xmath6 are numbered from @xmath342 to @xmath382 .",
    "an orientation of @xmath6 is obtained by prescribing one of the two possible directions to each edge of @xmath6 .",
    "if @xmath383 is an orientation of @xmath6 , we denote by @xmath384 the skew - symmetric adjacency matrix of @xmath383 defined as follows : the diagonal entries of @xmath384 are zero , and the off - diagonal entries are @xmath385 where the sum is taken over all edges @xmath5 connecting vertices @xmath43 and @xmath31 , and the sign in front of @xmath4 is @xmath342 if @xmath5 is oriented from @xmath43 to @xmath31 in the orientation @xmath383 , and @xmath386 otherwise .",
    "it is well known that the pfaffian of @xmath384 counts perfect matchings @xmath387 of the graph @xmath6 with signs : @xmath388 where @xmath389 .",
    "we use this as the definition of the sign of a perfect matching @xmath87 with respect to the orientation @xmath383 .",
    "the following statement is the basic result in the field :    [ pfaff - formula ] if @xmath6 embeds into a riemann surface of genus @xmath0 , then there exist @xmath136 orientations @xmath390 ( @xmath391 ) of @xmath6 such that the perfect matching polynomial @xmath64 can be expressed as a linear combination of the pfaffian polynomials @xmath392 .",
    "moreover , the orientations @xmath390 are kasteleyn orientations , i.e. , they satisfy the following property : if @xmath393 is a facial cycle of @xmath6 then @xmath393 has an odd number of edges oriented in @xmath390 in agreement with the clockwise traversal of @xmath393 .",
    "the formula of theorem [ pfaff - formula ] is called the arf - invariant formula , as it is based on the property of the arf invariant for quadratic forms in characteristic two . as far as we know",
    ", the relationship with the arf invariant was first observed in @xcite . in @xcite",
    ", kuperberg introduced a generalization of the notion of kasteleyn orientations , called kasteleyn flatness .",
    "we recall that a graph @xmath2 is called bipartite if the set of the vertices @xmath335 may be partitioned into two sets @xmath394 so @xmath395 for each @xmath47 . in this and the next one subsection",
    "we restrict ourselves to finite bipartite graphs @xmath270 , where @xmath396 are the two edge - less sets of vertices of @xmath6 and @xmath299 .",
    "we call the vertices in @xmath271 white and the vertices in @xmath272 black and assume that @xmath6 has at least one perfect matching . in particular , we restrict to the case of equal cardinalities @xmath397 . by a cycle in @xmath6 we mean a subset of edges @xmath398 which form a cycle .",
    "the cycle @xmath399 can be decorated by one of the two possible orientations , i.e. one of the two possible ways of going around @xmath399 . by an oriented cycle we mean a cycle decorated with an orientation . in this subsection",
    "we also use @xmath400 to denote the orientation of @xmath6 in which each edge is oriented from its black vertex to its white vertex .",
    "[ def.kc ] let @xmath6 be given with the weights @xmath401 .",
    "let @xmath399 be an oriented cycle of @xmath6 .",
    "we define @xmath402 as the _ kasteleyn curvature _ of @xmath399 . here",
    "@xmath403 denotes the subset of edges of @xmath399 whose orientation inherited from @xmath399 coincides with their orientation in @xmath400 , and @xmath404 .",
    "let @xmath406 be a bipartite graph equipped with the weights @xmath401 .",
    "let us fix a linear ordering on the set @xmath407 such that the elements of @xmath272 precede the elements of @xmath271 .",
    "this allows to introduce @xmath408 as @xmath409 skew - symmetric matrix defined by @xmath410 if @xmath411 and @xmath412 resp .",
    "@xmath413 if @xmath414 and @xmath412 , @xmath415 otherwise .",
    "we further denote by @xmath416 the @xmath417block of @xmath408 .",
    "for @xmath87 a perfect matching of @xmath6 we denote by @xmath418 the coefficient of @xmath419 in @xmath420 .",
    "note that @xmath421 , where @xmath422 is the sign of @xmath87 relative to the fixed linear ordering on the set of vertices @xmath407 .",
    "[ prop.two ] let @xmath399 be a cycle of @xmath6 embedded in @xmath3 so that @xmath399 is a symmetric difference of two perfect matchings @xmath423 and the orientation of @xmath399 coincides with the orientation of the edges of @xmath87 in @xmath400 . then @xmath424        we are able to prove a stronger statement .",
    "let @xmath6 be embedded in a riemann surface @xmath3 of genus @xmath0 .",
    "we say that the weigh - function @xmath284 is _ simple kasteleyn flat _ if it is kasteleyn flat and moreover @xmath425 for each @xmath47 .",
    "the function @xmath284 may be viewed as assigning orientation @xmath426 obtained from orientation @xmath400 by reversing the orientation of all edges with negative weight . if @xmath284 is simple kasteleyn flat the orientation @xmath408 is a kasteleyn orientation , i.e. each face has an odd number of edges oriented clockwise .",
    "the next definition is motivated by @xcite .",
    "[ def.eq ] we say that two weight - functions @xmath427 are equivalent if @xmath284 can be obtained from @xmath428 by finite number of vertex multiplications , where a vertex multiplication consists in choosing a vertex @xmath181 and a complex number @xmath429 together with multiplication by @xmath430 the weights of all edges incident with @xmath181 .    [ prop.dos ] let @xmath6 be a graph embedded in a closed riemann surface @xmath3 of genus @xmath0 and let @xmath284 be a kasteleyn flat weight function , satisfying in addition @xmath431 for each cycle @xmath399 .",
    "then @xmath284 is equivalent to a simple kasteleyn flat weight - function @xmath428 , i.e. , to a kasteleyn orientation .",
    "we may assume that @xmath6 is connected .",
    "let @xmath432 , @xmath433 be a spanning tree of @xmath6 .",
    "we can clearly perform vertex multiplications ( in @xmath6 ) in a way the resulting weight function @xmath428 satisfies @xmath434 for each @xmath435 .",
    "let @xmath436 .",
    "then necessarily @xmath437 since @xmath5 forms a cycle ( say , denoted by @xmath399 ) with a subset of @xmath184 and @xmath438 has values in @xmath439 .",
    "[ cor.o ] let @xmath6 be a graph embedded in a closed riemann surface @xmath3 of genus @xmath0 and @xmath284 be a kasteleyn flat weight function satisfying @xmath431 for each cycle @xmath399 .",
    "then @xmath64 is a linear combination of @xmath136 determinants of matrices obtained from @xmath416 by multiplying some entries by @xmath386 .",
    "the computation of the dimer partition function @xmath64 for a critically embedded bipartite graph @xmath6 is based on the following strategy ( see @xcite , @xcite ) : define the weight function @xmath284 using discrete geometric information contained in the data of the critical embedding and use this information to prove that the kernel of the corresponding matrix @xmath408 has properties desired for a discrete analogue of the dirac operator . next , prove that @xmath284 is kasteleyn flat and insert it into corollary [ cor.o ] .",
    "this approach works for planar bipartite graphs as well ( @xcite ) , since in this case each kasteleyn flat weight function satisfies @xmath431 for each cycle @xmath399 , see @xcite . on the other hand",
    "the assumptions of corollary [ cor.o ] are quite restrictive for non - planar surfaces . by proposition [ prop.dos ] ,",
    "they are equivalent to @xmath425 for each edge @xmath47 .",
    "moreover , it is shown in @xcite that the theory of kasteleyn flatness can not go beyond corollary [ cor.o ] .",
    "l. alvarez - gaume , j.b .",
    "bost , g. moore and c. vafa , _ bosonization on higher genus riemann surfaces _ , comm . math .",
    "* 112 * ( 1987 ) , 503552 .",
    "h. bass , _ the ihara - selberg zeta function of a tree lattice _ , intern",
    ". j. math .",
    "* 3 * ( 1992 ) , 717797 .",
    "l. lovasz .",
    "_ discrete analytic functions : an exposition _ , in : surveys in differential geometry ix , eigenvalues of laplacians abd other geometric operators ( ed .",
    "a. grigoryan , s .-",
    "yau ) , int . press , somerville ,",
    "ma ( 2004 ) ."
  ],
  "abstract_text": [
    "<S> the aim of this paper is to formulate a discrete analog of the claim made by alvarez - gaume et al . , ( @xcite ) , stating that the partition function of the free fermion on a closed riemann surface of genus @xmath0 is certain linear combination of @xmath1 pfaffians of dirac operators . </S>",
    "<S> let @xmath2 be a finite graph embedded in a closed riemann surface @xmath3 of genus @xmath0 , @xmath4 the collection of independent variables associated with each edge @xmath5 of @xmath6 ( collected in one vector variable @xmath7 ) and @xmath8 the set of all @xmath1 spin - structures on @xmath3 . </S>",
    "<S> we introduce @xmath1 rotations @xmath9 and @xmath10 matrices @xmath11 , @xmath12 , of the transitions between the oriented edges of @xmath6 determined by rotations @xmath9 . </S>",
    "<S> we show that the generating function of the even sets of edges of @xmath6 , i.e. , the ising partition function , is a linear combination of the square roots of @xmath1 ihara - selberg functions @xmath13 also called feynman functions . by a result of foata and zeilberger @xmath14 , where @xmath15 is obtained from @xmath11 by replacing some entries by @xmath16 . </S>",
    "<S> each feynman function is thus computable in a polynomial time . </S>",
    "<S> we suggest that in the case of critical embedding and bipartite graph @xmath6 , the feynman functions provide suitable discrete analogues of the pfaffians of dirac operators . </S>"
  ]
}