{
  "article_text": [
    "the ability to detect and identify materials , hidden behind barriers , has potential applications within security and non - destructive testing @xcite .",
    "the thz range of the electromagnetic spectrum is particularly attractive for these applications , because many barrier materials , such as clothing , plastic , and paper only attenuate thz waves moderately , while other materials , such as explosives and related compounds have characteristic spectroscopic fingerprints in the thz region @xcite .",
    "a relevant geometry for these applications is the reflection geometry in which a pulsed or cw signal is sent towards an unknown structure and the amplitude and phase of the reflected signal is detected @xcite .",
    "the task is then to deduce the structure from the measured reflection coefficient .",
    "the situation is simplified in the effectively one - dimensional case , where the electromagnetic properties of the structure only vary in one direction .",
    "retrieval of the structure parameters then becomes a one - dimensional inverse - scattering problem .",
    "however , because the relevant materials are lossy in the thz range , they are also dispersive , according to the kramers  kronig relations .",
    "thus when applying inverse - scattering algorithms to the thz range one must take into account absorption and material dispersion .",
    "there are several formulations and algorithms for the one - dimensional inverse scattering problem @xcite .",
    "in particular , the layer peeling algorithms have turned out to be very efficient , and used in a wide range of applications @xcite .",
    "these algorithms are based on the following , simple fact : consider the time - domain reflection impulse response of a layered structure . by causality ,",
    "the leading edge is only dependent on the first layer , since the wave has not had time to feel the presence of the other layers .",
    "thus one can identify the first layer of the structure from the impulse response .",
    "this information can be used to remove the influence from the layer , which leads to synthetic reflection data with the first layer peeled off .",
    "this procedure can be continued until the complete structure has been identified .    in this work",
    "we generalize the layer - peeling algorithm to dispersive stratified structures . provided",
    "the material dispersion is sufficiently small , such that the time - domain fresnel reflections have durations less than the round - trip time in each layer , we can uniquely reconstruct the refractive indices of the structure ( section ii ) .",
    "the method is illustrated by numerical examples in section iii . finally , in section iv we prove that for larger dispersion , the inverse scattering problem does not have a unique solution in general .",
    "this is because one can not distinguish between the non - instantaneous temporal response of the medium itself ( due to dispersion ) , and the temporal response due to the stratification ( caused by reflections at the layer boundaries ) .",
    "thus , extra information is needed , such as an upper bound for the dispersion combined with a lower bound for the layer thicknesses .",
    "we first describe the model of the stratified medium . consider a layered , planar structure , consisting of @xmath0 layers with refractive indices @xmath1 and thicknesses @xmath2 , see fig .",
    "[ fig : layers ] . here",
    "the index @xmath3 labels the layer .",
    "the light propagation in this structure is conveniently modeled using transfer matrices .",
    "for simplicity we limit the analysis to normal incidence .",
    "the transfer matrix of the transition from refractive index @xmath4 to @xmath5 is @xmath6 where @xmath7 is the fresnel reflection coefficient , associated with the index step between @xmath8 and @xmath9 .",
    "the transfer matrix of the pure propagation in layer @xmath10 is @xmath11 & 0 \\\\ 0 & \\exp[-i\\omega n_j(\\omega)d_j / c ] \\end{bmatrix}},\\ ] ] where @xmath12 is the vacuum light velocity .",
    "note that eqs .",
    "( [ eq : step])-([eq : prop ] ) are also valid when the refractive index is complex .",
    "the refractive index is necessarily complex for dispersive materials , because dispersion is accompanied by loss according to the kramers  kronig relations .",
    "the transfer matrix of the total structure is given by @xmath13 the reflection coefficient @xmath14 from the left , and the transmission coefficient @xmath15 for the electric field from left to right , are given by the ( 2,1)- and ( 2,2)-elements of @xmath16 :    @xmath17     layers .",
    "the thicknesses and refractive indices of the layers are @xmath2 and @xmath1 , respectively.,width=377 ]    we will now describe a layer - peeling method that can be used in the presence of weak dispersion .",
    "the precise condition for the dispersion will become clear below . to be able to reconstruct the structure , we assume that the refractive index @xmath18 of the zeroth layer and the reflection spectrum of the entire structure ( as seen from @xmath19 ) , are known . the goal is to calculate @xmath1 for all @xmath20 and @xmath2 for @xmath21 .",
    "the reflection spectrum of the layered structure can be expressed as follows : @xmath22 where @xmath23 is the impulse response , i.e. , the time - domain reflected field when a dirac delta pulse is incident to the structure .",
    "note the lower limit @xmath24 in the integral : for a non - dispersive layer 0 , the round - trip time to the first index step would be @xmath25 ; however , due to dispersion we can only be sure that the round - trip time is no less than @xmath24 .",
    "we take the forward and backward propagating frequency - domain fields at @xmath19 to be @xmath26 and @xmath14 , respectively , defining the field vector @xmath27 for now we assume that the layer thicknesses @xmath2 are known _ a priori _ ; the case with unknown layer thicknesses is treated below .",
    "the field vector before the beginning of the first layer ( @xmath28 ) is given by @xmath29 we now define the reflection spectrum after the zeroth layer has been `` peeled off '' : @xmath30    the index step at @xmath31 can be regarded as a frequency - dependent reflector with ( unknown ) reflectivity @xmath32 , in accordance with eq . .",
    "we assume that the dispersions of layers 0 and 1 are sufficiently small , such that the time - domain response associated with @xmath32 has duration less than @xmath33",
    ". then we can write @xmath34 where @xmath35 in eq",
    ". the lower limit in the integral reflects the fact that any reflections from the later index steps are delayed by ( at least ) the round - trip time @xmath33 .    having established eq .",
    ", we can now identify @xmath32 : @xmath36 with the local reflection coefficient @xmath32 in hand , we can calculate the refractive index of layer 1 using eq . .",
    "once @xmath37 has been found , we can calculate the reflection spectrum with the first layer removed : @xmath38 now we find ourselves in the same situation as before , so we can continue the process until all layers have been found .    from eq .",
    "one obtains the _ complex _ reflection coefficient of each layer , and therefore , by eq . , both the real and imaginary parts of the refractive index .",
    "one may ask if the reconstructed refractive index automatically is causal , or whether the kramers  kronig relations could be used in addition to ensure causality .",
    "the answer is that the lower limit in the integral ensures that @xmath32 is causal , and therefore by eq . that @xmath37 is analytic in the upper half - plane of complex frequency .",
    "provided @xmath39 as @xmath40 , @xmath37 is therefore guaranteed to be causal @xcite .    in practical situations",
    "the available bandwidth is finite , the layer thicknesses may not be known _ a priori _ , and the reflection data contains noise .",
    "we will now consider these aspects .      in practice",
    ", we only have reflection data in a limited bandwidth @xmath41 .",
    "in other words , the reflection data @xmath42 in eq . is necessarily multiplied by a window function @xmath43 , which is nonzero only in the interval @xmath41 .",
    "physically , this means that instead of probing the structure with a dirac delta pulse , we use an input pulse @xmath44 of duration @xmath45 : @xmath46 we require the duration of the time - domain response associated with @xmath47 to be less than @xmath33 , in order to distinguish between the response due to the first and the other layers .",
    "the time - domain response associated with @xmath32 may already have duration up to @xmath48 , so we must require @xmath49 , or equivalently , @xmath50 .",
    "this must be true for all layers , so @xmath51 where @xmath52 is a lower bound for the ( possibly unknown ) layer thicknesses .",
    "in addition to condition , we recall that the time - domain response associated with @xmath32 must have duration less than @xmath53 , which means that the minimum allowable layer thickness is limited by the narrowest dispersion feature in the structure .",
    "the response @xmath54 ( where @xmath55 denotes convolution ) is no longer guaranteed to vanish for @xmath56 , so we must extend the lower integration limit in eq . to contain the pulse @xmath44 : @xmath57 here",
    "@xmath58 is the `` start position '' of @xmath44 , i.e. , a possibly negative number such that the response from the first layer roughly is contained in the interval @xmath59 $ ] .",
    "eq . leads to the result @xmath47 rather than @xmath32 ; i.e. , the response of the single layer has been filtered with @xmath43 .",
    "thus we must make sure that the bandwidth @xmath60 $ ] of the window function matches that of the dispersion of @xmath37 to be reconstructed .",
    "we will now describe how the layer peeling algorithm also can be used when the layer thicknesses are not known _ a priori_. recall that the time - domain responses associated with @xmath61 have duration less than @xmath62 for all @xmath10 .",
    "starting at a layer boundary , one can then perform layer peeling a distance @xmath63 using eq .",
    ", and calculate the resulting time - domain response .",
    "this removes the effect of the layer boundary , and the first signal in the transformed time - domain response is due to reflection from the next layer boundary .",
    "let @xmath64 denote the start position of this signal and let @xmath58 denote the start position of @xmath44 .",
    "if @xmath65 , this indicates that @xmath63 is less than the layer thickness . define a small thickness @xmath66 , which is sufficiently small to achieve the desired , spatial resolution .",
    "then we can transform the fields successively using eq . with the small thickness @xmath66 until @xmath67 , and we have arrived at an index step .",
    "we can then peel off the dispersive response associated with the index step and search for the next layer boundary , and so forth .",
    "if @xmath43 only is nonzero in the interval @xmath41 , the time - domain responses do not have well - defined fronts , and the procedure above for finding the layer thickness is ambiguous .",
    "however , one can use an alternative definition for the start position of the time domain signals , as shown in the numerical examples .      for any real system",
    "there is a given signal - to - noise ratio , which may be frequency dependent @xcite .",
    "the layer peeling algorithm will fail if the reflection signal at a given index step becomes less than the noise .",
    "this can be due to either low fresnel reflection from the index step itself , or high reflection or material absorption in the preceding part of the structure .",
    "the case with high reflection in the preceding part of the structure was analyzed in ref .",
    "@xcite , and it was shown that the noise amplification factor during the layer peeling algorithm was of the order of @xmath68 where @xmath69 is the minimum power transmission through the structure .",
    "a similar conclusion can be reached by considering the effect of absorption .",
    "let @xmath70 denote the minimum detectable reflection coefficient .",
    "the maximum probing depth , @xmath71 , into a material with a single index step can be estimated by @xmath72\\frac{\\delta n}{2n}\\approx \\varrho,\\ ] ] where @xmath73 is the change in the real part of the refractive index and @xmath74 is the average real part of the refractive index at the step . solving for the the maximum probing depth , we obtain @xmath75 we observe that the maximum probing depth into the structure is inversely proportional to the material absorption . assuming @xmath76 , @xmath77 , @xmath78 , and @xmath79 gives @xmath80 , which corresponds to @xmath81 wavelengths .",
    "this is roughly the maximum depth one can expect the layer peeling algorithm to work for a material with comparatively low loss in the thz - range .",
    "as a first numerical example of the algorithm in sec . [ layerpeelingdisp ]",
    ", we consider a structure consisting of two material layers . we assume vacuum for @xmath82 , a material with refractive index @xmath83 for @xmath84 , and a material with refractive index @xmath85 for @xmath86 .",
    "both materials are assumed to be dispersive and lossy .",
    "the task is to determine @xmath83 , @xmath85 , and @xmath87 , given knowledge of the reflection coefficient at @xmath88 in a finite frequency range .",
    "the refractive index of the first material is assumed to be in the form @xmath89 where @xmath90 is constant , and @xmath91 represents a lorentzian absorption feature , given by @xmath92 we take @xmath93 , @xmath94 , @xmath95 , and @xmath96 for the first material .",
    "here @xmath97 , where @xmath98 is a scaling frequency .",
    "note that @xmath90 must approach @xmath26 as @xmath99 for the refractive index in eq . to be causal .",
    "however , we here use the approximation that @xmath90 is constant in the frequency range @xmath41 and assume that @xmath90 has the correct behavior as @xmath99 .",
    "the refractive index of the second material is also assumed to be in the form eq .",
    "( [ eq : n_mat ] ) , with @xmath93 , but here the susceptibility is taken to be the sum of ten lorentzian absorption features of various amplitudes , bandwidths , and center frequencies , in the vicinity of @xmath100 .",
    "the resulting refractive index is seen in fig .",
    "[ fig:2nd_layer ] . in this example",
    ", we set @xmath101  thz , which leads to the vacuum wavelength @xmath102 mm .",
    "we take @xmath103 , and assume that the reflection coefficient is known in the frequency range 08  thz .",
    "the resulting power reflection coefficient is shown in fig .",
    "[ fig : ref_w ] .    in the layer peeling algorithm , we take @xmath104 . in addition , we must choose an appropriate window function .",
    "the window function should have negligible energy outside the frequency window @xmath60=[-8~\\text{thz } , 8~\\text{thz}]$ ] .",
    "additionally , the corresponding time - domain pulse should have a well - defined front . as a compromise between these two conflicting requirements",
    ", we use a gaussian window function , defined in the time - domain by @xmath105.\\ ] ] the width @xmath106 of the pulse and its central frequency @xmath107 are chosen to match its spectrum to the frequency range where the reflection coefficient is known .",
    "we use @xmath108 ps and @xmath109 , which gives the window function @xmath43 in fig .",
    "[ fig : ref_w ] .",
    "this window function has a small energy outside @xmath60 $ ] .",
    "we here set @xmath110 for @xmath111 in the numerical implementation of the algorithm , in accordance with the assumption that the reflection spectrum outside @xmath60 $ ] is unknown . the lower integration limit in eq .",
    "( [ rho1wprinciple ] ) is set to @xmath112  ps .        .",
    "the incident pulse is given by eq .",
    ", which is the time - domain representation of the window function .",
    "the reflected pulse is given by the convolution of the incident pulse and @xmath113 .",
    "the amplitude of the incident pulse has been scaled a factor 1/10 in the figure.,width=377 ]    figure [ fig : pulses ] shows @xmath44 , which represents the incident pulse used to probe the structure . also shown is the convolution of the incident pulse and @xmath113 , which represents the reflected signal from the structure .",
    "the reflected signal consists of two pulses , where the first pulse is due to reflection at @xmath19 and the second pulse is due to reflection at @xmath114 .",
    "we observe that the duration of the first reflected pulse is similar to the duration of the incident pulse , which is due to the comparatively low dispersion of the first layer . because @xmath115 , there is no problem to correctly retrieve the refractive index of the first layer , as shown in fig .",
    "[ fig:1st_layer ] .",
    ".,width=377 ]    having found the refractive index of the first layer , the next task is to find its thickness , which is done according to the procedure in sec .",
    "[ layerpeelingdisp ] .",
    "however , care must be taken to define the start position of the time domain signals , because they do not have a well - defined front , as discussed in sec .",
    "[ sec : layer_thickness ] . in the numerical implementation of the algorithm",
    "we define the start of the pulse as the first peak in the amplitude , given the amplitude is larger than a certain noise limit . as noted in sec .",
    "[ sec : noise ] , if the amplitude of the second reflected pulse becomes too small , the layer peeling algorithm fails to find the thickness of the first layer .",
    "one can also show that the layer thickness @xmath87 should be determined to within an accuracy of @xmath116 .",
    "an incorrect layer thickness leads to oscillations in the retrieved refractive index @xcite . for the present parameters , the retrieved layer thickness is @xmath117 .",
    "once @xmath87 is found we can \" peel off  the effect of the first layer using eq .",
    "( [ eq : lp ] ) , which means that we transform the reflection coefficient to the position @xmath118 .    .",
    "the amplitude of the incident pulse has been scaled a factor 1/100 in the figure.,width=377 ]    fig .",
    "[ fig : pulses2 ] shows the incident pulse , @xmath44 , and the reflected pulse from the second layer .",
    "the reflected pulse is calculated using the transformed reflection coefficient at the position @xmath118 .",
    "we observe that the duration of the reflected pulse is significantly longer than that of the input pulse , which is due to the narrow dispersion feature of the second layer .",
    "the refractive index of the second layer is determined in the same manner as for the first layer , and the retrieved refractive index is shown in fig .",
    "[ fig:2nd_layer ] .",
    "the error in the retrieved refractive index of the second layer is mainly due to the small inaccuracy in the retrieved @xmath87 .          .",
    "( a ) real part and ( b ) imaginary part of refractive index.,width=377 ]    as noted in sec .",
    "[ layerpeelingdisp ] , the duration of the time - domain response associated with reflection at an index step must be much less than @xmath62 for the layer peeling algorithm to work . if material dispersion is weak , the duration of the time - domain response is mainly given by the duration of the window function @xmath44 .",
    "assuming @xmath108 ps , as in the first example , we must chose @xmath119 for successful retrieval of the refractive index in the first layer . as an example where @xmath63 is marginally too small , we set @xmath120 , with otherwise the same parameters as in the first example .",
    "the retrieved refractive index of the first layer is shown in fig .",
    "[ fig:1st_layer_example1 ] .",
    "we observe that the retrieved refractive index deviates significantly from the exact refractive index . in addition",
    ", the layer peeling algorithm fails to find the correct layer thickness in this case due to the residual time - domain response in @xmath113 caused by incomplete removal of the first layer .           in the presence of noise",
    "the incident pulse ( including the noise ) has been scaled a factor 1/100 in the figure.,width=377 ]        as an example of the influence of noise on the layer peeling algorithm , we consider the same structure as in the first example , but with noise added to the input pulse @xmath44 .",
    "the noise is assumed to be white and gaussian , with mean value 0 , standard deviation @xmath121 , and time @xmath122 between the samples .",
    "the signal to noise ratio is thus proportional to @xmath43 in the frequency domain .",
    "the retrieved refractive index of the first layer is shown in fig .",
    "[ fig:1st_layer_example2 ] .",
    "as expected , the influence of the noise is most severe at high frequencies , where the signal - to noise ratio is small .",
    "we can estimate the maximum probing depth using eq .",
    "( [ eq : noise ] ) .",
    "because the loss is not constant over the frequency range where the reflection coefficient is known , we use the approximate values at @xmath123 thz , where @xmath124 , @xmath125 , and @xmath126 , giving @xmath127 for the maximum layer thickness of the first layer where we can expect the layer peeling algorithm to work .",
    "figure @xmath128 shows the reflected pulse from the second layer , as determined from the layer peeling algorithm , and fig .",
    "@xmath129 shows the retrieved refractive index of the second layer , in the presence of noise .",
    "we observe that the retrieved refractive index is erroneous above 4 thz , which is due to the low signal to noise ratio at increasing frequency .",
    "when the thickness of the first layer becomes much larger than 3@xmath130 , the reconstructed refractive index also becomes inaccurate at lower frequencies .",
    "for the structure with three layers .",
    "the amplitude of the incident pulse has been scaled a factor 1/5 in the figure.,width=377 ]                as a final example , we will consider a structure with three layers , with vacuum for @xmath82 .",
    "the refractive index of the first and third layer is the same as in the first example , and the refractive index of the second layer is 1 .",
    "the thickness of the first and second layer is @xmath131 , with @xmath132 .",
    "we take @xmath133 in the layer peeling algorithm and use the same window function as in the first example .",
    "figure [ fig : ref_w_example_3 ] shows the power reflection coefficient of the structure .",
    "the corresponding time - domain pulses reflected from the structure are shown in fig .",
    "[ fig : pulses_example_3 ] . using the layer peeling algorithm",
    "we retrieve the refractive indices and layer thicknesses of the structure .",
    "the retrieved refractive index of layer 13 are shown in figs .",
    "[ fig:1st_layer_example3]-[fig:3rd_layer_example3 ] , respectively .",
    "we observe that there are errors in the retrieved refractive index at high frequencies .",
    "the errors increase and approach shorter frequencies for the successive layers .",
    "this is due to the unknown reflection coefficient above 8 thz .",
    "because the window function has a small energy above this frequency , the unknown part of the reflection coefficient causes an unphysical precursor to each reflected pulse in the time - domain response .",
    "the errors in retrieved refractive index are here due to the overlap between the main pulse from one layer and the precursor from the pulse reflected from the next layer . for the present parameters ,",
    "this type of error in the retrieved refractive index is strongly reduced if the reflection coefficient is assumed known up to 12 thz instead of 8 thz .",
    "we also find that an incorrect retrieved thickness of the first layer will lead to increasingly large errors in the retrieved refractive indices of the following layers . for the present parameters ,",
    "an error of @xmath134 in @xmath87 leads to large errors in the retrieved @xmath85 and especially @xmath135 .",
    "we will now prove that for dispersive structures , the inverse scattering problem does not have a unique solution in general . to this end",
    ", we consider the fresnel reflection coefficient @xmath32 associated with a _",
    "single _ index step , from @xmath18 to @xmath37 , and prove that this reflection coefficient can also be realized as a lossless and dispersionless structure ; a stack of discrete reflectors in vacuum , or equivalently , a layered structure .",
    "let @xmath136 , @xmath137 , @xmath138 be the reflection coefficients of the discrete reflectors , and @xmath66 the distance between the reflectors .",
    "we choose @xmath139 in accordance with the considered bandwidth , from @xmath140 to @xmath141 .",
    "initially we set @xmath142 . by causality @xmath143 for a real time - domain response @xmath144 .",
    "we now discretize the continuous response @xmath144 , leading to @xmath145 $ ] : @xmath146\\exp(i\\omega j2\\delta / c ) \\label{rho1principle3}\\ ] ] in the bandwidth @xmath147 .",
    "if @xmath148 were zero outside this bandwidth , the nyquist sampling theorem would immediately give the connection between @xmath145 $ ] and @xmath149 .",
    "in general , however , the exact relation is found by extending @xmath148 to a periodic function with period @xmath150 , and setting @xmath145 $ ] equal to the associated fourier coefficients . with this procedure ,",
    "would be identical in the relevant bandwidth , however with lower limit @xmath151 in the sum . setting the lower limit to 0 amounts to finding the optimal causal and discrete approximation to expression . in the limit where @xmath148 vanishes for @xmath152 , the error in the approximation tends to zero .",
    "assuming that the discrete response @xmath145 $ ] is the reflection from a stack of discrete , lossless reflectors , we can perform layer peeling identifying the reflectors . by causality the first reflector is given by @xmath153 .",
    "\\label{firstrefl}\\ ] ] note that the reflector @xmath136 is real , since the time - domain response @xmath144 , and therefore @xmath145 $ ] , is real : @xmath144 is a physical time - domain response as resulting from a real impulse . peeling off this reflector , and removing the subsequent pure propagation in the layer with thickness @xmath66 , can be done with the associated transfer matrices , or equivalently , by applying the schur recursion formula @xcite @xmath154 the layer peeling process can be continued until all reflectors have been found .    in other words ,",
    "two different structures give the same reflection response @xmath32 ; an index step between @xmath18 and @xmath37 , and several layers with non - dispersive , real refractive indices . to be able to solve the inverse scattering problem of a dispersive structure , it is therefore apparent that extra information ( in addition to the reflection spectrum ) must be known . in sec .",
    "[ layerpeelingdisp ] we used the extra information that the dispersion is sufficiently small , such that the time - domain response associated with each fresnel reflection has duration less than the round - trip time to the next index step .",
    "in addition we assumed @xmath155 for all @xmath10 .",
    "an inverse scattering algorithm is applied to retrieve the material parameters of stratified structures . even though this problem does not have a unique solution in general , there exist cases where the algorithm can be applied , given additional information about the structure .",
    "specifically , for a given , lower bound of the layer thicknesses , the dispersion must be sufficiently small , and the frequency range where the reflection coefficient is known must be sufficiently large .",
    "the retrieval of material parameters of hidden layers is challenging due to absorption , noise , and unknown layer thicknesses . despite these challenges , there exist cases where the algorithm is successful , as illustrated by the numerical examples .",
    "a.  boutet  de monvel and v.  marchenko , `` new inverse spectral problem and its application , '' in `` inverse and algebraic quantum scattering theory ( lake balaton , 1996 ) , '' , vol .",
    "488 of _ lecture notes in phys . _",
    "( springer , berlin , 1997 ) , pp . 112 ."
  ],
  "abstract_text": [
    "<S> we consider the inverse scattering problem of retrieving the structural parameters of a stratified medium consisting of dispersive materials , given knowledge of the complex reflection coefficient in a finite frequency range . </S>",
    "<S> it is shown that the inverse scattering problem does not have a unique solution in general . </S>",
    "<S> when the dispersion is sufficiently small , such that the time - domain fresnel reflections have durations less than the round - trip time in the layers , the solution is unique and can be found by layer peeling . </S>",
    "<S> numerical examples with dispersive and lossy media are given , demonstrating the usefulness of the method for e.g. thz technology . </S>"
  ]
}