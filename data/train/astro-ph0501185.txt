{
  "article_text": [
    "discs are ubiquitous objects in the universe and span different velocity / length scales : galactic ( stellar ) discs , active galactic nuclei discs , circumstellar discs , binary and circum - binary discs , sub - nebulae . for many of them ,",
    "self - gravity plays role in their structure and dynamics and so , the gravitational potential and associated accelerations are required at a certain level of disc modeling . solving the poisson equation in _ extended , continuous media _ like",
    "gas discs is however not trivial practically , and it has occupied astrophysicists for many decades . for time - dependent simulations , fast but low accuracy algorithms are generally preferred . for steady state analysis , accuracy is more critical than computing time , as it allows for instance to characterize the precise connection between various branches of solutions ( e.g. hachisu 1986 , ansorg , kleinwchter & meinel 2003 ) .",
    "many numerical methods have been proposed , but a very few uses the integral formalism . in a previous paper ( pierens & hur 2004 ; hereafter paper i ) , we have outlined a method to avoid the singularity in the poisson kernel so that the field in the plane of razor - thin , axially symmetric discs can easily be accurately computed from elliptic integrals by a single radial quadrature .",
    "the motivation of the present paper is twofold .",
    "first , paper i just touches the problem at the theoretical level without giving numerical examples and discussing the implementation and possible performances of the method .",
    "also , the potential was not considered .",
    "this is done here .",
    "second , we have recently realized that the classical fft - method ( e.g. binney & tremaine 1987 ) which is among the most widespread methods , have a much lower precision and lower order of convergence , in comparison .",
    "we show actually here that the density splitting method can exhibit a high convergence order , depending on the quadrature rule , and the precision can easily reach the machine precision with a few tens sources points , at least for smooth surface density profiles .",
    "we outline the splitting method for the gravitational potential and radial field in section 2 .",
    "we then stress the non - derivability of poisson kernels in section 3 , and propose a space mapping . in section 4 ,",
    "we illustrate the possible performances of the method on a test - case ( namely , a finite size disc with exponentially decreasing surface density profile ) , with three different quadrature rules .",
    "we compare the accuracy of the method with the classical fft - method in section 5 . a few concluding remarks are found in the last section .",
    "the gravitational potential @xmath1 and radial component of the field @xmath2 in the plane of a razor thin axially symmetric disc ( see fig . [ fig : config ] ) is ( e.g. durand 1964 ) : @xmath3 where @xmath4 is the inner edge , @xmath5 is the outer edge , @xmath6 is the surface density , @xmath7 \\end{pmatrix } , \\label{eq : psig2}\\ ] ] are the poisson kernels , @xmath8 and @xmath9 denote the complete elliptic integral of the first and second kinds respectively , @xmath10 is their modulus , and @xmath11 . as it is well known , these kernels diverges when @xmath12 , with the result that , in practice , neither @xmath1 nor @xmath13 can properly be determined by direct integration for @xmath14 $ ] . as outlined in pierens & hur ( 2004 ) ( hereafter paper i ) , such a singular behavior can be avoided if the surface density profile is split into two components according to @xmath15 where @xmath16 is the local value , and @xmath17 is the remainder ( a function which depends on @xmath18 and @xmath19 ) . consequently , the potential and the radial field in the disc are given by @xmath20 where @xmath21 and @xmath22 are analytical functions ( proportional to @xmath23 ; see appendix a in paper i for the field , and appendix a in this paper for the potential ) .",
    "terms @xmath24 and @xmath25 correspond to the departure from the homogeneous disc .",
    "these are simply given by @xmath26    the point is that both @xmath27 and @xmath28 are finite when @xmath29 , although @xmath30 and @xmath31 ( see appendix b in paper i for a proof ) , with @xmath32 note that , in this procedure , the radial derivative of the surface density @xmath33 is needed at each field point when computing @xmath25 from eq.([eq : psig ] ) .",
    "this is quite uncomfortable if the surface density is not defined analytically , but on a grid as in many simulations .",
    "accuracy of residual terms is set by the scheme performing the numerical quadrature , provided the integrand is a well - behaved function . in the present problem ,",
    "a difficulty arises because the residual integrands @xmath35 and @xmath28 are continuous , but not c@xmath34-class functions ( i.e. differentiable for all degrees of differentiation ) . even , these are non - derivable ( i.e. not c@xmath36 ) .",
    "this is easily understood from the first derivative @xmath37 where @xmath38 denotes either @xmath39 or @xmath40 , @xmath41 and @xmath42    we see that the first term in the right - hand - side of eq.([eq : dsk ] ) brings a diverging contribution for @xmath29 since @xmath43 can not be zero on the whole integration range .",
    "we thus have @xmath44 at the field point .",
    "this point is illustrated in fig .",
    "[ fig : inftyder ] which displays the function @xmath45 for both the potential and field as well as their first derivative in a disc with exponentially decreasing surface density profile . although not visible at the scale of the graphs , there is a small `` knee '' just at the field point where the first derivatives are infinite .",
    "further , because successive derivatives of elliptic integrals _ inevitably _ produce the @xmath8-function which is logarithmically diverging as @xmath12 , we conclude that @xmath46    lcc @xmath47th ( function ) & @xmath47 & @xmath48 + @xmath49st derivative & @xmath50 & @xmath50 + @xmath51nd & @xmath50 & @xmath50 + [ tab : deriva ]    ccc @xmath47th ( function ) & @xmath47 & @xmath47 + @xmath49st derivative & @xmath47 & @xmath52 + @xmath53nd derivative & @xmath47 & @xmath50 + @xmath54rd derivative & @xmath50 & @xmath50 + @xmath55th&@xmath50 & @xmath50 + [ tab : derivw ]    values of the integrands @xmath45 and its @xmath18-derivatives at @xmath29 are summarized in tab . [",
    "tab : deriva ] .",
    "it means that , if residuals terms are numerically determined following eq.([eq : psig ] ) ( i.e. by integration in the @xmath18-space ) , then most classical quadrature rules which are based on a certain fitting of the integrand by polynomials can not behave in an optimal manner .",
    "this problem especially concerns high - order quadrature rules .",
    "we have no idea how to totally remove such a difficulty .",
    "it is possible however to reduce it partially by re - sampling the integrand in an appropriate way .",
    "for instance , if we consider the function @xmath56 defined by @xmath57 then eq.([eq : psig ] ) now reads @xmath58 where @xmath59 and @xmath60 .",
    "the `` new integrands '' @xmath61 and @xmath62 are obviously regarded as a function of the new variable @xmath63 .",
    "the advantage of this space mapping is twofold .",
    "first , it makes the first derivative finite ; @xmath63-derivatives of the new integrands are summarized in tab . [ tab : derivw ] ( see appendix b for a detailed calculus ) .",
    "figure [ fig : inftyderdw ] displays the first , second and third derivatives , in the same conditions as for fig . [",
    "fig : inftyder ] .",
    "second , @xmath62 vanishes at the field point ( since @xmath64 ) .",
    "hence , @xmath65 is not more needed .",
    "we briefly show the possible performances of the method through a typical example , namely a disc with @xmath66 = [ 0,1]$ ] and an exponentially decreasing surface density profile , as already considered above .",
    "tests have concerned a large amount of disc models ( various surface density profile , various axis ratios @xmath67 ) . for simplicity",
    ", we shall discuss only the potential ; results for the field are similar .",
    "we consider three different schemes to determine @xmath24 at various radii @xmath19 inside the disc from eq.([eq : psigdw ] ) , namely :    * the composite trapezoidal rule ( hereafter , the ct - rule ) , with @xmath68 source points .",
    "this is a 2nd - order accurate scheme ( e.g. press et al .",
    "* a @xmath69th - order , regular - spacing quadrature rule due to gill & miller ( 1972 ) , with @xmath68 source points ( hereafter , the gm - rule ) . * the gauss - chebycheff - lobatto approximation ( hereafter , the gcl - rule ) , with @xmath68 chebycheff polynomials . this collocation method would be the most efficient technique ( with a spectral convergence ) in the presence of a c@xmath34-class integrand ( e.g. boyd 2001 ) .",
    "we measure the relative precision @xmath70 on potential values @xmath1 with the @xmath71-parameter defined as @xmath72 where @xmath73 is the reference value .",
    "since the exact potential is not known for the case considered , reference values @xmath73 are obtained by considering a larger number of source points , as commonly done ( e.g. cohl & tohline 1999 ) .",
    "we use double precision ( dp ) computer calculus so that the precision is limited to @xmath74 ( that is @xmath75 ) .",
    "figure [ fig : errors ] gives the results of the splitting method , namely @xmath76 versus @xmath68 for the three quadrature rules listed above , where @xmath76 is an averaged value , obtained by computing @xmath1 at @xmath77 equally spaced positions spanning the range @xmath66 $ ] ( the actual number of field point is unimportant ) . we see that the accuracy on the potential reaches the computer precision for less than a thousand source point with the gm - rule , and for only a hundred spectral coefficients for the gcl - rule .",
    "note that the relative precision is better than @xmath78 with the ct - rule for a dozen source points only , which is remarkable .",
    "also , we observe that the gcl method does not exhibit a spectral convergence , for reasons mentioned above but appears very efficient . indeed",
    ", these performances are noticeably reduced if quadratures are performed in the @xmath18-space .",
    "it is interesting to compare the accuracy of the density splitting method with that of the classical fft method ( e.g binney & tremaine 1987 ) based on @xmath79 polar cells .",
    "results obtained on the same test - model are reported on fig .",
    "[ fig : errors ] as open and filled circles ( see below ) .",
    "we see that the precision is rather poor even for large @xmath68 , and is definitively lower than that of the splitting method with the ct - rule .",
    "let us remind that the fft - method is probably the most widely method used in simulations of self - gravitating discs to compute the gravitational potential ( binney & tremaine 1987 ) .",
    "the only advantage of the fft - method seems to be its great rapidity , @xmath80 order in time .",
    "low computing time is a fundamental requirement if the poisson equation is to be coupled with other equations , as it is the case in general .",
    "one must however realize that the fft - method has a few major drawbacks .",
    "first , it is first - order accurate , as can be seen in fig .",
    "[ fig : errors ] , that is , one order less than the splitting method with the ct - rule .",
    "this means that a huge amount of source / grid points is required before reaching great accuracy .",
    "if we extrapolate data shown in the plot ( and ignoring loss of significance and round - off errors that would impose a saturation of @xmath76 well above @xmath81 ) , we find that the fft - method would need @xmath82 to reach the computer precision ( that is , @xmath83 polar cells ) .",
    "second , it is a particle - type method ( e.g. hockney & eastwood 1988 ) : each cell is made homogeneous , and converted into a particle with arbitrary assignment of both location and mass density .",
    "the precision of the fft - method is apparent and fortunate ( assignment errors almost cancel or compensate ) .",
    "third , the use of the fft - method in cylindrical coordinates requires a logarithmic spacing of grid points .",
    "this means that i ) the origin can not be included , ii ) the outer disc has always a much lower resolution than the inner disc ( by a factor @xmath68 ) , and iii ) many interpolations are necessary when other equations are solved on a different grid ( one has to pass from one grid to the other ) .",
    "it is true that matter in astrophysical discs is generally concentrated at the inner edge , but disc self - gravity concerns regions rather located near the outer edge .",
    "[ fig : errorsfft ] shows @xmath71 versus @xmath19 for @xmath84 in the example considered before .",
    "we see that the accuracy is better in the inner disc than in the outer disc with the fft - method , whereas it is uniform with the density splitting method ( whatever the quadrature rule ) .",
    "fourth , the local contribution to the gravitational potential ( that is the contribution of the cell containing the field point @xmath19 ) is treated in an artificial way . in this purpose , a smoothing length @xmath85 is often introduced , and its value is chosen arbitrarily .",
    "results obtained for @xmath86 are shown in fig .",
    "[ fig : errors ] ( open circles ) . hence , potential values are smoothing length - dependent .",
    "a slightly better accuracy is obtained with the prescription by binney & tremaine ( 1987 ) ( filled circles in fig .",
    "[ fig : errors ] ) , where the local contribution is estimated analytically , without any @xmath85 .",
    "however , as some authors have noticed ( e.g. caunt & tagger 2001 ) , the fft - method can trigger numerical instabilities in hydrodynamic codes , probably because the order of this method is lower ( and errors larger ) than the order ( generally two ) of difference schemes used in other fluid equations .",
    "in this paper , we have discussed the possible implementation and performances of the splitting method for razor - thin , axially symmetric discs . in particular , we have emphasized the role of a space mapping in order to rise the accuracy ( or effective order ) of advanced quadrature rules .",
    "we have noticed the important weaknesses of the classical fft - methods , especially in terms of accuracy , by direct comparisons .",
    "obviously , our method is characterized by much longer computing times .",
    "note however that a few grid points are necessary to reach a high precision .",
    "besides , the method is easily parallelizable .    several extensions and improvements to the present method could be brought .",
    "for instance , other space mapping than proposed can probably work well .",
    "however , it is hard to find a sampling function that makes the integrands and derivatives finite ( and possibly zero ) at the field point without increasing its wings , which is numerically uncomfortable ( for instance , this can easily be shown with a @xmath63-function of the form @xmath87 for large @xmath88 ) .",
    "besides , depending on the global surface density profile in the disc , it can be more appropriate to replace the homogeneous contribution ( see sect .",
    "2 ) by an another analytical contribution ( for instance @xmath89 instead of a constant as done here , provided kernels can be integrated ) . finally , the method can easily be extended to treat non - axially symmetrical systems ( pierens & hur 2005 ) , and even tri - dimensional mass distributions .",
    "we plan to open soon to the scientific community an internet site devoted to this question",
    ".    the splitting method should be useful in many problems where great accuracy is needed and/or fine physical effects must be investigated .",
    "for instance , we believe that significant progresses could be made in numerical simulations of planetary migrations which do show a great sensitivity to the field and potential values , even for low mass discs ( e.g. nelson & benz 2003 ) .",
    "we thank the referee for valuable comments .",
    "ansorg , m. , kleinw \" achter , a. , & meinel , r.  2003a , mnras , 339 , 515    binney , j.  & tremaine , s.  1987 , princeton , nj , princeton university press , 1987 , 747    boyd j.p . , 2001 , in _ chebyshev and fourier spectram methods _ , second edition , dover , new york    caunt , s.  e.  & tagger , m.  2001 , , 367 , 1095    cohl , h.  s.  & tohline , j.  e.  1999 , , 527 , 86    durand e. , 1964 , in _",
    "`` electrostatique i. les distributions '' _ , masson ed .",
    "gill , p.e . & miller , g.f .",
    ", 1972 , comput .",
    "j. , 80    gradshteyn , i.  s.  & ryzhik , i.  m.  1980 , new york : academic press , 1980 .",
    "hockney , r.  w.  & eastwood , j.  w.  1988 , bristol : hilger , 1988 ,    hachisu , i.  1986 , apjs , 62 , 46    nelson , a.  f.  & benz , w.  2003 , , 589 , 578    pierens , a.  & hur ' e , j.  2004 , , 605 , 179    pierens a. , & hur j.m .",
    ", 2005 , in preparation    press , w.  h. , teukolsky , s.  a. , vetterling , w.  t. , & flannery , b.  p.  1992 , in _ numerical recipes in fortran . the art of scientific computing _ , cambridge : university press , |c1992 , 2nd ed . ,",
    "according to notation , the general expression for the potential in the equatorial plane of a disc with inner edge @xmath4 and @xmath5 is ( e.g durand , 1964 ) : @xmath90    for a constant surface density @xmath23 , eq.([eq : potential ] ) reads @xmath91 for @xmath92 , we separate this integral into two integrals , leftward and rightward to the fieldpoint where @xmath93 , namely @xmath94\\ ] ] we now set @xmath95 in the first integral and @xmath96 in the second one . with the gauss transformation (",
    "gradshteyn & ryzbik 1980 ) @xmath97 eq.([eq : potential2 ] ) becomes @xmath98 and so @xmath99\\ ] ]",
    "from eq.([eq : w ] ) , we have @xmath100"
  ],
  "abstract_text": [
    "<S> we demonstrate the high accuracy of the density splitting method to compute the gravitational potential and field in the plane of razor - thin , axially symmetric discs , as preliminarily outlined in pierens & hur ( 2004 ) . </S>",
    "<S> because residual kernels in poisson integrals are not @xmath0-class functions , we use a dynamical space mapping in order to increase the efficiency of advanced quadrature schemes . in terms of accuracy , results are better by orders of magnitude than for the classical fft - methods . </S>"
  ]
}