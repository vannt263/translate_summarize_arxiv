{
  "article_text": [
    "the development of statistical methods for studying phylogenetic trees , and in particular the search for meaningful notions of consensus tree for phylogenetic data , has been of considerable importance in biology for four decades .",
    "starting with the problem as posed by adams  @xcite , a great deal of research has been done , and a myriad of definitions proposed , relating to consensus trees in phylogenetics ; see @xcite for an excellent overview .",
    "the problem has been confounded by the combinatorial nature of the trees themselves . according to cranston and rannala @xcite , `` phylogenetic inference has long been troubled by the difficulty of performing statistical analysis on tree topologies .",
    "the topologies are discrete , categorical , and non - nested hypotheses about the species relationships .",
    "they are not amenable to standard summary analyses such as the calculation of means and variances and cause difficulties for many traditional forms of hypothesis testing . ''",
    "other papers share concerns about issues such as these @xcite .",
    "the introduction by billera , holmes , and vogtmann of phylogenetic tree space @xcite opened statistical analysis of tree - like data to a wide and computationally tractable variety of techniques @xcite .",
    "tree space , with its geodesic distance , is a _ globally nonpositively curved _ ( abbreviated to _ global npc _ ) space , and as a result it has convexity properties that imply uniqueness of means as well as other important statistical and geometric objects , while also giving a framework for effective computational methods to calculate these objects .",
    "one of the major uses of the convexity properties was the discovery by owen and provan  @xcite of a fast algorithm for computing geodesics in this space ( see section  [ s : treespace ] for this algorithm as well as the background tree space geometry necessary to state it ) .",
    "chakerian and holmes @xcite subsequently showed that phylogenetic tree space provides an excellent platform for implementing several distance - based statistical techniques , and nye @xcite has shown how this space can be used to perform principal component analysis on tree data .",
    "perhaps the two most fundamental concepts of interest in statistical analysis of data are that of _ sample mean _ ( or _ average _ ) and its associated _ variance_. the basic goal of this paper is to demonstrate the computational effectiveness of certain notions of statistical mean and variance for probability distributions on tree space .",
    "the average that we use is the _ frchet mean _ , or _ barycenter _ : the point in tree space that minimizes its sum of squared geodesic distances to the sample points ( section  [ s : mean ] ) .",
    "our decision to use this definition is motivated by work of sturm  @xcite , who identified the frchet mean as a theoretically rich statistical object associated with sampling from a specified distribution on a global npc space ( see theorem  [ t : sturmpoints ] ) .",
    "frchet means in tree space and the algorithm for computing them that arises from sturm s work ( algorithm  [ a : sturm ] ) have been independently developed  by  bak  @xcite .",
    "our principal theoretical contribution lies in the discovery of polyhedral structure governing the variation of geodesics in tree space as one endpoint varies ( section  [ s : vistal ] ) . to be more precise ,",
    "if @xmath1 is a fixed point in tree space , then in appropriate coordinates on tree space , the set of points whose geodesics to  @xmath1 share the same combinatorics comprise a convex polyhedral cone called a _ vistal cell _",
    "( theorem  [ t : vistal_face_combinatorics ] ) , and the vistal cells constitute a polyhedral subdivision of tree space ( theorem  [ t : cell_complex ] ) .",
    "metric combinatorics _ also arises in single source shortest path queries ( see @xcite for a survey ) , and has direct roots in surprisingly similar statements for boundaries of convex polyhedra @xcite , the parallel being unexpected because boundaries of convex polyhedra are positively curved , in contrast to the negative curvature of tree space .",
    "however , polyhedrality of the subdivision is generally not encountered outside of the planar or positively curved cases , and thus is completely unexpected here ; see example  [ e:4dim ] for a hint of the complexity that can occur even for global npc cubical complexes .",
    "metric combinatorics of tree space , particularly its polyhedral nature , combines with generalities on nonlinear optimization in npc spaces to give a second iterative method converging to the mean ( algorithm  [ a : descent ] ) via descent procedures .",
    "the crucial observations are that the variance function has a unique local minimum on tree space , is continuously differentiable on each euclidean orthant in tree space , and has a simple algebraic formula within the interior of each  vistal  cell",
    ".    means in tree space have subtle , sometimes peculiar properties that inform our particular motivations ( section  [ s : apps ] ) , which come primarily from biological and medical applications , although we expect these observations to impact other fields where distributions of metric trees naturally appear .",
    "evolutionary biology , for instance , considers actual phylogenetic trees , each representing a putative evolutionary history of a set species or genes ( example  [ e : gene ] ) . in medical imaging",
    ", trees can represent blood vessels in human brain scans @xcite or lung airway trees @xcite",
    ", for example .",
    "some of the theory in sections  [ s : treespace][s : computing ] extends to arbitrary global npc spaces , and all of it extends to global npc orthant spaces ( section  [ s : npc ] ) . for the first iterative procedure ( algorithm  [ a : sturm ] ) and",
    "the rest of section  [ s : mean ] , as well as for the shortest path combinatorics in section  [ s : treespace ] , this means working in arbitrary global npc spaces ( sections  [ ss : geomnpc][ss : npcmean ] ) . for the second iterative procedure ( algorithm  [ a : descent ] ) and the rest of section  [ s : computing ] , as well as for the metric combinatorics in section  [ s : vistal ] ,",
    "this means working in piecewise euclidean global npc spaces that are formed by gluing orthants together by rules similar to but substantially more general than those defining tree space ( section  [ sub : orthant ] ) .",
    "the extensions suggest exciting new research in applying both statistical methods and numerical nonlinear programming techniques to a wide variety of problems . *",
    "important note : * readers interested in the generality of abstract orthant spaces or arbitrary npc spaces are urged to begin with section  [ s : npc ] , which sets up the notation and concepts in sections  [ s : treespace][s : computing ] from that perspective .",
    "hence such readers can avoid checking the proofs in the earlier sections twice .",
    "[ [ acknowledgements ] ] acknowledgements + + + + + + + + + + + + + + + +    our thanks go to michael turelli and elen oneal for help with references and discussions on biological applications , to antonis rokas for kindly providing the yeast data set , and to dennis barden for comments on a draft of the paper .",
    "em had support from nsf grants dms-0449102 = dms-1014112 and dms-1001437 .",
    "mo was partially supported by a desjardins postdoctoral fellowship in mathematical biology at university of california berkeley and by the u.s .",
    "national science foundation under grant dms-0635449 to the statistical and applied mathematical sciences institute ( samsi ) .",
    "much of this research was facilitated by and carried out at samsi as an outgrowth of the 20082009 program on algebraic methods in systems biology and  statistics .",
    "in this section , we describe the space of phylogenetic trees introduced by billera , holmes , and vogtmann  @xcite , as well as a distance and characterization of geodesics in this space .",
    "a _ phylogenetic @xmath2-tree _",
    "@xmath1 , or simply an _ @xmath2-tree _ , is an acyclic graph @xmath1 with edge set @xmath3 whose leaves ( degree 1 nodes ) are labeled with index set @xmath4 , and whose interior vertices have degree at least 3 .",
    "( the label 0 is often referred to as the _ root _ of @xmath1 , although that is not relevant in this paper . )",
    "the maximum number of edges in an @xmath2-tree is @xmath5 .",
    "each edge @xmath6 of @xmath1 is assigned a nonnegative _ length _",
    "@xmath7 , or @xmath8 in case the ambient tree is clear .",
    "removal of any edge @xmath6 from @xmath1 determines a unique partition of the leaves of @xmath1 into two subsets @xmath9 and @xmath10 ; the pair @xmath11 is called the _ split _ associated with @xmath6 .",
    "a key property of splits in trees is that the splits @xmath11 and @xmath12 of any pair of edges @xmath6 and @xmath13 are _ compatible _ , that is , one of the sets @xmath14 , @xmath15 , @xmath16 , or @xmath17 is empty .",
    "a set @xmath18 of splits is called _ compatible _ if every pair of splits in @xmath18 is compatible .",
    "it turns out ( * ? ? ?",
    "* theorem  3.1.4 ) that any compatible set of splits on @xmath19 corresponds to a unique tree , and so from now on we identify a tree @xmath1 by simply giving the splits and edge lengths for each edge in  @xmath1 .",
    "a tree @xmath1 can have an edge @xmath6 whose associated length @xmath7 is  @xmath20 .",
    "this corresponds to the edge @xmath6 having been _ contracted _ in  @xmath1 .",
    "denoting the set of edges of  @xmath1 with nonzero length by  @xmath21 allows the identification @xmath22 between two trees @xmath1 and  @xmath23 whenever ( i )  @xmath24 and ( ii )  their nonzero edge lengths are equal .",
    "[ e : tree_examples ] two 5-trees are depicted in figure  [ f : tree_examples ] . for simplicity",
    ", we only give the splits and edge lengths for the three internal edges in each tree .",
    "the six internal edges are distinct since they have different splits , and the splits within each tree are compatible .",
    "the only compatible pairs between the two trees , however , are @xmath25 , @xmath26 , and @xmath27 .     +    the _ tree space _ @xmath28 introduced by billera , holmes , and vogtmann  @xcite is the space of all phylogenetic @xmath2-trees .",
    "it is obtained by representing each tree @xmath29 on edge set @xmath30 by a vector in the euclidean _ orthant _ @xmath31 , whose coordinate values are equal to the corresponding lengths of the edges of @xmath1 . as above , trees @xmath1 and @xmath23 are identified between orthants whenever the associated trees satisfy @xmath32 .",
    "this makes @xmath28 a union of @xmath33-dimensional orthants called _ maximal _ orthants whose interiors are disjoint and which are identified along their boundaries through the equivalence @xmath34 given above .",
    "a _ path _ in @xmath28 is the image of a continuous map @xmath35",
    "\\to { \\mathcal{t}}_n$ ] . the _ euclidean length _ of a path in @xmath28 is the sum of the euclidean lengths of its restrictions to the maximal orthants .",
    "this length endows @xmath28 with the metric  @xmath36 in which @xmath37 is the infimum of the euclidean lengths of the paths from @xmath1 to  @xmath23 .",
    "note that @xmath38 , since the space @xmath28 is path - connected : any two points can be joined by straight line segments through the origin .",
    "billera , holmes , and vogtmann @xcite show that tree space is _ globally non - positively curved _",
    "( a _ global npc _ space ) , equivalently known in this context as _",
    "cat(0)_. among other things , this implies that shortest paths in tree space are unique , so they are unambiguously referred to as _",
    "geodesics_. this section summarizes the key results of @xcite and @xcite , which investigate the structure of geodesics in tree space and provide an @xmath39-algorithm the _ gtp algorithm _ to find shortest paths . for notation , if @xmath1 is a tree with edge set  @xmath30 and @xmath40 , then we write @xmath41 and use @xmath42 if the tree @xmath1 is clear .",
    "this means that @xmath43 whenever @xmath44 .",
    "we express a geodesic with endpoints @xmath45 and @xmath1 as a parameterized curve @xmath46 \\to { \\mathcal{t}}_n$ ] with @xmath47 , @xmath48 , and @xmath49 for all @xmath50 $ ] .",
    "if an edge @xmath6 lies in both @xmath45 and  @xmath1 , then it lies in every tree on the path @xmath51 , with length uniformly changing between the two terminal values ( * ? ? ?",
    "* section  4.2 ) .",
    "we therefore focus first on the case when @xmath45 and @xmath1 have no internal edges in common , and ignore the lengths of the _ pendant _ edges ( those containing leaves ) in the distance computation .",
    "each geodesic in tree space is a sequence of straight line segments , called _ legs _ , because tree space is piecewise euclidean .",
    "each leg is contained within a single orthant @xmath52 , where @xmath53 and @xmath54 .",
    "the precise properties of the sets @xmath55 and @xmath56 making up these legs were determined in @xcite . in particular , define the _ support _ @xmath57 of a geodesic @xmath51 to consist of a pair consisting of a partition @xmath58 of @xmath59 and a partition @xmath60 of @xmath61 such that the following property holds :    1 .   for each @xmath62 ,",
    "the union @xmath63 is compatible .",
    "the geodesic @xmath51 has legs in @xmath52 , where @xmath64 the individual pairs @xmath65 are the _ support pairs _ for the geodesic .    whether the shortest piecewise - linear path having these legs actually forms the geodesic between @xmath45 and @xmath1 is determined by the following two properties for @xmath66 .",
    "1 .   @xmath67 .",
    "this is called the _",
    "ratio sequence _ for @xmath66 .",
    "2 .   for all @xmath68 and partitions @xmath69 of @xmath70 and @xmath71 of @xmath72 such that @xmath73 is compatible",
    ", the inequality @xmath74 holds .    the properties ( p1)(p3 ) determine the geodesic between @xmath45 and @xmath1 , as well as the algebraic description of this geodesic given in theorem 2.4 in @xcite .",
    "the case where @xmath45 and @xmath1 have a nonempty set  @xmath75 of common edges was addressed in ( * ? ? ?",
    "* section  4 ) : remove the common edges between @xmath45 and @xmath1 from each tree , and then find the paths between the remaining disjoint forests , matching trees by their leaf sets .",
    "the common edges are then placed into the path with the length of each such edge being @xmath76 this also allows pendant edges to be taken into account .    to be able to work more easily with trees having common edges , we extend theorem  2.4 in @xcite to the case where @xmath45 and @xmath1 have common edges , and in the process simplify the description of the geodesic considerably . to do this , we use the following three important conventions .    1 .",
    "an edge is never compatible with itself ; thus the pairs of identical edges in @xmath45 and  @xmath1 must appear in the same support pair  @xmath77 .",
    "2 .   @xmath78 for any set @xmath70 of edges of @xmath45 in common with @xmath1 .",
    "3 .   we extend the notation for support pair by adding the additional sets @xmath79 and define @xmath80 and @xmath81 .",
    "with these conventions we can restate the unified result .",
    "[ t : prelimthm ] let @xmath45 and @xmath1 be any two trees in @xmath28 ( not necessarily disjoint ) , and let @xmath66 be a support for @xmath45 and @xmath1 satisfying ( p2 ) and ( p3 ) .",
    "the unique geodesic @xmath82 from @xmath45 to  @xmath1 has legs @xmath83 the points on each leg @xmath84 are associated with the tree @xmath85 having edge set @xmath86 and edge lengths @xmath87      \\frac{{\\textstyle}\\lambda{\\lvertb_j\\rvert}-(1-\\lambda){\\lverta_j\\rvert}}{{\\textstyle}{\\lvertb_j\\rvert}}|e|_t      &      \\text{if } e\\in b_j .",
    "\\end{array}\\right.\\ ] ] the length of @xmath51 is @xmath88    the presentation in this theorem matches that of the original theorem  2.4 in @xcite except for the treatment of the common edges of @xmath45 and @xmath1 . consider any edge @xmath6 common to @xmath45 and @xmath1 .",
    "the definition of a support ensures that @xmath6 lies in both @xmath70 and @xmath72 for some @xmath89 .",
    "further , by convention the ratio @xmath90 is negative , so ( p2 ) is never satisfied unless all of the common edges are placed at the front of the ratio sequence .",
    "this also means that for any @xmath91 , each common edge is contained in some @xmath72 for the computation of its edge length at that point along the geodesic .",
    "furthermore , since the common edges are mutually compatible with each other , they are placed in different support pairs whenever the ratios @xmath92 differ .",
    "it follows that the common edges are always grouped in support pairs @xmath65 having @xmath93 for any @xmath6 in that support pair .",
    "now consider the length of a common edge @xmath6 in leg @xmath84 of the path . by",
    "( [ eq : edgelength2 ] ) , @xmath94 which matches ( [ eq : common_edges ] ) .",
    "next look at the term in  ( [ eq : pathlength2 ] ) corresponding to a support pair @xmath65 of common edges : @xmath95 summing this over all such pairs @xmath65 yields @xmath96 where @xmath75 is the set of common edges .",
    "this matches the expression given in ( * ? ? ?",
    "* section  4 ) .",
    "finally , take the case where an edge @xmath6 lies in only one of the sets @xmath45 and @xmath1 , but is compatible with all edges in the other set .",
    "intuitively , we can think of adding @xmath6 to the other set with length  @xmath20 , and treatin these as common edges .",
    "formally , if @xmath6 lies in  @xmath45 , then it appears in a support pair @xmath97 with @xmath70 a set of edges compatible with all of @xmath1 ; and if @xmath6 lies in  @xmath1 , then it appears in a support pair @xmath98 with @xmath72 a set of edges compatible with all of @xmath45 . since the ratios of these pairs is either @xmath20 or  @xmath99 , respectively ( since @xmath100 ) , these pairs appear before and after any nontrivial pairs , respectively .",
    "further , the edge component values and path length are as indicated in ( [ eq : edgelength2 ] ) and ( [ eq : pathlength2 ] ) , respectively .",
    "this completes the proof of the theorem .",
    "figure  [ f : treepath ] shows an example of the geodesic @xmath101 between the trees @xmath1 and @xmath23 in figure  [ f : tree_examples ] in example  [ e : tree_examples ] .",
    "the associated support @xmath66 for @xmath101 has @xmath102 and @xmath103 , and the coordinates of seven equally spaced trees in @xmath101 are given in the table .",
    "the length of this path , as given by  ( [ eq : pathlength2 ] ) , is @xmath104     between @xmath1 and @xmath23 , sampled at the points @xmath105 for @xmath106 , the table gives the interior edge lengths for the trees , using the same edge labels as figure  [ f : tree_examples].,title=\"fig:\",width=451 ] + @xmath107    we end the section by giving a canonical representation for any geodesic .",
    "[ uniquecover ] any geodesic @xmath101 can be represented by unique support @xmath108 satisfying @xmath109 this support is called the _",
    "minimal support_.    this is the content of the remark in ( * ? ? ?",
    "* section  2.3 ) .",
    "the basic argument is as follows .",
    "any support @xmath110 of form ( [ eq : strict_inequalities ] ) results in a different geodesic , since by  ( [ eq : legs2 ] ) they have different legs . on the other hand , for any representation of @xmath101 having equalities in the ratio sequence , combine the respective sets in every equality subsequence .",
    "the resulting support continues to satisfy  ( p2 ) , and hence there is a shortest piecewise linear path from @xmath45 to  @xmath1 through the prescribed orthants .",
    "further , from ( [ eq : pathlength2 ] ) it follows that the length of this path equals that of  @xmath101 , and hence defines the unique geodesic  @xmath101 .",
    "[ r : common_edges ] theorem  [ t : prelimthm ] positions the support pairs corresponding to edges compatible with both trees into ( [ eq : strict_inequalities ] ) as follows .",
    "a.   the set @xmath111 of edges of @xmath45 that are not in @xmath1 but are compatible with all edges of @xmath1 is the set  @xmath112 , with @xmath113 and ratio @xmath114 . b.   the set @xmath115 of edges of @xmath1 that are not in @xmath45 but are compatible with all edges of  @xmath45 is the set @xmath116 with @xmath117 , and so its ratio is @xmath118 .",
    "c.   any edge @xmath6 that lies in both @xmath45 and @xmath1 ( and hence has positive length in both sets ) appears in both sets of some support pair @xmath65 , and so the ratio is .",
    "d.   all other support pairs have @xmath119 , so both sets in the support pair are  nonempty .",
    "the ordering of the support pairs in ( i)(iii ) has no effect on the structure of the geodesic between @xmath45 and  @xmath1 , so for the remainder of the paper we take the ratio sequence for a geodesic to represent only the _ positive _ ratios in the sequence .",
    "given a finite point set @xmath120 of trees in @xmath28 , the _ mean _ of @xmath121 , alternatively known as the _ frchet mean _ or _",
    "barycenter _ , is the tree @xmath122 that minimizes the sum @xmath123 of the squares of the distances from  @xmath45 to the points in  @xmath121 .",
    "the _ variance _ of @xmath121 is @xmath124 .",
    "since @xmath125 is constant throughout the following discussion , we abuse notation and henceforth refer to the variance as simply @xmath123 . the motivation for considering these notions of mean and variance as the appropriate statistical objects in tree space was given by sturm @xcite , who established the mathematical foundations for probability theory on global npc spaces .",
    "this section reviews the required basics of sturm s geometric methods in the context of tree spaces .",
    "( readers interested in frchet means of more general distributions , and those in arbitrary global npc spaces , should read section  [ s : npc ] now to put the material below in these more general settings . )",
    "let @xmath126 be a fixed tree , and consider the geodesics from @xmath1 to a variable tree @xmath127 .",
    "the tree @xmath45 can be thought of as a vector in  @xmath128 , whose coordinates are expressed using the corresponding lower - case letter  @xmath129 .",
    "if the geodesic from  @xmath45 to  @xmath1 has support pair @xmath66 as in theorem  [ t : prelimthm ] , then the squared distance @xmath130 from @xmath45 to @xmath1 is expressed as the function @xmath131 in which @xmath132 is the vector whose coordinates are restricted to edges in @xmath70 .",
    "it follows that for a set @xmath133 of trees , the variance function @xmath123 can be written @xmath134 thus the mean @xmath135 can be thought of as the point @xmath136 that minimizes @xmath137 over @xmath138 .    to state the next result , a real - valued function @xmath139 on a metric space",
    "@xmath140 is _ strictly convex _",
    "if  @xmath141 is a strictly convex real - valued function on  @xmath142 for all geodesics  @xmath101 ; that is , if @xmath143    [ p : convex ] the variance function @xmath137 is strictly convex as a function on  @xmath28 .",
    "consequently , the mean is the unique local minimum of  @xmath137 in  @xmath28 .",
    "* proposition 1.7 ) .",
    "see also example  [ e : dconvex ] .",
    "the differentiability of the variance function @xmath18 is critical to the construction of gradient - descent methods for minimizing @xmath18 .",
    "this in turn depends on the differentiability of the individual functions @xmath144 in ( [ d : var ] ) . identifying the geodesic from @xmath45 to  @xmath1 by its support @xmath66 , eq .",
    "yields the partial derivatives of @xmath144 with respect to each of the coordinates  @xmath145 : @xmath146 where @xmath70 is the set containing @xmath6 .",
    "this is well - defined whenever @xmath129 lies in the interior of its maximal orthant , although the functional form of ( [ eq : partials ] ) depends upon the combinatorial type of the geodesic , and in particular on @xmath66 .",
    "it turns out , however , that throughout the interior of any maximal orthant the function @xmath18 is continuously differentiable .",
    "[ t : diff ] the variance function @xmath137 is continuously differentiable on the interior of every maximal orthant  @xmath147 .    from ( [ d : var ] ) it suffices to show that the function  ( [ eq : partials ] ) is continuously differentiable on the interior of  @xmath147 . by lemma  [ uniquecover ] the geodesic between @xmath45 and @xmath1 can be represented uniquely by support @xmath148 satisfying ( [ eq : strict_inequalities ] ) .",
    "any other support @xmath66 for this geodesic consists of a sequence of sets partitioning the @xmath149 and @xmath150 into equality subsequences , with the ratios @xmath151 in the equality subsequence equal to the corresponding ratio @xmath152 of the sets from which they were partitioned . but",
    "this means that the ratio @xmath153 , and hence @xmath154 , is the same regardless of which representation we choose for the geodesic .",
    "it follows that the partial derivatives are continuous everywhere in the interior of  @xmath147 .",
    "the orthant structure of tree space  @xmath28 prevents the averaging of finite point sets using the standard euclidean centroid .",
    "the following serves as an approximate replacement , introduced by sturm ( * ? ? ?",
    "* definition  4.6 ) in the context of probability theory on arbitrary globally nonpositively curved spaces .",
    "[ d : indmean ] for a set @xmath155 of points in @xmath28 and an index  @xmath156 , the _ inductive mean value _ of @xmath157 is the point @xmath158 defined by setting @xmath159 and for @xmath160 , letting @xmath161 be the point @xmath162 that is @xmath163 along the geodesic @xmath101 from @xmath164 to @xmath165 .",
    "note that if all of the @xmath166 lie in the same orthant , then the inductive mean value of @xmath157 in fact equals the standard centroid of @xmath157 .",
    "for general points in @xmath28 , though , the inductive mean may not be the frchet mean ; it may in fact give different points for different orderings of the points  @xmath157 ( see example  [ e : indmean ] ) .",
    "sturm goes on to prove ( * ? ? ?",
    "* theorem  4.7 ) the following _ strong law of large numbers _ for the frchet mean .",
    "[ t : sturmpoints ] fix a set @xmath167 of trees . if @xmath155 is a sequence of points sampled uniformly and independently from @xmath168 , then with probability  @xmath169 , the sequence of inductive mean values @xmath170 approaches the mean @xmath135 of @xmath168 .",
    "to be precise , sturm shows that if we take the inductive mean @xmath158 as a random variable dependent on the sampling of the points  @xmath171 , then the distance @xmath172 from  @xmath158 to the true mean  @xmath135 has expected value bounded above by @xmath173 .",
    "this gives us a way of estimating the frchet mean @xmath135 through a sequence of inductive means @xmath170 obtained by randomly sampling trees from the set @xmath168 .",
    "[ r : precision ] the choice of stopping criterion involves two parts .",
    "a.   running the algorithm a specified initial number @xmath174 of iterations guarantees an upper bound of @xmath175 on the expected distance of the final tree @xmath158 to the mean  @xmath135 .",
    "this is derived from the proof of theorem 4.7 in @xcite .",
    "b.   comparing the final @xmath176 sample means serves as a proxy for testing that the sample means act like a cauchy sequence for @xmath176 steps .",
    "thus in principle , proper settings for @xmath174 , @xmath176 , and @xmath177 could be used to set confidence intervals on the distance @xmath178 by using sturm s result .",
    "this would involve a more sophisticated statistical analysis , which we did not undertake in this paper . in practice , we chose @xmath174 , @xmath176 , and @xmath177 to balance run - time with the desired precision , working under the rough assumption that if @xmath176 is chosen large enough , then the approximate mean will be within @xmath177 of the mean tree .",
    "for example  [ e : gene ] , we chose @xmath179 , @xmath180 , and @xmath181 .",
    "[ r : implement ] we have made software implementing this algorithm freely available @xcite .",
    "this section investigates the combinatorial structure of geodesics in  @xmath28 and their relationship to the variance function . to be more precise , fix a source tree @xmath126 .",
    "the shortest path from an arbitrary tree @xmath182 to  @xmath1 has a `` combinatorial type '' , determined through theorem  [ t : prelimthm ] by the sequence of orthants that it passes through , or more specifically the support pair @xmath66 associated with the geodesic .",
    "this combinatorial type can change , even when @xmath45 has the same topology , depending on the precise values of the lengths of the edges in @xmath45 .",
    "we are interested in the partition of @xmath28 called here are analogous to _ cut cells _ in ( * ? ? ?",
    "* definition  5.4 ) .",
    "in contrast , the equivalence relation in @xcite declares two points _ equivistal _ when their vistal subdivisions  in the sense of theorem  [ t : cell_complex]are combinatorially the same . ]",
    "the _ vistal subdivision _ of @xmath28into regions for which the geodesics to the fixed tree @xmath1 have the same combinatorial type .",
    "we begin by describing a simple change of coordinates , the _ squaring map _ , and characterizing the faces of maximal dimension in the vistal subdivision ( section  [ sub : vistal ] ) . in particular , propositions  [ p : cone ] and [ p : polyhedral ] establish that after applying the squaring map the vistal facets are polyhedral regions that cover tree space but have disjoint interiors . next we provide a simple description of the faces of lower dimension in these polyhedra ( section  [ sub : lowerdim ] ) .",
    "finally , we prove that the vistal facets constitute the maximal cells of a polyhedral subdivision of tree space , called the _ vistal polyhedral subdivision _ ( section  [ sub : vistalsub ] ) .",
    "the idea of studying the paths taken by geodesics emanating from a source point has been studied in computational geometry , in the areas of single source shortest path queries @xcite and polyhedral unfolding @xcite .",
    "recently chepoi and maftuleac studied the single source shortest path problem for cat(0 ) rectangular complexes , where each cell is a 2d rectangle .",
    "when the underlying space is intrinsically 2d , these shortest path subdivisions are often polyhedral .",
    "however , in general , we can not expect this in higher dimensions , and indeed , without the squaring map , the vistal subdivisions are not polyhedral , as illustrated in example  [ e : subdivision ] .",
    "the squaring map is only possible in @xmath28 because all of the combinatorial complexity of the space happens about the origin .",
    "[ e:4dim ] vistal subdivisions are in general far from polyhedral , even after changes of coordinates such as squaring .",
    "a prerequisite for a squaring map to produce polyhedrality would be that ( every component of the ) the bounding hypersurface has degree at most  @xmath183 . however , global npc cubical complexes can have vistal cells bounded by hypersurfaces of degree greater than  @xmath183 .",
    "we conjecture that the bounding hypersurface can have components of arbitrarily high degree .    for a specific example , consider first the arrangement @xmath184{3d_counter_ex.eps}\\ ] ] of three @xmath185-dimensional cubes in which the bottom two cubes are joined along a common face , the top cube meets one bottom cube along an edge , and all three cubes meet at a central vertex .",
    "consider the set  @xmath186 of points whose shortest path back to a fixed starting point ( the dot in the left bottom cube ) passes through the interior of the edge joining the top cube to the bottom cubes , as opposed to passing through the central vertex .",
    "the set  @xmath186 is obtained by rotating the top shaded triangle about the shared cube edge .",
    "the boundary of  @xmath186 is a cone and hence is described as the vanishing locus ( in the top cube ) of a polynomial of degree  @xmath183 .    to get the desired example , glue a @xmath187-cube to the right - hand @xmath183-face of the top cube in the figure .",
    "if it were merely a @xmath185-cube glued on , then the cone  @xmath186 would simply continue to expand into the added cube , creating a frustum in the added @xmath185-cube .",
    "but once the new facet is a @xmath187-cube , the frustum rotates freely around the shared @xmath183-face .",
    "the boundary of such a rotated frustum is the locus of zeros ( in the @xmath187-cube ) of a polynomial , but any such polynomial  @xmath13 has degree at least  @xmath187 .",
    "indeed , intersecting the hypersurface in question with a generic hyperplane yields a union of two cones , each of which has degree  @xmath183 .",
    "therefore @xmath13 restricts to a polynomial of degree at least  @xmath187 on the hyperplane , whence the hypersurface itself has degree at least  @xmath187 .",
    "[ d : vistal ] given a source tree @xmath126 , a maximal orthant @xmath188 , and a support @xmath189 , let @xmath190 be the closure of the set of trees @xmath191 for which the geodesic joining @xmath45 to  @xmath1 has support @xmath66 satisfying ( p2 ) and ( p3 ) with strict inequalities .",
    "previstal facet _ is any nonempty set @xmath190 of this form .",
    "the description of @xmath192 becomes linear after a simple change of variables .",
    "[ d : squaring ] the _ squaring map _ @xmath193 acts on @xmath194 by squaring coordinates : @xmath195 denote by @xmath196 the image of this map , and let @xmath197 denote the coordinate indexed by @xmath198 .",
    "the image of an orthant in @xmath28 is then the equivalent orthant in @xmath196 , and the image of a previstal facet @xmath190 in  @xmath199 is a _ vistal facet",
    "_ denoted @xmath200 . with this change of variables , @xmath201 for any set of splits @xmath202 .",
    "the squaring map induces on the variance function @xmath18 a corresponding pullback function @xmath203 since the variance function @xmath137 is continuous on  @xmath28 with a uniquely attained minimum by proposition  [ p : convex ] , and continuously differentiable on the interior of each maximal orthant by theorem  [ t : diff ] , the same properties hold for @xmath204 .",
    "thus we can apply steepest descent methods after squaring just as we would beforehand .",
    "this is further explored in  section  [ s : computing ] .",
    "theorem  [ t : prelimthm ] implies a nice description of the vistal facets of  @xmath199 .    [",
    "p : cone ] the vistal facet @xmath200 is a convex polyhedral cone in @xmath199 defined by the following inequalities on @xmath205 , where all norms @xmath206 are to be interpreted  as  @xmath207 .",
    "1 .   @xmath208 ; that is , @xmath209 for all @xmath198 , and @xmath210 for @xmath211 , where @xmath212 .",
    "@xmath213 for all @xmath214 .",
    "@xmath215 for all @xmath216 and subsets @xmath217 , @xmath218 such that @xmath219 is compatible .    for a vector @xmath220 to lie in @xmath221",
    ", the tree @xmath45 must be in an orthant of @xmath28 and satisfy properties ( p2 ) and  ( p3 ) .",
    "the orthant condition immediately implies the nonnegativity conditions in ( o ) .",
    "the inequalities corresponding to ( p2 ) are @xmath222 squaring , cross - multiplying , and substituting  @xmath223 for @xmath224 yields the corresponding linear inequality in @xmath200 in  @xmath199 .",
    "the inequalities for ( p3 ) are obtained in the same manner .",
    "[ p : polyhedral ] the vistal facets are of dimension @xmath5 , have pairwise disjoint interiors , and cover @xmath199 .",
    "a point @xmath225 lies interior to a vistal facet @xmath200 if and only if the inequalities in ( o ) , ( p2 ) , and  ( p3 ) are strict .",
    "the vistal facets cover @xmath199 by definition : @xmath226 if the geodesic from @xmath191 to  @xmath1 has support @xmath108 .",
    "the second statement follows by definition  and by standard properties of convex polyhedra presented as solutions to systems of linear inequalities .",
    "henceforth in this section we focus our attention on the squared tree space @xmath199 and its expression as a union of polyhedral vistal facets as given by proposition  [ p : cone ] . this subsection concerns faces of vistal facets , including compact characterizations thereof .",
    "[ d : signature ] fix a source tree @xmath126 , a ( not necessarily maximal ) orthant @xmath227 , and a support @xmath189 .",
    "signature _ associated with the support @xmath189 is a length @xmath228 sequence @xmath229 of symbols @xmath230 .",
    "previstal cell _ defined by @xmath147 , @xmath231 , @xmath232 , and @xmath233 is the set @xmath234 of points @xmath45 in @xmath147 for which the ratio sequence for @xmath66 at the point  @xmath45 has the following specific form : @xmath235 the _ vistal cell _",
    "@xmath236 is the image of @xmath234 under  squaring .",
    "[ r : cell ] vistal cells are convex polyhedra that need not be bounded , and as such they might not be topological cells . however , the interior of a convex polyhedron is a topological cell , so every vistal cell is the closure of a topological cell .",
    "[ l : full_dimensional ] the dimension of the vistal cell @xmath237 is at most @xmath238 , where @xmath239 is the number of  `` = '' components in  @xmath233 .",
    "the vistal cell @xmath237 is full - dimensional if and only if there exists a point @xmath240 satisfying the following two properties .    1 .   for each @xmath214 ,",
    "@xmath241 if @xmath242 is  `` = '' and @xmath243 if @xmath242 is  `` @xmath244 '' .",
    "the inequalities in ( p3 ) are satisfied strictly .",
    "this follows from standard polyhedral theory , as treated in @xcite , for instance .",
    "proposition  [ p : cone ] implies that ( i )  vistal cells are faces of vistal facets , and that ( ii )  vistal facets are vistal cells for which @xmath147 is maximal and the signature contains only `` @xmath244 '' symbols .",
    "what we prove here is that _ all _ faces of vistal facets can be represented as vistal cells , and that under some simple conditions on @xmath189 , definition  [ d : signature ] provides a canonical description of each vistal cell .",
    "we start by determining all supports and signatures associated with the geodesic @xmath101 from @xmath1 to a particular point @xmath45 . by lemma  [ uniquecover ] , the geodesic  @xmath101",
    "can be represented by a unique minimal support @xmath189 satisfying ( [ eq : strict_inequalities ] ) : @xmath245 any other support @xmath246 of @xmath101 corresponds to a ratio sequence in which at least one ratio @xmath247 is replaced by a _ ratio subsequence _ formed from a partition of @xmath70 and @xmath72 , with equalities between all terms .",
    "any ratio subsequence for which @xmath45 continues to satisfy ( p3 ) together with equalities between terms of the ratio subsequences constitutes a valid support for @xmath101 .",
    "we next give a specific method for determining all such support sequences .",
    "in @xcite it was shown how condition  ( p3 ) for support pair @xmath68 can be rephrased in terms of conditions on a special node - weighted graph derived from the compatibility relations between @xmath45 and @xmath1 and their coordinate values .",
    "we summarize the technique here .",
    "denote the coordinates of @xmath45 and @xmath1 by @xmath248 and @xmath249 , and let @xmath250 and @xmath251 be their squared coordinates .",
    "[ d : incompatibilitygraph ] the _ incompatibility graph _",
    "@xmath252 between @xmath70 and @xmath72 is the weighted bipartite graph with vertex set @xmath253 and an edge from @xmath254 to @xmath255 whenever @xmath256 and  @xmath257 are incompatible .",
    "the weight of each vertex @xmath258 is @xmath259 , and the weight of each vertex @xmath260 is @xmath261 .",
    "a _ ( vertex ) cover _ for @xmath252 is a set @xmath262 having the property that every edge of @xmath252 has at least one endpoint in @xmath75 .",
    "the weight of @xmath75 is the sum of the weights of its vertices .",
    "[ l : p3_for_incomp_graph ] property ( p3 ) holds for support pair @xmath68 if and only if every cover of @xmath263 has weight  @xmath264 .    by lemma  [ l : p3_for_incomp_graph ] , testing a support pair @xmath77 for property ( p3 ) is equivalent to showing that the _ min weight cover _ for @xmath263 has weight 1 .",
    "the problem of finding the minimum cover in @xmath263 in turn can be reduced to solving a max flow problem ( see @xcite , section 12.3 ) on a specially defined flow network @xmath265 . to construct @xmath265 ,",
    "start with @xmath252 , attach a source  @xmath266 to the @xmath70-vertices of @xmath252 and a sink  @xmath267 to the @xmath72-vertices of  @xmath252 , and direct all edges from @xmath266 toward @xmath267 .",
    "set the capacity of each edge @xmath268 to  @xmath269 , set the capacity of each edge @xmath270 to  @xmath271 , and set the capacities of edges in @xmath252 to  @xmath99 .",
    "the max - flow - min - cut theorem implies that the value of the maximum @xmath272-flow @xmath13 for @xmath265 is equal to the capacity of a minimum capacity of an @xmath272-cut @xmath174 in @xmath265 , which in turn corresponds to a minimum weight cover @xmath75 for @xmath252 .",
    "thus the condition in lemma  [ l : p3_for_incomp_graph ] for @xmath252 is equivalent to the property that the max flow in @xmath265 is @xmath273 .",
    "the precise relationship between max flows in @xmath265 and min covers in @xmath252 is crucial to determining the possible ratio subsequences that can replace a term @xmath247 in ( [ eq : strict_inequalities ] ) , and we clarify this relationship below .    [ e : picard_queyranne ] figure  [ f : picard_queyranne ]    demonstrates this for a hypothetical support pair @xmath65 with @xmath274 and @xmath275 , compatibility graph @xmath252 , and values @xmath276 , and @xmath277 as given in figure  [ f : picard_queyranne](a ) .",
    "figure  [ f : picard_queyranne](b ) depicts the associated flow graph @xmath265 and max flow . for simplicity ,",
    "the weights are not normalized , so that all numbers are scaled by @xmath278 , the sum of the weights .",
    "this flow has value 23 , which means that the pair @xmath65 satisfies ( p3 ) .",
    "now consider the problem of determining the possible ratio subsequences replacing a term @xmath247 in the ratio sequence of a minimal support for @xmath45 and @xmath1 .",
    "we use the optimal flow conditions on @xmath265 to do this . recall that here @xmath77 also satisfies ( p3 ) , so that the max flow @xmath13 on @xmath265 has value  @xmath169 . the associated minimum weight cover for @xmath252",
    "can then be obtained from this flow . to do this",
    ", we define another auxiliary graph .",
    "[ d : residual ] the _ residual graph _ @xmath279 with respect to @xmath13 has    1 .",
    "all edges of @xmath252 , directed as in @xmath265 , and 2 .",
    "all edges  @xmath6 of @xmath265 but in the reverse direction where @xmath280 .",
    "an _ @xmath272-cut _ in @xmath279 is any partition @xmath281 of the nodes of @xmath279 having the property that no edge of  @xmath279 goes from  @xmath282 to  @xmath283 .",
    "it is easy to see that by this definition , @xmath282 contains @xmath266 and @xmath283 contains @xmath267 . the definition of residual graph is based on the structure of @xmath265 and the fact that the flow @xmath13 saturates ( is at capacity on ) all edges adjacent to either @xmath266 or @xmath267 .",
    "the max - flow - min - cut theorem states that every @xmath272-cut in @xmath279 corresponds to a cut of capacity 1 in @xmath265 , which in turn corresponds to a cover of weight 1 in @xmath252 .",
    "this leads to the following result .",
    "[ l : residual ] let @xmath281 be a @xmath272-cut in the residual graph @xmath279 .",
    "then the sets @xmath284 , @xmath285 , @xmath286 , and @xmath287 have the property that @xmath288 can replace @xmath289 in ( [ eq : strict_inequalities ] ) and the resulting sequence still satisfies ( p2 ) and ( p3 ) .    by definition [ d : residual](a ) all edges of @xmath252 are in @xmath290 , so in particular there can be no edge from any element in @xmath291 to any element in @xmath292 .",
    "thus @xmath73 is compatible .",
    "further , by definition [ d : residual](b ) there are no edges of @xmath290 from @xmath282 to @xmath283 , so the flow is conserved in  @xmath282 , and hence in  @xmath283 .",
    "this implies @xmath293 and @xmath294 , and thus the ratios are equal .",
    "finally , since the flow @xmath13 restricted to each of the subgraphs @xmath295 and @xmath296 continues to saturate the edges adjacent to @xmath266 and  @xmath267 , property ( p3 ) continues to be satisfied on the replacement support pairs @xmath297 and  @xmath298 .",
    "one min cut with respect to the flow in figure  [ f : picard_queyranne](b ) has @xmath299 and  @xmath282 its complement ; this corresponds to the pairs @xmath300 , @xmath301 , @xmath302 , and @xmath303 , with squared ratios @xmath304 .",
    "iteratively applying lemma  [ l : residual ] to the resulting graphs @xmath305 and @xmath306 can produce various replacement subsequences for @xmath65 , depending upon the choice of min cuts and the number of times the lemma is applied . picard and queyranne @xcite give a method to find all cuts for this flow problem , thereby allowing us to characterize all ratio subsequences associated with @xmath65 .",
    "write @xmath307 for the result of modifying the residual graph @xmath279 by contracting all edges contained in directed cycles .",
    "the directed graph @xmath307 is acyclic , is independent of the actual ( max ) flow  @xmath13 , and has nodes corresponding to a partition of the nodes of @xmath308 . furthermore , the nodes in any partition obtained by iteratively applying lemma  [ l : residual ] must consist of unions of the sets corresponding to the nodes of @xmath309 .",
    "an _ upper ideal _ for  @xmath307 is any set  @xmath310 of nodes of  @xmath307 such that @xmath311 whenever @xmath312 and @xmath313 is an edge of  @xmath307 .",
    "a partition @xmath281 is therefore a cut if and only if @xmath282 is an upper ideal .",
    "let @xmath314 denote the set of upper ideals of  @xmath307 , excluding the trivial ideal  @xmath315 .",
    "the next corollary follows from this discussion .",
    "[ c : path_ordering ] the maximum size of any ratio subsequence that can replace @xmath77 in  ( [ eq : strict_inequalities ] ) is equal to the number of vertices in @xmath316 .",
    "moreover , the ratio subsequences @xmath317 are in bijection with nested sequences of sets in @xmath314 .",
    "this simplifies further .",
    "a _ topological ordering _ of @xmath307 is any numbering of the vertices so that for every edge @xmath313 of  @xmath307 , vertex  @xmath318 is numbered lower than  @xmath319 .",
    "every acyclic graph has at least one topological ordering .",
    "[ c : topological_orderings ] the maximum - cardinality ratio subsequences of corollary  [ c : path_ordering ] are in bijection with the topological orderings of @xmath307 .",
    "in fact , any ratio subsequence for a particular pair @xmath65 corresponds to a partition of the vertices of @xmath307 according to one of these topological orderings .",
    "[ e : cont ] applying corollary  [ c : topological_orderings ] to the example in figure  [ f : picard_queyranne ] , the only two acyclic orderings of  @xmath320 are @xmath321 and @xmath322 , which results in the two maximal subsequences @xmath323      \\big(\\{x_1,x_2,x_3\\},\\{t_1\\}\\big ) ,      \\big(\\{x_4,x_5,x_6\\},\\{t_2,t_3,t_4,t_5\\}\\big ) ,      \\big(\\{x_8\\},\\{t_7\\}\\big ) ,      \\big(\\{x_7\\},\\{t_6\\}\\big )    \\end{array}\\right.\\ ] ] respectively , both of which have squared ratios of @xmath324 .",
    "the set of possible replacement subsequences for @xmath66 corresponds to the twelve distinct contiguous partitions that can be formed from one of the above two sequences .",
    "we next set up the combinatorial structure to give a canonical description of the vistal cell @xmath237 .",
    "[ d : valid ] let @xmath65 be a support pair for the minimal support @xmath108 .",
    "a _ valid support sequence _ for @xmath65 is comprised of a set of pairs @xmath325 with the following properties .    1 .   the sets @xmath326 and @xmath327 are nonempty and partition @xmath70 and  @xmath72 , respectively .",
    "the incompatibility graph @xmath328 is connected for each @xmath329 .",
    "3 .   contracting the sets @xmath330 in @xmath252 results in an acyclic graph .",
    "any support derived from the maximal supports in example  [ e : cont ] is a valid support sequence , except for the two supports @xmath331 whose final pairs do not correspond to connected subgraphs of the compatibility graph .",
    "[ l : valid_support_vector ] let @xmath332 have associated @xmath333-geodesic with minimal support @xmath189 satisfying  ( [ eq : strict_inequalities ] ) , and for some index  @xmath89 let @xmath334 be a valid support sequence for @xmath65 .",
    "there is an element @xmath335 in the same orthant as @xmath45 for which the geodesic between @xmath336 and @xmath1 has support @xmath337\\end{aligned}\\ ] ] with @xmath338 further , for any pair @xmath339 and any partition @xmath340 of  @xmath341 and  @xmath342 of  @xmath327 in which @xmath73 is compatible , @xmath343    for support pair @xmath68 , let @xmath344 and @xmath345 be the weights on the vertices of @xmath252 .",
    "define @xmath336 by replacing the ( squared ) weights on @xmath45 for each @xmath346 by @xmath347 where @xmath348 is the set of vertices @xmath349 such that @xmath350 is in the incompatibility graph , and @xmath351 is the number of edges of the incompatibility graph from @xmath326 to  @xmath257 .",
    "these values are all well - defined and positive by ( f1 ) and ( f2 ) .",
    "place the following flow @xmath13 on the associated flow graph : for edge @xmath350 where @xmath346 and @xmath352 for any @xmath353 , let the flow on that edge be @xmath354 ; for all other edges , let the flow be  @xmath20 .",
    "then the flow into node  @xmath257 is exactly  @xmath355 and the flow out of  @xmath256 is exactly  @xmath356 .",
    "corollary  [ c : path_ordering ] and property  ( f3 ) ensure that @xmath13 is a max flow with respect to the flow graph , with flow value @xmath357 , and since flow is conserved between each @xmath326 and  @xmath327 , the original ( un - normalized ) weights satisfy @xmath358 finally , for a pair @xmath359 , let @xmath360 and @xmath361 be partitions of @xmath326 and @xmath327 respectively , in which @xmath73 is compatible .",
    "this means that there are no edges of @xmath328 from @xmath291 to  @xmath292 , and since @xmath328 is connected there must be at least one edge going from @xmath362 to  @xmath363 . since flow is positive on all edges of @xmath328 , there is a net flow from  @xmath362 away from  @xmath292 , and from the definition of @xmath364 it follows that @xmath365 .      finally , we extend propositions  [ p : cone ] and [ p : polyhedral ] to describe all vistal cells associated with @xmath333-geodesics from points  @xmath45 in an orthant  @xmath147 . since a valid support sequence is determined by the combinatorics of the splits and not by their edge lengths , we can define the following .",
    "a _ valid support sequence for @xmath366 _ is a support @xmath66 for which each maximal equality subsequence @xmath367 satisfies properties ( f1)(f3 ) with respect to the pair @xmath368 .",
    "write @xmath369 for the corresponding incompatibility graph @xmath370 .",
    "[ t : vistal_face_combinatorics ] fix a tree @xmath126 .    1 .",
    "vistal cells associated with geodesics to  @xmath1 are exactly those of the form @xmath237 , where @xmath66 is a valid support sequence for @xmath366 and @xmath233 is a signature on @xmath66 .",
    "the dimension of the vistal cell @xmath237 is @xmath238 , where @xmath239 is the number of  `` = '' components in  @xmath233 .",
    "the representation by a valid support sequence and signature is unique up to reordering the support sets within each equality subsequence of  @xmath233 .",
    "claim  1 .",
    "let @xmath237 be a vistal cell containing an interior point  @xmath371 . the definition of support and the fact that @xmath371 is positive implies that ( f1 ) and  ( f3 ) hold for @xmath369 .",
    "now suppose that ( f2 ) fails to hold ; that is , some @xmath252 has a partition into two disjoint subgraphs on vertex sets @xmath372 and @xmath373 , respectively .",
    "let @xmath13 be the max flow in @xmath252 .",
    "since ( p3 ) is satisfied , @xmath13 saturates all arcs adjacent to the source and sink .",
    "but since flow in each of the disjoint subgraphs @xmath305 and @xmath306 is self - contained , @xmath374 .",
    "this means that the corresponding tree  @xmath45 satisfies one of its ( p3 ) inequalities at equality , so @xmath371 can not be in the interior of @xmath237 , a contradiction . thus ( f2 ) is also satisfied , so @xmath66 is a valid support sequence with respect to  @xmath366 .",
    "conversely , let @xmath66 be a valid support sequence with respect to @xmath366 . consider a ratio subsequence  ( [ eq : equality_subsequence ] ) with all terms equal .",
    "since @xmath66 is a valid support sequence , lemma  [ l : valid_support_vector ] constructs positive weights @xmath171 on the edges indexed by  @xmath375 , for @xmath376 , so that  ( [ eq : equality_subsequence ] ) holds and all  ( p3 ) inequalities are strict inside each support pair . now for each maximal - length equal - ratio subsequence , scale the vectors of each term by the same positive multiplier  @xmath377 so that the sequence of multipliers  @xmath377 is increasing with the indices .",
    "the scaled @xmath378 vectors concatenate into a vector @xmath45 in the interior of @xmath147 having the correct signature indicated by  @xmath233 , and for which the ( p2 ) inequalities hold strictly between the equal - ratio subsequences .",
    "the squared point  @xmath371 corresponding to  @xmath45 therefore lies interior to @xmath237 , and the desired result follows .",
    "claim  2 .",
    "the vector  @xmath371 constructed in the proof of claim  1 is positive in  @xmath147 , satisfies all ( p3 ) inequalities strictly , and satisfies all ( p2 ) inequalities strictly for which the corresponding component of @xmath233 is  `` @xmath244 '' .",
    "therefore the dimension of @xmath237 is determined entirely by the set of equalities defined by the component of  @xmath233 that are  `` = '' .",
    "since these are linearly independent , the dimension is as stated .",
    "claim  3 .",
    "let @xmath379 and @xmath380 be two representations of vistal cells , defined by valid supports @xmath189 and @xmath246 respectively .",
    "any permutation of support pairs within an equality subsequence  ( [ eq : equality_subsequence ] ) results in the same set of equalities , so if the representations differ only by such a permutation , then @xmath381 .",
    "conversely , suppose @xmath381 .",
    "since all cell constraint inequalities other than those specified by @xmath233 are satisfied strictly , the set of equalities dictated by  @xmath233 define the affine hulls of  @xmath382 and  @xmath383 .",
    "this means that the two associated equality systems are row - equivalent .",
    "now suppose that the supports @xmath189 and @xmath246 do not comprise the same sets ; that is , by symmetry the two sets @xmath70 and  @xmath384 both have nonempty intersection with the same set  @xmath385 .",
    "since the variables of @xmath385 do not appear in any other @xmath386 for @xmath387 , no row transformation of the equality system for @xmath383 could possibly separate the variables in @xmath388 from those in @xmath389 .",
    "thus the two equality systems are not the same , a contradiction .",
    "[ c : disjoint ] distinct vistal cells have disjoint relative interiors .",
    "let @xmath371 be an element in the relative interior of two faces in  @xmath199 , given by valid representations",
    ". then @xmath371 satisfies ( f2 ) and ( f3 ) with respect to both faces , and by theorem  [ t : vistal_face_combinatorics ] the only way this could happen is if the faces coincide .",
    "theorem  [ t : vistal_face_combinatorics ] allows us a purely combinatorial way of describing vistal cells .",
    "this gives us the machinery to prove the principal result of the section , namely that the vistal cells are the faces of a polyhedral subdivision of tree space under the squaring map . to make this precise ,",
    "we start with some definitions concerning polyhedra ; see ( * ? ? ?",
    "* lecture  5 ) for further background .",
    "[ d : polyhedralcomplex ] a _ polyhedral complex _",
    "@xmath390 is a finite collection of polyhedra such that    1 .",
    "every polyhedral face of every polyhedron in  @xmath390 is a polyhedron in  @xmath390 ; 2 .",
    "the intersection of any pair of polyhedra in  @xmath390 is a face of each .",
    "the _ dimension _ of  @xmath390 is the largest dimension of a polyhedron in  @xmath390 .",
    "the _ facets _ of  @xmath390 are the maximal cells .",
    "the _ underlying set _ of  @xmath390 is the union @xmath391 of the polyhedra in  @xmath390 .",
    "[ e : treesigma ] tree space @xmath28 has a _ natural polyhedral structure _ as the underlying space of a polyhedral complex whose polyhedra are its orthants .",
    "this polyhedral structure is unchanged by the squaring map , and thus also found in @xmath392 .",
    "the relation between vistal cells and orthants is one of refinement , in the following sense .",
    "[ d : subdivision ] let @xmath390 and  @xmath393 be polyhedral complexes .",
    "then @xmath393 is a _ subdivision _ of  @xmath390 ( it is also said that @xmath393 _ refines _",
    "@xmath390 ) if each polyhedron in  @xmath393 is contained in a single polyhedron in  @xmath390 .",
    "[ t : cell_complex ] for tree space  @xmath28 and fixed source tree @xmath1 , the vistal cells of @xmath199 with respect to @xmath1 refine the natural polyhedral structure of  @xmath199 to form a _",
    "vistal polyhedral subdivision _ of  @xmath199 .",
    "the vistal cells are polyhedra whose union is  @xmath199 by propositions  [ p : cone ] and  [ p : polyhedral ] .    for ( c1 )",
    ", we show that changing any of the inequalities defining a vistal cell to equality results in a set that can be described as a vistal cell .",
    "let @xmath394 be a vistal cell , so that by lemma  [ l : valid_support_vector ] , @xmath189 is a valid support sequence , and let  @xmath382 be a proper face of  @xmath395 obtained by setting one of its boundary inequalities to equality .",
    "there are three types of inequalities that define  @xmath382 : ( p2 ) constraints , nonnegativity constraints , and ( p3 ) constraints .    for the ( p2 ) constraints ,",
    "consider the inequality @xmath396 , where the corresponding component of the signature  @xmath233 is  `` @xmath244 '' .",
    "let @xmath397 be obtained from @xmath233 by setting this inequality to  `` = '' .",
    "since neither @xmath147 nor @xmath189 has changed , this constitutes a valid support sequence , and @xmath398 .    for the nonnegativity constraints ,",
    "consider the inequality @xmath399 , where @xmath6 is a split indexing a coordinate of  @xmath147 .",
    "let @xmath70 be the set containing @xmath6 .",
    "now remove @xmath6 from @xmath369 .",
    "this splits @xmath252 into components corresponding to partitions @xmath400 of @xmath65 .",
    "because these partitions correspond to separate components in @xmath263 , they can appear in any order in a valid support sequence for @xmath382 .",
    "thus every point in @xmath382 must satisfy every ( p2 ) inequality between the pairs @xmath401 at equality , since otherwise the @xmath402 sets could be interchanged so that some ( p3 ) condition is violated .",
    "first consider the case where all of the @xmath403 are nonempty .",
    "define the support @xmath404 by inserting @xmath405 in place of @xmath65 in @xmath66 : @xmath406 and extend the signature  @xmath233 to  @xmath397 by adding `` = '' signs between each of the sets in the primed subsequence .",
    "then @xmath404 is valid , and @xmath407 .",
    "now suppose that one of the support pairs @xmath402 has @xmath408 .",
    "the associated ratio must be  @xmath20 , which implies in turn that every ratio corresponding to the pairs @xmath400 is  @xmath20 .",
    "furthermore , the ratios are also  @xmath20 for any earlier support pairs .",
    "so @xmath409 for every @xmath410 .",
    "in this case set @xmath411 by remark  [ r : common_edges ] we have been ignoring the non - positive ratios ; however , they still exist if there are common edges between  @xmath45 and  @xmath1 . in this case ,",
    "the edges @xmath412 become common edges , and are added to the @xmath20-valued ratio if it already exists , or form it anew , if it does not .",
    "again @xmath413 is valid , and @xmath414 .",
    "next consider the ( p3 ) constraints .",
    "for some support pair @xmath65 let @xmath415 and @xmath342 be partitions of @xmath70 and @xmath72 with @xmath73 compatible , and consider the constraint @xmath416 let @xmath417 and @xmath418 be pairs corresponding to the components of @xmath305 and @xmath306 , respectively .",
    "first consider the case where all of the @xmath403 and  @xmath419 are nonempty .",
    "the same nonempty sets argument as above applies , and we obtain the the face @xmath420 with @xmath421 and  @xmath397 defined as in the nonempty - set case above .",
    "next suppose that one of the sets @xmath402 has @xmath408 . as in the empty - set case above , this forces @xmath422 to be 0 for every @xmath423 , and so @xmath424 with  @xmath425 , @xmath426 and  @xmath427 defined as in the empty - set case above .",
    "now suppose that one of the sets @xmath402 has @xmath428 .",
    "this forces the ratios for every pair in @xmath400 to be @xmath99 , which in turn means that @xmath429 for every @xmath430 .",
    "thus if we define @xmath431 then again @xmath432 is a valid sequence , and so we obtain the face @xmath433 .",
    "as before , the edges @xmath434 become common edges , and hence be added to the @xmath99-valued ratio if it exists and otherwise form that ratio .",
    "finally , suppose that there are pairs @xmath435 and @xmath436 with @xmath437 .",
    "this forces all of the @xmath422 where @xmath13 is not a common edge to be  @xmath20 , and we just get the face corresponding to the common edges .    for ( c2 ) , suppose that @xmath395 and  @xmath438 are vistal cells , so that @xmath439 is a convex polyhedron .",
    "let @xmath440 and @xmath441 be minimal faces of @xmath395 and  @xmath438 , respectively , containing @xmath439 .",
    "then by ( c1 ) , @xmath382 and  @xmath383 are vistal cells , and since @xmath382 and @xmath383 are minimal , then there must be a @xmath442 in the relative interior of  @xmath382 and a @xmath443 in the relative interior of  @xmath383 .",
    "it follows that the midpoint of the line segment joining @xmath444 to  @xmath445 must lie in the relative interiors of both  @xmath382 and  @xmath383 , and corollary  [ c : disjoint ] then implies that @xmath381 .",
    "thus @xmath446 , whence @xmath447 and ( c2 ) follows .",
    "[ e : cell ] to demonstrate theorem  [ t : cell_complex ] , consider the incompatibility graph from figure  [ f : picard_queyranne ] and treat it as the incompatibility graph for two trees @xmath1 and  @xmath45 .",
    "take values on  @xmath1 as given in the figure , and consider the vistal cell @xmath448 defined by @xmath449 this is a valid sequence , and in particular , using lemma  [ l : valid_support_vector ] we can assign weights as follows .",
    "@xmath450    2&2&2&3\\frac{1}{3}&4\\frac{1}{3}&5\\frac{1}{2}&\\frac{1}{3}&\\frac{1}{2}\\\\[.2em ]    \\hline    \\end{array}\\ ] ] ( the first three weights have additionally been scaled so that ( p2 ) is satisfied strictly . ) here are examples of the three types of faces of  @xmath395 .    setting the single ( p2 ) constraint to equality : this gives the face corresponding to the numbers in figure  [ f : picard_queyranne ] .",
    "setting @xmath451 : for @xmath452 the face has the same structure as the cell  @xmath395 , except that @xmath453 is removed from the corresponding sets . for @xmath454 , removal of @xmath453 disconnects @xmath455 by isolating @xmath456 or @xmath457 , respectively , and thus setting @xmath458 or @xmath459 to 0 collapses the face to the single origin point .    setting the ( p3 ) constraint with @xmath460 , @xmath461 , @xmath462 , and @xmath463 to equality : here @xmath464",
    "now @xmath306 is not connected , and has nontrivial components on vertex sets @xmath465 and @xmath466 .",
    "thus the face obtained by setting the above inequality to equality is @xmath467 , where @xmath468    [ e : subdivision ] figure  [ f : example_complex ] gives the restriction of a vistal polyhedral subdivision to a maximal orthant in  @xmath469 .",
    "the trees are depicted in figure  [ f : original_trees ] , with .",
    "figures  [ f : vistal_sub_unsquared ] and  [ f : vistal_sub ]     and fixed tree @xmath1 in  @xmath469.[f : vistal_sub_all],title=\"fig:\",width=453][f : vistal_sub_unsquared ]   and fixed tree @xmath1 in  @xmath469.[f : vistal_sub_all],title=\"fig:\",width=264][f : vistal_sub ]    [ f : example_complex ]    depict the vistal cells in orthant @xmath470 before and under the squaring map , respectively , as they intersect with the sets and , respectively .",
    "the vistal cells are labeled by the corresponding ratio sequences , using `` = '' or `` @xmath471 '' to indicate the behavior of points in the interior of the cell .",
    "we also label the six cells of lower dimension that are the intersections of the vistal facets .",
    "some of the vistal cells before the squaring map are not polyhedral , because the boundary equations are those of circular cones .",
    "it is a straightforward matter to extend vistal cells to the case where there is a collection @xmath472 of source trees in @xmath28 , and we are interested in the set of points @xmath473 for which the geodesic to each tree in @xmath474 has a specified combinatorial structure .    [",
    "d : multivistal_def ] a _ premultivistal cell _ for a collection @xmath121 of trees is a set of the form @xmath475 where @xmath476 are previstal cells , @xmath227 is an orthant , and @xmath477 is a collection of support pairs for @xmath478-geodesics .",
    "a _ multivistal cell _ is the image in  @xmath196 of a premultivistal cell .",
    "[ c : multivistal ] the multivistal cells of tree space  @xmath28 for any fixed set source trees refine the natural polyhedral structure of  @xmath28 to form a _ multivistal polyhedral subdivision _ of  @xmath28 .",
    "the common refinement of any finite collection of polyhedral subdivisions of a given polyhedral complex is a polyhedral subdivision of the same polyhedral complex , and so the result follows from theorem  [ t : cell_complex ] .",
    "[ r : cw ] the previstal cells for any fixed source tree form a subdivision of  @xmath28 , called a _ premultivistal complex _ , that is the image of the corresponding multivistal polyhedral subdivision of  @xmath199 under the inverse @xmath479 of the squaring map , which is a homeomorphism .",
    "however , the cells in this subdivision are not polyhedral .",
    "one might hope that the premultivistal complex is a _",
    "cw  complex _ , in the standard topological sense ( see @xcite , for example ) , but it is not , for the same reason that multivistal polyhedral subdivisions are not cw  complexes : the closed cells are not images of closed balls under continuous maps ( a cone of positive dimension fails to be compact )",
    ". the situation can be remedied by considering the _ link _ @xmath480 of the origin in  @xmath199 , namely the set of trees whose edge lengths sum to  @xmath169 .",
    "intersecting @xmath480 with any multivistal polyhedral subdivision yields a polyhedral cw  complex whose preimage under the squaring map is a ( non - polyhedral ) cw  complex .",
    "thus a premultivistal complex is essentially a ( noncompact , unbounded ) cone over a cw  complex .",
    "[ r : vistalexp ] in general , the number of vistal facets is exponential in  @xmath2 , even within a single orthant @xcite .",
    "thus an efficient method to move through the vistal facets  or prune the list of relevant ones  would likely improve calculation time of the mean .",
    "although the algorithm to calculate the mean in section  [ sub : sturmalg ] is simple and seems to perform well for small data sets , remark  [ r : precision ] indicates that its convergence rate is sublinear , so in theory it is a poor iterative method .",
    "this section outlines a general framework for a descent method to find the mean of a set @xmath481 of @xmath2-trees .",
    "it promises to accelerate the convergence considerably by generalizing powerful nonlinear programming techniques to apply to optimization in tree space .",
    "we start by analyzing the variance function @xmath137 of a variable point @xmath332 whose components are represented by the variable vector @xmath129 .",
    "for @xmath482 , let @xmath483 be the geodesic from @xmath45 to @xmath484 , with associated support pair @xmath485 . by summing the lengths @xmath486 of these geodesics as given by eq .",
    ", write the variance in  @xmath28  as @xmath487\\ ] ] with its derivative given by eq .  .",
    "consider this function in its @xmath199-version @xmath488 as given in definition  [ d : squaring ] .",
    "using the notation @xmath489 and @xmath490      -1&\\text{if } a^l_i = b^l_i\\text { are made up of common edges},\\\\      \\end{array}\\right.\\ ] ] then the corresponding pullback function for @xmath225 can be derived from eqs .   and  :",
    "@xmath491 if @xmath492 denotes the index of the set  @xmath493 containing  @xmath6 , then the gradient of  @xmath204 can be obtained from eq .",
    ": @xmath494    the differentiability of  @xmath18 transfers to  @xmath204 , as well .",
    "[ t : squarediff ] the function @xmath488 is continuously differentiable on the interior of every maximal orthant  @xmath147 .",
    "the inverse of the squaring map is continuously differentiable on the interior of  @xmath147 .",
    "now apply theorem  [ t : diff ] .",
    "the function @xmath488 is not necessarily convex on  @xmath196 . by proposition  [ p : convex ] , however , it does have a unique local minimum , which is therefore the mean . consequently , optimality conditions for the function  @xmath488 on  @xmath196 can be based on its behavior in _ any one _ of the multivistal facets in which @xmath371 lies . in particular , we have the following important result .",
    "[ c : unconstrained_mean ] the squared image @xmath495 of the frchet mean @xmath496 must satisfy @xmath497 on its orthant @xmath498 . if @xmath495 lies interior to a maximal orthant  @xmath147 , then @xmath495 is the squared image of the mean if and only if the gradient satisfies @xmath499 .",
    "these statements are true regardless on which multivistal facet of @xmath147 the variance function is derived .",
    "since by corollary  [ t : squarediff ] the gradient is independent of which vistal facet it is calculated from , the gradient @xmath500 must be zero on any of them in order @xmath495 to be optimal .",
    "conversely , since @xmath204 attains a unique minimum on  @xmath199 , it follows that @xmath45 must be the mean whenever @xmath497 on an entire maximal orthant .",
    "[ nondifferentiability ] when a point @xmath501 lies on the boundary of a maximal orthant , the gradient @xmath502 may be zero on @xmath503 even if @xmath501 is not the squared mean , since there may be a maximal orthant @xmath504 having a point with smaller variance than @xmath501 . finding @xmath147 from @xmath501 can be quite difficult , since of  @xmath505 may be undefined or infinite for @xmath506 .",
    "furthermore , directional derivatives may fail to be continuous along orthant boundaries .",
    "this issue presents serious optimization difficulties in locating sample means , since there is ample evidence that reasonably evenly distributed data in tree space yield means that are likely to occur on orthant boundaries , or indeed , even to lie at the origin ; see section  [ sub : stickiness ] .",
    "thus optimality conditions for the mean when it occurs on orthant boundaries is an important topic of further  research .      in spite of remark  [ nondifferentiability ]",
    ", we can suggest a basic method for finding the mean in tree space .",
    "the general idea is to start with some feasible tree , and construct a sequence of trees whose variance function is decreasing , until arriving at the mean tree .",
    "[ a : descent ]    trees @xmath481 in @xmath28    the mean tree for @xmath481    choose some good starting point @xmath507 , for example , by running sturm s algorithm for a predetermined number of iterations .    the mean has not been found :    1 .",
    "find the set @xmath508 of all maximal orthants containing @xmath509 .",
    "2 .   for each @xmath510 , choose a point @xmath511 in the interior of @xmath186 .",
    "3 .   use a nonlinear interior point / penalty function method to find a local minimum @xmath512 of @xmath204 in @xmath186 .",
    "4 .   if @xmath513 for any @xmath510 , then choose the @xmath512 with minimum @xmath514 , and set @xmath515 .",
    "while - do @xmath509 +    the local minimum search in step 3 should be both straightforward and reasonably fast , and the accuracy of the points @xmath516 as representing the true local minimum of course depends upon the method used to find it . since the function @xmath204 is continuously differentiable on all @xmath517 , the search in fact finds a local minimum on the orthant  @xmath518 .",
    "since all neighboring orthants are searched from @xmath509 , it follows that whenever all of these local searches converge back to @xmath509 then @xmath509 must necessarily be the mean .",
    "finally , the algorithm terminates after a finite number of iterations , since no two @xmath509 in the sequence can lie in the same orthant .",
    "the number of iterations depends both on the number of iterations @xmath519 and also the size of @xmath520 , each of which may be exponentially large .",
    "thus it is important for the implementation that a good starting point @xmath521 be found , and that a good method be used to determine descent directions in the set of maximal orthants adjacent to the point  @xmath509 . in general ,",
    "better local search techniques and starting solutions , perhaps through a hybrid of sturm s algorithm and descent methods , could improve the accuracy and reliability of procedures to calculate  the  mean .",
    "this section contains a series of remarks , results , and computational studies related to the frchet mean in tree space .",
    "all synthetic examples in this section will be given using the trees in figure  [ f : mean_examples ] .",
    "this figure depicts three adjacent orthants in @xmath522 , `` flattened out '' into the plane , to make the visualization easier .",
    "the edges @xmath523 and @xmath524 are not compatible , so the @xmath525-orthant ( shaded in figure  [ f : mean_examples ] ) is not part of @xmath522 . for tree @xmath526 ( respectively , trees @xmath527 and @xmath528 ) , we specify its interior edge lengths by a pair of coordinates @xmath529 ( respectively , @xmath530 and @xmath531 ) .",
    "the geodesic between any pair of these trees is a straight line , unless it would cross the shaded region , in which case the geodesic is the _ cone path _ , consisting of the two legs joining the given points to the origin .",
    "likewise , @xmath135 is the euclidean barycenter unless it lies in the shaded region , in which case @xmath135 is the point on the boundary of the shaded region that minimizes the sum of the squared geodesic distances to the three trees .",
    "@xmath532{other_means_general.eps}\\ ] ]      the topology of the mean tree depends on both the topologies and the edge lengths of the sample trees .",
    "consider , for example , trees @xmath533 and @xmath534 .",
    "the mean between these two trees is the midpoint @xmath535 of the segment joining them",
    ". changing both edge lengths of  @xmath526 to  @xmath536 , however , yields a midpoint @xmath537 ; similarly , by symmetry , changing both edge lengths of  @xmath528 to  @xmath536 yield the midpoint @xmath538 .",
    "that said , in general we can give some indication of what edges lie in the mean tree .",
    "[ l : edges_in_mean ] every edge of the mean tree is an edge of some sample tree .",
    "furthermore , if an edge appears in all sample trees , then it must also appear in the mean tree .",
    "if a tree contains an edge not in any sample tree , then contracting this edge gives a tree with a smaller variance function .",
    "now suppose that the edge  @xmath6 is contained in all sample trees , and thus is compatible with all other edges in the sample trees .",
    "since the mean contains only edges from the sample trees , edge  @xmath6 is also compatible with all edges in the mean tree . thus if the mean tree does not contain @xmath6",
    ", we can add in @xmath6 with length equal to the minimum of its lengths in the sample trees , yielding a tree that is closer to all the sample trees , which is a contradiction .",
    "several authors have proposed notions of `` center '' for a set @xmath539 of points in  @xmath28 .",
    "the euclidean or combinatorial properties of these centers make them useful for representing consensus trees .",
    "here we compare three such centers with the frchet mean  @xmath135 of  @xmath121 .",
    "all of these centers agree when @xmath121 lies entirely in a single orthant of  @xmath28 , but fail to agree for more globally distributed samples from tree space .",
    "first introduced by margush and mcmorris @xcite , this is the tree whose edge set is comprised of those edges that appear in at least half of the trees in @xmath121 .",
    "it , or an variation , is widely used in the phylogenetics literature .",
    "the topology of @xmath135 is not a refinement of the mrc tree , unlike many other consensus methods @xcite .",
    "for example , consider the trees in figure  [ f : mean_examples ] with coordinates @xmath540 , @xmath541 , and @xmath542 . the mean of these trees is the euclidean barycenter @xmath538 , while the mrc tree has the topology of tree @xmath527 , so neither tree is a refinement of the other .",
    "[ e : indmean ] the inductive mean ( definition  [ d : indmean ] ) of the set  @xmath121 , for some ordering of  @xmath121 , does not coincide with  @xmath135 , and it can differ depending upon the ordering . consider the trees in figure  [ f : mean_examples ] with coordinates @xmath543 , @xmath544 , and @xmath545 .",
    "either order having @xmath526 and @xmath528 first yields the inductive mean @xmath546 .",
    "either order having @xmath526 and @xmath527 first yields the inductive mean @xmath547 , and either order having @xmath527 and @xmath528 first yields the inductive mean @xmath548 .",
    "these have different topologies , and none of them equals  @xmath135 , which has all edges  @xmath20 .",
    "[ e : bhvcentroid ] billera , holmes , and vogtmann @xcite define the _ centroid _ of @xmath120 inductively on @xmath125 . for @xmath549 ,",
    "the centroid is the midpoint of the two trees . for @xmath550 ,",
    "the centroid is obtained as follows : set @xmath551 and inductively find the centroid of each subset of @xmath552 trees in @xmath553 to obtain a new set @xmath554 of @xmath125 trees .",
    "repeat this process on the new set , creating a sequence @xmath555 of @xmath125-sets of trees .",
    "the bhv centroid of  @xmath121 is the limit @xmath556 of any sequence of points chosen from each of the sets  @xmath557 .",
    "this process converges in a general global npc space ( * ? ? ?",
    "* theorem  4.1 ) .",
    "billera , holmes , and vogtmann note that in euclidean space , the centroid and frchet mean coincide .",
    "this is not generally the case in tree space .",
    "consider , for example , the trees in figure  [ f : mean_examples ] with coordinates @xmath558 , @xmath559 , and @xmath560 .",
    "then @xmath135 is again the origin , while it is easy to see that the bhv centroid lies off the origin .",
    "sullivant @xcite noticed the tendency of the frchet mean to be _ sticky _ , which in this context means that perturbing one or more of the trees in the set @xmath121 does not necessarily change any of the coordinates of  @xmath135 .",
    "take , for example , the points @xmath543 , @xmath561 , and @xmath545 .",
    "the mean @xmath135 lies at the origin , and remains there even if the coordinates of any of the three trees  @xmath562 are perturbed even up to a full unit .",
    "sticky means occur exclusively on orthants of lower dimension , underscoring the importance of closely investigating properties of mean trees that lie on orthant boundaries .",
    "the notion of stickiness has been quantified via a central limit theorem for means of probability distributions on certain npc spaces @xcite .",
    "statistical applications of this research are important in several areas of mathematics , biology , and medicine . here",
    ", we consider a well - studied data set in phylogenetics with respect to the frchet mean . for applications of the frchet",
    "mean to medical imaging , see @xcite and @xcite .",
    "[ e : gene ] a _ gene tree _ is a phylogenetic tree representing the evolutionary history of a particular gene found in some set of species .",
    "in contrast , a _ species tree _ is a phylogenetic tree representing the evolutionary history of the species themselves : the history of population bifurcations leading to divergence . due to natural processes such as incomplete lineage sorting , gene trees for",
    "different genes can have different topologies , even when sampled from the same set of individuals  let alone the same set of species  and hence a gene tree need not share its topology with the species tree ( see @xcite , for example ) .",
    "furthermore , the most likely gene tree topology need not agree with the species tree topology @xcite .",
    "however , species trees are usually reconstructed from gene trees , and a major open question is how best to accomplish  this .",
    "we examined the yeast data set of rokas et al .  @xcite . for eight species of yeast , they identified 106 genes and reconstructed the corresponding gene tree with edge lengths for each using a maximum likelihood approach . in these 106 gene trees , there were 21 different topologies .",
    "we used sturm s algorithm to compute the frchet mean of these gene trees .",
    "this mean tree had the same topology as the agreed - upon species tree @xcite . in general , the mean gene tree does not necessarily identify the species tree , as a consequence of stickiness , when branch lengths are taken into account @xcite ; that is , two finite samples of gene trees can yield the same mean tree but have different species trees . however , we conjecture that the topology of the species tree is a refinement of the topology of the frchet mean of the gene trees . that is , stickiness of the frchet mean forces some edges to have zero length but should not add any extraneous edges to this  mean .",
    "virtually all of our treatment of tree spaces extends to more general global npc spaces .",
    "this section reframes the concepts and notation of the paper in the context of global npc spaces , particularly orthant spaces , and shows how the results of the paper generalize to these spaces .",
    "fix a metric space  @xmath563 .",
    "a  _ path _ in  @xmath140 is the image of a continuous map @xmath564 \\to { \\mathcal{t}}$ ] . write @xmath565 for @xmath566 .",
    "the _ length _ of @xmath101 is the supremum of all sums @xmath567 such that @xmath568 .",
    "a path is a _ ( global ) geodesic _ if the distance @xmath569 between any pair of points on @xmath101 equals the length of that portion of @xmath101 between them .",
    "a  _ geodesic space _ is a complete metric space such that every pair @xmath570 of points is joined by a path @xmath101 whose length is the distance  @xmath571 between @xmath129 and  @xmath572 .",
    "[ d : npc ] a metric space @xmath573 is _ globally nonpositively curved _ , also known as _ global npc _ or _",
    "cat(0 ) _ , if for every triple of points @xmath574 , any point @xmath129 on a geodesic joining @xmath256  to  @xmath257 , and any _ reference triangle _ @xmath575 in euclidean space with edge lengths @xmath576 , @xmath577 , and @xmath578 , the unique point @xmath579 on @xmath580 at distance @xmath581 from  @xmath582 satisfies @xmath583 .                      this subsection generalizes the notion of mean and variance to general probability measures in global npc spaces .",
    "the results follow from those of sturm @xcite in this area .",
    "let @xmath594 be the set of probability measures on a global npc space  @xmath140 . if @xmath595 is such a measure , then its _ variance _ is @xmath596 the variance can be infinite in general , but not in the case of most interest to us , when @xmath597 has finite support , meaning that there is a set @xmath590 of points in @xmath140 , along with nonnegative weights @xmath598 satisfying @xmath599 , such that the point  @xmath600 has mass @xmath601 for @xmath602 .",
    "let @xmath603 be the set of measures in @xmath594 having finite variance .",
    "the point @xmath607 is referred to as the _ frchet mean _ or _ barycenter _ in this context as well , and when @xmath597 has finite support with @xmath608 for all  @xmath125 , it is a direct generalization of the definition of mean given in section  [ s : mean ] .",
    "the notion of inductive mean given by definition  [ d : indmean ] extends easily to an arbitrary global npc space  @xmath140 , and the following result generalizes theorem  [ t : sturmpoints ] .",
    "[ t : sturm ] for a global npc space @xmath140 and probability measure @xmath604 , let @xmath155 be a sequence of independent and identically distributed random variables drawn from @xmath597 . then with probability  @xmath169 , the sequence of inductive mean values @xmath170 approaches the mean @xmath607 of @xmath597 .",
    "[ c : weighted ] the convergence properties of the sequence of inductive means given by algorithm  [ a : sturm ] continue to hold on any probability distribution @xmath609 , by sampling the points of @xmath140 according to the specified distribution .",
    "[ r : lln ] as an application of corollary  [ c : weighted ] , markov chain monte carlo ( mcmc ) simulations produce phylogenetic trees sampled independently from a fixed finite - variance distribution on the entire space @xmath28 . calculating inductive mean values of repeated samples from this",
    "distribution results in a method to approximate the mean of the distribution .",
    "[ d : orthant ] the _ orthant space _ @xmath610 consists of a set @xmath30 of _ axes _ together with a simplicial complex @xmath611 , called the _",
    "scaffold complex_. two elements of @xmath30 are _ compatible _ if they appear in some face of @xmath612 .",
    "each face @xmath613 is associated with a copy @xmath614 of @xmath615 , the _ orthant _ associated with @xmath382 .",
    "the orthant space @xmath610 is the union of the orthants @xmath614 for @xmath613 , with points identified whenever their nonzero coordinates agree on all elements  of  @xmath30 .",
    "an orthant space can be thought of as constructed by gluing together orthants according to instructions laid out by the scaffold complex , and in fact the scaffold complex is ( homeomorphic to ) the _ link _ of the origin in the orthant space @xmath610 .",
    "[ e : tree ] tree space @xmath28 is an orthant space : @xmath30 corresponds to the set of splits on @xmath616 , and @xmath612 corresponds to the collection of sets of splits that are compatible in the sense of section  [ ss : treespace ] .    a _ path _ in an orthant space @xmath610",
    "is defined as in section  [ ss : geomnpc ] .",
    "a locally length - minimizing path is a _ geodesics _ , which always consists of a finite number of linear legs through intermediate orthants of  @xmath140 , as in the case of tree space ( section  [ ss : geodesics ] ) .",
    "as with tree space , @xmath610 is always path - connected .      the space @xmath617 , where @xmath30 is indexed by @xmath618 and the scaffold complex @xmath612 has facets @xmath619 , @xmath620 , and @xmath621 is not global npc .",
    "indeed , the two points @xmath622 and @xmath623 in  @xmath140 have a pair of geodesics between them , namely @xmath624 \\cup [ ( 0,1/2,0 ) , ( 0,1,1)]$ ] and @xmath625 \\cup [ ( 0,0,1/2 ) , ( 0,1,1)]$ ] . by lemma  [ l : geodesics ] , @xmath140 can not be global npc .",
    "m.gromov @xcite determined conditions on  @xmath612 that characterize when @xmath610 has nonpostive curvature ( in fact , gromov worked with arbitrary cubical complexes ) , based on the following standard notion from geometric combinatorics .        in particular",
    ", tree space  @xmath28 is global npc , since its scaffold complex is defined precisely by the pairwise compatibility between its splits ( this is the proof given in @xcite ) .",
    "generally , any global npc orthant space can be defined entirely by its set of compatible elements .",
    "thus there is a one - to - one correspondence between orthant spaces and graphs .",
    "a general global npc orthant space @xmath610 need not have all of its maximal orthants the same dimension , since maximal orthants correspond to the maximal cliques in @xmath627 .",
    "the dimension of the maximal orthants , however , is not relevant to any of the results in the previous sections , except when the dimension is given explicitly .",
    "the space of trees in which each split is associated with an @xmath628-dimensional vector instead of a single length is an npc orthant space . in this case ,",
    "the scaffold graph is the scaffold graph of tree space @xmath28 , with each vertex replaced by @xmath629 , the complete graph on @xmath628 vertices .",
    "our software implementation also computes geodesics and means in this space .",
    "[ lan ] the generality of scaffold graphs to define any global npc orthant space provides an opportunity to extend the statistical structures of this paper to a wider range of applications .",
    "as one example , consider a computer network specified by its computational devices and the graph @xmath630 denoting those pairs of computers that are compatible with each other .",
    "a _ local area network ( lan ) _ for this system is a set @xmath75 of mutually compatible computers  that is , a clique of @xmath630 .",
    "a _ local network configuration ( lnc ) _ is a lan @xmath75 together with a measure @xmath631 of participation of each computer @xmath632 in the lan @xmath75",
    ". some important areas of analysis of the network @xmath630 might be the relationship between the lncs associated with @xmath630 , in terms of the number and participation weight of common computers and the relative compatibility of the noncommon computers ( although it does _ not _ model chaining - related measures such as the number of nodes in a communications path ) .",
    "the global npc orthant space generated by @xmath630 would be a good framework for answering questions like this associated with the lans of the network .",
    "the combinatorics of geodesics in section  [ s : treespace ] generalizes immediately to global npc orthant spaces , using the generalized notation in this section .",
    "none of the proofs in sections  [ s : treespace][s : computing ] rely on particulars of tree space except the flag property .",
    "thus we have the following .",
    "[ c : npc ] the results in sections  [ s : treespace][s : computing ] ( except for statements specifying dimension ) extend to arbitrary global npc orthant spaces , using the definitions in this section .",
    "in particular , the gtp algorithm @xcite for finding geodesics in tree space , sturm s algorithm ( algorithm  [ a : sturm ] ) , and the descent method ( algorithm  [ a : descent ] ) apply in the more general setting of global npc orthant spaces .",
    "[ r : summary ] the results here extend even further .",
    "for example , ardila , owen , and sullivant  @xcite extend the global npc theory , and in particular the gtp algorithm , to the case of _ cubical complexes _",
    ", where orthants are replaced by euclidean cubes .",
    "sturm s algorithm extends to these global npc cubical complexes , and there is every reason to believe that the idea of vistal cells and the descent method can be extended as well , although without the polyhedrality .",
    "furthermore , the results extend to negative edge lengths , as described in remark  [ r : neg_edges ] .    [",
    "r : neg_edges ] negative values can also be allowed for the coordinates in a global npc orthant space . in this case",
    ", it remains a global npc space , and the results listed in corollary   [ c : npc ] for npc orthant spaces also hold here , with the following modification . if a negative value appears in a common split , then that negative value is used in the geodesic calculations .",
    "however , if it appears in a split that is not in common , then its absolute value is used in the geodesic calculations .",
    "elissaveta arnaoudova , david haws , peter huggins , jerzy w. jaromczyk , neil moore , christopher schardl , and ruriko yoshida , statistical phylogenetic tree analysis using differences of means , frontiers in neuroscience * 4 * ( 2012 ) , 47 .",
    "e.  bullitt , n.u .",
    "lin , j.k .",
    "smith , d.  zeng , e.p .",
    "winer , l.a .",
    "carey , w.  lin , m.g .",
    "ewend , blood vessel morphologic changes depicted with mr angiography during treatment of brain metastases : a feasibility study , radiology * 245 * ( 2007 ) , 824830 .",
    "elizabeth allman , james degnan , and john rhodes , identifying the rooted species tree from the distribution of unrooted gene trees under the coalescent , journal of mathematical biology * 62 * ( 2011 ) , 833862 .",
    "thomas hotz , stephan huckemann , huiling le , j.  stephen marron , jonathan c. mattingly , ezra miller , james nolen , megan owen , sean skwerer , and victor patrangenaru , sticky central limit theorems on open books , annals of applied probability , 23 ( 2013 ) , 2238 - 2258 .",
    "a.  feragen , m.  owen , j.  petersen , m.m.w .",
    "wille , l.h .",
    "thomsen , a.  dirksen , and m.  de  bruijne .",
    "tree - space statistics and approximations for large - scale analysis of anatomical trees in proceedings of the 23rd biennial international conference on information processing in medical imaging ( ipmi ) , ( 2013 ) 74 - 85 .",
    "picard and m. queyranne , on the structure of all minimum cuts in a network and applications , mathematical programming study * 13 * ( 1980 ) , 816 .",
    "robinson , comparison of labeled trees with valency three , j. combinatorial theory , * 11 * ( 1971 ) , 105119 .",
    "s. skwerer , e. bullitt , s. huckemann , e. miller , i. oguz , m. owen , v. patrangenaru , s. provan , and j.s .",
    "marron tree - oriented analysis of brain artery structure to appear journal of mathematical imaging and vision ( 2013 ) .",
    "karl - theodor sturm , probability measures on metric spaces of nonpositive curvature , in heat kernels and analysis on manifolds , graphs , and metric spaces : lecture notes from a quarter program on heat kernels , random walks , and analysis on manifolds and graphs , contemporary mathematics * 338 * ( 2003 ) , 357390 ."
  ],
  "abstract_text": [
    "<S> this paper investigates the computational geometry relevant to calculations of the frchet mean and variance for probability distributions on the phylogenetic tree space of billera , holmes and vogtmann , using the theory of probability measures on spaces of nonpositive curvature developed by sturm . </S>",
    "<S> we show that the combinatorics of geodesics with a specified fixed endpoint in tree space are determined by the location of the varying endpoint in a certain polyhedral subdivision of tree space . </S>",
    "<S> the variance function associated to a finite subset of tree space has a fixed @xmath0 algebraic formula within each cell of the corresponding subdivision , and is continuously differentiable in the interior of each orthant of tree space . </S>",
    "<S> we use this subdivision to establish two iterative methods for producing sequences that converge to the frchet mean : one based on sturm s law of large numbers , and another based on descent algorithms for finding optima of smooth functions on convex polyhedra . </S>",
    "<S> we present properties and biological applications of frchet means and extend our main results to more general globally nonpositively curved spaces composed of euclidean orthants . </S>"
  ]
}