{
  "article_text": [
    "graphs in this paper are finite and may have loops and multiple edges .",
    "otherwise we use the terminology of  @xcite . a graph",
    "@xmath0 is a",
    "_ minor _ of a graph @xmath1 if @xmath0 can be obtained from a subgraph of @xmath1 by contracting edges .",
    "the theory of graph minors was developed by robertson and seymour , in a series of 23 papers published over more than twenty years , with the aim of proving a single result : the _ graph minor theorem _ , which says that in any infinite collection of finite graphs there is one that is a minor of another .",
    "as with other deep results in mathematics , the body of theory developed for the proof of the graph minor theorem has also found applications elsewhere , both within graph theory and computer science . yet",
    "many of these applications rely not only on the general techniques developed by robertson and seymour to handle graph minors , but also on one particular auxiliary result that is also central to the proof of the graph minor theorem : a  result describing the structure of all graphs @xmath1 not containing some fixed other graph  @xmath0 as a minor .",
    "this structure theorem has many facets .",
    "it roughly says that every graph @xmath1 as above can be decomposed into parts that can each be ` almost ' embedded in a surface of bounded genus ( the bound depending on  @xmath0 only ) , and which fit together in a tree structure  ( * ? ? ?",
    "12.4.11 ) .",
    "although later dubbed a ` red herring ' ( in the search for the proof of the graph minor theorm ) by robertson and seymor themselves  @xcite , this simplest version of the structure theorem is the one that appears now to be best known , and which has also found the most algorithmic applications @xcite .",
    "a particularly simple form of this structure theorem applies when the excluded minor @xmath0 is planar : in that case , the said parts of  @xmath1the parts that fit together in a tree - structure and together make up all of  @xmath1have bounded size , i.e. , @xmath1  has bounded _ tree - width_. if @xmath0 is not planar , the graphs @xmath1 not containing @xmath0 as a minor have unbounded tree - width , and therefore contain arbitrarily large grids as minors and arbitrarily large walls as topological minors  @xcite .",
    "such a large grid or wall identifies , for every low - order separation of  @xmath1 , one side in which most of that grid or wall lies .",
    "this is formalized by the notion of a _ tangle _ : the larger the tree - width of  @xmath1 , the larger the grid or wall , the order of the separations for which this works , and ( thus ) the _ order _ of the tangle . since adjacent parts in our tree - decomposition of @xmath1 meet in only a bounded number of vertices and thus define low - order separations , our large - order tangle ` points to ' one of the parts , the part @xmath2 that contains most of its defining grid or wall .",
    "the more subtle versions of the structure theorem , such as theorem  ( 13.4 ) from graph minors  xvii  @xcite , now focus just on this part @xmath2 of  @xmath1 .",
    "like every part in our decomposition , it intersects every other part in a controlled way .",
    "every such intersection consists of a bounded number of vertices , of which some lie in a fixed _ apex set _",
    "@xmath3 of bounded size , while the others are either at most 3 vertices lying on a face boundary of the portion @xmath4 of  @xmath2 embedded in the surface , or else lie in ( a common bag of ) a so - called _ vortex _ , a ring - like subgraph of @xmath2 that is not embedded in the surface and meets @xmath4 only in ( possibly many ) vertices of a face boundary of  @xmath4 .",
    "the precise structure of these vortices , of which @xmath2 has only boundedly many , will be the focus of our attention for much of the paper .",
    "our theorem describes in detail both the inner structure of the vortices and the way in which they are linked to each other and to the large wall , by disjoint paths in the surface .",
    "these are the properties that have been used in applications of the structure theorems such as  @xcite , and which will doubtless be important also in future applications .",
    "an important part of the proofs is a new technique for analyzing vortices .",
    "we note that these techniques have also been independently developed by geelen and hyuhn  @xcite .",
    "this paper is organized as follows . in section",
    "[ sec : structure_thms ] we introduce the terminology we need to state our results , as well as the theorem from graph minors  xvi  @xcite on which we shall base our proof .",
    "section  [ sec : findingtd ] explains how we can find the tree - decomposition indicated earlier , with some additional information on how the parts of the tree - decomposition overlap .",
    "section  [ sec : tools ] collects some lemmas about graphs embedded in a surface , partly from the literature and partly new . in section  [ sec : modifying ] we show how a given near - embedding of a graph can be simplified in various ways if we allow ourselves to remove a bounded number of vertices ( which , in applications of these tools , will be added to the apex set ) .",
    "section  [ sec : pathsystems ] contains lemmas showing how to obtain path systems with nice properties .",
    "section  [ sec : mainresult ] contains the proof of our structure theorem . in the last section ,",
    "we give an alternative definition of vortex decompositions and show that our result works with these ` circular ' decompositions as well .",
    "a _ vortex _ is a pair @xmath5 , where @xmath1 is a graph and @xmath6 is a linearly ordered set @xmath7 of vertices in  @xmath1 .",
    "these vertices are the _ society vertices _ of the vortex ; their number @xmath8 is its _",
    "length_. we do not always distinguish notationally between a vortex and its underlying graph or vertex set ; for example , a _",
    "subgraph of @xmath9 _ is just a subgraph of  @xmath1 , a subset of @xmath9 is a subset of @xmath10 , and so on . also , we will often use @xmath11 to refer both to the linear order of the vertices @xmath12 as well as the set of vertices @xmath13 .    a path - decomposition @xmath14 of @xmath1 is a _ decomposition of  @xmath9 _ if @xmath15 and @xmath16 for all  @xmath17 .",
    "the _ depth _ of the vortex  @xmath9 is the minimum width of a path - decomposition of @xmath1 that is a decomposition of  @xmath9 .",
    "the _ adhesion _ of our decomposition @xmath18 of @xmath9 is the maximum value of @xmath19 , taken over all @xmath20 .",
    "we define the _ adhesion _ of a vortex @xmath9 as the minimum adhesion of a decomposition of that vortex .    when @xmath18 is a decomposition of a vortex @xmath9 as above , we write @xmath21 , for all @xmath22 .",
    "these @xmath23 are the _ adhesion sets _ of @xmath18 .",
    "we call @xmath18 is _ linked _ if    * all these @xmath23 have the same size ; * there are @xmath24 disjoint @xmath25@xmath26 paths in  @xmath27-\\omega$ ] , for all @xmath28 ; * @xmath29 for all @xmath30 , where @xmath31 .",
    "note that @xmath32 , for all @xmath33 ( fig .",
    "[ fig : linkedvortex ] ) .",
    "the union of the @xmath25@xmath26 paths in a linked decomposition of @xmath9 is a disjoint union of @xmath34@xmath35 paths in  @xmath1 ; we call the set of these paths a _ linkage _ of  @xmath9 with respect to @xmath36 .",
    "clearly , if @xmath9 has a linked decomposition as above , then @xmath1 has no edges between non - consecutive society vertices , since none of the @xmath37 could contain both ends of such an edge .",
    "conversely , if @xmath1 has no such edges then @xmath9 does have a linked decomposition : just let @xmath37 consist of all the vertices of @xmath38 plus @xmath39 and  @xmath40 .",
    "we shall be interested in linked vortex decompositions whose adhesion is small , unlike in this example .",
    "let @xmath41 be a vortex and @xmath42 a vertex of some supergraph of @xmath9 .",
    "clearly , @xmath43 is a vortex , too , which we denote by @xmath44 .",
    "if the length of @xmath9 is larger than 2 , this operation can not increase the adhesion @xmath45 of @xmath9 : this is clear for @xmath46 , so suppose @xmath47 with @xmath48 for some @xmath49 .",
    "we may assume without loss of generality that @xmath50 .",
    "take a decomposition @xmath51 of @xmath9 of adhesion @xmath45 .",
    "then , it is easy to see that @xmath52 is a decomposition of @xmath44 of adhesion at most @xmath45",
    ". we shall not be interested in the adhesion of vortices of length at most 2 . for a vertex set @xmath53",
    "we denote by @xmath54 the vortex we obtain by deleting the vertices in @xmath55 subsequently from @xmath9 . for a set of vortices @xmath56",
    "we define @xmath57 .",
    "a ( directed ) _ separation _ of a graph @xmath1 is an ordered pair @xmath58 of non - empty subsets of @xmath10 such that @xmath59\\cup g[b ] = g$ ] .",
    "the number @xmath60 is the _ order _ of @xmath58 .",
    "whenever we speak of separations in this paper , we shall mean such directed separations .",
    "a set @xmath61 of separations of  @xmath1 , all of order less than some integer  @xmath62 , is a _ tangle of order @xmath62 _ if the following holds :    1 .   for every separation @xmath58 of @xmath1 of order",
    "less than @xmath62 , either @xmath58 or @xmath63 lies in  @xmath61 .",
    "2 .   if @xmath64 for @xmath65 , then @xmath66\\cup g[a_2 ] \\cup g[a_3 ] \\neq g$ ] .    note that if @xmath67 then @xmath68 ; we think of @xmath55 as the ` small side ' of the separation  @xmath58 , with respect to this tangle .    for a tangle @xmath61 of order @xmath62 in a graph @xmath1 ,",
    "let @xmath69 be a vertex set with @xmath70 .",
    "let @xmath71 denote the set of all separations @xmath72 of @xmath73 of order less than @xmath74 such that there exists a separation @xmath75 with @xmath76 , @xmath77 and @xmath78 .",
    "it is shown in ( * ? ? ?",
    "* theorem ( 6.2 ) ) that @xmath71 is a tangle of order @xmath74 in @xmath73 .    for a positive integer @xmath79 , a graph @xmath1 is _ @xmath79-nearly embeddable _ in a surface @xmath80 if there is a subset @xmath81 with @xmath82 such that there are integers @xmath83 and @xmath84 for which @xmath85 can be written as the union of @xmath86 edge - disjoint graphs @xmath87 with the following properties :    a.   for all @xmath88 and @xmath89 , the pairs @xmath90 are vortices and @xmath91 when @xmath92 .",
    "b.   the vortices @xmath93 are disjoint and have adhesion at most @xmath79 ; we denote the set of these vortices by @xmath56",
    ". we will sometimes refer to these vortices as _ large _ vortices .",
    "c.   the vortices @xmath94 have length at most 3 ; we denote the set of these vortices by @xmath95 .",
    "these are the _ small _ vortices of the near - embedding .",
    "d.   there are closed discs in  @xmath80 with disjoint interiors @xmath96 and an embedding @xmath97 such that @xmath98 for all  @xmath17 and the generic linear ordering of @xmath99 is compatible with the natural cyclic ordering of its image ( i.e. , coincides with the linear ordering of @xmath100 induced by @xmath101 when @xmath102 is viewed as a suitable homeomorphic copy of @xmath103/\\{0,1\\}$ ] ) .",
    "for @xmath104 we think of the disc @xmath105 as _ accommodating _ the ( unembedded ) vortex  @xmath106 , and denote @xmath105 as  @xmath107 .",
    "we call @xmath108 an _ @xmath79-near embedding _ of @xmath1 in  @xmath80 or just _ near - embedding _ if the bound is clear from the context .",
    "it _ captures _ a tangle @xmath61 if the ` large side ' @xmath109 of an element @xmath110 is never contained in a vortex .",
    "let @xmath111 be the graph resulting from @xmath4 by joining any two nonadjacent vertices @xmath112 that lie in a common vortex @xmath113 ; the new edge @xmath114 of @xmath111 will be called a _ virtual edge_. by embedding these virtual edges disjointly in the discs @xmath115 accommodating their vortex  @xmath9 , we extend our embedding @xmath116 to an embedding @xmath117 .",
    "we shall not normally distinguish @xmath111 from its image in @xmath80 under  @xmath118 .",
    "a vortex @xmath119 is _ properly attached _ to @xmath4 if it satisfies the following two requirements .",
    "first , for every pair of distinct vertices @xmath120 the graph @xmath121 must contain an @xmath99-path ( one with no inner vertices in  @xmath99 ) from @xmath122 to  @xmath42 .",
    "second , whenever @xmath123 are distinct vertices ( not necessarily in this order ) , there are two internally disjoint @xmath99-paths in @xmath121 linking @xmath122 to  @xmath42 and @xmath42 to  @xmath124 , respectively .",
    "it is easy to see that for a vortex @xmath119 properly attached to @xmath4 , the vortex @xmath125 is properly attached to @xmath4 for any vertex @xmath126 .",
    "the _ distance in @xmath80 _ of two vertices @xmath127 is the minimal value of @xmath128 taken over all curves @xmath129 in the surface that link @xmath130 to  @xmath131 and meet the graph only in vertices .",
    "the _ distance in @xmath80 _ of two vortices @xmath9 and @xmath132 is the minimum distance in @xmath80 of a vertex in @xmath133 from a vertex in  @xmath134 .",
    "similar , the _ distance in @xmath80 _ of to subgraphs @xmath0 and @xmath135 of @xmath111 is the minimum distance in @xmath80 of a vertex in @xmath0 from a vertex in  @xmath135 .",
    "a cycle @xmath129 in @xmath80 is _ flat _ if @xmath129 bounds an open disc @xmath136 in @xmath80 .",
    "disjoint cycles @xmath137 in @xmath80 are _ concentric _ if they bound discs @xmath138 in  @xmath80 . a set @xmath139 of paths intersects @xmath137 _ orthogonally _ , and is _ orthogonal to @xmath137 _ , if every path @xmath140 in @xmath139 intersects each of the cycles in a ( possibly trivial but non - empty ) subpath of  @xmath140 .",
    "let @xmath1 be a graph embedded in a surface @xmath80 and @xmath11 a subset of its vertices .",
    "let @xmath137 be cycles in @xmath1 that are concentric in @xmath80 .",
    "the cycles @xmath137 _ enclose _",
    "@xmath11 if @xmath141 contains  @xmath11 . they _ tightly enclose _",
    "@xmath11 if the following holds : @xmath142{0.8\\textwidth}\\em for every vertex $ v\\in v(c_k)$ , for all $ 1\\leq k \\leq n$ , there is a vertex $ w\\in\\omega$   such that the distance of $ v$ and $ w$ in $ \\sigma$ is at most $ n - k+2$. \\end{minipage}\\ignorespacesafterend\\ ] ]    for a near - embedding @xmath108 of some graph @xmath1 in a surface @xmath80 and concentric cycles @xmath137 in @xmath111 , a vortex @xmath143 is _ ( tightly ) enclosed _ by these cycles if @xmath137 cycles ( tightly ) enclose @xmath133 .",
    "a flat triangle is a _",
    "boundary triangle _",
    "if it bounds a disc that is a face of @xmath111 in  @xmath80 .    for positive integers  @xmath144 , define a graph @xmath145 as follows .",
    "let @xmath146 be @xmath144 vertex disjoint ( ` horizontal ' ) paths of length @xmath147 , say @xmath148 .",
    "let @xmath149 , and let @xmath150 we call the paths @xmath151 the _ rows _ of @xmath145 ; the paths induced by the vertices @xmath152 for an odd index @xmath17 are its _ columns_. the 6-cycles in @xmath145 are its _ bricks_. in the natural plane embedding of  @xmath145 , these bound its ` finite ' faces .",
    "the outer cycle of the unique maximal 2-connected subgraph of @xmath145 is the _ boundary cycle _ of @xmath145 .",
    "any subdivision @xmath153 of @xmath145 will be called an _",
    "@xmath144-wall _ or a _ wall of size @xmath144_. the _ bricks _ and the _ boundary cycle _ of @xmath0 are its subgraphs that form subdivisions of the bricks and the boundary cycle of  @xmath145 , respectively .",
    "an embedding of @xmath0 in a surface  @xmath80 is a _ flat _",
    "embedding , and @xmath0 is _ flat _ in  @xmath80 , if the boundary cycle @xmath129 of @xmath0 bounds a disc @xmath154 that contains a vertex of degree 3 of @xmath155 .    for topological concepts used but not defined in this paper we refer to  ( * ? ? ?",
    "* appendix  b ) .",
    "when we speak of the _ genus _ of a surface @xmath80 we always mean its euler - genus , the number @xmath156 .",
    "a closed curve @xmath129 in @xmath80 is _ genus - reducing _ if the ( one or two ) surfaces obtained by capping the holes of the components of @xmath157 have smaller genus than @xmath80 .",
    "note that if @xmath129 separates @xmath80 and one of the two resulting surfaces is homeomorphic to @xmath158 , the other is homeomorphic to  @xmath80 .",
    "hence in this case @xmath129 was not genus - reducing .",
    "the _ representativity _ of an embedding @xmath159 is the smallest integer @xmath160 such that every genus - reducing curve @xmath129 in @xmath80 that meets @xmath1 only in vertices meets it in at least @xmath160 vertices .",
    "an @xmath79-near embedding @xmath108 of a graph @xmath1 in some surface @xmath80 is _",
    "_ for some integer @xmath161 if the following statements hold :    a.   [ prop : bigwall ] @xmath111 contains a flat @xmath144-wall @xmath0 for an integer @xmath162 .",
    "b.   the representativity of @xmath111 in @xmath80 is at least @xmath161 .",
    "c.   for every vortex @xmath143 there are @xmath161 concentric cycles @xmath163 in @xmath111 tightly enclosing @xmath9 and bounding open discs @xmath164 , such that @xmath165 contains @xmath133 and @xmath154 does not intersect @xmath166 . for distinct vortices @xmath167 , the discs @xmath168 and @xmath169 are disjoint .",
    "d.   every two vortices in @xmath56 have distance at least @xmath161 in @xmath80 .",
    "e.   [ prop : linked ] let @xmath170 with @xmath171 .",
    "then there is a linked decomposition of @xmath9 of adhesion at most @xmath79 and a path @xmath140 in @xmath172 with @xmath173 , avoiding all the paths of the linkage of  @xmath9 , and traversing @xmath174 in their order .",
    "f.   [ prop : linkagetogrid ] for every vortex @xmath175 , its set of society vertices @xmath133 is linked in @xmath111 to branch vertices of @xmath0 by a set @xmath176 of @xmath161 disjoint paths having no inner vertices in @xmath0 .",
    "g.   [ prop : orthogonalpaths ] for every vortex @xmath175 , the paths in @xmath176 intersect the cycles @xmath177 orthogonally . h.   all vortices in @xmath95 are properly attached to @xmath4 .    with these concepts",
    ", we can state the theorem that is the main result of this paper :    [ thm : richthm ] for every graph  @xmath178 there is an integer  @xmath79 such that for every integer  @xmath161 there is an integer @xmath179 such that the following holds .",
    "every graph  @xmath1 with  @xmath180 that does not contain @xmath178 as a minor has an @xmath79-near , @xmath161-rich embedding in some surface  @xmath80 in which @xmath178 can not be embedded .",
    "a direct implication of theorem  ( 3.1 ) from @xcite , stated with this terminology , reads as follows :    [ thm:3.1 ] for every graph @xmath178 there exist integers @xmath181 such that the following holds : let @xmath1 be a graph that does not contain @xmath178 as a minor and @xmath61 be a tangle in @xmath1 of order at least @xmath62 .",
    "then @xmath1 has an @xmath79-near embedding with apex set @xmath55 into a surface @xmath80 in which @xmath178 can not be drawn and this embedding captures @xmath182 .",
    "the following lemma shows that we can slightly modify a given @xmath79-near embedding by embedding some more vertices of the graph in the surface , so that all the small vortices are properly attached to @xmath4 .",
    "[ lem : properlyattached ] given an integer @xmath79 and an @xmath79-near embedding @xmath108 of some graph @xmath1 in a surface @xmath80 , there exists an @xmath79-near embedding @xmath183 of @xmath1 in @xmath80 such that @xmath184 and @xmath185 and each vortex in @xmath186 is properly attached to @xmath187 .",
    "let us consider two modifications of our near - embedding , each resulting in another @xmath79-near embedding .    1 .",
    "let @xmath188 be a vortex of length 3 .",
    "if there is a vertex @xmath189 , that separates one society vertex @xmath190 from the other society vertices @xmath191 , we can write @xmath119 as the union of two disjoint vortices @xmath192 and @xmath193 whose intersection is @xmath194 .",
    "let @xmath195 denote the graph we obtain from @xmath4 if we add @xmath42 to its vertex set and let @xmath196 be an embedding of @xmath195 in @xmath80 that maps @xmath42 onto a point in @xmath115 and coincides with @xmath197 everywhere else .",
    "it is easy to see that @xmath198 is an @xmath79-near embedding of @xmath1 in @xmath80 .",
    "2 .   let @xmath199 be a vortex of length at least 2 . if there are two society vertices @xmath200 that can not be linked by a path having only its endvertices in @xmath133 , we can write @xmath9 as the union of two vortices @xmath201 and @xmath202 with @xmath203 and @xmath204 whose intersection is contained in @xmath133 and whose societies are smaller than @xmath205 .",
    "similar to the case before , it is easy to see that @xmath206 is an @xmath207-near embedding of @xmath1 in @xmath80 , respecting @xmath61 .",
    "we can iterate these two modifications only finitely often : every application of ( 1 ) increases the number of embedded vertices of the graph  @xmath1 ; the application of ( 2 ) lexicographically reduces @xmath208 when @xmath209 and @xmath210 denote the number of small vortices of length  @xmath211 and @xmath212 , respectively .    let @xmath183 be the @xmath79-near embedding obtained by applying the two modifications as often as possible .",
    "now every vortex @xmath213 is properly attached to @xmath187 , as otherwise one could perform a further modification step . clearly , @xmath184 and @xmath185 .    given two graphs @xmath1 and @xmath0 , we say that @xmath0 is _ properly attached _ to @xmath1 if the vortex @xmath214 is properly attached to @xmath1 .",
    "we will use theorem  [ thm:3.1 ] to prove the following result , which strengthens theorem  ( 1.3 ) of  @xcite .",
    "[ thm : extended1.3 ] for every graph @xmath178 there exist integers @xmath79 and @xmath62 such that for every graph @xmath1 that does not contain @xmath178 as a minor and every @xmath69 with @xmath215 there is a rooted tree - decomposition @xmath216 of @xmath1 with root @xmath144 such that for every @xmath217 , there is a surface @xmath218 in which @xmath178 can not be embedded , and the torso @xmath219 of @xmath220 has an @xmath79-near embedding @xmath221 into @xmath218 with the following properties :    1 .",
    "all vortices have depth at most @xmath79 .",
    "2 .   for every @xmath222 with @xmath223 and @xmath224",
    "there is a vertex set @xmath225 which is either 1 .",
    "one part of a vortex decomposition or 2 .   a subset of @xmath226 and induces in @xmath227 a @xmath228 , a @xmath229 or a boundary triangle + such that @xmath230 .",
    "if ( b ) holds , @xmath231 is properly attached to @xmath227 .",
    "3 .   for every @xmath222 with @xmath223 and @xmath232 the overlap @xmath233 is contained in @xmath234 .    further @xmath235 .",
    "we say that the part @xmath236 _ accomodates _",
    "@xmath237 .    applying theorem [ thm:3.1 ] with the given graph @xmath178 yields two constants @xmath238 and @xmath239 .",
    "let @xmath240 and @xmath241 .",
    "the proof proceeds by induction on @xmath242 .",
    "we may assume that @xmath243 , since if it is smaller we add arbitrary vertices to @xmath237 .",
    "note , we may assume that such vertices exist , as the theorem is trivial for @xmath244 .",
    "we may assume that @xmath245{0.8\\textwidth}\\em there is no separation $ ( a , b)$ of order at most $ \\theta$ such that both $ |z\\setminus a|$ and $ |z\\setminus b|$ are of size at least $ |a\\cap b|$. \\end{minipage}\\ignorespacesafterend\\ ] ] otherwise , let @xmath246 . by assumption , @xmath247 and therefore , @xmath248 .",
    "we apply our theorem inductively to @xmath59 $ ] and @xmath249 , which yields a tree - decomposition of @xmath59 $ ] with one part @xmath250 such that the apex set of the embedding of its torso contains @xmath249 .",
    "similarly , we apply the theorem to @xmath251 $ ] and @xmath252 .",
    "we combine these two tree - decompositions by joining a new part @xmath253 to both @xmath250 and @xmath254 and obtain a tree - decomposition of @xmath1 with the desired properties of the theorem : the new part contains at most @xmath255 vertices , so all these can be put into the apex set of an @xmath79-near embedding . further",
    ", the new part contains @xmath237 .",
    "this proves ( [ claim : nosep ] ) .",
    "let @xmath61 be the set of separations @xmath58 of @xmath1 of order less than @xmath62 such that @xmath256 . with this definition ,",
    "@xmath257{0.8\\textwidth}\\em $ { \\ensuremath{\\mathcal{t}}}$ is a tangle of $ g$ of order $ \\theta$. \\end{minipage}\\ignorespacesafterend\\ ] ] for every separation @xmath58 of @xmath1 of order less than @xmath62 , one of the sets @xmath258 and @xmath259 contains at least @xmath62 vertices , as @xmath243 , but not both by ( [ claim : nosep ] ) .",
    "therefore , property ( i ) of the definition of a tangle holds .",
    "we deduce further , that for every @xmath75 , the small side @xmath55 contains less than @xmath62 vertices from  @xmath237 .",
    "hence , the union of three small sides can not be @xmath10 as it contains at most @xmath260 vertices from @xmath237 , which shows property ( ii ) and proves ( [ claim : tistangle ] ) .    from ( [ claim",
    ": nosep ] ) and the definition of @xmath61 we conclude @xmath261{0.8\\textwidth}\\em $ |(a\\setminus b)\\cap z| < |a\\cap b|$ for every $ ( a , b)\\in{\\ensuremath{\\mathcal{t}}}$. \\end{minipage}\\ignorespacesafterend\\ ] ] theorem [ thm:3.1 ] gives us an @xmath262-near embedding @xmath263 of @xmath1 in some surface @xmath80 that captures @xmath61 . at a high level ,",
    "our plan is now to split up @xmath1 at separators consisting of apex vertices , society vertices @xmath133 for @xmath199 and vertices of single parts of vortex decompositions of vortices in  @xmath264 .",
    "we obtain a part that contains @xmath4 and which we know how to embed @xmath79-nearly ; this part is going to be one part of a new tree - decomposition .",
    "we find tree - decompositions for all subgraphs of @xmath1 that we split off inductively and eventually combine these tree - decompositions to a new one that satisfies our theorem . by lemma  [ lem : properlyattached ]",
    ", we may assume that all small vortices are properly attached to  @xmath4 .",
    "let us consider such a vortex @xmath265 .",
    "our embedding captures @xmath61 , therefore the separation @xmath266 , whose order is smaller than @xmath267 , lies in @xmath61 . by ( [ claim : smallcontainslittle ] ) , @xmath121 contains less than @xmath62 vertices of @xmath237 .",
    "thus , @xmath268 contains at most @xmath269 vertices .",
    "we apply our theorem inductively to the smaller graph @xmath270 $ ] with @xmath271 .",
    "let @xmath272 be a part of the resulting tree - decomposition @xmath273 that accomodates  @xmath271 .",
    "note , that @xmath274 is properly attached to @xmath4 .",
    "for every vortex @xmath275 with @xmath276 let us choose a fixed decomposition @xmath277 of depth at most @xmath238 .",
    "we define @xmath278 by @xmath279 we denote the graph on @xmath280 where every @xmath281 induces a complete graph but no further edges are present .",
    "now , as the adhesion of @xmath119 is at most @xmath262 , every @xmath281 contains at most @xmath282 vertices and thus , @xmath283 is a decomposition of the vortex @xmath284 of depth at most @xmath285 .",
    "let  @xmath56 denote the set of these new vortices .    for every @xmath286 ,",
    "the pair @xmath287 is a separation of order at most @xmath288 .",
    "as before , our embedding captures @xmath61 and thus , the separation lies in @xmath61 . by ( [ claim : smallcontainslittle ] ) , at most @xmath289 vertices from @xmath237 lie in @xmath290 .",
    "let @xmath291 .",
    "this set contains at most @xmath292 vertices and , similar to before , we can apply our theorem inductively to the smaller graph @xmath293 $ ] with @xmath271 .",
    "we obtain a tree - decomposition @xmath294 of this graph , with one part @xmath295 accomodating  @xmath271 .",
    "now , with @xmath296 , we can write @xmath297\\cup\\big(\\bigcup { \\ensuremath{\\mathcal{w}}}\\big ) \\cup \\big ( \\bigcup \\ { g[\\hat x_j^i ] : v_i\\in{\\ensuremath{\\mathcal{v } } } , 1\\leq j \\leq n(i)\\}\\big).\\ ] ] by induction , we obtained tree - decompositions for all vortices in @xmath95 and all the graphs @xmath298 $ ] with the required properties .",
    "we can now construct a tree - decomposition of @xmath1 : we just add a new vertex @xmath299 representing @xmath300 to the union of all the trees @xmath301 and @xmath302 and add edges from @xmath299 to every vertex representing an @xmath272 or an @xmath295 we found in our proof .    we still have to check that the torso of the new part @xmath300 can be @xmath79-nearly embedded as desired . but",
    "this is easy : let @xmath111 be the graph resulting from @xmath4 if we add an edge @xmath303 for every two nonadjacent vertices @xmath130 and @xmath131 that lie in a common vortex @xmath304 .",
    "we can extend the embedding @xmath305 to an embedding @xmath306 by mapping the new edges disjointly to the discs @xmath115 .",
    "then , @xmath307 is the torso of @xmath300 in our new tree - decomposition and with @xmath308 we have an @xmath79-near embedding of @xmath2 in @xmath80 whose apex set contains @xmath237 .",
    "our first tool is the so - called _ grid - theorem _ from  @xcite ; see  @xcite for a short proof .",
    "[ thm : gridthm ] for every integer @xmath160 there exists an integer @xmath309 such that every graph of tree - width at least @xmath309 contains a wall of size at least @xmath160 .",
    "every large enough wall embedded in a surface contains a large flat subwall :    [ lem : flatwall ] for all integers @xmath310 there is an integer @xmath311 such that any wall of size @xmath312 embedded in a surface of genus at most  @xmath313 contains a flat wall of size  @xmath160 .",
    "let @xmath312 be chosen so that every @xmath312-wall contains @xmath314 disjoint @xmath160-walls . by (",
    "* lemma  b.6 ) , any @xmath312-wall @xmath315 in a surface @xmath80 of genus  @xmath313 contains a @xmath160-wall @xmath316 each of whose bricks bounds an open disc in  @xmath80 .",
    "if none of these open discs contains a point of @xmath315 , the wall @xmath316 is flat .",
    "otherwise , the disc containing a point of @xmath315 contains all the other @xmath160-walls we considered , and thus , all these are flat .",
    "[ lem : torsotwlarge ] let @xmath1 be a graph of tree - width at least  @xmath124 . then in every tree - decomposition of @xmath1 the torso of at least one part also has tree - width at least  @xmath124 .",
    "if every torso has a tree - decomposition of width at most @xmath317 , we can combine these into a tree - decomposition of @xmath1 of width at most  @xmath317 .",
    "let @xmath80 be a ( closed ) surface .",
    "for @xmath318 the boundary of @xmath319 is denoted by @xmath320 and @xmath321 .",
    "let @xmath1 be a graph embedded in @xmath80 .",
    "for a face @xmath322 of @xmath1 , let @xmath323 be the set of vertices that lie on @xmath324 .",
    "if we delete @xmath323 and add a new vertex @xmath42 to @xmath1 with neighbours @xmath325 , we obtain a graph @xmath2 .",
    "it is easy to see that we can extend the induced embedding of @xmath326 to an embedding of @xmath2 .",
    "we say that the graph @xmath2 embedded in @xmath80 was obtained from  @xmath1 by _",
    "contracting @xmath322 to @xmath42_.    the following lemma is from demaine and hajiaghayi @xcite .",
    "[ lem : contractingface ] for every two integers @xmath327 and @xmath313 there exists an integer @xmath328 such that the following holds .",
    "let @xmath1 be a graph of tree - width at least @xmath329 embedded in some surface @xmath80 of genus @xmath313 . if @xmath2 is obtained from @xmath1 by contracting a face to a vertex , then @xmath2 has tree - width at least @xmath327 .",
    "our next lemma is due to mohar and thomassen @xcite :    [ lem : conccycles ] let @xmath330 be an embedding of representativity at least @xmath331 for some @xmath332 .",
    "then , for every face @xmath322 of @xmath1 in @xmath80 there are @xmath160 concentric cycles @xmath333 in @xmath1 such that @xmath334 .    for an oriented curve @xmath129 and points @xmath335",
    "we denote by @xmath336 the subcurve of @xmath129 with endpoints @xmath337 that is oriented from @xmath130 to @xmath131 . for an embedded graph @xmath1 in a surface @xmath80 , a face @xmath338 of @xmath1 and a closed curve @xmath129 in @xmath80 , let @xmath339 denote the number of components of @xmath340 .",
    "[ lem : curvehitsvortexonce ] let @xmath1 be a graph embedded in a surface @xmath80 and @xmath322 be the set of faces of @xmath1 .",
    "for an integer @xmath341 , consider all genus - reducing curves @xmath129 in @xmath80 that hit @xmath1 in vertices only and satisfy @xmath342 .",
    "let @xmath129 be chosen so that @xmath343 is minimal .",
    "then , @xmath344 for all @xmath345 .",
    "suppose there is an @xmath345 with @xmath346 .",
    "then there is a component @xmath319 of @xmath347 such that @xmath348 contains two distinct components @xmath349 of @xmath350 .",
    "let us choose a fixed orientation of @xmath129 .",
    "let @xmath351 such that @xmath352 .",
    "@xmath353 contains @xmath336 as @xmath129 is connected , so @xmath354 appear in this ( cyclic ) order on @xmath129 .",
    "now we distinct two cases :    a.   @xmath355 lie in the same component of @xmath356 .",
    "let @xmath357 be a curve in @xmath319 linking @xmath358 , oriented from @xmath130 to @xmath124 .",
    "then , @xmath359 is a closed curve in @xmath80 that crosses @xmath9 one time fewer than @xmath129 and does not hit @xmath1 in more vertices than @xmath129 does .",
    "@xmath360 does not separate @xmath80 as @xmath131 and @xmath361 are connected by @xmath362 , and by ( * ? ? ?",
    "* lemma  b.4 ) , it follows that @xmath360 is a genus - reducing curve .",
    "this is a contradiction to the choice of @xmath129 .",
    "b.   @xmath355 lie in distinct components of @xmath356 .",
    "let @xmath363 be disjoint oriented curves in @xmath319 such that @xmath357 links @xmath130 and @xmath124 , and is oriented from @xmath130 to @xmath124 , and @xmath360 links @xmath361 and @xmath131 and is oriented from @xmath361 to @xmath131 . if @xmath364 bounds a disc @xmath365 in @xmath80 and @xmath366 bounds a disc @xmath367 in @xmath80 , then @xmath368 is a disc whose closure contains @xmath129 . by (",
    "* lemmas  b.45 ) , this is a contradiction to the assumption that @xmath129 is a genus - reducing curve .",
    "thus , one of @xmath364 , @xmath366 is a genus - reducing curve that crosses @xmath338 one time fewer than @xmath129 and does not hit @xmath1 in more vertices than @xmath129 does , which contradicts the choice of @xmath129 .",
    "this proves lemma  [ lem : curvehitsvortexonce ] .",
    "whenever there are cycles enclosing a vortex @xmath9 , we can find cycles tightly enclosing @xmath9 :    [ lem : tightcycles ] for an integer @xmath369 , let @xmath108 be an @xmath79-near embedding of some graph @xmath1 in a surface @xmath80 and let @xmath137 be cycles enclosing a vortex @xmath143 .",
    "then , there are @xmath8 cycles @xmath370 in @xmath4 , tightly enclosing @xmath9 .",
    "let us write @xmath371 for @xmath49 and @xmath372 .",
    "suppose there is a cycle @xmath373 for some @xmath49 such that there is a vertex @xmath374 .",
    "then , we can replace @xmath375 by @xmath129 and obtain a new set of cycles in @xmath4 enclosing @xmath9 . by this replacement ,",
    "we reduce @xmath376 , and therefore we can repeate this step only finitely often . let us choose cycles @xmath370 enclosing @xmath9 such that a replacement as described is not possible .",
    "we claim that these cycles enclose @xmath9 tightly .",
    "to see this , for a vertex @xmath377 consider the set @xmath378 of all faces @xmath322 of @xmath379 with @xmath380 and @xmath381 .",
    "for every two neighbours @xmath337 of @xmath42 that lie in the same face @xmath382 , there is a path in @xmath383 linking @xmath337 and avoiding @xmath42 .",
    "therefore , there is a face @xmath384 such that @xmath324 contains a vertex @xmath385 : otherwise , @xmath386 would contain a path linking both neighbours of @xmath42 in @xmath387 , avoiding @xmath42 and thus , a cycle would live in @xmath388 , also avoiding @xmath42 , contradicting the choice of the @xmath389 .",
    "now , by induction on @xmath160 , there is a curve @xmath129 linking @xmath390 and @xmath391 with @xmath392 .",
    "we extend this curve by a curve in @xmath322 linking @xmath42 and @xmath393 which gives us a curve as desired .",
    "in this section we describe how to obtain a new ( and simpler ) near - embedding from an old one if we are allowed to move a bounded number of vertices from the embedded part of the graph to the apex set . for example",
    ", we might reduce the number of large vortices by combining two of them , or reduce the genus of the surface by cutting along a genus - reducing curve . to describe these changes precisely ,",
    "let us introduce some new notation .    a near - embedding @xmath108 of a graph @xmath1 in a surface @xmath80 is an @xmath394-near embedding of  @xmath1 if @xmath395 and @xmath396 and the adhesion of all vortices in  @xmath56 is at most @xmath397 .    [",
    "lem : mergevortices ] let @xmath108 be an @xmath394-near embedding of a graph @xmath1 in a surface @xmath80 .",
    "if there are two vortices @xmath398 of length at least 4 and a curve @xmath129 in @xmath80 with endpoints in @xmath115 and @xmath399 that hits @xmath1 in at most @xmath400 vertices , then there is a vertex set @xmath401 with @xmath402 and a vortex @xmath403 such that @xmath404 is an @xmath405-near embedding of @xmath1 in @xmath80 .",
    "let us choose decompositions @xmath51 of @xmath9 and @xmath406 of @xmath132 of adhesion at most @xmath79 , where @xmath407 and @xmath408 .",
    "by slightly adjusting @xmath129 we obtain a curve @xmath357 with @xmath409 and @xmath410 for some indices @xmath411 and @xmath412 and @xmath413 .",
    "let @xmath323 be the set of vertices in @xmath80 that are hit by @xmath357 . by fattening @xmath357",
    "we obtain an open disc @xmath365 in @xmath80 with @xmath414 and @xmath415 such that @xmath416 is an open disc whose closure is a closed disc and @xmath417 . we may assume without loss of generality that the orientations of @xmath418 induced by @xmath419 and @xmath420 agree by reindexing if necessary .",
    "let @xmath421 if @xmath422 and @xmath423 if @xmath424 ; let @xmath425 if @xmath426 and @xmath427 if @xmath428 .",
    "note that @xmath429 and @xmath430 .",
    "let @xmath431 and @xmath432 . with @xmath433",
    "the tuple @xmath434 is a vortex with a decomposition @xmath435 of adhesion at most @xmath79 .",
    "now it is easy to see that @xmath436 satisfies the conditions as desired .",
    "we note that the techniques used in the following lemma have also been independently developed by geelen and hyuhn @xcite .",
    "[ lem : vorticeslinked ] let @xmath108 be an @xmath394-near embedding of some graph @xmath1 in a surface @xmath80 such that the following statements hold :    a.   for every vortex @xmath143 there are @xmath437 concentric cycles @xmath438 in @xmath111 tightly enclosing @xmath9",
    ". b.   for distinct vortices @xmath439 , the discs @xmath440 and @xmath441 are disjoint .",
    "then , there is a graph @xmath442 with @xmath443 a set @xmath444 with @xmath445 avoiding @xmath442 , and sets @xmath446 and @xmath447 of vortices in @xmath1 such that with @xmath448 the tuple @xmath449 is an @xmath450-near embedding of @xmath1 in @xmath80 such that every vortex @xmath451 satisfies property ( [ prop : linked ] ) of @xmath161-rich .",
    "we will convert the vortices in @xmath56 into linked vortices one by one , so let us focus on one vortex @xmath175 .",
    "the idea is as follows : we delete one vertex from each of the enclosing cycles , which gives us a set of @xmath452 disjoint paths . if necessary",
    ", we also delete an adhesion set of @xmath9 which allows us to assume that the paths are ` aligned ' to the vortex .",
    "then , we ` push ' these paths as far into the vortex as possible . as the adhesion of the vortex",
    "is bounded by @xmath79 , at least one of the paths remains entirely in the surface .",
    "the vertices of this path , later denoted by @xmath453 , become the society vertices of our new vortex whereas the path system shows us that this new vortex is linked .",
    "we choose a decomposition @xmath454 and some vertex @xmath455 .",
    "as @xmath438 enclose @xmath9 tightly , there is a curve @xmath129 linking @xmath42 and @xmath133 that hits at most @xmath456 vertices of @xmath111 .",
    "let @xmath323 denote the set of these vertices .",
    "clearly , @xmath323 consists of exactly one vertex from each @xmath457 , @xmath458 and one society vertex @xmath459 of @xmath9 .",
    "if @xmath460 or @xmath461 , we put @xmath462 , @xmath463 and @xmath464 for @xmath30 ; otherwise , let @xmath465 , @xmath466 and @xmath467 now , @xmath51 is a path decomposition of @xmath468 of adhesion at most @xmath397 .",
    "let @xmath469 denote the society of @xmath468 .",
    "let us choose one fixed orientation for all the cycles @xmath457 enclosing @xmath9 .",
    "for every @xmath470 let @xmath471 denote the successor and @xmath472 the predecessor of the unique vertex in @xmath473 .",
    "let @xmath474 and @xmath475 .",
    "now , we delete @xmath476 , a set of at most @xmath477 vertices .",
    "we put @xmath478 clearly , the graph @xmath2 still contains a set of @xmath437 disjoint @xmath225@xmath479-paths .",
    "let us show that @xmath480{0.8\\textwidth}\\em every set $ { \\ensuremath{\\mathcal{p}}}$ of more than $ \\alpha_2 $ disjoint $ x$--$y$-paths in $ g'$ contains a path $ p$ that is a path in~$g'_0$. \\end{minipage}\\ignorespacesafterend\\ ] ] let @xmath481 be the path starting in @xmath482 .",
    "this path is disjoint to @xmath483 : otherwise , let @xmath484 be the first vertex on @xmath140 sending an edge of @xmath140 to @xmath483 . as the subpath @xmath485 of @xmath453 lives entirely in the planar graph @xmath486 , the set @xmath487 separates @xmath225 from @xmath479 .",
    "thus , all @xmath437 paths in @xmath139 have to pass @xmath488 , a set containing at most @xmath397 vertices , a contradiction .",
    "this proves ( [ claim : p0insurface ] ) .",
    "we conclude that , for every such set @xmath139 of paths , the path @xmath481 starting in @xmath482 ends in @xmath489 .",
    "this path @xmath453 , together with @xmath42 and the edges @xmath490 , @xmath491 form a cycle in @xmath111 .",
    "this cycle bounds a disc @xmath492 in @xmath80 containing @xmath133 and we define @xmath493 clearly , @xmath494 contains @xmath139 .",
    "let us fix a set @xmath139 of paths in @xmath2 that link @xmath225 to @xmath479 and are such that @xmath494 is minimal .",
    "assume @xmath140 has length @xmath144 and let the vertices of @xmath140 be labeled @xmath495 .    by this choice ,",
    "the vertices of @xmath453 have the following property : @xmath496{0.8\\textwidth}\\em for every vertex $ p_i\\in v(p_0)$ , $ i \\ge 1 $ , there is a separator of size $ \\alpha+1 $ , containing $ p_i$ and separating $ x$ from $ y$ in $ g''$. \\end{minipage}\\ignorespacesafterend\\ ] ] suppose the opposite for some @xmath497 .",
    "then , there is a set @xmath498 of @xmath397 disjoint paths in @xmath499 that links @xmath225 to  @xmath479 . with ( [ claim : p0insurface ] ) ,",
    "this is a contradiction to our choice of  @xmath494 .",
    "let us pick for each @xmath500 a separation @xmath501 with @xmath502 such that @xmath503 , @xmath504 and @xmath505 is lexicographically minimal .",
    "clearly , each @xmath506 contains exactly one vertex from each path in @xmath139 .",
    "we also have the following property :    @xmath507{0.8\\textwidth}\\em $ b_i\\supsetneq b_j$ for all $ 1\\leq i < j \\leq r$. \\end{minipage}\\ignorespacesafterend\\ ] ]    let us assume that the statement was false for some fixed @xmath508 with @xmath509 .",
    "we will show that we could replace @xmath510 by the separation @xmath511 .",
    "this will give us a contradiction as @xmath512 .",
    "clearly , the new separator @xmath513 contains at least one vertex from each path of @xmath139 .",
    "we only have to show that @xmath514 also contains at most one vertex from each path in @xmath139 , the other conditions are clear .",
    "suppose that there is a path @xmath515 such that @xmath514 contains two vertices @xmath337 from  @xmath140 .",
    "neither @xmath506 nor @xmath516 contain both @xmath130 and @xmath131 , so we may assume that @xmath517 and @xmath518 .",
    "we may further assume that @xmath519 .",
    "but now , @xmath520 implies @xmath521 and therefore , @xmath522 contains a vertex of @xmath516 distinct to @xmath130 .",
    "this means , that @xmath516 contains two vertices of @xmath140 , a contradiction .",
    "this proves ( [ claim : bidecreasing ] ) .",
    "we set @xmath523 and with @xmath524 , @xmath525 for @xmath28 and @xmath526 , it is easy to check that @xmath51 is a linked path decomposition of the vortex @xmath527",
    ". finally , consider all @xmath528 such that @xmath134 intersects with @xmath494 .",
    "if @xmath529 , we add @xmath132 to @xmath494 ; otherwise , we remove all edges of @xmath530 $ ] from @xmath494 .",
    "now , property ( [ prop : linked ] ) from @xmath161-rich follows for the new vortex @xmath494 .",
    "[ lem : rephigh ] let @xmath531 be an integer and @xmath108 be an @xmath394-near embedding of some graph @xmath1 in a surface @xmath80 such that every two vortices in  @xmath56 have distance at least @xmath361 .",
    "if the representativity of @xmath111 in @xmath80 is smaller than @xmath361 , then there is a vertex set @xmath532 with @xmath533 , such that one of the following statements holds :    a.   there exists a set @xmath534 of vortices in @xmath1 , a surface @xmath535 with @xmath536 and an @xmath537-near embedding @xmath538 of @xmath1 in @xmath535 .",
    "b.   there exists a separation @xmath539 of @xmath1 with @xmath540 such that for @xmath541 there are surfaces @xmath542 and @xmath537-near embeddings @xmath543 of @xmath544 $ ] into @xmath542 such that @xmath545 .",
    "let @xmath129 be a genus - reducing curve in @xmath80 that hits at most @xmath361 vertices of @xmath111 .",
    "let us assume that @xmath129 hits the society of a large vortex @xmath9 .",
    "it can not hit another large vortex as the distance in @xmath80 of two large vortices is larger than  @xmath361 .",
    "by lemma  [ lem : curvehitsvortexonce ] we may assume that @xmath546 for the face @xmath338 of @xmath111 containing @xmath115 and we can modify @xmath129 such that there are society vertices @xmath547 with @xmath548 .",
    "after this modification , @xmath129 hits at most @xmath549 vertices .",
    "deleting the two appropriate adhesion sets splits @xmath9 into two vortices @xmath550 and it is easy to find two disjoint discs @xmath551 in the surface to accomodate them . let @xmath436 be the union of the deleted adhesion sets and the vertices hit by @xmath129 .",
    "this set contains up to @xmath552 vertices .",
    "now , @xmath436 is a separation of @xmath1 .",
    "we delete @xmath129 from @xmath80 and cap the holes of the resulting components .",
    "if @xmath157 has one component , statement a ) follows , otherwise b ) is true .",
    "[ lem : pieslices ] let @xmath108 be an @xmath394-near embedding of some graph @xmath1 in a surface @xmath80 .",
    "let @xmath175 a vortex and @xmath553 cycles tightly enclosing  @xmath9 .",
    "then , there is a set @xmath554 of internally disjoint , closed discs with @xmath555 such that the following holds : for every disc @xmath556 there is a separator @xmath323 of @xmath111 of order at most @xmath557 such that    * @xmath558 * @xmath559 for each @xmath560 * @xmath561    further , for this disc @xmath562 there is a set @xmath563 of order at most @xmath564 such that there is a separation @xmath565 of @xmath1 with @xmath566 and @xmath567 .",
    "pick a point @xmath568 .",
    "let @xmath569 denote the vertices of @xmath570 ordered linearly in a way compatible with a cyclic orientation of @xmath570 .",
    "we will inductively define curves linking @xmath571 and @xmath42 .",
    "first , let us choose for all @xmath572 a curve @xmath573 linking @xmath471 and @xmath42 , oriented towards @xmath42 , such that @xmath574 consists of exactly one vertex from each of the cycles @xmath575 and one society vertex @xmath576 .",
    "note that , for @xmath577 for each @xmath578 , @xmath579 if and only if @xmath580 where @xmath581 and also that @xmath582 need not contain all society vertices of @xmath9 .",
    "now , we put @xmath583 and for @xmath584 we define @xmath585 inductively : if @xmath586 , we define @xmath587",
    ". otherwise , let @xmath361 be the first point on @xmath573 contained in @xmath588 .",
    "then , @xmath589 . we further define @xmath590 for @xmath577 where @xmath591 .",
    "the components of @xmath592 are two discs .",
    "let @xmath593 denote the disc with @xmath594 and let @xmath595 refer to the other one .",
    "we define discs @xmath596 and @xmath597 inductively : for @xmath28 let @xmath598 denote the component of @xmath599 containing @xmath600 and again let @xmath601 refer to the other one .",
    "clearly , these components are discs .",
    "we put @xmath602 .",
    "if @xmath603 for some @xmath577 we define @xmath604 , otherwise let @xmath605 consist of two appropriate adhesion contained in bags assigned to @xmath606 and @xmath607 for some decomposition of @xmath9 .",
    "the statement of the theroem now follows with @xmath608",
    "in this section we provide tools that allow us to find path systems in near - embeddings that satisfy properties ( [ prop : linkagetogrid ] ) and ( [ prop : orthogonalpaths ] ) .",
    "[ lem : concatpaths ] let @xmath1 be a graph and @xmath609 subsets of @xmath10 with @xmath610 for some integer @xmath160 . if there is a set @xmath139 of @xmath611 disjoint paths linking @xmath55 and @xmath109 and a set @xmath612 of @xmath611 disjoint paths linking @xmath109 and @xmath129 , there are @xmath160 disjoint paths in @xmath1 linking @xmath55 and @xmath129 .",
    "let @xmath613 be pairwise disjoint paths linking @xmath55 and @xmath109 and let @xmath614 be pairwise disjoint paths linking @xmath109 and @xmath129 such that the endvertex of @xmath151 is the first vertex of @xmath615 for @xmath616 .",
    "for every set @xmath617 with @xmath618 , at least @xmath160 paths in @xmath139 and at least @xmath160 paths in @xmath612 avoid all vertices in @xmath323 .",
    "two of these paths contain a common vertex of @xmath109 and therefore , there is a path linking @xmath55 and @xmath129 avoiding @xmath323 .",
    "[ lem : pathstoboundary ] let @xmath1 be a graph embedded in a surface , let @xmath315 be a flat wall of size @xmath619 in @xmath1 for some natural number @xmath160 and @xmath11 a subset of @xmath10 avoiding @xmath620 such that there exist @xmath621 disjoint paths linking @xmath11 to the branch vertices of @xmath315 . then , @xmath315 contains a wall @xmath622 of size @xmath160 such that there are @xmath160 disjoint paths having no inner vertex in @xmath622 and linking @xmath11 to branch vertices of @xmath622 which lie on the boundary cycle of  @xmath622 .",
    "let @xmath622 be a @xmath160-wall in @xmath315 such that there exist @xmath623 cycles @xmath315 , enclosing @xmath622 .",
    "let us choose a set @xmath139 of @xmath621 disjoint paths linking @xmath11 to the branch vertices of @xmath315 such that @xmath624 is minimal .",
    "each branch vertex @xmath42 of @xmath315 is incident with three subdivided edges of @xmath315 .",
    "we say that @xmath515 _ occupies _ these three edges if @xmath42 is the terminal vertex of @xmath140 .",
    "clearly , each subdivided edge that intersects with @xmath139 is occupied by some path in @xmath139 .",
    "we claim that no path @xmath515 can intersect with @xmath622 .",
    "otherwise @xmath140 would intersect @xmath625 disjoint cycles in @xmath315 but did not have its terminal vertex on one of these cycles .",
    "this means that more than @xmath625 edges would be occupied by paths in @xmath139 , a contradiction .",
    "now , either at least @xmath611 rows or at least @xmath611 columns contain terminal vertices of paths in @xmath139 .",
    "we may assume the latter , without loss of generality , and pick from each such column one path @xmath515 having its terminal vertex on this column .",
    "it is easy to see that this set of vertices can be linked by disjoint paths to branch verties of @xmath622 which lie on the boundary cycle of @xmath622 .",
    "lemma  [ lem : concatpaths ] finishes this proof .",
    "let @xmath1 be a graph and @xmath626 with @xmath627 .",
    "an @xmath225@xmath479  _ linkage _ in  @xmath1 is a set of @xmath160 disjoint paths in @xmath1 such that each of these paths has one end in @xmath225 and the other end in @xmath479 .",
    "an @xmath225@xmath479  linkage @xmath139 in @xmath1 is _ singular _ if @xmath628 and @xmath1 does not contain any other @xmath225@xmath479 linkage .",
    "the next lemma will be used in the proof of lemma [ lem : ortholink ] .",
    "[ lem : singlink ] if a graph @xmath1 contains a singular @xmath225@xmath479 linkage  @xmath139 for vertex sets @xmath626 , then @xmath1 has path - width at most  @xmath629 .",
    "let @xmath139 be a singular @xmath225@xmath479 linkage in  @xmath1 . applying induction on  @xmath242 ,",
    "we show that @xmath1 has a path - decomposition @xmath630 of width at most  @xmath629 such that @xmath631 .",
    "suppose first that every @xmath632 has a neighbour @xmath633 in  @xmath1 that is not its neighbour on the path @xmath634 containing  @xmath130",
    ". then @xmath635 by the uniqueness of  @xmath139 .",
    "the digraph on @xmath139 obtained by joining for every @xmath632 the ` vertex ' @xmath636 to the ` vertex ' @xmath637 contains a directed cycle  @xmath319 .",
    "let us replace in @xmath139 for each @xmath632 with @xmath638 the path @xmath636 by the @xmath225@xmath479 path that starts in  @xmath130 , jumps to @xmath633 , and then continues along  @xmath637 .",
    "since every ` vertex ' of  @xmath319 has in- and outdegree both  1 there , this yields an @xmath225@xmath479 linkage with the same endpoints as @xmath139 but different from  @xmath139 .",
    "this contradicts our assumption that @xmath139 is singular .",
    "thus , there exists an @xmath632 without any neighbours in @xmath1 other than ( possibly ) its neighbour on  @xmath636 .",
    "consider this  @xmath130 .",
    "if @xmath636 is trivial , then @xmath130 is isolated in @xmath1 and @xmath639 . by induction",
    ", @xmath640 has a path - decomposition @xmath641 of width at most @xmath642 with @xmath643 .",
    "add @xmath644 to obtain the desired path - decomposition of  @xmath1 .",
    "if @xmath636 is not trivial , let @xmath645 be its second vertex , and replace @xmath130 in @xmath225 by @xmath645 to obtain  @xmath646 .",
    "by induction , @xmath640 has a path - decomposition @xmath641 of width at most @xmath629 with @xmath647 .",
    "add @xmath648 to obtain the desired path - decomposition of  @xmath1 .",
    "the next lemma is a weaker version of theorem 10.1 of  @xcite .",
    "[ lem : ortholink ] let @xmath329 , @xmath649 , and @xmath327 be positive integers with @xmath650 .",
    "let @xmath2 be a graph embedded in the plane and let @xmath651 a set of vertices lying on a face boundary of @xmath2 .",
    "let @xmath652 be concentric cycles in @xmath2 , tightly enclosing @xmath225 .",
    "let @xmath653 be another graph , with @xmath654 .",
    "assume that @xmath655 contains an @xmath225@xmath479 linkage @xmath139 with @xmath656 .",
    "then there exists an @xmath225@xmath479 linkage @xmath657 in @xmath655 such that @xmath657 is orthogonal to @xmath658 .",
    "assume the lemma is false , and let @xmath2 , @xmath653 , @xmath659 , and @xmath652 form a counterexample containing a minimal number of edges . to simplify the notation",
    ", we let @xmath660 . by minimality",
    ", it follows that the graph @xmath661 . also , for all @xmath662 and for all @xmath663 , every component of @xmath664 is a single vertex .",
    "if @xmath664 had a component that was a non - trivial path containing an edge @xmath665 , then @xmath666 would form a counterexample with fewer edges .",
    "similarly , we conclude that @xmath667 .",
    "we claim : @xmath668{0.8\\textwidth}\\em $ { \\ensuremath{\\mathcal{p}}}$ is singular .",
    "\\end{minipage}\\ignorespacesafterend\\ ] ] as noted above , @xmath669 is disjoint from @xmath670 .",
    "it follows that if there exists an @xmath225@xmath479  linkage @xmath671 distinct from @xmath659 , then at least one of the edges of @xmath659 is not contained in @xmath671 .",
    "we conclude that the subgraph @xmath672 forms a counterexample to the claim with fewer edges , a contradiction .",
    "this proves  @xmath673 .",
    "@xmath674{0.8\\textwidth}\\em there is no subpath $ q\\subseteq \\mathcal{p}$ in $ d(c_j)$ with both endpoints in $ c_j$ for some $ j$ and otherwise disjoint from    $ \\bigcup_{i } v(c_i)$. \\end{minipage}\\ignorespacesafterend\\ ] ]    otherwise , this would violate our choice of the cycles @xmath675 as tightly enclosing @xmath225 .",
    "a _ local peak _ of @xmath659 is a subpath @xmath676 such that @xmath677 has both endpoints on @xmath678 for some @xmath679 and every internal vertex of @xmath680 .",
    "we claim the following .",
    "@xmath681{0.8\\textwidth}\\em for all $ j>1 $ , there does not exist a local peak with endpoints in~$c_j$. \\end{minipage}\\ignorespacesafterend\\ ] ] fix @xmath677 to be a local peak with endpoints in @xmath678 with @xmath677 chosen over all such local peaks so that @xmath682 is maximal .",
    "assume @xmath677 is a subpath of @xmath662 .",
    "let the endpoints of @xmath677 be @xmath130 and @xmath131 .",
    "lest we re - route @xmath140 through @xmath678 and find a counter - example containing fewer edges , there exists a component @xmath683 intersecting the subpath of @xmath684 linking @xmath130 and @xmath131 . by planarity ,",
    "@xmath685 either contains a subpath internally disjoint from the union of the @xmath675 with both endpoints in @xmath686 , or @xmath685 contains a subpath forming a local peak with endpoints in @xmath687 .",
    "the former is a contradiction to our choice of a minimal counterexample , the latter a contradiction to our choice of @xmath677 .",
    "this proves @xmath688 .",
    "an immediate consequence of @xmath689 and @xmath688 is the following .",
    "for every @xmath662 , let @xmath130 be the endpoint of @xmath140 in @xmath225 and let @xmath131 be the vertex of @xmath690 closest to @xmath130 on @xmath140 . define the path @xmath691 be the subpath @xmath692 of @xmath140 .",
    "the path @xmath691 is orthogonal to the cycles @xmath693 .",
    "in fact , @xmath694 is a single vertex for each @xmath663 .",
    "the final claim will complete the proof .",
    "@xmath695{0.8\\textwidth}\\em for all $ p \\in \\mathcal{p}$ , the path $ p - \\overline{p}$ does not intersect $ c_{t+1}$.   \\end{minipage}\\ignorespacesafterend\\ ] ]    to see @xmath696 is true , fix @xmath662 such that @xmath697 .",
    "it follows now from @xmath689 and @xmath688 that @xmath698 contains a subpath @xmath677 with one endpoint in @xmath699 and one endpoint in @xmath700 such that @xmath677 is orthogonal to the cycles @xmath701 . by the planarity of @xmath2",
    ", we see that @xmath1 contains a subgraph isomorphic to a subdivision of the @xmath702 grid .",
    "this contradicts @xmath673 and lemma [ lem : singlink ] , proving @xmath696 .",
    "we conclude that @xmath659 is orthogonal to the @xmath649 disjoint cycles @xmath703 .",
    "this contradicts our choice of @xmath1 , and the lemma is proven .",
    "before proceeding with the proof of theorem [ thm : richthm ] , we will need one more lemma .",
    "a result similar to the following lemma can be found in @xcite .",
    "[ lem : g0haslargetw ] for every integer @xmath327 and every integer @xmath369 there is an integer @xmath704 such that the following holds .",
    "let @xmath1 be a graph of tree - width at least @xmath329 and @xmath705 be an @xmath79-near embedding of @xmath1 in a surface @xmath80 such that all vortices @xmath143 have depth at most @xmath79 .",
    "then , @xmath4 has tree - width at least @xmath327 .    for a given surface @xmath80 , let @xmath144 be an integer such that for every graph @xmath0 embedded in @xmath80 , the contraction of @xmath79 disjoint faces of @xmath0 to vertices leaves a graph of tree - width at least @xmath706 .",
    "such an integer exists by lemma  [ lem : contractingface ] .",
    "let @xmath1 be a graph as stated with tree - width @xmath707 .",
    "let @xmath195 be the graph we obtain if for every vortex @xmath708 with @xmath709 we add all edges @xmath710 for @xmath711 where @xmath712 to @xmath4 if not already in @xmath4 .",
    "clearly , @xmath197 can be extended to an embedding of @xmath195 by embedding the new edges in the according discs @xmath107 .",
    "@xmath713{0.8\\textwidth}\\em the tree - width of $ g_0^+$ is at least $ r$. \\end{minipage}\\ignorespacesafterend\\ ] ] otherwise , choose a tree - decomposition @xmath714 of @xmath195 of width less than @xmath144 . for",
    "every vortex @xmath715 choose a fixed decomposition @xmath283 of depth at most @xmath79 .",
    "for all @xmath217 we define @xmath716 note that , as all vortices are disjoint and thus , every vertex in @xmath220 can be a society vertex of at most one vortex , we have @xmath717 . we claim that @xmath718 is a tree - decomposition of @xmath719 . to see this , pick a vertex @xmath720 for distinct @xmath721 .",
    "we have to show that @xmath722 for all @xmath723 .",
    "let us assume that @xmath724 as the other cases are easy . by construction",
    ", there is a vortex @xmath106 with @xmath709 such that for some @xmath725 , we have @xmath726 and @xmath727 and @xmath728 .",
    "we may assume without loss of generality that @xmath729 .",
    "by construction of @xmath195 , there is a path @xmath730 in @xmath195 . as @xmath731 separates @xmath732 from @xmath733 in @xmath719 ,",
    "there is a vertex @xmath734 for some @xmath735 . as @xmath736 , we have @xmath737 as desired .",
    "clearly , @xmath216 is a tree - decomposition of @xmath1 as well , but has width less than @xmath738 , a contradiction to our choice of @xmath1 .",
    "this proves ( [ claim : twg_0+large ] ) .    for every vortex @xmath143",
    "there is a face @xmath739 of @xmath195 with @xmath740 . by the choice of @xmath144 , contracting all these faces to vertices",
    "yields a graph of tree - width at least @xmath706 . removing the new vertices , of which we have at most @xmath79 , results in the graph @xmath741 with tree - width at least @xmath327 .",
    "thus , the graph @xmath4 has tree - width at least @xmath327 as well , proving the lemma .",
    "we now proceed with the proof of theorem [ thm : richthm ] .",
    "let @xmath262 be the integer from theorem  [ thm : extended1.3 ] for @xmath178 and @xmath742 be an integer such that for every surface @xmath80 with @xmath743 , the graph @xmath178 can be embedded in @xmath80 . by theorem  [ thm : gridthm ] and the lemmas  [ lem : g0haslargetw ] , [ lem : flatwall ] and  [ lem : torsotwlarge ] ,",
    "there is an integer @xmath124 such that if the tree - width of our graph  @xmath1 is larger than @xmath124 , the following holds : there is a tree - decomposition @xmath216 of @xmath1 such that the torso @xmath744 of one part @xmath745 has an @xmath238-near embedding @xmath746 into a surface @xmath747 in which @xmath178 can not be embedded and @xmath748 contains a flat wall of size at least @xmath749 where @xmath750 .",
    "we will show , that with these constants , which only depend on @xmath178 and @xmath161 , we find an @xmath79-near embedding of @xmath1 where @xmath751 that is ` almost ' @xmath161-rich : the near embedding satisfies all the desired properties except for ( [ prop : linkagetogrid ] ) and ( [ prop : orthogonalpaths ] ) .",
    "instead , we only find paths linking the societies of large vortices to arbitrary branch vertices of a large wall . but",
    "this can be remedied : we apply the result for @xmath752 instead for @xmath161 and with lemmas  [ lem : pathstoboundary ] and  [ lem : ortholink ] we obtain a @xmath161-rich near - embedding as desired .",
    "first , we will convert the near - embedding of the torso @xmath744 into a near - embedding of the whole graph @xmath1 by accomodating in to the vortices each part of the graph not yet included in the near - embedding . to accomplish this",
    ", we will use property  ( ii ) from theorem  [ thm : extended1.3 ] of our tree - decomposition : pick a component @xmath753 of @xmath754 and let @xmath755 be the vertex in this component adjacent to @xmath756 in @xmath757 .",
    "let @xmath225 denote the vertex set for @xmath755 as in ( ii ) and @xmath758 .",
    "if ( a ) holds , we add @xmath759 $ ] to the vortex @xmath760 containing @xmath225 as a part of its decomposition .",
    "this modification neither changes @xmath187 nor does it increase the adhesion of @xmath9 . if ( b ) holds , @xmath761,x)$ ] defines a vortex of length at most 3 which is properly attached to  @xmath187 .",
    "we perform this modification for all components of @xmath754 .",
    "let us collect in a set @xmath762 all new vortices defined in case ( b ) , and we let @xmath264 denote the set of the new , large vortices obtained in case ( a ) . by merging vortices if necessary , we may assume that there exist no two vortices @xmath763 with @xmath764 .",
    "the resulting @xmath238-near embedding @xmath765 is a near - embedding of  @xmath1 .",
    "now , we are interested in finding near - embeddings @xmath108 into surfaces @xmath80 such that @xmath766{0.8\\textwidth}\\em \\begin{itemize } \\item all vortices in $ { \\ensuremath{\\mathcal{w}}}$ are properly attached to $ g_0 $ \\item all vortices in $ { \\ensuremath{\\mathcal{v}}}$ have adhesion at most $ \\hat \\alpha$ \\item $ g(\\sigma)\\leq g(\\hat \\sigma)$ \\item $ |{\\ensuremath{\\mathcal{v}}}| \\leq |\\hat { \\ensuremath{\\mathcal{v}}}| + ( g(\\hat \\sigma)-g(\\sigma))$ \\item $ |a|",
    "\\leq |\\hat a| +   p(2(g(\\hat \\sigma ) - g(\\sigma ) ) + |\\hat { \\ensuremath{\\mathcal{v}}}| - |{\\ensuremath{\\mathcal{v}}}|)$ \\end{itemize } \\end{minipage}\\ignorespacesafterend\\ ] ] and further @xmath767{0.8\\textwidth}\\em $ g_0'$ contains a flat wall $ \\gamma_0 $ of size at least $ 6^{|{\\ensuremath{\\mathcal{v}}}|+2g(\\sigma)+1}\\mu$. \\end{minipage}\\ignorespacesafterend\\ ] ] where @xmath768 such near - embeddings exist , as @xmath769 satisfies ( [ inequalities ] ) and ( [ bigwall ] ) .",
    "our next task is to find , among all such near embeddings , one near - embedding @xmath108 with the following additional properties ( p1)(p4 ) , where @xmath770    1 .",
    "every two vortices have distance at least @xmath771 in @xmath80 .",
    "2 .   for every vortex @xmath175 there exist @xmath772 cycles @xmath773 tightly enclosing  @xmath9 .",
    "if @xmath774 , the representativity of @xmath111 in @xmath80 is at least @xmath772 .",
    "3 .   for all distinct vortices @xmath439 ,",
    "the discs @xmath775 and @xmath776 are disjoint .",
    "4 .   @xmath4 contains a flat @xmath772-wall @xmath315 such that @xmath620 and @xmath775 are disjoint for every @xmath175 .    from all near - embeddings satisfying ( [ inequalities ] ) and ( [ bigwall ] )",
    "let us pick one minimizing @xmath777 lexicographically .",
    "we will denote this near - embedding by @xmath778 .",
    "we will show that either @xmath778 itself has the properties ( p1)(p4 ) or we can find a disc in @xmath80 such that , roughly said , the part of our graph nearly - embedded in this disc can be considered as a near - embedding in @xmath158 with these properties .    for the next steps in the proof",
    ", we will repeatedly make use of the following fact : for an integer @xmath312 , consider a flat wall @xmath132 of size @xmath779 in @xmath111 and a vortex @xmath175 tightly enclosed by @xmath780 cycles @xmath781 . in @xmath132 , we can find two subwalls @xmath782 of size @xmath312 and @xmath312 concentric cycles @xmath783 around @xmath784 and @xmath312 concentric cycles @xmath785 around @xmath786 such that @xmath787 and @xmath788 are disjoint . in particular , @xmath784 and @xmath786 have distance at least @xmath557 in @xmath80 .",
    "further , any two vertices picked from the cycles @xmath781 have distance at most @xmath789 in @xmath80 .",
    "now , a comparison of the distances shows that one of the walls @xmath784 , @xmath786 is disjoint to all the cycles @xmath781 .",
    "also note , that if we delete a set @xmath225 of @xmath160 vertices from a wall @xmath315 of size @xmath790 , at most @xmath160 rows and at most @xmath160 columns of @xmath315 are hit by @xmath225 and thus , @xmath791 contains a wall of size at least @xmath792 .",
    "first , we see that the near - embedding @xmath778 has property ( p1 ) .",
    "otherwise we apply lemma  [ lem : mergevortices ] with @xmath793 .",
    "this gives a vertex set @xmath436 of size at most @xmath794 and a near - embedding @xmath795 with @xmath796 of @xmath1 in @xmath80 .",
    "then , ( [ inequalities ] ) holds for @xmath797 and it is easy to verify ( [ bigwall ] ) as well but lexicographically , @xmath798 , which contradicts the choice of  @xmath778 .    to show properties ( p2 ) and ( p3 ) we consider two distinct cases : when @xmath799 and when @xmath800 .",
    "first , we assume that @xmath799 . for a vortex @xmath175",
    "we can find a subwall @xmath801 of size @xmath802 in @xmath622 together with @xmath772 concentric cycles @xmath803 enclosing @xmath804 such that @xmath805 does not meet @xmath115 .",
    "these cycles can be considered as concentric cycles enclosing @xmath9 .",
    "applying lemma  [ lem : tightcycles ] shows that there also exist @xmath772 cycles @xmath806 tightly enclosing  @xmath9 , where @xmath775 does not meet @xmath807 .",
    "this shows ( p2 ) .    to prove that ( p3 ) holds , let us assume , to reach a contradiction , that for two distinct vortices @xmath439 the discs @xmath775 and @xmath776 intersect . by ( p1 ) , all the cycles @xmath808 are disjoint and we may assume that @xmath809 . by lemma  [ lem : pieslices ] , there is a disc @xmath810 containing @xmath115 and a separation @xmath565 of @xmath1 of order at most @xmath811 such that @xmath567 .",
    "now , let @xmath812 be the set of all vortices of @xmath813 with a non - empty society plus the vortex @xmath814,\\emptyset)$ ] , and similar , let @xmath815 be the set of all vortices of @xmath816 with a non - empty society .",
    "clearly , @xmath817 as @xmath818 .",
    "it is easy to see now that @xmath819 is a near - embedding of @xmath1 into @xmath80 , satisfying ( [ inequalities ] ) , and with @xmath801 a sufficient large wall lives in @xmath820 such that ( [ bigwall ] ) holds as well .",
    "otherwise , we have that @xmath821 , a contradiction to our choice of @xmath778 .",
    "this proves ( p3 ) .",
    "we now consider the case when @xmath822 . our plan is to apply lemma  [ lem : conccycles ]",
    "thus , we must first show that the representativity of @xmath111 in @xmath80 is at least @xmath823 .",
    "assume , to reach a contradiction , that the representativity is at most @xmath824 .",
    "we can apply lemma  [ lem : rephigh ] with @xmath825 .",
    "if a ) from lemma  [ lem : rephigh ] holds , we have a near - embedding @xmath797 of @xmath1 into a surface @xmath535 with @xmath536 and @xmath826 .",
    "the properties ( [ inequalities ] ) and ( [ bigwall ] ) are easy to verify and thus , @xmath827 is a contradiction to our choice of @xmath778 .",
    "if b ) holds , one of the graphs @xmath828 contains a sufficient large wall and therefore , one of the near - embeddings @xmath829 satisfies the conditions ( [ inequalities ] ) and ( [ bigwall ] ) . again , as @xmath830 , this is a contradiction to our choice of @xmath778 .",
    "this shows that the representativity of @xmath111 in @xmath80 is at least @xmath823 and we apply lemma  [ lem : conccycles ] to each of the faces of @xmath111 that contain the society @xmath133 of one vortex @xmath175 .",
    "together with lemma  [ lem : tightcycles ] , this implies property ( p2 ) .    as before , to show property ( p3 )",
    ", we assume that for two distinct vortices @xmath439 , the discs @xmath775 and @xmath776 intersect .",
    "again we may assume that @xmath809 and application of lemma  [ lem : pieslices ] gives us a disc @xmath810 containing @xmath115 and a separation @xmath565 of @xmath1 of order at most @xmath811 such that @xmath567 .",
    "as noted earlier , there exists a flat subwall @xmath315 of @xmath622 of size at least @xmath802 that is disjoint to all the cycles @xmath831 . if @xmath832 , we can reduce the number of vortices of our near - embedding , leading to the same contradiction as above .",
    "otherwise , @xmath833 . in this case , let @xmath812 be the set of all vortices of @xmath834 with a non - empty society plus the vortex @xmath835,\\emptyset)$ ] , and similar , let @xmath815 be the set of all vortices of @xmath836 with a non - empty society .",
    "now , @xmath837 can be considered a near - embedding of @xmath1 into @xmath158 .",
    "property ( [ bigwall ] ) is clearly true and one easily checks ( [ inequalities ] ) as well .",
    "this is a contradiction to our choice of  @xmath778 as @xmath838 .",
    "we conclude that property ( p3 ) holds .",
    "let us enumerate the vortices @xmath839 .",
    "we will show ( p4 ) by proving inductively that for @xmath840 , there is a flat wall @xmath841 of size @xmath842 avoiding @xmath843 . by ( [ bigwall ] )",
    ", there is a flat @xmath844-wall in @xmath4 .",
    "let us assume that the statement is true for some @xmath160 with @xmath845 . with the same arguments as before , we find a subwall @xmath846 of size @xmath847 that avoids all cycles @xmath848 .    if @xmath849 , the statement is true for @xmath850 , completing the induction .",
    "otherwise , lemma  [ lem : pieslices ] gives us a disc @xmath562 containing @xmath851 and a separation @xmath565 of @xmath1 of order at most @xmath811 such that @xmath567 . by ( p3 )",
    ", this disc @xmath562 does not contain any society @xmath134 for some large vortex @xmath852 .",
    "we let @xmath812 be the set of all vortices of @xmath834 with a non - empty society plus the vortex @xmath835,\\emptyset)$ ] , and @xmath853 .",
    "we can consider @xmath854 as a near - embedding of @xmath1 into @xmath158 , and with similar arguments as before , we can use @xmath851 to find both a wall of size at least @xmath772 together with @xmath772 concentric cycles tighly enclosing @xmath855 in @xmath158 such that all of ( [ inequalities]),([bigwall ] ) and ( p1)(p4 ) hold .    from all near - embeddings @xmath108 of @xmath1 into surfaces @xmath80 satisfying ( [ inequalities ] ) and ( p1)(p4 )",
    "let us choose one minimizing @xmath856 .",
    "there is no separation @xmath565 of @xmath111 of order less than @xmath857 such that all the branch vertices of @xmath315 are contained in @xmath34 and @xmath858 for one vortex @xmath175 .",
    "assume the opposite .",
    "then , we may assume that for every vortex @xmath859 , the society vertices @xmath860 are contained either in @xmath34 or in @xmath861 : otherwise , one of the cycles @xmath862 enclosing @xmath863 is not hit by @xmath864 and is therefore contained in either @xmath34 or @xmath861 .",
    "as this ( planar ) cycle @xmath129 is a separator of @xmath111 , we can add all vertices embedded in @xmath136 to one part of the separation .",
    "similar as before , we add @xmath864 to the apex set @xmath55 and add a new small vortex @xmath865,\\emptyset)$ ] to @xmath95 .",
    "this new near - embedding of @xmath1 still satisfies ( [ inequalities ] ) and ( p1)(p4 ) but we have reduced @xmath856 with this operation , a contradiction to our choice of the near - embedding .",
    "therefore , for every large vortex @xmath175 , the society @xmath133 is connected to the branch vertices of @xmath315 by @xmath857 many disjoint paths .",
    "application of lemma  [ lem : vorticeslinked ] gives a subgraph @xmath442 of @xmath4 , a vertex set @xmath444 with @xmath866 and a near - embedding @xmath867 of @xmath1 such that every vortex @xmath868 has a linked decomposition of adhesion at most @xmath262 and there are still at least @xmath869 cycles enclosing every @xmath870 .",
    "further , of the @xmath871 paths linking @xmath872 to the wall for the vortex @xmath175 contained in @xmath855 , at least @xmath161 are not hit by the set of vertices of size at most @xmath238 that was deleted by the application of the lemma .",
    "thus , @xmath873 is still linked to the wall by at least @xmath161 many paths . finally ,",
    "as described in the beginning , lemma  [ lem : pathstoboundary ] finishes the proof .",
    "in graph minors xvii @xcite , the structure theorem is stated with vortices having a circular instead of a linear structure . for most applications ,",
    "the linear decompositions as discussed so far in this paper are sufficient , but sometimes the circular structure is necessary . in this section ,",
    "we introduce circular vortex decompositions and point out how we can derive a new lemma from the proof of lemma  [ lem : vorticeslinked ] that yields circular linkages for them .",
    "it is easy to see that we can apply this new lemma instead of lemma  [ lem : vorticeslinked ] at the end of the proof of theorem  [ thm : richthm ] and therefore , we can choose to have circular linkages for the large vortices when we apply the theorem .    for the remainder of this paper , we call decompositions of vortices as defined in section  [ sec : structure_thms ] _ linear decompositions _ to distinguish them more clearly from the circular decompositions which we introduce now :    let @xmath874 be a vortex with @xmath47 .",
    "let us regard the ordering of @xmath11 as a cyclic ordering .",
    "a tuple @xmath875 of subsets of  @xmath10 is a _ circular decomposition _ of @xmath9 if the following properties are satisfied :    a.   @xmath16 for all @xmath30 .",
    "b.   @xmath876 . c.   when @xmath877 are society vertices of @xmath9 ordered with respect to the cyclic ordering @xmath11",
    ", then @xmath878 d.   every edge of @xmath1 has both ends in @xmath37 for some @xmath30 .",
    "the _ adhesion _ of our circular decomposition @xmath18 of @xmath9 is the maximum value of @xmath19 , taken over all @xmath577 .",
    "we define the _ circular adhesion _ of @xmath9 as the minimum adhesion of a circular decomposition of that vortex .",
    "the union of the @xmath25@xmath26 paths in a circular decomposition of  @xmath9 is a disjoint union of cycles in  @xmath1 each of which traverses the adhesion sets of  @xmath18 in cyclic order ( possibly several times ) ; we call the set of these cycles a _",
    "circular linkage _ of  @xmath9 with respect to  @xmath18 .",
    "as described in section  [ sec : structure_thms ] for linear decompositions , we see that we can delete a vertex from a circular decomposition of some vortex and obtain a new circular decomposition .",
    "this operation does not increase the adhesion but might decrease the number of society vertices .",
    "clearly , a linear decomposition of some vortex is a circular decomposition as well and it is easy to see that one can obtain a linear from a circular decomposition , if one deletes the overlap of two subsequent bags : let @xmath874 a vortex and @xmath51 a circular decomposition of @xmath9 .",
    "delete the set @xmath879 from @xmath9 for some index @xmath577 .",
    "we obtain a circular decomposition @xmath880 of @xmath468 with @xmath881 . by shifting the indices",
    "if necessary we may assume that @xmath882 is empty .",
    "@xmath18 is a linear decomposition of @xmath468 : pick a vertex @xmath883 for indices @xmath884 .",
    "this vertex avoids either @xmath34 or @xmath35 , let us assume the former .",
    "we apply property ( iii ) from the definition of a circular decomposition to @xmath885 for any @xmath160 with @xmath886 and conclude that @xmath887 .    to distinguish near - embeddings with linear decompositions from near - embeddings with circular decompositions , we will call the latter explicitly _ near - embeddings with circular vortices_. also , for a @xmath394-near embedding with circular vortices let the third bound @xmath397 denote an upper bound for the circular adhesion of the large vortices .      1 .   for every vortex @xmath451",
    "there exists a circular , linked decomposition @xmath18 of @xmath9 of adhesion at most @xmath397 and there exists a cycle @xmath129 in @xmath888 with @xmath889 , avoiding all the paths of a circular linkage of @xmath9 and traversing @xmath174 in their order .",
    "a.   for every vortex @xmath143 there are @xmath437 concentric cycles @xmath438 in @xmath111 tightly enclosing @xmath9",
    ". b.   for distinct vortices @xmath439 , the discs @xmath440 and @xmath441 are disjoint .    then , there is a graph @xmath442 with @xmath443 a set @xmath444 with @xmath890 avoiding @xmath442 , and sets @xmath446 and @xmath447 of vortices in @xmath1 such that with @xmath448 the tuple @xmath449 is an @xmath450-near embedding with circular vortices of @xmath1 in @xmath80 such that every vortex @xmath175 satisfies property ( [ prop : linked] ) of @xmath161-rich .",
    "the curve @xmath129 in the surface hits the vertex set @xmath323 which consists of exactly one vertex from each @xmath457 and one society vertex @xmath459 of @xmath9 .",
    "we split each vertex in @xmath891 : for each @xmath458 , we replace @xmath892 by two new vertices @xmath893 and connect them with edges to the former neighbours of @xmath42 such that @xmath129 does not intersect any edges or vertices .",
    "the vertices @xmath894 and @xmath895 form the sets @xmath225 and @xmath479 , respectively .",
    "e. d. demaine , m. hajiaghayi , and k. kawarabayashi , algorithmic graph minor theory : decomposition , approximation and coloring , proc .",
    "46th ann .",
    "ieee symp .  found .",
    "pittsburgh , pa , 2005 , pp .",
    "637646 .",
    "k. kawarabayashi and b. mohar , approximating the chromatic number and the list - chromatic number of minor - closed family of graphs and odd - minor - closed family of graphs , _ proc .",
    "the 38th acm symposium on theory of computing ( stoc06 ) _ , ( 2006 ) , 401416 .",
    ", c.  thomassen , `` graphs on surfaces '' , johns hopkins university press , 2001 , p.  seymour , `` graph minors .",
    "v : excluding a planar graph '' , j. comb .",
    "theory ser .",
    "b 41 ( 1986 ) , 92114 . , p.  seymour , `` graph minors .",
    "x : obstructions to tree - decomposition '' , j. comb .",
    "theory ser .",
    "b 52 ( 1991 ) , 153190 . , p.  seymour , `` graph minors .",
    "xvi : excluding a non - planar graph '' , j. comb .",
    "theory ser .",
    "b 89 ( 2003 ) , 4376 .",
    ", p.  seymour , `` graph minors .",
    "xvii : taming a vortex '' , j. comb .",
    "theory ser .",
    "b 77 ( 1999 ) , 162210 ."
  ],
  "abstract_text": [
    "<S> at the core of the robertson - seymour theory of graph minors lies a powerful structure theorem which captures , for any fixed graph  @xmath0 , the common structural features of all the graphs not containing @xmath0 as a minor.-200 robertson and seymour prove several versions of this theorem , each stressing some particular aspects needed at a corresponding stage of the proof of the main result of their theory , the graph minor theorem .    </S>",
    "<S> we prove a new version of this structure theorem : one that seeks to combine maximum applicability with a minimum of technical ado , and which might serve as a canonical version for future applications in the broader field of graph minor theory . </S>",
    "<S> our proof departs from a simpler version proved explicitly by robertson and seymour . </S>",
    "<S> it then uses a combination of traditional methods and new techniques to derive some of the more subtle features of other versions as well as further useful properties , with substantially simplified proofs . </S>"
  ]
}