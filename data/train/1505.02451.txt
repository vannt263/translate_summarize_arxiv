{
  "article_text": [
    "molecular dynamics ( md ) simulations , in which classical equations of motions are solved for molecular systems of significant complexity , have proven useful for interpreting and understanding many chemical and biological phenomena ( for textbooks see  @xcite ) . however , a significant limitation of md is of time scales .",
    "many molecular processes of interest occur on time scales significantly longer than the temporal scales accessible to straightforward simulations .",
    "for example , permeation of molecules through membranes can take hours  @xcite while md is usually restricted to the microseconds time scale .",
    "one approach to extend simulation times is to use faster hardware  @xcite .",
    "other approaches focus on developing theories and algorithms for long time phenomena .",
    "most of the emphasis has been on methodologies for activated processes with a single dominant barrier , as in transition path sampling  @xcite .",
    "approaches for dynamics on rough energy landscapes , and for more general and/or diffusive dynamics , have also been developed  @xcite .",
    "the techniques of exact milestoning  @xcite and milestoning  @xcite belong to the last category .",
    "they are theories and algorithms to accelerate trajectory calculations of kinetics and thermodynamics in complex molecular systems .",
    "the acceleration is based on the use of a large number of short trajectories instead of complete trajectories between reactants and products ( figure  [ fig : basic - figure ] ) .",
    "the simulation of short trajectories is trivial to implement in parallel , making the formulation efficient to use on modern computing resources .",
    "moreover , the use of short trajectories makes it possible to enhance sampling of improbable but important events by initiating the short trajectories near bottlenecks of reactions .",
    "a challenge is how to start the short trajectories , and how to analyze the result to obtain correct long time behavior .    while milestoning is an approximate procedure , it shares the same philosophy and core algorithm as the exact milestoning approach . in both algorithms",
    "the phase space @xmath0 is partitioned by hypersurfaces , which we call milestones @xmath1 , into cells .",
    "the short trajectories are initiated on milestones and are terminated the first time they reach a neighboring milestone ( figure  [ fig : basic - figure ] ) .",
    "the short trajectories can be simulated in parallel .",
    "milestoning uses an approximate distribution for the initial conditions of the trajectories at the hypersurfaces .",
    "the results are then analyzed within the milestoning theory .",
    "the approximation is typically the ( normalized ) canonical distribution restricted to the milestone interface @xmath2 . in exact milestoning the distribution of hitting points at the interface",
    "is estimated numerically by iteratively computing trajectory fragments between milestones . in a straightforward implementation of the iterations",
    "( see also  @xcite ) the final phase points of trajectories that were terminated on one milestone are continued until they hit another milestone .",
    "this type of trajectory continuation procedure is also used in non - equilibrium umbrella sampling  @xcite and trajectory tilting  @xcite .",
    "the continuation does not mean that full trajectories from reactants to products are computed .",
    "the calculations stop when the stationary distribution at the interface , or observables of interest , converge . in practice , and depending of course on the initial guess",
    ", the calculation ends significantly earlier than complete trajectories from @xmath3 to @xmath4 are computed .",
    "the fast convergence of the iterations leads to significant computational savings .",
    "a number of other algorithms build on the use of short trajectories to estimate long time kinetics by `` patching '' these short trajectories at milestones or interfaces .",
    "these technologies include the weighted ensemble ( we )  @xcite , transition interface sampling ( tis )  @xcite , partial path transition interface sampling ( pptis )  @xcite , forward flux sampling ( ffs )  @xcite , non - equilibrium umbrella sampling ( neus )  @xcite , trajectory tilting  @xcite , and boxed molecular dynamics ( bmd )  @xcite .",
    "some of these techniques are similar ; however , many subtle differences remain .",
    "some of the differences are as follows .",
    "we is the only method that makes it necessary to use stochastic dynamics .",
    "the trajectory sampling in neus , trajectory tilting and exact milestoning is similar , even though the theories are quite different .",
    "exact milestoning allows for the calculations of all the moments of the first passage time  @xcite , a result which is not available for other technologies .",
    "boxed molecular dynamics , milestoning and pptis are approximate methods leading to greater efficiency .",
    "tis , pptis , ffs , and bmd are focused on one - dimensional reaction coordinates .",
    "other technologies ( e.g. we , milestoning , neus , and trajectory tilting ) focus on a space of one or several coarse variables .    hence , the overall scopes of these techniques differ significantly , which make direct comparison between them less obvious .",
    "we have compared in the past the accuracy and efficiency of the methods of milestoning and exact milestoning with forward flux  @xcite .",
    "forward flux is one of the closest algorithms ( in one dimension ) to milestoning and exact milestoning",
    ". numerous examples of kinetics of molecular systems studied with milestoning were published  @xcite .",
    "we have also discussed extensively the features of alternate technologies that exploit trajectory fragments  @xcite .",
    "the milestoning theory has not yet been subject to rigorous mathematical analysis , which is the goal of the present manuscript . in this manuscript",
    "we show that the exact milestoning method can be derived and analyzed in the framework of probability theory .",
    "the result is a useful link between physical intuition and a more formal approach .",
    "readers that are interested in the efficiency of the algorithm on concrete examples , and comparison to other technologies , are referred to the sources mentioned the above paragraph .     and the milestones .",
    "each milestone is one of the line segments traced by dashed grey lines .",
    "the reactant state @xmath3 is highlighted as a square dot in the left - bottom corner while the product state @xmath4 is comprised of the two line segments shown in blue at the upper - right corner .",
    "a particular realization of a long trajectory appears as a continuous black line and the corresponding values of @xmath5 are marked with dots . ]",
    "this article is organized as follows . in section  [ sec : setup ]",
    ", we describe the setting for exact milestoning and introduce notation used throughout . in section  [ sec :",
    "stationary ] , we show existence of and convergence to a stationary flux under very general conditions . in section  [ sec : algorithm ] we state precisely the exact milestoning algorithm  @xcite . in section  [ sec : error ] , we establish conditions under which convergence to the stationary flux is consistent in the presence of numerical error ( lemma  [ geom_ergodic ] and theorem  [ feller ] ) , and we give a natural upper bound for the numerical error arising in exact milestoning ( theorem  [ errors ] ) .",
    "finally , in section  [ sec : examples ] we consider some instructive examples .",
    "in milestoning we spatially coarse - grain a dynamics @xmath6 .",
    "the basic idea is to stop and start trajectories on certain interfaces , called milestones , and then reconstruct functions of @xmath6 using these short trajectories , which can be efficiently simulated in parallel .",
    "we assume here the dynamics is stochastic , and focus on using milestoning for the efficient computation of _ mean first passage times _ ( mfpts ) of @xmath6 , although similar ideas can be used to compute other non - equilibrium quantities .    to make our arguments we need some assumptions on @xmath6 .",
    "we let @xmath6 be a time homogeneous strong markov process with cdlg paths taking values in a standard borel space @xmath0 .",
    "these assumptions allow us to stop and restart @xmath6 on the milestones without knowing its history . in applications ,",
    "usually @xmath6 is langevin or overdamped langevin dynamics , and @xmath0 is a subset of euclidean space .",
    "we write @xmath7 , @xmath8 for all probability measures and expectations , with superscripts @xmath9 ( resp .",
    "@xmath10 ) to indicate a starting point @xmath11 ( resp . distribution @xmath12 ) .",
    "the symbol @xmath13 will indicate equality in probability law .",
    "we will use the words _ distribution _ and _ probability measure _ interchangeably .",
    "total variation norm will be denoted by @xmath14 .",
    "our analysis below will mostly take place in an idealized setting where we assume infinite sampling on the milestones . in this",
    "setting , distributions are smooth ( if state space is continuous ) and the total variation norm is the appropriate one .",
    "recall we are interested in computing the mfpt of @xmath6 from a reactant set @xmath3 to a product set @xmath4 . throughout",
    "we consider fixed disjoint product and reactant sets @xmath15 .",
    "when @xmath3 is not a single point , we will start @xmath6 from a fixed probability measure @xmath16 on @xmath3 .",
    "if @xmath3 is a single point , @xmath17 , the delta distribution at @xmath3 . as discussed above , milestoning allows for an efficient computation of the mfpt of @xmath6 to @xmath4 , starting at @xmath16 .",
    "it is useful to think of @xmath4 as a sink , and @xmath3 as a source for @xmath6 .",
    "more precisely , _ we assume that when @xmath6 reaches @xmath4 , it immediately restarts on @xmath3 according to @xmath16 .",
    "_ obviously , this assumption has no effect on the mfpt to @xmath4 .",
    "it will be useful , however , for computational and theoretical considerations .",
    "many of the results below follow from well - known theorems in probability theory . however , because of the special source - sink structure of @xmath6 , simpler proofs are often available , and we include them for clarity and completeness .",
    "we write @xmath1 for the space of milestones used for parallelizing the computation of the mfpt .",
    "each point @xmath18 belongs to a _ milestone _ @xmath19 .",
    "thus , @xmath2 is the union of all the milestones .",
    "we assume there are finitely many milestones , each of which is a closed set .",
    "moreover , we demand that @xmath6 passes through the intersection of two milestones with probability @xmath20  thus , @xmath6 can only cross one milestone at a time . this can be accomplished for langevin or overdamped langevin dynamics by taking the milestones to be codimension 1 with pairwise intersections of codimension 2 or larger ; see figure  [ fig : basic - figure ] . the sets",
    "@xmath4 and @xmath3 will be two of the milestones .",
    "we always start @xmath6 on @xmath2 .    by following the sequence of milestones crossed by @xmath6",
    ", we obtain a sequence of points @xmath5 in @xmath2 .",
    "see figure  [ fig : basic - figure ] .",
    "we now describe @xmath5 more precisely .",
    "let @xmath21 be the @xmath22th milestone crossing time for @xmath6 , defined recursively by @xmath23 and @xmath24 note that by a milestone crossing , we mean a crossing of a milestone different from the previous one .",
    "the sequence of milestone crossing points is @xmath25 .",
    "we show now that @xmath6 can be partially reconstructed from @xmath5 and @xmath26 .",
    "let @xmath27 be defined has a probability density , it corresponds to the density @xmath28 from  @xcite for the last milestone point passed .",
    "] by setting @xmath29 whenever @xmath30",
    ". then @xmath6 and @xmath27 agree at each milestone crossing time @xmath31 , @xmath32 and @xmath27 is obtained from @xmath6 by throwing away the path of @xmath6 between milestone crossings , keeping only the endpoints .",
    "it follows that @xmath6 and @xmath27 have the same mfpt to @xmath4 .",
    "thus , for our purposes it is enough to study @xmath27 .",
    "we note that @xmath27 , like @xmath6 , immediately restarts at @xmath16 upon reaching @xmath4 .    by our assumptions above",
    ", @xmath5 is a markov chain on @xmath2 , and @xmath27 is a semi - markov process on @xmath2 , meaning it has the markov property at crossing times .",
    "we write @xmath33 for the transition kernel of @xmath5 . thus , if the initial distribution of @xmath5 is @xmath34 , then the distribution at time @xmath22 is @xmath35 .",
    "we also write @xmath36 $ ] and @xmath37 for suitable functions @xmath38 .    the following notation will be needed . for @xmath18 , define local first passage times @xmath39 thus , @xmath40 is the first time for @xmath27 to cross some milestone other than @xmath41 , starting at @xmath42 . in particular , if @xmath43 , then @xmath44",
    ". we also define @xmath45 to be the first time to cross @xmath4 and @xmath46 the number of crossings before reaching @xmath4 , @xmath47 we are interested in @xmath48 $ ] , the mfpt from @xmath16 to @xmath4 .",
    "the mfpt will be estimated via short trajectories between milestones .",
    "an important ingredient is the correct starting distribution for these trajectories .",
    "exact milestoning makes use of a _ stationary flux _ of @xmath6 on the milestones , which corresponds is the same as the appropriately normalized stationary flux @xmath49 in other milestoning papers .",
    "we use @xmath50 instead of @xmath49 to emphasize that here it is a probability measure , not a density . ] to the stationary distribution @xmath50 of @xmath5 .",
    "it is worth noting that milestoning can also be made exact by choosing milestones as isocommittor surfaces  @xcite .",
    "the advantage of the formulation here is that the milestones can be arbitrary .",
    "some assumption is required to guarantee the existence of a stationary flux .",
    "we adopt the following sufficient condition , which we assume holds throughout : @xmath51 \\text { and } { \\mathbb e}^\\xi [ \\sigma_p ] \\text { are finite for all probability measures } \\xi   \\text { on } m.\\ ] ] this ensures that @xmath27 reaches @xmath4 in finite expected time and does not have infinitely many milestone crossings in finite time",
    ". the condition can be readily verified in the standard settings for milestoning discussed above . using this assumption and the source - sink structure of the dynamics ",
    "namely , that @xmath27 immediately restarts at @xmath16 upon reaching @xmath4  we show in theorem  [ mu ] below that @xmath50 exists .",
    "[ mu ] @xmath5 has an invariant probability measure @xmath50 defined by @xmath52 { \\mathbb e}^\\rho[\\sigma_p+1]^{-1}.\\ ] ] where @xmath53 if @xmath54 and otherwise @xmath55 .",
    "define @xmath56 $ ] and observe that @xmath57 if @xmath58 , by bounded convergence , @xmath59 where the second equality uses @xmath60 and @xmath61 . if @xmath62 , @xmath63    we will show below that @xmath5 converges to @xmath50 under appropriate conditions . in that case",
    "@xmath50 is unique and we will call @xmath50 the _ stationary distribution _ of @xmath5 .",
    "a successful application of exact milestoning will require some technique for sampling @xmath50 .",
    "the algorithm we present ( algorithm 1 below ) is based on convergence of the distribution of @xmath5 to @xmath50 in total variation .",
    "we demonstrate this convergence in theorem  [ conv ] under an additional assumption on @xmath5 .",
    "it is worth noting that the proof of theorem  [ mu ] leads to the following representation of @xmath50 as a neumann series .",
    "the representation is given in corollary  [ neumann ] below .",
    "this representation can be used , in principle , to sample @xmath50 without additional assumptions on @xmath5 .",
    "the neumann series is written in terms of the _ transient kernel _",
    "@xmath64 @xmath65 corresponds to a modified version of @xmath5 that is absorbed ( killed ) on @xmath4 .",
    "[ neumann ] we have @xmath66    recall that @xmath67 where @xmath68 moreover , @xmath69 and the right hand side of   is summable since by assumption @xmath70 < \\infty$ ] .",
    "equipped with an invariant measure @xmath50 , we are now able to state the milestoning equation   for the mfpt . in exact milestoning , this equation is used to efficiently compute the mfpt .",
    "the algorithm is based on two principles : first , many trajectories can be simulated in parallel to estimate @xmath40 for various @xmath11 ; and second , the stationary distribution @xmath50 can be efficiently estimated through a technique based on power iteration .",
    "see the right hand side of equation   below .",
    "the gain in efficiency comes from the fact that the trajectories used to estimate @xmath40 are much shorter than trajectories from @xmath3 to @xmath4 . whether we can efficiently sample @xmath50",
    "may depend somewhat on whether we have a good initial guess .",
    "when @xmath6 is langevin dynamics , we have found in some cases the canonical gibbs distribution is a sufficiently good guess .",
    "see  @xcite and  @xcite for details and discussion .",
    "[ milestoning ] let @xmath50 be defined as above",
    ". then @xmath71 and @xmath72 = \\int_m \\mu(dx){\\mathbb e}^x[\\tau_m^x ] : = { \\mathbb e}^\\mu[\\tau_m].\\ ] ]    the assumption @xmath70 < \\infty$ ] shows that @xmath73 . for any @xmath18 , @xmath74 & = \\int_m { \\mathbb e}^x\\left[\\tau_p\\,|\\ , y_{\\tau_m^x } = y\\right]k(x , dy ) \\\\ & = \\int_m { \\mathbb e}^x\\left[\\tau_m^x\\,|\\ , y_{\\tau_m^x } = y\\right]k(x , dy ) + \\int_{m\\setminus p } { \\mathbb e}^x\\left[\\tau_p - \\tau_m^x\\,|\\ , y_{\\tau_m^x } = y\\right]k(x , dy)\\\\ & = { \\mathbb e}^x[\\tau_m^x ] + \\int_{m\\setminus p } { \\mathbb e}^y[\\tau_p ] k(x , dy).\\end{aligned}\\ ] ] thus , @xmath75 = { \\mathbb e}^{\\mu}[\\tau_m ] + \\int_{m\\setminus p } \\int_m \\mu(dx){\\mathbb e}^y[\\tau_p]k(x , dy)= { \\mathbb e}^\\mu[\\tau_m ] + \\int_{m\\setminus p } \\mu(dy){\\mathbb e}^y[\\tau_p],\\ ] ] and so @xmath76 = \\int_p \\mu(dy){\\mathbb e}^y[\\tau_p ] = \\mu(p){\\mathbb e}^\\rho[\\tau_p].\\ ] ]    in section  [ sec : algorithm ] below we present the exact milestoning algorithm ( algorithm 1 ) recently used in  @xcite and  @xcite .",
    "the algorithm uses a technique which combines coarse - graining and power iteration to sample @xmath50 .",
    "consistency of power iteration algorithms are justified via theorem  [ conv ] below , where we show @xmath77 as @xmath78 . though we emphasize that there are a range of possibilities for sampling  @xmath50 ( for example , algorithms based on   or   below ) we note that algorithm 1 was shown to be efficient for computing the mfpt in the entropic barrier example of  @xcite and the random energy landscapes example of  @xcite .      in this section",
    "we justify the consistency of power iteration - based methods for sampling @xmath50 by showing that @xmath79 converges to @xmath50 in total variation norm as @xmath78 .",
    "the theorem requires an extra assumption  aperiodicity of the jump chain @xmath5 .",
    "[ conv ] suppose that @xmath5 is aperiodic in the following sense : @xmath80 then for all probability measures @xmath12 on @xmath2 , @xmath81 in particular , @xmath50 is unique .",
    "we use a simple coupling argument .",
    "let @xmath82 be an independent copy of @xmath5 and let @xmath34 and @xmath83 .",
    "for @xmath84 , let @xmath85 ( resp .",
    "@xmath86 ) be the times at which @xmath5 ( resp .",
    "@xmath82 ) hit @xmath4 for the @xmath87st time .",
    "then @xmath88 , @xmath89 , are iid random variables with finite expected value and nonlattice distribution , and @xmath90 .",
    "it follows that @xmath91 is a mean zero random walk with nonlattice step distribution .",
    "thus , its first time to hit @xmath20 is finite almost surely .",
    "so @xmath92 obeys @xmath93 as @xmath94 .",
    "note that @xmath95 whenever @xmath96 .",
    "thus @xmath97 since @xmath50 is stationary for @xmath82 we have @xmath98 .",
    "now @xmath99 which establishes the convergence result . to see uniqueness , suppose @xmath12 is another invariant probability measure for @xmath5 ; then the last display becomes @xmath100 .",
    "letting @xmath94 shows that @xmath101 .",
    "we now consider a class of problems where there is a smooth one - dimensional _ reaction coordinate _",
    "@xmath102 $ ] tracking progress of @xmath6 from @xmath3 to @xmath4 . in this case",
    "@xmath103 , @xmath104 , the milestones @xmath105 are disjoint level sets of @xmath106 , and @xmath107 , @xmath108 .",
    "the jump chain @xmath5 can only hop between neighboring milestones , unless it is at @xmath4 .",
    "that is , if @xmath109 for @xmath110 , then @xmath111 or @xmath112 ; if @xmath113 then @xmath114 ; and if @xmath115 , then @xmath116 .",
    "suppose that if @xmath109 for @xmath110 , then @xmath111 with probability in @xmath117 .",
    "then the aperiodicity assumption   is satisfied if and only if @xmath118 is odd .",
    "this is due to the fact that , if @xmath119 , then @xmath120 and @xmath121 with positive probability , and @xmath118 and @xmath122 are coprime when @xmath118 is odd . on the other hand ,",
    "if @xmath118 is even then the conclusion of theorem  [ conv ] can not hold . to see this ,",
    "let @xmath118 be even and suppose @xmath123 is supported in an odd - indexed milestone",
    ". then @xmath124 is always supported on an odd - indexed milestone , while @xmath125 is always supported on an even - indexed milestone .",
    "theorem  [ conv ] estabishes convergence the distribution of @xmath126 to @xmath50 in total variation norm .",
    "even when @xmath5 is not aperiodic , it converges in a time - averaged sense .",
    "thus , problems in sampling @xmath50 arising from aperiodicity can be managed by averaging over time .",
    "more precisely , we have the following version of the birkhoff ergodic theorem :    [ cesaro ] let @xmath34 , with @xmath12 a probability measure on @xmath2 . for bounded measurable @xmath127 , @xmath128    let @xmath85 be the times at which @xmath5 hits @xmath4 for the @xmath87st time , and define @xmath129 note that @xmath130 , @xmath131 , are iid .",
    "let @xmath132 and write @xmath133 since @xmath5 hits @xmath4 in finite time a.s . , @xmath134 and @xmath135 are finite a.s .",
    "thus , @xmath136 notice @xmath137 , @xmath131 are iid with finite expectation and @xmath138 by the previous two displays and the law of large numbers , @xmath139}{{\\mathbb e}[r_0 ] }   = { \\mathbb e}^\\rho[\\sigma_p+1]^{-1 } \\sum_{i=0}^{\\sigma_p}{\\mathbb e}^\\rho[f(j_i ) ] = \\frac{\\nu f}{\\nu(m ) } = \\mu f,\\ ] ] with @xmath140 defined as in theorem  [ conv ] .",
    "markov chains for which the conclusion of theorem  [ conv ] hold are called _",
    "harris ergodic_. it is worth noting that a slightly stronger aperiodicity condition leads to a limit for the distribution of @xmath141 .",
    "more precisely , suppose   holds and for each @xmath142 and @xmath143 , @xmath144 is nonlattice .",
    "then for any @xmath145 and @xmath50-a.e .",
    "@xmath11 , @xmath146 } { \\int_m \\mu(dy){\\mathbb e}^y[\\tau_m^y]}.\\ ] ] see  @xcite for details in  @xcite for the last milestone point passed . ] and proof .",
    "we now describe in detail an algorithm for sampling @xmath50 and the mfpt @xmath48 $ ] , used successfully in  @xcite and  @xcite .",
    "we assume throughout this section that the conclusion of theorem  [ conv ] holds .",
    "let @xmath12 be an initial guess for @xmath50 .",
    "( if @xmath6 is brownian or langevin dynamics , we usually take @xmath12 to be the canonical gibbs distribution . )",
    "we write @xmath147 for the distinct milestones , so that @xmath148 .",
    "the algorithm will produce approximations @xmath149 of @xmath50 .",
    "let @xmath150 be the _ non - normalized _ restriction of @xmath151 to @xmath147 , and define @xmath152 : = \\mu^{(n)}(m_i)^{-1}\\int_{m_i } \\mu_i^{(n)}(dx){\\mathbb e}^x[\\tau_m^x],\\ ] ] for @xmath153 we will also use the notation @xmath154 below we think of @xmath155 and @xmath150 as either distributions or densities .",
    "the @xmath155 are obtained from trajectory fragments between milestone crossings . a simple monte carlo scheme for estimating these distributions is as follows .",
    "let @xmath156 be iid samples from the distribution @xmath157 .",
    "starting at each @xmath158 , simulate @xmath6 until it crosses the next milestone , say at the point @xmath159 .",
    "if we idealize by assuming the simulation of @xmath6 is done exactly , then by chebyshev s inequality , @xmath160 where @xmath161 is the dirac delta distribution at @xmath162 .",
    "we therefore write , for @xmath143 , @xmath163 where @xmath164 is either some suitable approximation to the identity at @xmath165 , or simply a delta function at @xmath165 . thus , in algorithm  1 we think of @xmath155 and @xmath166 as either densities in the former case , or as distributions in the latter . the local mean",
    "first passage times ( i.e. , the times between successive milestone crossings ) are approximated by the sample means @xmath167",
    "\\approx \\frac{1}{l } \\sum_{\\ell = 1}^{l } \\tau_m^{x_\\ell}.\\ ] ] it is important to realize that we do not need to store the full coordinates of each @xmath165 in memory . instead , it suffices to use a data - structure that keeps track of the pairs @xmath168 .",
    "the actual coordinates of each point can be written to disk and read from it as needed .",
    "milestones @xmath169 , initial guess @xmath12 , and tolerance @xmath170 for the absolute error in the mfpt .",
    "estimates for @xmath50 , local mfpts @xmath171 $ ] , and overall mfpt @xmath172 $ ] .",
    "@xmath173 @xmath174 @xmath12 @xmath175 @xmath174 @xmath176 estimate @xmath177 and @xmath178 $ ] @xmath179 @xmath174 @xmath180 solve @xmath181 ( with @xmath182 and @xmath183 ) @xmath184 @xmath174 @xmath185 normalize @xmath151 @xmath186 @xmath174 @xmath187 $ ] * break * @xmath188 , t^{(n)})$ ]    the eigenvalue problem in algorithm  [ alg : exact - milestoning ] involves a stochastic matrix @xmath189 that is sparse .",
    "indeed , the @xmath190-th row corresponds to milestone @xmath147 and may have only as many non - zero entries as the number of neighboring milestones @xmath191 . in practice , to solve the eigenvalue problem we can use efficient and accurate krylov subspace solvers  @xcite such as arnoldi iteration  @xcite to obtain @xmath192 without computing all the other eigenvectors .    in algorithm",
    "[ alg : exact - milestoning ] , if @xmath193 is used instead of the solution @xmath192 to @xmath181 , then the algorithm approximates @xmath50 by simple power iteration , @xmath194 . the reason for defining the weights as the solution to @xmath181 is practical",
    ": we have found that it gives faster convergence of the iterations , at no apparent cost to accuracy .",
    "it can be seen as a version of power iteration that uses coarse - graining .",
    "see  @xcite for applications of the algorithm in exact milestoning and  @xcite for related discussions .",
    "finally , we mention the fact that pseudo - random number generators ( prngs ) can only produce a finite amount of pseudo - random numbers . once the maximum amount is reached",
    ", the generators may silently reuse the previous random numbers in the same order .",
    "it has been noted  @xcite that this phenomenon leads to unphysical artifacts in simulations .",
    "the simplest approach to properly use prngs ( and avoid the aforementioned artifacts altogether ) consists of reseeding the generator from time to time , obtaining the new seeds from high - quality entropy sources such as those available in modern computer hardware ( see  @xcite for more details ) .",
    "in practice , due to time discretization error , we can not generate trajectories exactly according to the transition kernel @xmath195 .",
    "instead , we can generate trajectories according to a numerical approximation @xmath196 . we investigate here whether such schemes are consistent , that is , whether powers of @xmath196 of @xmath195 converge to a distribution @xmath197 .",
    "we emphasize that , even though we account for time discretization here , we still assume infinite sampling , and thus for a given @xmath18 , @xmath198 may be a continuous distribution .",
    "see section  [ mfpt_approx ] below for related remarks and a discussion of how time discretization errors affect the exact milestoning estimate of the mfpt .",
    "the following theorem , restated from  @xcite , establishes consistency of iteration schemes based on theorem  [ conv ] when @xmath196 is sufficiently close to @xmath195 and @xmath5 is geometrically ergodic . after the theorem , in lemma  [ geom_ergodic ] and",
    "theorem  [ feller ] we give natural conditions for geometric ergodicity of @xmath5 .",
    "[ ferre_thm ] suppose @xmath5 is geometrically ergodic : there exists @xmath199 such that @xmath200 let @xmath201 be a family of stochastic kernels with @xmath202 , assumed to act continuously on @xmath203 , such that @xmath204 then for each @xmath205 , there is @xmath206 such that for each @xmath207 , @xmath196 has a unique invariant probability measure @xmath208 , and @xmath209    geometric ergodicity is inconvenient to check directly .",
    "we give two sufficient conditions for geometric ergodicity of @xmath5 .",
    "the first condition is a uniform lower bound on the probability to reach @xmath4 in @xmath210 steps ; see lemma  [ geom_ergodic ] .",
    "we use this to obtain a strong feller condition in theorem  [ feller ] .",
    "the latter is a very natural condition and is easy to verify in some cases , for instance when @xmath6 is a nondegenerate diffusion and the milestones are sufficiently regular .",
    "[ geom_ergodic ] suppose that there exists @xmath211 and @xmath212 such that for all @xmath18 , @xmath213 .",
    "then @xmath5 is geometrically ergodic : @xmath214    let @xmath215 , consider the signed measure @xmath216 and compute @xmath217 the last line uses the fact that @xmath218 is a positive measure .",
    "this shows that @xmath219 is a contraction mapping on @xmath220 with contraction constant @xmath221 .",
    "observe also that @xmath222 .",
    "the result now follows from the contraction mapping theorem .",
    "see for instance theorem  6.40 of  @xcite .",
    "note that the @xmath223 in lemma  [ geom_ergodic ] is useful for understanding the convergence rate .",
    "lemma  [ geom_ergodic ] leads to the following condition for geometric ergodicity of @xmath5 .",
    "[ feller ] suppose that @xmath2 is compact and @xmath5 is a strong feller chain which is aperiodic in the sense of  .",
    "then @xmath5 is geometrically ergodic .",
    "let @xmath224 . by theorem  [ conv ] , for each @xmath18",
    "there is @xmath225 such that @xmath226 for all @xmath227 . because @xmath5 is strong feller ,",
    "the map @xmath228 is continuous . by compactness of @xmath2",
    ", it follows that for any @xmath229 there is @xmath212 such that @xmath230 for all @xmath143 and @xmath231 .",
    "theorem  [ geom_ergodic ] now yields the result .      as discussed above , equation  [ main_eq ]",
    "can be used to estimate the mfpt @xmath48 $ ] by sampling @xmath50 and local mfpts @xmath40 . the error in this estimate has two sources .",
    "first , in general we only have an approximation @xmath232 of @xmath50 .",
    "the second source of error is in the sampling of @xmath40 , due to the fact that we can only simulate a time discrete version @xmath233 of @xmath6 . in theorem  [ errors ] below we give an explicit formula for the numerical error of the mfpt in terms of these two sources .",
    "we first need the following notation .",
    "let @xmath234 be the minimum of all @xmath235 such that the line segment between @xmath236 and @xmath237 intersects @xmath238 , and define @xmath239 : = \\int_m { \\tilde \\mu}(dx){\\mathbb e}^x[{\\tilde \\tau}_m^x].\\ ] ] theorem  [ errors ] below gives an expression for the error in the _ original _ milestoning as well as in exact milestoning .",
    "[ errors ] there exists a nonnegative function @xmath240 such that @xmath241 - { \\tilde \\mu}(p)^{-1}{\\mathbb e}^{\\tilde \\mu}[{\\tilde \\tau}_m ] \\right|    & \\le c_1 \\left| \\mu(p)^{-1}-{\\tilde \\mu}(p)^{-1 } \\right| \\\\    & \\qquad+ { \\tilde \\mu(p)^{-1 } } \\left ( c_2 \\|\\mu - { \\tilde \\mu}\\|_{tv } + \\phi(\\delta t ) \\right),\\end{split}\\end{aligned}\\ ] ] where @xmath242,\\qquad c_2:=\\sup_{x \\in m } { \\mathbb e}^x[\\tau_m^x].\\ ] ]    note that @xmath243|&= |\\mu(p)^{-1}{\\mathbb e}^{\\mu}[\\tau_m ] - \\tilde{\\mu}(p)^{-1}{\\mathbb e}^{\\tilde \\mu}[{\\tilde \\tau}_m]|\\\\ & \\le |\\mu(p)^{-1}{\\mathbb e}^\\mu[\\tau_m ] - { \\tilde \\mu}(p)^{-1}{\\mathbb e}^\\mu[\\tau_m]| \\\\ & \\qquad+ |{\\tilde \\mu}(p)^{-1}{\\mathbb e}^\\mu[\\tau_m ] - { \\tilde \\mu}(p)^{-1}{\\mathbb e}^{\\tilde \\mu}[\\tau_m]| \\\\ &",
    "\\qquad\\qquad+ |{\\tilde \\mu}(p)^{-1}{\\mathbb e}^{\\tilde \\mu}[\\tau_m ] - { \\tilde \\mu}(p)^{-1}{\\mathbb e}^{\\tilde \\mu}[{\\tilde \\tau}_m]|\\end{aligned}\\ ] ] where we have written @xmath244 : = \\int_m { \\tilde \\mu}(dx){\\mathbb e}^x[{\\tau}_m^x]$ ] . we may write @xmath245 - { \\mathbb e}^{\\tilde \\mu}[{\\tilde \\tau}_m]|\\ ] ] for the term depending only on time stepping error .",
    "note that @xmath246- \\int_m { \\tilde \\mu}(dx){\\mathbb e}^x[\\tau_m^x]\\right|\\\\ & \\le \\left(\\sup_{x \\in m } { \\mathbb e}^x[\\tau_m^x]\\right ) \\|\\mu-{\\tilde \\mu}\\|_{tv}.\\end{aligned}\\ ] ] combining the last three expressions yields the result .",
    "recall that in the above we have ignored errors from finite sampling .",
    "we now discuss the implications of those errors . in the original milestoning , @xmath247 is the canonical gibbs distribution on the milestones . in that setting , we can typically sample independently from @xmath247 on the milestones .",
    "thus , the central limit theorem implies that the _ true _ error in the milestoning approximation of @xmath48 $ ] is bounded above with high probability by the right hand side of     we do not analyze the time discretization error @xmath248 and instead refer the reader to  @xcite and references therein .",
    "here we simply remark that , if @xmath6 is a diffusion process , then under certain smoothness assumptions on the drift and diffusion coefficients of @xmath6 and on @xmath2 , we have @xmath249 when @xmath250 is the standard euler time discretization with time step @xmath251 .",
    "see  @xcite for details and proof .",
    "see also  @xcite for numerical schemes that mitigate time discretization error in the mfpts .",
    "in this section we discuss two examples of milestoning to illustrate the method .",
    "we consider the solution , @xmath6 , of the brownian dynamics equation , @xmath252 where @xmath253 is a smooth potential energy function , @xmath254 is the inverse temperature , and @xmath255 is a standard brownian motion .",
    "we begin with a system characterized by the mller - brown potential  @xcite .",
    "the energy function @xmath256 is given by the formula ( see also the corresponding energy landscape in figure  [ fig : muller - potential ] ) @xmath257 this system is a commonly used benchmark for numerical methods for obtaining reaction rates .",
    "we chose to partition @xmath0 using a voronoi tessellation ( displayed in figures  [ fig : muller - potential ] and  [ fig : muller - potential - annotated ] ) generated from a set of points gathered by the method of locally updated planes  @xcite .",
    "however , any other set of points could have been chosen ( as we shall discuss in the next example ) .",
    "figure  [ fig : muller - potential ] also shows our choice of reactant and product milestones .    for the numerical experiments to be detailed below",
    ", we solve the stochastic differential equation in   using the euler - maruyama scheme  @xcite with a time step length @xmath258 at a temperature determined by @xmath259 .",
    "we use the number of force evaluations as a measure of the computational cost of our methods and we note that the euler - maruyama method requires one force evaluation per time step .",
    "we compared two types of experiments that we now describe .",
    "the first experiment consists of running brownian dynamics trajectories started at the reactant milestone until they reach the product milestone .",
    "as soon as a trajectory reaches the product , we initiate a new trajectory from the reactant milestone and so on .",
    "we refer to these as _ long _ trajectories . in the second experiment we run exact milestoning starting the first iteration with exactly one phase space point at each of the milestones along the reaction path .",
    "next , we run ten _ short _ trajectories per milestone per iteration .",
    "these short trajectories start at each milestone and stop whenever they reach any neighboring milestone , as described in section  [ sec : algorithm ] .    despite allowing the long trajectories to go on for approximately @xmath260 force evaluations , only seven reach the product milestone .",
    "this leads to a poor approximation of the mean first passage time .",
    "by contrast , running the exact milestoning method for approximately @xmath261 force evaluations , we obtain good estimates of the stationary distribution @xmath50 and the local mean first passage times .",
    "the values of @xmath262 are displayed in figures  [ fig : muller - flux ] and  [ fig : q - muller ] .",
    "the empirical distributions corresponding to @xmath50 on some of the milestones are shown in figure  [ fig : empirical - distributions ] .     at some of the milestones in the mller - brown potential .",
    "the values correspond to the long trajectories ( in red ) and to exact milestoning ( in blue ) , as discussed in section  [ sec : muller - brown ] .",
    "not shown are the milestones other than @xmath147 for @xmath263 , where the sampling obtained from the long trajectories is insufficient for comparison . ]    .",
    "notice that the sampling of the long trajectories is very sparse at the milestones close to the product . ]",
    "figures  [ fig : muller - flux ] and  [ fig : q - muller ] illustrate the non - equilibrium nature of exact milestoning .",
    "the stationary distribution that we compute differs noticeably from the equilibrium ( canonical ) distribution .",
    "recall from figures  [ fig : muller - potential ] and  [ fig : muller - potential - annotated ] that the reactant milestone , @xmath264 , is located at the lower - right minimum while the product milestone , @xmath265 , is at the global minimum in the upper - left side of the graph . with this in mind",
    ", we see that trajectories initiated at @xmath264 arrive at the intermediate minimum located close to the center of the graph and many of those trajectories return to the lower minimum , crossing @xmath264 again .",
    "this results in high values of @xmath266 at the transition state , while the density at @xmath265 ( the global minimum ) is significantly lower .",
    "equilibrium considerations , which are inappropriate here , would suggest that most of the stationary density ( and the stationary probability ) is concentrated at the global minimum and that the weight at the transition state would be small .      in this case , we present an example of milestoning on the torus @xmath267 . for our computations ,",
    "we consider a uniformly spaced mesh of milestones with fixed product and reactant sets @xmath268 ; see figure  [ fig : omega - milestones ] .",
    "we model a rough energy landscape by a potential energy function of the form : @xmath269 where @xmath270 denotes the real part of a complex number and @xmath271 is a constant that tunes the ruggedness of the potential .",
    "each coefficient @xmath272 is determined by the random variables @xmath273 and @xmath274 , which are distributed according to @xmath275 with @xmath276 itself being a uniform random variable in the interval @xmath277 .",
    "since @xmath210 is fixed , a particular realization of the coefficients specified above completely determines the potential energy function @xmath278 .",
    "the graph of the canonical density of a potential energy of the form discussed above is shown in figure  [ fig : rough - energy - landscape ] .     at temperature @xmath279 . ]",
    "notice that this class of energy functions generalizes the model for rough landscapes introduced by  @xcite and that similar potential energy functions have been used to model wigner glasses  @xcite .",
    "we carry out exact milestoning in this example by solving boundary value problems , as described in  @xcite . the resulting stationary density obtained after convergence",
    "is shown in figure  [ fig : rough - stationary - density ] .    .",
    "each milestone is an edge of one of the small squares in the diagram .",
    "( the total number of milestones has been decreased to enhance visibility . ) ]     on the rough energy landscape of section  [ sec : rough - landscape ] .",
    "the contour lines are the level sets of @xmath278 .",
    "there are @xmath280 total milestones ( shown as the segments in the overlaid grid ) . ]    it is interesting to note that it has been argued  @xcite that an optimal choice of milestones would consist of using the level sets ( also called _ isocommittors _ ) of the committor function .",
    "these surfaces ( see figure  [ fig : isocommittors ] ) are typically hard to compute in practice , which makes the use of exact milestoning more appealing , as its results are independent of how the milestones are set up .    .",
    "the main goal of this manuscript is to present a rigorous mathematical derivation , based on probability theory , of exact milestoning .",
    "while the theory of exact milestoning and accompanying numerical examples were discussed elsewhere  @xcite , the mathematical formulation in the earlier paper was not as rigorous as in this manuscript .",
    "once this formulation is established , it opens the way for further communication between chemical physicists and mathematicians , and it bridges the gap between the communities for further development of an important tool for computer simulation .",
    "exact milestoning belongs to a class of enhanced sampling methods for the calculation of kinetics .",
    "most closely related approaches to milestoning are the non - equilibrium umbrella sampling  @xcite and trajectory tilting  @xcite .",
    "the way in which trajectories are sampled is similar in all of these methods ; however , the theoretical frameworks are different . for example",
    ", milestoning allows the calculation of all the moments of the first passage time ( fpt ) distribution  @xcite , and hence better estimates of the fpt can be constructed , a result that was not reported for other methods .",
    "it is not necessary in milestoning to establish or rely on metastability to estimate the average transition time . from this perspective",
    "the method is different from another exact approach transition path sampling  @xcite that exploits the short duration of rare trajectories between metastable states .",
    "exact milestoning makes the sampled trajectories short by sampling trajectory fragments between boundaries of phase space cells or milestones .",
    "the statistics of short trajectories between milestones make it possible to investigate wide ranges of types of energy landscapes , which may be corrugated or not , as illustrated in the two examples in this manuscript .",
    "we have shown in the present manuscript that exact milestoning is both accurate and highly efficient .",
    "it is important to emphasize that the choice of the milestones in exact milestoning is arbitrary from a formal viewpoint .",
    "efficiency considerations suggest that it is beneficial to select them following two criteria : ( i ) the milestones should be sufficiently close in the kinetic sense to make the trajectories short , and ( ii ) milestones should be chosen to make the number of iterations as small as possible .",
    "for example , the number of iterations can be small if the system is close to equilibrium and the milestones are expressed in a space of slow variables .",
    "then an initial choice of the canonical distribution is quite accurate .",
    "we comment that the method of milestoning that was broadly used in the past ( e.g. , @xcite ) is approximate and assumes local equilibrium within the milestones .",
    "while corrections and further refinements were proposed  @xcite , these approximations can not be made exact and are similar in spirit to the local equilibrium and lag time approximations of markov state models  @xcite .",
    "nevertheless , these approximations can be accurate with a proper choice of coarse variables .",
    "these types of approximations are very useful as the system grows in complexity and size and exact calculations become prohibitively expensive .",
    "milestoning made it possible to investigate kinetics of enzymes  @xcite and transport through membranes  @xcite in agreement with experimental observations .",
    "these are systems of tens to hundreds of thousands of particles and time scales of milliseconds .",
    "it will be of considerable interest to re - evaluate these approximations for large systems with the method of exact milestoning . as the efficiency of exact milestoning increases with faster hardware",
    ", we are breaking scale barriers that were not accessible before to atomically detailed simulations .",
    "this research was supported in part by a grant from the nih gm59796 and from the welch foundation grant no .",
    "d. aristoff gratefully acknowledges support from the national science foundation via the award nsf - dms-1522398 .                        , _ enhancing the capacity of molecular dynamics simulations with trajecory fragments , in innovation in biomolecular modeling and simulation _ , t. schlick , editor .",
    "2012 , royal society of chemistry : london .                , _ how to eat your entropy and have it too  optimal recovery strategies for compromised rngs _ , in advances in cryptology  crypto 2014 se - 3 , j.  garay and r.  gennaro , eds .",
    "8617 of lecture notes in computer science , springer berlin heidelberg , 2014 , pp ."
  ],
  "abstract_text": [
    "<S> we give a mathematical framework for exact milestoning , a recently introduced algorithm for mapping a continuous time stochastic process into a markov chain or semi - markov process that can be efficiently simulated and analyzed . </S>",
    "<S> we generalize the setting of exact milestoning and give explicit error bounds for the error in the milestoning equation for mean first passage times . </S>"
  ]
}