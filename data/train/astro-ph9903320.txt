{
  "article_text": [
    "in order for hydrodynamics codes to be able to simulate shocks it is necessary that the width of the shock be spread over a few mesh cells , or represent a few inter - particle spacings , depending on whether a grid or particle based code is being used . in reality",
    ", however , the true width of the shock is only a few mean free paths , giving a shock thickness @xmath5 , of @xmath6 where @xmath7 is the number density and @xmath8 is the collisional cross - section .",
    "a few simple calculations show that the true shock thickness is orders of magnitude smaller than the shock thickness obtained in simulations .",
    "this allows the possibility that gas in simulations can cool artificially while passing through a shock , and that temperature - sensitive quantities , such as ionization levels and molecular abundances may also vary .",
    "any such effects will be purely numerical because of the finite shock crossing time in simulations . in the present paper",
    "will consider a number of possibilities .",
    "firstly , if gas is able to cool during a shock the maximum temperature the gas will reach after passing through the shock will be reduced from that of an adiabatic jump . where the cooling function rate decreases with increasing temperature , this",
    "will then reduce the cooling time of the post - shock gas .",
    "secondly , we shall consider the evolution of the ionization level through a shock , where the cooling rate is proportional to the number density of free electrons .",
    "this has important consequences for simulations of primordial structure formation as the ionization level determines the rate of molecular hydrogen ( ) and hydrogen - deuterium ( hd)production .",
    "these two molecules then determine the cooling time of the gas down to temperatures less than @xmath9k .",
    "finally , we shall also address the question of instability of radiative shocks .",
    "imamura et al . (",
    "1984 ) and chevalier and imamura ( 1982 ) found that radiative shocks with a cooling rate per unit volume @xmath10 ( where @xmath11 is the mass density and @xmath12 the temperature ) are unstable against perturbations when @xmath13 .",
    "this instability results in periodic oscillations of the position of the shock front and of the jump temperature at the shock front .",
    "we address the nature of these oscillations in the context of galaxy formation using a cooling function composed of the sum of a number of terms , each with a different power law .",
    "shocks can be generally classified into three types , depending upon the amount of cooling present . in adiabatic shocks",
    "the shocked gas does not cool significantly during the period of time of interest .",
    "isothermal shocks have the same jump conditions at the shock front as an adiabatic shock , but the cooling is very rapid so that the downstream gas is at the same temperature as the upstream gas .",
    "any cooling tail is thus very narrow . in between these two extremes",
    "is the case where the shocked gas has a cooling time of order the time - scale which is of interest in a given situation .    for an adiabatic shock",
    "the conservative form of the fluid equations in the absence of sources which change momentum , mass or energy can be written as @xmath14 @xmath15 @xmath16=0 \\label{equ : if3}\\ ] ] where the variables @xmath17 , @xmath18 , @xmath11 , @xmath19 and @xmath20 represent velocity , position , density , specific energy and pressure respectively , all evaluated in the rest frame of the shock .    if we apply equations [ equ : if1]-[equ : if3 ] to gas far upstream and write its properties in terms of gas far downstream , we arrive at the rankine - hugoniot jump conditions : @xmath21 @xmath22 @xmath23 where @xmath12 is the gas temperature , @xmath24 the boltzmann constant @xmath25 the mean molecular weight and @xmath26 the mass of a hydrogen atom . the suffixes @xmath27 and @xmath28 refer to the upstream and downstream gas respectively and the equation of state of the gas is given by the equations : @xmath29 @xmath30 taking @xmath31 we can write the pressure of the shocked gas as @xmath32    for the case of an isothermal shock where the temperature of the gas far downstream is equal to its temperature up stream , the conservation of energy equation is no longer valid and should be replaced with the condition @xmath33 .",
    "we must stress however that the gas will still undergo an adiabatic jump at the shock front before cooling back down to its upstream temperature .    for the case of a radiative shock",
    "we wish to determine the path between the state of the gas at the shock front and its state downstream . in order to do this",
    "we must add a cooling term to the energy flux equation : @xmath34=0 \\\\ \\label{equ : apf3}\\ ] ] the cooling term @xmath35 serves to determine the path between the down stream and adiabatic jump conditions , but does not change them in any way .",
    "equations [ equ : if1 ] , [ equ : if2 ] and [ equ : apf3 ] can be numerically integrated for any cooling function resulting in an analytic profile from the specified down - stream conditions to the shock front .",
    "the shock front is reached when the adiabatic jump condition of equation [ equ : stop ] is satisfied .",
    "the shock tube simulations were performed using a smoothed particle hydrodynamics code .",
    "the code was that described by couchman , thomas & pearce ( 1995 ) but with modified geometry to make the simulation volume cuboidal with dimensions of @xmath36 .",
    "the shock front was initially set to be at z coordinate @xmath37 with gas flowing in the z direction . on what will be the upstream side of this point ,",
    "particles are placed one per unit volume and given unit mass .",
    "on the downstream side , particles were placed four per unit volume .",
    "their mass however is allowed to vary in order for the gas to have any density profile that is initially desired . the density profile , along with the temperature and velocity of the gas ,",
    "is read in upon the start of a simulation .",
    "for this geometry the simulation thus starts with @xmath38 particles .",
    "the particles on each side of the shock front were allowed to relax independently to a glass - like initial state .",
    "the sides of the simulation box were periodic , with the exception of each end , where gas was fed into the box at the appropriate rate upstream and removed from the simulation a sufficient distance downstream so as not to effect any cooling tail .",
    "a padding region of two mesh cells at each end was necessary and gas within this region had its position updated on each time - step , but did not have its energy , velocity or density updated .",
    "( the code searches for @xmath39 neighbours , thus needing a search radius of approximately @xmath28 units when particles are located one per cell .",
    "it is this distance that determines the size of the padding region as any particle closer than this distance to the end of the simulation volume would experience a non - symmetric force . )",
    "all simulations were performed in the rest frame of the shock and the units the code used were dimensionless until a cooling function was chosen .",
    "the cooling function , and ionization / recombination rates were integrated using rk4 from press et al .",
    "( 1992 ) , this routine being called at the end of each time - step .",
    "all the rates used were tabulated on the first timestep .",
    "the cooling function for objects with high virial temperatures ( above @xmath40k ) collapsing after the universe has been enriched with metals can be written as the sum of three terms : a bremsstrahlung term , @xmath41 , a metal line - cooling term , @xmath42 and a h - he term , @xmath43 .",
    "the fit for each term is split into two temperature regimes . for @xmath44k",
    "we have , where @xmath45erg @xmath46 @xmath47 : @xmath48 @xmath49 @xmath50 for @xmath51k we have : @xmath52 @xmath53 @xmath54 where @xmath55 is the metallicity in terms of solar .",
    "the above cooling function is a good approximation to within a factor of @xmath28 to raymond & smith ( 1977 ) .",
    "the nature of this cooling function is such that the cooling rate rises abruptly as one moves from a temperature @xmath56k to @xmath57k .",
    "the cooling rate peaks at @xmath58k and then decreases , reaching a minimum at @xmath59k . at this point bremsstrahlung",
    "cooling starts to become effective and the cooling rate begins to slowly rise as the temperature increases further . for gas being shocked from @xmath40k to a temperature of order @xmath59k",
    "the cooling function is of a suitable nature to produce a significant reduction in the cooling time of shocked gas , if in - shock cooling is present .",
    "the cooling rate being most rapid at lower temperatures and then decreasing as the temperature rises above @xmath58k means that a modest reduction in the maximum temperature reached could make a significant difference to the cooling time as it is the hottest gas that takes the longest to cool .",
    "unfortunately a declining cooling function makes the shock unstable and in this section we restrict ourselves to studying shocks which do not reach the declining part of the cooling function , and which thus settle down into a steady state .",
    "the nature of such shocks can be specified by the ratio of the cooling time to the shock crossing time .",
    "if the cooling time is very long , and the ratio is thus large , the effect of in - shock will be negligible .",
    "conversely , if the cooling time is very rapid , in - shock cooling will tend to drive the shock towards an isothermal transition .",
    "the cooling time itself will be determined by the physical conditions that are being simulated and will be determined by the density and temperature of the gas .",
    "the shock crossing time will depend upon the mass resolution of the code and will vary as the cube root of the particle mass .      by specifying the downstream conditions of the shock , equations [ equ : if1 ] , [ equ : if2 ] and [ equ : apf3 ] were numerically integrated for @xmath35 of section @xmath60 , and a profile of the cooling tail",
    "was obtained .",
    "the integration was stopped at the shock front , when equation [ equ : stop ] was satisfied .",
    "this profile was then read directly into the shock - tube to create the initial conditions , with the shock front being placed at the boundary between the low and high mass particles .",
    "particles within the region of the cooling tail had their temperature , velocity and mass adjusted to recreate the analytic shock profile .",
    "the simulations were then allowed to run until a steady state - state was reached .",
    "the upstream gas was started with a temperature of @xmath61k and the analytic jump temperature was @xmath62k .",
    "the density of gas far downstream had a density twelve times that of the upstream gas .",
    "two simulations were ran , one with a ratio of the shock crossing time to the cooling time of @xmath63 , and the other with a ratio of @xmath64 .",
    "figures [ fig : stable1 ] and [ fig : stable2 ] show the temperature profiles as a function of position for two shocks with ratios of @xmath63 and @xmath64 respectively . despite the upper part of the theoretical shock being in the unstable regime",
    "the simulations were found to settle down into a steady state .",
    "this was aided by in - shock cooling which reduces the maximum temperature reached .",
    "the solid lines in show the analytic temperature profiles .",
    "we can see that the maximum temperature obtained is approximately @xmath65 percent less than the analytic jump temperature in figure [ fig : stable1 ] , and @xmath37 percent less for the simulation of figure [ fig : stable2 ] with a particle mass @xmath66 times greater .",
    "the effect that these reductions in jump temperature have on the cooling tails can be seen to be somewhat erratic . in both cases the cooling time of the gas decreases by a factor of approximately @xmath28 , but the spatial extent of the cooling tail depends upon the resolution .",
    "the reason for this is that spatial location is not an accurate indication of the cooling time , as the latter is dependent upon the density .",
    "we would not necessarily expect the shock - tube simulations to have the same density profile or the same density jump at the shock front as the theoretical profile .",
    "however they do converge to the correct jump conditions far downstream .",
    "the sort of objects in numerical simulations where in - shock cooling will be important are those with a low ratio of cooling time to shock crossing time and which cool on a time - scale of order the dynamical time of the virialized halo .",
    "objects which cool on a time - scale much longer than this are generally of little interest as they will not collapse sufficiently quick to form luminous objects . at the other extreme , if an object cools on a time - scale much less than the dynamical time",
    "the gas will be in a state of free - fall collapse ; in - shock cooling will certainly be present in this case as the cooling is so rapid , but the correct conditions will be recovered on a time - scale less than the dynamical time .    as an example , consider the collapse of an object with a cooling time equal to its collapse time , in a cosmological simulation with a dark - matter particle mass of @xmath67 .",
    "taking @xmath68 , a galaxy with total mass of @xmath69 collapsing at redshift @xmath28 would have a shock velocity at about @xmath70km@xmath71 .",
    "taking the shock to be spread over @xmath72 inter - particle spacings , we find the ratio of the cooling time to the shock crossing time to be @xmath64 . if the same object were to be simulated with a particle mass @xmath73 times lower , the ratio would increase to @xmath74 .",
    "the shock - tube simulations described in this section suggest that , for either large - scale cosmological simulations with a ratio of @xmath64 , or simulations of a single galaxy with a ratio of @xmath63 the effect of in - shock cooling will reduce the maximum temperature reached by between @xmath65 to @xmath37 percent and reduce the cooling time by a factor of approximately @xmath28 .",
    "the most important cooling mechanisms for a primordial gas with a temperature above @xmath75k result from recombination of electrons with hydrogen ions and collisional excitation of neutral hydrogen by collisions with free electrons , the excited hydrogen atom then emits a photon which , should it not be re - absorbed , amounts to a reduction in the internal energy of the gas .",
    "the cooling terms , taken from haiman , thoul and loeb ( 1996 ) are : @xmath76 @xmath77 where @xmath78 is the temperature in units of @xmath58k",
    ". the rate of energy loss from the gas will be proportional to the number densities of both neutral hydrogen and free electrons .",
    "the ionization level thus needs to be known and is generally not equal to its equilibrium value for the situations we shall consider . in order to trace the ionization level we need to specify the ionization and recombination rates . for the purpose of this section",
    "we consider a gas composed entirely of hydrogen which is ionized through the reaction : @xmath79 this proceeds at a rate ( black 1978 ) : @xmath80 the gas recombines via the reaction : @xmath81 which proceeds at a rate ( hutchins 1976 ) : @xmath82      for the electron - cooling runs , the gas was started with jump conditions for a perfectly isothermal shock .",
    "the motivation for this approach is that the cooling time is short , meaning that the perfectly isothermal conditions are reasonably close to the stable profile and should soon evolve to that state .",
    "the mass of the downstream particles was adjusted so that the correct density jump was obtained and the simulations were then allowed to run until the developing temperature , density and ionization profiles reach a stable state .",
    "gas upstream had an ionization level of @xmath83 and a temperature of 12000k , which was the minimum temperature permitted in the simulations .",
    "gas at or below 12000k did not have its ionization level updated and was not allowed to cool further as this would slow down the code too much .",
    "instead , cooling below 12000k was estimated analytically .",
    "run 1 is a fiducial run with units designed to represent an object at a redshift of 20 containing 10@xmath84 particles with a total baryonic mass of @xmath85 and a virial temperature of 78000k .",
    "runs @xmath28 and @xmath72 have the same mass resolution as the fiducial run but represent objects with higher and lower virial temperatures respectively . runs @xmath86 and @xmath87 have the same virial temperature as the fiducial run but lower and higher mass resolution respectively . runs @xmath88 and @xmath89 have a lower virial temperature than the fiducial but different mass resolutions .",
    "the mass resolution is represented by the number of particles an object of mass @xmath90 would contain , although the simulations which have been performed have the same number of particles in every case .",
    "table @xmath27 below lists the results of seven shock - tube simulations using the cooling functions of equations [ equ : emc ] and [ equ : emc2 ] . from left to right , the column headings of table  1 are : run number ; the number of particles an object of mass @xmath91 would contain , @xmath92 ; the ( analytic ) virial temperature @xmath93 ( the temperature the shocked gas should jump to ) ; the ratio of the maximum temperature obtained in the simulations to the virial temperature , @xmath94 ; the analytic ionization level for gas cooling from the virial temperature to 12000k , @xmath95 ; the ionization level of gas in the simulation that has cooled back to 12000k divided by the analytic level , @xmath96 ; the ratio of the simulated to analytic cooling times from the peak of the shock , down to 12000k , @xmath97 ; the ratio of the numerical to the analytic cooling times to reach 600k , @xmath98 ; and the ratio of the numerical to the analytic  fractions at 600k , h@xmath99/h@xmath100 .",
    "the analytic ionization level at 12000k , @xmath95 , assumes an adiabatic shock followed by rapid cooling and was calculated by integrating the shock conservation equations [ equ : if1 ] , [ equ : if2 ] and [ equ : apf3 ] with the cooling functions of equations [ equ : emc ] and [ equ : emc2 ] using non - equilibrium chemistry . cooling below 12000k",
    "was calculated allowing the gas to cool at a constant density to @xmath101k via the  cooling mechanism .",
    "a detailed treatment of the gas chemistry was used incorporating formation and destruction of , ionization and recombination , the cooling functions of equations [ equ : emc ] and [ equ : emc2 ] and the  cooling function .",
    "the destruction and cooling rates of  was taken from martin , schwarz and mandy ( 1996 ) .",
    "the simulated cooling time from 12000k to 600k , @xmath102 , and  fraction h@xmath103 use @xmath104 as the starting ionization level ; @xmath105 and h@xmath106 use @xmath95 as the input ionization .    [ cols=\"^,^,>,^,<,^,^,>,^\",options=\"header \" , ]        the effect of in - shock cooling is dramatic and striking in the fiducial run .",
    "the maximum temperature the shock reaches is only @xmath107 of its theoretical value .",
    "this leads to an increase in the cooling time for the gas to cool back down to 12000k by an astonishing factor of @xmath108 .",
    "there are a number of contributing factors to this extreme figure .",
    "firstly , although the ionization level at 12000k is @xmath109 times lower in the shocktube than expected , this is a conservative estimate of the difference , as the factor is somewhat higher than this at other points on the cooling tail .",
    "this is because the lower jump temperature obtained results in a much slower rate of of ionization . also , the density of the theoretical profile is somewhat higher at any given temperature ( above 12000k ) as the gas has reduced its temperature by a greater factor than gas at the same temperature in the shock tube .",
    "e.g. for the fiducial run , at 22000k the theoretical profile has a density of @xmath110 while gas at this temperature in the shocktube has has a density of only @xmath111 .",
    "these effects combined produce the high factors of @xmath97 seen in table  1 .",
    "the consequences of this are of extreme importance as simulations of such objects will be meaningless unless in - shock cooling can be removed , as the increase in the cooling times of such objects will slow the collapse .    also of importance is the ability of an object to cool to temperatures below 12000k when molecular hydrogen becomes the dominant coolant .",
    "molecular hydrogen is formed via the reactions @xmath112 @xmath113 its production is thus proportional to the ionization level , the free electrons acting as a catalyst .",
    "the effect of in - shock cooling on the fiducial run was found to halve the  abundance and to increase the cooling time from 12000k to 600k by a factor of two .      increasing the shock jump temperature , whilst retaining the same spatial and mass resolution results in a modest increase in the maximum temperature obtained at the shock front .",
    "this difference is sufficient to cause the ionization level of the cooled downstream gas , @xmath114 to be higher than that obtained in the fiducial run by a factor of almost three .",
    "however , the correct ionization level is still some way from being obtained in each of runs @xmath27 , @xmath28 and @xmath72 . comparing these runs",
    "shows that the fractional temperature reached increases with decreasing virial temperature , and the ionization level gets closer to its theoretical value .",
    "however , these trends do not appear to carry over to the cooling times and abundances when the virial temperature increases from 78000k to 168000k .",
    "this is due to the complex interaction between reaction rates and cooling times .",
    "as one might expect , improving the mass resolution reduces the severity of any in - shock effects . for jump temperatures of 78000k and 39000k , as the mass resolution is improved there is a steady convergence towards the correct values of the  abundance , the cooling time to @xmath101k , the cooling time from the virial temperature to 12000k and the jump temperature .",
    "essentially the convergence of the first three is determined by the convergence towards the correct jump temperature , as it is this temperature that determines the extent to which the gas is re - ionized which in turn determines the rate of  production and the cooling time .",
    "figure [ fidprofs ] shows the ionization level as a function of time for an analytical shock and for three shocks each with a virial temperature of 39000k , but with different mass resolutions . in each case",
    "we have defined time zero to be the time when gas reaches the maximum temperature .",
    "negative time represents gas which is being heated by the shock but has not yet reached the peak .",
    "these figures show the effect of lowering the resolution from the analytical profile , through runs 7 , 3 and 5 .",
    "note that the y - scale is the same in each panel but the x - scale is not .",
    "we can see from the graphs that as resolution is improved there is a convergence of the final ionization level and cooling time towards the theoretical profile .",
    "however , even if an object were to contain @xmath115 particles the effects of in - shock cooling would still remain significant , most noticeably for @xmath116 .",
    "such resolutions are at present not possible , and even if they were the quantities we have considered are yet to converge",
    ". we must conclude that the resolution of typical simulations being performed is hopelessly inadequate and if sensible results are to be obtained a way of removing in - shock cooling must be found .",
    "for a planar radiative shock with a cooling function @xmath117 , chevalier and imamura ( 1982 ) showed that for @xmath118 the shock is unstable against perturbations and will undergo oscillations both spatially and in the jump temperature .",
    "the latter results from the fact that as the shock front moves , the relative velocity of the upstream gas in the frame of the shock varies .",
    "this in turn results in a different solution of the jump equations .",
    "the situation is similar for stable shocks also : if perturbed , they also undergo oscillations but with a decaying amplitude . for values of @xmath119 between @xmath120 and @xmath28 chevalier and",
    "imamura found the frequency of oscillation , @xmath121 , to vary between @xmath122 and @xmath123 with units of @xmath124 where @xmath125 is the mean distance from the shock front to the point upstream where the gas has cooled to its upstream temperature , and @xmath126 is the velocity of the upstream gas .",
    "the maximum displacement of the shock front from its mean position , @xmath127 , was also calculated and was found to be @xmath128 , where @xmath129 is the steady state cooling time and @xmath130 the speed the shock front is moving at .",
    "the following simulations verify the instabilities found by chevalier and imamura ( 1982 ) for the case of a realistic cooling function composed of a number of power law terms , ( some of which are stable ) .",
    "an analytic profile of the cooling tail was calculated as in section @xmath131 .",
    "the gas upstream had a temperature of @xmath132k with a density jump of @xmath9 for the downstream gas .",
    "this results in a temperature jump of a factor of @xmath133 to @xmath134k .",
    "the cooling function used was that of section @xmath86 , meaning that gas with a temperature above @xmath58k is in the unstable regime .",
    "the fact that the shock is unstable means that a steady state will never be reached so the simulation was ran until the nature of the oscillations became apparent .",
    "the unstable nature of both the position and jump temperature of radiative shocks is well demonstrated upon consideration of figures [ usp ] and [ ust ] .",
    "although the cooling function used is not strictly a power law , but rather a combination of power laws , we find that both the magnitude of the spatial oscillations , and their period , are in reasonable agreement with the work of chevalier and imamura as presented above .",
    "the frequency of oscillations @xmath121 was found to be @xmath135 , where @xmath136 and p is the observed period of oscillations .",
    "the majority of heated gas in the simulation has @xmath137 . for the case of @xmath138 , chevalier and",
    "imamura found the oscillation frequency to be @xmath139 .",
    "the agreement is reasonable , although interpolation of the chevalier and imamura values to intermediate values of @xmath121 is somewhat uncertain as there is no obvious linear trend in their results .",
    "the maximum displacement of the shock was found to be @xmath140 which agrees well with the theoretical value of @xmath141 .",
    "the effects of in - shock cooling on the simulations is uncertain but , given that we know it is present , it may account for the extreme oscillations down to an isothermal transition as seen in figure 5 .",
    "we note , however , that the period and spatial magnitude of the oscillations appears to be correct even when in - shock cooling is present . in the absence of in - shock cooling ,",
    "any halo with a virial temperature of more than a few times 10@xmath0k ( i.e.  galaxies ) will be subject to such an instability .",
    "in this paper we have clearly demonstrated that in - shock cooling has important consequences for numerical simulations of galaxy formation , especially at high redshifts , where collisional excitation of hydrogen by free electrons , cooling by recombination and cooling by molecular hydrogen are the relevant coolants , but also for galaxies with higher virial temperatures collapsing at lower redshifts .",
    "the effect of in - shock cooling on a stable radiative shock was found to decrease the maximum temperature reached by @xmath65 percent when the ratio of the cooling - time to shock crossing time was @xmath63 .",
    "this value increased to @xmath37 percent for a ratio of @xmath64 .",
    "the result of this was that the profiles of the cooling tails were found to have different spatial extents from the theoretical profile .",
    "from this we conclude that although the effects of in - shock cooling are quite small , the collapse rate of such objects could be altered along with the spatial extent of any cooling tail .",
    "the effect on primordial objects of in - shock cooling was found to be extremely significant : the ionization level emerging from the shock was significantly lower by a factor of @xmath1 in the best resolved case , and up to a factor of @xmath142 in the worst case .",
    "the implications for the cooling time of the gas ranged from an increase of a factor of @xmath109 up to nearly @xmath73 , for the cooling times above 12000k . below 12000k",
    "the result was less extreme , ranging from a factor of @xmath143 to @xmath1 .",
    "this difference is nevertheless important and will significantly slow the collapse of any object .",
    "the resulting molecular hydrogen abundance of the gas after it was allowed to cool to @xmath101k was found in all cases to decrease from its analytic value by a factor of around 2 .    for the case of an unstable shock",
    "we find oscillations of the spatial location of the shock front and the maximum temperature reached .",
    "it is likely that the extreme oscillations of temperature observed ( cooling to a virtually isothermal state ) are fueled by in - shock cooling . for the resolutions currently achievable",
    ", an incorrect result will be obtained for simulations of galaxy formation .    finally , figure [ fig : qopfig ] shows a successful attempt to remove in - shock cooling from the fiducial run . the method used to remove the effect was case - specific and",
    "was achieved by allowing the gas to cool only when its temperature is in excess of the adiabatic jump temperature or its density exceeds the adiabatic jump density .",
    "the upper curve in figure [ fig : qopfig ] shows the gas density , the lower curve shows the temperature and the middle curve , with the double maximum , shows the dimensionless ratio of the artificial pressure to the pressure , @xmath144 .",
    "the density and temperature are plotted in code units .",
    "the finite width of the shock can clearly be seen and the correct jump conditions and ionization level both at the peak of the shock and downstream are recovered .",
    "the correct cooling tail down to a temperature of 12000k is also recovered .",
    "the importance of the ratio @xmath144 is that it is a dimensionless indicator of when the gas is being shocked and might therefore be used as a method of removing in - shock cooling from other simulations , by means of preventing the gas from cooling when @xmath144 exceeds a certain threshold value ( i.e. when the gas is being shocked ) . however , this approach is unlikely to prove successful for two reasons .",
    "firstly , consideration of the double maximum structure of @xmath144 as seen in figure [ fig : qopfig ] means than gas which is shocking does not necessarily have a value of @xmath144 greater than gas which is not .",
    "indeed , gas which is radiating rapidly ( which is the case for gas whose density is increasing ) has values of @xmath144 as high as gas which is being shocked . secondly , although @xmath144 is dimensionless and in theory could produce a threshold value true for all scales of simulations , we would not expect the threshold value to be the same for shocks of different strengths .",
    "these two reasons rule out the use of @xmath144 as a possible means of eliminating in - shock cooling .",
    "this was tested in a large - scale cosmological simulation .",
    "different objects were found to have very different values of @xmath144 and it was obvious that there was no single value that could be used to determine when gas was being shocked .",
    "the authors would like to thank paul nulsen for discussion about the effects of in - shock cooling .",
    "anninos p. , zhang y. , abel t. and norman m. l. , new astronomy , 2 , 209 black j.h .",
    ", 1978 , apj , 222 , 103 chevalier r. a. & imamura j. n. , 1982 , apj , 261 , 543 couchman h. , thomas p. a. , and pearce f. r. , 1995 , apj , 452 , 797 haiman z. , thoul a. a. and loeb a. , 1996 , apj , 464 , 523 hutchins j. b. , 1976 , apj , 205 , 103 imamura j.n . , wolff m. t. & durisen r. h. , apj , 1984 , 276 , 667 martin p.g .",
    ", schwarz d. h. & mandy m. e. , 1996 , apj , 461 , 265 press w.h . , teukolsky s. a. , vetterling w. t. & flannery b.p . , 1992 ,",
    "numerical recepies in fortran 2nd edition , cup raymond j.c . & smith b. w. , astrophys .",
    "j.suppl . , 1977 , 35 , 419"
  ],
  "abstract_text": [
    "<S> we model a one - dimensional shock - tube using smoothed particle hydrodynamics and investigate the consequences of having finite shock - width in numerical simulations caused by finite resolution of the codes . </S>",
    "<S> we investigate the cooling of gas during passage through the shock for three different cooling regimes .    for a theoretical shock temperature of 10@xmath0k , the maximum temperature of the gas is much reduced . </S>",
    "<S> when the ration of the cooling time to shock - crossing time was 8 , we found a reduction of 25 percent in the maximum temperature reached by the gas . </S>",
    "<S> when the ratio was reduced to 1.2 maximum temperature reached dropped to 50 percent of the theoretical value . in both cases the cooling time was reduced by a factor of 2 .    at lower temperatures , we are especially interested in the production of molecular hydrogen and so we follow the ionization level and abundance across the shock . </S>",
    "<S> this regime is particularly relevent to simulations of primordial galaxy formation for halos in which the virial temperature of the galaxy is sufficiently high to partially re - ionize the gas . </S>",
    "<S> the effect of in - shock cooling is substantial : the maximum temperature the gas reaches compared to the theoretical temperature was found to vary between 0.15 and 0.81 for the simulations performed , depending upon the strength of the shock and the mass resolution . </S>",
    "<S> the downstream ionization level is reduced from the theoretical level by a factor of between @xmath1 and @xmath2 , and the resulting  abundance was found to be reduced to a fraction of @xmath3 to @xmath4 of its theoretical value </S>",
    "<S> .    at temperatures above 10@xmath0k , radiative shocks are unstable and will oscillate . </S>",
    "<S> we reproduce these oscillations and find good agreement with the previous work of chevalier and imamura ( 1982 ) , and imamura , wolff and durisen ( 1984 ) . </S>",
    "<S> the effect of in - shock cooling in such shocks is difficult to quantify , but is undoubtedly present .    </S>",
    "<S> we conclude that extreme caution must be exercised when interpretting the results of simulations of galaxy formation .    </S>",
    "<S> methods : numerical  hydrodynamics  shock waves </S>"
  ]
}