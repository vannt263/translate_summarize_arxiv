{
  "article_text": [
    "the remarkable rise of density - functional theory@xcite ( dft ) in the last few decades owes much to the efficient treatment of exchange and correlation within the local - density approximation ( lda).@xcite however , known deficiencies in the lda s description of certain systems has led to the development of a hierarchy of exchange - correlation functionals of varying computational expense.@xcite at the high - complexity end of this spectrum of functionals lies the adiabatic connection - fluctuation dissipation formulation of dft ( acfd - dft),@xcite which in its simplest form corresponds to the random - phase approximation ( rpa ) correlation energy.@xcite `` beyond - rpa '' methods strive for an even higher level of accuracy and form an important and fast - developing field of research.@xcite    acfd - dft provides a natural path for the improvement of the rpa via the introduction of an exchange - correlation ( xc ) kernel @xmath2 , an ubiquitous quantity in time - dependent dft ( td - dft).@xcite the homogeneous electron gas ( heg ) has become a key system for the development and testing of new kernels through the acfd - dft calculation of correlation energies.@xcite jellium slabs also form important test systems , through the acfd - dft calculation of their surface energies,@xcite inter - slab interaction energies,@xcite and as benchmarks for widely - used semilocal xc functionals.@xcite however the last few years have seen the application of the acfd - dft formalism to calculate the correlation energies of atoms , molecules and solids , with promising results.@xcite    one such example is the `` renormalized kernel approach '' , which was introduced based on a model xc - kernel named the renormalized adiabatic lda ( ralda).@xcite the ralda exploits the accurate reciprocal - space description of heg correlation provided by the adiabatic lda ( alda ) in the long - wavelength limit , whilst correcting the alda s unphysical behavior at short wavelengths .",
    "the ralda and its generalized - gradient analogue ( rapbe ) have been shown to yield highly accurate atomization and cohesive energies of molecules and solids.@xcite    it is interesting to place the ralda into the context of other heg kernels .",
    "many theoretical studies have explored the properties of the exact xc - kernel and derived certain limits which are not necessarily obeyed by the ralda.@xcite similarly , the ralda is static , and apart from studies of the heg@xcite there is little known about dynamical effects on acfd - dft correlation energies .",
    "furthermore the xc - kernel of an insulator is known to behave qualitatively differently to a metallic system like the heg,@xcite with the xc - kernel of an insulator famously diverging @xmath3 in the limit of small wavevectors @xmath4.@xcite in this respect it is important to test the validity of applying a model heg kernel to non - metallic systems .",
    "this work explores the above aspects through a quantitative comparison of model heg xc - kernels . within our sample of xc - kernels",
    "we include the ralda,@xcite and also a kernel which satisfies exact limits of the heg,@xcite a simple dynamical kernel,@xcite and a kernel which has a divergence @xmath3 when describing an insulator.@xcite for each xc - kernel we use acfd - dft to calculate the correlation energy of a test set of 10 crystalline solids and evaluate the lattice constant and bulk modulus , which we then compare to calculations using semilocal functionals and the rpa , and also to experiment .",
    "we also provide a demonstrative calculation of the atomization energy of the hydrogen molecule to highlight the importance of spin - polarization .",
    "we find that all of the model xc - kernels greatly improve the magnitude of the rpa correlation energy whilst providing a highly accurate description of structural properties .",
    "our study is organized as follows . in section  [ sec.theory ]",
    "we review acfd - dft and the role played by the xc - kernel .",
    "in particular , we describe the expected behavior of the xc - kernel for the heg at certain limits ( section  [ sec.kernel_heg ] ) , introduce our chosen set of model kernels ( section  [ sec.kernelzoo ] ) and apply them to the heg ( section  [ sec.corr_hole ] ) . for inhomogeneous systems we require a scheme to generalize heg kernels for a varying density",
    "; in section  [ sec.averaging ] we discuss possible schemes and justify the choice made in this work .",
    "section  [ sec.results ] contains the results of our study , in which we discuss the calculated lattice constants and bulk moduli , absolute correlation energies and the h@xmath1 molecule .",
    "finally in section  [ sec.conclusions ] we summarize our results and offer our conclusions .",
    "here we summarize the essential concepts of acfd - dft .",
    "full derivations may be found in original articles@xcite or recent reviews , e.g.  refs .  and  .",
    "in acfd - dft , a system of fully - interacting electrons is described by a coupling - constant dependent hamiltonian @xmath5 .",
    "the coupling constant @xmath6 takes values between 0 and 1 and defines an effective interaction between electrons as @xmath7 , where @xmath8 is the coulomb interaction .",
    "@xmath9 corresponds to the exact hamiltonian of the fully - interacting system .",
    "in addition to the effective coulomb interaction @xmath5 contains a @xmath6-dependent single - particle potential @xmath10 , constructed in such a way that the ground - state solution of @xmath5 has exactly the same electronic density as the ground - state solution of the fully - interacting ( @xmath11 ) hamiltonian .",
    "the fixed - density path connecting @xmath12 and 1 defines the `` adiabatic connection '' . since @xmath13 describes a system of non - interacting electrons with a fully - interacting density , @xmath14 is readily identified as the kohn - sham potential from dft.@xcite    invoking the hellmann - feynman theorem , integrating with respect to @xmath6 along the adiabatic connection and comparing to standard dft@xcite yields an expression for the exchange - correlation ( xc ) energy in terms of the operator describing density fluctuations .",
    "the fluctuation - dissipation theorem@xcite provides the link between this operator and the frequency integral of a response function @xmath15 . for non - interacting electrons , @xmath16 , the kohn - sham response function of time - dependent dft.@xcite the xc - energy",
    "is then written as the sum of an `` exact '' exchange contribution @xmath17 and the correlation energy @xmath18 , where the latter is given by ( in hartree units ) : @xmath19 . \\label{eq.ec}\\ ] ] equation  [ eq.ec ] has been written in a plane - wave basis so that the quantities on the right - hand side are matrices in the reciprocal lattice vectors @xmath20 and @xmath21 , and the wavevectors @xmath22 belong to the first brillouin zone .",
    "the coulomb interaction is diagonal in a plane - wave representation with elements @xmath23 , and @xmath24 is a real number corresponding to an imaginary frequency , @xmath25 .",
    "the link between the interacting and non - interacting response functions is supplied by linear - response theory,@xcite which describes the behavior of density @xmath26 in the presence of a small perturbation : @xmath27 the fact that @xmath15 yields the exact density response at all values of @xmath6 allows the link to be made to @xmath28 through the following integral equation , @xmath29 where the hartree - xc kernel @xmath30 has been introduced as @xmath31 the xc - kernel @xmath32 describes the change in the xc - potential @xmath33 upon perturbing the density , which is a fully nonlocal quantity in time and space:@xcite @xmath34 by assuming approximate forms for @xmath28 and @xmath32 , one can use equation  [ eq.chi_ks ] to calculate @xmath15 and thus evaluate the correlation energy with equation  [ eq.ec ] .      in a plane - wave basis , the kohn - sham response function has the form@xcite @xmath35 where @xmath36 and @xmath37 represent the occupation factor and energy of the kohn - sham state @xmath38 , while the pair densities @xmath39 are matrix elements of plane waves , @xmath40 .",
    "@xmath41 is the volume of the primitive unit cell , and the factor of 2 assumes a spin - degenerate system . from equations  [ eq.ec ]  and  [ eq.chipw ] the benefits of the acfd - dft are not very obvious ; to construct @xmath28 we require @xmath42 , which means solving the kohn - sham equations and thus already obtaining the correlation energy . furthermore , to solve the integral equation ( [ eq.chi_ks ] ) we require the xc - kernel @xmath2 , which arguably is even more complicated than the xc - potential @xmath43 due to its frequency dependence .",
    "however the attraction of acfd - dft is that even setting @xmath44 yields both a nonlocal description of exchange and a nontrivial expression for the correlation energy , namely that obtained from the rpa:@xcite @xmath45    .",
    "\\label{eq.ecrpa}\\ ] ] the rpa has been applied across a wide range of physical systems@xcite and found to give a markedly improved description of nonlocal correlation effects .",
    "equation  [ eq.ecrpa ] is usually applied as a post - processing step to a dft calculation , analogous to @xmath46 corrections to band gaps.@xcite    based on the success of the rpa it may be hoped that the description of correlation might be further improved by using more sophisticated approximations for @xmath2 . while it turns out that the adiabatic local - density approximation ( alda ) offers little improvement,@xcite nonlocal , dynamical and/or energy - optimized approximations for @xmath2",
    "have been found to correct deficiencies of the rpa when calculating the correlation energy of the homogeneous electron gas ( heg).@xcite    we note that a non - self - consistent application of the acfd - dft formula might suffer from a dependence on @xmath43 , the exchange - correlation potential used to construct the orbitals forming @xmath28 . in this respect ,",
    "a self - consistent scheme is attractive and the subject of current research.@xcite however here we do not include any self - consistency and treat @xmath2 as a quantity to be optimized independent of the @xmath43 used to generate @xmath28.@xcite      in the same way that the heg is used to generate approximate xc - potentials , it also forms a natural starting point for approximate xc - kernels .",
    "here we review some properties of the exact xc - kernel of the heg .",
    "the analogue of equation  [ eq.chi_ks ] for the heg is : @xmath47 all quantities appearing in this equation are scalars , with @xmath48 .",
    "@xmath49 is the lindhard response function , with occupation numbers equal to 1 for plane - wave states below the fermi level and zero otherwise.@xcite as demonstrated in the appendix of ref .  , in the case that equation  [ eq.chi_ks ] is applied to the heg",
    "the lindhard and kohn - sham response functions coincide , so that the quantity @xmath50 appearing in equation  [ eq.chi_heg ] must also match its counterpart @xmath30 in equation  [ eq.chi_ks ] .",
    "therefore the heg forms a rigorous test ground for model xc kernels .    for simplicity",
    "we denote @xmath51 as @xmath52 .",
    "the local field factor @xmath53 is related to @xmath54 as @xmath55 , so that equation  [ eq.chi_heg ] defines @xmath56 in terms of the response functions @xmath57 and @xmath49.@xcite a potential source of confusion is that another field factor @xmath58 can be found in the literature which has a different defining equation.@xcite for @xmath58 , the lindhard response function appearing in equation  [ eq.chi_heg ] is modified such that the occupation numbers of each plane - wave state are calculated using the many - body wavefunction of the fully - interacting system.@xcite therefore @xmath59 is also a distinct quantity .",
    "however the kernels investigated in this work were derived based on the equivalence of equations  [ eq.chi_ks ]  and  [ eq.chi_heg ] for the heg,@xcite so it is @xmath56 which is of interest in the current work .",
    "the local - field factor @xmath56 ( and thus @xmath52 ) have been the subject of many theoretical studies ( c.f .",
    "section iiic of ref .  ) , and their behavior at certain limits is known exactly .",
    "first , in the long wavelength ( @xmath60 ) and static ( @xmath61 ) limit , the heg xc - kernel reduces to the adiabatic local - density approximation ( alda ) : @xmath62 where @xmath63 @xmath64 is the fermi wavevector for the heg of density @xmath26 , and @xmath65 is the correlation energy per electron .",
    "the two terms in equation  [ eq.a ] correspond to the exchange and correlation contributions to the alda kernel .",
    "equation  [ eq.smallq ] can be seen either as a consequence of the compressibility sum rule,@xcite or more simply by noting that the alda should be exact in describing the heg response to a uniform , static field.@xcite remaining in the static case , but considering small wavelengths ( @xmath66 ) yields@xcite @xmath67 whilst in the long wavelength , high frequency limit ( @xmath68 ) @xmath52 is given by@xcite @xmath69 although we have not written it explicitly , @xmath70 , @xmath71 , @xmath72 and @xmath73 depend on the density of the heg , or equivalently on the fermi wavevector or wigner radius @xmath74 .",
    "practically @xmath70 , @xmath72 and @xmath73 can be obtained from a parameterization of the heg correlation energy @xmath65 , while @xmath71 additionally requires the momentum distribution and on - top pair - distribution function of the heg.@xcite in this work we use the parameterization of @xmath65 and @xmath71 from refs .  and   respectively .",
    "in addition to these limits , calculating the correlation energy from equation  [ eq.ec ] requires an expression for @xmath52 across all @xmath4 and @xmath75 . ref .",
    "provided important insight into the heg xc - kernel with diffusion monte carlo calculations of @xmath76 for a range of @xmath4 vectors and densities .",
    "interestingly , one of the conclusions of the work was that in this static limit and for @xmath77 , @xmath52 could be well - approximated by taking its @xmath78 limiting form ( i.e.  the alda , equation  [ eq.smallq ] ) .      according to equation  [ eq.bigq ] ,",
    "the @xmath79 limit of @xmath52 is a constant , and thus @xmath80 diverges as @xmath0 .",
    "this property appears to have alarming consequences for the pair - distribution function : in ref .",
    "it is shown that a @xmath81 which diverges for large @xmath4 will yield a singular pair - distribution function at the origin ( see also refs .  ) .",
    "the crucial point to note however is that the relationship in ref .   assumes a _ frequency - independent _",
    "@xmath81 , which is not the same as the _ frequency - dependent @xmath53 evaluated at @xmath82 _ , which equation  [ eq.bigq ] describes .",
    "this point is discussed further in ref .  .    nonetheless , a frequency - independent model kernel satisfying the exact heg limits for small and large @xmath4 at @xmath82 ( e.g.  the cdop kernel@xcite ) will have a badly - behaved pair - distribution function , as demonstrated below and in fig .  2 of ref .  .",
    "in this respect , and given that the correlation energy is calculated as an integral over frequency , a frequency - averaged @xmath81 may be a better starting point for model kernels than @xmath80 .",
    "below we compare kernels which do or do not satisfy equation  [ eq.bigq ] .",
    "having introduced the relevant quantities for the heg , we now describe the xc - kernels investigated in the current work .",
    "the xc - kernels are plotted in reciprocal or real space in figs .",
    "[ fig.kernels](a )  and  ( b ) .",
    "the reciprocal and real space xc - kernels are related by the fourier transform @xmath83 with @xmath84 .          the renormalized adiabatic local density approximation ( ralda)@xcite xc - kernel is given by @xmath85 \\label{eq.ralda}\\ ] ] where the heaviside function @xmath86 for @xmath87 and zero otherwise .",
    "the cutoff wavevector is chosen as @xmath88    in previous applications of this kernel@xcite the coefficient @xmath70 defined by equation  [ eq.a ] was replaced by @xmath89 , corresponding to omitting the correlation contribution . in this work",
    "we shall refer to this exchange - only kernel as the ralda kernel @xmath90 .",
    "the special label @xmath91 ( raldac ) refers to the kernel calculated including both the exchange and correlation contributions in equation  [ eq.a ] .",
    "we note that the raldac kernel coincides with that of ref .   with @xmath92 and @xmath93 .",
    "@xmath91 obeys the exact @xmath94 , @xmath95 limit for the heg ( equation [ eq.smallq ] ) .",
    "furthermore , both @xmath91 and @xmath90 mimic the heg kernel@xcite in displaying small variation for wavevectors below @xmath96 . at larger wavevectors",
    "both kernels correspond exactly to the coulomb interaction with opposite sign , such that the corresponding hartree - xc kernels @xmath97 vanish for @xmath98 .",
    "in real space the kernel has the form @xmath99}{(k_c r)^2}\\right)\\right]\\ ] ] with the fourier transform of the heaviside functions leading to decaying oscillations [ fig .",
    "[ fig.kernels](b ) ] . at small @xmath100",
    "the xc - kernel diverges as @xmath101 , yielding a hartree - xc kernel which is finite at the origin.@xcite      the kernel introduced by corradini , del sole , onida and palummo ( cdop ) in ref .",
    "has the form @xmath102 } + \\frac{4\\pi c}{{k_f}^2 } \\right ] \\label{eq.cdop}\\ ] ] where @xmath103 , and @xmath104 and @xmath105 are density - dependent fitting parameters chosen to best reproduce the local field factor @xmath80 obtained from the qmc calculations of ref .  .",
    "uniquely among the kernels considered here , the cdop kernel obeys both the @xmath106 and @xmath107 limits of the heg at @xmath82 , equations [ eq.smallq ] and [ eq.bigq ] .",
    "however as noted above the short - wavelength @xmath72 term causes the pair - distribution function to diverge.@xcite in ref .",
    "a simplified kernel which avoids this divergence was obtained from equation  [ eq.cdop ] by setting @xmath93 .",
    "we shall also investigate this kernel in this work , labeled cdops ( @xmath108 ) .",
    "the real - space form of the cdop kernel is : @xmath109 e^{-k_f^2r^2/4\\beta }   \\label{eq.cdopreal}\\ ] ] we note that the @xmath72 term in equation  [ eq.cdop ] produces a @xmath110-function in real - space , while for small @xmath100 ( excluding the @xmath110-function ) the xc - kernel diverges as @xmath111 , such that the hartree - xc kernel is still divergent as @xmath112 .",
    "a kernel with a simpler functional form was introduced by constantin and pitarke ( cp ) in ref .",
    ": @xmath113 \\label{eq.cp}\\ ] ] here @xmath114 , which ensures that the heg @xmath115 , @xmath82 limit is satisfied . like",
    "the ralda kernels , at large wavevectors @xmath116 cancels the coulomb interaction so that @xmath97 vanishes .",
    "the cp kernel possesses a compact form in real space in terms of the error function : @xmath117 .",
    "\\label{eq.cpreal}\\ ] ] as @xmath118 , @xmath119 diverges as @xmath101 and thus yields a finite hartree - xc kernel in this limit .      with its simple form ,",
    "the cp kernel is an ideal starting point to explore more complex aspects of @xmath2 , such as its frequency dependence . in ref .",
    ", a dynamical kernel was introduced ( cpd ) by replacing @xmath120 appearing in equation  [ eq.cp ] with @xmath121 , i.e. @xmath122 \\label{eq.cpd}\\ ] ] where for imaginary frequency @xmath25 , @xmath123 in ref .",
    "the coefficient @xmath124 was chosen to correctly reproduce the @xmath106 , @xmath125 limit of the heg ( equation  [ eq.highfreq ] ) , while the relation @xmath126 was found to give a good fit to the correlation energy calculated for the heg using @xmath127 .",
    "we note that the cpd kernel varies non - monotonically with frequency in the @xmath106 limit.@xcite      the limits of the exact kernel discussed in section  [ sec.limits ] were derived for the heg , which is metallic .",
    "however , the xc - kernel of a periodic _ insulator _ is known to behave differently , diverging @xmath128 @xmath129 in the @xmath115 limit.@xcite this limit has been found to play an essential role in the td - dft calculation of excitonic effects in optical spectra , leading to the development of kernels which exhibit the same @xmath129 divergence.@xcite here we focus on the `` jellium with gap '' model ( jgm ) kernel of ref .  , which has the useful property of reducing to a model heg kernel@xcite when applied to a metallic system .",
    "the jgm kernel of ref .   was derived based on two steps .",
    "first , the theoretical arguments of ref .   were used to connect the @xmath115 limit of @xmath2 to @xmath130 , the dielectric function , as @xmath131 $ ] ( a similar relation was found empirically in ref .  ) .",
    "then , the model dielectric function of ref .",
    "was used to relate @xmath130 to the band gap of the material @xmath132 , as @xmath133 .",
    "the same power dependence may be found for other model dielectric functions , e.g.  the penn model,@xcite and essentially follows from the @xmath134-sum rule . combining these relations places a requirement on the model kernel that it diverges as @xmath135 in the small @xmath4 limit , where @xmath136 .    in ref .",
    "the jgm kernel was constructed to satisfy this divergence , based on a modified cp kernel introduced in ref .  .",
    "following their approach , starting from the unmodified cp kernel @xmath119 we introduce a simplified jgm ( jgms ) kernel @xmath137 for a system with a gap as @xmath138 .",
    "\\label{eq.jgms}\\ ] ] @xmath137 has many of the properties of the jgm kernel introduced in ref .  . for systems with a band gap ,",
    "the xc - kernel diverges as @xmath139 at small @xmath4 . for @xmath140",
    ", @xmath137 reduces to @xmath119 ( equation  [ eq.cp ] ) , while for @xmath141 @xmath142 , yielding a vanishing correlation energy .",
    "indeed the jgms kernel differs only from the jgm kernel in its behavior at large @xmath4 , with the jgm kernel correctly reproducing the @xmath95 limit of the heg for @xmath140 ( equation  [ eq.bigq ] ) ; concomitantly the jgm kernel has a diverging pair - distribution function . by introducing the jgms kernel we can study the effect of the @xmath139 divergence without any additional complications potentially arising from a badly - behaved pair - distribution function .",
    "the real - space form of the jgms kernel is @xmath143 . \\label{eq.jgmr}\\ ] ] equation  [ eq.jgmr ] and fig .",
    "[ fig.kernels](b ) emphasize a unique property of the jgms kernel : it is long range .",
    "as a result , at large @xmath100 the hartree - xc kernel does not reduce to the bare coulomb kernel but rather to an interaction weakened by a factor @xmath144 $ ] .",
    "evaluating the integral over @xmath6 in equation  [ eq.ec ] requires the @xmath2 kernel at an arbitrary coupling strength .",
    "we use the analysis of ref .   to link @xmath32 to the fully - interacting kernel through the relation @xmath145 the scaling of the density",
    "can be equivalently stated as @xmath146 or @xmath147 .",
    "the ( exchange - only ) ralda xc - kernel has the useful property that @xmath148 .    for the jgms kernel",
    ", we have an additional parameter @xmath132 . for simplicity",
    ", we employ a scaling @xmath149 equivalent to treating @xmath150 independent of @xmath151 .",
    "it is interesting to draw comparisons with rpa methods based on the concept of range - separation.@xcite first we trivially relabel the hartree - xc kernel as an effective interaction @xmath152 , i.e.  @xmath153 , noting from fig .",
    "[ fig.kernels](b ) that for most of the kernels @xmath152 goes to zero at @xmath154 and tends to the full coulomb interaction at large @xmath100 . now , specializing to a static model xc - kernel which scales linearly with coupling constant , @xmath155 , we can partition the correlation energy in equation  [ eq.ec ] into two contributions @xmath156 , with @xmath157     \\label{eq.ec_lr}\\ ] ] @xmath158 .",
    "\\label{eq.ec_sr}\\ ] ] equation  [ eq.ec_lr ] matches the rpa expression for the correlation energy ( equation  [ eq.ecrpa ] ) with @xmath8 replaced with @xmath159 . similarly , equation  [ eq.ec_sr ] matches the expression for the full correlation energy ( equation  [ eq.ec ] ) with @xmath8 replaced by @xmath160 , which is generally a short - ranged interaction .",
    "we can focus further on the specific example of the cp xc - kernel ( equation  [ eq.cp ] ) , noting that this kernel can be linearized in @xmath6 by neglecting the correlation contribution to @xmath70 in equation  [ eq.a ] .",
    "then , @xmath161 , with the `` range - separation parameter '' @xmath162 determined by the density through @xmath163 .",
    "this effective interaction is often found in the range - separated rpa@xcite with @xmath162 of order unity .",
    "we stress that equations  [ eq.ec_lr ]  and  [ eq.ec_sr ] are exact for any kernel which obeys @xmath155 .",
    "since most of the xc - kernels under study here do not obey this relation , we have not explored equations  [ eq.ec_lr ] and [ eq.ec_sr ] further in this work .",
    "however for xc - kernels linear in @xmath6 ( e.g.  the ralda ) there may be a computational advantage in calculating @xmath164 and @xmath165 separately .",
    "@xmath164 requires only @xmath28 and not @xmath15 , so for a given kernel it can be obtained at exactly the same cost as the rpa correlation energy .",
    "in fact since the effective interaction @xmath152 generally vanishes at large wavevectors , @xmath164 can be expected to avoid the basis - set convergence problems of the rpa recently highlighted in ref .  .",
    "meanwhile it may be possible to exploit the short - range character of @xmath2 to reduce the computational cost of calculating @xmath165 from equation  [ eq.ec_sr ] .",
    "a standard test of model heg kernels is to calculate the correlation energy per electron @xmath65 from equations  [ eq.ec ]  and  [ eq.chi_heg ] . for a given density @xmath166",
    ", @xmath65 can be resolved as an integral over @xmath4 as@xcite @xmath167 the quantity @xmath168 can be compared to the fourier transform of a suitable parameterization of the `` exact '' correlation hole obtained from monte carlo calculations.@xcite alternatively one can compute @xmath65 over a range of densities and compare to the parameterized result.@xcite these comparisons are made in figs .",
    "[ fig.kernels](c )  and(d ) respectively .",
    "the heg analysis has been performed a number of times@xcite so we only summarize the key points .",
    "the rpa correlation is too negative , while including any of the xc - kernels brings @xmath65 to within 0.1  ev of the exact result . considering the wavevector decomposition in fig .",
    "[ fig.kernels](c ) we find that the dynamical cpd kernel provides the best description of the correlation hole at this density ( @xmath169 ) , but below @xmath170 there is very little difference between any of the xc - kernels and the exact result . indeed",
    "the alda ( not shown ) also provides a good description of the correlation hole at these wavevectors . at larger wavevectors ,",
    "differences begin to emerge between the kernels , with the cp kernel becoming too negative , the cpd and cdops kernels closely following the exact result , and the other kernels too positive .",
    "the ralda kernels are abruptly cut off at @xmath171 , while the cdop kernel acquires a slowly - decaying positive contribution .",
    "the latter behavior is observed to a greater extent in the alda , and originates from the locality of the kernels.@xcite    over the full range of densities [ fig .",
    "[ fig.kernels](d ) ] , we find that the calculated correlation energy is slightly too positive with the cdop kernel and too negative with the cp and cdops kernels .",
    "interestingly , cdops is closer to the exact result than cdop , illustrating that removing the part of the cdop kernel which causes the pair - distribution function to diverge@xcite slightly improves the correlation energy .",
    "the ralda kernels fall closest to the exact result across a wide range of densities , and the cpd kernel also provides a good description of the correlation energy . comparing ralda and raldac",
    ", we see that removing the correlation contribution from @xmath70 in equation  [ eq.a ] decreases the correlation energy per electron by less than @xmath1720.02  ev across a range of densities .",
    "coupling - constant averaged pair - distribution function @xmath173 calculated at @xmath174 for the model heg xc - kernels ( see fig .",
    "[ fig.kernels ] for color code ) , compared to the `` exact '' parameterization given in equation ( 36 ) of ref .",
    "( see also ref .  ) .",
    "the inset shows the zoomed region around @xmath175 . ]    clearly all of the considered kernels greatly improve the correlation energy of the heg compared to the rpa .",
    "the common characteristics shared by the kernels are that they satisfy the exact @xmath60 , @xmath176 limit of the heg ( except the ralda , which neglects the correlation contribution in equation  [ eq.a ] ) , and that they decay for wavevectors above @xmath177 .",
    "this decay is essential to an accurate description of the energetics of the heg , with the alda ( which does not decay at large @xmath4 ) , yielding a correlation energy which is too positive.@xcite however the fact that we only observe small variations between the kernels considered in fig .  [ fig.kernels](d ) indicates that the precise form of this decay is less important .",
    "it is however interesting to consider the coupling - constant averaged pair - distribution function @xmath173,@xcite obtained as the fourier transform of @xmath168 multiplied by @xmath178$].@xcite the pair - distribution function @xmath179 is obtained from the derivative of @xmath173 with respect to @xmath166 , and the exact @xmath180 and @xmath181 both satisfy cusp conditions such that their slopes at @xmath182 are generally nonzero.@xcite concentrating on @xmath173 , we note that in order to describe a cusp in real space we require fourier components [ i.e.  nonzero @xmath168 ] at large @xmath4 . indeed the analysis of ref",
    ".   finds that a frequency - independent kernel must decay as @xmath184 , where @xmath185 , i.e.  the hartree - xc kernel retains a @xmath129 term at large @xmath4 . by considering fig .",
    "[ fig.kernels](a ) we see that the ralda , cp and cpd kernels all decay as @xmath186 such that their hartree - xc kernels vanish , so that @xmath168 also quickly tends to zero at large wavevectors",
    "[ fig.kernels](c ) ] .",
    "thus these kernels can not describe the cusp .    to illustrate this behavior , in fig .",
    "[ fig.gbar ] we plot @xmath173 calculated at @xmath187 for the different kernels , compared to the rpa and to the parameterization of refs .  .",
    "it is clear that the coupling - constant averaged pair - distribution functions calculated for the ralda , cp and cpd kernels are far softer than those calculated for the rpa and cdops , whose hartree - xc kernels decay @xmath3 .",
    "meanwhile as noted above the local @xmath72 term of the cdop kernel causes a divergence in @xmath173 .",
    "the slope of coupling - constant averaged pair - distribution function calculated in the rpa is too steep , while it is improved for cdops . in ref .",
    "it was also found that @xmath179 calculated for cdops agreed well with the exact result .",
    "the good performance of the cdops kernel for calculations of the pair - distribution function might have been anticipated from the fact that the coefficient @xmath71 appearing in equation  [ eq.cdop ] itself is determined from @xmath188.@xcite the above analysis illustrates how the precise large-@xmath4 behavior of a kernel affects its description of the cusp of @xmath179 , despite playing a lesser role in the calculation of energetics .      in order to calculate the correlation energy of an inhomogeneous system through equation  [ eq.ec ] we require @xmath2 evaluated in a plane - wave basis , which in general is constructed from the real - space kernel through @xmath189 where @xmath190 is the volume of the entire crystal , consisting of @xmath191 replicas of the unit cell of volume @xmath41 .",
    "the question is how to incorporate into this formalism a model ( @xmath192 ) kernel which has the form @xmath193 or @xmath194 . in the case",
    "that the system is homogeneous ( @xmath195 ) , we simply make the substitution @xmath196 to get a diagonal kernel , @xmath197 alternatively , if the model kernel is fully local ( independent of @xmath4 , e.g.   the alda ) , it is natural to choose the local density to construct the kernel , and obtain @xmath198 however for nonlocal kernels and inhomogeneous systems it is not obvious how one should construct @xmath199 , except for two requirements .",
    "first , an arbitrary model kernel should be symmetric in @xmath200 and @xmath201:@xcite @xmath202 second , for the jgms kernel , we require that in the @xmath203 limit the head of @xmath2 ( i.e.  @xmath204 diverges as @xmath205 while the wings ( @xmath206 = 0 ) diverge no faster than @xmath207 ( ref .  ) .",
    "as shown below , this second requirement turns out to exclude previous schemes used in acfd - dft calculations , which we now briefly review .",
    "a symmetric kernel can be obtained by making the following substitution into equation  [ eq.ft ] : @xmath208,|{\\mathbf{r}}-{\\mathbf{r'}}|,\\w ) .",
    "\\label{eq.denssym}\\ ] ] here , @xmath209 is a functional of the density symmetric in @xmath200 and @xmath201 , whose possible forms span a wide range of complexity.@xcite refs .  and   take a two - point average , @xmath210 = 1/2[n({\\mathbf{r } } ) + n({\\mathbf{r'}})]$ ] , which has an intuitive interpretation .",
    "a disadvantage of the symmetrization in equation  [ eq.denssym ] is that in order to evaluate equation  [ eq.ft ] , it is necessary to work with a real - space representation of the kernel and perform an integration over the entire volume of the crystal . for short - range kernels",
    "this integral can be converged by sampling over a number of unit cells,@xcite but for a long - range kernel like @xmath137 [ decaying as @xmath211 the required sampling might be prohibitively large . also , since the kernel is constructed in real space , it is not obvious how to control the @xmath207 divergences of the jgms kernel in reciprocal space",
    ". finally we note that the @xmath212 real - space divergence of the kernels leads to slow convergence with the real - space grid used to evaluate the integral in equation  [ eq.ft].@xcite      an alternative approach followed in ref .",
    "is to start from a nonsymmetric form of @xmath2 , which we label @xmath213 : @xmath214 inserting @xmath213 into equation  [ eq.ft ] gives @xmath215 a symmetric kernel can then be obtained by averaging @xmath216 with its hermitian conjugate , i.e.@xmath217^*\\right ) .",
    "\\label{eq.lu_av}\\ ] ] this procedure can be seen equivalently@xcite as inserting the symmetric combination @xmath218 $ ] into equation  [ eq.ft ] , and therefore corresponds to a two - point average of the kernel ; in the case that the kernel is linear in density , this scheme is equivalent to averaging the density .",
    "equation  [ eq.nonsymkern ] has the computational advantages that the integral is over a single unit cell and requires only that the density ( and not the kernel ) is represented on the real - space grid .",
    "however , considering the jgms xc - kernel , upon inserting equation  [ eq.jgms ] into equation  [ eq.nonsymkern ] and performing the average of equation  [ eq.lu_av ] we are left with a matrix whose wings diverge @xmath219 as @xmath220 , not @xmath207 as required .",
    "therefore equation  [ eq.lu_av ] is unsuitable for the current study .      in order to correctly deal with the jgms kernel while retaining some of the computational advantages of equation  [ eq.nonsymkern ]",
    ", we follow the approach of ref .   and symmetrize the wavevector appearing in the right hand side of equation  [ eq.nonsymkern ] with the substitution @xmath221 : @xmath222 like equation  [ eq.nonsymkern ] , equation  [ eq.kernel_ft ] requires the integral over the unit cell only and deals with the reciprocal - space form of the kernels .",
    "using equation  [ eq.kernel_ft ] to construct the jgms kernel yields a matrix whose head and wings diverge in the @xmath223 limit as @xmath205 or @xmath207 , as required , while the hermiticity of @xmath224 automatically satisfies the symmetry requirement ( equation  [ eq.rsymm ] ) .",
    "trivially , the averaging scheme will reproduce the equations  [ eq.homdens ] and  [ eq.localkernel ] when applied to systems with a homogeneous density or a local kernel , and furthermore the diagonal ( @xmath225 ) elements coincide with those calculated with the two - point average of the kernel , equation  [ eq.lu_av ] .    since this work is concerned with the comparison of a large number of kernels , we have elected to use equation  [ eq.kernel_ft ] on the grounds that it is relatively efficient , and can deal with the divergences in the jgms kernel correctly .",
    "however the physical interpretation of the off - diagonal elements arising from the wavevector - symmetrization is not transparent .",
    "although a two - point scheme also suffers from limitations ( e.g.  the two - point kernel has no knowledge of the medium lying between @xmath200 and @xmath201 ) , it still remains a more intuitive procedure .",
    "the fact that we have to invoke an averaging scheme at all is an undesirable consequence of using heg kernels to describe inhomogeneous systems . in reality",
    "the use of different schemes can only be justified through testing and comparison with experiments or other calculations , such as that performed in refs .   and here .",
    "all calculations in this work were performed using the ` gpaw ` code.@xcite the kohn - sham states and energies used to construct the response function ( equation  [ eq.chipw ] ) were calculated using the local - density approximation to dft@xcite within the projector - augmented wave ( paw ) framework.@xcite we used @xmath226 and @xmath227 unshifted monkhorst - pack@xcite meshes to sample the brillouin zone for insulators and metals respectively , and constructed the occupation factors for each kohn - sham state using a fermi - dirac distribution function of width 0.01  ev . for h , he and h@xmath1 we used a simulation cell of 6@xmath2286@xmath2287 @xmath229 and @xmath230-point sampling .",
    "when calculating @xmath18 the wavefunctions were expanded in a plane - wave basis set up to a maximum kinetic energy of 600  ev . following previous studies,@xcite we used the frozen - core approximation but included semicore states for some elements.@xcite we note that norm - conservation was not enforced in the generation of our paw potentials , while it is reported in ref .   that including norm - conservation might increase the magnitude of the rpa correlation energy and decrease the calculated lattice constants for certain materials . as a result",
    "some care should be taken in making comparisons to experiment , although we expect calculations including the xc - kernel to be less sensitive to this convergence issue ( section  [ sec.rangerpa ] ) .",
    "for the matrices representing the response function and kernel , we used a lower plane - wave cutoff @xmath231 of 400  ev ( 300  ev for na and h@xmath1 ) , and a @xmath22 grid matching the brillouin zone sampling of the ground - state calculation .",
    "we truncated the sum - over - states appearing in equation  [ eq.chipw ] at a number of bands equal to the number of plane waves describing the response function , e.g.  @xmath172700 for si . within this approximation ,",
    "the following extrapolation scheme is commonly used for the rpa correlation energy:@xcite @xmath232     the correlation energy @xmath18 evaluated per electron for mgo at a lattice constant of 4.23   , using different approximations for the xc - kernel ( see fig .  [ fig.kernels ] for the color code ) .",
    "@xmath231 is the plane - wave cutoff used for the matrices representing the response function and xc - kernel .",
    "the circles represent calculated data points , and the lines are fits from equation  [ eq.extrap ] . ]    in ref .",
    "it was proposed that the same expression can be applied to the correlation energy calculated with the ralda kernel .",
    "we have tested this expression for each of the kernels in section  [ sec.kernelzoo ] for a set of 10 materials ( see section  [ sec.lattice ] ) . as an example , in fig .",
    "[ fig.mgo ] we plot the correlation energy per electron calculated for mgo as a function of @xmath233 .",
    "as demonstrated by the straight lines , equation  [ eq.extrap ] apparently gives a good description of the correlation energy calculated for @xmath234200  ev for all of the kernels .",
    "we have observed the same behavior across the combinations of materials and kernels .",
    "therefore in order to facilitate comparison across the entire test set we will apply equation  [ eq.extrap ] for all xc - kernels . we point out that the correlation energy tends to converge faster ( shallower lines in fig .",
    "[ fig.mgo ] ) when a nonzero @xmath2 is used , and for calculating structural properties the extrapolation is often unnecessary .",
    "constructing the xc - kernel with equation  [ eq.kernel_ft ] is not straightforward due to the dual dependence on @xmath20 and @xmath21 .",
    "our current implementation distributes the rows of the @xmath2 matrix among processors before evaluating the integral in equation  [ eq.kernel_ft ] . in the future",
    "it may be appropriate to improve performance through an interpolation scheme , as for refs .  and  .",
    "on the other hand , for the systems studied here the time taken to construct the kernel is small compared to that spent constructing the response function @xmath28 and inverting equation  [ eq.chi_ks ] .",
    "when constructing the kernel , we use the paw all - electron density to be consistent with previous work.@xcite the @xmath205 divergence of the coulomb interaction and jgms kernel was treated within the scheme described in ref .  .",
    "having obtained @xmath15 we evaluated equation  [ eq.ec ] by numerical ( gauss - legendre ) integration over the coupling constant ( @xmath235 points ) and frequency ( @xmath236 points , using a logarithmic mesh).@xcite by virtue of the scaling relation ( equation  [ eq.scaling ] ) we must construct the ralda kernel once , a general static kernel @xmath237 times and a dynamical kernel @xmath238 times ; hence there is a prefactor of @xmath239 applied to computing @xmath127 compared to @xmath90 .    to calculate structural properties",
    ", we evaluated the total energy @xmath240 for seven lattice constants centered around the experimental value and fit the values to the birch - murnaghan equation of state.@xcite we used higher plane - wave cutoffs of 800  ev ( 900 ev for mgo , licl and lif ) to evaluate the lda energies and @xmath17 , and used a denser sampling of the brillouin zone combined with the wigner - seitz truncation scheme described in ref .   to calculate @xmath17 .",
    "we typically obtain converged exchange energies for insulators with a sampling of @xmath241 , while metals require a denser sampling@xcite ( e.g.  @xmath242 ) .",
    "since the bulk modulus is constructed from derivatives of the energy , it is rather prone to numerical error , to the extent that different code implementations of the same method can yield different results.@xcite in this respect one should attach more significance to the calculated lattice constants than bulk moduli , since the former are more robust quantities .",
    "however even for the bulk moduli one expects a reduction in error when comparing different xc - kernels within the same computational framework .",
    "we have selected a test set of 10 materials , consisting of 3 tetrahedrally - bonded semiconductors ( diamond c , si and sic ) , 3 ionic compounds ( mgo , licl and lif ) and 4 metals ( al , na , cu and pd ) . for each material",
    ", we used the xc - kernels introduced in section  [ sec.kernelzoo ] to calculate the lattice constant and bulk modulus .",
    "here we compare these results to those obtained from dft ( in the lda or from the generalized - gradient pbe functional@xcite ) , the rpa , and to the experimental values tabulated in ref .  .",
    "figure  [ fig.materials ] shows the lattice constants and bulk moduli calculated for c , mgo and al as a function of @xmath233 , a quantity inversely proportional to the number of plane - waves describing the response function @xmath28 and xc - kernel @xmath2 ( c.f .",
    "[ fig.mgo ] ) .",
    "the quantities at @xmath243 were calculated from @xmath18 extrapolated to infinite @xmath231 using equation  [ eq.extrap ] .",
    "we also show the values obtained from the lda and experiment as horizontal lines .",
    "there are three key observations to be made from fig .",
    "[ fig.materials ] .",
    "first , for non - metallic systems the ralda , raldac , cdops and cp kernels yield almost identical results , which in turn are very similar to the rpa .",
    "second , the jgms , cpd and the cdop kernels ( which respectively are long - range , dynamical or have a local term ) display distinct behavior . for instance the jgms kernel predicts smaller lattice constants and larger bulk moduli than the other xc - kernels .",
    "finally , all of the xc - kernels show faster convergence with respect to @xmath231 compared to the rpa , as found for the correlation energy ( fig .",
    "[ fig.mgo ] ) . keeping the above points in mind",
    ", we extend this analysis to the full test set and consider each kernel in turn .",
    "the entire dataset is given in fig .",
    "[ fig.latt_bm ] and table  [ tab.latt_bm ] .",
    "lccccccccccccc & lda & lda & pbe & rpa & rpa & ralda & raldac & cdop & cdops & cp & cpd & jgms & exp .",
    "+ c & 3.533 & 3.534&3.573&3.566&3.572 & 3.563 & 3.562 & 3.561 & 3.565 & 3.562 & 3.553 & 3.550 & 3.553 + si & 5.407 & 5.404&5.477&5.449&5.432 & 5.456 & 5.453 & 5.446 & 5.452 & 5.454 & 5.450 & 5.437 & 5.421 + sic & 4.338 & 4.332&4.390&4.380&4.365 & 4.380 & 4.379 & 4.374 & 4.379 & 4.378 & 4.371 & 4.361 & 4.346 + mgo & 4.163 & 4.169&4.255&4.229&4.225 & 4.229 & 4.228 & 4.224 & 4.231 & 4.228 & 4.222 & 4.202 & 4.189 + licl & 4.972 & 4.967&5.157&5.082&5.074 & 5.099 & 5.097 & 5.069 & 5.094 & 5.093 & 5.095 & 4.996 & 5.070 + lif & 3.926 & 3.913&4.080&4.010&3.998 & 4.011 & 4.011 & 3.989 & 4.013 & 4.010 & 4.007 & 3.978 &",
    "3.972 + al & 3.987 & 3.983&4.044&4.042&4.037 & 4.053 & 4.051 & 4.041 & 4.048 & 4.050 & 4.051 & 4.050 & 4.018 + na & 4.054 & 4.056&4.197&4.205&4.182 & 4.229 & 4.225 & 4.221 & 4.233 & 4.232 & 4.257 & 4.232 & 4.214 + cu & 3.530 & 3.523&3.643&3.622&3.597 & 3.612 & 3.616 & 3.622 & 3.625 & 3.625 & 3.626 & 3.625 & 3.595 + pd & 3.839 & 3.830&3.941&3.914&3.896 & 3.919 & 3.918 & 3.916 & 3.920 & 3.920 & 3.918 & 3.920 & 3.876 + % m.a.e . &",
    "1.2 & 1.3 & 1.3 & 0.6 & 0.5 & 0.7 & 0.7 & 0.5 & 0.7 & 0.7 & 0.7 & 0.6 &  +    [ cols=\"<,^,^,^,^,^,^,^,^,^,^,^,^,^\",options=\"header \" , ]     it is important to establish the importance of the value of @xmath132 . in the current work",
    "we have used the experimental , direct gap ( table  [ tab.jgm ] ) , but we equally could have chosen the indirect gap , or even defined a more general @xmath200-dependent gap function.@xcite an alternative option is to make the link to the description of excitons@xcite and consider the head ( @xmath204 of @xmath137 in the @xmath244 limit , which can be written as @xmath245 where @xmath246 } \\right ] .",
    "\\label{eq.alpha}\\ ] ] the values of @xmath247 computed from equation  [ eq.alpha ] for the experimental gaps are given in table  [ tab.jgm ] .",
    "these values can be compared to ref .  , where a long - range ( lrc ) attractive kernel was introduced as @xmath248 .",
    "we note that the head of this matrix in reciprocal space in the @xmath220 limit coincides with the jgms kernel with @xmath249 , and also that this single matrix element is considered the most important for the calculation of excitonic effects.@xcite from table  [ tab.jgm ] it is clear that the values of @xmath250 calculated with the experimental gaps and paw densities are somewhat larger than the values of @xmath251 reported in ref .  , which were found to give a good description of excitonic effects in absorption spectra of semiconductors and mgo .",
    "to explore this point further we adopted an inverse approach and considered an effective gap @xmath252 , which when inserted into equation  [ eq.alpha ] yields @xmath251 .",
    "these lrc `` gaps '' are smaller than experimental values , especially for the ionic compounds .",
    "indeed the empirical @xmath251 values of licl and lif are significantly smaller than those expected both from the jgm or bootstrap kernels,@xcite which have been shown to accurately capture the exciton in lif .",
    "percentage deviations of lattice constants compared to experiment,@xcite calculated with the rpa , and the jgms kernel using the experimental direct band gaps or effective lrc gaps ( see table  [ tab.jgm ] ) .",
    ", width=188 ]    we repeated the jgms kernel calculations using the lrc gaps @xmath252 , and show the obtained lattice constants in fig .",
    "[ fig.lrc ] .",
    "the lrc results lie between the lattice constants calculated with the rpa and with the jgms kernel / experimental gaps , and thus improve the licl result .",
    "comparison of licl and lif demonstrates the nonlinear relation between @xmath252 and the lattice constant . in both cases the effective gap",
    "is reduced by more than 50% from its experimental value , but the effect on the licl lattice constant is an order of magnitude larger than for lif .",
    "the improved agreement of lattice constants with experiment compared to the rpa shows that xc - kernels with long - range components represent an interesting avenue to study .",
    "a key question is whether the tendency for the jgms kernel to favor smaller lattice constants than the rpa is directly related to the fundamental long - range character of the former , or whether it is in fact a consequence of the precise form of the kernel .",
    "the strength of the long - range part of the jgms hartree - xc kernel is determined by @xmath253 ( equation  [ eq.jgms ] ) , which becomes rpa - like in the high density limit and vanishes in the low density limit .",
    "the rpa correlation energy is generally negative , while a zero @xmath97 implies a zero correlation energy .",
    "interpolating these two limits implies that a more negative ( i.e.  stable ) jgms correlation energy will correspond to a higher density , thus favoring a lower lattice constant .",
    "this observation also provides an explanation for the varying behavior of the bulk modulus and also the strong nonlinearity in the variation of the lattice constant with band gap , since the energy - volume relation is expected to be sensitive to the relative magnitude of @xmath132 and @xmath26 .",
    "we note that the bootstrap approach@xcite is an alternative method of constructing a long - range kernel .",
    "since the bootstrap kernel is constructed from @xmath28 , using it would avoid both the input of @xmath132 and the averaging procedures discussed in section  [ sec.averaging ] .",
    "however , it would be necessary to ensure that the bootstrap kernel displayed reasonable behavior in the large @xmath4-limit .          in fig .",
    "[ fig.corr_energies ] we show the absolute correlation energy per electron calculated using each of the different kernels for the materials in the test set .",
    "absolute correlation energies are generally considered less robust than properties constructed from energy differences , being more difficult to converge and sensitive to details of the paw potentials .",
    "however one can still perform a comparison between kernels , and look for similarities with the trends observed for the heg [ fig .",
    "[ fig.kernels](d ) ] .    the most obvious feature of fig .",
    "[ fig.corr_energies ] is the reduction of absolute correlation energy on moving from the rpa to a nonzero @xmath2 , ranging from 0.1  ev for na to 0.5  ev for si .",
    "this change is the same order of magnitude as observed for the heg .",
    "the ordering of the heg correlation energy calculated with different kernels is also largely preserved , with the cp and cdops kernels predicting larger magnitudes than cdop and the ralda kernels .",
    "the difference between the ralda and raldac kernels is small , with the ralda correlation energy being more negative by order 1% or 0.01 ev per electron .",
    "the difference between the static and dynamical forms of the cp kernel is an order of magnitude larger , with the static correlation energy being more negative .",
    "meanwhile the removal of the local term in the cdop kernel increases the magnitude of the correlation energy , with the cdops having a more negative correlation energy than cdop by 5% or 0.05  ev per electron .    as in ref .",
    "we can tentatively compare our calculated correlation energy for si with the diffusion monte carlo ( dmc ) calculations of ref .  .",
    "reassuringly the dmc correlation energy lies among the values calculated with the model exchange kernels ( fig .  [ fig.corr_energies ] ) , in fact displaying closest agreement with cpd , ralda and cdop kernels .",
    "we also note that our calculated cdop correlation energy for si ( -1.02  ev per electron ) lies on top of the value recently reported in ref .   using a pseudopotential approximation and a different averaging scheme ( equation  [ eq.lu_av ] ) . with highly - accurate calculations of correlation energies in extended systems",
    "now becoming a reality,@xcite comparisons of this sort should become a useful test for new kernels .",
    "it is interesting to compare the structural properties and correlation energies calculated using the symmetrized - wavevector averaging scheme ( equation  [ eq.kernel_ft ] ) to the two - point symmetrized density ( equation  [ eq.denssym ] ) .",
    "the latter has previously been implemented for the ralda,@xcite so here we restrict the comparison to this kernel .",
    "considering the lattice constants first , we typically find a difference of 0.2% between the two methods , with the symmetrized - density values larger than those calculated with the symmetrized - wavevector in most cases .",
    "interestingly the agreement is worse for the bulk moduli , with an average deviation of 6% .",
    "the absolute correlation energies also show a larger ( 4% ) deviation , where using the two - point symmetrized density scheme consistently yields more negative ralda correlation energies than the symmetrized - wavevector scheme , by an average of 0.04  ev per electron .    to understand the origin of these differences it is necessary to consider the practical implementation of the two - point density average ( equation  [ eq.denssym ] ) .",
    "as mentioned in section  [ sec.averaging ] , constructing the kernel in this way involves sampling the @xmath212 coulomb interaction in real space .",
    "the divergence at @xmath182 is replaced with a spherical average of @xmath212 taken over the volume per point in the real - space grid used to evaluate the integral .",
    "@xcite the absolute correlation energy is therefore rather sensitive to this grid spacing , and its dependence on volume ( i.e.  the bulk modulus ) will also be difficult to converge .",
    "the symmetrized - wavevector approach only samples the density on the real space grid , and therefore shows a much weaker dependence on the spacing between the grid points .",
    "we verified this behavior for diamond c , where the symmetrized - wavevector correlation energy changes by less than @xmath254 ev / electron on reducing the grid spacing from 0.17 to 0.11   .",
    "this is several orders of magnitude faster than the symmetrized - density approach,@xcite illustrating a computational advantage of equation  [ eq.kernel_ft ] .",
    "lrrrrr & rpa & ralda & ralda & ccsd & exp + h & -0.57 & 0.06 & -0.02 & 0.00 &  + h@xmath1 & -2.22 & -1.04 & -1.22 & -1.11 &  + he & -1.82 & -1.00 & -1.08 & -1.14 &  + @xmath256(h@xmath1 ) & 4.74 & 4.82 & 4.85 & 4.75 & 4.75 +    throughout this study we have not considered any spin - dependence of the xc - kernels . however , the calculation of atomization or cohesive energies usually requires the description of spin - polarized atoms or molecules . in this section",
    "we provide a demonstration of the importance of spin by calculating the atomization energy of the h@xmath1 molecule with the ralda kernel .",
    "first , we note that the symmetrized - wavevector averaging procedure ( equation  [ eq.kernel_ft ] ) can be equally applied to extended and finite systems .",
    "in fact , for the ralda kernel one can exploit the fact that the hartree - xc kernel strictly vanishes at any points in space where the density is less than @xmath257 .",
    "therefore the fourier transform can be performed in a small box which excludes the vacuum region generally required to model isolated systems with periodic boundary conditions .",
    "since the h@xmath1 molecule is spin - unpolarized we can calculate its correlation energy without any further consideration , and obtain a value of -1.04  ev with the ralda kernel .",
    "this value is within 0.1  ev of the value obtained from coupled - cluster calculations@xcite and a significant improvement ( @xmath2581  ev ) over the rpa .",
    "we find a similar level of agreement for the he atom ( table  [ tab.h2 ] ) .    for the spin - polarized h atom , following the analysis of ref .",
    "we replace the integral equation ( equation  [ eq.chi_ks ] ) with its the spin - polarized version , valid for systems where only one spin channel is occupied : @xmath259 the above quantities are related to equation  [ eq.ec ] through the simple substitutions @xmath260 and @xmath261 .",
    "proceeding further requires the spin - polarized form of the hartree - xc kernel @xmath262 . to our knowledge , of the xc - kernels studied in this work",
    "@xmath263 has been derived only for the ralda , given as:@xcite @xmath264 \\label{eq.ralda_spin}\\ ] ] equation  [ eq.ralda_spin ] differs from the spin - unpolarized ralda expression ( equation  [ eq.ralda ] ) by a factor of two in front of the part of the kernel corresponding to the alda , reflecting the fact that the exchange interaction acts only between electrons with the same spin . using equations  [ eq.hspin ]  and  [ eq.ralda_spin ] to calculate the correlation energy of the h atom yields a value of 0.06  ev , compared to the exact value of zero and an rpa value of -0.57  ev .",
    "taking the h and h@xmath1 calculations together yields an ralda atomization energy of 4.82  ev , which is within 0.1  ev of the experimental value of 4.75  ev.@xcite we note that the rpa benefits from substantial error cancellation and yields an atomization energy very close to experiment ( 4.74  ev , table  [ tab.h2 ] ) .",
    "however the h@xmath1 molecule is a rather special case , and the rpa usually demonstrates percentage errors of order 10% in atomization energies.@xcite the ralda kernel corrects the correlation energies of the individual h@xmath1 and h systems and maintains close agreement with the experimental atomization energy .    in table",
    "[ tab.h2 ] we also present the ralda correlation energies using the two - point density average , equation  [ eq.denssym ] . as found in bulk systems , the correlation energies calculated with the two - point density average are more negative ( @xmath265  ev / electron ) than those calculated with the symmetrized wavevector .",
    "however the agreement in atomization energies is better than 0.03  ev .",
    "we find it encouraging that the symmetrized - wavevector approach gives such similar results to the more intuitive two - point density average when calculating the atomization energy .",
    "we note that if we do not use the spin - polarized form of the kernel ( equation  [ eq.ralda_spin ] ) , we find a correlation energy of -0.17  ev for the h atom and an atomization energy of 4.37  ev .",
    "this value is in significantly worse agreement with experiment than the rpa or even the lda ( 4.89  ev ) , emphasizing the importance of a rigorous treatment of spin .",
    "an important direction for further study is the introduction of spin - dependence into kernels derived from the spin - unpolarized heg .",
    "we have calculated the correlation energy of a test set of 10 materials within the adiabatic - connection fluctuation - dissipation formulation of density - functional theory ( acfd - dft ) .",
    "we used a hierarchy of approximations for the exchange - correlation ( xc ) kernel @xmath2 , including the random phase approximation ( rpa , @xmath266 ) , the recently - introduced renormalized kernels ( ralda),@xcite a kernel which satisfies the exact static limits of the electron gas ( cdop),@xcite a model dynamical kernel ( cpd)@xcite and a kernel which diverges @xmath3 in the small-@xmath4 limit ( jgms).@xcite in order to apply homogeneous kernels to inhomogeneous systems we applied a reciprocal space averaging scheme employing wavevector symmetrization.@xcite for each kernel and material pair we calculated the lattice constant and bulk modulus , and compared our results to previous calculations and experiment.@xcite for all materials , including a nonzero @xmath2 reduces the magnitude of the correlation energy compared to the rpa by 0.10.5  ev per electron .",
    "this result mirrors the homogeneous electron gas ( heg ) , where the rpa correlation energy is too negative by at least 0.3  ev over a wide range of densities.@xcite however the variation in correlation energy between each @xmath2 is much smaller , on the scale of 0.010.1  ev per electron .",
    "encouragingly the correlation energies calculated with xc - kernels are found to lie very close to diffusion monte carlo data available for si.@xcite furthermore , calculations with xc - kernels display faster basis - set convergence than the rpa due to the suppression of high energy plane - wave components of the coulomb potential .",
    "considering lattice constants and bulk moduli , we found only small variations between the rpa and different xc - kernels .",
    "in particular , static xc - kernels that only satisfy the @xmath115 , @xmath95 limit of the heg ( ralda , cp , cdops ) produce very similar results .",
    "the structural properties calculated with the dynamical cpd kernel are in better agreement with experiment in some cases ( e.g.  the bulk moduli of non - metallic systems ) , but the improvement is not systematic ( e.g.  na ) . satisfying the @xmath107 , @xmath95 limit of the heg ( which adds a local term to @xmath2 , e.g.  the cdop kernel ) also yields good agreement with experimental lattice constants , despite the kernel having a diverging pair - distribution function.@xcite finally , the jgms kernel predicts a reduction in lattice constants and an increase in bulk moduli for non - metallic systems , bringing the former into closer agreement with experiment . the current study however can not distinguish whether this behavior is due to the general long - range @xmath267 character of the kernel,@xcite or to the density - dependence of @xmath268 specific to the jgms model.@xcite",
    "the acfd - dft scheme described here clearly involves a number of choices , including ( a ) the approximation used to generate the noninteracting response function @xmath28 , ( b ) the form of @xmath2 ( including spin - dependence ) and ( c ) the averaging scheme used to generalize a heg xc - kernel to an inhomogeneous system .",
    "fixing all factors except ( b ) , as we have done here , points us towards the essential properties of a model @xmath2 .",
    "based on the similar performance of the different xc - kernels , the current work supports the idea that @xmath2 should be kept as simple as possible , i.e.  be static , tend to a density - dependent constant at small @xmath4 and decay @xmath3 at large @xmath4 . in this respect",
    "the exchange - only ralda kernel is attractive , since it scales simply with the coupling constant @xmath6 and has good convergence properties .",
    "the introduction of additional computational expense and uncertainty associated with a dynamical kernel , a divergence @xmath269 at @xmath78 or even a local term in @xmath2 is difficult to justify based on the performance of the cpd , jgms and cdop kernels for lattice constants and bulk moduli , although each kernel was found to offer improved agreement with experiment in certain cases .",
    "on the other hand , by focusing on the structural properties of bulk solids we have chosen systems where the rpa already performs very well .",
    "it is encouraging that the model xc - kernels can maintain this good performance whilst correcting the magnitude of the correlation energy by several ev per atom , but arguably their real test lies in cases where the rpa is less successful .",
    "already the ralda kernel has been found to improve the description of atomization and cohesive energies@xcite but a number of challenges remain , particularly in the description of molecular dissociation.@xcite the framework described in the current study provides the base for the application of a full range of kernels to these more challenging systems .",
    "we thank t.  olsen and j.j .",
    "mortensen for useful advice and discussions , and d.  lu for helpful correspondence .",
    "the authors acknowledge support from the danish council for independent research s sapere aude program , grant no .",
    "11 - 1051390 .",
    "104ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]",
    " + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty link:\\doibase 10.1103/physrev.136.b864 [ * * , ( ) ] link:\\doibase 10.1103/physrev.140.a1133 [ * * , ( ) ] \\doibase http://dx.doi.org/10.1063/1.4869598 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.15.2884 [ * * , ( ) ] link:\\doibase 10.1103/physrevb.13.4274 [ * * ,   ( ) ] link:\\doibase    10.1007/s10853 - 012 - 6570 - 4 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.96.136404 [ * * ,   ( ) ] \\doibase http://dx.doi.org/10.1063/1.3569483 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.106.093001 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.15.5512 [ * * , ( ) ] \\doibase    http://dx.doi.org/10.1063/1.3317437 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.68.032507 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.52.997 [ * * , ( ) ] link:\\doibase 10.1103/physrevlett.76.1212 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.61.13431 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.75.245127 [ * * ,   ( ) ]",
    "link:\\doibase    10.1103/physrevb.57.14569 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.50.8170 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.63.045116 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.67.045101 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.62.10038 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.70.205107 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.83.075116 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevb.84.045126 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.74.045121 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.78.115107 [ * * , ( ) ] \\doibase http://dx.doi.org/10.1063/1.1884112 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.85.062504 [ * * ,   ( ) ] \\doibase http://dx.doi.org/10.1063/1.4867538 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.86.081103 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.88.115131 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.112.203001 [ * * ,   ( ) ] link:\\doibase 10.1103/revmodphys.54.1017 [ * * ,   ( ) ] in  @noop _ _ ,  ( ,  )  pp .",
    "link:\\doibase 10.1103/physrevlett.55.2850 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.54.8540 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.56.12811 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.87.205143 [ * * ,   ( ) ] in  link:\\doibase 10.1007/3 - 540 - 35426 - 3_28 [ _ _ ] ,  , vol .  ,",
    "( ,  )  pp .",
    "@noop _ _  ( , ) link:\\doibase 10.1103/physrevb.83.245122 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.64.195120 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.65.235109 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.102.206411 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.79.205114 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.81.115126 [ * * ,   ( ) ] link:\\doibase 10.1038/nmat2806 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.107.156401 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.87.075111 [ * * ,   ( ) ] in  \\doibase    http://dx.doi.org/10.1016/s0081-1947(08)60615-3[__ ] ,  vol .  ,  ( ,  )  pp .   link:\\doibase 10.1103/physrevb.34.5390 [ * * , ( ) ] link:\\doibase 10.1103/physrevb.37.10159 [ * * ,   ( ) ] link:\\doibase 10.1088/0953 - 8984/10/41/007 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.90.045138 [ * * ,   ( ) ] \\doibase http://dx.doi.org/10.1063/1.4863502 [ * * ,   ( ) ] @noop @noop _ _  ( ,  ) link:\\doibase 10.1103/physrevb.48.11602 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.10.3052 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.38.6445 [ * * , ( ) ] link:\\doibase 10.1103/physrevb.72.035117 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.50.1391 [ * * , ( ) ] link:\\doibase 10.1103/physrevb.45.13244 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.75.689 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.7.1648 [ * * , ( ) ] link:\\doibase 10.1103/physrevb.1.1044 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.46.12947 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.56.7018 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.45.566 [ * * , ( ) ] link:\\doibase 10.1103/physrevb.69.155112 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.107.186401 [ * * , ( ) ] link:\\doibase 10.1103/physrevb.68.205112 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.25.6310 [ * * , ( ) ] link:\\doibase 10.1103/physrev.128.2093 [ * * , ( ) ] link:\\doibase 10.1103/physrevlett.102.096404 [ * * ,   ( ) ] \\doibase http://dx.doi.org/10.1063/1.3090814 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.108.256403 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.90.075125 [ * * ,   ( ) ] in  link:\\doibase 10.1007/3 - 540 - 35426 - 3_11 [ _ _ ] ,  , vol .  ,  ( ,  )  pp .   link:\\doibase 10.1103/physreva.54.1897 [ * * ,   ( ) ] link:\\doibase 10.1021/ct300325 t [ * * ,   ( ) ] @noop * * , ( ) link:\\doibase 10.1103/physrevb.50.17953 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.13.5188 [ * * , ( ) ]",
    "@noop link:\\doibase 10.1103/physrevlett.103.096102 [ * * ,   ( ) ] link:\\doibase 10.1103/physrev.71.809 [ * * , ( ) ] link:\\doibase 10.1103/physrevb.87.165122 [ * * , ( ) ] link:\\doibase 10.1007/s00894 - 012 - 1646 - 2 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.77.3865 [ * * ,   ( ) ] @noop _ _ ( ,  ) link:\\doibase 10.1103/physrev.161.730 [ * * , ( ) ] link:\\doibase 10.1103/physrevb.1.2668 [ * * ,   ( ) ] link:\\doibase 10.1103/physrev.187.1041 [ * * , ( ) ] \\doibase http://dx.doi.org/10.1016/0038-1098(73)90754-0 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevb.2.2126 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.13.5530 [ * * , ( ) ] link:\\doibase 10.1021/ct500073b [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.57.8972 [ * * ,   ( ) ] link:\\doibase    10.1038/nature11770 [ * * ,   ( ) ] \\doibase http://dx.doi.org/10.1063/1.481718 [ * * , ( ) ] \\doibase http://dx.doi.org/10.1063/1.2348881 [ * * , ( ) ] link:\\doibase 10.1103/physreva.85.042507 [ * * ,   ( ) ] link:\\doibase 10.1080/00268976.2010.507227 [ * * ,   ( ) ]"
  ],
  "abstract_text": [
    "<S> we present calculations of the correlation energies of crystalline solids and isolated systems within the adiabatic - connection fluctuation - dissipation formulation of density - functional theory . </S>",
    "<S> we perform a quantitative comparison of a set of model exchange - correlation kernels originally derived for the homogeneous electron gas ( heg ) , including the recently - introduced renormalized adiabatic local - density approximation ( ralda ) and also kernels which ( a ) satisfy known exact limits of the heg , ( b ) carry a frequency dependence or ( c ) display a 1/@xmath0 divergence for small wavevectors . </S>",
    "<S> after generalizing the kernels to inhomogeneous systems through a reciprocal - space averaging procedure , we calculate the lattice constants and bulk moduli of a test set of 10 solids consisting of tetrahedrally - bonded semiconductors ( c , si , sic ) , ionic compounds ( mgo , licl , lif ) and metals ( al , na , cu , pd ) . we also consider the atomization energy of the h@xmath1 molecule . we compare the results calculated with different kernels to those obtained from the random - phase approximation ( rpa ) and to experimental measurements . </S>",
    "<S> we demonstrate that the model kernels correct the rpa s tendency to overestimate the magnitude of the correlation energy whilst maintaining a high - accuracy description of structural properties .    </S>"
  ]
}