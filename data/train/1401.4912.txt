{
  "article_text": [
    "in  @xcite , the authors showed that for two - dimensional ( 2d ) ising models , at low temperature monte carlo methods mix much faster on the dual forney factor graph than on the original factor graph .",
    "monte carlo methods on the dual factor graph were also proposed in  @xcite to estimate of the partition function of 2d ising models ( with constant or with spatially varying couplings ) in the absence of an external magnetic field .    in the absence of an external field ,",
    "the exact value of the partition function of 2d ising models with constant coupling was first calculated by onsager  @xcite ,  ( * ? ? ?",
    "* chapter 7 ) .",
    "however , the 2d ising model in an arbitrary non - zero external field and the three - dimensional ( 3d ) ising model have remained unsolved  @xcite .    in general , quantities of interest in statistical physics , e.g. , the partition function and the mean magnetization of 2d models , can be estimated using markov chain monte carlo methods  @xcite . at low temperatures ,",
    "however , monte carlo methods usually suffer from critical slowing down .",
    "it is well known that at a certain critical temperature , the 2d ferromagnetic ising model undergoes a phase transition ; below this temperature , variables ( spins ) have long - range dependencies and monte carlo methods ( based on single spin - flips ) do not mix rapidly  @xcite .",
    "we propose an importance sampling algorithm  @xcite which can be used to compute the partition function of models with pairwise interactions . in this paper , we are mainly concerned with computing the partition function of finite - size 2d ferromagnetic ising models and @xmath0-state potts models  @xcite , when the models are under the influence of an external field . in our numerical experiments , we will also consider 3d ferromagnetic ising models .",
    "the importance sampling scheme operates on the dual of the forney factor graphs representing the models .",
    "our numerical results show that the scheme performs well in a wide range of model parameters .",
    "it must be emphasized that , unlike well - known algorithms , e.g. , gibbs sampling  @xcite and the swendsen - wang algorithm  @xcite , the proposed scheme does not suggest a method to draw samples according to the boltzmann distribution on factor graphs , as sampling is done in the dual domain .    the rest of the paper is organized as follows . in section  [ sec : ising ] , we review the ising model and graphical model representations in terms of forney factor graphs . dual forney factor graphs and the normal factor graph duality theorem are discussed in section  [ sec : nfgd ] .",
    "the importance sampling algorithm on the dual forney factor graph is described in section  [ sec : is ] . in section  [ sec : potts ] , we briefly discuss generalizations to the @xmath0-state potts model .",
    "numerical experiments are reported in section  [ sec : num ] .",
    "let @xmath1 be random variables arranged on the sites of a 2d lattice , as illustrated in fig .",
    "[ fig:2dgrid ] , where interaction is restricted to adjacent ( nearest - neighbor ) variables .",
    "suppose each random variable takes values in a finite alphabet @xmath2 .",
    "let @xmath3 represent a possible realization of @xmath4 , let @xmath5 stand for a configuration @xmath6 , and let @xmath7 stand for @xmath8 .",
    "we start with the 2d ising model , generalizations to the @xmath0-state potts model are deferred to section  [ sec : potts ] . in a 2d ising model , @xmath9 and the hamiltonian",
    "is defined as  @xcite @xmath10 - [ x_k \\ne x_{\\ell}]\\big)\\\\   - \\sum_{m = 1}^n h_m\\cdot\\big([x_m = 1 ] - [ x_m = 0]\\big)\\end{gathered}\\ ] ] where the set @xmath11 contains all the unordered pairs ( bonds ) @xmath12 with non - zero interactions and @xmath13 $ ] denotes the iverson bracket  @xcite , which evaluates to @xmath14 if the condition in the bracket is satisfied and to @xmath15 otherwise .",
    "the real coupling parameter @xmath16 controls the strength of the interaction between adjacent variables @xmath17 .",
    "the real parameter @xmath18 corresponds to the presence of an external magnetic field and controls the strength of the interaction between @xmath19 and the field .",
    "( 81,66)(0,0 ) ( 0,60)(4,4)@xmath20 ( 4,60)(4,-3)4 ( 8,54)(3,3 ) ( 4,62)(1,0)8 ( 8,63)(0,0)[bc]@xmath21 ( 12,60)(4,4 ) ( 16,62)(1,0)8 ( 24,60)(4,4)@xmath20 ( 28,60)(4,-3)4 ( 32,54)(3,3 ) ( 28,62)(1,0)8 ( 32,63)(0,0)[bc]@xmath22 ( 36,60)(4,4 ) ( 40,62)(1,0)8 ( 48,60)(4,4)@xmath20 ( 52,60)(4,-3)4 ( 56,54)(3,3 ) ( 52,62)(1,0)8 ( 56,63)(0,0)[bc]@xmath23 ( 60,60)(4,4 ) ( 64,62)(1,0)8 ( 72,60)(4,4)@xmath20 ( 76,60)(4,-3)4 ( 80,54)(3,3 ) ( 2,54)(0,1)6 ( 0,50)(4,4 ) ( 2,50)(0,-1)6 ( 26,54)(0,1)6 ( 24,50)(4,4 ) ( 26,50)(0,-1)6 ( 50,54)(0,1)6 ( 48,50)(4,4 ) ( 50,50)(0,-1)6 ( 74,54)(0,1)6 ( 72,50)(4,4 ) ( 74,50)(0,-1)6 ( 0,40)(4,4)@xmath20 ( 4,40)(4,-3)4 ( 8,34)(3,3 ) ( 4,42)(1,0)8 ( 12,40)(4,4 ) ( 16,42)(1,0)8 ( 24,40)(4,4)@xmath20 ( 28,40)(4,-3)4 ( 32,34)(3,3 ) ( 28,42)(1,0)8 ( 36,40)(4,4 ) ( 40,42)(1,0)8 ( 48,40)(4,4)@xmath20 ( 52,40)(4,-3)4 ( 56,34)(3,3 ) ( 52,42)(1,0)8 ( 60,40)(4,4 ) ( 64,42)(1,0)8 ( 72,40)(4,4)@xmath20 ( 76,40)(4,-3)4 ( 80,34)(3,3 ) ( 2,34)(0,1)6 ( 0,30)(4,4 ) ( 2,30)(0,-1)6 ( 26,34)(0,1)6 ( 24,30)(4,4 ) ( 26,30)(0,-1)6 ( 50,34)(0,1)6 ( 48,30)(4,4 ) ( 50,30)(0,-1)6 ( 74,34)(0,1)6 ( 72,30)(4,4 ) ( 74,30)(0,-1)6 ( 0,20)(4,4)@xmath20 ( 4,20)(4,-3)4 ( 8,14)(3,3 ) ( 4,22)(1,0)8 ( 12,20)(4,4 ) ( 16,22)(1,0)8 ( 24,20)(4,4)@xmath20 ( 28,20)(4,-3)4 ( 32,14)(3,3 ) ( 28,22)(1,0)8 ( 36,20)(4,4 ) ( 40,22)(1,0)8 ( 48,20)(4,4)@xmath20 ( 52,20)(4,-3)4 ( 56,14)(3,3 ) ( 52,22)(1,0)8 ( 60,20)(4,4 ) ( 64,22)(1,0)8 ( 72,20)(4,4)@xmath20 ( 76,20)(4,-3)4 ( 80,14)(3,3 ) ( 2,14)(0,1)6 ( 0,10)(4,4 ) ( 2,10)(0,-1)6 ( 26,14)(0,1)6 ( 24,10)(4,4 ) ( 26,10)(0,-1)6 ( 50,14)(0,1)6 ( 48,10)(4,4 ) ( 50,10)(0,-1)6 ( 74,14)(0,1)6 ( 72,10)(4,4 ) ( 74,10)(0,-1)6 ( 0,0)(4,4)@xmath20 ( 4,0)(4,-3)4 ( 8,-6)(3,3 ) ( 4,2)(1,0)8 ( 12,0)(4,4 ) ( 16,2)(1,0)8 ( 24,0)(4,4)@xmath20 ( 28,0)(4,-3)4 ( 32,-6)(3,3 ) ( 28,2)(1,0)8 ( 36,0)(4,4 ) ( 40,2)(1,0)8 ( 48,0)(4,4)@xmath20 ( 52,0)(4,-3)4 ( 56,-6)(3,3 ) ( 52,2)(1,0)8 ( 60,0)(4,4 ) ( 64,2)(1,0)8 ( 72,0)(4,4)@xmath20 ( 76,0)(4,-3)4 ( 80,-6)(3,3 )    in this paper , we concentrate on ferromagnetic models , characterized by @xmath24 , for each @xmath25 . the external field is assumed to be consistent . if @xmath26 , variable @xmath19 tends to have value @xmath14 , while @xmath19 tends to have value @xmath15 if @xmath27 .    in thermal equilibrium , the probability that the model is in configuration @xmath5 is given by the boltzmann distribution @xmath28    here , the normalization constant @xmath29 is the partition function @xmath30 and @xmath31 , where @xmath32 denotes the temperature and @xmath33 is boltzmann s constant  @xcite . the helmholtz free energy is defined as @xmath34    in the rest of this paper , we will assume @xmath35 . with this assumption ,",
    "e.g. , large values of @xmath36 and @xmath37 correspond to models at low temperature and in a strong external field .",
    "for each adjacent pair @xmath38 , let @xmath39 - [ x_k \\ne x_{\\ell}]\\big)}\\ ] ] and for each @xmath40 @xmath41 - [ x_m = 0]\\big)}\\ ] ]    we can then define @xmath42 as @xmath43    the corresponding forney factor graph ( normal graph ) for the factorization in  ( [ eqn : factorf ] ) is shown in  fig .",
    "[ fig:2dgrid ] , where the boxes labeled `` @xmath20 '' are equality constraints  @xcite .    from ( [ eqn : factorf ] )",
    ", the partition function ( [ eqn : prob ] ) can be expressed as @xmath44    at high temperatures ( i.e. , small @xmath36 ) , the boltzmann distribution  ( [ eqn : prob ] ) approaches the uniform distribution . to estimate @xmath29 in this case ,",
    "monte carlo methods in the original factor graph , as in fig .",
    "[ fig:2dgrid ] , generally perform well . in this paper",
    ", we propose an importance sampling scheme to compute an estimate of the partition function , where the only requirement to obtain fast convergence is having a strong external magnetic field ( i.e. , large @xmath37 ) .",
    "the scheme operates in the dual of the forney factor graph representing the factorization in  ( [ eqn : factorf ] ) .",
    "( 81,66)(0,0 ) ( 0,60)(4,4)@xmath45 ( 4,60)(4,-3)4 ( 8,54)(3,3 ) ( 4,62)(1,0)8 ( 12,60)(4,4 ) ( 16,62)(1,0)8 ( 24,60)(4,4)@xmath45 ( 28,60)(4,-3)4 ( 32,54)(3,3 ) ( 28,62)(1,0)8 ( 36,60)(4,4 ) ( 40,62)(1,0)8 ( 48,60)(4,4)@xmath45 ( 52,60)(4,-3)4 ( 56,54)(3,3 ) ( 52,62)(1,0)8 ( 60,60)(4,4 ) ( 64,62)(1,0)8 ( 72,60)(4,4)@xmath45 ( 76,60)(4,-3)4 ( 80,54)(3,3 ) ( 2,54)(0,1)6 ( 0,50)(4,4 ) ( 2,50)(0,-1)6 ( 26,54)(0,1)6 ( 24,50)(4,4 ) ( 26,50)(0,-1)6 ( 50,54)(0,1)6 ( 48,50)(4,4 ) ( 50,50)(0,-1)6 ( 74,54)(0,1)6 ( 72,50)(4,4 ) ( 74,50)(0,-1)6 ( 0,40)(4,4)@xmath45 ( 4,40)(4,-3)4 ( 8,34)(3,3 ) ( 4,42)(1,0)8 ( 12,40)(4,4 ) ( 16,42)(1,0)8 ( 24,40)(4,4)@xmath45 ( 28,40)(4,-3)4 ( 32,34)(3,3 ) ( 28,42)(1,0)8 ( 36,40)(4,4 ) ( 40,42)(1,0)8 ( 48,40)(4,4)@xmath45 ( 52,40)(4,-3)4 ( 56,34)(3,3 ) ( 52,42)(1,0)8 ( 60,40)(4,4 ) ( 64,42)(1,0)8 ( 72,40)(4,4)@xmath45 ( 76,40)(4,-3)4 ( 80,34)(3,3 ) ( 2,34)(0,1)6 ( 0,30)(4,4 ) ( 2,30)(0,-1)6 ( 26,34)(0,1)6 ( 24,30)(4,4 ) ( 26,30)(0,-1)6 ( 50,34)(0,1)6 ( 48,30)(4,4 ) ( 50,30)(0,-1)6 ( 74,34)(0,1)6 ( 72,30)(4,4 ) ( 74,30)(0,-1)6 ( 0,20)(4,4)@xmath45 ( 4,20)(4,-3)4 ( 8,14)(3,3 ) ( 4,22)(1,0)8 ( 12,20)(4,4 ) ( 16,22)(1,0)8 ( 24,20)(4,4)@xmath45 ( 28,20)(4,-3)4 ( 32,14)(3,3 ) ( 28,22)(1,0)8 ( 36,20)(4,4 ) ( 40,22)(1,0)8 ( 48,20)(4,4)@xmath45 ( 52,20)(4,-3)4 ( 56,14)(3,3 ) ( 52,22)(1,0)8 ( 60,20)(4,4 ) ( 64,22)(1,0)8 ( 72,20)(4,4)@xmath45 ( 76,20)(4,-3)4 ( 80,14)(3,3 ) ( 2,14)(0,1)6 ( 0,10)(4,4 ) ( 2,10)(0,-1)6 ( 26,14)(0,1)6 ( 24,10)(4,4 ) ( 26,10)(0,-1)6 ( 50,14)(0,1)6 ( 48,10)(4,4 ) ( 50,10)(0,-1)6 ( 74,14)(0,1)6 ( 72,10)(4,4 ) ( 74,10)(0,-1)6 ( 0,0)(4,4)@xmath45 ( 4,0)(4,-3)4 ( 8,-6)(3,3 ) ( 4,2)(1,0)8 ( 12,0)(4,4 ) ( 16,2)(1,0)8 ( 24,0)(4,4)@xmath45 ( 28,0)(4,-3)4 ( 32,-6)(3,3 ) ( 28,2)(1,0)8 ( 36,0)(4,4 ) ( 40,2)(1,0)8 ( 48,0)(4,4)@xmath45 ( 52,0)(4,-3)4 ( 56,-6)(3,3 ) ( 52,2)(1,0)8 ( 60,0)(4,4 ) ( 64,2)(1,0)8 ( 72,0)(4,4)@xmath45 ( 76,0)(4,-3)4 ( 80,-6)(3,3 ) ( 8,63)(0,0)[bc]@xmath46 ( 20,63)(0,0)[bc]@xmath47 ( 32,63)(0,0)[bc]@xmath48",
    "starting from a forney factor graph , as in  fig .",
    "[ fig:2dgrid ] , we can obtain its dual by replacing each variable @xmath49 with its dual variable @xmath50 , each factor @xmath51 with its 2d discrete fourier transform ( dft ) , the 2d dft of @xmath52 , is defined as @xmath53 where @xmath54 is the unit imaginary number  @xcite . ] , each factor @xmath55 with its one - dimensional ( 1d ) dft , and each equality constraint with an xor factor , see  @xcite .    in the dual domain , random variables",
    "@xmath56 also take their values in @xmath2 .",
    "the partition function is denoted by @xmath57 and the number of edges by @xmath58 . for the models that we consider in this paper , the normal factor graph duality theorem states that @xmath59 see  ( * ? ? ?",
    "* theorem 2 ) and @xcite especially for the normal factor graph duality theorem in the context of linear codes .",
    "( 77,71.6)(0,0 ) ( 0,60)(4,4)@xmath45 ( 4,60)(4,-3)4 ( 8,54)(3,3 ) ( 4,62)(1,0)8 ( 12,60)(4,4)@xmath20 ( 16,62)(1,0)8 ( 24,60)(4,4)@xmath45 ( 28,60)(4,-3)4 ( 32,54)(3,3 ) ( 28,62)(1,0)8 ( 36,60)(4,4)@xmath20 ( 40,62)(1,0)8 ( 48,60)(4,4)@xmath45 ( 52,60)(4,-3)4 ( 56,54)(3,3 ) ( 52,62)(1,0)8 ( 60,60)(4,4)@xmath20 ( 64,62)(1,0)8 ( 72,60)(4,4)@xmath45 ( 76,60)(4,-3)4 ( 80,54)(3,3 ) ( 2,54)(0,1)6 ( 0,50)(4,4)@xmath20 ( 2,50)(0,-1)6 ( 26,54)(0,1)6 ( 24,50)(4,4)@xmath20 ( 26,50)(0,-1)6 ( 50,54)(0,1)6 ( 48,50)(4,4)@xmath20 ( 50,50)(0,-1)6 ( 74,54)(0,1)6 ( 72,50)(4,4)@xmath20 ( 74,50)(0,-1)6 ( 0,40)(4,4)@xmath45 ( 4,40)(4,-3)4 ( 8,34)(3,3 ) ( 4,42)(1,0)8 ( 12,40)(4,4)@xmath20 ( 16,42)(1,0)8 ( 24,40)(4,4)@xmath45 ( 28,40)(4,-3)4 ( 32,34)(3,3 ) ( 28,42)(1,0)8 ( 36,40)(4,4)@xmath20 ( 40,42)(1,0)8 ( 48,40)(4,4)@xmath45 ( 52,40)(4,-3)4 ( 56,34)(3,3 ) ( 52,42)(1,0)8 ( 60,40)(4,4)@xmath20 ( 64,42)(1,0)8 ( 72,40)(4,4)@xmath45 ( 76,40)(4,-3)4 ( 80,34)(3,3 ) ( 2,34)(0,1)6 ( 0,30)(4,4)@xmath20 ( 2,30)(0,-1)6 ( 26,34)(0,1)6 ( 24,30)(4,4)@xmath20 ( 26,30)(0,-1)6 ( 50,34)(0,1)6 ( 48,30)(4,4)@xmath20 ( 50,30)(0,-1)6 ( 74,34)(0,1)6 ( 72,30)(4,4)@xmath20 ( 74,30)(0,-1)6 ( 0,20)(4,4)@xmath45 ( 4,20)(4,-3)4 ( 8,14)(3,3 ) ( 4,22)(1,0)8 ( 12,20)(4,4)@xmath20 ( 16,22)(1,0)8 ( 24,20)(4,4)@xmath45 ( 28,20)(4,-3)4 ( 32,14)(3,3 ) ( 28,22)(1,0)8 ( 36,20)(4,4)@xmath20 ( 40,22)(1,0)8 ( 48,20)(4,4)@xmath45 ( 52,20)(4,-3)4 ( 56,14)(3,3 ) ( 52,22)(1,0)8 ( 60,20)(4,4)@xmath20 ( 64,22)(1,0)8 ( 72,20)(4,4)@xmath45 ( 76,20)(4,-3)4 ( 80,14)(3,3 ) ( 2,14)(0,1)6 ( 0,10)(4,4)@xmath20 ( 2,10)(0,-1)6 ( 26,14)(0,1)6 ( 24,10)(4,4)@xmath20 ( 26,10)(0,-1)6 ( 50,14)(0,1)6 ( 48,10)(4,4)@xmath20 ( 50,10)(0,-1)6 ( 74,14)(0,1)6 ( 72,10)(4,4)@xmath20 ( 74,10)(0,-1)6 ( 0,0)(4,4)@xmath45 ( 4,0)(4,-3)4 ( 8,-6)(3,3 ) ( 4,2)(1,0)8 ( 12,0)(4,4)@xmath20 ( 16,2)(1,0)8 ( 24,0)(4,4)@xmath45 ( 28,0)(4,-3)4 ( 32,-6)(3,3 ) ( 28,2)(1,0)8 ( 36,0)(4,4)@xmath20 ( 40,2)(1,0)8 ( 48,0)(4,4)@xmath45 ( 52,0)(4,-3)4 ( 56,-6)(3,3 ) ( 52,2)(1,0)8 ( 60,0)(4,4)@xmath20 ( 64,2)(1,0)8 ( 72,0)(4,4)@xmath45 ( 76,0)(4,-3)4 ( 80,-6)(3,3 )    ( 8,63)(0,0)[bc]@xmath46 ( 32,63)(0,0)[bc]@xmath47    ( 14,64)(0,1)2 ( 38,64)(0,1)2 ( 62,64)(0,1)2 ( 12,66)(4,4)@xmath60 ( 36,66)(4,4)@xmath60 ( 60,66)(4,4)@xmath60 ( 14,44)(0,1)2 ( 38,44)(0,1)2 ( 62,44)(0,1)2 ( 12,46)(4,4)@xmath60 ( 36,46)(4,4)@xmath60 ( 60,46)(4,4)@xmath60 ( 14,24)(0,1)2 ( 38,24)(0,1)2 ( 62,24)(0,1)2 ( 12,26)(4,4)@xmath60 ( 36,26)(4,4)@xmath60 ( 60,26)(4,4)@xmath60 ( 14,4)(0,1)2 ( 38,4)(0,1)2 ( 62,4)(0,1)2 ( 12,6)(4,4)@xmath60 ( 36,6)(4,4)@xmath60 ( 60,6)(4,4)@xmath60 ( 0,52)(-1,0)2 ( 24,52)(-1,0)2 ( 48,52)(-1,0)2 ( 72,52)(-1,0)2 ( -6,50)(4,4)@xmath60 ( 18,50)(4,4)@xmath60 ( 42,50)(4,4)@xmath60 ( 66,50)(4,4)@xmath60 ( 0,32)(-1,0)2 ( 24,32)(-1,0)2 ( 48,32)(-1,0)2 ( 72,32)(-1,0)2 ( -6,30)(4,4)@xmath60 ( 18,30)(4,4)@xmath60 ( 42,30)(4,4)@xmath60 ( 66,30)(4,4)@xmath60 ( 0,12)(-1,0)2 ( 24,12)(-1,0)2 ( 48,12)(-1,0)2 ( 72,12)(-1,0)2 ( -6,10)(4,4)@xmath60 ( 18,10)(4,4)@xmath60 ( 42,10)(4,4)@xmath60 ( 66,10)(4,4)@xmath60    for variables @xmath61 , in the dual forney factor graph of the ising model , xor factors are defined as @xmath62\\ ] ] where @xmath63 denotes addition in gf(@xmath64 )",
    ".    the 1d dft of factors as in  ( [ eqn : isingh ] ) will have the following form @xmath65 and each factor  ( [ eqn : isinga ] ) is replaced by its 2d dft , which has the following form @xmath66    the corresponding dual forney factor graph with factors as in  ( [ eqn : isingkerneldual2 ] ) and  ( [ eqn : isingkerneld ] ) is shown in  fig .  [ fig:2dgridd ] .",
    "all the factors in  ( [ eqn : isingkerneld ] ) are diagonal , therefore it is possible to simplify the dual factor graph in  fig .",
    "[ fig:2dgridd ] , to construct the modified dual factor graph depicted in  fig .",
    "[ fig:2dgriddm ] , with factors attached to each equality constraint as @xmath67    here , @xmath68 is the coupling parameter associated with each bond ( the bond strength ) .",
    "the corresponding modified dual forney factor graph with factors as in  ( [ eqn : isingkerneldual2 ] ) and  ( [ eqn : isingkerneldual ] ) is shown in  fig .",
    "[ fig:2dgriddm ] ; see  @xcite for more details .    in this paper , we concentrate on ferromagnetic models , therefore all the factors as in  ( [ eqn : isingkerneldual ] ) are positive .",
    "since in a 2d ising model , the value of @xmath29 is invariant under the change of sign of the external magnetic field  @xcite , without loss of generality , we assume @xmath69 . with this assumption , all the factors as in  ( [ eqn : isingkerneldual2 ] ) will also be positive .",
    "applying monte carlo methods to factor graphs with negative and complex factors is discussed in  @xcite . ] .",
    "( 77,71.55)(0,0 ) ( 0,60)(4,4)@xmath20 ( 4,60)(4,-3)4 ( 8,54)(3,3 ) ( 4,62)(1,0)8 ( 12,60)(4,4)@xmath45 ( 16,62)(1,0)8 ( 24,60)(4,4)@xmath20 ( 28,60)(4,-3)4 ( 32,54)(3,3 ) ( 28,62)(1,0)8 ( 36,60)(4,4)@xmath45 ( 40,62)(1,0)8 ( 48,60)(4,4)@xmath20 ( 52,60)(4,-3)4 ( 56,54)(3,3 ) ( 52,62)(1,0)8 ( 60,60)(4,4)@xmath45 ( 64,62)(1,0)8 ( 72,60)(4,4)@xmath20 ( 76,60)(4,-3)4 ( 80,54)(3,3 ) ( 2,54)(0,1)6 ( 0,50)(4,4)@xmath45 ( 2,50)(0,-1)6 ( 26,54)(0,1)6 ( 24,50)(4,4)@xmath45 ( 26,50)(0,-1)6 ( 50,54)(0,1)6 ( 48,50)(4,4)@xmath45 ( 50,50)(0,-1)6 ( 74,54)(0,1)6 ( 72,50)(4,4)@xmath45 ( 74,50)(0,-1)6 ( 0,40)(4,4)@xmath20 ( 4,40)(4,-3)4 ( 8,34)(3,3 ) ( 4,42)(1,0)8 ( 12,40)(4,4)@xmath45 ( 16,42)(1,0)8 ( 24,40)(4,4)@xmath20 ( 28,40)(4,-3)4 ( 32,34)(3,3 ) ( 28,42)(1,0)8 ( 36,40)(4,4)@xmath45 ( 40,42)(1,0)8 ( 48,40)(4,4)@xmath20 ( 52,40)(4,-3)4 ( 56,34)(3,3 ) ( 52,42)(1,0)8 ( 60,40)(4,4)@xmath45 ( 64,42)(1,0)8 ( 72,40)(4,4)@xmath20 ( 76,40)(4,-3)4 ( 80,34)(3,3 ) ( 2,34)(0,1)6 ( 0,30)(4,4)@xmath45 ( 2,30)(0,-1)6 ( 26,34)(0,1)6 ( 24,30)(4,4)@xmath45 ( 26,30)(0,-1)6 ( 50,34)(0,1)6 ( 48,30)(4,4)@xmath45 ( 50,30)(0,-1)6 ( 74,34)(0,1)6 ( 72,30)(4,4)@xmath45 ( 74,30)(0,-1)6 ( 0,20)(4,4)@xmath20 ( 4,20)(4,-3)4 ( 8,14)(3,3 ) ( 4,22)(1,0)8 ( 12,20)(4,4)@xmath45 ( 16,22)(1,0)8 ( 24,20)(4,4)@xmath20 ( 28,20)(4,-3)4 ( 32,14)(3,3 ) ( 28,22)(1,0)8 ( 36,20)(4,4)@xmath45 ( 40,22)(1,0)8 ( 48,20)(4,4)@xmath20 ( 52,20)(4,-3)4 ( 56,14)(3,3 ) ( 52,22)(1,0)8 ( 60,20)(4,4)@xmath45 ( 64,22)(1,0)8 ( 72,20)(4,4)@xmath20 ( 76,20)(4,-3)4 ( 80,14)(3,3 ) ( 2,14)(0,1)6 ( 0,10)(4,4)@xmath45 ( 2,10)(0,-1)6 ( 26,14)(0,1)6 ( 24,10)(4,4)@xmath45 ( 26,10)(0,-1)6 ( 50,14)(0,1)6 ( 48,10)(4,4)@xmath45 ( 50,10)(0,-1)6 ( 74,14)(0,1)6 ( 72,10)(4,4)@xmath45 ( 74,10)(0,-1)6 ( 0,0)(4,4)@xmath20 ( 4,0)(4,-3)4 ( 8,-6)(3,3 ) ( 4,2)(1,0)8 ( 12,0)(4,4)@xmath45 ( 16,2)(1,0)8 ( 24,0)(4,4)@xmath20 ( 28,0)(4,-3)4 ( 32,-6)(3,3 ) ( 28,2)(1,0)8 ( 36,0)(4,4)@xmath45 ( 40,2)(1,0)8 ( 48,0)(4,4)@xmath20 ( 52,0)(4,-3)4 ( 56,-6)(3,3 ) ( 52,2)(1,0)8 ( 60,0)(4,4)@xmath45 ( 64,2)(1,0)8 ( 72,0)(4,4)@xmath20 ( 76,0)(4,-3)4 ( 80,-6)(3,3 )    ( 8,63)(0,0)[bc]@xmath21 ( 32,63)(0,0)[bc]@xmath22    ( 14,64)(0,1)2 ( 38,64)(0,1)2 ( 62,64)(0,1)2 ( 12,66)(4,4)@xmath60 ( 36,66)(4,4)@xmath60 ( 60,66)(4,4)@xmath60 ( 14,44)(0,1)2 ( 38,44)(0,1)2 ( 62,44)(0,1)2 ( 12,46)(4,4)@xmath60 ( 36,46)(4,4)@xmath60 ( 60,46)(4,4)@xmath60 ( 14,24)(0,1)2 ( 38,24)(0,1)2 ( 62,24)(0,1)2 ( 12,26)(4,4)@xmath60 ( 36,26)(4,4)@xmath60 ( 60,26)(4,4)@xmath60 ( 14,4)(0,1)2 ( 38,4)(0,1)2 ( 62,4)(0,1)2 ( 12,6)(4,4)@xmath60 ( 36,6)(4,4)@xmath60 ( 60,6)(4,4)@xmath60 ( 0,52)(-1,0)2 ( 24,52)(-1,0)2 ( 48,52)(-1,0)2 ( 72,52)(-1,0)2 ( -6,50)(4,4)@xmath60 ( 18,50)(4,4)@xmath60 ( 42,50)(4,4)@xmath60 ( 66,50)(4,4)@xmath60 ( 0,32)(-1,0)2 ( 24,32)(-1,0)2 ( 48,32)(-1,0)2 ( 72,32)(-1,0)2 ( -6,30)(4,4)@xmath60 ( 18,30)(4,4)@xmath60 ( 42,30)(4,4)@xmath60 ( 66,30)(4,4)@xmath60 ( 0,12)(-1,0)2 ( 24,12)(-1,0)2 ( 48,12)(-1,0)2 ( 72,12)(-1,0)2 ( -6,10)(4,4)@xmath60 ( 18,10)(4,4)@xmath60 ( 42,10)(4,4)@xmath60 ( 66,10)(4,4)@xmath60    as a side remark , we point out that by looking at the dual of the modified dual forney factor graph in  fig .",
    "[ fig:2dgriddm ] we can obtain the modified forney factor graph of a 2d ising model in an external field , with factors attached to each equality constraint as @xmath70 and with factors attached to each xor factor as @xmath71 the corresponding modified forney factor graph is shown in  fig .",
    "[ fig:2dgridorig ] .    in section  [ sec : is ] , we use the dual forney factor graph representation of the ising model to propose an importance sampling scheme to compute an estimate of @xmath29 , as in ( [ eqn : partfunction ] ) .",
    "we describe our importance sampling scheme on the modified dual forney factor graph of the 2d ising model in an external field shown in  fig .",
    "[ fig:2dgriddm ] . the scheme can be described analogously for the 2d @xmath0-state potts model , see section  [ sec : potts ] .",
    "let us partition the set of random variables @xmath72 , into @xmath73 and @xmath74 , with the restriction that the random variables in @xmath74 are linear combinations ( involving the xor factors ) of the random variables in @xmath73 . in our framework , we let @xmath74 be the set of all the variables represented by the edges connected to the small unlabeled boxes in figs .  [ fig:2dgriddm ] and  [ fig:2dgriddpart ] , which are the variables involved in factors as in  ( [ eqn : isingkerneldual2 ] ) . with this choice , @xmath73 will contain all the variables involved in factors as in  ( [ eqn : isingkerneldual ] ) , which are associated with each bond in the modified dual forney factor graph and are marked by thick edges in  fig .",
    "[ fig:2dgriddpart ] . as will be discussed ,",
    "this choice of partitioning is appropriate for models in a strong external field .",
    "a valid configuration @xmath75 in the dual factor graph can be created by assigning values to @xmath73 , followed by updating @xmath74 as linear combinations of @xmath73 .",
    "let us define    r , c , l ( * x*_a ) & & _ x_k * x*_a _ k(x_k ) [ eqn : partg ] + ( * x*_b ) & & _ x_m * x*_b _ m(x_m)[eqn : partl ]    we use the following probability mass function as the auxiliary distribution in our importance sampling scheme @xmath76    the auxiliary distribution  ( [ eqn : auxdist ] ) has two key properties .",
    "first , its partition function @xmath77 is analytically available as    r , c , l z_q & = & _ * x*_a ( * x*_a ) + & = & _ k 4(j_k + j_k ) + & = & 4^|| ( _ k j_k ) [ eqn : zq ]    where @xmath78 is the cardinality of @xmath11 , which is equal to the number of bonds ( the number of interacting pairs ) in the lattice ( cf .  section [ sec : ising ] ) .",
    "the value of @xmath77 is thus a function of the sum of all the coupling parameters .",
    "second , it is straightforward to draw _ independent _ samples @xmath79 , according to @xmath80 .",
    "to draw @xmath81 , we use the following algorithm    * _ draw _ @xmath82 $ ] * * for * @xmath83 * to * @xmath78 * @xmath84 * @xmath85 *   * @xmath86 *   * * end for *    the quantity @xmath87 is equal to @xmath88 .",
    "random variables in @xmath74 are linear combinations of those in @xmath73 , therefore after drawing @xmath81 , updating @xmath89 can be done in a straightforward manner .",
    "the samples are then used in the following importance sampling algorithm to estimate @xmath90 .",
    "*   * _ update _ @xmath91 * _ compute _ @xmath92    it follows that , @xmath93 is an unbiased and consistent estimator of @xmath90 .",
    "indeed @xmath94 = \\frac{z_\\text{d}}{z_q}\\ ] ]    ( 77,72.25)(0,0 ) ( 0,60)(4,4)@xmath45 ( 8,54)(3,3 ) ( 12,60)(4,4)@xmath20 ( 24,60)(4,4)@xmath45 ( 32,54)(3,3 ) ( 36,60)(4,4)@xmath20 ( 48,60)(4,4)@xmath45 ( 56,54)(3,3 ) ( 60,60)(4,4)@xmath20 ( 72,60)(4,4)@xmath45 ( 80,54)(3,3 ) ( 0,50)(4,4)@xmath20 ( 24,50)(4,4)@xmath20 ( 48,50)(4,4)@xmath20 ( 72,50)(4,4)@xmath20 ( 0,40)(4,4)@xmath45 ( 8,34)(3,3 ) ( 12,40)(4,4)@xmath20 ( 24,40)(4,4)@xmath45 ( 32,34)(3,3 ) ( 36,40)(4,4)@xmath20 ( 48,40)(4,4)@xmath45 ( 56,34)(3,3 ) ( 60,40)(4,4)@xmath20 ( 72,40)(4,4)@xmath45 ( 80,34)(3,3 ) ( 0,30)(4,4)@xmath20 ( 24,30)(4,4)@xmath20 ( 48,30)(4,4)@xmath20 ( 72,30)(4,4)@xmath20 ( 0,20)(4,4)@xmath45 ( 8,14)(3,3 ) ( 12,20)(4,4)@xmath20 ( 24,20)(4,4)@xmath45 ( 32,14)(3,3 ) ( 36,20)(4,4)@xmath20 ( 48,20)(4,4)@xmath45 ( 56,14)(3,3 ) ( 60,20)(4,4)@xmath20 ( 72,20)(4,4)@xmath45 ( 80,14)(3,3 ) ( 0,10)(4,4)@xmath20 ( 24,10)(4,4)@xmath20 ( 48,10)(4,4)@xmath20 ( 72,10)(4,4)@xmath20 ( 0,0)(4,4)@xmath45 ( 8,-6)(3,3 ) ( 12,0)(4,4)@xmath20 ( 24,0)(4,4)@xmath45 ( 32,-6)(3,3 ) ( 36,0)(4,4)@xmath20 ( 48,0)(4,4)@xmath45 ( 56,-6)(3,3 ) ( 60,0)(4,4)@xmath20 ( 72,0)(4,4)@xmath45 ( 80,-6)(3,3 )    ( 12,66)(4,4)@xmath60 ( 36,66)(4,4)@xmath60 ( 60,66)(4,4)@xmath60 ( 12,46)(4,4)@xmath60 ( 36,46)(4,4)@xmath60 ( 60,46)(4,4)@xmath60 ( 12,26)(4,4)@xmath60 ( 36,26)(4,4)@xmath60 ( 60,26)(4,4)@xmath60 ( 12,6)(4,4)@xmath60 ( 36,6)(4,4)@xmath60 ( 60,6)(4,4)@xmath60 ( -6,50)(4,4)@xmath60 ( 18,50)(4,4)@xmath60 ( 42,50)(4,4)@xmath60 ( 66,50)(4,4)@xmath60 ( -6,30)(4,4)@xmath60 ( 18,30)(4,4)@xmath60 ( 42,30)(4,4)@xmath60 ( 66,30)(4,4)@xmath60 ( -6,10)(4,4)@xmath60 ( 18,10)(4,4)@xmath60 ( 42,10)(4,4)@xmath60 ( 66,10)(4,4)@xmath60    ( 4,60)(4,-3)4 ( 28,60)(4,-3)4 ( 52,60)(4,-3)4 ( 76,60)(4,-3)4    ( 4,40)(4,-3)4 ( 28,40)(4,-3)4 ( 52,40)(4,-3)4 ( 76,40)(4,-3)4 ( 4,20)(4,-3)4 ( 28,20)(4,-3)4 ( 52,20)(4,-3)4 ( 76,20)(4,-3)4 ( 4,0)(4,-3)4 ( 28,0)(4,-3)4 ( 52,0)(4,-3)4 ( 76,0)(4,-3)4    ( 14,4)(0,1)2 ( 38,4)(0,1)2 ( 62,4)(0,1)2    ( 14,64)(0,1)2 ( 38,64)(0,1)2 ( 62,64)(0,1)2    ( 14,44)(0,1)2 ( 38,44)(0,1)2 ( 62,44)(0,1)2    ( 14,24)(0,1)2 ( 38,24)(0,1)2 ( 62,24)(0,1)2    ( 0,52)(-1,0)2 ( 24,52)(-1,0)2 ( 48,52)(-1,0)2 ( 72,52)(-1,0)2    ( 0,32)(-1,0)2 ( 24,32)(-1,0)2 ( 48,32)(-1,0)2 ( 72,32)(-1,0)2    ( 0,12)(-1,0)2 ( 24,12)(-1,0)2 ( 48,12)(-1,0)2 ( 72,12)(-1,0)2    ( 4,62)(1,0)8 ( 16,62)(1,0)8 ( 28,62)(1,0)8 ( 40,62)(1,0)8 ( 52,62)(1,0)8 ( 64,62)(1,0)8 ( 2,54)(0,1)6 ( 2,50)(0,-1)6 ( 26,54)(0,1)6 ( 26,50)(0,-1)6 ( 50,54)(0,1)6 ( 50,50)(0,-1)6 ( 74,54)(0,1)6 ( 74,50)(0,-1)6 ( 4,42)(1,0)8 ( 16,42)(1,0)8 ( 28,42)(1,0)8 ( 40,42)(1,0)8 ( 52,42)(1,0)8 ( 64,42)(1,0)8 ( 2,34)(0,1)6 ( 2,30)(0,-1)6 ( 26,34)(0,1)6 ( 26,30)(0,-1)6 ( 50,34)(0,1)6 ( 50,30)(0,-1)6 ( 74,34)(0,1)6 ( 74,30)(0,-1)6 ( 4,22)(1,0)8 ( 16,22)(1,0)8 ( 28,22)(1,0)8 ( 40,22)(1,0)8 ( 52,22)(1,0)8 ( 64,22)(1,0)8 ( 2,14)(0,1)6 ( 2,10)(0,-1)6 ( 26,14)(0,1)6 ( 26,10)(0,-1)6 ( 50,14)(0,1)6 ( 50,10)(0,-1)6 ( 74,14)(0,1)6 ( 74,10)(0,-1)6 ( 4,2)(1,0)8 ( 16,2)(1,0)8 ( 28,2)(1,0)8 ( 40,2)(1,0)8 ( 52,2)(1,0)8 ( 64,2)(1,0)8    since @xmath77 is analytically available  ( [ eqn : zq ] ) , the proposed importance sampling scheme can yield an estimate of @xmath57 , which can then be used to estimate the partition function  ( [ eqn : partfunction ] ) , using the normal factor graph duality theorem  ( cf .  section  [ sec : nfgd ] ) .",
    "the accuracy of @xmath93 in  ( [ eqn : estr ] ) depends on the fluctuations of @xmath95 .",
    "if @xmath95 varies smoothly , @xmath93 will have a small variance . with our choice of partitioning in  ( [ eqn : partg ] ) and  ( [ eqn : partl ] ) , we expect to observe a small variance if the ising model is in a strong ( negative ) external magnetic field , see appendix  i. the choice of partitioning on the dual graph is arbitrary , as long as @xmath74 can be computed as linear combinations of @xmath73 .",
    "our choice of partitioning is suitable for models in a strong external magnetic field .",
    "depending on the values of the model parameters and their spatial distributions , different choices of partitioning will yield schemes with different dynamics .",
    "if the model is not in a very strong external field , we can consider applying annealed importance sampling  @xcite , @xcite ; see appendix  ii . for models in a weak external field ,",
    "the efficiency of the importance sampling algorithm on the dual factor graph should be compared to the efficiency of monte carlo methods applied directly to the original factor graph , as in figs .",
    "[ fig:2dgrid ] and  [ fig:2dgridorig ] .",
    "we can design a uniform sampling scheme by drawing each @xmath96 uniformly and independently from @xmath2 , and by applying @xmath97    it is easy to verify that , @xmath98 = z_\\text{d}$ ] .",
    "it must be emphasized that , the cost of generating @xmath99 using the importance sampling scheme ( i.e. , drawing an independent sample according to  ( [ eqn : auxdist ] ) ) is virtually the same as the cost of generating a sample with uniform sampling ( i.e. , drawing a sample uniformly and independently in the state space ) .",
    "the efficiency of the uniform sampling algorithm and the importance sampling scheme will be close if the model is at very low temperature , i.e. , @xmath68 is very large .",
    "however , for a wider range of model parameters , importance sampling outperforms uniform sampling , as will be illustrated in our numerical experiments in section  [ sec : num ] ; see appendix  i. applying uniform sampling and gibbs sampling in the dual domain to 2d ising models in the absence of an external field are discussed in  @xcite .",
    "in a 2d @xmath0-state potts model , @xmath100 , where @xmath0 is an integer greater than or equal to 2 . the energy of a configuration @xmath5 is given by the hamiltonian @xmath101 - \\sum_{m = 1}^n h_m [ x_m = 0]\\ ] ]    here , @xmath16 controls the strength of the interaction between adjacent variables @xmath17 and @xmath18 corresponds to the presence of an external magnetic field ) is based on the assumption that @xmath18 applies only if @xmath102 .",
    "the hamiltonian of the potts model can be defined in other ways , e.g. , the external field can apply when @xmath103 or when @xmath40 is in more than one sate . ] . for @xmath104 ,",
    "the potts model is equivalent to the ising model .",
    "similar to the 2d ising model in section  [ sec : ising ] , for each adjacent pair @xmath38 , we let @xmath105}\\ ] ] and for each @xmath40 @xmath106}\\ ] ]    the forney factor graph of a 2d @xmath0-state potts model is similar to the factor graph in  fig .",
    "[ fig:2dgrid ] , where the unlabeled normal - size boxes represent factors as in  ( [ eqn : pottsa ] ) , and the small boxes represent factors as in  ( [ eqn : pottsh ] ) .    in the dual forney graph ,",
    "the xor factors are as in  ( [ eqn : xor ] ) , where @xmath63 denotes addition in gf(@xmath0 ) .",
    "the 1d dft of factors as in  ( [ eqn : pottsh ] ) are @xmath107 and the 2d dft of  ( [ eqn : pottsa ] ) will have the following form    @xmath108    where @xmath63 denotes addition in gf(@xmath0 ) .",
    "the corresponding dual forney factor graph is shown in  fig .",
    "[ fig:2dgridd ] , where the small boxes represent factors as in  ( [ eqn : pottskerneldual2 ] ) and the unlabeled normal - size boxes represent factors as in  ( [ eqn : pottskerneldual ] ) .    by adding extra xor factors on each bond ,",
    "we can obtain the modified dual forney factor graph of the @xmath0-state potts model with factors attached to each equality constraint as    @xmath109    here , @xmath68 is the coupling parameter associated with each bond .",
    "[ fig:2dgridpotts ] shows the corresponding modified dual forney factor graph with factors as in  ( [ eqn : pottskerneldual2 ] ) and  ( [ eqn : pottskernelduals ] ) , as variables are binary , and @xmath63 denotes addition in gf(2 ) . ] .",
    "we consider ferromagnetic potts models in a positive external field , characterized by @xmath110 and @xmath26 , respectively .",
    "therefore , all the factors in ( [ eqn : pottskerneldual2 ] ) and  ( [ eqn : pottskernelduals ] ) will be positive .    (",
    "77,72.5)(0,0 ) ( 0.5,60.5)(3,3)@xmath45 ( 3.5,60.5)(4,-3)4 ( 7.5,54.5)(3,3 ) ( 3.5,62)(1,0)8.5 ( 12,60)(4,4)@xmath20 ( 16,62)(1,0)3 ( 22,62)(1,0)2.5 ( 19,60.5)(3,3)@xmath45 ( 24.5,60.5)(3,3)@xmath45 ( 27.5,60.5)(4,-3)4 ( 31.5,54.5)(3,3 ) ( 27.5,62)(1,0)8.5 ( 36,60)(4,4)@xmath20 ( 40,62)(1,0)3 ( 46,62)(1,0)2.5 ( 43,60.5)(3,3)@xmath45 ( 48.5,60.5)(3,3)@xmath45 ( 51.5,60.5)(4,-3)4 ( 55.5,54.5)(3,3 ) ( 51.5,62)(1,0)8.5 ( 60,60)(4,4)@xmath20 ( 64,62)(1,0)3 ( 70,62)(1,0)2.5 ( 67,60.5)(3,3)@xmath45 ( 72.5,60.5)(3,3)@xmath45 ( 75.5,60.5)(4,-3)4 ( 79.5,54.5)(3,3 ) ( 2,54)(0,1)6.5 ( 0,50)(4,4)@xmath20 ( 0.5,45)(3,3)@xmath45 ( 2,50)(0,-1)2 ( 2,45)(0,-1)1.5 ( 26,54)(0,1)6.5 ( 24,50)(4,4)@xmath20 ( 24.5,45)(3,3)@xmath45 ( 26,50)(0,-1)2 ( 26,45)(0,-1)1.5 ( 50,54)(0,1)6.5 ( 48,50)(4,4)@xmath20 ( 48.5,45)(3,3)@xmath45 ( 50,50)(0,-1)2 ( 50,45)(0,-1)1.5 ( 74,54)(0,1)6.5 ( 72,50)(4,4)@xmath20 ( 72.5,45)(3,3)@xmath45 ( 74,50)(0,-1)2 ( 74,45)(0,-1)1.5 ( 0.5,40.5)(3,3)@xmath45 ( 3.5,40.5)(4,-3)4 ( 7.5,34.5)(3,3 ) ( 3.5,42)(1,0)8.5 ( 12,40)(4,4)@xmath20 ( 16,42)(1,0)3 ( 22,42)(1,0)2.5 ( 19,40.5)(3,3)@xmath45 ( 24.5,40.5)(3,3)@xmath45 ( 27.5,40.5)(4,-3)4 ( 31.5,34.5)(3,3 ) ( 27.5,42)(1,0)8.5 ( 36,40)(4,4)@xmath20 ( 40,42)(1,0)3 ( 46,42)(1,0)2.5 ( 43,40.5)(3,3)@xmath45 ( 48.5,40.5)(3,3)@xmath45 ( 51.5,40.5)(4,-3)4 ( 55.5,34.5)(3,3 ) ( 51.5,42)(1,0)8.5 ( 60,40)(4,4)@xmath20 ( 64,42)(1,0)3 ( 70,42)(1,0)2.5 ( 67,40.5)(3,3)@xmath45 ( 72.5,40.5)(3,3)@xmath45 ( 75.5,40.5)(4,-3)4 ( 79.5,34.5)(3,3 ) ( 2,34)(0,1)6.5 ( 0,30)(4,4)@xmath20 ( 0.5,25)(3,3)@xmath45 ( 2,30)(0,-1)2 ( 2,25)(0,-1)1.5 ( 26,34)(0,1)6.5 ( 24,30)(4,4)@xmath20 ( 24.5,25)(3,3)@xmath45 ( 26,30)(0,-1)2 ( 26,25)(0,-1)1.5 ( 50,34)(0,1)6.5 ( 48,30)(4,4)@xmath20 ( 48.5,25)(3,3)@xmath45 ( 50,30)(0,-1)2 ( 50,25)(0,-1)1.5 ( 74,34)(0,1)6.5 ( 72,30)(4,4)@xmath20 ( 72.5,25)(3,3)@xmath45 ( 74,30)(0,-1)2 ( 74,25)(0,-1)1.5 ( 0.5,20.5)(3,3)@xmath45 ( 3.5,20.5)(4,-3)4 ( 7.5,14.5)(3,3 ) ( 3.5,22)(1,0)8.5 ( 12,20)(4,4)@xmath20 ( 16,22)(1,0)3 ( 22,22)(1,0)2.5 ( 19,20.5)(3,3)@xmath45 ( 24.5,20.5)(3,3)@xmath45 ( 27.5,20.5)(4,-3)4 ( 31.5,14.5)(3,3 ) ( 27.5,22)(1,0)8.5 ( 36,20)(4,4)@xmath20 ( 40,22)(1,0)3 ( 46,22)(1,0)2.5 ( 43,20.5)(3,3)@xmath45 ( 48.5,20.5)(3,3)@xmath45 ( 51.5,20.5)(4,-3)4 ( 55.5,14.5)(3,3 ) ( 51.5,22)(1,0)8.5 ( 60,20)(4,4)@xmath20 ( 64,22)(1,0)3 ( 70,22)(1,0)2.5 ( 67,20.5)(3,3)@xmath45 ( 72.5,20.5)(3,3)@xmath45 ( 75.5,20.5)(4,-3)4 ( 79.5,14.5)(3,3 ) ( 2,14)(0,1)6.5 ( 0,10)(4,4)@xmath20 ( 0.5,5)(3,3)@xmath45 ( 2,10)(0,-1)2 ( 2,5)(0,-1)1.5 ( 26,14)(0,1)6.5 ( 24,10)(4,4)@xmath20 ( 24.5,5)(3,3)@xmath45 ( 26,10)(0,-1)2 ( 26,5)(0,-1)1.5 ( 50,14)(0,1)6.5 ( 48,10)(4,4)@xmath20 ( 48.5,5)(3,3)@xmath45 ( 50,10)(0,-1)2 ( 50,5)(0,-1)1.5 ( 74,14)(0,1)6.5 ( 72,10)(4,4)@xmath20 ( 72.5,5)(3,3)@xmath45 ( 74,10)(0,-1)2 ( 74,5)(0,-1)1.5 ( 0.5,0.5)(3,3)@xmath45 ( 3.5,0.5)(4,-3)4 ( 7.5,-5.5)(3,3 ) ( 3.5,2)(1,0)8.5 ( 12,0)(4,4)@xmath20 ( 16,2)(1,0)3 ( 22,2)(1,0)2.5 ( 19,0.5)(3,3)@xmath45 ( 24.5,0.5)(3,3)@xmath45 ( 27.5,0.5)(4,-3)4 ( 31.5,-5.5)(3,3 ) ( 27.5,2)(1,0)8.5 ( 36,0)(4,4)@xmath20 ( 40,2)(1,0)3 ( 46,2)(1,0)2.5 ( 43,0.5)(3,3)@xmath45 ( 48.5,0.5)(3,3)@xmath45 ( 51.5,0.5)(4,-3)4 ( 55.5,-5.5)(3,3 ) ( 51.5,2)(1,0)8.5 ( 60,0)(4,4)@xmath20 ( 64,2)(1,0)3 ( 70,2)(1,0)2.5 ( 67,0.5)(3,3)@xmath45 ( 72.5,0.5)(3,3)@xmath45 ( 75.5,0.5)(4,-3)4 ( 79.5,-5.5)(3,3 )    ( 8,63)(0,0)[bc]@xmath46 ( 32,63)(0,0)[bc]@xmath47    ( 14,64)(0,1)2 ( 38,64)(0,1)2 ( 62,64)(0,1)2 ( 12,66)(4,4)@xmath60 ( 36,66)(4,4)@xmath60 ( 60,66)(4,4)@xmath60 ( 14,44)(0,1)2 ( 38,44)(0,1)2 ( 62,44)(0,1)2 ( 12,46)(4,4)@xmath60 ( 36,46)(4,4)@xmath60 ( 60,46)(4,4)@xmath60 ( 14,24)(0,1)2 ( 38,24)(0,1)2 ( 62,24)(0,1)2 ( 12,26)(4,4)@xmath60 ( 36,26)(4,4)@xmath60 ( 60,26)(4,4)@xmath60 ( 14,4)(0,1)2 ( 38,4)(0,1)2 ( 62,4)(0,1)2 ( 12,6)(4,4)@xmath60 ( 36,6)(4,4)@xmath60 ( 60,6)(4,4)@xmath60 ( 0,52)(-1,0)2 ( 24,52)(-1,0)2 ( 48,52)(-1,0)2 ( 72,52)(-1,0)2 ( -6,50)(4,4)@xmath60 ( 18,50)(4,4)@xmath60 ( 42,50)(4,4)@xmath60 ( 66,50)(4,4)@xmath60 ( 0,32)(-1,0)2 ( 24,32)(-1,0)2 ( 48,32)(-1,0)2 ( 72,32)(-1,0)2 ( -6,30)(4,4)@xmath60 ( 18,30)(4,4)@xmath60 ( 42,30)(4,4)@xmath60 ( 66,30)(4,4)@xmath60 ( 0,12)(-1,0)2 ( 24,12)(-1,0)2 ( 48,12)(-1,0)2 ( 72,12)(-1,0)2 ( -6,10)(4,4)@xmath60 ( 18,10)(4,4)@xmath60 ( 42,10)(4,4)@xmath60 ( 66,10)(4,4)@xmath60    the importance sampling scheme can be generalized to the @xmath0-state potts model with little effort . we are not going to repeat the complete scheme here .",
    "we only point out that following the set - up of section  [ sec : is ] , we have @xmath111    to draw @xmath81 according to @xmath80 , we apply    * _ draw _ @xmath82 $ ] * * for * @xmath83 * to * @xmath78 * @xmath112 * @xmath85 *   * _ draw _ @xmath113 _ randomly from _ @xmath114 *   * * end for *    the estimator in  ( [ eqn : estr ] ) is expected to have a small variance if the potts model is in a strong ( positive ) external magnetic field , see  ( [ eqn : pottskerneldual2 ] ) .",
    "if the potts model is at very low temperature , one might instead use the following algorithm based on uniform sampling    * _ draw _ @xmath82 $ ] * * for * @xmath83 * to * @xmath78 * @xmath115 * * end for *    here , @xmath116 denotes the floor function  @xcite .",
    "the importance sampling and uniform sampling algorithms become equivalent when @xmath117 for @xmath118 .    for known analytical results regarding the potts model see  ( * ? ?",
    "* chapter 12 ) and  @xcite .    everything as in fig .",
    "[ fig : ferising1 ] , but with @xmath119 $ ] . ]    everything as in fig .",
    "[ fig : ferising1 ] , but with @xmath119 $ ] . ]",
    "we apply the importance sampling and the uniform sampling schemes of section  [ sec : is ] to estimate the free energy  ( [ eqn : freeenergy ] ) per site , i.e. , @xmath120 , of the 2d and 3d ferromagnetic ising model and the 2d ferromagnetic potts model .",
    "everything as in fig .",
    "[ fig : ferising3 ] , but with @xmath121 $ ] . ]    everything as in fig .",
    "[ fig : ferising3 ] , but with @xmath121 $ ] . ]    in section  [ sec : numising ] , we consider 2d ferromagnetic ising models in an external field with spatially varying model parameters .",
    "we recall from section  [ sec : ising ] that the value of @xmath29 is invariant under the change of sign of the external field ; we set @xmath69 to make all the factors as in  ( [ eqn : isingkerneldual2 ] ) positive . in section  [ sec : numising3d ] , we consider 3d ising models defined on a cubic lattice .",
    "2d ferromagnetic potts models with spatially varying couplings in a positive external magnetic field , @xmath122 , are considered in section  [ sec : numpotts ] .",
    "all simulation results show @xmath120 vs.  the number of samples for  one instance \" of the models with periodic boundary conditions , where to create periodic boundary conditions we need to add extra edges ( with appropriate factors ) to connect the sites on opposite sides of the boundary . in this case @xmath123 . for different realizations of the ising model",
    ", we will report the histogram of the estimated free energy per site .",
    "we consider 2d ising models of size @xmath124 in all the experiments .    in our first two experiments we set @xmath125",
    "the coupling parameters are set to @xmath126 $ ] in the first experiment and to @xmath127 $ ] in the second experiment .",
    "simulation results for one instance of the model obtained from importance sampling ( solid lines ) and uniform sampling ( dashed lines ) in the dual factor graph are shown in figs .",
    "[ fig : ferising1 ] and [ fig : ferising2 ] .",
    "the estimated free energy per site is about @xmath128 and @xmath129 , respectively .    for very large coupling parameters ( corresponding to models at very low temperature ) ,",
    "convergence of uniform sampling is comparable to the convergence of the importance sampling algorithm , see  fig .",
    "[ fig : ferising1 ] .",
    "however , in fig  [ fig : ferising2 ] we observe that uniform sampling has issues with slow convergence for a wider range of coupling parameters , while the proposed importance sampling scheme performs well in all the ranges .",
    "histogram for @xmath130 realizations of the estimated free energy per site for a @xmath131 ising model , with @xmath132 $ ] and @xmath133 $ ] . ]    in our second two experiments we set @xmath134 $ ] . in the third experiment ,",
    "we set @xmath125 $ ] . fig .",
    "[ fig : ferising3 ] shows simulation results for one instance of the model obtained from importance sampling , where the estimated free energy per site is about @xmath135 .",
    "we set @xmath136 $ ] in the last experiment .",
    "for one instance of the model , the estimated @xmath120 from  fig .",
    "[ fig : ferising44 ] is about @xmath137 .",
    "we observe that convergence of the importance sampling algorithm improves as @xmath37 becomes larger ; see appendix  i.    fig .",
    "[ fig : hist2d ] shows the histogram of the estimated free energy per site for @xmath130 realizations of a @xmath131 ising model , with @xmath138 $ ] and @xmath139 $ ] . using the * r * package , the fitted normal distribution to fig .",
    "[ fig : hist2d ] has mean equal to @xmath140 and the standard deviation equal to @xmath141 .",
    "the method can be applied to ferromagnetic 3d ising models in an external field . in a model of size @xmath142 , we set @xmath143 $ ] and @xmath144 . for one instance of the ising model , simulation results for one instance of the model obtained from importance sampling ( solid lines ) and uniform sampling ( dashed lines ) on the dual factor graph are shown in fig .",
    "[ fig : ferising3d ] , where the estimated free energy per site , i.e. , @xmath120 , is about @xmath145 .    estimated free energy per site vs.  the number of samples for a @xmath146 ferromagnetic ising model in an external field with periodic boundary conditions , with @xmath147 $ ] and @xmath144 .",
    "the plot shows five different sample paths obtained from importance sampling ( solid lines ) and five different sample paths obtained from uniform sampling ( dashed lines ) on the dual factor graph . ]",
    "estimated free energy per site vs.  the number of samples for a @xmath131 ferromagnetic 3-state potts model in an external field with periodic boundary conditions , with @xmath148 $ ] and @xmath149 $ ] ( strong field ) .",
    "the plot shows ten different sample paths obtained from importance sampling on the dual factor graph . ]",
    "we consider a 2d @xmath150-state potts model of size @xmath124 in an external field , with @xmath151 $ ] and @xmath152 $ ] .",
    "for one instance of the model , fig .",
    "[ fig : ferpotts ] shows simulation results obtained from importance sampling on the dual factor for one instance of the model .",
    "the estimated free energy per site is about @xmath153 .",
    "an importance sampling scheme on the dual forney factor graph was proposed to estimate the partition function of 2d and 3d ferromagnetic ising and 2d ferromagnetic @xmath0-state potts models , when the models are in the presence of an external magnetic field .",
    "we described a method to partition the variables on the dual graph and introduced an auxiliary importance sampling distribution accordingly .",
    "the method can efficiently compute an estimate of the partition function under a wide range of model parameters , in particular ( with our choice of partitioning ) , when the models are in a strong external field . depending on the values of the model parameters and their spatial distributions , different choices of partitioning yield schemes with different convergence properties .",
    "for simplicity , we assume that the coupling parameter and the external field are constant , denoted by @xmath36 and @xmath154 , respectively .",
    "it is numerically advantageous to replace each factor as in  ( 10 ) in the dual factor graph by @xmath155 and each factor as in  ( 12 ) by @xmath156 the required scale factor @xmath157 to recover @xmath57 can be easily computed by multiplying all the local scale factors as @xmath158    note that , @xmath159 , therefore in a strong external magnetic field ( i.e. , large @xmath37 ) and at low temperature ( i.e. , large @xmath36 ) , @xmath160 and @xmath161 both tend to constant , which gives reasons for the fast convergence of uniform sampling in this case . in our importance sampling scheme ,",
    "independent samples are drawn according to @xmath80 in  ( [ eqn : auxdist ] ) , thus the only requirement to achieve fast convergence is having a strong external field .",
    "indeed , in the dual domain , convergence of the importance sampling algorithm improves as @xmath37 becomes larger , and convergence of uniform sampling improves as @xmath36 and @xmath37 both become larger , which is in sharp contrast with monte carlo methods in the original domain .",
    "we analyze the variance of the importance sampling algorithm for estimating the partition function of  finite - size \" 2d models more rigorously .",
    "let @xmath162 denote the global probability mass function in the dual forney factor graph .",
    "notice that @xmath163 and @xmath164 in  ( [ eqn : auxdist ] ) are both defined in the same configuration space @xmath165 .",
    "we can therefore write @xmath163 as a function of @xmath166 , as    r , c , l [ eqn : globdist2 ] p_(*x*_a ) & = & , * x*_a ^|| + & = & q(*x*_a)(*x*_b ) , * x*_a ^||    where @xmath167 is a linear combination of @xmath166 .",
    "the variance of @xmath168 in  ( [ eqn : estr ] ) can be computed as    r , c , l [ z _ ] & = & - ( ) ^2 + & = & ( z_q^2_q[^2(*x*_b ) ] - z_^2 ) [ eqn : varu ]    to remind ourselves that @xmath168 is a function of @xmath169 , we write it as @xmath170 .",
    "we then rewrite  ( [ eqn : varu ] ) as    r , c , l [ z_(l ) ] & = & ( ) ^2_q [ ^2(*x*_b ) ] - 1 + & = & _ * x*_a - 1 + & = & ^2(p_(*x*_a ) , q(*x*_a ) ) [ eqn : varbound ]    where @xmath171 denotes the chi - squared divergence , which is always non - negative , with equality to zero if and only if its two arguments are equal  ( * ? ? ?",
    "* chapter 4 ) .    in the limit @xmath172 , we have ( see also  ( [ eqn : isingkerneltanh1 ] ) )    r , c , l _",
    "|h| p_(*x*_a ) & = & q(*x*_a ) , * x*_a ^||    hence    r , c , l _",
    "|h| ^2(p_(*x*_a ) , q(*x*_a ) ) & = & 0 [ eqn : chilim ]    we conclude that @xmath173 can be estimated efficiently via the proposed importance sampling estimator when the model is in a strong external field .",
    "we briefly explain how to employ annealed importance sampling in the dual factor graph to estimate the partition function of the 2d ising model , when the model is not in a very strong external field .    for simplicity , we assume that the coupling parameter and the external field are both constant . the partition function is thus denoted by @xmath174 .",
    "we express @xmath174 using a sequence of intermediate partition functions by varying @xmath37 in @xmath175 levels as @xmath176    here , unlike typical annealing strategies in the original domain , @xmath177 is an increasing sequence with @xmath178 .",
    "( 76 , 37)(0 , 0 ) ( -1,11.9)(0,0)[bc]@xmath179 ( 2,12)(1,0)9 ( 11,10)(4,4)@xmath20 ( 15,12)(1,0)9 ( 13,14)(0,1)2 ( 11,16)(4,4)@xmath60 ( 37,10)(4,4)@xmath20 ( 37,16)(4,4)@xmath60    ( 37.4,6)(0,0)[bc]@xmath180 ( 63.1,6)(0,0)[bc]@xmath181 ( 54,12)(1,0)9 ( 67,12)(1,0)8 ( 78,11.9)(0,0)[bc]@xmath179 ( 24,10)(4,4)@xmath45 ( 34.5,2)(3,3 ) ( 45.5,12.5)(0,0)[bc]@xmath182 ( 50,10)(4,4)@xmath45 ( 60.5,2)(3,3 ) ( 63,10)(4,4)@xmath20 ( 24,2)(-1,0)2 ( 50,2)(-1,0)2 ( 24,22)(-1,0)2 ( 50,22)(-1,0)2 ( 65,14)(0,1)2 ( 24,20)(4,4)@xmath20 ( 50,20)(4,4)@xmath20 ( 24,0)(4,4)@xmath20 ( 50,0)(4,4)@xmath20 ( 18,0)(4,4)@xmath60 ( 44,0)(4,4)@xmath60 ( 63,16)(4,4)@xmath60 ( 18,20)(4,4)@xmath60 ( 44,20)(4,4)@xmath60    ( 26,31)(0,0)[bc]@xmath183 ( 26,-10.5)(0,0)[bc]@xmath183 ( 26,24)(0,1)6 ( 26,20)(0,-1)6 ( 52,24)(0,1)6 ( 52,20)(0,-1)6 ( 52,31)(0,0)[bc]@xmath183 ( 52,-10.5)(0,0)[bc]@xmath183 ( 26,4)(0,1)6 ( 26,0)(0,-1)6 ( 52,4)(0,1)6 ( 52,0)(0,-1)6 ( 28,10)(4,-3)6.5 ( 54,10)(4,-3)6.5 ( 28,12)(1,0)9 ( 41,12)(1,0)9 ( 39,14)(0,1)2 ( 28,10)(4,-3)6.5 ( 54,10)(4,-3)6.5 ( 28,12)(1,0)9 ( 41,12)(1,0)9 ( 39,14)(0,1)2    if @xmath184 is large enough , @xmath185 can be estimated efficiently via the proposed importance sampling scheme .",
    "as for the intermediate steps , a sampling technique that leaves the target distribution invariant ( e.g. , metropolis algorithms or gibbs sampling ) , is required at each level .",
    "these intermediate target probability distributions correspond to the intermediate partition functions .    here , we explain how gibbs sampling can be applied to draw samples in the dual forney graph of the 2d ising model .",
    "gibbs sampling is performed on @xmath73 ( i.e. , the variables on the bonds ) .",
    "each iteration @xmath186 , consists of visiting the bonds sequentially , from @xmath83 to @xmath78 , in the dual forney factor graph , and updating @xmath187 using gibbs sampling . in updating @xmath187 ,",
    "the value of @xmath188 is irrelevant .",
    "therefore , changing the value of @xmath189 will only involve a simultaneous change in the values of @xmath190 and @xmath191 .",
    "these variables ( edges ) are marked blue in  fig .",
    "[ fig:2dgridgibbs ] . at the end of the @xmath186-th iteration ( i.e. , when @xmath192 )",
    ", the gibbs sampling algorithm will generate @xmath99 and @xmath193 .",
    "the algorithm is iterated for a predetermined number of times at each level ; the last generated sample is usually used as the initial state of the gibbs sampler at the next level .",
    "the number of levels @xmath175 should be sufficiently large to ensure that intermediate target distributions are close enough and estimating @xmath185 is feasible ; see  @xcite .",
    "the author would like to thank hans - andrea loeliger , pascal vontobel , and justin dauwels for their comments that greatly improved the presentation of this paper .",
    "m.  molkaraie and h .- a .",
    "loeliger , `` partition function of the ising model via factor graph duality , '' _ proc .",
    "2013 ieee int . symp . on information theory , _",
    "istanbul , turkey , july 712 , 2013 , pp .",
    "23042308 .",
    "m.  molkaraie and h .- a .",
    "loeliger , `` monte carlo algorithms for the partition function and information rates of two - dimensional channels , '' _ ieee trans .",
    "information theory _ ,",
    "59 , pp .  495503 , jan .",
    "2013 .",
    "m.  molkaraie and h .- a .",
    "loeliger , `` extending monte carlo methods to factor graphs with negative and complex factors , '' _ proc .",
    "2012 ieee information theory workshop , _",
    "lausanne , switzerland , sept .  37 , 2012 , pp ."
  ],
  "abstract_text": [
    "<S> we propose an importance sampling scheme to estimate the partition function of the two - dimensional ferromagnetic ising model and the two - dimensional ferromagnetic @xmath0-state potts model , both in the presence of an external magnetic field . </S>",
    "<S> the proposed scheme operates in the dual forney factor graph and is capable of efficiently computing an estimate of the partition function under a wide range of model parameters . </S>",
    "<S> in particular , we consider models that are in a strong external magnetic field . </S>"
  ]
}