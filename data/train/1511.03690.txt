{
  "article_text": [
    "conventional automatic speech recognition ( asr ) systems utilize training data in the form of speech audio with parallel text transcriptions . in this paper , we investigate what is possible to do if those text transcripts were replaced with relevant visual images . given a dataset comprised of image scenes with accompanying spoken audio captions segmented at the word level , we propose a model capable of learning to associate spoken instances of the word `` dog '' with images of dogs , to name just one example .",
    "our model relies on a pair of convolutional neural networks ( cnns ) , one for images and another for speech , along with an alignment and embedding model .",
    "the outputs of the networks provide fixed - dimensional representations of variable - sized visual objects and spoken words , which are then mapped into a shared semantic embedding space .",
    "this allows us to align the words in the captions to the objects they refer to in the image scene . while a large body of research on jointly modeling images and text exists in the literature , we are not aware of any prior work that models the semantics of images and speech directly on the audio signal level .",
    "multimodal modeling of images and text has been an extremely popular pursuit in the machine learning field during the past decade , with many approaches focusing on accurately annotating objects and regions within images .",
    "for example , barnard et al .",
    "@xcite relied on pre - segmented and labelled images to estimate joint distributions over words and objects , while socher @xcite learned a latent meaning space covering images and words learned on non - parallel data .",
    "while these approaches focused on improving the identification of visual objects from a pool of predefined classes , other research has studied the problem of aligning text to the images or videos they describe .",
    "for example , kong et al .",
    "@xcite took visual scenes with high level captions , parsed the text , detected visual objects , and then aligned the two modalities with a markov random field .",
    "lin et al @xcite aligned semantic graphs over text queries to relational graphs over objects in videos to perform natural language video search .",
    "matuszek et al .",
    "@xcite employed separate classifiers over text and visual objects that shared the same label sets .",
    "a related problem is that of natural language caption generation . while a large number of papers have been published on this subject , recent efforts using recurrent deep neural networks @xcite have made tremendous progress and generated much interest in the field .",
    "while our work in this paper does not aim to generate captions for images , it was originally inspired by the text - to - image alignment models presented by karpathy in @xcite . in @xcite , karpathy uses a refined version of the alignment model presented in @xcite to produce training exemplars for a caption - generating rnn language model that can be conditioned on visual features . through the alignment process , a semantic embedding space containing both images and words is learned .",
    "other works have also attempted to learn multimodal semantic embedding spaces , such as frome et al .",
    "@xcite who trained separate deep neural networks for language modeling as well as visual object classification .",
    "they then embedded the object classes into a dense word vector space with the neural network language model , and fine - tuned the visual object network to predict the embedding vectors of the words corresponding to the object classes .",
    "this paper shares much of the same spirit as prior work on semantic embedding of images and words , but with a key difference - instead of dealing with text at the orthographic level , we learn a model which can derive meaning directly from spoken audio .",
    "our overarching goal is to be able to represent examples of spoken words , alongside examples of visual objects , as points in a single , high dimensional vector space .",
    "for example , in this vector space , we want different spoken examples of the word `` dog '' to neighbor one another , and also to neighbor image crops containing dogs . in order to do this ,",
    "we require some means to transform variable sized image crops as well as variable duration audio waveforms into fixed dimensional vector representations .",
    "further , we also require some way of coaxing these vectors into taking on the the property that semantically similar images and words neighbor one another . to achieve this ,",
    "we employ two separate neural network architectures , one for images and one for audio , which we then marry together with an embedding alignment model .      in order to detect a set of candidate regions in an image which are likely to contain meaningful objects",
    ", we use the region convolutional neural network ( rcnn ) model @xcite .",
    "the rcnn object detector works by first using selective search @xcite to build a large list of proposal regions , typically numbering in the thousands for a given image .",
    "each proposal region is then fed into a cnn object classifier , which is used to extract the activations of the penultimate layer of neurons in the network .",
    "these activations form a fixed - dimensional ( 4096 in @xcite , as well as our work ) feature vector representation of each proposal region .",
    "a set of one - versus - all support vector machines are then used to calculate detection scores over some set of classes for each region , and highly overlapping regions with similar classification scores are merged .",
    "finally , the remaining set of regions can be ranked in order of their maximum classification score across all classes . in our work , we follow @xcite and take the top 19 detected regions along with the entire image frame , resulting in 20 regions per image .",
    "we use the @xmath0 dimensional rcnn feature vectors to represent each region , which we will refer to as @xmath1      previous efforts @xcite to perform semantic alignment of text to objects in image scenes have benefited from the fact that text is naturally segmented into words , and all instances of the same word share the same orthography . on the other hand , segmenting continuous speech into words is nontrivial , and different spoken instances of the same underlying word will inevitably differ in not only their duration , but also in their acoustic feature representations as influenced by factors such as the microphone and speaker characteristics and the context in which the word was spoken .    while a speech recognition system is a reasonable solution for building a spoken interface for natural language image retrieval systems such as the one described in @xcite , in this work we are more interested in investigating the potential of neural networks to learn meaningful semantic representations which operate directly on the feature level .",
    "however , tasking our system with also performing word segmentation on the audio stream significantly complicates the problem at hand .",
    "we choose to take a step back from the text - based framework by pre - segmenting each spoken caption into a sequence of audio waveforms , each containing a single ground - truth word , and then throwing away the word identity of each segment .",
    "in @xcite , the authors trained a cnn isolated word recognizer and utilized it for n - best recognition hypothesis re - ranking ; here , we propose to use a similar cnn to model the spectrogram of each isolated word in the image captions .",
    "standard cnns expect their inputs to be of a fixed size , so in order to accommodate our variable duration words we follow @xcite and choose to embed their spectrograms in a fixed duration window , applying zero - padding and truncation when necessary .",
    "while @xcite found that a 2 second window was sufficient to capture the duration of 97% of the words in their corpus , in our case a 1 second long window is long enough to capture 99.9% of the words appearing in our data .    to create the spectrogram representing each word , we begin by performing forced - alignment of the audio to its ground truth text transcription in order to determine word boundary information .",
    "next , we apply a standard 25 millisecond window with a 10 millisecond shift to each word utterance , extracting log energy filterbank features for each window using 40 filterbanks spaced along the mel scale .",
    "next , we subtract the mean value and then apply variance normalization to the entire spectrogram .",
    "finally , we either pad with zeros or truncate equally on both sides to force the spectrogram to have a width of 100 frames , or 1 second .",
    "figure [ fig : spectrogram ] shows an example of what the input data to the network looks like for an instance of the word `` strategists '' .",
    "we rely on the caffe @xcite toolkit to train our networks and extract the word spectrogram features .",
    "our cnn architecture is as follows :    1 .",
    "pixel - by - pixel mean image spectrogram subtraction , with the mean spectrogram estimated over the entire training set ; 2 .",
    "convolutional layer with filters sized 5 frames by 40 features with a stride of 1 , vertical padding of 1 pixel on both the top and bottom , and 64 output channels with a relu nonlinearity ; 3 .",
    "local response normalization of width 5 , @xmath2 , and @xmath3 ; 4 .",
    "max pooling layer of height 3 , width 4 , vertical stride 1 , and horizontal stride 2 ; 5 .",
    "two fully connected layers of 1024 units each , with a dropout ratio of 0.5 and relu nonlinearities ; 6 .   a softmax classification layer        to extract vector representations for each word in some image caption ,",
    "we feed the word s spectrogram through the network and discard the softmax outputs , retaining only the activations of the @xmath4 dimensional fully connected layer immediately before the classification layer . for a given caption",
    ", we will refer to these vectors as @xmath5 , where @xmath6 is the number of words appearing in the caption .",
    "given an image - caption pair and their corresponding object detection boxes and word spectrograms , our task is to align each word with one of the detection boxes found in the image . to do this",
    ", we adopt the transform model from @xcite but with the objective function presented by @xcite .",
    "however , we replace the text modelling side of karpathy s models with our word spectrogram cnn , enabling us to align the image fragments directly to segments of speech audio .",
    "we provide a brief overview of the alignment model and objective here .",
    "let @xmath1 be the set of @xmath7-dimensional vectors representing the activations of the penultimate layer of the rcnn for each detected image region , as described in section [ ssec : rcnn ] .",
    "also let @xmath8 be the @xmath9-dimensional vectors representing the similar activations of the spectrogram cnn on each of the @xmath6 words in the spoken caption .",
    "the job of the alignment model is to map all of the @xmath10 and @xmath11 vectors into a shared , @xmath12-dimensional space where semantically related words and images have a high similarity .",
    "the alignment model is two - faceted , with separate transforms applied to the image vectors as well as the word spectrogram vectors .",
    "we use an affine transform , @xmath13 to map an image vector @xmath14 into the @xmath12-dimensional semantic embedding space . to map a word spectrogram vector @xmath15 into that same embedding space , we use a nonlinear transform , @xmath16 where @xmath17 is some element - wise nonlinear function .",
    "for the experiments in this paper , we set @xmath18 .    motivated by the assumption that the spoken caption @xmath19 for a given image @xmath20 should contain words which directly reference objects in the image , karpathy s objective function tries to assign a high similarity to matching image - caption pairs by `` grounding '' each word vector to one or more image fragment vectors .",
    "the inner product similarity between a given word embedding and an image fragment embedding is used to measure the degree of grounding , and each word in caption @xmath19 is given a score according to its maximum similarity across all image fragments from image @xmath20 .",
    "an overall image - caption similarity score is then computed by summing the scores of all words in the caption , thresholded below at 0 : @xmath21 where @xmath22 denotes the set of image fragments in image @xmath19 , and @xmath23 is the set of word spectrograms in caption @xmath20 .    in @xcite , karpathy uses a max margin objective function which forces matching image - caption pairs to have a higher similarity score than mismatched pairs , by a margin .",
    "given that @xmath24 denotes the similarity between a matching image - sentence pair , the cost is defined as : @xmath25 .",
    "\\end{split}\\ ] ] in practice , we use stochastic gradient descent to optimize this cost function in terms of the parameters @xmath26 .",
    "recent works on natural language image caption generation @xcite have utilized a number of datasets which contain images alongside human - generated text captions , such as pascal , flickr8k @xcite , flickr30k @xcite , and mscoco @xcite . however , none of these datasets include any speech data , so we decided to collect our own spoken audio for our experiments .",
    "because of its manageable size and ubiquitousness in the previous literature , we choose to use the flickr8k as the starting point for our data collection .",
    "flickr8k contains approximately 8,000 images captured from the flickr photo sharing website , each of which depicts actions involving people or animals .",
    "each image was annotated with a text caption by five different people , resulting in a total of 40,000 captions . to collect these captions",
    "the authors turned to amazon s mechanical turk , an online service which allows requesters to post `` human intelligence tasks '' ( hits ) .",
    "these hits are then made available to anonymous , non - expert workers , or `` turkers '' , who can choose to complete the tasks for a small amount of money .",
    "we turned to mechanical turk to collect spoken audio recordings for each of the 40,000 captions from the flickr8k dataset .",
    "we use the spoke javascript framework @xcite as the basis of our audio collection hit",
    ". spoke is a flexible framework for creating speech - enabled websites , acting as a wrapper around the html5 getusermedia api while also supporting streaming audio from the client to a backend server via the socket.io library .",
    "the spoke client - side framework also includes an interface to google s speechrecognition service , which can be used to provide near - instantaneous feedback to the turker .",
    "figure [ fig : spoke_interface ] displays a screenshot of the audio collection interface we used in our hits . a set of 10 random captions are displayed to the user , who can click the start / stop button to record their speech while they read each caption out loud .",
    "a playback button allows the turker to listen to their own recordings and diagnose any problems with their microphone or environment",
    ". spoke pipes the audio to the google recognizer , checks the recognition result against the prompt , and notifies the user if their speech could not be recognized accurately .",
    "the turker is then given the option to re - record the errorful caption .",
    "the hit can not be submitted until all 10 captions have been successfully recorded . in our experiments",
    ", we use a very simple metric for verification - 60% or more of the caption words must appear in the recognition result , regardless of ordering .",
    "we found this to be both lenient and sufficient - users rarely complained about the system correctly recognizing their speech , and 95.7% of the collected utterances were easily aligned to their caption text using our kaldi @xcite forced alignment system .",
    "the majority of the utterances flagged as unalignable were either empty or cut short , which we believe may have been due to client - server connection issues ; the problematic utterances were recollected by another round of hits .",
    "we paid the turkers 0.5 cents per spoken caption , resulting in at total cost of just over $ 200 including amazon s service fee .",
    "we collected speech from 183 unique turkers , with the average worker completing 218 captions .",
    "there were a handful of turkers who completed far more than the average number of captions , with the highest number collected from a single worker being 2,978 .    to further verify the integrity of our collected audio data , we split the 40,000 utterances into a 30,000 utterance training set , a 5,000 utterance development set , and a 5,000 utterance testing set , covering a 8,918 word vocabulary .",
    "our splits correspond with the training , validation , and testing splits given by @xcite .",
    "we then used kaldi to build a large vocabulary speech recognition system , adapting the standard wall street journal recipe for a gmm / hmm + lda + mllt + sat system for our data .",
    "we employed the training set to train the acoustic and language models , the cmu pronunciation lexicon , and the development set to tune the acoustic and language model weights .",
    "the final word error rate of our system on the test set was 11.67% , providing another indication that our data is relatively high quality . in order to preprocess the flickr8k data for our cnn",
    ", we employ this recognizer to force align the audio to the ground truth text transcripts and segment the audio at the word level .",
    "because the flickr8k corpus contains a small number of images and captions relative to datasets such as imagenet @xcite , we follow the example of @xcite and use the off - the - shelf rcnn provided by @xcite trained on imagenet to extract the 4096-dimensional visual object embeddings .",
    "similarly , we employ supervised pretraining for the word spectrogram cnn using the wall street journal si-284 split @xcite .",
    "this set contains roughly 82 hours of speech , from which we extracted all instances of words occuring at least 10 times in the data .",
    "this gave us a total of 612,108 words covering a vocabulary of size 6,010 , which we split 80/20 into training and testing sets .",
    "we used this data to train our word spectrogram cnn using the 6,010 word vocabulary as our output targets . even though this training is supervised",
    ", 6,749 of the unique words appearing in the flickr8k transcriptions ( 75% of the vocabulary ) do not appear in the training set for the spectrogram cnn .",
    "we use stochastic gradient descent with a learning rate of 1e-6 and momentum of 0.9 across batches of 40 images to train our embedding and alignment model , and run our training for 20 epochs .",
    "training is performed using the standard 6,000 image train set from the flickr8k data , using the accompanying 30,000 captions . at each batch",
    ", we randomly choose to use only one of the five captions associated with each image .",
    "we tried several different settings for @xmath12 , the dimension of the semantic embedding space , and found that values between 512 and 1024 seemed to work well , in line with @xcite .",
    "we also found that it was necessary to normalize the @xmath15 vectors to unit magnitude in order to prevent exploding gradients .",
    "to evaluate the alignment and embedding model , we follow the example of @xcite and use our model to perform image retrieval and annotation .",
    "image search is defined as choosing a caption from the test set and then asking the system to find which image belongs with the caption .",
    "image annotation is the opposite problem : choosing an image from the test set without its caption , and then asking the system to search over all the captions in the test set and find one of the five which belongs with the image .",
    "we report recall@10 as our evaluation metric , or the probability that the correct result is found in the top 10 returned hits .",
    "table [ tab : results ] details the results of our system ( `` spectrogram cnn '' ) , as well as a comparison to replacing the word spectrogram embeddings with 200-dimensional word vectors taken from @xcite .",
    "we also compare to socher et al .",
    "@xcite and karpathy @xcite .",
    "while our text + word vector system outperforms @xcite , the model is more similar to karpathy s refinements made in @xcite but with a single layer word embedding network rather than a bidirectional recurrent neural network .",
    "@xcite reports high recalls on the flickr30k data ( 50.5 search and 61.4 annotation ) , but does not include any results on the flickr8k data .",
    "although our spectrogram cnn does not perform nearly as well as any of the systems with access to the ground truth text , it massively outperforms a random ranking scheme .",
    "this is in spite of the fact that not only does the spectrogram cnn system not have direct access to the ground truth word identity of the caption words , but also that the cnn word embedding vectors are of dimension 1024 rather than 200 .",
    "we believe that these results are quite promising , and with more training data we expect to see substantial improvements .",
    "figure [ fig : visualizations ] displays several alignments of flickr8k images to their captions inferred by our system . while by no means perfect , our system reliably aligns salient objects in the images with their associated caption words .",
    "we also trained several different word spectrogram cnns with varying configurations .",
    "table [ tab : cnn_accuracies ] displays the top-1 and top-5 accuracies of a few of these networks . a two - layer conventional dnn with 1024 units per layer and relu",
    "nonlinearities achieved a classification accuracy of 75.5% , while adding a third layer brought that number even lower to 69.5% .",
    "we speculate that our training set is not large enough to train such a network .",
    "however , replacing the first fully connected layer with a 64-unit convolutional layer ( following the architecture described in section [ ssec : scnn ] ) boosted the accuracy to 84.2% .",
    "we also trained a network with two convolutional layers and one fully connected layer and achieved similar results to the network with only a single convolutional layer .",
    "we also explored varying the size and shapes of the convolutional filters , pooling layers , and dimension of the fully connected layers , but the network achieving 84.2% accuracy reflects our best performance .",
    "although these networks show a wide range of top-1 accuracies , it is interesting to note that their top-5 accuracies are all in excess of 90% .",
    "figure [ fig : cnn_filters ] displays the 64 filter responses from the first layer of our network .",
    ".image search and annotation results on the flickr8k test images ( 1000 images with 5 captions each ) . [ cols=\"^,^,^\",options=\"header \" , ]",
    "in this paper , we have presented our first efforts to construct a model which can learn a joint semantic representation over spoken words as well as visual objects . at training time",
    ", the model only requires weak labels in the form of paired images and natural language spoken captions .",
    "our system aligns salient visual objects in the images with their associated caption words , in the process building a semantic representation across both modalities .",
    "we evaluate our model on the flickr8k image search and annotation tasks , and compare it to several systems with access to the ground truth text .",
    "there are many avenues which we would like to take this research next .",
    "deeper investigation of the performance gap between cnn speech embedding and ground truth text systems is a logical first step , and increasing the amount of training data may shed some light on this .",
    "we would also like to incorporate word level segmentation into the alignment scheme , alleviating the need to use forced alignment and making our setting more realistic .",
    "lastly , while the neural networks used to extract features for both the visual objects and the spoken words are pre - trained in a supervised fashion on outside data , we believe that with a very large amount of data it may be possible to train them together along with the alignment and embedding model ."
  ],
  "abstract_text": [
    "<S> in this paper , we present a model which takes as input a corpus of images with relevant spoken captions and finds a correspondence between the two modalities . we employ a pair of convolutional neural networks to model visual objects and speech signals at the word level , and tie the networks together with an embedding and alignment model which learns a joint semantic space over both modalities . </S>",
    "<S> we evaluate our model using image search and annotation tasks on the flickr8k dataset , which we augmented by collecting a corpus of 40,000 spoken captions using amazon mechanical turk .    </S>",
    "<S> neural networks , multimodal semantic embeddings </S>"
  ]
}