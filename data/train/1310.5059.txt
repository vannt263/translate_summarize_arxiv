{
  "article_text": [
    "measurements are an essential part of quantum mechanics . in quantum communication , among other fields ,",
    "various measurements are used to extract information from signals . in quantum cryptographic contexts",
    "measurement results often allow the inference of how third parties are correlated with the obtained data .",
    "usually , the quantum advantage of these communication protocols is demonstrated in theoretical protocols utilizing abstract qubit systems , or other low dimensional systems .",
    "however , in physical realizations of quantum communication protocols , no qubit systems are available ; instead , one resorts to optical implementations where the signals and measurements are described on infinite - dimensional hilbert spaces corresponding to optical modes .    in the realm of quantum optics experiments , we are used to the idea of approximating these infinite - dimensional systems easily by lower dimensional descriptions , e.g.  describing parametric down - conversion experiments only on the level of vacuum and single photon pairs .",
    "we can do this because we can handle the approximations well on a theoretical level such that theoretical predictions and experimental verifications coincide with high precision .    in quantum cryptographic situations , such as quantum key distribution ( qkd ) or quantum coin tossing @xcite",
    "this is not good enough . in such contexts",
    ", we would have to account for the information that an arbitrary third party could gain about our measurement data . since experimental verification of third - party information is not possible",
    ", we need to be able to provide rigorous bounds on such compromised information .",
    "one possibility is to do full calculations in the infinite - dimensional hilbert spaces @xcite .",
    "often this is technically challenging . the other possibility is to do truncations to finite - dimensional subspaces",
    ". these can not be in the form of approximations , but as truncations that also hold under adversarial conditions .",
    "again , there are two possibilities",
    ". the traditional way would be to provide exact bounds on the effect of truncations and to extend the theoretical qubit analysis to accommodate the effects of the truncation .",
    "this approach has been followed , for example , in ref .",
    "@xcite in the context of a specific application , while a more general framework of this approach has recently been formulated in ref .",
    "@xcite . here",
    "we show a second way , which was already postulated in ref .",
    "@xcite , where the term `` squashing '' was coined for this approach .",
    "the squashing method performs a truncation of the hilbert space in such a way that provides a direct link between the optical implementation and the abstract low dimensional protocol , without the necessity to amend the theoretical analysis in the truncated hilbert space . in the context of qkd",
    ", this approach means that for a generic qkd protocol with a bb84 @xcite polarization encoding we can assume without loss of generality that single photons enter the detection device of the receiver .",
    "thus , our approach allows a truncation of high dimensional hilbert spaces to some low dimensional target space that also holds under adversarial conditions , as they occur in cryptographic contexts .",
    "we build on our earlier work @xcite that gave a well - defined notion of a squashing map that allows us to clarify the role of the squashing assumption .",
    "note that tsurumaru and tamaki @xcite independently investigated squashing models .",
    "( above ) has a general optical input @xmath0 , which is first measured by a receiver s measurement device @xmath1 , followed by classical postprocessing .",
    "the squashed measurement ( below ) has the same general optical input @xmath0 , which is then squashed by a map squash to a smaller hilbert space , followed by a fixed physical measurement @xmath2 .",
    "it is required that both of these measurements produce the same output statistics for all @xmath0 .",
    "[ squashidea ] ]    a rough idea of what a squashing model does is represented in fig .",
    "[ squashidea ] .",
    "each physical measurement device @xmath1 provides some basic distinguishable events for an input state @xmath3 , which usually has its support on a high dimensional hilbert space .",
    "all possible events that can be triggered by the states in the high dimensional hilbert space will formally correspond to a positive operator - valued measure ( povm ) @xmath4 .",
    "if one would feed the measurement device with states from some low dimensional hilbert space , then typically the number of possible events will be smaller .",
    "we refer the corresponding povm as to target povm and denote it by @xmath2 .",
    "often , however , the events produced by the states from the high dimensional and low dimensional hilbert spaces can be related by a classical postprocessing , which is applied to the basic events .",
    "a typical example in qkd is a processing of double clicks occurring in the bb84 protocol .",
    "the basic events after a particular ( classical ) postprocessing form a coarse - grained list of events , which then are described by a povm @xmath5 .",
    "we refer to the combination of basic events and postprocessing as the _ full measurement_. this classical postprocessing will be an essential tool in making squashing models work .",
    "a squashing model provides an equivalent but simplified description the full measurement @xmath5 on the high dimensional hilbert space in terms of the measurement @xmath2 on the low dimensional hilbert space . the map squash or squashing map ( see fig .",
    "[ squashidea ] ) provides a direct link between the measurements on the high dimensional and the truncated hilbert space .",
    "formally , the squashing map takes a state @xmath3 as input and outputs a ` squashed ' state @xmath6 on the truncated hilbert space .",
    "the squashing model is an equivalent description of the full measurement @xmath5 in terms of the squashing map and a target measurement @xmath2 on a squashed state @xmath6 .",
    "all elements ( basic measurement @xmath4 , target measurement @xmath2 , and classical postprocessing ) need to be specified in order to form a well posed question for the existence of a squashing model . a typical choice for the target measurement will be the restriction of the full measurement to a single - photon input , though our framework is not limited by this particular choice .",
    "in this article we first extend the formalism introduced in @xcite and provide a rigorous framework for how to find a squashing model for a particular measurement device and which general steps can be used in order to simplify the analysis .",
    "for example we show how to enforce the existence of squashing maps by choosing the postprocessing that introduce additional noise .",
    "second , we review previous results involving the squashing model for the measurement devices which are used in optical implementations of the bb84 @xcite and six - state @xcite qkd protocols with an active detection scheme .",
    "third , we discuss several generalizations of these measurement devices and find new squashing models for the corresponding devices .",
    "for instance , we present a squashing model for a generalization of the qubit measurement devices with the passive detection scheme to qudit measurement devices @xcite and prove that there exists a squashing model for this generalized device .",
    "we also consider squashing models for the measurements that accept different temporal modes and are employed in the phase encoded bb84 ( pebb84 ) protocol .",
    "this paper is organized as follows .",
    "the first part ( sections [ notsndefs ] - [ linoptimpl ] ) is devoted to the general framework and discussion of the general properties of the examples presented in the second part ( sections [ ssection : bb84active ] - [ application ] ) .",
    "some technical details relevant for our investigations are given in the appendix .",
    "in section [ notsndefs ] we fix the notation and define the quantities that will be frequently used .",
    "we will define the squashing model as well . in section [ genstrat ] we present general strategies for finding a squashing map for a general measurement device and discuss possible issues such as non - positivity of the squashing map .",
    "subsequently , in section [ linoptimpl ] , we consider common properties of typical linear optical measurement devices , which simplify the construction of the squashing model .",
    "in particular , we discuss how the usage of threshold detectors helps to truncate infinite - dimensional hilbert space of an optical mode and the consequences it has for the application of the general framework to concrete examples .",
    "in sections [ ssection : bb84active]-[section : qubitextensions ] we apply the presented theory in order to construct squashing models for several optical measurement devices . these include : active measurement devices from the bb84 qkd protocol ( section [ ssection : bb84active ] ) , from the six - state protocol ( section [ ssection:6stateact ] ) , biased active and passive measurements from the bb84 protocol , and passive measurement from the six - state qkd protocol ( section [ section : qubitextensions ] ) . in section [ rubenswork ]",
    "we present a new squashing model for measurement devices that can be used in the optical implementation of qudit qkd protocols . in section [ sectm ]",
    "we consider squashing models in the time domain , where the incoming state can carry multiple photons that are distributed over several time modes .",
    "we show that this generalization does not affect the existence of a squashing model .",
    "finally in section [ application ] we discuss the squashing model for the measurement device from the phase - encoded bb84 ( pebb84 ) protocol .",
    "this refines the security analysis of the corresponding qkd protocol , which was performed in refs .",
    "we first make some preliminary definitions so that we can define a squashing model explicitly .",
    "@xmath7 denotes a high dimensional hilbert space .",
    "basic and full measurements on a state @xmath8 are described by povms @xmath4 and @xmath5 respectively .",
    "@xmath9 denotes the low dimensional hilbert space ( i.e.  the target hilbert space ) .",
    "the measurement on the states @xmath10 ( the target measurement ) is described by the povm @xmath2 .",
    "elements of the corresponding povm are denoted by @xmath11 with @xmath12 , and the indices @xmath13 run over the set of outcomes for each of the measurements . observed probabilities for measurement outcomes are given by @xmath14 .",
    "moving forward to the formal definition of a squashing model we need to explicitly state what classical postprocessing means .",
    "the classical postprocessing is applied to the basic measurement outcomes and allows , for example , to combine different outcomes into one ( which we call coarse graining ) .",
    "more precisely , it defines the full measurement by using the basic measurement events such that the povm @xmath5 contains the same number of elements as the target povm @xmath2 .",
    "otherwise , the problem of finding a squashing model is not well - defined .",
    "formally , the postprocessing can be described as a stochastic matrix @xmath15 ( @xmath16 ) which acts on the vector of probabilities of the basic measurement outcomes .",
    "the entries of the matrix @xmath17 are given by the conditional probabilities which describe the redistribution of the outcomes of the povm @xmath4 with index @xmath18 into events of the full measurement povm @xmath5 with index @xmath13 .",
    "summarizing the above discussion we have the following    ( classical postprocessing)[cppdefn ] let @xmath19 be the vector of the outcome probabilities of the basic measurement @xmath1 .",
    "we say that a classical postprocessing ( cpp ) scheme is defined if there exists a stochastic matrix @xmath15 such that = @xmath20_bas , and the number of the outcome probabilities @xmath21 coincides with the number of events provided by the target povm @xmath2 .",
    "it is not hard to see that the postprocessing can be considered as a linear transformation of the povm elements f_m^(i)= _ j@xmath20_ijf_b^(j ) , [ pp ] where we require that @xmath22 describes the vector of outcome probabilities of the full measurement @xmath5 .    in our discussion",
    "we will not add a postprocessing step to the target measurement , as the choice of target measurement is usually motivated by circumstances .",
    "a typical example of this is when a security proof may exist for a fixed given measurement , which one then typically considers as a target measurement in the context of the squashing model . as the target measurement is given by a particular povm , it may already be a combination of some target measurements and fixed postprocessing of the target events .",
    "an example of this situation will be discussed in section [ application ] , where we construct a squashing model for the measurement device used in the phase encoded bb84 qkd protocol and will group certain target measurement events into one ( outside clicks ) .",
    "we will fix the notation and define the cpp and then we will give the formal definition of a squashing model .",
    "( squashing model)[defsquash ] let @xmath4 and @xmath2 be the povms that describe outcomes of a measurement performed by a physical device @xmath1 on states in high dimensional and low dimensional hilbert spaces respectively .",
    "let @xmath15 be a cpp scheme that defines a full measurement povm @xmath5 .",
    "then we say that there exists a squashing model for the device @xmath1 and the cpp @xmath15 if there exists a map @xmath23 such that    for any state @xmath24 the linear constraints @xmath25=@xmath26 \\right)$ ] , i[probcond ] are satisfied .",
    "@xmath23 is a completely positive ( cp ) map .",
    "we call it a `` squashing map '' .",
    "( linear constraints on povm elements ) we introduce the adjoint map @xmath27 to find that eq .",
    "( [ probcond ] ) implies @xmath25=@xmath28 { \\ensuremath{\\rho}}_m \\right)$ ] , i.[probcondadjoint ] this has to hold for any state @xmath24 . therefore _",
    "b^[f_q^(i)]=f_m^(i ) , i=1, ",
    ",n_q , [ linconstoperform ] which can be seen as linear constraints on the map @xmath29 the adjoint map has to satisfy _",
    "b^[@xmath30_q]&=@xmath30_m,[unital ] which is the unital property of the adjoint of the squashing map and assures that @xmath31 is completely positive and trace preserving ( cptp ) .    in order to gain more insight into the formal definition of the squashing model we make a few more remarks .",
    "the definition of the squashing model consists of two essential parts . in order to provide a squashing model for a given measurement device @xmath1",
    ", a particular low dimensional hilbert space must be chosen .",
    "second , one has to agree on a meaningful postprocessing , as defined in definition [ cppdefn ] .",
    "the classical postprocessing can be seen as a freedom available to search for a squashing model .",
    "that is , the postprocessing fixes the full measurement and has to satisfy the linear constraints in eq .",
    "( [ probcond ] ) , which has to be fulfilled by the squashing map @xmath23 .",
    "in fact , as we will see later on , for any choice of the povms @xmath4 and @xmath2 there always exists a cpp scheme for which a squashing model exists .",
    "however , as we will also see , such a squashing model may not be meaningful and would correspond to a very noisy outcome of the measurement .",
    "the squashing map @xmath23 has to be a cptp map .",
    "therefore its existence , given the constraints , can be investigated by exploiting the choi - jamiokowski isomorphism @xcite .",
    "note that variations of squashing models that require only positive but not completely positive maps have been investigated and utilized in ref .",
    "the formal definition of the squashing model already provides some intuition for how to investigate the question of whether a squashing model exists for a given measurement device .",
    "the goal of this section is to provide a step - by - step strategy to search for a squashing map for any particular case .      in our considerations",
    "we always assume that the exact physical model of the actual measurement device is known , so the povm @xmath4 is fixed .",
    "the choice of the target measurement depends on the choice of the truncated hilbert space and is always motivated by circumstances .",
    "for example , a theoretic analysis of a communication protocol with a specific povm @xmath2 might already exist and we would like to link an optical implementation with basic events @xmath4 to this analysis .",
    "so the main choice that has to be made to set - up a well defined search for a squashing map is that of the post - processing of the basic events into the full measurement events .",
    "we pointed out before that any valid classical postprocessing scheme has to assure that the number of events of the full and the target measurement coincide .",
    "there are further limitations on what types of classical postprocessing that can lead to a successful squashing map .",
    "we note that the set of the target povm elements @xmath32 may be linearly dependent which means that there may exist some complex numbers @xmath33 , such that _ i=1^n_q_i f_q^(i ) = 0.[eq : targetlindep ]    each set of povm elements of the corresponding basic measurement add up to the identity on the operator space .",
    "this also means that the full measurement ( including postprocessing ) must have the same linear dependency .",
    "this has implications for the postprocessing of the basic events , as this linear dependence has to be respected by the postprocessing @xmath15 one is looking for . due to the linearity of @xmath34 and the linear constraints in eq .",
    "( [ linconstoperform ] ) we can write _ i_if_q^(i)=0&_i_i f_m^(i)=0 + & _ i ,",
    "j_i@xmath20_ijf_b^(j)=0.[eq : lineardependancegeneral ] the simplest example of the situation where the target povm elements are linearly dependent is the qubit measurement in the bb84 qkd protocol .",
    "there , the sum of the elements of either basis is proportional to the identity operator and therefore it is not hard to find scalars @xmath33 such that eq .",
    "( [ eq : targetlindep ] ) holds .    using the vectorization of the povm elements it is convenient to rewrite eq .",
    "( [ eq : lineardependancegeneral ] ) as _",
    "@xmath35=0 _ i , j_i@xmath20_ij@xmath36=0 , where the vectorization @xmath37 gives an isomorphism between the linear bounded operators and vectors in corresponding spaces .",
    "considering @xmath38 for any @xmath13 as an @xmath13-th column of a matrix and writing @xmath39 gives : @xmath40 in summary , we have the following observation .",
    "( valid cpp schemes ) a valid postprocessing that allows for the existence of a squashing map is a stochastic matrix such that its transpose maps the null space of the matrix , built from the vectorizations of the basic povm elements @xmath41 , onto the null space of the matrix , built from the vectorizations of the target povm elements @xmath42 : @xmath20^t : @xmath43 @xmath44 .    note that this condition incorporates both the validity of a cpp scheme , as stated in definition [ cppdefn ] , and the requirement that the linear dependencies of the povm elements on the truncated and initial hilbert spaces has to be respected . hence if this condition is satisfied then there always exists a linear map connecting the full and the target measurements .",
    "the last constituent of a squashing model is the positivity of the squashing map ( the linear map from the previous section ) . in order to check for positivity",
    ", we employ the choi - jamiokowski isomorphism @xcite @xmath30_q^_b(@xmath45)0 , [ cjmatrix ] where @xmath46 is called the choi matrix and @xmath47 is a normalized maximally entangled state .",
    "this isomorphism is formulated directly from the action of the adjoint map @xmath48 .",
    "the property of complete positivity of the map @xmath48 is then equivalently expressed by the positivity of the corresponding choi matrix .    the linear constraints on the map @xmath48 are best expressed in terms of the so - called natural representation @xmath49 ( see appendix a for details ) .",
    "the direct link between the full and the target measurement in the natural representation is given by ^r @xmath50=@xmath51 .",
    "note that this automatically includes the condition for the map @xmath48 to be unital , as can be checked by summing over the index @xmath13 .    as a consequence",
    ", one can reformulate the problem of looking for a completely positive squashing map as a special instance of semi - definite programming ( feasibility problem ) @xcite :    find & 0 , + s.t .",
    "^r & @xmath50=@xmath51[sdpsquash ] .",
    "it is clear from the provided construction that the positivity of the choi matrix ( and therefore of the squashing map ) crucially depends on the choice of the classical postprocessing .",
    "in fact , as we will see in the next section and in section [ ssection:6statealternativecpp ] , if positivity is not achieved by the basic measurement it can be always repaired by choosing another valid postprocessing , though this will typically be at some price in terms of protocol performance .      in this section",
    "we point out two important facts : _",
    "( i ) _ we can always find a squashing model for any pair of target and basic measurements by choosing a suitable ( although very noisy ) post - processing which we call a _ trivial squashing model _ ( proposition [ alwayssquash ] ) . _",
    "( ii ) _ despite the fact that this trivial squashing model might , at first sight , appear useless , we can use its completely positive squashing map in order to restore the positivity of another squashing map that appears to be non - positive and therefore construct a _ non - trivial squashing model_. that will be the essence of the _ restoring theorem _ ( theorem [ mixedsquashmap ] ) .    to be more specific",
    "we provide an example for how a noisy squashing model can be used and then turn to the general case . a typical situation where we look for squashing models",
    "has the property that the target measurement corresponds to a restriction of the basic measurement to some simple subspaces , for example those of single - photon signals . in these cases ,",
    "one will usually try to make a smart choice of postprocessing , namely such that the postprocessing retains this property , i.e.  the restriction of the full measurement to the specified subspaces results in the target measurement .",
    "an example of such a cpp scheme arises in the context of the six - state measurements ( defined in section [ ssection:6stateact ] ) where one makes a random assignment of double - clicks ( when two detectors fire simultaneously ) , while keeping the single click events unchanged .",
    "as we will see , the squashing map constructed for this cpp scheme is not completely positive ( section [ sssection:6statencp ] ) .",
    "however , this positivity problem can be overcome by statistically mixing the smart postprocessing ( where single clicks events are unchanged ) with a noisy postprocessing that will also reassign single click outcomes ( see section [ ssection:6statealternativecpp ] ) .    to start out ,",
    "we introduce a postprocessing which allows the existence of a trivial squashing model .",
    "[ alwayssquash](trivial squashing map ) let @xmath52 be any complete set of povm elements that characterize the basic measurement and let @xmath53 be some complete set of povm elements that characterize the target measurement . let the classical postprocessing be such that it redistributes all basic events according to some a priori fixed probabilities , which are derived from a density matrix @xmath54 as @xmath55 and which do not depend on the input state .",
    "then there always exists a squashing model such that its map @xmath56 acts trivially on any input state @xmath0 , i.e.  @xmath57={\\ensuremath{\\rho}}_{fix}$ ] .    _",
    "proof : _ the statement of the proposition is a link between positivity of a squashing map for any type of basic and target measurements and a certain classical postprocessing .",
    "an idea of how such a post - processing scheme can be constructed , and which squashing map it corresponds to , is presented in fig .  [ unisquash ] .",
    "we apply a postprocessing which ignores the measurement result and assigns an outcome with fixed a priori probabilities @xmath55 compatible with some fixed quantum state @xmath54 .",
    "we define a map @xmath56 such that @xmath57={\\ensuremath{\\rho}}_{fix}$ ] for any @xmath0 . by construction",
    "this map is completely positive and fulfills the linear constraints of eq .",
    "( [ linconstoperform ] ) .",
    "@xmath58     that disregards the input and outputs a fixed state @xmath54 , which is prepared by a device @xmath59 .",
    "[ unisquash ] ]    before we show how this type of the squashing map is useful we need to point out an important property of its choi matrix .",
    "( properties of the choi matrix for the trivial squashing map)[noisyfullrank ] the minimum eigenvalue of the choi matrix of the trivial squashing map @xmath56 is proportional to the minimum eigenvalue of the state @xmath54 with the coefficient of proportionality @xmath60 , where @xmath61 is the dimension of the target hilbert space @xmath9 .    _",
    "proof : _ as defined in proposition [ alwayssquash ] @xmath62={\\ensuremath{\\rho}}_{fix}$ ] for any @xmath63 .",
    "therefore the adjoint map @xmath64 must satisfy @xmath65=@xmath66 \\right)$ ] for any bounded operator @xmath67 .",
    "this implies that ^_@xmath68_fix[@xmath69=@xmath65@xmath30_m which is reminiscent of the completely depolarizing map .",
    "then the choi matrix of the adjoint map is explicitly given by & _",
    "@xmath68_fix=@xmath30_q^_@xmath68_fix(@xmath45 ) + & = _ ij@xmath70@xmath71^_@xmath68_fix[@xmath70@xmath71][eq : taunoise ] + & = _ ij@xmath71@xmath68_fix@xmath70@xmath70@xmath71@xmath30_m=@xmath68^t_fix@xmath30_m , and so the assertion follows .",
    "@xmath58    it is clear that choosing such a postprocessing and constructing such a squashing model is not very clever , because one looses all useful data from the performed measurement and eventually winds up with a squashing model that produces only noise .",
    "nevertheless this tool turns out to be very useful in particular cases .",
    "in fact , as we will see now , proposition [ alwayssquash ] and remark [ noisyfullrank ] together imply that a positive squashing map can always be found by introducing some amount of noise on the measurement data .",
    "( restoring theorem)[mixedsquashmap ] let @xmath52 and @xmath73 be the basic and the target povm elements of the corresponding measurement devices respectively .",
    "let @xmath46 be a choi matrix , such that for classical postprocessing @xmath15 the linear constraints in eq .",
    "( [ sdpsquash ] ) are satisfied , but @xmath74 .",
    "then there exists a state @xmath54 and another postprocessing @xmath75 with intermediate amount of the added noise @xmath76 , which provides a squashing map with the choi matrix (p ) = ( 1-p)+ p_@xmath68_fix [ mixedchoi ] that is positive semi - definite whenever @xmath76 and @xmath54 are chosen according to _ min()(1-p)_min ( ) + p_min(@xmath68_fix)/d_q0 .",
    "[ eq : eigvalineqnoise ]    _ proof : _ first we note that due to proposition [ alwayssquash ] a completely noisy postprocessing exists that allows for a completely positive squashing map .",
    "now we look for an intermediate postprocessing that introduces less noise and where the corresponding choi matrix is still positive .",
    "this intermediate postprocessing will be chosen as a probabilistic mixture of the postprocessing @xmath15 and the noisy postprocessing @xmath77 from proposition [ alwayssquash ] , @xmath20 = ( 1-p)@xmath20 + p@xmath20_noise.[noisyscheme ] for the full measurement povm elements this implies f_m^(i ) = ( 1-p)f_m^(i ) + p f_noise , m^(i ) , so that we can construct an adjoint of the squashing map ^[f_q^(i ) ] = ( 1-p)^[f_q^(i ) ] + p^_@xmath68_fix[f_q^(i ) ] .",
    "the choice of the @xmath54 is of crucial importance here .",
    "we choose @xmath54 to have a full rank , so that the eigenvalues of the choi matrix in eq .",
    "( [ eq : taunoise ] ) are all strictly positive .",
    "for @xmath78 the new squashing map @xmath79 is completely positive ( proposition [ alwayssquash ] ) . for the rest of the parameter values",
    "we investigate the positivity of @xmath80 , which satisfies (p ) = ( 1-p)+ p_@xmath68_fix and where @xmath81 is given explicitly by eq .",
    "( [ eq : taunoise ] ) .",
    "since the second term in the last equation is strictly positive , which is guaranteed by our choice of @xmath54 and remark [ noisyfullrank ] , there exists a value of @xmath76 that is smaller than the trivial value @xmath78 and for which we still find @xmath82 and therefore a nontrivial complete positive squashing map @xmath79 .",
    "the amount of noise @xmath76 that guarantees the positivity of @xmath83 can be determined by comparing the minimal eigenvalue of @xmath46 ( which is negative ) and the minimal eigenvalue of @xmath54 ( which is positive ) .",
    "it follows from one of weyl s inequalities ( see for example chapter iii.2 in @xcite ) that the minimum eigenvalue of the sum of hermitian matrices is lower bounded by the sum of the minimal eigenvalues of each term which implies the positivity condition in eq .",
    "( [ eq : eigvalineqnoise ] ) _ min()(1-p)_min ( ) + p_min(@xmath68_fix)/d_q0 .",
    "@xmath58    to close the section we comment on the non - triviality of the map constructed in the last theorem .",
    "the existence of a positive @xmath84 for some @xmath85 implies that there exists a cpp scheme that allows a physical map which preserves some quantum properties of the input state ( a specific example will be given in section [ ssection:6statealternativecpp ] ) .",
    "this is especially important to know for applications such as verification of entanglement , which has , for example , applications as necessary conditions for qkd @xcite .",
    "the description of a general linear optical measurement device , that is , a device in which input modes undergo a linear transformation before entering detectors , can be rather complicated",
    ". a full description should include several different degrees of freedom .",
    "for example , incoming light can consist of several spatially separated or overlapping wave packets with an arbitrary number of photons , each with its various polarization or frequency .",
    "however , we restrict our analysis to measurement devices that only respond to particular degrees of freedom .",
    "this means that they are invariant in their statistics with a change in degrees of freedom they do not measure .",
    "specifically , in what follows , we consider measurement devices that can have different statistics given a change in photon number and polarization ( sections [ ssection : bb84active]-[rubenswork ] ) or in time ( see section [ sectm ] ) or in photon number and relative phase between two spatial modes ( section [ application ] ) .",
    "this implies that these measurement devices are invariant under changes in all other degrees of freedom , such as frequency .",
    "the existence of common attributes in optical measurement devices makes the application of the general framework discussed in the previous sections easier .",
    "the fact that one usually uses threshold detectors turns out to be especially helpful . as we will see shortly , this allows to decompose the hilbert space of the incoming signal and to construct the squashing map for @xmath86-photon input states for each @xmath87 independently .",
    "this will be the first reduction for the linear optical measurement devices .",
    "in addition , we show that for a special type of basic and target measurements there exists a particular cpp scheme that allows further decomposition in each of the @xmath86-photon subspaces that substantially simplifies the squashing model analysis .      one essential trick in managing the analysis of squashing models connecting infinite - dimensional mode spaces to finite - dimensional target measurements consists of exploiting the fact that the basic povm elements of linear optical measurement devices with threshold detectors commute with the povm elements of the qnd measurement of the total number of photons .",
    "this allows the reduction of the problem of analyzing input states on an infinite - dimensional hilbert space to the problem of analyzing input states on an infinite number ( @xmath87 ) of finite - dimensional hilbert spaces independently .",
    "formally , we can write qnd:@xmath68_n=0^@xmath68_n . [ eq : qndblockdiagstate ]    based on what was laid out above , we can assume without loss of generality that the squashing map first performs a qnd measurement of the total photon number , thus turning the input state into a block - diagonal form with respect to the photon number subspaces .",
    "it implies that we can check for the existence of a squashing model for each subspace separately .",
    "an important note here is that a cpp scheme has to be fixed before we start to search for a squashing model on the infinite family of finite - dimensional hilbert spaces .",
    "each of these squashing models have to share a common cpp scheme .",
    "all of the above can be summarized as follows .",
    "( reduction 1 : qnd)[obs : qndreduction ] for a linear optical measurement device with threshold detectors , any squashing map has a block - diagonal form with respect to the photon number subspaces : = _ n=0^_n[@xmath68_n ] .",
    "[ eq : qndreduction ]    note that for any @xmath86 the map @xmath88 is characterized by the same target measurement and its adjoint maps the target povm elements onto the full measurement povm elements projected onto the @xmath86-photon subspace .    one immediate consequence of the qnd measurement",
    "is the fact that one can split off the vacuum component and only consider states with @xmath89 . indeed , for @xmath90 , one can always choose @xmath91={\\ensuremath{| \\textnormal{vac } \\rangle_{q}^ { } \\langle \\textnormal{vac } |}}$ ] , where @xmath92 is the vacuum state in the target hilbert space .",
    "therefore the squashing map will output a vacuum state whenever the outcome of the qnd measurement is zero and we can restrict ourselves to the case where @xmath93 : _ n=0^_n[@xmath68_n]=@xmath94_n=1^_n[@xmath68_n ] .",
    "this will be referred to as the vacuum flag structure of the squashing map .",
    "note that the map @xmath95 is applied if and only if the outcome of the qnd measurement is 0 . later on in section [ ssection : bb846statepassive ] we will become acquainted with another map , which outputs a vacuum state on the target hilbert space , no matter what the input is .",
    "this `` vacuum map '' should not be confused with the vacuum flag , whose sole role is to split off the vacuum component of the signal .      for measurement devices with threshold photodetectors , for which the target measurement can be described as a restriction of the basic measurement to the single - photon subspace , the smart choice of a cpp scheme is such that the scheme does not affect the events which could have come from single - photon signals .",
    "these events are single - clicks .",
    "separating the single - clicks from the rest of events in this way will lead to a cpp scheme which assigns all multi - clicks to some single - clicks without performing any operation on single - click outcomes , so that overall full measurement povm elements are of the form f_m^(i)=f_b , single^(i)+_j @xmath20_ijf_b , rest^(j ) .",
    "[ eq : pporthocpp ]    for generic linear optical devices , @xmath96 has a form of a rank-1 projector on some state @xmath97 .",
    "if we denote a space spanned by single - click states by @xmath98 then any state from its orthogonal compliment @xmath99 triggers a multi - click with certainty .",
    "if the projection on @xmath100 commutes with full measurement povm elements we can investigate the existence of the squashing map for @xmath100 and @xmath99 separately .",
    "schematically this situation is represented in fig .",
    "[ fig : pportho ] .    .",
    "depending on the outcome of these measurements , one either proceeds with a low - dimensional squashing operation @xmath101 or outputs a completely mixed qubit state .",
    "[ fig : pportho ] ]    in summary we have the following observation .",
    "( reduction 2 : single - click subspace)[obs : pporth ] if a linear optical device with threshold photodetectors is such that    the reduction of the basic povm elements to a single photon subspace provides target measurement povm elements    the projection on the space @xmath100 , spanned by the states that can trigger only single click events , commutes with the full measurement povm elements , then there exists a cpp scheme that allows a decomposition of the squashing map of the form _",
    "n = _ p , n + _ p_,n .",
    "[ eq : pporthodecomp ]    both @xmath102 and @xmath103 map @xmath86-photon states to states on the same target hilbert space and fulfil the same set of linear constraints .",
    "in this section we consider a measurement device which is used in the optical implementation of the most prominent qkd protocol : the bb84 protocol @xcite .",
    "this device has been introduced in @xcite as a standard example used to introduce squashing models .",
    "we start off by providing a short background on the measurement device in the bb84 qkd protocol , where an observer actively makes the choice of the measurement basis .      in the active detection scheme for the bb84 measurement",
    "the observer has two detector modules , each adjusted to one of the polarization bases @xmath104 ( see fig .  [ pbsbb84 ] ) .",
    "before the measurement is performed one has to decide which detector module will be used .",
    "this represents the active nature of the detection scheme .",
    "note that there is no notion of an a priori probability distribution that governs the choice of the measurement basis yet , i.e.  the observer has no classical  coin \" at his disposal and therefore no randomness for the basis choice .",
    "a measurement with such randomness will be discussed in section [ ssection : bb84biasedactive ] .    ]",
    "each detector module is a polarization analyzer and consists of two detectors monitoring two outputs of a polarizing beam splitter , which is able to discriminate between two orthogonal polarizations of linearly polarized light .    in every measurement",
    "the observer will register four different events : no click ( vac ) , single - click ( sc ) in one of the detectors , and two different double - clicks ( dc ) , when both detectors ( @xmath105 and @xmath106 ) fire . assuming ideal threshold detectors , no photon losses and no dark counts the observed events are described by the following povm elements f_vac=&_=+,@xmath107 + f^i,_sc=&_n=1^@xmath108,[sceffects0 ] + f^_dc= & _",
    "n_0,n_1=1^@xmath109,where @xmath110 denotes a state with @xmath86 photons in the mode @xmath13 of the @xmath104-polarized _ incoming _ light ( cf .",
    "@xcite ) .    note that for each choice of @xmath104 one has a _ complete set _ of povm elements and _ no _ classical probability that may describe the basis choice .",
    "we start off by defining target povm elements .",
    "these correspond to a measurement on zero and single photon hilbert spaces and are given by ( cf .",
    "( [ sceffects0 ] ) ) f_vac=&_=+,@xmath107 + f^(0,)_1 & = @xmath111_@xmath112,[bb84qutrit ] + f^(1,)_1 & = @xmath113_@xmath114,where @xmath115 is a label for the basis choice of the polarizing beam splitter .    for a general input state",
    "we apply reductions from section [ linoptimpl ] in order to reduce the problem .",
    "first , in virtue of what is discussed in section [ section : qnd ] , we consider an input state of the bb84 measurement device that contains of @xmath86 photons and by using the flag structure of the vacuum events , we split off the vacuum component .",
    "this also simplifies the target space and makes it a space of a qubit with the following povm elements",
    "f^(0,)_1 = @xmath111_@xmath112 , f^(1,)_1 = @xmath113_@xmath114.[bb84target ]    second , the target povm elements ( eq .  ( [ bb84target ] ) )",
    "are restrictions of the general basic povm elements to the single - photon subspace .",
    "therefore we can apply the results of section [ section : orthosubspace ] and choose a cpp scheme that does not affect the single - clicks in order to be able to decompose @xmath88 into @xmath102 and @xmath103 .    to perform this decomposition",
    "we fix the cpp scheme by randomly ( with equal probability ) assigning each of the double - click events to a single - click event within the same basis .",
    "it follows directly from eq .",
    "( [ sceffects0 ] ) that the full measurement povm elements on the @xmath86-photon subspace are f^(b,)_n & = f^(b,)_sc , n + @xmath116f_dc , n^ + & = ( @xmath117_@xmath118 - @xmath119_@xmath120 ) + , [ bb84povms ] where @xmath121 corresponds to the 0 or 1 outcome of the detection module , and @xmath122 is a two mode fock state with photon numbers @xmath123 and @xmath124 with respect to the polarization mode basis @xmath104 . it is straightforward to see that the restriction of these elements to the @xmath125 subspace exactly reproduces the target povm elements .",
    "now we see that the full measurement povm elements eq .",
    "( [ bb84povms ] ) have the same structure of the povm elements in eq .",
    "( [ eq : pporthocpp ] ) .",
    "moreover , projections on the spaces @xmath126 and @xmath99 commute with the full measurement povm elements and therefore we can apply observation [ obs : pporth ] in order to search for a squashing map in @xmath100 and @xmath99 separately .      for any @xmath89 we can choose @xmath103 to be a trivial map @xmath127 from proposition [ alwayssquash ] and the choice @xmath128 .",
    "this is in accordance with the chosen cpp scheme , i.e.  the probability condition in eq .",
    "( [ probcond ] ) is fulfilled .",
    "thus we have determined the squashing map on the space @xmath99 and all that is left to find is a squashing map for the subspace @xmath100 , whose dimension in this case does not exceed 4 ( it is 2 for @xmath125 , 3 for @xmath129 and 4 for @xmath130 ) .",
    "as we mentioned in section [ genstrat ] we need two ingredients for this : _ ( i )",
    "_ we need to construct a linear map preserving linear dependencies as in eq .",
    "( [ eq : lineardependancegeneral ] ) and _ ( ii ) _ we need this map to be completely positive .",
    "we start off by writing down the linear constraints , which are respected by the chosen cpp scheme _",
    "p , n^=f^(b,)_p , n , \\{+ , } , [ linconstrbb84 ] where @xmath131 are the target measurement povm elements as in eq .",
    "( [ bb84target ] ) and @xmath132 are the full measurement povm elements restricted to the subspace @xmath100 .    using eq .",
    "( [ bb84target ] ) and eq .",
    "( [ bb84povms ] ) it is not hard to see that the linear dependencies are satisfied f^(0,)_1+f^(1,)_1=@xmath30_q f^(0,)_p , n+f^(1,)_p , n=@xmath30_p , n , . therefore there exists a linear map @xmath133 as in eq .",
    "( [ linconstrbb84 ] ) .",
    "the complete positivity of @xmath133 is proven by directly checking the non - negativity of the choi matrix .",
    "first , we use the decomposition of the maximally entangled state in terms of pauli matrices @xmath45=(@xmath30_q@xmath30_q + _ = x , y , z^t _ _ ) .",
    "[ eq : mesinpaulis ] therefore the choi matrix is given explicitly by    _",
    "p , n = @xmath30_p , n^(@xmath45)=(@xmath30_q@xmath30_m + _ = x , y , z^t__p , n^ ( _ ) ) .",
    "second , we note that the pauli matrices @xmath134 and @xmath135 can be written in terms of the target povm elements : @xmath136 , @xmath137 . the action of the @xmath133 on @xmath138 , however , is not fixed by our linear constraints and we can use this freedom in order to enforce the positivity of the choi matrix @xmath139 .    for the upcoming discussion it is convenient to decompose @xmath140 , with _",
    "p , n , open=_y^t_p , n^(_y ) . in order to check the positivity of @xmath139 we will consider its matrix representation @xmath141 using the non - orthogonal basis vectors \\{@xmath142@xmath143}_j=0,1 , @xmath142\\{@xmath117_,@xmath119_}_=+ , . [ bb84basis ]    the matrix @xmath144 only has real entries ( its explicit form is given by eq .",
    "( [ bb84exact ] ) in the appendix ) .",
    "the properties of the matrix @xmath145 can be specified further : first , without loss of generality , we can assume that @xmath146 only has real entries .",
    "if there exists a complex solution @xmath146 for @xmath147 then its complex conjugate is also a solution . then by linearity",
    "the equal weighted average is also a solution and it is a real matrix .",
    "second , since the open part @xmath148 is hermitian ( otherwise the choi matrix would have complex eigenvalues ) , we can write @xmath149 where @xmath150 is some skew symmetric matrix with 6 real entries as free parameters . these free parameters can be found such that @xmath151 holds ( see eq .",
    "( [ bb84solutions ] ) ) .",
    "therefore , there exists a positive @xmath139 which maps the specified target measurements to the corresponding full measurements .",
    "this implies that there is a squashing map on the space @xmath100 , which is completely positive and fulfills the linear constraints in eq .",
    "( [ linconstrbb84 ] ) .",
    "as pointed out above , the squashing map on the complementary space @xmath99 also exists .",
    "therefore , for the choice of the classical postprocessing we made , we provided a squashing map for the target measurement in eq .",
    "( [ bb84target ] ) .",
    "this squashing map has been found also by tsurumaru and tamaki @xcite .",
    "in summary in this section we proved the following .",
    "( squashing model for bb84 measurement with active basis choice ) there exists a squashing model with the qubit target measurement for the bb84 measurement with active basis choice and random equiprobable assignment of double - clicks to one of the outcomes ( i.e.  independent from how often one decides to choose one or the other basis ) .",
    "in this section we will focus on a squashing model for a measurement device which is used in optical implementations of the six - state qkd protocol @xcite .",
    "the six - state measurement is similar to the bb84 measurement , except that there is a third setting to the polarizing beam splitter which splits photons according to a circular basis ( labeled as @xmath152 ) .",
    "the measurement basis is chosen actively by the observer .      in full analogy to the bb84 measurement",
    "we want to make use of the reductions in section [ linoptimpl ] .",
    "first of all we reduce the problem and consider @xmath86 photon incoming signals for @xmath153 .    for the six - state measurement device",
    "we choose the target measurement to be a measurement on the zero and single photon hilbert space . after splitting off the vacuum component , the target povm elements are f^(0,)_1 = @xmath111_@xmath112 , f^(1,)_1 = @xmath113_@xmath114 , [ sixstatetarget ] with @xmath154 .    as with the bb84 measurement",
    "these povm elements are restrictions of the basic povm elements , which suggests to choose the same type of classical postprocessing as we did for the bb84 protocol : the postprocessing of double click events is randomly assigned again to either single detection events .",
    "the probabilities of the  0 \" and  1 \" assignments are equal , @xmath155 .",
    "this cpp scheme fixes the full measurement povm elements to f^(b,)_n= ( @xmath117_@xmath118 - @xmath119_@xmath120 ) + , [ eq:6statefull ]    this cpp scheme allows us to apply the second reduction and restrict our search to a six - dimensional subspace @xmath100 spanned by @xmath156 , @xmath157 , and its complement @xmath99 . similarly to the active bb84 measurement the projections onto @xmath100 and @xmath99 commute with the full measurement povm elements in eq .",
    "( [ eq:6statefull ] ) .",
    "the linear constraints on the squashing map in the six - dimensional subspace @xmath100 are given by : _",
    "p , n^=f^(b,)_p , n , \\{x , y , z}. [ linconstr6state ]    in this case , one can follow the calculation for the bb84 protocol .",
    "the only difference is that the matrix @xmath139 , that represents the squashing map , is completely determined by the linear constraints since the measurement operators @xmath131 form a complete basis for their hilbert space .",
    "however , it can be easily seen that @xmath102 can not be positive .",
    "first , we can write the adjoint squashing map @xmath158 as before .",
    "since the qubit measurements of the six - state protocol are complete , we can write    _ p , n=@xmath30_p , n^(@xmath45)=(@xmath30_q@xmath30_p , n + _ = x , y , z ^t_(f^(0,)_p , n - f^(1,)_p , n ) ) .",
    "[ choimatrix6state ]    as in the bb84 case , we can directly apply @xmath133 to the second subsystem that does the map @xmath159 . in this case , the choi matrix @xmath139 is completely fixed and has no free parameters since the linear constraints in eq .",
    "( [ linconstr6state ] ) have to be respected .",
    "however , the matrix @xmath139 has negative eigenvalues . by writing @xmath139 in a basis of non - orthogonal vectors , which is analogous to that for the bb84 measurement device in eq .",
    "( [ bb84basis ] ) : \\{@xmath142@xmath143}_j=0,1 , @xmath142\\{@xmath117_,@xmath119_}_=x , y , z , [ 6statebasis ] we can calculate the minimum eigenvalues directly .",
    "for example in the three photon subspace , the state @xmath160=(@xmath161_z@xmath162-@xmath163_z@xmath164 ) has the property that @xmath165 , which obviously violates the positivity condition of the squashing map .",
    "therefore we conclude that for the choice of the classical postprocessing we made there is no complete positive squashing map onto target measurement given by eq .",
    "( [ sixstatetarget ] ) .      as we mentioned in section [ noisycpps ] ,",
    "the lack of complete positivity of the squashing map is not always a big obstacle and can be overcome by introducing some additional noise to the measurement data .",
    "this is done by choosing another cpp scheme .",
    "we will apply this trick for the six - state active measurement device and show that the amount of noise one needs to introduce is tolerable in qkd implementations .",
    "we start by describing a new classical postprocessing . this will be a mixture of the old postprocessing and the completely noisy postprocessing that corresponds to the random assignment of an outcome regardless of which basic event occurred ( cf .",
    "( [ noisyscheme ] ) ) . for this type of postprocessing",
    "there is a positive squashing map @xmath127 with @xmath166 ( cf .",
    "theorem [ mixedsquashmap ] and remark [ noisyfullrank ] ) .",
    "we use eq .",
    "( [ mixedchoi ] ) with @xmath167 and @xmath166 to achieve the choi matrix for new squashing map _",
    "p , n , new(p)=(1-p)_p , n + @xmath30_q@xmath30_p , n , [ eq : sixstatepovmnewold ] where @xmath139 is from eq .",
    "( [ choimatrix6state ] ) .    in order to check the positivity of @xmath168",
    "we can again represent it in the basis of eq .",
    "( [ 6statebasis ] ) as a @xmath169 matrix of the parameters @xmath86 and @xmath76 , and show the positivity of its eigenvalues for @xmath170 .",
    "the proof is given in appendix d.    next we point out a connection between the parameter @xmath76 and an additional penalty bit error rate @xmath171 in the six - state protocol , which one needs to introduce in order to ensure the positivity of the squashing map .",
    "( connection between white noise parameter and bit error rate ) the white noise parameter @xmath76 corresponds to the double bit error rate which one needs to introduce as a penalty for a positive squashing map to exist .",
    "that is @xmath172 .",
    "_ proof : _ the essential point for this is the fact that for the old full measurement povms we have f^(0,)_n , old + f^(1,)_n , old=@xmath30_n . substituting this equation in eq .",
    "( [ eq : sixstatepovmnewold ] ) will result in f^(0,)_n , new&=(1-p/2 ) f^(0,)_n , old + f^(1,)_n , old , + f^(1,)_n , new&=(1-p/2 ) f^(1,)_n , old + f^(0,)_n , old.this relates the full measurement povm elements after additional noisy postprocessing to the elements before the postprocessing .",
    "this relation concerns one particular measurement basis and can be interpreted as an additional bit flip with probability @xmath173 after all double clicks have been assigned .",
    "@xmath58    it follows from the last remark that we need to add @xmath174 of noise to our data in order for squashing map of the six - state protocol to be completely positive .    to summarize we showed that the following statement holds .",
    "( squashing model for six - state measurement with active basis choice)[thm:6stateactivesquasher ] there exists a squashing model with a qubit target measurement for the six - state measurement with active basis choice ( no matter how often one chooses to measure in one of the three bases ) for the cpp scheme that randomly ( with equal probability ) assigns the double clicks to single clicks and flips the single click bit values with probability 1/6 .    to conclude this section we point out that the recent results by ma and ltkenhaus @xcite allow us to say that this penalty error rate only needs to be used to estimate the amount of privacy amplification necessary for the protocol . as a matter of fact , we do not actually need to flip any bits and can therefore effectively reduce the amount of information leaking to the eavesdropper . in this case",
    "the squashing model can be used for the protocol with one - way classical communication and one can provide a secret key rate for an error rate up to @xmath175 if one uses the infinite - key - limit formula @xmath176 ( see eq .",
    "( a6 ) in ref .",
    "@xcite ) with @xmath177 , where @xmath178 is a bit error rate and @xmath179 the flip probability from theorem [ thm:6stateactivesquasher ] .",
    "this section is devoted to several generalizations of the ideas that were laid out in sections [ linoptimpl ] - [ ssection:6stateact ] .",
    "first we investigate a biased active bb84 measurement .",
    "then we turn our attention to the passive detection scheme ( defined below ) for the bb84 and six - state measurement devices .",
    "such devices are also often used in practical implementations of qkd protocols , which is often motivated by the fact that a passive detection scheme requires fewer random bits and typically allows higher clock - rates ( see e.g.  @xcite ) .",
    "we start off by generalizing the squashing model for the bb84 measurement to a device where the observer chooses the measurement basis according to classical probabilities @xmath180 and @xmath181 such that @xmath182 .",
    "that is , the active `` at will '' choice of the observer is replaced by a random number generator .",
    "this will result only in a coefficient in front of the povm elements in eq .",
    "( [ sceffects0 ] ) f_vac=&_=+,p_@xmath107 , + f^i,_sc=&p__n=1^@xmath108 , + f^_dc= & p__n_0,n_1=1^@xmath183,and will not affect the rest of the argument we made in section [ ssection : bb84active ] .",
    "therefore we have the following theorem .",
    "( squashing model for biased active bb84 measurement ) there exists a squashing model for the biased active bb84 measurement for which the basis choice is made according to classical probabilities @xmath180 and @xmath181 such that @xmath182 .      in this section we will present the details for the passive bb84 measurement .",
    "the passive six - state measurement can then be generalised straightforwardly .    in the passive bb84 measurement",
    "the observer uses a measurement device presented in fig .",
    "[ pasivebb84 ] .",
    "the whole measurement device consists of two detection modules that correspond to two detection bases .",
    "both detection modules are positioned at the two output ports of a 50/50 beam splitter .",
    "this measurement outputs a bit value and a basis choice .    ]",
    "interestingly , this type of detection scheme is more sensitive to the signals containing more than one photon . indeed , because of the @xmath184 beam splitter ( cf .",
    "( [ 5050bs ] ) in the appendix ) the povm elements will take the form ( see also @xcite ) f_vac&=@xmath116_=+,@xmath107 , + f^i,_sc&=_n=1^(@xmath116)^n@xmath185 , i=0,1 , [ sceffects ] + f_dc^ & = @xmath116_n_0,n_1=1^@xmath183 , + f_cc & = @xmath116@xmath30 + _ i=0,1_n=1^(1-)@xmath108 , [ sceffects2 ] where  sc \" ,  dc \" and  cc \" denote single clicks , double clicks within the same detection module , and cross - clicks between different modules respectively .      a closer comparison of fig .  [ pbsbb84 ] and fig .",
    "[ pasivebb84 ] reveals an important relationship between the two detection schemes .",
    "first note that the single - click povm elements are the same ( up to an @xmath86-dependent coefficient ) for both detection schemes . as we will see",
    "shortly , this can be crucial for the positivity of the squashing map .",
    "in fact , an active detection scheme can be generally represented as a part of the passive detection scheme with a beam splitter which acts as a probabilistic classical switch .",
    "entering the measurement device .",
    "[ fig : switchingscheme ] ]    indeed , the initial beam splitter is only rerouting all photons in one direction or the other direction or splitting - up the photons .",
    "so we can think of it like a classical switch which either decides between the two polarization bases like in an active scheme , or splits up the photons thus creating cross - clicks .",
    "the probability for the first two cases are the same , so we can combine them into the problem of active detection in fig .",
    "[ fig : switchingscheme ] .",
    "therefore we can think of the passive detection scheme as of a scheme consisting of two parts : with probability @xmath186 the system chooses to apply an active detection set - up , and with probability @xmath187 the system chooses to create a cross - click .",
    "to give an example , for the passive bb84 measurement in fig .",
    "[ pasivebb84 ] we have @xmath188 .",
    "as we will see now , this structure turns out to be very useful for the construction of squashing models and especially for choosing the right cpp scheme for passive detection devices .      according to the previous section , we can rely on our knowledge of the active detection scheme and consider the cross - click events separately .",
    "as it turns out , since there exists a squashing model for the active detection scheme ( see section [ ssection : bb84active ] ) , we can either discard all cross - clicks or assign them to some bit value with some probability .    to be more precise ,",
    "let us define two different cpp schemes for the part of the squashing model that deals only with cross - clicks ( cf .",
    "[ fig : switchingscheme ] ) and hence leads to two different overall squashing maps ^discard_n , passive & = _ n , active + ( 1-)_vac + ^keep_n , passive & = _ n , active + ( 1-)_@xmath30_q/2,[eq : bb84switcher ] where the vacuum map @xmath189 disregards the input and forwards a vacuum state to the target measurement ( not to be confused with the vacuum flag ( see the closing remark in section [ section : qnd ] ) ) .",
    "we refer to @xmath190 as the squashing map corresponding to the overall postprocessing that discards all cross - clicks and we refer to @xmath191 as the squashing map that corresponds to the cpp scheme with random ( in this case with equal probabilities , because of the passive target measurement ) assignment of cross - clicks .",
    "note that in principle we can choose the assignment of cross - clicks according to some other ( non - uniform ) probability distribution .",
    "it will only mean that we would need to change @xmath54 in @xmath56 accordingly , but it will not affect the positivity of the squashing map , as long as @xmath54 corresponds to a physical state .    finally , the positivity of both passive maps in eq .",
    "( [ eq : bb84switcher ] ) for the bb84 case follows from the positivity of the maps on the right hand side of eq .",
    "( [ eq : bb84switcher ] ) , which is in contrast to the six state measurement considered in the next section .",
    "to summarize we have the following theorem .",
    "( squashing model for the passive bb84 measurement)[thm : squasherbb84passive ] for the passive bb84 measurement there is a squashing model with a qubit target measurement no matter what the classical postprocessing of the cross - clicks is , as long as there is a squashing model with a qubit target measurement for cross - click events .",
    "for the six - state measurement device with the passive detection scheme we can use the same argument as we did in the last section for the bb84 measurement device . here",
    "however we can not rely on the positivity of the squashing map for the active part of the model because as we learned in section [ ssection:6stateact ] the map is not completely positive . in virtue of this",
    "we can not simply discard all cross - clicks and we have to fall back to their random assignment .",
    "we still will be using the map @xmath192 , although it is not physical , as a tool to show the complete positivity of the overall map ( see below ) .    assuming that we assign cross - clicks with equal probabilities we have the overall squashing map of the type ^keep_n , passive = _",
    "n , active + ( 1-)_@xmath30_q/2 .",
    "the positivity of this squashing map will be , as per usually , investigated in terms of its choi matrix : ^keep_n , passive=_n , active + ( 1- ) .",
    "note that the chosen cpp scheme allows us to apply reduction 2 here ( observation [ obs : pporth ] ) and consider the choi matrix only on the single - click subspace @xmath100 : @xmath193 .",
    "the positivity of @xmath193 was discussed in eq .",
    "( [ eq : sixstatepovmnewold ] ) where we concluded that this matrix is positive whenever @xmath194 and takes values @xmath195 $ ] , which is the case for any @xmath196 .",
    "therefore , all eigenvalues are positive and we have shown the following .    ( squashing model for the passive six - state measurement ) for the passive six - state measurement device there exists a squashing model if the classical postprocessing randomly assigns ( with equal probability ) the double - clicks to a bit value within the same basis where the double - click has occurred , and assigns the cross - clicks randomly ( with equal probability ) to one of the possible bit values .",
    "in the previous section we discussed squashing models for measurement devices for which it was self - evident to choose a qubit measurement as the target measurement . a possible way to generalize the results of sections [ ssection : bb84active ] and [ ssection:6stateact ]",
    "is to consider a qudit measurement device as the target instead . here",
    "we present a general result for the passive detection scheme in the case of a qudit target measurement , with @xmath197 being a prime number .",
    "note that we only consider passive devices since this generalization includes the six - state measurement device , for which an active choice does not work ( see section [ ssection:6stateact ] ) .",
    "we will be setting the stage by recapitulating some known facts about mutually unbiased bases ( mubs ) and the reader who is familiar with this notion can skip the next section without losing the thread of the paper .",
    "first we recall the definition of mubs .",
    "( mub ) let @xmath198 and @xmath199 be two orthonormal bases in the hilbert space @xmath200 .",
    "these bases are called * mutually unbiased * if |@xmath201|= , i , j    the existence of a @xmath202 mub , if @xmath197 is a prime number , was proven in ref .",
    "the proof is constructive .",
    "each basis consists of the eigenvectors of z_d , x_d , x_d z_d , x_d ( z_d)^2 ,  , x_d ( z_d)^d-1 , [ mubgenerators ] where @xmath203 and @xmath204 are generalized pauli matrices with the properties z_d@xmath143=w^j@xmath143 , x_d@xmath143=@xmath205 , where @xmath206 is the @xmath197-th root of unity .",
    "the basis of @xmath203 is referred to as the standard basis .",
    "it is possible to represent all other matrices in eq .",
    "( [ mubgenerators ] ) in terms of the standard basis .",
    "this gives an explicit relationship between different bases representations z_d^k&=",
    "_ i=0^d-1^ik@xmath207 , + ( x_d z_d^)^k&= _ i=0^d-1^k ( i+@xmath116(k - 1))@xmath208 [ eq : mubrelationship ] + & = _",
    "i=0^d-1^ik@xmath209,where @xmath210 .",
    "one more fact that we will be using quite often is that the operators z_d^,(x_d z_d^)^k , = 0,  ,d-1,k=1,  ,d-1 [ quditbasis ] form a basis in the space of all operators acting on the hilbert space of a qudit @xmath211 .",
    "the measurement device for the multi - state protocol is schematically represented in fig [ mubapparatus ] .",
    "it measures in @xmath202 different polarization bases . for each basis",
    "there are @xmath197 different polarization states that are detected by one of @xmath197 threshold photodetectors in a corresponding detection module @xmath212 , @xmath213 .",
    "note that the described measurement device contains the passive six - state measurement , if one assigns @xmath214 for @xmath215 .",
    "it qkd protocol ( where @xmath197 is a prime number ) . after passing the input beam splitter , which distributes the signals into @xmath202 arms with probabilities",
    "@xmath216 with @xmath213 , the input state is measured in one of the @xmath202 mutually unbiased bases .",
    "each basis measurement contains @xmath197 different threshold photodetectors corresponding to @xmath197 different polarization states within the basis @xmath104 .",
    "there are @xmath217 polarization states in total .",
    "[ mubapparatus ] ]    from now on we will consider the situation where @xmath218 for all @xmath213 ( possible generalizations will be considered in the closing part , [ ssection : mubconclusion ] , of this section ) .",
    "since our measurement device contains threshold photodetectors we can perform a qnd measurement of the number of photons and split off the vacuum component first ( see observation [ obs : qndreduction ] ) .",
    "hence we can restrict ourselves to inputs containing @xmath89 photons . in the @xmath86-photon subspace the basic povm elements have the following form ( see appendix e for more details ) f_n^i,&=(d+1)^-n@xmath219 + f_mc , n^&=(d+1)^-n(@xmath30_n-_i=1^d@xmath219 ) [ mubbasicpovm ] + f_cc , n & = ( 1-)@xmath30_n , with @xmath220 and @xmath110 is adopted to describe an event of the detection of @xmath86 photons in the detector @xmath13 of the detection module @xmath212 . from the structure of the basic povm elements it is evident that we have to distinguish between multi - clicks ( mc ) @xmath221 and cross - clicks ( cc ) @xmath222 .",
    "the multi - clicks happen when different detectors within the same detection module ( i.e.  the same basis choice ) have a click and is a generalization of a double - click for @xmath223 .",
    "cross - clicks occur when several detectors in at least two different measurements modules ( two different bases ) have a click .",
    "the target povm elements can be easily deduced when we restrict to a single - photon input state ( note the analogy to eq .",
    "( [ sixstatetarget ] ) for the six - state measurement ) : f_1^i,=@xmath207,[mubtarget ] + = 0,  ,d;i=0,  ,d-1 .",
    "it is not hard to see that the target povm elements are single photon restrictions of the basic povm elements in eq .",
    "( [ mubbasicpovm ] )",
    ". therefore we choose a cpp scheme that does not affect single - click basic povm elements .",
    "following the same lines as the bb84 and the six state squashing models , we choose the cpp scheme as follows :    single clicks are mapped to the same single clicks    multi - clicks are assigned equally randomly to one of the @xmath197it values in the same module @xmath212 .",
    "cross - clicks are assigned with probability @xmath224 to one of the outcomes of the measurement @xmath212 .    the chosen cpp scheme and eq .",
    "( [ mubbasicpovm ] ) imply the following form of the full povm measurement elements @xmath225_n^i,=f_n^i,+f_mc , n^ + f_cc , n .",
    "[ ppruben ]      to start off , we note that the chosen postprocessing scheme allows us to use the results of section [ section : orthosubspace ] and precede the squashing map by a projection on the @xmath217-dimensional space @xmath226 , because the projection on this space commutes with full measurement povm elements ( observation [ obs : pporth ] ) .",
    "all states in the orthogonal compliment @xmath99 will produce either multi - clicks or cross - clicks . in this case",
    "the squashing map will output a completely mixed qudit state @xmath227 : @xmath228={\\ensuremath{\\mathbbm 1}}_d / d$ ] for all @xmath229 .",
    "therefore we have constructed a squashing map on the subspace @xmath99 .",
    "what is left is to construct is a completely positive @xmath102 .",
    "the adjoint of the squashing map must satisfy the linear constraints eqns .",
    "( [ probcond ] ) , ( [ probcondadjoint ] ) : ^_p , n=@xmath225_p , n^i , .",
    "[ linconstrmub ]    we have the following result .",
    "( complete positivity of @xmath133)[mubpositivity ] on the hilbert space of interest there exists a completely positive map @xmath102 which fulfills the linear constraints in eq .",
    "( [ linconstrmub ] ) .    _",
    "proof : _ the proof consists of two steps .",
    "first , one has to construct a map @xmath230 that fulfills the linear constraints .",
    "second , one needs to prove its complete positivity . to begin with we note that eq .",
    "( [ linconstrmub ] ) defines the map @xmath230 on all target povm elements @xmath231 , which form a basis in @xmath211 .",
    "this completeness is a starting point for the construction of the squashing map @xmath102 .",
    "as @xmath230 is linear , this defines its action on any input operator .    in the second step",
    "we need to prove that the squashing map is completely positive .",
    "the proof is technical , and can be found in appendix f. @xmath58    this lemma finishes the construction of the squashing model for the qudit measurement device with a uniformly distributing input beam - splitter .",
    "( squashing model for the passive multi - state qudit measurement)[thm : fullmubsquasher ] there exists a squashing model for the full ( @xmath202 mubs ) passive multi - state qudit measurement device for all prime numbers @xmath197",
    ".      in the concluding part of this section we make some remarks about possible ways to generalize the results for the mub measurement device .",
    "first of all , one may want to allow for different input beam splitter ratios and choose @xmath232 . in the following remark we point out that it is not possible if one wants to keep the cpp scheme of section [ ssection : mubtarget ] unchanged , i.e.  where the multi- and cross - clicks are uniformly distributed .",
    "[ mubcppremark ] for the cpp scheme chosen in section [ ssection : mubtarget ] ( uniform distribution of the multi- and cross - clicks ) the linear constraints eq .",
    "( [ linconstrmub ] ) are fulfilled if and only if the output probabilities of the input beam splitter in fig .  [ mubapparatus ] are all equal , i.e.  @xmath218 for all @xmath104 .    _",
    "proof : _ see appendix g.    note that this remark does not contradict the existence of a squashing model for the passive bb84 measurement , as the cpp scheme used there is not a special case of the cpp scheme of section [ ssection : mubtarget ] .",
    "the other possible extension of the result of theorem [ thm : fullmubsquasher ] is to choose the input beam splitter such that @xmath216 are uniformly distributed over @xmath233 output arms and @xmath234 for the rest of the beam splitter outputs ( this situation would include the bb84 measurement device ) .",
    "however we do not have an analytic proof that a squashing model for such situation exists and leave it as an open question .",
    "so far we have provided examples in which squashing models take multiple photon signals to single photon ones .",
    "however , there are other degrees of freedom in experimental measurements that we have not accounted for in the squashing models considered so far . for example , measurements typically accept signals over a time window , whose responses from the measurement ( such as detector clicks ) are grouped together into what is called an event . during the time window of a detection event , it is possible that a measurement receives signals in multiple time modes . in this section",
    "we address the question of the existence of squashing models for measurement devices that accept multiple time modes .",
    "first , we provide a squashing model for the multi - time - mode active bb84 measurement device .",
    "based on this result we prove the existence of the squashing model for the multi - time - mode six - state measurement .",
    "finally , in accordance with theorem [ thm : squasherbb84passive ] , we apply the squashing model of the multi - time - mode active bb84 measurement to the multi - time - mode passive bb84 measurement .",
    "note that the following results will apply to any collection of spatial - temporal modes a detector might be susceptible to , not only time modes .",
    "as we will show , a measurement device that receives an input in many time modes can be thought of as many copies of that same measurement device , each measuring with the same setting ( for example , the same basis ) and each receives a single - time mode , followed by a suitable postprocessing in order to combine the single - mode devices into the full device .",
    "therefore , it is important to distinguish between two essential groups of basic events ( see fig .  [ modesquashcpp ] ) : _ single - time - mode events _ and _ multi - time - mode events_. note that single detector clicks and multi - detector clicks can correspond to a multi - time - mode event .",
    "the situation seems to become rather cumbersome , because in general it is unclear what classical postprocessing one should choose .",
    "however , if the structure of the measurement device is such that it has a single - time - mode squashing model for a specific classical postprocessing , then there exists an overall classical postprocessing such that a multi - time - mode squashing model exists .",
    "we have the following theorem .",
    "( multi - time - mode squashing model for the active bb84 measurement)[thm : multitimeactivebb84 ] there exists a squashing model with a single - mode qubit target measurement for the multi - time - mode active bb84 measurement , no matter how often one chooses to measure in either basis .    _",
    "proof : _ the proof relies on the fact that there exists a squashing model for the single - time - mode device and in particular on the orthogonality of the single - click and double - click subspaces ( see section [ ssection : activebb84reduction ] ) .",
    "_ classical postprocessing in the time domain. _ the classical postprocessing in the time domain is defined by grouping events that come from single - time - mode measurements .",
    "if there is no click in any of the single - time - mode measurements we assign an `` overall '' vacuum to this event .",
    "we use `` overall '' to mean the output of this first step in the classical postprocessing . if the outcome of every single - time - mode measurement is either `` 0 '' ( `` 1 '' ) or no - click we assign it to an overall `` 0 '' ( `` 1 '' ) . to any other click pattern",
    "we assign an overall double - click .",
    "these four types of events from a multi - mode measurement are then forwarded to the classical postprocessing that allows a single - time - mode squashing model .    in summary ,",
    "the overall classical postprocessing for the multi - time - mode active bb84 measurement device is ( cf .",
    "[ modesquashcpp ] ) :    if there is no click in any of the single - mode devices then we call the overall event a `` no - click ''    if each single - mode device the event is either `` 0 '' ( `` 1 '' ) or `` no - click '' , and there is at least one click event , we call the overall event `` 0 '' ( `` 1 '' )    in the case of any other click pattern we call the event an `` overall double - click ''    the overall single - clicks and vacuum events remain unchanged    the overall double - clicks are assigned with probability @xmath235 to `` 0 '' or `` 1 ''    ]    _ cp map for the classical postprocessing in the time domain. _ in order to prove that there is a cp map that preserves the structure of the incoming state and is compatible with the provided classical postprocessing , we note that according to section [ section : qnd ] we can ( without loss of generality ) perform a qnd measurement of the photon number on each of the single - time modes .",
    "schematically the cp map on the overall system can be constructed by the composition of cp maps as shown in fig .",
    "[ modesquash ] .",
    "after the qnd measurement is done on each of the single - time modes , we combine all time modes into one single - time mode .",
    "this is done via a unitary map @xmath236 that depends on the outcome of the qnd measurements .",
    "it is applied to consecutive pairs of single - time modes ( see fig .  [ modesquash ] ) . the first single - time mode is then forwarded directly to a flag measurement ( defined shortly ) , whereas the second is an input to the next @xmath236 .",
    "this flag measurement is a projection on the vacuum state of the first @xmath237 time modes and is performed after the map @xmath236 has been applied on the @xmath237 and @xmath238 single - time modes . depending on the outcome of this measurement , a particular single - time - mode squashing map",
    "is applied to the state in time mode @xmath238 .",
    "is applied to the adjacent modes @xmath124 and @xmath239 .",
    "this map can be realized via a jaynes - cummings interaction , while the atomic degrees of freedom are traced out afterwards .",
    "last is a flag measurement performed on the first @xmath237 time modes .",
    "the state of mode @xmath238 is forwarded as input to the single - time - mode squashing map .",
    "depending on the outcome of the flag measurement either @xmath240 or @xmath241 is applied .",
    "[ modesquash ] ]    to explain this in more detail , the map @xmath236 can be described by using the jaynes - cummings model .",
    "this map is unitary but depends on the total photon number in each mode ( without this knowledge it is impossible to perform the map ) .",
    "the crucial property of this map is that it preserves the structure of the particular type of incoming states independent of their polarization @xmath242 ( cf .",
    "appendix a in @xcite ) : & u^i , ii_jc[@xmath243@xmath244 + & = @xmath107@xmath245 , + & u^i , ii_jc[@xmath246@xmath247 + & = @xmath107@xmath248[timemodecp ] .",
    "thus we conclude that any state that produces an overall single - click will be mapped to either one of four states : & @xmath107^(m-1)@xmath249 + & @xmath107^(m-1)@xmath250[timemodesingleclicks ] .",
    "therefore , if the outcome of the flag measurement is vacuum we know with certainty ( due to the unitarity of the map @xmath236 ) that the incoming multi - time mode state would have produced a single - click in any single - time - mode measurement .",
    "if the outcome of the flag measurement is not the vacuum then we know with certainty ( again due to unitarity ) that the incoming state would have produced an overall double - click in the multi - time - mode measurement . by virtue of this , we proceed with the single - time - mode squashing map @xmath240 from section [ ssection : bb84active ] if the flag signals vacuum , and @xmath241 otherwise .    note that this procedure is compatible with the overall cpp scheme , since the cp map in the time domain preserves the structure of the single - click subspace as it can be deduced from eqns .",
    "( [ timemodecp ] ) and ( [ timemodesingleclicks ] ) .",
    "since we are given that there is a squashing model for the single - time - mode measurement we conclude the proof .",
    "note that the generalization of this result to other measurement devices is not straightforward .",
    "on one hand , for qudit measurement devices , the first part of the proof holds regardless of whether or not one measures in mubs .",
    "then one needs the final single - mode squashing map to exist in order to claim the existence of the overall map . on the other hand , for most of the passive devices",
    ", one would need to come up with a flag that can distinguish between double- and cross - clicks , because cpp schemes for these devices usually distinguish between these types of clicks ( see section [ ssection : bb846statepassive ] ) .",
    "nonetheless there are two important corollaries from theorem [ thm : multitimeactivebb84 ] .",
    "there is a squashing model with a qubit target measurement for the multi - mode active six - state measurement with noisy postprocessing .",
    "_ proof : _ the proof repeats the proof of theorem [ thm : multitimeactivebb84 ] until the point where one needs to apply the single - time - mode squashing map . in this case",
    "the map from section [ ssection:6statealternativecpp ] is applied .",
    "there is a squashing model with a qubit target measurement for the multi - mode passive bb84 measurement with a cpp scheme that discards all cross - click events .    _",
    "proof : _ since all cross - click events are thrown away it is sufficient to have the same flag as in the multi - mode active bb84 measurement .",
    "more precisely , the squashing map is a sequence of three maps .",
    "first , all cross - clicks are projected onto a multi - mode vacuum state .",
    "second , the jaynes - cummings map is applied and a flag measurement is done .",
    "third , depending on the flag measurement , the squashing map for the single - time - mode active bb84 measurement is applied .",
    "in the case of the unbalanced phase - encoded bb84 measurement device ( pe bb84 ) the relevant information is always encoded in the phase between two different time - modes that enter a mach - zehnder interferometer ( see fig .  [ pebb84detector ] ) .",
    "this phase usually takes one of four values @xmath251 , which is motivated by the corresponding qkd protocol ( cf .",
    "the long arm of the interferometer has a lossy phase modulator , which can be adjusted to @xmath252 and whose loss is modelled by a beam splitter with transmittance @xmath253 .",
    "the signals pass through the interferometer and then the modes are detected by two threshold detectors with equal efficiencies @xmath254 ( see fig .",
    "[ imperf ] ) .",
    "each of the two detectors can accept signals in three different time windows containing the modes @xmath255 , @xmath256 and @xmath257 respectively . due to the structure of the device",
    "it is clear that the relevant information about the phase is contained in the second time window , since clicks in this time window correspond to the interference between the first and the second input time modes .",
    "the question of the existence of a squashing model for the unbalanced pe bb84 measurement is also practically motivated .",
    "a change in the loss of the phase modulator changes the measurement operators .",
    "for example , this implies that for the purpose of a security proof the lossless version of the device , which is equivalent to the polarization bb84 measurement ( see section [ ssection : pebb84target ] below ) , can not be used anymore .    in order to not deal with losses and inefficient threshold detectors",
    "directly we can always consider detection by a lossless interferometer with ideal threshold detectors but unbalanced input beam splitter due to the loss in the phase modulator and additional pre - detection loss due to the originally inefficient threshold detectors ( cf .",
    "such a measurement device is presented in fig .",
    "since we are not interested in any pre - detection losses but solely in the mode of operation of the measurement device we ignore the loss that is described by the beam splitter with transmittance @xmath258 and consider the ideal mach - zehnder interferometer with an unbalanced input beam splitter with transmittance @xmath259 .",
    "the povm elements of the pe bb84 measurement device can be described by the mode operators @xmath260 that are related to mode operators @xmath261 of the incoming signal ( cf .",
    "the input - output relations ( up to an unimportant overall phase ) for the modes of interest are @xmath262    having these relations in mind one can draw a connection to the usual polarization measurement .",
    "it is not hard to see that the measurements in the middle time window for different settings of @xmath263 correspond to polarization measurements in two conjugate bases .",
    "moreover , if one combined clicks in the first and in the third time window one would perform a measurement that corresponds to the measurement in the standard basis in the polarization measurement device . formally , for a lossless phase modulator ( @xmath264 ) we have the following povm elements",
    "f_q^2,0&=@xmath265,f_q^5,0=@xmath266[pebb84-passivebb84 - 1 ] + f_q^2,/2&=@xmath267,f_q^5,/2=@xmath268 [ pebb84-passivebb84 ] + f_q^1+f_q^4&=@xmath269,f_q^3+f_q^6=@xmath270[pebb84-passivebb84 - 2 ] , where @xmath271 is the povm element on single - photon input in the time window @xmath272 and for the phase modulator set to @xmath263 .",
    "( [ pebb84-passivebb84 - 1 ] ) , ( [ pebb84-passivebb84 ] ) establish the formal connection of the lossless pe bb84 measurement ( in the case where only events from the second time window are taken into account ) to the active polarization bb84 measurement .",
    "we choose the target measurement to be the full measurement restricted to the single - photon and vacuum input .",
    "since the useful events are detected in the second time window we group the target povm elements as follows    @xmath273    the reason why we write the povm elements here in terms of the output operators @xmath274 will be more apparent in section [ pebb84basicfullpovms ] , where we consider @xmath86-photon input states .    in terms of the input states , which we denote by @xmath275 and @xmath276 respectively ,",
    "the povm element for the outside clicks can be rewritten as f_out , q=(1-)@xmath269+@xmath270=f_q^2,+f_q^5 , , [ pebb84targetrelations ] .",
    "this leads us to useful relations between the target povm elements and the pauli matrices @xmath277 , @xmath157 : ( f_q^2,0-f_q^5,0)&=_x , + ( f_q^2,-f_q^5,)&=_y , + ( 2f_out , q-@xmath30_2)&=_z .",
    "[ pebb84usefulrels ]      for a general input state with an undetermined number of photons in the input modes , the basic detection events can be characterized by means of patterns of clicks on the two threshold detectors over the three time windows .",
    "the total number of different events for each choice of the phase @xmath263 of the modulator is @xmath278 .",
    "as we demonstrated at the beginning of this section we can consider a lossless pe bb84 measurement device ( cf .",
    "[ pebb84detector ] ) by introducing some additional loss to the channel and an unequal - ratio input beam splitter .",
    "it means that a `` no - click '' pattern never occurs if the incoming signal was not in a vacuum state .",
    "therefore for two phase settings of interest @xmath279 and @xmath280 we have 126 possible basic events .",
    "in what follows we describe a basic event by a phase setting @xmath263 and a click pattern @xmath281 , where each @xmath282 is either 0 or 1 ( no click or click ) and the index @xmath13 corresponds to the index of the output optical mode ( see fig .",
    "[ pebb84detector ] ) .",
    "this combination of indices provides an exact description of which detector has clicked and when .    since our target measurement is a restriction of the basic measurement to the single photon subspace , we are interested in a cpp scheme where single clicks are preserved and the rest of the postprocessing involves only multiple clicks .",
    "this postprocessing needs to be valid in the terms that were set in section [ ssection : classpp ] .",
    "using the linear dependency of the target povm elements in eq .",
    "( [ pebb84targetrelations ] ) we performed an exhaustive numerical search for a valid cpp scheme .",
    "there are many cpp schemes that are allowed by the linear dependencies . here",
    "we present the only postprocessing that , as we will show shortly , allows a completely positive squashing map :    1 .",
    "single clicks in either of the detectors in the second time window for either basis choice ( i.e.  events with @xmath283 or @xmath284 ) are assigned to the corresponding single - photon events ; 2 .",
    "simultaneous clicks in the two detectors in only the second time window for either basis choice ( i.e.  events with @xmath285 ) are assigned with probability @xmath235 to each of the single - photon measurement outcomes for the same setting of the phase @xmath263 ; 3 .",
    "all events with clicks only in the first and the third time windows ( outside clicks ) are assigned to an outside single - photon measurement event ; 4 .",
    "any event with clicks in both the second and any of the outer time windows is assigned with probability @xmath235 to the outside click event of the single - photon measurement event and with probability @xmath286 onto each of the four other events of the single - photon measurement event .",
    "since the pe bb84 measurement device contains threshold detectors we can use the same argument as in observation [ obs : qndreduction ] , section [ section : qnd ] and consider the problem on the @xmath86-photon subspace . from now on we will only consider @xmath86-photon input states .    according to the properties of the target measurement and the choice of the cpp scheme we will distinguish between the following basic povm elements : @xmath287 the last three povm elements correspond to a double click in the second time window for the particular choice of the phase @xmath263 - @xmath288 , to any click not in the second time window - @xmath289 , and to any cross - click between the second and one or both other time windows - @xmath290 .",
    "the complementarity condition gives us one more auxiliary povm element f_in , n=_=0,(f_in , dc , n^+f_n^2,+f_n^5 , ) where @xmath291 is a povm element corresponding to any click in the second time window .",
    "note that neither @xmath291 nor @xmath289 depend on the setting of the phase @xmath263 in the phase modulator .",
    "this can be seen if we write these elements in terms of the incoming modes @xmath292 and @xmath293 : f_in , n&=_r=0^n^n - r(1-)^r@xmath294,[pebb84povmsio ] + f_out , n&=_r=0^n^r(1-)^n - r@xmath294,where @xmath295 .    with this in mind",
    "we can write the full measurement povm elements as @xmath225_n^b,&=f_n^b,+f_in , dc , n^+f_in , out , n , + @xmath225_out , n&=f_out , n+f_in , out , n,[pebb84fullpovms ] + & = 0,;b=2,5 .      with full measurement elements provided in eq .",
    "[ pebb84fullpovms ] we have that the adjoint of the squashing map @xmath88 has to fulfill the following linear constraints : ^_n[f_q^b,]&=@xmath225_n^b,,=0,;b=2,5 + ^_n[f_out , q]&=@xmath225_out , n .",
    "[ pebb84linconstr ]    as in the previous examples , we investigate the positivity of the squashing map by investigating the positivity of the corresponding choi matrix @xmath296 $ ] .",
    "the choi matrix will have no free parameters , since the target povm elements can be seen as an operator basis on the target hilbert space .",
    "using the decomposition of the projector @xmath297 in terms of pauli matrices ( see e.g.  eq .",
    "( [ eq : mesinpaulis ] ) ) and employing the established connection between the pauli matrices and the target povm elements ( eq .  ( [ pebb84usefulrels ] ) )",
    "we have & 4(@xmath30_n^ ) + = & @xmath30_2@xmath30_n+_x(@xmath225_n^2,0-@xmath225_n^5,0 ) + & -_y(@xmath225_n^2,-@xmath225_n^5 , ) + & + _ z(2@xmath225_out , n-@xmath30_n ) + = & @xmath30_2@xmath30_n+_x(f_n^2,0-f_n^5,0 ) + & -_y(f_n^2,-f_n^5 , ) + & + _ z(f_out , n - f_in , n ) .",
    "[ pebb84choi ] here we used the classical postprocessing eq .",
    "( [ pebb84fullpovms ] ) in order to write the last equation in terms of the basic povm elements .    when we write the basic povm elements in terms of input mode operators @xmath298 ( eqns .",
    "( [ pebb84io ] ) ) , we can show that @xmath299 where @xmath300 is a normalized vector .",
    "moreover from the same equations it follows that @xmath301 .",
    "therefore the traceless operator @xmath302 of rank 2 has eigenvalues @xmath303 .    from eq .",
    "( [ pebb84povmsio ] ) it follows that & f_out , n - f_in , n=[eq : pebb84basicpovmrelations ] + & _ r=0^n(-)@xmath294 .    with these relations in mind we can easily calculate the minimal eigenvalue of the choi matrix in eq .",
    "( [ pebb84choi ] ) numerically for any finite number @xmath86 of incoming photons .",
    "we use eq .",
    "( [ eq : pebb84basicpovmrelations ] ) in order to represent the last term in eq .",
    "( [ pebb84choi ] ) as a @xmath304 matrix . in fig .",
    "( [ pebb84mineig ] ) we present the minimum eigenvalue of the choi matrix as a function of the loss in the phase modulator @xmath253 ( recall that @xmath305 ) for different numbers of incoming photons @xmath86 .",
    "one can readily see that for any @xmath306 $ ] , @xmath307 is non - negative .",
    "in fact , the minimum eigenvalue of the choi matrix is strictly positive for any @xmath308 .",
    "moreover , it is clear from our numerics that @xmath307 is a nondecreasing sequence in @xmath86 for any @xmath306 $ ] , i.e.  @xmath309 for all @xmath306 $ ] .",
    "( color online ) minimum eigenvalue @xmath307 of the choi matrix @xmath310 of the adjoint squashing map @xmath311 for the pe bb84 measurement device as a function of the loss @xmath253 in the phase modulator in the long arm of the mach - zehnder interferometer .",
    "while for @xmath129 the minimal eigenvalue of @xmath310 stays constantly zero , it becomes strictly positive for @xmath308 and any @xmath306 $ ] . ]",
    "we will underpin our numerical findings by investigating asymptotical behavior of @xmath307 analytically .",
    "we derive a lower bound on the minimal eigenvalue of the choi matrix @xmath310 in two steps .",
    "first , as in the proof of theorem [ mixedsquashmap ] , we again use weyl s inequalities in order to derive a lower bound on the sum of the hermitian matrices in eq .",
    "( [ pebb84choi ] ) .",
    "second , we use the fact that @xmath312 . after some algebra",
    "the bound for all @xmath86 is given by 4_[t , n ] & 1- + & -()=:f_n(t ) .    the function @xmath313 is a monotonically increasing sequence of @xmath86 for any @xmath306 $ ] , i.e.  @xmath314 .",
    "moreover it holds that @xmath315 .",
    "therefore for any @xmath316 there exists an @xmath317 such that for any @xmath318 , @xmath319 .",
    "since @xmath317 is finite and for any finite @xmath317 one can calculate the minimum positive eigenvalue of the choi matrix explicitly , it follows that for all @xmath318 4_min(t , n)1 - 0 , which concludes the proof of the positivity of the adjoint of the squashing map @xmath320 and implies the existence of the squashing model for the pe bb84 measurement device with a lossy phase modulator .",
    "in the section we shortly explain the application of squashing models for qkd .",
    "we start with the standard usage , followed by an advanced application , first put forward in ref .",
    "@xcite , which provides slightly better key rates for various protocols . in the end",
    "we exemplify their difference for a bb84 protocol suffering from additional double click events on the receiver s side .",
    "we demonstrate the standard usage of squashing models in the security analysis of qkd using entanglement based qkd protocols , but all results straightforwardly apply also to prepare - and - measure schemes that do not use physical entanglement .",
    "let us start with a quick review of the essentials about qkd : an entanglement - based qkd protocol is realized in two phases : in a first phase , the quantum phase , the two legitimate parties alice and bob perform measurements on their share of a tri - partite pure states , which can be thought of as being prepared by the adversary , eve .",
    "in a subsequent second phase , the classical communication phase , alice and bob use an authenticated public channel to create a shared secret key from their data .",
    "the classical communication phase includes , typically , a sampling of their joinly correlated data that have been created in the quantum phase , a key map , error correction , and privacy amplification . the key map fixes",
    "which part of the data become key material . in our formulation",
    "we call these data @xmath321 and we assume without loss of generality that they are in alice s hand . in error correction , alice and bob exchange additional information about @xmath321 using their available data to make sure that also bob has a copy of the key material . at this stage ,",
    "the adversary could still be correlated with @xmath321 , thus having information about it .",
    "privacy amplification turns the key material @xmath321 into a secret key @xmath322 by applying some privacy amplification function out of a pre - defined set of functions .",
    "the resulting key can be shown to be arbitrarily close to a perfectly secure key . for our purpose",
    ", we do not need to deal with the exact security statement , or with finite size effects in qkd .",
    "instead we deal only with the secret key rate in what is known as the _ infinite - key limit_.    in the security analysis we can calculate the guaranteed achievable secret key rate @xmath323 as number of secret key bits per bit of key material @xmath321 as @xmath324 where @xmath325 is the conditional von neumann entropy of eve on the key material @xmath321 , minimized over a set of potential underlying states @xmath326 ( which can be thought of without loss of generality as pure states ) .",
    "this set is constrained by alice s and bob s observations during sampling in the classical communication phase .",
    "each state @xmath326 represents an eavesdropping strategy which leads to particular conditional states @xmath327 in eve s hand conditioned on an element @xmath328 of the key material @xmath321 .",
    "these states summarize that part of eve s knowledge about the key material which stems from her preparation of ( or interaction with ) the physical systems on which alice and bob perform their measurements .",
    "the von neumann entropy @xmath325 is a function of these states and the probability of occurrence of the elements of @xmath321 , as influenced by the public communication protocol .",
    "the last term , @xmath329 is the information content about the key material @xmath321 that leaks to eve during the classical communication phase , including , for example , the number of bits per key material that have been announced publicly during error correction .    squashing models can now be used to simplify the minimization calculation in the key rate expression .",
    "this is of particular importance for optical implementations of qkd where , for example , bob performs some type of photon - counting measurements , which need to be described on the infinite - dimensional hilbert space of optical modes .",
    "thus the set @xmath330 can have a rather complex form : it is given by all pure tri - partite quantum states @xmath326 which satisfy the condition that they give the observed correlations of data for alice and bob ( including post - processing on bob s side ) .",
    "[ thm : generalqkd ] the key rate @xmath331 using the full measurement can be lower bounded by a key rate using the target measurement , @xmath332 as @xmath333 where @xmath334 has now the lower dimensional target system @xmath335 as one component .",
    "the set @xmath336 contains all such density matrices which are again constrained by the observed correlations for alice and bob .",
    "these constraints can now be formulated using the target measurements .",
    "the same statement can be made for the measurement on system @xmath337 if that measurement admits a squashing model . to verify the theorem , we can follow a simple argument which is illustrated in fig .",
    "[ fig : squash_qkd ] . as a first step note that an eavesdropping strategy against the full measurement protocol , as represented by a state @xmath338 and shown in fig .",
    "[ fig : squash_qkd ] ( a ) , is now equivalent to an eavesdropping strategy described by the state @xmath339 $ ] , as the squashing map is applied to system @xmath340 without loss of generality before the target measurement is being performed , as shown in fig .",
    "[ fig : squash_qkd ] ( b ) . in the next step",
    ", we enlarge the set of possible eavesdropping strategies by directly admitting all density matrices of the type @xmath334 that are compatible with the observations , thereby dropping the constraint that it must be obtained by applying the squashing map @xmath341 to the full system ( see fig .",
    "[ fig : squash_qkd ] ( c ) ) . as a result of enlarging the set of allowed eavesdropping strategies over which the infimum in eq .",
    "( [ eq : generic_rate ] ) is taken , the resulting key rate can only decrease .",
    "note that the above theorem applies to the full measurements , that is , bob performs the post - processing on his basic measurement results .",
    "next , we draw the attention to the fact that the above key rate can be improved , as shown by ma and ltkenhaus in ref . @xcite .",
    "the motivation for this improvement comes from the fact that the postprocessing of the basic measurements helps to establish a squashing model to simplify the evaluation of the conditional entropy @xmath325 over all eavesdropping strategies .",
    "however , the same post - processing , typically , increases the amount of communication required during error correction from @xmath342 to @xmath343 . the key observation in ref .",
    "@xcite is that these two points can be separated : we are allowed to use post - processed data to formulate constraints on @xmath334 to evaluate @xmath325 , but we do not actually need to apply the post - processing to our data , as long as the key material variables @xmath321 are not affected by the post - processing .",
    "formally , we can states this as    [ thm : qkdimproved ] for a qkd scheme , which uses basic measurements , post - processing of the basic measurements that leads to full measurements and allows for squashing model with some target measurement , we can find the key rate @xmath344 this key rate holds as long as the key material @xmath321 is unaffected by the post - processing .",
    "it uses the squashing model to estimate the term involving @xmath325 , but shows a reduced value of the term @xmath345 which represents the amount of information on @xmath321 that leaks during the error correction phase of qkd based on bob s basic measurement events .    to illustrate the effect ,",
    "consider an example of the bb84 and compare the key rates when one applies either theorem [ thm : generalqkd ] or theorem [ thm : qkdimproved ] .",
    "if we assume an initial symmetric data behavior of the type @xmath346 with @xmath347 being the probability to obtain a single - click event and @xmath171 as the error rate within the single - click events .",
    "post - processing that allows a squashing model for these measurements involves a random assignment of double - clicks to the values @xmath348 and @xmath349 , which will raise the error rate from @xmath171 to @xmath350 . using the squashing model",
    ", we find @xmath351,\\ ] ] where @xmath352= - x \\log_2 x - ( 1-x ) \\log_2(1-x)$ ] is the binary entropy function .    now",
    "let us have a look at the amount of error correction we have to do , as quantified by @xmath329 ( with post - processing ) and @xmath353 ( without post - processing ) .    assuming that we can reach the shannon limit for error correction",
    ", we find @xmath354 , while we have @xmath355 $ ] .",
    "consequently , we find for the key rate according to theorem [ thm : generalqkd ] @xmath356,\\ ] ] while we can find as improved key rate according to theorem [ thm : qkdimproved ] @xmath357 - h[(1-p_{\\rm single})+ p_{\\rm single}h_2(e)],\\ ] ] which is a strict improvement of the rate due to the concavity of the binary entropy function .",
    "in this work we have further developed the ideas of ref .",
    "we gave a rigorous definition of the squashing model and precisely defined the role of classical postprocessing in this setting .",
    "in summary , the squashing models give us a tool for the truncation of hilbert spaces under adversarial conditions .",
    "more precisely , in the context of quantum communication in the presence of an adversary that can tamper with the transmitted signals by employing their high dimensionality , it is equivalent to the scenario where one only performs the target measurement instead of a high dimensional measurement .",
    "this undoes the adversary s advantage , because there is no information that can be gained by making a measurement on the high - dimensional system above what can be gained from the target measurement on the lower dimensional system .",
    "thus , the squashing models can be effectively applied , for example , in the optical implementations of qkd or coin - tossing .    for qkd applications we constructed squashing models for various types of measurement devices , which are used in optical implementations of corresponding qkd protocols . for instance",
    ", this implies that a security proof of these protocols can be generalized from single photons to the multi - photon case .",
    "several generalizations can be made for results presented in this work .",
    "first of all , it would be interesting to generalize the results on the qudit measurement to the case where the input beam splitter has less than @xmath202 output arms .",
    "our intuition strongly suggests that the squashing model might exist if the number of output arms is strictly less than @xmath202 .",
    "this is due to the fact that removing the output arms would effectively introduce free parameters in the choi matrix of the squashing map , which is usually enough to guarantee the complete positivity of the corresponding squashing map ( cf .",
    "active bb84 and six - state measurements ) .",
    "however these findings would heavily rely on numerical findings",
    ". it would be therefore desirable to find some type of symmetry argument that can be used to tackle this problem analytically .",
    "this research has been supported by nserc ( via the discovery program and the strategic project grant frequency ) and the ontario research fund ( orf ) .",
    "oleg gittsovich is grateful for the support of the austrian science fund ( fwf ) and marie curie actions ( erwin schrdinger stipendium j3312-n27 ) .",
    "we would like to thank marcos curty , eleni diamant , hoi - kwong lo , momtchil peev for many enlightening discussions .",
    "in this appendix we summarize some known facts about the natural representation of super - operators .",
    "further details on this topic can be found in @xcite .",
    "( equivalence of the natural and choi - jamiokowski representations ) let @xmath358 be a super - operator @xmath359 , with @xmath360 and @xmath361 being linear operators .",
    "let @xmath362 and @xmath363 denote orthonormal bases in @xmath364 and @xmath365 respectively .",
    "on the one hand the natural representation of @xmath358 is defined as a map _ : @xmath366@xmath367 , where @xmath368 denotes column - wise vectorization of matrix @xmath321 .",
    "@xmath369 is a linear operator @xmath370 which can be represented by a matrix _ _",
    "= @xmath371_@xmath372 . on the other hand",
    "the choi - jamiokowski representation is defined by the map @xcite _ : l(l(@xmath373_a),l(@xmath373_b ) ) l(@xmath373_a@xmath373_b ) and can be represented by a matrix _ _",
    "= @xmath374_@xmath375 .",
    "one can readily see that @xmath376 is a reshuffled version of the @xmath377 @xmath371^r_@xmath372=@xmath374_@xmath375 .",
    "beam splitters are well studied objects in quantum optics @xcite .",
    "they are considered as four port devices with two input and two output ports ( fig .",
    "[ bs1 ] ) .     and @xmath292 , @xmath378 and @xmath379 being the input and output modes respectively .",
    "[ bs1 ] ]    for a beam splitter with transmittance @xmath272 and reflectivity @xmath323 ( @xmath380 ) the following relations between the input and output modes hold b_0&=(a_1 + ^ia_0 ) + b_1&=(a_0 + ^i(-)a_1 ) , [ bsrels ] provided an @xmath104 phase shift between the reflected and transmitted beams . without loss of generality , one can set @xmath381 .    both the transmittance and the reflectivity of the beam splitter may depend on the frequency , direction of propagation , and on the polarization of the incident light . for usual @xmath184 beam splitter the relations simplify to b_0&=(a_0 + a_1 ) + b_1&=(a_0 - a_1)[5050bs ] .",
    "here we give explicit formulas for the matrix representations of the choi matrices used for the squashing map in the bb84 active basis measurement s squashing model : @xmath144 and @xmath146 .",
    "we also discuss how to solve @xmath382 to ensure the complete positivity of the squashing map .",
    "the choi matrices are given by    m(f^(0,z)_p , n - f^(1,z)_p , n)m_z & = (    cccc 1 & 0 & s & s + 0 & -1 & -s & ( -1)^n+1s + s & -s & 0 & ( 1-(-1)^n)s^2 + s & ( -1)^n+1s & ( 1-(-1)^n)s^2 & 0    ) + m(f^(0,x)_p , n - f^(1,x)_p , n)m_x & = (    cccc 0 & ( 1-(-1)^n)s^2 & s & -s + ( 1-(-1)^n)s^2 & 0 & s & ( -1)^n+1s + s & s & 1 & 0 + -s & ( -1)^n+1s & 0 & -1    ) [ bb84exact ] + m(@xmath30_m)&= (    cccc 1 & 0 & s & s + 0 & 1 & s & ( -1)^ns + s & s & 1 & 0 + s & ( -1)^ns & 0 & 1    ) + m((^p_n)^(_y))is & = i (    cccc 0 & x_1 & x_2 & x_3 + -x_1 & 0 & x_4 & x_5 + -x_2 & -x_4 & 0 & x_6 + -x_3 & -x_5 & -x_6 & 0    ) , where @xmath383 , @xmath384 are real free parameters and @xmath385 . the overall @xmath386 matrix , which needs to be positive is then given by m(_p , n ) & = (    cc m(@xmath30_n ) + m_z & m_x + s + m_x - s & m(@xmath30_n ) - m_z    ) + & =(    cccccccc 2 & 0 & 2s & 2s & 0 & _ ns^2 + x_1 & s + x_2 & x_3 - s + 0 & 0 & 0 & 0 & _ ns^2 - x_1 & 0 & x_4 + s & x_5 + ( -1)^n+1s + 2s & 0 & 1 & _ ns^2 & s - x_2 & s - x_4 & 1 & x_6 + 2s & 0 & _ ns^2 & 1 & -s - x_3 & ( -1)^n+1s - x_5 & - x_6 & -1 + 0 & _ ns^2 - x_1 & s - x_2 & - x_3 - s & 0 & 0 & 0 & 0 +",
    "_ ns^2 + x_1 & 0 & - x_4 + s & - x_5 + ( -1)^n+1s & 0 & 2 & 2s & ( -1)^n2s + s + x_2 & s + x_4 & 1 & - x_6 & 0 & 2s & 1 & -_ns^2 + -s + x_3 & ( -1)^n+1s + x_5 & x_6 & -1 & 0 & ( -1)^n2s & -_ns^2 & 1    ) , where @xmath387 .",
    "the matrix @xmath141 is positive if and only if each of its principle minors is positive .",
    "this fixes all free parameters to be x_1&=x_6=_ns^2 + x_3&=x_4=-s[bb84solutions ] + x_2&=(-1)^nx_5=s .",
    "here we provide some technical details used for the construction of the squashing model of the active six - state measurement device for an intermediate postprocessing in section [ ssection:6statealternativecpp ] .",
    "in particular , we show the positivity of the matrix @xmath388 from eq .",
    "( [ eq : sixstatepovmnewold ] ) for @xmath389 .",
    "first of all , for small integers @xmath86 we observe that the critical value of @xmath76 is equal to @xmath390 .",
    "for example , we need @xmath76 to exceed this value for @xmath391 in order matrix to be positive",
    ". then one can check directly that the matrix of @xmath392 is non - negative for @xmath393 .",
    "after this is done one can use the gerschgorin disk theorem @xcite in order to prove that all eigenvalues strictly lie on the positive part of the real axis .",
    "one can give an upper bound on each of the disk s ( there are 12 of them ) radii .",
    "each bound is a monotonically decreasing function of @xmath86 and for @xmath394 the union of 12 disks lies on the part of the complex plain representing the eigenvalues of the matrix , @xmath395 .",
    "this implies the positivity of the eigenvalues since the matrix is hermitian and all its eigenvalues are real .",
    "here we derive the povm elements for the qudit measurement device from section  [ rubenswork ] .",
    "formally , we will use @xmath396 and @xmath274 to describe creation and annihilation operators of the output and @xmath397 and @xmath398 to describe creation and annihilation operators of the input of the measurement device from fig .",
    "[ mubapparatus ] . assuming that the input state has @xmath86 photons ,",
    "we have following povm elements in terms of output operators @xmath396 and @xmath274 : f_n^i,&= ( b^_i,)^n@xmath269(b_i,)^n + f_mc , n^&=_m_k = n _ i=1^d(b^_i,)^m_k@xmath269 ( b_i,)^m_k + f_cc , n & = @xmath30_n - _ = 0^d(f_mc , n^ + _ i=1^df_n^i,)[povmelements ] .    here",
    "@xmath399 denotes a single click in detector @xmath13 of the detection module @xmath212 ( basis @xmath104 ) .",
    "@xmath400 denotes a multi - click for which several detectors of the same detection module @xmath212 have clicked , whereas @xmath222 denotes any cross - click between different detection modules .    in order to write the povm elements in terms of input operators @xmath397 and @xmath398 one needs to know the input - output relations for the linear optical network . for an unbiased version ( @xmath218 for all @xmath104 ) of the beam splitter in fig .",
    "[ mubapparatus ] , the input and output modes are connected by the fourier matrix : & b_,q=_=0^d u_,a_,q , with q=1  d , + & u_,=(d+1)^-@xmath116e^.now we can substitute these relations in eq .",
    "( [ povmelements ] ) .",
    "we note that on the input side only the mode @xmath401 is occupied . whence we can project the rest of the @xmath398 s on the vacuum state .",
    "after some algebra the povm elements in terms of input modes eventually become f_n^i,&=(d+1)^-n@xmath108 + f_mc , n^&=(d+1)^-n(@xmath30_n-_i@xmath108 ) + f_cc , n & = ( 1-)@xmath30_n .",
    "in this appendix we provide the proof of proposition [ mubpositivity ] from section [ rubenswork ] .",
    "_ proof of proposition [ mubpositivity ] : _ the positivity is checked by proving that the choi matrix of the map @xmath133 is positive semi - definite . if @xmath197 is a prime number , the maximally entangled state can be decomposed in the the chosen operator basis @xmath402 , @xmath210 , @xmath403 ( one can see this after some algebra involving eqns .",
    "( [ eq : mubrelationship ] ) ) as @xmath45&=@xmath30_d@xmath30_d + _ k=1^d-1z_d^-kz_d^k + & +",
    "_ ^d-1(x_d z_d^-)^k(x_d z_d^)^k.[mubmes ] moreover , we point out that one can relate @xmath402 to the target povm elements eq .",
    "( [ mubtarget ] ) : z_d^k&=(d+1)_i=0^d-1^ikf_1 ^ 0,i , + ( x_d z_d^)^k&= ( d+1)_i=0^d-1^ikf_1^+1,i.[mubobspovm ]    we prove the positivity in two steps .",
    "_ step 1 @xmath125 : _ when the qnd measurement signals that one photon enters the measurement device , the squashing map does not have to do anything and @xmath404 .",
    "clearly it is completely positive in this case .",
    "_ step 2 @xmath196 : _ when the qnd measurement signals the presence of more than one photon in the incoming signal the squashing map has to be non - trivial .",
    "the proof of its complete positivity has several technical steps .",
    "first of all , let us apply @xmath405 to the second term in eq .",
    "( [ mubmes ] ) .",
    "we omit the overall factor of @xmath406 for brevity : & _ k=1^d-1z_d^-k_p , n^= _ ^d-1(d+1)^2^(s - r)k@xmath225_1^r,0@xmath225_p , n^s,0 + & = ( d+1)^2(d_r=0^d-1@xmath225_1^r,0@xmath225_p , n^r,0-_r , s=0^d-1@xmath225_1^r,0@xmath225_p , n^s,0 ) , where we used the first relation in eq .  ( [ mubobspovm ] ) and the identity @xmath407 for @xmath408 . from the form of the basic povm elements ( eq .",
    "( [ mubbasicpovm ] ) ) and the form of the full measurement povm elements ( eq .  ( [ ppruben ] ) ) it follows that _ r=0^d-1@xmath225_p , n^r , = @xmath30_p , n [ mubhilfe ] .",
    "note that this can also be concluded by a simple normalization argument : the povm elements corresponding to clicks in one of the detector modules should sum up to something proportional to the identity .",
    "the coefficient of proportionality is equal to the probability @xmath218 of the generalized balanced input beam splitter .    hence _",
    "k=1^d-1z_d^-k_p , n^&=d(d+1)^2_r=0^d-1@xmath225_1^r,0@xmath225_p , n^r,0 + & -@xmath30_d@xmath30_p , n.[mubsquashpos1 ]    second , let us consider the action of @xmath405 on the third term in eq .",
    "( [ mubmes ] ) , while omitting the overall factor of @xmath406 again for brevity . & _",
    "^d-1(x_d z_d^-)^k_p , n^ + & = ( d+1)^2_^d-1^(r+s)k @xmath225_1^r,-(+1)@xmath225_p , n^s,+1 [ mubsquashpos2 ] + & = d(d+1)^2_r,=0^d-1 @xmath225_1^r,-(+1)@xmath225_p , n^d - r,+1 + & -d@xmath30_d@xmath30_p , n.here we used the second relation in eq .",
    "( [ mubobspovm ] ) , the identity @xmath409 for @xmath408 , and eq .  ( [ mubhilfe ] ) .",
    "putting eq .",
    "( [ mubsquashpos1 ] ) and eq .",
    "( [ mubsquashpos2 ] ) together we arrive at & d^2@xmath30_p , n^[@xmath45]=d(d+1)^2_r=0^d-1@xmath225_1^r,0@xmath225_p , n^r,0 + & + d(d+1)^2_r,=0^d-1 @xmath225_1^r,-(+1)@xmath225_p , n^d - r,+1[mubsquashpos3 ] + & -d@xmath30_d@xmath30_p , n the positivity of the last expression is proven by expanding the full measurement povm elements in terms of the basic povm elements .",
    "for that , we reformulate the first term in eq .",
    "( [ mubsquashpos3 ] ) . according to eqns .",
    "( [ mubbasicpovm ] ) and ( [ mubcpp ] ) for @xmath381 we have & d(d+1)^2_r=0^d-1@xmath225_1^r,0@xmath225_p , n^r,0= d(d+1)^2_r=0^d-1@xmath225_1^r,0@xmath225_any^r,0 + & + ( d+1)(1- ) _",
    "r=0^d-1@xmath225_1^r,0@xmath30_p , n[mubhilfe1a ] + & = d(d+1)^2_r=0^d-1@xmath225_1^r,0@xmath225_any^r,0 + ( 1-)@xmath30_d@xmath30_p , n , where @xmath411 and we used eq .",
    "( [ mubhilfe ] ) for the qudit part ( @xmath125 ) of the tensor product .    for the second term in eq .",
    "( [ mubsquashpos3 ] ) we have & d(d+1)^2_r,=0^d-1 @xmath225_1^r,-(+1)@xmath225_any^d - r,+1 + & = d(d+1)^2_r,=0^d-1 @xmath225_1^r,-(+1)@xmath225_any^r,+1 + & + ( d+1)(1-)_r,=0^d-1 @xmath225_1^r,-(+1)@xmath30_p , n[mubhilfe1b ] + & = d(d+1)^2_r,=0^d-1 @xmath225_1^r,-(+1)@xmath225_any^r,+1 + & + d(1-)@xmath30_d@xmath30_p , n , where @xmath412 .    substituting eq .",
    "( [ mubhilfe1a ] ) and eq .",
    "( [ mubhilfe1b ] ) into eq .",
    "( [ mubsquashpos3 ] ) yields & d^2@xmath30_p^[@xmath45 ] + & = d(d+1)^2_r=0^d-1(@xmath225_1^r,0@xmath225_any^r,0 + _ = 0^d-1@xmath225_1^r,-(+1)@xmath225_any^r,+1)[mubsquashpos4 ] + & + ( 1-)@xmath30_d@xmath30_p , n . while the first term on the right hand side of the previous equation is strictly positive , the eigenvalues of the second one are all equal to @xmath413 and are non - negative for any @xmath196 .",
    "this finishes the proof of the second step and of the whole proposition . @xmath58",
    "in this appendix we provide the proof of remark [ mubcppremark ] from section [ rubenswork ] .",
    "_ proof of remark [ mubcppremark ] : _ first note that all basic povm elements for unequal probabilities @xmath216 generalize from eq .",
    "( [ mubbasicpovm ] ) to f_n^i,&=p_^n@xmath108 + f_mc , n^&=p_^n(@xmath30_n-_i@xmath108 ) [ mubdiffprobpovm ] + f_cc , n & = ( 1-_=0^dp_^n)@xmath30_n .",
    "let us consider the map @xmath103 , which is applied when an incoming @xmath86-photon state triggers the @xmath99 flag , i.e.  will with certainty produce a non - single - click .",
    "we assume that @xmath103 fulfils the linear constraints in eq .",
    "( [ linconstrmub ] ) .",
    "then the probability of seeing a click in the @xmath13-th detector of the detection module @xmath212 is given by & p(i,)=@xmath415 = @xmath416 { \\ensuremath{\\tilde{f}}}_1^{i,\\alpha } \\right)$ ] + & = = [ mublinconstrcheck ] , where we used the fact @xmath417 .",
    "the same probability can be re - expressed as p(i,)= @xmath418=@xmath419 . by virtue of eq .",
    "( [ mubcpp ] ) @xmath225_p_,n^i , = @xmath30_p_,n , and hence p(i,)=. [ eq : probmubcc ] finally , a direct comparison of eq .",
    "( [ mublinconstrcheck ] ) and eq .",
    "( [ eq : probmubcc ] ) implies that = must hold for any @xmath86 and for any @xmath104 ."
  ],
  "abstract_text": [
    "<S> we develop a framework that allows a description of measurements in hilbert spaces that are smaller than their natural representation . </S>",
    "<S> this description , which we call a `` squashing model '' , consists of a squashing map that maps the input states of the measurement from the original hilbert space to the smaller one , followed by a targeted prescribed measurement on the smaller hilbert space . </S>",
    "<S> this framework has applications in quantum key distribution , but also in other cryptographic tasks , as it greatly simplifies the theoretical analysis under adversarial conditions . </S>"
  ]
}