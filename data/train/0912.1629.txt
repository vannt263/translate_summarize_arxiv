{
  "article_text": [
    "let @xmath0 be a field of characteristic zero and @xmath1 a @xmath0-linear triangulated category .",
    "the concept of duality in @xmath1 was formalised by bondal and kapranov @xcite in terms of a triangulated functor @xmath2 together with a family of nondegenerate pairings @xmath3 natural in @xmath4 and satisfying a condition involving compatibility with suspension .",
    "the motivating example is the bounded derived category of coherent sheaves on a smooth projective variety @xmath5 over @xmath0 . in this case",
    "it follows from classical serre duality that there is a family of nondegenerate pairings for the functor @xmath6 $ ] , where @xmath7 and @xmath8 is the canonical bundle , and the pairing can be defined explicitly in terms of residues and traces @xcite .",
    "for this reason the functor @xmath9 is referred to in general as a _",
    "serre functor_.    if we take the point of view that a triangulated category is a geometric object in its own  right , then the serre functor and pairing play a fundamental role .",
    "for example , if @xmath5 is a calabi - yau variety over @xmath10 , so @xmath11 , then the pairing in the derived category computes correlators in a quantum field theory probing the geometry of @xmath5 .",
    "the field theory is the b - twisted supersymmetric topological sigma model with target @xmath5 on an oriented riemann surface @xmath12 with boundary @xcite , in which the bosonic fields are the components of maps @xmath13 . in the quantisation",
    "the basic quantities of interest are correlators defined by feynman path integrals over the space of fields .",
    "the boundary sector of the theory is described by the derived category , whose objects and morphisms correspond to branes and open strings , respectively @xcite . remarkably , the pairing in the derived category gives the correlator of a pair of open string states , when @xmath12 is a disc . in this paper",
    "we study serre duality in a different triangulated category , the singularity category of a scheme with isolated gorenstein singularities .",
    "let @xmath5 be a separated noetherian scheme of finite dimension over @xmath0 , and consider the inclusion @xmath14 of the full subcategory of perfect complexes into the bounded derived category of coherent sheaves . recall that a complex of coherent sheaves is",
    "_ perfect _ if it is locally isomorphic in the derived category to a bounded complex of vector bundles . as is well - known , this subcategory @xmath15 is dense if and only if @xmath5 is regular , and for singular @xmath5 this motivates the study of the verdier quotient @xmath16 this quotient was studied in the affine setting by buchweitz in an unpublished manuscript @xcite and more recently in the global setting by orlov @xcite in connection with string theory and mirror symmetry .",
    "in order to obtain a category whose morphism spaces are finite - dimensional we need to restrict to schemes which are _ gorenstein _",
    "@xcite , which means that the local rings @xmath17 have finite injective dimension as modules over themselves , for every @xmath18 .",
    "in this paper we also restrict to singularities which are isolated , in which case @xmath19 decomposes , up to direct summands , as a direct sum of categories @xmath20 as @xmath21 ranges over the singular locus , and it therefore suffices to consider this local situation .",
    "so let @xmath22 be a local gorenstein @xmath0-algebra of krull dimension @xmath23 with an isolated singularity , by which we mean that @xmath24 is a regular local ring for every non - maximal prime ideal @xmath25 .",
    "the object of interest in this paper is the triangulated category @xmath26 the morphisms in this category are defined via a calculus of fractions , and it will be more convenient to work in a category of `` resolutions '' , namely the homotopy category @xmath27 of acyclic complexes of finite free @xmath28-modules . the functor @xmath29 is an equivalence of triangulated categories ( * ? ? ? * ( 4.4.1 ) ) , so we are justified in working exclusively in the category @xmath1 .",
    "we note that cokernels of the differentials in complexes in @xmath1 are precisely the _ maximal cohen - macaulay @xmath28-modules _ , and the stable category @xmath30 of these modules is equivalent to @xmath1 .",
    "the stable category is a classical object of singularity theory ; for example , results of knrrer @xcite and buchweitz - greuel - schreyer @xcite characterise the simple hypersurface singularities in terms of the structure of @xmath30 .    a fundamental theorem of auslander @xcite states that @xmath1 has a serre functor @xmath31 $ ] .",
    "there is another proof due to buchweitz , who points out @xcite that it would be interesting to have a closed formula for the corresponding pairing .",
    "there was little progress on this question until 2003 , when the mathematical physicists kapustin and li derived a formula for the pairing in the singularity category of a hypersurface @xmath32 with an isolated singularity .",
    "more precisely , they found a formula for disc correlators in the b - twisted supersymmetric landau - ginzburg model with target space @xmath33 and potential @xmath34 @xcite .",
    "the singularity category of the hypersurface appears as a category of boundary conditions in this model , so their formula for the disc correlator gave a strong candidate for the duality pairing .",
    "however , it remained an open question how to prove that this candidate pairing was actually nondegenerate .",
    "+ in the rest of this introduction we state our general formula for a nondegenerate pairing on the morphism spaces of @xmath1 , and explain how this specialises to the kapustin - li formula for hypersurfaces .",
    "fix a complex @xmath35 with differential @xmath36 .",
    "the punctured spectrum @xmath37 is regular by hypothesis , so the restriction @xmath38 is contractible .",
    "we can therefore choose a cover of @xmath39 by open sets @xmath40 , or what is the same , choose a regular sequence @xmath41 in the maximal ideal , such that @xmath42 acts null - homotopically on @xmath43 for @xmath44 .",
    "choose a homotopy @xmath45 on @xmath43 with @xmath46 let @xmath47 be the grading operator on @xmath43 which sends a homogeneous element @xmath48 to @xmath49 .",
    "given @xmath50)$ ] we consider the following degree zero @xmath28-linear operator on @xmath43 @xmath51 the @xmath28-module @xmath43 is certainly not finitely generated , so @xmath52 does not have a trace in the usual sense .",
    "but in each degree @xmath53 we can take the trace of the endomorphism @xmath54 of @xmath55 , and the class @xmath56 in local cohomology is independent of all choices : the integer @xmath53 , the system of parameters @xmath57 , and the null - homotopies @xmath58 . here",
    "we use the notation of generalised fractions , which is recalled in section [ section : cinjres ] . in short",
    ": there is an isomorphism of local cohomology with ech cohomology @xmath59 for @xmath60 which identifies @xmath61 , up to a sign , with the ech cocycle @xmath62 $ ] .",
    "there is a @xmath0-linear map @xmath63 such that composing with @xmath64 defines an isomorphism @xmath65 for any finite - length @xmath28-module @xmath12",
    ". the value of @xmath64 on a generalised fraction should be thought of as a residue ; indeed , if @xmath28 is given as a quotient of a power series ring by a regular sequence then @xmath64 can be defined explicitly in terms of residues over the power series ring . with this notation ,",
    "our main theorem is the following :    there is a nondegenerate pairing @xmath66 ) \\otimes_k { \\mathcal{t}}(x , y ) { \\longrightarrow}k\\ ] ] natural in both variables and compatible with suspension , defined by @xmath67    let us now consider hypersurfaces , where @xmath68 agrees with the pairing of kapustin and li .",
    "+ * matrix factorisations .",
    "* suppose now that @xmath28 is a hypersurface singularity , that is , @xmath69 where @xmath70 $ ] and @xmath34 is a polynomial whose zero locus in @xmath71 has an isolated singularity at the origin . in this case it is a theorem of eisenbud @xcite that every acyclic complex of finite free @xmath28-modules is two - periodic ( up to homotopy equivalence ) and there is an alternative presentation of the category @xmath1 which makes use of this additional symmetry .",
    "a _ matrix factorisation _ of @xmath34 over @xmath72 is a @xmath73-graded free @xmath72-module of finite rank @xmath74 together with an @xmath72-linear map @xmath75 of degree one with @xmath76 .",
    "the map @xmath23 is referred to as the differential .",
    "a morphism of matrix factorisations is an @xmath72-linear map of degree zero which commutes with the differentials .",
    "there is an obvious notion of homotopy , using which we define the homotopy category @xmath77 of matrix factorisations of @xmath34 over @xmath72 .",
    "if @xmath43 is a matrix factorisation then the differential on @xmath78 actually squares to zero , and by the _ periodification _ of this @xmath73-graded complex we mean the @xmath79-graded complex of @xmath28-modules @xmath80 & x^1 \\otimes_s r \\ar[r]^-{d^1 \\otimes 1 } & x^0 \\otimes_s r \\ar[r]^-{d^0 \\otimes 1 } & x^1 \\otimes_s r \\ar[r]^-{d^1 \\otimes 1 } & x^0 \\otimes_s r \\ar[r ] & \\cdots } \\ ] ] with @xmath81 in degree zero . abusing notation , we denote this complex by @xmath82 .",
    "this construction is functorial , and one can show that @xmath82 is an acyclic complex of finite free @xmath28-modules and that this defines an equivalence of triangulated categories @xmath83 .",
    "let us write @xmath84",
    ". induced by this equivalence and the duality structure given on @xmath1 above , there is for @xmath85 a nondegenerate pairing @xmath86 ) \\otimes_k \\m(x ,",
    "y ) { \\longrightarrow}k\\ ] ] natural in both variables and compatible with suspension . by choosing the system of parameters @xmath57 and the null - homotopies @xmath45 appropriately , the pairing can be put in the form @xmath87 in this paper we use the residue symbols of grothendieck @xcite which are defined algebraically , but for @xmath88 these residues agree with the usual analytic residues defined by integration and , modulo the sign , ( [ eq : klformulafinalfinal ] ) is the pairing derived by kapustin and li @xcite .",
    "recently ed segal @xcite found a derivation of this formula via hochschild homology of curved dg - algebras , and carqueville @xcite gave another derivation using the theory of minimal models for @xmath89-categories , but neither of these approaches gives a proof of nondegeneracy .",
    "we note that the kapustin - li pairing has been used in connection with khovanov and rozansky s @xmath90 link homology @xcite .",
    "we conclude with a sketch of how this pairing arises in mathematical physics , following @xcite and @xcite . in the b - type supersymmetric topological landau - ginzburg model with worldsheet @xmath12 , flat target space @xmath91 and potential @xmath92 $ ] , the bosonic fields are the components rather than the more standard @xmath93 to avoid a clash of notation with the above . ]",
    "@xmath94 of maps @xmath95 . for simplicity we are going to assume that @xmath12 is a disc with boundary @xmath96 and we will omit the fermionic fields @xmath97 and @xmath98 from the discussion .    following a suggestion of kontsevich it was explained by kapustin and li @xcite how some matrix factorisations of @xmath34 appear naturally as boundary conditions in this model , and",
    "it was later understood how to introduce arbitrary matrix factorisations @xcite .",
    "let us take this as our starting point , and fix a matrix factorisation @xmath43 of @xmath34 together with a connection .",
    "a vector bundle together with a connection is a gauge field , and in the approach of @xcite ( following @xcite ) one couples the bulk theory to this gauge field by introducing a boundary term @xmath99 in the partition function @xmath100 here @xmath5 is a path integral over the space of all fields @xmath101 , and @xmath102 is the bulk action . to define @xmath99 , consider pulling back the vector bundle @xmath43 with its connection @xmath103 via @xmath104 to the boundary circle @xmath105 , and taking the holonomy of the connection around this loop ; then @xmath99 is the supertrace @xmath106 where @xmath12 is a matrix built from the differential @xmath107 on @xmath43 and connection @xmath103 ( see ( * ? ? ? * ( 4.17 ) ) ) , @xmath108 is the length element along @xmath105 and @xmath109 is the path - ordered exponential . note that the entries of @xmath110 are polynomials in the @xmath111 , so pulling back to @xmath105 amounts to substituting @xmath112 for @xmath111 .",
    "the disc correlator of interest to us is defined by an integral similar to ( [ eq : partitionfunction ] ) .",
    "let @xmath113 be a degree @xmath114 endomorphism of @xmath43 in the category of matrix factorisations",
    ". pulled back to @xmath105 this is a matrix of polynomials in the @xmath94 . in the quantum field theory the fields @xmath94",
    "are promoted to operators @xmath115 labeled with points @xmath116 of the worldsheet .",
    "given @xmath117 these operators are substituted into @xmath113 in order to define the corresponding boundary observable as the matrix of operators @xmath118 the disc correlator @xmath119 is defined by @xmath120 \\draw[very thick ] ( 0,0 ) circle ( 2 cm ) ; \\nicecolourscheme ( 0,0 ) circle ( 2 cm ) ; \\draw ( 0,0 ) node { { $ m$ } } ; \\draw ( 180:2.7 cm ) node { { $ { \\mathcal{o}}_\\alpha$ } } ; \\filldraw [ black ] ( 180:2 cm ) circle ( 3pt ) ; \\draw ( 2.6,0 ) node { { $ x$ } } ; \\end{tikzpicture } \\right\\rangle = \\int \\mathcal{d } \\psi \\ , \\exp(- \\widetilde{s}_{\\text{bulk } } ) \\ , \\operatorname{str}\\!\\big [ h(\\tau ) { \\mathcal{o}}_\\alpha(\\tau ) \\big]\\ ] ] where @xmath121 is the superholonomy operator . after some careful argument",
    ", one shows that this path integral localises to a finite - dimensional integral on the target space @xmath5 , and this integral is precisely the residue ( [ eq : klformulafinalfinal ] ) with @xmath122 . note that the field theory is topological ,",
    "so the correlator does not depend on the position @xmath116 where @xmath123 is inserted . +",
    "* outline . *",
    "we begin in section [ section : outline ] with a proof of auslander s duality in the singularity category which is adapted to finding an explicit formula for the corresponding nondegenerate pairing . in section [ section : cinjres ]",
    "we construct the explicit complete injective resolutions required to actually make the pairing explicit .",
    "the main theorem of the paper , quoted above , is proven in section [ section : duality ] .",
    "finally in section [ section : mfs ] we specialise to hypersurfaces and discuss the kapustin - li formula .",
    "+ _ acknowledgements .",
    "_ it is a pleasure to thank bernhard keller , amnon neeman , henning krause , andreas recknagel , ragnar buchweitz , joseph lipman , tony pantev , jesse burke and hailong dao for enlightening discussion on the subject of this paper .",
    "i am grateful to nils carqueville for sharing his singular algorithms and many detailed comments on the draft , to srikanth iyengar for helping with the proof of lemma [ lemma : special_reg_seq_exists ] , and to igor burban for his encouragement and for introducing me to the paper @xcite .",
    "i owe special thanks to tobias dyckerhoff , who pointed out to me that the perturbation arguments used here could be phrased in terms of the standard homological perturbation lemma ; this has allowed the current version of the paper to be much shorter !",
    "let @xmath0 be a field and @xmath1 a @xmath0-linear triangulated category .",
    "a _ serre functor _ in @xmath1 is a @xmath0-linear triangulated functor @xmath2 together with a family of @xmath0-linear isomorphisms @xmath124 which are natural in @xmath4 and compatible with suspension , by which we mean that the diagram @xmath125 , \\serre x ) \\ar[r]_-{\\cong}^-{\\lambda_{x , y[-1 ] } } & \\hom_k({\\mathcal{t}}(x , y[-1]),k)\\\\ { \\mathcal{t}}(y , ( \\serre x)[1 ] ) \\ar[u]_{\\cong}\\\\ { \\mathcal{t}}(y , \\serre ( x[1 ] ) ) \\ar[u]_{\\cong } \\ar[r]^-{\\cong}_-{\\lambda_{x[1 ] , y } } & \\hom_k({\\mathcal{t}}(x[1 ] , y),k ) \\ar[uu]^{\\cong}\\ , . } \\ ] ] commutes .",
    "alternatively , we can present @xmath126 as a family of nondegenerate pairings which satisfy conditions expressing the same naturality and compatibility with suspension .",
    "if we say that a local ring @xmath22 is a @xmath0-algebra , it will be implicit that @xmath127 is the identity . unless specified otherwise all tensor products are @xmath28-linear .    for background on matrix factorisations",
    "see @xcite for commutative algebra , especially local cohomology , we recommend @xcite , and for triangulated categories see @xcite .",
    "in this section we give a new proof of auslander s duality in the singularity category of a gorenstein isolated singularity .",
    "the argument is predicated on the fundamental fact , proved in the next section , that we can explicitly construct complete injective resolutions . in organising the proof this way we hope to convince the reader of the utility of complete injective resolutions before getting down to the hard work of the construction in the next section .",
    "the reader who wants to read the full details in linear order should proceed to read section [ section : cinjres ] and then return here .",
    "the setting is more general than the one adopted in the introduction : throughout @xmath22 is a local gorenstein ring of krull dimension @xmath23 with an isolated singularity .",
    "we do not assume that @xmath28 is a @xmath0-algebra , but we will remark on the additional features in this case as we go along .",
    "we have already introduced the equivalence of triangulated categories @xmath128 due to buchweitz ( * ? ? ?",
    "* ( 4.4.1 ) ) , where @xmath129 this equivalence sends @xmath130 to the cokernel of the differential @xmath131 .",
    "the inverse functor sends a module @xmath12 , viewed as an object of the category @xmath132 , to an acyclic complex of free modules usually called the complete free resolution .",
    "this complex will play a role analogous to that played by the projective resolution in the derived category : morphisms in @xmath132 are modeled by homotopy equivalence classes of maps between complete resolutions .    for convenience we choose to formalise the definition in the following way :    [ defn : cfreeres ] a _ complete free resolution _ of a finitely",
    "generated @xmath28-module @xmath12 is an acyclic complex of finite free @xmath28-modules @xmath130 together with a morphism @xmath133 of complexes of @xmath28-modules with the following properties :    * @xmath98 _ is universal _ :",
    "for any acyclic complex @xmath134 of free @xmath28-modules the induced map @xmath135 is a quasi - isomorphism .",
    "* @xmath98 _ truncates to a resolution _ :",
    "the sequence @xmath136 is exact .",
    "the complete free resolution , if it exists , is unique up to homotopy equivalence and is denoted @xmath137 .    [ remark : functor_cprojres ] the complete free resolution is functorial : given a morphism @xmath138 of finitely generated @xmath28-modules with complete free resolutions @xmath139 and @xmath140 , there is a unique morphism @xmath141 in @xmath142 making the diagram @xmath143_{\\cf(\\alpha)}\\ar[r ] & m \\ar[d]^\\alpha\\\\ \\cf n \\ar[r ] & n } \\ ] ] commute up to homotopy .",
    "it is easy to see that every object of @xmath132 is isomorphic to a finitely generated @xmath28-module  @xmath12 with the property that @xmath144 for @xmath145 .",
    "equivalently , there is a sequence in @xmath146 of length @xmath23 which is regular on @xmath12 .",
    "such modules are called _ maximal cohen - macaulay modules _ ( or cm modules , for short ) . below",
    "we sketch how to construct the complete free resolution of such a module ; if a cm module has finite projective dimension then it is projective , and in this case it will be clear that the complete free resolution is contractible .",
    "it follows that there is a functor @xmath147 from @xmath132 to @xmath1 which is , by definition , inverse to ( [ eq : kactodsing ] )",
    ".    for complete details of the following construction see ( * ? ? ?",
    "* xii.3 ) and @xcite .",
    "let @xmath12 be a cm @xmath28-module .",
    "we begin with free resolutions of @xmath12 and its dual @xmath148 : @xmath149 then one splices @xmath134 with @xmath150 using the morphism @xmath151 & m \\ar[r ] & \\hom_r(\\hom_r(m , r),r ) \\ar[r ] & \\hom_r(q^0,r ) } \\ ] ] to obtain a complex @xmath130 of finite free @xmath28-modules with @xmath152 in degree zero . by construction @xmath12",
    "is the cokernel of the differential @xmath131 and using the fact that @xmath12 is cm one argues that @xmath130 is acyclic .",
    "this is the desired complete free resolution of @xmath12 .",
    "[ lemma : source_coprojres ] given @xmath153 the module @xmath154 is cm and the canonical map @xmath155 , viewed as a morphism of complexes @xmath156 , is a complete free resolution of @xmath12 .",
    "this is the content of ( * ? ? ?",
    "* lemma 3.6 ) .",
    "the point is that brutally truncating @xmath130 in degrees @xmath157 gives a free resolution @xmath134 of @xmath12 , and the mapping cone of the truncation morphism @xmath158 is homotopy equivalent to a bounded below complex @xmath159 of free modules . if @xmath160 is an acyclic complex of free modules then one checks that @xmath161 must be acyclic , from which the necessary universal property of @xmath156 follows .",
    "next we explain why the morphism spaces in @xmath1 have finite - length . by hypothesis , for each non - maximal prime ideal @xmath162 the ring @xmath24 is regular , and therefore every finitely generated @xmath24-module has projective dimension @xmath163 . if @xmath130 is an acyclic complex of finite free @xmath24-modules then the brutal truncation in degrees @xmath164 serves as a free resolution of some module , and hence the modules @xmath165 are projective for @xmath166 . since @xmath167 is arbitrary , @xmath130 is contractible .",
    "[ lemma : homs_finite_length ] for @xmath168 the @xmath28-module @xmath169 has finite length .    for @xmath162 a non - maximal prime @xmath170 where @xmath171 .",
    "if @xmath28 is a @xmath0-algebra then it follows that @xmath169 is a finite - dimensional @xmath0-vector space , and duality in @xmath1 can then formulated in terms of the dual @xmath172 . in general",
    "we proceed differently , using the local cohomology module @xmath173 because @xmath28 is gorenstein this is an injective envelope of @xmath0 , and the matlis dual @xmath174 is therefore exact .",
    "if @xmath28 is a @xmath0-algebra then the matlis dual agrees with the usual dual on the category of finite - length @xmath28-modules , that is , for any finite - length @xmath28-module @xmath12 there is a natural isomorphism @xmath175 we will have more to say about this isomorphism and its relation to residues in section [ section : dualisingpairsyo ] , but for now let us proceed to establish duality in @xmath1 using the functor @xmath174 .",
    "as has already been mentioned , the next theorem gives a new proof of a result originally due to auslander ( * ? ? ?",
    "* proposition 8.8 in ch.1 and proposition 1.3 in ch.3 ) , of which there is another proof by buchweitz ( * ? ? ?",
    "* theorem 7.7.5 ) .",
    "[ theorem : ausdual ] given @xmath168 there is an isomorphism of @xmath28-modules @xmath176 ) \\cong \\hom_r({\\mathcal{t}}(x , y),h^d_{{\\mathfrak{m}}}(r))\\ ] ] which is natural in both variables and compatible with suspension , in the sense of section [ section : prelim ] .",
    "let us set @xmath177 so that the canonical map @xmath178 is a complete free resolution .",
    "there is a natural quasi - isomorphism ( @xmath179 denotes quasi - isomorphisms and @xmath180 is the dual complex @xmath181 ) @xmath182 at this point we make use of two facts whose proofs will be given in the next section .",
    "the first is that @xmath183 is an acyclic complex of injectives , and the second is that for any acyclic complex of injectives @xmath184 there is a quasi - isomorphism @xmath185 , i)\\ ] ] induced by a special morphism of complexes @xmath186 $ ] called the _ complete injective resolution _ of @xmath187 . taking this as a given",
    ", we may continue @xmath188 , x \\otimes h^d_{{\\mathfrak{m}}}(r))\\\\ & \\cong \\hom_r ( y [ 1-d ] , \\hom_r(h^d_{{\\mathfrak{m}}}(r ) , x \\otimes h^d_{{\\mathfrak{m}}}(r)))\\\\ & \\cong \\hom_r ( y[1-d ] , x \\otimes \\operatorname{end}_r ( h^d_{{\\mathfrak{m}}}(r ) ) ) \\\\ & \\cong \\hom_r ( y[1-d ] , x \\otimes \\widehat{r } ) \\\\ & \\simeq \\hom_r ( y[1-d ] , x ) \\otimes \\widehat{r}\\\\ & \\simeq \\hom_r ( y , x[d-1 ] ) \\,.\\end{aligned}\\ ] ] here @xmath189 is the @xmath146-adic completion of @xmath28 , and we have used a theorem of matlis which states that @xmath190 is naturally a @xmath189-module and sending @xmath191 to multiplication by @xmath192 on @xmath190 gives an isomorphism @xmath193 .",
    "the last line follows from the fact that the hom spaces in @xmath1 have finite - length , and taking @xmath194 in the above gives the desired isomorphism in ( [ eq : ausdual1 ] ) .",
    "naturality of this isomorphism is clear from the construction , and compatibility with suspension can be checked directly , but this is tedious ; we will see a better proof in lemma [ lemma : ptrproperties ] below .",
    "if @xmath28 is a @xmath0-algebra then combining the theorem with ( [ eq : firstoccurdualisingpair ] ) yields a natural isomorphism @xmath195 ) \\cong \\hom_k ( { \\mathcal{t}}(x , y ) , k ) \\,.\\ ] ] observe that every step in the proof of the theorem makes use of explicit standard isomorphisms , with the exception of the step involving the complete injective resolution , and if @xmath28 is a @xmath0-algebra the isomorphism ( [ eq : firstoccurdualisingpair ] ) .",
    "if we want explicit formulas we must therefore understand these maps .",
    "let @xmath22 be a local gorenstein ring of krull dimension @xmath23 with an isolated singularity .",
    "[ defn : cinjres ] a _ complete injective resolution _ of an @xmath28-module @xmath12 is an acyclic complex of injective @xmath28-modules @xmath184 together with a morphism of complexes @xmath196 which _ universal _ , in the sense that for any acyclic complex @xmath197 of injective @xmath28-modules the induced map @xmath198 is a quasi - isomorphism @xcite .",
    "the complete injective resolution , if it exists , is unique up to homotopy equivalence and denoted @xmath199 .",
    "if @xmath138 is a morphism of @xmath28-modules the induced morphism on the complete injective resolutions is denoted @xmath200 .",
    "let @xmath12 be a cm @xmath28-module with complete free resolution @xmath133 .",
    "the differential on @xmath130 will be denoted @xmath36 . because the singularity of @xmath28 is isolated",
    "the complex @xmath201 is contractible for every non - maximal prime @xmath162 .",
    "we are going to construct a complete injective resolution of @xmath12 , essentially by making explicit the fact that @xmath130 is `` supported '' on the closed point , and for this we use the stable koszul complex of local cohomology .",
    "let @xmath41 be a system of parameters for @xmath28 , that is , a sequence of length @xmath23 generating an @xmath146-primary ideal in @xmath28 . since @xmath28 is gorenstein , this is the same as a regular sequence of length @xmath23 in @xmath146 or a sequence @xmath57 such that the open sets @xmath202 cover the punctured spectrum @xmath37 .",
    "the _ stable koszul complex _",
    "@xmath203 is the tensor product @xmath204 ^ -{\\can } & r[t_i^{-1 } ] \\theta_i } \\right)\\,,\\ ] ] where the underline indicates cohomological degree zero . here",
    "the @xmath205 are formal variables of degree one , introduced to keep track of the grading . if we adopt the convention that the @xmath205 s anticommute and that @xmath206 , then @xmath207 is the @xmath208-graded @xmath28-module @xmath209 \\theta_{i_1 } \\cdots \\theta_{i_p}\\ ] ] with the differential @xmath210 given by left multiplication with @xmath211 .",
    "if a prime ideal @xmath162 is non - maximal  then @xmath212 for some @xmath53 , so @xmath213 $ ] is an isomorphism and @xmath214 is contractible .",
    "hence the cohomology of @xmath207 is supported on the closed point @xmath146 , and moreover the projection @xmath215 is the universal morphism in the unbounded derived category @xmath216 from a complex supported on the closed point to @xmath28 .",
    "more precisely , if @xmath5 is a complex whose cohomology is supported on @xmath146 then any morphism @xmath217 in the derived category factors uniquely through @xmath218 .",
    "the local cohomology of @xmath28 is defined by @xmath219 .",
    "the cone of the projection @xmath218 is a shift of the ech complex of @xmath39 and it follows that @xmath220 for @xmath60 . since @xmath28 is gorenstein we have @xmath221 for @xmath145 and therefore an augmentation quasi - isomorphism @xmath222\\,,\\ ] ] which amounts to an epimorphism @xmath223 \\theta_1 \\cdots \\theta_d { \\longrightarrow}h^d_{{\\mathfrak{m}}}(r)$ ] . given @xmath224 and integers @xmath225 one introduces the _ generalised fraction _",
    "@xcite @xmath226 we also use the notation @xmath227 $ ] .",
    "this can be viewed as a ech cocycle , since @xmath228 { \\longrightarrow}r[t_1^{-1},\\ldots , t_d^{-1 } ] \\big)\\,.\\ ] ] it is clear from the definition that acting on a generalised fraction @xmath229 $ ] with some @xmath42 has the effect of decreasing the exponent of @xmath42 in the denominator and that if @xmath230 then @xmath231 = 0 $ ] in @xmath190 . in the same way",
    ", we define generalised fractions in @xmath232 for any @xmath28-module @xmath187 .    in special cases",
    "the description of injective envelopes in terms of inverse polynomials goes back to gabriel @xcite , hartshorne @xcite and northcott @xcite .",
    "our presentation largely follows the one in lipman s monograph @xcite or kunz s recent book @xcite .",
    "see also ( * ? ? ?",
    "*   4 ) .",
    "while @xmath233 is defined using a specific system of parameters @xmath57 , it has a universal property in the derived category and therefore @xmath190 is independent of this choice , up to canonical isomorphism .",
    "we will have to manipulate generalised fractions in @xmath190 with denominators given by different regular sequences , and these can be related by the so - called transformation rule or transition formula contained in the next proposition .",
    "note that if @xmath234 are systems of parameters then for some @xmath235 we have @xmath236 .",
    "[ prop : transition_det ] let @xmath237 be systems of parameters such that @xmath238 with @xmath239 @xmath240 .",
    "then as elements of @xmath190 we have @xmath241    see for example ( * ? ? ?",
    "* corollary 2.8 ) or ( * ? ? ? * theorem 4.18 ) .    given @xmath242 the image under the complete resolution @xmath133",
    "is denoted @xmath243 .",
    "we are now prepared to state the main theorem .",
    "[ thm : construct_cinjres ] let @xmath57 be a system of parameters with @xmath244 null - homotopic for @xmath44 and choose for each @xmath53 a homotopy @xmath45 on @xmath130 with @xmath245 .",
    "then the morphism @xmath246\\ ] ] defined by @xmath247 is a complete injective resolution . up to homotopy @xmath248 is independent of the system of parameters @xmath57 and homotopies @xmath45 .",
    "the proof will occupy the rest of this section . in outline : since @xmath12 is the cokernel of the differential @xmath249 there is a unique map @xmath250 with @xmath251 , and this defines a morphism of complexes @xmath252 $ ] .",
    "we will prove that the projection @xmath253 is a homotopy equivalence and produce , using the perturbation lemma , an explicit inverse @xmath254 involving the @xmath45 .",
    "the composite @xmath255 ^ -{i } & t[1 ] \\ar[r]^-{\\iota_\\infty } & t \\otimes \\operatorname{k}_\\infty [ 1 ] \\ar[r]^-{\\gamma } & t \\otimes h^d_{{\\mathfrak{m}}}(r)[1-d ] } \\ ] ] turns out to be described by ( [ eq : construct_cinjres ] ) , and we prove that it has the necessary universal property .",
    "there exists a system of parameters @xmath57 such that @xmath244 is null - homotopic for @xmath44 .",
    "the @xmath28-module @xmath256 of homotopy equivalence classes of self - maps of @xmath130 has finite - length by lemma [ lemma : homs_finite_length ] , so the annihilator contains a system of parameters .",
    "@xmath257 is an acyclic complex of injective @xmath28-modules .",
    "since @xmath190 is injective , it suffices to prove that this complex is acyclic .",
    "the argument is standard : given an injective @xmath28-module @xmath197 and a pair of integers @xmath258 the brutal truncation @xmath259 is a free resolution of the module of cocycles @xmath260 , so we have @xmath261 which vanishes for @xmath262 since @xmath197 has projective dimension @xmath163 ( here we use that @xmath28 is gorenstein ) .",
    "we conclude that @xmath263 is acyclic .    from now on",
    "we suppose that a system of parameters @xmath57 and sequence of null - homotopies @xmath264 has been chosen , and we construct the inverse to the projection @xmath253 . the basic idea is to begin with a homotopy equivalence between @xmath265 and @xmath130 with the differential @xmath210 on @xmath207 `` turned off '' and then perturb this differential back in while maintaning the homotopy equivalence .",
    "[ defn:2perp ] a _ deformation retract datum _ of complexes of @xmath28-modules consists of a diagram @xmath266_{\\iota } & ( m , b ) , \\ar@<-0.8ex>[l]_p } \\quad h\\ ] ] where @xmath267 and @xmath268 are complexes , @xmath269 and @xmath270 are morphisms of complexes , and @xmath271 is a degree one @xmath28-linear map @xmath272 , which together satisfy the following two conditions :    * @xmath273 , * @xmath274 .",
    "notice that in particular @xmath269 is a homotopy equivalence with inverse @xmath270 .",
    "suppose we are given a deformation retract datum .",
    "a degree one @xmath28-linear map @xmath275 is a _ small perturbation _ if @xmath276 and @xmath277 for all sufficiently large integers @xmath167 . in this case",
    "@xmath278 so @xmath279 is an isomorphism of graded @xmath28-modules , and we set @xmath280 consider the following collection of data : @xmath281_{\\iota_\\infty } & ( m , b + \\mu ) , \\ar@<-0.8ex>[l]_{p } } \\quad h_\\infty\\ ] ] where @xmath282    the next result is known as the _ homological perturbation lemma _ @xcite .",
    "[ theorem : perp ] if @xmath104 is a small perturbation and @xmath283 then ( [ eq : new_perturb_fac ] ) is a deformation retract datum .",
    "see ( * ? ? ?",
    "* theorem 2.3 ) .    given a sequence @xmath284",
    "we define @xmath285 : = r[t_{i_1}^{-1},\\ldots , t_{i_p}^{-1}]$ ] and @xmath286 .",
    "the complex @xmath287 is a direct sum of @xmath130 and @xmath288 \\theta_{\\bs{i}}$ ] for various sequences @xmath289 . in the notation of the theorem @xmath245 and",
    "therefore over @xmath290 $ ] @xmath291 thus each complex @xmath288 \\theta_{\\bs{i}}$ ] is contractible , with @xmath292 giving a contracting homotopy for any @xmath293 . for convenience ,",
    "we use @xmath294 in what follows .",
    "the upshot is that the inclusion of @xmath130 as a subcomplex of @xmath287 is a homotopy equivalence .",
    "we can express this in terms of a deformation retract by introducing the @xmath28-linear homotopy @xmath295 where for the empty sequence @xmath296 we set @xmath297 , and for sequences of positive length we define @xmath298 \\theta_{\\bs{i } } { \\longrightarrow}t[t^{-1}_{\\bs{i } } ] \\theta_{\\bs{i } } \\,,\\\\ h_{\\bs{i } } = t_{i_1}^{-1 } \\lambda_{i_1}\\,.\\end{gathered}\\ ] ] it is then easily checked that there is a deformation retract datum @xmath299_-{\\iota } & ( t \\otimes \\operatorname{k}_\\infty,\\partial \\otimes 1 ) , \\ar@<-0.8ex>[l]_-{\\varepsilon } } \\quad -h\\ ] ] where @xmath270 is the inclusion of @xmath130 into @xmath265 .",
    "since @xmath300 is bounded it is clear that @xmath301 is a small perturbation on @xmath265 , so as a consequence of the perturbation lemma we have :    [ lemma : projishe ] there is a deformation retract datum @xmath299_-{\\iota_\\infty } & ( t \\otimes \\operatorname{k}_\\infty,\\partial \\otimes 1 + 1 \\otimes \\delta ) , \\ar@<-0.8ex>[l]_-{\\varepsilon } } \\quad h_\\infty\\ ] ] where @xmath302 . in particular",
    ", @xmath218 is a homotopy equivalence with inverse @xmath254 .",
    "we define @xmath248 to be the composite in ( [ eq : defnvartheta ] ) , noting that there is an sign due to the isomorphism @xmath303 \\big ) \\cong ( t \\otimes h^d_{{\\mathfrak{m}}}(r))[-d]\\,.\\ ] ]    [ lemma : varthetaisok ] the map @xmath248 is given by the formula in ( [ eq : construct_cinjres ] ) .",
    "let a homogeneous element @xmath304 be given .",
    "then @xmath305 since @xmath271 decreases the @xmath130-degree by one and @xmath210 increases the @xmath207-degree by one , only the @xmath306 term survives after applying @xmath307 , so @xmath308 .",
    "here @xmath309 applies to @xmath265 with koszul signs , as we move the @xmath310 s past elements of @xmath130 .",
    "since @xmath210 is left multiplication by @xmath211 the product @xmath311 expands as a sum of @xmath312 terms .",
    "it follows from ( [ eq : cech_present_kos ] ) that in @xmath190 a fraction without a full complement of @xmath42 s vanishes , and",
    "since @xmath271 applied to @xmath313 multiplies by @xmath314 the only one of these @xmath312 summands which contributes a nonzero cocycle in local cohomology is the one where we apply @xmath315 , then @xmath316 , and so on ; that is , @xmath317 multiplying by the extra factor of @xmath318 and accounting for the sign from ( [ eq : commutesignd ] ) , this recovers the formula of ( [ eq : construct_cinjres ] ) .",
    "note that if @xmath242 then @xmath319 .",
    "it remains to check that @xmath248 has the desired universal property .",
    "[ lemma : iisgood ] let @xmath184 be an acyclic complex of injective @xmath28-modules .",
    "then the induced map @xmath320 , i ) { \\longrightarrow}\\hom_r(m , i)\\ ] ] is a quasi - isomorphism .",
    "we will prove that @xmath321 , i ) { \\longrightarrow}\\hom_{\\k(r)}(m , i)$ ] is surjective and leave the proof of injectivity to the reader .",
    "if @xmath322 is a morphism of complexes then there is a factorisation @xmath323 , where @xmath324 , as in the commutative diagram @xmath80 & t^{-1 } \\ar[r]^{-\\partial } & t^0 \\ar[dr]_{-\\rho } \\ar[rr]^-{-\\partial } & & t^1 \\ar[r]^{-\\partial } & t^2 \\ar[r ] & \\cdots\\\\ & & & m \\ar@/^/[ddr]^f \\ar[d]_{\\overline{f } } \\ar[ur]_i\\\\ & & & z \\ar[dr]\\\\ \\cdots \\ar[r ] & i^{-2 } \\ar[r ] & i^{-1 } \\ar[ur ] \\ar[rr ] & & i^0 \\ar[r ] & i^1 \\ar[r ] & \\cdots } \\ ] ] using projectivity of the top row and acyclicity of the bottom row , we lift @xmath325 to a sequence of maps @xmath326 making the diagram commute in degrees @xmath327 . then using acyclicity of the top row and injectivity of the bottom row we produce the @xmath328 for @xmath329 , and together these maps define a morphism @xmath330 { \\longrightarrow}i$ ] lifting @xmath331 .",
    "[ lemma : tskosvs ] let @xmath184 be an acyclic complex of injective @xmath28-modules .",
    "then the induced map @xmath332 , i ) \\ ] ] is a quasi - isomorphism .",
    "let @xmath333 and @xmath334 $ ] be the brutal truncations .",
    "there is a triangle @xmath335 & f \\ar[r ] & k \\ar[r]^{+ } & } \\ ] ] from which we deduce morphisms of triangles ( we write @xmath336 $ ] to avoid clutter ) @xmath337\\ar[d ] & f \\otimes \\operatorname{k}_\\infty \\ar[r]\\ar[d ] & k \\otimes \\operatorname{k}_\\infty",
    "\\ar[d]\\ar[r]^-{+ } & \\\\ t \\otimes j \\ar[r ] & f\\otimes j \\ar[r ] & k \\otimes j \\ar[r]^-{+ } & } \\ ] ] and ( writing @xmath338 = \\hom_r(-,-)$ ] ) @xmath339 & [ f \\otimes \\operatorname{k}_\\infty , i ] \\ar[l ] & [ k \\otimes \\operatorname{k}_\\infty , i ] \\ar[l ] & \\ar[l]_-{+}\\\\ [ t \\otimes j , i ] \\ar[u]^{\\psi ' } & [ f\\otimes j , i]\\ar[u]^{\\psi}\\ar[l ] & [ k \\otimes j , i ] \\ar[l]\\ar[u]^{\\psi '' }   & \\ar[l]_-{+}\\ , . } \\ ] ] to prove that @xmath340 is a quasi - isomorphism , it suffices to prove that both @xmath341 and @xmath342 are .",
    "let @xmath105 denote the cone of the quasi - isomorphism @xmath343 , so that @xmath105 is a bounded acyclic complex",
    ". then @xmath344 \\cong [ p , [ c , i]]\\,.\\ ] ] any morphism from @xmath105 to @xmath184 factors through a bounded below complex of injectives and is therefore null - homotopic , that is , @xmath345 $ ] is acyclic .",
    "hence @xmath346 $ ] is acyclic and @xmath341 is a quasi - isomorphism .",
    "the cone of @xmath342 is @xmath347 $ ] .",
    "we know that @xmath263 is acyclic , so the first two vertical maps in ( [ eq : tskosvs1 ] ) are quasi - isomorphisms .",
    "hence the third vertical map is a quasi - isomorphism , and @xmath348 is a bounded below acyclic complex . but then @xmath349 $ ] is acyclic , so @xmath342 is a quasi - isomorphism and we are done .    for an acyclic complex of injective @xmath28-modules",
    "@xmath184 we apply @xmath350 = \\hom_r(-,i)$ ] to ( [ eq : defnvartheta ] ) to obtain a chain of quasi - isomorphisms using lemma [ lemma : tskosvs ] , lemma [ lemma : projishe ] and lemma [ lemma : iisgood ] @xmath351 , i\\big ] \\ar[r ] & \\big[t \\otimes \\operatorname{k}_\\infty[1 ] , i\\big ] \\ar[r ] & \\big[t[1 ] , i\\big ] \\ar[r ] & \\big[m , i\\big]\\ , . } \\ ] ] this proves that @xmath248 is a complete injective resolution .",
    "it only remains to argue that , up to homotopy , @xmath248 is independent of @xmath57 and the @xmath45 . but",
    "this is clear , since the definition in ( [ eq : defnvartheta ] ) involves no choices .",
    "we include the following remarks for completeness : they will not be needed in the sequel .",
    "[ remark : minimal_comp_free_res ] a complex of finite free @xmath28-modules @xmath43 is _ minimal _ if @xmath352 has zero differential .",
    "any isomorphism class in @xmath1 contains a minimal complex @xcite which is unique up to isomorphism in the category of complexes . if @xmath12 has no free summands and we take both @xmath134 and @xmath353 to be minimal resolutions , then the complete resolution of @xmath12 constructed in ( [ eq : constructed_cproj_ress ] ) is minimal .",
    "a complex of injective @xmath28-modules @xmath184 is _ minimal _ if an endomorphism @xmath354 is a homotopy equivalence if and only if it is an isomorphism of complexes ; equivalently , if for every @xmath355 the inclusion @xmath356 is an injective envelope ( * ? ? ?",
    "* lemma b.1 ) .",
    "suppose that @xmath357 is minimal and consider the isomorphism @xmath358 set @xmath359 .",
    "since @xmath360 has zero differential , for @xmath355 the socle of @xmath361 is contained in @xmath362 .",
    "every element of @xmath361 is @xmath146-torsion , so it follows that the inclusion @xmath356 is essential , and thus @xmath184 is minimal .",
    "hence if @xmath12 is a cm @xmath28-module and @xmath130 a minimal complete free resolution of @xmath12 , theorem [ thm : construct_cinjres ] will produce a _",
    "minimal _ complete injective resolution .",
    "[ remark : orderingandsigns ] the homotopy class of @xmath248 is independent of the ordering of the symbols @xmath363 in ( [ eq : construct_cinjres ] ) , up to signs : applying these maps in any order defines a morphism @xmath364 $ ] homotopic to @xmath365 where @xmath366 is the corresponding permutation on @xmath367 letters .    to see this note that @xmath368 annihilates any generalised fraction with @xmath369 in the denominator ,",
    "so @xmath36 effectively anticommutes with @xmath45 in ( [ eq : construct_cinjres ] ) .",
    "let @xmath370 be @xmath57 with @xmath371 and @xmath372 interchanged . by the transformation rule ( proposition [ prop : transition_det ] )",
    "there is an equality @xmath373 = - [ 1\\,/\\ , \\bs{t}']$ ] of generalised fractions , and hence @xmath58 and @xmath374 anticommute in ( [ eq : construct_cinjres ] ) .",
    "complete injective resolutions give an embedding of the singularity category into a compactly generated triangulated category , for any separated noetherian scheme @xmath43 .",
    "using brown representability krause proves in @xcite that complete injective resolutions exist in this generality , and that taking complete injective resolutions defines a fully faithful functor @xmath375 where @xmath376 is the homotopy category of acyclic complexes of injective quasi - coherent sheaves .",
    "moreover , he shows that this category is compactly generated and that the image of the embedding @xmath377 is , up to split idempotents , exactly the subcategory of compact objects .",
    "let @xmath22 be a local gorenstein ring of krull dimension @xmath23 with an isolated singularity and define @xmath129 given @xmath168 the isomorphism of theorem [ theorem : ausdual ] corresponds to a nondegenerate pairing @xmath378 ) \\otimes { \\mathcal{t}}(x , y ) { \\longrightarrow}h^d_{{\\mathfrak{m}}}(r)\\,.\\ ] ] in this section we give an explicit formula for this pairing , using the construction of complete  injective resolutions in section [ section : cinjres ] .",
    "when @xmath28 is a @xmath0-algebra this can be refined to a nondegenerate pairing taking values in @xmath0 , by taking residues of generalised fractions .",
    "our convention is that functions taking values in local cohomology ( resp . in @xmath0 ) are given double brackets @xmath379 ( resp .",
    "ordinary brackets @xmath380 ) .",
    "we will see that the pairing @xmath381 factors as composition followed by a `` pretrace '' map @xmath382 ) \\otimes { \\mathcal{t}}(x , y ) \\ar[r]^-{- \\circ - } & { \\mathcal{t}}(x , x[d-1 ] ) \\ar[r]^-{\\plangle - \\prangle } & h^d_{{\\mathfrak{m}}}(r)\\ , , } \\ ] ] that is @xmath383 .",
    "we are going to first describe a formula for @xmath379 , and then prove that  the pairing determined by this formula is indeed the one produced by theorem [ theorem : ausdual ] . to this end",
    "we  fix  a complex @xmath35 with differential @xmath36 and , as in the previous section , we choose a system of parameters  @xmath57 acting null - homotopically on @xmath43 together with null - homotopies @xmath45 on @xmath43 such that @xmath384 given a morphism @xmath385 $ ] we define the degree zero operator @xmath52 on @xmath43 as in equation ( [ eq : defnptr0 ] ) of the introduction .",
    "recall the claim made in the introduction that the class @xmath386 is independent of all choices : the integer @xmath53 , the system of parameters @xmath57 , and the null - homotopies @xmath58 .",
    "independence of the second two choices will follow from the next theorem , and independence of @xmath53 is the statement of the following lemma .",
    "we write @xmath387 for @xmath379 if we want to emphasise @xmath43 .",
    "[ lemma : ptrandinteger ] for @xmath388 we have the following equality in @xmath190 : @xmath389    it suffices to prove that @xmath390 in @xmath391 . but",
    "using ( [ eq : homotopylambdasec4 ] ) we have @xmath392 continuing to `` rotate '' @xmath36 through the trace in this direction takes care of all @xmath393 , and for @xmath394 we simply rotate the other way .",
    "the main theorem states that the functional @xmath379 determines auslander s duality .",
    "[ theorem : genfracformula ] the nondegenerate pairing of ( [ eq : duality1 ] ) takes the value @xmath395 for a pair of morphisms @xmath396 $ ] and @xmath397 .",
    "if we set @xmath398 then the morphism @xmath399 $ ] defined by @xmath400\\end{gathered}\\ ] ] is a complete injective resolution , by theorem [ thm : construct_cinjres ] .",
    "if we begin with a morphism @xmath396 $ ] at the end of the chain of quasi - isomorphisms in the proof of theorem [ theorem : ausdual ] , then the corresponding function @xmath401 evaluates on @xmath397 to the image of the identity under the composite @xmath402 ^ -{1 \\otimes \\vartheta } & x^{\\dual } \\otimes x \\otimes h^d_{{\\mathfrak{m}}}(r)[1-d ] \\ar[r]^-{1 \\otimes ( \\psi \\circ \\phi ) \\otimes 1 } & x^{\\dual } \\otimes x \\otimes h^d_{{\\mathfrak{m}}}(r ) \\ar[d]^{\\eval \\otimes 1}\\\\ r \\ar[u]^{\\textup{coev } } & & h^d_{{\\mathfrak{m}}}(r)\\ , . } \\ ] ] here @xmath403 denotes the map sending @xmath404 to @xmath405 for a basis @xmath406 of @xmath407 , and @xmath408 is the usual evaluation map . for readability",
    "we omit the canonical isomorphisms used to pull shifts out of components of the tensor product .",
    "we conclude that @xmath409\\\\ & = ( -1)^{\\binom{d+1}{2 } } \\operatorname{tr}\\left ( \\psi \\circ \\phi \\circ \\lambda_1 \\cdots \\lambda_d \\circ \\partial \\right)^0 \\cdot \\big [ 1 \\ ; / \\ ; t_1 , \\ldots , t_d \\,\\big]\\\\ & = \\plangle \\psi \\circ \\phi \\prangle\\end{aligned}\\ ] ] as claimed .",
    "finally we enumerate some basic properties of the pretrace map @xmath410 ) { \\longrightarrow}h^d_{{\\mathfrak{m}}}(r)\\,.\\ ] ] since the pairing @xmath381 is canonically defined and @xmath411 we see that @xmath379 does not depend on a choice of system of parameters or null - homotopies .",
    "[ lemma : ptrproperties ] the pretrace map has the following properties :    * for morphisms @xmath396 $ ] and @xmath397 , @xmath412 . * for a morphism",
    "@xmath413 $ ] , @xmath414}$ ] .",
    "\\(i ) is an immediate consequence of the naturality of the isomorphism in theorem [ theorem : ausdual ] .",
    "if we use the null - homotopies @xmath415 for the action of @xmath371 on @xmath416 $ ] , then ( ii ) follows from lemma [ lemma : ptrandinteger ] .",
    "[ remark : gradedcomm ] in the formula ( [ eq : defnptragain ] ) the maps @xmath417 are graded commutative , that is , if @xmath418 stand for one of these maps then interchanging @xmath419 with @xmath420 does not change the cohomology class of the fraction in @xmath190 .",
    "this follows by the arguments of remark [ remark : orderingandsigns ] , and lemma [ lemma : ptrandinteger ] .",
    "let us now assume in addition that @xmath28 is a @xmath0-algebra .",
    "in this section we elaborate on the isomorphism ( [ eq : firstoccurdualisingpair ] ) and its consequences for duality .",
    "an @xmath28-module @xmath12 is called _ @xmath146-torsion _ if every element of @xmath12 is annihilated by some power of @xmath146 .",
    "the hom - spaces @xmath169 are finite - length and therefore @xmath146-torsion , and it is evident from ( [ eq : defn_localcohomology ] ) that the infinite module @xmath190 is also @xmath146-torsion .    a _ dualising pair _",
    "@xmath421 is an @xmath146-torsion module @xmath422 together with a @xmath0-linear map @xmath423 which is universal , in the sense that for every @xmath146-torsion module @xmath12 the map induced by @xmath64 @xmath424 is an isomorphism .",
    "clearly dualising pairs are unique up to isomorphism .",
    "every @xmath146-torsion module is a direct limit of its finite - length submodules and @xmath425 is exact , so ( [ eq : dualising_pair_defn ] ) is an isomorphism for all @xmath12 if and only if it is an isomorphism for @xmath426 .",
    "thus @xmath427 is a dualising pair if and only if the socle @xmath428 is one - dimensional and @xmath64 is nonzero on the socle . in this case",
    "there is a unique @xmath28-linear map @xmath429 such that @xmath430 , and one can check that @xmath422 is an injective @xmath28-module and that @xmath270 is an injective envelope .    reversing this ,",
    "it is easy to produce a dualising pair abstractly : if @xmath422 is an injective envelope of @xmath0 then any @xmath0-linear map @xmath423 which does not vanish on the socle must be a dualising pair ; see for example ( * ? ? ?",
    "* proposition 0.4 ) . since @xmath28 is gorenstein we know that @xmath190 is an injective envelope of @xmath0 , so a dualising pair @xmath431 exists .",
    "the following is immediate from theorem [ theorem : ausdual ] once we choose a dualising pair :    given @xmath432 there is a nondegenerate pairing @xmath433 ) \\otimes_k { \\mathcal{t}}(x , y ) { \\longrightarrow}k\\ ] ] defined by @xmath434 which is natural in both variables and compatible with suspension .",
    "let @xmath72 denote the functor @xmath435 $ ] on @xmath1 . together with the isomorphism @xmath436",
    "\\cong [ 1 ] \\circ s$ ] given by @xmath437}$ ] this is a triangulated functor , and it follows from lemma [ lemma : ptrproperties ] and the previous corollary that @xmath1 is @xmath438-calabi - yau in the sense of ( * ? ? ?",
    "* proposition 2.2 ) .    to obtain a concrete nondegenerate pairing on the morphism spaces of @xmath1 it only remains to find an explicit @xmath0-linear functional @xmath64 on @xmath190 which is nonvanishing on the socle .",
    "such a functional is unique up to an automorphism , but fixing this automorphism is quite subtle : while any element of @xmath190 can be presented as a generalised fraction , this presentation is not unique , so it is a challenge to assign scalars to fractions in a way which is well - defined .",
    "this is the classical problem of defining residues of meromorphic differential forms on algebraic varieties , solved by serre ( * ? ? ?",
    "ii ) and tate @xcite for curves and generalised by grothendieck to arbitrary varieties @xcite .",
    "the theory of residue symbols is extensive , and we only sketch the parts we need ; for more details see @xcite , @xcite or @xcite .",
    "we begin with residues over power series rings , and then move on to singular rings .",
    "[ example : residuespowerseries ] if @xmath439 there is a canonical @xmath0-linear map @xmath440 with @xmath441 here @xmath442 is a suitably defined module of top - degree differential forms .",
    "this determines the value of @xmath443 on any generalised fraction with powers of the variables in the denominator .",
    "if @xmath444 is a regular sequence of length @xmath167 in @xmath72 then there exist integers @xmath445 such that @xmath446 , say @xmath447 then by the transformation rule of proposition [ prop : transition_det ] ( with @xmath448 ) @xmath449",
    "so ( [ eq : eval_rule_gen_frac ] ) uniquely determines the value of @xmath443 on every generalised fractions .",
    "this is called , for obvious reasons , the _ residue symbol_. in the case @xmath88 the residue symbol can also be constructed by integration , see ( * ? ? ?",
    "* chapter v ) . to see that the definition in terms of local cohomology agrees with the analytic definition , it suffices to observe that both constructions obey the transformation rule and both have the same values on the basic fractions in ( [ eq : eval_rule_gen_frac ] ) .",
    "here we trivialise @xmath450 via the generator @xmath451 and note that the map @xmath452 thus defined is nonvashing on the socle ( the fraction in ( [ eq : eval_rule_gen_frac ] ) with all @xmath230 generates the socle , which is one - dimensional ) .",
    "thus @xmath453 is a dualising pair for @xmath72 .    from now on",
    "suppose that that our local gorenstein @xmath0-algebra @xmath28 is a complete intersection , i.e. @xmath454 for a regular sequence @xmath455 in @xmath146 .",
    "hence @xmath456 .",
    "in order to canonically define residues over @xmath28 , one has to introduce modules of regular differential forms @xcite .",
    "but if one simply wants to construct a dualising pair for @xmath28 which is computable in terms of residues over @xmath72 , one can proceed more directly by relating generalised fractions over @xmath28 and @xmath72 .",
    "[ prop : tauinclusion ] there is a well - defined @xmath72-linear map @xmath457 which for a system of parameters @xmath57 in @xmath28 is given by @xmath458 moreover @xmath116 is injective and defines an isomorphism between @xmath190 and the submodule of elements of @xmath459 annihilated by the ideal @xmath460 .",
    "the proof is technical and we have relegated it to appendix [ section : resid_genfrac ] .",
    "see lemma [ lemma : genfracquotientsrelate ] .",
    "the residue map @xmath452 is a dualising pair for @xmath72 , and the composite @xmath461 is easily seen to be a dualising pair for @xmath28 . combining this dualising pair with theorem [ theorem : genfracformula ] we have a more explicit form of the duality for complete intersections :    [ corollary : ciresformula ] when @xmath28 is a complete intersection there is a nondegenerate pairing @xmath433 ) \\otimes_k { \\mathcal{t}}(x , y ) { \\longrightarrow}k\\ ] ] defined in the above notation by @xmath462 which is natural in both variables and compatible with suspension .",
    "throughout @xmath0 is a field of characteristic zero , @xmath439 , and @xmath463 is a polynomial chosen such that the zero locus @xmath464 in @xmath71 has an isolated singularity at the origin .",
    "then @xmath69 is a local gorenstein @xmath0-algebra with an isolated singularity , and the results of the previous section apply to the triangulated category @xmath465 .",
    "the arguments work more generally for any regular local @xmath0-algebra @xmath72 , but for simplicity we stick to power series .    throughout all matrix factorisations",
    "will defined over @xmath72 and factorise @xmath34 , and @xmath466 denotes @xmath467 .",
    "recall the construction , given in the introduction , of a @xmath208-graded complex @xmath82 of finite free @xmath28-modules from any matrix factorisation @xmath43 .",
    "@xmath82 is an acyclic complex of finite free @xmath28-modules and the functor @xmath468 is an equivalence .    let us recall the proof that @xmath469 is acyclic . if @xmath470 then @xmath471 and hence @xmath472 for some @xmath473 .",
    "but since @xmath474 is injective @xmath475 must be injective , whence @xmath476 is a coboundary , and @xmath469 is acyclic .",
    "there is a diagram of functors @xmath477_-{f}\\ar[rr]^-{{\\overline{(- ) } } } & & \\k_{\\ac}(\\free r)\\ar[dl]^-{g}\\\\ & \\underline{\\operatorname{cm}}(r ) } \\ ] ] which commutes up to natural isomorphism , where @xmath30 is the stable category of maximal cohen - macaulay @xmath28-modules , @xmath478 and @xmath479 .",
    "the functor @xmath480 is an equivalence by ( * ? ? ?",
    "* ( 4.4.1 ) ) and @xmath134 is an equivalence by @xcite , so periodification is also an equivalence .",
    "we know an explicit formula ( see corollary [ corollary : ciresformula ] ) for the nondegenerate pairing on the morphism spaces of @xmath481 , since @xmath28 is a complete intersection with @xmath482 . using the equivalence of @xmath1 with the homotopy category of matrix factorisations",
    "@xmath84 we obtain a nondegenerate pairing on the morphism spaces of @xmath483 .",
    "here is what we find :    [ theorem : klformula ] for matrix factorisations @xmath4 there is a nondegenerate pairing @xmath484 ) \\otimes_k \\m(x , y ) { \\longrightarrow}k\\ ] ] defined by @xmath485 which is natural in both variables and compatible with suspension .    regarding the notation : we choose homogeneous bases for @xmath4 so that the matrix - valued @xmath167-form @xmath486 makes sense , where @xmath487 is the symmetric group .",
    "the _ supertrace _ of a homogeneous endomorphism @xmath113 of a finite free @xmath73-graded @xmath72-module is by definition the trace of @xmath488 .",
    "we also note that @xmath489 $ ] is the identity functor on @xmath490 , so @xmath491 = x[n-2 ] = x[n]$ ] .",
    "the proof will be preceeded by a series of lemmas , establishing some basic commutative algebra which we will need .",
    "the main mismatch between our current setting and that of section [ section : duality ] which needs to be accounted for is the following : to apply our earlier results , we need a system of parameters @xmath492 in @xmath28 acting null - homotopically on the acyclic complex @xmath82 associated to a matrix factorisation @xmath43 , and associated null - homotopies @xmath58 .    this data _ almost _ comes for free : since the singularity of the hypersurface @xmath493 at the origin is isolated the partial derivatives @xmath494 form a regular sequence see ( * ? ? ?",
    "* lemma 23 ) .",
    "the generalisation to arbitrary @xmath0 is routine . ] , and these derivatives act null - homotopically on any matrix factorisation and therefore also on the periodification :    [ lemma : periodofdoys ] let @xmath43 be a matrix factorisation .",
    "the periodification of the map @xmath495 is a homotopy @xmath496 satisfying @xmath497 .",
    "since @xmath498 , this follows by the leibniz rule @xmath499 .",
    "if we could find a system of parameters for @xmath28 as a subset of @xmath500 , say @xmath501 , then we could take as our null - homotopies the @xmath502 and corollary [ corollary : ciresformula ] would provide a residue formula for the pairing in @xmath483 .",
    "this is not quite the kapustin - li pairing , but it is very close .",
    "but we are getting ahead of ourselves : it is _ not _ true in general that a subset of @xmath500 gives a system of parameters for @xmath28 .",
    "however this can always be arranged by a change of variables , or what amounts to the same thing , replacing @xmath500 by the sequence @xmath503 for some invertible @xmath504 matrix @xmath105 over @xmath0 .",
    "we can always choose @xmath105 such that @xmath505 is a system of parameters for @xmath28 .",
    "this is the content of the next pair of lemmas .",
    "[ lemma : technical_sop ] let @xmath506 be a cohen - macaulay local ring of dimension @xmath60 which is an algebra over an infinite field @xmath159 , and let @xmath507 be elements of @xmath103 generating an @xmath146-primary ideal .",
    "there are linear combinations @xmath508 with coefficients @xmath509 such that @xmath510 forms a system of parameters for @xmath103 .",
    "let @xmath511 be the associated primes of @xmath103 .",
    "we claim that there exists a linear combination @xmath512 @xmath513 which is a regular element of @xmath103 .",
    "suppose to the contrary that every such linear combination is a zero - divisor , and therefore belongs to the union @xmath514 .",
    "if we set @xmath515 for @xmath516 then our assumption implies that @xmath517 .",
    "but every @xmath518 is a proper subspace , because if @xmath519 then @xmath520 which would imply @xmath521 , contradicting our assumption that @xmath60 .",
    "we have reached the desired contradiction , because @xmath159 is infinite and thus @xmath522 is not a finite union of proper subspaces .",
    "applying the claim recursively we produce the desired system of parameters for @xmath103 .",
    "[ lemma : special_reg_seq_exists ] there is an invertible matrix @xmath105 over @xmath0 such that @xmath523 is a system of parameters for @xmath28 .    by hypothesis",
    "@xmath500 generates an ideal primary for the maximal ideal in @xmath72 , and therefore also in @xmath28 . using lemma [ lemma : technical_sop ]",
    ", we can find @xmath524 vectors @xmath525 such that @xmath57 is a system of parameters for @xmath28 .",
    "these vectors must be linearly independent ( otherwise we would have @xmath526 ) and we can define the desired matrix @xmath105 by appending to this list an arbitrary , linearly independent , vector @xmath527 from @xmath528 .    in what follows",
    "we assume that @xmath105 and thus @xmath529 and @xmath57 have been fixed , such that @xmath57 is a system of parameters for @xmath28 .",
    "it follows from lemma [ lemma : periodofdoys ] that the homotopies @xmath530 on @xmath82 satisfy @xmath531 for @xmath532 .    by corollary [ corollary : ciresformula ]",
    "there is a nondegenerate pairing ( [ eq : klformulaproof1 ] ) given by @xmath533 note that the sign @xmath534 above has a contribution from moving @xmath34 from the left end of the denominator to the right .",
    "because of the extra @xmath73-symmetry of @xmath82 , it is convenient to rewrite this in terms of supertraces of @xmath72-linear endomorphisms of @xmath43 , making use of lemma [ lemma : ptrandinteger ] @xmath535 here we abuse notation and write @xmath45 for the map @xmath536 on @xmath43 .",
    "next we observe that the sequence @xmath537 is regular , and by the transformation rule @xmath538 where @xmath539 .",
    "the @xmath540 cancels with the @xmath34 in the denominator , so that @xmath541 working modulo the sequence @xmath542 , so that @xmath107 anticommutes with every @xmath58 except for @xmath543 , we have @xmath544 if we insert this into the residue then the @xmath34 s cancel as before , and from ( [ eq : almostfinalklres ] ) we conclude @xmath545 in the first step we use the fact that the pairing @xmath546 is independent of the ordering of the regular system of parameters and homotopies , so that effectively the @xmath45 s anticommute within the supertrace ( see remark [ remark : gradedcomm ] and also ( * ? ? ?",
    "* appendix a ) for a direct proof ) and therefore all permutations contribute equally . in the last step we use the transformation rule .    consider for any matrix factorisation @xmath43 the trace map @xmath547 ) { \\longrightarrow}k\\ ] ] defined by @xmath548 , that is @xmath549 the nondegenerate pairing @xmath546 is determined by the trace map , since @xmath550 .",
    "if we want to emphasise the underlying matrix factorisation , we write @xmath551 for @xmath380 . for convenience , let us state the following immediate consequence of lemma [ lemma : ptrproperties ] :    for matrix factorisations @xmath4 we have :    * for morphisms @xmath396 $ ] and @xmath397 , @xmath552 .",
    "* for a morphism @xmath413 $ ] , @xmath553}$ ] .",
    "there is a more general statement which follows from the lemma : if @xmath554 is a morphism of degree @xmath555 and @xmath397 is a morphism of degree @xmath556 then @xmath557 } = ( -1)^{da } \\langle \\phi \\circ \\psi \\rangle_y = ( -1)^{|\\psi| |\\phi| } \\langle \\phi \\circ \\psi \\rangle_y\\,.\\ ] ]    [ remark : boundary_bulk_hypersurface ] a classical invariant associated to the singular hypersurface @xmath464 is the @xmath0-algebra @xmath558 , called the _",
    "jacobi algebra _ of @xmath34 .",
    "it is a classical result of local duality ( see for example @xcite when @xmath88 ) that @xmath559 together with the functional @xmath560\\end{gathered}\\ ] ] is a frobenius algebra , that is , the pairing @xmath561 is nondegenerate .",
    "the explicit formula suggests that the trace map of ( [ eq : tracemapklfinal1 ] ) factors into two pieces @xmath562 ) \\ar[r]^-{\\beta } & \\omega_w \\ar[r]^-{\\gamma } & k } \\ ] ] where @xmath563 this is known in the physics literature as the _ boundary - bulk _ map , as it sends boundary states ( endomorphisms of @xmath43 ) to closed states ( elements of @xmath559 ) . rather than",
    "argue directly that @xmath564 is well - defined , let us proceed as follows : local duality states that there is an isomorphism of @xmath559-modules @xmath565 \\right\\}. \\end{split}\\ ] ] the morphism spaces in @xmath483 are annihilated by @xmath566 and the @xmath72-linear map @xmath567 ) { \\longrightarrow}h^{n-1}_{{\\mathfrak{m}}}(r ) { \\longrightarrow}h^n_{{\\mathfrak{m}}}(s)\\ ] ] ( with @xmath116 as in proposition [ prop : tauinclusion ] ) must therefore factor through the submodule @xmath568 of @xmath459 . composing this factorisation with the isomorphism ( [ eq : bulk_boundary_locald_2 ] )",
    "we have a canonical morphism of @xmath559-modules @xmath569 ) { \\longrightarrow}\\omega_w$ ] and this is precisely the map @xmath564 described in ( [ eq : endofbeta ] )",
    ".    set @xmath570 $ ] and @xmath571 .",
    "this is an isolated singularity of type @xmath572 .",
    "given a power series @xmath573 we write @xmath574 for the coefficient of @xmath575 in @xmath576 , or in terms of residue symbols @xmath577\\,.\\ ] ] using the transformation rule as explained in example [ example : residuespowerseries ] we see that @xmath578 & = \\res\\big[\\begin{matrix } ( -\\frac{1}{2}y^3 + \\frac{1}{8}x^2 ) f \\cdot { \\mathrm{d}}v \\;/\\ ; x^3 , y^4 \\end{matrix}\\big ] = -\\tfrac{1}{2}c_{x^2}(f ) + \\tfrac{1}{8}c_{y^3}(f ) .",
    "\\end{split}\\ ] ] let @xmath341 be an endomorphism of the matrix factorisation @xmath43 with differential @xmath579 let us calculate @xmath580 using the formula ( [ eq : tracemapklfinal2 ] ) .",
    "one checks that @xmath581 hence @xmath582 for example , @xmath583 is an endomorphism of @xmath43 and we compute that @xmath584 and @xmath585 .",
    "the matrix factorisation @xmath43 is taken from ( * ? ? ?",
    "* ch.9 ) . for further examples of the kapustin - li formula in the physics literature ,",
    "see @xcite .",
    "let @xmath586 be a cohen - macaulay local ring of dimension @xmath587 , and let @xmath22 denote the local ring @xmath588 for some regular element @xmath463 .",
    "our aim in this appendix is to compare generalised fractions over @xmath72 and its quotient @xmath28 , using a theorem of sastry and yekutieli from @xcite .",
    "note that @xmath28 is cohen - macaulay , so both @xmath28 and @xmath72 are equidimensional and catenary , and the remarks of ( * ? ? ?",
    "* -  2.2 ) apply .",
    "we allow @xmath589 , so that @xmath28 may be artinian .",
    "first we recall some basic material from @xcite .",
    "a finitely generated @xmath72-module @xmath105 is called a _ canonical module _ of @xmath72 if @xmath590 . a canonical module of @xmath72 exists if and only if @xmath72 is a homomorphic image of a gorenstein local ring and , if a canonical module of @xmath72 exists , it is unique up to ( non - canonical ) isomorphism .",
    "if @xmath72 is gorenstein then @xmath72 itself is a canonical module , so any canonical module is free of rank one .",
    "suppose that @xmath72 has canonical module @xmath442 and let @xmath591 be a minimal injective resolution .",
    "the complex @xmath592 is then a _ residual complex _ for @xmath72 , that is , @xmath592 is a bounded below complex of injective @xmath72-modules with finitely generated cohomology , such that there is an isomorphism @xmath593 indeed , given @xmath594 with @xmath595 we define @xmath596 to be the submodule of elements in @xmath597 annihilated by some power of @xmath162",
    ". then @xmath598 and for @xmath599 the inclusions define a coproduct @xmath600 and we write @xmath601 for the corresponding projection morphisms .",
    "we introduce a family of morphisms @xmath602}$ ] , following sastry and yekutieli @xcite .",
    "saturated chain _",
    "@xmath603 in @xmath604 ( i.e. @xmath605 ) , @xmath606 is the morphism @xmath607 where @xmath608 . given @xmath609 and @xmath610 we define a morphism @xmath602 } : i_s^c { \\longrightarrow}i_s^{c+1}$ ] by @xmath611 } = \\sum_{\\substack{({\\mathfrak{p } } , { \\mathfrak{q } } ) \\text { saturated}\\\\ \\operatorname{ht}({\\mathfrak{p } } ) = c , \\ ;",
    "t \\in { \\mathfrak{q } } \\setminus { \\mathfrak{p } } } } \\partial_{({\\mathfrak{p } } , { \\mathfrak{q}})}\\ ] ]    if @xmath162 is a prime ideal of @xmath72 then @xmath598 so @xmath612 is nonzero if and only if @xmath162 contains @xmath34 , in which case @xmath613 as @xmath28-modules . in what follows @xmath614",
    "always denotes the height of the prime ideal @xmath162 in @xmath72 . from the canonical module and its resolution over @xmath72",
    ", we obtain the same data over @xmath28 :    the module @xmath615 is a canonical module for @xmath28 with minimal injective resolution @xmath616 $ ] ( see lemma [ lemma : explicit_resmap_kappa ] below ) . given @xmath594 containing @xmath34 ,",
    "we set @xmath617",
    ". then @xmath618 is concentrated in degrees @xmath619 $ ] and given in degree @xmath620 by @xmath621    [ lemma : explicit_resmap_kappa ] there is a quasi - isomorphism @xmath622 defined for @xmath623 by @xmath624}\\left(\\frac{1}{w } \\cdot \\eta(\\gamma ) \\right ) = \\sum_{\\substack{({\\mathfrak{p } } , { \\mathfrak{q } } ) \\text { saturated}\\\\ \\operatorname{ht}({\\mathfrak{p } } ) = 0 , \\ ; w \\in",
    "{ \\mathfrak{q } } \\setminus { \\mathfrak{p } } } } \\partial_{({\\mathfrak{p } } , { \\mathfrak{q}})}\\left ( \\frac{1}{w } \\cdot \\eta(\\gamma ) \\right),\\ ] ] and this is a minimal injective resolution of @xmath625 over @xmath28 .",
    "since @xmath34 is regular it does not belong to any prime ideal @xmath162 in @xmath72 of height zero , so @xmath626 makes sense as an element of @xmath627 .",
    "let @xmath628 be the associated primes of @xmath34 in @xmath72 , which agree with the minimal primes since @xmath72 is cohen - macaulay .",
    "as an @xmath72-module @xmath28 has free resolution @xmath629 @xmath630 and there is a pair of quasi - isomorphisms @xmath631 ^ -{\\hom(1,\\eta ) } & \\hom_s(p_r , i_s ) & \\hom_s(r , i_s ) .",
    "\\ar[l ] } \\ ] ] the only nonzero cohomology of @xmath632 is @xmath633 , so @xmath634 $ ] is an injective resolution of @xmath625 over @xmath28 , with resolution map @xmath635 obtained by applying @xmath636 to ( [ eq : explicit_resmap_kappa_1 ] ) : @xmath637 it remains to calculate @xmath635 .",
    "let @xmath623 be given and consider the coboundary in @xmath638 : @xmath639 for a prime ideal @xmath162 of height zero in @xmath72 , let @xmath640 denote the composite of @xmath641 with the projection @xmath642 . since @xmath643 is a morphism of complexes @xmath644 whenever @xmath645 .",
    "let @xmath646 be a prime ideal of height one not equal to some @xmath647 , and thus not containing @xmath34 .",
    "then @xmath34 acts as a unit on @xmath648 and @xmath649 it follows that @xmath650}(1/w \\cdot \\eta(\\gamma)).\\ ] ] observe that this element is killed by @xmath34 , and therefore belongs to @xmath651 . hence",
    "@xmath652}(1/w \\cdot \\eta(\\gamma ) ) \\end{pmatrix } - \\begin{pmatrix } \\eta(\\gamma ) \\\\ 0 \\end{pmatrix},\\ ] ] which shows that as we pass from left to right in ( [ eq : explicit_resmap_kappa_1 ] ) with the cohomology class of @xmath307 , we arrive at @xmath653}(1/w \\cdot \\eta(\\gamma))$ ] on the right hand side .",
    "we conclude that @xmath635 is an injective resolution of @xmath625 , and it only remains to check that @xmath618 is minimal .",
    "there exists a minimal subcomplex @xmath197 of @xmath618 , which must be a residual complex since it is a minimal resolution of @xmath625 .",
    "we already know that @xmath618 is a residual complex , so we conclude that @xmath654 and @xmath618 is minimal .",
    "since @xmath618 is a residual complex , as above we define morphisms @xmath655 for any saturated chain @xmath603 in @xmath656 with @xmath657 ( in @xmath72 ) and thus for any @xmath658 a morphism @xmath602,r } : i_r^c { \\longrightarrow}i_r^{c+1}$ ] .",
    "we also set @xmath659 and @xmath660 .",
    "let @xmath661 be a cohen - macaulay local ring of dimension @xmath662 with a canonical module @xmath663 and let @xmath664 be a minimal injective resolution , so @xmath665 is isomorphic to the injective envelope @xmath666 .",
    "let @xmath57 be a system of parameters for @xmath667 .",
    "we define @xmath668 obviously this depends on the system of parameters @xmath57 .",
    "let us also set @xmath669 the injective resolution @xmath670 determines an isomorphism @xmath671 , as follows . tensoring the augmentation @xmath672 with @xmath673",
    "gives an isomorphism @xmath674 since @xmath675 = 0 $ ] .",
    "let @xmath676 $ ] denote the morphism of complexes given by the identity in degree zero .",
    "there is a degree - wise split exact sequence @xmath677 { \\longrightarrow}\\coker(v ) { \\longrightarrow}0,\\ ] ] and since @xmath663 is a canonical module , @xmath678 involves only indecomposable injectives @xmath679 for non - maximal primes @xmath162 .",
    "it follows that @xmath680 is contractible , and we deduce a homotopy equivalence @xmath681^(0.38){(\\ref{eq : part_of_local00})}_(0.38){\\cong } & \\operatorname{k}_{\\infty}(\\bs{t } ) \\otimes h^d_{{\\mathfrak{m}}}(\\omega_b ) \\ar[r]^(0.5){1 \\otimes v } & \\operatorname{k}_{\\infty}(\\bs{t } ) \\otimes i_b[d ] \\ar[r]_{\\cong } & ( k_{\\infty}(\\bs{t } ) \\otimes i_b)[d]\\ , . } \\ ] ] hence the resolution morphism @xmath664 induces the desired isomorphism @xmath682^(0.58){h^d(1 \\otimes \\kappa)}_(0.58){\\cong } & h^d ( \\operatorname{k}_{\\infty}(\\bs{t } ) \\otimes i_b ) \\ar[r]^(0.6){(\\ref{eq : part_of_local})}_(0.6){\\cong } & h^d_{{\\mathfrak{m}}}(\\omega_b)\\ , . } \\ ] ] we define generalised fractions in @xmath673 by transferring the generalised fractions in @xmath683 defined in section [ section : cinjres ] along this isomorphism .",
    "let @xmath684 denote a system of parameters for @xmath28 so that @xmath685 is a system of parameters for @xmath72 .",
    "as explained above , we introduce generalised fractions in @xmath686 and @xmath687 , and a theorem of sastry - yekutieli relates these generalised fractions to the morphisms @xmath602}$ ] .",
    "[ theorem : sastry_yek ] ( ( * ? ? ?",
    "* ( 2.2.2 ) ) ) if @xmath688 is a system of parameters for @xmath72 and @xmath623 then @xmath689_s = ( -1)^{\\binom{n}{2 } } \\partial_{[s_n ] } \\circ \\cdots \\circ \\partial_{[s_1 ] } \\big ( \\eta(\\gamma ) / { s_1 \\cdots s_n } \\big).\\ ] ]        by definition for any @xmath692 and @xmath610 the diagram @xmath693_j \\ar[r]^{-\\partial_{[t],r } } & i_r^{c+1 } \\ar[d]^{j}\\\\ i_s^{c+1 } \\ar[r]_{\\partial_{[t ] } } & i_s^{c+2 } } \\ ] ] commutes , where @xmath694 denotes inclusions .",
    "in particular by theorem [ theorem : sastry_yek ] we have @xmath695_r & = ( -1)^{\\binom{n-1}{2 } } j \\circ \\partial_{[t_n],r } \\circ \\cdots",
    "\\circ \\partial_{[t_2],r } \\big ( \\kappa(\\overline{\\gamma})/{t_2 \\cdots t_n}\\big)\\\\ & = ( -1)^{\\binom{n-1}{2}+n+1 } \\partial_{[t_n ] } \\circ \\cdots \\circ \\partial_{[t_2 ] } \\circ j\\big ( \\kappa(\\overline{\\gamma})/{t_2 \\cdots t_n}\\big)\\end{aligned}\\ ] ] which by lemma [ lemma : explicit_resmap_kappa ] and theorem [ theorem : sastry_yek ] becomes @xmath696 } \\circ \\cdots \\circ \\partial_{[t_2 ] } \\circ \\partial_{[w]}\\big ( \\eta(\\gamma)/{w t_2 \\cdots t_n}\\big)\\\\ & = ( -1)^{\\binom{n-1}{2}+\\binom{n}{2}+n+1}\\big [ \\gamma \\,/\\ , w , t_2,\\ldots , t_n \\big]_s = \\big [ \\gamma \\,/\\ , w , t_2,\\ldots , t_n \\big]_s\\end{aligned}\\ ] ] as required .",
    "m.  auslander , _ functors and morphisms determined by objects _ , representation theory of algebras ( proc .",
    "temple univ . ,",
    "philadelphia , pa . , 1976 ) , dekker , new york , 1978 , pp .",
    "lecture notes in pure appl . math .",
    "37 .",
    "i.  burban and y.  drozd , _ maximal cohen - macaulay modules over surface singularities _ , trends in representation theory of algebras and related topics , ems ser .",
    "soc . , zrich , 2008 , pp ."
  ],
  "abstract_text": [
    "<S> we study serre duality in the singularity category of an isolated gorenstein singularity and find an explicit formula for the duality pairing in terms of generalised fractions and residues . for hypersurfaces </S>",
    "<S> we recover the residue formula of the string theorists kapustin and li . </S>",
    "<S> these results are obtained from an explicit construction of complete injective resolutions of maximal cohen - macaulay modules .    </S>"
  ]
}