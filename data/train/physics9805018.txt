{
  "article_text": [
    "visualization of multi - dimensional distributions is often performed by examining single variable distributions ( that is , one - dimensional projections ) and linear correlation coefficients amongst the variables .",
    "this can be adequate when the sample size is small , the distribution consists of essentially uncorrelated variables , or when the correlations between the variables is approximately linear .",
    "this paper describes a method to approximate multi - dimensional distributions in this manner and its applications in data analysis .",
    "the method described in this paper , the projection and correlation approximation ( pca ) , is particularly useful in analyses which make use of either simulated or control event samples . in particle physics , for example , such samples are used to develop algorithms that efficiently select events of one type while preferentially rejecting events of other types .",
    "the algorithm can be as simple as a set of criteria on quantities directly measured in the experiment or as complex as an application of an artificial neural network @xcite on a large number of observables .",
    "the more complex algorithm may result in higher efficiency and purity , but the determination of systematic errors can be difficult to estimate .",
    "the pca method can be used to define a sophisticated selection algorithm with good efficiency and purity , in a way that systematic uncertainties can be reliably estimated .",
    "another application of the pca method is in parameter estimation from a data set using a maximum likelihood technique .",
    "if the information available is in the form of simulated event samples , it can be difficult to apply an unbinned maximum likelihood method , because it requires a functional representation of the multidimensional probability density function ( pdf ) .",
    "the pca method can be used to approximate the pdfs required for the maximum likelihood method .",
    "a simple goodness of fit test is available to determine if the approximation is valid .    to verify the statistical uncertainty of an analysis",
    ", it can be useful to create a large ensemble of simulated samples , each sample equivalent in size to the data set being analyzed . in cases where this is not practical because of limited computing resources , the approximation developed in the pca method can be used , as it is in a form that leads to an efficient method for event generation .    in the following sections , the projection and correlation approximation will be described along with its applications . an example data analysis using the pca method",
    "consider an arbitrary probability density function @xmath0 of @xmath1 variables , @xmath2 .",
    "the basis for the approximation of this pdf using the pca approach is the @xmath1-dimensional gaussian distribution , centered at the origin , which is described by an @xmath3 covariance matrix , @xmath4 , by @xmath5 where @xmath6 is the determinant of @xmath4 .",
    "the variables @xmath7 are not , in general , gaussian distributed so this formula would be a poor approximation of the pdf , if used directly .",
    "instead , the pca method uses parameter transformations , @xmath8 , such that the individual distributions for @xmath9 are gaussian and , as a result , the @xmath1-dimensional distribution for @xmath10 may be well approximated by eq .",
    "( [ eq : ngaus ] ) .",
    "the monotonic function @xmath11 that transforms a variable @xmath12 , having a distribution function @xmath13 , to the variable @xmath14 , which follows a gaussian distribution of mean  0 and variance  1 , is @xmath15 where erf@xmath16 is the inverse error function and @xmath17 is the cumulative distribution of @xmath12 , @xmath18    the resulting @xmath1-dimensional distribution for * y * will not , in general , be an @xmath1-dimensional gaussian distribution .",
    "it is only guaranteed that the projections of this distribution onto each @xmath9 axis is gaussian . in the pca approximation , however , the probability density function of * y * is assumed to be gaussian .",
    "although not exact , this can represent a good approximation of a multi - dimensional distribution in which the correlation of the variables is relatively simple .    written in terms of the projections , @xmath19 , the approximation of @xmath20 using the pca method is , @xmath21 where @xmath4 is the covariance matrix for * y * and @xmath22 is the identity matrix . to approximate the projections , @xmath19 , needed in eqs.([eq : cumul ] ) and ( [ eq : pca ] ) , binned frequency distributions ( histograms ) of @xmath2 can be used .",
    "the projection and correlation approximation is exact for distributions with uncorrelated variables , in which case @xmath23 .",
    "it is also exact for a gaussian distribution modified by monotonic one - dimensional variable transformations for any number of variables ; or equivalently , multiplication by a non - negative separable function .",
    "a large variety of distributions can be well approximated by the pca method . however , there are distributions for which this will not be true . for the pca method to yield a good approximation in two - dimensions ,",
    "the correlation between the two variables must be the same sign for all regions .",
    "if the space can be split into regions , inside of which the correlation has everywhere the same sign , then the pca method can be used on each region separately . to determine if a distribution is well approximated by the pca method , a goodness of fit test can be applied , as described in the next section .",
    "the generation of simulated event samples that follow the pca pdf is straightforward and efficient .",
    "events are generated in @xmath14 space , according to eq .",
    "( [ eq : ngaus ] ) , and then are transformed to the @xmath12 space .",
    "the procedure involves no rejection of trial events , and is therefore fully efficient .",
    "some applications of the pca method do not require that the pdfs be particularly well approximated .",
    "for example , to estimate the purity and efficiency of event classification , it is only necessary that the simulated or control samples are good representations of the data .",
    "other applications , such as its use in maximum likelihood analyses , require the pdf to be a good approximation , in order that the estimators are unbiased and that the estimated statistical uncertainties are valid",
    ". therefore it may be important to check that the approximate pdf derived with the pca method is adequate for a given problem .    in general ,",
    "when approximating a multidimensional distribution from a sample of events , it can be difficult to derive a goodness of fit statistic , like a @xmath24 statistic .",
    "this is because the required multidimensional binning can reduce the average number of events per bin to a very small number , much less than 1 .    when the pca method is used , however , it is easy to form a statistic to test if a sample of events follows the pdf , without slicing the variable space into thousands of bins .",
    "the pca method already ensures that the projections of the approximate pdf will match that of the event sample . a statistic that is sensitive to the correlation amongst the variables",
    "is most easily defined in the space of transformed variables , @xmath14 , where the approximate pdf is an @xmath1-dimensional gaussian . for each event",
    "the value @xmath25 is calculated , @xmath26 and if the events follow the pdf , the @xmath25 values will follow a @xmath24 distribution with @xmath1 degrees of freedom , where @xmath1 is the dimension of the gaussian .",
    "a probability weight , @xmath27 , can therefore be formed , @xmath28 which will be uniformly distributed between 0 and 1 , if the events follow the pdf . the procedure can be thought of in terms of dividing the @xmath1-dimensional @xmath14 space into layers centered about the origin ( and whose boundaries are at constant probability in @xmath14  space ) and checking that the right number of events appears in each layer .",
    "the goodness of fit test for the pca distribution is therefore reduced to a test that the @xmath27 distribution is uniform .",
    "when the goodness of fit test shows that the event sample is not well described by the projection and correlation approximation , further steps may be necessary before the pca method can be applied to an analysis . to identify correlations which are poorly described , the goodness of fit test can be repeated for each pair of variables .",
    "if the test fails for a pair of variables , it may be possible to improve the approximation by modifying the choice of variables used in the analysis , or by treating different regions of variable space by separate approximations .",
    "given two categories of events that follow the pdfs @xmath29 and @xmath30 , the optimal event classification scheme to define a sample enriched in type 1 events , selects events having the largest values for the ratio of probabilities , @xmath31 . using simulated or control samples ,",
    "the pca method can be used to define the approximate pdfs @xmath32 and @xmath33 , and in order to define a quantity limited to the range @xmath34 $ ] , it is useful to define a likelihood ratio @xmath35 with only two categories of events , it is irrelevant if the pdfs @xmath36 and @xmath37 are renormalized to their relative abundances in the data set .",
    "the generalization to more than two categories of events requires that the pdfs @xmath38 be renormalized to their abundances . in either case ,",
    "each event is classified on the basis of the whether or not the value of @xmath39 for that event is larger than some critical value .",
    "systematic errors in the estimated purity and efficiency of event classification can result if the simulated ( or control ) samples do not follow the true pdfs . to estimate",
    "the systematic uncertainties of the selection , the projections and covariance matrices used to define the pca pdfs can be varied over suitable ranges .",
    "in this section the pca method and its applications are demonstrated with simple analyses of simulated event samples .",
    "two samples , one labeled signal and the other background , are generated with , @xmath40 and @xmath41 , according to the distributions , @xmath42 where the vectors of constants are given by * a*@xmath43 and * b*@xmath44 .",
    "these samples of 4000 events each correspond to simulated or control samples used in the analysis of a data set . in what follows",
    "it is assumed that the analytic forms of the parent distributions , eq .",
    "( [ eq : mcdist ] ) , are unknown .    the signal and background control samples are shown in fig .",
    "[ fig : sigcontrol ] and fig .",
    "[ fig : backcontrol ] respectively . a third sample , considered to be data and shown in fig .",
    "[ fig : data ] , is formed by mixing a further 240 events generated according to @xmath45 and 160 events generated according to @xmath46 .",
    "the transformation given in eq .",
    "( [ eq : transform ] ) is applied to the signal control sample , which results in the distribution shown in fig .",
    "[ fig : sigtrans ] . to define the transformation , the projections shown in fig .",
    "[ fig : sigcontrol ] are used , 40 bins for each dimension .",
    "the projections of the transformed distribution are gaussian , and the correlation coefficient is found to be 0.40 .",
    "the goodness of fit test , described in section [ sect : goodness ] , checks the assumption that the transformed distribution is a 2-dimensional gaussian .",
    "the resulting @xmath47 distribution from this test is relatively uniform , as shown in fig .",
    "[ fig : wdist ] .",
    "a separate transformation of the background control sample gives the distribution shown in fig .",
    "[ fig : backtrans ] , which has a correlation coefficient of 0.03 . note that a small linear correlation coefficient does not necessarily imply that the variables are uncorrelated . in this case",
    "the 2-dimensional distribution is well described by 2-dimensional gaussian , as shown in fig .",
    "[ fig : wdist ] .    since the pca method gives a relatively good approximation of the signal and background probability distributions ,",
    "an efficient event classification scheme can be developed , as described in section [ sect : class ] .",
    "care needs to be taken , however , so that the estimation of the overall efficiency and purity of the selection is not biased . in this example , the approximate signal pdf is defined by 81 parameters ( two projections of 40 bins , and one correlation coefficient ) derived from the 4000 events in the signal control sample .",
    "these parameters will be sensitive to the statistical fluctuations in the control sample , and thus if the same control sample is used to optimize the selection and estimate the efficiency and purity , the estimates may be biased . to reduce this bias ,",
    "additional samples are generated with the method described at the end of section [ sect : pca ] .",
    "these samples are used to define the 81 parameters , and the event classification scheme is applied to the original control samples to estimate the purity and efficiency . in this example",
    "data analysis , the bias is small . when the original control sample is used to define the 81 parameters , the optimal signal to noise is achieved with an efficiency of @xmath48 and purity of @xmath49 . when the pca generated samples are used instead , the selection efficiency is reduced to @xmath50 , for the same purity .",
    "when the classification scheme is applied to the data sample , 261 events are classified as signal events . given the efficiency and purity quoted above , the number of signal events in the sample is estimated to be @xmath51 .",
    "the number of signal events in the data sample can be more accurately determined by using a maximum likelihood analysis .",
    "the likelihood function is defined by @xmath52 where the product runs over the 400 data events , @xmath53 is the fraction of events attributed to signal , and @xmath54 and @xmath55 are the pca approximated pdfs , defined by eq .",
    "( [ eq : pca ] ) .",
    "the signal fraction , estimated by maximizing the likelihood , is @xmath56 , a relative uncertainty of 6.4% compared to the 8.5% uncertainty from the counting method . to check that the data sample is well described by the model used to define the likelihood function , eq .",
    "( [ eq : likelihood ] ) , the ratio of probabilities , eq .",
    "( [ eq : probrat ] ) , is shown in fig .  [",
    "fig : datatest ] , and compared to a mixture of pca generated signal and background samples .",
    "the source code for a fortran-77 implementation of the methods described in this paper is available from the author .",
    "the program was originally developed for use in an analysis of data from opal , a particle physics experiment located at cern , and makes use of the cernlib library @xcite .",
    "an alternate version is also available , in which the calls to cernlib routines are replaced by calls to equivalent routines from netlib @xcite .",
    "references to artificial neural networks are numerous .",
    "one source with a focus on applications in high energy physics is : + http://www.cern.ch/neuralnets/nnwinhep.html .",
    "information on cernlib is available from : + http://wwwinfo.cern.ch/asd/index.html .",
    "netlib is a collection of mathematical software , papers , and databases found at + http://www.netlib.org ."
  ],
  "abstract_text": [
    "<S> a method to approximate continuous multi - dimensional probability density functions ( pdfs ) using their projections and correlations is described . </S>",
    "<S> the method is particularly useful for event classification when estimates of systematic uncertainties are required and for the application of an unbinned maximum likelihood analysis when an analytic model is not available </S>",
    "<S> . a simple goodness of fit test of the approximation can be used , and simulated event samples that follow the approximate pdfs can be efficiently generated . </S>",
    "<S> the source code for a fortran-77 implementation of this method is available . </S>"
  ]
}