{
  "article_text": [
    "the possible existence of primordial black holes ( pbhs ) was first proposed in 1966 by zeldovich & novikov @xcite and , at the beginning of 1970s , by hawking @xcite .",
    "it was then widely discussed in the following years , see for example the recent review by carr for a full list of references @xcite . in 1974 hawking made his famous discovery of black hole evaporation @xcite , that is cosmologically relevant if the mass of the black holes concerned is less than @xmath0 grams .",
    "for this reason the problem of pbh formation started to be attractive and it was widely investigated in the following 30 years .",
    "the pbh formation process was first investigated by carr ( 1975 ) @xcite using a simplified model for an overdense collapsing region , described as a closed friedmann - robertson - walker ( frw ) universe , surrounded by a spatially flat frw expanding background . in the radiation dominated epoch of the universe this leads to a threshold value for the perturbation amplitude @xmath1 , where the amplitude @xmath2 is defined as the mass excess in the overdense region , and the black holes formed have masses of the order of the horizon mass at the time of formation . in this way carr obtained a first rough estimate of @xmath3 ( evaluated at the time of horizon crossing , when the overdensity region enters into the cosmological horizon ) by comparing the jeans length with the cosmological horizon scale at the time of black hole formation .",
    "subsequently a self consistent hydrodynamical analysis of pbh formation was carried out by nadezhin , novikov and polnarev in 1978 @xcite and in 1980 @xcite using , for the first time in this context , a hydrodynamical computer code written in the misner - sharp slicing , characterised by a diagonal metric with a cosmic time coordinate that reduces to the frw metric in the absence of perturbations .",
    "previously the same slicing was used by podurets @xcite and may & white @xcite to study stellar core collapse .",
    "an alternative analysis was developed in 1979 by bicknell & henriksen @xcite using a different method based on integration along hydrodynamical characteristics .",
    "these papers showed that the threshold amplitude of the perturbation is dependent on the particular shape of the initial conditions .",
    "it was also found in @xcite that pressure gradients considerably reduce the pbh mass formed at the end of the hydrodynamical process .    in the following twenty years attention",
    "was concentrated on different aspects of pbh formation .",
    "for example , calculating the amount of hawking radiation emitted by sufficiently small pbhs , with a mass less than @xmath0 g , one can obtain important constraints on parameters that characterise the different epochs and processes of the universe ( see , for example , @xcite and references there ) .",
    "the formation of pbhs was considered also within different scenarios , for example during phase transitions @xcite , with a soft equation of state @xcite , by collapse of cosmic loops @xcite , @xcite or from bubble collisions @xcite . in general",
    ", the study of pbhs provides a unique probe for different areas of physics : the early universe , quantum gravity , gravitational collapse and high energy physics .",
    "this is explained with full lists of references in the various reviews of pbhs , see for example @xcite .",
    "more recently , in 1999 , niemeyer and jedamzik @xcite made new numerical calculations pointing out the relevance of scaling laws for pbh formation .",
    "they showed that the black hole mass @xmath4 follows a power law @xmath5 if @xmath2 is close enough to @xmath1 , the same behaviour as seen in critical collapse by choptuik @xcite and other authors ( see review @xcite ) .",
    "niemeyer and jedamzik found that @xmath6 for the three types of perturbation profile that they studied . in the same year",
    ", shibata and sasaki @xcite presented an alternative formalism for studying pbh formation focusing on metric perturbations , rather than density perturbations , as had also been done previously @xcite .",
    "they pointed out that the initial conditions used in @xcite were specified initially within a nonlinear regime of perturbations of the energy density and velocity field , and were therefore `` inevitably contaminated by an unrealistic decaying mode '' component that would diverge for @xmath7 . in a recent paper @xcite",
    "this analysis has been converted in terms of the perturbation amplitude @xmath2 , showing that the shibata and sasaki results , corresponding to a wide choice of perturbation shapes , are consistent with @xmath1 in the range @xmath8 .",
    "the disagreement between this and the value @xmath9 has been explained by musco _",
    "et al _ @xcite , where simulations similar to those used in @xcite were carried out but specifying the initial conditions within the linear regime , giving only growing mode solutions at the horizon crossing time .",
    "the simulations in @xcite give values of @xmath1 in the range @xmath10 ( instead of @xmath11 ) for the same types of perturbation profiles used in @xcite .",
    "the present work is a new analysis of pbh formation using the numerical technique developed in @xcite , implemented together with a quasi homogeneous solution ( @xcite , @xcite ) that , assuming spherical symmetry , can be characterised by a single function of the radial coordinate . in this paper",
    "this function , called @xmath12 , is chosen as a curvature profile that allows a self consistent determination to be made of the whole set of initial conditions .",
    "this is a further development of the original approach of nadezhin , novikov and polnarev @xcite .",
    "according to the asymptotic quasi homogeneous solution @xcite(as @xmath13 ) , an arbitrary curvature profile @xmath12 corresponding to a large amplitude perturbation of the metric does not depend on time , while perturbations of energy density and velocity vanish asymptotically as @xmath13 .",
    "therefore these can be treated as small perturbations . solving the equations for the small velocity and density perturbations",
    "analytically we impose in a self consistent way all of the initial conditions corresponding to a moment in time when the quasi homogeneous solution of a certain order is valid .",
    "the curvature profile @xmath12 appears as the source in the right hand side of the relevant equations and we can say that the density and velocity perturbations which we use as initial conditions are generated by the curvature @xmath12 .",
    "then we use the computer code to follow the subsequent non linear evolution of the initial configuration ( by the configuration we mean the region of strong metric perturbation ) . to avoid confusion",
    "we should emphasise that the small perturbations predicted by any cosmological model are relevant in this context only when one calculates the probability of finding a configuration with a high amplitude perturbation of the metric .",
    "in fact , the small perturbations of density and velocity which we discuss here are determined not by arbitrary cosmological initial conditions , but entirely from the curvature profile within the initial configuration .",
    "the paper is organised as follows .    in section 2",
    "we give a very brief description of the misner - sharp equations .",
    "we then use these equations to specify all of the initial conditions , which we then use in our numerical computations , in terms of a curvature profile .",
    "when the length scale of the configuration is much larger than the cosmological horizon , the misner - sharp equations can be reduced to a system of linear differential equations which we solve analytically .    in section 3",
    "we obtain solutions for a rather general multi - fluid case , where the equation of state corresponds to an arbitrary mixture of perfect fluids .",
    "we demonstrate that , in the simple case of single perfect fluid , corresponding perturbations of energy density and velocity , obtained within the framework of the quasi homogeneous solution , evolve with time like a pure growing mode in standard cosmological perturbation theory , while their space dependence is entirely determined by the curvature profile @xmath12 .    in section 4",
    "we discuss the physical properties of the curvature profile @xmath12 , which is directly connected to the time - independent comoving curvature perturbation @xmath14 frequently used in literature .    in section 5",
    "we introduce two different parametrisation of @xmath12 .",
    "in section 6 , we present numerical tests to demonstrate self - consistency of the initial conditions .",
    "we then show that the initial conditions described by the quasi homogeneous solution have been imposed consistently in the code and give numerical examples of primordial black hole formation in the case of a radiation dominated universe .",
    "we show how the threshold for black hole formation is linked with the curvature profile and discuss the results obtained with the two different parametrisation used in the computations .",
    "summary and conclusions are given in section 7 .",
    "assuming spherical symmetry , it is convenient to divide the collapsing matter into a system of concentric spherical shells and to label each shell with a lagrangian co - moving radial coordinate which we denote as @xmath15",
    ". then the metric can be written in the form used by misner & sharp @xcite ds^2=-a^2dt^2+b^2dr^2+r^2d^2+^2d^2 , [ sph_metric ] where @xmath16 is a circumference coordinate , @xmath17 and @xmath18 are functions of @xmath15 and of the time coordinate @xmath19 , which reduces to the familiar frw time coordinate ( referred to in literature as `` cosmic time '' ) in the absence of perturbations .",
    "the frw metric used to describe homogeneous and isotropic cosmological models is a particular case of ( [ sph_metric ] ) : ds^2 - dt^2 + s^2(t ) + r^2d^2+^2d^2[frw ] where @xmath20 is the scale factor and @xmath21 is the curvature parameter that is equal to @xmath22 , @xmath23 and @xmath24 for flat , closed and open universes .    for a classical fluid , composed of particles with nonzero rest - mass , it is convenient to use the rest - mass @xmath25 contained interior to the surface of a shell ( or , equivalently , the baryon number ) as its co - moving coordinate @xmath15 . for fluids not possessing these conserved quantities ,",
    "one can still define a `` relative compression factor '' @xmath26 @xcite ( equivalent to the rest - mass density on a non relativistic fluid ) and one then has d=4r^2bdr .",
    "[ d_mu ] identifying @xmath25 and @xmath15 one has b=. following the notation of @xcite , we write the equations in terms of the operators d_t , [ d_t ] d_r , [ d_r ] and define u d_t r , [ u ] d_r r , [ gamma1 ] where @xmath27 is the radial component of the four - velocity in the associated eulerian frame , @xmath16 is the circumference coordinate , and @xmath28 is a generalization of the lorentz factor .",
    "we assume that the matter consists of different components and that each component can be described as a perfect fluid with the equation of state p = e , [ eq.state ] where @xmath29 is the pressure and @xmath30 is the energy density . for any equation of state of the form @xmath31 , the system of einstein equations can be written as : d_tu =- d_rp++4rp , [ euler1 ] d_t =- d_r(r^2u ) , [ d_trho ] d_t e = d_t,[d_te ] d_t m=4pur^2 , [ d_tm ] d_r a =- d_r p,[d_ra ] d_r m=4er^2 , [ d_rm ] where @xmath32 is a measure of the mass - energy contained inside radius @xmath25 and @xmath28",
    "can be calculated either from ( [ gamma1 ] ) or from the constraint equation ^2=1+u^2- [ gamma ] .    when the cosmic time approach is used for calculations of gravitational collapse leading to black hole formation",
    "it has the well - known drawback that singularities appear after a finite time in the calculations , before an event horizon has formed .",
    "once a singularity has formed , the calculations can not be continued further and so parts of the evolution which could potentially be seen by an outside observer can not be followed in this way . in particular , it is not possible to follow all of the process of the formation of the event horizon .",
    "this drawback is the reason for an observer - time formulation being used in the present work rather than continuing to use the cosmic time formulation .",
    "hernandez & misner @xcite introduced the concept of `` observer time '' , using as the time coordinate the time at which an outgoing radial light ray emanating from an event reaches a distant observer . in the original formulation ,",
    "this observer was placed at future null infinity but for calculations in an expanding cosmological background we use an frw fundamental observer sufficiently far from the perturbed region so as to be unaffected by the perturbation .",
    "a complete description of the hernandez - misner equations was given in @xcite .",
    "to describe pbh formation , we follow the quasi homogeneous approach ( @xcite , @xcite ) and solve the misner - sharp system of equations , giving a non perturbative description of large amplitude metric perturbations away from the homogeneous frw model . using this approach , as mentioned in the introduction",
    ", we can avoid the unphysical arbitrariness in the choice of initial conditions considered in previous works @xcite .",
    "the characteristic feature of the asymptotic quasi homogeneous solution is that all mass elements expand asymptotically , when @xmath33 , according to the frw model , with energy - density @xmath34 for an equation of state given by ( [ eq.state ] ) , while a spatial hypersurface with @xmath35 can have arbitrary curvature if the perturbation has a length - scale sufficiently larger than the cosmological horizon . as a consequence of this the hydrodynamical quantities",
    "can be considered as small perturbations with respect to the background solution , while the curvature perturbation is arbitrary large .",
    "this curvature perturbation is time independent , because pressure gradients in this regime are negligible ( @xcite , @xcite , see also , for example , @xcite ) .    in this work ,",
    "we consider spherical symmetry and specify conditions on an initial space - like hypersurface using a time independent function @xmath36 that represents the curvature profile . as we will see in the next section",
    ", this @xmath12 is directly related to the comoving curvature perturbation @xmath14 .",
    "we can also see that introducing a profile @xmath12 into the friedmann robertson walker metric ( [ frw ] ) one obtains an asymptotic solution of the einstein equation in the limit @xmath37 .",
    "we therefore use @xmath12 to represent initial curvature perturbations with scales much larger than the horizon , and solve the system of perturbed differential equations to express the set of hydrodynamical variables in terms of @xmath12 .",
    "the system of equations ( [ u ] ) - ( [ gamma ] ) can be re - written as : & r = au [ r_dot ] + & = a [ b_dot ] + & = - [ a_prime ] + & m = -4er^2r [ m_dot ] + & m^= 4er^2r^[m_prime ] + & = 1 + u^2 - [ r_prime ] where the dot and dash denote differentiation with respect to @xmath19 and @xmath15 respectively , we use the equation of state ( [ eq.state ] ) to express the pressure as a function of the energy density , equation ( [ gamma1 ] ) gives an expression for @xmath28 , and @xmath26 can be calculated from equation ( [ d_trho ] ) .",
    "the background solution is a spatially flat frw universe described by @xmath38 .",
    "the corresponding value of the energy density ( indicated with the suffix `` b '' ) is calculated from the friedmann equation ^2 = h_^2 = e_. [ fried_eq ] the quantity @xmath39 is related to the scale factor @xmath20 by equation ( [ m_dot ] ) used for the unperturbed case = -3(1 + ) [ homo_e ] , while the background values of the other quantities are obtained from the frw metric ( [ frw ] ) and the set of equations ( [ r_dot ] ) - ( [ r_prime ] ) : & a _ 1 + & b _",
    "s(t ) + & r _ s(t)r [ r_b ] + & m _ e_r_^3 + & u _",
    "h_r _ = ( t)r    as already mentioned , when the perturbation is well outside the cosmological horizon , all of the hydrodynamical quantities have nearly homogeneous profiles with their perturbations being small deviations away from the uniform solution .",
    "it is useful therefore to parametrise the scale of the perturbations using a dimensionless parameter @xmath40 that gives explicitly the ratio of the cosmological horizon scale @xmath41 to the physical length scale of the perturbation @xmath42 .",
    "^2 ^2 = < <",
    "1 [ eps_def ] from this equation it is clear that @xmath40 is a function of time only , and its time derivative , as follows from ( [ homo_e ] ) , is given by = -2 - = -2 + 3(1 + ) = ( 1 + 3 ) , [ dot_eps ] it is important to point out that expression ( [ dot_eps ] ) is a consequence of the energy conservation law and holds also when @xmath43 is a function of time .    we treat @xmath40 as a small parameter for our asymptotic solution and we will see that it cancels out in the final equations of this section .",
    "however , in numerical computations we use an explicit value of @xmath40 , which for self consistency should be sufficiently small . in this case",
    "we can keep only first order terms with respect to @xmath40 in the hydrodynamical equations ( [ r_dot ] ) - ( [ r_prime ] ) .",
    "then the initial perturbations are defined as : & r = r_b(1+r ) [ r_def ] + & u = h_br(1+u ) [ u_def ] + & b = ( 1+b ) [ b_def ] + & a = 1+a [ a_def ] + & e",
    "= e_b(1+e ) + & m = e_br^3(1+m ) the tilde quantities are in general functions of both @xmath15 and @xmath19 .",
    "it is convenient to define a new independent time variable @xmath44 given by .",
    "[ xi ]    starting from equation ( [ r_dot ] ) , and using expressions ( [ r_def ] ) , ( [ u_def ] ) and ( [ a_def ] ) we get @xmath45 , then linearising this equation and using ( [ dot_eps ] ) and ( [ xi ] ) we have [ tilda_r ] .",
    "similarly , perturbing equation ( [ b_dot ] ) we get @xmath46 and then , using ( [ dot_eps ] ) , we have .",
    "[ tilda_b ]    perturbing equation ( [ a_prime ] ) and integrating it over @xmath15 we have . [ tilda_a ]    perturbing equation ( [ m_dot ] ) to the first order in @xmath40 we get ( 1+m ) + 3 + ( m)^= - ( 1+e ) , and , using ( [ homo_e ] ) , ( 42 ) can be re - written as & - 3(1 + ) + 3(1 + ) - 3(1+)m + ( m)^ + + & + 3 m + 3e = 0 .",
    "using equation ( [ r_b ] ) we get @xmath47 and finally using equations ( [ dot_eps ] ) , ( [ xi ] ) , ( [ tilda_r ] ) and ( [ tilda_a ] ) we have .",
    "[ tilda_m ]    perturbing equation ( [ m_prime ] ) we obtain @xmath48 that can be re - written as . [ tilda_e ]    perturbing equation ( [ r_prime ] ) , we have @xmath49 that using ( [ fried_eq ] ) becomes @xmath50 and now using expression ( [ eps_def ] ) for @xmath40 we have - k(r)r^2 + 2b(1-k(r)r^2)= ( 2u - m ) . [ k_gamma ] since @xmath51 , one can drop the last term on left - hand side , obtaining finally .",
    "[ tilda_u ] this is the only equation of the system where @xmath12 appears explicitly . from the definition of @xmath28 given by ( [ gamma ] )",
    "one can rewrite ( [ tilda_u ] ) as k(r ) .",
    "[ k_gamma2 ] this relation shows also the connection between the profile @xmath12 and @xmath28 , which is an invariantly defined quantity representing an energy per unit mass .    substituting ( [ tilda_u ] ) into equation ( [ tilda_m ] ) we get + m = ( 1+)k(r)r_0 ^ 2 , and from this expression we can see that it is possible to separate the variables @xmath52 because , as we have assumed at the beginning",
    ", @xmath43 is just a function of time .",
    "we therefore write , [ m_tilda ] that gives the following differential equation for the function @xmath53 . [ phi_equation ]",
    "expression ( [ m_tilda ] ) is the solution for the mass perturbation @xmath54 and inserting this into ( [ tilda_e ] ) , ( [ tilda_a ] ) and ( [ tilda_u ] ) we obtain the following expressions for first order perturbations of energy density , @xmath55 , lapse , @xmath56 and radial velocity , @xmath57 : & e = ( ) r^3k(r)^r_0 ^ 2 [ e_tilda ] + & a = - ( ) r^3k(r)^r_0 ^ 2 [ a_tilda ] + & u = ( ) -1k(r)r_0 ^ 2 [ u_tilda ] substituting these equations into ( [ tilda_r ] ) and ( [ tilda_b ] ) we find two differential equations for @xmath58 and @xmath59 , given by & ( 1 + 3)r + = - ( ) r^3k(r)^r_0 ^ 2 + & + ( ) -1k(r)r_0 ^ 2 , [ r_tilda_eq ] + & ( 1 + 3)b",
    "+ = r r^3k(r)^^ ( ) , [ b_tilda_eq ] that can be solved introducing two new functions of time @xmath60 and @xmath61 and writing & r = - i_1 ( ) r^3k(r)^r_0 ^ 2 + i_2 ( ) r_0 ^ 2 , [ r_tilda ] + & b = i_1()rr^3k(r)^^r_0 ^ 2 .",
    "[ b_tilda ] the relations between @xmath62 and @xmath53 are obtained by introducing ( [ r_tilda ] ) and ( [ b_tilda ] ) into ( [ r_tilda_eq ] ) and ( [ b_tilda_eq ] ) : & + ( 1 + 3)i_1 ( ) = ( ) [ i1 ] + & + ( 1 + 3)i_2 ( ) = [ ( ) -1 ] [ i2 ] this completes the system of equations .",
    "it worth mentioning that in these equations , time evolution is given by @xmath40 and @xmath63 , while all spatial dependencies are given by @xmath12 .",
    "in general the universe consists of different fluid components characterised by different constant values @xmath64 .",
    "we can introduce an effective @xmath43 defined as ( s ) = = , [ gamma_def ] which , in general , is a function of time . at some moment of time @xmath65 ( which is not necessarily the same moment when we impose the initial conditions ) we specify the fractional contributions @xmath66 of the different fluid components with the corresponding coefficients @xmath64 , having for each component & ^-3(1+_i ) [ e_i1 ] + & e_i = f_ie [ e_i2 ] + & _ i f_i= 1 using expressions ( [ e_i1 ] ) and ( [ e_i2 ] ) one can write e_i f_i0e_0 ^-3(1 + ) then from ( [ gamma_def ] ) and the equation of state ( [ eq.state ] ) we have = .",
    "we now define a new quantity @xmath67 q(s ) _",
    "i f_i0 s^-3(1+_i ) e(s ) . taking the time derivative of this quantity",
    ", one gets = s = - 3_i ( 1+_i)f_i0  s^-3(1+_i ) = - 3(1 + ) q [ dq / dxi ] and finally @xmath67 can be related to @xmath68 by the following differential equation : = .",
    "[ gamma ] using expressions ( [ dq / dxi ] ) and ( [ gamma ] ) into ( [ phi_equation ] ) one obtains + 1-= - .",
    "the solution of this equation can be written in the form @xmath69 where @xmath70 and @xmath25 satisfy the following differential equations @xmath71 @xmath72 which give @xmath73 @xmath74 and finally .",
    "now we can solve the two differential equations for @xmath75 and @xmath76 that are both of the same form , s + ( 1 + 3)i_i(s ) = f_i(s),i=1,2 [ i_eq ] where @xmath77 and @xmath78 . from the expression ( [ dot_eps ] ) we see that 1 + 3= = h_b^2s^2s and this allows the differential equations ( [ i_eq ] ) to be written in a form that can easily be integrated , si(s)= f(s ) therefore i(s ) = h_b^2(s)s^2 _ 0^s f(s ) , which gives the following expressions for the two functions @xmath75 and @xmath76 : , .",
    "the initial conditions for all physical quantities are now determined in a self consistent way : the functions @xmath79 and @xmath80 specify the multifluid medium consisting of different species of particles and fields ( for example massive particles , photons , scalar fields , cosmic strings , etc . ) which are present in the universe , and hence in the configuration , at any time preceding the time chosen for imposing the initial conditions . in the particular case of a single fluid component , with @xmath81 ,",
    "the functions @xmath63 , @xmath75 , and @xmath76 are also constants .",
    "we have in this case h(s)s^- , and & = + & i_1 = = + & i_2 = ( - 1 ) = - therefore in this simple case the tilde - quantities are time independent and the time evolution is determined only by the parameter @xmath40 . from ( [ dot_eps ] ) we can calculate the time evolution of @xmath40 ( t ) ^ , [ lin_regime ] which is the same as the standard solution for a growing mode in cosmological perturbation theory ( see for example @xcite ) .",
    "the curvature profile @xmath12 used in the present paper is linked to the comoving curvature perturbation @xmath82 frequently used in literature ( see for example , @xcite ) .",
    "the simplest definition of @xmath82 comes from the theory of linear perturbations in the frw metric , where the spatial part of the metric tensor is given by g_ij s^21 + 2_ij .",
    "[ g_ij_linear ] the calculation of the spatial scalar curvature @xmath83 gives r^(3 ) 4 , [ r3_1 ] where @xmath84 is the comoving wavenumber associated with the perturbation .",
    "it is possible to generalise the definition of @xmath14 for non linear perturbations of the metric @xcite , with @xmath14 being still time independent ( as first shown in 1963 by lifshitz & khalatnikov @xcite ) and converging to ( [ g_ij_linear ] ) for small perturbations .",
    "starting from the expression for the scalar curvature given by ( [ r3_1 ] ) for generic metric perturbations one can see that the comoving curvature perturbation @xmath82 is connected with the pure growing mode in the case of small density perturbations ^2 , [ comoving_curv ] where @xmath43 is constant .",
    "this relation is obtained using a quantity called the `` peculiar gravitational potential '' @xmath85 defined as - ^2 _ , [ phi_g1 ] and linked to @xmath82 by a first order differential equation _ + _ -(1 + ) . [ phi_g ]",
    "this equation has a pure growing solution given by _ - , where @xmath82 and @xmath85 are time independent when the length - scale of a perturbation is much larger than the horizon scale .",
    "if we calculate the spatial curvature scalar ( see appendix ) in terms of the curvature profile @xmath12 , we find that r 6 1 + + 1 - + , [ r4 ] where k(r ) + k^(r ) . for the diagonal metric ( [ sph_metric ] )",
    "the three curvature is given by r^(3 ) k(r)+k^(r ) , [ r3_2 ] because only the last term in the square brackets of equation ( [ r4 ] ) corresponds to the diagonal spatial component of the ricci tensor .",
    "we now identify k 1/r_0 , [ k_r0 ] which is obvious to do because the wave number represents the inverse length of the perturbation .",
    "comparing equations ( [ r3_1 ] ) and ( [ r3_2 ] ) , one can then see that the two equations are the same if r_0 ^ 2 k(r)+k^(r ) .",
    "[ cuvr_curvk ] from ( [ k_r0 ] ) and ( [ eps_def ] ) it follows also that ^2 [ eps_k ] and relation ( [ cuvr_curvk ] ) is obtained again by comparison of ( [ e_tilda ] ) with ( [ comoving_curv ] ) .",
    "we can notice also that equation ( [ phi_g ] ) is the same as ( [ phi_equation ] ) since the peculiar gravitational potential defined in ( [ phi_g1 ] ) can be written in our terminology as @xmath86 and we can then use equation ( [ tilda_e ] ) to express the variable @xmath87 in terms of @xmath88 in ( [ phi_equation ] ) .",
    "we have therefore shown that @xmath82 is directly linked to @xmath12 .      from the definition of @xmath18 given by ( [ b_def ] )",
    "we obtain obvious mathematical requirement 1 - k(r)r^2 > 0",
    "[ cond1 ] this corresponds to the physical condition that a perturbed spherical region of comoving radius @xmath15 should not be causally disconnected from the rest of the universe .",
    "another important requirement is related to conservation of total mass , given by _ 0 ^ 4r^2(r)dr = 0 , [ cond2_0 ] that implies _",
    "r r^3k(r ) = 0 .",
    "[ cond2 ] this means that the universe remains spatially flat at infinity . as explained in @xcite ,",
    "if condition ( @xcite ) is not satisfied one unavoidably confronts a violation of the causality principle .",
    "an important parameter characterising the curvature profile is the value of @xmath89 that specifies the comoving length - scale of the overdense region in the configuration . from ( [ e_tilda ] )",
    "we have ( r_0 ) = 0  k(r_0 ) + . [ cond3 ]",
    "it is useful to introduce an integrated quantity @xmath2 that measures the mass - excess inside the overdense region , as frequently done in literature . from equation ( [ e_tilda ] )",
    ", one can see that any spherical integral of @xmath88 does not depend on the particular curvature profile used , but depends only on the value of @xmath12 at the outer edge of the configuration .",
    "the expression for @xmath2 is then given by r_0 ^ 3 ^ -1 ( s)(s)k(r_0)r_0 ^ 2 .",
    "[ delta_s ] we can see from this expression that @xmath2 is a gauge invariant quantity since it is directly proportional to @xmath90 , which is also a gauge invariant quantity .",
    "note once more the perfect separation of the different physical aspects of the problem : @xmath40 specifies the evolution of the perturbation amplitude in the long wavelength limit , @xmath63 represents the equation of state and @xmath91 specifies the spatial profile of the configuration .",
    "in this section we specify the profile @xmath12 in terms of two free parameters .",
    "first we want to point out that both @xmath15 and @xmath21 are gauge - dependent quantities .",
    "therefore we need to be careful when transferring the initial perturbation profiles onto the grid used for the numerical calculations .",
    "the circumference coordinate @xmath92 used in the code is gauge invariant and is related to @xmath15 by @xmath93 , while particular values of @xmath20 and @xmath15 are gauge dependent .",
    "another gauge invariant quantity is the product @xmath91 .",
    "these two gauge invariant products are connected by the presence of the comoving coordinate in both of them and therefore a particular specification of one of these three variables will specify the others .    to do this we compare the length scale @xmath94 of the configuration with the cosmological horizon @xmath95 r_0",
    "n r_h , [ n ] where @xmath96 is the number of horizon scales inside the configuration . from the definition of @xmath40 in ( [ eps_def ] ) , we have . to have @xmath97 we need to have @xmath98 and @xmath96 will be one of the input parameters used to impose the initial conditions",
    ". expressions ( [ n ] ) and ( [ eps_def ] ) relate the scale factor with @xmath89 s(t ) , [ sc_fac ] and we can use this to define the comoving coordinate as r r _ , [ r_def ] where the value of @xmath99 is calculated from equation ( [ d_mu ] ) r _ ^1/3 , and @xmath89 is determined by condition ( [ cond3 ] ) once the curvature profile is specified .    to parametrise @xmath12",
    "we should decide what is a reasonable perturbation shape .",
    "it is natural to start with a centrally peaked profile of the energy density , such that outside the overdense region there is an under - dense region which becomes asymptotically flat . to obtain an energy density profile with these properties",
    ", one should choose a centrally peaked curvature profile which is described in terms of a suitable continuous function and tends asymptotically to zero as @xmath100 .",
    "continuity should be ensured at least in the first and second derivatives , because these derivatives play a crucial role in the expressions for the perturbation profiles of density and velocity . to preserve the standard normalisation used in cosmology where a closed universe has a curvature equal to @xmath101",
    ", we choose to normalise the curvature profile to have @xmath102 .",
    "we start with a family of curvature profiles based on a gaussian shape , described as k(r ) = 1 + [ curv_profile ] where @xmath103 and @xmath104 are two independent parameters . in the particular case",
    "@xmath105 , the profile @xmath12 is exactly gaussian .",
    "the first derivative of @xmath12 is given by k^(r ) = - 1 + , [ curv_dev1 ] and we use this to calculate the value of @xmath89 as function of @xmath103 and @xmath104 using ( [ curv_profile ] ) and ( [ cond3 ] ) .",
    "we obtain a quadratic equation with the following solution for @xmath89 : & r_0 ^ 2 3 ^ 2 0 [ r0_eq ] + & + & r_0 ^ 2 ^2 0 [ r0_sol ] that we substitute into ( [ r_def ] ) to express the spatial comoving coordinate @xmath15 in terms of the background coordinate @xmath99 .",
    "it is then convenient to express @xmath89 in terms of the initial perturbation length scale @xmath106 .",
    "we therefore introduce a dimensionless ratio of the circumferential radius to @xmath106 defined as @xmath107 , which is equal to @xmath101 at the edge of the overdense region .",
    "thus the exponential argument in ( 102 ) is given by z^2 , [ z ] where & f ( ) ( 5 - 2)+ 0 + & + & 3 0    and one can see that the parameter @xmath104 cancels in the expression for @xmath108 , making clear the physical meaning of @xmath103 and @xmath104 : for the energy density perturbation profile expressed in terms of @xmath109 we get & ( z ) ( ) f ( ) 1 + -1z^2 - ^2 z^4 + & [ e_z ] and we see that the spatial profile given by the expression inside the parentheses depends only on @xmath103 .",
    "hence @xmath104 , appearing only outside the brackets , parameterises the amplitude of the density perturbation .",
    "the separation of factors in ( [ e_z ] ) allows us to control the values of the input parameters independently .",
    "the value of the second derivative of @xmath12 at the centre is given by k^(0 ) .",
    "when @xmath110 , the value @xmath111 is positive and an off - centred peak appears in the profiles of both curvature and energy density . for @xmath112 , there is a second overdense region , corresponding to a second solution for @xmath89 .",
    "because we are interested in solutions that represent perturbations centred at @xmath113 surrounded by an underdense region which becomes asymptotically flat , we restrict our attention to the range of shapes given by @xmath114 .",
    "in figure [ profiles1 ] we plot corresponding curvature and energy density profiles for three different values of @xmath103 between @xmath22 and @xmath101 , keeping the same value of @xmath104 .",
    "the particular case with @xmath115 in ( [ e_z ] ) coincides with one of the profiles used in @xcite : ( z ) ^2 1 + z^2 , [ mex_hat ] where the parameter @xmath104 has the same meaning as the quantity used in @xcite to parametrise the amplitude of the density perturbation .",
    "an advantage of the present description is the possibility to calculate the perturbation amplitude @xmath2 , defined in ( [ delta_s ] ) , directly from the curvature profile . using ( [ mex_hat ] ) for an arbitrary value of @xmath103 we have f ( ) 1 + - . [ delta_par ] another important point",
    "is given by condition ( [ cond1 ] ) , which should be taken into account to calculate the maximum allowed value of the density perturbation amplitude for each profile .",
    "therefore one needs to calculate the maximum value of @xmath104 for each @xmath103 .",
    "the results of these calculations are presented in figure [ profiles2 ] for two different cases ( @xmath116 and @xmath117 ) . from these plots",
    ", we can see clearly how the density perturbation amplitude @xmath2 varies with @xmath104 .",
    "next we consider another parametrisation of curvature that allows us to work with curvature profiles with a sharper transition from @xmath118 to @xmath38 .",
    "the new parametrisation is given by the following expression : k(r ) [ new_curv_param ] and its first derivative is k^(r ) in figure [ new_param ] we present the parametrisation given by ( [ new_curv_param ] ) , indicating explicitly the two independent parameters @xmath104 and @xmath119 : @xmath119 specifies the radius of the plateau with @xmath120 , @xmath104 describes the sharpness of the transition region . in particular , when @xmath121 the curvature profile coincides with the previous case for @xmath117 . applying condition ( [ cond3 ] ) we obtain a quadratic equation to calculate the value of @xmath89 , that we solve numerically using the newton - raphson method @xcite .",
    "the maximum value of @xmath119 satisfying condition ( [ cond1 ] ) is @xmath101 , while the minimum value of @xmath2 , obtained when @xmath122 , is @xmath123 .    in figure",
    "[ profiles5 ] , the top left plot shows the dependence of @xmath12 on @xmath104 with @xmath119 kept fixed , while the bottom left plot shows the dependence of @xmath12 on @xmath119 with @xmath104 kept fixed . in the right hand plots ,",
    "we show the corresponding profiles of @xmath124 .",
    "next we discuss the numerical tests performed so as to be confident that the perturbation profile @xmath12 has been introduced consistently into the code . for this",
    "we analysed the accuracy of our first order approach ( first order with respect to @xmath125 ) .",
    "in other words , imposing a perturbation with a length scale much larger then the cosmological horizon @xmath126 , we checked whether @xmath40 is small enough to make higher order terms negligible . a first requirement for the necessary value of @xmath96",
    "is that the comoving lengthscale of the horizon @xmath126 should be sufficiently smaller than the sharpness @xmath104 of the curvature profile .",
    "this means that @xmath127 . from equation ( [ r_def ] ) ,",
    "@xmath128 which then gives the condition , n > > .",
    "[ cond_n1 ]    using the curvature profile given by ( [ curv_profile ] ) we have @xmath129 for @xmath130 , while using the curvature profile given by ( [ new_curv_param ] ) we have that @xmath131 . substituting these two relations into ( [ cond_n1 ] ) , we see that both conditions are satisfied if n > > 1 + . [ cond_n2 ] this expression is valid also for the curvature profile given by ( [ curv_profile ] ) if we put @xmath132 . from this expression",
    "we can see that a sharper profile , with @xmath133 , requires larger values of @xmath96 .    for each set of initial input parameters",
    "we apply several numerical tests . here",
    "we present four sample cases that demonstrate how these tests work .",
    "the main test is based on equation ( [ k_gamma2 ] ) , which is used to rederive @xmath12 after calculating the initial conditions for the various quantities .",
    "expression ( [ k_gamma2 ] ) is valid when the higher order terms are negligible and so we expect to find some difference between the profiles of @xmath12 calculated with ( [ k_gamma2 ] ) and the original ones introduced analytically to describe the initial conditions . in figure [ test1 ]",
    "we plot the result of this test using @xmath12 given by ( [ curv_profile ] ) , with @xmath116 on the left and @xmath117 on the right . in figure [ test2 ]",
    "we plot @xmath12 given by ( [ new_curv_param ] ) , using the ratio @xmath134 equal to @xmath101 in the left panel , and equal to @xmath135 in the right panel . in all of these plots",
    "the solid line shows the analytical profile of @xmath12 , while the dashed lines corresponds to the profiles of @xmath12 calculated with ( [ k_gamma2 ] ) using different values of @xmath96 .",
    "the first value used was @xmath136 , that we know is not large enough , and this is also clear from the plots ; we then increased @xmath96 . in the first three cases , corresponding to curvature profiles with @xmath137",
    ", we found that @xmath138 is large enough to achieve acceptable precision . in the last case , when @xmath139 , we found that @xmath140 is sufficiently large . because we did not see any significant difference between the analytical and numerical values of @xmath12 , for the highest values of @xmath96 plotted in figure [ test1 ] and [ test2 ] we assume that these values of @xmath96 are satisfactory . to be more certain of this",
    "we also made another test , analysing numerically the evolution of configurations corresponding to the curvature profiles @xmath12 presented in figure [ test1 ] and [ test2 ] .",
    "we have verified that the values of @xmath96 indicated by the previous test do give essentially the same numerical evolution as for larger values of @xmath96 ( a standard test for numerical computations ) .    to complete our tests we used the constraint equation ( [ gamma ] ) to estimate the precision of the code and we found that",
    ", with the number of gridpoints that we used in our simulations , the numerical scheme has accuracy better than one part in @xmath141 ( by the numerical scheme here we mean the code itself plus the initial conditions . )      the calculations of black hole formation performed with initial conditions specified with a curvature profile , show similar hydrodynamical features as those presented in @xcite , where the same numerical technique was used .",
    "we present here four sample cases : two correspond to black hole formation , where the observer time slicing has been used , and two correspond to no black hole formation , where we have used the cosmic time slicing . each case",
    "is characterised by a particular value of the density perturbation amplitude @xmath2 and it is useful to introduce at this stage a measure of @xmath2 which is independent of the initial scale used when imposing the initial conditions .",
    "looking at expression ( [ delta_s ] ) , we can see that in the case of constant @xmath43 , if we define @xmath142 , the expression becomes time independent , giving in the radiation epoch k(r_0)r_0 ^ 2 .",
    "[ delta_tilda ] comparing this value with the value of @xmath2 at horizon crossing , we find that it is of the same order ( with a small correction due to the non linear growth of the energy density near to horizon crossing ) .",
    "therefore for the rest of the discussion we use @xmath143 as the amplitude of density perturbations . the dividing line between perturbations that collapse to form black holes and perturbations that disperse into the background is characterised by a threshold amplitude @xmath144 .",
    "this value was estimated numerically by making a converging sequence of numerical calculations until a satisfactory precision in determination of @xmath144 was achieved .",
    "the observer time coordinate @xmath145 is defined by fdu adt - bdr where @xmath146 is the lapse in the new coordinate system .",
    "the metric is then ds^2 - f^2du^2 - 2fbdrdu + r^2(d^2 + sin^2d^2 ) .",
    "when using observer - time slicing , black hole formation occurs when both the lapse @xmath146 and @xmath147 tend to zero ( see @xcite ) .",
    "these conditions are reached asymptotically and correspond to the formation of the event horizon , seen by a distant observer with an infinite redshift .",
    "we illustrate the two examples of black hole formation , shown in figures [ bh_form1 ] and [ bh_form2 ] , by plotting profiles of the radial velocity @xmath27 , lapse @xmath146 , @xmath148 ratio and mass @xmath32 as functions of the circumferential radius @xmath16 at different times .",
    "these show the formation of black holes for different values of ( @xmath149 ) with the smaller value giving rise to the lower mass black hole as expected @xcite .",
    "the upper left hand plots of these two figures show the behaviour of the radial velocity @xmath27 . here",
    "the time sequence starts from the top curve and continues towards the bottom one .",
    "note that , after a certain time appreciate how @xmath27 becomes negative in the central region , corresponding to the region where the black hole forms .",
    "in particular the event horizon , as can be seen clearly looking at the plots for @xmath148 , forms at the minimum of the radial velocity profile . outside this region",
    "there is first an intermediate shell with negative velocity corresponding to matter accreting into the black hole , then there is a region of positive velocity corresponding to the rest of the expanding universe .",
    "the upper right hand plots show the behaviour of the lapse @xmath146 with the time sequence of the curves given by the decreasing central value of @xmath146 .",
    "one can sees that a plateau forms in the central region , where the black hole is forming , and that the lapse tends asymptotically to zero there .",
    "the `` freezing '' of the evolution , as mentioned above , is one of the fundamental criteria for black hole formation .",
    "the other important feature to ensure us about black hole formation is the trapped surface condition ( @xmath150 ) which corresponds to @xmath151 . in the left bottom plots @xmath148",
    "is shown asymptotically tending to @xmath101 at the maximum of the curve .",
    "this determines the location where the event horizon will form . in this case",
    "the time sequence of the curves is given at first by the decreasing values of @xmath148 at the right edge of the plot , and then by the increasing of the maximum of these curves towards @xmath101 .",
    "finally the bottom right hand plots show the corresponding behaviour of the mass @xmath32 , indicating the value of the mass of the black hole.at late times , one sees the convergence of the curves . in figure [ bh_form1 ] and [ bh_form2 ]",
    "the circumferential radius @xmath16 and mass @xmath32 have been normalized with respect to the values for the cosmological horizon scale at the horizon crossing time .",
    "results from two representative calculation with @xmath152 ( using cosmic time ) are shown in figure [ sub_en ] , where we have plotted the energy density normalised with respect to the current background value , as a function of @xmath153 .",
    "the left hand plot corresponds to a small curvature perturbation far from the threshold @xmath144 with @xmath154 and @xmath155 . in this case",
    "negative velocities are never reached : initially the slower expansion of the central region proceeds more slowly than the expansion of the background . after horizon",
    "crossing , the perturbation is damped and compression a wave propagates outwards through the expanding medium .",
    "the other example shown in the right hand plot shows a case with @xmath156 . in this case the perturbation amplitude @xmath157 is close enough to @xmath158 to give rise to an initial collapse of the central region . because the gravitational potential is",
    "not large enough to form a trapped surface , as happens when @xmath159 , the collapsing matter bounces producing a compression wave which expands outwards .",
    "these hydrodynamical features were first seen in @xcite and were then analysed in detail in @xmath160 .    as a final result of these computations we determined the parameter ranges corresponding to black hole formation for the curvature profiles given by ( [ curv_profile ] ) and ( [ new_curv_param ] ) .",
    "figure [ delta_c ] summarises the results .",
    "the left hand plot shows the results obtained for the value of @xmath104 and @xmath103 used in parametrisation ( [ curv_profile ] ) , with the plane being divided into three different regions : the first one corresponds to no black hole formation , the second one to black hole formation and the third one to disconnected configurations ( @xmath161 ) .",
    "it can be seen that the region of parameters corresponding to black - hole formation is quite narrow .",
    "the same results are presented in terms of @xmath143 and @xmath103 in the right hand plot of figure [ delta_c ] .",
    "this shows very weak dependence of @xmath1 and @xmath162 on @xmath103 .",
    "we found that @xmath163 , @xmath164 for @xmath115 and @xmath165 , @xmath166 for @xmath167 .    in figure [ delta_c_new ]",
    "we present similar results for the second curvature parametrisation given by ( [ new_curv_param ] ) .",
    "the left hand plot shows the parameter space for @xmath104 and @xmath119 , and one can see the same three regions in the left hand plot as in figure [ delta_c ] .",
    "the right hand plot shows the same results in terms of @xmath119 and @xmath143 .    for wide range of parameters explored so far ,",
    "we have not yet seen formation of shocks as had seen in some earlier works @xcite .",
    "work is in progress to investigate this further .",
    "using the quasi homogeneous solution , we have impose initial conditions for pbh formation by introducing a time independent curvature profile @xmath12 , related to the curvature perturbation @xmath14 used elsewhere in the literature .",
    "this profile is the only source of perturbations in the fluid quantities and those perturbations behave as pure growing modes .",
    "we have obtained an analytical solution of the misner - sharp system of equations expressing perturbations of density and velocity in terms of the curvature profile @xmath12 in the rather general case where matter in the universe can be treated as an arbitrary mixture of perfect fluids .",
    "we have performed numerical calculations for @xmath168 to test the self consistency of these initial conditions for two different parameterisations of @xmath12 .",
    "specifying the initial conditions using a curvature profile seems to be an improvement in the analysis of the pbh formation scenario since it allows initial conditions for all the hydrodynamical variables relevant for the problem to be specified in self consistent way .",
    "we have shown that , in agreement with @xcite , the formation of pbhs requires higher amplitudes of strong metric deviation for sharper profiles of @xmath12 .",
    "thus the gaussian curvature profile , which is the least sharp , is the most favourable for pbh formation .",
    "we found that in this case @xmath169 in agreement with @xcite .",
    "the comparison of results obtained for two different parametrisation of curvature profiles has shown that the shape of the initial profile plays crucial role for pbh formation .",
    "this is an important reason to calculate the probability for having different curvature profiles ( work in progress ) @xcite and to link this probability with statistics of pbhs .",
    "such a link should greatly improve the constraints on possible cosmological models obtained from observational upper limits on pbhs .",
    "* acknowledgements : * in the course of this work , we have benefited from helpful discussions with many colleagues including john miller , bernard carr , marco bruni , luciano rezzolla , pavel ivanov , andrew liddle and carlo baccigalupi .",
    "the general spherically symmetric metric in the cosmic time coordinate is ds^2 -a^2dt^2 + b^2dr^2 + r^2d^2 [ gen_metric ] where the metric tensor @xmath170 is diagonal and @xmath17 , @xmath18 and @xmath16 are , in general , functions of @xmath15 and @xmath19 .",
    "the christoffel symbols are calculated by ^ _ g^ + - , while the components of the ricci tensor are given by r _ ^_^ _ - ^_^ _ + - and to calculate the ricci scalar we need to take into account only the diagonal components @xmath171 .    in the background universe with the frw metric the metric components are therefore a 1 b r s(t)r , where the curvature @xmath21 is a constant equal to @xmath172 .",
    "the diagonal components of the ricci tensor are & r_00 3 +   + & r_11 +   + & r_22 s+2 + 2k r^2 +   + & r_33 r_22 ^ 2and these are used to calculate the scalar curvature r 6 + + .",
    "[ r_flat ] while the three curvature is obtained by removing the terms with the time derivatives , r^(3 ) 6 .    in the general case of the metric given by ( [ gen_metric ] ) ,",
    "the diagonal components of the ricci tensor are    & r_00 + + - + +   + & + - - +   + & r_11 - + + + +   + & + - - +   + & r_22 - + - + +   + & + ^2 - ^2 + r - + 1 +   + & r_33 r_22 ^ 2to write the scalar curvature it is useful to define the following operators : d_t , d^2_t , d_r , d^2_r we then get @xmath173 . - 2 - + 2 + - 2 + ] and substituting the expressions for the coefficients @xmath17 , @xmath18 and @xmath16 given by ( [ r_def],[b_def],[a_def ] ) and expressing @xmath174 in terms of @xmath12",
    ", we get with the use also of ( [ dot_eps ] ) , that the ricci scalar is given by r 6 1 + + 1 - + , [ general_r ] where k(r ) + k^(r ) .",
    "it is useful to compare ( [ general_r ] ) with ( [ r_flat ] ) ."
  ],
  "abstract_text": [
    "<S> this work is part of an ongoing research programme to study possible primordial black hole ( pbh ) formation during the radiation dominated era of the early universe . working within spherical symmetry , we specify an initial configuration in terms of a curvature profile , which represents initial conditions for the large amplitude metric perturbations , away from the homogeneous friedmann robertson walker model , which are required for pbh formation . using an asymptotic quasi - homogeneous solution , we relate the curvature profile with the density and velocity fields , which at an early enough time , when the length scale of the configuration is much larger than the cosmological horizon , can be treated as small perturbations of the background values . </S>",
    "<S> we present general analytic solutions for the density and velocity profiles . </S>",
    "<S> these solutions enable us to consider in a self - consistent way the formation of pbhs in a wide variety of cosmological situations with the cosmological fluid being treated as an arbitrary mixture of different components with different equations of state . </S>",
    "<S> we show that the analytical solutions for the density and velocity profiles as functions of the initial time are pure growing modes . </S>",
    "<S> we then use two different parametrisation for the curvature profile and follow numerically the evolution of a range of initial configuration . </S>"
  ]
}