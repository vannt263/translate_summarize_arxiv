{
  "article_text": [
    "quantum key distribution ( qkd ) @xcite allows two parties ( alice and bob ) to generate a secret key despite the computational and technological power of an eavesdropper ( eve ) , who interferes with the signals .",
    "together with the vernam cipher @xcite , qkd can be used to provide information - theoretic secure communications .",
    "practical qkd systems can differ in many important aspects from their original theoretical proposal , since these proposals typically demand technologies that are beyond our present experimental capability .",
    "especially , the signals emitted by the source , instead of being single photons , are usually weak coherent pulses ( wcp ) with typical average photon numbers of 0.1 or higher .",
    "the quantum channel introduces errors and considerable attenuation ( about @xmath0 db / km ) that affect the signals even when eve is not present . besides",
    ", for telecom wavelengths , standard ingaas single - photon detectors can have a detection efficiency below @xmath1 and are noisy due to dark counts .",
    "all these modifications jeopardize the security of the protocols , and lead to limitations of rate and distance that can be covered by these techniques @xcite .",
    "a main security threat of practical qkd schemes based on wcp arises from the fact that some signals contain more than one photon prepared in the same polarization state .",
    "now eve is no longer limited by the no - cloning theorem @xcite since in these events the signal itself provides her with perfect copies of the signal photon .",
    "she can perform , for instance , the so - called _ photon number splitting _ ( pns ) attack on the multi - photon pulses @xcite .",
    "this attack gives eve full information about the part of the key generated with the multi - photon signals , without causing any disturbance in the signal polarization .",
    "as a result , it turns out that the standard bb84 protocol @xcite with wcp can deliver a key generation rate of order @xmath2 , where @xmath3 denotes the transmission efficiency of the quantum channel @xcite .    to achieve higher secure key rates over longer distances , different qkd schemes , that are robust against the pns attack ,",
    "have been proposed in recent years @xcite .",
    "one of these schemes is the so - called decoy state qkd @xcite where alice varies , independently and at random , the mean photon number of each signal state that she sends to bob by employing different intensity settings .",
    "eve does not know a priori the mean photon number of each signal state sent by alice .",
    "this means that her eavesdropping strategy can only depend on the photon number of these signals , but not on the particular intensity setting used to generate them . from the measurement results corresponding to different intensity settings , the legitimate users can estimate the classical joint probability distribution describing their outcomes for each photon number state .",
    "this provides them with a better estimation of the behaviour of the quantum channel , and it translates into an enhancement of the achievable secret key rate and distance .",
    "this technique has been successfully implemented in several recent experiments @xcite , and it can give a key generation rate of order @xmath4 @xcite .    while the security analysis of decoy state qkd included in refs .",
    "@xcite is relevant from a practical point of view , it also leaves open the possibility that the development of better proof techniques , or better classical post - processing protocols , might further improve the performance of these schemes in realistic scenarios . for instance , it is known that two - way classical post - processing protocols can tolerate a higher error rate than one - way communication techniques @xcite , or that by modifying the public announcements of the standard bb84 protocol it is possible to generate a secret key even from multi - photon signals @xcite .",
    "also , the use of local randomization @xcite and degenerate codes @xcite can as well improve the error rate thresholds of the protocols .",
    "in this paper we consider the uncalibrated device scenario @xcite and we assume the typical initial post - processing step where double click events are not discarded by bob , but they are randomly assigned to single click events @xcite . in this scenario , we derive simple upper bounds on the secret key rate and distance that can be covered by decoy state qkd based exclusively on the classical correlations established by the legitimate users during the quantum communication phase of the protocol .",
    "our analysis relies on two preconditions for secure two - way and one - way qkd .",
    "in particular , alice and bob need to prove that there exists no separable state ( in the case of two - way qkd ) @xcite , or that there exists no quantum state having a symmetric extension ( one - way qkd ) @xcite , that is compatible with the available measurements results .",
    "both criteria have been already applied to evaluate single - photon implementations of qkd @xcite . here",
    "we employ them for the first time to investigate practical realizations of qkd based on the distribution of wcp .",
    "we show that both preconditions for secure two - way and one - way qkd can be formulated as a convex optimization problem known as a semidefinite program ( sdp ) @xcite .",
    "such instances of convex optimization problems appear frequently in quantum information theory and can be solved with arbitrary accuracy in polynomial time , for example , by the interior - point methods @xcite . as a result , we obtain ultimate upper bounds on the performance of decoy state qkd when this typical initial post - processing of the double clicks is performed .",
    "these upper bounds hold for any possible classical communication technique that the legitimate users can employ in this scenario afterwards like , for example , the sarg04 protocol @xcite , adding noise protocols @xcite , degenerate codes protocols @xcite and two - way classical post - processing protocols @xcite . the analysis presented in this manuscript can as well be straightforwardly adapted to evaluate other implementations of the bb84 protocol with practical signals as , for instance , those experimental demonstrations based on wcp without decoy states or on entangled signals coming from a parametric down conversion source .",
    "the paper is organized as follows . in sec .",
    "[ sec_a ] we describe in detail a wcp implementation of the bb84 protocol based on decoy states .",
    "next , in sec .  [ sec_b ]",
    "we apply two criteria for secure two - way and one - way qkd to this scenario . here",
    "we derive upper bounds on the secret key rate and distance that can be achieved with decoy state qkd as a function of the observed quantum bit error rate ( qber ) and the losses in the quantum channel . moreover , we show how to cast both upper bounds as sdps .",
    "these results are then illustrated in sec .",
    "[ sec_c ] for the case of a typical behaviour of the quantum channel , _",
    "i.e. _ , in the absence of eavesdropping",
    ". finally , sec .",
    "[ conc ] concludes the paper with a summary .",
    "in decoy state qkd with wcp alice prepares phase - randomized coherent states with poissonian photon number distribution . the mean photon number ( intensity ) of this distribution",
    "is chosen at random for each signal from a set of possible values @xmath5 . in the case of the bb84 protocol , and assuming alice chooses a decoy intensity setting @xmath6 , such states can be described as @xmath7 where the signals @xmath8 denote fock states with @xmath9 photons in one of the four possible polarization states of the bb84 scheme , which are labeled with the index @xmath10 . on the receiving side , we consider that bob employs an active basis choice measurement setup .",
    "this device splits the incoming light by means of a polarizing beam - splitter and then sends it to threshold detectors that can not resolve the number of photons by which they are triggered .",
    "the polarizing beam - splitter can be oriented along any of the two possible polarization basis used in the bb84 protocol .",
    "this detection setup is characterized by one _ positive operator value measure _ ( povm ) that we shall denote as @xmath11 .    in an entanglement - based view",
    ", the signal preparation process described above can be modeled as follows : alice produces first bipartite states of the form @xmath12 where system @xmath13 is the composition of systems @xmath14 , @xmath15 , and @xmath16 , and the orthogonal states @xmath17 and @xmath18 record , respectively , the polarization state and decoy intensity setting selected by alice .",
    "the parameters @xmath19 and @xmath20 represent the a priori probabilities of these signals .",
    "for instance , in the standard bb84 scheme the four possible polarization states are chosen with equal a priori probabilities and @xmath21 for all @xmath22 .",
    "the signal @xmath23 that appears in eq .",
    "( [ mcl ] ) denotes a purification of the state @xmath24 and can be written as @xmath25 where system @xmath16 acts as a shield , in the sense of ref .",
    "@xcite and records the photon number information of the signals prepared by the source .",
    "this system is typically inaccessible to all the parties .",
    "one could also select as @xmath23 any other purification of the state @xmath24 .",
    "however , as we will show in sec .",
    "[ sec_b ] , the one given by eq .",
    "( [ pur_fnl ] ) is particularly suited for the calculations that we present in that section .    afterwards , alice measures systems @xmath14 and @xmath15 in the orthogonal basis @xmath17 and @xmath18 , corresponding to the measurement operators @xmath26",
    ". this action generates the signal states @xmath24 with a priori probabilities @xmath27 .",
    "the reduced density matrix @xmath28 , with @xmath29 , is fixed by the actual preparation scheme and can not be modified by eve . in order to include this information in the measurement process",
    ", one can add to the observables @xmath30 , measured by alice and bob , other observables @xmath31 such that @xmath32 form a complete tomographic set of alice s hilbert space @xmath33 @xcite . in order to simplify our notation , from now on",
    "we shall consider that the observed data @xmath34 and the povm @xmath30 contain also the observables @xmath31 .",
    "that is , every time we refer to @xmath30 we assume that these operators include as well the observables @xmath31 .",
    "our starting point is the observed joint probability distribution @xmath35 obtained by alice and bob after their measurements @xmath36 .",
    "this probability distribution defines an equivalence class @xmath37 of quantum states that are compatible with it , @xmath38      let us begin by considering two - way classical post - processing of the data @xmath35 .",
    "it was shown in ref .",
    "@xcite that a necessary precondition to distill a secret key in this scenario is that the equivalence class @xmath37 does not contain any separable state .",
    "that is , we need to find quantum - mechanical correlations in @xmath35 , otherwise the secret key rate , that we shall denote as @xmath39 , vanishes @xcite .",
    "as it is , this precondition answers only partially the important question of how much secret key alice and bob can obtain from their correlated data .",
    "it just tells if the secret key rate is zero or it may be positive .",
    "however , this criterion can be used as a benchmark to evaluate any upper bound on @xmath39 .",
    "if @xmath37 contains a separable state then the upper bound must vanish .",
    "one upper bound which satisfies this condition is that given by the regularized relative entropy of entanglement @xcite .",
    "unfortunately , to calculate this quantity for a given quantum state is , in general , a quite difficult task , and analytical expressions are only available for some particular cases @xcite .",
    "besides , this upper bound depends exclusively on the quantum states shared by alice and bob and , therefore , it does not include the effect of imperfect devices like , for instance , the low detection efficiency or the noise in the form of dark counts introduced by current detectors @xcite .",
    "another possible approach is that based on the best separable approximation ( bsa ) of a quantum state @xmath40 @xcite .",
    "this is the decomposition of @xmath40 into a separable state @xmath41 and an entangled state @xmath42 , while maximizing the weight of the separable part .",
    "that is , any quantum state @xmath40 can always be written as @xmath43\\rho_{ent},\\ ] ] where the real parameter @xmath44 is maximal .",
    "given an equivalence class @xmath37 of quantum states , one can define the maximum weight of separability within the class , @xmath45 , as @xmath46 note that the correlations @xmath35 can originate from a separable state if and only if @xmath47 .",
    "let @xmath48 denote the equivalence class of quantum states given by @xmath49 where @xmath42 represents again the entangled part in the bsa of the state @xmath40 .",
    "then , it was proven in ref .  @xcite that the secret key rate @xmath39 always satisfies @xmath50 where @xmath51 represents the shannon mutual information calculated on the joint probability distribution @xmath52 .",
    "as it is , this upper bound can be applied to any qkd scheme @xcite , although the calculation of the parameters @xmath45 and @xmath42 might be a challenge .",
    "next , we consider the particular case of decoy state qkd .",
    "the signal states @xmath24 that alice sends to bob are mixtures of fock states with different poissonian photon number distributions of mean @xmath5 .",
    "this means , in particular , that eve can always perform a _ quantum non - demolition _ ( qnd ) measurement of the total number of photons contained in each of these signals without introducing any errors .",
    "the justification for this is that the total photon number information via the qnd measurement  comes free \" , since the execution of this measurement does not change the signals @xmath24 .",
    "that is , the realization of this measurement can not make eve s eavesdropping capabilities weaker @xcite . if eve performs such a qnd measurement , then the signals @xmath29 are transformed as @xmath53 where the probabilities @xmath54 are given by @xmath55 the signals @xmath56 have the form @xmath57 and the normalized states @xmath58 only depend on the signals @xmath18 and the photon number @xmath9 .    from the tensor product structure of",
    "@xmath59 we learn that the signals @xmath59 can only contain quantum correlations between systems @xmath14 and @xmath60 . therefore , without loss of generality , we can always restrict ourselves to only search for quantum correlations between these two systems",
    ". additionally , in decoy state qkd alice and bob have always access to the conditional joint probability distribution describing their outcomes given that alice emitted an @xmath9-photon state .",
    "this means that the search for quantum correlations in @xmath37 can be done independently for each @xmath9-photon signal .",
    "that is , the legitimate users can define an equivalence class of signal states for each possible fock state sent by alice .",
    "a further simplification arises when one considers the typical initial post - processing step where double click events are not discarded by bob , but they are randomly assigned to single click events @xcite . in the case of the bb84 protocol , this action allows alice and bob to always explain their observed data as coming from a single - photon signal where bob performs a single - photon measurement @xmath61 @xcite .",
    "this measurement is characterized by a set of povm operators which are projectors onto the eigenvectors of the two pauli operators @xmath62 and @xmath63 , together with a projection onto the vacuum state @xmath64 which models the losses in the quantum channel , @xmath65 with @xmath66 and where @xmath67 @xcite . in particular , let @xmath68 denote the conditional joint probability distribution obtained by alice and bob after their measurements @xmath69 , with @xmath70 , given that alice emitted an @xmath9-photon state .",
    "that is , @xmath68 includes the random assignment of double clicks to single click events . as before , we consider that the observables @xmath69 contain as well other observables @xmath71 that form a tomographic complete set of alice s hilbert space @xmath72 .",
    "we define the equivalence class @xmath73 of quantum states that are compatible with @xmath68 as @xmath74 then , the secret key rate @xmath39 can be upper bounded as @xmath75 where @xmath76 denotes the maximum weight of separability within the equivalence class @xmath73 , and @xmath77 represents the shannon mutual information calculated on @xmath78 , with @xmath79 being the entangled part in the bsa of a state @xmath80 and whose weight of separability is maximum .    the main difficulty when evaluating the upper bound given by eq .",
    "( [ final_two ] ) still relies on obtaining the parameters @xmath76 and @xmath79 .",
    "next , we show how to solve this problem by means of a semidefinite program ( sdp ) @xcite . for that",
    ", we need to prove first the following observation .",
    "_ observation _ : within the equivalence classes @xmath73 of quantum signals given by eq .",
    "( [ eq_class_n_squash ] ) alice and bob can only detect the presence of negative partial transposed ( npt ) entangled states @xcite .",
    "_ proof_. the signals @xmath81 can always be decomposed as @xmath82 for some probability @xmath83 $ ] , and where @xmath84 , and @xmath85 .",
    "that is , the state @xmath86 can only be entangled if @xmath87 is also entangled . in order to detect entanglement in the latter one , bob projects it onto the eigenvectors of the two pauli operators @xmath62 and @xmath63 .",
    "this means , in particular , that the class of _ accessible _ entanglement witness operators @xmath88 that can be constructed from the available measurements results satisfy @xmath89 . here @xmath90 denotes transposition with respect to bob s system .",
    "we have , therefore , that @xmath91 , with @xmath92 $ ] . for the given dimensionalities ,",
    "it was proven in ref .",
    "@xcite that whenever @xmath93 is non - negative it represents a separable state , _",
    "i.e. _ , @xmath94 .",
    "this means that alice and bob can only detect entangled states @xmath87 that satisfy @xmath95 .",
    "since @xmath96 , the previous condition is only possible when @xmath97 .",
    "@xmath98    let us now write the search of @xmath76 and @xmath79 as a sdp .",
    "this is a convex optimisation problem of the following form @xcite : @xmath99 where the vector @xmath100 represents the objective variable , the vector @xmath101 is fixed by the particular optimisation problem , and the matrices @xmath102 and @xmath103 are hermitian matrices . the goal is to minimize the linear function @xmath104 subjected to the linear matrix inequality ( lmi ) constraint @xmath105 .",
    "the sdp that we need to solve has the form @xcite : @xmath106 \\\\",
    "\\nonumber \\text{subject to } & & \\sigma_{a_1b}^n({\\bf x})\\geq{}0 , \\\\",
    "\\nonumber & & \\text{tr}[\\sigma_{a_1b}^n({\\bf x})]=1 , \\\\",
    "\\nonumber & & \\text{tr}[a_{k } \\otimes t_j\\ \\sigma_{a_1b}^n({\\bf x})]=p_{kj}^n , \\ \\forall k , j , \\\\",
    "\\nonumber & & \\sigma_{sep}^n({\\bf x})\\geq{}0 , \\\\",
    "\\nonumber & & \\sigma_{sep}^{n\\ \\gamma}({\\bf x})\\geq{}0 , \\\\",
    "\\nonumber & & \\sigma_{a_1b}^n({\\bf x})-\\sigma_{sep}^n({\\bf x})\\geq{}0 , \\end{aligned}\\ ] ] where the objective variable @xmath100 is used to parametrise the density operators @xmath107 and @xmath108 . for that",
    ", we employ the method introduced in refs .",
    "the state @xmath107 which appears in eq .",
    "( [ primalsdp_two_way ] ) is not normalized , _",
    "i.e. _ , it also includes the parameter @xmath109 .",
    "the first three constraints in eq .",
    "( [ primalsdp_two_way ] ) guarantee that @xmath108 is a valid normalized density operator that belongs to the equivalence class @xmath73 , the following two constraints impose @xmath107 to be a separable state , while the last one implies that the entangled part of @xmath108 is a valid but not normalized density operator .",
    "its normalization factor is given by @xmath110 .",
    "if @xmath111 denotes a solution to the sdp given by eq .",
    "( [ primalsdp_two_way ] ) then @xmath112,\\ ] ] and the state @xmath79 is given by @xmath113      the classical post - processing of the observed data can be restricted to one - way communication @xcite .",
    "depending on the allowed direction of communication , two different cases can be considered : _ direct reconciliation _",
    "( dr ) refers to communication from alice to bob , _",
    "reverse reconciliation _ ( rr ) permits only communication from bob to alice @xcite . in this section",
    ", we will only consider the case of dr .",
    "expressions for the opposite scenario , _",
    "i.e. _ , rr , can be obtained in a similar way . in ref .  @xcite it was shown that a necessary precondition for secure qkd by means of dr ( rr ) is that the equivalence class @xmath37 given by eq .",
    "( [ eq_class ] ) does not contain any state having a symmetric extension to two copies of system @xmath60 ( system @xmath13 ) .",
    "a state @xmath40 is said to have a symmetric extension to two copies of system @xmath60 if and only if there exists a tripartite state @xmath114 , with @xmath115 , and where @xmath116 , which fulfills the following two properties @xcite : @xmath117 where the swap operator @xmath118 satisfies @xmath119 . a graphical illustration of a state @xmath40 which has a symmetric extension to two copies of system @xmath60 is given in fig .  [ fig_sym ] .     which has a symmetric extension to two copies of system @xmath60 .",
    "[ fig_sym ] ]    this definition can be easily extended to cover also the case of symmetric extensions of @xmath40 to two copies of system @xmath13 , and also of extensions of @xmath40 to more than two copies of system @xmath13 or of system @xmath60 .",
    "the best extendible approximation ( bea ) of a given state @xmath40 is the decomposition of @xmath40 into a state with a symmetric extension , that we denote as @xmath120 , and a state without symmetric extension @xmath121 , while maximizing the weight of the extendible part , _",
    "i.e. _ , @xmath122\\rho_{ne},\\ ] ] where the real parameter @xmath44 is maximal @xcite . note that this parameter is well defined since the set of extendible states is compact .",
    "equation  ( [ blia ] ) follows the same spirit like the bsa given by eq .",
    "( [ eq_bsa ] ) .",
    "now , one can define analogous parameters and equivalence classes as in sec .",
    "[ sec_twoway ] .",
    "in particular , the maximum weight of extendibility within an equivalence class @xmath37 is defined as @xmath123 .",
    "that is , the correlations @xmath124 can originate from an extendible state if and only if @xmath125 .",
    "finally , one defines @xmath126 as the equivalence class of quantum states given by @xmath127 , where @xmath121 denotes the nonextendible part in the bea of the state @xmath40 .",
    "then , it was proven in ref .  @xcite that the one - way secret key rate @xmath128 satisfies @xmath129 where @xmath130 represents the shannon mutual information now calculated on the joint probability distribution @xmath131 with @xmath132 .      the analysis contained in sec .",
    "[ sec_twoway ] to derive eq .",
    "( [ final_two ] ) from eq .",
    "( [ second_bound ] ) also applies to this scenario and we omit it here for simplicity .",
    "we obtain @xmath133 where @xmath134 denotes the maximum weight of extendibility within the equivalence class @xmath73 given by eq .",
    "( [ eq_class_n_squash ] ) , and @xmath135 represents the shannon mutual information calculated on @xmath136 , with @xmath137 being the nonextendible part in the bea of a state @xmath80 and whose weight of extendibility is maximum .    the parameter @xmath134 and the nonextendible state @xmath137 can directly be obtained by solving the following sdp : @xmath138 \\\\",
    "\\nonumber \\text{subject to } & & \\sigma_{a_1b}^n({\\bf x})\\geq{}0 , \\\\",
    "\\nonumber & & \\text{tr}[\\sigma_{a_1b}^n({\\bf x})]=1 , \\\\",
    "\\nonumber & & \\text{tr}[a_{k } \\otimes t_j\\ \\sigma_{a_1b}^n({\\bf x})]=p_{kj}^n , \\ \\forall k , j , \\\\",
    "\\nonumber & & \\rho_{a_1bb'}^n({\\bf x})\\geq{}0 , \\\\",
    "\\nonumber & & p\\rho_{a_1bb'}^n({\\bf x})p=\\rho_{a_1bb'}^n({\\bf x } ) , \\\\",
    "\\nonumber & & { \\rm tr}_{b'}[\\rho_{a_1bb'}^n({\\bf x})]=\\sigma_{ext}^n({\\bf x } ) , \\\\ \\nonumber & & \\sigma_{a_1b}^n({\\bf x})-\\sigma_{ext}^n({\\bf x})\\geq{}0 , \\end{aligned}\\ ] ] where the state @xmath139 is not normalized , _",
    "i.e. _ , it also includes the parameter @xmath109 .",
    "the first three constraints coincide with those of eq .",
    "( [ primalsdp_two_way ] ) .",
    "they just guarantee that @xmath140 .",
    "the following three constraints impose @xmath139 to have a symmetric extension to two copies of system @xmath60 , while the last one implies that the nonextendible part of @xmath108 is a valid but not normalized density operator .",
    "its normalization factor is @xmath110 .",
    "this sdp does not include the constraint @xmath141 because non - negativity of the extension @xmath142 , together with the condition @xmath143 , already implies non - negativity of @xmath139 . if @xmath111 represents a solution to the sdp given by eq .",
    "( [ primalsdp_one_way ] ) then we have that @xmath144,\\ ] ] and the state @xmath137 is given by @xmath145",
    "in this section we evaluate the upper bounds on the secret key rate both for two - way and one - way decoy state qkd given by eq .",
    "( [ final_two ] ) and eq .",
    "( [ final_one ] ) .",
    "moreover , we compare our results with known lower bounds for the same scenarios .",
    "the numerical simulations are performed with the freely available sdp solver sdpt3 - 3.02 @xcite , together with the parser yalmip @xcite .      to generate the observed data",
    ", we consider the channel model used in ref .",
    "this model reproduces a normal behaviour of the quantum channel , _",
    "i.e. _ , in the absence of eavesdropping .",
    "note , however , that our analysis can as well be straightforwardly applied to other quantum channels , as it only depends on the probability distribution @xmath68 that characterizes the results of alice s and bob s measurements .",
    "this probability distribution is given in tab .",
    "[ tab1 ] , where the conditional yields @xmath146 have the form        ' '' ''    & @xmath147 & @xmath148 & @xmath149 & @xmath150 & @xmath151 + @xmath152    ' '' ''    & @xmath153 & @xmath154 & @xmath155 & @xmath155 & @xmath156 + @xmath157 & @xmath154 & @xmath153 & @xmath155 & @xmath155 & @xmath156 + @xmath158 & @xmath155 & @xmath155 & @xmath153 & @xmath154 & @xmath156 + @xmath159 & @xmath155 & @xmath155 & @xmath154 & @xmath153 & @xmath156 +    @xmath160,\\ ] ]    with @xmath161 being the background detection event rate of the system , and where @xmath3 represents the overall transmittance , including the transmission efficiency of the quantum channel and the detection efficiency .",
    "the parameter @xmath162 denotes the quantum bit error rate of an @xmath9-photon signal .",
    "it is given by @xmath163+\\frac{1}{2}y_0}{y_n},\\ ] ] where @xmath164 represents the probability that a photon hits the wrong detector due to the misalignment in the quantum channel and in the detection apparatus .",
    "the parameter @xmath3 can be related with a transmission distance @xmath6 measured in km for the given qkd scheme as @xmath165 , where @xmath166 represents the loss coefficient of the optical fiber measured in db / km .",
    "the total db loss of the channel is given by @xmath167 .",
    "as discussed in sec .",
    "[ sec_b ] , the reduced density matrix of alice , that we shall denote as @xmath168 , is fixed and can not be modified by eve .",
    "this state has the form @xmath169 , where @xmath56 is given by eq .",
    "( [ eq_nsq ] ) . in the standard bb84 protocol",
    "the probabilities @xmath19 satisfy @xmath21 .",
    "we obtain , therefore , that @xmath168 can be expressed as @xmath170 to include this information in the measurement process , we consider that alice and bob have also access to the results of a set of observables @xmath71 that form a tomographic complete set of alice s hilbert space @xmath72 .",
    "in particular , we use a hermitian operator basis @xmath171 .",
    "these hermitian operators satisfy @xmath172 and have a hilbert - schmidt scalar product @xmath173 . the probabilities @xmath174 , with @xmath168 given by eq .",
    "( [ reduced ] ) .",
    "the resulting upper bounds on the two - way and one - way secret key rate are illustrated , respectively , in fig .",
    "[ fig_two_way ] and fig .",
    "[ fig_one_way ] .",
    "they state that no secret key can be distilled from the correlations established by the legitimate users above the curves , _ i.e. _ , the secret key rate in that region is zero .",
    "these figures include as well _ lower _ bounds for the secret key rate obtained in refs .",
    "note , however , the security proofs included in refs .",
    "@xcite implicitly assume that alice and bob can make public announcements using two - way communication , and only the error correction and privacy amplification steps of the protocol are assumed to be realized by means of one - way communication .",
    "we consider the uncalibrated device scenario and we study two different situations in each case : ( 1 ) no errors in the quantum channel , _",
    "i.e. _ , @xmath175 , @xmath176 , and ( 2 ) @xmath177 and @xmath178 .",
    "this last scenario corresponds to the experimental parameters reported by gobby - yuan - shields ( gys ) in ref .",
    "figure  [ fig_two_way ] and fig .  [ fig_one_way ] do not include the sifting factor of @xmath179 for the bb84 protocol , since this effect can be avoided by an asymmetric basis choice for alice and bob @xcite .",
    "moreover , we consider that in the asymptotic limit of a large number of transmitted signals most of them represent signal states of mean photon number @xmath180 . that is , the proportion of decoy states used to test the behaviour of the quantum channel within the total number of signals sent by alice is neglected .",
    "this means that @xmath181 in eq .",
    "( [ rn ] ) satisfies @xmath182 and @xmath183     given by eq .",
    "( [ final_two ] ) in logarithmic scale in comparison to known lower bounds for the same scenario given in ref .",
    "the figure includes two cases .",
    "( 1 ) no errors in the quantum channel , _",
    "i.e. _ , @xmath175 and @xmath176 . in this case",
    ", the upper bound ( ub ) is represented by a thin solid line , while the lower bound ( lb ) is represented by a thin dashed line .",
    "( 2 ) @xmath177 and @xmath178 , which correspond to the gys experiment reported in ref .  @xcite . in this case",
    ", the upper bound ( ub ) is represented by a thick solid line , while the lower bound ( lb ) after 3 b steps is represented by a thick dashed line .",
    "we assume asymmetric basis choice to suppress the sifting effect @xcite .",
    "[ fig_two_way ] ]     given by eq .",
    "( [ final_one ] ) in logarithmic scale in comparison to known lower bounds for the same scenario given in refs .",
    "the figure includes two cases .",
    "( 1 ) no errors in the quantum channel , _",
    "i.e. _ , @xmath175 and @xmath176 . in this case",
    ", the upper bound ( ub ) rr is represented by a thin solid line , while the lower bound ( lb ) is represented by a thin dashed line .",
    "( 2 ) @xmath177 and @xmath178 , which correspond to the gys experiment reported in ref .  @xcite . in this case , the upper bound ( ub ) rr is represented by a thick solid line , while the lower bound ( lb ) is represented by a thick dashed line .",
    "the two lines on the left hand side of the graphic represent upper bounds for the case of dr ( case ( 1 ) short dashed line , case ( 2 ) dash - dotted line ) .",
    "the inset figure shows an enlarged view of the upper bounds for a total db loss ranging from 0 to 5 db .",
    "we assume asymmetric basis choice to suppress the sifting effect @xcite .",
    "[ fig_one_way ] ]      in the case of no errors in the quantum channel ( case ( 1 ) above ) the lower bounds for two - way and one - way qkd derived in refs .",
    "@xcite coincide .",
    "furthermore , for low values of the total db loss , the upper bounds shown in the figures present a small bump which is specially visible in this last case .",
    "the origin of this bump is the potential contribution of the multi - photon pulses to the key rate .",
    "let us now consider the cutoff points for decoy state qkd in the case of errors in the quantum channel ( case ( 2 ) above ) .",
    "these are the values of the total db loss for which the secret key rate drops down to zero in fig .",
    "[ fig_two_way ] and fig .",
    "[ fig_one_way ] .",
    "we find that they are given , respectively , by : @xmath184 db ( lower bound two - way after 3 b steps ) , @xmath185 db ( upper bound two - way ) , @xmath186 db ( lower bound one - way ) , and @xmath187 db ( upper bound one - way with rr ) .",
    "these quantities can be related with the following transmission distances : @xmath188 km , @xmath189 km , @xmath190 km and @xmath191 km .",
    "here we have used @xmath192 db / km and the efficiency of bob s detectors is @xmath193 @xcite .",
    "it is interesting to compare the two - way cutoff point of @xmath189 km with a similar distance upper bound of @xmath194 km provided in ref .",
    "@xcite for the same values of the experimental parameters .",
    "note , however , that the upper bound derived in ref .",
    "@xcite relies on the assumption that a secure key can only be extracted from single photon states .",
    "that is , it implicitly assumes the standard bb84 protocol .",
    "if this assumption is removed and one also includes in the analysis the potential contribution of the multi - photon signals to the key rate ( due , for instance , to the sarg04 protocol @xcite ) , then the cutoff point provided in ref .",
    "@xcite transforms from @xmath194 km to @xmath195 km , which is above the @xmath189 km presented here .",
    "figure  [ fig_one_way ] shows a significant difference between the behaviour of the upper bounds for one - way classical post - processing with rr and dr .",
    "most importantly , the upper bounds on @xmath128 for the case of dr can be below the lower bounds on the secret key rate derived in refs .  @xcite .",
    "note , however , that the scenario considered here is slightly different from the one assumed in the security proofs of refs .",
    "in particular , the analysis contained in sec .",
    "[ sec_one_way ] for the case of dr does not allow _ any _ communication from bob to alice once the conditional probabilities @xmath68 are determined .",
    "this means , for instance , that bob can not even declare in which particular events his detection apparatus produced a  click \" .",
    "however , as mentioned previously , refs .",
    "@xcite implicitly assume that only the error correction and privacy amplification steps of the protocol are performed with one - way communication .",
    "if the analysis performed in sec .",
    "[ sec_one_way ] is modified such that bob is now allowed to inform alice which signal states he actually detected , then it turns out that the resulting upper bounds in this modified scenario coincide with those derived for the case of rr . to include this initial communication step from bob to alice in the analysis , one can use the following procedure . let the projector @xmath196 be defined as @xmath197 then , one can add to eq .",
    "( [ primalsdp_one_way ] ) one extra constraint @xmath198 and substitute the condition @xmath199 by @xmath200 equation  ( [ hoy_playa ] ) refers to the normalized state that is postselected by alice and bob once bob declares which signals he detected .",
    "equation  ( [ hoy_playa2 ] ) indicates that the bea has to be applied to this postselected state . finally ,",
    "each term in the summation given by eq .",
    "( [ final_one ] ) has to be multiplied by the yield @xmath146 , _",
    "i.e. _ , the probability that bob obtains a ",
    "click \" conditioned on the fact that alice sent an @xmath9-photon state .",
    "our numerical results indicate that the upper bounds given by eq .",
    "( [ final_two ] ) and eq .",
    "( [ final_one ] ) are close to the known lower bounds available in the scientific literature for the same scenarios .",
    "however , one might expect that these upper bounds can be further tightened in different ways .",
    "for instance , by substituting in eq .",
    "( [ final_two ] ) and eq .",
    "( [ final_one ] ) the shannon mutual information with any other tighter upper bound on the secret key rate that can be extracted from a classical tripartite probability distribution measured on a purification of the state @xmath79 ( in the case of two - way qkd ) or of the state @xmath137 ( one - way qkd ) . moreover , as they are , eq .",
    "( [ final_two ] ) and eq .",
    "( [ final_one ] ) implicitly assume that the legitimate users know precisely the number of photons contained in each signal emitted .",
    "however , in decoy state qkd alice and bob have only access to the conditional joint probability distribution describing their outcomes given that alice emitted an @xmath9-photon state , but they do not have single shot photon number resolution of each signal state sent .    as a side remark , we would like to emphasize that to calculate the upper bounds given by eq .",
    "( [ final_two ] ) and eq .",
    "( [ final_one ] ) it is typically sufficient to consider only a finite number of terms in the summations .",
    "this result arises from the limit imposed by the unambiguous state discrimination ( usd ) attack @xcite .",
    "this attack does not introduce any errors in alice s and bob s signal states .",
    "moreover , it corresponds to an entanglement - breaking channel @xcite and , therefore , it can not lead to a secure key both for the case of two - way and one - way qkd @xcite .",
    "the maximum probability of unambiguously discriminating an @xmath9-photon state sent by alice is given by @xcite @xmath201 for typical observations this quantity can be related with a transmission efficiency @xmath202 of the quantum channel , _",
    "i.e. _ , an @xmath202 that provides an expected click rate at bob s side equal to @xmath203 .",
    "this last condition can be written as @xmath204 whenever the overall transmission probability of each photon satisfies @xmath205 , then any pulse containing @xmath9 or more photons is insecure against the usd attack .",
    "after a short calculation , we obtain that the total number of @xmath9-photon signals that need to be considered in the summations of eq .",
    "( [ final_two ] ) and eq .",
    "( [ final_one ] ) can be upper bounded as @xmath206}\\big\\rfloor & \\textrm{$n$ even}\\\\   \\big\\lfloor\\frac{1}{2\\log_2[\\sqrt{2}(1-\\eta)]}\\big\\rfloor & \\textrm{$n$ odd}.   \\end{array } \\right.\\ ] ]",
    "in this paper we have derived upper bounds on the secret key rate and distance that can be covered by two - way and one - way decoy state quantum key distribution ( qkd ) .",
    "our analysis considers the uncalibrated device scenario and we have assumed the typical initial post - processing step where double click events are randomly assigned to single click events .",
    "we have used two preconditions for secure two - way and one - way qkd . in particular , the legitimate users need to prove that there exists no separable state ( in the case of two - way qkd ) , or that there exists no quantum state having a symmetric extension ( one - way qkd ) , that is compatible with the available measurements results .",
    "both criteria have been previously employed in the scientific literature to evaluate single - photon implementations of qkd .",
    "here we have applied them to investigate a realistic source of weak coherent pulses , and we have shown that they can be formulated as a convex optimization problem known as a semidefinite program ( sdp ) .",
    "such instances of convex optimization problems can be solved efficiently , for example by means of the interior - point methods .    as a result",
    ", we have obtained fundamental limitations on the performance of decoy state qkd when this initial post - processing of the double clicks is performed .",
    "these upper bounds can not be overcome by any classical communication technique ( including , for example , sarg04 protocol , adding noise protocols , degenerate codes and two - way classical post - processing protocols ) that the legitimate users may employ to process their correlated data afterwards .",
    "moreover , our results seem to be already close to well known lower bounds for the same scenarios , thus showing that there are clear limits to the further improvement of classical post - processing techniques in decoy state qkd .    the analysis presented in this paper could as well be straightforwardly adapted to evaluate other implementations of the bb84 protocol with practical signals like , for example , those experimental demonstrations based on wcp without decoy states or on entangled signals coming from a parametric down conversion source .",
    "m.c . especially thanks h",
    "lo and n. ltkenhaus for hospitality and support during his stay at the university of toronto and at the institute for quantum computing ( university of waterloo ) where this manuscript was finished .",
    "this work was supported by the european projects secoqc and qap , nserc , quantum works , csec , cfi , cipi , cifar , the crc program , mitacs , oit , oce , by xunta de galicia ( spain , grant no .",
    "incite08pxib322257pr ) , and by university of vigo ( program  axudas  mobilidade dos investigadores \" ) .",
    "99 n. gisin , g. ribordy , w. tittel and h. zbinden , rev .",
    "phys . * 74 * , 145 ( 2002 ) ; m. duek , n. ltkenhaus and m. hendrych , progress in optics * 49 * , edt .",
    "e. wolf ( elsevier ) , 381 ( 2006 ) .",
    "v. scarani , h. bechmann - pasquinucci , n. j. cerf , m. duek , n. ltkenhaus and m. peev , preprint quant - ph/0802.4155 , accepted for publication in rev .",
    "g. s. vernam , j. am .",
    "* xlv * , 109 ( 1926 ) . b. huttner , n. imoto , n. gisin , and t. mor , phys .",
    "a * 51 * , 1863 ( 1995 ) ; g. brassard , n. ltkenhaus , t. mor and b. c. sanders , phys . rev . lett .",
    "* 85 * , 1330 ( 2000 ) . w. k. wootters and w. h. zurek , nature * 299 * , 802 ( 1982 ) . c. h. bennett and g. brassard , proc .",
    "conference on computers , systems and signal processing , bangalore , india , ieee press , new york , 175 ( 1984 ) .",
    "h. inamori , n. ltkenhaus and d. mayers , eur .",
    "j. d * 41 * , 599 ( 2007 ) .",
    "d. gottesman , h .- k .",
    "lo , n. ltkenhaus and j. preskill , quant .",
    "comput . * 4 * , 325 ( 2004 ) .",
    "hwang , phys .",
    "lett . * 91 * , 057901 ( 2003 ) .",
    "lo , x. ma and k. chen , phys .",
    "* 94 * , 230504 ( 2005 ) .",
    "wang , phys .",
    "lett . * 94 * , 230503 ( 2005 ) ; x. ma , b. qi , y. zhao and h .- k .",
    "lo , phys .",
    "a * 72 * , 012326 ( 2005 ) ; x .- b .",
    "wang , phys .",
    "a * 72 * , 012322 ( 2005 ) ; x .- b .",
    "wang , phys .",
    "a * 72 * , 049908 ( e ) ( 2005 ) .",
    "v. scarani , a. acn , g. ribordy and n. gisin , phys .",
    "lett . * 92 * , 057901 ( 2004 ) .",
    "m. koashi , phys .",
    "lett . * 93 * , 120501(2004 ) ; k. tamaki , n. ltkenhaus , m. koashi and j. batuwantudawe , preprint quant - ph/0607082 ; k. inoue , e. waks and y. yamamoto , phys .",
    "a * 68 * , 022317 ( 2003 ) .",
    "y. zhao , b. qi , x. ma , h .- k .",
    "lo and l. qian , phys .",
    "96 * , 070502 ( 2006 ) ; y. zhao , b. qi , x. ma , h .- k . lo and l. qian , proc . of ieee international symposium on information theory ( isit06 ) , 2094 ( 2006 ) ; c .- z .",
    "peng , j. zhang , d. yang , w .- b .",
    "gao , h .- x .",
    "ma , h. yin , h .- p .",
    "zeng , t. yang , x .- b .",
    "wang and j .- w .",
    "pan , phys .",
    ". lett . * 98 * , 010505 ( 2007 ) ; d. rosenberg , j. w. harrington , p. r. rice , p. a. hiskett , c. g. peterson , r. j. hughes , a. e. lita , s. w. nam and j. e. nordholt , phys . rev . lett .",
    "* 98 * , 010503 ( 2007 ) ; t. schmitt - manderbach , h. weier , m. frst , r. ursin , f. tiefenbacher , t. scheidl , j. perdigues , z. sodnik , c. kurtsiefer , j. g. rarity , a. zeilinger and h. weinfurter , phys .",
    "* 98 * , 010504 ( 2007 ) ; z. l. yuan , a. w. sharpe and a. j. shields , appl .",
    ". lett . * 90 * , 011118 ( 2007 ) ; z .- q . yin , z .- f .",
    "han , w. chen , f .- x .",
    "l . wu and g .- c .",
    "guo , chin .",
    "lett * 25 * , 3547 ( 2008 ) ; j. hasegawa , m. hayashi , t. hiroshima , a. tanaka and a. tomita , preprint quant - ph/0705.3081 ; j. f. dynes , z. l. yuan , a. w. sharpe and a. j. shields , optics express * 15 * , 8465 ( 2007 ) .",
    "d. gottesman and h .- k .",
    "lo , ieee trans .",
    "theory * 49 * , 457 ( 2003 ) .",
    "x. ma , c .- h .",
    "f. fung , f. dupuis , k. chen , k. tamaki and h .- k .",
    "lo , phys .",
    "a * 74 * , 032330 ( 2006 ) .",
    "b. kraus , n. gisin and r. renner , phys .",
    "lett . * 95 * , 080501 ( 2005 ) ; r. renner , n. gisin and b. kraus , phys . rev .",
    "a * 72 * , 012332 ( 2005 ) ; j. m. renes and graeme smith , phys . rev . lett . * 98 * , 020502 ( 2007 ) .",
    "p. w. shor and j. a. smolin , preprint quant - ph/9604006v2 ; d. p. divincenzo , p. w. shor and j. a. smolin , phys .",
    "a * 57 * , 830 ( 1998 ) ; g. smith and j. a. smolin , phys .",
    "* 98 * , 030501 ( 2007 ) ; h .- k .",
    "lo , quantum inf .",
    "* 1 * , 81 ( 2001 ) ; g. smith , j. m. renes and j. a. smolin , phys . rev . lett .",
    "* 100 * , 170502 ( 2008 ) ; o. kern and j. m. renes , quantum inf .",
    "* 8 * , 756 ( 2008 ) .",
    "n. ltkenhaus , phys .",
    "a * 59 * , 3301 ( 1999 ) ; n. ltkenhaus , appl .",
    "b : lasers opt . *",
    "69 * , 395 ( 1999 ) ; n. ltkenhaus , phys . rev .",
    "a * 61 * , 052304 ( 2000 ) .",
    "m. curty , m. lewenstein and n. ltkenhaus , phys .",
    "lett . * 92 * , 217903 ( 2004 ) .",
    "m. curty , o. ghne , m. lewenstein and n. ltkenhaus , phys .",
    "a * 71 * , 022306 ( 2005 ) .",
    "t. moroder , m. curty and n. ltkenhaus , phys .",
    "a * 74 * , 052301 ( 2006 ) . t. moroder , m. curty and n. ltkenhaus , phys .",
    "a * 73 * , 012311 ( 2006 ) .",
    "m. curty and t. moroder , phys .",
    "a * 75 * , 052336 ( 2007 ) .",
    "l. vandenberghe and s. boyd , siam review * 38 * , 49 ( 1996 ) ; s. boyd and l. vandenberghe , _ convex optimization _ ( cambridge university press , cambridge , england , 2004 ) .",
    "k. horodecki , m. horodecki , p. horodecki and j. oppenheim , preprint arxiv : quant - ph/0506189 . here",
    "we define quantum correlations as those correlations that can not be explained by means of an intercept - resend attack @xcite .",
    "k. horodecki , m. horodecki , p. horodecki and j. oppenheim , phys .",
    "lett . * 94 * , 160502 ( 2005 ) ; v. vedral and m. b. plenio , phys .",
    "1619 ( 1998 ) . k. audenaert , j. eisert , e. jan , m. b. plenio , s. virmani and b. de moor , phys .",
    "87 * , 217902 ( 2001 ) .",
    "m. lewenstein and a. sanpera , phys .",
    "lett . * 80 * , 2261 ( 1997 ) ; s. karnas and m. lewenstein , j. phys .",
    "a * 34 * , 6919 ( 2001 ) .",
    "m. duek , m. jahma and n. ltkenhaus , phys . rev . a * 62 * , 022306 ( 2000 ) . t. tsurumaru and k. tamaki , phys",
    "a * 78 * , 032302 ( 2008 ) ; n. beaudry , t. moroder and n. ltkenhaus , phys .",
    "* 101 * , 093601 ( 2008 ) .",
    "a. peres , phys .",
    "lett . * 77 * , 1413 ( 1996 ) .",
    "b. kraus , j. i. cirac , s. karnas and m. lewenstein , phys .",
    "a * 61 * , 062302 ( 2000 ) .",
    "note that every equality constraint of the form @xmath207 , for any functions @xmath208 and @xmath209 , can always be represented by two inequality constraints @xmath210 and @xmath211\\geq{}0 $ ] .",
    "moreover , two ( or even more ) lmi constraints @xmath212 , can always be combined into a single new lmi constraint as @xmath213 before restricting alice and bob to only communicate one - way , one typically allows them to realize an initial two - way communication step to estimate the joint probability distribution describing their measurements outcomes .",
    "this is the approach that we follow in this paper . in decoy state qkd",
    "this is also important in order to distinguish between signal and decoy pulses and to estimate the conditional probabilities @xmath68 .",
    "f. grosshans , g. van assche , j. wenger , r. brouri , n. cerf and p. grangier , nature ( london ) * 421 * , 238 ( 2003 ) .",
    "a. c. doherty , p. a. parrilo and f. m. spedalieri , phys .",
    "lett . * 88 * , 187904 ( 2002 ) ; a. c. doherty , p. a. parrilo and f. m. spedalieri , phys .",
    "a * 69 * , 022308 ( 2004 ) ; a. c. doherty , p. a. parrilo , and f. m. spedalieri , phys .",
    "a * 71 * , 032333 ( 2005 ) . from now on",
    ", the term extension will always stand for a symmetric extension to two copies of system @xmath13 or @xmath60 .",
    "we will not make any further distinction between the different types of extension and we simply call the state extendible .",
    "the extension to two copies of system @xmath60 corresponds to dr , and extensions to two copies of system @xmath13 corresponds to rr .",
    "k. c. toh , r. h. tutuncu and m. j. todd , optim .",
    "methods software * 11 * , 545 ( 1999 ) .",
    "j. lfberg , in _ proceedings of the cacsd conference _ , taipei , taiwan , p. 284",
    "x. ma , ph.d .",
    "thesis , university of toronto , 2008 . c. gobby , z. l. yuan and a. j. shields , appl .",
    ". lett . * 84 * , 3762 ( 2004 ) .",
    "lo , h. f. c. chau and m. ardehali , j. cryptology * 18 * , 133 ( 2005 ) .",
    "m. horodecki , p. w. shor , and m. b. ruskai , rev .",
    "phys . * 15 * , 629 ( 2003 ) ; m. b. ruskai , rev . math . phys .",
    "* 15 * , 643 ( 2003 ) ."
  ],
  "abstract_text": [
    "<S> the use of decoy states in quantum key distribution ( qkd ) has provided a method for substantially increasing the secret key rate and distance that can be covered by qkd protocols with practical signals . </S>",
    "<S> the security analysis of these schemes , however , leaves open the possibility that the development of better proof techniques , or better classical post - processing methods , might further improve their performance in realistic scenarios . in this paper , we derive upper bounds on the secure key rate for decoy state qkd . </S>",
    "<S> these bounds are based basically only on the classical correlations established by the legitimate users during the quantum communication phase of the protocol . </S>",
    "<S> the only assumption about the possible post - processing methods is that double click events are randomly assigned to single click events . </S>",
    "<S> further we consider only secure key rates based on the uncalibrated device scenario which assigns imperfections such as detection inefficiency to the eavesdropper . </S>",
    "<S> our analysis relies on two preconditions for secure two - way and one - way qkd : the legitimate users need to prove that there exists no separable state ( in the case of two - way qkd ) , or that there exists no quantum state having a symmetric extension ( one - way qkd ) , that is compatible with the available measurements results . </S>",
    "<S> both criteria have been previously applied to evaluate single - photon implementations of qkd . </S>",
    "<S> here we use them to investigate a realistic source of weak coherent pulses . </S>",
    "<S> the resulting upper bounds can be formulated as a convex optimization problem known as a semidefinite program which can be efficiently solved . for the standard four - state qkd protocol </S>",
    "<S> , they are quite close to known lower bounds , thus showing that there are clear limits to the further improvement of classical post - processing techniques in decoy state qkd . </S>"
  ]
}