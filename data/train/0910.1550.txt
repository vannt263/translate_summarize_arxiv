{
  "article_text": [
    "einstein s general relativity ( gr ) is one of the most beautiful theories ever imagined by the human mind . although gr is a successful theory of gravitation , it is unable to explain , for example , the accelerating expansion of the universe , unless a cosmological constant or a dark energy fluid is considered .",
    "nowadays other theories of gravitation intend to give an alternative interpretation to this accelerating expansion ( see , e.g. , @xcite ) .",
    "most of these alternative theories , although having different approaches ( some scalar - tensor theories of gravitation , nonsymmetric gravitational theory , etc ) , reduce , in the weak - field limit , to a yukawa - like gravitational potential ( hereafter ygp ) , i.e. , @xmath1    the above equation gives the potential of a point mass m at a distance r ; g is the universal gravitational constant and @xmath2 is a constant . when @xmath3 , this potential tends to the newtonian one .",
    "note that the parameter @xmath2 is the compton wavelength of the exchange particle , which in the present case is a graviton .",
    "the graviton mass is related to @xmath2 through the well known equation @xmath4 , where @xmath5 is the planck constant and c is the speed of light .",
    "the ygp has been investigated in the literature , in particular , in galactic astronomy and cosmology .",
    "for example , signore @xcite studies this potential under the cosmological context , on the other hand , de araujo & miranda @xcite study how variations of the @xmath2 parameter can disturb galactic disks .",
    "this last study generalizes the ( newtonian ) toomre s @xcite expressions for rotation curves in order to account for a ygp .",
    "rodriguez - meza et al .",
    "@xcite consider the ygp as a correction on the newtonian potential .",
    "recently , some numerical approaches have been developed to study alternative theories .",
    "cervantes - cota et al .",
    "@xcite have developed numerical studies of a scalar - tensor theory in the weak field limit , using the @xmath0-body method . in these studies",
    "they consider that the gravitational potential in the weak field limit is given by    @xmath6    where @xmath7 is the potential from the scalar - tensor theory , @xmath8 is the newtonian potential , @xmath9 is given by eq.(1 ) , and @xmath10 , with @xmath11 being the brans - dicke parameter @xcite .",
    "they changed a particular @xmath0-body code replacing the newtonian potential by the potential @xmath7 and analyzed its influence on isolated galaxies , two colliding spiral galaxies and issues concerning the formation of bars .",
    "simulations of cosmological structure formation in @xmath12cdm scenarios are also studied .    in the present paper ,",
    "we use similar techniques to that used by cervantes et al .",
    "@xcite , although with a gravitational potential derived from other theories .",
    "we modify a popular @xmath0-body code , * gadget-2 * @xcite , _ replacing _ the newtonian potential by a pure ygp as given by equation [ yukpot ] , which is derived from some alternative theories of gravitation ( see , e.g. , visser s theory @xcite ) .",
    "it is worth stressing that although we have chosen a particular gravitational potential , the approach considered here can be applied to any alternative gravitational potential .",
    "this paper is organized as follows : in section 2 , we show the changes made in the * gadget-2 * code , in section 3 , we test the ygp * gadget-2 * code using a pair of particles and @xmath0-body systems .",
    "finally , in section 4 , we present the conclusions and briefly discuss how this modified code can be used to test alternative theories of gravitation via galactic dynamics .",
    "* gadget-2 * code is a new massively parallel treesph code , designed to simulate the evolution of @xmath0-body collisionless systems , like , e.g. , cosmological fluids , interacting galaxies , etc .",
    "it was developed to work with the concept of particles : matter distribution is represented by a system of particles , where each particle has position , velocity , label , gravitational potential , density ( if it represents a gas ) , and so on .",
    "* gadget-2 * uses an advanced system of processor s communication , based on mpi interface .",
    "mpi is a computer implementation that allows many computers to work in parallel .",
    "thus , one can simulate from thousand of particles using desktops machines to billions of particles using supercomputers .",
    "this code computes quickly many gravitational forces using a hierarchical tree algorithm , like the barnes tree code @xcite , grouping distant particles into larger cells and computing their total potential by multipole expansions .",
    "this method is very efficient and the computational effort is @xmath13 interactions , faster than the @xmath14 interactions from direct sum method .",
    "* gadget-2 * also computes gravitational potentials using particle - mesh ( pm ) method , when cosmological simulations are considered . in this case , the so called `` long range '' potentials are calculated by the pm method , which computes potentials in the fourier space using the mesh method . on the other hand ,",
    "the `` short range '' potentials are calculated in real space using the tree algorithm .",
    "it is worth stressing another very important characteristic of the * gadget-2 * code : its capability to integrate the equations of motion of particles with a leapfrog integrator based on the the _ kdk scheme _",
    "( kdk means kick - drift - kick , see @xcite ) , which conserves the symplectic nature of collisionless systems , in other words , it preserves the hamiltonian structure of these simulated systems .",
    "this approach is more efficient than other ones if applied with the adaptive timestep method , as shown by springel @xcite . in this way ,",
    "* gadget-2 * is in general more efficient than codes based on the runge - kutta integrators .",
    "it is worth mentioning that * gadget-2 * offers a set of options : pure newtonian simulations , cosmological comoving periodic simulation with the alternative use of the treepm formalism , etc .",
    "however , the `` cosmological simulation options '' can be activated or not , whether the code is compiled with these respective options . to simulate only gravitational interactions in local systems , such as galaxies or globular clusters ,",
    "we compile this code without the advanced cosmological options listed in the makefile ,  turning on \" the gravitation , and  turning off \" all the advanced options , such as pm formalism , expansion of the universe , etc .    in the present paper",
    ", we intend to study only gravitational interactions in local systems , without gas and cosmological expansion . to this end",
    ", we compile * gadget-2 * without the advanced options , and so we are able to study a cloud of particles self - interacting gravitationally .",
    "we fully studied the * gadget-2 * code in order to see where it is necessary to modify it in order to take into account the corresponding ygp expressions .",
    "we concluded that it is only necessary to change the code where instructions related to the newtonian potential and accelerations appear . in this case , the acceleration reads @xmath15    it is important to note that we have left @xmath2 as a free parameter .",
    "the reliability of a @xmath0-body simulation to model a given system depends on how one can control the numerical errors naturally intrinsic in this approach .    for example",
    ", the particles have their accelerations computed by a tree recursive code and , consequently , their positions and velocities are updated from the integrators . as a result",
    "the total energy of the simulated system , can be well conserved or not , whether the treecode calculations and the integration processes are well accurate or not . for these reasons",
    ", errors must be investigated and minimized to an acceptable level .    in the @xmath0-body numerical formalism ,",
    "one uses the fact that gravitation obeys the _ superposition principle_. therefore , one should firstly test the two - body problem , testing the code s integrator precision to the new gravitational potential one is considering .",
    "subsequent tests should consider @xmath0-body systems , verifying not only the treecode precision , but also the influence of some numerical parameters on the timestep values .      in this first test , we are able to probe how our changes in the * gadget-2 * code modify its integrator s precision .",
    "a similar test was performed by @xcite using newtonian physics .",
    "this test is very important , because we are interested in verifying the code s precision to drift positions and velocities in each timestep for the ygp .    on the other hand",
    ", one could argue that @xmath0-body systems and a two - body system are very different numerically , and consequently that this test would be useless .",
    "however , the @xmath0-body formalism is based on _ the superposition principle _ , in other words , the total potential is the sum of the potential from all individual particles .",
    "then , we firstly test the two - body problem in order to verify if the code can work appropriately .",
    "subsequently , we performe tests with a large amount of particles .    in fact , in the case where treecodes are used , _ the superposition principle _",
    "is used implicitly in the monopole , quadrupole and octopole expansion terms .",
    "but , * gadget-2 * uses only the monopolar expansions , which is sufficient and very accurate in the newtonian case , as shown by @xcite . in the case where the ygp is used ,",
    "we have performed some tests and , as we will show in the next sections , its monopolar term is also enough to yield satisfactory results .    in this first test",
    ", we simulate the motion of two particles : a massive particle and a test particle ( whose mass can be neglected ) .",
    "the massive particle has mass m=100.0 ( in code units , i.e. , m=1.0 @xmath16 ) , and is located at @xmath17 kpc , the origin of a cartesian coordinate system , and has velocity @xmath18 @xmath19 .",
    "it is important to note that this system of units is very common in galactic simulations with the * gadget-2 * code . in this system ,",
    "the time unit is given in @xmath20 years .",
    "the test particle has mass m = 0.1 , and is located initially at @xmath21 kpc with @xmath22 @xmath19 .",
    "we have chosen @xmath23 kpc , for our computational purposes .",
    "note that the initial separation between the particles is equal to @xmath2 . in this simulation ,",
    "the timestep @xmath24 values are @xmath25 .",
    "it is worth noting that in * gadget-2 * , the timestep criterion is    @xmath26 , \\label{timestep}\\ ] ]    where @xmath27 is an accuracy parameter ; @xmath28 , the the maximum timestep allowed , which is usually chosen to be a small fraction of the dynamical time of the system under study ; @xmath29 , the gravitational softening ; and @xmath30 , the modulus of the particle s acceleration , estimated from the last timestep . in the subsection 3.1.1 , we consider the role of the timestep in our simulations .",
    "we have made the system orbiting for 6 gyears .",
    "so , we are able to study the trajectory of the test particle in detail .",
    "we display the test particle s orbit in fig .",
    "[ figyuk ] .",
    "this picture is made by displaying the particle s position in the @xmath31plane obtained from 600 snapshots , including the initial one . as can be seen , the test particle orbits in the @xmath31plane and precesses .",
    "this orbit characteristic is very important to test the reliability of our modified code .    plane .",
    "the central particle is the massive one.,width=377 ]    the orbit precession showed in fig .",
    "[ figyuk ] is a real physical effect , it is not related to any numerical instabilities .",
    "ygp decreases with distance more steeply than the newtonian potential .",
    "it is well known , from the bertrand s theorem , that potentials that fall with distance differently from @xmath32 make the orbits to precess ; in other words , the orbits are not closed , as we show in fig .",
    "[ figyuk ] . in the following sections",
    ", we will study this issue in detail .      from equation [ timestep ] ,",
    "the @xmath24 values depend strongly on the acceleration of the particles .",
    "but the acceleration depends also on some other parameters , for example , the softening length @xmath29 and the ygp parameter @xmath2 . when the distance between two particles is smaller than the softening length scale , the gravity law in the simulation is replaced by a softening kernel that avoids divergences in the calculated field ( see , e.g. , @xcite ) . due to the numerical nature of our calculations ,",
    "the investigation of the timestep values is a very important task , due to the fact that their values are used by the kdk algorithm to update positions and velocities .",
    "therefore , it is necessary to probe the influence of the numerical parameters @xmath2 and @xmath29 on the values of the timesteps . in this sense , we have rerun the two - body simulations described above , changing the values of the parameters @xmath2 and @xmath29 . concerning the @xmath0-body system",
    ", we will show in the next sections why * gadget-2 * is a safe code to deal with these parameters , displaying the @xmath24 values for different parameters @xmath2 and @xmath29 .",
    "in table [ table1 ] , we display the maximum @xmath24 values from a set of 6 runs , where we have set the same simulated time and used the same two - body system described in subsection [ binary ] .",
    "we have only changed the values of @xmath29 and @xmath2 , setting @xmath33 for all experiments , to improve the timestep accuracy .    in these simulations , we run the two - body system for 6 gyears for @xmath34 1 , 10 and 100 kpc , and with @xmath29 = 0.1 and 1 kpc . although setting @xmath29 values for two - body tests seems to be unnecessary , we want to probe how these parameters change our results .",
    "we have also made a newtonian simulation for a two - body system using the default * gadget-2 * , to compare our modified code to the original one . in the newtonian case ,",
    "we obtain @xmath35 for @xmath36 kpc and @xmath37 for @xmath38 kpc .",
    "it is worth mentioning that for all the runs , for different values of @xmath2 , @xmath29 and timesteps , the total energy conserves very well , as we will see below .",
    ".some runs with different @xmath29 and @xmath2 values .",
    "the first column shows the @xmath2 values , the second one the @xmath29 values and the third one , @xmath24 .",
    "the first line display the results of the simulation described in subsection [ binary ] .",
    "[ cols=\"<,^,^\",options=\"header \" , ]     to make the runs displayed in the table [ table2 ] , we estimate the @xmath29 values taking the mean inter - particle separation at the center of the halo and disk .",
    "our values are near to those used by @xcite and are typical , if compared to those cited in the literature .",
    "note that in the cases where @xmath39 , the simulations gets  more collisional \" and the energy conservation gets a little bit worse , in agreement to the results obtained by @xcite .",
    "if the resolution is increased , in other words , if the @xmath29 values are smaller , then timestep values are smaller as well . as a consequence , the * gadget-2 * tree algorithm computes greater accelerations and potentials at these smaller scales than in the small resolution cases ( greater @xmath29 values )",
    ".    however , in these cases where @xmath0 is very large , the system tends to be collisionless , because in the _ close encounters _",
    ", the softening kernel prevent divergences of accelerations and potentials , once @xmath29 is chosen appropriately . also , the collective potential dominates over individual interactions , making results better to @xmath40 particles .",
    "so , the greater the resolution is ( i.e. , the greater n ) the better is the energy conservation as long as the @xmath29 values are correctly chosen .",
    "but , note that , even with a modest value of n , the energy conservation can be quite good . also , to probe a given alternative theory it is not always necessary a high resolution simulation , since the global properties of a galaxy , such as",
    ", for example , the density profile , can be very sensitive to the alternative potential .",
    "in other papers to appear elsewhere we consider this issue for early and late type galaxies .",
    "from our results , we consider our modified code able to test the ygp .",
    "therefore , we are able to study alternative theories using galaxies or globular clusters , with the same quality one obtains with the use of newtonian codes .",
    "the present paper considers the use of the well known * gadget-2 * , with the appropriate modifications , to study alternative theories of gravitation , with particular attention to the ygp . in this first paper",
    "we discuss how to modify the * gadget-2 * and evaluate how reliable this modified code is , performing a series of tests .",
    "as we have shown in the previous sections , our tests are successful : numerical errors from our changes on * gadget-2 * are neglected and we can use this modified code to probe alternative theories of gravitation . for example , we can use arguments based on galactic dynamics to exclude or not the yukawa potential hypothesis .",
    "this is very important , due to the fact that alternative theories appear frequently in the literature , but so far there are no many investigations in the galactic scales using @xmath0-body codes and galactic dynamics formalism .",
    "we will show , in future papers , how to test these alternative theories using early and late - type galaxies .",
    "the authors would like to thank the brazilian agencies capes , cnpq and fapesp for support .",
    "the authors would like also to thank mrcio eduardo da silva alves for interesting suggestions , discussions and for the critical reading of the paper ."
  ],
  "abstract_text": [
    "<S> in the weak field limit general relativity reduces , as is well known , to the newtonian gravitation . </S>",
    "<S> alternative theories of gravity , however , do not necessarily reduce to newtonian gravitation ; some of them , for example , reduce to yukawa - like potentials instead of the newtonian potential . since the newtonian gravitation is largely used to model with success the structures of the universe , such as for example galaxies and clusters of galaxies , a way to probe and constrain alternative theories , in the weak field limit , </S>",
    "<S> is to apply them to model the structures of the universe . in the present study </S>",
    "<S> we consider how to probe yukawa - like potentials using @xmath0-body numerical simulations . </S>"
  ]
}