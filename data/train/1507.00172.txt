{
  "article_text": [
    "the optimal control of orbit transfer ( see , e.g. , @xcite ) and attitude reorientation ( see , e.g. , @xcite ) for spacecrafts have been extensively studied in the past few decades .",
    "the optimal control problem of _ orbit transfer _ focuses mostly on how to move the spacecraft from one orbit or point to another orbit or point by using minimum energy , while the optimal control problem of _ attitude reorientation _ is mainly devoted to determine how to change the pointing direction of the spacecraft in minimum time . in the existing literature ,",
    "these two optimal control problems are considered separately in general . from the engineering point of view , for most satellites , it is appropriate to design separately the control laws for the orbit movement and for the attitude movement . however , for the rockets , the trajectory is controlled by its attitude angles : the way to make the rocket follow its nominal trajectory is to change its attitude angles , and therefore it is desirable to be able to determine the optimal control subject to the coupled dynamical system .",
    "though the control of the coupled problem was also studied in many previous works ( see , e.g. , @xcite ) , it does not seem that the problem has been investigated in the optimal control framework so far .    in this paper",
    ", we consider the time minimum control of the attitude reorientation coupled with the orbit dynamics of a rocket , denoted in short @xmath0 .",
    "the chattering phenomenon that may occur according to the terminal conditions under consideration , makes in particular the problem quite difficult .",
    "_ chattering _ means that the control switches an infinite number of times over a compact time interval .",
    "such a phenomenon typically occurs when trying to connect bang arcs with a higher - order singular arc ( see , e.g. , @xcite ) . in @xcite",
    ", we studied the planar version of @xmath0 , where the system consists of a single - input control - affine system , and we established as well the occurence of a chattering phenomenon and that the chattering extremals are locally optimal in @xmath1 topology . is said to be locally optimal in @xmath1 topology if , for every neighborhood @xmath2 of @xmath3 in the state space , for every real number @xmath4 so that @xmath5 , for every trajectory @xmath6 , associated to a control @xmath7 on @xmath8 $ ] , contained in @xmath9 , and satisfying @xmath10 , @xmath11 , there holds @xmath12 , where @xmath13 is the cost functional to be minimized . ]",
    "a second important difficulty in @xmath0 is due to the coupling of the attitude movement with the orbit dynamics .",
    "indeed the system contains both slow ( orbit ) and fast ( attitude ) dynamics",
    ". this observation will be particularly important in order to design appropriate numerical approaches .    in order to analyze the extremals of the problem , we use geometric optimal control theory ( see @xcite ) . the pontryagin maximum principle and the geometric optimal control , especially the concept of lie bracket ,",
    "will be used in this paper in order to establish an existence result of the chattering phenomenon .",
    "more precisely , based on the goh and generalized legendre - clebsch conditions , we prove that there exist optimal chattering arcs when trying to connect a regular arc with a singular arc of order two .    there",
    "exist various numerical approaches to solve an optimal control problem .",
    "the direct methods ( see , e.g. , @xcite ) consist of discretizing the state and the control and thus of reducing the problem to a nonlinear optimization problem ( nonlinear programming ) with constraints .",
    "the indirect methods consist of numerically solving a boundary value problem obtained by applying pontryagin maximum principle ( pmp , see @xcite ) , by means of a shooting method .",
    "there exist also mixed methods that discretize the pmp necessary conditions and use then a large - scale optimization solver ( see , e.g. , @xcite ) .",
    "since these numerical approaches are not easy to initialize successfully , it is required them to combine with other theoretical or numerical approaches ( see the survey @xcite ) .",
    "here , we will use numerical continuation , which has proved to be very powerful tool to be combined with the pmp .",
    "for example , in @xcite , the continuation method is used to solve difficult orbit transfer problems .",
    "however , due to the chattering phenomenon , numerical continuation combined with shooting can not give an optimal solution to the problem for certain terminal conditions for which the optimal trajectory contains a singular arc of higher - order .",
    "in that case , we propose sub - optimal strategies by using direct methods computing approximate piecewise constant controls .",
    "it is noticeable that our indirect approach can also be adapted to generate sub - optimal solutions , by stopping the continuation procedure before its failure due to chattering .",
    "this approach happens to be faster than the direct approach , and appears as an interesting alternative for practice .    from the engineer point of view",
    ", the theoretical analysis as well as the numerical strategies and the way to design them ( in particular , the design of the problem of order zero ) are strongly based on the fact that the orbit movement is much slower than the attitude movement .",
    "the paper is organized as follows . in section [ chp_model ]",
    ", we describe the mathematical model of the system consisting of the attitude dynamics , of the attitude kinematics , and of the orbit dynamics . in section [ chp_generalresults ] ,",
    "we recall the pontryagin maximum principle and some higher necessary conditions of optimality ( goh and generalized legendre - clebsch conditions ) for bi - input control affine systems . based on these necessary conditions of optimality",
    ", we establish a result on the existence of the optimal chattering extremals . in section [ chp_gae ]",
    ", we analyze the regular and singular extremals of the problem @xmath0 . for the regular extremals , we classify the switching points and state some useful properties . for the singular extremals ( which are of order two ) , we show that the chattering phenomenon occurs for the problem @xmath0 by using the results given in the previous section . in section [ chp_continuation ] ,",
    "we propose a numerical approach to solve the problem @xmath0 by implementing numerical continuation combined with shooting .",
    "numerical results are given in section [ chp_numerical ] .",
    "the problem is to control the attitude movement coupled with the orbit dynamics in the launching ascent stage for a rocket . in this paper , we take the system parameters of the rocket _",
    "ariane 5_. in order to keep the stability of the rocket along the flight , the attitude maneuver should be moderate , i.e. , at most @xmath14 degrees , and then it is possible to use euler angles to model the attitude of the engine . in this section ,",
    "we first define the coordinates systems , and then we give the equations of the attitude dynamics , of the attitude kinematics and of the orbit dynamics .",
    "the model consists of eight ordinary differential equations : three for the components of the velocity vector , three for the euler angles and two for the components of the angular velocity vector .      throughout the paper",
    ", we make the following assumptions :    * the earth is a sphere and is fixed in the inertial space , i.e. , the angular velocity of the earth is zero , which means that @xmath15 . *",
    "the position of the rocket remains the same during the maneuver of the rocket .",
    "* the rocket is an axial symmetric cylinder .",
    "* the aero - dynamical forces are zero . *",
    "the rocket engine can not be shut off during the flight and the module of the thrust force is constant , taking its maximum value , i.e. , @xmath16 .",
    "the * unit single - axis rotation * maps @xmath17 : @xmath18 , for @xmath19 , @xmath20 are defined by @xmath21 for a given vector @xmath22 , taking @xmath23 means to rotate the vector @xmath24 with respect to the axis @xmath25 by an angle of @xmath26 . with this definition ,",
    "we next introduce the coordinate frames that will be used throughout the paper .",
    "the * earth frame * @xmath27 is fixed around the center of the earth @xmath28 . the axis @xmath29 points to the north pole , and the axis @xmath30 is in the equatorial plan of the earth pointing to the equinox .",
    "the * launch frame * @xmath31 is fixed around the launch point @xmath32 ( where the rocket is launched ) . the axis @xmath33 is normal to the local tangent plane , pointing to the launch direction ( here we assume that the rocket is vertically launched , i.e. , the launch direction is perpendicular with the local tangent plane ) , and the axis @xmath34 points to the north . as shown in figure [ frames ] ( a ) , the launch frame is derived from the earth frame by two ordered unit single - axis rotations @xmath35 and @xmath36 , @xmath37 where @xmath38 and @xmath39 are the longitude and latitude of the launch point , respectively .",
    "the * body frame * @xmath40 is defined as follows . the origin of the frame @xmath41 is fixed around the mass center of the rocket , the axis @xmath42 is along the axis - symmetric axis of the rocket , and the axis @xmath43 is in the cross - section .",
    "the body frame can be derived by three ordered unit single - axis rotations from the launch frame , as shown in figure [ frames ] ( b ) , @xmath44 where @xmath45 is the pitch angle , @xmath46 is the yaw angle and @xmath47 is the roll angle .",
    "therefore , the transformation matrix from @xmath48 to @xmath49 is @xmath50 and the transformation matrix from @xmath49 to @xmath48 is @xmath51 .",
    "the attitude dynamics are written in vectorial form in the body frame @xmath49 as @xmath52 where @xmath53 is the inertia matrix , @xmath54 is the absolute angular velocity vector , i.e. , the angular velocity of the rocket with respect to the inertial space , and @xmath55 is the control torques introduced by the rocket thrust .",
    "the index @xmath56 means that the vectors are expressed in the body frame @xmath49 .",
    "setting @xmath57 , @xmath58 and @xmath59 , gives @xmath60 the control torque @xmath55 is the cross product of the thrust vector @xmath61 and of its moment arm @xmath62 .",
    "the moment arm is the vector from the center of mass @xmath41 to the force acting point @xmath63 , given here by @xmath64 .",
    "moreover , as shown in figure [ thrust ] ( a ) , the thrust force vector is @xmath65 where @xmath66 , @xmath67 $ ] , and @xmath68 $ ] .",
    "the control torque is then @xmath69 by assumption , the rocket is axial symmetric , and hence @xmath70 .",
    "assume that @xmath71 , and let @xmath72",
    ". then gives @xmath73 with @xmath74 .        according to the parameters of the rocket engine ,",
    "@xmath75 is less than @xmath76 degrees and thus the error between @xmath77 and @xmath78 is less than @xmath79 .",
    "therefore , in the model we make the approximation @xmath80 and we define @xmath81 and @xmath82 and @xmath83 with @xmath84 .",
    "hence @xmath85      since @xmath54 is the angular velocity vector of the rocket with respect to the inertial space , it is equal to the sum of the angular velocity @xmath86 of the rocket with respect to the earth frame , of the angular velocity @xmath87 of the earth frame with respect to the earth , and of the angular velocity @xmath88 of the earth with respect to the inertial space . according to the assumptions and definitions of the frames ,",
    "it is easy to see that the last two terms are zero , and thus @xmath89 .",
    "therefore , based on the definition of the body frame , the relationship between angular velocity and euler angles are @xmath90 where @xmath91 is given by .",
    "then the equations of the attitude kinematics are @xmath92 therefore , the two equations of and the three equations of describe the attitude movement .",
    "note that when @xmath93 , @xmath94 , the euler angles defined above are not well defined ( usual singularities of the euler angles ) .",
    "we assume in this paper that the maneuvers are small enough , so that these singularities will not be encountered .",
    "the equation of the orbit dynamics in vectorial form is @xmath95 where the notation @xmath96 means that the vector is expressed in the launch frame @xmath48 .",
    "the vector @xmath97 is the velocity of the rocket with respect to the earth frame @xmath98 , and its components in the launch frame are @xmath99 , @xmath100 and @xmath101 .",
    "the vector @xmath102 can be approximated by @xmath103 , where @xmath104 is a real number representing the standard gravity ( @xmath105 ) .",
    "due to the fact that the control angle @xmath78 is very small in practice ( physical constraints imposed by the rocket engine ) , we assume that the thrust force is along the body axial symmetric axis . according to the previous assumptions , the equation of the orbit dynamics becomes @xmath106 where @xmath107 is constant .",
    "note that this additional assumption is made also because the attitude of the rocket is controlled by only a part of the rocket engines , and so the total thrust remains almost parallel to the rocket symmetric axis .",
    "[ [ model . ] ] model .",
    "+ + + + + +    the system -- has two control inputs @xmath108 and @xmath109 , and we obtain the system @xmath110 defining the state variable @xmath111 , we write the system as the bi - input control - affine system @xmath112 where the controls @xmath108 and @xmath109 satisfy the constraint @xmath113 , and the vector fields @xmath114 , @xmath115 and @xmath116 are defined by @xmath117    [ [ terminal - conditions - and - system - parameters . ] ] terminal conditions and system parameters .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    let @xmath118 , @xmath119 , @xmath120 , @xmath121 , @xmath122 , @xmath123 , @xmath124 , @xmath125 , @xmath126 , @xmath127 , @xmath128 , @xmath129 and @xmath130 be real numbers .",
    "the initial conditions are fixed to @xmath131 the desired final velocity is required to be parallel to the body axis @xmath42 , according to @xmath132 , and therefore , the constraints on the final conditions are @xmath133 note that the parallel condition on the final velocity is due to the fact that most rockets are planned to maintain a zero angle of attack along the flight .",
    "the angle of flight , when the air wind is set to zero , is defined as the angle between the velocity and the rocket body axis .",
    "[ [ minimum - time - control - problem - bf - mtcp . ] ] minimum time control problem @xmath0 .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we set @xmath134 , and we define the target set ( submanifold of @xmath135 ) @xmath136 the minimum time control problem @xmath0 consists of steering the bi - input control - affine system from @xmath137 to the final target @xmath138 in minimum time @xmath139 , with controls satisfying the constraint @xmath113 .",
    "in this section , we focus on the chattering phenomenon for bi - input control - affine systems with control constraints and with commuting controlled vector fields .",
    "the results that we are going to give are general and will be used in the next section to analyze the problem @xmath0 .",
    "we consider the following general framework .",
    "let @xmath140 be a smooth manifold of dimension @xmath141 , let @xmath142 be arbitrary , and let @xmath138 be a submanifold of @xmath140 .",
    "we consider on @xmath140 the minimal time control problem @xmath143 where @xmath114 , @xmath115 and @xmath116 are smooth vector fields on @xmath140 .    according to classical results ( see ,",
    "e.g. , @xcite ) , there exists at least one optimal solution @xmath144 , defined on @xmath145 $ ] .      according to the pontryagin maximum principle ( in short , pmp ,",
    "see @xcite ) , there must exist an absolutely continuous mapping @xmath146 defined on @xmath145 $ ] ( called adjoint vector ) , such that @xmath147 ( cotangent space ) for every @xmath148 $ ] , and a real number @xmath149 , with @xmath150 , such that @xmath151 almost everywhere on @xmath145 $ ] , where @xmath152 is the hamiltonian of the optimal control problem . here",
    ", we have set @xmath153 , @xmath154 , and @xmath155 .",
    "the maximization condition of the pmp yields , almost everywhere on @xmath145 $ ] ,",
    "@xmath156 whenever @xmath157 .",
    "we call @xmath158 ( as well as its components ) the switching function . note that @xmath158 is continuous . here and throughout the paper , we denote by @xmath159 , with a slight abuse of notation",
    ".    moreover , we have the transversality condition @xmath160 , where @xmath161 is the tangent space to @xmath138 at the point @xmath162 , and , the final time @xmath139 being free and the system being autonomous , we have also @xmath163 $ ] .",
    "the quadruple @xmath164 is called an extremal lift of @xmath6 .",
    "an extremal is said to be normal ( resp . ,",
    "abnormal ) if @xmath165 ( resp . , @xmath166 ) .",
    "we say that an arc ( restriction of an extremal to a subinterval @xmath53 ) is _ regular _ if @xmath167 along @xmath53 .",
    "otherwise , the arc is said to be _",
    "singular_. note that a singular extremal may be both normal or abnormal .",
    "we will see in section [ ext_sin_chat ] that the singular extremals of the problem @xmath0 must be normal .    a _ switching time",
    "_ is a time @xmath168 at which @xmath169 , that is , both @xmath170 and @xmath171 vanish at time @xmath168 .",
    "an arc that is a concatenation of an infinite number of regular arcs is said to be _",
    "the chattering arc is associated with a _ chattering control _ that switches an infinite number of times , over a compact time interval . a junction between a regular arc and a singular arc is said to be a _",
    "singular junction_.      we next define the order of a singular control , since it is important to understand and explain the occurence of chattering .",
    "this concept is related to the way singular controls are computed , and since it is a bit technical to define , we start with a preliminary quite informal discussion . here and throughout the paper",
    ", we use the notation @xmath172 $ ] ( lie bracket of vector fields ) and @xmath173 ( poisson bracket of hamiltonian functions ) .",
    "[ [ preliminary - informal - discussion . ] ] preliminary informal discussion .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    in order to compute singular controls , the usual method is to differentiate several times the switching function , until the control appears in a nontrivial way . if @xmath174 for every @xmath175 , then @xmath176 , and , differentiating in @xmath168 , we get , using the poisson bracket , @xmath177 and @xmath178 along @xmath53 .",
    "according to the goh condition ( see @xcite , see also below ) , if the singular arc is optimal , then the goh condition @xmath179(x)\\rangle= 0 $ ] must be satisfied along @xmath53 .",
    "therefore we get that @xmath180(x)\\rangle=0 $ ] and @xmath181(x)\\rangle=0 $ ] along @xmath53 .",
    "let us now assume that the vector fields @xmath115 and @xmath116 commute , i.e. , @xmath182 = 0 $ ] . by differentiating again",
    ", we get @xmath183 if @xmath184 along @xmath53 , then @xmath185 and we say that the control @xmath186 is of _ order @xmath187 _ ( also called _ minimal order _ in @xcite ) .",
    "note that @xmath108 and @xmath109 must moreover satisfy the constraint @xmath113 .",
    "note also that , if moreover @xmath188=0 $ ] and @xmath189=0 $ ] , then yields @xmath190    now , if @xmath191 and @xmath192 along @xmath53 , then we must have @xmath193 , @xmath194 , @xmath195 according to the goh condition ( see @xcite , see also below ) , and hence we go on differentiating . assuming that @xmath196 = 0 $ ] and @xmath197 = 0 $ ] , we have @xmath198 = [ g_i , [ f , \\mathrm{ad}f.g_i ] ] = -[f,[\\mathrm{ad}f.g_i , g_i ] ] - [ \\mathrm{ad}f.g_i , [ g_i , f ] ] = 0 , \\quad i=1,2 , \\ ] ] and we get @xmath199 due to higher - order necessary conditions for optimality ( see below ) , an optimal singular control can not appear in a nontrivial way with an odd number of derivatives , therefore we must have @xmath200 and @xmath201 along @xmath53 . accordingly , @xmath202 , @xmath203 , gives the three additional constraints along the singular arc @xmath204 , @xmath205 , and @xmath206 .",
    "derivating these constraints with respect to @xmath168 , we get @xmath207 assuming that @xmath208 , @xmath203 ( generalized legendre - clebsch condition , see below ) and that @xmath209 along @xmath53 , the singular control is given by @xmath210 we say , then , that the singular control @xmath186 is of _ intrinsic order two_.    [ [ precise - definitions . ] ] precise definitions .",
    "+ + + + + + + + + + + + + + + + + + + +    now , following @xcite , let us give a precise definition of the order of a singular control .",
    "the singular control @xmath186 defined on a subinterval @xmath211 $ ] is said to be of _ order @xmath212 _ if @xmath213 @xmath214 along @xmath53 .",
    "the control @xmath215 is said to be of _ intrinsic order _",
    "@xmath212 if , moreover , the vector fields satisfy @xmath216 \\equiv 0,\\quad k=1,\\cdots,2q-2,\\quad i=1,2.\\ ] ]    the condition of a nonzero determinant guarantees that the optimal control can be computed from the @xmath217-th time derivative of the switching function .",
    "note that , in the definition , it is required that the two components of the control have the same order .",
    "we next recall the goh and generalized legendre - clebsch conditions ( see @xcite ) .",
    "it is worth noting that in @xcite , the following higher - order necessary conditions are given even when the components of the control @xmath215 have different orders .",
    "[ necconds0 ] _ ( higher - order necessary conditions ) _ assume that a singular control @xmath186 defined on @xmath53 is of order @xmath212 and is optimal . then the goh condition @xmath218 must be satisfied along @xmath53 .",
    "moreover , the matrix of which the @xmath219-th component is @xmath220 is symmetric and nonpositive along @xmath53 ( generalized legendre - clebsch condition ) .    in the problem @xmath0 , as we will see , it happens that singular controls are of intrinsic order @xmath221 , and that @xmath222 = 0 $ ] , @xmath223 = 0 $ ] , and @xmath224 = 0 $ ] , so that the conditions given in the above definition yield @xmath196 = 0 $ ] , @xmath197 = 0 $ ] , @xmath225 = 0 $ ] , @xmath226 = 0 $ ] , @xmath227(x ) \\rangle \\neq 0 $ ] , @xmath228(x ) \\rangle \\neq 0 $ ] , and @xmath229(x ) \\rangle \\langle p ,   [ g_2,\\mathrm{ad}^3 f.g_2 ] ( x ) \\rangle   - \\langle p ,   [ g_2,\\mathrm{ad}^3 f.g_1 ] ( x ) \\rangle \\langle p ,   [ g_1,\\mathrm{ad}^3 f.g_2 ] ( x ) \\rangle \\neq 0,\\ ] ] and we have the following higher - order necessary conditions , that will be used in the study of the problem @xmath0 .    [ necconds ] we assume that the optimal trajectory @xmath6 contains a singular arc , defined on the subinterval @xmath53 of @xmath145 $ ] , associated with a control @xmath186 of intrinsic order @xmath221 . if the vector fields satisfy @xmath182 = 0 $ ] , @xmath230   = 0 $ ] , for @xmath194 , then the goh condition @xmath231 ( x(t ) ) \\rangle = 0 ,",
    "\\quad \\langle p(t ) , [ g_1,\\mathrm{ad}^2 f.g_2 ] ( x(t ) ) \\rangle = \\langle p(t ) , [ g_2,\\mathrm{ad}^2 f.g_1 ] ( x(t ) ) \\rangle = 0,\\ ] ] and the generalized legendre - clebsch condition ( in short , glcc ) @xmath232(x(t))\\rangle { \\leqslant}0 , \\quad i=1,2,\\ ] ] @xmath233(x(t))\\rangle = \\langle p(t),[g_2,\\mathrm{ad}^3f.g_1](x(t))\\rangle\\ ] ] must be satisfied along @xmath53 .",
    "moreover , we say that the strengthened glcc is satisfied if we have a strict inequality above , that is , @xmath234(x(t))\\rangle < 0 $ ] .",
    "corollary [ necconds ] follows from lemma [ necconds0 ] and from the arguments developed in the previous informal discussion .",
    "it will be used in section [ ext_sin_chat ] .",
    "we next investigate the singular junctions for the problem , and the chattering phenomenon .",
    "one can find in @xcite some results on the junction between an optimal regular arc and an optimal singular arc , for single - control affine systems , among which a result stating that , if the singular arc is of even order and if the control is discontinuous at the junction , then the junction must be nonanalytical ( meaning that the control is not piecewise analytic in any neighborhood of the junction ) . in @xcite , it is proved that such a nonanalytical junction between a regular arc and a singular arc of intrinsic order two causes chattering ( see also @xcite ) . when the control takes values in the unit disk , explicit analytic expressions for some optimal trajectories of linear - quadratic problems were given , e.g. , in @xcite .",
    "however these results can not be applied to @xmath0 because the control system is bi - input and the cost functional is the time ; they are anyway a good source of inspiration to establish the results of that section .",
    "the following result is valid for general bi - input control - affine systems .    [ theorem_chattering ]",
    "consider the optimal control problem .",
    "let @xmath164 be an optimal extremal lift on @xmath145 $ ] .",
    "we assume that @xmath215 is singular of order two along an open interval @xmath211 $ ] , and we denote this control by @xmath235 .",
    "we assume that @xmath236 ( i.e. , the singular control does not saturate the constraint ) and that @xmath237 along @xmath53 .",
    "then the optimal control @xmath215 must switch infinitely many times at the junction with the singular arc .",
    "in other words , there is a chattering phenomenon , which is due to the connection of a regular arc with a singular arc of higher - order .",
    "since the singular control is of order two , it follows from the definition that @xmath238 thus , we get from @xmath239 and lemma [ necconds0 ] that @xmath240 and @xmath241 along the singular arc @xmath53 . by assumption , we have @xmath242 , and hence we can write @xmath243 with @xmath244 .    without loss of generality , we consider a concatenation of a singular arc with a regular arc at time @xmath245 .",
    "assume that for some @xmath246 the control u is singular along @xmath247 , and that , along @xmath248 , the control @xmath186 is given by @xmath249 , @xmath250 .",
    "it can be easily seen from the assumption that @xmath251 that there exists at least one component of the singular control that is smaller than the same component of the regular control , i.e. , @xmath252 for @xmath253 or @xmath254 .",
    "then , it follows that @xmath255 hence the switching function @xmath256 has a local maximum at @xmath257 and is nonpositive along the interval @xmath248 .",
    "it follows from the maximization property of the hamiltonian that @xmath258 .",
    "this is a contradiction .",
    "if , instead , we assume @xmath259 , @xmath250 over @xmath248 , then there must exists a control component @xmath260 that is larger than @xmath260 , i.e. , @xmath261 , and then we obtain @xmath262 , which yields @xmath263 and thus a contradiction . then",
    ", if we assume @xmath264 and @xmath265 , @xmath194 , @xmath266 , we will have either @xmath267 which gives a contradiction with the sign of @xmath268 , or @xmath269 and @xmath270 which gives a contradiction with the sign of @xmath271 .",
    "a similar reasoning can be done for regular - singular type concatenations .",
    "recall that the extremal is said singular if @xmath272 , @xmath175 .",
    "thus , the obtained contradiction indicates that the concatenation of a singular arc with a regular arc violates the pmp and thus there exists a chattering arc when trying to connect a regular arc with a singular arc .",
    "note that , in this result , we have assumed that @xmath273 . in the ( nongeneric ) case where the singular control saturates the constraint , in order to get the same result",
    "we need to assume that the strengthened glcc is satisfied at the junction point , i.e. , @xmath274 , and the control is discontinuous at the singular junction .",
    "in addition , we have assumed that @xmath237 . actually , if @xmath275 , then singular and regular extremals can be connected without chattering .",
    "for example , gives @xmath276 where @xmath277 , @xmath278 , @xmath279 .",
    "in contrast to the previous reasoning , now the fact that @xmath280 does not raise any more a contradiction .    in the next section , we analyze the regular , singular and chattering extremals for the problem @xmath0 by using the results presented previously .",
    "in this section , we classify the switching points by their contact with the switching surface , and we establish that the optimal singular arcs of the @xmath0 , if they exist , cause chattering .      [ [ normal - extremals . ] ] normal extremals .",
    "+ + + + + + + + + + + + + + + + +    here , we consider normal extremals and we take @xmath281 .",
    "let us consider the system , with the vector fields @xmath114 , @xmath115 and @xmath116 defined by . denoting the adjoint vector by @xmath282 , the adjoint equations given by the pmp are @xmath283 with the transversality condition @xmath284 the switching function is @xmath285 and is of class @xmath286 .",
    "the switching manifold @xmath287 is the submanifold of @xmath288 of codimension two defined by @xmath289 let us fix an arbitrary reference regular extremal @xmath290 of the problem @xmath0 .",
    "if @xmath291 never meets @xmath287 , then the extremal control is given by along the whole extremal .",
    "if it meets @xmath287 then there is a singularity to be analyzed .",
    "it is not even clear if the extremal flow is well defined when crossing such a point ( we could lose uniqueness ) .",
    "let us assume that the extremal @xmath291 meets @xmath287 at some time @xmath292 , and we set @xmath293 .",
    "following @xcite , we classify the regular extremals by their contact with the switching surface , i.e. , if @xmath294 and @xmath295 for some @xmath296 , then the point @xmath297 is said to be a _ point of order @xmath298_. without loss of generality , we assume that @xmath299 .",
    "let us analyze the singularity occuring at points of order @xmath187 , @xmath221 , @xmath300 and @xmath301 for the problem @xmath0 .",
    "[ [ points - of - order-1 . ] ] points of order @xmath187 .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    [ lem_pointorder1 ] we assume that @xmath297 is of order @xmath187 . then the reference extremal is well defined in a neighborhood of @xmath302 , in the sense that there exists a unique extremal associated with the control @xmath186 passing through the point @xmath297 .",
    "the control turns with an angle @xmath303 when passing through the switching surface @xmath287 , and is locally given by @xmath304 with @xmath305 , @xmath306 .    in the problem @xmath0 , the vector fields @xmath115 and @xmath116 ( defined by ) commute , i.e. , @xmath182 = 0 $ ] . by derivating the switching function , we get @xmath307 and @xmath308 along the extremal , and then , since the point is of order @xmath187 , we have , locally , @xmath309 and @xmath310 , with @xmath311 , and we also have @xmath312 , @xmath313 , @xmath314 .",
    "the expression of the optimal control in the lemma follows . at the crossing point ,",
    "both control components change their sign , i.e. , @xmath315 , @xmath203 , which means that the control direction turns with an angle @xmath303 when crossing @xmath287 .",
    "[ [ points - of - order-2 . ] ] points of order 2 .",
    "+ + + + + + + + + + + + + + + + + +    [ lem_points2 ] we assume that @xmath297 is of order @xmath221 . then the reference extremal is well defined in a neighborhood of @xmath302 , in the sense that there exists a unique extremal associated with the control @xmath186 passing through the point @xmath297 .",
    "moreover , the switching function is of class @xmath316 in the neighborhood of @xmath302 , the control is of class @xmath316 , and we have @xmath317 with @xmath318 and @xmath319 .    the vector fields @xmath114 , @xmath115 and @xmath116 , defined by , are such that @xmath230 = 0 $ ] , for @xmath194 ( see lemma [ lieconfig ] ) .",
    "then , according to the calculations done in section [ sec32 ] , we have @xmath320 and @xmath321 , and hence the functions @xmath322 , @xmath203 are of class @xmath323 at @xmath324 . locally , we have @xmath325 and @xmath326 .",
    "the expression of the optimal control follows and the control is continuous .    differentiating again the switching function , we have @xmath327 and @xmath328 , because @xmath329 ] = 0 $ ] , for @xmath203 ( see lemma [ lieconfig ] ) .",
    "since the control is continuous , the switching function is at least of class @xmath330 at @xmath324 .",
    "hence , locally we can write @xmath331 and @xmath332 , where @xmath333 for @xmath194 and @xmath266 .",
    "we infer that the control is at least of class @xmath286 at @xmath324 , with @xmath334 and @xmath335 .",
    "we get the smoothness by an immediate induction argument : for @xmath336 , assuming that the switching function is of class @xmath337 and that the control is of class @xmath338 , then the @xmath339-th time derivative of the switching function can be written as @xmath340 , where @xmath341 , @xmath203 are terms involving time derivatives of the control of order lower than @xmath342 .",
    "hence the switching function is of class @xmath343 since @xmath215 is of class @xmath338 , and @xmath344 where all coefficients can be computed explicitly .",
    "the @xmath345-th time derivative of the control can be computed using the coefficients @xmath346 , @xmath347 , and hence the control is of class @xmath348 .",
    "the result follows .",
    "[ [ points - of - order-3 . ] ] points of order 3 .",
    "+ + + + + + + + + + + + + + + + + +    [ lem_pointorder3 ] we assume that @xmath297 is of order @xmath300 . then the reference extremal is well defined in a neighborhood of @xmath302 , in the sense that there exists a unique extremal associated with the control @xmath186 passing through the point @xmath297 .",
    "if @xmath349 and @xmath350 , then the switching function is of class @xmath323 in the neighborhood of @xmath302 and the control is discontinuous when passing through the switching surface @xmath287 locally , and we have @xmath351 where , setting @xmath352 and @xmath353 , @xmath354    using and , we have @xmath355 and @xmath356 ( see also lemma [ lieconfig ] ) . assuming that we have locally @xmath357 , we infer that @xmath358 . by substituting the control into the expression of @xmath359 ,",
    "we get @xmath360 and @xmath361 .",
    "the result follows by solving for @xmath362 and @xmath363 .    if @xmath364 , then the switching function is of class @xmath330 at @xmath324 and the control turns with an angle @xmath303 when passing through the switching surface @xmath287 .",
    "[ [ points - of - order-4 . ] ] points of order @xmath301 .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we assume that @xmath297 is of order @xmath301 .",
    "if @xmath365 , then @xmath366 and @xmath367 , where @xmath368 , @xmath369 .",
    "we have @xmath370 and @xmath371 .",
    "if moreover @xmath372 , which indicates that the control @xmath373 can be a regular control according to the value of @xmath374 , @xmath203 , at time @xmath324 , we get that @xmath375 , @xmath376 and @xmath377 .",
    "then @xmath378 if @xmath379 then the extremal is well defined in a neighborhood of @xmath302 and the control is continuous when passing the switching surface @xmath287 .    if @xmath380 , then @xmath381 , @xmath382 , @xmath383 and @xmath384 ( see the proof of lemma [ lem_singulararcs ] further ) , and we have @xmath385 and @xmath386 . assuming that we have locally @xmath387 ( we identify @xmath388 for convenience ) , with @xmath389 , we get @xmath390 and @xmath391 which leads to @xmath392 and @xmath393 .",
    "it follows that @xmath394 with @xmath395 if @xmath396 , and @xmath397 if @xmath398 .",
    "it is clear that the uniqueness of the extremal when crossing the point @xmath297 does not hold true anymore .",
    "the switching function @xmath399 converges to @xmath400 when @xmath401 , while the control switches infinitely many times when @xmath401 .",
    "indeed , we will see further that this situation is related the chattering phenomenon .",
    "[ [ abnormal - extremals . ] ] abnormal extremals .",
    "+ + + + + + + + + + + + + + + + + + +    abnormal extremals correspond to @xmath402 in the pmp .",
    "we suspect the existence of optimal abnormal extremals in the problem @xmath0 for certain ( nongeneric ) terminal conditions . in the planar version of the problem @xmath0 studied in @xcite ,",
    "if the optimal control switches at least two times then there is no abnormal minimizer .",
    "we expect that the same property is still true here .",
    "we are able to prove that the singular extremals of the problem @xmath0 are normal ( see section [ ext_sin_chat ] ) , however , we are not able to establish a clear relationship between the number of switchings and the existence of abnormal minimizers as in @xcite .",
    "thus , in our numerical simulations further , we will assume that there is at least one normal extremal for problem @xmath0 and compute it .",
    "note moreover that lemmas [ lem_pointorder1 ] , [ lem_points2 ] and [ lem_pointorder3 ] are also valid for abnormal extremals .",
    "let us compute the singular arcs of the problem @xmath0 .",
    "according to @xcite , the singular trajectories are feedback invariants since they correspond to the singularities of the end - point mapping .",
    "this concept is related to the feedback group induced by the feedback transformation and the corresponding control systems are said to be feedback equivalent ( see ( * ? ? ?",
    "* section 4 ) for details ) . recall that , equivalently ,",
    "a trajectory @xmath6 associated with a control @xmath215 is said to be singular if the differential of the end - point mapping is not of full rank .",
    "the end - point mapping @xmath403 is defined as by @xmath404 where @xmath405 is the trajectory solution of the control system associated to @xmath215 such that @xmath406 .",
    "hence , we can replace the vector fields @xmath115 and @xmath116 with @xmath407 and @xmath408 .",
    "let us make precise the lie bracket configuration of the control system associated with the vector fields @xmath114 , @xmath409 and @xmath410 .    [ lieconfig ] we have @xmath411=0 , \\ ] ] @xmath412 @xmath413 @xmath414 @xmath415 @xmath416 = [ \\widetilde{g}_1,\\mathrm{ad}f .",
    "\\widetilde{g}_2 ] = [ \\widetilde{g}_2,\\mathrm{ad}f .",
    "\\widetilde{g}_1 ] = [ \\widetilde{g}_2,\\mathrm{ad}f .",
    "\\widetilde{g}_2 ] = 0,\\ ] ] @xmath417 @xmath418 @xmath419",
    "= [ \\widetilde{g}_2,\\mathrm{ad}^2 f. \\widetilde{g}_2]=0 , \\qquad   [ \\widetilde{g}_1,\\mathrm{ad}^2 f. \\widetilde{g}_2 ] = - [ \\widetilde{g}_2,\\mathrm{ad}^2 f. \\widetilde{g}_1]= \\frac{\\partial}{\\partial \\phi},\\ ] ] @xmath420 @xmath421 @xmath422 = -a \\cos \\psi \\sin \\theta \\frac{\\partial}{\\partial v_x}+ a \\sin \\psi \\frac{\\partial}{\\partial v_y } -a \\cos\\psi \\cos \\theta \\frac{\\partial}{\\partial v_z } -(\\omega_x \\sin \\phi)/\\cos",
    "\\psi \\frac{\\partial}{\\partial \\theta}\\\\ - \\omega_x \\cos \\phi \\frac{\\partial}{\\partial \\psi } -\\omega_x \\sin \\phi \\tan \\psi \\frac{\\partial}{\\partial \\phi},\\end{gathered}\\ ] ] @xmath423 = -2 a \\omega_y ( \\cos \\theta \\sin \\phi - \\cos \\phi \\sin \\psi \\sin \\theta ) \\frac{\\partial}{\\partial v_x}+ 2 a \\omega_y \\cos \\phi \\cos \\psi \\frac{\\partial}{\\partial v_y } \\\\",
    "+ 2a\\omega_y(\\sin \\phi \\sin \\theta + \\cos \\phi \\cos \\theta \\sin \\psi ) \\frac{\\partial}{\\partial v_z}+ ( - \\omega_x^2 - 3\\omega_y^2 ) \\frac{\\partial}{\\partial \\phi},\\end{gathered}\\ ] ] @xmath424 = -2 a \\omega_x(\\cos \\phi \\cos \\theta + \\sin \\phi \\sin \\psi \\sin \\theta)\\frac{\\partial}{\\partial v_x }",
    "-2 a \\omega_x \\cos \\psi \\sin \\phi \\frac{\\partial}{\\partial v_y } \\\\",
    "+ 2a\\omega_x(\\cos \\phi \\sin \\theta - \\cos \\theta",
    "\\sin \\phi \\sin \\psi)\\frac{\\partial}{\\partial v_z}+(3\\omega_x^2 + \\omega_y^2 ) \\frac{\\partial}{\\partial \\phi},\\end{gathered}\\ ] ] @xmath425 = -a \\cos \\psi \\sin \\theta \\frac{\\partial}{\\partial v_x}+a\\sin \\psi \\frac{\\partial}{\\partial v_y } -a\\cos \\psi \\cos \\theta \\frac{\\partial}{\\partial v_z } -(\\omega_y \\cos \\phi)/\\cos \\psi \\frac{\\partial}{\\partial \\theta}\\\\ + \\omega_y \\sin \\phi \\frac{\\partial}{\\partial \\psi}-\\omega_y \\cos \\phi \\tan \\psi \\frac{\\partial}{\\partial \\phi},\\end{gathered}\\ ] ] where @xmath426 and @xmath427 .",
    "moreover , we have @xmath428    [ lem_singulararcs ] in the problem @xmath0 , let us assume that @xmath164 is a singular arc along the subinterval @xmath53 , which is locally optimal in @xmath1 topology .",
    "then we have @xmath429 along @xmath53 , and @xmath215 is a singular control of intrinsic order two . moreover , the extremal must be normal , i.e. , @xmath430 , and the glcc @xmath431 must hold along @xmath53 .",
    "using lemma [ lieconfig ] , we infer from @xmath432 and @xmath433 that @xmath434 and from @xmath435 , that @xmath436 along the interval @xmath53 . since @xmath437 , the six equations in - are independent constraints along the singular arc . therefore ,",
    "writing @xmath438 , we get from theorem [ necconds ] that @xmath439 \\rangle = & p_{\\phi } = 0 ,      \\qquad      \\langle",
    "p,[\\widetilde{g}_2 , \\mathrm{ad}^2f.\\widetilde{g}_1(x ) ] \\rangle = -p_{\\phi }   = 0,\\\\      \\langle p , \\mathrm{ad}^3f.\\widetilde{g}_1(x)\\rangle= & p_{\\theta } \\omega_x \\omega_1 /\\cos \\psi                                                -p_{\\psi}\\omega_x \\omega_2                                               + p_{\\phi } \\omega_x \\tan \\psi \\omega_1                                                -p_{v_x } a \\omega_y",
    "\\cos \\psi \\sin \\theta \\\\                                               &                                                    + p_{v_y } a \\omega_y \\sin \\psi                                                  -p_{v_z } a \\omega_y \\cos \\psi",
    "\\cos \\theta=0,\\\\      \\langle p,\\mathrm{ad}^3f.\\widetilde{g}_2(x)\\rangle= & -p_{\\theta } \\omega_y \\omega_1 /\\cos",
    "\\psi                                               + p_{\\psi}\\omega_x \\omega_2                                              -p_{\\phi } \\omega_x \\tan \\psi \\omega_1                                               -p_{v_x } a \\omega_x \\cos \\psi \\sin \\theta\\\\                                              &                                                 + p_{v_y } a \\omega_x \\sin \\psi                                                 -p_{v_z } a \\omega_x \\cos",
    "\\psi \\cos \\theta=0,\\\\ \\end{split}\\ ] ] these four constraints are dependent : they reduce to two functionally independent constraints . hence ,",
    "with - , we have @xmath440 independent constraints along @xmath53 .",
    "now , we infer from -- that @xmath441 and @xmath442 along @xmath53 .",
    "derivating @xmath443 and @xmath444 , we get @xmath445 and derivating again , that @xmath446 .",
    "it follows that @xmath447 . using that @xmath448 along any extremal , we get @xmath449 substituting and into @xmath450 and @xmath451 , we get @xmath452(x)\\rangle = \\langle p , [ \\widetilde{g}_2 , \\mathrm{ad}^3f.\\widetilde{g}_1 ] ( x)\\rangle = 0,\\\\      & \\langle p , [ \\widetilde{g}_1 , \\mathrm{ad}^3f.\\widetilde{g}_1 ] ( x)\\rangle = \\langle p , [ \\widetilde{g}_2 , \\mathrm{ad}^3f.\\widetilde{g}_2 ] ( x)\\rangle = -\\frac{a p_{v_z}}{\\cos \\psi \\cos \\theta}. \\end{split}\\ ] ] to prove that @xmath215 is of intrinsic order two , it suffices to prove that @xmath453(x)\\rangle \\neq 0 $ ] along @xmath53 . we prove it by contradiction . if @xmath453(x)\\rangle = 0 $ ] , then necessarily @xmath454 and this would lead to @xmath455 .",
    "it follows then from @xmath448 that @xmath402 .",
    "we have obtained that @xmath456 , which is a contradiction .    the fact that @xmath429 simply follows from the fact that @xmath457    besides , if @xmath402 , then @xmath454 and @xmath455 , which leads to @xmath456 and thus to a contradiction as well .",
    "therefore , @xmath458 ( i.e. , the singular arc is normal ) , and then follows by applying the glcc of corollary [ necconds ] .",
    "we define the singular surface @xmath459 , which is filled by singular extremals of the problem @xmath0 , by @xmath460 we will see , in the next section , that the solutions of the problem of order zero ( defined in section [ pb_auxi ] ) live in this singular surface @xmath459 .",
    "the following result , establishing chattering for the problem @xmath0 , is a consequence of theorem [ theorem_chattering ] , lemma [ lieconfig ] and lemma [ lem_singulararcs ] .    [ cor_chattering ] for the problem @xmath0 ,",
    "any optimal singular arc can not be connected with a nontrivial bang arc .",
    "there is a chattering arc when trying to connect a regular arc with an optimal singular arc .",
    "more precisely , let @xmath215 be an optimal control , solution of @xmath0 , and assume that @xmath215 is singular on the sub - interval @xmath461 $ ] and is regular elsewhere . if @xmath462 ( resp .",
    ", if @xmath463 ) then , for every @xmath464 , the control @xmath215 switches an infinite number of times over the time interval @xmath465 $ ] ( resp .",
    ", on @xmath466 $ ] ) .",
    "this result is important for solving the problem @xmath0 in practice . indeed , when using numerical methods to solve the problem , the chattering control is an obstacle to convergence , especially when using an indirect approach ( shooting ) .",
    "the existence of the chattering phenomenon in the problem @xmath0 explains well why the indirect methods may fail for certain terminal conditions .",
    "note that , in the planar version of the problem @xmath0 studied in @xcite ) , one can give sufficient conditions on the initial conditions under which the chattering phenomenon does not occur .",
    "unfortunately , we are not able to derive such conditions in the general problem @xmath0 .",
    "in this section , we design two different numerical strategies for solving the problem @xmath0 : one is based on combining indirect methods with numerical continuation , and the other is based on a direct transcription approach .",
    "the first one may be successfully implemented when dealing with solutions without chattering arcs , and the second one is more appropriate to compute solutions involving chattering arcs .",
    "however , both approaches are difficult to initialize successfully because the problem @xmath0 is of quite high dimension , is highly nonlinear , and moreover , as a main reason , the system consists of fast ( euler angles and angular velocity ) and slow ( orbit velocity ) dynamics at the same time .",
    "the occurrence of chattering arcs is an obstacle to convergence . especially for indirect methods",
    ", the chattering phenomenon raises an important difficulty due to the numerical integration of the discontinuous hamiltonian system .",
    "direct transcription approaches provide a sub - optimal solution of the problem that has a finite number of switchings based on a ( possibly rough ) discretization .",
    "actually , in case of chattering , we are also able to provide a sub - optimal solution with our indirect approach , by stopping the continuation before it would fail due to chattering . though the sub - optimal solutions provided in this way may be  less optimal \" compared with those given by a direct approach , in practice they can be computed in a much faster way and also much more accurately .",
    "the idea of this continuation procedure is to use the ( easily computable ) solution of a simpler problem , that we call herefter the _ problem of order zero _ , in order then to initialize an indirect method for the more complicated problem @xmath0 .",
    "then we are going to plug this simple , low - dimensional problem in higher dimension , and then come back to the initial problem by using appropriate continuations .",
    "this method actually gives an optimal solution with high accuracy .",
    "the problem of order zero defined below is used as the starting problem because the orbit movement is much slower compared with the attitude movement and it is easy to solve explicitly . as well , it is worth noting that the solution of the problem of order zero is contained in the singular surface @xmath459 filled by the singular solutions for the problem @xmath0 , defined by .",
    "[ [ problem - of - order - zero . ] ] problem of order zero .",
    "+ + + + + + + + + + + + + + + + + + + + + +    we define the _ problem of order zero _ , denoted by @xmath467 , as a `` subproblem '' of the complete problem @xmath0 , in the sense that we consider only the orbit dynamics and that we assume that the attitude angles ( euler angles ) can be driven to the target values instantaneously .",
    "thus , the attitude angles are considered as control inputs in that simpler problem . denoting the rocket axial symmetric axis as @xmath24 and considering it as the control vector (",
    "which is consistent with the attitude angles @xmath45 , @xmath46 ) , we formulate the problem as follows : @xmath468 where @xmath469 is a given vector that refers to the desired target velocity direction .",
    "this problem is easy to solve , and the solution is the following .",
    "[ ocpz_solution ] the optimal solution of @xmath467 is given by @xmath470 with @xmath471 , @xmath472 , @xmath473 , and @xmath474 .",
    "the hamiltonian is @xmath475 , and we have @xmath476 , with @xmath477 , and @xmath448 along any extremal .",
    "it follows that @xmath478 ( indeed otherwise we would get also @xmath402 , and thus a contradiction ) . hence there are no singular controls for this problem .",
    "the maximization condition of the pmp yields @xmath479 , and hence the optimal control is a constant vector .",
    "moreover , according to the final condition @xmath480 , the transversality condition is @xmath481 , hence @xmath482 , and using @xmath483 we get that @xmath484 .",
    "it follows from the transversality condition that @xmath485 .",
    "the expression of @xmath139 follows , using that @xmath486 . using that @xmath448 ,",
    "we get @xmath487 .    since the vector @xmath24 is expressed in the launch frame as @xmath488 , the euler angles @xmath489 and @xmath490 are given by @xmath491 where @xmath492 is the @xmath25-th component of @xmath493 , for @xmath494 .    using the definition of the singular surface @xmath459",
    ", we check that the optimal solution of @xmath467 is contained in @xmath459 with @xmath495 , @xmath496 and @xmath497 ( @xmath498 is any real number ) .",
    "therefore , the relationship between @xmath467 and @xmath0 is the following .",
    "[ lem_relationship ] the optimal solution of the problem @xmath467 actually corresponds to a singular solution of @xmath0 with the terminal conditions given by @xmath499 @xmath500 @xmath501    due to this result , a natural idea of numerical continuation strategy consists of deforming continuously ( step by step ) the terminal conditions given in lemma [ lem_relationship ] , to the terminal conditions - of the problem @xmath0 .    however ,",
    "because of the chattering phenomenon , we can not make converge the shooting method in such a strategy . more precisely , when the terminal conditions are in the neighborhood of the singular surface @xmath459 , the optimal extremals are likely to contain a singular arc ( and thus chattering arcs ) . in that case , the shooting method will certainly fail due to the difficulty of numerical integration of discontinuous hamiltonian system . hence , we introduce hereafter an additional numerical trick and we define the following regularized problem , in which we modify the cost functional with a parameter @xmath502 , so as to overcome the problem caused by chattering .",
    "[ [ regularized - problem . ] ] regularized problem .",
    "+ + + + + + + + + + + + + + + + + + + +    let @xmath503 be arbitrary .",
    "the regularized problem @xmath504  consists of minimizing the cost functional @xmath505 for the bi - input control - affine system , under the control constraints @xmath506 , @xmath203 , with terminal conditions - .",
    "note that , here , we replace the constraint @xmath507 ( i.e. , @xmath215 takes its values in the unit euclidean disk ) with the constraint that @xmath215 takes its values in the unit euclidean square .",
    "the advantage , for this intermediate optimal control problem with the cost , is that the extremal controls are then continuous .",
    "the hamiltonian is @xmath508 and according to the pmp , the optimal controls are @xmath509 where the saturation operator @xmath510 is defined by @xmath511 if @xmath512 ; @xmath187 if @xmath513 ; and @xmath514 if @xmath515 .    as mentioned previously , one of the motivations for considering the intermediate problem @xmath504  is that the solution of @xmath467 is a _ singular _ trajectory of the full problem @xmath0 , and hence , passing directly from @xmath467 to @xmath0 causes difficulties due to chattering ( see corollary [ cor_chattering ] ) .",
    "the following result shows that when we embed the solutions of @xmath467 into the problem @xmath504  , they are not singular .",
    "[ lem_relat_ocpzetocpr ] an extremal of @xmath467 can be embedded into the problem @xmath504  by setting @xmath516 @xmath517 where @xmath518 and @xmath519 are given by , with terminal conditions given by and - .",
    "moreover , it is not a singular extremal for the problem @xmath504  .",
    "the extremal equations for @xmath504  are the same than for @xmath0 , as well as the transversality conditions .",
    "it is easy to verify that the embedded extremal is an extremal of the problem @xmath504  and that the transversality conditions are the same .",
    "the control is computed from which maximizes the hamiltonian @xmath520 , and we have @xmath521 with @xmath522 .",
    "it follows from the pmp that the extremal equations are the same than for @xmath0 .",
    "then , for the problem @xmath504  , we have @xmath523 .",
    "note that , in this case , the control @xmath268 , @xmath203 is singular if @xmath524 .",
    "hence there is no normal singular extremal for the problem @xmath504  . from lemma [ ocpz_solution ] , it is easy to see that @xmath430 and thus the extremals of @xmath467 are not singular extremals of @xmath504  .      [",
    "[ continuation - procedure . ] ] continuation procedure .",
    "+ + + + + + + + + + + + + + + + + + + + + + +    the ultimate objective is to compute the optimal solution of the problem @xmath0 , starting from the explicit , simple to compute , solution of @xmath467 .",
    "we proceed as follows :    * first , according to lemma [ lem_relat_ocpzetocpr ] , we embed the solution of @xmath467 into @xmath504  . for convenience , we still denote by @xmath467 the problem @xmath467 seen in high dimension . *",
    "then , we pass from @xmath467 to @xmath0 by means of a numerical continuation procedure , involving three continuation parameters : the first two parameters @xmath525 and @xmath526 are used to pass continuously from the optimal solution of @xmath467 to the optimal solution of the regularized problem @xmath504  , for some fixed @xmath527 , and the third parameter @xmath528 is then used to pass to the optimal solution of @xmath0 ( see figure [ homotopie ] ) .",
    "the parameter @xmath525 is used to act , by continuation , on the initial conditions , according to @xmath529 @xmath530 where @xmath531 , @xmath532 , and @xmath533 , @xmath534 are calculated through equation .    using the transversality condition and the extremal equations @xmath535 , @xmath536 and @xmath537 ,",
    "the unknown @xmath538 can be expressed in terms of @xmath539 and @xmath540 as @xmath541 and hence the unknowns of the shooting problem are reduced to @xmath539 , @xmath540 , @xmath542 , @xmath543 , @xmath544 , @xmath545 , @xmath546 and @xmath139 .",
    "the shooting function @xmath547 for the @xmath525-continuation is defined by @xmath548 where @xmath549 with @xmath522 is calculated from and @xmath108 and @xmath109 are given by .",
    "in fact , from lemma [ lem_singulararcs ] , we know that a singular extremal of problem @xmath0 must be normal , and since we are starting to solve the problem from a singular extremal , here we assume that @xmath281 .",
    "note that we can use @xmath550 as shooting function thanks for @xmath504  . for problem",
    "@xmath0 , if @xmath551 , then together with @xmath552 and @xmath553 , the final point @xmath554 of the extremal is then lying on the singular surface @xmath459 defined by and this will cause the fail of the shooting .",
    "however , for problem @xmath504  , even when @xmath555 , the shooting problem can still be solved .",
    "initializing with the solution of @xmath467 , we can solve this shooting problem with @xmath556 , and we get a solution of @xmath504  with the terminal conditions - ( the other states at @xmath139 being free ) .",
    "then , by continuation , we make @xmath525 vary from @xmath324 to @xmath187 , and in this way we get the solution of @xmath504  for @xmath557 . with this solution",
    ", we can integrate extremal equations and to get the values of the state variable at @xmath139 . then denote @xmath558 , @xmath559 , @xmath560 , @xmath561 and @xmath562 .    in a second step ,",
    "we use the continuation parameter @xmath526 to act on the final conditions , in order to make them pass from the values @xmath563 , @xmath564 , @xmath565 , @xmath566 and @xmath567 , to the desired target values @xmath126 ,",
    "@xmath127 , @xmath128 , @xmath568 and @xmath569 .",
    "the shooting function is @xmath570 solving this problem by making vary @xmath526 from @xmath324 to @xmath187 , we obtain the solution of @xmath504  with the terminal conditions - .",
    "finally , in order to compute the solution of @xmath0 , we use the continuation parameter @xmath528 to pass from @xmath504  to @xmath0 .",
    "we add the parameter @xmath528 to the hamiltonian @xmath520 and to the cost functional as follows : @xmath571 @xmath572 then , according to the pmp , the extremal controls are given by @xmath573 , @xmath203 , where @xmath574 the shooting function @xmath575 is defined as @xmath576 , replacing @xmath549 with @xmath577 .",
    "the solution of @xmath0 is then obtained by making vary @xmath528 continuously from @xmath324 to @xmath187 .",
    "[ rem_subopti ] note that the above continuation procedure fails in case of chattering ( see corollary [ cor_chattering ] ) , and thus can not be successful for any possible choice of terminal conditions . in particular , if chattering occurs then the @xmath528-continuation is expected to fail for some value @xmath578 .",
    "but in that case , with this value of @xmath528 , we have generated a sub - optimal solution of the problem @xmath0 , which appears to be acceptable and very interesting for practice .",
    "moreover , the overall procedure is very fast and accurate .",
    "note that the resulting sub - optimal control is continuous .",
    "we now propose a direct approach for solving the problem @xmath0 , where the control is approximated by a piecewise constant control over a given time subdivision .",
    "the solutions derived from such a method are therefore sub - optimal , in particular when the control is chattering ( and in such a case the number of switchings is limited by the time step ) .",
    "note that this approach is much more computationally demanding than the indirect one .",
    "since the initialization of a direct method may also raise some difficulties , we propose the following strategy .",
    "the idea is to start from the solution of the problem @xmath0 with less terminal requirements , which is easy to obtain with a direct method , and then we introduce step by step the final conditions of the problem @xmath0 .",
    "we implement this direct approach with the software ` bocop ` and its batch optimization option ( see @xcite ) .    * step 1 : we solve the problem @xmath0 with initial conditions and final conditions @xmath579 these final conditions are the ones of the planar version of @xmath0 in which the motion of the spacecraft is 2d ( see @xcite for details ) .",
    "numerical simulations show that , with such terminal conditions , the problem @xmath0 is easy and fast to solve by means of a direct method ( a constant initial guess for the discretized variables suffices to ensure convergence ) .",
    "* then , in steps 2 , 3 , 4 and 5 , we add successively ( and step by step ) the final conditions @xmath580 , @xmath581 , @xmath582 , and @xmath583 , and for each new step we use the solution of the previous one as an initial guess .    at the end of this process , we have obtained the solution of the full problem @xmath0 .",
    "note again that this direct approach is much slower than the indirect one , and that the resulting control has many numerical oscillations ( see numerical results in section [ c_ca ] ) .",
    "the structure of the rocket is presented in figure [ thrust ] ( b ) .",
    "we assume that the thrust @xmath53 is flexible , i.e. , it can turn @xmath584 in all directions , and its thrust is around @xmath585 kn .",
    "the other thrusts are fixed with a total thrust @xmath586 kn .",
    "the rocket mass is @xmath587 t , the length of the rocket is @xmath588 m and its radius is @xmath589 m. considering the rocket as a cylinder , we have @xmath590 and @xmath591 . the parameters @xmath592 and @xmath593 in and are therefore @xmath594 and @xmath595 .    during the atmospheric ascent phase , the velocity of the rocket remains between several hundreds m / s and around 1000 m / s .",
    "let @xmath596 be the modulus of the velocity , and let @xmath597 and @xmath598 be the flight path angles that we use to calculate the components of the velocity in @xmath48 frame , i.e. , @xmath599 , @xmath600 and @xmath601 . in this section , the initial values of the angles @xmath602 and",
    "@xmath597 are chosen equal to the initial values of the angles @xmath45 and @xmath46 .",
    "this means that , before the maneuver , the rocket is on a trajectory with angle of attack equal to zero .    in the numerical simulations , we set @xmath603 , @xmath604 , @xmath605 and",
    "take the other values needed in the initial condition and the final condition in the following table    [ h ]     |l | l| l| l| l| l| l| l| l| l| +   +   +   +   +   +    note that @xmath606 is the module of velocity at time @xmath324 . in the next two subsections",
    ", we will choose different values of @xmath606 , and so here we do not assign to it a specific value .",
    "moreover , we set @xmath607 as the weight of the @xmath608-norm control term in the cost functional of problem @xmath504  .",
    "the indirect method combined with numerical continuation described in section [ c_ic ] is implemented using a predictor - corrector continuation method , where the prediction is made thanks to a lagrange polynomial .",
    "the ` fortran ` routines ` hybrd.f ` ( see @xcite ) and ` dop853.f ` ( see @xcite ) are used , respectively , for solving the shooting problem ( newton method ) and for integrating the ordinary differential equations ( with prediction ) .",
    "the euler angle @xmath45 is usually called the _ pitch angle _ , and a _ pitching up maneuver _ designates a maneuver with terminal condition @xmath609 , while a _ pitching down maneuver _ designates a maneuver with terminal condition @xmath610 .",
    "[ [ pitching - up - maneuvers . ] ] pitching up maneuvers .",
    "+ + + + + + + + + + + + + + + + + + + + + +    we set @xmath611 m / s and we use the numerical values denoted by ( tc1 ) in table [ tercond_table ] .",
    "the components of the state variable are reported on figure [ state_1000 ] .",
    "the optimal control , the adjoint variables @xmath612 and @xmath613 and the modulus of the switching function @xmath614 are reported on figure [ adjoint_1000 ] .    . ]    . ]",
    "we observe that the optimal control switches twice , at times @xmath615 s and @xmath616 s. these two switching points are of order @xmath187 ( i.e. , @xmath617 and @xmath618 ) . accordingly with lemma [ lem_pointorder1 ] , the control turns with an angle @xmath303 at those points .",
    "let us give another numerical example , taking the same terminal conditions as previously except for @xmath606 , and we take @xmath619 m / s .",
    "the time history of the state , of the optimal control and of the switching function are reported on figures [ state_1500 ] and [ adjoint_1500 ] .",
    "one can see on figure [ adjoint_1500 ] that the optimal control turns two more times with an angle @xmath303 due to two switching points of order one .    .",
    "]    . ]",
    "[ [ pitching - down - maneuvers . ] ] pitching down maneuvers .",
    "+ + + + + + + + + + + + + + + + + + + + + + + +    we set @xmath619 m / s and we use the numerical values denoted by tc3 in table [ tercond_table ] .",
    "the optimal solution is drawn on figures [ state_1500_inverse ] and [ control_1500_inverse ] .    .",
    "]    . ]",
    "the shorter maneuver time @xmath139 indicates that it is easier to turn clockwise the axis of the velocity vector than to turn it anti - clockwise .",
    "this corresponds to the intuition .",
    "the reason is that the total force induced by the gravity force tends to reduce @xmath99 , i.e. , it helps the velocity to turn clockwise , and so together with the rocket thrust force , the maneuver time is less than that of the anti - clockwise case .",
    "note that the derived time history of the adjoint variable ( for both pitching up and pitching down maneuvers ) do not have the same order of magnitude , i.e. , @xmath620 and @xmath621 are ten times larger than @xmath622 and @xmath623 , and are thousand times larger than @xmath539 , @xmath538 and @xmath540 .",
    "this indicates again that the shooting method is difficult to initialize successfully .",
    "we note that the indirect strategy proposed in section [ indirecte_strategy ] is efficient also because the smallest adjoint variables @xmath539 , @xmath538 and @xmath540 are already quite accurately estimated thanks to the problem of order zero .      [",
    "[ sub - optimal - solution - by - the - indirect - approach . ] ] sub - optimal solution by the indirect approach .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    on figures [ state_2000 ] and [ adjoint_2000 ] is given a sub - optimal solution of @xmath0 with the terminal conditions ( tc2 ) of table [ tercond_table ] and @xmath624 m / s .",
    "due to chattering , the continuation parameter @xmath528 stops at value @xmath625 ( see remark [ rem_subopti ] ) .    .",
    "]    . ]",
    "observing from figure [ adjoint_2000 ] , the switching function pass four times the switching surface @xmath287 are small between time @xmath626 and @xmath627 .",
    "the control , instead of bang - bang or singular , is continuous .",
    "the cost of this trajectory is @xmath628 and the final time @xmath629 .    [ [ sub - optimal - solution - by - the - direct - approach . ] ] sub - optimal solution by the direct approach .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    with the same terminal conditions as above , we now use the direct method described in section [ c_dc ] .",
    "numerical simulations show that the initialization step for the direct method procedure is quite robust ( a constant initial guess is enough ) .",
    "the results are reported on figures [ state_2000_bocop ] , [ control_2000_bocop ] and [ adjoint_2000_bocop ] .     ( @xmath630 ) . ]",
    "( @xmath630 ) . ]",
    "we observe that , when @xmath631 $ ] , the control oscillates much with a modulus less than @xmath187 : this indicates that there is a singular arc in the  true \" optimal trajectory , and therefore chattering according to corollary [ cor_chattering ] .",
    "( @xmath630 ) . ]",
    "note that , along the singular arc , the variables @xmath632 , @xmath633 , @xmath620 , @xmath621 , @xmath634 , @xmath635 and @xmath636 are almost equal to @xmath324 , and we check that this arc indeed lives on the singular surface @xmath459 defined by . therefore , it turns out that there is a singular arc in the optimal trajectory , causing chattering at the junction with regular arcs .",
    "the maneuver time is @xmath637 s. compared with that of the sub - optimal solution derived from the indirect strategy , only @xmath638 s are gained with the direct method .",
    "the direct approach is hundreds of times slower than the indirect approach and the obtained control presents many oscillations , which is not much appropriate for a practical use .    on figure [ state_1000 ] , [ state_1500 ] , [ state_1500_inverse ] , [ state_2000 ] and [ state_2000_bocop ]",
    ", we note that the attitude angles first tend to reach the values @xmath518 deg , @xmath519 ( i.e. , @xmath639 deg and @xmath640 deg for figures [ state_1000 ] and [ state_1500 ] ; @xmath641 deg and @xmath642 deg for figure [ state_1500_inverse ] ; @xmath643 deg and @xmath644 deg for figures [ state_2000 ] and [ state_2000_bocop ] ) , and then turn back to reach their final values . actually , doing more numerical simulations with different terminal conditions ( note reported here ) , we observe that the extremals have a trend to first go towards the singular surface and then to get back to the target submanifold .",
    "we suspect that this is due to a turnpike phenomenon as described in @xcite , at least when the required transfer time is quite large .",
    "we have studied the time optimal control of the rocket attitude motion combined with the orbit dynamics .",
    "the problem @xmath0 is of interest because of the coupling of guidance and navigation systems .",
    "however , this problem is difficult to solve because of the occurence of the chattering phenomenon for certain terminal conditions .    using geometric control , we have established a chattering result for bi - input control - affine systems .",
    "we have also classified the switching points for the extremals of the problem @xmath0 , according to the order of vanishing of the switching function , showing the behavior of the control at the singularities .    in order to compute numerically the solutions of problem @xmath0 ,",
    "we have implemented two approaches .",
    "the indirect approach , combining shooting and numerical continuation , is time - efficient when the solution does not contain any singular arcs . for certain terminal conditions ,",
    "the optimal solution of @xmath0 involves a singular arc that is of order two , and the connection with regular arcs can only be done by means of chattering .",
    "the occurrence of chattering causes the failure of the indirect approach . for such cases ,",
    "we have proposed two possible numerical alternatives .",
    "since our indirect approach involves three continuations , one of them being concerned with a continuation on the cost function ( and thus on the hamiltonian and the control ) , we have proposed , as a first alternative , to stop this last continuation before its failure : in such a way , we obtain a sub - optimal solution , which seems to be very acceptable for a practical use .",
    "the second alternative is based on a direct approach , and then we obtain as well a sub - optimal solution having a finite number of switchings , this finite number being limited by the chosen step of the subdivision in the discretization scheme . in any case , the direct strategy is much more time consuming than the indirect approach . note",
    "that , in both cases , it is not required to know a priori the structure of the optimal solution ( in particular , the number of switchings ) .    as an open issue",
    ", one may consider to add atmospheric forces in the model . since the magnitude of the aero - forces is low ( at least",
    ", it should be much smaller than the rocket thrust ) , we expect this extension to be doable , for instance by means of an additional continuation .              j.t .",
    "betts , practical methods for optimal control and estimation using nonlinear programming , second edition , advances in design and control , 19 , _ society for industrial and applied mathematics ( siam ) _ , philadelphia , pa , 2010 .",
    "d. guzzetti , r. armellin , m. lavagna , coupling attitude and orbital motion of extended bodies in the restricted circular 3-body problem : a novel study on effects and possible exploitations , _ in the proceedings of 63rd international astronautical congress _ , 2012 .",
    "m. lara , j. pelaez , c. bombardelli , f. r. lucas , m. sanjurjo - rivo , d. curreli , e. c. lorenzini , d.j .",
    "scheeres , dynamic stabilization of l2 periodic orbits using attitude - orbit coupling effects , _ journal of aerospace engineering _ , 2012 , vol ."
  ],
  "abstract_text": [
    "<S> in this paper , we investigate the minimal time problem for the guidance of a rocket , whose motion is described by its attitude kinematics and dynamics but also by its orbit dynamics . our approach is based on a refined geometric study of the extremals coming from the application of the pontryagin maximum principle . </S>",
    "<S> our analysis reveals the existence of singular arcs of higher - order in the optimal synthesis , causing the occurrence of a chattering phenomenon , i.e. , of an infinite number of switchings when trying to connect bang arcs with a singular arc .    we establish a general result for bi - input control - affine systems , providing sufficient conditions under which the chattering phenomenon occurs . </S>",
    "<S> we show how this result can be applied to the problem of the guidance of the rocket . based on this preliminary theoretical analysis </S>",
    "<S> , we implement efficient direct and indirect numerical methods , combined with numerical continuation , in order to compute numerically the optimal solutions of the problem .    </S>",
    "<S> * keywords : * coupled attitude orbit problem ; optimal control ; pontryagin maximum principle ; shooting method ; continuation ; chattering arcs . </S>"
  ]
}