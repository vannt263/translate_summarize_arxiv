{
  "article_text": [
    "spontaneous parametric down conversion ( spdc ) is one of the most standard tools in photonic quantum information processing ( qip ) e.g. quantum key distribution , quantum teleportation , quantum repeaters , and linear optics quantum computation @xcite . toward implementing higher rate entanglement - based qkd or larger scale qip protocols ,",
    "it is important to increase the photon - pair generation rate from the spdc source such that it provides reasonable coincidence counts of photons in multiple detectors .",
    "though this is possible by simply increasing the pump power into the spdc crystals , it simultaneously degrades the quantum interference visibility due to the unwanted multi - photon emissions .",
    "therefore , on one hand , it is an important experimental topic how to reduce the effect of multi - photon emissions while keeping the higher generation rates .",
    "the experimental progress in this direction has been reported recently @xcite .",
    "on the other hand , in theory , it is desirable to establish a method which fully incorporates the multi - photon emissions and various practical imperfections of the experiment , and is also able to simulate various qip applications with complicated optical circuits .",
    "the quantum state generated into the signal and idler modes from an spdc source is described by a two - mode squeezed vacuum ( tmsv ) : @xmath0 where @xmath1 represents an @xmath2-photon state , and @xmath3 is the squeezing parameter .",
    "obviously it includes infinitely higher order photons that contribute to the multi - photon emissions .",
    "also , to simulate experiments precisely , one has to take into account various imperfections such as losses in channels and detectors , dark counts of detectors , mode mismatch between the pulses , and so on .",
    "the theory to describe multi - photon emissions have been investigated in various literatures @xcite .",
    "a major approach is to calculate the evolution of the state vector of the tmsvs in the protocol @xcite .",
    "although the approach is straightforward and useful to see the physical insight of multi - photon effects , one of its drawback is that one has to truncate the higher photon number @xcite which is not appropriate for the higher power pumping . in principle , it is possible to include ( even infinitely ) higher order photons in analytical forms .",
    "however , the problem is that its mathematical expression often becomes complicated even for relatively simple setup using only one or two spdcs like @xcite .",
    "this is more problematic for a larger scale qip protocol .",
    "that is , its numerical simulation often require a huge computational resource even truncating the higher order of photons .",
    "this severely limits the ability to estimate the practical performance of such a protocol .",
    "for example , in @xcite , the concatenated operation of entanglement swapping is theoretically investigated where the authors showed precise but highly complicated mathematical expression of the states and detection probabilities in the protocol and performed its numerical simulation for the concatenation of 3 swappings , which involves 16 optical modes .",
    "the simulation was performed by a parallel programing on a super computer meaning that it requires a huge computational resource even for that scale of the protocol . therefore to extend the analysis for larger spdc based qip networks , it is desirable to find an alternative way of calculating such a problem more systematically , simply , and with less computational resources .    as a related work to the above",
    ", the authors in @xcite developed a precise mathematical model of nonideal photon detectors and then derived analytical formulae of several parameters for the experiments with one spdc source , including the hong - ou - mandel ( hom ) interference and the einstein - podolsky - rosen ( epr ) interference visibilities where multi - photon pair effects and detector imperfections are successfully incorporated .",
    "although their formulae are useful for the practical estimation of these experiments , it is not fully clear if the approach is easily extendible to more complicated protocols such as the concatenated entanglement swapping discussed in @xcite .    in this paper , we propose yet another approach based on the phase space representation of quantum optics ( see @xcite for example ) which is often used in continuous variable - qip ( cv - qip ) @xcite .",
    "our method can compute the spdc based qip experiments by systematically including the multi - photon effects , detector imperfections , and moreover , other practical imperfections , such as mode mismatching between the pulses from spdc sources that has not been explicitly considered in previous analyses . by applying our method to two examples , the hom interference and the epr interference experiments we show that our method can simulate the recent experimental results in @xcite with a quantitative agreement .",
    "also we are able to derive closed forms of these visibilities that could be handy tools to estimate the effects of multi - photon emissions and various imperfections in these experiments .",
    "moreover , our method can simulate even larger scale spdc based qips with a reasonable computational resource . as an example , we consider the concatenated entanglement swapping ( ces ) protocol discussed in @xcite and demonstrate a drastic decrease of the required computational resource by our method .",
    "for example , the ces with 3 swappings can be simulated by only a 10 second use of a commercial computer and even for 5 swappings , it requires around 2 minutes with the same computer .",
    "this allows us to estimate the optimal number of concatenation for a given long - distance channel , for example , a 1000 km optical fiber .",
    "we believe that our method could be a powerful tool not only for estimating the already known protocols mentioned above but for calculating the performance of various future qip protocols based on spdcs .",
    "the paper is organized as follows . in sec .",
    "[ sec : ch_function ] , we describe our approach .",
    "it uses the characteristic function formalism which is one of the phase space representation of quantum states and operations .",
    "we first overview why this approach is beneficial for the problems and then review basic definitions and notations about the characteristic function formalism .",
    "we also provide the recipe of treating spdc sources , linear optics , detectors , and various imperfections by this formalism . in sec .",
    "[ sec : applications ] , we apply our method into three qip examples , the hom interference , the epr interference , and the ces protocol .",
    "also we discuss a general computational complexity .",
    "note that our method is not generally efficient in the sense that the complexity exponentially grows with the size of the system .",
    "however , as demonstrated in this section , it is still a powerful tool for simulating a relatively large size qip such as the ces protocol with a small computational resource .",
    "section  [ sec : conclusion ] concludes the paper .",
    "in this section , we review the characteristic function formalism and provide the recipe to treat the spdc based qips with this formalism .",
    "characteristic function and its fourier transform , wigner function , are typical ways to represent quantum states in phase space and are often used in optical cv - qips , in particular , for _ gaussian state and operation _",
    ", where the former is a quantum state whose characteristic function is a gaussian function and the latter is a quantum operation transforming gaussian state to other gaussian state @xcite .",
    "it is known that quantum system consisting of gaussian states and operations are described by calculating only the covariance matrix of the gaussian function which is known to be efficiently simulated by classical computation @xcite ( which also means the impossibility of constructing a universal quantum computer by only these means ) .",
    "typically , the practical spdc based qips consist of spdc sources , linear optics , photon detectors , and imperfections that can be modeled by linear operations ( note that some of quantum memories can also be described by linear operation @xcite ) .",
    "the spdc source , i.e. tmsv , is a typical gaussian state and any linear optics and linear imperfections , that includes most of the practical imperfections , are gaussian operations .",
    "therefore , we can efficiently calculate the state evolution in the system just before the detection step .",
    "the last part of the experiments , photon detection , is non - gaussian operation .",
    "however , our gaussian approach is still useful if we consider the on - off detectors ( also called the threshold detectors ) rather than the photon number resolving detectors . on - off detector discriminates only zero or non - zero photons and widely used in the spdc based qip experiments .",
    "such a detector is mathematically described by two operators , one is a vacuum ( zero photons ) and the other is an identity operator minus vacuum ( non - zero photons ) .",
    "since vacuum is also a gaussian state , one can compute the full process of the protocols via the gaussian function based characteristic function formalism ( this fact has been recognized in cv - qips , see @xcite for example ) . in the following",
    ", we describe the detailed definitions and notations .",
    "let us consider an @xmath2-mode bosonic system associated with an infinite - dimensional hilbert space @xmath4 and @xmath2 pairs of annihilation and creation operators , @xmath5 , respectively , which satisfy the commutation relations @xmath6",
    "= \\delta_{ij } .\\ ] ] from these , one may construct the quadrature field operators : @xmath7 it is easy to verify that the commutation relations now translate to @xmath8=i \\delta_{ij}$ ] . in the @xmath2-mode bosonic system , a quantum state with density operator @xmath9",
    "is described by its characteristic function @xmath10 , \\ ] ] where , @xmath11 , \\ ] ] is a weyl operator , @xmath12^t$ ] is a @xmath13 vector consisting of quadrature operators , and @xmath14 $ ] is a @xmath13 real vector .",
    "* definition*. the gaussian state is defined as the quantum state whose characteristic function is given by a gaussian function : @xmath15 , \\ ] ] where @xmath16 is a @xmath17 matrix and @xmath18 is a @xmath13 vector called the covariance matrix and the displacement vector , respectively .",
    "for example , coherent state @xmath19 is a gaussian state .",
    "its characteristic function and displacement vector are described by the gaussian form in eq .",
    "( [ eq : chi_gaussian ] ) with @xmath20\\ ] ] where @xmath21 is a 2-by-2 identity matrix ( thus the vacuum state is simply given by @xmath22 ) . the most important gaussian state in this paper is the tmsv .",
    "its covariance matrix is given by @xmath23 , \\ ] ] where @xmath24 , \\ ] ] and @xmath25 while @xmath26 .",
    "it is worth to note that @xmath27 corresponds to the average photon number per mode , i.e. @xmath28 , where @xmath29 and @xmath30 are the identity and photon number operators , respectively .    * partial trace of gaussian states*. the covariance matrix of the reduced state after partial trace",
    "is simply given by the submatrix corresponding to the remained system .",
    "for example , the covariance matrix of the reduced state of the tmsv @xmath31 $ ] is @xmath32 , \\ ] ] which corresponds to the covariance matrix of a thermal state with average photon number @xmath27 : @xmath33      gaussian unitary operation is defined as the unitary operation that transforms gaussian states to other gaussian states .",
    "any gaussian unitary operation acting on a gaussian state can be described by symplectic transformations of the covariance matrix and the displacement vector of the state : @xmath34 where @xmath35 is a symplectic matrix corresponding to the gaussian unitary operation and @xmath36 is a transpose operation . for any covariance matrix",
    ", there exists a symplectic transformation that diagonalizes the covariance matrix ( symplectic diagonalization ) .",
    "if the unitary operation includes only linear optical process ( beam splitters and phase shifts ) , then @xmath37 and such a matrix @xmath35 is called an orthogonal symplectic matrix .",
    "the explicit expression of the symplectic matrix for phase shifting and beam splitting are given below .",
    "* phase shift * : @xmath38 .\\ ] ] * beam splitter on mode @xmath39 and @xmath40 * : @xmath41 , \\ ] ] where @xmath42 is the transmittance of the beam splitter . throughout the paper",
    ", we often simplify the description of a block diagonalized matrix like eq .",
    "( [ eq : beam_splitter ] ) as @xmath43^{\\oplus 2 } .",
    "\\nonumber\\ ] ]      a major detection device in experimental photonic qip is a photon detector , which discriminates only zero or non - zero photons .",
    "such a device is mathematically described by a set of measurement operators @xmath44 where @xmath29 is an identity operator .",
    "similar to the state , we can define the characteristic function of the measurement operator @xmath45 as @xmath46 $ ] .",
    "in general , the probability of detecting the state @xmath9 with the measurement operator @xmath45 is given by @xmath47   = \\left(\\frac{1}{2\\pi}\\right)^n \\int dx \\ , \\chi_{\\rho } ( x ) \\chi_{\\pi } ( -x ) .\\ ] ] now suppose @xmath9 is a single - mode gaussian state with @xmath48 $ ] and is measured by an on - off detector . the probability of obtaining the `` on '' outcome ( i.e. detecting non - zero photons ) is calculated to be @xmath49 = 1 - { \\rm tr}\\left [ \\hat{\\rho } |0\\rangle\\langle0| \\right ] \\nonumber\\\\ & = & 1-\\frac{1}{2\\pi } \\int dx \\ , \\chi_{\\rho } ( x ) \\chi_{\\pi_{\\rm off } } ( -x ) \\nonumber\\\\ & = & 1-\\frac{1}{2\\pi } \\int dx \\ , \\exp \\left [ -\\frac{1}{4 } x^t ( \\gamma + i ) x \\right ] \\nonumber\\\\ & = & 1-\\frac{2}{\\sqrt{{\\rm det}(\\gamma+i ) } } , \\end{aligned}\\ ] ] where the last line performs the gaussian integration .",
    "the above measurement is an ideal one , i.e. unit efficiency and no dark counts .",
    "we will discuss the detector loss and dark counts in the next subsection .    in the spdc qip experiments ,",
    "we often consider the coincidence photon counts of a multi - mode quantum state .",
    "let @xmath50 be a density matrix of an @xmath51-mode gaussian state with covariance matrix @xmath16 .",
    "then the following formula is useful to calculate the coincidence counts : @xmath52 & = & \\left ( \\frac{1}{2\\pi } \\right)^m \\int dx \\ , \\exp\\left [ -\\frac{1}{4 } x^t ( \\gamma+i ) x \\right ] \\nonumber\\\\ & = & \\left ( \\frac{1}{2\\pi } \\right)^m \\sqrt { \\frac{(4\\pi)^{2m}}{\\det ( \\gamma + i ) } } \\nonumber\\\\ & = & \\frac{2^m}{\\sqrt{\\det(\\gamma+i ) } } .\\end{aligned}\\ ] ]      * linear loss*. the optical channel with transmittance @xmath42 ( i.e. @xmath53 loss ) is modeled by combining the channel with a vacuum environment via a beam splitter of transmittance @xmath42 and then tracing out the environment mode .",
    "the lossy channel is known as one of the gaussian channels , i.e. it consists of gaussian operations ( but not necessarily unitary ) @xcite .",
    "suppose a single - mode gaussian state with covariance matrix @xmath16 is transmitted through a lossy channel @xmath54 where @xmath42 is the channel transmittance .",
    "then @xmath54 transforms the covariance matrix of the state as @xmath55 where @xmath56 and @xmath57 .",
    "note that the photon detector with efficiency @xmath58 can be modeled by a lossy channel with transmittance @xmath58 followed by a lossless photon detector .",
    "* detector dark counts*. the dark counts are modeled by poissonian process @xcite or phase insensitive amplification process @xcite those provide the same expression for the on - off detector operators : @xmath59 where @xmath60 is the dark count probability .",
    "( a ) temporal mode mismatch at the beam splitter , and ( b ) its model based on effective beam splitters . @xmath61 and @xmath62 represent the modes where @xmath39 and @xmath40 corresponds to the spatial mode and the subscript are the labels for the temporal modes .",
    "note that our model in ( b ) is phenomenological and thus is not restricted to the temporal mode mismatch .",
    ", width=302 ]    * mode mismatch*. imperfection of mode matching at a beam splitter degrades the interference visibility .",
    "let @xmath63 be a phenomenological mode match factor representing the overlap between two pulses , i.e. @xmath64 where @xmath65 corresponds to a perfect mode matching while @xmath66 means the two pulses are in completely different modes and there is no interference between them .",
    "then the effect of mode mismatch is modeled by adding two ( effective ) beam splitters with transmittance @xmath63 .",
    "figure [ fig : mode_mismatch](a ) and ( b ) depict an example of the mode mismatch between two single - mode pulses in temporal mode and its translation into the beam splitting model ( spatial mode ) , respectively , where the two pulses are partially overlapped . in spatial mode",
    "@xmath39 of fig .",
    "[ fig : mode_mismatch](a ) , one can choose a temporal mode expansion in which one of the orthonormal mode is fully occupied by the pulse ( i.e. includes @xmath67 and @xmath68 ) .",
    "at the beam splitter , the mode expansion should be transformed such that the temporal part @xmath67 and @xmath68 are separated where these two modes should be a mixture with vacua to fulfil the normalization condition .",
    "this mode transformation is mathematically equivalent to split the pulse via a ( virtual ) beam splitter with transmittance @xmath63 into two spatial modes @xmath67 and @xmath68 ( and combined it with a vacuum from the other port of the beam splitter ) .",
    "the same thing happens in spatial mode @xmath40 where the pulse is split into modes @xmath69 and @xmath70",
    ". then @xmath61 and @xmath62 are combined at the real beam splitter where the pulses are interfered only between @xmath67 and @xmath69 ( fig .",
    "[ fig : mode_mismatch](b ) ) .",
    "here we give an example .",
    "suppose we would like to measure the coincidence counts after interfering the two gaussian state pulses via a beam splitter with transmittance @xmath42 .",
    "let @xmath71 be the covariance matrix of the two - mode state ( i.e. two pulses ) before the beam splitter . then after the beam splitting , a whole state is described by a six - mode covariance matrix @xmath72 where @xmath73 and the terms in the rhs are the beam splitter matrices defined in eq .",
    "( [ eq : beam_splitter ] ) .",
    "the coincidence count probability is then given by @xmath74.\\ ] ] note that in our model , the mode mismatch is included by a phenomenological factor and thus we can incorporate any kinds of mode mismatch , such as temporal , spectral , spatial , etc .      before closing the section",
    ", we briefly mention the ( classical ) feedforward operations .",
    "feedforward is an important resource in qip .",
    "for example , it allows one to implement an on - demand single - photon source from heralding of the spdc photons @xcite , and even constructing a universal quantum computer @xcite . in the feedforward scenario , each operation in the system can be adaptively chosen according to the prior partial measurement outcomes .",
    "therefore , to fully simulate such a system , one has to calculate all possible branches of the measurement outcomes and feedforwarded operations . as will be discussed in section 3.3 , since the computational complexity of our method exponentially grows as the system size increases , with our method it is not possible to fully simulate a large scale linear optics quantum computer proposed in @xcite with an efficient computation time .",
    "note however , for relatively small size systems , it is possible to trace each feedforward branches and apply our method to calculate the probability of observing each event separately",
    ". that would be useful to simulate the currently ( or near future ) feasible experimental setups such as @xcite .",
    "in this section we apply our characteristic function approach to spdc based qips and compare some of them with previous experimental results .",
    "the hong - ou - mandel ( hom ) interference is observed when two indistinguishable single - photons are interfered via a 50/50 beam splitter @xcite .",
    "the visibility of the hom interference can be unit only when the two photons are fully indistinguishable in any degree of freedom ( temporal mode , frequency mode , etc ) which is thus a useful measure to evaluate the indistinguishability of the signal and idler photons from the same spdc source .",
    "the hom interference test for an spdc source is described as follows .",
    "the signal and idler pulses are interfered by a 50/50 beam splitter and the coincidence count of the two detectors are measured by scanning the time delay of the idler pulse .",
    "the hom dip is observed when there is no time delay for the idler pulse , i.e , the overlap of the signal and the idler in time is maximum .",
    "let @xmath75 be the coincidence count ( cc ) probability without the delay and @xmath76 be the cc probability with the delay which is enough larger than the pulse width such that no interference occurs between the signal and idler pulses .",
    "following the previous works e.g. @xcite , we define the visibility of the hom test by @xmath77     ( a ) experimental setup of the hom experiment in @xcite , and ( b ) the corresponding linear optics model .",
    "ppktp : periodically poled ktiopo@xmath78 .",
    "pbs : polarization beam splitter .",
    "hwp : half waveplate .",
    "qwp : quarter waveplate .",
    "smfc : single - mode fiber coupler .",
    "fbs : fiber beam splitter .",
    ", width=302 ]    to see the validity of our method , we simulate the hom experiment in @xcite where the pump power dependence of @xmath79 is experimentally observed with a standard mode - locked laser ( ti : sapphire laser with a repetition rate of 76mhz ) .",
    "the experimental setup and the corresponding theoretical model are shown in fig .",
    "[ fig : hom_setup](a ) and",
    "( b ) , respectively .    the output from the spdc source",
    "is described by a tmsv which fully includes the multi - photon components .",
    "the transmission losses in the signal ( @xmath39 ) and idler modes ( @xmath40 ) , that are for example caused by coupling the spatial modes into fibers , are described by beam splitters with the transmittance @xmath80 , respectively .",
    "also @xmath81 includes the losses in the controllable delay line ( the collimator in fig .",
    "[ fig : hom_setup](a ) ) which makes the setup asymmetric ( in the sense that @xmath82 ) . @xmath83 and @xmath84 are the quantum efficiencies of the two photon detectors .",
    "the mode mismatch between the signal and idler pulses at the 50/50 beam splitter is characterized by the mode match factor @xmath63 which is in fact very sensitive to the hom interference visibility as shown below .",
    "the covariance matrix of the state generated from the spdc is given by @xmath85 which is defined in eq .",
    "( [ eq : tmsv ] ) . applying losses in mode @xmath39 and @xmath40 with transmittance @xmath86 and @xmath81 , respectively",
    ", we get @xmath87^{\\oplus 2 } , \\nonumber\\\\\\end{aligned}\\ ] ] where @xmath88^{\\oplus 2 } , \\ ] ] and @xmath89^{\\oplus 2 } .\\ ] ]    application of a 50/50 beam splitter with mode matching factor @xmath63 is calculated to be @xmath90 where @xmath91 and @xmath92 are given by eqs .",
    "( [ eq : mode_match ] ) and ( [ eq:3bs ] ) with @xmath93 , respectively .",
    "@xmath94 is a 8-by-8 identity matrix representing the vacua in modes @xmath95 , @xmath70 , @xmath68 , and @xmath96 .",
    "finally photon detection consists of lossy channels corresponding to the detector loss and perfect detectors .",
    "the covariance matrix of the system after the lossy channels with @xmath83 and @xmath84 , corresponding to the quantum efficiencies of two detectors , are given by @xmath97 we are now at the position to derive the coincidence count probability :    @xmath98 \\nonumber\\\\ & = & 1 - { \\rm tr}\\left[\\hat{\\rho}^{\\gamma_{a_1a_2a_3 } }    - { \\rm tr}\\left[\\hat{\\rho}^{\\gamma_{b_1b_2b_3 } }    + { \\rm tr}\\left[\\hat{\\rho}^{\\gamma_{a_1 \\dots b_3 } }    \\nonumber\\\\ & = & 1 - \\frac{8}{\\sqrt{{\\rm det}(\\gamma_{a_1a_2a_3}+i ) } } - \\frac{8}{\\sqrt{{\\rm det}(\\gamma_{b_1b_2b_3}+i ) } } + \\frac{64}{\\sqrt{{\\rm det}(\\gamma_{a_1 \\dots b_3}+i ) } } , \\end{aligned}\\ ] ]    where @xmath99 and @xmath100 are the submatrices of @xmath101 .",
    "the determinants in eq .",
    "( [ eq : p_cc_tilde ] ) are explicitly given by @xmath102 ^ 2 - t_a t_b \\eta_a^2 \\xi^2 \\mu ( \\mu+1 ) \\right\\}^{1/2 } , \\\\",
    "\\sqrt{{\\rm det}(\\gamma_{b_1b_2b_3}+i ) } & = & 8 \\left\\ { \\left [ 1 + \\frac{\\eta_b \\mu}{4 } \\left\\ { 2(t_a + t_b ) - t_a t_b \\eta_b ( 1-\\xi^2 ) \\right\\ } \\right]^2 - t_a t_b \\eta_b^2 \\xi^2 \\mu ( \\mu+1 ) \\right\\}^{1/2 } , \\\\",
    "\\sqrt{{\\rm det}(\\gamma_{a_1 \\dots b_3}+i ) } & = & 64 \\left [ \\left\\ { 1+\\frac{\\mu}{4}\\left [ 2(t_a + t_b ) ( \\eta_a + \\eta_b ) - t_a t_b \\left\\{(\\eta_a + \\eta_b)^2 - \\xi^2 ( \\eta_a - \\eta_b)^2 \\right\\ } \\right ] \\right\\}^2 \\right .",
    "\\nonumber\\\\ & & \\left .",
    "- t_a t_b ( \\eta_a -\\eta_b)^2 \\xi^2 \\mu ( \\mu+1 ) \\right]^{1/2 } .\\end{aligned}\\ ] ]    the coincidence count with delay , @xmath76 is simply obtained from @xmath75 by setting @xmath103 , i.e. no overlap between the two modes .     the experimental plots with the 76 mhz laser in @xcite and the theoretical curves of the hom visibility as a function of @xmath104 .",
    "the theoretical curves are with @xmath1050.9888 , 0.9878 , 0.9868 , 0.9858 , and 0.9849 from the top to the bottom . , width=302 ]",
    "the theoretical visibilities derived above and the experimental plots in @xcite are compared in fig .",
    "[ fig : hom_experiment ] where the two channel transmittances were experimentally measured as @xmath106 , @xmath107 .",
    "the detectors used in the experiment were superconducting nanowire single photon detectors ( snspds ) that gave @xmath108 , and @xmath109 and negligible dark counts ( less than 1k counts per second ) .",
    "the squeezing parameter @xmath104 corresponds to the photon - pair generation rate which is directly measurable in the experiment ( recall that @xmath110 ) .",
    "the mode matching factor is not measured and thus given as a fitting parameter .",
    "the figure shows a quantitative agreement between the theory and the experiment .",
    "also the theory curves reveal that the visibility is highly sensitive to the mode matching at the beam splitter .",
    "note that @xcite also provides the theoretical curves , that are obtained by directly calculating the state vector of a whole system including environments and numerically computed the coincidence counts .",
    "one can numerically check that the numerical result in @xcite and the theoretical curve in fig .",
    "[ fig : hom_experiment ] are exactly identical .",
    "however , our method is much simpler and more systematic than the approach in @xcite and allows us to obtain a closed formula . from that closed formula ,",
    "we can also derive a simple analytical picture of the visibility .",
    "suppose experimental imperfection is only the low efficiency of the detectors @xmath111 and @xmath112 .",
    "assuming @xmath113 , which is reasonable for the photon - pair experiments , the visibility is simply given by @xmath114 it should be noted that eq .",
    "( [ eq : hom_visibility_low_eta ] ) agrees with the one obtained in @xcite .",
    "another interesting limit is the ideal case ( @xmath115 and @xmath113 ) : @xmath116 which shows that the visibility degradation due to the multi - photon emission is accelerated by the low efficiency of the detectors .",
    "another example is the epr interference test ( also called correlation measurement ) for polarization entangled photon pairs .",
    "we consider the sagnac loop entanglement source , which was proposed in @xcite and is now widely used for photonic qip experiments @xcite . here",
    "we compare our model with the epr interference experiment performed by a sagnac loop entanglement source in @xcite .",
    "the experimental set up and the corresponding theoretical model are illustrated in figs .",
    "[ fig : epr_setup](a ) and ( b ) , respectively .",
    "the sagnac loop source generates a tmsv into the horizontal and vertical polarization modes in the clockwise direction ( labeled as @xmath117 in the theoretical model ) and the counter - clockwise direction ( @xmath118 ) .",
    "the entangled state is generated by swapping the vertical polarization modes @xmath119 and @xmath120 via a dichroic polarization beam splitter ( dpbs ) .",
    "this operation transforms the covariance matrix of the two tmsv states @xmath121 into @xmath122 where    @xmath123^{\\oplus 2 } ,   \\\\ \\label{eq : sagnac_loop_entangled } \\gamma_{a_ha_vb_hb_v}^{\\rm sl } & = & \\left [ \\begin{array}{cccc } 2\\mu + 1 & 0 & 0   & \\pm 2\\sqrt{\\mu(\\mu+1 ) } \\\\ 0 & 2\\mu + 1 & \\pm 2\\sqrt{\\mu(\\mu+1 ) } & 0 \\\\ 0 & \\pm 2\\sqrt{\\mu(\\mu+1 ) } & 2\\mu + 1 & 0 \\\\ \\pm 2\\sqrt{\\mu(\\mu+1 ) } & 0 & 0 & 2\\mu + 1 \\end{array } \\right]^{\\oplus 2 } .\\end{aligned}\\ ] ]     ( a ) experimental setup of the epr interference experiment in @xcite , and",
    "( b ) the corresponding linear optics model .",
    "ppktp : periodically poled ktiopo@xmath78 .",
    "oi : optical isolator .",
    "hwp : half waveplate .",
    "qwp : quarter waveplate .",
    "dm : dichroic mirror .",
    "dpbs : dichroic polarization beam splitter .",
    "dhwp : dichroic half waveplate .",
    "lpf : long wavelength pass filter .",
    "smfc : single - mode fiber coupler .",
    ", width=302 ]    the epr interference test is a common and relatively easy way to experimentally estimate the quality of entanglement .",
    "each spatial mode is projected onto a particular polarization basis by a half - wave plate ( hwp ) and a polarization beam splitter ( pbs ) and then the photons in a chosen polarization are detected by a single photon detector .",
    "the coincidence photon count rate depends on the angle of each polarization basis and the interference fringe is obtained by fixing one of the polarization angles constant and rotate the other one .",
    "the visibility is given by @xmath124 where @xmath125 and @xmath75 are the maximum and minimum count rates in the fringe .",
    "the polarizer ( hwp and pbs ) with angle @xmath126 effectively works as a beam splitter between the horizontal and vertical polarization modes with transmittance @xmath127 .",
    "the main imperfection in this component is a finite extinction ratio in the pbs which is modeled by a perfect beam splitter followed by losses in each polarization mode with @xmath128 and @xmath129 where @xmath130 and @xmath131 are the transmittances of the horizontal and vertical polarization modes , respectively ( see fig .  [",
    "fig : hwp_pbs](a ) and ( b ) ) . in the following , to simplify the calculation of the setup in fig .",
    "[ fig : epr_setup](b ) , we use @xmath132 and @xmath133 where @xmath134 and @xmath135 are the quantum efficiencies of the detector for horizontally and vertically polarized photons , respectively .",
    "the covariance matrix of the entangled source in eq .",
    "( [ eq : sagnac_loop_entangled ] ) is first transformed by perfect beam splitter operations @xmath136 .",
    "the imperfection of the pbss and the imperfect quantum efficiency of the detectors are included by applying the lossy channels @xmath137 .",
    "the coincidence count is then given by     ( a ) the polarizer consisting of a half waveplate ( hwp ) and a polarization beam splitter ( pbs ) , and ( b ) the corresponding linear optics model .",
    ", width=302 ]    @xmath138 \\nonumber\\\\ & = & 1 - \\frac{4}{\\sqrt{{\\rm det}(\\gamma_{a_ha_v}+i ) } } - \\frac{4}{\\sqrt{{\\rm det}(\\gamma_{b_hb_v}+i ) } } + \\frac{16}{\\sqrt{{\\rm det}(\\gamma_{a_ha_vb_hb_v}+i ) } } , \\end{aligned}\\ ] ]    where @xmath139 .\\end{aligned}\\ ] ]    the minimum and maximum count rates required in eq .",
    "( [ eq : entanglement_visibility ] ) are for example obtained by @xmath140 and @xmath141 @xcite .     the experimental plots in @xcite and the theoretical curves of the epr interference as a function of the photon - pair generation rate of the sagnac loop source @xmath142 .",
    "the theoretical curves are with @xmath1430.007 , 0.009 , and 0.011 from the top to the bottom .",
    ", width=302 ]    figure [ fig : epr_experiment ] shows the comparison with the experiment in @xcite and our theoretical model .",
    "note that the photon - pair generation rate of the sagnac loop source should be @xmath144 instead of @xmath104 since the spdc crystal is pumped twice ( clockwise and counter - clockwise directions ) . in the experiment ,",
    "the overall efficiencies for the horizontal polarization are measured to be @xmath145 ( again , snspds are used as detectors and thus we neglect the effect of dark counts ) .",
    "the transmittance of the vertical polarization at the pbs is not measured and thus we use it as a fitting parameter varying from 0.007 to 0.011 ( @xmath146 is guaranteed for a typical commercial pbs ) .",
    "the theoretical estimate agrees with the experimental result .",
    "again , it is worth to further simplify the closed form given above . by setting @xmath147 and @xmath148 , the closed form of the visibility",
    "is reduced to @xmath149 in the limit of weak pumping ( @xmath113 ) , we have @xmath150 regardless of the detection efficiency @xmath58 .",
    "those results agree with the previous analyses in @xcite .. in @xcite corresponds to our @xmath104 , i.e @xmath151 . ]",
    "the last application in this section is the concatenated entanglement swapping ( ces ) where we show how to apply our method to the qip protocols with a multiple use of entangled source and demonstrate a drastic improvement of the computation time compared to the previous approach .",
    "entanglement transmission over long distance is limited by the loss and noises in channel and detectors .",
    "quantum repeater can overcome this limit but it is still challenging to implement it in large scale with the current technology .",
    "concatenation of entanglement swapping ( also called quantum relay ) is known as another protocol to extend the distance of the entanglement distribution albeit with a resource overhead that is exponential in the distance ( which is usually observed as an exponential decrease of the success probability ) @xcite . however , since entanglement swapping has been demonstrated with the current technology ( see @xcite and references therein ) , it is still interesting to see the practical performance of the ces protocol in theory .",
    "the protocol considered here is similar to the ces model discussed in detail in @xcite where the state vector evolution of the two - mode squeezed state generated from spdcs are calculated and the authors showed explicit expression of the density matrix and the detection probabilities those are used to derive the visibility of the epr interference of the distributed entanglement numerically .",
    "figure [ fig : ces_protocol](a ) illustrates the schematic of the protocol .",
    "entangled photon - pairs generated from the entangled photon - pair sources ( epss ) are swapped by the bell measurement consisting of a 50/50 beam splitter , two pbss and four on - off type photon detectors ( fig .",
    "[ fig : ces_protocol](b ) ) . entanglement swapping succeeds when photons are detected by particular two detectors in the bell measurement for example at q and s in fig .",
    "[ fig : ces_protocol](b ) . for more details of the protocol",
    "see @xcite and the references therein .",
    "figure [ fig : ces_protocol](c ) is our model which is equivalent to fig .",
    "[ fig : ces_protocol](a ) but the orthogonal polarization modes are explicitly illustrated by different lines . for our eps , we assume to use the sagnac loop spdc entangled source discussed in the previous subsection while the method can be applied to any other sources even not necessarily entangled in polarization modes ( such as time - bin entanglements ) .",
    "for the system imperfections , we follow the assumptions used in @xcite , i.e. losses in channels and detectors and the dark counts at detectors exist whereas the mode matching at beam splitters and the pbs devices are assumed to be perfect .",
    "the polarization modes are labeled by numbers from the left to the right ( see fig .  [",
    "fig : ces_protocol](c ) ) .",
    "also in the figure , for simplicity , only two detectors are illustrated for each bell measurement where the simultaneous clicks at these detectors correspond to the successful ces .",
    "at the left and right ends , two polarizers ( see fig .  [",
    "fig : hwp_pbs ] ) are placed to measure the epr interference visibility of the swapped state .",
    "we now calculate the joint detection probability of all detectors illustrated in fig .",
    "[ fig : ces_protocol](c ) as a function of two polarizer angles @xmath152 and @xmath153 .",
    "let @xmath154 be the number of bell measurements ( the number of concatenation ) , i.e. there are @xmath155 sagnac loop sources ( epss ) .",
    "the covariance matrix for the quantum state generated from the most left sagnac loop spdc is @xmath156 as discussed in eq .",
    "( [ eq : sagnac_loop_entangled ] ) . the total quantum state generated from @xmath155 sagnac loops is thus simply given by @xmath157 , more precisely , @xmath158^{\\oplus 2 } , \\ ] ] where @xmath159 and thus @xmath160 correspond to the two quadrature components of @xmath161 .",
    "following the discussion in @xcite , all transmission loss is included in the detector efficiency .",
    "we also assume that all transmission channels have the same loss and all detectors are identical .",
    "therefore , we first apply the beam splitting operations at the bell measurements .",
    "the beam splitters combine modes @xmath162 and @xmath163 for horizontal polarizations and modes @xmath164 and @xmath165 for vertical polarizations where @xmath166 .",
    "thus the symplectic matrix applied to @xmath157 is @xmath167 the two polarizer operations at the end of the concatenation are also given by applying the beam splitter symplectic matrix @xmath168 let @xmath58 be the detector efficiency ( including the channel transmittance ) .",
    "this is included by applying @xmath169 to the covariance matrix of the state . in total , we have the covariance matrix @xmath170    the joint detection probability of all detectors illustrated in fig .  [",
    "fig : ces_protocol](c ) is now obtained by calculating    @xmath171 \\nonumber\\\\ & = &   1 + \\sum_{m=1}^m \\sum_{c(m , m)}^{_m c_m }   \\frac{\\ { -2(1-\\nu ) \\}^m } {   \\sqrt { { \\rm det}(\\gamma^{\\rm ces}_{c(m , m)}+i ) } } , \\end{aligned}\\ ] ]    where @xmath60 is the dark count rate of detectors , @xmath172 is the total number of clicked detectors , i.e. @xmath173 , and @xmath174 is the submatrix of @xmath175 taking only modes @xmath176 .",
    "@xmath176 is the @xmath51-detector combination from @xmath172 detectors .",
    "for example , when @xmath177 , total number of detectors is @xmath178 and the detectors are placed in modes 1 , 3 , 6 , and 7",
    ". then @xmath1791 , 3 , 6 , 7 , @xmath18013 , 16 , 17 , 36 , 37 , 67 , @xmath181136 , 137 , 167 , 367 , and @xmath1821367 . for reference",
    ", we describe a detailed structure of @xmath183 in appendix .     the epr interference visibility of the entangled state distributed by the concatenated entanglement swapping as a function of the squeezing parameter @xmath27 with @xmath184 and @xmath185 ( see the main text ) .",
    "the number of the bell measurements ( concatenation ) is @xmath1861 , 2 , 3 , 4 , and 5 for red , orange , brown , green , and blue lines .",
    ", width=302 ]     the epr interference visibility for the same transmission distance with different number of concatenation .",
    "transmittance of the whole channel is @xmath187 which corresponds to 1000 km distance by a standard fiber with loss of @xmath188db / km .",
    "efficiency and dark counts of the detectors are @xmath189 and @xmath185 , respectively .",
    "the number of the bell measurements ( concatenation ) is @xmath1861 , 2 , 3 , 4 , and 5 for red , orange , brown , green , and blue lines .",
    ", width=302 ]    in fig .",
    "[ fig : ces_visibility1 ] , the epr interference visibilities are plotted as a function of @xmath27 for @xmath190 . for comparison , we choose the parameters used in @xcite , @xmath184 and @xmath185 for the transmittance and dark counts , respectively . in @xcite , the ces with @xmath191 is numerically simulated by a super computer with the photon number truncation at 3 photons in each mode ( the authors also reported that it takes 6 hours to get a single plot for the same simulation by a single - core use of a commercially available computer ) . in fig .  [",
    "fig : ces_visibility1 ] , the curve for @xmath191 ( brown line ) consists of 400 plots that are calculated by a commercial computer with only 10 seconds without any photon number truncation .",
    "similarly , 100 plots for @xmath192 ( blue line ) require around 2 minutes with the same computer ( it should be noted that our method works only for on - off detectors while the mathematical formula in @xcite includes both for on - off and photon number resolving detectors ) .",
    "our method is useful to estimate the performance of the ces for the long - distance entanglement transmission . in our model",
    "the total transmittance consists of the detector efficiency and the channel transmission as @xmath193 where @xmath194 is the detector efficiency , @xmath195 is the loss coefficient , and @xmath196 is the distance of the transmission channel . in the following ,",
    "we consider the photon pairs at 1550 nm and use of a standard optical fiber with @xmath197 as a transmission channel .",
    "figure [ fig : ces_visibility2 ] compares the visibility for different @xmath154 where the total distance of the channel is fixed to be 1000 km .",
    "the detector efficiency and dark counts are assumed to be @xmath189 and @xmath185 , respectively , could be typical parameters for snspds discussed in previous subsections . for example , for @xmath177 , the channel is divided into four arms and each arm has 250 km distance . in fig .",
    "[ fig : ces_visibility2 ] , the visibility is plotted for the ces up to @xmath192 .",
    "first it shows that for @xmath177 , it is completely impossible to distribute entanglement and even for @xmath198 , the visibility must be around 0.2 .",
    "second , for extremely small @xmath27 , the figure shows that @xmath154 should be large as much as possible while for the most region of @xmath27 , the curve for @xmath192 decreases quickly as @xmath27 increases and @xmath1863 or 4 are optimal for most of @xmath27 .",
    "the result suggests that to construct a practical ces network , the optimal number of concatenation should be carefully chosen by considering a given distance ( channel loss ) and detector parameters .",
    "finally , it should be worth to mention about a general scaling of the computational complexity of our method with respect to the number of modes @xmath199 ( or equivalently number of detectors to be detected ) .",
    "our method is not efficient in the sense that the computational complexity grows exponential with respect to @xmath199 .",
    "this is clearly observed in eq .",
    "( [ eq : ces_pcc ] ) .",
    "there are two steps to compute eq .",
    "( [ eq : ces_pcc ] ) .",
    "first , one has to calculate the covariance matrix including losses and beam splitters ( in general any linear optics and even squeezing operations ) .",
    "this step consists of multiplications of square matrices and each of that is polynomial ( at worst order of @xmath200 by direct calculation ) .",
    "second , the determinants of the ( sub)matrices in each term of eq .  ( [ eq : ces_pcc ] ) should be calculated . while determinants can be calculated for example with @xmath200 by the lu decomposition @xcite , the number of terms in the second line of eq .",
    "( [ eq : ces_pcc ] ) is increase as @xmath201 since the first line of eq .",
    "( [ eq : ces_pcc ] ) includes @xmath199 multiplication of binomial terms @xmath202 .",
    "this results the method inefficient ( at least @xmath203 for simulating large scale networks .",
    "note that this is not only for the ces protocols but a general property for any linear optics networks with spdcs and photon detectors .",
    "however , we should stress that , as shown in this subsection , for experimentally feasible size of the network with the current technology or even larger sizes , our method can work as a powerful tool to estimate the performance of the protocols with a practical computational time .",
    "in summary , we have proposed a method to compute the spdc based qip experiments theoretically , which fully involves the multi - photon emissions and various experimental imperfections .",
    "the key ingredient of our method is an application of the characteristic function formalism which has been widely used in cv - qips , in particular , for gaussian states and operations .",
    "we apply our methods to three examples , the hom interference and the epr interference experiments , and the concatenated entanglement swapping protocol .",
    "the first two examples are compared with the previously reported experimental results and show quantitative agreements .",
    "moreover , we provide the analytical expression for the hom and epr visibilities that include full multi - photon components and various experimental imperfections",
    ". these could be useful for estimating the performance of various experimental setups . in the third example",
    ", we numerically simulate the performance of the ces protocol up to five bell measurements ( concatenations ) which requires only few minutes with a commercially available computer",
    ". our method could be useful to estimate the practical performance of the spdc based protocol with experimentally feasible or even larger size linear optics networks .",
    "interesting future applications would include multi - partite entanglement generation @xcite , qkd @xcite and quantum repeaters with spdc sources such as heralded entanglements @xcite .",
    "finally , a general computational complexity of our method with respect to the size of the system ( mode numbers ) is discussed .",
    "we show that the complexity is growing as @xmath203 and thus inefficient for simulating very large scale systems beyond the current or near - future technologies .",
    "in general , linear optics network with perfect single photons and photon number resolving detectors , it is impossible to efficiently simulate the large system classically which is why the linear optics with feedback can construct a universal quantum computer @xcite ( related to this , it is believed that other related computing ideas such as boson sampling @xcite can not be efficiently simulated by classical computers ) .",
    "although we feel this would also be the case for linear optics system with spdcs and on - off detectors , it remains as an important open question whether there exists an efficient algorithm to simulate such a system .",
    "we stress that , however , our method is at least applicable to simulate the proof - of - principle demonstration of these protocols @xcite and also estimating even larger system that could be a real target in near - future experiments .",
    "we are grateful to nicolas sangouard , witlef wieczorek , and harald weinfurter for valuable suggestions .",
    "this work is supported by impact program of council for science , technology and innovation , japan .",
    "the explicit structure of @xmath204 in eq .",
    "( [ eq : cov_fin ] ) is @xmath205^{\\oplus 2 } , \\ ] ] where @xmath206 , \\\\ b & = & \\eta \\sqrt{2\\mu ( \\mu+1 ) } \\left [ \\begin{array}{cc } \\sin\\theta_a & \\cos\\theta_a \\\\ \\cos\\theta_a & -\\sin\\theta_a \\\\ -\\sin\\theta_a & -\\cos\\theta_a \\\\ -\\cos\\theta_a & \\sin\\theta_a   \\end{array } \\right ] , \\\\ c & = & \\eta \\sqrt{\\mu(\\mu+1 ) } \\left [   \\begin{array}{cc } j_2 & j_2 \\\\ -j_2 & -j_2",
    "\\\\ \\end{array } \\right ] , \\\\ d & = & \\eta \\sqrt{2\\mu ( \\mu+1 ) } \\left [ \\begin{array}{cccc } \\sin\\theta_b & \\cos\\theta_b & \\sin\\theta_b & \\cos\\theta_b \\\\ \\cos\\theta_b & -\\sin\\theta_b & \\cos\\theta_b & -\\sin\\theta_b   \\end{array } \\right ] , \\nonumber\\\\ \\end{aligned}\\ ] ] and @xmath207 , \\quad j_2 = \\left [ \\begin{array}{cc } 0 & 1 \\\\ 1 & 0   \\end{array } \\right ] .\\ ] ]                rui - bo jin , ryosuke shimizu , isao morohashi , kentaro wakui , masahiro takeoka , shuro izumi , takahide sakamoto , mikio fujiwara , taro yamashita , shigehito miki , hirotaka terai , zhen wang , and masahide sasaki .",
    "efficient generation of twin photons at telecom wavelengths with 2.5 ghz repetition - rate - tunable comb laser .",
    ", 4:7468 , 2014 .",
    "hugues de  riedmatten , valerio scarani , ivan marcikic , antonio acn , wolfgang tittel , hugo zbinden , and nicolas gisin .",
    "two independent photon paris versus four - photon entangled states in parametric down conversion .",
    ", 51:1637 , 2004 .",
    "rui - bo jin , ryosuke shimizu , kentaro wakui , mikio fujiwara , taro yamashita , shigehito miki , hirotaka terai , zhen wang , and masahide sasaki . pulsed sagnac polarization - entangled photon source with a ppktp crystal at telecom wavelength . , 22:11498 , 2014 .",
    "saikat guha , hari krovi , christopher  a. fuchs , zachary dutton , joshua  a. slater , christoph simon , and wolfgang tittel",
    ". exact analysis of a practical quantum repeater architecture with noisy elements . .",
    "robert prevedel , deny  r. hamel , roger colbeck , kent fisher , and kevin  j. resch .",
    "experimental investigation of the uncertainty principle in the presence of quantum memory and its application to witnessing entanglement .",
    ", 7:757 , 2011 .",
    "robert prevedel , philip walther , felix tiefenbacher , pascal bohi , rainer kaltenbaek , thomas jennewein , and anton zeilinger .",
    "high - speed linear optics quantum computing using active feed - forward .",
    ", 445:65 , 2007 .",
    "justin  b spring , benjamin  j metcalf , peter  c humphreys , w  steven kolthammer , xian - min jin , marco barbieri , animesh datta , nicholas thomas - peter , nathan  k langford , dmytro kundys , james  c gates , brian  j smith , peter g  r smith , and ian  a walmsley .",
    "boson sampling on a photonic chip .",
    ", 339:798 , 2013 .",
    "andrea crespi , roberto osellame , roberta ramponi , daniel  j. brod , ernesto  f. galvo , nicol spagnolo , chiara vitelli , enrico maiorino , paolo mataloni , and fabio sciarrino .",
    "integrated multimode interferometers with arbitrary designs for photonic boson sampling . , 7:545 , 2013 ."
  ],
  "abstract_text": [
    "<S> in spontaneous parametric down conversion ( spdc ) based quantum information processing ( qip ) experiments , there is a tradeoff between the coincide count rates ( i.e. the pumping power of the spdc ) , which limits the rate of the protocol , and the visibility of the quantum interference , which limits the quality of the protocol . </S>",
    "<S> this tradeoff is mainly caused by the multi - photon pair emissions from the spdcs . in theory , the problem is how to model the experiments without truncating these multi - photon emissions while including practical imperfections .    in this paper , we establish a method to theoretically simulate spdc based qips which fully incorporates the effect of multi - photon emissions and various practical imperfections . the key ingredient in our method is the application of the characteristic function formalism which has been used in continuous variable qips . </S>",
    "<S> we apply our method to three examples , the hong - ou - mandel interference and the einstein - podolsky - rosen interference experiments , and the concatenated entanglement swapping protocol . for the first two examples , </S>",
    "<S> we show that our theoretical results quantitatively agree with the recent experimental results . </S>",
    "<S> also we provide the closed expressions for these the interference visibilities with the full multi - photon components and various imperfections . for the last example </S>",
    "<S> , we provide the general theoretical form of the concatenated entanglement swapping protocol in our method and show the numerical results up to 5 concatenations . </S>",
    "<S> our method requires only a small computation resource ( few minutes by a commercially available computer ) which was not possible by the previous theoretical approach . </S>",
    "<S> our method will have applications in a wide range of spdc based qip protocols with high accuracy and a reasonable computation resource . </S>"
  ]
}