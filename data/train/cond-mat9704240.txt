{
  "article_text": [
    "a large number of problems in electrodynamics and related areas such as fluid dynamics , involve the solution of partial differential equations for certain fields inside and outside a finite region of a definite geometrical shape . for many common geometries , and when the boundary conditions are simple ( e.g. fields or their normal derivatives vanishing at the boundaries ) the solution can be found , often with ease , from analytical or simple numerical methods",
    ". however , for more complicated situations where one has less trivial boundary conditions , or when the equations are made more complicated by the presence of nonlinearities , analytical methods may be unavailable and numerical techniques encounter serious difficulties .",
    "one of these situations pertains to the electrodynamics of a superconducting sample of finite size .",
    "it is well - known that in the limit where the electromagnetic fields do not penetrate the sample the problem can be rather easily solved [ ] . however",
    ", this is hardly ever the case of interest : the physical information one obtains in experiments comes in fact from the penetration of the fields inside the sample , characterized by penetration depths which , although small , can not be neglected .",
    "consider a superconductor that occupies a bounded , macroscopic region @xmath0 , in the presence of an applied uniform magnetic field , @xmath1 .",
    "for @xmath2 below some critical value , superconductors are in the so called meissner regime [ ] , where the magnetic flux is expelled from the bulk of the sample .",
    "their behavior is similar to that of material which is both an ideal conductor and an ideal diamagnet .",
    "the applied magnetic field generates a resistance - free current which produces a magnetic field that opposes @xmath2 . as a consequence , everywhere except very close to the interface ( within a few penetration depths ) , the magnetic field vanishes : this is known as the meissner effect .",
    "except for the most trivial geometries such as infinite slabs or isotropic spheres , the relevant boundary value problem becomes then numerically very awkward : basically one is faced with solving the appropriate electrodynamic equations in the entire space , not just in @xmath3 , while the most important variation of the fields takes place in a very thin boundary layer in @xmath3 .",
    "this question has come recently to the fore in the context of the study of high temperature superconductors ( htsc s ) .",
    "identifying the symmetry of the paired electrons , the so called pairing state , in these materials , would provide an important clue to the still unknown mechanism responsible for superconductivity in htsc s .",
    "it turns out [ ] that careful measurements of certain electrodynamic properties in superconductors , can provide fingerprints for the nodal structure of the order ( gap ) parameter [ ] ( i.e. the points or lines in the fermi surface where it vanishes ) .",
    "the unconventional pairing states which are widely believed to exist in htsc s , produce nonlinearities in the electromagnetic response . as we shall see , the resistance - free current , in addition to the usual terms linear in the superfluid velocity , includes a small contribution for which the current - velocity relation is nonlinear .",
    "these nonlinearities then give rise [ ] , in the meissner regime , to a magnetic moment which has a small but detectable _ transverse _ component , @xmath4 , perpendicular to the field @xmath1 even when this is applied along a direction of symmetry of the sample .",
    "this occurs when the applied field lies in the @xmath5 crystallographic plane [ ] ( the @xmath6 axis is taken to be along the @xmath7 crystallographic direction ) .",
    "the angular dependence of the transverse component @xmath8 , as the crystal is rotated about the @xmath6 axis , reflects directly the symmetry of the pairing state .",
    "it is this quantity that has been experimentally studied [ ] for purposes of the identification of the pairing state .",
    "the physics of the situation has been extensively discussed in [ ] , and we deal here with the mathematical and numerical implications .",
    "the computation of the magnetic moment requires the solution of a problem of precisely the kind described in the previous paragraphs .",
    "one must solve the appropriate electrodynamics , the maxwell - london equations described in section [ maxw ] , for all space , since at infinity the boundary condition requires that @xmath9 .",
    "on @xmath3 these equations contain , as we shall see , important and nontrivial nonlinearities .",
    "a solution in the limit of zero penetration of the fields in the sample is possible , but it would be completely inadequate , since it would reflect only the geometry and not the detailed electromagnetic response of the superconductor .",
    "on the other hand , the numerical solution for the nonlinear electrodynamics in all space would be computationally demanding .",
    "in this paper we present a discussion of the methods that we have developed to obtain results [ ] for the nonlinear magnetic moment , including both the longitudinal and transverse components , in htsc s .",
    "these methods involve the numerical implementation of a perturbation scheme in which the small expansion parameter is the appropriately defined ratio of an effective penetration depth to a characteristic dimension of the superconductor .",
    "we will show that this numerical implementation reduces the problem essentially to that of finding the numerical solution in @xmath3 . in the region @xmath10 outside the sample ,",
    "one turns out to need only a solution for the scalar laplace equation with trivial neumann boundary conditions . for a sufficiently symmetric @xmath3 ,",
    "the form of the solution can be obtained analytically , while for some other cases a numerical solution would suffice .    in section [ maxw ]",
    "we discuss the nonlinear maxwell- london equations for a superconductor and show how they give rise to the magnetic moment .",
    "the geometrical shapes we have considered for @xmath3 ( dictated by experimental considerations ) are discussed in section [ geo ] where we introduce the general solution in @xmath10 . in section [ comp ]",
    "we discuss the computation of the magnetic moment and present the main result of this paper , the perturbative method and its numerical implementation .",
    "numerical considerations for the equations in @xmath3 are described in the section [ inside ] . in section [ tests ] , the equations are solved for the previously discussed geometry , using a modified gauss - seidel relaxation , with the nonlinear terms ( which are nonanalytic ) included through picard s method .",
    "we also illustrate the general ideas of the perturbation method . finally , in section [ future ] we give conclusions and guidelines for possible improvements and generalizations .",
    "while our discussion is in the context of superconducting electrodynamics , it will not escape the reader s notice that our procedures can be adapted to many other problems in which one is faced with a small `` skin depth '' or similar parameter involving the penetration of fields or of their derivatives inside a region , and the problem can be more easily solved in the limit where this parameter vanishes .",
    "we begin by introducing the steady state maxwell - london equations [ ] that provide the framework to compute the field distributions we need in order to evaluate the magnetic moment .",
    "as stated in the introduction we consider a superconductor in an applied uniform magnetic field @xmath1 that occupies a bounded simply connected region @xmath3",
    "@xmath11 @xmath12 and at its boundary , @xmath13 , is surrounded by vacuum . on @xmath14",
    "the current is @xmath15 and therefore in the steady state the local magnetic field @xmath16 satisfies the maxwell equations    [ ou ]",
    "@xmath17 @xmath18    the problem reduces to that of finding a magnetic scalar potential @xmath19 that satisfies    [ out ] @xmath20 @xmath21    on @xmath3 the relevant fields are @xmath16 , the superconducting current @xmath22 , and the `` superfluid velocity field '' @xmath23 [ ] defined as : @xmath24 where @xmath25 is the phase of the superconducting order parameter , @xmath26 the vector potential , and @xmath27 the proton charge , ( with @xmath28 ) .",
    "the field @xmath23 is conventionally defined as above , and actually has units of momentum . the relation between @xmath23 and @xmath16",
    "is given by the second london equation [ ] : @xmath29 in the steady state the appropriate maxwell equation is ampre s law , @xmath30 substituting eq .",
    "( [ londoneq ] ) into ( [ ampere ] ) we obtain : @xmath31 which is the general equation that will be investigated in this article .",
    "it must be supplemented by a relation , @xmath32 , which will be discussed in [ jvv ] , to be substituted in its right hand side ( rhs ) .",
    "( [ maxlon ] ) must then be solved together with eq .",
    "( [ out ] ) and the proper boundary conditions .",
    "the required boundary conditions are the following : first at infinity one must have , @xmath33 second , deep inside the sample all fields must vanish .",
    "third , @xmath16 must be continuous [ ] on the boundary @xmath13 .",
    "finally , the currents are confined to the superconducting material , @xmath34 in @xmath13 , @xmath35 is the unit normal pointing outwards . the first boundary condition ( at an open boundary over an infinite domain )",
    "can be satisfied by construction of the solution in @xmath36 .",
    "the remaining boundary conditions have to be implemented in the numerical algorithm .",
    "because of these boundary conditions we see that , as emphasized in the introduction , this problem can indeed be computationally very demanding .",
    "it involves solving nonlinear differential equations , in principle in an unbounded region , but with the relevant fields varying very rapidly in a small region inside the material .",
    "we will see here and in the next sections how these difficulties can be overcome , for suitable geometries , by making use of a numerical implementation of a perturbation scheme .",
    "let us at this point introduce some considerations that point to the eventual way out of these numerical difficulties .",
    "we recall that the quantity of interest here is the magnetic moment @xmath37 . from the current distribution @xmath22 in @xmath3 , the magnetic moment",
    "can be obtained by volume integration [ ] : @xmath38 where * r \" * is the position vector for a point in the region @xmath3 .",
    "an important consequence of nonlinear maxwell - london electrodynamics and unconventional pairing states is that @xmath37 need not be aligned with the applied field @xmath1 even if the latter is applied along a direction of geometrical symmetry , ( along a principal axis of the demagnetization tensor [ ] of the body ) . for simplicity , we will restrict ourselves to this case here , although it is straightforward to add the complications arising from a non - diagonal demagnetization tensor .",
    "let us introduce here , for a typical macroscopic experimental htsc sample , the ratio between some length @xmath39 characterizing its size , and the characteristic value of the london penetration depth , which we shall denote by @xmath40 . in a macroscopic sample the ratio @xmath41 is a very small quantity .",
    "this small ratio is essentially what will be used in this work to develop a perturbation method to compute the magnetic moment to first order in @xmath42 .",
    "the starting point of this procedure is the existence of a solution in the limit @xmath43 ( when all the nonlinear effects vanish ) , which corresponds to imposing trivial neumann boundary conditions on @xmath13 . for a suitable choice of @xmath3 , such as an ellipsoid",
    ", the form of this solution may be found analytically .",
    "the perturbation method may also be applied , as we shall see , in certain cases when only a numerical solution in the small @xmath42 limit is available .",
    "the components of @xmath37 parallel and perpendicular to @xmath1 applied along a direction of symmetry , can generically be written for @xmath44 in the form    [ mmm ] @xmath45 @xmath46    where @xmath47 denotes the longitudinal magnetic moment in the limit @xmath48 , ( and therefore @xmath49 ) , which is proportional to @xmath2 .",
    "it depends only on the geometry of @xmath3 and therefore contains no physical information . for @xmath3 in the shape of an ellipsoid",
    ", values are given in @xmath50 [ ] . for finite @xmath40 there is a reduction , linear in the field to leading order , in the absolute value of @xmath51 .",
    "this reduction is due to current penetration in the material and it implies a positive constant @xmath52 . for a very few simple geometrical shapes and linear , isotropic , maxwell - london equations , values of @xmath52 are given in textbooks [ ] .",
    "when nonlinear effects are included , they contribute a correction to @xmath53 linear in the field , but their most conspicuous effect is the appearance , in general , of nonvanishing values of @xmath54 , also proportional to the field [ ] .",
    "it is for this reason that the transverse component is the physical quantity of interest .",
    "we next derive an alternative expression for * m * that helps to fully exploit the existence of the small parameter @xmath42 . using eqs .",
    "( [ ou ] ) , ( [ ampere ] ) and formulas for vector calculus [ ] one can transform the the quantity in the integrand of ( [ magmom ] ) : @xmath55 @xmath56 after substitution of eq .",
    "( [ m2 ] ) into eq .",
    "( [ m1 ] ) , @xmath57 integration over @xmath3 and use of gauss theorem yields : @xmath58   + \\frac{1}{8 \\pi } \\int_{\\omega } d \\omega \\ : { \\bf h}\\equiv { \\bf m_1}+{\\bf   m_2 } , \\label{m4}\\end{aligned}\\ ] ] where * r \" * is the position vector for a point on @xmath59 .",
    "the notation @xmath60 , @xmath61 refers to the two terms in the middle portion of eq .",
    "( [ m4 ] ) .",
    "if we recall eq .",
    "( [ londoneq ] ) and use an alternative form of gauss theorem we can also rewrite @xmath61 as a surface integral : @xmath62 , \\ : \\ : \\ : \\ : { \\bf m_2}=\\frac{c}{8 \\pi e}\\int_{\\partial \\omega } ds \\ : { \\bf n }            \\times { \\bf v_s}. \\label{magmoms}\\ ] ] the terms @xmath60 and @xmath61 are of different order in @xmath42 and the latter is small , i.e. of @xmath63 .",
    "this follows from the volume expression for @xmath61 , as seen in eq .",
    "( [ m4 ] ) : since @xmath16 is confined to a `` skin '' layer of thickness @xmath40 from the surface , we see at once that @xmath61 will be of order @xmath40 times the applied field , that is , of order @xmath64 , thus explicitly vanishing in the zero penetration limit . alternatively , from eq .",
    "( [ londoneq ] ) one sees that @xmath23 scales as @xmath40 and then the same result follows from eq .",
    "( [ magmoms ] ) .",
    "specifically if the equations and boundary conditions require the field to decay exponentially far from the surface ( up to polynomial corrections ) , then after decomposing the volume integral into surface and normal components we have @xmath65 this expression is not proportional to the volume of @xmath3 , v , as is the case for @xmath47 , but rather to @xmath66 where @xmath67 is the surface area of @xmath13 .",
    "as a result @xmath68 is @xmath63 .",
    "we now return to the pending question of the equation relating the fields @xmath22 and @xmath69 needed to supplement ( [ maxlon ] ) .",
    "this is given by the usual two - fluid phenomenology [ ] : @xmath70 \\label{nonlinjv}\\ ] ] where @xmath71 is the total density of states at the fermi level , @xmath72 is the density of states at point @xmath73 at the fermi surface ( fs ) , normalized to unity , @xmath74 is the @xmath73-dependent fermi velocity , @xmath75 is the fermi function , with @xmath76 , t the absolute temperature and @xmath77 is the superconducting order ( gap ) parameter .    in the simplest approximation ( which we will call the linear case ) , one considers only the linear terms in the expression for @xmath32 ,",
    "that is , one expands the right side of ( [ nonlinjv ] ) and writes : @xmath78 where @xmath79 is the penetration depth tensor . in the special case of an isotropic superconductor , and",
    "_ only _ in this case , the fields @xmath16 , @xmath22 and @xmath23 all satisfy the vector helmholtz equation . but",
    "htsc s are in general highly anisotropic , layered structures with penetration depths much smaller [ ] in the layers ( @xmath5 planes ) than in the direction perpendicular to them ( along the @xmath7-axis ) , so that the isotropic limit does not apply .",
    "the components of @xmath79 in its diagonal representation are the square of the london penetration depths , @xmath80 , @xmath81 and @xmath82 and experimentally @xmath82 @xmath83 @xmath84 . in the numerical examples discussed here we will , for simplicity , neglect the comparatively small in - plane anisotropy and use the notation @xmath85 for the average of @xmath80 and @xmath81 .    in the anisotropic case eqs .",
    "( [ mmm ] ) are still valid with @xmath42 expressed in terms of an effective penetration depth , primarily determined by whichever component @xmath86 plays the dominant role in the current decay .",
    "for example , for the geometry considered in the next section , the relevant quantity is the penetration depth in the crystallographic @xmath5 plane .    in the problem of interest here",
    "one must consider , instead of eq .",
    "( [ linear ] ) , the nonlinear terms arising from the full relation ( eq .",
    "( [ nonlinjv ] ) ) between @xmath22 , and @xmath23 and substitute this in the rhs of eq .",
    "( [ maxlon ] ) .",
    "after suitable assumptions for the fs and other physical quantities are introduced , this can be done by performing the fs integrals numerically , [ ] or , in the low temperature limit , analytically [ ] .",
    "inclusion of these nonlinear terms is crucial , because , as mentioned , the physically important angular dependence of the transverse magnetic moment arises precisely from these nonlinear effects .",
    "the actual expressions for @xmath32 used here are taken from [ ] and are quoted in appendix a.",
    "experimental samples [ ] in which magnetic measurements are performed are in the shape of a flat `` disk '' with rounded edges , and the axis of revolution along the crystallographic @xmath7 axis of the crystal .",
    "this is well approximated by taking @xmath3 to be a flat ellipsoid of revolution ( an oblate spheroid ) .",
    "for an oblate spheroid it is possible to find an analytic expression for the general form of the potential @xmath19 .",
    "therefore , our ideas can be implemented in this geometry in terms of analytic expressions in @xmath14 .",
    "the potential @xmath19 , for @xmath87 , satisfies trivial neumann boundary conditions on @xmath13 , and the solution contains a single parameter which is simply related to @xmath51 .",
    "when the penetration depth is finite , the longitudinal moment does change , but its correct value can in principle be determined from the boundary conditions and the solution inside , either through an iteration process as described in the next section , or , much more efficiently , through the perturbation method we shall develop .",
    "the fundamental equation ( [ maxlon ] ) is not separable in spheroidal coordinates .",
    "( even the vector helmholtz equation is not ) .",
    "still , it is desirable to employ these coordinates as @xmath13 is then described by a single parameter and this significantly simplifies the process of numerically fulfilling the boundary conditions . the simple implementation and discretization of the boundary conditions on @xmath13 yields higher accuracy where it is most needed , since boundary grid points lie on the interface .",
    "we denote the major and minor semiaxes of the spheroid by @xmath88 and @xmath89 respectively , and we have @xmath90 for actual samples .",
    "we take ( see fig .",
    "[ fig1 ] ) a coordinate system fixed to the direction of the magnetic field , with its @xmath6-axis parallel to the @xmath7 crystallographic direction of the superconductor ( and parallel to the @xmath89 semiaxis of an ellipsoid ) .",
    "the field is applied along the @xmath91-axis , and we picture the experiment as being performed by rotating the crystal about the @xmath6-axis and measuring the angular dependence of @xmath4 . as the crystal is rotated the axes @xmath92 remain fixed in space , and should not be confused with the coordinates , affixed to the crystal structure , that we shall also use and denote by @xmath93 , @xmath94 .",
    "we call @xmath95 the angle between axes @xmath91 and @xmath93 .    in the definition we use [ ] ,",
    "the oblate spheroidal coordinates @xmath96 , are related to cartesian coordinates by the transformation    [ coor ] @xmath97 @xmath98 @xmath99    where @xmath100 , @xmath101 , @xmath102 , and @xmath75 is a focal length scale factor ( the coordinates @xmath103 , @xmath104 and @xmath105 are dimensionless ) . in fig .",
    "2 we show this coordinate system at a fixed azimuthal angle @xmath106 .",
    "one can obtain the relation between @xmath103 , @xmath104 , @xmath105 and cartesian coordinates fixed to the crystal by replacing @xmath105 with @xmath107 in ( [ coor ] ) .",
    "for example @xmath108 . the relation between unit vectors in these and cartesian coordinates is    [ unit ] @xmath109",
    "@xmath110 @xmath111    we see that @xmath112 is the unit normal pointing outwards . in the limit @xmath113",
    ", the spheroidal system reduces to the spherical coordinate system . for @xmath75 finite",
    ", the surface @xmath114 becomes spherical as @xmath115 : @xmath116 in the same limit @xmath117 and @xmath118 , where @xmath119 and @xmath120 are spherical coordinates .",
    "various quantities in oblate spheroidal coordinates are given in appendix b.    to construct the general form of the solution for the fields in the region @xmath14 we employ an electrostatic analogy [ ] .",
    "the current distribution is localized within @xmath3 and the magnetic potential in the exterior region can be written as an expansion in the appropriate set of orthogonal functions which in this case are the spheroidal harmonics [ ] ( a generalization of spherical harmonics ) , characterized by angular and azimuthal indices @xmath121 and @xmath122 .",
    "thus we write @xmath123 where @xmath124 and @xmath125 are the associated legendre functions of the first and second kind respectively , and @xmath126 is the potential due to the applied field .",
    "the condition that @xmath127 @xmath128 @xmath129 when @xmath115 yields @xmath130 since for @xmath131 @xmath132 @xmath133 @xmath122 , @xmath121 this fulfills the boundary condition at infinity .",
    "the remaining terms in eq .",
    "( [ figen ] ) are due to the presence of the superconductor . the coefficients @xmath134 and @xmath135 , for example , multiply terms that give rise to magnetic fields associated with dipole moments along @xmath136 and perpendicular to it , respectively . in the limit @xmath49 eq .",
    "( [ figen ] ) simplifies [ ] and the exact solution for @xmath19 is @xmath137 the parameter @xmath138 ( for brevity we omit the upper index @xmath139 ) is determined from the boundary condition @xmath140 at @xmath141 , the surface of the spheroid : @xmath142 @xmath143 is always proportional to @xmath51 , the longitudinal magnetic moment . for an ellipsoid , we show in appendix a that @xmath144    it is instructive to verify that in the linear case the solution on @xmath3 leads to vanishing @xmath145 . from the linear relation between @xmath22 and @xmath23 in eq .",
    "( [ linear ] ) and the anisotropy in @xmath79 as discussed in [ jvv ] , the azimuthal dependence of @xmath23 and @xmath146 is identical .",
    "we can find the @xmath105-dependence of the magnetic moment from eq .",
    "( [ magmom ] ) and the appropriate element of integration given by eq .",
    "( [ domega ] ) .",
    "the @xmath105 variable is separable .",
    "consequently , the @xmath147 integration can be performed analytically and yields @xmath148 .",
    "thus , any transverse component arises from the nonlinear terms . their origin can be seen as follows : the superfluid velocity field has , in the presence of nonlinearities , an azimuthal dependence different from that in the linear case .",
    "this implies that the @xmath105 variable is no longer separable .",
    "the nonlinear terms in ( [ jnl ] ) lead to higher harmonics for the @xmath105 dependence of @xmath23 on @xmath3 .",
    "then , it follows from eq .",
    "( [ londoneq ] ) that there is a small , but nonvanishing transverse field , @xmath149 , with a different azimuthal dependence from that in the linear case , which can contribute to @xmath145 .",
    "therefore the nonlinear response of a superconductor is responsible for @xmath149 and , as a result , for @xmath145 . in @xmath150 ,",
    "the part of @xmath149 from which @xmath145 arises can be described by a transverse dipole , i.e. a potential of the form of the last term in eq .",
    "( [ phiout ] ) , rotated by @xmath151 : @xmath152 where in full analogy to the longitudinal case in eq .",
    "( [ longmag ] ) @xmath153 the potential @xmath154 is the only contribution to @xmath145 from the general expression given by eq .",
    "( [ figen ] ) .",
    "this term is small , @xmath155 ( recall the discussion about @xmath156 from subsection [ moment ] ) and does not exist when the penetration depths vanish , since the nonlinear effects are absent unless the field can penetrate the sample .",
    "higher order multipole terms @xmath157 , as in ( [ figen ] ) do not contribute to the magnetic moment as can be seen from symmetry considerations or by explicit calculation using the orthogonality of @xmath158 .",
    "it is useful to recall explicitly the connection of the @xmath159 with the coefficients in a standard multipole expansion . in the spherical limit given by eq .",
    "( [ limit ] ) these coefficients represent ordinary spherical multipoles . for large enough distances from @xmath3 the asymptotic form of the @xmath160 term",
    "is always a pure dipole . the spherical limit of eq .",
    "( [ phiout ] ) is @xmath161 with @xmath162 where @xmath163 is the sphere radius and we see once more that @xmath164 is proportional to @xmath47 .    for finite @xmath103 ( not necessarily in the spherical limit ) , the magnetic moment of a spheroid is again obtained only from terms with @xmath160 in the eq .",
    "( [ figen ] ) .",
    "the @xmath160 terms , however , have spheroidal symmetry and their radial and angular dependence is not identical to @xmath165 as for a pure dipole in eq .",
    "( [ fis ] ) , they have an admixture of higher spherical multipoles .    at finite @xmath79 the value for @xmath143 ( proportional to @xmath51 from ( [ longmag ] ) ) will be slightly different from @xmath164 , reflecting the difference between @xmath51 and @xmath47 given by eq .",
    "( [ mmma ] ) .",
    "the potential will also acquire additional terms as seen in eq .",
    "( [ figen ] ) .",
    "the longitudinal terms with @xmath166 and all of the transverse terms vanish at @xmath167 , that is , they are of higher order in @xmath42 .",
    "they also vanish in the spherical case but only if @xmath79 is isotropic and the relation @xmath32 is purely linear .",
    "if , in addition , one includes the nonlinear terms in @xmath32 , so that the full relation ( [ figen ] ) applies , then the transverse dipole term appears even in a spherical geometry .",
    "the considerations from the previous section point to a method for obtaining a complete solution for @xmath37 .",
    "this method , although it should work in principle , would naively lead to the need for an iteration which is in practice too cumbersome , and which we discuss here as motivation for introducing the perturbation method obviating the need for it .",
    "the important question here is that of calculating the magnetic dipole moment .",
    "in other boundary value problems to which our method can be extended , one must similarly determine the lowest nonvanishing multipole moments .    to obtain a solution to eq .",
    "( [ maxlon ] ) in the general case when the relation between @xmath22 and @xmath23 is nonlinear , given by eq .",
    "( [ nonlinjv ] ) ( see also ( [ jnl ] ) ) , one can in principle use the following iteration method . as a first step",
    ", one can solve these equations in @xmath3 with boundary conditions on @xmath13 corresponding to the limit @xmath49 .",
    "that can be done by setting @xmath168 ( and all the other @xmath169 ) , requiring continuity of the components @xmath170 and @xmath171 at @xmath141 , and also enforcing the condition on @xmath13 , @xmath172 .",
    "these boundary conditions for the magnetic field are not exactly the desired ones , since continuity of the @xmath103 component can not be demanded because the external field has been specified so that its @xmath103 component vanishes at the boundary .",
    "the magnetic field outside the sample is simply obtained from eq .",
    "( [ outa ] ) with @xmath19 given by ( [ phiout ] ) .",
    "inside one employs eq .",
    "( [ londoneq ] ) to get the magnetic field from @xmath23 .    from the numerical solution in @xmath3",
    ", obtained using the overrelaxation method discussed in [ ] we can compute the magnetic moment by using ( [ magmom ] ) , and the fields from the above approximate solution . the computed value , @xmath173 , the superscript @xmath174 indicating the order of iteration , will be in general different from @xmath175 : the computed magnetic moment is not the input value @xmath47 .",
    "hence , the actual problem has not been solved : the solution is not self - consistent .",
    "one can then imagine obtaining the correct solution from the following iteration process : denote by @xmath176 , @xmath177 the values of these quantities obtained from eqs .",
    "( [ longmag ] ) , eq .",
    "( [ perpmag ] ) and the appropriate components of @xmath173 .",
    "then use @xmath176 , @xmath177 in the computation of the exterior field , and use again this exterior field to solve eq .",
    "( [ maxlon ] ) , repeating the procedure described in the previous paragraph .",
    "the second iteration yields e.g. @xmath178 , @xmath179 which in general would differ from @xmath176 and @xmath177 .",
    "repeated iterations would give sequences @xmath176 , @xmath178 , @xmath180 , ... and @xmath177 , @xmath179 , @xmath181 , ... converging to the desired values of @xmath143 , @xmath182 , when the moment generated by the computed currents equals the input value .",
    "at that point , the magnetic moment will be known .",
    "the higher order @xmath183 will not necessarily be known , but they do not contribute to @xmath37 .",
    "in practice such a procedure could be implemented first for the larger longitudinal component and then for the smaller transverse component .",
    "the procedure described in [ conv ] may be a lengthy and expensive process and it is for this reason that we develop , in this subsection , a procedure to bypass it .",
    "we compute @xmath51 ( accurate to first order in @xmath42 ) in a single iteration step , that is , a single pass through solving the equations inside the body as described above .",
    "the surface integral ( [ m4 ] ) , rather than ( [ magmom ] ) is the expression for @xmath37 that is convenient for our purpose since as seen in subsection [ moment ] , it divides @xmath37 into two terms , @xmath60 and @xmath61 , of different order in @xmath42 .",
    "it follows from the considerations of section [ maxw ] , and it is the basis of our perturbation method , that to obtain @xmath37 correctly to @xmath63 it is sufficient to compute @xmath61 from fields ( i.e. @xmath16 or @xmath23 ) accurate only to zeroth order .",
    "this is , as explained there , because a factor of @xmath42 explicitly scales out of the expression for @xmath61 .",
    "now , since the internal fields obtained by solving eq .",
    "( [ maxlon ] ) at the first iteration level ( as described in the previous subsection , i.e. , with @xmath49 boundary conditions ) are already accurate to the zeroth order , one iteration is sufficient to evaluate @xmath61 at desired accuracy .",
    "the problem reduces , therefore , to that of correctly including the contribution @xmath60 to first order in @xmath42 .    to illustrate how this is done ,",
    "let us recall the general form of the analytic solution for the spheroid .",
    "as seen in section [ geo ] ( eq .",
    "( [ figen ] ) ) it has the form of a multipole expansion with undetermined coefficients .",
    "since the exact field @xmath16 is continuous on @xmath13 we can insert this general form in the expression ( [ m4 ] ) for @xmath60 .",
    "only the @xmath160 terms , by virtue of ( [ longmag ] ) and ( [ perpmag ] ) , contribute to @xmath37 , so that @xmath60 can be evaluated in terms of the unknown @xmath37 .",
    "thus we have @xmath184 where we emphasize that @xmath60 depends on the unknown @xmath160 parameters , and where we introduce the overbar notation to denote quantities evaluated from the zero penetration limit external fields",
    ". since terms of @xmath185 can be neglected , it is possible to interchange @xmath61 and @xmath186 in the various expressions and we have done so . expression ( [ 12 ] ) is an equation for the unknown @xmath37 .    to solve it in practice ,",
    "consider the general form of @xmath19 , eq .",
    "( [ figen ] ) which indicates that @xmath19 ( or equivalently @xmath16 ) can be separated into two parts : @xmath187 , due to the applied field and to the presence of the superconductor , respectively .",
    "we can then write the contribution of these parts as @xmath188 we now define @xmath189 by @xmath190 .",
    "since @xmath191 and @xmath192 are now known , one can determine the constant @xmath189 which depends on the shape of @xmath3 , i.e. on the eccentricity .",
    "in the limit @xmath49 , @xmath193 and from eq .",
    "( [ m1divide ] ) we have the identity @xmath194 for @xmath195 , when the solution for @xmath19 and @xmath16 is given in terms of multipole expansion with unknown coefficients , @xmath196 remains the same .",
    "the only difference in computing @xmath197 is that the coefficients in the terms arising from @xmath198 are now proportional to the correct , but still to be determined , value of the magnetic moment @xmath37 , slightly changed from the @xmath49 case .",
    "all the remaining higher multipoles @xmath199 of @xmath19 , as mentioned in [ geo ] , do not contribute to @xmath37 and we have @xmath200 adding this to @xmath192 we get @xmath201 we can express eq .",
    "( [ magmoms ] ) using ( [ mp ] ) as @xmath202 so that we have the solution for @xmath37 correct to @xmath203 , @xmath204 which determines all components of @xmath37 .",
    "we illustrate this method using the textbook example of the isotropic , linear superconducting sphere in a uniform applied field @xmath1 , along the x - axis . in this case",
    "all the fields in @xmath3 satisfy the vector helmholtz equation : @xmath205 where @xmath206 can be @xmath207 . on the entire @xmath208 region",
    ", @xmath198 has a pure dipole form and @xmath16 is given by taking the gradient of eq .",
    "( [ fis ] ) :    [ hs ] @xmath209 @xmath210 @xmath211    where @xmath119 , @xmath120 , @xmath212 are spherical coordinates , and @xmath122 a parameter to be determined .",
    "this is the general solution for any @xmath42 ( not just 0 ) , in the field outside ; there is only a dipole term in addition to that due to applied field .",
    "even if there were higher spherical multipoles in the general solution , that would not affect the evaluation of @xmath213 , since their contribution to @xmath37 would vanish identically by symmetry . in the limit where the current does not penetrate into the superconductor , the magnetic moment",
    "is given by @xmath214 ( recall ( [ mos ] ) ) . performing the elementary integral for @xmath215 in eq .",
    "( [ magmoms ] ) we obtain @xmath216 comparing with ( [ mp ] ) we identify @xmath217 in this case and using eq . ( [ mwithp ] ) @xmath218 to determine the unknown @xmath122 to @xmath203 it remains to compute @xmath219 and substitute it in ( [ ms ] ) .",
    "using the evaluation for @xmath219 , with the boundary conditions taken in the @xmath49 , from appendix c we get the perturbation result for @xmath122 : @xmath220 where @xmath221 . if we compare this to the expression for @xmath51 given by eq .",
    "( [ mmma ] ) we can read off @xmath222 .",
    "this is the correct value for a sphere to this order , as given in textbooks [ ] .",
    "thus , using the perturbation method with approximate boundary conditions in the evaluation of @xmath68 , we have obtained the correct value for @xmath122 to first order in @xmath42 .",
    "it is also instructive to calculate @xmath122 analytically , with internal fields evaluated from ( [ maxlon ] ) and @xmath49 boundary conditions , eq .",
    "( [ m4 ] ) .",
    "the calculation would yield @xmath122 correct only to @xmath223 ; the value of @xmath52 is not correct ; one gets @xmath224 instead of @xmath222 .",
    "we return now to the oblate spheroid . in @xmath3",
    "we allow the full nonlinear relation between @xmath22 and @xmath23 , given by eq .",
    "( [ jnl ] ) . the magnetic field in @xmath14 that contributes to the computation of @xmath37",
    "is given in appendix [ field ] .",
    "we aim to obtain the appropriate perturbation equation ( [ mwithp ] ) relating the unknown magnetic moment to @xmath225 , the term computed from the numerical solution in @xmath3 ( using the first step in the iteration procedure , described in the previous subsection ) . to calculate the magnetic moment , we proceed as with the sphere example .",
    "we first evaluate the term @xmath60 from eq .",
    "( [ magmoms ] ) , recalling eqs .",
    "( [ a1 ] ) , ( [ longmag ] ) , ( [ perpmag ] ) and @xmath226 . the integral , evaluated in spheroidal coordinates using ( [ domega ] ) , is elementary and we give only the result .",
    "the corresponding perturbation equation for @xmath37 is , from ( [ mwithp ] ) : @xmath227 or , writing its components explicitly :    [ me ] @xmath228 @xmath229    with @xmath230 @xmath231 is evaluated at the surface of the ellipsoid @xmath232 . as shown in appendix [ mom ] ,",
    "@xmath233 is related to the eccentricity of the spheroid . in the spherical limit when @xmath115 we recover the spherical result , @xmath234 , obtained earlier .",
    "another interesting limit is that of a flat disk @xmath235 where @xmath236 . as discussed previously , @xmath237 for @xmath238 .",
    "the above method applies not only to oblate spheroids , but to all geometries for which a general solution for @xmath19 in @xmath239 as an expansion in terms of orthogonal functions , ( only one of them being dipolar at large distances ) can be written .",
    "furthermore , the method can be extended , with one additional assumption , to a situation where the shape of @xmath3 precludes an analytic solution for the outside fields even at @xmath49 , and only a numerical solution , @xmath240 , in that limit is available .",
    "we assume that , as in the analytic cases , the coordinate dependence of the terms in @xmath19 which contribute to the dipole @xmath37 remains the same , up to a multiplicative constant , for @xmath49 and @xmath241 .",
    "this assumption requires that the shape of @xmath3 produces no singularities in the fields .",
    "this might be a sufficient condition , but we know of no rigorous proof .    the magnetic field at large distances , @xmath242 , has the form given in eq .",
    "( [ fis ] ) , @xmath47 is the magnetic moment for @xmath3 , and all the higher multipoles can be neglected .",
    "we can again , as above ( [ m1divide ] ) separate @xmath243 , where @xmath126 is the applied field contribution . at @xmath242",
    ", @xmath244 is of dipolar form and the value of @xmath47 can be in principle numerically extracted either by using the left part of ( [ m1zero ] ) or from the asymptotic form . for @xmath195",
    "the potential @xmath19 has asymptotically the same dipolar form as @xmath240 , but the unknown dipolar coefficient @xmath37 differs from @xmath245 .",
    "one can then proceed as in the analytic case .",
    "consider as an illustration , the computation of @xmath51 to @xmath203 .",
    "we can implement the method by writing the potential at @xmath195 in the form : @xmath246 where @xmath247 is a possible contribution to higher order multipoles only .",
    "( [ near ] ) merely expresses our assumptions in mathematical form .",
    "it can be better understood by recalling the discussion in section [ geo ] ( and above in this section ) in particular the difference between @xmath164 and @xmath143 .",
    "since @xmath47 is known , one can use @xmath126 to evaluate @xmath248 ( see ( [ m1divide ] ) ) and hence the quantity @xmath189 through @xmath249 . from the distribution of @xmath23 on @xmath13",
    "we compute @xmath250 and eq .",
    "( [ mwithp ] ) gives the desired @xmath251 .",
    "we see therefore that our method has considerable generality and our results can be summarized in terms of the following @xmath252 , the validity of which follows from the analysis in this section and the decomposition of @xmath37 in [ moment ] .",
    "let us assume that : + a ) there exist a small parameter @xmath42 @xmath253 1 and we consider eq .",
    "( [ maxlon ] ) in @xmath3 that allows a sufficiently accurate solution in @xmath14 for ( [ outb ] ) with trivial neumann boundary conditions on @xmath13 , and at infinity @xmath254 , which satisfies the assumption discussed in connection with ( [ near ] ) .",
    "+ b ) @xmath16 in the interior of @xmath3 decreases with the distance from @xmath13 not slower than exponential dependence given by a characteristic length @xmath253 typical size of @xmath3 + then the following statements are true :    1.it is possible to write @xmath255 as given by ( [ magmoms ] ) where @xmath213 is o@xmath256 and @xmath68 is o(@xmath64 ) .",
    "+ 2 . to obtain @xmath37 from eq .",
    "( [ mwithp ] ) accurate to o(@xmath64 ) it is sufficient to calculate the leading contribution to the term @xmath257 , the error in determining @xmath37 being of o(@xmath258 ) .",
    "this perturbation method can be applied outside the field of superconductivity .",
    "for example , it is well known [ ] that an ordinary conductor in a high frequency , harmonic applied magnetic field ( the frequency should satisfy quasi - static condition @xmath259 ) behaves like a superconductor in a constant field .",
    "it is then possible to identify the small parameter , @xmath44 as the ratio of skin depth , @xmath260 , the typical length scale for field penetration in the conductor and the characteristic geometrical dimension , @xmath39 .",
    "the computation of the magnetic field distribution is then achieved by solving the corresponding steady - state problem for a superconductor of the same shape , and @xmath37 can be obtained using eq .",
    "( [ mwithp ] ) .",
    "in performing the calculations and describing the results , it is convenient to introduce dimensionless quantities .",
    "we recall that @xmath3 is a flat spheroid and with the magnetic field applied in the @xmath92 ( @xmath5 ) plane , most of the current will flow parallel to the @xmath5 plane and its decay will be governed by @xmath85 .",
    "it is therefore convenient to measure the length in the units of @xmath85 .",
    "we then define dimensionless fields @xmath261 , @xmath262 , and @xmath263 : @xmath264 where @xmath265 is the critical velocity ( discussed in appendix a ) , @xmath266 is the amplitude of the order parameter , defined in appendix a , and we have introduced a characteristic magnetic field @xmath267 as @xmath268 where @xmath269 is the flux quantum and @xmath270 is the in - plane superconducting coherence length ( not to be confused with @xmath103 , the spheroidal coordinate ) .",
    "the definition ( [ h0 ] ) involves precisely the same numerical factors as that used in [ , ] .",
    "the required equations are easily rewritten in terms of these quantities .",
    "equation ( [ maxlon ] ) , using the relation between @xmath22 and @xmath23 given by ( [ jnl ] ) , then becomes    [ maxlon2 ] @xmath271 @xmath272    where @xmath273 and we define @xmath274 as the terms nonlinear in the velocity . the equations are written in terms of the primed coordinates and the derivatives are with respect to the dimensionless length measured in units of @xmath85 .    before discretizing eqs .",
    "( [ maxlon2 ] ) we transform them to oblate spheroidal coordinates .",
    "we start by writing these equations in the unprimed @xmath275 coordinate system where , we recall , the @xmath91-axis lies along the applied field .",
    "the linear part of the equations looks identical in primed or unprimed coordinates and we only need to carefully transform @xmath276 to @xmath277 , @xmath278 and @xmath279 terms nonlinear in the velocity along the unit vectors @xmath280 , @xmath281 and @xmath282 respectively .",
    "we have    [ npart ] @xmath283 @xmath284 @xmath285    where @xmath286 , @xmath287 and @xmath288 . or , if we express the components of velocity in spheroidal coordinates :    [ vesp ] @xmath289    @xmath290    @xmath291    where @xmath292 and @xmath293 . we can now write the nonlinear part ( from equation ( [ maxlon ] ) and ( [ npart ] ) ) along each spheroidal coordinate .",
    "for example , along @xmath294 we get @xmath295 @xmath296 are entirely expressed in terms of spheroidal components as shown above . in an analogous way we can obtain the remaining nonlinear parts @xmath297 .    using eqs .",
    "( [ unit ] ) we transform the inverse of the penetration depth tensor given in cartesian coordinates by a diagonal tensor with components @xmath298 , ( recall eq .",
    "( [ linear ] ) ) to spheroidal coordinates :    @xmath299\\ ] ]    where @xmath300 are defined by    [ tensor ] @xmath301 @xmath302 @xmath303    the resulting form of the dimensionless equations in spheroidal coordinates ( which we will solve numerically ) is    [ eqsp ] @xmath304",
    "@xmath305    @xmath306    expressions for the differential operator @xmath307 in spheroidal coordinates are included in appendix [ other ] .",
    "equations ( [ eqsp ] ) have to supplemented with appropriate boundary conditions , as discussed in section ii .",
    "the boundary condition at infinity is satisfied by the use of the analytic solution for @xmath14 . since @xmath308 we can put @xmath309 at @xmath310 , as all the fields vanish deep inside the sample .",
    "continuity of the @xmath311 field on @xmath59 is achieved through @xmath312 where the right hand side is the external dimensionless field at the surface of the ellipsoid .",
    "the remaining boundary condition @xmath313 @xmath314 on @xmath13 is generally nonlinear and readily enforced by observing that the rhs of eq .",
    "( [ eqspa ] ) is @xmath315 .",
    "the implementation of the perturbation method from section [ comp ] is not restricted to a particular algorithm for solving the relevant equations in @xmath3 . in the remaining part of this section we outline as an example one suitable algorithm using a modification of the gauss - seidel relaxation method .",
    "we first discuss the discretization of the complete nonlinear , three - dimensional ( 3d ) problem .",
    "it is then possible to consider , as a special case , the two - variable discretization of the linear problem were the @xmath105 dependence is known analytically .",
    "the numerical solution to such a problem is then used as the initial guess for the relaxation method of the complete 3d problem .",
    "( [ eqsp ] ) or their counterparts ( [ maxlon ] ) and ( [ jnl ] ) , have definite parity : @xmath316 , @xmath317 are even and @xmath318 is odd in @xmath6 .",
    "it is therefore sufficient to consider only the upper , _ positive z _ ( @xmath319 ) , or the lower , _ negative z _ ( @xmath320 ) half of @xmath3 and extend by parity the obtained solution to the whole @xmath3 .",
    "the computational domain @xmath321 is obtained by parameterizing the physical domain @xmath322 using oblate spheroidal coordinates ( @xmath103 , @xmath104 , @xmath105 ) .",
    "we consider a uniform grid on @xmath321 with mesh widths @xmath323 , @xmath324 and @xmath325 .",
    "the choice of a grid uniformly spaced in variable @xmath104 , generates denser grid points corresponding to the part of @xmath322 ( the @xmath326 region ) with higher curvature and greater field variation . an arbitrary grid point on @xmath321",
    "is given by ( @xmath327 , @xmath328 , @xmath329 ) or just @xmath330 for brevity : @xmath331 where the grid coordinates are given by @xmath332 and the indices run through values @xmath333 , @xmath334 and @xmath335 .",
    "mesh widths are given by @xmath336 , @xmath337 and @xmath338 .",
    "the discrete variables are denoted by the same symbol as their continuous counterparts , for example , @xmath339 represents @xmath340 at the grid point ( @xmath327 , @xmath328 , @xmath329 ) .",
    "the discretized approximations of derivatives used have second order accuracy in the mesh widths .",
    "we will use the letter @xmath341 to represent the discretized approximation , upper indices @xmath342 denote the central , forward and , backward approximation respectively , and the lower indices denote the corresponding variables of differentiation .",
    "for example , @xmath343 denotes the mixed differentiation with respect to @xmath103 and @xmath104 , where the central difference formula is used in @xmath103 and the forward difference formula in @xmath104 variable . for the interior grid points we only use the central difference formula for all the derivatives and omit the upper indices .",
    "we also use central differences for derivatives at all the grid points on @xmath344 that do not require introduction of fictitious grid points @xmath345 . for example , in computing @xmath346 at @xmath347 we would need to use a grid point at @xmath348 @xmath349 @xmath321 , we avoid that by using a backward difference @xmath350 at @xmath351 .",
    "similarly we employ forward differences were necessary .      the grid boundary , @xmath344 , consists of six two - dimensional planar surfaces with grid points described by @xmath352 , @xmath347 , @xmath353 , @xmath354 , @xmath355 and @xmath356 .    on the surface @xmath310 , @xmath352 , which corresponds to the equatorial @xmath357 disk in @xmath3 with radius equal to the focal length @xmath75 , we impose trivial dirichlet boundary conditions . as we have discussed in section ii , this follows from the requirement that deep inside @xmath3 all fields should vanish .",
    "this eliminates possible difficulties from the singularities of the various differential operators at @xmath310 .",
    "any remaining singularities of the equations on @xmath321 would come from points with coordinates @xmath358 and @xmath359 . on the surface @xmath358 @xmath360 , corresponding to part of the @xmath361 plane , we have from the known parity of @xmath261 :    [ parity ] @xmath362",
    "@xmath363    we implement eq .",
    "( [ parityb ] ) as @xmath364 : @xmath365 and in the iterative solution we write down explicitly @xmath366 from this expression .",
    "the remaining region on @xmath321 that could result in singularities of the differential operators is at @xmath367 , which corresponds to a line through the  south pole \" and the origin of @xmath3 , i.e. , a segment starting at the origin and ending at a point with cartesian coordinates @xmath368 . the choice of grid given in eq .",
    "( [ coord ] ) excludes this segment , the closest point on the grid is @xmath369/2 away .",
    "the numerical solution for @xmath261 in the vicinity of @xmath367 is well behaved ( as it is for the linearized equations in the geometries that permit an analytic solution in @xmath3 ) .",
    "it is therefore possible to extrapolate the obtained numerical solution to @xmath367 . at the grid boundary surface",
    "@xmath370 we use the forward difference formula for the derivatives with respect to @xmath104 , @xmath371 is obtained analogous to eq .",
    "( [ back ] ) by replacing @xmath369 with @xmath372 and the indices @xmath373 , @xmath374 by @xmath375 and @xmath376 respectively .",
    "the second derivative @xmath377 is taken as : @xmath378 where @xmath379 represents any component of a vector field .",
    "we can obtain similar formulae for @xmath343 and @xmath380 .",
    "at the surface boundary @xmath381 , where @xmath382 , we proceed in an analogous way , the derivatives with respect to @xmath105 are expressed with forward differences .",
    "the other part of @xmath344 with @xmath383",
    "i.e. , @xmath384 corresponds to the same boundary surface ( @xmath382 ) and we can impose the simple periodic boundary conditions @xmath385 on the remaining part of @xmath344 , the surface @xmath386 at @xmath141 , we impose continuity ( as discussed in section iv ) of the @xmath104 and @xmath105 components of @xmath311 . from eq .",
    "( [ lon2 ] ) we can express @xmath387 and @xmath388 respectively to obtain their updated values in each step of the relaxation procedure .",
    "the equation for @xmath389 is obtained from @xmath390=0 by setting the rhs of eq .",
    "( [ eqspa ] ) to zero @xmath391 in the relaxation procedure , the nonlinear term @xmath392 is included using picard s method [ ] , the value of @xmath392 is taken from the previous iteration .",
    "if we denote by an upper index @xmath393 the number of the iteration ( in the relaxation procedure ) , the nonlinear boundary condition can be implemented as @xmath394 the nonlinear and nonanalytic terms can be simply included by using picard s method .",
    "in addition to the nonlinear boundary condition ( [ picard ] ) we shall also use picard s method to include the nonlinearities stemming from eq . ( [ eqsp ] ) .    for the grid",
    "points @xmath349 @xmath344 it is possible to use central differences . in the lhs of eq .",
    "( [ eqsp ] ) , given explicitly in appendix c , we replace each partial derivative by the appropriate central difference , @xmath341 .",
    "the solution to the nonlinear , 3d problem using the relaxation method consists of two steps .",
    "the first is obtaining a good initial guess using the numerical solution to the linear equations given by eq .",
    "( [ maxlon ] ) and ( [ linear ] ) .",
    "the @xmath105 dependence is then known and it can be separated out .",
    "the method of successive overrelaxation can be applied to the resulting two - variable problem in the coordinates @xmath103 and @xmath104 .",
    "the boundary conditions on the continuity of @xmath395 , as discussed in the previous subsection , are implemented : the magnetic field outside is taken in the @xmath49 limit ( @xmath396 ) . in the relaxation procedure",
    "each component of @xmath261 is expressed in terms of the corresponding component of the linearized ( @xmath397 ) , two - dimensional form of eq .",
    "( [ eqsp ] ) so that the resulting matrix equation is diagonally dominant [ ] . for a detailed discussion of the method see [ ] .",
    "the numerical solution , the distribution of @xmath398 , is supplemented with the known @xmath105 dependence and @xmath251 is calculated using the perturbation method .",
    "the second part of the algorithm is a modification of the gauss - seidel ( the overrelaxation parameter , @xmath399 ) method for the full 3d problem .",
    "the previously obtained solution for the linearized equations is the initial guess for @xmath400 , and the value @xmath251 i.e. , the corresponding @xmath143 , is used in the expression for the @xmath311 outside . if we denote the linear part of eq .",
    "( [ eqsp ] ) as @xmath401 and the nonlinear part as @xmath402 the relaxation procedure can be described symbolically as : @xmath403 after completion of each relaxation step we update the old values , @xmath404 , at each grid point as @xmath405 . as done with the boundary condition from eq .",
    "( [ picard ] ) we use picard s method to include the nonlinear terms which are also nondifferentiable .",
    "the numerical solution for the linearized equations is a very good initial guess for the full problem , since the nonlinear terms are small , which compensates for the relatively slow convergence of picard s method .",
    "for our computations we used the cray c90 of the minnesota supercomputer institute .",
    "we first tested the computer code on the example of the linear , isotropic sphere with applied field along the @xmath91 axis , where the analytic solution is known .",
    "the spherical geometry was realized as the spherical limit of the spheroid .",
    "we used @xmath406 and @xmath407 , so that the radius of sphere was @xmath408 ( in units of @xmath40 ) , the corresponding @xmath409 and the ratio of the spheroidal semi - axes is @xmath410 .",
    "we used the two - variable version of the code in the variables @xmath103 and @xmath104 .",
    "the computational grid spanned a spherical shell of thickness 7 @xmath411 , and because fields decay exponentially away from the surface , we imposed trivial dirichlet conditions at @xmath412 .",
    "we used @xmath413 and @xmath414 for the number of grid points . to test the convergence of the relaxation algorithm",
    ", we tried the very poor initial guess of zero fields everywhere on @xmath321 .",
    "the boundary conditions were taken in the @xmath49 limit , that is @xmath168 from eq .",
    "( [ a1 ] ) .",
    "the overrelaxation parameter was @xmath415 and after 1000 relaxation steps ( 43 sec of cpu time ) we obtained @xmath37 using eq .",
    "( [ magmoms ] ) and the perturbation method with eq .",
    "( [ ms ] ) . in the term",
    "@xmath61 the distribution of @xmath416 at @xmath141 ( from the numerical solution on @xmath321 ) was extended by parity to the entire @xmath13 and supplemented with the known @xmath105 dependence .",
    "thus , integration over @xmath105 was performed analytically and that with respect to @xmath104 , numerically . the extracted constant ( from eq .",
    "( [ ms ] ) ) was @xmath417 , within @xmath418 of the analytically obtained value of @xmath419 from eq .",
    "( [ exact ] ) .",
    "the use of a conventional procedure to compute @xmath122 would require repeating the whole iteration procedure to get an improved value for @xmath53 , as we have in principle described in [ per ] .",
    "we also verified that the numerical solution for the full three - variable problem in this geometry and exact boundary conditions , has the correct form .",
    "the angular dependence of the solution was @xmath420 , @xmath421 @xmath422 and @xmath423 , @xmath424 @xmath425 which in the spherical limit @xmath426 corresponds to the analytical solution for a sphere .",
    "the numerical solution , for the range of grids considered , was accurate between three and four significant figures for every grid point where @xmath262 @xmath427 was numerically significant .    for the physical results related to the nonlinear response of an oblate spheroid we refer to [ ] , and discuss here only some aspects not covered there , that illustrate the numerics .",
    "analysis of the transverse magnetic moment shows that [ ] @xmath428 from which we infer that @xmath429 , where @xmath430 is the angular dependence on @xmath95 which has [ ] period @xmath431",
    ". we will give results for @xmath432 , approximately the maximum of @xmath379 .",
    "the longitudinal moment , due to field penetration , differs from @xmath47 and it can be characterized , as we have shown earlier , by the parameter @xmath53 .",
    "this parameter includes contributions from the linear part of @xmath433 , independent of @xmath2 , and from the nonlinear part , dependent both on @xmath434 and on @xmath95 .",
    "we consider an oblate spheroid with @xmath435 @xmath436 at @xmath437 ( in the experimentally relevant range ) and @xmath432 . for @xmath438 ( in units of @xmath85 , defined in [ jvv ] and [ dform ] ) we have used @xmath439 , @xmath414 and @xmath440 .",
    "the results for @xmath53 and @xmath54 are given as a function of the material parameter @xmath441 in table i. for fixed @xmath233 ( fixed shape ) , we have considered various sizes of spheroid ( different @xmath75 ) , changing @xmath442 by a factor of four ( at fixed @xmath443 ) and verified that @xmath53 , @xmath54 are size independent within numerical accuracy .    in the next two figures we display some of the numerical results for the field distributions calculated under the same conditions and with the same parameter values as in the previous paragraph . in fig .",
    "3 , we show results for the current at surface of the spheroid , ( @xmath141 ) . the components @xmath444 , at the fixed azimuthal angle @xmath445 , are shown as functions of @xmath104 . for comparison",
    "we recall here also the corresponding angular behavior for a sphere , as given earlier in this section . in fig .",
    "4 we show some results for the magnetic field as it penetrates into the sample .",
    "we plot the two components @xmath446 as functions of @xmath447 at constant @xmath106 , @xmath448 , ( see fig .",
    "2 ) . the plot illustrates the difference between the components of the field arising purely from the linear equations and those which are due to the nonlinear effects .",
    "the component @xmath449 ( at @xmath106 ) is very predominantly `` linear '' , and displays exponential - like behavior .",
    "the other component plotted , @xmath450 , vanishes in the linear case ( at @xmath106 ) , and it arises solely from the nonlinear effects .",
    "this behavior is far from being an exponential ; its derivative changes sign , for the same physical reasons as the nonlinear current does , as discussed in [ ] .",
    "in this paper , as the main result , we have presented a perturbation method to compute the magnetic moment of a bulk nonlinear and anisotropic superconductor .",
    "this method could be implemented in conjunction with various algorithms for solving boundary value problems in electrodynamics .",
    "suitable generalizations would certainly increase the range of its applicability from that discussed in this paper .",
    "obvious examples include considering in detail other shapes of @xmath3 and computing higher order multipoles .",
    "we have showed that our method increases the accuracy of computation while very significantly reducing the required computational work .    in this paper",
    "the numerical example of an oblate spheroidal geometry was discussed in detail to illustrate the perturbation method and also to give guidelines for possible improvements .",
    "the numerical algorithm which was employed for solving the nonlinear maxwell - london equations provided more than sufficient accuracy , as seen from experimental considerations : the uncertainty of the input experimental parameters significantly exceeds the accuracy of the results obtained . for our computations",
    "we have used cray c90 and memory requirements were not the limiting factor .",
    "it is however possible to make various improvements to the numerical algorithm .",
    "one could consider nonuniformly spaced grid points along the @xmath103 coordinate , denser close to the @xmath141 , in order to reduce the overall number of grid points .",
    "it might also be advantageous to replace the gauss - seidel relaxation on @xmath321 by some other method , such as gmres [ ] or one of the various multigrid algorithms [ ] . in future work we will consider some of these improvements and investigate possible generalizations of the perturbation method presented in this paper .",
    "we thank a. bhattacharya , a.m. goldman , b. bayman and b.p .",
    "stojkovi for discussions concerning experimental and theoretical aspects of our work and b. f. schaudt for help with preparing the figures .",
    "i.  . acknowledges support from the stanwood memorial fellowship .",
    "in order to express @xmath32 from eq .",
    "( [ nonlinjv ] ) , we introduce two coordinate systems : @xmath92 , fixed in space such that the applied field is along the @xmath91-axis , and @xmath452 which is fixed to the crystal .",
    "we consider an order parameter of the so called @xmath39-wave form : @xmath453 where @xmath212 is the azimuthal angle referred to a node and @xmath266 the gap amplitude .",
    "it has been shown [ ] that in the field range of experimental interest and with suitable assumptions for the fermi surface , eq .",
    "( [ nonlinjv ] ) can be rewritten , at sufficiently low temperatures as    [ jnl ] @xmath454",
    "@xmath455    where @xmath456 and @xmath457 are constants , @xmath458 , @xmath459 . the critical velocity is @xmath265 .",
    "we define here @xmath460 and @xmath461 .",
    "we show here that the expression for the longitudinal magnetic moment for an oblate spheroid , given by eq .",
    "( [ longmag ] ) , is equivalent to the standard result expressed in terms of the demagnetization factors . for a field applied along the @xmath91 axis , in the limit @xmath167 , we have @xmath462 [ ] : @xmath463 where v is the volume of a spheroid and @xmath464 is the appropriate demagnetization factor .",
    "the eccentricity is given by @xmath465^{1/2}=1/ \\xi_0 $ ] . in terms of spheroidal",
    "coordinates we have @xmath466 , @xmath467 and @xmath468 .",
    "including these expressions in eq .",
    "( [ mx ] ) we get @xmath469 and we recover @xmath470 .",
    "the metric coefficients in oblate spheroidal coordinates are given by [ ] :    [ metric ] @xmath471",
    "@xmath472 @xmath473    one can then calculate the appropriate elements of integration and differential operators .",
    "for example , @xmath474 @xmath475 @xmath233 corresponds to the value of @xmath103 at the boundary @xmath476 .",
    "the gradient is @xmath477    to solve equations ( [ maxlon ] ) the expression @xmath478 should be transformed to oblate spheroidal coordinates : @xmath479    @xmath480    @xmath481    we recall that @xmath75 is the focal length scale factor .",
    "the coefficients @xmath482 are given by ( using the abbreviations @xmath483 , @xmath484 , @xmath485 ) : @xmath486      we write down here explicitly the contributions to the magnetic field which arise from the potential @xmath19 given by the sum of ( [ phiout ] ) and ( [ phiout2 ] ) . from eq .",
    "( [ outa ] ) and ( [ nabla ] ) we have    [ he ] @xmath487 @xmath488 @xmath489    where the functions @xmath490 , @xmath491 are given by :    [ ff ] @xmath492",
    "@xmath493 @xmath494 @xmath495    terms with @xmath496 and @xmath497 represent the longitudinal part of @xmath16 and those with @xmath498 and @xmath499 the transverse part .",
    "we evaluate here the magnitude @xmath502 for the example of an isotropic spherical superconductor with a linear @xmath32 relation .",
    "we take the field along the @xmath6 direction , since the magnetic moment @xmath68 is independent of this choice . as explained in the text",
    ", we must find the internal fields by solving ( [ maxlon ] ) ( which in this case reduces to the helmholtz equation ) with boundary conditions enforcing continuity of @xmath503 and @xmath504 and external fields calculated in the @xmath49 limit . by symmetry , @xmath505",
    "and we need only to impose the continuity of @xmath506 at the boundary , @xmath507 .",
    "we obtain : @xmath508 a is a constant to be determined and @xmath47 is given by eq .",
    "( [ mos ] ) . since @xmath509 we can approximate @xmath510 . keeping only the leading term in the lhs of eq .",
    "( [ heta ] ) we get @xmath511 and @xmath512 we can now compute @xmath513 integration is performed in spherical coordinates giving @xmath514 this result ( o(@xmath515 ) ) was expected since for exponentially decaying fields , integration over the whole volume of @xmath3 is effectively only integration over the region @xmath516 away from its surface .",
    "landau and e.m .",
    "lifshitz , _ electrodynamics of continuous media _ , pergamon , oxford , ( 1960 )",
    ". numerical simulations of superconductors outside of the meissner regime are investigated in : h.g .",
    "kaper and m. k. wong , j. comput . phys .",
    "* 119 * , 120 , ( 1995 ) , w. d. grapp , h.g .",
    "kaper , g. k. leaf , d. m. levine , m. palumbo and v. m. vinokur , j. comput . phys . * 123 * , 254 ( 1996 ) s.k . yip and j.a .",
    "sauls , phys .",
    "rev . lett . * 69 * , 2264 , ( 1992 ) .",
    "b.p . stojkovi and o.t .",
    "valls , phys .",
    "rev . * b51 * , 6049 , ( 1995 ) .",
    "d. xu , s.k . yip and j.a .",
    "sauls , phys rev .",
    "* b51 * , 16233 , ( 1995 ) .",
    "i. uti and o.t .",
    "valls , phys . rev . *",
    "b54 * , 15550 ( 1996 ) .",
    "plakida , _ high temperature superconductivity _ , ( springer , berlin , 1995 ) .",
    "j. buan , b.p .",
    "stojkovi , n.e .",
    "israeloff , c.c .",
    "huang , a.m. goldman , and o.t .",
    "valls , phys .",
    "lett . * 72 * , 2632 , ( 1994 ) .",
    "f. london , _ superfluids _ , ( john wiley , new york , 1950 ) , vol . 1 .",
    "orlando and k.a .",
    "delin , _ foundations of applied superconductivity _ , ( addison - wesley , reading , 1991 ) . p.g .",
    "degennes , _ superconductivity of metals and alloys _ ( addison - wesley , reading , 1989 )",
    "reitz , f.j .",
    "milford , and r.w .",
    "christy , _ foundations of electromagnetic theory _ , ( addison - wesley , reading , 1989 ) .",
    "jackson , _ classical electrodynamics _ , ( john wiley , new york , 1975 ) , p. 181 .",
    "a. fetter and j.d .",
    "walecka , _ theory of many particle systems _ , ( mcgraw - hill , new york , 1971 ) .",
    "jackson , _ classical electrodynamics _ [ ] inside cover .",
    "a. bhattacharya , d. grupp , a.m. goldman , and u. welp , appl .",
    ". lett . * 59 * , 7092 ( 1996 ) .",
    "w. magnus and f. oberhettinger , _ formulas and theorems for the functions of mathematical physics _ , ( chelsea , new york , 1949 ) .",
    "lebedev , _ special functions and their applications _ , ( dover , new york , 1972 ) .",
    "w.h . press _",
    "et al _ , _ numerical recepies in fortran _ , ( cambridge university press , new york , 1992 ) .",
    "smith , _ numerical solution of partial difference equations : finite difference methods _ , ( oxford university press , oxford , 1985 ) .",
    "jain , _ numerical solution of differential equations _ , ( john wiley , new york , 1984 ) , p. 356 .",
    "g. sewell , _ the numerical solution of ordinary and partial differential equations _ , ( academic press , san diego , 1988 ) , p. 152 . y. saad and m.r .",
    "schultz , siam j. sci .",
    "stat . comput .",
    "* 7 * , 856 ( 1986 ) .",
    ".the parameters @xmath53 , @xmath54 which determine the magnetic moment for @xmath195 ( see eq .",
    "( ) , given as functions of the material parameter @xmath517 , computed for an oblate spheroid with @xmath518 at a field @xmath519 . [ cols=\"^,^,^ \" , ]"
  ],
  "abstract_text": [
    "<S> we present a method to compute the magnetic moment of a bulk , finite - size , three - dimensional , anisotropic superconductor . </S>",
    "<S> our numerically implemented perturbative procedure is based on a solution of the nonlinear maxwell - london electrodynamic equations , where we include the nonlinear relation between current and gauge invariant velocity . </S>",
    "<S> the method exploits the small ratio of the finite penetration depths to the sample size . </S>",
    "<S> we show how to treat the open boundary conditions over an infinite domain and the continuity requirement at the interface . </S>",
    "<S> we demonstrate how our method substantially reduces the computational work required , and discuss its implementation to an oblate spheroid . </S>",
    "<S> the numerical solution is obtained from a finite - difference method . </S>",
    "<S> we briefly discuss the relevance of this work to similar problems in other fields .    7808 , 78a25 , 65n06 + maxwell - london electrodynamics , superconductivity , magnetic moment , perturbation method , nonlinear partial differential equations , finite - differences , spheroidal geometry . </S>",
    "<S> + nonlinear magnetic moment of a 3d superconductor +   +   + oriol t. valls + school of physics and astronomy and minnesota supercomputer institute + university of minnesota + 116 church street s.e . </S>",
    "<S> + minneapolis , minnesota 55455 - 0149 + email : otvalls@maroon.tc.umn.edu + fax : ( 612 ) 624 - 4578 </S>"
  ]
}