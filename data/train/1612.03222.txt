{
  "article_text": [
    "nanophotonic devices are typically designed by starting with an analytically designed structure , and hand - tuning a few parameters @xcite . in recent years , it has become increasingly popular to automate this process with the use of powerful optimization algorithms . in particular , by searching the full space of possible structures , it is possible to design devices with higher performance and smaller footprints than traditional devices @xcite .    a major challenge when designing devices with arbitrary topologies is ensuring that the structures remain fabricable .",
    "many of these computationally designed structures have excellent performance when fabricated using high - resolution electron - beam lithography , but they have features which are difficult to resolve with industry - standard optical lithography @xcite .    meanwhile , robust and efficient power splitters are essential building blocks for integrated photonics .",
    "a variety of @xmath6 splitters with attractive performance have been demonstrated on the silicon photonics platform , ranging from conventional devices @xcite to those designed using advanced optimization techniques @xcite .",
    "however , it is not possible to split power equally into an arbitrary number of waveguides by cascading @xmath6 splitters , and efficient devices that fill this gap are lacking in the literature .",
    "building on our previous work @xcite , we propose an inverse design method for nanophotonic devices that incorporates fabrication constraints .",
    "our algorithm achieves an approximate minimum feature size by imposing curvature constraints on dielectric boundaries in the structure .",
    "we then demonstrate the capabilities of our method by designing and experimentally demonstrating a broadband @xmath0 power splitter .",
    "the splitter has no small features , and should be fabricable by any modern cmos photonics process .",
    "due to the complexity of accurately modelling lithography and etching processes , most attempts to incorporate fabrication constraints into computational nanophotonic design have focused on heuristic methods .",
    "one approach is to restrict the design to rectangular pixels which are larger than the mininum allowable feature size @xcite .",
    "the resulting manhattan geometry , however , is restrictive and likely not optimal for optical devices .",
    "another method involves applying a convolutional filter to the design followed by thresholding @xcite , which can introduce artifacts smaller than the desired feature size .",
    "the approach used in this work is to impose curvature constraints on the device boundaries , which avoids the aforementioned issues .",
    "curvature limits have been successfully applied in earlier work @xcite , but were not described in detail nor validated with experimental demonstrations .",
    "we assume that our device is planar and consists of only two materials .",
    "we can represent our structure by constructing a continuous function @xmath7 over our design region , and letting the boundaries between the materials lie on the level set @xmath8 .",
    "the permittivity @xmath9 is then given by @xmath10 the advantage of this implicit representation is that changes in topology , such as the merging and splitting of holes , are trivial to handle .",
    "we can also manipulate our structure by adding a time dependence , and evolving @xmath11 as a function of time @xmath12 with a variety of partial differential equations collectively known as level set methods @xcite .    to design a device , we first choose some objective function @xmath13 $ ] which describes how well the structure matches our electromagnetic performance constraints @xcite .",
    "we then evolve our structure , represented by @xmath14 , in such a way that we minimize our objective @xmath15 .",
    "we can achieve this by adapting gradient descent optimization to our level set representation .",
    "the level set equation for moving boundaries in the normal direction is @xmath16 where @xmath17 is the spatial gradient of @xmath14 , and @xmath18 is the local velocity .",
    "to implement gradient descent , we choose the velocity field @xmath18 to correspond to the gradient of the objective function @xmath13 $ ] @xcite , which can be efficiently computed using adjoint sensitivity analysis @xcite . as @xmath19 , @xmath14 converges to a locally optimal structure .",
    "unfortunately , this approach tends to result in the formation of extremely small features .",
    "we can avoid this problem by periodically enforcing curvature constraints .",
    "the level set equation for smoothing out curved regions is @xmath20 where the local curvature @xmath21 is given by @xmath22 although equation [ eqn : wgsplit3_meancurv ] removes highly curved regions more quickly @xcite , the boundaries are eventually reduced to a set of straight lines with zero curvature as @xmath19 .    from a fabrication perspective , we only need to smooth regions which are above some maximum allowable curvature @xmath23 .",
    "we can do this by introducing a weighting function @xmath24 and modifying equation [ eqn : wgsplit3_meancurv ] to be @xmath25 if we evolve @xmath14 with equation [ eqn : wgsplit3_curvfilt ] until it reaches steady state , the maximum curvature will be less than or equal to @xmath23 .",
    "the final design algorithm is as follows :    1 .",
    "initialize @xmath14 and @xmath26 .",
    "2 .   repeat until @xmath27 . 1 .",
    "let @xmath28 .",
    "* gradient descent * : evolve @xmath29 with eqn .",
    "[ eqn : wgsplit3_normprop ] for time @xmath26 .",
    "* curvature limit * : evolve @xmath29 with eqn .",
    "[ eqn : wgsplit3_curvfilt ] until convergence .",
    "if * @xmath30\\right ] < f\\left[\\epsilon[\\phi]\\right]$ ] , * then * let @xmath31 and increase @xmath26 .",
    "+ * otherwise * , decrease @xmath26 .",
    "implementation details can be found in the supplementary information .          in designing the @xmath0 power splitter , we chose the structure to consist of a single fully - etched @xmath32 thick @xmath33 layer with @xmath34 cladding .",
    "refractive indices of @xmath35 and @xmath36 were used .",
    "the waveguide width was set to @xmath37 for both the input and output waveguides .",
    "we constrained the mininum radius of curvature to be @xmath2 , well within the typical design rules of a cmos silicon photonics process .",
    "we also enforced bilateral symmetry for the structure .",
    "the splitter was designed at 6 equally spaced wavelengths between @xmath3 .",
    "we specified that power in the fundamental traverse - electric ( te ) mode of the input waveguide should be equally split into the fundamental te mode of the three output waveguides , with at least @xmath38 efficiency .",
    "the optimization process is illustrated in figure [ fig:1_wgsplit3_opt ] . starting with a star - shaped geometry ,",
    "the optimization process converged in 18 iterations .",
    "the device was designed in approximately 2 hours on a single server with an intel core i7 - 5820k processor , 64 gb of ram , and three nvidia titan z graphics cards .",
    "all electromagnetic simulations were performed using a graphical processing unit ( gpu ) accelerated implementation of the finite - difference frequency - domain ( fdfd ) method @xcite .",
    "the power splitters were fabricated on unibond smartcut silicon - on - insulator ( soi ) wafers obtained from soitec , with a nominal @xmath32 device layer , and @xmath39 buried oxide layer .",
    "a jeol jbx-6300fs electron - beam lithography system was used to pattern a @xmath40 thick layer of zep-520a resist spun on the samples .",
    "a transformer - coupled plasma etcher was used to transfer the pattern to the device layer , using a @xmath41 breakthrough step and @xmath42 main etch .",
    "the mask was stripped by soaking in solvents , followed by a piranha @xmath43 clean .",
    "finally , the devices were capped with @xmath44 of lpcvd ( low pressure chemical vapour deposition ) oxide .",
    "a multi - step etch - based process was used to expose waveguide facets for edge coupling .",
    "first , a chrome mask was deposited using liftoff to protect the devices .",
    "next , the oxide cladding , device layer , and buried oxide layer were etched in a inductively - coupled plasma etcher using a @xmath45 chemistry . to provide mechanical clearance for the optical fibers ,",
    "the silicon substrate was then etched to a depth of @xmath46 using the bosch process in a deep reactive - ion etcher ( drie ) .",
    "finally , the chrome mask was chemically stripped , and the samples were diced into conveniently - sized pieces .      the final splitter is illustrated in figure [ fig:2_wgsplit3_dev ] , showing both an scanning - electron micrograph ( sem ) of the fabricated device , and simulated electromagnetic fields at the center wavelength of @xmath47 .",
    "transmission through the device was measured by edge - coupling to the input and output waveguides using lensed fibers .",
    "a polarization - maintaining fiber was used on the input side to ensure that only the te mode of the waveguide was excited . to obtain consistent coupling regardless of the transmission spectra of the devices ,",
    "the fibers were aligned by optimizing the transmitted power of a @xmath48 laser .",
    "the transmission spectrum was then measured by using a supercontinuum source and a spectrum analyzer .",
    "the device characteristics were obtained by normalizing the transmission with respect to a waveguide running parallel to the device .",
    "the simulated and measured transmission spectra of the device are plotted in figure [ fig:3_wgsplit3_s - params ] .",
    "the simulations and measurements match reasonably well , although the measured devices have slightly higher losses and exhibit a spectral shift with respect to simulations .",
    "the device performance is highly consistent across all 4 measured devices , indicating that they are robust to fabrication error .",
    "the two key criteria for a power splitter are low insertion loss , and excellent power uniformity .",
    "the power uniformity is defined as the ratio between the maximum and minimum output powers .",
    "averaged over the designed wavelength range of @xmath3 , our @xmath0 splitter has a measured insertion loss of @xmath4 , and a power uniformity of @xmath5 . here",
    ", the uncertainty refers to the variability between different measured devices .",
    "splitter , where @xmath49 is the transmission from port @xmath50 to port @xmath51 . * ( a ) * simulated performance , calculated using finite - difference time - domain ( fdtd ) simulations . due to bilateral symmetry in the structure , s21 and s41",
    "are equal to each other . *",
    "( b ) * measured device performance . here , we have overlaid the measurements for 4 identically fabricated devices .",
    "the average values are denoted by the solid lines , and the minimum and maximum values are denoted by the shaded areas . ]",
    "in summary , we have incorporated fabrication constraints into an inverse design algorithm for nanophotonic devices . using this method , we designed and experimentally demonstrated a broadband @xmath0 splitter . critically , the device has no small features which would violate the design rules of a standard silicon photonics process , paving the way for inverse designed structures to become practical components of integrated photonics systems .",
    "this work was funded by the afosr muri for aperiodic silicon photonics , grant number fa9550 - 15 - 1 - 0335 , the gordon and betty moore foundation , and globalfoundries inc .",
    "all devices were fabricated at the stanford nanofabrication facility ( snf ) and stanford nano shared facilities ( snsf ) .    10    g.  t. reed , _ silicon photonics : the state of the art _ ( john wiley & sons , chichester , west sussex , u.k . , 2008 ) .",
    "a.  mutapcica , s.  boyd , a.  farjadpour , s.  g. johnson , and y.  avnielb , `` robust design of slow - light tapers in periodic waveguides , '' eng . optimiz . * 41 * , 365  384 ( 2009 ) .",
    "j.  s. jensen and o.  sigmund , `` topology optimization for nano - photonics , '' laser photonics rev .",
    "* 5 * , 308  321 ( 2011 ) .    c.  m. lalau - keraly , s.  bhargava , o.  d. miller , and e.  yablonovitch , `` adjoint shape optimization applied to electromagnetic design , '' opt .",
    "express * 21 * , 21693  21701 ( 2013 ) .",
    "j.  lu and j.  vukovi , `` nanophotonic computational design , '' opt .",
    "express * 21 * , 13351  13367 ( 2013 ) .",
    "a.  c.  r. niederberger , d.  a. fattal , n.  r. gauger , s.  fan , and r.  g. beausoleil , `` sensitivity analysis and optimization of sub - wavelength optical gratings using adjoints , '' opt . express * 22 * , 12971  12981 ( 2014 ) .",
    "a.  y. piggott , j.  lu , k.  g. lagoudakis , j.  petykiewicz , t.  m. babinec , and j.  vukovi , `` inverse design and demonstration of a compact and broadband on - chip wavelength demultiplexer , '' nature photonics * 9 * , 374377 ( 2015 ) .",
    "l.  f. frellsen , y.  ding , o.  sigmund , and l.  h. frandsen , `` topology optimized mode multiplexing in silicon - on - insulator photonic wire waveguides , '' opt .",
    "express * 24 * , 16866  16873 ( 2016 ) .",
    "a.  sakai , t.  fukuzawa , and t.  baba , `` low loss ultra - small branches in a silicon photonic wire waveguide , '' ieice trans .",
    "* e85-c * , 1033  1038 ( 2002 ) .",
    "s.  h. tao , q.  fang , j.  f. song , m.  b. yu , g.  q. lo , and d.  l. kwong , `` cascade wide - angle y - junction @xmath52 optical power splitter based on silicon wire waveguides on silicon - on - insulator , '' opt .",
    "express * 16 * , 2145621461 ( 2008 ) .",
    "i. borel , l.  h. frandsen , a.  harpth , m.  kristensen , j.  s. jensen , and o.  sigmund , `` topology optimised broadband photonic crystal y - splitter , '' electron . lett . * 41 * , 6971 ( 2005 ) .    y.  zhang , s.  yang , a.  e .- j .",
    "lim , g .- q .",
    "lo , c.  galland , t.  baehr - jones , and m.  hochberg , `` a compact and low loss y - junction for submicron silicon waveguide , '' opt .",
    "express * 21 * , 13101316 ( 2013 ) .",
    "a.  y. piggott , j.  lu , t.  m. babinec , k.  g. lagoudakis , j.  petykiewicz , and j.  vukovi , `` inverse design and implementation of a wavelength demultiplexing grating coupler , '' sci . rep . * 4 * , 7210 ( 2014 ) .",
    "b.  shen , p.  wang , r.  polson , and r.  menon , `` an integrated - nanophotonics polarization beamsplitter with @xmath53 footprint , '' nature photonics * 9 * , 378  382 ( 2015 ) .",
    "y.  elesin , b.  lazarov , j.  jensen , and o.  sigmund , `` design of robust and efficient photonic switches using topology optimization , '' phot .",
    "nano . fund .",
    "* 10 * , 153  165 ( 2012 ) .",
    "y.  deng and j.  g. korvink , `` topology optimization for three - dimensional electromagnetic waves using an edge element - based finite - element method , '' proc .",
    "a * 472 * , 20150835 ( 2016 ) .",
    "l.  h. frandsen and o.  sigmund , `` inverse design engineering of all - silicon polarization beam splitters , '' proc .",
    "spie * 9756 * , 97560y1  97560y6 ( 2016 ) .",
    "s.  osher and r.  fedkiw , _ level set methods and dynamic implicit surfaces _ ( springer , new york , u.s.a . , 2003 ) .",
    "m.  burger and s.  j. osher , `` a survey on level set methods for inverse problems and optimal design , '' eur .",
    "j. appl . math . * 16 * , 263  301 ( 2005 ) .",
    "w.  shin and s.  fan , `` choice of the perfectly matched layer boundary condition for frequency - domain maxwell s equations solvers , '' j. comput .",
    "phys . * 231 * , 3406  3431 ( 2012 ) .",
    "w.  shin and s.  fan , `` accelerated solution of the frequency - domain maxwell s equations by engineering the eigenvalue distribution , '' opt .",
    "express * 21 * , 22578  22595 ( 2013 ) .    * supplemental information *",
    "in the main text , we wrote that we implement curvature limiting by evolving the level set function @xmath14 with @xmath54 using the weighting function @xmath55 in practice , this has terrible convergence since the weighting function falls off infinitely sharply as the local curvature crosses @xmath23 .",
    "to improve the behaviour of our pde , we actually use a smoothed weighting function @xmath56 where @xmath57 is the euclidean distance to the nearest element in the set @xmath58 , @xmath59 the distance function @xmath57 can be efficiently computed using the euclidean distance transform commonly included in image processing libraries .      in our design algorithm , we apply gradient descent with the partial differential equation @xmath60 where @xmath18 is the local velocity , and apply curvature limiting with equation [ eqn : wgsplit3suppl_curvfilt ] .",
    "we spatially discretize equation [ eqn : wgsplit3suppl_normprop ] using godunov s scheme , and equation [ eqn : wgsplit3suppl_curvfilt ] using central differencing , as is common practice @xcite .",
    "we discretize in the time dimension using euler s method .    to ensure that our level set equations remain well behaved , we regularly reinitialize @xmath14 to be a signed distance function @xcite , where @xmath61 .",
    "most reinitialization schemes , however , result in subtle shifts in the interface locations , which can cause optimization to fail .",
    "we use russo and smerka s reinitialization scheme to avoid these issues @xcite ."
  ],
  "abstract_text": [
    "<S> a major difficulty in applying computational design methods to nanophotonic devices is ensuring that the resulting designs are fabricable . here , we describe a general inverse design algorithm for nanophotonic devices that directly incorporates fabrication constraints . </S>",
    "<S> to demonstrate the capabilities of our method , we designed and experimentally demonstrated a compact , broadband @xmath0 power splitter on a silicon photonics platform . </S>",
    "<S> the splitter has a footprint of only @xmath1 , and is well within the design rules of a typical silicon photonics process , with a minimum radius of curvature of @xmath2 . </S>",
    "<S> averaged over the designed wavelength range of @xmath3 , our device has a measured insertion loss of @xmath4 and power uniformity of @xmath5 . </S>"
  ]
}