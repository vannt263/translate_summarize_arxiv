{
  "article_text": [
    "weak gravitational lensing ( wl ) is one of the most promising techniques to probe dark energy ( de ) with improved precision in the future ( see recent reviews by @xcite ) . by statistically measuring the distortions in the shapes of background galaxies , the matter density fluctuations at different redshifts",
    "can be mapped , yielding constraints on the parameters of the background cosmological model .",
    "pioneering wl surveys , such as the cosmic evolution survey  ( cosmos , @xcite ) and the canada - france - hawaii telescope lensing survey   ( cfhtlens , @xcite ) have recently successfully demonstrated the utility of this technique , yielding constraints on the matter density @xmath1 and fluctuation amplitude @xmath2 comparable with other existing methods , even with relatively small sky coverage ( @xmath8 and 154 deg@xmath0 , respectively ) .    in this paper",
    ", we use the publicly available cfhtlens data on @xmath9 million galaxies , combined with a suite of ray - tracing simulations in 91 different cosmological models , to constrain the cosmological parameters , @xmath1 , @xmath2 , and the de equation of state @xmath3 .",
    "traditionally , wl data is analyzed using the two - point correlation function ( 2pcf ) , or its fourier - space counterpart , the power spectrum .",
    "however , these statistics can not fully characterize the weak lensing shear field on small ( @xmath10 arcmin ) angular scales , where it is sensitive to matter density fluctuations in the nonlinear regime , and is strongly non - gaussian .",
    "various non - gaussian statistics ( e.g. higher moments  @xcite , three - point functions  @xcite , bispectra  @xcite , peak counts  @xcite , or minkowski functionals  @xcite ) have been proposed in the past , and shown to improve cosmological constraints from wl surveys .    in this work ,",
    "we focus on peak statistics , which describe the distribution of local maxima in a convergence map , as a function of peak height .",
    "it is a particularly simple statistic , forecasted to yield a factor of @xmath11 two improvement on cosmological parameters when combined with two - point statistics by several recent studies @xcite , and also found to be unusually robust to systematic errors from baryonic effects @xcite . in a companion paper ( petri et al . in prep ) we examine constraints from minkowski functionals and higher moments of the wl convergence field .",
    "a handful of works have recently begun to examine non - gaussian features in the cfhtlens data .",
    "three - point statistics have been measured in both cfhtlens @xcite and earlier in cosmos @xcite and found to lead to modest ( up to @xmath12 ) improvements on the combination @xmath13 with @xmath14 .",
    "@xcite measured minkowski functionals in cfhtlens and showed that they can break degeneracies among cosmological parameters , improving constraints on @xmath1 and @xmath2 .",
    "finally , higher moments @xcite and peak counts @xcite have both been measured in cfhtlens , although cosmological constraints have not yet been derived from them .",
    "the distinguishing feature of the present work is that we compute peak count statistics , including their dependence on cosmology and their variance , from simulations in a large number of cosmological models ( 91 in total ) .",
    "simulating multiple cosmological models is necessary because analytical predictions of peak counts for non - gaussian fields are still in early development ( for example , ref.@xcite ) .",
    "furthermore , a large number ( @xmath15 hundreds ) of realizations per model is necessary to measure the covariance of the peak counts , and to compute accurate confidence limits on cosmological parameters .",
    "because of computational limitations , most works on non - gaussian wl statistics to date have sampled only a few points in the multi - dimensional cosmological parameter space , and assumed a linear dependence on cosmological parameters to compute observables in other cosmologies ( effectively implementing a numerical version of a fisher matrix ) or else relied on fitting formulae calibrated with a handful of simulations .",
    "the only exception we are aware of is ref .",
    "@xcite , who studied peak counts in simulations on a two - dimensional @xmath16 grid , and whose results already indicate that the @xmath1 and @xmath2 dependence is nonlinear , and the fisher approach is therefore highly inaccurate .",
    "recently , a series of papers dubbed `` the coyote universe '' @xcite have built an emulator , based on a large number of simulations , to address analogous issues for the matter power spectrum . using 37 cosmological models",
    ", these studies have shown that the matter power spectrum can be interpolated and computed to @xmath17 accuracy out to @xmath18 mpc@xmath19 for models in - between the simulated points in parameter space .",
    "we have built an emulator following a similar approach , but describing wl observables , and tailored specifically for the cfhtlens fields . unlike in a general  purpose emulator , galaxy properties ( e.g. redshift distribution , position , and noise ) are not freely adjustable parameters , but rather fixed and built into our simulations from the outset , adapted directly from the cfhtlens measurements .",
    "the paper is structured as follows .",
    "we first describe cfhtlens data processing and convergence map construction in ",
    "[ sec : data ] , and our ray - tracing simulations and numerical details in ",
    "[ sec : emulator ] .",
    "we present the results of our analysis in   [ sec : results ] , and we offer our conclusions in   [ sec : conclusion ] .",
    "the 154 deg@xmath0 cfhtlens data cover four individual patches on the sky , with an area of 64 , 23 , 44 and 23  deg@xmath0 for field w1 , w2 , w3 and w4 , respectively .",
    "the cfhtlens data analysis roughly consists of : ( 1 ) creation of the galaxy catalogue using sextractor @xcite ; ( 2 ) the photometric redshift estimation with a bayesian photometric redshift code @xcite ; ( 3 ) galaxy shape measurement with _ lens_fit @xcite ; and finally ( 4 ) cosmological analysis with 2pcf  @xcite .",
    "a summary of the data analysis process is listed in appendix c of ref .",
    "we refer the readers to the cfhtlens papers mentioned above for more technical details .",
    "we apply the following cuts to galaxies : mask @xmath20 ( see table  b2 in ref .",
    "@xcite for the meaning of mask values ) , redshift @xmath21 , fitclass @xmath22 ( requiring the object to be a galaxy ) , and weight @xmath23 ( with larger @xmath24 indicating smaller shear measurement uncertainty ) . applying these cuts leaves us 4.2 million galaxies , 124.7 deg@xmath0 sky , and average number density @xmath25  arcmin@xmath26 .      because the cfhtlens fields are irregularly shaped , and because we ray - trace to the actual observed galaxy positions , we first divide them into 13 squares ( subfields ) to match the square shape and @xmath2712 deg@xmath0 size of our simulated maps .",
    "[ fig : subfields ] shows the convergence maps for the cfhtlens fields , as well as the divisions into subfields . to maximize the data usage , three subfields are each composed of two physically separated sky patches ( the ones with rectangular shape in the figure ) .",
    "galaxies in each subfield are then placed on a @xmath28 pixel grid using the flat sky ( gnomonic ) projection  @xcite , @xmath29 where @xmath30 is the galaxy position in radians on the grid map , @xmath31 the position in ( ra , dec ) , @xmath32 the center of the subfield , and @xmath33 the angular distance from the center , @xmath34    in order to reduce the noise and to perform a fourier transform , we use a gaussian window function to smooth the grid map , @xmath35 } { \\int\\,d^2\\theta w(|\\thetab-\\thetazb|)\\mathcal{w}(\\thetab)[1+m(\\thetab)]}\\\\ \\label{eqn : w_g } w(\\theta)&=&\\frac{1}{2\\pi\\theta^2_g}\\exp(-\\frac{\\theta^2}{2\\theta^2_g})\\label{eq - wg},\\end{aligned}\\ ] ]    where @xmath36 is the smoothed complex ellipticity @xmath37 at the pixel @xmath38 .",
    "@xmath39 is the gaussian smoothing window with scale @xmath40 , which we choose to be 0.5 , 1.0 , 1.8 , 3.5 , 5.3 , and 8.9 arcmin .",
    "@xmath24 is the _",
    "lens_fit weight for each galaxy . @xmath41 and @xmath42 are additive and multiplicative corrections , which we include following refs .",
    "@xcite , @xmath43    the additive correction @xmath44 is consistent with 0 for @xmath45 , and @xmath46 for @xmath47 , and @xmath42 is a function of signal - to - noise ( @xmath48 ) and galaxy size ( @xmath49 ) , @xmath50 with @xmath51 and @xmath52 .",
    "this multiplicative correction for each galaxy ( denominator of eq .",
    "[ eq : e_smooth ] ) is a fit to the ensemble average over galaxies within the window function , because the result can be unstable on a galaxy  by  galaxy basis when @xmath53 .",
    "we tested the impact of the @xmath42 calibration following   8.5 of ref .",
    "we sampled 100 sets of random @xmath54 values from their probability distribution provided in ref .",
    "@xcite , and computed the variance of the power spectrum and the peak counts among these 100 samples .",
    "similar to the results of the analysis in ref .",
    "@xcite for the 2pcf , we found that this calibration impacts the power spectrum and the peak counts at the @xmath55 level , negligible comparing to the variance between random realizations of the underlying lensing maps .",
    "the convergence ( @xmath56 ) and the complex shear ( @xmath57 ) are obtained from derivatives of the lensing potential ( @xmath58 ) .",
    "they are defined as @xmath59 where indices separated by a comma denote partial derivatives with respect to two orthogonal components @xmath60 and @xmath61 of @xmath62 .",
    "we can reconstruct the convergence map from shear measurements @xcite using , @xmath63 where @xmath64 , @xmath65 are the convergence and the shear in fourier space , and @xmath66 is the wave vector with components @xmath67 . note that ellipticity is used as a measure of the shear , using the weak lensing approximation ( @xmath68 ; see below ) .",
    "the data contain unusable regions ( due to bright stars and bad pixels ) .",
    "these regions and sky patches with low galaxy number density can induce large errors and noise ( e.g. @xcite ) .",
    "hence we mask them out ( shown as the scattered white dots in fig .",
    "[ fig : subfields ] ) . by masking out low density regions ,",
    "we assume there is no correlation between the lensing signal and the galaxy number density , i.e. neglecting the magnification bias .",
    "@xcite found that the magnification bias has negligible impact on cosmological parameters for surveys with @xmath69 deg@xmath0 coverage .",
    "to generate masks , we first create grid maps of the same size and resolution as the convergence maps , but with each pixel containing the number of galaxies ( @xmath70 ) falling within that pixel .",
    "we then smooth this galaxy surface density map with the same gaussian window function as before ( eq .  [ eqn : w_g ] ) . finally , we remove regions where @xmath71  arcmin@xmath26 ( see ref .",
    "@xcite ) . in order to perform a fourier transform on the resulting maps , we set all pixels within the masked regions to zero .",
    "this can introduce noise at small scales , and we limit our final analysis to scales @xmath72 .",
    "we also apply the same procedure on the simulated maps .",
    "the power spectrum is the fourier counterpart of the two - point correlation function .",
    "we first fourier transform the convergence map ( with 0.5 arcmin smoothing scale ) , and then average over all spherical harmonics ( @xmath73 ) to obtain the power spectrum , with 40 equally spaced log bins in the range @xmath74 .",
    "peak counting is done by scanning through the pixels on the convergence map , and identifying local maxima ( pixels with a higher value of @xmath56 than its surrounding 8 pixels ) .",
    "we then record the number of peaks as a function of their central @xmath56 value . in our analysis , we use peaks with @xmath75 and test various smoothing scales .    the final power spectrum is averaged over the 13 subfields , weighted by the number of galaxies in each subfield .",
    "the final peak counts is the sum over 13 subfields .",
    "the construction of the emulator consists of three steps .",
    "first , we sample 91 points using the latin hypercube method in the three - dimensional ( 3d ) parameter space within the broad ranges @xmath76 , @xmath77 , and @xmath78",
    ". for each sampled point , we run an n - body simulation and perform ray - tracing to create shear maps that are directly comparable to the cfhtlens data .",
    "second , we create convergence maps , measure the power spectra and peak counts , and interpolate between the 91 simulated grid points to make predictions for arbitrary cosmological models within the simulated range . finally , we compute the parameter likelihood in the 3d space ( @xmath79 ) to find the best fit values and marginalized confidence contours , using the cfhtlens observations .",
    "we first pick 91 sampling points that are spread out in the 3d space as evenly as possible , but not overlap when projected on 2d or 1d space . to do this",
    ", we use the latin hypercube sampling method following ref .",
    "@xcite . a list of parameters residing on a diagonal line",
    "is first generated , and then randomly shuffled on each dimension . for a random pair of points and a random parameter",
    ", we swap their values .",
    "the last step was repeated until we reached convergence in average distance between the points ( @xmath80 iterations ) .",
    "the resulting parameter values are listed in table  [ tab : cosmoparsm ] and shown visually in figure  [ fig : cosmoparams ] .",
    "we then run one n - body simulation at each sampling point , using a modified version of the gadget-2 code .",
    "except for the values of the three cosmological parameters , the parameters and setup of these n - body simulations are the same as used in our earlier work @xcite .",
    "we refer readers to these papers for more detailed information .",
    "the simulations have a box size of @xmath81 comoving mpc , containing @xmath82 dark matter particles .",
    "this corresponds to a mass resolution of @xmath83 .",
    "we set the hubble constant @xmath84 , baryon density @xmath85 , and the spectral index @xmath86 .",
    "we compute the initial ( linear ) total matter power spectrum with the einstein - boltzmann code camb @xcite at @xmath87 and scale it back to initial redshift @xmath88 .",
    "the power spectrum is then fed into n - genic , the initial condition generator associated with gadget-2 .",
    "snapshot cubes are recorded at redshifts corresponding to every @xmath11 80 mpc ( comoving ) .    to create mock shear maps ,",
    "we next perform ray - tracing .",
    "we divide each 3d box into three parallel pieces and project each slice onto a 2d plane perpendicular to the observer s line of sight , using the triangular shaped cloud scheme @xcite .",
    "we then convert the surface density to the gravitational potential at each plane using poisson s equation . at each position of",
    "the 4.2 million observed cfhtlens galaxies , we follow a light ray from @xmath87 , traveling backward through the projection planes to the redshift of the galaxy , @xmath89 . for simplicity",
    ", we chose @xmath89 to be the peak of the photometric redshift probability distribution function ( pdf ) . using the most probable redshift , instead of the full pdf , can potentially induce biases as the former does not follow the stacked posterior probabilities when fainter galaxies are included ( see fig .  10 in ref .",
    "we test this effect by ray tracing to redshifts randomly drawn from the pdf of individual galaxies for one cosmology , and found the deviation of cosmological parameters to be negligible .",
    "@xcite also found the bias caused by using the most probable photometric redshift to be small ( @xmath90 ) , but important for future , larger surveys .",
    "the deflection angle , convergence , and shear are calculated at each plane for each light ray . between the planes , the light rays travel in straight lines . finally ,",
    "for each cosmological model , we create 1,000 realizations ( including @xmath56 and @xmath91 for each galaxy ) by randomly rotating / shifting the simulation data cubes .    in total",
    ", we created 1,183,000 mock catalogues ( 91 models @xmath92 13 subfields per model @xmath92 1,000 realizations per subfield ) .",
    ".[tab : cosmoparsm ] cosmological parameters used in our simulations .",
    "the universe is assumed to be spatially flat ( @xmath93 ) , with the hubble constant @xmath84 , baryon density @xmath85 and spectral index @xmath94 . [ cols=\"<,^,^,^\",options=\"header \" , ]      constraints on the parameter @xmath95 , using the power spectrum ( dashed line ) , peak counts ( thin solid line ) , and their combination ( thick solid line ) .",
    "the power spectrum is computed using the 75% of the fields that pass the psf residual test , and restrictd to @xmath72 .",
    "peak counts are computed using all fields , and include measurements of peaks on two smoothing scales ( 1.0 and 1.8 arcmin ) . ]",
    "68% ( dark color ) and 95% ( light color ) error contours from the power spectrum ( dashed curves ) , peak counts ( thin solid curves ) , and their combination ( thick solid curves ) .",
    "the shaded region in the bottom panel is the 68% error contour for the combination .",
    "the power spectrum is computed using the 75% of the fields that pass the psf residual test , and restricted to @xmath72 .",
    "peak counts are computed using all fields , and include measurements of peaks on two smoothing scales ( 1.0 and 1.8 arcmin).,title=\"fig : \" ]   68% ( dark color ) and 95% ( light color ) error contours from the power spectrum ( dashed curves ) , peak counts ( thin solid curves ) , and their combination ( thick solid curves ) .",
    "the shaded region in the bottom panel is the 68% error contour for the combination .",
    "the power spectrum is computed using the 75% of the fields that pass the psf residual test , and restricted to @xmath72 .",
    "peak counts are computed using all fields , and include measurements of peaks on two smoothing scales ( 1.0 and 1.8 arcmin).,title=\"fig : \" ]    added plot     correlation coefficients of the total covariance .",
    "bins 1 - 40 are for the power spectrum , bin 41 - 65 are for peak counts with 1.0 arcmin smoothing scale , and bins 66 - 90 are for peak counts with 1.8 arcmin smoothing scale . ]",
    "68% ( dark color ) and 95% ( light color ) power spectrum + peak counts error contours with ( thin curves ) and without ( thick curves ) the cross - covariance . the power spectrum is computed using the 75% of the fields that pass the psf residual test , and restricted to @xmath72 .",
    "peak counts are computed using all fields , and include measurements of peaks on two smoothing scales ( 1.0 and 1.8 arcmin ) . ]",
    "fits to the cfhtlens ( thick solid curves ) power spectrum ( upper panel ) and peak counts ( lower panel ) .",
    "the peak counts on 1.0 and 1.8 arcmin scales are concatenated on the x - axis .",
    "the best fits ( thin solid curves ) and two other models ( dash - dotted and dashed curves ) randomly selected from within the 68% error bananas , are shown for reference.,title=\"fig : \" ]   fits to the cfhtlens ( thick solid curves ) power spectrum ( upper panel ) and peak counts ( lower panel ) .",
    "the peak counts on 1.0 and 1.8 arcmin scales are concatenated on the x - axis .",
    "the best fits ( thin solid curves ) and two other models ( dash - dotted and dashed curves ) randomly selected from within the 68% error bananas , are shown for reference.,title=\"fig : \" ]",
    "in this paper , we have run 91 cosmological models , built a cfhtlens ",
    "specific weak lensing emulator for the power spectrum and peak counts , and obtained constraints on @xmath1 , @xmath3 , and @xmath2 .",
    "peak counts as a recently developed non - gaussian statistics have previously been proven in theory to have comparable constraining power as the power spectrum .",
    "this work is the first attempt to test this hypothesis rigorously on real data .",
    "we have found that combining peak counts with the power spectrum can reduce the area of the 2d error contour by a factor of @xmath96 compared to using the power spectrum alone . combining both statistics",
    ", we obtained @xmath7 .",
    "\\(1 ) as a calibration tool for systematics .",
    "peaks with small ( @xmath11 arcmin ) smoothing scales suffer less ( or are impacted differently by ) systematics than the power spectrum . for cfhtlens , we have found that the psf residuals have little impact on peak counts , in contrast with the bias seen with the 2pcf in ref .",
    "we find that masking also has little impact on the peak counts , whereas it changes the power spectrum at small scales ( @xmath97 ) .",
    "the change in the power spectrum does not impact cosmological constraints , as long as the mask is taken into consideration in the model ( e.g. fig .",
    "[ fig : ps_contour ] ) .",
    "furthermore , in our previous work on theoretical systematics due to the magnification bias @xcite , we also discovered that , while both the power spectrum and peak counts are affected , the resulting directions of the biases in the cosmology parameter space are different . combining the two probes can mitigate the impact from these systematics .",
    "\\(2 ) by providing tighter constraints on cosmological parameters .",
    "the peak counts by themselves have a similar , or even better constraining power than the power spectrum .",
    "this can be attributed to the fact that the peaks capture information from non - gaussian features of the convergence maps .",
    "we have shown in fig .",
    "[ fig : pspk ] and table  [ tab : contoursize ] that combining power spectrum and peak counts improves the constraints by a factor of @xmath27 two , compared to using the power spectrum alone .",
    "\\(1 ) examining the effects of additional smoothing scales , binning of peaks , and the robustness of the results under masking .",
    "we have examined only six smoothing scales , and demonstrated that using multiple smoothing scales can reduce the size of the area of the error contour by a moderate amount .",
    "we also showed that masking can change the power spectrum .",
    "more detailed study on these effects can be beneficial .",
    "\\(2 ) including the cosmological dependence of the covariance matrix , especially for peak counts .",
    "we use a constant covariance matrix in this work , assuming the cosmological dependence is weak , as we expect the covariance to be dominated by the shape noise .",
    "however , as the survey size increases , cosmological sensitivity should be taken into consideration when constructing the covariance matrix .",
    "\\(3 ) increasing the number of independent simulations run for each cosmological model . in our current work , due to computational limitations ,",
    "we have only used one independent n - body simulation per model .",
    "although we randomly rotate and shift the lensing planes to create multiple pseudo - independent realizations , some outliers ( such as massive halos ) will inevitably be repeated in several maps .",
    "however , our previous work has shown that the bulk of the cosmological information from peak counts resides in low - amplitude peaks , which do not arise from single massive halos ; these peaks should be less susceptible to repeated structures between pseudo - random realizations . nevertheless , to test possible errors due to not having sufficiently independent maps , we ran a separate set of 50 simulations for one cosmology .",
    "we found that the variance in the ( noiseless ) power spectrum and peak counts is increased by approximately 10% , when compared to that using only one simulation .",
    "however , when noise is added , the difference is no longer systematic , with a 5% fluctuation and is consistent with 0 .",
    "we also found a larger - than gaussian variance even at our lowest @xmath98 , by approximately 10% .",
    "this increase in the variance due to non - gaussianities is somewhat lower than that found previously @xcite .",
    "further details on tests of the covariance matrices will be presented in our companion paper ( petri et al .",
    ", in prep ) .",
    "future wl surveys , such as the dark energy survey , and the large synoptic survey telescope , cover much larger areas ( 5,000 and 20,000 deg@xmath0 , respectively ) , hence are more sensitive to instrumental and theoretical systematics .",
    "these will need to be addressed carefully in order to realize the full potential of these larger surveys .",
    "we thank ludovic van waerbeke and hendrik hildebrandt for useful discussions . simulations for this work",
    "were performed at the nsf extreme science and engineering discovery environment ( xsede ) , supported by grant number aci-1053575 , and at the new york center for computational sciences , a cooperative effort between brookhaven national laboratory and stony brook university , supported in part by the state of new york .",
    "this work was supported in part by the u.s .",
    "department of energy under contract no .",
    "de - ac02 - 98ch10886 and contract no .",
    "de - sc0012704 , and by the nsf grant ast-1210877 ( to z.h . ) ."
  ],
  "abstract_text": [
    "<S> lensing peaks have been proposed as a useful statistic , containing cosmological information from non - gaussianities that is inaccessible from traditional two - point statistics such as the power spectrum or two - point correlation functions . here </S>",
    "<S> we examine constraints on cosmological parameters from weak lensing peak counts , using the publicly available data from the 154 deg@xmath0 cfhtlens survey . </S>",
    "<S> we utilize a new suite of ray - tracing n - body simulations on a grid of 91 cosmological models , covering broad ranges of the three parameters @xmath1 , @xmath2 , and @xmath3 , and replicating the galaxy sky positions , redshifts , and shape noise in the cfhtlens observations . </S>",
    "<S> we then build an emulator that interpolates the power spectrum and the peak counts to an accuracy of @xmath4 , and compute the likelihood in the three - dimensional parameter space ( @xmath1 , @xmath2 , @xmath3 ) from both observables . </S>",
    "<S> we find that constraints from peak counts are comparable to those from the power spectrum , and somewhat tighter when different smoothing scales are combined . </S>",
    "<S> neither observable can constrain @xmath3 without external data . when the power spectrum and peak counts are combined , the area of the error `` banana '' in the ( @xmath1 , @xmath2 ) plane reduces by a factor of @xmath5 , compared to using the power spectrum alone . for a flat @xmath6 cold dark matter model , combining both statistics , we obtain the constraint @xmath7 . </S>"
  ]
}