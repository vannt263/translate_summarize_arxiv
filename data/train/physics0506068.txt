{
  "article_text": [
    "the present work is motivated by the need for a high resolution frequency measurement system for analyzing signals generated by optically - pumped cesium magnetometers  @xcite .",
    "a set of such magnetometers will be used for a detailed investigation of magnetic field fluctuations and gradients in an experiment searching for a neutron electric dipole moment ( nedm ) .",
    "the experiment calls for a magnetic field of between 1 to  2  @xmath0 controlled at the 80  ft level when measured over 100  s time intervals , control corresponding to a relative uncertainty between 40 to 80  ppb .",
    "the magnetometers are based on the fact that for low magnetic fields the larmor precession frequency @xmath1 in a vapor of cs atoms is proportional to the modulus of the magnetic field @xmath2 @xmath3 the proportionality factor @xmath4 is a combination of fundamental and material constants and has a value of @xmath5 for @xmath6 .",
    "the precession of the atoms modulates the resonant absorption coefficient of the cesium vapor , which is measured by a photodiode monitoring the power of a laser beam traversing the atomic vapor  @xcite . in the self - oscillating mode of operation",
    "@xcite the magnetometer signal is of the form @xmath7 the larmor frequency , @xmath1 , has to be extracted from the signal .",
    "equation  [ eq : larmorfreqtofield ] connects the frequency determination precision directly to the resulting field measurement precision .",
    "the basic demand on the frequency measurement system in order to achieve the required field precision is a resolution of a few hundred @xmath8 in an integration time of 100  s. moreover , the synchronous detection of signals from an array of magnetometers requires a cost - effective multi - channel solution .    in our recent study @xcite of optically ",
    "pumped magnetometer performance , frequency measurements were made with a commercial frequency counter ( stanford research systems , model sr620 ) , which has a limited frequency resolution , thereby limiting the magnetic field determination .",
    "frequency counters rely on the detection of zero crossings of a periodic signal in a given dwell time .",
    "their performance is limited by their resolution of the zero crossing times , an event which is affected by the amplitude , offset , and phase noise of the signal . in demanding applications , such as the one investigated here , that timing jitter limits the ultimate frequency resolution of the magnetometer signal measurement . put simple ,",
    "the limitation of frequency counters is due to the fact that they use only information in the vicinity of the zero crossings , while valuable wave form information from in between the zero crossings is ignored .    as a more powerful alternative",
    "one can use numerical frequency estimation algorithms to extract the frequency from the complete waveform sampled at an appropriate rate and with a sufficient resolution .",
    "the performance of an adc - based measurement system for measuring a single frequency of about 8  hz was discussed in  @xcite . under the assumption that a stable clock triggers the adc , the authors in @xcite show that the lower limit of the frequency resolution of their system coincides with the cramr ",
    "rao lower bound ( crlb )  @xcite .",
    "the crlb is a well - known concept from information theory and describes principle limits for the estimation of parameters from sampled signals .    in our application ,",
    "the larmor frequency in a magnetic field of @xmath9 lies in the audio frequency range ( @xmath10 ) .",
    "we have investigated whether a commercially available ( and rather inexpensive ) professional multi - channel sound card would present a viable solution for sampling the magnetometer signals .",
    "the estimation of the frequency from the sampled data was done by a software algorithm . in the following",
    "we will show that such a simple system can indeed be used for crlb limited real - time frequency measurements and for a detailed study of noise processes which limit the precision of atomic magnetometers .",
    "the frequency measurement system consists of a professional sound card ( m  audio delta 1010 ) for digitizing the analog input data , an atomic clock to provide  a stable time reference , and a standard personal computer ( pc ) which reads the data and runs the frequency estimation algorithm .",
    "the sound card provides 8 analog input channels in a breakout box that connects to a pci interface card in the pc .",
    "the analog input signals can be sampled with a resolution of up to 24  bit at a sampling rate of up to 96  khz . in order to limit the amount of data we used only 16-bit resolution , which was proven to yield sufficient precision .",
    "jitter or drifts of the sampling rate induce additional phase noise on the sampled signal which can seriously degrade the precision of the frequency estimation .",
    "an essential feature of the delta 1010 sound card is its `` world clock '' input which can be used to phase - lock the internal clock of the sound card to an external 96  khz time base .",
    "the time base was realized by a frequency generator synchronized to the 10  mhz signal of a rubidium frequency standard ( stanford research systems , model prs10 ) .",
    "the rb frequency standard provides a relative stability of @xmath11 in 100  s which minimizes possible sampling rate jitter and drifts far below the required level .",
    "the requirements for the pc system are not very demanding as long as it allows for the continuous recording of the 16  bit data sampled at a rate of 96  khz ( 5.8  gb / h for 8 channels ) . a 1.8  ghz pentium-4 processor was fast enough for real - time frequency determination for all eight channels at a given integration time .",
    "however , for the detailed analysis described below , in which the integration time is varied , the time series were evaluated off - line from the stored sampled data .",
    "considering the magnetometer signal given by eq .",
    "[ eq : magsignal ] , the frequency @xmath1 is to be determined from the ac - coupled signal data which , after sampling , are of the form @xmath12}\\!+\\delta x_n , \\label{eq : sinussignal } \\\\ & & n = ( 0,\\ldots , n-1 ) \\nonumber \\:,\\end{aligned}\\ ] ] where @xmath13 is the signal amplitude , @xmath14 the time resolution ( inverse of the sampling rate @xmath15 ) , and @xmath16 the initial phase .",
    "the number of sample points is @xmath17 , where @xmath18 is the measurement integration time . also shown",
    "is the noise contribution at each point @xmath19 arising from phase noise @xmath20 , frequency noise @xmath21 , and offset noise @xmath22 .",
    "the frequency is determined from the data @xmath23 by a maximum likelihood estimator based on a numerical fourier transformation which provides a crlb limited value  @xcite .",
    "the algorithm iteratively searches for the frequency @xmath24 that maximizes the modulus of the fourier sum @xmath25 where @xmath26 is a windowing function .    under ideal conditions ( stable field and ideal electronics ) ,",
    "the frequency and phase noise ( @xmath27 and @xmath20 ) are not present in the signal ( eq .  [ eq : sinussignal ] ) .",
    "the fundamental noise contribution is the photocurrent shot noise , which is proportional to the square root of the dc offset @xmath28 in eq .",
    "[ eq : magsignal ] .",
    "the noise is converted , by a transimpedance amplifier , to voltage @xmath29 and has a gaussian amplitude distribution with zero mean , corresponding to a white frequency spectrum that is characterized by its power spectral density @xmath30 ( in @xmath31 ) .",
    "the signal - to - noise ratio ( snr ) is defined as @xmath32 , where @xmath33 is the sampling rate limited bandwidth , i.e. , the nyquist frequency or the highest frequency that can be detected unaliased .",
    "the crlb of the frequency estimation from such an ideal magnetometer signal is given by the variance  @xcite @xmath34     noise source & & + white offset & @xmath35&@xmath36 & @xmath37 & @xmath38 + flicker frequency & @xmath39 & @xmath40 & @xmath41 & @xmath42 + white frequency & @xmath43 & @xmath44 & @xmath45 & @xmath46 + flicker phase & @xmath47&@xmath48 & @xmath49 & @xmath50 + white phase & @xmath51 & @xmath52 & @xmath53 & @xmath38 +    in frequency metrology it is customary to represent frequency fluctuations in terms of the allan standard deviation @xmath54  or its square @xmath55 , the allan variance  @xcite .",
    "one can show that for white noise @xmath54 coincides with the classical standard deviation  @xcite . a double logarithmic plot of the dependence of @xmath54 on the integration time @xmath18 is a valuable tool for assigning the origin of the noise processes that limit the performance of an oscillator",
    "( see for example @xcite ) . as shown in table  [",
    "table : bw - tau ] , the variance @xmath55 depends both on integration time @xmath18 and measurement bandwidth @xmath56 , which , for a measurement interval @xmath18 , is given by @xmath57 .",
    "when that relation between bandwidth and integration time is inserted into the formulas given in the central column of table  [ table : bw - tau ] @xcite , one finds the typical @xmath18 dependencies of the allan standard deviation @xmath54 shown in the right - hand column . in the presence of several uncorrelated noise processes , @xmath58 ,",
    "the variance of the estimated frequency is given by @xmath59 note that for a magnetometer signal , the contribution from eq .",
    "[ eq : crfreq ] will always be present in the sum .",
    "+    we first investigated whether our data analysis algorithm reproduces the theoretical @xmath18-dependencies shown in table [ table : bw - tau ] .",
    "for that purpose we generated time series ( 16  bit , 96  khz ) corresponding to eq .",
    "[ eq : sinussignal ] with only one of the phase , frequency , or offset noise terms enabled , and selected with well defined spectral characteristics ( flicker or white ) .",
    "figure  [ fig : simulation ] shows the allan standard deviation @xmath54 of those synthetic data .",
    "the emphasis here lies on the slopes rather than on the absolute values , which were chosen to yield a readable graph .",
    "+    next , we investigated the ability of the sound card to reach crlb limited detection of a 7  khz sine wave .",
    "the wave was generated by a digital function generator ( agilent , model 33220a ) stabilized to the same rb frequency standard as the sound card . in order to simulate a signal comparable to that of the magnetometers ,",
    "the snr of the function generator output was artificially decreased from its nominal value of better than @xmath60 to about @xmath61 ( in a 1  hz bandwidth ) by adding white offset noise .",
    "we recorded a 1  h time series of that signal , sampled with 16-bit resolution .",
    "the data were analyzed with the same algorithm as above and yielded an allan standard deviation @xmath62 , shown as black dots in fig .",
    "[ fig : funcgensolo]a ) .",
    "the measurement agrees on an absolute scale with the crlb calculated using eq .",
    "[ eq : crfreq ] and the applied snr .",
    "in addition to the offset noise , a second noise source was used to apply @xmath63 noise , in turn , to the frequency or to the phase modulation input of the function generator .",
    "the resulting @xmath54 of the measured data is shown in figs .",
    "[ fig : funcgensolo]b ) and c ) .",
    "figure  [ fig : funcgensolo]d ) shows @xmath54 derived from the same signal as fig .",
    "[ fig : funcgensolo]a ) but analyzed by the commercial frequency counter ( stanford research systems , model sr620 ) that was used in  @xcite .",
    "the three points shown correspond to the three possible integration times of the sr620 .",
    "it can be clearly seen that the counter technique does not allow the correct measurement of these faint noise processes . however , extrapolation of the data points suggest that for integration times less than 10  ms the crlb could be reached .     of magnetic field fluctuations inside a multi - layer magnetic shield .",
    "b ) residual fluctuations of the stabilized magnetic field .",
    "the dashed lines indicate the crlb ( left ) and an assumed white frequency noise limitation ( right ) .",
    "c ) stability required for the proposed nedm experiment.,title=\"fig : \" ] +    finally , after the frequency estimator algorithm and the sound card had proven their crlb performance limit , we used the system to analyze the frequency generated by an optically - pumped magnetometer ( opm ) .",
    "a magnetic field of @xmath64 was produced by a solenoid driven by an ultra - stable current source .",
    "the opm signal in that field is a 7  khz sine wave .",
    "the opm and the solenoid were located in a 6-layer magnetic shield in order to suppress external field fluctuations .",
    "figure  [ fig : r1stab]a ) shows @xmath54 of a 2  h time series recorded with the sound card .",
    "the data represent pure magnetic field fluctuations .",
    "in particular , the approximately 2  mhz fluctuations in the range between 2  to 200  s could be traced back to irregular current fluctuations in the solenoid .",
    "nevertheless , the relative field stability  and therefore the relative current stability  is on the order of @xmath65 for that range of integration times .",
    "however , for a 100  s integration time the field instability exceeds the requirement for the nedm experiment mentioned in the introduction .    in order to determine the magnetometer performance limit , we actively stabilized the magnetic field in the following way .",
    "the magnetometer frequency was compared to a stable reference oscillator ( i.e. , the rb frequency standard ) by means of a phase comparator , and the error signal was used to control the solenoid current , thus realizing a phase - locked loop .",
    "figure  [ fig : r1stab]b ) shows the allan standard deviation of the opm in the stabilized field , which is crlb - limited up to an integration time of 1  s. the noise excess between 1  and 300  s above the limits expected from the crlb and the assumed white noise limitation shows the limitation of the current stabilization scheme , which nonetheless allows the suppression of the fluctuations by three orders of magnitude at the integration time of interest .",
    "we have realized a frequency measurement system based on a digital sound card and have shown that it yields a performance superior to commercial frequency counters .",
    "we have proven that the system yields crlb limited frequency resolution in measurements of sine waves affected by various sources of noise .",
    "we have used the system to prove that , at least in a limited range of integration times , an active field stabilization by an optically pumped magnetometer is limited by the theoretical cramr - rao bound .",
    "the performance and the multi - channel feature of the sound card and its external frequency reference option present a low - cost alternative for applications requiring simultaneous characterization of several frequency generation systems , especially for long integration times .",
    "we thank francis bourqui for help in developing the read - out software . we acknowledge financial support from schweizerischer nationalfonds ( grant no .",
    "200020103864 ) , and paul scherrer institute ( psi ) ."
  ],
  "abstract_text": [
    "<S> for physical processes which express themselves as a frequency , for example magnetic field measurements using optically - pumped alkali - vapor magnetometers , the precise extraction of the frequency from the noisy signal is a classical problem . </S>",
    "<S> we describe herein a frequency measurement system based on an inexpensive commercially available computer sound card coupled with a software single - tone estimator which reaches cramr  rao limited performance , a feature which commercial frequency counters often lack . </S>",
    "<S> characterization of the system and examples of its successful application to magnetometry are presented . </S>"
  ]
}