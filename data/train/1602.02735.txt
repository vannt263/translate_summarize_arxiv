{
  "article_text": [
    "understanding how the order flow affects the dynamics of prices in financial markets is of utmost importance , both from a theoretical point of view ( why and how prices move ? ) and for practical / regulatory applications ( i.e trading costs , market stability , high frequency trading , ` tobin ' taxes , etc . ) .",
    "the availability of massive data sets has triggered a spree of activity around these questions  @xcite ( for a review see @xcite ) .",
    "one salient ( and initially unexpected ) stylized fact is the long - memory of the order flow , i.e. the fact that buy / sell orders are extremely persistent , leading to a slowly decaying correlation of the sign of the order imbalance  @xcite .",
    "this immediately leads to two interesting questions : first , why is this so ?",
    "is it the result of large `` metaorders '' being split in small pieces and executed incrementally , or is it due to herding or copy - cat trades , i.e. trades induced by the same external signal or by some traders following suit , hoping that the initial trade was informed about future price movements ?",
    "second , how is it possible that a highly predictive order flow impacts the price in such a way that very little predictability is left in the time series of price changes ?",
    "several empirical investigations , as well as order of magnitude comparisons between the typical total size of metaorders and the immediately available liquidity present in the order book , strongly support the `` splitting '' hypothesis @xcite .",
    "since the metaorder has to be executed over some predefined time scale ( typically several days for stocks ) , the structure of the order flow is expected to be , in a first approximation , independent of the short term dynamics of the price and can be treated as exogenous ",
    "see below .",
    "the idea then naturally leads to a class of so - called `` propagator '' models , where the mid - point price @xmath0 ( just before trade at time @xmath1 ) can be written as a linear superposition of the impact of all past trades , considered as given , plus noise @xcite : @xmath2 + m_{-\\infty }    \\label{eqn : prom_price_process}\\ ] ] where @xmath3 is the sign of trade at time @xmath4 ( @xmath5 for buy / sell market orders ) , @xmath6 is a noise term which models any price changes not induced by the trades ( e.g. limit orders / cancellations inside the spread , jumps due to news , etc . ) .",
    "the function @xmath7 is called the `` propagator '' and describes the decay of impact with time .",
    "the crucial insight of this formulation is precisely that this impact decay may counteract the positive auto - correlation of the trade signs and eventually lead to a diffusive price dynamics ( see @xcite and below ) .",
    "although highly simplified , the above framework leads to an interesting approximate description of the price dynamics . still , many features are clearly missing , see @xcite :    * first , the above formalism posits that all market orders have the same impact , in other words @xmath8 only depends on @xmath9 and not on @xmath1 and @xmath4 separately , which is certainly very crude .",
    "for example , some market orders are large enough to induce an immediate price change , and are expected to impact the price more than smaller market orders .",
    "one furthermore expects that depending on the specific instant of time and the previous history , the impact of market orders is different . * second , limit orders and cancellations should also impact prices , but their effect is only taken into account through the time evolution of @xmath7 itself that phenomenologically describes how the flow of limit orders opposes that of market orders and reverts the impact of past trades . *",
    "third , the model assumes a _ linear _ addition of the impact of past trades and neglect any non - linear effects which are known to exist .",
    "for example , the total impact of a metaorder of size @xmath10 is now well known to grow as @xmath11 , a surprising effect that can be traced to non - linearities induced by the deformation of the underlying supply and demand curve , see e.g. @xcite .",
    "however , before abandoning the realm of linear models , it is interesting to see how far one can go within the ( possibly extended ) framework of propagator models , in order to address point 1 and 2 above .",
    "the aim of this work is to explore generalised linear propagator models , in the spirit of @xcite , with a fully consistent description of the impact of different market events and of the statistics of the order flow . for the sake of readability ,",
    "we have decided to present our results in two companion papers . in the present first part ( i ) , we investigate in detail two possible generalisations of eq .",
    "[ eqn : prom_price_process ] above , where price - changing and non price - changing market orders are treated differently .",
    "we show that separating these two types of events already leads to a significant improvement of the predictions of the model , in particular for large tick stocks .",
    "we revisit the difference between the `` transient impact model '' ( tim ) and the `` history dependent impact model '' ( hdim ) introduced in @xcite , correct some misprints in that paper , and show that hdim is always ( slightly ) better than tim for small tick stocks , as expected intuitively .",
    "we then turn to the modelling of the order flow in the companion paper ( ii ) , with in mind the necessity of keeping the linearity of the predictors of future order flow , as assumed in hdims .",
    "the so - called mixed transition distribution ( mtd ) model is a natural framework for constructing a versatile time series model of events , with a broad variety of correlation structures  @xcite .",
    "the propagator model defined by eq .",
    "[ eqn : prom_price_process ] above can alternatively be written in its differential form , where instead of the price process we consider the return process , @xmath12 : @xmath13 where @xmath14 . in the following",
    "we will call this model transient impact model ( as in @xcite ) and we label the predicted values according to the above model with tim1 where the `` 1 '' refers to the fact that one propagator function , @xmath7 , characterizes the model .",
    "empirical results show @xcite that for small ticks @xmath7 is a decreasing function with time , therefore the kernel @xmath15 is expected to be a negative function .",
    "this means that the impact of a market order is smaller if it follows a sequence of trades of the same sign than if it follows trades of the opposite sign .",
    "the authors of @xcite call this behaviour the `` asymmetric liquidity '' mechanism : the price impact of a type of order ( buy or sell ) is inversely related to the probability of its occurrence .",
    "the reason for this mechanism is that liquidity providers tend to pile up their limit orders in opposition of a specific trend of market orders @xcite , whereas liquidity takers tend to reduce the impact of their trades by adapting their request of liquidity to the available volume during the execution of their metaorders @xcite .      in order to calibrate the above model",
    ", we can measure the empirical response function @xmath16 $ ] and the empirical correlation function of the order signs @xmath17 $ ] .",
    "these two functions form a linear system of equations @xmath18c(n),\\ ] ] whose solution is the propagator function @xmath7 , for @xmath19 .",
    "an alternative method of estimation , which is less sensitive to boundary effects , uses the return process of eq .",
    "[ eqn : prom_return_process ] , such that the associated response function @xmath20 $ ] and @xmath21 are related through : @xmath22 whose solution represents the values of the kernel @xmath23 .",
    "the relation between @xmath24 and @xmath25 is : @xmath26 allowing to recover the response function from its differential form .",
    "once the propagator @xmath7 is calibrated on the data , the model is fully specified by the statistics of the noise @xmath27 . for simplicity , we will assume that @xmath27 has a low - frequency , white noise part of variance @xmath28 , describing any `` news '' component not captured by the order flow itself , and a fast mean - reverting component of variance @xmath29 describing e.g. high frequency activity inside the spread ( affecting the position of the mid - point @xmath0 ) or possible errors in the data itself .",
    "once the model is fully calibrated on data , we examine its performance by considering the prediction of two quantities , namely the negative lag response function and the signature plot .",
    "the former is the extension of the price response function , @xmath24 , to @xmath30 values , measuring the correlation between the present sign of the market order and the past price changes : @xmath31 .",
    "\\label{eqn : negativelag}\\ ] ] @xmath32 , with @xmath33 , is fully specified by the model , independently of @xmath28 and @xmath29 .",
    "naturally the one propagator model assumes a `` rigid '' order flow that does not adapt to price changes and leads to : @xmath34 where tim1 reminds us that this is the prediction according to the one propagator model .",
    "empirically , however one expects that the order flow should be adapting to past price changes , and an upward movement of the price should attract more sellers ( and vice - versa ) . in section [ sec : prop_empirical_test ] we will compare the prediction of eq .   to empirical results .",
    "the second prediction of the propagator model concerns the scale - dependent volatility of price changes , or `` signature plot '' , defined as : @xmath35.\\ ] ] using the propagator model , one finds the following exact expression : @xmath36 ^ 2 + 2 \\psi(\\ell)+ \\frac{d_\\mathrm{hf}}{\\ell } + d_\\mathrm{lf},\\ ] ] where @xmath37 is the correlation - induced contribution to the price diffusion : @xmath38\\left[g(\\ell+m)-g(m)\\right]c(m - n ) \\\\    & + \\sum_{0 \\leq n < \\ell } \\sum_{m > 0 } g(\\ell - n ) \\left[g(\\ell+m)-g(m)\\right ] c(m+n).\\end{aligned}\\ ] ]    hence , once @xmath7 is known , the signature plot of the price process can be computed and compared with empirical data",
    ".      the above model describes trades that impact prices , but with a time dependent , decaying impact function @xmath7 .",
    "one can in fact interpret the same model slightly differently , by writing as an identity : @xmath39 this can be read as a model where the deviation of the realized sign @xmath40 from an expected level @xmath41 impacts the price linearly and permanently .",
    "if @xmath41 is the best possible predictor of @xmath40 , then the above equation leads by construction to an exact martingale for the price process ( i.e. the conditional average of @xmath42 on all past information is zero ) @xcite . since the impact depends on the past history of order flow , following ref .",
    "@xcite , we refer to the model on the left of eq .",
    "[ eqn : hdim_return_process ] as the history dependent impact model and since only one type of past events is considered in the predictor we label it with hdim1 . when the best predictor is furthermore _ linear _ in the past order signs ( as in the right equation of eq .",
    "[ eqn : hdim_return_process ] ) , then the tim1 defined by eq .",
    "[ eqn : prom_return_process ] is _ equivalent _ to the hdim1 , eq .",
    "[ eqn : hdim_return_process ] .",
    "we will see below that as soon as one attempts to generalize the propagator model to multiple event types , tim and hdim become no longer equivalent .",
    "when is the best predictor of the future price a linear combination of past signs , such that tim and hdim are equivalent when restricted to one type of market orders only ?",
    "the answer is that this is true whenever the string of signs is generated by a so - called discrete autoregressive ( dar ) process ( see @xcite ) .",
    "dar processes are constructed as follows ( our description here lays the ground for the more general mtd models described in the companion paper ) .",
    "the sign at time @xmath1 is thought of as the `` child '' of a previous sign @xmath43 , where the distance @xmath44 is a random variable distributed according to a certain discrete distribution @xmath45 , with : @xmath46 if @xmath47 , the model is called as dar(p ) , and involves only @xmath48 lags .",
    "once the `` father '' sign is chosen , one postulates that : @xmath49    one can then show that in the stationary state , the signs @xmath50 are equiprobable , and the sign auto - correlation function @xmath21 obeys the following yule - walker equation : @xmath51    there is therefore a one - to - one relation between @xmath45 and @xmath21 .",
    "note that in the empirical case where @xmath21 decays as a power - law @xmath52 with exponent @xmath53 , one can show that @xmath54 and @xmath55 .",
    "now , from the very construction of the process , the conditional average of @xmath40 is given by : @xmath56 such that one can indeed identify the hdim1 with a tim1 , with : @xmath57 when @xmath58 , one finds as expected @xmath59 with @xmath60 @xcite .",
    "in order to develop the idea that large market orders ( compared to the volume at the opposite best ) may have a different impact than small ones , we need to extend the above propagator model to different events @xmath61 , where we choose here two types of events @xmath61 defined as : @xmath62    we follow the general framework of @xcite , but here the definition of price changing events is different .",
    "they refer to the total returns until the next transaction and they include the behaviour of liquidity takers and liquidity providers .",
    "these different events are discriminated by using indicator variables denoted as @xmath63 .",
    "the indicator , @xmath63 , is @xmath64 if the event at @xmath1 is of type @xmath65 and zero otherwise .",
    "the time average of the indicator function is the unconditional probability of event @xmath65 , @xmath66 $ ] .",
    "the usage of the indicator function simplifies the calculation of the conditional expectations , which will be intensively used in the following .",
    "for example , if a quantity @xmath67 depends on the event type @xmath65 and the time @xmath1 , then its conditional expectation is @xmath68=\\frac{\\mathbb{e}[x_{\\pi_t , t}i(\\pi_t=\\pi)]}{\\mathbb{p}(\\pi)}.\\ ] ] by definition of the indicator function we have that @xmath69      at this stage , the natural generalisation of the tim is to write the return process as @xmath70 where @xmath71 .",
    "therefore we call this model tim2 .",
    "the resulting price process is a linear superposition of the decaying impact of different ( signed ) events : @xmath72+m_{-\\infty}.    \\label{eqn : two_prom_price_process}\\ ] ] which can be used to compute the signature plot @xmath73 of model ( see appendix [ app : tim_signature_plot ] ) .",
    "the tim2 can be calibrated very similarly as the tim1 above , by noting that the differential response function @xmath74=\\frac{\\mathbb{e}[r_{t+\\ell}\\cdot\\epsilon_t i(\\pi_t=\\pi)]}{\\mathbb{p}(\\pi)},\\ ] ] and the conditional correlation is not bounded in @xmath75 $ ] because we normalize the expectation in the numerator by the product @xmath76 rather than by the joint probability @xmath77 .",
    "this choice is done for speeding the computations and we have verified that the difference is very small . ] of order signs of a pair of events @xmath78 and @xmath79 @xmath80}{\\mathbb{p}(\\pi_1)\\mathbb{p}(\\pi_2 ) }    \\label{eqn : conditional_corr_order_signs}\\ ] ] are related through : @xmath81    we use these quantities to evaluate the conditional response function @xmath82 , the total impact function @xmath83 and the corresponding response function @xmath24 . as for the tim1 , once we have calibrated @xmath84 , we compute the predicted values of these response functions for negative lags , @xmath85 and @xmath86 , and the predicted signature plot @xmath87 .      however , this is not the only generalisation of the propagator model .",
    "in fact , the hdim formulation , eq . [ eqn : hdim_return_process ] , lends itself to the following , different extension : @xmath88 meaning that the expected sign for an event of type @xmath65 is a linear regression of past signed events , with an `` influence kernel '' @xmath89 that depends on both the past event type @xmath90 and the current event @xmath65 .",
    "this model is the hdim2 .",
    "it is clear that tims are actually special cases of hdims , with the identification : @xmath91 i.e. the influence kernel @xmath89 does not depend on the present event type @xmath65 : only the type of the past event @xmath90 matters .",
    "the calibration of this model turns out to be more subtle and is discussed in appendix [ app : hdim_calibration ] ( where some errors and misprints appearing in the text of @xcite are corrected ) .",
    "as above , we may ask when it is justified to consider that the expected sign for an event of type @xmath65 is a linear regression of past signed events .",
    "this requires to generalize the dar model described in section [ sec : dar_model ] above to a multi - event framework",
    ". this will precisely be the aim of part ii of this work , where we introduce mtds as a natural generalisation of dar for order book events .",
    "much as for the simple propagator model , one can test the predictive power of the tim and hdim framework by comparing the conditional response functions for negative lags @xmath92 $ ] , @xmath93 with empirical data , as well as the signature plot @xmath73 of the price process . in the following section we will investigate the results of the estimation of the above models , and compare these predicted quantities with their empirical determination . our conclusion , in a nutshell , is that introducing two types of events substantially increases the performance of the propagator models and that  perhaps expectedly  the hdim fares better than tim , but only very slightly .",
    "we have analysed the trading activity of the 50 most traded stocks at nyse and nasdaq stock exchanges , during the period february 2013 - april 2013 with a total of 63 trading days .",
    "we have chosen a wide panel of stocks of different types in order to perform a deep analysis of the two markets .",
    "we have considered only the trading activity in the period 9:30 - 15:30 in all the days under analysis , in order to reduce intraday patterns of activity , such as volume traded , average spread , etc .",
    "in particular we try to avoid the trading activity just after the pre - auction and the closing period of the end of the trading day . after trimming the beginning and the end of each trading day , for each stock we concatenate the data on different trading days and carry out our analysis on these time series .",
    "the tick size of all the stocks is 0.01 usd .    in table",
    "[ tab : data_stock ] we list the details of the stocks analysed . in particular , we have listed the volatility in basis points , the average daily traded amount in usd , the average bid - ask spread in ticks , and the average tick size - price ratio and we ranked the stocks by these values .",
    "we can divide the sample in two different groups , which are the large and small tick stocks .",
    "the bid - ask spread of a large tick stock is most of the times equal to one tick , whereas small tick stocks have spreads that are typically a few ticks .",
    "we will emphasise in the following sections the very different behaviour of these two groups of stocks .",
    "there exist also a number of stocks in the intermediate region between large and small tick stocks , which have the characteristics of both types .    for the period studied , the stock of apple inc .",
    "( aapl ) had on average a bid - ask spread of @xmath94 ticks , clearly making it a small tick stock . on the other hand , microsoft inc .",
    "( msft ) , with average bid - ask spread being @xmath95 ticks is a good candidate for a large tick stock . to illustrate our empirical analysis , we chose to show results for these two stocks in the following .",
    ".details of analysed stocks : rank by average traded daily amount ( m$ ) , volatility , rank by average spread over tick size , and by average tick size ( bp ) .",
    "[ cols=\"<,^,^ , < , > , < , > , < , > \" , ]      the top panels of fig .",
    "[ fig : estimated_transient_impact_model ] show the estimation of the propagators @xmath7 for msft and aapl . for both large and small tick stocks",
    "the decay of the propagator is slow , well above the noise level after 1000 transactions .",
    "we can see that for msft ( as well as for other large tick stocks ) the propagator function first increases for a few time lags , and starts decreasing only after that .",
    "thus , the derivative @xmath23 is positive for small lags , and since @xmath96 too , the market impact should be reinforced by a sequence of orders on the same side of the order book .",
    "this should lead to violations of the market efficiency on short time scales .",
    "this is a direct symptom of the inadequacy of the one - event propagator formalism for large ticks : in fact , we will see that the order flow can not be considered to be independent of the price changes in this case . after an uptick move",
    ", there is a high probability that the next order will be in the opposite direction , reinstalling price efficiency .",
    "this will be well captured by the two - event propagator below .    for aapl and other small tick stocks",
    "we only see a monotone the decay of the propagator .",
    "the assumption of a rigid order flow , insensitive to price moves , will be approximately correct in that case ( see @xcite ) , the relaxation of the propagator alleviating the correlation of the signs .",
    "we can already anticipate that the two - event propagator framework will be much more beneficial for large tick stocks than for small tick stocks .",
    "close to zero and bounded by the two vertical lines is linear , whereas outside this region the scale is logarithmic . ]",
    "close to zero and bounded by the two vertical lines is linear , whereas outside this region the scale is logarithmic . ]",
    "close to zero and bounded by the two vertical lines is linear , whereas outside this region the scale is logarithmic . ]",
    "close to zero and bounded by the two vertical lines is linear , whereas outside this region the scale is logarithmic . ]",
    "the bottom panels of fig .",
    "[ fig : estimated_transient_impact_model ] show the price response for both positive and negative lags .",
    "the dashed lines in the plots show the theoretical prediction of the one - event propagator model by using the estimated kernels . in the case of msft the measured response function for negative lags",
    "@xmath44 is well above the prediction of the propagator model ( solid line ) , that , as we discussed assumes a rigid order flow not depending on price changes .",
    "as anticipated above , this means that in the data there exists an additional anti - correlation between past returns and the subsequent order flow , which is not captured by the model . a similar ,",
    "though much weaker deviation can be seen in the case of aapl . in general , this effect is very pronounced in the case of large tick stocks , whereas in the case of small tick stocks it exists but is much weaker .",
    "in fact , in fig . [",
    "fig : anomalous_negative_stocks ] we plot the ratio @xmath97/\\sigma$ ] for @xmath98 , @xmath99 being the volatility per trade , by ranking the stocks in the x - axis by the average spread .",
    "we observe that for small tick stocks ( left part of the plot ) the difference is relatively small , while for large tick stocks ( right part of the plot ) the prediction error on the negative lag response of the tim1 becomes quite large , especially for large lags @xmath44 .",
    "turning now to the signature plot @xmath73 , we see in fig .",
    "[ fig : estimated_transient_impact_model_signature_plot ] that small tick and large tick stocks behave very differently . for small tick stocks , we see that @xmath73 increases with @xmath44 as soon as @xmath100 , corresponding to a `` trend - like '' behaviour .",
    "the decreasing behaviour of @xmath73 for smaller lags corresponds to high frequency activity with the spread , leading to a minimum in @xmath73 . for large tick stocks this is absent and one finds `` mean - reverting '' behaviour , with a steadily decreasing signature plot",
    "the prediction of the one - event propagator model fares quite well at accounting for the trending behaviour of small tick stocks , provided the two extra fitting parameters @xmath28 and @xmath29 are optimized with ols in order to minimize the distance between the empirical and the theoretical curves of the model .",
    "we note for example that choosing @xmath101 would underestimate ( in the case of aapl ) the long - term volatility by a factor of two . for large tick stocks , however , the mean - reverting behaviour is completely missed .",
    "we now turn to propagator models that distinguish between price - changing and non price - changing market orders , and see how the situation for large tick stocks indeed greatly improves .     and the theoretical curves of the estimated tim1 for msft ( @xmath102 and @xmath103 ) and appl ( @xmath104 and @xmath105 ) . ]     and the theoretical curves of the estimated tim1 for msft ( @xmath102 and @xmath103 ) and appl ( @xmath104 and @xmath105 ) . ]      the aim of this section is to show that an extended propagator model allows us to reproduce satisfactorily the additional anti - correlations between past returns and subsequent order signs ( revealed by the discrepancy between @xmath106 and @xmath107 ) by including an implicit coupling between past returns and order flow .",
    "we will also require that the signature plot @xmath73 is correctly accounted for , in particular for large tick stocks .",
    "measured on msft and appl data .",
    "note that the first subscript corresponds to the event that happened first chronologically .",
    "the scale for values of the correlations close to zero and bounded by horizontal solid lines is linear , whereas outside this region the scale is logarithmic . ]",
    "measured on msft and appl data .",
    "note that the first subscript corresponds to the event that happened first chronologically .",
    "the scale for values of the correlations close to zero and bounded by horizontal solid lines is linear , whereas outside this region the scale is logarithmic . ]",
    "close to zero and bounded by vertical solid lines is linear , whereas outside this region the scale is logarithmic . ]",
    "close to zero and bounded by vertical solid lines is linear , whereas outside this region the scale is logarithmic . ]",
    "the extended version of the propagator model with two events @xmath71 can follow two routes , as discussed above .",
    "one is the tim2 , which can be estimated much as the one - event model , by solving the linear system of eq .",
    "[ eqn : extended_transient_estimation ] .",
    "the second is the hdim2 , whose estimation involves determining the influence kernels @xmath108 for @xmath109 , because @xmath110 by construction .",
    "the calibration requires estimating three - point correlation functions or approximating them in terms of two - point correlations  as detailed in section  [ sec : hdim_estimation ] we will follow the latter approximation . thus , the correlation @xmath111 of the different signed events , defined in eq .   is an important input of the calibration for both generalised linear models . note that the first subscript corresponds to the event that happened first chronologically .",
    "we start by showing its empirical estimation for the two typical stocks ( see fig . [",
    "fig : estimated_cond_corr ] ) .    for aapl , all auto - correlation and cross - correlation functions have almost the same power - law decay and they are all positive .",
    "this is expected since c and nc events are not radically different for small tick stocks .",
    "note that the unconditional probability of price changing market orders is @xmath112 .",
    "correlation functions look similar for other small tick stocks too .    for msft",
    "the curves reveal a different behaviour .",
    "for example the @xmath113 auto - correlation has the familiar power - law shape possibly due to order splitting .",
    "the @xmath114 correlation is also positive but decays faster .",
    "note that it starts at @xmath115 , which means that a c order immediately following a nc order is in the same direction with very high probability .",
    "this describes nc orders that leave a relatively small quantity at the best offer , which is then immediately `` eaten '' by the next market orders .",
    "its relatively fast decay suggests that agents splitting their metaorders avoid being aggressive and nearly only send nc orders .",
    "the other two correlations @xmath116 and @xmath117 both start negative and capture the effect we are interested in : after a price changing event , it is highly likely that the subsequent order flow ( either c or nc ) will be in the other direction . note however that @xmath118 and that it is exceedingly rare to observe a succession of two c events separated by a small lag .",
    "this type of behaviour is the one that can be seen in general for large tick stocks .",
    "the estimation procedure involves the empirical determination of the response function for positive lags , and allows us to calculate the theoretical prediction of the response function for negative lags , as well as the signature plot .",
    "[ fig : estimated_response_function ] shows the empirical response function for positive lags @xmath119 and negative lags @xmath106 , together with the predicted response function @xmath120 , according to the calibrated tim2 . in the case of large tick stocks the empirical curves",
    "are perfectly reproduced , whereas for small tick stocks some little deviation still persists .",
    "the improvement with respect to the tim1 is quite remarkable .",
    "this can be seen the from comparison of the prediction of the response function for negative lags of the tim1 , @xmath121 , also plotted in fig .",
    "[ fig : estimated_response_function ] .",
    "close to zero and bounded by vertical solid lines is linear , whereas outside this region the scale is logarithmic . ]",
    "close to zero and bounded by vertical solid lines is linear , whereas outside this region the scale is logarithmic . ]",
    "+     close to zero and bounded by vertical solid lines is linear , whereas outside this region the scale is logarithmic . ]",
    "close to zero and bounded by vertical solid lines is linear , whereas outside this region the scale is logarithmic . ]     of tim2 .",
    "the scale for @xmath44 close to zero and bounded by horizontal solid lines is linear , whereas outside this region the scale is logarithmic .",
    "( bottom panels ) signature plots , empirical and predicted by the calibrated tim2 . left : msft with @xmath122 and @xmath123 , right : appl with @xmath124 and @xmath125 . ]     of tim2 .",
    "the scale for @xmath44 close to zero and bounded by horizontal solid lines is linear , whereas outside this region the scale is logarithmic .",
    "( bottom panels ) signature plots , empirical and predicted by the calibrated tim2 . left : msft with @xmath122 and @xmath123 , right : appl with @xmath124 and @xmath125 . ]",
    "+     of tim2 .",
    "the scale for @xmath44 close to zero and bounded by horizontal solid lines is linear , whereas outside this region the scale is logarithmic .",
    "( bottom panels ) signature plots , empirical and predicted by the calibrated tim2 . left : msft with @xmath122 and @xmath123 , right : appl with @xmath124 and @xmath125 . ]     of tim2 .",
    "the scale for @xmath44 close to zero and bounded by horizontal solid lines is linear , whereas outside this region the scale is logarithmic .",
    "( bottom panels ) signature plots , empirical and predicted by the calibrated tim2 . left : msft with @xmath122 and @xmath123 , right : appl with @xmath124 and @xmath125 . ]",
    "let us now discuss the observed response functions for positive lags , and the resulting calibrated propagators for small tick stocks , as for aapl , shown in fig .",
    "[ fig : estimated_resm_rc ] and [ fig : estimated_g_diff_rc ] ( right panels ) .",
    "the conditional response function @xmath126 after an event of type @xmath127 is a rigid shift of the @xmath128 curve .",
    "the reaction of market agents to the two types of events is therefore very similar .",
    "the shift indeed is due to the very definition of event types , that leads to a non - zero value of @xmath129 , comparable to the average spread .",
    "turning now to the conditional response function for negative lags , we observe a small deviation between the model and the empirical data : there exists an additional anti - correlation between past returns and future order signs which is not captured by the model .",
    "the curves @xmath130 and @xmath131 behave in similar way , but in the latter case the anti - correlation is stronger than in the former case .",
    "the propagator functions @xmath132 can be fit by a power - law , but the @xmath133 curves are non monotonic ( fig . [",
    "fig : estimated_g_diff_rc ] ) .",
    "note that , as a result of the non - trivial structure of the correlation , the calibration of the tim2 leads to @xmath134 .",
    "this is inconsistent with the interpretation of the model  which would require @xmath135  and shows the theoretical limitations of the tim framework . in the case of the hdim framework , by construction ,",
    "we have that @xmath136 .",
    "the results of the estimation of the model for large tick stocks are completely different .",
    "[ fig : estimated_resm_rc ] and [ fig : estimated_g_diff_rc ] ( left panels ) show the results for msft .",
    "the @xmath128 curve is a positive and increasing function which starts , as expected , from zero and reaches a plateau for large lags .",
    "the @xmath126 curve starts from the value of the spread in basis point and slightly decreases , which means that the reaction of the market after price change events consists in a mean reversion of the price . for negative lags",
    ", the curve @xmath130 shows that if an event occurs that does not change the price , then for small lags the past returns are on average anti - correlated with the present order sign .",
    "the case of the @xmath131 is quite interesting , because it shows that if a price changing event occurs , then the past returns are on average anti - correlated with the present order sign .",
    "the propagator functions @xmath137 are almost constant with different values : @xmath138 is equal to the spread , whereas @xmath133 is equal to zero .",
    "the fact that the two propagators are constant means that the price process in eq .",
    "[ eqn : two_prom_price_process ] is simply a sum of non - zero price changes , all equal to the spread , and for which the impact is permanent .",
    "therefore , as noted in @xcite the dynamics of the price is completely determined by the sequence of random variables @xmath139 , and the temporal structure of their correlations . more precisely , if spread fluctuations can be neglected , tim2 lead to the following simple predictions : @xmath140 , \\nonumber \\\\",
    "\\mathcal{r}^{\\text{tim2}}_{\\pi}(\\ell<0 ) & \\approx -\\sum_{0 < n \\leq \\ell } \\sum_{\\pi_1 } \\mathbb{p}(\\pi_1 ) g_{\\pi_1}(1 ) c_{\\pi_1 , \\pi}(n ) \\nonumber \\\\ & = - g_\\mathrm{c}(1)\\sum_{0 < n \\leq \\ell } \\mathbb{p}(\\mathrm{c } ) c_{\\mathrm{c } , \\pi}(n ) .",
    "\\label{eq : rmean}\\end{aligned}\\ ] ] and : @xmath141 note that the both the empirical response for negative lags and the signature plot are now perfectly reproduced .",
    "the improvement from the tim1 is quite remarkable .",
    "the calibration of the hdim2 model requires the determination of the influence matrix @xmath142 , which can be done from the empirical knowledge of the response matrices @xmath143 since @xmath144 where @xmath145}{\\mathbb{p}(\\pi_1)\\mathbb{p}(\\pi_2 ) } , \\\\    c_{\\pi,\\pi_1,\\pi_2}(k,\\ell)&=\\frac{\\mathbb{e}[i(\\pi_{t - k}=\\pi)\\epsilon_{t - k } \\cdot i(\\pi_{t-\\ell}=\\pi_1)\\epsilon_{t-\\ell } \\cdot i(\\pi_t=\\pi_2)]}{\\mathbb{p}(\\pi)\\mathbb{p}(\\pi_1)\\mathbb{p}(\\pi_2)}.\\end{aligned}\\ ] ]    actually the previous equation is not convenient to be used for the estimation of the model , because it includes the empirical determination of the three - point correlation functions @xmath146 .",
    "therefore , in  @xcite authors employed a gaussian assumption which leads to the factorization of the three - point correlation functions in terms of two - point correlation functions : @xmath147 the resulting formula for the signature plot @xmath148 is considerably more complicated .",
    "we report it for completeness in appendix  [ app : hdim_calibration ] .    on purely theoretical grounds , hdims",
    "are better founded than tims and we have extended the above analysis to hdims as well . in the case of large tick stocks , there is no gain over the tim framework since the influence kernels are found to be extremely small .",
    "any gain is therefore only possible for small tick stocks .",
    "we show the empirical determination of the two influence kernels @xmath149 as well as the resulting predicted response @xmath150 for aapl in fig .",
    "[ fig : estimated_g_diff_hdim ] .",
    "as can be noted , the estimated kernels differ whether the sequence of events which precede the price - changing trade is composed of price - changing or non price - changing orders .",
    "we can argue that eq .",
    "[ eqn : hdim_tim_model ]  which neglects the role of the realised event  is too restrictive .",
    "it is worth to comment that , when statistically different from zero , the influence kernel @xmath151 is negative .",
    "then , a sequence of price - changing orders on the same side of the final c trade is going to impact the market less than a c order preceded by a sequence of price - changing events of the opposite sign . thus we see the same asymmetric liquidity mechanism described in  @xcite . as a sole difference with the picture described in section  [ sec : propagator ] , the influence kernel @xmath152 is positive for the very last nc event occurring before a price - changing event .",
    "this implies that the impact of the c market order is larger if it follows a sequence of nc trades whose last event occurs on the same side of the c event .",
    "we see some further improvement over the tim2 for the conditional response functions at negative lags .",
    "it seems that hdim2 performs slightly better than tim2 in capturing the excess anti - correlation measured from the data between past returns and future order signs .",
    "we also observe an improvement  albeit in a marginal way  for the signature plot in fig .",
    "[ fig : estimated_g_diff_hdim ] .",
    "we recall here that in the 6-event extension of the propagator model considered in @xcite , hdims appeared to fare slightly worse than tims for small tick stocks , for a reason that is still not well understood , and that would deserve further scrutiny .     of the hdim2 calibrated on aapl .",
    "( bottom panels ) conditional response functions ( blue markers ) , theoretical predictions of the hdim2 ( blue solid line ) , and of the tim2 ( red dashed lines ) calibrated on aapl data .",
    "the scale for @xmath44 close to zero and bounded by vertical solid lines is linear , whereas outside this region the scale is logarithmic . ]     of the hdim2 calibrated on aapl .",
    "( bottom panels ) conditional response functions ( blue markers ) , theoretical predictions of the hdim2 ( blue solid line ) , and of the tim2 ( red dashed lines ) calibrated on aapl data .",
    "the scale for @xmath44 close to zero and bounded by vertical solid lines is linear , whereas outside this region the scale is logarithmic . ]     +     of the hdim2 calibrated on aapl .",
    "( bottom panels ) conditional response functions ( blue markers ) , theoretical predictions of the hdim2 ( blue solid line ) , and of the tim2 ( red dashed lines ) calibrated on aapl data .",
    "the scale for @xmath44 close to zero and bounded by vertical solid lines is linear , whereas outside this region the scale is logarithmic . ]     of the hdim2 calibrated on aapl .",
    "( bottom panels ) conditional response functions ( blue markers ) , theoretical predictions of the hdim2 ( blue solid line ) , and of the tim2 ( red dashed lines ) calibrated on aapl data .",
    "the scale for @xmath44 close to zero and bounded by vertical solid lines is linear , whereas outside this region the scale is logarithmic . ]     and @xmath153 ) , and by the tim2 . ]",
    "the above study attempts to build the most accurate linear model of price dynamics based on the only observation of market orders .",
    "we have seen that treating all market orders on the same footing , as in the first version of the propagator model , leads to systematic discrepancies that increase with the tick size . for large tick sizes ,",
    "the predictions of this simple framework are qualitatively erroneous , both for the price response at negative lags and for the diffusion properties of the price .",
    "this can be traced to the inability of the model to describe the feedback of price changes on the order flow , which is strong for large tick stocks .",
    "generalizing the model to two types of market orders , those which leave the price unchanged and those which lead to an immediate price change , considerably improves the predictive power of the model , in particular for large ticks for which the above inadequacy almost entirely disappears , leading to a remarkable agreement between the model s predictions and empirical data .",
    "we have also seen that , although better justified theoretically , the `` history dependent '' impact models ( hdim ) fare only slightly better than the `` transient '' impact models ( tim ) when only two event types are considered .",
    "still , we are left with two important questions about the order flow itself , which we considered `` rigid '' in the above formalism , in the sense that it is entirely described by its correlation structure and does not explicitly react to past events ( at variance with the price itself )",
    ". it would be desirable to develop a more dynamic description of the order flow , for at least two reasons .",
    "one is that linear models are best justified in a context where the best predictor of the order flow is itself linear , as is the case of dar processes for the sign of market orders .",
    "we therefore need to generalize dar processes to a multi - event context , and see how well the corresponding so - called mtd models account for the statistics of the order flow , i.e. the string of @xmath154 , @xmath155 , @xmath156 , @xmath157 events .",
    "the second reason is that the `` true '' impact of an additional market order , not present in the past time series , should include the mechanical contributions captured by the tims or hdims , but also the possible change of the order flow itself due to an extra order in the market , an effect clearly not captured by our assumption of a rigid order flow .",
    "we thus need to define and calibrate the equivalent of the influence kernels defined above , but for the order flow itself .",
    "this is what we do in the following companion paper .",
    "we thank i. mastromatteo , j. donier , j. kockelkoren and especially z. eisler for many inspiring discussions on these topics .",
    "the exact expression of the diffusive curve @xmath73 , given in @xcite , is : @xmath158 ^ 2 \\\\    & + 2\\sum_{0 \\leq n < m",
    "< \\ell } \\sum_{\\pi_1,\\pi_2 } \\mathbb{p}(\\pi_{1,2 } ) g_{\\pi_1}(\\ell - n)g_{\\pi_2}(\\ell - m ) c_{\\pi_1,\\pi_2}(m - n ) \\\\    & + 2\\sum_{0 \\leq n < m } \\sum_{\\pi_1,\\pi_2 } \\mathbb{p}(\\pi_{1,2 } )",
    "\\left[g_{\\pi_1}(\\ell+n)-g_{\\pi_1}(n)\\right]\\left[g_{\\pi_2}(\\ell+m)-g_{\\pi_2}(m)\\right]c_{\\pi_2,\\pi_1}(m - n ) \\\\    & + \\sum_{0 \\leq n < \\ell } \\sum_{m>0 } \\sum_{\\pi_1,\\pi_2 } \\mathbb{p}(\\pi_{1,2 } ) g_{\\pi_1}(\\ell - n)\\left[g_{\\pi_2}(\\ell+m)-g_{\\pi_2}(m)\\right]c_{\\pi_2,\\pi_1}(m+n),\\end{aligned}\\ ] ] where @xmath159 .",
    "knowing the @xmath142 s and using the factorization of three - point and four - point correlations in terms of two - point correlations , one can finally estimate the diffusion curve , which is given by the following approximate equation : @xmath160 \\\\    & + 2\\sum_{0<n < m}\\sum_{\\pi_1,\\pi_2,\\pi_3}\\mathbb{p}(\\pi_{1,2,3})\\kappa_{\\pi_1,\\pi_3}(m)\\kappa_{\\pi_2,\\pi_3}(n)c_{\\pi_1,\\pi_2}(m",
    "- n ) \\\\    & + 2\\sum_{n>0}\\sum_{\\pi_1,\\pi_2 } g_{\\pi_2}(1 ) \\kappa_{\\pi_1,\\pi_2}(n ) c_{\\pi_1,\\pi_2}(n ) \\bigg]\\ell \\\\     & + 2\\sum_{0",
    "< n < \\ell}\\sum_{\\pi_1,\\pi_2}(\\ell - n)\\mathbb{p}(\\pi_{1,2})g_{\\pi_1}(1)g_{\\pi_2}(1 ) c_{\\pi_1,\\pi_2}(n ) \\\\    & + 2\\sum_{0 < n < \\ell } \\sum_{i>0 } \\sum_{\\pi_1,\\pi_2,\\pi_3}(\\ell - n ) \\mathbb{p}(\\pi_{1,2,3 } ) g_{\\pi_1}(1 ) \\kappa_{\\pi_2,\\pi_3}(i ) c_{\\pi_1,\\pi_2}(n+i ) \\\\    & + 2\\sum_{0 < n",
    "< \\ell } \\sum_{\\substack{i>0 \\\\ i \\neq n } } \\sum_{\\pi_1,\\pi_2,\\pi_3}(\\ell - n ) \\mathbb{p}(\\pi_{1,2,3 } ) g_{\\pi_1}(1 ) \\kappa_{\\pi_2,\\pi_3}(i ) c_{\\pi_1,\\pi_2}(n - i ) \\\\",
    "\\qquad & + 2\\sum_{0 < n <",
    "\\ell}\\sum_{\\pi_1,\\pi_2}(\\ell - n ) \\mathbb{p}(\\pi_{1,2 } ) g_{\\pi_1}(1 ) \\kappa_{\\pi_1,\\pi_2}(n ) [ \\pi_{\\pi_1,\\pi_2}(n)+1 ] \\\\    & + 2\\sum_{0 < n",
    "< \\ell } \\sum_{\\substack{i , j>0 \\\\ j \\neq n } } \\sum_{\\substack{\\pi_1,\\pi_2 \\\\ \\pi_3,\\pi_4 } } ( \\ell - n ) \\mathbb{p}(\\pi_{1,2,3,4 } ) \\kappa_{\\pi_1,\\pi_2}(i ) \\kappa_{\\pi_3,\\pi_4}(j ) c_{\\pi_1,\\pi_3}(n+i - j)[\\pi_{\\pi_2,\\pi_4}(n)+1 ] \\\\    & + 2\\sum_{0 < n <",
    "\\ell } \\sum_{i>0 } \\sum_{\\pi_1,\\pi_2,\\pi_3}(\\ell - n ) \\mathbb{p}(\\pi_{1,2,3 } ) \\kappa_{\\pi_1,\\pi_2}(i ) \\kappa_{\\pi_2,\\pi_3}(n ) c_{\\pi_1,\\pi_2}(i),\\end{aligned}\\ ] ] where @xmath159 and @xmath161}{\\mathbb{p}(\\pi_1)\\mathbb{p}(\\pi_2)}-1.\\ ] ]    99 hasbrouck , j. ( 1988 ) . trades , quotes , inventory and information .",
    "journal of financial economics , 22 , 229 - 252 .",
    "hasbrouck , j. ( 1991 ) .",
    "measuring the information content of stock trades .",
    "journal of finance , 46 , 179 - 207 .",
    "jones , c. m. , kaul , g. , and lipson , m. l. ( 1994 ) .",
    "transactions , volume , and volatility .",
    "review of financial studies , 7 , 631 - 651 .",
    "biais , b. , hillion , p. , and spatt , c. ( 1995 ) .",
    "an empirical analysis of the limit order book and order flow in the paris bourse .",
    "journal of finance , 50 , 1655 - 1689 .",
    "dufour , a. , and engle , r. f. ( 2000 ) .",
    "time and the price impact of a trade .",
    "journal of finance , 55(6 ) , 2467 - 2498 .",
    "cont , r. , kukanov , a. , and stoikov , s. ( 2014 ) .",
    "the price impact of order book events .",
    "journal of financial econometrics , 12(1 ) , 47 - 88 .",
    "bacry , e. , and muzy , j. f. ( 2014 ) .",
    "hawkes model for price and trades high - frequency dynamics .",
    "quantitative finance , 14(7 ) , 1147 - 1166 .",
    "bouchaud , j .-",
    ", farmer , j. d. , and lillo , f. ( 2009 ) .",
    "how markets slowly digest changes in supply and demand . in : _",
    "handbook of financial markets : dynamics and evolution _ , 2009 ( north - holland : amsterdam ) .",
    "bouchaud , j .-",
    "p . , gefen , y. , potters , m. , and wyart , m. ( 2004 ) .",
    "fluctuations and response in financial markets : the subtle nature of `` random '' price changes . quantitative finance , 4(2 ) , 176 - 190 .",
    "lillo , f. , and farmer , j. d. ( 2004 ) .",
    "the long memory of the efficient market .",
    "studies in nonlinear dynamics & econometrics , 8(3 ) .",
    "lillo , f. , mike , s. , and farmer , j. d. ( 2005 ) .",
    "theory for long memory in supply and demand .",
    "physical review e , 71(6 ) , 066122 .",
    "tth , b. , palit , i. , lillo , f. , and farmer , j. d. ( 2015 ) .",
    "why is equity order flow so persistent ?",
    "journal of economic dynamics and control , 51 , 218 - 239 .",
    "bouchaud , j .-",
    ", kockelkoren , j. , and potters , m. ( 2006 ) .",
    "random walks , liquidity molasses and critical response in financial markets . quantitative finance , 6(02 ) , 115 - 123 .",
    "eisler , z. , bouchaud , j .- p . , and kockelkoren , j. ( 2012 ) .",
    "the price impact of order book events : market orders , limit orders and cancellations . quantitative finance , 12(9 ) , 1395 - 1419 .",
    "tth , b. , lemperiere , y. , deremble , c. , de lataillade , j. , kockelkoren , j. , and bouchaud , j .-",
    "anomalous price impact and the critical nature of liquidity in financial markets .",
    "physical review x , 1(2 ) , 021006 .",
    "mastromatteo , i. , tth , b. , and bouchaud , j .-",
    "agent - based models for latent liquidity and concave price impact .",
    "physical review e , 89(4 ) , 042805 .",
    "donier , j. , bonart j. , mastromatteo i. , and bouchaud j .- p .",
    "( 2015 ) . a fully consistent , minimal model for non - linear market impact",
    ". quantitative finance , 15(7 ) , 1109 - 1121 .",
    "eisler , z. , bouchaud , j .- p . and kockelkoren , j. ( 2012 ) .",
    "models for the impact of all order book events , in market microstructure : confronting many viewpoints ( eds f. abergel , j .-",
    "bouchaud , t. foucault , c .- a .",
    "lehalle , and m. rosenbaum ) , john wiley & sons ltd , oxford , uk .",
    "raftery , a. e. ( 1985 ) .",
    "a model for high - order markov chains .",
    "journal of the royal statistical society .",
    "series b ( methodological ) , 528 - 539 .",
    "berchtold , a. ( 1995 ) .",
    "autoregressive modeling of markov chains .",
    "statistical modelling : proceedings of the 10th international workshop on statistical modelling , 19 - 26 .",
    "springer - verlag .",
    "tth , b. , eisler , z. , lillo , f. , kockelkoren , j. , bouchaud , j .-",
    "p . and farmer , j. d. ( 2012 ) .",
    "how does the market react to your order flow ?",
    "quantitative finance , 12(7 ) , 1015 - 1024 taranto , d. e. , bormetti , g. , and lillo , f. ( 2014 ) .",
    "the adaptive nature of liquidity taking in limit order books .",
    "journal of statistical mechanics : theory and experiment , 2014(6 ) , p06002 .",
    "jacobs , p. a. , and lewis , p. a. ( 1978 ) .",
    "discrete time series generated by mixtures .",
    "i : correlational and runs properties .",
    "journal of the royal statistical society .",
    "series b ( methodological ) , 94 - 105 .",
    "madhavan , a. , richardson , m. , and roomans , m. ( 1997 ) .",
    "why do security prices change ? a transaction - level analysis of nyse stocks . the review of financial studies , 10(4 ) , 1035 - 1064 ."
  ],
  "abstract_text": [
    "<S> market impact is a key concept in the study of financial markets and several models have been proposed in the literature so far . </S>",
    "<S> the transient impact model ( tim ) posits that the price at high frequency time scales is a linear combination of the signs of the past executed market orders , weighted by a so - called propagator function . </S>",
    "<S> an alternative description  the history dependent impact model ( hdim )  assumes that the deviation between the realised order sign and its expected level impacts the price linearly and permanently . </S>",
    "<S> the two models , however , should be extended since prices are a priori influenced not only by the past order flow , but also by the past realisation of returns themselves . in this paper </S>",
    "<S> , we propose a two - event framework , where price - changing and non price - changing events are considered separately . </S>",
    "<S> two - event propagator models provide a remarkable improvement of the description of the market impact , especially for large tick stocks , where the events of price changes are very rare and very informative . </S>",
    "<S> specifically the extended approach captures the excess anti - correlation between past returns and subsequent order flow which is missing in one - event models . </S>",
    "<S> our results document the superior performances of the hdims even though only in minor relative terms compared to tims . </S>",
    "<S> this is somewhat surprising , because hdims are well grounded theoretically , while tims are , strictly speaking , inconsistent . </S>"
  ]
}