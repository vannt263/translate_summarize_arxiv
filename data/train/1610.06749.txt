{
  "article_text": [
    "several chemical and solid - state methods have been developed in the past decades for measuring radiation dose , but ionization chamber dosimetry retains its position as the most common and often most convenient and precise method to determine the absorbed dose in clinical beams .",
    "consequently , dosimetry protocols , such as that from the international atomic energy agency ( trs-398 ) @xcite , recommend air - filled ionization chambers for reference dosimetry of therapeutic photon , electron , proton , and ion beams .    the charge in the ionization chamber is related to the absorbed dose . however , the charge collected at the electrodes is less than the charge in the ionization chamber , since some ion pairs are lost due to recombination .",
    "several theories for correction of the recombination losses have been proposed in the past : jaff @xcite investigated the _ initial recombination _",
    ", that is , recombination of charge carriers within a single ion track , in gas filled ionization chambers exposed to ion beams .",
    "jaff deduced a gaussian shaped charge carrier distribution which he applied throughout his work . by taking the mobility of the charge carriers and their geometric distribution in the electrical field into account",
    ", jaff derived an expression for the ionic collection efficiency , both for the ion tracks parallel and non - parallel to the electric field in the ionization chamber .",
    "jaff s work was later extended by kramers @xcite for initial recombination in liquid ionization chambers , where charge carrier mobilities are less than those in gas ( air ) . additionally ,",
    "since the cavity in the ionization chamber is in condensed phase rather than in gaseous phase , a higher charge carrier density is established . to a dramatic increase of recombination effects",
    "@xcite .",
    "boag @xcite investigated the recombination in pulsed ion beams , and later developed an extension to the work with hochhuser and balk  @xcite by including a free - electron component .",
    "the free - electron component represents the fraction of electrons which escape attachment to molecules , which else would form negative ions . in thomson s work on conduction of electricity through gases  @xcite , he formulated the equations that form the basis for _ general ( volume ) recombination _ correction , that is , recombination of charge carriers from different ion tracks in continuous beams .",
    "mie  @xcite presented approximate numerical solutions to thomson s theory on general recombination .",
    "these solutions were then applied by greening  @xcite to formulate the current formalism for general recombination in continuous beams .",
    "the initial recombination in electron or photon beams is normally neglected in clinical radiotherapy which leaves only general recombination to be corrected for .",
    "the situation is different in ion beams heavier than protons , where both initial and general recombination may occur .",
    "the trs-398 protocol provides recommendations for experimental determination of the recombination correction factor for either initial or general recombination in ion beams heavier than protons , and recommends the two voltage method  @xcite to be applied to correct for general recombination in pulsed beams .",
    "if the general recombination is negligible , it provides a linear relation to determine the recombination correction factor .",
    "also this linear relation assumes a 1/v dependency .",
    "et al . _",
    "@xcite pointed out that the two voltage method for pulsed beams , as described in trs-398 , overestimates the recombination correction with a factor up to 2% in proton beams .",
    "furthermore , trs-398 is only explicit for pulsed / scanning beams of ions heavier than protons .",
    "even more clinically relevant is intensity modulated particle therapy , where scanning beams may deliver very heterogeneous dose distributions both in space and in particular the time domain .",
    "general recombination in proton and heavier ion beams may therefore vary depending on the specific treatment plan delivered .",
    "high dose - rates with non - negligible general recombination may be seen along the core of the pencil beam when delivering large fields .",
    "recombination is a process involving low energy charged particles and can not currently be corrected satisfactorily for by monte carlo calculations .",
    "this is due to uncertainties in the cross sections at these low energies , motivating the application of amorphous track structure theory in ` iontracks ` , which is a more phenomenological approach @xcite .",
    "` iontracks `  allows an inclusion of a free - electron component to model the effect on recombination of electrons that do not attach to molecules to form negative ions .",
    "[ [ section ] ]    the jaff theory was experimentally validated by kanai",
    "_ et al . _",
    "@xcite for ions heavier than protons .",
    "track parameters based on @xcite for three ions heavier than hydrogen are given in table  [ tab : kanai_params ] , which mainly are used to obtain a substantial amount of initial recombination and to compare ` iontracks ` to jaff s theory .",
    "the collection efficiency @xmath0 in ` iontracks ` is calculated as @xmath1 where @xmath2 is the number of ions collected at the electrodes and @xmath3 is the number of ( initialised ) ions .",
    "l!l!l!l!l!l & unit & iron ion & neon ion & carbon ion & proton + energy & @xmath4 & 40 & 60 & 90 & 100 + let ( air ) & @xmath5 & 1.02 & 0.115 & @xmath6 & @xmath7 + track radius , @xmath8 & @xmath9 & 50 & 20 & 10.5 & 10 +      the linear charge carrier density @xmath10 , the number of charge carriers per unit length , along the path of the charged particle depends on the linear energy transfer ( let ) and @xmath11 , and is given as @xmath12 the linear ionization density is assumed to be constant throughout the ionization chamber @xcite .",
    "jaff modelled the radial charge carrier density @xmath13 in the track of a charged particle as @xmath14 where @xmath8 is the gaussian track radius and @xmath15 is the distance from the centre of the track .",
    "` iontracks `  uses the gaussian charge carrier distribution in the present work , although it should be noted that the algorithm is not limited to any particular type of charge carrier distribution .",
    "et al . _",
    "@xcite showed that the gaussian charge carrier distribution matches recombination experiments better than e.g.  the scholz - kraft parametrization  @xcite .",
    "the total number of charge carriers in an ion track is calculated as @xmath16 where @xmath17 is the length of the particle path between the electrodes .      the particle current density @xmath18 , in units of charge carriers per unit area per unit time , of both positive and negative ions , consists of contributions from the electric field @xmath19 and the concentration gradient and is given as @xmath20 where @xmath21 is the charge carrier density , @xmath22 the mobility , and @xmath23 the diffusion constant for positive and negative ions respectively .",
    "one may from the equation of continuity find @xmath24 where @xmath25 is the recombination constant and the right - hand side models the recombination of ions @xcite .",
    "( [ eq : cont_eq ] ) is traditionally rewritten as @xmath26 where @xmath27 is in units of charge carriers per unit volume per unit time and @xmath28 is the change in ion drift velocity caused by space charge screening effects .",
    "this effect screens the charge carriers from the external electric field , and results in a of the observed charge carrier s drift velocity towards the electrode of opposite polarity . consequently",
    ", more charge carriers will recombine before they reach the electrodes .",
    "the space charge screening term is usually neglected along with initial recombination for low - let particles such as protons .",
    "however , the present inclusion of dense heavy ion tracks increases the space charge screening effect which therefore is included for a more precise study of the recombination process .    the non - linear partial differential equations in eq .",
    "( [ eq : theequation ] ) govern the movements of the charge carriers .",
    "the equations do not have analytical solutions but will be approximately solved by an explicit numeric time integration using the lax - wendroff technique @xcite . in the case of a free - electron component ,",
    "the electrons are treated as negative charge carriers , but with different mobility and diffusion constant from those of the negative ions .",
    "@lcll!c constant & symbol & unit & value & reference + positive ion diffusion & @xmath29 & @xmath30 & @xmath31 & @xcite + negative ion diffusion & @xmath32 & @xmath30 & @xmath33 & @xcite + positive ion mobility & @xmath34 & @xmath35 & @xmath36 & @xcite + negative ion mobility & @xmath37 & @xmath35 & @xmath38 & @xcite + recombination constant & @xmath25 & @xmath39 & @xmath40 & @xcite +      when the ion track is parallel to the electric field , the jaff theory for initial recombination @xcite gives a collection efficiency as @xmath41   \\label{eq : jaffe_noangle}\\ ] ] for @xmath42 where @xmath43 is the exponential integral , , and @xmath44 is the electric field strength .",
    "the collection efficiency @xmath45 , for an ion track rotated an angle @xmath46 to the electric field , is approximated as @xcite @xmath47 with @xmath48 where @xmath49 is the hankel function of first kind and order zero .",
    "immediately after a charged particle has ionized the medium between the electrodes there will be no negative ions .",
    "the negative ions are subsequently formed as the free electrons diffuse and drift and attach to oxygen molecules .",
    "the fraction @xmath50 of all electrons that remain free from attachment to molecules is @xcite @xmath51 where @xmath52 , in units of inverse length , is a coefficient depending on the gas parameters and the strength of the electric field and @xmath53 is the electrode gap . for the present simulations , the initial concentration of negative ions @xmath54 and electrons @xmath55 as a function of the distance from the anode ( @xmath56 ) to the cathode ( @xmath57 )",
    "is given by @xcite as @xmath58 when an ion track is parallel to the electric field .",
    "et al . _",
    "@xcite proposed three different models to include the free - electron component in eq .",
    "( [ eq : ion_elec_distribution ] ) .",
    "the results of the three proposed models are : @xmath59 for @xmath60 where @xmath61 is the polarisation voltage of the chamber .",
    "the recombination of charge carriers of opposite sign , resulting in a loss of charge , is counted continuously throughout the simulation .",
    "the initial setup is sketched in figure  [ fig : setup](a ) where an ion has ionized the medium between the electrodes at an angle @xmath62 $ ] , relative to the electric field , in the solution domain @xmath63 , @xmath64 , and @xmath65 .",
    "the spatial dimensions @xmath66 and @xmath67 are chosen large enough to ensure that no significant amount of charge carriers initialised in the array can drift out of the array in a direction perpendicular to the electric field .",
    "@xmath68 corresponds to the length of the electrode gap .",
    "the charge carriers are removed from the array as they reach either of the electrodes ( @xmath56 and @xmath69 ) corresponding to charge collection .",
    "thus , the boundary conditions are @xmath70 for all times .",
    "the initial charge carrier distributions are evolved in time and space on the defined solution domain , as governed by eq .",
    "( [ eq : theequation ] ) , by applying the spatial and temporal derivatives in the appendix .",
    "the explicit lax - wendroff scheme , where a subsequent time step is directly evaluated at the current time step , is in this case computationally faster than an implicit scheme as the crank - nicolson @xcite , where a subsequent time step is found by solving an equation .",
    "the superiority in speed is advantageous when dealing with a huge number of computations as in the present case .    for a direct comparison with the jaff theory of recombination @xcite",
    ", a single ion track is initialised in the array as given by eq .",
    "( [ eq : gaussian ] ) .",
    "the ion track is either initialised parallel or rotated an angle @xmath62 $ ] to the electric field .",
    "the algorithm is implemented in ` python ` while computationally demanding routines are converted to the ` c ` based ` cython ` using @xcite which reduces the computation time with orders of magnitude .",
    "the simulation of a single ion track with a space gap of 2 mm takes less than a minute threaded on a laptop with whereas pulsed or continuous beams require several minutes .",
    "the electron drift velocity is tabulated in @xcite for different electric field strengths . due to a lack of experimentally determined values of the diffusion constant @xmath71 for electrons ,",
    "the values are estimated from the einstein relation @xmath72 where @xmath73 is the mobility of electrons calculated from the drift velocity and corresponding electric field , @xmath74 is boltzmann s constant , @xmath75 the absolute temperature , and @xmath76 the electric charge .",
    "the algorithm is modified slightly in order to include electron movements :    1 .",
    "the time step @xmath77 is first computed to be in accordance with von neumann s criterion for the electrons and the simulation is started . during the time it takes for the electrons to be completely collected , the ions will not move significantly and basically no charge carriers will recombine .",
    "2 .   when the electrons have been collected , the time step @xmath77 is re - calculated for the positive and negative ions and the simulation is continued .",
    "the new time step is orders of magnitudes larger than that used for the electron movements .",
    "generally , the simulation is stopped as the charge carrier distributions of opposite sign have been dragged completely apart .      in `",
    "iontracks ` , a pulsed beam may be considered to be either instantaneous or to consist of short continuous beam segments of any shape .",
    "the ion tracks in such a continuous beam segment are stochastic on the microscopic time scale , and poisson distributed with an expectation value given by the fluence - rate @xmath78 .",
    "the fluence - rate is modelled as the product of a spatial component , the fluence @xmath79 , and a time - dependent component @xmath80 ( in units of @xmath81 ) , i.e.  @xmath82 .",
    "the surface area of a simulated ionization chamber is typically of the order of @xmath83 since a simulation of the entire chamber is too computationally demanding with our current resources .",
    "the ionization chamber is assumed to be uniformly irradiated which allows the results obtained in the chosen section of the ionization chamber to be transferred to the entire chamber .",
    "the ion tracks are distributed uniformly inside a circle with radius @xmath84 in the @xmath85-plane as sketched in figure  [ fig : setup](b ) .",
    "a larger radius @xmath86 defines the electrode widths @xmath87 .",
    "the outer radius ensures that no ions are lost due to diffusion in a direction perpendicular to the electric field before they have been collected at the electrodes .",
    "an example of the simulation of a continuous beam is sketched in figure  [ fig : setup](b ) where three ion tracks have been initialised at different times and at random spatial coordinates .",
    "the charge carriers in the track initialised at time @xmath88 have had time to diffuse further than those in the track initialised at time @xmath89 , and general recombination occurs in the overlapping region between the two tracks .",
    "conversely , only initial recombination occurs in the ion track initialised at time @xmath90 .",
    "the numerical precision of the algorithm is investigated by improving the grid resolution until a satisfactory convergence is obtained , based on the two requirements below :    1 .   if @xmath10 in eq .",
    "( [ eq : linear_density ] ) denotes the linear charge carrier density along the @xmath91-direction , i.e. @xmath92 in figure  [ fig : setup](a ) , and @xmath93 as in eq .",
    "( [ eq : gaussian ] ) the charge carrier density , then @xmath94 must equal the linear charge carrier density @xmath10 at @xmath88 for conservation of charge carriers .",
    "the integrals are evaluated with simpson s rule as implemented in the ` python ` module of same name .",
    "2 .   the collection efficiency in eq .  ( [ eq : collection_efficiency ] ) of a given initial configuration must converge to the same result if the simulation is repeated with the exact same initial and boundary conditions and ion track distributions .",
    "the two cases are studied in figure  [ fig : stability ] for fixed array widths @xmath95 using the neon ion track parameters in table  [ tab : kanai_params ] .",
    "some charge carriers are lost in the array as the gaussian distribution is truncated at some point , hence @xmath96 as seen in figure  [ fig : stability](a ) . at @xmath97 , roughly @xmath98 of the charge carriers are not initialised in the array but an inspection of the charge carrier distribution revealed that the majority of the lost charge carriers were missing at the gaussian tails .",
    "since recombination is a process that depends on the product of the positive and negative charge carrier densities , the effect of the lacking charge carriers at the gaussian tails thus is negligible .",
    "the collection efficiency calculated with ` iontracks ` converges to the same value if the simulation is repeated with the same initial and boundary conditions , and henceforth a grid spacing corresponding to @xmath99 is applied .",
    "` iontracks ` is used to calculate the collection efficiency for the three heavy ion tracks in table  [ tab : kanai_params ] at different electric field strengths .",
    "the simulation parameters are listed in table  [ tab : params ] and the electrode spacing was @xmath100 .",
    "the case of ion tracks parallel to the electric field is shown in figure  [ fig : jaffe](a ) where an excellent agreement with jaff s theory eq .",
    "( [ eq : jaffe_noangle ] ) is seen for all three types of heavy ion tracks , i.e.  different let s and corresponding track radii .",
    "the situation of the 60mev / u neon ion track rotated by an angle @xmath101}$ ] to the electric field is shown in figure  [ fig : jaffe](b ) . here , ` iontracks ` is in accordance with jaff s theory as well , but the discrepancy is increasing with decreasing angle , which is attributed to the fact that the approximated collection efficiency in eq .",
    "( [ eq : angle ] ) only is valid for large angles .",
    "the overall agreement between jaff s theory and ` iontracks ` implies that the algorithm correctly calculates the collection efficiency for initial recombination .",
    "the collection efficiencies in a 100mev proton beam at different electric field strengths were calculated with ` iontracks ` for two different doses @xmath102 , where the entire dose was delivered in an instantaneous pulse .",
    "calculations with ` iontracks `  confirm the negligible amount of initial recombination ( @xmath103 ) due to the low let of a 100mev proton .",
    "the results are compared to those from boag s free - electron models 1 , 2 , and 3 in figure  [ fig : free_elec](a ) for @xmath104 , for which all three models .",
    "the convincing accordance between theory and ` iontracks ` implies that the simulation of general recombination works correctly .",
    "boag s models for negative charge carrier distributions are in figure  [ fig : free_elec](b ) compared to ` iontracks ` for @xmath105 and @xmath106",
    ". for @xmath105 model 1 seems to be the most appropriate model and all models converge toward the results obtained with ` iontracks ` as the electric field is increased , i.e.  the recombination is decreased .",
    "the negative charge carrier distributions in the three boag models all differ from the distribution they have in ` iontracks ` , i.e.  eq .  ( [ eq : ion_elec_distribution ] ) , and the results in figure  [ fig : free_elec](b ) consequently deviate from unity . for low electric fields this discrepancy is increased . for larger fractions of @xmath50 ,",
    "model 3 fits the actual distribution of negative charge carriers best , which also is reflected in figure  [ fig : free_elec](b ) for @xmath106 .",
    "this agrees with the conclusions obtained by boag _",
    "et al . _  in @xcite .",
    "` iontracks ` is numerically stable and in excellent agreement with the jaff theory for initial recombination .",
    "jaff s theory has been experimentally validated @xcite , which leads to the conclusion that ` iontracks ` correctly simulates the initial recombination in heavy ion tracks .",
    "similarly , the simulation of a 100mev pulsed proton beam permits a comparison between ` iontracks ` and the two voltage method at two doses .",
    "the good agreement at both doses leads to the conclusion that also general recombination is simulated correctly .",
    "furthermore , two voltage method were investigated , where the best agreement was found between ` iontracks ` and model 3 , which is in accordance with the conclusion in @xcite .",
    "space charge screening of the collection field is included in ` iontracks ` .",
    "the agreement with the two voltage method , which does not take space charge into account , implies that the space charge screening term can be neglected in low - let radiation such as protons , also concluded by @xcite for photons .    `",
    "iontracks ` currently is extended to include particle energy spectra from fluka  @xcite and shield - hit12a  @xcite in order to simulate the recombination in particle - energy spectra as e.g.  found in degraded or mixed ion beams .",
    "furthermore , the algorithm can quantify for what heavy charged particle fluences ( or fluence - rates ) the recombination makes a transition from being solely initial to a non - linear combination of initial and general recombination , that is , the transition where track overlap is non - negligible anymore . given the dose - rate and particle - energy spectrum , `",
    "iontracks `  has the ability to quickly calculate recombination correction factor in ion beams .",
    "the authors wish to thank prof .",
    "bjarne thomsen at the department of physics and astronomy , aarhus university , for providing access to his computer cluster .",
    "the authors have no relevant conflicts of interest to disclose .",
    "let the solution domain be an array with spatial dimensions @xmath66 , @xmath67 , and @xmath68 and the time it takes to collect all charge carriers @xmath107 .",
    "the solution domain consists of a mesh of grid - lines @xmath108 where @xmath109 , @xmath110 , @xmath111 are the number of voxels in the @xmath112- , @xmath113- , @xmath91-directions respectively , and @xmath114 the number of time steps , given constant grid spacings @xmath115 , @xmath116 and time step @xmath77 . the charge carrier density @xmath117 is approximated as @xmath118 at the point of intersection of the grid - lines @xmath119 , i.e.  the grid - point @xmath120 .",
    "let @xmath121 be weights , where @xmath122 is the magnitude of the electric field in the @xmath112-direction , with similar weights in the @xmath113- and @xmath91-directions .",
    "the derivatives in the lax - wendroff scheme @xcite are then given as @xmath123 @xmath124 @xmath125 and similarly in the @xmath113- and @xmath91-directions .",
    "the largest applicable time step @xmath77 is found by computing the largest time step fulfilling the ( for positive and negative charge carriers ) four equations @xmath126 however , a time step @xmath77 fulfilling the equations in eq .",
    "( [ eq : vneum ] ) is only applicable if simulations with identical initial and boundary conditions and track distributions always converge to the same result .",
    "peach kj , cobb jh , sheehy sl , witte h , yokoi t , aslaninejad m , easton mj , pasternak j , barlow r , owen hl , tygier sc , beard cd , mcintosh pa , smith sl , tzenov si , bliss n , edgecock r , pozimski jk , rochford j , fenning rjl , khan a , johnstone c , jones b , vojnovic b , kelliher dj , machida s , rogers ct , seviour r. pamela overview : design goals and principles .",
    "karsch l , pawelke , j. theoretical investigation of the saturation correction for ionization chambers irradiated with pulsed beams of arbitrary pulse length zeitschrift fur medizinische physik .",
    "2014;24(3):201 - 210      saminathan s , chandraraj v , sridhar ch , manickam r. comparison of individual and composite field analysis using array detector for intensity modulated radiotherapy dose verification reports of practical oncology & radiotherapy .",
    "2012:17(3);157162            toftegaard j , lhr a , sobolevsky n , bassler n. improvements in the stopping power library ` libdedx ` and release of the web gui dedx.au.dk . in : journal of physics : conference series .",
    "vol . 489 ; 2014 .",
    "p. 012003 .",
    "crank j , nicolson p. a practical method for numerical evaluation of solutions of partial differential equations of the heat - conduction type . in : mathematical proceedings of the cambridge philosophical society .",
    "cambridge univ press ; 1947 .",
    "p. 5067 .",
    "bassler n , hansen dc , lhr a , thomsen b , petersen j , sobolevsky n. a monte carlo particle transport program for ion therapy research . in : journal of physics : conference series .",
    "iop publishing ; 2014 .",
    "p. 012004 ."
  ],
  "abstract_text": [
    "<S> dosimetry with ionization chambers in clinical ion beams for radiation therapy requires correction for recombination effects . </S>",
    "<S> however , common radiation protocols discriminate between initial and general recombination and provide no universal correction method for the presence of both recombination types in ion beams of charged particles heavier than protons . here </S>",
    "<S> , we present the open source code iontracks , where the combined initial and general recombination effects in principle can be predicted for any ion beam with arbitrary particle - energy spectrum and temporal structure . </S>",
    "<S> iontracks uses track structure theory to distribute the charge carriers in ion tracks . </S>",
    "<S> the charge carrier movements are governed by a pair of coupled differential equations , based on fundamental physical properties as charge carrier drift , diffusion , and recombination , which are solved numerically while the initial and general charge carrier recombination is computed .    </S>",
    "<S> the algorithm is numerically stable and in accordance with experimentally validated theories for initial recombination in heavy ion tracks and general recombination in a proton beam .    </S>",
    "<S> iontracks is validated against the jaff s and boag s theory of recombination in pulsed beams of multiple ion species . </S>",
    "<S> iontracks is able to calculate the correction factor for initial and general recombination losses in parallel - plate ionization chambers . </S>",
    "<S> even if only few experimental data on recombination effects in ionization chambers are available today , the universal concept of iontracks is not limited to the ions investigated here . </S>",
    "<S> future experimental investigations of recombination in pulsed and possibly also continuous ion beams may be conducted with iontracks , which ultimately may lead to a more precise prediction of recombination factors in complex radiation fields . </S>"
  ]
}