{
  "article_text": [
    "the following problem was posed in the 2008 irish intervarsity mathematics competition :    _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ in a room there are 2008 bulbs and 2008 buttons , both sets numbered from 1 to 2008 . for @xmath2 , pressing button @xmath1 changes the on / off status of bulb @xmath1 and one other bulb ( the same other bulb each time ) .",
    "assuming that all bulbs are initially off , prove that by pressing the appropriate combination of buttons we can simultaneously light at least 1340 of them . prove also that in the previous statement , 1340 can not be replaced by any larger number .",
    "_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _    this problem , henceforth referred to as the _ prototype problem _ , can be generalized in a variety of ways :    1 .",
    "most obviously , `` 2008 '' can be replaced by a general integer @xmath0 .",
    "2 .   we can consider more general wirings @xmath3 , where each button changes the on / off status of a ( possibly non - constant ) number of bulbs .",
    "we may consider initial configurations @xmath4 where not all of the bulbs are off .",
    "we however insist that the numbers of buttons and bulbs are equal , and that button @xmath1 changes the on / off status of bulb @xmath1 , @xmath5 .",
    "such problems are rather closely related to the type of problem known as max - xor - sat in computer science .",
    "we discuss this connection in more detail in the next section .",
    "figure [ figure1 ] is a sketch of a typical wiring .    before we continue , let us introduce a little notation . for a fixed wiring @xmath3 , where the initial configuration of the bulbs is given by @xmath4 , let @xmath6 be the maximum number of bulbs that can be lit by pressing any combination of the buttons .",
    "suppose @xmath7 .",
    "let @xmath8 be the minimum value of @xmath6 over all wirings @xmath3 of @xmath0 buttons and bulbs , where button @xmath1 is connected to _ at most _",
    "@xmath9 bulbs , including bulb @xmath1 , for each @xmath10 , and initially all bulbs are off ( which we write as `` @xmath11 '' ) .",
    "if additionally @xmath12 , let @xmath13 be the minimum value of @xmath6 over all wirings @xmath3 of @xmath0 buttons and bulbs , where button @xmath1 is connected to _",
    "exactly _ @xmath9 bulbs , including bulb @xmath1 , for each @xmath10 , and @xmath11 .",
    "thus the prototype problem is to show that @xmath14 .",
    "we define @xmath15 , which trivially equals @xmath8 for all @xmath16 .",
    "thus @xmath17 is the minimum value of @xmath18 , over all wirings of the @xmath0 buttons , subject only to condition ( d ) above .",
    "we also define @xmath19 , @xmath20 , and @xmath21 in a similar manner to @xmath8 , @xmath13 , and @xmath17 , respectively , except that we take the minima over all possible initial configurations @xmath4 , rather than taking @xmath11 . in this paper , we are mainly interested in @xmath8 and @xmath13 , and we compute these functions for @xmath22",
    ". however the more easily calculated @xmath23-variants will be useful , so we compute them in all cases .",
    "our first theorem gives formulae for @xmath24 and @xmath25 ; note that @xmath26 except when @xmath27 .",
    "[ t : m=2 ] let @xmath28 .",
    "1 .   @xmath29 .",
    "2 .   if @xmath30 , then @xmath31 is the least even integer not less than @xmath24 .",
    "next we give formulae for @xmath32 and @xmath33 .",
    "[ t : m=3 ] let @xmath28 .",
    "1 .   @xmath34 .",
    "2 .   if @xmath35 , then @xmath36    note that @xmath37 in the exceptional case @xmath38 .",
    "we discuss @xmath8 and @xmath13 in the case @xmath39 in a separate paper @xcite .",
    "let us note here only that @xmath8 and @xmath13 are no longer asymptotic to @xmath40 for large @xmath0 , when @xmath41 .",
    "for instance , we prove in @xcite that @xmath42 is asymptotic to @xmath43 , and that @xmath44 .    after some preliminaries in the next section , where we also discuss the connection between this problem and max - xor - sat , we prove general formulae for @xmath19 and @xmath20 in .",
    "we then prove in and in .",
    "we wish to thank david malone for pointing out the connection between our results and sat .",
    "the notation and terminology introduced in this section will be used throughout the paper .",
    "we begin by recasting our problem .",
    "first note that we can replace the twin notions of buttons and bulbs with the single notion of vertices : when a vertex is pressed , the on / off state of that vertex and some other vertices is switched .",
    "the vertex set @xmath45 is associated with a directed graph @xmath46 : we draw an edge from vertex @xmath1 to each vertex @xmath47 whose on / off status is altered by pressing vertex @xmath1 . figure [ figure2 ] shows a representation of the directed graph corresponding to the wiring in figure [ figure1 ] .",
    "notice that we do not include a loop from each vertex to itself , even though it is understood that a given switch always switches the corresponding bulb .    associated with a given directed graph",
    "@xmath46 is the _ edge function _",
    "@xmath48 , where @xmath49 if @xmath50 or if there is an edge from @xmath1 to @xmath51 , and the _ backward edge function _",
    "@xmath52 , where @xmath53 if @xmath50 or if there is an edge from @xmath51 to @xmath1 .",
    "we extend the definitions of @xmath54 and @xmath55 to @xmath56 in the usual way : @xmath57 and @xmath58 are the unions of @xmath59 or @xmath60 , respectively , over all @xmath61 .",
    "we say that @xmath62 is _ forward invariant _",
    "if @xmath63 , or _ backward invariant _ if @xmath64 .",
    "we denote by @xmath65 the subgraph of @xmath46 consisting of the vertices in @xmath66 and all edges between them .",
    "if we examine the effect of a finite sequence of vertex presses @xmath67 , on a fixed vertex @xmath68 , it is clear that the final on / off state of vertex @xmath68 depends only on its initial state and the parity of the number of indices @xmath51 , @xmath69 , for which @xmath70 . in particular , the order of the vertices in our finite sequence is irrelevant to the final state of @xmath68 . since this is true for each vertex , we readily deduce the following :    * the order of a finite sequence of vertex presses is irrelevant to the final on / off states of all vertices .",
    "* we may as well assume that each vertex is pressed at most once , since pressing it twice produces the same effect as not pressing it at all .    thus instead of talking about a _",
    "finite sequence _ of vertex presses , we can talk about a _ set _ of vertex presses and represent this set as an @xmath0-dimensional column vector @xmath71 ( where @xmath72 denotes the field with two elements ) , with @xmath73 if and only if vertex @xmath1 is pressed once and @xmath74 if it is not pressed at all .",
    "similarly , we represent the initial on / off state of the vertices by a column vector @xmath75 , with @xmath76 if and only if vertex @xmath1 is initially lit .",
    "lastly , we represent the wiring @xmath3 as an element in @xmath77 , the space of @xmath78 matrices over @xmath79 .",
    "specifically , @xmath80 , where @xmath81 if and only if vertex @xmath51 affects the on / off status of vertex @xmath1 ; we insist that @xmath82 for all @xmath83 .",
    "the _ degree of vertex @xmath1 _ ,",
    "@xmath84 , is the number of @xmath85s in the @xmath1th column of @xmath3 ( or equivalently the cardinality of @xmath59 ) , and the _ degree of @xmath3 _ ,",
    "@xmath86 , equals @xmath87 .",
    "we use a @xmath88-superscript for matrix transposition , and @xmath89 is the @xmath90 identity matrix .    for @xmath91",
    ", we define @xmath92 to be the hamming `` norm '' or hamming distance from @xmath93 to the origin , i.e.  the number of @xmath85 entries in @xmath93 . with the above definitions for @xmath94 , @xmath4 , @xmath3 , the vector @xmath95 is such that @xmath96 if and only if vertex @xmath1 is lit , assuming we have initial configuration @xmath4 , wiring @xmath3 , and vertex presses given by @xmath94 .",
    "moreover , @xmath97 is the number of lit vertices .",
    "the function @xmath6 defined in the introduction can now be described as @xmath98 .    for @xmath7 , we define @xmath99 to be the set of matrices in @xmath100 that have @xmath85s all along the diagonal and satisfy @xmath101 .",
    "if also @xmath12 , we define @xmath102 to be the set of matrices in @xmath99 for which @xmath103 , for all @xmath83 .",
    "these classes of matrices are the classes of admissible wirings for the functions defined in the introduction : @xmath104 the largest class of admissible wirings on @xmath0 vertices that interests us is @xmath105 .",
    "this gives rise to the numbers @xmath106 and @xmath107 , as defined in the introduction .",
    "it is convenient to define @xmath108 for all @xmath109 .",
    "although the hamming distance is a central part of the problems under consideration , these problems are on the surface quite different from those in coding theory , since we are looking for wirings that minimize the maximum distance from the origin of @xmath110 , @xmath71 , whereas in coding theory we are looking for codes that maximize the minimum distance between codewords .",
    "however , it is shown in @xcite that sylvester - hadamard matrices , which are known to give rise to hadamard codes that possess a certain optimality property , also give rise to certain optimal wirings .",
    "we say that a subgraph @xmath111 of @xmath46 with @xmath112 vertices is a _",
    "complete subgraph ( on @xmath112 vertices ) _ if there is an edge from every vertex of @xmath111 to every other vertex of @xmath111 . for brevity",
    ", we call a complete subgraph on @xmath112 vertices a @xmath113 from now on , and a _ @xmath113 set _ is just the set of vertices of a @xmath113 .",
    "the problems under consideration in this paper are closely related to max - xor - sat problems in computer science .",
    "these problems are in the general area of propositional satisfiability ( _ sat _ ) .",
    "specifically we want to assign values to booloean variables so as to maximize the number of clauses that are true , where each clause is composed of a set of variables connected by xors .",
    "since xor in boolean logic corresponds to addition mod 2 , this problem can be written in our notation as follows : given a matrix @xmath114 , we wish to choose a _ variables vector _",
    "@xmath115 so as to maximize the hamming norm @xmath116 ; the @xmath117 entries in @xmath118 are the _",
    "clauses_. thus the goal is to compute @xmath18 .",
    "xor - sat and max - xor - sat has been studied extensively in recent years ; see for instance @xcite , @xcite , @xcite , @xcite .",
    "algorithms for solving such problems are useful in cryptanalysis @xcite , @xcite .",
    "the relationship between max - xor - sat and our wiring problem is plain to see , so let us instead mention the differences :    * max - xor - sat is concerned with finding @xmath18 for a fixed but arbitrary @xmath3 , rather than seeking the minimum of @xmath18 over a class of admissible @xmath3s .",
    "the main problems in max - xor - sat revolve around the efficiency of the computation of @xmath18 for large @xmath0 rather than the computation of a minimum for all @xmath0 . * in max - xor - sat",
    ", there is no requirement that @xmath119 , and so no matching of clauses with variables ( or bulbs with buttons in our terminology ) and no requirement that @xmath120 .",
    "* in max - xor - sat and other sat problems ,",
    "the typical simplifying assumption is that there are either exactly , or at most , @xmath9 variables in each clause .",
    "thus in sat we typically bound the hamming norms of the rows of @xmath3 , while in our wiring problem we bound the hamming norms of the columns of @xmath3 .    in spite of the differences",
    ", we would hope that the lower bounds in @xmath18 given by our results might be of some interest to max - xor - sat researchers .",
    "given @xmath12 , the following inequalities are immediate : @xmath122    we now establish a lower bound for @xmath6 .    [",
    "l : mean ] let @xmath28 . for all @xmath123 and @xmath75 ,",
    "the mean value of @xmath124 over all @xmath71 is @xmath125 .",
    "in particular , @xmath126 and @xmath127 if the cardinality of @xmath128\\cap\\n\\mid c_i=1\\}$ ] is not @xmath125 .",
    "fix @xmath3 and @xmath4 .",
    "let @xmath129 and @xmath130 . both @xmath131 and @xmath132 have cardinality @xmath133 and , since pressing vertex @xmath1 toggles its own on / off status",
    ", the number of @xmath134 with @xmath1 lit ( i.e.  @xmath135 ) equals the number of @xmath136 with @xmath1 unlit ( i.e.  @xmath137 ) . thus letting @xmath94 range over @xmath138 ,",
    "the mean value of @xmath139 is @xmath140 , and the mean value of @xmath97 is @xmath125 .",
    "the last statement in the lemma follows easily .",
    "the above lemma is a key tool in proving the following result which gives the general formula for @xmath19 and @xmath20 . in this result",
    ", we ignore the case @xmath141 since trivially @xmath142 .",
    "[ t : nu ] let @xmath143 , @xmath144 .    1",
    ".   @xmath145 .",
    "2 .   if @xmath12 , then @xmath146 in particular , @xmath147 for all @xmath148 .",
    "we will prove each identity by showing that the right - hand side is both a lower and an upper bound for the left - hand side .    by , @xmath149 for all @xmath123 and @xmath75 .",
    "this global lower bound yields the desired lower bound for @xmath21 and _ a fortiori _ for @xmath19 and for @xmath20 except in the case where @xmath0 is even and @xmath9 is odd .",
    "fix @xmath75 and @xmath150 for some odd @xmath144 and @xmath12 .",
    "each vertex press must change the parity of the number of lit vertices and , since the mean value of @xmath97 is @xmath125 , it follows that @xmath151 for some @xmath71 . since @xmath152",
    "if @xmath0 is even , we deduce that @xmath153 if @xmath0 is even and @xmath9 odd .    to prove the reverse inequalities , we take as our initial configuration the _ even indicator vector _",
    "@xmath154 defined by @xmath155 when @xmath1 is even , and @xmath156 when @xmath0 is odd .",
    "we split the set of integers between @xmath85 and @xmath0 into pairs @xmath157",
    ", @xmath158 , with @xmath0 being unpaired if @xmath0 is odd ; corresponding to the pairs of integers , we have _ pairs of rows _ in the wiring matrix @xmath3 and _ pairs of vertices_. for each proof of sharpness , we will define @xmath80 such that @xmath159 equals the desired lower bound . pressing vertex @xmath51 has no effect on",
    "the pair of vertices @xmath160 and @xmath161 if @xmath162 , and it toggles both of them if @xmath163 . since initially one vertex in each pair is lit , this remains true regardless of what vertices we press if the corresponding pair of rows are equal to each other ( as will be the case for most pairs of rows ) .",
    "thus , in calculating @xmath159 , we can ignore all pairs of equal rows , for which the corresponding vertex presses leaves the number of lit vertices unchanged , and we only have to consider the vertices that do not come in equal pairs .    for @xmath164 ,",
    "we denote by @xmath165 the @xmath166 matrix all of whose entries equal @xmath88 , and let @xmath167 .",
    "the matrix @xmath168 should not be confused with the identity matrix @xmath169 .",
    "to finish the proof of ( a ) , it suffices to show that @xmath170 .",
    "define the @xmath78 block diagonal matrix @xmath171 in case @xmath172 , this matrix corresponds to the wiring of nine switches and bulbs represented by figure [ figure3 ] . in this figure ,",
    "the boxes labelled by the number @xmath173 represent complete directed graphs on two vertices , and the small circle represents a single vertex .",
    "we shall always indicate a @xmath174 subgraph by a box labelled @xmath175 .    then @xmath176 and @xmath177 . to see this , note that rows @xmath160 and @xmath161 of @xmath3 are equal to each other for each @xmath178 .",
    "thus when @xmath0 is even , @xmath179 is independent of @xmath94 , while it toggles between the two values @xmath180 and @xmath181 when @xmath182 is odd , due to the change in the state of vertex @xmath0 each time that vertex is pressed .",
    "it remains to prove that the desired formula for @xmath20 is also an upper bound for @xmath20 when @xmath183 .",
    "suppose first that @xmath184 is even .",
    "first define the block diagonal matrix @xmath185 by the formula @xmath186 , where there are @xmath187 copies of @xmath188 .",
    "we modify @xmath189 to get a matrix @xmath190 by adding @xmath191 @xmath85s to the end of the first @xmath184 columns , i.e.  let @xmath192 in case @xmath172 and @xmath193 , the matrix @xmath3 corresponds to a wiring of the kind indicated in figure [ figure4 ] .    in this diagram ,",
    "the boxes indicate complete subgraphs having two or three vertices , as indicated .",
    "a single arrow coming from a @xmath194 box indicates an edge from _ each _ of the two vertices in the box and going to _ the same _ vertex in the @xmath195 .",
    "the target vertex may be the same or different for the three @xmath194 s , but the vertices in a given @xmath194 share the same target .",
    "in general , in our diagrams , we will use the convention that all the switches corresponding to vertices in a given @xmath174 box produce exactly the same effect .",
    "notice that nonisomorphic graphs may correspond to the same box diagram \" , in view of the fact that a box diagram is not specific about the targets of some arrows .",
    "all paired rows of @xmath3 are equal , so if @xmath0 and @xmath9 are both even , then @xmath196 for all @xmath71 , whereas if @xmath0 and @xmath9 are both odd , the value of @xmath179 is either @xmath197 or @xmath198 , depending on the parity of @xmath199 . in either case , we have found a matrix @xmath150 with @xmath200 , and so @xmath201 .",
    "suppose next that @xmath0 is odd and @xmath9 even , with @xmath202 .",
    "we first define the block diagonal matrix @xmath185 by the formula @xmath203 , where there are @xmath204 copies of @xmath188 and @xmath205 and then define @xmath80 by the equation @xmath206 the corresponding wiring is indicated schematically in figure [ figure5 ] .",
    "the circled subgraph corresponds to the matrix @xmath207 .",
    "the first @xmath208 rows can be split into duplicate pairs as before , so the associated pairs of vertices will always be of opposite on / off status and the number of them that is lit is always @xmath209 .",
    "initially two of the last three vertices are lit .",
    "since @xmath9 is even , the parity of the number of lit vertices is preserved , and so no more than two of the last three vertices can be lit .",
    "thus @xmath210 in this case , as required .",
    "the case where @xmath9 is odd and @xmath202 is even , is similar .",
    "we first define @xmath185 by the formula @xmath211 , and then define @xmath80 from @xmath212 by .",
    "the corresponding wiring is indicated schematically in figure [ figure6 ] .",
    "there are four unpaired rows , namely rows @xmath1 , @xmath213 . by an analysis similar to the previous case , at most three of these vertices",
    "can be lit ( namely vertex @xmath9 and at most two of the other three vertices ) , and half of the remaining @xmath214 vertices are always lit .",
    "it follows that @xmath215 , as required .",
    "finally if @xmath216 , we define @xmath3 to be the block diagonal matrix @xmath217 see figure [ figure7 ] .",
    "the first @xmath9 or @xmath218 rows are paired , depending on whether @xmath9 is even or odd , respectively . thus @xmath219 if @xmath9 is even , or @xmath220 if @xmath9 is odd , as required .",
    "generalizing an idea used in the above proof , we see that if @xmath3 and @xmath4 have block forms @xmath221 then @xmath222 this readily yields the following :    if @xmath223 is any one of the four functions @xmath224 , @xmath225 , @xmath23 , or @xmath121 , then it is sublinear in the first variable : @xmath226 as long as this equation makes sense ( i.e.  we need @xmath227 if @xmath228 or @xmath229 ) .",
    "trivially @xmath231 , and it is easy to check that @xmath232 . taking @xmath207 as in , we see that @xmath233 , and so @xmath234 . by combining with these facts",
    ", we see that for @xmath235 , @xmath236 , and @xmath237 , @xmath238 since @xmath239 , this gives the sharp upper bound for @xmath24 .",
    "the corresponding sharp upper bound for @xmath25 follows similarly when @xmath240 has the form @xmath241 or @xmath242 , @xmath236 .",
    "if @xmath243 , @xmath244 , only a small change is required to the @xmath224-proof to get a proof of the sharp @xmath225 upper bound : @xmath245    it remains to show that we can reverse the above inequalities .",
    "we first examine the reverse inequalities for @xmath225 , so fix @xmath246 .",
    "writing @xmath48 for the edge function , where @xmath45 , we get a well - defined function @xmath247 by writing @xmath248 whenever there is an edge from @xmath1 to @xmath51 in the associated graph @xmath46 . for a dynamical system on any finite set ,",
    "every point is either periodic or preperiodic . in our context",
    ", this just means that if we apply @xmath249 repeatedly to any initial vertex @xmath83 , then we eventually get a repeat of an earlier value , and from then on the iterated values of @xmath249 go in a cycle .",
    "note that the topological components of @xmath46 do not `` interfere '' with each other : the vertices in any one component affect only the on / off status of vertices in this component , so maximizing the number of lit vertices can be done one component at a time ( alternatively , this follows from after reordering of the vertices ) .",
    "a component of the graph @xmath46 consists of a central circuit containing two or more vertices , with perhaps some directed trees , each of which leads to some vertex of the circuit , which we call the _ root _ of that tree . starting from the outermost vertices of such a tree ( those that are not in the range of @xmath249 ) and working our way down to the root , it is not hard to see that we can simultaneously light all vertices in each of these trees .",
    "having done this , some of the vertices in the central circuit may not be lit up .",
    "we follow the vertices around the circuit in cyclic order , pressing each vertex that is unlit when we reach it until we have gone fully around the circuit .",
    "it is clear that at this stage at most one vertex in the circuit is unlit , and all the associated trees are still fully lit .",
    "note that any single vertex press either leaves the number of lit vertices in a given component unchanged , or changes that number by @xmath173 .",
    "since initially all vertices are unlit , it follows that the number of lit vertices in a component is always even .",
    "it therefore follows that in a component of even cardinality all vertices can be lit , while in a component of odd cardinality all except one can be lit .",
    "thus it follows that to minimize @xmath18 we need to maximize the number of components of odd cardinality ( necessarily at least 3 ) , and that the maximum proportion of lit vertices in any one component is at least @xmath250 ( with equality only for components of cardinality @xmath251 ) .",
    "thus @xmath252 , which gives the required lower bound except when @xmath243 , @xmath253 . since @xmath46 has @xmath243 vertices and all components have at least two vertices , it can have at most @xmath254 components of odd cardinality , yielding the desired estimate @xmath255 .",
    "thus @xmath25 is given by the stated formula in all cases .",
    "for @xmath224 , the above proof goes through with little change , except that components can now be singletons .",
    "singleton components can always be lit , so @xmath256 , as required .",
    "note that although singleton components do not contribute unlit vertices , they do allow us to get @xmath112 , rather than just @xmath254 , components of odd cardinality at least @xmath251 when @xmath243 .",
    "this accounts for the difference between @xmath24 and @xmath25 in this case .",
    "in preparation for the proof of , we introduce the concept of _ pivoting_. pivoting about a vertex @xmath1 , @xmath10 , is a way of changing the given wiring @xmath3 to a special wiring @xmath257 such that @xmath258 . additionally , pivoting preserves the classes @xmath99 and @xmath102 .    fixing a wiring @xmath80 and initial configuration @xmath4 , and",
    "let @xmath259 denotes the edge function associated to @xmath3 , where @xmath260 .",
    "given @xmath83 , let @xmath261 where the _ pivoted wiring matrix _ @xmath257 is defined by the condition that its @xmath51th column equals the @xmath1th column of @xmath3 if @xmath49 , and equals the @xmath51th column of @xmath3 otherwise . in other words , @xmath257 rewires the system so that pressing the @xmath51th vertex has the same effect as pressing the @xmath1th vertex in the original system whenever @xmath49 . on the other hand , it is easy to see that @xmath262 is the maximum value of @xmath97 over all vectors @xmath94 such that @xmath263 whenever @xmath264 . in particular ,",
    "@xmath265 .",
    "* it does not increase the value of @xmath266 : @xmath267 ; * it preserves membership of the classes @xmath99 and @xmath102 ; * if @xmath268 is the edge function of @xmath257 , then @xmath269 is a forward invariant complete subgraph of the associated graph @xmath270 .",
    "it is sometimes useful to pivot _ partially _ about @xmath1 : given @xmath62 , and @xmath83 , we define @xmath212 by replacing the @xmath51th column of @xmath3 by its @xmath1th column whenever @xmath271 .",
    "such _ pivoting about @xmath1 with respect to @xmath66 _ satisfies the same non - increasing property , preserves membership in @xmath99 and @xmath102 , and @xmath272 is a ( not necessarily forward invariant ) complete subgraph of the associated graph @xmath273 .",
    "suppose @xmath277 , and let @xmath278 be such that @xmath279 .",
    "then @xmath3 has a vertex @xmath1 of degree @xmath9 . by minimality of @xmath3 ,",
    "pivoting about @xmath1 gives @xmath280 with @xmath281 ( cf .",
    "figure [ figure10 ] .",
    "the loop marked @xmath184 just indicates an unspecified subgraph of order @xmath184 . ) . for the wiring @xmath257 , we first press a set of vertices in    @xmath282 so as to maximize the number of lit vertices in @xmath282 , and then we press vertex @xmath1 if fewer than half of the vertices in @xmath59 are lit . by forward",
    "invariance of @xmath59 , the result follows .",
    "trivially , we have that @xmath283 , with equality if @xmath284 .",
    "it is also immediate that @xmath285 : any wiring that includes a vertex of degree @xmath251 allows us to light all vertices by pressing the degree @xmath251 vertex .",
    "suppose therefore that @xmath286 for all @xmath287 , where @xmath39 .",
    "either this equation still holds when @xmath288 is replaced by @xmath0 , or @xmath289 here , the first equality follows from , the second from the inductive hypothesis , and the first inequality from .",
    "since @xmath24 is at both ends of this line , we must have @xmath290 , and the inductive step is complete .",
    "it suffices to prove the lemma subject to the restriction @xmath293 , since this case , the trivial estimate @xmath294 , and sublinearity together imply the general case .",
    "let us therefore assume that @xmath293 .",
    "let @xmath295 be such that @xmath296 .",
    "we now define a matrix @xmath297 .",
    "first the upper left block of @xmath3 is a copy of @xmath298 , i.e.  we let @xmath299 for all @xmath300 .",
    "next , the @xmath301 block of @xmath3 below @xmath298 consists of copies of the @xmath302 identity matrix ; the last of these copies will be missing some columns unless @xmath0 is a multiple of @xmath288 .",
    "lastly , we define @xmath303 for all @xmath304 . it is straightforward to verify that @xmath305 ; note that the assumption @xmath293 ensures that @xmath3 has @xmath85s along the diagonal .",
    "refer to figure [ figure11 ] for a schematic .",
    "note that vertex @xmath306 has the same targets as vertex @xmath1 , but these edges going to vertices other than @xmath307 to @xmath308 are not shown .",
    "since all columns after the @xmath0th column are repeats of earlier columns , it suffices to consider what happens when we press only combinations of the first @xmath0 vertices .",
    "such combinations light at most @xmath13 of the first @xmath0 vertices , so we are done .    ensures that if @xmath309 , then @xmath310 .",
    "this is the required sharp upper bound if @xmath311 , since @xmath312 in this case . on the other hand , @xmath313 , for all @xmath309 , and this gives the required converse for @xmath311 .",
    "it remains to handle the case where @xmath0 is a multiple of @xmath251 .",
    "first we show that the lower bound @xmath314 is sharp when @xmath315 is even . letting @xmath316",
    "we claim that @xmath317 .",
    "assuming this claim , gives the desired sharpness : @xmath318 .",
    "to establish the claim , it suffices to consider sets of vertex presses involving only vertices @xmath85 , @xmath173 , and @xmath319 . with this restriction",
    ", we proceed to list all eight possible values of @xmath94 , and deduce that @xmath317 :       it remains to handle the case where @xmath320 for some @xmath321 .",
    "it is trivial that @xmath322 .",
    "next note that ensures that for @xmath323 , @xmath324 , so we need to show that this is sharp if @xmath325 is odd .",
    "supposing @xmath326 for some fixed @xmath327 , @xmath253 , @xmath325 , we will prove that @xmath112 must be even .",
    "let @xmath328 be such that @xmath329 , let @xmath260 , and let @xmath48 be the edge function associated to @xmath3 .",
    "we can assume that @xmath3 is additionally chosen so that the associated graph @xmath46 has a maximal number of ( disjoint ) @xmath195 s among all matrices @xmath330 for which @xmath331 .",
    "the maximum number of @xmath195 s is always positive since we can get a @xmath195 by pivoting about any one vertex ; @xmath195 sets are pairwise disjoint and forward invariant , since each vertex in a @xmath195 uses up its two allowed outbound edges within the same @xmath195 .",
    "we define @xmath332 to be the union of all the @xmath195 sets .",
    "if @xmath333 , then @xmath334 must be nonempty , since otherwise pivoting about @xmath1 would create an extra @xmath195 .",
    "thus each @xmath333 has at most one edge from it to another vertex in @xmath335 .",
    "suppose there is such a vertex @xmath1 with @xmath59 not a subset of @xmath332 .",
    "then we can pivot about @xmath1 relative to @xmath332 to get a @xmath194 , and the only edges coming from this @xmath194 are single edges from both of its vertices to the same element in @xmath332 .",
    "we repeat such pivoting of vertices relative to @xmath332 to create more such @xmath194s until this is no longer possible . from now on @xmath3 will denote this modified wiring matrix .",
    "we denote by @xmath336 the union of the @xmath194 vertices and write @xmath337 , and we refer to each vertex in @xmath338 as a @xmath339 ( which it is , trivially ) .",
    "we already know that there is an edge from each vertex in @xmath338 to some vertex in @xmath332 .",
    "if there is only a single edge from some @xmath340 to @xmath341 , then there must be an edge from @xmath1 to some @xmath342 .",
    "pivoting about @xmath1 relative to @xmath341 ( or equivalently , relative to @xmath332 ) , we create a new @xmath194 , contradicting the fact that this can not be done .",
    "thus there are two edges from each @xmath340 to @xmath341 .",
    "see figure [ figure13 ] .",
    "we have shown that there are edges from @xmath338 to @xmath341 , and from @xmath336 to @xmath332 , but that both @xmath332 and @xmath341 are forward invariant . also , there are no links between elements in @xmath338 , or between elements in distinct @xmath194 s or in distinct @xmath195 s",
    ". there are @xmath343 elements in @xmath332 , @xmath344 elements in @xmath336 , and @xmath93 in @xmath338 , for some integers @xmath345 , and we have @xmath346 .",
    "the forward invariance of both @xmath332 and @xmath341 suggests two algorithms for lighting many of the vertices .",
    "the first is to begin by pressing all these vertices in @xmath338 to light all these vertices .",
    "after this first step , we can ensure that at least one vertex in each @xmath194 is lit by pressing a vertex in any @xmath194 without a lit vertex .",
    "finally , we ensure that at least two vertices are lit in each @xmath195 by pressing a vertex in any @xmath195 in which less than two vertices are lit .",
    "having done this , we have at least @xmath347 lit vertices , so @xmath348",
    ". thus @xmath349 .",
    "when we compare this with the equation @xmath350 , we deduce that @xmath351 .",
    "an alternative algorithm for lighting the vertices is to first press one vertex in each @xmath194 , thus lighting all @xmath194 vertices . as a second step , press a vertex in any @xmath195 in which less than @xmath173 vertices are lit .",
    "having done this , at least two vertices in each @xmath195 are lit as well as both vertices in each @xmath194 .",
    "consequently , @xmath352 .",
    "thus @xmath353 , while @xmath350 .",
    "it follows that @xmath354 , and so @xmath355 .",
    "note that the first lighting algorithm gives at least @xmath356 lit vertices , and it actually gives more than this number unless after the first step exactly one vertex in each @xmath194 is lit .",
    "since any larger number contradicts @xmath357 , there must be an edge from @xmath338 to each @xmath194 .",
    "but since the numbers of @xmath339 s and of @xmath194 s are equal , and there is at most one edge from each @xmath339 to @xmath336 ( since at least one edge from each @xmath339 goes to @xmath332 ) , it follows that from each @xmath339 there is an edge to a @xmath194 , and no other vertex in @xmath338 is linked to the same @xmath194 , i.e.  we can pair off each @xmath339 with the unique @xmath194 to which it is linked in the graph .",
    "see figure [ figure14 ] .",
    "the second lighting algorithm will give more than @xmath356 lit vertices unless the first step ends with one or two lit vertices in each @xmath195 .",
    "thus there is an edge from at least one @xmath194 to each @xmath195 .",
    "since any one @xmath194 is linked to only a single @xmath195 , it follows that @xmath359 .",
    "we now define the _ active vertices _ to be the elements of a collection of vertices consisting of all @xmath339 vertices , together with one vertex from each @xmath194 , and the _ active edges _ are all the edges coming from active vertices .",
    "when considering the effect of pressing sets of vertices in @xmath360 , we can restrict ourselves to considering only sets of active vertices , hence the terminology .",
    "to light more than two thirds of the vertices , it suffices to first light two vertices in every @xmath358 set in such a way that there is at least one @xmath195 that is either fully lit or fully unlit , since we can subsequently light two thirds of all vertices in all other @xmath195 sets , together with all vertices in the fully unlit or fully lit @xmath195 , by pressing only @xmath195 vertices .",
    "since each @xmath195 is forward invariant , we are done .    but given a @xmath358 set with all vertices unlit , pressing one or both of its active vertices leaves exactly two of its vertices lit .",
    "this gives us three ways of lighting two thirds of the vertices in that @xmath358 set , and this flexibility will be crucial to proving that @xmath0 must be a multiple of @xmath361 . in particular",
    ", it means that for any given @xmath195 , there must be an associated @xmath358 both of whose active vertices have edges leading to that @xmath195 , since if this were not so , we could light two vertices in each @xmath358 without ever pressing a vertex linked to that @xmath195 . furthermore , even if a @xmath358 is doubly linked to a @xmath195 , but the two active edges between them connect to the same vertex , then by pressing both active vertices , the on / off status of all vertices in the @xmath195 remains unchanged .",
    "let us therefore say that a @xmath358 set with two active links to distinct vertices in a @xmath195 is _ well linked _ to that @xmath195 set .",
    "we say that they are _ badly linked _ if they are linked but not well linked .",
    "it follows that @xmath362 can be decomposed into a collection of @xmath358 sets , each of which is paired off with a distinct @xmath195 set to which it is well linked , plus @xmath363 extra @xmath358 sets that have not been paired off with any @xmath195 , but are linked ( well or badly ) to some of the @xmath195 s .",
    "we claim that if @xmath364 then the residual @xmath358 sets always allow us to arrange that at least one @xmath195 is fully lit or fully unlit after we light two vertices in every @xmath358 .",
    "it follows the claim that @xmath0 can not be an odd multiple of @xmath251 , since then we would have @xmath365 , and we could light more than two thirds of the vertices .",
    "suppose therefore that @xmath364 , and so there exists some particular @xmath195 with vertex set @xmath366 , say , that has more than one @xmath358 linked to it , at least one of which is well linked .",
    "we wish to show that we can press one or both of the active vertices in each of the @xmath358 s linked to @xmath367 while keeping @xmath367 _ in sync _ ( meaning that all three of its vertices are in the same on / off state ) .",
    "now @xmath367 is initially in sync , and we can handle any two well - linked @xmath358 s while keeping @xmath367 in sync . to see this , note that if the two pairs of active links go to the same pair of vertices in @xmath367 , then we press all four active vertices in both @xmath358 s . if on the other hand , they do not go to the same pair of vertices then without loss of generality , one @xmath358 is linked to @xmath368 and @xmath369 and the other to @xmath369 and @xmath4 . by pressing three of the four active vertices , we can toggle the on / off status of all three vertices in @xmath367 .    since we can handle well - linked @xmath358 s two at a time , and we can handle badly linked ones one at a time ,",
    "while keeping @xmath367 in sync , we can reduce to the situation of having to handle only two or three @xmath358 s , with at least one of them well linked .",
    "we have already handled the case of two well - linked @xmath358 s , so assume that there are two @xmath358 s and exactly one is well linked , to @xmath368 and @xmath369 , say , while the other is badly linked , with either one or two links to a single vertex @xmath370 . by symmetry ,",
    "we reduce to either of two subcases : if @xmath371 , then we press one active vertex in both @xmath358 s that is connected to @xmath368 , while if @xmath372 , then we press three vertices so as to toggle the on / off status of all of @xmath367 .",
    "there remains the case of three linked @xmath358 s .",
    "if two are well linked and one badly linked , then we just handle the two well - linked ones together as above , and separately handle the badly linked one .",
    "finally , all three may be well linked .",
    "if all three @xmath358 s link to the same pair of vertices , @xmath368 and @xmath369 , say , then we press both active vertices in one of them and one in the other two , to ensure that both @xmath368 and @xmath369 are toggled twice ( and so unchanged ) . if two @xmath358 s link to the same pair of vertices , @xmath368 and @xmath369 , say , and the third links to @xmath369 and @xmath4 , say , then we can press one vertex in each @xmath358 to ensure that all three vertices in @xmath367 are toggled once .",
    "finally if no two @xmath358 s leads to the same pair of vertices , then one leads to @xmath373 , another to @xmath374 , and a third to @xmath375 .",
    "we can press all six of the active vertices so as to toggle each of @xmath376 twice .",
    "this finishes the proof of the theorem .",
    "note that even when @xmath0 is a multiple of @xmath361 , the above argument gives us some extra information : after suitable pivoting , any wiring @xmath377 with @xmath378 must reduce to a collection of @xmath358 s each of which is well linked to a distinct @xmath195 .",
    "each associated subgraph with six vertices is a component of the full graph and is unique ( up to relabeling of the vertices ) .",
    "moreover it is the graph of the wiring @xmath379 in so , after suitable pivoting , any wiring @xmath377 with @xmath380 reduces to @xmath381 copies of @xmath379 ."
  ],
  "abstract_text": [
    "<S> given @xmath0 buttons and @xmath0 bulbs so that the @xmath1th button toggles the @xmath1th bulb and at most two other bulbs , we compute the sharp lower bound on the number of bulbs that can be lit regardless of the action of the buttons . </S>"
  ]
}