{
  "article_text": [
    "zeus is a freely available mhd code that is widely used by the astrophysical community .",
    "although stone & norman ( 1992a , b ) give results for the sod problem ( sod 1978 ) and its mhd equivalent , the brio and wu problem ( brio & wu 1988 ) , zeus does not appear to have been tested on a wide range of riemann problems such as those described in e.g. dai & woodward ( 1994 ) , ryu & jones ( 1995 ) , falle , komissarov & joarder ( 1998)and balsara ( 1998 ) .    since zeus is neither upwind for all characteristic fields nor conservative , we might expect it to perform significantly less well than upwind conservative codes ( e.g. brio & wu 1988 ; dai & woodward 1994 ; ryu & jones 1995 ; falle , komissarov & joarder 1998 ; balsara 1998 ; powell et al .",
    "as we shall see , this is indeed true in the sense that there are a number of simple problems for which the zeus solution contains significant errors that are absent in solutions calculated with an upwind conservative scheme .",
    "figures 1 and 2 show that zeus generates rarefaction shocks for both pure gas rarefactions and fast magnetosonic rarefactions , whereas the upwind conservative scheme described in falle , komissarov & joarder ( 1998 ) gives quite satisfactory results . in both cases ,",
    "the zeus solutions are sensitive to the inertial frame and the rarefaction shocks can be removed by a galilean transformation that increases the x velocity sufficiently .",
    "these rarefaction shocks are steady structures whose width does not increase with time .",
    "since the effect of the nonlinear terms is to spread such structures , it is clear that the truncation errors in zeus must be anti - diffusive in these cases .",
    "the most obvious explanation for this is that zeus is second order in space , but first order in time since this can lead to an anti - diffusive term in the truncation error .",
    "for example , the upwind scheme can be made first order in time and second order in space by omitting the preliminary first order step and in that case it can be shown to be anti - diffusive and also produces rarefaction shocks .",
    "although zeus is second order in space and time for linear advection , the use of a partially updated velocity in the advection step means that it is only first order in time if the velocity is not constant .",
    "further evidence that this is the cause of the problem is provided by the sensitivity of the rarefaction shocks to the galilean frame and the fact that they disappear when the courant number is reduced from @xmath0 to @xmath1 , whereas they become much worse if the courant number is increased above @xmath0 .",
    "zeus has a facility for adding a linear artificial viscosity whose magnitude is determined by the parameter @xmath2 .",
    "the addition of such a viscosity removes the anti - diffusive terms by reducing the scheme to first order in space for everything except linear advection . for the gas rarefaction , @xmath3 cures the problem and seems to be optimal for a global courant number of @xmath0 , but it is too large if the local courant number associated with the wave is small . since the linear viscous term must balance an anti - diffusive term that scales like the timestep , it would be better if the viscous term that is implemented in zeus were multiplied by the local courant number associated with the wave that is causing the problem . since rarefaction shocks only arise for rarefactions associated with the sound wave with the largest speed relative to the grid , it is the smallest local courant number that is appropriate .    in mhd",
    "the situation is even worse since , although the rarefaction shocks in the fast rarefaction can be removed by setting @xmath4 , this makes the scheme very diffusive for other waves .",
    "furthermore , the required value of @xmath2 depends on the particular problem",
    ". it might be possible to avoid such a large value of @xmath2 by adding an appropriate artificial resistivity , but the code has no facility for this .",
    "figures 3 and 4 show that , even for an initially smooth rarefaction wave , zeus is significantly less accurate than an upwind scheme .",
    "the results are for @xmath5 , but figure 4 shows that zeus is still first order even without this .",
    "in contrast , it is evident from figure 4 that the rate of convergence of the upwind scheme is second order .",
    "note that the upwind scheme also has an artificial viscosity as described in falle , komissarov & joarder ( 1998 ) , but since this is applied in the riemann solver , it does not reduce the order in smooth regions .",
    "incidentally , zeus performs even worse if one does not take the staggered grid into account in setting up the the initial solution .",
    "furthermore , for both codes , point samples were used to project the exact solution onto the grid , which is reasonable for zeus , but is somewhat unfair to a conservative scheme .",
    "the upwind scheme produces reasonable results at the lowest resolution , even though this corresponds to only @xmath6 cells in the rarefaction at the initial time , whereas zeus needs at least @xmath7 cells for the same accuracy . for a three dimensional calculation",
    ", this would require @xmath8 times the computing time and @xmath9 times the memory since zeus is about @xmath10 times the speed of the upwind scheme .",
    "the disparity in efficiency is actually greater than this because for both codes the courant number was set to the zeus default value of @xmath0 for all cases described in this paper .",
    "the upwind code can run at larger courant numbers than this , whereas even @xmath0 can be too large for zeus for some riemann problems .",
    "of course , the slower convergence of zeus also means that the situation would be even worse if greater accuracy were required .",
    "since zeus is not conservative , we expect it to generate errors at shocks which can not be reduced by increasing the resolution .",
    "as it turns out , these errors are small ( @xmath11 ) for pure gas dynamics and are entirely absent for an isothermal equation of state .",
    "however , they can be significant for adiabatic mhd .",
    "figure 5 shows that , for a nearly perpendicular fast shock , the post - shock gas pressure in the zeus solution is too low by a factor of 2 .",
    "in contrast , the conservative upwind scheme gets the solution exact to rounding .",
    "it is true that this is a somewhat extreme case since the plasma @xmath12 is negligible upstream of the shock and @xmath13 downstream .",
    "however , such low values of @xmath12 do occur in dense molecular clouds and protostellar discs ( e.g. crutcher 1999 ) .",
    "furthermore , even though @xmath12 is small , such errors in the gas pressure can have a significant effect on the dynamics because the gas pressure provides a force parallel to the field , whereas the lorentz force does not .    finally , figure 6 shows that a relatively small error at a fast shock can be amplified by a slow shock following on behind . in this case",
    "the zeus solution has an error of @xmath14 in the density behind the slow shock travelling to the right .",
    "this is not caused by small @xmath12 since @xmath15 behind the fast shock ,",
    "@xmath16 behind the slow shock and the error in the gas pressure is much smaller than in the density .",
    "like balsara ( 2001 ) , we find that zeus produces large post - shock oscillations for strong mhd shocks , but that these can be reduced substantially by adding the same linear artificial viscosity that removes gas dynamic rarefaction shocks .",
    "this is presumably because a quadratic viscosity leads to algebraic decay of these oscillations , whereas a linear viscosity gives exponential decay .",
    "the calculation shown in figure 6 used this value of the linear artificial viscosity and it can be seen that the amplitude of the post - shock oscillations is quite small .",
    "the calculations presented are all coplanar ( @xmath17 ) , but we have also looked at some non - coplanar problems in order to see whether the presence of alfvn waves causes any additional difficulties for zeus .",
    "this is not the case , at least for the problems that we have considered .",
    "it is evident from these results that , zeus can be made just about acceptable for pure gas dynamics if the linear artificial viscosity is multiplied by the smallest local courant number since the shock errors are small in this case .",
    "however , it is not satisfactory for adiabatic mhd , at least in its present form .",
    "the shock errors do not occur for an isothermal equation of state , but , since the rarefaction shocks do , zeus is also not reliable for isothermal mhd .",
    "it is possible that the rarefaction shocks in mhd waves can be removed without using an excessive linear artificial viscosity by the addition of an appropriate linear artificial resistivity .",
    "the shock errors might also be reduced by advecting the total energy rather than the internal energy . however , even with such improvements , the low order of accuracy makes zeus very inefficient compared with a modern upwind scheme .",
    "this should not be taken to mean that conservative upwind codes are in any sense perfect .",
    "for example , it is necessary to introduce some extra dissipation in the riemann solver to remove the serious errors discussed by quirk ( 1994 ) and some desirable properties , such as strict conservation , may have to be sacrificed in order to satisfy the constraint @xmath18 in multidimensional mhd ( see e.g. powell et al .",
    "1999 ; balsara 2001 ) .",
    "these results obviously have implications for the reliability of the numerous calculations in the literature that have used zeus .",
    "although these effects are likely to be present in many cases , the associated errors are not necessarily so serious as to completely invalidate the calculations . whether or not they make any qualitative difference in any particular case",
    "can only be decided either by a thorough examination of the results to see whether any of these errors are present , or by repeating the calculations using a modern code .",
    "these calculations were performed with the version of zeus2d available from the ncsa website , but , since all versions of zeus appear to use the same algorithms , the results should not depend on the particular version .",
    "it is also worth pointing out that although we used the scheme described by falle , komissarov and joarder ( 1998 ) , similar results would probably have been obtained with any modern upwind code .",
    "balsara , d.  s. 2001 , jcp , 174 , 614 balsara , d.  s. 1998 , , 116 , 133 brio , m. , & wu , c.  c. 1988 , jcp , 75 , 400 crutcher , r.  m. 1999 , , 520 , 706 dai , w. , & woodward , p.",
    "r. 1994 , jcp , 111 , 354 falle , s.  a.  e.  g. , komissarov , s.  s. , & joarder , p. 1998",
    ", , 297 , 265 powell , k.  g. , roe , p.  l. , linde , t.  j. , gombosi , t  .i . , de zeeuw , d.  l. 1999 , jcp , 154 , 284 quirk , j.  j. 1994 , int .",
    "j. numer . meth .",
    ", 18 , 555 ryu , d. , & jones , t.  w. 1995 , , 442 , 228 sod , g.  a. 1978 , jcp , 27 , 1 stone , j.  m. , & norman , m.  l. 1992a , , 80 , 753 stone , j.  m. , & norman , m.  l. 1992b , , 80 , 791"
  ],
  "abstract_text": [
    "<S> we show that there are simple one dimensional problems for which the mhd code , zeus , generates significant errors , whereas upwind conservative schemes perform very well on these problems . </S>"
  ]
}